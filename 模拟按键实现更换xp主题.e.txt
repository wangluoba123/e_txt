 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库




.全局变量 超时退出, 整数型, , , 

.DLL命令 搜索窗口, 整数型, "user32", "FindWindowExA", , 找到的窗口的句柄。如未找到相符窗口，则返回零。
    .参数 父窗口, 整数型, , 在其中查找子的父窗口。如设为零，表示使用桌面窗口
    .参数 子窗口, 整数型, , 从这个窗口后开始查找，如设为零，表示从第一个子窗口开始搜索
    .参数 类名1, 整数型, , 0表示忽略，一般忽略
    .参数 类名2, 整数型, , 0表示忽略，一般忽略

.DLL命令 发送消息LF, 整数型, "", "SendMessageA", , 
    .参数 hwnd, 整数型, , 
    .参数 wMsg, 整数型, , 
    .参数 wParam, 整数型, , 
    .参数 lParam, 整数型, , 

.DLL命令 取窗口标题LF, 整数型, "user32", "GetWindowTextA", , 
    .参数 窗口句柄, 整数型, , 
    .参数 标题保存变量, 文本型, , 
    .参数 变量长度, 整数型, , 标题长度+1

.DLL命令 取特定窗口句柄, 整数型, "user32", "FindWindowA", , 
    .参数 类, 整数型, , 
    .参数 标题, 文本型, , 

.DLL命令 窗口可视性控制, 空白型, "user32.dll", "ShowWindow", , 控制窗口的可见性
    .参数 窗口句柄, 整数型, , 将要进行操作的窗口句柄
    .参数 操作参数, 整数型, , 为窗口指定可视性方面的一个命令

.DLL命令 执行文件, 整数型, "", "ShellExecuteA", , 非零表示成功，零表示失败。会设置GetLastError
    .参数 父窗口句柄, 整数型, , 指定一个窗口的句柄，有时候，windows程序有必要在创建自己的主窗口前显示一个消息框，可为空
    .参数 操作类型, 文本型, , 指定字串“open”来打开lpFlie文档，或指定“Print”来打印它
    .参数 文件名, 文本型, , 
    .参数 文件名参数, 文本型, , 如文件名是可执行文件，则这个字串包含传递给执行程序的参数
    .参数 完整路径, 文本型, , 想使用的完整路径
    .参数 常数值, 整数型, , 定义了如何显示启动程序的常数值。参考ShowWindow函数的nCmdShow参数

.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 

_按钮1_被单击 ()
 ' 时钟1.时钟周期 ＝ 1000

.子程序 _时钟1_周期事件, 空白型, , 
.局部变量 A, 整数型, , , 

赋值 (A, 取特定窗口句柄 (0, “显示 属性”))
.如果真 (不等于 (A, 0))
    窗口可视性控制 (A, 7)
    赋值 (A, 查找指定按钮 (A))
    .如果真 (不等于 (A, 0))
        发送消息LF (A, 513, 0, 0)
        发送消息LF (A, 514, 0, 0)
        赋值 (., 0)
        结束 ()
    .如果真结束
    
.如果真结束
.如果真 (等于 (超时退出, 10))
    结束 ()
.如果真结束
赋值 (超时退出, 相加 (超时退出, 1))

.子程序 查找指定按钮, 整数型, , 
.参数 父窗口句柄, 整数型, , 

.局部变量 A, 整数型, , , 
.局部变量 窗口标题, 文本型, , , 

赋值 (窗口标题, 取空白文本 (255))
赋值 (A, 搜索窗口 (父窗口句柄, 0, 0, 0))
.判断循环首 (不等于 (A, 0))
    取窗口标题LF (A, 窗口标题, 254)
    .如果真 (等于 (窗口标题, “确定”))
        返回 (A)
    .如果真结束
    赋值 (A, 搜索窗口 (父窗口句柄, A, 0, 0))
.判断循环尾 ()
返回 (0)

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 主题文件, 文本型, , , 

 ' 执行文件 (0, “open”, “\\dy\网吧公用文档\客户文件存放处\aero.msstyles”, “”, “”, 5)
赋值 (主题文件, 读配置项 (相加 (取运行目录 (), “\ZTsysLF.ini”), “主题配置”, “主题路径”, ))
执行文件 (0, “open”, 主题文件, “”, “”, 5)
赋值 (., 1000)

.子程序 _按钮2_被单击, 空白型, , 
窗口可视性控制 (取特定窗口句柄 (0, “显示 属性”), 0)


 ' 不属于任何一个程序集、类模块的函数：
