 ' 文件类型：Windows模块源码

 ' 程序名称：窗口相关模块
 ' 程序描述：超强窗口句柄查找功能，支持通配符等N多功能。-----易语言我吃了 制作
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' spec A512548E76954B6E92C21055517615B0 3 0 特殊功能支持库




数据类型 窗口信息, 公开, 
    .成员 窗口句柄, 整数型, , , 
    .成员 标题, 文本型, , , 
    .成员 类名, 文本型, , , 
    .成员 左边, 整数型, , , 
    .成员 顶边, 整数型, , , 
    .成员 宽度, 整数型, , , 
    .成员 高度, 整数型, , , 
    .成员 可视, 逻辑型, , , 
    .成员 所属进程名, 文本型, , , 
    .成员 进程路径, 文本型, , , 
    .成员 进程模块列表, 文本型, , "1", 
    .成员 进程线程ID列表, 整数型, , "1", 
    .成员 所属线程ID, 整数型, , , 
    .成员 所属进程PID, 整数型, , , 
    .成员 光标句柄, 整数型, , , 
    .成员 图标句柄, 整数型, , , 
    .成员 窗口样式, 整数型, , , 
    .成员 扩展样式, 整数型, , , 
    .成员 父窗口句柄, 整数型, , , 
    .成员 祖宗窗口句柄, 整数型, , , 

数据类型 RECT, 公开, 
    .成员 Left, 整数型, , , 
    .成员 Top, 整数型, , , 
    .成员 Right, 整数型, , , 
    .成员 Bottom, 整数型, , , 

数据类型 LPMODULEENTRY32, , 
    .成员 size, 整数型, , , 
    .成员 mid, 整数型, , , 
    .成员 pid, 整数型, , , 
    .成员 gusage, 整数型, , , 
    .成员 pusage, 整数型, , , 
    .成员 base, 整数型, , , 
    .成员 bsize, 整数型, , , 
    .成员 hmodule, 整数型, , , 
    .成员 szname, 字节型, , "256", 
    .成员 szpath, 字节型, , "256", 

数据类型 IconDirEntry, , 
    .成员 bWidth, 字节型, , , 
    .成员 bHeight, 字节型, , , 
    .成员 bColorCount, 字节型, , , 
    .成员 bReserved, 字节型, , , 
    .成员 wPlanes, 短整数型, , , 
    .成员 wBitCount, 短整数型, , , 
    .成员 dwBytesInRes, 整数型, , , 
    .成员 dwImageOffset, 整数型, , , 

数据类型 THREADENTRY32, , 
    .成员 dwsize, 整数型, , , 
    .成员 cntusage, 整数型, , , 
    .成员 th32threadID, 整数型, , , 
    .成员 th32OwnerProcessID, 整数型, , , 
    .成员 tpBasePri, 整数型, , , 
    .成员 tpDeltaPri, 整数型, , , 
    .成员 dwFlags, 整数型, , , 


.DLL命令 FindWindowEx, 整数型, "user32", "FindWindowExA", 公开, 
    .参数 hWnd1, 整数型, , 
    .参数 hWnd2, 整数型, , 
    .参数 lpClassName, 文本型, , 
    .参数 lpWindowName, 文本型, , 

.DLL命令 FindWindow, 整数型, "user32", "FindWindowA", 公开, 
    .参数 lpClassName, 文本型, , 
    .参数 lpWindowName, 文本型, , 

.DLL命令 lstrcpyn_文本, 整数型, "kernel32", "lstrcpynA", , 
    .参数 lpString1, 文本型, , 
    .参数 lpString2, 文本型, , 
    .参数 iMaxLength, 整数型, , 

.DLL命令 lstrcpyn_字节集, 整数型, "kernel32", "lstrcpynA", , 
    .参数 lpString1, 字节集, 传址, 
    .参数 lpString2, 字节集, 传址, 
    .参数 iMaxLength, 整数型, , 

.DLL命令 lstrcpyn_整数, 整数型, "kernel32", "lstrcpynA", , 
    .参数 lpString1, 整数型, 传址, 
    .参数 lpString2, 整数型, 传址, 
    .参数 iMaxLength, 整数型, , 

.DLL命令 PostMessage, 整数型, "user32", "PostMessageA", 公开, 投递消息
    .参数 句柄, 整数型, , 
    .参数 消息, 整数型, , 
    .参数 参数1, 整数型, , 
    .参数 参数2, 整数型, , 

.DLL命令 SendMessage, 整数型, "user32", "SendMessageA", 公开, 发送消息
    .参数 句柄, 整数型, , 
    .参数 消息, 整数型, , 
    .参数 参数1, 整数型, , 
    .参数 参数2, 整数型, , 

.DLL命令 GetClassName, 整数型, "user32", "GetClassNameA", , 
    .参数 句柄, 整数型, , 
    .参数 lpClassName, 文本型, , 
    .参数 nMaxCount, 整数型, , 

.DLL命令 EnumWindows, 整数型, "user32", "EnumWindows", , 
    .参数 lpEnumFunc, 子程序指针, , 
    .参数 参数, 整数型, 数组, 

.DLL命令 GetAncestor, 整数型, "user32.dll", "GetAncestor", 公开, 取指定窗口的父或祖宗窗口。
    .参数 句柄, 整数型, , 
    .参数 gaFlags, 整数型, , 1、取父窗口，2、取祖宗窗口。。

.DLL命令 GetWindowThreadProcessId, 整数型, "user32", "GetWindowThreadProcessId", 公开, 
    .参数 句柄, 整数型, , 
    .参数 lpdwProcessId, 整数型, 传址, 

.DLL命令 GetWindowRect, 整数型, "user32", "GetWindowRect", 公开, 
    .参数 句柄, 整数型, , 
    .参数 lpRect, RECT, 传址, 

.DLL命令 SetWindowLong, 整数型, "user32", "SetWindowLongA", 公开, 
    .参数 句柄, 整数型, , 
    .参数 nIndex, 整数型, , 
    .参数 dwNewLong, 整数型, , 

.DLL命令 GetWindowLong, 整数型, "user32", "GetWindowLongA", 公开, 
    .参数 句柄, 整数型, , 
    .参数 nIndex, 整数型, , 

.DLL命令 IsWindow, 逻辑型, "user32", "IsWindow", 公开, 窗口句柄是否有效
    .参数 句柄, 整数型, , 

.DLL命令 CloseHandle, 整数型, "kernel32", "CloseHandle", 公开, 
    .参数 hObject, 整数型, , 

.DLL命令 IsWindowVisible, 逻辑型, "user32", "IsWindowVisible", 公开, 窗口是否可见
    .参数 句柄, 整数型, , 

.DLL命令 GetClassLong, 整数型, "user32", "GetClassLongA", 公开, 
    .参数 句柄, 整数型, , 
    .参数 nIndex, 整数型, , 

.DLL命令 EnumChildWindows, 整数型, "user32", "EnumChildWindows", , 
    .参数 hWndParent, 整数型, , 
    .参数 lpEnumFunc, 子程序指针, , 
    .参数 参数, 整数型, 数组, 

.DLL命令 Module32Next, 整数型, "", "Module32Next", , 
    .参数 hSnapshot, 整数型, , 
    .参数 lpme, LPMODULEENTRY32, , 

.DLL命令 Module32First, 整数型, "", "Module32First", , 
    .参数 hsnap, 整数型, , 
    .参数 mod, LPMODULEENTRY32, , 

.DLL命令 CreateToolhelp32Snapshot, 整数型, "", "CreateToolhelp32Snapshot", , 
    .参数 falg, 整数型, , 
    .参数 id, 整数型, , 

.DLL命令 PathMatchSpec, 逻辑型, "shlwapi.dll", "PathMatchSpecA", , 
    .参数 pszFile, 文本型, , 
    .参数 pszSpec, 文本型, , 

.DLL命令 GetActiveWindow, 整数型, "user32", "GetActiveWindow", 公开, 获得活动窗口的句柄

.DLL命令 EnableWindow, 整数型, "user32", "EnableWindow", 公开, 
    .参数 句柄, 整数型, , 
    .参数 fEnable, 整数型, , 

.DLL命令 OpenIcon, 整数型, "user32", "OpenIcon", 公开, 恢复最小化窗口
    .参数 句柄, 整数型, , 

.DLL命令 ShowWindow, 整数型, "user32", "ShowWindow", 公开, 
    .参数 句柄, 整数型, , 
    .参数 nCmdShow, 整数型, , 

.DLL命令 SetWindowPos, 整数型, "user32", "SetWindowPos", 公开, 
    .参数 句柄, 整数型, , 
    .参数 hWndInsertAfter, 整数型, , 
    .参数 x, 整数型, , 
    .参数 y, 整数型, , 
    .参数 cx, 整数型, , 
    .参数 cy, 整数型, , 
    .参数 wFlags, 整数型, , 

.DLL命令 LCMapString, 整数型, "kernel32", "LCMapStringA", , 
    .参数 Locale, 整数型, , 
    .参数 dwMapFlags, 整数型, , 
    .参数 lpSrcStr, 文本型, , 
    .参数 cchSrc, 整数型, , 
    .参数 lpDestStr, 文本型, , 
    .参数 cchDest, 整数型, , 

.DLL命令 SetParent, 整数型, "user32", "SetParent", 公开, 
    .参数 hWndChild, 整数型, , 
    .参数 hWndNewParent, 整数型, , 

.DLL命令 RtlMoveMemory_整数, 整数型, "", "RtlMoveMemory", , 
    .参数 lpvDest, 整数型, 传址, 
    .参数 lpvSource, 整数型, , 
    .参数 cbCopy, 整数型, , 

.DLL命令 CopyMemory_Icon, 空白型, "", "RtlMoveMemory", , 
    .参数 Destination, IconDirEntry, , 
    .参数 Source, 字节集, , 
    .参数 cbCopy, 整数型, , 

.DLL命令 CreateIconFromResource, 整数型, "", "CreateIconFromResource", , 
    .参数 presbits, 字节集, , 
    .参数 dwResSize, 整数型, , 
    .参数 fIcon, 逻辑型, , 
    .参数 dwVer, 整数型, , 

.DLL命令 GetCurrentProcessId, 整数型, "kernel32", "GetCurrentProcessId", 公开, 取自进程PID

.DLL命令 OpenProcess, 整数型, "kernel32", "OpenProcess", , 
    .参数 dwDesiredAccess, 整数型, , 
    .参数 bInheritHandle, 整数型, , 
    .参数 dwProcessId, 整数型, , 

.DLL命令 DestroyIcon, 整数型, "user32", "DestroyIcon", 公开, 清除图标
    .参数 图标句柄, 整数型, , 

.DLL命令 CreateRemoteThread, 整数型, "", "", , 
    .参数 hProcess, 整数型, , 
    .参数 lpThreadAttributes, 整数型, , 
    .参数 dwStackSize, 整数型, , 
    .参数 lpStartAddress, 整数型, , 
    .参数 lpParameter, 整数型, , 
    .参数 dwCreationFlags, 整数型, , 
    .参数 lpThreadId, 整数型, 传址, 

.DLL命令 GetExitCodeThread, 整数型, "kernel32", "GetExitCodeThread", , 
    .参数 hThread, 整数型, , 
    .参数 lpExitCode, 整数型, 传址, 

.DLL命令 WaitForSingleObject, 整数型, "kernel32", "WaitForSingleObject", , 
    .参数 hHandle, 整数型, , 
    .参数 dwMilliseconds, 整数型, , 

.DLL命令 GetIconInfo, 整数型, "user32", "GetIconInfo", , 
    .参数 hIcon, 整数型, , 
    .参数 piconinfo, 整数型, 数组, 

.DLL命令 Thread32Next, 整数型, "KERNEL32.DLL", "Thread32Next", , 
    .参数 hSnapshot, 整数型, , 
    .参数 lpte, THREADENTRY32, 传址, 

.DLL命令 Thread32First, 整数型, "KERNEL32.DLL", "Thread32First", , 
    .参数 hSnapshot, 整数型, , 
    .参数 lpte, THREADENTRY32, 传址, 

.程序集 程序集1, , , 易语言我吃了 制作

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--


.子程序 _临时子程序, 空白型, , 
.局部变量 句柄, 整数型, , "0", 

 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。

调试输出 (搜寻顶级窗口_ (“*易语言*”)) ' 寻找含有“易语言”三个字的窗口 返回找到的第一个窗口的句柄

条件枚举顶级窗口_ (“*易语言*”, , 句柄) ' 枚举含有“易语言”三个字的所有顶级窗口的句柄
调试输出 (句柄)

.子程序 枚举函数, 整数型, , 
.参数 窗口句柄, 整数型, , 
.参数 参数, 整数型, ,   

.局部变量 内存位置, 整数型, 静态, , 

写到内存 (窗口句柄, 相加 (参数, 内存位置), )
' 本源码来自易语言资源网(www.5A5X.com)
赋值 (内存位置, 相加 (内存位置, 4))
返回 (lstrcpyn_整数 (内存位置, 内存位置, 0))

.子程序 字节集_到整数, 整数型, , 
.参数 字节集, 字节集, , 

.局部变量 整数, 整数型, , , 
.局部变量 地址, 整数型, , , 
.局部变量 长度, 整数型, , , 

赋值 (地址, lstrcpyn_字节集 (字节集, 字节集, 0))
赋值 (长度, 取字节集长度 (字节集))
.如果 (小于 (长度, 4))
    ' 本源码来自易语言资源网(www.5A5X.com)
    RtlMoveMemory_整数 (整数, 地址, 长度)
.否则
    RtlMoveMemory_整数 (整数, 地址, 4)
.如果结束
返回 (整数)

.子程序 字母到全角_, 文本型, , 
.参数 欲变换的文本, 文本型, , 

.局部变量 strJ, 文本型, , , 

赋值 (strJ, “  ”)
LCMapString (2052, 8388608, 欲变换的文本, 2, strJ, 2)
返回 (strJ)
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 匹配通配符_, 逻辑型, 公开, 匹配返回真，不匹配返回假。支持“*”和“?”
.参数 一般文本, 文本型, , 
.参数 含通配符文本, 文本型, , 
.参数 区分大小写, 逻辑型, 可空, 真则区分大小写，默认为假。

.局部变量 计次, 整数型, , , 
.局部变量 字符, 文本型, , , 
.局部变量 文本, 文本型, , "2", 

.如果真 (等于 (区分大小写, 假))
    返回 (PathMatchSpec (一般文本, 含通配符文本))
.如果真结束
.如果真 (等于 (PathMatchSpec (一般文本, 含通配符文本), 假))
    返回 (假)
.如果真结束
赋值 (文本 [1], 一般文本)
赋值 (文本 [2], 含通配符文本)
.变量循环首 (65, 122, 1, 计次)
    .如果真 (并且 (大于或等于 (计次, 91), 小于或等于 (计次, 96)))
        ' 本源码来自易语言资源网(www.5A5X.com)
        到循环尾 ()
    .如果真结束
    赋值 (字符, 字符 (计次))
    赋值 (文本 [1], 子文本替换 (文本 [1], 字符, 字母到全角_ (字符), , , 真))
    赋值 (文本 [2], 子文本替换 (文本 [2], 字符, 字母到全角_ (字符), , , 真))
.变量循环尾 ()
返回 (PathMatchSpec (文本 [1], 文本 [2]))

.子程序 搜寻子窗口_, 整数型, 公开, 返回符合条件的第一个窗口句柄，支持通配符模糊查找。
.参数 父窗口句柄, 整数型, , 在其中查找子的父窗口。如设为零，表示使用桌面窗口。
.参数 第一个子句柄, 整数型, 可空, 如果本参数为0或留空，将从第一个子窗口开始找，如果不为0，将从该子窗口往下找，相当于FindWindowEx函数的第二个参数。
.参数 窗口标题, 文本型, 可空, 支持通配符“*”和“?”，例如要搜寻标题包含“易语言”三个字的窗口就提供参数“*易语言*”。
.参数 窗口类名, 文本型, 可空, 窗口类名和标题可根据实际需要选填一个，也可以都填。支持通配符“*”和“?”。
.参数 区分大小写, 逻辑型, 可空, 默认为假，即不区分，为真区分。

.局部变量 计次, 整数型, , , 
.局部变量 找到, 逻辑型, , , 
.局部变量 句柄数组, 整数型, , "0", 

.计次循环首 (枚举子窗口_ (父窗口句柄, 句柄数组), 计次)
    .如果真 (并且 (不等于 (第一个子句柄, 0), 等于 (句柄数组 [计次], 第一个子句柄)))
        赋值 (找到, 真)
        到循环尾 ()
    .如果真结束
    .如果真 (并且 (等于 (找到, 假), 不等于 (第一个子句柄, 0)))
        到循环尾 ()
         ' 本源码来自易语言资源网(www.5A5X.com)
    .如果真结束
    .如果真 (或者 (并且 (等于 (是否为空 (窗口类名), 假), 等于 (匹配通配符_ (取窗口类名_ (句柄数组 [计次]), 窗口类名, 区分大小写), 假)), 并且 (等于 (是否为空 (窗口标题), 假), 等于 (匹配通配符_ (取窗口标题_ (句柄数组 [计次]), 窗口标题, 区分大小写), 假))))
        到循环尾 ()
    .如果真结束
    返回 (句柄数组 [计次])
.计次循环尾 ()
返回 (0)

.子程序 搜寻顶级窗口_, 整数型, 公开, 返回符合条件的第一个窗口句柄，支持通配符模糊查找。
.参数 窗口标题, 文本型, 可空, 支持通配符“*”和“?”，例如要搜寻标题包含“易语言”三个字的窗口就提供参数“*易语言*”。
.参数 窗口类名, 文本型, 可空, 窗口类名和标题可根据实际需要选填一个，也可以都填。支持通配符“*”和“?”。
.参数 区分大小写, 逻辑型, 可空, 默认为假，即不区分，为真区分。

.局部变量 计次, 整数型, , , 
.局部变量 句柄数组, 整数型, , "0", 

.计次循环首 (枚举顶级窗口_ (句柄数组), 计次)
    .如果真 (或者 (并且 (等于 (是否为空 (窗口类名), 假), 等于 (匹配通配符_ (取窗口类名_ (句柄数组 [计次]), 窗口类名, 区分大小写), 假)), 并且 (等于 (是否为空 (窗口标题), 假), 等于 (匹配通配符_ (取窗口标题_ (句柄数组 [计次]), 窗口标题, 区分大小写), 假))))
        到循环尾 ()
         ' 本源码来自易语言资源网(www.5A5X.com)
    .如果真结束
    返回 (句柄数组 [计次])
.计次循环尾 ()
返回 (0)

.子程序 条件枚举子窗口_, 整数型, 公开, 枚举符合条件的所有子窗口，支持通配符模糊查找，将句柄存入数组中，返回找到的窗口个数。
.参数 父窗口句柄, 整数型, , 在其中查找子的父窗口。如设为零，表示使用桌面窗口。
.参数 第一个子句柄, 整数型, 可空, 如果本参数为0或留空，将从第一个子窗口开始找，如果不为0，将从该子窗口往下找。
.参数 窗口标题, 文本型, 可空, 支持通配符“*”和“?”，例如要搜寻标题包含“易语言”三个字的窗口就提供参数“*易语言*”。
.参数 窗口类名, 文本型, 可空, 窗口类名和标题可根据实际需要选填一个，也可以都填。支持通配符“*”和“?”。
.参数 句柄数组, 整数型, 参考 可空 数组, 请提供变量保存找到的窗口句柄，如果不提供则只返回找到的窗口个数。
.参数 区分大小写, 逻辑型, 可空, 默认为假，即不区分，为真区分。

.局部变量 计次, 整数型, , , 
.局部变量 找到, 逻辑型, , , 
.局部变量 临时, 整数型, , "0", 

清除数组 (句柄数组)
.计次循环首 (枚举子窗口_ (父窗口句柄, 临时), 计次)
    .如果真 (并且 (不等于 (第一个子句柄, 0), 等于 (临时 [计次], 第一个子句柄)))
        赋值 (找到, 真)
        到循环尾 ()
        ' 本源码来自易语言资源网(www.5A5X.com)
    .如果真结束
    .如果真 (并且 (等于 (找到, 假), 不等于 (第一个子句柄, 0)))
        到循环尾 ()
    .如果真结束
    .如果真 (或者 (并且 (等于 (是否为空 (窗口类名), 假), 等于 (匹配通配符_ (取窗口类名_ (临时 [计次]), 窗口类名, 区分大小写), 假)), 并且 (等于 (是否为空 (窗口标题), 假), 等于 (匹配通配符_ (取窗口标题_ (临时 [计次]), 窗口标题, 区分大小写), 假))))
        到循环尾 ()
    .如果真结束
    加入成员 (句柄数组, 临时 [计次])
.计次循环尾 ()
返回 (取数组成员数 (句柄数组))

.子程序 条件枚举顶级窗口_, 整数型, 公开, 枚举符合条件的所有顶级窗口，支通配符持模糊查找，将句柄存入数组中，返回找到的窗口个数。
.参数 窗口标题, 文本型, 可空, 支持通配符“*”和“?”，例如要搜寻标题包含“易语言”三个字的窗口就提供参数“*易语言*”。
.参数 窗口类名, 文本型, 可空, 窗口类名和标题可根据实际需要选填一个，也可以都填。支持通配符“*”和“?”。
.参数 句柄数组, 整数型, 参考 可空 数组, 请提供变量保存找到的窗口句柄，如果不提供则只返回找到的窗口个数。
.参数 区分大小写, 逻辑型, 可空, 默认为假，即不区分，为真区分。

.局部变量 计次, 整数型, , , 
.局部变量 临时, 整数型, , "0", 

清除数组 (句柄数组)
.计次循环首 (枚举顶级窗口_ (临时), 计次)
    .如果真 (或者 (并且 (等于 (是否为空 (窗口类名), 假), 等于 (匹配通配符_ (取窗口类名_ (临时 [计次]), 窗口类名, 区分大小写), 假)), 并且 (等于 (是否为空 (窗口标题), 假), 等于 (匹配通配符_ (取窗口标题_ (临时 [计次]), 窗口标题, 区分大小写), 假))))
        到循环尾 ()
        ' 本源码来自易语言资源网(www.5A5X.com)
    .如果真结束
    加入成员 (句柄数组, 临时 [计次])
.计次循环尾 ()
返回 (取数组成员数 (句柄数组))

.子程序 枚举顶级窗口_, 整数型, 公开, 枚举所有的顶级窗口，将句柄存入数组中，返回找到的窗口个数。
.参数 句柄数组, 整数型, 参考 可空 数组, 请提供一个整数型数组接收找到的窗口句柄。

.局部变量 地址, 整数型, , , 

重定义数组 (句柄数组, 假, 4096)
赋值 (地址, EnumWindows (&枚举函数, 句柄数组))
重定义数组 (句柄数组, 真, 相除 (字节集_到整数 (指针到字节集 (地址, 4)), 4))
写到内存 (0, 地址, )
返回 (取数组成员数 (句柄数组))

.子程序 枚举子窗口_, 整数型, 公开, 枚举在指定父窗口下的所有的子窗口，将句柄存入数组中，返回找到的窗口个数。
.参数 父窗口句柄, 整数型, , 在其中查找子的父窗口。如设为零，表示使用桌面窗口。
.参数 句柄数组, 整数型, 参考 可空 数组, 请提供一个整数型数组接收找到的窗口句柄。

.局部变量 地址, 整数型, , , 

重定义数组 (句柄数组, 假, 4096)
 ' 本源码来自易语言资源网(www.5A5X.com)
赋值 (地址, EnumChildWindows (父窗口句柄, &枚举函数, 句柄数组))
重定义数组 (句柄数组, 真, 相除 (字节集_到整数 (指针到字节集 (地址, 4)), 4))
写到内存 (0, 地址, )
返回 (取数组成员数 (句柄数组))

.子程序 枚举进程窗口_, 整数型, 公开, 枚举某进程创建的所有的顶级窗口的句柄，保存入数组中,返回找到的窗口个数。
.参数 进程PID, 整数型, , 
.参数 句柄数组, 整数型, 参考 可空 数组, 请提供一个整数型数组接收找到的窗口句柄(返回的数组的第一个成员一般就是进程的主窗口或可视窗口的句柄)。

.局部变量 计次, 整数型, , , 
.局部变量 临时, 整数型, , "0", 

清除数组 (句柄数组)
.计次循环首 (枚举顶级窗口_ (临时), 计次)
    .如果真 (等于 (窗口句柄取PID_ (临时 [计次]), 进程PID))
        加入成员 (句柄数组, 临时 [计次])
    .如果真结束
     ' 本源码来自易语言资源网(www.5A5X.com)
.计次循环尾 ()
返回 (取数组成员数 (句柄数组))

.子程序 枚举线程窗口_, 整数型, 公开, 枚举某线程创建的所有的顶级窗口的句柄，保存入数组中,返回找到的窗口个数。
.参数 线程ID, 整数型, , 
.参数 句柄数组, 整数型, 参考 可空 数组, 请提供一个整数型数组接收找到的窗口句柄。

.局部变量 计次, 整数型, , , 
.局部变量 临时, 整数型, , "0", 

清除数组 (句柄数组)
' 本源码来自易语言资源网(www.5A5X.com)
.计次循环首 (枚举顶级窗口_ (临时), 计次)
    .如果真 (等于 (GetWindowThreadProcessId (临时 [计次], 0), 线程ID))
        加入成员 (句柄数组, 临时 [计次])
    .如果真结束
    
.计次循环尾 ()
返回 (取数组成员数 (句柄数组))

.子程序 取窗口信息_, 窗口信息, 公开, 可以返回关于窗口的N多信息..如果觉得还不够请提出还需要什么信息..
.参数 窗口句柄, 整数型, , 
.参数 不枚举进程扩展信息, 逻辑型, 可空, 默认为假，为假则枚举窗口所在进程的模块列表和线程列表；为真则不枚举，不枚举可提高取信息速度。

.局部变量 信息, 窗口信息, , , 
.局部变量 RECT, RECT, , , 
.局部变量 mod, LPMODULEENTRY32, , , 
.局部变量 End, 整数型, , , 
.局部变量 快照句柄, 整数型, , , 
.局部变量 buffer, THREADENTRY32, , , 

清除数组 (信息.进程模块列表)
清除数组 (信息.进程线程ID列表)
.如果真 (等于 (IsWindow (窗口句柄), 假))
    ' 本源码来自易语言资源网(www.5A5X.com)
    返回 (信息)
.如果真结束
赋值 (信息.窗口句柄, 窗口句柄)
赋值 (信息.标题, 取窗口标题_ (窗口句柄))
赋值 (信息.类名, 取窗口类名_ (窗口句柄))
GetWindowRect (窗口句柄, RECT)
赋值 (信息.左边, RECT.Left)
赋值 (信息.顶边, RECT.Top)
赋值 (信息.宽度, 相减 (RECT.Right, RECT.Left))
赋值 (信息.高度, 相减 (RECT.Bottom, RECT.Top))
 ' 本源码来自易语言资源网(www.5A5X.com)
赋值 (信息.可视, IsWindowVisible (窗口句柄))
赋值 (信息.光标句柄, GetClassLong (窗口句柄, -12))
赋值 (信息.图标句柄, 取窗口图标_ (窗口句柄))
赋值 (信息.窗口样式, GetWindowLong (窗口句柄, -16))
赋值 (信息.扩展样式, GetWindowLong (窗口句柄, -20))
赋值 (信息.父窗口句柄, GetWindowLong (窗口句柄, -8))
赋值 (信息.祖宗窗口句柄, GetAncestor (窗口句柄, 2))
赋值 (信息.所属线程ID, GetWindowThreadProcessId (窗口句柄, 信息.所属进程PID))
赋值 (快照句柄, CreateToolhelp32Snapshot (8, 信息.所属进程PID))
.如果真 (大于 (快照句柄, 0))
    赋值 (mod.size, 1024)
    赋值 (End, Module32First (快照句柄, mod))
    赋值 (信息.所属进程名, 到文本 (mod.szname))
    赋值 (信息.进程路径, 到文本 (mod.szpath))
    .如果真 (等于 (不枚举进程扩展信息, 假))
         ' 本源码来自易语言资源网(www.5A5X.com)
        .判断循环首 (不等于 (End, 0))
            加入成员 (信息.进程模块列表, 到文本 (mod.szpath))
            赋值 (End, Module32Next (快照句柄, mod))
        .判断循环尾 ()
        CloseHandle (快照句柄)
         ' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        赋值 (快照句柄, CreateToolhelp32Snapshot (4, 0))
        赋值 (buffer.dwsize, 28)
        赋值 (End, Thread32First (快照句柄, buffer))
        .判断循环首 (不等于 (End, 0))
            .如果真 (等于 (buffer.th32OwnerProcessID, 信息.所属进程PID))
                加入成员 (信息.进程线程ID列表, buffer.th32threadID)
            .如果真结束
            赋值 (End, Thread32Next (快照句柄, buffer))
        .判断循环尾 ()
         ' 本源码来自易语言资源网(www.5A5X.com)
    .如果真结束
    CloseHandle (快照句柄)
.如果真结束
返回 (信息)

.子程序 禁止窗口_, 整数型, 公开, 如果窗口原来是被禁止的，返回值不为零；如果窗口原来不是被禁止的，返回值为零。
.参数 窗口句柄, 整数型, , 
.参数 禁止, 逻辑型, 可空, 默认为真，为假则恢复。

返回 (EnableWindow (窗口句柄, 选择 (是否为空 (禁止), 0, 选择 (禁止, 0, 1))))

.子程序 改变窗口状态_, 逻辑型, 公开, 改变窗口的显示状态。
.参数 窗口句柄, 整数型, , 
.参数 新状态, 整数型, 可空, 1.#隐藏窗口; 2.#普通激活; 3.#最小化激活; 4.#最大化激活; 5.#普通不激活; 6.#最小化不激活。默认为2.#普通激活。

.如果真 (等于 (IsWindow (窗口句柄), 假))
    返回 (假)
    ' 本源码来自易语言资源网(www.5A5X.com)
.如果真结束
.如果 (或者 (等于 (新状态, 2), 是否为空 (新状态)))
    ShowWindow (窗口句柄, 2)
    OpenIcon (窗口句柄)
.否则
    ShowWindow (窗口句柄, 多项选择 (新状态, 0, 5, 2, 3, 8, 7))
.如果结束
返回 (真)

.子程序 取窗口祖宗_, 整数型, 公开, 返回窗口祖宗的句柄..这个名字..有点搞笑..窗口祖宗就是指定窗口的父窗口的父窗口的父窗口……到顶级窗口为止..
.参数 窗口句柄, 整数型, , 

返回 (GetAncestor (窗口句柄, 2))
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 置父窗口_, 整数型, 公开, 返回原父窗口句柄。 
.参数 窗口句柄, 整数型, , 
.参数 新父窗口句柄, 整数型, , 

返回 (SetParent (窗口句柄, 新父窗口句柄))

.子程序 取父窗口句柄_, 整数型, 公开, 
.参数 窗口句柄, 整数型, , 

返回 (GetWindowLong (窗口句柄, -8))

.子程序 取内存图标句柄_, 整数型, 公开, 从标准ico文件数据中返回图标句柄。参考了 凌晨孤星 的代码，并自行修改了一下。
.参数 图标数据, 字节集, , 
.参数 载入规格, 整数型, 可空, 1、16×16；2、32×32；3、48×48；4、64×64；5、72×72；6、96×96；7、128×128；8、256×256.，默认为2。

.局部变量 IconDirEntry, IconDirEntry, , , 
.局部变量 图标个数, 整数型, , , 
.局部变量 计次, 整数型, , , 

.如果真 (或者 (是否为空 (载入规格), 小于 (载入规格, 1), 大于 (载入规格, 8)))
    赋值 (载入规格, 2)
.如果真结束
赋值 (图标个数, 字节集_到整数 (取字节集中间 (图标数据, 5, 2)))
.计次循环首 (图标个数, 计次)
    ' 本源码来自易语言资源网(www.5A5X.com)
    CopyMemory_Icon (IconDirEntry, 取字节集中间 (图标数据, 相加 (6, 相乘 (相减 (计次, 1), 16), 1), 16), 16)
    .如果真 (或者 (等于 (IconDirEntry.bWidth, 多项选择 (载入规格, 16, 32, 48, 64, 72, 96, 128, 256)), 等于 (图标个数, 计次)))
        返回 (CreateIconFromResource (取字节集中间 (图标数据, 相加 (IconDirEntry.dwImageOffset, 1), IconDirEntry.dwBytesInRes), IconDirEntry.dwBytesInRes, 真, 196608))
    .如果真结束
    
.计次循环尾 ()
返回 (0)

.子程序 改变窗口位置_, 逻辑型, 公开, 
.参数 窗口句柄, 整数型, , 
.参数 新左边, 整数型, 可空, 留空该项则保持原来的左边。
.参数 新顶边, 整数型, 可空, 留空该项则保持原来的顶边。

.局部变量 RECT, RECT, , , 

GetWindowRect (窗口句柄, RECT)
' 本源码来自易语言资源网(www.5A5X.com)
返回 (不等于 (SetWindowPos (窗口句柄, 0, 选择 (是否为空 (新左边), RECT.Left, 新左边), 选择 (是否为空 (新顶边), RECT.Top, 新顶边), 0, 0, 5), 0))

.子程序 改变窗口大小_, 逻辑型, 公开, 
.参数 窗口句柄, 整数型, , 
.参数 新宽度, 整数型, 可空, 留空该项则保持原来的宽度。
.参数 新高度, 整数型, 可空, 留空该项则保持原来的高度。

.局部变量 RECT, RECT, , , 

GetWindowRect (窗口句柄, RECT)
返回 (不等于 (SetWindowPos (窗口句柄, 0, 0, 0, 选择 (是否为空 (新宽度), 相减 (RECT.Right, RECT.Left), 新宽度), 选择 (是否为空 (新高度), 相减 (RECT.Bottom, RECT.Top), 新高度), 6), 0))

.子程序 置窗口图标_, 逻辑型, 公开, 替换任意窗口的图标(不是本进程的窗口也可以)。
.参数 窗口句柄, 整数型, , 
.参数 新图标句柄, 整数型, , 可以使用 取内存图标句柄()得到的图标句柄或使用其他方式得到的有效图标句柄。

.局部变量 PID, 整数型, , , 
.局部变量 临时, 整数型, , "5", 
.局部变量 进程句柄, 整数型, , , 
.局部变量 线程句柄, 整数型, , , 

.如果真 (或者 (等于 (IsWindow (窗口句柄), 假), 等于 (GetIconInfo (新图标句柄, 临时), 0)))
    返回 (假)
.如果真结束
赋值 (PID, 窗口句柄取PID_ (窗口句柄))
' 本源码来自易语言资源网(www.5A5X.com)
.如果真 (不等于 (PID, GetCurrentProcessId ()))
    赋值 (进程句柄, OpenProcess (2035711, 0, PID))
    .如果真 (等于 (进程句柄, 0))
        返回 (假)
    .如果真结束
     ' 2010308482 ＝ CopyIcon
    赋值 (线程句柄, CreateRemoteThread (进程句柄, 0, 0, 2010308482, 新图标句柄, 0, 0))
    赋值 (新图标句柄, 0)
    .如果真 (不等于 (线程句柄, 0))
        WaitForSingleObject (线程句柄, -1)
        GetExitCodeThread (线程句柄, 新图标句柄)
        CloseHandle (线程句柄)
    .如果真结束
    CloseHandle (进程句柄)
.如果真结束
.如果真 (等于 (新图标句柄, 0))
     ' 本源码来自易语言资源网(www.5A5X.com)
    返回 (假)
.如果真结束
SendMessage (窗口句柄, 128, 0, 新图标句柄)
SendMessage (窗口句柄, 128, 1, 新图标句柄)
返回 (真)

.子程序 窗口句柄取PID_, 整数型, 公开, 
.参数 窗口句柄, 整数型, , 
.参数 线程ID, 整数型, 参考 可空, 可以提供变量接收窗口所在线程ID

.局部变量 PID, 整数型, , , 

赋值 (线程ID, GetWindowThreadProcessId (窗口句柄, PID))
返回 (PID)
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 取窗口图标_, 整数型, 公开, 返回窗口图标句柄。
.参数 窗口句柄, 整数型, , 

.局部变量 图标句柄, 整数型, , , 

赋值 (图标句柄, SendMessage (窗口句柄, 127, 0, 0))
.如果真 (等于 (图标句柄, 0))
    ' 本源码来自易语言资源网(www.5A5X.com)
    赋值 (图标句柄, SendMessage (窗口句柄, 127, 1, 0))
.如果真结束
.如果真 (等于 (图标句柄, 0))
    赋值 (图标句柄, GetClassLong (窗口句柄, -14))
.如果真结束
.如果真 (等于 (图标句柄, 0))
    赋值 (图标句柄, GetClassLong (窗口句柄, -34))
.如果真结束
返回 (图标句柄)

.子程序 取窗口左边_, 整数型, 公开, 
.参数 窗口句柄, 整数型, , 

.局部变量 RECT, RECT, , , 

GetWindowRect (窗口句柄, RECT)
返回 (RECT.Left)
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 取窗口顶边_, 整数型, 公开, 
.参数 窗口句柄, 整数型, , 

.局部变量 RECT, RECT, , , 

GetWindowRect (窗口句柄, RECT)
返回 (RECT.Top)

.子程序 取窗口宽度_, 整数型, 公开, 
.参数 窗口句柄, 整数型, , 

.局部变量 RECT, RECT, , , 

GetWindowRect (窗口句柄, RECT)
返回 (相减 (RECT.Right, RECT.Left))
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 取窗口高度_, 整数型, 公开, 
.参数 窗口句柄, 整数型, , 

.局部变量 RECT, RECT, , , 

GetWindowRect (窗口句柄, RECT)
返回 (相减 (RECT.Bottom, RECT.Top))

.子程序 取窗口标题_, 文本型, 公开, 
.参数 窗口句柄, 整数型, , 

.局部变量 长度, 整数型, , , 
.局部变量 文本, 文本型, , , 

赋值 (长度, SendMessage (窗口句柄, 14, 0, 0))
.如果真 (大于 (长度, 0))
    赋值 (文本, 取空白文本 (长度))
    SendMessage (窗口句柄, 13, 相加 (长度, 1), lstrcpyn_文本 (文本, 文本, 0))
.如果真结束
返回 (文本)
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 取窗口类名_, 文本型, 公开, 
.参数 窗口句柄, 整数型, , 

.局部变量 文本, 文本型, , , 

赋值 (文本, 取空白文本 (1025))
GetClassName (窗口句柄, 文本, 1024)
返回 (文本)

.子程序 置窗口标题_, 逻辑型, 公开, 
.参数 窗口句柄, 整数型, , 
.参数 新标题, 文本型, , 

返回 (不等于 (SendMessage (窗口句柄, 12, 0, lstrcpyn_文本 (新标题, 新标题, 0)), 0))
' 本源码来自易语言资源网(www.5A5X.com)


 ' 不属于任何一个程序集、类模块的函数：
