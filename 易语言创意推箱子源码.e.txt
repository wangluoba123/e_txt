 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 424
    高度 = 467
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “创意推箱子”
    帮助文件名 = “”



.常量 地板, "10", , "　"
.常量 目的地, "20", , ※
.常量 墙, "30", , ●
.常量 小人, "11", , ♀
.常量 箱子, "12", , ○
.常量 小人在目的地, "21", , ♀
.常量 箱子在目的地, "22", , ¤


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库




.全局变量 当前地图, 字节集, 公开, , 
.全局变量 当前关卡, 整数型, 公开, , 
.全局变量 关卡数据, 字节集, 公开, "0", 
.全局变量 待刷新, 逻辑型, , , 

.窗口程序集 窗口程序集1, , , 

.子程序 _字符画编辑框_内容被改变, 空白型, , 
 ' 刷新数据 ()
赋值 (待刷新, 真)
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--


.子程序 _左上按钮_被单击, 空白型, , 
小人移动 (-1, -1)


.子程序 _右上按钮_被单击, 空白型, , 
小人移动 (0, -1)

.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (当前关卡, 1)

 ' 、   ●●●●
 ' 、  ●※●※●
 ' 、 ●●○○●●
 ' 、●※○♀○※●
 ' 、 ●●○○●●
 ' 、  ●※●※●
 ' 、   ●●●●
加入成员 (关卡数据, 到字节集 ({ 7, 0, 7, 0, 30, 30, 30, 30, 10, 10, 10, 30, 20, 30, 20, 30, 10, 10, 30, 30, 12, 12, 30, 30, 10, 30, 20, 12, 11, 12, 20, 30, 10, 30, 30, 12, 12, 30, 30, 10, 10, 30, 20, 30, 20, 30, 10, 10, 10, 30, 30, 30, 30 })) ' 第1关

 ' 、        ●●
 ' 、       ●  ●●●●
 ' 、      ●      ○  ●
 ' 、     ●  ●●○○  ●
 ' 、  ●●  ●  ♀    ●
 ' 、 ●    ●●●●○  ●
 ' 、●    ※※※※●  ●
 ' 、 ●●●●●●●●●
加入成员 (关卡数据, 到字节集 ({ 10, 0, 8, 0, 10, 30, 30, 10, 10, 10, 10, 10, 10, 10, 10, 30, 10, 30, 30, 30, 30, 10, 10, 10, 10, 30, 10, 10, 10, 12, 10, 30, 10, 10, 10, 30, 10, 30, 30, 12, 12, 10, 30, 10, 30, 30, 10, 30, 10, 11, 10, 10, 30, 10, 30, 10, 10, 30, 30, 30, 30, 12, 10, 30, 30, 10, 10, 20, 20, 20, 20, 30, 10, 30, 10, 30, 30, 30, 30, 30, 30, 30, 30, 30 })) ' 第2关

 ' 、    ●●●
 ' 、 ●●    ●
 ' 、●    ○●
 ' 、 ●●  ○●
 ' 、  ●○♀  ●
 ' 、 ●※○○  ●
 ' 、●※¤※※●
 ' 、 ●●●●●
加入成员 (关卡数据, 到字节集 ({ 7, 0, 8, 0, 30, 30, 30, 10, 10, 10, 10, 30, 20, 10, 30, 10, 10, 10, 30, 10, 12, 30, 10, 10, 10, 10, 30, 10, 12, 30, 10, 10, 10, 30, 12, 11, 10, 30, 10, 10, 30, 20, 12, 12, 10, 30, 10, 30, 20, 22, 20, 20, 30, 10, 10, 30, 30, 30, 30, 30 })) ' 第3关
数据复位 ()

.子程序 _复位按钮_被单击, 空白型, , 
数据复位 ()


.子程序 数据复位, 空白型, , 
赋值 (当前地图, 关卡数据 [当前关卡])
刷新字符画 ()


.子程序 刷新字符画, 空白型, , 
赋值 (., 地图到字符画 (当前地图))
赋值 (., 到文本 (当前关卡))
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 地图到字符画, 文本型, , 
.参数 地图, 字节集, , 

.局部变量 地图宽度, 整数型, , , 
.局部变量 地图高度, 整数型, , , 
.局部变量 可左移字节数, 整数型, , , 
.局部变量 x, 整数型, , , 
.局部变量 y, 整数型, , , 
.局部变量 字符画, 文本型, , , 
.局部变量 字符画当前行, 文本型, , , 

赋值 (地图宽度, 相加 (地图 [1], 相乘 (地图 [2], 256)))
赋值 (地图高度, 相加 (地图 [3], 相乘 (地图 [4], 256)))

赋值 (字符画, “”)
赋值 (字符画当前行, “”)

.计次循环首 (地图高度, y)
    赋值 (字符画当前行, 相加 (字符画当前行, 取重复文本 (相减 (地图高度, y), “ ”)))
    .计次循环首 (地图宽度, x)
        赋值 (字符画当前行, 相加 (字符画当前行, 地图元素到字符 (地图 [相加 (4, 相乘 (相减 (y, 1), 地图宽度), x)])))
    .计次循环尾 ()
    赋值 (字符画当前行, 子文本替换 (字符画当前行, “　”, “  ”, , , 假))
    赋值 (字符画当前行, 删尾空 (字符画当前行))
    赋值 (字符画, 相加 (字符画, 字符画当前行, #换行符))
    赋值 (字符画当前行, “”)
.计次循环尾 ()
返回 (子文本替换 (字符画, “  ”, “　”, , , 假))
 ' 本源码来自易语言资源网(www.5A5X.com)


.子程序 地图元素到字符, 文本型, , 
.参数 地图元素, 整数型, , 

.如果真 (等于 (地图元素, #墙))
    返回 (“●”)
.如果真结束

.如果真 (等于 (地图元素, #地板))
    返回 (“　”)
.如果真结束

.如果真 (等于 (地图元素, #目的地))
    返回 (“※”)
.如果真结束

.如果真 (等于 (地图元素, #小人))
    返回 (“♀”)
.如果真结束

.如果真 (等于 (地图元素, #小人在目的地))
    返回 (“♀”)
     ' 本源码来自易语言资源网(www.5A5X.com)
.如果真结束


.如果真 (等于 (地图元素, #箱子))
    返回 (“○”)
.如果真结束

.如果真 (等于 (地图元素, #箱子在目的地))
    返回 (“¤”)
.如果真结束

返回 (“？”)

.子程序 __启动窗口_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

获得键盘输入 (键代码)


.子程序 _时钟1_周期事件, 空白型, , 
.如果真 (待刷新)
    刷新字符画 ()
    赋值 (待刷新, 假)
.如果真结束
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _关卡数编辑框_内容被改变, 空白型, , 
赋值 (待刷新, 真)

.子程序 小人移动, 空白型, , 
.参数 移动x, 整数型, , 
.参数 移动y, 整数型, , 

.局部变量 地图宽度, 整数型, , , 
.局部变量 地图高度, 整数型, , , 
.局部变量 小人x, 整数型, , , 
.局部变量 小人y, 整数型, , , 
.局部变量 当前元素, 整数型, , , 
.局部变量 x, 整数型, , , 
.局部变量 y, 整数型, , , 
.局部变量 小人移动目标的地图元素, 整数型, , , 
.局部变量 箱子移动目标的地图元素, 整数型, , , 

赋值 (地图宽度, 相加 (当前地图 [1], 相乘 (当前地图 [2], 256)))
赋值 (地图高度, 相加 (当前地图 [3], 相乘 (当前地图 [4], 256)))
赋值 (小人x, 0)
赋值 (小人y, 0)

.计次循环首 (地图宽度, x)
    .计次循环首 (地图高度, y)
        赋值 (当前元素, 当前地图 [相加 (4, 相乘 (相减 (y, 1), 地图宽度), x)])
        .如果真 (或者 (等于 (当前元素, #小人), 等于 (当前元素, #小人在目的地)))
            赋值 (小人x, x)
            赋值 (小人y, y)
            跳出循环 ()
        .如果真结束
         ' 本源码来自易语言资源网(www.5A5X.com)
    .计次循环尾 ()
    .如果真 (不等于 (小人x, 0))
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()

.如果真 (或者 (小于或等于 (相加 (小人x, 移动x), 0), 大于 (相加 (小人x, 移动x), 地图宽度))) ' 移动后超出边界,无法移动
    赋值 (待刷新, 真)
    返回 ()
.如果真结束

.如果真 (或者 (小于或等于 (相加 (小人y, 移动y), 0), 大于 (相加 (小人y, 移动y), 地图高度))) ' 移动后超出边界,无法移动
    赋值 (待刷新, 真)
    返回 ()
.如果真结束

赋值 (小人移动目标的地图元素, 当前地图 [相加 (4, 相乘 (相减 (相加 (小人y, 移动y), 1), 地图宽度), 小人x, 移动x)])
.如果真 (或者 (等于 (小人移动目标的地图元素, #地板), 等于 (小人移动目标的地图元素, #目的地))) ' 小人走过去，不推箱子
    .如果真 (并且 (不等于 (当前地图 [相加 (4, 相乘 (相减 (小人y, 1), 地图宽度), 小人x)], #小人), 不等于 (当前地图 [相加 (4, 相乘 (相减 (小人y, 1), 地图宽度), 小人x)], #小人在目的地)))
        信息框 (“程序内部错误！小人的位置有错！”, 0, )
        信息框 (地图元素到字符 (当前地图 [相加 (4, 相乘 (相减 (小人y, 1), 地图宽度), 小人x)]), 0, )
    .如果真结束
    
    赋值 (当前地图 [相加 (4, 相乘 (相减 (小人y, 1), 地图宽度), 小人x)], 相减 (当前地图 [相加 (4, 相乘 (相减 (小人y, 1), 地图宽度), 小人x)], 1)) ' 小人走掉了
    赋值 (当前地图 [相加 (4, 相乘 (相减 (相加 (小人y, 移动y), 1), 地图宽度), 小人x, 移动x)], 相加 (小人移动目标的地图元素, 1)) ' 小人走来了
    赋值 (待刷新, 真)
    返回 ()
.如果真结束
 ' 本源码来自易语言资源网(www.5A5X.com)
.如果真 (等于 (小人移动目标的地图元素, #墙)) ' 小人走向一堵墙,无法移动
    赋值 (待刷新, 真)
    返回 ()
.如果真结束

.如果真 (或者 (等于 (小人移动目标的地图元素, #箱子), 等于 (小人移动目标的地图元素, #箱子在目的地))) ' 小人走向箱子
    .如果真 (或者 (小于或等于 (相加 (小人x, 移动x, 移动x), 0), 大于 (相加 (小人x, 移动x, 移动x), 地图宽度))) ' 箱子被推后超出边界,无法移动
        赋值 (待刷新, 真)
        返回 ()
    .如果真结束
    
    .如果真 (或者 (小于或等于 (相加 (小人y, 移动y, 移动y), 0), 大于 (相加 (小人y, 移动y, 移动y), 地图高度))) ' 箱子被推后超出边界,无法移动
        赋值 (待刷新, 真)
        返回 ()
    .如果真结束
    
    赋值 (箱子移动目标的地图元素, 当前地图 [相加 (4, 相乘 (相减 (相加 (小人y, 移动y, 移动y), 1), 地图宽度), 小人x, 移动x, 移动x)])
    .如果真 (或者 (等于 (箱子移动目标的地图元素, #地板), 等于 (箱子移动目标的地图元素, #目的地))) ' 小人推箱子，箱子可以移动
         ' 本源码来自易语言资源网(www.5A5X.com)
        赋值 (当前地图 [相加 (4, 相乘 (相减 (小人y, 1), 地图宽度), 小人x)], 相减 (当前地图 [相加 (4, 相乘 (相减 (小人y, 1), 地图宽度), 小人x)], 1)) ' 小人走掉了
        赋值 (当前地图 [相加 (4, 相乘 (相减 (相加 (小人y, 移动y), 1), 地图宽度), 小人x, 移动x)], 相减 (小人移动目标的地图元素, 1)) ' 小人走来了，箱子被推走了，重量减少了1(小人重量1，箱子重量2)
        赋值 (当前地图 [相加 (4, 相乘 (相减 (相加 (小人y, 移动y, 移动y), 1), 地图宽度), 小人x, 移动x, 移动x)], 相加 (箱子移动目标的地图元素, 2)) ' 箱子被推来了
        赋值 (待刷新, 真)
        .如果真 (已经完成 ())
            
            .如果 (小于 (当前关卡, 取数组成员数 (关卡数据)))
                信息框 (“完成！！！”, 0, “推箱子”)
                赋值 (当前关卡, 相加 (当前关卡, 1))
                数据复位 ()
                
            .否则
                信息框 (“所有关卡已完成！！！”, 0, “推箱子”)
            .如果结束
            
        .如果真结束
        
        返回 ()
    .如果真结束
    
    .如果真 (并且 (不等于 (箱子移动目标的地图元素, #墙), 不等于 (箱子移动目标的地图元素, #箱子), 不等于 (箱子移动目标的地图元素, #箱子在目的地)))
        信息框 (“程序内部错误！无法识别的地图元素！”, 0, )
        信息框 (地图元素到字符 (箱子移动目标的地图元素), 0, )
    .如果真结束
    
    
     ' 本源码来自易语言资源网(www.5A5X.com)
    
.如果真结束



.子程序 _右按钮_被单击, 空白型, , 
小人移动 (1, 0)

.子程序 _右下按钮_被单击, 空白型, , 
小人移动 (1, 1)


.子程序 _左下按钮_被单击, 空白型, , 
小人移动 (0, 1)

.子程序 _左按钮_被单击, 空白型, , 
小人移动 (-1, 0)

.子程序 已经完成, 逻辑型, , 
返回 (等于 (寻找字节集 (当前地图, { 12 }, 5), -1))

.子程序 获得键盘输入, 空白型, , 
.参数 字符代码, 整数型, , 

 ' 信息框 (“字符代码=” ＋ 到文本 (字符代码) ＋ “ #A键=” ＋ 到文本 (#A键), 0, )
.如果真 (等于 (字符代码, #A键)) ' 左
    小人移动 (-1, 0)
.如果真结束

.如果真 (等于 (字符代码, #W键)) ' 左上
    小人移动 (-1, -1)
.如果真结束

.如果真 (等于 (字符代码, #E键)) ' 右上
    小人移动 (0, -1)
.如果真结束

.如果真 (等于 (字符代码, #D键)) ' 右
    小人移动 (1, 0)
.如果真结束
 ' 本源码来自易语言资源网(www.5A5X.com)
.如果真 (等于 (字符代码, #X键)) ' 右下
    小人移动 (1, 1)
.如果真结束

.如果真 (等于 (字符代码, #Z键)) ' 左下
    小人移动 (0, 1)
.如果真结束

.如果真 (等于 (字符代码, #O键))
    数据复位 ()
.如果真结束


.子程序 _复位按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

获得键盘输入 (键代码)


.子程序 _字符画编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

获得键盘输入 (键代码)
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _左上按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

获得键盘输入 (键代码)

.子程序 _右上按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

获得键盘输入 (键代码)

.子程序 _右按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

获得键盘输入 (键代码)

.子程序 _右下按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

获得键盘输入 (键代码)

.子程序 _左下按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

获得键盘输入 (键代码)
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _左按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

获得键盘输入 (键代码)

.子程序 _关卡数编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

获得键盘输入 (键代码)

.子程序 _关于按钮_被单击, 空白型, , 
信息框 (“创意推箱子，作者 正态分布，2010年8月10日。”, 0, “关于”)
' 本源码来自易语言资源网(www.5A5X.com)


 ' 不属于任何一个程序集、类模块的函数：
