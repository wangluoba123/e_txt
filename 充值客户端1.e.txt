 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 229
    高度 = 208
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “客户端”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 415
    高度 = 242
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库





.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
.如果 (等于 (“localhost”.连接 (2007), 假)) ' localhost是指本机地址
    信息框 (“连接冲值服务器错误！”, 0, )
     ' 结束 ()
.否则
    
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
.如果 (或者 (小于 (取文本长度 (.), 6), 小于 (取文本长度 (.), 6))) ' 少于6位
    信息框 (“用户名字或密码没有填写完整！”, 48, )
    返回 ()
.否则
    
.如果结束
相加 (“づ登陆の”, #换行符, ., #换行符, .).发送数据 () ' 发送数据到服务器+“づ登陆の”是为了分辨数据

.子程序 _按钮2_被单击, 空白型, , 
.如果 (不等于 (取文本左边 (., 2), “CZ”)) ' CZ是冲值卡号的标记，一般的冲值卡都有的，如：CZ00000001
    信息框 (“请输入正确的冲值卡号！”, 64, “错误”)
    获取焦点 ()
    赋值 (., -1)
    返回 ()
.否则
    
.如果结束
.如果 (小于 (取文本长度 (.), 8))
    信息框 (“冲值密码少于8位”, 0, )
    获取焦点 ()
    赋值 (., -1)
    返回 ()
.否则
    
.如果结束
.如果 (小于 (取文本长度 (.), 6))
    信息框 (“用户帐号少于6位”, 0, )
    获取焦点 ()
    赋值 (., -1)
    返回 ()
.否则
    
.如果结束
.如果 (小于 (取文本长度 (.), 6))
    信息框 (“用户密码少于6位”, 0, )
    获取焦点 ()
    赋值 (., -1)
    返回 ()
.否则
    
.如果结束
.如果 (等于 (., 真))
    .如果 (等于 (相加 (“お新用户ァ”, #换行符, ., #换行符, ., #换行符, ., #换行符, .).发送数据 (), 假))
        信息框 (“连接服务器失败！”, 64, “冲值错误”)
        输出调试文本 (“1”)
    .否则
        
    .如果结束
    
.否则
    .如果 (等于 (相加 (“お用户々”, #换行符, ., #换行符, ., #换行符, ., #换行符, .).发送数据 (), 假))
        信息框 (“连接服务器失败！”, 64, “冲值错误”)
        输出调试文本 (“2”)
    .否则
        
    .如果结束
    
.如果结束


.子程序 _按钮3_被单击, 空白型, , 
.如果 (不等于 (., .))
    信息框 (“两次输入的密码不正确！”, 16, “错误”)
    返回 ()
.否则
    
.如果结束
相加 (“ぎ改密げ”, #换行符, ., #换行符, ., #换行符, .).发送数据 ()

.子程序 _客户1_数据到达, 空白型, , 
.局部变量 数组, 文本型, , "0", 
.局部变量 数组1, 文本型, , "0", 
.局部变量 t, 文本型, , "0", 

输出调试文本 (到文本 (取回数据 ()))
.如果 (不等于 (寻找文本 (到文本 (取回数据 ()), “无用户”, , 假), -1))
    信息框 (“用户名不存在，请注册后再登陆！”, 64, “提示”)
    返回 ()
.否则
    
.如果结束
.如果 (不等于 (寻找文本 (到文本 (取回数据 ()), “失败”, , 假), -1))
    信息框 (“密码错误请核对后再登陆！”, 64, “提示”)
    返回 ()
.否则
    
.如果结束
.如果 (不等于 (寻找文本 (到文本 (取回数据 ()), “在线”, , 假), -1))
    信息框 (“该用户目前已经登陆，请不要重复登陆！”, 64, “提示”)
    返回 ()
.否则
    
.如果结束
.如果 (不等于 (寻找文本 (到文本 (取回数据 ()), “成功$”, , 假), -1))
    赋值 (数组, 分割文本 (到文本 (取回数据 ()), “$”, ))
    信息框 (相加 (“登陆成功！剩余次数为： ”, 数组 [2], “ 次！”), 64, “提示”)
    重定义数组 (数组, 假, 0)
    载入 (窗口1, , 真)
    返回 ()
.否则
    
.如果结束
.如果 (不等于 (寻找文本 (到文本 (取回数据 ()), “存在”, , 假), -1))
    信息框 (相加 (“该用户目前已经存在，请更换您的用户名字！”, #换行符, “如果用户已经存在请直接冲值！”), 64, “提示”)
    获取焦点 ()
    赋值 (., -1)
    返回 ()
.否则
    
.如果结束
.如果 (不等于 (寻找文本 (到文本 (取回数据 ()), “错误卡号”, , 假), -1))
    信息框 (“冲值卡号错误，请直接复制卡号！”, 64, “提示”)
    获取焦点 ()
    赋值 (., -1)
    返回 ()
.否则
    
.如果结束
.如果 (不等于 (寻找文本 (到文本 (取回数据 ()), “错误密码”, , 假), -1))
    信息框 (“冲值密码错误，请直接复制密码！”, 64, “提示”)
    获取焦点 ()
    赋值 (., -1)
    返回 ()
.否则
    
.如果结束
.如果 (不等于 (寻找文本 (到文本 (取回数据 ()), “已冲值”, , 假), -1))
    信息框 (“此冲值卡已被使用，请不要重复使用！”, 64, “提示”)
    获取焦点 ()
    赋值 (., -1)
    返回 ()
.否则
    
.如果结束
.如果 (不等于 (寻找文本 (到文本 (取回数据 ()), “冲值完毕@”, , 假), -1))
    信息框 (“冲值成功！使用剩余次数为： 30 次！”, 64, “提示”)
    返回 ()
.否则
    
.如果结束
.如果 (不等于 (寻找文本 (到文本 (取回数据 ()), “没有用户”, , 假), -1))
    信息框 (“用户不存在，请选择新用户冲值！”, 64, “提示”)
    返回 ()
.否则
    
.如果结束
.如果 (不等于 (寻找文本 (到文本 (取回数据 ()), “搞定@”, , 假), -1))
    赋值 (数组1, 分割文本 (到文本 (取回数据 ()), “@”, ))
    信息框 (相加 (“冲值成功！使用剩余次数为：”, 到文本 (相加 (到数值 (数组1 [2]), 30)), “ 次！”), 64, “提示”)
    重定义数组 (数组1, 假, 0)
    返回 ()
.否则
    
.如果结束
.如果 (不等于 (寻找文本 (到文本 (取回数据 ()), “没有用户哦”, , 假), -1))
    信息框 (“用户不存在，请确定用户名正确！”, 64, “提示”)
    获取焦点 ()
    赋值 (., -1)
    返回 ()
.否则
    
.如果结束
.如果 (不等于 (寻找文本 (到文本 (取回数据 ()), “失哦败”, , 假), -1))
    信息框 (“原始密码不正确！”, 64, “提示”)
    获取焦点 ()
    赋值 (., -1)
    返回 ()
.否则
    
.如果结束
.如果 (不等于 (寻找文本 (到文本 (取回数据 ()), “改密”, , 假), -1))
    信息框 (“修改密码成功！请使用新密码进行登陆！”, 64, “提示”)
    返回 ()
.否则
    
.如果结束
.如果 (不等于 (寻找文本 (到文本 (取回数据 ()), “张好不对”, , 假), -1))
    信息框 (“要查询的帐号不存在！”, 64, “提示”)
    返回 ()
.否则
    
.如果结束
.如果 (不等于 (寻找文本 (到文本 (取回数据 ()), “不对”, , 假), -1))
    信息框 (“要查询该帐号的密码不正确！”, 64, “提示”)
    返回 ()
.否则
    
.如果结束
.如果 (不等于 (寻找文本 (到文本 (取回数据 ()), “对的很”, , 假), -1))
    赋值 (t, 分割文本 (到文本 (取回数据 ()), “很”, ))
    信息框 (相加 (“该帐号还可以使用”, t [2], “次！”), 64, “提示”)
    重定义数组 (t, 假, 0)
    返回 ()
.否则
    
.如果结束


.子程序 _按钮4_被单击, 空白型, , 
.如果 (小于 (取文本长度 (.), 6))
    信息框 (“用户名填写不完整！”, 0, )
    获取焦点 ()
    赋值 (., -1)
    返回 ()
.否则
    
.如果结束
.如果 (小于 (取文本长度 (.), 6))
    信息框 (“用户密码填写不完整！”, 0, )
    获取焦点 ()
    赋值 (., -1)
    返回 ()
.否则
    
.如果结束
.如果 (等于 (相加 (“を查次ん”, #换行符, ., #换行符, .).发送数据 (), 假))
    信息框 (“连接服务器失败！”, 0, )
.否则
    
.如果结束


.子程序 _选择框1_被单击, 空白型, , 
.如果 (等于 (., 真))
    赋值 (., “”)
    赋值 (., #黑色)
    赋值 (., 假)
    赋值 (., #白色)
.否则
    赋值 (., #浅灰)
    赋值 (., #艳青)
    赋值 (., “无须输入！”)
    赋值 (., 真)
.如果结束


.窗口程序集 窗口程序集2, , , 

.子程序 _窗口1_可否被关闭, 逻辑型, , 
_启动窗口.发送数据 (., “ぎ退出げ”)
_启动窗口.销毁 ()
结束 ()

.子程序 _窗口1_创建完毕, 空白型, , 

赋值 (., 假)


.子程序 _按钮1_被单击, 空白型, , 
_窗口1_可否被关闭 ()


 ' 不属于任何一个程序集、类模块的函数：
