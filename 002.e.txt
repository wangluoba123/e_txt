 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 300
    高度 = 180
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 6
    底图方式 = 2
    底色 = 0 '  0x0
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\002.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 496
    高度 = 298
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “显示设置”
    帮助文件名 = “”

窗口 日历窗口
    左边 = 50
    顶边 = 50
    宽度 = 387
    高度 = 316
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “简易日历”
    帮助文件名 = “”

窗口 系统信息
    左边 = 50
    顶边 = 50
    宽度 = 420
    高度 = 355
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “系统信息”
    帮助文件名 = “”

窗口 功能窗口
    左边 = 50
    顶边 = 50
    宽度 = 254
    高度 = 349
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “功能设置”
    帮助文件名 = “”

窗口 关闭电脑
    左边 = 50
    顶边 = 50
    宽度 = 250
    高度 = 152
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 真
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “定时关闭电脑”
    帮助文件名 = “”

窗口 定时提醒
    左边 = 50
    顶边 = 50
    宽度 = 250
    高度 = 152
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 真
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “定时提醒”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' ExtMenu 9909FBB013704cfa8FE7E739DB7172DE 1 6 超级菜单支持库
 ' CnCalendar {18C0788E-59AE-4112-B452-6BF0C1B727FB} 1 2 农历日期支持库
 ' TrayIcon {86AB1D8A-7995-4D86-AE5F-18710759228B} 1 0 托盘图标支持库
 ' dialogex A9836B8C89D84BDFAFA37E056AA27211 2 0 扩展通用对话框
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库




.全局变量 配, 文本型, , , 

.窗口程序集 启动窗口, , , 

.程序集变量 版本号, 文本型, , , 
.程序集变量 发布日期, 文本型, , , 
.程序集变量 xp, 文本型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (配, 相加 (取运行目录 (), “\配置.ini”))
判断系统 ()
窗口定位 ()
读取配置 ()
多次运行 (“请不要多次运行本程序,以免影响系统其他程序的使用!”)
赋值 (版本号, “V0.9免费版”)
赋值 (发布日期, “2005年4月22日”)

.子程序 多次运行, 空白型, , 
.参数 提示信息, 文本型, , 弹出的信息框内容

.局部变量 进程, 未知类型0x20009, , "0", 
.局部变量 计次, 整数型, , , 
.局部变量 次, 整数型, , , 

赋值 (进程, 未知支持库函数_10 ())
赋值 (次, 0)
.计次循环首 (取数组成员数 (进程), 计次)
    .如果真 (等于 (进程 [计次], , 取执行文件名 ()))
        .如果真 (并且 (等于 (进程 [计次], , 取执行文件名 ()), 等于 (次, 1)))
            信息框 (提示信息, 64, “提示”)
            _启动窗口.销毁 ()
        .如果真结束
        赋值 (次, 1)
    .如果真结束
    输出调试文本 (进程 [计次].进程名称)
.计次循环尾 ()
返回 ()

.子程序 判断系统, 空白型, , 
.局部变量 系统信息, 未知类型0x20004, , , 
.局部变量 操作系统, 文本型, , , 

未知支持库函数_14 (系统信息)
赋值 (操作系统, 系统信息.)
.如果 (或者 (近似等于 (操作系统, “Windows XP”), 近似等于 (操作系统, “Windows 2000”)))
    赋值 (xp, “真”)
.否则
    赋值 (xp, “假”)
.如果结束


.子程序 窗口定位, 空白型, , 
.局部变量 显示模式, 未知类型0x2000A, , , 
.局部变量 屏宽, 整数型, , , 

赋值 (显示模式, 未知支持库函数_68 ())
赋值 (屏宽, 显示模式.)
赋值 (_启动窗口., 相减 (屏宽, _启动窗口.))
赋值 (_启动窗口., 0)
赋值 (.宽度, _启动窗口.)
赋值 (.高度, _启动窗口.)
赋值 (.顶边, 0)
赋值 (.左边, 0)
.调整层次 ()

.子程序 读取配置, 空白型, , 
.局部变量 闰月, 逻辑型, , , 
.局部变量 年, 整数型, , , 
.局部变量 月, 整数型, , , 
.局部变量 日, 整数型, , , 

输出调试文本 (“程序开始”)
.如果真 (等于 (文件是否存在 (配), 假))
    信息框 (“找不到程序的配置文件 配置.ini ,请确认该文件与程序在同一目录下再启动!”, 64, “错误”)
    销毁 ()
.如果真结束
赋值 (.内容, 相加 (到文本 (取日期 (取现行时间 ())), “ ”, 多项选择 (取星期几 (取现行时间 ()), “星期日”, “星期一”, “星期二”, “星期三”, “星期四”, “星期五”, “星期六”)))

未知支持库函数_1 (取现行时间 (), 年, 月, 日, 闰月)
赋值 (.内容, 相加 (未知支持库函数_12 (取现行时间 (), “%Y年 (属%S) %M%D”), “ ”, 未知支持库函数_5 (年, 月, 日, 闰月, )))

赋值 (_启动窗口., 读入文件 (读配置项 (配, “显示设置”, “背景图”, )))
赋值 (_启动窗口., 到数值 (读配置项 (配, “显示设置”, “底图方式”, )))
赋值 (.内容, 读配置项 (配, “显示设置”, “项目1”, ))
赋值 (.内容, 相加 (到文本 (取时间间隔 (取日期 (取现行时间 ()), 到时间 (读配置项 (配, “显示设置”, “日期1”, )), #日)), “天”))
赋值 (.内容, 相加 (读配置项 (配, “显示设置”, “日期1”, ), “  至  ”, 到文本 (取日期 (取现行时间 ()))))
.如果 (等于 (xp, “真”))
    未知支持库函数_66 (_启动窗口.取窗口句柄 (), 到数值 (读配置项 (配, “显示设置”, “透明值”, )))
.否则
    输出调试文本 (xp)
.如果结束
赋值 (.时钟周期, 1000)
.判断开始 (并且 (等于 (读配置项 (配, “显示设置”, “项2显示”, ), “假”), 等于 (读配置项 (配, “显示设置”, “项3显示”, ), “假”)))
    赋值 (.时钟周期, 相乘 (1000, 60, 60))
.默认
    赋值 (.时钟周期, 相乘 (到数值 (读配置项 (配, “显示设置”, “时钟间隔”, )), 1000))
.判断结束


.子程序 _时钟1_周期事件, 空白型, , 
赋值 (.内容, 时间到文本 (取现行时间 (), 3))
提醒及关机 ()

.子程序 提醒及关机, 空白型, , 
.局部变量 t, 文本型, , , 
.局部变量 g, 文本型, , , 
.局部变量 提醒, 逻辑型, , , 
.局部变量 关机, 逻辑型, , , 

赋值 (t, 相加 (读配置项 (配, “功能设置”, “提醒时间”, ), “0秒”))
赋值 (g, 相加 (读配置项 (配, “功能设置”, “关机时间”, ), “0秒”))

.如果 (等于 (读配置项 (配, “功能设置”, “启用提醒”, ), “假”))
    赋值 (提醒, 假)
.否则
    赋值 (提醒, 真)
    .如果真 (等于 (t, 时间到文本 (取现行时间 (), #时间部分)))
        载入 (定时提醒, , 假)
    .如果真结束
    
.如果结束
.如果 (等于 (读配置项 (配, “功能设置”, “定时关机”, ), “假”))
    赋值 (关机, 假)
.否则
    赋值 (关机, 真)
    .如果真 (等于 (g, 时间到文本 (取现行时间 (), #时间部分)))
        载入 (关闭电脑, , 假)
    .如果真结束
    
.如果结束


.子程序 _时钟2_周期事件, 空白型, , 
.如果真 (并且 (等于 (.内容, 读配置项 (配, “显示设置”, “项目1”, )), 等于 (读配置项 (配, “显示设置”, “项2显示”, ), “真”)))
    赋值 (.内容, 读配置项 (配, “显示设置”, “项目2”, ))
    赋值 (.内容, 相加 (到文本 (取绝对值 (取时间间隔 (取日期 (取现行时间 ()), 到时间 (读配置项 (配, “显示设置”, “日期2”, )), #日))), “天”))
    赋值 (.内容, 相加 (读配置项 (配, “显示设置”, “日期2”, ), “  至  ”, 到文本 (取日期 (取现行时间 ()))))
    返回 ()
.如果真结束
.如果真 (并且 (或者 (等于 (.内容, 读配置项 (配, “显示设置”, “项目1”, )), 等于 (.内容, 读配置项 (配, “显示设置”, “项目2”, ))), 等于 (读配置项 (配, “显示设置”, “项3显示”, ), “真”)))
    赋值 (.内容, 读配置项 (配, “显示设置”, “项目3”, ))
    赋值 (.内容, 相加 (到文本 (取绝对值 (取时间间隔 (取日期 (取现行时间 ()), 到时间 (读配置项 (配, “显示设置”, “日期3”, )), #日))), “天”))
    赋值 (.内容, 相加 (读配置项 (配, “显示设置”, “日期3”, ), “  至  ”, 到文本 (取日期 (取现行时间 ()))))
    返回 ()
.如果真结束
.如果真 (或者 (等于 (.内容, 读配置项 (配, “显示设置”, “项目3”, )), 等于 (.内容, 读配置项 (配, “显示设置”, “项目2”, ))))
    赋值 (.内容, 读配置项 (配, “显示设置”, “项目1”, ))
    赋值 (.内容, 相加 (到文本 (取绝对值 (取时间间隔 (取日期 (取现行时间 ()), 到时间 (读配置项 (配, “显示设置”, “日期1”, )), #日))), “天”))
    赋值 (.内容, 相加 (读配置项 (配, “显示设置”, “日期1”, ), “  至  ”, 到文本 (取日期 (取现行时间 ()))))
    返回 ()
.如果真结束


.子程序 _透明标签_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _简易日历_被选择, 空白型, , 
载入 (日历窗口, , 真)

.子程序 _最小化_被选择, 空白型, , 
赋值 (_启动窗口., 假)
赋值 (., 真)

未知支持库函数_5 (“ETimeShow”, , 9, 相加 (读配置项 (配, “显示设置”, “项目1”, ), 到文本 (取绝对值 (取时间间隔 (取日期 (取现行时间 ()), 到时间 (读配置项 (配, “显示设置”, “日期1”, )), #日))), “天”), , , , , , , , #蓝色, #白色)
.如果真 (等于 (读配置项 (配, “显示设置”, “项2显示”, ), “真”))
    未知支持库函数_5 (“ETimeShow”, , 9, 相加 (读配置项 (配, “显示设置”, “项目2”, ), 到文本 (取绝对值 (取时间间隔 (取日期 (取现行时间 ()), 到时间 (读配置项 (配, “显示设置”, “日期2”, )), #日))), “天”), , , , , , , , #红色, #白色)
.如果真结束
.如果真 (等于 (读配置项 (配, “显示设置”, “项3显示”, ), “真”))
    未知支持库函数_5 (“ETimeShow”, , , 相加 (读配置项 (配, “显示设置”, “项目3”, ), 到文本 (取绝对值 (取时间间隔 (取日期 (取现行时间 ()), 到时间 (读配置项 (配, “显示设置”, “日期3”, )), #日))), “天”), , , , , , , , #绿色, #白色)
.如果真结束


.子程序 _显示设置_被选择, 空白型, , 
载入 (设置窗口, , 真)

.子程序 _系统信息_被选择, 空白型, , 
载入 (系统信息, , 真)

.子程序 _关于_被选择, 空白型, , 
赋值 (.宽度, 相减 (_启动窗口., 10))
赋值 (.高度, 相减 (_启动窗口., 10))
赋值 (.底图, _启动窗口.)
赋值 (.底图方式, _启动窗口.)
赋值 (.顶边, 0)
赋值 (.左边, 0)
赋值 (.左边, 20)
赋值 (.顶边, 0)
赋值 (.宽度, .宽度)
赋值 (.高度, .高度)
.调整层次 ()
.调整层次 ()
赋值 (.内容, 相加 (#换行符, #换行符, “ETimeShow ”, 版本号, #换行符, #换行符, “程序:six7”, #换行符, “授权: 免费使用,版权所有”, #换行符, “发布日期:”, 发布日期, #换行符, #换行符, “地址:XXXXX”, #换行符, “Email:xxxxx”))
赋值 (.可视, 真)

.子程序 _程序退出_被选择, 空白型, , 
销毁 ()

.子程序 _关于标签_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.可视, 假)

.子程序 _托盘图标1_托盘图标被单击, 空白型, , 
赋值 (., 假)
赋值 (_启动窗口., 真)
窗口定位 ()

.子程序 _托盘图标1_托盘图标被右击, 空白型, , 
弹出菜单 ()

.子程序 _显示界面_被选择, 空白型, , 
_托盘图标1_托盘图标被单击 ()

.子程序 _程序关闭_被选择, 空白型, , 
销毁 ()

.子程序 _功能设置_被选择, 空白型, , 
载入 (功能窗口, , 真)

.窗口程序集 设置窗口, , , 

.子程序 _按钮1_被单击, 空白型, , 
赋值 (.初始目录, 取当前目录 ())
.如果真 (打开 ())
    写配置项 (配, “显示设置”, “背景图”, .文件名)
.如果真结束
赋值 (.底图, 读入文件 (读配置项 (配, “显示设置”, “背景图”, )))

.子程序 _设置窗口_创建完毕, 空白型, , 
基本设置 ()

.子程序 基本设置, 空白型, , 
.如果 (等于 (_启动窗口., “真”))
    赋值 (.内容, 相加 (“透明度: ”, 到文本 (读配置项 (配, “显示设置”, “透明值”, ))))
.否则
    赋值 (.禁止, 真)
.如果结束
.如果 (注册项是否存在 (4, “SOFTWARE\Microsoft\Windows\CurrentVersion\Run\ETimeShow”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束
赋值 (.位置, 到数值 (读配置项 (配, “显示设置”, “透明值”, )))
赋值 (.今天, 到时间 (读配置项 (配, “显示设置”, “日期1”, )))
赋值 (.内容, 读配置项 (配, “显示设置”, “项目1”, ))
赋值 (.今天, 到时间 (读配置项 (配, “显示设置”, “日期2”, )))
赋值 (.内容, 读配置项 (配, “显示设置”, “项目2”, ))
赋值 (.今天, 到时间 (读配置项 (配, “显示设置”, “日期3”, )))
赋值 (.内容, 读配置项 (配, “显示设置”, “项目3”, ))
赋值 (.内容, 读配置项 (配, “显示设置”, “时钟间隔”, ))
赋值 (.底图, 读入文件 (读配置项 (配, “显示设置”, “背景图”, )))
赋值 (.底图方式, 到数值 (读配置项 (配, “显示设置”, “底图方式”, )))
.判断开始 (等于 (读配置项 (配, “显示设置”, “底图方式”, ), “1”))
    赋值 (.选中, 真)
    赋值 (.选中, 假)
.默认
    赋值 (.选中, 假)
    赋值 (.选中, 真)
.判断结束

.判断开始 (等于 (读配置项 (配, “显示设置”, “项2显示”, ), “真”))
    赋值 (.选中, 真)
.默认
    赋值 (.选中, 假)
.判断结束
.判断开始 (等于 (读配置项 (配, “显示设置”, “项3显示”, ), “真”))
    赋值 (.选中, 真)
.默认
    赋值 (.选中, 假)
.判断结束
_选择框2_被单击 ()
_选择框3_被单击 ()

.子程序 _滑块条1_位置被改变, 空白型, , 
赋值 (.内容, 相加 (“透明度: ”, 到文本 (.位置)))
未知支持库函数_66 (_启动窗口.取窗口句柄 (), .位置)

.子程序 _选择框3_被单击, 空白型, , 
.如果真 (等于 (.选中, 真))
    连续赋值 (假, .禁止, .禁止)
    写配置项 (配, “显示设置”, “项3显示”, “真”)
    返回 ()
.如果真结束
连续赋值 (真, .禁止, .禁止)
写配置项 (配, “显示设置”, “项3显示”, “假”)

.子程序 _选择框2_被单击, 空白型, , 
.如果真 (等于 (.选中, 真))
    连续赋值 (假, .禁止, .禁止)
    写配置项 (配, “显示设置”, “项2显示”, “真”)
    返回 ()
.如果真结束
连续赋值 (真, .禁止, .禁止)
写配置项 (配, “显示设置”, “项2显示”, “假”)

.子程序 _确定_被单击, 空白型, , 
写配置项 (配, “显示设置”, “项目1”, .内容)
写配置项 (配, “显示设置”, “日期1”, 到文本 (取日期 (.今天)))

写配置项 (配, “显示设置”, “项目2”, .内容)
写配置项 (配, “显示设置”, “日期2”, 到文本 (取日期 (.今天)))

写配置项 (配, “显示设置”, “项目3”, .内容)
写配置项 (配, “显示设置”, “日期3”, 到文本 (取日期 (.今天)))

写配置项 (配, “显示设置”, “时钟间隔”, .内容)

写配置项 (配, “显示设置”, “透明值”, 到文本 (.位置))

_启动窗口.读取配置 ()
销毁 ()

.子程序 _单选框1_被单击, 空白型, , 
赋值 (.底图方式, 1)
写配置项 (配, “显示设置”, “底图方式”, “1”)

.子程序 _单选框2_被单击, 空白型, , 
赋值 (.底图方式, 2)
写配置项 (配, “显示设置”, “底图方式”, “2”)

.子程序 _选择框1_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    未知支持库函数_25 (“ETimeShow”, 相加 (取运行目录 (), “\”, 取执行文件名 ()), 0)
.否则
    未知支持库函数_83 (“ETimeShow”)
.如果结束


.窗口程序集 系统信息, , , 

.子程序 _系统信息_创建完毕, 空白型, , 
取信息 ()

.子程序 取信息, 空白型, , 
.局部变量 信息, 未知类型0x20004, , , 
.局部变量 bios, 未知类型0x20006, , , 
.局部变量 cpu, 未知类型0x20003, , , 

未知支持库函数_14 (信息)
未知支持库函数_15 (bios)
未知支持库函数_17 (cpu)
未知支持库函数_19 ()

赋值 (.内容, 相加 (“当前操作系统为:  ”, 信息., “  ”, 信息., #换行符))
赋值 (.内容, 相加 (.内容, #换行符, “IE版本为:  ”, 未知支持库函数_34 (), #换行符))
赋值 (.内容, 相加 (.内容, #换行符, “BIOS信息为:”, #换行符, “名称:  ”, bios., #换行符, “日期:  ”, bios., #换行符, “制造商:  ”, bios., #换行符, “序列号:  ”, bios., #换行符, “OEM信息:  ”, bios., #换行符, “版权信息:  ”, bios., #换行符))
赋值 (.内容, 相加 (.内容, #换行符, “CPU信息为:”, #换行符, “名称:  ”, cpu., #换行符, “描述:  ”, cpu., “  ”, #换行符, “制造商:  ”, cpu., #换行符, “序列号:  ”, cpu., #换行符, “时钟频率:  ”, 到文本 (cpu.), “  HZ”, #换行符, “数据宽度:  ”, 到文本 (cpu.), “  bit”, #换行符, “一级缓存:  ”, 到文本 (cpu.), “  KB”, #换行符, “二级缓存:  ”, 到文本 (cpu.), “  KB”, #换行符))
赋值 (.内容, 相加 (.内容, #换行符, “内存信息为:”, #换行符, “总物理内存:  ”, 到文本 (未知支持库函数_19 (0)), “  MB”, #换行符, “可用物理内存:  ”, 到文本 (未知支持库函数_19 (1)), “  MB”, #换行符, “总虚拟内存为:  ”, 到文本 (未知支持库函数_19 (2)), “  MB”, #换行符, “可用虚拟内存:  ”, 到文本 (未知支持库函数_19 (3)), “  MB”, #换行符, “总页面文件大小:  ”, 到文本 (未知支持库函数_19 (4)), “  MB”, #换行符, “可用页面文件大小:  ”, 到文本 (未知支持库函数_19 (5)), “  MB”, #换行符))
赋值 (.内容, 相加 (.内容, #换行符, “声卡信息为”, #换行符, 未知支持库函数_20 ()))

.子程序 _按钮1_被单击, 空白型, , 
销毁 ()

.窗口程序集 功能窗口, , , 

.子程序 _功能窗口_创建完毕, 空白型, , 
功能配置 ()

.子程序 功能配置, 空白型, , 
.局部变量 t, 日期时间型, , , 
.局部变量 g, 日期时间型, , , 

.如果 (等于 (读配置项 (配, “功能设置”, “启用提醒”, ), “真”))
    赋值 (.选中, 真)
    赋值 (.禁止, 假)
.否则
    赋值 (.选中, 假)
    赋值 (.禁止, 真)
.如果结束
.如果 (等于 (读配置项 (配, “功能设置”, “定时关机”, ), “真”))
    赋值 (.选中, 真)
    赋值 (.禁止, 假)
.否则
    赋值 (.选中, 假)
    赋值 (.禁止, 真)
.如果结束
赋值 (t, 到时间 (相加 (“2005年4月5日”, 读配置项 (配, “功能设置”, “提醒时间”, ), “59秒”)))
赋值 (g, 到时间 (相加 (“2005年4月5日”, 读配置项 (配, “功能设置”, “关机时间”, ), “59秒”)))
赋值 (.内容, 到文本 (取时间部分 (t, #小时)))
赋值 (.内容, 到文本 (取时间部分 (t, #分钟)))
赋值 (.内容, 读配置项 (配, “功能设置”, “提醒内容”, ))
赋值 (.内容, 到文本 (取时间部分 (g, #小时)))
赋值 (.内容, 到文本 (取时间部分 (g, #分钟)))
赋值 (.内容, 读配置项 (配, “功能设置”, “关机内容”, ))

.子程序 _确定_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    写配置项 (配, “功能设置”, “启用提醒”, “真”)
.否则
    写配置项 (配, “功能设置”, “启用提醒”, “假”)
.如果结束
.如果 (等于 (.选中, 真))
    写配置项 (配, “功能设置”, “定时关机”, “真”)
.否则
    写配置项 (配, “功能设置”, “定时关机”, “假”)
.如果结束
.如果 (并且 (等于 (.内容, .内容), 等于 (.内容, .内容)))
    信息框 (“对不起,请为两个任务设置不同的时间,以免系统冲突!”, 0, “请重新设置”)
    返回 ()
.否则
    
.如果结束
写配置项 (配, “功能设置”, “提醒时间”, 相加 (.内容, “时”, .内容, “分”))
写配置项 (配, “功能设置”, “提醒内容”, .内容)
写配置项 (配, “功能设置”, “关机时间”, 相加 (.内容, “时”, .内容, “分”))
写配置项 (配, “功能设置”, “关机内容”, .内容)
销毁 ()

.子程序 _提醒选择框_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
.如果结束


.子程序 _关机选择框_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
.如果结束


.子程序 _取消_被单击, 空白型, , 
销毁 ()

.窗口程序集 简易日历, , , 

.子程序 _日历窗口_创建完毕, 空白型, , 
赋值 (., 取现行时间 ())

.子程序 _按钮1_被单击, 空白型, , 
 ' 赋值 (., 取现行时间 ())

.窗口程序集 关闭电脑, , , 

.程序集变量 计时, 整数型, , , 
.子程序 _关闭电脑_创建完毕, 空白型, , 
赋值 (计时, 30)
赋值 (.时钟周期, 1000)
赋值 (.标题, 读配置项 (配, “功能设置”, “关机内容”, ))

.子程序 _按钮1_被单击, 空白型, , 
销毁 ()

.子程序 _时钟1_周期事件, 空白型, , 
赋值 (.标题, 相加 (“取消关机 倒计时:”, “ ”, 到文本 (计时), “ ”, “秒”))
赋值 (计时, 相减 (计时, 1))
.如果真 (等于 (计时, 0))
    赋值 (.标题, “系统强制关机,开始执行!”)
    赋值 (.禁止, 真)
    赋值 (.时钟周期, 0)
    未知支持库函数_8 (1, 真)
.如果真结束


.窗口程序集 定时提醒, , , 

.子程序 _定时提醒_创建完毕, 空白型, , 
赋值 (.标题, 读配置项 (配, “功能设置”, “提醒内容”, ))

.子程序 _按钮1_被单击, 空白型, , 
销毁 ()


 ' 不属于任何一个程序集、类模块的函数：
