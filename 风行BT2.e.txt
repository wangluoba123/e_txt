 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口
    左边 = 50
    顶边 = 50
    宽度 = 567
    高度 = 445
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “风行电影BT种子猎取器 by MCJ”
    帮助文件名 = “”



.常量 INTERNET_OPEN_TYPE_DIRECT, "1", , 
.常量 INTERNET_OPEN_TYPE_PROXY, "3", , 
.常量 , , , 
.常量 INTERNET_SERVICE_HTTP, "3", , 
.常量 , , , 
.常量 WAIT_TIMEOUT, "258", , 超时
.常量 窗口标题, "“风行电影BT种子猎取器”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 5 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' Krnlnex {A00B8D30-A5AB-4dfe-9546-9E636E711B75} 1 5 辅助调试支持库



 ' 所需要的模块
 ' 新编码转换大全 $新编码转换大全.ec



.DLL命令 InternetOpenA, 整数型, "WinINet.dll", "", , 
    .参数 lpszAgent, 文本型, , 
    .参数 dwAccessType, 整数型, , 
    .参数 lpszProxyName, 文本型, , 
    .参数 lpszProxyBypass, 文本型, , 
    .参数 dwFlags, 整数型, , 

.DLL命令 InternetCloseHandle, 逻辑型, "WinINet.dll", "", , 
    .参数 hInternet, 整数型, , 

.DLL命令 InternetConnectA, 整数型, "WinINet.dll", "", , 
    .参数 hInternet, 整数型, , 
    .参数 lpszServerName, 文本型, , 
    .参数 nServerPort, 整数型, , 
    .参数 lpszUserName, 文本型, , 
    .参数 lpszPassword, 文本型, , 
    .参数 dwService, 整数型, , 
    .参数 dwFlags, 整数型, , 
    .参数 dwContext, 整数型, , 

.DLL命令 HttpOpenRequestA, 整数型, "WinINet.dll", "", , 
    .参数 hConnect, 整数型, , 
    .参数 lpszVerb, 文本型, , 
    .参数 lpszObjectName, 文本型, , 
    .参数 lpszVersion, 文本型, , 
    .参数 lpszReferer, 文本型, , 
    .参数 lplpszAcceptTypes, 文本型, , 
    .参数 dwFlags, 整数型, , 
    .参数 dwContext, 整数型, , 

.DLL命令 HttpSendRequestA, 逻辑型, "WinINet.dll", "", , 
    .参数 hRequest, 整数型, , 
    .参数 lpszHeaders, 文本型, , 
    .参数 dwHeadersLength, 整数型, , 
    .参数 lpOptional, 文本型, , 
    .参数 dwOptionalLength, 整数型, , 

.DLL命令 InternetReadFile, 逻辑型, "WinINet.dll", "", , 
    .参数 hFile, 整数型, , 
    .参数 lpBuffer, 字节集, 传址, 
    .参数 dwNumberOfBytesToRead, 整数型, , 
    .参数 lpdwNumberOfBytesRead, 整数型, 传址, 

.DLL命令 HttpQueryInfoA, 逻辑型, "WinINet.dll", "", , 
    .参数 hRequest, 整数型, , 
    .参数 dwInfoLevel, 整数型, , 
    .参数 lpvBuffer, 文本型, 传址, 
    .参数 lpdwBufferLength, 整数型, 传址, 
    .参数 lpdwIndex, 整数型, , 

.DLL命令 InternetSetCookieA, 逻辑型, "WinINet.dll", "", , 
    .参数 lpszUrl, 文本型, , 
    .参数 lpszCookieName, 文本型, , 
    .参数 lpszCookieData, 文本型, , 

.DLL命令 CreateThread, 整数型, "", "", , 
    .参数 lpThreadAttributes, 整数型, , 
    .参数 dwStackSize, 整数型, , 
    .参数 lpStartAddress, 子程序指针, , 
    .参数 lpParameter, 整数型, , 
    .参数 dwCreationFlags, 整数型, , 
    .参数 lpThreadId, 整数型, 传址, 

.DLL命令 CloseHandle, 逻辑型, "", "", , 
    .参数 hObject, 整数型, , 

.DLL命令 TerminateThread, 逻辑型, "", "", , 
    .参数 hThread, 整数型, , 
    .参数 dwExitCode, 整数型, , 

.DLL命令 MsgWaitForMultipleObjects, 整数型, "", "", , 
    .参数 nCount, 整数型, , 
    .参数 pHandles, 整数型, 传址, 
    .参数 bWaitAll, 逻辑型, , 
    .参数 dwMilliseconds, 整数型, , 
    .参数 dwWakeMask, 整数型, , 

.程序集 程序集1, , , 

.程序集变量 szFullAddr, 文本型, , , 
.程序集变量 szVerb, 文本型, , , "GET" or "POST",为空默认"GET"
.程序集变量 szProxyServer, 文本型, , , 
.程序集变量 szHeaders, 文本型, , , 
.程序集变量 szSendBody, 文本型, , , "POST"专用
.程序集变量 szRequest, 文本型, , , 
.程序集变量 lpBody, 字节集, , , 
.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。
未知支持库函数_0 (到文本 (访问网页 (“http://www.126.com”)))

.子程序 访问网页, 字节集, 公开, 
.参数 完整网址, 文本型, , 
.参数 访问方式, 文本型, 可空, "GET" or "POST",为空默认"GET"
.参数 代理地址, 文本型, 可空, 
.参数 附加协议头, 文本型, 可空, 
.参数 提交信息, 文本型, 可空, "POST"专用
.参数 超时值, 整数型, 可空, 
.参数 返回状态文本, 文本型, 参考 可空, 在Send之后可以获取状态文本

.局部变量 hThread, 整数型, , , 
.局部变量 ret, 整数型, , , 

赋值 (szFullAddr, 完整网址)
赋值 (szVerb, 访问方式)
赋值 (szProxyServer, 代理地址)
赋值 (szHeaders, 附加协议头)
赋值 (szSendBody, 提交信息)
赋值 (lpBody, {  })
.如果真 (或者 (是否为空 (超时值), 等于 (超时值, 0)))
    赋值 (超时值, 90)
.如果真结束
赋值 (hThread, CreateThread (0, 0, &ReadFile, 0, 0, 0))
.循环判断首 ()
    赋值 (ret, MsgWaitForMultipleObjects (1, hThread, 假, 相乘 (超时值, 1000), 1215))
    处理事件 ()
.循环判断尾 (并且 (不等于 (ret, 0), 不等于 (ret, 258)))
TerminateThread (hThread, 0)
CloseHandle (hThread)
.如果真 (等于 (ret, 258))
    赋值 (lpBody, {  })
.如果真结束
.如果真 (等于 (是否为空 (返回状态文本), 假))
    赋值 (返回状态文本, szRequest)
.如果真结束
返回 (lpBody)

.子程序 ReadFile, 逻辑型, , 
.局部变量 hOpen, 整数型, , , 
.局部变量 hConnect, 整数型, , , 
.局部变量 hRequest, 整数型, , , 
.局部变量 szDomain, 文本型, , , 
.局部变量 szPageAddr, 文本型, , , 
.局部变量 bUseProxy, 逻辑型, , , 
.局部变量 lpBuffer, 字节集, , , 
.局部变量 dwNumber, 整数型, , , 

赋值 (szDomain, 取域名 (szFullAddr))
赋值 (szPageAddr, 取页面地址 (szFullAddr))
赋值 (bUseProxy, 不等于 (删全部空 (szProxyServer), “”))

 ' 建立基础连接
赋值 (hOpen, InternetOpenA (“Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)”, 选择 (bUseProxy, 3, 1), 选择 (bUseProxy, 相加 (“http=”, szProxyServer), 字符 (0)), 字符 (0), 0))
.如果真 (等于 (hOpen, 0))
    返回 (假)
.如果真结束
赋值 (hConnect, InternetConnectA (hOpen, szDomain, 取端口 (szFullAddr), 字符 (0), 字符 (0), #INTERNET_SERVICE_HTTP, 0, 0))
.如果真 (等于 (hConnect, 0))
    返回 (假)
.如果真结束
赋值 (hRequest, HttpOpenRequestA (hConnect, szVerb, szPageAddr, “HTTP/1.1”, 字符 (0), 字符 (0), 2147483648, 0))
.如果真 (等于 (hRequest, 0))
    返回 (假)
.如果真结束

 ' 补充协议头
.如果真 (等于 (寻找文本 (szHeaders, “Accept: ”, 1, 真), -1))
    赋值 (szHeaders, 相加 (szHeaders, “Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */*”, #换行符))
.如果真结束
.如果真 (等于 (寻找文本 (szHeaders, “Referer: ”, 1, 真), -1))
    赋值 (szHeaders, 相加 (szHeaders, “Referer: ”, szFullAddr, #换行符))
.如果真结束
.如果真 (等于 (寻找文本 (szHeaders, “Accept-Language: ”, 1, 真), -1))
    赋值 (szHeaders, 相加 (szHeaders, “Accept-Language: zh-cn”, #换行符))
.如果真结束

 ' 附带信息发送请求
.判断开始 (或者 (等于 (szVerb, “”), 等于 (szVerb, “GET”)))
    HttpSendRequestA (hRequest, szHeaders, 取文本长度 (szHeaders), 字符 (0), 0)
.判断 (等于 (szVerb, “POST”))
    .如果真 (不等于 (szSendBody, “”))
        赋值 (szHeaders, 相加 (szHeaders, “Content-Type: application/x-www-form-urlencoded”, #换行符))
        赋值 (szHeaders, 相加 (szHeaders, “Content-Length: ”, 到文本 (取文本长度 (szSendBody)), #换行符))
    .如果真结束
    HttpSendRequestA (hRequest, szHeaders, 取文本长度 (szHeaders), szSendBody, 取文本长度 (szSendBody))
.默认
    返回 (假)
.判断结束

 ' 读取页面数据
.循环判断首 ()
    赋值 (lpBuffer, 取空白字节集 (512))
    InternetReadFile (hRequest, lpBuffer, 取字节集长度 (lpBuffer), dwNumber)
    赋值 (lpBody, 相加 (lpBody, 取字节集左边 (lpBuffer, dwNumber)))
.循环判断尾 (不等于 (dwNumber, 0))

 ' 取服务器回传协议头
赋值 (szRequest, 取空白文本 (1024))
HttpQueryInfoA (hRequest, 22, szRequest, 1024, 0)

 ' 关闭句柄
InternetCloseHandle (hRequest)
InternetCloseHandle (hConnect)
InternetCloseHandle (hOpen)

 ' 设置COOKIE
.如果真 (大于 (寻找文本 (szRequest, “Set-Cookie: ”, 1, 真), 0))
    赋值 (dwNumber, 打开内存文件 ())
    写出文本 (dwNumber, szRequest)
    移到文件首 (dwNumber)
    .判断循环首 (等于 (是否在文件尾 (dwNumber, 假), 假))
        赋值 (szRequest, 读入一行 (dwNumber))
        .如果真 (大于 (寻找文本 (szRequest, “Set-Cookie: ”, 1, 真), 0))
            赋值 (szRequest, 文本替换 (szRequest, 1, 12, ))
            赋值 (hRequest, 寻找文本 (szRequest, “=”, 1, 真))
            InternetSetCookieA (相加 (“http://”, szDomain), 取文本左边 (szRequest, 相减 (hRequest, 1)), 取文本右边 (szRequest, 相减 (取文本长度 (szRequest), hRequest)))
        .如果真结束
        
    .判断循环尾 ()
    关闭文件 (dwNumber)
.如果真结束
返回 (真)

.子程序 取域名, 文本型, , 
.参数 网址, 文本型, , 
.参数 不过滤端口, 逻辑型, 可空, 

.局部变量 dwNumber, 整数型, , , 
.局部变量 dwLast, 整数型, , , 
.局部变量 szServerName, 文本型, , , 

赋值 (szServerName, 网址)
赋值 (dwNumber, 选择 (等于 (寻找文本 (szServerName, “http://”, , 假), -1), 1, 相加 (寻找文本 (szServerName, “http://”, , 假), 7)))
赋值 (szServerName, 取文本中间 (szServerName, dwNumber, 选择 (等于 (寻找文本 (szServerName, “/”, dwNumber, 假), -1), 取文本长度 (szServerName), 相减 (寻找文本 (szServerName, “/”, dwNumber, 假), dwNumber)))) ' 这段代码是过滤掉前http://和后/
.如果真 (取反 (不过滤端口))
    赋值 (dwNumber, 寻找文本 (szServerName, “:”, , 假))
    .如果真 (不等于 (dwNumber, -1))
        赋值 (szServerName, 取文本左边 (szServerName, 相减 (dwNumber, 1)))
    .如果真结束
    
.如果真结束
返回 (到小写 (szServerName))

.子程序 取端口, 整数型, , 
.参数 网址, 文本型, , 

.局部变量 dwNumber, 整数型, , , 
.局部变量 szServerName, 文本型, , , 

赋值 (szServerName, 取域名 (网址, 真))
赋值 (dwNumber, 寻找文本 (szServerName, “:”, , 假))
赋值 (dwNumber, 选择 (等于 (dwNumber, -1), 80, 到数值 (取文本右边 (szServerName, 相减 (取文本长度 (szServerName), dwNumber)))))
返回 (dwNumber)

.子程序 取页面地址, 文本型, , 
.参数 网址, 文本型, , 

.局部变量 页面地址, 文本型, , , 
.局部变量 符号位置, 整数型, , , 
.局部变量 域名, 文本型, , , 

赋值 (域名, 取域名 (网址))
赋值 (符号位置, 寻找文本 (网址, “/”, 寻找文本 (网址, 域名, 1, 真), 真))
赋值 (页面地址, 选择 (等于 (符号位置, -1), “/”, 取文本右边 (网址, 相加 (相减 (取文本长度 (网址), 符号位置), 1))))
返回 (页面地址)

.窗口程序集 窗口程序集1, , , 

.程序集变量 网页原始数据, 字节集, , , 
.程序集变量 网页数据, 文本型, , , 
.程序集变量 地址数组, 文本型, , "0", 
.程序集变量 网页分段数组, 文本型, , "0", 
.程序集变量 时间1, 整数型, , , 
.程序集变量 时间2, 整数型, , , 
.子程序 _按钮1_被单击, 空白型, , 
正在提取状态显示 ()
赋值 (网页原始数据, 访问网页 (地址数组 [1], , , , , , ))
赋值 (_启动窗口., “首页”)
赋值 (_启动窗口., 相加 (#窗口标题, “ - 首页”))
处理种子地址链接 ()

.子程序 _按钮12_被单击, 空白型, , 
赋值 (网页原始数据, 访问网页 (“http://xikee.com/publish_btstatic/karma/week/all/”, , , , , , ))
.如果 (不等于 (寻找字节集 (网页原始数据, 到字节集 (“charset=utf-8”), ), -1))
    赋值 (.内容, UTF8转ANSI (网页原始数据))
.否则
    
.如果结束
赋值 (网页分段数组, 分割文本 (.内容, 相加 (#换行符, #换行符, #换行符, #换行符, #换行符, #换行符), ))
暂停 ()

.子程序 寻找按钮地址, 空白型, , 
加入成员 (地址数组, “http://xikee.com/publish_btstatic/karma/week/all/”)
处理地址链接 (“首页”, “爱情”)
处理地址链接 (“爱情”, “动作”)
处理地址链接 (“动作”, “喜剧”)
处理地址链接 (“喜剧”, “恐怖”)
处理地址链接 (“恐怖”, “战争”)
处理地址链接 (“战争”, “科幻”)
处理地址链接 (“科幻”, “剧情”)
处理地址链接 (“剧情”, “电视剧”)
处理地址链接 (“电视剧”, “综艺”)
处理地址链接 (“综艺”, “动漫”)

.子程序 处理地址链接, 空白型, , 
.参数 前一分类名, 文本型, , 
.参数 分类名, 文本型, , 

.局部变量 文本地址, 整数型, , , 
.局部变量 文本地址2, 整数型, , , 

赋值 (文本地址, 寻找文本 (网页数据, 相加 (“>”, 前一分类名, “<”), , 真))
赋值 (文本地址, 寻找文本 (网页数据, “a href=”, 文本地址, 真))
赋值 (文本地址2, 寻找文本 (网页数据, 相加 (“>”, 分类名, “<”), 文本地址, 假))
加入成员 (地址数组, 相加 (“http://xikee.com”, 取文本中间 (网页数据, 相加 (文本地址, 8), 相减 (文本地址2, 相加 (文本地址, 9)))))

.子程序 __启动窗口_创建完毕, 空白型, , 
1.置宽度 (相减 (_启动窗口., 0.取栏目宽度 ()))
正在提取状态显示 ()
赋值 (.时钟周期, 1000)

.子程序 _时钟1_周期事件, 空白型, , 
赋值 (.时钟周期, 0)
赋值 (网页原始数据, 访问网页 (“http://xikee.com/publish_btstatic/karma/week/all/”, , , , , , ))
.如果 (等于 (网页原始数据, {  }))
    信息框 (相加 (“读取网页失败，可能是网页地址发生了改变！”, #换行符, “你可能需要更新本程序。”), #信息图标, “抱歉”)
    0.置文本 (“猎取失败”)
.否则
    .如果 (或者 (不等于 (寻找字节集 (网页原始数据, 到字节集 (“utf-8”), ), -1), 不等于 (寻找字节集 (网页原始数据, 到字节集 (“UTF-8”), ), -1)))
        赋值 (网页数据, UTF8转ANSI (网页原始数据))
    .否则
        赋值 (网页数据, 到文本 (网页原始数据))
    .如果结束
    寻找按钮地址 ()
    连续赋值 (假, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
    赋值 (_启动窗口., “首页”)
    赋值 (_启动窗口., 相加 (#窗口标题, “ - 首页”))
    处理种子地址链接 ()
.如果结束


.子程序 正在提取状态显示, 空白型, , 
赋值 (时间1, 取启动时间 ())
0.置文本 (“正在连接网络并猎取电影BT种子...”)
1.置文本 (“”)

.子程序 正在下载状态显示, 空白型, , 
0.置文本 (“正在连接网络并下载电影BT种子...”)
1.置文本 (“”)

.子程序 处理种子地址链接, 空白型, , 
.局部变量 地址, 整数型, , , 
.局部变量 地址2, 整数型, , , 
.局部变量 类别组, 文本型, , "6", 
.局部变量 I, 整数型, , , 

.如果 (不等于 (网页原始数据, {  }))
    .如果 (或者 (不等于 (寻找字节集 (网页原始数据, 到字节集 (“utf-8”), ), -1), 不等于 (寻找字节集 (网页原始数据, 到字节集 (“UTF-8”), ), -1)))
        赋值 (网页数据, UTF8转ANSI (网页原始数据))
        赋值 (网页数据, 子文本替换 (网页数据, “utf-8”, “GB2312”, , 1, 假))
    .否则
        赋值 (网页数据, 到文本 (网页原始数据))
    .如果结束
    写到文件 (相加 (取运行目录 (), “\Torrent\Log\HttpLog.htm”), 到字节集 (网页数据))
    赋值 (网页分段数组, 分割文本 (网页数据, 相加 (#换行符, #换行符, #换行符, #换行符, #换行符, #换行符), ))
    .如果 (不等于 (取数组成员数 (网页分段数组), 0))
        全部删除 ()
        .计次循环首 (相减 (取数组成员数 (网页分段数组), 1), I)
            赋值 (地址, 寻找文本 (网页分段数组 [I], “.torrent”, , 真))
            赋值 (地址2, 倒找文本 (网页分段数组 [I], 相加 (“<a href=”, #引号), 地址, 真))
            赋值 (类别组 [1], 取文本中间 (网页分段数组 [I], 相加 (地址2, 9), 相减 (地址, 地址2, 1))) ' 种子地址
            赋值 (地址2, 寻找文本 (网页分段数组 [I], “</a>”, 地址, 真))
            赋值 (类别组 [2], 取文本中间 (网页分段数组 [I], 相加 (地址, 10), 相减 (地址2, 相加 (地址, 10)))) ' 电影名
            赋值 (地址, 寻找文本 (网页分段数组 [I], “[”, 地址2, 真))
            赋值 (地址2, 寻找文本 (网页分段数组 [I], “]”, 地址, 真))
            赋值 (类别组 [3], 取文本中间 (网页分段数组 [I], 地址, 相加 (相减 (地址2, 地址), 1))) ' 格式
            赋值 (地址, 寻找文本 (网页分段数组 [I], 相加 (#引号, “w2”, #引号, “>”), 地址2, 真))
            赋值 (地址2, 寻找文本 (网页分段数组 [I], “<”, 地址, 真))
            赋值 (类别组 [4], 取文本中间 (网页分段数组 [I], 相加 (地址, 5), 相减 (地址2, 相加 (地址, 5)))) ' 大小
            赋值 (地址, 寻找文本 (网页分段数组 [I], 相加 (#引号, “w3”, #引号, “>”), 地址2, 真))
            赋值 (地址2, 寻找文本 (网页分段数组 [I], “<”, 地址, 真))
            赋值 (类别组 [5], 取文本中间 (网页分段数组 [I], 相加 (地址, 5), 相减 (地址2, 相加 (地址, 5)))) ' 连接
            赋值 (地址, 寻找文本 (网页分段数组 [I], 相加 (#引号, “w4”, #引号, “>”), 地址2, 真))
            赋值 (地址2, 寻找文本 (网页分段数组 [I], “<”, 地址, 真))
            赋值 (类别组 [6], 取文本中间 (网页分段数组 [I], 相加 (地址, 5), 相减 (地址2, 相加 (地址, 5)))) ' 日期
            相减 (I, 1).插入表项 (相加 (到文本 (I), “ ”, 类别组 [2]), , , , )
            相减 (I, 1).置标题 (1, 类别组 [3])
            相减 (I, 1).置标题 (2, 类别组 [4])
            相减 (I, 1).置标题 (3, 类别组 [5])
            相减 (I, 1).置标题 (4, 类别组 [6])
            相减 (I, 1).置标题 (5, 类别组 [1])
        .计次循环尾 ()
         ' 调试输出 (超级列表框1.取表项数 ())
        赋值 (时间2, 取启动时间 ())
        0.置文本 (相加 (“猎取成功，共耗时：”, 到文本 (相除 (相减 (时间2, 时间1), 1000)), “秒”))
        1.置文本 (相加 (“共猎取电影”, 到文本 (相减 (I, 1)), “部”))
    .否则
        信息框 (相加 (“读取网页失败，可能是网页结构发生了改变！”, #换行符, “你可能需要更新本程序。”), #信息图标, “抱歉”)
        0.置文本 (“猎取失败”)
    .如果结束
    
.否则
    信息框 (相加 (“读取网页失败，可能是网页地址发生了改变！”, #换行符, “你可能需要更新本程序。”), #信息图标, “抱歉”)
    0.置文本 (“猎取失败”)
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
正在提取状态显示 ()
赋值 (网页原始数据, 访问网页 (地址数组 [2], , , , , , ))
赋值 (_启动窗口., “爱情”)
赋值 (_启动窗口., 相加 (#窗口标题, “ - 爱情”))
处理种子地址链接 ()

.子程序 _按钮3_被单击, 空白型, , 
正在提取状态显示 ()
赋值 (网页原始数据, 访问网页 (地址数组 [3], , , , , , ))
赋值 (_启动窗口., “动作”)
赋值 (_启动窗口., 相加 (#窗口标题, “ - 动作”))
处理种子地址链接 ()

.子程序 _按钮4_被单击, 空白型, , 
正在提取状态显示 ()
赋值 (网页原始数据, 访问网页 (地址数组 [4], , , , , , ))
赋值 (_启动窗口., “喜剧”)
赋值 (_启动窗口., 相加 (#窗口标题, “ - 喜剧”))
处理种子地址链接 ()

.子程序 _按钮5_被单击, 空白型, , 
正在提取状态显示 ()
赋值 (网页原始数据, 访问网页 (地址数组 [5], , , , , , ))
赋值 (_启动窗口., “恐怖”)
赋值 (_启动窗口., 相加 (#窗口标题, “ - 恐怖”))
处理种子地址链接 ()

.子程序 _按钮6_被单击, 空白型, , 
正在提取状态显示 ()
赋值 (网页原始数据, 访问网页 (地址数组 [6], , , , , , ))
赋值 (_启动窗口., “战争”)
赋值 (_启动窗口., 相加 (#窗口标题, “ - 战争”))
处理种子地址链接 ()

.子程序 _按钮7_被单击, 空白型, , 
正在提取状态显示 ()
赋值 (网页原始数据, 访问网页 (地址数组 [7], , , , , , ))
赋值 (_启动窗口., “科幻”)
赋值 (_启动窗口., 相加 (#窗口标题, “ - 科幻”))
处理种子地址链接 ()

.子程序 _按钮8_被单击, 空白型, , 
正在提取状态显示 ()
赋值 (网页原始数据, 访问网页 (地址数组 [8], , , , , , ))
赋值 (_启动窗口., “剧情”)
赋值 (_启动窗口., 相加 (#窗口标题, “ - 剧情”))
处理种子地址链接 ()

.子程序 _按钮9_被单击, 空白型, , 
正在提取状态显示 ()
赋值 (网页原始数据, 访问网页 (地址数组 [9], , , , , , ))
赋值 (_启动窗口., “电视剧”)
赋值 (_启动窗口., 相加 (#窗口标题, “ - 电视剧”))
处理种子地址链接 ()

.子程序 _按钮10_被单击, 空白型, , 
正在提取状态显示 ()
赋值 (网页原始数据, 访问网页 (地址数组 [10], , , , , , ))
赋值 (_启动窗口., “综艺”)
赋值 (_启动窗口., 相加 (#窗口标题, “ - 综艺”))
处理种子地址链接 ()

.子程序 _按钮11_被单击, 空白型, , 
正在提取状态显示 ()
赋值 (网页原始数据, 访问网页 (地址数组 [11], , , , , , ))
赋值 (_启动窗口., “动漫”)
赋值 (_启动窗口., 相加 (#窗口标题, “ - 动漫”))
处理种子地址链接 ()

.子程序 _下载种子_被选择, 空白型, , 
正在下载状态显示 ()
下载BT种子 (., 假)
 ' 执行 (#打开文件, 取运行目录 () ＋ “\Torrent\” ＋ 下载BT种子 () ＋ “.torrent”, , )

.子程序 下载BT种子, 逻辑型, , 
.参数 表项, 整数型, , 
.参数 是否批量, 逻辑型, , 

.局部变量 文件名, 文本型, , , 
.局部变量 结果, 逻辑型, , , 

赋值 (文件名, 表项.取标题 (0))
.如果真 (不等于 (寻找文本 (文件名, “|”, , 真), -1))
    赋值 (文件名, 取文本左边 (文件名, 相减 (寻找文本 (文件名, “|”, , 真), 1)))
.如果真结束
创建目录 (相加 (取运行目录 (), “\Torrent”))
创建目录 (相加 (取运行目录 (), “\Torrent\”, _启动窗口.))
赋值 (结果, 写到文件 (相加 (取运行目录 (), “\Torrent\”, _启动窗口., “\”, 文件名, “.torrent”), 访问网页 (表项.取标题 (5))))
.如果真 (等于 (是否批量, 假))
    .如果 (等于 (结果, 真))
        信息框 (“BT种子成功下载在程序目录下的 Torrent 目录，系统将尝试打开！”, #信息图标, “恭喜”)
    .否则
        信息框 (“BT种子下载失败，原因未知！”, #警告图标, “抱歉”)
    .如果结束
    
.如果真结束
返回 (结果)

.子程序 _超级列表框1_右键单击表项, 空白型, , 
.局部变量 I, 整数型, , , 

赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
.计次循环首 (取表项数 (), I)
    .如果真 (等于 (相减 (I, 1).取当前状态图片 (), 1))
        赋值 (.禁止, 假)
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
.如果真 (不等于 (取已选择表项数 (), 0))
    赋值 (.禁止, 假)
.如果真结束
.如果真 (不等于 (取表项数 (), 0))
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
.如果真结束
弹出菜单 ()

.子程序 _复制地址_被选择, 空白型, , 
置剪辑板文本 (.取标题 (., 5))

.子程序 _下载全部_被选择, 空白型, , 
.局部变量 I, 整数型, , , 
.局部变量 下载计数, 整数型, , , 

正在下载状态显示 ()
1.置文本 (“双击这里停止下载”)
连续赋值 (真, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
.计次循环首 (取表项数 (), I)
    .如果真 (等于 (., “0”))
        跳出循环 ()
    .如果真结束
    相减 (I, 1).选择表项 ()
    .如果真 (等于 (下载BT种子 (相减 (I, 1), 真), 真))
        相减 (I, 1).置状态图片 (1)
        赋值 (下载计数, 相加 (下载计数, 1))
    .如果真结束
    
.计次循环尾 ()
批量下载成功提示 (下载计数)

.子程序 批量下载成功提示, 空白型, , 
.参数 I, 整数型, , 

.局部变量 未下载种子名, 文本型, , , 

0.置文本 (“批量下载成功”)
1.置文本 (相加 (“共下载BT电影种子”, 到文本 (I), “个”))
.计次循环首 (取表项数 (), I)
    .如果真 (等于 (相减 (I, 1).取当前状态图片 (), 0))
        赋值 (未下载种子名, 相加 (未下载种子名, 相减 (I, 1).取标题 (0), #换行符))
    .如果真结束
    
.计次循环尾 ()
.如果 (等于 (未下载种子名, “”))
    信息框 (相加 (“BT种子成功下载在程序目录下的 Torrent 目录内！”, #换行符, 未下载种子名), #信息图标, “恭喜”)
.否则
    信息框 (相加 (“部分BT种子成功下载在程序目录下的 Torrent ，未成功下载的种子有”, #换行符, 未下载种子名), #警告图标, “提示”)
.如果结束
连续赋值 (假, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
赋值 (., “”)

.子程序 _状态条1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., “0”)

.子程序 _下载选中_被选择, 空白型, , 
.局部变量 I, 整数型, , , 
.局部变量 选中表项数组, 整数型, , "0", 
.局部变量 下载计数, 整数型, , , 

正在下载状态显示 ()
1.置文本 (“双击这里停止下载”)
.计次循环首 (取表项数 (), I)
    .如果真 (等于 (相减 (I, 1).取当前状态图片 (), 1))
        加入成员 (选中表项数组, 相减 (I, 1))
    .如果真结束
    
.计次循环尾 ()

.计次循环首 (取数组成员数 (选中表项数组), I)
    选中表项数组.选择表项 ( [I])
    .如果真 (等于 (下载BT种子 (选中表项数组 [I], 真), 真))
        赋值 (下载计数, 相加 (下载计数, 1))
    .如果真结束
    选中表项数组.置状态图片 ( [I], 0)
.计次循环尾 ()
批量下载成功提示 (下载计数)

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
赋值 (., “0”)

.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 UTF8转ANSI, 文本型, , 方圆软件工作室－林炳崇（进在眼前）出品
.参数 UTF8, 字节集, , 待转换UTF-8编码字节集



.子程序 UNICODE转ANSI, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 Unicode数据, 字节集, , Unicode码字节集数据



.子程序 ANSI转UNICODE, 字节集, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 文本, 文本型, , Ansi码文本，只针对中文或双字节全角字符



.子程序 UTF8转UNICODE, 字节集, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 UTF8, 字节集, , 待转换UTF-8编码字节集



.子程序 UNICODE转UTF8, 字节集, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 UNICODE, 字节集, , 待转换UNICODE编码字节集



.子程序 ANSI转UTF8, 字节集, , 方圆软件工作室－林炳崇（进在眼前）出品
.参数 文本, 文本型, , 要转换为UTF8编码的文本



.子程序 BASE64编码, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 待编码数据, 字节集, , 



.子程序 BASE64解码, 字节集, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 待解码数据, 文本型, , 



.子程序 文本加密, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 文本, 文本型, , 待加密文本（本加密方法为动态随机加密，所以每次加密后的文本都不同）
.参数 密匙, 文本型, 可空, 长度为62任意不重复单字节可见字符，默认为：ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz



.子程序 文本解密, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 文本, 文本型, , 待解密文本
.参数 密匙, 文本型, 可空, 必须跟加密时相同的密匙文本



.子程序 ANSI转USC2, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 文本, 文本型, , 



.子程序 USC2转ANSI, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 USC2, 文本型, , 




 ' 不属于任何一个程序集、类模块的函数：
