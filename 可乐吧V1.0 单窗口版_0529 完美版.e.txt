 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 260
    顶边 = 50
    宽度 = 628
    高度 = 416
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “EFengSoft”
    帮助文件名 = “”

窗口 打开窗口
    左边 = 50
    顶边 = 50
    宽度 = 355
    高度 = 163
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “打开网络媒体:”
    帮助文件名 = “”



.常量 信息标题, "“可乐吧提示：”", , 
.常量 主窗口标题, "“可乐吧开发版V1.0”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 5 系统核心支持库
 ' eDB 46E94341933A462383A4DE26B146322C 1 4 数据库操作支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' wmp9.npk {6BF52A52-394A-11d3-B153-00C04F79FAA6}##0 1 0 Windows媒体播放器 0,{19A6627B-DA9E-47C1-BB23-00B5E668236A},IWMPEvents,{5001,5101,5102,5002,5301,5403,5401,5402,5501,5601,5201,5202,5203,5204,5701,5801,5804,5805,5802,5803,5806,5807,5808,5809,5820,5810,5811,5812,5818,5819,5821,5823,5822,6501,6502,6503,6504,6505,6506,6507,6508,6509,6510,6511,6512,},{},{}2,{00000000-0000-0000-0000-000000000000},WMPPlaylistChangeEventType,{},{1073741835,1073741834,1073741833,1073741832,1073741831,1073741830,1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}1,{6BF52A52-394A-11D3-B153-00C04F79FAA6},WindowsMediaPlayer,{3,4,5,6,8,9,12,7,13,14,15,17,40,41,42,27,28,6,13,},{26,25,24,23,22,21,19,18,16,11,10,2,1,},{5001,5101,5102,5002,5301,5403,5401,5402,5501,5601,5201,5202,5203,5204,5701,5801,5804,5805,5802,5803,5806,5807,5808,5809,5820,5810,5811,5812,5818,5819,5821,5823,5822,6501,6502,6503,6504,6505,6506,6507,6508,6509,6510,6511,6512,}0,{BC17E5B7-7561-4C18-BB90-17D485775659},IWMPCore2,{3,4,5,6,8,9,12,7,13,14,15,17,40,6,13,},{18,16,11,10,2,1,},{}0,{D84CCA99-CCE2-11D2-9ECC-0000F8085981},IWMPCore,{3,4,5,6,8,9,12,7,13,14,15,17,6,13,},{18,16,11,10,2,1,},{}2,{00000000-0000-0000-0000-000000000000},WMPOpenState,{},{1073741845,1073741844,1073741843,1073741842,1073741841,1073741840,1073741839,1073741838,1073741837,1073741836,1073741835,1073741834,1073741833,1073741832,1073741831,1073741830,1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}2,{00000000-0000-0000-0000-000000000000},WMPPlayState,{},{1073741836,1073741835,1073741834,1073741833,1073741832,1073741831,1073741830,1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{74C09E02-F828-11D2-A74B-00A0C905F36E},IWMPControls,{62,51,52,53,54,55,58,59,60,63,60,},{61,57,56,},{}0,{94D55E95-3FAC-11D3-B155-00C04F79FAA6},IWMPMedia,{763,755,756,760,761,762,765,766,767,},{759,758,757,754,753,752,764,751,},{}0,{D5F0F4F1-130C-11D3-B14E-00C04F79FAA6},IWMPPlaylist,{211,212,203,204,213,205,206,207,208,209,},{210,202,201,},{}0,{9104D1AB-80C9-4FED-ABF0-2E6417A6DF14},IWMPSettings,{113,110,111,},{112,107,102,106,105,104,103,109,108,101,},{}0,{8363BC22-B4B4-4B19-989D-1CD765749DD1},IWMPMediaCollection,{452,453,454,455,456,457,458,459,461,470,471,472,},{},{}0,{4A976298-8C0D-11D3-B389-00C04F68574B},IWMPStringCollection,{402,},{401,},{}0,{10A13217-23A7-439B-B1C0-D847C79B7774},IWMPPlaylistCollection,{552,553,554,556,560,561,562,},{},{}0,{679409C0-99F7-11D3-9FB7-00105AA620BB},IWMPPlaylistArray,{502,},{501,},{}0,{EC21B779-EDEF-462D-BBA4-AD9DDE2B29A7},IWMPNetwork,{813,814,815,816,817,818,819,820,821,822,},{826,825,824,823,812,811,810,809,808,807,806,805,804,803,802,801,},{}0,{EE4C8FE2-34B2-11D3-A3BF-006097C9B344},IWMPCdromCollection,{302,303,},{301,},{}0,{CFAB6E98-8730-11D3-B388-00C04F68574B},IWMPCdrom,{252,253,},{251,},{}0,{4F2DF574-C588-11D3-9ED0-00C04FB6E937},IWMPClosedCaption,{},{954,953,952,951,},{}0,{A12DCF7D-14AB-4C1B-A8CD-63909F06025B},IWMPError,{851,853,854,},{852,},{}0,{3614C646-3B3B-4DE7-A81E-930E3F2127B3},IWMPErrorItem,{903,},{905,904,902,901,},{}0,{8DA61686-4668-4A5C-AE5D-803193293DBE},IWMPDVD,{1001,1003,1004,1005,1006,},{1002,},{}0,{40897764-CEAB-47BE-AD4A-8E28537F9BBF},IWMPPlayerApplication,{1101,1102,},{1104,1103,},{}0,{54062B68-052A-4C25-A39F-8B63346511D4},IWMPPlayer3,{3,4,5,6,8,9,12,7,13,14,15,17,40,6,13,},{25,24,23,22,21,19,18,16,11,10,2,1,},{}0,{0E6B01D1-D407-4C85-BF5F-1C01F6150280},IWMPPlayer2,{3,4,5,6,8,9,12,7,13,14,15,17,6,13,},{25,24,23,22,21,19,18,16,11,10,2,1,},{}0,{6BF52A4F-394A-11D3-B153-00C04F79FAA6},IWMPPlayer,{3,4,5,6,8,9,12,7,13,14,15,17,6,13,},{23,22,21,19,18,16,11,10,2,1,},{}0,{F75CCEC0-C67C-475C-931E-8719870BEE7D},IWMPErrorItem2,{903,},{906,905,904,902,901,},{}0,{6F030D25-0890-480F-9775-1F7E40AB5B8E},IWMPControls2,{62,51,52,53,54,55,58,59,60,63,64,60,},{61,57,56,},{}0,{AB7C88BB-143E-4EA4-ACC3-E4350B2106C3},IWMPMedia2,{763,755,756,760,761,762,765,766,767,768,},{759,758,757,754,753,752,764,751,},{}0,{F118EFC7-F03A-4FB4-99C9-1C02A5C1065B},IWMPMedia3,{763,755,756,760,761,762,765,766,767,768,769,770,},{759,758,757,754,753,752,764,751,},{}0,{5C29BBE0-F87D-4C45-AA28-A70F0230FFA9},IWMPMetadataPicture,{},{1054,1053,1052,1051,},{}0,{769A72DB-13D2-45E2-9C48-53CA9D5B7450},IWMPMetadataText,{},{1055,1056,},{}0,{FDA937A4-EECE-4DA5-A0B6-39BF89ADE2C2},IWMPSettings2,{113,110,111,116,},{115,114,112,107,102,106,105,104,103,109,108,101,},{}0,{A1D1110E-D545-476A-9A78-AC3E4CB1E6BD},IWMPControls3,{62,51,52,53,54,55,58,59,60,63,64,66,67,70,60,},{71,69,68,65,61,57,56,},{}0,{350BA78B-6BC8-4113-A5F5-312056934EB6},IWMPClosedCaption2,{956,957,959,},{958,955,954,953,952,951,},{}0,{E41C88DD-2364-4FF7-A0F5-CA9859AF783F},IAppDispatch,{105,106,110,111,},{113,112,109,108,107,104,103,102,101,100,},{}0,{EF870383-83AB-4EA9-BE48-56FA4251AF10},IWMPSafeBrowser,{8403,8404,8405,8406,8407,8408,8409,},{8402,8401,8400,},{}0,{21D077C1-4BAA-11D3-BD45-00C04F6EA5AE},IWMPObjectExtendedProps,{2015,2017,},{2020,2019,2018,2016,2014,2013,2012,2011,2010,2009,2008,2007,2006,2005,2004,2003,2002,2001,2000,},{}0,{72F486B1-0D43-11D3-BD3F-00C04F6EA5AE},IWMPLayoutSubView,{2015,2017,},{2306,2305,2304,2303,2302,2301,2300,2020,2019,2018,2016,2014,2013,2012,2011,2010,2009,2008,2007,2006,2005,2004,2003,2002,2001,2000,},{}0,{172E905D-80D9-4C2F-B7CE-2CCB771787A2},IWMPLayoutView,{2015,2017,2318,2319,2320,2321,2322,2323,2324,},{2317,2316,2315,2314,2313,2312,2311,2309,2308,2307,2306,2305,2304,2303,2302,2301,2300,2020,2019,2018,2016,2014,2013,2012,2011,2010,2009,2008,2007,2006,2005,2004,2003,2002,2001,2000,},{}0,{5AF0BEC1-46AA-11D3-BD45-00C04F6EA5AE},IWMPEventObject,{2200,2204,2205,},{2217,2216,2215,2214,2213,2212,2211,2210,2209,2208,2207,2206,2203,2202,2201,},{}0,{6FCAE13D-E492-4584-9C21-D2C052A2A33A},IWMPTheme,{2506,2507,2508,2515,2509,2510,2511,2512,2513,2514,},{2505,2504,2503,2502,2501,2500,},{}0,{B2C2D18E-97AF-4B6A-A56B-2FFFF470FB81},IWMPLayoutSettingsDispatch,{2810,2815,},{2866,2865,2864,2863,2862,2861,2860,2859,2858,2854,2853,2852,2851,2850,2857,2856,2855,2849,2848,2847,2846,2845,2844,2843,2842,2841,2840,2839,2838,2837,2836,2835,2834,2833,2832,2831,2830,2829,2828,2827,2826,2825,2824,2823,2822,2821,2820,2819,2818,2817,2816,2813,2811,2809,2808,2807,2867,2805,2804,2803,2802,2801,2800,},{}0,{504F112E-77CC-4E3C-A073-5371B31D9B36},IWMPNowPlayingHelperDispatch,{2901,2902,2903,2904,2905,2909,2910,2911,2917,2918,2919,2920,2921,2922,2923,2925,2926,2926,},{2924,2916,2915,2914,2913,2912,},{}0,{87291B51-0C8E-11D3-BB2A-00A0C93CA73A},WMPButtonCtrl,{},{5114,5113,5112,5110,5109,5108,5107,5106,5105,5104,5103,5102,},{5120,}0,{FC1880CF-83B9-43A7-A066-C44CE8C82583},WMPListBoxCtrl,{6120,6111,6112,6113,6114,6115,6116,6117,6118,6122,6123,6124,},{6125,6121,6110,6109,6107,6106,6105,6104,6103,6102,6101,6100,6108,},{}0,{D255DFB8-C22A-42CF-B8B7-F15D7BCF65D6},IWMPListBoxItem,{6119,},{},{}0,{63D9D30F-AE4C-4678-8CA8-5720F4FE4419},IWMPPlaylistCtrlColumn,{},{5673,5672,5671,5670,},{}0,{F2BF2C90-405F-11D3-BB39-00A0C93CA73A},WMPSliderCtrl,{},{5426,5425,5424,5423,5422,5421,5420,5419,5418,5417,5416,5415,5414,5413,5412,5411,5410,5409,5408,5407,5406,5405,5404,5403,5402,5400,},{5430,5431,5432,}0,{61CECF11-FC3A-11D2-A1CD-005004602752},WMPVideoCtrl,{},{5709,5708,5703,5707,5706,5704,5702,5701,5700,},{5720,5721,}0,{47DEA830-D619-4154-B8D8-6B74845D6A2D},WMPEffects,{5502,5503,5504,5505,5509,5510,5511,5512,5521,5522,5505,},{5520,5518,5517,5516,5515,5514,5513,5506,5507,5501,5500,},{}0,{93EB32F5-87B1-45AD-ACC6-0F2483DB83BB},WMPEqualizerSettingsCtrl,{5815,5815,5814,5816,5817,5828,},{5833,5832,5831,5830,5829,5826,5827,5825,5824,5823,5822,5821,5820,5819,5818,5801,5813,5812,5811,5810,5809,5808,5807,5806,5805,5804,5800,},{}0,{AE7BFAFE-DCC8-4A73-92C8-CC300CA88859},WMPVideoSettingsCtrl,{5904,},{5903,5902,5901,5900,},{}0,{D9DE732A-AEE9-4503-9D11-5605589977A8},WMPLibraryTreeCtrl,{6409,6410,6411,6409,},{6408,6407,6406,6405,6404,6403,6402,6401,},{}0,{6342FCED-25EA-4033-BDDB-D049A14382D3},WMPEditCtrl,{6012,6013,6014,6015,6016,6017,6018,},{6011,6010,6009,6008,6007,6006,6005,6004,6003,6002,6001,6000,0,},{}0,{5D0AD945-289E-45C5-A9C6-F301F0152108},IWMPPluginUIHost,{6203,6204,},{6202,6201,},{}0,{BAB3768B-8883-4AEC-9F9B-E14C947913EF},WMPMenuCtrl,{6301,6302,6303,6304,6305,6306,6308,6309,},{6307,},{}0,{6B28F900-8D64-4B80-9963-CC52DDD1FBB4},WMPAutoMenuCtrl,{6501,},{},{}0,{AE3B6831-25A9-11D3-BD41-00C04F6EA5AE},WMPRegionalButtonCtrl,{5312,5313,5314,},{5316,5315,5311,5310,5309,5308,5306,5305,5304,5303,5302,5301,5300,},{}0,{09AEFF11-69EF-11D3-BD4D-00C04F6EA5AE},WMPRegionalButton,{5344,},{5347,5346,5345,5343,5342,5341,5340,5339,5333,5332,5331,5330,},{5360,5361,5362,5363,5364,5365,5366,5367,5368,5369,5370,5371,}0,{95F45AA3-ED0A-11D2-BA67-0000F80855E6},WMPCustomSliderCtrl,{},{5008,5012,5004,5003,5001,5002,5011,5010,5006,5005,5009,},{5020,5021,5022,}0,{DDDA102E-0E17-11D3-A2E2-00C04F79F88E},WMPTextCtrl,{},{5229,5228,5227,5226,5225,5224,5223,5222,5221,5217,5216,5215,5214,5213,5212,5211,5210,5209,5208,5207,5206,5201,},{}0,{5F9CFD93-8CAD-11D3-9A7E-00C04F8EFB70},WMPPlaylistCtrl,{5601,5623,5624,5625,5626,5628,5629,5630,5631,5632,5633,5634,5635,5636,5637,5644,5645,5646,5647,5648,5649,5601,},{5658,5656,5655,5654,5653,5652,5651,5650,5643,5642,5622,5621,5620,5619,5618,5617,5616,5615,5614,5613,5612,5609,5608,5607,5605,5604,5603,5602,},{}0,{891EADB1-1C45-48B0-B704-49A888DA98C4},ITaskCntrCtrl,{1610743808,1610743810,1610743808,},{},{}0,{09428D37-E0B9-11D2-B147-00C04F79FAA6},WMPCore,{3,4,5,6,8,9,12,7,13,14,15,17,40,41,42,6,13,},{18,16,11,10,2,1,},{5001,5101,5102,5002,5301,5403,5401,5402,5501,5601,5201,5202,5203,5204,5701,5801,5804,5805,5802,5803,5806,5807,5808,5809,5820,5810,5811,5812,5818,5819,5821,5823,5822,}0,{6B550945-018F-11D3-B14A-00C04F79FAA6},IWMPGraphEventHandler,{8151,8173,8153,8157,8156,8158,8172,8159,8160,8161,8178,8162,8163,8165,8166,8167,8168,8169,8170,8171,8174,8177,8179,8180,},{},{}0,{00000000-0000-0000-0000-000000000000},ULONG_PTR,{},{},{}0,{28682B8E-9055-47A9-A179-8E0BAB1164D1},IAssaultVis,{},{},{}0,{F8578BFA-CD8F-4CE1-A684-5B7E85FCA7DC},IBattery,{2,},{1,},{}0,{40C6BDE7-9C90-49D4-AD20-BEF81A6C5F22},IBatteryPreset,{},{1,},{}0,{F85E2D65-207D-48DB-84B1-915E1735DB17},IBatteryRandomPreset,{},{1,},{}0,{876E7208-0172-4EBB-B08B-2E1D30DFE44C},IBatterySavedPreset,{},{1,},{}0,{33E9291A-F6A9-11D2-9435-00A0C92A2F2D},IBarsEffect,{},{8016,8015,8014,8013,8012,8010,8009,8008,8007,8006,8005,8004,8003,8002,8001,8000,},{}0,{3984E7EB-08EF-11D3-9447-00A0C92A2F2D},ISpikesEffect,{},{8205,8204,8203,8202,8201,},{}0,{37327700-EF20-11D2-9431-00A0C92A2F2D},IDotPlaneEffect,{8313,8314,},{8315,8312,8311,8310,8309,8308,8307,8305,8304,8303,8302,8301,8300,},{}0,{E31E7583-32D5-491C-B611-825D032B02CF},IPlenoptic,{},{},{}0,{E2CC638C-FD2C-409B-A1EA-5DDB72DC8E84},IWMPExternal,{10018,},{10012,10005,},{}0,{D10CCDFF-472D-498C-B5FE-3630E5405E0A},IWMPExternalColors,{10018,},{10017,10016,10015,10014,10013,10012,10005,},{}0,{FFFB0104-CCBB-4513-8B6B-46F5098FAB43},IWMPTemplatesExternal,{10018,10011,10010,10019,10006,10021,10020,10022,10023,},{10024,10017,10016,10015,10014,10013,10012,10005,},{}0,{2E922378-EE70-4CEB-BBAB-CE7CE4A04816},IWMPSubscriptionServiceExternal,{10018,10009,},{10012,10005,},{}0,{E15E9AD1-8F20-4CC4-9EC7-1A328CA86A0D},IWMPDownloadManager,{1151,1152,},{},{}0,{7AAA2D24-B37A-4E11-82C1-E071246463A4},IWMPDownloadCollection,{1203,1204,1205,1206,},{1202,1201,},{}0,{C9470E8E-3F6B-46A9-A0A9-452815C34297},IWMPDownloadItem,{1256,1257,1258,},{1255,1254,1253,1252,1251,},{}2,{00000000-0000-0000-0000-000000000000},WMPSubscriptionDownloadState,{},{1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{2D7EF888-1D3C-484A-A906-9F49D99BB344},IWMPCDDVDWizardExternal,{10018,10001,10002,10007,10008,10011,10010,},{10017,10016,10015,10014,10013,10012,10005,},{}2,{00000000-0000-0000-0000-000000000000},WMP_WRITENAMESEX_TYPE,{},{1073741827,1073741826,1073741825,1073741824,},{}0,{F81B2A59-02BC-4003-8B2F-C124AF66FC66},IWMPBaseExternal,{10018,},{10012,10005,},{}0,{3148E685-B243-423D-8341-8480D6EFF674},IWMPOfflineExternal,{10018,10025,},{10012,10005,},{}





.DLL命令 指定新父窗口, 整数型, "user32", "SetParent", , 指定一个窗口的新父（在vb里使用：利用这个函数，vb可以多种形式支持子窗口。例如，可将控件从一个容器移至窗体中的另一个。用这个函数在窗体间移动控件是相当冒险的，但却不失为一个有效的办法。如真的这样做，请在关闭任何一个窗体之前，注意用SetParent将控件的父设回原来的那个）  前一个父窗口的句柄
    .参数 hWndChild, 整数型, , 子窗口的句柄
    .参数 hWndNewParent, 整数型, , hWndChild的新父;

.DLL命令 寻找顶级窗口, 整数型, "user32", "FindWindowA", , 寻找窗口列表中第一个符合指定条件的顶级窗口（在vb里使用：FindWindow最常见的一个用途是获得ThunderRTMain类的隐藏窗口的句柄；该类是所有运行中vb执行程序的一部分。获得句柄后，可用api函数GetWindowText取得这个窗口的名称；该名也是应用程序的标题）  找到窗口的句柄。如未找到相符窗口，则返回零。会设置GetLastError
    .参数 窗口类名, 文本型, , 指向包含了窗口类名的空中止（C语言）字串的指针；或设为零，表示接收任何类
    .参数 窗口文本, 文本型, , 指向包含了窗口文本（或标签）的空中止（C语言）字串的指针；或设为零，表示接收任何窗口标题  示例Dim hw&

.窗口程序集 启动窗口程序集, , , 

.程序集变量 播放器控制, 未知类型0x40008, , , 
.程序集变量 播放器媒体, 未知类型0x40009, , , 
.程序集变量 播放器网络, 未知类型0x40010, , , 
.程序集变量 播放器设定, 未知类型0x4000B, , , 
.程序集变量 播放器光驱, 未知类型0x40012, , , 
.程序集变量 播放器状态, 未知类型0x40007, , , 
.程序集变量 播放器光驱集, 未知类型0x40011, , , 
.程序集变量 匿名程序集变量_410, 空白型, , , 
.程序集变量 媒体时长, 整数型, , , 
.程序集变量 当前位置, 整数型, , , 
.程序集变量 媒体文件, 文本型, , , 
.程序集变量 媒体宽度, 整数型, , , 
.程序集变量 媒体高度, 整数型, , , 
.程序集变量 配置文件, 文本型, , , 
.程序集变量 匿名程序集变量_637, 空白型, , , 
.程序集变量 显示列表, 逻辑型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
初始化播放器 ()
初始化历史记录 ()
初始化数据库 ()

.子程序 初始化播放器, 空白型, , 
赋值 (_启动窗口., #主窗口标题)
赋值 (.标题, “”)
赋值 (.标题, “”)
赋值 (显示列表, 真)
赋值 (播放器控制, 未知支持库函数_55 ())
赋值 (播放器设定, 未知支持库函数_56 ())
赋值 (播放器设定., 假)
赋值 (., 真)
初始化声道与音量 ()

.子程序 初始化声道与音量, 空白型, , 
赋值 (.位置, 10)
_滑块条_音量_位置被改变 ()
赋值 (.位置, 10)
_滑块条_声道_位置被改变 ()

.子程序 初始化历史记录, 空白型, , OK
.局部变量 文件地址, 文本型, , , 
.局部变量 计次变量, 整数型, , , 
.局部变量 循环变量, 整数型, , , 
.局部变量 文件名称, 文本型, , , 
.局部变量 符号位置, 整数型, , , 

赋值 (配置文件, 相加 (取运行目录 (), “\Config.ini”))

赋值 (计次变量, 5)
.计次循环首 (计次变量, 循环变量)
    赋值 (文件地址, 读配置项 (配置文件, “历史记录”, 到文本 (循环变量), ))
    .如果 (并且 (等于 (循环变量, 1), 等于 (文件地址, “”)))
        赋值 (.标题, “... ...”)
        赋值 (.可视, 真)
        赋值 (.可视, 假)
        赋值 (.可视, 假)
        赋值 (.可视, 假)
        赋值 (.可视, 假)
        赋值 (.禁止, 真)
        跳出循环 ()
    .否则
        赋值 (.禁止, 假)
        .如果真 (不等于 (寻找文本 (文件地址, “\”, , 假), -1))
            赋值 (符号位置, 倒找文本 (文件地址, “\”, , 假))
            赋值 (文件名称, 取文本右边 (文件地址, 相减 (取文本长度 (文件地址), 符号位置)))
            .判断开始 (等于 (循环变量, 1))
                .如果真 (不等于 (文件名称, “”))
                    赋值 (.标题, 相加 (到文本 (1), “. ”, 文件名称))
                    赋值 (.可视, 真)
                .如果真结束
                
            .判断 (等于 (循环变量, 2))
                .如果真 (不等于 (文件名称, “”))
                    赋值 (.标题, 相加 (到文本 (2), “. ”, 文件名称))
                    赋值 (.可视, 真)
                .如果真结束
                
            .判断 (等于 (循环变量, 3))
                .如果真 (不等于 (文件名称, “”))
                    赋值 (.标题, 相加 (到文本 (3), “. ”, 文件名称))
                    赋值 (.可视, 真)
                .如果真结束
                
            .判断 (等于 (循环变量, 4))
                .如果真 (不等于 (文件名称, “”))
                    赋值 (.标题, 相加 (到文本 (4), “. ”, 文件名称))
                    赋值 (.可视, 真)
                .如果真结束
                
            .判断 (等于 (循环变量, 5))
                .如果真 (不等于 (文件名称, “”))
                    赋值 (.标题, 相加 (到文本 (5), “. ”, 文件名称))
                    赋值 (.可视, 真)
                .如果真结束
                
            .默认
                
            .判断结束
            
        .如果真结束
        .如果真 (不等于 (寻找文本 (文件地址, “/”, , 假), -1))
            赋值 (符号位置, 倒找文本 (文件地址, “/”, , 假))
            赋值 (文件名称, 取文本右边 (文件地址, 相减 (取文本长度 (文件地址), 符号位置)))
            .判断开始 (等于 (循环变量, 1))
                .如果真 (不等于 (文件名称, “”))
                    赋值 (.标题, 相加 (到文本 (1), “. ”, 文件名称))
                    赋值 (.可视, 真)
                .如果真结束
                
            .判断 (等于 (循环变量, 2))
                .如果真 (不等于 (文件名称, “”))
                    赋值 (.标题, 相加 (到文本 (2), “. ”, 文件名称))
                    赋值 (.可视, 真)
                .如果真结束
                
            .判断 (等于 (循环变量, 3))
                .如果真 (不等于 (文件名称, “”))
                    赋值 (.标题, 相加 (到文本 (3), “. ”, 文件名称))
                    赋值 (.可视, 真)
                .如果真结束
                
            .判断 (等于 (循环变量, 4))
                .如果真 (不等于 (文件名称, “”))
                    赋值 (.标题, 相加 (到文本 (4), “. ”, 文件名称))
                    赋值 (.可视, 真)
                .如果真结束
                
            .判断 (等于 (循环变量, 5))
                .如果真 (不等于 (文件名称, “”))
                    赋值 (.标题, 相加 (到文本 (5), “. ”, 文件名称))
                    赋值 (.可视, 真)
                .如果真结束
                
            .默认
                
            .判断结束
            
        .如果真结束
        
    .如果结束
    
.计次循环尾 ()

.子程序 初始化数据库, 空白型, , 指定数据库文件和数据库表名，并检测数据库是否存在！  含测试代码
.局部变量 MDB数据库, 文本型, , , 
.局部变量 MDB数据表, 文本型, , , 
.局部变量 排序条件, 文本型, , , 

赋值 (MDB数据库, 相加 (取运行目录 (), “\moviedate.mdb”))
赋值 (MDB数据表, “moviedate”)
.如果 (不等于 (寻找文件 (MDB数据库, ), “”))
     ' --------------------------打开指定的数据库：
    .如果 (等于 (MDB数据库.未知支持库函数_1 (“”), 真))
        .未知支持库函数_12 () ' 非常重要！容易忘记的命令
        处理事件 ()
        输出调试文本 (“列表窗口 打开数据库子程序：MDB数据库打开成功！”)
         ' --------------------------' 按指定的规则自动排序，哪个放在前面，哪个优先。此顺序不得更改！！！
        赋值 (排序条件, “分类热度 ASC,媒体分类 ASC,影片热度 ASC,媒体名称 ASC”)
        .如果 (等于 (MDB数据表.未知支持库函数_15 (排序条件), 真))
            处理事件 ()
            输出调试文本 (“列表窗口 打开数据库：MDB数据表打开成功！”)
            填充树型框分类 ()
        .否则
            输出调试文本 (“列表窗口 打开数据库：MDB数据表打开失败！系统将自动退出！！！”)
            销毁 ()
        .如果结束
        
    .否则
         ' --------------------------打开数据库失败：
        信息框 (“列表窗口 打开数据库：MDB数据库打开失败！”, 0, ) ' 测试代码
        返回 ()
    .如果结束
    
.否则
     ' --------------------------没有找到默认数据库：
    信息框 (“列表窗口 初始化数据库子程序：找不到指定的MDB数据库！”, #信息图标, ) ' 测试代码
    结束 ()
.如果结束


.子程序 填充树型框分类, 空白型, , 根据数库"媒体分类"自动生成相应的树型框，无需考虑数据库的媒体类型中存在什么内容，自动过滤重复项目并加入到树型框
.局部变量 分类变量, 文本型, , , 临时储存媒体分类字段内容
.局部变量 树项目总数, 整数型, , , 储存获取的树型框项目总数
.局部变量 树循环循环, 整数型, , , 循环变量
.局部变量 临时项目文本, 文本型, , , 临时储存当前循环读取的树型框项目文本
.局部变量 是否存在重复, 整数型, , , 0代表有没有重复项目，1代表有重复项目,不需要初始化

 ' -----------------------------------以下代码为 加入数据库 媒体类型 字段中的项目，并判断是否存在重复项目
未知支持库函数_34 ()
.判断循环首 (等于 (., 假))
    “媒体分类”.未知支持库函数_26 (分类变量)
    赋值 (树项目总数, 取项目数 ())
    .如果 (等于 (树项目总数, 0)) ' 否则就是大于0，则跳到下面进行判断
        .加入项目 (分类变量, , , )
    .否则
        .计次循环首 (树项目总数, 树循环循环)
            赋值 (临时项目文本, 相减 (树循环循环, 1).取项目文本 ())
            .如果 (等于 (临时项目文本, 分类变量))
                赋值 (是否存在重复, 1) ' 1 代表有重复项目
                跳出循环 ()
            .否则
                赋值 (是否存在重复, 0) ' 0 代表没有重复项目
            .如果结束
            赋值 (树循环循环, 相加 (树循环循环, 1))
        .计次循环尾 ()
        .如果真 (等于 (是否存在重复, 0))
            .加入项目 (分类变量, , , )
        .如果真结束
        
    .如果结束
    处理事件 ()
    未知支持库函数_36 ()
    输出调试文本 (相加 (“记录集当前位置：”, 到文本 (.)))
.判断循环尾 ()
填充树型框名称 ()

.子程序 填充树型框名称, 空白型, , 成功！！！根据数库"媒体名称"自动生成相应的树型框，无需考虑树型框有几个项目，均可以自动识别并准确加入到相关的树型框父项目中
.局部变量 原项目变量, 整数型, , , 储存刚才 填充树型框分类 子程序所添加的项目总数
.局部变量 原项目循环, 整数型, , , 循环变量
.局部变量 项目数组, 文本型, , "0", 经过N次修改，最终发现只有 原项目变量 所对应的项目文本在这里唯一没有变化的，所以将他们加入到数组中，以备下面的程序进行对照
.局部变量 原项目文本, 文本型, , , 储存当前循环所读取的项目文本值
.局部变量 匿名局部变量_124, 空白型, , , 
.局部变量 新项目变量, 整数型, , , 和原项目XX变量的区别是：新项目XX是加入X个树型框项目后所获取的。注：由代码自动完成
.局部变量 新项目循环, 整数型, , , 和原项目XX变量的区别是：新项目XX是加入X个树型框项目后所获取的。注：由代码自动完成
.局部变量 新项目文本, 文本型, , , 和原项目XX变量的区别是：新项目XX是加入X个树型框项目后所获取的。注：由代码自动完成
.局部变量 新项目标题, 文本型, , , 添加了“(X部影片)”字样后的项目文本
.局部变量 匿名局部变量_129, 空白型, , , 
.局部变量 过滤语句, 文本型, , , 过滤出符合条件的记录，然后再读取。  ^-^   加快代码的执行速度，省去不必要的循环
.局部变量 文本数组, 文本型, , "0", 用来储存过滤以后所读入的项目文本，用数组是为了加快速度，也避免单个加入时树型框当前项目指针移动的问题。注意：指针好像是无法控制的
.局部变量 文本变量, 文本型, , , 储存循环过程中，所读入的相应内容。此变量是加入到 文本数组 的成员内容
.局部变量 匿名局部变量_133, 空白型, , , 
.局部变量 数组成员, 整数型, , , 
.局部变量 数组循环, 整数型, , , 
.局部变量 匿名局部变量_136, 空白型, , , 
.局部变量 次数数量, 整数型, , , 执行过滤后得到的记录总数
.局部变量 次数循环, 整数型, , , 


 ' -------------取出树型框媒体类型的项目文本值
赋值 (原项目变量, 取项目数 ())
赋值 (原项目循环, 1)
.计次循环首 (原项目变量, 原项目循环)
    加入成员 (项目数组, 相减 (原项目循环, 1).取项目文本 ())
    输出调试文本 (项目数组 [原项目循环])
.计次循环尾 ()
 ' -------------读取并输出数组成员的详细信息,测试为4个数组
赋值 (数组成员, 取数组成员数 (项目数组))
 ' 输出调试文本 (“列表窗口： 共计 ” ＋ 到文本 (数组成员) ＋ “ 个数组成员，分别是：” ＋ 项目数组 [1] ＋ “、” ＋ 项目数组 [2] ＋ “、” ＋ 项目数组 [3] ＋ “、” ＋ 项目数组 [4])
 ' -------------根据数组成员数进行循环，因为数组成员数在这里是唯一没有变化的
.计次循环首 (数组成员, 数组循环)
     ' -------------根据 数组循环 的变化来确定这是第几次循环
    赋值 (原项目文本, 项目数组 [数组循环])
    赋值 (过滤语句, 相加 (“媒体分类”, “=”, “'”, 原项目文本, “'”))
    .如果 (等于 (过滤语句.未知支持库函数_47 (), 真))
        赋值 (次数数量, .)
        输出调试文本 (相加 (“列表窗口： 过滤成功！记录总数：”, 到文本 (次数数量)))
         ' -------------' 重新初始化变量并赋值取得过滤后符合条件的记录数并循环加入到树型框
        清除数组 (文本数组)
         ' -------------' 取得过滤后符合条件的记录数并循环加入到树型框
        .计次循环首 (次数数量, 次数循环)
            “媒体名称”.未知支持库函数_26 (文本变量)
            加入成员 (文本数组, 文本变量)
            输出调试文本 (相加 (到文本 (次数循环), “  ”, 文本变量))
            赋值 (次数循环, 相加 (次数循环, 1))
            未知支持库函数_36 ()
        .计次循环尾 ()
        重置项目数值 ()
        赋值 (新项目变量, 取项目数 ())
        赋值 (新项目循环, 1)
        .如果真 (等于 (新项目变量, 原项目变量))
            0.置项目文本 (相加 (原项目文本, “  (”, 到文本 (次数数量), “部影片)”)) ' 和下一句代码的位置可以互换。
            0.加入项目 (文本数组, , , ) ' 第一组分类 值为零
        .如果真结束
        .计次循环首 (新项目变量, 新项目循环)
            赋值 (新项目文本, 新项目循环.取项目文本 ())
            .如果真 (等于 (新项目文本, 原项目文本))
                新项目循环.置项目文本 (相加 (原项目文本, “  (”, 到文本 (次数数量), “部影片)”)) ' 不可互换位置，否则会出错！！！
                新项目循环.加入项目 (文本数组, , , )
            .如果真结束
            赋值 (新项目循环, 相加 (新项目循环, 1))
        .计次循环尾 ()
        
    .否则
        输出调试文本 (相加 (“列表窗口： 过滤失败！ 过滤语句:”, 过滤语句, “ ,记录总数：”, 到文本 (.)))
        信息框 (“列表窗口 填充树型框分类子程序 过滤失败！！！”, 0, ) ' 测试代码！！！
        返回 ()
    .如果结束
    
.计次循环尾 ()
重置项目数值 ()
“”.未知支持库函数_47 () ' 将过滤命令清空，否则下面执行会出错
输出调试文本 (.) ' 测试代码！！！

.子程序 _树型框_双击项目, 空白型, , 
.局部变量 媒体地址, 文本型, , , 
.局部变量 项目文本, 文本型, , , 
.局部变量 查找条件, 文本型, , , 

赋值 (项目文本, .取项目文本 (.最大化按钮))
赋值 (查找条件, 相加 (“媒体名称”, “=”, “'”, 项目文本, “'”))
未知支持库函数_34 ()
.如果 (等于 (查找条件.未知支持库函数_45 (1), 真))
    “媒体地址”.未知支持库函数_26 (媒体地址)
    输出调试文本 (相加 (“列表窗口：_树型框_双击项目子程序 查找项目:”, 项目文本, “ = 真”, “  ”, 媒体地址))
    .如果真 (不等于 (媒体地址, “”))
        打开媒体文件 (媒体地址)
    .如果真结束
    
.否则
    信息框 (“找不到指定的媒体文件”, #信息图标, #信息标题)
.如果结束


.子程序 重置项目数值, 空白型, , 重置树型框中的项目数值
.局部变量 项目变量, 整数型, , , 
.局部变量 循环变量, 整数型, , , 

赋值 (项目变量, 取项目数 ())
.计次循环首 (项目变量, 循环变量)
    相减 (循环变量, 1).置项目数值 (循环变量)
.计次循环尾 ()

.子程序 关闭数据库, 空白型, , 
未知支持库函数_16 ()
未知支持库函数_3 ()

.子程序 加入历史记录, 空白型, , 如果是网络媒体，在播放成功的情况下才会加入到历史记录
.参数 文件名, 文本型, , 

.局部变量 临时文本, 文本型, , , 
.局部变量 计次变量, 整数型, , , 
.局部变量 循环变量, 整数型, , , 

赋值 (计次变量, 5)
.计次循环首 (计次变量, 循环变量)
    赋值 (临时文本, 读配置项 (配置文件, “历史记录”, 到文本 (相减 (计次变量, 循环变量)), ))
    .如果 (不等于 (循环变量, 计次变量))
        写配置项 (配置文件, “历史记录”, 到文本 (相加 (相减 (计次变量, 循环变量), 1)), 临时文本)
    .否则
        写配置项 (配置文件, “历史记录”, “1”, 文件名)
    .如果结束
    
.计次循环尾 ()

.子程序 _历史1_被选择, 空白型, , 
菜单读取历史记录 (1)

.子程序 _历史2_被选择, 空白型, , 
菜单读取历史记录 (2)

.子程序 _历史3_被选择, 空白型, , 
菜单读取历史记录 (3)

.子程序 _历史4_被选择, 空白型, , 
菜单读取历史记录 (4)

.子程序 _历史5_被选择, 空白型, , 
菜单读取历史记录 (5)

.子程序 菜单读取历史记录, 空白型, , 
.参数 菜单编号, 整数型, , 指定单击的菜单编号，在本程序中共有5个菜单生效，编号数量可根据实际需要自定

.判断开始 (等于 (菜单编号, 1))
    打开媒体文件 (读配置项 (配置文件, “历史记录”, “1”, ), “不加入历史”)
.判断 (等于 (菜单编号, 2))
    打开媒体文件 (读配置项 (配置文件, “历史记录”, “2”, ), “不加入历史”)
.判断 (等于 (菜单编号, 3))
    打开媒体文件 (读配置项 (配置文件, “历史记录”, “3”, ), “不加入历史”)
.判断 (等于 (菜单编号, 4))
    打开媒体文件 (读配置项 (配置文件, “历史记录”, “4”, ), “不加入历史”)
.判断 (等于 (菜单编号, 5))
    打开媒体文件 (读配置项 (配置文件, “历史记录”, “5”, ), “不加入历史”)
.默认
    
.判断结束


.子程序 _清空历史记录_被选择, 空白型, , 
.局部变量 计次变量, 整数型, , , 
.局部变量 循环变量, 整数型, , , 

赋值 (计次变量, 5)
.计次循环首 (计次变量, 循环变量)
    写配置项 (配置文件, “历史记录”, 到文本 (循环变量), “”)
.计次循环尾 ()
信息框 (“恭喜,历史记录已清空！”, #信息图标, #信息标题)
初始化历史记录 ()

.子程序 打开媒体文件, 空白型, , 核心子程序，本程序内部通用！
.参数 文件地址, 文本型, 可空, 参数值如果为空，将弹出打开本地文件对话框，否则将做为网络媒体播放
.参数 加入历史, 文本型, 可空, 默认为""，即加入历史记录，值为任意文本则表示不将当前媒体加入历史记录


.如果 (等于 (文件地址, “”))
    赋值 (.过滤器, “FLV流媒体(*.flv)|*.flv|音频文件(*.mp3 *.wma)|*.mp3;*.wma|所有文件|*.*”)
    .如果 (等于 (读配置项 (配置文件, “打开对话框”, “初始目录”, ), “”))
        赋值 (.初始目录, “”)
        输出调试文本 (“打开媒体文件 子程序：配置项目_打开对话框_初始目录 值为空！”)
    .否则
        赋值 (.初始目录, 读配置项 (配置文件, “打开对话框”, “初始目录”, ))
    .如果结束
    
    .如果真 (并且 (等于 (打开 (), 真), 不等于 (.文件名, “”)))
        初始化声道与音量 ()
        修改初始目录 (.文件名)
        播放媒体文件 (.文件名, 加入历史)
    .如果真结束
    
.否则
    初始化声道与音量 ()
    .如果真 (不等于 (寻找文本 (文件地址, “:\”, 1, 假), -1)) ' 判断是否为本机或发展局域网目录
        .如果 (等于 (寻找文件 (文件地址, ), “”))
            信息框 (“对不起，您要播放的媒体文件不存在！请重新打开或指定地址！”, #信息图标, #信息标题)
        .否则
            修改初始目录 (文件地址)
            播放媒体文件 (文件地址, 加入历史)
        .如果结束
        
    .如果真结束
    .如果真 (不等于 (寻找文本 (文件地址, “://”, 1, 假), -1)) ' 判断是否为Internet或FTP目录
        播放媒体文件 (文件地址, 加入历史)
    .如果真结束
    
.如果结束


.子程序 播放媒体文件, 空白型, , 打开媒体文件的附属程序,不得接受其它任何调用！播放媒体文件，要求地址是确认无误的！
.参数 文件地址, 文本型, , 
.参数 加入历史, 文本型, 可空, 

赋值 (., 文件地址)
.如果真 (等于 (加入历史, “”))
    加入历史记录 (文件地址)
    初始化历史记录 ()
.如果真结束
赋值 (播放器媒体, 未知支持库函数_57 ())
播放器控制.未知支持库函数_130 ()

.子程序 播放器媒体取信息, 空白型, , 
.局部变量 媒体名称, 文本型, , , 
.局部变量 源连接, 文本型, , , 
.局部变量 播放位置, 整数型, , , 以秒为单位返回或设置播放的位置.双精度小数型，用取整命令取为整数
.局部变量 位置文本, 文本型, , , 
.局部变量 媒体时长, 小数型, , , 
.局部变量 项目信息_作者, 文本型, , , "Author"、#本媒体剪辑的作者
.局部变量 项目信息_位比率, 文本型, , , "Bitrate"、#位比率(秒为单位)
.局部变量 项目信息_当前位比率, 文本型, , , "CurrenBitrate"、#当前位比率(秒为单位)
.局部变量 项目信息_版权信息, 文本型, , , "Copyright"、#版权信息
.局部变量 项目信息_持续时间, 文本型, , , "Duration"、#持续时间(秒为单位)
.局部变量 项目信息_内容描述, 文本型, , , "Description"、#媒体内容的描述
.局部变量 项目信息_文件大小, 文本型, , , "FileSize"、#文件大小(Bytes为单位)
.局部变量 项目信息_文件格式, 文本型, , , "FileType"、#文件格式，例如wma,mp3
.局部变量 项目信息_原始地址, 文本型, , , "SourceURL"、#原始地址
.局部变量 项目信息_内容标题, 文本型, , , "Title"、#媒体内容的标题"

赋值 (媒体名称, 播放器媒体.)
赋值 (源连接, 播放器媒体.)
赋值 (播放位置, 播放器媒体.)
赋值 (位置文本, 播放器媒体.)
赋值 (媒体宽度, 播放器媒体.)
赋值 (媒体高度, 播放器媒体.)
赋值 (项目信息_作者, 播放器媒体.未知支持库函数_153 (“Author”))
赋值 (项目信息_位比率, 播放器媒体.未知支持库函数_153 (“Bitrate”))
赋值 (项目信息_当前位比率, 播放器媒体.未知支持库函数_153 (“CurrenBitrate”))
赋值 (项目信息_版权信息, 播放器媒体.未知支持库函数_153 (“Copyright”))
赋值 (项目信息_持续时间, 播放器媒体.未知支持库函数_153 (“Duration”))
赋值 (媒体时长, 到整数 (项目信息_持续时间)) ' 赋值给程序集变量 取出当前媒体的总长度 单位：秒
赋值 (.最大位置, 媒体时长) ' 赋值给滑块条 设置最大位置
赋值 (项目信息_内容描述, 播放器媒体.未知支持库函数_153 (“Description”))
赋值 (项目信息_文件大小, 播放器媒体.未知支持库函数_153 (“FileSize”))
赋值 (项目信息_文件格式, 播放器媒体.未知支持库函数_153 (“FileType”))
赋值 (项目信息_原始地址, 播放器媒体.未知支持库函数_153 (“SourceURL”))
赋值 (项目信息_内容标题, 播放器媒体.未知支持库函数_153 (“Title”))
 ' 输出调试文本 (“媒体名称： ” ＋ 媒体名称 ＋ #换行符 ＋ “源连接： ” ＋ 源连接 ＋ #换行符 ＋ “播放位置： ” ＋ 到文本 (播放位置) ＋ #换行符 ＋ “位置文本： ” ＋ 位置文本 ＋ #换行符 ＋ “媒体宽度： ” ＋ 到文本 (媒体宽度) ＋ #换行符 ＋ “媒体高度： ” ＋ 到文本 (媒体高度) ＋ #换行符 ＋ “项目信息_作者： ” ＋ 项目信息_作者 ＋ #换行符 ＋ “项目信息_位比率： ” ＋ 项目信息_位比率 ＋ #换行符 ＋ “项目信息_当前位比率： ” ＋ 项目信息_当前位比率 ＋ #换行符 ＋ “项目信息_版权信息： ” ＋ 项目信息_版权信息 ＋ #换行符 ＋ “项目信息_持续时间： ” ＋ 项目信息_持续时间 ＋ #换行符 ＋ “项目信息_内容描述： ” ＋ 项目信息_内容描述 ＋ #换行符 ＋ “项目信息_文件大小：  ” ＋ 到文本 (项目信息_文件大小) ＋ #换行符 ＋ “项目信息_文件格式： ” ＋ 项目信息_文件格式 ＋ #换行符 ＋ “项目信息_原始地址： ” ＋ 项目信息_原始地址 ＋ #换行符 ＋ “项目信息_内容标题： ” ＋ 项目信息_内容标题, #信息图标, #信息标题)

.子程序 修改初始目录, 空白型, , 打开媒体文件的附属程序,不得接受其它任何调用！将媒体文件的目录写入配置文件
.参数 文件地址, 文本型, , 

.局部变量 取出长度, 整数型, , , 
.局部变量 目录变量, 文本型, , , 

赋值 (取出长度, 相减 (倒找文本 (文件地址, “\”, , 假), 1))
赋值 (目录变量, 取文本左边 (文件地址, 取出长度))
写配置项 (配置文件, “打开对话框”, “初始目录”, 目录变量)

.子程序 _播放文件_被选择, 空白型, , 
打开媒体文件 (“”)

.子程序 _播放网址_被选择, 空白型, , 
赋值 (_启动窗口., 假)
载入 (打开窗口, _启动窗口, 真)
赋值 (_启动窗口., 真)

.子程序 __启动窗口_将被销毁, 空白型, , 
播放器控制.未知支持库函数_131 ()
未知支持库函数_54 ()
关闭数据库 ()
处理事件 ()

.子程序 _窗口总在最前_被选择, 空白型, , 
.判断开始 (等于 (.选中, 真))
    赋值 (_启动窗口., 假)
    赋值 (.选中, 假)
.默认
    赋值 (.选中, 真)
    赋值 (_启动窗口., 真)
    赋值 (.选中, 真)
.判断结束


.子程序 初始化窗口布局, 空白型, , 
.局部变量 用户区宽度, 整数型, , , 
.局部变量 用户区高度, 整数型, , , 
.局部变量 播放器左边, 整数型, , , 
.局部变量 播放器顶边, 整数型, , , 
.局部变量 播放器宽度, 整数型, , , 播放器宽度
.局部变量 播放器高度, 整数型, , , 播放器高度
.局部变量 分组框宽度, 整数型, , , 分组框宽度
.局部变量 分组框高度, 整数型, , , 分组框高度
.局部变量 搜索框宽度, 整数型, , , 

赋值 (用户区宽度, 取用户区宽度 ())
赋值 (用户区高度, 取用户区高度 ())
赋值 (播放器宽度, .)
赋值 (播放器高度, .)
赋值 (分组框宽度, .宽度)
赋值 (分组框高度, .高度)
赋值 (搜索框宽度, .宽度)

.如果 (等于 (显示列表, 真))
    赋值 (., 2) ' 左边距默认为2
    赋值 (., 1) ' 顶边距默认为1
    赋值 (., 相减 (用户区宽度, 搜索框宽度, ., .宽度))
    赋值 (., 相减 (用户区高度, .高度, .高度))
    
    赋值 (.左边, 相加 (., ., 1))
    赋值 (.顶边, 相减 (相除 (相减 (用户区高度, 20), 2), 相除 (.高度, 2)))
    
    赋值 (.左边, -1)
    赋值 (.顶边, 相加 (., ., .高度))
    赋值 (.宽度, 相加 (., ., 3))
    
    赋值 (.左边, 相加 (., ., .宽度))
    赋值 (.顶边, .)
    
    赋值 (.左边, .左边)
    赋值 (.顶边, 相加 (.顶边, .高度, 1))
    赋值 (.高度, 相减 (用户区高度, .顶边, .高度, 2))
    
    赋值 (.左边, .)
    赋值 (.顶边, 相加 (., .))
    赋值 (.宽度, .)
    赋值 (.左边, 相减 (相加 (., .), .宽度))
    赋值 (.顶边, .顶边)
    
    赋值 (.宽度, 相减 (.宽度, 11))
    赋值 (.左边, 相减 (.宽度, .宽度, 3))
    赋值 (.左边, 相减 (.左边, .宽度))
    赋值 (.左边, 相减 (.左边, .宽度))
    赋值 (.左边, 相减 (.左边, .宽度))
    
.否则
    赋值 (., 2) ' 左边距默认为2
    赋值 (., 1) ' 顶边距默认为1
    赋值 (., 相减 (用户区宽度, .宽度, .))
    赋值 (., 相减 (用户区高度, .高度, .高度))
    
    赋值 (.左边, 相加 (., ., .宽度))
    赋值 (.顶边, .)
    
    赋值 (.左边, .左边)
    赋值 (.顶边, 相加 (.顶边, .高度, 1))
    赋值 (.高度, 相减 (用户区高度, .顶边, .高度, 2))
    
    
    赋值 (.左边, 相加 (., ., 1))
    赋值 (.顶边, 相减 (相除 (相减 (用户区高度, 20), 2), 相除 (.高度, 2)))
    
    赋值 (.左边, -1)
    赋值 (.顶边, 相加 (., ., .高度))
    赋值 (.宽度, 相加 (., ., 3))
    
    
    赋值 (.左边, .)
    赋值 (.顶边, 相加 (., .))
    赋值 (.宽度, .)
    赋值 (.左边, 相减 (相加 (., .), .宽度))
    赋值 (.顶边, .顶边)
    
    赋值 (.宽度, 相减 (.宽度, 11))
    赋值 (.左边, 相减 (.宽度, .宽度, 3))
    赋值 (.左边, 相减 (.左边, .宽度))
    赋值 (.左边, 相减 (.左边, .宽度))
    赋值 (.左边, 相减 (.左边, .宽度))
.如果结束


.子程序 _全屏播放_被选择, 空白型, , 
赋值 (., 真)

.子程序 _搜索框_获得焦点, 空白型, , 
.如果 (等于 (.内容, “输入您要搜索的视频文件”))
    赋值 (.内容, “”)
    赋值 (.文本颜色, #黑色)
.否则
    赋值 (.文本颜色, #黑色)
.如果结束


.子程序 _搜索框_失去焦点, 空白型, , 
.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “输入您要搜索的视频文件”)))
    赋值 (.内容, “输入您要搜索的视频文件”)
.如果真结束
赋值 (.文本颜色, #浅灰)

.子程序 _搜索框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    信息框 (“开始搜索用户指定的视频文件，代码未完成！”, 0, )
.如果真结束


.子程序 _播放器_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 播放器状态, 逻辑型, , , 

赋值 (播放器状态, .)
.如果真 (等于 (播放器状态, 假))
    赋值 (., 真)
.如果真结束


.子程序 _播放器_状态被改变, 空白型, , 
.局部变量 新状态, 文本型, , , 

.判断开始 (等于 (., 0)) ' 未知状态。
    赋值 (新状态, “未知状态”)
    输出调试文本 (相加 (“状态被改变: ”, 新状态))
    处理事件 ()
.判断 (等于 (., 1)) ' 此播放暂停事件为系统自动生成，如播放结束、
    关闭实时时钟 ()
    关闭缓冲时钟 ()
    赋值 (新状态, “播放结束”)
    播放器控制.未知支持库函数_131 ()
    输出调试文本 (相加 (“状态被改变: ”, 新状态))
    处理事件 ()
.判断 (等于 (., 2)) ' 播放暂停。
    关闭实时时钟 ()
    赋值 (新状态, “播放暂停”)
    输出调试文本 (相加 (“状态被改变: ”, 新状态))
    处理事件 ()
.判断 (等于 (., 3)) ' 正在播放。
    播放器媒体取信息 ()
    .如果 (等于 (媒体时长, 0))
        赋值 (.最大位置, 10)
        赋值 (.位置, 0)
        赋值 (.禁止, 真)
    .否则
        赋值 (.禁止, 假)
    .如果结束
    赋值 (新状态, “正在播放”)
    关闭缓冲时钟 ()
    打开实时时钟 ()
    打开播放时钟 ()
    输出调试文本 (相加 (“状态被改变: ”, 新状态))
    处理事件 ()
.判断 (等于 (., 4)) ' 向前搜索流媒体数据。
    赋值 (新状态, “正在向前搜索流媒体”)
    输出调试文本 (相加 (“状态被改变: ”, 新状态))
    处理事件 ()
.判断 (等于 (., 5)) ' 向后搜索流媒体数据。
    赋值 (新状态, “正在向后搜索流媒体”)
    输出调试文本 (相加 (“状态被改变: ”, 新状态))
    处理事件 ()
.判断 (等于 (., 6)) ' 正在缓冲。
    赋值 (新状态, “正在缓冲 ”)
    输出调试文本 (相加 (“状态被改变: ”, 新状态))
    打开缓冲时钟 ()
    处理事件 ()
.判断 (等于 (., 7)) ' 等待加载流媒体。
    赋值 (新状态, “等待加载流媒体”)
    输出调试文本 (相加 (“状态被改变: ”, 新状态))
    处理事件 ()
.判断 (等于 (., 8)) ' 播放结束。
    关闭实时时钟 ()
    关闭缓冲时钟 ()
    播放器控制.未知支持库函数_131 ()
    赋值 (新状态, “播放结束”)
    输出调试文本 (相加 (“状态被改变: ”, 新状态))
    处理事件 ()
.判断 (等于 (., 9)) ' 准备加载新的媒体。
    赋值 (新状态, “准备加载新的媒体”)
    赋值 (.标题, “”)
    输出调试文本 (相加 (“状态被改变: ”, 新状态))
    处理事件 ()
.判断 (等于 (., 10)) ' 播放准备就绪。
    赋值 (新状态, “准备就绪”)
    赋值 (.最大位置, 100)
    赋值 (.位置, 0)
    输出调试文本 (相加 (“状态被改变: ”, 新状态))
    处理事件 ()
.判断 (等于 (., 11)) ' 尝试重新连接流媒体数据。
    赋值 (新状态, “正在尝试重新连接流媒体数据”)
    输出调试文本 (相加 (“状态被改变: ”, 新状态))
    处理事件 ()
.默认
    
.判断结束
赋值 (.标题, 相加 (“ ”, 新状态))
处理事件 ()

.子程序 _播放器_打开状态被改变, 空白型, , 
.参数 新的状态, 整数型, , 

.局部变量 状态文本, 文本型, , , 

.判断开始 (等于 (新的状态, 0))
    赋值 (状态文本, “不确定的状态”)
    输出调试文本 (相加 (“打开状态被改变: ”, 状态文本))
    处理事件 ()
.判断 (等于 (新的状态, 1))
    赋值 (状态文本, “新的播放列表已被加载”)
    输出调试文本 (相加 (“打开状态被改变: ”, 状态文本))
    播放器网络.未知支持库函数_247 ()
    处理事件 ()
.判断 (等于 (新的状态, 2))
    赋值 (状态文本, “正在定位播放列表”)
    输出调试文本 (相加 (“打开状态被改变: ”, 状态文本))
    处理事件 ()
.判断 (等于 (新的状态, 3))
    赋值 (状态文本, “正在连接服务器上的播放列表”)
    输出调试文本 (相加 (“打开状态被改变: ”, 状态文本))
    处理事件 ()
.判断 (等于 (新的状态, 4))
    赋值 (状态文本, “正在加载播放列表”)
    输出调试文本 (相加 (“打开状态被改变: ”, 状态文本))
    处理事件 ()
.判断 (等于 (新的状态, 5))
    赋值 (状态文本, “正在打开播放列表”)
    输出调试文本 (相加 (“打开状态被改变: ”, 状态文本))
    处理事件 ()
.判断 (等于 (新的状态, 6))
    赋值 (状态文本, “播放列表处于打开状态”)
    输出调试文本 (相加 (“打开状态被改变: ”, 状态文本))
    处理事件 ()
.判断 (等于 (新的状态, 7))
    赋值 (状态文本, “播放列表被改变”)
    输出调试文本 (相加 (“打开状态被改变: ”, 状态文本))
    处理事件 ()
.判断 (等于 (新的状态, 8))
    赋值 (状态文本, “新的媒体文件已被加载”)
    输出调试文本 (相加 (“打开状态被改变: ”, 状态文本))
    处理事件 ()
.判断 (等于 (新的状态, 9))
    赋值 (状态文本, “正在定位媒体文件”)
    输出调试文本 (相加 (“打开状态被改变: ”, 状态文本))
    处理事件 ()
.判断 (等于 (新的状态, 10))
    赋值 (状态文本, “正在连接服务器上的媒体文件”)
    输出调试文本 (相加 (“打开状态被改变: ”, 状态文本))
    处理事件 ()
.判断 (等于 (新的状态, 11))
    赋值 (状态文本, “正在加载媒体”)
    输出调试文本 (相加 (“打开状态被改变: ”, 状态文本))
    处理事件 ()
.判断 (等于 (新的状态, 12))
    赋值 (状态文本, “正在打开媒体文件”)
    输出调试文本 (相加 (“打开状态被改变: ”, 状态文本))
    处理事件 ()
.判断 (等于 (新的状态, 13))
    赋值 (状态文本, “媒体已被打开”)
    输出调试文本 (相加 (“打开状态被改变: ”, 状态文本))
    处理事件 ()
.判断 (等于 (新的状态, 14))
    赋值 (状态文本, “开始获取编码器”)
    输出调试文本 (相加 (“打开状态被改变: ”, 状态文本))
    处理事件 ()
.判断 (等于 (新的状态, 15))
    赋值 (状态文本, “结束编码器获取”)
    输出调试文本 (相加 (“打开状态被改变: ”, 状态文本))
    处理事件 ()
.判断 (等于 (新的状态, 16))
    赋值 (状态文本, “开始许可证获取”)
    输出调试文本 (相加 (“打开状态被改变: ”, 状态文本))
    处理事件 ()
.判断 (等于 (新的状态, 17))
    赋值 (状态文本, “结束许可证获取”)
    输出调试文本 (相加 (“打开状态被改变: ”, 状态文本))
    处理事件 ()
.判断 (等于 (新的状态, 18))
    赋值 (状态文本, “开始个性化设置”)
    输出调试文本 (相加 (“打开状态被改变: ”, 状态文本))
    处理事件 ()
.判断 (等于 (新的状态, 19))
    赋值 (状态文本, “结束个性化设置”)
    输出调试文本 (相加 (“打开状态被改变: ”, 状态文本))
    处理事件 ()
.判断 (等于 (新的状态, 20))
    赋值 (状态文本, “正在等待媒体文件”)
    输出调试文本 (相加 (“打开状态被改变: ”, 状态文本))
    处理事件 ()
.判断 (等于 (新的状态, 21))
    赋值 (状态文本, “正在打开一个未知类型的URL”)
    输出调试文本 (相加 (“打开状态被改变: ”, 状态文本))
    处理事件 ()
.默认
    
.判断结束
赋值 (.标题, 相加 (“ ”, 状态文本))
处理事件 ()

.子程序 _按钮_播放_被单击, 空白型, , 
赋值 (播放器媒体, 未知支持库函数_57 ())
播放器控制.未知支持库函数_130 ()

.子程序 _按钮_暂停_被单击, 空白型, , 
播放器控制.未知支持库函数_132 ()
关闭实时时钟 ()

.子程序 _按钮_停止_被单击, 空白型, , 
关闭实时时钟 ()
播放器控制.未知支持库函数_131 ()
处理事件 ()

.子程序 _按钮_打开_被单击, 空白型, , 
打开媒体文件 (“”)

.子程序 _滑块条_音量_位置被改变, 空白型, , 
赋值 (播放器设定., 相乘 (.位置, 10))

.子程序 _滑块条_声道_位置被改变, 空白型, , 
.局部变量 现位置, 整数型, , , 

赋值 (现位置, .位置)
.判断开始 (小于 (现位置, 10))
    赋值 (播放器设定., 相乘 (相减 (10, 现位置), -10))
.判断 (大于 (现位置, 10))
    赋值 (播放器设定., 相乘 (相减 (现位置, 10), 10))
.判断 (等于 (现位置, 10))
    赋值 (播放器设定., 0)
.默认
    
.判断结束


.子程序 _进度滑块条_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 新位置, 整数型, , , 
.局部变量 中间值, 整数型, , , 

赋值 (新位置, .位置)
赋值 (播放器控制., 新位置)
播放器控制.未知支持库函数_130 ()

.子程序 _影片列表_被选择, 空白型, , 
_分隔条_被单击 ()

.子程序 计算视频比例, 空白型, , 无用的代码
.局部变量 公约数, 整数型, , , 

赋值 (公约数, 取最大公约数 (媒体宽度, 媒体高度))
信息框 (相加 (到文本 (相除 (媒体宽度, 公约数)), “：”, 到文本 (相除 (媒体高度, 公约数))), 0, )

.子程序 取最大公约数, 整数型, , 无用的代码
.参数 数一, 整数型, , 
.参数 数二, 整数型, , 

.局部变量 操作数甲, 整数型, , , 
.局部变量 操作数乙, 整数型, , , 
.局部变量 中间数, 整数型, , , 

赋值 (操作数甲, 数一) ' 第一个数
赋值 (操作数乙, 数二) ' 第二个数
 ' 逐次用后一个数去除前一个余数，直到余数是0为止
.判断循环首 (不等于 (操作数乙, 0))
     ' 得到中间数
     ' 用小的一个数除大的一个数，得一个余数
    赋值 (中间数, 求余数 (操作数甲, 操作数乙))
     ' 操作数一操作数二 换位
    赋值 (操作数甲, 操作数乙)
    赋值 (操作数乙, 中间数)
.判断循环尾 ()
 ' 返回得到的结果：操作数甲
返回 (操作数甲)

.子程序 _分隔条_被单击, 空白型, , 
.如果 (小于 (.左边, 取用户区宽度 ()))
    赋值 (显示列表, 假)
    赋值 (.选中, 假)
.否则
    赋值 (显示列表, 真)
    赋值 (.选中, 真)
.如果结束
初始化窗口布局 ()

.子程序 __启动窗口_尺寸被改变, 空白型, , 
初始化窗口布局 ()

.子程序 _缓冲时钟_周期事件, 空白型, , 在这里初始化播放器网络，播放器网络这个对象只能在子程序中初始化，一旦子程序销毁或结束这个对象即被清空
.局部变量 缓冲进度, 整数型, , , 
.局部变量 下载进度, 整数型, , , 
.局部变量 状态文本, 文本型, , , 

赋值 (播放器网络, 未知支持库函数_61 ())
赋值 (缓冲进度, 播放器网络.)
赋值 (下载进度, 播放器网络.)
赋值 (状态文本, 相加 (“正在缓冲 ”, 到文本 (缓冲进度), “%  已下载 ”, 到文本 (下载进度), “%”))
赋值 (.标题, 相加 (“ ”, 状态文本))

.子程序 打开缓冲时钟, 空白型, , 
赋值 (.时钟周期, 600)

.子程序 关闭缓冲时钟, 空白型, , 
赋值 (.时钟周期, 0)

.子程序 _播放时钟_周期事件, 空白型, , 
关闭播放时钟 ()
赋值 (.标题, “”)

.子程序 打开播放时钟, 空白型, , 
赋值 (.时钟周期, 5000)

.子程序 关闭播放时钟, 空白型, , 
赋值 (.时钟周期, 0)

.子程序 _实时时钟_周期事件, 空白型, , 更新播放进度条位置
.局部变量 位置文本, 文本型, , , 

赋值 (位置文本, 播放器控制.)
赋值 (.标题, 位置文本)
处理事件 ()
.如果真 (大于 (媒体时长, 0))
    赋值 (当前位置, 取整 (播放器控制.)) ' 程序集变量 取出当前媒体的播放进度 单位：秒
    赋值 (.位置, 当前位置)
.如果真结束


.子程序 打开实时时钟, 空白型, , 
赋值 (.时钟周期, 1000)

.子程序 关闭实时时钟, 空白型, , 
赋值 (.时钟周期, 0)

.窗口程序集 打开媒体程序集, , , 

.子程序 _按钮_取消_被单击, 空白型, , 
销毁 ()

.子程序 _按钮_确定_被单击, 空白型, , 
_启动窗口.打开媒体文件 (.内容, )
销毁 ()

.子程序 _地址编辑框_内容被改变, 空白型, , 
赋值 (.禁止, 假)

.子程序 _按钮_浏览_被单击, 空白型, , 
_启动窗口.打开媒体文件 ()
销毁 ()


 ' 不属于任何一个程序集、类模块的函数：
