 ' 文件类型：Windows模块源码

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 448
    高度 = 427
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假



.常量 字节_型, "1", 公开, 
.常量 逻辑_型, "2", , 
.常量 整数_型, "3", , 
.常量 双精度小数_型, "4", , 
.常量 日期时间_型, "5", , 
.常量 文本_型, "6", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 2 0 数据操作支持库一
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' iext5 {E5000198-4471-40e2-92BC-D0BA075BDBB2} 2 0 扩展界面支持库五




数据类型 库字段, , 
    .成员 库别名, 文本型, , , 
    .成员 文件号, 整数型, , , 
    .成员 字段信息, 字_段, , "1", 
    .成员 首位置, 整数型, , , 
    .成员 现行位置, 整数型, , , 
    .成员 长度, 整数型, , , 
    .成员 现行记录, 整数型, , , 
    .成员 记录数, 整数型, , , 

数据类型 字_段, , 
    .成员 字段名, 文本型, , , 
    .成员 类型, 整数型, , , 1、#字节_型； 2、#逻辑_型； 3、#整数_型； 4、#双精度小数_型； 5、#日期时间型； 6、#文本_型；
    .成员 长度, 整数型, , , 


.程序集 程序集1, , , 

.程序集变量 清风库, 清风库, , , 
.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码
载入 (窗口1, , 真)
_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--


.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。

.类模块 清风库, , , 

.程序集变量 库_别名, 库字段, , "0", 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用
全部_关闭 ()

.子程序 创建_库, 逻辑型, 公开, 创建指定的数据库文件，如果该数据库文件存在，将被覆盖。成功返回真，失败返回假。本命令为初级命令。
.参数 库名, 文本型, , 全路径文件名 或 只提供库名 库后续名(.Qdb)
.参数 密码, 文本型, 可空, 库密码
.参数 字段文本, 文本型, , 顺序指定本数据库中所有字段的信息。字段名不能包含空文本 1、#字节型； 2、#逻辑型； 3、#整数型； 4、#双精度小数型； 5、#日期时间型； 6、#文本型； 如"字节型,1|逻辑型,2|整数型,3,5|双精度小数型,4,6|日期时间型,5|文本型,6,1024"

.局部变量 共享方式, 整数型, , , 可以被省略。参数值指定在多用户环境中限制其它用户操作此数据库的方式。如果省略本参数，默认为“#无限制”。方式值可以为以下常量之一：1、#无限制：允许其它用户任意操作此数据库；2、#禁止读：禁止其它用户读此数据库；3、#禁止写：禁止其它用户写此数据库；4、#禁止读写：独占使用此数据库，禁止其它用户的任何操作。
.局部变量 文件_号, 整数型, , , 
.局部变量 字段信息, 字_段, 静态, "0", 
.局部变量 文本, 文本型, , "0", 
.局部变量 文本1, 文本型, , , 
.局部变量 a, 整数型, , , 

分割字段 (字段信息, 字段文本)
赋值 (文本, 分割文本 (库名, “\”, ))
.如果真 (不等于 (到小写 (取文本右边 (文本 [取数组下标 (文本, )], 4)), 到小写 (“.Qdb”)))
    赋值 (库名, 相加 (库名, “.Qdb”))
.如果真结束
.如果真 (等于 (取数组下标 (文本, ), 1))
    赋值 (库名, 相加 (取当前目录 (), “\”, 库名))
.如果真结束
赋值 (文件_号, 打开文件 (库名, #重写, #禁止读写))
.如果真 (大于 (文件_号, 0))
    .计次循环首 (取数组下标 (字段信息, ), a)
        .如果 (并且 (大于 (字段信息 [a], 类型, 0), 小于 (字段信息 [a], 类型, 7)))
            赋值 (文本1, 相加 (文本1, 到文本 (字段信息 [a], 类型), “:”, 到文本 (字段信息 [a], 长度), “:”, 子文本替换 (字段信息 [a], 字段名, “:”, “”, , , 真), 字符 (9)))
        .否则
            返回 (假)
        .如果结束
        ' 本源码来自易语言资源网(www.5A5X.com)
    .计次循环尾 ()
    .如果真 (不等于 (密码, “”))
        赋值 (文本1, 到文本 (未知支持库函数_3 (到字节集 (文本1), 密码, )))
    .如果真结束
    .如果真 (写文本行 (文件_号, 文本1))
        关闭文件 (文件_号)
        返回 (真)
    .如果真结束
    
.如果真结束

关闭文件 (文件_号)
返回 (假)

.子程序 打开_库, 逻辑型, 公开, 打开指定的数据库文件。成功返回真，失败返回假。本命令为初级命令
.参数 库文件名, 文本型, , 全路径文件名 或 只提供库名 库后续名(.Qdb)
.参数 密码, 文本型, 可空, 与打开库加密的密码
.参数 别名, 文本型, 可空, 别名为在后面的程序中引用本数据库时可使用的另一个名称。欲引用一个已经被打开的数据库可以使用该数据库本身的名称（数据库名称为数据库文件名的无路径和后缀部分。譬如 c:\my documents\清风库.Qdb ，其数据库名称为 清风库 ），也可以使用在此处所指定的别名。别名主要用作避开重复的数据库名称或者简化对长数据库名的引用。数据库名称与别名皆不区分大小写，在查找数据库时，系统将优先查找别名。如果本参数被省略，默认为库文件名。
.参数 共享方式, 整数型, 可空, 参数值指定在多用户环境中限制其它用户操作此数据库的方式。如果省略本参数，默认为“#无限制”。方式值可以为以下常量之一：1、#无限制：允许其它用户任意操作此数据库；2、#禁止读：禁止其它用户读此数据库；3、#禁止写：禁止其它用户写此数据库；4、#禁止读写：独占使用此数据库，禁止其它用户的任何操作。

.局部变量 文件号, 整数型, , , 
.局部变量 文本, 文本型, , , 
.局部变量 文本1, 文本型, , "0", 
.局部变量 a, 整数型, , , 
.局部变量 文本2, 文本型, , "0", 
.局部变量 临时, 库字段, , , 
.局部变量 临时_别名, 文本型, , , 
.局部变量 字段, 字_段, , , 

.如果真 (等于 (别名, “”))
     ' 库文件名 ＝ 到小写 (库文件名)
    赋值 (文本1, 分割文本 (库文件名, “\”, ))
    赋值 (别名, 取文本左边 (文本1 [取数组下标 (文本1, )], 相减 (取文本长度 (文本1 [取数组下标 (文本1, )]), 4)))
.如果真结束
.如果真 (或者 (等于 (共享方式, 0), 大于 (共享方式, 4)))
    赋值 (共享方式, 1)
.如果真结束
赋值 (文件号, 打开文件 (库文件名, #读写, 共享方式))
.如果真 (大于 (文件号, 0))
    .如果真 (移到文件首 (文件号))
        .如果 (不等于 (密码, “”))
            赋值 (文本, 到文本 (未知支持库函数_4 (到字节集 (读入一行 (文件号)), 密码, )))
        .否则
            赋值 (文本, 读入一行 (文件号))
        .如果结束
         ' 本源码来自易语言资源网(www.5A5X.com)
        .如果真 (不等于 (文本, “”))
            赋值 (文本1, 分割文本 (文本, 字符 (9), ))
        .如果真结束
         ' 输出调试文本 (取数组下标 (文本1, ), 文本)
        赋值 (临时.库别名, 别名)
        赋值 (临时.文件号, 文件号)
        赋值 (临时.首位置, 取读写位置 (文件号))
        赋值 (临时.现行位置, 取读写位置 (文件号))
        清除数组 (临时.字段信息)
        .计次循环首 (取数组下标 (文本1, ), a)
            赋值 (文本2, 分割文本 (文本1 [a], “:”, ))
            .如果 (等于 (取数组下标 (文本2, ), 3))
                .如果 (并且 (大于 (到数值 (文本2 [1]), 0), 小于 (到数值 (文本2 [1]), 7)))
                    赋值 (字段.类型, 到数值 (文本2 [1]))
                    .如果 (等于 (到整数 (文本2 [1]), 1))
                        赋值 (字段.长度, 4)
                    .否则
                        .如果 (等于 (到整数 (文本2 [1]), 2))
                            赋值 (字段.长度, 2)
                        .否则
                            .如果 (等于 (到整数 (文本2 [1]), 3))
                                赋值 (字段.长度, 17)
                            .否则
                                .如果 (等于 (到整数 (文本2 [1]), 4))
                                    赋值 (字段.长度, 17)
                                .否则
                                    .如果 (等于 (到整数 (文本2 [1]), 5))
                                        赋值 (字段.长度, 24)
                                    .否则
                                        .如果 (等于 (到整数 (文本2 [1]), 6))
                                            .如果 (大于 (到整数 (文本2 [2]), 0))
                                                赋值 (字段.长度, 到整数 (文本2 [2]))
                                            .否则
                                                关闭文件 (文件号)
                                                返回 (假)
                                            .如果结束
                                            
                                        .否则
                                            关闭文件 (文件号)
                                            返回 (假)
                                        .如果结束
                                        ' 本源码来自易语言资源网(www.5A5X.com)
                                    .如果结束
                                    
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    赋值 (字段.字段名, 子文本替换 (文本2 [3], 取空白文本 (1), “”, , , 真))
                    加入成员 (临时.字段信息, 字段)
                .否则
                    关闭文件 (文件号)
                    返回 (假)
                .如果结束
                
            .否则
                关闭文件 (文件号)
                返回 (假)
            .如果结束
            
        .计次循环尾 ()
        赋值 (临时.长度, 取所有字段长度 (临时.字段信息))
        赋值 (临时.现行记录, 1)
        加入成员 (库_别名, 临时)
        到_首记录 (临时.库别名)
        返回 (真)
    .如果真结束
    
.如果真结束
关闭文件 (文件号)
返回 (假)

.子程序 加_记录, 逻辑型, 公开, 本命令在当前数据库的尾部添加一条记录，并将当前记录指针移动到该记录处。成功返回真，失败返回假。本命令为初级命令。
.参数 别名, 文本型, 可空, 参数值指定一个已经被打开的数据库，该数据库内包含所欲写入的字段。如为空 将已最后打开的库读取
.参数 欲写入数据, 文本型, 可空 数组, 本参数数据的类型必须为文本型数组 数组索引对应字段位置 数据类型不一致可互相转换。如果本参数被省略，则初始化对应字段中的内容，具体为：数值字段被初始化为零，逻辑字段被初始化为假，日期字段被初始化为 1899 年 12 月 30 日，文本及备注字段被初始化为空文本（“”）

.局部变量 a, 整数型, , , 
.局部变量 c, 整数型, , , 
.局部变量 文本, 文本型, , , 

.如果真 (大于 (取数组下标 (欲写入数据, ), 0))
    赋值 (a, 取数组索引 (别名))
    .如果真 (大于 (a, 0))
        .计次循环首 (取数组下标 (库_别名 [a], 字段信息, ), c)
            .如果 (大于或等于 (取数组下标 (欲写入数据, ), c))
                .如果真 (等于 (c, 1))
                    赋值 (文本, 处理字段数据 (库_别名 [a], 字段信息 [c], 欲写入数据 [c]))
                    输出调试文本 (欲写入数据 [c])
                    到循环尾 ()
                .如果真结束
                赋值 (文本, 相加 (文本, 字符 (8), 处理字段数据 (库_别名 [a], 字段信息 [c], 欲写入数据 [c])))
                输出调试文本 (欲写入数据 [c])
            .否则
                .如果真 (等于 (c, 1))
                    赋值 (文本, 处理字段数据 (库_别名 [a], 字段信息 [c], “ ”))
                    到循环尾 ()
                .如果真结束
                赋值 (文本, 相加 (文本, 字符 (8), 处理字段数据 (库_别名 [a], 字段信息 [c], “ ”)))
                输出调试文本 (欲写入数据 [c])
            .如果结束
             ' 本源码来自易语言资源网(www.5A5X.com)
        .计次循环尾 ()
        .如果真 (移到文件尾 (库_别名 [a], 文件号))
            输出调试文本 (文本)
            .如果真 (写文本行 (库_别名 [a], 文件号, 文本))
                到_尾记录 (库_别名 [a], 库别名)
                返回 (真)
            .如果真结束
            
        .如果真结束
        
    .如果真结束
     ' 本源码来自易语言资源网(www.5A5X.com)
.如果真结束
返回 (假)

.子程序 到_首记录, 逻辑型, 公开, 将当前数据库中当前记录指针移动到数据库的第一条记录上。本命令为初级命令。
.参数 别名, 文本型, 可空, 参数值指定一个已经被打开的数据库，该数据库内包含所欲写入的字段。如为空 将已最后打开的库读取

.局部变量 a, 整数型, , , 
.局部变量 文本, 文本型, , , 

赋值 (a, 取数组索引 (别名))
.如果真 (大于 (a, 0))
    返回 (移动读写_位置 (库_别名 [a], 文件号, #文件首, 1, 库_别名 [a], 首位置, 库_别名 [a], 长度, 库_别名 [a], 现行位置))
.如果真结束
返回 (假)
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 到_尾记录, 逻辑型, 公开, 将数据库中当前记录指针移动到数据库的最后一条记录上。成功返回真，失败返回假。本命令为初级命令。
.参数 别名, 文本型, 可空, 参数值指定一个已经被打开的数据库，该数据库内包含所欲写入的字段。如为空 将已最后打开的库读取

.局部变量 a, 整数型, , , 
.局部变量 长度, 整数型, , , 

赋值 (a, 取数组索引 (别名))
.如果真 (大于 (a, 0))
    返回 (移动读写_位置 (库_别名 [a], 文件号, #文件尾, -1, 库_别名 [a], 首位置, 库_别名 [a], 长度, 库_别名 [a], 现行位置))
.如果真结束
返回 (假)

.子程序 删除_记录, 逻辑型, 公开, 删除数据库中的当前记录或者指定索引的记录，当前记录指针位置保持不变。成功返回真，失败返回假。本命令为初级命令。
.参数 别名, 文本型, 可空, 参数值指定一个已经被打开的数据库，该数据库内包含所欲写入的字段。如为空 将已最后打开的库读取
.参数 索引, 整数型, 可空, 返回指定记录处指定字段的数据 如果空 返回当前记录处指定字段的数据内容

.局部变量 a, 整数型, , , 

赋值 (a, 取数组索引 (别名))
.如果真 (大于 (a, 0))
    .如果真 (大于 (索引, 0))
        .如果真 (等于 (移动读写_位置 (库_别名 [a], 文件号, #文件首, 索引, 库_别名 [a], 首位置, 库_别名 [a], 长度, 库_别名 [a], 现行位置), 假))
            返回 (假)
        .如果真结束
        ' 本源码来自易语言资源网(www.5A5X.com)
    .如果真结束
    .如果真 (删除数据 (库_别名 [a], 文件号, 库_别名 [a], 长度))
        移动读写_位置 (库_别名 [a], 文件号, #文件首, 索引, 库_别名 [a], 首位置, 库_别名 [a], 长度, 库_别名 [a], 现行位置)
        返回 (真)
    .如果真结束
    
.如果真结束
返回 (假)

.子程序 关闭_库, 空白型, 公开, 本命令关闭已经被打开的指定数据库。如果没有提供数据库名称，默认为关闭第一个打开的数据库。
.参数 库别名, 文本型, , 参数值指定一个已经被打开的数据库。如为空 将已最后打开的库读取

.局部变量 a, 整数型, , , 

赋值 (a, 取数组索引 (库别名))
.如果真 (大于 (a, 0))
    关闭文件 (库_别名 [a], 文件号)
    删除成员 (库_别名, a, 1)
    数组排序 (库_别名, )
.如果真结束
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 全部_关闭, 空白型, 公开, 本命令关闭当前已经被打开的所有数据库。本命令为初级命令。
.判断循环首 (大于 (取数组下标 (库_别名, ), 0))
    关闭文件 (库_别名 [1].文件号)
    删除成员 (库_别名, 1, 1)
    数组排序 (库_别名, )
     ' 本源码来自易语言资源网(www.5A5X.com)
.判断循环尾 ()

.子程序 取_字段名, 文本型, 公开, 返回当前数据库中指定字段的名称。如果指定字段不存在，将返回空文本。本命令为初级命令。
.参数 别名, 文本型, 可空, 参数值指定一个已经被打开的数据库，该数据库内包含所欲写入的字段。如为空 将已最后打开的库读取
.参数 字段位置, 整数型, 可空, 参数值可以为一个字段名位置数值 字段位置数值从 1 开始 如为空 将读取第一个字段的字段名

.局部变量 a, 整数型, , , 

.如果真 (小于或等于 (字段位置, 0))
    赋值 (字段位置, 1)
.如果真结束
赋值 (a, 取数组索引 (别名))
.如果真 (大于 (a, 0))
    .如果真 (大于或等于 (取数组下标 (库_别名 [a], 字段信息, ), 字段位置))
        返回 (库_别名 [a], 字段信息 [字段位置], 字段名)
    .如果真结束
    ' 本源码来自易语言资源网(www.5A5X.com)
.如果真结束
返回 (“”)

.子程序 取_字段位置, 整数型, 公开, 返回数据库中指定字段名的位置。如果指定字段名不存在，将返回 0 数值。本命令为初级命令。
.参数 别名, 文本型, 可空, 参数值指定一个已经被打开的数据库，该数据库内包含所欲写入的字段。如为空 将已最后打开的库读取
.参数 字段名, 文本型, 可空, 参数值可以为一个字段名位   如为空 返回字段最后位置

.局部变量 a, 整数型, , , 
.局部变量 c, 整数型, , , 

.如果 (不等于 (别名, “”))
    .计次循环首 (取数组下标 (库_别名, ), a)
        .如果真 (等于 (库_别名 [a], 库别名, 别名))
            .如果 (不等于 (字段名, “”))
                .计次循环首 (取数组下标 (库_别名 [a], 字段信息, ), c)
                    .如果真 (等于 (库_别名 [a], 字段信息 [c], 字段名, 字段名))
                        返回 (c)
                    .如果真结束
                    
                .计次循环尾 ()
            .否则
                返回 (取数组下标 (库_别名 [a], 字段信息, ))
            .如果结束
            跳出循环 ()
        .如果真结束
        ' 本源码来自易语言资源网(www.5A5X.com)
    .计次循环尾 ()
.否则
    
.如果结束
返回 (0)

.子程序 取_字段类型, 整数型, 公开, 返回当前数据库中指定字段的类型，字段类型值为以下常量值之一：1、#字节型； 2、#逻辑型； 3、#整数型； 4、#双精度小数型； 5、#日期时间型； 6、#文本型； 如果指定字段不存在，将返回 0 。本命令为初级命令。
.参数 别名, 文本型, 可空, 参数值指定一个已经被打开的数据库，该数据库内包含所欲写入的字段。如为空 将已最后打开的库读取
.参数 字段位置, 整数型, 可空, 参数值为一个字段位置数值 字段位置数值从 1 开始 如为空 将使用字段名
.参数 字段名, 文本型, 可空, 参数为一个字段名 如省略:将使用字段位置

.局部变量 a, 整数型, , , 
.局部变量 c, 整数型, , , 

.如果真 (小于或等于 (字段位置, 0))
    赋值 (字段位置, 1)
.如果真结束
赋值 (a, 取数组索引 (别名))
.如果真 (大于 (a, 0))
    .如果 (大于 (字段位置, 0))
        .如果真 (大于或等于 (取数组下标 (库_别名 [a], 字段信息, ), 字段位置))
            返回 (库_别名 [a], 字段信息 [字段位置], 类型)
        .如果真结束
        
    .否则
        .如果真 (不等于 (字段名, “”))
            .计次循环首 (取数组下标 (库_别名 [a], 字段信息, ), c)
                .如果真 (等于 (库_别名 [a], 字段信息 [c], 字段名, 字段名))
                    返回 (库_别名 [a], 字段信息 [c], 类型)
                .如果真结束
                
            .计次循环尾 ()
        .如果真结束
        
    .如果结束
    ' 本源码来自易语言资源网(www.5A5X.com)
.如果真结束
返回 (0)



.子程序 取_字段数, 整数型, 公开, 返回数据库中字段的数目。本命令为初级命令。
.参数 别名, 文本型, 可空, 参数值指定一个已经被打开的数据库，该数据库内包含所欲写入的字段。如为空 将已最后打开的库读取

.局部变量 a, 整数型, , , 

赋值 (a, 取数组索引 (别名))
.如果真 (大于 (a, 0))
    返回 (取数组下标 (库_别名 [a], 字段信息, ))
.如果真结束
返回 (0)
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 取_记录数, 整数型, 公开, 返回数据库的记录数目。如果没有设置当前数据库或者失败，将返回 0 。本命令为初级命令。
.参数 别名, 文本型, 可空, 参数值指定一个已经被打开的数据库，该数据库内包含所欲写入的字段。如为空 将已最后打开的库读取

.局部变量 a, 整数型, , , 
.局部变量 数值, 整数型, , , 
.局部变量 位_置, 整数型, , "2", 

赋值 (a, 取数组索引 (别名))
.如果真 (大于 (a, 0))
    返回 (取_记录_数 (库_别名 [a], 文件号, 库_别名 [a], 长度, 库_别名 [a], 首位置))
.如果真结束
返回 (0)
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 取_记录索引, 整数型, 公开, 成功返回记录索引 失败返回0
.参数 别名, 文本型, 可空, 参数值指定一个已经被打开的数据库，该数据库内包含所欲写入的字段。如为空 将已最后打开的库读取

.局部变量 a, 整数型, , , 
.局部变量 索引, 整数型, , , 

赋值 (a, 取数组索引 (别名))
.如果真 (大于 (a, 0))
    赋值 (索引, 取整 (相加 (相除 (相减 (库_别名 [a], 现行位置, 库_别名 [a], 首位置), 取所有字段长度 (库_别名 [a], 字段信息)), 1)))
    .如果真 (等于 (索引, 1))
        .如果真 (等于 (取_记录_数 (库_别名 [a], 文件号, 库_别名 [a], 长度, 库_别名 [a], 首位置), 0))
            赋值 (索引, 0)
        .如果真结束
         ' 本源码来自易语言资源网(www.5A5X.com)
    .如果真结束
    
.如果真结束
返回 (索引)

.子程序 跳到指定记录, 逻辑型, 公开, 将数据库中当前记录指针向前或者向后移动数条记录。成功返回真，失败返回假。本命令为初级命令。
.参数 别名, 文本型, 可空, 参数值指定一个已经被打开的数据库，该数据库内包含所欲写入的字段。如为空 将已最后打开的库读取
.参数 欲跳到的记录号, 整数型, 可空, 参数值所指定的记录号从 1 开始，即首记录的记录号为 1 ，依此类推。

.局部变量 a, 整数型, , , 

.如果真 (小于或等于 (欲跳到的记录号, 0))
    赋值 (欲跳到的记录号, 1)
.如果真结束
赋值 (a, 取数组索引 (别名))
.如果真 (大于 (a, 0))
     ' .如果真 (移动读写_位置 (库_别名 [a], 文件号, #文件首, 欲跳到的记录号, 库_别名 [a], 首位置, 库_别名 [a], 长度, 库_别名 [a], 现行位置))
        .如果真 (等于 (取_记录索引 (别名), 欲跳到的记录号))
            返回 (真)
        .如果真结束
         ' 本源码来自易语言资源网(www.5A5X.com)
    .如果真结束
    
.如果真结束
返回 (假)

.子程序 跳过记录, 逻辑型, 公开, 改变数据库中的当前记录指针到指定的记录号。成功返回真，失败返回假。本命令为初级命令。
.参数 别名, 文本型, 可空, 参数值指定一个已经被打开的数据库，该数据库内包含所欲写入的字段。如为空 将已最后打开的库读取
.参数 欲跳过的记录数, 整数型, 可空, 可以被省略。参数值如果为负数，则向前移动，否则向后移动。如果本参数被省略，默认值为 1 ，即向后移动一条记录。

.局部变量 a, 整数型, , , 

赋值 (a, 取数组索引 (别名))
.如果真 (大于 (a, 0))
    .如果真 (移动读写_位置 (库_别名 [a], 文件号, #现行位置, 相加 (取_记录索引 (别名), 欲跳过的记录数), 库_别名 [a], 首位置, 库_别名 [a], 长度, 库_别名 [a], 现行位置))
        返回 (真)
    .如果真结束
    ' 本源码来自易语言资源网(www.5A5X.com)
.如果真结束
返回 (假)

.子程序 读字节型, 逻辑型, 公开, 返回指定数据库中当前记录处指定字段的数据内容，所返回数据的类型等同于字段的类型。如果指定字段不存在，将产生运行时错误。
.参数 别名, 文本型, 可空, 参数值指定一个已经被打开的数据库，该数据库内包含所欲写入的字段。如为空 将已最后打开的库读取
.参数 索引, 整数型, 可空, 返回指定记录处指定字段的数据 如果空 返回当前记录处指定字段的数据内容
.参数 字段位置, 整数型, 可空, 参数值可以为一个字段名位置数值 字段位置数值从 1 开始   如果空 将用字段名读写
.参数 字段名, 文本型, 可空, 参数值可以为一个字段名称文本 如果空 将用字段位置读写
.参数 存放数据的变量, 字节型, 参考 可空, 当前记录处指定字段的数据内容，所返回数据的类型等同于字段的类型。如果指定字段不存在，将产生运行时错误。

.局部变量 文本1, 文本型, , "0", 
.局部变量 c, 整数型, , , 
.局部变量 a, 整数型, , , 
.局部变量 文本, 文本型, , , 

赋值 (存放数据的变量, 0)
赋值 (a, 取数组索引 (别名))
.如果真 (大于 (a, 0))
    赋值 (文本, 读指定记录数据 (别名, 索引))
    .如果真 (不等于 (文本, “”))
        赋值 (文本1, 分割文本 (文本, 字符 (8), ))
        .计次循环首 (取数组下标 (库_别名 [a], 字段信息, ), c)
            .如果 (大于 (字段位置, 0))
                .如果真 (等于 (c, 字段位置))
                    .如果 (大于或等于 (取数组下标 (文本1, ), c))
                        赋值 (文本1 [c], 子文本替换 (文本1 [c], #换行符, “”, , , 真))
                        .如果真 (并且 (等于 (取文本长度 (文本1 [c]), 库_别名 [a], 字段信息 [c], 长度), 等于 (库_别名 [a], 字段信息 [c], 类型, #字节_型)))
                            赋值 (存放数据的变量, 到字节 (删尾空 (文本1 [c])))
                            返回 (真)
                        .如果真结束
                        
                    .否则
                        ' 本源码来自易语言资源网(www.5A5X.com)
                    .如果结束
                    跳出循环 ()
                .如果真结束
                
            .否则
                .如果 (不等于 (字段名, “”))
                    .如果真 (等于 (库_别名 [a], 字段信息 [c], 字段名, 字段名))
                        .如果真 (大于或等于 (取数组下标 (文本1, ), c))
                            .如果真 (并且 (等于 (取文本长度 (文本1 [c]), 库_别名 [a], 字段信息 [c], 长度), 等于 (库_别名 [a], 字段信息 [c], 类型, #文本_型)))
                                赋值 (存放数据的变量, 到字节 (删尾空 (文本1 [c])))
                                返回 (真)
                            .如果真结束
                            
                        .如果真结束
                        跳出循环 ()
                    .如果真结束
                    
                .否则
                    跳出循环 ()
                .如果结束
                 ' 本源码来自易语言资源网(www.5A5X.com)
            .如果结束
            
        .计次循环尾 ()
    .如果真结束
    
.如果真结束
返回 (假)

.子程序 读逻辑型, 逻辑型, 公开, 将数据写入到指定数据库中当前记录处的指定字段内。成功返回真，失败返回假。
.参数 别名, 文本型, 可空, 参数值指定一个已经被打开的数据库，该数据库内包含所欲写入的字段。如为空 将已最后打开的库读取
.参数 索引, 整数型, 可空, 写到指定记录处指定字段的数据 如果空 写到当前记录处指定字段的数据内容
.参数 字段位置, 整数型, 可空, 参数值可以为一个字段名位置数值 字段位置数值从 1 开始   如果空 将用字段名读写
.参数 字段名, 文本型, 可空, 参数值可以为一个字段名称文本 如果空 将用字段位置读写
.参数 存放数据的变量, 逻辑型, 参考 可空, 本参数数据的类型必须与所对应字段的数据类型一致或可互相转换。如果本参数被省略，则初始化对应字段中的内容，具体为：数值字段被初始化为零，逻辑字段被初始化为假，日期字段被初始化为 1899 年 12 月 30 日，文本及备注字段被初始化为空文本（“”）

.局部变量 文本, 文本型, , , 
.局部变量 文本1, 文本型, , "0", 
.局部变量 文本2, 文本型, , , 
.局部变量 a, 整数型, , , 
.局部变量 c, 整数型, , , 

赋值 (存放数据的变量, 假)
赋值 (a, 取数组索引 (别名))
.如果真 (大于 (a, 0))
    赋值 (文本, 读指定记录数据 (别名, 索引))
    .如果真 (不等于 (文本, “”))
        赋值 (文本1, 分割文本 (文本, 字符 (8), ))
        .计次循环首 (取数组下标 (库_别名 [a], 字段信息, ), c)
            .如果 (大于 (字段位置, 0))
                .如果真 (等于 (c, 字段位置))
                    .如果 (大于或等于 (取数组下标 (文本1, ), c))
                        赋值 (文本1 [c], 子文本替换 (文本1 [c], #换行符, “”, , , 真))
                        .如果真 (并且 (等于 (取文本长度 (文本1 [c]), 库_别名 [a], 字段信息 [c], 长度), 等于 (库_别名 [a], 字段信息 [c], 类型, #逻辑_型)))
                            赋值 (文本1 [c], 删尾空 (文本1 [c]))
                            .如果 (等于 (文本1 [c], “真”))
                                赋值 (存放数据的变量, 真)
                            .否则
                                赋值 (存放数据的变量, 假)
                            .如果结束
                            返回 (真)
                        .如果真结束
                        ' 本源码来自易语言资源网(www.5A5X.com)
                    .否则
                        
                    .如果结束
                    跳出循环 ()
                .如果真结束
                
            .否则
                .如果 (不等于 (字段名, “”))
                    .如果真 (等于 (库_别名 [a], 字段信息 [c], 字段名, 字段名))
                        .如果真 (大于或等于 (取数组下标 (文本1, ), c))
                            .如果真 (并且 (等于 (取文本长度 (文本1 [c]), 库_别名 [a], 字段信息 [c], 长度), 等于 (库_别名 [a], 字段信息 [c], 类型, #文本_型)))
                                赋值 (文本, 删尾空 (文本1 [c]))
                                .如果 (等于 (文本, “真”))
                                    赋值 (存放数据的变量, 真)
                                .否则
                                    赋值 (存放数据的变量, 假)
                                .如果结束
                                返回 (真)
                            .如果真结束
                            
                        .如果真结束
                        跳出循环 ()
                    .如果真结束
                    
                .否则
                    跳出循环 ()
                .如果结束
                 ' 本源码来自易语言资源网(www.5A5X.com)
            .如果结束
            
        .计次循环尾 ()
    .如果真结束
    
.如果真结束
返回 (假)


.子程序 读整数型, 逻辑型, 公开, 将数据写入到指定数据库中当前记录处的指定字段内。成功返回真，失败返回假。
.参数 别名, 文本型, 可空, 参数值指定一个已经被打开的数据库，该数据库内包含所欲写入的字段。如为空 将已最后打开的库读取
.参数 索引, 整数型, 可空, 写到指定记录处指定字段的数据 如果空 写到当前记录处指定字段的数据内容
.参数 字段位置, 整数型, 可空, 参数值可以为一个字段名位置数值 字段位置数值从 1 开始   如果空 将用字段名读写
.参数 字段名, 文本型, 可空, 参数值可以为一个字段名称文本 如果空 将用字段位置读写
.参数 存放数据的变量, 整数型, 参考 可空, 本参数数据的类型必须与所对应字段的数据类型一致或可互相转换。如果本参数被省略，则初始化对应字段中的内容，具体为：数值字段被初始化为零，逻辑字段被初始化为假，日期字段被初始化为 1899 年 12 月 30 日，文本及备注字段被初始化为空文本（“”）

.局部变量 文本, 文本型, , , 
.局部变量 文本1, 文本型, , "0", 
.局部变量 a, 整数型, , , 
.局部变量 c, 整数型, , , 

赋值 (存放数据的变量, 0)
赋值 (a, 取数组索引 (别名))
.如果真 (大于 (a, 0))
    赋值 (文本, 读指定记录数据 (别名, 索引))
    .如果真 (不等于 (文本, “”))
        赋值 (文本1, 分割文本 (文本, 字符 (8), ))
        .计次循环首 (取数组下标 (库_别名 [a], 字段信息, ), c)
            .如果 (大于 (字段位置, 0))
                .如果真 (等于 (c, 字段位置))
                    .如果 (大于或等于 (取数组下标 (文本1, ), c))
                        赋值 (文本1 [c], 子文本替换 (文本1 [c], #换行符, “”, , , 真))
                        .如果真 (并且 (等于 (取文本长度 (文本1 [c]), 库_别名 [a], 字段信息 [c], 长度), 等于 (库_别名 [a], 字段信息 [c], 类型, #整数_型)))
                            赋值 (存放数据的变量, 到整数 (删尾空 (文本1 [c])))
                            返回 (真)
                        .如果真结束
                        ' 本源码来自易语言资源网(www.5A5X.com)
                    .否则
                        
                    .如果结束
                    跳出循环 ()
                .如果真结束
                
            .否则
                .如果 (不等于 (字段名, “”))
                    .如果真 (等于 (库_别名 [a], 字段信息 [c], 字段名, 字段名))
                        .如果真 (大于或等于 (取数组下标 (文本1, ), c))
                            .如果真 (并且 (等于 (取文本长度 (文本1 [c]), 库_别名 [a], 字段信息 [c], 长度), 等于 (库_别名 [a], 字段信息 [c], 类型, #文本_型)))
                                赋值 (存放数据的变量, 到整数 (删尾空 (文本1 [c])))
                                返回 (真)
                            .如果真结束
                            
                        .如果真结束
                        跳出循环 ()
                    .如果真结束
                    
                .否则
                    跳出循环 ()
                .如果结束
                 ' 本源码来自易语言资源网(www.5A5X.com)
            .如果结束
            
        .计次循环尾 ()
    .如果真结束
    
.如果真结束
返回 (假)

.子程序 读双精度小数型, 逻辑型, 公开, 将数据写入到指定数据库中当前记录处的指定字段内。成功返回真，失败返回假。
.参数 别名, 文本型, 可空, 参数值指定一个已经被打开的数据库，该数据库内包含所欲写入的字段。如为空 将已最后打开的库读取
.参数 索引, 整数型, 可空, 写到指定记录处指定字段的数据 如果空 写到当前记录处指定字段的数据内容
.参数 字段位置, 整数型, 可空, 参数值可以为一个字段名位置数值 字段位置数值从 1 开始   如果空 将用字段名读写
.参数 字段名, 文本型, 可空, 参数值可以为一个字段名称文本 如果空 将用字段位置读写
.参数 存放数据的变量, 双精度小数型, 参考 可空, 本参数数据的类型必须与所对应字段的数据类型一致或可互相转换。如果本参数被省略，则初始化对应字段中的内容，具体为：数值字段被初始化为零，逻辑字段被初始化为假，日期字段被初始化为 1899 年 12 月 30 日，文本及备注字段被初始化为空文本（“”）

.局部变量 文本, 文本型, , , 
.局部变量 文本1, 文本型, , "0", 
.局部变量 a, 整数型, , , 
.局部变量 c, 整数型, , , 

赋值 (存放数据的变量, 0)
赋值 (a, 取数组索引 (别名))
.如果真 (大于 (a, 0))
    赋值 (文本, 读指定记录数据 (别名, 索引))
    .如果真 (不等于 (文本, “”))
        赋值 (文本1, 分割文本 (文本, 字符 (8), ))
        .计次循环首 (取数组下标 (库_别名 [a], 字段信息, ), c)
            .如果 (大于 (字段位置, 0))
                .如果真 (等于 (c, 字段位置))
                    .如果 (大于或等于 (取数组下标 (文本1, ), c))
                        赋值 (文本1 [c], 子文本替换 (文本1 [c], #换行符, “”, , , 真))
                        .如果真 (并且 (等于 (取文本长度 (文本1 [c]), 库_别名 [a], 字段信息 [c], 长度), 等于 (库_别名 [a], 字段信息 [c], 类型, #双精度小数_型)))
                            赋值 (存放数据的变量, 到数值 (删尾空 (文本1 [c])))
                            返回 (真)
                        .如果真结束
                        
                    .否则
                        ' 本源码来自易语言资源网(www.5A5X.com)
                    .如果结束
                    跳出循环 ()
                .如果真结束
                
            .否则
                .如果 (不等于 (字段名, “”))
                    .如果真 (等于 (库_别名 [a], 字段信息 [c], 字段名, 字段名))
                        .如果真 (大于或等于 (取数组下标 (文本1, ), c))
                            .如果真 (并且 (等于 (取文本长度 (文本1 [c]), 库_别名 [a], 字段信息 [c], 长度), 等于 (库_别名 [a], 字段信息 [c], 类型, #文本_型)))
                                赋值 (存放数据的变量, 到数值 (删尾空 (文本1 [c])))
                                返回 (真)
                            .如果真结束
                            
                        .如果真结束
                        跳出循环 ()
                    .如果真结束
                    
                .否则
                    跳出循环 ()
                .如果结束
                
            .如果结束
             ' 本源码来自易语言资源网(www.5A5X.com)
        .计次循环尾 ()
    .如果真结束
    
.如果真结束
返回 (假)

.子程序 读日期时间型, 逻辑型, 公开, 将数据写入到指定数据库中当前记录处的指定字段内。成功返回真，失败返回假。
.参数 别名, 文本型, 可空, 参数值指定一个已经被打开的数据库，该数据库内包含所欲写入的字段。如为空 将已最后打开的库读取
.参数 索引, 整数型, 可空, 写到指定记录处指定字段的数据 如果空 写到当前记录处指定字段的数据内容
.参数 字段位置, 整数型, 可空, 参数值可以为一个字段名位置数值 字段位置数值从 1 开始   如果空 将用字段名读写
.参数 字段名, 文本型, 可空, 参数值可以为一个字段名称文本 如果空 将用字段位置读写
.参数 存放数据的变量, 日期时间型, 参考 可空, 本参数数据的类型必须与所对应字段的数据类型一致或可互相转换。如果本参数被省略，则初始化对应字段中的内容，具体为：数值字段被初始化为零，逻辑字段被初始化为假，日期字段被初始化为 1899 年 12 月 30 日，文本及备注字段被初始化为空文本（“”）

.局部变量 文本, 文本型, , , 
.局部变量 文本1, 文本型, , "0", 
.局部变量 a, 整数型, , , 
.局部变量 c, 整数型, , , 
.局部变量 时间, 日期时间型, , , 

赋值 (存放数据的变量, 时间)
赋值 (a, 取数组索引 (别名))
.如果真 (大于 (a, 0))
    赋值 (文本, 读指定记录数据 (别名, 索引))
    .如果真 (不等于 (文本, “”))
        赋值 (文本1, 分割文本 (文本, 字符 (8), ))
        .计次循环首 (取数组下标 (库_别名 [a], 字段信息, ), c)
            .如果 (大于 (字段位置, 0))
                .如果真 (等于 (c, 字段位置))
                    .如果 (大于或等于 (取数组下标 (文本1, ), c))
                        赋值 (文本1 [c], 子文本替换 (文本1 [c], #换行符, “”, , , 真))
                        .如果真 (并且 (等于 (取文本长度 (文本1 [c]), 库_别名 [a], 字段信息 [c], 长度), 等于 (库_别名 [a], 字段信息 [c], 类型, #日期时间_型)))
                            赋值 (存放数据的变量, 到时间 (删尾空 (文本1 [c])))
                            返回 (真)
                        .如果真结束
                        ' 本源码来自易语言资源网(www.5A5X.com)
                    .否则
                        
                    .如果结束
                    跳出循环 ()
                .如果真结束
                
            .否则
                .如果 (不等于 (字段名, “”))
                    .如果真 (等于 (库_别名 [a], 字段信息 [c], 字段名, 字段名))
                        .如果真 (大于或等于 (取数组下标 (文本1, ), c))
                            .如果真 (并且 (等于 (取文本长度 (文本1 [c]), 库_别名 [a], 字段信息 [c], 长度), 等于 (库_别名 [a], 字段信息 [c], 类型, #文本_型)))
                                赋值 (存放数据的变量, 到时间 (删尾空 (文本1 [c])))
                                返回 (真)
                            .如果真结束
                            
                        .如果真结束
                        跳出循环 ()
                    .如果真结束
                    
                .否则
                    跳出循环 ()
                .如果结束
                
            .如果结束
             ' 本源码来自易语言资源网(www.5A5X.com)
        .计次循环尾 ()
    .如果真结束
    
.如果真结束
返回 (假)

.子程序 读文本型, 逻辑型, 公开, 将数据写入到指定数据库中当前记录处的指定字段内。成功返回真，失败返回假。
.参数 别名, 文本型, 可空, 参数值指定一个已经被打开的数据库，该数据库内包含所欲写入的字段。如为空 将已最后打开的库读取
.参数 索引, 整数型, 可空, 写到指定记录处指定字段的数据 如果空 写到当前记录处指定字段的数据内容
.参数 字段位置, 整数型, 可空, 参数值可以为一个字段名位置数值 字段位置数值从 1 开始   如果空 将用字段名读写
.参数 字段名, 文本型, 可空, 参数值可以为一个字段名称文本 如果空 将用字段位置读写
.参数 存放数据的变量, 文本型, 参考 可空, 本参数数据的类型必须与所对应字段的数据类型一致或可互相转换。如果本参数被省略，则初始化对应字段中的内容，具体为：数值字段被初始化为零，逻辑字段被初始化为假，日期字段被初始化为 1899 年 12 月 30 日，文本及备注字段被初始化为空文本（“”）

.局部变量 文本, 文本型, , , 
.局部变量 文本1, 文本型, , "0", 
.局部变量 a, 整数型, , , 
.局部变量 c, 整数型, , , 

赋值 (存放数据的变量, “”)
赋值 (a, 取数组索引 (别名))
.如果真 (大于 (a, 0))
    赋值 (文本, 读指定记录数据 (别名, 索引))
    .如果真 (不等于 (文本, “”))
        赋值 (文本1, 分割文本 (文本, 字符 (8), ))
        .计次循环首 (取数组下标 (库_别名 [a], 字段信息, ), c)
            .如果 (大于 (字段位置, 0))
                .如果真 (等于 (c, 字段位置))
                    .如果真 (大于或等于 (取数组下标 (文本1, ), c))
                        赋值 (文本1 [c], 子文本替换 (文本1 [c], #换行符, “”, , , 真))
                        .如果真 (并且 (等于 (取文本长度 (文本1 [c]), 库_别名 [a], 字段信息 [c], 长度), 等于 (库_别名 [a], 字段信息 [c], 类型, #文本_型)))
                            赋值 (存放数据的变量, 删尾空 (文本1 [c]))
                            返回 (真)
                        .如果真结束
                         ' 本源码来自易语言资源网(www.5A5X.com)
                    .如果真结束
                    跳出循环 ()
                .如果真结束
                
            .否则
                .如果 (不等于 (字段名, “”))
                    .如果真 (等于 (库_别名 [a], 字段信息 [c], 字段名, 字段名))
                        .如果真 (大于或等于 (取数组下标 (文本1, ), c))
                            .如果真 (并且 (等于 (取文本长度 (文本1 [c]), 库_别名 [a], 字段信息 [c], 长度), 等于 (库_别名 [a], 字段信息 [c], 类型, #文本_型)))
                                赋值 (存放数据的变量, 删尾空 (文本1 [c]))
                                返回 (真)
                            .如果真结束
                            
                        .如果真结束
                        跳出循环 ()
                    .如果真结束
                    
                .否则
                    跳出循环 ()
                .如果结束
                
            .如果结束
            ' 本源码来自易语言资源网(www.5A5X.com)
        .计次循环尾 ()
    .如果真结束
    
.如果真结束
返回 (假)

.子程序 写字节型, 逻辑型, 公开, 将数据写入到指定数据库中当前记录处的指定字段内。成功返回真，失败返回假。
.参数 别名, 文本型, 可空, 参数值指定一个已经被打开的数据库，该数据库内包含所欲写入的字段。如为空 将已最后打开的库读取
.参数 索引, 整数型, 可空, 写到指定记录处指定字段的数据 如果空 写到当前记录处指定字段的数据内容
.参数 字段位置, 整数型, 可空, 参数值可以为一个字段名位置数值 字段位置数值从 1 开始   如果空 将用字段名读写
.参数 字段名, 文本型, 可空, 参数值可以为一个字段名称文本 如果空 将用字段位置读写
.参数 欲写入数据, 字节型, 可空, 本参数数据的类型必须与所对应字段的数据类型一致或可互相转换。如果本参数被省略，则初始化对应字段中的内容，具体为：数值字段被初始化为零，逻辑字段被初始化为假，日期字段被初始化为 1899 年 12 月 30 日，文本及备注字段被初始化为空文本（“”）

.局部变量 文本, 文本型, , , 
.局部变量 长度, 整数型, , , 
.局部变量 a, 整数型, , , 
.局部变量 删除位置, 整数型, , , 
.局部变量 类型, 整数型, , , 

赋值 (类型, 取_字段类型 (别名, 字段位置, 字段名))
.如果真 (等于 (类型, #字节_型))
    赋值 (a, 取数组索引 (别名))
    .如果真 (小于或等于 (索引, 0))
        赋值 (索引, 取_记录索引 (别名))
    .如果真结束
    .如果真 (锁住文件 (库_别名 [a], 文件号, 0, 相加 (库_别名 [a], 首位置, 相乘 (取所有字段长度 (库_别名 [a], 字段信息), 取_记录数 (别名))), -1))
        .如果真 (移动读写_位置 (库_别名 [a], 文件号, #文件首, 索引, 库_别名 [a], 首位置, 库_别名 [a], 长度, 库_别名 [a], 现行位置))
            赋值 (删除位置, 取字段位置前长度 (库_别名 [a], 字段信息, 字段名, 字段位置, 假))
            .如果真 (移动读写位置 (库_别名 [a], 文件号, #现行位置, 删除位置))
                赋值 (长度, 取指定字段长度 (库_别名 [a], 字段信息, 字段名, 字段位置))
                .如果真 (大于 (长度, 0))
                    .如果真 (删除数据 (库_别名 [a], 文件号, 长度))
                        赋值 (文本, 取文本左边 (到文本 (欲写入数据), 长度))
                        .判断循环首 (小于 (取文本长度 (文本), 长度))
                            赋值 (文本, 相加 (文本, 取空白文本 (1)))
                        .判断循环尾 ()
                        移动读写位置 (库_别名 [a], 文件号, #文件首, 相加 (库_别名 [a], 现行位置, 删除位置))
                        .如果真 (插入文本 (库_别名 [a], 文件号, 文本))
                            移动读写_位置 (库_别名 [a], 文件号, #文件首, 索引, 库_别名 [a], 首位置, 库_别名 [a], 长度, 库_别名 [a], 现行位置)
                            解锁文件 (库_别名 [a], 文件号, 0, 相加 (库_别名 [a], 首位置, 相乘 (取所有字段长度 (库_别名 [a], 字段信息), 取_记录数 (别名))))
                            返回 (真)
                        .如果真结束
                        ' 本源码来自易语言资源网(www.5A5X.com)
                    .如果真结束
                    
                .如果真结束
                
            .如果真结束
            
        .如果真结束
        解锁文件 (库_别名 [a], 文件号, 0, 相加 (库_别名 [a], 首位置, 相乘 (取所有字段长度 (库_别名 [a], 字段信息), 取_记录数 (别名))))
    .如果真结束
    移动读写位置 (库_别名 [a], 文件号, #文件首, 库_别名 [a], 现行位置)
.如果真结束

返回 (假)

.子程序 写逻辑型, 逻辑型, 公开, 将数据写入到指定数据库中当前记录处的指定字段内。成功返回真，失败返回假。
.参数 别名, 文本型, 可空, 参数值指定一个已经被打开的数据库，该数据库内包含所欲写入的字段。如为空 将已最后打开的库读取
.参数 索引, 整数型, 可空, 写到指定记录处指定字段的数据 如果空 写到当前记录处指定字段的数据内容
.参数 字段位置, 整数型, 可空, 参数值可以为一个字段名位置数值 字段位置数值从 1 开始   如果空 将用字段名读写
.参数 字段名, 文本型, 可空, 参数值可以为一个字段名称文本 如果空 将用字段位置读写
.参数 欲写入数据, 逻辑型, 可空, 本参数数据的类型必须与所对应字段的数据类型一致或可互相转换。如果本参数被省略，则初始化对应字段中的内容，具体为：数值字段被初始化为零，逻辑字段被初始化为假，日期字段被初始化为 1899 年 12 月 30 日，文本及备注字段被初始化为空文本（“”）

.局部变量 文本, 文本型, , , 
.局部变量 长度, 整数型, , , 
.局部变量 a, 整数型, , , 
.局部变量 删除位置, 整数型, , , 
.局部变量 类型, 整数型, , , 

赋值 (类型, 取_字段类型 (别名, 字段位置, 字段名))
.如果真 (等于 (类型, #日期时间_型))
    赋值 (a, 取数组索引 (别名))
    .如果真 (小于或等于 (索引, 0))
        赋值 (索引, 取_记录索引 (别名))
    .如果真结束
    .如果真 (锁住文件 (库_别名 [a], 文件号, 0, 相加 (库_别名 [a], 首位置, 相乘 (取所有字段长度 (库_别名 [a], 字段信息), 取_记录数 (别名))), -1))
        .如果真 (移动读写_位置 (库_别名 [a], 文件号, #文件首, 索引, 库_别名 [a], 首位置, 库_别名 [a], 长度, 库_别名 [a], 现行位置))
            赋值 (删除位置, 取字段位置前长度 (库_别名 [a], 字段信息, 字段名, 字段位置, 假))
            .如果真 (移动读写位置 (库_别名 [a], 文件号, #现行位置, 删除位置))
                赋值 (长度, 取指定字段长度 (库_别名 [a], 字段信息, 字段名, 字段位置))
                .如果真 (大于 (长度, 0))
                    .如果真 (删除数据 (库_别名 [a], 文件号, 长度))
                        赋值 (文本, 取文本左边 (到文本 (欲写入数据), 长度))
                        .如果真 (不等于 (文本, “真”))
                            赋值 (文本, “假”)
                        .如果真结束
                        .判断循环首 (小于 (取文本长度 (文本), 长度))
                            赋值 (文本, 相加 (文本, 取空白文本 (1)))
                        .判断循环尾 ()
                        移动读写位置 (库_别名 [a], 文件号, #文件首, 相加 (库_别名 [a], 现行位置, 删除位置))
                        .如果真 (插入文本 (库_别名 [a], 文件号, 文本))
                            移动读写_位置 (库_别名 [a], 文件号, #文件首, 索引, 库_别名 [a], 首位置, 库_别名 [a], 长度, 库_别名 [a], 现行位置)
                            解锁文件 (库_别名 [a], 文件号, 0, 相加 (库_别名 [a], 首位置, 相乘 (取所有字段长度 (库_别名 [a], 字段信息), 取_记录数 (别名))))
                            返回 (真)
                        .如果真结束
                        
                    .如果真结束
                    ' 本源码来自易语言资源网(www.5A5X.com)
                .如果真结束
                
            .如果真结束
            
        .如果真结束
        解锁文件 (库_别名 [a], 文件号, 0, 相加 (库_别名 [a], 首位置, 相乘 (取所有字段长度 (库_别名 [a], 字段信息), 取_记录数 (别名))))
    .如果真结束
    移动读写位置 (库_别名 [a], 文件号, #文件首, 库_别名 [a], 现行位置)
.如果真结束

返回 (假)

.子程序 写整数型, 逻辑型, 公开, 将数据写入到指定数据库中当前记录处的指定字段内。成功返回真，失败返回假。
.参数 别名, 文本型, 可空, 参数值指定一个已经被打开的数据库，该数据库内包含所欲写入的字段。如为空 将已最后打开的库读取
.参数 索引, 整数型, 可空, 写到指定记录处指定字段的数据 如果空 写到当前记录处指定字段的数据内容
.参数 字段位置, 整数型, 可空, 参数值可以为一个字段名位置数值 字段位置数值从 1 开始   如果空 将用字段名读写
.参数 字段名, 文本型, 可空, 参数值可以为一个字段名称文本 如果空 将用字段位置读写
.参数 欲写入数据, 整数型, 可空, 本参数数据的类型必须与所对应字段的数据类型一致或可互相转换。如果本参数被省略，则初始化对应字段中的内容，具体为：数值字段被初始化为零，逻辑字段被初始化为假，日期字段被初始化为 1899 年 12 月 30 日，文本及备注字段被初始化为空文本（“”）

.局部变量 文本, 文本型, , , 
.局部变量 长度, 整数型, , , 
.局部变量 a, 整数型, , , 
.局部变量 删除位置, 整数型, , , 
.局部变量 类型, 整数型, , , 

赋值 (类型, 取_字段类型 (别名, 字段位置, 字段名))
.如果真 (等于 (类型, #整数_型))
    赋值 (a, 取数组索引 (别名))
    .如果真 (小于或等于 (索引, 0))
        赋值 (索引, 取_记录索引 (别名))
    .如果真结束
    .如果真 (锁住文件 (库_别名 [a], 文件号, 0, 相加 (库_别名 [a], 首位置, 相乘 (取所有字段长度 (库_别名 [a], 字段信息), 取_记录数 (别名))), -1))
        .如果真 (移动读写_位置 (库_别名 [a], 文件号, #文件首, 索引, 库_别名 [a], 首位置, 库_别名 [a], 长度, 库_别名 [a], 现行位置))
            赋值 (删除位置, 取字段位置前长度 (库_别名 [a], 字段信息, 字段名, 字段位置, 假))
            .如果真 (移动读写位置 (库_别名 [a], 文件号, #现行位置, 删除位置))
                赋值 (长度, 取指定字段长度 (库_别名 [a], 字段信息, 字段名, 字段位置))
                .如果真 (大于 (长度, 0))
                    .如果真 (删除数据 (库_别名 [a], 文件号, 长度))
                        赋值 (文本, 取文本左边 (到文本 (欲写入数据), 长度))
                        .判断循环首 (小于 (取文本长度 (文本), 长度))
                            赋值 (文本, 相加 (文本, 取空白文本 (1)))
                        .判断循环尾 ()
                        移动读写位置 (库_别名 [a], 文件号, #文件首, 相加 (库_别名 [a], 现行位置, 删除位置))
                        .如果真 (插入文本 (库_别名 [a], 文件号, 文本))
                            移动读写_位置 (库_别名 [a], 文件号, #文件首, 索引, 库_别名 [a], 首位置, 库_别名 [a], 长度, 库_别名 [a], 现行位置)
                            解锁文件 (库_别名 [a], 文件号, 0, 相加 (库_别名 [a], 首位置, 相乘 (取所有字段长度 (库_别名 [a], 字段信息), 取_记录数 (别名))))
                            返回 (真)
                        .如果真结束
                        
                    .如果真结束
                    ' 本源码来自易语言资源网(www.5A5X.com)
                .如果真结束
                
            .如果真结束
            
        .如果真结束
        解锁文件 (库_别名 [a], 文件号, 0, 相加 (库_别名 [a], 首位置, 相乘 (取所有字段长度 (库_别名 [a], 字段信息), 取_记录数 (别名))))
    .如果真结束
    移动读写位置 (库_别名 [a], 文件号, #文件首, 库_别名 [a], 现行位置)
.如果真结束

返回 (假)

.子程序 写双精度小数型, 逻辑型, 公开, 将数据写入到指定数据库中当前记录处的指定字段内。成功返回真，失败返回假。
.参数 别名, 文本型, 可空, 参数值指定一个已经被打开的数据库，该数据库内包含所欲写入的字段。如为空 将已最后打开的库读取
.参数 索引, 整数型, 可空, 写到指定记录处指定字段的数据 如果空 写到当前记录处指定字段的数据内容
.参数 字段位置, 整数型, 可空, 参数值可以为一个字段名位置数值 字段位置数值从 1 开始   如果空 将用字段名读写
.参数 字段名, 文本型, 可空, 参数值可以为一个字段名称文本 如果空 将用字段位置读写
.参数 欲写入数据, 双精度小数型, 可空, 本参数数据的类型必须与所对应字段的数据类型一致或可互相转换。如果本参数被省略，则初始化对应字段中的内容，具体为：数值字段被初始化为零，逻辑字段被初始化为假，日期字段被初始化为 1899 年 12 月 30 日，文本及备注字段被初始化为空文本（“”）

.局部变量 文本, 文本型, , , 
.局部变量 长度, 整数型, , , 
.局部变量 a, 整数型, , , 
.局部变量 删除位置, 整数型, , , 
.局部变量 类型, 整数型, , , 

赋值 (类型, 取_字段类型 (别名, 字段位置, 字段名))
.如果真 (等于 (类型, #双精度小数_型))
    赋值 (a, 取数组索引 (别名))
    .如果真 (小于或等于 (索引, 0))
        赋值 (索引, 取_记录索引 (别名))
    .如果真结束
    .如果真 (锁住文件 (库_别名 [a], 文件号, 0, 相加 (库_别名 [a], 首位置, 相乘 (取所有字段长度 (库_别名 [a], 字段信息), 取_记录数 (别名))), -1))
        .如果真 (移动读写_位置 (库_别名 [a], 文件号, #文件首, 索引, 库_别名 [a], 首位置, 库_别名 [a], 长度, 库_别名 [a], 现行位置))
            赋值 (删除位置, 取字段位置前长度 (库_别名 [a], 字段信息, 字段名, 字段位置, 假))
            .如果真 (移动读写位置 (库_别名 [a], 文件号, #现行位置, 删除位置))
                赋值 (长度, 取指定字段长度 (库_别名 [a], 字段信息, 字段名, 字段位置))
                .如果真 (大于 (长度, 0))
                    .如果真 (删除数据 (库_别名 [a], 文件号, 长度))
                        赋值 (文本, 取文本左边 (到文本 (欲写入数据), 长度))
                        .判断循环首 (小于 (取文本长度 (文本), 长度))
                            赋值 (文本, 相加 (文本, 取空白文本 (1)))
                        .判断循环尾 ()
                        移动读写位置 (库_别名 [a], 文件号, #文件首, 相加 (库_别名 [a], 现行位置, 删除位置))
                        .如果真 (插入文本 (库_别名 [a], 文件号, 文本))
                            移动读写_位置 (库_别名 [a], 文件号, #文件首, 索引, 库_别名 [a], 首位置, 库_别名 [a], 长度, 库_别名 [a], 现行位置)
                            解锁文件 (库_别名 [a], 文件号, 0, 相加 (库_别名 [a], 首位置, 相乘 (取所有字段长度 (库_别名 [a], 字段信息), 取_记录数 (别名))))
                            返回 (真)
                        .如果真结束
                        
                    .如果真结束
                    ' 本源码来自易语言资源网(www.5A5X.com)
                .如果真结束
                
            .如果真结束
            
        .如果真结束
        解锁文件 (库_别名 [a], 文件号, 0, 相加 (库_别名 [a], 首位置, 相乘 (取所有字段长度 (库_别名 [a], 字段信息), 取_记录数 (别名))))
    .如果真结束
    移动读写位置 (库_别名 [a], 文件号, #文件首, 库_别名 [a], 现行位置)
.如果真结束

返回 (假)

.子程序 写日期时间型, 逻辑型, 公开, 将数据写入到指定数据库中当前记录处的指定字段内。成功返回真，失败返回假。
.参数 别名, 文本型, 可空, 参数值指定一个已经被打开的数据库，该数据库内包含所欲写入的字段。如为空 将已最后打开的库读取
.参数 索引, 整数型, 可空, 写到指定记录处指定字段的数据 如果空 写到当前记录处指定字段的数据内容
.参数 字段位置, 整数型, 可空, 参数值可以为一个字段名位置数值 字段位置数值从 1 开始   如果空 将用字段名读写
.参数 字段名, 文本型, 可空, 参数值可以为一个字段名称文本 如果空 将用字段位置读写
.参数 欲写入数据, 日期时间型, 可空, 本参数数据的类型必须与所对应字段的数据类型一致或可互相转换。如果本参数被省略，则初始化对应字段中的内容，具体为：数值字段被初始化为零，逻辑字段被初始化为假，日期字段被初始化为 1899 年 12 月 30 日，文本及备注字段被初始化为空文本（“”）

.局部变量 文本, 文本型, , , 
.局部变量 长度, 整数型, , , 
.局部变量 a, 整数型, , , 
.局部变量 删除位置, 整数型, , , 
.局部变量 类型, 整数型, , , 

赋值 (类型, 取_字段类型 (别名, 字段位置, 字段名))
.如果真 (等于 (类型, #日期时间_型))
    赋值 (a, 取数组索引 (别名))
    .如果真 (小于或等于 (索引, 0))
        赋值 (索引, 取_记录索引 (别名))
    .如果真结束
    .如果真 (锁住文件 (库_别名 [a], 文件号, 0, 相加 (库_别名 [a], 首位置, 相乘 (取所有字段长度 (库_别名 [a], 字段信息), 取_记录数 (别名))), -1))
        .如果真 (移动读写_位置 (库_别名 [a], 文件号, #文件首, 索引, 库_别名 [a], 首位置, 库_别名 [a], 长度, 库_别名 [a], 现行位置))
            赋值 (删除位置, 取字段位置前长度 (库_别名 [a], 字段信息, 字段名, 字段位置, 假))
            .如果真 (移动读写位置 (库_别名 [a], 文件号, #现行位置, 删除位置))
                赋值 (长度, 取指定字段长度 (库_别名 [a], 字段信息, 字段名, 字段位置))
                .如果真 (大于 (长度, 0))
                    .如果真 (删除数据 (库_别名 [a], 文件号, 长度))
                        赋值 (文本, 取文本左边 (到文本 (欲写入数据), 长度))
                        .判断循环首 (小于 (取文本长度 (文本), 长度))
                            赋值 (文本, 相加 (文本, 取空白文本 (1)))
                        .判断循环尾 ()
                        移动读写位置 (库_别名 [a], 文件号, #文件首, 相加 (库_别名 [a], 现行位置, 删除位置))
                        .如果真 (插入文本 (库_别名 [a], 文件号, 文本))
                            移动读写_位置 (库_别名 [a], 文件号, #文件首, 索引, 库_别名 [a], 首位置, 库_别名 [a], 长度, 库_别名 [a], 现行位置)
                            解锁文件 (库_别名 [a], 文件号, 0, 相加 (库_别名 [a], 首位置, 相乘 (取所有字段长度 (库_别名 [a], 字段信息), 取_记录数 (别名))))
                            返回 (真)
                        .如果真结束
                        
                    .如果真结束
                    ' 本源码来自易语言资源网(www.5A5X.com)
                .如果真结束
                
            .如果真结束
            
        .如果真结束
        解锁文件 (库_别名 [a], 文件号, 0, 相加 (库_别名 [a], 首位置, 相乘 (取所有字段长度 (库_别名 [a], 字段信息), 取_记录数 (别名))))
    .如果真结束
    移动读写位置 (库_别名 [a], 文件号, #文件首, 库_别名 [a], 现行位置)
.如果真结束
返回 (假)

.子程序 写文本型, 逻辑型, 公开, 将数据写入到指定数据库中当前记录处的指定字段内。成功返回真，失败返回假。
.参数 别名, 文本型, 可空, 参数值指定一个已经被打开的数据库，该数据库内包含所欲写入的字段。如为空 将已最后打开的库读取
.参数 索引, 整数型, 可空, 写到指定记录处指定字段的数据 如果空 写到当前记录处指定字段的数据内容
.参数 字段位置, 整数型, 可空, 参数值可以为一个字段名位置数值 字段位置数值从 1 开始   如果空 将用字段名读写
.参数 字段名, 文本型, 可空, 参数值可以为一个字段名称文本 如果空 将用字段位置读写
.参数 欲写入数据, 文本型, 可空, 本参数数据的类型必须与所对应字段的数据类型一致或可互相转换。如果本参数被省略，则初始化对应字段中的内容，具体为：数值字段被初始化为零，逻辑字段被初始化为假，日期字段被初始化为 1899 年 12 月 30 日，文本及备注字段被初始化为空文本（“”）

.局部变量 删除位置, 整数型, , , 
.局部变量 a, 整数型, , , 
.局部变量 长度, 整数型, , , 
.局部变量 文本, 文本型, , , 
.局部变量 类型, 整数型, , , 

赋值 (类型, 取_字段类型 (别名, 字段位置, 字段名))
.如果真 (等于 (类型, #文本_型))
    赋值 (a, 取数组索引 (别名))
    .如果真 (小于或等于 (索引, 0))
        赋值 (索引, 取_记录索引 (别名))
    .如果真结束
    .如果真 (锁住文件 (库_别名 [a], 文件号, 0, 相加 (库_别名 [a], 首位置, 相乘 (取所有字段长度 (库_别名 [a], 字段信息), 取_记录数 (别名))), -1))
        .如果真 (移动读写_位置 (库_别名 [a], 文件号, #文件首, 索引, 库_别名 [a], 首位置, 库_别名 [a], 长度, 库_别名 [a], 现行位置))
            赋值 (删除位置, 取字段位置前长度 (库_别名 [a], 字段信息, 字段名, 字段位置, 假))
            .如果真 (移动读写位置 (库_别名 [a], 文件号, #现行位置, 删除位置))
                赋值 (长度, 取指定字段长度 (库_别名 [a], 字段信息, 字段名, 字段位置))
                .如果真 (大于 (长度, 0))
                    .如果真 (删除数据 (库_别名 [a], 文件号, 长度))
                        赋值 (文本, 取文本左边 (欲写入数据, 长度))
                        .判断循环首 (小于 (取文本长度 (文本), 长度))
                            赋值 (文本, 相加 (文本, 取空白文本 (1)))
                        .判断循环尾 ()
                        移动读写位置 (库_别名 [a], 文件号, #文件首, 相加 (库_别名 [a], 现行位置, 删除位置))
                        .如果真 (插入文本 (库_别名 [a], 文件号, 文本))
                            移动读写_位置 (库_别名 [a], 文件号, #文件首, 索引, 库_别名 [a], 首位置, 库_别名 [a], 长度, 库_别名 [a], 现行位置)
                            解锁文件 (库_别名 [a], 文件号, 0, 相加 (库_别名 [a], 首位置, 相乘 (取所有字段长度 (库_别名 [a], 字段信息), 取_记录数 (别名))))
                            返回 (真)
                        .如果真结束
                        
                    .如果真结束
                    ' 本源码来自易语言资源网(www.5A5X.com)
                .如果真结束
                
            .如果真结束
            
        .如果真结束
        解锁文件 (库_别名 [a], 文件号, 0, 相加 (库_别名 [a], 首位置, 相乘 (取所有字段长度 (库_别名 [a], 字段信息), 取_记录数 (别名))))
    .如果真结束
    移动读写位置 (库_别名 [a], 文件号, #文件首, 库_别名 [a], 现行位置)
.如果真结束
返回 (假)

.子程序 处理字段数据, 文本型, , 
.参数 字段, 字_段, , 
.参数 数据, 文本型, , 

.局部变量 a, 整数型, , , 
.局部变量 文本, 文本型, , , 
.局部变量 时间, 日期时间型, , , 

 ' 1、#字节型； 2、#逻辑型； 3、#整数型； 4、#双精度小数型； 5、#日期时间型； 6、#文本型；
.如果 (等于 (字段.类型, 1))
    赋值 (a, 4)
    赋值 (文本, 到文本 (到字节 (数据)))
.否则
    .如果 (等于 (字段.类型, 2))
        赋值 (a, 2)
        .如果 (或者 (等于 (数据, “真”), 等于 (数据, “1”)))
            赋值 (文本, “真”)
        .否则
            赋值 (文本, “假”)
        .如果结束
        
    .否则
        .如果 (等于 (字段.类型, 3))
            赋值 (a, 17)
            赋值 (文本, 到文本 (到整数 (数据)))
        .否则
            .如果 (等于 (字段.类型, 4))
                赋值 (a, 17)
                赋值 (文本, 到文本 (到数值 (数据)))
            .否则
                .如果 (等于 (字段.类型, 5))
                    赋值 (a, 24)
                    赋值 (文本, 到文本 (到数值 (数据)))
                    .如果真 (等于 (文本, “”))
                        赋值 (文本, 到文本 (时间))
                    .如果真结束
                    
                .否则
                    .如果 (等于 (字段.类型, 6))
                        赋值 (a, 字段.长度)
                        赋值 (文本, 子文本替换 (数据, 字符 (8), , , , 真))
                        赋值 (文本, 子文本替换 (文本, #换行符, , , , 真))
                    .否则
                        返回 (“”)
                    .如果结束
                    
                .如果结束
                ' 本源码来自易语言资源网(www.5A5X.com)
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束
赋值 (文本, 取文本左边 (文本, a))
.判断循环首 (小于 (取文本长度 (文本), a))
    赋值 (文本, 相加 (文本, 取空白文本 (1)))
.判断循环尾 ()
返回 (文本)

.子程序 分割字段, 逻辑型, , 
.参数 字段信息, 字_段, 参考 数组, 
.参数 字段文本, 文本型, , 

.局部变量 文本1, 文本型, , "0", 
.局部变量 i, 整数型, , , 
.局部变量 临时, 字_段, , , 
.局部变量 文本2, 文本型, , "0", 

 ' 1、#字节型； 2、#逻辑型； 3、#整数型； 4、#双精度小数型； 5、#日期时间型； 6、#文本型；
清除数组 (字段信息)
' 本源码来自易语言资源网(www.5A5X.com)
赋值 (文本1, 分割文本 (字段文本, “|”, ))
.计次循环首 (取数组下标 (文本1, ), i)
    赋值 (文本2, 分割文本 (文本1 [i], “,”, ))
    .如果真 (大于或等于 (取数组下标 (文本2, ), 2))
        赋值 (临时.字段名, 子文本替换 (子文本替换 (删首尾空 (文本2 [1]), “:”, “”, , , 真), 字符 (9), “”, , , 真))
        赋值 (临时.字段名, 取文本左边 (临时.字段名, 20))
        .判断循环首 (小于 (取文本长度 (临时.字段名), 20))
            赋值 (临时.字段名, 相加 (临时.字段名, 取空白文本 (1)))
        .判断循环尾 ()
        赋值 (临时.类型, 到整数 (删首尾空 (文本2 [2])))
        .如果 (等于 (到整数 (删首尾空 (文本2 [2])), 1))
            赋值 (临时.长度, 4)
        .否则
            .如果 (等于 (到整数 (删首尾空 (文本2 [2])), 2))
                赋值 (临时.长度, 2)
            .否则
                .如果 (或者 (等于 (到整数 (删首尾空 (文本2 [2])), 3), 等于 (到整数 (删首尾空 (文本2 [2])), 4)))
                    .如果 (等于 (取数组下标 (文本2, ), 3))
                        .如果 (大于 (到整数 (文本2 [3]), 0))
                            赋值 (临时.长度, 到整数 (文本2 [3]))
                        .否则
                            赋值 (临时.长度, 17)
                        .如果结束
                        
                    .否则
                        赋值 (临时.长度, 17)
                    .如果结束
                    
                .否则
                    .如果 (等于 (到整数 (删首尾空 (文本2 [2])), 5))
                        赋值 (临时.长度, 24)
                    .否则
                        .如果 (等于 (到整数 (删首尾空 (文本2 [2])), 6))
                            赋值 (临时.长度, 到整数 (删首尾空 (文本2 [3])))
                        .否则
                            赋值 (临时.类型, 1)
                            赋值 (临时.长度, 4)
                        .如果结束
                        
                        
                    .如果结束
                    
                    
                .如果结束
                 ' 本源码来自易语言资源网(www.5A5X.com)
            .如果结束
            
        .如果结束
        加入成员 (字段信息, 临时)
    .如果真结束
    
.计次循环尾 ()
返回 (真)

.子程序 移动读写_位置, 逻辑型, , 
.参数 文件号, 整数型, , 
.参数 起始位置, 整数型, 可空, 
.参数 索引, 整数型, 可空, 
.参数 首位置, 整数型, , 
.参数 长度, 整数型, , 所用字段数据的长度
.参数 现行位置, 整数型, 参考 可空, 当前的读写位置

.局部变量 位_置, 整数型, , , 
.局部变量 c, 整数型, , , 
.局部变量 文本, 文本型, , , 

.如果真 (或者 (小于或等于 (起始位置, 0), 大于 (起始位置, 3)))
    赋值 (起始位置, 1)
.如果真结束
.如果真 (等于 (移到文件尾 (文件号), 假))
    移动读写位置 (文件号, #文件首, 现行位置)
    返回 (假)
.如果真结束
赋值 (位_置, 取读写位置 (文件号))
移动读写位置 (文件号, #文件首, 现行位置)
.如果 (等于 (起始位置, #文件首))
    .如果真 (小于或等于 (索引, 0))
        赋值 (索引, 1)
    .如果真结束
    .如果真 (等于 (移动读写位置 (文件号, #文件首, 相加 (首位置, 相乘 (长度, 相减 (索引, 1)))), 假))
        移动读写位置 (文件号, #文件首, 现行位置)
        返回 (假)
    .如果真结束
     ' 本源码来自易语言资源网(www.5A5X.com)
.否则
    .如果 (等于 (起始位置, #文件尾))
        .如果真 (大于或等于 (索引, 0))
            赋值 (索引, -1)
        .如果真结束
        .如果真 (等于 (移动读写位置 (文件号, #文件尾, 相乘 (长度, 索引)), 假))
            移动读写位置 (文件号, #文件首, 现行位置)
            返回 (假)
        .如果真结束
        
    .否则
        .如果 (等于 (起始位置, #现行位置))
            .如果真 (等于 (移动读写位置 (文件号, #现行位置, 相乘 (长度, 索引)), 假))
                移动读写位置 (文件号, #文件首, 现行位置)
                返回 (假)
            .如果真结束
            
        .否则
            移动读写位置 (文件号, #文件首, 现行位置)
            返回 (假)
        .如果结束
         ' 本源码来自易语言资源网(www.5A5X.com)
    .如果结束
    
.如果结束
 ' 输出调试文本 (到文本 (位_置) ＋ “,” ＋ 到文本 (取读写位置 (文件号)), 长度 × 索引, 现行位置)
.如果真 (大于 (位_置, 取读写位置 (文件号)))
    赋值 (现行位置, 取读写位置 (文件号))
    返回 (真)
.如果真结束
.如果 (大于 (取_记录_数 (文件号, 长度, 首位置), 0))
    移动读写位置 (文件号, #文件首, 现行位置)
.否则
    移动读写位置 (文件号, #文件首, 首位置)
.如果结束
返回 (假)

.子程序 取数组索引, 整数型, , 
.参数 别名, 文本型, , 

.局部变量 a, 整数型, , , 

.如果 (不等于 (别名, “”))
    .计次循环首 (取数组下标 (库_别名, ), a)
        .如果真 (等于 (库_别名 [a], 库别名, 别名))
            跳出循环 ()
        .如果真结束
        .如果真 (大于或等于 (a, 取数组下标 (库_别名, )))
            赋值 (a, 0)
            跳出循环 ()
        .如果真结束
        ' 本源码来自易语言资源网(www.5A5X.com)
    .计次循环尾 ()
.否则
    .如果真 (大于 (取数组下标 (库_别名, ), 0))
        赋值 (a, 取数组下标 (库_别名, ))
    .如果真结束
    
.如果结束
返回 (a)

.子程序 读指定记录数据, 文本型, , 
.参数 别名, 文本型, 可空, 
.参数 索引, 整数型, 可空, 

.局部变量 a, 整数型, , , 
.局部变量 文本, 文本型, , , 

赋值 (a, 取数组索引 (别名))
.如果真 (大于 (a, 0))
    .如果 (大于 (索引, 0))
        .如果 (移动读写_位置 (库_别名 [a], 文件号, #文件首, 索引, 库_别名 [a], 首位置, 库_别名 [a], 长度, 库_别名 [a], 现行位置))
            赋值 (文本, 读入一行 (库_别名 [a], 文件号))
        .否则
            返回 (“”)
        .如果结束
        ' 本源码来自易语言资源网(www.5A5X.com)
    .否则
        .如果 (移动读写_位置 (库_别名 [a], 文件号, #现行位置, 0, 库_别名 [a], 首位置, 库_别名 [a], 长度, 库_别名 [a], 现行位置))
            赋值 (文本, 读入一行 (库_别名 [a], 文件号))
        .否则
            返回 (“”)
        .如果结束
        
    .如果结束
     ' 移动读写_位置 (库_别名 [a].文件号, #现行位置, -1, 库_别名 [a].首位置, 库_别名 [a].长度, 库_别名 [a].现行位置)
    返回 (文本)
.如果真结束
返回 (“”)

.子程序 取字段位置前长度, 整数型, , 取回字段名或字段位置前的字段数据长度(包括 或 不包括 提供字段名或字段位置的数据长度)
.参数 临时, 字_段, 数组, 
.参数 字段名, 文本型, 可空, 如无此字段名 将读取所有字段数据长度
.参数 字段位置, 整数型, 可空, 
.参数 是否, 逻辑型, 可空, 如为真 (包括提供字段名或字段位置的数据长度) 假 (不包括提供字段名或字段位置的数据长度)

.局部变量 长度, 整数型, , , 
.局部变量 文本, 文本型, , , 
.局部变量 c, 整数型, , , 

.计次循环首 (取数组下标 (临时, ), c)
    .如果 (不等于 (字段名, “”))
        .如果 (不等于 (临时 [c], 字段名, 字段名))
            .如果 (等于 (c, 取数组下标 (临时, )))
                赋值 (文本, 相加 (文本, 取空白文本 (临时 [c], 长度)))
            .否则
                赋值 (文本, 相加 (文本, 字符 (8), 取空白文本 (临时 [c], 长度)))
            .如果结束
            ' 本源码来自易语言资源网(www.5A5X.com)
        .否则
            .如果 (等于 (是否, 真))
                .如果真 (大于或等于 (取数组下标 (临时, ), c))
                    .如果 (等于 (c, 取数组下标 (临时, )))
                        赋值 (文本, 相加 (文本, 取空白文本 (临时 [c], 长度)))
                    .否则
                        赋值 (文本, 相加 (文本, 字符 (8), 取空白文本 (临时 [c], 长度)))
                    .如果结束
                    
                .如果真结束
                返回 (取文本长度 (文本))
            .否则
                返回 (取文本长度 (文本))
            .如果结束
            
        .如果结束
         ' 本源码来自易语言资源网(www.5A5X.com)
    .否则
        .如果 (大于 (字段位置, 0))
            .如果 (不等于 (c, 字段位置))
                .如果真 (大于 (取数组下标 (临时, ), c))
                    .如果 (等于 (c, 取数组下标 (临时, )))
                        赋值 (文本, 相加 (文本, 取空白文本 (临时 [c], 长度)))
                    .否则
                        赋值 (文本, 相加 (文本, 字符 (8), 取空白文本 (临时 [c], 长度)))
                    .如果结束
                    
                .如果真结束
                
            .否则
                .如果 (等于 (是否, 真))
                    .如果真 (大于或等于 (取数组下标 (临时, ), c))
                        .如果 (等于 (c, 取数组下标 (临时, )))
                            赋值 (文本, 相加 (文本, 取空白文本 (临时 [c], 长度)))
                        .否则
                            赋值 (文本, 相加 (文本, 字符 (8), 取空白文本 (临时 [c], 长度)))
                        .如果结束
                        
                    .如果真结束
                    返回 (取文本长度 (文本))
                .否则
                    返回 (取文本长度 (文本))
                .如果结束
                 ' 本源码来自易语言资源网(www.5A5X.com)
            .如果结束
            
        .否则
            返回 (0)
        .如果结束
        
    .如果结束
    
.计次循环尾 ()
返回 (取文本长度 (文本))

.子程序 取指定字段长度, 整数型, , 
.参数 临时, 字_段, 数组, 
.参数 字段名, 文本型, 可空, 如无此字段名 将读取所有字段数据长度
.参数 字段位置, 整数型, 可空, 

.局部变量 a, 整数型, , , 

.如果真 (大于 (取数组下标 (临时, ), 0))
    .计次循环首 (取数组下标 (临时, ), a)
        .如果 (不等于 (字段名, “”))
            .如果真 (等于 (临时 [a], 字段名, 字段名))
                返回 (临时 [a], 长度)
            .如果真结束
            
        .否则
            .如果 (大于 (字段位置, 0))
                .如果真 (等于 (a, 字段位置))
                    返回 (临时 [a], 长度)
                .如果真结束
                
            .否则
                返回 (0)
            .如果结束
            ' 本源码来自易语言资源网(www.5A5X.com)
        .如果结束
        
    .计次循环尾 ()
.如果真结束
返回 (0)

.子程序 取所有字段长度, 整数型, , 
.参数 临时, 字_段, 数组, 

.局部变量 长度, 整数型, , , 
.局部变量 文本, 文本型, , , 
.局部变量 c, 整数型, , , 

.计次循环首 (取数组下标 (临时, ), c)
    .如果真 (大于 (取数组下标 (临时, ), c))
        赋值 (文本, 相加 (文本, 字符 (8), 取空白文本 (临时 [c], 长度)))
        到循环尾 ()
    .如果真结束
    赋值 (文本, 相加 (文本, 取空白文本 (临时 [c], 长度)))
.计次循环尾 ()
赋值 (长度, 取文本长度 (相加 (文本, #换行符)))
返回 (长度)

.子程序 取_记录_数, 整数型, , 
.参数 文件号, 整数型, , 
.参数 长度, 整数型, , 
.参数 首位置, 整数型, , 

.局部变量 位_置, 整数型, , "2", 

赋值 (位_置 [1], 取读写位置 (文件号))
.如果真 (移到文件尾 (文件号))
    赋值 (位_置 [2], 取读写位置 (文件号))
    移动读写位置 (文件号, #文件首, 位_置 [1])
    返回 (相除 (相减 (位_置 [2], 首位置), 长度))
.如果真结束
返回 (0)
' 本源码来自易语言资源网(www.5A5X.com)

.窗口程序集 窗口程序集1, , , 

.程序集变量 清风库, 清风库, , , 
.子程序 _窗口1_创建完毕, 空白型, , 
.局部变量 a, 整数型, , , 

.如果真 (等于 (文件是否存在 (相加 (取当前目录 (), “\清风库.qdb”)), 假))
    .如果真 (等于 (清风库.创建_库 (“清风库”, , “用户名,6,20|密码,6,20|权限,3|清风币,3|性别,2”), 假))
        信息框 (“创建库失败”, 0, )
        销毁 ()
        返回 ()
    .如果真结束
    
.如果真结束
打开清风库 ()
_读入记录_被单击 ()
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--


.子程序 打开清风库, 空白型, , 
.局部变量 a, 整数型, , , 

赋值 (.禁止, 真)
.如果真 (清风库.打开_库 (相加 (取当前目录 (), “\清风库.qdb”), , ))
    .计次循环首 (清风库.取_字段数 (), a)
        .插入列 (清风库.取_字段名 (a), , , , )
    .计次循环尾 ()
    返回 ()
.如果真结束
赋值 (.禁止, 假)

.子程序 _读入记录_被单击, 空白型, , 
.局部变量 a, 整数型, , , 
.局部变量 c, 整数型, , , 
.局部变量 d, 整数型, , , 
.局部变量 文本, 文本型, , , 

读入_数据 ()
赋值 (., 相减 (清风库.取_记录索引 (), 1))

.子程序 读入_数据, 空白型, , 
.局部变量 a, 整数型, , , 
.局部变量 c, 整数型, , , 
.局部变量 文本, 文本型, , , 
.局部变量 d, 整数型, , , 

全部删除 ()
.计次循环首 (清风库.取_记录数 (), a)
    清风库.读文本型 (a, 1, , 文本)
    赋值 (c, .插入表项 (文本, , , , ))
    .计次循环首 (相减 (清风库.取_字段数 (), 1), d)
        c.置标题 (d, 读库数据 (a, 相加 (d, 1)))
    .计次循环尾 ()
.计次循环尾 ()
赋值 (., 相加 (“数据库记录数:”, 到文本 (清风库.取_记录数 ())))

.子程序 _加记录_被单击, 空白型, , 
.局部变量 文本, 文本型, , "0", 
.局部变量 a, 整数型, , , 
.局部变量 文本1, 文本型, , "0", 

赋值 (文本, 分割文本 (.内容, #换行符, ))
.计次循环首 (取数组下标 (文本, ), a)
    赋值 (文本1, 分割文本 (文本 [a], “|”, ))
    .如果真 (等于 (清风库.加_记录 (文本1), 假))
        信息框 (“加记录失败”, 0, )
        返回 ()
    .如果真结束
    
.计次循环尾 ()
信息框 (“加记录成功”, 0, )
读入_数据 ()

.子程序 _打开库_被单击, 空白型, , 
打开清风库 ()

.子程序 _到尾记录_被单击, 空白型, , 
清风库.到_尾记录 ()
赋值 (., 相减 (清风库.取_记录索引 (), 1))

.子程序 _到首记录_被单击, 空白型, , 
清风库.到_首记录 ()
赋值 (., 相减 (清风库.取_记录索引 (), 1))

.子程序 读库数据, 文本型, , 
.参数 索引, 整数型, , 
.参数 字段位置, 整数型, , 

.局部变量 字节, 字节型, , , 
.局部变量 逻辑值, 逻辑型, , , 
.局部变量 整数, 整数型, , , 
.局部变量 双精度小数, 双精度小数型, , , 
.局部变量 日期时间, 日期时间型, , , 
.局部变量 文本, 文本型, , , 

.如果 (等于 (清风库.取_字段类型 (字段位置), #字节_型))
    清风库.读字节型 (索引, 字段位置, , 字节)
    返回 (到文本 (字节))
.否则
    .如果 (等于 (清风库.取_字段类型 (字段位置), #逻辑_型))
        清风库.读逻辑型 (索引, 字段位置, , 逻辑值)
        返回 (到文本 (逻辑值))
    .否则
        .如果 (等于 (清风库.取_字段类型 (字段位置), #整数_型))
            清风库.读整数型 (索引, 字段位置, , 整数)
            返回 (到文本 (整数))
        .否则
            .如果 (等于 (清风库.取_字段类型 (字段位置), #双精度小数_型))
                清风库.读双精度小数型 (索引, 字段位置, , 双精度小数)
                返回 (到文本 (双精度小数))
            .否则
                .如果 (等于 (清风库.取_字段类型 (字段位置), #日期时间_型))
                    清风库.读日期时间型 (索引, 字段位置, , 日期时间)
                    返回 (到文本 (日期时间))
                .否则
                    .如果 (等于 (清风库.取_字段类型 (字段位置), #文本_型))
                        清风库.读文本型 (索引, 字段位置, , 文本)
                        返回 (文本)
                    .否则
                        
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束
返回 (“”)

.子程序 _列表框_右键单击表项, 空白型, , 
.如果 (并且 (大于 (取表项数 (), 0), 不等于 (., -1)))
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
.如果结束
弹出菜单 ()


.子程序 _删除记录_被选择, 空白型, , 
.如果真 (清风库.删除_记录 (相加 (., 1)))
    读入_数据 ()
.如果真结束


.子程序 _写文本_被单击, 空白型, , 
.局部变量 文本, 文本型, , "0", 
.局部变量 a, 整数型, , , 
.局部变量 文本1, 文本型, , "0", 

赋值 (文本, 分割文本 (.内容, #换行符, ))
.计次循环首 (取数组下标 (文本, ), a)
    赋值 (文本1, 分割文本 (文本 [a], “|”, ))
    .如果真 (等于 (清风库.写文本型 (到整数 (文本1 [1]), 2, , 文本1 [2]), 假))
        信息框 (“写失败”, 0, )
        返回 ()
    .如果真结束
    
.计次循环尾 ()
信息框 (“写成功”, 0, )
读入_数据 ()


.子程序 _取索引_被单击, 空白型, , 
取鼠标水平位置 ().未知支持库函数_26 (取鼠标垂直位置 (), 相加 (“现行位置:”, 到文本 (清风库.取_记录索引 ())), -1, )

.子程序 _索_引_获得焦点, 空白型, , 
.如果 (或者 (等于 (.内容, “”), 等于 (.内容, “请填入数值”)))
    赋值 (.文本颜色, #黑色)
    赋值 (.输入方式, 3)
    赋值 (.内容, “”)
.否则
    
.如果结束


.子程序 _索_引_失去焦点, 空白型, , 
.如果 (或者 (等于 (.内容, “”), 等于 (.内容, “请填入数值”)))
    赋值 (.文本颜色, #灰色)
    赋值 (.输入方式, 0)
    赋值 (.内容, “请填入数值”)
.否则
    
.如果结束


.子程序 _列表框_当前表项被改变, 空白型, , 
清风库.跳到指定记录 (相加 (., 1))


.子程序 _置索引_被单击, 空白型, , 
清风库.跳到指定记录 (到数值 (.内容))
赋值 (., 相减 (清风库.取_记录索引 (), 1))


 ' 不属于任何一个程序集、类模块的函数：
