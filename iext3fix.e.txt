 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 317
    高度 = 262
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “扩展界面支持库三 更换器”
    帮助文件名 = “”



.图片 fne26, " ' 已保存到：D:\易语言学习\Data\iext3fix.e\fne26", , 
.图片 fne25, " ' 已保存到：D:\易语言学习\Data\iext3fix.e\fne25", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 1 0 数据操作支持库一




数据类型 支持库信息, , 
    .成员 m_dwLibFormatVer, 整数型, , , 目前为20010101
    .成员 m_szGuid, 文本型, , , 对应于本库的唯一GUID串，不能为NULL或空，guidgen.exe生成
    .成员 m_nMajorVersion, 整数型, , , 本库的主版本号，必须大于0。
    .成员 m_nMinorVersion, 整数型, , , 本库的次版本号。
    .成员 m_nBuildNumber, 整数型, , , 
    .成员 m_nRqSysMajorVer, 整数型, , , 所需要的易语言系统的主版本号。
    .成员 m_nRqSysMinorVer, 整数型, , , 所需要的易语言系统的次版本号。可设置为0
    .成员 m_nRqSysKrnlLibMajorVer, 整数型, , , 所需要的系统核心支持库的主版本号。目前应该为3。
    .成员 m_nRqSysKrnlLibMinorVer, 整数型, , , 所需要的系统核心支持库的主版本号。可设置为0。
    .成员 m_szName, 文本型, , , 本支持库在易IDE中显示的名称，不能为空。
    .成员 m_nLanguage, 整数型, , , 本支持库所支持的语言，1代表中文，2代表英文。
    .成员 m_szExplain, 文本型, , , 关于本支持库的详细说明
    .成员 m_dwState, 整数型, , , 缺省为0
    .成员 m_szAuthor, 文本型, , , 
    .成员 m_szZipCode, 文本型, , , 
    .成员 m_szAddress, 文本型, , , 
    .成员 m_szPhone, 文本型, , , 
    .成员 m_szFax, 文本型, , , 
    .成员 m_szEmai, 文本型, , , 
    .成员 m_szHomePage, 文本型, , , 
    .成员 m_szOther, 文本型, , , 
    .成员 m_nDataTypeCount, 整数型, , , 本库中自定义数据类型的数目，必须等于下面自定义数据类型所指向数组成员的数目
    .成员 m_pDataType, 整数型, , , 本库中所有自定义数据类型定义信息数组的地址指针。
    .成员 m_nCategoryCount, 整数型, , , 全局命令类别数目，必须等同于下面全局命令类别数组所实际提供的数目。如无则为0。
    .成员 m_szzCategory, 整数型, , , 全局命令类别定义信息数组的地址指针。
    .成员 m_nCmdCount, 整数型, , , 
    .成员 m_pBeginCmdInfo, 整数型, , , 
    .成员 m_pCmdsFunc, 整数型, , , 
    .成员 m_pfnRunAddInFn, 整数型, , , 
    .成员 m_szzAddInFnInfo, 整数型, , , 
    .成员 m_pfnNotify, 子程序指针, , , 指定回调函数子程序入口地址指针，用来提供接收来自易语言IDE或运行环境通知信息的函数。必须为有效地址。
    .成员 m_pfnSuperTemplate, 整数型, , , 超级模板暂时保留不用。总为0。
    .成员 m_szzSuperTemplateInfo, 整数型, , , 总为0。
    .成员 m_nLibConstCount, 整数型, , , 本支持库中定义的常量数目。如无则为0。
    .成员 m_pLibConst, 整数型, , , 常量定义信息的地址指针。如无则为0。
    .成员 m_szzDependFiles, 文本型, , , 


.DLL命令 GetProcAddress, 整数型, "kernel32", "GetProcAddress", , 返回函数地址
    .参数 hModule, 整数型, , 
    .参数 lpProcName, 文本型, , 

.DLL命令 copymemory, 空白型, "kernel32", "RtlMoveMemory", , 
    .参数 pDest, 支持库信息, 传址, 
    .参数 pSrc, 整数型, , 
    .参数 ByteLen, 整数型, , 

.DLL命令 CallWindowProc, 整数型, "user32", "CallWindowProcA", , 
    .参数 lpPrevWndFunc, 整数型, , 
    .参数 hwnd, 整数型, , 
    .参数 msg, 整数型, , 
    .参数 wParam, 整数型, , 
    .参数 lParam, 整数型, , 

.DLL命令 FreeLibrary, 整数型, "kernel32", "FreeLibrary", , 
    .参数 hModule, 整数型, , 

.DLL命令 LoadLibrary, 整数型, "kernel32", "LoadLibraryA", , 
    .参数 库名称, 文本型, , lpLibFileName

.窗口程序集 窗口程序集1, , , 

.程序集变量 路径, 文本型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (路径, 取文本注册项 (#现行用户, “Software\FlySky\E\Install\path”, “”))
.如果真 (不等于 (取文本右边 (路径, 1), “\”))
    赋值 (路径, 相加 (路径, “\”))
.如果真结束
赋值 (.标题, 取版本信息 (相加 (路径, “iext3.fne”)))
.如果 (等于 (文件是否存在 (相加 (路径, “iext3.fnb”)), 假))
    赋值 (.标题, “未找到备用支持库！”)
    赋值 (.禁止, 假)
    返回 ()
.否则
    赋值 (.标题, 取版本信息 (相加 (路径, “iext3.fnb”)))
    赋值 (.禁止, 真)
.如果结束


.子程序 取版本信息, 文本型, , 
.参数 库文件名, 文本型, , 

.局部变量 库句柄, 整数型, , , 
.局部变量 函数地址, 整数型, , , 
.局部变量 结构指针, 整数型, , , 
.局部变量 库信息, 支持库信息, , , 

赋值 (库句柄, LoadLibrary (库文件名))
赋值 (函数地址, GetProcAddress (库句柄, “GetNewInf”))
赋值 (结构指针, CallWindowProc (函数地址, 0, 0, 0, 0))
copymemory (库信息, 结构指针, 相乘 (36, 4))
FreeLibrary (库句柄)
返回 (相加 (到文本 (库信息.m_nMajorVersion), “.”, 到文本 (库信息.m_nMinorVersion), “#”, 到文本 (库信息.m_nBuildNumber), “版”))


.子程序 _按钮2_被单击, 空白型, , 
.如果 (小于 (到数值 (.标题), 2.5))
    .如果真 (等于 (信息框 (“系统现有扩展界面支持库三的版本太低，点击确定将升级到2.5#0版和2.6#1版，点击取消放弃创建备用支持库！”, 相加 (#询问图标, #确认取消钮), ), #取消钮))
        返回 ()
    .如果真结束
    .如果真 (等于 (文件更名 (相加 (路径, “iext3.fne”), 相加 (路径, “iext3(”, .标题, “).fne”)), 假))
        信息框 (相加 (“更换支持库失败！请检查该支持库是否正在使用中！”, #换行符, “强烈建议关闭所有打开的易语言IDE后，再尝试更换支持库！”), #错误图标, )
        返回 ()
    .如果真结束
    写到文件 (相加 (路径, “iext3.fne”), 未知支持库函数_1 (#fne25))
    写到文件 (相加 (路径, “iext3.fnb”), 未知支持库函数_1 (#fne26))
    赋值 (.标题, 取版本信息 (相加 (路径, “iext3.fne”)))
    赋值 (.标题, 取版本信息 (相加 (路径, “iext3.fnb”)))
.否则
    
.如果结束
.如果 (写到文件 (相加 (路径, “iext3.fnb”), 未知支持库函数_1 (选择 (等于 (取文本左边 (.标题, 3), “2.5”), #fne26, #fne25))))
    赋值 (.标题, 取版本信息 (相加 (路径, “iext3.fnb”)))
    赋值 (.禁止, 真)
.否则
    信息框 (相加 (“创建备份支持库失败！”, #换行符, “强烈建议关闭所有打开的易语言IDE后，再尝试创建备份支持库！”), #错误图标, )
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
.如果真 (等于 (文件更名 (相加 (路径, “iext3.fne”), 相加 (路径, “iext3.fne.bak”)), 假))
    信息框 (相加 (“更换支持库失败！请检查该支持库是否正在使用中！”, #换行符, “强烈建议关闭所有打开的易语言IDE后，再尝试更换支持库！”), #错误图标, )
    返回 ()
.如果真结束
文件更名 (相加 (路径, “iext3.fnb”), 相加 (路径, “iext3.fne”))
文件更名 (相加 (路径, “iext3.fne.bak”), 相加 (路径, “iext3.fnb”))
信息框 (“支持库更换成功！”, #信息图标, )
赋值 (.标题, 取版本信息 (相加 (路径, “iext3.fne”)))
赋值 (.标题, 取版本信息 (相加 (路径, “iext3.fnb”)))



 ' 不属于任何一个程序集、类模块的函数：
