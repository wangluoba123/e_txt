 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 402
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “托盘图标操作例程”
    帮助文件名 = “”



.常量 TB_BUTTONCOUNT, "1048", , 取按钮数
.常量 TB_DELETEBUTTON, "1046", , 删除按钮
.常量 TB_GETSTATE, "1042", , 取按钮状态
.常量 TB_SETSTATE, "1041", , 设置按钮状态
.常量 TB_GETBUTTON, "1047", , 取按钮TBBUTTON
.常量 TB_GETBUTTONTEXTA, "1069", , 取工具条按钮标题
.常量 , , , 
.常量 PROCESS_ALL_ACCESS, "2035711", , 
.常量 MEM_RELEASE, "32768", , 
.常量 MEM_COMMIT, "4096", , 
.常量 PAGE_READWRITE, "4", , 
.常量 FILE_MAP_ALL_ACCESS, "983071", , 
.常量 , , , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一




数据类型 TBBUTTON, , 工具栏按钮
    .成员 iBitmap, 整数型, , , 按钮位图索引
    .成员 idCommand, 整数型, , , 按钮命令ID
    .成员 fsState, 字节型, , , TBSTATE_
    .成员 fsStyle, 字节型, , , TBSTYLE_
    .成员 bReserved1, 字节型, , , 
    .成员 bReserved2, 字节型, , , 
    .成员 dwData, 整数型, , , 应用程序定义的数据
    .成员 iString, 整数型, , , 按钮帮助文本字符串索引

数据类型 TRAYDATA, , 
    .成员 hwnd, 整数型, , , 
    .成员 uID, 整数型, , , 
    .成员 uCallbackMessage, 整数型, , , 
    .成员 Reserved1, 整数型, , , 
    .成员 Reserved2, 整数型, , , 
    .成员 hIcon, 整数型, , , 

数据类型 内存映射数据9X, , 
    .成员 映射文件号, 整数型, , , 
    .成员 指针, 整数型, , , 

.全局变量 全局_系统类别, 整数型, , , 

.DLL命令 FindWindowA, 整数型, "user32", "FindWindowA", 公开, 寻找窗口列表中第一个符合指定条件的顶级窗口（在vb里使用：FindWindow最常见的一个用途是获得ThunderRTMain类的隐藏窗口的句柄；该类是所有运行中vb执行程序的一部分。获得句柄后，可用api函数GetWindowText取得这个窗口的名称；该名也是应用程序的标题）　找到窗口的句柄。如未找到相符窗口，则返回零。会设置GetLastError
    .参数 窗口类名, 文本型, , 指向包含了窗口类名的空中止（C语言）字串的指针；或设为零，表示接收任何类
    .参数 窗口文本, 文本型, , 指向包含了窗口文本（或标签）的空中止（C语言）字串的指针；或设为零，表示接收任何窗口标题  示例Dim hw&, cnt&Dim rttitle As  * 256hw& = FindWindow("ThunderRT5Main", vbNullString) ' ThunderRTMain under VB4cnt = GetWindowText(hw&, rttitle, 255)MsgBox Left, 0, "RTMain title";

.DLL命令 FindWindowExA, 整数型, "user32", "FindWindowExA", 公开, 在窗口列表中寻找与指定条件相符的第一个子窗口　找到的窗口的句柄。如未找到相符窗口，则返回零。会设置GetLastError
    .参数 窗口句柄1, 整数型, , 在其中查找子的父窗口。如设为零，表示使用桌面窗口（通常说的顶级窗口都被认为是桌面的子窗口，所以也会对它们进行查找）
    .参数 窗口句柄2, 整数型, , 从这个窗口后开始查找。这样便可利用对FindWindowEx的多次调用找到符合条件的所有子窗口。如设为零，表示从第一个子窗口开始搜索
    .参数 欲搜索的类名1, 文本型, , 欲搜索的类名。零表示忽略
    .参数 欲搜索的类名2, 文本型, , 欲搜索的类名。零表示忽略;

.DLL命令 ImageList_Create, 整数型, "comctl32.dll", "ImageList_Create", , 
    .参数 cx, 整数型, , 宽度
    .参数 cy, 整数型, , 高度
    .参数 flags, 整数型, , 位深 ILC_
    .参数 cInitial, 整数型, , 初始数量
    .参数 cGrow, 整数型, , 是否手动销毁

.DLL命令 ImageList_Destroy, 整数型, "comctl32.dll", "ImageList_Destroy", , 
    .参数 himl, 整数型, , 

.DLL命令 ImageList_AddIcon, 整数型, "comctl32.dll", "ImageList_AddIcon", , 
    .参数 himl, 整数型, , 
    .参数 hicon, 整数型, , 

.DLL命令 GetClassNameA, 整数型, "user32", "GetClassNameA", , 为指定的窗口取得类名  以字节数表示的类名长度；排除最后的空中止字符。零表示出错。会设置GetLastError
    .参数 窗口句柄, 整数型, , 欲获得类名的那个窗口的句柄
    .参数 缓冲区, 文本型, , 随同类名载入的缓冲区。预先至少必须分配nMaxCount+1个字符
    .参数 缓冲区长度, 整数型, , 由lpClassName提供的缓冲区长度;

.DLL命令 SendMessageA, 整数型, "user32", "SendMessageA", , 
    .参数 窗口句柄, 整数型, , 要接收消息的那个窗口的句柄
    .参数 信息值, 整数型, , 消息的标识符
    .参数 参数一, 整数型, , 具体取决于消息
    .参数 参数二, 整数型, , 具体取决于消息;

.DLL命令 SendMessageA2, 整数型, "user32", "SendMessageA", , 
    .参数 窗口句柄, 整数型, , 要接收消息的那个窗口的句柄
    .参数 信息值, 整数型, , 消息的标识符
    .参数 参数一, 整数型, , 具体取决于消息
    .参数 参数二, TBBUTTON, , 具体取决于消息;

.DLL命令 lstrcpynA, 整数型, "kernel32", "lstrcpynA", , 
    .参数 数据1, 文本型, 传址, 
    .参数 数据2, 文本型, 传址, 
    .参数 保留, 整数型, , 

.DLL命令 RtlMoveMemory, 空白型, "kernel32.dll", "RtlMoveMemory", , 拷贝内存
    .参数 目标内容, TBBUTTON, 传址, 
    .参数 源数据, 字节集, , 
    .参数 尺寸, 整数型, , 

.DLL命令 RtlMoveMemory2, 空白型, "kernel32.dll", "RtlMoveMemory", , 拷贝内存
    .参数 目标内容, TRAYDATA, 传址, 
    .参数 源数据, 字节集, , 
    .参数 尺寸, 整数型, , 

.DLL命令 GetWindowThreadProcessId, 整数型, "user32.dll", "GetWindowThreadProcessId", , 
    .参数 hwnd, 整数型, , 
    .参数 lpdwProcessId, 整数型, 传址, 

.DLL命令 OpenProcess, 整数型, "kernel32.dll", "OpenProcess", , 
    .参数 dwDesiredAccess, 整数型, , 
    .参数 bInheritHandle, 逻辑型, , 
    .参数 dwProcessId, 整数型, , 

.DLL命令 WriteProcessMemory, 整数型, "kernel32.dll", "WriteProcessMemory", , 
    .参数 hProcess, 整数型, , 
    .参数 lpBaseAddress, 整数型, , 
    .参数 lpBuffer, 整数型, , 
    .参数 nSize, 整数型, , 
    .参数 lpNumberOfBytesWritten, 整数型, , 

.DLL命令 CloseHandle, 整数型, "kernel32.dll", "CloseHandle", , 
    .参数 hObject, 整数型, , 

.DLL命令 ReadProcessMemory, 整数型, "", "ReadProcessMemory", , 
    .参数 hProcess, 整数型, , 
    .参数 lpBaseAddress, 整数型, , 
    .参数 lpBuffer, 字节集, 传址, 
    .参数 nSize, 整数型, , 
    .参数 lpNumberOfBytesWritten, 整数型, , 

.DLL命令 VirtualAllocEx, 整数型, "kernel32.dll", "VirtualAllocEx", , 
    .参数 hProcess, 整数型, , 
    .参数 lpAddress, 整数型, , 
    .参数 dwSize, 整数型, , 
    .参数 flAllocationType, 整数型, , 
    .参数 flProtect, 整数型, , 

.DLL命令 CreateFileMapping, 整数型, "kernel32.dll", "CreateFileMappingA", , 创建一个新的文件映射对象
    .参数 hFile, 整数型, , 
    .参数 lpFileMappigAttributes, 整数型, , 
    .参数 flProtect, 整数型, , 
    .参数 dwMaximumSizeHigh, 整数型, , 
    .参数 dwMaximumSizeLow, 整数型, , 
    .参数 lpName, 整数型, , 

.DLL命令 MapViewOfFile, 整数型, "kernel32.dll", "MapViewOfFile", , 将一个文件映射对象映射到当前应用程序的地址空间
    .参数 hFileMappingObject, 整数型, , 
    .参数 dwDesiredAccess, 整数型, , 
    .参数 dwFileOffsetHigh, 整数型, , 
    .参数 dwFileOffsetLow, 整数型, , 
    .参数 dwNumberOfBytesToMap, 整数型, , 

.DLL命令 VirtualFreeEx, 整数型, "kernel32.dll", "VirtualFreeEx", , 
    .参数 hProcess, 整数型, , 
    .参数 lpAddress, 整数型, , 
    .参数 dwSize, 整数型, , 
    .参数 flAllocationType, 整数型, , 

.DLL命令 UnmapViewOfFile, 整数型, "kernel32.dll", "UnmapViewOfFile", , 在当前应用程序的内存地址空间解除对一个文件映射对象的映射
    .参数 lpBaseAddress, 整数型, , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 集_索引, 整数型, , , 
.程序集变量 集_图片组句柄, 整数型, , , 
.程序集变量 集_表项数, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (全局_系统类别, 取操作系统类别 ())
_按钮_刷新_被单击 ()
赋值 (集_表项数, 取表项数 ())
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--


.子程序 _按钮_刷新_被单击, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 表项索引, 整数型, , , 

ImageList_Destroy (集_图片组句柄)
全部删除 ()
初始化 ()
赋值 (集_图片组句柄, ImageList_Create (16, 16, 24, 0, 0))
4099.发送信息 (1, 集_图片组句柄)
.计次循环首 (取图标数 (), i)
    ImageList_AddIcon (集_图片组句柄, 取图标句柄 (相减 (i, 1)))
    .如果真 (不等于 (取图标标题 (相减 (i, 1)), “”))
        赋值 (表项索引, .插入表项 (取图标标题 (相减 (i, 1)), 相减 (i, 1), , , 相减 (i, 1)))
    .如果真结束
     ' 本源码来自易语言资源网(www.5A5X.com)
.计次循环尾 ()


.子程序 _按钮_隐藏_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 

.计次循环首 (集_表项数, 计次)
    .如果真 (等于 (相减 (计次, 1).取当前状态图片 (), 1))
        隐藏图标 (相减 (计次, 1).取表项数值 ())
    .如果真结束
     ' 本源码来自易语言资源网(www.5A5X.com)
.计次循环尾 ()

.子程序 _按钮_显示_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 

.计次循环首 (集_表项数, 计次)
    .如果真 (等于 (相减 (计次, 1).取当前状态图片 (), 1))
        显示图标 (相减 (计次, 1).取表项数值 ())
    .如果真结束
     ' 本源码来自易语言资源网(www.5A5X.com)
.计次循环尾 ()


.子程序 _按钮_删除_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 

.计次循环首 (集_表项数, 计次)
    .如果真 (等于 (相减 (计次, 1).取当前状态图片 (), 1))
        删除图标 (相减 (计次, 1).取表项数值 ())
    .如果真结束
     ' 本源码来自易语言资源网(www.5A5X.com)
.计次循环尾 ()



.子程序 _图形按钮1_被单击, 空白型, , 
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 __启动窗口_将被销毁, 空白型, , 
ImageList_Destroy (集_图片组句柄)

.程序集 功能程序集, , , 

.程序集变量 集_映射文件, 内存映射数据9X, , "0", 
.程序集变量 集_外部控件, 逻辑型, , , 
.程序集变量 集_托盘句柄, 整数型, , , 
.程序集变量 集_图标ID, 整数型, , , 
.程序集变量 集_外部指针, 整数型, , , 
.程序集变量 集_进程句柄, 整数型, , , 
.程序集变量 集_单一图标, TBBUTTON, , , 
.程序集变量 集_数据地址, 整数型, , , 
.程序集变量 匿名程序集变量_2004, 空白型, , , 
.子程序 初始化, 逻辑型, , 
.局部变量 局部_类名, 文本型, , , 

赋值 (局部_类名, 取空白文本 (256))
GetClassNameA (取托盘句柄 (), 局部_类名, 256)
.如果真 (等于 (删首尾空 (到大写 (局部_类名)), “TOOLBARWINDOW32”))
    赋值 (集_托盘句柄, 取托盘句柄 ())
    返回 (真)
.如果真结束
返回 (假)
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--


.子程序 取托盘句柄, 整数型, , 取系统托盘句柄，非0表示返回句柄，0表示失败。
.局部变量 系统句柄, 整数型, , , 
.局部变量 句柄, 整数型, , , 
.局部变量 托盘句柄, 整数型, , , 

赋值 (句柄, FindWindowA (“Shell_TrayWnd”, 字符 (0)))
赋值 (句柄, FindWindowExA (句柄, 0, “TrayNotifyWnd”, 字符 (0)))
赋值 (系统句柄, FindWindowExA (句柄, 0, “SysPager”, 字符 (0)))
.如果真 (不等于 (系统句柄, 0))
    赋值 (句柄, 系统句柄)
     ' 本源码来自易语言资源网(www.5A5X.com)
.如果真结束
赋值 (托盘句柄, FindWindowExA (句柄, 0, “ToolbarWindow32”, 字符 (0)))
.如果真 (等于 (托盘句柄, 0))
    赋值 (托盘句柄, 句柄)
.如果真结束
返回 (托盘句柄)

.子程序 取图标数, 整数型, , 取托盘图标总数
返回 (SendMessageA (集_托盘句柄, #TB_BUTTONCOUNT, 0, 0))

.子程序 删除图标, 空白型, , 删除托盘上的一个图标
.参数 参数_图标索引, 整数型, , 索引从0开始。0 为图标一，1 为图标二，如此类推。

SendMessageA (集_托盘句柄, #TB_DELETEBUTTON, 参数_图标索引, 0)

.子程序 隐藏图标, 空白型, , 隐藏托盘图标
.参数 参数_图标索引, 整数型, , 索引从0开始。0 为图标一，1 为图标二，如此类推。

.局部变量 局部_状态, 整数型, , , 
.局部变量 局部_数据, 字节集, , , 

赋值 (局部_状态, SendMessageA (集_托盘句柄, #TB_GETSTATE, 取图标ID (参数_图标索引), 0))
赋值 (局部_状态, 位或 (局部_状态, #隐藏))
SendMessageA (集_托盘句柄, #TB_SETSTATE, 取图标ID (参数_图标索引), 局部_状态)
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 显示图标, 空白型, , 显示托盘图标
.参数 参数_图标索引, 整数型, , 索引从0开始。0 为图标一，1 为图标二，如此类推。

.局部变量 局部_状态, 整数型, , , 

赋值 (局部_状态, SendMessageA (集_托盘句柄, #TB_GETSTATE, 取图标ID (参数_图标索引), 0))

.如果真 (不等于 (位与 (局部_状态, #隐藏), 0))
    赋值 (局部_状态, 位异或 (局部_状态, #隐藏))
.如果真结束
 ' 本源码来自易语言资源网(www.5A5X.com)
SendMessageA (集_托盘句柄, #TB_SETSTATE, 取图标ID (参数_图标索引), 局部_状态)


.子程序 取图标ID, 整数型, , 根据图标索引取图标的idCommand
.参数 参数_图标索引, 整数型, , 索引从0开始。0 为图标一，1 为图标二，如此类推。

.局部变量 局部_大小, 整数型, , , 
.局部变量 局部_数据, 字节集, , , 

赋值 (集_进程句柄, 打开进程 (集_托盘句柄))
赋值 (集_外部指针, 分配外部指针 (集_进程句柄, 18))
SendMessageA (集_托盘句柄, #TB_GETBUTTON, 参数_图标索引, 集_外部指针)
赋值 (局部_数据, 读外部指针数据 (集_进程句柄, 集_外部指针, 18))
RtlMoveMemory (集_单一图标, 局部_数据, 18)
销毁外部指针 (集_进程句柄, 集_外部指针)
结束操作 (集_进程句柄)
返回 (集_单一图标.idCommand)
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 取图标标题, 文本型, ,  取回指定图标的标题文本。
.参数 参数_图标索引, 整数型, , 索引从0开始。0 为图标一，1 为图标二，如此类推。

.局部变量 局部_长度, 整数型, , , 
.局部变量 局部_标题, 文本型, , , 
.局部变量 局部_数据, 字节集, , , 
.局部变量 局部_ID, 整数型, , , 

赋值 (局部_ID, 取图标ID (参数_图标索引))
赋值 (局部_长度, SendMessageA (集_托盘句柄, #TB_GETBUTTONTEXTA, 局部_ID, 0))
赋值 (集_进程句柄, 打开进程 (集_托盘句柄))
赋值 (集_外部指针, 分配外部指针 (集_进程句柄, 局部_长度))
.如果 (不等于 (SendMessageA (集_托盘句柄, #TB_GETBUTTONTEXTA, 局部_ID, 集_外部指针), -1))
    赋值 (局部_数据, 读外部指针数据 (集_进程句柄, 集_外部指针, 局部_长度))
    销毁外部指针 (集_进程句柄, 集_外部指针)
    结束操作 (集_进程句柄)
    返回 (到文本 (局部_数据))
.否则
    销毁外部指针 (集_进程句柄, 集_外部指针)
    结束操作 (集_进程句柄)
    返回 (“”)
.如果结束
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 取图标句柄, 整数型, , 返回指定图标的句柄。
.参数 参数_图标索引, 整数型, , 索引从0开始。0 为图标一，1 为图标二，如此类推。

.局部变量 局部_地址, 整数型, , , 
.局部变量 局部_数据, 字节集, , , 
.局部变量 局部_TRAYDATA, TRAYDATA, , , 

赋值 (集_进程句柄, 打开进程 (集_托盘句柄))
赋值 (集_外部指针, 分配外部指针 (集_进程句柄, 18))
SendMessageA (集_托盘句柄, #TB_GETBUTTON, 参数_图标索引, 集_外部指针)
赋值 (局部_数据, 读外部指针数据 (集_进程句柄, 集_外部指针, 18))
RtlMoveMemory (集_单一图标, 局部_数据, 18)
赋值 (局部_数据, 读外部指针数据 (集_进程句柄, 集_单一图标.dwData, 24))
RtlMoveMemory2 (局部_TRAYDATA, 局部_数据, 24)
销毁外部指针 (集_进程句柄, 集_外部指针)
结束操作 (集_进程句柄)
返回 (局部_TRAYDATA.hIcon)

.子程序 打开进程, 整数型, , 成功就返回进程句柄
.参数 对象句柄, 整数型, , 

.局部变量 进程句柄, 整数型, , , 
.局部变量 dwProcessID, 整数型, , , 

GetWindowThreadProcessId (对象句柄, dwProcessID) ' 获取与指定窗口关联在一起的一个线程和进程标识符
赋值 (进程句柄, OpenProcess (#PROCESS_ALL_ACCESS, 假, dwProcessID)) ' 打开一个现有进程的句柄 ' 位或 (#STANDARD_RIGHTS_REQUIRED, #SYNCHRONIZE, 4095)
返回 (进程句柄)

.子程序 写进程内存, 逻辑型, , 
.参数 进程句柄, 整数型, , 
.参数 数据指针, 整数型, , 
.参数 数据地址, 整数型, , 
.参数 数据长度, 整数型, , 

返回 (不等于 (WriteProcessMemory (进程句柄, 数据指针, 数据地址, 数据长度, 0), 0)) ' 写进程内存

.子程序 结束操作, 空白型, , 
.参数 进程句柄, 整数型, , 

.如果真 (不等于 (进程句柄, 0))
    CloseHandle (进程句柄) ' 关闭一个内核对象。
    清除数组 (集_映射文件)
    赋值 (进程句柄, 0)
.如果真结束
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 读外部指针数据, 字节集, , 
.参数 进程句柄, 整数型, , 
.参数 外部程序指针, 整数型, , 
.参数 读取数据大小, 整数型, , 

.局部变量 szBuf, 字节集, , , 

赋值 (szBuf, 取空白字节集 (读取数据大小))
ReadProcessMemory (进程句柄, 外部程序指针, szBuf, 读取数据大小, 0)
返回 (szBuf)


.子程序 分配外部指针, 整数型, , 
.参数 进程句柄, 整数型, , 
.参数 数据长度, 整数型, , 分配的数据长度

.局部变量 TEMP, 内存映射数据9X, , , 

.判断开始 (等于 (全局_系统类别, 3))
    返回 (VirtualAllocEx (进程句柄, 0, 数据长度, #MEM_COMMIT, #PAGE_READWRITE))
.默认
    赋值 (TEMP.映射文件号, CreateFileMapping (-1, 0, #PAGE_READWRITE, 0, 数据长度, 0)) ' 创建一个新的文件映射对象
    赋值 (TEMP.指针, MapViewOfFile (TEMP.映射文件号, #FILE_MAP_ALL_ACCESS, 0, 0, 0)) ' 将一个文件映射对象映射到当前应用程序的地址空间
    重定义数组 (集_映射文件, 真, 相加 (取数组成员数 (集_映射文件), 1))
    赋值 (集_映射文件 [取数组成员数 (集_映射文件)], TEMP)
    返回 (TEMP.指针)
.判断结束


.子程序 销毁外部指针, 空白型, , 
.参数 进程句柄, 整数型, , 
.参数 外部指针, 整数型, , 

.局部变量 成员数, 整数型, , , 
.局部变量 I, 整数型, , , 

.判断开始 (等于 (全局_系统类别, 3))
    VirtualFreeEx (进程句柄, 外部指针, 0, #MEM_RELEASE) ' 在目标进程中释放内存空间。
.默认
    赋值 (成员数, 取数组成员数 (集_映射文件))
    .变量循环首 (1, 成员数, 1, I)
        .如果真 (等于 (集_映射文件 [I], 指针, 外部指针))
            UnmapViewOfFile (外部指针) ' 在当前应用程序的内存地址空间解除对一个文件映射对象的映射
            CloseHandle (集_映射文件 [I], 映射文件号)
            删除成员 (集_映射文件, I, )
            跳出循环 ()
        .如果真结束
        
    .变量循环尾 ()
.判断结束



 ' 不属于任何一个程序集、类模块的函数：
