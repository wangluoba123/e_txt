 ' 文件类型：Windows控制台程序

 ' 程序名称：天涯验证码识别系统工程管理器
 ' 程序描述：
 ' 程序作者：天涯龙腾
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：yadinae@qq.com
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口
    左边 = 50
    顶边 = 50
    宽度 = 340
    高度 = 313
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “AntiVC.dll测试工具”
    帮助文件名 = “”



.常量 INTERNET_FLAG_RELOAD, "2147483648", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 3 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' EXMLParser BE2297B7415349c8A55BC9DFEB6DD11A 2 2 XML解析支持库
 ' YunImage {A43E53FA-42E4-4f20-B26E-B5E59C8E48B9} 1 1 云外归鸟的图像处理支持库
 ' internet 707ca37322474f6ca841f0e224f4b620 2 0 互联网支持库
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 2 0 多线程支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 2 0 扩展界面支持库二




数据类型 Rect, , 
    .成员 left, 空白型, , , 
    .成员 top, 空白型, , , 
    .成员 right, 空白型, , , 
    .成员 bottom, 空白型, , , 


.DLL命令 LoadCdsFromFile, 整数型, "AntiVC.dll", "LoadCdsFromFile", , 
    .参数 FilePath, 文本型, , 
    .参数 PassWord, 文本型, , 文本指针

.DLL命令 LoadCdsFromBuffer, 整数型, "AntiVC.dll", "LoadCdsFromBuffer", , 
    .参数 FileBuffer, 字节集, , 数据指针
    .参数 FileBufLen, 整数型, , 数据长度
    .参数 PassWord, 文本型, , 文本指针

.DLL命令 GetVcodeFromBuffer, 逻辑型, "AntiVC.dll", "GetVcodeFromBuffer", , 
    .参数 CdsIndex, 整数型, , 
    .参数 ImgBuffer, 字节集, 传址, 指向图像二进制数据的指针
    .参数 ImgBufLen, 整数型, , 数据长度
    .参数 Vcode, 文本型, , 识别结果

.DLL命令 GetVcodeFromFile, 逻辑型, "AntiVC.dll", "GetVcodeFromFile", , 
    .参数 CdsIndex, 整数型, , 
    .参数 FilePath, 文本型, , 指向一个文件路径的指针
    .参数 Vcode, 文本型, , 识别结果

.DLL命令 GetVcodeFromHWND, 逻辑型, "AntiVC.dll", "GetVcodeFromHWND", , 
    .参数 CdsIndex, 整数型, , 
    .参数 HWND, 整数型, , 
    .参数 lRect, Rect, , 
    .参数 Vcode, 文本型, , 识别结果
    .参数 ImgPath, 整数型, , 

.DLL命令 GetVcodeFromHWND_Debug, 逻辑型, "AntiVC.dll", "GetVcodeFromHWND", , 
    .参数 CdsIndex, 整数型, , 
    .参数 HWND, 整数型, , 
    .参数 lRect, 整数型, , 
    .参数 Vcode, 整数型, , 识别结果
    .参数 ImgPath, 整数型, , 

.DLL命令 lstrcpyn_Rect, 整数型, "kernel32.dll", "lstrcpyn", , 
    .参数 欲取其指针, Rect, 传址, 
    .参数 欲取其指针, Rect, 传址, 
    .参数 保留, 整数型, , 0

.DLL命令 FreeAllCdsFile, 空白型, "AntiVC.dll", "FreeAllCdsFile", , 

.DLL命令 GetVarPtr_文本型, 整数型, "AntiVC.dll", "GetVarPtr", , 
    .参数 传递参数, 文本型, , 

.DLL命令 GetVarPtr_字节集, 整数型, "AntiVC.dll", "GetVarPtr", , 
    .参数 传递参数, 字节集, , 

.窗口程序集 主界面程序集, , , 

.程序集变量 本地文件列表, 文本型, , "0", 
.程序集变量 本地文件索引, 整数型, , , 
.程序集变量 线程句柄, 整数型, , , 
.程序集变量 位图数据, 字节集, , , 
.程序集变量 图像长度, 整数型, , , 
.程序集变量 当前序号, 整数型, , , 
.程序集变量 工程文件, 未知类型0x30001, , , 
.程序集变量 ImageURL, 文本型, , , 
.程序集变量 识别库索引, 整数型, , , 
.程序集变量 总用时数, 整数型, , , 
.程序集变量 识别用时, 整数型, , , 
.程序集变量 总识别数, 整数型, , , 
.程序集变量 成功数, 整数型, , , 
.子程序 _按钮_图像识别_被单击, 空白型, , 
.局部变量 目录名, 文本型, , , 
.局部变量 文件名, 文本型, , , 

.如果 (不等于 (寻找文本 (.内容, “\”, , 假), -1)) ' 本地目录
    .如果真 (等于 (取数组成员数 (本地文件列表), 0)) ' 尚未获取文件列表
        赋值 (目录名, .内容)
        .如果真 (不等于 (取文本右边 (目录名, 1), “\”))
            赋值 (目录名, 相加 (目录名, “\”))
        .如果真结束
        赋值 (文件名, 寻找文件 (相加 (目录名, “*.*”), 32))
        .判断循环首 (不等于 (文件名, “”))
            .如果真 (并且 (不等于 (文件名, “.”), 不等于 (文件名, “..”)))
                加入成员 (本地文件列表, 相加 (目录名, 文件名))
            .如果真结束
            赋值 (文件名, 寻找文件 ())
        .判断循环尾 ()
        .如果真 (等于 (取数组成员数 (本地文件列表), 0))
            信息框 (“在指定地址没有找到任何文件。”, 相加 (#确认钮, #警告图标), “请检查输入”)
            返回 ()
        .如果真结束
        
    .如果真结束
    未知支持库函数_0 (&FromBuffer, 1, 线程句柄)
.否则
    未知支持库函数_0 (&FromBuffer, 0, 线程句柄)
.如果结束

赋值 (.禁止, 真)

.子程序 显示图片, 空白型, , 
.参数 载入图像, 字节集, , 

.局部变量 原始图像, 未知类型0x40001, , , 

原始图像.未知支持库函数_4 (载入图像, #)
原始图像.未知支持库函数_6 (位图数据, #)
赋值 (.图片, 位图数据)

.子程序 FromBuffer, 空白型, , 
.参数 文件索引, 整数型, , 

.局部变量 识别结果, 文本型, , , 
.局部变量 图像数据, 字节集, , , 
.局部变量 图像地址, 文本型, , , 
.局部变量 目录名, 文本型, , , 
.局部变量 时间, 整数型, , , 

.如果 (等于 (文件索引, 0))
    赋值 (图像数据, 未知支持库函数_7 (.内容))
.否则
    赋值 (本地文件索引, 相加 (本地文件索引, 1))
    .如果真 (大于 (本地文件索引, 取数组成员数 (本地文件列表)))
        赋值 (本地文件索引, 1)
    .如果真结束
    赋值 (图像数据, 读入文件 (本地文件列表 [本地文件索引]))
.如果结束

显示图片 (图像数据)

赋值 (时间, 取启动时间 ())

赋值 (识别结果, 取空白文本 (32))

.如果 (GetVcodeFromBuffer (识别库索引, 图像数据, 取字节集长度 (图像数据), 识别结果))
    连续赋值 (假, ., .)
    .清除 ()
    0.定位写出 (0, 识别结果)
    赋值 (识别用时, 相减 (取启动时间 (), 时间))
    0.置文本 (相加 (“识别用时:”, 到文本 (识别用时), “毫秒”))
.否则
    0.置文本 (“识别验证码图像失败！”)
.如果结束

赋值 (.禁止, 假)

.子程序 _按钮_载入图像_被单击, 空白型, , 
.局部变量 格式, 文本型, , , 
.局部变量 图像数据, 字节集, , , 
.局部变量 时间, 整数型, , , 
.局部变量 识别结果, 文本型, , , 
.局部变量 文件名, 文本型, , , 
.局部变量 varptr, 整数型, , , 

赋值 (.类型, 0)
赋值 (.过滤器, “BMP格式(*.bmp)|*.bmp|JPG格式(*.jpg)|*.jpg|GIF格式(*.gif)|*.gif|PNG格式(*.png)|*.png|TIF格式(*.tif)|*.tif|所有文件(*.*)|*.*”)
赋值 (.初始目录, 取运行目录 ())
赋值 (.标题, “指定要载入的图片路径”)
.如果真 (打开 ())
    赋值 (文件名, .文件名)
    
    赋值 (图像数据, 读入文件 (文件名))
    赋值 (位图数据, 图像数据)
    
    显示图片 (图像数据)
    
    赋值 (时间, 取启动时间 ())
    
    赋值 (识别结果, 取空白文本 (32))
    .如果 (GetVcodeFromBuffer (识别库索引, 图像数据, 取字节集长度 (图像数据), 识别结果))
        .清除 ()
        0.定位写出 (0, 识别结果)
        0.置文本 (相加 (“识别用时:”, 到文本 (相减 (取启动时间 (), 时间)), “毫秒”))
    .否则
        0.置文本 (“识别验证码图像失败！”)
    .如果结束
    
    赋值 (.禁止, 假)
.如果真结束


.子程序 _按钮_指定路径_被单击, 空白型, , 
赋值 (.类型, 0)
赋值 (.过滤器, “识别库(*.cds)|*.cds|所有文件(*.*)|*.*”)
赋值 (.初始目录, 相加 (取运行目录 (), “\Output”))
赋值 (.标题, “指定识别库所在路径”)
.如果真 (打开 ())
    赋值 (.内容, .文件名)
.如果真结束


.子程序 _超级按钮_标记正确_被单击, 空白型, , 2010.9.15
赋值 (总用时数, 相加 (总用时数, 识别用时))
赋值 (总识别数, 相加 (总识别数, 1))
赋值 (成功数, 相加 (成功数, 1))
连续赋值 (真, ., .)

.子程序 _超级按钮_标记失败_被单击, 空白型, , 2010.9.15
赋值 (总用时数, 相加 (总用时数, 识别用时))
赋值 (总识别数, 相加 (总识别数, 1))
连续赋值 (真, ., .)

.子程序 _超级按钮_识别统计_被单击, 空白型, , 2010.9.15
.局部变量 平均速度, 整数型, , , 
.局部变量 成功率, 小数型, , , 

赋值 (平均速度, 相除 (总用时数, 总识别数))
赋值 (成功率, 四舍五入 (相除 (相乘 (成功数, 100), 总识别数), 2))
信息框 (相加 (“当前验证码项目识别概率统计如下：”, #换行符, “平均识别用时：”, 到文本 (平均速度), “毫秒”, #换行符, “识别次数：”, 到文本 (总识别数), #换行符, “成功次数：”, 到文本 (成功数), #换行符, “错误次数：”, 到文本 (相减 (总识别数, 成功数)), #换行符, “识别概率：”, 到文本 (成功率), “%”), 相加 (#信息图标, #确认钮), “项目统计”)

.子程序 _按钮_载入识别库_被单击, 空白型, , 
.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“请先选择识别库文件，并输入识别库密码”, 0, “提示”)
    返回 ()
.如果真结束

赋值 (.禁止, 真)
赋值 (识别库索引, LoadCdsFromFile (.内容, .内容))

.如果 (不等于 (识别库索引, -1))
    0.置文本 (“载入识别库文件成功。”)
.否则
    0.置文本 (“载入识别库文件失败。”)
.如果结束
清除数组 (本地文件列表)

赋值 (.禁止, 假)

.子程序 __启动窗口_创建完毕, 空白型, , 



 ' 不属于任何一个程序集、类模块的函数：
