 ' 文件类型：Windows窗口程序

 ' 程序名称：黑吧专用S扫描器
 ' 程序描述：黑吧专用S扫描器
 ' 程序作者：%systemroot%
 ' 邮政编码：
 ' 联系地址：江苏淮安
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：anlyroot@163.com
 ' 主页地址：
 ' 版权声明：QQ:76524999
 ' 版本号：1.1
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 390
    高度 = 395
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\fCTVSTwH.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “GUI版S扫描器”
    帮助文件名 = “”

窗口 说明窗口
    左边 = 50
    顶边 = 50
    宽度 = 300
    高度 = 275
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.图片 a1, " ' 已保存到：D:\易语言学习\Data\fCTVSTwH.e\a1", , 
.图片 a2, " ' 已保存到：D:\易语言学习\Data\fCTVSTwH.e\a2", , 
.图片 a3, " ' 已保存到：D:\易语言学习\Data\fCTVSTwH.e\a3", , 
.图片 a4, " ' 已保存到：D:\易语言学习\Data\fCTVSTwH.e\a4", , 
.声音 S扫描, " ' 已保存到：D:\易语言学习\Data\fCTVSTwH.e\S扫描", 公开, S扫描器　'此文件杀软可能报毒.可另行找免杀过的s.exe导入


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 5 系统核心支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' sock A6B983789F624b2cBDFD7D671249C097 1 0 网络通讯支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库
 ' edroptarget {9DA96BF9CEBD45c5BFCF94CBE61671F5} 1 0 拖放支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库





.DLL命令 API过虑, 整数型, "", "SendMessageA", , 
    .参数 窗口句柄, 整数型, , 
    .参数 信息值, 整数型, , 
    .参数 参数一, 整数型, , 
    .参数 参数二, 文本型, , 

.DLL命令 取信息表, 整数型, "IPhlpAPI", "GetIfTable", , 
    .参数 pIfRowTable, 字节集, 传址, 
    .参数 pdwSize, 整数型, 传址, 
    .参数 bOrder, 整数型, , 

.DLL命令 取信息长, 整数型, "IPhlpAPI", "GetIfTable", , 
    .参数 pIfRowTable, 整数型, , 
    .参数 pdwSize, 整数型, 传址, 
    .参数 bOrder, 整数型, , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 图标列, 字节集, , "4", 
.程序集变量 本机, 文本型, , "0", 
.子程序 __启动窗口_创建完毕, 空白型, , '源码2008-9-15放出
.局部变量 返回值, 整数型, , , 

赋值 (_启动窗口., 相减 (相加 (_启动窗口., 378), 取用户区高度 ()))
赋值 (_启动窗口., 相减 (相加 (_启动窗口., 390), 取用户区宽度 ()))
 ' 写到文件 (“s.exe”, #S扫描) 　注：此文件暂时不写出,杀软报毒（而且我也不想让人骂～）
置文件属性 (“s.exe”, 2)
设置所有 ()
赋值 (本机, 未知支持库函数_17 ())
.如果 (大于 (取数组成员数 (本机), 1))
    赋值 (_启动窗口., 相加 (“GUI版S扫描器”, “   本机IP: ”, 本机 [2]))
.否则
    赋值 (_启动窗口., 相加 (“GUI版S扫描器”, “   本机IP: ”, 本机 [1]))
.如果结束
赋值 (., 真)
取窗口句柄 ().未知支持库函数_0 ()
赋值 (.标题, “启动完毕!”)
.判断开始 (文件是否存在 (相加 (取当前目录 (), “\Result.txt”)))
    赋值 (返回值, 信息框 (相加 (“发现历史扫描结果，是否导入历史扫描结果？”, #换行符, “  选”, #左引号, “ 是”, #右引号, “ 导入，”, “选”, #左引号, “ 否”, #右引号, “ 删除，”, “或取消。”), 3, “提示”))
    .如果 (等于 (返回值, #是钮))
        赋值 (.内容, 取字节集数据 (读入文件 (相加 (取当前目录 (), “\Result.txt”)), 10, ))
    .否则
        .如果 (等于 (返回值, #否钮))
            删除文件 (相加 (取当前目录 (), “\Result.txt”))
        .否则
            .如果 (等于 (返回值, #取消钮))
                置随机数种子 ()
                文件更名 (相加 (取当前目录 (), “\Result.txt”), 相加 (到文本 (取随机数 (0, 1000)), “.bak.txt”))
            .否则
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.默认
    
.判断结束
 ' 即时内容.加入文本 (“ X----------------------------------------[” ＋ #换行符)
 ' 即时内容.加入文本 (“ ┆    黑客动画吧 http://www.hack58.com    ┆” ＋ #换行符)
 ' 即时内容.加入文本 (“ ┆                                        ┆” ＋ #换行符)
 ' 即时内容.加入文本 (“ ┆     致力于中国最专业的黑客安全站点     ┆” ＋ #换行符)
 ' 即时内容.加入文本 (“ ┆                                        ┆” ＋ #换行符)
 ' 即时内容.加入文本 (“ ┆         黑客动画吧，有你更精彩         ┆” ＋ #换行符)
 ' 即时内容.加入文本 (“ ^----------------------------------------a” ＋ #换行符)
 ' 快两年了，这是刚接触E的时候写的.后来源码打不开了，一打开就自动关闭
 ' 再后来也一直没再看，今天找出来看看能打开了，源码放出...　...

.子程序 _SYN按钮_被单击, 空白型, , 
.如果 (并且 (不等于 (., “”), 不等于 (., “”), 不等于 (.内容, “”)))
    .如果 (等于 (.禁止, 真))
        运行 (相加 (“s.exe”, “ ”, “syn”, “ ”, ., “ ”, ., “ ”, .内容, “ ”, “/save”), 假, 1)
        赋值 (.时钟周期, 100)
        赋值 (.内容, “正在使用SYN方式高速扫描中,请稍等...............”)
    .否则
        信息框 (相加 (“请等待扫描结束后”, #换行符, “ 再进行其它扫描!”), 64, “正在扫描...”)
    .如果结束
    
.否则
    赋值 (.标题, “请输入正确信息!”)
    信息框 (“请输入开始、结束IP地址及端口号!”, 0, )
.如果结束


.子程序 _TCP按钮_被单击, 空白型, , 
.如果 (并且 (不等于 (., “”), 不等于 (., “”), 不等于 (.内容, “”), 不等于 (.内容, “”)))
    .如果 (等于 (.禁止, 真))
        运行 (相加 (“s.exe”, “ ”, “tcp”, “ ”, ., “ ”, ., “ ”, .内容, “ ”, .内容, “ ”, “/save”), 假, 1)
        赋值 (.时钟周期, 100)
        赋值 (.内容, 相加 (#换行符, “正在使用TCP方式高速扫描中,请稍等...............”))
    .否则
        信息框 (相加 (“请等待扫描结束后”, #换行符, “ 再进行其它扫描!”), 64, “正在扫描...”)
    .如果结束
    
.否则
    赋值 (.标题, “请输入正确信息!”)
    信息框 (“请输入开始、结束IP地址、端口号及线程数!”, 0, )
.如果结束


.子程序 _清空删除_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    删除文件 (相加 (取当前目录 (), “\Result.txt”))
    赋值 (.标题, “文件删除成功!”)
    赋值 (.选中, 假)
    赋值 (.标题, “清空(&S)”)
.否则
    赋值 (.内容, “”)
    赋值 (.标题, “清空操作完成!”)
.如果结束


.子程序 __启动窗口_将被销毁, 空白型, , 
删除文件 (“s.exe”)

.子程序 _更多按钮_被单击, 空白型, , 
赋值 (.标题, “选择更多!”)
弹出菜单 ()

.子程序 _总在最上面_被选择, 空白型, , 
.如果 (等于 (.选中, 假))
    赋值 (.选中, 真)
    赋值 (_启动窗口., 真)
.否则
    赋值 (.选中, 真)
    赋值 (.选中, 假)
    赋值 (_启动窗口., 假)
.如果结束
赋值 (.标题, “设置成功!”)

.子程序 _命令行_被选择, 空白型, , 
运行 (“cmd.exe”, 假, )
赋值 (.标题, “运行命令行”)

.子程序 _记事本_被选择, 空白型, , 
运行 (“notepad.exe”, 假, )
赋值 (.标题, “打开记事本”)

.子程序 _计算器_被选择, 空白型, , 
运行 (“calc.exe”, 假, )
赋值 (.标题, “打开计算器”)

.子程序 _任务管理器_被选择, 空白型, , 
运行 (“taskmgr.exe”, 假, )
赋值 (.标题, “任务管理器”)

.子程序 _计算机管理_被选择, 空白型, , 
未知支持库函数_6 (“compmgmt.msc”, , )
赋值 (.标题, “计算机管理”)

.子程序 _本机用户和组_被选择, 空白型, , 
未知支持库函数_6 (“lusrmgr.msc”, , )
赋值 (.标题, “本机用户和组”)

.子程序 _本地服务设置_被选择, 空白型, , 
未知支持库函数_6 (“services.msc”, , )
赋值 (.标题, “本地服务设置”)

.子程序 _本地组策略_被选择, 空白型, , 
未知支持库函数_6 (“gpedit.msc”, , )
赋值 (.标题, “本地组策略”)

.子程序 _注册表编辑器_被选择, 空白型, , 
运行 (“regedit.exe”, 假, )
赋值 (.标题, “注册表编辑器”)

.子程序 _打开控制面板_被选择, 空白型, , 
运行 (“rundll32.exe shell32.dll,Control_RunDLL”, 假, )
赋值 (.标题, “打开控制面板”)

.子程序 _打开intenet属性面板_被选择, 空白型, , 
运行 (“rundll32.exe shell32.dll,Control_RunDLL Inetcpl.cpl”, 假, )
赋值 (.标题, “打开intenet属性面板”)

.子程序 _打开显示属性面板_被选择, 空白型, , 
运行 (“rundll32.exe shell32.dll,Control_RunDLL desk.cpl”, 假, )
赋值 (.标题, “打开显示属性面板”)

.子程序 _图片框1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _取本机IP地址_被选择, 空白型, , 
.如果 (大于 (取数组成员数 (本机), 1))
    置剪辑板文本 (本机 [2])
    信息框 (“已复制到剪贴板”, 0, )
.否则
    置剪辑板文本 (本机 [1])
    信息框 (“已复制到剪贴板”, 0, )
.如果结束
赋值 (.标题, “IP成功复制到剪贴板”)

.子程序 _执行状态_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _专用_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _关于程序_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _打开扫描结果_被选择, 空白型, , 
.判断开始 (文件是否存在 (相加 (取当前目录 (), “\Result.txt”)))
    未知支持库函数_6 (相加 (取当前目录 (), “\Result.txt”), , )
    赋值 (.标题, “查看扫描结果..”)
.默认
    赋值 (.标题, “文件不存在”)
.判断结束


.子程序 _清除扫描文件_被选择, 空白型, , 
.如果真 (等于 (信息框 (“确认清除扫描结果?”, 4, “提示”), #是钮))
    删除文件 (相加 (取当前目录 (), “\Result.txt”))
    赋值 (.标题, “删除扫描结果成功!”)
.如果真结束
返回 ()

.子程序 _拖放对象_得到文件, 空白型, , 
.参数 接收到的文件路径, 文本型, , 

.局部变量 I, 文本型, , , 

赋值 (I, 接收到的文件路径)
赋值 (.内容, 到文本 (读入文件 (I)))
赋值 (.标题, “载入文件成功!”)

.子程序 _整理按钮_被单击, 空白型, , 
.局部变量 正则表达式, 对象, , , 
.局部变量 IP列表对象, 对象, , , 
.局部变量 IP对象, 对象, , , 
.局部变量 源文本, 文本型, , , 
.局部变量 总数, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 IP列表, 文本型, , , 
.局部变量 过虑文本, 文本型, , "0", 
.局部变量 x, 整数型, , , 
.局部变量 y, 整数型, , , 
.局部变量 临时文件, 文本型, , , 

.如果 (不等于 (.内容, “”))
    .如果真 (等于 (正则表达式.创建 (“VBScript.RegExp”, ), 假))
        信息框 (“创建VBScript.RegExp失败”, 0, )
        返回 ()
    .如果真结束
    正则表达式.写属性 (“IgnoreCase”, 真)
    正则表达式.写属性 (“Global”, 真)
    正则表达式.写属性 (“Pattern”, “\d+([-+.]\d+)*.\d+([-.]\d+)*\.\d+([-.]\d+)*”)
    赋值 (源文本, .内容)
    赋值 (IP列表对象, 正则表达式.对象型方法 (“Execute”, 源文本))
    
    赋值 (总数, IP列表对象.读数值属性 (“Count”, ))
    .计次循环首 (总数, i)
        赋值 (IP对象, IP列表对象.读对象型属性 (“Item”, 相减 (i, 1)))
        赋值 (IP列表, 相加 (IP列表, IP对象.读文本属性 (“Value”, ), #换行符))
    .计次循环尾 ()
    赋值 (.内容, IP列表)
    
    .如果真 (等于 (.选中, 真))
        赋值 (临时文件, .内容)
        赋值 (.内容, “”)
        清空 ()
        赋值 (过虑文本, 分割文本 (临时文件, #换行符, ))
        .计次循环首 (取数组成员数 (过虑文本), x)
            .如果真 (等于 (API过虑 (取窗口句柄 (), 344, 0, 过虑文本 [x]), -1))
                过虑文本.加入项目 ( [x], )
                相加 (过虑文本 [x], #换行符).加入文本 ()
                赋值 (y, 相加 (y, 1))
                
            .如果真结束
            
        .计次循环尾 ()
    .如果真结束
    赋值 (.标题, “整理完成!”)
.否则
    赋值 (.标题, “无整理内容!”)
.如果结束


.子程序 _保存按钮_被单击, 空白型, , 
.如果 (不等于 (.内容, “”))
    赋值 (.类型, 1)
    赋值 (.标题, “请选择保存位置”)
    赋值 (.过滤器, “文本文件(TXT)|*.TXT|所有文件(*.*)|*.*”)
    赋值 (.默认文件后缀, “TXT”)
    .如果真 (打开 ())
        写到文件 (.文件名, 到字节集 (.内容))
        赋值 (.标题, “文件保存成功!”)
        信息框 (“文件保存成功!”, 0, )
    .如果真结束
    
.否则
    赋值 (.标题, “无保存内容!”)
.如果结束


.子程序 _清空按钮_被单击, 空白型, , 
.如果 (不等于 (.内容, “”))
    赋值 (.内容, “”)
    赋值 (.标题, “内容已清空!”)
.否则
    赋值 (.标题, “无清理内容!”)
.如果结束


.子程序 设置所有, 空白型, , 
.局部变量 i, 空白型, , , 

.计次循环首 (4, i)
    赋值 (图标列 [i], 多项选择 (i, #a1, #a2, #a3, #a4))
.计次循环尾 ()

.子程序 _流量时钟_周期事件, 空白型, , 
.局部变量 接收字节数, 空白型, , , 
.局部变量 发送字节数, 空白型, , , 
.局部变量 上速, 空白型, 静态, , 
.局部变量 下速, 空白型, 静态, , 
.局部变量 当前图标, 字节集, , , 
.局部变量 信息长度, 整数型, , , 
.局部变量 临时缓存, 整数型, , , 
.局部变量 下载, 逻辑型, , , 
.局部变量 上传, 逻辑型, , , 
.局部变量 缓冲, 字节集, , , 
.局部变量 X, 整数型, , , 

赋值 (临时缓存, 取信息长 (0, 信息长度, 0))
.如果真 (等于 (临时缓存, 50))
    返回 ()
.如果真结束
赋值 (缓冲, 取空白字节集 (信息长度))
赋值 (临时缓存, 取信息表 (缓冲, 信息长度, 0))
.如果真 (等于 (临时缓存, 0))
    赋值 (X, 取字节集数据 (取字节集中间 (缓冲, 1381, 4), 3))
    赋值 (接收字节数, 取字节集数据 (取字节集中间 (缓冲, 1417, 4), 3))
    赋值 (发送字节数, 取字节集数据 (取字节集中间 (缓冲, 1441, 4), 3))
    赋值 (.标题, 数值到格式文本 (相除 (发送字节数, 1024), 0, 真))
    赋值 (.标题, 数值到格式文本 (相除 (接收字节数, 1024), 0, 真))
    赋值 (下载, 大于 (接收字节数, 下速))
    赋值 (上传, 大于 (发送字节数, 上速))
    .如果真 (或者 (大于 (上速, 0), 大于 (下速, 0)))
        赋值 (上速, 相减 (发送字节数, 上速))
        赋值 (下速, 相减 (接收字节数, 下速))
    .如果真结束
    赋值 (.标题, 相加 (数值到格式文本 (相除 (相乘 (4, 上速), 1024), 3, 真), “KB/s”))
    赋值 (.标题, 相加 (数值到格式文本 (相除 (相乘 (4, 下速), 1024), 3, 真), “KB/s”))
    赋值 (上速, 发送字节数)
    赋值 (下速, 接收字节数)
    .判断开始 (并且 (下载, 上传))
        赋值 (当前图标, 图标列 [4])
    .判断 (并且 (取反 (下载), 上传))
        赋值 (当前图标, 图标列 [3])
    .判断 (并且 (下载, 取反 (上传)))
        赋值 (当前图标, 图标列 [2])
    .默认
        赋值 (当前图标, 图标列 [1])
    .判断结束
    赋值 (.图片, 当前图标)
.如果真结束


.子程序 _进程时钟_周期事件, 空白型, , 
.局部变量 进程, 未知类型0x70009, , "0", 
.局部变量 存在, 逻辑型, , , 
.局部变量 变量, 整数型, , , 

赋值 (.禁止, 假)
赋值 (.可视, 真)
赋值 (.可视, 真)
赋值 (进程, 未知支持库函数_10 ())
赋值 (存在, 假)
.计次循环首 (取数组成员数 (进程), 变量)
    .如果真 (等于 (进程 [变量], , “s.exe”))
        赋值 (存在, 真)
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
.如果真 (取反 (存在))
    赋值 (.时钟周期, 0)
    赋值 (.禁止, 真)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.标题, “扫描完成!”)
    信息框 (“扫描完成!”, 0, )
    赋值 (.内容, 取字节集数据 (读入文件 (相加 (取当前目录 (), “\Result.txt”)), 10, ))
    .如果 (等于 (.选中, 真))
        _整理按钮_被单击 ()
    .否则
        赋值 (.标题, “成功载入扫描结果!”)
    .如果结束
    
.如果真结束


.子程序 _删除文件选择框_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.标题, “删除(&D)”)
.否则
    赋值 (.标题, “清空(&S)”)
.如果结束


.子程序 _关闭按钮_被单击, 空白型, , 
.如果真 (等于 (.禁止, 假))
    .如果 (等于 (信息框 (“程序正在扫描中,请确认是否关闭?”, 4, “提示:”), #是钮))
        未知支持库函数_11 (“s.exe”)
    .否则
        返回 ()
    .如果结束
    
.如果真结束
销毁 ()

.子程序 _专用_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.标题, “关于程序”)
载入 (说明窗口, _启动窗口, 假)

.子程序 _停止按钮_被单击, 空白型, , 
未知支持库函数_11 (“s.exe”)

.子程序 _过滤选择框_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.标题, “启用过虑IP重复.”)
.否则
    赋值 (.标题, “关闭过虑IP重复.”)
.如果结束


.子程序 _自动整理选择框_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.标题, “启用自动整理.”)
.否则
    赋值 (.标题, “关闭自动整理.”)
.如果结束


.子程序 __启动窗口_可否被关闭, 逻辑型, , 
.如果真 (等于 (.禁止, 假))
    .如果 (等于 (信息框 (“程序正在扫描中,请确认是否关闭?”, 4, “提示:”), #是钮))
        未知支持库函数_11 (“s.exe”)
    .否则
        返回 (假)
    .如果结束
    
.如果真结束


.子程序 _开始IP按钮_被单击, 空白型, , 
赋值 (., 取剪辑板文本 ())

.子程序 _结束IP按钮_被单击, 空白型, , 
赋值 (., 取剪辑板文本 ())

.窗口程序集 窗口程序集2, , , 

.子程序 _按钮1_被单击, 空白型, , '源码2008-9-15放出
销毁 ()

.子程序 _时钟_周期事件, 空白型, , 
赋值 (.位置, 相加 (.位置, 1))
.如果真 (大于 (.位置, .最大位置))
    销毁 ()
.如果真结束



 ' 不属于任何一个程序集、类模块的函数：
