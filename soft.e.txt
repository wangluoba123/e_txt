 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 806
    高度 = 615
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\soft.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “股市辅助工具”
    帮助文件名 = “”

窗口 窗口大盘数据添加删除
    左边 = 50
    顶边 = 50
    宽度 = 302
    高度 = 279
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\soft.e\窗口大盘数据添加删除_图标.ico
    背景音乐 =  ' 空
    标题 = “上证大盘数据修改(添加)”
    帮助文件名 = “”

窗口 窗口价格和涨跌幅计算
    左边 = 50
    顶边 = 50
    宽度 = 369
    高度 = 326
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\soft.e\窗口价格和涨跌幅计算_图标.ico
    背景音乐 =  ' 空
    标题 = “买卖计算器”
    帮助文件名 = “”

窗口 窗口技术分析指标
    左边 = 50
    顶边 = 50
    宽度 = 734
    高度 = 529
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\soft.e\窗口技术分析指标_图标.ico
    背景音乐 =  ' 空
    标题 = “技术分析指标诠释”
    帮助文件名 = “”

窗口 窗口股市资料库
    左边 = 50
    顶边 = 50
    宽度 = 622
    高度 = 454
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\soft.e\窗口股市资料库_图标.ico
    背景音乐 =  ' 空
    标题 = “股市知识小贴士”
    帮助文件名 = “”

窗口 窗口大盘区段走势指示图
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 311
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “大盘区段走势指示图”
    帮助文件名 = “”

窗口 窗口在线升级
    左边 = 50
    顶边 = 50
    宽度 = 425
    高度 = 304
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 252
    底图方式 = 402718874
    底色 = 402718875 '  0x1801009B
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 402720038
    可否移动 = 假
    背景音乐播放次数 = 34
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 真
    帮助标志值 = 178
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = -71041348
    总在最前 = 真
    保持标题栏激活 = 真
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.常量 软件名称, "“股市辅助工具”", , 
.常量 软件版本, "“ v1.0”", , 
.常量 密匙, "“woyaobanben”", , 
.常量 大盘数据库名, "“\Database\DPdatabase.mdb”", , 
.常量 个股数据库路径, "“\Database\”", , 
.常量 pwd, "“krnln.fnr”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 2 6 扩展界面支持库三
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' iext21 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' ExtMenu 9909FBB013704cfa8FE7E739DB7172DE 1 6 超级菜单支持库
 ' EChartBar 9A3F84D7FDEB4a0486F2711D5104B7F7 1 6 数据图表支持库
 ' eDB 46E94341933A462383A4DE26B146322C 1 4 数据库操作支持库
 ' ADODB {EF0A0A93-05AC-4aec-884A-B65FB0FA135D} 2 0 ADODB数据驱动操作支持库




.全局变量 数据库连接, 未知类型0xA0001, , , 

.DLL命令 OBV, 文本型, "DatumDate.dll", "OBV", , 

.窗口程序集 主窗口程序集, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
未知支持库函数_0 (1)
赋值 (_启动窗口., 相加 (#软件名称, #软件版本))

赋值 (.最小日期, 到时间 (“2005年4月20日”))
赋值 (.最小日期, 到时间 (“2005年4月20日”))
.如果 (不等于 (读配置项 (相加 (取运行目录 (), “\config.ini”), “基础设置”, “同步显示查询曲线图”, ), “不同步”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束

.如果 (不等于 (读配置项 (相加 (取运行目录 (), “\config.ini”), “基础设置”, “显示曲线标注”, ), “显示”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束


.子程序 _按钮大盘查询_被单击, 空白型, , 
.如果 (大于 (取时间间隔 (.今天, .今天, #日), 120))
    信息框 (“查询范围超出，最大只能查询120天内记录！”, #警告图标, “提示：”)
    返回 ()
.否则
    .如果 (小于 (取时间间隔 (.今天, .今天, #日), 0))
        信息框 (“查询范围设置非法！”, #警告图标, “提示：”)
        返回 ()
    .否则
        
    .如果结束
    
.如果结束
赋值 (., 真)
赋值 (., 真)
赋值 (., 假)
读入大盘数据库 ()
赋值 (., 假)
赋值 (., 假)
赋值 (., 真)



.子程序 _超级列表框1_左键单击表项, 空白型, , 由于有些技术问题 没有解决这里先留着
.如果 (等于 (取表项数 (), 0))
    返回 ()
.否则
    
.如果结束
.如果真 (等于 (是否已创建 (窗口大盘数据添加删除), 假))
    载入 (窗口大盘数据添加删除, , 假)
.如果真结束
赋值 (窗口大盘数据添加删除..今天, 到时间 (.取标题 (., 0)))
赋值 (窗口大盘数据添加删除..内容, .取标题 (., 2))
赋值 (窗口大盘数据添加删除..内容, .取标题 (., 3))
赋值 (窗口大盘数据添加删除..内容, .取标题 (., 4))
赋值 (窗口大盘数据添加删除..内容, .取标题 (., 5))
赋值 (窗口大盘数据添加删除..内容, .取标题 (., 6))
赋值 (窗口大盘数据添加删除..内容, .取标题 (., 7))
赋值 (窗口大盘数据添加删除..内容, .取标题 (., 8))
赋值 (窗口大盘数据添加删除..内容, .取标题 (., 9))
赋值 (窗口大盘数据添加删除..内容, .取标题 (., 10))
赋值 (窗口大盘数据添加删除..内容, 到文本 (.取表项数值 (.)))
赋值 (窗口大盘数据添加删除..内容, 相加 (“星期”, .取标题 (., 1)))

.子程序 _股市交易计算工具_被选择, 空白型, , 
载入 (窗口价格和涨跌幅计算, , 假)


.子程序 _按钮大盘清空列表_被单击, 空白型, , 
全部删除 ()

.子程序 _按钮OBV_被单击, 空白型, , 
.如果真 (等于 (是否已创建 (窗口技术分析指标), 假))
    载入 (窗口技术分析指标, _启动窗口, 假)
.如果真结束
赋值 (窗口技术分析指标..内容, OBV ())


.子程序 OBV计算, 双精度小数型, , 
.参数 超级列表名称, 超级列表框, , 
.参数 列表项, 整数型, , 
.参数 收盘价数据列, 整数型, , 收盘价数据所在列
.参数 最低价数据列, 整数型, , 
.参数 最高价数据列, 整数型, , 
.参数 成交量数据列, 整数型, , 

.局部变量 VA, 整数型, , , VA为成交量多空比率净额值
.局部变量 H, 整数型, , , 为最高价
.局部变量 L, 整数型, , , 为最低价
.局部变量 V, 整数型, , , 为成交量
.局部变量 C, 整数型, , , 为收盘价

 ' 成交量多空比率净额法OBV.  VA = V × [（C - L）- （H - C）]/（H - C）  注意：以收盘价减去最低价（C - L），表示多头买进的力量强度。而最高价减去收盘价（H - C），表示空头卖出的力量强度。
赋值 (C, 到数值 (超级列表名称.取标题 (列表项, 收盘价数据列)))
赋值 (L, 到数值 (超级列表名称.取标题 (列表项, 最低价数据列)))
赋值 (H, 到数值 (超级列表名称.取标题 (列表项, 最高价数据列)))
赋值 (V, 到数值 (超级列表名称.取标题 (列表项, 成交量数据列)))
赋值 (VA, 相乘 (相除 (相减 (C, L, 相减 (H, C)), 相减 (H, C)), V))
返回 (VA)




.子程序 _大盘数据库维护_被选择, 空白型, , 
载入 (窗口大盘数据添加删除, _启动窗口, 假)


.子程序 _超级列表框1_右键单击表项, 空白型, , 
.如果 (等于 (取已选择表项数 (), 1))
    弹出菜单 ()
.否则
    
.如果结束



.子程序 _从数据库中删除选中数据_被选择, 空白型, , 
.局部变量 SQL, 文本型, , , 
.局部变量 句柄, 空白型, , , 

.如果 (等于 (信息框 (“您将永久删除数据，确定继续吗？”, 相加 (#询问图标, #是否钮), “询问：”), #否钮))
    返回 ()
.否则
    
.如果结束
赋值 (SQL, 相加 (“delete from 大盘数据 where id=”, 到文本 (.取表项数值 (.))))
.如果 (SQL.执行 ())
    .如果 (等于 (重新编号 (数据库连接, “大盘数据”, “ID”, “ID”), 真))
        信息框 (“删除成功”, 0, )
    .否则
        信息框 (“删除成功,排序失败”, 0, )
    .如果结束
    .删除表项 (.)
.否则
    信息框 (“删除失败”, 0, )
.如果结束
读入大盘数据库 ()



.子程序 _按钮分析选定指标_被单击, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 i2, 整数型, , , 
.局部变量 OBV最小值, 文本型, , , 

 ' 0、日期 1、星期 2、开盘 3、最高 4、最低 5、收盘 6、涨跌指数 7、涨幅 8、振幅 9、总手 10 总金额
.如果 (等于 (取表项数 (), 0))
    信息框 (“请先选择您需要计算的时间段，并查询以获得相应数据”, #警告图标, “警告：”)
    返回 ()
.否则
    .如果 (等于 (.选中, 真))
        赋值 (i2, 0)
        赋值 (OBV最小值, 取OBV最小数据 (5, 4, 3, 9))
        赋值 (., “OBV相对数据”)
        赋值 (., 取表项数 ())
        赋值 (., 1000)
        .计次循环首 (取表项数 (), i)
            处理事件 ()
            赋值 (., i2)
            赋值 (., 到文本 (取日 (到时间 (相减 (i, 1).取标题 (0)))))
            赋值 (., 四舍五入 (相除 (相减 (OBV计算 (相减 (i, 1), 5, 4, 3, 9), 到数值 (OBV最小值)), 100000), 3))
            赋值 (i2, 相加 (i2, 1))
        .计次循环尾 ()
    .否则
        
    .如果结束
    
.如果结束


.子程序 读入大盘数据库, 空白型, , 
.局部变量 记录, 整数型, , , 
.局部变量 序号, 整数型, , , 
.局部变量 索引, 整数型, , , 
.局部变量 序引, 文本型, , , 
.局部变量 基对时间, 日期时间型, , , 
.局部变量 最小时间, 日期时间型, , , 
.局部变量 最大时间, 日期时间型, , , 
.局部变量 i, 整数型, , , 
.局部变量 i2, 整数型, , , 
.局部变量 分时时间, 文本型, , , 
.局部变量 分时星期, 文本型, , , 

赋值 (.可视, 真)
赋值 (.可视, 真)
全部删除 ()
相加 (取运行目录 (), #大盘数据库名).打开MDB数据库 (#pwd, , )
赋值 (记录, “select * from 大盘数据”.查询 ())
记录.到首记录 ()
赋值 (序号, 1)
.判断循环首 (等于 (记录.尾记录后 (), 假))
    处理事件 ()
    赋值 (序引, 记录.读 (“时间”))
    赋值 (基对时间, 到时间 (取文本左边 (序引, 10)))
    赋值 (最小时间, 到时间 (转为普通时间 (.今天)))
    赋值 (最大时间, 到时间 (转为普通时间 (.今天)))
    .如果 (小于或等于 (取时间间隔 (最小时间, 基对时间, #日), 0))
        .如果 (大于或等于 (取时间间隔 (最大时间, 基对时间, #日), 0))
            赋值 (序引, 记录.读 (“时间”))
            赋值 (分时时间, 取文本左边 (序引, 10))
            赋值 (分时星期, 取文本右边 (序引, 2))
            赋值 (索引, .插入表项 (分时时间, , , , 序号))
             ' 超级列表框1.置标题 (超级列表框1.取表项数 () － 1, 0, 到文本 (序号))
             ' 超级列表框1.置标题 (索引, 0, )
            索引.置标题 (1, 分时星期)
            索引.置标题 (2, 到文本 (记录.读 (“开盘”)))
            索引.置标题 (3, 到文本 (记录.读 (“最高”)))
            索引.置标题 (4, 到文本 (记录.读 (“最低”)))
            索引.置标题 (5, 到文本 (记录.读 (“收盘”)))
            索引.置标题 (6, 到文本 (记录.读 (“涨跌”)))
            索引.置标题 (7, 到文本 (记录.读 (“涨幅%”)))
            索引.置标题 (8, 到文本 (记录.读 (“振幅%”)))
            索引.置标题 (9, 到文本 (记录.读 (“总手(万)”)))
            索引.置标题 (10, 到文本 (记录.读 (“金额(亿)”)))
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    记录.到后一记录 ()
    赋值 (序号, 相加 (序号, 1))
    刷新显示 ()
.判断循环尾 ()
记录.关闭记录集 ()

赋值 (.可视, 假)
赋值 (.可视, 假)

.如果 (等于 (.选中, 真))
    .如果 (不等于 (取表项数 (), 0))
        .如果真 (等于 (是否已创建 (窗口大盘区段走势指示图), 假))
            载入 (窗口大盘区段走势指示图, _启动窗口, 假)
            窗口大盘区段走势指示图.移动 (相减 (取屏幕高度 (), 窗口大盘区段走势指示图.取用户区高度 (), 60), , )
        .如果真结束
        
        赋值 (i2, 0)
        赋值 (窗口大盘区段走势指示图.., 取表项数 ())
        .计次循环首 (取表项数 (), i)
            处理事件 ()
            赋值 (窗口大盘区段走势指示图.., i2)
            赋值 (窗口大盘区段走势指示图.., 到文本 (取日 (到时间 (相减 (i, 1).取标题 (0)))))
            赋值 (窗口大盘区段走势指示图.., 到数值 (相减 (i, 1).取标题 (5)))
            赋值 (i2, 相加 (i2, 1))
        .计次循环尾 ()
        .如果 (大于或等于 (取表项数 (), 60))
            .如果真 (等于 (是否已创建 (窗口大盘区段走势指示图), 假))
                载入 (窗口大盘区段走势指示图, _启动窗口, 假)
                窗口大盘区段走势指示图.移动 (相减 (取屏幕高度 (), 窗口大盘区段走势指示图.取用户区高度 (), 60), , )
            .如果真结束
            赋值 (窗口大盘区段走势指示图..内容, 到文本 (计算平均值 (5, 5)))
            赋值 (窗口大盘区段走势指示图..内容, 到文本 (计算平均值 (5, 10)))
            赋值 (窗口大盘区段走势指示图..内容, 到文本 (计算平均值 (5, 30)))
            赋值 (窗口大盘区段走势指示图..内容, 到文本 (计算平均值 (5, 60)))
            赋值 (窗口大盘区段走势指示图..内容, 到文本 (计算平均值 (5, 取表项数 ())))
        .否则
            .如果 (并且 (大于 (取表项数 (), 30), 小于 (取表项数 (), 60)))
                .如果真 (等于 (是否已创建 (窗口大盘区段走势指示图), 假))
                    载入 (窗口大盘区段走势指示图, _启动窗口, 假)
                    窗口大盘区段走势指示图.移动 (相减 (取屏幕高度 (), 窗口大盘区段走势指示图.取用户区高度 (), 60), , )
                .如果真结束
                赋值 (窗口大盘区段走势指示图..内容, 到文本 (计算平均值 (5, 5)))
                赋值 (窗口大盘区段走势指示图..内容, 到文本 (计算平均值 (5, 10)))
                赋值 (窗口大盘区段走势指示图..内容, 到文本 (计算平均值 (5, 30)))
                赋值 (窗口大盘区段走势指示图..内容, “天数不足”)
                赋值 (窗口大盘区段走势指示图..背景颜色, #红色)
                赋值 (窗口大盘区段走势指示图..内容, 到文本 (计算平均值 (5, 取表项数 ())))
            .否则
                .如果 (并且 (大于 (取表项数 (), 10), 小于 (取表项数 (), 30)))
                    .如果真 (等于 (是否已创建 (窗口大盘区段走势指示图), 假))
                        载入 (窗口大盘区段走势指示图, _启动窗口, 假)
                        窗口大盘区段走势指示图.移动 (相减 (取屏幕高度 (), 窗口大盘区段走势指示图.取用户区高度 (), 60), , )
                    .如果真结束
                    赋值 (窗口大盘区段走势指示图..内容, 到文本 (计算平均值 (5, 5)))
                    赋值 (窗口大盘区段走势指示图..内容, 到文本 (计算平均值 (5, 10)))
                    赋值 (窗口大盘区段走势指示图..内容, “天数不足”)
                    赋值 (窗口大盘区段走势指示图..背景颜色, #红色)
                    赋值 (窗口大盘区段走势指示图..内容, “天数不足”)
                    赋值 (窗口大盘区段走势指示图..背景颜色, #红色)
                    赋值 (窗口大盘区段走势指示图..内容, 到文本 (计算平均值 (5, 取表项数 ())))
                .否则
                    .如果 (并且 (大于 (取表项数 (), 5), 小于 (取表项数 (), 10)))
                        .如果真 (等于 (是否已创建 (窗口大盘区段走势指示图), 假))
                            载入 (窗口大盘区段走势指示图, _启动窗口, 假)
                            窗口大盘区段走势指示图.移动 (相减 (取屏幕高度 (), 窗口大盘区段走势指示图.取用户区高度 (), 60), , )
                        .如果真结束
                        赋值 (窗口大盘区段走势指示图..内容, 到文本 (计算平均值 (5, 5)))
                        赋值 (窗口大盘区段走势指示图..内容, “天数不足”)
                        赋值 (窗口大盘区段走势指示图..背景颜色, #红色)
                        赋值 (窗口大盘区段走势指示图..内容, “天数不足”)
                        赋值 (窗口大盘区段走势指示图..背景颜色, #红色)
                        赋值 (窗口大盘区段走势指示图..内容, “天数不足”)
                        赋值 (窗口大盘区段走势指示图..背景颜色, #红色)
                        赋值 (窗口大盘区段走势指示图..内容, 到文本 (计算平均值 (5, 取表项数 ())))
                    .否则
                        .如果 (并且 (大于 (取表项数 (), 0), 小于 (取表项数 (), 5)))
                            .如果真 (等于 (是否已创建 (窗口大盘区段走势指示图), 假))
                                载入 (窗口大盘区段走势指示图, _启动窗口, 假)
                                窗口大盘区段走势指示图.移动 (相减 (取屏幕高度 (), 窗口大盘区段走势指示图.取用户区高度 (), 60), , )
                            .如果真结束
                            赋值 (窗口大盘区段走势指示图..内容, “天数不足”)
                            赋值 (窗口大盘区段走势指示图..背景颜色, #红色)
                            赋值 (窗口大盘区段走势指示图..内容, “天数不足”)
                            赋值 (窗口大盘区段走势指示图..背景颜色, #红色)
                            赋值 (窗口大盘区段走势指示图..内容, “天数不足”)
                            赋值 (窗口大盘区段走势指示图..背景颜色, #红色)
                            赋值 (窗口大盘区段走势指示图..内容, “天数不足”)
                            赋值 (窗口大盘区段走势指示图..背景颜色, #红色)
                            赋值 (窗口大盘区段走势指示图..内容, 到文本 (计算平均值 (5, 取表项数 ())))
                        .否则
                            
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .否则
        
    .如果结束
    
.否则
    
.如果结束




.子程序 _不显示曲线表标注_被选择, 空白型, , 
.如果 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\config.ini”), “基础设置”, “显示曲线标注”, “显示”)
    赋值 (.选中, 假)
.否则
    写配置项 (相加 (取运行目录 (), “\config.ini”), “基础设置”, “显示曲线标注”, “不显示”)
    赋值 (.选中, 真)
.如果结束


.子程序 __启动窗口_可否被关闭, 逻辑型, , 
未知支持库函数_16 ()
关闭 ()



.子程序 _删除当前列表选中显示_被选择, 空白型, , 
.如果 (等于 (信息框 (“仅删除当前显示项目，并不真正删除数据，确定继续吗？”, 相加 (#询问图标, #是否钮), “询问：”), #否钮))
    返回 ()
.否则
    .删除表项 (.)
.如果结束


.子程序 _查询同步显示曲线图_被选择, 空白型, , 
.如果 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\config.ini”), “基础设置”, “同步显示查询曲线图”, “不同步”)
    赋值 (.选中, 假)
    赋值 (.禁止, 真)
.否则
    写配置项 (相加 (取运行目录 (), “\config.ini”), “基础设置”, “同步显示查询曲线图”, “同步”)
    赋值 (.选中, 真)
    赋值 (.禁止, 假)
.如果结束



.子程序 _查询数据在数据库中ID_被选择, 空白型, , 
信息框 (.取表项数值 (.), #信息图标, “提示：”)


.子程序 更新, 空白型, , 
.局部变量 SQL, 文本型, , , 
.局部变量 记录, 整数型, , , 

.判断开始 (等于 (窗口大盘数据添加删除..内容, “”))
    信息框 (“振动幅度内容不能为空！”, #警告图标, “警告：”)
    返回 ()
.判断 (等于 (窗口大盘数据添加删除..内容, “”))
    信息框 (“最低指数内容不能为空！”, #警告图标, “警告：”)
    返回 ()
.判断 (等于 (窗口大盘数据添加删除..内容, “”))
    信息框 (“最高指数内容不能为空！”, #警告图标, “警告：”)
    返回 ()
.判断 (等于 (窗口大盘数据添加删除..内容, “”))
    信息框 (“涨跌幅度内容不能为空！”, #警告图标, “警告：”)
    返回 ()
.判断 (等于 (窗口大盘数据添加删除..内容, “”))
    信息框 (“开盘指数内容不能为空！”, #警告图标, “警告：”)
    返回 ()
.判断 (等于 (窗口大盘数据添加删除..内容, “”))
    信息框 (“收盘指数内容不能为空！”, #警告图标, “警告：”)
    返回 ()
.判断 (等于 (窗口大盘数据添加删除..内容, “”))
    信息框 (“大盘涨跌指数内容不能为空！”, #警告图标, “警告：”)
    返回 ()
.判断 (等于 (窗口大盘数据添加删除..内容, “”))
    信息框 (“大盘成交金额内容不能为空！”, #警告图标, “警告：”)
    返回 ()
.判断 (等于 (窗口大盘数据添加删除..内容, “”))
    信息框 (“大盘成交总手内容不能为空！”, #警告图标, “警告：”)
    返回 ()
.判断 (等于 (窗口大盘数据添加删除..内容, “”))
    信息框 (“大盘ID内容不能为空！”, #警告图标, “警告：”)
    返回 ()
    
.默认
    
.判断结束
相加 (取运行目录 (), #大盘数据库名).打开MDB数据库 (#pwd, , )

赋值 (SQL, 相加 (“update 大盘数据 set 时间='”, 处理时间数据 (), “',开盘='”, 窗口大盘数据添加删除..内容, “',最高='”, 窗口大盘数据添加删除..内容, “',最低='”, 窗口大盘数据添加删除..内容, “',收盘='”, 窗口大盘数据添加删除..内容, “',涨跌='”, 窗口大盘数据添加删除..内容, “',涨幅%='”, 窗口大盘数据添加删除..内容, “',振幅%='”, 窗口大盘数据添加删除..内容, “',总手(万)='”, 窗口大盘数据添加删除..内容, “',金额(亿)='”, 窗口大盘数据添加删除..内容, “'where ID= ”, 到文本 (相加 (.取表项数值 (.), 1))))

 ' 输出调试文本 (SQL)

.如果 (SQL.执行 ())
    信息框 (“修改成功”, 64, “提示”)
    窗口大盘数据添加删除.销毁 ()
.否则
    信息框 (“修改失败”, #警告图标, “提示”)
.如果结束




.子程序 处理时间数据, 文本型, , 
.参数 超级列表名, 超级列表框, , 

.局部变量 时间数据一, 文本型, , , 
.局部变量 时间数据二, 文本型, , , 

赋值 (时间数据一, 超级列表名.取标题 (超级列表名., 0))
赋值 (时间数据二, 超级列表名.取标题 (超级列表名., 1))
返回 (相加 (时间数据一, “,”, 时间数据二))


.子程序 高级表格OBV启动_废弃, 空白型, , 
 ' 高级表格OBV.置列宽 (1, 40)
 ' 高级表格OBV.置数据 (0, 0, #表格常量.文本型, “ 时间日期”)
 ' 高级表格OBV.置字体尺寸 (0, 0, 0, 0, 15)
 ' 高级表格OBV.置字体属性 (0, 0, 0, 0, 1)
 ' 高级表格OBV.置列类型 (0, 3)
 ' 高级表格OBV.置单元格文字颜色 (0, 0, 0, 0, #蓝色)
 ' 高级表格OBV.置数据 (0, 1, #表格常量.文本型, “ 初始数据”)
 ' 高级表格OBV.置字体属性 (0, 1, 0, 1, 1)
 ' 高级表格OBV.置单元格文字颜色 (0, 1, 0, 1, #蓝色)


.子程序 取OBV最小数据, 文本型, , 
.参数 超级列表名称, 超级列表框, , 
.参数 收盘价数据列, 整数型, , 
.参数 最低价数据列, 整数型, , 
.参数 最高价数据列, 整数型, , 
.参数 成交量数据列, 整数型, , 

.局部变量 数据, 文本型, , , 
.局部变量 日期, 文本型, , , 
.局部变量 i, 整数型, , , 
.局部变量 itmp, 整数型, , , 
.局部变量 索引, 整数型, , , 

全部删除 ()
.计次循环首 (取列数 (), itmp)
    0.删除列 ()
.计次循环尾 ()
0.插入列 (“时间列”, 100, #中间对齐, , )
1.插入列 (“数据列”, 100, #中间对齐, , )
.计次循环首 (超级列表名称.取表项数 (), i)
    赋值 (数据, 到文本 (OBV计算 (超级列表名称, 相减 (i, 1), 收盘价数据列, 最低价数据列, 最高价数据列, 成交量数据列)))
    赋值 (日期, 超级列表名称.取标题 (相减 (i, 1), 0))
    赋值 (索引, .插入表项 (日期, , , , ))
    索引.置标题 (1, 数据)
.计次循环尾 ()

返回 (0.取标题 (1))


.子程序 _在线留言_被选择, 空白型, , 


.子程序 _在线升级_被选择, 空白型, , 


.子程序 _关于_被选择, 空白型, , 


.窗口程序集 大盘数据添加程序, , , 

.子程序 _按钮大盘添加_被单击, 空白型, , 
更新 ()


.程序集 公用程序集, , , 

.子程序 转为普通时间, 文本型, , 
.参数 日期参数, 日期时间型, , 

.局部变量 文本, 文本型, , , 

赋值 (文本, 相加 (到文本 (取年份 (日期参数)), “年”, 到文本 (取月份 (日期参数)), “月”, 到文本 (取日 (日期参数)), “日”))
返回 (文本)


.子程序 转到月加日, 文本型, , 
.参数 日期参数, 日期时间型, , 

.局部变量 文本, 文本型, , , 

赋值 (文本, 相加 (到文本 (取月份 (日期参数)), “月”, 到文本 (取日 (日期参数)), “日”))
返回 (文本)


.子程序 计算平均值, 整数型, , 
.参数 超级列表名称, 超级列表框, , 超级列表名称
.参数 数据所在列, 整数型, , 数据所在列
.参数 天数, 整数型, , 天数

.局部变量 i, 整数型, , , 
.局部变量 总数, 整数型, , , 

赋值 (总数, 0)
.计次循环首 (天数, i)
    赋值 (总数, 相加 (总数, 到数值 (超级列表名称.取标题 (相减 (相加 (相减 (超级列表名称.取表项数 (), 天数), i), 1), 数据所在列))))
     ' 输出调试文本 (超级列表名称.取标题 (超级列表名称.取表项数 () － 天数 ＋ i － 1, 数据所在列))
.计次循环尾 ()
返回 (相除 (总数, 天数))


.子程序 打开ACCESS数据库, 逻辑型, , 成功返回真，失败返回假
.参数 数据库连接对象, 未知类型0xA0001, , AOD数据库连接对象
.参数 Password, 文本型, 可空, 可空，用户组中用户密码
.参数 UserID, 文本型, 可空, 可空，默认为Admin User ID : 用户组中用户名称
.参数 DataSource, 文本型, , 完整文件路径名，Data Source : 数据文件名 *.mdb (可以是网络共享)
.参数 SystemDatabase, 文本型, 可空, 可空，为空时，则使用系统默认路径，如：C:\Documents and Settings\Administrator\Application Data\Microsoft\Access\System.mdw 否则请输入 system.mdw 文件完整路径。
.参数 DatabasePassword, 文本型, 可空, 可空，默认为空。Jet OLEDB:Database Password : 打开数据库的密码
.参数 是否保存密码, 逻辑型, 可空, 可空，默认为不保存密码，出于安全性考虑，建议设为不保存

.局部变量 Persist_Security_Info, 文本型, , , 

 ' Provider=Microsoft.Jet.OLEDB.4.0;Password=123;User ID=zzq;Data Source=C:\123.mdb;Mode=Share Deny None;Extended Properties="";Jet OLEDB:System database=C:\123.MDW;Jet OLEDB:Registry Path="";Jet OLEDB:Database Password="";Jet OLEDB:Engine Type=5;Jet OLEDB:Database Locking Mode=0;Jet OLEDB:Global Partial Bulk Ops=2;Jet OLEDB:Global Bulk Transactions=1;Jet OLEDB:New Database Password="";Jet OLEDB:Create System Database=False;Jet OLEDB:Encrypt Database=False;Jet OLEDB:Don't Copy Locale on Compact=False;Jet OLEDB:Compact Without Replica Repair=False;Jet OLEDB:SFP=False
.如果真 (数据库连接对象.未知支持库函数_3 ())
    信息框 (“ADODB驱动没有安装!”, #错误图标, )
    返回 (假)
.如果真结束

.如果真 (不等于 (数据库连接对象., #))
    数据库连接对象.未知支持库函数_10 () ' 关闭原来已经打开的
.如果真结束
 ' 数据库连接.连接文本 ＝ “provider=Microsoft.Jet.OLEDB.4.0;Data Source=” ＋ “”

.如果真 (不等于 (Password, “”))
    赋值 (Password, 相加 (“;Password=”, Password))
.如果真结束

.判断开始 (不等于 (UserID, “”))
    赋值 (UserID, 相加 (“;User ID=”, UserID))
.默认
    赋值 (UserID, “;User ID=Admin”)
.判断结束

.如果真 (不等于 (SystemDatabase, “”))
    赋值 (SystemDatabase, 相加 (“;Jet OLEDB:System Database=”, SystemDatabase))
.如果真结束

.如果真 (不等于 (DatabasePassword, “”))
    赋值 (DatabasePassword, 相加 (“;Jet OLEDB:Database Password=”, DatabasePassword))
.如果真结束

.判断开始 (是否保存密码)
    赋值 (Persist_Security_Info, “;Persist Security Info=True”)
.默认
    赋值 (Persist_Security_Info, “;Persist Security Info=False”)
.判断结束

赋值 (数据库连接对象., 相加 (“Provider=Microsoft.Jet.OLEDB.4.0”, UserID, Password, “;Data Source=”, DataSource, Persist_Security_Info, SystemDatabase, DatabasePassword))

输出调试文本 (相加 (“数据库连接对象.连接文本：　”, 数据库连接对象.))
 ' //工作组信息丢失，或是已被其它用户以独占方式打开，这是在用Ole DB方式打开加密ACCESS库时碰到的，原先用下面的代码来打开："Provider=Microsoft.Jet.OLEDB.4.0;User Id=admin;Password=123456;Data Source=xx.mdb"将它改成："Provider=Microsoft.Jet.OLEDB.4.0;User Id=admin;jet OleDB:Database Password=123456;Data Source=xx.mdb"
 ' 举例：
 ' Provider=Microsoft.Jet.OLEDB.4.0;User ID=admin;jet OleDB:Database Password=123;Data Source=C:\mdb.mdb;Persist Security Info=True
 ' 或者：
 ' Provider=Microsoft.Jet.OLEDB.4.0;User Id=admin;jet OleDB:Database Password=123;Data Source=C:\mdb.mdb
 ' //
置等待鼠标 ()
.如果 (数据库连接对象.未知支持库函数_12 ())
    恢复鼠标 ()
     ' 信息框 (“打开ACCESS数据库成功！”, #确认钮 ＋ #信息图标, )
    输出调试文本 (相加 (“数据库连接对象.命令超时：　”, 到文本 (数据库连接对象.)))
    输出调试文本 (相加 (“数据库连接对象.连接超时：　”, 到文本 (数据库连接对象.)))
    输出调试文本 (相加 (“数据库连接对象.游标定位：　”, 到文本 (数据库连接对象.)))
    输出调试文本 (相加 (“数据库连接对象.默认数据库：　”, 到文本 (数据库连接对象.)))
    输出调试文本 (相加 (“数据库连接对象.分离等级：　”, 到文本 (数据库连接对象.)))
    输出调试文本 (相加 (“数据库连接对象.操作权限：　”, 到文本 (数据库连接对象.)))
    输出调试文本 (相加 (“数据库连接对象.数据库提供者：　”, 到文本 (数据库连接对象.)))
    输出调试文本 (相加 (“数据库连接对象.状态：　”, 到文本 (数据库连接对象.)))
    输出调试文本 (相加 (“数据库连接对象.引擎版本：　”, 到文本 (数据库连接对象.)))
    输出调试文本 (相加 (“数据库连接对象.连接文本：　”, 到文本 (数据库连接对象.)))
    
    返回 (真)
.否则
    恢复鼠标 ()
    信息框 (相加 (“打开ACCESS数据库失败！具体信息：”, #换行符, #换行符, 数据库连接对象.), 相加 (#确认钮, #错误图标), )
    输出调试文本 (相加 (“数据库连接对象.命令超时：　”, 到文本 (数据库连接对象.)))
    输出调试文本 (相加 (“数据库连接对象.连接超时：　”, 到文本 (数据库连接对象.)))
    输出调试文本 (相加 (“数据库连接对象.游标定位：　”, 到文本 (数据库连接对象.)))
    输出调试文本 (相加 (“数据库连接对象.默认数据库：　”, 到文本 (数据库连接对象.)))
    输出调试文本 (相加 (“数据库连接对象.分离等级：　”, 到文本 (数据库连接对象.)))
    输出调试文本 (相加 (“数据库连接对象.操作权限：　”, 到文本 (数据库连接对象.)))
    输出调试文本 (相加 (“数据库连接对象.数据库提供者：　”, 到文本 (数据库连接对象.)))
    输出调试文本 (相加 (“数据库连接对象.状态：　”, 到文本 (数据库连接对象.)))
    输出调试文本 (相加 (“数据库连接对象.引擎版本：　”, 到文本 (数据库连接对象.)))
    输出调试文本 (相加 (“数据库连接对象.连接文本：　”, 到文本 (数据库连接对象.)))
    返回 (假)
.如果结束


.子程序 重新编号, 逻辑型, , 重新给ACCESS自动编号，成功返回真
.参数 数据库连接, 未知类型0xA0001, , 
.参数 表名, 文本型, , 
.参数 字段名, 文本型, , 如：ID
.参数 索引名, 文本型, , 如：ID

.局部变量 sql_重新编号, 文本型, , , 
.局部变量 记录数_局, 整数型, , , 操作返回的记录数
.局部变量 是否成功_局, 逻辑型, , , 
.局部变量 最后错误, 文本型, , , 

.如果真 (取反 (打开ACCESS数据库 (数据库连接, , , 相加 (取运行目录 (), #大盘数据库名), , #pwd, )))
    信息框 (“打开ACCESS数据库失败！”, 相加 (#错误图标, #程序等待), )
    返回 (假)
.如果真结束
数据库连接.未知支持库函数_6 ()
赋值 (sql_重新编号, 相加 (“DROP INDEX ”, 字段名, “ ON [”, 表名, “]”))
 ' //删除自动编号字段索引
输出调试文本 (sql_重新编号)
数据库连接.未知支持库函数_11 (sql_重新编号, 记录数_局, )
赋值 (最后错误, 数据库连接.)
.如果真 (不等于 (最后错误, “”))
    信息框 (最后错误, 相加 (#程序等待, #错误图标), )
    .如果真 (取反 (数据库连接.未知支持库函数_8 ()))
        信息框 (“回滚事务失败！”, 相加 (#程序等待, #错误图标), )
        返回 (假)
    .如果真结束
    返回 (假)
.如果真结束


赋值 (sql_重新编号, 相加 (“ALTER TABLE [”, 表名, “] DROP COLUMN ”, 字段名))
 ' //删除自动编号字段
输出调试文本 (sql_重新编号)
数据库连接.未知支持库函数_11 (sql_重新编号, 记录数_局, )
赋值 (最后错误, 数据库连接.)
.如果真 (不等于 (最后错误, “”))
    信息框 (最后错误, 相加 (#程序等待, #错误图标), )
    .如果真 (取反 (数据库连接.未知支持库函数_8 ()))
        信息框 (“回滚事务失败！”, 相加 (#程序等待, #错误图标), )
        返回 (假)
    .如果真结束
    返回 (假)
.如果真结束

赋值 (sql_重新编号, 相加 (“ALTER TABLE [”, 表名, “] ADD ”, 字段名, “ AUTOINCREMENT”))
 ' //建立自动编号字段
输出调试文本 (sql_重新编号)
数据库连接.未知支持库函数_11 (sql_重新编号, 记录数_局, )
赋值 (最后错误, 数据库连接.)
.如果真 (不等于 (最后错误, “”))
    信息框 (最后错误, 相加 (#程序等待, #错误图标), )
    .如果真 (取反 (数据库连接.未知支持库函数_8 ()))
        信息框 (“回滚事务失败！”, 相加 (#程序等待, #错误图标), )
        返回 (假)
    .如果真结束
    返回 (假)
.如果真结束


赋值 (sql_重新编号, 相加 (“CREATE INDEX ”, 索引名, “ ON [”, 表名, “] (”, 字段名, “)”))
 ' //建立自动编号字段索引
输出调试文本 (sql_重新编号)
数据库连接.未知支持库函数_11 (sql_重新编号, 记录数_局, )
赋值 (最后错误, 数据库连接.)
.如果真 (不等于 (最后错误, “”))
    信息框 (最后错误, 相加 (#程序等待, #错误图标), )
    .如果真 (取反 (数据库连接.未知支持库函数_8 ()))
        信息框 (“回滚事务失败！”, 相加 (#程序等待, #错误图标), )
        返回 (假)
    .如果真结束
    返回 (假)
.如果真结束
.如果真 (取反 (数据库连接.未知支持库函数_7 ()))
    信息框 (“保存事务失败！”, 相加 (#程序等待, #错误图标), )
    返回 (假)
.如果真结束
返回 (真)


.子程序 设置连接access, 逻辑型, , 
.参数 数据库路径, 文本型, , 
.参数 数据库密码, 文本型, , 
.参数 数据库连接组件, 未知类型0x90001, , 
.参数 记录集组件, 未知类型0x90002, , 

.如果 (等于 (数据库连接组件.未知支持库函数_1 (数据库路径, 数据库密码), 假))
    信息框 (“数据库不存在!”, #警告图标, “提示:”)
    返回 (假)
.否则
    .如果 (等于 (记录集组件.未知支持库函数_12 (_启动窗口.), 假))
        信息框 (“数据库置连接出错!”, #警告图标, “提示:”)
        返回 (假)
    .否则
        .如果 (等于 (记录集组件.未知支持库函数_14 (“大盘数据”, #), 假))
            信息框 (“数据库打开表失败!”, #警告图标, “提示:”)
            返回 (假)
        .否则
            记录集组件.未知支持库函数_34 ()
            返回 (真)
        .如果结束
        
    .如果结束
    
.如果结束


.窗口程序集 曲线图程序集, , , 

.子程序 _窗口大盘区段走势指示图_创建完毕, 空白型, , 
.如果 (等于 (_启动窗口..选中, 真))
    赋值 (., 假)
.否则
    赋值 (., 真)
.如果结束



 ' 不属于任何一个程序集、类模块的函数：
