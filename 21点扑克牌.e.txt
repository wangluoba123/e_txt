 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 860
    高度 = 687
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\21点扑克牌.e\_启动窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 279
    高度 = 159
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “结算”
    帮助文件名 = “”

窗口 窗口2
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 254
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “21点游戏规则”
    帮助文件名 = “”

窗口 窗口3
    左边 = 50
    顶边 = 50
    宽度 = 294
    高度 = 248
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “登陆窗口”
    帮助文件名 = “”



.图片 , , , 
.常量 数据库1, "“玩家信息”", , 
.常量 姓名, "“姓名”", , 
.常量 金币, "“金币”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一




数据类型 点数, , 
    .成员 软1, 整数型, , , 
    .成员 软2, 整数型, , , 
    .成员 硬, 整数型, , , 

.全局变量 赢币, 整数型, , , 
.全局变量 结算, 文本型, , , 
.全局变量 玩家金币, 整数型, , , 
.全局变量 压注, 整数型, , , 
.全局变量 玩家姓名, 文本型, , , 
.全局变量 数据库号, 整数型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 桩家黑杰克, 逻辑型, , , 
.程序集变量 玩家黑杰克, 逻辑型, , , 
.程序集变量 玩家牌, 整数型, , "0", 
.程序集变量 玩家牌2, 整数型, , "0", 
.程序集变量 玩家牌3, 整数型, , "0", 
.程序集变量 桩家牌, 整数型, , "0", 
.程序集变量 已发出牌, 整数型, , "0", 
.程序集变量 桩家牌点数, 点数, , , 
.程序集变量 桩家牌点数虚, 点数, , , 
.程序集变量 桩家金币, 整数型, , , 
.程序集变量 是否买保, 逻辑型, , , 
.程序集变量 双倍压注, 逻辑型, , , 
.程序集变量 牌图, 画板, , "40", 
.程序集变量 玩家组, 整数型, , , 
.程序集变量 玩家牌点数, 点数, , , 
.程序集变量 玩家牌2点数, 点数, , , 
.程序集变量 玩家牌3点数, 点数, , , 
.程序集变量 当前玩家, 整数型, , , 
.程序集变量 显牌位置, 整数型, , , 
.程序集变量 显牌位置2, 整数型, , , 
.程序集变量 显牌位置3, 整数型, , , 
.程序集变量 玩家1禁, 逻辑型, , , 
.程序集变量 玩家2禁, 逻辑型, , , 
.程序集变量 玩家3禁, 逻辑型, , , 
.程序集变量 必须要牌, 逻辑型, , , 
.子程序 玩家得牌, 空白型, , 
.参数 玩家, 整数型, , 

.局部变量 a, 整数型, , , 

赋值 (a, 选牌 ())
.如果真 (等于 (玩家, 1))
    加入成员 (玩家牌, a)
    显牌 (a)
    赋值 (玩家牌点数, 计算点数 (a, 玩家牌点数))
    赋值 (., 到文本 (玩家牌点数.硬))
    赋值 (., 到文本 (玩家牌点数.软1))
    赋值 (., 到文本 (玩家牌点数.软2))
    
.如果真结束
.如果真 (等于 (玩家, 2))
    加入成员 (玩家牌2, a)
    显牌 (a)
    赋值 (玩家牌2点数, 计算点数 (a, 玩家牌2点数))
    赋值 (., 到文本 (玩家牌2点数.硬))
    赋值 (., 到文本 (玩家牌2点数.软1))
    赋值 (., 到文本 (玩家牌2点数.软2))
    
.如果真结束
.如果真 (等于 (玩家, 3))
    加入成员 (玩家牌3, a)
    显牌 (a)
    赋值 (玩家牌3点数, 计算点数 (a, 玩家牌3点数))
    赋值 (., 到文本 (玩家牌3点数.硬))
    赋值 (., 到文本 (玩家牌3点数.软1))
    赋值 (., 到文本 (玩家牌3点数.软2))
.如果真结束


.子程序 桩家得牌, 空白型, , 
.局部变量 a, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 桩大, 整数型, , , 
.局部变量 玩1大, 整数型, , , 
.局部变量 玩2大, 整数型, , , 
.局部变量 玩3大, 整数型, , , 


.如果真 (大于 (取数组成员数 (桩家牌), 1))
    .如果真 (等于 (必须要牌, 真))
        赋值 (必须要牌, 假)
        赋值 (a, 选牌 ())
        加入成员 (桩家牌, a)
        赋值 (桩家牌点数, 计算点数 (a, 桩家牌点数))
        赋值 (桩家牌点数虚, 计算点数 (a, 桩家牌点数虚))
        赋值 (., 到文本 (桩家牌点数虚.硬))
        赋值 (., 到文本 (桩家牌点数虚.软1))
        赋值 (., 到文本 (桩家牌点数虚.软2))
        显牌1 (a)
    .如果真结束
    赋值 (玩1大, 玩家牌点数.硬)
    .如果真 (并且 (小于 (玩家牌点数.软1, 22), 大于 (玩家牌点数.软1, 玩1大)))
        赋值 (玩1大, 玩家牌点数.软1)
    .如果真结束
    .如果真 (并且 (小于 (玩家牌点数.软2, 22), 大于 (玩家牌点数.软2, 玩1大)))
        赋值 (玩1大, 玩家牌点数.软2)
    .如果真结束
    赋值 (玩2大, 玩家牌2点数.硬)
    .如果真 (并且 (小于 (玩家牌2点数.软1, 22), 大于 (玩家牌2点数.软1, 玩2大)))
        赋值 (玩2大, 玩家牌2点数.软1)
    .如果真结束
    .如果真 (并且 (小于 (玩家牌2点数.软2, 22), 大于 (玩家牌2点数.软2, 玩2大)))
        赋值 (玩2大, 玩家牌2点数.软2)
    .如果真结束
    赋值 (玩3大, 玩家牌3点数.硬)
    .如果真 (并且 (小于 (玩家牌3点数.软1, 22), 大于 (玩家牌3点数.软1, 玩3大)))
        赋值 (玩3大, 玩家牌3点数.软1)
    .如果真结束
    .如果真 (并且 (小于 (玩家牌3点数.软2, 22), 大于 (玩家牌3点数.软2, 玩3大)))
        赋值 (玩3大, 玩家牌3点数.软2)
    .如果真结束
    .判断循环首 (不等于 (桩家牌点数.硬, -1))
        .如果真 (并且 (大于 (桩家牌点数.硬, 21), 或者 (大于 (桩家牌点数.软1, 21), 等于 (桩家牌点数.软1, 0)), 或者 (大于 (桩家牌点数.软2, 21), 等于 (桩家牌点数.软2, 0))))
            .计次循环首 (玩家组, i)
                .如果真 (等于 (i, 1))
                    .如果真 (等于 (玩家1禁, 真))
                        到循环尾 ()
                    .如果真结束
                    
                .如果真结束
                .如果真 (等于 (i, 2))
                    .如果真 (等于 (玩家2禁, 真))
                        到循环尾 ()
                    .如果真结束
                    
                .如果真结束
                .如果真 (等于 (i, 3))
                    .如果真 (等于 (玩家3禁, 真))
                        到循环尾 ()
                    .如果真结束
                    
                .如果真结束
                .如果 (等于 (双倍压注, 真))
                    赋值 (赢币, 相加 (赢币, 相乘 (2, 压注)))
                    赋值 (结算, 相加 (结算, “桩家曝牌,   玩家第”, 到文本 (i), “手牌赢  ”, “加双倍压注工  赢”, 到文本 (相乘 (2, 压注)), “金币”, #换行符))
                .否则
                    赋值 (赢币, 相加 (赢币, 压注))
                    赋值 (结算, 相加 (结算, “桩家曝牌,   玩家第”, 到文本 (i), “手牌赢  ”, 到文本 (压注), “金币”, #换行符))
                .如果结束
                
            .计次循环尾 ()
            游戏结束 (4)
            返回 ()
        .如果真结束
        
        赋值 (桩大, 桩家牌点数.硬)
        .如果真 (并且 (小于 (桩家牌点数.软1, 22), 大于 (桩家牌点数.软1, 桩大)))
            赋值 (桩大, 桩家牌点数.软1)
        .如果真结束
        .如果真 (并且 (小于 (桩家牌点数.软2, 22), 大于 (桩家牌点数.软2, 桩大)))
            赋值 (桩大, 桩家牌点数.软2)
        .如果真结束
        .如果真 (等于 (桩大, 21))
            .计次循环首 (玩家组, i)
                .如果真 (等于 (i, 1))
                    .如果真 (等于 (玩家1禁, 真))
                        到循环尾 ()
                    .如果真结束
                    
                .如果真结束
                .如果真 (等于 (i, 2))
                    .如果真 (等于 (玩家2禁, 真))
                        到循环尾 ()
                    .如果真结束
                    
                .如果真结束
                .如果真 (等于 (i, 3))
                    .如果真 (等于 (玩家3禁, 真))
                        到循环尾 ()
                    .如果真结束
                    
                .如果真结束
                .如果 (等于 (双倍压注, 真))
                    赋值 (赢币, 相减 (赢币, 相乘 (2, 压注)))
                    赋值 (结算, 相加 (结算, “桩家曝牌,   玩家第”, 到文本 (i), “手牌”, “输  ”, “加双倍压注  输”, 到文本 (相乘 (2, 压注)), “金币”, #换行符))
                .否则
                    赋值 (赢币, 相减 (赢币, 压注))
                    赋值 (结算, 相加 (结算, “桩家21点,   玩家第”, 到文本 (i), “手牌”, “输  ”, 到文本 (压注), “金币”, #换行符))
                .如果结束
                
            .计次循环尾 ()
            游戏结束 (2)
            返回 ()
        .如果真结束
        
        .如果真 (或者 (大于 (桩大, 玩1大), 并且 (大于 (桩大, 玩2大), 不等于 (玩2大, 0)), 并且 (大于 (桩大, 玩3大), 不等于 (玩3大, 0))))
            跳出循环 ()
        .如果真结束
        .如果 (或者 (小于 (桩家牌点数.硬, 17), 并且 (小于 (桩家牌点数.软1, 16), 不等于 (桩家牌点数.软1, 0)), 并且 (小于 (桩家牌点数.软2, 16), 不等于 (桩家牌点数.软2, 0))))
            赋值 (a, 选牌 ())
            加入成员 (桩家牌, a)
            赋值 (桩家牌点数, 计算点数 (a, 桩家牌点数))
            赋值 (桩家牌点数虚, 计算点数 (a, 桩家牌点数虚))
            赋值 (., 到文本 (桩家牌点数虚.硬))
            赋值 (., 到文本 (桩家牌点数虚.软1))
            赋值 (., 到文本 (桩家牌点数虚.软2))
            显牌1 (a)
        .否则
            跳出循环 ()
        .如果结束
        
    .判断循环尾 ()
    算分 ()
    返回 ()
.如果真结束
赋值 (a, 选牌 ())
加入成员 (桩家牌, a)
.如果真 (大于 (取数组成员数 (桩家牌), 1))
    赋值 (桩家牌点数虚, 计算点数 (a, 桩家牌点数虚))
    赋值 (., 到文本 (桩家牌点数虚.硬))
    赋值 (., 到文本 (桩家牌点数虚.软1))
    赋值 (., 到文本 (桩家牌点数虚.软2))
    
.如果真结束
赋值 (桩家牌点数, 计算点数 (a, 桩家牌点数))
显牌1 (a)


.子程序 是否黑杰克, 逻辑型, , 
.参数 牌组, 整数型, 数组, 

.如果真 (等于 (取数组成员数 (牌组), 2))
    .如果真 (并且 (等于 (整除 (相减 (牌组 [2], 1), 4), 0), 大于 (整除 (相减 (牌组 [1], 1), 4), 8)))
        返回 (真)
    .如果真结束
    .如果真 (并且 (等于 (整除 (相减 (牌组 [1], 1), 4), 0), 大于 (整除 (相减 (牌组 [2], 1), 4), 8)))
        返回 (真)
    .如果真结束
    
.如果真结束
返回 (假)

.子程序 选牌, 整数型, , 
.局部变量 有否, 逻辑型, , , 
.局部变量 i, 整数型, , , 
.局部变量 牌, 整数型, , , 

赋值 (有否, 真)
.判断循环首 (等于 (有否, 真))
    置随机数种子 ()
    赋值 (牌, 取随机数 (1, 52))
    .如果 (等于 (取数组成员数 (已发出牌), 0))
        赋值 (有否, 假)
    .否则
        .计次循环首 (取数组成员数 (已发出牌), i)
            .如果真 (等于 (已发出牌 [i], 牌))
                赋值 (有否, 真)
                跳出循环 ()
            .如果真结束
            赋值 (有否, 假)
        .计次循环尾 ()
    .如果结束
    
.判断循环尾 ()
加入成员 (已发出牌, 牌)
返回 (牌)


.子程序 _要牌图形按钮5_被单击, 空白型, , 
.局部变量 i, 整数型, , , 

连续赋值 (真, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
.如果 (等于 (是否买保, 真))
    赋值 (赢币, 相减 (赢币, 整除 (压注, 2)))
    .如果 (等于 (桩家黑杰克, 真))
        赋值 (结算, 相加 (结算, “桩家黑杰克  玩家已买保,  输”, 到文本 (整除 (压注, 2)), “金币”, #换行符))
    .否则
        赋值 (结算, 相加 (结算, “桩家不是黑杰克,但玩家买保了,输”, 到文本 (整除 (压注, 2)), “金币”, #换行符))
    .如果结束
    赋值 (桩家黑杰克, 假)
    赋值 (是否买保, 假)
.否则
    .如果真 (等于 (桩家黑杰克, 真))
        赋值 (桩家黑杰克, 假)
        赋值 (赢币, 相减 (赢币, 压注))
        赋值 (结算, 相加 (结算, “桩家黑杰克,输”, 到文本 (压注), “金币”, #换行符))
    .如果真结束
    
.如果结束
.如果 (等于 (当前玩家, 1))
    玩家1 ()
.否则
    .如果 (等于 (当前玩家, 2))
        玩家2 ()
    .否则
        .如果 (等于 (当前玩家, 3))
            玩家3 ()
        .否则
            
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 计算点数, 点数, , 
.参数 a, 整数型, , 
.参数 牌点数, 点数, , 

赋值 (a, 相加 (整除 (相减 (a, 1), 4), 1))
.如果真 (大于 (a, 9))
    赋值 (a, 10)
.如果真结束
赋值 (牌点数.硬, 相加 (牌点数.硬, a))
.如果 (等于 (a, 1))
    .如果 (不等于 (牌点数.软1, 0))
        赋值 (牌点数.软1, 相加 (牌点数.硬, 10))
        赋值 (牌点数.软2, 相加 (牌点数.硬, 20))
    .否则
        赋值 (牌点数.软1, 相加 (牌点数.硬, 10))
    .如果结束
    
.否则
    .如果真 (不等于 (牌点数.软1, 0))
        赋值 (牌点数.软1, 相加 (牌点数.软1, a))
    .如果真结束
    .如果真 (不等于 (牌点数.软2, 0))
        赋值 (牌点数.软2, 相加 (牌点数.软2, a))
    .如果真结束
    
.如果结束
返回 (牌点数)

.子程序 算分, 逻辑型, , 
.局部变量 i, 整数型, , , 
.局部变量 玩家点数, 点数, , , 
.局部变量 a, 整数型, , , 

.计次循环首 (玩家组, i)
    赋值 (玩家点数, 多项选择 (i, 玩家牌点数, 玩家牌2点数, 玩家牌3点数))
    赋值 (a, 比较输赢 (玩家点数))
    .如果真 (等于 (i, 1))
        .如果真 (等于 (玩家1禁, 真))
            到循环尾 ()
        .如果真结束
        
    .如果真结束
    .如果真 (等于 (i, 2))
        .如果真 (等于 (玩家2禁, 真))
            到循环尾 ()
        .如果真结束
        
    .如果真结束
    .如果真 (等于 (i, 3))
        .如果真 (等于 (玩家3禁, 真))
            到循环尾 ()
        .如果真结束
        
    .如果真结束
    .如果 (等于 (双倍压注, 真))
        .如果真 (等于 (a, 1))
            赋值 (赢币, 相加 (赢币, 相乘 (4, 压注)))
            赋值 (结算, 相加 (结算, “玩家第”, 到文本 (i), “手牌赢 ,加双倍压注”, 到文本 (相乘 (压注, 4)), “金币”, #换行符))
        .如果真结束
        .如果真 (等于 (a, 2))
            赋值 (赢币, 相减 (赢币, 相乘 (2, 压注)))
            赋值 (结算, 相加 (结算, “玩家第”, 到文本 (i), “手牌输,加双倍压注”, 到文本 (相乘 (压注, 2)), “金币”, #换行符))
        .如果真结束
        
    .否则
        .如果真 (等于 (a, 1))
            赋值 (玩家金币, 相加 (玩家金币, 相乘 (2, 压注)))
            赋值 (结算, 相加 (结算, “玩家第”, 到文本 (i), “手牌赢”, 到文本 (相乘 (压注, 2)), “金币”, #换行符))
        .如果真结束
        .如果真 (等于 (a, 2))
            赋值 (赢币, 相减 (赢币, 压注))
            赋值 (结算, 相加 (结算, “玩家第”, 到文本 (i), “手牌输”, 到文本 (压注), “金币”, #换行符))
        .如果真结束
        
    .如果结束
    
.计次循环尾 ()
游戏结束 (a)
返回 (真)

.子程序 比较输赢, 整数型, , 
.参数 玩家点数, 点数, , 

.局部变量 桩家牌点, 整数型, , , 
.局部变量 桩大, 整数型, , , 
.局部变量 玩大, 整数型, , , 

 ' 0为未知,1为赢,2为输,3平,4为桩家曝,5为玩家曝,6玩家先曝,11玩家21,12玩2家21,13玩3家21,7桩家21
赋值 (桩大, 桩家牌点数.硬)
.如果真 (并且 (小于 (桩家牌点数.软1, 22), 小于 (桩大, 桩家牌点数.软1)))
    赋值 (桩大, 桩家牌点数.软1)
.如果真结束
.如果真 (并且 (小于 (桩家牌点数.软2, 22), 小于 (桩大, 桩家牌点数.软2)))
    赋值 (桩大, 桩家牌点数.软2)
.如果真结束
赋值 (玩大, 玩家点数.硬)
.如果真 (并且 (小于 (玩家点数.软1, 22), 小于 (桩大, 玩家点数.软1)))
    赋值 (玩大, 玩家牌点数.软1)
.如果真结束
.如果真 (并且 (小于 (玩家点数.软2, 22), 小于 (桩大, 玩家点数.软2)))
    赋值 (玩大, 玩家点数.软2)
.如果真结束
.如果真 (大于 (桩大, 玩大))
    返回 (2)
.如果真结束
.如果真 (小于 (桩大, 玩大))
    返回 (1)
.如果真结束
.如果真 (等于 (桩大, 玩大))
    返回 (3)
.如果真结束
返回 (0)


.子程序 游戏结束, 空白型, , 
.参数 a, 整数型, , 

.局部变量 i, 整数型, , , 

连续赋值 (假, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
显示桩家底牌 ()
载入 (窗口1, , 真)
赋值 (压注, 0)
赋值 (., “0”)
赋值 (.可视, 假)
赋值 (显牌位置, 400)
连续赋值 (0, 玩家牌点数.硬, 玩家牌点数.软1, 玩家牌点数.软2, 玩家牌2点数.硬, 玩家牌2点数.软1, 玩家牌2点数.软2, 玩家牌3点数.硬, 玩家牌3点数.软1, 玩家牌3点数.软2, 桩家牌点数.硬, 桩家牌点数.软1, 桩家牌点数.软2, 桩家牌点数虚.硬, 桩家牌点数虚.软1, 桩家牌点数虚.软2)
连续赋值 (假, 是否买保, 双倍压注, 玩家1禁, 玩家2禁, 玩家3禁, 桩家黑杰克, 玩家黑杰克)
清除数组 (玩家牌)
清除数组 (玩家牌2)
清除数组 (玩家牌3)
清除数组 (桩家牌)
清除数组 (已发出牌)
赋值 (玩家组, 1)
赋值 (当前玩家, 1)
赋值 (.左边, 显牌位置)
打开 (“玩家信息.edb”, , , , , , )
跳到 (数据库号)
写 (#金币, 玩家金币)
排序 (“dd.edb”, “金币”, 假, , )
复制文件 (“dd.edb”, “玩家信息.edb”)
关闭 (“玩家信息.edb”)
删除文件 (“dd.edb”)
赋值 (.禁止, 假)

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 i, 整数型, , , 

载入 (窗口3, , 真)
.如果真 (等于 (玩家姓名, “”))
    结束 ()
    返回 ()
.如果真结束
.计次循环首 (40, i)
    复制窗口组件 (牌图 [i])
    .如果 (小于 (i, 11))
        赋值 (牌图 [i], 左边, 相加 (相乘 (18, 相减 (10, i)), 200))
        赋值 (牌图 [i], 顶边, 200)
    .否则
        赋值 (牌图 [i], 左边, 相加 (相乘 (18, 相减 (i, 10)), 350))
        赋值 (牌图 [i], 顶边, 420)
    .如果结束
    
.计次循环尾 ()
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (., 到文本 (玩家金币))
赋值 (当前玩家, 1)
赋值 (.左边, 显牌位置)
赋值 (玩家组, 1)
赋值 (显牌位置, 400)

.子程序 _开牌图形按钮6_被单击, 空白型, , 
赋值 (.禁止, 真)
桩家得牌 ()

.子程序 _双倍压注图形按钮4_被单击, 空白型, , 
赋值 (.禁止, 真)
赋值 (双倍压注, 真)


.子程序 显牌, 空白型, , 
.参数 牌号, 整数型, , 

.局部变量 图片号, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 a, 整数型, , , 

.如果真 (等于 (当前玩家, 1))
    赋值 (a, 取数组成员数 (玩家牌))
    赋值 (图片号, 载入图片 (读入文件 (相加 (取运行目录 (), “\新扑克牌图片\扑克”, 到文本 (牌号), “.bmp”))))
    赋值 (牌图 [相加 (a, 10)].可视, 真)
    赋值 (牌图 [相加 (a, 10)].左边, 相减 (显牌位置, 相乘 (相减 (a, 1), 19)))
    牌图.画图片 ( [相加 (a, 10)], 图片号, 0, 0, , , )
.如果真结束
.如果真 (等于 (当前玩家, 2))
    赋值 (a, 取数组成员数 (玩家牌2))
    赋值 (图片号, 载入图片 (读入文件 (相加 (取运行目录 (), “\新扑克牌图片\扑克”, 到文本 (牌号), “.bmp”))))
    赋值 (牌图 [相加 (a, 20)].可视, 真)
    赋值 (牌图 [相加 (a, 20)].左边, 相减 (显牌位置2, 相乘 (相减 (a, 1), 19)))
    牌图.画图片 ( [相加 (a, 20)], 图片号, 0, 0, , , )
.如果真结束
.如果真 (等于 (当前玩家, 3))
    赋值 (a, 取数组成员数 (玩家牌3))
    赋值 (图片号, 载入图片 (读入文件 (相加 (取运行目录 (), “\新扑克牌图片\扑克”, 到文本 (牌号), “.bmp”))))
    赋值 (牌图 [相加 (a, 30)].可视, 真)
    赋值 (牌图 [相加 (a, 30)].左边, 相减 (显牌位置3, 相乘 (相减 (a, 1), 19)))
    牌图.画图片 ( [相加 (a, 30)], 图片号, 0, 0, , , )
.如果真结束


.子程序 显牌1, 空白型, , 
.参数 牌号, 整数型, , 

.局部变量 图片号, 整数型, , , 
.局部变量 a, 整数型, , , 
.局部变量 i, 整数型, , , 

赋值 (a, 取数组成员数 (桩家牌))
.如果 (等于 (a, 1))
    赋值 (图片号, 载入图片 (读入文件 (相加 (取运行目录 (), “\新扑克牌图片\扑克56.bmp”))))
    赋值 (牌图 [a], 可视, 真)
    赋值 (牌图 [a], 左边, 相加 (300, 相乘 (相减 (a, 1), 19)))
    赋值 (牌图 [a], 顶边, 200)
    牌图.画图片 ( [a], 图片号, 0, 0, , , )
.否则
    赋值 (图片号, 载入图片 (读入文件 (相加 (取运行目录 (), “\新扑克牌图片\扑克”, 到文本 (牌号), “.bmp”))))
    赋值 (牌图 [a], 可视, 真)
    赋值 (牌图 [a], 左边, 相加 (300, 相乘 (相减 (a, 1), 19)))
    赋值 (牌图 [a], 顶边, 200)
    牌图.画图片 ( [a], 图片号, 0, 0, , , )
    
.如果结束


.子程序 真假黑杰克, 空白型, , 
.如果真 (等于 (当前玩家, 1))
    赋值 (玩家黑杰克, 是否黑杰克 (玩家牌))
.如果真结束
.如果真 (等于 (当前玩家, 2))
    赋值 (玩家黑杰克, 是否黑杰克 (玩家牌2))
.如果真结束
.如果真 (等于 (当前玩家, 3))
    赋值 (玩家黑杰克, 是否黑杰克 (玩家牌3))
.如果真结束

赋值 (桩家黑杰克, 是否黑杰克 (桩家牌))
.如果 (并且 (等于 (桩家黑杰克, 真), 等于 (玩家黑杰克, 假)))
    赋值 (必须要牌, 真)
    返回 ()
.否则
    .如果 (并且 (等于 (桩家黑杰克, 假), 等于 (玩家黑杰克, 真)))
        返回 ()
    .否则
        赋值 (玩家黑杰克, 假)
        赋值 (桩家黑杰克, 假)
    .如果结束
    
.如果结束


.子程序 显示桩家底牌, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 图片号, 整数型, , , 

赋值 (., 到文本 (桩家牌点数.硬))
赋值 (., 到文本 (桩家牌点数.软1))
赋值 (., 到文本 (桩家牌点数.软2))
.计次循环首 (取数组成员数 (桩家牌), i)
    赋值 (图片号, 载入图片 (读入文件 (相加 (取运行目录 (), “\新扑克牌图片\扑克”, 到文本 (桩家牌 [i]), “.bmp”))))
    牌图.画图片 ( [i], 图片号, 0, 0, , , )
.计次循环尾 ()

.子程序 _分牌图形按钮1_被单击, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 牌, 整数型, , , 
.局部变量 h, 整数型, , , 

赋值 (.禁止, 真)
赋值 (玩家组, 相加 (玩家组, 1))
赋值 (牌, 玩家牌 [1])
.如果真 (等于 (玩家组, 2))
    赋值 (牌图 [12].可视, 假)
    删除成员 (玩家牌, 2, 1)
    加入成员 (玩家牌2, 牌)
    .如果 (等于 (整除 (相减 (牌, 1), 4), 0))
        赋值 (玩家牌点数.硬, 1)
        赋值 (玩家牌点数.软1, 11)
        赋值 (玩家牌点数.软2, 0)
        赋值 (玩家牌2点数, 玩家牌点数)
    .否则
        赋值 (玩家牌点数.硬, 选择 (小于 (整除 (相减 (牌, 1), 4), 9), 相加 (整除 (相减 (牌, 1), 4), 1), 10))
        赋值 (玩家牌点数.软1, 0)
        赋值 (玩家牌点数.软2, 0)
        赋值 (玩家牌2点数, 玩家牌点数)
    .如果结束
    赋值 (当前玩家, 1)
    赋值 (显牌位置, 200)
    赋值 (显牌位置2, 500)
    赋值 (., 相减 (200, 25))
    赋值 (., 200)
    赋值 (., 相加 (200, 25))
    赋值 (., 相减 (500, 25))
    赋值 (., 500)
    赋值 (., 相加 (500, 25))
    显牌 (玩家牌 [1])
    玩家得牌 (1)
    真假黑杰克 ()
    .如果真 (等于 (玩家黑杰克, 真))
        赋值 (赢币, 相加 (赢币, 压注))
        赋值 (结算, 相加 (结算, “玩家第一手牌黑杰克,   赢”, 到文本 (压注), “金币”, #换行符))
        游戏结束 (1)
        返回 ()
    .如果真结束
    赋值 (当前玩家, 2)
    显牌 (玩家牌2 [1])
    玩家得牌 (2)
    真假黑杰克 ()
    .如果真 (等于 (玩家黑杰克, 真))
        赋值 (赢币, 相加 (赢币, 压注))
        赋值 (结算, 相加 (结算, “玩家第二手牌黑杰克,   赢”, 到文本 (压注), “金币”, #换行符))
        游戏结束 (1)
        返回 ()
    .如果真结束
    赋值 (当前玩家, 1)
    赋值 (.左边, 显牌位置)
.如果真结束
.如果真 (等于 (玩家组, 3))
    赋值 (牌图 [12].可视, 假)
    删除成员 (玩家牌, 2, 1)
    加入成员 (玩家牌3, 牌)
    赋值 (玩家牌3点数, 玩家牌2点数)
    赋值 (玩家牌点数, 玩家牌2点数)
    赋值 (当前玩家, 1)
    赋值 (显牌位置, 100)
    赋值 (显牌位置2, 300)
    赋值 (显牌位置3, 500)
    赋值 (., 相减 (100, 25))
    赋值 (., 100)
    赋值 (., 相加 (100, 25))
    赋值 (., 相减 (300, 25))
    赋值 (., 300)
    赋值 (., 相加 (300, 25))
    赋值 (., 相减 (500, 25))
    赋值 (., 500)
    赋值 (., 相加 (500, 25))
    显牌 (玩家牌 [1])
    玩家得牌 (1)
    真假黑杰克 ()
    .如果真 (等于 (玩家黑杰克, 真))
        赋值 (赢币, 相加 (赢币, 压注))
        赋值 (结算, 相加 (结算, “玩家第一手牌黑杰克,   赢”, 到文本 (压注), “金币”, #换行符))
        游戏结束 (1)
        返回 ()
    .如果真结束
    赋值 (当前玩家, 3)
    显牌 (玩家牌3 [1])
    玩家得牌 (3)
    真假黑杰克 ()
    .如果真 (等于 (玩家黑杰克, 真))
        赋值 (赢币, 相加 (赢币, 压注))
        赋值 (结算, 相加 (结算, “玩家第三手牌黑杰克,   赢”, 到文本 (压注), “金币”, #换行符))
        游戏结束 (1)
        返回 ()
    .如果真结束
    赋值 (当前玩家, 1)
    赋值 (.左边, 显牌位置)
.如果真结束


.子程序 _按钮1_被单击, 空白型, , 
.如果真 (小于或等于 (相加 (压注, 1), 500))
    赋值 (压注, 相加 (压注, 1))
    赋值 (., 到文本 (压注))
    赋值 (玩家金币, 相减 (玩家金币, 1))
    开局 ()
.如果真结束


.子程序 _按钮2_被单击, 空白型, , 
.如果真 (小于或等于 (相加 (压注, 5), 500))
    赋值 (压注, 相加 (压注, 5))
    赋值 (., 到文本 (压注))
    赋值 (玩家金币, 相减 (玩家金币, 5))
    开局 ()
.如果真结束


.子程序 _按钮3_被单击, 空白型, , 
.如果真 (小于或等于 (相加 (压注, 25), 500))
    赋值 (压注, 相加 (压注, 25))
    赋值 (., 到文本 (压注))
    赋值 (玩家金币, 相减 (玩家金币, 25))
    开局 ()
.如果真结束


.子程序 _按钮4_被单击, 空白型, , 
.如果真 (小于或等于 (相加 (压注, 50), 500))
    赋值 (压注, 相加 (压注, 50))
    赋值 (., 到文本 (压注))
    赋值 (玩家金币, 相减 (玩家金币, 50))
    开局 ()
.如果真结束


.子程序 _按钮5_被单击, 空白型, , 
.如果真 (小于或等于 (相加 (压注, 100), 500))
    赋值 (压注, 相加 (压注, 100))
    赋值 (., 到文本 (压注))
    赋值 (玩家金币, 相减 (玩家金币, 100))
    开局 ()
.如果真结束


.子程序 _按钮6_被单击, 空白型, , 
.如果真 (小于或等于 (相加 (压注, 500), 500))
    赋值 (压注, 相加 (压注, 500))
    赋值 (., 到文本 (压注))
    赋值 (玩家金币, 相减 (玩家金币, 500))
    开局 ()
.如果真结束


.子程序 开局, 空白型, , 
.局部变量 i, 整数型, , , 

.如果真 (等于 (.禁止, 假))
    赋值 (.禁止, 真)
    赋值 (., 到文本 (玩家金币))
    赋值 (.禁止, 假)
    .计次循环首 (40, i)
        赋值 (牌图 [i], 可视, 假)
    .计次循环尾 ()
    连续赋值 (“”, ., ., ., ., ., ., ., ., ., ., ., .)
.如果真结束


.子程序 玩家1, 空白型, , 
.局部变量 是否21点, 整数型, , , 

.如果 (等于 (取数组成员数 (玩家牌), 0))
    赋值 (.禁止, 假)
    赋值 (.可视, 真)
    赋值 (.左边, 显牌位置)
    赋值 (.禁止, 假)
    赋值 (结算, “”)
    赋值 (赢币, 0)
    玩家得牌 (1)
    桩家得牌 ()
    玩家得牌 (1)
    桩家得牌 ()
    真假黑杰克 ()
    .如果真 (等于 (玩家黑杰克, 真))
        赋值 (赢币, 相加 (赢币, 压注))
        赋值 (结算, 相加 (结算, “玩家黑杰克,   赢”, 到文本 (压注), “金币”, #换行符))
        游戏结束 (1)
        返回 ()
    .如果真结束
    .如果真 (小于 (桩家牌 [2], 5))
        赋值 (.禁止, 假)
    .如果真结束
    .如果真 (等于 (整除 (相减 (玩家牌 [1], 1), 4), 整除 (相减 (玩家牌 [2], 1), 4)))
        赋值 (.禁止, 假)
    .如果真结束
    
.否则
    玩家得牌 (1)
    .如果真 (等于 (取数组成员数 (玩家牌), 2))
        .如果真 (等于 (是否黑杰克 (玩家牌), 真))
            算分 ()
            返回 ()
        .如果真结束
        .如果真 (等于 (整除 (相减 (玩家牌 [1], 1), 4), 整除 (相减 (玩家牌 [2], 1), 4)))
            赋值 (.禁止, 假)
        .如果真结束
        
    .如果真结束
    .如果真 (并且 (大于 (玩家牌点数.硬, 21), 或者 (大于 (玩家牌点数.软1, 21), 等于 (玩家牌点数.软1, 0)), 或者 (大于 (玩家牌点数.软2, 21), 等于 (玩家牌点数.软2, 0))))
        赋值 (玩家1禁, 真)
        .如果 (等于 (双倍压注, 真))
            赋值 (赢币, 相减 (赢币, 相乘 (2, 压注)))
            赋值 (结算, 相加 (结算, “玩家第一手牌曝牌,加双倍压注  输”, 到文本 (相乘 (压注, 2)), “金币”, #换行符))
        .否则
            赋值 (赢币, 相减 (赢币, 压注))
            赋值 (结算, 相加 (结算, “玩家第一手牌曝牌,  输”, 到文本 (压注), “金币”, #换行符))
        .如果结束
        .如果真 (大于 (玩家组, 1))
            赋值 (当前玩家, 2)
            赋值 (.左边, 显牌位置2)
            返回 ()
        .如果真结束
        游戏结束 (6)
        返回 ()
        
    .如果真结束
    
    .如果真 (或者 (等于 (玩家牌点数.硬, 21), 等于 (玩家牌点数.软1, 21), 等于 (玩家牌点数.软2, 21)))
        .如果 (等于 (双倍压注, 真))
            赋值 (赢币, 相加 (赢币, 相乘 (4, 压注)))
            赋值 (结算, 相加 (结算, “玩家第一手牌21点,加双倍压注  赢”, 到文本 (相乘 (压注, 4)), “金币”, #换行符))
        .否则
            赋值 (赢币, 相加 (赢币, 相乘 (2, 压注)))
            赋值 (结算, 相加 (结算, “玩家第一手牌21点,  赢”, 到文本 (相乘 (压注, 2)), “金币”, #换行符))
        .如果结束
        赋值 (., 到文本 (玩家金币))
        赋值 (玩家1禁, 真)
        .如果真 (大于 (玩家组, 1))
            赋值 (当前玩家, 2)
            赋值 (.左边, 显牌位置2)
            返回 ()
        .如果真结束
        游戏结束 (1)
        返回 ()
    .如果真结束
    .如果真 (等于 (是否可要牌 (1), 真))
        返回 ()
    .如果真结束
    .如果真 (大于 (玩家组, 1))
        赋值 (当前玩家, 2)
        赋值 (.左边, 显牌位置2)
        返回 ()
    .如果真结束
    桩家得牌 ()
.如果结束


.子程序 玩家2, 空白型, , 
玩家得牌 (2)
.如果真 (等于 (取数组成员数 (玩家牌2), 2))
    .如果真 (等于 (是否黑杰克 (玩家牌2), 真))
        算分 ()
        返回 ()
    .如果真结束
    
.如果真结束
.如果真 (或者 (等于 (玩家牌2点数.硬, 21), 等于 (玩家牌2点数.软1, 21), 等于 (玩家牌2点数.软2, 21)))
    .如果 (等于 (双倍压注, 真))
        赋值 (赢币, 相加 (赢币, 相乘 (4, 压注)))
        赋值 (结算, 相加 (结算, “玩家第二手牌21点,加双倍压注  赢”, 到文本 (相乘 (压注, 4)), “金币”, #换行符))
    .否则
        赋值 (赢币, 相加 (赢币, 相乘 (2, 压注)))
        赋值 (结算, 相加 (结算, “玩家第二手牌21点,  赢”, 到文本 (相乘 (压注, 2)), “金币”, #换行符))
    .如果结束
    赋值 (玩家2禁, 真)
    .如果真 (大于 (玩家组, 2))
        赋值 (当前玩家, 3)
        赋值 (.左边, 显牌位置3)
        返回 ()
    .如果真结束
    .如果真 (等于 (玩家1禁, 真))
        游戏结束 (12)
        返回 ()
    .如果真结束
    桩家得牌 ()
    返回 ()
    
.如果真结束
.如果真 (并且 (大于 (玩家牌2点数.硬, 21), 或者 (大于 (玩家牌2点数.软1, 21), 等于 (玩家牌2点数.软1, 0)), 或者 (大于 (玩家牌2点数.软2, 21), 等于 (玩家牌2点数.软2, 0))))
    赋值 (玩家2禁, 真)
    .如果 (等于 (双倍压注, 真))
        赋值 (赢币, 相减 (赢币, 相乘 (2, 压注)))
        赋值 (结算, 相加 (结算, “玩家第二手牌曝牌,加双倍压注  输”, 到文本 (相乘 (压注, 2)), “金币”, #换行符))
    .否则
        赋值 (赢币, 相减 (赢币, 压注))
        赋值 (结算, 相加 (结算, “玩家第二手牌曝牌,  输”, 到文本 (压注), “金币”, #换行符))
    .如果结束
    
    
    .如果真 (大于 (玩家组, 2))
        赋值 (当前玩家, 3)
        赋值 (.左边, 显牌位置3)
        返回 ()
    .如果真结束
    .如果真 (等于 (玩家1禁, 真))
        游戏结束 (12)
        返回 ()
    .如果真结束
    桩家得牌 ()
    返回 ()
.如果真结束
.如果真 (等于 (是否可要牌 (2), 真))
    返回 ()
.如果真结束
.如果真 (大于 (玩家组, 2))
    赋值 (当前玩家, 3)
    赋值 (.左边, 显牌位置3)
    返回 ()
.如果真结束
桩家得牌 ()


.子程序 玩家3, 空白型, , 
玩家得牌 (3)
.如果真 (等于 (取数组成员数 (玩家牌3), 2))
    .如果真 (等于 (是否黑杰克 (玩家牌3), 真))
        算分 ()
        返回 ()
    .如果真结束
    赋值 (当前玩家, 1)
    赋值 (.左边, 显牌位置)
.如果真结束
.如果真 (并且 (大于 (玩家牌3点数.硬, 21), 或者 (大于 (玩家牌3点数.软1, 21), 等于 (玩家牌3点数.软1, 0)), 或者 (大于 (玩家牌3点数.软2, 21), 等于 (玩家牌3点数.软2, 0))))
    赋值 (玩家3禁, 真)
    .如果 (等于 (双倍压注, 真))
        赋值 (赢币, 相减 (赢币, 相乘 (2, 压注)))
        赋值 (结算, 相加 (结算, “玩家第三手牌曝牌,加双倍压注  输”, 到文本 (相乘 (压注, 2)), “金币”, #换行符))
    .否则
        赋值 (赢币, 相减 (赢币, 压注))
        赋值 (结算, 相加 (结算, “玩家第三手牌曝牌,  输”, 到文本 (压注), “金币”, #换行符))
    .如果结束
    .如果真 (并且 (等于 (玩家1禁, 真), 等于 (玩家2禁, 真)))
        游戏结束 (3)
        返回 ()
    .如果真结束
    桩家得牌 ()
    返回 ()
.如果真结束
.如果真 (或者 (等于 (玩家牌3点数.硬, 21), 等于 (玩家牌3点数.软1, 21), 等于 (玩家牌3点数.软2, 21)))
    .如果 (等于 (双倍压注, 真))
        赋值 (赢币, 相加 (赢币, 相乘 (4, 压注)))
        赋值 (结算, 相加 (结算, “玩家第三手牌21点,加双倍压注  赢”, 到文本 (相乘 (压注, 4)), “金币”, #换行符))
    .否则
        赋值 (赢币, 相加 (赢币, 相乘 (2, 压注)))
        赋值 (结算, 相加 (结算, “玩家第三手牌21点,  赢”, 到文本 (相乘 (压注, 2)), “金币”, #换行符))
    .如果结束
    赋值 (玩家3禁, 真)
    .如果真 (并且 (等于 (玩家1禁, 真), 等于 (玩家2禁, 真)))
        游戏结束 (3)
        返回 ()
    .如果真结束
    桩家得牌 ()
    返回 ()
.如果真结束
.如果真 (等于 (是否可要牌 (3), 真))
    返回 ()
.如果真结束
桩家得牌 ()


.子程序 是否可要牌, 逻辑型, , 
.参数 玩家, 整数型, , 

.局部变量 牌点数, 点数, , , 

.如果真 (等于 (玩家, 1))
    赋值 (牌点数, 玩家牌点数)
.如果真结束
.如果真 (等于 (玩家, 2))
    赋值 (牌点数, 玩家牌2点数)
.如果真结束
.如果真 (等于 (玩家, 3))
    赋值 (牌点数, 玩家牌3点数)
.如果真结束
.如果真 (或者 (小于 (牌点数.硬, 17), 并且 (小于 (牌点数.软1, 16), 不等于 (牌点数.软1, 0)), 并且 (小于 (牌点数.软2, 16), 不等于 (牌点数.软2, 0))))
    返回 (真)
.如果真结束
返回 (假)


.子程序 _买保图形按钮7_被单击, 空白型, , 
赋值 (.禁止, 真)
赋值 (是否买保, 真)

.子程序 _时钟2_周期事件, 空白型, , 
.如果 (等于 (.背景颜色, #粉红))
    赋值 (.背景颜色, #黄色)
.否则
    赋值 (.背景颜色, #粉红)
.如果结束


.子程序 _标签2_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (大于 (当前玩家, 相减 (玩家组, 1)))
    返回 ()
.如果真结束
赋值 (当前玩家, 相加 (当前玩家, 1))
.如果真 (等于 (当前玩家, 2))
    赋值 (.左边, 显牌位置2)
.如果真结束
.如果真 (等于 (当前玩家, 3))
    赋值 (.左边, 显牌位置2)
.如果真结束
.如果真 (大于 (当前玩家, 3))
    赋值 (.可视, 真)
    赋值 (.时钟周期, 0)
.如果真结束


.子程序 __启动窗口_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (.禁止, 假))
    弹出菜单 (相加 (横向位置, 85), 相加 (纵向位置, 75))
.如果真结束



.子程序 _退出_被选择, 空白型, , 
销毁 ()


.子程序 _登陆_被选择, 空白型, , 
载入 (窗口3, , 真)

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
.如果真 (等于 (.禁止, 真))
    返回 (假)
.如果真结束
返回 (真)

.子程序 _游戏规则_被选择, 空白型, , 
载入 (窗口2, , 真)


.窗口程序集 窗口程序集2, , , 

.子程序 _窗口1_创建完毕, 空白型, , 
.如果 (等于 (结算, “”))
    赋值 (结算, “平手”)
.否则
    赋值 (结算, 相加 (结算, “玩家金币=”, 到文本 (相加 (玩家金币, 压注)), 选择 (小于 (赢币, 0), 相加 (“-”, 到文本 (相乘 (赢币, -1))), 相加 (“+”, 到文本 (赢币))), “=”, 到文本 (相加 (玩家金币, 赢币, 压注))))
.如果结束
赋值 (玩家金币, 相加 (玩家金币, 赢币, 压注))
赋值 (_启动窗口.., 到文本 (玩家金币))
赋值 (.内容, 结算)

.窗口程序集 窗口程序集3, , , 

.程序集变量 字段信息表, 字段信息, , "2", 
.子程序 _窗口3_创建完毕, 空白型, , 
.局部变量 匿名局部变量_1178, 文本型, , , 
.局部变量 匿名局部变量_1180, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 行号, 整数型, , , 


.如果真 (等于 (文件是否存在 (“玩家信息.edb”), 假))
    信息框 (“jjjjj”, 0, )
    赋值 (字段信息表 [1].名称, “姓名”)
    赋值 (字段信息表 [1].类型, 10)
    赋值 (字段信息表 [1].最大文本长度, 20)
    赋值 (字段信息表 [2].名称, “金币”)
    赋值 (字段信息表 [2].类型, 3)
    .如果 (等于 (创建 (“玩家信息.edb”, 字段信息表), 真))
        信息框 (“   kkk”, 0, )
    .否则
        信息框 (“    ”, 0, )
        
    .如果结束
    
    
    
.如果真结束
打开 (“玩家信息.edb”, , , , , , )
.如果真 (大于 (取记录数 (), 1))
    到首记录 ()
    .计次循环首 (取记录数 (), i)
        输出调试文本 (i)
        赋值 (行号, -1.插入表项 ())
        行号.置标题 (0, 到文本 (i))
        行号.置标题 (1, 读 (#姓名))
        行号.置标题 (2, 到文本 (读 (#金币)))
        跳过 ()
    .计次循环尾 ()
.如果真结束


.子程序 _窗口3_将被销毁, 空白型, , 
赋值 (_启动窗口.., 到文本 (玩家金币))

关闭 (“玩家信息.edb”)


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 i, 整数型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请先输入你的大名”, 0, )
    返回 ()
.如果真结束
.如果真 (大于 (取记录数 (), 1))
    到首记录 ()
    .计次循环首 (取记录数 (), i)
        .如果真 (等于 (读 (#姓名), .内容))
            信息框 (“此用户名已存在,请从新输入你的大名,如果你是老玩家请从排行榜进入”, 0, )
            返回 ()
        .如果真结束
        跳过 ()
    .计次循环尾 ()
.如果真结束
赋值 (玩家姓名, .内容)
赋值 (玩家金币, 10000)
加空记录 ()
写 (#姓名, 玩家姓名)
写 (#金币, 玩家金币)
赋值 (数据库号, 取记录数 ())
销毁 ()


.子程序 _超级列表框1_表项被激活, 空白型, , 
赋值 (玩家金币, 到数值 (.取标题 (., 2)))
赋值 (玩家姓名, .取标题 (., 1))
赋值 (数据库号, 到数值 (.取标题 (., 0)))
销毁 ()



 ' 不属于任何一个程序集、类模块的函数：
