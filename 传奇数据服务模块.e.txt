 ' 文件类型：Windows模块源码

 ' 程序名称：传奇_功能模块
 ' 程序描述：模块制作：Rain情流感``
QQ:735003
提供技术支持，本版本为免费版，欢迎大家加本人QQ交流
 ' 程序作者：Rain情流感``
 ' 邮政编码：4201013
 ' 联系地址：湖南省益阳市大渡口轮船公司
 ' 联系电话：0737-6090890
 ' 传真号码：
 ' 电子信箱：735003@qq.com
 ' 主页地址：
 ' 版权声明：暂时没有其它信息，你可以加我QQ735003进行技术交流
 ' 版本号：1.0
 ' 创建号：0.0

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假



.图片 mirdat, " ' 已保存到：D:\易语言学习\Data\传奇数据服务模块.e\mirdat", , 
.图片 mclient, " ' 已保存到：D:\易语言学习\Data\传奇数据服务模块.e\mclient", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库





.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。
信息框 (到文本 (传奇是否开放 (“61.155.60.51”)), 0, )

.子程序 运行传奇, 空白型, 公开, 本命令将自动写出运行文件并运行，您只需提供参数 服务器名 IP地址 端口号,端口号一般都是7000，如果您的服务器变更了端口号，则可填写您的端口号
.参数 服务器名, 文本型, , 必填，您的服务器名
.参数 IP地址, 文本型, , 必填，服务器IP，请按照"***.***.***.***"格式填写
.参数 端口号, 整数型, 可空, 可空，默认为7000

.如果真 (是否为空 (端口号))
    赋值 (端口号, 7000)
.如果真结束
写配置项 (相加 (取运行目录 (), “\ftp.ini”), “server”, “ServerCount”, “1”)
写配置项 (相加 (取运行目录 (), “\ftp.ini”), “server”, “Server1Caption”, 服务器名)
写配置项 (相加 (取运行目录 (), “\ftp.ini”), “server”, “Server1Name”, 服务器名)
写配置项 (相加 (取运行目录 (), “\mir.ini”), “Setup”, “FontName”, “宋体”)
写配置项 (相加 (取运行目录 (), “\mir.ini”), “Setup”, “ServerAddr”, IP地址)
写配置项 (相加 (取运行目录 (), “\mir.ini”), “Setup”, “Param1”, IP地址)
写配置项 (相加 (取运行目录 (), “\mir.ini”), “Setup”, “Param2”, 到文本 (端口号))
写配置项 (相加 (取运行目录 (), “\mir.ini”), “Setup”, “Patched”, “0”)
写配置项 (相加 (取运行目录 (), “\mir.ini”), “Setup”, “Param3”, “”)
写配置项 (相加 (取运行目录 (), “\mir.ini”), “Setup”, “Param4”, “”)
写配置项 (相加 (取运行目录 (), “\mir.ini”), “Setup”, “Param5”, “”)
写数据 (相加 (取运行目录 (), “\mirclient.dat”), #mirdat)
写数据 (相加 (取运行目录 (), “\mClient.dll”), #mclient)
运行 (相加 (取运行目录 (), “\mirclient.dat”), 假, )

.子程序 写数据, 空白型, , 相对于“写出字节集()”，本命令省去了需要文件号的表骤
.参数 filename, 文本型, , 全局硬盘路径
.参数 filetext, 字节集, , 写入到文件的数据，字节集型。

.局部变量 文本天天, 空白型, , , 

赋值 (文本天天, 打开文件 (filename, 4, 4))
写出字节集 (文本天天, filetext)
关闭文件 (文本天天)


.子程序 传奇是否开放, 双精度小数型, 公开, 本程序用做返回客户端与服务器连接时间，如果服务器未开放，返回-1,你可以根据返回的检测数据设置服务器繁忙状态,检测时程序可能会出现假死现像，稍等片刻即可。
.参数 IP地址, 文本型, , 文本型，请按照"***.***.***.***"格式填写
.参数 端口数据, 整数型, 可空, 服务器端口号,可空，默认为7000

.局部变量 开始时间, 日期时间型, , , 
.局部变量 结束时间, 日期时间型, , , 
.局部变量 时间间隔, 双精度小数型, , , 

.如果真 (是否为空 (端口数据))
    赋值 (端口数据, 7000)
.如果真结束
载入 (窗口1, , 真)
赋值 (开始时间, 取现行时间 ())
.如果 (等于 (窗口1.连接 (., IP地址, 7000), 假))
    赋值 (结束时间, 取现行时间 ())
    赋值 (时间间隔, 取时间间隔 (结束时间, 开始时间, 8))
    窗口1.断开连接 (.)
    窗口1.销毁 ()
    返回 (-1)
.否则
    窗口1.断开连接 (.)
    赋值 (结束时间, 取现行时间 ())
    赋值 (时间间隔, 取时间间隔 (结束时间, 开始时间, 8))
    窗口1.销毁 ()
    返回 (时间间隔)
.如果结束



 ' 不属于任何一个程序集、类模块的函数：
