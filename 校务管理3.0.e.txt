 ' 文件类型：Windows窗口程序

 ' 程序名称：中小学校务管理系统
 ' 程序描述：大连大有吴涛易语言软件开发有限公司版权所有,本源代码您可以任意使用,但必须注明由易语言编写!
 ' 程序作者：丁坤
 ' 邮政编码：
 ' 联系地址：dingkunid@yahoo.com.cn
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：dingkunid@yahoo.com.cn
 ' 主页地址：
 ' 版权声明：
 ' 版本号：3.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “校务管理系统”
    帮助文件名 = “”

窗口 教员资料录入修改窗口
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 学生资料录入修改窗口
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 设置科目窗口
    左边 = 50
    顶边 = 50
    宽度 = 535
    高度 = 260
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “设置修改本校的课程科目”
    帮助文件名 = “”

窗口 资料变更窗口
    左边 = 50
    顶边 = 50
    宽度 = 552
    高度 = 215
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 放大照片窗口
    左边 = 50
    顶边 = 50
    宽度 = 360
    高度 = 500
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = 12607488 '  0xC06000
    最大化按钮 = 真
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “放大照片”
    帮助文件名 = “”

窗口 工资系统设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 680
    高度 = 170
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “工资管理设置”
    帮助文件名 = “”

窗口 系统设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 534
    高度 = 335
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “系统设置”
    帮助文件名 = “”

窗口 修改班主任窗口
    左边 = 50
    顶边 = 50
    宽度 = 294
    高度 = 135
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “修改班主任姓名”
    帮助文件名 = “”

窗口 欢迎窗口
    左边 = 50
    顶边 = 50
    宽度 = 460
    高度 = 235
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\校务管理3.0.e\欢迎窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “欢迎登录”
    帮助文件名 = “”

窗口 关于注册窗口
    左边 = 50
    顶边 = 50
    宽度 = 457
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\校务管理3.0.e\关于注册窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 课程表窗口
    左边 = 50
    顶边 = 50
    宽度 = 547
    高度 = 385
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “编辑课程安排表”
    帮助文件名 = “”

窗口 评语录入窗口
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “评语录入”
    帮助文件名 = “”

窗口 改升级名窗口
    左边 = 50
    顶边 = 50
    宽度 = 255
    高度 = 125
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “升级班级”
    帮助文件名 = “”

窗口 管理员登录窗口
    左边 = 50
    顶边 = 50
    宽度 = 462
    高度 = 235
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “系统管理员设置”
    帮助文件名 = “”

窗口 界面窗口
    左边 = 50
    顶边 = 50
    宽度 = 475
    高度 = 114
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “设置系统界面”
    帮助文件名 = “”

窗口 修改范例窗口
    左边 = 50
    顶边 = 50
    宽度 = 406
    高度 = 285
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “编辑评语范例”
    帮助文件名 = “”

窗口 自设毕业窗口
    左边 = 50
    顶边 = 50
    宽度 = 403
    高度 = 240
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 数据维护窗口
    左边 = 50
    顶边 = 50
    宽度 = 343
    高度 = 200
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “系统数据维护”
    帮助文件名 = “”

窗口 离校说明窗口
    左边 = 50
    顶边 = 50
    宽度 = 286
    高度 = 105
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “离开本校的说明”
    帮助文件名 = “”



.常量 公钥, "“C8DB”", , 
.常量 公共模数, "“83BFB0718CF98D46CC70FB34118E5F4ACC3D75582036F3F678BDE418A273DBBBBC9C95637CC7408EBB71972B237653BAC076F121314035521F271BE0EE0316F27B6F9ACADAC80A005DEAD43C14589B575CA7D802F5EC49AADDE97F33B853CB2B4471B9571F772CCCC3D86ED25FA49FFBBE55369A727F1033DC42ABE40D2C35D8B521A49B912D55DECBB31B5AC91AD3CB3A3F138800A4D42724D87D1336B00A7048F92F915BE8DC94D03699CC7FC4F6DAC1CBB4028A57ABF3780E0D4175E9B4A1E46D6F1F8EC731CBFF077CA659CAD541A9AD70C8B6E7D2910A8715CF436C19AFE018A49C122B29F20B16744DAFEB5622B067C0F224EEEF245415CF966F0EC6F1”", , 
.常量 , , , 
.声音 声音1, " ' 已保存到：D:\易语言学习\Data\校务管理3.0.e\声音1", , 
.图片 课程表, " ' 已保存到：D:\易语言学习\Data\校务管理3.0.e\课程表", , 
.图片 学籍表, " ' 已保存到：D:\易语言学习\Data\校务管理3.0.e\学籍表", , 
.图片 教员表, " ' 已保存到：D:\易语言学习\Data\校务管理3.0.e\教员表", , 
.图片 管理员数据, " ' 已保存到：D:\易语言学习\Data\校务管理3.0.e\管理员数据", , 
.图片 学生数据, " ' 已保存到：D:\易语言学习\Data\校务管理3.0.e\学生数据", , 
.图片 教员数据, " ' 已保存到：D:\易语言学习\Data\校务管理3.0.e\教员数据", , 
.图片 工资表数据, " ' 已保存到：D:\易语言学习\Data\校务管理3.0.e\工资表数据", , 
.图片 图片1, " ' 已保存到：D:\易语言学习\Data\校务管理3.0.e\图片1", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' eCompress 7B68736E818E41c5A28B0AE4D43C128C 1 1 压缩解压支持库
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 1 0 数据操作支持库一
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库




.全局变量 修改资料, 逻辑型, , , 
.全局变量 选择子夹, 整数型, , , 
.全局变量 打印设置, 打印设置信息, , , 
.全局变量 搜索资料, 逻辑型, , , 
.全局变量 毕业列表, 逻辑型, , , 
.全局变量 判断教员, 文本型, , , 
.全局变量 教员去向, 文本型, , , 
.全局变量 记录, 整数型, , , 
.全局变量 男, 整数型, , , 
.全局变量 女, 整数型, , , 
.全局变量 学生分类, 文本型, , , 
.全局变量 重新登录系统, 逻辑型, , , 

.DLL命令 置父窗口, 整数型, "", "SetParent", , 
    .参数 控件句柄, 整数型, , 
    .参数 新父句柄, 整数型, , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 光标行, 整数型, , , 
.程序集变量 选择列, 整数型, , , 
.程序集变量 工资表, 文本型, , , 
.程序集变量 全局搜索, 逻辑型, , , 
.程序集变量 上次单击列, 整数型, , , 
.程序集变量 排序方式, 逻辑型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 界面选项, 整数型, , , 
.局部变量 计次, 整数型, , , 

赋值 (重新登录系统, 假)
载入 (欢迎窗口, , 假)
_启动窗口.移动 (0, 0, 取屏幕宽度 (), 取屏幕高度 ())
.如果真 (等于 (文件是否存在 (相加 (取运行目录 (), “\config.ini”)), 假))
    写配置项 (相加 (取运行目录 (), “\config.ini”), “School”, “Name”, “(请设置学校名称)”)
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “Style”, “0”)
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Wages”, “工资表一”, “教员工资表”)
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Wages”, “工资表二”, “教员工资表”)
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Wages”, “工资表三”, “教员工资表”)
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Wages”, “工资表四”, “教员工资表”)
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Wages”, “工资表五”, “教员工资表”)
.如果真结束
赋值 (界面选项, 到数值 (读配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “Style”, “0”)))
未知支持库函数_0 (界面选项)

.计次循环首 (8, 计次)
    置文件属性 (相加 (取运行目录 (), “\data\00”, 到文本 (计次), “.xsk”), 32)
.计次循环尾 ()
置文件属性 (相加 (取运行目录 (), “\config.ini”), 相加 (2, 32))
.如果真 (等于 (相加 (取运行目录 (), “\data\006.xsk”).打开MDB数据库 (“2978263-dks”, , ), 假))
    信息框 (“载入系统数据A失败！”, #错误图标, “错误”)
    结束 ()
.如果真结束
.如果真 (等于 (相加 (取运行目录 (), “\data\007.xsk”).打开MDB数据库 (“2978263-dkt”, , ), 假))
    信息框 (“载入系统数据B失败！”, #错误图标, “错误”)
    关闭 ()
    结束 ()
.如果真结束
赋值 (.连接文本, 取连接文本 ())
赋值 (.标题, 读配置项 (相加 (取运行目录 (), “\config.ini”), “school”, “Name”, ))
赋值 (.内容, 相加 (.标题, “校务管理系统”))
2.置文本 (“    当前状态：请选择操作”)
.如果 (不等于 (取星期几 (取现行时间 ()), 1))
    3.置文本 (相加 (“        欢迎使用校务管理系统！ ”, “今天是”, 时间到文本 (取现行时间 (), 2), “  星期”, 数值到大写 (相减 (取星期几 (取现行时间 ()), 1), 真)))
.否则
    3.置文本 (相加 (“        欢迎使用校务管理系统！ ”, “今天是”, 时间到文本 (取现行时间 (), 2), “  星期日”))
.如果结束
赋值 (_启动窗口., “校务管理系统 v3.0”)

.子程序 __启动窗口_尺寸被改变, 空白型, , 
赋值 (.可视, 假)
.移动 (取用户区宽度 (), 相减 (取用户区高度 (), .可视))
.判断开始 (小于 (_启动窗口., 800))
    赋值 (_启动窗口., 800)
.判断 (小于 (_启动窗口., 600))
    赋值 (_启动窗口., 600)
.默认
    
.判断结束

0.移动 (取用户区宽度 (), 相减 (取用户区高度 (), .可视, .))
.移动 (取用户区宽度 (), 相乘 (取用户区高度 (), 0.6))
赋值 (.顶边, 相减 (相除 (取用户区高度 (), 2), 相除 (.高度, 2), 20))
赋值 (.顶边, 相减 (.顶边, 32))
相减 (.宽度, .宽度, 80).移动 (相减 (.高度, .高度), , )
相减 (.宽度, .宽度, 50).移动 (相加 (相减 (相除 (相减 (.高度, .顶边, .高度), 2), 相除 (.高度, 2)), .顶边, .高度), , )
连续赋值 (相减 (取用户区宽度 (), 4), .宽度, .宽度)
连续赋值 (相减 (.宽度, 4), .宽度, .宽度)
连续赋值 (相减 (取用户区宽度 (), 12), .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度)
连续赋值 (相减 (.宽度, 4), .宽度, .宽度, .宽度, .宽度, .宽度, .宽度)
赋值 (.左边, 相减 (.宽度, .宽度, 5))
赋值 (.左边, 相减 (.宽度, .宽度, 5))
赋值 (.左边, 相减 (.宽度, .宽度, 20))
赋值 (.顶边, 相减 (取用户区高度 (), .高度, 2))


.移动 (.宽度, 相减 (取用户区高度 (), .可视, ., .高度, 2))
.移动 (.宽度, 相减 (取用户区高度 (), .可视, ., .高度, 2))
.移动 (.宽度, 相减 (.高度, 37))
1.移动 (相减 (.宽度, 5), 相减 (.高度, 3))
.移动 (.宽度, 相减 (.高度, 37))
1.移动 (相减 (.宽度, 5), 相减 (.高度, 3))
缩放成绩表 ()
缩放工资表 ()
设置列宽 ()
相减 (.宽度, .宽度, 15).移动 ()
相减 (.宽度, .宽度, 15).移动 ()
相减 (.宽度, .宽度, 20).移动 ()
变教员窗口 ()
变学生窗口 ()
赋值 (.可视, 真)

.子程序 设置列宽, 空白型, , 
.局部变量 计次, 整数型, , , 

连续赋值 (假, _启动窗口..字体大小, _启动窗口..字体大小, _启动窗口..字体大小)
_启动窗口.移动 (., , , _启动窗口..宽度, 相减 (_启动窗口..高度, 37))
_启动窗口.移动 (., , , _启动窗口..宽度, 相减 (_启动窗口..高度, 37))
_启动窗口.移动 (., , , _启动窗口..宽度, 相减 (_启动窗口..高度, 37))
_启动窗口.移动 (., , , _启动窗口..宽度, 相减 (_启动窗口..高度, 37))

_启动窗口.置列宽 (., 1, 相除 (_启动窗口., 11.1))
_启动窗口.置列宽 (., 2, 相除 (_启动窗口., 12))
_启动窗口.置列宽 (., 3, 相除 (_启动窗口., 15))
_启动窗口.置列宽 (., 4, 相除 (_启动窗口., 12.9))
_启动窗口.置列宽 (., 5, 相除 (_启动窗口., 8.8))
_启动窗口.置列宽 (., 6, 相除 (_启动窗口., 9.41))
_启动窗口.置列宽 (., 7, 相除 (_启动窗口., 7.27))
_启动窗口.置列宽 (., 8, 相除 (_启动窗口., 7.27))
_启动窗口.置列宽 (., 9, 相除 (_启动窗口., 7.27))

_启动窗口.置列宽 (., 1, 相除 (_启动窗口., 11.1))
_启动窗口.置列宽 (., 2, 相除 (_启动窗口., 12))
_启动窗口.置列宽 (., 3, 相除 (_启动窗口., 15))
_启动窗口.置列宽 (., 4, 相除 (_启动窗口., 12.9))
_启动窗口.置列宽 (., 5, 相除 (_启动窗口., 8.8))
_启动窗口.置列宽 (., 6, 相除 (_启动窗口., 9.41))
_启动窗口.置列宽 (., 7, 相除 (_启动窗口., 7.27))
_启动窗口.置列宽 (., 8, 相除 (_启动窗口., 7.27))
_启动窗口.置列宽 (., 9, 相除 (_启动窗口., 7.27))

_启动窗口.置列宽 (., 1, 相除 (_启动窗口., 12))
_启动窗口.置列宽 (., 2, 相除 (_启动窗口., 15))
_启动窗口.置列宽 (., 3, 相除 (_启动窗口., 12.9))
_启动窗口.置列宽 (., 4, 相除 (_启动窗口., 11.1))
_启动窗口.置列宽 (., 5, 相除 (_启动窗口., 9))
_启动窗口.置列宽 (., 6, 相除 (_启动窗口., 9))
_启动窗口.置列宽 (., 7, 相除 (_启动窗口., 7.27))
_启动窗口.置列宽 (., 8, 相除 (_启动窗口., 7.27))
_启动窗口.置列宽 (., 9, 相除 (_启动窗口., 7.27))

_启动窗口.置列宽 (., 1, 相除 (_启动窗口., 9))
.计次循环首 (11, 计次)
    _启动窗口.置列宽 (., 相加 (计次, 1), 相除 (_启动窗口., 13))
.计次循环尾 ()
连续赋值 (真, _启动窗口..字体大小, _启动窗口..字体大小, _启动窗口..字体大小)

.子程序 变教员窗口, 空白型, , 
连续赋值 (相除 (_启动窗口., 10), .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度)

连续赋值 (相除 (_启动窗口., 3.333), .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边, .左边, .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边, .左边, .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边, .左边, .左边, .左边, .左边)
相减 (相加 (.左边, .宽度), 1).移动 (相除 (_启动窗口., 5.71), )
.移动 (相减 (.高度, 235))
赋值 (.角度, 相加 (.左边, .宽度, 20))
.移动 (相减 (相加 (.左边, .宽度), .角度), 相减 (.高度, 235))
赋值 (.左边, 相加 (.角度, 5))


.子程序 变学生窗口, 空白型, , 
连续赋值 (相除 (_启动窗口., 10), .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度)
连续赋值 (相除 (_启动窗口., 3.333), .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边, .左边, .左边)
相减 (相加 (.左边, .宽度), 1).移动 (相除 (_启动窗口., 5.71), )
连续赋值 (相除 (_启动窗口., 11.43), .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边, .左边)
赋值 (.宽度, 相减 (.左边, .左边, .宽度))
连续赋值 (.宽度, .宽度, .宽度)

连续赋值 (相除 (.宽度, 2), .宽度, .宽度, .宽度, .宽度, .宽度, .宽度)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边)
赋值 (.宽度, 相加 (.宽度, .宽度, .宽度))
赋值 (.宽度, 相加 (.宽度, .宽度, .宽度))
赋值 (.宽度, 相加 (.宽度, .宽度, 1))
赋值 (.宽度, 相加 (.宽度, .宽度, 1))
.移动 (相减 (.高度, .顶边, 10))
赋值 (.角度, 相加 (.左边, .宽度, 20))
.移动 (相减 (相加 (.左边, .宽度), .角度), 相减 (.高度, .顶边, 10))
赋值 (.左边, .角度)
赋值 (.左边, 相加 (.左边, .宽度))


.子程序 __启动窗口_被激活, 空白型, , 
.判断开始 (等于 (.现行子夹, 1))
    赋值 (.倾斜, 相加 (.倾斜, 1))
    重画 ()
    赋值 (.倾斜, 相减 (.倾斜, 1))
.判断 (等于 (.现行子夹, 2))
    赋值 (.倾斜, 相加 (.倾斜, 1))
    重画 ()
    赋值 (.倾斜, 相减 (.倾斜, 1))
.判断 (等于 (.现行子夹, 3))
    赋值 (.倾斜, 相加 (.倾斜, 1))
    重画 ()
    赋值 (.倾斜, 相减 (.倾斜, 1))
.判断 (等于 (.现行子夹, 4))
    缩放成绩表 ()
.判断 (等于 (.现行子夹, 5))
    赋值 (.倾斜, 相加 (.倾斜, 1))
    重画 ()
    赋值 (.倾斜, 相减 (.倾斜, 1))
.判断 (等于 (.现行子夹, 6))
    赋值 (.倾斜, 相加 (.倾斜, 1))
    重画 ()
    赋值 (.倾斜, 相减 (.倾斜, 1))
.判断 (等于 (.现行子夹, 7))
    缩放工资表 ()
.判断 (等于 (.现行子夹, 8))
    赋值 (.倾斜, 相加 (.倾斜, 1))
    重画 ()
    赋值 (.倾斜, 相减 (.倾斜, 1))
.默认
    
.判断结束


.子程序 缩放成绩表, 空白型, , 
.如果 (等于 (取操作系统类别 (), 3))
    .判断开始 (等于 (取屏幕宽度 (), 800))
        赋值 (.缩放比, 125)
    .判断 (等于 (取屏幕宽度 (), 1024))
        赋值 (.缩放比, 99)
        1.置列宽 (12, 相除 (_启动窗口., 4))
    .判断 (等于 (取屏幕宽度 (), 1152))
        赋值 (.缩放比, 88)
    .判断 (等于 (取屏幕宽度 (), 1280))
        赋值 (.缩放比, 80)
    .默认
        赋值 (.缩放比, 63)
        
    .判断结束
    1.置列宽 (12, 相除 (_启动窗口., 4))
.否则
    赋值 (.缩放比, 86)
    1.置列宽 (12, 相除 (_启动窗口., 4.11))
.如果结束
获取焦点 ()

.子程序 缩放工资表, 空白型, , 
.如果 (等于 (取操作系统类别 (), 3))
    .判断开始 (等于 (取屏幕宽度 (), 800))
        赋值 (.缩放比, 125)
    .判断 (等于 (取屏幕宽度 (), 1024))
        赋值 (.缩放比, 100)
    .判断 (等于 (取屏幕宽度 (), 1152))
        赋值 (.缩放比, 87)
    .判断 (等于 (取屏幕宽度 (), 1280))
        赋值 (.缩放比, 80)
    .默认
        赋值 (.缩放比, 64)
    .判断结束
    1.置列宽 (10, 相除 (_启动窗口., 3.33))
.否则
    赋值 (.缩放比, 85)
    1.置列宽 (10, 相除 (_启动窗口., 3.39))
.如果结束
获取焦点 ()


.子程序 __启动窗口_被取消激活, 空白型, , 
获取焦点 ()

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
.如果 (等于 (信息框 (“确定要退出校务管理系统吗？”, 相加 (#是否钮, #询问图标), “询问”), #是钮))
    关闭 ()
    关闭 ()
    关闭 ()
    结束 ()
.否则
    返回 (假)
.如果结束


.子程序 _退出系统_被选择, 空白型, , 
.如果真 (等于 (信息框 (“确定要退出校务管理系统吗？”, 相加 (#是否钮, #询问图标), “询问”), #是钮))
    关闭 ()
    关闭 ()
    关闭 ()
    结束 ()
.如果真结束


.子程序 __启动窗口_将被销毁, 空白型, , 
关闭 ()
关闭 ()
关闭 ()

.子程序 填充查看科目, 空白型, , 
赋值 (记录, 相加 (“select 科目1,科目2,科目3,科目4,科目5,科目6,科目7,科目8,科目9,科目10 from 班级表 where 所在班级='”, .内容, “'”).查询 ())
记录.到首记录 ()
.如果 (不等于 (记录, 0))
    赋值 (.标题, 记录.读 (“科目1”))
    赋值 (.标题, 记录.读 (“科目2”))
    赋值 (.标题, 记录.读 (“科目3”))
    赋值 (.标题, 记录.读 (“科目4”))
    赋值 (.标题, 记录.读 (“科目5”))
    赋值 (.标题, 记录.读 (“科目6”))
    赋值 (.标题, 记录.读 (“科目7”))
    赋值 (.标题, 记录.读 (“科目8”))
    赋值 (.标题, 记录.读 (“科目9”))
    赋值 (.标题, 记录.读 (“科目10”))
.否则
    信息框 (“    读取课程科目失败！   ”, #错误图标, “错误”)
.如果结束
记录.关闭记录集 ()

.子程序 填充成绩表头, 空白型, , 
0.初始尺寸 (0)
1.添加行 ()
1.插入列 (12)
1.置文本 (1, “学号”)
1.置文本 (2, “姓名”)
赋值 (记录, _启动窗口.查询 (., 相加 (“select * from 班级表 where 所在班级='”, .内容, “'”)))
_启动窗口.到首记录 (., 记录)
1.置文本 (3, _启动窗口.读 (., 记录, “科目1”))
1.置文本 (4, _启动窗口.读 (., 记录, “科目2”))
1.置文本 (5, _启动窗口.读 (., 记录, “科目3”))
1.置文本 (6, _启动窗口.读 (., 记录, “科目4”))
1.置文本 (7, _启动窗口.读 (., 记录, “科目5”))
1.置文本 (8, _启动窗口.读 (., 记录, “科目6”))
1.置文本 (9, _启动窗口.读 (., 记录, “科目7”))
1.置文本 (10, _启动窗口.读 (., 记录, “科目8”))
1.置文本 (11, _启动窗口.读 (., 记录, “科目9”))
1.置文本 (12, _启动窗口.读 (., 记录, “科目10”))
_启动窗口.关闭记录集 (., 记录)
1.置表头行数 ()

.如果 (等于 (取操作系统类别 (), 3))
    .判断开始 (等于 (取屏幕宽度 (), 800))
        赋值 (.缩放比, 125)
    .判断 (等于 (取屏幕宽度 (), 1024))
        赋值 (.缩放比, 99)
        1.置列宽 (12, 相除 (_启动窗口., 4))
    .判断 (等于 (取屏幕宽度 (), 1152))
        赋值 (.缩放比, 88)
    .判断 (等于 (取屏幕宽度 (), 1280))
        赋值 (.缩放比, 80)
    .默认
        赋值 (.缩放比, 63)
    .判断结束
    1.置列宽 (12, 相除 (_启动窗口., 4))
.否则
    赋值 (.缩放比, 86)
    1.置列宽 (12, 相除 (_启动窗口., 4.11))
.如果结束



.子程序 _重新登录_被选择, 空白型, , 
赋值 (重新登录系统, 真)
赋值 (选择子夹, 0)
载入 (管理员登录窗口, , 真)

.子程序 _校务设置_被选择, 空白型, , 
.如果真 (不等于 (取文本右边 (.标题, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束
载入 (系统设置窗口, _启动窗口, 真)

.子程序 _管理员设置_被选择, 空白型, , 
.如果真 (不等于 (取文本右边 (.标题, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束
赋值 (选择子夹, 3)
载入 (管理员登录窗口, , 真)


.子程序 _修改管理员资料_被选择, 空白型, , 
关闭 ()
.如果真 (等于 (相加 (取运行目录 (), “\data\008.xsk”).打开MDB数据库 (“2978263-dku”, , ), 假))
    信息框 (“不能打开系统数据文件！请尝试重新启动本系统！”, 0, )
    返回 ()
.如果真结束
赋值 (选择子夹, 1)
载入 (管理员登录窗口, , 真)


.子程序 _添加学生资料_被选择, 空白型, , 
.如果真 (不等于 (取文本左边 (.标题, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束
赋值 (修改资料, 假)
载入 (学生资料录入修改窗口, _启动窗口, 真)

.子程序 _修改学生资料_被选择, 空白型, , 
.如果真 (不等于 (取文本右边 (.标题, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束

赋值 (修改资料, 真)
载入 (学生资料录入修改窗口, _启动窗口, 假)

.子程序 _调整学生班级_被选择, 空白型, , 
.如果真 (不等于 (取文本左边 (.标题, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束

.如果 (或者 (等于 (.现行子夹, 1), 等于 (.现行子夹, 3)))
    .如果真 (并且 (等于 (.现行子夹, 1), 不等于 (学生分类, “在校学生”)))
        信息框 (相加 (“  本操作只能对在校学生操作！您现在操作的是：”, 学生分类, “资料。  ”), 0, )
        返回 ()
    .如果真结束
    
    .如果 (或者 (不等于 (., -1), 不等于 (., -1)))
        赋值 (选择子夹, 1)
        载入 (资料变更窗口, , 真)
    .否则
        信息框 (“  请先选择需要调整班级的学生所在班级和姓名！  ”, 0, )
    .如果结束
    
.否则
    信息框 (“  请先选择需要调整班级的学生所在班级和姓名！  ”, 0, )
    _查看学生资料_被选择 ()
.如果结束


.子程序 _学生转学退学_被选择, 空白型, , 
.如果真 (不等于 (取文本左边 (.标题, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束

.如果 (或者 (等于 (.现行子夹, 1), 等于 (.现行子夹, 3)))
    .如果 (等于 (学生分类, “在校学生”))
        .如果 (或者 (不等于 (., -1), 不等于 (., -1)))
            赋值 (选择子夹, 0)
            载入 (资料变更窗口, , 真)
        .否则
            信息框 (“  请先选择需要调整班级的学生所在班级和姓名！  ”, 0, )
        .如果结束
        
    .否则
        信息框 (相加 (“  本操作只能对在校学生操作！您现在操作的是：”, 学生分类, “资料。  ”), 0, )
    .如果结束
    
.否则
    信息框 (“  请先选择需要调整班级的学生所在班级和姓名！  ”, 0, )
    _查看学生资料_被选择 ()
.如果结束


.子程序 _智能评语录入_被选择, 空白型, , 
.如果真 (不等于 (取文本左边 (.标题, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束
载入 (评语录入窗口, _启动窗口, 真)

.子程序 _通用班级毕业升级_被选择, 空白型, , 
.局部变量 操作时间, 日期时间型, , , 

.如果真 (不等于 (取文本右边 (.标题, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束

赋值 (操作时间, 到时间 (读配置项 (相加 (取运行目录 (), “\config.ini”), “Graduate”, “date1”, )))
.如果 (小于 (取时间间隔 (取现行时间 (), 操作时间, 3), 6))
    .如果真 (等于 (信息框 (相加 (“  在”, 时间到文本 (操作时间, 2), “已经进行了通用班级的毕业升级操作！现在还要进行毕业升级操作吗？   ”), 相加 (#警告图标, #是否钮), “询问”), #是钮))
        赋值 (选择子夹, 2)
        载入 (资料变更窗口, _启动窗口, 真)
        回主界面 ()
    .如果真结束
    
.否则
    赋值 (选择子夹, 2)
    载入 (资料变更窗口, _启动窗口, 真)
    回主界面 ()
.如果结束


.子程序 _自设班级毕业升级_被选择, 空白型, , 
.局部变量 操作时间, 日期时间型, , , 

.如果真 (不等于 (取文本右边 (.标题, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束

赋值 (操作时间, 到时间 (读配置项 (相加 (取运行目录 (), “\config.ini”), “Graduate”, “date2”, )))
.如果 (小于 (取时间间隔 (取现行时间 (), 操作时间, 3), 6))
    .如果真 (等于 (信息框 (相加 (“  在”, 时间到文本 (操作时间, 2), “已经进行了自设班级的毕业升级操作！现在还要进行毕业升级操作吗？   ”), 相加 (#警告图标, #是否钮), “询问”), #是钮))
        载入 (自设毕业窗口, _启动窗口, 真)
        回主界面 ()
    .如果真结束
    
.否则
    载入 (自设毕业窗口, _启动窗口, 真)
    回主界面 ()
.如果结束


.子程序 _期中成绩录入_被选择, 空白型, , 
.局部变量 计次, 整数型, , , 

.如果真 (不等于 (取文本左边 (.标题, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (填充班级名称 (), 假))
    信息框 (“目前没有班级数据，请先进行校务设置！”, 0, “提示”)
    _校务设置_被选择 ()
    返回 ()
.如果真结束

填充成绩表头 ()
清空 ()
清空 ()
.计次循环首 (12, 计次)
    1.取文本 (计次).加入项目 ()
    .如果真 (小于或等于 (计次, 10))
        相加 (1.取文本 (相加 (计次, 2)), “成绩”).加入项目 ()
    .如果真结束
    
.计次循环尾 ()
赋值 (.现行选中项, 0)
赋值 (.现行选中项, 0)
赋值 (.现行选中项, 1)
填充成绩表 ()
解除打印禁止 ()
赋值 (.现行子夹, 4)
获取焦点 ()


.子程序 填充成绩表, 空白型, , 
置等待鼠标 ()
赋值 (.数据源, “”)
2.置文本 (“当前状态：数据载入中请稍侯......”)
.如果 (等于 (.现行选中项, 0))
    .如果 (大于 (.现行选中项, 1))
        .如果 (等于 (.现行选中项, 0))
            赋值 (.查询SQL, 相加 (“select 学号,姓名,期中1,期中2,期中3,期中4,期中5,期中6,期中7,期中8,期中9,期中10 from 学籍表 where 所在班级='”, .内容, “'order by 期中”, 到文本 (相减 (.现行选中项, 1)), “ desc”))
        .否则
            赋值 (.查询SQL, 相加 (“select 学号,姓名,期中1,期中2,期中3,期中4,期中5,期中6,期中7,期中8,期中9,期中10 from 学籍表 where 所在班级='”, .内容, “'order by 期中”, 到文本 (相减 (.现行选中项, 1))))
        .如果结束
        
    .否则
        .如果 (等于 (.现行选中项, 0))
            赋值 (.查询SQL, 相加 (“select 学号,姓名,期中1,期中2,期中3,期中4,期中5,期中6,期中7,期中8,期中9,期中10 from 学籍表 where 所在班级='”, .内容, “'order by ”, .内容))
        .否则
            赋值 (.查询SQL, 相加 (“select 学号,姓名,期中1,期中2,期中3,期中4,期中5,期中6,期中7,期中8,期中9,期中10 from 学籍表 where 所在班级='”, .内容, “'order by ”, .内容, “ desc”))
        .如果结束
        
    .如果结束
    
.否则
    .如果 (大于 (.现行选中项, 1))
        .如果 (等于 (.现行选中项, 0))
            赋值 (.查询SQL, 相加 (“select 学号,姓名,期末1,期末2,期末3,期末4,期末5,期末6,期末7,期末8,期末9,期末10 from 学籍表 where 所在班级='”, .内容, “'order by 期末”, 到文本 (相减 (.现行选中项, 1)), “ desc”))
        .否则
            赋值 (.查询SQL, 相加 (“select 学号,姓名,期末1,期末2,期末3,期末4,期末5,期末6,期末7,期末8,期末9,期末10 from 学籍表 where 所在班级='”, .内容, “'order by 期末”, 到文本 (相减 (.现行选中项, 1))))
        .如果结束
        
    .否则
        .如果 (等于 (.现行选中项, 0))
            赋值 (.查询SQL, 相加 (“select 学号,姓名,期末1,期末2,期末3,期末4,期末5,期末6,期末7,期末8,期末9,期末10 from 学籍表 where 所在班级='”, .内容, “'order by ”, .内容))
        .否则
            赋值 (.查询SQL, 相加 (“select 学号,姓名,期末1,期末2,期末3,期末4,期末5,期末6,期末7,期末8,期末9,期末10 from 学籍表 where 所在班级='”, .内容, “'order by ”, .内容, “ desc”))
        .如果结束
        
    .如果结束
    
.如果结束
.添加 ()
1.置对齐方式 (1, 取行数 (), 12, 5)
1.置只读方式 (1, 取行数 (), 2, 真)
2.置文本输入格式 (3, 取行数 (), 10, 6)
赋值 (.数据源, “成绩源”)
2.置光标 (3)
赋值 (.标题, 相加 (.标题, .内容, .内容))
获取焦点 ()
2.置文本 (“    当前状态：学生成绩管理”)
3.置文本 (“  提示：用鼠标或方向键移动方格光标，在光标内输入成绩后按回车键。”)
恢复鼠标 ()

.子程序 _期末成绩录入_被选择, 空白型, , 
.局部变量 计次, 整数型, , , 

.如果真 (不等于 (取文本左边 (.标题, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束

.如果真 (等于 (填充班级名称 (), 假))
    信息框 (“目前没有班级数据，请先进行校务设置！”, 0, “提示”)
    _校务设置_被选择 ()
    返回 ()
.如果真结束

填充成绩表头 ()
清空 ()
清空 ()
.计次循环首 (12, 计次)
    1.取文本 (计次).加入项目 ()
    .如果真 (小于或等于 (计次, 10))
        相加 (1.取文本 (相加 (计次, 2)), “成绩”).加入项目 ()
    .如果真结束
    
.计次循环尾 ()
赋值 (.现行选中项, 0)
赋值 (.现行选中项, 1)
赋值 (.现行选中项, 1)
填充成绩表 ()
解除打印禁止 ()
赋值 (.现行子夹, 4)
获取焦点 ()


.子程序 _成绩表班级组合框_列表项被选择, 空白型, , 
.局部变量 计次, 整数型, , , 

获取焦点 ()
填充成绩表头 ()
清空 ()
清空 ()
.计次循环首 (12, 计次)
    1.取文本 (计次).加入项目 ()
    .如果真 (小于或等于 (计次, 10))
        相加 (1.取文本 (相加 (计次, 2)), “成绩”).加入项目 ()
    .如果真结束
    
.计次循环尾 ()
赋值 (.现行选中项, 0)
赋值 (.现行选中项, 1)
填充成绩表 ()

.子程序 _考试时间组合框_列表项被选择, 空白型, , 
获取焦点 ()
填充成绩表头 ()
填充成绩表 ()

.子程序 _成绩表排序组合框_列表项被选择, 空白型, , 
获取焦点 ()
填充成绩表头 ()
填充成绩表 ()

.子程序 _成绩表格_选择行列数改变, 空白型, , 
.如果真 (小于 (取光标列号 (), 3))
    取光标行号 ().置光标 (3)
.如果真结束
光标行.置背景色 (1, 1, 取列数 (), #白色)
取光标行号 ().置背景色 (1, 1, 取列数 (), #银白)
赋值 (光标行, 取光标行号 ())

.子程序 _成绩表格_内容被改变, 空白型, , 
.参数 行号, 整数型, , 
.参数 列号, 整数型, , 
.参数 行数, 整数型, , 
.参数 列数, 整数型, , 

相减 (行号, 1).置文本 (列号, 行号.取文本 (列号))
保存更改 ()

.子程序 _清除科目成绩组合框_列表项被选择, 空白型, , 
获取焦点 ()

.子程序 _平均成绩统计钮_被单击, 空白型, , 
.局部变量 表项, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 次数, 整数型, , , 
.局部变量 科目, 文本型, , , 
.局部变量 成绩, 整数型, , , 

置等待鼠标 ()
.计次循环首 (10, 计次)
    相加 (计次, 2).置列图片 (-1)
    相加 (计次, 2).置列标题 (1.取文本 (相加 (计次, 2)))
.计次循环尾 ()
2.置列图片 (-1)
赋值 (排序方式, 真)
赋值 (上次单击列, 1)
.如果 (等于 (.现行选中项, 0))
    赋值 (科目, “期中”)
.否则
    赋值 (科目, “期末”)
.如果结束
赋值 (.标题, 相加 (.标题, 科目, “考试各班级各科平均成绩表”))
全部删除 ()
.计次循环首 (取项目数 (), 次数)
    赋值 (表项, .插入表项 (相减 (次数, 1)))
    表项.置标题 (1, 相减 (次数, 1).取项目文本 ())
    .计次循环首 (10, 计次)
        赋值 (记录, 相加 (“SELECT Avg(”, 科目, 到文本 (计次), “) AS 平均成绩 FROM 学籍表 WHERE 所在班级='”, 相减 (次数, 1).取项目文本 (), “' and ”, 科目, 到文本 (计次), “>0”).查询 ())
        赋值 (成绩, 四舍五入 (到数值 (记录.读 (“平均成绩”)), 0))
        .如果真 (不等于 (成绩, 0))
            表项.置标题 (相加 (计次, 2), 到文本 (成绩))
        .如果真结束
        表项.置标题 (2, 到文本 (相加 (到数值 (表项.取标题 (2)), 成绩)))
        记录.关闭记录集 ()
    .计次循环尾 ()
.计次循环尾 ()
3.置文本 (“  提示：用鼠标双击选择项可查看该班级的详细成绩情况。”)
恢复鼠标 ()
赋值 (.现行子夹, 8)


.子程序 _清空成绩钮_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 

.如果 (等于 (信息框 (相加 (“您确定要将当前成绩表中的”, .内容, “数据全部清空吗？清除的数据将不能恢复！”), 相加 (#警告图标, #确认取消钮), “询问”), #确认钮))
    置等待鼠标 ()
    .计次循环首 (取行数 (), 计次)
        相加 (计次, 1).置文本 (相加 (.现行选中项, 3), “”)
        计次.置文本 (相加 (.现行选中项, 3), “null”)
    .计次循环尾 ()
    保存更改 ()
    保存更改 ()
    获取焦点 ()
    恢复鼠标 ()
.否则
    获取焦点 ()
.如果结束


.子程序 _统计表返回钮_被单击, 空白型, , 
3.置文本 (“  提示：用鼠标或方向键移动方格光标，在光标内输入成绩后按回车键。”)
赋值 (.现行子夹, 4)
获取焦点 ()

.子程序 _平均成绩统计列表框_表头被单击, 空白型, , 
.参数 被单击列索引, 整数型, , 

.局部变量 比较类型, 整数型, , , 

置等待鼠标 ()
.如果 (等于 (被单击列索引, 上次单击列))
    赋值 (排序方式, 取反 (排序方式))
    被单击列索引.置列图片 (取绝对值 (相减 (被单击列索引.取列图片 (), 1)))
.否则
    赋值 (排序方式, 真)
    上次单击列.置列图片 (-1)
    被单击列索引.置列图片 (0)
.如果结束

.如果 (等于 (被单击列索引, 1))
    赋值 (比较类型, 1)
.否则
    赋值 (比较类型, 0)
.如果结束

超级列表框排序 (被单击列索引, 比较类型, 真, 排序方式)
赋值 (上次单击列, 被单击列索引)
恢复鼠标 ()

.子程序 _平均成绩统计列表框_表项被激活, 空白型, , 
.取标题 (., 1).选择 ()
填充成绩表头 ()
填充成绩表 ()
赋值 (.现行子夹, 4)

.子程序 _查看学生资料_被选择, 空白型, , 
.如果真 (不等于 (取文本左边 (.标题, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束

.如果真 (等于 (填充班级名称 (), 假))
    信息框 (“目前没有班级数据，请先进行校务设置!”, 0, “提示”)
    _校务设置_被选择 ()
    返回 ()
.如果真结束
填充查看科目 ()
赋值 (学生分类, “在校学生”)
填充学生姓名 ()
赋值 (., 0)
填充学生资料 ()
3.置文本 (“    提示： 右击姓名列表可弹出操作菜单，双击照片查看可放大的照片。”)
解除打印禁止 ()
赋值 (.现行子夹, 1)


.子程序 填充学生姓名, 空白型, , 
置等待鼠标 ()
.判断开始 (等于 (学生分类, “在校学生”))
    赋值 (记录, 相加 (“select [学号],[姓名],[性别] from [学籍表] where [所在班级]='”, .内容, “' order by [姓名]”).查询 ())
.判断 (等于 (学生分类, “毕业学生”))
    赋值 (记录, 相加 (“select 学号,姓名,性别 from 毕业表 where 离校时间='”, .内容, “' order by 姓名”).查询 ())
.判断 (等于 (学生分类, “离校学生”))
    赋值 (记录, “select 学号,姓名,性别 from 转退表 order by 姓名”.查询 ())
.默认
    
.判断结束

#顶层.调整层次 ()
赋值 (.可视, 真)
赋值 (.位置, 0)
赋值 (男, 0)
赋值 (女, 0)
全部删除 ()
记录.到首记录 ()
.判断循环首 (等于 (记录.尾记录后 (), 假))
    .插入表项 (记录.读 (“姓名”), 0, , , 到数值 (记录.读 (“学号”)))
    .如果 (等于 (记录.读 (“性别”), “男”))
        赋值 (男, 相加 (男, 1))
    .否则
        赋值 (女, 相加 (女, 1))
    .如果结束
    赋值 (.位置, 相加 (.位置, 1))
    .如果真 (等于 (.位置, .最大位置))
        赋值 (.位置, 0)
    .如果真结束
    记录.到后一记录 ()
.判断循环尾 ()
记录.关闭记录集 ()
赋值 (.可视, 假)
.判断开始 (等于 (学生分类, “在校学生”))
    2.置文本 (“    当前状态：查看在校学生资料”)
    赋值 (.标题, 相加 (“本班共有”, 到文本 (取表项数 ()), “人 其中男”, 到文本 (男), “人 女”, 到文本 (女), “人”))
.判断 (等于 (学生分类, “毕业学生”))
    2.置文本 (“    当前状态：查看毕业学生资料”)
    赋值 (.标题, 相加 (“共有”, 到文本 (取表项数 ()), “人毕业 其中男”, 到文本 (男), “人 女”, 到文本 (女), “人”))
.判断 (等于 (学生分类, “离校学生”))
    2.置文本 (“    当前状态：查看离校学生资料”)
    赋值 (.标题, 相加 (“共有”, 到文本 (取表项数 ()), “人离校 其中男”, 到文本 (男), “人 女”, 到文本 (女), “人”))
.默认
    
.判断结束
恢复鼠标 ()

.子程序 填充学生资料, 空白型, , 
.局部变量 当前学号, 文本型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 科目成绩, 文本型, , "10", 

赋值 (当前学号, 到文本 (.取表项数值 (.)))
.判断开始 (等于 (学生分类, “在校学生”))
    .如果 (大于 (取表项数 (), 0))
        赋值 (记录, 相加 (“select * from 学籍表 where 学号=”, 当前学号).查询 ())
    .否则
        记录.关闭记录集 ()
        填充空学生资料 ()
        赋值 (.可视, 假)
        赋值 (.标题, “”)
        赋值 (.标题, 相加 (.标题, .取项目文本 (.现行选中项), “目前没有学生资料”))
        返回 ()
    .如果结束
    
.判断 (等于 (学生分类, “毕业学生”))
    .如果 (大于 (取表项数 (), 0))
        赋值 (记录, 相加 (“select * from 毕业表 where 学号=”, 当前学号).查询 ())
    .否则
        记录.关闭记录集 ()
        填充空学生资料 ()
        赋值 (.可视, 假)
        赋值 (.标题, “”)
        赋值 (.标题, 相加 (“没有”, .内容, “毕业的学生资料”))
        返回 ()
    .如果结束
    
.判断 (等于 (学生分类, “离校学生”))
    .如果 (大于 (取表项数 (), 0))
        赋值 (记录, 相加 (“select * from 转退表 where 学号=”, 当前学号).查询 ())
    .否则
        记录.关闭记录集 ()
        填充空学生资料 ()
        赋值 (.可视, 假)
        赋值 (.标题, “”)
        赋值 (.标题, “本校目前没有因转学、退学等原因离校的学生资料”)
        返回 ()
    .如果结束
    
.默认
    
.判断结束
记录.到首记录 ()
赋值 (.标题, 到文本 (记录.读 (“学号”)))
赋值 (.标题, 记录.读 (“姓名”))
赋值 (.标题, 记录.读 (“性别”))
赋值 (.标题, 记录.读 (“民族”))
赋值 (.标题, 记录.读 (“出生日期”))
赋值 (.标题, 记录.读 (“入学日期”))
赋值 (.标题, 记录.读 (“所在班级”))
赋值 (.标题, 记录.读 (“班内职务”))
赋值 (.标题, 记录.读 (“家庭住址”))
赋值 (.标题, 到文本 (记录.读 (“联系电话”)))
赋值 (.标题, 记录.读 (“籍贯”))
赋值 (.标题, 记录.读 (“户籍”))
赋值 (.标题, 相加 (记录.读 (“家长A”), “姓名”))
赋值 (.标题, 记录.读 (“家长A姓名”))
赋值 (.标题, 记录.读 (“家长A单位”))
赋值 (.标题, 记录.读 (“家长A电话”))
赋值 (.标题, 相加 (记录.读 (“家长B”), “姓名”))
赋值 (.标题, 记录.读 (“家长B姓名”))
赋值 (.标题, 记录.读 (“家长B单位”))
赋值 (.标题, 记录.读 (“家长B电话”))
赋值 (.图片, 到字节集 (记录.读 (“照片”)))
赋值 (.内容, 到文本 (记录.读 (“本学期评语”)))
赋值 (.内容, 相加 (#换行符, “本学期评语：”, #换行符, #换行符, .内容, #换行符, #换行符, “综合评价：”, #换行符, #换行符, 到文本 (记录.读 (“综合评语”))))

.计次循环首 (10, 计次)
    赋值 (科目成绩 [计次], 到文本 (记录.读 (相加 (“期中”, 到文本 (计次)))))
    .如果真 (等于 (科目成绩 [计次], “0”))
        赋值 (科目成绩 [计次], “”)
    .如果真结束
    
.计次循环尾 ()
赋值 (.标题, 科目成绩 [1])
赋值 (.标题, 科目成绩 [2])
赋值 (.标题, 科目成绩 [3])
赋值 (.标题, 科目成绩 [4])
赋值 (.标题, 科目成绩 [5])
赋值 (.标题, 科目成绩 [6])
赋值 (.标题, 科目成绩 [7])
赋值 (.标题, 科目成绩 [8])
赋值 (.标题, 科目成绩 [9])
赋值 (.标题, 科目成绩 [10])
重定义数组 (科目成绩, 假, 10)
.计次循环首 (10, 计次)
    赋值 (科目成绩 [计次], 到文本 (记录.读 (相加 (“期末”, 到文本 (计次)))))
    .如果真 (等于 (科目成绩 [计次], “0”))
        赋值 (科目成绩 [计次], “”)
    .如果真结束
    
.计次循环尾 ()
赋值 (.标题, 科目成绩 [1])
赋值 (.标题, 科目成绩 [2])
赋值 (.标题, 科目成绩 [3])
赋值 (.标题, 科目成绩 [4])
赋值 (.标题, 科目成绩 [5])
赋值 (.标题, 科目成绩 [6])
赋值 (.标题, 科目成绩 [7])
赋值 (.标题, 科目成绩 [8])
赋值 (.标题, 科目成绩 [9])
赋值 (.标题, 科目成绩 [10])

.判断开始 (等于 (学生分类, “在校学生”))
    赋值 (.标题, “本班班主任：”)
    赋值 (.标题, .内容)
    赋值 (.标题, 相加 (.标题, .标题, .取标题 (., ), “同学的资料”))
    赋值 (.可视, 假)
    赋值 (.标题, “”)
.判断 (等于 (学生分类, “毕业学生”))
    赋值 (.标题, “个人详细资料”)
    赋值 (.标题, “”)
    赋值 (.标题, 相加 (.标题, 取文本左边 (.内容, 6), “毕业生”, .取标题 (., ), “同学的资料”))
    赋值 (.可视, 假)
    赋值 (.标题, “”)
.判断 (等于 (学生分类, “离校学生”))
    赋值 (.标题, “个人详细资料”)
    赋值 (.标题, “”)
    赋值 (.标题, 相加 (.标题, .标题, .取标题 (., ), “同学的资料(已离校)”))
    赋值 (.可视, 真)
    赋值 (.标题, 相加 (.标题, “同学已离开本校(点击查看详细)”))
    赋值 (.标题, 相加 (“    ”, .标题, “同学已于”, 记录.读 (“离校时间”), “离开本校”, #换行符, #换行符, “    离开本校的原因是：”, 记录.读 (“离校原因”)))
.默认
    
.判断结束


记录.关闭记录集 ()

.子程序 填充空学生资料, 空白型, , 
连续赋值 (“”, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .内容, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .内容)
连续赋值 (“家长姓名”, .标题, .标题)
赋值 (.图片, {  })

.子程序 _查看班级名组合框_列表项被选择, 空白型, , 
赋值 (.现行选中项, .现行选中项)
.如果 (等于 (学生分类, “在校学生”))
    填充查看科目 ()
.否则
    离校科目 ()
.如果结束

获取焦点 ()
填充学生姓名 ()
赋值 (., 0)
填充学生资料 ()

.子程序 _查看学生列表框_当前表项被改变, 空白型, , 
填充学生资料 ()

.子程序 _查看学生列表框_右键单击表项, 空白型, , 
.判断开始 (等于 (学生分类, “在校学生”))
    弹出菜单 ()
.判断 (等于 (学生分类, “离校学生”))
    弹出菜单 ()
.判断 (等于 (学生分类, “毕业学生”))
    弹出菜单 ()
.默认
    
.判断结束


.子程序 _毕业学生资料_被选择, 空白型, , 
.如果真 (不等于 (取文本左边 (.标题, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束
赋值 (学生分类, “毕业学生”)
清空 ()
赋值 (记录, “select * from 毕业时间表 ”.查询 ())
记录.到首记录 ()
.判断循环首 (等于 (记录.尾记录后 (), 假))
    0.插入项目 (到文本 (记录.读 (“毕业时间”)), )
    记录.到后一记录 ()
.判断循环尾 ()
记录.关闭记录集 ()
.如果真 (等于 (取项目数 (), 0))
    填充空学生资料 ()
    赋值 (.标题, “本校目前没有毕业学生数据”)
    赋值 (.标题, “”)
    全部删除 ()
    信息框 (“目前没有毕业学生数据！”, 0, )
    返回 ()
.如果真结束
离校科目 ()
赋值 (.现行选中项, 0)
填充学生姓名 ()
赋值 (., 0)
填充学生资料 ()
3.置文本 (“    提示： 双击照片查看可放大的照片。毕业学生的资料不能被修改。”)
解除打印禁止 ()
赋值 (.现行子夹, 1)
.如果真 (等于 (取表项数 (), 0))
    信息框 (相加 (“没有”, 取文本左边 (.内容, 6), “毕业的学生数据！”), 0, )
.如果真结束


.子程序 离校科目, 空白型, , 
赋值 (.标题, “第1科”)
赋值 (.标题, “第2科”)
赋值 (.标题, “第3科”)
赋值 (.标题, “第4科”)
赋值 (.标题, “第5科”)
赋值 (.标题, “第6科”)
赋值 (.标题, “第7科”)
赋值 (.标题, “第8科”)
赋值 (.标题, “第9科”)
赋值 (.标题, “第10科”)

.子程序 _转退学生资料_被选择, 空白型, , 
.如果真 (不等于 (取文本左边 (.标题, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束
清空 ()
“离校学生资料”.加入项目 ()
赋值 (.现行选中项, 0)
赋值 (学生分类, “离校学生”)
填充学生姓名 ()
.如果真 (等于 (取表项数 (), 0))
    填充空学生资料 ()
    赋值 (.标题, “本校目前没有因转学、退学等原因离校的学生资料”)
    信息框 (“目前本校没有因转学、退学等原因离校的学生数据！”, 0, )
    返回 ()
.如果真结束
离校科目 ()
赋值 (., 0)
填充学生资料 ()
3.置文本 (“    提示： 右击姓名列表可弹出操作菜单，双击照片查看可放大的照片。”)
解除打印禁止 ()
赋值 (.现行子夹, 1)

.子程序 _在校学生列表_被选择, 空白型, , 
.如果真 (不等于 (取文本左边 (.标题, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束

.如果真 (等于 (填充班级名称 (), 假))
    信息框 (“目前没有班级数据，请先进行校务设置！”, 0, “提示”)
    _校务设置_被选择 ()
    返回 ()
.如果真结束
赋值 (搜索资料, 假)
赋值 (.现行选中项, 0)
赋值 (记录, 相加 (“select 学号,姓名,性别,民族,出生日期,入学日期,所在班级,班内职务,联系电话 from 学籍表 where 所在班级='”, .内容, “' order by 姓名”).查询 ())
填充学生列表 ()
赋值 (.现行子夹, 3)
3.置文本 (“    提示： 双击选择项可查看详细资料，右击选择项可弹出操作菜单！”)
解除打印禁止 ()
赋值 (.现行子夹, 3)


.子程序 置排序标, 空白型, , 
.参数 排序列表框, 超级列表框, , 

.局部变量 计次, 整数型, , , 

.计次循环首 (9, 计次)
    排序列表框.置列图片 (计次, -1)
.计次循环尾 ()
排序列表框.置列图片 (2, 0)
赋值 (排序方式, 真)
赋值 (上次单击列, 2)

.子程序 填充学生列表, 空白型, , 
.局部变量 表项, 整数型, , , 

置排序标 ()
全部删除 ()
#顶层.调整层次 ()
赋值 (.可视, 真)
赋值 (.位置, 0)
赋值 (男, 0)
赋值 (女, 0)
赋值 (.标题, 相加 (.标题, .取项目文本 (.现行选中项), “学生花名册”))
记录.到首记录 ()
.判断循环首 (等于 (记录.尾记录后 (), 假))
    赋值 (表项, .插入表项 (“0”, , , , 相加 (男, 女)))
    表项.置标题 (1, 到文本 (记录.读 (“学号”)))
    表项.置标题 (2, 记录.读 (“姓名”))
    表项.置标题 (3, 记录.读 (“性别”))
    表项.置标题 (4, 记录.读 (“民族”))
    表项.置标题 (5, 记录.读 (“所在班级”))
    
    表项.置标题 (6, 记录.读 (“班内职务”))
    表项.置标题 (7, 记录.读 (“出生日期”))
    表项.置标题 (8, 记录.读 (“入学日期”))
    表项.置标题 (9, 到文本 (记录.读 (“联系电话”)))
    
    .如果 (等于 (记录.读 (“性别”), “男”))
        赋值 (男, 相加 (男, 1))
    .否则
        赋值 (女, 相加 (女, 1))
    .如果结束
    赋值 (.位置, 相加 (.位置, 1))
    .如果真 (等于 (.位置, .最大位置))
        赋值 (.位置, 0)
    .如果真结束
    记录.到后一记录 ()
    处理事件 ()
.判断循环尾 ()
赋值 (.可视, 假)
.如果 (等于 (搜索资料, 假))
    2.置文本 (“    当前状态：在校学生列表”)
    赋值 (.标题, 相加 (“本班共有”, 到文本 (相加 (男, 女)), “人 其中男生”, 到文本 (男), “人 女生”, 到文本 (女), “人”))
.否则
    2.置文本 (“    当前状态：搜索学生资料”)
.如果结束

记录.关闭记录集 ()
赋值 (., 0)

.子程序 _在校生列表班级组合框_列表项被选择, 空白型, , 
获取焦点 ()
赋值 (搜索资料, 假)
赋值 (记录, 相加 (“select 学号,姓名,性别,民族,出生日期,入学日期,所在班级,班内职务,联系电话 from 学籍表 where 所在班级='”, .内容, “' order by 姓名”).查询 ())
填充学生列表 ()


.子程序 _在校生列表框_右键单击表项, 空白型, , 
弹出菜单 ()

.子程序 _在校生列表框_表项被激活, 空白型, , 
.如果真 (等于 (填充班级名称 (), 假))
    信息框 (“目前没有班级数据，请先进行系统设置!”, 0, “提示”)
    _校务设置_被选择 ()
    返回 ()
.如果真结束
填充查看科目 ()
赋值 (学生分类, “在校学生”)
.取标题 (., 5).选择 ()
填充学生姓名 ()
.查找表项数值 (到数值 (.取标题 (., 1))).选择表项 ()
.保证显示 (.)
填充学生资料 ()
3.置文本 (“    提示： 右击姓名列表可弹出操作菜单，双击照片查看可放大的照片。”)
解除打印禁止 ()
赋值 (.现行子夹, 1)


.子程序 _搜索在校生组合框_列表项被选择, 空白型, , 
获取焦点 ()
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _班内搜索_被单击, 空白型, , 
.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“请输入搜索条件！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (搜索资料, 真)
赋值 (全局搜索, 假)
赋值 (记录, 相加 (“select 学号,姓名,性别,民族,出生日期,入学日期,所在班级,班内职务,联系电话 from 学籍表 where 所在班级='”, .内容, “'and ”, .内容, “ like'”, 删全部空 (.内容), “%' order by 姓名”).查询 ())
填充学生列表 ()
赋值 (.标题, 相加 (.标题, .内容, “部分学生花名册”))
.如果 (等于 (取表项数 (), 0))
    信息框 (“未找到符合条件的资料！”, 0, )
.否则
    信息框 (相加 (#换行符, #换行符, “  搜索结果：在”, .内容, “搜索到”, 到文本 (相加 (男, 女)), “个符合条件的学生资料 其中男生”, 到文本 (男), “人 女生”, 到文本 (女), “人  ”), 0, )
.如果结束
获取焦点 ()
赋值 (.被选择字符数, 取文本长度 (.内容))


.子程序 _全校搜索_被单击, 空白型, , 
.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“请输入搜索条件！”, 0, )
    获取焦点 ()
    返回 ()
    
.如果真结束
赋值 (搜索资料, 真)
赋值 (全局搜索, 真)
赋值 (记录, 相加 (“select 学号,姓名,性别,民族,出生日期,入学日期,所在班级,班内职务,联系电话 from 学籍表 where ”, .内容, “ like'”, 删全部空 (.内容), “%' order by 姓名”).查询 ())
填充学生列表 ()
赋值 (.标题, 相加 (.标题, “部分学生花名册”))
.如果 (等于 (取表项数 (), 0))
    信息框 (“未找到符合条件的资料！”, 0, )
.否则
    信息框 (相加 (#换行符, #换行符, “  搜索结果：在全校搜索到”, 到文本 (相加 (男, 女)), “个符合条件的学生资料 其中男生”, 到文本 (男), “人 女生”, 到文本 (女), “人  ”), 0, )
.如果结束
获取焦点 ()
赋值 (.被选择字符数, 取文本长度 (.内容))


.子程序 _毕业学生列表_被选择, 空白型, , 
.如果真 (不等于 (取文本左边 (.标题, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束
赋值 (记录, “select * from 毕业时间表”.查询 ())
记录.到首记录 ()
.如果真 (等于 (记录, 0))
    记录.关闭记录集 ()
    信息框 (“目前没有毕业生数据！”, 0, )
    返回 ()
.如果真结束

清空 ()
.判断循环首 (等于 (记录.尾记录后 (), 假))
    0.插入项目 (记录.读 (“毕业时间”), )
    记录.到后一记录 ()
.判断循环尾 ()
记录.关闭记录集 ()
赋值 (.现行选中项, 0)

.如果真 (等于 (取项目数 (), 0))
    信息框 (相加 (取文本左边 (.内容, 6), “没有毕业生数据！”), 0, )
    返回 ()
.如果真结束
赋值 (搜索资料, 假)
赋值 (.可视, 真)
赋值 (.标题, “本届搜索”)
赋值 (.现行子夹, 2)
赋值 (.可视, 假)
赋值 (学生分类, “毕业学生”)
8.置列标题 (“离校时间”)
赋值 (.标题, 相加 (.标题, 取文本左边 (.内容, 6), “毕业学生花名册”))
赋值 (记录, 相加 (“select 学号,姓名,性别,民族,出生日期,离校时间,所在班级,班内职务,联系电话 from 毕业表 where 离校时间='”, .内容, “' order by 姓名”).查询 ())
填充离校生列表 ()
2.置文本 (“    当前状态：毕业学生列表”)
赋值 (.标题, 相加 (“本年度毕业生”, 到文本 (相加 (男, 女)), “人 其中男生”, 到文本 (男), “人 女生”, 到文本 (女), “人”))


.子程序 _转退学生列表_被选择, 空白型, , 
.局部变量 原分类, 文本型, , , 

.如果真 (不等于 (取文本左边 (.标题, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束
赋值 (原分类, 学生分类)
赋值 (学生分类, “离校学生”)
赋值 (.可视, 假)
赋值 (.标题, “开始搜索”)
赋值 (搜索资料, 假)
赋值 (记录, “select 学号,姓名,性别,民族,出生日期,离校时间,所在班级,班内职务,联系电话 from 转退表 order by 姓名”.查询 ())
填充离校生列表 ()
.如果真 (等于 (取表项数 (), 0))
    赋值 (学生分类, 原分类)
    信息框 (“目前本校没有因转学、退学等原因离校的学生数据！”, 0, )
    返回 ()
.如果真结束

赋值 (.标题, 相加 (“本校因转学、退学等原因离校的共有”, 到文本 (相加 (男, 女)), “人 其中男生”, 到文本 (男), “人 女生”, 到文本 (女), “人”))
8.置列标题 (“离校时间”)
赋值 (.可视, 真)
赋值 (.标题, 相加 (.标题, “因转学、退学等原因离校的学生花名册”))
2.置文本 (“    当前状态：转退学生列表”)
赋值 (.现行子夹, 2)


.子程序 填充离校生列表, 空白型, , 
.局部变量 表项, 整数型, , , 

置等待鼠标 ()
#顶层.调整层次 ()
赋值 (.可视, 真)
赋值 (.位置, 0)
置排序标 ()
全部删除 ()
赋值 (男, 0)
赋值 (女, 0)
记录.到首记录 ()
.判断循环首 (等于 (记录.尾记录后 (), 假))
    赋值 (表项, .插入表项 (“0”, , , , ))
    表项.置标题 (1, 到文本 (记录.读 (“学号”)))
    表项.置标题 (2, 记录.读 (“姓名”))
    表项.置标题 (3, 记录.读 (“性别”))
    表项.置标题 (4, 记录.读 (“民族”))
    表项.置标题 (5, 记录.读 (“所在班级”))
    表项.置标题 (6, 记录.读 (“班内职务”))
    表项.置标题 (7, 记录.读 (“出生日期”))
    表项.置标题 (8, 记录.读 (“离校时间”))
    表项.置标题 (9, 到文本 (记录.读 (“联系电话”)))
    .如果 (等于 (记录.读 (“性别”), “男”))
        赋值 (男, 相加 (男, 1))
    .否则
        赋值 (女, 相加 (女, 1))
    .如果结束
    赋值 (.位置, 相加 (.位置, 1))
    .如果真 (等于 (.位置, .最大位置))
        赋值 (.位置, 0)
    .如果真结束
    记录.到后一记录 ()
    处理事件 ()
.判断循环尾 ()
记录.关闭记录集 ()
赋值 (.可视, 假)
赋值 (., 0)
恢复鼠标 ()


.子程序 _毕业日期组合框_列表项被选择, 空白型, , 
获取焦点 ()
赋值 (搜索资料, 假)
赋值 (.标题, 相加 (.标题, 取文本左边 (.内容, 6), “毕业学生花名册”))
赋值 (记录, 相加 (“select 学号,姓名,性别,民族,出生日期,离校时间,所在班级,班内职务,联系电话 from 毕业表 where 离校时间='”, .内容, “' order by 姓名”).查询 ())
填充离校生列表 ()
赋值 (.标题, 相加 (“本年度毕业生”, 到文本 (相加 (男, 女)), “人 其中男生”, 到文本 (男), “人 女生”, 到文本 (女), “人”))
2.置文本 (“    当前状态：毕业学生列表”)

.子程序 _毕业离校列表框_表项被激活, 空白型, , 

.判断开始 (等于 (学生分类, “离校学生”))
    填充学生姓名 ()
    .取标题 (., 2).查找表项 ().选择表项 ()
    .保证显示 (.)
    填充学生资料 ()
    2.置文本 (“    当前状态：查看离校学生资料”)
    3.置文本 (“    提示： 右击姓名列表可弹出操作菜单，双击照片查看可放大的照片。”)
    解除打印禁止 ()
    赋值 (.现行子夹, 1)
.判断 (等于 (学生分类, “毕业学生”))
    赋值 (记录, “select * from 毕业时间表 ”.查询 ())
    .如果真 (等于 (记录, 0))
        记录.关闭记录集 ()
        返回 ()
    .如果真结束
    清空 ()
    记录.到首记录 ()
    .判断循环首 (等于 (记录.尾记录后 (), 假))
        记录.读 (“毕业时间”).加入项目 ()
        记录.到后一记录 ()
    .判断循环尾 ()
    记录.关闭记录集 ()
    .取标题 (., 8).选择 ()
    填充学生姓名 ()
    .取标题 (., 2).查找表项 ().选择表项 ()
    .保证显示 (.)
    填充学生资料 ()
    2.置文本 (“    当前状态：查看毕业学生资料”)
    3.置文本 (“    提示： 双击照片查看可放大的照片。毕业学生的资料不能被修改。”)
    解除打印禁止 ()
    赋值 (.现行子夹, 1)
    
.默认
    
.判断结束


.子程序 _毕业离校列表框_右键单击表项, 空白型, , 
弹出菜单 ()

.子程序 _搜索离校_被单击, 空白型, , 
.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“请输入搜索条件！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束

赋值 (搜索资料, 真)
赋值 (全局搜索, 假)
.如果 (等于 (学生分类, “毕业学生”))
    赋值 (记录, 相加 (“select 学号,姓名,性别,民族,出生日期,离校时间,所在班级,班内职务,联系电话 from 毕业表 where 离校时间='”, .内容, “' and ”, .内容, “ like'”, 删全部空 (.内容), “%' order by 姓名”).查询 ())
    填充离校生列表 ()
    赋值 (.标题, 相加 (.标题, 取文本左边 (.内容, 6), “毕业的部分学生花名册”))
    .如果 (等于 (取表项数 (), 0))
        信息框 (“未找到符合条件的资料！”, 0, )
    .否则
        信息框 (相加 (#换行符, #换行符, “  搜索结果：在”, 取文本左边 (.内容, 6), “毕业生中搜索到”, 到文本 (相加 (男, 女)), “个符合条件的学生资料 其中男生”, 到文本 (男), “人 女生”, 到文本 (女), “人  ”), 0, )
    .如果结束
    
.否则
    赋值 (记录, 相加 (“select 学号,姓名,性别,民族,出生日期,离校时间,所在班级,班内职务,联系电话 from 转退表 where ”, .内容, “ like'”, 删全部空 (.内容), “%' order by 姓名”).查询 ())
    填充离校生列表 ()
    赋值 (.标题, 相加 (.标题, “部分转退学生花名册”))
    .如果 (等于 (取表项数 (), 0))
        信息框 (“未找到符合条件的资料！”, 0, )
    .否则
        信息框 (相加 (#换行符, #换行符, “  搜索结果：搜索到”, 到文本 (相加 (男, 女)), “个符合条件的学生资料 其中男生”, 到文本 (男), “人 女生”, 到文本 (女), “人  ”), 0, )
    .如果结束
    
.如果结束
获取焦点 ()
赋值 (.被选择字符数, 取文本长度 (.内容))



.子程序 _历届搜索_被单击, 空白型, , 
.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“请输入搜索条件！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束

赋值 (搜索资料, 真)
赋值 (全局搜索, 真)
赋值 (记录, 相加 (“select 学号,姓名,性别,民族,出生日期,离校时间,所在班级,班内职务,联系电话 from 毕业表 where ”, .内容, “ like'”, 删全部空 (.内容), “%' order by 姓名”).查询 ())
填充离校生列表 ()
赋值 (.标题, 相加 (.标题, “部分毕业生花名册”))
.如果 (等于 (取表项数 (), 0))
    信息框 (“未找到符合条件的资料！”, 0, )
.否则
    信息框 (相加 (#换行符, #换行符, “  搜索结果：在历届毕业生中搜索到100个符合条件的学生资料 其中男生50人 女生50人  ”), 0, )
.如果结束
获取焦点 ()
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _搜索离校生组合框_列表项被选择, 空白型, , 
获取焦点 ()
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _在校生列表框_表头被单击, 空白型, , 
.参数 被单击列索引, 整数型, , 

.局部变量 比较类型, 整数型, , , 

置等待鼠标 ()
.如果 (等于 (被单击列索引, 上次单击列))
    赋值 (排序方式, 取反 (排序方式))
    被单击列索引.置列图片 (取绝对值 (相减 (被单击列索引.取列图片 (), 1)))
.否则
    赋值 (排序方式, 真)
    上次单击列.置列图片 (-1)
    被单击列索引.置列图片 (0)
.如果结束

.判断开始 (或者 (等于 (被单击列索引, 1), 等于 (被单击列索引, 9)))
    赋值 (比较类型, 0)
.判断 (或者 (等于 (被单击列索引, 7), 等于 (被单击列索引, 8)))
    赋值 (比较类型, 2)
.默认
    赋值 (比较类型, 1)
.判断结束

超级列表框排序 (被单击列索引, 比较类型, 真, 排序方式)
赋值 (上次单击列, 被单击列索引)
恢复鼠标 ()

.子程序 _毕业离校列表框_表头被单击, 空白型, , 
.参数 被单击列索引, 整数型, , 

.局部变量 比较类型, 整数型, , , 

置等待鼠标 ()
.如果 (等于 (被单击列索引, 上次单击列))
    赋值 (排序方式, 取反 (排序方式))
    被单击列索引.置列图片 (取绝对值 (相减 (被单击列索引.取列图片 (), 1)))
.否则
    赋值 (排序方式, 真)
    上次单击列.置列图片 (-1)
    被单击列索引.置列图片 (0)
.如果结束

.判断开始 (或者 (等于 (被单击列索引, 1), 等于 (被单击列索引, 9)))
    赋值 (比较类型, 0)
.判断 (或者 (等于 (被单击列索引, 7), 等于 (被单击列索引, 8)))
    赋值 (比较类型, 2)
.默认
    赋值 (比较类型, 1)
.判断结束

超级列表框排序 (被单击列索引, 比较类型, 真, 排序方式)
赋值 (上次单击列, 被单击列索引)
恢复鼠标 ()


.子程序 _添加教员档案_被选择, 空白型, , 
.如果真 (不等于 (取文本中间 (.标题, 2, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束

赋值 (修改资料, 假)
载入 (教员资料录入修改窗口, _启动窗口, 真)

.子程序 _修改教员档案_被选择, 空白型, , 
.如果真 (不等于 (取文本中间 (.标题, 2, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束
赋值 (修改资料, 真)
载入 (教员资料录入修改窗口, _启动窗口, 真)

.子程序 _教员退休操作_被选择, 空白型, , 
.如果真 (不等于 (取文本中间 (.标题, 2, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束

.如果 (或者 (等于 (.现行子夹, 5), 等于 (.现行子夹, 6)))
    .如果 (等于 (学生分类, “在职教员”))
        .如果 (或者 (不等于 (., -1), 不等于 (., -1)))
            赋值 (教员去向, “退休”)
            赋值 (选择子夹, 3)
            载入 (资料变更窗口, , 真)
        .否则
            信息框 (“  请先选择要退休的教员姓名！  ”, 0, )
        .如果结束
        
    .否则
        信息框 (相加 (“  本操作只能对在职教员操作！您现在操作的是：”, 学生分类, “资料。  ”), 0, )
    .如果结束
    
.否则
    信息框 (“  请先选择要退休的教员姓名！  ”, 0, )
    _查看教员档案_被选择 ()
.如果结束


.子程序 _教员调离操作_被选择, 空白型, , 
.如果真 (不等于 (取文本中间 (.标题, 2, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束

.如果 (或者 (等于 (.现行子夹, 5), 等于 (.现行子夹, 6)))
    .如果 (等于 (学生分类, “在职教员”))
        .如果 (或者 (不等于 (., -1), 不等于 (., -1)))
            赋值 (教员去向, “调离”)
            赋值 (选择子夹, 3)
            载入 (资料变更窗口, , 真)
        .否则
            信息框 (“  请先选择要调离本校的教员姓名！  ”, 0, )
        .如果结束
        
    .否则
        信息框 (相加 (“  本操作只能对在职教员操作！您现在操作的是：”, 学生分类, “资料。  ”), 0, )
    .如果结束
    
.否则
    信息框 (“  请先选择要退休的教员姓名！  ”, 0, )
    _查看教员档案_被选择 ()
.如果结束


.子程序 _查看教员档案_被选择, 空白型, , 
.如果真 (不等于 (取文本中间 (.标题, 2, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束
赋值 (学生分类, “在职教员”)
填充教员姓名 ()
赋值 (.标题, 相加 (“目前本校在职教员有”, 到文本 (取表项数 ()), “人，其中男”, 到文本 (男), “人，女”, 到文本 (女), “人。”))
赋值 (., 0)
填充教员资料 ()
2.置文本 (“    当前状态：查看在职教员资料”)
3.置文本 (“    提示： 右击姓名列表可弹出操作菜单，双击照片查看可放大的照片。”)
解除打印禁止 ()
赋值 (.现行子夹, 5)

.子程序 填充教员姓名, 空白型, , 
置等待鼠标 ()
#顶层.调整层次 ()
赋值 (.位置, 0)
赋值 (.可视, 真)
赋值 (男, 0)
赋值 (女, 0)
.判断开始 (等于 (学生分类, “在职教员”))
    赋值 (记录, “select 编号,姓名,性别 from 教员表 order by 姓名”.查询 ())
.判断 (等于 (学生分类, “退休教员”))
    赋值 (记录, “select 编号,姓名,性别 from 退休表 order by 姓名”.查询 ())
.判断 (等于 (学生分类, “调离教员”))
    赋值 (记录, “select 编号,姓名,性别 from 调离表 order by 姓名”.查询 ())
.默认
    
.判断结束

.如果 (不等于 (记录, 0))
    全部删除 ()
    记录.到首记录 ()
    .判断循环首 (等于 (记录.尾记录后 (), 假))
        .插入表项 (记录.读 (“姓名”), 0, , , 到数值 (记录.读 (“编号”)))
        .如果 (等于 (记录.读 (“性别”), “男”))
            赋值 (男, 相加 (男, 1))
        .否则
            赋值 (女, 相加 (女, 1))
        .如果结束
        赋值 (.位置, 相加 (.位置, 1))
        .如果真 (等于 (.位置, .最大位置))
            赋值 (.位置, 0)
        .如果真结束
        记录.到后一记录 ()
    .判断循环尾 ()
.否则
    信息框 (“载入教员姓名数据失败！”, 0, )
.如果结束
记录.关闭记录集 ()
赋值 (.可视, 假)
恢复鼠标 ()


.子程序 填充教员资料, 空白型, , 
.如果真 (等于 (取表项数 (), 0))
    .判断开始 (等于 (学生分类, “在职教员”))
        赋值 (.标题, 相加 (_启动窗口..标题, “目前没有在职教员的资料”))
    .判断 (等于 (学生分类, “退休教员”))
        赋值 (.标题, 相加 (_启动窗口..标题, “目前没有退休教员的资料”))
    .判断 (等于 (学生分类, “调离教员”))
        赋值 (.标题, 相加 (_启动窗口..标题, “目前没有调离本校的教员资料”))
    .默认
        
    .判断结束
    填充空教员资料 ()
    记录.关闭记录集 ()
    返回 ()
.如果真结束

.判断开始 (等于 (学生分类, “在职教员”))
    赋值 (记录, 相加 (“select * from 教员表 where 编号=”, 到文本 (.取表项数值 (.))).查询 ())
.判断 (等于 (学生分类, “退休教员”))
    赋值 (记录, 相加 (“select * from 退休表 where 编号=”, 到文本 (.取表项数值 (.))).查询 ())
.判断 (等于 (学生分类, “调离教员”))
    赋值 (记录, 相加 (“select * from 调离表 where 编号=”, 到文本 (.取表项数值 (.))).查询 ())
.默认
    
.判断结束

记录.到首记录 ()
赋值 (.标题, 记录.读 (“姓名”))
赋值 (.标题, 记录.读 (“性别”))
赋值 (.标题, 记录.读 (“民族”))
赋值 (.标题, 记录.读 (“出生日期”))
赋值 (.标题, 记录.读 (“学历”))
赋值 (.标题, 记录.读 (“政治面貌”))
赋值 (.标题, 记录.读 (“参加工作时间”))
赋值 (.标题, 记录.读 (“调入本校时间”))
赋值 (.标题, 记录.读 (“职称”))
赋值 (.标题, 记录.读 (“职务或岗位”))
赋值 (.标题, 记录.读 (“身份证号”))
赋值 (.标题, 记录.读 (“手机号码”))
赋值 (.标题, 记录.读 (“家庭住址”))
赋值 (.标题, 到文本 (记录.读 (“住宅电话”)))
赋值 (.标题, 记录.读 (“籍贯”))
赋值 (.标题, 记录.读 (“户籍所在地”))
赋值 (.图片, 到字节集 (记录.读 (“照片”)))
赋值 (.内容, 到文本 (记录.读 (“个人简历”)))
赋值 (.内容, 相加 (“个人简历”, #换行符, #换行符, .内容, #换行符, #换行符, “其它资料”, #换行符, #换行符, 到文本 (记录.读 (“其他资料”))))
.判断开始 (等于 (学生分类, “在职教员”))
    赋值 (.标题, 相加 (_启动窗口..标题, .取标题 (., ), “同志的资料”))
    赋值 (.可视, 假)
    赋值 (.标题, “”)
.判断 (等于 (学生分类, “退休教员”))
    赋值 (.标题, 相加 (_启动窗口..标题, .取标题 (., ), “同志的资料(已退休)”))
    赋值 (.可视, 真)
    赋值 (.标题, 相加 (.标题, “同志已经自本校退休(点击查看详细)”))
    赋值 (.标题, 相加 (“    ”, .标题, “同志已于”, 记录.读 (“离校时间”), “自本校退休”, #换行符, #换行符, “    有关本次退休的说明：”, 记录.读 (“离校原因”)))
.判断 (等于 (学生分类, “调离教员”))
    赋值 (.标题, 相加 (_启动窗口..标题, .取标题 (., ), “同志的资料(已调离)”))
    赋值 (.可视, 真)
    赋值 (.标题, 相加 (.标题, “同志已经调离本校(点击查看详细)”))
    赋值 (.标题, 相加 (“    ”, .标题, “同志已于”, 记录.读 (“离校时间”), “调离本校”, #换行符, #换行符, “    调离本校的原因是：”, 记录.读 (“离校原因”)))
.默认
    
.判断结束

记录.关闭记录集 ()

.子程序 填充空教员资料, 空白型, , 
连续赋值 (“”, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .内容, .标题, .标题, .标题, .内容)
赋值 (.图片, {  })

.子程序 _查看教员列表框_当前表项被改变, 空白型, , 
填充教员资料 ()

.子程序 _退休教员档案_被选择, 空白型, , 
.如果真 (不等于 (取文本中间 (.标题, 2, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束
赋值 (学生分类, “退休教员”)
填充教员姓名 ()
赋值 (.标题, 相加 (“目前自本校退休的教员有”, 到文本 (取表项数 ()), “人，其中男”, 到文本 (男), “人，女”, 到文本 (女), “人。”))
赋值 (., 0)
填充教员资料 ()
2.置文本 (“    当前状态：查看退休教员资料”)
3.置文本 (“    提示： 双击照片查看可放大的照片。退休教员的资料不能被修改。”)
解除打印禁止 ()
赋值 (.现行子夹, 5)


.子程序 _调离教员档案_被选择, 空白型, , 
.如果真 (不等于 (取文本中间 (.标题, 2, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束
赋值 (学生分类, “调离教员”)
填充教员姓名 ()
赋值 (.标题, 相加 (“目前调离本校的教员有”, 到文本 (取表项数 ()), “人，其中男”, 到文本 (男), “人，女”, 到文本 (女), “人。”))
赋值 (., 0)
填充教员资料 ()
2.置文本 (“当前状态：查看调离本校的教员资料”)
3.置文本 (“    提示： 双击照片查看可放大的照片。调离教员的资料不能被修改。”)
解除打印禁止 ()
赋值 (.现行子夹, 5)


.子程序 _查看教员列表框_右键单击表项, 空白型, , 
.如果 (等于 (学生分类, “在职教员”))
    弹出菜单 ()
.否则
    弹出菜单 ()
.如果结束


.子程序 _在职教员列表_被选择, 空白型, , 
.如果真 (不等于 (取文本中间 (.标题, 2, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束
赋值 (搜索资料, 假)
赋值 (学生分类, “在职教员”)
8.置列标题 (“调入本校时间”)
6.置项目文本 (“调入本校时间”)
赋值 (记录, “select 编号,姓名,性别,民族,学历,职称,职务或岗位,参加工作时间,调入本校时间,住宅电话 from 教员表 order by 姓名”.查询 ())
填充教员列表 ()
赋值 (.标题, 相加 (“本校在职教员有”, 到文本 (相加 (男, 女)), “人 其中男”, 到文本 (男), “人 女”, 到文本 (女), “人”))
.如果 (大于 (取表项数 (), 0))
    赋值 (.标题, 相加 (.标题, “在职教员花名册”))
.否则
    赋值 (.标题, “目前本校没有在职教员数据”)
.如果结束
2.置文本 (“    当前状态：在职教员列表”)
3.置文本 (“    提示： 双击选择项可查看详细资料，右击选择项可弹出操作菜单！”)
解除打印禁止 ()
赋值 (.现行子夹, 6)


.子程序 填充教员列表, 空白型, , 
.局部变量 表项, 空白型, , , 

置等待鼠标 ()
.计次循环首 (9, 表项)
    表项.置列图片 (-1)
.计次循环尾 ()
1.置列图片 (0)
赋值 (排序方式, 真)
赋值 (上次单击列, 1)
#顶层.调整层次 ()
赋值 (.位置, 0)
赋值 (.可视, 真)
记录.到首记录 ()
全部删除 ()
赋值 (男, 0)
赋值 (女, 0)
.判断循环首 (等于 (记录.尾记录后 (), 假))
    赋值 (表项, .插入表项 (到文本 (记录.读 (“编号”)), , , , 相加 (男, 女)))
    表项.置标题 (1, 记录.读 (“姓名”))
    表项.置标题 (2, 记录.读 (“性别”))
    表项.置标题 (3, 记录.读 (“民族”))
    表项.置标题 (4, 记录.读 (“学历”))
    表项.置标题 (5, 记录.读 (“职称”))
    表项.置标题 (6, 记录.读 (“职务或岗位”))
    表项.置标题 (7, 记录.读 (“参加工作时间”))
    表项.置标题 (9, 到文本 (记录.读 (“住宅电话”)))
    .如果 (等于 (学生分类, “在职教员”))
        表项.置标题 (8, 记录.读 (“调入本校时间”))
    .否则
        表项.置标题 (8, 记录.读 (“离校时间”))
    .如果结束
    
    .如果 (等于 (记录.读 (“性别”), “男”))
        赋值 (男, 相加 (男, 1))
    .否则
        赋值 (女, 相加 (女, 1))
    .如果结束
    赋值 (.位置, 相加 (.位置, 1))
    .如果真 (等于 (.位置, .最大位置))
        赋值 (.位置, 0)
    .如果真结束
    记录.到后一记录 ()
    处理事件 ()
.判断循环尾 ()
.如果 (等于 (搜索资料, 真))
    2.置文本 (“    当前状态：搜索教员资料”)
.否则
    
.如果结束

记录.关闭记录集 ()
获取焦点 ()
恢复鼠标 ()


.子程序 _退休教员列表_被选择, 空白型, , 
.如果真 (不等于 (取文本中间 (.标题, 2, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束
赋值 (搜索资料, 假)
赋值 (学生分类, “退休教员”)
9.置列标题 (“退休时间”)
7.置项目文本 (“离校时间”)
赋值 (记录, “select 编号,姓名,性别,民族,学历,职称,职务或岗位,参加工作时间,离校时间,住宅电话 from 退休表 order by 姓名”.查询 ())
填充教员列表 ()
赋值 (.标题, 相加 (“自本校退休的教员有”, 到文本 (相加 (男, 女)), “人 其中男”, 到文本 (男), “人 女”, 到文本 (女), “人”))
.如果 (大于 (取表项数 (), 0))
    赋值 (.标题, 相加 (.标题, “退休教员花名册”))
.否则
    赋值 (.标题, “目前本校没有退休教员数据”)
.如果结束

2.置文本 (“    当前状态：退休教员列表”)
3.置文本 (“    提示： 双击选择项可查看详细资料，右击选择项可弹出操作菜单！”)
解除打印禁止 ()
赋值 (.现行子夹, 6)


.子程序 _调离教员列表_被选择, 空白型, , 
.如果真 (不等于 (取文本中间 (.标题, 2, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束
赋值 (搜索资料, 假)
赋值 (学生分类, “调离教员”)
9.置列标题 (“调离时间”)
7.置项目文本 (“离校时间”)
赋值 (记录, “select 编号,姓名,性别,民族,学历,职称,职务或岗位,参加工作时间,离校时间,住宅电话 from 调离表 order by 姓名”.查询 ())
填充教员列表 ()
赋值 (.标题, 相加 (“已调离本校的教员有”, 到文本 (相加 (男, 女)), “人 其中男”, 到文本 (男), “人 女”, 到文本 (女), “人”))
.如果 (大于 (取表项数 (), 0))
    赋值 (.标题, 相加 (.标题, “调离教员花名册”))
.否则
    赋值 (.标题, “目前本校没有调离教员数据”)
.如果结束
2.置文本 (“    当前状态：调离教员列表”)
3.置文本 (“    提示： 双击选择项可查看详细资料，右击选择项可弹出操作菜单！”)
解除打印禁止 ()
赋值 (.现行子夹, 6)


.子程序 _教员列表框_表项被激活, 空白型, , 
填充教员姓名 ()
.判断开始 (等于 (学生分类, “在职教员”))
    赋值 (.标题, 相加 (“目前本校在职教员有”, 到文本 (取表项数 ()), “人，其中男”, 到文本 (男), “人，女”, 到文本 (女), “人。”))
    2.置文本 (“    当前状态：查看在职教员资料”)
    3.置文本 (“    提示： 右击姓名列表可弹出操作菜单，双击照片查看可放大的照片。”)
.判断 (等于 (学生分类, “退休教员”))
    赋值 (.标题, 相加 (“目前自本校退休的教员有”, 到文本 (取表项数 ()), “人，其中男”, 到文本 (男), “人，女”, 到文本 (女), “人。”))
    2.置文本 (“    当前状态：查看退休教员资料”)
    3.置文本 (“    提示： 双击照片查看可放大的照片。退休教员的资料不能被修改。”)
.判断 (等于 (学生分类, “调离教员”))
    赋值 (.标题, 相加 (“目前调离本校的教员有”, 到文本 (取表项数 ()), “人，其中男”, 到文本 (男), “人，女”, 到文本 (女), “人。”))
    2.置文本 (“当前状态：查看调离本校的教员资料”)
    3.置文本 (“    提示： 双击照片查看可放大的照片。调离教员的资料不能被修改。”)
.默认
    
.判断结束
.查找表项数值 (到数值 (.取标题 (., 0))).选择表项 ()
.保证显示 (.)
填充教员资料 ()
解除打印禁止 ()
赋值 (.现行子夹, 5)


.子程序 _教员列表框_右键单击表项, 空白型, , 
.如果 (等于 (学生分类, “在职教员”))
    弹出菜单 ()
.否则
    弹出菜单 ()
.如果结束



.子程序 _搜索教员钮_被单击, 空白型, , 
.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“请输入搜索条件！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (搜索资料, 真)
.判断开始 (等于 (学生分类, “在职教员”))
    赋值 (记录, 相加 (“select 姓名,性别,民族,学历,职称,职务或岗位,参加工作时间,调入本校时间,住宅电话 from 教员表 where ”, .内容, “ like'”, 删全部空 (.内容), “%' order by 姓名”).查询 ())
    赋值 (.标题, 相加 (.标题, “部分在职教员花名册”))
.判断 (等于 (学生分类, “退休教员”))
    赋值 (记录, 相加 (“select 姓名,性别,民族,学历,职称,职务或岗位,参加工作时间,离校时间,住宅电话 from 退休表 where ”, .内容, “ like'”, 删全部空 (.内容), “%' order by 姓名”).查询 ())
    赋值 (.标题, 相加 (.标题, “部分退休教员花名册”))
.判断 (等于 (学生分类, “调离教员”))
    赋值 (记录, 相加 (“select 姓名,性别,民族,学历,职称,职务或岗位,参加工作时间,离校时间,住宅电话 from 调离表 where ”, .内容, “ like'”, 删全部空 (.内容), “%' order by 姓名”).查询 ())
    赋值 (.标题, 相加 (.标题, “部分调离教员花名册”))
.默认
    
.判断结束
填充教员列表 ()
.如果 (等于 (取表项数 (), 0))
    信息框 (“未找到符合条件的资料！”, 0, )
.否则
    信息框 (相加 (#换行符, #换行符, “  搜索结果：在全校搜索到”, 到文本 (取表项数 ()), “个符合条件的教员资料 其中男”, 到文本 (男), “人 女”, 到文本 (女), “人  ”), 0, )
.如果结束
获取焦点 ()
赋值 (.被选择字符数, 取文本长度 (.内容))


.子程序 _教员列表框_表头被单击, 空白型, , 
.参数 被单击列索引, 整数型, , 

.局部变量 比较类型, 整数型, , , 

置等待鼠标 ()
.如果 (等于 (被单击列索引, 上次单击列))
    赋值 (排序方式, 取反 (排序方式))
    被单击列索引.置列图片 (取绝对值 (相减 (被单击列索引.取列图片 (), 1)))
.否则
    赋值 (排序方式, 真)
    上次单击列.置列图片 (-1)
    被单击列索引.置列图片 (0)
.如果结束

.判断开始 (等于 (被单击列索引, 9))
    赋值 (比较类型, 0)
.判断 (或者 (等于 (被单击列索引, 7), 等于 (被单击列索引, 8)))
    赋值 (比较类型, 2)
.默认
    赋值 (比较类型, 1)
.判断结束

超级列表框排序 (被单击列索引, 比较类型, 真, 排序方式)
赋值 (上次单击列, 被单击列索引)
恢复鼠标 ()


.子程序 _学生照片框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (放大照片窗口, _启动窗口, 真)

.子程序 _教员照片_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (放大照片窗口, _启动窗口, 真)

.子程序 _打开工资表一_被选择, 空白型, , 
赋值 (工资表, “\data\001.xsk”)
.如果真 (打开工资表 ())
    赋值 (.现行选中项, 0)
    赋值 (.标题, 读配置项 (相加 (取运行目录 (), “\config.ini”), “Wages”, “工资表一”, ))
    .如果真 (等于 (.标题, “”))
        赋值 (.标题, 相加 (.标题, “教员工资表”, “(表一)”))
    .如果真结束
    连续赋值 (假, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中)
    连续赋值 (真, .选中, .选中)
    
.如果真结束


.子程序 打开工资表, 逻辑型, , 
.如果真 (不等于 (取文本中间 (.标题, 3, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 (假)
.如果真结束
.如果真 (等于 (未知支持库函数_4 (读入文件 (相加 (取运行目录 (), 工资表)), “C8DB”, 1).从字节集读 (), 假))
    信息框 (“不能打开工资表数据文件！”, 0, )
    返回 (假)
.如果真结束

.如果 (等于 (取操作系统类别 (), 3))
    .判断开始 (等于 (取屏幕宽度 (), 800))
        赋值 (.缩放比, 125)
    .判断 (等于 (取屏幕宽度 (), 1024))
        赋值 (.缩放比, 100)
    .判断 (等于 (取屏幕宽度 (), 1152))
        赋值 (.缩放比, 87)
    .判断 (等于 (取屏幕宽度 (), 1280))
        赋值 (.缩放比, 80)
    .默认
        赋值 (.缩放比, 64)
    .判断结束
    1.置列宽 (10, 相除 (_启动窗口., 3.33))
.否则
    赋值 (.缩放比, 85)
    1.置列宽 (10, 相除 (_启动窗口., 3.39))
.如果结束
1.置背景色 (1, 取行数 (), 取列数 (), #白色)
取行数 ().置只读方式 (1, 1, 取列数 (), 真)
2.置只读方式 (9, 取行数 (), 2, 真)
赋值 (.内容, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 到文本 (取月份 (取现行时间 ())), “月份”))
2.置文本 (“    当前状态：教员工资管理”)
3.置文本 (“    提示：移动方格光标直接键入修改内容，单击右键可弹出操作菜单！”)
解除打印禁止 ()
获取焦点 ()
2.置光标 (2)
赋值 (.现行子夹, 7)
返回 (真)


.子程序 _打开工资表二_被选择, 空白型, , 
赋值 (工资表, “\data\002.xsk”)
.如果真 (打开工资表 ())
    赋值 (.现行选中项, 1)
    赋值 (.标题, 读配置项 (相加 (取运行目录 (), “\config.ini”), “Wages”, “工资表二”, 相加 (.标题, “教员工资表”, “(表二)”)))
    .如果真 (等于 (.标题, “”))
        赋值 (.标题, 相加 (.标题, “教员工资表”, “(表二)”))
    .如果真结束
    连续赋值 (假, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中)
    连续赋值 (真, .选中, .选中)
.如果真结束


.子程序 _打开工资表三_被选择, 空白型, , 
赋值 (工资表, “\data\003.xsk”)
.如果真 (打开工资表 ())
    赋值 (.现行选中项, 2)
    赋值 (.标题, 读配置项 (相加 (取运行目录 (), “\config.ini”), “Wages”, “工资表三”, 相加 (.标题, “教员工资表”, “(表三)”)))
    .如果真 (等于 (.标题, “”))
        赋值 (.标题, 相加 (.标题, “教员工资表”, “(表三)”))
    .如果真结束
    连续赋值 (假, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中)
    连续赋值 (真, .选中, .选中)
.如果真结束


.子程序 _打开工资表四_被选择, 空白型, , 
赋值 (工资表, “\data\004.xsk”)
.如果真 (打开工资表 ())
    赋值 (.现行选中项, 3)
    赋值 (.标题, 读配置项 (相加 (取运行目录 (), “\config.ini”), “Wages”, “工资表四”, 相加 (.标题, “教员工资表”, “(表四)”)))
    .如果真 (等于 (.标题, “”))
        赋值 (.标题, 相加 (.标题, “教员工资表”, “(表四)”))
    .如果真结束
    连续赋值 (假, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中)
    连续赋值 (真, .选中, .选中)
    
.如果真结束


.子程序 _打开工资表五_被选择, 空白型, , 
赋值 (工资表, “\data\005.xsk”)
.如果真 (打开工资表 ())
    赋值 (.现行选中项, 4)
    赋值 (.标题, 读配置项 (相加 (取运行目录 (), “\config.ini”), “Wages”, “工资表五”, 相加 (.标题, “教员工资表”, “(表五)”)))
    .如果真 (等于 (.标题, “”))
        赋值 (.标题, 相加 (.标题, “教员工资表”, “(表五)”))
    .如果真结束
    连续赋值 (假, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中)
    连续赋值 (真, .选中, .选中)
    
.如果真结束


.子程序 _工资表格_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _添加一行_被选择, 空白型, , 
取光标行号 ().插入行 ()
取光标行号 ().置背景色 (1, 1, 取列数 (), #白色)
相减 (取光标行号 (), 1).置光标 (1)
取光标行号 ().置背景色 (1, 1, 取列数 (), #银白)
取光标行号 ().置文本色 (7, 1, 2, #红褐)
取光标行号 ().置对齐方式 (2, 1, 取列数 (), #中右)
取光标行号 ().置对齐方式 (1, 1, 1, #中中)
写到文件 (相加 (取运行目录 (), 工资表), 未知支持库函数_3 (存到字节集 (), “C8DB”, 1))
获取焦点 ()

.子程序 _工资表格_放开某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (等于 (键代码, #Ins键))
    _添加一行_被选择 ()
.判断 (等于 (键代码, #Del键))
    _删除一行_被选择 ()
.判断 (等于 (键代码, #F12键))
    _标题设置_被选择 ()
.默认
    
.判断结束


.子程序 _删除一行_被选择, 空白型, , 
.如果真 (等于 (取光标行号 (), 取行数 ()))
    信息框 (相加 (“抱歉！您不能删除”, #左引号, “合计：”, #右引号, “的资料！”), #错误图标, “错误”)
    返回 ()
.如果真结束

.如果 (不等于 (取光标行号 ().取文本 (1), “”))
    .如果真 (等于 (信息框 (相加 (“您确认要删除”, 取光标行号 ().取文本 (1), “的工资资料吗？”), #确认取消钮, “询问”), #确认钮))
        取光标行号 ().删除行 ()
    .如果真结束
    
.否则
    取光标行号 ().删除行 ()
.如果结束
刷新工资表 ()
取光标行号 ().置背景色 (1, 1, 取列数 (), #银白)
写到文件 (相加 (取运行目录 (), 工资表), 未知支持库函数_3 (存到字节集 (), “C8DB”, 1))
获取焦点 ()

.子程序 刷新工资表, 空白型, , 
.局部变量 合计金额, 小数型, , , 
.局部变量 当前列, 整数型, , , 
.局部变量 当前行, 整数型, , , 

赋值 (当前列, 2)
.计次循环首 (8, )
    赋值 (当前行, 2)
    赋值 (合计金额, 0)
    .计次循环首 (相减 (取行数 (), 2), )
        赋值 (合计金额, 相加 (合计金额, 到数值 (当前行.取文本 (当前列))))
        赋值 (当前行, 相加 (当前行, 1))
    .计次循环尾 ()
    取行数 ().置文本 (当前列, 数值到格式文本 (合计金额, 2, 假))
    赋值 (当前列, 相加 (当前列, 1))
.计次循环尾 ()


.子程序 _工资表组合框_列表项被选择, 空白型, , 
.判断开始 (等于 (.现行选中项, 0))
    _打开工资表一_被选择 ()
.判断 (等于 (.现行选中项, 1))
    _打开工资表二_被选择 ()
.判断 (等于 (.现行选中项, 2))
    _打开工资表三_被选择 ()
.判断 (等于 (.现行选中项, 3))
    _打开工资表四_被选择 ()
.判断 (等于 (.现行选中项, 4))
    _打开工资表五_被选择 ()
.默认
    
.判断结束


.子程序 _标题设置_被选择, 空白型, , 
载入 (工资系统设置窗口, , 真)
写到文件 (相加 (取运行目录 (), 工资表), 未知支持库函数_3 (存到字节集 (), “C8DB”, 1))
获取焦点 ()


.子程序 _工资表一_被选择, 空白型, , 
_打开工资表一_被选择 ()

.子程序 _工资表二_被选择, 空白型, , 
_打开工资表二_被选择 ()

.子程序 _工资表三_被选择, 空白型, , 
_打开工资表三_被选择 ()

.子程序 _工资表四_被选择, 空白型, , 
_打开工资表四_被选择 ()

.子程序 _工资表五_被选择, 空白型, , 
_打开工资表五_被选择 ()

.子程序 _工资设置按钮_被单击, 空白型, , 
_标题设置_被选择 ()

.子程序 _插入一行钮_被单击, 空白型, , 
_添加一行_被选择 ()

.子程序 _删除一行钮_被单击, 空白型, , 
_删除一行_被选择 ()

.子程序 _工资表格_内容被改变, 空白型, , 
.参数 行号, 整数型, , 
.参数 列号, 整数型, , 
.参数 行数, 整数型, , 
.参数 列数, 整数型, , 

.局部变量 行, 整数型, , , 
.局部变量 合计, 小数型, , , 
.局部变量 合计2, 小数型, , , 

.如果真 (不等于 (列号, 1))
    .如果 (大于 (到数值 (行号.取文本 (列号)), 0))
        行号.置文本 (列号, 数值到格式文本 (到数值 (行号.取文本 (列号)), 2, 假))
        行号.置文本 (9, 数值到格式文本 (相减 (相加 (到数值 (行号.取文本 (2)), 到数值 (行号.取文本 (3)), 到数值 (行号.取文本 (4)), 到数值 (行号.取文本 (5)), 到数值 (行号.取文本 (6))), 到数值 (行号.取文本 (7)), 到数值 (行号.取文本 (8))), 2, 假))
        赋值 (行, 2)
        .计次循环首 (相减 (取行数 (), 2), )
            赋值 (合计, 相加 (合计, 到数值 (行.取文本 (列号))))
            赋值 (合计2, 相加 (合计2, 到数值 (行.取文本 (9))))
            赋值 (行, 相加 (行, 1))
        .计次循环尾 ()
        取行数 ().置文本 (列号, 数值到格式文本 (合计, 2, 假))
        取行数 ().置文本 (9, 数值到格式文本 (合计2, 2, 假))
        写到文件 (相加 (取运行目录 (), 工资表), 未知支持库函数_3 (存到字节集 (), “C8DB”, 1))
    .否则
        行号.置文本 (列号, “”)
    .如果结束
    
.如果真结束


.子程序 _工资表格_选择行列数改变, 空白型, , 
.如果真 (大于 (取光标列号 (), 8))
    取光标行号 ().置光标 (8)
.如果真结束

.如果真 (大于 (取光标行号 (), 相减 (取行数 (), 1)))
    相减 (取行数 (), 1).置光标 (取光标列号 ())
    
.如果真结束
光标行.置背景色 (1, 1, 取列数 (), #白色)
取光标行号 ().置背景色 (1, 1, 取列数 (), #银白)
赋值 (光标行, 取光标行号 ())

.子程序 _打印预览_被选择, 空白型, , 
.判断开始 (等于 (.现行子夹, 1))
    0.初始尺寸 (0)
    .如果 (#学籍表.从字节集读 ())
        打印学籍卡 ()
        打印预览 ()
    .否则
        信息框 (“不能打开模板文件！请与本程序作者联系！”, 0, )
    .如果结束
    
.判断 (等于 (.现行子夹, 2))
    .如果 (等于 (搜索资料, 假))
        .如果 (等于 (学生分类, “毕业学生”))
            打印学生花名册 (.标题, .标题)
        .否则
            打印学生花名册 (.标题, .标题)
        .如果结束
        
    .否则
        打印学生花名册 (.标题)
    .如果结束
    打印预览 ()
    
.判断 (等于 (.现行子夹, 3))
    .如果 (等于 (搜索资料, 假))
        打印学生花名册 (.标题, .标题)
    .否则
        打印学生花名册 (.标题)
    .如果结束
    打印预览 ()
    
.判断 (等于 (.现行子夹, 4))
    打印成绩表 ()
    打印预览 ()
.判断 (等于 (.现行子夹, 5))
    0.初始尺寸 (0)
    .如果 (#教员表.从字节集读 ())
        打印教员卡 ()
        打印预览 ()
    .否则
        信息框 (“不能打开模板文件！请与本程序作者联系！”, 0, )
    .如果结束
    
.判断 (等于 (.现行子夹, 6))
    打印教员花名册 ()
    打印预览 ()
.判断 (等于 (.现行子夹, 7))
    打印工资表 ()
    打印预览 ()
.判断 (等于 (.现行子夹, 8))
    打印统计表 ()
    打印预览 ()
.默认
    
.判断结束


.子程序 _打印_被选择, 空白型, , 

.判断开始 (等于 (.现行子夹, 1))
    0.初始尺寸 (0)
    .如果 (#学籍表.从字节集读 ())
        打印学籍卡 ()
        真.打印 (“打印报表”)
    .否则
        信息框 (“  打开模板文件失败！  ”, #错误图标, “错误”)
    .如果结束
    
.判断 (等于 (.现行子夹, 2))
    .如果 (等于 (搜索资料, 假))
        .如果 (等于 (学生分类, “毕业学生”))
            打印学生花名册 (.标题, .标题)
        .否则
            打印学生花名册 (.标题, .标题)
        .如果结束
        
    .否则
        打印学生花名册 (.标题)
    .如果结束
    真.打印 (“打印报表”)
    
.判断 (等于 (.现行子夹, 3))
    .如果 (等于 (搜索资料, 假))
        打印学生花名册 (.标题, .标题)
    .否则
        打印学生花名册 (.标题)
    .如果结束
    真.打印 (“打印报表”)
    
.判断 (等于 (.现行子夹, 4))
    打印成绩表 ()
    真.打印 (“打印报表”)
.判断 (等于 (.现行子夹, 5))
    0.初始尺寸 (0)
    .如果 (#教员表.从字节集读 ())
        打印教员卡 ()
        真.打印 (“打印报表”)
    .否则
        信息框 (“  打开模板文件失败！  ”, #错误图标, “错误”)
    .如果结束
    
.判断 (等于 (.现行子夹, 6))
    打印教员花名册 ()
    真.打印 (“打印报表”)
.判断 (等于 (.现行子夹, 7))
    打印工资表 ()
    真.打印 (“打印报表”)
.判断 (等于 (.现行子夹, 8))
    打印统计表 ()
    真.打印 (“打印报表”)
.默认
    
.判断结束


.子程序 _删除学生_被选择, 空白型, , 
.如果真 (不等于 (.标题, “1111”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束

.如果真 (并且 (等于 (., -1), 等于 (., -1)))
    信息框 (“  请选择要删除资料的学生姓名！  ”, 0, “提示”)
    返回 ()
.如果真结束

.判断开始 (等于 (学生分类, “毕业学生”))
    .如果真 (等于 (信息框 (相加 (“  删除资料后其学号也将会作废且不能再次利用！建议如非必要请使用修改资料方法。”, #换行符, #换行符, “  现在您还确认要删除当前学生的资料吗？  ”), 相加 (#警告图标, #确认取消钮), “询问”), #确认钮))
        .如果 (等于 (.现行子夹, 1))
            相加 (“delete * from 毕业表 where 学号=”, .标题).执行 ()
            .删除表项 (.)
            赋值 (., 0)
            .如果真 (大于 (取表项数 (), 0))
                填充学生资料 ()
            .如果真结束
            
        .否则
            相加 (“delete * from 毕业表 where 学号=”, .取标题 (., 1)).执行 ()
            .删除表项 (.)
            赋值 (., 0)
        .如果结束
        
    .如果真结束
    
.判断 (等于 (学生分类, “离校学生”))
    .如果真 (等于 (信息框 (相加 (“  删除资料后其学号也将会作废且不能再次利用！建议如非必要请使用修改资料方法。”, #换行符, #换行符, “  现在您还确认要删除当前学生的资料吗？  ”), 相加 (#警告图标, #确认取消钮), “询问”), #确认钮))
        .如果 (等于 (.现行子夹, 1))
            相加 (“delete * from 转退表 where 学号=”, .标题).执行 ()
            .删除表项 (.)
            赋值 (., 0)
            .如果真 (大于 (取表项数 (), 0))
                填充学生资料 ()
            .如果真结束
            
        .否则
            相加 (“delete * from 转退表 where 学号=”, .取标题 (., 1)).执行 ()
            .删除表项 (.)
            赋值 (., 0)
        .如果结束
        
    .如果真结束
    
.默认
    
.判断结束


.子程序 _删除学生资料_被选择, 空白型, , 
.如果真 (不等于 (.标题, “1111”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束

.判断开始 (等于 (.现行子夹, 1))
    .如果真 (等于 (., -1))
        信息框 (“  请选择要删除资料的学生姓名！  ”, 0, “提示”)
        返回 ()
    .如果真结束
    
    .如果真 (等于 (信息框 (相加 (“  删除资料后其学号也将会作废且不能再次利用！建议如非必要请使用修改资料方法。”, #换行符, #换行符, “  现在您还确认要删除当前学生”, .取标题 (., 0), “的资料吗？  ”), 相加 (#警告图标, #确认取消钮), “询问”), #确认钮))
        .判断开始 (等于 (学生分类, “在校学生”))
            相加 (“delete * from 学籍表 where 学号=”, 到文本 (.取表项数值 (.))).执行 ()
        .判断 (等于 (学生分类, “离校学生”))
            相加 (“delete * from 转退表 where 学号=”, 到文本 (.取表项数值 (.))).执行 ()
        .判断 (等于 (学生分类, “毕业学生”))
            相加 (“delete * from 毕业表 where 学号=”, 到文本 (.取表项数值 (.))).执行 ()
        .默认
            
        .判断结束
        .删除表项 (.)
        赋值 (., 0)
        .如果真 (大于 (取表项数 (), 0))
            填充学生资料 ()
        .如果真结束
        
    .如果真结束
    
.判断 (等于 (.现行子夹, 2))
    .如果真 (等于 (., -1))
        信息框 (“  请选择要删除资料的学生姓名！  ”, 0, “提示”)
        返回 ()
    .如果真结束
    
    .如果真 (等于 (信息框 (相加 (“  删除资料后其学号也将会作废且不能再次利用！建议如非必要请使用修改资料方法。”, #换行符, #换行符, “  现在您还确认要删除当前学生”, .取标题 (., 2), “的资料吗？  ”), 相加 (#警告图标, #确认取消钮), “询问”), #确认钮))
        .判断开始 (等于 (学生分类, “离校学生”))
            相加 (“delete * from 转退表 where 学号=”, .取标题 (., 1)).执行 ()
        .判断 (等于 (学生分类, “毕业学生”))
            相加 (“delete * from 毕业表 where 学号=”, .取标题 (., 1)).执行 ()
        .默认
            
        .判断结束
        .删除表项 (.)
        赋值 (., 0)
    .如果真结束
    
.判断 (等于 (.现行子夹, 3))
    .如果真 (等于 (., -1))
        信息框 (“  请选择要删除资料的学生姓名！  ”, 0, “提示”)
        返回 ()
    .如果真结束
    
    .如果真 (等于 (信息框 (相加 (“  您确认要删除当前学生”, .取标题 (., 2), “的资料吗？  ”), 相加 (#警告图标, #确认取消钮), “询问”), #确认钮))
        相加 (“delete * from 学籍表 where 学号=”, .取标题 (., 1)).执行 ()
        .删除表项 (.)
        赋值 (., 0)
    .如果真结束
    
.默认
    信息框 (“  请选择要删除资料的学生姓名！  ”, 0, “提示”)
    _查看学生资料_被选择 ()
.判断结束


.子程序 _离校学生复学_被选择, 空白型, , 
.如果真 (不等于 (.标题, “1111”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束
赋值 (选择子夹, 4)
载入 (资料变更窗口, , 真)

.子程序 _删除教员_被选择, 空白型, , 
.如果真 (不等于 (.标题, “1111”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束

.如果 (等于 (_启动窗口..现行子夹, 5))
    .如果真 (等于 (., -1))
        信息框 (“  请选择要删除资料的教员姓名！  ”, 0, “提示”)
        返回 ()
    .如果真结束
    
.否则
    .如果真 (等于 (., -1))
        信息框 (“  请选择要删除资料的教员姓名！  ”, 0, “提示”)
        返回 ()
    .如果真结束
    
.如果结束

.判断开始 (等于 (学生分类, “调离教员”))
    .如果真 (等于 (信息框 (“  您确认要删除当前教员的资料吗？  ”, 相加 (#警告图标, #确认取消钮), “询问”), #确认钮))
        .如果 (等于 (.现行子夹, 1))
            相加 (“delete * from 调离表 where 编号=”, 到文本 (.取表项数值 (.))).执行 ()
            .删除表项 (.)
            赋值 (., 0)
            .如果真 (大于 (取表项数 (), 0))
                填充教员资料 ()
            .如果真结束
            
        .否则
            相加 (“delete * from 调离表 where 编号=”, .取标题 (., 0)).执行 ()
            .删除表项 (.)
            赋值 (., 0)
        .如果结束
        
    .如果真结束
    
.判断 (等于 (学生分类, “退休教员”))
    .如果真 (等于 (信息框 (“  您确认要删除当前教员的资料吗？  ”, 相加 (#警告图标, #确认取消钮), “询问”), #确认钮))
        .如果 (等于 (.现行子夹, 1))
            相加 (“delete * from 退休表 where 编号=”, 到文本 (.取表项数值 (.))).执行 ()
            .删除表项 (.)
            赋值 (., 0)
            .如果真 (大于 (取表项数 (), 0))
                填充教员资料 ()
            .如果真结束
            
        .否则
            相加 (“delete * from 退休表 where 编号=”, .取标题 (., 0)).执行 ()
            .删除表项 (.)
            赋值 (., 0)
        .如果结束
        
    .如果真结束
    
.默认
    
.判断结束


.子程序 _删除教员档案_被选择, 空白型, , 
.如果真 (不等于 (.标题, “1111”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束

.判断开始 (等于 (.现行子夹, 5))
    .如果真 (等于 (., -1))
        信息框 (“  请选择要删除资料的教员姓名！  ”, 0, “提示”)
        返回 ()
    .如果真结束
    
    .如果真 (等于 (信息框 (相加 (“  您确认要删除当前教员”, .取标题 (., 0), “的资料吗？  ”), 相加 (#警告图标, #确认取消钮), “询问”), #确认钮))
        .判断开始 (等于 (学生分类, “在职教员”))
            相加 (“delete * from 教员表 where 编号=”, 到文本 (.取表项数值 (.))).执行 ()
        .判断 (等于 (学生分类, “调离教员”))
            相加 (“delete * from 调离表 where 编号=”, 到文本 (.取表项数值 (.))).执行 ()
        .判断 (等于 (学生分类, “退休教员”))
            相加 (“delete * from 退休表 where 编号=”, 到文本 (.取表项数值 (.))).执行 ()
        .默认
            
        .判断结束
        .删除表项 (.)
        赋值 (., 0)
        .如果真 (大于 (取表项数 (), 0))
            填充教员资料 ()
        .如果真结束
        
    .如果真结束
    
.判断 (等于 (.现行子夹, 6))
    .如果真 (等于 (., -1))
        信息框 (“  请选择要删除资料的教员姓名！  ”, 0, “提示”)
        返回 ()
    .如果真结束
    
    .如果真 (等于 (信息框 (相加 (“  您确认要删除当前教员”, .取标题 (., 1), “的资料吗？  ”), 相加 (#警告图标, #确认取消钮), “询问”), #确认钮))
        .判断开始 (等于 (学生分类, “在职教员”))
            相加 (“delete * from 教员表 where 编号=”, .取标题 (., )).执行 (0)
        .判断 (等于 (学生分类, “调离教员”))
            相加 (“delete * from 调离表 where 编号=”, .取标题 (., )).执行 (0)
        .判断 (等于 (学生分类, “退休教员”))
            相加 (“delete * from 退休表 where 编号=”, .取标题 (., )).执行 (0)
        .默认
            
        .判断结束
        .删除表项 (.)
        赋值 (., 0)
    .如果真结束
    
.默认
    信息框 (“  请选择要删除资料的教员姓名！  ”, 0, “提示”)
    _查看教员档案_被选择 ()
.判断结束


.子程序 _恢复教员资料_被选择, 空白型, , 
.局部变量 变动号码, 文本型, , , 

.如果真 (不等于 (.标题, “1111”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束

.如果 (等于 (_启动窗口..现行子夹, 5))
    .如果真 (等于 (., -1))
        信息框 (“  请选择要恢复资料的教员姓名！  ”, 0, “提示”)
        返回 ()
    .如果真结束
    赋值 (变动号码, 到文本 (.取表项数值 (.)))
    
.否则
    .如果真 (等于 (., -1))
        信息框 (“  请选择要恢复资料的教员姓名！  ”, 0, “提示”)
        返回 ()
    .如果真结束
    赋值 (变动号码, .取标题 (., 0))
.如果结束

.如果真 (不等于 (信息框 (“  您确定要将当前教员的档案资料恢复到在职教员数据中吗？  ”, 相加 (#询问图标, #确认取消钮), “询问”), #确认钮))
    返回 ()
.如果真结束

.如果 (等于 (学生分类, “退休教员”))
    .如果 (_启动窗口.执行 (., 相加 (“insert into 教员表 select * from 退休表 where 编号=”, 变动号码), ))
        _启动窗口.执行 (., 相加 (“delete * from 退休表 where 编号=”, 变动号码), )
        .如果 (等于 (_启动窗口..现行子夹, 5))
            _启动窗口.删除表项 (., _启动窗口..)
            赋值 (_启动窗口.., 0)
            .如果 (大于 (取表项数 (), 0))
                填充教员资料 ()
            .否则
                赋值 (.标题, 相加 (_启动窗口..标题, “目前没有退休教员的资料”))
                填充空教员资料 ()
            .如果结束
            
        .否则
            _启动窗口.删除表项 (., _启动窗口..)
            赋值 (_启动窗口.., 0)
        .如果结束
        信息框 (“恢复退休教员档案操作完成！”, 0, )
    .否则
        信息框 (“恢复退休教员档案操作失败！”, 0, )
    .如果结束
    
.否则
    .如果 (_启动窗口.执行 (., 相加 (“insert into 教员表 select * from 调离表 where 编号=”, 变动号码), ))
        _启动窗口.执行 (., 相加 (“delete * from 调离表 where 编号=”, 变动号码), )
        .如果 (等于 (_启动窗口..现行子夹, 5))
            _启动窗口.删除表项 (., _启动窗口..)
            赋值 (_启动窗口.., 0)
            .如果 (大于 (取表项数 (), 0))
                填充教员资料 ()
            .否则
                赋值 (.标题, 相加 (_启动窗口..标题, “目前没有退休教员的资料”))
                填充空教员资料 ()
            .如果结束
            
        .否则
            _启动窗口.删除表项 (., _启动窗口..)
            赋值 (_启动窗口.., 0)
        .如果结束
        信息框 (“恢复调离教员档案操作完成！”, 0, )
    .否则
        信息框 (“恢复调离教员档案操作失败！”, 0, )
    .如果结束
    
.如果结束


.子程序 _编辑课程表_被选择, 空白型, , 
载入 (课程表窗口, _启动窗口, 真)

.子程序 _记事本_被选择, 空白型, , 
运行 (“NOTEPAD.EXE”, 假, )

.子程序 _计算器_被选择, 空白型, , 
运行 (“CALC.EXE”, 假, )

.子程序 _背景音乐一_被选择, 空白型, , 
赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)
.判断开始 (文件是否存在 (相加 (取运行目录 (), “\Sound\Music1.mid”)))
    停止播放 ()
    播放音乐 (相加 (取运行目录 (), “\sound\Music1.mid”), 真)
.判断 (文件是否存在 (相加 (取运行目录 (), “\Sound\Music1.wav”)))
    停止播放 ()
    播放音乐 (相加 (取运行目录 (), “\sound\Music1.wav”), 真)
.判断 (文件是否存在 (相加 (取运行目录 (), “\Sound\Music1.mp3”)))
    停止播放 ()
    播放MP3 (-1, 相加 (取运行目录 (), “\sound\Music1.mp3”))
.默认
    信息框 (相加 (“找不到背景音乐文件”, #左引号, “Music1”, #右引号, “或该文件已损坏！”), 0, )
.判断结束


.子程序 _背景音乐二_被选择, 空白型, , 
赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)
.判断开始 (文件是否存在 (相加 (取运行目录 (), “\Sound\Music2.mid”)))
    停止播放 ()
    播放音乐 (相加 (取运行目录 (), “\sound\Music2.mid”), 真)
.判断 (文件是否存在 (相加 (取运行目录 (), “\Sound\Music2.wav”)))
    停止播放 ()
    播放音乐 (相加 (取运行目录 (), “\sound\Music2.wav”), 真)
.判断 (文件是否存在 (相加 (取运行目录 (), “\Sound\Music2.mp3”)))
    停止播放 ()
    播放MP3 (-1, 相加 (取运行目录 (), “\sound\Music2.mp3”))
.默认
    信息框 (相加 (“找不到背景音乐文件”, #左引号, “Music2”, #右引号, “或该文件已损坏！”), 0, )
.判断结束


.子程序 _其它音乐_被选择, 空白型, , 
.如果真 (打开 ())
    停止播放 ()
    赋值 (.选中, 真)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    .如果 (等于 (取文本右边 (.文件名, 3), “mp3”))
        播放MP3 (-1, .文件名)
    .否则
        播放音乐 (.文件名, 真)
    .如果结束
    
.如果真结束


.子程序 _关闭音乐_被选择, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
停止播放 ()

.子程序 _使用手册_被选择, 空白型, , 
未知支持库函数_6 (4, 相加 (取运行目录 (), “\使用手册.chm”), , )

.子程序 _软件注册_被选择, 空白型, , 
赋值 (选择子夹, 3)
载入 (关于注册窗口, _启动窗口, 真)


.子程序 _关于_被选择, 空白型, , 
赋值 (选择子夹, 0)
载入 (关于注册窗口, _启动窗口, 真)

.子程序 _工具条1_被下拉, 空白型, , 
.参数 按钮索引, 整数型, , 
.参数 下拉横座标, 整数型, , 
.参数 下拉纵座标, 整数型, , 

.如果真 (等于 (按钮索引, 20))
    弹出菜单 ()
.如果真结束


.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.判断开始 (等于 (按钮索引, 0))
    _添加学生资料_被选择 ()
.判断 (等于 (按钮索引, 1))
    _修改学生资料_被选择 ()
.判断 (等于 (按钮索引, 2))
    _调整学生班级_被选择 ()
.判断 (等于 (按钮索引, 3))
    _学生转学退学_被选择 ()
.判断 (等于 (按钮索引, 5))
    _添加教员档案_被选择 ()
.判断 (等于 (按钮索引, 6))
    _修改教员档案_被选择 ()
.判断 (等于 (按钮索引, 7))
    _教员退休操作_被选择 ()
.判断 (等于 (按钮索引, 8))
    _教员调离操作_被选择 ()
.判断 (等于 (按钮索引, 11))
    _打印_被选择 ()
.判断 (等于 (按钮索引, 10))
    _打印预览_被选择 ()
.判断 (等于 (按钮索引, 13))
    _查看学生资料_被选择 ()
.判断 (等于 (按钮索引, 14))
    _在校学生列表_被选择 ()
.判断 (等于 (按钮索引, 15))
    _期中成绩录入_被选择 ()
.判断 (等于 (按钮索引, 16))
    _智能评语录入_被选择 ()
.判断 (等于 (按钮索引, 18))
    _查看教员档案_被选择 ()
.判断 (等于 (按钮索引, 19))
    _在职教员列表_被选择 ()
.判断 (等于 (按钮索引, 20))
    .判断开始 (等于 (.选中, 真))
        _打开工资表二_被选择 ()
    .判断 (等于 (.选中, 真))
        _打开工资表三_被选择 ()
    .判断 (等于 (.选中, 真))
        _打开工资表四_被选择 ()
    .判断 (等于 (.选中, 真))
        _打开工资表五_被选择 ()
    .判断 (等于 (.选中, 真))
        _打开工资表一_被选择 ()
    .默认
        _打开工资表一_被选择 ()
    .判断结束
    
.判断 (等于 (按钮索引, 22))
    _编辑课程表_被选择 ()
.判断 (等于 (按钮索引, 23))
    弹出菜单 ()
.判断 (等于 (按钮索引, 25))
    到记录头 ()
.判断 (等于 (按钮索引, 26))
    上一个 ()
.判断 (等于 (按钮索引, 27))
    下一个 ()
.判断 (等于 (按钮索引, 28))
    到记录尾 ()
.判断 (等于 (按钮索引, 30))
    回主界面 ()
.默认
    
.判断结束


.子程序 到记录头, 空白型, , 
.判断开始 (等于 (.现行子夹, 1))
    .如果 (大于 (., 0))
        0.选择表项 ()
        .保证显示 (.)
        填充学生资料 ()
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 2))
    .如果 (大于 (., 0))
        赋值 (., 0)
        .保证显示 (.)
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 3))
    .如果 (大于 (., 0))
        赋值 (., 0)
        .保证显示 (.)
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 4))
    .如果 (大于 (取光标行号 (), 2))
        2.置光标 (取光标列号 ())
        _成绩表格_选择行列数改变 ()
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 5))
    .如果 (大于 (., 0))
        赋值 (., 0)
        .保证显示 (.)
        填充教员资料 ()
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 6))
    .如果 (大于 (., 0))
        赋值 (., 0)
        .保证显示 (.)
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 7))
    .如果 (大于 (取光标行号 (), 2))
        2.置光标 (取光标列号 ())
        _工资表格_选择行列数改变 ()
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 8))
    .如果 (大于 (., 0))
        赋值 (., 0)
        .保证显示 (.)
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.默认
    
.判断结束


.子程序 上一个, 空白型, , 
.判断开始 (等于 (.现行子夹, 1))
    .如果 (大于 (., 0))
        赋值 (., 相减 (., 1))
        填充学生资料 ()
        .保证显示 (.)
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 2))
    .如果 (大于 (., 0))
        赋值 (., 相减 (., 1))
        .保证显示 (.)
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 3))
    .如果 (大于 (., 0))
        赋值 (., 相减 (., 1))
        .保证显示 (.)
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 4))
    .如果 (大于 (取光标行号 (), 2))
        相减 (取光标行号 (), 1).置光标 (取光标列号 ())
        _成绩表格_选择行列数改变 ()
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 5))
    .如果 (大于 (., 0))
        赋值 (., 相减 (., 1))
        填充教员资料 ()
        .保证显示 (.)
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 6))
    .如果 (大于 (., 0))
        赋值 (., 相减 (., 1))
        .保证显示 (.)
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 7))
    .如果 (大于 (取光标行号 (), 2))
        相减 (取光标行号 (), 1).置光标 (取光标列号 ())
        _工资表格_选择行列数改变 ()
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 8))
    .如果 (大于 (., 0))
        赋值 (., 相减 (., 1))
        .保证显示 (.)
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.默认
    
.判断结束


.子程序 下一个, 空白型, , 
.判断开始 (等于 (.现行子夹, 1))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        赋值 (., 相加 (., 1))
        填充学生资料 ()
        .保证显示 (.)
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 2))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        赋值 (., 相加 (., 1))
        .保证显示 (.)
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 3))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        赋值 (., 相加 (., 1))
        .保证显示 (.)
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 4))
    .如果 (小于 (取光标行号 (), 取行数 ()))
        相加 (取光标行号 (), 1).置光标 (取光标列号 ())
        _成绩表格_选择行列数改变 ()
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 5))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        赋值 (., 相加 (., 1))
        填充教员资料 ()
        .保证显示 (.)
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 6))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        赋值 (., 相加 (., 1))
        .保证显示 (.)
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 7))
    .如果 (小于 (取光标行号 (), 相减 (取行数 (), 1)))
        相加 (取光标行号 (), 1).置光标 (取光标列号 ())
        _工资表格_选择行列数改变 ()
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 8))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        赋值 (., 相加 (., 1))
        .保证显示 (.)
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.默认
    
.判断结束


.子程序 到记录尾, 空白型, , 
.判断开始 (等于 (.现行子夹, 1))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        赋值 (., 相减 (取表项数 (), 1))
        填充学生资料 ()
        .保证显示 (.)
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 2))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        赋值 (., 相减 (取表项数 (), 1))
        .保证显示 (.)
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 3))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        赋值 (., 相减 (取表项数 (), 1))
        .保证显示 (.)
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 4))
    .如果 (小于 (取光标行号 (), 取行数 ()))
        取行数 ().置光标 (取光标列号 ())
        _成绩表格_选择行列数改变 ()
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 5))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        赋值 (., 相减 (取表项数 (), 1))
        填充教员资料 ()
        .保证显示 (.)
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 6))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        赋值 (., 相减 (取表项数 (), 1))
        .保证显示 (.)
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 7))
    .如果 (小于 (取光标行号 (), 相减 (取行数 (), 1)))
        相减 (取行数 (), 1).置光标 (取光标列号 ())
        _工资表格_选择行列数改变 ()
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 8))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        赋值 (., 相减 (取表项数 (), 1))
        .保证显示 (.)
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.默认
    
.判断结束


.子程序 回主界面, 空白型, , 
连续赋值 (真, .禁止, .禁止)
10.加入状态 (#禁止)
11.加入状态 (#禁止)
25.加入状态 (#禁止)
26.加入状态 (#禁止)
27.加入状态 (#禁止)
28.加入状态 (#禁止)
30.加入状态 (#禁止)
赋值 (.标题, “”)
赋值 (.查询SQL, “”)
连续赋值 (假, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中)
2.置文本 (“    当前状态：请选择操作”)
.如果 (不等于 (取星期几 (取现行时间 ()), 1))
    3.置文本 (相加 (“        欢迎使用校务管理系统！ ”, “今天是”, 时间到文本 (取现行时间 (), 2), “  星期”, 数值到大写 (相减 (取星期几 (取现行时间 ()), 1), 真)))
.否则
    3.置文本 (相加 (“        欢迎使用校务管理系统！ ”, “今天是”, 时间到文本 (取现行时间 (), 2), “  星期日”))
.如果结束

赋值 (.现行子夹, 0)


.子程序 解除打印禁止, 空白型, , 
.如果真 (并且 (等于 (.禁止, 真), 等于 (.禁止, 真)))
    10.去除状态 (#禁止)
    11.去除状态 (#禁止)
    30.去除状态 (#禁止)
    连续赋值 (假, .禁止, .禁止)
    25.去除状态 (#禁止)
    26.去除状态 (#禁止)
    27.去除状态 (#禁止)
    28.去除状态 (#禁止)
.如果真结束

连续赋值 (假, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中)

.子程序 _退出图形按钮_被单击, 空白型, , 
_退出系统_被选择 ()

.子程序 _系统数据维护_被选择, 空白型, , 
.如果真 (不等于 (取文本右边 (.标题, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束
载入 (数据维护窗口, _启动窗口, 真)

.子程序 _变动标签_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (离校说明窗口, _启动窗口, 真)

.子程序 _教员当前去向_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (离校说明窗口, _启动窗口, 真)

.子程序 _排序方向组合框_列表项被选择, 空白型, , 
获取焦点 ()
填充成绩表头 ()
填充成绩表 ()

.子程序 _设置界面风格_被选择, 空白型, , 
载入 (界面窗口, _启动窗口, 真)

.子程序 _系统数据初始化_被选择, 空白型, , 
.如果真 (不等于 (.标题, “1111”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (相加 (“★★★注意：系统数据初始化将会删除系统内当前的所有数据！！！    ”, #换行符, #换行符, “由于本操作不可逆转，建议先备份当前数据后再进行本操作！”, #换行符, #换行符, “您确定要清空系统当前的所有数据吗？”), 相加 (#警告图标, #确认取消钮), “警告：系统数据初始化将会删除系统内当前的所有数据！！！”), #取消钮))
    返回 ()
.如果真结束
关闭 ()
关闭 ()
关闭 ()
写到文件 (相加 (取运行目录 (), “\data\006.xsk”), #学生数据)
写到文件 (相加 (取运行目录 (), “\data\007.xsk”), #教员数据)
写到文件 (相加 (取运行目录 (), “\data\008.xsk”), #管理员数据)
写到文件 (相加 (取运行目录 (), “\data\001.xsk”), #工资表数据)
写到文件 (相加 (取运行目录 (), “\data\002.xsk”), #工资表数据)
写到文件 (相加 (取运行目录 (), “\data\003.xsk”), #工资表数据)
写到文件 (相加 (取运行目录 (), “\data\004.xsk”), #工资表数据)
写到文件 (相加 (取运行目录 (), “\data\005.xsk”), #工资表数据)
信息框 (“系统数据初始化完成，即将重新启动本系统！”, 0, )
运行 (相加 (取运行目录 (), “\”, 取执行文件名 ()), 假, )
结束 ()

.窗口程序集 学生资料录入修改程序集, , , 

.程序集变量 姓名参考, 文本型, , , 
.程序集变量 性别参考, 文本型, , , 
.程序集变量 已修改, 逻辑型, , , 
.子程序 _学生资料录入修改窗口_位置被改变, 空白型, , 
连续赋值 (相减 (学生资料录入修改窗口., 8), .宽度, .宽度)
.移动 (.宽度, 相减 (取用户区高度 (), ., .高度, .高度, 6))
.移动 (相加 (.顶边, .高度), , )
连续赋值 (相除 (_启动窗口., 10), .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度)
连续赋值 (相除 (_启动窗口., 3.35), .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度)
连续赋值 (相加 (.左边, .宽度), .左边, .左边, .左边, .左边, .左边, .左边)
连续赋值 (相加 (.左边, .宽度), .左边, .左边, .左边, .左边, .左边, .左边)
连续赋值 (相加 (.左边, .宽度), .左边, .左边, .左边, .左边, .左边, .左边)
相加 (.左边, .宽度).移动 (相除 (_启动窗口., 5.71), )
连续赋值 (相除 (_启动窗口., 12), .宽度, .宽度, .宽度, .宽度, .宽度, .宽度)
连续赋值 (.宽度, .宽度, .宽度)
连续赋值 (相加 (.左边, .宽度), .左边, .左边)
连续赋值 (相加 (.左边, .宽度), .左边, .左边)
连续赋值 (相加 (.左边, .宽度), .左边, .左边)
连续赋值 (相加 (.左边, .宽度), .左边, .左边)
赋值 (.宽度, 相减 (.左边, .左边, .宽度, .宽度))
赋值 (.宽度, 相减 (.左边, .左边, .宽度, .宽度))
连续赋值 (相加 (.左边, .宽度), .左边, .左边)
连续赋值 (相加 (.左边, .宽度), .左边, .左边)
连续赋值 (.左边, .左边, .左边)
.移动 (相减 (.高度, .顶边, 8))
赋值 (.高度, 相减 (.高度, .顶边, 4))
赋值 (.高度, 相减 (.高度, .顶边, 4))
赋值 (.角度, 相加 (.左边, .宽度, 20))
.移动 (相减 (相加 (.左边, .宽度), .角度), 相减 (.高度, .加粗, 8))
赋值 (.左边, .角度)
赋值 (.左边, 相加 (.左边, .宽度))
赋值 (.宽度, 相减 (.宽度, 4))
赋值 (.宽度, .宽度)
连续赋值 (相减 (相除 (.宽度, 2), 6), .宽度, .宽度)
赋值 (.左边, .左边)
赋值 (.左边, 相加 (.左边, .宽度, 12))
相减 (.宽度, ., ., 100).移动 ()
相减 (.宽度, ., 50).移动 ()

.子程序 _学生资料录入修改窗口_创建完毕, 空白型, , 
学生资料录入修改窗口.移动 (_启动窗口., _启动窗口., _启动窗口., _启动窗口.)
1.置文本 (_启动窗口.取文本 (., 1))
.如果真 (等于 (填充班级名称 (), 假))
    信息框 (“目前没有班级数据！请先进行校务设置！”, 0, )
    销毁 ()
    _校务设置_被选择 ()
    返回 ()
.如果真结束
填充列表学生姓名 ()
.如果 (等于 (修改资料, 假))
    赋值 (.背景颜色, #白色)
    3.置文本 (“  提示：请先选择要添加学生资料的班级，输入资料后按[保存数据]。”)
    赋值 (学生资料录入修改窗口., “添加学生资料”)
    赋值 (.标题, 相加 (“您现在要添加的是”, .取项目文本 (.现行选中项), “的学生资料”))
    赋值 (.标题, “  <<  请选择要添加学生资料的班级”)
    赋值 (., “保存数据”)
    赋值 (.字体名称, 真)
    填充空资料 ()
    赋值 (学生资料录入修改窗口., 真)
    赋值 (记录, _启动窗口.查询 (., “select 学号 from 记号表 where ID=1”))
    .如果 (小于或等于 (_启动窗口.读 (., 记录, “学号”), 0))
        赋值 (.输入方式, 8)
        赋值 (.内容, 到文本 (1))
        信息框 (“为保证学号的连续性与唯一性，第一次添加学生资料可以任意输入学号，保存资料后学号栏将会按第一次的学号自动递增，而且不能再编辑或修改！”, #警告图标, “提示”)
        获取焦点 ()
        赋值 (.被选择字符数, 取文本长度 (.内容))
    .否则
        赋值 (.输入方式, 1)
        赋值 (.背景颜色, #银白)
        赋值 (.内容, 到文本 (相加 (到数值 (_启动窗口.读 (., 记录, “学号”)), 1)))
        获取焦点 ()
    .如果结束
    _启动窗口.关闭记录集 (., 记录)
    
.否则
    赋值 (.输入方式, 1)
    赋值 (.背景颜色, #银白)
    3.置文本 (“  提示：请先选择要修改资料的学生姓名，修改完成后按[保存修改]。”)
    赋值 (学生资料录入修改窗口., “修改学生资料”)
    赋值 (., “保存修改”)
    赋值 (.字体名称, 假)
    .判断开始 (并且 (等于 (_启动窗口..现行子夹, 1), 等于 (学生分类, “在校学生”)))
        赋值 (.现行选中项, _启动窗口..现行选中项)
        填充列表学生姓名 ()
        _启动窗口.查找表项 (..标题, , ).选择表项 ()
    .判断 (等于 (_启动窗口..现行子夹, 3))
        赋值 (.现行选中项, _启动窗口..现行选中项)
        填充列表学生姓名 ()
        _启动窗口.取标题 (., _启动窗口.., 2).查找表项 ().选择表项 ()
    .默认
        赋值 (.现行选中项, 0)
        填充列表学生姓名 ()
        0.选择表项 ()
    .判断结束
    .保证显示 (.)
    填充修改资料 ()
    赋值 (.标题, “请选择要修改学生资料的班级和学生姓名”)
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果结束
赋值 (.标题, .取项目文本 (.现行选中项))
赋值 (已修改, 假)


.子程序 填充列表学生姓名, 空白型, , 
.局部变量 班级, 文本型, , , 

置等待鼠标 ()
赋值 (男, 0)
赋值 (女, 0)
赋值 (班级, 相加 (“'”, .取项目文本 (.现行选中项), “'”))
赋值 (记录, _启动窗口.查询 (., 相加 (“select 姓名,性别 from 学籍表 where 所在班级=”, 班级, “order by 姓名”)))
.如果 (不等于 (记录, 0))
    全部删除 ()
    _启动窗口.到首记录 (., 记录)
    .判断循环首 (等于 (_启动窗口.尾记录后 (., 记录), 假))
        .插入表项 (_启动窗口.读 (., 记录, “姓名”), 0, , , )
        .如果 (等于 (_启动窗口.读 (., 记录, “性别”), “男”))
            赋值 (男, 相加 (男, 1))
        .否则
            赋值 (女, 相加 (女, 1))
        .如果结束
        2.置文本 (相加 (“   数据载入中请稍侯....  ”, 到文本 (相加 (男, 女))))
        _启动窗口.到后一记录 (., 记录)
    .判断循环尾 ()
.否则
    信息框 (“载入学生姓名数据失败！”, 0, )
.如果结束
_启动窗口.关闭记录集 (., 记录)
2.置文本 (“    当前状态：录入修改学生资料”)
赋值 (.标题, 相加 (“目前”, .内容, “共有”, 到文本 (取表项数 ()), “名学生  其中男生”, 到文本 (男), “人  女生”, 到文本 (女), “人”))
恢复鼠标 ()

.子程序 _学生班级组合框_列表项被选择, 空白型, , 
获取焦点 ()
填充列表学生姓名 ()
.如果 (等于 (修改资料, 真))
    赋值 (., 0)
    填充修改资料 ()
.否则
    赋值 (.标题, 相加 (“您现在要添加的是”, .取项目文本 (.现行选中项), “的学生资料”))
    获取焦点 ()
.如果结束
赋值 (.标题, .取项目文本 (.现行选中项))


.子程序 _学生姓名列表框_当前表项被改变, 空白型, , 
.如果真 (等于 (修改资料, 真))
    填充修改资料 ()
    赋值 (.标题, 相加 (“您现在修改的是”, .取项目文本 (.现行选中项), .取标题 (., ), “同学的资料”))
.如果真结束


.子程序 填充修改资料, 空白型, , 
.局部变量 当前姓名, 文本型, , , 
.局部变量 当前班级, 文本型, , , 

.如果真 (等于 (取表项数 (), 0))
    赋值 (.标题, 相加 (“目前”, .内容, “没有学生资料！请选择其他班级修改资料！”))
    填充空资料 ()
    信息框 (相加 (“目前”, .内容, “没有学生资料！请选择其他班级修改资料！”), 0, )
    返回 ()
.如果真结束
赋值 (当前班级, .取项目文本 (.现行选中项))
赋值 (当前姓名, .取标题 (., 0))
赋值 (记录, _启动窗口.查询 (., 相加 (“select * from 学籍表 where 所在班级=”, “'”, 当前班级, “'and 姓名=”, “'”, 当前姓名, “'”)))
_启动窗口.到首记录 (., 记录)
.如果 (不等于 (记录, 0))
    赋值 (.内容, 到文本 (_启动窗口.读 (., 记录, “学号”)))
    赋值 (.内容, _启动窗口.读 (., 记录, 2))
    _启动窗口.读 (., 记录, “性别”).选择 ()
    _启动窗口.读 (., 记录, “民族”).选择 ()
    赋值 (.今天, 到时间 (_启动窗口.读 (., 记录, 5)))
    赋值 (.今天, 到时间 (_启动窗口.读 (., 记录, 6)))
    赋值 (.标题, _启动窗口.读 (., 记录, 7))
    赋值 (.内容, _启动窗口.读 (., 记录, 8))
    赋值 (.内容, _启动窗口.读 (., 记录, 9))
    赋值 (.内容, 到文本 (_启动窗口.读 (., 记录, 10)))
    赋值 (.内容, _启动窗口.读 (., 记录, 11))
    赋值 (.内容, _启动窗口.读 (., 记录, 12))
    _启动窗口.读 (., 记录, “家长A”).选择 ()
    赋值 (.内容, _启动窗口.读 (., 记录, “家长A姓名”))
    赋值 (.内容, _启动窗口.读 (., 记录, “家长A单位”))
    赋值 (.内容, _启动窗口.读 (., 记录, “家长A电话”))
    _启动窗口.读 (., 记录, “家长B”).选择 ()
    赋值 (.内容, _启动窗口.读 (., 记录, “家长B姓名”))
    赋值 (.内容, _启动窗口.读 (., 记录, “家长B单位”))
    赋值 (.内容, _启动窗口.读 (., 记录, “家长B电话”))
    赋值 (.图片, 到字节集 (_启动窗口.读 (., 记录, “照片”)))
    赋值 (.内容, 到文本 (_启动窗口.读 (., 记录, “本学期评语”)))
    赋值 (.内容, 到文本 (_启动窗口.读 (., 记录, “综合评语”)))
    赋值 (姓名参考, .内容)
    赋值 (性别参考, .内容)
    赋值 (.标题, 相加 (“您现在修改的是”, .取项目文本 (.现行选中项), .取标题 (., ), “同学的资料”))
.否则
    信息框 (“载入学生资料数据失败！”, 0, )
.如果结束
_启动窗口.关闭记录集 (., 记录)

.子程序 填充空资料, 空白型, , 
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
赋值 (.图片, #图片1)

.子程序 _保存数据钮_被单击, 空白型, , 
.局部变量 资料, 文本型, , , 

.判断开始 (等于 (., “保存数据”))
    .如果真 (等于 (删全部空 (.内容), “”))
        信息框 (“    请输入学生的学号！    ”, 0, “提示”)
        获取焦点 ()
        返回 ()
    .如果真结束
    .如果真 (等于 (删全部空 (.内容), “”))
        信息框 (“    请输入学生的姓名！    ”, 0, “提示”)
        获取焦点 ()
        返回 ()
    .如果真结束
    
    赋值 (资料, 相加 (.内容, “,'”, .内容, “','”, .内容, “','”, .内容, “','”, 时间到文本 (.今天, 2), “','”, 时间到文本 (.今天, 2), “','”, .标题, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “',?,?,?,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,'-','-'”))
    .如果 (_启动窗口.执行 (., 相加 (“insert into 学籍表 values ( ”, 资料, “)”), .图片, 到字节集 (.内容), 到字节集 (.内容)))
        _启动窗口.执行 (., 相加 (“update 记号表 set 学号=”, .内容, “ where ID=1”), )
        赋值 (.内容, 到文本 (相加 (到数值 (.内容), 1)))
        .如果真 (不等于 (.输入方式, 1))
            赋值 (.输入方式, 1)
            赋值 (.背景颜色, #银白)
        .如果真结束
        .插入表项 (.内容, 0, , , )
        .查找表项 (.内容, , ).选择表项 ()
        .保证显示 (.)
        连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
        赋值 (.图片, #图片1)
        
        .如果 (等于 (.取项目文本 (.现行选中项), “男”))
            赋值 (男, 相加 (男, 1))
        .否则
            赋值 (女, 相加 (女, 1))
        .如果结束
        赋值 (.标题, 相加 (“目前”, .内容, “共有”, 到文本 (取表项数 ()), “名学生  其中男生”, 到文本 (男), “人  女生”, 到文本 (女), “人”))
        获取焦点 ()
        赋值 (已修改, 真)
    .否则
        信息框 (“保存数据失败！”, 0, )
    .如果结束
    
.判断 (等于 (., “保存修改”))
    .如果真 (小于 (取表项数 (), 1))
        信息框 (相加 (“目前”, .内容, “没有学生资料！请选择其他班级修改资料！”), 0, )
        填充空资料 ()
        返回 ()
    .如果真结束
    .如果真 (等于 (删全部空 (.内容), “”))
        信息框 (“    请输入学生的姓名！    ”, 0, “提示”)
        获取焦点 ()
        返回 ()
    .如果真结束
    
    赋值 (资料, 相加 (.内容, “,姓名='”, .内容, “',性别='”, .内容, “',民族='”, .内容, “',出生日期='”, 时间到文本 (.今天, 2), “',入学日期='”, 时间到文本 (.今天, 2), “',所在班级='”, .标题, “',班内职务='”, .内容, “',家庭住址='”, .内容, “',联系电话='”, .内容, “',户籍所在地='”, .内容, “',籍贯='”, .内容, “',家长A='”, .内容, “',家长A姓名='”, .内容, “',家长A单位='”, .内容, “',家长A电话='”, .内容, “',家长B='”, .内容, “',家长B姓名='”, .内容, “',家长B单位='”, .内容, “',家长B电话='”, .内容, “',照片=?,本学期评语=?,综合评语=?”))
    
    .如果 (_启动窗口.执行 (., 相加 (“update 学籍表 set 学号=”, 资料, “ where 学号=”, .内容), .图片, 到字节集 (.内容), 到字节集 (.内容)))
        .置标题 (., , .内容)
        获取焦点 ()
        .如果 (不等于 (.取项目文本 (.现行选中项), 性别参考))
            .如果 (等于 (.内容, “男”))
                赋值 (男, 相加 (男, 1))
                赋值 (女, 相减 (女, 1))
            .否则
                赋值 (男, 相减 (男, 1))
                赋值 (女, 相加 (女, 1))
            .如果结束
            
        .否则
            
        .如果结束
        赋值 (.标题, 相加 (“目前”, .内容, “共有”, 到文本 (取表项数 ()), “名学生  其中男生”, 到文本 (男), “人  女生”, 到文本 (女), “人”))
        赋值 (已修改, 真)
        信息框 (“修改数据已保存！”, 0, )
    .否则
        信息框 (“保存数据失败！”, 0, )
    .如果结束
    
.默认
    
.判断结束


.子程序 _选择照片钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (打开 ())
    赋值 (.图片, 读入文件 (.文件名))
.如果真结束


.子程序 _删除照片钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (不等于 (.图片, #图片1))
    .如果真 (等于 (信息框 (相加 (“您确定要删除”, .内容, “同学的照片吗？”), 相加 (#确认取消钮, #询问图标), “询问”), #确认钮))
        赋值 (.图片, #图片1)
    .如果真结束
    
.如果真结束


.子程序 _学生资料录入修改窗口_将被销毁, 空白型, , 
.如果真 (已修改)
    .判断开始 (并且 (等于 (_启动窗口..现行子夹, 1), 等于 (.内容, _启动窗口..内容), 等于 (已修改, 真)))
        回主界面 ()
    .判断 (并且 (等于 (_启动窗口..现行子夹, 3), 等于 (.内容, _启动窗口..内容), 等于 (已修改, 真)))
        回主界面 ()
    .默认
        
    .判断结束
    
.如果真结束


.子程序 _退出钮_被单击, 空白型, , 
.如果 (已修改)
    .判断开始 (并且 (等于 (_启动窗口..现行子夹, 1), 等于 (.内容, _启动窗口..内容), 等于 (已修改, 真)))
        回主界面 ()
    .判断 (并且 (等于 (_启动窗口..现行子夹, 3), 等于 (.内容, _启动窗口..内容), 等于 (已修改, 真)))
        回主界面 ()
    .默认
        
    .判断结束
    
.否则
    销毁 ()
.如果结束


.子程序 _本学期评语编辑框_内容被改变, 空白型, , 
.如果 (大于 (186.发送信息 (0, 0), 14))
    赋值 (.输入方式, 1)
    .判断循环首 (大于 (186.发送信息 (0, 0), 14))
        赋值 (.内容, 取文本左边 (.内容, 相减 (取文本长度 (.内容), 2)))
    .判断循环尾 ()
    信息框 (“本学期评价最多输入14行内容！”, 0, )
    赋值 (.起始选择位置, 取文本长度 (.内容))
    赋值 (.输入方式, 0)
.否则
    赋值 (.输入方式, 0)
.如果结束


.子程序 _本学期评语钮_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.标题, “综合评价”)
赋值 (.标题, “● 本学期评语”)
赋值 (.标题, “ 本学期评语：”)
赋值 (.可视, 真)
赋值 (.可视, 真)
#顶层.调整层次 ()
赋值 (.可视, 假)
#底层.调整层次 ()
获取焦点 ()

.子程序 _综合评价钮_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.标题, “● 综合评价”)
赋值 (.标题, “本学期评语”)
赋值 (.标题, “ 综合评价：”)
赋值 (.可视, 假)
赋值 (.可视, 真)
#顶层.调整层次 ()
赋值 (.可视, 假)
#底层.调整层次 ()
获取焦点 ()
赋值 (.起始选择位置, 取文本长度 (.内容))


.子程序 _清除评语钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (等于 (.标题, “ 本学期评语：”))
    .如果真 (不等于 (.内容, “”))
        .如果真 (等于 (信息框 (“您确定要清除本学期评价的内容吗？”, #确认取消钮, “询问”), #确认钮))
            赋值 (.内容, “”)
        .如果真结束
        
    .如果真结束
    
.判断 (等于 (.标题, “ 综合评价：”))
    .如果真 (不等于 (.内容, “”))
        .如果真 (等于 (信息框 (“您确定要清除综合评价的内容吗？”, #确认取消钮, “询问”), #确认钮))
            赋值 (.内容, “”)
        .如果真结束
        
    .如果真结束
    
.默认
    
.判断结束


.子程序 _学生资料录入修改窗口_被取消激活, 空白型, , 
获取焦点 ()

.子程序 _学号编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #减号键))
    返回 (假)
.如果真结束
.如果 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.否则
    
.如果结束



.子程序 _姓名编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _性别组合框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _民族组合框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _出生日期框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _入学日期框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _班内职务组合框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _住址编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _住宅电话编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _籍贯编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _户籍编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _家长组合框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _父亲编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _父亲单位编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _父电话编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _家长组合框2_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _母亲编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _母亲单位编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _母电话编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    .判断开始 (等于 (.标题, “ 本学期评语：”))
        获取焦点 ()
    .判断 (等于 (.标题, “ 综合评价：”))
        获取焦点 ()
    .默认
        
    .判断结束
    
.如果真结束


.子程序 _本学期评语编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #Tab键))
    获取焦点 ()
.如果真结束


.子程序 _综合评价编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #Tab键))
    获取焦点 ()
.如果真结束


.子程序 _学生班级组合框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    .如果 (等于 (.字体名称, 假))
        获取焦点 ()
    .否则
        获取焦点 ()
        赋值 (.被选择字符数, 取文本长度 (.内容))
    .如果结束
    
.如果真结束


.子程序 _学生姓名列表框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _保存数据钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (或者 (等于 (键代码, #Tab键), 等于 (键代码, #回车键)))
    获取焦点 ()
.判断 (等于 (键代码, #空格键))
    _保存数据钮_被单击 ()
.默认
    
.判断结束


.子程序 _退出钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (或者 (等于 (键代码, #Tab键), 等于 (键代码, #回车键)))
    获取焦点 ()
.判断 (等于 (键代码, #空格键))
    _退出钮_被单击 ()
.默认
    
.判断结束


.子程序 _学号编辑框_内容被改变, 空白型, , 
.局部变量 学号首位, 文本型, , , 

赋值 (学号首位, 取文本左边 (.内容, 1))
.如果真 (并且 (等于 (学号首位, “0”), 大于 (取文本长度 (.内容), 1)))
    信息框 (“学号的第一位数字不能为 0 ！  ”, 0, )
.如果真结束


.子程序 _学生资料录入修改窗口_可否被关闭, 逻辑型, , 
_退出钮_被单击 ()

.窗口程序集 设置科目程序集, , , 

.子程序 _设置科目窗口_创建完毕, 空白型, , 
赋值 (设置科目窗口., 相减 (相加 (设置科目窗口., 235), 设置科目窗口.取用户区高度 ()))
.如果 (填充班级名称 ())
    填充科目 ()
    赋值 (.选中, 假)
    赋值 (.禁止, 假)
    赋值 (.标题, 相加 (“设置修改”, .内容, “的课程科目”))
.否则
    信息框 (“目前没有班级数据，请先进行系统设置!”, 0, “提示”)
    销毁 ()
    _校务设置_被选择 ()
.如果结束


.子程序 填充科目, 空白型, , 
赋值 (记录, _启动窗口.查询 (., 相加 (“select * from 班级表 where 所在班级='”, .内容, “'”)))
_启动窗口.到首记录 (., 记录)
赋值 (.内容, _启动窗口.读 (., 记录, “科目1”))
赋值 (.内容, _启动窗口.读 (., 记录, “科目2”))
赋值 (.内容, _启动窗口.读 (., 记录, “科目3”))
赋值 (.内容, _启动窗口.读 (., 记录, “科目4”))
赋值 (.内容, _启动窗口.读 (., 记录, “科目5”))
赋值 (.内容, _启动窗口.读 (., 记录, “科目6”))
赋值 (.内容, _启动窗口.读 (., 记录, “科目7”))
赋值 (.内容, _启动窗口.读 (., 记录, “科目8”))
赋值 (.内容, _启动窗口.读 (., 记录, “科目9”))
赋值 (.内容, _启动窗口.读 (., 记录, “科目10”))
_启动窗口.关闭记录集 (., 记录)
获取焦点 ()
赋值 (.被选择字符数, -1)


.子程序 _科目班级名组合框_列表项被选择, 空白型, , 
赋值 (.标题, 相加 (“设置修改”, .内容, “的课程科目”))
填充科目 ()

.子程序 _选择框1_被单击, 空白型, , 
.如果 (.选中)
    赋值 (.禁止, 真)
    赋值 (.标题, “设置修改本校所有班级的课程科目”)
.否则
    赋值 (.禁止, 假)
    赋值 (.标题, 相加 (“设置修改”, .内容, “的课程科目”))
.如果结束


.子程序 _保存按钮_被单击, 空白型, , 
.局部变量 资料, 文本型, , , 

赋值 (资料, 相加 (“科目1='”, .内容, “',科目2='”, .内容, “',科目3='”, .内容, “',科目4='”, .内容, “',科目5='”, .内容, “',科目6='”, .内容, “',科目7='”, .内容, “',科目8='”, .内容, “',科目9='”, .内容, “',科目10='”, .内容, “'”))
.如果 (.选中)
    .如果 (_启动窗口.执行 (., 相加 (“update 班级表 set ”, 资料), ))
        信息框 (“当前的课程科目已保存到本校所有班级中！”, 0, )
    .否则
        信息框 (“设置修改科目失败！”, 0, “错误”)
    .如果结束
    
.否则
    .如果 (_启动窗口.执行 (., 相加 (“update 班级表 set ”, 资料, “ where 所在班级='”, .内容, “'”), ))
        信息框 (相加 (.内容, “的课程科目数据已保存！”), 0, )
    .否则
        信息框 (“设置修改科目失败！”, 0, “错误”)
    .如果结束
    
.如果结束



.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _科目编辑框2_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _科目编辑框3_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _科目编辑框4_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _科目编辑框5_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _科目编辑框6_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _科目编辑框7_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _科目编辑框8_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _科目编辑框9_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _科目编辑框10_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _设置科目窗口_将被销毁, 空白型, , 
.如果真 (等于 (_启动窗口..现行子夹, 4))
    _启动窗口.获取焦点 (.)
.如果真结束


.窗口程序集 资料变更程序集, , , 

.程序集变量 变动号码, 文本型, , , 
.程序集变量 变动姓名, 文本型, , , 
.程序集变量 变动班级, 文本型, , , 
.子程序 _资料变更窗口_创建完毕, 空白型, , 
赋值 (资料变更窗口., 相减 (相加 (资料变更窗口., 190), 资料变更窗口.取用户区高度 ()))
.判断开始 (等于 (选择子夹, 0))
    赋值 (.现行子夹, 0)
    赋值 (资料变更窗口., “学生因转学、退学等原因离开本校”)
    赋值 (.标题, “学生转学退学离校”)
    .如果 (等于 (_启动窗口..现行子夹, 1))
        赋值 (变动号码, _启动窗口..标题)
        赋值 (变动姓名, _启动窗口..标题)
        赋值 (变动班级, _启动窗口..标题)
    .否则
        赋值 (变动号码, _启动窗口.取标题 (., _启动窗口.., 1))
        赋值 (变动姓名, _启动窗口.取标题 (., _启动窗口.., 2))
        赋值 (变动班级, _启动窗口.取标题 (., _启动窗口.., 5))
    .如果结束
    赋值 (.标题, 相加 (“您确定”, 变动班级, “的”, 变动姓名, “同学要离开本校吗？”))
    
.判断 (等于 (选择子夹, 1))
    赋值 (.现行子夹, 1)
    赋值 (.标题, “调整学生班级”)
    赋值 (资料变更窗口., “调整学生班级”)
    .如果 (填充班级名称 ())
        .如果 (等于 (_启动窗口..现行子夹, 1))
            赋值 (变动号码, _启动窗口..标题)
            赋值 (变动姓名, _启动窗口..标题)
            赋值 (变动班级, _启动窗口..标题)
        .否则
            赋值 (变动号码, _启动窗口.取标题 (., _启动窗口.., 1))
            赋值 (变动姓名, _启动窗口.取标题 (., _启动窗口.., 2))
            赋值 (变动班级, _启动窗口.取标题 (., _启动窗口.., 5))
        .如果结束
        赋值 (.标题, 相加 (变动姓名, “同学目前在本校”, 变动班级, “就读。您确定要调整”, 变动姓名, “同学的班级吗？”))
    .否则
        信息框 (“目前没有班级数据，请先进行校务设置!”, 0, “提示”)
        销毁 ()
        _校务设置_被选择 ()
        返回 ()
    .如果结束
    
.判断 (等于 (选择子夹, 2))
    赋值 (.现行子夹, 2)
    赋值 (资料变更窗口., “学生升级毕业”)
    赋值 (.标题, “学生升级毕业”)
    毕业准备 ()
    .如果真 (等于 (取项目数 (), 0))
        信息框 (“目前没有通用班级数据！”, 0, “提示”)
        销毁 ()
        返回 ()
    .如果真结束
    
.判断 (等于 (选择子夹, 3))
    .判断开始 (等于 (教员去向, “退休”))
        赋值 (资料变更窗口., “本校教员退休”)
        清空 ()
        “正常退休”.加入项目 ()
        “内退”.加入项目 ()
        赋值 (.现行选中项, 0)
        赋值 (.标题, “本校教员退休”)
        赋值 (.标题, “退休说明：”)
        赋值 (.标题, “教员退休日期：”)
    .判断 (等于 (教员去向, “调离”))
        赋值 (资料变更窗口., “教员调离本校”)
        清空 ()
        “正常调动工作”.加入项目 ()
        赋值 (.现行选中项, 0)
        赋值 (.标题, “教员调离本校”)
        赋值 (.标题, “调离原因：”)
        赋值 (.标题, “教员调离日期：”)
    .默认
        
    .判断结束
    
    .如果 (等于 (_启动窗口..现行子夹, 5))
        赋值 (变动号码, 到文本 (_启动窗口.取表项数值 (., _启动窗口..)))
        赋值 (.标题, 相加 (“您确定姓名为”, _启动窗口..标题, “的教员离开本校吗？”))
    .否则
        赋值 (变动号码, _启动窗口.取标题 (., _启动窗口.., 0))
        赋值 (.标题, 相加 (“您确定姓名为”, _启动窗口.取标题 (., _启动窗口.., 1), “的教员离开本校吗？”))
    .如果结束
    赋值 (.现行子夹, 3)
.判断 (等于 (选择子夹, 4))
    .如果 (填充班级名称 ())
        赋值 (资料变更窗口., “离校学生复学”)
        赋值 (.标题, “离开本校的学生复学”)
        .如果 (等于 (_启动窗口..现行子夹, 1))
            .如果 (不等于 (_启动窗口.., -1))
                赋值 (变动号码, 到文本 (_启动窗口.取表项数值 (., _启动窗口..)))
                赋值 (变动姓名, _启动窗口.取标题 (., _启动窗口.., 0))
            .否则
                信息框 (“  请选择要复学的学生姓名！  ”, 0, “提示”)
                销毁 ()
                返回 ()
            .如果结束
            
        .否则
            .如果 (不等于 (_启动窗口.., -1))
                赋值 (变动号码, _启动窗口.取标题 (., _启动窗口.., 1))
                赋值 (变动姓名, _启动窗口.取标题 (., _启动窗口.., 2))
            .否则
                信息框 (“  请选择要复学的学生姓名！  ”, 0, “提示”)
                销毁 ()
                返回 ()
            .如果结束
            
        .如果结束
        赋值 (.标题, 相加 (“您确定姓名为”, 变动姓名, “的学生复学吗？”))
        赋值 (.现行子夹, 4)
        
    .否则
        信息框 (“  载入班级数据失败！  ”, #错误图标, “错误”)
        销毁 ()
        返回 ()
    .如果结束
    
.默认
    
.判断结束
赋值 (资料变更窗口., 真)


.子程序 毕业准备, 空白型, , 
.局部变量 班级, 文本型, , , 
.局部变量 表项, 整数型, , , 


清空 ()
清空 ()
赋值 (记录, _启动窗口.查询 (., “SELECT 所在班级 FROM 班级表 where 班级分类='通用'”))
_启动窗口.到首记录 (., 记录)
.判断循环首 (等于 (_启动窗口.尾记录后 (., 记录), 假))
    赋值 (班级, _启动窗口.读 (., 记录, “所在班级”))
    .如果真 (并且 (不等于 (取文本左边 (班级, 5), “6年级”), 不等于 (取文本左边 (班级, 5), “初中3”), 不等于 (取文本左边 (班级, 5), “高中3”), 不等于 (取文本左边 (班级, 8), “幼儿园大”)))
        赋值 (表项, 班级.加入项目 ())
        .如果真 (等于 (取文本左边 (班级, 5), “1年级”))
            文本替换 (班级, 1, 1, “2”).加入项目 ()
        .如果真结束
        .如果真 (等于 (取文本左边 (班级, 5), “2年级”))
            文本替换 (班级, 1, 1, “3”).加入项目 ()
        .如果真结束
        .如果真 (等于 (取文本左边 (班级, 5), “3年级”))
            文本替换 (班级, 1, 1, “4”).加入项目 ()
        .如果真结束
        .如果真 (等于 (取文本左边 (班级, 5), “4年级”))
            文本替换 (班级, 1, 1, “5”).加入项目 ()
        .如果真结束
        .如果真 (等于 (取文本左边 (班级, 5), “5年级”))
            文本替换 (班级, 1, 1, “6”).加入项目 ()
        .如果真结束
        .如果真 (等于 (取文本左边 (班级, 5), “初中1”))
            文本替换 (班级, 5, 1, “2”).加入项目 ()
        .如果真结束
        .如果真 (等于 (取文本左边 (班级, 5), “初中2”))
            文本替换 (班级, 5, 1, “3”).加入项目 ()
        .如果真结束
        .如果真 (等于 (取文本左边 (班级, 5), “高中1”))
            文本替换 (班级, 5, 1, “2”).加入项目 ()
        .如果真结束
        .如果真 (等于 (取文本左边 (班级, 5), “高中2”))
            文本替换 (班级, 5, 1, “3”).加入项目 ()
        .如果真结束
        .如果真 (等于 (取文本左边 (班级, 8), “幼儿园中”))
            文本替换 (班级, 7, 2, “大”).加入项目 ()
        .如果真结束
        .如果真 (等于 (取文本左边 (班级, 8), “幼儿园小”))
            文本替换 (班级, 7, 2, “中”).加入项目 ()
        .如果真结束
        
    .如果真结束
    
    处理事件 ()
    _启动窗口.到后一记录 (., 记录)
.判断循环尾 ()

_启动窗口.关闭记录集 (., 记录)


.子程序 _离校确定钮_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (“请选择学生离校的原因！”, 0, )
    返回 ()
.如果真结束

.如果 (_启动窗口.执行 (., 相加 (“insert into 转退表 select * from 学籍表 where 学号=”, 变动号码), ))
    _启动窗口.执行 (., 相加 (“update 转退表 set 离校时间='”, 时间到文本 (.今天, 2), “',离校原因='”, .内容, “' where 学号=”, 变动号码), )
    _启动窗口.执行 (., 相加 (“delete * from 学籍表 where 学号=”, 变动号码), )
    .如果 (等于 (_启动窗口..现行子夹, 1))
        _启动窗口.删除表项 (., _启动窗口..)
        赋值 (_启动窗口.., 0)
        .如果真 (等于 (_启动窗口.取表项数 (.), 0))
            填充空学生资料 ()
        .如果真结束
        
    .否则
        _启动窗口.删除表项 (., _启动窗口..)
        赋值 (_启动窗口.., 0)
    .如果结束
    信息框 (“完成学生转学退学离校操作！”, 0, )
    销毁 ()
.否则
    信息框 (“学生转学退学离校操作失败！”, 0, )
    销毁 ()
    
.如果结束


.子程序 _取消钮_被单击, 空白型, , 
销毁 ()

.子程序 _调整确定钮_被单击, 空白型, , 
.如果真 (等于 (.内容, 变动班级))
    信息框 (相加 (“该生目前已在”, .内容, “，无须调整！”), 0, )
    返回 ()
.如果真结束

.如果 (_启动窗口.执行 (., 相加 (“update 学籍表 set 所在班级='”, .内容, “' where 学号=”, 变动号码), ))
    .如果 (等于 (_启动窗口..现行子夹, 1))
        _启动窗口.删除表项 (., _启动窗口..)
        赋值 (_启动窗口.., 0)
        填充学生资料 ()
    .否则
        _启动窗口.删除表项 (., _启动窗口..)
        赋值 (_启动窗口.., 0)
    .如果结束
    信息框 (“完成调班操作！”, 0, )
    销毁 ()
.否则
    信息框 (“调班操作失败！”, 0, )
    销毁 ()
.如果结束


.子程序 _毕业确定钮_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 

赋值 (.禁止, 真)
赋值 (.禁止, 真)
.如果真 (.选中)
    _启动窗口.关闭 (.)
    .如果 (未知支持库函数_4 (相加 (取运行目录 (), “\backup\temp006.xsk”), 相加 (取运行目录 (), “\data\006.xsk”)))
        .如果真 (等于 (删除文件 (相加 (取运行目录 (), “\backup\006.xsk”)), 假))
            未知支持库函数_3 (相加 (1, 4), 相加 (取运行目录 (), “\backup\006.xsk”))
        .如果真结束
        文件更名 (相加 (取运行目录 (), “\backup\temp006.xsk”), 相加 (取运行目录 (), “\backup\006.xsk”))
    .否则
        .如果真 (等于 (信息框 (“  备份数据失败！是否继续进行毕业升级操作？  ”, #是否钮, “备份数据失败”), #否钮))
            .如果真 (等于 (_启动窗口.打开MDB数据库 (., 相加 (取运行目录 (), “\data\006.xsk”), , “2978263-dks”, , ), 假))
                信息框 (“打开学生数据失败！”, #错误图标, “错误”)
                _启动窗口.关闭 (.)
                _启动窗口.关闭 (.)
                结束 ()
            .如果真结束
            赋值 (_启动窗口..连接文本, _启动窗口.取连接文本 (.))
            资料变更窗口.销毁 ()
            返回 ()
        .如果真结束
        
    .如果结束
    
    .如果真 (等于 (_启动窗口.打开MDB数据库 (., 相加 (取运行目录 (), “\data\006.xsk”), , “2978263-dks”, , ), 假))
        信息框 (“打开学生数据失败！”, #错误图标, “错误”)
        _启动窗口.关闭 (.)
        _启动窗口.关闭 (.)
        结束 ()
    .如果真结束
    赋值 (_启动窗口..连接文本, _启动窗口.取连接文本 (.))
    
.如果真结束
置等待鼠标 ()
.如果 (_启动窗口.执行 (., “insert into 毕业表 select * from 学籍表 where 所在班级 like'6年级%' or 所在班级 like'初中3年级%' or 所在班级 like'高中3年级%' or 所在班级 like'幼儿园大班%'”, ))
    _启动窗口.执行 (., 相加 (“update 毕业表 set 离校时间='”, 时间到文本 (.今天, 2), “',离校原因='毕业' where 离校时间='-'”), )
    _启动窗口.执行 (., 相加 (“insert into 毕业时间表 values ('”, 时间到文本 (.今天, 2), “')”), )
    _启动窗口.执行 (., “delete * from 学籍表 where 所在班级 like'6年级%' or 所在班级 like'初中3年级%' or 所在班级 like'高中3年级%' or 所在班级 like'幼儿园大班%'”, )
    _启动窗口.执行 (., “delete * from 班级表 where 所在班级 like'6年级%' or 所在班级 like'初中3年级%' or 所在班级 like'高中3年级%' or 所在班级 like'幼儿园大班%'”, )
    .计次循环首 (取项目数 (), 计次)
        _启动窗口.执行 (., 相加 (“update 学籍表 set 所在班级='”, 相减 (取项目数 (), 计次).取项目文本 (), “' where 所在班级='”, 相减 (取项目数 (), 计次).取项目文本 (), “'”), )
        _启动窗口.执行 (., 相加 (“update 班级表 set 所在班级='”, 相减 (取项目数 (), 计次).取项目文本 (), “' where 所在班级='”, 相减 (取项目数 (), 计次).取项目文本 (), “'”), )
    .计次循环尾 ()
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Graduate”, “Date”, 时间到文本 (取现行时间 (), 2))
    恢复鼠标 ()
    信息框 (“    完成毕业升级操作！　　”, 0, )
    资料变更窗口.销毁 ()
.否则
    恢复鼠标 ()
    信息框 (“学生毕业升级操作失败！”, 0, )
    资料变更窗口.销毁 ()
.如果结束


.子程序 _退休确定钮_被单击, 空白型, , 
.判断开始 (等于 (教员去向, “退休”))
    .如果 (_启动窗口.执行 (., 相加 (“insert into 退休表 select * from 教员表 where 编号=”, 变动号码), ))
        _启动窗口.执行 (., 相加 (“update 退休表 set 离校时间='”, 时间到文本 (.今天, 2), “',离校原因='”, .内容, “' where 编号=”, 变动号码), )
        _启动窗口.执行 (., 相加 (“delete * from 教员表 where 编号=”, 变动号码), )
        .如果 (等于 (_启动窗口..现行子夹, 5))
            _启动窗口.删除表项 (., _启动窗口..)
            赋值 (_启动窗口.., 0)
            填充教员资料 ()
        .否则
            _启动窗口.删除表项 (., _启动窗口..)
            赋值 (_启动窗口.., 0)
        .如果结束
        信息框 (“完成教员退休操作！”, 0, )
        销毁 ()
    .否则
        信息框 (“教员退休操作失败！”, 0, )
        销毁 ()
    .如果结束
    
.判断 (等于 (教员去向, “调离”))
    .如果 (_启动窗口.执行 (., 相加 (“insert into 调离表 select * from 教员表  where 编号=”, 变动号码), ))
        _启动窗口.执行 (., 相加 (“update 调离表 set 离校时间='”, 时间到文本 (.今天, 2), “',离校原因='”, .内容, “' where 编号=”, 变动号码), )
        _启动窗口.执行 (., 相加 (“delete * from 教员表 where 编号=”, 变动号码), )
        .如果 (等于 (_启动窗口..现行子夹, 5))
            _启动窗口.删除表项 (., _启动窗口..)
            赋值 (_启动窗口.., 0)
            填充教员资料 ()
        .否则
            _启动窗口.删除表项 (., _启动窗口..)
            赋值 (_启动窗口.., 0)
        .如果结束
        信息框 (“完成教员调离操作！”, 0, )
        销毁 ()
    .否则
        信息框 (“教员调离操作失败！”, 0, )
        销毁 ()
    .如果结束
    
.默认
    
.判断结束


.子程序 _复学确定钮_被单击, 空白型, , 
.如果 (等于 (学生分类, “毕业学生”))
    .如果 (_启动窗口.执行 (., 相加 (“insert into 学籍表 select * from 毕业表 where 学号=”, 变动号码), ))
        _启动窗口.执行 (., 相加 (“update 学籍表 set 所在班级='”, .内容, “',离校时间='-' where 学号=”, 变动号码), )
        _启动窗口.执行 (., 相加 (“delete * from 毕业表 where 学号=”, 变动号码), )
        .如果 (等于 (_启动窗口..现行子夹, 1))
            _启动窗口.删除表项 (., _启动窗口..)
            赋值 (_启动窗口.., 0)
            填充学生资料 ()
        .否则
            _启动窗口.删除表项 (., _启动窗口..)
            赋值 (_启动窗口.., 0)
        .如果结束
        信息框 (“学生复学操作完成！”, 0, )
        销毁 ()
    .否则
        信息框 (“学生复学操作失败！”, 0, )
        销毁 ()
    .如果结束
    
.否则
    .如果 (_启动窗口.执行 (., 相加 (“insert into 学籍表 select * from 转退表 where 学号=”, 变动号码), ))
        _启动窗口.执行 (., 相加 (“update 学籍表 set 所在班级='”, .内容, “',离校时间='-' where 学号=”, 变动号码), )
        _启动窗口.执行 (., 相加 (“delete * from 转退表 where 学号=”, 变动号码), )
        .如果 (等于 (_启动窗口..现行子夹, 1))
            _启动窗口.删除表项 (., _启动窗口..)
            赋值 (_启动窗口.., 0)
            填充学生资料 ()
        .否则
            _启动窗口.删除表项 (., _启动窗口..)
            赋值 (_启动窗口.., 0)
        .如果结束
        信息框 (“学生复学操作完成！”, 0, )
        销毁 ()
    .否则
        信息框 (“学生复学操作失败！”, 0, )
        销毁 ()
    .如果结束
    
.如果结束


.窗口程序集 放大照片程序集, , , 

.程序集变量 图号, 整数型, , , 
.子程序 _放大照片窗口_创建完毕, 空白型, , 
赋值 (放大照片窗口., 相减 (相加 (放大照片窗口., 475), 放大照片窗口.取用户区高度 ()))
赋值 (.可视, 假)
.判断开始 (等于 (_启动窗口..现行子夹, 1))
    赋值 (图号, 载入图片 (_启动窗口..图片))
    赋值 (.图片, _启动窗口..图片)
.判断 (等于 (_启动窗口..现行子夹, 5))
    赋值 (图号, 载入图片 (_启动窗口..图片))
    赋值 (.图片, _启动窗口..图片)
.默认
    
.判断结束


.子程序 _放大照片窗口_尺寸被改变, 空白型, , 
移动图片 ()

.子程序 移动图片, 空白型, , 
.局部变量 图宽度, 整数型, , , 
.局部变量 图高度, 整数型, , , 
.局部变量 宽比例, 小数型, , , 
.局部变量 高比例, 小数型, , , 

赋值 (图宽度, 图号.取图片宽度 ())
赋值 (图高度, 图号.取图片高度 ())
赋值 (宽比例, 相除 (图宽度, 图高度))
赋值 (高比例, 相除 (图高度, 图宽度))
.如果 (大于 (图宽度, 图高度))
    赋值 (.宽度, 放大照片窗口.取用户区宽度 ())
    赋值 (.高度, 相乘 (.宽度, 高比例))
    .如果真 (大于 (.高度, 放大照片窗口.取用户区高度 ()))
        赋值 (.高度, 放大照片窗口.取用户区高度 ())
        赋值 (.宽度, 相乘 (.高度, 宽比例))
    .如果真结束
    
.否则
    赋值 (.高度, 放大照片窗口.取用户区高度 ())
    赋值 (.宽度, 相乘 (.高度, 宽比例))
    .如果真 (大于 (.宽度, 放大照片窗口.取用户区宽度 ()))
        赋值 (.宽度, 放大照片窗口.取用户区宽度 ())
        赋值 (.高度, 相乘 (.宽度, 高比例))
    .如果真结束
    
.如果结束

相减 (相除 (放大照片窗口.取用户区宽度 (), 2), 相除 (.宽度, 2)).移动 (相减 (相除 (放大照片窗口.取用户区高度 (), 2), 相除 (.高度, 2)), , )

.子程序 _放大照片窗口_首次激活, 空白型, , 
赋值 (.可视, 真)

.窗口程序集 教员资料录入修改程序集, , , 

.程序集变量 性别参考, 文本型, , , 
.程序集变量 教员序号, 整数型, , , 
.程序集变量 已修改, 逻辑型, , , 
.子程序 _教员资料录入修改窗口_位置被改变, 空白型, , 
_启动窗口.移动 (教员资料录入修改窗口., 教员资料录入修改窗口., , )
连续赋值 (相减 (教员资料录入修改窗口., 8), .宽度, .宽度)
.移动 (.宽度, 相减 (取用户区高度 (), ., .高度, .高度, 6))
赋值 (.顶边, 相加 (.顶边, .高度, 1))
连续赋值 (相除 (_启动窗口., 10), .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度)

连续赋值 (相除 (_启动窗口., 3.333), .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度)
连续赋值 (相加 (.左边, .宽度), .左边, .左边, .左边, .左边, .左边, .左边, .左边, .左边)
连续赋值 (相加 (.左边, .宽度), .左边, .左边, .左边, .左边, .左边, .左边, .左边, .左边)
连续赋值 (相加 (.左边, .宽度), .左边, .左边, .左边, .左边, .左边, .左边, .左边, .左边)
相加 (.左边, .宽度).移动 (相除 (_启动窗口., 5.71), )
.移动 (相减 (.高度, .顶边, 8))
赋值 (.高度, 相减 (.高度, .顶边, 4))
赋值 (.高度, 相减 (.高度, .顶边, 4))
赋值 (.角度, 相加 (.左边, .宽度, 20))
.移动 (相减 (相加 (.左边, .宽度), .角度), 相减 (.高度, .加粗, 8))
相减 (.宽度, ., ., 100).移动 ()
相减 (.宽度, ., 50).移动 ()
赋值 (.宽度, 相减 (.宽度, 4))
赋值 (.左边, .角度)
连续赋值 (相减 (相除 (.宽度, 2), 6), .宽度, .宽度)
赋值 (.左边, .左边)
赋值 (.左边, 相加 (.左边, .宽度, 12))

.子程序 _教员资料录入修改窗口_创建完毕, 空白型, , 
教员资料录入修改窗口.移动 (_启动窗口., _启动窗口., _启动窗口., _启动窗口.)
1.置文本 (_启动窗口.取文本 (., 1))
赋值 (已修改, 假)
填充修改教员姓名 ()
.如果 (等于 (修改资料, 假))
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
    赋值 (.图片, #图片1)
    2.置文本 (“    当前状态：添加教员资料”)
    3.置文本 (“  提示：请输入资料后按[保存数据]按钮。”)
    赋值 (教员资料录入修改窗口., “添加教员资料”)
    赋值 (.标题, 相加 (“添加”, _启动窗口..标题, “的教员资料”))
    赋值 (., “保存数据”)
    赋值 (.字体名称, 真)
    赋值 (.标题, “教员姓名列表”)
    赋值 (记录, _启动窗口.查询 (., “select 教员编号 from 记号表 where ID=1”))
    .如果 (不等于 (记录, 0))
        赋值 (教员序号, 到数值 (_启动窗口.读 (., 记录, “教员编号”)))
        .如果 (小于或等于 (教员序号, 0))
            赋值 (教员序号, 1)
        .否则
            赋值 (教员序号, 相加 (教员序号, 1))
        .如果结束
        _启动窗口.关闭记录集 (., 记录)
        获取焦点 ()
    .否则
        _启动窗口.关闭记录集 (., 记录)
        信息框 (“  错误：找不到系统数据序列号！  ”, #错误图标, “错误”)
        教员资料录入修改窗口.销毁 ()
    .如果结束
    
.否则
    赋值 (.字体名称, 假)
    .如果真 (等于 (取表项数 (), 0))
        信息框 (“目前本校没有在职教员数据！请先添加教员数据！”, 0, )
        教员资料录入修改窗口.销毁 ()
        返回 ()
    .如果真结束
    .如果 (或者 (等于 (_启动窗口..现行子夹, 5), 等于 (_启动窗口..现行子夹, 6)))
        _启动窗口.查找表项 (..标题, , ).选择表项 ()
    .否则
        0.选择表项 ()
    .如果结束
    填充教员修改资料 ()
    2.置文本 (“    当前状态：修改教员资料”)
    3.置文本 (“  提示：请先选择要修改资料的教员姓名，修改完成后按[保存修改]。”)
    赋值 (教员资料录入修改窗口., “修改教员资料”)
    赋值 (., “保存修改”)
    赋值 (.标题, “请选择要修改资料的教员姓名”)
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果结束


.子程序 填充修改教员姓名, 空白型, , 
置等待鼠标 ()
赋值 (男, 0)
赋值 (女, 0)
赋值 (记录, _启动窗口.查询 (., “select 编号,姓名,性别 from 教员表 order by 姓名”))
_启动窗口.到首记录 (., 记录)
全部删除 ()
.判断循环首 (等于 (_启动窗口.尾记录后 (., 记录), 假))
    .插入表项 (_启动窗口.读 (., 记录, “姓名”), 0, , , 到数值 (_启动窗口.读 (., 记录, “编号”)))
    .如果 (等于 (_启动窗口.读 (., 记录, “性别”), “男”))
        赋值 (男, 相加 (男, 1))
    .否则
        赋值 (女, 相加 (女, 1))
    .如果结束
    2.置文本 (相加 (“   数据载入中请稍侯....  ”, 到文本 (相加 (男, 女))))
    _启动窗口.到后一记录 (., 记录)
.判断循环尾 ()
_启动窗口.关闭记录集 (., 记录)
2.置文本 (“    当前状态：录入修改教员资料”)
赋值 (.标题, 相加 (“目前本校在职教员有”, 到文本 (取表项数 ()), “人，其中男”, 到文本 (男), “人，女”, 到文本 (女), “人。”))
恢复鼠标 ()


.子程序 填充教员修改资料, 空白型, , 
赋值 (记录, _启动窗口.查询 (., 相加 (“select * from 教员表 where 编号=”, 到文本 (.取表项数值 (.)))))
_启动窗口.到首记录 (., 记录)
.如果 (不等于 (记录, 0))
    赋值 (.内容, _启动窗口.读 (., 记录, “姓名”))
    _启动窗口.读 (., 记录, “性别”).选择 ()
    _启动窗口.读 (., 记录, “民族”).选择 ()
    赋值 (.今天, 到时间 (_启动窗口.读 (., 记录, “出生日期”)))
    _启动窗口.读 (., 记录, “学历”).选择 ()
    赋值 (.内容, _启动窗口.读 (., 记录, “政治面貌”))
    赋值 (.今天, 到时间 (_启动窗口.读 (., 记录, “参加工作时间”)))
    赋值 (.今天, 到时间 (_启动窗口.读 (., 记录, “调入本校时间”)))
    赋值 (.内容, _启动窗口.读 (., 记录, “职称”))
    赋值 (.内容, _启动窗口.读 (., 记录, “职务或岗位”))
    赋值 (.内容, _启动窗口.读 (., 记录, “身份证号”))
    赋值 (.内容, _启动窗口.读 (., 记录, “手机号码”))
    赋值 (.内容, _启动窗口.读 (., 记录, “家庭住址”))
    赋值 (.内容, _启动窗口.读 (., 记录, “住宅电话”))
    赋值 (.内容, _启动窗口.读 (., 记录, “籍贯”))
    赋值 (.内容, _启动窗口.读 (., 记录, “户籍所在地”))
    赋值 (.图片, 到字节集 (_启动窗口.读 (., 记录, “照片”)))
    赋值 (.内容, 到文本 (_启动窗口.读 (., 记录, “个人简历”)))
    赋值 (.内容, 到文本 (_启动窗口.读 (., 记录, “其他资料”)))
    赋值 (.标题, 相加 (“您现在修改的是”, _启动窗口..标题, .取标题 (., ), “同志的资料”))
    
.否则
    信息框 (“载入教员数据失败！”, 0, )
.如果结束
_启动窗口.关闭记录集 (., 记录)


.子程序 _教员姓名列表框_当前表项被改变, 空白型, , 
.如果真 (修改资料)
    填充教员修改资料 ()
.如果真结束


.子程序 _选择照片钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (打开 ())
    赋值 (.图片, 读入文件 (.文件名))
.如果真结束


.子程序 _删除照片钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (不等于 (.图片, #图片1))
    .如果真 (等于 (信息框 (相加 (“您确定要删除”, .内容, “的照片吗？”), 相加 (#确认取消钮, #询问图标), “询问”), #确认钮))
        赋值 (.图片, #图片1)
    .如果真结束
    
.如果真结束


.子程序 _教员资料录入修改窗口_被取消激活, 空白型, , 
获取焦点 ()

.子程序 _简历编辑框_内容被改变, 空白型, , 
.如果 (大于 (186.发送信息 (0, 0), 19))
    赋值 (.输入方式, 1)
    .判断循环首 (大于 (186.发送信息 (0, 0), 19))
        赋值 (.内容, 取文本左边 (.内容, 相减 (取文本长度 (.内容), 2)))
    .判断循环尾 ()
    信息框 (“个人简历最多输入19行内容！”, 0, )
    赋值 (.起始选择位置, 取文本长度 (.内容))
    赋值 (.输入方式, 0)
.否则
    赋值 (.输入方式, 0)
.如果结束


.子程序 _个人简历钮_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.标题, “● 个人简历”)
赋值 (.标题, “其他资料”)
赋值 (.标题, “ 个人简历：”)
赋值 (.可视, 真)
赋值 (.可视, 真)
#顶层.调整层次 ()
赋值 (.可视, 假)
#底层.调整层次 ()
获取焦点 ()

.子程序 _其它资料钮_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.标题, “个人简历”)
赋值 (.标题, “● 其他资料”)
赋值 (.标题, “ 其它资料：”)
赋值 (.可视, 假)
赋值 (.可视, 真)
#顶层.调整层次 ()
赋值 (.可视, 假)
#底层.调整层次 ()
获取焦点 ()
赋值 (.起始选择位置, 取文本长度 (.内容))

.子程序 _清除内容钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (等于 (.标题, “个人简历：”))
    .如果真 (不等于 (.内容, “”))
        .如果真 (等于 (信息框 (“您确定要清除个人简历的内容吗？”, #确认取消钮, “询问”), #确认钮))
            赋值 (.内容, “”)
            
        .如果真结束
        
    .如果真结束
    
.判断 (等于 (.标题, “ 其它资料：”))
    .如果真 (不等于 (.内容, “”))
        .如果真 (等于 (信息框 (“您确定要清除其他资料的内容吗？”, #确认取消钮, “询问”), #确认钮))
            赋值 (.内容, “”)
        .如果真结束
        
    .如果真结束
    
.默认
    
.判断结束


.子程序 _教员姓名编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _教员性别组合框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _教员民族组合框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _教员出生日期框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _教员学历组合框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _教员政治组合框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _教员参加工作日期框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _教员调入日期框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _教员职称组合框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _教员职务组合框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _教员身份证编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _教员手机编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _教员家庭住址编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _教员住宅电话编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _教员籍贯编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _教员户籍编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (等于 (.标题, “个人简历：”))
    获取焦点 ()
.判断 (等于 (.标题, “ 其它资料：”))
    获取焦点 ()
.默认
    
.判断结束


.子程序 _保存数据钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.判断 (等于 (键代码, #空格键))
    _保存数据钮_被单击 ()
.默认
    
.判断结束


.子程序 _退出钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.判断 (等于 (键代码, #空格键))
    _退出钮_被单击 ()
.默认
    
.判断结束


.子程序 _教员姓名列表框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _保存数据钮_被单击, 空白型, , 
.局部变量 资料, 文本型, , , 

.判断开始 (等于 (., “保存数据”))
    .如果真 (等于 (删全部空 (.内容), “”))
        信息框 (“请输入教员姓名！”, #错误图标, “错误”)
        获取焦点 ()
        返回 ()
    .如果真结束
    检查教员输入 ()
    赋值 (资料, 相加 (到文本 (教员序号), “,'”, .内容, “','”, .内容, “','”, .内容, “','”, 时间到文本 (.今天, 2), “','”, .内容, “','”, .内容, “','”, 时间到文本 (.今天, 2), “','”, 时间到文本 (.今天, 2), “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “',?,?,?,'-','-')”))
    
    .如果 (_启动窗口.执行 (., 相加 (“insert into 教员表 values (”, 资料), .图片, 到字节集 (.内容), 到字节集 (.内容)))
        _启动窗口.执行 (., 相加 (“update 记号表 set 教员编号=”, 到文本 (教员序号), “ where ID=1”), )
        赋值 (教员序号, 相加 (教员序号, 1))
        .插入表项 (.内容, 0, , , )
        .查找表项 (.内容, , ).选择表项 ()
        .保证显示 (.)
        .如果 (等于 (.取项目文本 (.现行选中项), “男”))
            赋值 (男, 相加 (男, 1))
        .否则
            赋值 (女, 相加 (女, 1))
        .如果结束
        赋值 (.标题, 相加 (“目前本校共有教员”, 到文本 (取表项数 ()), “人，其中男”, 到文本 (男), “人，女”, 到文本 (女), “人。”))
        连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
        赋值 (.图片, #图片1)
        获取焦点 ()
        赋值 (已修改, 真)
    .否则
        信息框 (“保存数据失败！”, 0, )
    .如果结束
    
    
.判断 (等于 (., “保存修改”))
    .如果真 (等于 (取表项数 (), 0))
        信息框 (“目前本校没有教员资料！”, 0, )
        连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
        赋值 (.图片, #图片1)
        返回 ()
    .如果真结束
    
    .如果真 (等于 (删全部空 (.内容), “”))
        信息框 (“请输入要修改资料的教员姓名！”, 64, )
        获取焦点 ()
    .如果真结束
    检查教员输入 ()
    赋值 (资料, 相加 (.内容, “',性别='”, .内容, “',民族='”, .内容, “',出生日期='”, 时间到文本 (.今天, 2), “',学历='”, .内容, “',政治面貌='”, .内容, “',参加工作时间='”, 时间到文本 (.今天, 2), “',调入本校时间='”, 时间到文本 (.今天, 2), “',职称='”, .内容, “',职务或岗位='”, .内容, “',身份证号='”, .内容, “',手机号码='”, .内容, “',家庭住址='”, .内容, “',住宅电话='”, .内容, “',籍贯='”, .内容, “',户籍所在地='”, .内容, “',照片=?,个人简历=?,其他资料=?”))
    
    .如果 (_启动窗口.执行 (., 相加 (“update 教员表 set 姓名='”, 资料, “ where 姓名='”, .内容, “'”), .图片, 到字节集 (.内容), 到字节集 (.内容)))
        .置标题 (., , .内容)
        获取焦点 ()
        .如果真 (不等于 (.取项目文本 (.现行选中项), 性别参考))
            .如果 (等于 (.内容, “男”))
                赋值 (男, 相加 (男, 1))
                赋值 (女, 相减 (女, 1))
            .否则
                赋值 (男, 相减 (男, 1))
                赋值 (女, 相加 (女, 1))
            .如果结束
            
        .如果真结束
        赋值 (.标题, 相加 (“目前本校共有教员”, 到文本 (取表项数 ()), “人，其中男”, 到文本 (男), “人，女”, 到文本 (女), “人。”))
        赋值 (已修改, 真)
        信息框 (“修改数据已保存！”, 0, )
    .否则
        信息框 (“保存数据失败！”, 0, )
    .如果结束
    
.默认
    
.判断结束


.子程序 检查教员输入, 空白型, , 
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “-”)
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “-”)
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “-”)
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “-”)
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “-”)
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “-”)
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “-”)
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “-”)
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “-”)
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “-”)
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “-”)
.如果真结束


.子程序 _退出钮_被单击, 空白型, , 
教员资料录入修改窗口.销毁 ()

.子程序 _教员资料录入修改窗口_将被销毁, 空白型, , 
.判断开始 (并且 (等于 (_启动窗口..现行子夹, 5), 等于 (已修改, 真)))
    回主界面 ()
.判断 (并且 (等于 (_启动窗口..现行子夹, 6), 等于 (已修改, 真)))
    回主界面 ()
.默认
    
.判断结束


.窗口程序集 工资设置程序集, , , 

.子程序 _工资系统设置窗口_创建完毕, 空白型, , 
.局部变量 计数, 整数型, , , 
.局部变量 年, 整数型, , , 

赋值 (工资系统设置窗口., 相减 (相加 (工资系统设置窗口., 145), 工资系统设置窗口.取用户区高度 ()))
赋值 (.标题, 相加 (“设置修改 ”, _启动窗口..内容, “ 的工资项目名称”))
赋值 (年, 相减 (取年份 (取现行时间 ()), 5))
清空 ()
.计次循环首 (10, 计数)
    相加 (到文本 (相加 (年, 计数)), “年”).加入项目 ()
.计次循环尾 ()
相加 (到文本 (取年份 (取现行时间 ())), “年”).选择 ()
相加 (到文本 (取月份 (取现行时间 ())), “月”).选择 ()
赋值 (.内容, _启动窗口..标题)
赋值 (.内容, _启动窗口.取文本 (., 1, 2))
赋值 (.内容, _启动窗口.取文本 (., 1, 3))
赋值 (.内容, _启动窗口.取文本 (., 1, 4))
赋值 (.内容, _启动窗口.取文本 (., 1, 5))
赋值 (.内容, _启动窗口.取文本 (., 1, 6))
赋值 (.内容, _启动窗口.取文本 (., 1, 7))
赋值 (.内容, _启动窗口.取文本 (., 1, 8))
获取焦点 ()
赋值 (.被选择字符数, 取文本长度 (.内容))


.子程序 _确定按钮_被单击, 空白型, , 
写配置项 (相加 (取运行目录 (), “\config.ini”), “Wages”, _启动窗口..内容, .内容)
_启动窗口.置表头行数 (., 0)
赋值 (_启动窗口..标题, .内容)
赋值 (_启动窗口..内容, 相加 (.内容, .内容))
_启动窗口.置文本 (., 1, 2, .内容)
_启动窗口.置文本 (., 1, 3, .内容)
_启动窗口.置文本 (., 1, 4, .内容)
_启动窗口.置文本 (., 1, 5, .内容)
_启动窗口.置文本 (., 1, 6, .内容)
_启动窗口.置文本 (., 1, 7, .内容)
_启动窗口.置文本 (., 1, 8, .内容)
_启动窗口.置表头行数 (., 1)
_启动窗口.获取焦点 (.)
销毁 ()


.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()
_启动窗口.获取焦点 (.)

.子程序 _工资系统设置窗口_将被销毁, 空白型, , 
_启动窗口.获取焦点 (.)

.子程序 _工资表标题编辑框_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _工资项目编辑框1_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _工资项目编辑框2_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _工资项目编辑框3_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _工资项目编辑框4_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _工资项目编辑框5_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _工资项目编辑框6_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _工资项目编辑框7_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _年份组合框_列表项被选择, 空白型, , 
获取焦点 ()

.子程序 _月份组合框_列表项被选择, 空白型, , 
获取焦点 ()

.窗口程序集 系统设置程序集, , , 

.程序集变量 修改设置, 逻辑型, , , 
.子程序 _系统设置窗口_创建完毕, 空白型, , 
.局部变量 表项, 整数型, , , 

赋值 (系统设置窗口., 相减 (相加 (系统设置窗口., 310), 系统设置窗口.取用户区高度 ()))
赋值 (.现行子夹, 0)
连续赋值 (_启动窗口..标题, .标题, .内容)
赋值 (记录, _启动窗口.查询 (., “select 所在班级,班主任 from 班级表”))
_启动窗口.到首记录 (., 记录)
.如果 (不等于 (记录, 0))
    .判断循环首 (等于 (_启动窗口.尾记录后 (., 记录), 假))
        赋值 (表项, .插入表项 (_启动窗口.读 (., 记录, “所在班级”), , , , ))
        表项.置标题 (1, _启动窗口.读 (., 记录, “班主任”))
        表项.插入项目 (表项.取标题 (1), )
        _启动窗口.到后一记录 (., 记录)
    .判断循环尾 ()
    赋值 (., 0)
    赋值 (.现行选中项, .)
.否则
    信息框 (“班级数据载入失败！”, #错误图标, “错误”)
.如果结束
_启动窗口.关闭记录集 (., 记录)
赋值 (修改设置, 假)


.子程序 _系统设置窗口_被取消激活, 空白型, , 
获取焦点 ()

.子程序 _选择年级组合框_列表项被选择, 空白型, , 
获取焦点 ()

.子程序 _班级名列表框_获得焦点, 空白型, , 
重画 ()

.子程序 _添加学校按钮_被单击, 空白型, , 
写配置项 (相加 (取运行目录 (), “\config.ini”), “School”, “Name”, .内容)
置文件属性 (相加 (取运行目录 (), “\config.ini”), 2)
赋值 (.标题, .内容)
赋值 (_启动窗口..标题, .内容)
赋值 (_启动窗口..内容, 相加 (.内容, “校务管理系统”))


.子程序 _添加班级按钮_被单击, 空白型, , 
.局部变量 班级, 文本型, , , 
.局部变量 添加内容, 文本型, , , 
.局部变量 班级名称, 文本型, , , 
.局部变量 班级分类, 文本型, , , 
.局部变量 表项, 空白型, , , 


.如果真 (并且 (等于 (.现行子夹, 0), 等于 (删全部空 (.内容), “”)))
    信息框 (“请选择或输入通用班级名称！”, 0, “提示”)
    返回 ()
.如果真结束
.如果真 (并且 (等于 (.现行子夹, 1), 等于 (删全部空 (.内容), “”)))
    信息框 (“请输入自设的班级名称！”, 0, “提示”)
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入班主任的姓名”, 0, “提示”)
    返回 ()
.如果真结束

.判断开始 (等于 (.现行子夹, 0))
    赋值 (班级名称, 相加 (.内容, .内容))
    赋值 (班级分类, “通用”)
.判断 (等于 (.现行子夹, 1))
    赋值 (班级名称, .内容)
    赋值 (班级分类, “自设”)
.默认
    
.判断结束

赋值 (记录, _启动窗口.查询 (., 相加 (“select count(*) as 重复 from 班级表 where 所在班级='”, 班级名称, “'”)))
.如果真 (大于 (_启动窗口.读 (., 记录, “重复”), 0))
    信息框 (相加 (班级名称, “已经存在！”), 0, )
    _启动窗口.关闭记录集 (., 记录)
    返回 ()
.如果真结束
_启动窗口.关闭记录集 (., 记录)
赋值 (班级, 相加 (“'”, 班级名称, “','”, .内容, “','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','','”, 班级分类, “','','','','','','','','','',''”))
赋值 (添加内容, 相加 (“insert into 班级表 values (”, 班级, “)”))
.如果 (_启动窗口.执行 (., 添加内容, ))
    赋值 (表项, .插入表项 (班级名称, , , , ))
    表项.置标题 (1, .内容)
    表项.插入项目 (表项.取标题 (1), )
    赋值 (., 表项)
    赋值 (.现行选中项, .)
    .保证显示 (.)
    .如果真 (或者 (等于 (_启动窗口..现行子夹, 1), 等于 (_启动窗口..现行子夹, 3), 等于 (_启动窗口..现行子夹, 4), 等于 (_启动窗口..现行子夹, 8)))
        赋值 (修改设置, 真)
    .如果真结束
    
.否则
    信息框 (“添加班级数据失败！”, 相加 (0, #错误图标), “提示信息”)
.如果结束


.子程序 _修改班主任按钮_被单击, 空白型, , 
.如果 (不等于 (.取标题 (., ), “”))
    载入 (修改班主任窗口, , 真)
.否则
    信息框 (“  请选择要修改班主任姓名的班级！  ”, 0, )
.如果结束


.子程序 _删除班级按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    信息框 (“请在列表中选择要删除的班级”, 0, )
    返回 ()
.如果真结束

.如果真 (等于 (信息框 (相加 (“您确定要删除”, .取标题 (., 0), “的全部学生资料吗？”), 相加 (#确认取消钮, #警告图标), “询问”), #确认钮))
    _启动窗口.执行 (., 相加 (“delete from 班级表 where 所在班级=”, “'”, .取标题 (., 0), “'”), )
    _启动窗口.执行 (., 相加 (“delete from 学籍表 where 所在班级=”, “'”, .取标题 (., 0), “'”), )
    .删除表项 (.)
    .删除项目 (.现行选中项)
    .如果真 (等于 (取表项数 (), 0))
        _启动窗口.执行 (., “update 记号表 set 学号 ='0'where ID=1”, )
    .如果真结束
    .如果真 (或者 (等于 (_启动窗口..现行子夹, 1), 等于 (_启动窗口..现行子夹, 3), 等于 (_启动窗口..现行子夹, 4), 等于 (_启动窗口..现行子夹, 8)))
        赋值 (修改设置, 真)
    .如果真结束
    
.如果真结束


.子程序 _课程设置按钮_被单击, 空白型, , 
.如果真 (或者 (等于 (_启动窗口..现行子夹, 1), 等于 (_启动窗口..现行子夹, 4), 等于 (_启动窗口..现行子夹, 8)))
    赋值 (修改设置, 真)
.如果真结束
获取焦点 ()
载入 (设置科目窗口, 系统设置窗口, 真)

.子程序 _退出设置按钮_被单击, 空白型, , 
.如果真 (等于 (修改设置, 真))
    回主界面 ()
.如果真结束
系统设置窗口.销毁 ()

.子程序 _系统设置窗口_将被销毁, 空白型, , 
.如果真 (等于 (修改设置, 真))
    回主界面 ()
.如果真结束


.子程序 _班级名列表框_当前表项被改变, 空白型, , 
赋值 (.现行选中项, .)

.窗口程序集 班主任修改程序集, , , 

.子程序 _修改班主任窗口_创建完毕, 空白型, , 
赋值 (修改班主任窗口., 相减 (相加 (修改班主任窗口., 110), 修改班主任窗口.取用户区高度 ()))
赋值 (.标题, 相加 (“修改”, 系统设置窗口.取标题 (., 系统设置窗口.., 0), “的班主任姓名”))
赋值 (.内容, 系统设置窗口.取标题 (., 系统设置窗口.., 1))
获取焦点 ()
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _按钮1_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (“请输入班主任的姓名”, 0, )
    返回 ()
.如果真结束

.如果 (_启动窗口.执行 (., 相加 (“update 班级表 set 班主任 = ”, “'”, .内容, “' where 所在班级=”, “'”, 系统设置窗口.取标题 (., 系统设置窗口.., 0), “'”), ))
    系统设置窗口.置标题 (., 系统设置窗口.., 1, .内容)
    系统设置窗口.置项目文本 (., 系统设置窗口.., .内容)
    销毁 ()
.否则
    信息框 (“修改记录失败！”, 相加 (0, #错误图标), “提示信息”)
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.窗口程序集 欢迎程序集, , , 

.程序集变量 等待, 整数型, , , 
.子程序 _欢迎窗口_创建完毕, 空白型, , 
赋值 (欢迎窗口., 真)
赋值 (.时钟周期, 300)

.子程序 _启动时钟_周期事件, 空白型, , 
.判断开始 (等于 (.内容, “■ □ □ □ □”))
    赋值 (.内容, “□ ■ □ □ □”)
.判断 (等于 (.内容, “□ ■ □ □ □”))
    赋值 (.内容, “□ □ ■ □ □”)
.判断 (等于 (.内容, “□ □ ■ □ □”))
    赋值 (.内容, “□ □ □ ■ □”)
.判断 (等于 (.内容, “□ □ □ ■ □”))
    赋值 (.内容, “□ □ □ □ ■”)
.判断 (等于 (.内容, “□ □ □ □ ■”))
    赋值 (.内容, “■ □ □ □ □”)
.默认
    
.判断结束
刷新显示 ()
赋值 (等待, 相加 (等待, 1))
.如果真 (并且 (大于或等于 (等待, 14), 等于 (_启动窗口., “校务管理系统 v3.0”)))
    赋值 (.时钟周期, 0)
    赋值 (选择子夹, 0)
    载入 (管理员登录窗口, _启动窗口, 假)
.如果真结束


.程序集 打印程序集, , , 

.子程序 打印学籍卡, 空白型, , 
填学籍卡 ()
赋值 (打印设置, _启动窗口.取打印设置 (.))
设置打印 (1, 2, 200, 200, 150, 200, -1)
_启动窗口.置打印设置 (., 打印设置)

.子程序 设置打印, 空白型, , 
.参数 纸张方向, 整数型, 可空, 
.参数 纸张类型, 整数型, 可空, 
.参数 左边距, 整数型, 可空, 
.参数 右边距, 整数型, 可空, 
.参数 上边距, 整数型, 可空, 
.参数 下边距, 整数型, 可空, 
.参数 打印缩放比, 整数型, 可空, 

赋值 (打印设置.纸张方向, 纸张方向)
赋值 (打印设置.纸张类型, 纸张类型)
赋值 (打印设置.左边距, 左边距)
赋值 (打印设置.右边距, 右边距)
赋值 (打印设置.上边距, 上边距)
赋值 (打印设置.下边距, 下边距)
赋值 (打印设置.打印缩放比, 打印缩放比)


.子程序 填学籍卡, 空白型, , 
.如果 (并且 (等于 (_启动窗口..标题, “”), 等于 (_启动窗口..标题, “”), 等于 (_启动窗口..标题, “”)))
    _启动窗口.置文本 (., 1, 1, 相加 (_启动窗口..标题, “学籍表”))
    返回 ()
.否则
    _启动窗口.置文本 (., 1, 1, _启动窗口..标题)
.如果结束
_启动窗口.置文本 (., 2, 12, 时间到文本 (取现行时间 (), #日期部分))
_启动窗口.置文本 (., 3, 2, _启动窗口..标题)
_启动窗口.置文本 (., 3, 8, _启动窗口..标题)
_启动窗口.置文本 (., 4, 2, _启动窗口..标题)
_启动窗口.置文本 (., 4, 8, _启动窗口..标题)
_启动窗口.置文本 (., 5, 2, _启动窗口..标题)
_启动窗口.置文本 (., 5, 8, _启动窗口..标题)
_启动窗口.置文本 (., 6, 2, _启动窗口..标题)
_启动窗口.置文本 (., 6, 8, _启动窗口..标题)
_启动窗口.置文本 (., 7, 2, _启动窗口..标题)
_启动窗口.置文本 (., 7, 8, _启动窗口..标题)
_启动窗口.置文本 (., 8, 2, _启动窗口..标题)
_启动窗口.置文本 (., 8, 8, _启动窗口..标题)
_启动窗口.置文本 (., 9, 1, _启动窗口..标题)
_启动窗口.置文本 (., 9, 2, _启动窗口..标题)
_启动窗口.置文本 (., 9, 4, _启动窗口..标题)
_启动窗口.置文本 (., 9, 10, _启动窗口..标题)
_启动窗口.置文本 (., 10, 1, _启动窗口..标题)
_启动窗口.置文本 (., 10, 2, _启动窗口..标题)
_启动窗口.置文本 (., 10, 4, _启动窗口..标题)
_启动窗口.置文本 (., 10, 10, _启动窗口..标题)
_启动窗口.置文本 (., 16, 1, _启动窗口..内容)
_启动窗口.置数据 (., 3, 12, _启动窗口..图片)
_启动窗口.置文本 (., 12, 2, _启动窗口..标题)
_启动窗口.置文本 (., 12, 3, _启动窗口..标题)
_启动窗口.置文本 (., 12, 4, _启动窗口..标题)
_启动窗口.置文本 (., 12, 5, _启动窗口..标题)
_启动窗口.置文本 (., 12, 6, _启动窗口..标题)
_启动窗口.置文本 (., 12, 8, _启动窗口..标题)
_启动窗口.置文本 (., 12, 9, _启动窗口..标题)
_启动窗口.置文本 (., 12, 10, _启动窗口..标题)
_启动窗口.置文本 (., 12, 11, _启动窗口..标题)
_启动窗口.置文本 (., 12, 13, _启动窗口..标题)

_启动窗口.置文本 (., 13, 2, _启动窗口..标题)
_启动窗口.置文本 (., 13, 3, _启动窗口..标题)
_启动窗口.置文本 (., 13, 4, _启动窗口..标题)
_启动窗口.置文本 (., 13, 5, _启动窗口..标题)
_启动窗口.置文本 (., 13, 6, _启动窗口..标题)
_启动窗口.置文本 (., 13, 8, _启动窗口..标题)
_启动窗口.置文本 (., 13, 9, _启动窗口..标题)
_启动窗口.置文本 (., 13, 10, _启动窗口..标题)
_启动窗口.置文本 (., 13, 11, _启动窗口..标题)
_启动窗口.置文本 (., 13, 13, _启动窗口..标题)
_启动窗口.置文本 (., 14, 2, _启动窗口..标题)
_启动窗口.置文本 (., 14, 3, _启动窗口..标题)
_启动窗口.置文本 (., 14, 4, _启动窗口..标题)
_启动窗口.置文本 (., 14, 5, _启动窗口..标题)
_启动窗口.置文本 (., 14, 6, _启动窗口..标题)
_启动窗口.置文本 (., 14, 8, _启动窗口..标题)
_启动窗口.置文本 (., 14, 9, _启动窗口..标题)
_启动窗口.置文本 (., 14, 10, _启动窗口..标题)
_启动窗口.置文本 (., 14, 11, _启动窗口..标题)
_启动窗口.置文本 (., 14, 13, _启动窗口..标题)
_启动窗口.置文本 (., 16, 8, _启动窗口..标题)
.如果 (等于 (学生分类, “在校学生”))
    _启动窗口.置文本 (., 2, 1, “班主任：”)
    _启动窗口.置文本 (., 2, 2, _启动窗口..标题)
.否则
    _启动窗口.置文本 (., 2, 1, “”)
    _启动窗口.打印数据源.置文本 (2, 2, “”) 
    
.如果结束


.子程序 打印学生花名册, 空白型, , 
.参数 打印列表框, 超级列表框, , 
.参数 打印标题, 文本型, 可空, 
.参数 打印副标题, 文本型, 可空, 可写入如打印时间等

.局部变量 计次, 整数型, , , 
.局部变量 次数, 整数型, , , 

置等待鼠标 ()
_启动窗口.初始尺寸 (., 0, 0)
_启动窗口.添加行 (., 3)
_启动窗口.插入列 (., 1, 9)
_启动窗口.置列宽 (., 1, 2, 240)
_启动窗口.置列宽 (., 3, 1, 140)
_启动窗口.置列宽 (., 4, 1, 240)
_启动窗口.置列宽 (., 5, 2, 300)
_启动窗口.置列宽 (., 7, 3, 360)
_启动窗口.合并 (., 1, 1, 1, 9)
_启动窗口.合并 (., 2, 1, 1, 7)
_启动窗口.置行高 (., 1, 1, 180)
_启动窗口.置行高 (., 3, 1, 80)
_启动窗口.置对齐方式 (., 1, 1, 3, 9, #中中)
_启动窗口.置对齐方式 (., 2, 1, 1, 7, #中左)
_启动窗口.置对齐方式 (., 2, 8, 1, 1, #中右)
_启动窗口.置字体名 (., 1, 1, 1, 1, “楷体_GB2312”)
_启动窗口.置字体尺寸 (., 1, 1, 1, 1, 80)
_启动窗口.置字体属性 (., 1, 1, 3, 11, #粗体)
_启动窗口.置文本 (., 1, 1, 打印标题)
_启动窗口.置文本 (., 2, 1, 打印副标题)
_启动窗口.置文本 (., 2, 8, “打印日期：”)
_启动窗口.置文本 (., 2, 9, 时间到文本 (取现行时间 (), #日期部分))
.计次循环首 (打印列表框.取列数 (), 计次)
    _启动窗口.置文本 (., 3, 计次, 打印列表框.取列标题 (计次))
.计次循环尾 ()
_启动窗口.置表头行数 (., 3)
.计次循环首 (打印列表框.取表项数 (), 计次)
    _启动窗口.添加行 (., 1)
    .计次循环首 (打印列表框.取列数 (), 次数)
        _启动窗口.置文本 (., 相加 (计次, 3), 次数, 打印列表框.取标题 (相减 (计次, 1), 次数))
    .计次循环尾 ()
.计次循环尾 ()

_启动窗口.加线条 (., 3, 1, 相加 (_启动窗口.取行数 (.), 1), 9, 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))
_启动窗口.置行高 (., 4, 相减 (_启动窗口.取行数 (.), 3), 70)
_启动窗口.置对齐方式 (., 4, 1, 相减 (_启动窗口.取行数 (.), 3), 9, #中中)
赋值 (打印设置, _启动窗口.取打印设置 (.))
设置打印 (1, 2, 200, 200, 150, 220, -1)
赋值 (打印设置.每页打印行数, 0)
赋值 (打印设置.页号位置, 6)
赋值 (打印设置.自动填充, 真)
_启动窗口.置打印设置 (., 打印设置)
恢复鼠标 ()

.子程序 打印成绩表, 空白型, , 
置等待鼠标 ()
_启动窗口.初始尺寸 (., 0, 0)
_启动窗口.添加行 (., 2)
_启动窗口.插入列 (., 1, 12)
_启动窗口.合并 (., 1, 1, 1, 12)
_启动窗口.合并 (., 2, 9, 1, 2)
_启动窗口.合并 (., 2, 11, 1, 2)
_启动窗口.置行高 (., 1, 1, 150)
_启动窗口.置行高 (., 2, 1, 60)
_启动窗口.置列宽 (., 1, 2, 220)
_启动窗口.置列宽 (., 3, 10, 213)
_启动窗口.置文本 (., 1, 1, 相加 (_启动窗口..标题, _启动窗口.取项目文本 (., _启动窗口..现行选中项), _启动窗口.取项目文本 (., _启动窗口..现行选中项), “表”))
_启动窗口.置字体属性 (., 1, 1, 1, 1, 1)
_启动窗口.置字体尺寸 (., 1, 1, 1, 1, 80)
_启动窗口.置字体名 (., 1, 1, 1, 1, “楷体_GB2312”)
_启动窗口.置对齐方式 (., 1, 1, 1, 1, #中中)
_启动窗口.置对齐方式 (., 2, 9, 1, 1, #中右)
_启动窗口.置对齐方式 (., 2, 11, 1, 1, #中左)
_启动窗口.置文本 (., 2, 9, “打印日期：”)
_启动窗口.置文本 (., 2, 11, 时间到文本 (取现行时间 (), 2))
_启动窗口.添加 (., _启动窗口., , )
_启动窗口.加线条 (., 3, 1, _启动窗口.取行数 (.), _启动窗口.取列数 (.), 相加 (1, 2, 4, 8, 16, 32))
_启动窗口.置背景色 (., 1, 1, _启动窗口.取行数 (.), _启动窗口.取列数 (.), #白色)
_启动窗口.置表头行数 (., 3)

赋值 (打印设置, _启动窗口.取打印设置 (.))
设置打印 (1, 2, 200, 200, 150, 220, -1)
赋值 (打印设置.每页打印行数, 0)
赋值 (打印设置.页号位置, 6)
赋值 (打印设置.自动填充, 真)
_启动窗口.置打印设置 (., 打印设置)
恢复鼠标 ()

.子程序 打印统计表, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 次数, 整数型, , , 

置等待鼠标 ()
_启动窗口.初始尺寸 (., 0, 0)
_启动窗口.添加行 (., 3)
_启动窗口.插入列 (., 1, 12)
_启动窗口.置列宽 (., 1, 1, 360)
_启动窗口.置列宽 (., 2, 11, 200)
_启动窗口.合并 (., 1, 1, 1, 12)
_启动窗口.合并 (., 2, 9, 1, 2)
_启动窗口.合并 (., 2, 11, 1, 2)
_启动窗口.置行高 (., 1, 1, 180)
_启动窗口.置行高 (., 3, 1, 80)
_启动窗口.置对齐方式 (., 1, 1, 3, 12, #中中)
_启动窗口.置对齐方式 (., 2, 11, 1, 1, #中左)
_启动窗口.置对齐方式 (., 2, 9, 1, 1, #中右)
_启动窗口.置字体名 (., 1, 1, 1, 1, “楷体_GB2312”)
_启动窗口.置字体尺寸 (., 1, 1, 1, 1, 80)
_启动窗口.置字体属性 (., 1, 1, 3, 12, #粗体)

_启动窗口.置文本 (., 1, 1, _启动窗口..标题)
_启动窗口.置文本 (., 2, 9, “打印日期：”)
_启动窗口.置文本 (., 2, 11, 时间到文本 (取现行时间 (), #日期部分))

.计次循环首 (_启动窗口.取列数 (.), 计次)
    _启动窗口.置文本 (., 3, 计次, _启动窗口.取列标题 (., 计次))
.计次循环尾 ()
_启动窗口.置表头行数 (., 3)
.计次循环首 (_启动窗口.取表项数 (.), 计次)
    _启动窗口.添加行 (., 1)
    .计次循环首 (_启动窗口.取列数 (.), 次数)
        _启动窗口.置文本 (., 相加 (计次, 3), 次数, _启动窗口.取标题 (., 相减 (计次, 1), 次数))
    .计次循环尾 ()
.计次循环尾 ()


_启动窗口.加线条 (., 3, 1, 相加 (_启动窗口.取行数 (.), 1), 12, 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))
_启动窗口.置行高 (., 4, 相减 (_启动窗口.取行数 (.), 3), 70)
_启动窗口.置对齐方式 (., 4, 1, 相减 (_启动窗口.取行数 (.), 3), 12, #中中)
赋值 (打印设置, _启动窗口.取打印设置 (.))
设置打印 (1, 2, 200, 200, 150, 220, -1)
赋值 (打印设置.每页打印行数, 0)
赋值 (打印设置.页号位置, 6)
赋值 (打印设置.自动填充, 真)
_启动窗口.置打印设置 (., 打印设置)
恢复鼠标 ()


.子程序 打印教员卡, 空白型, , 
置等待鼠标 ()
填教员卡 ()
赋值 (打印设置, _启动窗口.取打印设置 (.))
设置打印 (1, 2, 200, 200, 150, 200, -1)
_启动窗口.置打印设置 (., 打印设置)
恢复鼠标 ()

.子程序 填教员卡, 空白型, , 
.如果 (并且 (等于 (_启动窗口.取表项数 (.), 0), 等于 (_启动窗口..标题, “”), 等于 (_启动窗口..标题, “”)))
    _启动窗口.置文本 (., 1, 1, 相加 (_启动窗口..标题, “教员登记表表”))
    返回 ()
.否则
    _启动窗口.置文本 (., 1, 1, _启动窗口..标题)
.如果结束
_启动窗口.置文本 (., 2, 5, “打印时间：”)
_启动窗口.置文本 (., 2, 6, 时间到文本 (取现行时间 (), 2))
_启动窗口.置文本 (., 3, 2, _启动窗口..标题)
_启动窗口.置文本 (., 3, 5, _启动窗口..标题)
_启动窗口.置文本 (., 4, 2, _启动窗口..标题)
_启动窗口.置文本 (., 4, 5, _启动窗口..标题)
_启动窗口.置文本 (., 5, 2, _启动窗口..标题)
_启动窗口.置文本 (., 5, 5, _启动窗口..标题)
_启动窗口.置文本 (., 6, 2, _启动窗口..标题)
_启动窗口.置文本 (., 6, 5, _启动窗口..标题)
_启动窗口.置文本 (., 7, 2, _启动窗口..标题)
_启动窗口.置文本 (., 7, 5, _启动窗口..标题)
_启动窗口.置文本 (., 8, 2, _启动窗口..标题)
_启动窗口.置文本 (., 8, 5, _启动窗口..标题)
_启动窗口.置文本 (., 9, 2, _启动窗口..标题)
_启动窗口.置文本 (., 9, 5, _启动窗口..标题)
_启动窗口.置文本 (., 10, 2, _启动窗口..标题)
_启动窗口.置文本 (., 10, 5, _启动窗口..标题)
_启动窗口.置文本 (., 13, 1, _启动窗口..内容)
_启动窗口.置数据 (., 3, 6, _启动窗口..图片)
_启动窗口.置文本 (., 13, 5, _启动窗口..标题)


.子程序 打印教员花名册, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 次数, 整数型, , , 

_启动窗口.初始尺寸 (., 0, 0)
_启动窗口.添加行 (., 3)
_启动窗口.插入列 (., 1, 9)
_启动窗口.置列宽 (., 1, 1, 240)
_启动窗口.置列宽 (., 2, 1, 140)
_启动窗口.置列宽 (., 3, 2, 240)
_启动窗口.置列宽 (., 5, 2, 300)
_启动窗口.置列宽 (., 7, 3, 360)
_启动窗口.合并 (., 1, 1, 1, 10)
_启动窗口.置行高 (., 1, 1, 180)
_启动窗口.置行高 (., 2, 2, 80)
_启动窗口.置对齐方式 (., 1, 1, 3, 9, #中中)
_启动窗口.置对齐方式 (., 2, 8, 1, 1, #中右)
_启动窗口.置对齐方式 (., 2, 9, 1, 1, #中左)
_启动窗口.置字体名 (., 1, 1, 1, 1, “楷体_GB2312”)
_启动窗口.置字体尺寸 (., 1, 1, 1, 1, 80)
_启动窗口.置字体属性 (., 1, 1, 3, 9, #粗体)
_启动窗口.置文本 (., 1, 1, _启动窗口..标题)
_启动窗口.置文本 (., 2, 8, “打印日期：”)
_启动窗口.置文本 (., 2, 9, 时间到文本 (取现行时间 (), #日期部分))
.计次循环首 (_启动窗口.取列数 (.), 计次)
    _启动窗口.置文本 (., 3, 计次, _启动窗口.取列标题 (., 计次))
.计次循环尾 ()
_启动窗口.置表头行数 (., 3)
.计次循环首 (_启动窗口.取表项数 (.), 计次)
    _启动窗口.添加行 (., 1)
    .计次循环首 (_启动窗口.取列数 (.), 次数)
        _启动窗口.置文本 (., 相加 (计次, 3), 次数, _启动窗口.取标题 (., 相减 (计次, 1), 次数))
    .计次循环尾 ()
.计次循环尾 ()
_启动窗口.置行高 (., 4, 相减 (_启动窗口.取行数 (.), 3), 70)
_启动窗口.置对齐方式 (., 4, 1, 相减 (_启动窗口.取行数 (.), 3), 10, #中中)
_启动窗口.加线条 (., 3, 1, 相加 (_启动窗口.取行数 (.), 1), 10, 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))
赋值 (打印设置, _启动窗口.取打印设置 (.))
设置打印 (1, 2, 200, 200, 150, 150, -1)
赋值 (打印设置.每页打印行数, 0)
赋值 (打印设置.页号位置, 6)
赋值 (打印设置.自动填充, 真)
_启动窗口.置打印设置 (., 打印设置)

.子程序 打印工资表, 空白型, , 
_启动窗口.初始尺寸 (., 0, 0)
_启动窗口.添加行 (., 2)
_启动窗口.插入列 (., 1, 10)
_启动窗口.合并 (., 1, 1, 1, 10)
_启动窗口.置行高 (., 1, 1, 150)
_启动窗口.置行高 (., 2, 1, 60)
_启动窗口.置列宽 (., 1, 10, 257)
_启动窗口.置文本 (., 1, 1, _启动窗口..标题)
_启动窗口.置字体属性 (., 1, 1, 1, 1, 1)
_启动窗口.置字体尺寸 (., 1, 1, 1, 1, 80)
_启动窗口.置字体名 (., 1, 1, 1, 1, “楷体_GB2312”)
_启动窗口.置对齐方式 (., 1, 1, 1, 1, #中中)
_启动窗口.置文本 (., 2, 1, “制表：”)
_启动窗口.置文本 (., 2, 2, “会计：”)
_启动窗口.置文本 (., 2, 3, “出纳：”)
_启动窗口.置文本 (., 2, 10, _启动窗口..内容)
_启动窗口.添加 (., _启动窗口., , )
_启动窗口.置背景色 (., 1, 1, _启动窗口.取行数 (.), _启动窗口.取列数 (.), #白色)
_启动窗口.加线条 (., 3, 1, _启动窗口.取行数 (.), _启动窗口.取列数 (.), 相加 (1, 2, 4, 8, 16, 32))
_启动窗口.置表头行数 (., 3)
赋值 (打印设置, _启动窗口.取打印设置 (.))
设置打印 (1, 2, 200, 200, 150, 200, -1)
赋值 (打印设置.每页打印行数, 0)
赋值 (打印设置.页号位置, 6)
赋值 (打印设置.自动填充, 假)
_启动窗口.置打印设置 (., 打印设置)

.窗口程序集 课程表程序集, , , 

.程序集变量 行标签, 标签, , "5,8", 
.程序集变量 列标签, 外形框, , "5,8", 
.程序集变量 当前行, 整数型, , , 
.程序集变量 当前列, 整数型, , , 
.子程序 _课程表窗口_创建完毕, 空白型, , 
.局部变量 横, 整数型, , , 1~5,横向的位置
.局部变量 纵, 整数型, , , 1~8，纵向的位置
.局部变量 临时标签, 标签, , , 
.局部变量 临时外形框, 外形框, , , 

赋值 (课程表窗口., 相减 (相加 (课程表窗口., 360), 课程表窗口.取用户区高度 ()))
.变量循环首 (1, 5, 1, 横)
    .变量循环首 (1, 8, 1, 纵)
        复制窗口组件 (临时外形框)
        复制窗口组件 (临时标签)
        置父窗口 (临时标签.取窗口句柄 (), 临时外形框.取窗口句柄 ())
        赋值 (行标签 [横] [纵], 临时标签)
        赋值 (列标签 [横] [纵], 临时外形框)
        行标签.移动 ( [横] [纵], 3, 3, 79, 18)
        列标签.移动 ( [横] [纵], 相加 (33, 相乘 (横, 84)), 相加 (41, 相乘 (23, 纵)), 85, 24)
        .如果真 (大于或等于 (纵, 5))
            赋值 (列标签 [横] [纵], 顶边, 相加 (列标签 [横] [纵], 顶边, 10))
        .如果真结束
        赋值 (临时标签.可视, 真)
        赋值 (临时外形框.可视, 真)
    .变量循环尾 ()
.变量循环尾 ()
赋值 (行标签 [1] [1], )
赋值 (列标签 [1] [1], )
赋值 (当前行, 1)
赋值 (当前列, 1)
.如果 (填充班级名称 ())
    填充课程科目 ()
    .如果 (#课程表.从字节集读 ())
        填充课程表 ()
    .否则
        信息框 (“  打开模板文件失败！  ”, #错误图标, “错误”)
        销毁 ()
    .如果结束
    
.否则
    信息框 (“目前没有班级数据，请先进行校务设置！”, 0, “提示”)
    销毁 ()
    _校务设置_被选择 ()
.如果结束


.子程序 填充课程科目, 空白型, , 
.局部变量 计次, 整数型, , , 

清空 ()
赋值 (记录, _启动窗口.查询 (., 相加 (“select * from 班级表 where 所在班级='”, .内容, “'”)))
.如果 (不等于 (记录, 0))
    _启动窗口.到首记录 (., 记录)
    .计次循环首 (10, 计次)
        _启动窗口.读 (., 记录, 相加 (“科目”, 到文本 (计次))).加入项目 ()
    .计次循环尾 ()
.否则
    信息框 (“载入课程科目数据失败！”, 0, )
.如果结束
_启动窗口.关闭记录集 (., 记录)


.子程序 填充课程表, 空白型, , 
.局部变量 行变量, 整数型, , , 
.局部变量 列变量, 整数型, , , 

置等待鼠标 ()
1.置文本 (1, 相加 (_启动窗口..标题, .内容, “课程表”))
赋值 (.标题, 1.取文本 (1))
赋值 (记录, _启动窗口.查询 (., 相加 (“select * from 班级表 where 所在班级='”, .内容, “'”)))
.如果 (不等于 (记录, 0))
    _启动窗口.到首记录 (., 记录)
    .计次循环首 (5, 行变量)
        .计次循环首 (8, 列变量)
            相加 (列变量, 2).置文本 (相加 (行变量, 2), _启动窗口.读 (., 记录, 相加 (“星期”, 到文本 (行变量), 到文本 (列变量))))
            赋值 (行标签 [行变量] [列变量], 标题, 相加 (列变量, 2).取文本 (相加 (行变量, 2)))
        .计次循环尾 ()
    .计次循环尾 ()
    2.置文本 (1, 相加 (“班主任：”, _启动窗口.读 (., 记录, “班主任”)))
    赋值 (.标题, 2.取文本 (1))
    3.置行高 (7, 70)
    _启动窗口.关闭记录集 (., 记录)
    赋值 (行标签 [当前行] [当前列], 背景颜色, #白色)
    赋值 (列标签 [当前行] [当前列], 背景颜色, #白色)
    赋值 (列标签 [当前行] [当前列], 线宽, 1)
    赋值 (当前行, 1)
    赋值 (当前列, 1)
    赋值 (行标签 [1] [1].背景颜色, #银白)
    赋值 (列标签 [1] [1].背景颜色, #银白)
    赋值 (列标签 [1] [1].线宽, 2)
    赋值 (.可视, 假)
    获取焦点 ()
    恢复鼠标 ()
    
.否则
    恢复鼠标 ()
    信息框 (“载入课程表数据失败！”, 0, )
    _启动窗口.关闭记录集 (., 记录)
    获取焦点 ()
    
.如果结束


.子程序 _课程表班级组合框_列表项被选择, 空白型, , 
填充课程科目 ()
填充课程表 ()

.子程序 打印班级课程, 逻辑型, , 
.局部变量 计数, 整数型, , , 
.局部变量 询问结果, 整数型, , , 
.局部变量 当前科目, 整数型, , , 

置等待鼠标 ()
赋值 (当前科目, .现行选中项)
0.初始尺寸 (取列数 ())
.计次循环首 (取列数 (), 计数)
    计数.置列宽 (1, 计数.取列宽 ())
.计次循环尾 ()
赋值 (打印设置, 取打印设置 ())
赋值 (询问结果, 信息框 (相加 (“您是否要打印或预览所有班级的课程表？”, #换行符, #换行符, “按”, #左引号, “是”, #右引号, “将打印或预览所有班级的课程表”, #换行符, “按”, #左引号, “否”, #右引号, “将只打印或预览当前班级的课程表    ”, #换行符, “按”, #左引号, “取消”, #右引号, “将取消本次操作”), 相加 (#取消是否钮, #询问图标), “询问”))

.判断开始 (等于 (询问结果, #是钮))
    .计次循环首 (取项目数 (), 计数)
        赋值 (.现行选中项, 相减 (计数, 1))
        填充课程表 ()
        .添加 ()
        2.添加行 ()
    .计次循环尾 ()
    赋值 (打印设置.每页打印行数, 相加 (相乘 (取行数 (), 3), 6))
    赋值 (打印设置.页号位置, 6)
    赋值 (.现行选中项, 当前科目)
    填充课程表 ()
.判断 (等于 (询问结果, #否钮))
    .添加 ()
.判断 (等于 (询问结果, #取消钮))
    返回 (假)
.默认
    
.判断结束

赋值 (打印设置.纸张方向, 0)
赋值 (打印设置.纸张类型, 2)
赋值 (打印设置.左边距, 200)
赋值 (打印设置.右边距, 200)
赋值 (打印设置.上边距, 130)
赋值 (打印设置.下边距, 50)
赋值 (打印设置.打印缩放比, -1)
打印设置.置打印设置 ()
恢复鼠标 ()
返回 (真)

.子程序 _退出钮_被单击, 空白型, , 
.如果真 (等于 (.可视, 真))
    信息框 (“请先退出编辑状态！”, 0, “提示”)
    获取焦点 ()
    返回 ()
.如果真结束
销毁 ()

.子程序 _打印钮_被单击, 空白型, , 
.如果真 (等于 (.可视, 真))
    信息框 (“请先退出编辑状态！”, 0, “提示”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (打印班级课程 ())
    .打印 (“打印课程表”)
.如果真结束


.子程序 _打印预览钮_被单击, 空白型, , 
.如果真 (等于 (.可视, 真))
    信息框 (“请先退出编辑状态！”, 0, “提示”)
    获取焦点 ()
    返回 ()
.如果真结束

.如果真 (打印班级课程 ())
    打印预览 ()
.如果真结束


.子程序 _科目组合框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (行标签 [当前行] [当前列], 标题, .内容)
赋值 (行标签 [当前行] [当前列], 背景颜色, #银白)
赋值 (列标签 [当前行] [当前列], 背景颜色, #银白)
赋值 (列标签 [当前行] [当前列], 线宽, 2)
.如果真 (等于 (修改资料, 真))
    _启动窗口.执行 (., 相加 (“update 班级表 set 星期”, 到文本 (当前行), 到文本 (当前列), “='”, 行标签 [当前行] [当前列], 标题, “' where 所在班级='”, .内容, “'”), )
    相加 (当前列, 2).置文本 (相加 (当前行, 2), 行标签 [当前行] [当前列], 标题)
.如果真结束
赋值 (.可视, 假)
获取焦点 ()

.子程序 _科目组合框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    赋值 (行标签 [当前行] [当前列], 标题, .内容)
    赋值 (行标签 [当前行] [当前列], 背景颜色, #银白)
    赋值 (列标签 [当前行] [当前列], 背景颜色, #银白)
    赋值 (列标签 [当前行] [当前列], 线宽, 2)
    .如果真 (等于 (修改资料, 真))
        _启动窗口.执行 (., 相加 (“update 班级表 set 星期”, 到文本 (当前行), 到文本 (当前列), “='”, 行标签 [当前行] [当前列], 标题, “' where 所在班级='”, .内容, “'”), )
        相加 (当前列, 2).置文本 (相加 (当前行, 2), 行标签 [当前行] [当前列], 标题)
    .如果真结束
    赋值 (.可视, 假)
    获取焦点 ()
.如果真结束


.子程序 _科目组合框_列表项被选择, 空白型, , 
赋值 (修改资料, 真)

.子程序 _科目组合框_编辑内容被改变, 空白型, , 
赋值 (修改资料, 真)

.子程序 _课程表格_获得焦点, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

获取焦点 ()

.子程序 _课程表班级组合框_列表被关闭, 空白型, , 
获取焦点 ()

.子程序 _初始标签_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 横, 整数型, , , 
.局部变量 纵, 整数型, , , 
.局部变量 被点击标签, 标签, , , 
.局部变量 已跳出, 逻辑型, , , 

赋值 (被点击标签, 取事件组件 ())
赋值 (已跳出, 假)
.如果真 (等于 (.可视, 假))
    .变量循环首 (1, 5, 1, 横)
        .变量循环首 (1, 8, 1, 纵)
            .如果真 (等于 (行标签 [横] [纵], 被点击标签))
                赋值 (当前行, 横)
                赋值 (当前列, 纵)
                赋值 (已跳出, 真)
                跳出循环 ()
            .如果真结束
            
        .变量循环尾 ()
        .如果真 (已跳出)
            跳出循环 ()
        .如果真结束
        
    .变量循环尾 ()
    相加 (列标签 [当前行] [当前列], 左边, 2).移动 (相加 (列标签 [当前行] [当前列], 顶边, 2), , )
    赋值 (.内容, 行标签 [当前行] [当前列], 标题)
    赋值 (.可视, 真)
    #顶层.调整层次 ()
    获取焦点 ()
    
.如果真结束


.子程序 _初始标签_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 横, 整数型, , , 
.局部变量 纵, 整数型, , , 
.局部变量 被点击标签, 标签, , , 
.局部变量 已跳出, 逻辑型, , , 

.如果真 (等于 (.可视, 假))
    赋值 (行标签 [当前行] [当前列], 背景颜色, #白色)
    赋值 (列标签 [当前行] [当前列], 背景颜色, #白色)
    赋值 (列标签 [当前行] [当前列], 线宽, 1)
    赋值 (被点击标签, 取事件组件 ())
    赋值 (已跳出, 假)
    .如果真 (等于 (.可视, 假))
        .变量循环首 (1, 5, 1, 横)
            .变量循环首 (1, 8, 1, 纵)
                .如果真 (等于 (行标签 [横] [纵], 被点击标签))
                    赋值 (当前行, 横)
                    赋值 (当前列, 纵)
                    赋值 (已跳出, 真)
                    跳出循环 ()
                .如果真结束
                
            .变量循环尾 ()
            .如果真 (已跳出)
                跳出循环 ()
            .如果真结束
            
        .变量循环尾 ()
    .如果真结束
    
    赋值 (行标签 [当前行] [当前列], 背景颜色, #银白)
    赋值 (列标签 [当前行] [当前列], 背景颜色, #银白)
    赋值 (列标签 [当前行] [当前列], 线宽, 2)
    
.如果真结束


.子程序 _编辑框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

位置移动 (键代码)

.子程序 位置移动, 空白型, , 
.参数 键代码, 整数型, , 

.如果真 (等于 (.可视, 真))
    获取焦点 ()
    返回 ()
.如果真结束

.判断开始 (等于 (键代码, #回车键))
    .如果真 (等于 (.可视, 假))
        相加 (列标签 [当前行] [当前列], 左边, 2).移动 (相加 (列标签 [当前行] [当前列], 顶边, 2), , )
        赋值 (.内容, 行标签 [当前行] [当前列], 标题)
        赋值 (.可视, 真)
        #顶层.调整层次 ()
        获取焦点 ()
    .如果真结束
    
.判断 (并且 (等于 (键代码, #上光标键), 不等于 (当前列, 1)))
    赋值 (行标签 [当前行] [当前列], 背景颜色, #白色)
    赋值 (列标签 [当前行] [当前列], 背景颜色, #白色)
    赋值 (列标签 [当前行] [当前列], 线宽, 1)
    赋值 (当前列, 相减 (当前列, 1))
    赋值 (行标签 [当前行] [当前列], 背景颜色, #银白)
    赋值 (列标签 [当前行] [当前列], 背景颜色, #银白)
    赋值 (列标签 [当前行] [当前列], 线宽, 2)
.判断 (并且 (等于 (键代码, #下光标键), 不等于 (当前列, 7)))
    赋值 (行标签 [当前行] [当前列], 背景颜色, #白色)
    赋值 (列标签 [当前行] [当前列], 背景颜色, #白色)
    赋值 (列标签 [当前行] [当前列], 线宽, 1)
    赋值 (当前列, 相加 (当前列, 1))
    赋值 (行标签 [当前行] [当前列], 背景颜色, #银白)
    赋值 (行标签 [当前行] [当前列], 背景颜色, #银白)
    赋值 (列标签 [当前行] [当前列], 背景颜色, #银白)
    赋值 (列标签 [当前行] [当前列], 线宽, 2)
.判断 (并且 (等于 (键代码, #左光标键), 不等于 (当前行, 1)))
    赋值 (行标签 [当前行] [当前列], 背景颜色, #白色)
    赋值 (列标签 [当前行] [当前列], 背景颜色, #白色)
    赋值 (列标签 [当前行] [当前列], 线宽, 1)
    赋值 (当前行, 相减 (当前行, 1))
    赋值 (行标签 [当前行] [当前列], 背景颜色, #银白)
    赋值 (列标签 [当前行] [当前列], 背景颜色, #银白)
    赋值 (列标签 [当前行] [当前列], 线宽, 2)
.判断 (并且 (等于 (键代码, #右光标键), 不等于 (当前行, 5)))
    赋值 (行标签 [当前行] [当前列], 背景颜色, #白色)
    赋值 (列标签 [当前行] [当前列], 背景颜色, #白色)
    赋值 (列标签 [当前行] [当前列], 线宽, 1)
    赋值 (当前行, 相加 (当前行, 1))
    赋值 (行标签 [当前行] [当前列], 背景颜色, #银白)
    赋值 (列标签 [当前行] [当前列], 背景颜色, #银白)
    赋值 (列标签 [当前行] [当前列], 线宽, 2)
    
.默认
    
.判断结束


.子程序 _打印预览钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

位置移动 (键代码)

.子程序 _打印钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

位置移动 (键代码)

.子程序 _退出钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

位置移动 (键代码)

.子程序 _课程表窗口_可否被关闭, 逻辑型, , 
.如果真 (等于 (.可视, 真))
    信息框 (“请先退出编辑状态！”, 0, “提示”)
    获取焦点 ()
    返回 (假)
.如果真结束


.窗口程序集 关于注册程序集, , , 

.程序集变量 硬件代码, 文本型, , , 
.子程序 _关于注册窗口_创建完毕, 空白型, , 
赋值 (关于注册窗口., 相减 (相加 (关于注册窗口., 225), 关于注册窗口.取用户区高度 ()))
.判断开始 (等于 (选择子夹, 0))
    赋值 (.现行子夹, 0)
    赋值 (关于注册窗口., “关于”)
.判断 (等于 (选择子夹, 1))
    赋值 (.内容, 相加 (“ ”, #换行符, “                    用户使用许可协议书 ”, #换行符, “”, #换行符, “      请认真阅读本《注册用户许可协议》(以下简称《协议》)是您(个人或单一机构团体)与本软件作者丁坤(以下简称作者)之间有关本软件产品的法律协议。本软件产品仅包括此计算机软件。一旦您安装使用本软件，即表示您同意接受《协议》中的任何许可条款的约束。如果您不同意接受《协议》中的许可条款，则您不能使用本软件。”, #换行符, #换行符, “    一、软件产品使用许可：本软件受著作权法及国际版权条约和其它知识产权法及条约的保护。注册后本软件仅被授权在所注册的单一计算机上所使用。不得反向工程、反汇编、反编译、修改本软件和本软件的任何部分，不得将将所获得的注册钥匙文件提供给破解者用作破解本软件。本机序列号： ”, .标题, #换行符, #换行符, “    二、注册用户权利：”, #换行符, #换行符, “    1。终升免费升级和获取技术支持的权利。用户在注册后将享受终身免费升级的权利。今后如果出现软件升级后无法注册的情况，请立即将您的新硬件代码以及简要情况说明（例如您当初的登记名称及汇款号码等）告诉我们，我们会在第一时间内查明您的身份并且为您提供新的注册认证文件。在使用过程中出现任何问题可以通过电子邮件获取我们的技术支持。 ”, #换行符, #换行符, “    2.注册用户有权享有本软件范围内的全部功能，注册后能够使用学生毕业升级和资料的打印等功能。  ”, #换行符, #换行符, “    三、赔偿限制：在适用法律所允许的最大范围内，作者及其供应商在任何情况下绝不就因使用或不能使用本软件产品或就未提供支持服务所发生的任何特殊、意外、非直接或间接的损害负赔偿责任，即使作者事先被告知该损害发生的可能性，也无济于事。不论任何情况，作者依本《协议》任何条款所负的全部责任限于您就注册本软件产品所实际已付的价款。  ”))
    赋值 (关于注册窗口., “注册”)
    赋值 (.现行子夹, 1)
.判断 (等于 (选择子夹, 3))
    赋值 (关于注册窗口., “注册成功”)
    赋值 (.现行子夹, 3)
.默认
    
.判断结束


.子程序 _下一步_被单击, 空白型, , 
硬件代码 ＝ 威灵_取硬盘特征字 ()
赋值 (.内容, 硬件代码)
赋值 (.现行子夹, 2)

.子程序 _浏览_被单击, 空白型, , 
.如果真 (打开 ())
    赋值 (.内容, .文件名)
.如果真结束
赋值 (.起始选择位置, 取文本长度 (.内容))
获取焦点 ()

.子程序 _按钮3_被单击, 空白型, , 
赋值 (.现行子夹, 1)

.子程序 _注册_被单击, 空白型, , 
.如果 (不等于 (.内容, “”))
    复制文件 (.内容, 相加 (取运行目录 (), “\”, 到文本 (硬件代码), “.key”))
    信息框 (“注册钥匙文件已导入系统，请重新启动本系统！”, 0, )
    销毁 ()
    结束 ()
.否则
    信息框 (“ 请按导入按钮导入注册钥匙文件！  ”, #错误图标, “错误”)
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _按钮4_被单击, 空白型, , 
销毁 ()

.子程序 _钥匙文件_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    _注册_被单击 ()
.如果真结束


.子程序 _图片框5_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.子程序 _图片框2_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.子程序 _透明标签1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.子程序 _透明标签2_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.子程序 _超级链接框4_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_使用手册_被选择 ()

.程序集 通用程序集, , , 

.子程序 填充班级名称, 逻辑型, , 
.参数 通用班名组合框, 组合框, , 

.局部变量 循环数, 空白型, , , 

赋值 (记录, _启动窗口.查询 (., “select 所在班级,班主任 from 班级表”))
_启动窗口.到首记录 (., 记录)
.如果 (不等于 (记录, 0))
    通用班名组合框.清空 ()
    .判断循环首 (等于 (_启动窗口.尾记录后 (., 记录), 假))
        通用班名组合框.加入项目 (_启动窗口.读 (., 记录, “所在班级”), )
        _启动窗口.加入项目 (., _启动窗口.读 (., 记录, “班主任”), )
        _启动窗口.到后一记录 (., 记录)
    .判断循环尾 ()
    赋值 (通用班名组合框.现行选中项, 0)
    赋值 (_启动窗口..现行选中项, 0)
    .如果 (大于 (通用班名组合框.取项目数 (), 0))
        返回 (真)
    .否则
        返回 (假)
    .如果结束
    
.否则
    返回 (假)
.如果结束


.子程序 超级列表框排序, 整数型, 公开, 返回排序时间
.参数 对象, 超级列表框, , 
.参数 列索引, 整数型, , 
.参数 类型, 整数型, 可空, 0数值型;1文本型;2日期时间型;3逻辑型;其它默认文本型
.参数 区分大小写, 逻辑型, 可空, 真 区分大小写;假 不区分大小写
.参数 排序方式, 逻辑型, 可空, 真 正序(从小到大);假 倒序(从大到小)

.局部变量 排序时间, 整数型, , , 
.局部变量 排序变量, 文本型, , "0", 
.局部变量 序号数组, 整数型, , "0", 
.局部变量 变量, 整数型, , , 
.局部变量 数据, 文本型, , , 
.局部变量 列数, 整数型, , , 
.局部变量 行数, 整数型, , , 
.局部变量 单元数, 整数型, , , 

赋值 (排序时间, 取启动时间 ())
赋值 (类型, 选择 (并且 (大于或等于 (类型, 0), 小于或等于 (类型, 3)), 类型, 1))
赋值 (区分大小写, 选择 (是否为空 (区分大小写), 真, 区分大小写))
赋值 (排序方式, 选择 (是否为空 (排序方式), 真, 排序方式))
.计次循环首 (对象.取表项数 (), 变量)
    赋值 (数据, 对象.取标题 (相减 (变量, 1), 列索引))
    .如果 (不等于 (类型, 3))
        赋值 (单元数, 二分查找 (排序变量, 数据, 类型, 区分大小写))
        插入成员 (排序变量, 单元数, 数据)
        插入成员 (序号数组, 单元数, 相减 (变量, 1))
    .否则
        插入成员 (序号数组, 选择 (等于 (数据, “假”), 变量, 1), 相减 (变量, 1))
    .如果结束
    
.计次循环尾 ()
赋值 (列数, 对象.取列数 ())
赋值 (行数, 取数组成员数 (序号数组))
赋值 (单元数, 相乘 (行数, 列数))
重定义数组 (排序变量, 假, 单元数)
.计次循环首 (单元数, 变量)
    赋值 (排序变量 [变量], 对象.取标题 (序号数组 [取绝对值 (相减 (选择 (排序方式, -1, 行数), 整除 (相减 (变量, 1), 列数)))], 求余数 (相减 (变量, 1), 列数)))
.计次循环尾 ()
.计次循环首 (单元数, 变量)
    对象.置标题 (整除 (相减 (变量, 1), 列数), 求余数 (相减 (变量, 1), 列数), 排序变量 [变量])
.计次循环尾 ()
返回 (相减 (取启动时间 (), 排序时间))

.子程序 二分查找, 整数型, , 
.参数 数组, 文本型, 数组, 
.参数 待查, 文本型, , 
.参数 类型, 整数型, , 
.参数 区分大小写, 逻辑型, , 

.局部变量 位置, 整数型, , , 
.局部变量 数组总数, 整数型, , , 
.局部变量 对分, 整数型, , , 
.局部变量 数值A, 双精度小数型, , , 
.局部变量 数值B, 双精度小数型, , , 
.局部变量 文本, 文本型, , , 

赋值 (位置, 1)
赋值 (数组总数, 取数组成员数 (数组))
.如果真 (等于 (数组总数, 0))
    返回 (1)
.如果真结束
.判断开始 (等于 (类型, 0))
    赋值 (数值A, 到数值 (待查))
    .如果真 (大于或等于 (数值A, 到数值 (数组 [数组总数])))
        返回 (相加 (数组总数, 1))
    .如果真结束
    .如果真 (小于或等于 (数值A, 到数值 (数组 [1])))
        返回 (1)
    .如果真结束
    
    .判断循环首 (小于 (位置, 相减 (数组总数, 1)))
        赋值 (对分, 整除 (相加 (位置, 数组总数), 2))
        赋值 (数值B, 到数值 (数组 [对分]))
        .如果真 (等于 (数值A, 数值B))
            赋值 (位置, 对分)
            跳出循环 ()
        .如果真结束
        
        .如果 (小于 (数值A, 数值B))
            赋值 (数组总数, 对分)
        .否则
            赋值 (位置, 对分)
        .如果结束
        
    .判断循环尾 ()
.判断 (等于 (类型, 1))
    .如果真 (大于或等于 (文本比较 (待查, 数组 [数组总数], 区分大小写), 0))
        返回 (相加 (数组总数, 1))
    .如果真结束
    .如果真 (小于或等于 (文本比较 (待查, 数组 [1], 区分大小写), 0))
        返回 (1)
    .如果真结束
    .判断循环首 (小于 (位置, 相减 (数组总数, 1)))
        赋值 (对分, 整除 (相加 (位置, 数组总数), 2))
        .如果真 (等于 (文本比较 (待查, 数组 [对分], 区分大小写), 0))
            赋值 (位置, 对分)
            跳出循环 ()
        .如果真结束
        .如果 (小于 (文本比较 (待查, 数组 [对分], 区分大小写), 0))
            赋值 (数组总数, 对分)
        .否则
            赋值 (位置, 对分)
        .如果结束
        
    .判断循环尾 ()
    
.判断 (等于 (类型, 2))
    赋值 (数值A, 取字节集数据 (到字节集 (到时间 (待查)), #双精度小数型))
    .如果真 (大于或等于 (数值A, 取字节集数据 (到字节集 (到时间 (数组 [数组总数])), #双精度小数型)))
        返回 (相加 (数组总数, 1))
    .如果真结束
    .如果真 (小于或等于 (数值A, 取字节集数据 (到字节集 (到时间 (数组 [1])), #双精度小数型)))
        返回 (1)
    .如果真结束
    .判断循环首 (小于 (位置, 相减 (数组总数, 1)))
        赋值 (对分, 整除 (相加 (位置, 数组总数), 2))
        赋值 (数值B, 取字节集数据 (到字节集 (到时间 (数组 [对分])), #双精度小数型))
        .如果真 (等于 (数值A, 数值B))
            赋值 (位置, 对分)
            跳出循环 ()
        .如果真结束
        .如果 (小于 (数值A, 数值B))
            赋值 (数组总数, 对分)
        .否则
            赋值 (位置, 对分)
        .如果结束
        
    .判断循环尾 ()
.默认
    
.判断结束
返回 (相加 (位置, 1))

.窗口程序集 评语程序集, , , 

.程序集变量 评语类别, 整数型, , , 
.程序集变量 分类文本, 文本型, , , 
.子程序 _评语录入窗口_创建完毕, 空白型, , 
赋值 (评语录入窗口., 相减 (相加 (评语录入窗口., 575), 评语录入窗口.取用户区高度 ()))
赋值 (.现行选中项, 0)
.如果 (填充班级名称 ())
    填充评语姓名 ()
    赋值 (., 0)
    填充评语 ()
    赋值 (.现行选中项, 0)
    赋值 (评语类别, 1)
    填充评语数据库 ()
    赋值 (.背景颜色, 取颜色值 (200, 255, 200))
    连续赋值 (#默认色, .背景颜色, .背景颜色)
    赋值 (.现行选中项, 0)
    填充范例 (“优等生评语范例”)
.否则
    信息框 (“目前没有班级数据，请先进行校务设置！”, 0, “提示”)
    销毁 ()
    _校务设置_被选择 ()
.如果结束


.子程序 填充评语姓名, 空白型, , 
.局部变量 表项, 整数型, , , 

置等待鼠标 ()
全部删除 ()
赋值 (记录, _启动窗口.查询 (., 相加 (“select 学号,姓名 from 学籍表 where 所在班级='”, .内容, “' order by 姓名”)))
_启动窗口.到首记录 (., 记录)
.判断循环首 (等于 (_启动窗口.尾记录后 (., 记录), 假))
    赋值 (表项, .插入表项 (到文本 (_启动窗口.读 (., 记录, “学号”)), , , , ))
    表项.置标题 (1, _启动窗口.读 (., 记录, “姓名”))
    _启动窗口.到后一记录 (., 记录)
.判断循环尾 ()
_启动窗口.关闭记录集 (., 记录)
恢复鼠标 ()

.子程序 填充评语, 空白型, , 
.局部变量 综合评语, 文本型, , , 
.局部变量 本学期评语, 文本型, , , 

.如果 (大于 (取表项数 (), 0))
    赋值 (.标题, 相加 (“您正在录入”, .内容, .取标题 (., 1), “同学的评语”))
.否则
    赋值 (.标题, 相加 (“目前”, .内容, “没有学生数据，请选择其它班级！”))
.如果结束
赋值 (记录, _启动窗口.查询 (., 相加 (“select 学号,综合评语,本学期评语 from 学籍表 where 学号=”, .取标题 (., 0))))
_启动窗口.到首记录 (., 记录)
赋值 (综合评语, 到文本 (_启动窗口.读 (., 记录, “综合评语”)))
赋值 (本学期评语, 到文本 (_启动窗口.读 (., 记录, “本学期评语”)))
_启动窗口.关闭记录集 (., 记录)
赋值 (.内容, 综合评语)
赋值 (.内容, 本学期评语)

.子程序 _评语班级名组合框_列表项被选择, 空白型, , 
获取焦点 ()
填充评语姓名 ()
.如果 (大于 (取表项数 (), 0))
    赋值 (., 0)
    填充评语 ()
.否则
    赋值 (.标题, 相加 (“目前”, .内容, “没有学生数据，请选择其它班级！”))
    信息框 (相加 (“  目前”, .内容, “没有学生数据，请选择其它班级！  ”), 0, “提示”)
.如果结束


.子程序 _选择词条库组合框_列表项被选择, 空白型, , 
获取焦点 ()
赋值 (评语类别, 1)
填充评语数据库 ()

.子程序 _评语姓名列表框_当前表项被改变, 空白型, , 
填充评语 ()
获取焦点 ()
赋值 (.起始选择位置, 取文本长度 (.内容))

.子程序 _评语词条列表框_表项被激活, 空白型, , 
.如果真 (或者 (等于 (取表项数 (), 0), 等于 (., -1)))
    信息框 (“请选择要录入评语的学生姓名！”, 0, “提示”)
    返回 ()
.如果真结束

获取焦点 ()
赋值 (.起始选择位置, 取文本长度 (.内容))
.如果 (等于 (.内容, “”))
    相加 (“    ”, .取标题 (., 0)).加入文本 ()
.否则
    .取标题 (., 0).加入文本 ()
.如果结束

超范围检查 ()
.如果真 (等于 (.标题, “自动转分类”))
    赋值 (评语类别, 相加 (评语类别, 1))
    .如果真 (大于 (评语类别, 7))
        赋值 (评语类别, 1)
    .如果真结束
    填充评语数据库 ()
.如果真结束


.子程序 _本学期评语编辑框_内容被改变, 空白型, , 
超范围检查 ()

.子程序 超范围检查, 空白型, , 
.如果真 (大于 (186.发送信息 (0, 0), 14))
    .判断循环首 (大于 (186.发送信息 (0, 0), 14))
        赋值 (.内容, 取文本左边 (.内容, 相减 (取文本长度 (.内容), 2)))
    .判断循环尾 ()
    信息框 (“本学期评语最多输入14行内容！”, 0, )
    获取焦点 ()
    赋值 (.起始选择位置, 取文本长度 (.内容))
.如果真结束


.子程序 _评语词条列表框_右键单击表项, 空白型, , 
弹出菜单 ()

.子程序 _修改评语词条_被选择, 空白型, , 
.如果 (不等于 (., -1))
    .进入编辑 (.)
.否则
    信息框 (“    请选择要编辑修改的评语词条！    ”, 0, “提示”)
.如果结束


.子程序 _添加评语词条_被选择, 空白型, , 
.如果 (_启动窗口.执行 (., 相加 (“insert into 评语表  (库别,类别,内容,范例) values ('”, .内容, “','”, 分类文本, “','------新评语词条的内容(最多100个字符或50个汉字)------',?)”), 到字节集 (“”)))
    赋值 (记录, _启动窗口.查询 (., 相加 (“select * from 评语表 where and 库别='”, .内容, “' and 类别='”, 分类文本, “' and 内容='------新评语词条的内容(最多100个字符或50个汉字)------'”)))
    _启动窗口.到首记录 (., 记录)
    赋值 (., .插入表项 (_启动窗口.读 (., 记录, “内容”), , , , ))
    .置标题 (., 1, 到文本 (_启动窗口.读 (., 记录, “编号”)))
    _启动窗口.关闭记录集 (., 记录)
    .保证显示 (.)
    .进入编辑 (.)
.否则
    信息框 (“添加新的评语词条失败！”, #错误图标, “错误”)
.如果结束


.子程序 _删除评语词条_被选择, 空白型, , 
.如果真 (等于 (., -1))
    信息框 (“    请选择要删除的评语词条！    ”, 0, “提示”)
    返回 ()
.如果真结束

.如果真 (等于 (信息框 (“您确定要删除当前选择的评语词条吗？    ”, 相加 (#确认取消钮, #询问图标), “询问”), #确认钮))
    .如果 (_启动窗口.执行 (., 相加 (“delete * from 评语表 where 编号=”, .取标题 (., 1)), ))
        .删除表项 (.)
        赋值 (., 0)
    .否则
        信息框 (“操作失败！”, #错误图标, “错误”)
    .如果结束
    
.如果真结束


.子程序 _评语词条列表框_开始编辑, 逻辑型, , 
.参数 表项索引, 整数型, , 

.局部变量 文本, 文本型, , , 

赋值 (文本, 表项索引.取标题 (0))
.如果真 (大于 (取文本长度 (文本), 100))
    表项索引.置标题 (0, 取文本左边 (文本, 100))
.如果真结束


.子程序 _评语词条列表框_结束编辑, 逻辑型, , 
.参数 表项索引, 整数型, , 

.局部变量 编辑文本, 文本型, , , 

赋值 (编辑文本, .)
.如果 (或者 (大于 (取文本长度 (编辑文本), 100), 等于 (编辑文本, “”)))
    信息框 (“每条评语的内容不超过100个字符或50个汉字且不能为空！”, 0, )
    表项索引.进入编辑 ()
.否则
    _启动窗口.执行 (., 相加 (“update 评语表 set 内容='”, 编辑文本, “' where 编号=”, 表项索引.取标题 (1)), )
.如果结束


.子程序 _标题1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (评语类别, 1)
填充评语数据库 ()

.子程序 _标题2_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (评语类别, 2)
填充评语数据库 ()

.子程序 _标题3_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (评语类别, 3)
填充评语数据库 ()

.子程序 _标题4_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (评语类别, 4)
填充评语数据库 ()

.子程序 _标题5_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (评语类别, 5)
填充评语数据库 ()

.子程序 _标题6_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (评语类别, 6)
填充评语数据库 ()

.子程序 _标题7_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (评语类别, 7)
填充评语数据库 ()

.子程序 _标题8_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 填充评语数据库, 空白型, , 
.局部变量 表项, 整数型, , , 

.判断开始 (等于 (评语类别, 1))
    赋值 (.背景颜色, 取颜色值 (200, 255, 200))
    连续赋值 (#默认色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    赋值 (分类文本, “分类1”)
.判断 (等于 (评语类别, 2))
    赋值 (.背景颜色, 取颜色值 (200, 255, 200))
    连续赋值 (#默认色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    赋值 (分类文本, “分类2”)
.判断 (等于 (评语类别, 3))
    赋值 (.背景颜色, 取颜色值 (200, 255, 200))
    连续赋值 (#默认色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    赋值 (分类文本, “分类3”)
.判断 (等于 (评语类别, 4))
    赋值 (.背景颜色, 取颜色值 (200, 255, 200))
    连续赋值 (#默认色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    赋值 (分类文本, “分类4”)
.判断 (等于 (评语类别, 5))
    赋值 (.背景颜色, 取颜色值 (200, 255, 200))
    连续赋值 (#默认色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    赋值 (分类文本, “分类5”)
.判断 (等于 (评语类别, 6))
    赋值 (.背景颜色, 取颜色值 (200, 255, 200))
    连续赋值 (#默认色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    赋值 (分类文本, “分类6”)
.判断 (等于 (评语类别, 7))
    赋值 (.背景颜色, 取颜色值 (200, 255, 200))
    连续赋值 (#默认色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    赋值 (分类文本, “分类7”)
.默认
    
.判断结束
全部删除 ()
赋值 (记录, _启动窗口.查询 (., 相加 (“select * from 评语表 where 库别='”, .内容, “' and 类别='”, 分类文本, “'”)))
_启动窗口.到首记录 (., 记录)
.判断循环首 (等于 (_启动窗口.尾记录后 (., 记录), 假))
    赋值 (表项, .插入表项 (到文本 (_启动窗口.读 (., 记录, “内容”)), , , , ))
    表项.置标题 (1, 到文本 (_启动窗口.读 (., 记录, 1)))
    _启动窗口.到后一记录 (., 记录)
    处理事件 ()
.判断循环尾 ()
_启动窗口.关闭记录集 (., 记录)
赋值 (., 0)

.子程序 _保存评语按钮_被单击, 空白型, , 
.如果真 (或者 (等于 (取表项数 (), 0), 等于 (., -1)))
    信息框 (“请选择要录入评语的学生姓名！”, 0, “提示”)
    返回 ()
.如果真结束

.如果真 (_启动窗口.执行 (., 相加 (“update 学籍表 set 本学期评语=?,综合评语=? where 学号=”, .取标题 (., 0)), 到字节集 (.内容), 到字节集 (.内容)))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        信息框 (相加 (.取标题 (., 1), “同学的评语已保存！即将录入的是”, 相加 (., 1).取标题 (1), “同学的评语。”), 0, )
        赋值 (., 相加 (., 1))
    .否则
        信息框 (相加 (.取标题 (., 1), “同学的评语已保存！”), 0, )
    .如果结束
    
.如果真结束


.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _综合评价钮_被单击, 空白型, , 
.如果 (不等于 (.内容, “”))
    赋值 (.内容, 相加 (.内容, #换行符, #换行符, 时间到文本 (取现行时间 (), 2), “录入的评语：”, #换行符, #换行符, .内容))
.否则
    赋值 (.内容, 相加 (时间到文本 (取现行时间 (), 2), “录入的评语：”, #换行符, #换行符, .内容))
.如果结束
赋值 (.起始选择位置, 取文本长度 (.内容))


.子程序 _随机录入按钮_被单击, 空白型, , 
.局部变量 待选, 文本型, , "0", 
.局部变量 计次, 整数型, , , 
.局部变量 随机数, 整数型, , , 

置等待鼠标 ()
置随机数种子 ()
赋值 (.内容, “”)
.计次循环首 (7, 计次)
    清除数组 (待选)
    赋值 (记录, _启动窗口.查询 (., 相加 (“select * from 评语表 where 库别='”, .内容, “' and 类别='分类”, 到文本 (计次), “'”)))
    _启动窗口.到首记录 (., 记录)
    .判断循环首 (等于 (_启动窗口.尾记录后 (., 记录), 假))
        加入成员 (待选, 到文本 (_启动窗口.读 (., 记录, “内容”)))
        _启动窗口.到后一记录 (., 记录)
    .判断循环尾 ()
    _启动窗口.关闭记录集 (., 记录)
    .如果真 (大于 (取数组成员数 (待选), 0))
        赋值 (随机数, 取随机数 (1, 取数组成员数 (待选)))
        .如果 (等于 (.内容, “”))
            赋值 (.内容, 相加 (“    ”, 待选 [随机数]))
        .否则
            待选.加入文本 ( [随机数])
        .如果结束
        
    .如果真结束
    
.计次循环尾 ()
恢复鼠标 ()

.子程序 _清空按钮_被单击, 空白型, , 
赋值 (.内容, “”)

.子程序 _分类操作转换钮_被单击, 空白型, , 
.如果 (等于 (.标题, “自动转分类”))
    赋值 (.标题, “手动选分类”)
.否则
    赋值 (.标题, “自动转分类”)
.如果结束


.子程序 _词条范例转换钮_被单击, 空白型, , 
.如果 (等于 (.标题, “到范例评语录入”))
    赋值 (.禁止, 真)
    赋值 (.标题, “到单句评语录入”)
    赋值 (.现行子夹, 1)
.否则
    赋值 (.禁止, 假)
    赋值 (.标题, “到范例评语录入”)
    赋值 (.现行子夹, 0)
.如果结束


.子程序 _优等生评语范例钮_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.背景颜色, 取颜色值 (200, 255, 200))
连续赋值 (#默认色, .背景颜色, .背景颜色)
填充范例 (“优等生评语范例”)

.子程序 _中等生评语范例钮_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.背景颜色, 取颜色值 (200, 255, 200))
连续赋值 (#默认色, .背景颜色, .背景颜色)
填充范例 (“中等生评语范例”)

.子程序 _后进生评语范例钮_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.背景颜色, 取颜色值 (200, 255, 200))
连续赋值 (#默认色, .背景颜色, .背景颜色)
填充范例 (“后进生评语范例”)

.子程序 _选择范例库组合框_列表项被选择, 空白型, , 
获取焦点 ()
赋值 (.背景颜色, 取颜色值 (200, 255, 200))
连续赋值 (#默认色, .背景颜色, .背景颜色)
填充范例 (“优等生评语范例”)

.子程序 填充范例, 空白型, , 
.参数 范例分类, 文本型, , 

.局部变量 编号, 整数型, , , 

全部删除 ()
赋值 (记录, _启动窗口.查询 (., 相加 (“select * from 评语表 where 库别='”, .内容, “' and 类别='”, 范例分类, “'”)))
_启动窗口.到首记录 (., 记录)
.判断循环首 (等于 (_启动窗口.尾记录后 (., 记录), 假))
    赋值 (编号, 到数值 (_启动窗口.读 (., 记录, “编号”)))
    .插入表项 (取文本左边 (到文本 (_启动窗口.读 (., 记录, “范例”)), 70), , , , 编号)
    _启动窗口.到后一记录 (., 记录)
    处理事件 ()
.判断循环尾 ()
_启动窗口.关闭记录集 (., 记录)
赋值 (., 0)

.子程序 _范例评语列表框_表项被激活, 空白型, , 
赋值 (.内容, .内容)

.子程序 _范例评语列表框_当前表项被改变, 空白型, , 
赋值 (记录, _启动窗口.查询 (., 相加 (“select * from 评语表 where 编号=”, 到文本 (.取表项数值 (.)))))
_启动窗口.到首记录 (., 记录)
赋值 (.内容, 相加 (“    ”, 到文本 (_启动窗口.读 (., 记录, “范例”))))
_启动窗口.关闭记录集 (., 记录)


.子程序 _范例评语列表框_右键单击表项, 空白型, , 
弹出菜单 ()

.子程序 _修改范例评语_被选择, 空白型, , 
.如果真 (等于 (., -1))
    信息框 (“请选择要修改的范例评语！”, 0, )
    返回 ()
.如果真结束
赋值 (修改资料, 真)
载入 (修改范例窗口, 评语录入窗口, 真)

.子程序 _添加范例评语_被选择, 空白型, , 
赋值 (修改资料, 假)
载入 (修改范例窗口, 评语录入窗口, 真)

.子程序 _删除范例评语_被选择, 空白型, , 
.局部变量 表项, 整数型, , , 

.如果真 (等于 (., -1))
    信息框 (“    请选择要删除的评语范例！    ”, 0, “提示”)
    返回 ()
.如果真结束

.如果真 (等于 (信息框 (“您确定要删除当前选择的评语范例吗？    ”, 相加 (#确认取消钮, #询问图标), “询问”), #确认钮))
    .如果 (_启动窗口.执行 (., 相加 (“delete * from 评语表 where 编号=”, 到文本 (.取表项数值 (.)), “ and 库别='”, .内容, “'”), ))
        赋值 (表项, .)
        表项.删除表项 ()
        .如果真 (大于 (取表项数 (), 0))
            赋值 (., 相减 (表项, 1))
            .保证显示 (.)
            _范例评语列表框_当前表项被改变 ()
        .如果真结束
        
    .否则
        信息框 (“操作失败！”, #错误图标, “错误”)
    .如果结束
    
.如果真结束


.子程序 _范例评语列表框_表项跟踪, 空白型, , 
.参数 表项索引, 整数型, , 

获取焦点 ()

.子程序 _评语录入窗口_被取消激活, 空白型, , 
获取焦点 ()

.子程序 _方案组合框_列表项被选择, 空白型, , 
.判断开始 (等于 (.现行选中项, 0))
    连续赋值 (#白色, ., ., ., ., ., ., .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    连续赋值 (#黑色, ., ., ., .文本颜色, .文本颜色, .文本颜色)
.判断 (等于 (.现行选中项, 1))
    连续赋值 (#白色, ., ., ., ., ., ., .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    连续赋值 (取颜色值 (128, 128, 0), ., ., ., .文本颜色, .文本颜色, .文本颜色)
.判断 (等于 (.现行选中项, 2))
    连续赋值 (#青蓝, ., ., ., ., ., ., .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    连续赋值 (#白色, ., ., ., .文本颜色, .文本颜色, .文本颜色)
.判断 (等于 (.现行选中项, 3))
    连续赋值 (取颜色值 (128, 128, 192), ., ., ., ., ., ., .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    连续赋值 (#黄色, ., ., ., .文本颜色, .文本颜色, .文本颜色)
.判断 (等于 (.现行选中项, 4))
    连续赋值 (取颜色值 (0, 52, 0), ., ., ., ., ., ., .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    连续赋值 (#白色, ., ., ., .文本颜色, .文本颜色, .文本颜色)
.判断 (等于 (.现行选中项, 5))
    连续赋值 (#黑色, ., ., ., ., ., ., .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    连续赋值 (#银白, ., ., ., .文本颜色, .文本颜色, .文本颜色)
.默认
    
.判断结束


.子程序 _字体组合框_列表项被选择, 空白型, , 
.判断开始 (等于 (.现行选中项, 0))
    连续赋值 (9, ..字体大小, ..字体大小, ..字体大小, .字体.字体大小, .字体.字体大小, .字体.字体大小)
.判断 (等于 (.现行选中项, 1))
    连续赋值 (10, ..字体大小, ..字体大小, ..字体大小, .字体.字体大小, .字体.字体大小, .字体.字体大小)
.判断 (等于 (.现行选中项, 2))
    连续赋值 (11, ..字体大小, ..字体大小, ..字体大小, .字体.字体大小, .字体.字体大小, .字体.字体大小)
.判断 (等于 (.现行选中项, 3))
    连续赋值 (12, ..字体大小, ..字体大小, ..字体大小, .字体.字体大小, .字体.字体大小, .字体.字体大小)
.默认
    
.判断结束


.窗口程序集 改升级名程序集, , , 

.子程序 _改升级名窗口_创建完毕, 空白型, , 
赋值 (改升级名窗口., 相减 (相加 (改升级名窗口., 100), 改升级名窗口.取用户区高度 ()))
赋值 (.标题, 自设毕业窗口.取标题 (., 自设毕业窗口.., 0))
赋值 (.内容, .标题)
获取焦点 ()
赋值 (.被选择字符数, -1)

.子程序 _确定按钮_被单击, 空白型, , 
.如果 (不等于 (删全部空 (.内容), 删全部空 (.标题)))
    .如果 (不等于 (删全部空 (.内容), “”))
        自设毕业窗口.置标题 (., 自设毕业窗口.., 1, 删全部空 (.内容))
        销毁 ()
    .否则
        信息框 (“请输入升级后的班级名称！”, 0, )
    .如果结束
    
.否则
    信息框 (“升级前和升级后的名称相同！如果该班不需要升级请按取消钮后重新选择班级。”, 0, )
.如果结束


.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()

.窗口程序集 管理员登录程序集, , , 

.程序集变量 登录, 整数型, , , 
.子程序 _管理员登录窗口_创建完毕, 空白型, , 
.局部变量 表项, 整数型, , , 
.局部变量 用户名, 文本型, , , 

赋值 (管理员登录窗口., 相减 (相加 (管理员登录窗口., 210), 管理员登录窗口.取用户区高度 ()))
.如果真 (等于 (_启动窗口.打开MDB数据库 (., 相加 (取运行目录 (), “\data\008.xsk”), , “2978263-dku”, , ), 假))
    写到文件 (相加 (取运行目录 (), “\data\008.xsk”), #管理员数据)
    _启动窗口.打开MDB数据库 (., 相加 (取运行目录 (), “\data\008.xsk”), , “2978263-dku”, , )
.如果真结束
赋值 (登录, 0)
赋值 (记录, _启动窗口.查询 (., “select * from 用户表 ”))
清空 ()
清空 ()
全部删除 ()
全部删除 ()
_启动窗口.到首记录 (., 记录)
.判断循环首 (等于 (_启动窗口.尾记录后 (., 记录), 假))
    赋值 (用户名, _启动窗口.读 (., 记录, “用户名”))
    用户名.加入项目 ()
    用户名.加入项目 ()
    赋值 (表项, .插入表项 (用户名, , , , ))
    表项.置标题 (1, _启动窗口.读 (., 记录, “密码”))
    表项.置标题 (2, _启动窗口.读 (., 记录, “权限”))
    .如果 (等于 (表项.取标题 (2), “1111”))
        .插入表项 (用户名, 1, , , )
    .否则
        .插入表项 (用户名, 0, , , )
    .如果结束
    _启动窗口.到后一记录 (., 记录)
.判断循环尾 ()
_启动窗口.关闭记录集 (., 记录)
.判断开始 (等于 (选择子夹, 0))
    赋值 (管理员登录窗口., “欢迎登录”)
    赋值 (管理员登录窗口., 0)
    赋值 (管理员登录窗口., 真)
    .如果真 (是否已创建 (欢迎窗口))
        欢迎窗口.销毁 ()
    .如果真结束
    
    .如果 (等于 (取项目数 (), 0))
        “内部管理员”.加入项目 ()
        赋值 (.现行选中项, 0)
        赋值 (.内容, 到文本 (66666))
        信息框 (“目前尚未建立系统管理员数据！现在将使用系统内置的管理员登录！”, 0, “提示”)
        获取焦点 ()
    .否则
        赋值 (.现行选中项, 0)
        获取焦点 ()
    .如果结束
    
    _启动窗口.取文本 (., 1).查找表项 (0, 真).选择表项 ()
    赋值 (., .)
    赋值 (.现行子夹, 0)
.判断 (等于 (选择子夹, 1))
    赋值 (管理员登录窗口., “修改管理员资料”)
    赋值 (.内容, _启动窗口.取文本 (., 1))
    _启动窗口.取文本 (., 1).查找表项 (0, 真).选择表项 ()
    赋值 (., .)
    赋值 (.现行子夹, 1)
.判断 (等于 (选择子夹, 3))
    赋值 (管理员登录窗口., “设置管理员资料”)
    赋值 (.现行子夹, 3)
.默认
    
.判断结束
赋值 (管理员登录窗口., 真)


.子程序 _管理员登录窗口_被激活, 空白型, , 
赋值 (.倾斜, 相加 (.倾斜, 1))
重画 ()
赋值 (.倾斜, 相减 (.倾斜, 1))

.子程序 _管理员登录窗口_可否被关闭, 逻辑型, , 
.如果真 (等于 (.现行子夹, 0))
    .如果 (等于 (信息框 (“您真的要退出系统吗？”, #是否钮, “询问”), #是钮))
        _启动窗口.关闭 (.)
        _启动窗口.关闭 (.)
        _启动窗口.关闭 (.)
        _启动窗口.销毁 ()
        结束 ()
    .否则
        返回 (假)
    .如果结束
    
.如果真结束


.子程序 _管理员登录窗口_将被销毁, 空白型, , 
_启动窗口.关闭 (.)
赋值 (重新登录系统, 假)

.子程序 _登录钮_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (“请输入管理员用户名！  ”, 0, “提示”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入管理员密码！  ”, 0, “提示”)
    获取焦点 ()
    返回 ()
.如果真结束

赋值 (., .查找表项 (.内容, , ))
.如果 (并且 (等于 (.内容, .取标题 (., 0)), 等于 (.内容, .取标题 (., 1))))
    _启动窗口.置文本 (., 1, .内容)
    赋值 (_启动窗口..标题, .取标题 (., 2))
    .如果 (不等于 (取文本右边 (_启动窗口..标题, 1), “1”))
        赋值 (_启动窗口..可视, 假)
        赋值 (_启动窗口..可视, 真)
    .否则
        赋值 (_启动窗口..可视, 真)
        赋值 (_启动窗口..可视, 假)
    .如果结束
    赋值 (_启动窗口., 真)
    销毁 ()
.否则
    .如果 (并且 (等于 (.内容, “内部管理员”), 等于 (.内容, “66666”)))
        _启动窗口.置文本 (., 1, .内容)
        赋值 (_启动窗口..标题, “1111”)
        赋值 (_启动窗口..可视, 真)
        赋值 (_启动窗口..可视, 假)
        赋值 (_启动窗口., 真)
        销毁 ()
    .否则
        错误 ()
    .如果结束
    
.如果结束


.子程序 _退出登陆钮_被单击, 空白型, , 
.如果真 (等于 (重新登录系统, 假))
    _启动窗口.关闭 (.)
    _启动窗口.关闭 (.)
    _启动窗口.关闭 (.)
    结束 ()
.如果真结束
销毁 ()

.子程序 错误, 空白型, , 
.如果 (等于 (登录, 2))
    信息框 (“抱歉！非本系统管理员无权使用本系统！”, #错误图标, “错误！”)
    _启动窗口.关闭 (.)
    _启动窗口.关闭 (.)
    _启动窗口.关闭 (.)
    结束 ()
.否则
    信息框 (“用户名或密码错误，请重新登录！  ”, #错误图标, “错误！”)
    赋值 (.内容, “”)
    获取焦点 ()
    赋值 (登录, 相加 (登录, 1))
.如果结束


.子程序 _修改确定钮_被单击, 空白型, , 
.如果真 (并且 (不等于 (.内容, _启动窗口.取文本 (., 1)), 不等于 (.查找表项 (.内容, 0, 真), -1)))
    信息框 (“输入的管理员用户名已经存在！请重新输入用户名！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (或者 (等于 (删全部空 (.内容), “”), 等于 (删全部空 (.内容), “”), 等于 (删全部空 (.内容), “”), 等于 (删全部空 (.内容), “”)))
    信息框 (“管理员的用户名或密码不能有空数据！”, 0, )
    返回 ()
.如果真结束

.如果 (等于 (.内容, .取标题 (., 1)))
    .如果 (等于 (.内容, .内容))
        .如果 (_启动窗口.执行 (., 相加 (“update 用户表 set 用户名='”, .内容, “',密码='”, .内容, “' where 用户名='”, _启动窗口.取文本 (., 1), “'”), ))
            _启动窗口.置文本 (., 1, .内容)
            .置标题 (., 0, .内容)
            .置标题 (., 0, .内容)
            .置标题 (., 1, .内容)
            信息框 (“   当前管理员数据被成功修改！  ”, 0, )
            销毁 ()
        .否则
            信息框 (“修改数据失败！”, 0, )
        .如果结束
        
    .否则
        信息框 (“输入的新密码与确认新密码不一致！”, 0, )
        获取焦点 ()
        赋值 (.被选择字符数, 取文本长度 (.内容))
    .如果结束
    
.否则
    信息框 (“您输入的管理员原密码有错误！”, #错误图标, “错误”)
    获取焦点 ()
    赋值 (.内容, “”)
.如果结束


.子程序 _修改取消按钮_被单击, 空白型, , 
销毁 ()

.子程序 _添加修改确定钮_被单击, 空白型, , 
.局部变量 权限代码, 文本型, , , 
.局部变量 表项, 整数型, , , 
.局部变量 超级数, 整数型, , , 
.局部变量 计次, 整数型, , , 


.如果真 (并且 (不等于 (.内容, .取标题 (., 0)), 不等于 (.查找表项 (.内容, 0, 真), -1)))
    信息框 (“输入的管理员用户名已经存在！请重新输入用户名！”, 0, )
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    返回 ()
.如果真结束
.如果真 (或者 (等于 (删全部空 (.内容), “”), 等于 (删全部空 (.内容), “”), 等于 (删全部空 (.内容), “”)))
    信息框 (“管理员的用户名或密码不能有空数据！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束

.如果 (等于 (.选中, 真))
    赋值 (权限代码, 相加 (权限代码, 到文本 (1)))
.否则
    赋值 (权限代码, 相加 (权限代码, 到文本 (0)))
.如果结束

.如果 (等于 (.选中, 真))
    赋值 (权限代码, 相加 (权限代码, 到文本 (1)))
.否则
    赋值 (权限代码, 相加 (权限代码, 到文本 (0)))
.如果结束

.如果 (等于 (.选中, 真))
    赋值 (权限代码, 相加 (权限代码, 到文本 (1)))
.否则
    赋值 (权限代码, 相加 (权限代码, 到文本 (0)))
.如果结束

.如果 (等于 (.选中, 真))
    赋值 (权限代码, 相加 (权限代码, 到文本 (1)))
.否则
    赋值 (权限代码, 相加 (权限代码, 到文本 (0)))
.如果结束

.如果真 (等于 (权限代码, “0000”))
    信息框 (“    管理员最少要有一项操作权限！    ”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束

.判断开始 (等于 (.标题, “添加管理员数据”))
    .如果真 (不等于 (.内容, .内容))
        信息框 (“输入的密码与确认密码不一致！”, 0, )
        连续赋值 (“”, .内容, .内容)
        获取焦点 ()
    .如果真结束
    
    .如果真 (等于 (取表项数 (), 0))
        .如果真 (不等于 (权限代码, “1111”))
            信息框 (相加 (“第一次创建的管理员必须拥有全部的操作权限！    ”, #换行符, “（请在4个操作权限上全部打勾）”), #信息图标, “提示”)
            返回 ()
        .如果真结束
        
    .如果真结束
    
    .如果 (_启动窗口.执行 (., 相加 (“insert into 用户表 values ('”, .内容, “','”, .内容, “','”, 权限代码, “')”), ))
        .插入表项 (.内容, 0, , , )
        赋值 (表项, .插入表项 (.内容, , , , ))
        表项.置标题 (1, .内容)
        表项.置标题 (2, 权限代码)
        .如果 (等于 (权限代码, “1111”))
            信息框 (相加 (“          添加管理员数据成功！管理员权限为：超级管理员   ”, #换行符, #换行符, “如果您不慎丢失了全部超级管理员的密码或不能进入管理设置时请查阅本系统”, #换行符, “运行目录下的readme.txt文件或与作者联系！  ”), 0, )
        .否则
            信息框 (“   添加管理员数据成功！管理员权限为：普通管理员   ”, 0, )
        .如果结束
        连续赋值 (“”, .内容, .内容, .内容)
        连续赋值 (真, .选中, .选中, .选中, .选中)
        获取焦点 ()
    .否则
        信息框 (“添加管理员数据失败！”, 0, )
    .如果结束
    
.判断 (等于 (.标题, “修改管理员数据”))
    .如果真 (不等于 (信息框 (“您确认要修改当前管理员的数据吗？”, #确认取消钮, “询问”), #确认钮))
        返回 ()
    .如果真结束
    
    .计次循环首 (取表项数 (), 计次)
        .如果真 (等于 (相减 (计次, 1).取标题 (2), “1111”))
            赋值 (超级数, 相加 (超级数, 1))
        .如果真结束
        
    .计次循环尾 ()
    .如果真 (并且 (等于 (超级数, 1), 等于 (.取标题 (., 2), “1111”)))
        .如果真 (不等于 (权限代码, “1111”))
            信息框 (相加 (“  目前”, .取标题 (., 0), “是唯一的超级管理员，不能修改为普通管理员！  ”, #换行符, #换行符, “  如果您一定要修改，请先再添加一个超级管理员！”), 0, )
            返回 ()
        .如果真结束
        
    .如果真结束
    
    .如果 (_启动窗口.执行 (., 相加 (“update 用户表 set 用户名='”, .内容, “',密码='”, .内容, “',权限='”, 权限代码, “' where 用户名='”, .取标题 (., 0), “'”), ))
        .如果真 (等于 (.取标题 (., 0), _启动窗口.取文本 (., 1)))
            _启动窗口.置文本 (., 1, .内容)
            赋值 (_启动窗口..标题, 权限代码)
            .如果真 (不等于 (_启动窗口..现行子夹, 0))
                回主界面 ()
            .如果真结束
            
        .如果真结束
        .置标题 (., 0, .内容)
        .置标题 (., 0, .内容)
        .置标题 (., 1, .内容)
        .置标题 (., 2, 权限代码)
        信息框 (“   当前管理员数据被成功修改！  ”, 0, )
        赋值 (.现行子夹, 3)
    .否则
        信息框 (“  修改管理员数据失败！  ”, 0, )
    .如果结束
    
.默认
    
.判断结束


.子程序 _添加修改取消钮_被单击, 空白型, , 
赋值 (.现行子夹, 3)

.子程序 _添加钮_被单击, 空白型, , 
赋值 (.标题, “添加管理员数据”)
赋值 (.标题, “注册管理员后将打开管理员认证功能，无管理员用户名及密码将不能进入本系统！”)
赋值 (.标题, “密码：”)
赋值 (.禁止, 假)
连续赋值 (“”, .内容, .内容, .内容)
连续赋值 (真, .选中, .选中, .选中, .选中)
获取焦点 ()
赋值 (.现行子夹, 2)


.子程序 _修改钮_被单击, 空白型, , 
.局部变量 权限代码, 文本型, , , 

.如果真 (等于 (., -1))
    信息框 (“请选择要修改的管理员用户名！”, 0, )
    返回 ()
.如果真结束

赋值 (.标题, “修改管理员数据”)
赋值 (.标题, “原密码：”)
赋值 (.内容, .取标题 (., 0))
赋值 (.内容, .取标题 (., 1))
赋值 (.内容, .内容)
赋值 (.禁止, 真)
赋值 (权限代码, .取标题 (., 2))
.如果 (等于 (取文本左边 (权限代码, 1), “1”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束

.如果 (等于 (取文本中间 (权限代码, 2, 1), “1”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束

.如果 (等于 (取文本中间 (权限代码, 3, 1), “1”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束

.如果 (等于 (取文本右边 (权限代码, 1), “1”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束
赋值 (.标题, “按下确定钮后被修改的管理员用户名、密码及权限将会立即生效！”)
赋值 (.现行子夹, 2)


.子程序 _删除钮_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 超级数, 整数型, , , 

.如果真 (等于 (., -1))
    信息框 (“请选择要删除的管理员用户名！”, 0, )
    返回 ()
.如果真结束

.计次循环首 (取表项数 (), 计次)
    .如果真 (等于 (相减 (计次, 1).取标题 (2), “1111”))
        赋值 (超级数, 相加 (超级数, 1))
    .如果真结束
    
.计次循环尾 ()
.如果真 (并且 (等于 (超级数, 1), 等于 (.取标题 (., 2), “1111”)))
    .如果真 (不等于 (取表项数 (), 1))
        信息框 (相加 (“       ”, .取标题 (., 0), “是目前唯一的超级管理员！”, #换行符, #换行符, “如果您确定要删除，请再创建一个超级管理员或先将”, #换行符, “其他普通管理员全部删除后再删除当前管理员！”), 0, )
        返回 ()
    .如果真结束
    
.如果真结束

.如果真 (等于 (信息框 (相加 (“    您确定要删除用户名为”, .取标题 (., 0), “的管理员数据吗？    ”), #确认取消钮, “询问”), #确认钮))
    .如果真 (_启动窗口.执行 (., 相加 (“delete from 用户表 where 用户名=”, “'”, .取标题 (., 0), “'”), ))
        .删除表项 (.)
        .删除表项 (.)
    .如果真结束
    
.如果真结束


.子程序 _退出钮_被单击, 空白型, , 
销毁 ()

.子程序 _管理员列表框_当前表项被改变, 空白型, , 
赋值 (., .)

.子程序 _登陆名组合框_列表项被选择, 空白型, , 
获取焦点 ()

.子程序 _改用户名组合框_列表项被选择, 空白型, , 
获取焦点 ()

.子程序 _登陆密码编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _登录钮_被单击 ()
.如果真结束


.子程序 _登陆名组合框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.窗口程序集 修改界面程序集, , , 

.子程序 _界面窗口_创建完毕, 空白型, , 
.局部变量 界面选项, 整数型, , , 

赋值 (界面选项, 到数值 (读配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “Style”, )))
.判断开始 (等于 (界面选项, 1))
    赋值 (.选中, 真)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
.判断 (等于 (界面选项, 2))
    赋值 (.选中, 真)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
.判断 (等于 (界面选项, 3))
    赋值 (.选中, 真)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
.默认
    赋值 (.选中, 真)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
.判断结束


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
.判断开始 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “Style”, “0”)
    未知支持库函数_0 (0)
.判断 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “Style”, “1”)
    未知支持库函数_0 (1)
.判断 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “Style”, “2”)
    未知支持库函数_0 (2)
.判断 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “Style”, “3”)
    未知支持库函数_0 (3)
.默认
    
.判断结束
销毁 ()

.窗口程序集 修改范例程序集, , , 

.子程序 _修改范例窗口_创建完毕, 空白型, , 
赋值 (修改范例窗口., 相减 (相加 (修改范例窗口., 260), 修改范例窗口.取用户区高度 ()))
.如果 (等于 (修改资料, 真))
    赋值 (.内容, 评语录入窗口..内容)
    赋值 (.标题, “修改评语范例”)
.否则
    赋值 (.内容, “”)
    赋值 (.标题, “添加评语范例”)
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 分类, 文本型, , , 

.判断开始 (并且 (等于 (修改资料, 假), 等于 (.标题, “添加评语范例”)))
    .判断开始 (等于 (评语录入窗口..背景颜色, 取颜色值 (200, 255, 200)))
        赋值 (分类, “优等生评语范例”)
    .判断 (等于 (评语录入窗口..背景颜色, 取颜色值 (200, 255, 200)))
        赋值 (分类, “中等生评语范例”)
    .判断 (等于 (评语录入窗口..背景颜色, 取颜色值 (200, 255, 200)))
        赋值 (分类, “后进生评语范例”)
    .默认
        
    .判断结束
    
    .如果 (_启动窗口.执行 (., 相加 (“insert into 评语表  (库别,类别,内容,范例) values ('”, 评语录入窗口..内容, “','”, 分类, “','',?)”), 到字节集 (删首尾空 (.内容))))
        填充范例 (分类)
        赋值 (评语录入窗口.., 相减 (评语录入窗口.取表项数 (.), 1))
        评语录入窗口.保证显示 (., 评语录入窗口..)
        _范例评语列表框_当前表项被改变 ()
        销毁 ()
    .否则
        信息框 (“添加评语范例失败！”, #错误图标, “错误”)
        销毁 ()
    .如果结束
    
.判断 (并且 (等于 (修改资料, 真), 等于 (.标题, “修改评语范例”)))
    .如果 (_启动窗口.执行 (., 相加 (“update 评语表 set 范例=? where 编号=”, 到文本 (评语录入窗口.取表项数值 (., 评语录入窗口..))), 到字节集 (删首尾空 (.内容))))
        评语录入窗口.置标题 (., 评语录入窗口.., 0, 取文本左边 (删首尾空 (.内容), 70))
        _范例评语列表框_当前表项被改变 ()
        销毁 ()
    .否则
        信息框 (“修改评语范例失败！”, #错误图标, “错误”)
        销毁 ()
    .如果结束
    
.默认
    
.判断结束


.子程序 _编辑框1_内容被改变, 空白型, , 
.如果真 (大于 (186.发送信息 (0, 0), 14))
    .判断循环首 (大于 (186.发送信息 (0, 0), 14))
        赋值 (.内容, 取文本左边 (.内容, 相减 (取文本长度 (.内容), 2)))
    .判断循环尾 ()
    信息框 (“评语最多输入14行内容！”, 0, )
    获取焦点 ()
    赋值 (.起始选择位置, 取文本长度 (.内容))
.如果真结束


.窗口程序集 自设班级毕业程序集, , , 

.子程序 _自设毕业窗口_创建完毕, 空白型, , 
赋值 (自设毕业窗口., 相减 (相加 (自设毕业窗口., 215), 自设毕业窗口.取用户区高度 ()))
清空 ()
赋值 (记录, _启动窗口.查询 (., “select 所在班级 from 班级表 where 班级分类='自设'”))
_启动窗口.到首记录 (., 记录)
.如果 (不等于 (记录, 0))
    .判断循环首 (等于 (_启动窗口.尾记录后 (., 记录), 假))
        _启动窗口.读 (., 记录, “所在班级”).加入项目 ()
        _启动窗口.到后一记录 (., 记录)
    .判断循环尾 ()
    _启动窗口.关闭记录集 (., 记录)
    赋值 (.现行子夹, 0)
    .如果真 (等于 (取项目数 (), 0))
        信息框 (“目前本校没有自设班级！”, 0, )
        销毁 ()
    .如果真结束
    
.否则
    信息框 (“班级数据载入失败！”, #错误图标, “错误”)
    _启动窗口.关闭记录集 (., 记录)
    销毁 ()
.如果结束


.子程序 _取消钮_被单击, 空白型, , 
销毁 ()

.子程序 _下一步钮0_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 

全部删除 ()
全部删除 ()
.计次循环首 (取项目数 (), 计次)
    .如果 (等于 (相减 (计次, 1).是否被选中 (), 真))
        .插入表项 (相减 (计次, 1).取项目文本 (), , , , )
    .否则
        .插入表项 (相减 (计次, 1).取项目文本 (), , , , )
    .如果结束
    
.计次循环尾 ()
赋值 (.现行子夹, 1)

.子程序 _上一步钮1_被单击, 空白型, , 
赋值 (.现行子夹, 0)

.子程序 _选择升级班列表框_表项被激活, 空白型, , 
载入 (改升级名窗口, _启动窗口, 真)

.子程序 _下一步钮1_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 表项, 整数型, , , 

全部删除 ()
.计次循环首 (取表项数 (), 计次)
    .如果真 (不等于 (删全部空 (相减 (计次, 1).取标题 (1)), “”))
        赋值 (表项, .插入表项 (相减 (计次, 1).取标题 (0), , , , ))
        表项.置标题 (1, 相减 (计次, 1).取标题 (1))
    .如果真结束
    
.计次循环尾 ()
赋值 (.现行子夹, 2)

.子程序 _上一步钮2_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 

全部删除 ()
全部删除 ()
.计次循环首 (取项目数 (), 计次)
    .如果 (等于 (相减 (计次, 1).是否被选中 (), 真))
        .插入表项 (相减 (计次, 1).取项目文本 (), , , , )
    .否则
        .插入表项 (相减 (计次, 1).取项目文本 (), , , , )
    .如果结束
    
.计次循环尾 ()
赋值 (.现行子夹, 1)

.子程序 _开始执行钮_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 


.如果真 (并且 (等于 (取表项数 (), 0), 等于 (取表项数 (), 0)))
    信息框 (“没有找到需要毕业升级的班级！”, 0, )
    返回 ()
.如果真结束

.如果真 (.选中)
    .如果 (未知支持库函数_4 (相加 (取运行目录 (), “\backup\temp006.xsk”), 相加 (取运行目录 (), “\data\006.xsk”)))
        .如果真 (等于 (删除文件 (相加 (取运行目录 (), “\backup\006.xsk”)), 假))
            未知支持库函数_3 (相加 (1, 4), 相加 (取运行目录 (), “\backup\006.xsk”))
        .如果真结束
        文件更名 (相加 (取运行目录 (), “\backup\temp006.xsk”), 相加 (取运行目录 (), “\backup\006.xsk”))
    .否则
        .如果真 (等于 (信息框 (“  备份数据失败！是否继续进行毕业升级操作？  ”, #是否钮, “备份数据失败”), #否钮))
            资料变更窗口.销毁 ()
            返回 ()
        .如果真结束
        
    .如果结束
    
.如果真结束

置等待鼠标 ()
.计次循环首 (取表项数 (), 计次)
    .如果真 (_启动窗口.执行 (., 相加 (“insert into 毕业表 select * from 学籍表 where 所在班级='”, 相减 (计次, 1).取标题 (0), “'”), ))
        _启动窗口.执行 (., 相加 (“update 毕业表 set 离校时间='”, 时间到文本 (.今天, 2), “',离校原因='毕业' where 离校时间='-'”), )
        _启动窗口.执行 (., 相加 (“insert into 毕业时间表 values ('”, 时间到文本 (.今天, 2), “')”), )
        _启动窗口.执行 (., 相加 (“delete * from 学籍表 where 所在班级='”, 相减 (计次, 1).取标题 (0), “'”), )
        _启动窗口.执行 (., 相加 (“delete * from 班级表 where 所在班级='”, 相减 (计次, 1).取标题 (0), “'”), )
    .如果真结束
    
.计次循环尾 ()

.计次循环首 (取表项数 (), 计次)
    _启动窗口.执行 (., 相加 (“update 班级表 set 所在班级='”, 相减 (计次, 1).取标题 (1), “' where 所在班级='”, 相减 (计次, 1).取标题 (0), “'”), )
    _启动窗口.执行 (., 相加 (“update 学籍表 set 所在班级='”, 相减 (计次, 1).取标题 (1), “' where 所在班级='”, 相减 (计次, 1).取标题 (0), “'”), )
.计次循环尾 ()
写配置项 (相加 (取运行目录 (), “\config.ini”), “Graduate”, “Date2”, 时间到文本 (取现行时间 (), 2))
恢复鼠标 ()
信息框 (“    完成自设班级的毕业升级操作！　　”, 0, )
自设毕业窗口.销毁 ()


.子程序 _自设毕业窗口_被激活, 空白型, , 
.判断开始 (等于 (.现行子夹, 0))
    赋值 (.宽度, 相减 (.宽度, 1))
    重画 ()
    赋值 (.宽度, 相加 (.宽度, 1))
.判断 (等于 (.现行子夹, 1))
    赋值 (.倾斜, 相减 (.倾斜, 1))
    重画 ()
    赋值 (.倾斜, 相加 (.倾斜, 1))
.判断 (等于 (.现行子夹, 2))
    赋值 (.倾斜, 相减 (.倾斜, 1))
    重画 ()
    赋值 (.倾斜, 相加 (.倾斜, 1))
    赋值 (.倾斜, 相减 (.倾斜, 1))
    重画 ()
    赋值 (.倾斜, 相加 (.倾斜, 1))
    
.默认
    
.判断结束


.窗口程序集 数据维护程序集, , , 

.子程序 _数据维护窗口_创建完毕, 空白型, , 
赋值 (数据维护窗口., 相减 (相加 (数据维护窗口., 175), 数据维护窗口.取用户区高度 ()))
连续赋值 (真, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
连续赋值 (真, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中)

.子程序 _备份或还原全部工资表_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    连续赋值 (真, .选中, .选中, .选中, .选中, .选中)
    连续赋值 (真, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
.否则
    连续赋值 (假, .选中, .选中, .选中, .选中, .选中)
    连续赋值 (假, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
.如果结束


.子程序 _备份系统数据按钮_被单击, 空白型, , 
.局部变量 失败文件, 文本型, , , 

赋值 (.现行子夹, 1)
赋值 (.内容, “”)
相加 (“正在准备备份系统数据...”, #换行符, “备份系统数据可能需要几分钟的时间，请稍侯...    ”, #换行符, #换行符).加入文本 ()
连续赋值 (真, .禁止, .禁止)
.如果真 (不等于 (到小写 (寻找文件 (相加 (取运行目录 (), “\backup”), 16)), “backup”))
    创建目录 (相加 (取运行目录 (), “\backup”))
.如果真结束
.如果真 (.选中)
    相加 (“正在备份学生数据文件...”, #换行符).加入文本 ()
    .如果 (复制文件 (相加 (取运行目录 (), “\data\006.xsk”), 相加 (取运行目录 (), “\backup\006.xsk”)))
        相加 (“√完成学生数据文件的备份”, #换行符).加入文本 ()
    .否则
        相加 (#换行符, “★★★备份学生数据文件失败！★★★”, #换行符).加入文本 ()
        赋值 (失败文件, 相加 (失败文件, “备份学生数据文件失败！”, #换行符))
    .如果结束
    
.如果真结束
.如果真 (.选中)
    相加 (“正在备份教员数据文件...”, #换行符).加入文本 ()
    .如果 (复制文件 (相加 (取运行目录 (), “\data\007.xsk”), 相加 (取运行目录 (), “\backup\007.xsk”)))
        相加 (“√完成教员数据文件的备份”, #换行符).加入文本 ()
    .否则
        相加 (#换行符, “★★★备份教员数据文件失败！★★★”, #换行符).加入文本 ()
        赋值 (失败文件, 相加 (失败文件, “备份教员数据文件失败！”, #换行符))
    .如果结束
    
.如果真结束
.如果真 (.选中)
    相加 (“正在备份管理员数据文件...”, #换行符).加入文本 ()
    .如果 (复制文件 (相加 (取运行目录 (), “\data\008.xsk”), 相加 (取运行目录 (), “\backup\008.xsk”)))
        相加 (“√完成管理员数据文件的备份”, #换行符).加入文本 ()
    .否则
        相加 (#换行符, “★★★备份管理员数据文件失败！★★★”, #换行符).加入文本 ()
        赋值 (失败文件, 相加 (失败文件, “备份管理员数据文件失败！”, #换行符))
    .如果结束
    
.如果真结束
.如果真 (.选中)
    相加 (“正在备份教员工资表1的数据...”, #换行符).加入文本 ()
    .如果 (复制文件 (相加 (取运行目录 (), “\data\001.xsk”), 相加 (取运行目录 (), “\backup\001.xsk”)))
        相加 (“√完成教员工资表1数据的备份”, #换行符).加入文本 ()
    .否则
        相加 (#换行符, “★★★备份教员工资表1数据失败！★★★”, #换行符).加入文本 ()
        赋值 (失败文件, 相加 (失败文件, “备份教员工资表1数据失败！”, #换行符))
    .如果结束
    
.如果真结束
.如果真 (.选中)
    相加 (“正在备份教员工资表2的数据...”, #换行符).加入文本 ()
    .如果 (复制文件 (相加 (取运行目录 (), “\data\002.xsk”), 相加 (取运行目录 (), “\backup\002.xsk”)))
        相加 (“√完成教员工资表2数据的备份”, #换行符).加入文本 ()
    .否则
        相加 (#换行符, “★★★备份教员工资表2数据失败！★★★”, #换行符).加入文本 ()
        赋值 (失败文件, 相加 (失败文件, “备份教员工资表2数据失败！”, #换行符))
    .如果结束
    
.如果真结束
.如果真 (.选中)
    相加 (“正在备份教员工资表3的数据...”, #换行符).加入文本 ()
    .如果 (复制文件 (相加 (取运行目录 (), “\data\003.xsk”), 相加 (取运行目录 (), “\backup\003.xsk”)))
        相加 (“√完成教员工资表3数据的备份”, #换行符).加入文本 ()
    .否则
        相加 (#换行符, “★★★备份教员工资表3数据失败！★★★”, #换行符).加入文本 ()
        赋值 (失败文件, 相加 (失败文件, “备份教员工资表3数据失败！”, #换行符))
    .如果结束
    
.如果真结束
.如果真 (.选中)
    相加 (“正在备份教员工资表4的数据...”, #换行符).加入文本 ()
    .如果 (复制文件 (相加 (取运行目录 (), “\data\004.xsk”), 相加 (取运行目录 (), “\backup\004.xsk”)))
        相加 (“√完成教员工资表4数据的备份”, #换行符).加入文本 ()
    .否则
        相加 (#换行符, “★★★备份教员工资表4数据失败！★★★”, #换行符).加入文本 ()
        赋值 (失败文件, 相加 (失败文件, “备份教员工资表4数据失败！”, #换行符))
    .如果结束
    
.如果真结束
.如果真 (.选中)
    相加 (“正在备份教员工资表5的数据...”, #换行符).加入文本 ()
    .如果 (复制文件 (相加 (取运行目录 (), “\data\005.xsk”), 相加 (取运行目录 (), “\backup\005.xsk”)))
        相加 (“√完成教员工资表5数据的备份”, #换行符).加入文本 ()
    .否则
        相加 (#换行符, “★★★备份教员工资表5数据失败！★★★”, #换行符).加入文本 ()
        赋值 (失败文件, 相加 (失败文件, “备份教员工资表5数据失败！”, #换行符))
    .如果结束
    
.如果真结束
“备份系统数据完成！”.加入文本 ()
.如果 (不等于 (删全部空 (失败文件), “”))
    信息框 (相加 (“备份系统数据完成！但有错误！！！”, #换行符, #换行符, 失败文件), #错误图标, “错误”)
.否则
    信息框 (“备份系统数据完成！”, #信息图标, )
.如果结束
连续赋值 (假, .禁止, .禁止)

.子程序 _还原系统数据按钮_被单击, 空白型, , 
.局部变量 失败文件, 文本型, , , 

.如果真 (等于 (信息框 (“确定要用备份数据替换当前的系统数据吗？”, 相加 (#确认取消钮, #询问图标), “询问”), #取消钮))
    返回 ()
.如果真结束
回主界面 ()
赋值 (.现行子夹, 1)
赋值 (.内容, “”)
连续赋值 (真, .禁止, .禁止)
相加 (“正在准备还原系统数据...”, #换行符, “这一过程可能需要几分钟的时间，请稍侯...    ”, #换行符, #换行符).加入文本 ()
.如果真 (.选中)
    相加 (“正在还原学生数据文件...”, #换行符).加入文本 ()
    .如果真 (等于 (检查文件 (相加 (取运行目录 (), “\backup\006.xsk”)), 假))
        返回 ()
    .如果真结束
    _启动窗口.关闭 (.)
    赋值 (_启动窗口..连接文本, “”)
    .如果 (复制文件 (相加 (取运行目录 (), “\backup\006.xsk”), 相加 (取运行目录 (), “\data\006.xsk”)))
        相加 (“√完成学生数据文件的还原”, #换行符).加入文本 ()
    .否则
        相加 (#换行符, “★★★还原学生数据文件失败！★★★”, #换行符).加入文本 ()
        赋值 (失败文件, 相加 (失败文件, “还原学生数据文件失败！”, #换行符))
    .如果结束
    
    .如果真 (等于 (_启动窗口.打开MDB数据库 (., 相加 (取运行目录 (), “\data\006.xsk”), , “2978263-dks”, , ), 假))
        信息框 (“载入学生数据失败！”, #错误图标, “错误”)
        结束 ()
    .如果真结束
    赋值 (_启动窗口..连接文本, _启动窗口.取连接文本 (.))
.如果真结束
.如果真 (.选中)
    相加 (“正在还原教员数据文件...”, #换行符).加入文本 ()
    .如果真 (等于 (检查文件 (相加 (取运行目录 (), “\backup\007.xsk”)), 假))
        返回 ()
    .如果真结束
    _启动窗口.关闭 (.)
    .如果 (复制文件 (相加 (取运行目录 (), “\backup\007.xsk”), 相加 (取运行目录 (), “\data\007.xsk”)))
        相加 (“√完成教员数据文件的还原”, #换行符).加入文本 ()
    .否则
        相加 (#换行符, “★★★还原教员数据文件失败！★★★”, #换行符).加入文本 ()
        赋值 (失败文件, 相加 (失败文件, “还原教员数据文件失败！”, #换行符))
    .如果结束
    
    .如果真 (等于 (_启动窗口.打开MDB数据库 (., 相加 (取运行目录 (), “\data\007.xsk”), , “2978263-dkt”, , ), 假))
        信息框 (“载入教员数据失败！”, #错误图标, “错误”)
        结束 ()
    .如果真结束
    
.如果真结束
.如果真 (.选中)
    相加 (“正在还原管理员数据文件...”, #换行符).加入文本 ()
    .如果真 (等于 (检查文件 (相加 (取运行目录 (), “\backup\008.xsk”)), 假))
        返回 ()
    .如果真结束
    _启动窗口.关闭 (.)
    .如果 (复制文件 (相加 (取运行目录 (), “\backup\008.xsk”), 相加 (取运行目录 (), “\data\008.xsk”)))
        相加 (“√完成管理员数据文件的还原”, #换行符).加入文本 ()
    .否则
        相加 (#换行符, “★★★还原管理员数据文件失败！★★★”, #换行符).加入文本 ()
        赋值 (失败文件, 相加 (失败文件, “还原管理员数据文件失败！”, #换行符))
    .如果结束
    
.如果真结束
.如果真 (.选中)
    相加 (“正在还原教员工资表1的数据...”, #换行符).加入文本 ()
    .如果真 (等于 (检查文件 (相加 (取运行目录 (), “\backup\001.xsk”)), 假))
        返回 ()
    .如果真结束
    
    .如果 (复制文件 (相加 (取运行目录 (), “\backup\001.xsk”), 相加 (取运行目录 (), “\data\001.xsk”)))
        相加 (“√完成教员工资表1数据的还原”, #换行符).加入文本 ()
    .否则
        相加 (#换行符, “★★★还原教员工资表1数据失败！★★★”, #换行符).加入文本 ()
        赋值 (失败文件, 相加 (失败文件, “还原教员工资表1数据失败！”, #换行符))
    .如果结束
    
.如果真结束
.如果真 (.选中)
    相加 (“正在还原教员工资表2的数据...”, #换行符).加入文本 ()
    .如果真 (等于 (检查文件 (相加 (取运行目录 (), “\backup\002.xsk”)), 假))
        返回 ()
    .如果真结束
    
    .如果 (复制文件 (相加 (取运行目录 (), “\backup\002.xsk”), 相加 (取运行目录 (), “\data\002.xsk”)))
        相加 (“√完成教员工资表2数据的还原”, #换行符).加入文本 ()
    .否则
        相加 (#换行符, “★★★还原教员工资表2数据失败！★★★”, #换行符).加入文本 ()
        赋值 (失败文件, 相加 (失败文件, “还原教员工资表2数据失败！”, #换行符))
    .如果结束
    
.如果真结束
.如果真 (.选中)
    相加 (“正在还原教员工资表3的数据...”, #换行符).加入文本 ()
    .如果真 (等于 (检查文件 (相加 (取运行目录 (), “\backup\003.xsk”)), 假))
        返回 ()
    .如果真结束
    
    .如果 (复制文件 (相加 (取运行目录 (), “\backup\003.xsk”), 相加 (取运行目录 (), “\data\003.xsk”)))
        相加 (“√完成教员工资表3数据的还原”, #换行符).加入文本 ()
    .否则
        相加 (#换行符, “★★★还原教员工资表3数据失败！★★★”, #换行符).加入文本 ()
        赋值 (失败文件, 相加 (失败文件, “还原教员工资表3数据失败！”, #换行符))
    .如果结束
    
.如果真结束
.如果真 (.选中)
    相加 (“正在还原教员工资表4的数据...”, #换行符).加入文本 ()
    .如果真 (等于 (检查文件 (相加 (取运行目录 (), “\backup\004.xsk”)), 假))
        返回 ()
    .如果真结束
    
    .如果 (复制文件 (相加 (取运行目录 (), “\backup\004.xsk”), 相加 (取运行目录 (), “\data\004.xsk”)))
        相加 (“√完成教员工资表4数据的还原”, #换行符).加入文本 ()
    .否则
        相加 (#换行符, “★★★还原教员工资表4数据失败！★★★”, #换行符).加入文本 ()
        赋值 (失败文件, 相加 (失败文件, “还原教员工资表4数据失败！”, #换行符))
    .如果结束
    
.如果真结束
.如果真 (.选中)
    相加 (“正在还原教员工资表5的数据...”, #换行符).加入文本 ()
    .如果真 (等于 (检查文件 (相加 (取运行目录 (), “\backup\005.xsk”)), 假))
        返回 ()
    .如果真结束
    
    .如果 (复制文件 (相加 (取运行目录 (), “\backup\005.xsk”), 相加 (取运行目录 (), “\data\005.xsk”)))
        相加 (“√完成教员工资表5数据的还原”, #换行符).加入文本 ()
    .否则
        相加 (#换行符, “★★★还原教员工资表5数据失败！★★★”, #换行符).加入文本 ()
        赋值 (失败文件, 相加 (失败文件, “还原教员工资表5数据失败！”, #换行符))
    .如果结束
    
.如果真结束
“还原系统数据完成！”.加入文本 ()
.如果 (不等于 (删全部空 (失败文件), “”))
    信息框 (相加 (“还原系统数据完成！但有错误！！！”, #换行符, #换行符, 失败文件), #错误图标, “错误”)
.否则
    信息框 (“还原系统数据完成！”, #信息图标, )
.如果结束
连续赋值 (假, .禁止, .禁止)

.子程序 检查文件, 逻辑型, , 
.参数 文件名, 文本型, , 

.如果 (等于 (文件是否存在 (文件名), 假))
    相加 (#换行符, “★★★还原数据操作非正常终止！找不到备份数据文件：”, #换行符, 文件名, #换行符).加入文本 ()
    信息框 (相加 (“还原数据操作非正常终止！”, #换行符, #换行符, “找不到备份数据文件：”, #换行符, 文件名), #错误图标, “错误”)
    连续赋值 (假, .禁止, .禁止)
    返回 (假)
.否则
    返回 (真)
.如果结束


.子程序 _退出数据维护按钮_被单击, 空白型, , 
销毁 ()

.子程序 _数据维护窗口_可否被关闭, 逻辑型, , 
.如果真 (或者 (等于 (.禁止, 真), 等于 (.禁止, 真)))
    返回 (假)
.如果真结束


.子程序 _返回按钮_被单击, 空白型, , 
赋值 (.现行子夹, 0)

.子程序 _数据维护窗口_被取消激活, 空白型, , 
重画 ()
重画 ()

.子程序 _数据维护窗口_被激活, 空白型, , 
重画 ()
重画 ()

.窗口程序集 离校说明程序集, , , 

.子程序 _离校说明窗口_创建完毕, 空白型, , 
赋值 (离校说明窗口., 相减 (相加 (离校说明窗口., 80), 离校说明窗口.取用户区高度 ()))
赋值 (.内容, 相加 (#换行符, _启动窗口..标题))


 ' 不属于任何一个程序集、类模块的函数：
