 ' 文件类型：Windows窗口程序

 ' 程序名称：苹果音乐服务段
 ' 程序描述：苹果音乐服务段
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 600
    高度 = 433
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “苹果音乐服务端”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' sock A6B983789F624b2cBDFD7D671249C097 1 0 网络通讯支持库
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 1 1 多线程支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' eDB 46E94341933A462383A4DE26B146322C 1 4 数据库操作支持库





.窗口程序集 窗口程序集1, , , 

.程序集变量 服务器, 未知类型0x40001, , , 
.程序集变量 客户句柄数组, 整数型, , "0", 记录当前登陆的所有客户句柄
.程序集变量 客户句柄, 整数型, , , 
.程序集变量 日志文件号, 整数型, , , 
.程序集变量 用户名称数组, 文本型, , "0", 记录当前登陆的所有用户名称
.程序集变量 注册服务器地址, 文本型, , , 
.程序集变量 注册服务器端口, 整数型, , , 
.程序集变量 客户地址, 文本型, , , 
.程序集变量 到达数据数组, 文本型, , "0", 
.程序集变量 发送退出信息, 未知类型0x40002, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 启动命令行, 文本型, , "0", 
.局部变量 命令行文本, 文本型, , "0", 
.局部变量 日志文件名, 文本型, , , 
.局部变量 在线用户, 整数型, , , 

赋值 (日志文件名, 时间到文本 (取现行时间 (), #日期部分))
赋值 (日志文件号, 打开文件 (相加 (取当前目录 (), “\Logs\loginlogs\”, 日志文件名, “.log”), #改写, ))
移到文件尾 (日志文件号)
赋值 (注册服务器地址, 读配置项 (相加 (取当前目录 (), “\Loginser.ini”), “LoginServerInfo”, “ServerIP”, ))
赋值 (注册服务器端口, 到数值 (读配置项 (相加 (取当前目录 (), “\Loginser.ini”), “LoginServerInfo”, “Port”, )))
取命令行 (启动命令行)
.如果 (等于 (取数组成员数 (启动命令行), 0))
    .如果 (等于 (服务器.未知支持库函数_0 (7777), 真))
        相加 (到文本 (取现行时间 ()), “聊天服务器已顺利启动，端口为7777。”, #换行符).加入文本 ()
        写出文本 (日志文件号, 相加 (到文本 (取现行时间 ()), “聊天服务器已顺利启动，端口为7777。”, #换行符))
    .否则
        相加 (“聊天服务器不能启动！请重试！”, #换行符).加入文本 ()
        写出文本 (日志文件号, 相加 (“聊天服务器不能启动！请重试！”, #换行符))
        返回 ()
    .如果结束
    
.否则
    .如果 (等于 (服务器.未知支持库函数_0 (到数值 (启动命令行 [1])), 真))
        相加 (到文本 (取现行时间 ()), “聊天服务器已顺利启动，端口为”, 启动命令行 [1], “。”, #换行符).加入文本 ()
        写出文本 (日志文件号, 相加 (到文本 (取现行时间 ()), “聊天服务器已顺利启动，端口为”, 启动命令行 [1], “。”, #换行符))
    .否则
        相加 (“聊天服务器不能启动！请重试！”, #换行符).加入文本 ()
        写出文本 (日志文件号, 相加 (“聊天服务器不能启动！请重试！”, #换行符))
    .如果结束
    
.如果结束
未知支持库函数_0 (#)
未知支持库函数_0 (&客户监听, )
 ' 注册用户 数据
取命令行 (命令行文本)
.如果 (不等于 (取数组成员数 (命令行文本), 0))
    赋值 (.端口, 到数值 (命令行文本 [1]))
.否则
    
.如果结束
.如果 (并且 (相加 (取当前目录 (), “\chatdatabase.mdb”).未知支持库函数_1 (“”), .未知支持库函数_12 (), “chat”.未知支持库函数_14 (#)))
    相加 (“服务器成功连接数据库，等待用户注册连接。”, #换行符).加入文本 ()
.否则
    相加 (“连接数据库失败，请检查数据库文件后重试！”, #换行符).加入文本 ()
.如果结束
赋值 (日志文件名, 相加 (取当前目录 (), “\Logs\reglogs\”, 时间到文本 (取现行时间 (), #日期部分), “.log”))
赋值 (日志文件号, 打开文件 (日志文件名, #改写, ))
移到文件尾 (日志文件号)
 ' 在线数量显示
赋值 (在线用户, 取项目数 ())
3.置文本 (到文本 (在线用户))

.子程序 客户监听, 空白型, , 
.局部变量 监听状态, 整数型, , , 

赋值 (监听状态, 1)
.判断循环首 (等于 (监听状态, 1))
    赋值 (客户句柄, 服务器.未知支持库函数_2 (0))
    加入成员 (客户句柄数组, 客户句柄)
    未知支持库函数_0 (&取得用户名, )
.判断循环尾 ()

.子程序 取得用户名, 空白型, , 
.局部变量 客户地址, 文本型, , , 
.局部变量 客户数目, 整数型, , , 
.局部变量 当前客户下标, 整数型, , , 
.局部变量 当前客户句柄, 整数型, , , 
.局部变量 客户名称, 文本型, , , 
.局部变量 进入许可证, 整数型, , , 

赋值 (进入许可证, 未知支持库函数_1 ())
未知支持库函数_3 (进入许可证)
赋值 (当前客户句柄, 客户句柄)
赋值 (当前客户下标, 1)
赋值 (客户地址, 服务器.未知支持库函数_6 (客户句柄))
赋值 (客户名称, 到文本 (服务器.未知支持库函数_3 (客户句柄, 0)))
.如果 (等于 (客户名称, “”))
    
.否则
    加入成员 (用户名称数组, 客户名称)
    客户名称.加入项目 ()
    相加 (到文本 (取现行时间 ()), “，”, 客户名称, “登陆，登陆IP为”, 客户地址, #换行符).加入文本 ()
    写出文本 (日志文件号, 相加 (到文本 (取现行时间 ()), “，”, 客户名称, “登陆，登陆IP为”, 客户地址, #换行符))
    赋值 (客户数目, 取数组成员数 (用户名称数组))
    赋值 (客户名称, “”)
    .变量循环首 (1, 客户数目, 1, 当前客户下标)
        赋值 (客户名称, 相加 (客户名称, 用户名称数组 [当前客户下标], “|”))
    .变量循环尾 ()
    赋值 (客户数目, 取数组成员数 (客户句柄数组))
    .变量循环首 (1, 客户数目, 1, 当前客户下标)
        发聊天数据 (客户句柄数组 [当前客户下标], 相加 (“列表|”, 客户名称))
    .变量循环尾 ()
    收聊天数据 (当前客户句柄)
.如果结束
未知支持库函数_4 (进入许可证)
未知支持库函数_2 (进入许可证)

.子程序 收聊天数据, 空白型, , 
.参数 当前句柄, 整数型, , 

.局部变量 聊天数据, 字节集, , , 
.局部变量 数组长度, 整数型, , , 
.局部变量 当前下标, 整数型, , , 
.局部变量 客户名称, 文本型, , , 
.局部变量 客户数目, 整数型, , , 

.判断循环首 (等于 (1, 1))
    赋值 (聊天数据, 服务器.未知支持库函数_3 (当前句柄, 0))
    .如果 (小于或等于 (取字节集长度 (聊天数据), 0))
        赋值 (数组长度, 取数组成员数 (客户句柄数组))
        .变量循环首 (1, 数组长度, 1, 当前下标)
            .如果 (等于 (客户句柄数组 [当前下标], 当前句柄))
                赋值 (客户名称, 用户名称数组 [当前下标])
                删除成员 (客户句柄数组, 当前下标, )
                删除成员 (用户名称数组, 当前下标, )
                相减 (当前下标, 1).删除项目 ()
                跳出循环 ()
            .否则
                
            .如果结束
            
        .变量循环尾 ()
        相加 (到文本 (取现行时间 ()), “，”, 客户名称, “正常退出。”, #换行符).加入文本 ()
        写出文本 (日志文件号, 相加 (到文本 (取现行时间 ()), “，”, 客户名称, “正常退出。”, #换行符))
        发送退出信息.未知支持库函数_8 (注册服务器地址, 注册服务器端口)
        发送退出信息.未知支持库函数_11 (相加 (“退出|”, 客户名称), 0)
        发送退出信息.未知支持库函数_9 ()
        赋值 (客户数目, 取数组成员数 (用户名称数组))
        赋值 (客户名称, “”)
        .变量循环首 (1, 客户数目, 1, 当前下标)
            赋值 (客户名称, 相加 (客户名称, 用户名称数组 [当前下标], “|”))
        .变量循环尾 ()
        赋值 (客户数目, 取数组成员数 (客户句柄数组))
        .变量循环首 (1, 客户数目, 1, 当前下标)
            发聊天数据 (客户句柄数组 [当前下标], 相加 (“列表|”, 客户名称))
        .变量循环尾 ()
        跳出循环 ()
    .否则
        赋值 (客户数目, 取数组成员数 (客户句柄数组))
        .变量循环首 (1, 客户数目, 1, 当前下标)
            发聊天数据 (客户句柄数组 [当前下标], 相加 (“信息|”, 到文本 (聊天数据)))
        .变量循环尾 ()
    .如果结束
    
.判断循环尾 ()

.子程序 发聊天数据, 空白型, , 
.参数 当前客户句柄, 整数型, , 
.参数 聊天数据, 文本型, , 

服务器.未知支持库函数_4 (当前客户句柄, 聊天数据, 0)

.子程序 _按钮7_被单击, 空白型, , 
.如果 (等于 (信息框 (“您确定退出聊天室服务器吗？”, 33, “确认退出”), 0))
    服务器.未知支持库函数_1 ()
    写出文本 (日志文件号, 相加 (到文本 (取现行时间 ()), “聊天服务器正常退出。”, #换行符))
    销毁 ()
    结束 ()
.否则
    返回 ()
.如果结束


.子程序 _按钮4_被单击, 空白型, , 
.局部变量 成员个数, 整数型, , , 
.局部变量 当前项目, 整数型, , , 

.如果 (等于 (.内容, “”))
    信息框 (“要查询的用户名不能为空”, 48, “输入错误”)
.否则
    赋值 (成员个数, 取项目数 ())
    .变量循环首 (1, 成员个数, 1, 当前项目)
        .如果 (等于 (相减 (当前项目, 1).取项目文本 (), .内容))
            赋值 (.现行选中项, 相减 (当前项目, 1))
            跳出循环 ()
        .否则
            
        .如果结束
        
    .变量循环尾 ()
    赋值 (.内容, “”)
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 客户数目, 整数型, , , 
.局部变量 当前下标, 整数型, , , 

赋值 (客户数目, 取数组成员数 (客户句柄数组))
.变量循环首 (1, 客户数目, 1, 当前下标)
    发聊天数据 (客户句柄数组 [当前下标], 相加 (“信息|”, “【系统公告】：”, .内容))
.变量循环尾 ()
赋值 (.内容, “”)

.子程序 _按钮5_被单击, 空白型, , 
.局部变量 客户数目, 整数型, , , 
.局部变量 当前下标, 整数型, , , 
.局部变量 欲踢掉用户名, 文本型, , , 

赋值 (欲踢掉用户名, .取项目文本 (.现行选中项))
赋值 (客户数目, 取数组成员数 (客户句柄数组))
.变量循环首 (1, 客户数目, 1, 当前下标)
    发聊天数据 (客户句柄数组 [当前下标], 相加 (“下线|”, 欲踢掉用户名))
.变量循环尾 ()

.子程序 _按钮6_被单击, 空白型, , 
.局部变量 锁定用户名, 文本型, , , 

赋值 (锁定用户名, “”)
赋值 (锁定用户名, .取项目文本 (.现行选中项))
.如果真 (等于 (锁定用户名, “”))
    信息框 (“没有选中要锁定的用户！”, 64, “提示信息：”)
    返回 ()
.如果真结束
发送退出信息.未知支持库函数_8 (注册服务器地址, 注册服务器端口)
发送退出信息.未知支持库函数_11 (相加 (“锁定|”, 锁定用户名), 0)
发送退出信息.未知支持库函数_9 ()

.子程序 _注册服务器_数据到达, 空白型, , 
.局部变量 到达数据, 文本型, , , 

赋值 (到达数据, 到文本 (取回数据 ()))
赋值 (到达数据数组, 分割文本 (到达数据, “|”, ))
.如果 (等于 (到达数据数组 [1], “注册”))
    未知支持库函数_0 (&注册, )
.否则
    .如果 (等于 (到达数据数组 [1], “查询”))
        未知支持库函数_0 (&查询, )
    .否则
        .如果 (等于 (到达数据数组 [1], “修改密码”))
            未知支持库函数_0 (&修改密码, )
        .否则
            .如果 (等于 (到达数据数组 [1], “登陆”))
                未知支持库函数_0 (&登陆, )
            .否则
                .如果 (等于 (到达数据数组 [1], “修改资料”))
                    未知支持库函数_0 (&修改资料, )
                .否则
                    .如果 (等于 (到达数据数组 [1], “退出”))
                        未知支持库函数_0 (&客户退出, )
                    .否则
                        .如果 (等于 (到达数据数组 [1], “锁定”))
                            未知支持库函数_0 (&用户锁定, )
                        .否则
                            
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 客户退出, 空白型, , 
.局部变量 退出客户名, 文本型, , , 
.局部变量 当前状态, 文本型, , , 
.局部变量 进入许可证, 整数型, , , 

赋值 (退出客户名, 到达数据数组 [2])
赋值 (进入许可证, 未知支持库函数_1 ())
未知支持库函数_3 (进入许可证)
.如果 (等于 (查找当前用户 (退出客户名), 假))
    相加 (到文本 (取现行时间 ()), 退出客户名, “退出信息写入失败。”, #换行符).加入文本 ()
.否则
    “在线状态”.未知支持库函数_26 (当前状态)
    “在线状态”.未知支持库函数_20 (“不在”)
    未知支持库函数_18 ()
    相加 (到文本 (取现行时间 ()), 退出客户名, “退出。”, #换行符).加入文本 ()
    写出文本 (日志文件号, 相加 (到文本 (取现行时间 ()), 退出客户名, “退出。”, #换行符))
.如果结束
未知支持库函数_4 (进入许可证)
未知支持库函数_2 (进入许可证)

.子程序 用户锁定, 空白型, , 
.局部变量 退出客户名, 文本型, , , 
.局部变量 当前状态, 文本型, , , 
.局部变量 进入许可证, 整数型, , , 

赋值 (退出客户名, 到达数据数组 [2])
赋值 (进入许可证, 未知支持库函数_1 ())
未知支持库函数_3 (进入许可证)
.如果 (等于 (查找当前用户 (退出客户名), 假))
    相加 (到文本 (取现行时间 ()), 退出客户名, “锁定IP信息写入失败。”, #换行符).加入文本 ()
.否则
    “IP状态”.未知支持库函数_26 (当前状态)
    “IP状态”.未知支持库函数_20 (“锁定”)
    未知支持库函数_18 ()
    相加 (到文本 (取现行时间 ()), 退出客户名, “已经锁定IP。”, #换行符).加入文本 ()
    写出文本 (日志文件号, 相加 (到文本 (取现行时间 ()), 退出客户名, “已经锁定IP。”, #换行符))
.如果结束
未知支持库函数_4 (进入许可证)
未知支持库函数_2 (进入许可证)

.子程序 查询, 空白型, , 
.局部变量 当前地址, 文本型, , , 
.局部变量 查询用户名, 文本型, , , 
.局部变量 查询返回信息, 文本型, , , 
.局部变量 临时变量, 文本型, , , 
.局部变量 临时变量1, 整数型, , , 
.局部变量 数据库序号, 整数型, , , 
.局部变量 进入许可证, 整数型, , , 

赋值 (进入许可证, 未知支持库函数_1 ())
未知支持库函数_3 (进入许可证)
赋值 (查询用户名, 到达数据数组 [2])
赋值 (当前地址, 客户地址)
.如果 (等于 (查找当前用户 (查询用户名), 假))
    当前地址.发送数据 (“查询失败”, )
    相加 (到文本 (取现行时间 ()), 当前地址, “查询”, 查询用户名, “信息失败！”, #换行符).加入文本 ()
    写出文本 (日志文件号, 相加 (到文本 (取现行时间 ()), 当前地址, “查询”, 查询用户名, “信息失败！”, #换行符))
.否则
    “真实姓名”.未知支持库函数_26 (临时变量)
    赋值 (查询返回信息, 相加 (查询用户名, “|”, 临时变量, “|”))
    .变量循环首 (4, 15, 1, 数据库序号)
        .如果 (等于 (数据库序号, 8))
            数据库序号.未知支持库函数_29 (临时变量1)
            赋值 (临时变量, 到文本 (临时变量1))
        .否则
            数据库序号.未知支持库函数_26 (临时变量)
        .如果结束
        赋值 (查询返回信息, 相加 (查询返回信息, 临时变量, “|”))
    .变量循环尾 ()
    当前地址.发送数据 (相加 (“查询成功”, “|”, 查询返回信息), )
    相加 (到文本 (取现行时间 ()), 当前地址, “查询”, 查询用户名, “信息成功！”, #换行符).加入文本 ()
    写出文本 (日志文件号, 相加 (到文本 (取现行时间 ()), 当前地址, “查询”, 查询用户名, “信息成功！”, #换行符))
.如果结束
未知支持库函数_4 (进入许可证)
未知支持库函数_2 (进入许可证)

.子程序 登陆, 空白型, , 
.局部变量 当前地址, 文本型, , , 
.局部变量 用户名, 文本型, , , 
.局部变量 密码, 文本型, , , 
.局部变量 容器1, 文本型, , , 
.局部变量 容器2, 文本型, , , 
.局部变量 进入许可证, 整数型, , , 

赋值 (进入许可证, 未知支持库函数_1 ())
未知支持库函数_3 (进入许可证)
赋值 (用户名, 到达数据数组 [2])
赋值 (密码, 到达数据数组 [3])
赋值 (当前地址, 客户地址)
.如果 (等于 (查找当前用户 (用户名), 假))
    当前地址.发送数据 (“没有注册”, )
.否则
    “密码”.未知支持库函数_26 (容器2)
    “IP状态”.未知支持库函数_26 (容器1) ' 容器1记录当前ip状态是否被屏蔽
    .如果 (等于 (密码, 容器2))
        .如果 (等于 (容器1, “正常”))
            “在线状态”.未知支持库函数_20 (“在线”)
            未知支持库函数_18 ()
            当前地址.发送数据 (“登陆成功”, )
            相加 (到文本 (取现行时间 ()), 当前地址, “，”, 用户名, “成功登陆。”, #换行符).加入文本 ()
            写出文本 (日志文件号, 相加 (到文本 (取现行时间 ()), 当前地址, “，”, 用户名, “成功登陆。”, #换行符))
        .否则
            当前地址.发送数据 (“已经锁定”, )
            相加 (到文本 (取现行时间 ()), 当前地址, “，”, 用户名, “登陆失败，已经锁定。”, #换行符).加入文本 ()
            写出文本 (日志文件号, 相加 (到文本 (取现行时间 ()), 当前地址, “，”, 用户名, “登陆失败，已经锁定。”, #换行符))
        .如果结束
        
    .否则
        当前地址.发送数据 (“密码错误”, )
        相加 (到文本 (取现行时间 ()), 当前地址, “，”, 用户名, “登陆密码错误。”, #换行符).加入文本 ()
        写出文本 (日志文件号, 相加 (到文本 (取现行时间 ()), 当前地址, “，”, 用户名, “登陆密码错误。”, #换行符))
    .如果结束
    
.如果结束
未知支持库函数_4 (进入许可证)
未知支持库函数_2 (进入许可证)

.子程序 修改密码, 空白型, , 
.局部变量 当前地址, 文本型, , , 
.局部变量 修改用户名, 文本型, , , 
.局部变量 进入许可证, 整数型, , , 

赋值 (进入许可证, 未知支持库函数_1 ())
未知支持库函数_3 (进入许可证)
赋值 (当前地址, 客户地址)
赋值 (修改用户名, 到达数据数组 [2])
.如果 (等于 (查找当前用户 (修改用户名), 真))
    .如果 (“密码”.未知支持库函数_20 (到达数据数组 [3]))
        未知支持库函数_18 ()
        当前地址.发送数据 (“修改成功”, )
        相加 (到文本 (取现行时间 ()), 修改用户名, “修改密码成功。”, #换行符).加入文本 ()
        写出文本 (日志文件号, 相加 (到文本 (取现行时间 ()), 修改用户名, “修改密码成功。”, #换行符))
    .否则
        当前地址.发送数据 (“修改失败”, )
        相加 (到文本 (取现行时间 ()), 修改用户名, “试图修改密码时，修改失败。”, #换行符).加入文本 ()
        写出文本 (日志文件号, 相加 (到文本 (取现行时间 ()), 修改用户名, “试图修改密码时，修改失败。”, #换行符))
    .如果结束
    
.否则
    当前地址.发送数据 (“修改失败”, )
.如果结束
未知支持库函数_4 (进入许可证)
未知支持库函数_2 (进入许可证)

.子程序 修改资料, 空白型, , 
.局部变量 当前地址, 文本型, , , 
.局部变量 修改用户名, 文本型, , , 
.局部变量 进入许可证, 整数型, , , 

赋值 (进入许可证, 未知支持库函数_1 ())
未知支持库函数_3 (进入许可证)
赋值 (当前地址, 客户地址)
赋值 (修改用户名, 到达数据数组 [2])
.如果 (等于 (查找当前用户 (修改用户名), 真))
    3.未知支持库函数_20 (到达数据数组 [3])
    6.未知支持库函数_20 (到达数据数组 [4])
    7.未知支持库函数_20 (到达数据数组 [5])
    8.未知支持库函数_23 (到数值 (到达数据数组 [6]))
    10.未知支持库函数_20 (到达数据数组 [7])
    11.未知支持库函数_20 (到达数据数组 [8])
    12.未知支持库函数_20 (到达数据数组 [9])
    13.未知支持库函数_20 (到达数据数组 [10])
    未知支持库函数_18 ()
    当前地址.发送数据 (“修改成功”, )
    相加 (到文本 (取现行时间 ()), 修改用户名, “修改资料成功。”, #换行符).加入文本 ()
    写出文本 (日志文件号, 相加 (到文本 (取现行时间 ()), 修改用户名, “修改资料成功。”, #换行符))
.否则
    当前地址.发送数据 (“修改失败”, )
.如果结束
未知支持库函数_4 (进入许可证)
未知支持库函数_2 (进入许可证)

.子程序 注册, 空白型, , 
.局部变量 进入许可证, 整数型, , , 
.局部变量 当前地址, 文本型, , , 

赋值 (进入许可证, 未知支持库函数_1 ())
未知支持库函数_3 (进入许可证)
赋值 (当前地址, 客户地址)
.如果 (等于 (查找当前用户 (到达数据数组 [2]), 真))
    当前地址.发送数据 (“已经存在”, )
.否则
    未知支持库函数_17 ()
    1.未知支持库函数_20 (到达数据数组 [2])
    2.未知支持库函数_20 (到达数据数组 [3])
    3.未知支持库函数_20 (到达数据数组 [4])
    4.未知支持库函数_20 (到达数据数组 [5])
    5.未知支持库函数_20 (到达数据数组 [6])
    6.未知支持库函数_20 (到达数据数组 [7])
    7.未知支持库函数_20 (到达数据数组 [8])
    8.未知支持库函数_23 (到数值 (到达数据数组 [9]))
    9.未知支持库函数_20 (“在线”)
    10.未知支持库函数_20 (到达数据数组 [10])
    11.未知支持库函数_20 (到达数据数组 [11])
    12.未知支持库函数_20 (到达数据数组 [12])
    13.未知支持库函数_20 (到达数据数组 [13])
    14.未知支持库函数_20 (“正常”)
    15.未知支持库函数_20 (“房间1”)
    当前地址.发送数据 (“注册成功”, )
    相加 (到文本 (取现行时间 ()), 当前地址, “成功注册用户”, 到达数据数组 [2], “。”, #换行符).加入文本 ()
    写出文本 (日志文件号, 相加 (到文本 (取现行时间 ()), 当前地址, “成功注册用户”, 到达数据数组 [2], “。”, #换行符))
    未知支持库函数_4 (进入许可证)
    未知支持库函数_2 (进入许可证)
    未知支持库函数_18 ()
.如果结束


.子程序 查找当前用户, 逻辑型, , 
.参数 用户名, 文本型, , 

.局部变量 到数据库尾部, 逻辑型, , , 
.局部变量 容器1, 文本型, , , 

未知支持库函数_34 ()
.循环判断首 ()
    “用户名”.未知支持库函数_26 (容器1)
    .如果 (等于 (用户名, 容器1))
        返回 (真)
    .否则
        
    .如果结束
    赋值 (到数据库尾部, 未知支持库函数_36 ())
.循环判断尾 (等于 (到数据库尾部, 真))
返回 (假)

.子程序 _注册服务器_客户进入, 空白型, , 
赋值 (客户地址, 取回客户 ())

.子程序 _计时时钟_周期事件, 空白型, , 
5.置文本 (到文本 (取现行时间 ()))

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
.如果 (等于 (信息框 (“您确定退出聊天室服务器吗？”, 33, “确认退出”), 0))
    服务器.未知支持库函数_1 ()
    写出文本 (日志文件号, 相加 (到文本 (取现行时间 ()), “聊天服务器正常退出。”, #换行符))
    结束 ()
    返回 (真)
.否则
    返回 (假)
.如果结束



 ' 不属于任何一个程序集、类模块的函数：
