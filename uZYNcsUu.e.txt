 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 894
    高度 = 580
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 5 系统核心支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库





.DLL命令 取磁盘信息_, 整数型, "kernel32", "GetVolumeInformationA", , ,
    .参数 卷根路径, 文本型, , 
    .参数 卷名, 文本型, 传址, 
    .参数 卷名字符长度, 整数型, 传址, 
    .参数 磁盘卷序列号, 整数型, 传址, 
    .参数 文件夹名长度, 整数型, 传址, 
    .参数 标志, 整数型, , 
    .参数 文件系统名称, 文本型, 传址, 
    .参数 名称长度, 整数型, , 

.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 


.子程序 子程序_取Mac地址, 文本型, , 
.局部变量 变量, 整数型, , , 
.局部变量 网卡信息, 未知类型0x20008, , "0", 
.局部变量 返回值, 文本型, , , 

赋值 (网卡信息, 未知支持库函数_42 ())
.计次循环首 (取数组成员数 (网卡信息), 变量)
    赋值 (返回值, 相加 (返回值, “网卡”, 到文本 (网卡信息 [变量], ), “:”, #换行符))
    赋值 (返回值, 相加 (返回值, “网卡物理地址：”, 网卡信息 [变量], , #换行符))
    赋值 (返回值, 相加 (返回值, “网卡名称：”, 网卡信息 [变量], , #换行符))
    赋值 (返回值, 相加 (返回值, “IP地址:”, 到文本 (网卡信息 [变量], ), #换行符))
    赋值 (返回值, 相加 (返回值, “子网掩码:”, 到文本 (网卡信息 [变量], ), #换行符))
    赋值 (返回值, 相加 (返回值, “默认网关:”, 到文本 (网卡信息 [变量], ), #换行符))
.计次循环尾 ()

返回 (返回值)

.子程序 子程序_取磁盘信息, 文本型, , 
.局部变量 驱动器列表, 文本型, , "0", 
.局部变量 文件系统名称, 文本型, , "0", 
.局部变量 十六进制序号, 文本型, , "0", 
.局部变量 卷名, 文本型, , "0", 
.局部变量 总返回, 文本型, , , 
.局部变量 分割返回, 文本型, , "0", 
.局部变量 磁盘空间, 文本型, , "0", 
.局部变量 变量, 整数型, , , 
.局部变量 返回值, 文本型, , , 

赋值 (驱动器列表, 未知支持库函数_5 (#))
重定义数组 (文件系统名称, 假, 取数组成员数 (驱动器列表))
重定义数组 (十六进制序号, 假, 取数组成员数 (驱动器列表))
重定义数组 (卷名, 假, 取数组成员数 (驱动器列表))
重定义数组 (磁盘空间, 假, 取数组成员数 (驱动器列表))

.计次循环首 (取数组成员数 (驱动器列表), 变量)
    
    赋值 (总返回, 子程序_取文件系统名称 (相加 (驱动器列表 [变量], “\”)))
    赋值 (分割返回, 分割文本 (总返回, “|”, ))
    .如果真 (等于 (取数组成员数 (分割返回), 3))
        赋值 (卷名 [变量], 分割返回 [1])
        赋值 (十六进制序号 [变量], 分割返回 [2])
        赋值 (文件系统名称 [变量], 分割返回 [3])
    .如果真结束
    
    赋值 (磁盘空间 [变量], 数值到格式文本 (相除 (取磁盘总空间 (驱动器列表 [变量]), 1024, 1024), 2, 假))
    
    赋值 (返回值, 相加 (返回值, 驱动器列表 [变量], “盘磁盘总空间：”, 磁盘空间 [变量], “G”, “  磁盘文件系统为：”, 文件系统名称 [变量], “格式”, “, 卷名为：”, 卷名 [变量], “  磁盘序号为： ”, 十六进制序号 [变量], #换行符))
.计次循环尾 ()

返回 (返回值)

.子程序 子程序_取文件系统名称, 文本型, , 
.参数 参数_驱动器名称, 文本型, , 

.局部变量 卷名, 文本型, , , 
.局部变量 卷名字符长度, 整数型, , , 
.局部变量 磁盘卷序列号, 整数型, , , 
.局部变量 文件夹名长度, 整数型, , , 
.局部变量 文件系统名称, 文本型, , , 
.局部变量 返回值, 整数型, , , 
.局部变量 十六进制序号, 文本型, , , 

赋值 (卷名, 取空白文本 (256))
赋值 (文件系统名称, 取空白文本 (256))

 ' '当驱动器不存在时，函数返回 0。如果是个非根目录，也将返回 0：
 ' 返回该序列号的值为十六进制值使用 DIR 命令时显示的十进制表示形式。 以前显示在信息中, 由这个驱动器的 DIR 命令所显示的的值为 1CE6-2DE2 （十六进制），与序列号 484847074 相对应。

赋值 (返回值, 未知函数_167837717 (参数_驱动器名称, 卷名, 256, 磁盘卷序列号, 256, 0, 文件系统名称, 256))
赋值 (十六进制序号, 取十六进制文本 (磁盘卷序列号))

赋值 (十六进制序号, 相加 (取文本左边 (十六进制序号, 相除 (取文本长度 (十六进制序号), 2)), “-”, 取文本右边 (十六进制序号, 相减 (取文本长度 (十六进制序号), 相除 (取文本长度 (十六进制序号), 2)))))

.如果 (等于 (返回值, 0))
    返回 (“”)
.否则
    返回 (相加 (卷名, “|”, 十六进制序号, “|”, 文件系统名称))
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
赋值 (.内容, 子程序_取Mac地址 ())

.子程序 _按钮2_被单击, 空白型, , 
赋值 (.内容, 子程序_取磁盘信息 ())


 ' 不属于任何一个程序集、类模块的函数：
