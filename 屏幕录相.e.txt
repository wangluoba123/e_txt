 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 297
    高度 = 330
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\屏幕录相.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “漫步屏幕录象 1.0版”
    帮助文件名 = “”

窗口 区域选择窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 320
    高度 = 212
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 57472 '  0xE080
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口2
    左边 = 50
    顶边 = 50
    宽度 = 526
    高度 = 365
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “增加注释”
    帮助文件名 = “”



.常量 WAIT_OBJECT_0, "0", , 
.常量 QS_ALLINPUT, "255", , 
.常量 INFINITE, "-1", , 
.图片 ph, " ' 已保存到：D:\易语言学习\Data\屏幕录相.e\ph", , 
.图片 光标, " ' 已保存到：D:\易语言学习\Data\屏幕录相.e\光标", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 5 系统核心支持库
 ' GIF89a 887FF0B4-0802-452c-BCDD-420B9CC1201E 1 2 GIF动画全操作支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库
 ' eImgConverter 8FA3AA46276847db8F28E57E7FB97B7F 1 0 图像格式转换支持库
 ' EdirectX 81690053A86045bf9E362F5DE0BC4095 1 5 DirectX支持库
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库
 ' shellEx DA19AC3ADD2F4121AAD84AC5FBCAFC71 2 3 扩展功能支持库一
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 3 扩展界面支持库一
 ' TrayIcon {86AB1D8A-7995-4D86-AE5F-18710759228B} 1 1 托盘图标支持库
 ' ExtMenu 9909FBB013704cfa8FE7E739DB7172DE 1 6 超级菜单支持库




数据类型 LARGE_INTEGER, , 
    .成员 QuadPart, 长整数型, , , 占用8个字节

数据类型 RECT, , 
    .成员 left, 整数型, , , 
    .成员 top, 整数型, , , 
    .成员 right, 整数型, , , 
    .成员 bottom, 整数型, , , 

数据类型 AVISTREAMINFO, , 
    .成员 fccType, 整数型, , , 
    .成员 fccHandler, 整数型, , , 
    .成员 dwFlags, 整数型, , , 
    .成员 dwCaps, 整数型, , , 
    .成员 wPriority, 短整数型, , , 
    .成员 wLanguage, 短整数型, , , 
    .成员 dwScale, 整数型, , , 
    .成员 dwRate, 整数型, , , 
    .成员 dwStart, 整数型, , , 
    .成员 dwLength, 整数型, , , 
    .成员 dwInitialFrames, 整数型, , , 
    .成员 dwSuggestedBufferSize, 整数型, , , 
    .成员 dwQuality, 整数型, , , 
    .成员 dwSampleSize, 整数型, , , 
    .成员 rcFrame, RECT, , , 
    .成员 dwEditCount, 整数型, , , 
    .成员 dwFormatChangeCount, 整数型, , , 
    .成员 szName, 字节型, , "64", 

.全局变量 录像区域, 未知类型0x30002, , , 
.全局变量 Video, 文本型, , , 
.全局变量 是否已经开始过, 逻辑型, , , 
.全局变量 是否结束, 逻辑型, , , 
.全局变量 不显示, 逻辑型, , , 

.DLL命令 SetWaitableTimer, 整数型, "", "SetWaitableTimer", , 
    .参数 hTimer, 整数型, , 
    .参数 pDueTime, LARGE_INTEGER, , 
    .参数 lPeriod, 整数型, , 
    .参数 pfnCompletionRoutine, 整数型, , 
    .参数 lpArgToCompletionRoutine, 整数型, , 
    .参数 fResume, 逻辑型, , 

.DLL命令 CreateWaitableTimerA, 整数型, "", "CreateWaitableTimerA", , 
    .参数 lpTimerAttributes, 整数型, , 
    .参数 bManualReset, 逻辑型, , 
    .参数 lpTimerName, 整数型, , 

.DLL命令 CloseHandle, 逻辑型, "", "CloseHandle", , 
    .参数 hObject, 整数型, , 

.DLL命令 MsgWaitForMultipleObjects, 整数型, "", "MsgWaitForMultipleObjects", , 
    .参数 nCount, 整数型, , 
    .参数 pHandles, 整数型, 传址, 
    .参数 fWaitAll, 逻辑型, , 
    .参数 dwMilliseconds, 整数型, , 
    .参数 dwWakeMask, 整数型, , 

.DLL命令 AVIFileInit, 空白型, "avifil32.dll", "AVIFileInit", , 

.DLL命令 AVIFileExit, 空白型, "avifil32.dll", "AVIFileExit", , 

.DLL命令 AVIFileOpen, 整数型, "avifil32.dll", "AVIFileOpen", , 
    .参数 ppfile, 空白型, 传址, PAVIFILE * 
    .参数 szFile, 文本型, , LPCTSTR
    .参数 mode, 空白型, , UINT
    .参数 pclsidHandler, 空白型, , CLSID

.DLL命令 AVIFileCreateStream, 整数型, "avifil32.dll", "AVIFileCreateStream", , 
    .参数 pfile, 空白型, , PAVIFILE
    .参数 ppavi, 空白型, 传址, PAVISTREAM * 
    .参数 psi, AVISTREAMINFO, , AVISTREAMINFO *

.DLL命令 AVIStreamSetFormat, 整数型, "avifil32.dll", "AVIStreamSetFormat", , 
    .参数 pavi, 空白型, , PAVISTREAM
    .参数 lPos, 空白型, , LONG
    .参数 lpFormat, 字节集, , LPVOID
    .参数 cbFormat, 空白型, , LONG

.DLL命令 AVIStreamWrite, 整数型, "avifil32.dll", "AVIStreamWrite", , 
    .参数 pavi, 空白型, , PAVISTREAM
    .参数 lStart, 空白型, , LONG
    .参数 lSamples, 空白型, , LONG
    .参数 lpBuffer, 字节集, , LPVOID
    .参数 cbBuffer, 空白型, , LONG
    .参数 dwFlags, 空白型, , DWORD
    .参数 plSampWritten, 空白型, , LONG *
    .参数 plBytesWritten, 空白型, , LONG *

.DLL命令 AVIStreamRelease, 整数型, "avifil32.dll", "AVIStreamRelease", , 
    .参数 pavi, 空白型, , PAVISTREAM

.DLL命令 CallWindowProcA, 整数型, "", "CallWindowProcA", , 
    .参数 lpPrevWndFunc, 子程序指针, , 
    .参数 hWnd, 整数型, , 
    .参数 Msg, 整数型, , 
    .参数 wParam, 整数型, , 
    .参数 lParam, 整数型, , 

.DLL命令 AVIFileRelease, 整数型, "avifil32.dll", "AVIFileRelease", , 
    .参数 pfile, 空白型, , PAVIFILE

.DLL命令 创建线程, 整数型, "kernel32.dll", "CreateThread", , 
    .参数 lpThreadAttributes, 整数型, , 
    .参数 dwStackSize, 整数型, , 
    .参数 子程序指针, 子程序指针, , 
    .参数 参数, 整数型, , 
    .参数 dwCreationFlags, 整数型, , 
    .参数 线程ID, 整数型, 传址, 

.DLL命令 销毁线程, 空白型, "kernel32.dll", "TerminateThread", , 
    .参数 线程ID, 整数型, , 
    .参数 dwExitCode, 整数型, , 

.DLL命令 加载皮肤, 逻辑型, "SkinPlusPlusE.dll", "sppLoadSkin", , 
    .参数 strSkinFilePath, 文本型, , 皮肤路径
    .参数 fWithOutHook, 逻辑型, , 该参数指定加载皮肤时是否开启Hook功能

.DLL命令 退出界面库, 逻辑型, "SkinPlusPlusE.dll", "sppExitSkin", , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 动画制作, 未知类型0x20003, , , 
.程序集变量 帧信息, 未知类型0x20002, , , 
.程序集变量 动画信息, 未知类型0x20001, , , 
.程序集变量 上一图片, 字节集, , , 
.程序集变量 延迟时间, 整数型, , , 
.程序集变量 帧数量, 整数型, , , 
.程序集变量 鼠标水平位置, 整数型, , , 
.程序集变量 鼠标垂直位置, 整数型, , , 
.程序集变量 帧数, 空白型, , , 
.程序集变量 录像格式, 文本型, , , 
.程序集变量 BMP2, 文本型, , "0", 
.程序集变量 线程号, 空白型, , , 
.程序集变量 bmp, 字节集, , , 
.程序集变量 注释, 字节集, , , 
.程序集变量 注释秒, 整数型, , , 
.程序集变量 热键标识1, 整数型, , , 
.程序集变量 热键标识2, 整数型, , , 
.程序集变量 热键标识3, 整数型, , , 
.程序集变量 热键标识4, 整数型, , , 
.程序集变量 简略, 逻辑型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (_启动窗口., 假)
写到文件 (相加 (未知支持库函数_7 (11), “AlphaOS.ssk”), #ph)
加载皮肤 (相加 (未知支持库函数_7 (11), “AlphaOS.ssk”), 假)
赋值 (_启动窗口., 真)
处理事件 ()
赋值 (_启动窗口., 假)
赋值 (., 真)
赋值 (., _启动窗口.)
赋值 (., _启动窗口.)
“提示”.未知支持库函数_20 (“欢迎使用本程序”, 0, 0)
_启动窗口.刷新显示 ()
赋值 (.选中, 真)
赋值 (.禁止, 真)
_组合框1_列表项被选择 ()
赋值 (热键标识1, 未知支持库函数_10 (取窗口句柄 (), 取窗口句柄 (), 0, #F5键))
赋值 (热键标识2, 未知支持库函数_10 (取窗口句柄 (), 取窗口句柄 (), 0, #F6键))
赋值 (热键标识3, 未知支持库函数_10 (取窗口句柄 (), 取窗口句柄 (), 0, #F7键))
赋值 (热键标识4, 未知支持库函数_10 (取窗口句柄 (), 取窗口句柄 (), 0, #F8键))

.子程序 _按钮1_被单击, 空白型, , 
重定义数组 (BMP2, 假, 0)
赋值 (不显示, 假)
赋值 (是否结束, 假)
.判断开始 (等于 (.标题, “开始”))
    .判断开始 (并且 (等于 (.选中, 假), 等于 (.选中, 假)))
        赋值 (.选中, 真)
    .默认
        
    .判断结束
    .判断开始 (并且 (等于 (.选中, 假), 等于 (.选中, 假)))
        赋值 (.选中, 真)
    .默认
        
    .判断结束
    .判断开始 (等于 (是否已经开始过, 真))
        赋值 (.标题, “暂停”)
        “提示”.未知支持库函数_20 (“当前状态：录制中 F5”, 0, 0)
        赋值 (.时钟周期, .位置)
    .判断 (.选中)
        .如果真 (并且 (等于 (录像区域., 0), 等于 (录像区域., 0)))
            信息框 (“请选择录像区域！”, #信息图标, )
            _按钮3_被单击 ()
            返回 ()
        .如果真结束
        载入 (窗口1, , 假)
        赋值 (_启动窗口., 假)
        动画制作.未知支持库函数_2 ()
        动画制作.未知支持库函数_1 ()
        赋值 (动画信息., 相减 (录像区域., 录像区域.))
        赋值 (动画信息., 相减 (录像区域., 录像区域.))
        赋值 (.宽度, 动画信息.)
        赋值 (.高度, 动画信息.)
        赋值 (动画信息., 真)
        赋值 (动画信息., “屏幕录像”)
        动画制作.未知支持库函数_0 (动画信息)
        赋值 (帧数量, 0)
        赋值 (延迟时间, 50)
        赋值 (上一图片, {  })
        连续赋值 (真, .禁止, .禁止, .禁止)
        赋值 (.禁止, 取反 (.禁止))
        赋值 (.时钟周期, 333)
        赋值 (.标题, “暂停”)
        “提示”.未知支持库函数_20 (“当前状态：录制中 F5”, 0, 0)
        赋值 (是否已经开始过, 真)
        赋值 (.禁止, 假)
    .判断 (.选中)
        .如果真 (并且 (等于 (录像区域., 0), 等于 (录像区域., 0)))
            信息框 (“请选择录像区域！”, #信息图标, )
            返回 ()
        .如果真结束
        连续赋值 (真, .禁止, .禁止, .禁止, .禁止)
        赋值 (.禁止, 取反 (.禁止))
        赋值 (.时钟周期, .位置)
        赋值 (.标题, “暂停”)
        “提示”.未知支持库函数_20 (“当前状态：录制中 F5”, 0, 0)
        赋值 (是否已经开始过, 真)
        赋值 (.禁止, 假)
    .默认
        
    .判断结束
    
.默认
    赋值 (_启动窗口..时钟周期, 0)
    赋值 (.标题, “开始”)
    “提示”.未知支持库函数_20 (“当前状态：暂停 F5”, 0, 0)
.判断结束


.子程序 _按钮2_被单击, 空白型, , 
 ' 托盘图标1.托盘信息框 (“提示”, “当前状态：已经停止 F6”, 0, 0)
_托盘图标1_托盘图标被双击 ()
赋值 (.禁止, 假)
赋值 (.时钟周期, 0)
赋值 (不显示, 真)
连续赋值 (假, .禁止, .禁止, .禁止, .禁止)
赋值 (.禁止, 真)
处理事件 ()
_按钮5_被单击 ()
赋值 (是否已经开始过, 假)
赋值 (.禁止, 真)
赋值 (注释, 到字节集 (“”))
赋值 (.标题, “开始”)

.子程序 _按钮3_被单击, 空白型, , 
赋值 (., 假)
高精度等待 (相乘 (500, 1000))
载入 (区域选择窗口, , 真)

.子程序 _时钟1_周期事件, 空白型, , 
.局部变量 x, 整数型, , , 
.局部变量 y, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 no, 空白型, , , 

处理事件 ()
.如果真 (等于 (.选中, 真))
    窗口1._时钟2_周期事件 ()
.如果真结束
.如果真 (.选中)
    .判断开始 (等于 (.选中, 真))
        .判断开始 (等于 (.现行选中项, 0))
            未知支持库函数_74 (录像区域, #., 相加 (取运行目录 (), “\Temp.bmp”))
            未知支持库函数_0 (相加 (取运行目录 (), “\Temp.bmp”), 相加 (取运行目录 (), “\Temp.jpg”), 假, .位置, 真, .位置)
            赋值 (bmp, 读入文件 (相加 (取运行目录 (), “\Temp.jpg”)))
            输出调试文本 (“JPG”)
        .判断 (等于 (.现行选中项, 1))
            未知支持库函数_74 (录像区域, #., 相加 (取运行目录 (), “\Temp.bmp”))
            未知支持库函数_3 (相加 (取运行目录 (), “\Temp.bmp”), 相加 (取运行目录 (), “\Temp.png”), 24)
        .默认
            
        .判断结束
        
    .默认
        输出调试文本 (“不压缩”)
        赋值 (bmp, 未知支持库函数_74 (录像区域, #., ))
    .判断结束
    赋值 (x, 取鼠标水平位置 ())
    赋值 (y, 取鼠标垂直位置 ())
    .判断开始 (等于 (简略, 真))
        .如果 (或者 (不等于 (bmp, 上一图片), 并且 (大于 (x, 录像区域.), 大于 (y, 录像区域.), 小于 (x, 录像区域.), 大于 (y, 录像区域.))))
            赋值 ()
            赋值 ()
            赋值 ()
            赋值 (载入图片 ())
            .画图片 (0, 0, , , )
            卸载图片 ()
            赋值 ()

.子程序 _按钮5_被单击, 空白型, , 
.局部变量 计次, 空白型, , , 

.如果 (等于 (录像格式, “GIF”))
    赋值 (.默认文件后缀, “gif”)
    赋值 (.初始过滤器, 0)
    .如果真 (打开 ())
        动画制作.未知支持库函数_4 (.文件名)
    .如果真结束
    
.否则
    赋值 (.默认文件后缀, “avi”)
    赋值 (.初始过滤器, 1)
    赋值 (计次, 0)
    .如果真 (打开 ())
        处理事件 ()
        BMP到AVI (.文件名, BMP2, , 3, &显示进度)
        高精度等待 (500)
        .计次循环首 (取数组成员数 (BMP2), 计次)
            删除文件 (BMP2 [计次])
        .计次循环尾 ()
        重定义数组 (BMP2, 假, 0)
    .如果真结束
    
.如果结束
赋值 (是否结束, 真)

.子程序 显示进度, 空白型, , 
.参数 总帧数, 空白型, , 
.参数 当前帧, 空白型, , 
.参数 未用1, 空白型, , 
.参数 未用2, 空白型, , 

赋值 (_启动窗口., 相加 (“完成进度: ”, 到文本 (取整 (相除 (相乘 (当前帧, 100), 总帧数))), “%”))
处理事件 ()


.子程序 BMP到AVI, 空白型, , 
.参数 AVI保存文件名, 文本型, , 
.参数 BMP文件名数组, 文本型, 数组, 所有位图必须尺寸相等
.参数 WAV文件名, 文本型, 可空, 
.参数 帧速率, 整数型, , 帧/秒
.参数 进度显示子程序, 子程序指针, 可空, 

.局部变量 strhdrVideo, AVISTREAMINFO, , , 
.局部变量 strhdrAudio, AVISTREAMINFO, , , 
.局部变量 nFrames, 整数型, , , 
.局部变量 hr, 空白型, , , 
.局部变量 a, 整数型, , , 
.局部变量 bmpFileHdr, 字节集, , , 
.局部变量 bmpInfoHdr, 字节集, , , 
.局部变量 waveFormat, 字节集, , , 
.局部变量 BMP文件号, 空白型, , , 
.局部变量 WAV文件号, 空白型, , , 
.局部变量 tmp_buf, 字节集, , , 
.局部变量 pfile, 空白型, , , 
.局部变量 psV, 空白型, , , 
.局部变量 psA, 空白型, , , 
.局部变量 streamtypeVIDEO, 整数型, , , 
.局部变量 streamtypeAUDIO, 整数型, , , 
.局部变量 tmp, 字节集, , , 
.局部变量 w, 空白型, , , 
.局部变量 h, 空白型, , , 
.局部变量 s, 空白型, , , 

赋值 (tmp, 取空白字节集 (4))
赋值 (tmp [1], 取代码 (“v”, ))
赋值 (tmp [2], 取代码 (“i”, ))
赋值 (tmp [3], 取代码 (“d”, ))
赋值 (tmp [4], 取代码 (“s”, ))
赋值 (streamtypeVIDEO, 取字节集数据 (tmp, #整数型, ))

AVIFileInit ()

.计次循环首 (取数组成员数 (BMP文件名数组), a)
    .如果真 (等于 (文件是否存在 (BMP文件名数组 [a]), 假))
        输出调试文本 (相加 (BMP文件名数组 [a], “ 不存在！”))
        返回 ()
    .如果真结束
    赋值 (BMP文件号, 打开文件 (BMP文件名数组 [a], , ))
    移到文件首 (BMP文件号)
    赋值 (bmpFileHdr, 读入字节集 (BMP文件号, 14))
    赋值 (bmpInfoHdr, 读入字节集 (BMP文件号, 40))
    
    赋值 (w, 取字节集数据 (bmpInfoHdr, #整数型, 5))
    赋值 (h, 取字节集数据 (bmpInfoHdr, #整数型, 9))
    赋值 (s, 相减 (取字节集数据 (bmpFileHdr, #整数型, 3), 54))
    
    .如果真 (等于 (nFrames, 0))
        AVIFileOpen (pfile, AVI保存文件名, 4097, 0)
        赋值 (strhdrVideo.fccType, streamtypeVIDEO)
        赋值 (strhdrVideo.fccHandler, 0)
        赋值 (strhdrVideo.dwScale, 1)
        赋值 (strhdrVideo.dwRate, 帧速率)
        赋值 (strhdrVideo.dwSuggestedBufferSize, s)
        赋值 (strhdrVideo.rcFrame.left, 0)
        赋值 (strhdrVideo.rcFrame.top, 0)
        赋值 (strhdrVideo.rcFrame.right, w)
        赋值 (strhdrVideo.rcFrame.bottom, h)
        
        赋值 (hr, AVIFileCreateStream (pfile, psV, strhdrVideo))
        
    .如果真结束
    
    赋值 (tmp_buf, 读入字节集 (BMP文件号, s))
    赋值 (hr, AVIStreamSetFormat (psV, nFrames, bmpInfoHdr, 40))
    赋值 (hr, AVIStreamWrite (psV, nFrames, 1, tmp_buf, s, 16, 0, 0))
    
    赋值 (nFrames, 相加 (nFrames, 1))
    关闭文件 (BMP文件号)
    .如果真 (等于 (是否为空 (进度显示子程序), 假))
        CallWindowProcA (进度显示子程序, 取数组成员数 (BMP文件名数组), a, 0, 0)
    .如果真结束
    
.计次循环尾 ()
.如果真 (等于 (是否为空 (WAV文件名), 假))
    赋值 (tmp, 取空白字节集 (4))
    赋值 (tmp [1], 取代码 (“a”, ))
    赋值 (tmp [2], 取代码 (“u”, ))
    赋值 (tmp [3], 取代码 (“d”, ))
    赋值 (tmp [4], 取代码 (“s”, ))
    赋值 (streamtypeAUDIO, 取字节集数据 (tmp, #整数型, ))
    
    赋值 (WAV文件号, 打开文件 (WAV文件名, , ))
    移到文件首 (WAV文件号)
    赋值 (tmp, 读入字节集 (WAV文件号, 20))
    赋值 (s, 取字节集数据 (tmp, #整数型, 17))
    赋值 (waveFormat, 读入字节集 (WAV文件号, s))
    
    赋值 (w, 取字节集数据 (waveFormat, #短整数型, 3)) ' ; //声道数
    赋值 (h, 取字节集数据 (waveFormat, #整数型, 5)) ' ; //Hz 采样频率
    赋值 (s, 相减 (相加 (取字节集数据 (tmp, #整数型, 5), 8), 取字节集长度 (tmp), 取字节集长度 (waveFormat))) ' m_dwBufferSize
    
     ' //设置音频流格式
    赋值 (strhdrAudio.fccType, streamtypeAUDIO)
    赋值 (strhdrAudio.fccHandler, 0)
    赋值 (strhdrAudio.dwFlags, 0)
    赋值 (strhdrAudio.dwCaps, 0)
    赋值 (strhdrAudio.wPriority, 0)
    赋值 (strhdrAudio.wLanguage, 0)
    赋值 (strhdrAudio.dwScale, w)
    赋值 (strhdrAudio.dwRate, h)
    赋值 (strhdrAudio.dwStart, 0)
    赋值 (strhdrAudio.dwInitialFrames, 0)
    赋值 (strhdrAudio.dwSuggestedBufferSize, s)
    赋值 (strhdrAudio.dwQuality, 0)
    赋值 (strhdrAudio.dwSampleSize, 1)
    赋值 (strhdrAudio.rcFrame.bottom, 0)
    赋值 (strhdrAudio.rcFrame.left, 0)
    赋值 (strhdrAudio.rcFrame.right, 0)
    赋值 (strhdrAudio.rcFrame.top, 0)
    赋值 (strhdrAudio.dwEditCount, 0)
    赋值 (strhdrAudio.dwFormatChangeCount, 0)
    赋值 (strhdrAudio.dwLength, 0)
    
     ' //创建数据流
    赋值 (hr, AVIFileCreateStream (pfile, psA, strhdrAudio))
    
     ' //设置音频格式
    赋值 (hr, AVIStreamSetFormat (psA, 0, waveFormat, 取字节集长度 (waveFormat)))
    
     ' //写数据
    赋值 (tmp_buf, 读入字节集 (WAV文件号, s))
    赋值 (hr, AVIStreamWrite (psA, 0, 1, tmp_buf, s, 16, 0, 0))
    
    关闭文件 (WAV文件号)
    AVIStreamRelease (psA)
    
.如果真结束

AVIStreamRelease (psV)
.如果真 (不等于 (pfile, 0))
    AVIFileRelease (pfile)
.如果真结束
AVIFileExit ()




.子程序 _选择框1_被单击, 空白型, , 
赋值 (.禁止, 取反 (.选中))

.子程序 _组合框1_列表项被选择, 空白型, , 
写配置项 (相加 (取运行目录 (), “\ScreenRecord.ini”), “单帧处理”, “压缩格式”, .取项目文本 (.现行选中项))
.如果 (等于 (.现行选中项, 1))
    连续赋值 (真, .禁止, .禁止)
.否则
    连续赋值 (假, .禁止, .禁止)
.如果结束
输出调试文本 (.现行选中项)


.子程序 _滑块条1_位置被改变, 空白型, , 
赋值 (.标题, 相加 (“JPG压缩 ”, 到文本 (.位置)))

.子程序 _滑块条2_位置被改变, 空白型, , 
赋值 (.标题, 相加 (“JPG柔化 ”, 到文本 (.位置)))

.子程序 _按钮6_被单击, 空白型, , 
信息框 (“配置保存成功！”, 0, )

.子程序 _单选框2_被单击, 空白型, , 
.局部变量 a, 文本型, , , 

.如果真 (.选中)
    赋值 (.禁止, 真)
.如果真结束


.子程序 _单选框1_被单击, 空白型, , 
.局部变量 a, 文本型, , , 

.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束


.子程序 __启动窗口_将被销毁, 空白型, , 
.局部变量 a, 文本型, , , 
.局部变量 File, 文本型, , , 

写配置项 (相加 (取运行目录 (), “\ScreenRecord.ini”), “单帧处理”, “是否压缩”, 到文本 (.选中))
写配置项 (相加 (取运行目录 (), “\ScreenRecord.ini”), “单帧处理”, “压缩格式”, 到文本 (.现行选中项))
写配置项 (相加 (取运行目录 (), “\ScreenRecord.ini”), “单帧处理”, “JPG压缩”, 到文本 (.位置))
写配置项 (相加 (取运行目录 (), “\ScreenRecord.ini”), “单帧处理”, “JPG柔化”, 到文本 (.位置))
结束 ()

.子程序 高精度等待, 空白型, , 
.参数 微秒, 整数型, , 1000微秒 = 1毫秒 ； 1000毫秒 = 1秒

.局部变量 hTimer, 整数型, , , 
.局部变量 int64, LARGE_INTEGER, , , 

赋值 (int64.QuadPart, 相乘 (-10, 微秒))
赋值 (hTimer, CreateWaitableTimerA (0, 假, 0))
SetWaitableTimer (hTimer, int64, 0, 0, 0, 假)
.判断循环首 (不等于 (MsgWaitForMultipleObjects (1, hTimer, 假, #INFINITE, #QS_ALLINPUT), #WAIT_OBJECT_0))
    处理事件 ()
.判断循环尾 ()
CloseHandle (hTimer)

.子程序 _按钮8_被单击, 空白型, , 
.判断开始 (等于 (.禁止, 假))
    .判断开始 (等于 (.标题, “暂停”))
        “提示”.未知支持库函数_20 (相加 (“当前状态：添加注释”, #换行符, “当前状态：暂停”), 0, 0)
        _启动窗口._按钮1_被单击 ()
        载入 (窗口2, , 假)
    .默认
        载入 (窗口2, , 假)
    .判断结束
    
.默认
    
.判断结束




.子程序 _滑块条3_位置被改变, 空白型, , 
赋值 (.标题, 相加 (到文本 (.位置), “秒/频”))

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
退出界面库 ()
结束 ()

.子程序 _标签1_反馈事件, 整数型, , 
.参数 参数一, 整数型, , 
.参数 参数二, 整数型, , 


.如果 (等于 (参数一, 热键标识1))
    _启动窗口._按钮1_被单击 () ' 暂停开始
.否则
    
.如果结束
.如果 (等于 (参数一, 热键标识2))
    _启动窗口._按钮2_被单击 () ' 停止
    
.否则
    
.如果结束
.如果 (等于 (参数一, 热键标识3))
    _启动窗口._按钮8_被单击 ()
.否则
    
.如果结束
.如果 (等于 (参数一, 热键标识4))
    .判断开始 (等于 (.选中, 真))
        “提示”.未知支持库函数_20 (相加 (“当前状态：动态窗口录制（F8）”, #换行符, “若固定窗口录制请按（F8）”), 0, 0)
        赋值 (.选中, 假)
        赋值 (.选中, 真)
    .默认
        赋值 (.选中, 真)
        赋值 (.选中, 假)
        “提示”.未知支持库函数_20 (相加 (“当前状态：固定窗口录制（F8）”, #换行符, “若动态窗口录制请按（F8）”), 0, 0)
    .判断结束
    
.否则
    
.如果结束


.子程序 _托盘图标1_托盘图标被双击, 空白型, , 
赋值 (_启动窗口., 真)

.子程序 _显示_被选择, 空白型, , 
赋值 (_启动窗口., 0)
赋值 (_启动窗口., 真)

.子程序 _退出_被选择, 空白型, , 
退出界面库 ()
结束 ()

.子程序 _托盘图标1_托盘图标被右击, 空白型, , 
弹出菜单 ()


.子程序 __启动窗口_位置被改变, 空白型, , 
.判断开始 (等于 (_启动窗口., 2))
    赋值 (_启动窗口., 假)
    “提示”.未知支持库函数_20 (“隐藏”, 0, 0)
.默认
    
.判断结束






.子程序 _选择框2_被单击, 空白型, , 
.判断开始 (等于 (.选中, 真))
    赋值 (简略, 真)
.默认
    赋值 (简略, 假)
.判断结束


.窗口程序集 窗口程序集2, , , 

.程序集变量 起始, 空白型, , "2", 
.程序集变量 结束, 空白型, , "2", 
.程序集变量 按下, 逻辑型, , , 
.子程序 _区域选择窗口_创建完毕, 空白型, , 
移动 (0, 0, 取屏幕宽度 (), 取屏幕高度 ())
0.移动 (0, 取用户区宽度 (), 取用户区高度 ())
赋值 (.底图, 快照 ())


.子程序 _画板1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (按下, 真)
赋值 (起始 [1], 横向位置)
赋值 (起始 [2], 纵向位置)


.子程序 _画板1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (按下, 真))
    .清除 ()
    起始.画矩形 ( [1], 起始 [2], 横向位置, 纵向位置)
    输出调试文本 (相加 (“起始X:”, 到文本 (起始 [1])))
    输出调试文本 (相加 (“起始Y:”, 到文本 (起始 [2])))
    输出调试文本 (相加 (“结束X”, 到文本 (横向位置)))
    输出调试文本 (相加 (“结束Y”, 到文本 (纵向位置)))
.如果真结束


.子程序 _画板1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (按下, 假)
.清除 ()
起始.画矩形 ( [1], 起始 [2], 横向位置, 纵向位置)
赋值 (结束 [1], 横向位置)
赋值 (结束 [2], 纵向位置)


.子程序 _按钮1_被单击, 空白型, , 
.判断开始 (小于 (起始 [1], 结束 [1]))
    赋值 (录像区域., 起始 [1])
    赋值 (录像区域., 起始 [2])
    赋值 (录像区域., 结束 [1])
    赋值 (录像区域., 结束 [2])
.默认
    赋值 (录像区域., 结束 [1])
    赋值 (录像区域., 结束 [2])
    赋值 (录像区域., 起始 [1])
    赋值 (录像区域., 起始 [2])
.判断结束




销毁 ()

.子程序 _按钮2_被单击, 空白型, , 
.清除 ()

.子程序 _按钮3_被单击, 空白型, , 
销毁 ()

.子程序 _区域选择窗口_将被销毁, 空白型, , 
赋值 (_启动窗口., 真)

.子程序 _画板1_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_按钮1_被单击 ()


.窗口程序集 窗口程序集5, , , 

.程序集变量 临时画板, 画板, , , 
.子程序 _窗口1_创建完毕, 空白型, , 
.局部变量 Lst, 字节集, , , 

未知支持库函数_66 (窗口1.取窗口句柄 (), 255)
.判断开始 (小于 (录像区域., 录像区域.))
    赋值 (窗口1., 相减 (录像区域., 2))
    赋值 (窗口1., 相加 (到整数 (相减 (录像区域., 录像区域.)), 4))
    赋值 (窗口1., 相减 (录像区域., 2))
    赋值 (窗口1., 相加 (到整数 (相减 (录像区域., 录像区域.)), 4))
.默认
    赋值 (窗口1., 相加 (录像区域., 2))
    赋值 (窗口1., 相加 (到整数 (相减 (录像区域., 录像区域.)), 4))
    赋值 (窗口1., 录像区域.)
    赋值 (窗口1., 相加 (到整数 (相减 (录像区域., 录像区域.)), 4))
.判断结束

赋值 (窗口1., 真)
复制窗口组件 (临时画板)
赋值 (临时画板.画板背景色, #嫩绿)
赋值 (临时画板.自动重画, 真)
赋值 (临时画板.可视, 假)
赋值 (临时画板.顶边, 0)
赋值 (临时画板.左边, 0)
赋值 (临时画板.高度, 窗口1.)
赋值 (临时画板.宽度, 窗口1.)
销毁 ()
赋值 (_启动窗口., 真)
临时画板.画矩形 (2, 2, 相减 (窗口1., 2), 相减 (窗口1., 2))
赋值 (Lst, 临时画板.取图片 ())
窗口1.置外形图片 (Lst, #黑色)
.判断开始 (等于 (_启动窗口..选中, 真))
    赋值 (.时钟周期, 1)
.默认
    赋值 (.时钟周期, 0)
.判断结束


.子程序 _时钟1_周期事件, 空白型, , 
.判断开始 (等于 (_启动窗口..选中, 真))
    赋值 (.时钟周期, 1)
.默认
    赋值 (.时钟周期, 0)
.判断结束
.判断开始 (不等于 (窗口1., #绿色))
    赋值 (窗口1., #绿色)
.默认
    赋值 (窗口1., #嫩绿)
.判断结束
.判断开始 (等于 (不显示, 真))
    赋值 (窗口1., 假)
.默认
    
.判断结束
.判断开始 (等于 (是否结束, 真))
    赋值 (不显示, 假)
    赋值 (是否结束, 假)
    窗口1.销毁 ()
.默认
    
.判断结束


.子程序 _时钟2_周期事件, 空白型, , 
.局部变量 临时数据, 整数型, , , 

处理事件 ()
赋值 (录像区域., 相加 (窗口1., 2))
赋值 (录像区域., 相加 (窗口1., 2))
赋值 (录像区域., 相减 (相加 (窗口1., 窗口1.), 4))
赋值 (录像区域., 相减 (相加 (窗口1., 窗口1.), 4))
.如果 (小于 (相减 (取鼠标水平位置 (), 窗口1.), 相除 (窗口1., 4)))
    赋值 (临时数据, 相减 (取鼠标水平位置 (), 相除 (窗口1., 4)))
    .判断开始 (大于 (临时数据, 0))
        赋值 (窗口1., 临时数据)
    .默认
        赋值 (窗口1., -2)
    .判断结束
    
.否则
    
.如果结束
.如果 (小于 (相减 (取鼠标垂直位置 (), 窗口1.), 相除 (窗口1., 4)))
    赋值 (临时数据, 相减 (取鼠标垂直位置 (), 相除 (窗口1., 4)))
    .判断开始 (大于 (临时数据, 0))
        赋值 (窗口1., 临时数据)
    .默认
        赋值 (窗口1., -2)
    .判断结束
    
.否则
    
.如果结束
.如果 (大于 (相减 (取鼠标水平位置 (), 窗口1.), 相乘 (相除 (窗口1., 4), 3)))
    赋值 (临时数据, 相减 (取鼠标水平位置 (), 相乘 (相除 (窗口1., 4), 3)))
    .判断开始 (大于 (临时数据, 相减 (取屏幕宽度 (), 窗口1.)))
        赋值 (窗口1., 相加 (相减 (取屏幕宽度 (), 窗口1.), 2))
    .默认
        赋值 (窗口1., 相加 (临时数据, 2))
    .判断结束
    
.否则
    
.如果结束
.如果 (大于 (相减 (取鼠标垂直位置 (), 窗口1.), 相乘 (相除 (窗口1., 4), 3)))
    赋值 (临时数据, 相减 (取鼠标垂直位置 (), 相乘 (相除 (窗口1., 4), 3)))
    .判断开始 (大于 (临时数据, 相减 (取屏幕高度 (), 窗口1.)))
        赋值 (窗口1., 相加 (相减 (取屏幕高度 (), 窗口1.), 2))
    .默认
        赋值 (窗口1., 相加 (临时数据, 2))
    .判断结束
    
.否则
    
.如果结束


.窗口程序集 窗口程序集3, , , 

.程序集变量 移动, 逻辑型, , , 
.程序集变量 画矩形, 逻辑型, , , 
.程序集变量 矩形数据, 未知类型0x5000D, , , 
.程序集变量 是否还没写, 逻辑型, , , 
.子程序 _窗口2_创建完毕, 空白型, , 
.局部变量 文件号, 整数型, , , 

赋值 (.画笔颜色, .颜色)
赋值 (.宽度, 相减 (录像区域., 录像区域.))
赋值 (.高度, 相减 (录像区域., 录像区域.))
赋值 (.自动重画, 真)
赋值 (文件号, 载入图片 (_启动窗口.))
文件号.画图片 (0, 0, , , )
赋值 (.自动重画, 真)
卸载图片 (文件号)
赋值 (.文本颜色, .颜色)

.子程序 _画板1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (移动, 假)
.判断开始 (并且 (等于 (.选中, 假), 等于 (.选中, 假)))
    赋值 (移动, 真)
.判断 (等于 (.选中, 真))
    赋值 (画矩形, 真)
    赋值 (矩形数据., 横向位置)
    赋值 (矩形数据., 纵向位置)
    赋值 (.底图, .取图片 ())
.默认
    赋值 (.选中, 假)
    赋值 (.内容, “”)
    赋值 (.可视, 假)
.判断结束



.子程序 _画板1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (移动)
    161.发送信息 (2, 0)
.否则
    
.如果结束
.如果 (画矩形)
    .清除 ()
    矩形数据.画矩形 (., 矩形数据., 横向位置, 纵向位置)
.否则
    
.如果结束
.判断开始 (等于 (.选中, 真))
    .判断开始 (等于 (是否还没写, 真))
        赋值 (.底图, .取图片 ())
        赋值 (是否还没写, 假)
    .默认
        
    .判断结束
    
    .清除 ()
    横向位置.定位写出 (纵向位置, .内容)
.默认
    
.判断结束


.子程序 _画板1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (移动, 假)
.判断开始 (等于 (画矩形, 真))
    赋值 (画矩形, 假)
    赋值 (.选中, 假)
.默认
    
.判断结束


.子程序 _按钮1_被单击, 空白型, , 
_窗口2_创建完毕 ()

.子程序 _单选框2_被单击, 空白型, , 
赋值 (.可视, 真)
赋值 (是否还没写, 真)


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 文件号, 整数型, , , 

赋值 (文件号, 载入图片 (.取图片 ()))
文件号.画图片 (0, 0, , , )
赋值 (.自动重画, 真)
卸载图片 (文件号)
赋值 (_启动窗口., .取图片 ())
赋值 (_启动窗口., 相乘 (到整数 (.内容), 100))
_启动窗口._时钟1_周期事件 ()
_启动窗口._按钮1_被单击 ()
窗口2.销毁 ()

.子程序 _颜色选择器1_颜色被改变, 空白型, , 
赋值 (.画笔颜色, .颜色)
赋值 (.文本颜色, .颜色)

.子程序 _窗口2_可否被关闭, 逻辑型, , 
_启动窗口._按钮1_被单击 ()


 ' 不属于任何一个程序集、类模块的函数：
