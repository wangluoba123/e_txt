 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 747
    高度 = 582
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 6 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 6 扩展界面支持库一



 ' 所需要的模块
 ' 文本操作类 K:\制作\模块源代码\文本\例程\文本操作模块.ec



.窗口程序集 窗口程序集1, , , 

.程序集变量 文件, 文本型, , , 
.程序集变量 位置变量, 整数型, , , 
.程序集变量 文本, 未知类型0x49010068, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 


.子程序 _按钮1_被单击, 空白型, , 
赋值 (.内容, 文本.未知函数_67174402 (文件, 到数值 (.内容)))
赋值 (., 相减 (到数值 (.内容), 1))
.保证显示 (.)

.子程序 _按钮2_被单击, 空白型, , 
文本.未知函数_67174405 (文件, 到数值 (.内容), 到字节集 (.内容))
赋值 (位置变量, 相减 (到数值 (.内容), 1))
显示数据 ()

.子程序 _按钮3_被单击, 空白型, , 
文本.未知函数_67174407 (文件, 到数值 (.内容), 到字节集 (.内容))
赋值 (位置变量, 相减 (到数值 (.内容), 1))
显示数据 ()

.子程序 _按钮4_被单击, 空白型, , 
文本.未知函数_67174408 (文件, 到数值 (.内容))
赋值 (位置变量, 相减 (到数值 (.内容), 1))
显示数据 ()


.子程序 _按钮5_被单击, 空白型, , 
.局部变量 文件号, 整数型, , , 

文本.未知函数_67174406 (文件)
显示数据 ()

.子程序 _按钮6_被单击, 空白型, , 
.局部变量 是否显示, 逻辑型, , , 

赋值 (.过滤器, “*.txt;*.ini|*.txt;*.ini”)
打开 ()
赋值 (文件, .文件名)
.如果真 (取反 (是否显示))
    未知函数_67174567 ()
.如果真结束


.子程序 显示数据, 空白型, , 
.局部变量 a, 文本型, , , 
.局部变量 i, 整数型, , , 
.局部变量 b, 文本型, , "0", 

赋值 (.内容, “”)
全部删除 ()
.未知函数_67174550 ()
赋值 (.内容, )
.计次循环首 (.未知函数_67174551 (), )
    赋值 (分割文本 (#换行符, ))
    相减 (1).插入表项 (到文本 (), , , , )
    相减 (1).置标题 (1,  [)])

.类模块 文本操作类, , , 

.子程序 读取指定行, 文本型, , 
.参数 欲打开的文件名称, 文本型, , 
.参数 指定行位置, 整数型, , 读取指定行的文本



.子程序 读全部数据, 逻辑型, , 
.参数 欲打开的文件名称, 文本型, , 
.参数 取回内容, 文本型, , 



.子程序 取文本行数, 整数型, , 
.参数 欲打开的文件名称, 文本型, , 



.子程序 插入指定行, 逻辑型, , 
.参数 欲打开的文件名称, 文本型, , 
.参数 指定行位置, 整数型, 可空, 默认为0（首位置）
.参数 欲写出的字节集数据, 字节集, 可空, 



.子程序 数据清空, 逻辑型, , 
.参数 欲打开的文件名称, 文本型, , 



.子程序 修改指定行, 逻辑型, , 
.参数 欲打开的文件名称, 文本型, , 
.参数 指定位置, 整数型, , 
.参数 欲写出的字节集数据, 字节集, , 



.子程序 删除指定行, 逻辑型, , 
.参数 欲打开的文件名称, 文本型, , 
.参数 指定位置, 整数型, , 



.子程序 字符填充, 文本型, , 
.参数 数值, 文本型, , 
.参数 填充长度, 长整数型, , 
.参数 填充字符, 文本型, , 




 ' 不属于任何一个程序集、类模块的函数：
