 ' 文件类型：Windows窗口程序

 ' 程序名称：图书管理软件
 ' 程序描述：
 ' 程序作者：侯照俊
 ' 邮政编码：666300
 ' 联系地址：云南省勐海县人武部
 ' 联系电话：13887919355
 ' 传真号码：
 ' 电子信箱：hzj1966@126.com
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 主窗口 ' 在程序启动后自动调入本窗口
    左边 = 0
    顶边 = 0
    宽度 = 1024
    高度 = 744
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 0
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 真
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\主窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 登陆窗口
    左边 = 50
    顶边 = 50
    宽度 = 340
    高度 = 200
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “登陆”
    帮助文件名 = “”

窗口 注册窗口
    左边 = 50
    顶边 = 50
    宽度 = 340
    高度 = 200
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\注册窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “软件注册”
    帮助文件名 = “”

窗口 提示窗口
    左边 = 50
    顶边 = 50
    宽度 = 340
    高度 = 200
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\提示窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “提示信息”
    帮助文件名 = “”

窗口 注册信息查看窗口
    左边 = 50
    顶边 = 50
    宽度 = 340
    高度 = 198
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\注册信息查看窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 参数设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 472
    高度 = 500
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\参数设置窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “系统参数设置”
    帮助文件名 = “”

窗口 修改密码窗口
    左边 = 50
    顶边 = 50
    宽度 = 340
    高度 = 200
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\修改密码窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “修改密码”
    帮助文件名 = “”

窗口 用户更名窗口
    左边 = 50
    顶边 = 50
    宽度 = 340
    高度 = 200
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\用户更名窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “更改用户名”
    帮助文件名 = “”

窗口 用户管理窗口
    左边 = 50
    顶边 = 50
    宽度 = 300
    高度 = 367
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\用户管理窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “管理用户”
    帮助文件名 = “”

窗口 查看日志窗口
    左边 = 50
    顶边 = 50
    宽度 = 552
    高度 = 500
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\查看日志窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “系统日志”
    帮助文件名 = “”

窗口 日志管理窗口
    左边 = 50
    顶边 = 50
    宽度 = 552
    高度 = 500
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\日志管理窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “管理日志”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 410
    高度 = 370
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\关于窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “产品信息”
    帮助文件名 = “”

窗口 进度指示窗口
    左边 = 50
    顶边 = 50
    宽度 = 600
    高度 = 150
    鼠标指针 = { 2,127,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\进度指示窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 查找窗口
    左边 = 50
    顶边 = 50
    宽度 = 410
    高度 = 370
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\查找窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “查找图书”
    帮助文件名 = “”

窗口 统计窗口
    左边 = 50
    顶边 = 50
    宽度 = 410
    高度 = 370
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\统计窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “图书统计结果”
    帮助文件名 = “”

窗口 校验窗口
    左边 = 50
    顶边 = 50
    宽度 = 410
    高度 = 370
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\校验窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “校验图书库”
    帮助文件名 = “”

窗口 排序窗口
    左边 = 50
    顶边 = 50
    宽度 = 300
    高度 = 370
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\排序窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “图书排序”
    帮助文件名 = “”

窗口 置打印表头窗口
    左边 = 50
    顶边 = 50
    宽度 = 410
    高度 = 370
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\置打印表头窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “设置表头”
    帮助文件名 = “”

窗口 查询图书窗口
    左边 = 50
    顶边 = 50
    宽度 = 410
    高度 = 370
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\查询图书窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “图书查询”
    帮助文件名 = “”

窗口 查询图书结果窗口
    左边 = 50
    顶边 = 50
    宽度 = 900
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\查询图书结果窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “查询图书结果”
    帮助文件名 = “”

窗口 删除条件窗口
    左边 = 50
    顶边 = 50
    宽度 = 411
    高度 = 200
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\删除条件窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “删除条件”
    帮助文件名 = “”

窗口 会员查找窗口
    左边 = 50
    顶边 = 50
    宽度 = 410
    高度 = 370
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\会员查找窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “查找会员”
    帮助文件名 = “”

窗口 会员统计窗口
    左边 = 50
    顶边 = 50
    宽度 = 410
    高度 = 370
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\会员统计窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “会员统计结果”
    帮助文件名 = “”

窗口 会员排序窗口
    左边 = 50
    顶边 = 50
    宽度 = 300
    高度 = 370
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\会员排序窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “会员排序”
    帮助文件名 = “”

窗口 会员校验窗口
    左边 = 50
    顶边 = 50
    宽度 = 410
    高度 = 370
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\会员校验窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “校验会员库”
    帮助文件名 = “”

窗口 查询会员窗口
    左边 = 50
    顶边 = 50
    宽度 = 410
    高度 = 370
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\查询会员窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “查询会员”
    帮助文件名 = “”

窗口 添加用户窗口
    左边 = 50
    顶边 = 50
    宽度 = 340
    高度 = 200
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\添加用户窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “添加用户”
    帮助文件名 = “”

窗口 查看密码窗口
    左边 = 50
    顶边 = 50
    宽度 = 340
    高度 = 200
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\查看密码窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “查看密码”
    帮助文件名 = “”

窗口 恢复窗口
    左边 = 50
    顶边 = 50
    宽度 = 340
    高度 = 200
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\恢复窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “密码验证”
    帮助文件名 = “”

窗口 打印借书证窗口
    左边 = 50
    顶边 = 50
    宽度 = 472
    高度 = 498
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 16184015 '  0xF6F2CF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\打印借书证窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “打印借书证”
    帮助文件名 = “”

窗口 启动信息窗口
    左边 = 30
    顶边 = 30
    宽度 = 301
    高度 = 393
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\启动信息窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “软件启动信息”
    帮助文件名 = “”

窗口 借阅统计窗口
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 500
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\借阅统计窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “借阅统计”
    帮助文件名 = “”

窗口 办证窗口
    左边 = 50
    顶边 = 50
    宽度 = 450
    高度 = 310
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\办证窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “办理借书证”
    帮助文件名 = “”

窗口 查看经费窗口
    左边 = 50
    顶边 = 50
    宽度 = 551
    高度 = 500
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\查看经费窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “查看经费”
    帮助文件名 = “”

窗口 打印书号窗口
    左边 = 50
    顶边 = 50
    宽度 = 450
    高度 = 310
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 16184015 '  0xF6F2CF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\打印书号窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “打印书号”
    帮助文件名 = “”

窗口 查询会员结果窗口
    左边 = 50
    顶边 = 50
    宽度 = 900
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\查询会员结果窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “会员查询结果”
    帮助文件名 = “”

窗口 帮助窗口
    左边 = 0
    顶边 = 0
    宽度 = 1024
    高度 = 744
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\帮助窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “帮助”
    帮助文件名 = “”

窗口 备份选项窗口
    左边 = 50
    顶边 = 50
    宽度 = 340
    高度 = 200
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\备份选项窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “备份选项”
    帮助文件名 = “”

窗口 恢复选项窗口
    左边 = 50
    顶边 = 50
    宽度 = 340
    高度 = 200
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\恢复选项窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “备份选项”
    帮助文件名 = “”



.常量 LWA_ALPHA, "2", , 
.图片 图片1, " ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\图片1", , 
.图片 图片2, " ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\图片2", , 
.图片 图片3, " ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\图片3", , 
.图片 图片4, " ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\图片4", , 
.图片 图片5, " ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\图片5", , 
.图片 图片6, " ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\图片6", , 
.图片 图片7, " ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\图片7", , 
.图片 图片8, " ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\图片8", , 
.图片 主窗口背景图, " ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\主窗口背景图", , 
.图片 图标, " ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\图标", , 
.图片 登陆窗口背景图, " ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\登陆窗口背景图", , 
.图片 提示窗口背景图, " ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\提示窗口背景图", , 
.图片 保存_禁止, " ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\保存_禁止", , 
.图片 保存_正常, " ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\保存_正常", , 
.图片 错误, " ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\错误", , 
.图片 警告, " ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\警告", , 
.图片 询问, " ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\询问", , 
.图片 信息, " ' 已保存到：D:\易语言学习\Data\图书管理软件v1.01.e\信息", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 2 6 扩展界面支持库三
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' iext5 {E5000198-4471-40e2-92BC-D0BA075BDBB2} 1 5 扩展界面支持库五
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 1 3 高级表格支持库
 ' eExcel2000 F86EC5989E044d42BC98C692C0B54727 1 0 EXCEL2000支持库
 ' eCompress 7B68736E818E41c5A28B0AE4D43C128C 1 1 压缩解压支持库
 ' RegEx 684944CB04624eb7BD5412A519421D34 1 2 正则表达式支持库
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库
 ' EChartBar 9A3F84D7FDEB4a0486F2711D5104B7F7 1 6 数据图表支持库
 ' shellEx DA19AC3ADD2F4121AAD84AC5FBCAFC71 2 1 扩展功能支持库一
 ' HtmlView 5014D8FA6DCA40b68FA626D8183666EB 1 1 超文本浏览框支持库




数据类型 逻辑字体_, , LOGFONT
    .成员 高度, 整数型, , , lfHeight
    .成员 宽度, 整数型, , , lfWidth
    .成员 控制摆, 整数型, , , lfEscapement
    .成员 定方位, 整数型, , , lfOrientation
    .成员 加粗, 整数型, , , lfWeight
    .成员 斜体, 字节型, , , lfItalic
    .成员 下划线, 字节型, , , lfUnderline
    .成员 袭击出, 字节型, , , lfStrikeOut
    .成员 零碎工作组合, 字节型, , , lfCharSet
    .成员 出自精确, 字节型, , , lfOutPrecision
    .成员 修剪精确, 字节型, , , lfClipPrecision
    .成员 性质, 字节型, , , lfQuality
    .成员 间距, 字节型, , , lfPitchAndFamily
    .成员 字体名称, 字节型, , "32", 用LF_FACESIZE,lfFaceName?

.全局变量 是否注册, 逻辑型, , , 
.全局变量 计算结果, 文本型, , , 计算注册码用
.全局变量 注册码, 文本型, , , 计算注册码用
.全局变量 软件名称, 文本型, , , 
.全局变量 运行目录, 文本型, , , 
.全局变量 使用单位, 文本型, , , 
.全局变量 是否VIP, 逻辑型, , , 
.全局变量 是否管理员, 逻辑型, , , 
.全局变量 字符位置1, 整数型, , , 计算注册码用
.全局变量 字符位置2, 整数型, , , 计算注册码用
.全局变量 操作者, 文本型, , , 
.全局变量 循环次数, 整数型, , , 
.全局变量 书名, 文本型, , , 
.全局变量 P1, 整数型, , , 普通会员限借册数
.全局变量 P2, 整数型, , , 普通会员限借天数
.全局变量 P3, 小数型, , , 普通会员押金
.全局变量 P4, 小数型, , , 普通会员丢失赔偿率
.全局变量 P5, 小数型, , , 普通会员损坏赔偿率
.全局变量 V1, 整数型, , , VIP限借册数
.全局变量 V2, 整数型, , , VIP限借天数
.全局变量 V3, 小数型, , , VIP押金
.全局变量 V4, 小数型, , , VIP丢失赔偿率
.全局变量 V5, 小数型, , , VIP损坏赔偿率
.全局变量 TSB, 整数型, , , 图书编号，自动编码部分长度
.全局变量 HYB, 整数型, , , 借书证编号，自动编码部分长度
.全局变量 提示窗口标题, 文本型, , , 
.全局变量 提示信息, 文本型, , , 
.全局变量 提示窗口返回值, 整数型, , , 提示窗口哪个按钮被单击“确定”、“是”等返回1，其它返回0
.全局变量 提示窗口按钮数, 整数型, , , 决定在提示窗口上显示几个按钮
.全局变量 提示窗口图标, 整数型, , , 1、错误；2、警告、3、询问、4、信息
.全局变量 表头标志, 文本型, , , 决定设置的表头传给哪个表格使用
.全局变量 图书添加操作, 逻辑型, , , 用户是否对图书库进行了添加操作
.全局变量 图书删除操作, 逻辑型, , , 用户是否对图书库进行了删除操作
.全局变量 图书修改操作, 逻辑型, , , 用户是否对图书库进行了修改操作
.全局变量 图书重新编号, 逻辑型, , , 用户是否对图书库进行了重新编辑操作
.全局变量 会员添加操作, 逻辑型, , , 用户是否对会员库进行了添加操作
.全局变量 会员删除操作, 逻辑型, , , 用户是否对会员库进行了删除操作
.全局变量 会员修改操作, 逻辑型, , , 用户是否对会员库进行了修改操作
.全局变量 会员重新编号, 逻辑型, , , 用户是否对会员库进行了重新编辑操作
.全局变量 图书校验是否通过, 逻辑型, , , 
.全局变量 会员校验是否通过, 逻辑型, , , 
.全局变量 图书备份成功, 逻辑型, , , 备份图书数据是否成功
.全局变量 会员备份成功, 逻辑型, , , 备份会员数据是否成功
.全局变量 ZDNR, 文本型, , , 
.全局变量 热键F5, 整数型, , , 

.DLL命令 Api_枚举字体, 整数型, "", "EnumFontsA", , 
    .参数 设备场景句柄, 整数型, , hdc,设备场景的句柄
    .参数 枚举的字体资源, 整数型, , lpszFamily,欲枚举的字体家族
    .参数 函数地址, 子程序指针, , lpEnumFontFamProc,欲调用的函数地址
    .参数 自定义值, 整数型, , lParam,指定希望传递给回调函数的一个用户自定义值

.DLL命令 Api_取设备场景句柄, 整数型, "", "GetDC", , 
    .参数 设备场景句柄, 整数型, , 

.DLL命令 Api_复制内存, 整数型, "", "RtlMoveMemory", , 
    .参数 目标区块, 逻辑字体_, , 
    .参数 源区块, 整数型, , 
    .参数 尺寸, 整数型, , 

.DLL命令 创建事件同步对象, 整数型, "", "CreateEventA", , 
    .参数 lpEventAttributes, 整数型, , 
    .参数 bManualReset, 逻辑型, , 
    .参数 bInitialState, 逻辑型, , 
    .参数 lpName, 文本型, , 

.DLL命令 打开事件同步对象, 整数型, "", "OpenEventA", , 
    .参数 dwDesiredAccess, 整数型, , 
    .参数 bInheritHandle, 逻辑型, , 
    .参数 lpName, 文本型, , 

.DLL命令 关闭同步事件对象, 整数型, "", "CloseHandle", , 
    .参数 hObject, 整数型, , 

.DLL命令 SetLayeredWindowAttributes, 整数型, "", "SetLayeredWindowAttributes", , 
    .参数 hwnd, 整数型, , 
    .参数 crKey, 整数型, , 
    .参数 bAlpha, 整数型, , 
    .参数 dwFlags, 整数型, , 

.DLL命令 GetWindowLong, 整数型, "", "GetWindowLongA", , 
    .参数 hwnd, 整数型, , 
    .参数 nIndex, 整数型, , 

.DLL命令 SetWindowLong, 整数型, "", "SetWindowLongA", , 
    .参数 hwnd, 整数型, , 
    .参数 nIndex, 整数型, , 
    .参数 dwNewLong, 整数型, , 

.窗口程序集 登陆窗口程序集, , , 

.子程序 _登陆窗口_创建完毕, 空白型, , 
赋值 (., #登陆窗口背景图)
置当前库 (“yhgl”)
到首记录 ()
.计次循环首 (取记录数 (), )
    读 (1).加入项目 ()
    跳过 (1)
.计次循环尾 ()

.子程序 _图形按钮2_被单击, 空白型, , 
.如果真 (取反 (是否已创建 (主窗口.)))
    全部关闭 ()
    结束 ()
.如果真结束
赋值 (主窗口.., -1)
登陆窗口.销毁 ()

.子程序 _编辑框1_获得焦点, 空白型, , 
.如果真 (未知支持库函数_0 (1))
    相加 (相除 (取屏幕宽度 (), 2), 60).未知支持库函数_26 (相加 (相除 (取屏幕高度 (), 2), 10), “大小写键已打开”, -1, )
.如果真结束


.子程序 _图形按钮1_被单击, 空白型, , 
.如果 (等于 (.内容, “”))
    赋值 (提示窗口图标, 4)
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示信息, “请选择一个用户名！”)
    载入 (提示窗口, , 真)
    获取焦点 ()
.否则
    .如果 (等于 (.内容, “”))
        赋值 (提示窗口图标, 4)
        赋值 (提示窗口标题, “提示！”)
        赋值 (提示信息, “请输入用户口令！”)
        载入 (提示窗口, , 真)
        获取焦点 ()
    .否则
        到首记录 ()
        查找 (等于 (读 (1), .内容))
        .如果 (等于 (读 (“口令”), .内容))
            赋值 (操作者, .内容)
            赋值 (是否管理员, 读 (3))
            .如果 (是否已创建 (主窗口.))
                未知支持库函数_11 (主窗口.取窗口句柄 (), 热键F5) ' 防止重新登陆热键失效。因为不撤销热键而再进行定义时，热键就会失效。
                赋值 (主窗口.., -1)
                _主窗口_创建完毕 ()
            .否则
                载入 (主窗口, , 假)
            .如果结束
            登陆窗口.销毁 ()
        .否则
            赋值 (提示窗口图标, 1)
            赋值 (提示窗口标题, “错误！”)
            赋值 (提示信息, “口令错误，请重新输入！”)
            载入 (提示窗口, , 真)
            赋值 (.被选择字符数, -1)
            获取焦点 ()
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 _编辑框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, 13))
    _图形按钮1_被单击 ()
.如果真结束
返回 (真)


.窗口程序集 主窗口程序集, , , 

.程序集变量 ZCK_N, 整数型, , , 循环计数器
.程序集变量 ZCK_M, 整数型, , , 循环计数器
.程序集变量 恢复是否成功, 逻辑型, , , 
.程序集变量 每屏行数, 整数型, , , 翻页用
.程序集变量 间隔, 整数型, , , 
.程序集变量 V借阅数量, 整数型, , , VIP会员已借阅尚未归还的图书数量
.程序集变量 P借阅数量, 整数型, , , 普通会员已借阅尚未归还的图书数量
.程序集变量 借阅时间, 文本型, , , 
.程序集变量 VIP, 逻辑型, , , 
.程序集变量 是否有选中项, 逻辑型, , , 
.程序集变量 随机数, 整数型, , , 
.程序集变量 会员编号基本码, 文本型, , , 
.程序集变量 图书编号基本码, 文本型, , , 
.程序集变量 书名拼音, 文本型, , , 
.程序集变量 姓名拼音, 文本型, , , 
.程序集变量 图书价值, 小数型, , , 
.程序集变量 能否删除, 逻辑型, , , 用于判断是否可以删除会员，原则是只要有图书未归还，就不准删除
.程序集变量 会员押金, 小数型, , , 会员办证是所交押金，在删除会员时应当退还，对应会员库的“办证押金”，这样做可以不受用户改变押金参数的影响。
.程序集变量 是否显示催还, 逻辑型, , , 当有会员超过借书期限时显示,否则不显示
.子程序 _主窗口_创建完毕, 空白型, , 
赋值 (热键F5, 未知支持库函数_10 (取窗口句柄 (), 取窗口句柄 (), 0, #F5键))
赋值 (., #主窗口背景图)
赋值 (会员校验是否通过, 真)
赋值 (图书校验是否通过, 真)
置随机数种子 ()
赋值 (随机数, 取随机数 (1, 8))
.如果真 (等于 (随机数, 1))
    赋值 (主窗口..图片, #图片1)
.如果真结束
.如果真 (等于 (随机数, 2))
    赋值 (主窗口..图片, #图片2)
.如果真结束
.如果真 (等于 (随机数, 3))
    赋值 (主窗口..图片, #图片3)
.如果真结束
.如果真 (等于 (随机数, 4))
    赋值 (主窗口..图片, #图片4)
.如果真结束
.如果真 (等于 (随机数, 5))
    赋值 (主窗口..图片, #图片5)
.如果真结束
.如果真 (等于 (随机数, 6))
    赋值 (主窗口..图片, #图片6)
.如果真结束
.如果真 (等于 (随机数, 7))
    赋值 (主窗口..图片, #图片7)
.如果真结束
.如果真 (等于 (随机数, 8))
    赋值 (主窗口..图片, #图片8)
.如果真结束
置当前库 (“tsglzz”)
加记录 (取现行时间 (), 操作者, “登陆成功。”)
.如果 (是否注册)
    2.未知支持库函数_10 (“注册信息”, 6)
    赋值 (.内容, 相加 (使用单位, #换行符, #换行符, “图书管理专用”))
    赋值 (.内容, 相加 (软件名称, “      使用权归 ”, 使用单位, “ 所有          操作员：”, 操作者))
.否则
    2.未知支持库函数_10 (“注册”, 6)
    赋值 (.内容, 相加 (软件名称, “　　　　　　　　　*未注册*”))
.如果结束
4.未知支持库函数_10 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “game01”, “自定义1...”), 5)
5.未知支持库函数_10 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “game02”, “自定义2...”), 5)
6.未知支持库函数_10 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “game03”, “自定义3...”), 5)
赋值 (., 到整数 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “系统环境”, “现行选中菜单”, )))
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (主窗口., 软件名称)
赋值 (.时钟周期, 500)

.子程序 创建表格, 空白型, , 
.参数 工作表, 未知类型0x80002, 参考, 

.局部变量 记次变量, 整数型, , , 

设置表格 (工作表, “A2”, “A2”)
赋值 (., 9)
赋值 (., 30)
赋值 (., -4108)
1.未知支持库函数_30 (2, 0)
赋值 (工作表., “图书编号”)
设置表格 (工作表, “B2”, “B2”)
赋值 (., 38)
赋值 (., -4108)
1.未知支持库函数_30 (2, 0)
赋值 (工作表., “图书名称”)
设置表格 (工作表, “C2”, “C2”)
赋值 (., 12)
赋值 (., -4108)
1.未知支持库函数_30 (2, 0)
赋值 (工作表., “作者”)
设置表格 (工作表, “D2”, “D2”)
赋值 (., 5.75)
赋值 (., -4108)
1.未知支持库函数_30 (2, 0)
赋值 (工作表., “定价”)
设置表格 (工作表, “E2”, “E2”)
赋值 (., 5.75)
赋值 (., -4108)
1.未知支持库函数_30 (2, 0)
赋值 (工作表., “数量”)
设置表格 (工作表, “F2”, “F2”)
赋值 (., 5.75)
赋值 (., -4108)
1.未知支持库函数_30 (2, 0)
赋值 (工作表., “库存”)
置当前库 (“tsgltsk”)
到首记录 ()
.计次循环首 (取记录数 (), ZCK_M)
    赋值 (进度指示窗口..位置, 相乘 (相除 (ZCK_M, 取记录数 ()), 100))
    主窗口设置表格内容 (工作表, 相加 (“A”, 数值到格式文本 (相加 (ZCK_M, 2), 0, 假)), “”, 读 (1))
    主窗口设置表格内容 (工作表, 相加 (“B”, 数值到格式文本 (相加 (ZCK_M, 2), 0, 假)), “”, 读 (2))
    主窗口设置表格内容 (工作表, 相加 (“C”, 数值到格式文本 (相加 (ZCK_M, 2), 0, 假)), “”, 读 (3))
    主窗口设置表格内容 (工作表, 相加 (“D”, 数值到格式文本 (相加 (ZCK_M, 2), 0, 假)), “”, 数值到格式文本 (读 (4), 2, 真))
    主窗口设置表格内容 (工作表, 相加 (“E”, 数值到格式文本 (相加 (ZCK_M, 2), 0, 假)), “”, 数值到格式文本 (读 (5), 0, 真))
    主窗口设置表格内容 (工作表, 相加 (“F”, 数值到格式文本 (相加 (ZCK_M, 2), 0, 假)), “”, 数值到格式文本 (读 (6), 0, 真))
    跳过 (1)
.计次循环尾 ()
进度指示窗口.销毁 ()

.子程序 设置表格, 空白型, , 
.参数 工作表, 未知类型0x80002, 参考, 
.参数 首单元, 文本型, , 
.参数 尾单元, 文本型, , 

.如果真 (等于 (尾单元, “”))
    赋值 (尾单元, 首单元)
.如果真结束
赋值 (工作表., 首单元)
赋值 (工作表., 尾单元)


.子程序 主窗口设置表格内容, 空白型, , 
.参数 工作表, 未知类型0x80002, 参考, 
.参数 首单元, 文本型, , 
.参数 尾单元, 文本型, , 
.参数 表格内容, 文本型, , 

设置表格 (工作表, 首单元, 尾单元)
赋值 (工作表., 表格内容)
1.未知支持库函数_30 (2, 0)
赋值 (., 25)
赋值 (., -4108)


.子程序 _主窗口_将被销毁, 空白型, , 
.局部变量 操作内容, 文本型, , , 

置当前库 (“tsglzz”)
.如果真 (图书添加操作)
    赋值 (操作内容, 相加 (操作内容, “添加图书。”))
.如果真结束
.如果真 (图书删除操作)
    赋值 (操作内容, 相加 (操作内容, “删除图书。”))
.如果真结束
.如果真 (图书修改操作)
    赋值 (操作内容, 相加 (操作内容, “修改图书。”))
.如果真结束
.如果真 (图书重新编号)
    赋值 (操作内容, 相加 (操作内容, “图书重新编号。”))
.如果真结束
.如果真 (不等于 (操作内容, “”))
    加记录 (取现行时间 (), 操作者, 操作内容)
    连续赋值 (假, 图书添加操作, 图书删除操作, 图书修改操作, 图书重新编号)
    赋值 (操作内容, “”)
.如果真结束
.如果真 (会员添加操作)
    赋值 (操作内容, 相加 (操作内容, “添加会员。”))
.如果真结束
.如果真 (会员删除操作)
    赋值 (操作内容, 相加 (操作内容, “删除会员。”))
.如果真结束
.如果真 (会员修改操作)
    赋值 (操作内容, 相加 (操作内容, “修改会员。”))
.如果真结束
.如果真 (会员重新编号)
    赋值 (操作内容, 相加 (操作内容, “会员重新编号。”))
.如果真结束
.如果真 (不等于 (操作内容, “”))
    加记录 (取现行时间 (), 操作者, 操作内容)
    连续赋值 (假, 会员添加操作, 会员删除操作, 会员修改操作, 会员重新编号)
    赋值 (操作内容, “”)
.如果真结束
加记录 (取现行时间 (), 操作者, “系统正常退出。”)
未知支持库函数_11 (取窗口句柄 (), 热键F5)

.子程序 _卷帘式菜单1_项目被选择, 空白型, , 
.参数 菜单索引, 整数型, , 
.参数 项目索引, 整数型, , 

.局部变量 字段名之和, 文本型, , , 

.如果真 (并且 (等于 (菜单索引, 0), 等于 (项目索引, 0))) ' 重新登陆
    载入 (登陆窗口, , 真)
.如果真结束
.如果真 (并且 (等于 (菜单索引, 0), 等于 (项目索引, 1))) ' 修改密码
    载入 (修改密码窗口, , 真)
.如果真结束
.如果真 (并且 (等于 (菜单索引, 0), 等于 (项目索引, 2))) ' 用户更名
    载入 (用户更名窗口, , 真)
.如果真结束
.如果真 (并且 (等于 (菜单索引, 0), 等于 (项目索引, 3))) ' 管理用户
    .如果 (是否管理员)
        载入 (用户管理窗口, , 真)
    .否则
        赋值 (提示窗口标题, “无权操作！”)
        赋值 (提示窗口图标, 2)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, “该项功能只有系统管理员有权操作！”)
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
        赋值 (主窗口.., -1)
    .如果结束
    
.如果真结束
.如果真 (并且 (等于 (菜单索引, 0), 等于 (项目索引, 4))) ' 查看密码
    .如果 (是否管理员)
        载入 (查看密码窗口, , 真)
    .否则
        赋值 (提示窗口标题, “无权操作！”)
        赋值 (提示窗口图标, 2)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, “该项功能只有系统管理员有权操作！”)
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
        赋值 (主窗口.., -1)
    .如果结束
    
.如果真结束
.如果真 (并且 (等于 (菜单索引, 0), 等于 (项目索引, 5))) ' 系统参数
    .如果 (是否管理员)
        载入 (参数设置窗口, , 真)
    .否则
        赋值 (提示窗口标题, “无权操作！”)
        赋值 (提示窗口图标, 2)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, “该项功能只有系统管理员有权操作！”)
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
        赋值 (主窗口.., -1)
    .如果结束
    
.如果真结束
.如果真 (并且 (等于 (菜单索引, 0), 等于 (项目索引, 6))) ' 查看经费
    .如果 (是否管理员)
        载入 (查看经费窗口, , 真)
    .否则
        赋值 (提示窗口标题, “无权操作！”)
        赋值 (提示窗口图标, 2)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, “该项功能只有系统管理员有权操作！”)
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
        赋值 (主窗口.., -1)
    .如果结束
    
.如果真结束
.如果真 (并且 (等于 (菜单索引, 0), 等于 (项目索引, 7))) ' 退出系统
    全部关闭 ()
    主窗口.销毁 ()
.如果真结束
.如果真 (并且 (等于 (菜单索引, 1), 等于 (项目索引, 0))) ' 录入图书
    连续赋值 (假, 图书添加操作, 图书删除操作, 图书修改操作)
    赋值 (.可视, 真)
    赋值 (.禁止, 取反 (是否注册))
    连续赋值 (假, .可视, .可视)
    置等待鼠标 ()
    载入 (进度指示窗口, , 假)
    赋值 (进度指示窗口..内容, “正在初始化表格...”)
    刷新显示 ()
    .计次循环首 (., )
        0.未知支持库函数_36 ()
    .计次循环尾 ()
    .计次循环首 (., )
        0.未知支持库函数_37 ()
    .计次循环尾 ()
    赋值 (., 1)
    置当前库 (“tsgltsk”)
    到首记录 ()
    赋值 (., 1)
    赋值 (., 1)
    赋值 (., 相加 (取记录数 (), 1))
    赋值 (., 7)
    0.未知支持库函数_25 (0, 0, ., 2)
    1.未知支持库函数_25 (0, ., 0, 2)
    0.未知支持库函数_32 (到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “L0”, “50”)))
    1.未知支持库函数_32 (到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “L1”, “90”)))
    2.未知支持库函数_32 (到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “L2”, “400”)))
    3.未知支持库函数_32 (到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “L3”, “200”)))
    4.未知支持库函数_32 (到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “L4”, “70”)))
    5.未知支持库函数_32 (到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “L5”, “70”)))
    6.未知支持库函数_32 (到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “L6”, “70”)))
    0.未知支持库函数_9 (0, 1, “序号”)
    .计次循环首 (7, 循环次数)
        0.未知支持库函数_9 (循环次数, 1, 取字段名 (循环次数))
    .计次循环尾 ()
    赋值 (进度指示窗口..内容, “正在载入数据...”)
    刷新显示 ()
    .计次循环首 (取记录数 (), ZCK_M)
        赋值 (进度指示窗口..位置, 相乘 (相除 (ZCK_M, 取记录数 ()), 100))
        ZCK_M.未知支持库函数_9 (0, 1, 数值到格式文本 (ZCK_M, 0, 假))
        .计次循环首 (7, ZCK_N)
            .如果真 (小于 (ZCK_N, 4))
                ZCK_M.未知支持库函数_9 (ZCK_N, 1, 读 (ZCK_N))
            .如果真结束
            .如果真 (等于 (ZCK_N, 4))
                ZCK_M.未知支持库函数_9 (ZCK_N, 1, 数值到格式文本 (读 (ZCK_N), 2, 假))
            .如果真结束
            .如果真 (大于 (ZCK_N, 4))
                ZCK_M.未知支持库函数_9 (ZCK_N, 1, 数值到格式文本 (读 (ZCK_N), 0, 假))
            .如果真结束
            
        .计次循环尾 ()
        跳过 (1)
    .计次循环尾 ()
    进度指示窗口.销毁 ()
    .计次循环首 (., ZCK_M)
        相减 (ZCK_M, 1).未知支持库函数_31 (到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “H”, “24”)))
    .计次循环尾 ()
    相减 (., 1).未知支持库函数_0 (0)
    恢复鼠标 ()
    获取焦点 ()
.如果真结束
.如果真 (并且 (等于 (菜单索引, 1), 等于 (项目索引, 1))) ' 查询图书
    载入 (查询图书窗口, , 真)
.如果真结束
.如果真 (并且 (等于 (菜单索引, 1), 等于 (项目索引, 2))) ' 打印书号
    载入 (打印书号窗口, , 真)
.如果真结束
.如果真 (并且 (等于 (菜单索引, 2), 等于 (项目索引, 0))) ' 录入会员
    赋值 (.可视, 假)
    赋值 (.可视, 真)
    赋值 (.可视, 假)
    赋值 (.禁止, 取反 (是否注册))
    置等待鼠标 ()
    载入 (进度指示窗口, , 假)
    赋值 (进度指示窗口..内容, “正在初始化表格...”)
    刷新显示 ()
    .计次循环首 (., )
        0.未知支持库函数_36 ()
    .计次循环尾 ()
    .计次循环首 (., )
        0.未知支持库函数_37 ()
    .计次循环尾 ()
    置当前库 (“tsglhy”)
    到首记录 ()
    赋值 (., 1)
    赋值 (., 1)
    赋值 (., 相加 (取记录数 (), 1))
    赋值 (., 7)
    0.未知支持库函数_25 (0, 0, ., 2)
    1.未知支持库函数_25 (0, ., 0, 2)
    0.未知支持库函数_32 (到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L0”, “50”)))
    1.未知支持库函数_32 (到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L1”, “90”)))
    2.未知支持库函数_32 (到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L2”, “400”)))
    3.未知支持库函数_32 (到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L3”, “200”)))
    4.未知支持库函数_32 (到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L4”, “70”)))
    5.未知支持库函数_32 (到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L5”, “70”)))
    6.未知支持库函数_32 (到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L6”, “85”)))
    5.未知支持库函数_30 (5)
    6.未知支持库函数_30 (3)
    0.未知支持库函数_9 (0, 1, “序号”)
    .计次循环首 (5, 循环次数)
        0.未知支持库函数_9 (循环次数, 1, 取字段名 (循环次数))
    .计次循环尾 ()
    0.未知支持库函数_9 (6, 1, “办证时间”)
    赋值 (进度指示窗口..内容, “正在载入数据...”)
    刷新显示 ()
    .计次循环首 (取记录数 (), ZCK_M)
        赋值 (进度指示窗口..位置, 相乘 (相除 (ZCK_M, 取记录数 ()), 100))
        ZCK_M.未知支持库函数_9 (0, 1, 数值到格式文本 (ZCK_M, 0, 假))
        .计次循环首 (5, ZCK_N)
            .如果真 (小于 (ZCK_N, 5))
                ZCK_M.未知支持库函数_9 (ZCK_N, 1, 读 (ZCK_N))
            .如果真结束
            .如果真 (等于 (ZCK_N, 5))
                ZCK_M.未知支持库函数_9 (ZCK_N, 5, 读 (ZCK_N))
            .如果真结束
            
        .计次循环尾 ()
        ZCK_M.未知支持库函数_9 (6, 1, 到文本 (读 (“办证时间”)))
        跳过 (1)
    .计次循环尾 ()
    进度指示窗口.销毁 ()
    .计次循环首 (., ZCK_M)
        相减 (ZCK_M, 1).未知支持库函数_31 (到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “H”, “24”)))
    .计次循环尾 ()
    相减 (., 1).未知支持库函数_0 (0)
    获取焦点 ()
    恢复鼠标 ()
.如果真结束
.如果真 (并且 (等于 (菜单索引, 2), 等于 (项目索引, 1))) ' 查询会员
    载入 (查询会员窗口, , 真)
.如果真结束
.如果真 (并且 (等于 (菜单索引, 2), 等于 (项目索引, 2))) ' 打印借书证
    载入 (打印借书证窗口, , 真)
.如果真结束
.如果真 (并且 (等于 (菜单索引, 3), 等于 (项目索引, 0))) ' 借阅办理
    置等待鼠标 ()
    载入 (进度指示窗口, , 假)
    赋值 (进度指示窗口..内容, “正在校验图书库数据...”)
    刷新显示 ()
    置当前库 (“tsgltsk”)
    到首记录 ()
    .计次循环首 (取记录数 (), ZCK_M)
        赋值 (进度指示窗口..位置, 相乘 (相除 (ZCK_M, 取记录数 ()), 100))
        .如果真 (或者 (等于 (读 (1), “”), 等于 (读 (2), “”), 小于 (读 (4), 0), 小于或等于 (读 (5), 0), 小于 (读 (6), 0), 大于 (读 (6), 读 (5))))
            赋值 (图书校验是否通过, 假)
            跳出循环 ()
        .如果真结束
        赋值 (ZDNR, 读 (1))
        .如果真 (大于 (计算数目 (等于 (读 (1), ZDNR)), 1))
            赋值 (图书校验是否通过, 假)
            跳出循环 ()
        .如果真结束
        赋值 (ZDNR, 读 (2))
        .如果真 (大于 (计算数目 (等于 (读 (2), ZDNR)), 1))
            赋值 (图书校验是否通过, 假)
            跳出循环 ()
        .如果真结束
        跳过 (1)
    .计次循环尾 ()
    .如果真 (取反 (图书校验是否通过))
        赋值 (提示信息, 相加 (#左引号, “图书资料”, #右引号))
    .如果真结束
    赋值 (进度指示窗口..内容, “正在校验会员库数据...”)
    刷新显示 ()
    置当前库 (“tsglhy”)
    到首记录 ()
    .计次循环首 (取记录数 (), ZCK_M)
        赋值 (进度指示窗口..位置, 相乘 (相除 (ZCK_M, 取记录数 ()), 100))
        .如果真 (或者 (等于 (读 (1), “”), 等于 (读 (2), “”)))
            赋值 (会员校验是否通过, 假)
            跳出循环 ()
        .如果真结束
        赋值 (ZDNR, 读 (1))
        .如果真 (大于 (计算数目 (等于 (读 (1), ZDNR)), 1))
            赋值 (会员校验是否通过, 假)
            跳出循环 ()
        .如果真结束
        跳过 (1)
    .计次循环尾 ()
    恢复鼠标 ()
    进度指示窗口.销毁 ()
    .如果真 (取反 (会员校验是否通过))
        赋值 (提示信息, 相加 (提示信息, #左引号, “会员资料”, #右引号))
    .如果真结束
    .如果 (并且 (会员校验是否通过, 图书校验是否通过))
        置当前库 (“tsglhy”)
        到首记录 ()
        赋值 (.可视, 真)
        赋值 (会员编号基本码, “”)
        赋值 (会员编号基本码, 取文本左边 (读 (1), 相减 (取文本长度 (读 (1)), HYB)))
        赋值 (.内容, 会员编号基本码)
        获取焦点 ()
        赋值 (.起始选择位置, -1)
        连续赋值 (假, .可视, .可视)
        置当前库 (“tsgltsk”)
        到首记录 ()
        赋值 (图书编号基本码, “”)
        赋值 (图书编号基本码, 取文本左边 (读 (1), 相减 (取文本长度 (读 (1)), TSB)))
        赋值 (.内容, 图书编号基本码)
        赋值 (.内容, 会员编号基本码)
    .否则
        赋值 (提示窗口标题, “校验未通过！”)
        赋值 (提示窗口图标, 2)
        赋值 (提示窗口按钮数, 2)
        赋值 (提示信息, 相加 (提示信息, “存在错误，现在要进行更正吗？。”))
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
        .如果 (等于 (提示窗口返回值, 1))
            赋值 (提示窗口返回值, 0)
            .如果 (取反 (图书校验是否通过))
                赋值 (., 1)
                赋值 (., 0)
                _卷帘式菜单1_项目被选择 (1, 0)
                载入 (校验窗口, , 假)
            .否则
                赋值 (., 2)
                赋值 (., 0)
                _卷帘式菜单1_项目被选择 (2, 0)
                载入 (会员校验窗口, , 假)
            .如果结束
            
        .否则
            赋值 (., -1)
        .如果结束
        
    .如果结束
    
.如果真结束
.如果真 (并且 (等于 (菜单索引, 3), 等于 (项目索引, 1))) ' 借阅统计
    载入 (借阅统计窗口, , 真)
.如果真结束
.如果真 (并且 (等于 (菜单索引, 3), 等于 (项目索引, 2))) ' 到期催还
    置等待鼠标 ()
    赋值 (.时钟周期, 0)
    置当前库 (“tsglhy”)
    到首记录 ()
    赋值 (是否显示催还, 假)
    .判断循环首 (取反 (尾记录后 ()))
        .计次循环首 (10, 循环次数)
            .如果 (读 (5)) ' 判断是否是VIP
                .如果真 (并且 (大于或等于 (取时间间隔 (取现行时间 (), 读 (相加 (相乘 (循环次数, 2), 5)), 5), V2), 不等于 (读 (相加 (相乘 (循环次数, 2), 4)), “”)))
                    赋值 (是否显示催还, 真)
                    跳出循环 ()
                .如果真结束
                
            .否则
                .如果真 (并且 (大于或等于 (取时间间隔 (取现行时间 (), 读 (相加 (相乘 (循环次数, 2), 5)), 5), P2), 不等于 (读 (相加 (相乘 (循环次数, 2), 4)), “”)))
                    赋值 (是否显示催还, 真)
                    跳出循环 ()
                .如果真结束
                
            .如果结束
            
        .计次循环尾 ()
        .如果真 (是否显示催还)
            跳出循环 ()
        .如果真结束
        跳过 (1)
    .判断循环尾 ()
    .如果 (是否显示催还)
        赋值 (., 真)
        赋值 (.可视, 真)
        赋值 (.禁止, 取反 (是否注册))
        赋值 (.内容, 相加 (“(普通会员借阅期限：”, 数值到格式文本 (P2, , 假), “天；VIP借阅期限：”, 数值到格式文本 (V2, , 假), “天。借阅期限可由管理员在”, #左引号, “系统管理”, #右引号, “→”, #左引号, “系统参数”, #右引号, “里设置)”))
        .计次循环首 (., )
            0.未知支持库函数_36 ()
        .计次循环尾 ()
        .计次循环首 (., )
            0.未知支持库函数_37 ()
        .计次循环尾 ()
        赋值 (., 6)
        赋值 (., 1)
        赋值 (., 1)
        赋值 (., 1)
        0.未知支持库函数_9 (0, 1, “序号”)
        0.未知支持库函数_9 (1, 1, “借书证编号”)
        0.未知支持库函数_9 (2, 1, “姓    名”)
        0.未知支持库函数_9 (3, 1, “单          位”)
        0.未知支持库函数_9 (4, 1, “VIP”)
        0.未知支持库函数_9 (5, 1, “所借图书及借阅天数”)
        0.未知支持库函数_32 (40)
        1.未知支持库函数_32 (70)
        2.未知支持库函数_32 (80)
        3.未知支持库函数_32 (200)
        4.未知支持库函数_32 (40)
        5.未知支持库函数_32 (400)
        到首记录 ()
        .判断循环首 (取反 (尾记录后 ()))
            赋值 (书名, “”)
            赋值 (是否显示催还, 假)
            .计次循环首 (10, 循环次数)
                .如果 (读 (5)) ' 判断是否是VIP
                    .如果真 (并且 (大于或等于 (取时间间隔 (取现行时间 (), 读 (相加 (相乘 (循环次数, 2), 5)), 5), V2), 不等于 (读 (相加 (相乘 (循环次数, 2), 4)), “”)))
                        赋值 (是否显示催还, 真)
                        赋值 (书名, 相加 (书名, “《”, 读 (相加 (相乘 (循环次数, 2), 4)), “》”, “(已借：”, 数值到格式文本 (取时间间隔 (取现行时间 (), 读 (相加 (相乘 (循环次数, 2), 5)), 5), 0, 假), “天) ”))
                    .如果真结束
                    
                .否则
                    .如果真 (并且 (大于或等于 (取时间间隔 (取现行时间 (), 读 (相加 (相乘 (循环次数, 2), 5)), 5), P2), 不等于 (读 (相加 (相乘 (循环次数, 2), 4)), “”)))
                        赋值 (是否显示催还, 真)
                        赋值 (书名, 相加 (书名, “《”, 读 (相加 (相乘 (循环次数, 2), 4)), “》”, “(已借：”, 数值到格式文本 (取时间间隔 (取现行时间 (), 读 (相加 (相乘 (循环次数, 2), 5)), 5), 0, 假), “天) ”))
                    .如果真结束
                    
                .如果结束
                
            .计次循环尾 ()
            .如果真 (是否显示催还)
                数值到格式文本 (., , 假).未知支持库函数_38 (相加 (., 1))
                4.未知支持库函数_30 (5)
                相减 (., 1).未知支持库函数_9 (1, 1, 读 (1))
                相减 (., 1).未知支持库函数_9 (2, 1, 读 (2))
                相减 (., 1).未知支持库函数_9 (3, 1, 读 (3))
                相减 (., 1).未知支持库函数_9 (4, 5, 读 (5))
                相减 (., 1).未知支持库函数_9 (5, 1, 书名)
            .如果真结束
            跳过 (1)
        .判断循环尾 ()
        0.未知支持库函数_25 (0, 0, 6, 2)
        1.未知支持库函数_25 (0, 相减 (., 1), 2, 2)
        恢复鼠标 ()
    .否则
        恢复鼠标 ()
        赋值 (提示窗口标题, “不需要催还！”)
        赋值 (提示窗口图标, 4)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, “现在还没有超过借阅期限的会员，不需要催还。”)
        载入 (提示窗口, , 真)
        赋值 (., -1)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
    .如果结束
    
.如果真结束
.如果真 (并且 (等于 (菜单索引, 4), 等于 (项目索引, 0))) ' 备份数据
    载入 (备份选项窗口, , 真)
.如果真结束
.如果真 (并且 (等于 (菜单索引, 4), 等于 (项目索引, 1))) ' 恢复数据
    载入 (恢复选项窗口, , 真)
.如果真结束
.如果真 (并且 (等于 (菜单索引, 4), 等于 (项目索引, 2))) ' 追加数据
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示窗口图标, 4)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, 相加 (“    ”, #左引号, “追加数据”, #右引号, “功能是对在多台电脑上录入的资料进行合并操作，通常只在最初建立图书资料库时使用，该操作只对图书数据进行操作。”))
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    赋值 (.标题, “追加数据”)
    赋值 (.类型, 0)
    赋值 (.默认文件后缀, “tsk”)
    赋值 (.过滤器, “*.tsk”)
    赋值 (.初始过滤器, 0)
    赋值 (.文件名, “*.tsk”)
    .如果 (打开 ())
        .如果 (打开 (.文件名, “tsgltsk_j”, 假, 4, , “ujumpitoo@jdyltsgl3.com”, ))
            赋值 (字段名之和, “”)
            .计次循环首 (取字段数 (), 循环次数)
                赋值 (字段名之和, 相加 (字段名之和, 取字段名 (循环次数)))
            .计次循环尾 ()
            .如果 (并且 (等于 (取字段数 (), 8), 等于 (字段名之和, “图书编号书名作者定价数量库存借阅次数查询标记”)))
                置当前库 (“tsgltsk”)
                .如果 (添加 (“tsgltsk_j”, , ))
                    关闭 (“tsgltsk_j”)
                    置当前库 (“tsglzz”)
                    加记录 (取现行时间 (), 操作者, “追加数据。”)
                    赋值 (提示窗口标题, “完成！”)
                    赋值 (提示窗口图标, 4)
                    赋值 (提示窗口按钮数, 1)
                    赋值 (提示信息, “追加数据成功。”)
                    载入 (提示窗口, , 真)
                    赋值 (提示窗口标题, “”)
                    赋值 (提示窗口图标, 0)
                    赋值 (提示窗口按钮数, 0)
                    赋值 (提示信息, “”)
                    .如果真 (等于 (主窗口..可视, 真))
                        主窗口._卷帘式菜单1_项目被选择 (1, 0)
                    .如果真结束
                    
                .否则
                    赋值 (提示窗口标题, “追加失败！”)
                    赋值 (提示窗口图标, 2)
                    赋值 (提示窗口按钮数, 1)
                    赋值 (提示信息, “系统从文件中提取欲追加的数据时失败，请稍候重试。”)
                    载入 (提示窗口, , 真)
                    赋值 (提示窗口标题, “”)
                    赋值 (提示窗口图标, 0)
                    赋值 (提示窗口按钮数, 0)
                    赋值 (提示信息, “”)
                .如果结束
                
            .否则
                赋值 (提示窗口标题, “文件错误！”)
                赋值 (提示窗口图标, 2)
                赋值 (提示窗口按钮数, 1)
                赋值 (提示信息, “您提供的用于追加数据的文件不正确。”)
                载入 (提示窗口, , 真)
                赋值 (提示窗口标题, “”)
                赋值 (提示窗口图标, 0)
                赋值 (提示窗口按钮数, 0)
                赋值 (提示信息, “”)
            .如果结束
            
        .否则
            赋值 (提示窗口标题, “追加失败！”)
            赋值 (提示窗口图标, 1)
            赋值 (提示窗口按钮数, 1)
            赋值 (提示信息, “系统打开用于追加数据的文件时失败，请稍候重试。”)
            载入 (提示窗口, , 真)
            赋值 (提示窗口标题, “”)
            赋值 (提示窗口图标, 0)
            赋值 (提示窗口按钮数, 0)
            赋值 (提示信息, “”)
        .如果结束
        
    .否则
        赋值 (提示窗口标题, “取消追加！”)
        赋值 (提示窗口图标, 2)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, “操作取消，追加数据未完成。”)
        载入 (提示窗口, , 真)
        赋值 (., -1)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
    .如果结束
    赋值 (., -1)
.如果真结束
.如果真 (并且 (等于 (菜单索引, 5), 等于 (项目索引, 0))) ' 古木五子棋v1.25
    运行 (相加 (运行目录, “\recreation\goomfive1.25.exe”), 假, )
.如果真结束
.如果真 (并且 (等于 (菜单索引, 5), 等于 (项目索引, 1))) ' 搞怪碰碰球v1.2
    运行 (相加 (运行目录, “\recreation\搞怪碰碰球1.2.exe”), 假, )
.如果真结束
.如果真 (并且 (等于 (菜单索引, 5), 等于 (项目索引, 2))) ' 人机大战黑白棋
    运行 (相加 (运行目录, “\recreation\人机大战黑白棋.exe”), 假, )
.如果真结束
.如果真 (并且 (等于 (菜单索引, 5), 等于 (项目索引, 3))) ' 俄罗斯方块
    运行 (相加 (运行目录, “\recreation\tmp.exe”), 假, )
.如果真结束
.如果真 (并且 (等于 (菜单索引, 5), 等于 (项目索引, 4))) ' 自定义1
    .如果真 (或者 (等于 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “game01”, “”), “”), 等于 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “gamedir01”, “”), “”)))
        赋值 (.标题, “选择一个可执行文件：”)
        赋值 (.类型, 0)
        赋值 (.文件名, “*.exe”)
        赋值 (.过滤器, “可执行文件(*.exe)”)
        打开 ()
        写配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “game01”, 取文本中间 (.文件名, 相加 (倒找文本 (.文件名, “\”, , 假), 1), 相减 (倒找文本 (.文件名, “.exe”, , 假), 倒找文本 (.文件名, “\”, , 假), 1)))
        写配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “gamedir01”, .文件名)
        4.未知支持库函数_10 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “game01”, “自定义1...”), 5)
    .如果真结束
    .如果真 (等于 (运行 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “gamedir01”, “”), 假, ), 假))
        4.未知支持库函数_10 (“自定义1...”, 5)
        写配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “game01”, )
        写配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “gamedir01”, )
    .如果真结束
    
.如果真结束
.如果真 (并且 (等于 (菜单索引, 5), 等于 (项目索引, 5))) ' 自定义2
    .如果真 (或者 (等于 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “game02”, “”), “”), 等于 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “gamedir02”, “”), “”)))
        赋值 (.标题, “选择一个可执行文件：”)
        赋值 (.类型, 0)
        赋值 (.文件名, “*.exe”)
        赋值 (.过滤器, “可执行文件(*.exe)”)
        打开 ()
        写配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “game02”, 取文本中间 (.文件名, 相加 (倒找文本 (.文件名, “\”, , 假), 1), 相减 (倒找文本 (.文件名, “.exe”, , 假), 倒找文本 (.文件名, “\”, , 假), 1)))
        写配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “gamedir02”, .文件名)
        5.未知支持库函数_10 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “game02”, “自定义2...”), 5)
    .如果真结束
    .如果真 (等于 (运行 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “gamedir02”, “”), 假, ), 假))
        5.未知支持库函数_10 (“自定义2...”, 5)
        写配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “game02”, )
        写配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “gamedir02”, )
    .如果真结束
    
.如果真结束
.如果真 (并且 (等于 (菜单索引, 5), 等于 (项目索引, 6))) ' 自定义3
    .如果真 (或者 (等于 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “game03”, “”), “”), 等于 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “gamedir03”, “”), “”)))
        赋值 (.标题, “选择一个可执行文件：”)
        赋值 (.文件名, “*.exe”)
        赋值 (.类型, 0)
        赋值 (.过滤器, “可执行文件(*.exe)”)
        打开 ()
        写配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “game03”, 取文本中间 (.文件名, 相加 (倒找文本 (.文件名, “\”, , 假), 1), 相减 (倒找文本 (.文件名, “.exe”, , 假), 倒找文本 (.文件名, “\”, , 假), 1)))
        写配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “gamedir03”, .文件名)
        6.未知支持库函数_10 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “game03”, “自定义3...”), 5)
    .如果真结束
    .如果真 (等于 (运行 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “gamedir03”, “”), 假, ), 假))
        6.未知支持库函数_10 (“自定义3...”, 5)
        写配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “game03”, )
        写配置项 (相加 (运行目录, “\tsglsoft.ini”), “recreation”, “gamedir03”, )
    .如果真结束
    
.如果真结束
.如果真 (并且 (等于 (菜单索引, 6), 等于 (项目索引, 0))) ' 查看日志
    载入 (查看日志窗口, , 真)
.如果真结束
.如果真 (并且 (等于 (菜单索引, 6), 等于 (项目索引, 1))) ' 管理日志
    .如果 (是否管理员)
        载入 (日志管理窗口, , 真)
    .否则
        赋值 (提示窗口标题, “无权操作！”)
        赋值 (提示窗口图标, 2)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, “该项功能只有系统管理员有权操作！”)
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
        赋值 (主窗口.., -1)
    .如果结束
    
.如果真结束
.如果真 (并且 (等于 (菜单索引, 6), 等于 (项目索引, 2))) ' 注册
    .如果 (是否注册)
        载入 (注册信息查看窗口, , 真)
    .否则
        载入 (注册窗口, , 真)
    .如果结束
    
.如果真结束
.如果真 (并且 (等于 (菜单索引, 6), 等于 (项目索引, 3))) ' 帮助
    载入 (帮助窗口, , 假)
.如果真结束
.如果真 (并且 (等于 (菜单索引, 6), 等于 (项目索引, 4))) ' 关于
    载入 (关于窗口, , 真)
.如果真结束


.子程序 _外形框1_首记录按钮_被单击, 空白型, , 
置当前库 (“tsgltsk”)
到首记录 ()
0.未知支持库函数_0 (0)

.子程序 _外形框1_添加子程序, 空白型, , 
.局部变量 搜索结果1, 未知类型0xA0002, , "0", 
.局部变量 正则表达式1, 未知类型0xA0001, , , 
.局部变量 ZZM, 整数型, , , 循环变量
.局部变量 TT, 文本型, , , 编号除去右侧数字部分
.局部变量 TN, 文本型, , , 编号右侧数字部分
.局部变量 TN1, 文本型, , , TN数值加1后的值对应的文本
.局部变量 T, 文本型, , , 用于补0

置当前库 (“tsgltsk”)
数值到格式文本 (., 0, 假).未知支持库函数_38 ()
加空记录 ()
赋值 (TT, “”)
赋值 (TN, “”)
赋值 (TN1, “”)
赋值 (T, “”)
.如果真 (.选中)
    正则表达式1.未知支持库函数_3 (“[0-9]”, )
    .计次循环首 (取文本长度 (相减 (., 2).未知支持库函数_10 (1)), ZZM)
        赋值 (搜索结果1, 正则表达式1.未知支持库函数_16 (取文本右边 (相减 (., 2).未知支持库函数_10 (1), ZZM)))
        .如果 (大于 (取数组成员数 (搜索结果1), 0))
            赋值 (TN, 相加 (搜索结果1.未知支持库函数_11 ( [1], 取文本右边 (相减 (., 2).未知支持库函数_10 (1), ZZM), ), TN))
        .否则
            赋值 (TN, “”)
            跳出循环 ()
        .如果结束
        .如果真 (不等于 (TN, 取文本右边 (相减 (., 2).未知支持库函数_10 (1), ZZM)))
            赋值 (TN, 取文本右边 (TN, 相减 (取文本长度 (TN), 1)))
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
    赋值 (TT, 取文本左边 (相减 (., 2).未知支持库函数_10 (1), 相减 (取文本长度 (相减 (., 2).未知支持库函数_10 (1)), 取文本长度 (TN))))
    .如果 (等于 (TN, “”))
        .如果真 (等于 (., 2))
            赋值 (TT, “TS-”)
        .如果真结束
        赋值 (TN, “1”)
        .计次循环首 (相减 (TSB, 1), )
            赋值 (TN, 相加 (“0”, TN))
        .计次循环尾 ()
        相减 (., 1).未知支持库函数_9 (1, 1, 相加 (TT, TN))
    .否则
        赋值 (TN1, 数值到格式文本 (相加 (到数值 (TN), 1), , 假))
        .计次循环首 (相减 (取文本长度 (TN), 取文本长度 (TN1)), )
            赋值 (T, 相加 (T, “0”))
        .计次循环尾 ()
        相减 (., 1).未知支持库函数_9 (1, 1, 相加 (TT, T, TN1))
    .如果结束
    
.如果真结束
保存子程序1 ()
赋值 (图书添加操作, 真)

.子程序 _外形框1_添加按钮_被单击, 空白型, , 
_外形框1_添加子程序 ()
.如果 (.选中)
    相减 (., 1).未知支持库函数_0 (2)
.否则
    相减 (., 1).未知支持库函数_0 (1)
.如果结束


.子程序 _外形框1_删除按钮_被单击, 空白型, , 
置当前库 (“tsgltsk”)
到首记录 ()
跳到 (未知支持库函数_3 ())
删除 ()
彻底删除 ()
未知支持库函数_3 ().未知支持库函数_36 ()
.计次循环首 (., ZCK_M)
    ZCK_M.未知支持库函数_9 (0, 1, 数值到格式文本 (ZCK_M, 0, 假))
.计次循环尾 ()
保存子程序1 ()
赋值 (图书删除操作, 真)

.子程序 _外形框1_尾记录按钮_被单击, 空白型, , 
置当前库 (“tsgltsk”)
相减 (., 1).未知支持库函数_0 (0)
到尾记录 ()

.子程序 _外形框1_前一页按钮_被单击, 空白型, , 
置当前库 (“tsgltsk”)
到首记录 ()
赋值 (每屏行数, 绝对取整 (相减 (相除 (., 1.未知支持库函数_43 ()), 1)))
.如果 (小于 (相减 (未知支持库函数_3 (), 每屏行数), 1))
    1.未知支持库函数_0 (0)
.否则
    相减 (未知支持库函数_3 (), 每屏行数).未知支持库函数_0 (0)
.如果结束
跳到 (未知支持库函数_3 ())


.子程序 _外形框1_后一页按钮_被单击, 空白型, , 
置当前库 (“tsgltsk”)
到首记录 ()
赋值 (每屏行数, 绝对取整 (相减 (相除 (., 1.未知支持库函数_43 ()), 1)))
.如果 (大于 (相加 (未知支持库函数_3 (), 每屏行数), 相减 (., 1)))
    相减 (., 1).未知支持库函数_0 (0)
.否则
    相加 (未知支持库函数_3 (), 每屏行数).未知支持库函数_0 (0)
.如果结束
跳到 (未知支持库函数_3 ())


.子程序 保存子程序1, 空白型, , 
置等待鼠标 ()
置当前库 (“tsgltsk”)
到首记录 ()
.计次循环首 (相减 (., 1), ZCK_M)
    .计次循环首 (6, ZCK_N)
        .如果真 (小于 (ZCK_N, 4))
            写 (ZCK_N, ZCK_M.未知支持库函数_10 (ZCK_N))
        .如果真结束
        .如果真 (大于 (ZCK_N, 3))
            写 (ZCK_N, 到数值 (ZCK_M.未知支持库函数_10 (ZCK_N)))
        .如果真结束
        
    .计次循环尾 ()
    跳过 (1)
.计次循环尾 ()
恢复鼠标 ()

.子程序 保存子程序2, 空白型, , 
置等待鼠标 ()
置当前库 (“tsglhy”)
到首记录 ()
.计次循环首 (相减 (., 1), ZCK_M)
    .计次循环首 (6, ZCK_N)
        .如果真 (小于 (ZCK_N, 6))
            写 (ZCK_N, ZCK_M.未知支持库函数_10 (ZCK_N))
        .如果真结束
        .如果真 (等于 (ZCK_N, 6))
            写 (“办证时间”, 到时间 (ZCK_M.未知支持库函数_10 (ZCK_N))) ' 高级表格“取数据”命令除图片型、选择型外，均返回文本型
        .如果真结束
        
    .计次循环尾 ()
    跳过 (1)
.计次循环尾 ()
恢复鼠标 ()

.子程序 _外形框1_退出按钮_被单击, 空白型, , 
赋值 (.可视, 假)
赋值 (., -1)

.子程序 _外形框1_查找按钮_被单击, 空白型, , 
载入 (查找窗口, , 真) ' 这里将载入窗口选项高为“真”非常重要，目的是不允许在查找期间再对高级表格进行操作，可以防止数据库指针发生不可预知的改变！

.子程序 _外形框1_统计按钮_被单击, 空白型, , 
载入 (统计窗口, , 真)

.子程序 _外形框1_校验按钮_被单击, 空白型, , 
载入 (校验窗口, , 假)

.子程序 _外形框1_排序按钮_被单击, 空白型, , 
载入 (排序窗口, , 真)

.子程序 _外形框1_转换按钮_被单击, 空白型, , 
.如果真 (等于 (未知支持库函数_0 (), 假))
    赋值 (提示窗口标题, “转换失败！”)
    赋值 (提示窗口图标, 1)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, “Excel 程序创建失败！可能没有安装Excel2000。”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    返回 ()
.如果真结束
载入 (进度指示窗口, , 假)
赋值 (进度指示窗口..内容, “正在进行转换...请不要进行任何其它操作！”)
刷新显示 ()
赋值 (., 相加 (使用单位, “图书室存书清单”))
.未知支持库函数_6 ()
赋值 (., 真)
未知支持库函数_21 ()
.计次循环首 (., ZCK_M)
    赋值 (., ZCK_M)
    赋值 (., 相加 (“表格”, 数值到格式文本 (ZCK_M, , 假)))
.计次循环尾 ()
赋值 (., 1)
设置表格 (“A1”, “F1”)
未知支持库函数_26 ()
赋值 (., 40)
赋值 (., 10)
赋值 (., 相加 (使用单位, “图书室存书清单”))
赋值 (., 真)
赋值 (., 取颜色值 (41, 115, 164))
赋值 (., 20)
赋值 (., 真)
赋值 (., -4108)
创建表格 ()
.未知支持库函数_31 ()
赋值 (., 85)


.子程序 _外形框1_打印按钮_被单击, 空白型, , 
赋值 (表头标志, “图书”)
载入 (置打印表头窗口, , 真)

.子程序 _高级表格1_列宽被改变, 空白型, , 
.参数 列号, 整数型, , 

写配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, 相加 (“L”, 数值到格式文本 (列号, , 假)), 数值到格式文本 (列号.未知支持库函数_44 (), , 假))


.子程序 _高级表格1_行高被改变, 空白型, , 
.参数 行号, 整数型, , 

写配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “H”, 数值到格式文本 (行号.未知支持库函数_43 (), , 假))
.计次循环首 (., ZCK_M)
    相减 (ZCK_M, 1).未知支持库函数_31 (行号.未知支持库函数_43 ())
.计次循环尾 ()


.子程序 _高级表格1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #Del键))
    保存子程序1 ()
    赋值 (图书修改操作, 真)
.如果真结束
.如果真 (等于 (键代码, #回车键))
    .如果真 (并且 (等于 (未知支持库函数_4 (), 6), 等于 (未知支持库函数_3 (), 相减 (., 1))))
        _外形框1_添加子程序 ()
        赋值 (图书添加操作, 真)
    .如果真结束
    
.如果真结束
返回 (真)

.子程序 _高级表格1_结束编辑, 空白型, , 
.如果真 (等于 (未知支持库函数_4 (), 5))
    未知支持库函数_3 ().未知支持库函数_9 (6, 1, 未知支持库函数_3 ().未知支持库函数_10 (5))
.如果真结束
保存子程序1 ()
赋值 (图书修改操作, 真)

.子程序 _外形框1_自动编号按钮_被单击, 空白型, , 
.局部变量 搜索结果1, 未知类型0xA0002, , "0", 
.局部变量 正则表达式1, 未知类型0xA0001, , , 
.局部变量 ZZM, 整数型, , , 循环变量
.局部变量 TT, 文本型, , , 编号除去右侧数字部分
.局部变量 TN, 文本型, , , 编号右侧数字部分
.局部变量 TN1, 文本型, , , TN数值加1后的值对应的文本
.局部变量 T, 文本型, , , 用于补0

未知支持库函数_3 ().未知支持库函数_0 (1)
赋值 (TT, “”)
赋值 (TN, “”)
赋值 (TN1, “”)
赋值 (T, “”)
正则表达式1.未知支持库函数_3 (“[0-9]”, )
.如果真 (等于 (未知支持库函数_3 (), -1))
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示窗口图标, 4)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, “请指定自动编号的起始位置。”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    返回 ()
.如果真结束
.计次循环首 (取文本长度 (未知支持库函数_3 ().未知支持库函数_10 (1)), ZZM)
    赋值 (搜索结果1, 正则表达式1.未知支持库函数_16 (取文本右边 (未知支持库函数_3 ().未知支持库函数_10 (1), ZZM)))
    .如果 (大于 (取数组成员数 (搜索结果1), 0))
        赋值 (TN, 相加 (搜索结果1.未知支持库函数_11 ( [1], 取文本右边 (未知支持库函数_3 ().未知支持库函数_10 (1), ZZM), ), TN))
    .否则
        赋值 (TN, “”)
        跳出循环 ()
    .如果结束
    .如果真 (不等于 (TN, 取文本右边 (未知支持库函数_3 ().未知支持库函数_10 (1), ZZM)))
        赋值 (TN, 取文本右边 (TN, 相减 (取文本长度 (TN), 1)))
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
赋值 (TT, 取文本左边 (未知支持库函数_3 ().未知支持库函数_10 (1), 相减 (取文本长度 (未知支持库函数_3 ().未知支持库函数_10 (1)), 取文本长度 (TN))))
.如果真 (并且 (等于 (TT, “”), 等于 (TN, “”)))
    赋值 (TT, “TS-”)
.如果真结束
.如果真 (等于 (TN, “”))
    赋值 (TN, “1”)
.如果真结束
.计次循环首 (相减 (TSB, 取文本长度 (TN)), )
    赋值 (TN, 相加 (“0”, TN))
.计次循环尾 ()
赋值 (提示窗口标题, “确认！”)
赋值 (提示窗口图标, 3)
赋值 (提示窗口按钮数, 2)
赋值 (提示信息, 相加 (“！慎重使用！系统将自动对光标所在行以后的记录进行重新编号，编号从”, #左引号, TT, TN, #右引号, “开始，继续吗？”))
载入 (提示窗口, , 真)
赋值 (提示窗口标题, “”)
赋值 (提示窗口图标, 0)
赋值 (提示窗口按钮数, 0)
赋值 (提示信息, “”)
.如果真 (等于 (提示窗口返回值, 1))
    赋值 (提示窗口返回值, 0)
    .计次循环首 (相减 (., 未知支持库函数_3 ()), ZZM)
        赋值 (TN1, 数值到格式文本 (相减 (相加 (到数值 (TN), ZZM), 1), 0, 假))
        赋值 (T, “”)
        .计次循环首 (相减 (取文本长度 (TN), 取文本长度 (TN1)), )
            赋值 (T, 相加 (T, “0”))
        .计次循环尾 ()
        相减 (相加 (未知支持库函数_3 (), ZZM), 1).未知支持库函数_9 (1, 1, 相加 (TT, T, TN1))
    .计次循环尾 ()
    相减 (., 1).未知支持库函数_0 (1)
    赋值 (图书重新编号, 真)
    保存子程序1 ()
.如果真结束


.子程序 _外形框3_自动编号按钮_被单击, 空白型, , 
.局部变量 搜索结果1, 未知类型0xA0002, , "0", 
.局部变量 正则表达式1, 未知类型0xA0001, , , 
.局部变量 ZZM, 整数型, , , 循环变量
.局部变量 TT, 文本型, , , 编号除去右侧数字部分
.局部变量 TN, 文本型, , , 编号右侧数字部分
.局部变量 TN1, 文本型, , , TN数值加1后的值对应的文本
.局部变量 T, 文本型, , , 用于补0

未知支持库函数_3 ().未知支持库函数_0 (1)
赋值 (TT, “”)
赋值 (TN, “”)
赋值 (TN1, “”)
赋值 (T, “”)
正则表达式1.未知支持库函数_3 (“[0-9]”, )
.如果真 (等于 (未知支持库函数_3 (), -1))
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示窗口图标, 4)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, “请指定自动编号的起始位置。”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    返回 ()
.如果真结束
.计次循环首 (取文本长度 (未知支持库函数_3 ().未知支持库函数_10 (1)), ZZM)
    赋值 (搜索结果1, 正则表达式1.未知支持库函数_16 (取文本右边 (未知支持库函数_3 ().未知支持库函数_10 (1), ZZM)))
    .如果 (大于 (取数组成员数 (搜索结果1), 0))
        赋值 (TN, 相加 (搜索结果1.未知支持库函数_11 ( [1], 取文本右边 (未知支持库函数_3 ().未知支持库函数_10 (1), ZZM), ), TN))
    .否则
        赋值 (TN, “”)
        跳出循环 ()
    .如果结束
    .如果真 (不等于 (TN, 取文本右边 (未知支持库函数_3 ().未知支持库函数_10 (1), ZZM)))
        赋值 (TN, 取文本右边 (TN, 相减 (取文本长度 (TN), 1)))
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
赋值 (TT, 取文本左边 (未知支持库函数_3 ().未知支持库函数_10 (1), 相减 (取文本长度 (未知支持库函数_3 ().未知支持库函数_10 (1)), 取文本长度 (TN))))
.如果真 (并且 (等于 (TT, “”), 等于 (TN, “”)))
    赋值 (TT, “JSZ-”)
.如果真结束
.如果真 (等于 (TN, “”))
    赋值 (TN, “1”)
.如果真结束
.计次循环首 (相减 (HYB, 取文本长度 (TN)), )
    赋值 (TN, 相加 (“0”, TN))
.计次循环尾 ()
赋值 (提示窗口标题, “确认！”)
赋值 (提示窗口图标, 3)
赋值 (提示窗口按钮数, 2)
赋值 (提示信息, 相加 (“！慎重使用！系统将自动对光标所在行以后的记录进行重新编号，编号从”, #左引号, TT, TN, #右引号, “开始，继续吗？”))
载入 (提示窗口, , 真)
赋值 (提示窗口标题, “”)
赋值 (提示窗口图标, 0)
赋值 (提示窗口按钮数, 0)
赋值 (提示信息, “”)
.如果真 (等于 (提示窗口返回值, 1))
    赋值 (提示窗口返回值, 0)
    .计次循环首 (相减 (., 未知支持库函数_3 ()), ZZM)
        赋值 (TN1, 数值到格式文本 (相减 (相加 (到数值 (TN), ZZM), 1), 0, 假))
        赋值 (T, “”)
        .计次循环首 (相减 (取文本长度 (TN), 取文本长度 (TN1)), )
            赋值 (T, 相加 (T, “0”))
        .计次循环尾 ()
        相减 (相加 (未知支持库函数_3 (), ZZM), 1).未知支持库函数_9 (1, 1, 相加 (TT, T, TN1))
    .计次循环尾 ()
    相减 (., 1).未知支持库函数_0 (1)
    赋值 (会员重新编号, 真)
    保存子程序2 ()
.如果真结束


.子程序 _外形框3_高级表格1_列宽被改变, 空白型, , 
.参数 列号, 整数型, , 

写配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, 相加 (“L”, 数值到格式文本 (列号, , 假)), 数值到格式文本 (列号.未知支持库函数_44 (), , 假))

.子程序 _外形框3_高级表格1_行高被改变, 空白型, , 
.参数 行号, 整数型, , 

写配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “H”, 数值到格式文本 (行号.未知支持库函数_43 (), , 假))
.计次循环首 (., ZCK_M)
    相减 (ZCK_M, 1).未知支持库函数_31 (行号.未知支持库函数_43 ())
.计次循环尾 ()

.子程序 _外形框3_添加按钮_被单击, 空白型, , 
.局部变量 外形框3_搜索结果1, 未知类型0xA0002, , "0", 
.局部变量 外形框3_正则表达式1, 未知类型0xA0001, , , 
.局部变量 ZZM, 整数型, , , 循环变量
.局部变量 TT, 文本型, , , 编号除去右侧数字部分
.局部变量 TN, 文本型, , , 编号右侧数字部分
.局部变量 TN1, 文本型, , , TN数值加1后的值对应的文本
.局部变量 T, 文本型, , , 用于补0

.如果 (或者 (不等于 (V3, 0), 不等于 (P3, 0)))
    赋值 (提示窗口标题, “确认办证！”)
    赋值 (提示窗口图标, 3)
    赋值 (提示窗口按钮数, 2)
    赋值 (提示信息, 相加 (“普通会员办证收押金：”, 数值到格式文本 (P3, 2, 假), “元，VIP办证收押金：”, 数值到格式文本 (V3, 2, 假), “元。”))
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    .如果真 (等于 (提示窗口返回值, 1))
        赋值 (提示窗口返回值, 0)
        载入 (办证窗口, , 真)
    .如果真结束
    
.否则
    赋值 (TT, “”)
    赋值 (TN, “”)
    赋值 (TN1, “”)
    赋值 (T, “”)
    置当前库 (“tsglhy”)
    数值到格式文本 (., 0, 假).未知支持库函数_38 ()
    加空记录 ()
    .如果真 (.选中)
        外形框3_正则表达式1.未知支持库函数_3 (“[0-9]”, )
        .计次循环首 (取文本长度 (相减 (., 2).未知支持库函数_10 (1)), ZZM)
            赋值 (外形框3_搜索结果1, 外形框3_正则表达式1.未知支持库函数_16 (取文本右边 (相减 (., 2).未知支持库函数_10 (1), ZZM)))
            .如果 (大于 (取数组成员数 (外形框3_搜索结果1), 0))
                赋值 (TN, 相加 (外形框3_搜索结果1.未知支持库函数_11 ( [1], 取文本右边 (相减 (., 2).未知支持库函数_10 (1), ZZM), ), TN))
            .否则
                赋值 (TN, “”)
                跳出循环 ()
            .如果结束
            .如果真 (不等于 (TN, 取文本右边 (相减 (., 2).未知支持库函数_10 (1), ZZM)))
                赋值 (TN, 取文本右边 (TN, 相减 (取文本长度 (TN), 1)))
                跳出循环 ()
            .如果真结束
            
        .计次循环尾 ()
        赋值 (TT, 取文本左边 (相减 (., 2).未知支持库函数_10 (1), 相减 (取文本长度 (相减 (., 2).未知支持库函数_10 (1)), 取文本长度 (TN))))
        .如果 (等于 (TN, “”))
            .如果真 (等于 (., 2))
                赋值 (TT, “JSZ-”)
            .如果真结束
            赋值 (TN, “1”)
            .计次循环首 (相减 (HYB, 1), )
                赋值 (TN, 相加 (“0”, TN))
            .计次循环尾 ()
            相减 (., 1).未知支持库函数_9 (1, 1, 相加 (TT, TN))
        .否则
            赋值 (TN1, 数值到格式文本 (相加 (到数值 (TN), 1), , 假))
            .计次循环首 (相减 (取文本长度 (TN), 取文本长度 (TN1)), )
                赋值 (T, 相加 (T, “0”))
            .计次循环尾 ()
            相减 (., 1).未知支持库函数_9 (1, 1, 相加 (TT, T, TN1))
        .如果结束
        
    .如果真结束
    
.如果结束
赋值 (会员添加操作, 真)
相减 (., 1).未知支持库函数_0 (0)
保存子程序2 ()

.子程序 _外形框3_删除按钮_被单击, 空白型, , 
赋值 (提示窗口标题, “确认删除！”)
赋值 (提示窗口图标, 3)
赋值 (提示窗口按钮数, 2)
赋值 (提示信息, 相加 (“确定删除”, #引号, 未知支持库函数_3 ().未知支持库函数_10 (2), #右引号, “吗？”))
载入 (提示窗口, , 真)
赋值 (提示窗口标题, “”)
赋值 (提示窗口图标, 0)
赋值 (提示窗口按钮数, 0)
赋值 (提示信息, “”)
.如果真 (等于 (提示窗口返回值, 1))
    赋值 (提示窗口返回值, 0)
    置当前库 (“tsglhy”)
    到首记录 ()
    查找 (等于 (读 (2), 未知支持库函数_3 ().未知支持库函数_10 (2)))
    赋值 (会员押金, 读 (29)) ' 读取会员办证时所交押金，不能用系统参数中押金代替，不然用户使用软件中改变了系统参数就会造成错误。
    赋值 (能否删除, 真)
    .计次循环首 (10, 循环次数)
        .如果真 (不等于 (读 (相加 (相乘 (2, 循环次数), 4)), “”))
            赋值 (能否删除, 假)
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
    .如果 (能否删除)
        .如果 (不等于 (会员押金, 0))
            置当前库 (“jfgl”)
            加记录 (取现行时间 (), 相加 (“退”, 未知支持库函数_3 ().未知支持库函数_10 (2), “押金”), 负 (会员押金), , “押金”)
            修改 (求和 (读 (3), )) ' 不能将“求和”操作直接放在“加记录”中，不然操作无效。
            置当前库 (“tsglhy”)
            到首记录 ()
            查找 (等于 (读 (2), 未知支持库函数_3 ().未知支持库函数_10 (2)))
            删除 ()
            彻底删除 ()
            未知支持库函数_3 ().未知支持库函数_36 ()
            赋值 (会员删除操作, 真)
            .计次循环首 (., ZCK_M)
                ZCK_M.未知支持库函数_9 (0, 1, 数值到格式文本 (ZCK_M, 0, 假))
            .计次循环尾 ()
            保存子程序2 ()
            赋值 (提示窗口标题, “退押金！”)
            赋值 (提示窗口图标, 4)
            赋值 (提示窗口按钮数, 1)
            赋值 (提示信息, 相加 (“操作完成！应退押金：”, 数值到格式文本 (V3, 2, 假), “元。”))
            载入 (提示窗口, , 真)
            赋值 (提示窗口标题, “”)
            赋值 (提示窗口图标, 0)
            赋值 (提示窗口按钮数, 0)
            赋值 (提示信息, “”)
        .否则
            置当前库 (“tsglhy”)
            到首记录 ()
            查找 (等于 (读 (2), 未知支持库函数_3 ().未知支持库函数_10 (2)))
            删除 ()
            彻底删除 ()
            未知支持库函数_3 ().未知支持库函数_36 ()
            赋值 (会员删除操作, 真)
            .计次循环首 (., ZCK_M)
                ZCK_M.未知支持库函数_9 (0, 1, 数值到格式文本 (ZCK_M, 0, 假))
            .计次循环尾 ()
            保存子程序2 ()
            赋值 (提示窗口标题, “操作完成！”)
            赋值 (提示窗口图标, 4)
            赋值 (提示窗口按钮数, 1)
            赋值 (提示信息, “已将该会员成功删除！”)
            载入 (提示窗口, , 真)
            赋值 (提示窗口标题, “”)
            赋值 (提示窗口图标, 0)
            赋值 (提示窗口按钮数, 0)
            赋值 (提示信息, “”)
        .如果结束
        
    .否则
        赋值 (提示窗口标题, “不能删除！”)
        赋值 (提示窗口图标, 3)
        赋值 (提示窗口按钮数, 2)
        赋值 (提示信息, “该会员还借有图书没有归还，不能删除。现在还书吗？”)
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
        .如果真 (等于 (提示窗口返回值, 1))
            赋值 (提示窗口返回值, 0)
            _卷帘式菜单1_项目被选择 (3, 0)
            赋值 (., 3)
            赋值 (., 0)
        .如果真结束
        
    .如果结束
    
.如果真结束


.子程序 _外形框3_首记录按钮_被单击, 空白型, , 
置当前库 (“tsglhy”)
到首记录 ()
0.未知支持库函数_0 (0)

.子程序 _外形框3_尾记录按钮_被单击, 空白型, , 
置当前库 (“tsglthy”)
相减 (., 1).未知支持库函数_0 (0)
到尾记录 ()

.子程序 _外形框3_前一页按钮_被单击, 空白型, , 
置当前库 (“tsglhy”)
赋值 (每屏行数, 绝对取整 (相减 (相除 (., 1.未知支持库函数_43 ()), 1)))
.如果 (小于 (相减 (未知支持库函数_3 (), 每屏行数), 1))
    1.未知支持库函数_0 (0)
.否则
    相减 (未知支持库函数_3 (), 每屏行数).未知支持库函数_0 (0)
.如果结束
跳到 (未知支持库函数_3 ())


.子程序 _外形框3_后一页按钮_被单击, 空白型, , 
置当前库 (“tsglhy”)
赋值 (每屏行数, 绝对取整 (相减 (相除 (., 1.未知支持库函数_43 ()), 1)))
.如果 (大于 (相加 (未知支持库函数_3 (), 每屏行数), 相减 (., 1)))
    相减 (., 1).未知支持库函数_0 (0)
.否则
    相加 (未知支持库函数_3 (), 每屏行数).未知支持库函数_0 (0)
.如果结束
跳到 (未知支持库函数_3 ())


.子程序 _外形框3_查找按钮_被单击, 空白型, , 
载入 (会员查找窗口, , 真) ' 这里将载入窗口选项高为“真”非常重要，目的是不允许在查找期间再对高级表格进行操作，可以防止数据库指针发生不可预知的改变！

.子程序 _外形框3_统计按钮_被单击, 空白型, , 
载入 (会员统计窗口, , 真)

.子程序 _外形框3_校验按钮_被单击, 空白型, , 
载入 (会员校验窗口, , 假)

.子程序 _外形框3_排序按钮_被单击, 空白型, , 
载入 (会员排序窗口, , 真)

.子程序 _外形框3_打印按钮_被单击, 空白型, , 
赋值 (表头标志, “会员”)
载入 (置打印表头窗口, , 真)

.子程序 _外形框3_退出按钮_被单击, 空白型, , 
赋值 (.可视, 假)
赋值 (., -1)

.子程序 _外形框3_转换按钮_被单击, 空白型, , 
.如果真 (等于 (未知支持库函数_0 (), 假))
    赋值 (提示窗口标题, “转换失败！”)
    赋值 (提示窗口图标, 1)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, “Excel 程序创建失败！可能没有安装Excel2000。”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    返回 ()
.如果真结束
载入 (进度指示窗口, , 假)
赋值 (进度指示窗口..内容, “正在进行转换...请不要进行任何其它操作！”)
进度指示窗口.刷新显示 ()
赋值 (., 相加 (使用单位, “图书室会员一览表”))
.未知支持库函数_6 ()
赋值 (., 真)
未知支持库函数_21 ()
.计次循环首 (., ZCK_M)
    赋值 (., ZCK_M)
    赋值 (., 相加 (“表格”, 数值到格式文本 (ZCK_M, , 假)))
.计次循环尾 ()
赋值 (., 1)
设置表格 (“A1”, “E1”)
未知支持库函数_26 ()
赋值 (., 40)
赋值 (., 10)
赋值 (., 相加 (使用单位, “图书室会员一览表”))
赋值 (., 真)
赋值 (., 取颜色值 (41, 115, 164))
赋值 (., 20)
赋值 (., 真)
赋值 (., -4108)
会员创建表格 ()
.未知支持库函数_31 ()
赋值 (., 85)
进度指示窗口.销毁 ()

.子程序 会员创建表格, 空白型, , 
.参数 工作表, 未知类型0x80002, 参考, 

.局部变量 计次变量, 整数型, , , 

设置表格 (工作表, “A2”, “A2”)
赋值 (., 10)
赋值 (., 30)
赋值 (., -4108)
1.未知支持库函数_30 (2, 0)
赋值 (工作表., “借书证编号”)
设置表格 (工作表, “B2”, “B2”)
赋值 (., 14)
赋值 (., -4108)
1.未知支持库函数_30 (2, 0)
赋值 (工作表., “姓  名”)
设置表格 (工作表, “C2”, “C2”)
赋值 (., 34)
赋值 (., -4108)
1.未知支持库函数_30 (2, 0)
赋值 (工作表., “单       位”)
设置表格 (工作表, “D2”, “D2”)
赋值 (., 13)
赋值 (., -4108)
1.未知支持库函数_30 (2, 0)
赋值 (工作表., “电  话”)
设置表格 (工作表, “E2”, “E2”)
赋值 (., 6)
赋值 (., -4108)
1.未知支持库函数_30 (2, 0)
赋值 (工作表., “VIP”)
置当前库 (“tsglhy”)
到首记录 ()
.计次循环首 (取记录数 (), ZCK_M)
    赋值 (进度指示窗口..位置, 相乘 (相除 (ZCK_M, 取记录数 ()), 100))
    主窗口设置表格内容 (工作表, 相加 (“A”, 数值到格式文本 (相加 (ZCK_M, 2), 0, 假)), “”, 读 (1))
    主窗口设置表格内容 (工作表, 相加 (“B”, 数值到格式文本 (相加 (ZCK_M, 2), 0, 假)), “”, 读 (2))
    主窗口设置表格内容 (工作表, 相加 (“C”, 数值到格式文本 (相加 (ZCK_M, 2), 0, 假)), “”, 读 (3))
    主窗口设置表格内容 (工作表, 相加 (“D”, 数值到格式文本 (相加 (ZCK_M, 2), 0, 假)), “”, 读 (4))
    主窗口设置表格内容 (工作表, 相加 (“E”, 数值到格式文本 (相加 (ZCK_M, 2), 0, 假)), “”, 到文本 (读 (5)))
    跳过 (1)
.计次循环尾 ()

.子程序 _外形框3_高级表格1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #Del键))
    保存子程序2 ()
.如果真结束
.如果真 (等于 (键代码, #回车键))
    .如果真 (并且 (等于 (未知支持库函数_4 (), 6), 等于 (未知支持库函数_3 (), 相减 (., 1))))
        _外形框3_添加按钮_被单击 ()
    .如果真结束
    
.如果真结束
赋值 (会员修改操作, 真)
返回 (真)

.子程序 _外形框3_高级表格1_结束编辑, 空白型, , 
保存子程序2 ()
赋值 (会员修改操作, 真)

.子程序 _卷帘式菜单1_菜单被改变, 空白型, , 
.参数 菜单索引, 整数型, , 

.局部变量 操作内容, 文本型, , , 

置当前库 (“tsglzz”)
.如果真 (图书添加操作)
    赋值 (操作内容, 相加 (操作内容, “添加图书。”))
.如果真结束
.如果真 (图书删除操作)
    赋值 (操作内容, 相加 (操作内容, “删除图书。”))
.如果真结束
.如果真 (图书修改操作)
    赋值 (操作内容, 相加 (操作内容, “修改图书。”))
.如果真结束
.如果真 (图书重新编号)
    赋值 (操作内容, 相加 (操作内容, “图书重新编号。”))
.如果真结束
.如果真 (不等于 (操作内容, “”))
    加记录 (取现行时间 (), 操作者, 操作内容)
    连续赋值 (假, 图书添加操作, 图书删除操作, 图书修改操作, 图书重新编号)
    赋值 (操作内容, “”)
.如果真结束
.如果真 (会员添加操作)
    赋值 (操作内容, 相加 (操作内容, “添加会员。”))
.如果真结束
.如果真 (会员删除操作)
    赋值 (操作内容, 相加 (操作内容, “删除会员。”))
.如果真结束
.如果真 (会员修改操作)
    赋值 (操作内容, 相加 (操作内容, “修改会员。”))
.如果真结束
.如果真 (会员重新编号)
    赋值 (操作内容, 相加 (操作内容, “会员重新编号。”))
.如果真结束
.如果真 (不等于 (操作内容, “”))
    加记录 (取现行时间 (), 操作者, 操作内容)
    连续赋值 (假, 会员添加操作, 会员删除操作, 会员修改操作, 会员重新编号)
    赋值 (操作内容, “”)
.如果真结束
写配置项 (相加 (运行目录, “\tsglsoft.ini”), “系统环境”, “现行选中菜单”, 数值到格式文本 (主窗口.., , 假))

.子程序 _超级按钮1_被单击, 空白型, , 
全部关闭 ()
主窗口.销毁 ()

.子程序 _超级按钮2_被单击, 空白型, , 
赋值 (主窗口., 2)


.子程序 _外形框5_编辑框1_获得焦点, 空白型, , 
置当前库 (“tsglhy”)
赋值 (.内容, 会员编号基本码)
获取焦点 ()
赋值 (.起始选择位置, -1)
赋值 (.可视, 假)

.子程序 _外形框5_编辑框1_内容被改变, 空白型, , 
置当前库 (“tsglhy”)
到首记录 ()
.如果 (查找 (等于 (.内容, 读 (1))))
    赋值 (.内容, 读 (2))
    赋值 (.内容, 读 (3))
    赋值 (.内容, 读 (4))
    赋值 (.选中, 读 (5))
    清空 ()
    .计次循环首 (10, 循环次数)
        .如果真 (不等于 (读 (相加 (相乘 (循环次数, 2), 4)), “”))
            相加 (“《”, 读 (相加 (相乘 (循环次数, 2), 4)), “》 ”, 到文本 (读 (相加 (相乘 (循环次数, 2), 5)))).加入项目 ()
        .如果真结束
        
    .计次循环尾 ()
    获取焦点 ()
    赋值 (.起始选择位置, -1)
.否则
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.选中, 假)
    清空 ()
.如果结束


.子程序 _外形框5_编辑框8_内容被改变, 空白型, , 
置当前库 (“tsgltsk”)
到首记录 ()
.如果 (查找 (等于 (.内容, 读 (1))))
    赋值 (.内容, 读 (2))
    赋值 (.内容, 读 (3))
    赋值 (.内容, 数值到格式文本 (读 (6), 0, 真))
.否则
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
.如果结束


.子程序 _外形框5_编辑框8_获得焦点, 空白型, , 
置当前库 (“tsgltsk”)
赋值 (.内容, 图书编号基本码)
赋值 (.起始选择位置, -1)
赋值 (.可视, 假)

.子程序 _外形框5_借书按钮_被单击, 空白型, , 
赋值 (V借阅数量, 0)
赋值 (P借阅数量, 0)
.如果真 (等于 (.内容, “”))
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示窗口图标, 2)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, “请输入借书证编号。”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示窗口图标, 2)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, “请输入图书编号。”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    获取焦点 ()
    返回 ()
.如果真结束
置当前库 (“tsglhy”)
到首记录 ()
.如果 (查找 (等于 (读 (1), .内容)))
    .计次循环首 (10, ZCK_M)
        .如果 (读 (5))
            .如果真 (不等于 (读 (相加 (相乘 (2, ZCK_M), 4)), “”))
                赋值 (VIP, 真)
                赋值 (V借阅数量, 相加 (V借阅数量, 1))
            .如果真结束
            
        .否则
            .如果真 (不等于 (读 (相加 (相乘 (2, ZCK_M), 4)), “”))
                赋值 (VIP, 假)
                赋值 (P借阅数量, 相加 (P借阅数量, 1))
            .如果真结束
            
        .如果结束
        
    .计次循环尾 ()
.否则
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示窗口图标, 2)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, 相加 (“找不到编号：”, .内容, “ 的借书证，请重新输入。”))
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    获取焦点 ()
    赋值 (.起始选择位置, -1)
    返回 ()
.如果结束
置当前库 (“tsgltsk”)
到首记录 ()
.如果 (查找 (等于 (读 (1), .内容)))
    .如果真 (小于 (读 (6), 1))
        赋值 (提示窗口标题, “提示！”)
        赋值 (提示窗口图标, 2)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, 相加 (“《”, .内容, “》库存为零，无法借出。”))
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
        获取焦点 ()
        赋值 (.起始选择位置, -1)
        返回 ()
    .如果真结束
    
.否则
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示窗口图标, 2)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, 相加 (“找不到编号为：”, .内容, “ 的图书，请重新输入。”))
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    获取焦点 ()
    赋值 (.起始选择位置, -1)
    返回 ()
.如果结束
.如果 (VIP)
    .如果 (小于 (V借阅数量, V1))
        置当前库 (“tsglhy”)
        到首记录 ()
        查找 (等于 (读 (1), .内容))
        .计次循环首 (10, ZCK_M)
            .如果真 (等于 (读 (相加 (相乘 (2, ZCK_M), 4)), .内容))
                赋值 (提示窗口标题, “提示！”)
                赋值 (提示窗口图标, 2)
                赋值 (提示窗口按钮数, 1)
                赋值 (提示信息, 相加 (.内容, “已经借了一本《”, .内容, “》请改借其它图书。”))
                载入 (提示窗口, , 真)
                赋值 (提示窗口标题, “”)
                赋值 (提示窗口图标, 0)
                赋值 (提示窗口按钮数, 0)
                赋值 (提示信息, “”)
                获取焦点 ()
                赋值 (.起始选择位置, -1)
                返回 ()
            .如果真结束
            .如果真 (等于 (读 (相加 (相乘 (2, ZCK_M), 4)), “”))
                写 (相加 (相乘 (2, ZCK_M), 4), .内容)
                写 (相加 (相乘 (2, ZCK_M), 5), 取日期 (取现行时间 ()))
                写 (28, 相加 (读 (28), 1)) ' 会员借书次数
                置当前库 (“tsgltsk”)
                到首记录 ()
                查找 (等于 (读 (1), .内容))
                写 (6, 相减 (读 (6), 1))
                写 (7, 相加 (读 (7), 1)) ' 某种图书被借次数
                跳出循环 ()
            .如果真结束
            
        .计次循环尾 ()
    .否则
        赋值 (提示窗口标题, “提示！”)
        赋值 (提示窗口图标, 2)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, 相加 (.内容, “ 的借阅数量已达到了VIP会员的最大限度，请归还部分已借图书后再借。”))
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
        获取焦点 ()
        赋值 (.起始选择位置, -1)
        返回 ()
    .如果结束
    
.否则
    .如果 (小于 (P借阅数量, P1))
        置当前库 (“tsglhy”)
        到首记录 ()
        查找 (等于 (读 (1), .内容))
        .计次循环首 (10, ZCK_M)
            .如果真 (等于 (读 (相加 (相乘 (2, ZCK_M), 4)), .内容))
                赋值 (提示窗口标题, “提示！”)
                赋值 (提示窗口图标, 2)
                赋值 (提示窗口按钮数, 1)
                赋值 (提示信息, 相加 (.内容, “已经借了一本《”, .内容, “》请改借其它图书。”))
                载入 (提示窗口, , 真)
                赋值 (提示窗口标题, “”)
                赋值 (提示窗口图标, 0)
                赋值 (提示窗口按钮数, 0)
                赋值 (提示信息, “”)
                获取焦点 ()
                赋值 (.起始选择位置, -1)
                返回 ()
            .如果真结束
            .如果真 (等于 (读 (相加 (相乘 (2, ZCK_M), 4)), “”))
                写 (相加 (相乘 (2, ZCK_M), 4), .内容)
                写 (相加 (相乘 (2, ZCK_M), 5), 取日期 (取现行时间 ()))
                写 (28, 相加 (读 (28), 1)) ' 会员借书次数
                置当前库 (“tsgltsk”)
                到首记录 ()
                查找 (等于 (读 (1), .内容))
                写 (6, 相减 (读 (6), 1))
                写 (7, 相加 (读 (7), 1)) ' 某种图书被借次数。
                跳出循环 ()
            .如果真结束
            
        .计次循环尾 ()
    .否则
        赋值 (提示窗口标题, “提示！”)
        赋值 (提示窗口图标, 2)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, 相加 (.内容, “ 的借阅数量已达到了普通会员的最大限度，请归还部分已借图书后再借。”))
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
        获取焦点 ()
        赋值 (.起始选择位置, -1)
        返回 ()
    .如果结束
    
.如果结束
相加 (“《”, .内容, “》 ”, 时间到文本 (取日期 (取现行时间 ()), )).加入项目 (#日期部分)
赋值 (提示窗口标题, “提示！”)
赋值 (提示窗口图标, 2)
赋值 (提示窗口按钮数, 1)
赋值 (提示信息, “借阅完成！”)
载入 (提示窗口, , 真)
赋值 (提示窗口标题, “”)
赋值 (提示窗口图标, 0)
赋值 (提示窗口按钮数, 0)
赋值 (提示信息, “”)
赋值 (.内容, 图书编号基本码)
获取焦点 ()
赋值 (.起始选择位置, -1)

.子程序 _外形框5_编辑框27_获得焦点, 空白型, , 
置当前库 (“tsglhy”)
赋值 (.可视, 假)

.子程序 _外形框5_编辑框27_内容被改变, 空白型, , 
置当前库 (“tsglhy”)
到首记录 ()
清空 ()
.如果真 (查找 (等于 (读 (1), .内容)))
    赋值 (是否VIP, 读 (5))
    .计次循环首 (10, ZCK_M)
        .如果真 (不等于 (读 (相加 (相乘 (2, ZCK_M), 4)), “”))
            .如果 (等于 (时间到文本 (读 (相加 (相乘 (2, ZCK_M), 5)), 2), “1899年12月30日”))
                赋值 (借阅时间, “”)
            .否则
                赋值 (借阅时间, 时间到文本 (读 (相加 (相乘 (2, ZCK_M), 5)), 2))
            .如果结束
            相加 (“《”, 读 (相加 (相乘 (2, ZCK_M), 4)), “》 ”, 借阅时间).加入项目 ()
        .如果真结束
        
    .计次循环尾 ()
.如果真结束


.子程序 _外形框5_还书按钮_被单击, 空白型, , 
赋值 (是否有选中项, 假)
.如果 (等于 (.内容, “”))
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示窗口图标, 2)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, “请输入借书证编号。”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    获取焦点 ()
    返回 ()
.否则
    置当前库 (“tsglhy”)
    到首记录 ()
    .如果真 (取反 (查找 (等于 (读 (1), .内容))))
        赋值 (提示窗口标题, “未找到！”)
        赋值 (提示窗口图标, 2)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, 相加 (“未找到编号”, #左引号, .内容, #右引号, “的借书证。”))
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
        获取焦点 ()
        赋值 (.被选择字符数, -1)
        返回 ()
    .如果真结束
    .如果真 (等于 (取项目数 (), 0))
        赋值 (提示窗口标题, “没有借书！”)
        赋值 (提示窗口图标, 2)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, “该会员没有借书。”)
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
        获取焦点 ()
        赋值 (.被选择字符数, -1)
        返回 ()
    .如果真结束
    
.如果结束
.计次循环首 (取项目数 (), ZCK_M)
    .如果真 (相减 (ZCK_M, 1).是否被选中 ())
        赋值 (是否有选中项, 真)
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
.如果 (是否有选中项)
    赋值 (提示窗口标题, “确认！”)
    赋值 (提示窗口图标, 3)
    赋值 (提示窗口按钮数, 2)
    赋值 (提示信息, “您确定要归还选定的图书吗？”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    .如果真 (等于 (提示窗口返回值, 1))
        赋值 (提示窗口返回值, 0)
        .计次循环首 (取项目数 (), ZCK_M)
            置当前库 (“tsglhy”)
            到首记录 ()
            .如果真 (相减 (ZCK_M, 1).是否被选中 ())
                赋值 (书名, 取文本中间 (相减 (ZCK_M, 1).取项目文本 (), 相加 (寻找文本 (相减 (ZCK_M, 1).取项目文本 (), “《”, , 假), 2), 相减 (寻找文本 (相减 (ZCK_M, 1).取项目文本 (), “》”, , 假), 寻找文本 (相减 (ZCK_M, 1).取项目文本 (), “《”, , 假), 2)))
                查找 (等于 (读 (1), .内容))
                .计次循环首 (10, ZCK_N)
                    .如果真 (等于 (读 (相加 (相乘 (ZCK_N, 2), 4)), 书名))
                        写 (相加 (相乘 (ZCK_N, 2), 4), “”)
                        写 (相加 (相乘 (ZCK_N, 2), 5), 到时间 (相减 (1899, 12, 30)))
                    .如果真结束
                    
                .计次循环尾 ()
                置当前库 (“tsgltsk”)
                到首记录 ()
                .如果 (查找 (等于 (读 (2), 书名))) ' 如果找不到提醒添加！
                    写 (6, 相加 (读 (6), 1))
                .否则
                    赋值 (提示窗口标题, “选择！”)
                    赋值 (提示窗口图标, 3)
                    赋值 (提示窗口按钮数, 2)
                    赋值 (提示信息, 相加 (“图书库中找不到《”, 书名, “》，现在添加吗？(添加后请立即完善该记录资料)”))
                    载入 (提示窗口, , 真)
                    赋值 (提示窗口标题, “”)
                    赋值 (提示窗口图标, 0)
                    赋值 (提示窗口按钮数, 0)
                    赋值 (提示信息, “”)
                    .如果真 (等于 (提示窗口返回值, 1))
                        赋值 (提示窗口返回值, 0)
                        加记录 (书名, , , 1, 1)
                        _卷帘式菜单1_项目被选择 (1, 0)
                        返回 ()
                    .如果真结束
                    
                .如果结束
                
            .如果真结束
            
        .计次循环尾 ()
        赋值 (提示窗口标题, “提示！”)
        赋值 (提示窗口图标, 4)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, “操作完成！”)
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
        _外形框5_编辑框27_内容被改变 ()
    .如果真结束
    
.否则
    赋值 (提示窗口标题, “选择图书！”)
    赋值 (提示窗口图标, 2)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, “您没有选择要归还的图书，请在要归还的图书前打√。”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    获取焦点 ()
.如果结束


.子程序 _选择列表框1_列表项被选择, 空白型, , 
赋值 (书名, 取文本中间 (.取项目文本 (.现行选中项), 相加 (寻找文本 (.取项目文本 (.现行选中项), “《”, , 假), 2), 相减 (寻找文本 (.取项目文本 (.现行选中项), “》”, , 假), 寻找文本 (.取项目文本 (.现行选中项), “《”, , 假), 2)))

.子程序 _超级按钮3_被单击, 空白型, , 
赋值 (主窗口., 假)
置托盘图标 (#图标, 软件名称)

.子程序 _主窗口_托盘事件, 空白型, , 
.参数 操作类型, 整数型, , 

赋值 (.可视, 真)
弹出托盘菜单 ()

.子程序 _我回来了_被选择, 空白型, , 
载入 (恢复窗口, , 真)
置托盘图标 (“”)

.子程序 _退出_被选择, 空白型, , 
赋值 (主窗口..可视, 假)
置托盘图标 (“”)
全部关闭 ()
主窗口.销毁 ()

.子程序 _外形框5_编辑框2_内容被改变, 空白型, , 
赋值 (.可视, 真)
置当前库 (“tsgltsk”)
到首记录 ()
清空 ()
赋值 (书名拼音, “”)
.判断循环首 (取反 (尾记录后 ()))
    赋值 (书名拼音, “”)
    .计次循环首 (绝对取整 (相除 (取文本长度 (读 (2)), 2)), 循环次数)
        赋值 (书名拼音, 相加 (书名拼音, 取文本左边 (取声母 (取文本中间 (读 (2), 相减 (相乘 (循环次数, 2), 1), 2), 1), 1)))
    .计次循环尾 ()
    .如果真 (大于 (寻找文本 (书名拼音, .内容, , 真), 0))
        相加 (读 (1), “|”, 读 (2)).加入项目 ()
    .如果真结束
    跳过 (1)
.判断循环尾 ()


.子程序 时间日期, 空白型, , 
.参数 参数, 文本型, , 

运行 (相加 (“rundll32.exe shell32.dll,Control_RunDLL timedate.cpl,,”, 参数), 真, )

.子程序 _外形框5_编辑框2_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #右光标键))
    获取焦点 ()
    赋值 (.现行选中项, 0)
.如果真结束
返回 (真)

.子程序 _列表框2_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    赋值 (.内容, 取文本左边 (.取项目文本 (.现行选中项), 相减 (寻找文本 (.取项目文本 (.现行选中项), “|”, , 假), 1)))
    .计次循环首 (相减 (取文本长度 (.取项目文本 (.现行选中项)), 寻找文本 (.取项目文本 (.现行选中项), “|”, , 假)), 循环次数)
        赋值 (书名拼音, 相加 (书名拼音, 取文本左边 (取声母 (取文本中间 (取文本右边 (.取项目文本 (.现行选中项), 相减 (取文本长度 (.取项目文本 (.现行选中项)), 寻找文本 (.取项目文本 (.现行选中项), “|”, , 假))), 相减 (相乘 (循环次数, 2), 1), 2), 1), 1)))
    .计次循环尾 ()
    赋值 (.内容, 书名拼音)
    获取焦点 ()
    赋值 (.起始选择位置, -1)
    获取焦点 ()
    赋值 (.可视, 假)
.如果真结束
.如果真 (等于 (键代码, #左光标键))
    获取焦点 ()
    赋值 (.现行选中项, -1)
.如果真结束
返回 (真)


.子程序 _外形框5_编辑框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _外形框5_编辑框8_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
    赋值 (.被选择字符数, -1)
.如果真结束


.子程序 _标签11_反馈事件, 整数型, , 
.参数 参数一, 整数型, , 
.参数 参数二, 整数型, , 

.如果真 (等于 (参数一, 热键F5))
    赋值 (., 3)
    赋值 (., 0)
    _卷帘式菜单1_项目被选择 (3, 0)
.如果真结束


.子程序 _外形框5_编辑框3_内容被改变, 空白型, , 
置当前库 (“tsglhy”)
到首记录 ()
清空 ()
.判断循环首 (取反 (尾记录后 ()))
    赋值 (姓名拼音, “”)
    .计次循环首 (相除 (绝对取整 (取文本长度 (读 (2))), 2), 循环次数)
        赋值 (姓名拼音, 相加 (姓名拼音, 取文本左边 (取声母 (取文本中间 (读 (2), 相减 (相乘 (循环次数, 2), 1), 2), 1), 1)))
    .计次循环尾 ()
    .如果真 (大于 (寻找文本 (姓名拼音, .内容, , 真), 0))
        相加 (读 (1), “|”, 读 (2)).加入项目 ()
    .如果真结束
    跳过 (1)
.判断循环尾 ()
赋值 (.可视, 真)

.子程序 _外形框5_编辑框27_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _外形框5_编辑框3_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #右光标键))
    获取焦点 ()
    赋值 (.现行选中项, 0)
.如果真结束


.子程序 _列表框3_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    赋值 (姓名拼音, “”)
    赋值 (.内容, 取文本左边 (.取项目文本 (.现行选中项), 相减 (寻找文本 (.取项目文本 (.现行选中项), “|”, , 假), 1)))
    .计次循环首 (相减 (取文本长度 (.取项目文本 (.现行选中项)), 寻找文本 (.取项目文本 (.现行选中项), “|”, , 假)), 循环次数)
        赋值 (姓名拼音, 相加 (姓名拼音, 取文本左边 (取声母 (取文本中间 (取文本右边 (.取项目文本 (.现行选中项), 相减 (取文本长度 (.取项目文本 (.现行选中项)), 寻找文本 (.取项目文本 (.现行选中项), “|”, , 假))), 相减 (相乘 (循环次数, 2), 1), 2), 1), 1)))
    .计次循环尾 ()
    赋值 (.内容, 姓名拼音)
    赋值 (.起始选择位置, -1)
    获取焦点 ()
    赋值 (.可视, 假)
.如果真结束
.如果真 (等于 (键代码, #左光标键))
    获取焦点 ()
    赋值 (.现行选中项, -1)
.如果真结束


.子程序 _外形框5_编辑框3_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)

.子程序 _列表框2_双击选择, 空白型, , 
赋值 (.内容, 取文本左边 (.取项目文本 (.现行选中项), 相减 (寻找文本 (.取项目文本 (.现行选中项), “|”, , 假), 1)))
.计次循环首 (相减 (取文本长度 (.取项目文本 (.现行选中项)), 寻找文本 (.取项目文本 (.现行选中项), “|”, , 假)), 循环次数)
    赋值 (书名拼音, 相加 (书名拼音, 取文本左边 (取声母 (取文本中间 (取文本右边 (.取项目文本 (.现行选中项), 相减 (取文本长度 (.取项目文本 (.现行选中项)), 寻找文本 (.取项目文本 (.现行选中项), “|”, , 假))), 相减 (相乘 (循环次数, 2), 1), 2), 1), 1)))
.计次循环尾 ()
赋值 (.内容, 书名拼音)
获取焦点 ()
赋值 (.起始选择位置, -1)
获取焦点 ()
赋值 (.可视, 假)


.子程序 _列表框3_双击选择, 空白型, , 
赋值 (姓名拼音, “”)
赋值 (.内容, 取文本左边 (.取项目文本 (.现行选中项), 相减 (寻找文本 (.取项目文本 (.现行选中项), “|”, , 假), 1)))
.计次循环首 (相减 (取文本长度 (.取项目文本 (.现行选中项)), 寻找文本 (.取项目文本 (.现行选中项), “|”, , 假)), 循环次数)
    赋值 (姓名拼音, 相加 (姓名拼音, 取文本左边 (取声母 (取文本中间 (取文本右边 (.取项目文本 (.现行选中项), 相减 (取文本长度 (.取项目文本 (.现行选中项)), 寻找文本 (.取项目文本 (.现行选中项), “|”, , 假))), 相减 (相乘 (循环次数, 2), 1), 2), 1), 1)))
.计次循环尾 ()
赋值 (.内容, 姓名拼音)
赋值 (.起始选择位置, -1)
获取焦点 ()
赋值 (.可视, 假)

.子程序 _外形框5_丢失按钮_被单击, 空白型, , 
.局部变量 会员姓名, 文本型, , , 
.局部变量 丢失赔偿金, 小数型, , , 

.如果真 (等于 (.内容, “”))
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示窗口图标, 2)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, “请输入借书证编号。”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    获取焦点 ()
    返回 ()
.如果真结束
置当前库 (“tsglhy”)
到首记录 ()
.如果真 (取反 (查找 (等于 (读 (1), .内容))))
    赋值 (提示窗口标题, “未找到！”)
    赋值 (提示窗口图标, 2)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, 相加 (“未找到编号”, #左引号, .内容, #右引号, “的借书证。”))
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    获取焦点 ()
    赋值 (.被选择字符数, -1)
    返回 ()
.如果真结束
赋值 (是否VIP, 读 (5))
赋值 (会员姓名, 读 (2))
.如果真 (等于 (取项目数 (), 0))
    赋值 (提示窗口标题, “没有借书！”)
    赋值 (提示窗口图标, 2)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, “该会员没有借书。”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    获取焦点 ()
    赋值 (.被选择字符数, -1)
    返回 ()
.如果真结束
赋值 (是否有选中项, 假)
.计次循环首 (取项目数 (), 循环次数)
    .如果真 (相减 (循环次数, 1).是否被选中 ())
        赋值 (是否有选中项, 真)
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
.如果 (是否有选中项)
    赋值 (提示窗口标题, “确认丢失！”)
    赋值 (提示窗口图标, 3)
    赋值 (提示窗口按钮数, 2)
    赋值 (提示信息, “确定被选中的图书丢失了吗？”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    .如果 (等于 (提示窗口返回值, 1))
        赋值 (提示窗口返回值, 0)
        赋值 (图书价值, 0)
        .计次循环首 (取项目数 (), 循环次数)
            .如果真 (相减 (循环次数, 1).是否被选中 ())
                赋值 (书名, “”)
                赋值 (书名, 取文本中间 (相减 (循环次数, 1).取项目文本 (), 相加 (寻找文本 (相减 (循环次数, 1).取项目文本 (), “《”, , 假), 2), 相减 (寻找文本 (相减 (循环次数, 1).取项目文本 (), “》”, , 假), 寻找文本 (相减 (循环次数, 1).取项目文本 (), “《”, , 假), 2)))
                置当前库 (“tsgltsk”)
                到首记录 ()
                查找 (等于 (读 (2), 书名))
                写 (5, 相减 (读 (5), 1)) ' 该图书数量减1，库存量不变。
                赋值 (图书价值, 相加 (图书价值, 读 (4)))
                置当前库 (“tsglhy”)
                到首记录 ()
                查找 (等于 (读 (1), .内容))
                .计次循环首 (10, 循环次数)
                    .如果真 (等于 (读 (相加 (相乘 (循环次数, 2), 4)), 书名))
                        写 (相加 (相乘 (循环次数, 2), 4), “”)
                        跳出循环 () ' 由于每次循环只删除用户所借的一本书，所以为了提高速度，不需要继续找下去了。
                    .如果真结束
                    
                .计次循环尾 ()
            .如果真结束
            
        .计次循环尾 ()
        .如果 (是否VIP)
            赋值 (提示窗口标题, “收取赔偿金！”)
            赋值 (提示窗口图标, 4)
            赋值 (提示窗口按钮数, 1)
            赋值 (丢失赔偿金, 相乘 (图书价值, V4))
            赋值 (提示信息, 相加 (会员姓名, “是VIP，应收取赔偿金：”, 数值到格式文本 (丢失赔偿金, 2, 假), “元”, #换行符, 数值到格式文本 (图书价值, 2, 假), “元（图书价值）×”, 数值到格式文本 (V4, 2, 假), “倍（丢失赔偿率）＝”, 数值到格式文本 (相乘 (V4, 图书价值), 2, 假), “元。”))
            载入 (提示窗口, , 真)
            赋值 (提示窗口标题, “”)
            赋值 (提示窗口图标, 0)
            赋值 (提示窗口按钮数, 0)
            赋值 (提示信息, “”)
        .否则
            赋值 (提示窗口标题, “收取赔偿金！”)
            赋值 (提示窗口图标, 4)
            赋值 (提示窗口按钮数, 1)
            赋值 (丢失赔偿金, 相乘 (图书价值, P4))
            赋值 (提示信息, 相加 (会员姓名, “是普通会员，应收取赔偿金：”, 数值到格式文本 (丢失赔偿金, 2, 假), “元”, #换行符, 数值到格式文本 (图书价值, 2, 假), “元（图书价值）×”, 数值到格式文本 (P4, 2, 假), “倍（丢失赔偿率）＝”, 数值到格式文本 (相乘 (P4, 图书价值), 2, 假), “元。”))
            载入 (提示窗口, , 真)
            赋值 (提示窗口标题, “”)
            赋值 (提示窗口图标, 0)
            赋值 (提示窗口按钮数, 0)
            赋值 (提示信息, “”)
        .如果结束
        置当前库 (“jfgl”)
        加记录 (取现行时间 (), 相加 (“收”, 会员姓名, “丢失赔偿金”), 丢失赔偿金, , “丢赔”)
        修改 (求和 (读 (3), ))
        _外形框5_编辑框27_内容被改变 ()
    .否则
        获取焦点 ()
        返回 ()
    .如果结束
    
.否则
    赋值 (提示窗口标题, “选择图书！”)
    赋值 (提示窗口图标, 2)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, “您没有选择丢失的图书，请在丢失的图书前打√。”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    获取焦点 ()
.如果结束


.子程序 _外形框5_损坏按钮_被单击, 空白型, , 
.局部变量 会员姓名, 文本型, , , 
.局部变量 损坏赔偿金, 小数型, , , 

 ' 丢失与损坏的区别，丢失：图书数量减1，库存不加，损坏：图书数量不减，库存增加。（除有赔偿金外，其它象还书。）
.如果真 (等于 (.内容, “”))
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示窗口图标, 2)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, “请输入借书证编号。”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    获取焦点 ()
    返回 ()
.如果真结束
置当前库 (“tsglhy”)
到首记录 ()
.如果真 (取反 (查找 (等于 (读 (1), .内容))))
    赋值 (提示窗口标题, “未找到！”)
    赋值 (提示窗口图标, 2)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, 相加 (“未找到编号”, #左引号, .内容, #右引号, “的借书证。”))
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    获取焦点 ()
    赋值 (.被选择字符数, -1)
    返回 ()
.如果真结束
赋值 (是否VIP, 读 (5))
赋值 (会员姓名, 读 (2))
.如果真 (等于 (取项目数 (), 0))
    赋值 (提示窗口标题, “没有借书！”)
    赋值 (提示窗口图标, 2)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, “该会员没有借书。”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    获取焦点 ()
    赋值 (.被选择字符数, -1)
    返回 ()
.如果真结束
赋值 (是否有选中项, 假)
.计次循环首 (取项目数 (), 循环次数)
    .如果真 (相减 (循环次数, 1).是否被选中 ())
        赋值 (是否有选中项, 真)
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
.如果 (是否有选中项)
    赋值 (提示窗口标题, “确认损坏！”)
    赋值 (提示窗口图标, 3)
    赋值 (提示窗口按钮数, 2)
    赋值 (提示信息, “确定被选中的图书损坏了吗？”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    .如果 (等于 (提示窗口返回值, 1))
        赋值 (提示窗口返回值, 0)
        赋值 (图书价值, 0)
        .计次循环首 (取项目数 (), 循环次数)
            .如果真 (相减 (循环次数, 1).是否被选中 ())
                赋值 (书名, “”)
                赋值 (书名, 取文本中间 (相减 (循环次数, 1).取项目文本 (), 相加 (寻找文本 (相减 (循环次数, 1).取项目文本 (), “《”, , 假), 2), 相减 (寻找文本 (相减 (循环次数, 1).取项目文本 (), “》”, , 假), 寻找文本 (相减 (循环次数, 1).取项目文本 (), “《”, , 假), 2)))
                置当前库 (“tsgltsk”)
                到首记录 ()
                查找 (等于 (读 (2), 书名))
                写 (6, 相加 (读 (6), 1)) ' 该图书数量不减，库存量加1。（与还书相同）
                赋值 (图书价值, 相加 (图书价值, 读 (4)))
                置当前库 (“tsglhy”)
                到首记录 ()
                查找 (等于 (读 (1), .内容))
                .计次循环首 (10, 循环次数)
                    .如果真 (等于 (读 (相加 (相乘 (循环次数, 2), 4)), 书名))
                        写 (相加 (相乘 (循环次数, 2), 4), “”)
                        跳出循环 () ' 由于每次循环只删除用户所借的一本书，所以为了提高速度，不需要继续找下去了。
                    .如果真结束
                    
                .计次循环尾 ()
            .如果真结束
            
        .计次循环尾 ()
        .如果 (是否VIP)
            赋值 (提示窗口标题, “收取赔偿金！”)
            赋值 (提示窗口图标, 4)
            赋值 (提示窗口按钮数, 1)
            赋值 (损坏赔偿金, 相乘 (图书价值, V5))
            赋值 (提示信息, 相加 (会员姓名, “是VIP，应收取赔偿金：”, 数值到格式文本 (损坏赔偿金, 2, 假), “元”, #换行符, 数值到格式文本 (图书价值, 2, 假), “元（图书价值）×”, 数值到格式文本 (V5, 2, 假), “倍（损坏赔偿率）＝”, 数值到格式文本 (相乘 (V5, 图书价值), 2, 假), “元。”))
            载入 (提示窗口, , 真)
            赋值 (提示窗口标题, “”)
            赋值 (提示窗口图标, 0)
            赋值 (提示窗口按钮数, 0)
            赋值 (提示信息, “”)
        .否则
            赋值 (提示窗口标题, “收取赔偿金！”)
            赋值 (提示窗口图标, 4)
            赋值 (提示窗口按钮数, 1)
            赋值 (损坏赔偿金, 相乘 (图书价值, P5))
            赋值 (提示信息, 相加 (会员姓名, “是普通会员，应收取赔偿金：”, 数值到格式文本 (损坏赔偿金, 2, 假), “元”, #换行符, 数值到格式文本 (图书价值, 2, 假), “元（图书价值）×”, 数值到格式文本 (P5, 2, 假), “倍（损坏赔偿率）＝”, 数值到格式文本 (相乘 (P5, 图书价值), 2, 假), “元。”))
            载入 (提示窗口, , 真)
            赋值 (提示窗口标题, “”)
            赋值 (提示窗口图标, 0)
            赋值 (提示窗口按钮数, 0)
            赋值 (提示信息, “”)
        .如果结束
        置当前库 (“jfgl”)
        加记录 (取现行时间 (), 相加 (“收”, 会员姓名, “损坏赔偿金”), 损坏赔偿金, , “损赔”)
        修改 (求和 (读 (3), ))
        _外形框5_编辑框27_内容被改变 ()
    .否则
        获取焦点 ()
        返回 ()
    .如果结束
    
.否则
    赋值 (提示窗口标题, “选择图书！”)
    赋值 (提示窗口图标, 2)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, “您没有选择丢失的图书，请在丢失的图书前打√。”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    获取焦点 ()
.如果结束


.子程序 _选择框2_被单击, 空白型, , 
.如果 (.选中)
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
.如果结束
获取焦点 ()

.子程序 _选择框3_被单击, 空白型, , 
.如果 (.选中)
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
.如果结束
获取焦点 ()

.子程序 _外形框5_关闭按钮_被单击, 空白型, , 
赋值 (.可视, 假)
赋值 (., -1)

.子程序 _时钟1_周期事件, 空白型, , 
置等待鼠标 ()
赋值 (.时钟周期, 0)
置当前库 (“tsglhy”)
到首记录 ()
赋值 (是否显示催还, 假)
.判断循环首 (取反 (尾记录后 ()))
    .计次循环首 (10, 循环次数)
        .如果 (读 (5)) ' 判断是否是VIP
            .如果真 (并且 (大于或等于 (取时间间隔 (取现行时间 (), 读 (相加 (相乘 (循环次数, 2), 5)), 5), V2), 不等于 (读 (相加 (相乘 (循环次数, 2), 4)), “”)))
                赋值 (是否显示催还, 真)
                跳出循环 ()
            .如果真结束
            
        .否则
            .如果真 (并且 (大于或等于 (取时间间隔 (取现行时间 (), 读 (相加 (相乘 (循环次数, 2), 5)), 5), P2), 不等于 (读 (相加 (相乘 (循环次数, 2), 4)), “”)))
                赋值 (是否显示催还, 真)
                跳出循环 ()
            .如果真结束
            
        .如果结束
        
    .计次循环尾 ()
    .如果真 (是否显示催还)
        跳出循环 ()
    .如果真结束
    跳过 (1)
.判断循环尾 ()
.如果真 (是否显示催还)
    赋值 (., 真)
    赋值 (.可视, 真)
    赋值 (.内容, 相加 (“(普通会员借阅期限：”, 数值到格式文本 (P2, , 假), “天；VIP借阅期限：”, 数值到格式文本 (V2, , 假), “天。借阅期限可由管理员在”, #左引号, “系统管理”, #右引号, “→”, #左引号, “系统参数”, #右引号, “里设置)”))
    .计次循环首 (., )
        0.未知支持库函数_36 ()
    .计次循环尾 ()
    .计次循环首 (., )
        0.未知支持库函数_37 ()
    .计次循环尾 ()
    赋值 (., 6)
    赋值 (., 1)
    赋值 (., 1)
    赋值 (., 1)
    0.未知支持库函数_9 (0, 1, “序号”)
    0.未知支持库函数_9 (1, 1, “借书证编号”)
    0.未知支持库函数_9 (2, 1, “姓    名”)
    0.未知支持库函数_9 (3, 1, “单          位”)
    0.未知支持库函数_9 (4, 1, “VIP”)
    0.未知支持库函数_9 (5, 1, “所借图书及借阅天数”)
    0.未知支持库函数_32 (40)
    1.未知支持库函数_32 (70)
    2.未知支持库函数_32 (80)
    3.未知支持库函数_32 (200)
    4.未知支持库函数_32 (40)
    5.未知支持库函数_32 (400)
    到首记录 ()
    .判断循环首 (取反 (尾记录后 ()))
        赋值 (书名, “”)
        赋值 (是否显示催还, 假)
        .计次循环首 (10, 循环次数)
            .如果 (读 (5)) ' 判断是否是VIP
                .如果真 (并且 (大于或等于 (取时间间隔 (取现行时间 (), 读 (相加 (相乘 (循环次数, 2), 5)), 5), V2), 不等于 (读 (相加 (相乘 (循环次数, 2), 4)), “”)))
                    赋值 (是否显示催还, 真)
                    赋值 (书名, 相加 (书名, “《”, 读 (相加 (相乘 (循环次数, 2), 4)), “》”, “(已借：”, 数值到格式文本 (取时间间隔 (取现行时间 (), 读 (相加 (相乘 (循环次数, 2), 5)), 5), 0, 假), “天) ”))
                .如果真结束
                
            .否则
                .如果真 (并且 (大于或等于 (取时间间隔 (取现行时间 (), 读 (相加 (相乘 (循环次数, 2), 5)), 5), P2), 不等于 (读 (相加 (相乘 (循环次数, 2), 4)), “”)))
                    赋值 (是否显示催还, 真)
                    赋值 (书名, 相加 (书名, “《”, 读 (相加 (相乘 (循环次数, 2), 4)), “》”, “(已借：”, 数值到格式文本 (取时间间隔 (取现行时间 (), 读 (相加 (相乘 (循环次数, 2), 5)), 5), 0, 假), “天) ”))
                .如果真结束
                
            .如果结束
            
        .计次循环尾 ()
        .如果真 (是否显示催还)
            数值到格式文本 (., , 假).未知支持库函数_38 (相加 (., 1))
            4.未知支持库函数_30 (5)
            相减 (., 1).未知支持库函数_9 (1, 1, 读 (1))
            相减 (., 1).未知支持库函数_9 (2, 1, 读 (2))
            相减 (., 1).未知支持库函数_9 (3, 1, 读 (3))
            相减 (., 1).未知支持库函数_9 (4, 5, 读 (5))
            相减 (., 1).未知支持库函数_9 (5, 1, 书名)
        .如果真结束
        跳过 (1)
    .判断循环尾 ()
    0.未知支持库函数_25 (0, 0, 6, 2)
    1.未知支持库函数_25 (0, 相减 (., 1), 2, 2)
.如果真结束
恢复鼠标 ()


.子程序 _外形框8_关闭按钮_被单击, 空白型, , 
赋值 (., 假)
赋值 (.可视, 假)
赋值 (., -1)

.子程序 _外形框8_打印按钮_被单击, 空白型, , 
赋值 (表头标志, “催还”)
载入 (置打印表头窗口, , 真)

.程序集 启动子程序程序集, , , 

.程序集变量 字符位置, 整数型, , , 
.程序集变量 字符表, 文本型, , , 
.程序集变量 循环计数器, 整数型, , , 
.程序集变量 事件句柄, 整数型, , , 
.程序集变量 硬盘特征码, 文本型, , , 
.程序集变量 日期代码, 文本型, , , 
.程序集变量 上次运行日期代码, 文本型, , , 
.子程序 _启动子程序, 整数型, , 本子程序在程序启动后最先执行
赋值 (运行目录, 取运行目录 ())
载入 (启动信息窗口, , 假)
赋值 (启动信息窗口..内容, “软件启动信息”)
启动信息窗口.刷新显示 ()
启动信息窗口.清空 (.)
.如果真 (或者 (小于 (取屏幕宽度 (), 1024), 小于 (取屏幕高度 (), 768)))
    启动信息窗口.加入项目 (., “！  屏幕分辨率设置太低”, )
    启动信息窗口.刷新显示 ()
    延时 (50)
    赋值 (提示窗口标题, “分辨率设置太低！”)
    赋值 (提示窗口图标, 3)
    赋值 (提示窗口按钮数, 2)
    赋值 (提示信息, “显示器分辨率设置太低，可能导致无法正常显示，现在要更改设置吗？”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    .如果真 (等于 (提示窗口返回值, 1))
        赋值 (提示窗口返回值, 0)
        显示 (“3”)
        _启动子程序 ()
        返回 (1)
    .如果真结束
    
.如果真结束
启动信息窗口.加入项目 (., “√  屏幕分辨率检测通过”, )
启动信息窗口.刷新显示 ()
延时 (50)
.如果 (写配置项 (相加 (运行目录, “\tsglsoft.ini”), “系统参数”, “安装目录”, 运行目录))
    启动信息窗口.加入项目 (., “√  向配置项写入软件运行目录成功”, )
    启动信息窗口.刷新显示 ()
    延时 (50)
.否则
    启动信息窗口.加入项目 (., “×  向配置项写入软件运行目录失败”, )
    启动信息窗口.刷新显示 ()
    延时 (50)
.如果结束
赋值 (软件名称, 读配置项 (相加 (运行目录, “\tsglsoft.ini”), “系统参数”, “软件名称”, “图书管理软件v1.0”))
.如果 (不等于 (软件名称, “”))
    启动信息窗口.加入项目 (., “√  从配置项读入软件名称成功”, )
    启动信息窗口.刷新显示 ()
    延时 (50)
.否则
    启动信息窗口.加入项目 (., “×  从配置项读入软件名称失败”, )
    启动信息窗口.刷新显示 ()
    延时 (50)
.如果结束
赋值 (使用单位, 读配置项 (相加 (运行目录, “\tsglsoft.ini”), “系统参数”, “使用单位”, “一营一连”))
.如果 (不等于 (使用单位, “”))
    启动信息窗口.加入项目 (., “√  从配置项读入软件使用单位成功”, )
    启动信息窗口.刷新显示 ()
    延时 (50)
.否则
    启动信息窗口.加入项目 (., “×  从配置项读入软件使用单位失败”, )
    启动信息窗口.刷新显示 ()
    延时 (50)
.如果结束
赋值 (TSB, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “编码长度”, “图书”, “4”)))
.如果 (不等于 (TSB, 0))
    启动信息窗口.加入项目 (., “√  从配置项读入图书编码长度成功”, )
    启动信息窗口.刷新显示 ()
    延时 (50)
.否则
    启动信息窗口.加入项目 (., “×  从配置项读入图书编码长度失败”, )
    启动信息窗口.刷新显示 ()
    延时 (50)
.如果结束
赋值 (HYB, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “编码长度”, “借书证”, “3”)))
.如果 (不等于 (HYB, 0))
    启动信息窗口.加入项目 (., “√  从配置项读入会员编码长度成功”, )
    启动信息窗口.刷新显示 ()
    延时 (50)
.否则
    启动信息窗口.加入项目 (., “×  从配置项读入会员编码长度失败”, )
    启动信息窗口.刷新显示 ()
    延时 (50)
.如果结束
.如果真 (等于 (模块_程序是否已运行 (“禁止多次运行”), 真))
    启动信息窗口.加入项目 (., “×  是否重复运行检测未通过”, )
    启动信息窗口.刷新显示 ()
    延时 (50)
    赋值 (提示窗口标题, “禁止重复启动”)
    赋值 (提示窗口图标, 2)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, 相加 (“《”, 软件名称, “》已经运行，不要重复启动！”))
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    结束 ()
.如果真结束
启动信息窗口.加入项目 (., “√  是否重复运行检测通过”, )
启动信息窗口.刷新显示 ()
延时 (50)
.如果 (文件是否存在 (相加 (运行目录, “\data\jfgl.edb”))) ' 经费管理数据库
    启动信息窗口.加入项目 (., “√  检查数据库文件 jfgl.edb 通过”, )
    启动信息窗口.刷新显示 ()
    延时 (50)
    .如果 (文件是否存在 (相加 (运行目录, “\data\hysz.edb”))) ' 用户设置参数数据库
        启动信息窗口.加入项目 (., “√  检查数据库文件 hysz.edb 通过”, )
        启动信息窗口.刷新显示 ()
        延时 (50)
        .如果 (文件是否存在 (相加 (运行目录, “\data\tsglhy.edb”))) ' 会员资料数据库
            启动信息窗口.加入项目 (., “√  检查数据库文件 tsglhy.edb 通过”, )
            启动信息窗口.刷新显示 ()
            延时 (50)
            .如果 (文件是否存在 (相加 (运行目录, “\data\tsgltsk.edb”))) ' 图书资料数据库
                启动信息窗口.加入项目 (., “√  检查数据库文件 tsgltsk.edb 通过”, )
                启动信息窗口.刷新显示 ()
                延时 (50)
                .如果 (文件是否存在 (相加 (运行目录, “\data\tsglzz.edb”))) ' 系统运行日志数据库
                    启动信息窗口.加入项目 (., “√  检查数据库文件 tsglzz.edb 通过”, )
                    启动信息窗口.刷新显示 ()
                    延时 (50)
                    .如果 (文件是否存在 (相加 (运行目录, “\data\yhgl.edb”))) ' 用户资料数据库
                        启动信息窗口.加入项目 (., “√  检查数据库文件 yhgl.edb 通过”, )
                        启动信息窗口.刷新显示 ()
                        延时 (50)
                        .如果 (文件是否存在 (相加 (运行目录, “\data\tsgltskcx.edb”))) ' 图书查询结果数据库
                            启动信息窗口.加入项目 (., “√  检查数据库文件 tsgltskcx.edb 通过”, )
                            启动信息窗口.刷新显示 ()
                            延时 (50)
                            .如果 (文件是否存在 (相加 (运行目录, “\data\tsglhycx.edb”))) ' 会员查询结果数据库
                                启动信息窗口.加入项目 (., “√  检查数据库文件 tsgltskcx.edb 通过”, )
                                启动信息窗口.刷新显示 ()
                                延时 (50)
                                .如果 (打开 (相加 (运行目录, “\data\hysz.edb”), “hysz”, 假, 4, , “ujumpitoo@jdyltsgl1.com”, ))
                                    启动信息窗口.加入项目 (., “√  打开数据库文件 hysz.edb 成功”, )
                                    启动信息窗口.刷新显示 ()
                                    延时 (50)
                                    .如果 (打开 (相加 (运行目录, “\data\tsglhy.edb”), “tsglhy”, 假, 4, , “ujumpitoo@jdyltsgl2.com”, ))
                                        启动信息窗口.加入项目 (., “√  打开数据库文件 tsglhy.edb 成功”, )
                                        启动信息窗口.刷新显示 ()
                                        延时 (50)
                                        .如果 (打开 (相加 (运行目录, “\data\tsgltsk.edb”), “tsgltsk”, 假, 4, , “ujumpitoo@jdyltsgl3.com”, ))
                                            启动信息窗口.加入项目 (., “√  打开数据库文件 tsgltsk.edb 成功”, )
                                            启动信息窗口.刷新显示 ()
                                            延时 (50)
                                            .如果 (打开 (相加 (运行目录, “\data\tsglzz.edb”), “tsglzz”, 假, 4, , “ujumpitoo@jdyltsgl4.com”, ))
                                                启动信息窗口.加入项目 (., “√  打开数据库文件 tsglzz.edb 成功”, )
                                                启动信息窗口.刷新显示 ()
                                                延时 (50)
                                                .如果 (打开 (相加 (运行目录, “\data\yhgl.edb”), “yhgl”, 假, 4, , “ujumpitoo@jdyltsgl5.com”, ))
                                                    启动信息窗口.加入项目 (., “√  打开数据库文件 yhgl.edb 成功”, )
                                                    启动信息窗口.刷新显示 ()
                                                    延时 (50)
                                                    .如果 (打开 (相加 (运行目录, “\data\tsgltskcx.edb”), “tsgltskcx”, 假, 4, , “ujumpitoo@jdyltsgl3.com”, ))
                                                        启动信息窗口.加入项目 (., “√  打开数据库文件 tsgltskcx.edb 成功”, )
                                                        启动信息窗口.刷新显示 ()
                                                        延时 (50)
                                                        .如果 (打开 (相加 (运行目录, “\data\tsglhycx.edb”), “tsglhycx”, 假, 4, , “ujumpitoo@jdyltsgl2.com”, ))
                                                            启动信息窗口.加入项目 (., “√  打开数据库文件 tsglhycx.edb 成功”, )
                                                            启动信息窗口.刷新显示 ()
                                                            延时 (50)
                                                            .如果 (打开 (相加 (运行目录, “\data\jfgl.edb”), “jfgl”, 假, 4, , “ujumpitoo@tsgl_jf_126.com”, ))
                                                                启动信息窗口.加入项目 (., “√  打开数据库文件 jfgl.edb 成功”, )
                                                                启动信息窗口.刷新显示 ()
                                                                延时 (50)
                                                            .否则
                                                                赋值 (提示窗口标题, “启动失败！”)
                                                                赋值 (提示窗口图标, 1)
                                                                赋值 (提示窗口按钮数, 1)
                                                                赋值 (提示信息, 相加 (“打开数据库文件 jfgl.edb 时失败，系统不能正常运行，现在关闭，稍候请重新启动《”, 软件名称, “》。”))
                                                                启动信息窗口.加入项目 (., “×  打开数据库文件 jfgl.edb 时失败”, )
                                                                启动信息窗口.刷新显示 ()
                                                                延时 (50)
                                                                载入 (提示窗口, , 真)
                                                                全部关闭 ()
                                                                结束 ()
                                                            .如果结束
                                                            
                                                        .否则
                                                            赋值 (提示窗口标题, “启动失败！”)
                                                            赋值 (提示窗口图标, 1)
                                                            赋值 (提示窗口按钮数, 1)
                                                            赋值 (提示信息, 相加 (“打开数据库文件 tsglhycx.edb 时失败，系统不能正常运行，现在关闭，稍候请重新启动《”, 软件名称, “》。”))
                                                            启动信息窗口.加入项目 (., “×  打开数据库文件 tsglhycx.edb 时失败”, )
                                                            启动信息窗口.刷新显示 ()
                                                            延时 (50)
                                                            载入 (提示窗口, , 真)
                                                            全部关闭 ()
                                                            结束 ()
                                                        .如果结束
                                                        
                                                    .否则
                                                        赋值 (提示窗口标题, “启动失败！”)
                                                        赋值 (提示窗口图标, 1)
                                                        赋值 (提示窗口按钮数, 1)
                                                        赋值 (提示信息, 相加 (“打开数据库文件 tsgltskcx.edb 时失败，系统不能正常运行，现在关闭，稍候请重新启动《”, 软件名称, “》。”))
                                                        启动信息窗口.加入项目 (., “×  打开数据库文件 tsgltskcx.edb 时失败”, )
                                                        启动信息窗口.刷新显示 ()
                                                        延时 (50)
                                                        载入 (提示窗口, , 真)
                                                        全部关闭 ()
                                                        结束 ()
                                                    .如果结束
                                                    
                                                .否则
                                                    赋值 (提示窗口标题, “启动失败！”)
                                                    赋值 (提示窗口图标, 1)
                                                    赋值 (提示窗口按钮数, 1)
                                                    赋值 (提示信息, 相加 (“打开数据库文件 yhgl.edb 时失败，系统不能正常运行，现在关闭，稍候请重新启动《”, 软件名称, “》。”))
                                                    启动信息窗口.加入项目 (., “×  打开数据库文件 yhgl.edb 时失败”, )
                                                    启动信息窗口.刷新显示 ()
                                                    延时 (50)
                                                    载入 (提示窗口, , 真)
                                                    全部关闭 ()
                                                    结束 ()
                                                .如果结束
                                                
                                            .否则
                                                赋值 (提示窗口标题, “启动失败！”)
                                                赋值 (提示窗口图标, 1)
                                                赋值 (提示窗口按钮数, 1)
                                                赋值 (提示信息, 相加 (“打开数据库文件 tsglzz.edb 时失败，系统不能正常运行，现在关闭，稍候请重新启动《”, 软件名称, “》。”))
                                                启动信息窗口.加入项目 (., “×  打开数据库文件 tsglzz.edb 时失败”, )
                                                启动信息窗口.刷新显示 ()
                                                延时 (50)
                                                载入 (提示窗口, , 真)
                                                全部关闭 ()
                                                结束 ()
                                            .如果结束
                                            
                                        .否则
                                            赋值 (提示窗口标题, “启动失败！”)
                                            赋值 (提示窗口图标, 1)
                                            赋值 (提示窗口按钮数, 1)
                                            赋值 (提示信息, 相加 (“打开数据库文件 tsgltsk.edb 时失败，系统不能正常运行，现在关闭，稍候请重新启动《”, 软件名称, “》。”))
                                            启动信息窗口.加入项目 (., “×  打开数据库文件 tsgltsk.edb 时失败”, )
                                            启动信息窗口.刷新显示 ()
                                            延时 (50)
                                            载入 (提示窗口, , 真)
                                            全部关闭 ()
                                            结束 ()
                                        .如果结束
                                        
                                    .否则
                                        赋值 (提示窗口标题, “启动失败！”)
                                        赋值 (提示窗口图标, 1)
                                        赋值 (提示窗口按钮数, 1)
                                        赋值 (提示信息, 相加 (“打开数据库文件 tsglhy.edb 时失败，系统不能正常运行，现在关闭，稍候请重新启动《”, 软件名称, “》。”))
                                        启动信息窗口.加入项目 (., “×  打开数据库文件 tsglhy.edb 时失败”, )
                                        启动信息窗口.刷新显示 ()
                                        延时 (50)
                                        载入 (提示窗口, , 真)
                                        全部关闭 ()
                                        结束 ()
                                    .如果结束
                                    
                                .否则
                                    赋值 (提示窗口标题, “启动失败！”)
                                    赋值 (提示窗口图标, 1)
                                    赋值 (提示窗口按钮数, 1)
                                    赋值 (提示信息, 相加 (“打开数据库文件 hysz.edb 时失败，系统不能正常运行，现在关闭，稍候请重新启动《”, 软件名称, “》。”))
                                    启动信息窗口.加入项目 (., “×  打开数据库文件 hysz.edb 时失败”, )
                                    启动信息窗口.刷新显示 ()
                                    延时 (50)
                                    载入 (提示窗口, , 真)
                                    全部关闭 ()
                                    结束 ()
                                .如果结束
                                
                            .否则
                                赋值 (提示窗口标题, “严重错误！”)
                                赋值 (提示窗口图标, 1)
                                赋值 (提示窗口按钮数, 1)
                                赋值 (提示信息, 相加 (运行目录, “\datat\目录下，数据库文件 tsglhycx.edb 丢失，系统不能正常运行，现在关闭，需要重新安装《”, 软件名称, “》。”))
                                启动信息窗口.加入项目 (., “×  数据库文件 tsglhycx.edb 丢失”, )
                                启动信息窗口.刷新显示 ()
                                延时 (50)
                                载入 (提示窗口, , 真)
                                全部关闭 ()
                                结束 ()
                            .如果结束
                            
                        .否则
                            赋值 (提示窗口标题, “严重错误！”)
                            赋值 (提示窗口图标, 1)
                            赋值 (提示窗口按钮数, 1)
                            赋值 (提示信息, 相加 (运行目录, “\datat\目录下，数据库文件 tsgltskcx.edb 丢失，系统不能正常运行，现在关闭，需要重新安装《”, 软件名称, “》。”))
                            启动信息窗口.加入项目 (., “×  数据库文件 tsgltskcx.edb 丢失”, )
                            启动信息窗口.刷新显示 ()
                            延时 (50)
                            载入 (提示窗口, , 真)
                            全部关闭 ()
                            结束 ()
                        .如果结束
                        
                    .否则
                        赋值 (提示窗口标题, “严重错误！”)
                        赋值 (提示窗口图标, 1)
                        赋值 (提示窗口按钮数, 1)
                        赋值 (提示信息, 相加 (运行目录, “\datat\目录下，数据库文件 yhgl.edb 丢失，系统不能正常运行，现在关闭，需要重新安装《”, 软件名称, “》。”))
                        启动信息窗口.加入项目 (., “×  数据库文件 yhgl.edb 丢失”, )
                        启动信息窗口.刷新显示 ()
                        延时 (50)
                        载入 (提示窗口, , 真)
                        全部关闭 ()
                        结束 ()
                    .如果结束
                    
                .否则
                    赋值 (提示窗口标题, “严重错误！”)
                    赋值 (提示窗口图标, 1)
                    赋值 (提示窗口按钮数, 1)
                    赋值 (提示信息, 相加 (运行目录, “\datat\目录下，数据库文件 tsglzz.edb 丢失，系统不能正常运行，现在关闭，需要重新安装《”, 软件名称, “》。”))
                    启动信息窗口.加入项目 (., “×  数据库文件 tsglzz.edb 丢失”, )
                    启动信息窗口.刷新显示 ()
                    延时 (50)
                    载入 (提示窗口, , 真)
                    全部关闭 ()
                    结束 ()
                .如果结束
                
            .否则
                赋值 (提示窗口标题, “严重错误！”)
                赋值 (提示窗口图标, 1)
                赋值 (提示窗口按钮数, 1)
                赋值 (提示信息, 相加 (运行目录, “\datat\目录下，数据库文件 tsgltsk.edb 丢失，系统不能正常运行，现在关闭，需要重新安装《”, 软件名称, “》。”))
                启动信息窗口.加入项目 (., “×  数据库文件 tsgltsk.edb 丢失”, )
                启动信息窗口.刷新显示 ()
                延时 (50)
                载入 (提示窗口, , 真)
                全部关闭 ()
                结束 ()
            .如果结束
            
        .否则
            赋值 (提示窗口标题, “严重错误！”)
            赋值 (提示窗口图标, 1)
            赋值 (提示窗口按钮数, 1)
            赋值 (提示信息, 相加 (运行目录, “\datat\目录下，数据库文件 tsglhy.edb 丢失，系统不能正常运行，现在关闭，需要重新安装《”, 软件名称, “》。”))
            启动信息窗口.加入项目 (., “×  数据库文件 tsglhy.edb 丢失”, )
            启动信息窗口.刷新显示 ()
            延时 (50)
            载入 (提示窗口, , 真)
            全部关闭 ()
            结束 ()
        .如果结束
        
    .否则
        赋值 (提示窗口标题, “严重错误！”)
        赋值 (提示窗口图标, 1)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, 相加 (运行目录, “\datat\目录下，数据库文件 hysz.edb 丢失，系统不能正常运行，现在关闭，需要重新安装《”, 软件名称, “》。”))
        启动信息窗口.加入项目 (., “×  数据库文件 hysz.edb 丢失”, )
        启动信息窗口.刷新显示 ()
        延时 (50)
        载入 (提示窗口, , 真)
        全部关闭 ()
        结束 ()
    .如果结束
    
.否则
    赋值 (提示窗口标题, “严重错误！”)
    赋值 (提示窗口图标, 1)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, 相加 (运行目录, “\datat\目录下，数据库文件 jfgl.edb 丢失，系统不能正常运行，现在关闭，需要重新安装《”, 软件名称, “》。”))
    启动信息窗口.加入项目 (., “×  数据库文件 jfgl.edb 丢失”, )
    启动信息窗口.刷新显示 ()
    延时 (50)
    载入 (提示窗口, , 真)
    全部关闭 ()
    结束 ()
.如果结束
置当前库 (“hysz”)
查找 (等于 (读 (1), “普通”))
赋值 (P1, 读 (2))
赋值 (P2, 读 (3))
赋值 (P3, 读 (4))
赋值 (P4, 读 (5))
赋值 (P5, 读 (6))
查找 (等于 (读 (1), “VIP”))
赋值 (V1, 读 (2))
赋值 (V2, 读 (3))
赋值 (V3, 读 (4))
赋值 (V4, 读 (5))
赋值 (V5, 读 (6))
赋值 (字符表, “WhereayellowriverclimbstothewhitecloudsNeartheonecity-wallamongten-thousand-footmountainsATartarunderthewillowsislamentingonhisfluteThatspringneverblowstohimthroughtheJadePass”) ' 共175个字符，内容是唐诗《出塞》的英译。
赋值 (计算结果, “”)
赋值 (硬盘特征码, 数值到格式文本 (位取反 (取硬盘特征字 ()), , 假))
.计次循环首 (取文本长度 (硬盘特征码), 循环计数器)
    赋值 (字符位置1, 相加 (相乘 (相减 (循环计数器, 1), 10), 到数值 (取文本中间 (硬盘特征码, 循环计数器, 1))))
    .如果真 (等于 (循环计数器, 1))
        赋值 (循环计数器, 相加 (取文本长度 (硬盘特征码), 1))
    .如果真结束
    赋值 (字符位置2, 相加 (字符位置1, 到数值 (取文本中间 (硬盘特征码, 相减 (循环计数器, 1), 1))))
    赋值 (计算结果, 相加 (计算结果, 取文本中间 (字符表, 字符位置1, 1), 取文本中间 (字符表, 字符位置2, 1)))
.计次循环尾 ()
赋值 (注册码, 取文本注册项 (#现行设置, “software\register\tsglsoft\”, “000”)) ' 注册码必须写在注册表相同位置！注意：“tsglsoft”前不加“\”。
.如果 (等于 (注册码, 计算结果))
    赋值 (是否注册, 真)
    启动信息窗口.加入项目 (., “√  注册验证通过”, )
    启动信息窗口.刷新显示 ()
    延时 (50)
.否则
    赋值 (是否注册, 假)
    启动信息窗口.加入项目 (., “×  注册验证失败”, )
    启动信息窗口.刷新显示 ()
    延时 (50)
    赋值 (提示窗口标题, “注册提示！”)
    赋值 (提示窗口图标, 3)
    赋值 (提示窗口按钮数, 2)
    赋值 (提示信息, 相加 (“您使用的 ”, 软件名称, “ 尚未注册，部分功能将无法使用！现在注册吗？”))
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    .如果真 (等于 (提示窗口返回值, 1))
        赋值 (提示窗口返回值, 0)
        载入 (注册窗口, , 真)
    .如果真结束
    
.如果结束
未知支持库函数_0 (1)
.如果真 (是否已创建 (启动信息窗口))
    启动信息窗口.销毁 ()
.如果真结束
载入 (登陆窗口, , 真)
返回 (1)

.子程序 模块_程序是否已运行, 逻辑型, 公开, 真表示已经运行，假表示还未运行
.参数 标志文本, 文本型, , 可以是任何文本，但是最好要长一点以保证和系统中已有其他事件对象的名称不相冲突。

.如果真 (不等于 (打开事件同步对象 (2031619, 假, “mysoftname:jdyltsgl”), 0)) ' "mysoftname:jdyltsgl"可以是任何文本，但是最好要长一点以保证和系统中已有其他事件对象的名称不相冲突。
    返回 (真)
.如果真结束
赋值 (事件句柄, 创建事件同步对象 (0, 假, 假, “mysoftname:jdyltsgl”))
返回 (假)

.子程序 模块_关闭事件同步对象, 空白型, 公开, 窗口销毁时调用
关闭同步事件对象 (事件句柄)

.子程序 显示, 空白型, , 
.参数 参数, 文本型, , 

运行 (相加 (“rundll32.exe shell32.dll,Control_RunDLL desk.cpl,,”, 参数), 真, )

.窗口程序集 注册窗口程序集, , , 

.子程序 _注册窗口_创建完毕, 空白型, , 
赋值 (.标题, 数值到格式文本 (取硬盘特征字 (), , 假))

.子程序 _超级按钮1_被单击, 空白型, , 
.如果真 (是否已创建 (启动信息窗口))
    启动信息窗口.销毁 ()
.如果真结束
运行 (相加 (“explorer ”, 运行目录, “\help\15.htm”), 假, #最大化激活)

.子程序 _超级按钮2_被单击, 空白型, , 
置剪辑板文本 (.标题)
赋值 (., 真)
赋值 (.文本颜色, 8421504)

.子程序 _注册窗口_确定按钮_被单击, 空白型, , 
.如果 (等于 (.内容, 计算结果))
    .如果 (写注册项 (#现行设置, “software\register\tsglsoft\”, .内容)) ' 注意：“tsglsoft”前不加“\”
        写注册项 (#现行设置, “software\registertime\tsglsoft\”, 时间到文本 (取现行时间 (), 1))
        写配置项 (相加 (运行目录, “\tsglsoft.ini”), “系统参数”, “注册码”, .内容)
        赋值 (是否注册, 真)
        置当前库 (“tsglzz”)
        加记录 (取现行时间 (), , 相加 (“注册成功，注册码：”, .内容))
        赋值 (提示窗口标题, “恭喜！”)
        赋值 (提示窗口图标, 4)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, “注册成功！感谢您的支持！”)
        载入 (提示窗口, , 真)
        .如果真 (是否已创建 (主窗口.))
            主窗口.未知支持库函数_10 (., 2, “注册信息”, 6)
            赋值 (主窗口..内容, 相加 (使用单位, #换行符, #换行符, “图书管理专用”))
            赋值 (主窗口..内容, 相加 (软件名称, “      使用权归 ”, 使用单位, “ 所有          操作员：”, 操作者))
        .如果真结束
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
    .否则
        赋值 (提示窗口标题, “抱歉！”)
        赋值 (提示窗口图标, 2)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, “您输入的注册码是正确的，但系统向注册表添加信息时发生了错误，注册不成功！但您可以稍候重试。”)
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
    .如果结束
    
.否则
    赋值 (提示窗口标题, “错误！”)
    赋值 (提示窗口图标, 2)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, “注册码错误！请重新输入。”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    获取焦点 ()
    赋值 (.被选择字符数, -1)
    返回 ()
.如果结束
.如果真 (是否已创建 (主窗口.))
    赋值 (主窗口.., -1)
.如果真结束
注册窗口.销毁 ()

.子程序 _注册窗口_取消按钮_被单击, 空白型, , 
.如果真 (是否已创建 (主窗口.))
    赋值 (主窗口.., -1)
.如果真结束
注册窗口.销毁 ()


.窗口程序集 提示窗口程序集, , , 

.子程序 _提示窗口_创建完毕, 空白型, , 
.如果真 (等于 (提示窗口图标, 1))
    赋值 (.图片, #错误)
.如果真结束
.如果真 (等于 (提示窗口图标, 2))
    赋值 (.图片, #警告)
.如果真结束
.如果真 (等于 (提示窗口图标, 3))
    赋值 (.图片, #询问)
.如果真结束
.如果真 (等于 (提示窗口图标, 4))
    赋值 (.图片, #信息)
.如果真结束
.如果 (等于 (提示窗口按钮数, 2))
    连续赋值 (假, .可视, .可视)
    连续赋值 (真, .可视, .可视, .可视, .可视)
.否则
    连续赋值 (真, .可视, .可视)
    连续赋值 (假, .可视, .可视, .可视, .可视)
.如果结束
赋值 (提示窗口..内容, 提示窗口标题)
赋值 (.高度, 相乘 (相加 (绝对取整 (相除 (取文本长度 (提示信息), 36)), 1), 12))
赋值 (.顶边, 相加 (44, 相除 (相减 (90, .高度), 2)))
.如果真 (等于 (.高度, 12))
    赋值 (.字体, 1)
.如果真结束
赋值 (提示窗口..内容, 提示信息)

.子程序 _图形按钮1_被单击, 空白型, , 
提示窗口.销毁 ()

.子程序 _图形按钮3_被单击, 空白型, , 
赋值 (提示窗口返回值, 1)
提示窗口.销毁 ()

.子程序 _图形按钮2_被单击, 空白型, , 
赋值 (提示窗口返回值, 0)
提示窗口.销毁 ()

.子程序 _提示窗口_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _图形按钮1_被单击 ()
.如果真结束
返回 (真)

.窗口程序集 注册信息查看窗口程序集, , , 

.子程序 _注册信息查看窗口_创建完毕, 空白型, , 
置等待鼠标 ()
赋值 (., #登陆窗口背景图)
赋值 (.标题, 取文本注册项 (#现行设置, “software\registertime\tsglsoft\”, ))
赋值 (.标题, 取文本注册项 (#现行设置, “software\register\tsglsoft\”, ))
恢复鼠标 ()

.子程序 _注册信息查看窗口_确定按钮_被单击, 空白型, , 
赋值 (主窗口.., -1)
注册信息查看窗口.销毁 ()

.窗口程序集 查找窗口程序集, , , 

.子程序 _查找窗口_创建完毕, 空白型, , 
赋值 (.选中, 真)
获取焦点 ()
赋值 (.现行选中项, 0)
赋值 (.现行选中项, 0)
赋值 (.现行选中项, 0)
赋值 (.现行选中项, 0)
赋值 (.现行选中项, 0)
赋值 (.现行选中项, 0)


.子程序 _编辑框1_获得焦点, 空白型, , 
赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容)
赋值 (.内容, “查找”)

.子程序 _编辑框2_获得焦点, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容)
赋值 (.内容, “查找”)

.子程序 _编辑框3_获得焦点, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容)
赋值 (.内容, “查找”)

.子程序 _编辑框4_获得焦点, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容)
赋值 (.内容, “查找”)

.子程序 _编辑框5_获得焦点, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 真)
赋值 (.选中, 假)
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容)
赋值 (.内容, “查找”)

.子程序 _编辑框6_获得焦点, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 真)
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容)
赋值 (.内容, “查找”)


.子程序 _单选框1_获得焦点, 空白型, , 
获取焦点 ()

.子程序 _单选框2_获得焦点, 空白型, , 
获取焦点 ()

.子程序 _单选框3_获得焦点, 空白型, , 
获取焦点 ()

.子程序 _单选框4_获得焦点, 空白型, , 
获取焦点 ()

.子程序 _单选框5_获得焦点, 空白型, , 
获取焦点 ()

.子程序 _单选框6_获得焦点, 空白型, , 
获取焦点 ()

.子程序 _组合框1_列表项被选择, 空白型, , 
赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
获取焦点 ()

.子程序 _组合框2_列表项被选择, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
获取焦点 ()

.子程序 _组合框3_列表项被选择, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
获取焦点 ()

.子程序 _组合框4_列表项被选择, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)
获取焦点 ()

.子程序 _组合框5_列表项被选择, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 真)
赋值 (.选中, 假)
获取焦点 ()

.子程序 _组合框6_列表项被选择, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 真)
获取焦点 ()

.子程序 _编辑框1_内容被改变, 空白型, , 
赋值 (.内容, “查找”)

.子程序 _编辑框2_内容被改变, 空白型, , 
赋值 (.内容, “查找”)

.子程序 _编辑框3_内容被改变, 空白型, , 
赋值 (.内容, “查找”)

.子程序 _编辑框4_内容被改变, 空白型, , 
赋值 (.内容, “查找”)

.子程序 _编辑框5_内容被改变, 空白型, , 
赋值 (.内容, “查找”)

.子程序 _编辑框6_内容被改变, 空白型, , 
赋值 (.内容, “查找”)

.子程序 查找子程序, 空白型, , 
.如果真 (等于 (.选中, 真))
    .如果真 (等于 (.现行选中项, 0))
        .如果 (查找 (等于 (读 (1), .内容)))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 1)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    .如果真 (等于 (.现行选中项, 1))
        .如果 (查找 (大于 (寻找文本 (读 (1), .内容, , 假), 0)))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 1)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    .如果真 (等于 (.现行选中项, 2))
        .如果 (查找 (等于 (寻找文本 (读 (1), .内容, , 假), -1)))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 1)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果真 (等于 (.现行选中项, 0))
        .如果 (查找 (等于 (读 (2), .内容)))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 2)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    .如果真 (等于 (.现行选中项, 1))
        .如果 (查找 (大于 (寻找文本 (读 (2), .内容, , 假), 0)))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 2)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    .如果真 (等于 (.现行选中项, 2))
        .如果 (查找 (等于 (寻找文本 (读 (2), .内容, , 假), -1)))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 2)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果真 (等于 (.现行选中项, 0))
        .如果 (查找 (等于 (读 (3), .内容)))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 3)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    .如果真 (等于 (.现行选中项, 1))
        .如果 (查找 (大于 (寻找文本 (读 (3), .内容, , 假), 0)))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 3)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    .如果真 (等于 (.现行选中项, 2))
        .如果 (查找 (等于 (寻找文本 (读 (3), .内容, , 假), -1)))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 3)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果真 (等于 (.现行选中项, 0))
        .如果 (查找 (大于 (读 (4), 到数值 (.内容))))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 4)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    .如果真 (等于 (.现行选中项, 1))
        .如果 (查找 (等于 (读 (4), 到数值 (.内容))))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 4)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    .如果真 (等于 (.现行选中项, 2))
        .如果 (查找 (小于 (读 (4), 到数值 (.内容))))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 4)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果真 (等于 (.现行选中项, 0))
        .如果 (查找 (大于 (读 (5), 到数值 (.内容))))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 5)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    .如果真 (等于 (.现行选中项, 1))
        .如果 (查找 (等于 (读 (5), 到数值 (.内容))))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 5)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    .如果真 (等于 (.现行选中项, 2))
        .如果 (查找 (小于 (读 (5), 到数值 (.内容))))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 5)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果真 (等于 (.现行选中项, 0))
        .如果 (查找 (大于 (读 (6), 到数值 (.内容))))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 6)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    .如果真 (等于 (.现行选中项, 1))
        .如果 (查找 (等于 (读 (6), 到数值 (.内容))))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 6)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    .如果真 (等于 (.现行选中项, 2))
        .如果 (查找 (小于 (读 (6), 到数值 (.内容))))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 6)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    
.如果真结束


.子程序 _查找窗口_确定按钮_被单击, 空白型, , 
.如果真 (等于 (.内容, “查找”))
    置当前库 (“tsgltsk”)
    到首记录 ()
.如果真结束
查找子程序 ()


.子程序 _查找窗口_取消图形按钮_被单击, 空白型, , 
查找窗口.销毁 ()

.窗口程序集 统计窗口程序集, , , 

.子程序 _统计窗口_创建完毕, 空白型, , 
置当前库 (“tsgltsk”)
赋值 (.内容, 相加 (字符 (13), 字符 (10), “    本系统共收录各种图书”, 数值到格式文本 (取记录数 (), 0, 真), “类”, 数值到格式文本 (求和 (读 (5), ), 0, 真), “册，总价值”, 数值到格式文本 (求和 (读 (4), ), 2, 真), “元。借出”, 数值到格式文本 (相减 (求和 (读 (5), ), 求和 (读 (6), )), 0, 真), “册，目前库存”, 数值到格式文本 (求和 (读 (6), ), 0, 真), “册。”))


.子程序 _统计窗口_确定按钮_被单击, 空白型, , 
统计窗口.销毁 ()


.窗口程序集 校验窗口程序集, , , 

.程序集变量 M, 整数型, , , 循环计数器
.子程序 _校验窗口_创建完毕, 空白型, , 
.局部变量 Ret, 整数型, , , 

赋值 (Ret, GetWindowLong (取窗口句柄 (), -20))
赋值 (Ret, 位或 (Ret, 524288))
SetWindowLong (取窗口句柄 (), -20, Ret)
SetLayeredWindowAttributes (校验窗口.取窗口句柄 (), 0, 255, #LWA_ALPHA)
赋值 (.内容, “校验发现错误！”)
置等待鼠标 ()
置当前库 (“tsgltsk”)
到首记录 ()
清空 ()
.计次循环首 (取记录数 (), M)
    .如果真 (等于 (读 (1), “”))
        相加 (“第”, 数值到格式文本 (M, 0, 假), “列，（图书编号）不能为空”).加入项目 (相加 (相乘 (M, 10), 1))
    .如果真结束
    赋值 (ZDNR, 读 (1))
    .如果真 (大于 (计算数目 (等于 (读 (1), ZDNR)), 1))
        相加 (“第”, 数值到格式文本 (M, 0, 假), “列，（图书编号）有重复”).加入项目 (相加 (相乘 (M, 10), 1))
    .如果真结束
    .如果真 (等于 (读 (2), “”))
        相加 (“第”, 数值到格式文本 (M, 0, 假), “列，（书名）不能为空”).加入项目 (相加 (相乘 (M, 10), 2))
    .如果真结束
    赋值 (ZDNR, 读 (2))
    .如果真 (大于 (计算数目 (等于 (读 (2), ZDNR)), 1))
        相加 (“第”, 数值到格式文本 (M, 0, 假), “列，（书名）有重复”).加入项目 (相加 (相乘 (M, 10), 2))
    .如果真结束
    .如果真 (小于 (读 (4), 0))
        相加 (“第”, 数值到格式文本 (M, 0, 假), “列，（定价）错误（小于零）”).加入项目 (相加 (相乘 (M, 10), 4))
    .如果真结束
    .如果真 (小于或等于 (读 (5), 0))
        相加 (“第”, 数值到格式文本 (M, 0, 假), “列，（数量）不能小于或等于零”).加入项目 (相加 (相乘 (M, 10), 5))
    .如果真结束
    .如果真 (小于 (读 (6), 0))
        相加 (“第”, 数值到格式文本 (M, 0, 假), “列，（库存）不能小于零”).加入项目 (相加 (相乘 (M, 10), 6))
    .如果真结束
    .如果真 (大于 (读 (6), 读 (5)))
        相加 (“第”, 数值到格式文本 (M, 0, 假), “列，（库存）不能大于（数量）”).加入项目 (相加 (相乘 (M, 10), 6))
    .如果真结束
    跳过 (1)
.计次循环尾 ()
恢复鼠标 ()
.如果 (大于 (取项目数 (), 0))
    赋值 (.内容, “继续校验”)
.否则
    赋值 (.内容, “关闭”)
    赋值 (.内容, “校验通过！”)
.如果结束


.子程序 _列表框1_列表项被选择, 空白型, , 
主窗口.未知支持库函数_0 (., 绝对取整 (相除 (校验窗口.取项目数值 (., 校验窗口..现行选中项), 10)), 相减 (校验窗口.取项目数值 (., 校验窗口..现行选中项), 相乘 (绝对取整 (相除 (校验窗口.取项目数值 (., 校验窗口..现行选中项), 10)), 10)))

.子程序 _校验窗口_关闭按钮_被单击, 空白型, , 
.如果 (等于 (.内容, “继续校验”))
    _校验窗口_创建完毕 ()
.否则
    赋值 (图书校验是否通过, 真)
    校验窗口.销毁 ()
.如果结束


.子程序 _超级按钮1_被单击, 空白型, , 
校验窗口.销毁 ()

.子程序 _校验窗口_将被销毁, 空白型, , 
.如果真 (取反 (会员校验是否通过))
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示窗口图标, 3)
    赋值 (提示窗口按钮数, 2)
    赋值 (提示信息, “会员资料也存在错误，现在要进行更正吗？”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示窗口返回值, 0)
    赋值 (提示信息, “”)
    .如果真 (等于 (提示窗口返回值, 1))
        赋值 (提示窗口返回值, 0)
        赋值 (主窗口.., 2)
        赋值 (主窗口.., 0)
        _卷帘式菜单1_项目被选择 (2, 0)
        载入 (会员校验窗口, , 假)
    .如果真结束
    赋值 (会员校验是否通过, 真) ' 不论用户是否进行更正都设置为真，这样可以防止再进行图书窗口校验时提示对会员资料进行更正。
.如果真结束
赋值 (图书校验是否通过, 真) ' 不论是否通过校验都设为真，防止进行借阅前校验时出现误报。

.子程序 _列表框1_获得焦点, 空白型, , 
SetLayeredWindowAttributes (校验窗口.取窗口句柄 (), 0, 255, #LWA_ALPHA)

.子程序 _列表框1_失去焦点, 空白型, , 
SetLayeredWindowAttributes (校验窗口.取窗口句柄 (), 0, 170, #LWA_ALPHA)


.窗口程序集 排序窗口程序集, , , 

.程序集变量 排序字段, 文本型, , , 
.程序集变量 M, 整数型, , , 
.程序集变量 N, 整数型, , , 
.子程序 _排序窗口_创建完毕, 空白型, , 


.子程序 排序子程序, 空白型, , 升序方式排序
打开 (相加 (运行目录, “\data\tsgltskpx.edb”), “tsgltskpx”, 假, 4, , “ujumpitoo@jdyltsgl3.com”, )
置当前库 (“tsgltskpx”)
到首记录 ()
.计次循环首 (7, 循环次数)
    主窗口.未知支持库函数_9 (., 0, 循环次数, 1, 取字段名 (循环次数))
.计次循环尾 ()
.计次循环首 (取记录数 (), M)
    主窗口.未知支持库函数_9 (., M, 0, 1, 数值到格式文本 (M, 0, 假))
    .计次循环首 (7, N)
        .如果真 (小于 (N, 4))
            主窗口.未知支持库函数_9 (., M, N, 1, 读 (N))
        .如果真结束
        .如果真 (等于 (N, 4))
            主窗口.未知支持库函数_9 (., M, N, 1, 数值到格式文本 (读 (N), 2, 假))
        .如果真结束
        .如果真 (大于 (N, 4))
            主窗口.未知支持库函数_9 (., M, N, 1, 数值到格式文本 (读 (N), 0, 假))
        .如果真结束
        
    .计次循环尾 ()
     ' 跳过 (1)
.计次循环尾 ()
关闭 (“tsgltskpx”)


.子程序 _排序窗口_升序按钮_被单击, 空白型, , 
置当前库 (“tsgltsk”)
.如果真 (.选中)
    排序 (相加 (取当前目录 (), “\data\tsgltskpx.edb”), “图书编号”, 真, , )
    排序子程序 ()
.如果真结束
.如果真 (.选中)
    排序 (相加 (取当前目录 (), “\data\tsgltskpx.edb”), “书名”, 真, , )
    排序子程序 ()
.如果真结束
.如果真 (.选中)
    排序 (相加 (取当前目录 (), “\data\tsgltskpx.edb”), “作者”, 真, , )
    排序子程序 ()
.如果真结束
.如果真 (.选中)
    排序 (相加 (取当前目录 (), “\data\tsgltskpx.edb”), “定价”, 真, , )
    排序子程序 ()
.如果真结束
.如果真 (.选中)
    排序 (相加 (取当前目录 (), “\data\tsgltskpx.edb”), “数量”, 真, , )
    排序子程序 ()
.如果真结束
.如果真 (.选中)
    排序 (相加 (取当前目录 (), “\data\tsgltskpx.edb”), “库存”, 真, , )
    排序子程序 ()
.如果真结束


.子程序 _排序窗口_降序按钮_被单击, 空白型, , 
置当前库 (“tsgltsk”)
.如果真 (.选中)
    排序 (相加 (取当前目录 (), “\data\tsgltskpx.edb”), “图书编号”, 假, , )
    排序子程序 ()
.如果真结束
.如果真 (.选中)
    排序 (相加 (取当前目录 (), “\data\tsgltskpx.edb”), “书名”, 假, , )
    排序子程序 ()
.如果真结束
.如果真 (.选中)
    排序 (相加 (取当前目录 (), “\data\tsgltskpx.edb”), “作者”, 假, , )
    排序子程序 ()
.如果真结束
.如果真 (.选中)
    排序 (相加 (取当前目录 (), “\data\tsgltskpx.edb”), “定价”, 假, , )
    排序子程序 ()
.如果真结束
.如果真 (.选中)
    排序 (相加 (取当前目录 (), “\data\tsgltskpx.edb”), “数量”, 假, , )
    排序子程序 ()
.如果真结束
.如果真 (.选中)
    排序 (相加 (取当前目录 (), “\data\tsgltskpx.edb”), “库存”, 假, , )
    排序子程序 ()
.如果真结束



.子程序 _排序窗口_放弃按钮_被单击, 空白型, , 
置等待鼠标 ()
载入 (进度指示窗口, , 假)
赋值 (进度指示窗口..内容, “正在初始化表格...”)
刷新显示 ()
.计次循环首 (主窗口.., )
    主窗口.未知支持库函数_36 (., 0)
.计次循环尾 ()
.计次循环首 (主窗口.., )
    主窗口.未知支持库函数_37 (., 0)
.计次循环尾 ()
赋值 (主窗口.., 1)
置当前库 (“tsgltsk”)
到首记录 ()
赋值 (主窗口.., 1)
赋值 (主窗口.., 1)
赋值 (主窗口.., 相加 (取记录数 (), 1))
赋值 (主窗口.., 7)
主窗口.未知支持库函数_25 (., 0, 0, 0, 主窗口.., 2)
主窗口.未知支持库函数_25 (., 1, 0, 主窗口.., 0, 2)
主窗口.未知支持库函数_32 (., 0, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “L0”, “50”)))
主窗口.未知支持库函数_32 (., 1, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “L1”, “90”)))
主窗口.未知支持库函数_32 (., 2, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “L2”, “400”)))
主窗口.未知支持库函数_32 (., 3, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “L3”, “200”)))
主窗口.未知支持库函数_32 (., 4, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “L4”, “70”)))
主窗口.未知支持库函数_32 (., 5, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “L5”, “70”)))
主窗口.未知支持库函数_32 (., 6, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “L6”, “70”)))
主窗口.未知支持库函数_9 (., 0, 0, 1, “序号”)
.计次循环首 (7, 循环次数)
    主窗口.未知支持库函数_9 (., 0, 循环次数, 1, 取字段名 (循环次数))
.计次循环尾 ()
赋值 (进度指示窗口..内容, “正在载入数据...”)
刷新显示 ()
.计次循环首 (取记录数 (), M)
    赋值 (进度指示窗口..位置, 相乘 (相除 (M, 取记录数 ()), 100))
    主窗口.未知支持库函数_9 (., M, 0, 1, 数值到格式文本 (M, 0, 假))
    .计次循环首 (7, N)
        .如果真 (小于 (N, 4))
            主窗口.未知支持库函数_9 (., M, N, 1, 读 (N))
        .如果真结束
        .如果真 (等于 (N, 4))
            主窗口.未知支持库函数_9 (., M, N, 1, 数值到格式文本 (读 (N), 2, 假))
        .如果真结束
        .如果真 (大于 (N, 4))
            主窗口.未知支持库函数_9 (., M, N, 1, 数值到格式文本 (读 (N), 0, 假))
        .如果真结束
        
    .计次循环尾 ()
    跳过 (1)
.计次循环尾 ()
进度指示窗口.销毁 ()
.计次循环首 (主窗口.., M)
    主窗口.未知支持库函数_31 (., 相减 (M, 1), 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “H”, “24”)))
.计次循环尾 ()
主窗口.未知支持库函数_0 (., 相减 (主窗口.., 1), 0)
恢复鼠标 ()
主窗口.获取焦点 (.)
排序窗口.销毁 ()


.子程序 _排序窗口_保存按钮_被单击, 空白型, , 
保存子程序1 ()
排序窗口.销毁 ()


.窗口程序集 置打印表头窗口程序集, , , 

.程序集变量 字体数组1, 文本型, , "0", 
.子程序 _置打印表头窗口_创建完毕, 空白型, , 
.局部变量 字体数组, 文本型, , "0", 
.局部变量 计次变量, 整数型, , , 

模块_枚举字体 (字体数组1)
清空 ()
.计次循环首 (取数组成员数 (字体数组1), 计次变量)
    字体数组1.加入项目 ( [计次变量], )
.计次循环尾 ()
赋值 (.内容, “宋体”)
赋值 (.内容, “常规”)
赋值 (.内容, “小五”)
.如果真 (等于 (表头标志, “图书”))
    赋值 (.内容, 相加 (使用单位, “图书室图书清单”))
.如果真结束
.如果真 (等于 (表头标志, “会员”))
    赋值 (.内容, 相加 (使用单位, “图书室会员一览表”))
.如果真结束
.如果真 (等于 (表头标志, “查询结果”))
    赋值 (.内容, 相加 (使用单位, “图书查询结果”))
.如果真结束
.如果真 (等于 (表头标志, “催还”))
    赋值 (.内容, 相加 (使用单位, “图书室催还单”))
.如果真结束
.如果真 (等于 (表头标志, “日志”))
    赋值 (.内容, 相加 (“《”, 软件名称, “》”, “运行日志”))
.如果真结束
.如果真 (等于 (表头标志, “经费”))
    赋值 (.内容, 相加 (使用单位, “图书室经费收支一览表”))
.如果真结束
.如果真 (等于 (表头标志, “查询会员”))
    赋值 (.内容, 相加 (使用单位, “会员查询结果”))
.如果真结束


.子程序 模块_枚举字体, 空白型, , 
.参数 字体数组参数, 文本型, 参考 数组, 接收字体名称的数组

Api_枚举字体 (Api_取设备场景句柄 (0), 0, &枚举字体子程序, 0)
赋值 (字体数组参数, 字体数组1)


.子程序 枚举字体子程序, 整数型, , 
.参数 lplf, 整数型, , 
.参数 lptm, 整数型, , 
.参数 dwType, 整数型, , 
.参数 lpData, 整数型, , 

.局部变量 逻辑字体, 逻辑字体_, , , 
.局部变量 FontName, 字节型, , "32", 
.局部变量 字体名称, 文本型, , , 
.局部变量 计次数量, 整数型, , , 

Api_复制内存 (逻辑字体, lplf, 60)
赋值 (字体名称, “”)
.计次循环首 (取数组成员数 (逻辑字体.字体名称), 计次数量)
    .如果 (不等于 (字符 (逻辑字体.字体名称 [计次数量]), 字符 (0)))
        赋值 (字体名称, 相加 (字体名称, 字符 (逻辑字体.字体名称 [计次数量])))
    .否则
        加入成员 (字体数组1, 字体名称)
        跳出循环 ()
    .如果结束
    
.计次循环尾 ()
返回 (1)

.子程序 _列表框1_列表项被选择, 空白型, , 
赋值 (.内容, .取项目文本 (.现行选中项))
赋值 (.字体.字体名称, .内容)

.子程序 _列表框2_列表项被选择, 空白型, , 
赋值 (.内容, .取项目文本 (.现行选中项))
.如果真 (等于 (.现行选中项, 0))
    赋值 (.字体.加粗, 假)
.如果真结束
.如果真 (等于 (.现行选中项, 1))
    赋值 (.字体.加粗, 真)
.如果真结束


.子程序 _列表框3_列表项被选择, 空白型, , 
赋值 (.内容, .取项目文本 (.现行选中项))
.如果真 (等于 (.现行选中项, 0))
    赋值 (.字体.字体大小, 42)
.如果真结束
.如果真 (等于 (.现行选中项, 1))
    赋值 (.字体.字体大小, 36)
.如果真结束
.如果真 (等于 (.现行选中项, 2))
    赋值 (.字体.字体大小, 26)
.如果真结束
.如果真 (等于 (.现行选中项, 3))
    赋值 (.字体.字体大小, 24)
.如果真结束
.如果真 (等于 (.现行选中项, 4))
    赋值 (.字体.字体大小, 22)
.如果真结束
.如果真 (等于 (.现行选中项, 5))
    赋值 (.字体.字体大小, 18)
.如果真结束
.如果真 (等于 (.现行选中项, 6))
    赋值 (.字体.字体大小, 16)
.如果真结束
.如果真 (等于 (.现行选中项, 7))
    赋值 (.字体.字体大小, 15)
.如果真结束
.如果真 (等于 (.现行选中项, 8))
    赋值 (.字体.字体大小, 14)
.如果真结束
.如果真 (等于 (.现行选中项, 9))
    赋值 (.字体.字体大小, 12)
.如果真结束
.如果真 (等于 (.现行选中项, 10))
    赋值 (.字体.字体大小, 11)
.如果真结束
.如果真 (等于 (.现行选中项, 11))
    赋值 (.字体.字体大小, 9)
.如果真结束
.如果真 (等于 (.现行选中项, 12))
    赋值 (.字体.字体大小, 8)
.如果真结束
.如果真 (等于 (.现行选中项, 13))
    赋值 (.字体.字体大小, 7)
.如果真结束
.如果真 (等于 (.现行选中项, 14))
    赋值 (.字体.字体大小, 5)
.如果真结束


.子程序 _置打印表头_确定按钮_被单击, 空白型, , 
.如果真 (等于 (表头标志, “图书”))
    主窗口.未知支持库函数_46 (., .内容, .内容, .字体.字体大小, .字体.加粗, 2)
    置打印表头窗口.销毁 ()
    主窗口.未知支持库函数_27 (.)
.如果真结束
.如果真 (等于 (表头标志, “查询结果”))
    查询图书结果窗口.未知支持库函数_46 (., .内容, .内容, .字体.字体大小, .字体.加粗, 2)
    置打印表头窗口.销毁 ()
    查询图书结果窗口.未知支持库函数_27 (.)
.如果真结束
.如果真 (等于 (表头标志, “会员”))
    主窗口.未知支持库函数_46 (., .内容, .内容, .字体.字体大小, .字体.加粗, 2)
    置打印表头窗口.销毁 ()
    主窗口.未知支持库函数_27 (.)
.如果真结束
.如果真 (等于 (表头标志, “催还”))
    主窗口.未知支持库函数_46 (., .内容, .内容, .字体.字体大小, .字体.加粗, 2)
    置打印表头窗口.销毁 ()
    主窗口.未知支持库函数_27 (.)
.如果真结束
.如果真 (等于 (表头标志, “日志”))
    查看日志窗口.未知支持库函数_46 (., .内容, .内容, .字体.字体大小, .字体.加粗, 2)
    置打印表头窗口.销毁 ()
    查看日志窗口.未知支持库函数_27 (.)
.如果真结束
.如果真 (等于 (表头标志, “经费”))
    查看经费窗口.未知支持库函数_46 (., .内容, .内容, .字体.字体大小, .字体.加粗, 2)
    置打印表头窗口.销毁 ()
    查看经费窗口.未知支持库函数_27 (.)
.如果真结束
.如果真 (等于 (表头标志, “查询会员”))
    查询会员结果窗口.未知支持库函数_46 (., .内容, .内容, .字体.字体大小, .字体.加粗, 2)
    置打印表头窗口.销毁 ()
    查询会员结果窗口.未知支持库函数_27 (.)
.如果真结束


.窗口程序集 关于窗口程序集, , , 

.子程序 _关于窗口_创建完毕, 空白型, , 
置等待鼠标 ()
赋值 (.标题, 相加 (“《”, 软件名称, “》使用《易语言4.03》开发 ”))
.如果 (是否注册)
    赋值 (.标题, 相加 (“感谢 ”, 使用单位, “ 注册使用”))
.否则
    赋值 (.标题, “**未注册**”)
.如果结束
赋值 (关于窗口., 软件名称)
赋值 (.内容, 相加 (数值到格式文本 (未知支持库函数_19 (#.), , 真), “ M”))
赋值 (.内容, 相加 (数值到格式文本 (未知支持库函数_19 (#.), 0, 真), “ M”))
赋值 (.内容, 相加 (数值到格式文本 (未知支持库函数_19 (#.), 0, 真), “ M”))
赋值 (.内容, 相加 (数值到格式文本 (未知支持库函数_19 (#.), 0, 真), “ M”))
赋值 (.内容, 相加 (数值到格式文本 (未知支持库函数_19 (#.), 0, 真), “ M”))
赋值 (.内容, 相加 (数值到格式文本 (未知支持库函数_19 (#.), 0, 真), “ M”))
赋值 (.内容, 相加 (数值到格式文本 (未知支持库函数_18 (), , 假), “%”))
赋值 (.内容, 未知支持库函数_34 ())
赋值 (.内容, 未知支持库函数_20 ())
恢复鼠标 ()

.子程序 _时钟1_周期事件, 空白型, , 
赋值 (.内容, 相加 (数值到格式文本 (未知支持库函数_18 (), , 假), “%”))
赋值 (.内容, 相加 (数值到格式文本 (未知支持库函数_19 (#.), 0, 真), “ M”))
赋值 (.内容, 相加 (数值到格式文本 (未知支持库函数_19 (#.), 0, 真), “ M”))
赋值 (.内容, 相加 (数值到格式文本 (未知支持库函数_19 (#.), 0, 真), “ M”))
赋值 (.内容, 相加 (数值到格式文本 (未知支持库函数_19 (#.), 0, 真), “ M”))
赋值 (.内容, 相加 (数值到格式文本 (未知支持库函数_19 (#.), 0, 真), “ M”))


.子程序 _透明标签20_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

关于窗口.销毁 ()
赋值 (主窗口.., -1)

.窗口程序集 查询图书窗口程序集, , , 

.程序集变量 CXM, 整数型, , , 循环记数器
.程序集变量 CXN, 整数型, , , 
.程序集变量 TS标志内容, 文本型, , , 
.程序集变量 TSWB, 文本型, , , abcdef中除(标志内容)以外的字母
.程序集变量 TSWB字母, 文本型, , "0", 
.程序集变量 TS编号, 文本型, , , 
.子程序 _查询图书_确定按钮_被单击, 空白型, , 
 ' 这段程序算是软件编写中最让我伤脑筋的地方，我感到自己这样做是比较巧妙的！
置等待鼠标 ()
置当前库 (“tsgltsk”) ' 查询功能的基本思路是，在所要查询的数据库内，预先设置一个“查询标志”字段，查询时，按给定的条件向符合条件的记录的查询标志字段内写入 a到f作为标志，再把“并且”、“或者”操作转变为对字母的操作。
到首记录 ()
.计次循环首 (取记录数 (), CXM)
    写 (8, “”)
    跳过 (1)
.计次循环尾 ()
.如果真 (等于 (.选中, 真))
    .如果 (等于 (.现行选中项, -1))
        赋值 (提示窗口标题, “提示！”)
        赋值 (提示窗口图标, 4)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, “请输入完整的查询条件。”)
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
        获取焦点 ()
        返回 ()
    .否则
        .如果 (等于 (.内容, “”))
            赋值 (提示窗口标题, “提示！”)
            赋值 (提示窗口图标, 4)
            赋值 (提示窗口按钮数, 1)
            赋值 (提示信息, “请输入完整的查询条件。”)
            载入 (提示窗口, , 真)
            赋值 (提示窗口标题, “”)
            赋值 (提示窗口图标, 0)
            赋值 (提示窗口按钮数, 0)
            赋值 (提示信息, “”)
            获取焦点 ()
            返回 ()
        .否则
            .如果真 (等于 (.现行选中项, 0))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (等于 (读 (1), .内容))
                        写 (8, 相加 (读 (8), “a”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 1))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (大于 (寻找文本 (读 (1), .内容, , 假), 0))
                        写 (8, 相加 (读 (8), “a”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 2))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (等于 (寻找文本 (读 (1), .内容, , 假), -1))
                        写 (8, 相加 (读 (8), “a”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            
        .如果结束
        
    .如果结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果 (等于 (.现行选中项, -1))
        赋值 (提示窗口标题, “提示！”)
        赋值 (提示窗口图标, 4)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, “请输入完整的查询条件。”)
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
        获取焦点 ()
        返回 ()
    .否则
        .如果 (等于 (.内容, “”))
            赋值 (提示窗口标题, “提示！”)
            赋值 (提示窗口图标, 4)
            赋值 (提示窗口按钮数, 1)
            赋值 (提示信息, “请输入完整的查询条件。”)
            载入 (提示窗口, , 真)
            赋值 (提示窗口标题, “”)
            赋值 (提示窗口图标, 0)
            赋值 (提示窗口按钮数, 0)
            赋值 (提示信息, “”)
            获取焦点 ()
            返回 ()
        .否则
            .如果真 (等于 (.现行选中项, 0))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (等于 (读 (2), .内容))
                        写 (8, 相加 (读 (8), “b”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 1))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (大于 (寻找文本 (读 (2), .内容, , 假), 0))
                        写 (8, 相加 (读 (8), “b”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 2))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (等于 (寻找文本 (读 (2), .内容, , 假), -1))
                        写 (8, 相加 (读 (8), “b”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            
            
        .如果结束
        
    .如果结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果 (等于 (.现行选中项, -1))
        赋值 (提示窗口标题, “提示！”)
        赋值 (提示窗口图标, 4)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, “请输入完整的查询条件。”)
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
        获取焦点 ()
        返回 ()
    .否则
        .如果 (等于 (.内容, “”))
            赋值 (提示窗口标题, “提示！”)
            赋值 (提示窗口图标, 4)
            赋值 (提示窗口按钮数, 1)
            赋值 (提示信息, “请输入完整的查询条件。”)
            载入 (提示窗口, , 真)
            赋值 (提示窗口标题, “”)
            赋值 (提示窗口图标, 0)
            赋值 (提示窗口按钮数, 0)
            赋值 (提示信息, “”)
            获取焦点 ()
            返回 ()
        .否则
            .如果真 (等于 (.现行选中项, 0))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (等于 (读 (3), .内容))
                        写 (8, 相加 (读 (8), “c”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 1))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (大于 (寻找文本 (读 (3), .内容, , 假), 0))
                        写 (8, 相加 (读 (8), “c”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 2))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (等于 (寻找文本 (读 (3), .内容, , 假), -1))
                        写 (8, 相加 (读 (8), “c”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            
        .如果结束
        
    .如果结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果 (等于 (.现行选中项, -1))
        赋值 (提示窗口标题, “提示！”)
        赋值 (提示窗口图标, 4)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, “请输入完整的查询条件。”)
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
        获取焦点 ()
        返回 ()
    .否则
        .如果 (等于 (.内容, “”))
            赋值 (提示窗口标题, “提示！”)
            赋值 (提示窗口图标, 4)
            赋值 (提示窗口按钮数, 1)
            赋值 (提示信息, “请输入完整的查询条件。”)
            载入 (提示窗口, , 真)
            赋值 (提示窗口标题, “”)
            赋值 (提示窗口图标, 0)
            赋值 (提示窗口按钮数, 0)
            赋值 (提示信息, “”)
            获取焦点 ()
            返回 ()
        .否则
            .如果真 (等于 (.现行选中项, 0))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (大于 (读 (4), 到数值 (.内容)))
                        写 (8, 相加 (读 (8), “d”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 1))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (等于 (读 (4), 到数值 (.内容)))
                        写 (8, 相加 (读 (8), “d”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 2))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (小于 (读 (4), 到数值 (.内容)))
                        写 (8, 相加 (读 (8), “d”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            
            
        .如果结束
        
    .如果结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果 (等于 (.现行选中项, -1))
        赋值 (提示窗口标题, “提示！”)
        赋值 (提示窗口图标, 4)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, “请输入完整的查询条件。”)
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
        获取焦点 ()
        返回 ()
    .否则
        .如果 (等于 (.内容, “”))
            赋值 (提示窗口标题, “提示！”)
            赋值 (提示窗口图标, 4)
            赋值 (提示窗口按钮数, 1)
            赋值 (提示信息, “请输入完整的查询条件。”)
            载入 (提示窗口, , 真)
            赋值 (提示窗口标题, “”)
            赋值 (提示窗口图标, 0)
            赋值 (提示窗口按钮数, 0)
            赋值 (提示信息, “”)
            获取焦点 ()
            返回 ()
        .否则
            .如果真 (等于 (.现行选中项, 0))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (大于 (读 (5), 到数值 (.内容)))
                        写 (8, 相加 (读 (8), “e”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 1))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (等于 (读 (5), 到数值 (.内容)))
                        写 (8, 相加 (读 (8), “e”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 2))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (小于 (读 (5), 到数值 (.内容)))
                        写 (8, 相加 (读 (8), “e”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            
        .如果结束
        
    .如果结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果 (等于 (.现行选中项, -1))
        赋值 (提示窗口标题, “提示！”)
        赋值 (提示窗口图标, 4)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, “请输入完整的查询条件。”)
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
        获取焦点 ()
        返回 ()
    .否则
        .如果 (等于 (.内容, “”))
            赋值 (提示窗口标题, “提示！”)
            赋值 (提示窗口图标, 4)
            赋值 (提示窗口按钮数, 1)
            赋值 (提示信息, “请输入完整的查询条件。”)
            载入 (提示窗口, , 真)
            赋值 (提示窗口标题, “”)
            赋值 (提示窗口图标, 0)
            赋值 (提示窗口按钮数, 0)
            赋值 (提示信息, “”)
            获取焦点 ()
            返回 ()
        .否则
            .如果真 (等于 (.现行选中项, 0))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (大于 (读 (6), 到数值 (.内容)))
                        写 (8, 相加 (读 (8), “f”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 1))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (等于 (读 (6), 到数值 (.内容)))
                        写 (8, 相加 (读 (8), “f”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 2))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (小于 (读 (6), 到数值 (.内容)))
                        写 (8, 相加 (读 (8), “f”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            
            
        .如果结束
        
    .如果结束
    
.如果真结束
.如果 (并且 (等于 (.禁止, 假), 等于 (.现行选中项, -1)))
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示窗口图标, 4)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, “请输入完整的查询条件。”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    获取焦点 ()
    返回 ()
.否则
    .如果 (并且 (等于 (.禁止, 假), 等于 (.现行选中项, -1)))
        赋值 (提示窗口标题, “提示！”)
        赋值 (提示窗口图标, 4)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, “请输入完整的查询条件。”)
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
        获取焦点 ()
        返回 ()
    .否则
        .如果 (并且 (等于 (.禁止, 假), 等于 (.现行选中项, -1)))
            赋值 (提示窗口标题, “提示！”)
            赋值 (提示窗口图标, 4)
            赋值 (提示窗口按钮数, 1)
            赋值 (提示信息, “请输入完整的查询条件。”)
            载入 (提示窗口, , 真)
            赋值 (提示窗口标题, “”)
            赋值 (提示窗口图标, 0)
            赋值 (提示窗口按钮数, 0)
            赋值 (提示信息, “”)
            获取焦点 ()
            返回 ()
        .否则
            .如果 (并且 (等于 (.禁止, 假), 等于 (.现行选中项, -1)))
                赋值 (提示窗口标题, “提示！”)
                赋值 (提示窗口图标, 4)
                赋值 (提示窗口按钮数, 1)
                赋值 (提示信息, “请输入完整的查询条件。”)
                载入 (提示窗口, , 真)
                赋值 (提示窗口标题, “”)
                赋值 (提示窗口图标, 0)
                赋值 (提示窗口按钮数, 0)
                赋值 (提示信息, “”)
                获取焦点 ()
                返回 ()
            .否则
                .如果 (并且 (等于 (.禁止, 假), 等于 (.现行选中项, -1)))
                    赋值 (提示窗口标题, “提示！”)
                    赋值 (提示窗口图标, 4)
                    赋值 (提示窗口按钮数, 1)
                    赋值 (提示信息, “请输入完整的查询条件。”)
                    载入 (提示窗口, , 真)
                    赋值 (提示窗口标题, “”)
                    赋值 (提示窗口图标, 0)
                    赋值 (提示窗口按钮数, 0)
                    赋值 (提示信息, “”)
                    获取焦点 ()
                    返回 ()
                .否则
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束
.如果 (并且 (取反 (.选中), 取反 (.选中), 取反 (.选中), 取反 (.选中), 取反 (.选中), 取反 (.选中)))
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示窗口图标, 4)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, “请设置查询条件。”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    获取焦点 ()
    返回 ()
.否则
    
.如果结束
载入 (查询图书结果窗口, , 假)
赋值 (TS标志内容, “”) ' 这段程序主要是解决使用“且”选项时的查询问题。
.如果真 (并且 (.选中, 等于 (.现行选中项, 1)))
    赋值 (TS标志内容, “a”)
    .如果 (.选中)
        赋值 (TS标志内容, 相加 (TS标志内容, “b”))
    .否则
        .如果 (.选中)
            赋值 (TS标志内容, 相加 (TS标志内容, “c”))
        .否则
            .如果 (.选中)
                赋值 (TS标志内容, 相加 (TS标志内容, “d”))
            .否则
                .如果 (.选中)
                    赋值 (TS标志内容, 相加 (TS标志内容, “e”))
                .否则
                    .如果 (.选中)
                        赋值 (TS标志内容, 相加 (TS标志内容, “f”))
                    .否则
                        赋值 (TS标志内容, “”)
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果真结束
.如果真 (并且 (.选中, 等于 (.现行选中项, 1)))
    .如果真 (等于 (TS标志内容, “”)) ' 防止（标志内容）有数据时不能向下带入。
        赋值 (TS标志内容, “b”)
    .如果真结束
    .如果 (.选中)
        赋值 (TS标志内容, 相加 (TS标志内容, “c”))
    .否则
        .如果 (.选中)
            赋值 (TS标志内容, 相加 (TS标志内容, “d”))
        .否则
            .如果 (.选中)
                赋值 (TS标志内容, 相加 (TS标志内容, “e”))
            .否则
                .如果 (.选中)
                    赋值 (TS标志内容, 相加 (TS标志内容, “f”))
                .否则
                    赋值 (TS标志内容, “”)
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果真结束
.如果真 (并且 (.选中, 等于 (.现行选中项, 1)))
    .如果真 (等于 (TS标志内容, “”))
        赋值 (TS标志内容, “c”)
    .如果真结束
    .如果 (.选中)
        赋值 (TS标志内容, 相加 (TS标志内容, “d”))
    .否则
        .如果 (.选中)
            赋值 (TS标志内容, 相加 (TS标志内容, “e”))
        .否则
            .如果 (.选中)
                赋值 (TS标志内容, 相加 (TS标志内容, “f”))
            .否则
                赋值 (TS标志内容, “”)
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果真结束
.如果真 (并且 (.选中, 等于 (.现行选中项, 1)))
    .如果真 (等于 (TS标志内容, “”))
        赋值 (TS标志内容, “d”)
    .如果真结束
    .如果 (.选中)
        赋值 (TS标志内容, 相加 (TS标志内容, “e”))
    .否则
        .如果 (.选中)
            赋值 (TS标志内容, 相加 (TS标志内容, “f”))
        .否则
            赋值 (TS标志内容, “”)
        .如果结束
        
    .如果结束
    
.如果真结束
.如果真 (并且 (.选中, 等于 (.现行选中项, 1)))
    .如果真 (等于 (TS标志内容, “”))
        赋值 (TS标志内容, “e”)
    .如果真结束
    .如果 (.选中)
        赋值 (TS标志内容, 相加 (TS标志内容, “f”))
    .否则
        赋值 (TS标志内容, “”) ' “且”选项查询程序结束。
    .如果结束
    
.如果真结束
.如果 (置当前库 (“tsgltskcx”))
    清空 ()
.否则
    赋值 (提示窗口标题, “抱歉！”)
    赋值 (提示窗口图标, 1)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, “设置数据库 tsgltskcx.edb 时出现错误，查询失败！”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    查询图书窗口.销毁 ()
.如果结束
.如果真 (等于 (TS标志内容, “”)) ' 防止（标志内容）为空时出现查找错误。
    赋值 (TS标志内容, “0”)
.如果真结束
添加 (“tsgltsk”, 大于 (寻找文本 (读 (8), TS标志内容, , 假), 0), ) ' 把所有符合“且”运算条件的记录添加到stgltskcx.edb数据库
赋值 (TSWB, “abcdef”)
.计次循环首 (取文本长度 (TS标志内容), CXM) ' 这个循环是为了把已经参与过“且”运算的字段排除
    赋值 (TSWB, 子文本替换 (TSWB, 取文本中间 (TS标志内容, CXM, 1), “”, , , 真))
.计次循环尾 ()
重定义数组 (TSWB字母, 假, 6)
连续赋值 (“IO456OEW87RE”, TSWB字母 [1], TSWB字母 [2], TSWB字母 [3], TSWB字母 [4], TSWB字母 [5], TSWB字母 [6]) ' 字符串是任意的,目的是为了防止出现空
.计次循环首 (取文本长度 (TSWB), 循环次数)
    赋值 (TSWB字母 [循环次数], 取文本中间 (TSWB, 循环次数, 1))
.计次循环尾 ()
添加 (“tsgltsk”, 或者 (大于 (寻找文本 (读 (8), TSWB字母 [1], , 假), 0), 大于 (寻找文本 (读 (8), TSWB字母 [2], , 假), 0), 大于 (寻找文本 (读 (8), TSWB字母 [3], , 假), 0), 大于 (寻找文本 (读 (8), TSWB字母 [4], , 假), 0), 大于 (寻找文本 (读 (8), TSWB字母 [5], , 假), 0), 大于 (寻找文本 (读 (8), TSWB字母 [6], , 假), 0)), ) ' 把所有符合“或”运算条件的记录添加到tsgltskcx.edb数据库
置当前库 (“tsgltskcx”)
到首记录 ()
.计次循环首 (取记录数 (), ) ' 删除可能出现的重复记录,因为当查询条件中同时出现“并且”和“或者”条件时，当一个记录同时满足这两个条件时，就会出现重复
    赋值 (TS编号, 读 (1))
    .如果真 (大于 (计算数目 (等于 (读 (1), TS编号)), 1))
        删除 ()
        彻底删除 ()
    .如果真结束
    跳过 (1)
.计次循环尾 ()
.计次循环首 (查询图书结果窗口.., )
    查询图书结果窗口.未知支持库函数_36 (., 0)
.计次循环尾 ()
.计次循环首 (查询图书结果窗口.., )
    查询图书结果窗口.未知支持库函数_37 (., 0)
.计次循环尾 ()
到首记录 ()
赋值 (查询图书结果窗口.., 相加 (取记录数 (), 1))
赋值 (查询图书结果窗口.., 7)
查询图书结果窗口.未知支持库函数_25 (., 0, 0, 0, 查询图书结果窗口.., 2)
查询图书结果窗口.未知支持库函数_25 (., 1, 0, 查询图书结果窗口.., 0, 2)
查询图书结果窗口.未知支持库函数_32 (., 0, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “L0”, “50”)))
查询图书结果窗口.未知支持库函数_32 (., 1, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “L1”, “90”)))
查询图书结果窗口.未知支持库函数_32 (., 2, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “L2”, “400”)))
查询图书结果窗口.未知支持库函数_32 (., 3, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “L3”, “200”)))
查询图书结果窗口.未知支持库函数_32 (., 4, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “L4”, “70”)))
查询图书结果窗口.未知支持库函数_32 (., 5, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “L5”, “70”)))
查询图书结果窗口.未知支持库函数_32 (., 6, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “L6”, “70”)))
查询图书结果窗口.未知支持库函数_9 (., 0, 0, 1, “序号”)
赋值 (查询图书结果窗口.., 1)
赋值 (查询图书结果窗口.., 1)
.计次循环首 (7, 循环次数)
    查询图书结果窗口.未知支持库函数_9 (., 0, 循环次数, 1, 取字段名 (循环次数))
.计次循环尾 ()
.计次循环首 (取记录数 (), CXM)
    查询图书结果窗口.未知支持库函数_9 (., CXM, 0, 1, 数值到格式文本 (CXM, 0, 假))
    .计次循环首 (7, CXN)
        .如果真 (小于 (CXN, 4))
            查询图书结果窗口.未知支持库函数_9 (., CXM, CXN, 1, 读 (CXN))
        .如果真结束
        .如果真 (等于 (CXN, 4))
            查询图书结果窗口.未知支持库函数_9 (., CXM, CXN, 1, 数值到格式文本 (读 (CXN), 2, 假))
        .如果真结束
        .如果真 (大于 (CXN, 4))
            查询图书结果窗口.未知支持库函数_9 (., CXM, CXN, 1, 数值到格式文本 (读 (CXN), 0, 假))
        .如果真结束
        
    .计次循环尾 ()
    跳过 (1)
.计次循环尾 ()
恢复鼠标 ()

.子程序 _查询图书窗口_创建完毕, 空白型, , 
获取焦点 ()
连续赋值 (真, .禁止, .禁止, .禁止, .禁止, .禁止)

.子程序 _查询图书窗口_取消按钮_被单击, 空白型, , 
查询图书窗口.销毁 ()
赋值 (主窗口.., -1)

.子程序 _选择框1_失去焦点, 空白型, , 
.如果真 (取反 (.选中))
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
    赋值 (.现行选中项, -1)
.如果真结束


.子程序 _选择框2_失去焦点, 空白型, , 
.如果真 (取反 (.选中))
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
    赋值 (.现行选中项, -1)
.如果真结束


.子程序 _选择框3_失去焦点, 空白型, , 
.如果真 (取反 (.选中))
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
    赋值 (.现行选中项, -1)
.如果真结束


.子程序 _选择框4_失去焦点, 空白型, , 
.如果真 (取反 (.选中))
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
    赋值 (.现行选中项, -1)
.如果真结束


.子程序 _选择框5_失去焦点, 空白型, , 
.如果真 (取反 (.选中))
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
    赋值 (.现行选中项, -1)
.如果真结束


.子程序 _选择框6_失去焦点, 空白型, , 
.如果真 (取反 (.选中))
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
.如果真结束


.子程序 _选择框1_被单击, 空白型, , 
.如果真 (或者 (.选中, .选中, .选中, .选中, .选中))
    赋值 (.禁止, 假) ' 此条程序为确保当用户由下向上设置查询条件时，右列相应组合框的禁止属性不能及时关闭（下同）。
.如果真结束
调整各控件状态子程序 ()


.子程序 _选择框2_被单击, 空白型, , 
.如果真 (.选中) ' 此条程序确保当其下一条件被设置时，其右侧组合框应处于可设置状态（下同）。
    赋值 (.禁止, 假)
.如果真结束
.如果真 (或者 (.选中, .选中, .选中, .选中))
    赋值 (.禁止, 假)
.如果真结束
调整各控件状态子程序 ()


.子程序 _选择框3_被单击, 空白型, , 
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (或者 (.选中, .选中, .选中))
    赋值 (.禁止, 假)
.如果真结束
调整各控件状态子程序 ()


.子程序 _选择框4_被单击, 空白型, , 
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (或者 (.选中, .选中))
    赋值 (.禁止, 假)
.如果真结束
调整各控件状态子程序 ()


.子程序 _选择框5_被单击, 空白型, , 
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
调整各控件状态子程序 ()


.子程序 _选择框6_被单击, 空白型, , 
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
调整各控件状态子程序 ()


.子程序 调整各控件状态子程序, 逻辑型, , 
.如果真 (取反 (.选中)) ' 此段程序确保当项目未选中时，其右侧组合框为不可用，当其后没有项目被选择时，其右侧组合框也不可用。
    赋值 (.现行选中项, -1)
    赋值 (.禁止, 真)
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
.如果真结束
.如果真 (取反 (.选中))
    赋值 (.现行选中项, -1)
    赋值 (.禁止, 真)
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
.如果真结束
.如果真 (取反 (.选中))
    赋值 (.现行选中项, -1)
    赋值 (.禁止, 真)
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
.如果真结束
.如果真 (取反 (.选中))
    赋值 (.现行选中项, -1)
    赋值 (.禁止, 真)
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
.如果真结束
.如果真 (取反 (.选中))
    赋值 (.现行选中项, -1)
    赋值 (.禁止, 真)
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
.如果真结束
.如果真 (取反 (.选中))
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
.如果真结束
.如果真 (并且 (取反 (.选中), 取反 (.选中), 取反 (.选中), 取反 (.选中), 取反 (.选中)))
    赋值 (.禁止, 真)
    赋值 (.现行选中项, -1)
.如果真结束
.如果真 (并且 (取反 (.选中), 取反 (.选中), 取反 (.选中), 取反 (.选中)))
    赋值 (.禁止, 真)
    赋值 (.现行选中项, -1)
.如果真结束
.如果真 (并且 (取反 (.选中), 取反 (.选中), 取反 (.选中)))
    赋值 (.禁止, 真)
    赋值 (.现行选中项, -1)
.如果真结束
.如果真 (并且 (取反 (.选中), 取反 (.选中)))
    赋值 (.禁止, 真)
    赋值 (.现行选中项, -1)
.如果真结束
.如果真 (取反 (.选中))
    赋值 (.禁止, 真)
    赋值 (.现行选中项, -1)
.如果真结束
返回 (真)

.子程序 _组合框1_列表项被选择, 空白型, , 
赋值 (.选中, 真)
获取焦点 ()
调整各控件状态子程序 ()

.子程序 _组合框2_列表项被选择, 空白型, , 
赋值 (.选中, 真)
获取焦点 ()
调整各控件状态子程序 ()

.子程序 _组合框3_列表项被选择, 空白型, , 
赋值 (.选中, 真)
获取焦点 ()
调整各控件状态子程序 ()

.子程序 _组合框4_列表项被选择, 空白型, , 
赋值 (.选中, 真)
获取焦点 ()
调整各控件状态子程序 ()

.子程序 _组合框5_列表项被选择, 空白型, , 
赋值 (.选中, 真)
获取焦点 ()
调整各控件状态子程序 ()

.子程序 _组合框6_列表项被选择, 空白型, , 
赋值 (.选中, 真)
获取焦点 ()

.子程序 _编辑框1_获得焦点, 空白型, , 
赋值 (.选中, 真)
调整各控件状态子程序 ()
.如果真 (或者 (.选中, .选中, .选中, .选中, .选中))
    赋值 (.禁止, 假) ' 此条程序为确保当用户由下向上设置查询条件时，右列相应组合框的禁止属性不能及时关闭（下同）。
.如果真结束


.子程序 _编辑框2_获得焦点, 空白型, , 
赋值 (.选中, 真)
调整各控件状态子程序 ()
.如果真 (.选中) ' 此条程序确保当其下一条件被设置时，其右侧组合框应处于可设置状态（下同）。
    赋值 (.禁止, 假)
.如果真结束
.如果真 (或者 (.选中, .选中, .选中, .选中))
    赋值 (.禁止, 假)
.如果真结束


.子程序 _编辑框3_获得焦点, 空白型, , 
赋值 (.选中, 真)
调整各控件状态子程序 ()
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (或者 (.选中, .选中, .选中))
    赋值 (.禁止, 假)
.如果真结束


.子程序 _编辑框4_获得焦点, 空白型, , 
赋值 (.选中, 真)
调整各控件状态子程序 ()
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (或者 (.选中, .选中))
    赋值 (.禁止, 假)
.如果真结束


.子程序 _编辑框5_获得焦点, 空白型, , 
赋值 (.选中, 真)
调整各控件状态子程序 ()
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束


.子程序 _编辑框6_获得焦点, 空白型, , 
赋值 (.选中, 真)
调整各控件状态子程序 ()
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束


.窗口程序集 查询图书结果窗口程序集, , , 

.程序集变量 M, 整数型, , , 
.子程序 _查询图书结果窗口_创建完毕, 空白型, , 
赋值 (.禁止, 取反 (是否注册))
置当前库 (“tsglzz”)
加记录 (取现行时间 (), 操作者, “查询图书。”)
.计次循环首 (查询图书结果窗口.., )
    查询图书结果窗口.未知支持库函数_36 (., 0)
.计次循环尾 ()
.计次循环首 (查询图书结果窗口.., )
    查询图书结果窗口.未知支持库函数_37 (., 0)
.计次循环尾 ()


.子程序 _查询结果_退出按钮_被单击, 空白型, , 
查询图书结果窗口.销毁 ()

.子程序 _查询结果_转换按钮_被单击, 空白型, , 
.如果真 (等于 (未知支持库函数_0 (), 假))
    赋值 (提示窗口标题, “错误！”)
    赋值 (提示窗口图标, 1)
    赋值 (提示信息, “Excel 程序创建失败！可能没有安装Excel2000。”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
载入 (进度指示窗口, , 假)
赋值 (进度指示窗口..内容, “正在进行转换...请不要进行其它操作！”)
刷新显示 ()
赋值 (., 相加 (使用单位, “图书查询结果”))
.未知支持库函数_6 ()
赋值 (., 真)
未知支持库函数_21 ()
.计次循环首 (., M)
    赋值 (., M)
    赋值 (., 相加 (“表格”, 数值到格式文本 (M, , 假)))
.计次循环尾 ()
赋值 (., 1)
设置表格 (“A1”, “F1”)
未知支持库函数_26 ()
赋值 (., 40)
赋值 (., 10)
赋值 (., 相加 (使用单位, “图书查询结果”))
赋值 (., 真)
赋值 (., 取颜色值 (41, 115, 164))
赋值 (., 20)
赋值 (., 真)
赋值 (., -4108)
创建表格 ()
.未知支持库函数_31 ()
赋值 (., 85)

.子程序 创建表格, 空白型, , 
.参数 工作表, 未知类型0x80002, 参考, 

.局部变量 计次变量, 整数型, , , 

设置表格 (工作表, “A2”, “A2”)
赋值 (., 9)
赋值 (., 30)
赋值 (., -4108)
1.未知支持库函数_30 (2, 0)
赋值 (工作表., “图书编号”)
设置表格 (工作表, “B2”, “B2”)
赋值 (., 38)
赋值 (., -4108)
1.未知支持库函数_30 (2, 0)
赋值 (工作表., “图书名称”)
设置表格 (工作表, “C2”, “C2”)
赋值 (., 12)
赋值 (., -4108)
1.未知支持库函数_30 (2, 0)
赋值 (工作表., “作者”)
设置表格 (工作表, “D2”, “D2”)
赋值 (., 5.75)
赋值 (., -4108)
1.未知支持库函数_30 (2, 0)
赋值 (工作表., “定价”)
设置表格 (工作表, “E2”, “E2”)
赋值 (., 5.75)
赋值 (., -4108)
1.未知支持库函数_30 (2, 0)
赋值 (工作表., “数量”)
设置表格 (工作表, “F2”, “F2”)
赋值 (., 5.75)
赋值 (., -4108)
1.未知支持库函数_30 (2, 0)
赋值 (工作表., “库存”)
置当前库 (“tsgltskcx”)
到首记录 ()
.计次循环首 (取记录数 (), 计次变量)
    赋值 (进度指示窗口..位置, 相乘 (相除 (计次变量, 取记录数 ()), 100))
    设置表格内容 (工作表, 相加 (“A”, 数值到格式文本 (相加 (计次变量, 2), 0, 假)), “”, 读 (1))
    设置表格内容 (工作表, 相加 (“B”, 数值到格式文本 (相加 (计次变量, 2), 0, 假)), “”, 读 (2))
    设置表格内容 (工作表, 相加 (“C”, 数值到格式文本 (相加 (计次变量, 2), 0, 假)), “”, 读 (3))
    设置表格内容 (工作表, 相加 (“D”, 数值到格式文本 (相加 (计次变量, 2), 0, 假)), “”, 数值到格式文本 (读 (4), 2, 真))
    设置表格内容 (工作表, 相加 (“E”, 数值到格式文本 (相加 (计次变量, 2), 0, 假)), “”, 数值到格式文本 (读 (5), 0, 真))
    设置表格内容 (工作表, 相加 (“F”, 数值到格式文本 (相加 (计次变量, 2), 0, 假)), “”, 数值到格式文本 (读 (6), 0, 真))
    跳过 (1)
.计次循环尾 ()
进度指示窗口.销毁 ()

.子程序 设置表格, 空白型, , 
.参数 工作表, 未知类型0x80002, 参考, 
.参数 首单元, 文本型, , 
.参数 尾单元, 文本型, , 

.如果真 (等于 (尾单元, “”))
    赋值 (尾单元, 首单元)
.如果真结束
赋值 (工作表., 首单元)
赋值 (工作表., 尾单元)


.子程序 设置表格内容, 空白型, , 
.参数 工作表, 未知类型0x80002, 参考, 
.参数 首单元, 文本型, , 
.参数 尾单元, 文本型, , 
.参数 表格内容, 文本型, , 

设置表格 (工作表, 首单元, 尾单元)
赋值 (工作表., 表格内容)
1.未知支持库函数_30 (2, 0)
赋值 (., 25)
赋值 (., -4108)

.子程序 _查询结果_打印按钮_被单击, 空白型, , 
赋值 (表头标志, “查询结果”)
载入 (置打印表头窗口, , 假)

.窗口程序集 查看日志窗口程序集, , , 

.子程序 _查看日志窗口_创建完毕, 空白型, , 
赋值 (.禁止, 取反 (是否注册))
置等待鼠标 ()
置当前库 (“tsglzz”)
到首记录 ()
.计次循环首 (., )
    0.未知支持库函数_36 ()
.计次循环尾 ()
.计次循环首 (., )
    0.未知支持库函数_37 ()
.计次循环尾 ()
赋值 (., 1)
赋值 (., 0)
赋值 (., 取字段数 ())
赋值 (., 相加 (取记录数 (), 1))
0.未知支持库函数_25 (0, 0, 2, 2)
1.未知支持库函数_25 (0, ., 0, 2)
0.未知支持库函数_9 (0, 1, “用户名”)
0.未知支持库函数_9 (1, 1, “操作时间”)
0.未知支持库函数_9 (2, 1, “操作内容”)
0.未知支持库函数_32 (80)
1.未知支持库函数_32 (160)
2.未知支持库函数_32 (300)
.计次循环首 (取记录数 (), 循环次数)
    循环次数.未知支持库函数_9 (0, 1, 读 (2))
    循环次数.未知支持库函数_9 (1, 1, 时间到文本 (读 (1), 1))
    循环次数.未知支持库函数_9 (2, 1, 读 (3))
    跳过 (1)
.计次循环尾 ()
1.未知支持库函数_25 (0, ., 0, 2)
赋值 (., 假)
恢复鼠标 ()

.子程序 _查看日志_打印按钮_被单击, 空白型, , 
赋值 (表头标志, “日志”)
载入 (置打印表头窗口, , 真)

.子程序 _查看日志_关闭按钮_被单击, 空白型, , 
查看日志窗口.销毁 ()
赋值 (主窗口.., -1)

.窗口程序集 日志管理窗口程序集, , , 

.子程序 _日志管理窗口_创建完毕, 空白型, , 
置等待鼠标 ()
置当前库 (“tsglzz”)
到首记录 ()
.计次循环首 (., )
    0.未知支持库函数_36 ()
.计次循环尾 ()
.计次循环首 (., )
    0.未知支持库函数_37 ()
.计次循环尾 ()
赋值 (., 1)
赋值 (., 0)
赋值 (., 取字段数 ())
赋值 (., 相加 (取记录数 (), 1))
0.未知支持库函数_25 (0, 0, 2, 2)
1.未知支持库函数_25 (0, ., 0, 2)
0.未知支持库函数_9 (0, 1, “用户名”)
0.未知支持库函数_9 (1, 1, “操作时间”)
0.未知支持库函数_9 (2, 1, “操作内容”)
0.未知支持库函数_32 (80)
1.未知支持库函数_32 (160)
2.未知支持库函数_32 (300)
.计次循环首 (取记录数 (), 循环次数)
    循环次数.未知支持库函数_9 (0, 1, 读 (2))
    循环次数.未知支持库函数_9 (1, 1, 时间到文本 (读 (1), 1))
    循环次数.未知支持库函数_9 (2, 1, 读 (3))
    跳过 (1)
.计次循环尾 ()
1.未知支持库函数_25 (0, ., 0, 2)
赋值 (., 假)
恢复鼠标 ()

.子程序 _查看日志_关闭按钮_被单击, 空白型, , 
日志管理窗口.销毁 ()
赋值 (主窗口.., -1)

.子程序 _日志管理_全部删除按钮1_被单击, 空白型, , 
置当前库 (“tsglzz”)
赋值 (提示窗口图标, 3)
赋值 (提示窗口标题, “提示”)
赋值 (提示窗口按钮数, 2)
赋值 (提示信息, “    系统日志所占空间很少，当系统数据遭到人为破坏时，通过它可以发现一些线索，强烈建议您不要删除。仍然坚持要删除吗？”)
载入 (提示窗口, , 真)
.如果真 (等于 (提示窗口返回值, 1))
    赋值 (提示窗口返回值, 0)
    清空 ()
    加记录 (取现行时间 (), 操作者, “删除日志成功。”)
    _日志管理窗口_创建完毕 ()
.如果真结束
赋值 (提示窗口图标, 0)
赋值 (提示窗口标题, “”)
赋值 (提示窗口按钮数, 0)
赋值 (提示信息, “”)

.子程序 _日志管理_部分删除按钮_被单击, 空白型, , 
载入 (删除条件窗口, , 真)

.窗口程序集 删除条件窗口程序集, , , 

.子程序 _删除条件窗口_取消按钮_被单击, 空白型, , 
删除条件窗口.销毁 ()

.子程序 _删除条件窗口_确定按钮_被单击, 空白型, , 
赋值 (提示窗口标题, “提示”)
赋值 (提示窗口图标, 3)
赋值 (提示窗口按钮数, 2)
赋值 (提示信息, “    系统日志所占空间很少，当系统数据遭到人为破坏时，通过它可以发现一些线索，强烈建议您不要删除。仍然坚持要删除吗？”)
载入 (提示窗口, , 真)
.如果真 (等于 (提示窗口返回值, 1))
    赋值 (提示窗口返回值, 0)
    置当前库 (“tsglzz”)
    .如果真 (大于 (.今天, .今天))
        删除 (并且 (大于 (读 (1), .今天), 小于 (读 (1), .今天)))
        彻底删除 ()
        加记录 (取现行时间 (), 操作者, 相加 (“删除”, 时间到文本 (.今天, 2), “至”, 时间到文本 (.今天, 2), “的记录成功。”))
    .如果真结束
    .如果真 (大于 (.今天, .今天))
        删除 (并且 (大于 (读 (1), .今天), 小于 (读 (1), .今天)))
        彻底删除 ()
        加记录 (取现行时间 (), 操作者, 相加 (“删除”, 时间到文本 (.今天, 2), “至”, 时间到文本 (.今天, 2), “的记录成功。”))
    .如果真结束
    .如果真 (等于 (.今天, .今天))
        删除 (等于 (取日期 (读 (1)), 取日期 (.今天)))
        彻底删除 ()
        加记录 (取现行时间 (), 操作者, 相加 (“删除”, 时间到文本 (.今天, 2), “的记录成功。”))
    .如果真结束
    删除条件窗口.销毁 ()
    _日志管理窗口_创建完毕 ()
.如果真结束
赋值 (提示窗口标题, “”)
赋值 (提示窗口图标, 0)
赋值 (提示窗口按钮数, 0)
赋值 (提示信息, “”)

.子程序 _删除条件窗口_创建完毕, 空白型, , 


.窗口程序集 参数设置窗口程序集, , , 

.程序集变量 普通设置, 逻辑型, , , 
.程序集变量 VIP设置, 逻辑型, , , 
.子程序 _参数设置_确认按钮_被单击, 空白型, , 
置当前库 (“hysz”)
到首记录 ()
写配置项 (相加 (运行目录, “\tsglsoft.ini”), “系统参数”, “使用单位”, .内容)
赋值 (使用单位, .内容)
写配置项 (相加 (运行目录, “\tsglsoft.ini”), “系统参数”, “软件名称”, .内容)
赋值 (软件名称, .内容)
赋值 (主窗口., 软件名称)
.如果 (是否注册)
    赋值 (主窗口..内容, 相加 (软件名称, “      使用权归 ”, 使用单位, “ 所有          操作员：”, 操作者))
    赋值 (主窗口..内容, 相加 (使用单位, #换行符, #换行符, “图书管理专用”))
.否则
    赋值 (主窗口..内容, 相加 (软件名称, “　　　　　　　　　*未注册*”))
.如果结束
.如果真 (大于 (到数值 (.内容), 10))
    赋值 (提示信息, “VIP 最多限借10本。”)
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示窗口图标, 4)
    载入 (提示窗口, , 真)
    赋值 (提示信息, “”)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (.内容, “10”)
    返回 ()
.如果真结束
.如果真 (大于 (到数值 (.内容), 5))
    赋值 (提示信息, “普通会员最多限借5本。”)
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示窗口图标, 4)
    载入 (提示窗口, , 真)
    赋值 (提示信息, “”)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (.内容, “5”)
    返回 ()
.如果真结束
赋值 (普通设置, 替换 (等于 (读 (1), “普通”), “限借”, 到数值 (.内容), “借期”, 到数值 (.内容), “押金”, 到数值 (.内容), “丢赔”, 到数值 (.内容), “损赔”, 到数值 (.内容)))
赋值 (VIP设置, 替换 (等于 (读 (1), “VIP”), “限借”, 到数值 (.内容), “借期”, 到数值 (.内容), “押金”, 到数值 (.内容), “丢赔”, 到数值 (.内容), “损赔”, 到数值 (.内容)))
.如果 (或者 (等于 (VIP设置, 假), 等于 (普通设置, 假)))
    赋值 (提示信息, “参数设置失败，请稍候重试。”)
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示窗口图标, 4)
    载入 (提示窗口, , 真)
    赋值 (提示信息, “”)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
.否则
    赋值 (P1, 到数值 (.内容))
    赋值 (P2, 到数值 (.内容))
    赋值 (P3, 到数值 (.内容))
    赋值 (P4, 到数值 (.内容))
    赋值 (P5, 到数值 (.内容))
    赋值 (V1, 到数值 (.内容))
    赋值 (V2, 到数值 (.内容))
    赋值 (V3, 到数值 (.内容))
    赋值 (V4, 到数值 (.内容))
    赋值 (V5, 到数值 (.内容))
    赋值 (TSB, 到数值 (.内容))
    赋值 (HYB, 到数值 (.内容))
    写配置项 (相加 (运行目录, “\tsglsoft.ini”), “普通会员”, “限借”, .内容)
    写配置项 (相加 (运行目录, “\tsglsoft.ini”), “普通会员”, “借期”, .内容)
    写配置项 (相加 (运行目录, “\tsglsoft.ini”), “普通会员”, “押金”, .内容)
    写配置项 (相加 (运行目录, “\tsglsoft.ini”), “普通会员”, “丢赔”, .内容)
    写配置项 (相加 (运行目录, “\tsglsoft.ini”), “普通会员”, “损赔”, .内容)
    写配置项 (相加 (运行目录, “\tsglsoft.ini”), “VIP”, “限借”, .内容)
    写配置项 (相加 (运行目录, “\tsglsoft.ini”), “VIP”, “借期”, .内容)
    写配置项 (相加 (运行目录, “\tsglsoft.ini”), “VIP”, “押金”, .内容)
    写配置项 (相加 (运行目录, “\tsglsoft.ini”), “VIP”, “丢赔”, .内容)
    写配置项 (相加 (运行目录, “\tsglsoft.ini”), “VIP”, “损赔”, .内容)
    写配置项 (相加 (运行目录, “\tsglsoft.ini”), “编码长度”, “图书”, .内容)
    写配置项 (相加 (运行目录, “\tsglsoft.ini”), “编码长度”, “借书证”, .内容)
    置当前库 (“tsglzz”)
    加记录 (取现行时间 (), 操作者, “设置系统参数。”)
    赋值 (提示信息, “参数设置成功。”)
    赋值 (提示窗口标题, “恭喜！”)
    赋值 (提示窗口图标, 4)
    载入 (提示窗口, , 真)
    赋值 (提示信息, “”)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
.如果结束
参数设置窗口.销毁 ()
赋值 (主窗口.., -1)


.子程序 _参数设置_取消按钮_被单击, 空白型, , 
参数设置窗口.销毁 ()
赋值 (主窗口.., -1)

.子程序 _参数设置窗口_创建完毕, 空白型, , 
置等待鼠标 ()
赋值 (.内容, 读配置项 (相加 (运行目录, “\tsglsoft.ini”), “系统参数”, “使用单位”, “一营一连”))
赋值 (.内容, 读配置项 (相加 (运行目录, “\tsglsoft.ini”), “系统参数”, “软件名称”, “图书管理软件v1.0”))
赋值 (.内容, 读配置项 (相加 (运行目录, “\tsglsoft.ini”), “编码长度”, “图书”, “4”))
赋值 (.内容, 读配置项 (相加 (运行目录, “\tsglsoft.ini”), “编码长度”, “借书证”, “3”))
置当前库 (“hysz”)
到首记录 ()
查找 (等于 (读 (1), “普通”))
赋值 (.内容, 数值到格式文本 (读 (2), 0, 假))
赋值 (.内容, 数值到格式文本 (读 (3), 0, 假))
赋值 (.内容, 数值到格式文本 (读 (4), 1, 假))
赋值 (.内容, 数值到格式文本 (读 (5), 1, 假))
赋值 (.内容, 数值到格式文本 (读 (6), 1, 假))
查找 (等于 (读 (1), “VIP”))
赋值 (.内容, 数值到格式文本 (读 (2), 0, 假))
赋值 (.内容, 数值到格式文本 (读 (3), 0, 假))
赋值 (.内容, 数值到格式文本 (读 (4), 1, 假))
赋值 (.内容, 数值到格式文本 (读 (5), 1, 假))
赋值 (.内容, 数值到格式文本 (读 (6), 1, 假))
恢复鼠标 ()

.窗口程序集 会员查找窗口程序集, , , 

.子程序 _会员查找窗口_创建完毕, 空白型, , 
赋值 (.选中, 真)
获取焦点 ()
赋值 (.现行选中项, 0)
赋值 (.现行选中项, 0)
赋值 (.现行选中项, 0)
赋值 (.现行选中项, 0)


.子程序 _编辑框1_获得焦点, 空白型, , 
赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
连续赋值 (“”, .内容, .内容, .内容)
赋值 (.内容, “查找”)

.子程序 _编辑框2_获得焦点, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)
连续赋值 (“”, .内容, .内容, .内容)
赋值 (.内容, “查找”)

.子程序 _编辑框3_获得焦点, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 真)
赋值 (.选中, 假)
连续赋值 (“”, .内容, .内容, .内容)
赋值 (.内容, “查找”)

.子程序 _编辑框4_获得焦点, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 真)
连续赋值 (“”, .内容, .内容, .内容)
赋值 (.内容, “查找”)

.子程序 _单选框1_获得焦点, 空白型, , 
获取焦点 ()

.子程序 _单选框2_获得焦点, 空白型, , 
获取焦点 ()

.子程序 _单选框3_获得焦点, 空白型, , 
获取焦点 ()

.子程序 _单选框4_获得焦点, 空白型, , 
获取焦点 ()

.子程序 _组合框1_列表项被选择, 空白型, , 
赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
获取焦点 ()

.子程序 _组合框2_列表项被选择, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
获取焦点 ()

.子程序 _组合框3_列表项被选择, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 真)
赋值 (.选中, 假)
获取焦点 ()

.子程序 _组合框4_列表项被选择, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 真)
获取焦点 ()

.子程序 _编辑框1_内容被改变, 空白型, , 
赋值 (.内容, “查找”)

.子程序 _编辑框2_内容被改变, 空白型, , 
赋值 (.内容, “查找”)

.子程序 _编辑框3_内容被改变, 空白型, , 
赋值 (.内容, “查找”)

.子程序 _编辑框4_内容被改变, 空白型, , 
赋值 (.内容, “查找”)

.子程序 查找子程序, 空白型, , 
.如果真 (等于 (.选中, 真))
    .如果真 (等于 (.现行选中项, 0))
        .如果 (查找 (等于 (读 (1), .内容)))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 1)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    .如果真 (等于 (.现行选中项, 1))
        .如果 (查找 (大于 (寻找文本 (读 (1), .内容, , 假), 0)))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 1)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    .如果真 (等于 (.现行选中项, 2))
        .如果 (查找 (等于 (寻找文本 (读 (1), .内容, , 假), -1)))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 1)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果真 (等于 (.现行选中项, 0))
        .如果 (查找 (等于 (读 (2), .内容)))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 2)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    .如果真 (等于 (.现行选中项, 1))
        .如果 (查找 (大于 (寻找文本 (读 (2), .内容, , 假), 0)))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 2)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    .如果真 (等于 (.现行选中项, 2))
        .如果 (查找 (等于 (寻找文本 (读 (2), .内容, , 假), -1)))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 2)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果真 (等于 (.现行选中项, 0))
        .如果 (查找 (等于 (读 (3), .内容)))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 3)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    .如果真 (等于 (.现行选中项, 1))
        .如果 (查找 (大于 (寻找文本 (读 (3), .内容, , 假), 0)))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 3)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    .如果真 (等于 (.现行选中项, 2))
        .如果 (查找 (等于 (寻找文本 (读 (3), .内容, , 假), -1)))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 3)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果真 (等于 (.现行选中项, 0))
        .如果 (查找 (等于 (读 (4), .内容)))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 4)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    .如果真 (等于 (.现行选中项, 1))
        .如果 (查找 (大于 (寻找文本 (读 (4), .内容, , 假), 0)))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 4)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    .如果真 (等于 (.现行选中项, 2))
        .如果 (查找 (等于 (寻找文本 (读 (4), .内容, , 假), -1)))
            赋值 (.内容, “下一个”)
            主窗口.未知支持库函数_0 (., 取记录号 (), 4)
            跳过 (1)
        .否则
            赋值 (.内容, “查找完毕”)
        .如果结束
        
    .如果真结束
    
.如果真结束


.子程序 _查找窗口_确定按钮_被单击, 空白型, , 
.如果真 (等于 (.内容, “查找”))
    置当前库 (“tsglhy”)
    到首记录 ()
.如果真结束
查找子程序 ()


.子程序 _查找窗口_取消图形按钮_被单击, 空白型, , 
会员查找窗口.销毁 ()

.窗口程序集 会员统计窗口程序集, , , 

.子程序 _会员统计窗口_创建完毕, 空白型, , 
置当前库 (“tsglhy”)
赋值 (.内容, 相加 (字符 (13), 字符 (10), “    目前共有会员”, 数值到格式文本 (取记录数 (), 0, 真), “人。其中，VIP会员”, 数值到格式文本 (计算数目 (等于 (读 (5), 真)), , 真), “人，普通会员”, 数值到格式文本 (计算数目 (等于 (读 (5), 假)), , 真), “人。”))


.子程序 _会员统计窗口_确定按钮_被单击, 空白型, , 
会员统计窗口.销毁 ()


.窗口程序集 会员排序窗口程序集, , , 

.程序集变量 排序字段, 文本型, , , 
.程序集变量 M, 整数型, , , 
.程序集变量 N, 整数型, , , 
.子程序 _会员排序窗口_创建完毕, 空白型, , 


.子程序 排序子程序, 空白型, , 升序方式排序
打开 (相加 (运行目录, “\data\tsglhypx.edb”), “tsglthypx”, 假, 4, , “ujumpitoo@jdyltsgl2.com”, )
置当前库 (“tsglhypx”)
到首记录 ()
.计次循环首 (5, 循环次数)
    主窗口.未知支持库函数_9 (., 0, 循环次数, 1, 取字段名 (循环次数))
.计次循环尾 ()
.计次循环首 (取记录数 (), M)
    主窗口.未知支持库函数_9 (., M, 0, 1, 数值到格式文本 (M, 0, 假))
    .计次循环首 (5, N)
        .如果真 (小于 (N, 5))
            主窗口.未知支持库函数_9 (., M, N, 1, 读 (N))
        .如果真结束
        .如果真 (等于 (N, 5))
            主窗口.未知支持库函数_9 (., M, N, 5, 读 (N))
        .如果真结束
        
    .计次循环尾 ()
    跳过 (1)
.计次循环尾 ()
关闭 (“tsglhypx”)


.子程序 _会员排序窗口_升序按钮_被单击, 空白型, , 
置当前库 (“tsglhy”)
.如果真 (.选中)
    排序 (相加 (取当前目录 (), “\data\tsglhypx.edb”), “借书证编号”, 真, , )
    排序子程序 ()
.如果真结束
.如果真 (.选中)
    排序 (相加 (取当前目录 (), “\data\tsglhypx.edb”), “姓名”, 真, , )
    排序子程序 ()
.如果真结束
.如果真 (.选中)
    排序 (相加 (取当前目录 (), “\data\tsglhypx.edb”), “单位”, 真, , )
    排序子程序 ()
.如果真结束
.如果真 (.选中)
    排序 (相加 (取当前目录 (), “\data\tsglhypx.edb”), “电话”, 真, , )
    排序子程序 ()
.如果真结束
.如果真 (.选中)
    排序 (相加 (取当前目录 (), “\data\tsglhypx.edb”), “是否VIP”, 真, , )
    排序子程序 ()
.如果真结束


.子程序 _会员排序窗口_降序按钮_被单击, 空白型, , 
置当前库 (“tsglhy”)
.如果真 (.选中)
    排序 (相加 (取当前目录 (), “\data\tsglhypx.edb”), “借书证编号”, 假, , )
    排序子程序 ()
.如果真结束
.如果真 (.选中)
    排序 (相加 (取当前目录 (), “\data\tsglhypx.edb”), “姓名”, 假, , )
    排序子程序 ()
.如果真结束
.如果真 (.选中)
    排序 (相加 (取当前目录 (), “\data\tsglhypx.edb”), “单位”, 假, , )
    排序子程序 ()
.如果真结束
.如果真 (.选中)
    排序 (相加 (取当前目录 (), “\data\tsglhypx.edb”), “电话”, 假, , )
    排序子程序 ()
.如果真结束
.如果真 (.选中)
    排序 (相加 (取当前目录 (), “\data\tsglhypx.edb”), “是否VIP”, 假, , )
    排序子程序 ()
.如果真结束


.子程序 _会员排序窗口_放弃按钮_被单击, 空白型, , 
置等待鼠标 ()
.计次循环首 (主窗口.., )
    主窗口.未知支持库函数_36 (., 0)
.计次循环尾 ()
.计次循环首 (主窗口.., )
    主窗口.未知支持库函数_37 (., 0)
.计次循环尾 ()
置当前库 (“tsglhy”)
到首记录 ()
赋值 (主窗口.., 1)
赋值 (主窗口.., 1)
赋值 (主窗口.., 相加 (取记录数 (), 1))
赋值 (主窗口.., 6)
主窗口.未知支持库函数_25 (., 0, 0, 0, 主窗口.., 2)
主窗口.未知支持库函数_25 (., 1, 0, 主窗口.., 0, 2)
主窗口.未知支持库函数_32 (., 0, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L0”, “50”)))
主窗口.未知支持库函数_32 (., 1, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L1”, “90”)))
主窗口.未知支持库函数_32 (., 2, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L2”, “400”)))
主窗口.未知支持库函数_32 (., 3, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L3”, “200”)))
主窗口.未知支持库函数_32 (., 4, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L4”, “70”)))
主窗口.未知支持库函数_32 (., 5, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L5”, “70”)))
主窗口.未知支持库函数_30 (., 5, 5)
主窗口.未知支持库函数_9 (., 0, 0, 1, “序号”)
载入 (进度指示窗口, , 假)
赋值 (进度指示窗口..内容, “正在初始化表格...”)
刷新显示 ()
.计次循环首 (5, 循环次数)
    主窗口.未知支持库函数_9 (., 0, 循环次数, 1, 取字段名 (循环次数))
.计次循环尾 ()
赋值 (进度指示窗口..内容, “正在载入数据...”)
刷新显示 ()
.计次循环首 (取记录数 (), M)
    赋值 (进度指示窗口..位置, 相乘 (相除 (M, 取记录数 ()), 100))
    主窗口.未知支持库函数_9 (., M, 0, 1, 数值到格式文本 (M, 0, 假))
    .计次循环首 (5, N)
        .如果真 (小于 (N, 5))
            主窗口.未知支持库函数_9 (., M, N, 1, 读 (N))
        .如果真结束
        .如果真 (等于 (N, 5))
            主窗口.未知支持库函数_9 (., M, N, 5, 读 (N))
        .如果真结束
        
    .计次循环尾 ()
    跳过 (1)
.计次循环尾 ()
进度指示窗口.销毁 ()
.计次循环首 (主窗口.., M)
    主窗口.未知支持库函数_31 (., 相减 (M, 1), 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “表格参数”, “H”, “24”)))
.计次循环尾 ()
主窗口.未知支持库函数_0 (., 相减 (主窗口.., 1), 0)
主窗口.获取焦点 (.)
恢复鼠标 ()
会员排序窗口.销毁 ()

.子程序 _会员排序窗口_保存按钮_被单击, 空白型, , 
保存子程序2 ()
会员排序窗口.销毁 ()


.窗口程序集 会员校验窗口程序集, , , 

.程序集变量 M, 整数型, , , 循环计数器
.子程序 _会员校验窗口_创建完毕, 空白型, , 
.局部变量 Ret, 整数型, , , 

赋值 (Ret, GetWindowLong (取窗口句柄 (), -20))
赋值 (Ret, 位或 (Ret, 524288))
SetWindowLong (取窗口句柄 (), -20, Ret)
SetLayeredWindowAttributes (会员校验窗口.取窗口句柄 (), 0, 255, #LWA_ALPHA)
赋值 (.内容, “校验发现错误！”)
置等待鼠标 ()
置当前库 (“tsglhy”)
到首记录 ()
清空 ()
.计次循环首 (取记录数 (), M)
    .如果真 (等于 (读 (1), “”))
        相加 (“第”, 数值到格式文本 (M, 0, 假), “列，（借书证编号）不能为空”).加入项目 (相加 (相乘 (M, 10), 1))
    .如果真结束
    赋值 (ZDNR, 读 (1))
    .如果真 (大于 (计算数目 (等于 (读 (1), ZDNR)), 1))
        相加 (“第”, 数值到格式文本 (M, 0, 假), “列，（借书证编号）有重复”).加入项目 (相加 (相乘 (M, 10), 1))
    .如果真结束
    .如果真 (等于 (读 (2), “”))
        相加 (“第”, 数值到格式文本 (M, 0, 假), “列，（姓名）不能为空”).加入项目 (相加 (相乘 (M, 10), 2))
    .如果真结束
    跳过 (1)
.计次循环尾 ()
恢复鼠标 ()
.如果 (大于 (取项目数 (), 0))
    赋值 (.内容, “继续校验”)
.否则
    赋值 (.内容, “关闭”)
    赋值 (.内容, “校验通过！”)
.如果结束


.子程序 _列表框1_列表项被选择, 空白型, , 
主窗口.未知支持库函数_0 (., 绝对取整 (相除 (会员校验窗口.取项目数值 (., 会员校验窗口..现行选中项), 10)), 相减 (会员校验窗口.取项目数值 (., 会员校验窗口..现行选中项), 相乘 (绝对取整 (相除 (会员校验窗口.取项目数值 (., 会员校验窗口..现行选中项), 10)), 10)))

.子程序 _校验窗口_关闭按钮_被单击, 空白型, , 
.如果 (等于 (.内容, “继续校验”))
    _会员校验窗口_创建完毕 ()
.否则
    赋值 (会员校验是否通过, 真)
    会员校验窗口.销毁 ()
.如果结束


.子程序 _超级按钮1_被单击, 空白型, , 
会员校验窗口.销毁 ()

.子程序 _会员校验窗口_将被销毁, 空白型, , 
赋值 (会员校验是否通过, 真) ' 不论是否通过校验都设为真，防止进行借阅前校验时出现误报。


.子程序 _列表框1_获得焦点, 空白型, , 
SetLayeredWindowAttributes (会员校验窗口.取窗口句柄 (), 0, 255, #LWA_ALPHA)

.子程序 _列表框1_失去焦点, 空白型, , 
SetLayeredWindowAttributes (会员校验窗口.取窗口句柄 (), 0, 170, #LWA_ALPHA)


.窗口程序集 查询会员窗口程序集, , , 

.程序集变量 CXM, 整数型, , , 循环记数器
.程序集变量 CXN, 整数型, , , 
.程序集变量 HY标志内容, 文本型, , , 
.程序集变量 HYWB, 文本型, , , abcdef中除(标志内容)以外的字母
.程序集变量 HYWB字母, 文本型, , "0", 存放组成WB的每个字母
.程序集变量 借书数量, 整数型, , , 
.程序集变量 所借书名, 文本型, , , 
.程序集变量 HY编号, 文本型, , , 
.子程序 _查询会员_确定按钮_被单击, 空白型, , 
 ' 这段程序算是软件编写中最让我伤脑筋的地方，我感到自己这样做是比较巧妙的！
置等待鼠标 ()
置当前库 (“tsglhy”) ' 查询功能的基本思路是，在所要查询的数据库内，预先设置一个“查询标志”字段，查询时，按给定的条件向符合条件的记录的查询标志字段内写入 a到f作为标志，再把“并且”、“或者”操作转变为对字母的操作。
到首记录 ()
.计次循环首 (取记录数 (), CXM) ' 清除数据库中可能留有的标记，保确查询的准确性。
    写 (26, “”)
    跳过 (1)
.计次循环尾 ()
.如果真 (等于 (.选中, 真))
    .如果 (等于 (.现行选中项, -1))
        赋值 (提示窗口标题, “提示！”)
        赋值 (提示窗口图标, 4)
        赋值 (提示信息, “请输入完整的查询条件。”)
        载入 (提示窗口, , 真)
        获取焦点 ()
        返回 ()
    .否则
        .如果 (等于 (.内容, “”))
            赋值 (提示窗口标题, “提示！”)
            赋值 (提示窗口图标, 4)
            赋值 (提示信息, “请输入完整的查询条件。”)
            载入 (提示窗口, , 真)
            获取焦点 ()
            返回 ()
        .否则
            .如果真 (等于 (.现行选中项, 0))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (等于 (读 (1), .内容))
                        写 (26, 相加 (读 (26), “a”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 1))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (大于 (寻找文本 (读 (1), .内容, , 假), 0))
                        写 (26, 相加 (读 (26), “a”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 2))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (等于 (寻找文本 (读 (1), .内容, , 假), -1))
                        写 (26, 相加 (读 (26), “a”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            
        .如果结束
        
    .如果结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果 (等于 (.现行选中项, -1))
        赋值 (提示窗口标题, “提示！”)
        赋值 (提示窗口图标, 4)
        赋值 (提示信息, “请输入完整的查询条件。”)
        载入 (提示窗口, , 真)
        获取焦点 ()
        返回 ()
    .否则
        .如果 (等于 (.内容, “”))
            赋值 (提示窗口标题, “提示！”)
            赋值 (提示窗口图标, 4)
            赋值 (提示信息, “请输入完整的查询条件。”)
            载入 (提示窗口, , 真)
            获取焦点 ()
            返回 ()
        .否则
            .如果真 (等于 (.现行选中项, 0))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (等于 (读 (2), .内容))
                        写 (26, 相加 (读 (26), “b”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 1))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (大于 (寻找文本 (读 (2), .内容, , 假), 0))
                        写 (26, 相加 (读 (26), “b”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 2))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (等于 (寻找文本 (读 (2), .内容, , 假), -1))
                        写 (26, 相加 (读 (26), “b”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            
            
        .如果结束
        
    .如果结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果 (等于 (.现行选中项, -1))
        赋值 (提示窗口标题, “提示！”)
        赋值 (提示窗口图标, 4)
        赋值 (提示信息, “请输入完整的查询条件。”)
        载入 (提示窗口, , 真)
        获取焦点 ()
        返回 ()
    .否则
        .如果 (等于 (.内容, “”))
            赋值 (提示窗口标题, “提示！”)
            赋值 (提示窗口图标, 4)
            赋值 (提示信息, “请输入完整的查询条件。”)
            载入 (提示窗口, , 真)
            获取焦点 ()
            返回 ()
        .否则
            .如果真 (等于 (.现行选中项, 0))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (等于 (读 (3), .内容))
                        写 (26, 相加 (读 (26), “c”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 1))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (大于 (寻找文本 (读 (3), .内容, , 假), 0))
                        写 (26, 相加 (读 (26), “c”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 2))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (等于 (寻找文本 (读 (3), .内容, , 假), -1))
                        写 (26, 相加 (读 (26), “c”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            
        .如果结束
        
    .如果结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果 (等于 (.现行选中项, -1))
        赋值 (提示窗口标题, “提示！”)
        赋值 (提示窗口图标, 4)
        赋值 (提示信息, “请输入完整的查询条件。”)
        载入 (提示窗口, , 真)
        获取焦点 ()
        返回 ()
    .否则
        .如果 (等于 (.内容, “”))
            赋值 (提示窗口标题, “提示！”)
            赋值 (提示窗口图标, 4)
            赋值 (提示信息, “请输入完整的查询条件。”)
            载入 (提示窗口, , 真)
            获取焦点 ()
            返回 ()
        .否则
            .如果真 (等于 (.现行选中项, 0))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (等于 (读 (4), .内容))
                        写 (26, 相加 (读 (26), “d”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 1))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (大于 (寻找文本 (读 (4), .内容, , 假), 0))
                        写 (26, 相加 (读 (26), “d”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 2))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .如果真 (等于 (寻找文本 (读 (4), .内容, , 假), -1))
                        写 (26, 相加 (读 (26), “d”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            
            
        .如果结束
        
    .如果结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果 (等于 (.现行选中项, -1))
        赋值 (提示窗口标题, “提示！”)
        赋值 (提示窗口图标, 4)
        赋值 (提示信息, “请输入完整的查询条件。”)
        载入 (提示窗口, , 真)
        获取焦点 ()
        返回 ()
    .否则
        .如果 (等于 (.内容, “”))
            赋值 (提示窗口标题, “提示！”)
            赋值 (提示窗口图标, 4)
            赋值 (提示信息, “请输入完整的查询条件。”)
            载入 (提示窗口, , 真)
            获取焦点 ()
            返回 ()
        .否则
            .如果真 (等于 (.现行选中项, 0))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    赋值 (借书数量, 0)
                    .计次循环首 (10, 循环次数)
                        .如果真 (不等于 (读 (相加 (相乘 (循环次数, 2), 4)), “”))
                            赋值 (借书数量, 相加 (借书数量, 1))
                        .如果真结束
                        
                    .计次循环尾 ()
                    .如果真 (大于 (借书数量, 到数值 (.内容)))
                        写 (26, 相加 (读 (26), “e”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 1))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    赋值 (借书数量, 0)
                    .计次循环首 (10, 循环次数)
                        .如果真 (不等于 (读 (相加 (相乘 (循环次数, 2), 4)), “”))
                            赋值 (借书数量, 相加 (借书数量, 1))
                        .如果真结束
                        
                    .计次循环尾 ()
                    .如果真 (等于 (借书数量, 到数值 (.内容)))
                        写 (26, 相加 (读 (26), “e”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 2))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    赋值 (借书数量, 0)
                    .计次循环首 (10, 循环次数)
                        .如果真 (不等于 (读 (相加 (相乘 (循环次数, 2), 4)), “”))
                            赋值 (借书数量, 相加 (借书数量, 1))
                        .如果真结束
                        
                    .计次循环尾 ()
                    .如果真 (小于 (借书数量, 到数值 (.内容)))
                        写 (26, 相加 (读 (26), “e”))
                    .如果真结束
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            
        .如果结束
        
    .如果结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果 (等于 (.现行选中项, -1))
        赋值 (提示窗口标题, “提示！”)
        赋值 (提示窗口图标, 4)
        赋值 (提示信息, “请输入完整的查询条件。”)
        载入 (提示窗口, , 真)
        获取焦点 ()
        返回 ()
    .否则
        .如果 (等于 (.内容, “”))
            赋值 (提示窗口标题, “提示！”)
            赋值 (提示窗口图标, 4)
            赋值 (提示信息, “请输入完整的查询条件。”)
            载入 (提示窗口, , 真)
            获取焦点 ()
            返回 ()
        .否则
            .如果真 (等于 (.现行选中项, 0))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .计次循环首 (10, 循环次数)
                        .如果真 (等于 (读 (相加 (相乘 (循环次数, 2), 4)), .内容))
                            写 (26, 相加 (读 (26), “f”))
                            跳出循环 ()
                        .如果真结束
                        
                    .计次循环尾 ()
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 1))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .计次循环首 (10, 循环次数)
                        .如果真 (大于 (寻找文本 (读 (相加 (相乘 (循环次数, 2), 4)), .内容, , 假), 0))
                            写 (26, 相加 (读 (26), “f”))
                            跳出循环 ()
                        .如果真结束
                        
                    .计次循环尾 ()
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 2))
                到首记录 ()
                .计次循环首 (取记录数 (), )
                    .计次循环首 (10, 循环次数)
                        .如果真 (等于 (寻找文本 (读 (相加 (相乘 (循环次数, 2), 4)), .内容, , 假), -1))
                            写 (26, 相加 (读 (26), “f”))
                            跳出循环 ()
                        .如果真结束
                        
                    .计次循环尾 ()
                    跳过 (1)
                .计次循环尾 ()
            .如果真结束
            
        .如果结束
        
    .如果结束
    
.如果真结束
.如果 (并且 (等于 (.禁止, 假), 等于 (.现行选中项, -1)))
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示窗口图标, 4)
    赋值 (提示信息, “请输入完整的查询条件。”)
    载入 (提示窗口, , 真)
    获取焦点 ()
    返回 ()
.否则
    .如果 (并且 (等于 (.禁止, 假), 等于 (.现行选中项, -1)))
        赋值 (提示窗口标题, “提示！”)
        赋值 (提示窗口图标, 4)
        赋值 (提示信息, “请输入完整的查询条件。”)
        载入 (提示窗口, , 真)
        获取焦点 ()
        返回 ()
    .否则
        .如果 (并且 (等于 (.禁止, 假), 等于 (.现行选中项, -1)))
            赋值 (提示窗口标题, “提示！”)
            赋值 (提示窗口图标, 4)
            赋值 (提示信息, “请输入完整的查询条件。”)
            载入 (提示窗口, , 真)
            获取焦点 ()
            返回 ()
        .否则
            .如果 (并且 (等于 (.禁止, 假), 等于 (.现行选中项, -1)))
                赋值 (提示窗口标题, “提示！”)
                赋值 (提示窗口图标, 4)
                赋值 (提示信息, “请输入完整的查询条件。”)
                载入 (提示窗口, , 真)
                获取焦点 ()
                返回 ()
            .否则
                .如果 (并且 (等于 (.禁止, 假), 等于 (.现行选中项, -1)))
                    赋值 (提示窗口标题, “提示！”)
                    赋值 (提示窗口图标, 4)
                    赋值 (提示信息, “请输入完整的查询条件。”)
                    载入 (提示窗口, , 真)
                    获取焦点 ()
                    返回 ()
                .否则
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束
.如果 (并且 (取反 (.选中), 取反 (.选中), 取反 (.选中), 取反 (.选中), 取反 (.选中), 取反 (.选中)))
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示窗口图标, 4)
    赋值 (提示信息, “请设置查询条件。”)
    载入 (提示窗口, , 真)
    获取焦点 ()
    返回 ()
.否则
    
.如果结束
载入 (查询会员结果窗口, , 假)
赋值 (HY标志内容, “”) ' 这段程序主要是解决使用“且”选项时的查询问题。
.如果真 (并且 (.选中, 等于 (.现行选中项, 1)))
    赋值 (HY标志内容, “a”)
    .如果 (.选中)
        赋值 (HY标志内容, 相加 (HY标志内容, “b”))
    .否则
        .如果 (.选中)
            赋值 (HY标志内容, 相加 (HY标志内容, “c”))
        .否则
            .如果 (.选中)
                赋值 (HY标志内容, 相加 (HY标志内容, “d”))
            .否则
                .如果 (.选中)
                    赋值 (HY标志内容, 相加 (HY标志内容, “e”))
                .否则
                    .如果 (.选中)
                        赋值 (HY标志内容, 相加 (HY标志内容, “f”))
                    .否则
                        赋值 (HY标志内容, “”)
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果真结束
.如果真 (并且 (.选中, 等于 (.现行选中项, 1)))
    .如果真 (等于 (HY标志内容, “”)) ' 防止（标志内容）有数据时不能向下带入。
        赋值 (HY标志内容, “b”)
    .如果真结束
    .如果 (.选中)
        赋值 (HY标志内容, 相加 (HY标志内容, “c”))
    .否则
        .如果 (.选中)
            赋值 (HY标志内容, 相加 (HY标志内容, “d”))
        .否则
            .如果 (.选中)
                赋值 (HY标志内容, 相加 (HY标志内容, “e”))
            .否则
                .如果 (.选中)
                    赋值 (HY标志内容, 相加 (HY标志内容, “f”))
                .否则
                    赋值 (HY标志内容, “”)
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果真结束
.如果真 (并且 (.选中, 等于 (.现行选中项, 1)))
    .如果真 (等于 (HY标志内容, “”))
        赋值 (HY标志内容, “c”)
    .如果真结束
    .如果 (.选中)
        赋值 (HY标志内容, 相加 (HY标志内容, “d”))
    .否则
        .如果 (.选中)
            赋值 (HY标志内容, 相加 (HY标志内容, “e”))
        .否则
            .如果 (.选中)
                赋值 (HY标志内容, 相加 (HY标志内容, “f”))
            .否则
                赋值 (HY标志内容, “”)
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果真结束
.如果真 (并且 (.选中, 等于 (.现行选中项, 1)))
    .如果真 (等于 (HY标志内容, “”))
        赋值 (HY标志内容, “d”)
    .如果真结束
    .如果 (.选中)
        赋值 (HY标志内容, 相加 (HY标志内容, “e”))
    .否则
        .如果 (.选中)
            赋值 (HY标志内容, 相加 (HY标志内容, “f”))
        .否则
            赋值 (HY标志内容, “”)
        .如果结束
        
    .如果结束
    
.如果真结束
.如果真 (并且 (.选中, 等于 (.现行选中项, 1)))
    .如果真 (等于 (HY标志内容, “”))
        赋值 (HY标志内容, “e”)
    .如果真结束
    .如果 (.选中)
        赋值 (HY标志内容, 相加 (HY标志内容, “f”))
    .否则
        赋值 (HY标志内容, “”) ' “且”选项查询程序结束。
    .如果结束
    
.如果真结束
.如果 (置当前库 (“tsglhycx”))
    清空 ()
.否则
    赋值 (提示窗口标题, “错误！”)
    赋值 (提示窗口图标, 1)
    赋值 (提示信息, “设置数据库 tsglhycx.edb 时出现错误，查询失败！”)
    载入 (提示窗口, , 真)
    查询会员窗口.销毁 ()
.如果结束
.如果真 (等于 (HY标志内容, “”)) ' 防止（标志内容）为空时出现查找错误。
    赋值 (HY标志内容, “0”)
.如果真结束
添加 (“tsglhy”, 大于 (寻找文本 (读 (26), HY标志内容, , 假), 0), ) ' 把所有符合“且”运算条件的记录添加到stglhycx.edb数据库
赋值 (HYWB, “abcdef”)
.计次循环首 (取文本长度 (HY标志内容), CXM) ' 这个循环是为了把已经参与过“且”运算的字段排除
    赋值 (HYWB, 子文本替换 (HYWB, 取文本中间 (HY标志内容, CXM, 1), “”, , , 真))
.计次循环尾 ()
重定义数组 (HYWB字母, 假, 6)
连续赋值 (“IOWEIOEWWEWERE”, HYWB字母 [1], HYWB字母 [2], HYWB字母 [3], HYWB字母 [4], HYWB字母 [5], HYWB字母 [6]) ' 字符串是任意的,目的是为了防止出现空
.计次循环首 (取文本长度 (HYWB), 循环次数)
    赋值 (HYWB字母 [循环次数], 取文本中间 (HYWB, 循环次数, 1))
.计次循环尾 ()
添加 (“tsglhy”, 或者 (大于 (寻找文本 (读 (26), HYWB字母 [1], , 假), 0), 大于 (寻找文本 (读 (26), HYWB字母 [2], , 假), 0), 大于 (寻找文本 (读 (26), HYWB字母 [3], , 假), 0), 大于 (寻找文本 (读 (26), HYWB字母 [4], , 假), 0), 大于 (寻找文本 (读 (26), HYWB字母 [5], , 假), 0), 大于 (寻找文本 (读 (26), HYWB字母 [6], , 假), 0)), ) ' 把所有符合“或”运算条件的记录添加到tsglhycx.edb数据库
置当前库 (“tsglhycx”)
到首记录 ()
.计次循环首 (取记录数 (), ) ' 删除可能出现的重复记录,因为当查询条件中同时出现“并且”和“或者”条件时，当一个记录同时满足这两个条件时，就会出现重复
    赋值 (HY编号, 读 (1))
    .如果真 (大于 (计算数目 (等于 (读 (1), HY编号)), 1))
        删除 ()
        彻底删除 ()
    .如果真结束
    跳过 (1)
.计次循环尾 ()
.计次循环首 (查询会员结果窗口.., )
    查询会员结果窗口.未知支持库函数_36 (., 0)
.计次循环尾 ()
.计次循环首 (查询会员结果窗口.., )
    查询会员结果窗口.未知支持库函数_37 (., 0)
.计次循环尾 ()
到首记录 ()
赋值 (查询会员结果窗口.., 相加 (取记录数 (), 1))
赋值 (查询会员结果窗口.., 8)
查询会员结果窗口.未知支持库函数_25 (., 0, 0, 0, 查询会员结果窗口.., 2)
查询会员结果窗口.未知支持库函数_25 (., 1, 0, 查询会员结果窗口.., 0, 2)
查询会员结果窗口.未知支持库函数_32 (., 0, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L0”, “50”)))
查询会员结果窗口.未知支持库函数_32 (., 1, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L1”, “90”)))
查询会员结果窗口.未知支持库函数_32 (., 2, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L2”, “110”)))
查询会员结果窗口.未知支持库函数_32 (., 3, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L3”, “200”)))
查询会员结果窗口.未知支持库函数_32 (., 4, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L4”, “120”)))
查询会员结果窗口.未知支持库函数_32 (., 5, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L5”, “70”)))
查询会员结果窗口.未知支持库函数_32 (., 6, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L6”, “90”)))
查询会员结果窗口.未知支持库函数_32 (., 7, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L7”, “500”)))

查询会员结果窗口.未知支持库函数_30 (., 5, 5)
查询会员结果窗口.未知支持库函数_9 (., 0, 0, 1, “序号”)
赋值 (查询会员结果窗口.., 1)
赋值 (查询会员结果窗口.., 1)
查询会员结果窗口.未知支持库函数_9 (., 0, 1, 1, “借书证编号”)
查询会员结果窗口.未知支持库函数_9 (., 0, 2, 1, “会员姓名”)
查询会员结果窗口.未知支持库函数_9 (., 0, 3, 1, “单      位”)
查询会员结果窗口.未知支持库函数_9 (., 0, 4, 1, “电话号码”)
查询会员结果窗口.未知支持库函数_9 (., 0, 5, 1, “VIP”)
查询会员结果窗口.未知支持库函数_9 (., 0, 6, 1, “借阅数量(本)”)
查询会员结果窗口.未知支持库函数_9 (., 0, 7, 1, “所借图书”)
.计次循环首 (取记录数 (), CXM)
    查询会员结果窗口.未知支持库函数_9 (., CXM, 0, 1, 数值到格式文本 (CXM, 0, 假))
    .计次循环首 (7, CXN)
        .如果真 (小于 (CXN, 6))
            查询会员结果窗口.未知支持库函数_9 (., CXM, CXN, 1, 读 (CXN))
        .如果真结束
        .如果真 (等于 (CXN, 6))
            赋值 (借书数量, 0)
            .计次循环首 (10, 循环次数)
                .如果真 (不等于 (读 (相加 (相乘 (循环次数, 2), 4)), “”))
                    赋值 (借书数量, 相加 (借书数量, 1))
                .如果真结束
                
            .计次循环尾 ()
            查询会员结果窗口.未知支持库函数_9 (., CXM, CXN, 1, 数值到格式文本 (借书数量, 0, 假))
        .如果真结束
        .如果真 (等于 (CXN, 7))
            赋值 (所借书名, “”)
            .计次循环首 (10, 循环次数)
                .如果真 (不等于 (读 (相加 (相乘 (循环次数, 2), 4)), “”))
                    赋值 (所借书名, 相加 (所借书名, “《”, 读 (相加 (相乘 (循环次数, 2), 4)), “》”))
                .如果真结束
                
            .计次循环尾 ()
            查询会员结果窗口.未知支持库函数_9 (., CXM, CXN, 1, 所借书名)
        .如果真结束
        
    .计次循环尾 ()
    跳过 (1)
.计次循环尾 ()
恢复鼠标 ()

.子程序 _查询会员窗口_创建完毕, 空白型, , 
获取焦点 ()
连续赋值 (真, .禁止, .禁止, .禁止, .禁止, .禁止)

.子程序 _查询会员_取消按钮_被单击, 空白型, , 
查询会员窗口.销毁 ()
赋值 (主窗口.., -1)

.子程序 _选择框1_失去焦点, 空白型, , 
.如果真 (取反 (.选中))
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
    赋值 (.现行选中项, -1)
.如果真结束


.子程序 _选择框2_失去焦点, 空白型, , 
.如果真 (取反 (.选中))
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
    赋值 (.现行选中项, -1)
.如果真结束


.子程序 _选择框3_失去焦点, 空白型, , 
.如果真 (取反 (.选中))
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
    赋值 (.现行选中项, -1)
.如果真结束


.子程序 _选择框4_失去焦点, 空白型, , 
.如果真 (取反 (.选中))
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
    赋值 (.现行选中项, -1)
.如果真结束


.子程序 _选择框5_失去焦点, 空白型, , 
.如果真 (取反 (.选中))
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
    赋值 (.现行选中项, -1)
.如果真结束


.子程序 _选择框6_失去焦点, 空白型, , 
.如果真 (取反 (.选中))
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
.如果真结束


.子程序 _选择框1_被单击, 空白型, , 
.如果真 (或者 (.选中, .选中, .选中, .选中, .选中))
    赋值 (.禁止, 假) ' 此条程序为确保当用户由下向上设置查询条件时，右列相应组合框的禁止属性不能及时关闭（下同）。
.如果真结束
调整各控件状态子程序 ()


.子程序 _选择框2_被单击, 空白型, , 
.如果真 (.选中) ' 此条程序确保当其下一条件被设置时，其右侧组合框应处于可设置状态（下同）。
    赋值 (.禁止, 假)
.如果真结束
.如果真 (或者 (.选中, .选中, .选中, .选中))
    赋值 (.禁止, 假)
.如果真结束
调整各控件状态子程序 ()


.子程序 _选择框3_被单击, 空白型, , 
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (或者 (.选中, .选中, .选中))
    赋值 (.禁止, 假)
.如果真结束
调整各控件状态子程序 ()


.子程序 _选择框4_被单击, 空白型, , 
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (或者 (.选中, .选中))
    赋值 (.禁止, 假)
.如果真结束
调整各控件状态子程序 ()


.子程序 _选择框5_被单击, 空白型, , 
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
调整各控件状态子程序 ()


.子程序 _选择框6_被单击, 空白型, , 
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
调整各控件状态子程序 ()


.子程序 调整各控件状态子程序, 逻辑型, , 
.如果真 (取反 (.选中)) ' 此段程序确保当项目未选中时，其右侧组合框为不可用，当其后没有项目被选择时，其右侧组合框也不可用。
    赋值 (.现行选中项, -1)
    赋值 (.禁止, 真)
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
.如果真结束
.如果真 (取反 (.选中))
    赋值 (.现行选中项, -1)
    赋值 (.禁止, 真)
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
.如果真结束
.如果真 (取反 (.选中))
    赋值 (.现行选中项, -1)
    赋值 (.禁止, 真)
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
.如果真结束
.如果真 (取反 (.选中))
    赋值 (.现行选中项, -1)
    赋值 (.禁止, 真)
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
.如果真结束
.如果真 (取反 (.选中))
    赋值 (.现行选中项, -1)
    赋值 (.禁止, 真)
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
.如果真结束
.如果真 (取反 (.选中))
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
.如果真结束
.如果真 (并且 (取反 (.选中), 取反 (.选中), 取反 (.选中), 取反 (.选中), 取反 (.选中)))
    赋值 (.禁止, 真)
    赋值 (.现行选中项, -1)
.如果真结束
.如果真 (并且 (取反 (.选中), 取反 (.选中), 取反 (.选中), 取反 (.选中)))
    赋值 (.禁止, 真)
    赋值 (.现行选中项, -1)
.如果真结束
.如果真 (并且 (取反 (.选中), 取反 (.选中), 取反 (.选中)))
    赋值 (.禁止, 真)
    赋值 (.现行选中项, -1)
.如果真结束
.如果真 (并且 (取反 (.选中), 取反 (.选中)))
    赋值 (.禁止, 真)
    赋值 (.现行选中项, -1)
.如果真结束
.如果真 (取反 (.选中))
    赋值 (.禁止, 真)
    赋值 (.现行选中项, -1)
.如果真结束
返回 (真)

.子程序 _组合框1_列表项被选择, 空白型, , 
赋值 (.选中, 真)
获取焦点 ()
调整各控件状态子程序 ()

.子程序 _组合框2_列表项被选择, 空白型, , 
赋值 (.选中, 真)
获取焦点 ()
调整各控件状态子程序 ()

.子程序 _组合框3_列表项被选择, 空白型, , 
赋值 (.选中, 真)
获取焦点 ()
调整各控件状态子程序 ()

.子程序 _组合框4_列表项被选择, 空白型, , 
赋值 (.选中, 真)
获取焦点 ()
调整各控件状态子程序 ()

.子程序 _组合框5_列表项被选择, 空白型, , 
赋值 (.选中, 真)
获取焦点 ()
调整各控件状态子程序 ()

.子程序 _组合框6_列表项被选择, 空白型, , 
赋值 (.选中, 真)
获取焦点 ()

.子程序 _编辑框1_获得焦点, 空白型, , 
赋值 (.选中, 真)
调整各控件状态子程序 ()
.如果真 (或者 (.选中, .选中, .选中, .选中, .选中))
    赋值 (.禁止, 假) ' 此条程序为确保当用户由下向上设置查询条件时，右列相应组合框的禁止属性不能及时关闭（下同）。
.如果真结束


.子程序 _编辑框2_获得焦点, 空白型, , 
赋值 (.选中, 真)
调整各控件状态子程序 ()
.如果真 (.选中) ' 此条程序确保当其下一条件被设置时，其右侧组合框应处于可设置状态（下同）。
    赋值 (.禁止, 假)
.如果真结束
.如果真 (或者 (.选中, .选中, .选中, .选中))
    赋值 (.禁止, 假)
.如果真结束


.子程序 _编辑框3_获得焦点, 空白型, , 
赋值 (.选中, 真)
调整各控件状态子程序 ()
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (或者 (.选中, .选中, .选中))
    赋值 (.禁止, 假)
.如果真结束


.子程序 _编辑框4_获得焦点, 空白型, , 
赋值 (.选中, 真)
调整各控件状态子程序 ()
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (或者 (.选中, .选中))
    赋值 (.禁止, 假)
.如果真结束


.子程序 _编辑框5_获得焦点, 空白型, , 
赋值 (.选中, 真)
调整各控件状态子程序 ()
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束


.子程序 _编辑框6_获得焦点, 空白型, , 
赋值 (.选中, 真)
调整各控件状态子程序 ()
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (.选中)
    赋值 (.禁止, 假)
.如果真结束


.子程序 _按钮1_被单击, 空白型, , 
到首记录 ()
赋值 (查询会员结果窗口.., 相加 (取记录数 (), 1))
赋值 (查询会员结果窗口.., 8)
查询会员结果窗口.未知支持库函数_25 (., 0, 0, 0, 查询会员结果窗口.., 2)
查询会员结果窗口.未知支持库函数_25 (., 1, 0, 查询会员结果窗口.., 0, 2)
查询会员结果窗口.未知支持库函数_32 (., 0, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L0”, “50”)))
查询会员结果窗口.未知支持库函数_32 (., 1, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L1”, “90”)))
查询会员结果窗口.未知支持库函数_32 (., 2, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L2”, “110”)))
查询会员结果窗口.未知支持库函数_32 (., 3, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L3”, “200”)))
查询会员结果窗口.未知支持库函数_32 (., 4, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L4”, “120”)))
查询会员结果窗口.未知支持库函数_32 (., 5, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L5”, “70”)))
查询会员结果窗口.未知支持库函数_32 (., 6, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L6”, “90”)))
查询会员结果窗口.未知支持库函数_32 (., 7, 到数值 (读配置项 (相加 (运行目录, “\tsglsoft.ini”), “会员表格参数”, “L7”, “500”)))

查询会员结果窗口.未知支持库函数_30 (., 5, 5)
查询会员结果窗口.未知支持库函数_9 (., 0, 0, 1, “序号”)
赋值 (查询会员结果窗口.., 1)
赋值 (查询会员结果窗口.., 1)
查询会员结果窗口.未知支持库函数_9 (., 0, 1, 1, “借书证编号”)
查询会员结果窗口.未知支持库函数_9 (., 0, 2, 1, “会员姓名”)
查询会员结果窗口.未知支持库函数_9 (., 0, 3, 1, “单      位”)
查询会员结果窗口.未知支持库函数_9 (., 0, 4, 1, “电话号码”)
查询会员结果窗口.未知支持库函数_9 (., 0, 5, 1, “VIP”)
查询会员结果窗口.未知支持库函数_9 (., 0, 6, 1, “借阅数量(本)”)
查询会员结果窗口.未知支持库函数_9 (., 0, 7, 1, “所借图书”)
.计次循环首 (取记录数 (), CXM)
    查询会员结果窗口.未知支持库函数_9 (., CXM, 0, 1, 数值到格式文本 (CXM, 0, 假))
    .计次循环首 (7, CXN)
        .如果真 (小于 (CXN, 6))
            查询会员结果窗口.未知支持库函数_9 (., CXM, CXN, 1, 读 (CXN))
        .如果真结束
        .如果真 (等于 (CXN, 6))
            赋值 (借书数量, 0)
            .计次循环首 (10, 循环次数)
                .如果真 (不等于 (读 (相加 (相乘 (循环次数, 2), 4)), “”))
                    赋值 (借书数量, 相加 (借书数量, 1))
                .如果真结束
                
            .计次循环尾 ()
            查询会员结果窗口.未知支持库函数_9 (., CXM, CXN, 1, 数值到格式文本 (借书数量, 0, 假))
        .如果真结束
        .如果真 (等于 (CXN, 7))
            赋值 (所借书名, “”)
            .计次循环首 (10, 循环次数)
                .如果真 (不等于 (读 (相加 (相乘 (循环次数, 2), 4)), “”))
                    赋值 (所借书名, 相加 (所借书名, “《”, 读 (相加 (相乘 (循环次数, 2), 4)), “》”))
                .如果真结束
                
            .计次循环尾 ()
            查询会员结果窗口.未知支持库函数_9 (., CXM, CXN, 1, 所借书名)
        .如果真结束
        
    .计次循环尾 ()
    跳过 (1)
.计次循环尾 ()


.窗口程序集 用户管理窗口程序集, , , 

.子程序 _用户管理窗口_创建完毕, 空白型, , 
置当前库 (“yhgl”)
到首记录 ()
.计次循环首 (取记录数 (), )
    .如果真 (取反 (读 (3))) ' 不显示超级用户
        读 (1).加入项目 ()
    .如果真结束
    跳过 (1)
.计次循环尾 ()


.子程序 _用户管理_取消按钮_被单击, 空白型, , 
用户管理窗口.销毁 ()
赋值 (主窗口.., -1)


.子程序 _用户管理_添加按钮_被单击, 空白型, , 
载入 (添加用户窗口, , 真)

.子程序 _用户管理_删除按钮_被单击, 空白型, , 
.局部变量 YHGL_M, 整数型, , , 循环变量
.局部变量 YHGL_N, 整数型, , , 选中项目数
.局部变量 用户, 文本型, , , 

赋值 (YHGL_N, 0)
赋值 (用户, “”)
.计次循环首 (取项目数 (), YHGL_M)
    .如果真 (相减 (YHGL_M, 1).是否被选中 ())
        赋值 (YHGL_N, 相加 (YHGL_N, 1))
        赋值 (用户, 相加 (用户, #左引号, 相减 (YHGL_M, 1).取项目文本 (), #右引号))
    .如果真结束
    
.计次循环尾 ()
.如果真 (等于 (YHGL_N, 0))
    赋值 (提示窗口图标, 4)
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示信息, “请选择要删除的用户，方法是：在要删除的用户前打的方框内打√。”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口标题, “”)
    赋值 (提示信息, “”)
    返回 ()
.如果真结束
赋值 (提示窗口图标, 3)
赋值 (提示窗口标题, “确认！”)
赋值 (提示窗口按钮数, 2)
赋值 (提示信息, 相加 (“确定要删除”, 用户, 数值到格式文本 (YHGL_N, , 假), “个用户吗？”))
载入 (提示窗口, , 真)
赋值 (提示窗口图标, 0)
赋值 (提示窗口按钮数, 0)
赋值 (提示窗口标题, “”)
赋值 (提示信息, “”)
.如果真 (等于 (提示窗口返回值, 1))
    赋值 (提示窗口返回值, 0)
    置当前库 (“yhgl”)
    .计次循环首 (取项目数 (), YHGL_M)
        .如果真 (相减 (YHGL_M, 1).是否被选中 ())
            到首记录 ()
            查找 (等于 (读 (1), 相减 (YHGL_M, 1).取项目文本 ()))
            删除 ()
            彻底删除 ()
        .如果真结束
        
    .计次循环尾 ()
    清空 ()
    .计次循环首 (取记录数 (), )
        .如果真 (取反 (读 (3))) ' 不显示超级用户
            读 (1).加入项目 ()
        .如果真结束
        跳过 (1)
    .计次循环尾 ()
    置当前库 (“tsglzz”)
    加记录 (取现行时间 (), 操作者, 相加 (“删除”, 用户))
    赋值 (提示窗口图标, 4)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示窗口标题, “恭喜！”)
    赋值 (提示信息, “删除成功！”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口标题, “”)
    赋值 (提示信息, “”)
    赋值 (提示窗口按钮数, 0)
.如果真结束


.窗口程序集 添加用户窗口程序集, , , 

.子程序 _添加用户_取消按钮_被单击, 空白型, , 
添加用户窗口.销毁 ()

.子程序 _添加用户_确定按钮_被单击, 空白型, , 
置当前库 (“yhgl”)
到首记录 ()
.如果 (等于 (.内容, “”))
    赋值 (提示窗口图标, 4)
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示信息, “请输入一个用户名！”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口标题, “”)
    赋值 (提示信息, “”)
    获取焦点 ()
    返回 ()
.否则
    .如果真 (查找 (等于 (读 (1), .内容)))
        赋值 (提示窗口图标, 2)
        赋值 (提示窗口标题, “用户名已经使用！”)
        赋值 (提示信息, 相加 (.内容, “ 已经存在！请重新输入一个用户名！”))
        载入 (提示窗口, , 真)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口标题, “”)
        赋值 (提示信息, “”)
        获取焦点 ()
        赋值 (.被选择字符数, -1)
        返回 ()
    .如果真结束
    
.如果结束
.如果真 (等于 (.内容, “”))
    赋值 (提示窗口图标, 4)
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示信息, “密码不能为空！”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口标题, “”)
    赋值 (提示信息, “”)
    获取焦点 ()
    返回 ()
.如果真结束
用户管理窗口.加入项目 (., .内容, )
置当前库 (“yhgl”)
.如果 (加记录 (.内容, .内容))
    赋值 (提示窗口图标, 4)
    赋值 (提示窗口标题, “恭喜！”)
    赋值 (提示信息, “添加成功！”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口标题, “”)
    赋值 (提示信息, “”)
    置当前库 (“tsglzz”)
    加记录 (取现行时间 (), 操作者, 相加 (“添加用户：”, .内容))
.否则
    赋值 (提示窗口图标, 4)
    赋值 (提示窗口标题, “抱歉！”)
    赋值 (提示信息, “添加失败！您可以稍后重试。”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口标题, “”)
    赋值 (提示信息, “”)
.如果结束
添加用户窗口.销毁 ()

.子程序 _添加用户窗口_创建完毕, 空白型, , 
置当前库 (“yhgl”)
到首记录 ()

.窗口程序集 修改密码窗口程序集, , , 

.子程序 _修改密码_确定按钮_被单击, 空白型, , 
置当前库 (“yhgl”)
到首记录 ()
.如果真 (等于 (.内容, “”))
    赋值 (提示窗口图标, 2)
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示信息, “请输入旧密码！”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口标题, “”)
    赋值 (提示信息, “”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (提示窗口图标, 2)
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示信息, “请输入新密码！”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口标题, “”)
    赋值 (提示信息, “”)
    获取焦点 ()
    赋值 (.被选择字符数, -1)
    返回 ()
.如果真结束
.如果真 (不等于 (.内容, .内容))
    赋值 (提示窗口图标, 2)
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示信息, “ 两次输入的密码不一致！”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口标题, “”)
    赋值 (提示信息, “”)
    获取焦点 ()
    赋值 (.被选择字符数, -1)
    返回 ()
.如果真结束
查找 (等于 (读 (1), 操作者))
.如果真 (不等于 (读 (2), .内容))
    赋值 (提示窗口图标, 2)
    赋值 (提示窗口标题, “错误！”)
    赋值 (提示信息, “ 您输入的旧密码不正确！”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口标题, “”)
    赋值 (提示信息, “”)
    获取焦点 ()
    赋值 (.被选择字符数, -1)
    返回 ()
.如果真结束
到首记录 ()
查找 (等于 (读 (1), 操作者))
.如果 (修改 (.内容))
    置当前库 (“tsglzz”)
    加记录 (取现行时间 (), 操作者, “修改密码成功。”)
    赋值 (提示窗口图标, 4)
    赋值 (提示窗口标题, “恭喜！”)
    赋值 (提示信息, “ 密码修改成功！”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口标题, “”)
    赋值 (提示信息, “”)
.否则
    赋值 (提示窗口图标, 2)
    赋值 (提示窗口标题, “抱歉！”)
    赋值 (提示信息, “ 密码修改失败！您可以稍候重试。”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口标题, “”)
    赋值 (提示信息, “”)
.如果结束
修改密码窗口.销毁 ()
赋值 (主窗口.., -1)

.子程序 _编辑框2_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
    赋值 (.被选择字符数, -1)
.如果真结束


.子程序 _编辑框3_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _修改密码_确定按钮_被单击 ()
.如果真结束


.子程序 _修改密码_取消按钮_被单击, 空白型, , 
修改密码窗口.销毁 ()
赋值 (主窗口.., -1)

.子程序 _修改密码窗口_创建完毕, 空白型, , 
置当前库 (“yhgl”)
到首记录 ()

.子程序 _编辑框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
    赋值 (.被选择字符数, -1)
.如果真结束


.窗口程序集 用户更名窗口程序集, , , 

.子程序 _用户更名_取消按钮_被单击, 空白型, , 
用户更名窗口.销毁 ()
赋值 (主窗口.., -1)


.子程序 _用户更名窗口_创建完毕, 空白型, , 
置当前库 (“yhgl”)
到首记录 ()

.子程序 _用户更名_确定按钮_被单击, 空白型, , 
置当前库 (“yhgl”)
到首记录 ()
.如果真 (等于 (.内容, “”))
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示窗口图标, 4)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, “请输入要更改的名字！”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (查找 (等于 (读 (1), .内容)))
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示窗口图标, 4)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, 相加 (“用户名：”, #左引号, .内容, #右引号, “已经存在！”))
    载入 (提示窗口, , 真)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    获取焦点 ()
    赋值 (.被选择字符数, -1)
    返回 ()
.如果真结束
查找 (等于 (读 (1), 操作者))
修改 (.内容)
置当前库 (“tsglzz”)
加记录 (取现行时间 (), 操作者, 相加 (“将用户名更改为：”, .内容))
赋值 (提示窗口标题, “恭喜！”)
赋值 (提示窗口图标, 4)
赋值 (提示窗口按钮数, 1)
赋值 (提示信息, “用户名更改成功！”)
载入 (提示窗口, , 真)
赋值 (提示窗口标题, “”)
赋值 (提示窗口图标, 0)
赋值 (提示窗口按钮数, 0)
赋值 (提示信息, “”)
赋值 (操作者, .内容)
.如果真 (是否注册)
    赋值 (主窗口..内容, 相加 (软件名称, “      使用权归 ”, 使用单位, “ 所有          操作员：”, 操作者))
.如果真结束
用户更名窗口.销毁 ()
赋值 (主窗口.., -1)


.子程序 _编辑框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _用户更名_确定按钮_被单击 ()
.如果真结束


.窗口程序集 查看密码窗口程序集, , , 

.子程序 _查看密码_取消按钮_被单击, 空白型, , 
查看密码窗口.销毁 ()
赋值 (主窗口.., -1)

.子程序 _查看密码窗口_创建完毕, 空白型, , 
置当前库 (“yhgl”)
到首记录 ()

.子程序 _编辑框1_内容被改变, 空白型, , 
置当前库 (“yhgl”)
到首记录 ()
赋值 (.内容, “”)
.如果真 (查找 (等于 (读 (1), .内容)))
    赋值 (.内容, 读 (2))
    置当前库 (“tsglzz”)
    加记录 (取现行时间 (), 操作者, 相加 (“查看”, #左引号, .内容, #右引号, “的密码！”))
.如果真结束


.子程序 _编辑框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _查看密码_取消按钮_被单击 ()
.如果真结束


.窗口程序集 恢复窗口程序集, , , 

.子程序 _恢复窗口_创建完毕, 空白型, , 
赋值 (.内容, 操作者)
置当前库 (“yhgl”)

.子程序 _编辑框1_内容被改变, 空白型, , 
到首记录 ()
查找 (等于 (读 (1), 操作者))
.如果真 (等于 (读 (2), .内容))
    赋值 (主窗口., 真)
    赋值 (主窗口..可视, 假)
    恢复窗口.销毁 ()
.如果真结束



.窗口程序集 打印借书证窗口程序集, , , 

.子程序 _打印借书证窗口_创建完毕, 空白型, , 
赋值 (.禁止, 取反 (是否注册))
置当前库 (“tsglhy”)
到首记录 ()
连续赋值 (真, .禁止, .禁止)
赋值 (.标题, 读 (2))
赋值 (.标题, 读 (3))
赋值 (.标题, 读 (1))
赋值 (.标题, 相加 (数值到格式文本 (取年份 (读 (“办证时间”)), , 假), “-”, 数值到格式文本 (取月份 (读 (“办证时间”)), , 假), “-”, 数值到格式文本 (取日 (读 (“办证时间”)), , 假)))

.子程序 _打印借书证_取消按钮_被单击, 空白型, , 
打印借书证窗口.销毁 ()
赋值 (主窗口.., -1)

.子程序 _打印借书证_打印按钮_被单击, 空白型, , 
.局部变量 记录号1, 整数型, , , 
.局部变量 记录号2, 整数型, , , 
.局部变量 DYJSZ_M, 整数型, , , 
.局部变量 DYJSZ_N, 整数型, , , 
.局部变量 打印个数, 整数型, , , 

置当前库 (“tsglhy”)
.如果真 (.选中)
    到首记录 ()
    .如果 (查找 (等于 (读 (1), .内容)))
        赋值 (记录号1, 取记录号 ())
    .否则
        赋值 (提示窗口标题, “未找到！”)
        赋值 (提示窗口图标, 2)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, 相加 (“没有找到编号为 ”, .内容, “ 的记录！”))
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        打印借书证窗口.获取焦点 (.)
        赋值 (打印借书证窗口..被选择字符数, -1)
        返回 ()
    .如果结束
    到首记录 ()
    .如果 (查找 (等于 (读 (1), .内容)))
        赋值 (记录号2, 取记录号 ())
    .否则
        赋值 (提示窗口标题, “未找到！”)
        赋值 (提示窗口图标, 2)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, 相加 (“没有找到编号为 ”, .内容, “ 的记录！”))
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        打印借书证窗口.获取焦点 (.)
        赋值 (打印借书证窗口..被选择字符数, -1)
        返回 ()
    .如果结束
    
.如果真结束
赋值 (.打印作业名, “打印借书证”)
真.开始打印 (真, , , , )
赋值 (DYJSZ_M, 0)
赋值 (DYJSZ_N, 0)
到首记录 ()
.如果 (.选中)
    .判断循环首 (取反 (尾记录后 ()))
        .判断循环首 (小于 (相乘 (DYJSZ_N, 700), .打印区高度))
            .判断循环首 (小于 (相乘 (DYJSZ_M, 1000), .打印区宽度))
                相加 (.左边空, 相乘 (DYJSZ_M, 相加 (900, 100))).画矩形 (相加 (.顶边空, 相乘 (DYJSZ_N, 相加 (600, 100))), 相加 (.左边空, 相乘 (DYJSZ_M, 相加 (900, 100)), 900), 相加 (.顶边空, 相乘 (DYJSZ_N, 相加 (600, 100)), 600))
                赋值 (.字体.字体名称, “宋体”)
                赋值 (.字体.字体大小, 22)
                相加 (.左边空, 相乘 (DYJSZ_M, 相加 (900, 100)), 260).定位写出 (相加 (.顶边空, 相乘 (DYJSZ_N, 相加 (600, 100)), 90), “借  书  证”)
                赋值 (.字体.字体名称, “楷体_GB2312”)
                赋值 (.字体.字体大小, 16)
                相加 (.左边空, 相乘 (DYJSZ_M, 相加 (900, 100)), 100).定位写出 (相加 (.顶边空, 相乘 (DYJSZ_N, 相加 (600, 100)), 240), 相加 (“姓    名：”, 读 (2)))
                相加 (.左边空, 相乘 (DYJSZ_M, 相加 (900, 100)), 100).定位写出 (相加 (.顶边空, 相乘 (DYJSZ_N, 相加 (600, 100)), 320), 相加 (“单    位：”, 读 (3)))
                相加 (.左边空, 相乘 (DYJSZ_M, 相加 (900, 100)), 100).定位写出 (相加 (.顶边空, 相乘 (DYJSZ_N, 相加 (600, 100)), 400), 相加 (“编    号：”, 读 (1)))
                相加 (.左边空, 相乘 (DYJSZ_M, 相加 (900, 100)), 100).定位写出 (相加 (.顶边空, 相乘 (DYJSZ_N, 相加 (600, 100)), 480), 相加 (“办证时间：”, 数值到格式文本 (取年份 (读 (“办证时间”)), , 假), “-”, 数值到格式文本 (取月份 (读 (“办证时间”)), , 假), “-”, 数值到格式文本 (取日 (读 (“办证时间”)), , 假)))
                赋值 (DYJSZ_M, 相加 (DYJSZ_M, 1))
                跳过 (1)
            .判断循环尾 ()
            赋值 (DYJSZ_M, 0)
            赋值 (DYJSZ_N, 相加 (DYJSZ_N, 1))
        .判断循环尾 ()
        换页 ()
        赋值 (DYJSZ_M, 0)
        赋值 (DYJSZ_N, 0)
    .判断循环尾 ()
    结束打印 ()
.否则
    赋值 (打印个数, 相加 (取绝对值 (相减 (记录号1, 记录号2)), 1))
    查找 (等于 (读 (1), .内容))
    .判断循环首 (不等于 (打印个数, 0))
        .判断循环首 (并且 (小于 (相乘 (DYJSZ_N, 700), .打印区高度), 不等于 (打印个数, 0)))
            .判断循环首 (并且 (小于 (相乘 (DYJSZ_M, 1000), .打印区宽度), 不等于 (打印个数, 0)))
                相加 (.左边空, 相乘 (DYJSZ_M, 相加 (900, 100))).画矩形 (相加 (.顶边空, 相乘 (DYJSZ_N, 相加 (600, 100))), 相加 (.左边空, 相乘 (DYJSZ_M, 相加 (900, 100)), 900), 相加 (.顶边空, 相乘 (DYJSZ_N, 相加 (600, 100)), 600))
                赋值 (.字体.字体名称, “宋体”)
                赋值 (.字体.字体大小, 22)
                相加 (.左边空, 相乘 (DYJSZ_M, 相加 (900, 100)), 260).定位写出 (相加 (.顶边空, 相乘 (DYJSZ_N, 相加 (600, 100)), 90), “借  书  证”)
                赋值 (.字体.字体名称, “楷体_GB2312”)
                赋值 (.字体.字体大小, 16)
                相加 (.左边空, 相乘 (DYJSZ_M, 相加 (900, 100)), 100).定位写出 (相加 (.顶边空, 相乘 (DYJSZ_N, 相加 (600, 100)), 240), 相加 (“姓    名：”, 读 (2)))
                相加 (.左边空, 相乘 (DYJSZ_M, 相加 (900, 100)), 100).定位写出 (相加 (.顶边空, 相乘 (DYJSZ_N, 相加 (600, 100)), 320), 相加 (“单    位：”, 读 (3)))
                相加 (.左边空, 相乘 (DYJSZ_M, 相加 (900, 100)), 100).定位写出 (相加 (.顶边空, 相乘 (DYJSZ_N, 相加 (600, 100)), 400), 相加 (“编    号：”, 读 (1)))
                相加 (.左边空, 相乘 (DYJSZ_M, 相加 (900, 100)), 100).定位写出 (相加 (.顶边空, 相乘 (DYJSZ_N, 相加 (600, 100)), 480), 相加 (“办证时间：”, .标题))
                赋值 (DYJSZ_M, 相加 (DYJSZ_M, 1))
                .如果 (小于 (记录号1, 记录号2))
                    跳过 (1)
                .否则
                    跳过 (-1)
                .如果结束
                赋值 (打印个数, 相减 (打印个数, 1))
            .判断循环尾 ()
            赋值 (DYJSZ_M, 0)
            赋值 (DYJSZ_N, 相加 (DYJSZ_N, 1))
        .判断循环尾 ()
        换页 ()
        赋值 (DYJSZ_M, 0)
        赋值 (DYJSZ_N, 0)
    .判断循环尾 ()
    结束打印 ()
.如果结束


.子程序 _单选框2_被单击, 空白型, , 
置当前库 (“tsglyh”)
到首记录 ()
连续赋值 (假, .禁止, .禁止)
赋值 (.内容, 读 (1))
获取焦点 ()
赋值 (.起始选择位置, -1)
赋值 (.内容, 取文本左边 (.内容, 相减 (取文本长度 (.内容), HYB)))

.子程序 _单选框1_被单击, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
连续赋值 (真, .禁止, .禁止)

.子程序 _编辑框6_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
    赋值 (.起始选择位置, -1)
.如果真结束


.子程序 _编辑框6_内容被改变, 空白型, , 
置当前库 (“tsglyh”)
到首记录 ()
赋值 (.标题, .内容)
.如果真 (查找 (等于 (读 (1), .内容)))
    赋值 (.标题, 读 (2))
    赋值 (.标题, 读 (3))
    赋值 (.标题, 读 (1))
    赋值 (.标题, 相加 (数值到格式文本 (取年份 (读 (“办证时间”)), , 假), “-”, 数值到格式文本 (取月份 (读 (“办证时间”)), , 假), “-”, 数值到格式文本 (取日 (读 (“办证时间”)), , 假)))
    获取焦点 ()
    赋值 (.起始选择位置, -1)
.如果真结束



.窗口程序集 借阅统计窗口程序集, , , 

.子程序 _借阅统计窗口_创建完毕, 空白型, , 
置当前库 (“tsgltsk”)
到首记录 ()
排序 (相加 (运行目录, “\data\tsgltskpx.edb”), “借阅次数”, 假, , )
打开 (相加 (运行目录, “\data\tsgltskpx.edb”), “tsgltskpx”, 假, 4, , “ujumpitoo@jdyltsgl3.com”, )
置当前库 (“tsglhy”)
到首记录 ()
排序 (相加 (运行目录, “\data\tsglhypx.edb”), “借书次数”, 假, , )
打开 (相加 (运行目录, “\data\tsglhypx.edb”), “tsglhypx”, 假, 4, , “ujumpitoo@jdyltsgl2.com”, )
.如果真 (.选中)
    统计图书子程序 ()
.如果真结束
.如果真 (.选中)
    统计会员子程序 ()
.如果真结束


.子程序 统计图书子程序, 空白型, , 
置当前库 (“tsgltskpx”)
到首记录 ()
赋值 (., 读 (“借阅次数”))
.计次循环首 (20, 循环次数)
    赋值 (., 相减 (循环次数, 1))
    赋值 (., 相乘 (循环次数, 50000))
    赋值 (., 读 (“借阅次数”))
    赋值 (., 读 (“书名”))
    跳过 (1)
.计次循环尾 ()

.子程序 统计会员子程序, 空白型, , 
置当前库 (“tsglhypx”)
到首记录 ()
赋值 (., 读 (“借书次数”))
.计次循环首 (20, 循环次数)
    赋值 (., 相减 (循环次数, 1))
    赋值 (., 相乘 (循环次数, 50000))
    赋值 (., 读 (“借书次数”))
    赋值 (., 读 (“姓名”))
    跳过 (1)
.计次循环尾 ()

.子程序 _借阅统计_关闭按钮_被单击, 空白型, , 
关闭 (“tsgltskpx”)
关闭 (“tsglhypx”)
赋值 (主窗口.., -1)
借阅统计窗口.销毁 ()

.子程序 _单选框1_被单击, 空白型, , 
统计图书子程序 ()

.子程序 _单选框2_被单击, 空白型, , 
统计会员子程序 ()

.窗口程序集 办证窗口程序集, , , 

.子程序 _办证窗口_创建完毕, 空白型, , 
.局部变量 办证_搜索结果1, 未知类型0xA0002, , "0", 
.局部变量 办证_正则表达式1, 未知类型0xA0001, , , 
.局部变量 ZZM, 整数型, , , 循环变量
.局部变量 TT, 文本型, , , 编号除去右侧数字部分
.局部变量 TN, 文本型, , , 编号右侧数字部分
.局部变量 TN1, 文本型, , , TN数值加1后的值对应的文本
.局部变量 T, 文本型, , , 用于补0

赋值 (TT, “”)
赋值 (TN, “”)
赋值 (TN1, “”)
赋值 (T, “”)
.如果 (主窗口..选中)
    办证_正则表达式1.未知支持库函数_3 (“[0-9]”, )
    .计次循环首 (取文本长度 (主窗口.未知支持库函数_10 (., 相减 (主窗口.., 1), 1)), ZZM)
        赋值 (办证_搜索结果1, 办证_正则表达式1.未知支持库函数_16 (取文本右边 (主窗口.未知支持库函数_10 (., 相减 (主窗口.., 1), 1), ZZM)))
        .如果 (大于 (取数组成员数 (办证_搜索结果1), 0))
            赋值 (TN, 相加 (办证_搜索结果1.未知支持库函数_11 ( [1], 取文本右边 (主窗口.未知支持库函数_10 (., 相减 (主窗口.., 1), 1), ZZM), ), TN))
        .否则
            赋值 (TN, “”)
            跳出循环 ()
        .如果结束
        .如果真 (不等于 (TN, 取文本右边 (主窗口.未知支持库函数_10 (., 相减 (主窗口.., 1), 1), ZZM)))
            赋值 (TN, 取文本右边 (TN, 相减 (取文本长度 (TN), 1)))
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
    赋值 (TT, 取文本左边 (主窗口.未知支持库函数_10 (., 相减 (主窗口.., 1), 1), 相减 (取文本长度 (主窗口.未知支持库函数_10 (., 相减 (主窗口.., 1), 1)), 取文本长度 (TN))))
    .如果 (等于 (TN, “”))
        .如果真 (等于 (主窗口.., 1))
            赋值 (TT, “JSZ-”)
        .如果真结束
        赋值 (TN, “1”)
        .计次循环首 (相减 (HYB, 1), )
            赋值 (TN, 相加 (“0”, TN))
        .计次循环尾 ()
        赋值 (.内容, 相加 (TT, TN))
    .否则
        赋值 (TN1, 数值到格式文本 (相加 (到数值 (TN), 1), , 假))
        .计次循环首 (相减 (取文本长度 (TN), 取文本长度 (TN1)), )
            赋值 (T, 相加 (T, “0”))
        .计次循环尾 ()
        赋值 (.内容, 相加 (TT, T, TN1))
    .如果结束
    获取焦点 ()
.否则
    获取焦点 ()
.如果结束
赋值 (.内容, 相加 (数值到格式文本 (取年份 (取现行时间 ()), 0, 假), “-”, 数值到格式文本 (取月份 (取现行时间 ()), 0, 假), “-”, 数值到格式文本 (取日 (取现行时间 ()), 0, 假)))
赋值 (.内容, 数值到格式文本 (P3, 2, 假))

.子程序 _选择框1_被单击, 空白型, , 
.如果 (.选中)
    赋值 (.内容, 数值到格式文本 (V3, 2, 假))
.否则
    赋值 (.内容, 数值到格式文本 (P3, 2, 假))
.如果结束


.子程序 _办证窗口_取消按钮_被单击, 空白型, , 
办证窗口.销毁 ()

.子程序 _办证窗口_确认按钮_被单击, 空白型, , 
主窗口.未知支持库函数_38 (., 数值到格式文本 (主窗口.., 0, 假), )
主窗口.未知支持库函数_9 (., 相减 (主窗口.., 1), 1, 1, .内容)
主窗口.未知支持库函数_9 (., 相减 (主窗口.., 1), 2, 1, .内容)
主窗口.未知支持库函数_9 (., 相减 (主窗口.., 1), 3, 1, .内容)
主窗口.未知支持库函数_9 (., 相减 (主窗口.., 1), 4, 1, .内容)
主窗口.未知支持库函数_9 (., 相减 (主窗口.., 1), 5, 5, .选中)
主窗口.未知支持库函数_9 (., 相减 (主窗口.., 1), 6, 1, 时间到文本 (取现行时间 (), 2))
置当前库 (“tsglhy”)
加记录 (.内容, .内容, .内容, .内容, .选中)
写 (27, 取现行时间 ())
写 (29, 到数值 (.内容))
置当前库 (“jfgl”)
加记录 (取现行时间 (), 相加 (“收”, .内容, “办证押金”), 到数值 (.内容), , “押金”)
修改 (求和 (读 (3), ))
办证窗口.销毁 ()

.窗口程序集 查看经费窗口程序集, , , 

.程序集变量 选项内容, 文本型, , , 
.程序集变量 JF_N, 整数型, , , 记数器
.程序集变量 JF_YE, 小数型, , , 高级表格余额
.子程序 _查看经费窗口_创建完毕, 空白型, , 
赋值 (.禁止, 取反 (是否注册))
赋值 (选项内容, “”)
置等待鼠标 ()
置当前库 (“jfgl”)
到首记录 ()
赋值 (.今天, 取日期 (读 (1)))
.计次循环首 (., )
    0.未知支持库函数_36 ()
.计次循环尾 ()
.计次循环首 (., )
    0.未知支持库函数_37 ()
.计次循环尾 ()
赋值 (., 1)
赋值 (., 0)
赋值 (., 相加 (取字段数 (), 1))
赋值 (., 相加 (取记录数 (), 1))
0.未知支持库函数_9 (0, 1, “序号”)
0.未知支持库函数_9 (1, 1, “时            间”)
0.未知支持库函数_9 (2, 1, “摘         要”)
0.未知支持库函数_9 (3, 1, “收支”)
0.未知支持库函数_9 (4, 1, “余额”)
0.未知支持库函数_9 (5, 1, “种类”)
0.未知支持库函数_32 (50)
1.未知支持库函数_32 (170)
2.未知支持库函数_32 (140)
3.未知支持库函数_32 (60)
4.未知支持库函数_32 (60)
5.未知支持库函数_32 (60)
.计次循环首 (取记录数 (), 循环次数)
    循环次数.未知支持库函数_9 (0, 1, 数值到格式文本 (循环次数, 0, 假))
    循环次数.未知支持库函数_9 (1, 1, 时间到文本 (读 (1), ))
    循环次数.未知支持库函数_9 (2, 1, 读 (2))
    循环次数.未知支持库函数_9 (3, 1, 数值到格式文本 (读 (3), 2, 假))
    循环次数.未知支持库函数_9 (4, 1, 数值到格式文本 (读 (4), 2, 假))
    循环次数.未知支持库函数_9 (5, 1, 读 (5))
    跳过 (1)
.计次循环尾 ()
0.未知支持库函数_25 (0, 0, 5, 2) ' 上表格头对齐方式
1.未知支持库函数_25 (0, ., 0, 2) ' 左表格头对齐方式
1.未知支持库函数_25 (5, ., 5, 2)
赋值 (., 假)
恢复鼠标 ()


.子程序 _查看经费_打印按钮_被单击, 空白型, , 
赋值 (表头标志, “经费”)
载入 (置打印表头窗口, , 真)

.子程序 _查看经费_关闭按钮_被单击, 空白型, , 
查看经费窗口.销毁 ()
赋值 (主窗口.., -1)

.子程序 _组合框1_列表项被选择, 空白型, , 
.如果真 (等于 (.现行选中项, 0))
    置等待鼠标 ()
    置当前库 (“jfgl”)
    到首记录 ()
    .计次循环首 (., )
        0.未知支持库函数_36 ()
    .计次循环尾 ()
    .计次循环首 (., )
        0.未知支持库函数_37 ()
    .计次循环尾 ()
    赋值 (., 1)
    赋值 (., 0)
    赋值 (., 相加 (取字段数 (), 1))
    赋值 (., 相加 (计算数目 (并且 (大于或等于 (取日期 (读 (1)), .今天), 小于或等于 (取日期 (读 (1)), .今天))), 1))
    0.未知支持库函数_9 (0, 1, “序号”)
    0.未知支持库函数_9 (1, 1, “时            间”)
    0.未知支持库函数_9 (2, 1, “摘         要”)
    0.未知支持库函数_9 (3, 1, “收支”)
    0.未知支持库函数_9 (4, 1, “余额”)
    0.未知支持库函数_9 (5, 1, “种类”)
    0.未知支持库函数_32 (50)
    1.未知支持库函数_32 (170)
    2.未知支持库函数_32 (140)
    3.未知支持库函数_32 (60)
    4.未知支持库函数_32 (60)
    5.未知支持库函数_32 (60)
    赋值 (JF_N, 0)
    赋值 (JF_YE, 0)
    .计次循环首 (取记录数 (), )
        .如果真 (并且 (大于或等于 (取日期 (读 (1)), .今天), 小于或等于 (取日期 (读 (1)), .今天)))
            赋值 (JF_N, 相加 (JF_N, 1))
            赋值 (JF_YE, 相加 (JF_YE, 读 (3)))
            JF_N.未知支持库函数_9 (0, 1, 数值到格式文本 (JF_N, 0, 假))
            JF_N.未知支持库函数_9 (1, 1, 时间到文本 (读 (1), ))
            JF_N.未知支持库函数_9 (2, 1, 读 (2))
            JF_N.未知支持库函数_9 (3, 1, 数值到格式文本 (读 (3), 2, 假))
            JF_N.未知支持库函数_9 (4, 1, 数值到格式文本 (JF_YE, 2, 假))
            JF_N.未知支持库函数_9 (5, 1, 读 (5))
        .如果真结束
        跳过 (1)
    .计次循环尾 ()
    0.未知支持库函数_25 (0, 0, 5, 2) ' 上表格头对齐方式
    1.未知支持库函数_25 (0, ., 0, 2) ' 左表格头对齐方式
    1.未知支持库函数_25 (5, ., 5, 2)
    赋值 (., 假)
    恢复鼠标 ()
.如果真结束
.如果真 (等于 (.现行选中项, 1))
    赋值 (选项内容, “押金”)
    经费子程序 ()
.如果真结束
.如果真 (等于 (.现行选中项, 2))
    赋值 (选项内容, “损赔”)
    经费子程序 ()
.如果真结束
.如果真 (等于 (.现行选中项, 3))
    赋值 (选项内容, “丢赔”)
    经费子程序 ()
.如果真结束


.子程序 经费子程序, 空白型, , 
置等待鼠标 ()
置当前库 (“jfgl”)
到首记录 ()
.计次循环首 (., )
    0.未知支持库函数_36 ()
.计次循环尾 ()
.计次循环首 (., )
    0.未知支持库函数_37 ()
.计次循环尾 ()
赋值 (., 1)
赋值 (., 0)
赋值 (., 相加 (取字段数 (), 1))
赋值 (., 相加 (计算数目 (并且 (等于 (读 (5), 选项内容), 大于或等于 (取日期 (读 (1)), .今天), 小于或等于 (取日期 (读 (1)), .今天))), 1))
0.未知支持库函数_9 (0, 1, “序号”)
0.未知支持库函数_9 (1, 1, “时            间”)
0.未知支持库函数_9 (2, 1, “摘         要”)
0.未知支持库函数_9 (3, 1, “收支”)
0.未知支持库函数_9 (4, 1, “余额”)
0.未知支持库函数_9 (5, 1, “种类”)
0.未知支持库函数_32 (50)
1.未知支持库函数_32 (170)
2.未知支持库函数_32 (140)
3.未知支持库函数_32 (60)
4.未知支持库函数_32 (60)
5.未知支持库函数_32 (60)
赋值 (JF_N, 0)
赋值 (JF_YE, 0)
.计次循环首 (取记录数 (), )
    .如果真 (并且 (大于或等于 (取日期 (读 (1)), .今天), 小于或等于 (取日期 (读 (1)), .今天), 等于 (读 (5), 选项内容)))
        赋值 (JF_N, 相加 (JF_N, 1))
        赋值 (JF_YE, 相加 (JF_YE, 读 (3)))
        JF_N.未知支持库函数_9 (0, 1, 数值到格式文本 (JF_N, 0, 假))
        JF_N.未知支持库函数_9 (1, 1, 时间到文本 (读 (1), ))
        JF_N.未知支持库函数_9 (2, 1, 读 (2))
        JF_N.未知支持库函数_9 (3, 1, 数值到格式文本 (读 (3), 2, 假))
        JF_N.未知支持库函数_9 (4, 1, 数值到格式文本 (JF_YE, 2, 假))
        JF_N.未知支持库函数_9 (5, 1, 读 (5))
    .如果真结束
    跳过 (1)
.计次循环尾 ()
0.未知支持库函数_25 (0, 0, 5, 2) ' 上表格头对齐方式
1.未知支持库函数_25 (0, ., 0, 2) ' 左表格头对齐方式
1.未知支持库函数_25 (5, ., 5, 2)
赋值 (., 假)
恢复鼠标 ()

.子程序 _日期框1_选择日期被改变, 空白型, , 
.如果 (等于 (.现行选中项, 0))
    置等待鼠标 ()
    置当前库 (“jfgl”)
    到首记录 ()
    .计次循环首 (., )
        0.未知支持库函数_36 ()
    .计次循环尾 ()
    .计次循环首 (., )
        0.未知支持库函数_37 ()
    .计次循环尾 ()
    赋值 (., 1)
    赋值 (., 0)
    赋值 (., 相加 (取字段数 (), 1))
    赋值 (., 相加 (计算数目 (并且 (大于或等于 (取日期 (读 (1)), .今天), 小于或等于 (取日期 (读 (1)), .今天))), 1))
    0.未知支持库函数_9 (0, 1, “序号”)
    0.未知支持库函数_9 (1, 1, “时            间”)
    0.未知支持库函数_9 (2, 1, “摘         要”)
    0.未知支持库函数_9 (3, 1, “收支”)
    0.未知支持库函数_9 (4, 1, “余额”)
    0.未知支持库函数_9 (5, 1, “种类”)
    0.未知支持库函数_32 (50)
    1.未知支持库函数_32 (170)
    2.未知支持库函数_32 (140)
    3.未知支持库函数_32 (60)
    4.未知支持库函数_32 (60)
    5.未知支持库函数_32 (60)
    赋值 (JF_N, 0)
    赋值 (JF_YE, 0)
    .计次循环首 (取记录数 (), )
        .如果真 (并且 (大于或等于 (取日期 (读 (1)), .今天), 小于或等于 (取日期 (读 (1)), .今天)))
            赋值 (JF_N, 相加 (JF_N, 1))
            赋值 (JF_YE, 相加 (JF_YE, 读 (3)))
            JF_N.未知支持库函数_9 (0, 1, 数值到格式文本 (JF_N, 0, 假))
            JF_N.未知支持库函数_9 (1, 1, 时间到文本 (读 (1), ))
            JF_N.未知支持库函数_9 (2, 1, 读 (2))
            JF_N.未知支持库函数_9 (3, 1, 数值到格式文本 (读 (3), 2, 假))
            JF_N.未知支持库函数_9 (4, 1, 数值到格式文本 (JF_YE, 2, 假))
            JF_N.未知支持库函数_9 (5, 1, 读 (5))
        .如果真结束
        跳过 (1)
    .计次循环尾 ()
    0.未知支持库函数_25 (0, 0, 5, 2) ' 上表格头对齐方式
    1.未知支持库函数_25 (0, ., 0, 2) ' 左表格头对齐方式
    1.未知支持库函数_25 (5, ., 5, 2)
    赋值 (., 假)
    恢复鼠标 ()
.否则
    赋值 (选项内容, .取项目文本 (.现行选中项))
    经费子程序 ()
.如果结束


.子程序 _日期框2_选择日期被改变, 空白型, , 
.如果 (等于 (.现行选中项, 0))
    置等待鼠标 ()
    置当前库 (“jfgl”)
    到首记录 ()
    .计次循环首 (., )
        0.未知支持库函数_36 ()
    .计次循环尾 ()
    .计次循环首 (., )
        0.未知支持库函数_37 ()
    .计次循环尾 ()
    赋值 (., 1)
    赋值 (., 0)
    赋值 (., 相加 (取字段数 (), 1))
    赋值 (., 相加 (计算数目 (并且 (大于或等于 (取日期 (读 (1)), .今天), 小于或等于 (取日期 (读 (1)), .今天))), 1))
    0.未知支持库函数_9 (0, 1, “序号”)
    0.未知支持库函数_9 (1, 1, “时            间”)
    0.未知支持库函数_9 (2, 1, “摘         要”)
    0.未知支持库函数_9 (3, 1, “收支”)
    0.未知支持库函数_9 (4, 1, “余额”)
    0.未知支持库函数_9 (5, 1, “种类”)
    0.未知支持库函数_32 (50)
    1.未知支持库函数_32 (170)
    2.未知支持库函数_32 (140)
    3.未知支持库函数_32 (60)
    4.未知支持库函数_32 (60)
    5.未知支持库函数_32 (60)
    赋值 (JF_N, 0)
    赋值 (JF_YE, 0)
    .计次循环首 (取记录数 (), )
        .如果真 (并且 (大于或等于 (取日期 (读 (1)), .今天), 小于或等于 (取日期 (读 (1)), .今天)))
            赋值 (JF_N, 相加 (JF_N, 1))
            赋值 (JF_YE, 相加 (JF_YE, 读 (3)))
            JF_N.未知支持库函数_9 (0, 1, 数值到格式文本 (JF_N, 0, 假))
            JF_N.未知支持库函数_9 (1, 1, 时间到文本 (读 (1), ))
            JF_N.未知支持库函数_9 (2, 1, 读 (2))
            JF_N.未知支持库函数_9 (3, 1, 数值到格式文本 (读 (3), 2, 假))
            JF_N.未知支持库函数_9 (4, 1, 数值到格式文本 (JF_YE, 2, 假))
            JF_N.未知支持库函数_9 (5, 1, 读 (5))
        .如果真结束
        跳过 (1)
    .计次循环尾 ()
    0.未知支持库函数_25 (0, 0, 5, 2) ' 上表格头对齐方式
    1.未知支持库函数_25 (0, ., 0, 2) ' 左表格头对齐方式
    1.未知支持库函数_25 (5, ., 5, 2)
    赋值 (., 假)
    恢复鼠标 ()
.否则
    赋值 (选项内容, .取项目文本 (.现行选中项))
    经费子程序 ()
.如果结束


.窗口程序集 打印书号窗口程序集, , , 

.子程序 _打印书号窗口_创建完毕, 空白型, , 
赋值 (.禁止, 取反 (是否注册))
置当前库 (“tsgltsk”)
到首记录 ()
连续赋值 (真, .禁止, .禁止)
赋值 (.标题, 读 (1))

.子程序 _打印书号_取消按钮_被单击, 空白型, , 
打印书号窗口.销毁 ()
赋值 (主窗口.., -1)

.子程序 _打印书号_打印按钮_被单击, 空白型, , 
.局部变量 记录号1, 整数型, , , 
.局部变量 记录号2, 整数型, , , 
.局部变量 DYJSZ_M, 整数型, , , 
.局部变量 DYJSZ_N, 整数型, , , 
.局部变量 书号打印份数, 整数型, , , 打印的书号种数
.局部变量 书号打印个数, 整数型, , , 每种书号的个数

置当前库 (“tsgltsk”)
.如果真 (.选中)
    到首记录 ()
    .如果 (查找 (等于 (读 (1), .内容)))
        赋值 (记录号1, 取记录号 ())
    .否则
        赋值 (提示窗口标题, “未找到！”)
        赋值 (提示窗口图标, 2)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, 相加 (“没有找到编号为 ”, .内容, “ 的记录！”))
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        打印书号窗口.获取焦点 (.)
        赋值 (打印书号窗口..被选择字符数, -1)
        返回 ()
    .如果结束
    到首记录 ()
    .如果 (查找 (等于 (读 (1), .内容)))
        赋值 (记录号2, 取记录号 ())
    .否则
        赋值 (提示窗口标题, “未找到！”)
        赋值 (提示窗口图标, 2)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, 相加 (“没有找到编号为 ”, .内容, “ 的记录！”))
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        打印书号窗口.获取焦点 (.)
        赋值 (打印书号窗口..被选择字符数, -1)
        返回 ()
    .如果结束
    
.如果真结束
赋值 (.打印作业名, “打印图书号”)
真.开始打印 (真, , , , )
到首记录 ()
赋值 (DYJSZ_M, 0)
赋值 (DYJSZ_N, 0)
赋值 (书号打印个数, 读 (5))
.如果 (.选中)
    .判断循环首 (取反 (尾记录后 ()))
        .判断循环首 (并且 (小于 (相乘 (DYJSZ_N, 300), .打印区高度), 取反 (尾记录后 ())))
            .判断循环首 (并且 (小于 (相乘 (DYJSZ_M, 700), .打印区宽度), 取反 (尾记录后 ())))
                相加 (.左边空, 相乘 (DYJSZ_M, 700)).画矩形 (相加 (.顶边空, 相乘 (DYJSZ_N, 300)), 相加 (.左边空, 相乘 (DYJSZ_M, 700), 600), 相加 (.顶边空, 相乘 (DYJSZ_N, 300), 200))
                赋值 (.字体.字体名称, “黑体”)
                赋值 (.字体.字体大小, 22)
                相加 (.左边空, 相乘 (DYJSZ_M, 700), 相除 (相减 (600, 相乘 (取文本长度 (读 (1)), 35)), 2)).定位写出 (相加 (.顶边空, 相乘 (DYJSZ_N, 300), 60), 读 (1))
                赋值 (DYJSZ_M, 相加 (DYJSZ_M, 1))
                赋值 (书号打印个数, 相减 (书号打印个数, 1))
                .如果真 (等于 (书号打印个数, 0))
                    跳过 (1)
                    赋值 (书号打印个数, 读 (5))
                .如果真结束
                
            .判断循环尾 ()
            赋值 (DYJSZ_M, 0)
            赋值 (DYJSZ_N, 相加 (DYJSZ_N, 1))
        .判断循环尾 ()
        换页 ()
        赋值 (DYJSZ_M, 0)
        赋值 (DYJSZ_N, 0)
    .判断循环尾 ()
    结束打印 ()
.否则
    查找 (等于 (读 (1), .内容))
    赋值 (书号打印个数, 读 (5))
    赋值 (书号打印份数, 相加 (取绝对值 (相减 (记录号1, 记录号2)), 1))
    .判断循环首 (不等于 (书号打印份数, 0))
        .判断循环首 (并且 (小于 (相乘 (DYJSZ_N, 300), .打印区高度), 不等于 (书号打印份数, 0)))
            .判断循环首 (并且 (小于 (相乘 (DYJSZ_M, 700), .打印区宽度), 不等于 (书号打印份数, 0)))
                相加 (.左边空, 相乘 (DYJSZ_M, 700)).画矩形 (相加 (.顶边空, 相乘 (DYJSZ_N, 300)), 相加 (.左边空, 相乘 (DYJSZ_M, 700), 600), 相加 (.顶边空, 相乘 (DYJSZ_N, 300), 200))
                赋值 (.字体.字体名称, “黑体”)
                赋值 (.字体.字体大小, 22)
                相加 (.左边空, 相乘 (DYJSZ_M, 700), 相除 (相减 (600, 相乘 (取文本长度 (读 (1)), 35)), 2)).定位写出 (相加 (.顶边空, 相乘 (DYJSZ_N, 300), 60), 读 (1))
                赋值 (DYJSZ_M, 相加 (DYJSZ_M, 1))
                赋值 (书号打印个数, 相减 (书号打印个数, 1))
                .如果真 (等于 (书号打印个数, 0))
                    赋值 (书号打印份数, 相减 (书号打印份数, 1))
                    .如果 (小于 (记录号1, 记录号2))
                        跳过 (1)
                    .否则
                        跳过 (-1)
                    .如果结束
                    赋值 (书号打印个数, 读 (5))
                .如果真结束
                
            .判断循环尾 ()
            赋值 (DYJSZ_M, 0)
            赋值 (DYJSZ_N, 相加 (DYJSZ_N, 1))
        .判断循环尾 ()
        换页 ()
        赋值 (DYJSZ_M, 0)
        赋值 (DYJSZ_N, 0)
    .判断循环尾 ()
    结束打印 ()
.如果结束


.子程序 _单选框2_被单击, 空白型, , 
置当前库 (“tsgltsk”)
到首记录 ()
连续赋值 (假, .禁止, .禁止)
赋值 (.内容, 读 (1))
获取焦点 ()
赋值 (.起始选择位置, -1)
赋值 (.内容, 取文本左边 (.内容, 相减 (取文本长度 (.内容), TSB)))

.子程序 _单选框1_被单击, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
连续赋值 (真, .禁止, .禁止)
赋值 (.标题, 读 (1))

.子程序 _编辑框6_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
    赋值 (.起始选择位置, -1)
.如果真结束


.子程序 _编辑框6_内容被改变, 空白型, , 
置当前库 (“tsgltsk”)
到首记录 ()
.如果真 (查找 (等于 (读 (1), .内容)))
    赋值 (.标题, .内容)
    获取焦点 ()
    赋值 (.起始选择位置, -1)
.如果真结束



.窗口程序集 查询会员结果窗口程序集, , , 

.程序集变量 M, 整数型, , , 
.子程序 _查询会员结果窗口_创建完毕, 空白型, , 
赋值 (.禁止, 取反 (是否注册))
置当前库 (“tsglzz”)
加记录 (取现行时间 (), 操作者, “查询会员。”)
.计次循环首 (查询会员结果窗口.., )
    查询会员结果窗口.未知支持库函数_36 (., 0)
.计次循环尾 ()
.计次循环首 (查询会员结果窗口.., )
    查询会员结果窗口.未知支持库函数_37 (., 0)
.计次循环尾 ()

.子程序 _查询会员结果_关闭按钮_被单击, 空白型, , 
查询会员结果窗口.销毁 ()

.子程序 _查询会员结果_转换按钮_被单击, 空白型, , 
.如果真 (等于 (未知支持库函数_0 (), 假))
    赋值 (提示窗口标题, “错误！”)
    赋值 (提示窗口图标, 1)
    赋值 (提示信息, “Excel 程序创建失败！可能没有安装Excel2000。”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
载入 (进度指示窗口, , 假)
赋值 (进度指示窗口..内容, “正在进行转换...请不要进行其它操作！”)
刷新显示 ()
赋值 (., 相加 (使用单位, “图书室会员查询结果”))
.未知支持库函数_6 ()
赋值 (., 真)
未知支持库函数_21 ()
.计次循环首 (., M)
    赋值 (., M)
    赋值 (., 相加 (“表格”, 数值到格式文本 (M, , 假)))
.计次循环尾 ()
赋值 (., 1)
设置表格 (“A1”, “F1”)
未知支持库函数_26 ()
赋值 (., 40)
赋值 (., 10)
赋值 (., 相加 (使用单位, “图书室会员查询结果”))
赋值 (., 真)
赋值 (., 取颜色值 (41, 115, 164))
赋值 (., 20)
赋值 (., 真)
赋值 (., -4108)
创建表格 ()
.未知支持库函数_31 ()
赋值 (., 85)

.子程序 创建表格, 空白型, , 
.参数 工作表, 未知类型0x80002, 参考, 

.局部变量 计次变量, 整数型, , , 

设置表格 (工作表, “A2”, “A2”)
赋值 (., 10)
赋值 (., 30)
赋值 (., -4108)
1.未知支持库函数_30 (2, 0)
赋值 (工作表., “借书证编号”)
设置表格 (工作表, “B2”, “B2”)
赋值 (., 14)
赋值 (., -4108)
1.未知支持库函数_30 (2, 0)
赋值 (工作表., “姓  名”)
设置表格 (工作表, “C2”, “C2”)
赋值 (., 34)
赋值 (., -4108)
1.未知支持库函数_30 (2, 0)
赋值 (工作表., “单       位”)
设置表格 (工作表, “D2”, “D2”)
赋值 (., 13)
赋值 (., -4108)
1.未知支持库函数_30 (2, 0)
赋值 (工作表., “电  话”)
设置表格 (工作表, “E2”, “E2”)
赋值 (., 6)
赋值 (., -4108)
1.未知支持库函数_30 (2, 0)
赋值 (工作表., “VIP”)
置当前库 (“tsglhycx”)
到首记录 ()
.计次循环首 (取记录数 (), 计次变量)
    赋值 (进度指示窗口..位置, 相乘 (相除 (计次变量, 取记录数 ()), 100))
    会员设置表格内容 (工作表, 相加 (“A”, 数值到格式文本 (相加 (计次变量, 2), 0, 假)), “”, 读 (1))
    会员设置表格内容 (工作表, 相加 (“B”, 数值到格式文本 (相加 (计次变量, 2), 0, 假)), “”, 读 (2))
    会员设置表格内容 (工作表, 相加 (“C”, 数值到格式文本 (相加 (计次变量, 2), 0, 假)), “”, 读 (3))
    会员设置表格内容 (工作表, 相加 (“D”, 数值到格式文本 (相加 (计次变量, 2), 0, 假)), “”, 读 (4))
    会员设置表格内容 (工作表, 相加 (“E”, 数值到格式文本 (相加 (计次变量, 2), 0, 假)), “”, 到文本 (读 (5)))
    跳过 (1)
.计次循环尾 ()
进度指示窗口.销毁 ()

.子程序 设置表格, 空白型, , 
.参数 工作表, 未知类型0x80002, 参考, 
.参数 首单元, 文本型, , 
.参数 尾单元, 文本型, , 

.如果真 (等于 (尾单元, “”))
    赋值 (尾单元, 首单元)
.如果真结束
赋值 (工作表., 首单元)
赋值 (工作表., 尾单元)


.子程序 会员设置表格内容, 空白型, , 
.参数 工作表, 未知类型0x80002, 参考, 
.参数 首单元, 文本型, , 
.参数 尾单元, 文本型, , 
.参数 表格内容, 文本型, , 

设置表格 (工作表, 首单元, 尾单元)
赋值 (工作表., 表格内容)
1.未知支持库函数_30 (2, 0)
赋值 (., 25)
赋值 (., -4108)

.子程序 _查询会员结果_打印按钮_被单击, 空白型, , 
赋值 (表头标志, “查询会员”)
载入 (置打印表头窗口, , 假)

.窗口程序集 帮助窗口程序集, , , 

.子程序 _超级按钮1_被单击, 空白型, , 
赋值 (主窗口.., -1)
帮助窗口.销毁 ()

.子程序 _帮助窗口_创建完毕, 空白型, , 
赋值 (., 相加 (运行目录, “\help\00.htm”))

.子程序 _列表框1_列表项被选择, 空白型, , 
.如果真 (等于 (.现行选中项, 0))
    赋值 (., 相加 (运行目录, “\help\01.htm”))
.如果真结束
.如果真 (等于 (.现行选中项, 1))
    赋值 (., 相加 (运行目录, “\help\02.htm”))
.如果真结束
.如果真 (等于 (.现行选中项, 2))
    赋值 (., 相加 (运行目录, “\help\03.htm”))
.如果真结束
.如果真 (等于 (.现行选中项, 3))
    赋值 (., 相加 (运行目录, “\help\04.htm”))
.如果真结束
.如果真 (等于 (.现行选中项, 4))
    赋值 (., 相加 (运行目录, “\help\05.htm”))
.如果真结束
.如果真 (等于 (.现行选中项, 5))
    赋值 (., 相加 (运行目录, “\help\06.htm”))
.如果真结束
.如果真 (等于 (.现行选中项, 6))
    赋值 (., 相加 (运行目录, “\help\07.htm”))
.如果真结束
.如果真 (等于 (.现行选中项, 7))
    赋值 (., 相加 (运行目录, “\help\08.htm”))
.如果真结束
.如果真 (等于 (.现行选中项, 8))
    赋值 (., 相加 (运行目录, “\help\09.htm”))
.如果真结束
.如果真 (等于 (.现行选中项, 9))
    赋值 (., 相加 (运行目录, “\help\10.htm”))
.如果真结束
.如果真 (等于 (.现行选中项, 10))
    赋值 (., 相加 (运行目录, “\help\11.htm”))
.如果真结束
.如果真 (等于 (.现行选中项, 11))
    赋值 (., 相加 (运行目录, “\help\12.htm”))
.如果真结束
.如果真 (等于 (.现行选中项, 12))
    赋值 (., 相加 (运行目录, “\help\13.htm”))
.如果真结束
.如果真 (等于 (.现行选中项, 13))
    赋值 (., 相加 (运行目录, “\help\14.htm”))
.如果真结束




.窗口程序集 备份选项窗口程序集, , , 

.子程序 _备份选项_备份按钮_被单击, 空白型, , 
.如果 (并且 (取反 (.选中), 取反 (.选中)))
    赋值 (提示窗口图标, 2)
    赋值 (提示窗口标题, “提示！”)
    赋值 (提示窗口按钮数, 1)
    赋值 (提示信息, “您没有选择要备份的数据。”)
    载入 (提示窗口, , 真)
    赋值 (提示窗口图标, 0)
    赋值 (提示窗口标题, “”)
    赋值 (提示窗口按钮数, 0)
    赋值 (提示信息, “”)
    返回 ()
.否则
    .如果 (并且 (.选中, 取反 (.选中)))
        赋值 (.标题, “备份图书数据”)
        赋值 (.类型, 1)
        赋值 (.默认文件后缀, “tsk”)
        赋值 (.过滤器, “*.tsk”)
        赋值 (.初始过滤器, 0)
        赋值 (.文件名, 相加 (数值到格式文本 (取年份 (取现行时间 ()), 0, 假), 取文本右边 (相加 (“0”, 数值到格式文本 (取月份 (取现行时间 ()), 0, 假)), 2), 取文本右边 (相加 (“0”, 数值到格式文本 (取日 (取现行时间 ()), 0, 假)), 2), 取文本右边 (相加 (“0”, 数值到格式文本 (取小时 (取现行时间 ()), 0, 假)), 2), 取文本右边 (相加 (“0”, 数值到格式文本 (取分钟 (取现行时间 ()), 0, 假)), 2)))
        .如果 (打开 ())
            置当前库 (“tsgltsk”)
            .如果 (复制记录 (.文件名, , ))
                置当前库 (“tsglzz”)
                加记录 (取现行时间 (), 操作者, 相加 (“备份图书数据。备份文件：”, 取文本右边 (.文件名, 相减 (取文本长度 (.文件名), 倒找文本 (.文件名, “\”, , 假)))))
                赋值 (提示窗口标题, “备份完成！”)
                赋值 (提示窗口图标, 4)
                赋值 (提示窗口按钮数, 1)
                赋值 (提示信息, 相加 (“备份完成。备份文件目录及文件名：”, .文件名))
                载入 (提示窗口, , 真)
                备份选项窗口.销毁 ()
                赋值 (主窗口.., -1)
                赋值 (提示窗口标题, “”)
                赋值 (提示窗口图标, 0)
                赋值 (提示窗口按钮数, 0)
                赋值 (提示信息, “”)
            .否则
                赋值 (提示窗口标题, “操作失败！”)
                赋值 (提示窗口图标, 2)
                赋值 (提示窗口按钮数, 1)
                赋值 (提示信息, “备份图书数据失败，请稍候重试！”)
                载入 (提示窗口, , 真)
                备份选项窗口.销毁 ()
                赋值 (主窗口.., -1)
                赋值 (提示窗口标题, “”)
                赋值 (提示窗口图标, 0)
                赋值 (提示窗口按钮数, 0)
                赋值 (提示信息, “”)
            .如果结束
            
        .否则
            赋值 (提示窗口标题, “取消备份！”)
            赋值 (提示窗口图标, 2)
            赋值 (提示窗口按钮数, 1)
            赋值 (提示信息, “操作取消，图书数据未作备份。”)
            载入 (提示窗口, , 真)
            备份选项窗口.销毁 ()
            赋值 (主窗口.., -1)
            赋值 (提示窗口标题, “”)
            赋值 (提示窗口图标, 0)
            赋值 (提示窗口按钮数, 0)
            赋值 (提示信息, “”)
        .如果结束
        
    .否则
        .如果 (并且 (取反 (.选中), .选中))
            赋值 (.标题, “备份会员数据”)
            赋值 (.类型, 1)
            赋值 (.默认文件后缀, “hyk”)
            赋值 (.过滤器, “*.hyk”)
            赋值 (.初始过滤器, 0)
            赋值 (.文件名, 相加 (数值到格式文本 (取年份 (取现行时间 ()), 0, 假), 取文本右边 (相加 (“0”, 数值到格式文本 (取月份 (取现行时间 ()), 0, 假)), 2), 取文本右边 (相加 (“0”, 数值到格式文本 (取日 (取现行时间 ()), 0, 假)), 2), 取文本右边 (相加 (“0”, 数值到格式文本 (取小时 (取现行时间 ()), 0, 假)), 2), 取文本右边 (相加 (“0”, 数值到格式文本 (取分钟 (取现行时间 ()), 0, 假)), 2)))
            .如果 (打开 ())
                置当前库 (“tsglhy”)
                .如果 (复制记录 (.文件名, , ))
                    置当前库 (“tsglzz”)
                    加记录 (取现行时间 (), 操作者, 相加 (“备份会员数据。备份文件：”, 取文本右边 (.文件名, 相减 (取文本长度 (.文件名), 倒找文本 (.文件名, “\”, , 假)))))
                    赋值 (提示窗口标题, “备份完成！”)
                    赋值 (提示窗口图标, 4)
                    赋值 (提示窗口按钮数, 1)
                    赋值 (提示信息, 相加 (“备份完成。备份文件目录及文件名：”, .文件名))
                    载入 (提示窗口, , 真)
                    备份选项窗口.销毁 ()
                    赋值 (主窗口.., -1)
                    赋值 (提示窗口标题, “”)
                    赋值 (提示窗口图标, 0)
                    赋值 (提示窗口按钮数, 0)
                    赋值 (提示信息, “”)
                .否则
                    赋值 (提示窗口标题, “操作失败！”)
                    赋值 (提示窗口图标, 2)
                    赋值 (提示窗口按钮数, 1)
                    赋值 (提示信息, “备份会员数据失败，请稍候重试！”)
                    载入 (提示窗口, , 真)
                    备份选项窗口.销毁 ()
                    赋值 (主窗口.., -1)
                    赋值 (提示窗口标题, “”)
                    赋值 (提示窗口图标, 0)
                    赋值 (提示窗口按钮数, 0)
                    赋值 (提示信息, “”)
                .如果结束
                
            .否则
                赋值 (提示窗口标题, “取消备份！”)
                赋值 (提示窗口图标, 2)
                赋值 (提示窗口按钮数, 1)
                赋值 (提示信息, “操作取消，会员数据未作备份。”)
                载入 (提示窗口, , 真)
                备份选项窗口.销毁 ()
                赋值 (主窗口.., -1)
                赋值 (提示窗口标题, “”)
                赋值 (提示窗口图标, 0)
                赋值 (提示窗口按钮数, 0)
                赋值 (提示信息, “”)
            .如果结束
            
        .否则
            赋值 (图书备份成功, 假)
            赋值 (会员备份成功, 假)
            赋值 (.标题, “备份图书、会员数据”)
            赋值 (.类型, 1)
            赋值 (.默认文件后缀, “tsk”)
            赋值 (.过滤器, “*.tsk”)
            赋值 (.初始过滤器, 0)
            赋值 (.文件名, 相加 (数值到格式文本 (取年份 (取现行时间 ()), 0, 假), 取文本右边 (相加 (“0”, 数值到格式文本 (取月份 (取现行时间 ()), 0, 假)), 2), 取文本右边 (相加 (“0”, 数值到格式文本 (取日 (取现行时间 ()), 0, 假)), 2), 取文本右边 (相加 (“0”, 数值到格式文本 (取小时 (取现行时间 ()), 0, 假)), 2), 取文本右边 (相加 (“0”, 数值到格式文本 (取分钟 (取现行时间 ()), 0, 假)), 2)))
            .如果 (打开 ())
                置当前库 (“tsgltsk”)
                .如果真 (复制记录 (.文件名, , ))
                    赋值 (图书备份成功, 真)
                    置当前库 (“tsglzz”)
                    加记录 (取现行时间 (), 操作者, 相加 (“备份图书数据。备份文件：”, 取文本右边 (.文件名, 相减 (取文本长度 (.文件名), 倒找文本 (.文件名, “\”, , 假)))))
                .如果真结束
                置当前库 (“tsglhy”)
                .如果真 (复制记录 (相加 (取文本左边 (.文件名, 相减 (取文本长度 (.文件名), 4)), “.hyk”), , ))
                    赋值 (会员备份成功, 真)
                    置当前库 (“tsglzz”)
                    加记录 (取现行时间 (), 操作者, 相加 (“备份会员数据。备份文件：”, 取文本右边 (相加 (取文本左边 (.文件名, 相减 (取文本长度 (.文件名), 4)), “.hyk”), 相减 (取文本长度 (相加 (取文本左边 (.文件名, 相减 (取文本长度 (.文件名), 4)), “.hyk”)), 倒找文本 (相加 (取文本左边 (.文件名, 相减 (取文本长度 (.文件名), 4)), “.hyk”), “\”, , 假)))))
                .如果真结束
                .如果真 (并且 (图书备份成功, 会员备份成功))
                    赋值 (提示窗口标题, “备份完成！”)
                    赋值 (提示窗口图标, 4)
                    赋值 (提示信息, 相加 (“图书、会员数据备份成功！备份文件目录：”, 取文本左边 (.文件名, 相减 (取文本长度 (.文件名), 16))))
                .如果真结束
                .如果真 (并且 (图书备份成功, 取反 (会员备份成功)))
                    赋值 (提示窗口标题, “部分完成！”)
                    赋值 (提示窗口图标, 2)
                    赋值 (提示信息, 相加 (“图书数据备份成功，会员数据备份失败！备份文件：”, 取文本左边 (.文件名, 相减 (取文本长度 (.文件名), 12)), “.tsk”))
                .如果真结束
                .如果真 (并且 (取反 (图书备份成功), 会员备份成功))
                    赋值 (提示窗口标题, “部分完成！”)
                    赋值 (提示窗口图标, 2)
                    赋值 (提示信息, 相加 (“图书数据备份失败，会员数据备份成功！备份文件：”, 取文本左边 (.文件名, 相减 (取文本长度 (.文件名), 12)), “.hyk”))
                .如果真结束
                .如果真 (并且 (取反 (图书备份成功), 取反 (会员备份成功)))
                    赋值 (提示窗口标题, “备份失败！”)
                    赋值 (提示窗口图标, 2)
                    赋值 (提示信息, “数据备份失败，您可以稍候重试。”)
                .如果真结束
                赋值 (提示窗口按钮数, 1)
                载入 (提示窗口, , 真)
                备份选项窗口.销毁 ()
                赋值 (主窗口.., -1)
                赋值 (提示窗口标题, “”)
                赋值 (提示窗口图标, 0)
                赋值 (提示窗口按钮数, 0)
                赋值 (提示信息, “”)
            .否则
                赋值 (提示窗口标题, “取消备份！”)
                赋值 (提示窗口图标, 2)
                赋值 (提示窗口按钮数, 1)
                赋值 (提示信息, “操作取消，会员数据未作备份。”)
                载入 (提示窗口, , 真)
                备份选项窗口.销毁 ()
                赋值 (主窗口.., -1)
                赋值 (提示窗口标题, “”)
                赋值 (提示窗口图标, 0)
                赋值 (提示窗口按钮数, 0)
                赋值 (提示信息, “”)
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 _备份选项_取消按钮1_被单击, 空白型, , 
备份选项窗口.销毁 ()
赋值 (主窗口.., -1)


.窗口程序集 恢复选项窗口程序集, , , 

.子程序 _恢复选项_关闭按钮1_被单击, 空白型, , 
恢复选项窗口.销毁 ()
赋值 (主窗口.., -1)

.子程序 _恢复选项_恢复按钮_被单击, 空白型, , 
.局部变量 字段名之和, 文本型, , , 

.如果真 (.选中)
    赋值 (.标题, “恢复图书数据”)
    赋值 (.类型, 0)
    赋值 (.默认文件后缀, “tsk”)
    赋值 (.过滤器, “*.tsk”)
    赋值 (.初始过滤器, 0)
    赋值 (.文件名, “*.tsk”)
    .如果 (打开 ())
        .如果 (打开 (.文件名, “tsgltsk_b”, 假, 4, , “ujumpitoo@jdyltsgl3.com”, ))
            赋值 (字段名之和, “”)
            .计次循环首 (取字段数 (), 循环次数)
                赋值 (字段名之和, 相加 (字段名之和, 取字段名 (循环次数)))
            .计次循环尾 ()
            .如果 (并且 (等于 (取字段数 (), 8), 等于 (字段名之和, “图书编号书名作者定价数量库存借阅次数查询标记”)))
                关闭 (“tsgltsk”)
                置当前库 (“tsgltsk_b”)
                .如果 (复制记录 (相加 (运行目录, “\data\tsgltsk.edb”), , ))
                    关闭 (“tsgltsk_b”)
                    置当前库 (“tsglzz”)
                    加记录 (取现行时间 (), 操作者, “恢复图书数据。”)
                    赋值 (提示窗口标题, “完成！”)
                    赋值 (提示窗口图标, 4)
                    赋值 (提示窗口按钮数, 1)
                    赋值 (提示信息, “恢复图书数据成功。”)
                    载入 (提示窗口, , 真)
                    赋值 (提示窗口标题, “”)
                    赋值 (提示窗口图标, 0)
                    赋值 (提示窗口按钮数, 0)
                    赋值 (提示信息, “”)
                    .如果 (打开 (相加 (运行目录, “\data\tsgltsk.edb”), “tsgltsk”, 假, 4, , “ujumpitoo@jdyltsgl3.com”, ))
                        .如果真 (等于 (主窗口..可视, 真))
                            主窗口._卷帘式菜单1_项目被选择 (1, 0)
                        .如果真结束
                        
                    .否则
                        赋值 (提示窗口标题, “打开数据库！”)
                        赋值 (提示窗口图标, 1)
                        赋值 (提示窗口按钮数, 1)
                        赋值 (提示信息, 相加 (“数据已成功恢复，但系统打开刚更新的数据库时失败，现在关闭，稍候请重新启动《”, 软件名称, “》。”))
                        载入 (提示窗口, , 真)
                        全部关闭 ()
                        结束 ()
                    .如果结束
                    
                .否则
                    赋值 (提示窗口标题, “恢复数据失败！”)
                    赋值 (提示窗口图标, 2)
                    赋值 (提示窗口按钮数, 1)
                    赋值 (提示信息, “系统从备份文件中提取数据时失败，请稍候重试。”)
                    载入 (提示窗口, , 真)
                    赋值 (提示窗口标题, “”)
                    赋值 (提示窗口图标, 0)
                    赋值 (提示窗口按钮数, 0)
                    赋值 (提示信息, “”)
                .如果结束
                
            .否则
                赋值 (提示窗口标题, “备份文件错误！”)
                赋值 (提示窗口图标, 2)
                赋值 (提示窗口按钮数, 1)
                赋值 (提示信息, “您提供的备份文件不正确。”)
                载入 (提示窗口, , 真)
                赋值 (提示窗口标题, “”)
                赋值 (提示窗口图标, 0)
                赋值 (提示窗口按钮数, 0)
                赋值 (提示信息, “”)
            .如果结束
            
        .否则
            赋值 (提示窗口标题, “恢复失败！”)
            赋值 (提示窗口图标, 1)
            赋值 (提示窗口按钮数, 1)
            赋值 (提示信息, “系统打开备份文件时失败，请稍候重试。”)
            载入 (提示窗口, , 真)
            赋值 (提示窗口标题, “”)
            赋值 (提示窗口图标, 0)
            赋值 (提示窗口按钮数, 0)
            赋值 (提示信息, “”)
        .如果结束
        
    .否则
        赋值 (提示窗口标题, “取消恢复！”)
        赋值 (提示窗口图标, 2)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, “操作取消，恢复图书数据未完成。”)
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
    .如果结束
    
.如果真结束
.如果真 (.选中)
    赋值 (.标题, “恢复会员数据”)
    赋值 (.类型, 0)
    赋值 (.默认文件后缀, “hyk”)
    赋值 (.过滤器, “*.hyk”)
    赋值 (.初始过滤器, 0)
    赋值 (.文件名, “*.hyk”)
    .如果 (打开 ())
        .如果 (打开 (.文件名, “tsglhy_b”, 假, 4, , “ujumpitoo@jdyltsgl2.com”, ))
            赋值 (字段名之和, “”)
            .计次循环首 (取字段数 (), 循环次数)
                赋值 (字段名之和, 相加 (字段名之和, 取字段名 (循环次数)))
            .计次循环尾 ()
            .如果 (并且 (等于 (取字段数 (), 29), 等于 (字段名之和, “借书证编号姓名单位电话是否VIP附1时间1附2时间2附3时间3附4时间4附5时间5附6时间6附7时间7附8时间8附9时间9附10时间10查询标志办证时间借书次数办证押金”)))
                关闭 (“tsglhy”)
                置当前库 (“tsglhy_b”)
                .如果 (复制记录 (相加 (运行目录, “\data\tsglhy.edb”), , ))
                    关闭 (“tsglhy_b”)
                    置当前库 (“tsglzz”)
                    加记录 (取现行时间 (), 操作者, “恢复会员数据。”)
                    赋值 (提示窗口标题, “完成！”)
                    赋值 (提示窗口图标, 4)
                    赋值 (提示窗口按钮数, 1)
                    赋值 (提示信息, “恢复会员数据成功。”)
                    载入 (提示窗口, , 真)
                    赋值 (提示窗口标题, “”)
                    赋值 (提示窗口图标, 0)
                    赋值 (提示窗口按钮数, 0)
                    赋值 (提示信息, “”)
                    .如果 (打开 (相加 (运行目录, “\data\tsglhy.edb”), “tsglhy”, 假, 4, , “ujumpitoo@jdyltsgl2.com”, ))
                        .如果真 (等于 (主窗口..可视, 真))
                            主窗口._卷帘式菜单1_项目被选择 (2, 0)
                        .如果真结束
                        
                    .否则
                        赋值 (提示窗口标题, “打开数据库！”)
                        赋值 (提示窗口图标, 1)
                        赋值 (提示窗口按钮数, 1)
                        赋值 (提示信息, 相加 (“数据已成功恢复，但系统打开刚更新的数据库时失败，现在关闭，稍候请重新启动《”, 软件名称, “》。”))
                        载入 (提示窗口, , 真)
                        全部关闭 ()
                        结束 ()
                    .如果结束
                    
                .否则
                    赋值 (提示窗口标题, “恢复数据失败！”)
                    赋值 (提示窗口图标, 2)
                    赋值 (提示窗口按钮数, 1)
                    赋值 (提示信息, “系统从备份文件中提取数据时失败，请稍候重试。”)
                    载入 (提示窗口, , 真)
                    赋值 (提示窗口标题, “”)
                    赋值 (提示窗口图标, 0)
                    赋值 (提示窗口按钮数, 0)
                    赋值 (提示信息, “”)
                .如果结束
                
            .否则
                赋值 (提示窗口标题, “备份文件错误！”)
                赋值 (提示窗口图标, 2)
                赋值 (提示窗口按钮数, 1)
                赋值 (提示信息, “您提供的备份文件不正确。”)
                载入 (提示窗口, , 真)
                赋值 (提示窗口标题, “”)
                赋值 (提示窗口图标, 0)
                赋值 (提示窗口按钮数, 0)
                赋值 (提示信息, “”)
            .如果结束
            
        .否则
            赋值 (提示窗口标题, “恢复失败！”)
            赋值 (提示窗口图标, 1)
            赋值 (提示窗口按钮数, 1)
            赋值 (提示信息, “系统打开备份文件时失败，请稍候重试。”)
            载入 (提示窗口, , 真)
            赋值 (提示窗口标题, “”)
            赋值 (提示窗口图标, 0)
            赋值 (提示窗口按钮数, 0)
            赋值 (提示信息, “”)
        .如果结束
        
    .否则
        赋值 (提示窗口标题, “取消恢复！”)
        赋值 (提示窗口图标, 2)
        赋值 (提示窗口按钮数, 1)
        赋值 (提示信息, “操作取消，恢复图书数据未完成。”)
        载入 (提示窗口, , 真)
        赋值 (提示窗口标题, “”)
        赋值 (提示窗口图标, 0)
        赋值 (提示窗口按钮数, 0)
        赋值 (提示信息, “”)
    .如果结束
    
.如果真结束



 ' 不属于任何一个程序集、类模块的函数：
