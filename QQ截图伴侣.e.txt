 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 273
    高度 = 403
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\QQ截图伴侣.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' shellEx DA19AC3ADD2F4121AAD84AC5FBCAFC71 2 1 扩展功能支持库一
 ' edroptarget {9DA96BF9CEBD45c5BFCF94CBE61671F5} 1 0 拖放支持库
 ' eImgConverter 8FA3AA46276847db8F28E57E7FB97B7F 1 0 图像格式转换支持库



 ' 所需要的模块
 ' 截图模块 C:\Documents and Settings\new\桌面\截图1.ec
 ' 优化程序使用内存率 C:\Documents and Settings\new\桌面\截图2.ec



.窗口程序集 窗口程序集1, , , 

.程序集变量 当前标签, 标签, , , 记录当前热点标签
.程序集变量 当前方块, 标签, , , 记录当前热点方块
.程序集变量 到位, 逻辑型, , , 
.程序集变量 进入次数, 整数型, , , 可否关闭
.程序集变量 可否关闭, 逻辑型, , , 可否关闭
.子程序 __启动窗口_创建完毕, 空白型, , 
未知支持库函数_10 (取窗口句柄 (), 取窗口句柄 (), 0, #F1键)
读取图片比例 ()
事件转移 () ' 将标签2的事件转移到标签1,方便统一处理
事件转移 ()
事件转移 () ' 将所有方法的事件全部转移支“左上”，方便统一处理
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
赋值 (., 真)
取窗口句柄 ().未知支持库函数_0 ()
置托盘图标 (_启动窗口., “QQ截图伴侣”)


.子程序 读取图片比例, 空白型, , 
.局部变量 图片号, 整数型, , , 

赋值 (图片号, 载入图片 (.图片))
赋值 (., 图片号.取图片宽度 ())
赋值 (., 图片号.取图片高度 ())
卸载图片 (图片号)


.子程序 _标签1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 


赋值 (当前标签, 取事件组件 ()) ' 将事件标签存入变量，方便统一处理相关事件
当前标签.调整层次 () ' 移动最顶层
当前标签.发送信息 (161, 2, 0) ' 移动控件
赋值 (到位, 假) ' 要重新调整方块位置
显示移动块 ()
.如果真 (等于 (.可视, 真))
    标签透明1 ()
.如果真结束
.如果真 (等于 (.可视, 真))
    标签透明2 ()
.如果真结束
.如果真 (等于 (.可视, 真))
    标签透明3 ()
.如果真结束


.子程序 _标签1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

显示移动块 () ' 移动方块至新位置显示移动块

.子程序 显示移动块, 空白型, , 
.局部变量 标签中心, 整数型, , , 
.局部变量 方块中心, 整数型, , , 使用此变量主要是方法更清楚的了解计算方法，在实际使用中可以不用变量

.如果真 (等于 (是否已创建 (当前标签), 假)) ' 没有事件组件，直接返回
    返回 ()
.如果真结束

.如果真 (到位) ' 已经调整过位置了，直接返回
    返回 ()
.如果真结束

相减 (当前标签.左边, .宽度).移动 (相减 (当前标签.顶边, .高度), , )
赋值 (.可视, 真)
.调整层次 ()

.判断开始 (大于或等于 (当前标签.高度, 10)) ' 高度小于10则不显示“左中”和“右中”方块
    赋值 (标签中心, 相除 (当前标签.高度, 2))
    赋值 (方块中心, 相除 (.高度, 2))
    相减 (当前标签.左边, .宽度).移动 (相加 (当前标签.顶边, 相减 (标签中心, 方块中心)), , )
    赋值 (.可视, 真)
    .调整层次 ()
    
    相加 (当前标签.左边, 当前标签.宽度).移动 (.顶边, , )
    赋值 (.可视, 真)
    .调整层次 ()
.默认
    连续赋值 (假, .可视, .可视)
.判断结束

.移动 (.左边, 相加 (当前标签.顶边, 当前标签.高度), , )
赋值 (.可视, 真)
.调整层次 ()

.判断开始 (大于或等于 (当前标签.宽度, 10)) ' 宽度小于10则不显示“中中”和“中下”方块
    赋值 (标签中心, 相除 (当前标签.宽度, 2))
    赋值 (方块中心, 相除 (.宽度, 2))
    相加 (当前标签.左边, 相减 (标签中心, 方块中心)).移动 (相减 (当前标签.顶边, .高度), , )
    赋值 (.可视, 真)
    .调整层次 ()
    
    .移动 (.左边, 相加 (当前标签.顶边, 当前标签.高度), , )
    赋值 (.可视, 真)
    .调整层次 ()
.默认
    连续赋值 (假, .可视, .可视)
.判断结束

相加 (当前标签.左边, 当前标签.宽度).移动 (相减 (当前标签.顶边, .高度), , )
赋值 (.可视, 真)
.调整层次 ()

.移动 (.左边, 相加 (当前标签.顶边, 当前标签.高度), , )
赋值 (.可视, 真)
.调整层次 ()

赋值 (到位, 真)
.如果真 (等于 (.可视, 真))
    标签透明1 ()
.如果真结束
.如果真 (等于 (.可视, 真))
    标签透明2 ()
.如果真结束
.如果真 (等于 (.可视, 真))
    标签透明3 ()
.如果真结束


.子程序 __启动窗口_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

连续赋值 (假, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视) ' 隐藏方块

.子程序 _左上_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 消息值, 整数型, , , 

赋值 (当前方块, 取事件组件 ())
.判断开始 (等于 (当前方块, ))
    赋值 (消息值, 13)
.判断 (等于 (当前方块, ))
    赋值 (消息值, 10)
.判断 (等于 (当前方块, ))
    赋值 (消息值, 16)
.判断 (等于 (当前方块, ))
    赋值 (消息值, 12)
.判断 (等于 (当前方块, ))
    赋值 (消息值, 15)
.判断 (等于 (当前方块, ))
    赋值 (消息值, 14)
.判断 (等于 (当前方块, ))
    赋值 (消息值, 11)
.判断 (等于 (当前方块, ))
    赋值 (消息值, 17)
.默认
    
.判断结束
当前标签.发送信息 (161, 消息值, 0) ' 调整控件大小
赋值 (到位, 假) ' 要重新调整方块位置
显示移动块 ()

.子程序 _打开_被选择, 空白型, , 
.如果真 (取反 (打开 ()))
    返回 ()
.如果真结束
赋值 (.图片, 读入文件 (.文件名))
读取图片比例 ()

.子程序 _截图_被选择, 空白型, , 
赋值 (_启动窗口., 假)
.计次循环首 (1000, )
    处理事件 ()
.计次循环尾 ()
.如果真 (开始截图 (真, #深青, #黑色, #黑色))
    赋值 (.图片, 取剪贴板位图 ())
.如果真结束
赋值 (_启动窗口., 真)
读取图片比例 ()

.子程序 _增加文字1_被选择, 空白型, , 
.如果 (等于 (.标题, “增加文字1”))
    赋值 (.标题, “撤消文字1”)
    赋值 (.可视, 真)
    赋值 (.标题, .内容)
    标签透明1 ()
.否则
    赋值 (.标题, “增加文字1”)
    赋值 (.可视, 假)
.如果结束


.子程序 _增加文字2_被选择, 空白型, , 
.如果 (等于 (.标题, “增加文字2”))
    赋值 (.标题, “撤消文字2”)
    赋值 (.可视, 真)
    赋值 (.标题, .内容)
    标签透明2 ()
.否则
    赋值 (.标题, “增加文字2”)
    赋值 (.可视, 假)
.如果结束


.子程序 _增加文字3_被选择, 空白型, , 
.如果 (等于 (.标题, “增加文字3”))
    赋值 (.标题, “撤消文字3”)
    赋值 (.可视, 真)
    赋值 (.标题, .内容)
    标签透明3 ()
.否则
    赋值 (.标题, “增加文字3”)
    赋值 (.可视, 假)
.如果结束


.子程序 _保存图片_被选择, 空白型, , 
.局部变量 文件名, 文本型, , , 

打开 ()
写到文件 (相加 (.文件名, “.jpg”), 快照 (取窗口句柄 (), .宽度, .高度))
 ' 快照 (图片框1.取窗口句柄 (), 图片框1.宽度, 图片框1.高度)
未知支持库函数_0 (相加 (.文件名, “.jpg”), 相加 (.文件名, “.jpg”), 假, 75, 真, 0)

.子程序 标签透明1, 空白型, , 
赋值 (.可视, 假)
处理事件 ()
赋值 (.底图, 快照 (取窗口句柄 (), , ))
赋值 (.可视, 真)
赋值 (.宽度, _启动窗口.)


.子程序 标签透明2, 空白型, , 
赋值 (.可视, 假)
处理事件 ()
赋值 (.底图, 快照 (取窗口句柄 (), , ))
赋值 (.可视, 真)
赋值 (.宽度, _启动窗口.)


.子程序 标签透明3, 空白型, , 
赋值 (.可视, 假)
处理事件 ()
赋值 (.底图, 快照 (取窗口句柄 (), , ))
赋值 (.可视, 真)
赋值 (.宽度, _启动窗口.)


.子程序 _图片框1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _标签1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _修改文字_被选择, 空白型, , 
赋值 (.可视, 真)

.子程序 _按钮1_被单击, 空白型, , 
赋值 (.标题, .内容)
赋值 (.可视, 假)

.子程序 _时钟1_周期事件, 空白型, , 
赋值 (.标题, .内容)
赋值 (.标题, .内容)
赋值 (.标题, .内容)
赋值 (.文本颜色, .颜色)
赋值 (.文本颜色, .颜色)
赋值 (.文本颜色, .颜色)
赋值 (.内容, 相加 (到文本 (.字体.字体名称), 到文本 (.字体.字体大小)))
未知函数_67175211 ()

.子程序 _字体编辑框1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.字体名称, .字体.字体名称)
赋值 (.字体大小, .字体.字体大小)
.如果真 (打开 ())
    赋值 (.字体.字体名称, .字体名称)
    赋值 (.字体.字体大小, .字体大小)
    赋值 (.字体.加粗, .加粗)
    赋值 (.字体.倾斜, .倾斜)
    赋值 (.字体.删除线, .删除线)
    赋值 (.字体.下划线, .下划线)
    赋值 (.文本颜色, .字体颜色)
.如果真结束


.子程序 _字体编辑框2_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.字体名称, .字体.字体名称)
赋值 (.字体大小, .字体.字体大小)

.如果真 (打开 ())
    赋值 (.字体.字体名称, .字体名称)
    赋值 (.字体.字体大小, .字体大小)
    赋值 (.字体.加粗, .加粗)
    赋值 (.字体.倾斜, .倾斜)
    赋值 (.字体.删除线, .删除线)
    赋值 (.字体.下划线, .下划线)
    赋值 (.文本颜色, .字体颜色)
.如果真结束


.子程序 _字体编辑框3_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.字体名称, .字体.字体名称)
赋值 (.字体大小, .字体.字体大小)

.如果真 (打开 ())
    赋值 (.字体.字体名称, .字体名称)
    赋值 (.字体.字体大小, .字体大小)
    赋值 (.字体.加粗, .加粗)
    赋值 (.字体.倾斜, .倾斜)
    赋值 (.字体.删除线, .删除线)
    赋值 (.字体.下划线, .下划线)
    赋值 (.文本颜色, .字体颜色)
.如果真结束


.子程序 __启动窗口_尺寸被改变, 空白型, , 
.移动 (_启动窗口.取用户区宽度 (), 相加 (_启动窗口.取用户区高度 (), 0))
赋值 (., 1)
赋值 (., 相加 (到文本 (.宽度), “ X ”, 到文本 (.高度), “ 像数”))


.子程序 _标签4_反馈事件, 整数型, , 
.参数 参数一, 整数型, , 
.参数 参数二, 整数型, , 

_截图_被选择 ()

.子程序 _拖放对象1_得到文件, 空白型, , 
.参数 接收到的文件路径, 文本型, , 

.局部变量 文件路径, 文本型, , "0", 

.如果真 (等于 (取文本右边 (接收到的文件路径, 4), “.jpg”))
    赋值 (文件路径, 分割文本 (接收到的文件路径, #换行符, ))
    .判断循环首 (大于 (取数组成员数 (文件路径), 0))
        未知支持库函数_0 (文件路径 [1], 文件路径 [1], 假, 75, 真, 0)
        删除成员 (文件路径, 1, 1)
    .判断循环尾 ()
.如果真结束


.子程序 __启动窗口_托盘事件, 空白型, , 
.参数 操作类型, 整数型, , 

置托盘图标 (_启动窗口., “QQ截图伴侣”)
.判断开始 (等于 (操作类型, #单击右键))
    弹出托盘菜单 ()
.判断 (等于 (操作类型, #单击左键))
    
.判断 (等于 (操作类型, #双击))
    _返回界面_被选择 ()
.默认
    
.判断结束
返回 ()


.子程序 _返回界面_被选择, 空白型, , 
.如果 (等于 (., 真))
    最小化托盘 ()
.否则
    赋值 (., 真)
    赋值 (., 0)
.如果结束
返回 ()

.子程序 最小化托盘, 空白型, , 
赋值 (., 假)
置托盘图标 (_启动窗口., “QQ截图伴侣”)

.子程序 _说明_被选择, 空白型, , 
 ' 信息框 (“按 F1 截图 功能点右键菜单”, 0, “提示”)

.子程序 __启动窗口_位置被改变, 空白型, , 
.如果真 (等于 (., 2))
    最小化托盘 ()
.如果真结束
返回 ()


.子程序 __启动窗口_可否被关闭, 逻辑型, , 
.如果真 (等于 (进入次数, 0))
    .如果 (不等于 (信息框 (相加 (“特别警告”, #换行符, #换行符, “是否真的退出啊？”), 36, “询问”), #否钮))
        返回 ()
    .否则
        .如果真 (等于 (可否关闭, 真))
            销毁 ()
        .如果真结束
        
    .如果结束
    
.如果真结束
.如果 (等于 (., 真))
    最小化托盘 ()
    赋值 (进入次数, 相加 (进入次数, 1))
    返回 (假)
.否则
    返回 (真)
.如果结束


.子程序 _退出_被选择, 空白型, , 
.如果 (不等于 (信息框 (相加 (“特别警告”, #换行符, #换行符, “是否真的退出啊？”), 36, “询问”), #是钮))
    返回 ()
.否则
    .如果真 (等于 (可否关闭, 真))
        销毁 ()
    .如果真结束
    
.如果结束
关闭所有文件 ()
结束 ()

.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 开始截图, 逻辑型, , 截图成功返回真，图片被自动保存到剪贴板。失败或放弃截图则返回假。
.参数 是否截取鼠标, 逻辑型, 可空, 
.参数 调节框颜色, 整数型, 可空, 默认：Red=10，Green=100，Blue=130 
.参数 矩形信息框颜色, 整数型, 可空, 默认黑色
.参数 矩形信息字体颜色, 整数型, 可空, 默认黑色



.子程序 取剪贴板位图, 字节集, , 


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 优化内存, 空白型, , 瑞玛数据 Rmidc.com QQ:6219819 TEL:13281511502



 ' 不属于任何一个程序集、类模块的函数：
