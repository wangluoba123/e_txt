 ' 文件类型：Windows窗口程序

 ' 程序名称：狼夜考试软件后台
 ' 程序描述：狼夜考试软件后台系统，功能全面！
@备注:
该软件由 狼夜 独立开发，未经许可，不得用于商业用途！
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：QQ:513226297
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：http://www.langyeie.com
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.1
 ' 创建号：1.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 432
    高度 = 383
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “狼夜考试软件--系统后台”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 344
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 数据库管理窗口
    左边 = 50
    顶边 = 50
    宽度 = 743
    高度 = 350
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “数据库管理窗口 beta 1.0”
    帮助文件名 = “”

窗口 修改数据库窗口
    左边 = 50
    顶边 = 50
    宽度 = 264
    高度 = 297
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “修改信息”
    帮助文件名 = “”

窗口 数据库导入窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 569
    高度 = 478
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “数据库导入窗口 beta 1.0”
    帮助文件名 = “”



.图片 pf, " ' 已保存到：D:\易语言学习\Data\C语言考试服务端.e\pf", , 
.图片 dll, " ' 已保存到：D:\易语言学习\Data\C语言考试服务端.e\dll", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 3 0 应用接口支持库
 ' spec A512548E76954B6E92C21055517615B0 3 1 特殊功能支持库
 ' eExcel2000 F86EC5989E044d42BC98C692C0B54727 2 0 EXCEL2000支持库



 ' 所需要的模块
 ' 加密解密文本 F:\易语言源码\加密解密文本.ec
 ' 禁止多次运行程序 $模块_禁止多次运行.ec


.全局变量 修改信息窗口是否关闭, 逻辑型, , , 

.DLL命令 狼夜_加载皮肤, 空白型, "SkinH_EL.dll", "SkinH_AttachEx", , 
    .参数 皮肤路径, 文本型, , 
    .参数 皮肤口令, 文本型, , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 计次, 整数型, , , 
.程序集变量 正在考试, 逻辑型, , , 
.程序集变量 总人数, 整数型, , , 
.程序集变量 分钟, 整数型, , , 
.程序集变量 名单, 文本型, , , 
.程序集变量 秒钟, 整数型, , , 
.程序集变量 准备考试人数, 整数型, , , 
.程序集变量 匿名程序集变量_380, 空白型, , , 
.程序集变量 科目未填写, 逻辑型, , , 
.子程序 _服务器1_数据到达, 空白型, , 
.局部变量 接受数据, 文本型, , "0", 
.局部变量 表项, 整数型, , , 
.局部变量 IP地址, 文本型, , , 
.局部变量 解密, 文本型, , , 

 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

赋值 (IP地址, 取回客户 ())
赋值 (解密, 解密文本 (到文本 (取回数据 ()), “asdflkjhgzxcvmnbqwerpoiuyt0123456789LKJHGASDFPOIUYTQWERMNBZXCV”))
赋值 (接受数据, 分割文本 (解密, “|”, ))
.如果真 (等于 (接受数据 [1], “准备考试”))
    .如果 (等于 (科目未填写, 假))
        .如果 (等于 (正在考试, 真))
            IP地址.发送数据 (“信息|很抱歉，考试已开始，请等待补考！”, 3)
        .否则
            赋值 (表项, .插入表项 ())
            表项.置标题 (0, 接受数据 [2])
            表项.置标题 (1, 接受数据 [3])
            表项.置标题 (2, 接受数据 [4])
            表项.置标题 (4, “等待考试”)
            表项.置标题 (5, IP地址)
            赋值 (总人数, 相加 (总人数, 1))
            赋值 (准备考试人数, 相加 (准备考试人数, 1))
            赋值 (.标题, 相加 (“当前有 ”, 到文本 (准备考试人数), “ 人在等待考试！”))
        .如果结束
         ' 本源码来自易语言资源网(www.5A5X.com)
    .否则
        IP地址.发送数据 (“信息|尚未开考！”, 3)
    .如果结束
    
.如果真结束
.如果真 (等于 (接受数据 [1], “分数”))
    .计次循环首 (总人数, 计次)
        .如果真 (等于 (相减 (计次, 1).取标题 (5), IP地址))
            相减 (计次, 1).置标题 (3, 接受数据 [2])
            相减 (计次, 1).置标题 (4, “结束考试”)
            赋值 (准备考试人数, 相减 (准备考试人数, 1))
            赋值 (.标题, 相加 (“当前有 ”, 到文本 (准备考试人数), “ 人在等待考试！”))
            
        .如果真结束
        
    .计次循环尾 ()
.如果真结束
.如果真 (等于 (接受数据 [1], “作弊”))
    .计次循环首 (总人数, 计次)
        .如果真 (等于 (相减 (计次, 1).取标题 (5), IP地址))
            相减 (计次, 1).置标题 (4, “考生作弊”)
            相减 (计次, 1).置标题 (3, “0”)
        .如果真结束
        
    .计次循环尾 ()
.如果真结束


.子程序 _开始考试按钮_被单击, 空白型, , 
.如果 (等于 (.标题, “开始考试”))
    .如果 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
        信息框 (“请把信息填写完整！”, #信息图标, “温馨提示”)
    .否则
        赋值 (正在考试, 真)
        赋值 (.禁止, 真)
        .计次循环首 (总人数, 计次)
            .如果真 (等于 (相减 (计次, 1).取标题 (4), “等待考试”))
                相减 (计次, 1).取标题 (5).发送数据 (相加 (“开始考试|”, .内容), 3)
                相减 (计次, 1).置标题 (4, “正在考试”)
            .如果真结束
            
        .计次循环尾 ()
        赋值 (.时钟周期, 1000)
        赋值 (.标题, “结束考试”)
        赋值 (.标题, 相加 (“当前有 ”, 到文本 (总人数), “ 人正在考试！”))
        赋值 (分钟, 到整数 (.内容))
        赋值 (秒钟, 0)
    .如果结束
    
.否则
    .如果真 (等于 (信息框 (“确定要结束考试吗？”, #确认取消钮, ), 0))
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        .计次循环首 (总人数, 计次)
            .如果真 (等于 (相减 (计次, 1).取标题 (4), “正在考试”))
                相减 (计次, 1).取标题 (5).发送数据 (“结束考试”, 3)
                相减 (计次, 1).置标题 (4, “结束考试”)
            .如果真结束
            
        .计次循环尾 ()
        赋值 (.标题, “开始考试”)
        赋值 (正在考试, 假)
        赋值 (分钟, 0)
        赋值 (秒钟, 0)
        赋值 (.时钟周期, 0)
        赋值 (.标题, “离考试结束还有 00:00”)
        统计信息 ()
        信息框 (“考试已结束！”, #信息图标, )
    .如果真结束
    
.如果结束


.子程序 _时钟1_周期事件, 空白型, , 
.如果真 (并且 (等于 (秒钟, 0), 等于 (分钟, 0)))
    .计次循环首 (总人数, 计次)
        相减 (计次, 1).取标题 (5).发送数据 (“结束考试”, 5)
        相减 (计次, 1).置标题 (4, “结束考试”)
    .计次循环尾 ()
    赋值 (.标题, “开始考试”)
    赋值 (正在考试, 假)
    赋值 (分钟, 0)
    赋值 (秒钟, 0)
    赋值 (.时钟周期, 0)
    统计信息 ()
    信息框 (“考试已结束！”, #信息图标, )
.如果真结束
.如果真 (等于 (秒钟, 0))
    赋值 (分钟, 相减 (分钟, 1))
    赋值 (秒钟, 60)
.如果真结束
赋值 (秒钟, 相减 (秒钟, 1))
赋值 (.标题, 相加 (“离考试结束还有 ”, 到文本 (分钟), “:”, 到文本 (秒钟)))
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 统计信息, 空白型, , 
.计次循环首 (总人数, 计次)
    赋值 (名单, 相加 (名单, “姓名:”, 相减 (计次, 1).取标题 (0), “ >>> ”, “班级:”, 相减 (计次, 1).取标题 (1), “ >>> ”, “学号:”, 相减 (计次, 1).取标题 (2), “ >>> ”, “得分:”, 相减 (计次, 1).取标题 (3), #换行符))
.计次循环尾 ()

.子程序 _保存文件按钮_被单击, 空白型, , 
.如果真 (等于 (打开 (), 真))
    .如果 (等于 (名单, “”))
        信息框 (“没有信息可以保存！”, #警告图标, “Error”)
    .否则
        写到文件 (.文件名, 到字节集 (名单))
    .如果结束
    
.如果真结束


.子程序 __启动窗口_创建完毕, 空白型, , 
载入 (窗口1, , 真)
.如果真 (等于 (模块_程序是否已运行 (“禁止文件重复运行”), 真))
    信息框 (“禁止重复运行！”, #警告图标, “Error”)
    销毁 ()
    返回 ()
.如果真结束
赋值 (_启动窗口., 真)
.如果真 (等于 (文件是否存在 (相加 (取当前目录 (), “\44.she”)), 假))
    写到文件 (相加 (取当前目录 (), “\44.she”), #pf)
.如果真结束
.如果真 (等于 (文件是否存在 (相加 (取当前目录 (), “\SkinH_EL.dll”)), 假))
    写到文件 (相加 (取当前目录 (), “\SkinH_EL.dll”), #dll)
.如果真结束
狼夜_加载皮肤 (相加 (取当前目录 (), “\44.she”), “”)

.子程序 _数据库管理_被单击, 空白型, , 
弹出菜单 ()

.子程序 _修改数据库_被选择, 空白型, , 
.如果 (等于 (打开 (相加 (取当前目录 (), “\ccc.edb”), , , , , “love4335”, ), 真))
    载入 (数据库管理窗口, , 假)
    赋值 (_启动窗口., 假)
.否则
    信息框 (“找不到数据库！”, #错误图标, “Error”)
.如果结束


.子程序 _服务器1_客户离开, 空白型, , 
.局部变量 IP地址, 文本型, , , 

赋值 (IP地址, 取回客户 ())
.计次循环首 (总人数, 计次)
    .如果真 (等于 (相减 (计次, 1).取标题 (5), IP地址))
        .如果真 (等于 (相减 (计次, 1).取标题 (4), “等待考试”))
            相减 (计次, 1).删除表项 ()
            赋值 (准备考试人数, 相减 (准备考试人数, 1))
            赋值 (.标题, 相加 (“当前有 ”, 到文本 (准备考试人数), “ 人在等待考试！”))
        .如果真结束
        
    .如果真结束
    
.计次循环尾 ()

.子程序 _服务器1_客户进入, 空白型, , 
.局部变量 IP地址, 文本型, , , 

赋值 (IP地址, 取回客户 ())
.如果 (等于 (.内容, “”))
    赋值 (科目未填写, 真)
.否则
    IP地址.发送数据 (相加 (“考试科目|”, .内容), 3)
    赋值 (科目未填写, 假)
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
.如果 (等于 (.内容, “”))
    信息框 (“请把考试科目填写完整！”, #信息图标, )
.否则
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.如果结束
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 __启动窗口_将被销毁, 空白型, , 
模块_关闭事件同步对象 ()

.子程序 _导入Excel数据库_被选择, 空白型, , 
载入 (数据库导入窗口, , 假)
赋值 (_启动窗口., 假)


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 加密文本, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 待加密文本, 文本型, , 密码为26个大小写字母和10个数字自行乱序排列，加、解密的密码要相同
.参数 密码, 文本型, 可空, 如果本参数空，默认为：“ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz”



.子程序 解密文本, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 待解密文本, 文本型, , 密码为26个大小写字母和10个数字自行乱序排列，加、解密的密码要相同
.参数 密码, 文本型, 可空, 如果本参数空，默认为：“ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz”



.窗口程序集 窗口程序集2, , , 

.子程序 _窗口1_创建完毕, 空白型, , 
.局部变量 透明度, 整数型, , , 

.变量循环首 (1, 255, 3, 透明度)
    未知支持库函数_66 (取窗口句柄 (), 透明度)
    赋值 (窗口1., 真)
    延迟 (5)
.变量循环尾 ()
延时 (1000)
赋值 (透明度, 255)
.变量循环首 (1, 255, 3, 透明度)
    未知支持库函数_66 (取窗口句柄 (), 相减 (255, 透明度))
    赋值 (窗口1., 真)
    延迟 (5)
.变量循环尾 ()
赋值 (_启动窗口., 真)
窗口1.销毁 ()
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _图片框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 



.窗口程序集 窗口程序集3, , , 

.程序集变量 计次, 整数型, , , 
.子程序 _数据库管理窗口_创建完毕, 空白型, , 
读取数据库信息 ()

.子程序 读取数据库信息, 空白型, , 
.局部变量 题目, 文本型, , , 
.局部变量 A, 文本型, , , 
.局部变量 B, 文本型, , , 
.局部变量 C, 文本型, , , 
.局部变量 D, 文本型, , , 
.局部变量 答案, 文本型, , , 
.局部变量 题目_分组, 文本型, , "0", 
.局部变量 A_分组, 文本型, , "0", 
.局部变量 B_分组, 文本型, , "0", 
.局部变量 C_分组, 文本型, , "0", 
.局部变量 D_分组, 文本型, , "0", 
.局部变量 答案_分组, 文本型, , "0", 
.局部变量 题库总数, 整数型, , , 
.局部变量 a, 整数型, , , 

 ' -------------读取数据库信息--------------------
赋值 (题库总数, 取记录数 ())
.如果真 (等于 (题库总数, 0))
    信息框 (“数据库无内容！”, #错误图标, “Error”)
    销毁 ()
.如果真结束
.计次循环首 (题库总数, 计次)
    跳到 (计次)
    赋值 (题目, 相加 (题目, 读 (“题目”), “#@”))
    赋值 (A, 相加 (A, 删首尾空 (读 (“a”)), “#@”))
    赋值 (B, 相加 (B, 删首尾空 (读 (“b”)), “#@”))
    赋值 (C, 相加 (C, 删首尾空 (读 (“c”)), “#@”))
    赋值 (D, 相加 (D, 删首尾空 (读 (“d”)), “#@”))
    赋值 (答案, 相加 (答案, 删首尾空 (读 (“答案”)), “#@”))
     ' 本源码来自易语言资源网(www.5A5X.com)
.计次循环尾 ()
赋值 (题目_分组, 分割文本 (题目, “#@”, ))
赋值 (A_分组, 分割文本 (A, “#@”, ))
赋值 (B_分组, 分割文本 (B, “#@”, ))
赋值 (C_分组, 分割文本 (C, “#@”, ))
赋值 (D_分组, 分割文本 (D, “#@”, ))
赋值 (答案_分组, 分割文本 (答案, “#@”, ))
 ' ----------------------End--------------------
 ' ---------------检查完整性--------------------
赋值 (a, 取数组成员数 (题目_分组))
.如果真 (不等于 (题库总数, a))
    信息框 (“题库中有非法字符 #@ 导入失败！”, #错误图标, “Error”)
    销毁 ()
.如果真结束
 ' ----------------------End--------------------
 ' ----------------列表框添加数据----------------
.计次循环首 (题库总数, 计次)
    .插入表项 ()
    相减 (计次, 1).置标题 (0, 到文本 (计次))
    相减 (计次, 1).置标题 (1, 题目_分组 [计次])
    相减 (计次, 1).置标题 (2, A_分组 [计次])
    相减 (计次, 1).置标题 (3, B_分组 [计次])
    相减 (计次, 1).置标题 (4, C_分组 [计次])
    相减 (计次, 1).置标题 (5, D_分组 [计次])
    相减 (计次, 1).置标题 (6, 答案_分组 [计次])
.计次循环尾 ()
 ' ----------------------End--------------------

.子程序 _超级列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 x, 空白型, , "0", '行数

赋值 (x, 取被选择表项 ())
载入 (修改数据库窗口, , 假)
跳到 (相加 (x [1], 1))
赋值 (修改数据库窗口..内容, 读 (“题目”))
赋值 (修改数据库窗口..内容, 删首尾空 (读 (“a”)))
赋值 (修改数据库窗口..内容, 删首尾空 (读 (“b”)))
赋值 (修改数据库窗口..内容, 删首尾空 (读 (“c”)))
赋值 (修改数据库窗口..内容, 删首尾空 (读 (“d”)))
赋值 (修改数据库窗口..内容, 删首尾空 (读 (“答案”)))
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _数据库管理窗口_将被销毁, 空白型, , 
赋值 (_启动窗口., 真)
.如果真 (等于 (修改信息窗口是否关闭, 真))
    修改数据库窗口.销毁 ()
.如果真结束


.窗口程序集 窗口程序集4, , , 

.子程序 _保存修改按钮_被单击, 空白型, , 
写 (“题目”, .内容)
写 (“a”, .内容)
写 (“b”, .内容)
写 (“c”, .内容)
写 (“d”, .内容)
写 (“答案”, .内容)
信息框 (“修改成功！”, #信息图标, )
_启动窗口.全部删除 (.)
_启动窗口.读取数据库信息 ()
销毁 ()
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _修改数据库窗口_将被销毁, 空白型, , 
赋值 (修改信息窗口是否关闭, 假)

.子程序 _修改数据库窗口_创建完毕, 空白型, , 
赋值 (修改信息窗口是否关闭, 真)

.窗口程序集 窗口程序集5, , , 

.程序集变量 行, 空白型, , , 
.程序集变量 列, 空白型, , , 
.程序集变量 i, 空白型, , , 
.子程序 _按钮4_被单击, 空白型, , 
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 范围, 对象, , , 
.局部变量 行对象, 对象, , , 
.局部变量 列对象, 对象, , , 
.局部变量 单元格对象, 对象, , , 
.局部变量 工作簿对象, 对象, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请首先选择要导入到的数据库！”, 0, )
    返回 ()
.如果真结束
.如果真 (打开 ())
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.内容, .文件名)
    .如果真 (等于 (未知支持库函数_0 (), 假))
        信息框 (“您需要在计算机上安装EXCEL程序才能进行导入操作！”, 0, )
         ' 本源码来自易语言资源网(www.5A5X.com)
        返回 ()
    .如果真结束
    赋值 (., 假)
    .未知支持库函数_6 ()
    .未知支持库函数_14 (.内容)
    未知支持库函数_20 ()
    未知支持库函数_19 ()
    赋值 (., 1)
    赋值 (工作簿对象, 未知支持库函数_12 ())
    
    清空 ()
    
    赋值 (范围, 工作簿对象.读对象型属性 (“UsedRange”, ))
    赋值 (行对象, 范围.读对象型属性 (“Rows”, ))
    赋值 (行, 行对象.读数值属性 (“Count”, ))
    赋值 (列对象, 范围.读对象型属性 (“Columns”, ))
    赋值 (列, 列对象.读数值属性 (“Count”, ))
     ' 本源码来自易语言资源网(www.5A5X.com)
    .计次循环首 (列, i)
        赋值 (., 相加 (转换字母 (i), “1”))
        赋值 (., 相加 (转换字母 (i), “1”))
        赋值 (单元格对象, 未知支持库函数_13 ())
        单元格对象.读文本属性 (“Value”, ).加入项目 (i)
    .计次循环尾 ()
    
    未知支持库函数_15 ()
    未知支持库函数_7 ()
    
    打开 (.内容, , , , , “love4335”, )
    .计次循环首 (相减 (取字段数 (), 1), i)
        取字段名 (i).加入项目 ()
    .计次循环尾 ()
    关闭 ()
    30.删除项目 ()
    赋值 (.禁止, 假)
.如果真结束


.子程序 转换字母, 文本型, , 
.参数 ii, 整数型, , 

.局部变量 tt, 文本型, , , 

.如果真 (等于 (ii, 1))
    赋值 (tt, “a”)
.如果真结束
.如果真 (等于 (ii, 2))
    赋值 (tt, “b”)
.如果真结束
.如果真 (等于 (ii, 3))
    赋值 (tt, “c”)
.如果真结束
.如果真 (等于 (ii, 4))
    赋值 (tt, “d”)
.如果真结束
.如果真 (等于 (ii, 5))
    赋值 (tt, “e”)
.如果真结束
.如果真 (等于 (ii, 6))
    赋值 (tt, “f”)
.如果真结束
.如果真 (等于 (ii, 7))
    赋值 (tt, “g”)
.如果真结束
.如果真 (等于 (ii, 8))
    赋值 (tt, “h”)
.如果真结束
.如果真 (等于 (ii, 9))
    赋值 (tt, “i”)
.如果真结束
.如果真 (等于 (ii, 10))
    赋值 (tt, “j”)
.如果真结束
.如果真 (等于 (ii, 11))
    赋值 (tt, “k”)
.如果真结束
.如果真 (等于 (ii, 12))
    赋值 (tt, “l”)
.如果真结束
.如果真 (等于 (ii, 13))
    赋值 (tt, “m”)
.如果真结束
.如果真 (等于 (ii, 14))
    赋值 (tt, “n”)
.如果真结束
.如果真 (等于 (ii, 15))
    赋值 (tt, “o”)
.如果真结束
.如果真 (等于 (ii, 16))
    赋值 (tt, “p”)
.如果真结束
.如果真 (等于 (ii, 17))
    赋值 (tt, “q”)
.如果真结束
.如果真 (等于 (ii, 18))
    赋值 (tt, “r”)
.如果真结束
.如果真 (等于 (ii, 19))
    赋值 (tt, “s”)
.如果真结束
.如果真 (等于 (ii, 20))
    赋值 (tt, “t”)
.如果真结束
.如果真 (等于 (ii, 21))
    赋值 (tt, “u”)
.如果真结束
.如果真 (等于 (ii, 22))
    赋值 (tt, “v”)
.如果真结束
.如果真 (等于 (ii, 23))
    赋值 (tt, “w”)
.如果真结束
.如果真 (等于 (ii, 24))
    赋值 (tt, “x”)
.如果真结束
.如果真 (等于 (ii, 25))
    赋值 (tt, “y”)
.如果真结束
.如果真 (等于 (ii, 26))
    赋值 (tt, “z”)
.如果真结束
.如果真 (等于 (ii, 27))
    赋值 (tt, “aa”)
.如果真结束
.如果真 (等于 (ii, 28))
    赋值 (tt, “ab”)
.如果真结束
.如果真 (等于 (ii, 29))
    赋值 (tt, “ac”)
.如果真结束
.如果真 (等于 (ii, 30))
    赋值 (tt, “ad”)
.如果真结束
.如果真 (等于 (ii, 31))
    赋值 (tt, “ae”)
.如果真结束
.如果真 (等于 (ii, 32))
    赋值 (tt, “af”)
.如果真结束
.如果真 (等于 (ii, 33))
    赋值 (tt, “ag”)
.如果真结束
.如果真 (等于 (ii, 34))
    赋值 (tt, “ah”)
.如果真结束
.如果真 (等于 (ii, 35))
    赋值 (tt, “ai”)
.如果真结束
.如果真 (等于 (ii, 36))
    赋值 (tt, “aj”)
.如果真结束
.如果真 (等于 (ii, 37))
    赋值 (tt, “ak”)
.如果真结束
.如果真 (等于 (ii, 38))
    赋值 (tt, “al”)
.如果真结束
.如果真 (等于 (ii, 39))
    赋值 (tt, “am”)
.如果真结束
.如果真 (等于 (ii, 40))
    赋值 (tt, “an”)
.如果真结束
.如果真 (等于 (ii, 41))
    赋值 (tt, “ao”)
.如果真结束
.如果真 (等于 (ii, 42))
    赋值 (tt, “ap”)
.如果真结束
.如果真 (等于 (ii, 43))
    赋值 (tt, “aq”)
.如果真结束
.如果真 (等于 (ii, 44))
    赋值 (tt, “ar”)
.如果真结束
.如果真 (等于 (ii, 45))
    赋值 (tt, “as”)
.如果真结束
.如果真 (等于 (ii, 46))
    赋值 (tt, “at”)
.如果真结束
.如果真 (等于 (ii, 47))
    赋值 (tt, “au”)
.如果真结束
.如果真 (等于 (ii, 48))
    赋值 (tt, “av”)
.如果真结束
.如果真 (等于 (ii, 49))
    赋值 (tt, “aw”)
.如果真结束
.如果真 (等于 (ii, 50))
    赋值 (tt, “ax”)
.如果真结束
.如果真 (等于 (ii, 51))
    赋值 (tt, “ay”)
.如果真结束
.如果真 (等于 (ii, 52))
    赋值 (tt, “az”)
.如果真结束
.如果真 (等于 (ii, 53))
    赋值 (tt, “ba”)
.如果真结束
.如果真 (等于 (ii, 54))
    赋值 (tt, “bb”)
.如果真结束
.如果真 (等于 (ii, 55))
    赋值 (tt, “bc”)
.如果真结束
.如果真 (等于 (ii, 56))
    赋值 (tt, “bd”)
.如果真结束
.如果真 (等于 (ii, 57))
    赋值 (tt, “be”)
.如果真结束
.如果真 (等于 (ii, 58))
    赋值 (tt, “bf”)
.如果真结束
.如果真 (等于 (ii, 59))
    赋值 (tt, “bg”)
.如果真结束
.如果真 (等于 (ii, 60))
    赋值 (tt, “bh”)
.如果真结束
返回 (tt)

.子程序 _按钮2_被单击, 空白型, , 
.局部变量 外字段, 文本型, , , 
.局部变量 内字段, 文本型, , , 
.局部变量 外位置, 文本型, , , 

.计次循环首 (取项目数 (), i)
    .如果真 (相减 (i, 1).是否被选中 ())
        赋值 (外字段, 相减 (i, 1).取项目文本 ())
        赋值 (外位置, 到文本 (i))
    .如果真结束
     ' 本源码来自易语言资源网(www.5A5X.com)
.计次循环尾 ()
.计次循环首 (取项目数 (), i)
    .如果真 (相减 (i, 1).是否被选中 ())
        赋值 (内字段, 相减 (i, 1).取项目文本 ())
        相减 (i, 1).允许 (假)
        相减 (i, 1).选中项目 (假)
    .如果真结束
    
.计次循环尾 ()
.如果真 (等于 (外字段, “”))
    信息框 (“Excel中的字段还没有选择！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (内字段, “”))
    信息框 (“本系统数据库中的字段还没有选择！”, 0, )
    返回 ()
.如果真结束
相加 (外字段, “==>>”, 内字段).加入项目 ()
外位置.加入项目 ()
内字段.加入项目 ()

.子程序 _按钮3_被单击, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 单元, 文本型, , , 
.局部变量 步幅, 空白型, , , 

.如果真 (等于 (取项目数 (), 0))
    信息框 (“请设置对应的转换字段！”, 0, )
    返回 ()
.如果真结束
置等待鼠标 ()
.如果 (大于 (相减 (行, 1), 32767))
    赋值 (行, 取整 (相除 (行, 10)))
    赋值 (步幅, 10)
.否则
    赋值 (行, 相减 (行, 1))
    赋值 (步幅, 1)
.如果结束
赋值 (.最大位置, 行)
赋值 (.位置, 0)
赋值 (.可视, 真)
.如果 (相加 (“ODBC;DBQ=”, .内容, “;Driver={Microsoft Excel Driver (*.xls)}; ”).打开 ())
    赋值 (记录集句柄, “select * from [sheet1$]”.查询 ()) ' 此处指定表名
    输出调试文本 (到文本 (记录集句柄))
    .如果 (不等于 (记录集句柄, 0))
        记录集句柄.到首记录 ()
        打开 (.内容, , , , , , )
        .判断循环首 (等于 (记录集句柄.尾记录后 (), 假))
            加记录 ()
            .计次循环首 (取项目数 (), i)
                赋值 (单元, 到文本 (记录集句柄.读 (到数值 (相减 (i, 1).取项目文本 ()))))
                写 (相减 (i, 1).取项目文本 (), 单元)
            .计次循环尾 ()
            记录集句柄.到后一记录 ()
            赋值 (.位置, 相加 (.位置, 步幅))
        .判断循环尾 ()
        关闭 (“数据库”)
        记录集句柄.关闭记录集 ()
        关闭 ()
        恢复鼠标 ()
        赋值 (.可视, 假)
        信息框 (“数据导入成功！”, 0, )
    .否则
        记录集句柄.关闭记录集 ()
        关闭 ()
        信息框 (“没有数据可以导入！”, 0, )
    .如果结束
    
.否则
    信息框 (“导入数据时连接Excel文件失败！可能是文件格式有问题。”, 0, )
.如果结束


.子程序 _列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.计次循环首 (取项目数 (), i)
    .如果真 (等于 (相减 (i, 1).取项目文本 (), .取项目文本 (.现行选中项)))
        相减 (i, 1).允许 (真)
    .如果真结束
    ' 本源码来自易语言资源网(www.5A5X.com)
.计次循环尾 ()
.删除项目 (.现行选中项)
.删除项目 (.现行选中项)
.删除项目 (.现行选中项)

.子程序 _按钮5_被单击, 空白型, , 
.如果真 (打开 ())
    赋值 (.内容, .文件名)
    赋值 (.禁止, 真)
.如果真结束


.子程序 _数据库导入窗口_将被销毁, 空白型, , 
赋值 (_启动窗口., 真)


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 模块_程序是否已运行, 逻辑型, , 真表示已经运行，假表示还未运行
.参数 标志文本, 文本型, , 可以是任何文本，但是最好要长一点以保证和系统中已有其他事件对象的名称不相冲突。



.子程序 模块_关闭事件同步对象, 空白型, , 窗口销毁时调用



 ' 不属于任何一个程序集、类模块的函数：
