 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 348
    高度 = 204
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “用户登陆”
    帮助文件名 = “”

窗口 主窗口
    左边 = 50
    顶边 = 50
    宽度 = 849
    高度 = 656
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 车辆信息窗口
    左边 = 50
    顶边 = 50
    宽度 = 825
    高度 = 582
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “车辆信息”
    帮助文件名 = “”

窗口 车辆信息编辑窗口
    左边 = 50
    顶边 = 50
    宽度 = 489
    高度 = 479
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “编辑车辆信息”
    帮助文件名 = “”

窗口 车型编辑窗口
    左边 = 50
    顶边 = 50
    宽度 = 285
    高度 = 316
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “车型编辑”
    帮助文件名 = “”

窗口 燃油类型编辑窗口
    左边 = 50
    顶边 = 50
    宽度 = 285
    高度 = 316
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “燃油类型编辑”
    帮助文件名 = “”

窗口 保险类型编辑窗口
    左边 = 50
    顶边 = 50
    宽度 = 285
    高度 = 316
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “保险类型编辑”
    帮助文件名 = “”

窗口 现行状态编辑窗口
    左边 = 50
    顶边 = 50
    宽度 = 285
    高度 = 316
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “现行状态编辑”
    帮助文件名 = “”

窗口 车颜色编辑窗口
    左边 = 50
    顶边 = 50
    宽度 = 285
    高度 = 316
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “车颜色编辑”
    帮助文件名 = “”

窗口 客人信息窗口
    左边 = 50
    顶边 = 50
    宽度 = 825
    高度 = 582
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “客人信息”
    帮助文件名 = “”

窗口 客人信息编辑窗口
    左边 = 50
    顶边 = 50
    宽度 = 489
    高度 = 470
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “编辑客人信息”
    帮助文件名 = “”

窗口 出租管理窗口
    左边 = 50
    顶边 = 50
    宽度 = 837
    高度 = 569
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “出租管理”
    帮助文件名 = “”

窗口 车辆出租编辑窗口
    左边 = 50
    顶边 = 50
    宽度 = 651
    高度 = 411
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “车辆出租”
    帮助文件名 = “”

窗口 经手人信息窗口
    左边 = 50
    顶边 = 50
    宽度 = 534
    高度 = 431
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “经手人信息”
    帮助文件名 = “”

窗口 经手人编辑窗口
    左边 = 50
    顶边 = 50
    宽度 = 244
    高度 = 263
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “经手人编辑”
    帮助文件名 = “”

窗口 违章管理窗口
    左边 = 50
    顶边 = 50
    宽度 = 776
    高度 = 545
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “事故违章管理”
    帮助文件名 = “”

窗口 违章信息编辑窗口
    左边 = 50
    顶边 = 50
    宽度 = 398
    高度 = 461
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “违章信息编辑”
    帮助文件名 = “”

窗口 目录框窗口
    左边 = 50
    顶边 = 50
    宽度 = 373
    高度 = 302
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 还车提醒窗口
    左边 = 50
    顶边 = 50
    宽度 = 741
    高度 = 501
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “还车提醒”
    帮助文件名 = “”

窗口 用户管理窗口
    左边 = 50
    顶边 = 50
    宽度 = 412
    高度 = 356
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “用艄芾怼
    帮助文件名 = “”

窗口 修改密码窗口
    左边 = 50
    顶边 = 50
    宽度 = 220
    高度 = 251
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “修改用户密码”
    帮助文件名 = “”

窗口 加油记录管理窗口
    左边 = 50
    顶边 = 50
    宽度 = 719
    高度 = 519
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “加油记录”
    帮助文件名 = “”

窗口 加油信息编辑窗口
    左边 = 50
    顶边 = 50
    宽度 = 339
    高度 = 419
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “加油信息编辑”
    帮助文件名 = “”

窗口 油站编辑窗口
    左边 = 50
    顶边 = 50
    宽度 = 285
    高度 = 316
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “油站编辑”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 6 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 6 扩展界面支持库一
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' spec A512548E76954B6E92C21055517615B0 2 1 特殊功能支持库
 ' twain 730FA7B73AAB409a8554F9553CF2DD87 1 5 数码设备支持库
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库
 ' eCompress 7B68736E818E41c5A28B0AE4D43C128C 1 1 压缩解压支持库




.全局变量 记录, 整数型, , , 
.全局变量 当前用户, 文本型, , , 

.DLL命令 装载皮肤, 逻辑型, "USkin.dll", "USkinInit", , 
    .参数 用户名, 文本型, , 可空
    .参数 序列号, 文本型, , 可空
    .参数 皮肤文件, 文本型, , 

.DLL命令 卸载皮肤, 逻辑型, "USkin.dll", "USkinExit", , 

.窗口程序集 启动窗口程序集, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (主窗口., 假)
载入 (主窗口, , 假)
 ' 数据库处理部分 ()
赋值 (记录, 查数据 (“select * from yh order by id”))
调试输出 (记录)
主窗口.到首记录 (., 记录)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    主窗口.读 (., 记录, “yhmc”).加入项目 ()
    主窗口.到后一记录 (., 记录)
.判断循环尾 ()
赋值 (.现行选中项, 0)
主窗口.关闭记录集 (., 记录)
自动登陆 ()

.子程序 _确认_被单击, 空白型, , 
赋值 (记录, 查数据 (相加 (“select * from yh where yhmc='”, .取项目文本 (.现行选中项), “'”)))
.判断开始 (不等于 (.内容, 读数据 (记录, “yhmm”)))
    提示信息 (“密码输入错误！”)
    返回 ()
.默认
    赋值 (当前用户, .内容)
    主窗口.状态条处理 ()
    赋值 (主窗口., 真)
    销毁 ()
.判断结束


.子程序 自动登陆, 空白型, , 
赋值 (.内容, “8888”)
_确认_被单击 ()

.子程序 _取消_被单击, 空白型, , 
结束 ()

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
结束 ()


.程序集 公共程序集, , , 

.子程序 查数据, 整数型, , 
.参数 SQL语句, 文本型, , 

.局部变量 返回值, 整数型, , , 

赋值 (返回值, 主窗口.查询 (., SQL语句))
返回 (返回值)

.子程序 文本取组合框选项, 整数型, , 
.参数 组合框, 组合框, , 
.参数 文本, 文本型, , 

.局部变量 jc, 整数型, , , 
.局部变量 x, 整数型, , , 

.计次循环首 (组合框.取项目数 (), jc)
    .如果真 (等于 (组合框.取项目文本 (相减 (jc, 1)), 文本))
        赋值 (x, 相减 (jc, 1))
    .如果真结束
    
.计次循环尾 ()
返回 (x)

.子程序 时间到格式文本, 文本型, , 2000-2-2（写数据库时用）
.参数 时间, 日期时间型, , 

.局部变量 时间文本, 文本型, , , 

赋值 (时间文本, 相加 (到文本 (取时间部分 (时间, #年份)), “-”, 到文本 (取时间部分 (时间, #月份)), “-”, 到文本 (取时间部分 (时间, #日))))
返回 (时间文本)

.子程序 时间到格式文本2, 文本型, , 2000年02月02日（读数据库时用）
.参数 时间, 日期时间型, , 

.局部变量 时间文本, 文本型, , , 

赋值 (时间文本, 相加 (到文本 (取时间部分 (时间, #年份)), “年”, 取文本右边 (相加 (“00”, 到文本 (取时间部分 (时间, #月份))), 2), “月”, 取文本右边 (相加 (“00”, 到文本 (取时间部分 (时间, #日))), 2), “日”))
返回 (时间文本)

.子程序 执行SQL, 逻辑型, , 
.参数 sql语句, 文本型, , 

.局部变量 返回值, 逻辑型, , , 

赋值 (返回值, 主窗口.执行 (., sql语句, ))
返回 (返回值)

.子程序 提示信息, 空白型, , 
.参数 提示文本, 文本型, , 

信息框 (提示文本, 64, “提示：”)

.子程序 读数据, 文本型, , 
.参数 记录集句柄, 整数型, , 
.参数 字段名, 文本型, , 

.局部变量 返回值, 文本型, , , 

赋值 (返回值, 到文本 (主窗口.读 (., 记录集句柄, 字段名)))
返回 (返回值)

.子程序 关记录, 空白型, , 
主窗口.关闭记录集 (., 记录)

.窗口程序集 主窗口程序集, , , 

.程序集变量 来源数, 整数型, , , 
.子程序 _主窗口_创建完毕, 空白型, , 
未知支持库函数_0 (1)
装载皮肤 (“”, “”, 相加 (取运行目录 (), “\Skins\King.u3”))
.如果真 (等于 (相加 (取运行目录 (), “\data\qczl.mdb”).打开MDB数据库 (), 假))
    _数据恢复_被选择 ()
    结束 ()
    返回 ()
.如果真结束
.如果 (等于 (读配置项 (相加 (取运行目录 (), “\data\sys.ini”), “客户照片”, “启用视频”, ), “是”))
    赋值 (.选中, 真)
    赋值 (.可视, 假)
    视频预处理 ()
.否则
    赋值 (.选中, 真)
    赋值 (.可视, 真)
.如果结束


.子程序 状态条处理, 空白型, , 
赋值 (.时钟周期, 1000)
1.置文本 (相加 (“当前用户:”, 当前用户))

.子程序 视频预处理, 空白型, , 
.局部变量 计数器, 整数型, , , 

赋值 (来源数, .)
.计次循环首 (来源数, 计数器)
    “”.加入项目 (计数器)
.计次循环尾 ()
获取来源 ()

.子程序 获取来源, 空白型, , 
.局部变量 计数器, 整数型, , , 

清空 ()
.计次循环首 (取项目数 (), 计数器)
    赋值 (., 计数器)
    相减 (计数器, 1).置项目文本 (.)
.计次循环尾 ()
.变量循环首 (相加 (取项目数 (), 1), 来源数, 1, 计数器)
    赋值 (., 计数器)
    .加入项目 (., 计数器)
.变量循环尾 ()
赋值 (.现行选中项, 0)
.如果真 (或者 (等于 (来源数, 0), 等于 (., -1)))
    赋值 (.标题, “没有来源或当前没使用它！”)
    返回 ()
.如果真结束
赋值 (.标题, “视频预览中”)
真.未知支持库函数_7 (60)
 ' 初始化 ＝ 1

.子程序 _车辆信息_被选择, 空白型, , 
赋值 (车辆信息窗口., “”)
载入 (车辆信息窗口, , 真)

.子程序 _客人信息_被选择, 空白型, , 
赋值 (客人信息窗口., “”)
载入 (客人信息窗口, , 真)

.子程序 _出租管理_被选择, 空白型, , 
载入 (出租管理窗口, , 真)

.子程序 _事故违章管理_被选择, 空白型, , 
赋值 (违章管理窗口., “”)
载入 (违章管理窗口, , 真)

.子程序 _视频设备_收到一帧数据后, 空白型, , 
.参数 图片, 字节集, , 



.子程序 _不启用视频单选框_被单击, 空白型, , 
.判断开始 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\data\sys.ini”), “客户照片”, “启用视频”, “否”)
    假.未知支持库函数_7 (60)
    赋值 (.可视, 真)
    赋值 (.标题, “视频关闭”)
     ' 视频设备.当前来源 ＝ 0
.默认
    写配置项 (相加 (取运行目录 (), “\data\sys.ini”), “客户照片”, “启用视频”, “是”)
.判断结束


.子程序 _启用视频单选框_被单击, 空白型, , 
.判断开始 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\data\sys.ini”), “客户照片”, “启用视频”, “是”)
    赋值 (.可视, 假)
    视频预处理 ()
.默认
    写配置项 (相加 (取运行目录 (), “\data\sys.ini”), “客户照片”, “启用视频”, “否”)
.判断结束


.子程序 _拍照按钮_被单击, 空白型, , 
.局部变量 文件路径, 文本型, , , 

.如果真 (等于 (.选中, 真))
    提示信息 (“未启用视频！”)
    返回 ()
.如果真结束
赋值 (文件路径, 读配置项 (相加 (取运行目录 (), “\data\sys.ini”), “客户照片”, “保存位置”, ))
.判断开始 (等于 (文件路径, “”))
    相加 (取运行目录 (), “\files\”, 到文本 (取现行时间 ()), “.bmp”).未知支持库函数_11 ()
    赋值 (.可视, 真)
    延时 (2000)
    赋值 (.可视, 假)
.默认
    相加 (文件路径, “\”, 到文本 (取现行时间 ()), “.bmp”).未知支持库函数_11 ()
    赋值 (.可视, 真)
    延时 (2000)
    赋值 (.可视, 假)
    
.判断结束



.子程序 _照片保存设置按钮_被单击, 空白型, , 
.局部变量 文件夹路径, 文本型, , , 

载入 (目录框窗口, , 真)

.子程序 _打开照片文件夹按钮_被单击, 空白型, , 
未知支持库函数_6 (2, 相加 (读配置项 (相加 (取运行目录 (), “\data\sys.ini”), “客户照片”, “保存位置”, ), “\”), , )

.子程序 _还车提醒_被选择, 空白型, , 
载入 (还车提醒窗口, , 真)


.子程序 _刷新视频设备按钮_被单击, 空白型, , 
.如果真 (等于 (.选中, 真))
    提示信息 (“视频未启用！”)
    返回 ()
.如果真结束
视频预处理 ()


.子程序 _状态条时钟_周期事件, 空白型, , 
0.置文本 (相加 (“系统时间：”, 到文本 (取现行时间 ())))

.子程序 _用户管理_被选择, 空白型, , 
载入 (用户管理窗口, , 真)


.子程序 _修改密码_被选择, 空白型, , 
载入 (修改密码窗口, , 真)


.子程序 _数据备份_被选择, 空白型, , 
关闭 () ' 备份前一定要关闭
赋值 (.类型, 1) ' 把类型设为保存对话框
赋值 (.初始目录, 相加 (取运行目录 (), “\备份\”))
打开 ()
.如果真 (等于 (相加 (取运行目录 (), “\data\qczl.mdb”).未知支持库函数_0 (.文件名), 1))
    赋值 (.文件名, “”)
    信息框 (“数据备份成功”, 64, “提示信息：”)
.如果真结束
相加 (取运行目录 (), “\data\qczl.mdb”).打开MDB数据库 (“”, , ) ' 完了再打开

.子程序 _数据恢复_被选择, 空白型, , 
关闭 ()
赋值 (.类型, 0) ' 把类型设为打开对话框
赋值 (.初始目录, 相加 (取运行目录 (), “\备份\”))
打开 ()
.如果真 (等于 (.未知支持库函数_2 (.文件名, 相加 (取运行目录 (), “\data”)), 1))
    赋值 (.文件名, “”)
    _刷新数据_被选择 ()
    信息框 (“数据恢复成功”, 48, “提示信息：”)
.如果真结束
相加 (取运行目录 (), “\data\qczl.mdb”).打开MDB数据库 (“”, , )


.子程序 _车辆信息按钮_被单击, 空白型, , 
_车辆信息_被选择 ()


.子程序 _客人信息按钮_被单击, 空白型, , 
_客人信息_被选择 ()


.子程序 _出租管理按钮_被单击, 空白型, , 
_出租管理_被选择 ()


.子程序 _事故管理按钮_被单击, 空白型, , 
_事故违章管理_被选择 ()


.子程序 _还车提醒按钮_被单击, 空白型, , 
_还车提醒_被选择 ()


.子程序 _修改密码超级按钮_被单击, 空白型, , 
_修改密码_被选择 ()


.子程序 _数据备份按钮_被单击, 空白型, , 
_数据备份_被选择 ()

.子程序 _加油记录_被选择, 空白型, , 
载入 (加油记录管理窗口, , 真)

.子程序 _车辆维修记录_被选择, 空白型, , 


.窗口程序集 车辆信息窗口程序集, , , 

.子程序 _车辆信息窗口_创建完毕, 空白型, , 
车辆信息填充列表 ()

.子程序 车辆信息填充列表, 空白型, , 
.局部变量 crwz, 整数型, , , 

赋值 (记录, 查数据 (“select * from clxx order by id ”))
全部删除 ()
主窗口.到首记录 (., 记录)
赋值 (crwz, 0)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    crwz.插入表项 ()
    crwz.置标题 (0, 读数据 (记录, “clmc”))
    crwz.置标题 (1, 读数据 (记录, “cx”))
    crwz.置标题 (2, 读数据 (记录, “cph”))
    crwz.置标题 (3, 读数据 (记录, “cjh”))
    crwz.置标题 (4, 读数据 (记录, “fdjh”))
    crwz.置标题 (5, 读数据 (记录, “cys”))
    crwz.置标题 (6, 读数据 (记录, “rylx”))
    crwz.置标题 (7, 读数据 (记录, “bdh”))
    crwz.置标题 (8, 读数据 (记录, “bxlx”))
    crwz.置标题 (9, 时间到格式文本2 (到时间 (读数据 (记录, “bxrq”))))
    crwz.置标题 (10, 时间到格式文本2 (到时间 (读数据 (记录, “tbrq”))))
    crwz.置标题 (11, 读数据 (记录, “bxgs”))
    crwz.置标题 (12, 读数据 (记录, “yyh”))
    crwz.置标题 (13, 时间到格式文本2 (到时间 (读数据 (记录, “gcsj”))))
    crwz.置标题 (14, 时间到格式文本2 (到时间 (读数据 (记录, “bfsj”))))
    crwz.置标题 (15, 时间到格式文本2 (到时间 (读数据 (记录, “whsj”))))
    crwz.置标题 (16, 时间到格式文本2 (到时间 (读数据 (记录, “rcwhsj”))))
    crwz.置标题 (17, 读数据 (记录, “xxzt”))
    crwz.置标题 (18, 读数据 (记录, “lc”))
    crwz.置标题 (19, 读数据 (记录, “id”))
    主窗口.到后一记录 (., 记录)
    赋值 (crwz, 相加 (crwz, 1))
.判断循环尾 ()
关记录 ()

.子程序 _添加按钮_被单击, 空白型, , 
赋值 (车辆信息编辑窗口., “tj”)
载入 (车辆信息编辑窗口, , 真)


.子程序 _修改按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    提示信息 (“请先在下表选择您要修改的车辆信息！”)
    返回 ()
.如果真结束
赋值 (车辆信息编辑窗口., “xg”)
载入 (车辆信息编辑窗口, , 真)

.子程序 _删除按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    提示信息 (“请先在下表选择您要删除的车辆信息！”)
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“是否确定要删除选中车辆信息？”, #是否钮, “提示”), #否钮))
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“delete from clxx where id=”, .取标题 (., 19), “”)), 假))
    提示信息 (“操作失败！数据库可能异常！”)
    返回 ()
.如果真结束
车辆信息填充列表 ()

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _超级列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (., -1))
    返回 ()
.如果真结束
.判断开始 (等于 (车辆信息窗口., “”))
    _修改按钮_被单击 ()
.判断 (等于 (车辆信息窗口., “出租调用”))
    .如果真 (不等于 (.取标题 (., 17), “可租”))
        提示信息 (“车辆非可租状态下，是否继续操作？”)
         ' 销毁 ()
        返回 ()
    .如果真结束
    赋值 (车辆出租编辑窗口., .取标题 (., 17))
    赋值 (车辆出租编辑窗口..内容, .取标题 (., 19))
    赋值 (车辆出租编辑窗口..内容, .取标题 (., 0))
    销毁 ()
.判断 (等于 (车辆信息窗口., “加油调用”))
    赋值 (加油信息编辑窗口..内容, .取标题 (., 2))
    赋值 (加油信息编辑窗口..内容, .取标题 (., 0))
    赋值 (加油信息编辑窗口..内容, .取标题 (., 6))
    销毁 ()
.默认
    
.判断结束


.窗口程序集 车型编辑窗口程序集, , , 

.子程序 _车型编辑窗口_创建完毕, 空白型, , 
车型填充列表 ()

.子程序 车型填充列表, 空白型, , 
.局部变量 crwz, 整数型, , , 

赋值 (记录, 查数据 (“select * from cx order by id”))
主窗口.到首记录 (., 记录)
全部删除 ()
赋值 (crwz, 0)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    crwz.插入表项 ()
    crwz.置标题 (0, 读数据 (记录, “cx”))
    crwz.置标题 (1, 读数据 (记录, “id”))
    主窗口.到后一记录 (., 记录)
    赋值 (crwz, 相加 (crwz, 1))
.判断循环尾 ()
关记录 ()


.子程序 _添加按钮_被单击, 空白型, , 
.局部变量 cx, 文本型, , , 

.如果真 (或者 (等于 (输入框 (“请输入车型”, “请输入车型”, , cx, ), 假), 等于 (cx, “”)))
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“insert into cx(cx) values ('”, cx, “')”)), 假))
    提示信息 (“操作失败！数据库可能异常！”)
    返回 ()
.如果真结束
车型填充列表 ()
车辆信息编辑窗口.车型组合框填充 ()

.子程序 _修改按钮_被单击, 空白型, , 
.局部变量 cx, 文本型, , , 

.如果真 (等于 (., -1))
    提示信息 (“请先在左表中选择要修改的车型！”)
    返回 ()
.如果真结束
.如果真 (或者 (等于 (输入框 (“请输入车型”, “请输入车型”, .取标题 (., 0), cx, ), 假), 等于 (cx, “”)))
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“update cx set cx='”, cx, “'where id=”, .取标题 (., 1), “”)), 假))
    提示信息 (“操作失败！数据库可能异常！”)
    返回 ()
.如果真结束
车型填充列表 ()
车辆信息编辑窗口.车型组合框填充 ()

.子程序 _删除按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    提示信息 (“请先在左表中选择要删除的车型！”)
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“您是否确定要删除选中车型？”, #是否钮, “提示”), #否钮))
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“delete from cx where id=”, .取标题 (., 1), “”)), 假))
    提示信息 (“操作失败！数据库可能异常！”)
    返回 ()
.如果真结束
车型填充列表 ()
车辆信息编辑窗口.车型组合框填充 ()

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()


.窗口程序集 车辆信息编辑窗口程序集, , , 

.程序集变量 车图片, 文本型, , , 
.程序集变量 修改前车牌号, 文本型, , , 
.子程序 _车辆信息编辑窗口_创建完毕, 空白型, , 
车型组合框填充 ()
燃油类型组合框填充 ()
保险类型组合框填充 ()
状态组合框填充 ()
车颜色组合框填充 ()
.判断开始 (等于 (车辆信息编辑窗口., “xg”))
    修改信息初处理 ()
    赋值 (修改前车牌号, .内容)
.默认
    赋值 (车图片, “”)
    赋值 (.内容, “可租”)
    赋值 (.禁止, 真)
.判断结束


.子程序 修改信息初处理, 空白型, , 
赋值 (记录, 查数据 (相加 (“select * from clxx where id=”, 车辆信息窗口.取标题 (., 车辆信息窗口.., 19), “”)))
赋值 (.内容, 读数据 (记录, “clmc”))
赋值 (.内容, 读数据 (记录, “cx”))
赋值 (.内容, 读数据 (记录, “cph”))
赋值 (.内容, 读数据 (记录, “cjh”))
赋值 (.内容, 读数据 (记录, “fdjh”))
赋值 (.内容, 读数据 (记录, “cys”))
赋值 (.内容, 读数据 (记录, “rylx”))
赋值 (.内容, 读数据 (记录, “bdh”))
赋值 (.内容, 读数据 (记录, “bxlx”))
赋值 (.今天, 到时间 (读数据 (记录, “bxrq”)))
赋值 (.今天, 到时间 (读数据 (记录, “tbrq”)))
赋值 (.内容, 读数据 (记录, “bxgs”))
赋值 (.内容, 读数据 (记录, “yyh”))
赋值 (.今天, 到时间 (读数据 (记录, “gcsj”)))
赋值 (.今天, 到时间 (读数据 (记录, “bfsj”)))
赋值 (.今天, 到时间 (读数据 (记录, “whsj”)))
赋值 (.今天, 到时间 (读数据 (记录, “rcwhsj”)))
赋值 (.内容, 读数据 (记录, “xxzt”))
赋值 (.内容, 读数据 (记录, “lc”))
赋值 (车图片, 读数据 (记录, “tp”))
赋值 (.图片, 读入文件 (车图片))
关记录 ()

.子程序 车型组合框填充, 空白型, , 
赋值 (记录, 查数据 (“select * from cx order by id”))
主窗口.到首记录 (., 记录)
清空 ()
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    读数据 (记录, “cx”).加入项目 ()
    主窗口.到后一记录 (., 记录)
.判断循环尾 ()
关记录 ()

.子程序 车颜色组合框填充, 空白型, , 
赋值 (记录, 查数据 (“select * from cys order by id”))
主窗口.到首记录 (., 记录)
清空 ()
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    读数据 (记录, “cys”).加入项目 ()
    主窗口.到后一记录 (., 记录)
.判断循环尾 ()
关记录 ()

.子程序 燃油类型组合框填充, 空白型, , 
赋值 (记录, 查数据 (“select * from rylx order by id”))
主窗口.到首记录 (., 记录)
清空 ()
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    读数据 (记录, “rylx”).加入项目 ()
    主窗口.到后一记录 (., 记录)
.判断循环尾 ()
关记录 ()

.子程序 保险类型组合框填充, 空白型, , 
赋值 (记录, 查数据 (“select * from bxlx order by id”))
主窗口.到首记录 (., 记录)
清空 ()
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    读数据 (记录, “bxlx”).加入项目 ()
    主窗口.到后一记录 (., 记录)
.判断循环尾 ()
关记录 ()

.子程序 状态组合框填充, 空白型, , 
赋值 (记录, 查数据 (“select * from zt order by id”))
主窗口.到首记录 (., 记录)
清空 ()
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    读数据 (记录, “zt”).加入项目 ()
    主窗口.到后一记录 (., 记录)
.判断循环尾 ()
关记录 ()

.子程序 _车型按钮_被单击, 空白型, , 
载入 (车型编辑窗口, , 真)

.子程序 _燃油类型按钮_被单击, 空白型, , 
载入 (燃油类型编辑窗口, , 真)

.子程序 _车颜色按钮_被单击, 空白型, , 
载入 (车颜色编辑窗口, , 真)

.子程序 _保险类型按钮_被单击, 空白型, , 
载入 (保险类型编辑窗口, , 真)

.子程序 _现行状态按钮_被单击, 空白型, , 
载入 (现行状态编辑窗口, , 真)

.子程序 _选择图片按钮_被单击, 空白型, , 
.如果真 (等于 (打开 (), 假))
    返回 ()
.如果真结束
赋值 (.图片, 读入文件 (.文件名))
赋值 (车图片, .文件名)

.子程序 _确定按钮_被单击, 空白型, , 
.判断开始 (等于 (试用限制 (), 真))
    提示信息 (“试用只能添加三辆车！”)
    销毁 ()
    返回 ()
.默认
    
.判断结束
.如果真 (等于 (.内容, “”))
    提示信息 (“车辆名称不可为空！”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    提示信息 (“车型不可为空！”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    提示信息 (“车牌号不可为空！”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    提示信息 (“车架号不可为空！”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    提示信息 (“发动机号不可为空！”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (车牌号非重复 (), 假))
    提示信息 (“车牌号已存在，不可重复！”)
    返回 ()
.如果真结束
.判断开始 (等于 (车辆信息编辑窗口., “xg”))
    .如果真 (等于 (执行SQL (相加 (“update clxx set clmc='”, .内容, “',cx='”, .内容, “',cph='”, .内容, “',cjh='”, .内容, “',fdjh='”, .内容, “',cys='”, .内容, “',rylx='”, .内容, “',bdh='”, .内容, “',bxlx='”, .内容, “',bxrq='”, 时间到格式文本 (.今天), “',tbrq='”, 时间到格式文本 (.今天), “',bxgs='”, .内容, “',yyh='”, .内容, “',gcsj='”, 时间到格式文本 (.今天), “',bfsj='”, 时间到格式文本 (.今天), “',whsj='”, 时间到格式文本 (.今天), “',rcwhsj='”, 时间到格式文本 (.今天), “',xxzt='”, .内容, “',tp='”, 车图片, “',lc=”, 到文本 (到数值 (.内容)), “ where id=”, 车辆信息窗口.取标题 (., 车辆信息窗口.., 19), “”)), 假))
        提示信息 (“操作失败！数据库可能有异！”)
        返回 ()
    .如果真结束
    车辆信息窗口.车辆信息填充列表 ()
    销毁 ()
.默认
    .如果真 (等于 (执行SQL (相加 (“insert into clxx (clmc,cx,cph,cjh,fdjh,cys,rylx,bdh,bxlx,bxrq,tbrq,bxgs,yyh,gcsj,bfsj,whsj,rcwhsj,xxzt,tp,lc) values ('”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, 时间到格式文本 (.今天), “','”, 时间到格式文本 (.今天), “','”, .内容, “','”, .内容, “','”, 时间到格式文本 (.今天), “','”, 时间到格式文本 (.今天), “','”, 时间到格式文本 (.今天), “','”, 时间到格式文本 (.今天), “','”, .内容, “','”, 车图片, “',”, 到文本 (到数值 (.内容)), “)”)), 假))
        提示信息 (“操作失败！数据库可能有异！”)
        返回 ()
    .如果真结束
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
    车辆信息窗口.车辆信息填充列表 ()
    
.判断结束


.子程序 车牌号非重复, 逻辑型, , 
赋值 (记录, 查数据 (相加 (“select count(*) from clxx where cph='”, .内容, “'”)))
 ' 判断 (车辆信息编辑窗口.标记 ＝ “xg”)
.判断开始 (或者 (等于 (主窗口.读 (., 记录, 1), 0), 等于 (.内容, 修改前车牌号)))
    返回 (真)
.默认
    返回 (假)
.判断结束
关记录 ()


.子程序 试用限制, 逻辑型, , 
赋值 (记录, 查数据 (“select count(*) from clxx”))
.判断开始 (大于或等于 (主窗口.读 (., 记录, 1), 3))
    返回 (真)
.默认
    返回 (假)
.判断结束
关记录 ()

.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()

.子程序 _清除图片按钮_被单击, 空白型, , 
赋值 (.图片, 读入文件 (“”))
赋值 (车图片, “”)

.子程序 _打开图片按钮_被单击, 空白型, , 
未知支持库函数_6 (#, 车图片, , )


.窗口程序集 燃油类型编辑窗口程序集, , , 

.子程序 _燃油类型编辑窗口_创建完毕, 空白型, , 
燃油类型填充列表 ()

.子程序 燃油类型填充列表, 空白型, , 
.局部变量 crwz, 整数型, , , 

赋值 (记录, 查数据 (“select * from rylx order by id”))
主窗口.到首记录 (., 记录)
全部删除 ()
赋值 (crwz, 0)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    crwz.插入表项 ()
    crwz.置标题 (0, 读数据 (记录, “rylx”))
    crwz.置标题 (1, 读数据 (记录, “id”))
    主窗口.到后一记录 (., 记录)
    赋值 (crwz, 相加 (crwz, 1))
.判断循环尾 ()
关记录 ()


.子程序 _添加按钮_被单击, 空白型, , 
.局部变量 rylx, 文本型, , , 

.如果真 (或者 (等于 (输入框 (“请输入燃油类型”, “请输入燃油类型”, , rylx, ), 假), 等于 (rylx, “”)))
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“insert into rylx(rylx) values ('”, rylx, “')”)), 假))
    提示信息 (“操作失败！数据库可能异常！”)
    返回 ()
.如果真结束
燃油类型填充列表 ()
车辆信息编辑窗口.燃油类型组合框填充 ()

.子程序 _修改按钮_被单击, 空白型, , 
.局部变量 rylx, 文本型, , , 

.如果真 (等于 (., -1))
    提示信息 (“请先在左表中选择要修改的燃油类型！”)
    返回 ()
.如果真结束
.如果真 (或者 (等于 (输入框 (“请输入燃油类型”, “请输入燃油类型”, .取标题 (., 0), rylx, ), 假), 等于 (rylx, “”)))
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“update rylx set rylx='”, rylx, “'where id=”, .取标题 (., 1), “”)), 假))
    提示信息 (“操作失败！数据库可能异常！”)
    返回 ()
.如果真结束
燃油类型填充列表 ()
车辆信息编辑窗口.燃油类型组合框填充 ()

.子程序 _删除按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    提示信息 (“请先在左表中选择要删除的燃油类型！”)
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“您是否确定要删除选中燃油类型？”, #是否钮, “提示”), #否钮))
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“delete from rylx where id=”, .取标题 (., 1), “”)), 假))
    提示信息 (“操作失败！数据库可能异常！”)
    返回 ()
.如果真结束
燃油类型填充列表 ()
车辆信息编辑窗口.燃油类型组合框填充 ()

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()


.窗口程序集 保险类型编辑窗口程序集, , , 

.子程序 _保险类型编辑窗口_创建完毕, 空白型, , 
保险类型填充列表 ()

.子程序 保险类型填充列表, 空白型, , 
.局部变量 crwz, 整数型, , , 

赋值 (记录, 查数据 (“select * from bxlx order by id”))
主窗口.到首记录 (., 记录)
全部删除 ()
赋值 (crwz, 0)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    crwz.插入表项 ()
    crwz.置标题 (0, 读数据 (记录, “bxlx”))
    crwz.置标题 (1, 读数据 (记录, “id”))
    主窗口.到后一记录 (., 记录)
    赋值 (crwz, 相加 (crwz, 1))
.判断循环尾 ()
关记录 ()

.子程序 _添加按钮_被单击, 空白型, , 
.局部变量 bxlx, 文本型, , , 

.如果真 (或者 (等于 (输入框 (“请输入保险类型”, “请输入保险类型”, , bxlx, ), 假), 等于 (bxlx, “”)))
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“insert into bxlx(bxlx) values ('”, bxlx, “')”)), 假))
    提示信息 (“操作失败！数据库可能异常！”)
    返回 ()
.如果真结束
保险类型填充列表 ()
车辆信息编辑窗口.保险类型组合框填充 ()

.子程序 _修改按钮_被单击, 空白型, , 
.局部变量 bxlx, 文本型, , , 

.如果真 (等于 (., -1))
    提示信息 (“请先在左表中选择要修改的保险类型！”)
    返回 ()
.如果真结束
.如果真 (或者 (等于 (输入框 (“请输入保险类型”, “请输入保险类型”, .取标题 (., 0), bxlx, ), 假), 等于 (bxlx, “”)))
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“update bxlx set bxlx='”, bxlx, “'where id=”, .取标题 (., 1), “”)), 假))
    提示信息 (“操作失败！数据库可能异常！”)
    返回 ()
.如果真结束
保险类型填充列表 ()
车辆信息编辑窗口.保险类型组合框填充 ()

.子程序 _删除按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    提示信息 (“请先在左表中选择要删除的保险类型！”)
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“您是否确定要删除选中保险类型？”, #是否钮, “提示”), #否钮))
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“delete from bxlx where id=”, .取标题 (., 1), “”)), 假))
    提示信息 (“操作失败！数据库可能异常！”)
    返回 ()
.如果真结束
保险类型填充列表 ()
车辆信息编辑窗口.保险类型组合框填充 ()

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()


.窗口程序集 现行状态编辑窗口程序集, , , 

.子程序 _现行状态编辑窗口_创建完毕, 空白型, , 
状态填充列表 ()

.子程序 状态填充列表, 空白型, , 
.局部变量 crwz, 整数型, , , 

赋值 (记录, 查数据 (“select * from zt order by id”))
主窗口.到首记录 (., 记录)
全部删除 ()
赋值 (crwz, 0)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    crwz.插入表项 ()
    crwz.置标题 (0, 读数据 (记录, “zt”))
    crwz.置标题 (1, 读数据 (记录, “id”))
    主窗口.到后一记录 (., 记录)
    赋值 (crwz, 相加 (crwz, 1))
.判断循环尾 ()
关记录 ()

.子程序 _添加按钮_被单击, 空白型, , 
.局部变量 zt, 文本型, , , 

.如果真 (或者 (等于 (输入框 (“请输入状态类型”, “请输入状态型”, , zt, ), 假), 等于 (zt, “”)))
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“insert into zt(zt) values ('”, zt, “')”)), 假))
    提示信息 (“操作失败！数据库可能异常！”)
    返回 ()
.如果真结束
状态填充列表 ()

.子程序 _修改按钮_被单击, 空白型, , 
.局部变量 zt, 文本型, , , 

.如果真 (等于 (., -1))
    提示信息 (“请先在左表中选择要修改的状态类型！”)
    返回 ()
.如果真结束
.如果真 (或者 (等于 (.取标题 (., 0), “可租”), 等于 (.取标题 (., 0), “维修保养”), 等于 (.取标题 (., 0), “预租”), 等于 (.取标题 (., 0), “租出”)))
    提示信息 (“系统内置信息，不可删除或修改！”)
    返回 ()
.如果真结束
.如果真 (或者 (等于 (输入框 (“请输入状态类型”, “请输入状态类型”, .取标题 (., 0), zt, ), 假), 等于 (zt, “”)))
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“update zt set zt='”, zt, “'where id=”, .取标题 (., 1), “”)), 假))
    提示信息 (“操作失败！数据库可能异常！”)
    返回 ()
.如果真结束
状态填充列表 ()

.子程序 _删除按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    提示信息 (“请先在左表中选择要删除的状态类型！”)
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“您是否确定要删除选状态类型？”, #是否钮, “提示”), #否钮))
    返回 ()
.如果真结束
.如果真 (或者 (等于 (.取标题 (., 0), “可租”), 等于 (.取标题 (., 0), “维修保养”), 等于 (.取标题 (., 0), “预租”), 等于 (.取标题 (., 0), “租出”)))
    提示信息 (“系统内置信息，不可删除或修改！”)
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“delete from zt where id=”, .取标题 (., 1), “”)), 假))
    提示信息 (“操作失败！数据库可能异常！”)
    返回 ()
.如果真结束
状态填充列表 ()

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()


.窗口程序集 车颜色编辑窗口程序集, , , 

.子程序 _车颜色编辑窗口_创建完毕, 空白型, , 
车颜色填充列表 ()

.子程序 车颜色填充列表, 空白型, , 
.局部变量 crwz, 整数型, , , 

赋值 (记录, 查数据 (“select * from cys order by id”))
主窗口.到首记录 (., 记录)
全部删除 ()
赋值 (crwz, 0)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    crwz.插入表项 ()
    crwz.置标题 (0, 读数据 (记录, “cys”))
    crwz.置标题 (1, 读数据 (记录, “id”))
    主窗口.到后一记录 (., 记录)
    赋值 (crwz, 相加 (crwz, 1))
.判断循环尾 ()
关记录 ()


.子程序 _添加按钮_被单击, 空白型, , 
.局部变量 cys, 文本型, , , 

.如果真 (或者 (等于 (输入框 (“请输入车颜色”, “请输入车颜色”, , cys, ), 假), 等于 (cys, “”)))
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“insert into cys(cys) values ('”, cys, “')”)), 假))
    提示信息 (“操作失败！数据库可能异常！”)
    返回 ()
.如果真结束
车颜色填充列表 ()
车辆信息编辑窗口.车颜色组合框填充 ()

.子程序 _修改按钮_被单击, 空白型, , 
.局部变量 cys, 文本型, , , 

.如果真 (等于 (., -1))
    提示信息 (“请先在左表中选择要修改的车颜色！”)
    返回 ()
.如果真结束
.如果真 (或者 (等于 (输入框 (“请输入车颜色”, “请输入车颜色”, .取标题 (., 0), cys, ), 假), 等于 (cys, “”)))
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“update cys set cys='”, cys, “'where id=”, .取标题 (., 1), “”)), 假))
    提示信息 (“操作失败！数据库可能异常！”)
    返回 ()
.如果真结束
车颜色填充列表 ()
车辆信息编辑窗口.车颜色组合框填充 ()

.子程序 _删除按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    提示信息 (“请先在左表中选择要删除的车颜色！”)
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“您是否确定要删除选中车颜色？”, #是否钮, “提示”), #否钮))
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“delete from cys where id=”, .取标题 (., 1), “”)), 假))
    提示信息 (“操作失败！数据库可能异常！”)
    返回 ()
.如果真结束
车颜色填充列表 ()
车颜色填充列表 ()
车辆信息编辑窗口.车颜色组合框填充 ()

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()


.窗口程序集 客人信息窗口程序集, , , 

.子程序 _客人信息窗口_创建完毕, 空白型, , 
客人信息填充列表 ()

.子程序 客人信息填充列表, 空白型, , 
.局部变量 crwz, 整数型, , , 

赋值 (记录, 查数据 (“select * from krxx order by id ”))
赋值 (crwz, 0)
主窗口.到首记录 (., 记录)
全部删除 ()
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    crwz.插入表项 ()
    crwz.置标题 (0, 读数据 (记录, “krmc”))
    crwz.置标题 (1, 读数据 (记录, “xb”))
    crwz.置标题 (2, 读数据 (记录, “sfzh”))
    crwz.置标题 (3, 读数据 (记录, “jszh”))
    crwz.置标题 (4, 读数据 (记录, “dyw”))
    crwz.置标题 (5, 读数据 (记录, “gddh”))
    crwz.置标题 (6, 读数据 (记录, “sjh”))
    crwz.置标题 (7, 读数据 (记录, “zz”))
    crwz.置标题 (8, 读数据 (记录, “gzdw”))
    crwz.置标题 (9, 读数据 (记录, “xgr”))
    crwz.置标题 (10, 读数据 (记录, “xgrdh”))
    crwz.置标题 (11, 读数据 (记录, “xgrdz”))
    crwz.置标题 (12, 读数据 (记录, “bz”))
    crwz.置标题 (13, 读数据 (记录, “hmd”))
    crwz.置标题 (14, 读数据 (记录, “id”))
    主窗口.到后一记录 (., 记录)
    赋值 (crwz, 相加 (crwz, 1))
.判断循环尾 ()
关记录 ()

.子程序 _添加按钮_被单击, 空白型, , 
赋值 (客人信息编辑窗口., “tj”)
载入 (客人信息编辑窗口, , 真)


.子程序 _修改按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    提示信息 (“请先在下表选择您要修改的客人信息！”)
    返回 ()
.如果真结束
赋值 (客人信息编辑窗口., “xg”)
载入 (客人信息编辑窗口, , 真)


.子程序 _删除按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    提示信息 (“请先在下表选择您要删除的客人信息！”)
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“是否确定删除选中客人信息？”, #是否钮, “提示”), #否钮))
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“delete from krxx where id=”, .取标题 (., 14), “”)), 假))
    提示信息 (“操作失败！数据库可能有异！”)
    返回 ()
.如果真结束
客人信息填充列表 ()

.子程序 _加入黑名单按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    提示信息 (“请先在下表选择您要加入黑名单的客人信息！”)
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“是否确定将选中客人加入黑名单？”, #是否钮, “提示”), #否钮))
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“update krxx set hmd='是' where id=”, .取标题 (., 14), “”)), 假))
    提示信息 (“操作失败！数据库可能有异！”)
    返回 ()
.如果真结束
客人信息填充列表 ()

.子程序 _加入黑名单按钮1_被单击, 空白型, , 
.如果真 (等于 (., -1))
    提示信息 (“请先在下表选择您要排除黑名单的客人信息！”)
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“是否确定将选中客人排除黑名单？”, #是否钮, “提示”), #否钮))
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“update krxx set hmd='否' where id=”, .取标题 (., 14), “”)), 假))
    提示信息 (“操作失败！数据库可能有异！”)
    返回 ()
.如果真结束
客人信息填充列表 ()

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _超级列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (等于 (客人信息窗口., “”))
    _修改按钮_被单击 ()
.判断 (等于 (客人信息窗口., “出租调用”))
    .如果真 (等于 (.取标题 (., 13), “是”))
        .如果真 (等于 (信息框 (“选中客人已被加入黑名单，是否继续操作？”, #是否钮, “提示”), #否钮))
            销毁 ()
            返回 ()
        .如果真结束
        
    .如果真结束
    赋值 (车辆出租编辑窗口..内容, .取标题 (., 0))
    赋值 (车辆出租编辑窗口..内容, .取标题 (., 14))
    销毁 ()
.默认
    
.判断结束


.窗口程序集 客人信息编辑窗口程序集, , , 

.程序集变量 黑名单, 文本型, , , 
.程序集变量 客人相片, 文本型, , , 
.子程序 _客人信息编辑窗口_创建完毕, 空白型, , 
.判断开始 (等于 (客人信息编辑窗口., “xg”))
    客人信息修改预处理 ()
.默认
    赋值 (黑名单, “否”)
.判断结束


.子程序 试用限制1, 逻辑型, , 
赋值 (记录, 查数据 (“select count(*) from krxx”))
.判断开始 (大于或等于 (主窗口.读 (., 记录, 1), 3))
    
    返回 (真)
.默认
    返回 (假)
.判断结束


.子程序 客人信息修改预处理, 空白型, , 
赋值 (记录, 查数据 (相加 (“select * from krxx where id=”, 客人信息窗口.取标题 (., 客人信息窗口.., 14), “”)))
赋值 (.内容, 读数据 (记录, “krmc”))
赋值 (.现行选中项, 文本取组合框选项 (读数据 (记录, “xb”)))
赋值 (.内容, 读数据 (记录, “sfzh”))
赋值 (.内容, 读数据 (记录, “jszh”))
赋值 (.内容, 读数据 (记录, “dyw”))
赋值 (.内容, 读数据 (记录, “gddh”))
赋值 (.内容, 读数据 (记录, “sjh”))
赋值 (.内容, 读数据 (记录, “zz”))
赋值 (.内容, 读数据 (记录, “gzdw”))
赋值 (.内容, 读数据 (记录, “xgr”))
赋值 (.内容, 读数据 (记录, “xgrdh”))
赋值 (.内容, 读数据 (记录, “xgrdz”))
赋值 (.内容, 读数据 (记录, “bz”))
.判断开始 (等于 (读数据 (记录, “hmd”), “是”))
    赋值 (.选中, 真)
    赋值 (.选中, 假)
.默认
    赋值 (.选中, 真)
    赋值 (.选中, 假)
.判断结束
 ' 调试输出 (读数据 (记录, “krxp”))
赋值 (客人相片, 读数据 (记录, “krxp”))
赋值 (.图片, 读入文件 (客人相片))
关记录 ()

.子程序 _确定按钮_被单击, 空白型, , 
.局部变量 原名称, 文本型, , , 

.判断开始 (等于 (试用限制1 (), 真))
    提示信息 (“试用只能添加三位客人！”)
    销毁 ()
    返回 ()
.默认
    
.判断结束

.如果真 (等于 (客人信息编辑窗口., “xg”))
    赋值 (原名称, .内容)
.如果真结束
赋值 (记录, 查数据 (相加 (“select * from krxx where krmc='”, .内容, “'”)))
.如果真 (并且 (不等于 (读数据 (记录, “krmc”), “”), 不等于 (.内容, “”), 不等于 (.内容, 原名称)))
    提示信息 (“该名称已经存在，请确认是复重复，如确实同名，请自行更名区分！”)
    获取焦点 ()
    返回 ()
    关记录 ()
.如果真结束
关记录 ()
.如果真 (等于 (.内容, “”))
    提示信息 (“客人名称不可为空！”)
    获取焦点 ()
    返回 ()
.如果真结束
.判断开始 (等于 (客人信息编辑窗口., “xg”))
    .如果真 (等于 (执行SQL (相加 (“update krxx set krmc='”, .内容, “',xb='”, .取项目文本 (.现行选中项), “',sfzh='”, .内容, “',jszh='”, .内容, “',dyw='”, .内容, “',gddh='”, .内容, “',sjh='”, .内容, “',zz='”, .内容, “',gzdw='”, .内容, “',xgr='”, .内容, “',xgrdh='”, .内容, “',xgrdz='”, .内容, “',bz='”, .内容, “',hmd='”, 黑名单, “',krxp='”, 客人相片, “'where id=”, 客人信息窗口.取标题 (., 客人信息窗口.., 14), “”)), 假))
        提示信息 (“操作失败！数据库可能异常！”)
        返回 ()
    .如果真结束
    客人信息窗口.客人信息填充列表 ()
    销毁 ()
.默认
    .如果真 (等于 (执行SQL (相加 (“insert into krxx(krmc,xb,sfzh,jszh,dyw,gddh,sjh,zz,gzdw,xgr,xgrdh,xgrdz,bz,hmd,krxp)values('”, .内容, “','”, .取项目文本 (.现行选中项), “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, 黑名单, “','”, 客人相片, “')”)), 假))
        提示信息 (“操作失败！数据库可能有异！”)
        返回 ()
    .如果真结束
    客人信息窗口.客人信息填充列表 ()
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
    赋值 (.现行选中项, 2)
    赋值 (.选中, 真)
    赋值 (黑名单, “否”)
    赋值 (.选中, 假)
.判断结束



.子程序 _是单选框_被单击, 空白型, , 
.判断开始 (等于 (.选中, 真))
    赋值 (黑名单, “是”)
.默认
    
.判断结束


.子程序 _否单选框_被单击, 空白型, , 
.判断开始 (等于 (.选中, 真))
    赋值 (黑名单, “否”)
.默认
    
.判断结束


.子程序 _客人名称编辑框_失去焦点, 空白型, , 


.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()


.子程序 _选择图片按钮_被单击, 空白型, , 
.局部变量 目录, 文本型, , , 

赋值 (目录, 读配置项 (相加 (取运行目录 (), “\data\sys.ini”), “客户照片”, “保存位置”, ))
调试输出 (目录)
.判断开始 (等于 (目录, “”))
    赋值 (.初始目录, 相加 (取运行目录 (), “\files\”))
.默认
    赋值 (.初始目录, 相加 (目录, “\”))
.判断结束
.如果真 (等于 (打开 (), 真))
    赋值 (.图片, 读入文件 (.文件名))
    赋值 (客人相片, .文件名)
.如果真结束


.子程序 _清除图片按钮_被单击, 空白型, , 
赋值 (.图片, 读入文件 (“”))
赋值 (客人相片, “”)

.子程序 _打开图片按钮_被单击, 空白型, , 
未知支持库函数_6 (4, 客人相片, , )


.窗口程序集 出租窗口程序集, , , 

.子程序 _出租管理窗口_创建完毕, 空白型, , 
租车客人填充列表 ()

.子程序 租车客人填充列表, 空白型, , 
.局部变量 crwz, 整数型, , , 

赋值 (记录, 查数据 (“select czxx.id,czxx.krid,krxx.id,krxx.krmc,krxx.xb,krxx.sfzh,krxx.jszh,krxx.dyw,krxx.gddh,krxx.sjh,krxx.zz,krxx.gzdw,krxx.xgr,krxx.xgrdh,krxx.xgrdz,krxx.bz,krxx.hmd  from czxx,krxx  where krxx.id = czxx.krid ”))
调试输出 (记录)
主窗口.到首记录 (., 记录)
全部删除 ()
赋值 (crwz, 0)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    crwz.插入表项 ()
    crwz.置标题 (0, 读数据 (记录, “krmc”))
    crwz.置标题 (1, 读数据 (记录, “xb”))
    crwz.置标题 (2, 读数据 (记录, “sfzh”))
    crwz.置标题 (3, 读数据 (记录, “jszh”))
    crwz.置标题 (4, 读数据 (记录, “dyw”))
    crwz.置标题 (5, 读数据 (记录, “gddh”))
    crwz.置标题 (6, 读数据 (记录, “sjh”))
    crwz.置标题 (7, 读数据 (记录, “zz”))
    crwz.置标题 (8, 读数据 (记录, “gzdw”))
    crwz.置标题 (9, 读数据 (记录, “xgr”))
    crwz.置标题 (10, 读数据 (记录, “xgrdh”))
    crwz.置标题 (11, 读数据 (记录, “xgrdz”))
    crwz.置标题 (12, 读数据 (记录, “bz”))
    crwz.置标题 (13, 读数据 (记录, “hmd”))
    crwz.置标题 (14, 到文本 (主窗口.读 (., 记录, 1)))
    主窗口.到后一记录 (., 记录)
    赋值 (crwz, 相加 (crwz, 1))
.判断循环尾 ()
关记录 ()

.子程序 _添加按钮_被单击, 空白型, , 
赋值 (车辆出租编辑窗口., “tjcz”)
载入 (车辆出租编辑窗口, , 真)

.子程序 _超级列表框1_当前表项被改变, 空白型, , 
.局部变量 crwz, 整数型, , , 

赋值 (记录, 查数据 (相加 (“select czxx.id,czxx.cid,clxx.clmc,clxx.cx,clxx.cph,clxx.cjh,clxx.fdjh,clxx.cys,clxx.rylx,clxx.bdh,clxx.bxlx,clxx.bxrq,clxx.tbrq,clxx.bxgs,clxx.yyh,clxx.gcsj,clxx.bfsj,clxx.whsj,clxx.rcwhsj,clxx.xxzt  from czxx,clxx where czxx.cid=clxx.id and czxx.id=”, .取标题 (., 14), “”)))
主窗口.到首记录 (., 记录)
全部删除 ()
赋值 (crwz, 0)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    crwz.插入表项 ()
    crwz.置标题 (0, 读数据 (记录, “clmc”))
    crwz.置标题 (1, 读数据 (记录, “cx”))
    crwz.置标题 (2, 读数据 (记录, “cph”))
    crwz.置标题 (3, 读数据 (记录, “cjh”))
    crwz.置标题 (4, 读数据 (记录, “fdjh”))
    crwz.置标题 (5, 读数据 (记录, “cys”))
    crwz.置标题 (6, 读数据 (记录, “rylx”))
    crwz.置标题 (7, 读数据 (记录, “bdh”))
    crwz.置标题 (8, 读数据 (记录, “bxlx”))
    crwz.置标题 (9, 读数据 (记录, “bxrq”))
    crwz.置标题 (10, 读数据 (记录, “tbrq”))
    crwz.置标题 (11, 读数据 (记录, “bxgs”))
    crwz.置标题 (12, 读数据 (记录, “yyh”))
    crwz.置标题 (13, 读数据 (记录, “gcsj”))
    crwz.置标题 (14, 读数据 (记录, “bfsj”))
    crwz.置标题 (15, 读数据 (记录, “whsj”))
    crwz.置标题 (16, 读数据 (记录, “rcwhsj”))
    crwz.置标题 (17, 读数据 (记录, “xxzt”))
    crwz.置标题 (18, 读数据 (记录, “id”))
    主窗口.到后一记录 (., 记录)
    赋值 (crwz, 相加 (crwz, 1))
.判断循环尾 ()
关记录 ()
赋值 (记录, 查数据 (相加 (“select * from czxx where id=”, .取标题 (., 14), “”)))
赋值 (.标题, 读数据 (记录, “zcsj”))
赋值 (.标题, 读数据 (记录, “hcsj”))
赋值 (.标题, 到文本 (到数值 (读数据 (记录, “yjyf”))))
赋值 (.标题, 到文本 (到数值 (读数据 (记录, “ysje”))))
赋值 (.标题, 到文本 (到数值 (读数据 (记录, “yhje”))))
赋值 (.标题, 到文本 (到数值 (读数据 (记录, “ssje”))))
赋值 (.标题, 读数据 (记录, “jsr”))
.判断开始 (等于 (读数据 (记录, “yqxy”), “是”))
    赋值 (.选中, 真)
.默认
    赋值 (.选中, 假)
.判断结束
.判断开始 (等于 (读数据 (记录, “yjtc”), “是”))
    赋值 (.选中, 真)
.默认
    赋值 (.选中, 假)
.判断结束
.判断开始 (等于 (读数据 (记录, “yjhc”), “是”))
    赋值 (.选中, 真)
.默认
    赋值 (.选中, 假)
.判断结束
赋值 (.标题, 读数据 (记录, “bz”))
关记录 ()

.子程序 _修改按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    提示信息 (“请先在客人信息表格中选择您要修改的客人租车信息！”)
    返回 ()
.如果真结束
赋值 (车辆出租编辑窗口., “xgcz”)
载入 (车辆出租编辑窗口, , 真)


.子程序 _续租按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    提示信息 (“请先在客人信息表格中选择您要续租的客人租车信息！”)
    返回 ()
.如果真结束
赋值 (记录, 查数据 (相加 (“select * from czxx where id=”, .取标题 (., 14))))
.判断开始 (等于 (读数据 (记录, “yjhc”), “是”))
    提示信息 (“此车已还！如还需出租请重新租出车辆！”)
    关记录 ()
    返回 ()
.默认
    关记录 ()
    赋值 (车辆出租编辑窗口., “xz”)
    载入 (车辆出租编辑窗口, , 真)
    
.判断结束



.子程序 _还车按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    提示信息 (“请先在客人信息表格中选择您要还车的客人租车信息！”)
    返回 ()
.如果真结束
赋值 (记录, 查数据 (相加 (“select * from czxx where id=”, .取标题 (., 14))))
.判断开始 (等于 (读数据 (记录, “yjhc”), “是”))
    提示信息 (“此车已还！”)
    关记录 ()
    返回 ()
.默认
    关记录 ()
    赋值 (车辆出租编辑窗口., “hc”)
    载入 (车辆出租编辑窗口, , 真)
    
.判断结束


.子程序 _删除按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    提示信息 (“请先在客人信息表格中选择您要删除的客人租车信息！”)
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“是否确定要删除选中的客人租车信息！”, #是否钮, “提示”), #否钮))
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“delete * from czxx where id=”, .取标题 (., 14))), 假))
    提示信息 (“操作失败！数据库可能异常！”)
    返回 ()
.如果真结束
租车客人填充列表 ()
全部删除 ()


.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()


.子程序 _超级列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (车辆出租编辑窗口., “ck”)
载入 (车辆出租编辑窗口, , 真)


.窗口程序集 车辆出租编辑窗口程序集, , , 

.程序集变量 租车时, 逻辑型, , , 
.程序集变量 租车分, 逻辑型, , , 
.程序集变量 还车时, 逻辑型, , , 
.程序集变量 状态, 文本型, , , 
.程序集变量 还车分, 逻辑型, , , 
.子程序 _车辆出租编辑窗口_创建完毕, 空白型, , 
经手人组合填充 ()
.判断开始 (等于 (车辆出租编辑窗口., “tjcz”))
    赋值 (.选中, 假)
    连续赋值 (真, .禁止, .禁止)
    赋值 (.内容, 到文本 (取时间部分 (取现行时间 (), #小时)))
    赋值 (.内容, 到文本 (取时间部分 (取现行时间 (), #分钟)))
    赋值 (.内容, 到文本 (取时间部分 (取现行时间 (), #小时)))
    赋值 (.内容, 到文本 (取时间部分 (取现行时间 (), #分钟)))
.判断 (等于 (车辆出租编辑窗口., “xgcz”))
    连续赋值 (真, .禁止, .禁止)
     ' 读出租还车时间 ()
    修改出租预处理 ()
.判断 (等于 (车辆出租编辑窗口., “xz”))
    赋值 (.选中, 真)
    赋值 (.选中, 真)
    赋值 (.选中, 假)
    修改出租预处理 ()
     ' 读出租还车时间 ()
    连续赋值 (真, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
.判断 (等于 (车辆出租编辑窗口., “hc”))
    修改出租预处理 ()
    连续赋值 (真, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
    赋值 (.选中, 真)
    赋值 (.选中, 真)
    赋值 (.选中, 真)
.判断 (等于 (车辆出租编辑窗口., “ck”))
    修改出租预处理 ()
    连续赋值 (真, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
.默认
    
.判断结束


.子程序 读出租还车时间, 空白型, , 
赋值 (记录, 查数据 (相加 (“select * from czxx where id=”, 出租管理窗口.取标题 (., 出租管理窗口.., 14))))
赋值 (.内容, 取文本左边 (读数据 (记录, “zc_sj”), 2))
赋值 (.内容, 取文本右边 (读数据 (记录, “zc_sj”), 2))
赋值 (.内容, 取文本左边 (读数据 (记录, “hc_sj”), 2))
赋值 (.内容, 取文本右边 (读数据 (记录, “hc_sj”), 2))
关记录 ()

.子程序 修改出租预处理, 空白型, , 
 ' 客人部份
赋值 (记录, 查数据 (相加 (“select czxx.krid,krxx.krmc,krxx.sfzh,krxx.jszh,krxx.gddh,krxx.sjh ,krxx.zz from czxx,krxx where krxx.id=czxx.krid and czxx.id=”, 出租管理窗口.取标题 (., 出租管理窗口.., 14), “”)))

赋值 (.内容, 读数据 (记录, “krid”))
关记录 ()
 ' 车部份
赋值 (记录, 查数据 (相加 (“select czxx.cid,clxx.clmc,clxx.cx,clxx.cph,clxx.cjh,clxx.fdjh from czxx,clxx  where clxx.id=czxx.cid and czxx.id=”, 出租管理窗口.取标题 (., 出租管理窗口.., 14), “”)))
赋值 (.内容, 读数据 (记录, “cid”))
关记录 ()
 ' 出租信息部份
赋值 (记录, 查数据 (相加 (“select * from czxx where id=”, 出租管理窗口.取标题 (., 出租管理窗口.., 14))))
赋值 (.今天, 到时间 (读数据 (记录, “zcsj”)))
赋值 (.今天, 到时间 (读数据 (记录, “hcsj”)))
赋值 (.内容, 到文本 (到数值 (读数据 (记录, “ysje”))))
赋值 (.内容, 到文本 (到数值 (读数据 (记录, “yjyf”))))
赋值 (.内容, 到文本 (到数值 (读数据 (记录, “yhje”))))
赋值 (.内容, 到文本 (到数值 (读数据 (记录, “ssje”))))
赋值 (.内容, 到文本 (到数值 (读数据 (记录, “thje”))))
赋值 (.内容, 到文本 (到数值 (读数据 (记录, “sqje”))))
赋值 (.内容, 到文本 (到数值 (读数据 (记录, “hclc”))))
赋值 (.内容, 到文本 (到数值 (读数据 (记录, “zqlc”))))
赋值 (.内容, 读数据 (记录, “jsr”))
赋值 (.内容, 读数据 (记录, “bz”))
.判断开始 (等于 (读数据 (记录, “yqxy”), “是”))
    赋值 (.选中, 真)
.默认
    赋值 (.选中, 假)
.判断结束
.判断开始 (等于 (读数据 (记录, “yjtc”), “是”))
    赋值 (.选中, 真)
.默认
    赋值 (.选中, 假)
.判断结束
.判断开始 (等于 (读数据 (记录, “yjhc”), “是”))
    赋值 (.选中, 真)
.默认
    赋值 (.选中, 假)
.判断结束
关记录 ()
读出租还车时间 ()

.子程序 经手人组合填充, 空白型, , 
赋值 (记录, 查数据 (“select * from jsr order by id ”))
清空 ()
主窗口.到首记录 (., 记录)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    读数据 (记录, “jsr”).加入项目 ()
    主窗口.到后一记录 (., 记录)
.判断循环尾 ()
关记录 ()

.子程序 _客人选择按钮_被单击, 空白型, , 
赋值 (客人信息窗口., “出租调用”)
载入 (客人信息窗口, , 真)

.子程序 _客人id_内容被改变, 空白型, , 
.局部变量 记录1, 整数型, , , 

赋值 (记录1, 查数据 (相加 (“select * from krxx where id=”, .内容, “”)))
赋值 (.内容, 读数据 (记录1, “krmc”))
赋值 (.内容, 读数据 (记录1, “sfzh”))
赋值 (.内容, 读数据 (记录1, “jszh”))
赋值 (.内容, 读数据 (记录1, “gddh”))
赋值 (.内容, 读数据 (记录1, “sjh”))
主窗口.关闭记录集 (., 记录1)

.子程序 _车辆选择按钮_被单击, 空白型, , 
赋值 (车辆信息窗口., “出租调用”)
载入 (车辆信息窗口, , 真)

.子程序 _车id_内容被改变, 空白型, , 
.局部变量 记录1, 整数型, , , 

赋值 (记录1, 查数据 (相加 (“select * from clxx where id=”, .内容, “”)))
赋值 (.内容, 读数据 (记录1, “clmc”))
赋值 (.内容, 读数据 (记录1, “cx”))
赋值 (.内容, 读数据 (记录1, “cph”))
赋值 (.内容, 读数据 (记录1, “fdjh”))
赋值 (.内容, 读数据 (记录1, “cjh”))
主窗口.关闭记录集 (., 记录1)

.子程序 _经手人按钮_被单击, 空白型, , 
赋值 (经手人信息窗口., “cz”)
载入 (经手人信息窗口, , 真)

.子程序 _确定按钮_被单击, 空白型, , 
.局部变量 已签协议, 文本型, , , 
.局部变量 已经提车, 文本型, , , 
.局部变量 已经还车, 文本型, , , 

.判断开始 (等于 (车辆出租编辑窗口., “tjcz”))
    赋值 (状态, “预租”)
    .判断开始 (等于 (.选中, 真))
        赋值 (已签协议, “是”)
    .默认
        赋值 (已签协议, “否”)
    .判断结束
    .判断开始 (等于 (.选中, 真))
        赋值 (已经提车, “是”)
        赋值 (状态, “租出”)
    .默认
        赋值 (已经提车, “否”)
    .判断结束
    .判断开始 (等于 (.选中, 真))
        赋值 (已经还车, “是”)
        赋值 (状态, “可租”)
    .默认
        赋值 (已经还车, “否”)
    .判断结束
    
    主窗口.启动事务 (.)
    .如果真 (等于 (执行SQL (相加 (“insert into czxx(krid,cid,zcsj,hcsj,yjyf,ysje,yhje,ssje,thje,sqje,jsr,bz,yqxy,yjtc,yjhc,zc_sj,hc_sj,zqlc,hclc,bclc)values(”, .内容, “,”, .内容, “,'”, 时间到格式文本 (.今天), “','”, 时间到格式文本 (.今天), “',”, 到文本 (到数值 (.内容)), “,”, 到文本 (到数值 (.内容)), “,”, 到文本 (到数值 (.内容)), “,”, 到文本 (到数值 (.内容)), “,”, 到文本 (到数值 (.内容)), “,”, 到文本 (到数值 (.内容)), “,'”, .内容, “','”, .内容, “','”, 已签协议, “','”, 已经提车, “','”, 已经还车, “','”, .内容, .内容, “','”, .内容, .内容, “',”, 到文本 (到数值 (.内容)), “,”, 到文本 (到数值 (.内容)), “,”, 到文本 (到数值 (.内容)), “)”)), 假))
        提示信息 (“操作失败！数据库可能异常！1”)
        主窗口.回滚事务 (.)
        返回 ()
    .如果真结束
    .如果真 (等于 (执行SQL (相加 (“update clxx set xxzt='”, 状态, “'where id=”, .内容, “”)), 假))
        提示信息 (“操作失败！数据库可能异常！2”)
        主窗口.回滚事务 (.)
        返回 ()
    .如果真结束
    主窗口.提交事务 (.)
    出租管理窗口.租车客人填充列表 ()
    销毁 ()
.判断 (或者 (等于 (车辆出租编辑窗口., “xgcz”), 等于 (车辆出租编辑窗口., “xz”), 等于 (车辆出租编辑窗口., “hc”)))
    .判断开始 (等于 (.选中, 真))
        赋值 (已签协议, “是”)
    .默认
        赋值 (已签协议, “否”)
    .判断结束
    .判断开始 (等于 (.选中, 真))
        赋值 (已经提车, “是”)
        赋值 (状态, “租出”)
    .默认
        赋值 (已经提车, “否”)
    .判断结束
    .判断开始 (等于 (.选中, 真))
        赋值 (已经还车, “是”)
        赋值 (状态, “可租”)
    .默认
        赋值 (已经还车, “否”)
    .判断结束
    .如果真 (等于 (车辆出租编辑窗口., “hc”))
        .如果真 (等于 (.内容, “”))
            提示信息 (“实收金额不可为空！”)
            返回 ()
        .如果真结束
        .如果真 (等于 (信息框 (相加 (“应收金额： ”, 到文本 (到数值 (.内容)), “ 已交预付： ”, 到文本 (到数值 (.内容)), “ 优惠金额： ”, .内容, “ 实收金额： ”, 到文本 (到数值 (.内容)), “ 退回金额： ”, 到文本 (到数值 (.内容)), “ 尚欠金额： ”, 到文本 (到数值 (.内容)), “ 是否已确定各项收费？确定还车结帐吗？”), #是否钮, “提示”), #否钮))
            返回 ()
        .如果真结束
        .如果真 (或者 (大于 (到数值 (.内容), 到数值 (.内容)), 小于或等于 (到数值 (.内容), 0)))
            提示信息 (“里程数有误!”)
            获取焦点 ()
            返回 ()
        .如果真结束
        
    .如果真结束
    主窗口.启动事务 (.)
    .如果真 (等于 (执行SQL (相加 (“update czxx set krid='”, .内容, “',cid='”, .内容, “',zcsj='”, 时间到格式文本 (.今天), “',hcsj='”, 时间到格式文本 (.今天), “',yjyf=”, 到文本 (到数值 (.内容)), “,ysje=”, 到文本 (到数值 (.内容)), “,yhje=”, 到文本 (到数值 (.内容)), “,ssje=”, 到文本 (到数值 (.内容)), “,thje=”, 到文本 (到数值 (.内容)), “,sqje=”, 到文本 (到数值 (.内容)), “,jsr='”, .内容, “',bz='”, .内容, “',yqxy='”, 已签协议, “',yjtc='”, 已经提车, “',yjhc='”, 已经还车, “',zc_sj='”, .内容, .内容, “',hc_sj='”, .内容, .内容, “',zqlc=”, 到文本 (到数值 (.内容)), “,hclc=”, 到文本 (到数值 (.内容)), “,bclc=”, 到文本 (到数值 (.内容)), “ where id=”, 出租管理窗口.取标题 (., 出租管理窗口.., 14), “”)), 假))
        主窗口.回滚事务 (.)
        提示信息 (“操作失败！数据库可能异常！1”)
        返回 ()
    .如果真结束
    .如果真 (等于 (执行SQL (相加 (“update clxx set xxzt='”, 状态, “',lc=”, 到文本 (到数值 (.内容)), “ where id=”, .内容, “”)), 假))
        提示信息 (“操作失败！数据库可能异常！2”)
        主窗口.回滚事务 (.)
        返回 ()
    .如果真结束
    主窗口.提交事务 (.)
    出租管理窗口.租车客人填充列表 ()
    销毁 ()
.默认
    
.判断结束


.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()


.子程序 _租车时编辑框_内容被改变, 空白型, , 
.判断开始 (大于 (到数值 (.内容), 23))
    赋值 (.内容, “00”)
.判断 (小于 (到数值 (.内容), 0))
    赋值 (.内容, “23”)
.判断 (小于 (取文本长度 (.内容), 2))
    赋值 (.内容, 相加 (“0”, 取文本右边 (.内容, 1)))
.默认
    
.判断结束


.子程序 _还车时编辑框_内容被改变, 空白型, , 
.判断开始 (大于 (到数值 (.内容), 23))
    赋值 (.内容, “00”)
.判断 (小于 (到数值 (.内容), 0))
    赋值 (.内容, “23”)
.判断 (小于 (取文本长度 (.内容), 2))
    赋值 (.内容, 相加 (“0”, 取文本右边 (.内容, 1)))
.默认
    
.判断结束


.子程序 _租车分编辑框_内容被改变, 空白型, , 
.判断开始 (大于 (到数值 (.内容), 59))
    赋值 (.内容, “00”)
    赋值 (.内容, 到文本 (相加 (到数值 (.内容), 1)))
.判断 (小于 (到数值 (.内容), 0))
    赋值 (.内容, “59”)
.判断 (小于 (取文本长度 (.内容), 2))
    赋值 (.内容, 相加 (“0”, 取文本右边 (.内容, 1)))
.默认
    
.判断结束


.子程序 _还车分编辑框_内容被改变, 空白型, , 
.判断开始 (大于 (到数值 (.内容), 59))
    赋值 (.内容, “00”)
    赋值 (.内容, 到文本 (相加 (到数值 (.内容), 1)))
.判断 (小于 (到数值 (.内容), 0))
    赋值 (.内容, “59”)
.判断 (小于 (取文本长度 (.内容), 2))
    赋值 (.内容, 相加 (“0”, 取文本右边 (.内容, 1)))
    
.默认
    
.判断结束


.子程序 _租车调节器_调节钮被按下, 空白型, , 
.参数 按钮值, 整数型, , 

.判断开始 (等于 (租车分, 真))
    获取焦点 ()
    赋值 (.内容, 到文本 (相加 (到数值 (.内容), 按钮值)))
.默认
    获取焦点 ()
    赋值 (.内容, 到文本 (相加 (到数值 (.内容), 按钮值)))
.判断结束


.子程序 _还车调节器_调节钮被按下, 空白型, , 
.参数 按钮值, 整数型, , 

.判断开始 (等于 (还车分, 真))
    获取焦点 ()
    赋值 (.内容, 到文本 (相加 (到数值 (.内容), 按钮值)))
.默认
    获取焦点 ()
    赋值 (.内容, 到文本 (相加 (到数值 (.内容), 按钮值)))
.判断结束


.子程序 _租车时编辑框_获得焦点, 空白型, , 
赋值 (租车时, 真)
赋值 (租车分, 假)


.子程序 _租车分编辑框_获得焦点, 空白型, , 
赋值 (租车分, 真)
赋值 (租车时, 假)


.子程序 _还车时编辑框_获得焦点, 空白型, , 
赋值 (还车时, 真)
赋值 (还车分, 假)

.子程序 _还车分编辑框_获得焦点, 空白型, , 
赋值 (还车分, 真)
赋值 (还车时, 假)

.子程序 _查看违章按钮_被单击, 空白型, , 
赋值 (违章管理窗口., “czck”)
载入 (违章管理窗口, , 真)

.子程序 _车辆名称编辑框_内容被改变, 空白型, , 
读租前里程 ()

.子程序 读租前里程, 空白型, , 
.局部变量 记录1, 整数型, , , 

赋值 (记录1, 查数据 (相加 (“select * from clxx where id=”, .内容, “”)))
赋值 (.内容, 读数据 (记录1, “lc”))
主窗口.关闭记录集 (., 记录1)

.子程序 算本次里程, 空白型, , 
赋值 (.内容, 到文本 (相减 (到数值 (.内容), 到数值 (.内容))))
.判断开始 (小于或等于 (到数值 (.内容), 0))
    赋值 (.内容, “0”)
.默认
    
.判断结束


.子程序 _租前里程编辑框_内容被改变, 空白型, , 
算本次里程 ()

.子程序 _还车里程编辑框_内容被改变, 空白型, , 
算本次里程 ()


.窗口程序集 经手人信息窗口程序集, , , 

.子程序 _经手人信息窗口_创建完毕, 空白型, , 
经手人填充列表 ()

.子程序 经手人填充列表, 空白型, , 
.局部变量 crwz, 整数型, , , 

赋值 (记录, 查数据 (“select * from jsr order by id”))
主窗口.到首记录 (., 记录)
全部删除 ()
赋值 (crwz, 0)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    crwz.插入表项 ()
    crwz.置标题 (0, 读数据 (记录, “jsr”))
    crwz.置标题 (1, 读数据 (记录, “gddh”))
    crwz.置标题 (2, 读数据 (记录, “sjh”))
    crwz.置标题 (3, 读数据 (记录, “dz”))
    crwz.置标题 (4, 读数据 (记录, “id”))
    主窗口.到后一记录 (., 记录)
    赋值 (crwz, 相加 (crwz, 1))
.判断循环尾 ()
关记录 ()

.子程序 _添加按钮_被单击, 空白型, , 
赋值 (经手人编辑窗口., “tj”)
载入 (经手人编辑窗口, , 真)

.子程序 _修改按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    提示信息 (“请先在左表中选择您要修改的经手人信息！”)
    返回 ()
.如果真结束
赋值 (经手人编辑窗口., “xg”)
载入 (经手人编辑窗口, , 真)


.子程序 _删除按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    提示信息 (“请先在左表中选择您要删除的经手人信息！”)
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“是否确定要删除选中经手人信息？”, #是否钮, “提示”), #否钮))
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“delete from jsr where id=”, .取标题 (., 4), “”)), 假))
    提示信息 (“操作失败！数据库可能异常！”)
    返回 ()
.如果真结束
经手人填充列表 ()


.窗口程序集 经手人编辑窗口程序集, , , 

.子程序 _经手人编辑窗口_创建完毕, 空白型, , 
.判断开始 (等于 (经手人编辑窗口., “xg”))
    修改预处理 ()
.默认
    
.判断结束


.子程序 修改预处理, 空白型, , 
赋值 (.内容, 经手人信息窗口.取标题 (., 经手人信息窗口.., 0))
赋值 (.内容, 经手人信息窗口.取标题 (., 经手人信息窗口.., 1))
赋值 (.内容, 经手人信息窗口.取标题 (., 经手人信息窗口.., 2))
赋值 (.内容, 经手人信息窗口.取标题 (., 经手人信息窗口.., 3))

.子程序 _按钮1_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    提示信息 (“经手人名称不可为空！”)
    返回 ()
.如果真结束
.判断开始 (等于 (经手人编辑窗口., “xg”))
    .如果真 (等于 (执行SQL (相加 (“update jsr set jsr='”, .内容, “',gddh='”, .内容, “',sjh='”, .内容, “',dz='”, .内容, “' where id=”, 经手人信息窗口.取标题 (., 经手人信息窗口.., 4), “”)), 假))
        提示信息 (“操作失败！数据库异常！”)
        返回 ()
    .如果真结束
    经手人信息窗口.经手人填充列表 ()
    .如果真 (等于 (经手人信息窗口., “cz”))
        车辆出租编辑窗口.经手人组合填充 ()
    .如果真结束
    .如果真 (等于 (经手人信息窗口., “jy”))
        加油信息编辑窗口.经手人组合填充_加油 ()
    .如果真结束
    销毁 ()
.默认
    .如果真 (等于 (执行SQL (相加 (“insert into jsr(jsr,gddh,sjh,dz)values('”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “')”)), 假))
        提示信息 (“操作失败！数据库异常！”)
        返回 ()
    .如果真结束
    经手人信息窗口.经手人填充列表 ()
    连续赋值 (“”, .内容, .内容, .内容, .内容)
    .如果真 (等于 (经手人信息窗口., “cz”))
        车辆出租编辑窗口.经手人组合填充 ()
    .如果真结束
    .如果真 (等于 (经手人信息窗口., “jy”))
        加油信息编辑窗口.经手人组合填充_加油 ()
    .如果真结束
    
.判断结束


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()


.窗口程序集 违章管理窗口程序集, , , 

.子程序 _违章管理窗口_创建完毕, 空白型, , 
.判断开始 (等于 (违章管理窗口., “czck”))
    出租调看违章信息 ()
.默认
    违章填充 ()
.判断结束


.子程序 出租调看违章信息, 空白型, , 
.局部变量 crwz, 整数型, , , 

赋值 (记录, 查数据 (相加 (“select * from sg where cph='”, 车辆出租编辑窗口..内容, “'or sgr='”, 车辆出租编辑窗口..内容, “'”)))
主窗口.到首记录 (., 记录)
全部删除 ()
赋值 (crwz, 0)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    crwz.插入表项 ()
    crwz.置标题 (0, 读数据 (记录, “cph”))
    crwz.置标题 (1, 读数据 (记录, “clmc”))
    crwz.置标题 (2, 读数据 (记录, “clys”))
    crwz.置标题 (3, 读数据 (记录, “sgr”))
    crwz.置标题 (4, 读数据 (记录, “sgsj”))
    crwz.置标题 (5, 读数据 (记录, “sgdd”))
    crwz.置标题 (6, 读数据 (记录, “sgyy”))
    crwz.置标题 (7, 读数据 (记录, “sgcl”))
    crwz.置标题 (8, 读数据 (记录, “clsj”))
    crwz.置标题 (9, 读数据 (记录, “jsr”))
    crwz.置标题 (10, 读数据 (记录, “djrq”))
    crwz.置标题 (11, 读数据 (记录, “bz”))
    crwz.置标题 (12, 读数据 (记录, “id”))
    主窗口.到后一记录 (., 记录)
    赋值 (crwz, 相加 (crwz, 1))
.判断循环尾 ()
关记录 ()


.子程序 违章填充, 空白型, , 
.局部变量 crwz, 整数型, , , 

赋值 (记录, 查数据 (“select * from sg order by id desc”))
主窗口.到首记录 (., 记录)
全部删除 ()
赋值 (crwz, 0)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    crwz.插入表项 ()
    crwz.置标题 (0, 读数据 (记录, “cph”))
    crwz.置标题 (1, 读数据 (记录, “clmc”))
    crwz.置标题 (2, 读数据 (记录, “clys”))
    crwz.置标题 (3, 读数据 (记录, “sgr”))
    crwz.置标题 (4, 读数据 (记录, “sgsj”))
    crwz.置标题 (5, 读数据 (记录, “sgdd”))
    crwz.置标题 (6, 读数据 (记录, “sgyy”))
    crwz.置标题 (7, 读数据 (记录, “sgcl”))
    crwz.置标题 (8, 读数据 (记录, “clsj”))
    crwz.置标题 (9, 读数据 (记录, “jsr”))
    crwz.置标题 (10, 读数据 (记录, “djrq”))
    crwz.置标题 (11, 读数据 (记录, “bz”))
    crwz.置标题 (12, 读数据 (记录, “id”))
    主窗口.到后一记录 (., 记录)
    赋值 (crwz, 相加 (crwz, 1))
.判断循环尾 ()
关记录 ()

.子程序 _添加按钮_被单击, 空白型, , 
赋值 (违章信息编辑窗口., “tj”)
载入 (违章信息编辑窗口, , 真)

.子程序 _修改按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    提示信息 (“请先选择您要修改的违章信息！”)
    返回 ()
.如果真结束
赋值 (违章信息编辑窗口., “xg”)
载入 (违章信息编辑窗口, , 真)


.子程序 _删除按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    提示信息 (“请先选择您要删除的违章信息！”)
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“是否确定要删除您选中的违章信息？”, #是否钮, “提示”), #否钮))
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“delete from sg where id=”, .取标题 (., 12))), 假))
    提示信息 (“操作失败！数据库可能异常！”)
    返回 ()
.如果真结束
违章填充 ()

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()


.子程序 _超级列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_修改按钮_被单击 ()



.窗口程序集 违章信息编辑窗口程序集, , , 

.子程序 _违章信息编辑窗口_创建完毕, 空白型, , 
经手人填充组合框 ()
车牌号填充组合框 ()
事故人填充组合框 ()
.判断开始 (等于 (违章信息编辑窗口., “xg”))
    修改违章信息预处理 ()
.默认
    
.判断结束


.子程序 修改违章信息预处理, 空白型, , 
赋值 (记录, 查数据 (相加 (“select * from sg where id=”, 违章管理窗口.取标题 (., 违章管理窗口.., 12))))
赋值 (.现行选中项, 文本取组合框选项 (读数据 (记录, “cph”)))
赋值 (.内容, 读数据 (记录, “clmc”))
赋值 (.内容, 读数据 (记录, “clys”))
赋值 (.内容, 读数据 (记录, “sgr”))
赋值 (.今天, 到时间 (读数据 (记录, “sgsj”)))
赋值 (.内容, 读数据 (记录, “sgdd”))
赋值 (.内容, 读数据 (记录, “sgyy”))
赋值 (.内容, 读数据 (记录, “sgcl”))
赋值 (.今天, 到时间 (读数据 (记录, “clsj”)))
赋值 (.内容, 读数据 (记录, “jsr”))
赋值 (.今天, 到时间 (读数据 (记录, “djrq”)))
赋值 (.内容, 读数据 (记录, “bz”))
赋值 (.内容, 读数据 (记录, “cid”))
关记录 ()

.子程序 经手人填充组合框, 空白型, , 
赋值 (记录, 查数据 (“select * from jsr order by id”))
主窗口.到首记录 (., 记录)
清空 ()
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    读数据 (记录, “jsr”).加入项目 ()
    主窗口.到后一记录 (., 记录)
.判断循环尾 ()
关记录 ()

.子程序 事故人填充组合框, 空白型, , 
赋值 (记录, 查数据 (“select * from krxx order by id”))
主窗口.到首记录 (., 记录)
清空 ()
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    读数据 (记录, “krmc”).加入项目 ()
    主窗口.到后一记录 (., 记录)
.判断循环尾 ()
关记录 ()

.子程序 车牌号填充组合框, 空白型, , 
赋值 (记录, 查数据 (“select * from clxx order by id”))
主窗口.到首记录 (., 记录)
清空 ()
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    读数据 (记录, “cph”).加入项目 ()
    主窗口.到后一记录 (., 记录)
.判断循环尾 ()
关记录 ()

.子程序 _按钮1_被单击, 空白型, , 
赋值 (经手人信息窗口., “wz”)
载入 (经手人信息窗口, , 真)

.子程序 _车牌号组合框_列表项被选择, 空白型, , 
赋值 (记录, 查数据 (相加 (“select * from clxx where cph='”, .取项目文本 (.现行选中项), “'”)))
主窗口.到首记录 (., 记录)
赋值 (.内容, 读数据 (记录, “clmc”))
赋值 (.内容, 读数据 (记录, “cys”))
赋值 (.内容, 读数据 (记录, “id”))
关记录 ()

.子程序 _确定按钮_被单击, 空白型, , 
.判断开始 (等于 (违章信息编辑窗口., “tj”))
    .如果真 (等于 (执行SQL (相加 (“insert into sg (cid,cph,clmc,clys,sgr,sgsj,sgdd,sgyy,sgcl,clsj,jsr,djrq,bz)values('”, .内容, “','”, .取项目文本 (.现行选中项), “','”, .内容, “','”, .内容, “','”, .内容, “','”, 时间到格式文本 (.今天), “','”, .内容, “','”, .内容, “','”, .内容, “','”, 时间到格式文本 (.今天), “','”, .内容, “','”, 时间到格式文本 (.今天), “','”, .内容, “')”)), 假))
        提示信息 (“操作失败！数据库可能异常！”)
        返回 ()
    .如果真结束
    违章管理窗口.违章填充 ()
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
    赋值 (.现行选中项, -1)
.判断 (等于 (违章信息编辑窗口., “xg”))
    .如果真 (等于 (执行SQL (相加 (“update sg set cid='”, .内容, “',cph='”, .取项目文本 (.现行选中项), “',clmc='”, .内容, “',clys='”, .内容, “',sgr='”, .内容, “',sgsj='”, 时间到格式文本 (.今天), “',sgdd='”, .内容, “',sgyy='”, .内容, “',sgcl='”, .内容, “',clsj='”, 时间到格式文本 (.今天), “',jsr='”, .内容, “',djrq='”, 时间到格式文本 (.今天), “',bz='”, .内容, “'where id=”, 违章管理窗口.取标题 (., 违章管理窗口.., 12), “”)), 假))
        提示信息 (“操作失败！数据库可能异常！”)
        返回 ()
    .如果真结束
    违章管理窗口.违章填充 ()
    销毁 ()
.默认
    
.判断结束


.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()


.窗口程序集 窗口程序集1, , , 

.子程序 _驱动器框1_驱动器被改变, 空白型, , 
赋值 (.目录, 相加 (.驱动器, “:\”))

.子程序 _按钮1_被单击, 空白型, , 
写配置项 (相加 (取运行目录 (), “\data\sys.ini”), “客户照片”, “保存位置”, .内容)
销毁 ()

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()


.子程序 _目录框1_目录被改变, 空白型, , 
赋值 (.内容, .目录)


.子程序 _目录框窗口_创建完毕, 空白型, , 
赋值 (.内容, .目录)


.窗口程序集 还车提醒窗口程序集, , , 

.子程序 _还车提醒窗口_创建完毕, 空白型, , 


.子程序 需还车辆填充列表, 空白型, , 
.局部变量 crwz, 整数型, , , 
.局部变量 租车时间, 文本型, , , 
.局部变量 还车时间, 文本型, , , 
.局部变量 租车完整时间, 日期时间型, , , 
.局部变量 还车完整时间, 日期时间型, , , 
.局部变量 记录1, 整数型, , , 
.局部变量 记录2, 整数型, , , 

赋值 (记录, 查数据 (“select * from czxx where yjhc<> '是' order by id”))
主窗口.到首记录 (., 记录)
全部删除 ()
赋值 (crwz, 0)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    赋值 (租车时间, 读数据 (记录, “zc_sj”))
    赋值 (还车时间, 读数据 (记录, “hc_sj”))
    赋值 (租车完整时间, 到时间 (相加 (读数据 (记录, “zcsj”), 取文本左边 (租车时间, 2), “:”, 取文本右边 (租车时间, 2))))
    赋值 (还车完整时间, 到时间 (相加 (读数据 (记录, “hcsj”), 取文本左边 (还车时间, 2), “:”, 取文本右边 (还车时间, 2))))
    输出调试文本 (相加 (到文本 (租车完整时间), “  ”, 到文本 (还车完整时间)))
    .判断开始 (小于或等于 (取时间间隔 (还车完整时间, 取现行时间 (), #日), 0))
        赋值 (记录1, 查数据 (相加 (“select * from clxx where id=”, 读数据 (记录, “cid”))))
        赋值 (记录2, 查数据 (相加 (“select * from krxx where id=”, 读数据 (记录, “krid”))))
        crwz.插入表项 ()
        crwz.置标题 (0, 到文本 (租车完整时间))
        crwz.置标题 (1, 到文本 (还车完整时间))
        crwz.置标题 (2, 读数据 (记录2, “krmc”))
        crwz.置标题 (3, 读数据 (记录2, “gddh”))
        crwz.置标题 (4, 读数据 (记录2, “sjh”))
        crwz.置标题 (5, 读数据 (记录2, “zz”))
        crwz.置标题 (6, 读数据 (记录1, “cph”))
        crwz.置标题 (7, 读数据 (记录1, “clmc”))
        crwz.置标题 (8, 读数据 (记录1, “cx”))
        主窗口.关闭记录集 (., 记录1)
        主窗口.关闭记录集 (., 记录2)
        赋值 (crwz, 相加 (crwz, 1))
    .默认
        
    .判断结束
    主窗口.到后一记录 (., 记录)
.判断循环尾 ()
关记录 ()

.子程序 _查看按钮_被单击, 空白型, , 
需还车辆填充列表 ()

.子程序 _查看按钮1_被单击, 空白型, , 
.局部变量 crwz, 整数型, , , 
.局部变量 租车时间, 文本型, , , 
.局部变量 还车时间, 文本型, , , 
.局部变量 租车完整时间, 日期时间型, , , 
.局部变量 还车完整时间, 日期时间型, , , 
.局部变量 记录1, 整数型, , , 
.局部变量 记录2, 整数型, , , 

赋值 (记录, 查数据 (“select * from czxx where yjhc<> '是' order by id”))
主窗口.到首记录 (., 记录)
全部删除 ()
赋值 (crwz, 0)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    赋值 (租车时间, 读数据 (记录, “zc_sj”))
    赋值 (还车时间, 读数据 (记录, “hc_sj”))
    赋值 (租车完整时间, 到时间 (相加 (读数据 (记录, “zcsj”), 取文本左边 (租车时间, 2), “:”, 取文本右边 (租车时间, 2))))
    赋值 (还车完整时间, 到时间 (相加 (读数据 (记录, “hcsj”), 取文本左边 (还车时间, 2), “:”, 取文本右边 (还车时间, 2))))
    输出调试文本 (相加 (到文本 (租车完整时间), “  ”, 到文本 (还车完整时间)))
    .判断开始 (并且 (小于或等于 (取时间间隔 (取日期 (.今天), 取日期 (还车完整时间), #日), 0), 大于或等于 (取时间间隔 (取日期 (.今天), 取日期 (还车完整时间), #日), 0)))
        赋值 (记录1, 查数据 (相加 (“select * from clxx where id=”, 读数据 (记录, “cid”))))
        赋值 (记录2, 查数据 (相加 (“select * from krxx where id=”, 读数据 (记录, “krid”))))
        crwz.插入表项 ()
        crwz.置标题 (0, 到文本 (租车完整时间))
        crwz.置标题 (1, 到文本 (还车完整时间))
        crwz.置标题 (2, 读数据 (记录2, “krmc”))
        crwz.置标题 (3, 读数据 (记录2, “gddh”))
        crwz.置标题 (4, 读数据 (记录2, “sjh”))
        crwz.置标题 (5, 读数据 (记录2, “zz”))
        crwz.置标题 (6, 读数据 (记录1, “cph”))
        crwz.置标题 (7, 读数据 (记录1, “clmc”))
        crwz.置标题 (8, 读数据 (记录1, “cx”))
        主窗口.关闭记录集 (., 记录1)
        主窗口.关闭记录集 (., 记录2)
        赋值 (crwz, 相加 (crwz, 1))
    .默认
        
    .判断结束
    主窗口.到后一记录 (., 记录)
.判断循环尾 ()
关记录 ()


.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()


.窗口程序集 修改密码窗口程序集, , , 

.子程序 _修改密码窗口_创建完毕, 空白型, , 
赋值 (.标题, 当前用户)

.子程序 _确认按钮_被单击, 空白型, , 
赋值 (记录, 查数据 (相加 (“select * from yh where  yhmc='”, .标题, “'”)))
.如果真 (不等于 (读数据 (记录, “yhmm”), .内容))
    提示信息 (“旧密码有误！”)
    获取焦点 ()
    关记录 ()
    返回 ()
.如果真结束
关记录 ()
.如果真 (不等于 (.内容, .内容))
    提示信息 (“两次输入密码不相同！”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“update yh set yhmm='”, .内容, “'where yhmc='”, .标题, “'”)), 假))
    提示信息 (“操作失败！数据库可能异常！”)
    返回 ()
.如果真结束
提示信息 (“修改成功！”)
销毁 ()


.窗口程序集 窗口程序集2, , , 

.子程序 _用户管理窗口_创建完毕, 空白型, , 


.窗口程序集 加油记录窗口程序集, , , 

.程序集变量 id列, 整数型, , , 
.子程序 _加油记录管理窗口_创建完毕, 空白型, , 
加油信息填充列表 ()

.子程序 _添加按钮_被单击, 空白型, , 
赋值 (加油信息编辑窗口., “tj”)
载入 (加油信息编辑窗口, , 真)

.子程序 加油信息填充列表, 空白型, , 
.局部变量 crwz, 整数型, , , 

赋值 (记录, 查数据 (“select * from jyxx order by id”))
主窗口.到首记录 (., 记录)
全部删除 ()
赋值 (crwz, 0)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    crwz.插入表项 ()
    crwz.置标题 (0, 读数据 (记录, “clmc”))
    crwz.置标题 (1, 读数据 (记录, “cph”))
    crwz.置标题 (2, 读数据 (记录, “rylx”))
    crwz.置标题 (3, 读数据 (记录, “jsr”))
    crwz.置标题 (4, 到文本 (到数值 (读数据 (记录, “dj”))))
    crwz.置标题 (5, 到文本 (到数值 (读数据 (记录, “jyl”))))
    crwz.置标题 (6, 到文本 (到数值 (读数据 (记录, “zje”))))
    crwz.置标题 (7, 读数据 (记录, “yzmc”))
    crwz.置标题 (8, 读数据 (记录, “bz”))
    crwz.置标题 (9, 读数据 (记录, “id”))
    主窗口.到后一记录 (., 记录)
    赋值 (crwz, 相加 (crwz, 1))
.判断循环尾 ()
赋值 (id列, 9)
关记录 ()

.子程序 _修改按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    提示信息 (“请先在列表中选择您要修改的数据！”)
    返回 ()
.如果真结束
赋值 (加油信息编辑窗口.标记, “xg”)
载入 (加油信息编辑窗口, , 真)

.子程序 _超级列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_修改按钮_被单击 ()

.子程序 _删除按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    提示信息 (“请先在列表中选择您要删除的数据！”)
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“是否确定删除选中的数据信息？”, #是否钮, “提示”), #否钮))
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“delete from jyxx where id=”, .取标题 (., id列))), 假))
    提示信息 (“操作失败！数据库可能异常！”)
    返回 ()
.如果真结束
加油信息填充列表 ()

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()


.窗口程序集 油站编辑窗口程序集, , , 

.子程序 _油站编辑窗口_创建完毕, 空白型, , 
油站填充列表 ()


.子程序 油站填充列表, 空白型, , 
.局部变量 crwz, 整数型, , , 

赋值 (记录, 查数据 (“select * from yz order by id”))
主窗口.到首记录 (., 记录)
全部删除 ()
赋值 (crwz, 0)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    crwz.插入表项 ()
    crwz.置标题 (0, 读数据 (记录, “yz”))
    crwz.置标题 (1, 读数据 (记录, “id”))
    主窗口.到后一记录 (., 记录)
    赋值 (crwz, 相加 (crwz, 1))
.判断循环尾 ()
关记录 ()

.子程序 _添加按钮_被单击, 空白型, , 
.局部变量 yz, 文本型, , , 

.如果真 (或者 (等于 (输入框 (“请输入油站名称”, “请输入油站名称”, , yz, ), 假), 等于 (yz, “”)))
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“insert into yz(yz) values ('”, yz, “')”)), 假))
    提示信息 (“操作失败！数据库可能异常！”)
    返回 ()
.如果真结束
油站填充列表 ()
加油信息编辑窗口.油站填充组合框 ()

.子程序 _修改按钮_被单击, 空白型, , 
.局部变量 yz, 文本型, , , 

.如果真 (等于 (., -1))
    提示信息 (“请先在左表中选择要修改的油站名称！”)
    返回 ()
.如果真结束
.如果真 (或者 (等于 (输入框 (“请输入油站”, “请输入油站”, .取标题 (., 0), yz, ), 假), 等于 (yz, “”)))
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“update yz set yz='”, yz, “'where id=”, .取标题 (., 1), “”)), 假))
    提示信息 (“操作失败！数据库可能异常！”)
    返回 ()
.如果真结束
油站填充列表 ()
加油信息编辑窗口.油站填充组合框 ()

.子程序 _删除按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    提示信息 (“请先在左表中选择要删除的油站！”)
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“您是否确定要删除选中的油站？”, #是否钮, “提示”), #否钮))
    返回 ()
.如果真结束
.如果真 (等于 (执行SQL (相加 (“delete from yz  where id=”, .取标题 (., 1), “”)), 假))
    提示信息 (“操作失败！数据库可能异常！”)
    返回 ()
.如果真结束
油站填充列表 ()
加油信息编辑窗口.油站填充组合框 ()

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()


.窗口程序集 加油信息编辑窗口程序集, , , 

.子程序 _加油信息编辑窗口_创建完毕, 空白型, , 
.判断开始 (等于 (读配置项 (相加 (取运行目录 (), “\data\sys.ini”), “加油单据”, “可为空”, “否”), “否”))
    赋值 (.选中, 假)
.默认
    赋值 (.选中, 真)
.判断结束
油站填充组合框 ()
经手人组合填充_加油 ()
.如果真 (等于 (加油信息编辑窗口.标记, “xg”))
    加油修改预处理 ()
.如果真结束


.子程序 加油修改预处理, 空白型, , 
赋值 (记录, 查数据 (相加 (“select * from jyxx where id=”, 加油记录管理窗口.取标题 (., 加油记录管理窗口.., 加油记录管理窗口.))))
赋值 (.内容, 读数据 (记录, “xgdj”))
赋值 (.内容, 读数据 (记录, “cph”))
赋值 (.内容, 读数据 (记录, “clmc”))
赋值 (.内容, 读数据 (记录, “rylx”))
赋值 (.内容, 读数据 (记录, “jsr”))
赋值 (.内容, 到文本 (到数值 (读数据 (记录, “dj”))))
赋值 (.内容, 到文本 (到数值 (读数据 (记录, “jyl”))))
赋值 (.内容, 到文本 (到数值 (读数据 (记录, “zje”))))
赋值 (.内容, 读数据 (记录, “yzmc”))
赋值 (.内容, 读数据 (记录, “bz”))
关记录 ()

.子程序 算总金额_加油, 空白型, , 
赋值 (.内容, 到文本 (四舍五入 (相乘 (到数值 (.内容), 到数值 (.内容)), 2)))


.子程序 _油站按钮_被单击, 空白型, , 
载入 (油站编辑窗口, , 真)


.子程序 油站填充组合框, 空白型, , 
赋值 (记录, 查数据 (“select * from yz order by id”))
主窗口.到首记录 (., 记录)
清空 ()
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    读数据 (记录, “yz”).加入项目 ()
    主窗口.到后一记录 (., 记录)
.判断循环尾 ()
关记录 ()

.子程序 经手人组合填充_加油, 空白型, , 
赋值 (记录, 查数据 (“select * from jsr order by id”))
主窗口.到首记录 (., 记录)
清空 ()
.判断循环首 (等于 (主窗口.尾记录后 (., 记录), 假))
    读数据 (记录, “jsr”).加入项目 ()
    主窗口.到后一记录 (., 记录)
.判断循环尾 ()
关记录 ()


.子程序 _车牌号按钮_被单击, 空白型, , 
赋值 (车辆信息窗口., “加油调用”)
载入 (车辆信息窗口, , 真)

.子程序 _按钮1_被单击, 空白型, , 
.如果真 (不等于 (.选中, 真))
    .如果真 (等于 (.内容, “”))
        .如果真 (等于 (信息框 (“是否确定让相关单据为空？”, #是否钮, “提示”), #否钮))
            返回 ()
        .如果真结束
        
        
    .如果真结束
    
.如果真结束
.如果真 (等于 (.内容, “”))
    提示信息 (“请先选择要加油的车辆！”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    提示信息 (“经手人不可为空！”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (小于或等于 (到数值 (.内容), 0))
    提示信息 (“单价不可为空！”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (小于或等于 (到数值 (.内容), 0))
    提示信息 (“加油量不可为空！”)
    获取焦点 ()
    返回 ()
.如果真结束
.判断开始 (不等于 (加油信息编辑窗口.标记, “xg”))
    .如果真 (等于 (执行SQL (相加 (“insert into jyxx(xgdj,cph,clmc,rylx,jsr,dj,jyl,zje,yzmc,bz) values ('”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “',”, 到文本 (到数值 (.内容)), “,”, 到文本 (到数值 (.内容)), “,”, 到文本 (到数值 (.内容)), “,'”, .内容, “','”, .内容, “')”)), 假))
        未知函数_67176113 (“操作失败！数据库可能异常！”)
        返回 ()
    .如果真结束
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
    加油记录管理窗口.加油信息填充列表 ()
.默认
    .如果真 (等于 (执行SQL (相加 (“update jyxx  set xgdj='”, .内容, “',cph='”, .内容, “',clmc='”, .内容, “',rylx='”, .内容, “',jsr='”, .内容, “',dj=”, 到文本 (到数值 (.内容)), “,jyl=”, 到文本 (到数值 (.内容)), “,zje=”, 到文本 (到数值 (.内容)), “,yzmc='”, .内容, “',bz='”, .内容, “'where id=”, 加油记录管理窗口.取标题 (., 加油记录管理窗口.., 加油记录管理窗口.))), 假))
        未知函数_67176142 (“操作失败！数据库可能异常！”)
        返回 ()
    .如果真结束
    加油记录管理窗口.加油信息填充列表 ()
    销毁 ()
.判断结束


.子程序 _经手人按钮_被单击, 空白型, , 
赋值 (经手人信息窗口., “jy”)
载入 (经手人信息窗口, , 真)



.子程序 _选择框1_被单击, 空白型, , 
.判断开始 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\data\sys.ini”), “加油单据”, “可为空”, “是”)
.默认
    写配置项 (相加 (取运行目录 (), “\data\sys.ini”), “加油单据”, “可为空”, “否”)
.判断结束


.子程序 _单价编辑框_内容被改变, 空白型, , 
算总金额_加油 ()

.子程序 _加油量编辑框_内容被改变, 空白型, , 
算总金额_加油 ()

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()


 ' 不属于任何一个程序集、类模块的函数：
