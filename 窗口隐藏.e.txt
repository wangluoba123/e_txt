 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “强力隐藏”
    帮助文件名 = “”

窗口 说明窗口
    左边 = 50
    顶边 = 50
    宽度 = 213
    高度 = 113
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.图片 图标一, " ' 已保存到：D:\易语言学习\Data\窗口隐藏.e\图标一", , 
.图片 图标二, " ' 已保存到：D:\易语言学习\Data\窗口隐藏.e\图标二", , 
.常量 隐藏, "786431", , 
.常量 显示, "786430", , 
.常量 最小化, "786432", , 
.常量 热键, "786", , 
.常量 WS_CHILD, "1073741824", , 
.常量 WS_VISIBLE, "268435456", , 
.常量 WM_SIZE, "5", , 
.常量 SIZE_RESTORED, "0", , 
.常量 SB_SETTEXT, "1025", , 
.常量 SB_SETPARTS, "1028", , 
.常量 SBT_TOOLTIPS, "2048", , 
.常量 SB_SETTIPTEXT, "1040", , 
.常量 移除, "1", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库



 ' 所需要的模块
 ' 提示框模块2.61 F:\资源网\易语言\Tooltip261.ec


数据类型 点, , 
    .成员 横, 整数型, , , 
    .成员 纵, 整数型, , , 

数据类型 状态栏和父窗口, , 
    .成员 状态栏句柄, 整数型, , , 
    .成员 父窗口, 窗口, , , 

数据类型 消息, , 
    .成员 句柄, 整数型, , , 
    .成员 消息, 整数型, , , 
    .成员 消息1, 整数型, , , 
    .成员 消息2, 整数型, , , 
    .成员 时间, 整数型, , , 
    .成员 点, 点, , , 


.DLL命令 注册热键, 整数型, "", "RegisterHotKey", , 
    .参数 句柄, 整数型, , 
    .参数 标识, 整数型, , 
    .参数 功能键, 整数型, , 
    .参数 键代码, 整数型, , 

.DLL命令 撤销热键, 整数型, "", "UnregisterHotKey", , 
    .参数 句柄, 整数型, , 
    .参数 标识, 整数型, , 

.DLL命令 检查消息队列, 整数型, "", "PeekMessageA", , 
    .参数 消息, 消息, , 
    .参数 句柄, 整数型, , 
    .参数 第一个消息, 整数型, , 
    .参数 最后一个消息, 整数型, , 
    .参数 移除消息, 整数型, , 

.DLL命令 等待消息, 整数型, "", "WaitMessage", , 

.DLL命令 窗口可见性, 整数型, "", "ShowWindow", , 
    .参数 窗口句柄, 空白型, , 
    .参数 常数, 空白型, , 

.DLL命令 取鼠标位置, 整数型, "", "GetCursorPos", , 
    .参数 鼠标位置, 点, , 

.DLL命令 返回鼠标位置窗口句柄, 整数型, "", "WindowFromPoint", , 
    .参数 横坐标, 空白型, , 
    .参数 纵坐标, 空白型, , 

.DLL命令 外部_创建状态栏, 整数型, "comctl32", "CreateStatusWindowA", , 返回获得的句柄
    .参数 样式, 整数型, , 
    .参数 文字, 文本型, , 
    .参数 父窗口句柄, 整数型, , 
    .参数 控件标识, 整数型, , 

.DLL命令 外部_移动窗口, 逻辑型, "user32.dll", "MoveWindow", , 
    .参数 窗口句柄, 整数型, , 
    .参数 左边, 整数型, , 
    .参数 顶边, 整数型, , 
    .参数 宽度, 整数型, , 
    .参数 高度, 整数型, , 
    .参数 是否重画, 逻辑型, , 

.DLL命令 外部_发送消息, 空白型, "user32.dll", "SendMessageA", , 
    .参数 发送对象句柄, 整数型, , 
    .参数 消息, 整数型, , 
    .参数 辅助参数一, 整数型, , 
    .参数 辅助参数二, 整数型, , 

.DLL命令 外部_发送消息_SB_SETTEXT, 空白型, "user32.dll", "SendMessageA", , 
    .参数 发送对象句柄, 整数型, , 
    .参数 消息, 整数型, , 
    .参数 辅助参数一, 整数型, , 
    .参数 辅助参数二, 文本型, , 

.DLL命令 外部_发送消息_SB_SETPARTS, 空白型, "user32.dll", "SendMessageA", , 
    .参数 发送对象句柄, 整数型, , 
    .参数 消息, 整数型, , 
    .参数 辅助参数一, 整数型, , 
    .参数 辅助参数二, 整数型, 数组, 

.DLL命令 外部_获得最后的错误, 整数型, "Kernel32", "GetLastError", , 

.DLL命令 取得窗口信息, 整数型, "", "GetWindowLongA", , 
    .参数 句柄, 整数型, , 
    .参数 索引, 整数型, , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 退出, 逻辑型, , , 
.程序集变量 鼠标位置, 点, , , 
.程序集变量 窗口程序, 整数型, , , 
.程序集变量 批号, 整数型, , , 
.程序集变量 分割块数组, 整数型, , "2", 
.子程序 __启动窗口_创建完毕, 空白型, , 
载入 (说明窗口, , 真)
赋值 (分割块数组, { 40, 60 })
赋值 (批号, 模块_创建状态栏 (_启动窗口, 505,  (), 分割块数组))
模块_在状态栏上写出文本 (批号, “  浪花 club@eyuyan.com”, 1)
赋值 (退出, 假)
注册热键 (_启动窗口.取窗口句柄 (), #隐藏, 0, #F12键)
注册热键 (_启动窗口.取窗口句柄 (), #显示, 0, #F11键)
注册热键 (_启动窗口.取窗口句柄 (), #最小化, 0, #F10键)
赋值 (窗口程序, 取得窗口信息 (_启动窗口.取窗口句柄 (), -4))
赋值 (., 真)
_启动窗口.置托盘图标 (#图标一, “强力隐藏”)
未知函数_67174491 (_启动窗口.取窗口句柄 (), 取窗口句柄 (), “已被隐藏的窗口的句柄，用鼠标选择即可将其恢复”)
处理消息 ()

.子程序 处理消息, 空白型, , 
.局部变量 消息, 消息, , , 
.局部变量 临时句柄, 空白型, , , 
.局部变量 句柄数, 空白型, , , 
.局部变量 容器, 空白型, , , 

.判断循环首 (等于 (退出, 假))
    取鼠标位置 (鼠标位置)
    赋值 (临时句柄, 返回鼠标位置窗口句柄 (鼠标位置.横, 鼠标位置.纵))
    等待消息 ()
    .如果真 (不等于 (检查消息队列 (消息, _启动窗口.取窗口句柄 (), #热键, #热键, #移除), 0))
        .判断开始 (等于 (消息.消息, #热键))
            .判断开始 (等于 (消息.消息1, #隐藏))
                窗口可见性 (临时句柄, 0)
                到文本 (临时句柄).加入项目 ()
            .判断 (等于 (消息.消息1, #显示))
                赋值 (句柄数, 取项目数 ())
                .计次循环首 (句柄数, 容器)
                    窗口可见性 (到数值 (相减 (容器, 1).取项目文本 ()), 5)
                .计次循环尾 ()
                清空 ()
            .判断 (等于 (消息.消息1, #最小化))
                .如果 (等于 (_启动窗口., 0))
                    赋值 (_启动窗口., 2)
                    窗口可见性 (_启动窗口.取窗口句柄 (), 0)
                .否则
                    赋值 (_启动窗口., 0)
                    窗口可见性 (_启动窗口.取窗口句柄 (), 5)
                    赋值 (_启动窗口., 0)
                    _启动窗口.调整层次 (3)
                .如果结束
                
            .默认
                
            .判断结束
            
        .默认
            
        .判断结束
        
    .如果真结束
    处理事件 ()
.判断循环尾 ()

.子程序 __启动窗口_将被销毁, 空白型, , 
赋值 (退出, 真)
_启动窗口.置托盘图标 ()
撤销热键 (_启动窗口.取窗口句柄 (), #显示)
撤销热键 (_启动窗口.取窗口句柄 (), #隐藏)
撤销热键 (_启动窗口.取窗口句柄 (), #最小化)

.子程序 _组合框_列表项被选择, 空白型, , 
窗口可见性 (到数值 (.), 5)
.删除项目 (.)

.子程序 __启动窗口_尺寸被改变, 空白型, , 
模块_修正状态栏位置 (批号, 分割块数组)

.子程序 _时钟1_周期事件, 空白型, , 
取鼠标位置 (鼠标位置)
模块_在状态栏上写出文本 (批号, 相加 (“鼠标位置：[”, “横：”, 到文本 (鼠标位置.横), “  纵：”, 到文本 (鼠标位置.纵), “]”), 2)


.窗口程序集 窗口程序集2, , , 

.子程序 _说明窗口_创建完毕, 空白型, , 
赋值 (说明窗口., 真)
延时 (4000)
销毁 ()

.程序集 _接口程序集, , , 

.程序集变量 状态栏结构, 状态栏和父窗口, , "0", 
.子程序 模块_创建状态栏, 整数型, , 返回批号
.参数 父窗口, 窗口, , 你想要添加状态栏的窗口的句柄
.参数 状态栏标识, 整数型, , 一个随意的数字
.参数 初始文本, 文本型, 可空, 就用空吧
.参数 分割块数组, 整数型, 可空 数组, 可以为空，{25,,25,50}

.局部变量 状态栏句柄, 整数型, , , 
.局部变量 状态栏和父窗口, 状态栏和父窗口, , , 
.局部变量 批号, 整数型, , , 

.如果真 (是否为空 (初始文本))
    赋值 (初始文本, 父窗口.)
.如果真结束
赋值 (状态栏句柄, 外部_创建状态栏 (位或 (#WS_CHILD, #WS_VISIBLE, #SBT_TOOLTIPS), 初始文本, 父窗口.取窗口句柄 (), 状态栏标识))
赋值 (状态栏和父窗口.状态栏句柄, 状态栏句柄)
赋值 (状态栏和父窗口.父窗口, 父窗口)
加入成员 (状态栏结构, 状态栏和父窗口)
赋值 (批号, 取数组成员数 (状态栏结构))
.如果真 (取反 (是否为空 (分割块数组)))
    模块_分割状态栏 (批号, 分割块数组)
.如果真结束
返回 (批号)

.子程序 模块_分割状态栏, 空白型, , 
.参数 批号, 整数型, , 
.参数 分割块数组, 整数型, 数组, 改变了！使用比例{25,25,50}

.局部变量 块的个数, 整数型, , , 
.局部变量 循环, 整数型, , , 
.局部变量 当前位置, 整数型, , , 
.局部变量 临时数组, 整数型, , "0", 

赋值 (块的个数, 取数组成员数 (分割块数组))
重定义数组 (临时数组, 假, 块的个数)
.变量循环首 (1, 块的个数, 1, 循环)
    .判断开始 (等于 (分割块数组 [循环], -1))
        赋值 (临时数组 [循环], -1)
        跳出循环 ()
    .默认
        赋值 (临时数组 [循环], 相加 (当前位置, 整除 (相乘 (状态栏结构 [批号], ., 分割块数组 [循环]), 100)))
        赋值 (当前位置, 相加 (当前位置, 临时数组 [循环]))
    .判断结束
    
.变量循环尾 ()
外部_发送消息_SB_SETPARTS (状态栏结构 [批号], , #SB_SETPARTS, 块的个数, 临时数组)

.子程序 模块_修正状态栏位置, 空白型, , 在窗口的尺寸改变中使用
.参数 批号, 整数型, , 
.参数 分割块数组, 整数型, 数组, 

外部_发送消息 (状态栏结构 [批号], , #WM_SIZE, #SIZE_RESTORED, 0)
模块_分割状态栏 (批号, 分割块数组)

.子程序 模块_在状态栏上写出文本, 空白型, , 
.参数 批号, 整数型, , 
.参数 写出的文本, 文本型, , 
.参数 对应的块, 整数型, , 1起

外部_发送消息_SB_SETTEXT (状态栏结构 [批号], , #SB_SETTEXT, 相减 (对应的块, 1), 写出的文本)

.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 模块_添加提示, 整数型, , 返回批号
.参数 父窗口句柄, 整数型, 可空, 第一次使用时必须
.参数 控件句柄, 整数型, , 
.参数 提示文本, 文本型, , 



.子程序 模块_移除提示, 空白型, , 
.参数 批号, 整数型, , 



.子程序 模块_修改提示, 空白型, , 
.参数 批号, 整数型, , 
.参数 新的文本, 文本型, , 




 ' 不属于任何一个程序集、类模块的函数：
