 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假



.常量 常量_我的网址, "“http://www.eeeyyy.com”", , #常量_我的网址
.常量 常量_我的电话, "“026-12345678”", , 
.常量 常量_我的邮箱, "“email:abc.@sina.com”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' spec A512548E76954B6E92C21055517615B0 2 1 特殊功能支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库
 ' sock A6B983789F624b2cBDFD7D671249C097 1 0 网络通讯支持库




.全局变量 全_子程序名称, 文本型, , , 

.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
置错误提示管理 (&中心_错误处理中心)

.子程序 _按钮1_被单击, 空白型, , 
赋值 (全_子程序名称, “_按钮1_被单击,子程序,编程人员:张三”)
中心_错误处理中心 (3, “出错了!”)


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 数组, 整数型, , "1", 

赋值 (全_子程序名称, “_按钮2_被单击,子程序,编程人员:李四”)
信息框 (数组 [2], 0, )

.程序集 错误处理中心, , , 

.子程序 中心_错误处理中心, 逻辑型, , 
.参数 错误代码, 整数型, , 
.参数 错误文本, 文本型, , 

.局部变量 硬盘信息, 未知类型0x30007, , , 
.局部变量 CPU信息, 未知类型0x30003, , , 
.局部变量 BIOS信息, 未知类型0x30006, , , 
.局部变量 取硬盘特征字1, 文本型, , , 
.局部变量 硬盘序列号1, 文本型, , , 硬盘序列号
.局部变量 取本机网卡物理地址1, 文本型, , , 
.局部变量 CPU序列号1, 文本型, , , CPU序列号
.局部变量 BIOS序列号1, 文本型, , , BIOS序列号
.局部变量 系统信息, 未知类型0x30004, , , 
.局部变量 物理内存, 整数型, , , 
.局部变量 可用物理内存, 整数型, , , 
.局部变量 运行环境信息, 文本型, , , 
.局部变量 出错累计次数, 整数型, , , 
.局部变量 出错日期, 日期时间型, , , 

 ' *****************************************************************************************************************
 ' 一个比较完善的出错处理框架-王军
 ' 大家知道,程序运行时出现差错在所难免,这时出现差错你会怎么办?
 ' 自己严格地进行测试都不可能避免不出差错,因此软件在用户手中如果能及时在出错时收集出错信息,并且将错误信息通知你,这是一个非常好的办法.
 ' 当然,如果能将出错的信息自动发送MEAIL给你,那将是最好的了.
 ' 1.本程序就是拦截出错信息,当出现错误时,将一般最常见的情况都列举出来了,无非就两种,一种是支持库被破坏,另一种是数组下标越界.
 ' 其他的如:死循环这类的实际上是很少的,基本上在编译时就会发现.
 ' 2.可知道是哪个子程序出现问题.以及是哪个人编程的,以方便排错,找到解决问题的办法.
 ' 在每个子程序的第一行加上:"全_子程序名称 ＝ “_按钮1_被单击,子程序,编程人员:张三”"
 ' 3.可知道程序的运行环境,如操作系统,CPU信息等.以了解运行的状态.
 ' 4.可自动重启,本日出错重启达5次以上时,就不再自动重启了,而是由用户手工重启.
 ' 5.用户提示信息简单明了,并且显示了自己的网址,和服务信息.
 ' 本程序还可以改进为将错误信息发送到EMAIL给你,这样就省去用户手工发送EMAIL的麻烦了.
 ' *****************************************************************************************************************

输出调试文本 (“本程序最好编译后进行测试,以看到正确的重启效果!”)
 ' 一.出现错误,即将错误信息写到一个文本文件,最好是发送到服务端
.如果真 (等于 (删全部空 (), “”))
    赋值 (“未登记!”)
.如果真结束
 ' =====================================================================
 ' 1.将系统的硬件信息也写到文本中,备查
未知支持库函数_14 (系统信息)
未知支持库函数_17 ()
未知支持库函数_3 (#.)
未知支持库函数_15 ()
赋值 (物理内存, 未知支持库函数_19 (#.))
赋值 (可用物理内存, 未知支持库函数_19 (#.))
赋值 (运行环境信息, 相加 (未知支持库函数_16 (), “:”, 转换为IP地址 (未知支持库函数_16 ()), #换行符, “================================================”, #换行符, “CPU详细信息”, #换行符, “CPU制造商：”, CPU信息., #换行符, “CPU名称：”, CPU信息., #换行符, “时钟频率：”, 到文本 (CPU信息.), “MHz”, #换行符, “CPU描述：”, CPU信息., #换行符, “一级缓存：”, 到文本 (CPU信息.), “kb”, #换行符, “二级缓存：”, 到文本 (CPU信息.), “kb”, #换行符, “CPU序列号：”, CPU信息., #换行符, “数据宽度：”, 到文本 (CPU信息.), “位”, #换行符, “================================================”, #换行符, “物理内存：”, 到文本 (物理内存), “M”, #换行符, “可用物理内存：”, 到文本 (可用物理内存), “M”, #换行符, “操作系统：”, 系统信息., #换行符, “版本：”, 系统信息., #换行符, “最后服务包：”, 系统信息., #换行符, “当前用户：”, 系统信息., #换行符, “系统安装目录：”, 系统信息., #换行符, “系统目录：”, 系统信息., #换行符, “本地语言：”, 系统信息., #换行符, “国家：”, 系统信息., #换行符, “================================================”, #换行符, “硬件序列号”, #换行符, “网卡物理地址：”, 到文本 (相加 (未知支持库函数_44 (1), #换行符, “硬盘特征字：”, 到文本 (取硬盘特征字 ()), #换行符, “硬盘序列号：”, 到文本 (硬盘信息.), #换行符, “BIOS序列号：”, 到文本 (BIOS信息.)))))
输出调试文本 (运行环境信息)
写到文件 (“错误信息.TXT”, 到字节集 (相加 (“出错时间:”, 到文本 (取现行时间 ()), #换行符, “错误代码:”, 到文本 (错误代码), #换行符, “出错子程序:”, 全_子程序名称, #换行符, 错误文本, #换行符, 运行环境信息)))
 ' 二.重载启动程序,哈哈,永远都不会丢失程序了.
.如果真 (等于 (错误代码, 0))
    赋值 (错误文本, “可能是缺少支持库文件!”)
.如果真结束
.如果真 (等于 (错误代码, 1))
    赋值 (错误文本, “可能是数组使用超出范围!”)
.如果真结束
信息框 (相加 (“错误代码:”, 到文本 (错误代码), #换行符, 错误文本, #换行符, “出错子程序:”, 全_子程序名称, #换行符, “请通知技术服务部门解决这个问题!”, #换行符, “技术支持:”, #常量_我的网址, #换行符, “技术邮箱:”, #常量_我的邮箱, #换行符, “技术电话:”, #常量_我的电话), #错误图标, “程序出现了小小的错误!”)
赋值 (出错日期, 到时间 (读配置项 (相加 (取运行目录 (), “\配置.INI”), “出错”, “日期”, 到文本 (取现行时间 ()))))
输出调试文本 (相加 (“出错日期=”, 到文本 (出错日期)))
赋值 (出错累计次数, 到数值 (读配置项 (相加 (取运行目录 (), “\配置.INI”), “出错”, “次数”, “0”)))
输出调试文本 (相加 (“出错累计次数=”, 到文本 (出错累计次数)))
.如果 (并且 (等于 (相加 (到文本 (取年份 (出错日期)), 到文本 (取月份 (出错日期)), 到文本 (取日 (出错日期))), 相加 (到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ())), 到文本 (取日 (取现行时间 ())))), 大于或等于 (出错累计次数, 5))) ' 日期相同,出错数大于5时,就没有必要再重启了,这里也可以写到注册表中
    输出调试文本 (相加 (“对比结果=”, 到文本 (取年份 (出错日期)), 到文本 (取月份 (出错日期)), 到文本 (取日 (出错日期)), “＝”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ())), 到文本 (取日 (取现行时间 ()))))
    结束 ()
    返回 (真)
.否则
    写配置项 (相加 (取运行目录 (), “\配置.INI”), “出错”, “时间”, 到文本 (取现行时间 ()))
    写配置项 (相加 (取运行目录 (), “\配置.INI”), “出错”, “次数”, 到文本 (相加 (出错累计次数, 1)))
    输出调试文本 (相加 (“写配置项”, 到文本 (取现行时间 ()), 到文本 (相加 (出错累计次数, 1))))
    延迟 (30000)
     ' 关闭句柄 (唯一启动标记)
    运行 (取执行文件名 (), 假, #普通激活) ' 设置自动重启,方便自动化管理
    结束 ()
.如果结束
返回 (真)



 ' 不属于任何一个程序集、类模块的函数：
