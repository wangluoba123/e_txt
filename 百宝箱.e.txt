 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 657
    高度 = 527
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “百宝箱”
    帮助文件名 = “”



.常量 SHGFI_ICON, "256", , 
.常量 BIF_RETURNONLYFSDIRS, "1", , 
.常量 SEE_MASK_INVOKEIDLIST, "12", , 
.常量 DIB_RGB_COLORS, "0", , BITMAPINFO包含了一个颜色表，其中保存有32位颜色（RGBQUAD）
.常量 SRCCOPY, "13369376", , 直接复制，不做任何修改。
.常量 BI_RGB, "0", , 不压缩


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' EXMLParser BE2297B7415349c8A55BC9DFEB6DD11A 2 2 XML解析支持库
 ' spec A512548E76954B6E92C21055517615B0 3 1 特殊功能支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 2 0 扩展界面支持库二
 ' shell 52F260023059454187AF826A3C07AF2A 3 0 操作系统界面功能支持库




数据类型 SHFILEINFO, 公开, 
    .成员 hIcon, 空白型, , , 文件的图标句柄
    .成员 iIcon, 空白型, , , 图标的系统索引号
    .成员 dwAttributes, 空白型, , , 文件的属性值
    .成员 szDisplayName, 字节型, , "256", 文件的显示名
    .成员 szTypeName, 字节型, , "80", 文件的类型名

数据类型 BROWSEINFO, , BROWSEINFO文件夹信息
    .成员 hOwner, 整数型, , , 窗口句柄
    .成员 pidlRoot, 整数型, , , 根目录
    .成员 pszDisplayName, 文本型, , , 显示名称
    .成员 lpszTitle, 文本型, , , 标题
    .成员 ulFlags, 整数型, , , 标志
    .成员 lpfn, 整数型, , , 回调函数地址
    .成员 lParam, 整数型, , , 回调函数参数
    .成员 iImage, 整数型, , , 图像索引

数据类型 SHELLEXECUTEINFO, , 
    .成员 cbSize, 整数型, , , 结构大小
    .成员 fMask, 整数型, , , 
    .成员 hwnd, 整数型, , , 调用窗口句柄
    .成员 lpVerb, 文本型, , , 动作，如edit,open,print... 
    .成员 lpFile, 文本型, , , 根据lpVerb的值而定，常为文件名
    .成员 lpParameters, 文本型, , , 参数字符串
    .成员 lpDirectory, 文本型, , , 运行路径名
    .成员 nShow, 整数型, , , 显示方式
    .成员 hInstApp, 整数型, , , 
    .成员 lpIDList, 整数型, , , 
    .成员 lpClass, 文本型, , , 
    .成员 hkeyClass, 整数型, , , 
    .成员 dwHotKey, 整数型, , , 
    .成员 hIcon, 整数型, , , 
    .成员 hProcess, 整数型, , , 

数据类型 BITMAPINFOHEADER, , 位图信息头
    .成员 biSize, 整数型, , , 指出本数据结构所需要的字节数(一般为40长度)
    .成员 biWidth, 整数型, , , 以象素为单位，给出BMP图象的宽度
    .成员 biHeight, 整数型, , , 以象素为单位，给出BMP图象的高度
    .成员 biPlanes, 短整数型, , , 输出设备的位平面数，必须置为1
    .成员 biBitCount, 短整数型, , , 给出每个象素的位数
    .成员 biCompression, 整数型, , , 给出位图的压缩类型
    .成员 biSizeImage, 整数型, , , 给出图象字节数的多少
    .成员 biXPelsPerMeter, 整数型, , , 图像的水平分辨率
    .成员 biYPelsPerMeter, 整数型, , , 图象的垂直分辨率
    .成员 biClrUsed, 整数型, , , {色板中图象实际使用的颜色素数
    .成员 biClrImportant, 整数型, , , 给出重要颜色的索引值

数据类型 BITMAPFILEHEADER, , 
    .成员 bfType, 短整数型, , , 
    .成员 bfSize, 整数型, , , 
    .成员 bfReserved1, 短整数型, , , 
    .成员 bfReserved2, 短整数型, , , 
    .成员 bfOffBits, 整数型, , , 

数据类型 RECT, 公开, 矩形数据
    .成员 左边, 整数型, , , 
    .成员 顶边, 整数型, , , 
    .成员 宽度, 整数型, , , 
    .成员 高度, 整数型, , , 


.DLL命令 SHGetFileInfo, 整数型, "", "SHGetFileInfo", , 
    .参数 pszPath, 文本型, , 
    .参数 dwFileAttributes, 整数型, , 
    .参数 psfi, SHFILEINFO, , 
    .参数 cbFileInfo, 整数型, , 
    .参数 uFlags, 整数型, , 

.DLL命令 SHBrowseForFolderA, 整数型, "shell32.dll", "SHBrowseForFolderA", , 浏览文件夹对话框
    .参数 浏览文件夹结构, BROWSEINFO, , 

.DLL命令 SHGetPathFromIDListA, 整数型, "shell32.dll", "SHGetPathFromIDListA", , 从列表id取路径
    .参数 结构指针, 整数型, , pIdl
    .参数 路径, 文本型, 传址, pszPath

.DLL命令 CoTaskMemFree, 空白型, "ole32.dll", "CoTaskMemFree", , 释放分配内容
    .参数 内存块指针, 整数型, , pv

.DLL命令 ILCreateFromPath, 整数型, "Shell32", "ILCreateFromPathA", , 
    .参数 lpFileName, 文本型, , 文件路径

.DLL命令 SHOpenFolderAndSelectItems, 整数型, "", "", , 
    .参数 pidlFolder, 整数型, , 
    .参数 cidl, 整数型, , 
    .参数 apidl, 整数型, , 
    .参数 dwFlags, 整数型, , 

.DLL命令 ShellExecuteEx, 整数型, "shell32.dll", "ShellExecuteEx", 公开, 设定执行文件
    .参数 ShellExecuteEx, SHELLEXECUTEINFO, 传址, 设定执行文件信息结构

.DLL命令 GetDC, 整数型, "user32", "GetDC", , 获取指定窗口的设备场景  指定窗口的设备场景句柄，出错则为0
    .参数 hwnd, 整数型, , 将获取其设备场景的窗口的句柄。若为0，则要获取整个屏幕的DC;

.DLL命令 CreateCompatibleDC, 整数型, "gdi32.dll", "CreateCompatibleDC", 公开, 新设备场景句柄，若出错则为零
    .参数 hdc, 整数型, , hdc，源设备场景句柄

.DLL命令 CreateSolidBrush, 整数型, "gdi32", "CreateSolidBrush", , 用纯色创建一个刷子  如执行成功，返回新刷子的一个句柄；否则返回零
    .参数 crColor, 整数型, , 数字的RGB彩色;

.DLL命令 FillRect, 整数型, "user32", "FillRect", , 用指定的刷子填充一个矩形  非零表示成功，零表示失败。会设置GetLastError
    .参数 hdc, 整数型, , 设备场景的句柄
    .参数 lpRect, RECT, , RECT，对填充区域进行描述的一个矩形，采用逻辑坐标
    .参数 hBrush, 整数型, , 欲使用的刷子的句柄;

.DLL命令 DeleteDC, 整数型, "", "", , 删除专用设备场景或信息场景，释放所有相关窗口资源。不要将它用于GetDC函数取回的设备场景
    .参数 hdc, 整数型, , 

.DLL命令 CreateDIBSection, 整数型, "gdi32.dll", "CreateDIBSection", , 
    .参数 hDC, 整数型, , 
    .参数 pBitmapInfo, 字节集, 传址, 
    .参数 un, 整数型, , 
    .参数 lplpVoid, 整数型, 传址, 
    .参数 handle, 整数型, , 
    .参数 dw, 整数型, , 

.DLL命令 BitBlt, 整数型, "gdi32.dll", "BitBlt", , 
    .参数 hDestDC, 整数型, , 
    .参数 x, 整数型, , 
    .参数 y, 整数型, , 
    .参数 nWidth, 整数型, , 
    .参数 nHeight, 整数型, , 
    .参数 hSrcDC, 整数型, , 
    .参数 xSrc, 整数型, , 
    .参数 ySrc, 整数型, , 
    .参数 dwRop, 整数型, , 

.DLL命令 GdiFlush, 整数型, "gdi32.dll", "GdiFlush", , 执行任何未决的绘图操作,如所有未决的绘图操作都成功完成，就返回TRUE（非零）。如任何一个操作失败，就返回零值

.DLL命令 CreateCompatibleBitmap, 整数型, "gdi32.dll", "CreateCompatibleBitmap", 公开, 执行成功返回位图句柄，零表示失败
    .参数 hdc, 整数型, , 设备场景句柄
    .参数 nWidth, 整数型, , 位图宽度
    .参数 nHeight, 整数型, , 位图高度

.DLL命令 DrawIconEx, 整数型, "", "DrawIconEx", 公开, 描绘一个图标或鼠标指针
    .参数 hdc, 空白型, , 
    .参数 xLeft, 空白型, , 
    .参数 yTop, 空白型, , 
    .参数 hIcon, 空白型, , 
    .参数 cxWidth, 空白型, , 
    .参数 cyWidth, 空白型, , 
    .参数 istepIfAniCur, 空白型, , 
    .参数 hbrFlickerFreeDraw, 空白型, , 
    .参数 diFlags, 空白型, , 

.DLL命令 SelectObject, 整数型, "gdi32.dll", "SelectObject", 公开, 选入设备场景
    .参数 场景句柄, 整数型, , hdc
    .参数 对象句柄, 整数型, , hobject

.DLL命令 ReleaseDC, 整数型, "user32", "ReleaseDC", , 释放由调用GetDC或GetWindowDC函数获取的指定设备场景。它对类或私有设备场景无效（但这样的调用不会造成损害）  执行成功为1，否则为0
    .参数 hwnd, 整数型, , 要释放的设备场景相关的窗口句柄
    .参数 hdc, 整数型, , 要释放的设备场景句柄;

.DLL命令 DeleteObject, 整数型, "gdi32.dll", "DeleteObject", 公开, 删除对象 用这个函数删除GDI对象，比如画笔、刷子、字体、位图、区域以及调色板等等。对象使用的所有系统资源都会被释放  非零表示成功，零表示失败
    .参数 hObject, 整数型, , 一个GDI对象的句柄;

.DLL命令 RtlMoveMemory_int, 空白型, "Kernel32.dll", "RtlMoveMemory", , 复制内存(无返回值)
    .参数 Destination, 整数型, , 目的指针
    .参数 Source, 整数型, , 源指针
    .参数 Length, 整数型, , 复制长度

.DLL命令 lstrcpyn, 整数型, "kernel32", "lstrcpynA", , 取内存变量地址
    .参数 lpString1, 字节集, 传址, 传址
    .参数 lpString2, 字节集, 传址, 
    .参数 iMaxLength, 整数型, , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 程序集_xml, 未知类型0x30001, , , 
.程序集变量 程序集_分类按钮, 按钮, , "0", 分类数组,利用复制窗口组件实现动态添加分类
.程序集变量 程序集_父节点名称, 文本型, , , 
.程序集变量 程序集_图片组, 字节集, , , 超级列表框1的图片组,索引0是IE图标
.子程序 __启动窗口_创建完毕, 空白型, , 
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

 ' 没有美化主题..自己搞点皮肤吧..呵呵..
_窗口_百宝箱_初始化 ()

.子程序 _窗口_百宝箱_初始化, 空白型, , 
.局部变量 局部_分类, 文本型, , "0", 
.局部变量 i, 整数型, , , 

_图片组初始化 ()
.移动 (.左边, .顶边, .宽度, .高度)
赋值 (.可视, 真)
赋值 (.字体, .字体)
赋值 (.文本颜色, #白色)
赋值 (.背景颜色, 15118607)
.调整层次 ()
赋值 (.标题, “全部分类”)
全部删除 ()
.计次循环首 (取数组成员数 (程序集_分类按钮), i)
    程序集_分类按钮.销毁 ( [i], ) ' 把已创建的按钮从内存里销毁
.计次循环尾 ()
赋值 (.最大位置, 0)
赋值 (.位置, 0)
赋值 (程序集_父节点名称, “ToolBox”)
.如果 (程序集_xml.未知支持库函数_1 (相加 (取运行目录 (), “\ToolBox.xml”)))
    .如果真 (程序集_xml.未知支持库函数_4 (程序集_父节点名称))
        .如果真 (程序集_xml.未知支持库函数_6 (程序集_父节点名称, 局部_分类))
            重定义数组 (程序集_分类按钮, 假, 取数组成员数 (局部_分类))
            .计次循环首 (取数组成员数 (局部_分类), i)
                复制窗口组件 (程序集_分类按钮 [i])
                赋值 (程序集_分类按钮 [i], 标题, 局部_分类 [i])
                 ' 本源码来自易语言资源网(www.5A5X.com)
                赋值 (程序集_分类按钮 [i], 标记, 到文本 (i))
                程序集_分类按钮.置父窗口 ( [i], )
                赋值 (程序集_分类按钮 [i], 可视, 真)
                赋值 (程序集_分类按钮 [i], 顶边, 相加 (.顶边, 相乘 (.高度, i)))
                .如果真 (大于或等于 (相加 (程序集_分类按钮 [i], 顶边, 24), .高度))
                    赋值 (程序集_分类按钮 [i], 可视, 假)
                    赋值 (.可视, 真)
                    赋值 (.最大位置, 相加 (.最大位置, 1))
                .如果真结束
                .如果真 (等于 (.标题, 程序集_分类按钮 [i], 标题))
                    _填充事件 (程序集_分类按钮 [i])
                .如果真结束
                
            .计次循环尾 ()
            .调整层次 ()
            .调整层次 ()
            .如果真 (或者 (等于 (.标题, “”), 等于 (.标题, “全部分类”), 等于 (.标题, “标签”)))
                赋值 (.标题, “全部分类”)
                _填充事件 ()
            .如果真结束
            返回 ()
        .如果真结束
        调试输出 (“取子节点名称失败”)
        返回 ()
    .如果真结束
    调试输出 (“取父名称失败”)
    返回 ()
.否则
    程序集_xml.未知支持库函数_0 (程序集_父节点名称)
.如果结束
调试输出 (“导入失败”)
返回 ()


.子程序 _图片组初始化, 空白型, , 
.局部变量 sInfo, SHFILEINFO, , , 

赋值 (程序集_图片组, 未知支持库函数_30 (32, 32))
SHGetFileInfo (“C:\Program Files\Internet Explorer\IEXPLORE.EXE”, 128, sInfo, 348, #SHGFI_ICON)
未知支持库函数_24 (程序集_图片组, 通过句柄取图标 (sInfo.hIcon, 32, 32, .), )

.子程序 _按钮_全部分类_被单击, 空白型, , 
.局部变量 局部_按钮, 按钮, , , 

赋值 (局部_按钮, 取事件组件 ())
_填充事件 (局部_按钮)

.子程序 _填充事件, 空白型, , 
.参数 按钮, 按钮, , 

.局部变量 i, 整数型, , , 

赋值 (.可视, 真)
赋值 (.标题, 按钮.标题)
按钮.移动 (.左边, 按钮.顶边, 按钮.宽度, 按钮.高度)
赋值 (.标记, 按钮.标记)
赋值 (.标记, 按钮.标题)
全部删除 ()
.判断开始 (等于 (按钮.标题, “全部分类”))
    .计次循环首 (取数组成员数 (程序集_分类按钮), i)
        _填充 (i)
    .计次循环尾 ()
.默认
    _填充 (到整数 (.标记))
.判断结束


.子程序 _填充, 空白型, , 
.参数 索引, 空白型, , 按钮数组索引..从1开始

.局部变量 局部_返回文本数组, 文本型, , "0", 
.局部变量 i, 整数型, , , 
.局部变量 局部_文件名称, 文本型, , , 
.局部变量 局部_文件路径, 文本型, , , 
.局部变量 局部_图标索引, 整数型, , , 

.如果真 (程序集_xml.未知支持库函数_9 (相加 (程序集_父节点名称, “/”, 程序集_分类按钮 [索引], 标题, “/”), 局部_返回文本数组))
    .计次循环首 (取数组成员数 (局部_返回文本数组), i)
        赋值 (局部_文件名称, 局部_返回文本数组 [i])
        .如果真 (程序集_xml.未知支持库函数_10 (相加 (程序集_父节点名称, “/”, 程序集_分类按钮 [索引], 标题, “/”), 局部_文件名称, 局部_文件路径))
             ' 调试输出 (局部_文件名称, 局部_文件路径)
            赋值 (局部_图标索引, _加入图标 (局部_文件路径))
            .如果真 (不等于 (局部_图标索引, -1))
                .插入表项 (局部_文件名称, 局部_图标索引, , , 索引)
            .如果真结束
            
        .如果真结束
        
    .计次循环尾 ()
.如果真结束


.子程序 _加入图标, 整数型, , 取路径图标.成功则返回图片索引,失败返回-1
.参数 文件路径, 文本型, , 提供欲提取图标的路径

.局部变量 图标句柄, 整数型, , , 
.局部变量 sInfo, SHFILEINFO, , , 
.局部变量 临时图标, 字节集, , , 
.局部变量 局部_图片索引, 整数型, , , 
.局部变量 局部_文件属性, 整数型, , , 

.如果真 (不等于 (文件路径, “”))
    .判断开始 (或者 (近似等于 (文件路径, “htt://”), 不等于 (寻找文本 (文件路径, “.com”, , 假), -1))) ' 判断是否网址,如果是的话就返回索引0即IE图标
        返回 (0)
    .默认
        赋值 (局部_文件属性, 取文件属性 (文件路径))
        .如果真 (或者 (等于 (局部_文件属性, 16), 等于 (局部_文件属性, 22), 等于 (局部_文件属性, 32))) ' 判断文件路径是否有效(是否存在)
            SHGetFileInfo (文件路径, 128, sInfo, 348, #SHGFI_ICON)
            赋值 (图标句柄, sInfo.hIcon)
            赋值 (临时图标, 通过句柄取图标 (图标句柄, 32, 32, .))
            赋值 (局部_图片索引, 未知支持库函数_24 (程序集_图片组, 临时图标, ))
            赋值 (., 程序集_图片组)
            返回 (局部_图片索引)
        .如果真结束
        
    .判断结束
    
.如果真结束
返回 (-1)

.子程序 _按钮_添加分类_被单击, 空白型, , 
_显示对话框 (“添加分类”)

.子程序 _按钮_修改分类_被单击, 空白型, , 
_显示对话框 (“修改分类”)

.子程序 _按钮_删除分类_被单击, 空白型, , 
.如果真 (等于 (信息框 (相加 (“确定继续删除分类?”, #换行符, “该操作将会删除分类及分类下的工具后无法还原.”, #换行符, “继续删除请点击'确定'”), 相加 (1, 相乘 (#位于前台, 4)), ), #确认钮))
    .如果 (程序集_xml.未知支持库函数_13 (相加 (程序集_父节点名称, “/”, .标记)))
        程序集_xml.未知支持库函数_2 (相加 (取运行目录 (), “\ToolBox.xml”), “gb2312”, , )
        _窗口_百宝箱_初始化 ()
        信息框 (“删除成功!”, 相加 (相乘 (#位于前台, 4), 64), )
    .否则
        信息框 (“删除失败!”, 相加 (相乘 (#位于前台, 4), 16), )
    .如果结束
    
.如果真结束


.子程序 _显示对话框, 空白型, , 外形框_对话框 
.参数 _标题, 文本型, , 

赋值 (.可视, 真)
赋值 (.标题, _标题)
.判断开始 (等于 (_标题, “添加网址”))
    连续赋值 (83, .顶边, .顶边)
    相减 (相除 (., 2), 相除 (.宽度, 2)).移动 (相减 (相除 (., 2), 相除 (.高度, 2)), 294, 117)
    13.移动 (57, 55, 12)
    赋值 (.可视, 真)
    71.移动 (51, 216, 20)
    赋值 (.可视, 真)
    175.移动 (83, 42, 22)
    235.移动 (83, 42, 22)
    赋值 (.标题, “网站地址:”)
    70.移动 (26, 216, 20)
    赋值 (.最大允许长度, 0)
.判断 (等于 (_标题, “重命名”))
    赋值 (.最大允许长度, 14)
    146.移动 (83, 42, 22)
    197.移动 (83, 42, 22)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    12.移动 (31, 218, 12)
    16.移动 (56, 216, 20)
    赋值 (.标题, “请输入修改后的名称:”)
    相减 (相除 (., 2), 相除 (.宽度, 2)).移动 (相减 (相除 (., 2), 相除 (.高度, 2)), 244, 112)
    赋值 (.内容, .取标题 (., 0))
    赋值 (.被选择字符数, -1)
.判断 (或者 (等于 (_标题, “添加分类”), 等于 (_标题, “修改分类”)))
    赋值 (.最大允许长度, 14)
    146.移动 (83, 42, 22)
    197.移动 (83, 42, 22)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    12.移动 (31, 218, 12)
    16.移动 (56, 216, 20)
    赋值 (.标题, “请输入分类名称:”)
    相减 (相除 (., 2), 相除 (.宽度, 2)).移动 (相减 (相除 (., 2), 相除 (.高度, 2)), 244, 112)
.默认
    
.判断结束
获取焦点 ()
赋值 (.宽度, 相减 (.宽度, 2))


.子程序 _按钮_添加工具_被单击, 空白型, , 
.局部变量 局部_文件名, 文本型, , , 
.局部变量 局部_图标索引, 整数型, , , 

.如果真 (打开 ())
    赋值 (局部_文件名, 取文本中间 (.文件名, 相加 (倒找文本 (.文件名, “\”, , 假), 1), 相减 (倒找文本 (.文件名, “.exe”, , 假), 倒找文本 (.文件名, “\”, , 假), 1)))
    赋值 (局部_图标索引, _加入图标 (.文件名))
    .如果真 (不等于 (局部_图标索引, -1))
        .插入表项 (局部_文件名, 局部_图标索引, , , )
        .如果 (等于 (取数组成员数 (程序集_分类按钮), 0))
            程序集_xml.未知支持库函数_11 (程序集_父节点名称, “未分类”, “”, )
            程序集_xml.未知支持库函数_12 (相加 (程序集_父节点名称, “/未分类”), 局部_文件名, .文件名)
        .否则
            程序集_xml.未知支持库函数_12 (相加 (程序集_父节点名称, “/”, 选择 (等于 (.标记, “全部分类”), “未分类”, .标记)), 局部_文件名, .文件名)
        .如果结束
        _刷新 ()
    .如果真结束
    
.如果真结束


.子程序 _标签_标题_鼠标左键被按下, 逻辑型, , 移动(外形框_对话框)
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

161.投递信息 (2, 0) ' 按住鼠标可以移动(外形框_对话框)

.子程序 _按钮_取消_被单击, 空白型, , 隐藏(外形框_对话框)
赋值 (.可视, 假)
赋值 (.内容, “”)

.子程序 _按钮_确定_被单击, 空白型, , 
.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“内容不能为空”, 相乘 (#位于前台, 4), )
    返回 ()
.如果真结束
.如果真 (并且 (等于 (.可视, 真), 等于 (删全部空 (.内容), “”)))
    信息框 (“内容不能为空”, 相乘 (#位于前台, 4), )
    返回 ()
.如果真结束
.判断开始 (等于 (.标题, “添加分类”))
    .如果 (程序集_xml.未知支持库函数_11 (程序集_父节点名称, 删首尾空 (.内容), “”, ))
        信息框 (“添加成功!”, 相加 (相乘 (#位于前台, 4), 64), )
    .否则
        信息框 (“添加失败!”, 相加 (相乘 (#位于前台, 4), 16), )
        返回 ()
    .如果结束
    
.判断 (等于 (.标题, “修改分类”))
    .如果 (程序集_xml.未知支持库函数_15 (相加 (程序集_父节点名称, “/”, .标记), 相加 (程序集_父节点名称, “/”, 删首尾空 (.内容))))
        信息框 (“修改成功!”, 相加 (相乘 (#位于前台, 4), 64), )
    .否则
        信息框 (“修改失败!”, 相加 (相乘 (#位于前台, 4), 16), )
        返回 ()
    .如果结束
    
.判断 (等于 (.标题, “添加网址”))
    .如果 (程序集_xml.未知支持库函数_12 (相加 (程序集_父节点名称, “/”, 选择 (等于 (.标记, “全部分类”), “未分类”, .标记)), 删首尾空 (.内容), 删首尾空 (.内容)))
        .插入表项 (删首尾空 (.内容), 0, , , )
        信息框 (“添加成功!”, 相加 (相乘 (#位于前台, 4), 64), )
    .否则
        信息框 (“添加失败!”, 相加 (相乘 (#位于前台, 4), 16), )
        返回 ()
    .如果结束
    
    
.判断 (等于 (.标题, “重命名”))
    .如果 (程序集_xml.未知支持库函数_18 (相加 (程序集_父节点名称, “/”, 选择 (等于 (.标记, “全部分类”), “未分类”, .标记)), .取标题 (., 0), 删首尾空 (.内容)))
        信息框 (“添加成功!”, 相加 (相乘 (#位于前台, 4), 64), )
    .否则
        信息框 (“添加失败!”, 相加 (相乘 (#位于前台, 4), 16), )
        返回 ()
    .如果结束
    
.默认
    
.判断结束
赋值 (.可视, 假)
赋值 (.内容, “”)
_刷新 ()

.子程序 _刷新, 空白型, , 
程序集_xml.未知支持库函数_2 (相加 (取运行目录 (), “\ToolBox.xml”), “gb2312”, , )
_窗口_百宝箱_初始化 ()

.子程序 _按钮_添加目录_被单击, 空白型, , 
.局部变量 局部_返回值, 整数型, , , 
.局部变量 局部_文本, 文本型, , , 
.局部变量 局部_浏览文件夹结构, BROWSEINFO, , , 
.局部变量 局部_图标索引, 整数型, , , 
.局部变量 局部_路径, 文本型, , , 

赋值 (局部_浏览文件夹结构.hOwner, 取窗口句柄 ())
赋值 (局部_浏览文件夹结构.lpszTitle, “请您选择要保存的目录”)
赋值 (局部_浏览文件夹结构.ulFlags, #BIF_RETURNONLYFSDIRS)
赋值 (局部_返回值, SHBrowseForFolderA (局部_浏览文件夹结构))
.如果真 (不等于 (局部_返回值, 0))
    赋值 (局部_文本, 取空白文本 (260))
    SHGetPathFromIDListA (局部_返回值, 局部_文本)
    CoTaskMemFree (局部_返回值)
    赋值 (局部_路径, 局部_文本)
    .如果真 (不等于 (取文本右边 (局部_文本, 1), “\”))
        赋值 (局部_路径, 相加 (局部_文本, “\”))
    .如果真结束
    赋值 (局部_图标索引, _加入图标 (局部_路径))
    .如果真 (不等于 (局部_图标索引, -1))
        .插入表项 (局部_文本, 局部_图标索引, , , )
        .如果 (等于 (取数组成员数 (程序集_分类按钮), 0))
            程序集_xml.未知支持库函数_11 (程序集_父节点名称, “未分类”, “”, )
            程序集_xml.未知支持库函数_12 (相加 (程序集_父节点名称, “/未分类”), 局部_文本, 局部_路径)
        .否则
            程序集_xml.未知支持库函数_12 (相加 (程序集_父节点名称, “/”, 选择 (等于 (.标记, “全部分类”), “未分类”, .标记)), 局部_文本, 局部_路径)
        .如果结束
        _刷新 ()
    .如果真结束
     ' 本源码来自易语言资源网(www.5A5X.com)
.如果真结束


.子程序 _纵向滚动条1_位置被改变, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 局部_索引, 整数型, , , 

.如果真 (等于 (相加 (.位置, 1), .最大位置))
    返回 () ' 本源码来自易语言资源网(www.5A5X.com)
.如果真结束
.计次循环首 (取数组成员数 (程序集_分类按钮), i)
    赋值 (程序集_分类按钮 [i], 可视, 真)
    赋值 (程序集_分类按钮 [i], 顶边, 相加 (.顶边, 相乘 (.高度, 相减 (i, .位置))))
     ' 调试输出 (纵向滚动条1.位置, 按钮_全部分类.高度 × (i － 纵向滚动条1.位置))
    .如果真 (大于或等于 (相加 (程序集_分类按钮 [i], 顶边, 24), .高度))
        赋值 (程序集_分类按钮 [i], 可视, 假)
        赋值 (.可视, 真)
    .如果真结束
    
.计次循环尾 ()
.计次循环首 (.位置, i)
    赋值 (程序集_分类按钮 [i], 可视, 假)
.计次循环尾 ()
.如果真 (并且 (不等于 (.标记, “0”), 不等于 (.标记, “”)))
    赋值 (局部_索引, 到整数 (.标记))
    赋值 (.顶边, 程序集_分类按钮 [局部_索引], 顶边)
    赋值 (.可视, 程序集_分类按钮 [局部_索引], 可视)
    
.如果真结束


.子程序 __启动窗口_尺寸被改变, 空白型, , 
.局部变量 i, 整数型, , , 

.移动 (相加 (相减 (., .顶边), 1))
.移动 (相加 (相减 (., .角度), 1), 相加 (相减 (., .顶边), 1))
赋值 (.最大位置, 0)
.计次循环首 (取数组成员数 (程序集_分类按钮), i)
    赋值 (程序集_分类按钮 [i], 可视, 真)
    赋值 (.可视, 假)
    .如果真 (大于或等于 (相加 (程序集_分类按钮 [i], 顶边, 24), .高度))
        赋值 (程序集_分类按钮 [i], 可视, 假)
        赋值 (.可视, 真)
        赋值 (.最大位置, 相加 (.最大位置, 1))
    .如果真结束
    
.计次循环尾 ()



.子程序 _按钮_添加网址_被单击, 空白型, , 
_显示对话框 (“添加网址”)

.子程序 _按钮_删除选中_被单击, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 局部_索引, 整数型, , , 

.计次循环首 (取表项数 (), i)
    .如果真 (相减 (i, 1).是否被选择 ())
        .如果 (等于 (.标记, “全部分类”))
            赋值 (局部_索引, 相减 (i, 1).取表项数值 ())
            .如果真 (程序集_xml.未知支持库函数_14 (相加 (程序集_父节点名称, “/”, 程序集_分类按钮 [局部_索引], 标题), 相减 (i, 1).取标题 (0)))
                调试输出 (“已删除”)
            .如果真结束
            
        .否则
            .如果真 (程序集_xml.未知支持库函数_14 (相加 (程序集_父节点名称, “/”, .标记), 相减 (i, 1).取标题 (0)))
                调试输出 (“已删除”)
            .如果真结束
            
        .如果结束
        
    .如果真结束
    
.计次循环尾 ()
_刷新 ()


.子程序 _超级列表框1_右键单击表项, 空白型, , 
弹出菜单 ()

.子程序 _超级列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_运行 (1)

.子程序 _运行, 空白型, , 
.参数 方式, 整数型, , 1.运行 2.记事本方式打开 3.复制名称 4.复制路径 5.打开所在文件夹 6.打开属性

.局部变量 局部_索引, 整数型, , , 
.局部变量 局部_路径, 文本型, , , 
.局部变量 局部_文件大小, 长整数型, , , 
.局部变量 局部_临时路径, 文本型, , , 
.局部变量 局部_位置, 整数型, , , 

赋值 (局部_索引, .取表项数值 (.))
程序集_xml.未知支持库函数_10 (相加 (程序集_父节点名称, “/”, 程序集_分类按钮 [局部_索引], 标题), .取标题 (., 0), 局部_路径)
.判断开始 (等于 (方式, 1))
    未知支持库函数_6 (4, 局部_路径, , , )
.判断 (等于 (方式, 2))
    赋值 (局部_文件大小, 取文件尺寸 (局部_路径))
    调试输出 (局部_文件大小)
    .判断开始 (小于或等于 (局部_文件大小, 0))
        信息框 (“该文件无法使用记事本打开!”, 相加 (16, 相乘 (#位于前台, 4)), )
    .判断 (大于或等于 (局部_文件大小, 相乘 (20, 1024, 1024)))
        .如果真 (等于 (信息框 (相加 (“文件 ”, 局部_路径, “ 太长，可能需要很长时间才能打开，是否确认要打开。或者请使用其他编辑器！”), 相加 (相乘 (#位于前台, 4), #是否钮), ), #否钮))
            返回 ()
        .如果真结束
        
    .默认
        
    .判断结束
    运行 (相加 (“notepad.exe ”, 局部_路径), 假, )
.判断 (等于 (方式, 3))
    .如果真 (置剪辑板文本 (.取标题 (., 0)))
        信息框 (“名称已复制”, 相加 (64, 相乘 (#位于前台, 4)), )
    .如果真结束
    
.判断 (等于 (方式, 4))
    .如果真 (置剪辑板文本 (局部_路径))
        信息框 (“路径已复制”, 相加 (64, 相乘 (#位于前台, 4)), )
    .如果真结束
    
.判断 (等于 (方式, 5))
    _文件定位 (局部_路径)
.判断 (等于 (方式, 6))
    _查看属性 (局部_路径)
.默认
    
.判断结束


.子程序 _文件定位, 空白型, , 
.参数 路径, 文本型, , 

.局部变量 lngPidl, 整数型, , , 

赋值 (lngPidl, ILCreateFromPath (路径))
.如果真 (不等于 (lngPidl, 0))
    SHOpenFolderAndSelectItems (lngPidl, 0, 0, 0)
.如果真结束


.子程序 _查看属性, 空白型, , 
.参数 路径, 文本型, , 

.局部变量 sei, SHELLEXECUTEINFO, , , 

赋值 (sei.hwnd, 取窗口句柄 ())
赋值 (sei.lpVerb, “properties”)
赋值 (sei.lpFile, 路径)
赋值 (sei.fMask, #SEE_MASK_INVOKEIDLIST)
赋值 (sei.cbSize, 60)
ShellExecuteEx (sei)
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _打开_被选择, 空白型, , 
_运行 (1)

.子程序 _用记事本打开_被选择, 空白型, , 
_运行 (2)

.子程序 _复制名称_被选择, 空白型, , 
_运行 (3)

.子程序 _复制路径_被选择, 空白型, , 
_运行 (4)

.子程序 _打开所在文件夹_被选择, 空白型, , 
_运行 (5)

.子程序 _删除_被选择, 空白型, , 
_按钮_删除选中_被单击 ()

.子程序 _重命名_被选择, 空白型, , 
_显示对话框 (“重命名”)

.子程序 _属性_被选择, 空白型, , 
_运行 (6)

.子程序 通过句柄取图标, 字节集, , 
.参数 图标句柄, 整数型, , 
.参数 图标宽度, 整数型, 可空, 
.参数 图标高度, 整数型, 可空, 
.参数 背景颜色, 整数型, 可空, 

.局部变量 sRect, RECT, , , 
.局部变量 sIco, 字节集, , , 
.局部变量 位图操作, 位图操作类, , , 
.局部变量 SrchDC, 整数型, , , 
.局部变量 newDC, 整数型, , , 
.局部变量 hwnd, 整数型, , , 
.局部变量 hBmp, 整数型, , , 
.局部变量 hBmpPrev, 整数型, , , 
.局部变量 mBrush, 整数型, , , 

.如果真 (是否为空 (图标宽度))
    赋值 (图标宽度, 32)
.如果真结束
.如果真 (是否为空 (图标高度))
    赋值 (图标高度, 32)
.如果真结束
.如果真 (是否为空 (背景颜色))
    赋值 (背景颜色, #白色)
.如果真结束
赋值 (sRect.顶边, 0)
赋值 (sRect.左边, 0)
赋值 (sRect.宽度, 图标宽度)
赋值 (sRect.高度, 图标高度)
赋值 (SrchDC, GetDC (取窗口句柄 ()))
赋值 (newDC, CreateCompatibleDC (SrchDC))
赋值 (hBmp, CreateCompatibleBitmap (SrchDC, 图标宽度, 图标高度))
赋值 (hBmpPrev, SelectObject (newDC, hBmp))
赋值 (mBrush, CreateSolidBrush (背景颜色))
FillRect (newDC, sRect, mBrush)
DrawIconEx (newDC, 0, 0, 图标句柄, 图标宽度, 图标高度, 0, 0, 3)
位图操作.CaptureDC (newDC, sRect, 32)
赋值 (sIco, 位图操作.Write ())
ReleaseDC (hwnd, SrchDC)
DeleteDC (newDC)
DeleteObject (hBmpPrev)
DeleteObject (hBmp)
DeleteObject (mBrush)
返回 (sIco)

.类模块 位图操作类, , , 

.程序集变量 颜色表_1位深, 字节集, , , 2色biBitCount=1
.程序集变量 颜色表_4位深, 字节集, , , 16色biBitCount=4
.程序集变量 颜色表_8位深, 字节集, , , 256色biBitCount=8
.程序集变量 m_pDIB, 字节集, , , 位图数据
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
初始化颜色表 ()

.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--


.子程序 初始化颜色表, 空白型, , 
赋值 (颜色表_1位深, {  })
赋值 (颜色表_1位深, 相加 (颜色表_1位深, { 0, 0, 0, 0 }))
赋值 (颜色表_1位深, 相加 (颜色表_1位深, { 255, 255, 255, 0 }))
赋值 (颜色表_4位深, {  })
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 0, 0, 0, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 0, 0, 128, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 0, 128, 0, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 0, 128, 128, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 128, 0, 0, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 128, 0, 128, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 128, 128, 0, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 128, 128, 128, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 192, 192, 192, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 0, 0, 255, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 0, 255, 0, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 0, 255, 255, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 255, 0, 0, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 255, 0, 255, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 255, 255, 0, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 255, 255, 255, 0 }))
赋值 (颜色表_8位深, {  }) ' 本源码来自易语言资源网(www.5A5X.com)
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 0, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 0, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 128, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 128, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 0, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 0, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 128, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 192, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 220, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 240, 202, 166, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 32, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 32, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 32, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 32, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 32, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 32, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 64, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 64, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 64, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 64, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 64, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 64, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 64, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 64, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 96, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 96, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 96, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 96, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 96, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 96, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 96, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 96, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 128, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 128, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 128, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 128, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 128, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 128, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 128, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 128, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 160, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 160, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 160, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 160, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 160, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 160, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 160, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 160, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 192, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 192, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 192, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 192, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 192, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 192, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 192, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 192, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 224, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 224, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 224, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 224, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 224, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 224, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 224, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 224, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 0, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 0, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 0, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 0, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 0, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 0, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 0, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 0, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 32, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 32, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 32, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 32, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 32, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 32, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 32, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 32, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 64, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 64, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 64, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 64, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 64, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 64, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 64, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 64, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 96, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 96, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 96, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 96, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 96, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 96, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 96, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 96, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 128, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 128, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 128, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 128, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 128, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 128, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 128, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 128, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 160, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 160, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 160, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 160, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 160, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 160, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 160, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 160, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 192, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 192, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 192, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 192, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 192, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 192, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 192, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 192, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 224, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 224, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 224, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 224, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 224, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 224, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 224, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 224, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 0, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 0, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 0, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 0, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 0, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 0, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 0, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 0, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 32, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 32, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 32, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 32, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 32, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 32, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 32, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 32, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 64, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 64, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 64, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 64, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 64, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 64, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 64, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 64, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 96, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 96, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 96, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 96, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 96, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 96, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 96, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 96, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 128, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 128, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 128, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 128, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 128, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 128, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 128, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 128, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 160, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 160, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 160, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 160, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 160, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 160, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 160, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 160, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 192, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 192, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 192, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 192, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 192, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 192, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 192, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 192, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 224, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 224, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 224, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 224, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 224, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 224, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 224, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 224, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 0, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 0, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 0, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 0, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 0, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 0, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 0, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 0, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 32, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 32, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 32, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 32, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 32, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 32, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 32, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 32, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 64, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 64, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 64, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 64, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 64, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 64, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 64, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 64, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 96, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 96, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 96, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 96, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 96, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 96, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 96, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 96, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 128, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 128, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 128, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 128, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 128, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 128, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 128, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 128, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 160, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 160, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 160, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 160, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 160, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 160, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 160, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 160, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 192, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 192, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 192, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 192, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 192, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 192, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 240, 251, 255, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 164, 160, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 128, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 0, 255, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 255, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 255, 255, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 255, 0, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 255, 0, 255, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 255, 255, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 255, 255, 255, 0 }))


.子程序 CaptureDC, 逻辑型, 公开, 复制DC上的内容到DIB 即取得DC上的内容,比如抓屏
.参数 hSrcDC, 整数型, , DC
.参数 SrcRect, RECT, , 区域
.参数 nBitCount, 整数型, , 位深1、4、8、16、24、32

.局部变量 nSrcWidth, 整数型, , , 
.局部变量 nSrcHeithe, 整数型, , , 
.局部变量 hMemDC, 整数型, , , 
.局部变量 hDibSect, 整数型, , , 
.局部变量 hOldBitmap, 整数型, , , 
.局部变量 pSrcBits, 整数型, , , 
.局部变量 R, 整数型, , , 

 ' 判断位深是否符合要求
.如果真 (或者 (等于 (hSrcDC, 0), 并且 (不等于 (nBitCount, 1), 不等于 (nBitCount, 4), 不等于 (nBitCount, 8), 不等于 (nBitCount, 16), 不等于 (nBitCount, 24), 不等于 (nBitCount, 32))))
    返回 (假)
.如果真结束
赋值 (nSrcWidth, 相减 (SrcRect.宽度, SrcRect.左边)) ' 算出位图宽度
赋值 (nSrcHeithe, 相减 (SrcRect.高度, SrcRect.左边)) ' 算出位图高度
 ' 确保该dib的大小,颜色位数符合要求
.如果真 (或者 (等于 (m_pDIB, {  }), 不等于 (GetBitCount (), nBitCount), 不等于 (GetWidth (), nSrcWidth), 不等于 (GetHeight (), nSrcHeithe)))
    赋值 (m_pDIB, {  })
    Create (nSrcWidth, nSrcHeithe, nBitCount, )
.如果真结束
 ' 创建DibSection并选进以MemDC
赋值 (hMemDC, CreateCompatibleDC (hSrcDC))
赋值 (pSrcBits, 0)
赋值 (hDibSect, CreateDIBSection (hSrcDC, m_pDIB, #DIB_RGB_COLORS, pSrcBits, 0, 0))
赋值 (hOldBitmap, SelectObject (hMemDC, hDibSect))
 ' 复制源dc内容到MemDC即到DibSection
BitBlt (hMemDC, 0, 0, nSrcWidth, nSrcHeithe, hSrcDC, SrcRect.左边, SrcRect.顶边, #SRCCOPY)
GdiFlush ()
 ' 复制位图点阵数据到本DIB对象
RtlMoveMemory_int (GetBitsAddress (), pSrcBits, GetBitsSize ())
 ' 删除相关句柄
赋值 (R, DeleteObject (SelectObject (hMemDC, hOldBitmap)))
赋值 (R, DeleteObject (hOldBitmap))
DeleteDC (hMemDC)
返回 (真)

.子程序 GetBitsAddress, 整数型, , 颜色点阵地址
.如果真 (等于 (m_pDIB, {  }))
    输出调试文本 (“颜色点阵地址失败”)
.如果真结束
返回 (相加 (lstrcpyn (m_pDIB, m_pDIB, 0), 40, GetColorTableSize ()))

.子程序 GetBitsSize, 整数型, , 颜色点阵大小
.局部变量 r, 空白型, , , 

.如果真 (等于 (m_pDIB, {  }))
    输出调试文本 (“取颜色点阵大小失败”)
.如果真结束
赋值 (r, BytesPerLine ())
返回 (相乘 (GetHeight (), BytesPerLine ()))


.子程序 BytesPerLine, 整数型, , 
.如果真 (等于 (m_pDIB, {  }))
    输出调试文本 (“BytesPerLine失败”)
.如果真结束
返回 (WIDTHBYTES (相乘 (取字节集数据 (取字节集中间 (m_pDIB, 5, 4), #整数型, ), 取字节集数据 (取字节集中间 (m_pDIB, 13, 2), #整数型, ), 取字节集数据 (取字节集中间 (m_pDIB, 15, 2), #整数型, ))))

.子程序 Create, 逻辑型, , 创建一幅指定大小的位图
.参数 iWidth, 整数型, , 宽度
.参数 iHeight, 整数型, , 高度
.参数 nBitCount, 整数型, , 位深
.参数 clrBk, 长整数型, 可空, 默认填充的颜色,4294967295

.局部变量 iColors, 整数型, , , 
.局部变量 iSize, 整数型, , , 
.局部变量 pBI, BITMAPINFOHEADER, , , 

.如果真 (等于 (是否为空 (clrBk), 真))
    赋值 (clrBk, 4294967295)
.如果真结束
.如果 (等于 (nBitCount, 1))
    赋值 (iColors, 2)
.否则
    .如果 (等于 (nBitCount, 4))
        赋值 (iColors, 16)
    .否则
        .如果 (等于 (nBitCount, 8))
            赋值 (iColors, 256)
        .否则
            .如果 (或者 (等于 (nBitCount, 16), 等于 (nBitCount, 24), 等于 (nBitCount, 32)))
                赋值 (iColors, 0)
            .否则
                输出调试文本 (“Bmp提供的位深有错误”)
                返回 (假)
            .如果结束
            
        .如果结束
         ' 本源码来自易语言资源网(www.5A5X.com)
    .如果结束
    
.如果结束
赋值 (iSize, 相加 (相乘 (iColors, 4), 相乘 (WIDTHBYTES (相乘 (iWidth, nBitCount)), iHeight)))
赋值 (m_pDIB, 取空白字节集 (iSize)) ' 分配空间
 ' 填写BMP文件头
赋值 (pBI.biSize, 40)
赋值 (pBI.biWidth, iWidth)
赋值 (pBI.biHeight, iHeight)
赋值 (pBI.biPlanes, 1)
赋值 (pBI.biBitCount, nBitCount)
赋值 (pBI.biCompression, #BI_RGB)
赋值 (pBI.biSizeImage, 0)
赋值 (pBI.biXPelsPerMeter, 0)
赋值 (pBI.biYPelsPerMeter, 0)
赋值 (pBI.biClrUsed, 0)
赋值 (pBI.biClrImportant, 0)
赋值 (m_pDIB, 相加 (BMP信息头转字节集 (pBI), m_pDIB))
 ' 初始化颜色表
.判断开始 (等于 (nBitCount, 1))
    RtlMoveMemory_int (GetColorTableAddress (), lstrcpyn (颜色表_1位深, 颜色表_1位深, 0), GetColorTableSize ())
.判断 (等于 (nBitCount, 4))
    RtlMoveMemory_int (GetColorTableAddress (), lstrcpyn (颜色表_4位深, 颜色表_4位深, 0), GetColorTableSize ())
.默认
    .如果真 (等于 (nBitCount, 8))
        RtlMoveMemory_int (GetColorTableAddress (), lstrcpyn (颜色表_8位深, 颜色表_8位深, 0), GetColorTableSize ())
    .如果真结束
    
.判断结束
.如果真 (不等于 (clrBk, 4294967295))
    输出调试文本 (“自定义背景色”)
.如果真结束
返回 (真)

.子程序 SetPixelColor, 空白型, , 置某点颜色
.参数 x, 整数型, , 
.参数 y, 整数型, , 
.参数 clrNew, 整数型, , 



.子程序 GetBitmapInfoAddress, 整数型, , 取BITMAPINFO指针
返回 (lstrcpyn (m_pDIB, m_pDIB, 0))

.子程序 GetWidth, 整数型, , 取图片宽度
.如果真 (等于 (m_pDIB, {  }))
    输出调试文本 (“取宽时出错”)
.如果真结束
返回 (到整数 (取字节集中间 (m_pDIB, 5, 4)))

.子程序 GetHeight, 整数型, , 取图片高度
.如果真 (等于 (m_pDIB, {  }))
    输出调试文本 (“取高时出错”)
.如果真结束
返回 (取字节集数据 (取字节集中间 (m_pDIB, 9, 4), #整数型, ))
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 WIDTHBYTES, 整数型, , 保图像的扫描行DWORD对齐
.参数 bits, 整数型, , 

赋值 (bits, 相加 (bits, 31))
返回 (左移 (右移 (bits, 5), 2))

.子程序 GetColorTableAddress, 整数型, , 取颜色表指针,成功返回内存指针,失败返回0
.如果真 (等于 (m_pDIB, {  }))
    输出调试文本 (“取颜色表地址时出错”)
.如果真结束
.如果真 (大于或等于 (GetBitCount (), 16)) ' 大于256色的位图不使用颜色表
    CNoColorTable ()
    返回 (0) ' 本源码来自易语言资源网(www.5A5X.com)
.如果真结束
返回 (相加 (lstrcpyn (m_pDIB, m_pDIB, 0), 40))

.子程序 GetBitCount, 整数型, , 取位图颜色位数
.如果真 (等于 (m_pDIB, {  }))
    输出调试文本 (“取位图颜色位数出错”)
.如果真结束
返回 (到整数 (到短整数 (取字节集中间 (m_pDIB, 15, 2))))

.子程序 BMP文件头转字节集, 字节集, , 
.参数 欲转成字节集的信息, BITMAPFILEHEADER, , 

.局部变量 返回值, 字节集, , , 

赋值 (返回值, 到字节集 (欲转成字节集的信息.bfType))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.bfSize)))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.bfReserved1)))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.bfReserved2)))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.bfOffBits)))
返回 (返回值)

.子程序 BMP信息头转字节集, 字节集, , 
.参数 欲转成字节集的信息, BITMAPINFOHEADER, , 

.局部变量 返回值, 字节集, , , 

赋值 (返回值, 到字节集 (欲转成字节集的信息.biSize))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.biWidth)))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.biHeight)))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.biPlanes)))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.biBitCount)))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.biCompression)))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.biSizeImage)))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.biXPelsPerMeter)))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.biYPelsPerMeter)))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.biClrUsed)))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.biClrImportant)))
返回 (返回值)

.子程序 CNoColorTable, 空白型, , 当前位图格式不使用颜色表
输出调试文本 (“当前位图格式不使用颜色表”)

.子程序 GetColorTableSize, 整数型, , 取颜色表大小
.如果真 (等于 (m_pDIB, {  }))
    输出调试文本 (“取位图颜色位数出错”)
.如果真结束
返回 (相乘 (NumDIBColorEntries (取字节集左边 (m_pDIB, 40)), 4))

.子程序 NumDIBColorEntries, 整数型, , 取颜色表数组颜色个数
.参数 pBmpInfo, 字节集, , 

.局部变量 iBitCount, 短整数型, , , 

赋值 (iBitCount, 取字节集数据 (取字节集中间 (pBmpInfo, 15, 2), #短整数型, ))
.判断开始 (等于 (iBitCount, 1))
    返回 (2)' 本源码来自易语言资源网(www.5A5X.com)
.判断 (等于 (iBitCount, 4))
    返回 (16)
.判断 (等于 (iBitCount, 8))
    返回 (256)
.默认
    .如果真 (或者 (等于 (iBitCount, 16), 等于 (iBitCount, 24), 等于 (iBitCount, 32)))
        返回 (0)
    .如果真结束
    
.判断结束
返回 (-1)

.子程序 Write, 字节集, 公开, 给位图数据加上位图文件头,返回位图文件数据(写到文件后就是.BMP图片)
返回 (相加 (到字节集 (到短整数 (19778)), 到字节集 (到整数 (相加 (取字节集长度 (m_pDIB), 54))), { 0, 0 }, { 0, 0 }, 到字节集 (到整数 (相加 (54, GetColorTableSize ()))), m_pDIB))



 ' 不属于任何一个程序集、类模块的函数：
