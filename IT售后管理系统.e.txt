 ' 文件类型：Windows窗口程序

 ' 程序名称：IT售后管理系统v3.0
 ' 程序描述：
 ' 程序作者：☆子涵工作室！
 ' 邮政编码：610041
 ' 联系地址：四川成都
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：ZiHanWorkroom@126.com
 ' 主页地址：
 ' 版权声明：QQ:9596173
 ' 版本号：3.0
 ' 创建号：0.0

窗口 登陆窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 500
    高度 = 235
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 0
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\IT售后管理系统.e\登陆窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “IT售后管理系统”
    帮助文件名 = “”

窗口 _启动窗口
    左边 = 50
    顶边 = 50
    宽度 = 622
    高度 = 438
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 真
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 帐套管理窗口
    左边 = 50
    顶边 = 50
    宽度 = 464
    高度 = 312
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “IT售后管理系统--帐套管理”
    帮助文件名 = “”

窗口 用户管理窗口
    左边 = 100
    顶边 = 0
    宽度 = 678
    高度 = 335
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “IT售后管理系统--用户管理”
    帮助文件名 = “”

窗口 导航窗口
    左边 = 0
    顶边 = 0
    宽度 = 636
    高度 = 425
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 13221807 '  0xC9BFAF
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 真
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “IT售后管理系统--信息导航”
    帮助文件名 = “”

窗口 客户资料窗口
    左边 = 130
    顶边 = 0
    宽度 = 623
    高度 = 472
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “IT售后管理系统--客户资料”
    帮助文件名 = “”

窗口 货品配置窗口
    左边 = 0
    顶边 = 0
    宽度 = 554
    高度 = 380
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “IT售后管理系统--货品配置”
    帮助文件名 = “”

窗口 会员资料窗口
    左边 = 130
    顶边 = 0
    宽度 = 623
    高度 = 472
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “IT售后管理系统--会员资料”
    帮助文件名 = “”

窗口 资料浏览窗口
    左边 = 50
    顶边 = 0
    宽度 = 736
    高度 = 491
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “IT售后管理系统--资料浏览”
    帮助文件名 = “”

窗口 维修登记窗口
    左边 = 100
    顶边 = 0
    宽度 = 647
    高度 = 457
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “IT售后管理系统--维修登记”
    帮助文件名 = “”

窗口 基础信息窗口
    左边 = 130
    顶边 = 0
    宽度 = 496
    高度 = 379
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “IT售后管理系统--基础信息”
    帮助文件名 = “”

窗口 系统配置窗口
    左边 = 160
    顶边 = 50
    宽度 = 411
    高度 = 423
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “IT售后管理系统--系统配置”
    帮助文件名 = “”

窗口 等待窗口
    左边 = 50
    顶边 = 50
    宽度 = 264
    高度 = 45
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 维修审核窗口
    左边 = 130
    顶边 = 0
    宽度 = 615
    高度 = 452
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “IT售后管理系统--维修审核”
    帮助文件名 = “”

窗口 条件查询窗口
    左边 = 50
    顶边 = 50
    宽度 = 432
    高度 = 334
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “IT售后管理系统--条件查询”
    帮助文件名 = “”

窗口 客户信息窗口
    左边 = 50
    顶边 = 50
    宽度 = 631
    高度 = 362
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “IT售后管理系统--客户信息”
    帮助文件名 = “”



.图片 sys, " ' 已保存到：D:\易语言学习\Data\IT售后管理系统.e\sys", , 自编DLL文件
.图片 Curtain, " ' 已保存到：D:\易语言学习\Data\IT售后管理系统.e\Curtain", , Access帐套数据库
.图片 Access模版, " ' 已保存到：D:\易语言学习\Data\IT售后管理系统.e\Access模版", , 无数据的Access文件
.图片 Config模版, " ' 已保存到：D:\易语言学习\Data\IT售后管理系统.e\Config模版", , 配置文件模版
.常量 数据摘要值, "“317e4d6140e840ed3283bacc3cb02db5”", , 
.常量 标题, "“IT售后管理系统”", , 
.常量 密文, "“zihanworkroom”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 2 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 1 扩展界面支持库一
 ' ExtMenu 9909FBB013704cfa8FE7E739DB7172DE 1 3 超级菜单支持库
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 1 XP风格界面库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 1 0 数据操作支持库一
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 1 6 扩展界面支持库三
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 1 1 高级表格
 ' eDB 46E94341933A462383A4DE26B146322C 1 3 数据库操作支持库
 ' eCompress 7B68736E818E41c5A28B0AE4D43C128C 1 0 压缩解压支持库
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库




数据类型 矩形, , 
    .成员 左边, 整数型, , , 
    .成员 顶边, 整数型, , , 
    .成员 右边, 整数型, , , 
    .成员 底边, 整数型, , , 

数据类型 坐标, , 
    .成员 X, 整数型, , , 
    .成员 Y, 整数型, , , 

.全局变量 data路径, 文本型, , , 取运行目录下data路径
.全局变量 main路径, 文本型, , , 取运行目录下main路径
.全局变量 配置项, 文本型, , "11", 数组中的1=界面风格,2=菜单风格,3=图片位置,4=维修提示,5=货品隐藏,6=背景图片,7=客户编号,8=会员编号,9=维修编号,10=产品编号 ,11=备份路径,
.全局变量 匿名全局变量_8387, 空白型, , , 
.全局变量 注册名, 文本型, , , 注册用户名
.全局变量 权限, 逻辑型, , "17", 保存用户权限的数组
.全局变量 登陆用户, 文本型, , , 显示到状态栏的登陆操作员
.全局变量 窗口调用, 逻辑型, , , 启动窗口调用帐套窗口为真，按钮调用为假
.全局变量 启动帐套名, 文本型, , , 传递用户选择了那个帐套
.全局变量 匿名全局变量_7466, 空白型, , , 
.全局变量 新增客资, 逻辑型, , , 新增为真，查看为假
.全局变量 新增会资, 逻辑型, , , 新增为真，查看为假
.全局变量 新增维修, 逻辑型, , , 新增为真，查看为假
.全局变量 匿名全局变量_7467, 空白型, , , 
.全局变量 调用记录集, 未知类型0x90002, , , 为浏览和查询用时所调用的记录集
.全局变量 调用窗口, 窗口, , , 为导入资料时所调用的窗口
.全局变量 显示货品, 逻辑型, , , 编辑货品时调用为真，添加单据时为假

.DLL命令 置父窗口, 整数型, "user32.dll", "SetParent", , 
    .参数 子窗口句柄, 整数型, , 子窗口的取窗口句柄
    .参数 父窗口句柄, 整数型, , 父窗口的取窗口句柄

.DLL命令 注册文件, 文本型, "sys.dll", "RegKey", , 自编注册DLL
    .参数 显示注册信息, 逻辑型, , 

.DLL命令 注册效验, 逻辑型, "sys.dll", "RegChe", , 自编注册DLL

.DLL命令 载入关于窗口, 空白型, "sys.dll", "LoadCzh", , 

.DLL命令 提示信息, 整数型, "user32.dll", "MessageBoxA", , 
    .参数 句柄, 整数型, , 取运行的窗口句柄
    .参数 内容, 文本型, , 提示的内容信息
    .参数 标题, 文本型, , 提示框的标题
    .参数 按钮, 整数型, , 参加信息框的按钮

.DLL命令 取窗口类名, 整数型, "user32.dll", "GetClassNameA", , 
    .参数 窗口句柄, 整数型, , 
    .参数 缓冲区, 文本型, , 
    .参数 缓冲值, 整数型, , 

.DLL命令 枚举子窗口, 整数型, "user32.dll", "EnumChildWindows", , 
    .参数 父窗口句柄, 整数型, , 
    .参数 处理程序, 子程序指针, , 
    .参数 事件值, 文本型, , 

.DLL命令 有效句柄, 整数型, "user32.dll", "IsWindow", , 判断一个窗口句柄是否有效
    .参数 句柄值, 整数型, , 

.DLL命令 指定虚拟键, 整数型, "user32.dll", "GetAsyncKeyState", , 判断函数调用时指定虚拟键的状态
    .参数 键码, 整数型, , 欲测试的虚拟键的键码

.DLL命令 传递指针到窗口, 整数型, "user32.dll", "CallWindowProcA", , 将消息信息传送给指定的窗口过程
    .参数 程序指针, 子程序指针, , 指向前一个窗口过程的指针
    .参数 窗口句柄, 整数型, , 指向接收消息的窗口过程的句柄
    .参数 消息, 整数型, , 指定消息类型
    .参数 参数1, 整数型, , 
    .参数 参数2, 整数型, , 

.DLL命令 传递消息到窗口, 整数型, "user32.dll", "CallWindowProcA", , 将消息信息传送给指定的窗口过程
    .参数 程序指针, 整数型, , 指向前一个窗口过程的指针
    .参数 窗口句柄, 整数型, , 指向接收消息的窗口过程的句柄
    .参数 消息, 整数型, , 指定消息类型
    .参数 参数1, 整数型, , 
    .参数 参数2, 整数型, , 

.DLL命令 置窗口指针, 子程序指针, "user32.dll", "SetWindowLongA", , 返回子程序指针型数据
    .参数 窗口句柄, 整数型, , 欲为其取得信息的窗口的句柄
    .参数 嵌入特征, 整数型, , 
    .参数 新特征, 子程序指针, , 仅易语言3.0支持

.DLL命令 置窗口信息, 整数型, "user32.dll", "SetWindowLongA", , 在窗口结构中为指定的窗口设置特征信息
    .参数 窗口句柄, 整数型, , 欲为其取得信息的窗口的句柄
    .参数 嵌入特征, 整数型, , 
    .参数 新特征, 子程序指针, , 仅易语言3.0支持

.DLL命令 范围矩形, 空白型, "user32.dll", "GetWindowRect", , 获得整个窗口的范围矩形
    .参数 句柄, 空白型, , 
    .参数 矩形, 矩形, , 指向一个RECT结构的指针

.DLL命令 矩形坐标, 空白型, "user32.dll", "GetClientRect", , 获取窗口客户区的坐标及大小
    .参数 句柄, 空白型, , 
    .参数 矩形, 矩形, , 

.DLL命令 发送文本消息, 整数型, "user32.dll", "SendMessageA", , 该函数将指定的消息发送到一个或多个窗口
    .参数 接收句柄, 整数型, , 要接收消息的那个窗口的句柄
    .参数 消息值, 整数型, , 指定被发送的消息
    .参数 参数1, 整数型, , 
    .参数 参数2, 文本型, , 

.DLL命令 发送消息, 整数型, "user32.dll", "SendMessageA", , 该函数将指定的消息发送到一个或多个窗口
    .参数 接收句柄, 整数型, , 要接收消息的那个窗口的句柄
    .参数 消息值, 整数型, , 指定被发送的消息
    .参数 参数1, 空白型, , 
    .参数 参数2, 空白型, , 

.DLL命令 判断坐标, 整数型, "user32.dll", "ScreenToClient", , 
    .参数 窗口句柄, 整数型, , 
    .参数 结构, 坐标, , 可能为 POINTAPI 结构。

.DLL命令 显示窗口, 整数型, "", "ShowWindow", , 
    .参数 窗口句柄, 整数型, , 
    .参数 窗口状态, 整数型, , 

.DLL命令 窗口是否最小化, 整数型, "", "IsIconic", , 
    .参数 窗口句柄, 整数型, , 

.DLL命令 窗口是否可见, 整数型, "", "IsWindowVisible", , 
    .参数 窗口句柄, 整数型, , 

.DLL命令 查找窗口, 整数型, "", "FindWindowA", , 
    .参数 lpClassName, 整数型, , 0
    .参数 窗口标题, 文本型, , 欲查找的窗口标题

.DLL命令 热键注册, 整数型, "user32.dll", "RegisterHotKey", , 
    .参数 窗口句柄, 整数型, , 
    .参数 注册值, 整数型, , 
    .参数 功能键, 整数型, , 
    .参数 热键标识, 整数型, , 

.DLL命令 发送消息执行子程序, 空白型, "user32.dll", "SendMessageCallbackA", , 
    .参数 窗口句柄, 整数型, , 
    .参数 消息值, 整数型, , 
    .参数 参数1, 整数型, , 
    .参数 参数2, 整数型, , 
    .参数 执行子程序指针, 子程序指针, , 
    .参数 自定义值, 整数型, , 

.DLL命令 热键撤销, 整数型, "user32.dll", "UnregisterHotKey", , 
    .参数 窗口句柄, 整数型, , 
    .参数 注册值, 整数型, , 

.窗口程序集 登陆窗口程序集, , , 登陆窗口

.程序集变量 记录集句柄, 整数型, , , 
.程序集变量 进度条转动圈数, 整数型, , , 进度条转动几次显示登陆
.程序集变量 内部管理, 逻辑型, , , 真＝以内部管理员登陆
.子程序 _登陆窗口_创建完毕, 空白型, , 
赋值 (.内容, 注册名) ' 将注册的单位(公司)名显示到启动界面上
赋值 (记录集句柄, _启动窗口.查询 (., “select * from 用户名表”))
_启动窗口.到首记录 (., 记录集句柄)
.判断循环首 (等于 (_启动窗口.尾记录后 (., 记录集句柄), 假)) ' 将用户名加入到组合框
    _启动窗口.读 (., 记录集句柄, “用户名”).加入项目 ()
    _启动窗口.到后一记录 (., 记录集句柄)
.判断循环尾 ()
.如果真 (等于 (取项目数 (), 0)) ' 为初次使用加入一个管理员
    提示信息框 (相加 (“初次使用”, #左引号, #标题, #右引号, “将以”, #左引号, “初始管理员”, #右引号, “登陆。”, #换行符, #换行符, “请进入系统后及时更改管理员名称及密码！”), #标题, 64, , 登陆窗口.取窗口句柄 ())
    “初始管理员”.加入项目 ()
    赋值 (.现行选中项, 0)
    赋值 (.内容, “987654321”)
    连续赋值 (真, .禁止, .禁止)
    赋值 (内部管理, 真)
.如果真结束


.子程序 _用户组框_列表项被选择, 空白型, , 
赋值 (登陆用户, .取项目文本 (.现行选中项))
获取焦点 ()

.子程序 _登陆钮_被单击, 空白型, , 
.局部变量 登陆限制次数, 整数型, 静态, , 3次登陆失败即退出程序
.局部变量 循环变量, 整数型, , , 

.如果真 (等于 (.现行选中项, -1))
    提示信息框 (“用户名不可缺，请选择一个登陆用户！”, #标题, 64, , 登陆窗口.取窗口句柄 ())
    获取焦点 ()
    返回 ()
.如果真结束
.如果 (取反 (内部管理))
    赋值 (记录集句柄, _启动窗口.查询 (., 相加 (“select * from 用户名表 where 用户名='”, 登陆用户, “'”)))
    .如果真 (等于 (等于 (.内容, _启动窗口.读 (., 记录集句柄, “密码”)), 假))
        赋值 (登陆限制次数, 相加 (登陆限制次数, 1)) ' 密码不正确，登陆次数加1次
        .如果真 (等于 (登陆限制次数, 3))
            提示信息框 (相加 (“你无权进入”, #标题), #标题, 16, “US-03”, 登陆窗口.取窗口句柄 ())
            结束 ()
        .如果真结束
        提示信息框 (“密码错误，请重新输入该用户名所对应的密码！”, #标题, 48, , 登陆窗口.取窗口句柄 ())
        赋值 (.内容, “”)
        获取焦点 ()
        返回 ()
    .如果真结束
    .计次循环首 (取数组成员数 (权限), 循环变量) ' 读出登陆用户的权限到权限数组中
        赋值 (权限 [循环变量], _启动窗口.读 (., 记录集句柄, 相加 (循环变量, 2)))
    .计次循环尾 ()
.否则
    赋值 (登陆用户, “初始管理员”)
    .计次循环首 (取数组成员数 (权限), 循环变量) ' 内部管理员具有所有权限
        赋值 (权限 [循环变量], 真) ' 成员数不固定可以方便以后修改权限设置范围
    .计次循环尾 ()
     ' 帐套管理, 用户管理, 客户资料, 会员资料, 报修系统, 基础资料, 系统设置.
.如果结束
赋值 (窗口调用, 真) ' 从启动窗口调用帐套窗口
登陆窗口.销毁 ()

.子程序 _启动时钟_周期事件, 空白型, , 显示进度条
.判断开始 (等于 (.内容, “■ □ □ □ □”))
    赋值 (.内容, “□ ■ □ □ □”)
.判断 (等于 (.内容, “□ ■ □ □ □”))
    赋值 (.内容, “□ □ ■ □ □”)
.判断 (等于 (.内容, “□ □ ■ □ □”))
    赋值 (.内容, “□ □ □ ■ □”)
.判断 (等于 (.内容, “□ □ □ ■ □”))
    赋值 (.内容, “□ □ □ □ ■”)
.判断 (等于 (.内容, “□ □ □ □ ■”))
    赋值 (.内容, “■ □ □ □ □”)
.默认
    
.判断结束
刷新显示 ()
赋值 (进度条转动圈数, 相加 (进度条转动圈数, 1))
.如果真 (大于或等于 (进度条转动圈数, 5)) ' 转动规定的圈数后即停止
    赋值 (.时钟周期, 0)
    连续赋值 (假, .可视, .可视) ' 隐藏进度条等控件
    连续赋值 (真, .可视, .可视, .可视, .可视, .可视, .可视) ' 显示用户框等控件
    获取焦点 ()
.如果真结束


.子程序 _退出钮_被单击, 空白型, , 
.如果真 (等于 (提示信息框 (相加 (“确定要退出”, #左引号, #标题, #右引号, “吗？”), #标题, 33, , 登陆窗口.取窗口句柄 ()), 2))
    返回 ()
.如果真结束
结束 ()

.子程序 _登陆窗口_可否被关闭, 逻辑型, , 防止用户用Ctrl+F4关闭登陆窗口
返回 (假)

.子程序 _登陆窗口_将被销毁, 空白型, , 销毁窗口时关闭数据库
_启动窗口.关闭 (.)
_启动窗口.关闭记录集 (., 记录集句柄)


.窗口程序集 帐套管理窗口程序集, , , 以年级或班级创建帐套

.程序集变量 记录集句柄, 整数型, , , 
.程序集变量 是否为修改, 逻辑型, , , 判断是新增帐套还是修改帐套
.程序集变量 修改选中项, 整数型, , , 修改的那个帐套
.程序集变量 默认启动, 逻辑型, , "0", 所有帐套的默认启动值
.子程序 _帐套管理窗口_创建完毕, 空白型, , 
.局部变量 是否修复, 逻辑型, , , 

.如果真 (取反 (文件是否存在 (相加 (main路径, “Curtain.dll”))))
     ' Curtain.dll为帐套名数据库
    .如果真 (等于 (提示信息框 (相加 (“帐套文件丢失！系统可修复此文件，但帐套信息部分需手动修改！”, #换行符, #换行符, “是否修复此文件？”), #标题, 33, “CU-01”, 帐套管理窗口.取窗口句柄 ()), 2))
        结束 ()
    .如果真结束
    赋值 (是否修复, 真)
    写到文件 (相加 (main路径, “Curtain.dll”), #Curtain) ' 帐套名表丢失可以由程序再释放一个空帐套名文件
.如果真结束
.如果真 (取反 (_启动窗口.打开MDB数据库 (., 相加 (main路径, “Curtain.dll”), , “D7D3BAAD2D2D43555254”, , )))
    提示信息框 (相加 (“系统文件读取错误，请重新安装”, #标题), #标题, 16, “CU-02”, 帐套管理窗口.取窗口句柄 ())
    结束 ()
.如果真结束
.如果真 (是否修复) ' 修复帐套文件
    修复帐套文件 ()
.如果真结束
.如果真 (窗口调用) ' 启动窗口调用为真，其余调用为假
    赋值 (记录集句柄, _启动窗口.查询 (., “select * from 帐套 where 默认启动=Yes”))
    赋值 (启动帐套名, _启动窗口.读 (., 记录集句柄, “帐套名”)) ' 读取默认启动的帐套名
    .如果真 (文件是否存在 (相加 (data路径, 启动帐套名, “.czh”)))
         ' 如果有默认启动的帐套且帐套文件存在就直接启动该帐套
        置启动初始状态 ()
        帐套管理窗口.销毁 ()
        返回 ()
    .如果真结束
    赋值 (启动帐套名, “”) ' 没找到帐套文件就显示帐套选择窗口，并赋值为空
.如果真结束
帐套数据初始化 ()

.子程序 帐套数据初始化, 空白型, , 将已有的帐套加入到列表框
.局部变量 列宽度, 整数型, , "4", 
.局部变量 表头标题, 文本型, , "4", 
.局部变量 行数变量, 整数型, , , 纵向遍历，表格行数随帐套数量变化
.局部变量 列数变量, 整数型, , , 横向遍历

1.未知支持库函数_62 (0, ., .)
赋值 (列宽度, { 100, 180, 80, 60 })
赋值 (表头标题, { “帐 套 名”, “公司(部门)名称”, “备  注”, “默认” })
赋值 (记录集句柄, _启动窗口.查询 (., “select * from 帐套”))
_启动窗口.到首记录 (., 记录集句柄)
3.未知支持库函数_30 (#.) ' 置最后一列为选择型
.判断循环首 (等于 (_启动窗口.尾记录后 (., 记录集句柄), 假))
    赋值 (行数变量, 相加 (行数变量, 1)) ' 纵向遍历读出各行数据
    .计次循环首 (3, 列数变量) ' 横向遍历读出各列数据
        .如果真 (等于 (行数变量, 7))
            .未知支持库函数_38 ()
        .如果真结束
        行数变量.未知支持库函数_9 (相减 (列数变量, 1), #., _启动窗口.读 (., 记录集句柄, 列数变量))
    .计次循环尾 ()
    加入成员 (默认启动, _启动窗口.读 (., 记录集句柄, “默认启动”))
     ' 将默认启动字段的值读到数组
    行数变量.未知支持库函数_9 (3, #., 默认启动 [行数变量])
    赋值 (列数变量, 1)
    _启动窗口.到后一记录 (., 记录集句柄)
.判断循环尾 ()
表格初始化 (24, 行数变量, 列宽度, 表头标题, , 真, 真, 1)
.如果真 (取反 (权限 [2])) ' 取用户的权限是否具有新增,删除帐套等权利
    连续赋值 (真, .禁止, .禁止, .禁止) ' 没有权利即禁止相应按钮
.如果真结束
赋值 (帐套管理窗口., 312)
1.未知支持库函数_53 (3, 行数变量, 3, 假) ' 置最后一列不只读，用户可操作

.子程序 修复帐套文件, 空白型, , 将DATA目录下所有*.czh文件修复到帐套中
.局部变量 原文件名, 文本型, , , 查找到的帐套文件
.局部变量 文件名, 文本型, , "0", 去掉扩展名的帐套文件

赋值 (原文件名, 寻找文件 (相加 (data路径, “*.czh”), )) ' 查找所有*.czh的文件
.如果 (不等于 (原文件名, “”)) ' 说明DATA目录下没有帐套文件
    .判断循环首 (不等于 (原文件名, “”))
        赋值 (文件名, 分割文本 (原文件名, “.czh”, )) ' 将找到的文件去掉扩展名
        _启动窗口.执行 (., 相加 (“insert into 帐套(帐套名) values('”, 文件名 [1], “')”), ) ' 将帐套名加到帐套数据库
        赋值 (原文件名, 寻找文件 ())
    .判断循环尾 ()
    提示信息框 (“修复帐套文件成功，请手动修复帐套的信息部分！”, #标题, 64, , 帐套管理窗口.取窗口句柄 ())
.否则
    提示信息框 (“数据库(Data)目录下已无可修复信息，不可修复帐套！请重新建立帐套或还原备份文件”, #标题, 32, “CU-03”, 帐套管理窗口.取窗口句柄 ())
.如果结束


.子程序 _确定钮_被单击, 空白型, , 
.如果 (并且 (不等于 (未知支持库函数_3 (), -1), 不等于 (到文本 (未知支持库函数_3 ().未知支持库函数_10 (0)), “”)))
    赋值 (启动帐套名, 未知支持库函数_3 ().未知支持库函数_10 (0))
    .如果真 (取反 (文件是否存在 (相加 (data路径, 启动帐套名, “.czh”)))) ' 检查启动的帐套文件是否存在
        提示信息框 (相加 (“未找到”, #左引号, 启动帐套名, #右引号, “帐套的库文件，请检查data目录下帐套文件是否存在！”), #标题, 16, “CU-04”, 帐套管理窗口.取窗口句柄 ())
        返回 ()
    .如果真结束
    赋值 (记录集句柄, _启动窗口.查询 (., 相加 (“select * from 帐套 where 帐套名='”, 启动帐套名, “'”)))
    .如果 (默认启动 [未知支持库函数_3 ()]) ' 下次是否直接启动该帐套
        _启动窗口.执行 (., “update 帐套 set 默认启动=no”, )
         ' 先去掉所有的默认启动，保证只有唯一的一个默认启动
        _启动窗口.执行 (., 相加 (“update 帐套 set 默认启动=yes where 帐套名='”, 启动帐套名, “'”), ) ' 再加上选中项目的默认启动值
    .否则
        _启动窗口.执行 (., 相加 (“update 帐套 set 默认启动=no where 帐套名='”, 启动帐套名, “'”), )
    .如果结束
    _启动窗口.关闭记录集 (., 记录集句柄)
    置启动初始状态 ()
    帐套管理窗口.销毁 ()
.否则
    提示信息框 (“未选择需启动的帐套，请重新选择！”, #标题, 64, , 帐套管理窗口.取窗口句柄 ())
    返回 ()
.如果结束


.子程序 _取消钮_被单击, 空白型, , 
帐套管理窗口.销毁 ()
赋值 (启动帐套名, “”)
置启动初始状态 ()

.子程序 _新增钮_被单击, 空白型, , 切换到新增帐套界面
连续赋值 (“”, .内容, .内容, .内容)
赋值 (帐套管理窗口., 265)
赋值 (.现行子夹, 1)
赋值 (是否为修改, 假)
赋值 (修改选中项, -2) ' 将修改选中值赋为无
获取焦点 ()

.子程序 _删除钮_被单击, 空白型, , 
.局部变量 被选帐套名, 文本型, , , 取被选择的帐套名

.如果真 (或者 (等于 (未知支持库函数_3 (), -1), 等于 (到文本 (未知支持库函数_3 ().未知支持库函数_10 (0)), “”)))
    提示信息框 (“未选择需删除的帐套，请重新选择！”, #标题, 64, , 帐套管理窗口.取窗口句柄 ())
    返回 ()
.如果真结束
赋值 (被选帐套名, 未知支持库函数_3 ().未知支持库函数_10 (0))
.如果真 (等于 (提示信息框 (相加 (“删除帐套后将不可再恢复，确定要删除”, #左引号, 被选帐套名, #右引号, “帐套吗？”), #标题, 33, , 帐套管理窗口.取窗口句柄 ()), 1))
    .如果真 (_启动窗口.执行 (., 相加 (“delete from 帐套 where 帐套名='”, 被选帐套名, “'”), )) ' 如果删除表可以用“如果真 (数据外部数据库.执行 (“drop table ” ＋ 被选帐套名, ))”
        .如果真 (删除文件 (相加 (data路径, 被选帐套名, “.czh”))) ' 将帐套文件删除
            提示信息框 (相加 (“删除”, #左引号, 被选帐套名, #右引号, “帐套成功！”), #标题, 64, , 帐套管理窗口.取窗口句柄 ())
            帐套数据初始化 () ' 重新显示删除后的帐套列表
            返回 ()
        .如果真结束
        
    .如果真结束
    提示信息框 (相加 (“删除”, #左引号, 被选帐套名, #右引号, “帐套失败！”), #标题, 16, “CU-05”, 帐套管理窗口.取窗口句柄 ())
    返回 ()
.如果真结束
返回 ()

.子程序 _修改钮_被单击, 空白型, , 修改帐套信息
.如果真 (或者 (等于 (未知支持库函数_3 (), -1), 等于 (到文本 (未知支持库函数_3 ().未知支持库函数_10 (0)), “”)))
    提示信息框 (“未选择需要修改的项目，请重新选择！”, #标题, 64, , 帐套管理窗口.取窗口句柄 ())
    返回 ()
.如果真结束
赋值 (修改选中项, 未知支持库函数_3 ())
赋值 (.内容, 未知支持库函数_3 ().未知支持库函数_10 (0))
赋值 (.内容, 未知支持库函数_3 ().未知支持库函数_10 (1))
赋值 (.内容, 未知支持库函数_3 ().未知支持库函数_10 (2))
赋值 (帐套管理窗口., 265)
赋值 (.现行子夹, 1)
赋值 (是否为修改, 真)
获取焦点 ()

.子程序 _新增帐套钮_被单击, 空白型, , 新增加一个帐套
.局部变量 新帐套名, 文本型, , , 新增的帐套名
.局部变量 老帐套名, 文本型, , , 修改前的帐套名
.局部变量 是否重名, 逻辑型, , , 判断新增和修改后的帐套名是否重复
.局部变量 循环变量, 整数型, , , 

赋值 (新帐套名, .内容)
.如果真 (是否为修改)
    赋值 (老帐套名, 到文本 (修改选中项.未知支持库函数_10 (0)))
.如果真结束
.如果真 (等于 (新帐套名, “”))
    提示信息框 (“帐套名不可为空，且不可和以前的帐套名重复！”, #标题, 64, , 帐套管理窗口.取窗口句柄 ())
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (记录集句柄, _启动窗口.查询 (., “select * from 帐套”))
_启动窗口.到首记录 (., 记录集句柄)
.判断循环首 (等于 (_启动窗口.尾记录后 (., 记录集句柄), 假))
    赋值 (循环变量, 相加 (循环变量, 1))
    .如果真 (并且 (等于 (新帐套名, _启动窗口.读 (., 记录集句柄, “帐套名”)), 不等于 (循环变量, 修改选中项)))
         ' 且语句的作用是判断修改帐套信息时可以和原帐套名重复，但不能和别的帐套名重复
        赋值 (是否重名, 真)
        跳出循环 ()
    .如果真结束
    _启动窗口.到后一记录 (., 记录集句柄)
.判断循环尾 ()
.如果真 (是否重名)
    提示信息框 (“此帐套名已经使用过，帐套名必须是唯一，请重新命名！”, #标题, 64, , 帐套管理窗口.取窗口句柄 ())
    赋值 (.内容, 老帐套名) ' 返回到修改前的帐套名
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (是否为修改) ' 修改帐套信息
    .如果真 (_启动窗口.执行 (., 相加 (“update 帐套 set 帐套名='”, 新帐套名, “',隶属部门='”, .内容, “',备注='”, .内容, “' where 帐套名='”, 老帐套名, “'”), )) ' 修改帐套Access数据库中对应的记录的信息
        .如果真 (文件更名 (相加 (data路径, 老帐套名, “.czh”), 相加 (data路径, 新帐套名, “.czh”))) ' 修改对应的文件名
            提示信息框 (“修改帐套信息成功！”, #标题, 64, , 帐套管理窗口.取窗口句柄 ())
            帐套数据初始化 () ' 重新显示修改后的帐套列表
            _取增钮_被单击 ()
            返回 ()
        .如果真结束
        
    .如果真结束
    提示信息框 (“修改帐套信息失败，请重新修改！”, #标题, 64, “CU-06”, 帐套管理窗口.取窗口句柄 ())
    _取增钮_被单击 ()
    返回 ()
.如果真结束
.如果真 (写到文件 (相加 (data路径, 新帐套名, “.czh”), #Access模版))
     ' 释放一个空Access数据库文件  如果新增一个表可以用“数据外部数据库.执行 (“create table ” ＋ 新增帐套名 ＋ “(姓名 char(20),年龄 int)”, )”
    .如果真 (_启动窗口.执行 (., 相加 (“insert into 帐套(帐套名,隶属部门,备注) values('”, 新帐套名, “','”, .内容, “','”, .内容, “')”), )) ' 新增一条帐套信息记录
        提示信息框 (相加 (“新增”, #左引号, 新帐套名, #右引号, “帐套成功！”), #标题, 64, , 帐套管理窗口.取窗口句柄 ())
        帐套数据初始化 ()
        _取增钮_被单击 ()
        返回 ()
    .如果真结束
    
.如果真结束
提示信息框 (相加 (“新增”, #左引号, 新帐套名, #右引号, “帐套失败！”), #标题, 64, “CU-07”, 帐套管理窗口.取窗口句柄 ())

.子程序 _取增钮_被单击, 空白型, , 返回选择窗口
赋值 (.现行子夹, 0)
赋值 (帐套管理窗口., 312)

.子程序 _帐套管理窗口_将被销毁, 空白型, , 销毁窗口时关闭数据库
_启动窗口.关闭记录集 (., 记录集句柄)
_启动窗口.关闭 (.)
清除数组 (默认启动) ' 清空数组

.子程序 _帐套表格_光标位置改变, 空白型, , 使选择框象单选框一样
.局部变量 改变默认值, 逻辑型, , , 
.局部变量 选中项, 整数型, , , 
.局部变量 循环变量, 整数型, , , 

.如果真 (并且 (等于 (未知支持库函数_4 (), 3), 小于或等于 (未知支持库函数_3 (), 取数组成员数 (默认启动))))
    赋值 (选中项, 未知支持库函数_3 ())
    赋值 (改变默认值, 选中项.未知支持库函数_10 (3)) ' 取出选中项选择框是否被选择
    .计次循环首 (取数组成员数 (默认启动), 循环变量) ' 使选择框象单选框一样只有一个默认启动
        赋值 (默认启动 [循环变量], 假)
        .如果真 (等于 (循环变量, 选中项))
            赋值 (默认启动 [选中项], 改变默认值) ' 修改数组中对应的选中项
        .如果真结束
        循环变量.未知支持库函数_9 (3, #., 默认启动 [循环变量]) ' 显示出单选框的效果
    .计次循环尾 ()
.如果真结束


.子程序 _帐套表格_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_确定钮_被单击 ()

.窗口程序集 启动窗口程序集, , , 主窗口程序集

.程序集变量 窗口句柄, 整数型, , , 热键注册的窗口句柄
.程序集变量 原窗口指针, 子程序指针, , , 原窗口程序
.子程序 __启动窗口_创建完毕, 空白型, , 
信息初始化 ()
检查数据文件 ()
注册限制 (假) ' 可以在程序运行时多次调用效验注册
载入 (登陆窗口, _启动窗口, 真)
.如果真 (是否已创建 (登陆窗口)) ' 在载入帐套窗口时销毁登陆窗口
    登陆窗口.销毁 ()
.如果真结束
载入 (帐套管理窗口, _启动窗口, 真)

.子程序 __启动窗口_尺寸被改变, 空白型, , 
1.移动 (3, _启动窗口., 相减 (_启动窗口., 78))

.子程序 __启动窗口_将被销毁, 空白型, , 
关闭 ()
.如果真 (是否已创建 (导航窗口))
    导航窗口.销毁 ()
.如果真结束
置窗口指针 (窗口句柄, -4, 原窗口指针) ' 置回原来的消息处理程序
热键撤销 (窗口句柄, 786)

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
.局部变量 句柄, 整数型, , , 

.如果 (是否已创建 (维修审核窗口))
    赋值 (句柄, 维修审核窗口.取窗口句柄 ())
.否则
    赋值 (句柄, _启动窗口.取窗口句柄 ())
.如果结束
.如果真 (等于 (提示信息框 (相加 (“确定要退出”, #左引号, #标题, #右引号, “吗？”), #标题, 33, , 句柄), 2))
    返回 (假)
.如果真结束
返回 (真)

.子程序 检查数据文件, 空白型, , 
.如果真 (取反 (并且 (文件是否存在 (相加 (main路径, “sys.dll”)), 等于 (未知支持库函数_2 (读入文件 (相加 (main路径, “sys.dll”))), #数据摘要值)))) ' 判断注册文件是否存在和是否被改动过（sys.dll为注册DLL）
    置文件属性 (相加 (main路径, “sys.dll”), 32)
    写到文件 (相加 (main路径, “sys.dll”), #sys)
    置文件属性 (相加 (main路径, “sys.dll”), 7)
.如果真结束
.如果真 (取反 (文件是否存在 (相加 (main路径, “user.dll”)))) ' user.dll为用户名、密码和权限数据库
    提示信息框 (相加 (“系统文件丢失！，请重新安装”, #标题, “软件！”), #标题, 16, “US-01”) ' 如果用户名表丢失，不可由程序释放一个用户文件，因为这样就可以删除USER.DLL文件后以初始用户名及密码进入系统并查看数据库中的文件，所有要求重装软件！
    结束 ()
.如果真结束
.如果真 (取反 (相加 (main路径, “user.dll”).打开MDB数据库 (“D7D3BAADB9A4D7F7CAD2”, , ))) ' 20位以上的密码一般的ACCESS破解器都不容易读出密码
     ' 用ODBC方式处理小量数据，快捷方便，不象ADO每读一类数据就要设置一个变量
     ' 如果考虑到最终编译的软件体积，那最好只用一种数据处理方式，因为“ODBCDB.run”文件有156K大，去掉ODBC方式可以减小体积
    提示信息框 (相加 (“读取系统文件错误！，请重新安装”, #标题, “软件！”), #标题, 16, “US-02”)
    关闭 ()
    结束 ()
.如果真结束
.如果真 (取反 (文件是否存在 (相加 (main路径, “Product.dll”)))) ' Product.dll为产品数据库
    提示信息框 (相加 (“系统文件丢失！请重新安装”, #标题, “软件！”), #标题, 16, “CP-01”)
    结束 ()
.如果真结束
.如果真 (取反 (文件是否存在 (相加 (main路径, “Config.dll”)))) ' Config.dll为基础信息配置文件
    提示信息框 (相加 (“系统配置文件丢失！这将导致如”, #左引号, “销售代表”, #右引号, “等配置信息还原成初始状态！”), #标题, 16, “US-04”)
    写到文件 (相加 (main路径, “Config.dll”), #Config模版) ' 释放Config.dll模版
    运行 (相加 (取运行目录 (), “\”, 取执行文件名 ()), 假, ) ' 重新运行
    结束 ()
.如果真结束


.子程序 信息初始化, 空白型, , 
.局部变量 配置节名, 文本型, , "10", 
.局部变量 循环变量, 整数型, , , 
.局部变量 窗口返回值, 整数型, , , 

赋值 (窗口返回值, 查找窗口 (0, “IT售后管理系统 v3.0”)) ' 防止程序二次运行
.如果真 (不等于 (窗口返回值, 0))
    .如果真 (等于 (窗口是否可见 (窗口返回值), 1))
        .如果真 (等于 (窗口是否最小化 (窗口返回值), 0)) ' 如果程序最小化就还原显示
            显示窗口 (窗口返回值, 2) ' 其实就是和 _启动窗口.位置=0＋激活
        .如果真结束
        显示窗口 (窗口返回值, 9)
    .如果真结束
    结束 ()
.如果真结束
赋值 (_启动窗口., “IT售后管理系统 v3.0”)
赋值 (data路径, 相加 (取运行目录 (), “\data\”))
赋值 (main路径, 相加 (取运行目录 (), “\main\”)) ' 以上为取运行路径
赋值 (配置节名, { “界面风格”, “菜单风格”, “图片位置”, “维修提示”, “货品隐藏”, “背景图片”, “客户编号”, “会员编号”, “维修编号”, “产品编号”, “备份路径” })
.计次循环首 (11, 循环变量) ' 将配置信息读入数组中，便于随时调用
    赋值 (配置项 [循环变量], 读加密配置项 (“系统配置”, 配置节名 [循环变量]))
.计次循环尾 ()
未知支持库函数_0 (到数值 (配置项 [1]))
赋值 (., 到数值 (配置项 [2])) ' 菜单的颜色方案
.如果真 (不等于 (配置项 [6], “无”))
    赋值 (.底图, 读入文件 (配置项 [6]))
    赋值 (.底图方式, 到数值 (配置项 [3]))
.如果真结束
赋值 (窗口句柄, _启动窗口.取窗口句柄 ())
热键注册 (窗口句柄, 7891, 0, #F6键) ' 打开客户资料录入窗口
热键注册 (窗口句柄, 7823, 0, #F7键) ' 打开会员资料录入窗口
热键注册 (窗口句柄, 7830, 0, #F8键) ' 打开维修登记窗口
赋值 (原窗口指针, 置窗口指针 (窗口句柄, -4, &热键处理程序))
 ' 菜单的快捷键不能全局相应热键，所有用API来设置热键

.子程序 置启动初始状态, 空白型, , 
.如果真 (不等于 (启动帐套名, “”)) ' 未启动帐套
    载入 (导航窗口, _启动窗口, 假)
    置父窗口 (导航窗口.取窗口句柄 (), _启动窗口.取窗口句柄 (.))
    注册限制 (真)
.如果真结束
1.置文本 (相加 (“ ”, 登陆用户))
3.置文本 (相加 (“ ”, 启动帐套名))
5.置文本 (相加 (“ ”, 时间到文本 (取现行时间 (), 2), 多项选择 (取星期几 (取现行时间 ()), “  星期日”, “  星期一”, “  星期二”, “  星期三”, “  星期四”, “  星期五”, “  星期六”)))
启动窗口权限限制 ()

.子程序 启动窗口权限限制, 空白型, , 根据权限设置按钮状态
.如果 (是否已创建 (导航窗口))
    连续赋值 (取反 (权限 [3]), .禁止, 导航窗口..)
    连续赋值 (取反 (权限 [4]), .禁止, 导航窗口..)
    连续赋值 (取反 (权限 [5]), .禁止, 导航窗口..)
    连续赋值 (取反 (权限 [8]), .禁止, 导航窗口..)
    连续赋值 (取反 (权限 [9]), .禁止, 导航窗口..)
    连续赋值 (取反 (权限 [10]), .禁止, 导航窗口..)
    连续赋值 (取反 (权限 [11]), .禁止, 导航窗口..)
    连续赋值 (取反 (权限 [12]), .禁止, 导航窗口..)
    连续赋值 (取反 (权限 [13]), .禁止, 导航窗口..)
    连续赋值 (取反 (权限 [14]), .禁止, 导航窗口..)
    连续赋值 (取反 (权限 [15]), .禁止, 导航窗口..)
    连续赋值 (取反 (权限 [16]), .禁止, 导航窗口..)
    连续赋值 (取反 (权限 [17]), .禁止, 导航窗口..)
    连续赋值 (假, .禁止, .禁止, .禁止, .禁止)
.否则
    连续赋值 (真, .禁止, .禁止, .禁止, .禁止)
.如果结束


.子程序 _系统配置_被选择, 空白型, , 
_系统配置超钮_被单击 ()

.子程序 _用户管理_被选择, 空白型, , 
_用户管理超钮_被单击 ()

.子程序 _帐套管理_被选择, 空白型, , 
.如果真 (不等于 (启动帐套名, “”))
    .如果真 (等于 (提示信息框 (相加 (“管理帐套时将关闭当前打开的”, #左引号, 启动帐套名, #右引号, “帐套！”, #换行符, #换行符, “请保存好现行数据，确定要执行吗？”), #标题, 65), 2))
        返回 ()
    .如果真结束
    
.如果真结束
赋值 (窗口调用, 假)
.如果真 (是否已创建 (导航窗口)) ' 关闭已打开的帐套
    导航窗口.销毁 ()
.如果真结束
载入 (帐套管理窗口, _启动窗口, 真)

.子程序 _备份数据_被选择, 空白型, , 
.局部变量 备份目录, 文本型, , , 

.如果真 (等于 (提示信息框 (“压缩备份帐套时将关闭已打开的帐套，请先保存好数据，确定执行！”, #标题, 65), 2))
    返回 ()
.如果真结束
关闭 ()
.如果真 (是否已创建 (导航窗口))
    导航窗口.销毁 ()
.如果真结束
赋值 (.类型, 1)
赋值 (.标题, “请选择备份的路径及文件名：”)
赋值 (.初始目录, 配置项 [11])
赋值 (.文件名, 相加 (时间到文本 (取现行时间 (), 2), “备份”))
.如果真 (取反 (打开 ()))
    提示信息框 (“备份帐套信息被中止！”, #标题, 64)
    返回 ()
.如果真结束
载入 (等待窗口, _启动窗口, 假)
赋值 (等待窗口..标题, “资料备份中  > > > > > ”)
赋值 (备份目录, .文件名)
处理事件 ()
.如果 (等于 (相加 (取运行目录 (), “\data”).未知支持库函数_0 (备份目录), 1)) ' 压缩备份帐套文件
    等待窗口.销毁 ()
    提示信息框 (“压缩备份帐套完毕，请重新打开帐套！”, #标题, 64)
.否则
    提示信息框 (“压缩备份帐套失败，请重启软件后重试！”, #标题, 16, “BF-01”)
.如果结束


.子程序 _恢复数据_被选择, 空白型, , 
.如果真 (等于 (提示信息框 (相加 (#标题, “将暂时关闭，以便恢复帐套信息！”), #标题, 33), 2))
    返回 ()
.如果真结束
关闭 ()
.如果真 (是否已创建 (导航窗口))
    导航窗口.销毁 ()
.如果真结束
赋值 (_启动窗口., 假)
赋值 (.类型, 0)
赋值 (.标题, “请选择需要恢复的备份文件：”)
赋值 (.初始目录, 相加 (取运行目录 (), “\BackUP”))
.如果真 (取反 (打开 ()))
    提示信息框 (“恢复帐套信息被中止！”, #标题, 64)
    赋值 (_启动窗口., 真)
    返回 ()
.如果真结束
载入 (等待窗口, _启动窗口, 假)
赋值 (等待窗口..标题, “资料恢复中  > > > > > ”)
处理事件 ()
.如果 (等于 (.未知支持库函数_2 (.文件名, 相加 (取运行目录 (), “\data”)), 1))
    等待窗口.销毁 ()
    提示信息框 (“恢复帐套完毕，请重新打开帐套！”, #标题, 64)
.否则
    提示信息框 (“恢复帐套失败，请重启软件后重试！”, #标题, 16, “BF-02”)
.如果结束
赋值 (_启动窗口., 真)

.子程序 _退出程序_被选择, 空白型, , 
.如果真 (等于 (提示信息框 (相加 (“确定要退出”, #左引号, #标题, #右引号, “吗？”), #标题, 33), 2))
    返回 ()
.如果真结束
结束 ()

.子程序 _录入客户资料_被选择, 空白型, , 
_录入客资超钮_被单击 ()

.子程序 _浏览客户资料_被选择, 空白型, , 
_浏览客资超钮_被单击 ()

.子程序 _查询客户资料_被选择, 空白型, , 
_查询客资超钮_被单击 ()

.子程序 _录入会员资料_被选择, 空白型, , 
_录入会资超钮_被单击 ()

.子程序 _浏览会员资料_被选择, 空白型, , 
_浏览会资超钮_被单击 ()

.子程序 _查询会员资料_被选择, 空白型, , 
_查询会资超钮_被单击 ()

.子程序 _维修登记_被选择, 空白型, , 
_维修登记超钮_被单击 ()

.子程序 _维修审核_被选择, 空白型, , 
_维修审核超钮_被单击 ()

.子程序 _维修记录_被选择, 空白型, , 
_浏览维记超钮_被单击 ()

.子程序 _维修查询_被选择, 空白型, , 
_查询维修超钮_被单击 ()

.子程序 _基础资料_被选择, 空白型, , 
_基础资料超钮_被单击 ()

.子程序 _货品资料_被选择, 空白型, , 
_货品资料超钮_被单击 ()

.子程序 _客户信息_被选择, 空白型, , 
_客户信息超钮_被单击 ()

.子程序 _会员信息_被选择, 空白型, , 
_会员信息超钮_被单击 ()

.子程序 _记事本_被选择, 空白型, , 
.如果真 (文件是否存在 (相加 (未知支持库函数_7 (10), “\notepad.exe”)))
    运行 (相加 (未知支持库函数_7 (10), “\notepad.exe”), 假, )
.如果真结束


.子程序 _计算器_被选择, 空白型, , 
.如果真 (文件是否存在 (相加 (未知支持库函数_7 (10), “\calc.exe”)))
     ' 运行 (相加 (未知支持库函数_7 (10), “\calc.exe”), 假, )
 ' .如果真结束


.子程序 _帮助信息_被选择, 空白型, , 
.如果真 (取反 (运行 (相加 (“hh.exe ”, 取运行目录 (), “\help.chm”), 假, )))
    提示信息框 (相加 (“运行帮助文件失败，请手动运行”, #左引号, 取运行目录 (), “\Help.chm”, #右引号, “文件！”), #标题, 64)
.如果真结束


.子程序 _注册软件_被选择, 空白型, , 
DLL命令调用转向 (相加 (main路径, “sys.dll”), )
注册文件 (真)

.子程序 _关于_被选择, 空白型, , 
DLL命令调用转向 (相加 (main路径, “sys.dll”), )
载入关于窗口 ()

.子程序 _版权标签_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

跳转 ()

.子程序 _光标编辑时钟_周期事件, 空白型, , 光标退出编辑的时钟事件
表格编辑时钟事件 ()

.子程序 热键处理程序, 整数型, , 相应热键事件
.参数 窗口句柄, 整数型, , 
.参数 消息, 整数型, , 
.参数 参数1, 整数型, , 
.参数 参数2, 整数型, , 

.如果真 (是否已创建 (导航窗口))
    .如果 (等于 (消息, 786))
        .判断开始 (等于 (参数1, 7891))
            发送消息执行子程序 (取窗口句柄 (), 0, 0, 0, &_录入客资超钮_被单击, 0)
            返回 (0)
        .判断 (等于 (参数1, 7823))
            发送消息执行子程序 (取窗口句柄 (), 0, 0, 0, &_录入会资超钮_被单击, 0)
            返回 (0)
        .判断 (等于 (参数1, 7830))
            发送消息执行子程序 (取窗口句柄 (), 0, 0, 0, &_维修登记超钮_被单击, 0)
            返回 (0)
        .默认
            
        .判断结束
        
    .否则
        
    .如果结束
    
.如果真结束
返回 (传递指针到窗口 (原窗口指针, 窗口句柄, 消息, 参数1, 参数2))
 ' 把不需要处理的消息传递给原窗口处理程序，使窗口能正常响应消息

.窗口程序集 导航窗口程序集, , , 

.子程序 _导航窗口_创建完毕, 空白型, , 
.局部变量 超级按钮, 未知类型0x50001, , "43", 
.局部变量 循环变量, 整数型, , , 

数据库连接初始化 ()
赋值 (., 0)
维修提示 ()
.计次循环首 (43, 循环变量)
    赋值 (超级按钮 [循环变量], 取标记组件 (循环变量))
    赋值 (超级按钮 [循环变量], , 到字节集 (114))
.计次循环尾 ()

.子程序 数据库连接初始化, 空白型, , 连接所有表
.如果真 (取反 (相加 (data路径, 启动帐套名, “.czh”).未知支持库函数_1 (“D7D3BAAD2D2D44415441”)))
     ' 打开帐套数据库
    提示信息框 (相加 (#左引号, 启动帐套名, #右引号, “帐套文件读取错误，请重新建立帐套！”), #标题, 16, “DA-01”)
    结束 ()
.如果真结束
.如果真 (取反 (相加 (main路径, “Product.dll”).未知支持库函数_1 (“D7D3BAAD2D2D50524F44”)))
     ' 连接货品配置表
    提示信息框 (相加 (“货品配置数据库文件读取错误，请重新安装！”, #标题, #换行符, #换行符, “这将导致不能编辑和选择货品！”), #标题, 16, “CP-02”)
.如果真结束
.如果真 (取反 (并且 (.未知支持库函数_12 (), .未知支持库函数_12 (), “客户资料”.未知支持库函数_14 (#), “客户配置”.未知支持库函数_14 (#))))
     ' 连接客户资料和配置表
    提示信息框 (相加 (#左引号, 启动帐套名, #右引号, “帐套文件中记录客户资料的数据库读取错误！”, #换行符, #换行符, “这将不能使用”, #左引号, “客户资料”, #右引号, “模块！”), #标题, 16, “DA-02”)
    连续赋值 (真, ., .) ' 打开失败将禁用此部分功能
.如果真结束
.如果真 (取反 (并且 (.未知支持库函数_12 (), .未知支持库函数_12 (), “会员资料”.未知支持库函数_14 (#), “会员配置”.未知支持库函数_14 (#))))
     ' 连接会员资料和配置表
    提示信息框 (相加 (#左引号, 启动帐套名, #右引号, “帐套文件中记录会员资料的数据库读取错误！”, #换行符, #换行符, “这将不能使用”, #左引号, “会员资料”, #右引号, “模块！”), #标题, 16, “DA-03”)
    连续赋值 (真, ., .) ' 打开失败将禁用此部分功能
.如果真结束
.如果真 (取反 (并且 (.未知支持库函数_12 (), “报修资料”.未知支持库函数_14 (#))))
     ' 连接维修记录表
    提示信息框 (相加 (#左引号, 启动帐套名, #右引号, “帐套文件中记录客户维修的数据库读取错误！”, #换行符, #换行符, “这将不能使用”, #左引号, “报修系统”, #右引号, “模块！”), #标题, 16, “DA-04”)
    连续赋值 (真, ., .) ' 打开失败将禁用此部分功能
.如果真结束


.子程序 _导航窗口_将被销毁, 空白型, , 关闭所有已打开的窗口，其实可以用枚举方法获取窗口句柄
未知支持库函数_16 ()
未知支持库函数_16 ()
未知支持库函数_16 ()
未知支持库函数_16 ()
未知支持库函数_16 ()
未知支持库函数_3 ()
未知支持库函数_3 ()
赋值 (启动帐套名, “”)
_启动窗口.置文本 (., 3, “”)
连续赋值 (真, _启动窗口..禁止, _启动窗口..禁止, _启动窗口..禁止, _启动窗口..禁止)
 ' 将 _启动窗口相应的按钮设置为假
枚举子窗口 (_启动窗口.取窗口句柄 (.), &关闭子窗口, “”) ' 枚举所有打开的子窗口

.子程序 关闭子窗口, 空白型, , 关闭枚举到的子窗口
.参数 子窗口句柄, 整数型, , 

.局部变量 缓冲文本, 文本型, , , 
.局部变量 临时文本, 文本型, , , 
.局部变量 文本长度, 整数型, , , 
.局部变量 类名值, 整数型, , , 取窗口的类名值,窗口类名值=30 

赋值 (缓冲文本, 取空白文本 (50))
赋值 (临时文本, 取空白文本 (255))
赋值 (文本长度, 取字节集长度 (到字节集 (临时文本)))
赋值 (类名值, 取窗口类名 (子窗口句柄, 缓冲文本, 50))
发送文本消息 (子窗口句柄, 13, 文本长度, 临时文本)
.如果真 (并且 (不等于 (子窗口句柄, 导航窗口.取窗口句柄 ()), 等于 (类名值, 30))) ' 判断枚举的是窗口不是控件
    发送消息 (子窗口句柄, 16, 0, 0) ' 关闭枚举到的子窗口
.如果真结束


.子程序 _导航窗口_可否被关闭, 逻辑型, , 
.如果真 (等于 (提示信息框 (“这将关闭当前操作的帐套和已打开的窗口！确定要关闭吗？”, #标题, 33), 1))
    返回 (真)
.如果真结束
返回 (假)

.子程序 维修提示, 空白型, , 提示前一天登记的维修记录和未审核的记录
.如果真 (等于 (配置项 [4], “0”)) ' 系统设置要维修提示
    .如果真 (取反 (“报修资料”.未知支持库函数_14 (#)))
        返回 ()
    .如果真结束
    载入 (维修审核窗口, _启动窗口, 假)
    赋值 (维修审核窗口., 1)
    赋值 (维修审核窗口., “IT售后管理系统--维修提示”)
    连续赋值 (真, 维修审核窗口..禁止, 维修审核窗口.., 维修审核窗口..禁止, 维修审核窗口..禁止, 维修审核窗口..禁止, 维修审核窗口..禁止, 维修审核窗口..禁止)
     ' 置父窗口 (维修审核窗口.取窗口句柄 (), _启动窗口.取窗口句柄 (.))
 ' .如果真结束


.子程序 _主客资超钮_被单击, 空白型, , 
赋值 (., 0)

.子程序 _主会资超钮_被单击, 空白型, , 
赋值 (., 1)

.子程序 _主维修超钮_被单击, 空白型, , 
赋值 (., 2)

.子程序 _主基信超钮_被单击, 空白型, , 
赋值 (., 3)

.子程序 _主系设超钮_被单击, 空白型, , 
赋值 (., 4)

.子程序 _导航选择夹_子夹被改变, 空白型, , 更加选择夹的变换设置按钮状态
注册限制 (真)
.判断开始 (等于 (., 0))
    赋值 (., 真)
    连续赋值 (假, ., ., ., .)
.判断 (等于 (., 1))
    赋值 (., 真)
    连续赋值 (假, ., ., ., .)
.判断 (等于 (., 2))
    赋值 (., 真)
    连续赋值 (假, ., ., ., .)
.判断 (等于 (., 3))
    赋值 (., 真)
    连续赋值 (假, ., ., ., .)
.判断 (等于 (., 4))
    赋值 (., 真)
    连续赋值 (假, ., ., ., .)
.默认
    
.判断结束


.子程序 _录入客资超钮_被单击, 空白型, , 
.如果真 (权限 [8]) ' 防止无权限时按热键激活窗口
    .如果真 (是否已创建 (会员资料窗口))
        赋值 (会员资料窗口., 2) ' 最小化会员窗口
    .如果真结束
    赋值 (新增客资, 真)
    载入窗口 (客户资料窗口)
.如果真结束


.子程序 _录入会资超钮_被单击, 空白型, , 
.如果真 (权限 [11]) ' 防止无权限时按热键激活窗口
    .如果真 (是否已创建 (客户资料窗口))
        赋值 (客户资料窗口., 2) ' 最小化客户员窗口
    .如果真结束
    赋值 (新增会资, 真)
    载入窗口 (会员资料窗口)
.如果真结束


.子程序 _维修登记超钮_被单击, 空白型, , 
.如果真 (权限 [14]) ' 防止无权限时按热键激活窗口
    赋值 (新增维修, 真)
    载入窗口 (维修登记窗口)
.如果真结束


.子程序 _浏览客资超钮_被单击, 空白型, , 
赋值 (调用记录集, 导航窗口.)
.如果真 (是否已创建 (资料浏览窗口))
    资料浏览窗口.销毁 ()
.如果真结束
载入窗口 (资料浏览窗口)

.子程序 _浏览会资超钮_被单击, 空白型, , 
赋值 (调用记录集, 导航窗口.)
.如果真 (是否已创建 (资料浏览窗口))
    资料浏览窗口.销毁 ()
.如果真结束
载入窗口 (资料浏览窗口)

.子程序 _浏览维记超钮_被单击, 空白型, , 
赋值 (调用记录集, 导航窗口.)
.如果真 (是否已创建 (资料浏览窗口))
    资料浏览窗口.销毁 ()
.如果真结束
载入窗口 (资料浏览窗口)

.子程序 _查询客资超钮_被单击, 空白型, , 
赋值 (调用记录集, 导航窗口.)
.如果真 (是否已创建 (条件查询窗口))
    条件查询窗口.销毁 ()
.如果真结束
载入窗口 (条件查询窗口)

.子程序 _查询会资超钮_被单击, 空白型, , 
赋值 (调用记录集, 导航窗口.)
.如果真 (是否已创建 (条件查询窗口))
    条件查询窗口.销毁 ()
.如果真结束
载入窗口 (条件查询窗口)


.子程序 _查询维修超钮_被单击, 空白型, , 
赋值 (调用记录集, 导航窗口.)
.如果真 (是否已创建 (条件查询窗口))
    条件查询窗口.销毁 ()
.如果真结束
载入窗口 (条件查询窗口)

.子程序 _维修审核超钮_被单击, 空白型, , 
载入窗口 (维修审核窗口)

.子程序 _基础资料超钮_被单击, 空白型, , 
.如果真 (是否已创建 (系统配置窗口))
    .如果真 (等于 (提示信息框 (相加 (“请先关闭”, #左引号, “系统配置窗口”, #右引号, “后在设置基础信息！”, #换行符, #换行符, “点击”, #左引号, “确定”, #右引号, “系统将自动关闭”, #左引号, “系统配置窗口”, #右引号, “，点击”, #左引号, “取消”, #右引号, “将手动关闭！”), #标题, 65), 2))
        系统配置窗口.激活 ()
        返回 ()
    .如果真结束
    系统配置窗口.销毁 ()
.如果真结束
载入窗口 (基础信息窗口)

.子程序 _货品资料超钮_被单击, 空白型, , 
赋值 (显示货品, 真)
.如果 (是否已创建 (货品配置窗口))
    赋值 (货品配置窗口., 真)
    货品配置窗口.激活 ()
.否则
    载入窗口 (货品配置窗口)
.如果结束


.子程序 _客户信息超钮_被单击, 空白型, , 
赋值 (调用记录集, 导航窗口.)
.如果真 (是否已创建 (客户信息窗口))
    客户信息窗口.销毁 ()
.如果真结束
载入窗口 (客户信息窗口)

.子程序 _会员信息超钮_被单击, 空白型, , 
赋值 (调用记录集, 导航窗口.)
.如果真 (是否已创建 (客户信息窗口))
    客户信息窗口.销毁 ()
.如果真结束
载入窗口 (客户信息窗口)

.子程序 _用户管理超钮_被单击, 空白型, , 
载入 (用户管理窗口, _启动窗口, 假)
置父窗口 (用户管理窗口.取窗口句柄 (), _启动窗口.取窗口句柄 (.))

.子程序 _帐套管理超钮_被单击, 空白型, , 
_帐套管理_被选择 ()

.子程序 _系统配置超钮_被单击, 空白型, , 
.如果真 (是否已创建 (基础信息窗口))
    .如果真 (等于 (提示信息框 (相加 (“请先关闭”, #左引号, “基础信息窗口”, #右引号, “后在设置系统！”, #换行符, #换行符, “点击”, #左引号, “确定”, #右引号, “系统将自动关闭”, #左引号, “基础信息窗口”, #右引号, “，点击”, #左引号, “取消”, #右引号, “将手动关闭！”), #标题, 65), 2))
        基础信息窗口.激活 ()
        返回 ()
    .如果真结束
    基础信息窗口.销毁 ()
.如果真结束
载入窗口 (系统配置窗口)

.子程序 _备份数据超钮_被单击, 空白型, , 
_备份数据_被选择 ()

.子程序 _恢复数据超钮_被单击, 空白型, , 
_恢复数据_被选择 ()

.子程序 _小货资超钮_被单击, 空白型, , 
_货品资料超钮_被单击 ()

.子程序 _小货资超钮1_被单击, 空白型, , 
_货品资料超钮_被单击 ()

.子程序 _小基资超钮_被单击, 空白型, , 
_基础资料超钮_被单击 ()

.子程序 _小基资超钮1_被单击, 空白型, , 
_基础资料超钮_被单击 ()

.子程序 _小基资超钮2_被单击, 空白型, , 
_基础资料超钮_被单击 ()

.子程序 _小基资超钮3_被单击, 空白型, , 
_基础资料超钮_被单击 ()

.子程序 _小客信超钮_被单击, 空白型, , 
_客户信息超钮_被单击 ()

.子程序 _小客信超钮1_被单击, 空白型, , 
_客户信息超钮_被单击 ()

.子程序 _小客信超钮2_被单击, 空白型, , 
_客户信息超钮_被单击 ()

.子程序 _小会信超钮_被单击, 空白型, , 
_会员信息超钮_被单击 ()

.子程序 _小会信超钮1_被单击, 空白型, , 
_会员信息超钮_被单击 ()

.子程序 _小会信超钮2_被单击, 空白型, , 
_会员信息_被选择 ()

.子程序 _退出超钮_被单击, 空白型, , 
.如果真 (等于 (提示信息框 (“这将关闭当前操作的帐套和已打开的窗口！确定要关闭吗？”, #标题, 33), 1))
    导航窗口.销毁 ()
.如果真结束


.子程序 _退出超钮1_被单击, 空白型, , 
_退出超钮_被单击 ()

.子程序 _退出超钮2_被单击, 空白型, , 
_退出超钮_被单击 ()

.子程序 _退出超钮3_被单击, 空白型, , 
_退出超钮_被单击 ()

.子程序 _退出超钮4_被单击, 空白型, , 
_退出超钮_被单击 ()

.子程序 _计算器超钮_被单击, 空白型, , 
_计算器_被选择 ()

.子程序 _记事本超钮_被单击, 空白型, , 
_记事本_被选择 ()

.子程序 _邮件签_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_启动窗口.跳转 (.)

.子程序 载入窗口, 空白型, , 载入窗口和并置为子窗口
.参数 欲载入窗口, 窗口, , 

载入 (欲载入窗口, _启动窗口, 假)
置父窗口 (欲载入窗口.取窗口句柄 (), _启动窗口.取窗口句柄 (.))

.窗口程序集 客户资料窗口程序集, , , 

.程序集变量 客资编辑框, 编辑框, , "7", 遍历窗口上所有的编辑框
.程序集变量 客资组合框, 组合框, , "3", 遍历窗口上所有的组合框
.程序集变量 客资日期框, 日期框, , "1", 遍历窗口上所有的日期框
.程序集变量 修改编号, 文本型, , , 修改记录前的客户编号
.子程序 _客户资料窗口_创建完毕, 空白型, , 
客户表头初始化 ()
置表格显示按钮 (客户资料窗口, , )
 ' 置光标退出编辑 ()
配置文件到组合框 (“销售部门”) ' 添加配置文件到组合框列表中
配置文件到组合框 (“销售代表”)
配置文件到组合框 (“技术人员”)
清空数据 (客户资料窗口, 客资编辑框, 客资组合框, 客资日期框, )
 ' 用取窗口标记()取得窗口中的控件，便于循环操作
客取记录数量 () ' 显示总记录数量
.如果 (新增客资) ' 新增资料为真，浏览、修改等操作时为假
    连续赋值 (真, .禁止, .禁止, .禁止)
    赋值 (.内容, 自动编号 (导航窗口., “客户编号”, 1))
.否则
    连续赋值 (真, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
.如果结束
显示动态窗口 (客户资料窗口, 30, 1)
获取焦点 ()
赋值 (., 到数值 (配置项 [2]))

.子程序 客户表头初始化, 空白型, , 初始化表头文字、表格类型及宽度
.局部变量 列宽度, 整数型, , "7", 
.局部变量 表头标题, 文本型, , "7", 
.局部变量 列类型, 整数型, , "7", 

未知支持库函数_57 ()
赋值 (列宽度, { 60, 80, 140, 38, 42, 116, 103 }) ' 用于置每列的宽度
赋值 (表头标题, { “类 别”, “品  牌”, “型      号”, “单位”, “数量”, “质 保 方 式”, “备    注” }) ' 用于置列表头的信息
赋值 (列类型, { 1, 1, 1, 1, 2, 1, 1 })
表格初始化 (24, 8, 列宽度, 表头标题, 列类型, 真, 真)

.子程序 _客户资料表格_按下某键, 逻辑型, , 加入一行表格
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

末尾加入行表格 (键代码, 真, 9) ' 在表格的最后一行加入一行表格

.子程序 _客户资料表格_光标位置改变, 空白型, , 结束编辑时隐藏按钮
赋值 (.可视, 假)
撤表格只读方式 ()

.子程序 _客显产品钮_被单击, 空白型, , 载入产品产品配置窗口
赋值 (显示货品, 假)
.如果 (是否已创建 (货品配置窗口))
    赋值 (货品配置窗口., 真)
    货品配置窗口.激活 ()
.否则
    载入 (货品配置窗口, _启动窗口, 假)
    置父窗口 (货品配置窗口.取窗口句柄 (), _启动窗口.取窗口句柄 (.))
.如果结束


.子程序 _取消钮_被单击, 空白型, , 
.局部变量 提示返回值, 整数型, , , 

.如果 (.禁止)
    客户资料窗口.销毁 ()
.否则
    .如果真 (取反 (判断输入内容 (假, , , “客户姓名”, , “客户电话”, , “购买金额”)))
        赋值 (提示返回值, 提示信息框 (“当前数据未保存，是否保存数据？”, #标题, 35))
    .如果真结束
    .如果 (或者 (等于 (提示返回值, 0), 等于 (提示返回值, 7))) ' 没有数据或返回否
        客户资料窗口.销毁 ()
    .否则
        .如果 (等于 (提示返回值, 2)) ' 返回取消
            返回 ()
        .否则
            .如果 (等于 (提示返回值, 6)) ' 返回保存
                _保存钮_被单击 ()
            .否则
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 _保存钮_被单击, 空白型, , 
.如果真 (判断输入内容 (真, , , “客户编号”, , “客户姓名”, , “购买金额”))
    .如果 (新增客资)
        .如果真 (编号是否重复 (导航窗口., “客户编号”, 删首尾空 (.内容))) ' 判断输入的客户编号是否是唯一的编号
            .如果真 (等于 (提示信息框 (相加 (“客户编号重复，请重新输入客户的唯一编号！”, #换行符, #换行符, “是否使用系统自动编号功能？”), #标题, 49), 1))
                赋值 (.内容, 自动编号 (导航窗口., “客户编号”, 1))
            .如果真结束
            获取焦点 ()
            返回 ()
        .如果真结束
        .如果真 (取反 (并且 (导航窗口.未知支持库函数_17 (.), 导航窗口.未知支持库函数_20 (., “客户编号”, .内容))))
            提示信息框 (“新增客户记录失败！请重新启动软件后重试！”, #标题, 48, “NK-05”)
            返回 ()
        .如果真结束
        .如果 (编组日框到数据库 (导航窗口., 导航窗口., 客资编辑框, 客资组合框, 客资日期框))
            .如果真 (取反 (高级表格到数据库 (导航窗口., 导航窗口., , 1, 真, .内容, “客户编号”)))
                提示信息框 (“保存客户配置资料失败！”, #标题, 16, “NK-04”)
                返回 ()
            .如果真结束
            
        .否则
            提示信息框 (“保存客户信息资料失败！”, #标题, 16, “NK-03”)
            返回 ()
        .如果结束
        清空数据 (客户资料窗口, 客资编辑框, 客资组合框, 客资日期框, )
        赋值 (.内容, 自动编号 (导航窗口., “客户编号”, 1))
        客取记录数量 ()
        获取焦点 ()
    .否则
        .如果真 (不等于 (修改编号, .内容))
            .如果真 (编号是否重复 (导航窗口., “客户编号”, 删首尾空 (.内容))) ' 判断输入的客户编号是否是唯一的编号
                提示信息框 (“此客户编号已经存在，请重新输入客户的唯一编号！”, #标题, 48)
                赋值 (.内容, 修改编号)
                获取焦点 ()
                返回 ()
            .如果真结束
            
        .如果真结束
        .如果真 (条件删除数据库 (导航窗口., 导航窗口., 相加 (“客户编号='”, .内容, “'”)))
            导航窗口.未知支持库函数_17 (.)
            导航窗口.未知支持库函数_20 (., “客户编号”, .内容)
            .如果 (编组日框到数据库 (导航窗口., 导航窗口., 客资编辑框, 客资组合框, 客资日期框))
                .如果 (高级表格到数据库 (导航窗口., 导航窗口., , 1, 真, .内容, “客户编号”))
                    连续赋值 (真, .禁止, .禁止, .禁止)
                    连续赋值 (假, .禁止, .禁止, .禁止)
                    导航窗口.未知支持库函数_16 (.)
                    导航窗口.未知支持库函数_14 (., “客户配置”, #)
                    提示信息框 (“修改客户资料信息成功！”, #标题, 64)
                    返回 ()
                .否则
                    提示信息框 (“修改客户配置资料失败！”, #标题, 16, “NK-09”)
                    返回 ()
                .如果结束
                
            .否则
                提示信息框 (“修改客户信息资料失败！”, #标题, 16, “NK-08”)
                返回 ()
            .如果结束
            
        .如果真结束
        提示信息框 (“修改失败！数据库中未搜索到需修改的客户编号！”, #标题, 16, “NK-10”)
    .如果结束
    
.如果真结束


.子程序 _前单钮_被单击, 空白型, , 
.如果真 (或者 (导航窗口.., 等于 (导航窗口.., 0)))
    提示信息框 (“已到最前一单，无信息显示！”, #标题, 64)
    返回 ()
.如果真结束
.如果真 (取反 (.禁止))
    .如果真 (取反 (判断输入内容 (假, , )))
        .如果真 (等于 (提示信息框 (“当前数据未保存，是否放弃保存？”, #标题, 65), 2))
            连续赋值 (假, .禁止, .禁止, .禁止)
            连续赋值 (真, .禁止, .禁止, .禁止)
            返回 ()
        .如果真结束
        
    .如果真结束
    
.如果真结束
导航窗口.未知支持库函数_37 (.)
客前后显示数据 ()

.子程序 _后单钮_被单击, 空白型, , 
.如果真 (或者 (导航窗口.., 等于 (导航窗口.., 相减 (导航窗口.., 1))))
    提示信息框 (“已到最后一单，无信息显示！”, #标题, 64)
    返回 ()
.如果真结束
.如果真 (取反 (.禁止))
    .如果真 (取反 (判断输入内容 (假, , )))
        .如果真 (等于 (提示信息框 (“当前数据未保存，是否放弃保存？”, #标题, 65), 2))
            连续赋值 (假, .禁止, .禁止, .禁止)
            连续赋值 (真, .禁止, .禁止, .禁止)
            返回 ()
        .如果真结束
        
    .如果真结束
    
.如果真结束
导航窗口.未知支持库函数_36 (.)
客前后显示数据 ()

.子程序 客前后显示数据, 空白型, , 用于前后钮的显示数据
连续赋值 (真, .禁止, .禁止, .禁止)
连续赋值 (假, .禁止, .禁止, .禁止)
清空数据 (客户资料窗口, 客资编辑框, 客资组合框, 客资日期框, , , )
数据库到编组日框 (导航窗口., “”, 客资编辑框, 客资组合框, 客资日期框, 假, 真, 真)
数据库到高级表格_有序 (导航窗口., , 1, 相加 (“客户编号='”, .内容, “'”), 假, 1, 0, , , , 9)

.子程序 _删除钮_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    提示信息框 (“未找到客户编号，无法确立删除对象！”, #标题, 16, “NK-06”)
    返回 ()
.如果真结束
.如果真 (等于 (提示信息框 (相加 (“删除记录后将不可再恢复，确定要删除客户编号为： ”, .内容, “ 的记录吗？”), #标题, 33), 2))
    返回 ()
.如果真结束
.如果 (条件删除数据库 (导航窗口., 导航窗口., 相加 (“客户编号='”, .内容, “'”)))
    提示信息框 (相加 (“删除客户编号为：”, .内容, “ 的记录成功！”), #标题, 64)
    客取记录数量 ()
    _前单钮_被单击 ()
.否则
    提示信息框 (相加 (“删除客户编号为：”, .内容, “ 的记录失败！”), #标题, 16, “NK-07”)
.如果结束


.子程序 _修改钮_被单击, 空白型, , 
赋值 (修改编号, .内容)
连续赋值 (假, .禁止, .禁止, .禁止)
赋值 (新增客资, 假)
获取焦点 ()

.子程序 _新增钮_被单击, 空白型, , 
.如果真 (取反 (.禁止))
    .如果真 (取反 (判断输入内容 (假, , )))
        .如果真 (等于 (提示信息框 (“当前数据未保存，是否放弃保存？”, #标题, 65), 2))
            返回 ()
        .如果真结束
        
    .如果真结束
    
.如果真结束
连续赋值 (假, .禁止, .禁止, .禁止)
连续赋值 (真, .禁止, .禁止, .禁止)
清空数据 (客户资料窗口, 客资编辑框, 客资组合框, 客资日期框, )
赋值 (.内容, 自动编号 (导航窗口., “客户编号”, 1))
赋值 (新增客资, 真)
获取焦点 ()

.子程序 _插入一行_被选择, 空白型, , 
.局部变量 插入行, 整数型, , , 

赋值 (插入行, 未知支持库函数_3 ())
.如果真 (大于 (插入行, 0)) ' 防止光标超出范围
    .未知支持库函数_38 (相加 (插入行, 1))
    相加 (插入行, 1).未知支持库函数_31 (.) ' 将插入的行置为统一高度
    .如果真 (等于 (., 10)) ' 超出表格高度
        6.未知支持库函数_32 (相减 (103, 17)) ' 保持不出现横向滚动条
    .如果真结束
    
.如果真结束


.子程序 _删除此行_被选择, 空白型, , 
.如果真 (大于 (未知支持库函数_3 (), 0))
    未知支持库函数_3 ().未知支持库函数_36 ()
    .如果真 (小于 (., 9)) ' 不能将两行合一成<=
        .未知支持库函数_38 ()
        0.未知支持库函数_31 (24) ' 同上
        8.未知支持库函数_31 (22)
    .如果真结束
    .如果真 (等于 (., 9))
        6.未知支持库函数_32 (102)
        0.未知支持库函数_31 (24) ' 同上
    .如果真结束
    
.如果真结束


.子程序 客取记录数量, 空白型, , 
.局部变量 记录总数量, 整数型, , , 共有多少客户记录

导航窗口.未知支持库函数_47 (., “”)
导航窗口.未知支持库函数_35 (.)
赋值 (导航窗口..)
赋值 (.标题, 相加 (“ ◇共计客户记录 ”, 到文本 (), “/条”))

.子程序 _转到钮_被单击, 空白型, , 
弹出菜单 ()

.子程序 _到首记录_被选择, 空白型, , 
导航窗口.未知支持库函数_38 (., 0)
客前后显示数据 ()

.子程序 _到尾记录_被选择, 空白型, , 
导航窗口.未知支持库函数_38 (., 相减 (导航窗口.., 1))
客前后显示数据 ()

.子程序 _到指定记录_被选择, 空白型, , 移动到指定记录上
.局部变量 跳转数, 整数型, , , 
.局部变量 总数, 整数型, , , 

赋值 (总数, 导航窗口..)
.如果真 (输入框 (相加 (“请指定要转到的记录号数！ 范围： 1～”, 到文本 (总数), “ 之间”), #标题, , 跳转数, 2))
    .如果真 (或者 (小于 (跳转数, 1), 大于 (跳转数, 总数)))
        提示信息框 (“输入的记录号数超出范围，请重新输入！”, #标题, 48)
        _到指定记录_被选择 ()
        返回 ()
    .如果真结束
    导航窗口.未知支持库函数_38 (., 相减 (跳转数, 1))
    客前后显示数据 ()
.如果真结束


.子程序 _客户资料窗口_可否被关闭, 逻辑型, , 
_取消钮_被单击 ()

.子程序 _客户资料表格_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()
客户资料窗口.重画 ()
重画 ()

.子程序 _客户资料窗口_被取消激活, 空白型, , 
赋值 (.可视, 假)

.子程序 _客户资料窗口_将被销毁, 空白型, , 
 ' 撤光标退出编辑 ()
导航窗口.未知支持库函数_18 (.)
导航窗口.未知支持库函数_18 (.)

.子程序 客资外部修改接口, 空白型, , 用于资料浏览时或外部窗口程序调用的接口
.参数 修改条件, 文本型, , 

数据库到编组日框 (导航窗口., 修改条件, 客资编辑框, 客资组合框, 客资日期框, 假, 假, 真)
数据库到高级表格_有序 (导航窗口., , 1, 相加 (“客户编号='”, .内容, “'”), 假, 1, 0, , , , 9)
_修改钮_被单击 ()

.窗口程序集 货品配置窗口程序集, , , 

.程序集变量 图标值, 整数型, , , 在列表框中显示的图标
.程序集变量 类别选中值, 文本型, , , 类别组合框产生的选中文本
.程序集变量 品牌选中值, 文本型, , , 品牌组合框产生的选中文本
.程序集变量 欲加数据表格, 未知类型0x80001, , , 向那个表格添加数据
.程序集变量 传递光标值, 整数型, , , 表格现行光标行
.程序集变量 新增修改, 逻辑型, , , 真为新增，假为修改
.程序集变量 型号文本, 文本型, , , 新增或修改的产品型号
.程序集变量 附件修改, 逻辑型, , , 单位或备注或质保被修改
.程序集变量 信息, 文本型, , , 修改或新增
.子程序 _货品配置窗口_创建完毕, 空白型, , 
.如果 (并且 (导航窗口.未知支持库函数_12 (.), 导航窗口.未知支持库函数_12 (.), 导航窗口.未知支持库函数_12 (.)))
    .如果 (并且 (“类别表”.未知支持库函数_15 (“L类别 ASC”), “品牌表”.未知支持库函数_15 (“P类别 ASC,P品牌 ASC”), “型号表”.未知支持库函数_15 (“X类别 ASC,X品牌 ASC,型号 ASC”)))
        赋值 (货品配置窗口., 相减 (_启动窗口.取用户区宽度 (.), 565))
         ' 贴近屏幕右边，便于客户查看录入的资料
        赋值 (.现行子夹, 0)
        产品配置表头初始化 ()
        数据到组合框 (“L类别”, “”)
        数据库到高级表格_有序 (0, “”, 假, 1, 0, )
        配置文件到组合框 (“计量单位”)
        配置文件到组合框 (“质保方式”)
        赋值 (.现行选中项, 0)
        赋值 (.禁止, 真)
        赋值 (信息, “修改”)
        赋值 (., 到数值 (配置项 [2]))
        连续赋值 (取反 (权限 [7]), .禁止, .禁止)
        显示动态窗口 (货品配置窗口, 30, 1)
    .否则
        提示信息框 (“打开产品配置数据库失败，无法完成操作！”, #标题, 16, “CP-02”)
        .如果真 (是否已创建 (货品配置窗口))
            货品配置窗口.销毁 ()
        .如果真结束
        
    .如果结束
    
.否则
    提示信息框 (“打开产品配置数据库失败，无法完成操作！”, #标题, 16, “CP-01”)
    .如果真 (是否已创建 (货品配置窗口))
        货品配置窗口.销毁 ()
    .如果真结束
    
.如果结束


.子程序 产品配置表头初始化, 空白型, , 初始化表头文字、表格类型及宽度
.局部变量 列宽度, 整数型, , "6", 
.局部变量 表头标题, 文本型, , "6", 
.局部变量 列类型, 整数型, , "6", 

赋值 (列宽度, { 70, 60, 80, 140, 40, 120 })
赋值 (表头标题, { “产品编号”, “类 别”, “品  牌”, “型      号”, “单位”, “质 保 方 式” })
表格初始化 (24, ., 列宽度, 表头标题, , 真, 真)

.子程序 数据到超级列表框, 空白型, , 
.参数 记录集, 未知类型0x90002, , 
.参数 欲读字段, 文本型, , 读那个字段
.参数 过滤条件, 文本型, , 不过滤用“”
.参数 保持过滤状态, 逻辑型, , 真为保持
.参数 图标值, 整数型, , 列表框中显示的图标
.参数 说明标签, 标签, , 显示数量的标签

.局部变量 文本值, 文本型, , , 存放读出的文本数据

记录集.未知支持库函数_34 ()
全部删除 ()
记录集.未知支持库函数_47 (过滤条件)
.判断循环首 (等于 (记录集., 假))
    记录集.未知支持库函数_26 (欲读字段, 文本值)
    .如果真 (不等于 (文本值, 相减 (取表项数 (), 1).取标题 ()))
         ' 如品牌有很大重复只在列表框中显示一条相同的品牌
        .插入表项 (文本值, 图标值, , , )
    .如果真结束
    记录集.未知支持库函数_36 ()
.判断循环尾 ()
.如果真 (取反 (保持过滤状态))
    记录集.未知支持库函数_47 (“”)
.如果真结束
赋值 (说明标签.标题, 相加 (“ 共计 ”, 到文本 (取表项数 ()), “/条 记录”))

.子程序 _显类别组框_列表项被选择, 空白型, , 
.如果 (等于 (.现行选中项, 0))
    赋值 (.禁止, 真)
    数据库到高级表格_有序 (0, “”, 假, 1, 0, )
.否则
    赋值 (类别选中值, .取项目文本 (.现行选中项))
    数据库到高级表格_有序 (0, 相加 (“X类别='”, 类别选中值, “'”), 真, 1, 0, )
    数据到组合框 (“P品牌”, 相加 (“P类别='”, 类别选中值, “'”))
    赋值 (.禁止, 假)
.如果结束
赋值 (.现行选中项, 0)

.子程序 _显品牌组框_列表项被选择, 空白型, , 
.如果 (等于 (.现行选中项, 0))
    数据库到高级表格_有序 (0, 相加 (“X类别='”, 类别选中值, “'”), 假, 1, 0, )
.否则
    赋值 (品牌选中值, .取项目文本 (.现行选中项))
    数据库到高级表格_有序 (0, 相加 (“X类别='”, 类别选中值, “' AND X品牌='”, 品牌选中值, “'”), 假, 1, 0, )
.如果结束


.子程序 _查询钮_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    提示信息框 (“查询内容不可为空，请重新输入要查询的型号！”, #标题, 64)
    获取焦点 ()
    返回 ()
.如果真结束
.如果 (等于 (.现行选中项, 0))
    数据库到高级表格_有序 (0, 相加 (“型号 LIKE '%”, .内容, “%'”), 假, 1, 0, )
.否则
    .如果 (等于 (.现行选中项, 0))
        数据库到高级表格_有序 (0, 相加 (“类别='”, 类别选中值, “' AND 型号 LIKE '%”, .内容, “%'”), 假, 1, 0, )
    .否则
        数据库到高级表格_有序 (0, 相加 (“类别='”, 类别选中值, “' AND 品牌='”, 品牌选中值, “' AND 型号 LIKE '%”, .内容, “%'”), 假, 1, 0, )
    .如果结束
    
.如果结束
赋值 (.内容, “”)

.子程序 _产品配置表格_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_添加钮_被单击 ()

.子程序 _产品配置表格_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 添加产品到单据, 空白型, , 
.参数 表格行数, 整数型, , 

.局部变量 循环变量, 整数型, , , 
.局部变量 原光标列数, 整数型, , , 

赋值 (原光标列数, 欲加数据表格.未知支持库函数_4 ()) ' 插入行以前,用户选择的列数
.如果真 (大于 (未知支持库函数_3 (), 0))
    .计次循环首 (5, 循环变量)
        欲加数据表格.未知支持库函数_9 (传递光标值, 相减 (循环变量, 1), #., 未知支持库函数_3 ().未知支持库函数_10 (循环变量))
        .如果真 (等于 (循环变量, 5))
            欲加数据表格.未知支持库函数_9 (传递光标值, 循环变量, #., 未知支持库函数_3 ().未知支持库函数_10 (循环变量))
        .如果真结束
        
    .计次循环尾 ()
    赋值 (传递光标值, 相加 (传递光标值, 1)) ' 连续添加时表格自动向下移动
    .如果真 (等于 (传递光标值, 欲加数据表格.)) ' 表格行数超出原行数
        欲加数据表格.未知支持库函数_38 ()
        .如果真 (等于 (欲加数据表格., 相加 (表格行数, 1)))
             ' 第一次表格行数超出原行数时调整列宽，使其不出现横向滚动条
            欲加数据表格.未知支持库函数_32 (相减 (欲加数据表格., 1), 相减 (欲加数据表格.未知支持库函数_44 (相减 (欲加数据表格., 1)), 17))
        .如果真结束
        
    .如果真结束
    欲加数据表格.未知支持库函数_0 (相减 (传递光标值, 1), 原光标列数)
.如果真结束


.子程序 _添加钮_被单击, 空白型, , 
.如果 (是否已创建 (客户资料窗口))
    添加产品到单据 (9)
.否则
    .如果真 (是否已创建 (会员资料窗口))
        添加产品到单据 (9)
    .如果真结束
    
.如果结束


.子程序 _添加到单据_被选择, 空白型, , 
_添加钮_被单击 ()

.子程序 _全加钮_被单击, 空白型, , 
.局部变量 被选行数, 整数型, , , 
.局部变量 循环变量, 整数型, , , 

赋值 (被选行数, 相加 (相减 (未知支持库函数_7 (), 未知支持库函数_5 ()), 1))
.如果 (等于 (被选行数, 1))
    _添加钮_被单击 ()
.否则
    .计次循环首 (被选行数, 循环变量) ' 选择了几行就添加几次
        _添加钮_被单击 ()
        相加 (未知支持库函数_3 (), 1).未知支持库函数_0 (0)
        相加 (未知支持库函数_5 (), 1).未知支持库函数_1 (0, 未知支持库函数_7 (), 5)
    .计次循环尾 ()
.如果结束


.子程序 _全部到单据_被选择, 空白型, , 
_全加钮_被单击 ()

.子程序 _编辑货品_被选择, 空白型, , 
_编货钮_被单击 ()

.子程序 _退出钮_被单击, 空白型, , 
.如果真 (或者 (是否已创建 (客户资料窗口), 是否已创建 (会员资料窗口)))
    赋值 (.现行子夹, 0)
    赋值 (货品配置窗口., 假)
    返回 ()
.如果真结束
货品配置窗口.销毁 ()

.子程序 _编货钮_被单击, 空白型, , 
赋值 (.现行子夹, 1)
数据到组合框 (“L类别”, “”)
数据到超级列表框 (“L类别”, “”, 假, 0, )
连续赋值 (0, .现行选中项, .现行选中项, 图标值)
连续赋值 (“”, .内容, .内容, .内容, .内容)
连续赋值 (真, .禁止, .禁止)

.子程序 _增类别组框_列表项被选择, 空白型, , 
.如果 (等于 (.现行选中项, 0))
    赋值 (图标值, 0) ' 用于显示在列表框中的图标
    连续赋值 (真, .禁止, .禁止)
    数据到超级列表框 (“L类别”, “”, 假, 0, )
.否则
    赋值 (类别选中值, .取项目文本 (.现行选中项))
    赋值 (图标值, 1)
    数据到超级列表框 (“P品牌”, 相加 (“P类别='”, 类别选中值, “'”), 真, 1, )
    数据到组合框 (“P品牌”, 相加 (“P类别='”, 类别选中值, “'”))
    赋值 (.禁止, 假)
.如果结束
赋值 (.现行选中项, 0)
连续赋值 (“”, .内容, .内容, .内容, .内容)

.子程序 _增品牌组框_列表项被选择, 空白型, , 
.如果 (等于 (.现行选中项, 0))
    赋值 (图标值, 1)
    数据到超级列表框 (“P品牌”, 相加 (“P类别='”, 类别选中值, “'”), 真, 1, )
    赋值 (.禁止, 真)
.否则
    赋值 (品牌选中值, .取项目文本 (.现行选中项))
    赋值 (图标值, 2)
    数据到超级列表框 (“型号”, 相加 (“X类别='”, 类别选中值, “' AND X品牌='”, 品牌选中值, “'”), 假, 2, )
    赋值 (.禁止, 假)
.如果结束
连续赋值 (“”, .内容, .内容, .内容, .内容)

.子程序 _产品列表框_表项被激活, 空白型, , 
.如果 (等于 (.现行选中项, 0))
    赋值 (.现行选中项, 相加 (., 1))
    _增类别组框_列表项被选择 ()
.否则
    .如果真 (等于 (.现行选中项, 0))
        赋值 (.现行选中项, 相加 (., 1))
        _增品牌组框_列表项被选择 ()
    .如果真结束
    
.如果结束


.子程序 _返回上层_被选择, 空白型, , 
.如果 (不等于 (.现行选中项, 0))
    赋值 (.现行选中项, 0)
    _增品牌组框_列表项被选择 ()
.否则
    .如果真 (不等于 (.现行选中项, 0))
        赋值 (.现行选中项, 0)
        _增类别组框_列表项被选择 ()
    .如果真结束
    
.如果结束


.子程序 _产品列表框_右键单击表项, 空白型, , 
弹出菜单 ()

.子程序 _放弃钮_被单击, 空白型, , 
赋值 (.现行子夹, 0)

.子程序 _货品配置窗口_将被销毁, 空白型, , 
未知支持库函数_16 ()
未知支持库函数_16 ()
未知支持库函数_16 ()
赋值 (显示货品, 假)

.子程序 _产品列表框_结束编辑, 逻辑型, , 修改产品
.参数 表项索引, 整数型, , 

.局部变量 循环变量, 整数型, , , 
.局部变量 原产品名, 文本型, , , 
.局部变量 现产品名, 文本型, , , 
.局部变量 返回值, 整数型, , , 

赋值 (原产品名, .取标题 (., ))
.计次循环首 (取表项数 (), 循环变量)
     ' 检查修改产品后是否重名
    .如果真 (等于 (., 相减 (循环变量, 1).取标题 ()))
        提示信息框 (“已有同名产品，请给产品命名一个唯一名称！”, #标题, 48)
        .进入编辑 (.)
        返回 (假)
    .如果真结束
    
.计次循环尾 ()
赋值 (现产品名, .)
.如果真 (等于 (.现行选中项, 0)) ' 产品列表框中显示的是类别
    .如果真 (等于 (条件修改数据库 (导航窗口., , 相加 (“L类别='”, 原产品名, “'”), “L类别”, 现产品名), 0))
         ' 修改类别表
        赋值 (返回值, 条件修改数据库 (导航窗口., , 相加 (“X类别='”, 原产品名, “'”), “X类别”, 现产品名))
         ' 修改型号表
        .如果真 (或者 (等于 (返回值, 0), 等于 (返回值, 1))) ' 修改成功或型号表中没有
            数据到组合框 (“L类别”, “”)
            数据到组合框 (“L类别”, “”)
             ' 将新增或修改的项目加入到相应的组合框中
            提示信息框 (相加 (“将原类别”, #左引号, 原产品名, #右引号, “修改为”, #左引号, 现产品名, #右引号, “成功！”), #标题, 64)
            重画 ()
            返回 (真)
        .如果真结束
        
    .如果真结束
    提示信息框 (相加 (“将原类别”, #左引号, 原产品名, #右引号, “修改为”, #左引号, 现产品名, #右引号, “失败！”), #标题, 16, “CP-08”)
    重画 ()
    返回 (假)
.如果真结束
.如果真 (等于 (.现行选中项, 0)) ' 产品列表框中显示的是品牌
    .如果真 (等于 (条件修改数据库 (导航窗口., , 相加 (“P类别='”, .内容, “' AND P品牌='”, 原产品名, “'”), “P品牌”, 现产品名), 0))
        赋值 (返回值, 条件修改数据库 (导航窗口., , 相加 (“X类别='”, .内容, “' AND X品牌='”, 原产品名, “'”), “X品牌”, 现产品名))
        .如果真 (或者 (等于 (返回值, 0), 等于 (返回值, 1))) ' 修改成功或型号表中没有
            数据到组合框 (“P品牌”, 相加 (“P类别='”, 类别选中值, “'”))
            数据到组合框 (“P品牌”, 相加 (“P类别='”, 类别选中值, “'”))
            提示信息框 (相加 (“将原品牌”, #左引号, 原产品名, #右引号, “修改为”, #左引号, 现产品名, #右引号, “成功！”), #标题, 64)
            重画 ()
            返回 (真)
        .如果真结束
        
    .如果真结束
    提示信息框 (相加 (“将原品牌”, #左引号, 原产品名, #右引号, “修改为”, #左引号, 现产品名, #右引号, “失败！”), #标题, 16, “CP-09”)
    重画 ()
    返回 (假)
.如果真结束
赋值 (新增修改, 假) ' 修改产品型号
赋值 (型号文本, 现产品名)
赋值 (信息, “修改”)
重画 ()
返回 (真)

.子程序 _产品列表框_当前表项被改变, 空白型, , 读出产品的信息
.局部变量 被选项标题, 文本型, , , 
.局部变量 文本值, 文本型, , , 

赋值 (被选项标题, .取标题 (., ))
.如果真 (不等于 (.现行选中项, 0))
    相加 (“X类别='”, 类别选中值, “' AND X品牌='”, 品牌选中值, “' AND 型号='”, 被选项标题, “'”).未知支持库函数_47 ()
    “产品编号”.未知支持库函数_26 (文本值)
    赋值 (.内容, 文本值)
    “单位”.未知支持库函数_26 (文本值)
    文本值.选择 ()
    “质保方式”.未知支持库函数_26 (文本值)
    文本值.选择 ()
    “备注”.未知支持库函数_26 (文本值)
    赋值 (.内容, 文本值)
    “”.未知支持库函数_47 ()
.如果真结束


.子程序 _新增钮_被单击, 空白型, , 
.局部变量 新增产品名, 文本型, , , 
.局部变量 循环变量, 整数型, , , 

.如果真 (输入框 (“请输入欲新增的产品名称，在同一类型、品牌中型号不可重复！”, #标题, “新增产品”, 新增产品名, ))
    .计次循环首 (取表项数 (), 循环变量) ' 检查新增产品是否重名
        .如果真 (等于 (新增产品名, 相减 (循环变量, 1).取标题 ()))
            提示信息框 (“已有同名产品，请给产品命名一个唯一名称！”, #标题, 48)
            _新增钮_被单击 ()
            返回 ()
        .如果真结束
        
    .计次循环尾 ()
    .插入表项 (新增产品名, 图标值, , , )
    重画 ()
    .如果 (等于 (.现行选中项, 0))
        导航窗口.未知支持库函数_9 (.)
        .如果真 (取反 (未知支持库函数_17 ())) ' 写入类别
            导航窗口.未知支持库函数_11 (.)
            提示信息框 (“新增产品类别失败！”, #标题, 16, “CP-04”)
            重画 ()
            返回 ()
        .如果真结束
        .如果真 (0.未知支持库函数_20 (新增产品名)) ' 写入类别
            未知支持库函数_18 ()
            导航窗口.未知支持库函数_10 (.)
            数据到组合框 (“L类别”, “”)
            数据到组合框 (“L类别”, “”)
             ' 将新增或修改的项目加入到相应的组合框中
            重画 ()
            返回 ()
        .如果真结束
        导航窗口.未知支持库函数_11 (.)
        提示信息框 (“写入新增产品类别失败！”, #标题, 16, “CP-05”)
        返回 ()
    .否则
        .如果真 (等于 (.现行选中项, 0))
            导航窗口.未知支持库函数_9 (.)
            .如果真 (取反 (未知支持库函数_17 ())) ' 写入品牌
                导航窗口.未知支持库函数_11 (.)
                提示信息框 (“新增产品品牌失败！”, #标题, 16, “CP-06”)
                重画 ()
                返回 ()
            .如果真结束
            .如果真 (并且 (0.未知支持库函数_20 (.内容), 1.未知支持库函数_20 (新增产品名)))
                导航窗口.未知支持库函数_10 (.)
                数据到组合框 (“P品牌”, 相加 (“P类别='”, 类别选中值, “'”))
                数据到组合框 (“P品牌”, 相加 (“P类别='”, 类别选中值, “'”))
                重画 ()
                返回 ()
            .如果真结束
            导航窗口.未知支持库函数_11 (.)
            提示信息框 (“写入产品品牌失败！”, #标题, 16, “CP-07”)
            重画 ()
            返回 ()
        .如果真结束
        赋值 (新增修改, 真)
        赋值 (.内容, 自动编号 (“产品编号”, 4))
        赋值 (型号文本, 新增产品名)
        赋值 (信息, “新增”)
        连续赋值 (0, .现行选中项, .现行选中项)
    .如果结束
    
.如果真结束


.子程序 _修改钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    提示信息框 (“未选择需要修改的产品，请重新选择！”, #标题, 64)
    返回 ()
.如果真结束
.进入编辑 (.)
重画 ()

.子程序 _删除钮_被单击, 空白型, , 
.局部变量 被选项标题, 文本型, , , 
.局部变量 被选项值, 整数型, , , 
.局部变量 信息, 文本型, , , 
.局部变量 条件值, 文本型, , , 
.局部变量 操作记录集, 未知类型0x90002, , , 

.如果真 (等于 (., -1))
    提示信息框 (“未选择需要删除的产品，请重新选择！”, #标题, 64)
    返回 ()
.如果真结束
赋值 (被选项标题, .取标题 (., ))
.如果 (等于 (.现行选中项, 0)) ' 删除的是类别
    赋值 (信息, 相加 (“这将导致类别为”, #左引号, 被选项标题, #右引号, “的所有产品被删除！”))
    赋值 (条件值, 相加 (“L类别='”, 被选项标题, “'”))
    赋值 (操作记录集, )
.否则
    .如果 (等于 (.现行选中项, 0)) ' 删除的是品牌
        赋值 (信息, 相加 (“这将导致品牌为”, #左引号, 被选项标题, #右引号, “的所有产品被删除！”))
        赋值 (条件值, 相加 (“P类别='”, .内容, “' AND P品牌='”, 被选项标题, “'”))
        赋值 (操作记录集, )
    .否则
        赋值 (信息, 相加 (“这将删除型号为”, #左引号, 被选项标题, #右引号, “的产品！”))
        赋值 (条件值, 相加 (“产品编号='”, .内容, “'”))
        赋值 (操作记录集, )
    .如果结束
    
.如果结束
.如果真 (等于 (提示信息框 (相加 (信息, #换行符, #换行符, “确定要执行删除吗？”), #标题, 33), 2))
    返回 ()
.如果真结束
.如果 (条件删除数据库 (导航窗口., 操作记录集, 条件值))
    .如果真 (并且 (不等于 (.现行选中项, 0), 等于 (.现行选中项, 0))) ' 如果是删除的是品牌将另把型号表里所有的同品牌的记录也删除
        .如果真 (条件删除数据库 (导航窗口., , 相加 (“X类别='”, .内容, “' AND X品牌='”, 被选项标题, “'”)))
        .如果真结束
        
    .如果真结束
    赋值 (被选项值, .)
    .删除表项 (.)
    输出调试文本 (到文本 (被选项值))
    .如果 (等于 (.现行选中项, 0))
         ' 表示列表框中显示的都是类别
        数据到超级列表框 (“L类别”, “”, 假, 0, )
        数据到组合框 (“L类别”, “”)
        数据到组合框 (“L类别”, “”)
    .否则
        .如果 (等于 (.现行选中项, 0)) ' 表示列表框中显示的都是品牌
            数据到超级列表框 (“P品牌”, 相加 (“P类别='”, 类别选中值, “'”), 真, 1, )
            数据到组合框 (“P品牌”, 相加 (“P类别='”, 类别选中值, “'”))
            数据到组合框 (“P品牌”, 相加 (“P类别='”, 类别选中值, “'”))
            赋值 (.现行选中项, 0)
        .否则
            .如果 (等于 (取表项数 (), 0)) ' 表示列表框中已没有型号
                相加 (被选项值, 1).删除项目 ()
                赋值 (.现行选中项, 0)
            .否则
                数据到超级列表框 (“型号”, 相加 (“X类别='”, 类别选中值, “' AND X品牌='”, 品牌选中值, “'”), 真, 2, )
            .如果结束
            
        .如果结束
        
    .如果结束
    
    提示信息框 (“删除产品记录成功！”, #标题, 64)
.否则
    提示信息框 (“删除产品记录失败！”, #标题, 16, “CP- 03”)
.如果结束


.子程序 _保存钮_被单击, 空白型, , 
.局部变量 循环变量, 整数型, , , 
.局部变量 文本值, 文本型, , "6", 

.如果真 (取反 (并且 (不等于 (.现行选中项, 0), 不等于 (.现行选中项, 0))))
    提示信息框 (相加 (“无信息可保存！ 请注意：”, #换行符, #换行符, “新增或修改”, #左引号, “类别、品牌”, #右引号, “时无需保存，即改即生效！”, #换行符, #换行符, “新增或修改”, #左引号, “型号”, #右引号, “时才需保存！”), #标题, 64)
    返回 () ' 保证产品列表框中显示的是产品的型号
.如果真结束
.如果真 (或者 (取反 (附件修改), 等于 (型号文本, “”)))
    提示信息框 (相加 (“无信息可保存！ 请注意：”, #换行符, #换行符, “新增或修改”, #左引号, “类别、品牌”, #右引号, “时无需保存，即改即生效！”, #换行符, #换行符, “新增或修改”, #左引号, “型号”, #右引号, “时才需保存！”), #标题, 64)
    返回 () ' 保证产品列表框中显示的是产品的型号
.如果真结束
“”.未知支持库函数_47 ()
赋值 (文本值 [1], .内容)
赋值 (文本值 [2], .内容)
.如果 (等于 (型号文本, “”))
    赋值 (文本值 [3], .取标题 (., ))
.否则
    赋值 (文本值 [3], 型号文本)
.如果结束
赋值 (文本值 [4], .内容)
赋值 (文本值 [5], .内容)
赋值 (文本值 [6], .内容)
.如果真 (等于 (.内容, “”))
    提示信息框 (“产品编号不可空，请添入一个唯一产品编号，或用自动编号！”, #标题, 48)
    获取焦点 ()
    返回 ()
.如果真结束
导航窗口.未知支持库函数_9 (.)
.如果 (新增修改)
    .如果真 (未知支持库函数_17 ())
    .如果真结束
    
.否则
    .如果真 (取反 (相加 (“产品编号='”, .内容, “'”).未知支持库函数_45 (#)))
        导航窗口.未知支持库函数_11 (.)
        提示信息框 (相加 (信息, #左引号, 文本值 [3], #右引号, “失败！”), #标题, 16, “CP-11”)
        返回 ()
    .如果真结束
    
.如果结束
.如果真 (“产品编号”.未知支持库函数_20 (.内容))
    .计次循环首 (6, 循环变量)
        .如果真 (取反 (循环变量.未知支持库函数_20 (文本值 [循环变量])))
            导航窗口.未知支持库函数_11 (.)
            提示信息框 (相加 (信息, #左引号, 文本值 [3], #右引号, “失败！”), #标题, 16, “CP-12”)
            返回 ()
            
        .如果真结束
        
    .计次循环尾 ()
    .如果真 (导航窗口.未知支持库函数_10 (.))
        未知支持库函数_18 ()
        提示信息框 (相加 (信息, #左引号, 文本值 [3], #右引号, “成功！”), #标题, 64)
        返回 ()
    .如果真结束
    
.如果真结束
导航窗口.未知支持库函数_11 (.)
提示信息框 (相加 (信息, #左引号, 文本值 [3], #右引号, “的产品编号重复，请添入一个唯一产品编号，或用自动编号！”), #标题, 48, “CP-13”)
返回 ()

.子程序 _新增产品_被选择, 空白型, , 
_新增钮_被单击 ()

.子程序 _修改产品_被选择, 空白型, , 
_修改钮_被单击 ()

.子程序 _删除产品_被选择, 空白型, , 
_删除钮_被单击 ()

.子程序 _货品配置窗口_可否被关闭, 逻辑型, , 
.如果真 (或者 (是否已创建 (客户资料窗口), 是否已创建 (会员资料窗口)))
    赋值 (.现行子夹, 0)
    赋值 (货品配置窗口., 假)
    返回 (假)
.如果真结束
返回 (真)

.子程序 _自动编号钮_被单击, 空白型, , 
赋值 (.内容, 自动编号 (“产品编号”, 4))

.子程序 _货品配置窗口_被激活, 空白型, , 
.如果真 (取反 (显示货品))
    .如果 (是否已创建 (客户资料窗口)) ' 判断那个表格存在
        赋值 (欲加数据表格, 客户资料窗口.)
        赋值 (传递光标值, 欲加数据表格.未知支持库函数_3 ())
    .否则
        .如果真 (是否已创建 (会员资料窗口))
            赋值 (欲加数据表格, 会员资料窗口.)
            赋值 (传递光标值, 欲加数据表格.未知支持库函数_3 ())
        .如果真结束
        
    .如果结束
    
.如果真结束
重画 ()
重画 ()

.子程序 _货品配置窗口_被取消激活, 空白型, , 自动隐藏产品窗口
.如果真 (取反 (显示货品))
    .如果真 (并且 (等于 (配置项 [5], “0”), 等于 (.现行子夹, 0))) ' 是否在被取消激活自动隐藏
        赋值 (货品配置窗口., 假)
    .如果真结束
    
.如果真结束


.子程序 _单位组框_列表项被选择, 空白型, , 
赋值 (附件修改, 真) ' 判断是否修改了附件信息

.子程序 _质保组框_列表项被选择, 空白型, , 
赋值 (附件修改, 真) ' 判断是否修改了附件信息

.子程序 _备注框_内容被改变, 空白型, , 
赋值 (附件修改, 真) ' 判断是否修改了附件信息

.子程序 _打印钮_被单击, 空白型, , 
弹出菜单 ()

.子程序 _打印_被选择, 空白型, , 
未知支持库函数_26 ()

.子程序 _打印预览_被选择, 空白型, , 
未知支持库函数_27 ()

.窗口程序集 会员资料窗口程序集, , , 

.程序集变量 会资编辑框, 编辑框, , "6", 遍历窗口上所有的编辑框
.程序集变量 会资组合框, 组合框, , "3", 遍历窗口上所有的组合框
.程序集变量 会资日期框, 日期框, , "2", 遍历窗口上所有的日期框
.程序集变量 修改编号, 文本型, , , 修改记录前的会员编号
.子程序 _会员资料窗口_创建完毕, 空白型, , 
赋值 (., 到数值 (配置项 [2]))
会员表头初始化 ()
置表格显示按钮 (会员资料窗口, , )
 ' 置光标退出编辑 ()
配置文件到组合框 (“销售部门”)
配置文件到组合框 (“销售代表”)
配置文件到组合框 (“技术人员”)
清空数据 (会员资料窗口, 会资编辑框, 会资组合框, 会资日期框, , , 增减时间 (取现行时间 (), #年份, 1))
会取记录数量 ()
.如果 (新增会资)
    连续赋值 (真, .禁止, .禁止, .禁止)
    赋值 (.内容, 自动编号 (导航窗口., “会员编号”, 2))
.否则
    连续赋值 (真, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
.如果结束
显示动态窗口 (会员资料窗口, 30, 1)
获取焦点 ()

.子程序 会员表头初始化, 空白型, , 初始化表头文字、表格类型及宽度
.局部变量 列宽度, 整数型, , "7", 
.局部变量 表头标题, 文本型, , "7", 
.局部变量 列类型, 整数型, , "7", 

赋值 (列宽度, { 60, 80, 140, 38, 42, 116, 102 })
赋值 (表头标题, { “类 别”, “品  牌”, “型      号”, “单位”, “数量”, “质 保 方 式”, “备    注” })
赋值 (列类型, { 1, 1, 1, 1, 2, 1, 1 })
表格初始化 (24, 8, 列宽度, 表头标题, 列类型, 真, 真)

.子程序 _会员资料表格_按下某键, 逻辑型, , 判断加入一行表格
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

末尾加入行表格 (键代码, 真, 9)

.子程序 _会员资料表格_光标位置改变, 空白型, , 
撤表格只读方式 ()
赋值 (.可视, 假)

.子程序 _会显产品钮_被单击, 空白型, , 载入产品产品配置窗口
赋值 (显示货品, 假)
.如果 (是否已创建 (货品配置窗口))
    赋值 (货品配置窗口., 真)
    货品配置窗口.激活 ()
.否则
    载入 (货品配置窗口, _启动窗口, 假)
    置父窗口 (货品配置窗口.取窗口句柄 (), _启动窗口.取窗口句柄 (.))
.如果结束


.子程序 _取消钮_被单击, 空白型, , 
.局部变量 提示返回值, 整数型, , , 

.如果 (.禁止)
    销毁 ()
.否则
    .如果真 (取反 (判断输入内容 (假, , , “会员姓名”, , “会员电话”, , “购卡金额”)))
        赋值 (提示返回值, 提示信息框 (“当前数据未保存，是否保存数据？”, #标题, 35))
    .如果真结束
    .如果 (或者 (等于 (提示返回值, 0), 等于 (提示返回值, 7))) ' 没有数据或返回否
        会员资料窗口.销毁 ()
    .否则
        .如果 (等于 (提示返回值, 2)) ' 返回取消
            返回 ()
        .否则
            .如果 (等于 (提示返回值, 6)) ' 返回保存
                _保存钮_被单击 ()
            .否则
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 _保存钮_被单击, 空白型, , 
.如果真 (判断输入内容 (真, , , “会员卡号”, , “会员姓名”, , “购卡金额”))
    .如果 (新增会资)
        .如果真 (编号是否重复 (导航窗口., “会员编号”, 删首尾空 (.内容))) ' 判断输入的客户编号是否是唯一的编号
            .如果真 (等于 (提示信息框 (相加 (“会员编号重复，请重新输入会员的唯一编号！”, #换行符, #换行符, “是否使用系统自动编号功能？”), #标题, 49), 1))
                赋值 (.内容, 自动编号 (导航窗口., “会员编号”, 2))
            .如果真结束
            获取焦点 ()
            返回 ()
        .如果真结束
        .如果真 (取反 (并且 (导航窗口.未知支持库函数_17 (.), 导航窗口.未知支持库函数_20 (., “会员编号”, .内容))))
            提示信息框 (“新增会员记录失败！请重新启动软件后重试”, #标题, 48, “NH-05”)
            返回 ()
        .如果真结束
        .如果 (编组日框到数据库 (导航窗口., 导航窗口., 会资编辑框, 会资组合框, 会资日期框))
            .如果真 (取反 (高级表格到数据库 (导航窗口., 导航窗口., , 1, 真, .内容, “会员编号”)))
                提示信息框 (“保存会员配置资料失败！”, #标题, 16, “NH-04”)
                返回 ()
            .如果真结束
            
        .否则
            提示信息框 (“保存会员信息资料失败！”, #标题, 16, “NH-03”)
            返回 ()
        .如果结束
        清空数据 (会员资料窗口, 会资编辑框, 会资组合框, 会资日期框, , , 增减时间 (取现行时间 (), #年份, 1))
        赋值 (.内容, 自动编号 (导航窗口., “会员编号”, 2))
        会取记录数量 ()
        获取焦点 ()
    .否则
        .如果真 (不等于 (修改编号, .内容))
            .如果真 (编号是否重复 (导航窗口., “会员编号”, 删首尾空 (.内容))) ' 判断输入的会员编号是否是唯一的编号
                提示信息框 (“此会员编号已经存在，请重新输入会员的唯一编号！”, #标题, 48)
                赋值 (.内容, 修改编号)
                获取焦点 ()
                返回 ()
            .如果真结束
            
        .如果真结束
        .如果真 (条件删除数据库 (导航窗口., 导航窗口., 相加 (“会员编号='”, .内容, “'”)))
            导航窗口.未知支持库函数_17 (.)
            导航窗口.未知支持库函数_20 (., “会员编号”, .内容)
            .如果 (编组日框到数据库 (导航窗口., 导航窗口., 会资编辑框, 会资组合框, 会资日期框))
                .如果 (高级表格到数据库 (导航窗口., 导航窗口., , 1, 真, .内容, “会员编号”))
                    连续赋值 (真, .禁止, .禁止, .禁止, .禁止)
                    连续赋值 (假, .禁止, .禁止, .禁止)
                    导航窗口.未知支持库函数_16 (.)
                    导航窗口.未知支持库函数_14 (., “会员配置”, #)
                    提示信息框 (“修改会员资料信息成功！”, #标题, 64)
                    返回 ()
                .否则
                    提示信息框 (“修改会员配置资料失败！”, #标题, 16, “NH-09”)
                    返回 ()
                .如果结束
                
            .否则
                提示信息框 (“修改会员信息资料失败！”, #标题, 16, “NH-08”)
                返回 ()
            .如果结束
            
        .如果真结束
        提示信息框 (“修改失败！数据库中未搜索到需修改的会员编号！”, #标题, 16, “NH-10”)
    .如果结束
    
.如果真结束


.子程序 _前单钮_被单击, 空白型, , 
.如果真 (或者 (导航窗口.., 等于 (导航窗口.., 0)))
    提示信息框 (“已到最前一单，无信息显示！”, #标题, 64)
    返回 ()
.如果真结束
.如果真 (取反 (.禁止))
    .如果真 (取反 (判断输入内容 (假, , )))
        .如果真 (等于 (提示信息框 (“当前数据未保存，是否放弃保存？”, #标题, 65), 2))
            连续赋值 (假, .禁止, .禁止, .禁止, .禁止)
            连续赋值 (真, .禁止, .禁止, .禁止)
            返回 ()
        .如果真结束
        
    .如果真结束
    
.如果真结束
导航窗口.未知支持库函数_37 (.)
会前后显示数据 ()

.子程序 _后单钮_被单击, 空白型, , 
.如果真 (或者 (导航窗口.., 等于 (导航窗口.., 相减 (导航窗口.., 1))))
    提示信息框 (“已到最后一单，无信息显示！”, #标题, 64)
    返回 ()
.如果真结束
.如果真 (取反 (.禁止))
    .如果真 (取反 (判断输入内容 (假, , )))
        .如果真 (等于 (提示信息框 (“当前数据未保存，是否放弃保存？”, #标题, 65), 2))
            连续赋值 (假, .禁止, .禁止, .禁止, .禁止)
            连续赋值 (真, .禁止, .禁止, .禁止)
            返回 ()
        .如果真结束
        
    .如果真结束
    
.如果真结束
导航窗口.未知支持库函数_36 (.)
会前后显示数据 ()

.子程序 会前后显示数据, 空白型, , 
连续赋值 (真, .禁止, .禁止, .禁止, .禁止)
连续赋值 (假, .禁止, .禁止, .禁止)
清空数据 (会员资料窗口, 会资编辑框, 会资组合框, 会资日期框, , , )
数据库到编组日框 (导航窗口., “”, 会资编辑框, 会资组合框, 会资日期框, 假, 真, 真)
数据库到高级表格_有序 (导航窗口., , 1, 相加 (“会员编号='”, .内容, “'”), 假, 1, 0, , , , 9)

.子程序 _删除钮_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    提示信息框 (“未找到会员编号，无法确立删除对象！”, #标题, 16, “NK-06”)
    返回 ()
.如果真结束
.如果真 (等于 (提示信息框 (相加 (“删除记录后将不可再恢复，确定要删除会员编号为： ”, .内容, “ 的记录吗？”), #标题, 33), 2))
    返回 ()
.如果真结束
.如果 (条件删除数据库 (导航窗口., 导航窗口., 相加 (“会员编号='”, .内容, “'”)))
    提示信息框 (相加 (“删除会员编号为：”, .内容, “ 的记录成功！”), #标题, 64)
    会取记录数量 ()
    _前单钮_被单击 ()
.否则
    提示信息框 (相加 (“删除会员编号为：”, .内容, “ 的记录失败！”), #标题, 16, “NK-07”)
.如果结束


.子程序 _修改钮_被单击, 空白型, , 
赋值 (修改编号, .内容)
连续赋值 (假, .禁止, .禁止, .禁止, .禁止)
赋值 (新增会资, 假)
获取焦点 ()

.子程序 _新增钮_被单击, 空白型, , 
.如果真 (取反 (.禁止))
    .如果真 (取反 (判断输入内容 (假, , )))
        .如果真 (等于 (提示信息框 (“当前数据未保存，是否放弃保存？”, #标题, 65), 2))
            返回 ()
        .如果真结束
        
    .如果真结束
    
.如果真结束
连续赋值 (假, .禁止, .禁止, .禁止, .禁止)
连续赋值 (真, .禁止, .禁止, .禁止)
清空数据 (会员资料窗口, 会资编辑框, 会资组合框, 会资日期框, )
赋值 (.内容, 自动编号 (导航窗口., “会员编号”, 2))
赋值 (新增会资, 真)
获取焦点 ()

.子程序 _插入一行_被选择, 空白型, , 
.局部变量 插入行, 整数型, , , 

赋值 (插入行, 未知支持库函数_3 ())
.如果真 (大于 (插入行, 0))
    .未知支持库函数_38 (相加 (插入行, 1))
    相加 (插入行, 1).未知支持库函数_31 (.)
    .如果真 (等于 (., 10))
        6.未知支持库函数_32 (相减 (103, 17))
    .如果真结束
    
.如果真结束


.子程序 _删除此行_被选择, 空白型, , 
.如果真 (大于 (未知支持库函数_3 (), 0))
    未知支持库函数_3 ().未知支持库函数_36 ()
    .如果真 (小于 (., 9)) ' 不能将两行合一成<=
        .未知支持库函数_38 ()
        0.未知支持库函数_31 (24)
        8.未知支持库函数_31 (22)
    .如果真结束
    .如果真 (等于 (., 9))
        6.未知支持库函数_32 (102)
        0.未知支持库函数_31 (24)
    .如果真结束
    
.如果真结束


.子程序 会取记录数量, 空白型, , 
.局部变量 记录总数量, 整数型, , , 

导航窗口.未知支持库函数_47 (., “”)
导航窗口.未知支持库函数_35 (.)
赋值 (导航窗口..)
赋值 (.标题, 相加 (“ ◇共计会员记录 ”, 到文本 (), “/条”))

.子程序 _转到钮_被单击, 空白型, , 
弹出菜单 ()

.子程序 _到首记录_被选择, 空白型, , 
导航窗口.未知支持库函数_38 (., 0)
会前后显示数据 ()

.子程序 _到尾记录_被选择, 空白型, , 
导航窗口.未知支持库函数_38 (., 相减 (导航窗口.., 1))
会前后显示数据 ()

.子程序 _到指定记录_被选择, 空白型, , 
.局部变量 跳转数, 整数型, , , 
.局部变量 总数, 整数型, , , 

赋值 (总数, 导航窗口..)
.如果真 (输入框 (相加 (“请指定要转到的记录号数！ 范围： 1～”, 到文本 (总数), “ 之间”), #标题, , 跳转数, 2))
    .如果真 (或者 (小于 (跳转数, 1), 大于 (跳转数, 总数)))
        提示信息框 (“输入的记录号数超出范围，请重新输入！”, #标题, 48)
        _到指定记录_被选择 ()
        返回 ()
    .如果真结束
    导航窗口.未知支持库函数_38 (., 相减 (跳转数, 1))
    会前后显示数据 ()
.如果真结束


.子程序 _会员资料窗口_将被销毁, 空白型, , 
 ' 撤光标退出编辑 ()
导航窗口.未知支持库函数_18 (.)
导航窗口.未知支持库函数_18 (.)

.子程序 _会员资料窗口_可否被关闭, 逻辑型, , 
_取消钮_被单击 ()

.子程序 会资外部修改接口, 空白型, , 用于资料浏览时或外部窗口程序调用的接口
.参数 修改条件, 文本型, , 

数据库到编组日框 (导航窗口., 修改条件, 会资编辑框, 会资组合框, 会资日期框, 假, 假, 真)
数据库到高级表格_有序 (导航窗口., , 1, 相加 (“会员编号='”, .内容, “'”), 假, 1, 0, , , , 9)
_修改钮_被单击 ()

.子程序 _导入钮_被单击, 空白型, , 
赋值 (调用窗口, 会员资料窗口)
_客户信息超钮_被单击 ()

.子程序 _会员资料表格_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()
会员资料窗口.重画 ()
重画 ()

.子程序 _会员资料窗口_被取消激活, 空白型, , 
赋值 (.可视, 假)

.程序集 表格功能程序集, , , 将使用频繁的子程序模块化

.程序集变量 显示按钮, 按钮, , , 在表格中显示的按钮
.程序集变量 原窗口句柄, 整数型, , , 调用的窗口句柄(显示按钮)
.程序集变量 调用窗口, 窗口, , , 调用的窗口(显示按钮)
.程序集变量 调用表格, 未知类型0x80001, , , 调用的表格
.程序集变量 父句柄, 整数型, , , 结构体所在的父控件句柄
.程序集变量 光标行号, 整数型, , , 表格的光标选中行
.程序集变量 光标列号, 整数型, , , 表格的光标选中列
.程序集变量 子程序指针, 子程序指针, , , 
.子程序 置表格显示按钮, 空白型, , 在表格中显示一个按钮
.参数 父窗口, 窗口, , 调用的窗口
.参数 高级表格, 未知类型0x80001, , 调用的表格
.参数 欲显按钮, 按钮, , 显示的按钮

赋值 (调用窗口, 父窗口)
赋值 (显示按钮, 欲显按钮)
赋值 (调用表格, 高级表格)
赋值 (原窗口句柄, 置窗口信息 (高级表格.取窗口句柄 (), -4, &处理显示按钮))

.子程序 处理显示按钮, 整数型, , 子类化可以使问题简单化
.参数 句柄值, 整数型, , 
.参数 消息值, 整数型, , 
.参数 参数1, 空白型, , 
.参数 参数2, 空白型, , 

.局部变量 rect, 矩形, , , 
.局部变量 rect1, 矩形, , , 
.局部变量 rect2, 矩形, , , 

.判断开始 (等于 (消息值, 307))
    赋值 (父句柄, 参数2)
    范围矩形 (父句柄, rect)
    矩形坐标 (父句柄, rect2)
    范围矩形 (调用窗口.取窗口句柄 (), rect1)
    赋值 (光标行号, 调用表格.未知支持库函数_3 ())
    赋值 (光标列号, 调用表格.未知支持库函数_4 ())
    .如果真 (小于 (光标列号, 3))
        赋值 (显示按钮.可视, 真)
        显示按钮.移动 (相减 (rect.右边, rect1.左边, 显示按钮.宽度, 4), 相加 (相减 (rect.顶边, rect1.顶边, 调用窗口.高度), 调用窗口.取用户区高度 (), 4), 19, 相减 (rect2.底边, 2))
        显示按钮.调整层次 ()
    .如果真结束
    
.判断 (等于 (消息值, 273))
    .如果真 (或者 (不等于 (调用表格.未知支持库函数_3 (), 光标行号), 不等于 (调用表格.未知支持库函数_4 (), 光标列号)))
        显示按钮.调整层次 (2)
        赋值 (显示按钮.可视, 假)
    .如果真结束
    
.默认
    
.判断结束
返回 (传递消息到窗口 (原窗口句柄, 句柄值, 消息值, 参数1, 参数2))

.子程序 表格初始化, 空白型, , 初始化表头文字、表格单元类型及宽度,扩充后可成为一个表格模块
.参数 表格, 未知类型0x80001, , 
.参数 表头行高, 整数型, , 设置表头高度
.参数 表格行数, 整数型, , 设置表格行数
.参数 列宽, 整数型, 数组, 将数组初始化如{10,20,30,40}一个元素代表一列宽度
.参数 标题, 文本型, 数组, 将数组初始化如{“类型”,“品牌”}一个元素代表一列标题
.参数 类型, 整数型, 可空 数组, 将数组初始化如{1,1,2,3}一个元素代表一列的类型，类型值参加表格帮助,默认为文本型
.参数 保持外观, 逻辑型, 可空, 保持表格形状，不出现横向滚动条,滚动条宽17,边框宽4
.参数 行渐变色, 逻辑型, 可空, 显示斑马线
.参数 只读起始行, 整数型, 可空, 
.参数 只读终止列, 整数型, 可空, 

.局部变量 循环变量, 整数型, , , 

.如果真 (小于 (表格., 相加 (表格行数, 1))) ' 如果表格的原行数小于设置的行数
    赋值 (表格., 相加 (表格行数, 1))
.如果真结束
表格.未知支持库函数_25 (0, 0, 表格., 表格., #.) ' 所有表格内容居中
表格.未知支持库函数_31 (0, 表头行高) ' 置表头高度
.计次循环首 (取数组成员数 (列宽), 循环变量) ' 设置每列的宽度、表头、只读等
    表格.未知支持库函数_32 (相减 (循环变量, 1), 列宽 [循环变量])
    表格.未知支持库函数_9 (0, 相减 (循环变量, 1), #., 标题 [循环变量])
    .如果真 (取反 (是否为空 (类型)))
        .如果真 (小于或等于 (循环变量, 取数组成员数 (类型)))
            表格.未知支持库函数_30 (相减 (循环变量, 1), 类型 [循环变量])
        .如果真结束
        
    .如果真结束
    .如果真 (是否为空 (只读起始行)) ' 设置2行开始只读
        赋值 (只读起始行, 2)
    .如果真结束
    .如果真 (是否为空 (只读终止列))
        赋值 (只读终止列, 表格.)
    .如果真结束
    表格.未知支持库函数_53 (只读起始行, 0, 表格., 只读终止列, 真)
.计次循环尾 ()
.如果真 (行渐变色) ' 显示斑马线
    表格.未知支持库函数_14 (#., #白色, 15200231)
.如果真结束
.如果真 (并且 (保持外观, 大于 (相加 (相乘 (相减 (表格., 1), 表格.), 4, 表头行高), 表格.))) ' 判断是否出现滚动条
    表格.未知支持库函数_32 (相减 (表格., 1), 相减 (表格.未知支持库函数_44 (相减 (表格., 1)), 17)) ' 将最后一列宽度减17
.如果真结束


.子程序 数据库到高级表格_有序, 整数型, , 读取有规律字段到表格,返回读取记录条数
.参数 记录集, 未知类型0x90002, , 
.参数 表格, 未知类型0x80001, , 
.参数 开始字段, 整数型, , 从那个字段开始
.参数 过滤条件, 文本型, , 不过滤用“”
.参数 保持过滤状态, 逻辑型, , 真为保持
.参数 清空起始行, 整数型, 可空, 
.参数 清空起始列, 整数型, 可空, 
.参数 说明标签, 标签, 可空, 
.参数 日期字段, 整数型, 可空 数组, 读取字段中的日期字段
.参数 日期列, 整数型, 可空 数组, 表格中显示日期的列
.参数 表格原行数, 整数型, 可空, 表格原有行数(保持外观用)

.局部变量 行数变量, 整数型, , , 控制行数
.局部变量 列数变量, 整数型, , , 控制列数
.局部变量 字段数, 整数型, , , 表的总字段数
.局部变量 文本值, 文本型, , , 存放读出的文本数据
.局部变量 日期值, 日期时间型, , , 存放读出的日期数据

记录集.未知支持库函数_47 (“”)
记录集.未知支持库函数_47 (过滤条件)
记录集.未知支持库函数_34 ()
.如果真 (取反 (并且 (是否为空 (清空起始行), 是否为空 (清空起始列)))) ' 先情况数据
    表格.未知支持库函数_62 (清空起始行, 清空起始列, 表格., 表格.)
.如果真结束
赋值 (字段数, 相减 (记录集., 开始字段)) ' 从那个字段开始读
.如果真 (大于 (记录集., 100)) ' 资料超过100条时显示等待信息
    载入 (等待窗口, _启动窗口, 假)
    赋值 (等待窗口..标题, “资料载入中  > > > > > ”)
.如果真结束
.判断循环首 (等于 (记录集., 假))
    处理事件 ()
    赋值 (行数变量, 相加 (行数变量, 1))
    .如果真 (大于 (行数变量, 相减 (表格., 1))) ' 如果超出表格行数就插入一行
        表格.未知支持库函数_38 ()
        表格.未知支持库函数_31 (行数变量, 表格.) ' 置新行统一高度
        .如果真 (等于 (相减 (表格., 1), 表格原行数))
            表格.未知支持库函数_32 (相减 (表格., 1), 相减 (表格.未知支持库函数_44 (相减 (表格., 1)), 17)) ' 不出现滚动条
        .如果真结束
        
    .如果真结束
    .计次循环首 (字段数, 列数变量)
        记录集.未知支持库函数_26 (相减 (相加 (列数变量, 开始字段), 1), 文本值)
        表格.未知支持库函数_9 (行数变量, 相减 (列数变量, 1), #., 文本值)
    .计次循环尾 ()
    .如果真 (取反 (是否为空 (日期字段))) ' 读日期字段
        .计次循环首 (取数组成员数 (日期字段), 列数变量)
            记录集.未知支持库函数_31 (日期字段 [列数变量], 日期值)
            表格.未知支持库函数_9 (行数变量, 日期列 [列数变量], #., 时间到文本 (日期值, 2))
        .计次循环尾 ()
    .如果真结束
    记录集.未知支持库函数_36 ()
.判断循环尾 ()
.如果真 (取反 (是否为空 (说明标签)))
    赋值 (说明标签.标题, 相加 (“ ◇共计 ”, 到文本 (行数变量), “/条 记录”))
.如果真结束
.如果真 (取反 (保持过滤状态))
    记录集.未知支持库函数_47 (“”)
.如果真结束
.如果真 (是否已创建 (等待窗口))
    等待窗口.销毁 ()
.如果真结束
返回 (行数变量)

.子程序 数据库到高级表格_无序, 整数型, , 读取没有规律字段到表格,返回读取记录条数
.参数 记录集, 未知类型0x90002, , 
.参数 表格, 未知类型0x80001, , 
.参数 过滤条件, 文本型, , 不过滤用“”，过滤当天用取现行时间
.参数 字段数组, 整数型, 数组, 欲读的字段例如{1,3,2,7,6},一个元素表示一个字段号
.参数 信息签, 标签, , 显示信息标签
.参数 表格原行数, 整数型, , 表格原有行数(保持外观用)
.参数 字段日期值, 整数型, 可空, 欲读字段中的日期字段
.参数 表格日期列, 整数型, 可空, 表格中有日期列的列数
.参数 字段逻辑值, 整数型, 可空, 欲读字段中的逻辑字段
.参数 表格逻辑列, 整数型, 可空, 表格中有逻辑列的列数

.局部变量 行数变量, 整数型, , , 控制行数
.局部变量 列数变量, 整数型, , , 控制列数
.局部变量 文本值, 文本型, , , 存放读出的文本数据
.局部变量 日期值, 日期时间型, , , 存放读出的日期数据
.局部变量 逻辑值, 逻辑型, , , 存放读出的逻辑数据

记录集.未知支持库函数_47 (“”)
记录集.未知支持库函数_47 (过滤条件)
记录集.未知支持库函数_34 ()
.如果真 (大于 (记录集., 100)) ' 资料超过100条时显示等待信息
    载入 (等待窗口, _启动窗口, 假)
    赋值 (等待窗口..标题, “资料载入中  > > > > > ”)
.如果真结束
.计次循环首 (记录集., 行数变量)
    处理事件 ()
    .如果真 (大于 (行数变量, 相减 (表格., 1))) ' 同上
        表格.未知支持库函数_38 ()
        .如果真 (等于 (相减 (表格., 1), 表格原行数))
            表格.未知支持库函数_32 (相减 (表格., 1), 相减 (表格.未知支持库函数_44 (相减 (表格., 1)), 17))
        .如果真结束
        
    .如果真结束
    .计次循环首 (取数组成员数 (字段数组), 列数变量)
        .判断开始 (等于 (列数变量, 字段日期值))
            记录集.未知支持库函数_31 (字段数组 [列数变量], 日期值)
            表格.未知支持库函数_9 (行数变量, 表格日期列, #., 时间到文本 (日期值, 2))
        .判断 (等于 (列数变量, 字段逻辑值))
            记录集.未知支持库函数_30 (字段数组 [列数变量], 逻辑值)
            表格.未知支持库函数_9 (行数变量, 表格逻辑列, #., 逻辑值)
        .默认
            记录集.未知支持库函数_26 (字段数组 [列数变量], 文本值)
            表格.未知支持库函数_9 (行数变量, 相减 (列数变量, 1), #., 文本值)
        .判断结束
        
    .计次循环尾 ()
    记录集.未知支持库函数_36 ()
.计次循环尾 ()
赋值 (信息签.标题, 相加 (“ ◇共计 ”, 到文本 (相减 (行数变量, 1)), “/记录”))
.如果真 (是否已创建 (等待窗口))
    等待窗口.销毁 ()
.如果真结束
返回 (相减 (行数变量, 1))

.子程序 末尾加入行表格, 空白型, , 如果是下光标 且 是最后一行 且 最后一行有数据就再插入一行,在按下某键事件中调用
.参数 表格, 未知类型0x80001, , 
.参数 按键, 整数型, , 参数为键代码
.参数 保持外观, 逻辑型, , 保持表格形状，不出现横向滚动条
.参数 原行数, 整数型, 可空, 

.局部变量 原光标列数, 整数型, , , 

.如果真 (并且 (等于 (按键, #下光标键), 等于 (表格.未知支持库函数_3 (), 相减 (表格., 1)), 不等于 (到文本 (表格.未知支持库函数_10 (相减 (表格., 1), 0)), “”)))
    赋值 (原光标列数, 表格.未知支持库函数_4 ())
    表格.未知支持库函数_38 ()
    表格.未知支持库函数_53 (1, 0, 表格.未知支持库函数_3 (), 表格., 假)
    表格.未知支持库函数_0 (相减 (表格., 1), 原光标列数)
    .如果真 (并且 (保持外观, 等于 (表格., 相加 (原行数, 1)))) ' 不出现横向滚动条
        表格.未知支持库函数_32 (相减 (表格., 1), 相减 (表格.未知支持库函数_44 (相减 (表格., 1)), 17))
    .如果真结束
    
.如果真结束


.子程序 撤表格只读方式, 空白型, , 在表格的前一行如果有数据，就撤销下一行的只读方式
.参数 表格, 未知类型0x80001, , 

.如果真 (并且 (大于 (表格.未知支持库函数_3 (), 1), 不等于 (到文本 (表格.未知支持库函数_10 (相减 (表格.未知支持库函数_3 (), 1), 0)), “”)))
     ' 根据条件撤销下一行的只读方式
    表格.未知支持库函数_53 (1, 0, 表格.未知支持库函数_3 (), 表格., 假)
.如果真结束
.如果真 (并且 (不等于 (到文本 (表格.未知支持库函数_10 (表格.未知支持库函数_3 (), 0)), “”), 不等于 (到文本 (表格.未知支持库函数_10 (表格.未知支持库函数_3 (), 0)), “假”)))
     ' 为添加了数据的行自动加上"数量"列为1
    .如果真 (等于 (到文本 (表格.未知支持库函数_10 (表格.未知支持库函数_3 (), 4)), “”))
        表格.未知支持库函数_9 (表格.未知支持库函数_3 (), 4, #., 1)
        返回 ()
    .如果真结束
    
.如果真结束


.子程序 判断输入内容, 逻辑型, , 检查是否有没输入的项目
.参数 保存或退出, 逻辑型, , 保存时检查为真，退出时检查为假
.参数 欲检查表格, 未知类型0x80001, 可空, 取第一行的前3列是否有数据
.参数 欲检查控件1, 编辑框, 可空, 编号框
.参数 控件1信息, 文本型, 可空, 
.参数 欲检查控件2, 编辑框, 可空, 姓名框
.参数 控件2信息, 文本型, 可空, 
.参数 欲检查控件3, 编辑框, 可空, 购买金额框
.参数 控件3信息, 文本型, 可空, 

.局部变量 循环变量, 整数型, , , 

.如果真 (取反 (是否为空 (欲检查控件1)))
    .如果 (保存或退出)
        .如果真 (等于 (欲检查控件1.内容, “”))
            提示信息框 (相加 (“未输入”, 控件1信息, “，请添入一个”, 控件1信息, “！”), #标题, 33)
            欲检查控件1.获取焦点 ()
            返回 (假)
        .如果真结束
        
    .否则
        .如果真 (不等于 (欲检查控件1.内容, “”))
            返回 (假)
        .如果真结束
        
    .如果结束
    
.如果真结束
.如果真 (取反 (是否为空 (欲检查控件2)))
    .如果 (保存或退出)
        .如果真 (等于 (欲检查控件2.内容, “”))
            .如果真 (等于 (提示信息框 (相加 (“未输入”, 控件2信息, “，如果客户未留”, 控件2信息, “，可由系统生成一个”, 控件2信息, “！”), #标题, 33), 2))
                欲检查控件2.获取焦点 ()
                返回 (假)
            .如果真结束
            赋值 (欲检查控件2.内容, “未留名”)
        .如果真结束
        
    .否则
        .如果真 (不等于 (欲检查控件2.内容, “”))
            返回 (假)
        .如果真结束
        
    .如果结束
    
.如果真结束
.如果真 (取反 (是否为空 (欲检查控件3)))
    .如果 (保存或退出)
        .如果真 (等于 (欲检查控件3.内容, “”))
            .如果真 (等于 (提示信息框 (相加 (“未输入”, 控件3信息, “，如果想为空，请点”, #左引号, “确定”, #右引号, “按钮即可！”), #标题, 33), 2))
                欲检查控件3.获取焦点 ()
                返回 (假)
            .如果真结束
            
        .如果真结束
        
    .否则
        .如果真 (不等于 (欲检查控件3.内容, “”))
            返回 (假)
        .如果真结束
        
    .如果结束
    
.如果真结束
.如果真 (取反 (是否为空 (欲检查表格)))
    .如果 (保存或退出)
        .如果真 (等于 (欲检查表格.未知支持库函数_10 (1, 0), “”))
            .如果真 (等于 (提示信息框 (相加 (“未输入任何配置，如果不需要配置请点”, #左引号, “确定”, #右引号, “按钮执行保存！”), #标题, 33), 2))
                返回 (假)
            .如果真结束
            
        .如果真结束
        
    .否则
        .如果真 (不等于 (欲检查表格.未知支持库函数_10 (1, 0), “”))
            返回 (假)
        .如果真结束
        
    .如果结束
    
.如果真结束
返回 (真)

.子程序 置光标退出编辑, 空白型, , 在窗口创建完毕事件中调用
赋值 (子程序指针, 置窗口指针 (调用表格.取窗口句柄 (), -4, &处理光标退出编辑))

.子程序 撤光标退出编辑, 空白型, , 在窗口将要事件销毁中调用
置窗口指针 (调用表格.取窗口句柄 (), -4, 子程序指针)

.子程序 处理光标退出编辑, 整数型, , 用光标键退出表格的编辑状态
.参数 句柄, 整数型, , 
.参数 消息, 整数型, , 
.参数 参数1, 整数型, , 
.参数 参数2, 整数型, , 

.判断开始 (等于 (消息, 307))
    赋值 (父句柄, 参数2)
    赋值 (_启动窗口..时钟周期, 10)
.默认
    
.判断结束
返回 (传递指针到窗口 (子程序指针, 句柄, 消息, 参数1, 参数2))

.子程序 表格编辑时钟事件, 空白型, , 在时钟周期事件中调用
.如果真 (不等于 (有效句柄 (父句柄), 0))
    .判断开始 (等于 (指定虚拟键 (#下光标键), -32768))
        发送消息 (父句柄, 16, 0, 0)
        赋值 (光标行号, 调用表格.未知支持库函数_3 ())
        赋值 (光标列号, 调用表格.未知支持库函数_4 ())
        .如果真 (并且 (等于 (调用表格.未知支持库函数_3 (), 相减 (调用表格., 1)), 不等于 (调用表格.未知支持库函数_10 (调用表格.未知支持库函数_3 (), 调用表格.未知支持库函数_4 ()), “”)))
            调用表格.未知支持库函数_38 ()
            调用表格.未知支持库函数_0 (相加 (光标行号, 1), 光标列号)
        .如果真结束
        .如果真 (不等于 (调用表格.未知支持库函数_10 (调用表格.未知支持库函数_3 (), 调用表格.未知支持库函数_4 ()), “”))
            调用表格.未知支持库函数_53 (1, 0, 调用表格.未知支持库函数_3 (), 调用表格., 假)
        .如果真结束
        赋值 (_启动窗口..时钟周期, 0)
    .判断 (等于 (指定虚拟键 (#上光标键), -32768))
        发送消息 (父句柄, 16, 0, 0)
        调用表格.未知支持库函数_0 (相减 (调用表格.未知支持库函数_3 (), 1), 调用表格.未知支持库函数_4 ())
        赋值 (_启动窗口..时钟周期, 0)
    .判断 (等于 (指定虚拟键 (#左光标键), -32768))
        发送消息 (父句柄, 16, 0, 0)
        调用表格.未知支持库函数_0 (调用表格.未知支持库函数_3 (), 相减 (调用表格.未知支持库函数_4 (), 1))
        赋值 (_启动窗口..时钟周期, 0)
    .判断 (等于 (指定虚拟键 (#右光标键), -32768))
        发送消息 (父句柄, 16, 0, 0)
        调用表格.未知支持库函数_0 (调用表格.未知支持库函数_3 (), 相加 (调用表格.未知支持库函数_4 (), 1))
        赋值 (_启动窗口..时钟周期, 0)
    .默认
        
    .判断结束
    返回 ()
.如果真结束
赋值 (_启动窗口..时钟周期, 0)

.子程序 高级表格到数据库, 逻辑型, , 
.参数 数据库连接, 未知类型0x90001, , 
.参数 记录集, 未知类型0x90002, , 
.参数 表格, 未知类型0x80001, , 
.参数 初始字段, 整数型, , 0为0字段，1为1字段类推
.参数 是否附加数据, 逻辑型, , 在将表格数据写入前添加附加数据
.参数 附加写入数据, 文本型, 可空, 欲写入的附加数据,例如编辑框的内容
.参数 附加数据字段, 文本型, , 欲写到数据库的字段

.局部变量 列数变量, 整数型, , , 横向遍历
.局部变量 行数变量, 整数型, , , 纵向遍历

赋值 (行数变量, 1) ' 将表头去掉，所有初值为1
数据库连接.未知支持库函数_9 () ' 设置事务提高数据库安全
.判断循环首 (并且 (不等于 (到文本 (表格.未知支持库函数_10 (行数变量, 0)), “”), 小于 (行数变量, 表格.)))
    .如果 (记录集.未知支持库函数_17 ())
        .如果真 (是否附加数据) ' 附件写入数据库的数据，如客户编号
            .如果真 (取反 (记录集.未知支持库函数_20 (附加数据字段, 附加写入数据)))
                数据库连接.未知支持库函数_11 ()
                返回 (假)
            .如果真结束
            
        .如果真结束
        .计次循环首 (表格., 列数变量)
            .如果真 (取反 (记录集.未知支持库函数_20 (相加 (相减 (列数变量, 1), 初始字段), 到文本 (表格.未知支持库函数_10 (行数变量, 相减 (列数变量, 1))))))
                数据库连接.未知支持库函数_11 ()
                返回 (假)
            .如果真结束
            
        .计次循环尾 ()
        记录集.未知支持库函数_18 ()
    .否则
        数据库连接.未知支持库函数_11 ()
        返回 (假)
    .如果结束
    赋值 (行数变量, 相加 (行数变量, 1))
.判断循环尾 ()
.如果真 (数据库连接.未知支持库函数_10 ())
    记录集.未知支持库函数_47 (“”)
    返回 (真)
.如果真结束
数据库连接.未知支持库函数_11 ()
返回 (假)

.窗口程序集 资料浏览窗口程序集, , , 

.程序集变量 配套记录集, 未知类型0x90002, , , 和资料记录集配套的配置记录集
.程序集变量 日期字段, 整数型, , "0", 
.子程序 _资料浏览窗口_创建完毕, 空白型, , 
赋值 (.今天, 增减时间 (取现行时间 (), #日, 相加 (负 (取日 (取现行时间 ())), 1))) ' 日期初始化到每月1号
配置表头初始化 ()
.判断开始 (等于 (调用记录集, 导航窗口.))
    赋值 (配套记录集, 导航窗口.)
    重定义数组 (日期字段, 假, 1)
    赋值 (日期字段, { 10 })
    连续赋值 (取反 (权限 [8]), .禁止, .禁止) ' 取是否具有修改删除的权限
    浏览资料表头初始化 ({ 75, 70, 80, 80, 150, 65, 100, 80, 70, 70, 110 })
.判断 (等于 (调用记录集, 导航窗口.))
    赋值 (配套记录集, 导航窗口.)
    重定义数组 (日期字段, 假, 2)
    赋值 (日期字段, { 9, 10 })
    连续赋值 (取反 (权限 [11]), .禁止, .禁止) ' 取是否具有修改删除的权限
    浏览资料表头初始化 ({ 75, 70, 80, 80, 150, 65, 90, 70, 70, 110, 110 })
.判断 (等于 (调用记录集, 导航窗口.))
    重定义数组 (日期字段, 假, 3)
    赋值 (日期字段, { 12, 13, 14 })
    连续赋值 (取反 (权限 [14]), .禁止, .禁止) ' 取是否具有修改删除的权限
    浏览资料表头初始化 ({ 75, 75, 70, 80, 80, 150, 100, 60, 150, 80, 70, 100, 90, 90, 90, 70, 70, 40 })
    连续赋值 (真, ., .)
    _显配钮_被单击 ()
.默认
    
.判断结束
显示动态窗口 (资料浏览窗口, 30, 1)
赋值 (., 到数值 (配置项 [2]))

.子程序 浏览资料表头初始化, 空白型, , 
.参数 列宽, 整数型, 数组, 

.局部变量 表头标题, 文本型, , "0", 
.局部变量 循环变量, 整数型, , , 

清除数组 (表头标题)
.计次循环首 (调用记录集., 循环变量)
    加入成员 (表头标题, 调用记录集.未知支持库函数_39 (相减 (循环变量, 1)))
.计次循环尾 ()
赋值 (., 调用记录集.)
表格初始化 (24, 调用记录集., 列宽, 表头标题, , 假, 真)

.子程序 配置表头初始化, 空白型, , 
.局部变量 列宽度, 整数型, , "7", 
.局部变量 表头标题, 文本型, , "7", 

赋值 (列宽度, { 80, 80, 170, 55, 55, 120, 132 })
赋值 (表头标题, { “类 别”, “品  牌”, “型      号”, “单位”, “数量”, “质 保 方 式”, “备    注” })
表格初始化 (24, 4, 列宽度, 表头标题, , 真, 真, 1, 6)

.子程序 _显配钮_被单击, 空白型, , 
.判断开始 (.)
    赋值 (., 323)
    赋值 (., “↑”)
    赋值 (., 假)
    赋值 (., 305)
    重画 ()
.默认
    赋值 (., 187)
    赋值 (., “↓”)
    赋值 (., 170)
    赋值 (., 真)
.判断结束
连续赋值 (., .顶边, .顶边)

.子程序 _过滤钮_被单击, 空白型, , 
.局部变量 条件日期, 文本型, , , 过滤的字段
.局部变量 条件文本, 文本型, , , 

赋值 (条件日期, “购买日期”)
.如果真 (小于 (.今天, .今天)) ' 时间不能置反
    提示信息框 (“终止日期不可小于起始时间，请重新设定过滤时间！”, #标题, 64)
    赋值 (.今天, 取现行时间 ())
    返回 ()
.如果真结束
.如果真 (等于 (调用记录集, 导航窗口.))
    赋值 (条件日期, “维修日期”)
.如果真结束
赋值 (条件文本, 相加 (条件日期, “>=”, 时间到文本 (.今天, 2), “ AND ”, 条件日期, “<=”, 时间到文本 (.今天, 2)))
调用记录集.未知支持库函数_47 (“”)
数据库到高级表格_有序 (调用记录集, , 0, 条件文本, 真, 1, 0, , 日期字段, 日期字段)

.子程序 _资料浏览表格_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 被选文本, 文本型, , , 
.局部变量 过滤字段名, 文本型, , , 取表格的0行0列，一般为资料单号

赋值 (被选文本, 未知支持库函数_3 ().未知支持库函数_10 (0))
赋值 (过滤字段名, 0.未知支持库函数_10 (0))
.如果真 (并且 (不等于 (被选文本, “”), 不等于 (过滤字段名, “”), 不等于 (调用记录集, 导航窗口.)))
    数据库到高级表格_有序 (配套记录集, , 1, 相加 (过滤字段名, “='”, 被选文本, “'”), 假, 1, 0, , , , 6)
.如果真结束


.子程序 _取消钮_被单击, 空白型, , 
销毁 ()

.子程序 _修改钮_被单击, 空白型, , 
.局部变量 欲修改编号, 文本型, , , 
.局部变量 所在字段, 文本型, , , 

赋值 (欲修改编号, 到文本 (未知支持库函数_3 ().未知支持库函数_10 (0)))
赋值 (所在字段, 0.未知支持库函数_10 (0))
.如果真 (或者 (等于 (欲修改编号, “”), 等于 (欲修改编号, “假”), 等于 (所在字段, “”)))
    提示信息框 (“未找到需修改的记录，请重新选择！”, #标题, 48)
    返回 ()
.如果真结束
.判断开始 (等于 (调用记录集, 导航窗口.))
    赋值 (新增客资, 假)
    .如果真 (取反 (是否已创建 (客户资料窗口)))
        载入窗口 (客户资料窗口)
    .如果真结束
    客资外部修改接口 (相加 (所在字段, “='”, 欲修改编号, “'”))
    客户资料窗口.激活 ()
.判断 (等于 (调用记录集, 导航窗口.))
    赋值 (新增会资, 假)
    .如果真 (取反 (是否已创建 (会员资料窗口)))
        载入窗口 (会员资料窗口)
    .如果真结束
    会资外部修改接口 (相加 (所在字段, “='”, 欲修改编号, “'”))
.判断 (等于 (调用记录集, 导航窗口.))
    赋值 (新增维修, 假)
    .如果真 (取反 (是否已创建 (维修登记窗口)))
        载入窗口 (维修登记窗口)
    .如果真结束
    维修外部修改接口 (相加 (所在字段, “='”, 欲修改编号, “'”))
.默认
    
.判断结束


.子程序 _删除钮_被单击, 空白型, , 
.局部变量 欲删除编号, 文本型, , , 
.局部变量 所在字段, 文本型, , , 

赋值 (欲删除编号, 到文本 (未知支持库函数_3 ().未知支持库函数_10 (0)))
赋值 (所在字段, 0.未知支持库函数_10 (0))
.如果真 (或者 (等于 (欲删除编号, “”), 等于 (欲删除编号, “假”), 等于 (所在字段, “”)))
    提示信息框 (“未找到需删除的记录，请重新选择！”, #标题, 48)
    返回 ()
.如果真结束
.如果真 (等于 (提示信息框 (相加 (“删除记录后将不可再恢复，确定要删除编号为： ”, 欲删除编号, “ 的记录吗？”), #标题, 33), 2))
    返回 ()
.如果真结束
.如果 (条件删除数据库 (导航窗口., 调用记录集, 相加 (所在字段, “='”, 欲删除编号, “'”)))
    提示信息框 (相加 (“删除编号为：”, 欲删除编号, “ 的记录成功！”), #标题, 64)
    未知支持库函数_3 ().未知支持库函数_36 ()
.否则
    提示信息框 (相加 (“删除编号为：”, 欲删除编号, “ 的记录失败！”), #标题, 16, “ZL-02”)
.如果结束


.子程序 _高查钮_被单击, 空白型, , 
.如果真 (是否已创建 (条件查询窗口))
    条件查询窗口.销毁 ()
.如果真结束
载入窗口 (条件查询窗口)

.子程序 _资料浏览表格_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _修改资料_被选择, 空白型, , 
_修改钮_被单击 ()

.子程序 _删除资料_被选择, 空白型, , 
_删除钮_被单击 ()

.子程序 _高级查询_被选择, 空白型, , 
_高查钮_被单击 ()

.子程序 _退出_被选择, 空白型, , 
_取消钮_被单击 ()

.子程序 _打印钮_被单击, 空白型, , 
弹出菜单 ()

.子程序 _打印资料_被选择, 空白型, , 
未知支持库函数_26 ()

.子程序 _打印预览_被选择, 空白型, , 
未知支持库函数_27 ()

.子程序 _起始日框_选择日期被改变, 空白型, , 
资料浏览窗口.重画 ()
重画 ()

.子程序 _终止日框_选择日期被改变, 空白型, , 
_起始日框_选择日期被改变 ()

.窗口程序集 维修登记窗口程序集, , , 

.程序集变量 维修编辑框, 编辑框, , "8", 
.程序集变量 维修组合框, 组合框, , "4", 
.程序集变量 维修日期框, 日期框, , "3", 
.程序集变量 修改编号, 文本型, , , 修改记录前的维修编号
.子程序 _维修登记窗口_创建完毕, 空白型, , 
配置文件到组合框 (“报修故障”)
配置文件到组合框 (“维修时间”)
配置文件到组合框 (“维修类型”)
配置文件到组合框 (“服务方式”)
清空数据 (维修登记窗口, 维修编辑框, 维修组合框, 维修日期框, , , 增减时间 (取现行时间 (), #日, 1))
赋值 (.内容, “”)
维取记录数量 ()
.如果 (新增维修)
    获取焦点 ()
    赋值 (.内容, 自动编号 (导航窗口., “维修单号”, 3))
    数据库到高级表格_无序 (导航窗口., , 相加 (“报修日期=”, 时间到文本 (取现行时间 (), 2)), { 0, 2, 3, 5, 13, 10, 11 }, , 6, 5, 4)
    连续赋值 (真, .禁止, .禁止, .禁止)
    赋值 (.禁止, 假)
.否则
    连续赋值 (真, ., .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
.如果结束
报修表头初始化 ()
显示动态窗口 (维修登记窗口, 30, 1)
赋值 (., 到数值 (配置项 [2]))

.子程序 报修表头初始化, 空白型, , 
.局部变量 列宽度, 整数型, , "7", 
.局部变量 表头标题, 文本型, , "7", 

赋值 (列宽度, { 0, 58, 82, 190, 90, 70, 114 })
赋值 (表头标题, { “维修单号”, “姓 名”, “电  话”, “地      址”, “维修日期”, “维修类型”, “服务方式” })
表格初始化 (24, 导航窗口.., 列宽度, 表头标题, , 真, 真)

.子程序 _保存钮_被单击, 空白型, , 
.如果真 (判断输入内容 (真, , , “维修单号”, , “客户姓名”, , “客户电话”))
    .如果 (新增维修)
        .如果真 (编号是否重复 (导航窗口., “维修单号”, 删首尾空 (.内容))) ' 判断输入的维修编号是否是唯一的编号
            .如果真 (等于 (提示信息框 (相加 (“维修单号重复，请重新输入唯一的维修单号！”, #换行符, #换行符, “是否使用系统自动编号功能？”), #标题, 49), 1))
                赋值 (.内容, 自动编号 (导航窗口., “维修单号”, 3))
            .如果真结束
            获取焦点 ()
            返回 ()
        .如果真结束
        .如果真 (取反 (并且 (导航窗口.未知支持库函数_17 (.), 导航窗口.未知支持库函数_20 (., “维修单号”, .内容))))
            提示信息框 (“登记维修失败！请重新启动软件后重试！”, #标题, 48, “UB-01”)
            返回 ()
        .如果真结束
        .如果真 (取反 (编组日框到数据库 (导航窗口., 导航窗口., 维修编辑框, 维修组合框, 维修日期框)))
            提示信息框 (“保存客户报修信息资料失败！”, #标题, 16, “UB-02”)
            返回 ()
        .如果真结束
        清空数据 (维修登记窗口, 维修编辑框, 维修组合框, 维修日期框, , , 增减时间 (取现行时间 (), #日, 1))
        数据库到高级表格_无序 (导航窗口., , 相加 (“报修日期=”, 时间到文本 (取现行时间 (), 2)), { 0, 2, 3, 5, 13, 10, 11 }, , 6, 5, 4)
        赋值 (.内容, 自动编号 (导航窗口., “维修单号”, 3))
        获取焦点 ()
        维取记录数量 ()
        赋值 (.内容, “”)
    .否则
        .如果真 (不等于 (修改编号, .内容))
            .如果真 (编号是否重复 (导航窗口., “维修单号”, 删首尾空 (.内容))) ' 判断输入的客户编号是否是唯一的编号
                提示信息框 (“此维修单号已经存在，请重新输入唯一编号！”, #标题, 48)
                赋值 (.内容, 修改编号)
                获取焦点 ()
                返回 ()
            .如果真结束
            
        .如果真结束
        .如果真 (取反 (导航窗口.未知支持库函数_45 (., 相加 (“维修单号='”, 修改编号, “'”), #)))
            提示信息框 (“未查找到需修改的客户报修记录，请重启软件后重试！”, #标题, 16, “UB-03”)
            返回 ()
        .如果真结束
        导航窗口.未知支持库函数_20 (., “维修单号”, .内容)
        .如果 (编组日框到数据库 (导航窗口., 导航窗口., 维修编辑框, 维修组合框, 维修日期框))
            1.未知支持库函数_62 (0, ., .)
            数据库到高级表格_无序 (导航窗口., , 相加 (“报修日期=”, 时间到文本 (取现行时间 (), 2)), { 0, 2, 3, 5, 13, 10, 11 }, , 6, 5, 4)
            连续赋值 (假, .禁止, .禁止, .禁止)
            连续赋值 (真, .禁止, .禁止)
            提示信息框 (“修改客户报修记录成功！”, #标题, 64)
        .否则
            提示信息框 (“修改客户报修记录失败！”, #标题, 16, “UB-03”)
        .如果结束
        
    .如果结束
    
.如果真结束


.子程序 _前单钮_被单击, 空白型, , 
.如果 (大于 (未知支持库函数_3 (), 1))
    相减 (未知支持库函数_3 (), 1).未知支持库函数_0 (3)
    显示单据 (未知支持库函数_3 ())
    未知支持库函数_3 ().未知支持库函数_1 (1, 未知支持库函数_3 (), 相减 (., 1))
.否则
    提示信息框 (“已到最前一单，无信息显示！”, #标题, 64)
.如果结束


.子程序 _后单钮_被单击, 空白型, , 
.如果 (小于 (未知支持库函数_3 (), 相减 (., 1)))
    相加 (未知支持库函数_3 (), 1).未知支持库函数_0 (3)
    显示单据 (未知支持库函数_3 ())
    未知支持库函数_3 ().未知支持库函数_1 (1, 未知支持库函数_3 (), 相减 (., 1))
.否则
    提示信息框 (“已到最后一单，无信息显示！”, #标题, 64)
.如果结束


.子程序 _报修登记表格_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

显示单据 (未知支持库函数_3 ())

.子程序 显示单据, 空白型, , 
.参数 光标行, 整数型, , 

.局部变量 查找单号, 文本型, , , 

赋值 (查找单号, 光标行.未知支持库函数_10 (0))
.如果真 (等于 (查找单号, “”))
    返回 ()
.如果真结束
.如果真 (等于 (.禁止, 假))
    .如果真 (取反 (判断输入内容 (假, , , “客户姓名”, , “客户电话”)))
        .如果真 (等于 (提示信息框 (“当前数据未保存，是否放弃保存？”, #标题, 65), 2))
            返回 ()
        .如果真结束
        
    .如果真结束
    
.如果真结束
数据库到编组日框 (导航窗口., 相加 (“维修单号='”, 查找单号, “'”), 维修编辑框, 维修组合框, 维修日期框, 真)
维修次数提示 ()
连续赋值 (假, .禁止, .禁止, .禁止)
连续赋值 (真, .禁止, .禁止)

.子程序 _新增钮_被单击, 空白型, , 
.如果真 (等于 (.禁止, 假))
    .如果真 (取反 (判断输入内容 (假, , , “客户姓名”, , “客户电话”)))
        .如果真 (等于 (提示信息框 (“当前数据未保存，是否放弃保存？”, #标题, 65), 2))
            返回 ()
        .如果真结束
        
    .如果真结束
    
.如果真结束
赋值 (新增维修, 真)
清空数据 (维修登记窗口, 维修编辑框, 维修组合框, 维修日期框, , , 增减时间 (取现行时间 (), #日, 1))
赋值 (.内容, 自动编号 (导航窗口., “维修单号”, 3))
连续赋值 (真, .禁止, .禁止, .禁止)
连续赋值 (假, .禁止, .禁止)
获取焦点 ()

.子程序 _修改钮_被单击, 空白型, , 
赋值 (修改编号, .内容)
连续赋值 (假, .禁止, .禁止)
赋值 (新增维修, 假)
获取焦点 ()

.子程序 _删除钮_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    提示信息框 (“未找到需要删除的记录，请重新选择！”, #标题, 64)
    返回 ()
.如果真结束
.如果真 (等于 (提示信息框 (“删除记录后将不可再恢复，确定要删除此记录吗？”, #标题, 33), 2))
    返回 ()
.如果真结束
.如果 (条件删除数据库 (导航窗口., 导航窗口., 相加 (“维修单号='”, .内容, “'”)))
    清空数据 (维修登记窗口, 维修编辑框, 维修组合框, 维修日期框, , , 增减时间 (取现行时间 (), #日, 1))
    维取记录数量 ()
    未知支持库函数_3 ().未知支持库函数_36 ()
    .如果真 (小于 (., 6))
        .未知支持库函数_38 ()
        0.未知支持库函数_31 (24)
        5.未知支持库函数_31 (20)
    .如果真结束
    提示信息框 (“删除记录成功！”, #标题, 64)
.否则
    提示信息框 (“删除记录失败！”, #标题, 16, “UB-04”)
.如果结束


.子程序 _取消钮_被单击, 空白型, , 
.如果真 (等于 (.禁止, 假))
    .如果真 (取反 (判断输入内容 (假, , , “客户姓名”, , “客户电话”)))
        .如果真 (等于 (提示信息框 (“当前数据未保存，是否放弃保存？”, #标题, 65), 2))
            返回 ()
        .如果真结束
        
    .如果真结束
    
.如果真结束
销毁 ()

.子程序 _维修登记窗口_将被销毁, 空白型, , 
导航窗口.未知支持库函数_18 (.)

.子程序 _导资钮_被单击, 空白型, , 
弹出菜单 ()

.子程序 _导入客户资料_被选择, 空白型, , 
赋值 (调用窗口, 维修登记窗口)
_客户信息超钮_被单击 ()

.子程序 _导入会员资料_被选择, 空白型, , 
赋值 (调用窗口, 维修登记窗口)
_会员信息超钮_被单击 ()

.子程序 维修次数提示, 空白型, , 
.如果 (不等于 (.内容, “”))
    导航窗口.未知支持库函数_47 (., “”)
    导航窗口.未知支持库函数_47 (., 相加 (“客户编号='”, .内容, “'”))
    赋值 (.内容, 相加 (到文本 (导航窗口..), “/次”))
.否则
    赋值 (.内容, “”)
.如果结束


.子程序 维取记录数量, 空白型, , 
.局部变量 记录总数量, 整数型, , , 共有多少客户记录

导航窗口.未知支持库函数_47 (., “”)
导航窗口.未知支持库函数_35 (.)
赋值 (记录总数量, 导航窗口..)
赋值 (.标题, 相加 (“ ◇维修登记共计 ”, 到文本 (记录总数量), “/条”))

.子程序 _客编号框_内容被改变, 空白型, , 
维修次数提示 ()

.子程序 维修外部修改接口, 空白型, , 用于资料浏览时或外部窗口程序调用的接口
.参数 修改条件, 文本型, , 

数据库到编组日框 (导航窗口., 修改条件, 维修编辑框, 维修组合框, 维修日期框, 真, 假, 真)
_修改钮_被单击 ()

.窗口程序集 基础信息窗口程序集, , , 

.程序集变量 小节名, 文本型, , , 
.子程序 _基础信息窗口_创建完毕, 空白型, , 
基础表头初始化 ()
显示动态窗口 (基础信息窗口, 30, 1)
连续赋值 (取反 (权限 [6]), .禁止, .禁止, .禁止)

.子程序 基础表头初始化, 空白型, , 
.局部变量 列宽度, 整数型, , "2", 
.局部变量 表头标题, 文本型, , "2", 

未知支持库函数_57 ()
赋值 (列宽度, { 40, 396 })
赋值 (表头标题, { “序号”, “内                    容” })
表格初始化 (24, 7, 列宽度, 表头标题, , 真, 真, ., 2)
_项目组框_列表项被选择 ()

.子程序 _基础信息表格_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

末尾加入行表格 (键代码, 真, 8)

.子程序 _项目组框_列表项被选择, 空白型, , 
.局部变量 项目数组, 文本型, , "0", 
.局部变量 项目数, 整数型, , , 
.局部变量 行数变量, 整数型, , , 

赋值 (小节名, .取项目文本 (.现行选中项))
取加密配置项名 (小节名, 项目数组)
赋值 (项目数, 取数组成员数 (项目数组))
.如果 (小于或等于 (项目数, 7))
    赋值 (., 8)
    1.未知支持库函数_32 (396) ' 未超出表格高度置回原宽度
.否则
    赋值 (., 相加 (项目数, 1))
    1.未知支持库函数_32 (相减 (396, 17)) ' 超出表格高度后不出现横向滚动条
.如果结束
0.未知支持库函数_31 (24) ' 置表头行高
1.未知支持库函数_62 (0, ., 1) ' 清空数据
.变量循环首 (1, 项目数, 1, 行数变量)
    行数变量.未知支持库函数_9 (0, #., 到文本 (行数变量))
    行数变量.未知支持库函数_9 (1, #., 读加密配置项 (小节名, 到文本 (行数变量)))
.变量循环尾 ()
赋值 (.标题, 相加 (“ ◇共计: ”, 到文本 (相减 (行数变量, 1)), “/条资料”))

.子程序 _基础信息表格_结束编辑, 空白型, , 
.如果真 (不等于 (到文本 (未知支持库函数_3 ().未知支持库函数_10 (1)), “”))
    未知支持库函数_3 ().未知支持库函数_9 (0, #., 到文本 (未知支持库函数_3 ()))
     ' 为新增的内容赋上对应的序号
.如果真结束


.子程序 _保存钮_被单击, 空白型, , 
.局部变量 欲写入文本, 文本型, , , 
.局部变量 循环变量, 整数型, , , 

删除加密配置小节 (小节名) ' 删除小节后重写
.计次循环首 (相减 (., 1), 循环变量)
    赋值 (欲写入文本, 到文本 (循环变量.未知支持库函数_10 (1)))
    .如果 (不等于 (欲写入文本, “”)) ' 取到空行时就跳出循环
         ' 写加密配置项 (小节名, 到文本 (循环变量), 欲写入文本)
     ' .否则
        跳出循环 ()
    .如果结束
    
.计次循环尾 ()
提示信息框 (“保存配置信息成功！可以继续选择下一项目！”, #标题, 64)
基础信息窗口.激活 ()
获取焦点 ()

.子程序 _删除钮_被单击, 空白型, , 
.局部变量 循环变量, 整数型, , , 

.如果真 (小于 (未知支持库函数_3 (), 1))
    提示信息框 (“未选择需删除的项目，请重新选择！”, #标题, 64)
    返回 ()
.如果真结束
.如果真 (等于 (提示信息框 (“确定要删除此项信息吗？”, #标题, 33), 2))
    返回 ()
.如果真结束
未知支持库函数_3 ().未知支持库函数_36 ()
.如果真 (小于 (., 8))
    赋值 (., 8)
    0.未知支持库函数_31 (24) ' 置表头行高
.如果真结束
1.未知支持库函数_62 (0, ., 0)
.计次循环首 (相减 (., 1), 循环变量) ' 重新顺序排列序号
    .如果 (不等于 (到文本 (循环变量.未知支持库函数_10 (1)), “”))
        循环变量.未知支持库函数_9 (0, #., 到文本 (循环变量))
    .否则
        跳出循环 ()
    .如果结束
    
.计次循环尾 ()

.子程序 _取消钮_被单击, 空白型, , 
销毁 ()

.子程序 _添加行钮_被单击, 空白型, , 
.如果真 (不等于 (到文本 (相减 (., 1).未知支持库函数_10 (1)), “”)) ' 上一行要不为空行
    .未知支持库函数_38 ()
    .如果真 (大于 (., 8))
        1.未知支持库函数_32 (相减 (396, 17)) ' 超出表格高度后不出现横向滚动条
    .如果真结束
    相减 (., 1).未知支持库函数_31 (22) ' 给新增的行统一为22高度
.如果真结束


.窗口程序集 用户管理窗口程序集, , , 

.程序集变量 项目文本, 文本型, , "25", 
.程序集变量 记录集句柄, 整数型, , , 
.子程序 _用户管理窗口_创建完毕, 空白型, , 
用户表头初始化 ()
连续赋值 (取反 (权限 [1]), ., .禁止, .禁止, .禁止, .禁止)
用户数据初始化 () ' 初始化登陆用户数据
显示动态窗口 (用户管理窗口, 30, 1)

.子程序 用户表头初始化, 空白型, , 
.局部变量 列宽度, 整数型, , "14", 
.局部变量 表头标题, 文本型, , "14", 
.局部变量 列类型, 整数型, , "14", 
.局部变量 项目文本, 文本型, , "25", 
.局部变量 线条列号, 整数型, , "5", 
.局部变量 循环变量, 整数型, , , 

赋值 (列宽度, { 60, 60, 8, 60, 60, 8, 60, 60, 8, 60, 60, 8, 60, 60 })
赋值 (表头标题, { “项  目”, “系统设置”, “”, “项  目”, “基础信息”, “”, “项  目”, “客户资料”, “”, “项  目”, “会员资料”, “”, “项  目”, “报修系统” })
赋值 (列类型, { 1, 5, 1, 1, 5, 1, 1, 5, 1, 1, 5, 1, 1, 5 })
表格初始化 (24, 4, 列宽度, 表头标题, 列类型, 假, 真, 7, 14)
赋值 (线条列号, { 2, 5, 8, 11 })
.计次循环首 (4, 循环变量)
    0.未知支持库函数_24 (线条列号 [循环变量], ., 线条列号 [循环变量], #白色) ' 间隔列设置为白色
    1.未知支持库函数_53 (线条列号 [循环变量], ., 线条列号 [循环变量], 真) ' 间隔列设置为只读
.计次循环尾 ()
赋值 (线条列号, { 0, 3, 6, 9, 12 })
.计次循环首 (5, 循环变量)
    1.未知支持库函数_47 (线条列号 [循环变量], 1)
    1.未知支持库函数_53 (线条列号 [循环变量], ., 线条列号 [循环变量], 真)
.计次循环尾 ()

.子程序 用户数据初始化, 空白型, , 
.如果真 (取反 (_启动窗口.打开MDB数据库 (., 相加 (main路径, “user.dll”), , “D7D3BAADB9A4D7F7CAD2”, , )))
    提示信息框 (相加 (“读取用户文件错误！，请重新安装”, #标题, “软件！”), #标题, 16, “UM-01”)
    _启动窗口.关闭 (.)
    返回 ()
.如果真结束
赋值 (记录集句柄, _启动窗口.查询 (., “select * from 用户名表”))
_启动窗口.到首记录 (., 记录集句柄)
清空 ()
.判断循环首 (等于 (_启动窗口.尾记录后 (., 记录集句柄), 假)) ' 将用户名加入到组合框
    _启动窗口.读 (., 记录集句柄, “用户名”).加入项目 ()
    _启动窗口.到后一记录 (., 记录集句柄)
.判断循环尾 ()
_启动窗口.关闭记录集 (., 记录集句柄)
登陆用户.选择 ()
.如果 (并且 (小于 (取项目数 (), 1), 等于 (登陆用户, “初始管理员”)))
    提示信息框 (“现系统无管理用户，请新增一名超级管理用户，他将具有所有权限！”, #标题, 64)
    判断切换 (假)
    用户数据填充 (登陆用户, 真)
    连续赋值 (真, ., .禁止, .禁止)
.否则
    用户数据填充 (登陆用户) ' 切换用户时填充数据
.如果结束


.子程序 用户数据填充, 空白型, , 
.参数 填充用户名, 文本型, , 
.参数 填充真值, 逻辑型, 可空, 

.局部变量 写入列号, 整数型, , "5", 
.局部变量 行数变量, 整数型, , , 
.局部变量 列数变量, 整数型, , , 
.局部变量 项目数, 整数型, , , 
.局部变量 读出逻辑值, 逻辑型, , , 

赋值 (记录集句柄, _启动窗口.查询 (., 相加 (“select * from 用户名表 where 用户名='”, 填充用户名, “'”)))
_启动窗口.到首记录 (., 记录集句柄)
赋值 (项目文本, { “用户管理”, “帐套管理”, “系统配置”, “备份数据”, “恢复数据”, “基础配置”, “货品管理”, “”, “”, “”, “客户录入”, “客户浏览”, “客户查询”, “”, “”, “会员录入”, “会员浏览”, “会员查询”, “”, “”, “维修登记”, “维修审核”, “维修记录”, “查询记录”, “” })
赋值 (写入列号, { 0, 3, 6, 9, 12 })
.计次循环首 (5, 列数变量) ' 控制列数
    1.未知支持库函数_9 (相加 (写入列号 [列数变量], 1), #., 假) ' 初始第1行为假
    .计次循环首 (5, 行数变量) ' 控制行数
        赋值 (项目数, 相加 (项目数, 1)) ' 控制项目文本数组
        相加 (行数变量, 1).未知支持库函数_9 (写入列号 [列数变量], #., 项目文本 [项目数])
        .如果 (等于 (项目文本 [项目数], “”)) ' 将无项目的单元只读
            相加 (行数变量, 1).未知支持库函数_53 (相加 (写入列号 [列数变量], 1), 相加 (行数变量, 1), 相加 (写入列号 [列数变量], 1), 真)
        .否则
            赋值 (读出逻辑值, _启动窗口.读 (., 记录集句柄, 项目文本 [项目数]))
            .如果真 (填充真值)
                赋值 (读出逻辑值, 填充真值)
            .如果真结束
            .如果真 (读出逻辑值) ' 有任何一个项目为真，第1行就为真
                1.未知支持库函数_9 (相加 (写入列号 [列数变量], 1), #., 真)
            .如果真结束
            相加 (行数变量, 1).未知支持库函数_9 (相加 (写入列号 [列数变量], 1), #., 读出逻辑值)
        .如果结束
        
    .计次循环尾 ()
.计次循环尾 ()
赋值 (.标题, 相加 (“ ◇用户共计: ”, 到文本 (取项目数 ()), “/名  被修改用户: ”, .内容))
_启动窗口.关闭记录集 (., 记录集句柄)

.子程序 _用户管理表格_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 选中值, 逻辑型, , , 取选中单元的逻辑值
.局部变量 选中列, 整数型, , , 取光标所在列
.局部变量 全为假, 逻辑型, , , 初始所有项目都为假
.局部变量 现值, 逻辑型, , , 当前值被修改后的值
.局部变量 值, 逻辑型, , , 
.局部变量 循环变量, 整数型, , , 

赋值 (选中列, 未知支持库函数_4 ())
.如果真 (或者 (等于 (选中列, 1), 等于 (选中列, 4), 等于 (选中列, 7), 等于 (选中列, 10), 等于 (选中列, 111), 等于 (选中列, 13)))
    .判断开始 (等于 (未知支持库函数_3 (), 1)) ' 第1行的值为假，全部为假，为真都为真
        赋值 (选中值, 取反 (1.未知支持库函数_10 (选中列))) ' 这里取出的值是反的
        .计次循环首 (5, 循环变量)
            .如果 (不等于 (相加 (循环变量, 1).未知支持库函数_10 (相减 (选中列, 1)), “”))
                相加 (循环变量, 1).未知支持库函数_9 (选中列, #., 选中值)
            .否则
                跳出循环 ()
            .如果结束
            
        .计次循环尾 ()
    .判断 (并且 (大于 (未知支持库函数_3 (), 1), 小于 (未知支持库函数_3 (), 7)))
        赋值 (全为假, 真)
        赋值 (现值, 取反 (未知支持库函数_3 ().未知支持库函数_10 (选中列))) ' 当前值被修改后的值
        .变量循环首 (2, 6, 1, 循环变量)
            .如果 (不等于 (循环变量.未知支持库函数_10 (相减 (选中列, 1)), “”))
                赋值 (值, 循环变量.未知支持库函数_10 (选中列))
                .如果真 (等于 (循环变量, 未知支持库函数_3 ()))
                    赋值 (值, 现值)
                .如果真结束
                .如果真 (值)
                    赋值 (全为假, 假)
                    跳出循环 () ' 如果取到除第1行外的任何一行为真就跳出循环并置1行为真
                .如果真结束
                
            .否则
                跳出循环 ()
            .如果结束
            
        .变量循环尾 ()
        1.未知支持库函数_9 (选中列, #., 等于 (全为假, 假))
    .默认
        
    .判断结束
    
.如果真结束


.子程序 判断切换, 空白型, , 
.参数 选择新增, 逻辑型, , 选择用户时为真，新增用户时为假

.如果 (选择新增)
    赋值 (.标题, “选择用户:”)
    连续赋值 (假, .可视, .禁止, .禁止, .禁止)
    赋值 (.可视, 真)
    获取焦点 ()
.否则
    赋值 (.标题, “新增用户:”)
    连续赋值 (真, .可视, .禁止, .禁止, .禁止)
    赋值 (.可视, 假)
    获取焦点 ()
.如果结束


.子程序 _新增用户钮_被单击, 空白型, , 
判断切换 (假)
_清空钮_被单击 ()

.子程序 _用户组框_列表项被选择, 空白型, , 
用户数据填充 (.内容)

.子程序 _删除钮_被单击, 空白型, , 
.局部变量 被删用户, 文本型, , , 

赋值 (被删用户, .内容)
.如果真 (小于或等于 (取项目数 (), 1))
    提示信息框 (“不可删除，至少应保留一名具有用户管理权限的登陆用户！”, #标题, 48)
    返回 ()
.如果真结束
.如果真 (等于 (被删用户, 登陆用户)) ' 这样将保证至少有一个具有管理权限的用户不被删除
    提示信息框 (“登陆用户不可删除自己，请切换一个具有用户管理权限的登陆用户来删除！”, #标题, 64)
    返回 ()
.如果真结束
.如果真 (等于 (提示信息框 (相加 (“删除用户后将不可再恢复！确定要删除：”, 被删用户, “ 此用户吗？”), #标题, 33), 2))
    返回 ()
.如果真结束
.如果 (_启动窗口.执行 (., 相加 (“delete from 用户名表 where 用户名='”, 被删用户, “'”), ))
    .删除项目 (.现行选中项)
    登陆用户.选择 ()
    用户数据填充 (登陆用户)
    提示信息框 (相加 (“删除用户: ”, 被删用户, “ 成功！”), #标题, 64)
.否则
    提示信息框 (相加 (“删除用户: ”, 被删用户, “ 失败！”), #标题, 16, “UM-02”)
.如果结束


.子程序 _保存钮_被单击, 空白型, , 
.局部变量 真权限, 整数型, , , 

.如果真 (不等于 (.内容, “”))
    .如果真 (不等于 (.内容, .内容))
        提示信息框 (“确认密码不正确，请重新确认新密码！”, #标题, 64)
        连续赋值 (“”, .内容, .内容)
        用户管理窗口.激活 ()
        获取焦点 ()
        返回 ()
    .如果真结束
    
.如果真结束
_启动窗口.启动事务 (.)
.如果 (.可视)
    .如果真 (等于 (.内容, “”))
        提示信息框 (“用户名不可为空，请重新输入新增用户名！”, #标题, 64)
        用户管理窗口.激活 ()
        获取焦点 ()
        返回 ()
    .如果真结束
    .如果真 (取反 (写入用户权限 (.内容, 真, 假, 真, 真权限)))
        提示信息框 (“新增用户失败，请重新启动系统后再重试！”, #标题, 16, “UM-03”)
        _启动窗口.回滚事务 (.)
        用户管理窗口.激活 ()
        获取焦点 ()
        返回 ()
    .如果真结束
    .加入项目 (.内容, )
    .选择 (.内容)
    判断切换 (真)
    连续赋值 (假, ., .禁止, .禁止)
.否则
    .如果真 (等于 (.内容, “”))
        提示信息框 (“用户名不可为空，请重新重新选择用户名！”, #标题, 64)
        用户管理窗口.激活 ()
        获取焦点 ()
        返回 ()
    .如果真结束
    .如果真 (取反 (写入用户权限 (.内容, 假, 不等于 (.内容, “”), 取反 (.), 真权限)))
        _启动窗口.回滚事务 (.)
        提示信息框 (“修改用户失败，请重新启动系统后再重试！”, #标题, 16, “UM-04”)
        用户管理窗口.激活 ()
        获取焦点 ()
        返回 ()
    .如果真结束
    
.如果结束
.如果真 (并且 (小于或等于 (取项目数 (), 1), 不等于 (真权限, 17)))
     ' 如果只有一名管理用户且未设置所有权限时就不保存刚才的操作
    _启动窗口.回滚事务 (.)
    提示信息框 (“这将导致系统无管理用户，此管理用户应具有所有权限！请重新设置所有权限！”, #标题, 48)
    返回 ()
.如果真结束
_启动窗口.提交事务 (.)
连续赋值 (“”, .内容, .内容, .内容)
提示信息框 (“设置管理用户成功，请重启软件以使新权限或新密码生效！”, #标题, 64)

.子程序 写入用户权限, 逻辑型, , 
.参数 用户名, 文本型, , 写入那个用户
.参数 是否新增用户, 逻辑型, , 新增用户为真，修改用户为假
.参数 是否写入密码, 逻辑型, , 密码框为空就不重写密码
.参数 是否写入权限, 逻辑型, , 权限表格禁止说明没有设置的权限就不用写入权限
.参数 真权限数, 整数型, 参考, 取出当前修改的用户设置了多少真权限

.局部变量 写入权限, 逻辑型, , , 
.局部变量 转换值, 文本型, , , 
.局部变量 列数变量, 整数型, , , 
.局部变量 行数变量, 整数型, , , 
.局部变量 读出列号, 整数型, , "5", 
.局部变量 项目值, 整数型, , , 

赋值 (读出列号, { 1, 4, 7, 10, 13 })
.如果真 (是否新增用户)
    .如果真 (取反 (_启动窗口.执行 (., 相加 (“insert into 用户名表(用户名,密码) values('”, 用户名, “','”, .内容, “')”), )))
         ' 写入新用户的用户名和密码
        返回 (假)
    .如果真结束
    
.如果真结束
.如果真 (是否写入密码)
    .如果真 (取反 (_启动窗口.执行 (., 相加 (“update 用户名表 set 密码='”, .内容, “' where 用户名='”, 用户名, “'”), )))
         ' 修改用户密码
        返回 (假)
    .如果真结束
    
.如果真结束
.如果真 (是否写入权限) ' 将表格中的权限写入数据库
    .计次循环首 (5, 列数变量)
        .变量循环首 (2, 6, 1, 行数变量)
            赋值 (项目值, 相加 (项目值, 1))
            .如果真 (不等于 (行数变量.未知支持库函数_10 (相减 (读出列号 [列数变量], 1)), “”))
                赋值 (写入权限, 行数变量.未知支持库函数_10 (读出列号 [列数变量]))
                .如果 (写入权限)
                    赋值 (转换值, “Yes”) ' 将逻辑值转换成SQL用语的文本值
                    赋值 (真权限数, 相加 (真权限数, 1))
                .否则
                    赋值 (转换值, “No”)
                .如果结束
                .如果真 (取反 (_启动窗口.执行 (., 相加 (“update 用户名表 set ”, 项目文本 [项目值], “=”, 转换值, “ where 用户名='”, 用户名, “'”), )))
                    返回 (假)
                .如果真结束
                
            .如果真结束
            
        .变量循环尾 ()
    .计次循环尾 ()
.如果真结束
返回 (真)

.子程序 _修名钮_被单击, 空白型, , 
.局部变量 修改名, 文本型, , , 

.如果真 (输入框 (“这将修改系统管理员的名称，请输入欲修改成的用户名：”, #标题, .内容, 修改名, ))
    .判断开始 (等于 (修改名, .内容)) ' 说明未作修改
        返回 ()
    .判断 (等于 (修改名, “”))
        提示信息框 (“用户名不可为空，请重新输入用户名！”, #标题, 64)
        _修名钮_被单击 ()
        返回 ()
    .默认
        
    .判断结束
    .如果真 (取反 (_启动窗口.执行 (., 相加 (“update 用户名表 set 用户名='”, 修改名, “' where 用户名='”, .内容, “'”), )))
        提示信息框 (“修改用户名失败，请重新启动系统后重试！”, #标题, 16, “UM-05”)
        返回 ()
    .如果真结束
    .置项目文本 (.现行选中项, 修改名)
    提示信息框 (“修改用户名成功！”, #标题, 64)
.如果真结束


.子程序 _清空钮_被单击, 空白型, , 
.局部变量 列数变量, 整数型, , , 
.局部变量 清空列, 整数型, , "5", 

赋值 (清空列, { 1, 4, 7, 10, 13 })
.计次循环首 (5, 列数变量)
    1.未知支持库函数_62 (清空列 [列数变量], 7, 清空列 [列数变量])
.计次循环尾 ()

.子程序 _取消钮_被单击, 空白型, , 
销毁 ()

.子程序 _用户管理窗口_将被销毁, 空白型, , 
_启动窗口.关闭记录集 (., 记录集句柄)
_启动窗口.关闭 (.)

.程序集 其他功能程序集, , , 

.子程序 提示信息框, 整数型, , 代替系统自代的信息框,可以不受窗体最前限制，加入错误信息.确定=1,取消=2
.参数 提示内容, 文本型, , 
.参数 提示标题, 文本型, , 
.参数 提示按钮, 整数型, , 
.参数 错误信息, 文本型, 可空, 错误信息代码
.参数 窗口句柄, 整数型, 可空, 欲显示信息框的窗体句柄

.如果真 (取反 (是否为空 (错误信息)))
    赋值 (提示内容, 相加 (提示内容, #换行符, #换行符, “错误代码：”, 错误信息))
.如果真结束
.如果真 (是否为空 (窗口句柄))
    赋值 (窗口句柄, _启动窗口.取窗口句柄 ())
.如果真结束
返回 (提示信息 (窗口句柄, 提示内容, 提示标题, 提示按钮))

.子程序 读加密配置项, 文本型, 公开, 读取失败，返回空文本
.参数 配置节名, 文本型, , 
.参数 配置项名, 文本型, , 
.参数 默认文本, 文本型, 可空, 

.局部变量 读取内容, 文本型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 取出内容, 文本型, , "0", 

.如果真 (是否为空 (默认文本))
    赋值 (默认文本, “”)
.如果真结束
赋值 (文件号, 打开加密文件 (相加 (main路径, “Config.dll”), #读入, , #密文, ))
.如果真 (等于 (文件号, 0))
    返回 (“”)
.如果真结束
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假))
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (等于 (到大写 (读取内容), 到大写 (相加 (“[”, 配置节名, “]”))))
        跳出循环 ()
    .如果真结束
    
.判断循环尾 ()
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假))
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (并且 (等于 (取文本左边 (删首尾空 (读取内容), 1), “[”), 等于 (取文本右边 (删首尾空 (读取内容), 1), “]”)))
        跳出循环 ()
    .如果真结束
    .如果真 (不等于 (寻找文本 (读取内容, “=”, , 假), -1))
        赋值 (取出内容, 分割文本 (读取内容, “=”, ))
        .如果真 (等于 (取数组成员数 (取出内容), 2))
            .如果真 (等于 (删首尾空 (取出内容 [1]), 配置项名))
                关闭文件 (文件号)
                返回 (取出内容 [2])
            .如果真结束
            
        .如果真结束
        
    .如果真结束
    
.判断循环尾 ()
关闭文件 (文件号)
返回 (默认文本)

.子程序 写加密配置项, 逻辑型, 公开, 
.参数 配置节名, 文本型, , 
.参数 配置项名, 文本型, , 
.参数 欲写入值, 文本型, , 不允许写入空值。

.局部变量 读取内容, 文本型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 取出内容, 文本型, , "0", 
.局部变量 上次位置, 整数型, , , 
.局部变量 节存在, 逻辑型, , , 
.局部变量 项存在, 逻辑型, , , 

.如果真 (或者 (等于 (删首尾空 (相加 (main路径, “Config.dll”)), “”), 等于 (删首尾空 (配置节名), “”), 等于 (删首尾空 (配置项名), “”), 等于 (删首尾空 (欲写入值), “”)))
    返回 (假)
.如果真结束
赋值 (文件号, 打开加密文件 (相加 (main路径, “Config.dll”), #改读, , #密文, ))
.如果真 (等于 (文件号, 0))
    返回 (假)
.如果真结束
赋值 (节存在, 假)
赋值 (项存在, 假)
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假))
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (等于 (到大写 (读取内容), 到大写 (相加 (“[”, 配置节名, “]”))))
        赋值 (节存在, 真)
        跳出循环 ()
    .如果真结束
    
.判断循环尾 ()
.如果 (节存在)
    .判断循环首 (等于 (是否在文件尾 (文件号, 真), 假))
        赋值 (上次位置, 取读写位置 (文件号))
        赋值 (读取内容, 读入一行 (文件号))
        .如果真 (并且 (等于 (取文本左边 (删首尾空 (读取内容), 1), “[”), 等于 (取文本右边 (删首尾空 (读取内容), 1), “]”)))
            跳出循环 ()
        .如果真结束
        .如果真 (不等于 (寻找文本 (读取内容, “=”, , 假), -1))
            赋值 (取出内容, 分割文本 (读取内容, “=”, ))
            .如果真 (大于或等于 (取数组成员数 (取出内容), 2))
                .如果真 (等于 (删首尾空 (取出内容 [1]), 配置项名))
                    赋值 (项存在, 真)
                    移动读写位置 (文件号, , 上次位置)
                    删除数据 (文件号, 相加 (取文本长度 (读取内容), 2))
                    移动读写位置 (文件号, , 上次位置)
                    插入文本行 (文件号, 相加 (取出内容 [1], “=”, 欲写入值))
                    关闭文件 (文件号)
                    返回 (真)
                .如果真结束
                
            .如果真结束
            
        .如果真结束
        
    .判断循环尾 ()
    .如果真 (等于 (项存在, 假))
        移动读写位置 (文件号, , 上次位置)
        插入文本行 (文件号, 相加 (配置项名, “=”, 欲写入值))
        关闭文件 (文件号)
        返回 (真)
    .如果真结束
    
.否则
    移到文件尾 (文件号)
    插入文本行 (文件号, 相加 (“[”, 配置节名, “]”))
    插入文本行 (文件号, 相加 (配置项名, “=”, 欲写入值))
    关闭文件 (文件号)
    返回 (真)
.如果结束
关闭文件 (文件号)
返回 (假)

.子程序 取加密配置项名, 逻辑型, 公开, 
.参数 配置节名, 文本型, , 欲取出项目数组的小节名称
.参数 配置项名称数组, 文本型, 数组, 保存取出的配置项名称数组

.局部变量 文件号, 整数型, , , 
.局部变量 读取内容, 文本型, , , 

赋值 (文件号, 打开加密文件 (相加 (main路径, “Config.dll”), #读入, , #密文, ))
清除数组 (配置项名称数组)
.如果真 (等于 (文件号, 0))
    返回 (假)
.如果真结束
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假))
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (等于 (到大写 (读取内容), 到大写 (相加 (“[”, 配置节名, “]”))))
        跳出循环 ()
    .如果真结束
    
.判断循环尾 ()
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假))
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (并且 (等于 (取文本左边 (删首尾空 (读取内容), 1), “[”), 等于 (取文本右边 (删首尾空 (读取内容), 1), “]”)))
        跳出循环 ()
    .如果真结束
    .如果真 (不等于 (寻找文本 (读取内容, “=”, , 假), -1))
        加入成员 (配置项名称数组, 删首尾空 (取文本左边 (读取内容, 相减 (寻找文本 (读取内容, “=”, , 假), 1))))
    .如果真结束
    
.判断循环尾 ()
关闭文件 (文件号)
返回 (真)

.子程序 删除加密配置小节, 逻辑型, 公开, 
.参数 配置节名, 文本型, , 

.局部变量 读取内容, 文本型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 上次位置, 整数型, , , 
.局部变量 节存在, 逻辑型, , , 

赋值 (文件号, 打开加密文件 (相加 (main路径, “Config.dll”), #改读, , #密文, ))
.如果真 (等于 (文件号, 0))
    返回 (假)
.如果真结束
赋值 (节存在, 假)
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假))
    赋值 (上次位置, 取读写位置 (文件号))
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (等于 (到大写 (读取内容), 到大写 (相加 (“[”, 配置节名, “]”))))
        赋值 (节存在, 真)
        移动读写位置 (文件号, , 上次位置)
        删除数据 (文件号, 相加 (取文本长度 (读取内容), 2))
        移动读写位置 (文件号, , 上次位置)
        跳出循环 ()
    .如果真结束
    
.判断循环尾 ()
.如果真 (等于 (节存在, 假))
    关闭文件 (文件号)
    返回 (节存在)
.如果真结束
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假))
    赋值 (上次位置, 取读写位置 (文件号))
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (并且 (等于 (取文本左边 (删首尾空 (读取内容), 1), “[”), 等于 (取文本右边 (删首尾空 (读取内容), 1), “]”)))
        跳出循环 ()
    .如果真结束
    移动读写位置 (文件号, , 上次位置)
    删除数据 (文件号, 相加 (取文本长度 (读取内容), 2))
    移动读写位置 (文件号, , 上次位置)
.判断循环尾 ()
关闭文件 (文件号)
返回 (真)

.子程序 删除加密配置项目, 逻辑型, 公开, 
.参数 配置节名, 文本型, , 
.参数 配置项名, 文本型, , 

.局部变量 读取内容, 文本型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 取出内容, 文本型, , "0", 
.局部变量 上次位置, 整数型, , , 
.局部变量 节存在, 逻辑型, , , 
.局部变量 项存在, 逻辑型, , , 

赋值 (文件号, 打开加密文件 (相加 (main路径, “Config.dll”), #改读, , #密文, ))
.如果真 (等于 (文件号, 0))
    返回 (假)
.如果真结束
赋值 (节存在, 假)
赋值 (项存在, 假)
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假))
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (等于 (到大写 (读取内容), 到大写 (相加 (“[”, 配置节名, “]”))))
        赋值 (节存在, 真)
        跳出循环 ()
    .如果真结束
    
.判断循环尾 ()
.如果真 (等于 (节存在, 假))
    关闭文件 (文件号)
    返回 (假)
.如果真结束
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假))
    赋值 (上次位置, 取读写位置 (文件号))
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (并且 (等于 (取文本左边 (删首尾空 (读取内容), 1), “[”), 等于 (取文本右边 (删首尾空 (读取内容), 1), “]”)))
        跳出循环 ()
    .如果真结束
    .如果真 (不等于 (寻找文本 (读取内容, “=”, , 假), -1))
        赋值 (取出内容, 分割文本 (读取内容, “=”, ))
        .如果真 (大于或等于 (取数组成员数 (取出内容), 2))
            .如果真 (等于 (删首尾空 (取出内容 [1]), 配置项名))
                赋值 (项存在, 真)
                移动读写位置 (文件号, , 上次位置)
                删除数据 (文件号, 相加 (取文本长度 (读取内容), 2))
                移动读写位置 (文件号, , 上次位置)
                关闭文件 (文件号)
                返回 (真)
            .如果真结束
            
        .如果真结束
        
    .如果真结束
    
.判断循环尾 ()
.如果真 (等于 (项存在, 假))
    关闭文件 (文件号)
    返回 (假)
.如果真结束
关闭文件 (文件号)
返回 (真)

.子程序 数据到组合框, 空白型, , 去处类别字段中重复记录再添加到组合框
.参数 记录集, 未知类型0x90002, , 
.参数 组合框, 组合框, , 
.参数 字段名, 文本型, , 欲读那个字段
.参数 过滤条件, 文本型, , “”为不过滤

.局部变量 文本值, 文本型, , , 
.局部变量 循环变量, 整数型, , , 

组合框.清空 ()
组合框.加入项目 (“<全部>”, ) ' 在首位加入一个全部文本
记录集.未知支持库函数_47 (过滤条件)
记录集.未知支持库函数_34 ()
.判断循环首 (取反 (记录集.))
    记录集.未知支持库函数_26 (字段名, 文本值)
    .如果真 (不等于 (文本值, 组合框.取项目文本 (相减 (组合框.取项目数 (), 1))))
         ' 排除重复的记录，方法是用取出的数据对比组合框的最后一条文本
         ' 因为用了排序，所有记录集中的数据相同是排在一起的
    .如果真结束
    组合框.加入项目 (文本值, )
    记录集.未知支持库函数_36 ()
.判断循环尾 ()
赋值 (组合框.现行选中项, 0)
记录集.未知支持库函数_47 (“”)

.子程序 配置文件到组合框, 空白型, , 将配置文件加入到组合框中
.参数 组合框, 组合框, , 
.参数 欲读配置项, 文本型, , 

.局部变量 项目数组, 文本型, , "0", 
.局部变量 循环变量, 整数型, , , 

取加密配置项名 (欲读配置项, 项目数组)
.如果真 (大于 (取数组成员数 (项目数组), 0))
    组合框.清空 ()
    .计次循环首 (取数组成员数 (项目数组), 循环变量)
        组合框.加入项目 (读加密配置项 (欲读配置项, 到文本 (循环变量)), )
    .计次循环尾 ()
.如果真结束


.子程序 数据到编辑框, 空白型, , 读数据库中的数据到编辑框中
.参数 记录集, 未知类型0x90002, , 
.参数 过滤条件, 文本型, , 
.参数 当前状态, 逻辑型, 可空, 不过滤所有记录。就上次过滤的状态上
.参数 字段数组, 整数型, 数组, 用｛1，2，3｝标识读取的字段
.参数 欲写编辑框, 编辑框, 数组, 用取标记（）取的编辑框数组

.局部变量 文本值, 文本型, , , 
.局部变量 循环变量, 整数型, , , 

.如果真 (取反 (当前状态))
    记录集.未知支持库函数_47 (“”)
.如果真结束
记录集.未知支持库函数_34 ()
记录集.未知支持库函数_45 (过滤条件, #)
.计次循环首 (取数组成员数 (字段数组), 循环变量)
    记录集.未知支持库函数_26 (字段数组 [循环变量], 文本值)
    赋值 (欲写编辑框 [循环变量], 内容, 相加 (“ ”, 文本值))
.计次循环尾 ()

.子程序 显示动态窗口, 空白型, , 在窗口控件的“_窗口_创建完毕”事件中调用本命令
.参数 窗口, 窗口, , 欲动态显示的窗口如：_启动窗口
.参数 速度, 整数型, , 取1-99之间任意整数，数值越大显示速度越快
.参数 显示模式, 整数型, , 0为随机显示，1为从左上向右下，2为从中间向上下，3为从中间向两边，4为从上向下，5为从左向右，6为从中间到四边

.局部变量 顶, 空白型, , , 
.局部变量 左, 空白型, , , 
.局部变量 高, 空白型, , , 
.局部变量 宽, 空白型, , , 
.局部变量 步长, 空白型, , , 
.局部变量 显示窗口, 窗口, , , 
.局部变量 模式, 空白型, , , 
.局部变量 指数, 空白型, , , 
.局部变量 差, 空白型, , , 

赋值 (显示窗口, 窗口)
赋值 (步长, 速度)
置随机数种子 ()
.如果 (等于 (显示模式, 0))
    赋值 (模式, 取随机数 (1, 6))
.否则
    赋值 (模式, 显示模式)
.如果结束
赋值 (顶, 窗口.顶边)
赋值 (左, 窗口.左边)
赋值 (高, 窗口.高度)
赋值 (宽, 窗口.宽度)
赋值 (差, 相减 (宽, 高))
赋值 (窗口.高度, 0)
赋值 (窗口.宽度, 0)
赋值 (窗口.可视, 真)

.判断开始 (等于 (模式, 1)) ' 从左上向右下
    .变量循环首 (0, 宽, 步长, 指数)
        赋值 (窗口.宽度, 指数)
        .如果 (大于 (相减 (指数, 差), 0))
            赋值 (窗口.高度, 相减 (指数, 差))
        .否则
            赋值 (窗口.高度, 0)
        .如果结束
        
    .变量循环尾 ()
.判断 (等于 (模式, 2)) ' 从中间向上下
    赋值 (窗口.宽度, 宽)
    .变量循环首 (0, 高, 步长, 指数)
        赋值 (窗口.高度, 相加 (指数, 步长))
        赋值 (窗口.位置, 1)
    .变量循环尾 ()
.判断 (等于 (模式, 3)) ' 从中间向两边
    赋值 (窗口.高度, 高)
    .变量循环首 (0, 宽, 步长, 指数)
        赋值 (窗口.宽度, 指数)
        赋值 (窗口.位置, 1)
    .变量循环尾 ()
.判断 (等于 (模式, 4)) ' 从上向下
    赋值 (窗口.宽度, 宽)
    .变量循环首 (0, 高, 步长, 指数)
        赋值 (窗口.高度, 指数)
    .变量循环尾 ()
.判断 (等于 (模式, 5)) ' 从左向右
    赋值 (窗口.高度, 高)
    .变量循环首 (0, 宽, 步长, 指数)
        赋值 (窗口.宽度, 指数)
    .变量循环尾 ()
.判断 (等于 (模式, 6)) ' 从中间到四边
    .变量循环首 (0, 宽, 步长, 指数)
        赋值 (窗口.宽度, 指数)
        .如果 (大于 (相减 (指数, 差), 0))
            赋值 (窗口.高度, 相减 (指数, 差))
        .否则
            赋值 (窗口.高度, 0)
        .如果结束
        赋值 (窗口.位置, 1)
    .变量循环尾 ()
.默认
    
.判断结束
赋值 (窗口.高度, 高)
赋值 (窗口.宽度, 宽)

.子程序 编组日框到数据库, 逻辑型, , 写入编辑框和组合框内容到数据库
.参数 数据库连接, 未知类型0x90001, , 
.参数 记录集, 未知类型0x90002, , 
.参数 欲读编辑框, 编辑框, 数组, 用取标记（）取的编辑框数组
.参数 欲读组合框, 组合框, 数组, 
.参数 欲读日期框, 日期框, 数组, 

.局部变量 编辑框数, 整数型, , , 
.局部变量 组合框数, 整数型, , , 
.局部变量 日期框数, 整数型, , , 
.局部变量 循环变量, 整数型, , , 

赋值 (编辑框数, 取数组成员数 (欲读编辑框))
赋值 (组合框数, 取数组成员数 (欲读组合框))
赋值 (日期框数, 取数组成员数 (欲读日期框))
数据库连接.未知支持库函数_9 () ' 设置事务提高数据库安全
.计次循环首 (相减 (编辑框数, 1), 循环变量) ' -1是去掉了单据框
    .如果 (记录集.未知支持库函数_20 (循环变量, 欲读编辑框 [相加 (循环变量, 1)].内容)) ' 写入编辑框内容
        .如果真 (小于或等于 (循环变量, 组合框数)) ' 写入组合框内容
            .如果真 (取反 (记录集.未知支持库函数_20 (相加 (相减 (循环变量, 1), 编辑框数), 欲读组合框 [循环变量], 内容)))
                数据库连接.未知支持库函数_11 ()
                返回 (假)
            .如果真结束
            
        .如果真结束
        .如果真 (小于或等于 (循环变量, 日期框数)) ' 写入日期框。今天
            .如果真 (取反 (记录集.未知支持库函数_25 (相加 (相减 (循环变量, 1), 编辑框数, 组合框数), 欲读日期框 [循环变量], 今天, 1)))
                数据库连接.未知支持库函数_11 ()
                返回 (假)
            .如果真结束
            
        .如果真结束
        
    .否则
        数据库连接.未知支持库函数_11 ()
        返回 (假)
    .如果结束
    
.计次循环尾 ()
记录集.未知支持库函数_18 ()
.如果真 (数据库连接.未知支持库函数_10 ())
    返回 (真)
.如果真结束
数据库连接.未知支持库函数_11 ()
返回 (假)

.子程序 数据库到编组日框, 空白型, , 将数据库中数据读到编辑框、组合框、日期框中
.参数 记录集, 未知类型0x90002, , 
.参数 过滤条件, 文本型, , 条件只能单一，因为记录集.查找不支持多条件
.参数 欲写编辑框, 编辑框, 可空 数组, 用取标记（）取的编辑框数组
.参数 欲写组合框, 组合框, 可空 数组, 
.参数 欲写日期框, 日期框, 可空 数组, 
.参数 写组合框方式, 逻辑型, 可空, 真为组合框.内容，假为组合框.选择，默认为假
.参数 当前状态, 逻辑型, 可空, 不用查找，就在当前状态下读数据库，假为使用查找，真为当前状态
.参数 保持过滤状态, 逻辑型, 可空, 查找完毕后是否保持过滤状态，保存为真,默认为假,
.参数 字段偏移量, 整数型, 可空, 用于调整读字段序号的值

.局部变量 编辑框数, 整数型, , , 
.局部变量 组合框数, 整数型, , , 
.局部变量 日期框数, 整数型, , , 
.局部变量 文本值, 文本型, , , 
.局部变量 日期值, 日期时间型, , , 
.局部变量 循环变量, 整数型, , , 

.如果真 (取反 (是否为空 (欲写编辑框)))
    赋值 (编辑框数, 取数组成员数 (欲写编辑框)) ' 控件数量
.如果真结束
.如果真 (取反 (是否为空 (欲写组合框)))
    赋值 (组合框数, 取数组成员数 (欲写组合框))
.如果真结束
.如果真 (取反 (是否为空 (欲写日期框)))
    赋值 (日期框数, 取数组成员数 (欲写日期框))
.如果真结束
.如果真 (取反 (当前状态))
    记录集.未知支持库函数_47 (“”)
    记录集.未知支持库函数_45 (过滤条件, #)
.如果真结束
.计次循环首 (编辑框数, 循环变量)
    记录集.未知支持库函数_26 (相减 (循环变量, 1), 文本值)
    .如果真 (取反 (是否为空 (欲写编辑框)))
        赋值 (欲写编辑框 [循环变量], 内容, 文本值)
    .如果真结束
    .如果真 (并且 (取反 (是否为空 (欲写组合框)), 小于或等于 (循环变量, 组合框数)))
        记录集.未知支持库函数_26 (相加 (相减 (循环变量, 1), 编辑框数, 字段偏移量), 文本值)
        .如果 (写组合框方式)
            赋值 (欲写组合框 [循环变量], 内容, 文本值) ' 针对可编辑的组合框可以保证显示内容
        .否则
            欲写组合框.选择 ( [循环变量], 文本值)
        .如果结束
        
    .如果真结束
    .如果真 (并且 (取反 (是否为空 (欲写日期框)), 小于或等于 (循环变量, 日期框数)))
        记录集.未知支持库函数_31 (相加 (相减 (循环变量, 1), 编辑框数, 组合框数), 日期值)
        赋值 (欲写日期框 [循环变量], 今天, 日期值)
    .如果真结束
    
.计次循环尾 ()
.如果真 (取反 (保持过滤状态))
    记录集.未知支持库函数_47 (“”)
.如果真结束


.子程序 自动编号, 文本型, , 根据记录数量判断编号,返回一个唯一的编号
.参数 记录集, 未知类型0x90002, , 
.参数 编号字段, 文本型, , 记录单号的那个字段
.参数 编号头值, 整数型, , 1为客户编号，2为会员编号，3为维修编号，4为产品编号

.局部变量 记录位数, 整数型, , , 
.局部变量 临时编号, 文本型, , , 
.局部变量 编号头, 文本型, , , 
.局部变量 循环变量, 整数型, , , 

赋值 (编号头, 配置项 [相加 (编号头值, 6)])
记录集.未知支持库函数_47 (“”)
.循环判断首 () ' 判断是否有相同编号，有则编号再加1
    赋值 (循环变量, 相加 (循环变量, 1))
    赋值 (记录位数, 取文本长度 (到文本 (相加 (记录集., 循环变量))))
    赋值 (临时编号, 相加 (编号头, “-”, 文本替换 (“0000000”, 相减 (8, 记录位数), 记录位数, 到文本 (相加 (记录集., 循环变量)))))
.循环判断尾 (记录集.未知支持库函数_45 (相加 (编号字段, “='”, 临时编号, “'”), #))
返回 (临时编号)

.子程序 编号是否重复, 逻辑型, , 重复为真，反之为假
.参数 记录集, 未知类型0x90002, , 
.参数 编号字段, 文本型, , 
.参数 欲检查编号, 文本型, , 

记录集.未知支持库函数_47 (“”)
记录集.未知支持库函数_34 ()
返回 (记录集.未知支持库函数_45 (相加 (编号字段, “='”, 欲检查编号, “'”), #))

.子程序 清空数据, 空白型, , 情况编辑框、组合框、日期框、表格的数据
.参数 调用窗口, 窗口, , 那个窗口调用
.参数 清空编辑框, 编辑框, 可空 数组, 提供相应控件类别的数组
.参数 清空组合框, 组合框, 可空 数组, 
.参数 清空日期框, 日期框, 可空 数组, 
.参数 清空表格, 未知类型0x80001, 可空, 
.参数 重设日期框, 日期框, 可空, 初始日期后再重新设置日期
.参数 重设日期, 日期时间型, 可空, 设置日期的值
.参数 初始表格行, 逻辑型, 可空, 清除到表格的原行数
.参数 原表格行数, 整数型, 可空, 表格原行数

.局部变量 编辑框数, 整数型, , , 
.局部变量 组合框数, 整数型, , , 
.局部变量 日期框数, 整数型, , , 
.局部变量 循环变量, 整数型, , , 

.如果真 (取反 (是否为空 (清空编辑框)))
    赋值 (编辑框数, 取数组成员数 (清空编辑框))
.如果真结束
.如果真 (取反 (是否为空 (清空组合框)))
    赋值 (组合框数, 取数组成员数 (清空组合框))
.如果真结束
.如果真 (取反 (是否为空 (清空日期框)))
    赋值 (日期框数, 取数组成员数 (清空日期框))
.如果真结束
.计次循环首 (编辑框数, 循环变量)
    .如果真 (取反 (是否为空 (清空编辑框)))
        赋值 (清空编辑框 [循环变量], 调用窗口.取标记组件 (循环变量))
        赋值 (清空编辑框 [循环变量], 内容, “”)
    .如果真结束
    .如果真 (并且 (取反 (是否为空 (清空组合框)), 小于或等于 (循环变量, 组合框数)))
        赋值 (清空组合框 [循环变量], 调用窗口.取标记组件 (相加 (循环变量, 编辑框数)))
        赋值 (清空组合框 [循环变量], 现行选中项, -1)
    .如果真结束
    .如果真 (并且 (取反 (是否为空 (清空日期框)), 小于或等于 (循环变量, 日期框数)))
        赋值 (清空日期框 [循环变量], 调用窗口.取标记组件 (相加 (循环变量, 编辑框数, 组合框数)))
        赋值 (清空日期框 [循环变量], 今天, 取现行时间 ())
    .如果真结束
    
.计次循环尾 ()
.如果真 (并且 (初始表格行, 大于 (清空表格., 原表格行数)))
    赋值 (清空表格., 原表格行数)
    清空表格.未知支持库函数_32 (相减 (清空表格., 1), 相加 (清空表格.未知支持库函数_44 (相减 (清空表格., 1)), 17))
    清空表格.未知支持库函数_31 (0, 24)
.如果真结束
.如果真 (取反 (是否为空 (清空表格)))
    清空表格.未知支持库函数_62 (1, 清空表格., 清空表格., 清空表格.)
.如果真结束
.如果真 (取反 (并且 (是否为空 (重设日期框), 是否为空 (重设日期))))
    赋值 (重设日期框.今天, 重设日期)
.如果真结束


.子程序 条件删除数据库, 逻辑型, , 成功删除返回真，反之假
.参数 数据库连接, 未知类型0x90001, , 
.参数 记录集, 未知类型0x90002, , 
.参数 删除条件, 文本型, , 记录集过滤条件

记录集.未知支持库函数_47 (“”)
数据库连接.未知支持库函数_9 ()
.如果真 (记录集.未知支持库函数_47 (删除条件)) ' 不用查找是因为查找不支持多条件查找
    记录集.未知支持库函数_34 ()
    .计次循环首 (记录集., )
        .如果真 (取反 (记录集.未知支持库函数_19 (#)))
            数据库连接.未知支持库函数_11 ()
            返回 (假)
        .如果真结束
        记录集.未知支持库函数_18 ()
        记录集.未知支持库函数_36 ()
    .计次循环尾 ()
    .如果真 (数据库连接.未知支持库函数_10 ())
        记录集.未知支持库函数_47 (“”)
        返回 (真)
    .如果真结束
    
.如果真结束
数据库连接.未知支持库函数_11 ()
返回 (假)

.子程序 条件修改数据库, 整数型, , 0为成功，1为查找失败，2为写入失败
.参数 数据库连接, 未知类型0x90001, , 
.参数 记录集, 未知类型0x90002, , 
.参数 修改条件, 文本型, , 记录集.过滤的条件
.参数 修改字段, 文本型, , 修改内容的字段
.参数 修改值, 文本型, , 修改的内容

记录集.未知支持库函数_47 (“”)
数据库连接.未知支持库函数_9 ()
.如果真 (记录集.未知支持库函数_47 (修改条件))
    记录集.未知支持库函数_34 ()
    .计次循环首 (记录集., )
        .如果真 (取反 (记录集.未知支持库函数_20 (修改字段, 修改值)))
            数据库连接.未知支持库函数_11 ()
            返回 (2)
        .如果真结束
        
    .计次循环尾 ()
    .如果真 (数据库连接.未知支持库函数_10 ())
        记录集.未知支持库函数_18 ()
        返回 (0)
    .如果真结束
    
.如果真结束
数据库连接.未知支持库函数_11 ()
返回 (1)

.子程序 注册限制, 空白型, , 调用自编DLL来效验注册信息，并获取注册名
.参数 限制, 逻辑型, , 

DLL命令调用转向 (相加 (main路径, “sys.dll”), )
.如果 (注册效验 ())
    DLL命令调用转向 (相加 (main路径, “sys.dll”), )
    赋值 (注册名, 注册文件 (假))
.否则
    赋值 (注册名, “未注册版”)
     ' 可以加上注册限制，如试用天数，总记录量，功能限制等等
    .如果 (并且 (限制, 是否已创建 (导航窗口)))
        .如果真 (或者 (大于 (导航窗口.., 50), 大于 (导航窗口.., 50), 大于 (导航窗口.., 50)))
            提示信息框 (“未注册版只能记录50条资料，现已达到50条记录！若想继续使用请注册！”, #标题, 48)
            DLL命令调用转向 (相加 (main路径, “sys.dll”), )
            赋值 (注册名, 注册文件 (真))
            .如果真 (或者 (等于 (注册名, “”), 等于 (注册名, “未注册版”)))
                提示信息框 (“注册失败！若想继续使用请注册！”, #标题, 48)
                结束 ()
            .如果真结束
            
        .如果真结束
        
    .否则
        提示信息框 (相加 (“当前系统尚未注册，将限制储存记录为50条以内！”, #换行符, #换行符, “注册后可使用其全部功能，并不再显示此窗口！”), #标题, 48)
    .如果结束
    
.如果结束


.窗口程序集 维修审核窗口程序集, , , 

.程序集变量 配置项数组, 文本型, , "0", 
.程序集变量 技术员数组, 文本型, , "0", 
.程序集变量 审核人数组, 文本型, , "0", 
.程序集变量 审核编辑框, 编辑框, , "6", 
.子程序 _维修审核窗口_创建完毕, 空白型, , 
.局部变量 循环变量, 整数型, , , 

7.未知支持库函数_30 (#.)
数据库到高级表格_无序 (导航窗口., , “审核=FALSE”, { 0, 2, 3, 13, 10, 15, 16, 17 }, , 8, 4, 3, 8, 7)
赋值 (.标题, 相加 (.标题, “待审核”))
取加密配置项名 (“技术人员”, 配置项数组)
.计次循环首 (取数组成员数 (配置项数组), 循环变量)
    加入成员 (技术员数组, 读加密配置项 (“技术人员”, 配置项数组 [循环变量], ))
    技术员数组.加入项目 ( [循环变量], )
.计次循环尾 ()
取加密配置项名 (“审核人员”, 配置项数组)
.计次循环首 (取数组成员数 (配置项数组), 循环变量)
    加入成员 (审核人数组, 读加密配置项 (“审核人员”, 配置项数组 [循环变量]))
.计次循环尾 ()
审核表头初始化 ()
_显隐钮_被单击 ()
显示动态窗口 (维修审核窗口, 30, 1)
赋值 (., 到数值 (配置项 [2]))

.子程序 审核表头初始化, 空白型, , 
.局部变量 列宽度, 整数型, , "8", 
.局部变量 表头标题, 文本型, , "8", 
.局部变量 列类型, 整数型, , "8", 
.局部变量 循环变量, 整数型, , , 

赋值 (列宽度, { 70, 60, 75, 90, 75, 63, 63, 58 })
赋值 (表头标题, { “维修单号”, “姓 名”, “电  话”, “维修日期”, “维修类型”, “技术员”, “审核人”, “审核” })
赋值 (列类型, { 1, 1, 1, 1, 1, 4, 4 })
未知支持库函数_28 ()
.计次循环首 (取数组成员数 (技术员数组), 循环变量)
    技术员数组.未知支持库函数_29 ( [循环变量])
.计次循环尾 ()
表格初始化 (24, 导航窗口.., 列宽度, 表头标题, 列类型, 真, 真, 1, 4)
清空数据 (维修审核窗口, 审核编辑框)

.子程序 _维修审核窗口_将被销毁, 空白型, , 
清除数组 (配置项数组) ' 0维数组需要重定义为0维，不然不会释放
清除数组 (技术员数组)
清除数组 (审核人数组)
导航窗口.未知支持库函数_18 (.)

.子程序 _报修审核表格_光标位置改变, 空白型, , 添加人员到下拉列表
.局部变量 取表格光标行数据, 文本型, , , 
.局部变量 循环变量, 整数型, , , 

.判断开始 (等于 (未知支持库函数_4 (), 5)) ' 第五列为技术员
    未知支持库函数_28 ()
    5.未知支持库函数_30 (#.)
    .计次循环首 (取数组成员数 (技术员数组), 循环变量) ' 将技术员加到下拉列表
        技术员数组.未知支持库函数_29 ( [循环变量])
    .计次循环尾 ()
    5.未知支持库函数_30 (#.)
.判断 (等于 (未知支持库函数_4 (), 6)) ' 第五列为审核人员
    未知支持库函数_28 ()
    6.未知支持库函数_30 (#.)
    .计次循环首 (取数组成员数 (审核人数组), 循环变量) ' 将审核人加到下拉列表
        审核人数组.未知支持库函数_29 ( [循环变量])
    .计次循环尾 ()
    6.未知支持库函数_30 (#.)
.默认
    
.判断结束
.如果真 (大于或等于 (未知支持库函数_3 (), 1))
    赋值 (取表格光标行数据, 未知支持库函数_3 ().未知支持库函数_10 (0))
    数据到编辑框 (导航窗口., 相加 (“维修单号='”, 取表格光标行数据, “'”), 真, { 5, 8, 6, 4, 11, 7 }, 审核编辑框)
.如果真结束


.子程序 _显隐钮_被单击, 空白型, , 显示详细登记信息
.如果 (.)
    赋值 (., 330)
    赋值 (.可视, 真)
    赋值 (., “↑”)
    赋值 (.高度, 355)
    赋值 (.顶边, 372)
    赋值 (.顶边, 377)
    赋值 (维修审核窗口., 452)
.否则
    赋值 (.可视, 假)
    赋值 (., 238)
    赋值 (., “↓”)
    赋值 (.高度, 263)
    赋值 (.顶边, 280)
    赋值 (.顶边, 285)
    赋值 (维修审核窗口., 360)
.如果结束
连续赋值 (., .顶边, .顶边)
连续赋值 (.高度, .高度)

.子程序 _起始日框_选择日期被改变, 空白型, , 
维修审核窗口.重画 ()
重画 ()

.子程序 _终止日框_选择日期被改变, 空白型, , 
_起始日框_选择日期被改变 ()

.子程序 _过滤钮_被单击, 空白型, , 
弹出菜单 ()
_起始日框_选择日期被改变 ()

.子程序 _只显示未审核记录_被选择, 空白型, , 
按条件显示记录 (“ AND 审核=FALSE”)

.子程序 _只显示已审核记录_被选择, 空白型, , 
按条件显示记录 (“ AND 审核=TRUE”)

.子程序 _显示所有记录_被选择, 空白型, , 
按条件显示记录 (“”)

.子程序 按条件显示记录, 空白型, , 
.参数 显示条件, 文本型, , 

.局部变量 过滤文本, 文本型, , , 

.如果真 (小于 (.今天, .今天))
    提示信息框 (“终止日期不可小于起始时间，请重新设定过滤时间！”, #标题, 64)
    赋值 (.今天, 取现行时间 ())
    返回 ()
.如果真结束
赋值 (过滤文本, 相加 (“维修日期>=”, 时间到文本 (.今天, 2), “ AND 维修日期<=”, 时间到文本 (.今天, 2), 显示条件))
.如果真 (不等于 (.现行选中项, 0))
    赋值 (过滤文本, 相加 (过滤文本, “ AND 技术人员='”, .内容, “'”))
.如果真结束
输出调试文本 (过滤文本)
清空数据 (维修审核窗口, 审核编辑框, , , , , , 真, 8)
数据库到高级表格_无序 (导航窗口., , 过滤文本, { 0, 2, 3, 13, 10, 15, 16, 17 }, , 8, 4, 3, 8, 7)
赋值 (.标题, 相加 (.标题, “待审核”))


.子程序 _审核钮_被单击, 空白型, , 
.局部变量 循环变量, 整数型, , , 

.如果真 (或者 (小于 (未知支持库函数_3 (), 1), 等于 (未知支持库函数_3 ().未知支持库函数_10 (0), “”)))
    提示信息框 (“未选择需审核的记录，请重新选择！”, #标题, 64)
    返回 ()
.如果真结束
导航窗口.未知支持库函数_47 (., “”)
导航窗口.未知支持库函数_34 (.)
导航窗口.未知支持库函数_9 (.)
.如果真 (导航窗口.未知支持库函数_45 (., 相加 (“维修单号='”, 到文本 (未知支持库函数_3 ().未知支持库函数_10 (0)), “'”), #))
    .计次循环首 (2, 循环变量)
        .如果真 (取反 (导航窗口.未知支持库函数_20 (., 相加 (循环变量, 14), 未知支持库函数_3 ().未知支持库函数_10 (相加 (循环变量, 4)))))
            导航窗口.未知支持库函数_11 (.)
            提示信息框 (“写入数据库错误，审核失败！”, #标题, 16, “SB-01”)
            返回 ()
        .如果真结束
        
    .计次循环尾 ()
    .如果真 (取反 (导航窗口.未知支持库函数_24 (., 17, 未知支持库函数_3 ().未知支持库函数_10 (7))))
        导航窗口.未知支持库函数_11 (.)
        提示信息框 (“写入数据库错误，审核失败！”, #标题, 16, “SB-02”)
        返回 ()
    .如果真结束
    导航窗口.未知支持库函数_18 (.)
    导航窗口.未知支持库函数_10 (.)
    提示信息框 (“审核成功，请避免重复审核！”, #标题, 64)
    返回 ()
.如果真结束
提示信息框 (“未检索到需审核的记录，请重启软件后重试！”, #标题, 48)

.子程序 _全审钮_被单击, 空白型, , 
.局部变量 行数变量, 整数型, , , 
.局部变量 列数变量, 整数型, , , 

.如果真 (等于 (提示信息框 (相加 (“注意不要重复审核，未作修改请点击”, #左引号, “取消”, #右引号, “保持未审状态！”, #换行符, #换行符, “确定要审核吗？”), #标题, 65), 1))
    .计次循环首 (., 列数变量)
        .如果真 (不等于 (到文本 (列数变量.未知支持库函数_10 (0)), “”))
            列数变量.未知支持库函数_9 (7, #., 真)
        .如果真结束
        
    .计次循环尾 ()
    赋值 (行数变量, 1)
    导航窗口.未知支持库函数_47 (., “”)
    导航窗口.未知支持库函数_34 (.)
    导航窗口.未知支持库函数_9 (.)
    .判断循环首 (并且 (导航窗口.未知支持库函数_45 (., 相加 (“维修单号='”, 到文本 (行数变量.未知支持库函数_10 (0)), “'”), #), 不等于 (到文本 (行数变量.未知支持库函数_10 (0)), “”)))
        .计次循环首 (2, 列数变量)
            .如果真 (取反 (导航窗口.未知支持库函数_20 (., 相加 (列数变量, 14), 行数变量.未知支持库函数_10 (相加 (列数变量, 4)))))
                导航窗口.未知支持库函数_11 (.)
                提示信息框 (“写入数据库错误，审核失败！”, #标题, 16, “SB-03”)
                返回 ()
            .如果真结束
            
        .计次循环尾 ()
        .如果真 (取反 (导航窗口.未知支持库函数_24 (., 17, 行数变量.未知支持库函数_10 (7))))
            导航窗口.未知支持库函数_11 (.)
            提示信息框 (“写入数据库错误，审核失败！”, #标题, 16, “SB-04”)
            返回 ()
        .如果真结束
        赋值 (行数变量, 相加 (行数变量, 1))
    .判断循环尾 ()
    导航窗口.未知支持库函数_18 (.)
    导航窗口.未知支持库函数_10 (.)
    提示信息框 (相加 (“审核成功，共计审核 ”, 到文本 (相减 (行数变量, 1)), “/条记录！”), #标题, 64)
.如果真结束


.子程序 _删除钮_被单击, 空白型, , 
.局部变量 删除单号, 文本型, , , 

赋值 (删除单号, 未知支持库函数_3 ().未知支持库函数_10 (0))
.如果真 (等于 (删除单号, “”))
    提示信息框 (“未选择需要删除的记录，请重新选择！”, #标题, 64)
    返回 ()
.如果真结束
.如果真 (等于 (提示信息框 (“删除记录后将不可再恢复，确定要删除此记录吗？”, #标题, 33), 2))
    返回 ()
.如果真结束
.如果 (条件删除数据库 (导航窗口., 导航窗口., 相加 (“维修单号='”, 删除单号, “'”)))
    提示信息框 (“删除记录成功！”, #标题, 64)
    清空数据 (维修审核窗口, 审核编辑框)
    未知支持库函数_3 ().未知支持库函数_36 ()
.否则
    提示信息框 (“删除记录失败！”, #标题, 16, “NB-02”)
.如果结束


.子程序 _修改钮_被单击, 空白型, , 
.局部变量 修改单号, 文本型, , , 

赋值 (修改单号, 未知支持库函数_3 ().未知支持库函数_10 (0))
.如果真 (等于 (修改单号, “”))
    提示信息框 (“未选择需要修改的记录，请重新选择！”, #标题, 64)
    返回 ()
.如果真结束
.如果真 (等于 (提示信息框 (“确定要修改此记录吗？”, #标题, 65), 2))
    返回 ()
.如果真结束
.如果真 (取反 (导航窗口..))
    .如果真 (取反 (导航窗口.未知支持库函数_14 (., “报修资料”, #)))
        提示信息框 (“打开报修资料数据库失败，无法完成操作！”, #标题, 16, “SB-05”)
        返回 ()
    .如果真结束
    
.如果真结束
赋值 (新增维修, 假)
载入窗口 (维修登记窗口)
数据库到编组日框 (导航窗口., 相加 (“维修单号='”, 修改单号, “'”), 维修登记窗口., 维修登记窗口., 维修登记窗口., 真)
维修审核窗口.销毁 ()

.子程序 _取消钮_被单击, 空白型, , 
销毁 ()

.子程序 _打印钮_被单击, 空白型, , 
弹出菜单 ()

.子程序 _报修审核表格_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _审核记录_被选择, 空白型, , 
_审核钮_被单击 ()

.子程序 _全部审核_被选择, 空白型, , 
_全审钮_被单击 ()

.子程序 _修改记录_被选择, 空白型, , 
_修改钮_被单击 ()

.子程序 _删除记录_被选择, 空白型, , 
_删除钮_被单击 ()

.子程序 _打印记录_被选择, 空白型, , 
未知支持库函数_26 ()

.子程序 _打印预览_被选择, 空白型, , 
未知支持库函数_27 ()

.子程序 _退出_被选择, 空白型, , 
_取消钮_被单击 ()

.窗口程序集 条件查询窗口程序集, , , 

.程序集变量 日期字段, 整数型, , "0", 
.程序集变量 条件数组, 文本型, , "0", 
.程序集变量 浏览资料, 逻辑型, , , 
.子程序 _条件查询窗口_创建完毕, 空白型, , 
显示动态窗口 (条件查询窗口, 25, 1)
项目列表框填充 ()

.子程序 项目列表框填充, 空白型, , 一定要保证项目值和记录集中的字段相符
.局部变量 项目值, 整数型, 静态, "0", 项目的特点值：共3位数组成：第一位代表类型：1为编辑框,2为组合框,3为日期框，第二位代表条件开关（参加条件开关值），第三位代表编辑框输入方式：0通常输入，1整数输入
.局部变量 循环变量, 整数型, , , 

.判断开始 (等于 (调用记录集, 导航窗口.))
    赋值 (浏览资料, 权限 [9]) ' 取客户资料浏览的权限
    重定义数组 (日期字段, 假, 1)
    赋值 (日期字段, { 10 })
    重定义数组 (项目值, 假, 11)
    赋值 (项目值, { 110, 120, 121, 121, 120, 131, 110, 2, 2, 2, 3 })
.判断 (等于 (调用记录集, 导航窗口.))
    赋值 (浏览资料, 权限 [12]) ' 取会员资料浏览的权限
    重定义数组 (日期字段, 假, 2)
    赋值 (日期字段, { 9, 10 })
    重定义数组 (项目值, 假, 11)
    赋值 (项目值, { 110, 120, 121, 121, 120, 131, 2, 2, 2, 3, 3 })
.判断 (等于 (调用记录集, 导航窗口.))
    赋值 (浏览资料, 权限 [16]) ' 取维修登记浏览的权限
    重定义数组 (日期字段, 假, 3)
    赋值 (日期字段, { 12, 13, 14 })
    重定义数组 (项目值, 假, 18)
    赋值 (项目值, { 110, 110, 120, 121, 121, 120, 120, 121, 2, 2, 2, 2, 3, 3, 3, 2, 2, 110 })
.默认
    
.判断结束
清空 ()
.计次循环首 (调用记录集., 循环变量)
    调用记录集.未知支持库函数_39 (相减 (循环变量, 1)).加入项目 (项目值 [循环变量])
.计次循环尾 ()

.子程序 _项目列框_列表项被选择, 空白型, , 
.局部变量 被选项值, 整数型, , , 

赋值 (.标题, .取项目文本 (.现行选中项))
赋值 (被选项值, .取项目数值 (.现行选中项)) ' 取出设置条件的值
连续赋值 (“”, .内容, .内容) ' 清空数据
赋值 (.今天, 取现行时间 ())
连续赋值 (假, .可视, .可视, .可视, .禁止) ' 先全部隐藏
.如果真 (等于 (取文本左边 (到文本 (被选项值), 1), “1”)) ' 取被选项目的第1位是1说明该显示编辑框
    .如果 (等于 (取文本右边 (到文本 (被选项值), 1), “1”)) ' 取被选项目的第2位是1说明是整数输入方式
        赋值 (.输入方式, 3)
    .否则
        赋值 (.输入方式, 0)
    .如果结束
    条件开关 (到数值 (取文本中间 (到文本 (被选项值), 2, 1))) ' ' 取被选项目的第3位将值作为条件开关的参数
    赋值 (.可视, 真)
.如果真结束
.判断开始 (等于 (被选项值, 2))
    赋值 (.可视, 真)
    条件开关 (1)
    赋值 (.禁止, 真)
    配置文件到组合框 (.标题)
.判断 (等于 (被选项值, 3))
    赋值 (.可视, 真)
    条件开关 (3)
.默认
    
.判断结束


.子程序 条件开关, 空白型, , 根据被选项的不同状态组合框显示的项目不同
.参数 欲设状态, 整数型, , 

.局部变量 状态数组, 文本型, , "0", 
.局部变量 循环变量, 整数型, , , 

.判断开始 (等于 (欲设状态, 1))
    重定义数组 (状态数组, 假, 2)
    赋值 (状态数组, { “＝”, “≠” })
.判断 (等于 (欲设状态, 2))
    重定义数组 (状态数组, 假, 3)
    赋值 (状态数组, { “＝”, “≠”, “≈” })
.判断 (等于 (欲设状态, 3))
    重定义数组 (状态数组, 假, 7)
    赋值 (状态数组, { “＝”, “≠”, “≈”, “>”, “<”, “≥”, “≤” })
.默认
    
.判断结束
清空 ()
.计次循环首 (取数组成员数 (状态数组), 循环变量)
    状态数组.加入项目 ( [循环变量], )
.计次循环尾 ()
赋值 (.现行选中项, 0)

.子程序 _添条钮_被单击, 空白型, , 
.局部变量 状态值, 文本型, , , 查询的条件开关参数
.局部变量 条件值, 文本型, , , 

.判断开始 (.可视)
    .如果 (等于 (.内容, “≈”)) ' 说明是模糊查询
        赋值 (条件值, 相加 (“'%”, .内容, “%'”)) ' 模糊查询时加上%%
    .否则
        赋值 (条件值, 相加 (“'”, .内容, “'”))
    .如果结束
    
.判断 (.可视)
    赋值 (条件值, 相加 (“'”, .内容, “'”))
.判断 (.可视)
    赋值 (条件值, 时间到文本 (.今天, #日期部分))
.默认
    
.判断结束
.如果真 (或者 (等于 (条件值, “''”), 等于 (条件值, “”))) ' 条件为空时提醒
    提示信息框 (“未输入有效的条件值，请重新输入！”, #标题, 64)
    返回 ()
.如果真结束
相加 (.标题, .内容, 条件值).加入项目 () ' 将条件显示到列表框中
 ' 显示的条件和查询用的条件不一样，如不等于显示为≠，但查询用<>，所有不能简单的加入条件值
赋值 (状态值, 多项选择 (相加 (.现行选中项, 1), “=”, “<>”, “ LIKE ”, “>”, “<”, “>=”, “<=”)) ' 将选择的状态转换成查询用语
赋值 (条件值, 相加 (.标题, 状态值, 条件值))
加入成员 (条件数组, 条件值) ' 将条件逐个加入到条件数组中

.子程序 _确定钮_被单击, 空白型, , 
.局部变量 最终条件, 文本型, , , 将所有添加相加后的终条件
.局部变量 循环变量, 整数型, , , 

.如果真 (等于 (取数组成员数 (条件数组), 0))
    提示信息框 (“未设置任何查询条件，请重新设置后在查询！”, #标题, 64)
    返回 ()
.如果真结束
赋值 (最终条件, 条件数组 [1])
.如果真 (大于 (取数组成员数 (条件数组), 1))
    .计次循环首 (相减 (取数组成员数 (条件数组), 1), 循环变量)
        赋值 (最终条件, 相加 (最终条件, “ AND ”, 条件数组 [相加 (循环变量, 1)]))
         ' 将各个条件用AND连接成最终条件
    .计次循环尾 ()
.如果真结束
.如果真 (是否已创建 (资料浏览窗口))
    资料浏览窗口.销毁 ()
.如果真结束
载入窗口 (资料浏览窗口)
赋值 (资料浏览窗口., 假)
赋值 (循环变量, 数据库到高级表格_有序 (调用记录集, 资料浏览窗口., 0, 最终条件, 真, 1, 0, 资料浏览窗口., 日期字段, 日期字段))
 ' 显示到资料浏览窗口中
.如果真 (等于 (循环变量, 0))
    提示信息框 (相加 (“共计查询到 ”, 到文本 (循环变量), “/条 ”, 调用记录集., #换行符, #换行符, “可以适当放宽设定查询条件后再查询！”), #标题, 64)
    返回 ()
.如果真结束
.如果真 (等于 (提示信息框 (相加 (“共计查询到 ”, 到文本 (循环变量), “/条 ”, 调用记录集., #换行符, #换行符, “点击”, #左引号, “确定”, #右引号, “可浏览查询结果，点击”, #左引号, “取消”, #右引号, “将返回查询状态！”), #标题, 65), 1))
    .如果真 (取反 (浏览资料)) ' 如果浏览权限为假，就不打开浏览窗口
        提示信息框 (“无浏览资料的权限，无法打开资料浏览窗口！”, #标题, 64)
        返回 ()
    .如果真结束
    赋值 (资料浏览窗口., 真)
.如果真结束
_清空钮_被单击 ()

.子程序 _删条钮_被单击, 空白型, , 
.如果真 (等于 (.现行选中项, -1))
    提示信息框 (“未选择需删除的条件项目，请重新选择！”, #标题, 64)
    返回 ()
.如果真结束
删除成员 (条件数组, 相加 (.现行选中项, 1), ) ' 删除条件数组中相应的条件
.删除项目 (.现行选中项) ' 删除条件列表框中相应的条件

.子程序 _清空钮_被单击, 空白型, , 
清除数组 (条件数组) ' 清空所有条件
清空 ()
赋值 (.内容, “”)
赋值 (.现行选中项, -1)
赋值 (.今天, 取现行时间 ())

.子程序 _取消钮_被单击, 空白型, , 
.如果 (是否已创建 (资料浏览窗口))
    .如果 (资料浏览窗口.)
        条件查询窗口.销毁 ()
    .否则
        资料浏览窗口.销毁 ()
    .如果结束
    
.否则
    条件查询窗口.销毁 ()
.如果结束
清除数组 (条件数组) ' 清空条件

.子程序 _条件查询窗口_将被销毁, 空白型, , 
_取消钮_被单击 ()

.窗口程序集 客户信息窗口程序集, , , 

.程序集变量 表头标题, 文本型, , "6", 表格的表头标题
.程序集变量 欲读日期字段, 整数型, , "1", 客户资料和会员资料中的日期字段不同
.子程序 _客户信息窗口_创建完毕, 空白型, , 
.判断开始 (等于 (调用记录集, 导航窗口.))
    赋值 (表头标题, { “客户编号”, “姓 名”, “电话之一”, “电话之二”, “客 户 地 址”, “购买日期” })
    赋值 (欲读日期字段, { 10 })
    条件框加入文本 (1)
    赋值 (客户信息窗口., “IT售后管理系统--客户信息”)
.判断 (等于 (调用记录集, 导航窗口.))
    赋值 (表头标题, { “会员编号”, “姓 名”, “电话之一”, “电话之二”, “会 员 地 址”, “购卡日期” })
    赋值 (欲读日期字段, { 9 })
    条件框加入文本 (2)
    赋值 (客户信息窗口., “IT售后管理系统--会员信息”)
.默认
    
.判断结束
赋值 (.今天, 指定时间 (取年份 (取现行时间 ()), 相减 (取月份 (取现行时间 ()), 3), , , , )) ' 日期初始化到现在日期的3个月前，浏览这3个月的客户信息
客户信息窗口.移动 (相减 (_启动窗口.取用户区宽度 (.), 640), 相减 (_启动窗口.取用户区高度 (.), 362), , ) ' 贴近屏幕右边下方，便于客户查看录入的资料
_条件组框_列表项被选择 ()
_过滤钮_被单击 ()
信息表头初始化 ()
显示动态窗口 (客户信息窗口, 30, 1)
赋值 (., 到数值 (配置项 [2]))

.子程序 _客户信息窗口_将被销毁, 空白型, , 
赋值 (欲读日期字段, {  })

.子程序 信息表头初始化, 空白型, , 
.局部变量 列宽度, 整数型, , "6", 
.局部变量 循环变量, 整数型, , , 

赋值 (列宽度, { 70, 65, 75, 75, 180, 107 })
表格初始化 (24, 调用记录集., 列宽度, 表头标题, , 真, 真, 1)

.子程序 条件框加入文本, 空白型, , 
.参数 调用值, 整数型, , 1为客户窗口调用，2为会员窗口调用

清空 ()
“<全部>”.加入项目 ()
.判断开始 (等于 (调用值, 1))
    “客户编号”.加入项目 ()
    “客户姓名”.加入项目 ()
.判断 (等于 (调用值, 2))
    “会员编号”.加入项目 ()
    “会员姓名”.加入项目 ()
.默认
    
.判断结束
赋值 (.现行选中项, 0)

.子程序 _过滤钮_被单击, 空白型, , 
.局部变量 过滤文本, 文本型, , , 

.如果真 (小于 (.今天, .今天)) ' 时间不能置反
    提示信息框 (“终止日期不可小于起始时间，请重新设定过滤时间！”, #标题, 64)
    赋值 (.今天, 取现行时间 ())
    返回 ()
.如果真结束
赋值 (过滤文本, 相加 (“购买日期>=”, 时间到文本 (.今天, 2), “ AND 购买日期<=”, 时间到文本 (.今天, 2)))
.如果真 (不等于 (.内容, “”))
    赋值 (过滤文本, 相加 (.内容, 多项选择 (.现行选中项, “='”, “ LIKE '%”), .内容, 多项选择 (.现行选中项, “' AND ”, “%' AND ”), 过滤文本))
     ' 利用多项选择（）来实现精确和模糊查询
.如果真结束
调用记录集.未知支持库函数_47 (“”)
数据库到高级表格_有序 (调用记录集, , 0, 过滤文本, 真, 1, 0, , 欲读日期字段, { 5 })

.子程序 _起始日框_选择日期被改变, 空白型, , 
客户信息窗口.重画 () ' 去处弹出日期后的阴影
重画 ()

.子程序 _终止日框_选择日期被改变, 空白型, , 
_起始日框_选择日期被改变 ()

.子程序 _条件组框_列表项被选择, 空白型, , 
.如果 (等于 (.现行选中项, 0))
    赋值 (.内容, “”)
    赋值 (.背景颜色, #银白)
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
    赋值 (.背景颜色, #白色)
    获取焦点 ()
.如果结束


.子程序 _取消钮_被单击, 空白型, , 
销毁 ()

.子程序 _客户信息表格_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_导至单钮_被单击 ()

.子程序 _打印钮_被单击, 空白型, , 
弹出菜单 ()

.子程序 _打印_被选择, 空白型, , 
未知支持库函数_26 ()

.子程序 _打印预览_被选择, 空白型, , 
未知支持库函数_27 ()

.子程序 _导至单钮_被单击, 空白型, , 
.局部变量 导出编号, 文本型, , , 
.局部变量 原编号, 文本型, , , 
.局部变量 循环变量, 整数型, , , 

.如果真 (.) ' 如果可以编辑说明是在编辑状态中，所有不添加到单据
    返回 ()
.如果真结束
.如果真 (小于或等于 (未知支持库函数_3 (), 0))
    提示信息框 (“未选择需导出至表单的资料，请重新选择！”, #标题, 64)
    返回 ()
.如果真结束
赋值 (导出编号, 未知支持库函数_3 ().未知支持库函数_10 (0))
.如果真 (不等于 (导出编号, “”))
    .如果 (等于 (调用窗口, 会员资料窗口))
        .如果真 (是否已创建 (会员资料窗口))
            赋值 (原编号, 会员资料窗口..内容)
            清空数据 (会员资料窗口, 会员资料窗口., 会员资料窗口.)
            .计次循环首 (4, 循环变量)
                赋值 (会员资料窗口. [相加 (循环变量, 1)].内容, 未知支持库函数_3 ().未知支持库函数_10 (循环变量))
                 ' 将客户资料循环加入到会员资料编辑框中
            .计次循环尾 ()
            数据库到高级表格_有序 (导航窗口., 会员资料窗口., 1, 相加 (“客户编号='”, 导出编号, “'”), 真, 1, 0, , , , 9)
             ' 将客户配置加入到会员配置表格中
            赋值 (会员资料窗口..内容, 原编号)
             ' 清空数据会把编号也清除，所有要重新赋值编号
        .如果真结束
        
    .否则
        .如果真 (等于 (调用窗口, 维修登记窗口))
            .如果真 (是否已创建 (维修登记窗口))
                赋值 (原编号, 维修登记窗口..内容)
                清空数据 (维修登记窗口, 维修登记窗口., 维修登记窗口., 维修登记窗口., , 维修登记窗口., 增减时间 (取现行时间 (), #日, 1))
                赋值 (维修登记窗口..内容, 原编号)
                .计次循环首 (5, 循环变量)
                    赋值 (维修登记窗口. [相加 (循环变量, 1)].内容, 未知支持库函数_3 ().未知支持库函数_10 (相减 (循环变量, 1)))
                     ' 将客户资料循环加入到报修登记资料编辑框中
                .计次循环尾 ()
                赋值 (维修登记窗口..今天, 到时间 (未知支持库函数_3 ().未知支持库函数_10 (5)))
                 ' 将购买日期读到日期框中
                维修次数提示 () ' 显示维修次数
            .如果真结束
            
        .如果真结束
        
    .如果结束
    
.如果真结束


.子程序 _客户信息表格_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _导出至单据_被选择, 空白型, , 
_导至单钮_被单击 ()

.窗口程序集 系统配置窗口程序集, , , 

.程序集变量 设置编辑框, 编辑框, , "6", 用于取标记组件的数组
.程序集变量 设置组合框, 组合框, , "5", 
.子程序 _系统配置窗口_创建完毕, 空白型, , 
.局部变量 循环变量, 整数型, , , 

.计次循环首 (6, 循环变量)
    .如果真 (小于或等于 (循环变量, 5))
        赋值 (设置组合框 [循环变量], 取标记组件 (循环变量))
        赋值 (设置组合框 [循环变量], 现行选中项, 到数值 (配置项 [循环变量]))
    .如果真结束
    赋值 (设置编辑框 [循环变量], 取标记组件 (相加 (循环变量, 5)))
    赋值 (设置编辑框 [循环变量], 内容, 配置项 [相加 (循环变量, 5)])
.计次循环尾 ()
显示动态窗口 (系统配置窗口, 30, 1)

.子程序 _默认钮_被单击, 空白型, , 
赋值 (.现行选中项, 1)
赋值 (.内容, “无”)
赋值 (.现行选中项, -1)
赋值 (.内容, 相加 (取运行目录 (), “\BackUP”))
连续赋值 (0, .现行选中项, .现行选中项, .现行选中项)
赋值 (.内容, “US”)
赋值 (.内容, “ME”)
赋值 (.内容, “WD”)
赋值 (.内容, “PR”)

.子程序 _取消钮_被单击, 空白型, , 
销毁 ()

.子程序 _背景浏览钮_被单击, 空白型, , 
.如果真 (打开 ())
    赋值 (.内容, .文件名)
.如果真结束


.子程序 _备份浏钮_被单击, 空白型, , 
.局部变量 备份目录, 文本型, , , 

赋值 (备份目录, 未知支持库函数_2 (“请选择日常备份的文件夹:”, ))
.如果真 (不等于 (备份目录, “”))
    赋值 (.内容, 备份目录)
.如果真结束


.子程序 _保存钮_被单击, 空白型, , 
.局部变量 配置节名, 文本型, , "11", 
.局部变量 循环变量, 整数型, , , 

赋值 (配置节名, { “界面风格”, “菜单风格”, “图片位置”, “维修提示”, “货品隐藏”, “背景图片”, “客户编号”, “会员编号”, “维修编号”, “产品编号”, “备份路径” })
.计次循环首 (6, 循环变量)
    .如果真 (小于或等于 (循环变量, 5))
        写加密配置项 (“系统配置”, 配置节名 [循环变量], 到文本 (设置组合框 [循环变量], 现行选中项))
    .如果真结束
    写加密配置项 (“系统配置”, 配置节名 [相加 (循环变量, 5)], 设置编辑框 [循环变量], 内容)
.计次循环尾 ()
.计次循环首 (11, 循环变量)
    赋值 (配置项 [循环变量], 读加密配置项 (“系统配置”, 配置节名 [循环变量]))
.计次循环尾 ()
提示信息框 (“保存成功，请重新启动软件以使配置生效！”, #标题, 64)
销毁 ()

.子程序 _清背景钮_被单击, 空白型, , 
赋值 (.内容, “无”)
赋值 (.现行选中项, -1)

.窗口程序集 等待窗口程序集, , , 

.子程序 _等待窗口_创建完毕, 空白型, , 
置等待鼠标 ()

.子程序 _等待窗口_将被销毁, 空白型, , 
恢复鼠标 ()


 ' 不属于任何一个程序集、类模块的函数：
