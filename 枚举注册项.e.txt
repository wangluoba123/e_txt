 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 455
    高度 = 309
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 9 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 1 扩展界面支持库一





.DLL命令 打开表项, 整数型, "", "RegOpenKeyA", , 零（ERROR_SUCCESS）表示成功。其他任何值都代表一个错误代码
    .参数 父键句柄, 整数型, , 一个已打开项的句柄，或指定一个标准项名
    .参数 表项名, 文本型, , 欲打开注册表项的名字
    .参数 键句柄, 整数型, 传址, 用于装载打开项的名字的一个变量

.DLL命令 关闭键句柄, 整数型, "", "RegCloseKey", , 
    .参数 句柄, 整数型, , 

.DLL命令 枚举子键, 整数型, "", "RegEnumKeyA", , 
    .参数 句柄, 整数型, , 
    .参数 表项索引, 整数型, , 
    .参数 子键名, 文本型, , 
    .参数 子键长度, 整数型, 传址, 

.DLL命令 枚举键值, 整数型, "", "RegEnumValueA", , 
    .参数 句柄, 整数型, , 
    .参数 表项索引, 整数型, , 
    .参数 子键名, 文本型, , 
    .参数 子键长度, 整数型, 传址, 
    .参数 lpReserved, 整数型, , 未用设为零
    .参数 键值类型, 整数型, , 值的类型
    .参数 键值数据, 字节集, , 
    .参数 键值缓寸, 整数型, 传址, 

.窗口程序集 窗口程序集1, , , 

.程序集变量 键句柄, 空白型, , , 
.子程序 _按钮1_被单击, 空白型, , 
.局部变量 z1, 文本型, , "0", 
.局部变量 z2, 文本型, , "0", 
.局部变量 i, 空白型, , , 

枚举注册表 (3, “Software\Microsoft\Windows\CurrentVersion\RUN”, z1, z2)
.计次循环首 (取数组成员数 (z1), i)
    .插入表项 (z1 [i], , , , ).置标题 (1, z2 [i])
.计次循环尾 ()

根句柄 ＝ -2147483646 ' 1.HKEY_CLASSES_ROOT -2147483648   2. HKEY_CURRENT_USER -2147483647  3.HKEY_LOCAL_MACHINE  -2147483646  4.HKEY_USERS -2147483645
打开表项 (根句柄, “Software\Microsoft\Windows\CurrentVersion\RUN”, 键句柄) ' 获取键句柄
枚举列表 ()
关闭键句柄 (键句柄)

.子程序 asdfasd, 空白型, , 
.局部变量 结果, 空白型, , , 
.局部变量 键名, 文本型, , , 
.局部变量 表项索引, 空白型, , , 
.局部变量 键值, 字节集, , , 

全部删除 ()
.循环判断首 ()
    赋值 (取空白文本 (255))
    赋值 (键值, 取空白字节集 (255))
    赋值 (结果, 枚举键值 (键句柄, 表项索引, 键名, 取文本长度 (键名), 0, 0, 键值, 取字节集长度 (键值)))
    .如果真 (不等于 (结果, 0))
        跳出循环 ()
    .如果真结束
    .插入表项 (键名, , , , ).置标题 (1, 取字节集数据 (键值, 10))
    赋值 (表项索引, 相加 (表项索引, 1))
.循环判断尾 (等于 (结果, 0))
输出调试文本 (到文本 (取表项数 ()))

.子程序 枚举注册表, 空白型, , 
.参数 根目录, 空白型, , 1.HKEY_CLASSES_ROOT  2. HKEY_CURRENT_USER  3.HKEY_LOCAL_MACHINE  4.HKEY_USERS
.参数 注册表目录, 文本型, , 最后一个不能为\或/
.参数 注册项名称, 文本型, 数组, 在此处存放变量以请用循环取出
.参数 注册项值, 文本型, 数组, 在此处存放变量以请用循环取出

.局部变量 键名, 文本型, , , 
.局部变量 键值, 字节集, , , 
.局部变量 结果, 空白型, , , 
.局部变量 i, 空白型, , , 

打开表项 (相加 (-2147483649, 根目录), 注册表目录, )
重定义数组 (注册项名称, 假, 0)
重定义数组 (注册项值, 假, 0)
.循环判断首 ()
    赋值 (键名, 取空白文本 (255))
    赋值 (键值, 取空白字节集 (255))
    赋值 (结果, 枚举键值 (键句柄, i, 键名, 取文本长度 (键名), 0, 0, 键值, 取字节集长度 (键值)))
    .如果真 (不等于 (0))
        跳出循环 ()
    .如果真结束
    加入成员 (注册项名称, 键名)
    加入成员 (注册项值, 取字节集数据 (键值, 10))
    赋值 (i, 相加 (i, 1))
.循环判断尾 (等于 (0))

关闭键句柄 (相加 (-2147483649, 根目录))


 ' 不属于任何一个程序集、类模块的函数：
