 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 584
    高度 = 224
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “网页验证码同步-By:小叶 QQ:690821103”
    帮助文件名 = “”



.常量 CF_BITMAP, "2", , 
.常量 CF_TEXT, "1", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' BmpOperate 42305932-06E6-47a5-AC79-8BDCDC58DF61 2 0 位图操作支持库
 ' HtmlView 5014D8FA6DCA40b68FA626D8183666EB 2 0 超文本浏览框支持库
 ' const 9DEDA17547CF40e085B7C8919B1800AF 1 6 常量支持库





.DLL命令 设置剪贴板数据, 整数型, "", "SetClipboardData", , 返回句柄
    .参数 uFormat, 整数型, , 表示的是要放进剪贴板数据的格式
    .参数 hMem, 整数型, , 表示数据的地址指针

.DLL命令 获取剪贴板数据, 整数型, "", "GetClipboardData", , 返回句柄
    .参数 uFormat, 整数型, , 表示的是要放进剪贴板数据的格式

.DLL命令 打开剪贴板, 整数型, "", "OpenClipboard", , 
    .参数 窗口句柄, 整数型, , 

.DLL命令 关闭剪贴板, 逻辑型, "", "CloseClipboard", , 本函数没有参数，事先应该用OpenClipboard函数打开过剪贴板。

.DLL命令 清空剪贴板, 逻辑型, "", "EmptyClipboard", , 

.DLL命令 ObjectFromLresult, 整数型, "OLEACC.DLL", "", , 
    .参数 lResult, 整数型, , 
    .参数 riid, 字节集, , 
    .参数 wParam, 整数型, , 
    .参数 ppvObject, 对象, , 

.DLL命令 RegisterWindowMessage, 整数型, "", "RegisterWindowMessageA", , ,获取分配给一个字串标识符的消息编号 & C000 到 & FFFF之间的一个消息编号。零意味着出错
    .参数 lpString, 文本型, , 注册消息的名字;

.DLL命令 SendMessageTimeout, 整数型, "", "SendMessageTimeoutA", , 
    .参数 MSG, 整数型, , 
    .参数 hwnd, 整数型, , 
    .参数 wParam, 整数型, , 
    .参数 lParam, 整数型, , 
    .参数 fuFlags, 整数型, , 
    .参数 uTimeout, 整数型, , 
    .参数 lpdwResult, 整数型, 传址, 

.DLL命令 GetWindow, 整数型, "", "GetWindow", , ,获得一个窗口的句柄，该窗口与某源窗口有特定的关系
    .参数 源窗口, 整数型, , 
    .参数 关系, 整数型, , 

.DLL命令 GetClassName, 整数型, "user32.dll", "GetClassNameA", , 
    .参数 句柄, 整数型, , 
    .参数 类名, 文本型, , 
    .参数 文本长度, 整数型, , 

.窗口程序集 窗口程序集1, , , 

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 局部_浏览器句柄, 整数型, , , 

赋值 (局部_浏览器句柄, 取窗口句柄 ())
赋值 (.图片, 网页_验证码同步 (局部_浏览器句柄, “https://passport.baidu.com/?verifypic”)) ' 地址
赋值 (.图片, 网页_验证码同步 (局部_浏览器句柄, “verifypicing”)) ' name
赋值 (.图片, 网页_验证码同步 (局部_浏览器句柄, “verifypic”)) ' id

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 局部_对象, 对象, , , 

赋值 (局部_对象, 未知函数_67174501 (未知函数_67174502 (取窗口句柄 ()))) ' 取得网页文档document对象
局部_对象.方法 (“open”, )
局部_对象.方法 (“write”, “<script language='JavaScript'>function newverifypic(){document.getElementById('verifypic').src='https://passport.baidu.com/?verifypic'}</script><b>QQ群:66137499  欢迎大家进群交流<br><img name='verifypicing'  id='verifypic' src='https://passport.baidu.com/?verifypic' ><a href='javascript:newverifypic();' title='看不清左边的字符'>看不清？</a>”)
局部_对象.方法 (“Close”, )



.程序集 程序集1, , , 

.子程序 取网页对象, 对象, , 
.参数 网页句柄, 整数型, , 

.局部变量 资源编号, 整数型, , , 
.局部变量 消息值, 整数型, , , 
.局部变量 对象, 对象, , , 
.局部变量 类名, 文本型, , , 

赋值 (类名, 取空白文本 (256))
未知函数_167837953 (网页句柄, 类名, 256)
.如果真 (不等于 (类名, “Internet Explorer_Server”))
    返回 (对象)
.如果真结束
赋值 (消息值, 未知函数_167837954 (“WM_HTML_GETOBJECT”))
未知函数_167837955 (网页句柄, 消息值, 0, 0, 2, 1000, 资源编号)
未知函数_167837956 (资源编号, { 32, 197, 111, 98, 30, 164, 207, 17, 167, 49, 0, 160, 201, 8, 38, 55 }, 0, 对象)
返回 (对象)

.子程序 取网页句柄, 整数型, , 
.参数 浏览框句柄, 整数型, , 

.局部变量 hwnd, 整数型, , , 
.局部变量 类名, 文本型, , , 
.局部变量 次数, 整数型, , , 防止死循环

赋值 (hwnd, 浏览框句柄)
.判断循环首 (不等于 (类名, “Internet Explorer_Server”))
    赋值 (hwnd, 未知函数_167837957 (hwnd, #))
    赋值 (类名, 取空白文本 (256))
    未知函数_167837953 (hwnd, 类名, 256)
    赋值 (次数, 相加 (次数, 1))
    .如果真 (大于 (次数, 10))
        返回 (-1)
    .如果真结束
    
.判断循环尾 ()
返回 (hwnd)

.子程序 复制图片到剪贴板, 空白型, , 原作：Mikkee 在此感谢
.参数 图片数据, 字节集, , 

.局部变量 图片, 对象, , , 
.局部变量 图片句柄, 整数型, , , 


图片.创建图片对象 (图片数据)
赋值 (图片句柄, 图片.读数值属性 (“Handle”, ))

未知函数_167837958 (取窗口句柄 ())
未知函数_167837959 ()
未知函数_167837961 ()

.子程序 从剪贴板取位图, 字节集, , 原作：Mikkee 再次感谢
.局部变量 图片, 位图, , , 
.局部变量 图片句柄, 整数型, , , 

未知函数_167837958 (取窗口句柄 ())
赋值 (图片句柄)

.子程序 网页_验证码同步, 字节集, 公开, 不但支持地址,还支持name,id....也不但支持验证码,还支持其它的图片
.参数 浏览器句柄, 整数型, , 
.参数 验证码地址_名称_ID_索引, 文本型, , 网页验证码图片的地址(如:https://passport.baidu.com/?verifypic)、名称、ID、索引；索引从1开始；

.局部变量 局部_图片对象, 对象, , , 
.局部变量 局部_临时对象, 对象, , , 
.局部变量 剪切板暂存文本, 文本型, , , 
.局部变量 数据类型, 整数型, , , 1.文本 2.图片
.局部变量 剪切板暂存图片, 字节集, , , 
.局部变量 返回的字节集, 字节集, , , 
.局部变量 Index, 整数型, , , 
.局部变量 局部_循环次数, 整数型, , , 
.局部变量 局部_对象集合, 对象, , , 
.局部变量 局部_对象, 对象, , , 
.局部变量 IES句柄, 整数型, , , 
.局部变量 Object, 对象, , , 
.局部变量 局部_类型, 文本型, , , 
.局部变量 i, 整数型, , , 

赋值 (IES句柄, 取网页句柄 (浏览器句柄)) ' 取得Internet Explorer_Server的句柄
赋值 (Object, 未知函数_67174686 (IES句柄)) ' 取得网页文档document对象
.如果 (不等于 (寻找文本 (验证码地址_名称_ID_索引, “.”, , 假), -1)) ' 判断是否为地址
    .计次循环首 (2, i) ' 通过枚举对象属性判断那个对象的src属性是这个地址..从而得到对象
        赋值 (局部_类型, 多项选择 (i, “img”, “image”))
        赋值 (局部_对象集合, Object.读对象型属性 (“getElementsByTagName”, 局部_类型))
        赋值 (局部_循环次数, 局部_对象集合.读数值属性 (“length”, ))
        .计次循环首 ()
            赋值 (“item”.对象型方法 (相减 (1)))
             ' 调试输出 (局部_对象.读文本属性 (“src”, ))
            .如果真 (近似等于 (“src”.读文本属性 (), ))
                赋值 ()
                跳出循环 ()
            .如果真结束
            
        .计次循环尾 ()
        .如果真 (取反 (局部_图片对象.是否为空 ())) ' 如果这次得到的对象为空.则进行第二次的枚举.如果不为空则跳出循环
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
.否则
    赋值 (局部_图片对象, Object.对象型方法 (“getElementById”, 验证码地址_名称_ID_索引)) ' 根据验证码的ID取得这个对象
    
.如果结束

.如果真 (取反 (局部_图片对象.是否为空 ())) ' 判断当前对象是否为空.如果不为空则取图片
    .如果 (不等于 (取剪辑板文本 (), “”)) ' 备份剪切板数据,判断当前的剪辑板是文字还是图片
        赋值 (取剪辑板文本 ())
        赋值 ()


 ' 不属于任何一个程序集、类模块的函数：
