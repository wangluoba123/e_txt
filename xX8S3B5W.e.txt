 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 310
    高度 = 242
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\xX8S3B5W.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “CS1.6 多功能启动器 [Ray]”
    帮助文件名 = “”

窗口 CS启动参数提示
    左边 = 50
    顶边 = 50
    宽度 = 484
    高度 = 286
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 真
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “CS启动参数提示”
    帮助文件名 = “”

窗口 搜索CS
    左边 = 50
    顶边 = 50
    宽度 = 230
    高度 = 157
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “搜索CS文件所在位置”
    帮助文件名 = “”



.图片 关加速, " ' 已保存到：D:\易语言学习\Data\xX8S3B5W.e\关加速", , 
.图片 恢复加速, " ' 已保存到：D:\易语言学习\Data\xX8S3B5W.e\恢复加速", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库



 ' 所需要的模块
 ' 多线程模块 g:\我的文档\桌面\Ray易\模块\多线程.ec


.全局变量 cs地址, 文本型, , , 

.窗口程序集 窗口程序集1, , , 

.子程序 _按钮6_被单击, 空白型, , 
打开 ()
.判断开始 (不等于 (寻找文本 (.文件名, “cstrike.exe”, , 假), -1))
    赋值 (.内容, .文件名)
.判断 (不等于 (寻找文本 (.文件名, “hl.exe”, , 假), -1))
    赋值 (.内容, .文件名)
.默认
    
.判断结束


.子程序 _按钮3_被单击, 空白型, , 
未知支持库函数_55 (9, 2)

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 ray, 未知类型0x2000A, , "0", 
.局部变量 变量, 整数型, , , 
.局部变量 分辨率数组, 文本型, , "0", 
.局部变量 分辨率, 文本型, , , 
.局部变量 变量1, 整数型, , , 
.局部变量 分辨率重复, 逻辑型, , , 

赋值 (ray, 未知支持库函数_67 ())
.计次循环首 (取数组成员数 (ray), 变量)
    赋值 (分辨率, 相加 (到文本 (ray [变量], ), “x”, 到文本 (ray [变量], )))
    .计次循环首 (取数组成员数 (分辨率数组), 变量1)
        .如果 (等于 (分辨率, 分辨率数组 [变量1]))
            赋值 (分辨率重复, 真)
            跳出循环 ()
        .否则
            赋值 (分辨率重复, 假)
        .如果结束
        
    .计次循环尾 ()
    .如果真 (等于 (分辨率重复, 假))
        加入成员 (分辨率数组, 分辨率)
    .如果真结束
    
.计次循环尾 ()
.计次循环首 (取数组成员数 (分辨率数组), 变量)
    相减 (变量, 1).插入项目 (分辨率数组 [变量], )
.计次循环尾 ()


赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\option.ini”), “参数设置”, “CS路径”, ))
赋值 (.现行选中项, 到整数 (读配置项 (相加 (取运行目录 (), “\option.ini”), “参数设置”, “分辨率”, )))
赋值 (.现行选中项, 到整数 (读配置项 (相加 (取运行目录 (), “\option.ini”), “参数设置”, “刷新率”, )))
赋值 (.现行选中项, 到整数 (读配置项 (相加 (取运行目录 (), “\option.ini”), “参数设置”, “颜色质量”, )))


.如果 (等于 (读配置项 (相加 (取运行目录 (), “\option.ini”), “参数设置”, “-noforcemaccel”, ), “真”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束
.如果 (等于 (读配置项 (相加 (取运行目录 (), “\option.ini”), “参数设置”, “-noforcemparms”, ), “真”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束
.如果 (等于 (读配置项 (相加 (取运行目录 (), “\option.ini”), “参数设置”, “-noforcemspd”, ), “真”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束



判断加速度状态 ()


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 命令行, 文本型, , , 
.局部变量 分辨率, 文本型, , "0", 


.如果 (等于 (.内容, “”))
    信息框 (“请设置CS文件路径地址”, 0, )
.否则
    写配置项 (相加 (取运行目录 (), “\option.ini”), “参数设置”, “CS路径”, .内容)
    写配置项 (相加 (取运行目录 (), “\option.ini”), “参数设置”, “分辨率”, 到文本 (.现行选中项))
    写配置项 (相加 (取运行目录 (), “\option.ini”), “参数设置”, “刷新率”, 到文本 (.现行选中项))
    写配置项 (相加 (取运行目录 (), “\option.ini”), “参数设置”, “颜色质量”, 到文本 (.现行选中项))
    写配置项 (相加 (取运行目录 (), “\option.ini”), “参数设置”, “-noforcemaccel”, 到文本 (.选中))
    写配置项 (相加 (取运行目录 (), “\option.ini”), “参数设置”, “-noforcemparms”, 到文本 (.选中))
    写配置项 (相加 (取运行目录 (), “\option.ini”), “参数设置”, “-noforcemspd”, 到文本 (.选中))
    
    赋值 (分辨率, 分割文本 (.取项目文本 (.现行选中项), “x”, ))
    
    赋值 (命令行, 相加 (“-game cstrike -”, .取项目文本 (.现行选中项), “ -width ”, 分辨率 [1], “ -height ”, 分辨率 [2], “ -freq ”, .取项目文本 (.现行选中项)))
    
    .如果真 (.选中)
        赋值 (命令行, 相加 (命令行, “ ”, .标题))
    .如果真结束
    .如果真 (.选中)
        赋值 (命令行, 相加 (命令行, “ ”, .标题))
    .如果真结束
    .如果真 (.选中)
        赋值 (命令行, 相加 (命令行, “ ”, .标题))
    .如果真结束
    
     ' 未知支持库函数_6 (4, .内容, 命令行, )
 ' .如果结束


.子程序 _按钮9_被单击, 空白型, , 
未知支持库函数_55 (2, 4)

.子程序 _按钮5_被单击, 空白型, , 
载入 (搜索CS, _启动窗口, 假)
赋值 (搜索CS., 真)

.子程序 _按钮4_被单击, 空白型, , 
.如果 (等于 (.标题, “恢复鼠标加速度”))
    .如果真 (等于 (信息框 (“是否要恢复鼠标加速度?”, 相加 (4, 32), “请确认操作”), 5))
        写注册项 (3, “Control Panel\Mouse\SmoothMouseXCurve”, { 0, 0, 0, 0, 0, 0, 0, 0, 21, 110, 0, 0, 0, 0, 0, 0, 0, 64, 1, 0, 0, 0, 0, 0, 41, 220, 3, 0, 0, 0, 0, 0, 0, 0, 40, 0, 0, 0, 0, 0 })
        写注册项 (3, “Control Panel\Mouse\SmoothMouseYCurve”, { 0, 0, 0, 0, 0, 0, 0, 0, 184, 94, 1, 0, 0, 0, 0, 0, 205, 76, 5, 0, 0, 0, 0, 0, 205, 76, 24, 0, 0, 0, 0, 0, 0, 0, 56, 2, 0, 0, 0, 0 })
        .如果 (等于 (信息框 (“该操作要重启或注销系统才有用,是否立即注销?”, 相加 (4, 32), “是否立即注销系统”), 5))
            未知支持库函数_8 (3, 真)
        .否则
            判断加速度状态 ()
        .如果结束
        
        
    .如果真结束
    
.否则
    .如果真 (等于 (信息框 (“是否要关闭鼠标加速度?”, 相加 (4, 32), “请确认操作”), 5))
        写注册项 (3, “Control Panel\Mouse\SmoothMouseXCurve”, { 0, 0, 0, 0, 0, 0, 0, 0, 0, 160, 0, 0, 0, 0, 0, 0, 0, 64, 1, 0, 0, 0, 0, 0, 0, 128, 2, 0, 0, 0, 0, 0, 0, 0, 5, 0, 0, 0, 0, 0 })
        写注册项 (3, “Control Panel\Mouse\SmoothMouseYCurve”, { 0, 0, 0, 0, 0, 0, 0, 0, 102, 166, 2, 0, 0, 0, 0, 0, 205, 76, 5, 0, 0, 0, 0, 0, 160, 153, 10, 0, 0, 0, 0, 0, 56, 51, 21, 0, 0, 0, 0, 0 })
        .如果 (等于 (信息框 (“该操作要重启或注销系统才有用,是否立即注销?”, 相加 (4, 32), “是否立即注销系统”), 5))
            未知支持库函数_8 (3, 真)
        .否则
            判断加速度状态 ()
        .如果结束
        
    .如果真结束
    
.如果结束



.子程序 判断加速度状态, 空白型, , 
.局部变量 x, 字节集, , , 
.局部变量 y, 字节集, , , 

赋值 (x, 取字节集注册项 (3, “Control Panel\Mouse\SmoothMouseXCurve”, ))
赋值 (y, 取字节集注册项 (3, “Control Panel\Mouse\SmoothMouseYCurve”, ))
.判断开始 (并且 (等于 (x, { 0, 0, 0, 0, 0, 0, 0, 0, 0, 160, 0, 0, 0, 0, 0, 0, 0, 64, 1, 0, 0, 0, 0, 0, 0, 128, 2, 0, 0, 0, 0, 0, 0, 0, 5, 0, 0, 0, 0, 0 }), 等于 (y, { 0, 0, 0, 0, 0, 0, 0, 0, 102, 166, 2, 0, 0, 0, 0, 0, 205, 76, 5, 0, 0, 0, 0, 0, 160, 153, 10, 0, 0, 0, 0, 0, 56, 51, 21, 0, 0, 0, 0, 0 })))
    赋值 (.标题, “鼠标加速:已关”)
    赋值 (.文本颜色, #绿色)
    赋值 (.标题, “恢复鼠标加速度”)
.判断 (并且 (等于 (x, { 0, 0, 0, 0, 0, 0, 0, 0, 21, 110, 0, 0, 0, 0, 0, 0, 0, 64, 1, 0, 0, 0, 0, 0, 41, 220, 3, 0, 0, 0, 0, 0, 0, 0, 40, 0, 0, 0, 0, 0 }), 等于 (y, { 0, 0, 0, 0, 0, 0, 0, 0, 184, 94, 1, 0, 0, 0, 0, 0, 205, 76, 5, 0, 0, 0, 0, 0, 205, 76, 24, 0, 0, 0, 0, 0, 0, 0, 56, 2, 0, 0, 0, 0 })))
    赋值 (.标题, “鼠标加速:未关”)
    赋值 (.文本颜色, #黄色)
    赋值 (.标题, “关闭鼠标加速度”)
.默认
    赋值 (.标题, “鼠标加速:未知”)
    赋值 (.文本颜色, #红色)
    赋值 (.标题, “恢复鼠标加速度”)
.判断结束


.子程序 _按钮7_被单击, 空白型, , 
未知支持库函数_6 (“IEXPLORE”, “http://www.o3o4o5.com/”, )


.窗口程序集 窗口程序集2, , , 

.子程序 _按钮1_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集3, , , 

.程序集变量 文件名, 文本型, , , 
.程序集变量 驱动器, 文本型, , , 
.程序集变量 退出循环, 逻辑型, , , 
.程序集变量 线程句柄, 整数型, , , 
.子程序 a, 空白型, , 
.局部变量 文件列表, 文本型, , , 
.局部变量 变量, 空白型, , , 

赋值 (退出循环, 假)
赋值 (.禁止, 真)
搜索 (相加 (.驱动器, “:\”))
.如果真 (等于 (.内容, 相加 (.驱动器, “:\”)))
    赋值 (.内容, “没有找到CS文件”)
.如果真结束
赋值 (.禁止, 假)
赋值 (.禁止, 假)

.子程序 搜索, 空白型, , 
.参数 目录, 文本型, , 

处理事件 ()
.如果真 (不等于 (取文本右边 (目录, 1), “\”))
    赋值 (目录, 相加 (目录, “\”))
.如果真结束
赋值 (文件名, 寻找文件 (相加 (目录, “*”), 55))
.判断循环首 (并且 (不等于 (文件名, “”), 不等于 (退出循环, 真)))
    赋值 (.内容, 相加 (目录, 文件名))
    赋值 (文件名, 寻找文件 (55))
    .如果真 (退出循环)
        跳出循环 ()
    .如果真结束
    .判断循环首 (并且 (不等于 (文件名, “”), 不等于 (退出循环, 真)))
        .如果真 (并且 (不等于 (取文本左边 (文件名, 1), “.”), 不等于 (退出循环, 真)))
            搜索 (相加 (目录, 文件名))
        .如果真结束
        赋值 (文件名, 寻找文件 (55))
        赋值 (.内容, 相加 (目录, 文件名))
        .如果真 (不等于 (寻找文本 (.内容, “cstrike.exe”, , 假), -1))
            .如果真 (等于 (信息框 (相加 (.内容, “ 是否为该文件”), 1, ), 0))
                赋值 (_启动窗口..内容, .内容)
                赋值 (搜索CS., 假)
                赋值 (退出循环, 真)
                跳出循环 ()
            .如果真结束
            
        .如果真结束
        .如果真 (不等于 (寻找文本 (.内容, “hl.exe”, , 假), -1))
            .如果真 (等于 (信息框 (相加 (.内容, “ 是否为该文件”), 1, ), 0))
                赋值 (_启动窗口..内容, .内容)
                赋值 (搜索CS., 假)
                赋值 (退出循环, 真)
                跳出循环 ()
            .如果真结束
            
        .如果真结束
        
    .判断循环尾 ()
    .如果真 (退出循环)
        跳出循环 ()
    .如果真结束
    
.判断循环尾 ()

.子程序 _按钮2_被单击, 空白型, , 
中止线程 (线程句柄)
销毁 ()

.子程序 _按钮3_被单击, 空白型, , 
赋值 (.禁止, 假)
赋值 (退出循环, 真)
赋值 (.禁止, 假)

.子程序 _按钮1_被单击, 空白型, , 
赋值 (.禁止, 真)
赋值 (线程句柄, 建立线程 (&a, 0, 真, 0))

.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 建立线程, 整数型, , 
.参数 子程序指针, 子程序指针, , 提供欲执行的子程序的指针
.参数 子程序参数, 整数型, , 可提供欲执行的子程序的第一个参数，仅支持整数型
.参数 是否立即执行, 逻辑型, , 若此值为假，则建立的线程将被挂起，反之则立即执行
.参数 线程ID, 整数型, 参考, 内核给新生成的线程分配的线程ID。提供参数时只能提供容器



.子程序 运行线程, 空白型, , 运行由＜建立线程＞建立的当前处于挂起状态的线程
.参数 线程句柄, 整数型, , 由＜建立线程＞返回的线程句柄



.子程序 中止线程, 空白型, , 强行中止线程
.参数 线程句柄, 整数型, , 由＜建立线程＞返回的线程句柄




 ' 不属于任何一个程序集、类模块的函数：
