 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 679
    高度 = 422
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “玻璃特效PNG窗口”
    帮助文件名 = “”

窗口 窗口_控件摆放
    左边 = 50
    顶边 = 50
    宽度 = 628
    高度 = 413
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.图片 bj, " ' 已保存到：D:\易语言学习\Data\在清爽透明皮肤上加控件.e\bj", , 
.图片 x1, " ' 已保存到：D:\易语言学习\Data\在清爽透明皮肤上加控件.e\x1", , 
.图片 x2, " ' 已保存到：D:\易语言学习\Data\在清爽透明皮肤上加控件.e\x2", , 
.图片 x3, " ' 已保存到：D:\易语言学习\Data\在清爽透明皮肤上加控件.e\x3", , 
.图片 k1, " ' 已保存到：D:\易语言学习\Data\在清爽透明皮肤上加控件.e\k1", , 
.图片 k2, " ' 已保存到：D:\易语言学习\Data\在清爽透明皮肤上加控件.e\k2", , 
.图片 k3, " ' 已保存到：D:\易语言学习\Data\在清爽透明皮肤上加控件.e\k3", , 
.图片 y1, " ' 已保存到：D:\易语言学习\Data\在清爽透明皮肤上加控件.e\y1", , 
.图片 y2, " ' 已保存到：D:\易语言学习\Data\在清爽透明皮肤上加控件.e\y2", , 
.图片 y3, " ' 已保存到：D:\易语言学习\Data\在清爽透明皮肤上加控件.e\y3", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 2 0 XP风格界面库



 ' 所需要的模块
 ' 彗星真彩控件 $彗星真彩控件模块.ec



.DLL命令 SetWindowLong, 整数型, "user32", "SetWindowLongA", , 在窗口结构中为指定的窗口设置信息　指定数据的前一个值
    .参数 hwnd, 整数型, , 欲为其取得信息的窗口的句柄
    .参数 nIndex, 整数型, , 请参考GetWindowLong函数的nIndex参数的说明
    .参数 dwNewLong, 整数型, , 由nIndex指定的窗口信息的新值;

.DLL命令 GetWindowLong, 整数型, "user32", "GetWindowLongA", , 
    .参数 hwnd, 整数型, , 
    .参数 nIndex, 整数型, , 

.DLL命令 SetLayeredWindowAttributes, 逻辑型, "", "SetLayeredWindowAttributes", , 成功返回真，否则返回假
    .参数 hwnd, 整数型, , 透明窗体的句柄
    .参数 crKey, 整数型, , 颜色值
    .参数 bAlpha, 字节型, , 透明度，取值范围是[0,255]
    .参数 dwFlags, 整数型, , 透明方式：LWA_ALPHA(2)时，crKey参数无效，bAlpha参数有效 || LWA_COLORKEY(1)时，bAlpha参数有效而窗体中的所有颜色为crKey的地方将变为透明

.窗口程序集 窗口程序集1, , , 

.程序集变量 真彩按钮, 真彩按钮, , , 
.程序集变量 关闭按钮, 真彩按钮, , , 
.程序集变量 真彩窗口, 真彩窗口, , , 
.程序集变量 匿名程序集变量_929, 空白型, , , 
.程序集变量 a, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
输出调试文本 (“由 cX-Gtk 代码复制合成的哦。。所有权归原代码作者”)
真彩窗口.从句柄创建 (_启动窗口.取窗口句柄 ())
真彩窗口.置图片数据 (#bj)
 ' 真彩按钮.从句柄创建 (按钮1.取窗口句柄 ())
 ' 真彩按钮.置图片 (真彩控件_载入内存图片 (#图片_按钮1), 真彩控件_载入内存图片 (#图片_按钮2), 真彩控件_载入内存图片 (#图片_按钮3))
关闭按钮.从句柄创建 (取窗口句柄 ())
关闭按钮.置图片数据 (#x1, #x2, #x3)
关闭按钮.从句柄创建 (取窗口句柄 ())
关闭按钮.置图片数据 (#k1, #k2, #k3)
关闭按钮.从句柄创建 (取窗口句柄 ())
关闭按钮.置图片数据 (#y1, #y2, #y3)
真彩窗口.刷新子控件 ()

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _按钮4_被单击, 空白型, , 
赋值 (., 2)

.子程序 __启动窗口_位置被改变, 空白型, , 
.如果真 (等于 (a, 1))
    __启动窗口_创建完毕 ()
.如果真结束
.如果 (等于 (., 2))
    赋值 (a, 1)
.否则
    赋值 (a, 0)
.如果结束

.如果真 (等于 (是否已创建 (窗口_控件摆放), 真))
    窗口_控件摆放.移动 (_启动窗口., _启动窗口., , )
.如果真结束




.子程序 __启动窗口_首次激活, 空白型, , 
载入 (窗口_控件摆放, _启动窗口, 假)

.类模块 真彩图片框, , , By:(彬)泪闯天涯

.子程序 置提示文本, 空白型, , 
.参数 提示文本内容, 文本型, , 
.参数 跟随鼠标, 逻辑型, 可空, 



.子程序 移动, 空白型, , 英文名称：move,改变窗口或窗口组件的位置或尺寸。
.参数 左边, 整数型, 可空, 单位为像素点。如被省略则不改变左边原位置。
.参数 顶边, 整数型, 可空, 单位为像素点。如被省略则不改变顶边原位置。
.参数 宽度, 整数型, 可空, 单位为像素点。如被省略则不改变宽度原位置。
.参数 高度, 整数型, 可空, 单位为像素点。如被省略则不改变高度原位置。
.参数 禁止重绘, 逻辑型, 可空, 



.子程序 取窗口句柄, 整数型, , 


.子程序 是否已创建, 逻辑型, , 


.子程序 重画, 空白型, , 英文名称：invalidate,通知 Windows 系统本窗口或窗口组件上的显示内容需要在以后被全部重画。本命令为初级对象成员命令。


.子程序 发送消息, 整数型, , 
.参数 wMsg, 整数型, , 消息的标识符
.参数 wParam, 整数型, , 具体取决于消息
.参数 lParam, 整数型, , 具体取决于消息;



.子程序 创建, 整数型, , 动态创建一个“真彩图片框”控件，创建成功返回窗口句柄，失败返回0
.参数 父窗口句柄, 整数型, , 
.参数 左边, 整数型, , 
.参数 顶边, 整数型, , 
.参数 宽度, 整数型, , 
.参数 高度, 整数型, , 



.子程序 从句柄创建, 空白型, , 从现有控件创建一个“真彩图片框”
.参数 窗口句柄, 整数型, , 
.参数 图片句柄, 整数型, 可空, 可通过“真彩控件_载入图片”或“真彩控件_载入内存图片”取得图片句柄



.子程序 置图片, 空白型, , 
.参数 图片句柄, 整数型, 可空, 



.子程序 置图片数据, 空白型, , 
.参数 图片字节集, 字节集, , 



.子程序 置显示方式, 空白型, , 指定图片框上图片的显示方式。0.图片居左上,1.缩放图片,2.图片居中
.参数 显示方式, 整数型, , 0.图片居左上,1.缩放图片,2.图片居中



.类模块 真彩按钮, , , By:(彬)泪闯天涯

.子程序 置提示文本, 空白型, , 
.参数 提示文本内容, 文本型, , 
.参数 跟随鼠标, 逻辑型, 可空, 



.子程序 移动, 空白型, , 英文名称：move,改变窗口或窗口组件的位置或尺寸。
.参数 左边, 整数型, 可空, 单位为像素点。如被省略则不改变左边原位置。
.参数 顶边, 整数型, 可空, 单位为像素点。如被省略则不改变顶边原位置。
.参数 宽度, 整数型, 可空, 单位为像素点。如被省略则不改变宽度原位置。
.参数 高度, 整数型, 可空, 单位为像素点。如被省略则不改变高度原位置。
.参数 禁止重绘, 逻辑型, 可空, 



.子程序 取窗口句柄, 整数型, , 


.子程序 是否已创建, 逻辑型, , 


.子程序 重画, 空白型, , 英文名称：invalidate,通知 Windows 系统本窗口或窗口组件上的显示内容需要在以后被全部重画。本命令为初级对象成员命令。


.子程序 发送消息, 整数型, , 
.参数 wMsg, 整数型, , 消息的标识符
.参数 wParam, 整数型, , 具体取决于消息
.参数 lParam, 整数型, , 具体取决于消息;



.子程序 创建, 整数型, , 动态创建一个“真彩按钮”控件，创建成功返回窗口句柄，失败返回0
.参数 父窗口句柄, 整数型, , 
.参数 左边, 整数型, , 
.参数 顶边, 整数型, , 
.参数 宽度, 整数型, , 
.参数 高度, 整数型, , 
.参数 标题, 文本型, 可空, 



.子程序 从句柄创建, 空白型, , 从现有控件创建一个“真彩按钮”
.参数 窗口句柄, 整数型, , 
.参数 图片句柄, 整数型, 可空, 设置按钮默认状态下的图片句柄，可通过“真彩控件_载入图片”或“真彩控件_载入内存图片”取得图片句柄



.子程序 置图片, 空白型, , 
.参数 正常图片, 整数型, 可空, 
.参数 点燃图片, 整数型, 可空, 
.参数 按下图片, 整数型, 可空, 
.参数 禁止图片, 整数型, 可空, 



.子程序 置图片数据, 空白型, , 
.参数 正常图片, 字节集, 可空, 
.参数 点燃图片, 字节集, 可空, 
.参数 按下图片, 字节集, 可空, 
.参数 禁止图片, 字节集, 可空, 



.子程序 置显示方式, 空白型, , 指定按钮图片的显示方式。0.图片居左上,1.缩放图片,2.图片居中
.参数 显示方式, 整数型, , 0.图片居左上,1.缩放图片,2.图片居中



.类模块 真彩窗口, , , By:(彬)泪闯天涯

.子程序 从句柄创建, 逻辑型, , 
.参数 窗口句柄, 整数型, , 



.子程序 置图片, 逻辑型, , 设置一个PNG图片当窗口外形，支持透明通道。注意：设置之后子控件将无法显示
.参数 图片句柄, 整数型, , 可通过“真彩控件_载入图片”或“真彩控件_载入内存图片”取得图片句柄



.子程序 置图片数据, 逻辑型, , 
.参数 图片字节集, 字节集, , 



.子程序 刷新子控件, 空白型, , 


.子程序 移动, 空白型, , 英文名称：move,改变窗口或窗口组件的位置或尺寸。
.参数 左边, 整数型, 可空, 单位为像素点。如被省略则不改变左边原位置。
.参数 顶边, 整数型, 可空, 单位为像素点。如被省略则不改变顶边原位置。
.参数 宽度, 整数型, 可空, 单位为像素点。如被省略则不改变宽度原位置。
.参数 高度, 整数型, 可空, 单位为像素点。如被省略则不改变高度原位置。
.参数 禁止重绘, 逻辑型, 可空, 



.子程序 取窗口句柄, 整数型, , 


.子程序 是否已创建, 逻辑型, , 


.子程序 发送消息, 整数型, , 
.参数 wMsg, 整数型, , 消息的标识符
.参数 wParam, 整数型, , 具体取决于消息
.参数 lParam, 整数型, , 具体取决于消息;



.类模块 真彩编辑框, , , 暂时只支持单行文本。By:(彬)泪闯天涯

.子程序 置提示文本, 空白型, , 
.参数 提示文本内容, 文本型, , 
.参数 跟随鼠标, 逻辑型, 可空, 



.子程序 移动, 空白型, , 英文名称：move,改变窗口或窗口组件的位置或尺寸。
.参数 左边, 整数型, 可空, 单位为像素点。如被省略则不改变左边原位置。
.参数 顶边, 整数型, 可空, 单位为像素点。如被省略则不改变顶边原位置。
.参数 宽度, 整数型, 可空, 单位为像素点。如被省略则不改变宽度原位置。
.参数 高度, 整数型, 可空, 单位为像素点。如被省略则不改变高度原位置。
.参数 禁止重绘, 逻辑型, 可空, 



.子程序 取窗口句柄, 整数型, , 


.子程序 是否已创建, 逻辑型, , 


.子程序 重画, 空白型, , 英文名称：invalidate,通知 Windows 系统本窗口或窗口组件上的显示内容需要在以后被全部重画。本命令为初级对象成员命令。


.子程序 发送消息, 整数型, , 
.参数 wMsg, 整数型, , 消息的标识符
.参数 wParam, 整数型, , 具体取决于消息
.参数 lParam, 整数型, , 具体取决于消息;



.子程序 从句柄创建, 空白型, , 从现有控件创建一个“真彩按钮”
.参数 窗口句柄, 整数型, , 



.子程序 置背景颜色, 空白型, , 
.参数 背景颜色, 整数型, , -1为透明背景，否则为RGB颜色值
.参数 背景透明度, 整数型, 可空, 0-255



.子程序 置边框颜色, 空白型, , 
.参数 边框颜色, 整数型, , -1为透明边框，否则为RGB颜色值
.参数 边框透明度, 整数型, 可空, 0-255



.子程序 置文本颜色, 空白型, , 
.参数 文本颜色, 整数型, , RGB颜色值



.子程序 置背景图片, 空白型, , 
.参数 图片句柄, 整数型, 可空, 



.子程序 置背景图片数据, 空白型, , 
.参数 图片字节集, 字节集, , 



.子程序 置底图方式, 空白型, , 指定图片框上图片的显示方式。0.图片居左上,1.缩放图片,2.图片居中
.参数 底图方式, 整数型, , 0.图片居左上,1.缩放图片,2.图片居中



.子程序 取内容, 文本型, , 


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 真彩控件_载入图片, 整数型, , 载入指定图片，成功返回图片句柄，失败返回0
.参数 欲被载入的图片, 文本型, , 图片文件名



.子程序 真彩控件_载入内存图片, 整数型, , 载入指定图片，成功返回图片句柄，失败返回0
.参数 欲被载入的图片, 字节集, , 图片数据



.子程序 真彩控件_销毁图片, 空白型, , 
.参数 图片句柄, 整数型, , 



.窗口程序集 窗口程序集2, , , 

.子程序 _窗口_控件摆放_创建完毕, 空白型, , 
未知支持库函数_0 (1)
 ' //////////////////// 这三句代码 使窗口透明 控件不透明
赋值 (窗口_控件摆放., #品红)
SetWindowLong (窗口_控件摆放.取窗口句柄 (), -20, 位或 (GetWindowLong (窗口_控件摆放.取窗口句柄 (), -20), 524288))
SetLayeredWindowAttributes (窗口_控件摆放.取窗口句柄 (), #品红, 200, 1)
 ' ////////////////////


.子程序 _窗口_控件摆放_可否被关闭, 逻辑型, , 
_启动窗口.发送信息 (16, 0, 0) ' #wm_close==16


 ' 不属于任何一个程序集、类模块的函数：
