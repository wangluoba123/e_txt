 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _主窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “I无心人工做室-点卡销售管理系统”
    帮助文件名 = “”

窗口 更换销售员窗口
    左边 = 50
    顶边 = 50
    宽度 = 237
    高度 = 113
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “换班”
    帮助文件名 = “”

窗口 点卡管理窗口
    左边 = 50
    顶边 = 50
    宽度 = 388
    高度 = 126
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “点卡管理”
    帮助文件名 = “”

窗口 销售查询窗口
    左边 = 50
    顶边 = 50
    宽度 = 580
    高度 = 400
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “点卡销售查询”
    帮助文件名 = “”

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 392
    高度 = 279
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 2
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 登陆窗口
    左边 = 50
    顶边 = 50
    宽度 = 286
    高度 = 169
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “登陆窗口”
    帮助文件名 = “”

窗口 自由报表显示窗口
    左边 = 50
    顶边 = 50
    宽度 = 676
    高度 = 514
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “自由报表预览”
    帮助文件名 = “”

窗口 自由报表查询窗口
    左边 = 50
    顶边 = 50
    宽度 = 570
    高度 = 500
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “报表设定窗口”
    帮助文件名 = “”

窗口 用户管理窗口
    左边 = 50
    顶边 = 50
    宽度 = 541
    高度 = 304
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “用户管理”
    帮助文件名 = “”

窗口 日志窗口
    左边 = 50
    顶边 = 50
    宽度 = 448
    高度 = 298
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “系统日志”
    帮助文件名 = “”

窗口 点卡类别窗口
    左边 = 50
    顶边 = 50
    宽度 = 287
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “点卡类别”
    帮助文件名 = “”



.常量 提示信息, "“I无心人工做室”", , 
.图片 启动画面, " ' 已保存到：D:\易语言学习\Data\点卡销售管理.e\启动画面", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' ExtMenu 9909FBB013704cfa8FE7E739DB7172DE 1 5 超级菜单支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库
 ' eDB 46E94341933A462383A4DE26B146322C 1 3 数据库操作支持库




.全局变量 记录集, 未知类型0x50002, , , 1
.全局变量 数据库连接, 未知类型0x50001, , , 
.全局变量 全局_查看权限, 逻辑型, , , 在基本情况录入中使用
.全局变量 全局_增加权限, 逻辑型, , , 在基本情况录入中使用
.全局变量 全局_删除权限, 逻辑型, , , 在基本情况录入中使用
.全局变量 全局_修改权限, 逻辑型, , , 在基本情况录入中使用
.全局变量 全局_查询权限, 逻辑型, , , 在基本情况录入中使用
.全局变量 全局_查看报表, 逻辑型, , , 在基本情况录入中使用
.全局变量 全局_打印报表, 逻辑型, , , 在基本情况录入中使用
.全局变量 全局_查看系统日志, 逻辑型, , , 在基本情况录入中使用
.全局变量 全局_初始化数据库, 逻辑型, , , 在基本情况录入中使用
.全局变量 全局_查改用户权限, 逻辑型, , , 在基本情况录入中使用
.全局变量 使用人, 文本型, , , 1

.窗口程序集 主窗口程序集, , , 

.子程序 __主窗口_创建完毕, 空白型, , 
.局部变量 记录数, 整数型, , , 
.局部变量 变量1, 整数型, , , 
.局部变量 变量2, 整数型, , , 

.如果 (等于 (打开点卡表 (), 真))
    赋值 (记录数, 记录集.)
    记录集.未知支持库函数_34 ()
    全部删除 ()
    .计次循环首 (记录数, 变量2)
        赋值 (变量1, .插入表项 (到文本 (变量2), , , , ))
        变量1.置标题 (1, 记录集读取 (“点卡名称”))
        变量1.置标题 (2, 记录集读取 (“统计数量”))
        变量1.置标题 (3, 记录集读取 (“剩余数量”))
        变量1.置标题 (4, 记录集读取 (“销售数量”))
        变量1.置标题 (5, 记录集读取 (“单价”))
        记录集.未知支持库函数_36 ()
    .计次循环尾 ()
.否则
    信息框 (相加 (“打开数据库错误，原因为：”, 取错误信息 ()), 0, “错误”)
.如果结束
1.置文本 (使用人)
根据不同权限显示不同菜单 ()

.子程序 根据不同权限显示不同菜单, 空白型, , 


.子程序 _退出_被选择, 空白型, , 
销毁 ()

.子程序 _换班_被选择, 空白型, , 
 ' 载入 (更换销售员窗口, , 真)

.子程序 _点卡类别_被选择, 空白型, , 
载入 (点卡类别窗口, , 真)

.子程序 _添加点卡_被选择, 空白型, , 
载入 (点卡管理窗口, , 真)

.子程序 _销售查询_被选择, 空白型, , 
载入 (销售查询窗口, , 真)

.子程序 _关于_被选择, 空白型, , 
信息框 (相加 (“  I无心人工作室-点卡销售管理系统 ”, #换行符, #换行符, “   作者：倪建春     QQ：79305495    ”, #换行符, #换行符, “ 版权：I无心人工作室   电话：XXXX-XXXXXXX”), 64, “关于   ”)

.子程序 __主窗口_将被销毁, 空白型, , 
全部关闭 ()

.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.判断开始 (等于 (按钮索引, 0))
    载入 (日志窗口, , 真)
.判断 (等于 (按钮索引, 1))
    载入 (点卡管理窗口, , 真)
.判断 (等于 (按钮索引, 2))
    载入 (销售查询窗口, , 真)
.判断 (等于 (按钮索引, 4))
    载入 (自由报表查询窗口, , 真)
.判断 (等于 (按钮索引, 5))
    载入 (用户管理窗口, , 真)
.判断 (等于 (按钮索引, 7))
    载入 (更换销售员窗口, , 真)
.判断 (等于 (按钮索引, 8))
    .如果真 (等于 (信息框 (“是否退出本系统？”, 相加 (1, 32), “提示”), 0))
        销毁 ()
    .如果真结束
    
.默认
    
.判断结束


.子程序 _超级列表框1_表项被激活, 空白型, , 


.窗口程序集 更换销售员, , , 

.子程序 _取消_被单击, 空白型, , 
销毁 ()

.窗口程序集 启动窗口程序集, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
未知支持库函数_0 (2)
赋值 (., #启动画面) ' 这里通过向导程序修改
赋值 (.内容, “I无心人工作室-点卡管理”) ' 这里更换名称
相除 (相减 (., .宽度), 2).移动 (相减 (., 50), , )
赋值 (.时钟周期, 3000)
.判断开始 (等于 (文件是否存在 (相加 (取运行目录 (), “\data.mdb”)), 假)) ' 初始化建立数据库数据
    信息框 (“所需数据库不存在！”, 0, )
.默认
    赋值 (数据库连接, )
    赋值 (记录集, )
    数据库连接.未知支持库函数_1 (相加 (取运行目录 (), “\data.mdb”), “qq79305495”)
    记录集.未知支持库函数_12 (数据库连接)
.判断结束


.子程序 _时钟1_周期事件, 空白型, , 
_启动窗口.销毁 ()

.子程序 __启动窗口_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.子程序 _图片框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.子程序 __启动窗口_将被销毁, 空白型, , 
赋值 (.时钟周期, 0)
载入 (登陆窗口, , 真)

.窗口程序集 登陆窗口程序集, , , 

.子程序 _确定按钮_被单击, 空白型, , 
.局部变量 密码, 文本型, , , 
.局部变量 用户名称, 文本型, , , 
.局部变量 核对成功, 逻辑型, , , 

赋值 (用户名称, .内容)
赋值 (密码, .内容)
.如果 (等于 (打开用户 (), 真))
    记录集.未知支持库函数_34 ()
    .如果真 (等于 (记录集., 0)) ' 判断里面有没有用户名和密码，如果没有写入默认用户名和密码
        记录集.未知支持库函数_17 ()
        记录集.未知支持库函数_20 (“权限”, “1234567890”) ' 这里最好为数据库加上个密码即可
        记录集.未知支持库函数_20 (“用户名称”, “admin”) ' 这里最好为数据库加上个密码即可
        记录集.未知支持库函数_23 (“密码”, 123)
        记录集.未知支持库函数_18 ()
    .如果真结束
    .计次循环首 (记录集., )
        .如果 (并且 (等于 (记录集读取 (“密码”), 密码), 等于 (记录集读取 (“用户名称”), 用户名称)))
            根据数据库取不同权限 (记录集读取 (“权限”))
            赋值 (核对成功, 真)
            跳出循环 ()
        .否则
            赋值 (核对成功, 假)
        .如果结束
        记录集.未知支持库函数_36 ()
    .计次循环尾 ()
    .如果 (等于 (核对成功, 真))
        .如果真 (打开系统日志 ())
            记录集.未知支持库函数_17 ()
            记录集.未知支持库函数_20 (“使用人”, .内容)
            记录集.未知支持库函数_25 (“进入时间”, 取现行时间 (), 0)
            记录集.未知支持库函数_18 ()
            赋值 (使用人, 用户名称)
            载入 (_主窗口, , 真)
        .如果真结束
        
    .否则
        信息框 (“你不是合法用户！”, 48, “错误”)
    .如果结束
    
.否则
    信息框 (“系统库出错！”, 64, “错误”)
.如果结束


.子程序 _取消按钮_被单击, 空白型, , 
登陆窗口.销毁 ()

.子程序 _登陆窗口_创建完毕, 空白型, , 
获取焦点 ()

.子程序 根据数据库取不同权限, 空白型, , 
.参数 权限, 文本型, , 

.判断开始 (不等于 (寻找文本 (权限, “0”, , 假), -1))
    赋值 (全局_查看权限, 真)
.默认
    赋值 (全局_查看权限, 假)
.判断结束
.判断开始 (不等于 (寻找文本 (权限, “1”, , 假), -1))
    赋值 (全局_查询权限, 真)
.默认
    赋值 (全局_查询权限, 假)
.判断结束
.判断开始 (不等于 (寻找文本 (权限, “2”, , 假), -1))
    赋值 (全局_增加权限, 真)
.默认
    赋值 (全局_增加权限, 假)
.判断结束
.判断开始 (不等于 (寻找文本 (权限, “3”, , 假), -1))
    赋值 (全局_修改权限, 真)
.默认
    赋值 (全局_修改权限, 假)
.判断结束
.判断开始 (不等于 (寻找文本 (权限, “4”, , 假), -1))
    赋值 (全局_删除权限, 真)
.默认
    赋值 (全局_删除权限, 假)
.判断结束
.判断开始 (不等于 (寻找文本 (权限, “5”, , 假), -1))
    赋值 (全局_查看报表, 真)
.默认
    赋值 (全局_查看报表, 假)
.判断结束
.判断开始 (不等于 (寻找文本 (权限, “6”, , 假), -1))
    赋值 (全局_打印报表, 真)
.默认
    赋值 (全局_打印报表, 假)
.判断结束
.判断开始 (不等于 (寻找文本 (权限, “7”, , 假), -1))
    赋值 (全局_查看系统日志, 真)
.默认
    赋值 (全局_查看系统日志, 假)
.判断结束
.判断开始 (不等于 (寻找文本 (权限, “8”, , 假), -1))
    赋值 (全局_初始化数据库, 真)
.默认
    赋值 (全局_初始化数据库, 假)
.判断结束
.判断开始 (不等于 (寻找文本 (权限, “9”, , 假), -1))
    赋值 (全局_查改用户权限, 真)
.默认
    赋值 (全局_查改用户权限, 假)
.判断结束


.程序集 公用程序集, , , 

.子程序 打开点卡表, 逻辑型, , 做案手段库
返回 (记录集.未知支持库函数_14 (“点卡表”, #))

.子程序 打开点卡类别, 逻辑型, , 
返回 (记录集.未知支持库函数_14 (“点卡类别”, #))

.子程序 打开BGK, 逻辑型, , 
返回 (记录集.未知支持库函数_14 (“BGK”, #))

.子程序 打开bhrcxk, 逻辑型, , 
返回 (记录集.未知支持库函数_14 (“bhrcxk”, #))

.子程序 打开BHRK, 逻辑型, , 
返回 (记录集.未知支持库函数_14 (“BHRK”, #))

.子程序 打开用户, 逻辑型, , 
返回 (记录集.未知支持库函数_14 (“用户”, #))

.子程序 打开JBK, 逻辑型, , JBK基本库
返回 (记录集.未知支持库函数_14 (“JBK”, #))

.子程序 打开jbpxk, 逻辑型, , 
返回 (记录集.未知支持库函数_14 (“jbpxk”, #))

.子程序 打开lsk, 逻辑型, , 
返回 (记录集.未知支持库函数_14 (“lsk”, #))

.子程序 打开shrcxk, 逻辑型, , 
返回 (记录集.未知支持库函数_14 (“shrcxk”, #))

.子程序 打开SHRK, 逻辑型, , 
返回 (记录集.未知支持库函数_14 (“SHRK”, #))

.子程序 打开xmcxk, 逻辑型, , 根据姓名的临时查询库
返回 (记录集.未知支持库函数_14 (“xmcxk”, #))

.子程序 打开系统日志, 逻辑型, , 系统日志
返回 (记录集.未知支持库函数_14 (“系统日志”, #))

.子程序 打开ZMK, 逻辑型, , 
返回 (记录集.未知支持库函数_14 (“ZMK”, #))

.子程序 记录集读取, 文本型, , 将指定记录读为文本
.参数 字段序号, 整数型, 可空, 序号和名称任选其中一个，序号值从 0 开始
.参数 字段名称, 文本型, 可空, 

.局部变量 单精度变量, 小数型, , , 
.局部变量 双精度变量, 双精度小数型, , , 
.局部变量 整型变量, 整数型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 逻辑变量, 逻辑型, , , 
.局部变量 日期变量, 日期时间型, , , 
.局部变量 文本, 文本型, , , 
.局部变量 l, 空白型, , , 

.判断开始 (不等于 (字段序号, 0))
    
.默认
    .判断开始 (不等于 (字段名称, “”))
        .计次循环首 (记录集., l)
            .判断开始 (等于 (记录集.未知支持库函数_39 (相减 (l, 1)), 字段名称))
                赋值 (字段序号, 相减 (l, 1))
                跳出循环 ()
            .默认
                
            .判断结束
            
        .计次循环尾 ()
    .默认
        
    .判断结束
    
.判断结束
.判断开始 (等于 (记录集.未知支持库函数_43 (字段序号), 4))
    记录集.未知支持库函数_28 (字段序号, 单精度变量)
    赋值 (文本, 到文本 (单精度变量))
.判断 (等于 (记录集.未知支持库函数_43 (字段序号), 5))
    记录集.未知支持库函数_27 (字段序号, 双精度变量)
    赋值 (文本, 到文本 (双精度变量))
.判断 (或者 (等于 (记录集.未知支持库函数_43 (字段序号), 2), 等于 (记录集.未知支持库函数_43 (字段序号), 3)))
    记录集.未知支持库函数_29 (字段序号, 整型变量)
    赋值 (文本, 到文本 (整型变量))
.判断 (等于 (记录集.未知支持库函数_43 (字段序号), 202))
    记录集.未知支持库函数_26 (字段序号, 文本变量)
    赋值 (文本, 文本变量)
.判断 (等于 (记录集.未知支持库函数_43 (字段序号), 11))
    记录集.未知支持库函数_30 (字段序号, 逻辑变量)
    赋值 (文本, 到文本 (逻辑变量))
.判断 (等于 (记录集.未知支持库函数_43 (字段序号), 7))
    记录集.未知支持库函数_31 (字段序号, 日期变量)
    赋值 (文本, 到文本 (日期变量))
.判断 (等于 (记录集.未知支持库函数_43 (字段序号), 203))
    记录集.未知支持库函数_26 (字段序号, 文本变量)
    赋值 (文本, 到文本 (文本变量))
.默认
    
.判断结束
返回 (文本)

.子程序 记录集写入, 逻辑型, , 将制定数据写到指定记录
.参数 字段序号, 整数型, 可空, 序号和名称人选其中一个，序号值从 0 开始
.参数 字段名称, 文本型, 可空, 
.参数 待写入数据, 文本型, , 如果为逻辑值,请用"真\假"表示;如果为时间日期型请填写正确的日期格式

.局部变量 l, 空白型, , , 

.判断开始 (不等于 (字段序号, 0))
    
.默认
    .判断开始 (不等于 (字段名称, “”))
        .计次循环首 (记录集., l)
            .判断开始 (等于 (记录集.未知支持库函数_39 (l), 字段名称))
                赋值 (字段序号, l)
                跳出循环 ()
            .默认
                
            .判断结束
            
        .计次循环尾 ()
    .默认
        
    .判断结束
    
.判断结束
.判断开始 (等于 (记录集.未知支持库函数_43 (字段序号), 4))
    记录集.未知支持库函数_22 (字段序号, 到数值 (待写入数据))
    返回 (真)
.判断 (等于 (记录集.未知支持库函数_43 (字段序号), 5))
    记录集.未知支持库函数_21 (字段序号, 到数值 (待写入数据))
    返回 (真)
.判断 (或者 (等于 (记录集.未知支持库函数_43 (字段序号), 2), 等于 (记录集.未知支持库函数_43 (字段序号), 3)))
    记录集.未知支持库函数_23 (字段序号, 到数值 (待写入数据))
    返回 (真)
.判断 (等于 (记录集.未知支持库函数_43 (字段序号), 202))
    记录集.未知支持库函数_20 (字段序号, 待写入数据)
    返回 (真)
.判断 (等于 (记录集.未知支持库函数_43 (字段序号), 11))
    .判断开始 (等于 (待写入数据, “真”))
        记录集.未知支持库函数_24 (字段序号, 真)
    .默认
        记录集.未知支持库函数_24 (字段序号, 假)
    .判断结束
    返回 (真)
.判断 (等于 (记录集.未知支持库函数_43 (字段序号), 7))
    记录集.未知支持库函数_25 (字段序号, 到时间 (待写入数据), 0)
    返回 (真)
.判断 (等于 (记录集.未知支持库函数_43 (字段序号), 203))
    记录集.未知支持库函数_20 (字段序号, 待写入数据)
    返回 (真)
.默认
    返回 (假)
.判断结束


.子程序 复制符合条件的记录, 逻辑型, , 将当前表中符合条件的记录复制到另外一个表中，注：两个表的结构应该一样。
.参数 原记录集, 未知类型0x50002, , 
.参数 目的记录集, 未知类型0x50002, , 复制到的记录集,不能为当前操作的记录集。
.参数 数据表名, 文本型, , 打算复制到的数据表名
.参数 条件, 文本型, 可空, 符合多个条件则用"and"连接多个条件，和判断语句的条件一样。如果本参数被省略，表示查找所有记录。
.参数 字段数组, 文本型, 可空 数组, 

.局部变量 l, 整数型, , , 
.局部变量 i, 空白型, , , 
.局部变量 符合条件的记录数组, 文本型, , "0", 
.局部变量 是否找到, 逻辑型, , , 
.局部变量 记录号, 空白型, , , 
.局部变量 j, 空白型, , , 

赋值 (记录集, 原记录集)
记录集.未知支持库函数_34 ()
赋值 (是否找到, 记录集.未知支持库函数_45 (条件, #))
.如果 (不等于 (条件, “”))
    .判断开始 (不等于 (取数组下标 (字段数组, ), 0))
        .判断循环首 (等于 (是否找到, 真))
            清除数组 (符合条件的记录数组)
            .计次循环首 (取数组成员数 (字段数组), l)
                加入成员 (符合条件的记录数组, 记录集读取 (相减 (l, 1)))
            .计次循环尾 ()
            赋值 (记录集, 目的记录集)
            记录集.未知支持库函数_12 (数据库连接)
            记录集.未知支持库函数_14 (数据表名, #)
            记录集.未知支持库函数_17 ()
            .计次循环首 (取数组成员数 (符合条件的记录数组), i)
                记录集写入 (相减 (i, 1), , 符合条件的记录数组 [i])
            .计次循环尾 ()
            记录集.未知支持库函数_18 ()
            记录集.未知支持库函数_16 ()
            赋值 (记录集, 原记录集)
            赋值 (j, 1)
            赋值 (是否找到, 记录集.未知支持库函数_46 ())
        .判断循环尾 ()
    .默认
        .判断循环首 (等于 (是否找到, 真))
            清除数组 (符合条件的记录数组)
            .计次循环首 (记录集., l)
                加入成员 (符合条件的记录数组, 记录集读取 (相减 (l, 1)))
            .计次循环尾 ()
            赋值 (记录集, 目的记录集)
            记录集.未知支持库函数_12 (数据库连接)
            记录集.未知支持库函数_14 (数据表名, #)
            记录集.未知支持库函数_17 ()
            .计次循环首 (取数组成员数 (符合条件的记录数组), i)
                记录集写入 (相减 (i, 1), , 符合条件的记录数组 [i])
            .计次循环尾 ()
            记录集.未知支持库函数_18 ()
            记录集.未知支持库函数_16 ()
            赋值 (记录集, 原记录集)
            赋值 (j, 1)
            赋值 (是否找到, 记录集.未知支持库函数_46 ())
        .判断循环尾 ()
    .判断结束
    
.否则
    .判断开始 (不等于 (取数组下标 (字段数组, ), 0))
        .计次循环首 (记录集., )
            清除数组 (符合条件的记录数组)
            .计次循环首 (取数组成员数 (字段数组), l)
                加入成员 (符合条件的记录数组, 记录集读取 (相减 (l, 1)))
            .计次循环尾 ()
            赋值 (记录集, 目的记录集)
            记录集.未知支持库函数_12 (数据库连接)
            记录集.未知支持库函数_14 (数据表名, #)
            记录集.未知支持库函数_17 ()
            .计次循环首 (取数组成员数 (符合条件的记录数组), i)
                记录集写入 (相减 (i, 1), , 符合条件的记录数组 [i])
            .计次循环尾 ()
            记录集.未知支持库函数_18 ()
            记录集.未知支持库函数_16 ()
            赋值 (记录集, 原记录集)
            赋值 (j, 1)
            记录集.未知支持库函数_36 ()
        .计次循环尾 ()
    .默认
        .计次循环首 (记录集., )
            清除数组 (符合条件的记录数组)
            .计次循环首 (记录集., l)
                加入成员 (符合条件的记录数组, 记录集读取 (相减 (l, 1)))
            .计次循环尾 ()
            赋值 (记录集, 目的记录集)
            记录集.未知支持库函数_12 (数据库连接)
            记录集.未知支持库函数_14 (数据表名, #)
            记录集.未知支持库函数_17 ()
            .计次循环首 (取数组成员数 (符合条件的记录数组), i)
                记录集写入 (相减 (i, 1), , 符合条件的记录数组 [i])
            .计次循环尾 ()
            记录集.未知支持库函数_18 ()
            记录集.未知支持库函数_16 ()
            赋值 (记录集, 原记录集)
            赋值 (j, 1)
            记录集.未知支持库函数_36 ()
        .计次循环尾 ()
    .判断结束
    
.如果结束
.判断开始 (等于 (j, 1))
    返回 (真)
.默认
    返回 (假)
.判断结束


.子程序 复制判断记录, 空白型, , 
.参数 原记录集, 未知类型0x50002, , 
.参数 目的记录集, 未知类型0x50002, , 
.参数 数据表名, 文本型, , 
.参数 字段范围, 文本型, 数组, 

.局部变量 i, 空白型, , , 
.局部变量 记录数组, 文本型, , "0", 
.局部变量 l, 空白型, , , 

赋值 (记录集, 原记录集)
清除数组 (记录数组)
.计次循环首 (取数组成员数 (字段范围), i)
    加入成员 (记录数组, 记录集读取 (字段范围 [i]))
.计次循环尾 ()
赋值 (记录集, 目的记录集)
记录集.未知支持库函数_12 (数据库连接)
记录集.未知支持库函数_14 (数据表名, #)
记录集.未知支持库函数_17 ()
.计次循环首 (取数组成员数 (记录数组), l)
    记录集写入 (字段范围 [l], 记录数组 [l])
.计次循环尾 ()
记录集.未知支持库函数_18 ()
记录集.未知支持库函数_16 ()
赋值 (记录集, 原记录集)

.窗口程序集 日志窗口程序集, , , 

.子程序 _日志窗口_创建完毕, 空白型, , 
.局部变量 记录数, 整数型, , , 
.局部变量 变量1, 整数型, , , 
.局部变量 变量2, 整数型, , , 

.如果 (等于 (打开系统日志 (), 真))
    赋值 (记录数, 记录集.)
    记录集.未知支持库函数_34 ()
    全部删除 ()
    .计次循环首 (记录数, 变量2)
        赋值 (变量1, .插入表项 (到文本 (变量2), , , , ))
        变量1.置标题 (1, 记录集读取 (“使用人”))
        变量1.置标题 (2, 记录集读取 (“进入时间”))
        记录集.未知支持库函数_36 ()
    .计次循环尾 ()
.否则
    信息框 (相加 (“打开数据库错误，原因为：”, 取错误信息 ()), 0, “错误”)
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
全部删除 ()
清空 ()

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _日志窗口_将被销毁, 空白型, , 
全部关闭 ()

.窗口程序集 点卡分类窗口程序集, , , 

.子程序 _点卡类别窗口_创建完毕, 空白型, , 
添冲列表 ()

.子程序 添冲列表, 空白型, , 
.局部变量 记录数, 整数型, , , 
.局部变量 变量1, 整数型, , , 

.如果 (等于 (打开点卡类别 (), 真))
    赋值 (记录数, 记录集.)
    记录集.未知支持库函数_34 ()
    全部删除 ()
    .计次循环首 (记录数, 变量1)
        0.插入表项 (记录集读取 (“点卡名称”), , , , )
        记录集.未知支持库函数_36 ()
    .计次循环尾 ()
.否则
    信息框 (相加 (“打开数据库错误，原因为：”, 取错误信息 ()), 0, “错误”)
.如果结束


.子程序 _超级列表框1_左键单击表项, 空白型, , 
赋值 (.内容, .取标题 (., 0))

.子程序 _按钮1_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (“点卡分类名称不能为空”, 16, #提示信息)
    返回 ()
.如果真结束
.如果 (等于 (打开点卡类别 (), 真))
     ' .如果真 (大于或等于 (记录集., 1))
         ' 信息框 (“此点卡已存在!不能重复添加.”, 16, #提示信息)
         ' 记录集.过滤记录 (“”)
         ' 记录集.关闭 ()
         ' 返回 ()
    .如果真结束
    
    记录集.未知支持库函数_34 ()
    .如果真 (等于 (记录集.未知支持库函数_45 (相加 (“点卡名称='”, 到文本 (.内容), “'”), #), 假)) ' 直接查找,如果找到证明此卡号是存在.
        输出调试文本 (“查找成功”)
        “”.未知支持库函数_47 ()
        未知支持库函数_17 ()
        未知支持库函数_34 ()
        “点卡名称”.未知支持库函数_20 (.内容)
        .如果 (未知支持库函数_18 ())
            信息框 (“添加点卡分类成功”, 64)

.子程序 _按钮3_被单击, 空白型, , 
.如果 (等于 (打开点卡类别 (), 真))
     ' 记录集.未知支持库函数_38 (.)
     ' 记录集.未知支持库函数_19 (1)
    记录集.未知支持库函数_18 ()
    .删除表项 (.)
    
.否则
    
.如果结束




 ' 不属于任何一个程序集、类模块的函数：
