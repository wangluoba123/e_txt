 ' 文件类型：Windows窗口程序

 ' 程序名称：飘零网络验证2.1
 ' 程序描述：
 ' 程序作者：飘零
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：2.1
 ' 创建号：2010.5

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 223
    高度 = 328
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “飘零客户端”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 6 系统核心支持库
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库
 ' spec A512548E76954B6E92C21055517615B0 2 1 特殊功能支持库



 ' 所需要的模块
 ' 飘零网络数据库操作模块2.1 C:\Documents and Settings\Administrator\桌面\飘零网络数据库操作模块2.1.ec


.全局变量 ID, 文本型, , , 
.全局变量 pl88, 文本型, , , 
.全局变量 飘零加解密, 飘零加解密, 公开, , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 a10, 文本型, , , 
.程序集变量 b10, 文本型, , "0", 
.程序集变量 c10, 整数型, , , 
.程序集变量 d10, 文本型, , "0", 
.程序集变量 e10, 整数型, , , 
.程序集变量 充值时间, 文本型, , , 
.程序集变量 hle, 小数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 a, 文本型, , , 
.局部变量 b, 文本型, , "0", 
.局部变量 c, 整数型, , , 
.局部变量 d, 文本型, , "0", 
.局部变量 e, 整数型, , , 
.局部变量 a11, 文本型, , , 
.局部变量 a12, 文本型, , , 
.局部变量 a13, 文本型, , "0", 
.局部变量 a14, 整数型, , , 
.局部变量 a15, 文本型, , "0", 
.局部变量 a16, 整数型, , , 
.局部变量 a17, 文本型, , "0", 
.局部变量 a18, 整数型, , , 
.局部变量 a19, 整数型, , , 

未知支持库函数_0 (1)
飘零禁止双开 ()
置随机数种子 ()
赋值 (pl88, 到文本 (取随机数 (100, 999)))
飘零设置传输密码 (“19,91,01,22,52,09”)
.如果 (等于 (飘零初始化网络数据库 (“piaoling.idcqfkj.com”, “piao1.asp”), 真)) ' 记得是填网址，而不是IP
    赋值 (a11, 飘零取版本信息 ())
    赋值 (a12, 飘零查询 (“sys”, “版本,下载地址”, ))
    赋值 (a13, 分割文本 (a12, “々☆”, ))
    赋值 (a14, 取数组成员数 (a13))
    .判断开始 (小于 (a14, 2))
        
    .默认
        赋值 (a15, 分割文本 (a13 [2], “々”, ))
        赋值 (a16, 取数组成员数 (a15))
        .判断开始 (小于 (a16, 2))
            
        .判断 (不等于 (a11, a15 [1]))
            赋值 (a19, 信息框 (“版本不是最新版本，是否要更新”, 4, “提示”))
            .判断开始 (等于 (a19, 5))
                赋值 (a17, 分割文本 (a15 [2], “/”, ))
                赋值 (a18, 取数组成员数 (a17))
                飘零自动更新 (a15 [2], 相加 (取运行目录 (), “\”, a17 [a18]), )
            .默认
                
            .判断结束
            
        .默认
            
        .判断结束
        
    .判断结束
    赋值 (a, 飘零查询 (“sys”, “公告”, ))
    赋值 (b, 分割文本 (a, “々☆”, ))
    赋值 (c, 取数组成员数 (b))
    .判断开始 (大于或等于 (c, 2))
        赋值 (.字体, .字体)
        赋值 (hle, 相除 (“飘”.取高度 (), 2))
        赋值 (.标题, 相加 (“公告：”, b [2]))
        赋值 (.宽度, 相乘 (取文本长度 (.标题), hle))
        赋值 (.左边, .宽度)
        赋值 (.时钟周期, 10)
    .默认
        
    .判断结束
    赋值 (a10, 飘零取时间 ())
    赋值 (b10, 分割文本 (a10, “ ”, ))
    赋值 (c10, 取数组成员数 (b10))
    .判断开始 (小于 (c10, 2))
        
    .默认
        赋值 (d10, 分割文本 (b10 [1], “-”, ))
        赋值 (e10, 取数组成员数 (d10))
        .判断开始 (小于 (e10, 3))
            赋值 (.禁止, 真)
        .默认
            赋值 (充值时间, 相加 (d10 [1], “年”, d10 [2], “月”, d10 [3], “日”))
            调试输出 (充值时间)
            赋值 (d, 分割文本 (充值时间, #换行符, ))
            赋值 (e, 取数组成员数 (d))
            .判断开始 (小于 (e, 2))
                
            .默认
                赋值 (充值时间, d [2])
            .判断结束
            
        .判断结束
        
    .判断结束
    
.否则
    信息框 (相加 (“1.请检查设置是否正确”, #换行符, “2.网络是否正常”, #换行符, “3.是否使用了美国的网络空间，因为美国的网络空间速度慢”, #换行符, “4.数据库中公告不能为空”), 0, 相加 (“错误：”, 飘零取初试化错误信息 ()))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.如果结束
赋值 (.选中, 真)

.子程序 _按钮2_被单击, 空白型, , 
结束 ()

.子程序 _按钮1_被单击, 空白型, , 
赋值 (.禁止, 真)
赋值 (ID, .内容)
.判断开始 (等于 (.内容, “”))
    信息框 (“用户名不能为空”, 0, )
    赋值 (.禁止, 假)
.判断 (等于 (.内容, “”))
    信息框 (“密码不能为空”, 0, )
    赋值 (.禁止, 假)
.默认
    .如果 (等于 (飘零判断查询 (“sys”, “状态”, , , “1”), 真))
        .如果 (等于 (飘零判断查询 (“admin”, “ID”, 相加 (“密码='”, .内容, “'”), , .内容), 真))
            .如果 (等于 (飘零判断查询 (“sys”, “是否免费”, , , “否”), 真))
                .如果 (等于 (飘零判断查询 (“admin”, “ID”, “等级='免费'”, , .内容), 真))
                    信息框 (“你是免费用户，服务器现在没有免费开放”, 0, )
                    赋值 (.禁止, 假)
                .否则
                    .如果 (等于 (飘零判断查询 (“admin”, “ID”, “等级='管理员'”, , .内容), 真))
                        .如果 (飘零修改 (“admin”, 相加 (“是否在线='”, “是”, “'”), 相加 (“ID='”, ID, “'”)))
                            .如果 (等于 (飘零修改 (“admin”, 相加 (“硬盘ID='”, 到文本 (取硬盘特征字 ()), pl88, “'”), 相加 (“ID='”, ID, “'”)), 真))
                                信息框 (“欢迎管理员登陆”, 0, )
                                载入 (窗口1, , 假)
                                _启动窗口.销毁 ()
                            .否则
                                信息框 (“登陆失败”, 0, )
                                赋值 (.禁止, 假)
                            .如果结束
                            
                        .否则
                            信息框 (“登陆失败”, 0, )
                            赋值 (.禁止, 假)
                        .如果结束
                        
                    .否则
                        .判断开始 (等于 (飘零判断查询 (“卡类”, “使用者”, “类型='终身卡'”, , .内容), 真))
                            .如果 (飘零修改 (“admin”, 相加 (“是否在线='”, “是”, “'”), 相加 (“ID='”, ID, “'”)))
                                .如果 (等于 (飘零修改 (“admin”, 相加 (“硬盘ID='”, 到文本 (取硬盘特征字 ()), pl88, “'”), 相加 (“ID='”, ID, “'”)), 真))
                                    信息框 (“欢迎终身卡用户登陆”, 0, )
                                    载入 (窗口1, , 假)
                                    _启动窗口.销毁 ()
                                .否则
                                    信息框 (“登陆失败”, 0, )
                                    赋值 (.禁止, 假)
                                .如果结束
                                
                            .否则
                                信息框 (“登陆失败”, 0, )
                                赋值 (.禁止, 假)
                            .如果结束
                            
                        .判断 (等于 (飘零判断查询 (“卡类”, “使用者”, “类型='记日卡'”, , .内容), 真))
                            记日卡 ()
                        .默认
                            记次卡 ()
                        .判断结束
                        
                    .如果结束
                    
                .如果结束
                
            .否则
                .如果 (飘零修改 (“admin”, 相加 (“是否在线='”, “是”, “'”), 相加 (“ID='”, ID, “'”)))
                    .如果 (等于 (飘零修改 (“admin”, 相加 (“硬盘ID='”, 到文本 (取硬盘特征字 ()), pl88, “'”), 相加 (“ID='”, ID, “'”)), 真))
                        信息框 (“登陆成功，服务器正免费开发中。。。”, 0, )
                        载入 (窗口1, , 假)
                        _启动窗口.销毁 ()
                    .否则
                        信息框 (“登陆失败”, 0, )
                        赋值 (.禁止, 假)
                    .如果结束
                    
                .否则
                    信息框 (“登陆失败”, 0, )
                    赋值 (.禁止, 假)
                .如果结束
                
            .如果结束
            
        .否则
            信息框 (“帐号不存在或密码错误”, 0, )
            赋值 (.禁止, 假)
        .如果结束
        
    .否则
        信息框 (“服务已停止服务”, 0, )
        赋值 (.禁止, 假)
    .如果结束
    
    
.判断结束


.子程序 _编辑框1_获得焦点, 空白型, , 
赋值 (.类型, 1)

.子程序 _编辑框2_获得焦点, 空白型, , 
赋值 (.类型, 1)

.子程序 _按钮3_被单击, 空白型, , 
赋值 (.禁止, 真)
.判断开始 (等于 (.内容, “”))
    信息框 (“帐号不能为空”, 0, )
    赋值 (.禁止, 假)
.判断 (等于 (.内容, “”))
    信息框 (“密码不能为空”, 0, )
    赋值 (.禁止, 假)
.判断 (等于 (.内容, “”))
    信息框 (“密匙不能为空”, 0, )
    赋值 (.禁止, 假)
.默认
    .如果 (等于 (飘零判断查询 (“admin”, “ID”, , , .内容), 真))
        信息框 (“该用户已存在”, 0, )
        赋值 (.禁止, 假)
    .否则
        .如果 (等于 (飘零添加 (“admin”, “ID,密码,等级,qq号,是否在线”, 相加 (“'”, .内容, “'”, “,”, “'”, .内容, “'”, “,”, “'”, “免费”, “'”, “,”, “'”, .内容, “'”, “,”, “'”, “否”, “'”)), 真))
            信息框 (“注册成功”, 0, )
            赋值 (.禁止, 假)
        .否则
            信息框 (“注册失败”, 0, )
            赋值 (.禁止, 假)
        .如果结束
        
    .如果结束
    
.判断结束


.子程序 _按钮4_被单击, 空白型, , 
.局部变量 到期时间, 文本型, , , 
.局部变量 卡xx, 文本型, , , 
.局部变量 ka1, 文本型, , "0", 
.局部变量 ka11, 整数型, , , 
.局部变量 月到期, 文本型, , , 
.局部变量 续1, 文本型, , , 
.局部变量 续2, 文本型, , "0", 
.局部变量 续3, 整数型, , , 

赋值 (.禁止, 真)
.判断开始 (等于 (.选中, 真))
    充vip ()
.判断 (等于 (.选中, 真))
    .判断开始 (等于 (.内容, “”))
        信息框 (“帐号不能为空”, 0, )
        赋值 (.禁止, 假)
    .判断 (等于 (.内容, “”))
        信息框 (“充值卡号不能为空”, 0, )
        赋值 (.禁止, 假)
    .判断 (等于 (.内容, “”))
        信息框 (“密码不能为空”, 0, )
        赋值 (.禁止, 假)
    .默认
        .如果 (等于 (飘零判断查询 (“admin”, “等级”, 相加 (“ID='”, .内容, “'”), , “vip”), 真))
            赋值 (续1, 飘零_查询 (“卡类”, “类型,到期时间”, 相加 (“使用者='”, .内容, “'”), ))
            赋值 (续2, 分割文本 (续1, “々”, ))
            赋值 (续3, 取数组成员数 (续2))
            .判断开始 (小于 (续3, 1))
                
            .判断 (等于 (续2 [1], “终身卡”))
                信息框 (“你是终身卡用户，无需续时，可以永久使用”, 0, )
                赋值 (.禁止, 假)
            .默认
                .如果 (等于 (飘零判断查询 (“卡类”, “卡号”, 相加 (“密码='”, .内容, “'”, “ and ”, “使用者='”, “ ”, “'”), , .内容), 真))
                    .判断开始 (并且 (等于 (续2 [1], “记次卡”), 等于 (续3, 2)))
                        .判断开始 (等于 (到数值 (续2 [2]), 0))
                            .如果 (等于 (飘零删除 (“卡类”, 相加 (“使用者='”, .内容, “'”)), 真))
                                .如果 (等于 (飘零修改 (“admin”, “等级='免费'”, 相加 (“ID='”, .内容, “'”)), 真))
                                    充vip ()
                                .否则
                                    信息框 (“续时失败”, 0, )
                                    赋值 (.禁止, 假)
                                .如果结束
                                
                            .否则
                                信息框 (“续时失败”, 0, )
                                赋值 (.禁止, 假)
                            .如果结束
                            
                        .默认
                            信息框 (“你的卡未到期，请使用完后在续时”, 0, )
                            赋值 (.禁止, 假)
                        .判断结束
                        
                    .判断 (并且 (等于 (续2 [1], “记日卡”), 等于 (续3, 2)))
                        .判断开始 (大于或等于 (取时间间隔 (到时间 (续2 [2]), 到时间 (充值时间), 5), 0))
                            信息框 (“你的卡未到期，请使用完后在续时”, 0, )
                            赋值 (.禁止, 假)
                        .默认
                            .如果 (等于 (飘零删除 (“卡类”, 相加 (“使用者='”, .内容, “'”)), 真))
                                .如果 (等于 (飘零修改 (“admin”, “等级='免费'”, 相加 (“ID='”, .内容, “'”)), 真))
                                    充vip ()
                                .否则
                                    信息框 (“续时失败”, 0, )
                                    赋值 (.禁止, 假)
                                .如果结束
                                
                            .否则
                                信息框 (“续时失败”, 0, )
                                赋值 (.禁止, 假)
                            .如果结束
                            
                        .判断结束
                        
                    .默认
                        
                    .判断结束
                    
                .否则
                    信息框 (“充值失败，你的充值卡不存在或密码错误，或已经被使用”, 0, )
                    赋值 (.禁止, 假)
                .如果结束
                
            .判断结束
            
        .否则
            信息框 (“续时失败，你不是VIP，请充VIP”, 0, )
            赋值 (.禁止, 假)
        .如果结束
        
    .判断结束
    
.默认
    
.判断结束


.子程序 记日卡, 空白型, , 
.局部变量 到期月, 文本型, , , 

赋值 (到期月, 飘零_查询 (“卡类”, “到期时间”, 相加 (“使用者='”, .内容, “'”), ))
.判断开始 (小于 (取时间间隔 (到时间 (到期月), 到时间 (充值时间), 5), 0))
    信息框 (“登陆失败，你的帐号已过期，请充值”, 0, )
.默认
    .如果 (飘零修改 (“admin”, 相加 (“是否在线='”, “是”, “'”), 相加 (“ID='”, ID, “'”)))
        .如果 (等于 (飘零修改 (“admin”, 相加 (“硬盘ID='”, 到文本 (取硬盘特征字 ()), pl88, “'”), 相加 (“ID='”, ID, “'”)), 真))
            信息框 (相加 (“欢迎记日卡用户登陆”, #换行符, “你将在”, 到期月, “过期”), 0, )
            载入 (窗口1, , 假)
            _启动窗口.销毁 ()
        .否则
            信息框 (“登陆失败”, 0, )
            赋值 (.禁止, 假)
        .如果结束
        
    .否则
        信息框 (“登陆失败”, 0, )
        赋值 (.禁止, 假)
    .如果结束
    
.判断结束


.子程序 记次卡, 空白型, , 
.局部变量 dqcs, 文本型, , , 
.局部变量 写11, 文本型, , , 
.局部变量 XX1, 整数型, , , 
.局部变量 X1, 整数型, , , 

赋值 (dqcs, 飘零_查询 (“卡类”, “到期时间”, 相加 (“使用者='”, .内容, “'”), ))
赋值 (XX1, 到整数 (dqcs))
赋值 (X1, 相减 (XX1, 1))
赋值 (写11, 到文本 (X1))
.判断开始 (大于 (XX1, 0))
    .如果 (等于 (飘零修改 (“卡类”, 相加 (“到期时间='”, 写11, “'”), 相加 (“使用者='”, .内容, “'”)), 真))
        .如果 (飘零修改 (“admin”, 相加 (“是否在线='”, “是”, “'”), 相加 (“ID='”, ID, “'”)))
            .如果 (等于 (飘零修改 (“admin”, 相加 (“硬盘ID='”, 到文本 (取硬盘特征字 ()), pl88, “'”), 相加 (“ID='”, ID, “'”)), 真))
                信息框 (相加 (“欢迎记次卡用户登陆”, #换行符, “你还可以用：”, 写11, “次”), 0, )
                载入 (窗口1, , 假)
                _启动窗口.销毁 ()
            .否则
                信息框 (“登陆失败”, 0, )
                赋值 (.禁止, 假)
            .如果结束
            
        .否则
            信息框 (“登陆失败”, 0, )
            赋值 (.禁止, 假)
        .如果结束
        
    .否则
        信息框 (“登陆失败”, 0, )
        赋值 (.禁止, 假)
    .如果结束
    
.默认
    信息框 (“登陆失败，你的帐号已过期，请充值”, 0, )
    赋值 (.禁止, 假)
.判断结束


.子程序 充vip, 空白型, , 
.局部变量 到期时间, 文本型, , , 
.局部变量 卡xx, 文本型, , , 
.局部变量 ka1, 文本型, , "0", 
.局部变量 ka11, 整数型, , , 
.局部变量 月到期, 文本型, , , 

.判断开始 (等于 (.内容, “”))
    信息框 (“帐号不能为空”, 0, )
    赋值 (.禁止, 假)
.判断 (等于 (.内容, “”))
    信息框 (“充值卡号不能为空”, 0, )
    赋值 (.禁止, 假)
.判断 (等于 (.内容, “”))
    信息框 (“密码不能为空”, 0, )
    赋值 (.禁止, 假)
.默认
    .如果 (等于 (飘零判断查询 (“卡类”, “卡号”, 相加 (“密码='”, .内容, “'”, “ and ”, “使用者='”, “ ”, “'”), , .内容), 真))
        .如果 (等于 (飘零判断查询 (“admin”, “等级”, 相加 (“ID='”, .内容, “'”), , “免费”), 真))
            赋值 (卡xx, 飘零_查询 (“卡类”, “类型,总时间”, 相加 (“卡号='”, .内容, “'”, “ and ”, “密码='”, .内容, “'”), ))
            赋值 (ka1, 分割文本 (卡xx, “々”, ))
            赋值 (ka11, 取数组成员数 (ka1))
            .判断开始 (小于 (ka11, 1))
                
            .判断 (等于 (ka1 [1], “终身卡”))
                .如果 (飘零修改 (“卡类”, 相加 (“使用者='”, .内容, “'”, “,”, “充值时间='”, 充值时间, “'”), 相加 (“卡号='”, .内容, “'”, “ and ”, “密码='”, .内容, “'”)))
                    .如果 (等于 (飘零修改 (“admin”, “等级='vip'”, 相加 (“ID='”, .内容, “'”)), 真))
                        信息框 (“充值成功”, 0, )
                        赋值 (.禁止, 假)
                    .否则
                        信息框 (“充值失败”, 0, )
                        赋值 (.禁止, 假)
                    .如果结束
                    
                .否则
                    信息框 (“充值失败”, 0, )
                    赋值 (.禁止, 假)
                .如果结束
                
            .判断 (并且 (等于 (ka1 [1], “记次卡”), 等于 (ka11, 2)))
                .如果 (飘零修改 (“卡类”, 相加 (“使用者='”, .内容, “'”, “,”, “充值时间='”, 充值时间, “'”, “,”, “到期时间='”, ka1 [2], “'”), 相加 (“卡号='”, .内容, “'”, “ and ”, “密码='”, .内容, “'”)))
                    .如果 (等于 (飘零修改 (“admin”, “等级='vip'”, 相加 (“ID='”, .内容, “'”)), 真))
                        信息框 (“充值成功”, 0, )
                        赋值 (.禁止, 假)
                    .否则
                        信息框 (“充值失败”, 0, )
                        赋值 (.禁止, 假)
                    .如果结束
                    
                .否则
                    信息框 (“充值失败”, 0, )
                    赋值 (.禁止, 假)
                .如果结束
                
            .判断 (并且 (等于 (ka1 [1], “记日卡”), 等于 (ka11, 2)))
                赋值 (月到期, 到文本 (增减时间 (到时间 (充值时间), 5, 到整数 (ka1 [2]))))
                .如果 (飘零修改 (“卡类”, 相加 (“使用者='”, .内容, “'”, “,”, “充值时间='”, 充值时间, “'”, “,”, “到期时间='”, 月到期, “'”), 相加 (“卡号='”, .内容, “'”, “ and ”, “密码='”, .内容, “'”)))
                    .如果 (等于 (飘零修改 (“admin”, “等级='vip'”, 相加 (“ID='”, .内容, “'”)), 真))
                        信息框 (“充值成功”, 0, )
                        赋值 (.禁止, 假)
                    .否则
                        信息框 (“充值失败”, 0, )
                        赋值 (.禁止, 假)
                    .如果结束
                    
                .否则
                    信息框 (“充值失败”, 0, )
                    赋值 (.禁止, 假)
                .如果结束
                
            .默认
                信息框 (“你的卡类型不存在”, 0, )
                赋值 (.禁止, 假)
            .判断结束
            
        .否则
            信息框 (“充值失败，你的卡已经是VIP，无需充vip”, 0, )
            赋值 (.禁止, 假)
        .如果结束
        
    .否则
        信息框 (“充值失败，充值卡不存在或密码错误或已经被使用”, 0, )
        赋值 (.禁止, 假)
    .如果结束
    
.判断结束


.子程序 _单选框3_被单击, 空白型, , 
赋值 (.禁止, 假)
赋值 (.内容, “”)
赋值 (.内容, “修改密码，不用填QQ号”)
赋值 (.禁止, 真)

.子程序 _单选框4_被单击, 空白型, , 
赋值 (.禁止, 假)
赋值 (.内容, “”)
赋值 (.内容, “取回密码，此处不用填”)
赋值 (.禁止, 真)

.子程序 _按钮5_被单击, 空白型, , 
赋值 (.禁止, 真)
.判断开始 (等于 (.选中, 真))
    .判断开始 (等于 (.内容, “”))
        信息框 (“帐号不能为空”, 0, )
        赋值 (.禁止, 假)
    .判断 (等于 (.内容, “”))
        信息框 (“旧密码不能为空”, 0, )
        赋值 (.禁止, 假)
    .判断 (等于 (.内容, “”))
        信息框 (“新密码不能为空”, 0, )
        赋值 (.禁止, 假)
    .默认
        .如果 (等于 (飘零判断查询 (“admin”, “密码”, 相加 (“ID='”, .内容, “'”), , .内容), 真))
            .如果 (等于 (飘零修改 (“admin”, 相加 (“密码='”, .内容, “'”), 相加 (“ID='”, .内容, “'”)), 真))
                信息框 (“修改成功，请牢记新密码，下次登陆用新密码”, 0, )
                赋值 (.禁止, 假)
            .否则
                信息框 (“修改失败，旧密码错误或帐号不存在”, 0, )
                赋值 (.禁止, 假)
            .如果结束
            
        .否则
            信息框 (“修改失败，旧密码错误或帐号不存在”, 0, )
            赋值 (.禁止, 假)
        .如果结束
        
    .判断结束
    
.判断 (等于 (.选中, 真))
    .判断开始 (等于 (.内容, “”))
        信息框 (“帐号不能为空”, 0, )
        赋值 (.禁止, 假)
    .判断 (等于 (.内容, “”))
        信息框 (“QQ号不能为空”, 0, )
        赋值 (.禁止, 假)
    .判断 (等于 (.内容, “”))
        信息框 (“新密码不能为空”, 0, )
        赋值 (.禁止, 假)
    .默认
        .如果 (等于 (飘零判断查询 (“admin”, “qq号”, 相加 (“ID='”, .内容, “'”), , .内容), 真))
            .如果 (等于 (飘零修改 (“admin”, 相加 (“密码='”, .内容, “'”), 相加 (“ID='”, .内容, “'”, “ and ”, “qq号='”, .内容, “'”)), 真))
                信息框 (“取回成功，请牢记新密码，下次登陆用新密码”, 0, )
                赋值 (.禁止, 假)
            .否则
                信息框 (“取回失败，QQ号错误或帐号不存在”, 0, )
                赋值 (.禁止, 假)
            .如果结束
            
        .否则
            信息框 (“取回失败，QQ号错误或帐号不存在”, 0, )
            赋值 (.禁止, 假)
        .如果结束
        
    .判断结束
    
.默认
    信息框 (“请选择你要操作的类型”, 0, )
    赋值 (.禁止, 假)
.判断结束


.子程序 _时钟1_周期事件, 空白型, , 
.如果 (等于 (相加 (.左边, .宽度), 0))
    赋值 (.左边, .宽度)
.否则
    
.如果结束
赋值 (.左边, 相减 (.左边, 1))



.窗口程序集 窗口程序集2, , , 

.子程序 _窗口1_将被销毁, 空白型, , 
飘零修改 (“admin”, “是否在线='否'”, 相加 (“ID='”, ID, “'”))

.子程序 _窗口1_创建完毕, 空白型, , 
赋值 (.时钟周期, 相乘 (1000, 60, 5)) ' 5分钟自动刷新是否同时在线

.子程序 _时钟1_周期事件, 空白型, , 
.如果 (等于 (飘零判断查询 (“admin”, “硬盘ID”, 相加 (“ID='”, ID, “'”), , 相加 (到文本 (取硬盘特征字 ()), pl88)), 真))
    
.否则
    信息框 (“你的帐号在别的地方登陆，你被强迫下线”, 0, )
    飘零修改 (“admin”, “是否在线='否'”, 相加 (“ID='”, ID, “'”))
    结束 ()
.如果结束


.类模块 飘零加解密, , , 

.子程序 飘_动态加密, 文本型, , 以动态的方式对文本进行加密.(返回加密后的密文)
.参数 欲加密的文本, 文本型, , 欲加密的文本
.参数 key, 文本型, 可空, 用作加密的密钥 (解密时必须有密钥才能解开密文)



.子程序 飘_动态解密, 文本型, , 以动态的方式对文本进行解密.(返回解密后的文本)
.参数 欲解密的文本, 文本型, , 欲解密的密文
.参数 key, 文本型, 可空, 用作解密的密钥(加密时使用的)



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 执行sql, 文本型, , 数据未经过分割处理,本命令只能用来查询数据
.参数 SQL语句, 文本型, , 要执行的SQL命令如   “select 等级 from admin where ” ＋ “ID” ＋ “='” ＋ 编辑框2.内容 ＋ “'”



.子程序 执行_sql, 文本型, , 本命令只能用来添加，修改，删除数据
.参数 SQL语句, 文本型, , 要执行的SQL命令如   “select 等级 from admin where ” ＋ “ID” ＋ “='” ＋ 编辑框2.内容 ＋ “'”



.子程序 飘零初始化网络数据库, 逻辑型, , 在运用其他命令时先初始化，注：只需初始化一次即可  初始化成功反回真 失败返回假 返回假则可以用取初始化错误信息分析
.参数 服务器地址, 文本型, , 如数据库与ASP文件所在网络路径,如数据库文件为"http://127.0.0.1/piao.MDB",那么地址即为"http://127.0.0.1/"
.参数 连接的ASP文件, 文本型, , ASP文件名,如"piao.ASP"



.子程序 飘零查询, 文本型, , 用于网络数据库的查询数据,数据未经过分割处理
.参数 表名, 文本型, , 要查询的表
.参数 字段名, 文本型, 可空, 要查询的字段，有多个字段请用“，”分开 如：“ID,密码,姓名”
.参数 条件, 文本型, 可空, 以SQL格式输入，如“文本型='文本内容',数值型=数值内容,日期型=#日期内容#” 注意：数字字段不加单引号 如：id=789 ，如果有多条条件则用and连接，and两边要加空格



.子程序 飘零修改, 逻辑型, , 用于网络数据库的修改数据,修改成功返回真 失败返回假 返回假表明SQL语句错误，返回真一般都会修改成功
.参数 表名, 文本型, , 要修改的数据所在的表名
.参数 要修改的内容, 文本型, , 如：欲修改的字段名1='该字段的新值',欲修改的字段名2='该字段的新值'
.参数 条件, 文本型, 可空, 以SQL格式输入，如“文本型='文本内容',数值型=数值内容,日期型=#日期内容#”注意：数字字段不加单引号 如：id=789 ， 如果有多条条件则用and连接，and两边要加空格



.子程序 飘零添加, 逻辑型, , 用于网络数据库的添加数据,添加成功返回真 失败返回假 返回假表明SQL语句错误，返回真一般都会添加成功
.参数 表名, 文本型, , 将数据添加到那个表
.参数 字段名, 文本型, , 将数据添加到表中的哪个字段 多个字段用“,”分开 如：字段1,字段2,字段3
.参数 字段值, 文本型, , 在上字段中添加的值 多个字段加值用“,”分开 一定要用“'”  如：'字段1的值','字段2的值','字段3的值'注意：数字字段不加单引号 如：id=789 ，



.子程序 飘零删除, 逻辑型, , 用于网络数据库的删除数据,删除成功返回真 失败返回假 返回假表明SQL语句错误，返回真一般都会删除成功
.参数 表名, 文本型, , 在那个表中删除数据
.参数 条件, 文本型, 可空, 如果不条件为空则删除整个表中的数据   如：id='12345'  注意：数字字段不加单引号 如：id=789 ，



.子程序 飘零判断查询, 逻辑型, , 用于查询数据是否存在,存在返回真，不存在返回假
.参数 表名, 文本型, , 要查询的数据所在的表名
.参数 字段名, 文本型, , 要查询的数据所在的字段名
.参数 条件, 文本型, 可空, 要查询的数据所符合的条件 SQL语句格式输入 如：id='12345' 注意：数字字段不加单引号 如：id=789 ，
.参数 用做分割的文本, 文本型, 可空, 如果为空则默认文本为“々☆”
.参数 要查询的数据, 文本型, , 要查询的数据，比如说要查询 admin 这个帐号是否存在，则只需输入 admin



.子程序 飘零取字段数, 整数型, , 取指定表中有多少个字段 
.参数 表名, 文本型, , 要取字段数的表
.参数 用做分割的文本1, 文本型, 可空, 一般都为默认 默认为“々☆”
.参数 用做分割的文本2, 文本型, 可空, 一般都为默认 默认为“々”



.子程序 飘零取字段名, 空白型, , 取指定表中的所以字段名
.参数 表名, 文本型, , 要取字段名的表
.参数 用做分割的文本, 文本型, 可空, 一般都为默认 默认为“々☆”
.参数 要保持的字段名变量, 文本型, 数组, 要保存取到字段名的变量



.子程序 飘零_查询, 文本型, , 返回的数据已经经过处理
.参数 表名, 文本型, , 要查询的表
.参数 字段名, 文本型, , 要查询的字段，有多个字段请用“，”分开 如：“ID,密码,姓名” 如果同时查询多个字段则自己分割所查询的结果，查询一个字段则不用
.参数 条件, 文本型, , 以SQL格式输入，如“文本型='文本内容',数值型=数值内容,日期型=#日期内容#”注意：数字字段不加单引号 如：id=789 ， 如果有多条条件则用and连接，and两边要加空格
.参数 用做分割的文本1, 文本型, 可空, 一般都为默认 默认为“々☆”



.子程序 飘零取时间, 文本型, , 取服务上的当前时间 返回服务器上的时间


.子程序 飘零取初试化错误信息, 文本型, , 取初始化错误信息


.子程序 飘零模糊查询, 文本型, , 比如模糊字是三   则可以查询到 张三 ，三， 三角毛，。。。。。。  
.参数 表名, 文本型, , 要查询的表
.参数 字段名, 文本型, , 该字所在的字段名
.参数 模糊字, 文本型, , 要查询的模糊字



.子程序 飘零取记录数, 整数型, , 取记录数
.参数 表名, 文本型, , 要取记录数的表
.参数 条件, 文本型, 可空, 如果条件为空则取表中的总记录数



.子程序 飘零取尾记录, 文本型, , 取数据库指定表中最后一条数据 指定表中必需有自动编号字段
.参数 表名, 文本型, , 要取数据所在的表
.参数 自动编号的字段名, 文本型, , 表中的自动编号的字段名。。如“id”



.子程序 飘零取首记录, 文本型, , 取数据库指定表中第一条数据 指定表中必需有自动编号字段
.参数 表名, 文本型, , 要取数据所在的表



.子程序 飘零倒查询, 文本型, , 查询指定表的数据返回倒排列 也就是从最后一条排到第一条 指定表中必需有自动编号字段
.参数 表名, 文本型, , 要查询的表
.参数 字段名, 文本型, 可空, 要查询的字段，有多个字段请用“，”分开 如：“ID,密码,姓名”
.参数 条件, 文本型, 可空, 以SQL格式输入，如“文本型='文本内容',数值型=数值内容,日期型=#日期内容#”注意：数字字段不加单引号 如：id=789 ， 如果有多条条件则用and连接，and两边要加空格
.参数 自动编号的字段名, 文本型, , 表中的自动编号的字段名。。如“id”



.子程序 飘零设置传输密码, 空白型, , 一定要按这种格式“19,91,01,22”密码只能为数字,第一位不能为9 要和ASP文件里的密码相同,有些密码不行就换过个
.参数 密码, 文本型, 可空, 如果为空则，默认为“19,91,01,22”密码只能为数字,第一位不能为9 要和ASP文件里的密码相同,有些密码不行就换过个



.子程序 飘零禁止双开, 空白型, , 在启动窗口创建完毕后调用此命令


.子程序 飘零取版本信息, 文本型, , 此命令在调试中无效
.参数 类型, 整数型, 可空, 默认为0 （0为取版本号，1为取创建号，2为取版本号和取创建号）



.子程序 飘零自动更新, 空白型, , 更新文件
.参数 下载地址, 文本型, , 下载的网址
.参数 保存文件路径, 文本型, , 下载后文件保存的路径
.参数 任务线程数, 整数型, 可空, 任务启动时默认开启的线程数,默认为1




 ' 不属于任何一个程序集、类模块的函数：
