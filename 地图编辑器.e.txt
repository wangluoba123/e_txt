 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 765
    高度 = 526
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “地图编辑器”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 1 0 数据操作支持库一




数据类型 地形位图数据, , 
    .成员 地形类型, 整数型, , , 

数据类型 坐标, , 
    .成员 X, 整数型, , , 
    .成员 Y, 整数型, , , 

.全局变量 纵格数, 整数型, , , 
.全局变量 横格数, 整数型, , , 
.全局变量 地图宽度, 整数型, , , 
.全局变量 地图高度, 整数型, , , 
.全局变量 X, 整数型, , , 
.全局变量 Y, 整数型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 地形类型位图数据, 地形位图数据, , "6", 
.程序集变量 地形类型数, 整数型, , , 
.程序集变量 现行地形类型, 整数型, , , 
.程序集变量 地形, 整数型, , "0", 
.子程序 RAY, 整数型, , 
.判断开始 (等于 (.选中, 真))
    返回 (1)
.判断 (等于 (.选中, 真))
    返回 (2)
.判断 (等于 (.选中, 真))
    返回 (3)
.判断 (等于 (.选中, 真))
    返回 (4)
.判断 (等于 (.选中, 真))
    返回 (5)
.判断 (等于 (.选中, 真))
    返回 (6)
.默认
    
.判断结束
返回 (0)

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 变量, 整数型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 地址, 文本型, , , 
.局部变量 目录, 文本型, , , 
.局部变量 坐标, 坐标, , , 
.局部变量 变量1, 整数型, , , 

赋值 (目录, 取运行目录 ())
赋值 (地形类型数, 6)
重定义数组 (地形类型位图数据, 假, 地形类型数)
.计次循环首 (地形类型数, 变量)
    赋值 (地址, 相加 (目录, “\P\地形\”, 到文本 (变量), “.jpg”))
    赋值 (地形类型位图数据 [变量], 地形类型, 载入图片 (地址))
    .如果真 (等于 (地形类型位图数据 [变量], 地形类型, 0))
        信息框 (“加载地形位图失败”, 0, )
        结束 ()
    .如果真结束
    
.计次循环尾 ()
赋值 (现行地形类型, 1)
赋值 (地图宽度, .宽度)
赋值 (地图高度, .高度)
赋值 (纵格数, 相除 (地图高度, 16))
赋值 (横格数, 相除 (地图宽度, 16))
重定义数组 (地形, 假, 相乘 (纵格数, 横格数))
赋值 (.初始目录, 取运行目录 ())

.计次循环首 (纵格数, 变量)
    .计次循环首 (横格数, 变量1)
        赋值 (坐标.X, 变量1)
        赋值 (坐标.Y, 变量)
        相乘 (相减 (变量1, 1), 16).定位写出 (相乘 (相减 (变量, 1), 16), 到文本 (地形坐标取地形编号 (坐标)))
    .计次循环尾 ()
.计次循环尾 ()

.子程序 _单选框1_被单击, 空白型, , 
赋值 (现行地形类型, 1)
获取焦点 ()



.子程序 _单选框2_被单击, 空白型, , 
赋值 (现行地形类型, 2)
获取焦点 ()



.子程序 _单选框3_被单击, 空白型, , 
赋值 (现行地形类型, 3)
获取焦点 ()



.子程序 _单选框4_被单击, 空白型, , 
赋值 (现行地形类型, 4)
获取焦点 ()



.子程序 _单选框5_被单击, 空白型, , 
赋值 (现行地形类型, 5)
获取焦点 ()



.子程序 _单选框6_被单击, 空白型, , 
赋值 (现行地形类型, 6)
获取焦点 ()



.子程序 _按钮3_被单击, 空白型, , 
结束 ()


.子程序 _按钮4_被单击, 空白型, , 
.如果真 (等于 (信息框 (“是否清空?”, 相加 (4, 32), “清空确认”), 5))
    0.清除 (0, .宽度, .高度)
    重定义数组 (地形, 假, 相乘 (纵格数, 横格数))
.如果真结束


.子程序 _画板1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 X变量, 整数型, , , 
.局部变量 Y变量, 整数型, , , 
.局部变量 变量地形, 整数型, , , 
.局部变量 RAY, 整数型, , , 
.局部变量 坐标, 坐标, , , 

赋值 (RAY, .位置)
赋值 (坐标.X, X)
赋值 (坐标.Y, Y)
赋值 (现行地形类型, 地形 [地形坐标取地形编号 (坐标)])
.如果 (等于 (现行地形类型, 0))
    赋值 (现行地形类型, RAY ())
.否则
    赋值 (现行地形类型, 相加 (现行地形类型, 1))
    .如果真 (大于 (现行地形类型, 地形类型数))
        赋值 (现行地形类型, 1)
    .如果真结束
    
.如果结束
.计次循环首 (RAY, X变量)
    .计次循环首 (RAY, Y变量)
        赋值 (坐标.X, 相减 (相加 (X, Y变量), 1))
        赋值 (坐标.Y, 相减 (相加 (Y, X变量), 1))
        .如果真 (并且 (小于或等于 (坐标.X, 横格数), 小于或等于 (坐标.Y, 纵格数)))
            地形类型位图数据.画图片 ( [现行地形类型], 地形类型, 相乘 (相减 (坐标.X, 1), 16), 相乘 (相减 (坐标.Y, 1), 16), 16, 16, )
            赋值 (地形 [地形坐标取地形编号 (坐标)], 现行地形类型)
        .如果真结束
        
    .计次循环尾 ()
    
.计次循环尾 ()

.子程序 _画板1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 变量X, 小数型, , , 
.局部变量 变量Y, 空白型, , , 

赋值 (X, 相加 (绝对取整 (相除 (横向位置, 16)), 1))
赋值 (Y, 相加 (绝对取整 (相除 (纵向位置, 16)), 1))




赋值 (.标题, 相加 (“鼠标坐标:”, 到文本 (X), “,”, 到文本 (Y)))

.子程序 删除地形, 空白型, , 
.参数 坐标, 坐标, , 

.如果真 (并且 (小于或等于 (坐标.X, 横格数), 小于或等于 (坐标.Y, 纵格数)))
    赋值 (地形 [地形坐标取地形编号 (坐标)], 0)
    相乘 (相减 (坐标.X, 1), 16).清除 (相乘 (相减 (坐标.Y, 1), 16), 16, 16)
.如果真结束


.子程序 _画板1_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 X变量, 整数型, , , 
.局部变量 Y变量, 整数型, , , 
.局部变量 坐标, 坐标, , , 


.计次循环首 (.位置, X变量)
    .计次循环首 (.位置, Y变量)
        赋值 (坐标.X, 相减 (相加 (X, X变量), 1))
        赋值 (坐标.Y, 相减 (相加 (Y, Y变量), 1))
        删除地形 (坐标)
    .计次循环尾 ()
.计次循环尾 ()

.子程序 _按钮2_被单击, 空白型, , 
.局部变量 地图数据, 字节集, , , 
.局部变量 匿名局部变量_449, 空白型, , , 
.局部变量 变量, 整数型, , , 
.局部变量 坐标, 坐标, , , 

赋值 (.类型, 0)
赋值 (.标题, “读取地图文件”)

.如果真 (打开 ())
    赋值 (.禁止, 真)
    赋值 (地图数据, 读入文件 (.文件名))
    赋值 (地图数据, 未知支持库函数_1 (地图数据))
    0.清除 (0, 地图宽度, 地图高度)
    重定义数组 (地形, 假, 相乘 (纵格数, 横格数))
    赋值 (.最大位置, 取数组成员数 (地形))
    .计次循环首 (取字节集长度 (地图数据), 变量)
        赋值 (地形 [变量], 字节集转换到地形数据 (取字节集中间 (地图数据, 变量, 1)))
        .如果真 (大于 (地形 [变量], 0))
            赋值 (坐标, 地形编号取地形坐标 (变量))
            地形类型位图数据.画图片 ( [地形] [变量], 地形类型, 相乘 (相减 (坐标.X, 1), 16), 相乘 (相减 (坐标.Y, 1), 16), 16, 16, )
        .如果真结束
        赋值 (.位置, 变量)
    .计次循环尾 ()
    赋值 (.禁止, 假)
.如果真结束


.子程序 _编辑框1_获得焦点, 空白型, , 
赋值 (.内容, “”)


.子程序 _编辑框1_内容被改变, 空白型, , 
.局部变量 ASD, 整数型, , , 

赋值 (ASD, 到数值 (.内容))
.判断开始 (小于或等于 (ASD, 0))
    赋值 (ASD, .最小位置)
    赋值 (.内容, 到文本 (1))
.判断 (大于 (ASD, .最大位置))
    赋值 (ASD, .最大位置)
    赋值 (.内容, 到文本 (.最大位置))
.默认
    
.判断结束

赋值 (.位置, ASD)

.子程序 _滑块条1_位置被改变, 空白型, , 
赋值 (.内容, 到文本 (.位置))

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 地图数据, 字节集, , , 
.局部变量 匿名局部变量_424, 空白型, , , 
.局部变量 变量1, 整数型, , , 
.局部变量 变量2, 整数型, , , 
.局部变量 坐标, 坐标, , , 

赋值 (.类型, 1)
赋值 (.标题, “保存地图文件”)
.如果真 (打开 ())
    赋值 (.禁止, 真)
    赋值 (.最大位置, 相乘 (纵格数, 横格数))
    .计次循环首 (纵格数, 变量1)
        .计次循环首 (横格数, 变量2)
            赋值 (.位置, 相乘 (变量2, 变量1))
            赋值 (坐标.X, 变量2)
            赋值 (坐标.Y, 变量1)
            赋值 (地图数据, 相加 (地图数据, 地形数据转换到字节集 (地形 [地形坐标取地形编号 (坐标)])))
        .计次循环尾 ()
    .计次循环尾 ()
    赋值 (地图数据, 未知支持库函数_0 (地图数据))
    写到文件 (.文件名, 地图数据)
    赋值 (.禁止, 假)
.如果真结束


.子程序 _画板1_滚轮被滚动, 逻辑型, , 
.参数 滚动距离, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (大于 (滚动距离, 0))
    赋值 (.位置, 相加 (.位置, 1))
.默认
    赋值 (.位置, 相减 (.位置, 1))
.判断结束
_滑块条1_位置被改变 ()


.子程序 __启动窗口_滚轮被滚动, 逻辑型, , 
.参数 滚动距离, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (大于 (滚动距离, 0))
    赋值 (.位置, 相加 (.位置, 1))
.默认
    赋值 (.位置, 相减 (.位置, 1))
.判断结束
_滑块条1_位置被改变 ()
信息框 (“”, 0, )


.程序集 辅助程序集, , , 

.子程序 地形坐标取地形编号, 整数型, , 
.参数 坐标, 坐标, , 

.局部变量 数组位置, 整数型, , , 
.局部变量 RAY, 空白型, , , 

.如果 (等于 (坐标.X, 横格数))
    返回 (相乘 (坐标.Y, 横格数))
.否则
    返回 (相加 (相乘 (相减 (坐标.Y, 1), 横格数), 坐标.X))
.如果结束


.子程序 地形编号取地形坐标, 坐标, , 
.参数 数组编号, 整数型, , 

.局部变量 坐标, 坐标, , , 
.局部变量 ASDASD, 整数型, , , 

.如果 (小于或等于 (数组编号, 横格数))
    赋值 (坐标.X, 数组编号)
    赋值 (坐标.Y, 1)
.否则
    .如果 (等于 (求余数 (数组编号, 横格数), 0))
        赋值 (坐标.Y, 相除 (数组编号, 横格数))
    .否则
        赋值 (坐标.Y, 相加 (相除 (数组编号, 横格数), 1))
    .如果结束
    赋值 (坐标.X, 求余数 (数组编号, 横格数))
    .如果真 (等于 (坐标.X, 0))
        赋值 (坐标.X, 横格数)
    .如果真结束
    
.如果结束


返回 (坐标)

.子程序 地形数据转换到字节集, 字节集, , 
.参数 类型, 短整数型, , 

返回 (到字节集 (到字节 (类型)))

.子程序 字节集转换到地形数据, 短整数型, , 
.参数 字节集, 字节集, , 

返回 (到短整数 (取字节集数据 (字节集, #字节型, )))



 ' 不属于任何一个程序集、类模块的函数：
