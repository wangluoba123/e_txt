 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 351
    高度 = 363
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一





.窗口程序集 窗口程序集1, , , 

.程序集变量 i, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 字段, 字段信息, , "4", 

创建目录 (“data”)
赋值 (字段 [1].名称, “歌手名”)
赋值 (字段 [2].名称, “类别”)
赋值 (字段 [3].名称, “歌曲名”)
赋值 (字段 [4].名称, “歌曲路径”)
赋值 (字段 [4].最大文本长度, 100)
连续赋值 (#文本型, 字段 [1].类型, 字段 [2].类型, 字段 [3].类型, 字段 [4].类型)
连续赋值 (10, 字段 [1].最大文本长度, 字段 [2].最大文本长度, 字段 [3].最大文本长度)
.如果真 (等于 (寻找文件 (相加 (取运行目录 (), “\data\数据.edb”), ), “”))
    创建 (相加 (取运行目录 (), “\data\数据.edb”), 字段)
.如果真结束
打开 (相加 (取运行目录 (), “\data\数据.edb”), , , , , , )
赋值 (_启动窗口., 相加 (“ [ 共有： ”, 到文本 (取记录数 ()), “]记录”))
赋值 (.现行选中项, 0)
子程序1 ()

.子程序 _按钮1_被单击, 空白型, , 

到首记录 ()
.如果 (查找 (等于 (等于 (.内容, 到文本 (读 (“歌曲名”))), 真)))
    信息框 (“该歌手名已经添加了！”, 0, )
.否则
    .如果 (等于 (.内容, “”))
        信息框 (“[歌手] 不能为空”, 0, )
        获取焦点 ()
    .否则
        .如果 (等于 (.内容, “”))
            信息框 (“[歌曲] 不能为空”, 0, )
            获取焦点 ()
        .否则
            .如果 (等于 (.内容, “”))
                信息框 (“[路径] 不能为空”, 0, )
                获取焦点 ()
            .否则
                .如果 (加记录 (.内容, .内容, .内容, .内容))
                    信息框 (“数据成功保存”, 0, )
                .否则
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
    
    赋值 (_启动窗口., 相加 (“ [ 共有： ”, 到文本 (取记录数 ()), “]记录”))
.如果结束
子程序1 ()

.子程序 子程序1, 空白型, , 
.局部变量 男歌手, 文本型, , "0", 
.局部变量 女歌手, 文本型, , "0", 
.局部变量 类别, 文本型, , "0", 
.局部变量 文本, 文本型, , "0", 
.局部变量 男, 文本型, , "0", 
.局部变量 女, 文本型, , "0", 
.局部变量 类, 整数型, , , 
.局部变量 男数, 整数型, , , 
.局部变量 女数, 整数型, , , 
.局部变量 父层, 整数型, , , 
.局部变量 子层1, 整数型, , , 
.局部变量 合唱, 文本型, , "0", 
.局部变量 合, 文本型, , "0", 
.局部变量 合数, 整数型, , , 
.局部变量 DJ, 文本型, , "0", 
.局部变量 DJW, 文本型, , "0", 
.局部变量 DJ数, 整数型, , , 

清空 ()
赋值 (., 真)
赋值 (., 真)
赋值 (父层, 取项目数 ())
赋值 (子层1, 相减 (父层, 取项目数 ()))
到首记录 () ' 读类型
.计次循环首 (取记录数 (), i)
    加入成员 (类别, 读 (2))
    跳过 ()
.计次循环尾 ()
查找相同文本 (类别, 文本)
.计次循环首 (取数组成员数 (文本), 类)
    相减 (父层, 1).加入项目 (到文本 (文本 [类]), , , )
.计次循环尾 ()
到首记录 () ' 读男歌手
.计次循环首 (取记录数 (), )
    .判断开始 (查找 (等于 (到文本 (读 (“类别”)), 到文本 (“男歌手”))))
        加入成员 (读 (1))
    .默认
        
    .判断结束
    跳过 ()
.计次循环尾 ()
未知函数_67174851 ()
.计次循环首 (取数组成员数 (), )
    子层1.加入项目 (到文本 (男 [男数]), , , )
.计次循环尾 ()
到首记录 () ' 读女歌手
.计次循环首 (取记录数 (), )
    .判断开始 (查找 (等于 (到文本 (读 (“类别”)), 到文本 (“女歌手”))))
        加入成员 (读 (1))
    .默认
        
    .判断结束
    跳过 ()
.计次循环尾 ()
未知函数_67174880 ()
.计次循环首 (取数组成员数 (), )
    相加 ().加入项目 (到文本 ( [)], , , ))

.子程序 _树型框1_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

.局部变量 取文本, 文本型, , , 
.局部变量 索引, 整数型, , , 

全部删除 ()
赋值 (取文本, .取项目文本 (.))
到首记录 ()
.计次循环首 (取记录数 (), )
    .判断开始 (查找 (等于 (到文本 (读 (“歌手名”)), 到文本 (取文本))))
        赋值 (索引, .插入表项 (读 (3), , , , ))
        索引.置标题 (1, 读 (4))
    .默认
        
    .判断结束
    跳过 ()
.计次循环尾 ()


.程序集 程序集1, , , 

.子程序 查找相同文本, 空白型, , 
.参数 文本数组, 文本型, 数组, 
.参数 输出文本, 文本型, 数组, 

.局部变量 文本数量, 整数型, , , 
.局部变量 加入文本数量, 整数型, , , 
.局部变量 是否存在, 逻辑型, , , 

.计次循环首 (取数组成员数 (文本数组), 文本数量)
    .计次循环首 (取数组成员数 (输出文本), 加入文本数量)
        .如果真 (等于 (输出文本 [加入文本数量], 文本数组 [文本数量]))
            赋值 (是否存在, 真)
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
    .如果真 (等于 (是否存在, 假))
        加入成员 (输出文本, 文本数组 [文本数量])
    .如果真结束
    赋值 (是否存在, 假)
.计次循环尾 ()


 ' 不属于任何一个程序集、类模块的函数：
