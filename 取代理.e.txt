 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 窗口1 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 513
    高度 = 296
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “取代理_双击列表框项目即可更新代理”
    帮助文件名 = “”

窗口 _启动窗口
    左边 = 50
    顶边 = 50
    宽度 = 531
    高度 = 374
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “代理设置主窗口 http://www.easysq.com 还有更多源码”
    帮助文件名 = “”

窗口 窗口2
    左边 = 50
    顶边 = 50
    宽度 = 522
    高度 = 365
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “管理代理IP”
    帮助文件名 = “”



.常量 数据库1, "“daili”", , 
.常量 ip, "“ip”", , 
.常量 端口, "“端口”", , 
.常量 类型, "“类型”", , 
.常量 国家, "“国家”", , 
.常量 INTERNET_OPTION_PROXY, "38", 公开, Internet常量代理服务器
.常量 INTERNET_OPTION_PROXY_PASSWORD, "44", 公开, Internet常量代理服务器密码
.常量 INTERNET_OPTION_PROXY_USERNAME, "43", 公开, Internet常量代理服务器用户名
.常量 INTERNET_OPTION_SETTINGS_CHANGED, "39", 公开, Internet常量IE设置改变
.常量 INTERNET_OPEN_TYPE_DIRECT, "1", 公开, Internet打开类型-直连
.常量 INTERNET_OPEN_TYPE_PRECONFIG, "2", 公开, Internet打开类型-??
.常量 INTERNET_OPEN_TYPE_PROXY, "3", 公开, Internet打开类型-代理
.常量 时间, "“时间”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 5 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' internet 707ca37322474f6ca841f0e224f4b620 1 0 互联网支持库
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 1 1 多线程支持库
 ' spec A512548E76954B6E92C21055517615B0 2 1 特殊功能支持库
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库
 ' HtmlView 5014D8FA6DCA40b68FA626D8183666EB 1 1 超文本浏览框支持库




数据类型 INTERNET_PROXY_INFO, 公开, 代理服务器信息
    .成员 dwAccessType, 整数型, , , 
    .成员 lpszProxy, 文本型, , , 
    .成员 lpszProxyBypass, 文本型, , , 

.全局变量 内容, 文本型, , , 
.全局变量 信息, 文本型, , , 
.全局变量 i, 空白型, , , 
.全局变量 t, 空白型, , , 

.DLL命令 InternetSetOptionProxy, 逻辑型, "Wininet.dll", "InternetSetOptionA", 公开, 设置IE属性
    .参数 hInternet, 整数型, , 
    .参数 dwOption, 整数型, , 
    .参数 lpBuffer, INTERNET_PROXY_INFO, , 
    .参数 dwBufferLength, 整数型, , 

.DLL命令 InternetSetOptionChangeD, 逻辑型, "Wininet.dll", "InternetSetOptionA", 公开, 改变IE
    .参数 hInternet, 整数型, , 
    .参数 dwOption, 整数型, , 
    .参数 lpBuffer, 整数型, , 
    .参数 dwBufferLength, 整数型, , 

.窗口程序集 窗口程序集1, , , 

.子程序 _窗口1_创建完毕, 空白型, , 


.子程序 读一段, 文本型, , 
.参数 原内容, 文本型, , 原内容
.参数 分割符, 文本型, , 可以是#换行符,也可以是别的符号比如"/"","";"等

.局部变量 a, 整数型, , , 
.局部变量 b, 文本型, , , 

赋值 (a, 寻找文本 (原内容, 分割符, , 真))
赋值 (b, 取文本左边 (原内容, 相减 (a, 1)))
返回 (b)

.子程序 删一段, 文本型, 公开, 
.参数 原内容, 文本型, , 原内容
.参数 分割符, 文本型, , 可以是#换行符,也可以是别的符号比如"/"","";"等

.局部变量 a, 整数型, , , 
.局部变量 c, 文本型, , , 
.局部变量 b, 文本型, , , 

赋值 (a, 寻找文本 (原内容, 分割符, , 真))
赋值 (b, 取文本左边 (原内容, 相减 (a, 1)))
赋值 (c, 取文本右边 (原内容, 相减 (取文本长度 (原内容), 取文本长度 (b), 取文本长度 (分割符))))
返回 (c)

.子程序 _按钮1_被单击, 空白型, , 
赋值 (.禁止, 真)
未知支持库函数_0 (&显示1, )

.子程序 显示1, 空白型, , 
赋值 (内容, 到文本 (未知支持库函数_7 (“http://www.proxy4free.com/page1.html”)))

.判断循环首 (不等于 (寻找文本 (内容, “bgcolor=”, , 真), -1))
    赋值 (内容, 删一段 (内容, “bgcolor=”))
    调试输出 (内容)
    赋值 (t, 相加 (t, 1))
    t.插入表项 (5, )
    .计次循环首 (5, i)
        赋值 (内容, 删一段 (内容, “<td>”))
        赋值 (信息, 读一段 (内容, “</td>”))
        .如果真 (不等于 (内容, “”))
            相减 (t, 1).置标题 (相减 (i, 1), 信息)
        .如果真结束
        
    .计次循环尾 ()
.判断循环尾 ()

.子程序 _超级列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 IP, 文本型, , , 

赋值 (IP, 相加 (.取标题 (., ), “:”, .取标题 (., 1)))
设置IE代理 (IP)


.子程序 _添加_被选择, 空白型, , 
置当前库 (“daili”)
到首记录 ()
.如果 (等于 (查找 (等于 (.取标题 (., 0), 读 (1))), 真))
    信息框 (“数据已经在数据库”, 0, )
.否则
    .如果 (不等于 (.取标题 (., 0), “”))
        加记录 (.取标题 (., 0), .取标题 (., 1), .取标题 (., 2), .取标题 (., 3), .取标题 (., 4))
        显示2 ()
        0.置文本 (“添加成功”)
    .否则
        
    .如果结束
    
.如果结束




.子程序 _超级列表框1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 设置IE代理, 文本型, , ||置IE的代理服务器地址
.参数 代理IP, 文本型, 可空, 如果为空则为取消代理服务器,如果所有协议全用一个地址，请填写一个服务器地址||分开格式为ftp=10.72.88.22:12;gopher=10.72.88.23:1;http=10.72.88.21:6;https=10.72.88.8:5;socks=10.72.88.28:10
.参数 不使用代理地址列表, 文本型, 可空, 请用;分开如127.0.0.1;192.168.0.1

.局部变量 代理信息, INTERNET_PROXY_INFO, , , 

 ' HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings\ProxyEnable   设置代理开关
 ' HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings\ProxyOverride 不通过代理列表
 ' HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings\ProxyServer   代理服务器地址
.如果 (是否为空 (代理IP))
     ' --取消代理-----开始------注册表--------------------
    赋值 (代理信息.dwAccessType, #INTERNET_OPEN_TYPE_DIRECT) ' 设置为直连模式
    连续赋值 (“”, 代理信息.lpszProxy, 代理信息.lpszProxyBypass)
    .如果真 (等于 (注册项是否存在 (#现行用户, “Software\Microsoft\Windows\CurrentVersion\Internet Settings\ProxyServer”), 假))
        写注册项 (#现行用户, “Software\Microsoft\Windows\CurrentVersion\Internet Settings\ProxyServer”, “”)
    .如果真结束
    .如果真 (等于 (写注册项 (#现行用户, “Software\Microsoft\Windows\CurrentVersion\Internet Settings\ProxyEnable”, 0), 假))
        返回 (“取消IE代理：写注册表代理开关失败”)
    .如果真结束
     ' --取消代理-----结束------注册表--------------------
.否则
     ' --设置代理-----开始------注册表--------------------
    赋值 (代理信息.dwAccessType, #INTERNET_OPEN_TYPE_PROXY) ' 设置为代理模式
    连续赋值 (代理IP, 代理信息.lpszProxy, 代理信息.lpszProxyBypass)
    .如果真 (等于 (写注册项 (#现行用户, “Software\Microsoft\Windows\CurrentVersion\Internet Settings\ProxyServer”, 代理信息.lpszProxy), 假))
        返回 (“设置IE代理：写注册表代理地址失败”)
    .如果真结束
    .如果真 (等于 (写注册项 (#现行用户, “Software\Microsoft\Windows\CurrentVersion\Internet Settings\ProxyOverride”, 相加 (不使用代理地址列表, “;<local>”)), 假))
        返回 (“设置IE代理：写注册表不使用代理地址列表失败”)
    .如果真结束
    .如果真 (等于 (写注册项 (#现行用户, “Software\Microsoft\Windows\CurrentVersion\Internet Settings\ProxyEnable”, 1), 假))
        返回 (“设置IE代理：写注册表代理开关失败”)
    .如果真结束
     ' --设置代理-----结束-------注册表-------------------
.如果结束
 ' --设置代理-----开始-------IE更新-------------------
.如果真 (等于 (InternetSetOptionProxy (0, #INTERNET_OPTION_PROXY, 代理信息, 12), 假))
    返回 (“设置IE代理：写IE信息失败”)
.如果真结束
.如果真 (等于 (InternetSetOptionChangeD (0, #INTERNET_OPTION_SETTINGS_CHANGED, 0, 0), 假))
    返回 (“设置IE代理：改变IE信息失败”)
.如果真结束
 ' --设置代理-----结束-------IE更新-------------------
返回 (“设置IE代理成功”)

.窗口程序集 窗口程序集2, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
未知支持库函数_0 (1)
打开 (相加 (取运行目录 (), “\daili.edb”), , , , , “SamDeng”, )
显示2 ()
赋值 (., “http://www.easysq.com/daili.php”)

.子程序 显示2, 空白型, , 
.局部变量 循环变量2, 空白型, , , 
.局部变量 循环变量1, 空白型, , , 
.局部变量 匿名局部变量_1219, 空白型, , , 

置当前库 (“daili”)
到首记录 ()
全部删除 ()
.计次循环首 (取记录数 (), 循环变量1)
    .计次循环首 (取字段数 (), 循环变量2)
        .如果 (等于 (循环变量2, 1))
            .插入表项 (读 (1), , , , ) ' 线别
            相减 (循环变量1, 1).置标题 (1, 到文本 (读 (2))) ' 制令别
            相减 (循环变量1, 1).置标题 (2, 到文本 (读 (3))) ' 制令别
            相减 (循环变量1, 1).置标题 (3, 到文本 (读 (4))) ' 制令别
            相减 (循环变量1, 1).置标题 (4, 到文本 (读 (5))) ' 制令别
        .否则
            
        .如果结束
        
    .计次循环尾 ()
    跳过 ()
.计次循环尾 ()

.子程序 _超级列表框1_右键单击表项, 空白型, , 
弹出菜单 ()

.子程序 _管理_被选择, 空白型, , 
载入 (窗口2, , 真)

.子程序 _获取更多IP_被选择, 空白型, , 
载入 (窗口1, , 真)

.子程序 _超级列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 IP, 文本型, , , 

赋值 (IP, 相加 (.取标题 (., ), “:”, .取标题 (., 1)))
设置IE代理 (IP)


.子程序 _设置代理_被选择, 空白型, , 
.局部变量 IP, 文本型, , , 

 ' 赋值 (IP, 相加 (.取标题 (., ), “:”, .取标题 (., 1)))
设置IE代理 (IP)


.子程序 _取消代理_被选择, 空白型, , 
设置IE代理 ()

.窗口程序集 窗口程序集3, , , 

.子程序 _窗口2_创建完毕, 空白型, , 
显示 ()

.子程序 显示, 空白型, , 
.局部变量 循环变量2, 空白型, , , 
.局部变量 循环变量1, 空白型, , , 
.局部变量 匿名局部变量_1260, 空白型, , , 

置当前库 (“daili”)
到首记录 ()
全部删除 ()
.计次循环首 (取记录数 (), 循环变量1)
    .计次循环首 (取字段数 (), 循环变量2)
        .如果 (等于 (循环变量2, 1))
            .插入表项 (读 (1), , , , )
            相减 (循环变量1, 1).置标题 (1, 到文本 (读 (2)))
            相减 (循环变量1, 1).置标题 (2, 到文本 (读 (3)))
            相减 (循环变量1, 1).置标题 (3, 到文本 (读 (4)))
            相减 (循环变量1, 1).置标题 (4, 到文本 (读 (5)))
        .否则
            
        .如果结束
        
    .计次循环尾 ()
    跳过 ()
.计次循环尾 ()

.子程序 _超级列表框1_右键单击表项, 空白型, , 
弹出菜单 ()

.子程序 _按钮1_被单击, 空白型, , 
 ' 置当前库 (“daili”)
到首记录 ()
.如果 (等于 (查找 (等于 (.内容, 读 (1))), 真))
    信息框 (“数据已经在数据库”, 0, )
.否则
    .如果 (并且 (不等于 (.内容, “”), 不等于 (.内容, “”)))
        加记录 (.内容, .内容, .内容, .内容, .内容)
        0.置文本 (“添加成功”)
        显示 ()
        显示2 ()
    .否则
        
    .如果结束
    
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
置当前库 (“daili”)
到首记录 ()
.如果 (等于 (., -1))
    信息框 (“请选择需要修改的表项”, 0, )
.否则
    
.如果结束
.如果 (查找 (等于 (.取标题 (., 0), 读 (1))))
    修改 (.内容, .内容, .内容, .内容, .内容)
    0.置文本 (“修改成功”)
    显示 ()
    显示2 ()
.否则
    
.如果结束


.子程序 _超级列表框1_左键单击表项, 空白型, , 
赋值 (.内容, .取标题 (., 0))
赋值 (.内容, .取标题 (., 1))
赋值 (.内容, .取标题 (., 2))
赋值 (.内容, .取标题 (., 3))
赋值 (.内容, .取标题 (., 4))


.子程序 _删除_被选择, 空白型, , 
置当前库 (“daili”)
到首记录 ()
.如果 (等于 (., -1))
    信息框 (“请选择需要删除的表项”, 0, )
.否则
    
.如果结束
.如果 (删除 (等于 (.取标题 (., 0), 读 (1))))
    0.置文本 (“删除成功”)
    彻底删除 ()
    显示 ()
    显示2 ()
.否则
    
.如果结束



 ' 不属于任何一个程序集、类模块的函数：
