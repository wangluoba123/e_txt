 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.wodesoft.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.wodesoft.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.wodesoft.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 971
    高度 = 802
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “带库管理”
    帮助文件名 = “”

窗口 添加_窗口
    左边 = 50
    顶边 = 50
    宽度 = 490
    高度 = 624
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “添加窗口”
    帮助文件名 = “”

窗口 修改_窗口
    左边 = 50
    顶边 = 50
    宽度 = 490
    高度 = 624
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “修改窗口”
    帮助文件名 = “”

窗口 项目管理_窗口
    左边 = 50
    顶边 = 50
    宽度 = 630
    高度 = 737
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “项目管理”
    帮助文件名 = “”

窗口 数据库管理_窗口
    左边 = 50
    顶边 = 50
    宽度 = 445
    高度 = 294
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “数据库管理”
    帮助文件名 = “”

窗口 查询_窗口
    左边 = 50
    顶边 = 50
    宽度 = 881
    高度 = 641
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “查询”
    帮助文件名 = “”

窗口 统计_窗口
    左边 = 50
    顶边 = 50
    宽度 = 620
    高度 = 335
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 管理员_窗口
    左边 = 50
    顶边 = 50
    宽度 = 592
    高度 = 270
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “管理员窗口”
    帮助文件名 = “”

窗口 登陆_窗口
    左边 = 50
    顶边 = 50
    宽度 = 324
    高度 = 185
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “登陆窗口”
    帮助文件名 = “”



.常量 常量_带数据库, "“data\dk.sdb”", , 
.常量 常量_数据库名, "“dk”", , 
.常量 , , , 
.常量 常量_资料表, "“zl”", , 
.常量 常量_项目表, "“xm”", , 
.常量 常量_管理员表, "“admin”", , 
.常量 , , , 
.常量 配件类别库项目文本, "“项目名”", , 
.常量 , , , 
.常量 常量_管理员_编号, "“admin_data”", , 
.常量 常量_管理员_姓名, "“admin_name”", , 
.常量 常量_管理员_密码, "“admin_Password”", , 
.常量 常量_管理员_权限, "“admin_popedom”", , 
.常量 , , , 
.常量 常量_资料_编号, "“bian_hao”", , 1
.常量 常量_资料_片名, "“pian_ming”", , 2
.常量 常量_资料_分类, "“fen_lei”", , 3
.常量 常量_资料_主演, "“zhu_yan”", , 5
.常量 常量_资料_影碟号, "“ying_die_hao”", , 6
.常量 常量_资料_导演, "“dao_yan”", , 7
.常量 常量_资料_集数, "“ji_shuo”", , 8
.常量 常量_资料_金额, "“jin_e”", , 9
.常量 常量_资料_日期, "“ri_qi”", , 10
.常量 常量_资料_备注, "“bei_zhu”", , 11
.常量 常量_资料_图片, "“tu_bian”", , 12
.常量 常量_资料_数据编号, "“shuo_ju_bian_hao”", , 13
.常量 , , , 
.常量 , , , 
.常量 常量_项目_父项目编号, "“fu_xiang_bian_hao”", , 
.常量 常量_项目_项目名, "“xiang_mu_ming”", , 
.常量 常量_项目_项目编号, "“xiang_mu_bian_hao”", , 
.常量 , , , 
.常量 , , , 
.常量 常量_配置项_配置文件, "“ini\配置文件.ini”", , 
.常量 常量_配置项_组合框选中项, "“组合框选中项”", , 
.常量 , , , 
.常量 常量_每页数, "300", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 2 0 扩展界面支持库二
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 2 6 高级表格支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' mysql 7F54B9CE8887428dBA9CEEB94CEF4C72 3 0 MySQL支持库
 ' EChartBar 9A3F84D7FDEB4a0486F2711D5104B7F7 2 0 数据图表支持库




.全局变量 计次, 整数型, , , 
.全局变量 全局_当前树框项值, 文本型, , , 
.全局变量 全局_MySql句柄, 整数型, , , 
.全局变量 全局_修改窗口收到表格, 文本型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 项目数值, 整数型, , , 相应项目的数值
.程序集变量 父项目, 文本型, , , 
.程序集变量 程序集_项目索引, 整数型, , , 
.程序集变量 响应时间, 整数型, , , 
.程序集变量 匿名程序集变量_696, 空白型, , , 
.程序集变量 程序集_取父项数, 整数型, , , 
.程序集变量 程序集_当前记录号, 整数型, , , 
.程序集变量 程序集__选中项目, 文本型, , , 
.程序集变量 程序集_当前行, 整数型, , , 
.程序集变量 程序集_记录集句柄, 整数型, , , 
.程序集变量 程序集_总页数, 整数型, , , 
.程序集变量 程序集_开始位置, 整数型, , , 
.程序集变量 程序集_结束位置, 整数型, , , 
.程序集变量 程序集_当前页码, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
 ' --========  易语言资源网  (www.wodesoft.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.wodesoft.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.wodesoft.com  ================--

赋值 (全局_MySql句柄, 未知支持库函数_1 (“”, “root”, “”, “dk”, 0))
载入 (登陆_窗口, , 真)
读树型框项目 ()


.子程序 __启动窗口_尺寸被改变, 空白型, , 
赋值 (.高度, 相减 (_启动窗口., .可视, .高度, .高度, 5))
赋值 (., 相减 (取用户区高度 (), .可视, .高度, 4))
赋值 (., 相减 (取用户区宽度 (), .宽度, 5))
赋值 (.宽度, 相减 (_启动窗口.取用户区宽度 (), 4))
赋值 (.顶边, 相减 (_启动窗口.取用户区高度 (), .高度, 5))
 ' 标签1.左边 ＝ 外形框1.宽度 － 标签1.宽度 － 20
赋值 (.左边, 相减 (.宽度, .宽度))

.子程序 __启动窗口_将被销毁, 空白型, , 

未知支持库函数_2 (全局_MySql句柄)

.子程序 读树型框项目, 空白型, , 
.局部变量 索引, 整数型, , , 
.局部变量 局部_父项目索引, 整数型, , , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_项目名, 文本型, , , 
.局部变量 局部_项目编号, 文本型, , , 
.局部变量 局部_父项目编号, 文本型, , , 
.局部变量 局部_计次1, 整数型, , , 

清空 ()
.如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from xm”))
    赋值 (程序集_记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
.如果真结束

赋值 (索引, 0)
未知支持库函数_12 (程序集_记录集句柄)
.计次循环首 (未知支持库函数_7 (程序集_记录集句柄), 局部_计次)
    未知支持库函数_6 (程序集_记录集句柄, #常量_项目_项目名, 局部_项目名)
    未知支持库函数_6 (程序集_记录集句柄, #常量_项目_项目编号, 局部_项目编号)
    未知支持库函数_6 (程序集_记录集句柄, #常量_项目_父项目编号, 局部_父项目编号)
    赋值 (程序集_当前行, 相加 (程序集_当前行, 1))
    .如果真 (等于 (取整 (到数值 (局部_父项目编号)), -1))
        赋值 (局部_父项目索引, 索引.加入项目 (局部_项目名, 0, 1, 到数值 (局部_项目编号)))
         ' 程序集_当前记录号 ＝ 取记录集行数 (程序集_记录集句柄)
        .如果真 (等于 (是否有子项 (局部_项目编号), 真))
            局部_父项目索引.加入项目 (“...”, , , )
        .如果真结束
        
    .如果真结束
    
    未知支持库函数_10 (程序集_记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (程序集_记录集句柄)
.计次循环首 (取项目数 (), 局部_计次1)
    相减 (局部_计次1, 2).扩展 ()
.计次循环尾 ()
 ' 树型框1.现行选中项 ＝ 3
子程序_状态显示 ()


.子程序 是否有子项, 逻辑型, , 
.参数 参数_数据编号, 文本型, , 

.局部变量 局部_记录集句柄, 整数型, , , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_父项目编号, 文本型, , , 


未知支持库函数_3 (全局_MySql句柄, 相加 (“SELECT * FROM ”, #常量_项目表, “”))
赋值 (局部_记录集句柄, 未知支持库函数_4 (全局_MySql句柄))

.计次循环首 (未知支持库函数_7 (局部_记录集句柄), 局部_计次)
    未知支持库函数_6 (局部_记录集句柄, #常量_项目_父项目编号, 局部_父项目编号)
    .如果真 (等于 (局部_父项目编号, 参数_数据编号))
        未知支持库函数_11 (程序集_记录集句柄, 程序集_当前行)
        未知支持库函数_5 (局部_记录集句柄)
        返回 (真)
        
    .如果真结束
    未知支持库函数_10 (局部_记录集句柄)
.计次循环尾 ()
未知支持库函数_11 (程序集_记录集句柄, 程序集_当前行)
未知支持库函数_5 (局部_记录集句柄)
返回 (假)

.子程序 _树型框1_即将扩展, 逻辑型, , 
.参数 项目索引, 整数型, , 

.局部变量 局部_索引, 整数型, , , 
.局部变量 局部_父项目索引, 整数型, , , 
.局部变量 局部_记录集句柄, 整数型, , , 
.局部变量 局部_父项目编号, 文本型, , , 
.局部变量 局部_项目名, 文本型, , , 
.局部变量 局部_项目编号, 文本型, , , 
.局部变量 局部_计次, 整数型, , , 

.如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from xm”))
    赋值 (局部_记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
.如果真结束

.判断循环首 (大于或等于 (相加 (项目索引, 1).取父项目 (), 项目索引))
    相加 (项目索引, 1).删除项目 ()
.判断循环尾 ()
未知支持库函数_12 (局部_记录集句柄)

.计次循环首 (未知支持库函数_7 (局部_记录集句柄), 局部_计次)
    
    未知支持库函数_6 (局部_记录集句柄, #常量_项目_项目编号, 局部_项目编号)
    
    未知支持库函数_6 (局部_记录集句柄, #常量_项目_项目名, 局部_项目名)
    
    未知支持库函数_6 (局部_记录集句柄, #常量_项目_父项目编号, 局部_父项目编号)
    
    .如果真 (等于 (取整 (到数值 (局部_父项目编号)), 项目索引.取项目数值 ()))
        赋值 (局部_父项目索引, 项目索引.加入项目 (局部_项目名, 0, 1, 到数值 (局部_项目编号)))
        
        赋值 (程序集_当前行, 相加 (程序集_当前行, 1))
        .如果真 (等于 (是否有子项 (局部_项目编号), 真))
            局部_父项目索引.加入项目 (“...”, , , )
        .如果真结束
        
    .如果真结束
    未知支持库函数_10 (局部_记录集句柄)
    
    
    
.计次循环尾 ()
未知支持库函数_5 (局部_记录集句柄)


.子程序 带库表头, 空白型, , 
赋值 (., 1)
0.未知支持库函数_9 (1, #., “编号”)
0.未知支持库函数_9 (2, #., “片名”)
0.未知支持库函数_9 (3, #., “分类”)
0.未知支持库函数_9 (4, #., “主演”)
0.未知支持库函数_9 (5, #., “导演”)
0.未知支持库函数_9 (6, #., “集数”)
0.未知支持库函数_9 (7, #., “影碟号”)
0.未知支持库函数_32 (0)
1.未知支持库函数_32 (100)
2.未知支持库函数_32 (100)
3.未知支持库函数_32 (80)
4.未知支持库函数_32 (80)
5.未知支持库函数_32 (80)
6.未知支持库函数_32 (80)
7.未知支持库函数_32 (80)
0.未知支持库函数_18 (0, 0, ., 12)

.子程序 带库列表, 空白型, , 
未知支持库函数_3 (全局_MySql句柄, 相加 (“select * from zl where ”, #常量_资料_数据编号, “ like '”, 全局_当前树框项值, “%'”))
赋值 (程序集_记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
赋值 (程序集_当前页码, 1)
子程序_显示表格 (程序集_记录集句柄, 程序集_当前页码)
子程序_状态显示 ()
未知支持库函数_5 (程序集_记录集句柄)

.子程序 _树型框1_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

.局部变量 局部_选中项目, 文本型, , , 

未知支持库函数_5 (程序集_记录集句柄)
赋值 (全局_当前树框项值, 到文本 (.取项目数值 (.最大化按钮)))
带库表头 ()
赋值 (程序集__选中项目, 全局_当前树框项值)
.如果真 (等于 (未知支持库函数_3 (全局_MySql句柄, 相加 (“select * from zl where shuo_ju_bian_hao like '”, 全局_当前树框项值, “%'”)), 假))
    返回 ()
.如果真结束
赋值 (程序集_记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
 ' 局部_树型子记录集 ＝ 查找记录 (全局_MySql句柄, #常量_资料表, “*”, “” ＋ #常量_资料_数据编号 ＋ “='” ＋ 全局_当前树框项值 ＋ “'”, “” ＋ #常量_资料_数据编号 ＋ “ ASC”)
赋值 (程序集_当前页码, 1)
子程序_显示表格 (程序集_记录集句柄, 程序集_当前页码)
子程序_状态显示 ()

.子程序 _表格1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

 ' 本源码来自易语言资源网(www.wodesoft.com)
未知支持库函数_3 ().未知支持库函数_24 (1, 未知支持库函数_3 (), ., #白色)
未知支持库函数_3 ().未知支持库函数_22 (1, 未知支持库函数_3 (), ., #黑色)


.子程序 _表格1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

未知支持库函数_3 ().未知支持库函数_24 (1, 未知支持库函数_3 (), ., #天蓝)
未知支持库函数_3 ().未知支持库函数_22 (1, 未知支持库函数_3 (), ., #白色)


.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.局部变量 容器, 文本型, , , 

.如果真 (等于 (按钮索引, 1))
    赋值 (添加_窗口., “新增”)
    载入 (添加_窗口, , 真)
.如果真结束
.如果真 (等于 (按钮索引, 2))
    .如果真 (大于 (未知支持库函数_3 (), 0))
        赋值 (修改_窗口., “修改”)
        赋值 (全局_修改窗口收到表格, _启动窗口.未知支持库函数_3 (.).未知支持库函数_10 (1))
        载入 (修改_窗口, , 真)
    .如果真结束
    
.如果真结束
.如果真 (等于 (按钮索引, 3))
    载入 (查询_窗口, , 真)
.如果真结束



.子程序 _进入_被选择, 空白型, , 
载入 (项目管理_窗口, , 真)


.子程序 _进入数据库_被选择, 空白型, , 
载入 (数据库管理_窗口, , 真)

.子程序 _刷新_被选择, 空白型, , 
读树型框项目 ()

.子程序 _按钮_首页_被单击, 空白型, , 
赋值 (程序集_当前页码, 1)
子程序_显示表格 (程序集_记录集句柄, 程序集_当前页码)
子程序_状态显示 ()


.子程序 _按钮_尾页_被单击, 空白型, , 
赋值 (程序集_当前页码, 程序集_总页数)
子程序_显示表格 (程序集_记录集句柄, 程序集_当前页码)
子程序_状态显示 ()


.子程序 _按钮_上一页_被单击, 空白型, , 
.如果真 (大于 (程序集_当前页码, 1))
    赋值 (程序集_当前页码, 相减 (程序集_当前页码, 1))
    子程序_显示表格 (程序集_记录集句柄, 程序集_当前页码)
    输出调试文本 (程序集_当前页码)
    子程序_状态显示 ()
.如果真结束


.子程序 _按钮_下一页_被单击, 空白型, , 
.如果真 (小于 (程序集_当前页码, 程序集_总页数))
    赋值 (程序集_当前页码, 相加 (程序集_当前页码, 1))
    赋值 (程序集_开始位置, 相加 (相乘 (相减 (程序集_当前页码, 1), #常量_每页数), 1))
    子程序_显示表格 (程序集_记录集句柄, 程序集_当前页码)
    子程序_状态显示 ()
    
    输出调试文本 (程序集_当前页码)
.如果真结束



.子程序 子程序_显示表格, 空白型, , 
.参数 参数_记录集句柄, 整数型, , 
.参数 参数_当前页码, 整数型, , 

.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_树型编号, 文本型, , , 
.局部变量 局部_树型片名, 文本型, , , 
.局部变量 局部_树型分类, 文本型, , , 
.局部变量 局部_树型主演, 文本型, , , 
.局部变量 局部_树型导演, 文本型, , , 
.局部变量 局部_树型集数, 文本型, , , 
.局部变量 局部_树型影碟号, 文本型, , , 
.局部变量 局部_结束位置, 整数型, , , 
.局部变量 局部_行计次, 整数型, , , 
.局部变量 局部_开始位置, 整数型, , , 

赋值 (响应时间, 取启动时间 ())
带库表头 ()
.判断开始 (不等于 (求余数 (未知支持库函数_7 (参数_记录集句柄), #常量_每页数), 0))
    赋值 (程序集_总页数, 相加 (取整 (相除 (未知支持库函数_7 (参数_记录集句柄), #常量_每页数)), 1))
.默认
    赋值 (程序集_总页数, 相除 (到数值 (未知支持库函数_7 (参数_记录集句柄)), 到数值 (#常量_每页数)))
.判断结束
赋值 (局部_开始位置, 相加 (相乘 (相减 (参数_当前页码, 1), #常量_每页数), 1))
赋值 (局部_结束位置, 相减 (相加 (局部_开始位置, #常量_每页数), 1))
.如果真 (等于 (未知支持库函数_7 (程序集_记录集句柄), 0))
    赋值 (程序集_当前页码, 0)
    子程序_状态显示 ()
    返回 ()
.如果真结束

.如果真 (大于 (局部_结束位置, 未知支持库函数_7 (参数_记录集句柄)))
    赋值 (局部_结束位置, 未知支持库函数_7 (参数_记录集句柄))
.如果真结束
.如果真 (或者 (小于或等于 (局部_开始位置, 0), 大于 (局部_开始位置, 未知支持库函数_7 (参数_记录集句柄))))
    返回 ()
.如果真结束
' 本源码来自易语言资源网(www.wodesoft.com)
赋值 (局部_行计次, 1)
未知支持库函数_11 (参数_记录集句柄, 相减 (局部_开始位置, 1))
.变量循环首 (局部_开始位置, 局部_结束位置, 1, 局部_计次)
    未知支持库函数_6 (参数_记录集句柄, #常量_资料_编号, 局部_树型编号)
    未知支持库函数_6 (参数_记录集句柄, #常量_资料_片名, 局部_树型片名)
    未知支持库函数_6 (参数_记录集句柄, #常量_资料_分类, 局部_树型分类)
    未知支持库函数_6 (参数_记录集句柄, #常量_资料_主演, 局部_树型主演)
    未知支持库函数_6 (参数_记录集句柄, #常量_资料_导演, 局部_树型导演)
    未知支持库函数_6 (参数_记录集句柄, #常量_资料_集数, 局部_树型集数)
    未知支持库函数_6 (参数_记录集句柄, #常量_资料_影碟号, 局部_树型影碟号)
    .未知支持库函数_38 ()
    局部_行计次.未知支持库函数_9 (1, #., 局部_树型编号)
    局部_行计次.未知支持库函数_9 (2, #., 局部_树型片名)
    局部_行计次.未知支持库函数_9 (3, #., 局部_树型分类)
    局部_行计次.未知支持库函数_9 (4, #., 局部_树型主演)
    局部_行计次.未知支持库函数_9 (5, #., 局部_树型导演)
    局部_行计次.未知支持库函数_9 (6, #., 局部_树型集数)
    局部_行计次.未知支持库函数_9 (7, #., 局部_树型影碟号)
    
    赋值 (局部_行计次, 相加 (局部_行计次, 1))
    未知支持库函数_10 (参数_记录集句柄)
.变量循环尾 ()
子程序_状态显示 ()
赋值 (响应时间, 相减 (取启动时间 (), 响应时间))
赋值 (.标题, 相加 (“运行时间”, 到文本 (相除 (响应时间, 1000)), “秒”))

.子程序 子程序_状态显示, 空白型, , 
赋值 (.标题, 相加 (“当前页”, 到文本 (程序集_当前页码), “/”, 到文本 (程序集_总页数), “总页数”))
赋值 (.标题, 相加 (“当前显示数”, 到文本 (相减 (., 1)), “/”, 到文本 (未知支持库函数_7 (程序集_记录集句柄)), “总数”))
 ' 标签1.标题 ＝ “当前显示数” ＋ 到文本 (表格1.行数 － 1) ＋ “/” ＋ 到文本 (取记录集行数 (程序集_记录集句柄)) ＋ “总数”

.子程序 _打开_被选择, 空白型, , 
载入 (统计_窗口, , 真)


.子程序 _进入管理_被选择, 空白型, , 
载入 (管理员_窗口, , 真)

.窗口程序集 添加窗口程序集, , , 

.程序集变量 新增与编辑, 文本型, , , 
.程序集变量 程序集_编号, 文本型, , , 
.程序集变量 类别编号, 文本型, , , 
.程序集变量 匿名程序集变量_738, 空白型, , , 
.程序集变量 程序集_图片路径, 文本型, , , 
.程序集变量 程序集_记数, 整数型, , , 
.程序集变量 程序集_关闭记录项目数值, 文本型, , , 
.程序集变量 程序集_选中项目文本名, 文本型, , , 
.程序集变量 程序集_表格计次, 整数型, , , 
.程序集变量 程序集_记录集句柄, 整数型, , , 
.程序集变量 程序集_项目记录集句柄, 整数型, , , 
.程序集变量 程序集_当前行, 整数型, , , 
.子程序 _添加_窗口_创建完毕, 空白型, , 
.局部变量 年, 文本型, , , 
.局部变量 月, 文本型, , , 
.局部变量 日, 文本型, , , 
.局部变量 局部_编号, 文本型, , , 
.局部变量 局部_项目编号, 文本型, , , 
.局部变量 局部_项目名, 文本型, , , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_项目是否存在, 逻辑型, , , 

添加表格表头 ()

 ' **************************************** 自动加入日期  *************************************************
赋值 (.内容, 功能_日期转换 (取现行时间 ()))
 ' *****************************************************************************************

赋值 (程序集_关闭记录项目数值, 读配置项 (#常量_配置项_配置文件, “添加窗口”, “记录项目数值”, ))
.如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from zl”))
    赋值 (程序集_记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
    
.如果真结束

.如果 (等于 (新增与编辑, “新增”))
    未知支持库函数_13 (程序集_记录集句柄)
    未知支持库函数_6 (程序集_记录集句柄, #常量_资料_编号, 局部_编号)
    
    赋值 (程序集_编号, 局部_编号)
    
    .如果 (等于 (局部_编号, “”))
        赋值 (.内容, “00001”)
    .否则
        赋值 (.内容, 相加 (取文本左边 (程序集_编号, 0), 取文本右边 (相加 (“00000”, 到文本 (相加 (到数值 (取文本右边 (程序集_编号, 5)), 1))), 5)))
    .如果结束
    未知支持库函数_5 (程序集_记录集句柄)
    
.否则
    
.如果结束
.如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from xm”))
    赋值 (程序集_项目记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
    未知支持库函数_12 (程序集_项目记录集句柄)
    .计次循环首 (未知支持库函数_7 (程序集_项目记录集句柄), 局部_计次)
        ' 本源码来自易语言资源网(www.wodesoft.com)
        
        
        未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目编号, 局部_项目编号)
        未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目名, 局部_项目名)
        .如果真 (等于 (局部_项目编号, 程序集_关闭记录项目数值))
            赋值 (程序集_选中项目文本名, 局部_项目名)
            赋值 (局部_项目是否存在, 真)
            跳出循环 ()
            
            
        .如果真结束
        未知支持库函数_10 (程序集_项目记录集句柄)
        
    .计次循环尾 ()
    未知支持库函数_5 (程序集_项目记录集句柄)
.如果真结束

赋值 (类别编号, 程序集_关闭记录项目数值)

.判断开始 (等于 (程序集_关闭记录项目数值, “”))
    添加窗口读组合框 ()
.判断 (等于 (局部_项目是否存在, 真))
    添加_组合框_递归 (程序集_关闭记录项目数值)
.默认
    添加窗口读组合框 ()
    
    
.判断结束




.子程序 添加_组合框_递归, 空白型, , 
.参数 参数_数据编号, 文本型, , 

.局部变量 局部_组合框, 组合框, , "4", 
.局部变量 局部_父项, 文本型, , , 
.局部变量 局部_当前记录位置, 整数型, , , 
.局部变量 局部_当前父项, 文本型, , , 
.局部变量 局部_父项目编号, 文本型, , , 
.局部变量 局部_项目名, 文本型, , , 
.局部变量 局部_项目编号, 文本型, , , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_计次1, 整数型, , , 

赋值 (程序集_当前行, 0)
赋值 (局部_组合框 [1], )
赋值 (局部_组合框 [2], )
赋值 (局部_组合框 [3], )
赋值 (局部_组合框 [4], )
.如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from xm”))
    赋值 (程序集_项目记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
    未知支持库函数_12 (程序集_项目记录集句柄)
.如果真结束
赋值 (程序集_记数, 相加 (程序集_记数, 1))

.如果真 (等于 (参数_数据编号, “10”))
    赋值 (程序集_记数, 0)
    返回 ()
.如果真结束
.计次循环首 (未知支持库函数_7 (程序集_项目记录集句柄), 局部_计次)
    
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_父项目编号, 局部_父项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目编号, 局部_项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目名, 局部_项目名)
    赋值 (程序集_当前行, 相加 (程序集_当前行, 1))
    
    .如果真 (等于 (局部_项目编号, 参数_数据编号))
        局部_组合框.加入项目 ( [程序集_记数], 局部_项目名, 到整数 (局部_项目编号))
        赋值 (局部_组合框 [程序集_记数], 现行选中项, 0)
        赋值 (局部_父项, 局部_父项目编号)
        
        赋值 (局部_当前父项, 局部_父项目编号)
        未知支持库函数_12 (程序集_项目记录集句柄)
        
        .计次循环首 (未知支持库函数_7 (程序集_项目记录集句柄), 局部_计次1)
            未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_父项目编号, 局部_父项目编号)
            未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目编号, 局部_项目编号)
            未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目名, 局部_项目名)
            
            .如果真 (等于 (局部_父项目编号, 局部_当前父项))
                .如果真 (不等于 (局部_项目名, 局部_组合框.取项目文本 ( [程序集_记数], 0)))
                    局部_组合框.加入项目 ( [程序集_记数], 局部_项目名, 到整数 (局部_项目编号))
                    
                .如果真结束
                
                
            .如果真结束
            未知支持库函数_10 (程序集_项目记录集句柄)
            
        .计次循环尾 ()
        .如果真 (等于 (局部_父项, “-1”))
            返回 ()
        .如果真结束
        未知支持库函数_11 (程序集_项目记录集句柄, 程序集_当前行)
        
    .如果真结束
    未知支持库函数_10 (程序集_项目记录集句柄)
    
.计次循环尾 ()
添加_组合框_递归 (局部_父项)


.子程序 _添加_窗口_将被销毁, 空白型, , 
写配置项 (#常量_配置项_配置文件, “添加窗口”, “记录项目数值”, 程序集_关闭记录项目数值)

.子程序 添加窗口读组合框, 空白型, , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_父项目编号, 文本型, , , 
.局部变量 局部_项目名, 文本型, , , 
.局部变量 局部_项目编号, 文本型, , , 


.如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from xm”))
    赋值 (程序集_项目记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
.如果真结束

未知支持库函数_12 (程序集_项目记录集句柄)
.计次循环首 (未知支持库函数_7 (程序集_项目记录集句柄), 局部_计次)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_父项目编号, 局部_父项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目编号, 局部_项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目名, 局部_项目名)
    
    .如果真 (等于 (取整 (到数值 (局部_父项目编号)), 10))
        
        局部_项目名.加入项目 (到数值 (局部_项目编号))
        
    .如果真结束
    未知支持库函数_10 (程序集_项目记录集句柄)
    
.计次循环尾 ()
未知支持库函数_5 (程序集_项目记录集句柄)



.子程序 _组合框_一级_列表项被选择, 空白型, , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_父项目编号, 文本型, , , 
.局部变量 局部_项目名, 文本型, , , 
.局部变量 局部_项目编号, 文本型, , , 
.局部变量 局部_计次1, 整数型, , , 

.如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from xm”))
    赋值 (程序集_项目记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
.如果真结束

未知支持库函数_12 (程序集_项目记录集句柄)
.计次循环首 (取项目数 (), 局部_计次)
    
    .如果真 (等于 (.现行选中项, 相减 (局部_计次, 1)))
        赋值 (类别编号, 到文本 (相减 (局部_计次, 1).取项目数值 ()))
        输出调试文本 (类别编号)
        跳出循环 ()
        
    .如果真结束
    
    
.计次循环尾 ()
清空 ()
.计次循环首 (未知支持库函数_7 (程序集_项目记录集句柄), 局部_计次1)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_父项目编号, 局部_父项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目编号, 局部_项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目名, 局部_项目名)
    .如果真 (等于 (局部_父项目编号, 类别编号))
        局部_项目名.加入项目 (到数值 (局部_项目编号))
    .如果真结束
    未知支持库函数_10 (程序集_项目记录集句柄)
    
.计次循环尾 ()
未知支持库函数_5 (程序集_项目记录集句柄)


.子程序 _组合框_二级_列表项被选择, 空白型, , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_父项目编号, 文本型, , , 
.局部变量 局部_项目名, 文本型, , , 
.局部变量 局部_项目编号, 文本型, , , 
.局部变量 局部_计次1, 整数型, , , 


.如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from xm”))
    赋值 (程序集_项目记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
.如果真结束

未知支持库函数_12 (程序集_项目记录集句柄)

.计次循环首 (取项目数 (), 局部_计次)
    .如果真 (等于 (.现行选中项, 相减 (局部_计次, 1)))
        赋值 (类别编号, 到文本 (相减 (局部_计次, 1).取项目数值 ()))
        输出调试文本 (类别编号)
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
清空 ()

.计次循环首 (未知支持库函数_7 (程序集_项目记录集句柄), 局部_计次1)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_父项目编号, 局部_父项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目编号, 局部_项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目名, 局部_项目名)
    .如果真 (等于 (局部_父项目编号, 类别编号))
        局部_项目名.加入项目 (到数值 (局部_项目编号))
    .如果真结束
    未知支持库函数_10 (程序集_项目记录集句柄)
    
.计次循环尾 ()
未知支持库函数_5 (程序集_项目记录集句柄)


.子程序 _组合框_三级_列表项被选择, 空白型, , 
.局部变量 局部_父项目编号, 文本型, , , 
.局部变量 局部_项目名, 文本型, , , 
.局部变量 局部_项目编号, 文本型, , , 
.局部变量 局部_计次1, 整数型, , , 
.局部变量 局部_计次, 整数型, , , 

.如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from xm”))
    赋值 (程序集_项目记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
.如果真结束

未知支持库函数_12 (程序集_项目记录集句柄)
.计次循环首 (取项目数 (), 局部_计次)
    .如果真 (等于 (.现行选中项, 相减 (局部_计次, 1)))
        赋值 (类别编号, 到文本 (相减 (局部_计次, 1).取项目数值 ()))
        输出调试文本 (类别编号)
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
清空 ()
.计次循环首 (未知支持库函数_7 (程序集_项目记录集句柄), 局部_计次1)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_父项目编号, 局部_父项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目编号, 局部_项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目名, 局部_项目名)
    .如果真 (等于 (局部_父项目编号, 类别编号))
        局部_项目名.加入项目 (到数值 (局部_项目编号))
    .如果真结束
    未知支持库函数_10 (程序集_项目记录集句柄)
    
.计次循环尾 ()
未知支持库函数_5 (程序集_项目记录集句柄)


.子程序 _组合框_四级_列表项被选择, 空白型, , 
.局部变量 局部_计次, 整数型, , , 


.计次循环首 (取项目数 (), 局部_计次)
    .如果真 (等于 (.现行选中项, 相减 (局部_计次, 1)))
        赋值 (类别编号, 到文本 (相减 (局部_计次, 1).取项目数值 ()))
        输出调试文本 (类别编号)
        赋值 (程序集_关闭记录项目数值, 到文本 (相减 (局部_计次, 1).取项目数值 ()))
        赋值 (程序集_选中项目文本名, 相减 (局部_计次, 1).取项目文本 ())
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()



.子程序 _保存_添加_被单击, 空白型, , 
.局部变量 局部_子记录集, 整数型, , , 
.局部变量 局部_编号, 文本型, , , 
.局部变量 局部_添加赋值语句, 文本型, , , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 汉字, 字节集, , , 
.局部变量 汉字1, 字节集, , , 
.局部变量 a, 整数型, , , 

 ' *********************************** 加入1000条数据    **********************************************************************
 ' 置随机数种子 ()
 ' .计次循环首 (1000, a)
    
     ' 汉字 ＝ 取字节集左边 (到字节集 (取随机数 (176, 247)), 1) ＋ 取字节集左边 (到字节集 (取随机数 (161, 254)), 1)
     ' 汉字1 ＝ 取字节集左边 (到字节集 (取随机数 (176, 247)), 1) ＋ 取字节集左边 (到字节集 (取随机数 (161, 254)), 1)
     ' 编辑框_片名.内容 ＝ 到文本 (汉字 ＋ 汉字1)
    
    .如果真 (等于 (.现行选中项, -1))
         ' 信息框 (“类别未选中！”, #错误图标, )
         ' 返回 ()
        
    .如果真结束
     ' .如果真 (等于 (.现行选中项, -1))
         ' 信息框 (“类别未选中！”, #错误图标, )
         ' 返回 ()
        
    .如果真结束
     ' .如果真 (等于 (.现行选中项, -1))
         ' 信息框 (“类别未选中！”, #错误图标, )
         ' 返回 ()
        
    .如果真结束
     ' .如果真 (等于 (.现行选中项, -1))
         ' 信息框 (“类别未选中！”, #错误图标, )
         ' 返回 ()
    .如果真结束
     ' .如果真 (等于 (.内容, “”))
         ' 信息框 (“编号不能为空！”, #错误图标, )
         ' 返回 ()
    .如果真结束
     ' .如果真 (等于 (.内容, “”))
         ' 信息框 (“片名不能为空！”, #错误图标, )
         ' 返回 ()
    .如果真结束
     ' .如果 (等于 (新增与编辑, “新增”))
         ' .如果真 (等于 (.内容, “”))
             ' 信息框 (“请输入配件名称！”, 0, )
             ' 返回 ()
        .如果真结束
        
         ' 局部_子记录集 ＝ 查找记录 (全局_MySql句柄, #常量_资料表, #常量_资料_数据编号, “” ＋ #常量_资料_编号 ＋ “='” ＋ 编辑框_编号.内容 ＋ “'”, “” ＋ #常量_资料_编号 ＋ “ ASC”)
         ' 到首行 (局部_子记录集)
         ' .计次循环首 (未知支持库函数_7 (局部_子记录集), 局部_计次)
             ' 读字段值 (局部_子记录集, #常量_资料_编号, 局部_编号)
             ' .如果真 (等于 (局部_编号, .内容))
                 ' 信息框 (“配件编号重复”, 0, )
                 ' 返回 ()
            .如果真结束
             ' 到下一行 (局部_子记录集)
         ' .计次循环尾 ()
         ' 局部_添加赋值语句 ＝ “” ＋ #常量_资料_编号 ＋ “='” ＋ 编辑框_编号.内容 ＋ “',” ＋ #常量_资料_片名 ＋ “='” ＋ 编辑框_片名.内容 ＋ “',” ＋ #常量_资料_分类 ＋ “='” ＋ 程序集_选中项目文本名 ＋ “',” ＋ #常量_资料_主演 ＋ “='” ＋ 编辑框_主角.内容 ＋ “',” ＋ #常量_资料_影碟号 ＋ “='” ＋ 编辑框_带库影碟号.内容 ＋ “',” ＋ #常量_资料_导演 ＋ “='” ＋ 编辑框_导演.内容 ＋ “',” ＋ #常量_资料_集数 ＋ “='” ＋ 编辑框_集数.内容 ＋ “',” ＋ #常量_资料_金额 ＋ “='” ＋ 编辑框_金额.内容 ＋ “',” ＋ #常量_资料_日期 ＋ “='” ＋ 编辑框_日期.内容 ＋ “',” ＋ #常量_资料_备注 ＋ “='” ＋ 编辑框_备注.内容 ＋ “',” ＋ #常量_资料_图片 ＋ “='” ＋ 程序集_图片路径 ＋ “',” ＋ #常量_资料_数据编号 ＋ “='” ＋ 类别编号 ＋ “'”
        
         ' ' 输出调试文本 (局部_添加赋值语句)
         ' .如果真 (等于 (未知支持库函数_18 (全局_MySql句柄, #常量_资料表, 局部_添加赋值语句), 真))
             ' ' 信息框 (“成功”, 0, )
        .如果真结束
        
         ' .如果真 (是否已创建 (_启动窗口))
             ' _启动窗口._树型框1_项目被选择 (2)
        .如果真结束
        
         ' 连续赋值 (“”, 编辑框_编号.内容, 编辑框_片名.内容, 编辑框_备注.内容, 编辑框_备注.内容, 编辑框_集数.内容, 编辑框_导演.内容, 编辑框_主角.内容, 编辑框_带库影碟号.内容, 编辑框_金额.内容)
         ' 图片框_图片.图片 ＝ {  }
        
         ' .如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from zl”))
             ' 程序集_记录集句柄 ＝ 取记录集 (全局_MySql句柄)
             ' 到尾行 (程序集_记录集句柄)
        .如果真结束
         ' 读字段值 (程序集_记录集句柄, #常量_资料_编号, 局部_编号)
         ' 编辑框_编号.内容 ＝ 取文本左边 (程序集_编号, 0) ＋ 取文本右边 (“00000” ＋ 到文本 (到数值 (取文本右边 (局部_编号, 5)) ＋ 1), 5)
        
        
         ' 程序集_表格计次 ＝ 1
         ' 高级表格_添加显示.插入行 (, 1)
         ' 添加表格置数据 ()
         ' 释放记录集 (程序集_记录集句柄)
        
    .否则
        
    .如果结束
    
    
    
     ' _启动窗口.树型框1.现行选中项 ＝ 1
    
 ' .计次循环尾 ()

 ' **********************************************************************************************************


.如果真 (等于 (.现行选中项, -1))
    信息框 (“类别未选中！”, #错误图标, )
    返回 ()
    
.如果真结束
.如果真 (等于 (.现行选中项, -1))
    信息框 (“类别未选中！”, #错误图标, )
    返回 ()
    
.如果真结束
.如果真 (等于 (.现行选中项, -1))
    信息框 (“类别未选中！”, #错误图标, )
    返回 ()
    
.如果真结束
.如果真 (等于 (.现行选中项, -1))
    信息框 (“类别未选中！”, #错误图标, )
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“编号不能为空！”, #错误图标, )
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“片名不能为空！”, #错误图标, )
    返回 ()
.如果真结束
.如果 (等于 (新增与编辑, “新增”))
    .如果真 (等于 (.内容, “”))
        信息框 (“请输入配件名称！”, 0, )
        返回 ()
    .如果真结束
    
    赋值 (局部_子记录集, 未知支持库函数_17 (全局_MySql句柄, #常量_资料表, #常量_资料_数据编号, 相加 (“”, #常量_资料_编号, “='”, .内容, “'”), 相加 (“”, #常量_资料_编号, “ ASC”)))
    未知支持库函数_12 (局部_子记录集)
    .计次循环首 (未知支持库函数_7 (局部_子记录集), 局部_计次)
        未知支持库函数_6 (局部_子记录集, #常量_资料_编号, 局部_编号)
        .如果真 (等于 (局部_编号, .内容))
            信息框 (“配件编号重复”, 0, )
            返回 ()
        .如果真结束
        未知支持库函数_10 (局部_子记录集)
    .计次循环尾 ()
    赋值 (局部_添加赋值语句, 相加 (“”, #常量_资料_编号, “='”, .内容, “',”, #常量_资料_片名, “='”, 子文本替换 (.内容, “'”, “,”, , , 假), “',”, #常量_资料_分类, “='”, 程序集_选中项目文本名, “',”, #常量_资料_主演, “='”, 子文本替换 (.内容, “'”, “,”, , , 假), “',”, #常量_资料_影碟号, “='”, 子文本替换 (.内容, “'”, “,”, , , 假), “',”, #常量_资料_导演, “='”, 子文本替换 (.内容, “'”, “,”, , , 假), “',”, #常量_资料_集数, “='”, .内容, “',”, #常量_资料_金额, “='”, .内容, “',”, #常量_资料_日期, “='”, .内容, “',”, #常量_资料_备注, “='”, 子文本替换 (.内容, “'”, “,”, , , 假), “',”, #常量_资料_图片, “='”, 程序集_图片路径, “',”, #常量_资料_数据编号, “='”, 类别编号, “'”))
    
     ' 输出调试文本 (局部_添加赋值语句)
    .如果真 (等于 (未知支持库函数_18 (全局_MySql句柄, #常量_资料表, 局部_添加赋值语句), 真))
         ' 信息框 (“成功”, 0, )
    .如果真结束
    
    .如果真 (是否已创建 (_启动窗口))
        _启动窗口._树型框1_项目被选择 (2)
    .如果真结束
    
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
    赋值 (.图片, {  })
    
    .如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from zl”))
        赋值 (程序集_记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
        未知支持库函数_13 (程序集_记录集句柄)
    .如果真结束
    未知支持库函数_6 (程序集_记录集句柄, #常量_资料_编号, 局部_编号)
    赋值 (.内容, 相加 (取文本左边 (程序集_编号, 0), 取文本右边 (相加 (“00000”, 到文本 (相加 (到数值 (取文本右边 (局部_编号, 5)), 1))), 5)))
    
    
    赋值 (程序集_表格计次, 1)
    .未知支持库函数_38 (1)
    添加表格置数据 ()
    未知支持库函数_5 (程序集_记录集句柄)
    
.否则
    
.如果结束



赋值 (_启动窗口..最大化按钮, 1)


.子程序 _按钮3_被单击, 空白型, , 
销毁 ()

.子程序 _按钮_退出_被单击, 空白型, , 
销毁 ()


.子程序 _按钮_选择图片_被单击, 空白型, , 
.局部变量 局部_路径, 文本型, , , 

.如果真 (等于 (文件是否存在 (相加 (取运行目录 (), “\图片”)), 假))
    创建目录 (相加 (取运行目录 (), “\图片”))
.如果真结束
赋值 (.初始目录, 相加 (取运行目录 (), “\图片”))
.如果真 (打开 ())
    赋值 (局部_路径, .文件名)
    赋值 (程序集_图片路径, 取文本右边 (局部_路径, 相减 (取文本长度 (局部_路径), 倒找文本 (局部_路径, “\”, , 真))))
    赋值 (.图片, 读入文件 (.文件名))
    
.如果真结束



.子程序 添加表格表头, 空白型, , 
赋值 (., 1)
0.未知支持库函数_9 (1, #., “编号”)
0.未知支持库函数_9 (2, #., “片名”)
0.未知支持库函数_9 (3, #., “分类”)
0.未知支持库函数_9 (4, #., “主演”)
0.未知支持库函数_9 (5, #., “导演”)
0.未知支持库函数_9 (6, #., “影碟号”)
0.未知支持库函数_32 (0)
1.未知支持库函数_32 (50)
2.未知支持库函数_32 (100)
3.未知支持库函数_32 (70)
4.未知支持库函数_32 (80)
5.未知支持库函数_32 (76)
6.未知支持库函数_32 (70)
0.未知支持库函数_18 (0, 0, ., 12)



.子程序 添加表格置数据, 空白型, , 
.局部变量 局部_编号, 文本型, , , 
.局部变量 局部_片名, 文本型, , , 
.局部变量 局部_分类, 文本型, , , 
.局部变量 局部_主演, 文本型, , , 
.局部变量 局部_资料_导演, 文本型, , , 
.局部变量 局部_影碟号, 文本型, , , 


未知支持库函数_13 (程序集_记录集句柄)
未知支持库函数_6 (程序集_记录集句柄, #常量_资料_编号, 局部_编号)
未知支持库函数_6 (程序集_记录集句柄, #常量_资料_片名, 局部_片名)
未知支持库函数_6 (程序集_记录集句柄, #常量_资料_分类, 局部_分类)
未知支持库函数_6 (程序集_记录集句柄, #常量_资料_主演, 局部_主演)
未知支持库函数_6 (程序集_记录集句柄, #常量_资料_导演, 局部_资料_导演)
未知支持库函数_6 (程序集_记录集句柄, #常量_资料_影碟号, 局部_影碟号)
程序集_表格计次.未知支持库函数_9 (1, #., 局部_编号)
程序集_表格计次.未知支持库函数_9 (2, #., 局部_片名)
程序集_表格计次.未知支持库函数_9 (3, #., 局部_分类)
程序集_表格计次.未知支持库函数_9 (4, #., 局部_主演)
程序集_表格计次.未知支持库函数_9 (5, #., 局部_资料_导演)
程序集_表格计次.未知支持库函数_9 (6, #., 局部_影碟号)


.窗口程序集 修改窗口程序集, , , 

.程序集变量 新增与编辑, 文本型, , , 
.程序集变量 程序集_编号, 文本型, , , 
.程序集变量 类别编号, 文本型, , , 
.程序集变量 匿名程序集变量_3482, 空白型, , , 
.程序集变量 程序集_图片路径, 文本型, , , 
.程序集变量 程序集_记数, 整数型, , , 
.程序集变量 程序集_关闭记录项目数值, 文本型, , , 
.程序集变量 程序集_选中项目文本名, 文本型, , , 
.程序集变量 程序集_表格计次, 整数型, , , 
.程序集变量 程序集_记录集句柄, 整数型, , , 
.程序集变量 程序集_项目记录集句柄, 整数型, , , 
.程序集变量 程序集_当前行, 整数型, , , 
.程序集变量 匿名程序集变量_1307, 空白型, , , 
.程序集变量 程序集_获取编辑框, 文本型, , , 
.程序集变量 程序集_获取配置项数值, 文本型, , , 
.子程序 _修改_窗口_创建完毕, 空白型, , 
.局部变量 年, 文本型, , , 
.局部变量 月, 文本型, , , 
.局部变量 日, 文本型, , , 
.局部变量 局部_读记录集, 整数型, , , 
.局部变量 局部_编号, 文本型, , , 
.局部变量 局部_片名, 文本型, , , 
.局部变量 局部_分类, 文本型, , , 
.局部变量 局部_主演, 文本型, , , 
.局部变量 局部_导演, 文本型, , , 
.局部变量 局部_集数, 文本型, , , 
.局部变量 局部_影碟号, 文本型, , , 
.局部变量 局部_备注, 文本型, , , 
.局部变量 局部_图片, 文本型, , , 
.局部变量 局部_数据编号, 文本型, , , 
.局部变量 局部_项目名, 文本型, , , 
.局部变量 局部_金额, 文本型, , , 
.局部变量 局部_日期, 文本型, , , 


 ' 本源码来自易语言资源网(www.wodesoft.com)

.如果真 (等于 (新增与编辑, “修改”))
    赋值 (局部_读记录集, 未知支持库函数_17 (全局_MySql句柄, #常量_资料表, “*”, 相加 (“”, #常量_资料_编号, “='”, 全局_修改窗口收到表格, “'”), 相加 (“”, #常量_资料_编号, “ ASC”)))
    未知支持库函数_12 (局部_读记录集)
    未知支持库函数_6 (局部_读记录集, #常量_资料_编号, 局部_编号)
    未知支持库函数_6 (局部_读记录集, #常量_资料_片名, 局部_片名)
    未知支持库函数_6 (局部_读记录集, #常量_资料_主演, 局部_主演)
    未知支持库函数_6 (局部_读记录集, #常量_资料_主演, 局部_影碟号)
    未知支持库函数_6 (局部_读记录集, #常量_资料_导演, 局部_导演)
    未知支持库函数_6 (局部_读记录集, #常量_资料_集数, 局部_集数)
    未知支持库函数_6 (局部_读记录集, #常量_资料_金额, 局部_金额)
    未知支持库函数_6 (局部_读记录集, #常量_资料_日期, 局部_日期)
    未知支持库函数_6 (局部_读记录集, #常量_资料_备注, 局部_备注)
    未知支持库函数_6 (局部_读记录集, #常量_资料_图片, 局部_图片)
    未知支持库函数_6 (局部_读记录集, #常量_资料_数据编号, 局部_数据编号)
    
    赋值 (.内容, 局部_编号)
    赋值 (.内容, 局部_片名)
    赋值 (.内容, 局部_主演)
    赋值 (.内容, 局部_影碟号)
    赋值 (.内容, 局部_导演)
    赋值 (.内容, 局部_集数)
    赋值 (.内容, 局部_金额)
    赋值 (.内容, 局部_日期)
    赋值 (.内容, 局部_备注)
    赋值 (.图片, 读入文件 (相加 (取运行目录 (), “\图片\”, 局部_图片)))
    赋值 (类别编号, 局部_数据编号)
    赋值 (程序集_记数, 0)
    
    子程序_组合框_递归 (类别编号)
    未知支持库函数_5 (局部_读记录集)
    
.如果真结束


赋值 (局部_读记录集, 未知支持库函数_17 (全局_MySql句柄, #常量_项目表, “*”, 相加 (“”, #常量_项目_项目编号, “='”, 类别编号, “'”), 相加 (“”, #常量_项目_项目编号, “ ASC”)))
未知支持库函数_12 (局部_读记录集)
未知支持库函数_6 (局部_读记录集, #常量_项目_项目名, 局部_项目名)
赋值 (程序集_选中项目文本名, 局部_项目名)
未知支持库函数_5 (局部_读记录集)
输出调试文本 (程序集_选中项目文本名)

赋值 (程序集_获取编辑框, 相加 (“”, #常量_资料_片名, “='”, .内容, “'”))





.子程序 子程序_组合框_递归, 空白型, , 
.参数 参数_数据编号, 文本型, , 

.局部变量 局部_组合框, 组合框, , "4", 
.局部变量 局部_父项, 文本型, , , 
.局部变量 局部_当前记录位置, 整数型, , , 
.局部变量 局部_当前父项, 文本型, , , 
.局部变量 局部_父项目编号, 文本型, , , 
.局部变量 局部_项目名, 文本型, , , 
.局部变量 局部_项目编号, 文本型, , , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_计次1, 整数型, , , 



赋值 (局部_组合框 [1], )
赋值 (局部_组合框 [2], )
赋值 (局部_组合框 [3], )
赋值 (局部_组合框 [4], )
.如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from xm”))
    赋值 (程序集_项目记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
    
    未知支持库函数_12 (程序集_项目记录集句柄)
.如果真结束
赋值 (程序集_记数, 相加 (程序集_记数, 1))

.如果真 (等于 (参数_数据编号, “10”))
    赋值 (程序集_记数, 0)
    返回 ()
.如果真结束
.计次循环首 (未知支持库函数_7 (程序集_项目记录集句柄), 局部_计次)
    
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_父项目编号, 局部_父项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目编号, 局部_项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目名, 局部_项目名)
    赋值 (程序集_当前行, 相加 (程序集_当前行, 1))
    
    .如果真 (等于 (局部_项目编号, 参数_数据编号))
        局部_组合框.加入项目 ( [程序集_记数], 局部_项目名, 到整数 (局部_项目编号))
        赋值 (局部_组合框 [程序集_记数], 现行选中项, 0)
        赋值 (局部_父项, 局部_父项目编号)
         ' 局部_当前记录位置 ＝ Sqlite带库表.取记录号 ()
        赋值 (局部_当前父项, 局部_父项目编号)
        未知支持库函数_12 (程序集_项目记录集句柄)
        
        .计次循环首 (未知支持库函数_7 (程序集_项目记录集句柄), 局部_计次1)
            未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_父项目编号, 局部_父项目编号)
            未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目编号, 局部_项目编号)
            未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目名, 局部_项目名)
            
            .如果真 (等于 (局部_父项目编号, 局部_当前父项))
                .如果真 (不等于 (局部_项目名, 局部_组合框.取项目文本 ( [程序集_记数], 0)))
                    局部_组合框.加入项目 ( [程序集_记数], 局部_项目名, 到整数 (局部_项目编号))
                    
                .如果真结束
                
                
            .如果真结束
            未知支持库函数_10 (程序集_项目记录集句柄)
            
        .计次循环尾 ()
        .如果真 (等于 (局部_父项, “-1”))
            返回 ()
        .如果真结束
        未知支持库函数_11 (程序集_项目记录集句柄, 程序集_当前行)
        
    .如果真结束
    未知支持库函数_10 (程序集_项目记录集句柄)
    
.计次循环尾 ()
子程序_组合框_递归 (局部_父项)


.子程序 _组合框_一级_列表项被选择, 空白型, , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_父项目编号, 文本型, , , 
.局部变量 局部_项目名, 文本型, , , 
.局部变量 局部_项目编号, 文本型, , , 
.局部变量 局部_计次1, 整数型, , , 

.如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from xm”))
    赋值 (程序集_项目记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
.如果真结束

未知支持库函数_12 (程序集_项目记录集句柄)
.计次循环首 (取项目数 (), 局部_计次)
    
    .如果真 (等于 (.现行选中项, 相减 (局部_计次, 1)))
        赋值 (类别编号, 到文本 (相减 (局部_计次, 1).取项目数值 ()))
        输出调试文本 (类别编号)
        跳出循环 ()
        
    .如果真结束
    
    
.计次循环尾 ()
清空 ()
.计次循环首 (未知支持库函数_7 (程序集_项目记录集句柄), 局部_计次1)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_父项目编号, 局部_父项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目编号, 局部_项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目名, 局部_项目名)
    .如果真 (等于 (局部_父项目编号, 类别编号))
        局部_项目名.加入项目 (到数值 (局部_项目编号))
    .如果真结束
    未知支持库函数_10 (程序集_项目记录集句柄)
    
.计次循环尾 ()
未知支持库函数_5 (程序集_项目记录集句柄)


.子程序 _组合框_二级_列表项被选择, 空白型, , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_父项目编号, 文本型, , , 
.局部变量 局部_项目名, 文本型, , , 
.局部变量 局部_项目编号, 文本型, , , 
.局部变量 局部_计次1, 整数型, , , 


.如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from xm”))
    赋值 (程序集_项目记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
.如果真结束

未知支持库函数_12 (程序集_项目记录集句柄)

.计次循环首 (取项目数 (), 局部_计次)
    .如果真 (等于 (.现行选中项, 相减 (局部_计次, 1)))
        赋值 (类别编号, 到文本 (相减 (局部_计次, 1).取项目数值 ()))
        输出调试文本 (类别编号)
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
清空 ()

.计次循环首 (未知支持库函数_7 (程序集_项目记录集句柄), 局部_计次1)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_父项目编号, 局部_父项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目编号, 局部_项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目名, 局部_项目名)
    .如果真 (等于 (局部_父项目编号, 类别编号))
        局部_项目名.加入项目 (到数值 (局部_项目编号))
    .如果真结束
    未知支持库函数_10 (程序集_项目记录集句柄)
    
.计次循环尾 ()
未知支持库函数_5 (程序集_项目记录集句柄)


.子程序 _组合框_三级_列表项被选择, 空白型, , 
.局部变量 局部_父项目编号, 文本型, , , 
.局部变量 局部_项目名, 文本型, , , 
.局部变量 局部_项目编号, 文本型, , , 
.局部变量 局部_计次1, 整数型, , , 
.局部变量 局部_计次, 整数型, , , 

.如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from xm”))
    赋值 (程序集_项目记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
.如果真结束

未知支持库函数_12 (程序集_项目记录集句柄)
.计次循环首 (取项目数 (), 局部_计次)
    .如果真 (等于 (.现行选中项, 相减 (局部_计次, 1)))
        赋值 (类别编号, 到文本 (相减 (局部_计次, 1).取项目数值 ()))
        输出调试文本 (类别编号)
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
清空 ()
.计次循环首 (未知支持库函数_7 (程序集_项目记录集句柄), 局部_计次1)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_父项目编号, 局部_父项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目编号, 局部_项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目名, 局部_项目名)
    .如果真 (等于 (局部_父项目编号, 类别编号))
        局部_项目名.加入项目 (到数值 (局部_项目编号))
    .如果真结束
    未知支持库函数_10 (程序集_项目记录集句柄)
    
.计次循环尾 ()
未知支持库函数_5 (程序集_项目记录集句柄)


.子程序 _组合框_四级_列表项被选择, 空白型, , 
.局部变量 局部_计次, 整数型, , , 


.计次循环首 (取项目数 (), 局部_计次)
    .如果真 (等于 (.现行选中项, 相减 (局部_计次, 1)))
        赋值 (类别编号, 到文本 (相减 (局部_计次, 1).取项目数值 ()))
        输出调试文本 (类别编号)
        
        赋值 (程序集_选中项目文本名, 相减 (局部_计次, 1).取项目文本 ())
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
返回 ()
' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _保存_添加_被单击, 空白型, , 
.局部变量 局部_添加赋值语句, 文本型, , , 


.如果真 (等于 (.现行选中项, -1))
    信息框 (“类别未选中！”, #错误图标, )
    返回 ()
    
.如果真结束
.如果真 (等于 (.现行选中项, -1))
    信息框 (“类别未选中！”, #错误图标, )
    返回 ()
    
.如果真结束
.如果真 (等于 (.现行选中项, -1))
    信息框 (“类别未选中！”, #错误图标, )
    返回 ()
    
.如果真结束
.如果真 (等于 (.现行选中项, -1))
    信息框 (“类别未选中！”, #错误图标, )
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“配件编号不能为空！”, #错误图标, )
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“配件名称不能为空！”, #错误图标, )
    返回 ()
.如果真结束
.如果 (等于 (新增与编辑, “修改”))
    输出调试文本 (_启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 1))
     ' 局部_添加赋值语句 ＝ “” ＋ #常量_资料_编号 ＋ “='” ＋ 编辑框_编号.内容 ＋ “',” ＋ #常量_资料_片名 ＋ “='” ＋ 编辑框_片名.内容 ＋ “',” ＋ #常量_资料_分类 ＋ “='” ＋ 程序集_选中项目文本名 ＋ “',” ＋ #常量_资料_主演 ＋ “='” ＋ 编辑框_主角.内容 ＋ “',” ＋ #常量_资料_影碟号 ＋ “='” ＋ 编辑框_带库影碟号.内容 ＋ “',” ＋ #常量_资料_导演 ＋ “='” ＋ 编辑框_导演.内容 ＋ “',” ＋ #常量_资料_集数 ＋ “='” ＋ 编辑框_集数.内容 ＋ “',” ＋ #常量_资料_金额 ＋ “='” ＋ 编辑框_金额.内容 ＋ “',” ＋ #常量_资料_日期 ＋ “='” ＋ 编辑框_日期.内容 ＋ “',” ＋ #常量_资料_备注 ＋ “='” ＋ 编辑框_备注.内容 ＋ “',” ＋ #常量_资料_图片 ＋ “='” ＋ 程序集_图片路径 ＋ “',” ＋ #常量_资料_数据编号 ＋ “='” ＋ 类别编号 ＋ “'”
    赋值 (局部_添加赋值语句, 相加 (“”, #常量_资料_编号, “='”, .内容, “',”, #常量_资料_片名, “='”, 子文本替换 (.内容, “'”, “,”, , , 假), “',”, #常量_资料_分类, “='”, 程序集_选中项目文本名, “',”, #常量_资料_主演, “='”, 子文本替换 (.内容, “'”, “,”, , , 假), “',”, #常量_资料_影碟号, “='”, 子文本替换 (.内容, “'”, “,”, , , 假), “',”, #常量_资料_导演, “='”, 子文本替换 (.内容, “'”, “,”, , , 假), “',”, #常量_资料_集数, “='”, .内容, “',”, #常量_资料_金额, “='”, .内容, “',”, #常量_资料_日期, “='”, .内容, “',”, #常量_资料_备注, “='”, 子文本替换 (.内容, “'”, “,”, , , 假), “',”, #常量_资料_图片, “='”, 程序集_图片路径, “',”, #常量_资料_数据编号, “='”, 类别编号, “'”))
    
    
    
    
    输出调试文本 (程序集_图片路径)
    .如果真 (未知支持库函数_19 (全局_MySql句柄, #常量_资料表, 局部_添加赋值语句, 程序集_获取编辑框))
        信息框 (“成功！”, 0, )
    .如果真结束
    
    
    销毁 ()
.否则
    
.如果结束
赋值 (_启动窗口..最大化按钮, 2)


.子程序 _按钮_退出_被单击, 空白型, , 
销毁 ()

.子程序 _按钮_选择图片_被单击, 空白型, , 
.局部变量 局部_路径, 文本型, , , 

赋值 (.初始目录, 相加 (取运行目录 (), “\图片”))
.如果真 (打开 ())
    赋值 (局部_路径, .文件名)
    赋值 (程序集_图片路径, 取文本右边 (局部_路径, 相减 (取文本长度 (局部_路径), 倒找文本 (局部_路径, “\”, , 真))))
    赋值 (.图片, 读入文件 (.文件名))
.如果真结束


.子程序 _按钮_更新日期_被单击, 空白型, , 
赋值 (.内容, 功能_日期转换 (取现行时间 ()))

.窗口程序集 项目管理窗口程序集, , , 

.程序集变量 程序集_计次, 整数型, , , 
.程序集变量 类别编号, 文本型, , , 
.程序集变量 父项编号, 文本型, , , 
.程序集变量 程序集_选中项目数值, 文本型, , , 
.程序集变量 程序集_是否有子项, 逻辑型, , , 
.程序集变量 程序集_选中项目父项, 整数型, , , 
.程序集变量 程序集_当前记录号, 整数型, , , 
.程序集变量 程序集_修改项目名, 文本型, , , 
.程序集变量 程序集_记录集句柄, 整数型, , , 
.程序集变量 程序集_加入记录集句柄, 整数型, , , 
.程序集变量 程序集_当前行, 整数型, , , 
.子程序 _项目管理_窗口_创建完毕, 空白型, , 

项目管理_读树型框项目 ()


.子程序 项目管理_读树型框项目, 空白型, , 
.局部变量 索引, 整数型, , , 
.局部变量 局部_启动时间, 整数型, , , 
.局部变量 局部_父项目索引, 整数型, , , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_项目名, 文本型, , , 
.局部变量 局部_项目编号, 文本型, , , 
.局部变量 局部_父项目编号, 文本型, , , 

赋值 (局部_启动时间, 取启动时间 ())
清空 ()
.如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from xm”))
    赋值 (程序集_记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
.如果真结束

赋值 (索引, 0)
未知支持库函数_12 (程序集_记录集句柄)
输出调试文本 (未知支持库函数_7 (程序集_记录集句柄))

.计次循环首 (未知支持库函数_7 (程序集_记录集句柄), 局部_计次)
    未知支持库函数_6 (程序集_记录集句柄, #常量_项目_项目名, 局部_项目名)
    未知支持库函数_6 (程序集_记录集句柄, #常量_项目_项目编号, 局部_项目编号)
    未知支持库函数_6 (程序集_记录集句柄, #常量_项目_父项目编号, 局部_父项目编号)
    赋值 (程序集_计次, 0)
    赋值 (程序集_当前行, 相加 (程序集_当前行, 1))
    
    .如果真 (等于 (取整 (到数值 (局部_父项目编号)), -1))
        赋值 (局部_父项目索引, 索引.加入项目 (局部_项目名, 0, 1, 到数值 (局部_项目编号)))
        
         ' 程序集_当前记录号 ＝ 取记录集行数 (程序集_记录集句柄)
        .如果真 (等于 (是否有子项 (局部_项目编号), 真))
            局部_父项目索引.加入项目 (“...”, , , )
        .如果真结束
        
    .如果真结束
    
    未知支持库函数_10 (程序集_记录集句柄)
.计次循环尾 ()

.计次循环首 (取项目数 (), 程序集_计次)
    相减 (程序集_计次, 2).扩展 ()
.计次循环尾 ()
赋值 (.标题, 相加 (“总共”, “ ”, 到文本 (未知支持库函数_7 (程序集_记录集句柄)), “ ”, “项”))
赋值 (局部_启动时间, 相减 (取启动时间 (), 局部_启动时间))
赋值 (.标题, 相加 (“响应时间”, “ ”, 到文本 (相除 (局部_启动时间, 1000)), “ ”, “秒”))

.子程序 是否有子项, 逻辑型, , 
.参数 参数_数据编号, 文本型, , 

.局部变量 局部_记录集句柄, 整数型, , , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_父项目编号, 文本型, , , 


未知支持库函数_3 (全局_MySql句柄, 相加 (“SELECT * FROM ”, #常量_项目表, “”))
赋值 (局部_记录集句柄, 未知支持库函数_4 (全局_MySql句柄))

.计次循环首 (未知支持库函数_7 (局部_记录集句柄), 局部_计次)
    未知支持库函数_6 (局部_记录集句柄, #常量_项目_父项目编号, 局部_父项目编号)
    .如果真 (等于 (局部_父项目编号, 参数_数据编号))
        未知支持库函数_11 (程序集_记录集句柄, 程序集_当前行)
        未知支持库函数_5 (局部_记录集句柄)
        返回 (真)
        
    .如果真结束
    未知支持库函数_10 (局部_记录集句柄)
.计次循环尾 ()
未知支持库函数_11 (程序集_记录集句柄, 程序集_当前行)
未知支持库函数_5 (局部_记录集句柄)
返回 (假)


.子程序 _按钮_框1加_被单击, 空白型, , 
.局部变量 项目编号数组, 双精度小数型, , "0", 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_父项目编号, 文本型, , , 
.局部变量 局部_项目编号, 文本型, , , 



 ' 未知支持库函数_3 (全局_MySql句柄, 相加 (“SELECT * FROM ”, #常量_项目表, “”))
赋值 (程序集_加入记录集句柄, 未知支持库函数_4 (全局_MySql句柄))

赋值 (程序集_是否有子项, 假)
.计次循环首 (未知支持库函数_7 (程序集_加入记录集句柄), 局部_计次)
    未知支持库函数_6 (程序集_加入记录集句柄, #常量_项目_父项目编号, 局部_父项目编号)
    未知支持库函数_6 (程序集_加入记录集句柄, #常量_项目_项目编号, 局部_项目编号)
    
    .如果真 (等于 (局部_父项目编号, 程序集_选中项目数值))
        加入成员 (项目编号数组, 到数值 (局部_项目编号))
        赋值 (程序集_是否有子项, 真)
    .如果真结束
    未知支持库函数_10 (程序集_加入记录集句柄)
.计次循环尾 ()
.如果真 (等于 (程序集_是否有子项, 假))
    加入成员 (项目编号数组, 到数值 (相加 (程序集_选中项目数值, “10”)))
.如果真结束

子程序_加入 (项目编号数组, )


.子程序 子程序_加入, 空白型, , 
.参数 参数_项目编号数组, 双精度小数型, 数组, 
.参数 参数_分组框, 分组框, , 

.局部变量 局部_句柄, 整数型, , , 
.局部变量 局部_数目, 整数型, , , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_组件, 选择框, , , 
.局部变量 局部_名称, 文本型, , , 
.局部变量 局部_组件标题, 文本型, , , 
.局部变量 局部_增加计次, 整数型, , , 
.局部变量 局部_组件框未选中, 逻辑型, , , 
.局部变量 赋值语句, 文本型, , , 
.局部变量 局部_父项目编号, 文本型, , , 
.局部变量 局部_项目编号, 文本型, , , 
.局部变量 局部_项目名, 文本型, , , 
.局部变量 局部_记录集句柄, 整数型, , , 
.局部变量 局部_常量, 文本型, , , 

数组排序 (参数_项目编号数组, 假)
赋值 (局部_句柄, 寻找组件 (参数_分组框, “选择框”, , , ))
赋值 (局部_数目, 取找到组件数目 (局部_句柄))
赋值 (局部_增加计次, 1)

未知支持库函数_3 (全局_MySql句柄, 相加 (“SELECT * FROM ”, #常量_项目表, “”))
赋值 (局部_记录集句柄, 未知支持库函数_4 (全局_MySql句柄))


.计次循环首 (局部_数目, 局部_计次)
    赋值 (局部_组件, 取所找到组件 (局部_句柄, 相减 (局部_计次, 1)))
    赋值 (局部_名称, 取组件名称 (取所找到组件 (局部_句柄, 相减 (局部_计次, 1))))
    .如果真 (等于 (局部_组件.选中, 真))
        赋值 (局部_组件标题, 取文本右边 (局部_名称, 相减 (取文本长度 (局部_名称), 倒找文本 (局部_名称, “_”, , 假))))
        .如果 (等于 (程序集_是否有子项, 真))
            赋值 (局部_父项目编号, 程序集_选中项目数值)
            赋值 (局部_项目编号, 到文本 (相加 (参数_项目编号数组 [1], 局部_增加计次)))
            赋值 (局部_项目名, 局部_组件标题)
            赋值 (赋值语句, 相加 (“”, #常量_项目_父项目编号, “='”, 局部_父项目编号, “',”, #常量_项目_项目编号, “='”, 局部_项目编号, “',”, #常量_项目_项目名, “='”, 局部_项目名, “'”))
            .如果真 (未知支持库函数_18 (全局_MySql句柄, #常量_项目表, 赋值语句))
                 ' 信息框 (“加入成功”, 0, )
            .如果真结束
            
            赋值 (局部_增加计次, 相加 (局部_增加计次, 1))
        .否则
            
            赋值 (局部_父项目编号, 程序集_选中项目数值)
            赋值 (局部_项目编号, 到文本 (相加 (参数_项目编号数组 [1], 0)))
            赋值 (局部_项目名, 局部_组件标题)
            赋值 (赋值语句, 相加 (“”, #常量_项目_父项目编号, “='”, 局部_父项目编号, “',”, #常量_项目_项目编号, “='”, 局部_项目编号, “',”, #常量_项目_项目名, “='”, 局部_项目名, “'”))
            .如果真 (未知支持库函数_18 (全局_MySql句柄, #常量_项目表, 赋值语句))
                 ' 信息框 (“加入成功”, 0, )
            .如果真结束
            赋值 (程序集_是否有子项, 真)
            
            
            
            
        .如果结束
        赋值 (局部_组件框未选中, 真)
    .如果真结束
    ' 本源码来自易语言资源网(www.wodesoft.com)
    
    
.计次循环尾 ()

.如果真 (等于 (局部_组件框未选中, 假))
    
    .判断开始 (等于 (程序集_是否有子项, 真))
        
        赋值 (局部_父项目编号, 程序集_选中项目数值)
        赋值 (局部_项目编号, 到文本 (相加 (参数_项目编号数组 [1], 局部_增加计次)))
        赋值 (局部_项目名, .内容)
        赋值 (赋值语句, 相加 (“”, #常量_项目_父项目编号, “='”, 局部_父项目编号, “',”, #常量_项目_项目编号, “='”, 局部_项目编号, “',”, #常量_项目_项目名, “='”, 局部_项目名, “'”))
        .如果真 (未知支持库函数_18 (全局_MySql句柄, #常量_项目表, 赋值语句))
             ' 信息框 (“加入成功”, 0, )
        .如果真结束
        
        赋值 (局部_增加计次, 相加 (局部_增加计次, 1))
    .默认
        
        赋值 (局部_父项目编号, 程序集_选中项目数值)
        赋值 (局部_项目编号, 到文本 (相加 (参数_项目编号数组 [1], 0)))
        赋值 (局部_项目名, .内容)
        赋值 (赋值语句, 相加 (“”, #常量_项目_父项目编号, “='”, 局部_父项目编号, “',”, #常量_项目_项目编号, “='”, 局部_项目编号, “',”, #常量_项目_项目名, “='”, 局部_项目名, “'”))
         ' 局部_常量 ＝ “insert into xm set ” ＋ #常量_项目_父项目编号 ＋ “='” ＋ 局部_父项目编号 ＋ “',” ＋ #常量_项目_项目编号 ＋ “='” ＋ 局部_项目编号 ＋ “',” ＋ #常量_项目_项目名 ＋ “='” ＋ 局部_项目名 ＋ “'”
        未知支持库函数_13 (全局_MySql句柄)
        .如果真 (未知支持库函数_18 (全局_MySql句柄, #常量_项目表, 赋值语句))
             ' 信息框 (“加入成功”, 0, )
        .如果真结束
         ' .如果真 (未知支持库函数_3 (全局_MySql句柄, 局部_常量))
             ' 信息框 (“37775”, 0, )
        .如果真结束
        
        
        赋值 (程序集_是否有子项, 真)
        
    .判断结束
    赋值 (局部_组件框未选中, 假)
.如果真结束
未知支持库函数_5 (局部_记录集句柄)

项目管理_读树型框项目 ()
_启动窗口.读树型框项目 ()


.子程序 _树型框1_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

赋值 (程序集_选中项目数值, 到文本 (.取项目数值 (.最大化按钮)))
赋值 (程序集_选中项目父项, .取父项目 (.最大化按钮))

赋值 (.内容, .取项目文本 (.最大化按钮))
赋值 (程序集_修改项目名, .内容)
输出调试文本 (程序集_选中项目数值)


.子程序 _按钮_删除_被单击, 空白型, , 
.局部变量 局部删除_记录集句柄, 整数型, , , 
.局部变量 局部_子记录集, 整数型, , , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_数据编号, 文本型, , , 
.局部变量 局部_是否有资料, 逻辑型, , , 



.如果真 (等于 (.最大化按钮, -1))
    信息框 (“请先选择类别名称”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (.是否有子项目 (.最大化按钮), 真))
    信息框 (“此类别下还有子类别,不能删除!”, 0, )
    返回 ()
.如果真结束

 ' 赋值 (局部_子记录集, 未知支持库函数_17 (全局_MySql句柄, #常量_资料表, #常量_资料_数据编号, 相加 (“”, #常量_资料_数据编号, “='”, 程序集_选中项目数值, “'”), 相加 (“”, #常量_资料_数据编号, “ ASC”)))
.计次循环首 (未知支持库函数_7 (局部_子记录集), 局部_计次)
    未知支持库函数_6 (局部_子记录集, #常量_资料_数据编号, 局部_数据编号)
    .如果真 (等于 (局部_数据编号, 程序集_选中项目数值))
        未知支持库函数_5 (局部_子记录集)
        赋值 (局部_是否有资料, 真)
        跳出循环 ()
    .如果真结束
    未知支持库函数_10 (局部_子记录集)
.计次循环尾 ()
.如果真 (等于 (局部_是否有资料, 真))
    信息框 (“此类别下还有资料,不能删除!”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“确定删除选定的类别名称吗？”, 相加 (1, #错误图标), ), 1))
    返回 ()
.如果真结束
.如果真 (未知支持库函数_20 (全局_MySql句柄, #常量_项目表, 相加 (“”, #常量_项目_项目编号, “='”, 程序集_选中项目数值, “'”)))
    信息框 (“删除成功”, 0, )
    项目管理_读树型框项目 ()
    _启动窗口.读树型框项目 ()
.如果真结束



.子程序 _按钮_修改项目名_被单击, 空白型, , 
.局部变量 局部_项目编号, 文本型, , , 
.局部变量 局部_父项目编号, 文本型, , , 
.局部变量 局部_修改项目名, 文本型, , , 

.如果真 (等于 (信息框 (“是否要修改此项!”, 相加 (#是否钮, #错误图标), ), 6))
    返回 ()
.如果真结束
 ' .如果真 (未知支持库函数_19 (全局_MySql句柄, #常量_项目表, 相加 (“”, #常量_项目_项目名, “='”, .内容, “'”), 相加 (“”, #常量_项目_项目名, “='”, 程序集_修改项目名, “'”)))
    信息框 (“更新成功”, #信息图标, )
    项目管理_读树型框项目 ()
    
.如果真结束



.子程序 _树型框1_即将扩展, 逻辑型, , 
.参数 项目索引, 整数型, , 

.局部变量 局部_索引, 整数型, , , 
.局部变量 局部_父项目索引, 整数型, , , 
.局部变量 局部_记录集句柄, 整数型, , , 
.局部变量 局部_父项目编号, 文本型, , , 
.局部变量 局部_项目名, 文本型, , , 
.局部变量 局部_项目编号, 文本型, , , 
.局部变量 局部_计次, 整数型, , , 


.如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from xm”))
    赋值 (局部_记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
.如果真结束

输出调试文本 (未知支持库函数_7 (局部_记录集句柄))


.判断循环首 (大于或等于 (相加 (项目索引, 1).取父项目 (), 项目索引))
    相加 (项目索引, 1).删除项目 ()
.判断循环尾 ()
未知支持库函数_12 (局部_记录集句柄)

.计次循环首 (未知支持库函数_7 (局部_记录集句柄), 局部_计次)
    
    未知支持库函数_6 (局部_记录集句柄, #常量_项目_项目编号, 局部_项目编号)
    
    未知支持库函数_6 (局部_记录集句柄, #常量_项目_项目名, 局部_项目名)
    
    未知支持库函数_6 (局部_记录集句柄, #常量_项目_父项目编号, 局部_父项目编号)
    
    .如果真 (等于 (取整 (到数值 (局部_父项目编号)), 项目索引.取项目数值 ()))
        赋值 (局部_父项目索引, 项目索引.加入项目 (局部_项目名, 0, 1, 到数值 (局部_项目编号)))
        
        赋值 (程序集_当前行, 相加 (程序集_当前行, 1))
        .如果真 (等于 (是否有子项 (局部_项目编号), 真))
            局部_父项目索引.加入项目 (“...”, , , )
        .如果真结束
        
    .如果真结束
    未知支持库函数_10 (局部_记录集句柄)
    
    
    
.计次循环尾 ()
未知支持库函数_5 (局部_记录集句柄)



.窗口程序集 数据库管理窗口程序集, , , 

.子程序 _数据库管理_窗口_创建完毕, 空白型, , 
数据库管理_显示 ()


.子程序 _按钮_备份_被单击, 空白型, , 
.局部变量 局部_日期, 文本型, , , 
.局部变量 a, 文本型, , , 

赋值 (.标题, “数据备份中…”)
赋值 (.可视, 真)
赋值 (.可视, 真)
赋值 (局部_日期, 功能_日期转换 (取现行时间 ()))
赋值 (.时钟周期, 25)
运行 (相加 (“cmd /c mysqldump -u root dk > ”, 取运行目录 (), “\bakdata\”, 局部_日期, “.sql”), 真, #隐藏窗口)
数据库管理_显示 ()

.子程序 _按钮_恢复_被单击, 空白型, , 
 ' 运行 (“cmd /c mysql -u root DK < d:\backup.sql”, 假, )
赋值 (.标题, “数据恢复中…”)
.判断开始 (等于 (取文本右边 (.目录, 1), “\”))
    运行 (相加 (“cmd /c mysql -u root DK < ”, .目录, .被选择文件, “”), 真, #隐藏窗口)
.默认
    运行 (相加 (“cmd /c mysql -u root DK < ”, .目录, “\”, .被选择文件, “”), 真, #隐藏窗口)
.判断结束
赋值 (.可视, 真)
赋值 (.可视, 真)
赋值 (.时钟周期, 25)
赋值 (.位置, 0)

.子程序 _时钟_数据库进度_周期事件, 空白型, , 
赋值 (.位置, 相加 (.位置, 1))
.如果真 (等于 (.位置, 95))
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.时钟周期, 0)
    赋值 (.位置, 0)
.如果真结束
' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 数据库管理_显示, 空白型, , 
.局部变量 局部找到数据文件, 文本型, , , 

.如果真 (等于 (文件是否存在 (相加 (取运行目录 (), “\bakdata”)), 假))
    创建目录 (相加 (取运行目录 (), “\bakdata”))
.如果真结束
.如果真 (等于 (文件是否存在 (相加 (取运行目录 (), “\ini”)), 假))
    创建目录 (相加 (取运行目录 (), “\ini”))
.如果真结束
赋值 (.目录, 相加 (取运行目录 (), “\bakdata”))
输出调试文本 (.目录)


.程序集 功能_程序集, , , 

.子程序 功能_日期转换, 文本型, , 格式为2008-12-12
.参数 参数_现行时间, 日期时间型, , 取现行时间

.局部变量 年, 文本型, , , 
.局部变量 月, 文本型, , , 
.局部变量 日, 文本型, , , 
.局部变量 局部_文本日期, 文本型, , , 

赋值 (年, 取文本右边 (到文本 (取年份 (取现行时间 ())), 4))
.如果 (小于 (取月份 (取现行时间 ()), 10))
    赋值 (月, 相加 (“0”, 到文本 (取月份 (取现行时间 ()))))
.否则
    赋值 (月, 到文本 (取月份 (取现行时间 ())))
.如果结束
.如果 (小于 (取日 (取现行时间 ()), 10))
    赋值 (日, 相加 (“0”, 到文本 (取日 (取现行时间 ()))))
.否则
    赋值 (日, 到文本 (取日 (取现行时间 ())))
.如果结束
赋值 (局部_文本日期, 相加 (年, “-”, 月, “-”, 日))
返回 (局部_文本日期)


.窗口程序集 查询_窗口程序集, , , 

.程序集变量 程序集_总页数, 整数型, , , 
.程序集变量 程序集_记录集句柄, 整数型, , , 
.程序集变量 程序集_当前页码, 整数型, , , 
.程序集变量 程序集_开始位置, 整数型, , , 
.程序集变量 程序集_日期开始, 文本型, , , 
.程序集变量 程序集_日期结束, 文本型, , , 
.程序集变量 匿名程序集变量_4271, 空白型, , , 
.程序集变量 程序集_关闭记录项目数值, 文本型, , , 
.程序集变量 程序集_选中项目文本名, 文本型, , , 
.程序集变量 程序集_表格计次, 整数型, , , 
.程序集变量 程序集_项目记录集句柄, 整数型, , , 
.程序集变量 程序集_当前行, 整数型, , , 
.程序集变量 类别编号, 文本型, , , 
.程序集变量 程序集_记数, 整数型, , , 
.子程序 查询窗口表头, 空白型, , 
赋值 (., 1)
0.未知支持库函数_9 (1, #., “编号”)
0.未知支持库函数_9 (2, #., “片名”)
0.未知支持库函数_9 (3, #., “分类”)
0.未知支持库函数_9 (4, #., “主演”)
0.未知支持库函数_9 (5, #., “导演”)
0.未知支持库函数_9 (6, #., “集数”)
0.未知支持库函数_9 (7, #., “影碟号”)
0.未知支持库函数_9 (8, #., “日期”)
0.未知支持库函数_32 (0)
1.未知支持库函数_32 (60)
2.未知支持库函数_32 (160)
3.未知支持库函数_32 (80)
4.未知支持库函数_32 (160)
5.未知支持库函数_32 (140)
6.未知支持库函数_32 (100)
7.未知支持库函数_32 (70)
8.未知支持库函数_32 (80)
0.未知支持库函数_18 (0, 0, ., 12)

.子程序 子程序_显示表格, 空白型, , 
.参数 参数_记录集句柄, 整数型, , 
.参数 参数_当前页码, 整数型, , 

.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_树型编号, 文本型, , , 
.局部变量 局部_树型片名, 文本型, , , 
.局部变量 局部_树型分类, 文本型, , , 
.局部变量 局部_树型主演, 文本型, , , 
.局部变量 局部_树型导演, 文本型, , , 
.局部变量 局部_树型集数, 文本型, , , 
.局部变量 局部_树型影碟号, 文本型, , , 
.局部变量 局部_结束位置, 整数型, , , 
.局部变量 局部_行计次, 整数型, , , 
.局部变量 局部_开始位置, 整数型, , , 
.局部变量 局部_响应时间, 整数型, , , 
.局部变量 局部_树型日期, 日期时间型, , , 

赋值 (局部_响应时间, 取启动时间 ())
查询窗口表头 ()
.判断开始 (不等于 (求余数 (未知支持库函数_7 (参数_记录集句柄), #常量_每页数), 0))
    赋值 (程序集_总页数, 相加 (取整 (相除 (未知支持库函数_7 (参数_记录集句柄), #常量_每页数)), 1))
.默认
    赋值 (程序集_总页数, 相除 (到数值 (未知支持库函数_7 (参数_记录集句柄)), 到数值 (#常量_每页数)))
.判断结束
赋值 (局部_开始位置, 相加 (相乘 (相减 (参数_当前页码, 1), #常量_每页数), 1))
赋值 (局部_结束位置, 相减 (相加 (局部_开始位置, #常量_每页数), 1))
.如果真 (等于 (未知支持库函数_7 (程序集_记录集句柄), 0))
    赋值 (程序集_当前页码, 0)
    
    子程序_状态显示 ()
    返回 ()
.如果真结束

.如果真 (大于 (局部_结束位置, 未知支持库函数_7 (参数_记录集句柄)))
    赋值 (局部_结束位置, 未知支持库函数_7 (参数_记录集句柄))
.如果真结束
.如果真 (或者 (小于或等于 (局部_开始位置, 0), 大于 (局部_开始位置, 未知支持库函数_7 (参数_记录集句柄))))
    返回 ()
.如果真结束

赋值 (局部_行计次, 1)
未知支持库函数_11 (参数_记录集句柄, 相减 (局部_开始位置, 1))
.变量循环首 (局部_开始位置, 局部_结束位置, 1, 局部_计次)
    未知支持库函数_6 (参数_记录集句柄, #常量_资料_编号, 局部_树型编号)
    未知支持库函数_6 (参数_记录集句柄, #常量_资料_片名, 局部_树型片名)
    未知支持库函数_6 (参数_记录集句柄, #常量_资料_分类, 局部_树型分类)
    未知支持库函数_6 (参数_记录集句柄, #常量_资料_主演, 局部_树型主演)
    未知支持库函数_6 (参数_记录集句柄, #常量_资料_导演, 局部_树型导演)
    未知支持库函数_6 (参数_记录集句柄, #常量_资料_集数, 局部_树型集数)
    未知支持库函数_6 (参数_记录集句柄, #常量_资料_影碟号, 局部_树型影碟号)
    未知支持库函数_6 (参数_记录集句柄, #常量_资料_日期, 局部_树型日期)
    
    .未知支持库函数_38 ()
    局部_行计次.未知支持库函数_9 (1, #., 局部_树型编号)
    局部_行计次.未知支持库函数_9 (2, #., 局部_树型片名)
    局部_行计次.未知支持库函数_9 (3, #., 局部_树型分类)
    局部_行计次.未知支持库函数_9 (4, #., 局部_树型主演)
    局部_行计次.未知支持库函数_9 (5, #., 局部_树型导演)
    局部_行计次.未知支持库函数_9 (6, #., 局部_树型集数)
    局部_行计次.未知支持库函数_9 (7, #., 局部_树型影碟号)
    局部_行计次.未知支持库函数_9 (8, #., 到文本 (局部_树型日期))
    赋值 (局部_行计次, 相加 (局部_行计次, 1))
    未知支持库函数_10 (参数_记录集句柄)
.变量循环尾 ()
子程序_状态显示 ()
赋值 (局部_响应时间, 相减 (取启动时间 (), 局部_响应时间))

赋值 (.标题, 相加 (“运行时间”, 到文本 (相除 (局部_响应时间, 1000)), “秒”))

.子程序 _按钮_首页_被单击, 空白型, , 
赋值 (程序集_当前页码, 1)
子程序_显示表格 (程序集_记录集句柄, 程序集_当前页码)
子程序_状态显示 ()


.子程序 _按钮_尾页_被单击, 空白型, , 
赋值 (程序集_当前页码, 程序集_总页数)
子程序_显示表格 (程序集_记录集句柄, 程序集_当前页码)
子程序_状态显示 ()


.子程序 _按钮_上一页_被单击, 空白型, , 
.如果真 (大于 (程序集_当前页码, 1))
    赋值 (程序集_当前页码, 相减 (程序集_当前页码, 1))
    子程序_显示表格 (程序集_记录集句柄, 程序集_当前页码)
    输出调试文本 (程序集_当前页码)
    子程序_状态显示 ()
.如果真结束


.子程序 _按钮_下一页_被单击, 空白型, , 
.如果真 (小于 (程序集_当前页码, 程序集_总页数))
    赋值 (程序集_当前页码, 相加 (程序集_当前页码, 1))
    子程序_显示表格 (程序集_记录集句柄, 程序集_当前页码)
    输出调试文本 (程序集_当前页码)
.如果真结束


.子程序 子程序_状态显示, 空白型, , 
赋值 (.标题, 相加 (“当前页”, 到文本 (程序集_当前页码), “/”, 到文本 (程序集_总页数), “总页数”))
赋值 (.标题, 相加 (“当前显示数”, 到文本 (相减 (., 1)), “/”, 到文本 (未知支持库函数_7 (程序集_记录集句柄)), “总数”))


.子程序 _按钮_查找_被单击, 空白型, , 
.局部变量 局部_语句, 文本型, , , 


未知支持库函数_5 (程序集_记录集句柄)
赋值 (计次, 1)
赋值 (程序集_当前页码, 1)
.如果真 (等于 (.选中, 真))
    赋值 (局部_语句, 相加 (局部_语句, “ and ”, #常量_资料_编号, “='”, .内容, “'”))
    
.如果真结束
.如果真 (等于 (.选中, 真))
    赋值 (局部_语句, 相加 (局部_语句, “ and ”, #常量_资料_片名, “ like '%%”, .内容, “%%'”))
    
.如果真结束
.如果真 (等于 (.选中, 真))
    赋值 (局部_语句, 相加 (局部_语句, “ and ”, #常量_资料_主演, “ like '%%”, .内容, “%%'”))
    
.如果真结束
.如果真 (等于 (.选中, 真))
    赋值 (局部_语句, 相加 (局部_语句, “ and ”, #常量_资料_导演, “ like '%%”, .内容, “%%'”))
    
.如果真结束
.如果真 (等于 (.选中, 真))
    赋值 (局部_语句, 相加 (局部_语句, “ and ”, #常量_资料_集数, “='”, .内容, “'”))
    
.如果真结束
.如果真 (等于 (.选中, 真))
    赋值 (局部_语句, 相加 (局部_语句, “ and ”, #常量_资料_影碟号, “='”, .内容, “'”))
    
.如果真结束
.如果真 (等于 (.选中, 真))
    赋值 (局部_语句, 相加 (局部_语句, “ and ”, #常量_资料_日期, “ between '”, 程序集_日期开始, “' and '”, 程序集_日期结束, “'”))
    
.如果真结束
.如果真 (等于 (.选中, 真))
    赋值 (局部_语句, 相加 (局部_语句, “ and ”, #常量_资料_数据编号, “ like '”, 到文本 (.取项目数值 (.现行选中项)), “%'”))
    
.如果真结束
.如果真 (等于 (.选中, 真))
    赋值 (局部_语句, 相加 (局部_语句, “ and ”, #常量_资料_数据编号, “ like '”, 到文本 (.取项目数值 (.现行选中项)), “%'”))
    
.如果真结束
.如果真 (等于 (.选中, 真))
    赋值 (局部_语句, 相加 (局部_语句, “ and ”, #常量_资料_数据编号, “ like '”, 到文本 (.取项目数值 (.现行选中项)), “%'”))
    
.如果真结束
.如果真 (等于 (.选中, 真))
    赋值 (局部_语句, 相加 (局部_语句, “ and ”, #常量_资料_数据编号, “ like '”, 到文本 (.取项目数值 (.现行选中项)), “%'”))
    
.如果真结束
.如果真 (等于 (.选中, 真))
    赋值 (局部_语句, 相加 (局部_语句, “ and ”, #常量_资料_分类, “ like '”, 到文本 (.取项目文本 (.现行选中项)), “%'”))
    
.如果真结束
.如果真 (等于 (取文本左边 (局部_语句, 4), “ and”))
    赋值 (局部_语句, 取文本右边 (局部_语句, 相减 (取文本长度 (局部_语句), 4)))
    赋值 (局部_语句, 相加 (“select * from zl where”, 局部_语句))
.如果真结束

输出调试文本 (局部_语句)
.判断开始 (等于 (未知支持库函数_3 (全局_MySql句柄, 局部_语句), 真))
    赋值 (程序集_记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
    .如果真 (等于 (未知支持库函数_7 (程序集_记录集句柄), 0))
        信息框 (“没有要查询的数据!”, #信息图标, )
        
    .如果真结束
    子程序_显示表格 (程序集_记录集句柄, 程序集_当前页码)
    
.默认
    信息框 (“没有选中要查询的条件!”, #错误图标, )
.判断结束



.子程序 子程序_日期转换, 文本型, , 
.参数 参数_日期, 日期时间型, , 

.局部变量 年, 文本型, , , 
.局部变量 月, 文本型, , , 
.局部变量 日, 文本型, , , 
.局部变量 局部_文本日期, 文本型, , , 

赋值 (年, 到文本 (取年份 (参数_日期)))
.如果 (小于 (取月份 (参数_日期), 10))
    赋值 (月, 相加 (“0”, 到文本 (取月份 (参数_日期))))
.否则
    赋值 (月, 到文本 (取月份 (参数_日期)))
.如果结束
.如果 (小于 (取日 (参数_日期), 10))
    赋值 (日, 相加 (“0”, 到文本 (取日 (参数_日期))))
.否则
    赋值 (日, 到文本 (取日 (参数_日期)))
.如果结束
赋值 (局部_文本日期, 相加 (年, “-”, 月, “-”, 日))
返回 (局部_文本日期)


.子程序 查询_组合框_递归, 空白型, , 
.参数 参数_数据编号, 文本型, , 

.局部变量 局部_组合框, 组合框, , "5", 
.局部变量 局部_父项, 文本型, , , 
.局部变量 局部_当前记录位置, 整数型, , , 
.局部变量 局部_当前父项, 文本型, , , 
.局部变量 局部_父项目编号, 文本型, , , 
.局部变量 局部_项目名, 文本型, , , 
.局部变量 局部_项目编号, 文本型, , , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_计次1, 整数型, , , 

赋值 (程序集_当前行, 0)
赋值 (局部_组合框 [1], )
赋值 (局部_组合框 [2], )
赋值 (局部_组合框 [3], )
赋值 (局部_组合框 [4], )
赋值 (局部_组合框 [5], )
.如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from xm”))
    赋值 (程序集_项目记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
    未知支持库函数_12 (程序集_项目记录集句柄)
.如果真结束

赋值 (程序集_记数, 相加 (程序集_记数, 1))
 ' 本源码来自易语言资源网(www.wodesoft.com)
.如果真 (等于 (参数_数据编号, “-1”))
    赋值 (程序集_记数, 0)
    返回 ()
.如果真结束
.计次循环首 (未知支持库函数_7 (程序集_项目记录集句柄), 局部_计次)
    
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_父项目编号, 局部_父项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目编号, 局部_项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目名, 局部_项目名)
    赋值 (程序集_当前行, 相加 (程序集_当前行, 1))
    
     ' .如果真 (等于 (局部_项目编号, 参数_数据编号))
        局部_组合框.加入项目 ( [程序集_记数], 局部_项目名, 到整数 (局部_项目编号))
        赋值 (局部_组合框 [程序集_记数], 现行选中项, 0)
        赋值 (局部_父项, 局部_父项目编号)
        
        赋值 (局部_当前父项, 局部_父项目编号)
        未知支持库函数_12 (程序集_项目记录集句柄)
        
        .计次循环首 (未知支持库函数_7 (程序集_项目记录集句柄), 局部_计次1)
            未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_父项目编号, 局部_父项目编号)
            未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目编号, 局部_项目编号)
            未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目名, 局部_项目名)
            
            .如果真 (等于 (局部_父项目编号, 局部_当前父项))
                .如果真 (不等于 (局部_项目名, 局部_组合框.取项目文本 ( [程序集_记数], 0)))
                    局部_组合框.加入项目 ( [程序集_记数], 局部_项目名, 到整数 (局部_项目编号))
                    
                .如果真结束
                
                
            .如果真结束
            未知支持库函数_10 (程序集_项目记录集句柄)
            
        .计次循环尾 ()
        .如果真 (等于 (局部_父项, “-1”))
            返回 ()
        .如果真结束
        未知支持库函数_11 (程序集_项目记录集句柄, 程序集_当前行)
        
    .如果真结束
    未知支持库函数_10 (程序集_项目记录集句柄)
    
.计次循环尾 ()
查询_组合框_递归 (局部_父项)


.子程序 查询窗口读组合框, 空白型, , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_父项目编号, 文本型, , , 
.局部变量 局部_项目名, 文本型, , , 
.局部变量 局部_项目编号, 文本型, , , 


.如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from xm”))
    赋值 (程序集_项目记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
.如果真结束

未知支持库函数_12 (程序集_项目记录集句柄)
.计次循环首 (未知支持库函数_7 (程序集_项目记录集句柄), 局部_计次)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_父项目编号, 局部_父项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目编号, 局部_项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目名, 局部_项目名)
    
    .如果真 (等于 (取整 (到数值 (局部_父项目编号)), -1))
        
        局部_项目名.加入项目 (到数值 (局部_项目编号))
        
    .如果真结束
    未知支持库函数_10 (程序集_项目记录集句柄)
    
.计次循环尾 ()
未知支持库函数_5 (程序集_项目记录集句柄)



.子程序 _组合框_零级_列表项被选择, 空白型, , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_父项目编号, 文本型, , , 
.局部变量 局部_项目名, 文本型, , , 
.局部变量 局部_项目编号, 文本型, , , 
.局部变量 局部_计次1, 整数型, , , 

.如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from xm”))
    赋值 (程序集_项目记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
.如果真结束

未知支持库函数_12 (程序集_项目记录集句柄)
.计次循环首 (取项目数 (), 局部_计次)
    
    .如果真 (等于 (.现行选中项, 相减 (局部_计次, 1)))
        赋值 (类别编号, 到文本 (相减 (局部_计次, 1).取项目数值 ()))
        输出调试文本 (类别编号)
        跳出循环 ()
        
    .如果真结束
    
    
.计次循环尾 ()
清空 ()
.计次循环首 (未知支持库函数_7 (程序集_项目记录集句柄), 局部_计次1)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_父项目编号, 局部_父项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目编号, 局部_项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目名, 局部_项目名)
    .如果真 (等于 (局部_父项目编号, 类别编号))
        局部_项目名.加入项目 (到数值 (局部_项目编号))
    .如果真结束
    未知支持库函数_10 (程序集_项目记录集句柄)
    
.计次循环尾 ()
未知支持库函数_5 (程序集_项目记录集句柄)

.子程序 _组合框_一级_列表项被选择, 空白型, , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_父项目编号, 文本型, , , 
.局部变量 局部_项目名, 文本型, , , 
.局部变量 局部_项目编号, 文本型, , , 
.局部变量 局部_计次1, 整数型, , , 

.如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from xm”))
    赋值 (程序集_项目记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
.如果真结束

未知支持库函数_12 (程序集_项目记录集句柄)
.计次循环首 (取项目数 (), 局部_计次)
    
    .如果真 (等于 (.现行选中项, 相减 (局部_计次, 1)))
        赋值 (类别编号, 到文本 (相减 (局部_计次, 1).取项目数值 ()))
        输出调试文本 (类别编号)
        跳出循环 ()
        
    .如果真结束
    
    
.计次循环尾 ()
清空 ()
.计次循环首 (未知支持库函数_7 (程序集_项目记录集句柄), 局部_计次1)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_父项目编号, 局部_父项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目编号, 局部_项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目名, 局部_项目名)
    .如果真 (等于 (局部_父项目编号, 类别编号))
        局部_项目名.加入项目 (到数值 (局部_项目编号))
    .如果真结束
    未知支持库函数_10 (程序集_项目记录集句柄)
    
.计次循环尾 ()
未知支持库函数_5 (程序集_项目记录集句柄)


.子程序 _组合框_二级_列表项被选择, 空白型, , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_父项目编号, 文本型, , , 
.局部变量 局部_项目名, 文本型, , , 
.局部变量 局部_项目编号, 文本型, , , 
.局部变量 局部_计次1, 整数型, , , 


.如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from xm”))
    赋值 (程序集_项目记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
.如果真结束

未知支持库函数_12 (程序集_项目记录集句柄)

.计次循环首 (取项目数 (), 局部_计次)
    .如果真 (等于 (.现行选中项, 相减 (局部_计次, 1)))
        赋值 (类别编号, 到文本 (相减 (局部_计次, 1).取项目数值 ()))
        输出调试文本 (类别编号)
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
清空 ()

.计次循环首 (未知支持库函数_7 (程序集_项目记录集句柄), 局部_计次1)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_父项目编号, 局部_父项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目编号, 局部_项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目名, 局部_项目名)
    .如果真 (等于 (局部_父项目编号, 类别编号))
        局部_项目名.加入项目 (到数值 (局部_项目编号))
    .如果真结束
    未知支持库函数_10 (程序集_项目记录集句柄)
    
.计次循环尾 ()
未知支持库函数_5 (程序集_项目记录集句柄)
' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _组合框_三级_列表项被选择, 空白型, , 
.局部变量 局部_父项目编号, 文本型, , , 
.局部变量 局部_项目名, 文本型, , , 
.局部变量 局部_项目编号, 文本型, , , 
.局部变量 局部_计次1, 整数型, , , 
.局部变量 局部_计次, 整数型, , , 

.如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from xm”))
    赋值 (程序集_项目记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
.如果真结束

未知支持库函数_12 (程序集_项目记录集句柄)
.计次循环首 (取项目数 (), 局部_计次)
    .如果真 (等于 (.现行选中项, 相减 (局部_计次, 1)))
        赋值 (类别编号, 到文本 (相减 (局部_计次, 1).取项目数值 ()))
        输出调试文本 (类别编号)
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
清空 ()
.计次循环首 (未知支持库函数_7 (程序集_项目记录集句柄), 局部_计次1)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_父项目编号, 局部_父项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目编号, 局部_项目编号)
    未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目名, 局部_项目名)
    .如果真 (等于 (局部_父项目编号, 类别编号))
        局部_项目名.加入项目 (到数值 (局部_项目编号))
    .如果真结束
    未知支持库函数_10 (程序集_项目记录集句柄)
    
.计次循环尾 ()
未知支持库函数_5 (程序集_项目记录集句柄)


.子程序 _组合框_四级_列表项被选择, 空白型, , 
.局部变量 局部_计次, 整数型, , , 


.计次循环首 (取项目数 (), 局部_计次)
    .如果真 (等于 (.现行选中项, 相减 (局部_计次, 1)))
        赋值 (类别编号, 到文本 (相减 (局部_计次, 1).取项目数值 ()))
        输出调试文本 (类别编号)
        赋值 (程序集_关闭记录项目数值, 到文本 (相减 (局部_计次, 1).取项目数值 ()))
        赋值 (程序集_选中项目文本名, 相减 (局部_计次, 1).取项目文本 ())
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()

.子程序 _日期框_开始_选择日期被改变, 空白型, , 
赋值 (程序集_日期开始, 子程序_日期转换 (.今天))

.子程序 _日期框_结束_选择日期被改变, 空白型, , 
赋值 (程序集_日期结束, 子程序_日期转换 (.今天))


.子程序 _选择框_日期_被单击, 空白型, , 
.如果真 (等于 (.选中, 真))
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (等于 (.选中, 假))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.如果真结束


.子程序 _选择框_编号_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.禁止, 假)
    赋值 (.背景颜色, #白色)
.否则
    赋值 (.禁止, 真)
    赋值 (.背景颜色, #默认色)
.如果结束


.子程序 _选择框_片名_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.禁止, 假)
    赋值 (.背景颜色, #白色)
.否则
    赋值 (.禁止, 真)
    赋值 (.背景颜色, #默认色)
.如果结束


.子程序 _选择框_主演_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.禁止, 假)
    赋值 (.背景颜色, #白色)
.否则
    赋值 (.禁止, 真)
    赋值 (.背景颜色, #默认色)
.如果结束


.子程序 _选择框_导演_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.背景颜色, #白色)
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
    赋值 (.背景颜色, #默认色)
.如果结束


.子程序 _选择框_集数_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.背景颜色, #白色)
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
    赋值 (.背景颜色, #默认色)
.如果结束


.子程序 _选择框_碟号_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.背景颜色, #白色)
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
    赋值 (.背景颜色, #默认色)
.如果结束


.子程序 _选择框_一级_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
.如果结束


.子程序 _选择框_二级_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
.如果结束


.子程序 _选择框_三级_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
.如果结束


.子程序 _选择框_四级_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
.如果结束


.子程序 _选择框_零级_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
.如果结束


.子程序 _查询_窗口_创建完毕, 空白型, , 
.局部变量 局部_项目编号, 文本型, , , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_项目是否存在, 逻辑型, , , 

赋值 (程序集_关闭记录项目数值, 读配置项 (#常量_配置项_配置文件, “查找窗口”, “记录项目数值”, ))
.如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from xm”))
    赋值 (程序集_项目记录集句柄, 未知支持库函数_4 (全局_MySql句柄))
    未知支持库函数_12 (程序集_项目记录集句柄)
    .计次循环首 (未知支持库函数_7 (程序集_项目记录集句柄), 局部_计次)
        
        未知支持库函数_6 (程序集_项目记录集句柄, #常量_项目_项目编号, 局部_项目编号)
        .如果真 (等于 (局部_项目编号, 程序集_关闭记录项目数值))
            赋值 (局部_项目是否存在, 真)
            
            跳出循环 ()
            
        .如果真结束
        未知支持库函数_10 (程序集_项目记录集句柄)
        
    .计次循环尾 ()
    未知支持库函数_5 (程序集_项目记录集句柄)
.如果真结束

查询窗口表头 ()
赋值 (程序集_日期开始, 子程序_日期转换 (.今天))
赋值 (程序集_日期结束, 子程序_日期转换 (.今天))

.判断开始 (等于 (程序集_关闭记录项目数值, “”))
    查询窗口读组合框 ()
.判断 (等于 (局部_项目是否存在, 真))
    查询_组合框_递归 (程序集_关闭记录项目数值)
.默认
    查询窗口读组合框 ()
    
.判断结束


 ' .如果 (等于 (程序集_关闭记录项目数值, “”))
     ' 添加窗口读组合框 ()
.否则
     ' 添加_组合框_递归 (程序集_关闭记录项目数值)
.如果结束


.子程序 _查询_窗口_将被销毁, 空白型, , 
写配置项 (#常量_配置项_配置文件, “查找窗口”, “记录项目数值”, 程序集_关闭记录项目数值)
赋值 (程序集_记数, 0)
未知支持库函数_5 (程序集_记录集句柄)


.子程序 _表格1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_按钮_修改_被单击 ()


.子程序 _按钮_修改_被单击, 空白型, , 

.如果真 (大于 (未知支持库函数_3 (), 0))
    赋值 (修改_窗口., “修改”)
    赋值 (全局_修改窗口收到表格, 查询_窗口.未知支持库函数_3 (.).未知支持库函数_10 (1))
    载入 (修改_窗口, , 真)
    
.如果真结束


.子程序 _按钮_删除_被单击, 空白型, , 
.如果真 (大于 (未知支持库函数_3 (), 0)) ' 费了很多事在这里  表格1.取光标行号 () ＞ 0
    .如果真 (等于 (信息框 (“确定删除吗？”, 1, “警告”), 1))
        返回 ()
    .如果真结束
    未知支持库函数_20 (全局_MySql句柄, #常量_资料表, 相加 (“”, #常量_资料_编号, “='”, 未知支持库函数_3 ().未知支持库函数_10 (1), “'”))
    _按钮_查找_被单击 ()
    
.如果真结束


.窗口程序集 窗口程序集2, , , 

.子程序 _统计_窗口_创建完毕, 空白型, , 


.窗口程序集 管理员窗口程序集, , , 

.程序集变量 程序集_管理员句柄, 整数型, , , 
.程序集变量 程序集_表格当前选中数据, 文本型, , , 
.子程序 _管理员_窗口_创建完毕, 空白型, , 
管理员表格头 ()
管理员表_显示数据 ()

.子程序 管理员表_显示数据, 空白型, , 
.局部变量 局部_姓名, 文本型, , , 
.局部变量 局部_密码, 文本型, , , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_行计次, 整数型, , , 
.局部变量 局部_编号, 文本型, , , 
.局部变量 局部_权限, 文本型, , , 

.如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from admin”))
    赋值 (程序集_管理员句柄, 未知支持库函数_4 (全局_MySql句柄))
    未知支持库函数_12 (程序集_管理员句柄)
.如果真结束

赋值 (局部_行计次, 1)
 ' 本源码来自易语言资源网(www.wodesoft.com)
.计次循环首 (未知支持库函数_7 (程序集_管理员句柄), 局部_计次)
    未知支持库函数_6 (程序集_管理员句柄, #常量_管理员_编号, 局部_编号)
    未知支持库函数_6 (程序集_管理员句柄, #常量_管理员_姓名, 局部_姓名)
    未知支持库函数_6 (程序集_管理员句柄, #常量_管理员_密码, 局部_密码)
    未知支持库函数_6 (程序集_管理员句柄, #常量_管理员_权限, 局部_权限)
    
    .未知支持库函数_38 ()
    局部_行计次.未知支持库函数_9 (1, #., 局部_编号)
    局部_行计次.未知支持库函数_9 (2, #., 局部_姓名)
    局部_行计次.未知支持库函数_9 (3, #., 局部_密码)
    局部_行计次.未知支持库函数_9 (4, #., 局部_权限)
    未知支持库函数_10 (程序集_管理员句柄)
    赋值 (局部_行计次, 相加 (局部_行计次, 1))
.计次循环尾 ()
未知支持库函数_5 (程序集_管理员句柄)

.子程序 管理员表格头, 空白型, , 
赋值 (., 1)
0.未知支持库函数_9 (1, #., “编号”)
0.未知支持库函数_9 (2, #., “管理员姓名”)
0.未知支持库函数_9 (3, #., “密码”)
0.未知支持库函数_9 (4, #., “权限”)
0.未知支持库函数_32 (0)
1.未知支持库函数_32 (80)
2.未知支持库函数_32 (80)
3.未知支持库函数_32 (60)
4.未知支持库函数_32 (60)
0.未知支持库函数_18 (0, 0, ., 12)


.子程序 _按钮_添加_被单击, 空白型, , 
.局部变量 局部_管理员赋值语句, 文本型, , , 
.局部变量 局部_管理员编号, 文本型, , , 
.局部变量 局部_权限, 文本型, , , 

.判断开始 (等于 (.内容, “”))
    信息框 (“性名不能为空”, #错误图标, )
    返回 ()
.判断 (等于 (.内容, “”))
    信息框 (“密码不能为空”, #错误图标, )
    返回 ()
.判断 (等于 (.选中, 真))
    赋值 (局部_权限, “假”)
.判断 (等于 (.选中, 真))
    赋值 (局部_权限, “真”)
.默认
    
.判断结束

.如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from admin”))
    赋值 (程序集_管理员句柄, 未知支持库函数_4 (全局_MySql句柄))
    未知支持库函数_13 (程序集_管理员句柄)
    未知支持库函数_6 (程序集_管理员句柄, #常量_管理员_编号, 局部_管理员编号)
    
.如果真结束
.如果 (等于 (局部_管理员编号, “”))
    赋值 (局部_管理员编号, “0001”)
.否则
    赋值 (局部_管理员编号, 相加 (取文本左边 (局部_管理员编号, 0), 取文本右边 (相加 (“0000”, 到文本 (相加 (到数值 (取文本右边 (局部_管理员编号, 4)), 1))), 4)))
.如果结束

赋值 (局部_管理员赋值语句, 相加 (“admin_data='”, 局部_管理员编号, “',admin_name='”, .内容, “',admin_Password='”, .内容, “',admin_popedom='”, 局部_权限, “'”))

.如果真 (等于 (未知支持库函数_18 (全局_MySql句柄, #常量_管理员表, 局部_管理员赋值语句), 真))
    信息框 (“添加成功”, 0, )
    管理员表格头 ()
    管理员表_显示数据 ()
    
.如果真结束


.子程序 _按钮_修改_被单击, 空白型, , 
.局部变量 局部_修改赋值语句, 文本型, , , 
.局部变量 局部_权限, 文本型, , , 



.如果 (大于 (未知支持库函数_3 (), 0))
    .判断开始 (等于 (.内容, “”))
        信息框 (“性名不能为空”, #错误图标, )
        返回 ()
    .判断 (等于 (.内容, “”))
        信息框 (“密码不能为空”, #错误图标, )
        返回 ()
    .判断 (等于 (.选中, 真))
        赋值 (局部_权限, “假”)
    .判断 (等于 (.选中, 真))
        赋值 (局部_权限, “真”)
    .默认
        
    .判断结束
    
    赋值 (局部_修改赋值语句, 相加 (“admin_name='”, .内容, “',admin_Password='”, .内容, “',admin_popedom='”, 局部_权限, “'”))
    .如果真 (不等于 (程序集_表格当前选中数据, “”))
        未知支持库函数_19 (全局_MySql句柄, #常量_管理员表, 局部_修改赋值语句, 相加 (“”, #常量_管理员_编号, “='”, 程序集_表格当前选中数据, “'”))
        信息框 (“成功！”, 0, )
        管理员表格头 ()
        管理员表_显示数据 ()
        
    .如果真结束
    
.否则
    信息框 (“请在左边框选中要修改的项目”, 0, )
.如果结束

' 本源码来自易语言资源网(www.wodesoft.com)


.子程序 _表格_管理员_被单击, 空白型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 

 ' .如果真 (大于 (未知支持库函数_3 (), 0))
    赋值 (程序集_表格当前选中数据, 未知支持库函数_3 ().未知支持库函数_10 (1))
    输出调试文本 (程序集_表格当前选中数据)
    
.如果真结束


.子程序 _按钮_删除_被单击, 空白型, , 
.如果真 (等于 (未知支持库函数_3 ().未知支持库函数_10 (2), “admin”))
    信息框 (“此用户不能删除!”, 0, )
    返回 ()
.如果真结束

.如果真 (等于 (信息框 (“确定删除吗？”, 1, “警告”), 1))
    返回 ()
.如果真结束
未知支持库函数_20 (全局_MySql句柄, #常量_管理员表, 相加 (“”, #常量_管理员_编号, “='”, 程序集_表格当前选中数据, “'”))
管理员表格头 ()
管理员表_显示数据 ()


.窗口程序集 登陆窗口程序集, , , 

.程序集变量 程序集_登陆句柄, 整数型, , , 
.子程序 _按钮2_被单击, 空白型, , 
结束 ()
' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _按钮_登陆_被单击, 空白型, , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_姓名, 文本型, , , 
.局部变量 局部_密码, 文本型, , , 
.局部变量 局部_权限, 文本型, , , 
.局部变量 局部_用户存在, 逻辑型, , , 
.局部变量 局部_密码存在, 逻辑型, , , 

.判断开始 (等于 (.内容, “”))
    信息框 (“用户名不能为空”, #错误图标, )
    返回 ()
.判断 (等于 (.内容, “”))
    信息框 (“密码不能为空”, #错误图标, )
    返回 ()
.默认
    
.判断结束
.如果真 (未知支持库函数_3 (全局_MySql句柄, “select * from admin”))
    赋值 (程序集_登陆句柄, 未知支持库函数_4 (全局_MySql句柄))
    未知支持库函数_12 (程序集_登陆句柄)
.如果真结束

.计次循环首 (未知支持库函数_7 (程序集_登陆句柄), 局部_计次)
    未知支持库函数_6 (程序集_登陆句柄, #常量_管理员_姓名, 局部_姓名)
    未知支持库函数_6 (程序集_登陆句柄, #常量_管理员_密码, 局部_密码)
    未知支持库函数_6 (程序集_登陆句柄, #常量_管理员_权限, 局部_权限)
    .如果真 (等于 (.内容, 局部_姓名))
        赋值 (局部_用户存在, 真)
    .如果真结束
    
    .如果真 (等于 (局部_用户存在, 真))
        .如果真 (等于 (.内容, 局部_密码))
            赋值 (局部_密码存在, 真)
            载入 (_启动窗口, _启动窗口, 假)
            登陆_窗口.销毁 ()
        .如果真结束
        
    .如果真结束
    
    未知支持库函数_10 (程序集_登陆句柄)
    
.计次循环尾 ()
.如果真 (等于 (局部_用户存在, 假))
    信息框 (“用户名不存在,请重新输入”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (局部_密码存在, 假))
    信息框 (“密码错误,请重新输入”, 0, )
    返回 ()
.如果真结束



.子程序 _登陆_窗口_创建完毕, 空白型, , 
赋值 (全局_MySql句柄, 未知支持库函数_1 (“”, “root”, “”, “”, 0))
.判断开始 (等于 (未知支持库函数_27 (全局_MySql句柄, #常量_数据库名), 真))
    赋值 (全局_MySql句柄, 未知支持库函数_1 (“”, “root”, , #常量_数据库名, 0))
.默认
    子程序_创建数据库 ()
.判断结束



.子程序 子程序_创建数据库, 空白型, , 
.局部变量 局部_资料表_赋值语句, 文本型, , , 
.局部变量 局部_项目表_赋值语句, 文本型, , , 
.局部变量 局部_管理员表_赋值语句, 文本型, , , 
.局部变量 局部_填加项目表_赋值语句, 文本型, , , 
.局部变量 局部_父项目编号, 文本型, , , 
.局部变量 局部_项目编号, 文本型, , , 
.局部变量 局部_项目名, 文本型, , , 
.局部变量 局部_管理员姓名, 文本型, , , 
.局部变量 局部_管理员密码, 文本型, , , 
.局部变量 局部_管理员_编号, 文本型, , , 
.局部变量 局部_管理员_权限, 文本型, , , 
.局部变量 局部_填加管理员_赋值语句, 文本型, , , 

赋值 (局部_资料表_赋值语句, 相加 (“Create Table zl (id bigint not null auto_increment,”, #常量_资料_编号, “ varchar (6) ,”, #常量_资料_片名, “ varchar (50) ,”, #常量_资料_分类, “ varchar (20) ,”, #常量_资料_主演, “ varchar (40) ,”, #常量_资料_导演, “ varchar (20) ,”, #常量_资料_集数, “ varchar (4) ,”, #常量_资料_影碟号, “ varchar (10) ,”, #常量_资料_金额, “ varchar (10) ,”, #常量_资料_日期, “ date ,”, #常量_资料_备注, “ text ,”, #常量_资料_图片, “ varchar (60) ,”, #常量_资料_数据编号, “ varchar (20), primary key(id))”))

赋值 (局部_项目表_赋值语句, 相加 (“Create Table xm (id bigint not null auto_increment,”, #常量_项目_项目名, “ varchar (20) ,”, #常量_项目_项目编号, “ varchar (20) ,”, #常量_项目_父项目编号, “ varchar (20), primary key(id))”))

赋值 (局部_管理员表_赋值语句, 相加 (“Create Table admin (id bigint not null auto_increment,”, #常量_管理员_编号, “ varchar (20),”, #常量_管理员_姓名, “ varchar (20) ,”, #常量_管理员_密码, “ varchar (20) ,”, #常量_管理员_权限, “ varchar (20), primary key(id))”))

.判断开始 (未知支持库函数_25 (全局_MySql句柄, #常量_数据库名)) ' 创建数据库
    未知支持库函数_2 (全局_MySql句柄)
    赋值 (全局_MySql句柄, 未知支持库函数_1 (“”, “root”, , #常量_数据库名, 0))
.默认
    信息框 (“数据库创建不成功”, #错误图标, )
.判断结束
.判断开始 (等于 (未知支持库函数_3 (全局_MySql句柄, 局部_资料表_赋值语句), 真)) ' 创建资料表
    
.默认
    信息框 (“资料表创建不成功”, #错误图标, )
.判断结束
.判断开始 (等于 (未知支持库函数_3 (全局_MySql句柄, 局部_项目表_赋值语句), 真)) ' 创建项目表
    赋值 (局部_父项目编号, “-1”)
    赋值 (局部_项目编号, “10”)
    赋值 (局部_项目名, “所有”)
    赋值 (局部_填加项目表_赋值语句, 相加 (“”, #常量_项目_项目名, “='”, 局部_项目名, “',”, #常量_项目_项目编号, “='”, 局部_项目编号, “',”, #常量_项目_父项目编号, “='”, 局部_父项目编号, “'”))
    .如果真 (等于 (未知支持库函数_18 (全局_MySql句柄, #常量_项目表, 局部_填加项目表_赋值语句), 假)) ' 项目表加入内容
        信息框 (“项目表加入内容不成功”, #错误图标, )
    .如果真结束
    
.默认
    信息框 (“项目表创建不成功”, #错误图标, )
.判断结束
.判断开始 (等于 (未知支持库函数_3 (全局_MySql句柄, 局部_管理员表_赋值语句), 真)) ' 创建管理员表
    赋值 (局部_管理员_编号, “0001”)
    赋值 (局部_管理员姓名, “admin”)
    赋值 (局部_管理员密码, “admin”)
    赋值 (局部_管理员_权限, “真”)
    赋值 (局部_填加管理员_赋值语句, 相加 (“”, #常量_管理员_编号, “='”, 局部_管理员_编号, “',”, #常量_管理员_姓名, “='”, 局部_管理员姓名, “',”, #常量_管理员_密码, “='”, 局部_管理员密码, “',”, #常量_管理员_权限, “='”, 局部_管理员_权限, “'”))
    .如果真 (等于 (未知支持库函数_18 (全局_MySql句柄, #常量_管理员表, 局部_填加管理员_赋值语句), 假)) ' 管理员表加入内容
        信息框 (“管理员表加入内容不成功”, #错误图标, )
    .如果真结束
    
.默认
    信息框 (“管理员表创建不成功”, #错误图标, )
.判断结束







 ' 不属于任何一个程序集、类模块的函数：
