 ' 文件类型：Windows窗口程序

 ' 程序名称：计算机使用时间限制软件
 ' 程序描述：作者:未来之风
 ' 程序作者：QQ:732402094
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.wodesoft.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.wodesoft.com  =============--
 ' 版本号：2.2
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 82
    高度 = 60
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\风_电脑使用时间限制ver2.2.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “计算机使用时间限制软件”
    帮助文件名 = “”

窗口 提示框
    左边 = 50
    顶边 = 50
    宽度 = 312
    高度 = 56
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “提示框”
    帮助文件名 = “”

窗口 锁定窗口 ' 在程序启动后自动调入本窗口
    左边 = 0
    顶边 = 0
    宽度 = 1440
    高度 = 900
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 0 '  0x0
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\风_电脑使用时间限制ver2.2.e\锁定窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 调试窗口
    左边 = 50
    顶边 = 50
    宽度 = 374
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “风_调试窗口”
    帮助文件名 = “”



.常量 密码, "“AGHC514Rxs”", , 必须是十位 不重复字符, 数字或大小写字母均可
.声音 声音1, " ' 已保存到：D:\易语言学习\Data\风_电脑使用时间限制ver2.2.e\声音1", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' shell 52F260023059454187AF826A3C07AF2A 3 0 操作系统界面功能支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 3 0 应用接口支持库
 ' spec A512548E76954B6E92C21055517615B0 3 0 特殊功能支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 2 0 多线程支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 2 0 扩展界面支持库二
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 2 0 数据操作支持库一
 ' shellEx DA19AC3ADD2F4121AAD84AC5FBCAFC71 3 0 扩展功能支持库一



 ' 所需要的模块
 ' 杀进程、进程保护、隐藏 C:\Documents and Settings\Administrator.CB1B81DBF96D406\桌面\强力杀进程、保护进程、隐藏进程.ec
 ' 未来之风专用模块 C:\Documents and Settings\Administrator.CB1B81DBF96D406\桌面\电脑每日使用时间限制\未来之风专用模块.ec


数据类型 按键信息, , 
    .成员 虚拟码, 整数型, , , 
    .成员 扫描码, 整数型, , , 
    .成员 标记, 整数型, , , 
    .成员 时间, 整数型, , , 
    .成员 额外信息, 整数型, , , 

.全局变量 全_提示文本, 文本型, , , 
.全局变量 全_提示等级, 整数型, , , 
.全局变量 全_默认窗口, 子程序指针, , , 
.全局变量 全_锁定模式, 整数型, , , 
.全局变量 全_调试模式, 整数型, , , 

.DLL命令 SetCapture, 整数型, "", "SetCapture", , 
    .参数 Hwnd, 整数型, , 

.DLL命令 CallWindowProcA, 整数型, "", "CallWindowProcA", , 
    .参数 程序指针, 子程序指针, , 
    .参数 窗口句柄, 整数型, , 
    .参数 消息, 整数型, , 
    .参数 参数1, 整数型, , 
    .参数 参数2, 整数型, , 

.DLL命令 SetWindowLongA, 子程序指针, "", "SetWindowLongA", , 
    .参数 窗口句柄, 整数型, , 
    .参数 要置的特征, 整数型, , 
    .参数 新特征, 子程序指针, , 仅易语言3.0支持

.DLL命令 新父窗口, 整数型, "user32", "SetParent", , 指定一个窗口的新父（在vb里使用：利用这个函数，vb可以多种形式支持子窗口。例如，可将控件从一个容器移至窗体中的另一个。用这个函数在窗体间移动控件是相当冒险的，但却不失为一个有效的办法。如真的这样做，请在关闭任何一个窗体之前，注意用SetParent将控件的父设回原来的那个）  前一个父窗口的句柄
    .参数 hWndChild, 整数型, , 子窗口的句柄
    .参数 hWndNewParent, 整数型, , hWndChild的新父;

.DLL命令 寻找顶级窗口, 整数型, "user32", "FindWindowA", , 寻找窗口列表中第一个符合指定条件的顶级窗口（在vb里使用：FindWindow最常见的一个用途是获得ThunderRTMain类的隐藏窗口的句柄；该类是所有运行中vb执行程序的一部分。获得句柄后，可用api函数GetWindowText取得这个窗口的名称；该名也是应用程序的标题）  找到窗口的句柄。如未找到相符窗口，则返回零。会设置GetLastError
    .参数 窗口类名, 文本型, , 指向包含了窗口类名的空中止（C语言）字串的指针；或设为零，表示接收任何类
    .参数 窗口文本, 文本型, , 指向包含了窗口文本（或标签）的空中止（C语言）字串的指针；或设为零，表示接收任何窗口标题  示例Dim hw&

.DLL命令 安装钩子, 整数型, "", "SetWindowsHookExA", , 
    .参数 钩子类型, 整数型, , 
    .参数 回调函数地址, 子程序指针, , 
    .参数 实例句柄, 整数型, , 
    .参数 线程ID, 整数型, , 

.DLL命令 取模块句柄, 整数型, "", "GetModuleHandleA", , 
    .参数 模块名, 整数型, , 

.DLL命令 卸载钩子, 整数型, "", "UnhookWindowsHookEx", , 
    .参数 钩子句柄, 整数型, , 

.DLL命令 下一个钩子, 整数型, "user32.dll", "CallNextHookEx", , CallNextHookEx
    .参数 钩子句柄, 整数型, , hHook
    .参数 代码值, 整数型, , ncode
    .参数 附加参数1, 整数型, , wParam
    .参数 附加参数2, 整数型, 传址, lParam

.DLL命令 设置系统钩子_, 整数型, "user32.dll", "SetWindowsHookExA", , SetWindowsHookEx
    .参数 钩子类型, 整数型, , idHook
    .参数 回调函数地址, 整数型, , lpfn
    .参数 实例句柄, 整数型, , hmod
    .参数 线程ID, 整数型, , dwThreadId

.DLL命令 CopyMemory, 空白型, "", "RtlMoveMemory", , 
    .参数 Destination, 按键信息, , 
    .参数 Source, 整数型, , 
    .参数 cbCopy, 整数型, , 

.DLL命令 恢复窗口_, 整数型, "user32.dll", "OpenIcon", , ,
    .参数 窗口句柄, 整数型, , hwnd，窗口句柄

.DLL命令 ReleaseCapture, 整数型, "", "ReleaseCapture", , 

.窗口程序集 启动窗口_程序集, , , 

.程序集变量 TimeLeft, 整数型, , , 
.程序集变量 NewTime, 整数型, , , 
.程序集变量 DateNow, 整数型, , , 
.程序集变量 hDevice, 整数型, , , 
.程序集变量 CumulativeTime, 整数型, , , 
.程序集变量 InterceptMessage, 整数型, , , 
.程序集变量 Part_a, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 pid, 整数型, , , 
.局部变量 窗口句柄, 整数型, , , 


 ' --========  易语言资源网  (www.wodesoft.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.wodesoft.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.wodesoft.com  ================--

 ' /////////////////备注//////////////////////////////
 ' C:\Documents and Settings\Administrator\Application Data\   特定目录8
 ' /////////程序制作：未来之风   By:604543652/////////
 ' 风_启动调试模式 ()  ' 由于隐藏进程需要编译后才能使用！所以调试输出需要另外一个窗口输出！
未知支持库函数_10 (_启动窗口.取窗口句柄 (), 取窗口句柄 (), 0, #F2键) ' 注册快捷键 用于显示剩余时间
.判断开始 (文件是否存在 (相加 (未知支持库函数_7 (8), “First.dat”))) ' 用于判断程序是否第一次执行
    写注册项 (#本地机器, “SOFTWARE\Microsoft\Windows\CurrentVersion\Run\ADSwiazrd”, 相加 (取运行目录 (), “\”, 取执行文件名 ())) ' 写注册表启动项
.默认
    写到文件 (相加 (未知支持库函数_7 (8), “ErrMsg.dat”), 未知支持库函数_3 (到字节集 (删全部空 (“1”)), “DFG3SA64llks”, #)) ' 判断文件
.判断结束
赋值 (全_默认窗口, SetWindowLongA (取窗口句柄 (), -4, &处理)) ' 拦截关机
强力进程隐藏_初始化 () ' 隐藏进程
强力进程隐藏_隐藏 () ' 隐藏进程
强力进程防杀_初始化 () ' 防止被强制删除或者强制关闭
强力进程防杀_保护 () ' 防止被强制删除或者强制关闭
.判断开始 (等于 (风_程序是否已运行 (“计算机使用时间限制软件”), 真)) ' 防止重复运行
    信息框 (“程序已经运行！”, 48, “提示”)
    结束 ()
.默认
     ' 本源码来自易语言资源网(www.wodesoft.com)
.判断结束
未知支持库函数_0 (&初始化, , )

.子程序 初始化, 空白型, , 
.判断开始 (等于 (文件是否存在 (相加 (未知支持库函数_7 (1), “Sever.ini”)), 假)) ' 第一次使用
    写配置项 (相加 (未知支持库函数_7 (1), “Sever.ini”), “Date”, “TimeLeft”, 风_加密 (到文本 (Time_Today ()), #密码)) ' 写出剩余时间
    写配置项 (相加 (未知支持库函数_7 (1), “Sever.ini”), “Date”, “DateNow”, 风_加密 (到文本 (风_网络取今天星期几 ()), #密码)) ' 写出今天使用日期(星期几)
    未知支持库函数_0 (&Time_Start, , ) ' 开始倒计时
.默认
    赋值 (DateNow, 到整数 (风_解密 (读配置项 (相加 (未知支持库函数_7 (1), “Sever.ini”), “Date”, “DateNow”, ), #密码))) ' 读取上次使用日期(星期几)
    .判断开始 (不等于 (DateNow, 风_网络取今天星期几 ())) ' 判断当前使用日期与上次使用日期是否一致。
        写配置项 (相加 (未知支持库函数_7 (1), “Sever.ini”), “Date”, “TimeLeft”, 风_加密 (到文本 (Time_Today ()), #密码)) ' 写出今天的剩余时间
        写配置项 (相加 (未知支持库函数_7 (1), “Sever.ini”), “Date”, “DateNow”, 风_加密 (到文本 (风_网络取今天星期几 ()), #密码)) ' 写出今天使用日期(星期几)
        未知支持库函数_0 (&Time_Start, , ) ' 开始倒计时
    .默认
        赋值 (TimeLeft, 到整数 (风_解密 (读配置项 (相加 (未知支持库函数_7 (1), “Sever.ini”), “Date”, “TimeLeft”, ), #密码))) ' 读取上次剩余时间
        .判断开始 (小于或等于 (TimeLeft, 0)) ' 判断剩余使用时间是否为0
            未知支持库函数_8 (#, 真) ' 关闭系统
        .默认
            未知支持库函数_0 (&Time_Start, , ) ' 继续扣除时间
        .判断结束
         ' 本源码来自易语言资源网(www.wodesoft.com)
    .判断结束
    
.判断结束


.子程序 处理, 整数型, , 不要修改该子程序的返回值及参数的类型！
.参数 句柄, 整数型, , 
.参数 消息, 整数型, , 
.参数 参数1, 整数型, , 
.参数 参数2, 整数型, , 

.如果真 (等于 (消息, 17))
    .如果真 (等于 (参数2, -2147483648))
        赋值 (InterceptMessage, 1)
        返回 (CallWindowProcA (全_默认窗口, 句柄, 0, 参数1, 参数2))
    .如果真结束
    赋值 (InterceptMessage, 2)
    返回 (CallWindowProcA (全_默认窗口, 句柄, 0, 参数1, 参数2))
.如果真结束
返回 (CallWindowProcA (全_默认窗口, 句柄, 消息, 参数1, 参数2))

.子程序 _时钟_拦截到的消息_周期事件, 空白型, , 
.判断开始 (等于 (InterceptMessage, 1)) ' 拦截到注销
    赋值 (全_锁定模式, 2) ' 锁定模式为普通
    载入 (锁定窗口, , 假)
    赋值 (InterceptMessage, 0) ' 清除拦截消息
    赋值 (.时钟周期, 0) ' 停止拦截检测
.判断 (等于 (InterceptMessage, 2)) ' 拦截到关机或重启
    未知支持库函数_8 (#, 真)
.默认
    
.判断结束


.子程序 Time_Today, 整数型, , 
.局部变量 毫秒, 整数型, , , 
.局部变量 当前日期, 整数型, , , 

赋值 (当前日期, 风_网络取今天星期几 ())
赋值 (毫秒, 相乘 (1000, 3600)) ' 1小时所需时间
.判断开始 (等于 (当前日期, 1)) ' 星期一  3小时
    赋值 (毫秒, 相乘 (毫秒, 3))
.判断 (等于 (当前日期, 2)) ' 星期二  3小时
    赋值 (毫秒, 相乘 (毫秒, 3))
.判断 (等于 (当前日期, 3)) ' 星期三  3小时
    赋值 (毫秒, 相乘 (毫秒, 3))
.判断 (等于 (当前日期, 4)) ' 星期四  3小时
    赋值 (毫秒, 相乘 (毫秒, 3))
.判断 (等于 (当前日期, 5)) ' 星期五  5小时
    赋值 (毫秒, 相乘 (毫秒, 5))
.判断 (等于 (当前日期, 6)) ' 星期六  10小时
    赋值 (毫秒, 相乘 (毫秒, 10))
.判断 (等于 (当前日期, 7)) ' 星期天  8小时
    赋值 (毫秒, 相乘 (毫秒, 8))
.默认
    
.判断结束
风_输出调试文本 (毫秒)
返回 (毫秒)

.子程序 Time_Start, 空白型, , 
赋值 (DateNow, 到整数 (风_解密 (读配置项 (相加 (未知支持库函数_7 (1), “Sever.ini”), “Date”, “DateNow”, ), #密码))) ' 重新加载一下当前日期变量
赋值 (TimeLeft, 到整数 (风_解密 (读配置项 (相加 (未知支持库函数_7 (1), “Sever.ini”), “Date”, “TimeLeft”, ), #密码))) ' 重新加载一下剩余时间变量
赋值 (.时钟周期, 1000)

.子程序 _时钟1_周期事件, 空白型, , 
.局部变量 文本, 文本型, , , 

赋值 (TimeLeft, 到整数 (风_解密 (读配置项 (相加 (未知支持库函数_7 (1), “Sever.ini”), “Date”, “TimeLeft”, ), #密码))) ' 每次扣除 重新读取数据
.判断开始 (大于 (TimeLeft, 0)) ' 判断剩余时间是否大于0
    赋值 (TimeLeft, 相减 (TimeLeft, 1000)) ' 减去1秒 减去1000变量值
    赋值 (CumulativeTime, 相加 (CumulativeTime, 1)) ' 累计时间 增加1秒变量值
    写配置项 (相加 (未知支持库函数_7 (1), “Sever.ini”), “Date”, “TimeLeft”, 风_加密 (到文本 (TimeLeft), #密码)) ' 每次扣除 重新写入数据
    .判断开始 (等于 (CumulativeTime, 3600)) ' 累计使用1小时
        赋值 (全_提示文本, “您已连续上网1小时！请注意休息！”)
        赋值 (全_提示等级, 0)
        载入 (提示框, , 假)
    .判断 (等于 (CumulativeTime, 7200)) ' 累计使用2小时
        赋值 (全_提示文本, “您已连续上网2小时！请注意休息！”)
        赋值 (全_提示等级, 1)
        载入 (提示框, , 假)
    .判断 (等于 (CumulativeTime, 10800)) ' 累计使用3小时
        赋值 (全_提示文本, 相加 (“您已连续上网3小时！请注意休息！”, #换行符, “系统将在3分钟后执行锁定！请注意休息！”))
        赋值 (全_提示等级, 2)
        载入 (提示框, , 假)
    .判断 (大于或等于 (CumulativeTime, 11160)) ' 累计使用3小时
        赋值 (全_提示等级, 0) ' 清除提示等级
        赋值 (CumulativeTime, 0) ' 清除累计时间
        赋值 (.时钟周期, 0) ' 停止扣除时间
        赋值 (全_锁定模式, 1) ' 1为强制锁定模式
        载入 (锁定窗口, , 假)
    .默认
         ' 本源码来自易语言资源网(www.wodesoft.com)
    .判断结束
    
    .判断开始 (等于 (TimeLeft, 7200000)) ' 2h
        赋值 (全_提示文本, “您今天还剩下2小时上网时间！”)
        赋值 (全_提示等级, 0)
        载入 (提示框, , 假)
    .判断 (等于 (TimeLeft, 3600000)) ' 1h
        赋值 (全_提示文本, “您今天还剩下1小时上网时间”)
        赋值 (全_提示等级, 0)
        载入 (提示框, , 假)
    .判断 (等于 (TimeLeft, 3000000)) ' 50
        赋值 (全_提示文本, “您今天还剩下50分钟上网时间！”)
        赋值 (全_提示等级, 0)
        载入 (提示框, , 假)
    .判断 (等于 (TimeLeft, 2400000)) ' 40
        赋值 (全_提示文本, “您今天还剩下40分钟上网时间！”)
        赋值 (全_提示等级, 0)
        载入 (提示框, , 假)
    .判断 (等于 (TimeLeft, 1800000)) ' 30
        赋值 (全_提示文本, “您今天还剩下30分钟上网时间！”)
        赋值 (全_提示等级, 1)
        载入 (提示框, , 假)
    .判断 (等于 (TimeLeft, 1200000)) ' 20
        赋值 (全_提示文本, “您今天还剩下20分钟上网时间！”)
        赋值 (全_提示等级, 1)
        载入 (提示框, , 假)
    .判断 (等于 (TimeLeft, 600000)) ' 10
        赋值 (全_提示文本, “您今天还剩下10分钟上网时间！”)
        赋值 (全_提示等级, 1)
        载入 (提示框, , 假)
    .判断 (等于 (TimeLeft, 300000)) ' 5
        赋值 (全_提示文本, 相加 (“您今天还剩下5分钟上网时间！”, #换行符, “请保存您当前的作业！以免丢失！”))
        赋值 (全_提示等级, 2)
        载入 (提示框, , 假)
    .判断 (等于 (TimeLeft, 60000)) ' 1
        赋值 (全_提示文本, 相加 (“您今天还剩下1分钟上网时间！”, #换行符, “请立即保存您当前的作业！”))
        赋值 (全_提示等级, 2)
        载入 (提示框, , 假)
    .默认
        
    .判断结束
    风_输出调试文本 (TimeLeft)
.默认
    赋值 (.时钟周期, 0)
    未知支持库函数_8 (#, 真)
.判断结束


.子程序 __启动窗口_可否被关闭, 逻辑型, , 
风_关闭事件同步对象 ()

.子程序 _标签1_反馈事件, 整数型, , 用于显示当前剩余时间
.参数 参数一, 整数型, , 
.参数 参数二, 整数型, , 

.判断开始 (不等于 (TimeLeft, 0)) ' 判断是否读取成功
    .判断开始 (等于 (Part_a, 0))
        赋值 (全_提示文本, 相加 (“您今天还剩下”, 风_毫秒转小时 (TimeLeft)))
        赋值 (全_提示等级, 1)
        载入 (提示框, , 假)
    .判断 (等于 (Part_a, 1))
        信息框 (“发生未知错误！”, 48, “提示”)
    .默认
        
    .判断结束
    
.默认
    信息框 (“发生未知错误！”, 48, “提示”)
.判断结束


.子程序 _按钮1_被单击, 空白型, , 用于调试提示框时候使用
风_调试提示框 ()

.子程序 _按钮2_被单击, 空白型, , 用于调试锁定模式时候使用
风_调试系统锁定 ()

.子程序 _按钮3_被单击, 空白型, , 用于调试锁定模式时候使用
风_调试模式关闭 ()

.窗口程序集 提示窗口_程序集, , , 

.程序集变量 局_透明度, 整数型, , , 
.程序集变量 局_提示文本, 文本型, , "0", 
.子程序 _提示框_创建完毕, 空白型, , 
播放MID (1, , #声音1)
赋值 (局_提示文本, 分割文本 (全_提示文本, #换行符, ))
赋值 (.标题, 局_提示文本 [1])
.判断开始 (等于 (全_提示等级, 0)) ' 1小时蓝灰
    赋值 (.文本颜色, #蓝灰)
.判断 (等于 (全_提示等级, 1)) ' 2小时蓝色
    赋值 (.文本颜色, #橙黄)
.判断 (等于 (全_提示等级, 2)) ' 3小时红色
    赋值 (.文本颜色, #红色)
.默认
     ' 本源码来自易语言资源网(www.wodesoft.com)
.判断结束
 ' ----------显示区域开始----------
赋值 (提示框., 相减 (取屏幕宽度 (), 提示框.))
赋值 (提示框., 0)
 ' ----------渐变开始----------
未知支持库函数_66 (取窗口句柄 (), 1)
赋值 (局_透明度, 1)
赋值 (.时钟周期, 40)

.子程序 _时钟1_周期事件, 空白型, , 
.判断开始 (大于或等于 (局_透明度, 255))
    赋值 (.时钟周期, 0) ' 停止渐变1
    延迟 (5000)
    赋值 (.时钟周期, 40) ' 启动渐变2
.默认
    赋值 (局_透明度, 相加 (局_透明度, 5))
    未知支持库函数_66 (取窗口句柄 (), 局_透明度)
.判断结束


.子程序 _时钟2_周期事件, 空白型, , 
.判断开始 (小于或等于 (局_透明度, 0))
    销毁 ()
.默认
    赋值 (局_透明度, 相减 (局_透明度, 5))
    未知支持库函数_66 (取窗口句柄 (), 局_透明度)
.判断结束
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _时钟3_周期事件, 空白型, , 
.局部变量 a1, 整数型, 静态, , 

.如果真 (或者 (等于 (a1, 0), 大于 (a1, 取数组成员数 (局_提示文本))))
    赋值 (a1, 1)
.如果真结束
赋值 (.标题, 局_提示文本 [a1])
赋值 (a1, 相加 (a1, 1))


.子程序 _鼠标移入区域_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 是否移入, 逻辑型, 静态, , 

.如果 (并且 (小于或等于 (0, 横向位置), 小于或等于 (横向位置, .宽度), 小于或等于 (0, 纵向位置), 小于或等于 (纵向位置, .高度)))
    .如果真 (等于 (是否移入, 假)) ' 鼠标移入事件
        SetCapture (取窗口句柄 ())
        赋值 (.时钟周期, 0) ' 停止渐变1
        赋值 (.时钟周期, 0) ' 停止渐变2
        赋值 (局_透明度, 255)
        未知支持库函数_66 (取窗口句柄 (), 255)
        赋值 (是否移入, 真)
    .如果真结束
     ' 本源码来自易语言资源网(www.wodesoft.com)
.否则
    .如果真 (等于 (是否移入, 真)) ' 鼠标移出事件
        ReleaseCapture ()
        赋值 (.时钟周期, 40) ' 启动渐变2
        赋值 (局_透明度, 255)
        未知支持库函数_66 (取窗口句柄 (), 255)
        赋值 (是否移入, 假)
    .如果真结束
    
.如果结束


.窗口程序集 锁定窗口_程序集, , , 

.程序集变量 局_钩子句柄, 整数型, , , 
.程序集变量 局_临时密码, 文本型, , , 
.程序集变量 局_锁定时间, 整数型, , , 
.子程序 _锁定窗口_创建完毕, 空白型, , 
赋值 (., 取屏幕高度 ())
赋值 (., 取屏幕宽度 ())
赋值 (., 0)
赋值 (., 0)
赋值 (局_锁定时间, 相乘 (1000, 60, 5)) ' 锁定时间为5分钟 最后一项为要锁定的时间(分钟)
赋值 (局_钩子句柄, 安装钩子 (13, &钩子函数, 取模块句柄 (0), 0)) ' 安装键盘钩子
风_结束进程 (“explorer.exe”) ' 结束桌面进程
风_结束进程 (“taskmgr.exe”) ' 结束任务管理进程
风_屏蔽任务管理器 () ' 屏蔽任务管理器
风_屏蔽任务管理器9X ()
.判断开始 (等于 (全_锁定模式, 1)) ' 强制锁定
    赋值 (.时钟周期, 1000) ' 解除锁定倒计时
    赋值 (.可视, 真)
.判断 (等于 (全_锁定模式, 2)) ' 注销锁定
    赋值 (.可视, 真)
    赋值 (., 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    输入框 (“请输入注销解锁密码！”, “提示”, , 局_临时密码, #通常型)
    赋值 (_启动窗口..时钟周期, 0) ' 停止扣除使用时间
.默认
    信息框 (“发生未知错误！”, 48, “提示”)
.判断结束
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 钩子函数, 整数型, , 
.参数 icode, 整数型, , 
.参数 wparam, 整数型, , 
.参数 lparam, 整数型, , 

.局部变量 按键信息, 按键信息, , , 

CopyMemory (按键信息, lparam, 28)
.如果真 (等于 (icode, 0))
    .如果真 (或者 (等于 (按键信息.虚拟码, #Alt键), 等于 (按键信息.虚拟码, #Tab键), 等于 (按键信息.虚拟码, #F4键)))
        返回 (1)
    .如果真结束
    .如果真 (或者 (等于 (按键信息.虚拟码, #Esc键), 等于 (按键信息.虚拟码, #Ctrl键), 等于 (按键信息.虚拟码, 91), 等于 (按键信息.虚拟码, 92)))
        返回 (1)
    .如果真结束
    .如果真 (等于 (按键信息.虚拟码, #Esc键))
        返回 (1)
    .如果真结束
    .如果真 (等于 (按键信息.虚拟码, #Ctrl键))
        返回 (1)
    .如果真结束
    .如果真 (等于 (按键信息.虚拟码, #F3键))
        返回 (1)
    .如果真结束
    .如果真 (等于 (按键信息.虚拟码, #F5键))
        返回 (1)
    .如果真结束
    .如果真 (等于 (按键信息.虚拟码, #F8键))
        返回 (1)
    .如果真结束
    .如果真 (等于 (按键信息.虚拟码, #Tab键))
        返回 (1)
    .如果真结束
    .如果真 (等于 (按键信息.虚拟码, 91))
        返回 (1)
    .如果真结束
    .如果真 (等于 (按键信息.虚拟码, 92))
        返回 (1)
    .如果真结束
    .如果真 (等于 (按键信息.虚拟码, #F4键))
        返回 (1)
    .如果真结束
    .如果真 (等于 (按键信息.虚拟码, #Alt键))
        返回 (1)
    .如果真结束
    .如果真 (等于 (按键信息.虚拟码, #Del键))
        返回 (1)
    .如果真结束
    返回 (0)
.如果真结束
返回 (下一个钩子 (局_钩子句柄, icode, wparam, lparam))

.子程序 _解除锁定_周期事件, 空白型, , 自动解除
.判断开始 (小于或等于 (局_锁定时间, 0))
    赋值 (.时钟周期, 0) ' 停止锁定倒计时时钟
    赋值 (.内容, “正在解除锁定....”)
    运行 (“explorer”, 假, ) ' 运行桌面
    卸载钩子 (局_钩子句柄) ' 卸载键盘钩子
    风_恢复任务管理器 () ' 恢复任务管理器
    风_恢复任务管理器9X ()
    赋值 (_启动窗口..时钟周期, 1000) ' 启动继续扣除时间时钟
    赋值 (_启动窗口..时钟周期, 1000) ' 启动消息拦截时钟
    赋值 (全_锁定模式, 0) ' 清除全局锁定模式变量
    销毁 ()
.默认
    赋值 (局_锁定时间, 相减 (局_锁定时间, 1000))
    赋值 (.内容, 相加 (“距解除锁定还剩  ”, 风_毫秒转小时 (局_锁定时间)))
.判断结束
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _解除锁定_按钮_被单击, 空白型, , 手动解除
.判断开始 (等于 (.内容, 局_临时密码))
    赋值 (.内容, “正在解除锁定....”)
    运行 (“explorer”, 假, ) ' 运行桌面
    卸载钩子 (局_钩子句柄) ' 卸载键盘钩子
    风_恢复任务管理器 () ' 恢复任务管理器
    风_恢复任务管理器9X ()
    赋值 (_启动窗口..时钟周期, 1000) ' 启动继续扣除时间时钟
    赋值 (_启动窗口..时钟周期, 1000) ' 启动消息拦截时钟
    赋值 (全_锁定模式, 0) ' 清除全局锁定模式变量
    销毁 ()
.默认
    信息框 (“密码错误！”, 48, “提示”)
.判断结束


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 强力进程防杀_初始化, 空白型, , 建议在启动程序时候调用！


.子程序 强力进程防杀_保护, 空白型, , 加载进程保护，请在初始化后调用本子程序！


.子程序 强力进程防杀_卸载, 空白型, , 注意：请先停止保护后再卸载，否则可能会蓝屏！


.子程序 强力进程防杀_停止保护, 空白型, , 取消进程保护！


.子程序 强力杀进程_初始化, 空白型, , 初始化杀进程的驱动！建议放在程序启动时！


.子程序 强力杀进程_结束进程, 空白型, , 强制结束进程！
.参数 进程PID, 整数型, , 



.子程序 强力杀进程_卸载, 空白型, , 卸载杀进程的驱动！


.子程序 提升进程权限, 空白型, , 提升进程权限！


.子程序 普通进程防杀_开启, 空白型, , 开启非驱动的进程防杀！


.子程序 普通进程防杀_关闭, 空白型, , 取消非驱动的进程防杀！建议在退出程序时候调用！


.子程序 加载随机易皮肤, 空白型, , 加载随机的skinsharp皮肤！


.子程序 强力进程隐藏_初始化, 空白型, , 初始化驱动，建议在程序启动时候调用！


.子程序 强力进程隐藏_隐藏, 空白型, , 开启隐藏进程！


.子程序 强力进程隐藏_停止, 空白型, , 取消进程隐藏！


.子程序 强力进程隐藏_卸载, 空白型, , 建议在程序退出时候调用本功能！


.子程序 加载易皮肤, 空白型, , 
.参数 皮肤编号, 整数型, 可空, 编号为1 - 34，默认为1
.参数 皮肤密码, 文本型, 可空, 皮肤密码
.参数 _色调, 整数型, 可空, 取值范围-180 - 180
.参数 _保和度, 整数型, 可空, 取值范围-100 - 100
.参数 _亮度, 整数型, 可空, 取值范围-100 - 100



.子程序 _卸载皮肤, 空白型, , 


.程序集 调试_程序集, , , 

.程序集变量 临时变量, 整数型, , , 
.子程序 风_输出调试文本, 空白型, , 
.参数 输出文本, 空白型, , 

.判断开始 (等于 (全_调试模式, 1))
    调试窗口.加入文本 (., 相加 (到文本 (输出文本), #换行符))
.默认
    
.判断结束


.子程序 风_启动调试模式, 空白型, , 
载入 (调试窗口, , 假)
赋值 (全_调试模式, 1)
强力进程隐藏_停止 ()
强力进程防杀_停止保护 ()
强力进程防杀_卸载 ()
赋值 (_启动窗口., 真)

.子程序 风_调试提示框, 空白型, , 
.判断开始 (等于 (临时变量, 0)) ' 累计使用1小时
    赋值 (全_提示文本, “您已连续上网1小时！请注意休息！”)
    赋值 (全_提示等级, 0)
    赋值 (临时变量, 相加 (临时变量, 1))
    载入 (提示框, , 假)
.判断 (等于 (临时变量, 1)) ' 累计使用2小时
    赋值 (全_提示文本, “您已连续上网2小时！请注意休息！”)
    赋值 (全_提示等级, 1)
    赋值 (临时变量, 相加 (临时变量, 1))
    载入 (提示框, , 假)
.判断 (等于 (临时变量, 2)) ' 累计使用3小时
    赋值 (全_提示文本, 相加 (“您已连续上网3小时！请注意休息！”, #换行符, “防沉迷提醒您三分钟后将锁定电脑！”))
    赋值 (全_提示等级, 2)
    赋值 (临时变量, 相加 (临时变量, 1))
    载入 (提示框, , 假)
.默认
    
.判断结束


.子程序 风_调试系统锁定, 空白型, , 
赋值 (全_锁定模式, 1) ' 1为强制锁定模式 2为普通锁定模式
载入 (锁定窗口, , 假)

.子程序 风_调试模式关闭, 空白型, , 
风_关闭事件同步对象 ()
结束 ()


.窗口程序集 调试窗口_程序集, , , 

.子程序 _调试窗口_将被销毁, 空白型, , 
结束 ()

.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 风_毫秒转小时, 文本型, , 
.参数 输入毫秒, 整数型, , 



.子程序 风_小时转毫秒, 文本型, , 
.参数 输入_小时, 整数型, , 
.参数 输入_分钟, 整数型, , 
.参数 输入_秒, 整数型, , 



.子程序 风_取网络时间, 日期时间型, , 


.子程序 风_网络取今天星期几, 整数型, , 


.子程序 风_特殊方式运行Explorer, 空白型, , 


.子程序 风_屏蔽任务管理器, 空白型, , 即:禁止CTRL+ALT+DEL启动任务管理器,不用重启,仅对WINNT系统有效.


.子程序 风_恢复任务管理器, 空白型, , 即:恢复被禁止的CTRL+ALT+DEL启动任务管理器


.子程序 风_屏蔽任务管理器9X, 空白型, , 即:禁止CTRL+ALT+DEL启动任务管理器,不用重启,仅对WIN9X系统有效.


.子程序 风_恢复任务管理器9X, 空白型, , 即:禁止CTRL+ALT+DEL启动任务管理器,不用重启,仅对WIN9X系统有效.


.子程序 风_结束进程, 空白型, , 结束一个进程,可以结束绝大部分进程,不受系统权限限制(无返回值)
.参数 进程名, 文本型, , 窗口程序的进程名



.子程序 风_取进程ID, 整数型, , 取指定进程的进程ID(返回第一个进程ID,失败返回空信息)
.参数 进程名, 文本型, , 程序进程名(注意进程名的大小写!)



.子程序 风_动态解密, 字节集, , 
.参数 _待解密字节集, 字节集, , 
.参数 _待算密钥_key, 文本型, 可空, 为空则使用“abcdefghijklmnopqrhtuvwxyz1234567890~!@#$%^&*()_+-=”



.子程序 风_动态加密, 字节集, , 
.参数 _待加密字节集, 字节集, , 
.参数 _待算密钥_key, 文本型, 可空, 为空则使用“abcdefghijklmnopqrhtuvwxyz1234567890~!@#$%^&*()_+-=”



.子程序 风_程序是否已运行, 逻辑型, , 真表示已经运行，假表示还未运行
.参数 标志文本, 文本型, , 可以是任何文本，但是最好要长一点以保证和系统中已有其他事件对象的名称不相冲突。



.子程序 风_关闭事件同步对象, 空白型, , 窗口销毁时调用


.子程序 风_加密, 文本型, , 
.参数 文本, 文本型, , 
.参数 译码表, 文本型, , 必须是十位 不重复字符, 数字或大小写字母均可



.子程序 风_解密, 文本型, , 
.参数 文本, 文本型, , 
.参数 译码表, 文本型, , 




 ' 不属于任何一个程序集、类模块的函数：
