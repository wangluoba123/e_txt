 ' 文件类型：未知类型

 ' 程序名称：进度复制文件模块
 ' 程序描述：[神2也教你学E] - 进度复制文件模块
 ' 程序作者：BoyChong - 神2
 ' 邮政编码：
 ' 联系地址：QQ:277139189
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：boychong2@eyou.com
 ' 主页地址：www.zzhx.bak.cn
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 7 系统核心支持库





.程序集 程序集1, , , 

.程序集变量 百分比, 整数型, , , 
.程序集变量 当前命令, 整数型, , , 
.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码
_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。

.子程序 自定义进度复制文件, 逻辑型, 公开, 复制成功返回“真”，否则返回“假”
.参数 目的目录, 文本型, , 同 进度复制文件() 命令用法
.参数 原文件, 文本型, , 同 进度复制文件() 命令用法
.参数 分割块大小, 整数型, 可空, 可空默认为1000
.参数 复制速度, 整数型, 可空, 从1~100，由慢到快，可空，默认为100，即全速

.局部变量 a, 整数型, , "2", 
.局部变量 b, 字节集, , , 
.局部变量 文件名, 文本型, , , 
.局部变量 c, 整数型, 静态, "2", 

赋值 (目的目录, 全文本替换 (目的目录, “/”, “\”))
赋值 (原文件, 全文本替换 (原文件, “/”, “\”))
赋值 (文件名, 取文本右边 (原文件, 相减 (取文本长度 (原文件), 倒找文本 (原文件, “\”, , 假))))
.如果真 (不等于 (取文本右边 (目的目录, 1), “\”))
    赋值 (目的目录, 相加 (目的目录, “\”))
.如果真结束
赋值 (a [1], 打开文件 (原文件, #读入, #无限制))
赋值 (c [1], 取文件长度 (a [1]))
赋值 (a [2], 打开文件 (相加 (目的目录, 文件名), #重写, #无限制))
赋值 (c [2], 0)
.如果真 (或者 (小于或等于 (复制速度, 0), 大于 (复制速度, 100)))
    赋值 (复制速度, 100)
.如果真结束
.如果真 (等于 (分割块大小, 0))
    赋值 (分割块大小, 1000)
.如果真结束
.如果 (并且 (大于 (a [1], 0), 大于 (a [2], 0)))
    赋值 (0)
    .判断循环首 (取反 (是否在文件尾 (a [1], 假)))
        .如果 (小于 (相减 (c [1], c [2]), 分割块大小))
            赋值 (b, 读入字节集 (a [1], 相减 (c [1], c [2])))
            赋值 (c [2], c [1])
            移到文件尾 (a [1])
        .否则
            赋值 (b, 读入字节集 (a [1], 分割块大小))
            赋值 (c [2], 相加 (c [2], 分割块大小))
        .如果结束
        写出字节集 (a [2], b)
        赋值 (取整 (相乘 (相除 (c [2], c [1]), 100)))
        .如果真 (小于 (复制速度, 100))
            延时 (相减 (100, 复制速度))
        .如果真结束
        .如果真 (等于 (3))
            赋值 (0)
            关闭文件 (a [1])
            关闭文件 (a [2])
            删除文件 (相加 (目的目录, 文件名))
            赋值 (0)
            返回 (假)
        .如果真结束
        处理事件 ()
    .判断循环尾 ()
    关闭文件 (a [1])
    关闭文件 (a [2])
    返回 (真)
.否则
    返回 (假)
.如果结束


.子程序 取复制文件的进度, 整数型, 公开, 取复制文件的进度
返回 ()

.子程序 停止进度复制, 空白型, 公开, 停止进度复制文件
赋值 (3)

.子程序 全文本替换, 文本型, , 
.参数 具体文本, 文本型, , 
.参数 要替换的文本, 文本型, , 
.参数 被替换的文本, 文本型, , 

.局部变量 a, 文本型, , , 
.局部变量 b, 整数型, , , 

赋值 ()
.判断循环首 (大于 (寻找文本 (a, 要替换的文本, b, 真), -1))
    赋值 (b, 寻找文本 (a, 要替换的文本, b, 真))
    赋值 (a, 文本替换 (a, b, 取文本长度 (要替换的文本), 被替换的文本))
    赋值 (b, 相加 (b, 取文本长度 (被替换的文本)))
.判断循环尾 ()
返回 (a)


 ' 不属于任何一个程序集、类模块的函数：
