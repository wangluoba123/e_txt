 ' 文件类型：Windows窗口程序

 ' 程序名称：DNSPod客户端
 ' 程序描述：管理 DNSPod 域名解析
@备注:
管理 DNSPod 域名解析
 ' 程序作者：李光
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.1
 ' 创建号：3.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 543
    高度 = 467
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口_管理域名
    左边 = 50
    顶边 = 50
    宽度 = 566
    高度 = 378
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “管理域名”
    帮助文件名 = “”

窗口 窗口_记录管理
    左边 = 50
    顶边 = 50
    宽度 = 573
    高度 = 193
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' WebBrowser2 F600363078DE49c5B10AF62C7A13B37E 2 0 WEB浏览器
 ' EXMLParser BE2297B7415349c8A55BC9DFEB6DD11A 2 0 XML解析支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一



 ' 所需要的模块
 ' 多线程控制 C:\Documents and Settings\Administrator\桌面\多线程模块.ec


数据类型 多线程许可证, 公开, 
    .成员 DebugInfo, 整数型, , , 
    .成员 LockCount, 整数型, , , 
    .成员 RecursionCount, 整数型, , , 
    .成员 OwningThread, 整数型, , , 
    .成员 LockSemaphore, 整数型, , , 
    .成员 SpinCount, 整数型, , , 

.全局变量 全局变量_账号, 文本型, , , 
.全局变量 全局变量_密码, 文本型, , , 
.全局变量 全局变量_状态, 整数型, , , 
.全局变量 全局变量_当前域名, 文本型, , , 
.全局变量 全局变量_主机记录, 文本型, , , 
.全局变量 全局变量_记录类型, 文本型, , , 
.全局变量 全局变量_线路类型, 文本型, , , 
.全局变量 全局变量_记录值, 文本型, , , 
.全局变量 全局变量_MX优先级, 文本型, , , 
.全局变量 全局变量_TTL, 文本型, , , 
.全局变量 全局变量_当前ID, 整数型, , , 
.全局变量 全局变量_管理记录, 整数型, , , 
.全局变量 全局变量_记录ID, 文本型, , , 

.DLL命令 GetTempPathA, 整数型, "", "GetTempPathA", , 
    .参数 参数1, 整数型, , 
    .参数 参数2, 文本型, , 

.DLL命令 URLDownloadToFileA, 整数型, "urlmon.dll", "URLDownloadToFileA", , 
    .参数 参数1, 整数型, , 
    .参数 HTTP文件地址, 文本型, , 
    .参数 保存到本地文件名, 文本型, , 
    .参数 参数二, 整数型, , 
    .参数 参数三, 整数型, , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 xml, 未知类型0x30001, , , 
.程序集变量 程序集变量_外网IP, 文本型, , , 
.程序集变量 程序集变量_操作, 文本型, , , 
.程序集变量 返回数据, 文本型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 广告, 文本型, , , 
.局部变量 a, 文本型, , , 
.局部变量 d, 文本型, , , 
.局部变量 ip, 文本型, , , 

 ' --========  易语言资源网  (www.wodesoft.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.wodesoft.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.wodesoft.com  ================--

赋值 (., “DNSPod 管理系统”)
赋值 (.标题, “DNSPod 客户端”)
赋值 (.Internet地址, “http://www.lgblog.org/?action=show&id=31”)
赋值 (.标题, “1.1.3”)
赋值 (.Internet地址, “http://www.lgblog.org/?action=show&id=31”)
赋值 (.标题, “李光”)
赋值 (.电子信箱地址, “master@lgblog.org”)
赋值 (.标题, “www.LgBlog.org”)
赋值 (.Internet地址, “http://www.lgblog.org”)
赋值 (.标题, “www.DNSPod.com”)
赋值 (.Internet地址, “http://www.dnspod.com”)
赋值 (., 518)
赋值 (., 407)
赋值 (广告, “http://www.lgblog.org/ad/dnspod.html”)
赋值 (a, “www.lgblog.org”)
赋值 (d, “dnspod.html”)
赋值 (ip, “61.164.140.82”)

.如果真 (不等于 (广告, “http://www.lgblog.org/ad/dnspod.html”))
    信息框 (“请不要去掉广告!!  谢谢”, #信息图标, “信息”)
    结束 ()
    返回 ()
.如果真结束
.如果真 (不等于 (a, “www.lgblog.org”))
    信息框 (“请不要去掉广告!!  谢谢”, #信息图标, “信息”)
    结束 ()
    返回 ()
.如果真结束
.如果真 (不等于 (d, “dnspod.html”))
    信息框 (“请不要去掉广告!!  谢谢”, #信息图标, “信息”)
    结束 ()
    返回 ()
.如果真结束
相加 (“http://”, a, “/ad/”, d).未知支持库函数_0 ()
赋值 (.时钟周期, 10000)
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\config.ini”), “账号信息”, “账号”, ))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\config.ini”), “账号信息”, “密码”, ))
子程序_启动线程 (&子程序_取外网IP)

.子程序 _按钮_登陆_被单击, 空白型, , 
.局部变量 局部变量_数据, 文本型, , , 
.局部变量 局部变量_数据长度, 整数型, , , 

写配置项 (相加 (取运行目录 (), “\config.ini”), “账号信息”, “账号”, .内容)
写配置项 (相加 (取运行目录 (), “\config.ini”), “账号信息”, “密码”, .内容)
赋值 (.禁止, 真)
赋值 (程序集变量_操作, “登陆”)
赋值 (局部变量_数据, 相加 (“login_email=”, .内容, “&login_password=”, .内容, “&format=xml”))
赋值 (局部变量_数据长度, 取文本长度 (局部变量_数据))

子程序_提交数据 (“/API/Domain.List”, 局部变量_数据, 局部变量_数据长度)
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 子程序_提交数据, 空白型, , 
.参数 地址, 文本型, , 
.参数 数据, 文本型, , 
.参数 长度, 整数型, , 

.局部变量 post, 文本型, , , 

赋值 (post, 相加 (“POST ”, 地址, “ HTTP/1.1”, #换行符))
赋值 (post, 相加 (post, “Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/x-ms-application, application/x-ms-xbap, application/vnd.ms-xpsdocument, application/xaml+xml, */*”, #换行符))
赋值 (post, 相加 (post, “Accept-Language: zh-cn”, #换行符))
赋值 (post, 相加 (post, “Content-Type: application/x-www-form-urlencoded”, #换行符))
赋值 (post, 相加 (post, “post+UA-CPU: x86”, #换行符))
赋值 (post, 相加 (post, “Accept-Encoding: gzip, deflate”, #换行符))
赋值 (post, 相加 (post, “User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)”, #换行符))
赋值 (post, 相加 (post, “Host: www.dnspod.com”, #换行符))
赋值 (post, 相加 (post, “Content-Length: ”, 到文本 (长度), #换行符))
赋值 (post, 相加 (post, “Connection: Keep-Alive”, #换行符))
赋值 (post, 相加 (post, “Cache-Control: no-cache”, #换行符))
赋值 (post, 相加 (post, “Cookie: ”, #换行符, #换行符))
赋值 (post, 相加 (post, 数据))

.如果真 (取反 (“www.dnspod.com”.连接 (80)))
    输出调试文本 (“连接失败”)
    信息框 (“连接服务器失败”, #信息图标, “错误”)
    返回 ()
.如果真结束
post.发送数据 ()
赋值 (.时钟周期, 10000)

.子程序 _客户_管理域名_数据到达, 空白型, , 
.局部变量 代码, 文本型, , , 

赋值 (返回数据, 相加 (返回数据, 到文本 (取回数据 ())))

.如果真 (取反 (xml.未知支持库函数_1 (到字节集 (取文本右边 (返回数据, 相加 (相减 (取文本长度 (返回数据), 寻找文本 (返回数据, “<?xml”, , 假)), 1))))))
    返回 ()
.如果真结束
赋值 (返回数据, “”)
xml.未知支持库函数_7 (“dnspod/status/code”, 代码)
赋值 (.时钟周期, 0)
.如果真 (等于 (代码, “-1”))
    输出调试文本 (“-1”)
    赋值 (全局变量_状态, 0)
    赋值 (.禁止, 假)
    信息框 (“登陆失败”, #信息图标, “信息”)
    返回 ()
.如果真结束
.如果真 (等于 (代码, “1”))
    输出调试文本 (“1”)
    .如果真 (等于 (程序集变量_操作, “登陆”))
        子程序_登陆成功 (1)
        返回 ()
    .如果真结束
    .如果真 (等于 (程序集变量_操作, “添加域名”))
        _按钮_登陆_被单击 ()
        返回 ()
    .如果真结束
    .如果真 (等于 (程序集变量_操作, “删除域名”))
        _按钮_登陆_被单击 ()
        返回 ()
    .如果真结束
    返回 ()
.如果真结束
.如果真 (等于 (代码, “2”))
    输出调试文本 (“2”)
    信息框 (“只允许POST方式”, #信息图标, “信息”)
    返回 ()
.如果真结束
.如果真 (等于 (代码, “3”))
    输出调试文本 (“3”)
    信息框 (“未知错误”, #信息图标, “信息”)
    返回 ()
.如果真结束
.如果真 (等于 (代码, “4”))
    输出调试文本 (“4”)
    .如果真 (等于 (程序集变量_操作, “登陆”))
        子程序_登陆成功 (0)
        信息框 (“您当前还没有域名, 请添加”, #信息图标, “信息”)
        返回 ()
    .如果真结束
    .如果真 (等于 (程序集变量_操作, “添加域名”))
        信息框 (“无效的域名”, #信息图标, “信息”)
        返回 ()
    .如果真结束
    .如果真 (等于 (程序集变量_操作, “删除域名”))
        信息框 (“错误的域名ID”, #信息图标, “信息”)
        返回 ()
    .如果真结束
    返回 ()
.如果真结束
.如果真 (等于 (代码, “5”))
    输出调试文本 (“5”)
    .如果真 (等于 (程序集变量_操作, “添加域名”))
        信息框 (“该域名已存在”, #信息图标, “信息”)
        返回 ()
    .如果真结束
    .如果真 (等于 (程序集变量_操作, “删除域名”))
        信息框 (“域名不存在”, #信息图标, “信息”)
        返回 ()
    .如果真结束
     ' 本源码来自易语言资源网(www.wodesoft.com)
.如果真结束
.如果真 (等于 (代码, “6”))
    输出调试文本 (“6”)
    信息框 (“您不是该域名的所有者”, #信息图标, “信息”)
.如果真结束


.子程序 子程序_登陆成功, 空白型, , 
.参数 参数, 整数型, , 

.局部变量 id, 文本型, , , 
.局部变量 name, 文本型, , , 
.局部变量 节点名, 文本型, , "0", 

.如果真 (等于 (参数, 1))
    xml.未知支持库函数_6 (“dnspod/domains”, 节点名)
    清空 ()
    .计次循环首 (取数组成员数 (节点名), )
        xml.未知支持库函数_7 (“dnspod/domains/domain/id”, id)
        xml.未知支持库函数_7 (“dnspod/domains/domain/name”, name)
        name.加入项目 (到整数 (id))
        xml.未知支持库函数_13 (“dnspod/domains/domain”)
        处理事件 ()
    .计次循环尾 ()
.如果真结束
赋值 (全局变量_账号, .内容)
赋值 (全局变量_密码, .内容)
赋值 (., 相加 (“账号:”, 全局变量_账号))
赋值 (., 相加 (“外网IP:”, 程序集变量_外网IP))
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (全局变量_状态, 1)

.子程序 子程序_取外网IP, 空白型, , 
.局部变量 文件名, 文本型, , , 
.局部变量 返回内容, 文本型, , , 

赋值 (文件名, 相加 (子程序_取临时目录 (), “waiwangIP.tmp”))
URLDownloadToFileA (0, “http://www.ip138.com/ip2city.asp”, 文件名, 0, 0)
赋值 (返回内容, 到文本 (读入文件 (文件名)))

删除文件 (文件名)

赋值 (程序集变量_外网IP, 取文本右边 (返回内容, 相减 (取文本长度 (返回内容), 寻找文本 (返回内容, “[”, , 假))))

赋值 (程序集变量_外网IP, 取文本左边 (程序集变量_外网IP, 相减 (寻找文本 (程序集变量_外网IP, “]”, , 假), 1)))

.如果真 (等于 (程序集变量_外网IP, “”))
    赋值 (程序集变量_外网IP, “获取IP失败”)
.如果真结束
输出调试文本 (程序集变量_外网IP)
.如果真 (等于 (全局变量_状态, 1))
    赋值 (., 相加 (“外网IP:”, 程序集变量_外网IP))
.如果真结束


.子程序 子程序_取临时目录, 文本型, , 
.局部变量 局部变量_目录, 文本型, , , 

赋值 (局部变量_目录, 取空白文本 (300))
GetTempPathA (300, 局部变量_目录)
返回 (局部变量_目录)

.子程序 _列表框_域名列表_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (不等于 (全局变量_状态, 1))
    返回 ()
.如果真结束
弹出菜单 ()

.子程序 _添加域名_被选择, 空白型, , 
.局部变量 局部变量_数据长度, 整数型, , , 
.局部变量 局部变量_数据, 文本型, , , 
.局部变量 域名, 文本型, , , 

.如果真 (不等于 (_启动窗口.., “http://www.lgblog.org/ad/dnspod.html”))
    信息框 (“请不要去掉广告!!  谢谢”, #信息图标, “信息”)
    结束 ()
    返回 ()
.如果真结束
 ' .如果真 (不等于 (转换为IP地址 (“www.lgblog.org”), 转换为IP地址 (“ip.lgblog.org”)))
     ' 信息框 (“请不要去掉广告!!  谢谢”, #信息图标, “信息”)
     ' 结束 ()
     ' 返回 ()
.如果真结束
.如果真 (不等于 (全局变量_状态, 1))
    返回 ()
.如果真结束
 ' 本源码来自易语言资源网(www.wodesoft.com)

赋值 (程序集变量_操作, “添加域名”)
.如果真 (取反 (输入框 (“请输入要添加的域名”, “添加域名”, “LgBlog.org”, 域名, )))
    返回 ()
.如果真结束
赋值 (局部变量_数据, 相加 (“login_email=”, 全局变量_账号, “&login_password=”, 全局变量_密码, “&format=xml&domain=”, 域名))
赋值 (局部变量_数据长度, 取文本长度 (局部变量_数据))

子程序_提交数据 (“/API/Domain.Create”, 局部变量_数据, 局部变量_数据长度)


.子程序 _删除域名_被选择, 空白型, , 
.局部变量 局部变量_数据, 文本型, , , 
.局部变量 局部变量_数据长度, 整数型, , , 

.如果真 (不等于 (_启动窗口.., “http://www.lgblog.org/ad/dnspod.html”))
    信息框 (“请不要去掉广告!!  谢谢”, #信息图标, “信息”)
    结束 ()
    返回 ()
.如果真结束
 ' .如果真 (不等于 (转换为IP地址 (“www.lgblog.org”), 转换为IP地址 (“ip.lgblog.org”)))
     ' 信息框 (“请不要去掉广告!!  谢谢”, #信息图标, “信息”)
     ' 结束 ()
     ' 返回 ()
.如果真结束

.如果真 (不等于 (全局变量_状态, 1))
    返回 ()
.如果真结束
.如果真 (等于 (.现行选中项, -1))
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (相加 (“确定删除域名:”, .取项目文本 (.现行选中项)), #是否钮, ), #否钮))
    返回 ()
.如果真结束
赋值 (程序集变量_操作, “删除域名”)
赋值 (局部变量_数据, 相加 (“login_email=”, 全局变量_账号, “&login_password=”, 全局变量_密码, “&format=xml&domain_id=”, 到文本 (.取项目数值 (.现行选中项))))
赋值 (局部变量_数据长度, 取文本长度 (局部变量_数据))

子程序_提交数据 (“/API/Domain.Remove”, 局部变量_数据, 局部变量_数据长度)


.子程序 _列表框_域名列表_列表项被选择, 空白型, , 
输出调试文本 (相加 (到文本 (.取项目数值 (.现行选中项)), “ ”, .取项目文本 (.现行选中项)))


.子程序 _管理该域名_被选择, 空白型, , 
.如果真 (不等于 (_启动窗口.., “http://www.lgblog.org/ad/dnspod.html”))
    信息框 (“请不要去掉广告!!  谢谢”, #信息图标, “信息”)
    结束 ()
    返回 ()
.如果真结束
 ' .如果真 (不等于 (转换为IP地址 (“www.lgblog.org”), 转换为IP地址 (“ip.lgblog.org”)))
     ' 信息框 (“请不要去掉广告!!  谢谢”, #信息图标, “信息”)
     ' 结束 ()
     ' 返回 ()
.如果真结束

.如果真 (不等于 (全局变量_状态, 1))
    返回 ()
.如果真结束
.如果真 (等于 (.现行选中项, -1))
    返回 ()
.如果真结束
赋值 (全局变量_当前域名, .取项目文本 (.现行选中项))
赋值 (全局变量_当前ID, .取项目数值 (.现行选中项))
载入 (窗口_管理域名, _启动窗口, 真)

.子程序 _时钟_监视内嵌浏览器_周期事件, 空白型, , 
.如果真 (不等于 (_启动窗口.., “http://www.lgblog.org/ad/dnspod.html”))
    信息框 (“请不要去掉广告!!  谢谢”, #信息图标, “信息”)
    结束 ()
    返回 ()
.如果真结束
' 本源码来自易语言资源网(www.wodesoft.com)
 ' .如果真 (不等于 (转换为IP地址 (“www.lgblog.org”), 转换为IP地址 (“ip.lgblog.org”)))
     ' 信息框 (“请不要去掉广告!!  谢谢”, #信息图标, “信息”)
     ' 结束 ()
     ' 返回 ()
.如果真结束


.子程序 _时钟_响应时间_周期事件, 空白型, , 
.如果真 (等于 (程序集变量_操作, “登陆”))
    赋值 (.禁止, 假)
.如果真结束
信息框 (“服务器没有响应.”, #信息图标, “信息”)


.窗口程序集 窗口程序集2, , , 

.程序集变量 程序集变量_操作, 文本型, , , 
.程序集变量 xml, 未知类型0x30001, , , 
.程序集变量 返回数据, 文本型, , , 
.子程序 _窗口_管理域名_创建完毕, 空白型, , 
赋值 (., 566)
赋值 (., 327)
.如果真 (不等于 (全局变量_状态, 1))
    销毁 ()
    返回 ()
.如果真结束
赋值 (.标题, 全局变量_当前域名)
子程序_取记录 ()

.子程序 子程序_取记录, 空白型, , 
.局部变量 局部变量_数据, 文本型, , , 
.局部变量 局部变量_数据长度, 整数型, , , 

赋值 (程序集变量_操作, “取记录”)
赋值 (局部变量_数据, 相加 (“login_email=”, 全局变量_账号, “&login_password=”, 全局变量_密码, “&format=xml&domain_id=”, 到文本 (全局变量_当前ID)))
赋值 (局部变量_数据长度, 取文本长度 (局部变量_数据))
 ' 本源码来自易语言资源网(www.wodesoft.com)
子程序_管理域名提交数据 (“/API/Record.List”, 局部变量_数据, 局部变量_数据长度)


.子程序 子程序_管理域名提交数据, 空白型, , 
.参数 地址, 文本型, , 
.参数 数据, 文本型, , 
.参数 长度, 整数型, , 

.局部变量 post, 文本型, , , 

赋值 (post, 相加 (“POST ”, 地址, “ HTTP/1.1”, #换行符))
赋值 (post, 相加 (post, “Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/x-ms-application, application/x-ms-xbap, application/vnd.ms-xpsdocument, application/xaml+xml, */*”, #换行符))
赋值 (post, 相加 (post, “Accept-Language: zh-cn”, #换行符))
赋值 (post, 相加 (post, “Content-Type: application/x-www-form-urlencoded”, #换行符))
赋值 (post, 相加 (post, “post+UA-CPU: x86”, #换行符))
赋值 (post, 相加 (post, “Accept-Encoding: gzip, deflate”, #换行符))
赋值 (post, 相加 (post, “User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)”, #换行符))
赋值 (post, 相加 (post, “Host: www.dnspod.com”, #换行符))
赋值 (post, 相加 (post, “Content-Length: ”, 到文本 (长度), #换行符))
赋值 (post, 相加 (post, “Connection: Keep-Alive”, #换行符))
赋值 (post, 相加 (post, “Cache-Control: no-cache”, #换行符))
赋值 (post, 相加 (post, “Cookie: ”, #换行符, #换行符))
赋值 (post, 相加 (post, 数据))
 ' 本源码来自易语言资源网(www.wodesoft.com)
.如果真 (取反 (“www.dnspod.com”.连接 (80)))
    输出调试文本 (“连接失败”)
    信息框 (“连接服务器失败”, #信息图标, “错误”)
    返回 ()
.如果真结束
post.发送数据 ()
赋值 (.时钟周期, 10000)

.子程序 _客户_管理记录_数据到达, 空白型, , 
.局部变量 代码, 文本型, , , 

赋值 (返回数据, 相加 (返回数据, 到文本 (取回数据 ())))

.如果真 (取反 (xml.未知支持库函数_1 (到字节集 (取文本右边 (返回数据, 相加 (相减 (取文本长度 (返回数据), 寻找文本 (返回数据, “<?xml”, , 假)), 1))))))
    返回 ()
.如果真结束
赋值 (返回数据, “”)
xml.未知支持库函数_7 (“dnspod/status/code”, 代码)
赋值 (.时钟周期, 0)
输出调试文本 (代码)
.如果真 (等于 (代码, “-1”))
    信息框 (“查询失败”, #信息图标, “信息”)
    返回 ()
.如果真结束
.如果真 (等于 (代码, “1”))
    .如果真 (等于 (程序集变量_操作, “取记录”))
        子程序_列出记录 ()
        返回 ()
    .如果真结束
    .如果真 (或者 (等于 (程序集变量_操作, “添加记录”), 等于 (程序集变量_操作, “修改记录”), 等于 (程序集变量_操作, “删除记录”)))
        子程序_取记录 ()
        返回 ()
    .如果真结束
    返回 ()
.如果真结束
.如果真 (等于 (代码, “2”))
    信息框 (“只允许POST方式”, #信息图标, “信息”)
    返回 ()
.如果真结束
.如果真 (等于 (代码, “3”))
    信息框 (“未知错误”, #信息图标, “信息”)
    返回 ()
.如果真结束
.如果真 (等于 (代码, “4”))
    信息框 (“错误的域名ID”, #信息图标, “信息”)
    返回 ()
.如果真结束
.如果真 (等于 (代码, “5”))
    信息框 (“该域名不存在”, #信息图标, “信息”)
    返回 ()
.如果真结束
.如果真 (等于 (代码, “6”))
    输出调试文本 (“6”)
    信息框 (“您不是该域名的所有者”, #信息图标, “信息”)
    返回 ()
.如果真结束
.如果真 (等于 (代码, “7”))
    .如果真 (等于 (程序集变量_操作, “取记录”))
        信息框 (“该域名还没有任何记录, 请添加记录”, #信息图标, “信息”)
        返回 ()
    .如果真结束
    .如果真 (等于 (程序集变量_操作, “添加记录”))
        信息框 (“缺少参数或者参数错误”, #信息图标, “信息”)
        返回 ()
    .如果真结束
    .如果真 (等于 (程序集变量_操作, “删除记录”))
        信息框 (“记录不存在”, #信息图标, “信息”)
        返回 ()
    .如果真结束
     ' 本源码来自易语言资源网(www.wodesoft.com)
.如果真结束
.如果真 (等于 (代码, “8”))
    信息框 (“主机记录错误”, #信息图标, “信息”)
    返回 ()
.如果真结束
.如果真 (等于 (代码, “9”))
    信息框 (“记录值错误”, #信息图标, “信息”)
    返回 ()
.如果真结束
.如果真 (等于 (代码, “10”))
    信息框 (“不能为@记录设置NS类型”, #信息图标, “信息”)
    返回 ()
.如果真结束
.如果真 (等于 (代码, “11”))
    信息框 (“TTL 必须大于等于 1 且 小于等于 604800”, #信息图标, “信息”)
    返回 ()
.如果真结束
.如果真 (等于 (代码, “12”))
    信息框 (“MX优先级 必须大于等于 1 且 小于等于 20”, #信息图标, “信息”)
    返回 ()
.如果真结束
.如果真 (等于 (代码, “13”))
    信息框 (“记录重复或者和 CNAME 记录冲突”, #信息图标, “信息”)
    返回 ()
.如果真结束


.子程序 子程序_列出记录, 空白型, , 
.局部变量 节点名, 文本型, , "0", 
.局部变量 id, 文本型, , , 
.局部变量 name, 文本型, , , 
.局部变量 line, 文本型, , , 
.局部变量 type, 文本型, , , 
.局部变量 ttl, 文本型, , , 
.局部变量 mx, 文本型, , , 
.局部变量 value, 文本型, , , 
.局部变量 i, 整数型, , , 
.局部变量 索引, 整数型, , , 
.局部变量 线路, 文本型, , , 
.局部变量 记录类型, 文本型, , , 

xml.未知支持库函数_6 (“dnspod/records”, 节点名)
全部删除 ()

.计次循环首 (取数组成员数 (节点名), )
    xml.未知支持库函数_7 (“dnspod/records/record/id”, id)
    xml.未知支持库函数_7 (“dnspod/records/record/name”, name)
    xml.未知支持库函数_7 (“dnspod/records/record/line”, line)
    xml.未知支持库函数_7 (“dnspod/records/record/type”, type)
    xml.未知支持库函数_7 (“dnspod/records/record/ttl”, ttl)
    xml.未知支持库函数_7 (“dnspod/records/record/value”, value)
    xml.未知支持库函数_7 (“dnspod/records/record/mx”, mx)
    赋值 (索引, .插入表项 (name, , , , 到整数 (id)))
    输出调试文本 (name)
    .如果真 (等于 (line, “1”))
        赋值 (线路, “通用”)
    .如果真结束
    .如果真 (等于 (line, “2”))
        赋值 (线路, “电信”)
    .如果真结束
    .如果真 (等于 (line, “3”))
        赋值 (线路, “网通”)
    .如果真结束
    .如果真 (等于 (line, “4”))
        赋值 (线路, “教育网”)
    .如果真结束
    .如果真 (等于 (type, “1”))
        赋值 (记录类型, “A”)
    .如果真结束
    .如果真 (等于 (type, “2”))
        赋值 (记录类型, “CNAME”)
    .如果真结束
    .如果真 (等于 (type, “3”))
        赋值 (记录类型, “MX”)
    .如果真结束
    .如果真 (等于 (type, “4”))
        赋值 (记录类型, “URL”)
    .如果真结束
    .如果真 (等于 (type, “5”))
        赋值 (记录类型, “NS”)
    .如果真结束
    .如果真 (等于 (type, “6”))
        赋值 (记录类型, “TXT”)
    .如果真结束
    .如果真 (等于 (type, “7”))
        赋值 (记录类型, “AAAA”)
    .如果真结束
    .如果真 (等于 (mx, “0”))
        赋值 (mx, “非MX记录”)
    .如果真结束
    索引.置标题 (1, 线路)
    索引.置标题 (2, 记录类型)
    索引.置标题 (3, value)
    索引.置标题 (4, mx)
    索引.置标题 (5, ttl)
    xml.未知支持库函数_13 (“dnspod/records/record”)
    处理事件 ()
.计次循环尾 ()


.子程序 _超级列表框_记录列表_右键单击表项, 空白型, , 
.如果真 (不等于 (全局变量_状态, 1))
    返回 ()
.如果真结束
弹出菜单 ()

.子程序 _添加记录_被选择, 空白型, , 
.局部变量 局部变量_数据长度, 整数型, , , 
.局部变量 局部变量_数据, 文本型, , , 

.如果真 (不等于 (_启动窗口.., “http://www.lgblog.org/ad/dnspod.html”))
    信息框 (“请不要去掉广告!!  谢谢”, #信息图标, “信息”)
    结束 ()
    返回 ()
.如果真结束
 ' .如果真 (不等于 (转换为IP地址 (“www.lgblog.org”), 转换为IP地址 (“ip.lgblog.org”)))
     ' 信息框 (“请不要去掉广告!!  谢谢”, #信息图标, “信息”)
     ' 结束 ()
     ' 返回 ()
.如果真结束

.如果真 (不等于 (全局变量_状态, 1))
    返回 ()
.如果真结束

赋值 (全局变量_管理记录, 1)

载入 (窗口_记录管理, 窗口_管理域名, 真)

.如果真 (等于 (全局变量_管理记录, -1))
    返回 ()
.如果真结束
.如果真 (等于 (全局变量_管理记录, 0))
    赋值 (程序集变量_操作, “添加记录”)
    赋值 (局部变量_数据, 相加 (“login_email=”, 全局变量_账号, “&login_password=”, 全局变量_密码, “&format=xml&domain_id=”, 到文本 (全局变量_当前ID), “&sub_domain=”, 全局变量_主机记录, “&record_type=”, 全局变量_记录类型, “&record_line=”, 全局变量_线路类型, “&value=”, 全局变量_记录值, “&mx=”, 全局变量_MX优先级, “&ttl=”, 全局变量_TTL))
    赋值 (局部变量_数据长度, 取文本长度 (局部变量_数据))
    
    子程序_管理域名提交数据 (“/API/Record.Create”, 局部变量_数据, 局部变量_数据长度)
.如果真结束
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _修改记录_被选择, 空白型, , 
.局部变量 局部变量_数据长度, 整数型, , , 
.局部变量 局部变量_数据, 文本型, , , 

.如果真 (不等于 (_启动窗口.., “http://www.lgblog.org/ad/dnspod.html”))
    信息框 (“请不要去掉广告!!  谢谢”, #信息图标, “信息”)
    结束 ()
    返回 ()
.如果真结束
 ' .如果真 (不等于 (转换为IP地址 (“www.lgblog.org”), 转换为IP地址 (“ip.lgblog.org”)))
     ' 信息框 (“请不要去掉广告!!  谢谢”, #信息图标, “信息”)
     ' 结束 ()
     ' 返回 ()
.如果真结束

.如果真 (不等于 (全局变量_状态, 1))
    返回 ()
.如果真结束
.如果真 (等于 (., -1))
    返回 ()
.如果真结束

赋值 (全局变量_主机记录, .取标题 (., 0))
赋值 (全局变量_线路类型, .取标题 (., 1))
.如果真 (等于 (全局变量_线路类型, “通用”))
    赋值 (全局变量_线路类型, “0”)
.如果真结束
.如果真 (等于 (全局变量_线路类型, “电信”))
    赋值 (全局变量_线路类型, “1”)
.如果真结束
.如果真 (等于 (全局变量_线路类型, “网通”))
    赋值 (全局变量_线路类型, “2”)
.如果真结束
.如果真 (等于 (全局变量_线路类型, “教育网”))
    赋值 (全局变量_线路类型, “3”)
.如果真结束
赋值 (全局变量_记录类型, .取标题 (., 2))
.如果真 (等于 (全局变量_记录类型, “A”))
    赋值 (全局变量_记录类型, “0”)
.如果真结束
.如果真 (等于 (全局变量_记录类型, “CNAME”))
    赋值 (全局变量_记录类型, “1”)
.如果真结束
.如果真 (等于 (全局变量_记录类型, “MX”))
    赋值 (全局变量_记录类型, “2”)
.如果真结束
.如果真 (等于 (全局变量_记录类型, “URL”))
    信息框 (“URL记录 请到 www.dnspod.com 修改”, #信息图标, “信息”)
    返回 ()
.如果真结束
.如果真 (等于 (全局变量_记录类型, “NS”))
    信息框 (“NS记录 请到 www.dnspod.com 修改”, #信息图标, “信息”)
    返回 ()
.如果真结束
.如果真 (等于 (全局变量_记录类型, “TXT”))
    信息框 (“TXT记录 请到 www.dnspod.com 修改”, #信息图标, “信息”)
    返回 ()
.如果真结束
.如果真 (等于 (全局变量_记录类型, “AAAA”))
    信息框 (“AAAA记录 请到 www.dnspod.com 修改”, #信息图标, “信息”)
    返回 ()
.如果真结束
赋值 (全局变量_记录值, .取标题 (., 3))
赋值 (全局变量_MX优先级, .取标题 (., 4))
赋值 (全局变量_TTL, .取标题 (., 5))
赋值 (全局变量_记录ID, 到文本 (.取表项数值 (.)))

赋值 (全局变量_管理记录, 2)

载入 (窗口_记录管理, 窗口_管理域名, 真)

.如果真 (等于 (全局变量_管理记录, -1))
    返回 ()
.如果真结束
.如果真 (等于 (全局变量_管理记录, 0))
    赋值 (程序集变量_操作, “修改记录”)
    赋值 (局部变量_数据, 相加 (“login_email=”, 全局变量_账号, “&login_password=”, 全局变量_密码, “&format=xml&domain_id=”, 到文本 (全局变量_当前ID), “&record_id=”, 全局变量_记录ID, “&sub_domain=”, 全局变量_主机记录, “&record_type=”, 全局变量_记录类型, “&record_line=”, 全局变量_线路类型, “&value=”, 全局变量_记录值, “&mx=”, 全局变量_MX优先级, “&ttl=”, 全局变量_TTL))
    赋值 (局部变量_数据长度, 取文本长度 (局部变量_数据))
    
    子程序_管理域名提交数据 (“/API/Record.Modify”, 局部变量_数据, 局部变量_数据长度)
    
.如果真结束




.子程序 _超级列表框_记录列表_左键单击表项, 空白型, , 
输出调试文本 (相加 (.取标题 (., 0), “ ”, .取标题 (., 1), “ ”, .取标题 (., 2)))

.子程序 _删除记录_被选择, 空白型, , 
.局部变量 局部变量_数据长度, 整数型, , , 
.局部变量 局部变量_数据, 文本型, , , 

.如果真 (不等于 (_启动窗口.., “http://www.lgblog.org/ad/dnspod.html”))
    信息框 (“请不要去掉广告!!  谢谢”, #信息图标, “信息”)
    结束 ()
    返回 ()
.如果真结束
 ' .如果真 (不等于 (转换为IP地址 (“www.lgblog.org”), 转换为IP地址 (“ip.lgblog.org”)))
     ' 信息框 (“请不要去掉广告!!  谢谢”, #信息图标, “信息”)
     ' 结束 ()
     ' 返回 ()
.如果真结束

.如果真 (不等于 (全局变量_状态, 1))
    返回 ()
.如果真结束
.如果真 (等于 (., -1))
    返回 ()
.如果真结束
赋值 (全局变量_记录ID, 到文本 (.取表项数值 (.)))

赋值 (程序集变量_操作, “删除记录”)
赋值 (局部变量_数据, 相加 (“login_email=”, 全局变量_账号, “&login_password=”, 全局变量_密码, “&format=xml&domain_id=”, 到文本 (全局变量_当前ID), “&record_id=”, 全局变量_记录ID))
赋值 (局部变量_数据长度, 取文本长度 (局部变量_数据))
' 本源码来自易语言资源网(www.wodesoft.com)
子程序_管理域名提交数据 (“/API/Record.Remove”, 局部变量_数据, 局部变量_数据长度)


.子程序 _时钟_响应时间_周期事件, 空白型, , 
信息框 (“服务器没有响应.”, #信息图标, “信息”)
销毁 ()

.窗口程序集 窗口程序集3, , , 

.子程序 _窗口_记录管理_创建完毕, 空白型, , 
.如果真 (不等于 (_启动窗口.., “http://www.lgblog.org/ad/dnspod.html”))
    信息框 (“请不要去掉广告!!  谢谢”, #信息图标, “信息”)
    结束 ()
    返回 ()
.如果真结束
 ' .如果真 (不等于 (转换为IP地址 (“www.lgblog.org”), 转换为IP地址 (“ip.lgblog.org”)))
     ' 信息框 (“请不要去掉广告!!  谢谢”, #信息图标, “信息”)
     ' 结束 ()
     ' 返回 ()
.如果真结束

.如果真 (并且 (不等于 (全局变量_管理记录, 1), 不等于 (全局变量_管理记录, 2)))
    销毁 ()
    返回 ()
.如果真结束
赋值 (., 全局变量_当前域名)
.如果真 (等于 (全局变量_管理记录, 2))
    赋值 (.内容, 全局变量_主机记录)
    赋值 (.现行选中项, 到整数 (全局变量_记录类型))
    赋值 (.现行选中项, 到整数 (全局变量_线路类型))
    赋值 (.内容, 全局变量_记录值)
    赋值 (.现行选中项, 到整数 (全局变量_MX优先级))
    赋值 (.内容, 全局变量_TTL)
.如果真结束
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _组合框_记录类型_列表项被选择, 空白型, , 
.如果真 (等于 (.现行选中项, 2))
    赋值 (.禁止, 假)
    赋值 (.现行选中项, 1)
    返回 ()
.如果真结束
赋值 (.禁止, 真)
赋值 (.现行选中项, 0)

.子程序 _组合框_MX优先级_列表项被选择, 空白型, , 
.如果真 (不等于 (.现行选中项, 2))
    赋值 (.禁止, 真)
    赋值 (.现行选中项, 0)
    返回 ()
.如果真结束


.子程序 _编辑框_TTL_内容被改变, 空白型, , 
.如果真 (或者 (小于 (到整数 (.内容), 1), 大于 (到整数 (.内容), 604800)))
    赋值 (.内容, “3600”)
    信息框 (“TTL不可小于 1 且 不可大于 604800”, #信息图标, “错误”)
    返回 ()
.如果真结束
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _按钮_更新记录_被单击, 空白型, , 
.如果真 (不等于 (_启动窗口.., “http://www.lgblog.org/ad/dnspod.html”))
    信息框 (“请不要去掉广告!!  谢谢”, #信息图标, “信息”)
    结束 ()
    返回 ()
.如果真结束
 ' .如果真 (不等于 (转换为IP地址 (“www.lgblog.org”), 转换为IP地址 (“ip.lgblog.org”)))
     ' 信息框 (“请不要去掉广告!!  谢谢”, #信息图标, “信息”)
     ' 结束 ()
     ' 返回 ()
.如果真结束

.如果真 (等于 (.内容, “”))
    赋值 (.内容, “@”)
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“记录值不可空”, #信息图标, “错误”)
    返回 ()
.如果真结束
赋值 (全局变量_主机记录, .内容)
赋值 (全局变量_记录类型, 到文本 (.取项目数值 (.现行选中项)))
赋值 (全局变量_线路类型, 到文本 (.取项目数值 (.现行选中项)))
.如果真 (或者 (等于 (全局变量_记录类型, “2”), 等于 (全局变量_记录类型, “3”)))
    .如果真 (不等于 (倒找文本 (.内容, “.”, , 假), 取文本长度 (.内容)))
        赋值 (.内容, 相加 (.内容, “.”))
    .如果真结束
    
.如果真结束
赋值 (全局变量_记录值, .内容)
赋值 (全局变量_MX优先级, .取项目文本 (.现行选中项))
赋值 (全局变量_TTL, .内容)
赋值 (全局变量_管理记录, 0)
销毁 ()
' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _窗口_记录管理_可否被关闭, 逻辑型, , 
赋值 (全局变量_管理记录, -1)
销毁 ()

.子程序 _编辑框_记录_失去焦点, 空白型, , 
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “@”)
.如果真结束


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 子程序_启动线程, 逻辑型, , 
.参数 欲执行的子程序, 子程序指针, , 
.参数 参数数据, 整数型, 可空, 
.参数 线程句柄, 整数型, 参考 可空, 



.子程序 子程序_创建进入许可证, 多线程许可证, , 


.子程序 子程序_删除进入许可证, 空白型, , 
.参数 进入许可证, 多线程许可证, , 



.子程序 子程序_进入许可区, 空白型, , 
.参数 进入许可证, 多线程许可证, , 



.子程序 子程序_退出许可区, 空白型, , 
.参数 进入许可证, 多线程许可证, , 



.子程序 子程序_等待线程, 逻辑型, , 
.参数 线程句柄, 整数型, , 
.参数 等待时间, 整数型, 可空, 单位为毫秒，0和-1表示无限等待



.子程序 子程序_强制结束线程, 逻辑型, , 
.参数 线程句柄, 整数型, , 



.子程序 子程序_关闭线程句柄, 逻辑型, , 
.参数 线程句柄, 整数型, , 



.子程序 子程序_挂起线程, 逻辑型, , 
.参数 线程句柄, 整数型, , 



.子程序 子程序_继续执行, 空白型, , 继续运行被挂起的线程
.参数 线程句柄, 整数型, , 



.子程序 子程序_取线程返回值, 整数型, , 使用前请保证线程已经运行完毕，如线程尚未中断将返回STILL_ACTIVE(值为259)。子程序返回值为其他数据类型将返回指针。
.参数 线程句柄, 整数型, , 




 ' 不属于任何一个程序集、类模块的函数：
