 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 2 0 系统核心支持库



窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 487
    高度 = 266
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 已保存到：D:\易语言学习\Data\filesbox.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “打包工2.1”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 370
    高度 = 248
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.图片 图标, " ' 已保存到：D:\易语言学习\Data\filesbox.e\图标", , 
.图片 缩小1, " ' 已保存到：D:\易语言学习\Data\filesbox.e\缩小1", , 
.图片 缩小2, " ' 已保存到：D:\易语言学习\Data\filesbox.e\缩小2", , 
.图片 缩小3, " ' 已保存到：D:\易语言学习\Data\filesbox.e\缩小3", , 
.图片 关闭1, " ' 已保存到：D:\易语言学习\Data\filesbox.e\关闭1", , 
.图片 关闭2, " ' 已保存到：D:\易语言学习\Data\filesbox.e\关闭2", , 
.图片 关闭3, " ' 已保存到：D:\易语言学习\Data\filesbox.e\关闭3", , 
.图片 添加1, " ' 已保存到：D:\易语言学习\Data\filesbox.e\添加1", , 
.图片 添加2, " ' 已保存到：D:\易语言学习\Data\filesbox.e\添加2", , 
.图片 添加3, " ' 已保存到：D:\易语言学习\Data\filesbox.e\添加3", , 
.图片 删除1, " ' 已保存到：D:\易语言学习\Data\filesbox.e\删除1", , 
.图片 删除2, " ' 已保存到：D:\易语言学习\Data\filesbox.e\删除2", , 
.图片 删除3, " ' 已保存到：D:\易语言学习\Data\filesbox.e\删除3", , 
.图片 清空1, " ' 已保存到：D:\易语言学习\Data\filesbox.e\清空1", , 
.图片 清空2, " ' 已保存到：D:\易语言学习\Data\filesbox.e\清空2", , 
.图片 清空3, " ' 已保存到：D:\易语言学习\Data\filesbox.e\清空3", , 
.图片 组合1, " ' 已保存到：D:\易语言学习\Data\filesbox.e\组合1", , 
.图片 组合2, " ' 已保存到：D:\易语言学习\Data\filesbox.e\组合2", , 
.图片 组合3, " ' 已保存到：D:\易语言学习\Data\filesbox.e\组合3", , 
.图片 关于1, " ' 已保存到：D:\易语言学习\Data\filesbox.e\关于1", , 
.图片 关于2, " ' 已保存到：D:\易语言学习\Data\filesbox.e\关于2", , 
.图片 关于3, " ' 已保存到：D:\易语言学习\Data\filesbox.e\关于3", , 
.图片 退出1, " ' 已保存到：D:\易语言学习\Data\filesbox.e\退出1", , 
.图片 退出2, " ' 已保存到：D:\易语言学习\Data\filesbox.e\退出2", , 
.图片 退出3, " ' 已保存到：D:\易语言学习\Data\filesbox.e\退出3", , 



.窗口程序集 窗口程序集1, , , 

.程序集变量 库文件名, 文本型, , , 
.程序集变量 文件集, 字节集, , , 
.程序集变量 外壳文件名, 文本型, , , 
.程序集变量 写出文件名, 文本型, , , 
.程序集变量 是否生成说明, 逻辑型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (外壳文件名, 相加 (取运行目录 (), “\fileswk.exe”))
.如果真 (等于 (文件是否存在 (外壳文件名), 假))
    信息框 (相加 (“错误！文件‘”, 外壳文件名, “’没有找到！”), #错误图标, “错误！”)
    结束 ()
.如果真结束
赋值 (., #图标)

赋值 (., #缩小1)
赋值 (., #缩小2)
赋值 (., #缩小3)

赋值 (., #关闭1)
赋值 (., #关闭2)
赋值 (., #关闭3)

赋值 (., #添加1)
赋值 (., #添加2)
赋值 (., #添加3)

赋值 (., #删除1)
赋值 (., #删除2)
赋值 (., #删除3)

赋值 (., #清空1)
赋值 (., #清空2)
赋值 (., #清空3)

赋值 (., #组合1)
赋值 (., #组合2)
赋值 (., #组合3)
赋值 (., #组合3)

赋值 (., #关于1)
赋值 (., #关于2)
赋值 (., #关于3)

赋值 (., #退出1)
赋值 (., #退出2)
赋值 (., #退出3)

赋值 (是否生成说明, 真)

.子程序 _缩小图形按钮_被单击, 空白型, , 
赋值 (., 2)

.子程序 _关闭图形按钮_被单击, 空白型, , 
结束 ()

.子程序 _添加图形按钮_被单击, 空白型, , 
.局部变量 项目号, 整数型, , , 
.局部变量 是否重复, 逻辑型, , , 判断新加入的文件是否有重复

赋值 (项目号, 0)
赋值 (是否重复, 假)
赋值 (., 0)
赋值 (., “*.*”)
赋值 (., “所有文件（*.*）|*.*”)
.如果真 (打开 ())
    .计次循环首 (取项目数 (), )
        .如果 (等于 (项目号.取项目文本 (), .))
            赋值 (真)
            跳出循环 ()
        .否则
            赋值 (假)
            赋值 (项目号, 相加 (项目号, 1))
        .如果结束
        
    .计次循环尾 ()
    .如果 (等于 (假))
        .加入项目 (., )
    .否则
        信息框 (“您所选择的文件已存在！”, #警告图标, “注意！”)
    .如果结束
    
.如果真结束
文件数目标题 ()

.子程序 _删除图形按钮_被单击, 空白型, , 
.如果 (等于 (., -1))
    信息框 (“您还未选择文件！”, #警告图标, “注意！”)
.否则
    .如果真 (等于 (信息框 (“您确定要删除当前选中的文件吗？”, 相加 (#信息图标, #取消钮), “注意！”), 0))
        .删除项目 (.)
        文件数目标题 ()
    .如果真结束
    
.如果结束


.子程序 _清空图形按钮_被单击, 空白型, , 
.如果真 (等于 (信息框 (“您确定要删除当前列表中所有的文件吗？”, 相加 (#信息图标, #取消钮), “注意！”), 0))
    清空 ()
    文件数目标题 ()
.如果真结束


.子程序 _选择框_被单击, 空白型, , 
.如果 (等于 (是否生成说明, 真))
    赋值 (., 假)
    赋值 (是否生成说明, 假)
.否则
    赋值 (., 真)
    赋值 (是否生成说明, 真)
.如果结束


.子程序 _组合图形按钮_被单击, 空白型, , 
.如果 (小于或等于 (取项目数 (), 0))
    信息框 (“列表框内没有文件！”, #警告图标, “注意！”)
.否则
    赋值 (., 1)
    赋值 (., “”)
    赋值 (., “可执行文件（*.exe）|*.exe”)
    .如果真 (打开 ())
        置等待鼠标 ()
        赋值 (., 真)
        赋值 (.)
        赋值 (., 相加 (取项目数 (), 5))
        赋值 (文件集, 读入文件 (外壳文件名))
        建立数据库 ()
        赋值 (., 相加 (., 1))
        未知函数_67174589 ()
        删除文件 (库文件名)
        写到文件 (文件集)
        .如果真 (等于 (是否生成说明, 真))
            生成说明文件 ()
        .如果真结束
        赋值 (., .)
        恢复鼠标 ()
        信息框 (相加 (“文件成功合并到：”, , “！”), #信息图标, “注意！”)
        赋值 (., 0)
        赋值 (., 假)
    .如果真结束
    
.如果结束


.子程序 _关于图形按钮_被单击, 空白型, , 
载入 (关于窗口, _启动窗口, 真)

.子程序 _退出图形按钮_被单击, 空白型, , 
结束 ()

.子程序 文件数目标题, 空白型, , 
赋值 (., 相加 (“列表框内共有”, “”, 到文本 (取项目数 ()), “”, “个文件”))

.子程序 建立数据库, 空白型, , 
.局部变量 字段名, 字段信息, , , 
.局部变量 字段表, 字段信息, , "0", 

赋值 (库文件名, 相加 (取运行目录 (), “\fileline.edb”))
重定义数组 (假, 2)
赋值 (字段名., “文件名”)
赋值 (字段名., 50)
赋值 (., #文本型)
插入成员 (1, )

赋值 (字段名., “长度”)
赋值 (字段名., #整数型)
插入成员 (2, )

创建 ()
关闭 ()

.子程序 组合文件, 空白型, , 
.局部变量 现行列表项, 整数型, , , 
.局部变量 文件名, 文本型, , , 
.局部变量 斜线位置, 整数型, , , 
.局部变量 文件大小, 整数型, , , 
.局部变量 字节分割符, 字节型, , , 
.局部变量 库文件长度, 整数型, , , 
.局部变量 外壳文件大小, 整数型, , , 

赋值 (外壳文件大小, 取文件尺寸 (外壳文件名))
打开 (库文件名, , , , , , )
跳到 (1)
加记录 (“wk.exe”, 外壳文件大小)
.计次循环首 (取项目数 (), )
    赋值 (文件名, 现行列表项.取项目文本 ())
    赋值 (文件集, 相加 (文件集, 读入文件 (文件名)))
    赋值 (文件大小, 取文件尺寸 (文件名))
    赋值 (斜线位置, 倒找文本 (文件名, “\”, , 真))
    赋值 (文件名, 取文本右边 (文件名, 相减 (取文本长度 (文件名), 斜线位置)))
    加记录 (文件名, 文件大小)
    赋值 (现行列表项, 相加 (现行列表项, 1))
    赋值 (., 相加 (., 1))
.计次循环尾 ()
关闭 (库文件名)
赋值 (库文件长度, 取字节集长度 (读入文件 (库文件名)))
赋值 (文件集, 相加 (文件集, 读入文件 (库文件名), 到字节集 (库文件长度)))

.子程序 生成说明文件, 空白型, , 
.局部变量 说明文本, 文本型, , , 
.局部变量 列表当前项, 整数型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 说明文件名, 文本型, , , 

赋值 (说明文本, 相加 (“文件 ”, 写出文件名, “说明：”, #换行符, #换行符, “本文件由下例文件合并而成：”))
.计次循环首 (取项目数 (), 列表当前项)
    赋值 (说明文本, 相加 (说明文本, #换行符, “    ”, 相减 (列表当前项, 1).取项目文本 ()))
.计次循环尾 ()
赋值 (., 相加 (., 1))
赋值 (说明文本, 相加 (说明文本, #换行符, #换行符, “本文件由程序‘”, ., “’生成，作者：何维。谢谢使用！”, #换行符, “生成时间：”, 时间到文本 (取现行时间 (), )))
赋值 (说明文件名, 相加 (取文本左边 (写出文件名, 相减 (倒找文本 (写出文件名, “.”, , 真), 1)), “.txt”))
赋值 (文件号, 打开文件 (说明文件名, 4, ))
写出文本 (文件号, 说明文本)
关闭文件 (文件号)

.窗口程序集 窗口程序集2, , , 

.子程序 _关于窗口_创建完毕, 空白型, , 
赋值 (., #图标)
赋值 (., #关闭1)
赋值 (., #关闭2)
赋值 (., #关闭3)
赋值 (., 相加 (“关于程序：”, #换行符, #换行符, “1、可将多个文件合并成一个可执行文件。”, #换行符, “2、执行生的可执行文件就可打开原先的多个文件。”, #换行符, “3、如果文件较大、较多则需要较长时间和较大的内存。”, #换行符, “4、编辑者：何维”, #换行符, “   QQ号：39237979”))

.子程序 _关闭图形按钮_被单击, 空白型, , 
销毁 ()


 ' 不属于任何一个程序集、类模块的函数：
