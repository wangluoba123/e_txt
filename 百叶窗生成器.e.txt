 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 612
    高度 = 313
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 窗口播放
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 0 '  0x0
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.常量 程序标题, "“百叶窗生成器”", , 
.常量 程序版本, "“1.0”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库



 ' 所需要的模块
 ' 古木_选择文件夹 I:\zjsWorks\e\eCom\BrowseForFolder\古木_选择文件夹.ec



.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (., 相加 (#程序标题, “ - ”, #程序版本, “  【武汉华瑞广告有限公司】”))


.子程序 _按钮添加_被单击, 空白型, , 
.如果真 (打开 ())
    .加入项目 (., )
.如果真结束


.子程序 _按钮播放_被单击, 空白型, , 
.如果真 (或者 (等于 (到数值 (.), 0), 等于 (到数值 (.), 0)))
    信息框 (“图片宽高不能为0。”, #信息图标, #程序标题)
    返回 ()
.如果真结束
.如果真 (小于或等于 (到数值 (.), 0))
    信息框 (“图片块数必须大于1！”, #信息图标, #程序标题)
    返回 ()
.如果真结束
.如果真 (小于 (取项目数 (), 2))
    信息框 (“请至少添加两张图片。”, #信息图标, #程序标题)
    返回 ()
.如果真结束
载入 (窗口播放, _启动窗口, 真)


.子程序 _按钮删除_被单击, 空白型, , 
.如果真 (小于 (., 0))
    信息框 (“请先选择一个项目！”, #信息图标, #程序标题)
    返回 ()
.如果真结束
.删除项目 (.)


.子程序 _按钮全部删除_被单击, 空白型, , 
.如果真 (等于 (信息框 (“你确定要全部删除吗？”, 位或 (#询问图标, #是否钮), #程序标题), #是钮))
    清空 ()
.如果真结束


.子程序 _列表框文件_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #Del键))
    _按钮删除_被单击 ()
.如果真结束


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 关于信息, 文本型, , , 

赋值 (关于信息, 相加 (#程序标题, #程序版本, #换行符))
赋值 (关于信息, 相加 (关于信息, “作者：曾劲松 2006.5.29”, #换行符))
赋值 (关于信息, 相加 (关于信息, “主页：http://www.goomoo.cn”, #换行符))
信息框 (关于信息, #信息图标, #程序标题)


.子程序 _选择框保存图片序列_被单击, 空白型, , 
.如果 (.)
    赋值 (., 古木_选择文件夹 (_启动窗口, #程序标题, “请选择要保存图片序列的文件夹。”, ))
.否则
    赋值 (., “”)
.如果结束


.窗口程序集 窗口程序集播放, , , 

.程序集变量 集索引, 整数型, , , 
.程序集变量 集上次索引, 整数型, , , 
.程序集变量 集块数, 整数型, , , 
.程序集变量 集图片宽度, 整数型, , , 
.程序集变量 集图片高度, 整数型, , , 
.程序集变量 集切换延时, 整数型, , , 
.程序集变量 集文件夹, 文本型, , , 
.程序集变量 集计数, 整数型, , , 
.子程序 _窗口播放_创建完毕, 空白型, , 
赋值 (集图片宽度, 到数值 (_启动窗口..))
赋值 (集图片高度, 到数值 (_启动窗口..))
赋值 (集切换延时, 到数值 (_启动窗口..))
赋值 (集块数, 到数值 (_启动窗口..))
赋值 (集文件夹, _启动窗口..)

.如果 (_启动窗口..)
    移动 (0, 0, 取屏幕宽度 (), 取屏幕高度 ())
.否则
    赋值 (., 集图片宽度)
    赋值 (., 集图片高度)
    赋值 (., 1)
.如果结束

相除 (相减 (., 集图片宽度), 2).移动 (相除 (相减 (., 集图片高度), 2), 集图片宽度, 集图片高度)
赋值 (., 集图片宽度)
赋值 (., 集图片高度)
赋值 (., 集图片宽度)
赋值 (., 集图片高度)
赋值 (., 相乘 (到数值 (_启动窗口..), 1000))
输出调试文本 (.)

赋值 (集上次索引, 0)
赋值 (集索引, 1)
赋值 (., 读入文件 (_启动窗口.取项目文本 (., 0)))
赋值 (., 读入文件 (_启动窗口.取项目文本 (., 集上次索引)))
赋值 (., 读入文件 (_启动窗口.取项目文本 (., 集索引)))


.子程序 _时钟_周期事件, 空白型, , 
.局部变量 i, 空白型, , , 
.局部变量 j, 空白型, , , 
.局部变量 dw, 空白型, , , 
.局部变量 格宽, 空白型, , , 
.局部变量 文件名, 文本型, , , 

赋值 (格宽, 相除 (集图片宽度, 集块数))
 ' 文件名 ＝ 字符 (集上次索引 ＋ 64) ＋ 字符 (集索引 ＋ 64)
赋值 (j, 0)
赋值 (集计数, 相加 (集计数, 1))
.判断循环首 (小于 (dw, 格宽))
    赋值 (dw, 相加 (dw, 1))
    赋值 (j, 相加 (j, 1))
    .计次循环首 (相加 (集块数, 1), i)
         ' 输出调试文本 (i)
        相乘 (相减 (i, 1), 格宽).复制 (0, dw, ., , 相乘 (相减 (i, 1), 格宽), 0, )
         ' 处理事件 ()
    .计次循环尾 ()
    0.复制 (0, ., ., , 0, 0, )
    .如果真 (并且 (不等于 (集文件夹, “”), 小于 (集计数, 相加 (_启动窗口.取项目数 (.), 1))))
        赋值 (文件名, 相加 (集文件夹, “\”, 字符 (相加 (集上次索引, 65)), 字符 (相加 (集索引, 65)), “_”, 左填充零 (j, 5), “.bmp”))
        写到文件 (文件名, .取图片 ())
    .如果真结束
    延时 (相除 (相乘 (集切换延时, 1000), 集块数))
.判断循环尾 ()

赋值 (集上次索引, 集索引)
赋值 (集索引, 相加 (集索引, 1))
赋值 (集索引, 求余数 (集索引, _启动窗口.取项目数 (.)))
赋值 (., 读入文件 (_启动窗口.取项目文本 (., 集索引)))
赋值 (., 读入文件 (_启动窗口.取项目文本 (., 集上次索引)))


.子程序 左填充零, 文本型, , 
.参数 参数值, 整数型, , 
.参数 参达到长度, 整数型, , 

.局部变量 s, 文本型, , , 

赋值 (s, 到文本 (参数值))
赋值 (s, 相加 (取重复文本 (相减 (参达到长度, 取文本长度 (s)), “0”), s))
返回 (s)

.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 古木_选择文件夹, 文本型, , 取消则返回空文本。
.参数 参父窗口, 窗口, , 
.参数 参标题, 文本型, 可空, 
.参数 参提示, 文本型, 可空, 
.参数 参默认文件夹, 文本型, 可空, 



.子程序 文件夹是否存在, 逻辑型, , 
.参数 参文件夹名, 文本型, , 




 ' 不属于任何一个程序集、类模块的函数：
