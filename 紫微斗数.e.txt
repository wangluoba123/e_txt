 ' 文件类型：Windows模块源码

 ' 程序名称：云外归鸟_紫微斗数
 ' 程序描述：紫微斗数是中国古代术数体系中相当重要的一种，是根据一个人的出生的年月日时来排出地盘十二宫的位置以构成命盘，参看各个宫位的星系之间的关系来预测一个人一生总体运程和吉凶祸福的一种术数。在中国古代天文学里，把天上的星辰与人间的人事相对应。人间最尊贵的就是帝王，而天上的帝王就是紫微星，也就是北极星，它在紫微垣统领天上的星辰。“紫微”就是“紫微斗数”全部星曜的首领和代表。按照紫微斗数中星曜的划分方法，全部星曜分为北斗、南斗和中天三个系统，“紫微斗数”中的“斗”就是南北二斗的意思。至于“紫微斗数”中的“数”指的是吉凶祸福的气数。因此，所谓“紫微斗数”就是将人出生的年月日时按照特定的方法换算为以紫微星为首的南北二斗星辰排布来推算人一生吉凶祸福、命运气数的一种术数。紫微斗数也简称为紫微斗或斗数，被命理界称为三大神数之首。 


 ' 程序作者：云外归鸟
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：catboygo@163.com
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库



 ' 所需要的模块
 ' 云外归鸟万年历函数集 F:\易之缘风暴\万年历.ec



.程序集 程序集1, , , 

.程序集变量 aryZhu, 空白型, , "4", 四柱数组，成员1为年柱，类推
.程序集变量 aryDateTime, 空白型, , "5", 公历时间数组，成员依次为年月日时分
.程序集变量 aryDateTimeYinli, 空白型, , "3", 农历时间数组，成员依次为年月日
.程序集变量 IsLeapMoon, 逻辑型, , , 是否闰月
.程序集变量 sdata_level, 空白型, , , 命盘详细度
.程序集变量 sdata_star_level, 空白型, , , 星曜详细度
.程序集变量 sdata_sex, 空白型, , , 性别，男0女1
.程序集变量 data_fenjie, 空白型, , , 
.程序集变量 匿名程序集变量_159, 空白型, , , 
.程序集变量 result_year_kan, 空白型, , , 
.程序集变量 result_year_chi, 空白型, , , 
.程序集变量 result_month, 空白型, , , 
.程序集变量 result_day, 空白型, , , 
.程序集变量 result_time_chi, 空白型, , , 
.程序集变量 result_month2, 空白型, , , 
.程序集变量 匿名程序集变量_166, 空白型, , , 
.程序集变量 square, 文本型, , "13,17", 
.程序集变量 I, 空白型, , , 
.程序集变量 J, 空白型, , , 
.程序集变量 K, 空白型, , , 
.程序集变量 square_kan_table_16, 空白型, , "0", 起十二宫天干
.程序集变量 square_kan_table_27, 空白型, , "0", 
.程序集变量 square_kan_table_38, 空白型, , "0", 
.程序集变量 square_kan_table_49, 空白型, , "0", 
.程序集变量 square_kan_table_50, 空白型, , "0", 
.程序集变量 square_life_house, 空白型, , , 起命宫表
.程序集变量 square_life_house12, 空白型, , "0", 
.程序集变量 square_life_house11, 空白型, , "0", 
.程序集变量 square_life_house10, 空白型, , "0", 
.程序集变量 square_life_house9, 空白型, , "0", 
.程序集变量 square_life_house8, 空白型, , "0", 
.程序集变量 square_life_house7, 空白型, , "0", 
.程序集变量 square_life_house6, 空白型, , "0", 
.程序集变量 square_life_house5, 空白型, , "0", 
.程序集变量 square_life_house4, 空白型, , "0", 
.程序集变量 square_life_house3, 空白型, , "0", 
.程序集变量 square_life_house2, 空白型, , "0", 
.程序集变量 square_life_house1, 空白型, , "0", 
.程序集变量 square_name_table, 文本型, , "0", 宫位名称表
.程序集变量 square_body_house, 空白型, , , 起身宫表
.程序集变量 square_body_house12, 空白型, , "0", 
.程序集变量 square_body_house11, 空白型, , "0", 
.程序集变量 square_body_house10, 空白型, , "0", 
.程序集变量 square_body_house9, 空白型, , "0", 
.程序集变量 square_body_house8, 空白型, , "0", 
.程序集变量 square_body_house7, 空白型, , "0", 
.程序集变量 square_body_house6, 空白型, , "0", 
.程序集变量 square_body_house5, 空白型, , "0", 
.程序集变量 square_body_house4, 空白型, , "0", 
.程序集变量 square_body_house3, 空白型, , "0", 
.程序集变量 square_body_house2, 空白型, , "0", 
.程序集变量 square_body_house1, 空白型, , "0", 
.程序集变量 naning_kan, 空白型, , , 定五行局之六十花甲纳音表
.程序集变量 naning_chi, 空白型, , , 
.程序集变量 fivestar_name, 文本型, , , 
.程序集变量 fivestar, 空白型, , , 
.程序集变量 fivestar9, 文本型, , "0", 
.程序集变量 fivestar7, 文本型, , "0", 
.程序集变量 fivestar5, 文本型, , "0", 
.程序集变量 fivestar3, 文本型, , "0", 
.程序集变量 fivestar1, 文本型, , "0", 
.程序集变量 life_master, 文本型, , , 起大限与命主身主
.程序集变量 body_master, 文本型, , , 
.程序集变量 life_master1, 文本型, , "0", 
.程序集变量 body_master1, 文本型, , "0", 
.程序集变量 StarTable, 文本型, , "64,2", 起始星盘表格
.程序集变量 TzeWay3, 空白型, , "0", 起紫微表
.程序集变量 TzeWay6, 空白型, , "0", 
.程序集变量 TzeWay5, 空白型, , "0", 
.程序集变量 TzeWay4, 空白型, , "0", 
.程序集变量 TzeWay2, 空白型, , "0", 
.程序集变量 NorthStar12, 空白型, , "0", 起北斗星系表
.程序集变量 NorthStar11, 空白型, , "0", 
.程序集变量 NorthStar10, 空白型, , "0", 
.程序集变量 NorthStar9, 空白型, , "0", 
.程序集变量 NorthStar8, 空白型, , "0", 
.程序集变量 NorthStar7, 空白型, , "0", 
.程序集变量 NorthStar6, 空白型, , "0", 
.程序集变量 NorthStar5, 空白型, , "0", 
.程序集变量 NorthStar4, 空白型, , "0", 
.程序集变量 NorthStar3, 空白型, , "0", 
.程序集变量 NorthStar2, 空白型, , "0", 
.程序集变量 NorthStar1, 空白型, , "0", 
.程序集变量 TienFu, 空白型, , "0", 起天府表
.程序集变量 SouthStar12, 空白型, , "0", 起南斗星系表
.程序集变量 SouthStar11, 空白型, , "0", 
.程序集变量 SouthStar10, 空白型, , "0", 
.程序集变量 SouthStar9, 空白型, , "0", 
.程序集变量 SouthStar8, 空白型, , "0", 
.程序集变量 SouthStar7, 空白型, , "0", 
.程序集变量 SouthStar6, 空白型, , "0", 
.程序集变量 SouthStar5, 空白型, , "0", 
.程序集变量 SouthStar4, 空白型, , "0", 
.程序集变量 SouthStar3, 空白型, , "0", 
.程序集变量 SouthStar2, 空白型, , "0", 
.程序集变量 SouthStar1, 空白型, , "0", 
.程序集变量 ZuoFu, 空白型, , "0", 起辅弼昌曲
.程序集变量 YuoBi, 空白型, , "0", 
.程序集变量 WenChang, 空白型, , "0", 
.程序集变量 WenChu, 空白型, , "0", 
.程序集变量 FireStar4, 空白型, , "0", 起火铃
.程序集变量 FireStar3, 空白型, , "0", 
.程序集变量 FireStar2, 空白型, , "0", 
.程序集变量 FireStar1, 空白型, , "0", 
.程序集变量 RingStar1, 空白型, , "0", 
.程序集变量 RingStar2, 空白型, , "0", 
.程序集变量 TienKue, 空白型, , "0", 起魁钺马禄擎陀
.程序集变量 TienKue1, 空白型, , "0", 
.程序集变量 TienWu, 空白型, , "0", 
.程序集变量 TienMa, 空白型, , "0", 
.程序集变量 LuChuang, 空白型, , "0", 
.程序集变量 HuaLu, 空白型, , "0", 起四化星
.程序集变量 HuaChuang, 空白型, , "0", 
.程序集变量 HuaKer, 空白型, , "0", 
.程序集变量 HuaChi, 空白型, , "0", 
.程序集变量 MasterKong, 空白型, , , 正傍空
.程序集变量 SubKong, 空白型, , , 
.程序集变量 aryGan, 文本型, , "0", 
.程序集变量 aryZhi, 文本型, , "0", 
.程序集变量 aryYue, 文本型, , "0", 
.程序集变量 aryYinliDay, 文本型, , "0", 
.子程序 _启动子程序, 整数型, , 请在本子程序中放置动态链接库初始化代码

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 返回值被忽略。

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。
 ' 载入 (窗口1, , 真)
紫微斗数排盘 (取现行时间 (), 真, 3, 3)

.子程序 紫微斗数排盘, 文本型, 公开, 
.参数 公历日期, 日期时间型, , 测算日期
.参数 性别, 逻辑型, , 男假女真
.参数 命盘详细度, 整数型, , 3、完整盘(90颗星)；2、常见盘(66颗星)；1、简盘(35颗星)；0、极简盘(30颗星)
.参数 星曜详细度, 整数型, , 3、辅曜星等；2、正曜星等；1、增长生十二运；0、忽略

.局部变量 HongLuang, 空白型, , "0", 
.局部变量 TienHsing, 空白型, , "0", 
.局部变量 HsienChi, 空白型, , "0", 
.局部变量 TienKuan, 空白型, , "0", 排列其他星
.局部变量 LongChi, 空白型, , "0", 
.局部变量 FongKer, 空白型, , "0", 
.局部变量 TienTer, 空白型, , "0", 
.局部变量 SheiSheng, 空白型, , "0", 
.局部变量 TienKu, 空白型, , "0", 
.局部变量 TienShu, 空白型, , "0", 
.局部变量 GuChen, 空白型, , "0", 
.局部变量 GuaShuo, 空白型, , "0", 
.局部变量 HuaKai, 空白型, , "0", 
.局部变量 JieSa, 空白型, , "0", 
.局部变量 YueTer, 空白型, , "0", 
.局部变量 FeLieng, 空白型, , "0", 
.局部变量 DaHow, 空白型, , "0", 
.局部变量 ProShue, 空白型, , "0", 
.局部变量 TienYuo, 空白型, , "0", 
.局部变量 YingSa, 空白型, , "0", 
.局部变量 DiKong, 空白型, , "0", 
.局部变量 DiJie, 空白型, , "0", 
.局部变量 TaiFu, 空白型, , "0", 
.局部变量 FongGao, 空白型, , "0", 
.局部变量 TaiSue, 文本型, , "0", 
.局部变量 BorShe, 文本型, , "0", 
.局部变量 年份, 整数型, , , 
.局部变量 月份, 整数型, , , 
.局部变量 日, 整数型, , , 
.局部变量 小时, 整数型, , , 
.局部变量 分钟, 整数型, , , 

赋值 (年份, 取年份 (公历日期))
赋值 (月份, 取月份 (公历日期))
赋值 (日, 取日 (公历日期))
赋值 (小时, 取小时 (公历日期))
赋值 (分钟, 取分钟 (公历日期))

取柱序号 (年份, 月份, 日, 小时, 分钟, aryZhu [1], aryZhu [2], aryZhu [3], aryZhu [4])
赋值 (aryDateTime [1], 年份)
赋值 (aryDateTime [2], 月份)
赋值 (aryDateTime [3], 日)
赋值 (aryDateTime [4], 小时)
赋值 (aryDateTime [5], 分钟)

公历转农历 (年份, 月份, 日, 小时, aryDateTimeYinli [1], aryDateTimeYinli [2], aryDateTimeYinli [3], IsLeapMoon)

.如果 (性别)
    赋值 (sdata_sex, 1)
.否则
    赋值 (sdata_sex, 0)
.如果结束
赋值 (sdata_level, 命盘详细度)
 ' 0:精简盘，仅包含十四主星与十二辅星(辅弼昌曲火铃，魁钺禄马羊陀)与四化共30颗星
 ' 1:简盘，增桃花系诸星(鸾喜刑姚咸)共35颗星
 ' 每一格的分格资料,1～12分别为子,丑....亥宫(注:为免混淆,0不使用)
 ' 16分别如下:
 ' 0:天干(例如1=甲)
 ' 1:宫名(例如"命  宫")
 ' 2:大运(例如"15～24")
 ' 3～13:星位(每一宫可放十一颗,例"紫微科庙")
 ' 14:长生十二运(例"长生")
 ' 15:博士十二神将
 ' 16:太岁十二神将
 ' 每一格的分格资料,1～12分别为子,丑....亥宫(注:为免混淆,0不使用)
 ' 16分别如下:
 ' 0:天干(例如1=甲)
 ' 1:宫名(例如"命  宫")
 ' 2:大运(例如"15～24")
 ' 3～13:星位(每一宫可放十一颗,例"紫微科庙")
 ' 14:长生十二运(例"长生")
 ' 15:博士十二神将
 ' 16:太岁十二神将
 ' 每一格的分格资料,1～12分别为子,丑....亥宫(注:为免混淆,0不使用)
 ' 16分别如下:
 ' 0:天干(例如1=甲)
 ' 1:宫名(例如"命  宫")
 ' 2:大运(例如"15～24")
 ' 3～13:星位(每一宫可放十一颗,例"紫微科庙")
 ' 14:长生十二运(例"长生")
 ' 15:博士十二神将
 ' 16:太岁十二神将
 ' 2:常用正盘，增加其他诸杂曜(详见下面表列)等共66颗星
 ' 3:完整正盘，增加太岁十二神将与博士十二神将共90颗星
赋值 (sdata_star_level, 星曜详细度)
 ' 0:全无
 ' 1:增加长生十二运与正傍空，命主身主
 ' 2:增加十四正曜庙陷
 ' 3:增加十二辅曜庙陷
赋值 (aryGan, { “甲”, “乙”, “丙”, “丁”, “戊”, “己”, “庚”, “辛”, “壬”, “癸” })
赋值 (aryZhi, { “子”, “丑”, “寅”, “卯”, “辰”, “巳”, “午”, “未”, “申”, “酉”, “戌”, “亥” })
赋值 (aryYue, { “正”, “二”, “三”, “四”, “五”, “六”, “七”, “八”, “九”, “十”, “冬”, “腊” })
赋值 (aryYinliDay, { “初一”, “初二”, “初三”, “初四”, “初五”, “初六”, “初七”, “初八”, “初九”, “初十”, “十一”, “十二”, “十三”, “十四”, “十五”, “十六”, “十七”, “十八”, “十九”, “二十”, “廿一”, “廿二”, “廿三”, “廿四”, “廿五”, “廿六”, “廿七”, “廿八”, “廿九”, “三十” })

赋值 (result_year_kan, 求余数 (相减 (aryDateTimeYinli [1], 3), 10))
赋值 (result_year_chi, 求余数 (相减 (aryDateTimeYinli [1], 3), 12))
.如果真 (等于 (result_year_kan, 0))
    赋值 (result_year_kan, 10)
    
.如果真结束
.如果真 (等于 (result_year_chi, 0))
    赋值 (result_year_chi, 12)
.如果真结束
赋值 (result_month, aryDateTimeYinli [2])
赋值 (result_day, aryDateTimeYinli [3])
赋值 (result_time_chi, 求余数 (aryZhu [4], 12))
.如果真 (等于 (result_time_chi, 0))
    赋值 (result_time_chi, 12)
.如果真结束

 ' 真正的命盘程式从此开始

 ' 初始化资料设定

 ' 每一格的分格资料,1～12分别为子,丑....亥宫(注:为免混淆,0不使用)
 ' 16分别如下:
 ' 0:天干(例如1=甲)
 ' 1:宫名(例如"命  宫")
 ' 2:大运(例如"15～24")
 ' 3～13:星位(每一宫可放十一颗,例"紫微科庙")
 ' 14:长生十二运(例"长生")
 ' 15:博士十二神将
 ' 16:太岁十二神将
 ' 将所有空格(除X,0外全部填入一个全形空白)
 ' 初始化资料设定

.计次循环首 (13, I)
    .计次循环首 (17, J)
        赋值 (square [I] [J], “  ”)
    .计次循环尾 ()
.计次循环尾 ()

 ' 初始化资料表
 ' 1.起十二宫天干(按年干定位)

赋值 (square_kan_table_16, { 0, 3, 4, 3, 4, 5, 6, 7, 8, 9, 10, 1, 2 }) ' 甲己年(前面多一零以填补位置0)
赋值 (square_kan_table_27, { 0, 5, 6, 5, 6, 7, 8, 9, 10, 1, 2, 3, 4 }) ' 乙庚年
赋值 (square_kan_table_38, { 0, 7, 8, 7, 8, 9, 10, 1, 2, 3, 4, 5, 6 }) ' 丙辛年
赋值 (square_kan_table_49, { 0, 9, 10, 9, 10, 1, 2, 3, 4, 5, 6, 7, 8 }) ' 丁壬年
赋值 (square_kan_table_50, { 0, 1, 2, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 }) ' 戊癸年

 ' 2.起命宫表(按生月与生时定位)
赋值 (square_life_house1, { 0, 3, 2, 1, 12, 11, 10, 9, 8, 7, 6, 5, 4 }) ' 正月表(前多一零以填补位置0}
赋值 (square_life_house2, { 0, 4, 3, 2, 1, 12, 11, 10, 9, 8, 7, 6, 5 }) ' 二月表
赋值 (square_life_house3, { 0, 5, 4, 3, 2, 1, 12, 11, 10, 9, 8, 7, 6 })
赋值 (square_life_house4, { 0, 6, 5, 4, 3, 2, 1, 12, 11, 10, 9, 8, 7 })
赋值 (square_life_house5, { 0, 7, 6, 5, 4, 3, 2, 1, 12, 11, 10, 9, 8 })
赋值 (square_life_house6, { 0, 8, 7, 6, 5, 4, 3, 2, 1, 12, 11, 10, 9 })
赋值 (square_life_house7, { 0, 9, 8, 7, 6, 5, 4, 3, 2, 1, 12, 11, 10 })
赋值 (square_life_house8, { 0, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 12, 11 })
赋值 (square_life_house9, { 0, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 12 })
赋值 (square_life_house10, { 0, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1 })
赋值 (square_life_house11, { 0, 1, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2 })
赋值 (square_life_house12, { 0, 2, 1, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3 })

 ' 3.宫位名称表
赋值 (square_name_table, { “命  宫”, “父母宫”, “福德宫”, “田宅宫”, “事业宫”, “奴仆宫”, “迁移宫”, “疾厄宫”, “财帛宫”, “子女宫”, “夫妻宫”, “兄弟宫” })

 ' 4.起身宫表(按生月与生时定位)

赋值 (square_body_house1, { 0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2 }) ' 正月表
赋值 (square_body_house2, { 0, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3 }) ' 二月表
赋值 (square_body_house3, { 0, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4 })
赋值 (square_body_house4, { 0, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5 })
赋值 (square_body_house5, { 0, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5, 6 })
赋值 (square_body_house6, { 0, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5, 6, 7 })
赋值 (square_body_house7, { 0, 9, 10, 11, 12, 1, 2, 3, 4, 5, 6, 7, 8 })
赋值 (square_body_house8, { 0, 10, 11, 12, 1, 2, 3, 4, 5, 6, 7, 8, 9 })
赋值 (square_body_house9, { 0, 11, 12, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 })
赋值 (square_body_house10, { 0, 12, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11 })
赋值 (square_body_house11, { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12 })
赋值 (square_body_house12, { 0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1 }) ' 十二月表

 ' 5.定五行局之六十花甲纳音表
 ' 五行局名(例"金四局(海中金)")

赋值 (fivestar1, { “不使用”, “金四局(海中金)”, “水二局(大溪水)”, “火六局(覆灯火)”, “金四局(沙中金)”, “水二局(泉中水)”, “火六局(山头火)” }) ' 甲行(甲子乙丑=海中金)
赋值 (fivestar3, { “不使用”, “水二局(涧下水)”, “火六局(炉中火)”, “土五局(沙中土)”, “水二局(天河水)”, “火六局(山下火)”, “土五局(屋上土)” }) ' 丙行
赋值 (fivestar5, { “不使用”, “火六局(霹雳火)”, “土五局(城头土)”, “木三局(大林木)”, “火六局(天上火)”, “土五局(大驿土)”, “木三局(平地木)” }) ' 戊行
赋值 (fivestar7, { “不使用”, “土五局(壁上土)”, “木三局(松柏木)”, “金四局(白蜡金)”, “土五局(路傍土)”, “木三局(石榴木)”, “金四局(钗钏金)” }) ' 庚行
赋值 (fivestar9, { “不使用”, “木三局(桑柘木)”, “金四局(金箔金)”, “水二局(长流水)”, “木三局(杨柳木)”, “金四局(剑锋金)”, “水二局(大海水)” }) ' 壬行

 ' 6.起大限与命主身主(不须要资料表)

 ' 命主表与身主表
赋值 (life_master1, { “不使用”, “贪狼星”, “巨门星”, “禄存星”, “文曲星”, “廉贞星”, “武曲星”, “破军星”, “武曲星”, “廉贞星”, “文曲星”, “禄存星”, “巨门星” })
赋值 (body_master1, { “不使用”, “铃  星”, “天相星”, “天梁星”, “天同星”, “文昌星”, “天机星”, “火  星”, “天相星”, “天梁星”, “天同星”, “文昌星”, “天机星” })

 ' 7.起始星盘表格
 ' 将初始位置资料填入表格(=0表示未排列)
.计次循环首 (64, I)
    赋值 (StarTable [I] [2], “0”)
.计次循环尾 ()
 ' 填入星名[四化星依附於他星之上][故星表中无)[太岁与博士十二神将有专属位置][也不列入星表)
 ' 北斗星系
赋值 (StarTable [1] [1], “紫微”)
赋值 (StarTable [2] [1], “天机”)
赋值 (StarTable [3] [1], “太阳”)
赋值 (StarTable [4] [1], “武曲”)
赋值 (StarTable [5] [1], “天同”)
赋值 (StarTable [6] [1], “廉贞”)
 ' 南斗星系
赋值 (StarTable [7] [1], “天府”)
赋值 (StarTable [8] [1], “太阴”)
赋值 (StarTable [9] [1], “贪狼”)
赋值 (StarTable [10] [1], “巨门”)
赋值 (StarTable [11] [1], “天相”)
赋值 (StarTable [12] [1], “天梁”)
赋值 (StarTable [13] [1], “七杀”)
赋值 (StarTable [14] [1], “破军”)
 ' 十二辅星之一
赋值 (StarTable [15] [1], “左辅”)
赋值 (StarTable [16] [1], “右弼”)
赋值 (StarTable [17] [1], “文昌”)
赋值 (StarTable [18] [1], “文曲”)
赋值 (StarTable [19] [1], “火星”)
赋值 (StarTable [20] [1], “铃星”)
 ' 十二辅星之二
赋值 (StarTable [21] [1], “天魁”)
赋值 (StarTable [22] [1], “天钺”)
赋值 (StarTable [23] [1], “天马”)
赋值 (StarTable [24] [1], “禄存”)
赋值 (StarTable [25] [1], “擎羊”)
赋值 (StarTable [26] [1], “陀罗”)
 ' 加上四化星][以上为level=0时所用星表
 ' 加上桃花诸星
赋值 (StarTable [27] [1], “红鸾”)
赋值 (StarTable [28] [1], “天喜”)
赋值 (StarTable [29] [1], “天刑”)
赋值 (StarTable [30] [1], “天姚”)
赋值 (StarTable [31] [1], “咸池”)
 ' 以上为level=1时所用星表
 ' 其他诸星
赋值 (StarTable [32] [1], “天官”)
赋值 (StarTable [33] [1], “天福”)
赋值 (StarTable [34] [1], “龙池”)
赋值 (StarTable [35] [1], “凤阁”)
赋值 (StarTable [36] [1], “天德”)
赋值 (StarTable [37] [1], “解神”)
赋值 (StarTable [38] [1], “天哭”)
赋值 (StarTable [39] [1], “天虚”)
赋值 (StarTable [40] [1], “孤辰”)
赋值 (StarTable [41] [1], “寡宿”)
赋值 (StarTable [42] [1], “华盖”)
赋值 (StarTable [43] [1], “劫杀”)
赋值 (StarTable [44] [1], “月德”)
赋值 (StarTable [45] [1], “蜚廉”)
赋值 (StarTable [46] [1], “大耗”)
赋值 (StarTable [47] [1], “破碎”)
赋值 (StarTable [48] [1], “天巫”)
赋值 (StarTable [49] [1], “天月”)
赋值 (StarTable [50] [1], “阴杀”)
赋值 (StarTable [51] [1], “地空”)
赋值 (StarTable [52] [1], “地劫”)
赋值 (StarTable [53] [1], “台辅”)
赋值 (StarTable [54] [1], “封诰”)
赋值 (StarTable [55] [1], “三台”)
赋值 (StarTable [56] [1], “八座”)
赋值 (StarTable [57] [1], “恩光”)
赋值 (StarTable [58] [1], “天贵”)
赋值 (StarTable [59] [1], “天伤”)
赋值 (StarTable [60] [1], “天使”)
赋值 (StarTable [61] [1], “天才”)
赋值 (StarTable [62] [1], “天寿”)
赋值 (StarTable [63] [1], “天空”)
 ' 以上为level=2时所用诸星
 ' level=3时另外排列

 ' 8.起紫微表(以五行局为主加生日查询}

赋值 (TzeWay2, { 0, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 1, 1, 2, 2, 3, 3, 4, 4, 5 }) ' 水二局,初一至三十,第一个不使用
赋值 (TzeWay3, { 0, 5, 2, 3, 6, 3, 4, 7, 4, 5, 8, 5, 6, 9, 6, 7, 10, 7, 8, 11, 8, 9, 12, 9, 10, 1, 10, 11, 2, 11, 12 }) ' 木三局
赋值 (TzeWay4, { 0, 12, 5, 2, 3, 1, 6, 3, 4, 2, 7, 4, 5, 3, 8, 5, 6, 4, 9, 6, 7, 5, 9, 7, 8, 6, 11, 8, 9, 7, 12 }) ' 金四局
赋值 (TzeWay5, { 0, 7, 12, 5, 2, 3, 8, 1, 6, 3, 4, 9, 2, 7, 4, 5, 9, 3, 8, 5, 6, 11, 4, 9, 6, 7, 12, 5, 9, 7, 8 }) ' 土五局
赋值 (TzeWay6, { 0, 10, 7, 12, 5, 2, 3, 11, 8, 1, 6, 3, 4, 12, 9, 2, 7, 4, 5, 1, 9, 3, 8, 5, 6, 2, 11, 4, 9, 6, 7 }) ' 火六局

 ' 9.起北斗星系表(以紫微所在位置)

赋值 (NorthStar1, { 12, 10, 9, 8, 5 }) ' 紫微在子
赋值 (NorthStar2, { 1, 11, 10, 9, 6 }) ' 紫微在丑
赋值 (NorthStar3, { 2, 12, 11, 10, 7 }) ' 紫微在寅
赋值 (NorthStar4, { 3, 1, 12, 11, 8 })
赋值 (NorthStar5, { 4, 2, 1, 12, 9 })
赋值 (NorthStar6, { 5, 3, 2, 1, 10 })
赋值 (NorthStar7, { 6, 4, 3, 2, 11 })
赋值 (NorthStar8, { 7, 5, 4, 3, 12 })
赋值 (NorthStar9, { 8, 6, 5, 4, 1 })
赋值 (NorthStar10, { 9, 7, 6, 5, 2 })
赋值 (NorthStar11, { 10, 8, 7, 6, 3 }) ' 紫微在辛
赋值 (NorthStar12, { 11, 9, 8, 7, 4 }) ' 紫微在亥

 ' 10.起天府表(以紫微所在位置)

赋值 (TienFu, { 0, 5, 4, 3, 2, 1, 12, 11, 10, 9, 8, 7, 6 }) ' 紫微地支所在位置(0不使用)

 ' 11.起南斗星系表(以天府所在位置}

赋值 (SouthStar1, { 2, 3, 4, 5, 6, 7, 11 })
赋值 (SouthStar2, { 3, 4, 5, 6, 7, 8, 12 })
赋值 (SouthStar3, { 4, 5, 6, 7, 8, 9, 1 })
赋值 (SouthStar4, { 5, 6, 7, 8, 9, 10, 2 })
赋值 (SouthStar5, { 6, 7, 8, 9, 10, 11, 3 })
赋值 (SouthStar6, { 7, 8, 9, 10, 11, 12, 4 })
赋值 (SouthStar7, { 8, 9, 10, 11, 12, 1, 5 })
赋值 (SouthStar8, { 9, 10, 11, 12, 1, 2, 6 })
赋值 (SouthStar9, { 10, 11, 12, 1, 2, 3, 7 })
赋值 (SouthStar10, { 11, 12, 1, 2, 3, 4, 8 })
赋值 (SouthStar11, { 12, 1, 2, 3, 4, 5, 9 })
赋值 (SouthStar12, { 1, 2, 3, 4, 5, 6, 10 })

 ' 12.起辅弼昌曲

赋值 (ZuoFu, { 0, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4 }) ' 左辅按生月,0不使用
赋值 (YuoBi, { 0, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 12 }) ' 右弼也是如此
赋值 (WenChang, { 0, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 12 }) ' 文昌按生时,0不使用
赋值 (WenChu, { 0, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4 }) ' 文曲也同文昌

 ' 13.起火铃
 ' 火星

赋值 (FireStar1, { 0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1 }) ' 寅午戌年，再按生时，0不使用
赋值 (FireStar2, { 0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2 }) ' 申子辰年
赋值 (FireStar3, { 0, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3 }) ' 巳酉丑年
赋值 (FireStar4, { 0, 10, 11, 12, 1, 2, 3, 4, 5, 6, 7, 8, 9 }) ' 亥卯未年
 ' 铃星
赋值 (RingStar1, { 0, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3 }) ' 寅午戌年
赋值 (RingStar2, { 0, 11, 12, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 }) ' 其他所有年

 ' 14.起魁钺马禄擎陀

赋值 (TienKue, { 0, 2, 1, 12, 12, 2, 1, 2, 7, 4, 4 }) ' 天魁按年干排,0不使用
赋值 (TienWu, { 0, 8, 9, 10, 10, 8, 9, 8, 3, 6, 6 }) ' 天钺和天魁排法同
 ' TienMa={0,3,12,9,6,3,12,9,6,3,12,9,6}       '天马按年支排,0不使用
赋值 (TienMa, { 0, 9, 6, 3, 12, 9, 6, 3, 12, 9, 6, 3, 12 }) ' 改成按月排
赋值 (LuChuang, { 0, 3, 4, 6, 7, 6, 7, 9, 10, 12, 1 }) ' 禄存按年干排,0不使用,擎陀直接用禄存求得

 ' 15.起四化星
 ' 以年干排列，0不使用
 ' 禄权科忌

赋值 (HuaLu, { 0, 6, 2, 5, 8, 9, 4, 3, 10, 12, 14 }) ' 数字代表星表位置，如6=廉贞,2=天机....
赋值 (HuaChuang, { 0, 14, 12, 2, 5, 8, 9, 4, 3, 1, 10 })
赋值 (HuaKer, { 0, 4, 1, 17, 2, 16, 12, 8, 18, 15, 8 })
赋值 (HuaChi, { 0, 3, 8, 6, 10, 2, 18, 5, 17, 4, 9 })

 ' 16.正傍空(输出资料要用)
赋值 (MasterKong, 1)
赋值 (SubKong, 1)
 ' 後面诸星未必排列，为节省内存与加速程式，其表格在要使用时才初始化，置於程式片段中间

 ' 进入排盘程序
 ' 1.先按年干定十二宫位天干
.判断开始 (或者 (等于 (result_year_kan, 1), 等于 (result_year_kan, 6)))
    .计次循环首 (12, I)
        赋值 (square [相加 (I, 1)] [1], 到文本 (square_kan_table_16 [相加 (I, 1)]))
    .计次循环尾 ()
.判断 (或者 (等于 (result_year_kan, 2), 等于 (result_year_kan, 7)))
    .计次循环首 (12, I)
        赋值 (square [相加 (I, 1)] [1], 到文本 (square_kan_table_27 [相加 (I, 1)]))
    .计次循环尾 ()
    
.判断 (或者 (等于 (result_year_kan, 3), 等于 (result_year_kan, 8)))
    .计次循环首 (12, I)
        赋值 (square [相加 (I, 1)] [1], 到文本 (square_kan_table_38 [相加 (I, 1)]))
    .计次循环尾 ()
    
.判断 (或者 (等于 (result_year_kan, 4), 等于 (result_year_kan, 9)))
    .计次循环首 (12, I)
        赋值 (square [相加 (I, 1)] [1], 到文本 (square_kan_table_49 [相加 (I, 1)]))
    .计次循环尾 ()
    
.判断 (或者 (等于 (result_year_kan, 5), 等于 (result_year_kan, 10)))
    .计次循环首 (12, I)
        赋值 (square [相加 (I, 1)] [1], 到文本 (square_kan_table_50 [相加 (I, 1)]))
    .计次循环尾 ()
    
.默认
    
.判断结束


 ' 2.起命宫(按生月时间与时辰排列)
 ' 首先处理如果是闰月的情况(十五日以前算上一月,十五日以後算下一月)
 ' 增加了自定义分界的功能
赋值 (result_month2, result_month) ' 保留原值
.如果真 (大于 (result_month, 20))
    .如果 (等于 (data_fenjie, 1)) ' 月中分界
        .如果 (大于或等于 (result_day, 15))
            赋值 (result_month, 相加 (相减 (result_month, 20), 1))
        .否则
            赋值 (result_month, 相减 (result_month, 20))
        .如果结束
        
    .否则
        赋值 (result_month, 相加 (相减 (result_month, 20), 1)) ' 作下月计
    .如果结束
    
.如果真结束

赋值 (square_life_house, 多项选择 (result_month, square_life_house1 [相加 (result_time_chi, 1)], square_life_house2 [相加 (result_time_chi, 1)], square_life_house3 [相加 (result_time_chi, 1)], square_life_house4 [相加 (result_time_chi, 1)], square_life_house5 [相加 (result_time_chi, 1)], square_life_house6 [相加 (result_time_chi, 1)], square_life_house7 [相加 (result_time_chi, 1)], square_life_house8 [相加 (result_time_chi, 1)], square_life_house9 [相加 (result_time_chi, 1)], square_life_house10 [相加 (result_time_chi, 1)], square_life_house11 [相加 (result_time_chi, 1)], square_life_house12 [相加 (result_time_chi, 1)]))

 ' 3.命宫起完，将其他宫位资料填入
.计次循环首 (12, I)
     ' 寻得正确宫位
    赋值 (J, 求余数 (相减 (相加 (square_life_house, I), 1), 12))
    .如果真 (等于 (J, 0)) ' 调整地支
        赋值 (J, 12)
    .如果真结束
     ' 写入资料
    赋值 (square [相加 (J, 1)] [2], square_name_table [I])
.计次循环尾 ()

 ' 4.起身宫
赋值 (square_body_house, 多项选择 (result_month, square_body_house1 [相加 (result_time_chi, 1)], square_body_house2 [相加 (result_time_chi, 1)], square_body_house3 [相加 (result_time_chi, 1)], square_body_house4 [相加 (result_time_chi, 1)], square_body_house5 [相加 (result_time_chi, 1)], square_body_house6 [相加 (result_time_chi, 1)], square_body_house7 [相加 (result_time_chi, 1)], square_body_house8 [相加 (result_time_chi, 1)], square_body_house9 [相加 (result_time_chi, 1)], square_body_house10 [相加 (result_time_chi, 1)], square_body_house11 [相加 (result_time_chi, 1)], square_body_house12 [相加 (result_time_chi, 1)]))
赋值 (square [相加 (square_body_house, 1)] [2], 相加 (取文本左边 (square [相加 (square_body_house, 1)] [2], 2), “◆身”))
 ' 5.定五行局并写入花甲纳音
 ' 先取得命宫干支
赋值 (naning_kan, 到数值 (square [相加 (square_life_house, 1)] [1]))
赋值 (naning_chi, square_life_house)

.如果真 (等于 (求余数 (naning_kan, 2), 0))
    赋值 (naning_kan, 相减 (naning_kan, 1)) ' 天干如为偶数则调成奇数
.如果真结束
.如果真 (不等于 (求余数 (naning_chi, 2), 0))
    赋值 (naning_chi, 相加 (naning_chi, 1))
.如果真结束
赋值 (naning_chi, 相除 (naning_chi, 2))

赋值 (fivestar_name, 多项选择 (naning_kan, fivestar1 [相加 (naning_chi, 1)], “”, fivestar3 [相加 (naning_chi, 1)], “”, fivestar5 [相加 (naning_chi, 1)], “”, fivestar7 [相加 (naning_chi, 1)], “”, fivestar9 [相加 (naning_chi, 1)]))

 ' 定五行局数
.如果 (等于 (取文本左边 (fivestar_name, 2), “水”))
    赋值 (fivestar, 2)
.否则
    .如果 (等于 (取文本左边 (fivestar_name, 2), “木”))
        赋值 (fivestar, 3)
    .否则
        .如果 (等于 (取文本左边 (fivestar_name, 2), “金”))
            赋值 (fivestar, 4)
        .否则
            .如果 (等于 (取文本左边 (fivestar_name, 2), “土”))
                赋值 (fivestar, 5)
            .否则
                赋值 (fivestar, 6)
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束

 ' 6.起大限(阳男阴女顺行,阴男阳女逆行)与定命身主

.如果 (或者 (并且 (等于 (sdata_sex, 0), 不等于 (求余数 (result_year_kan, 2), 0)), 并且 (等于 (sdata_sex, 1), 等于 (求余数 (result_year_kan, 2), 0)))) ' 阳男阴女
     ' 阳男阴女
    赋值 (J, 0)
    赋值 (K, square_life_house)
    .计次循环首 (12, I)
        赋值 (square [相加 (K, 1)] [3], 相加 (到文本 (相加 (fivestar, J)), “-”, 到文本 (相加 (fivestar, J, 9))))
        赋值 (J, 相加 (J, 10))
        赋值 (K, 求余数 (相加 (K, 1), 12))
        .如果真 (等于 (K, 0))
            赋值 (K, 12)
        .如果真结束
        
    .计次循环尾 ()
    
.否则
     ' 阴男阳女
    赋值 (J, 0)
    赋值 (K, square_life_house)
    .计次循环首 (12, I)
        赋值 (square [相加 (K, 1)] [3], 相加 (到文本 (相加 (fivestar, J)), “-”, 到文本 (相加 (fivestar, J, 9))))
        赋值 (J, 相加 (J, 10))
        赋值 (K, 求余数 (相加 (K, 11), 12))
        .如果真 (等于 (K, 0))
            赋值 (K, 12)
        .如果真结束
        
    .计次循环尾 ()
    
.如果结束
.计次循环首 (12, I)
    赋值 (square [相加 (I, 1)] [3], 相加 (square [相加 (I, 1)] [3], “    ”))
    赋值 (square [相加 (I, 1)] [3], 取文本左边 (square [相加 (I, 1)] [3], 7)) ' 这里原为8
     ' square [I ＋ 1] [3] ＝ 子文本替换 (square [I ＋ 1] [3], “ ”, “ ”, , , 真)
.计次循环尾 ()
 ' 定命主与身主
赋值 (life_master, life_master1 [相加 (square_life_house, 1)])
赋值 (body_master, body_master1 [相加 (result_year_chi, 1)])
 ' 7.起始星盘表格
 ' 8.起紫微星
 ' 以五行局决定起紫微的排列
赋值 (StarTable [2] [2], 到文本 (多项选择 (fivestar, 0, TzeWay2 [相加 (result_day, 1)], TzeWay3 [相加 (result_day, 1)], TzeWay4 [相加 (result_day, 1)], TzeWay5 [相加 (result_day, 1)], TzeWay6 [相加 (result_day, 1)])))

 ' 9起北斗星系诸星
 ' 以紫微所在位置决定
赋值 (K, 到数值 (StarTable [2] [2]))
.判断开始 (等于 (K, 1))
    .变量循环首 (3, 7, 1, I)
        赋值 (StarTable [I] [2], 到文本 (NorthStar1 [相减 (I, 2)]))
    .变量循环尾 ()
.判断 (等于 (K, 2))
    .变量循环首 (3, 7, 1, I)
        赋值 (StarTable [I] [2], 到文本 (NorthStar2 [相减 (I, 2)]))
    .变量循环尾 ()
.判断 (等于 (K, 3))
    .变量循环首 (3, 7, 1, I)
        赋值 (StarTable [I] [2], 到文本 (NorthStar3 [相减 (I, 2)]))
    .变量循环尾 ()
.判断 (等于 (K, 4))
    .变量循环首 (3, 7, 1, I)
        赋值 (StarTable [I] [2], 到文本 (NorthStar4 [相减 (I, 2)]))
    .变量循环尾 ()
.判断 (等于 (K, 5))
    .变量循环首 (3, 7, 1, I)
        赋值 (StarTable [I] [2], 到文本 (NorthStar5 [相减 (I, 2)]))
    .变量循环尾 ()
.判断 (等于 (K, 6))
    .变量循环首 (3, 7, 1, I)
        赋值 (StarTable [I] [2], 到文本 (NorthStar6 [相减 (I, 2)]))
    .变量循环尾 ()
.判断 (等于 (K, 7))
    .变量循环首 (3, 7, 1, I)
        赋值 (StarTable [I] [2], 到文本 (NorthStar7 [相减 (I, 2)]))
    .变量循环尾 ()
.判断 (等于 (K, 8))
    .变量循环首 (3, 7, 1, I)
        赋值 (StarTable [I] [2], 到文本 (NorthStar8 [相减 (I, 2)]))
    .变量循环尾 ()
.判断 (等于 (K, 9))
    .变量循环首 (3, 7, 1, I)
        赋值 (StarTable [I] [2], 到文本 (NorthStar9 [相减 (I, 2)]))
    .变量循环尾 ()
.判断 (等于 (K, 10))
    .变量循环首 (3, 7, 1, I)
        赋值 (StarTable [I] [2], 到文本 (NorthStar10 [相减 (I, 2)]))
    .变量循环尾 ()
.判断 (等于 (K, 11))
    .变量循环首 (3, 7, 1, I)
        赋值 (StarTable [I] [2], 到文本 (NorthStar11 [相减 (I, 2)]))
    .变量循环尾 ()
.判断 (等于 (K, 12))
    .变量循环首 (3, 7, 1, I)
        赋值 (StarTable [I] [2], 到文本 (NorthStar12 [相减 (I, 2)]))
    .变量循环尾 ()
.默认
    
.判断结束

 ' 10.起天府星
赋值 (StarTable [8] [2], 到文本 (TienFu [相加 (到数值 (StarTable [2] [2]), 1)]))
 ' 11.起南斗星系诸星
 ' 以天府所在位置决定

赋值 (K, 到数值 (StarTable [8] [2]))

.判断开始 (等于 (K, 1))
    .变量循环首 (9, 15, 1, I)
        赋值 (StarTable [I] [2], 到文本 (SouthStar1 [相减 (I, 8)]))
    .变量循环尾 ()
.判断 (等于 (K, 2))
    .变量循环首 (9, 15, 1, I)
        赋值 (StarTable [I] [2], 到文本 (SouthStar2 [相减 (I, 8)]))
    .变量循环尾 ()
.判断 (等于 (K, 3))
    .变量循环首 (9, 15, 1, I)
        赋值 (StarTable [I] [2], 到文本 (SouthStar3 [相减 (I, 8)]))
    .变量循环尾 ()
.判断 (等于 (K, 4))
    .变量循环首 (9, 15, 1, I)
        赋值 (StarTable [I] [2], 到文本 (SouthStar4 [相减 (I, 8)]))
    .变量循环尾 ()
.判断 (等于 (K, 5))
    .变量循环首 (9, 15, 1, I)
        赋值 (StarTable [I] [2], 到文本 (SouthStar5 [相减 (I, 8)]))
    .变量循环尾 ()
.判断 (等于 (K, 6))
    .变量循环首 (9, 15, 1, I)
        赋值 (StarTable [I] [2], 到文本 (SouthStar6 [相减 (I, 8)]))
    .变量循环尾 ()
.判断 (等于 (K, 7))
    .变量循环首 (9, 15, 1, I)
        赋值 (StarTable [I] [2], 到文本 (SouthStar7 [相减 (I, 8)]))
    .变量循环尾 ()
.判断 (等于 (K, 8))
    .变量循环首 (9, 15, 1, I)
        赋值 (StarTable [I] [2], 到文本 (SouthStar8 [相减 (I, 8)]))
    .变量循环尾 ()
.判断 (等于 (K, 9))
    .变量循环首 (9, 15, 1, I)
        赋值 (StarTable [I] [2], 到文本 (SouthStar9 [相减 (I, 8)]))
    .变量循环尾 ()
.判断 (等于 (K, 10))
    .变量循环首 (9, 15, 1, I)
        赋值 (StarTable [I] [2], 到文本 (SouthStar10 [相减 (I, 8)]))
    .变量循环尾 ()
.判断 (等于 (K, 11))
    .变量循环首 (9, 15, 1, I)
        赋值 (StarTable [I] [2], 到文本 (SouthStar11 [相减 (I, 8)]))
    .变量循环尾 ()
.判断 (等于 (K, 12))
    .变量循环首 (9, 15, 1, I)
        赋值 (StarTable [I] [2], 到文本 (SouthStar12 [相减 (I, 8)]))
    .变量循环尾 ()
.默认
    
.判断结束

 ' 12.起辅弼昌曲
 ' 辅弼直接用生月产生
赋值 (StarTable [16] [2], 到文本 (ZuoFu [相加 (result_month, 1)]))
赋值 (StarTable [17] [2], 到文本 (YuoBi [相加 (result_month, 1)]))
 ' 昌曲用生时产生
赋值 (StarTable [18] [2], 到文本 (WenChang [相加 (result_time_chi, 1)]))
赋值 (StarTable [19] [2], 到文本 (WenChu [相加 (result_time_chi, 1)]))

 ' 13.起火铃
 ' 火星要分年份
赋值 (K, 求余数 (result_year_chi, 4))
.如果真 (等于 (K, 0))
    赋值 (K, 4)
.如果真结束
赋值 (StarTable [20] [2], 到文本 (多项选择 (K, FireStar2 [相加 (result_time_chi, 1)], FireStar3 [相加 (result_time_chi, 1)], FireStar1 [相加 (result_time_chi, 1)], FireStar4 [相加 (result_time_chi, 1)])))
 ' 起铃星也分年份
.如果 (等于 (K, 3))
    赋值 (StarTable [21] [2], 到文本 (RingStar1 [相加 (result_time_chi, 1)]))
.否则
    赋值 (StarTable [21] [2], 到文本 (RingStar2 [相加 (result_time_chi, 1)]))
.如果结束

 ' 14.起魁钺马禄擎陀
赋值 (StarTable [22] [2], 到文本 (TienKue [相加 (result_year_kan, 1)]))
赋值 (StarTable [23] [2], 到文本 (TienWu [相加 (result_year_kan, 1)]))
赋值 (StarTable [24] [2], 到文本 (TienMa [相加 (result_month, 1)])) ' 天马改成按月支排
赋值 (StarTable [25] [2], 到文本 (LuChuang [相加 (result_year_kan, 1)]))
赋值 (StarTable [26] [2], 到文本 (求余数 (相加 (到数值 (StarTable [25] [2]), 1), 12)))
赋值 (StarTable [27] [2], 到文本 (求余数 (相加 (到数值 (StarTable [25] [2]), 11), 12)))
.如果真 (等于 (StarTable [26] [2], “0”))
    赋值 (StarTable [26] [2], “12”)
.如果真结束
.如果真 (等于 (StarTable [27] [2], “0”))
    赋值 (StarTable [27] [2], “12”)
.如果真结束

 ' 15.起四化星
赋值 (StarTable [HuaLu] [相加 (result_year_kan, 1)] [1], 相加 (StarTable [HuaLu] [相加 (result_year_kan, 1)] [1], “禄”))
赋值 (StarTable [HuaChuang] [相加 (result_year_kan, 1)] [1], 相加 (StarTable [HuaChuang] [相加 (result_year_kan, 1)] [1], “权”))
赋值 (StarTable [HuaKer] [相加 (result_year_kan, 1)] [1], 相加 (StarTable [HuaKer] [相加 (result_year_kan, 1)] [1], “科”))
赋值 (StarTable [HuaChi] [相加 (result_year_kan, 1)] [1], 相加 (StarTable [HuaChi] [相加 (result_year_kan, 1)] [1], “忌”))

 ' 16.检查点一，如果sdata_level=0则只使用此三十颗星，即到此结束，进入处理庙旺利陷与长生十二运之副程式然後输出，结束
.如果真 (等于 (sdata_level, 0))
    GetStarLevel ()
    FillStartoSquare ()
    返回 (ShowTable ())
.如果真结束

 ' 17.加排鸾喜刑姚咸五星

赋值 (HongLuang, { 0, 4, 3, 2, 1, 12, 11, 10, 9, 8, 7, 6, 5 }) ' 红鸾卯起子年，逆数至生年支,0不使用，天喜不必排，必在红鸾对宫
赋值 (TienHsing, { 0, 10, 11, 12, 1, 2, 3, 4, 5, 6, 7, 8, 9 }) ' 天刑酉起正月，顺数至生月，0不使用,天姚位置为天刑加四
赋值 (HsienChi, { 0, 10, 7, 4, 1, 10, 7, 4, 1, 10, 7, 4, 1 }) ' 咸池以生年地支起
 ' 定红鸾与天喜星
赋值 (StarTable [28] [2], 到文本 (HongLuang [相加 (result_year_chi, 1)]))
赋值 (StarTable [29] [2], 到文本 (求余数 (相加 (到数值 (StarTable [28] [2]), 6), 12)))
.如果真 (等于 (StarTable [29] [2], “0”))
    赋值 (StarTable [29] [2], “12”)
.如果真结束
 ' 定天刑天姚星
赋值 (StarTable [30] [2], 到文本 (TienHsing [相加 (result_month, 1)]))
赋值 (StarTable [31] [2], 到文本 (求余数 (相加 (到数值 (StarTable [30] [2]), 4), 12)))
.如果真 (等于 (StarTable [31] [2], “0”))
    赋值 (StarTable [31] [2], “12”)
.如果真结束
 ' 定咸池星
赋值 (StarTable [32] [2], 到文本 (HsienChi [相加 (result_year_chi, 1)]))
 ' 18.检查点二，如果sdata_lavel=1，则到此结束
.如果真 (等于 (sdata_level, 1))
    GetStarLevel ()
    FillStartoSquare ()
    返回 (ShowTable ())
.如果真结束

 ' 19.排列其他星
 ' a.天官天福星(以生年天干排之},0不使用

赋值 (TienKuan, { 0, 8, 5, 6, 3, 4, 10, 12, 10, 11, 7 })
赋值 (TienFu, { 0, 10, 9, 1, 12, 4, 3, 7, 6, 7, 6 })
赋值 (StarTable [33] [2], 到文本 (TienKuan [相加 (result_year_kan, 1)]))
赋值 (StarTable [34] [2], 到文本 (TienFu [相加 (result_year_kan, 1)]))
 ' b.龙池凤阁星(以生年地支排之},0不使用

赋值 (LongChi, { 0, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4 })
赋值 (FongKer, { 0, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 12 })
赋值 (StarTable [35] [2], 到文本 (LongChi [相加 (result_year_chi, 1)]))
赋值 (StarTable [36] [2], 到文本 (FongKer [相加 (result_year_chi, 1)]))
 ' c.天德解神星(以生年地支排之},0不使用

赋值 (TienTer, { 0, 10, 11, 12, 1, 2, 3, 4, 5, 6, 7, 8, 9 })
赋值 (SheiSheng, { 0, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 12 })
赋值 (StarTable [37] [2], 到文本 (TienTer [相加 (result_year_chi, 1)]))
赋值 (StarTable [38] [2], 到文本 (SheiSheng [相加 (result_year_chi, 1)]))
 ' d.天哭天虚星(以生年地支排之},0不使用

赋值 (TienKu, { 0, 7, 6, 5, 4, 3, 2, 1, 12, 11, 10, 9, 8 })
赋值 (TienShu, { 0, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5, 6 })
赋值 (StarTable [39] [2], 到文本 (TienKu [相加 (result_year_chi, 1)]))
赋值 (StarTable [40] [2], 到文本 (TienShu [相加 (result_year_chi, 1)]))
 ' e.孤辰寡宿星(以生年地支排之},0不使用

赋值 (GuChen, { 0, 3, 3, 6, 6, 6, 9, 9, 9, 12, 12, 12, 3 })
赋值 (GuaShuo, { 0, 11, 11, 2, 2, 2, 5, 5, 5, 8, 8, 8, 11 })
赋值 (StarTable [41] [2], 到文本 (GuChen [相加 (result_year_chi, 1)]))
赋值 (StarTable [42] [2], 到文本 (GuaShuo [相加 (result_year_chi, 1)]))
 ' f.华盖劫杀星(以生年地支排之},0不使用

赋值 (HuaKai, { 0, 5, 2, 11, 8, 5, 2, 11, 8, 5, 2, 11, 8 })
赋值 (JieSa, { 0, 6, 3, 12, 9, 6, 3, 12, 9, 6, 3, 12, 9 })
赋值 (StarTable [43] [2], 到文本 (HuaKai [相加 (result_year_chi, 1)]))
赋值 (StarTable [44] [2], 到文本 (JieSa [相加 (result_year_chi, 1)]))
 ' g.月德蜚廉星(以生年地支排之},0不使用

赋值 (YueTer, { 0, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5 })
赋值 (FeLieng, { 0, 9, 10, 11, 6, 7, 8, 3, 4, 5, 12, 1, 2 })
赋值 (StarTable [45] [2], 到文本 (YueTer [相加 (result_year_chi, 1)]))
赋值 (StarTable [46] [2], 到文本 (FeLieng [相加 (result_year_chi, 1)]))
 ' h.大耗破碎星(以生年地支排之},0不使用

赋值 (DaHow, { 0, 8, 7, 10, 9, 12, 11, 2, 1, 4, 3, 6, 5 })
赋值 (ProShue, { 0, 6, 2, 10, 6, 2, 10, 6, 2, 10, 6, 2, 10 })
赋值 (StarTable [47] [2], 到文本 (DaHow [相加 (result_year_chi, 1)]))
赋值 (StarTable [48] [2], 到文本 (ProShue [相加 (result_year_chi, 1)]))
 ' i.天巫天月星(以生年月份排之},0不使用

赋值 (TienWu, { 0, 6, 9, 3, 12, 6, 9, 3, 12, 6, 9, 3, 12 })
赋值 (TienYuo, { 0, 11, 6, 5, 3, 8, 4, 12, 8, 3, 7, 11, 3 })
赋值 (StarTable [49] [2], 到文本 (TienWu [相加 (result_month, 1)]))
赋值 (StarTable [50] [2], 到文本 (TienYuo [相加 (result_month, 1)]))
 ' j.阴杀星(以生年月份排之},0不使用

赋值 (YingSa, { 0, 3, 1, 11, 9, 7, 5, 3, 1, 11, 9, 7, 5 })
赋值 (StarTable [51] [2], 到文本 (YingSa [相加 (result_month, 1)]))
 ' k.地空地劫星(以生时地支排之},0不使用

赋值 (DiKong, { 0, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1 })
赋值 (DiJie, { 0, 12, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11 })
赋值 (StarTable [52] [2], 到文本 (DiKong [相加 (result_time_chi, 1)]))
赋值 (StarTable [53] [2], 到文本 (DiJie [相加 (result_time_chi, 1)]))
 ' l.台辅封诰星(以生时地支排之},0不使用

赋值 (TaiFu, { 0, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5, 6 })
赋值 (FongGao, { 0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2 })
赋值 (StarTable [54] [2], 到文本 (TaiFu [相加 (result_time_chi, 1)]))
赋值 (StarTable [55] [2], 到文本 (FongGao [相加 (result_time_chi, 1)]))

 ' m.三台八座星，三台以左辅宫起顺行至生日，八座以右弼起逆行至生日
 ' 三台星，取得左辅位置
赋值 (J, 到数值 (StarTable [16] [2]))
赋值 (J, 求余数 (相减 (相加 (J, result_day), 1), 12))
.如果真 (等于 (J, 0))
    赋值 (J, 12)
.如果真结束
赋值 (StarTable [56] [2], 到文本 (J))
 ' 八座星，取得右弼位置
赋值 (J, 到数值 (StarTable [17] [2]))
赋值 (J, 求余数 (相加 (J, 相乘 (相减 (result_day, 1), 11)), 12))
.如果真 (等于 (J, 0))
    赋值 (J, 12)
.如果真结束
赋值 (StarTable [57] [2], 到文本 (J))
 ' n.恩光天贵星，恩光以文昌起顺行至生日再退一，天贵以文曲起顺行至生日再退一
 ' 恩光星，取得文昌位置
赋值 (J, 到数值 (StarTable [18] [2]))
赋值 (J, 求余数 (相加 (相减 (相加 (J, result_day), 1), 11), 12))
.如果真 (等于 (J, 0))
    赋值 (J, 12)
.如果真结束

赋值 (StarTable [58] [2], 到文本 (J))
 ' 天贵星，取得文曲位置
赋值 (J, 到数值 (StarTable [19] [2]))
赋值 (J, 求余数 (相加 (相减 (相加 (J, result_day), 1), 11), 12))
.如果真 (等于 (J, 0))
    赋值 (J, 12)
.如果真结束

赋值 (StarTable [59] [2], 到文本 (J))
 ' o.天伤天使星
 ' 阳男阴女天伤在命宫前六，天使在命宫後六
 ' 先取得命宫位置
赋值 (J, square_life_house)
赋值 (K, J)
.如果 (或者 (并且 (不等于 (求余数 (result_year_kan, 2), 0), 等于 (sdata_sex, 0)), 并且 (等于 (求余数 (result_year_kan, 2), 0), 等于 (sdata_sex, 1))))
     ' 阳男阴女
    赋值 (J, 求余数 (相加 (J, 5), 12))
    .如果真 (等于 (J, 0))
        赋值 (J, 12)
    .如果真结束
    赋值 (StarTable [60] [2], 到文本 (J))
    赋值 (K, 求余数 (相加 (K, 7), 12))
    .如果真 (等于 (K, 0))
        赋值 (K, 12)
    .如果真结束
    赋值 (StarTable [61] [2], 到文本 (K))
    
.否则
     ' 阴男阳女
    赋值 (J, 求余数 (相加 (J, 7), 12))
    .如果真 (等于 (J, 0))
        赋值 (J, 12)
    .如果真结束
    赋值 (StarTable [60] [2], 到文本 (J))
    赋值 (K, 求余数 (相加 (K, 5), 12))
    .如果真 (等于 (K, 0))
        赋值 (K, 12)
    .如果真结束
    赋值 (StarTable [61] [2], 到文本 (K))
    
.如果结束

 ' p.天才天寿星
 ' 天才星命宫起子顺数至生年宫
赋值 (J, square_life_house)
赋值 (J, 求余数 (相减 (相加 (J, result_year_chi), 1), 12))
.如果真 (等于 (J, 0))
    赋值 (J, 12)
.如果真结束
赋值 (StarTable [62] [2], 到文本 (J))
 ' 天寿星身宫起子顺数至生年宫
赋值 (J, square_body_house)
赋值 (J, 求余数 (相减 (相加 (J, result_year_chi), 1), 12))
.如果真 (等于 (J, 0))
    赋值 (J, 12)
.如果真结束
赋值 (StarTable [63] [2], 到文本 (J))
 ' 20.检查点三，如果sdata_level=2，则到此结束
.如果真 (等于 (sdata_level, 2))
    GetStarLevel ()
    FillStartoSquare ()
    返回 (ShowTable ())
.如果真结束

 ' 21.都不是，将星排完
 ' 太岁十二神将以生年地支起
 ' 起始太岁十二神将名称,0不使用

赋值 (TaiSue, { “太岁”, “晦气”, “丧门”, “贯索”, “官符”, “小耗”, “岁破”, “龙德”, “白虎”, “天德”, “吊客”, “病符” })
赋值 (J, result_year_chi)
.计次循环首 (12, I)
    赋值 (square [相加 (J, 1)] [17], TaiSue [I])
    赋值 (J, 求余数 (相加 (J, 1), 12))
    .如果真 (等于 (J, 0))
        赋值 (J, 12)
    .如果真结束
    
.计次循环尾 ()
 ' 博士十二神将分阳男阴女(顺行)与阴男阳女(逆行),从禄存星起
 ' 起始博士十二神将名称,0不使用

赋值 (BorShe, { “博士”, “力士”, “青龙”, “小耗”, “将军”, “奏书”, “飞廉”, “喜神”, “病符”, “大耗”, “伏兵”, “官符” })
 ' 取得禄存的位置
赋值 (J, 到数值 (StarTable [25] [2]))
.如果 (或者 (并且 (不等于 (求余数 (result_year_kan, 2), 0), 等于 (sdata_sex, 0)), 并且 (等于 (求余数 (result_year_kan, 2), 0), 等于 (sdata_sex, 1))))
     ' 阳男阴女
    .计次循环首 (12, I)
        赋值 (square [相加 (J, 1)] [16], BorShe [I])
        赋值 (J, 求余数 (相加 (J, 1), 12))
        .如果真 (等于 (J, 0))
            赋值 (J, 12)
        .如果真结束
        
    .计次循环尾 ()
    
.否则
     ' 阴男阳女
    
    .计次循环首 (12, I)
        赋值 (square [相加 (J, 1)] [16], BorShe [I])
        赋值 (J, 求余数 (相加 (J, 11), 12))
        .如果真 (等于 (J, 0))
            赋值 (J, 12)
        .如果真结束
        
    .计次循环尾 ()
    
.如果结束

 ' 22.命盘排列完成，进入转换与输出程序
GetStarLevel ()
FillStartoSquare ()
返回 (ShowTable ())


.子程序 GetStarLevel, 空白型, , 此副程式用於取得庙旺利陷等资料并排列正傍空与长生十二运等
.局部变量 ChangShen, 文本型, , "0", 
.局部变量 GBTable26, 文本型, , "0", 
.局部变量 GBTable25, 文本型, , "0", 
.局部变量 GBTable24, 文本型, , "0", 
.局部变量 GBTable23, 文本型, , "0", 
.局部变量 GBTable22, 文本型, , "0", 
.局部变量 GBTable21, 文本型, , "0", 
.局部变量 GBTable20, 文本型, , "0", 
.局部变量 GBTable19, 文本型, , "0", 
.局部变量 GBTable18, 文本型, , "0", 
.局部变量 GBTable17, 文本型, , "0", 
.局部变量 GBTable16, 文本型, , "0", 
.局部变量 GBTable15, 文本型, , "0", 
.局部变量 GBTable14, 文本型, , "0", 
.局部变量 GBTable13, 文本型, , "0", 
.局部变量 GBTable12, 文本型, , "0", 
.局部变量 GBTable11, 文本型, , "0", 
.局部变量 GBTable10, 文本型, , "0", 
.局部变量 GBTable9, 文本型, , "0", 
.局部变量 GBTable8, 文本型, , "0", 
.局部变量 GBTable7, 文本型, , "0", 
.局部变量 GBTable6, 文本型, , "0", 
.局部变量 GBTable5, 文本型, , "0", 
.局部变量 GBTable4, 文本型, , "0", 
.局部变量 GBTable3, 文本型, , "0", 
.局部变量 GBTable2, 文本型, , "0", 
.局部变量 GBTable1, 文本型, , "0", 

 ' 如果星等=0，完全不理会直接结束

 ' 如果星等=1，则排列正空傍空与长生十二运

.如果真 (大于或等于 (sdata_star_level, 1))
     ' 起正傍空，以生年天干为主
    
    .判断开始 (或者 (等于 (result_year_kan, 1), 等于 (result_year_kan, 6)))
        赋值 (MasterKong, 9)
        赋值 (SubKong, 10)
    .判断 (或者 (等于 (result_year_kan, 2), 等于 (result_year_kan, 7)))
        赋值 (MasterKong, 7)
        赋值 (SubKong, 8)
    .判断 (或者 (等于 (result_year_kan, 3), 等于 (result_year_kan, 8)))
        赋值 (MasterKong, 5)
        赋值 (SubKong, 6)
    .判断 (或者 (等于 (result_year_kan, 4), 等于 (result_year_kan, 9)))
        赋值 (MasterKong, 3)
        赋值 (SubKong, 4)
    .判断 (或者 (等于 (result_year_kan, 5), 等于 (result_year_kan, 10)))
        赋值 (MasterKong, 1)
        赋值 (SubKong, 2)
    .默认
        
    .判断结束
    
     ' 论年阴阳以决定正傍是否交换，上起为阳，若为阴年交换
    .如果真 (等于 (求余数 (result_year_kan, 2), 0))
        赋值 (J, MasterKong)
        赋值 (MasterKong, SubKong)
        赋值 (SubKong, J)
    .如果真结束
    
     ' 起长生十二运，按五行局起初始值
     ' 起始长生十二运名称排列，0不使用
    赋值 (ChangShen, { “不使用”, “长生”, “沐浴”, “冠带”, “临官”, “帝旺”, “  衰”, “  病”, “  死”, “  墓”, “  绝”, “  胎”, “  养” })
    赋值 (J, 多项选择 (fivestar, 0, 9, 12, 6, 9, 3))
     ' 将资料填入
    .计次循环首 (12, I)
        赋值 (square [相加 (J, 1)] [15], ChangShen [相加 (I, 1)])
        赋值 (J, 求余数 (相加 (J, 1), 12))
        .如果真 (等于 (J, 0))
            赋值 (J, 12)
        .如果真结束
        
    .计次循环尾 ()
    
.如果真结束
 ' 如果星等=2，则加排十四主星星等
.如果真 (大于或等于 (sdata_star_level, 2)) ' 起始庙旺  平陷表,0一律不使用
    赋值 (GBTable1, { “不使用”, “平”, “庙”, “庙”, “旺”, “陷”, “旺”, “庙”, “庙”, “旺”, “平”, “  ”, “旺” }) ' 紫微
    赋值 (GBTable2, { “不使用”, “庙”, “陷”, “旺”, “旺”, “庙”, “平”, “庙”, “陷”, “平”, “旺”, “庙”, “平” }) ' 天机
    赋值 (GBTable3, { “不使用”, “陷”, “陷”, “旺”, “庙”, “旺”, “旺”, “庙”, “平”, “  ”, “  ”, “陷”, “陷” }) ' 太阳
    赋值 (GBTable4, { “不使用”, “旺”, “庙”, “  ”, “陷”, “庙”, “平”, “旺”, “庙”, “平”, “旺”, “庙”, “平” }) ' 武曲
    赋值 (GBTable5, { “不使用”, “旺”, “陷”, “  ”, “庙”, “平”, “庙”, “陷”, “陷”, “旺”, “平”, “平”, “庙” }) ' 天同
    赋值 (GBTable6, { “不使用”, “平”, “旺”, “庙”, “  ”, “旺”, “陷”, “平”, “庙”, “庙”, “平”, “旺”, “陷” }) ' 廉贞
    赋值 (GBTable7, { “不使用”, “庙”, “庙”, “庙”, “平”, “庙”, “平”, “旺”, “庙”, “平”, “陷”, “庙”, “旺” }) ' 天府
    赋值 (GBTable8, { “不使用”, “庙”, “庙”, “  ”, “陷”, “  ”, “陷”, “陷”, “平”, “平”, “旺”, “旺”, “庙” }) ' 太阴
    赋值 (GBTable9, { “不使用”, “旺”, “庙”, “平”, “旺”, “庙”, “陷”, “旺”, “庙”, “平”, “平”, “庙”, “陷” }) ' 贪狼
    赋值 (GBTable10, { “不使用”, “旺”, “旺”, “庙”, “庙”, “平”, “平”, “旺”, “陷”, “庙”, “庙”, “旺”, “旺” }) ' 巨门
    赋值 (GBTable11, { “不使用”, “庙”, “庙”, “庙”, “陷”, “旺”, “平”, “旺”, “  ”, “庙”, “陷”, “  ”, “平” }) ' 天相
    赋值 (GBTable12, { “不使用”, “庙”, “旺”, “庙”, “庙”, “旺”, “陷”, “庙”, “旺”, “陷”, “旺”, “旺”, “陷” }) ' 天梁
    赋值 (GBTable13, { “不使用”, “旺”, “庙”, “庙”, “陷”, “旺”, “平”, “旺”, “旺”, “庙”, “  ”, “庙”, “平” }) ' 七杀
    赋值 (GBTable14, { “不使用”, “庙”, “旺”, “陷”, “旺”, “旺”, “　”, “庙”, “庙”, “陷”, “陷”, “旺”, “平” })
     ' 将星等排入星位
    赋值 (StarTable [1] [1], 相加 (StarTable [1] [1], GBTable1 [相加 (到数值 (StarTable [2] [2]), 1)]))
    赋值 (StarTable [2] [1], 相加 (StarTable [2] [1], GBTable2 [相加 (到数值 (StarTable [3] [2]), 1)]))
    赋值 (StarTable [3] [1], 相加 (StarTable [3] [1], GBTable3 [相加 (到数值 (StarTable [4] [2]), 1)]))
    赋值 (StarTable [4] [1], 相加 (StarTable [4] [1], GBTable4 [相加 (到数值 (StarTable [5] [2]), 1)]))
    赋值 (StarTable [5] [1], 相加 (StarTable [5] [1], GBTable5 [相加 (到数值 (StarTable [6] [2]), 1)]))
    赋值 (StarTable [6] [1], 相加 (StarTable [6] [1], GBTable6 [相加 (到数值 (StarTable [7] [2]), 1)]))
    赋值 (StarTable [7] [1], 相加 (StarTable [7] [1], GBTable7 [相加 (到数值 (StarTable [8] [2]), 1)]))
    赋值 (StarTable [8] [1], 相加 (StarTable [8] [1], GBTable8 [相加 (到数值 (StarTable [9] [2]), 1)]))
    赋值 (StarTable [9] [1], 相加 (StarTable [9] [1], GBTable9 [相加 (到数值 (StarTable [10] [2]), 1)]))
    赋值 (StarTable [10] [1], 相加 (StarTable [10] [1], GBTable10 [相加 (到数值 (StarTable [11] [2]), 1)]))
    赋值 (StarTable [11] [1], 相加 (StarTable [11] [1], GBTable11 [相加 (到数值 (StarTable [12] [2]), 1)]))
    赋值 (StarTable [12] [1], 相加 (StarTable [12] [1], GBTable12 [相加 (到数值 (StarTable [13] [2]), 1)]))
    赋值 (StarTable [13] [1], 相加 (StarTable [13] [1], GBTable13 [相加 (到数值 (StarTable [14] [2]), 1)]))
    赋值 (StarTable [14] [1], 相加 (StarTable [14] [1], GBTable14 [相加 (到数值 (StarTable [15] [2]), 1)]))
    
    
.如果真结束
 ' 如果星等=3，则加排十二辅星星等
.如果真 (大于或等于 (sdata_star_level, 3))
     ' 起始庙旺  平陷表,0一律不使用
    赋值 (GBTable15, { “不使用”, “旺”, “庙”, “庙”, “陷”, “庙”, “平”, “旺”, “庙”, “平”, “陷”, “庙”, “  ” }) ' 左辅
    赋值 (GBTable16, { “不使用”, “庙”, “庙”, “旺”, “陷”, “庙”, “平”, “旺”, “庙”, “  ”, “陷”, “庙”, “平” }) ' 右弼
    赋值 (GBTable17, { “不使用”, “旺”, “庙”, “陷”, “平”, “旺”, “庙”, “陷”, “平”, “旺”, “庙”, “陷”, “旺” }) ' 文昌
    赋值 (GBTable18, { “不使用”, “庙”, “庙”, “平”, “旺”, “庙”, “庙”, “陷”, “旺”, “平”, “庙”, “陷”, “旺” }) ' 文曲
    赋值 (GBTable19, { “不使用”, “平”, “旺”, “庙”, “平”, “  ”, “旺”, “庙”, “  ”, “陷”, “陷”, “庙”, “平” }) ' 火星
    赋值 (GBTable20, { “不使用”, “陷”, “陷”, “庙”, “庙”, “旺”, “旺”, “庙”, “旺”, “旺”, “陷”, “庙”, “庙” }) ' 铃星
    赋值 (GBTable21, { “不使用”, “旺”, “旺”, “  ”, “庙”, “  ”, “  ”, “庙”, “  ”, “  ”, “  ”, “  ”, “旺” }) ' 天魁
    赋值 (GBTable22, { “不使用”, “  ”, “  ”, “旺”, “  ”, “  ”, “旺”, “  ”, “旺”, “庙”, “庙”, “  ”, “  ” }) ' 天钺
    赋值 (GBTable23, { “不使用”, “  ”, “  ”, “旺”, “  ”, “  ”, “平”, “  ”, “  ”, “旺”, “  ”, “  ”, “平” }) ' 天马
    赋值 (GBTable24, { “不使用”, “旺”, “  ”, “庙”, “旺”, “  ”, “庙”, “旺”, “  ”, “庙”, “旺”, “  ”, “庙” }) ' 禄存
    赋值 (GBTable25, { “不使用”, “陷”, “庙”, “  ”, “陷”, “庙”, “  ”, “平”, “庙”, “  ”, “陷”, “庙”, “  ” }) ' 擎羊
    赋值 (GBTable26, { “不使用”, “  ”, “庙”, “陷”, “  ”, “庙”, “陷”, “  ”, “庙”, “陷”, “  ”, “庙”, “陷” })
     ' 将星等填入星位
    赋值 (StarTable [15] [1], 相加 (StarTable [15] [1], GBTable15 [相加 (到数值 (StarTable [16] [2]), 1)]))
    赋值 (StarTable [16] [1], 相加 (StarTable [16] [1], GBTable16 [相加 (到数值 (StarTable [17] [2]), 1)]))
    赋值 (StarTable [17] [1], 相加 (StarTable [17] [1], GBTable17 [相加 (到数值 (StarTable [18] [2]), 1)]))
    赋值 (StarTable [18] [1], 相加 (StarTable [18] [1], GBTable18 [相加 (到数值 (StarTable [19] [2]), 1)]))
    赋值 (StarTable [19] [1], 相加 (StarTable [19] [1], GBTable19 [相加 (到数值 (StarTable [20] [2]), 1)]))
    赋值 (StarTable [20] [1], 相加 (StarTable [20] [1], GBTable20 [相加 (到数值 (StarTable [21] [2]), 1)]))
    赋值 (StarTable [21] [1], 相加 (StarTable [21] [1], GBTable21 [相加 (到数值 (StarTable [22] [2]), 1)]))
    赋值 (StarTable [22] [1], 相加 (StarTable [22] [1], GBTable22 [相加 (到数值 (StarTable [23] [2]), 1)]))
    赋值 (StarTable [23] [1], 相加 (StarTable [23] [1], GBTable23 [相加 (到数值 (StarTable [24] [2]), 1)]))
    赋值 (StarTable [24] [1], 相加 (StarTable [24] [1], GBTable24 [相加 (到数值 (StarTable [25] [2]), 1)]))
    赋值 (StarTable [25] [1], 相加 (StarTable [25] [1], GBTable25 [相加 (到数值 (StarTable [26] [2]), 1)]))
    赋值 (StarTable [26] [1], 相加 (StarTable [26] [1], GBTable26 [相加 (到数值 (StarTable [27] [2]), 1)]))
.如果真结束


.子程序 FillStartoSquare, 空白型, , 此副程式用於转换星别资料进入单一表格
.局部变量 StarTablePointer, 空白型, , "13", 
.局部变量 X, 空白型, , , 
.局部变量 Y, 空白型, , , 

 ' 先起始位置资料表，用以确定填入资料的位置
.计次循环首 (13, I)
    赋值 (StarTablePointer [I], 4)
.计次循环尾 ()
 ' StarTablePointer [1] ＝ 0
 ' 先填入前二十六颗星与四化共三十颗星
.计次循环首 (26, I)
    赋值 (square [相加 (到数值 (StarTable [相加 (I, 1)] [2]), 1)] [StarTablePointer] [相加 (到数值 (StarTable [相加 (I, 1)] [2]), 1)], StarTable [I] [1])
    赋值 (Y, StarTablePointer [相加 (到数值 (StarTable [相加 (I, 1)] [2]), 1)])
    赋值 (X, 相加 (到数值 (StarTable [相加 (I, 1)] [2]), 1))
    赋值 (StarTablePointer [相加 (到数值 (StarTable [相加 (I, 1)] [2]), 1)], 相加 (StarTablePointer [相加 (到数值 (StarTable [相加 (I, 1)] [2]), 1)], 1))
.计次循环尾 ()
 ' 如果星数sdata_level=1的话多加五颗星
.如果真 (大于或等于 (sdata_level, 1))
    .变量循环首 (27, 31, 1, I)
        赋值 (square [相加 (到数值 (StarTable [相加 (I, 1)] [2]), 1)] [StarTablePointer] [相加 (到数值 (StarTable [相加 (I, 1)] [2]), 1)], StarTable [I] [1])
        赋值 (StarTablePointer [相加 (到数值 (StarTable [相加 (I, 1)] [2]), 1)], 相加 (StarTablePointer [相加 (到数值 (StarTable [相加 (I, 1)] [2]), 1)], 1))
    .变量循环尾 ()
.如果真结束
 ' 如果星数sdata_level=2的话再加三十一颗星
.如果真 (大于或等于 (sdata_level, 2))
    .变量循环首 (32, 62, 1, I)
        赋值 (StarTablePointer [1], 1) ' 没排的资料都丢到这里去，直接当做消失掉
        赋值 (square [相加 (到数值 (StarTable [相加 (I, 1)] [2]), 1)] [StarTablePointer] [相加 (到数值 (StarTable [相加 (I, 1)] [2]), 1)], StarTable [I] [1])
        赋值 (StarTablePointer [相加 (到数值 (StarTable [相加 (I, 1)] [2]), 1)], 相加 (StarTablePointer [相加 (到数值 (StarTable [相加 (I, 1)] [2]), 1)], 1))
    .变量循环尾 ()
.如果真结束
 ' 如果星数sdata_level=3的话，太岁十二神将与博士十二神将不须转换


.子程序 ShowTable, 文本型, , '此副程式用於产生命盘并结束程式
.局部变量 排盘, 文本型, , , 

 ' 在星位的部份每一项最後加上四个全形空白以避免输出位置错误
.计次循环首 (12, I)
    .变量循环首 (3, 12, 1, J)
        赋值 (square [相加 (I, 1)] [相加 (J, 1)], 相加 (square [相加 (I, 1)] [相加 (J, 1)], “        ”))
    .变量循环尾 ()
.计次循环尾 ()
赋值 (排盘, 相加 (“┌──────────┬──────────┬──────────┬──────────┐”, #换行符))

赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本左边 (square [7] [相加 (J, 1)], 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本左边 (square [8] [相加 (J, 1)], 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本左边 (square [9] [相加 (J, 1)], 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本左边 (square [10] [相加 (J, 1)], 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”, #换行符))

赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [7] [相加 (J, 1)], 3, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [8] [相加 (J, 1)], 3, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [9] [相加 (J, 1)], 3, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [10] [相加 (J, 1)], 3, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”, #换行符))

赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [7] [相加 (J, 1)], 5, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [8] [相加 (J, 1)], 5, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [9] [相加 (J, 1)], 5, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [10] [相加 (J, 1)], 5, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”, #换行符))

赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [7] [相加 (J, 1)], 7, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [8] [相加 (J, 1)], 7, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [9] [相加 (J, 1)], 7, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [10] [相加 (J, 1)], 7, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”, #换行符))

赋值 (排盘, 相加 (排盘, “│　　　　　　　　　　│　　　　　　　　　　│　　　　　　　　　　│　　　　　　　　　　│”, #换行符))

赋值 (排盘, 相加 (排盘, “│”, 取文本左边 (square [7] [16], 2), 取文本左边 (square [7] [17], 2), “   ”, square [7] [2], “   ”, 取文本左边 (square [7] [15], 2), ShowKanWord (square [7] [1]), “│”, 取文本左边 (square [8] [16], 2), 取文本左边 (square [8] [17], 2), “   ”, square [8] [2], “   ”, 取文本左边 (square [8] [15], 2), ShowKanWord (square [8] [1]), “│”, 取文本左边 (square [9] [16], 2), 取文本左边 (square [9] [17], 2), “   ”, square [9] [2], “   ”, 取文本左边 (square [9] [15], 2), ShowKanWord (square [9] [1]), “│”, 取文本左边 (square [10] [16], 2), 取文本左边 (square [10] [17], 2), “   ”, square [10] [2], “   ”, 取文本左边 (square [10] [15], 2), ShowKanWord (square [10] [1]), “│”, #换行符))

赋值 (排盘, 相加 (排盘, “│”, 取文本右边 (square [7] [16], 2), 取文本右边 (square [7] [17], 2), “ 　”, square [7] [3], “　”, 取文本右边 (square [7] [15], 2), ShowChiWord (6), “│”, 取文本右边 (square [8] [16], 2), 取文本右边 (square [8] [17], 2), “ 　”, square [8] [3], “　”, 取文本右边 (square [8] [15], 2), ShowChiWord (7), “│”, 取文本右边 (square [9] [16], 2), 取文本右边 (square [9] [17], 2), “ 　”, square [9] [3], “　”, 取文本右边 (square [9] [15], 2), ShowChiWord (8), “│”, 取文本右边 (square [10] [16], 2), 取文本右边 (square [10] [17], 2), “ 　”, square [10] [3], “　”, 取文本右边 (square [10] [15], 2), ShowChiWord (9), “│”, #换行符))

赋值 (排盘, 相加 (排盘, “├──────────┼──────────┴──────────┼──────────┤”, #换行符))


赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本左边 (square [6] [相加 (J, 1)], 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│　　　　　　　　　　　　　　　　　　　　　│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本左边 (square [11] [相加 (J, 1)], 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”, #换行符))

赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [6] [相加 (J, 1)], 3, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│      ”, Show4Zhu (), “          │”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [11] [相加 (J, 1)], 3, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”, #换行符))

赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [6] [相加 (J, 1)], 5, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│　　　　　　　　　　   　　 　　　　　　　│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [11] [相加 (J, 1)], 5, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”, #换行符))

赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [6] [相加 (J, 1)], 7, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│　　　阳历　”))
赋值 (排盘, 相加 (排盘, 到文本 (aryDateTime [1]), “-”))
.如果真 (小于 (aryDateTime [2], 10))
    赋值 (排盘, 相加 (排盘, “0”))
.如果真结束
赋值 (排盘, 相加 (排盘, 到文本 (aryDateTime [2]), “-”))
.如果真 (小于 (aryDateTime [3], 10))
    赋值 (排盘, 相加 (排盘, “0”))
.如果真结束
赋值 (排盘, 相加 (排盘, 到文本 (aryDateTime [3]), “ ”))
.如果真 (小于 (aryDateTime [4], 10))
    赋值 (排盘, 相加 (排盘, “0”))
.如果真结束
赋值 (排盘, 相加 (排盘, 到文本 (aryDateTime [4]), “:”))
.如果真 (小于 (aryDateTime [5], 10))
    赋值 (排盘, 相加 (排盘, “0”))
.如果真结束
赋值 (排盘, 相加 (排盘, 到文本 (aryDateTime [5]), 取重复文本 (10, “ ”), “    │”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [11] [相加 (J, 1)], 7, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”, #换行符))

赋值 (排盘, 相加 (排盘, “│”, 取文本左边 (square [6] [16], 2), 取文本左边 (square [6] [17], 2), “   ”, square [6] [2], “   ”, 取文本左边 (square [6] [15], 2), ShowKanWord (square [6] [1]), “│                                          │”, 取文本左边 (square [11] [16], 2), 取文本左边 (square [11] [17], 2), “   ”, square [11] [2], “   ”, 取文本左边 (square [11] [15], 2), ShowKanWord (square [11] [1]), “│”, #换行符))

赋值 (排盘, 相加 (排盘, “│”, 取文本右边 (square [6] [16], 2), 取文本右边 (square [6] [17], 2), “ 　”, square [6] [3], “　”, 取文本右边 (square [6] [15], 2), ShowChiWord (5), “│　　　阴历　”, ShowKanWord (到文本 (result_year_kan)), ShowChiWord (result_year_chi), “年”))
.如果 (IsLeapMoon)
    赋值 (排盘, 相加 (排盘, “闰”, aryYue [result_month2], “月”, aryYinliDay [result_day], “日”))
.否则
    赋值 (排盘, 相加 (排盘, aryYue [result_month2], “月”, aryYinliDay [result_day], “日  ”))
.如果结束
赋值 (排盘, 相加 (排盘, “　　　　　　│”, 取文本右边 (square [11] [16], 2), 取文本右边 (square [11] [17], 2), “ 　”, square [11] [3], “　”, 取文本右边 (square [11] [15], 2), ShowChiWord (10), “│”, #换行符))

赋值 (排盘, 相加 (排盘, “├──────────┤　　　　　　　　　　　　　　　　　　　　　├──────────┤”, #换行符))


赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本左边 (square [5] [相加 (J, 1)], 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│　　　”, OutputSexWord (sdata_sex, result_year_kan), “　”, fivestar_name, “　　　　　　　　│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本左边 (square [12] [相加 (J, 1)], 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”, #换行符))

赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [5] [相加 (J, 1)], 3, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│                                          │”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [12] [相加 (J, 1)], 3, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”, #换行符))

赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [5] [相加 (J, 1)], 5, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│      命主  ”, life_master, “  身主  ”, body_master, “          │”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [12] [相加 (J, 1)], 5, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”, #换行符))

赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [5] [相加 (J, 1)], 7, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│                                          │”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [12] [相加 (J, 1)], 7, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”, #换行符))

赋值 (排盘, 相加 (排盘, “│　　　　　　　　　　│　　　正空在”, ShowChiWord (MasterKong), “　傍空在”, ShowChiWord (SubKong), “　　　　　　　　　│　　　　　　　　　　│”, #换行符))

赋值 (排盘, 相加 (排盘, “│”, 取文本左边 (square [5] [16], 2), 取文本左边 (square [5] [17], 2), “　 ”, square [5] [2], “ 　”, 取文本左边 (square [5] [15], 2), ShowKanWord (square [5] [1]), “│　　　　　　　　　　　　　　　　　　　　　│”, 取文本左边 (square [12] [16], 2), 取文本左边 (square [12] [17], 2), “ 　”, square [12] [2], “ 　”, 取文本左边 (square [12] [15], 2), ShowKanWord (square [12] [1]), “│”, #换行符))

赋值 (排盘, 相加 (排盘, “│”, 取文本右边 (square [5] [16], 2), 取文本右边 (square [5] [17], 2), “　 ”, square [5] [3], “　”, 取文本右边 (square [5] [15], 2), ShowChiWord (4), “│        云外归鸟 紫微斗数排盘系统         │”, 取文本右边 (square [12] [16], 2), 取文本右边 (square [12] [17], 2), “ 　”, square [12] [3], “  ”, 取文本右边 (square [12] [15], 2), ShowChiWord (11), “│”, #换行符))

赋值 (排盘, 相加 (排盘, “├──────────┼──────────┬──────────┼──────────┤”, #换行符))

赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本左边 (square [4] [相加 (J, 1)], 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本左边 (square [3] [相加 (J, 1)], 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本左边 (square [2] [相加 (J, 1)], 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本左边 (square [13] [相加 (J, 1)], 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”, #换行符))

赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [4] [相加 (J, 1)], 3, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [3] [相加 (J, 1)], 3, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [2] [相加 (J, 1)], 3, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [13] [相加 (J, 1)], 3, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”, #换行符))

赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [4] [相加 (J, 1)], 5, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [3] [相加 (J, 1)], 5, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [2] [相加 (J, 1)], 5, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [13] [相加 (J, 1)], 5, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”, #换行符))

赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [4] [相加 (J, 1)], 7, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [3] [相加 (J, 1)], 7, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [2] [相加 (J, 1)], 7, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [13] [相加 (J, 1)], 7, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”, #换行符))

赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [4] [相加 (J, 1)], 9, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [3] [相加 (J, 1)], 9, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [2] [相加 (J, 1)], 9, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”))
.变量循环首 (3, 12, 1, J)
    赋值 (排盘, 相加 (排盘, 取文本中间 (square [13] [相加 (J, 1)], 9, 2)))
.变量循环尾 ()
赋值 (排盘, 相加 (排盘, “│”, #换行符))

赋值 (排盘, 相加 (排盘, “│　　　　　　　　　　│　　　　　　　　　　│　　　　　　　　　　│　　　　　　　　　　│”, #换行符))

赋值 (排盘, 相加 (排盘, “│”, 取文本左边 (square [4] [16], 2), 取文本左边 (square [4] [17], 2), “ 　”, square [4] [2], “ 　”, 取文本左边 (square [4] [15], 2), ShowKanWord (square [4] [1]), “│”, 取文本左边 (square [3] [16], 2), 取文本左边 (square [3] [17], 2), “ 　”, square [3] [2], “ 　”, 取文本左边 (square [3] [15], 2), ShowKanWord (square [3] [1]), “│”, 取文本左边 (square [2] [16], 2), 取文本左边 (square [2] [17], 2), “ 　”, square [2] [2], “ 　”, 取文本左边 (square [2] [15], 2), ShowKanWord (square [2] [1]), “│”, 取文本左边 (square [13] [16], 1), 取文本左边 (square [13] [17], 1), “   　”, square [13] [2], “ 　”, 取文本左边 (square [13] [15], 2), ShowKanWord (square [13] [1]), “│”, #换行符))

赋值 (排盘, 相加 (排盘, “│”, 取文本右边 (square [4] [16], 2), 取文本右边 (square [4] [17], 2), “ 　”, square [4] [3], “　”, 取文本右边 (square [4] [15], 2), ShowChiWord (3), “│”, 取文本右边 (square [3] [16], 2), 取文本右边 (square [3] [17], 2), “ 　”, square [3] [3], “　”, 取文本右边 (square [3] [15], 2), ShowChiWord (2), “│”, 取文本右边 (square [2] [16], 2), 取文本右边 (square [2] [17], 2), “ 　”, square [2] [3], “　”, 取文本右边 (square [2] [15], 2), ShowChiWord (1), “│”, 取文本右边 (square [13] [16], 2), 取文本右边 (square [13] [17], 2), “ 　”, square [13] [3], “　”, 取文本右边 (square [13] [15], 2), ShowChiWord (12), “│”, #换行符))

赋值 (排盘, 相加 (排盘, “└──────────┴──────────┴──────────┴──────────┘”, #换行符))
返回 (排盘)


.子程序 OutputSexWord, 文本型, , 
.参数 Sex, 空白型, , 
.参数 Kan, 空白型, , 

.如果真 (等于 (Sex, 0))
    .如果 (不等于 (求余数 (Kan, 2), 0))
        返回 (“阳男”)
    .否则
        返回 (“阴男”)
    .如果结束
    
.如果真结束
.如果真 (不等于 (求余数 (Kan, 2), 0))
    返回 (“阳女”)
.如果真结束
返回 (“阴女”)




.子程序 JiaziName, 文本型, , 
.参数 T, 空白型, , 

.局部变量 G, 空白型, , , 
.局部变量 Z, 空白型, , , 

赋值 (G, 求余数 (T, 10))
赋值 (Z, 求余数 (T, 12))
.如果真 (等于 (G, 0))
    赋值 (G, 10)
.如果真结束
.如果真 (等于 (Z, 0))
    赋值 (Z, 12)
.如果真结束
返回 (相加 (aryGan [G], aryZhi [Z]))

.子程序 Show4Zhu, 文本型, , '显示四柱
.如果真 (等于 (aryZhu [1], 100))
    返回 (“                          ”)
.如果真结束
返回 (相加 (“四柱  ”, JiaziName (aryZhu [1]), “ ”, JiaziName (aryZhu [2]), “ ”, JiaziName (aryZhu [3]), “ ”, JiaziName (aryZhu [4]), “ ”))

.子程序 ShowKanWord, 文本型, , 
.参数 Kan, 文本型, , 

.局部变量 n, 空白型, , , 

赋值 (n, 到数值 (Kan))
.如果真 (并且 (小于 (n, 11), 大于 (n, 0)))
    返回 (aryGan [n])
.如果真结束
返回 (“”)


.子程序 ShowChiWord, 文本型, , 
.参数 Chi, 空白型, , 

.如果真 (并且 (小于 (Chi, 13), 大于 (Chi, 0)))
    返回 (aryZhi [Chi])
.如果真结束
返回 (“”)


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 公历转农历, 空白型, , 
.参数 公历年, 整数型, , 
.参数 公历月, 整数型, , 
.参数 公历日, 整数型, , 
.参数 公历时, 整数型, , 
.参数 转换后农历年, 整数型, 参考, 结果存放在参数变量里
.参数 转换后农历月, 整数型, 参考, 结果存放在参数变量里
.参数 转换后农历日, 整数型, 参考, 结果存放在参数变量里
.参数 转换后是否闰月, 逻辑型, 参考, 结果存放在参数变量里



.子程序 农历转公历, 逻辑型, , 
.参数 农历年, 整数型, , 农历年这个提法不科学，不过这里算做和公历年重合的那年
.参数 农历月, 整数型, , 
.参数 农历日, 整数型, , 
.参数 是否闰月, 逻辑型, , 
.参数 转换后公历年, 整数型, 参考, 结果存放在参数变量里
.参数 转换后公历月, 整数型, 参考, 结果存放在参数变量里
.参数 转换后公历日, 整数型, 参考, 结果存放在参数变量里



.子程序 取农历闰月, 整数型, , 没有闰月返回零
.参数 农历年, 整数型, , 



.子程序 取天干地支, 文本型, , 
.参数 天干序号, 整数型, , 
.参数 地支序号, 整数型, , 



.子程序 取六十甲子, 文本型, , 
.参数 六十花甲序号, 整数型, , 



.子程序 取柱, 空白型, , 
.参数 公历年, 整数型, , 
.参数 公历月, 整数型, , 
.参数 公历日, 整数型, , 
.参数 公历时, 整数型, , 
.参数 公历分, 整数型, , 
.参数 年柱, 文本型, 参考, 
.参数 月柱, 文本型, 参考, 
.参数 日柱, 文本型, 参考, 
.参数 时柱, 文本型, 参考, 



.子程序 取柱序号, 空白型, , 
.参数 公历年, 整数型, , 
.参数 公历月, 整数型, , 
.参数 公历日, 整数型, , 
.参数 公历时, 整数型, , 
.参数 公历分, 整数型, , 
.参数 年柱序号, 整数型, 参考, 
.参数 月柱序号, 整数型, 参考, 
.参数 日柱序号, 整数型, 参考, 
.参数 时柱序号, 整数型, 参考, 



.子程序 取六十甲子纳音, 文本型, , 
.参数 六十甲子文本, 文本型, , 



.子程序 取交节气时刻, 日期时间型, , 
.参数 公历年份, 整数型, , 
.参数 节气序号, 整数型, , 1-24依次代表：立春、雨水……大寒



.子程序 四柱反推, 逻辑型, , 成功返回真
.参数 年干, 整数型, , 
.参数 年支, 整数型, , 
.参数 月干, 整数型, , 
.参数 月支, 整数型, , 
.参数 日干, 整数型, , 
.参数 日支, 整数型, , 
.参数 时干, 整数型, , 
.参数 时支, 整数型, , 
.参数 年限, 整数型, , "0":1864-1923;"1":1924-1983;"2":1984-2043
.参数 年, 整数型, 参考, 结果存放在参数变量里
.参数 月, 整数型, 参考, 结果存放在参数变量里
.参数 日, 整数型, 参考, 结果存放在参数变量里
.参数 时, 整数型, 参考, 结果存放在参数变量里



.子程序 地名校正真太阳时, 逻辑型, , 成功返回真,反之为假,说明包含错误原因
.参数 年, 整数型, 参考, 原数据和校正的结果存放在参数变量里
.参数 月, 整数型, 参考, 原数据和校正的结果存放在参数变量里
.参数 日, 整数型, 参考, 原数据和校正的结果存放在参数变量里
.参数 时, 整数型, 参考, 原数据和校正的结果存放在参数变量里
.参数 分, 整数型, 参考, 原数据和校正的结果存放在参数变量里
.参数 城市, 文本型, , 
.参数 说明, 文本型, 参考, 只能代入变量
.参数 数据库路径, 文本型, , 是硬盘绝对路径,比如 F:\city_ll.mdb
.参数 详细说明, 逻辑型, 可空, 



.子程序 取月节气时刻, 逻辑型, , 
.参数 公历年份, 整数型, , 
.参数 月份, 整数型, , 
.参数 节时, 日期时间型, 参考, 结果存放在参数变量里
.参数 气时, 日期时间型, 参考, 结果存放在参数变量里
.参数 节序号, 整数型, 参考 可空, 
.参数 气序号, 整数型, 参考 可空, 



.子程序 真太阳时校正, 空白型, , 成功返回真,反之为假,说明包含错误原因
.参数 年, 整数型, 参考, 原数据和校正的结果存放在参数变量里
.参数 月, 整数型, 参考, 原数据和校正的结果存放在参数变量里
.参数 日, 整数型, 参考, 原数据和校正的结果存放在参数变量里
.参数 时, 整数型, 参考, 原数据和校正的结果存放在参数变量里
.参数 分, 整数型, 参考, 原数据和校正的结果存放在参数变量里
.参数 城市, 文本型, , 
.参数 说明, 文本型, 参考, 只能代入变量
.参数 经度, 小数型, , 
.参数 纬度, 小数型, , 




 ' 不属于任何一个程序集、类模块的函数：
