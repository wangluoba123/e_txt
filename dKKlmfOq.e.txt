 ' 文件类型：Windows模块源码

 ' 程序名称：ご旋W律シ模块V1.0
 ' 程序描述：
 ' 程序作者：ご旋W律シ
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：地址也不告诉你
 ' 版权声明：其他信息也不告诉你
 ' 版本号：1.0
 ' 创建号：0.0





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 3 0 应用接口支持库




数据类型 GUID, , 
    .成员 data1, 整数型, , , 
    .成员 data2, 短整数型, , , 
    .成员 data3, 短整数型, , , 
    .成员 data4, 字节型, , "8", 

数据类型 RASIPADDR, , 
    .成员 a, 字节型, , , 
    .成员 b, 字节型, , , 
    .成员 c, 字节型, , , 
    .成员 d, 字节型, , , 

数据类型 RASENTRY, , 
    .成员 dwSize, 整数型, , , 
    .成员 dwfOptions, 整数型, , , 
    .成员 dwCountryID, 整数型, , , 
    .成员 dwCountryCode, 整数型, , , 
    .成员 szAreaCode, 字节型, , "8", 
    .成员 szLocalPhoneNumber, 字节型, , "132", 
    .成员 dwAlternateOffset, 整数型, , , 
    .成员 ipaddr, RASIPADDR, , , 
    .成员 ipaddrDns, RASIPADDR, , , 
    .成员 ipaddrDnsAlt, RASIPADDR, , , 
    .成员 ipaddrWins, RASIPADDR, , , 
    .成员 ipaddrWinsAlt, RASIPADDR, , , 
    .成员 dwFrameSize, 整数型, , , 
    .成员 dwfNetProtocols, 整数型, , , 
    .成员 dwFramingProtocol, 整数型, , , 
    .成员 szScript, 字节型, , "260", 
    .成员 szAutodialDll, 字节型, , "260", 
    .成员 szAutodialFunc, 字节型, , "260", 
    .成员 szDeviceType, 字节型, , "16", 
    .成员 szDeviceName, 字节型, , "132", 
    .成员 szX25PadType, 字节型, , "32", 
    .成员 szX25Address, 字节型, , "200", 
    .成员 szX25Facilities, 字节型, , "200", 
    .成员 szX25UserData, 字节型, , "204", 
    .成员 dwChannels, 整数型, , , 
    .成员 dwReserved1, 整数型, , , 
    .成员 dwReserved2, 整数型, , , 
    .成员 dwSubEntries, 整数型, , , 
    .成员 dwDialMode, 整数型, , , 
    .成员 dwDialExtraPercent, 整数型, , , 
    .成员 dwDialExtraSampleSeconds, 整数型, , , 
    .成员 dwHangUpExtraPercent, 整数型, , , 
    .成员 dwHangUpExtraSampleSeconds, 整数型, , , 
    .成员 dwIdleDisconnectSeconds, 整数型, , , 
    .成员 dwType, 整数型, , , 
    .成员 dwEncryptionType, 整数型, , , 
    .成员 dwCustomAuthKey, 整数型, , , 
    .成员 guidId, GUID, , , 
    .成员 szCustomDialDll, 字节型, , "260", 
    .成员 dwVpnStrategy, 整数型, , , 
    .成员 dwfOptions2, 整数型, , , 
    .成员 dwfOptions3, 整数型, , , 
    .成员 szDnsSuffix, 字节型, , "256", 
    .成员 dwTcpWindowSize, 整数型, , , 
    .成员 szPrerequisitePbk, 字节型, , "260", 
    .成员 szPrerequisiteEntry, 字节型, , "260", 
    .成员 dwRedialCount, 整数型, , , 
    .成员 dwRedialPause, 整数型, , , 

数据类型 RASCREDENTIALS, , 
    .成员 dwSize, 整数型, , , 
    .成员 dwMask, 整数型, , , 
    .成员 szUserName, 字节型, , "257", 
    .成员 szPassword, 字节型, , "257", 
    .成员 szDomain, 字节型, , "16", 


.DLL命令 创建连接, 整数型, "rasapi32.dll", "RasSetEntryPropertiesA", , 
    .参数 lpszPhonebook, 空白型, , 
    .参数 lpszEntry, 文本型, , 
    .参数 lpRasEntry, RASENTRY, , 
    .参数 dwEntryInfoSize, 整数型, , 
    .参数 lpbDeviceInfo, 空白型, , 
    .参数 wDeviceInfoSize, 空白型, , 

.DLL命令 设置连接, 整数型, "rasapi32.dll", "RasSetCredentialsA", , 
    .参数 lpszPhonebook, 空白型, , 
    .参数 lpszEntry, 文本型, , 
    .参数 lpCredentials, RASCREDENTIALS, , 
    .参数 fClearCredentials, 整数型, , 

.DLL命令 复制内存数据, 空白型, "", "RtlMoveMemory", , 
    .参数 Destination, 字节型, 数组, 
    .参数 Source, 文本型, , 
    .参数 Length, 整数型, , 

.程序集 程序集1, , , 

.程序集变量 透明, 整数型, , , 
.子程序 _启动子程序, 整数型, , 请在本子程序中放置动态链接库初始化代码
 ' --========  易语言资源网  (www.wodesoft.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.wodesoft.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.wodesoft.com  ================--

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 返回值被忽略。

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。


.子程序 创建VPN, 逻辑型, 公开, 创建VPN连接
.参数 连接名称, 文本型, 参考, 不能含空格
.参数 用户名, 文本型, 参考, 
.参数 密码, 文本型, 参考, 
.参数 目的地址, 文本型, 参考, 

.局部变量 re, RASENTRY, , , 
.局部变量 rc, RASCREDENTIALS, , , 
.局部变量 n, 整数型, , , 
.局部变量 sDeviceName, 文本型, , , 
.局部变量 sDeviceType, 文本型, , , 

.如果 (或者 (等于 (用户名, “”), 等于 (密码, “”)))
    赋值 (n, 1)
.否则
    赋值 (n, 0)
.如果结束
赋值 (目的地址, 相加 (“   ”, 目的地址))
赋值 (sDeviceName, “WAN 微型端口 (L2TP)”)
赋值 (sDeviceType, “vpn”)
赋值 (re.dwSize, 2884)
赋值 (re.dwCountryCode, 86)
赋值 (re.dwCountryID, 86)
赋值 (re.dwDialExtraPercent, 75)
赋值 (re.dwDialExtraSampleSeconds, 120)
赋值 (re.dwDialMode, 1)
赋值 (re.dwEncryptionType, 3)
赋值 (re.dwfNetProtocols, 4)
赋值 (re.dwfOptions, 1024262928)
赋值 (re.dwfOptions2, 367)
赋值 (re.dwFramingProtocol, 0)
赋值 (re.dwHangUpExtraPercent, 10)
赋值 (re.dwHangUpExtraSampleSeconds, 120)
赋值 (re.dwRedialCount, 3)
赋值 (re.dwRedialPause, 60)
赋值 (re.dwType, 5)
复制内存数据 (re.szDeviceType, sDeviceType, 取文本长度 (sDeviceType))
复制内存数据 (re.szDeviceName, sDeviceName, 取文本长度 (sDeviceName))
复制内存数据 (re.szLocalPhoneNumber, 目的地址, 取文本长度 (目的地址))
赋值 (rc.dwSize, 540)
赋值 (rc.dwMask, 11)
复制内存数据 (rc.szUserName, 用户名, 取文本长度 (用户名))
复制内存数据 (rc.szPassword, 密码, 取文本长度 (密码))
输出调试文本 (连接名称, 用户名, 密码, n)
.如果真 (等于 (创建连接 (0, 连接名称, re, re.dwSize, 0, 0), 0))
    .如果真 (等于 (n, 1))
        返回 (真)
    .如果真结束
    .如果真 (等于 (设置连接 (0, 连接名称, rc, 0), 0))
        返回 (真)
    .如果真结束
     ' 本源码来自易语言资源网(www.wodesoft.com)
.如果真结束
返回 (假)

.子程序 拨号开始, 空白型, 公开, 开始VPN拨号连接CMD处理
.参数 连接名称, 文本型, 参考, 不能含空格
.参数 用户名, 文本型, 参考, 
.参数 密码, 文本型, 参考, 
.参数 等待, 逻辑型, 参考, 
.参数 日志地址, 文本型, 参考, 返回信息

运行 (相加 (“cmd /c RASDIAL ”, 连接名称, “ ”, 用户名, “ ”, 密码, “>>”, 日志地址), 等待, 1)
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 断开拨号, 空白型, 公开, 断开VPN拨号连接
.参数 连接名称, 文本型, 参考, 不能含空格
.参数 等待, 逻辑型, 参考, 

运行 (相加 (“rasphone -h ”, 连接名称), 等待, )

.子程序 删除拨号, 空白型, 公开, 删除VPN拨号连接
.参数 连接名称, 文本型, 参考, 不能含空格
.参数 等待, 逻辑型, 参考, 

运行 (相加 (“rasphone -r ”, 连接名称), 等待, )

.子程序 淡入, 空白型, 公开, 启动透明逐渐加强
.参数 窗口名, 窗口, 参考, 

赋值 (窗口名.可视, 假)
未知支持库函数_66 (窗口名.取窗口句柄 (), 0)
赋值 (窗口名.可视, 真)
.计次循环首 (255, 透明)
    处理事件 ()
    延时 (1)
    未知支持库函数_66 (窗口名.取窗口句柄 (), 透明)
     ' 本源码来自易语言资源网(www.wodesoft.com)
.计次循环尾 ()


.子程序 淡出, 空白型, 公开, 销毁逐渐减弱
.参数 窗口名, 窗口, 参考, 

.计次循环首 (255, 透明)
    处理事件 ()
    延时 (1)
    未知支持库函数_66 (窗口名.取窗口句柄 (), 相减 (255, 透明))
.计次循环尾 ()


.子程序 文本截取, 文本型, 公开, 截取标识内文本,标识需要唯一性,取自小路（woxl）源码
.参数 处理的文本, 文本型, , 
.参数 左标记, 文本型, , 
.参数 右标记, 文本型, 可空, 

.局部变量 left, 整数型, , , 
.局部变量 right, 整数型, , , 

赋值 (left, 相加 (寻找文本 (处理的文本, 左标记, , 假), 取文本长度 (左标记)))
赋值 (right, 寻找文本 (处理的文本, 右标记, left, 假))
返回 (取文本中间 (处理的文本, left, 相减 (right, left)))

.子程序 动态加密_, 字节集, 公开, 返回到字节集请使用到文本显示加密内容                      制作:逍遥De二少 
.参数 _待加密字节集, 字节集, , 赋值给予 到字节集
.参数 _待算密钥_key, 文本型, 可空, 为空则使用“abcdefghijklmnopqrhtuvwxyz1234567890~!@#$%^&*()_+-=”

.局部变量 i, 整数型, , , 
.局部变量 密钥字节, 字节集, , , 
.局部变量 n, 整数型, , , 
.局部变量 密钥长度, 整数型, , , 
.局部变量 封包长度, 整数型, , , 
.局部变量 数值, 整数型, , , 
.局部变量 启动字节, 字节集, , , 
.局部变量 整位, 整数型, , , 
.局部变量 密钥时间, 字节集, , , 
.局部变量 临时字节, 字节型, , , 
.局部变量 传递字节, 字节型, , , 

赋值 (_待算密钥_key, 选择 (等于 (_待算密钥_key, “”), “abcdefghijklmnopqrhtuvwxyz1234567890~!@#$%^&*()_+-=”, _待算密钥_key))
赋值 (密钥字节, 到字节集 (_待算密钥_key))
赋值 (密钥长度, 取字节集长度 (密钥字节))
赋值 (封包长度, 取字节集长度 (_待加密字节集))
.如果真 (并且 (大于 (封包长度, 0), 大于 (密钥长度, 0)))
    赋值 (启动字节, 到字节集 (取启动时间 ()))
    赋值 (密钥时间, 启动字节)
    赋值 (数值, 取随机数 (2, 255))
    .计次循环首 (4, i)
        赋值 (密钥时间 [i], 位异或 (启动字节 [i], 数值))
    .计次循环尾 ()
    .计次循环首 (密钥长度, i)
        赋值 (整位, 相加 (整位, 1))
        .如果真 (大于 (整位, 4))
            赋值 (整位, 1)
        .如果真结束
        赋值 (密钥字节 [i], 位异或 (密钥字节 [i], 密钥时间 [整位]))
    .计次循环尾 ()
    .计次循环首 (封包长度, i)
        赋值 (整位, 相加 (整位, 1))
        .如果真 (大于 (整位, 4))
            赋值 (整位, 1)
        .如果真结束
        .计次循环首 (密钥长度, n)
            赋值 (_待加密字节集 [i], 位异或 (_待加密字节集 [i], 密钥字节 [n]))
        .计次循环尾 ()
        赋值 (_待加密字节集 [i], 位异或 (_待加密字节集 [i], 启动字节 [整位]))
    .计次循环尾 ()
    赋值 (数值, 位取反 (数值))
    赋值 (数值, 位异或 (数值, 取字节集数据 (密钥时间, #整数型, )))
    赋值 (_待加密字节集, 相加 (到字节集 (数值), 密钥时间, _待加密字节集))
    返回 (_待加密字节集)
.如果真结束
返回 ({  })

.子程序 根据进程ID取进程名, 文本型, 公开, 
.参数 进程ID, 空白型, , 

.局部变量 系统进程, 未知类型0x20009, , "0", 
.局部变量 计次变量, 整数型, , , 

赋值 (系统进程, 未知支持库函数_10 ())
.计次循环首 (取数组成员数 (系统进程), 计次变量)
    .如果真 (等于 (系统进程 [计次变量], , 进程ID))
        返回 (系统进程 [计次变量], )
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
返回 (“”)

.子程序 根据进程名取进程ID, 整数型, 公开, 
.参数 进程名, 文本型, , 

.局部变量 系统进程, 未知类型0x20009, , "0", 
.局部变量 计次变量, 整数型, , , 

赋值 (系统进程, 未知支持库函数_10 ())
.计次循环首 (取数组成员数 (系统进程), 计次变量)
    .如果真 (等于 (系统进程 [计次变量], , 进程名))
        返回 (系统进程 [计次变量], )
        跳出循环 ()
    .如果真结束
     ' 本源码来自易语言资源网(www.wodesoft.com)
.计次循环尾 ()
返回 (0)

.子程序 动态解密_, 字节集, 公开, 返回到字节集请使用到文本显示加密内容                      制作:逍遥De二少 
.参数 _待解密字节集, 字节集, , 
.参数 _待算密钥_key, 文本型, 可空, 为空则使用“abcdefghijklmnopqrhtuvwxyz1234567890~!@#$%^&*()_+-=”

.局部变量 封包长度, 整数型, , , 
.局部变量 密钥长度, 整数型, , , 
.局部变量 密钥字节, 字节集, , , 
.局部变量 i, 整数型, , , 
.局部变量 位于数值, 整数型, , , 
.局部变量 时间密钥, 字节型, , "4", 
.局部变量 n, 整数型, , , 
.局部变量 整位, 整数型, , , 
.局部变量 密钥时间, 字节型, , "4", 

赋值 (封包长度, 取字节集长度 (_待解密字节集))
.如果真 (大于 (封包长度, 8))
    赋值 (_待算密钥_key, 选择 (等于 (_待算密钥_key, “”), “abcdefghijklmnopqrhtuvwxyz1234567890~!@#$%^&*()_+-=”, _待算密钥_key))
    赋值 (密钥字节, 到字节集 (_待算密钥_key))
    赋值 (密钥长度, 取字节集长度 (密钥字节))
    .如果真 (大于 (密钥长度, 0))
        赋值 (位于数值, 1)
        赋值 (位于数值, 位异或 (取字节集数据 (_待解密字节集, #整数型, 位于数值), 取字节集数据 (_待解密字节集, #整数型, 位于数值)))
        赋值 (位于数值, 位取反 (位于数值))
        赋值 (_待解密字节集, 取字节集右边 (_待解密字节集, 相减 (封包长度, 4)))
        .计次循环首 (4, i)
            赋值 (密钥时间 [i], _待解密字节集 [i])
            赋值 (时间密钥 [i], 位异或 (_待解密字节集 [i], 位于数值))
            ' 本源码来自易语言资源网(www.wodesoft.com)
        .计次循环尾 ()
        赋值 (封包长度, 相减 (封包长度, 8))
        赋值 (_待解密字节集, 取字节集右边 (_待解密字节集, 封包长度))
        .计次循环首 (密钥长度, i)
            赋值 (整位, 相加 (整位, 1))
            .如果真 (大于 (整位, 4))
                赋值 (整位, 1)
            .如果真结束
            赋值 (密钥字节 [i], 位异或 (密钥字节 [i], 密钥时间 [整位]))
        .计次循环尾 ()
        .计次循环首 (封包长度, i)
            赋值 (整位, 相加 (整位, 1))
            .如果真 (大于 (整位, 4))
                赋值 (整位, 1)
            .如果真结束
            赋值 (_待解密字节集 [i], 位异或 (_待解密字节集 [i], 时间密钥 [整位]))
            .计次循环首 (密钥长度, n)
                赋值 (_待解密字节集 [i], 位异或 (_待解密字节集 [i], 密钥字节 [n]))
            .计次循环尾 ()
        .计次循环尾 ()
        返回 (_待解密字节集)
    .如果真结束
    
.如果真结束
返回 ({  })


 ' 不属于任何一个程序集、类模块的函数：
