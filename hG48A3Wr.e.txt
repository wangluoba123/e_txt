 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 515
    高度 = 398
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “进程小助手 - 帮助您了解更多的进程知识！ by 一流男孩 QQ:641132912”
    帮助文件名 = “”

窗口 窗口_正在查询进程
    左边 = 50
    顶边 = 50
    宽度 = 400
    高度 = 100
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.常量 真, "“是”", , 
.常量 假, "“否”", , 
.常量 警告, "“警告: 终止进程会导致不希望发生的结果，
包括数据丢失和系统不稳定。在被终止前，
进程将没有机会保存其状态和数据。确实
想终止该进程吗?”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' internet 707ca37322474f6ca841f0e224f4b620 1 0 互联网支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 1 1 多线程支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二





.窗口程序集 窗口程序集1, , , 

.程序集变量 进程数, 整数型, , , 
.程序集变量 停止, 逻辑型, , , 
.程序集变量 显示窗口, 逻辑型, , , 
.子程序 _按钮_刷新进程_被单击, 空白型, , 
未知支持库函数_0 (&枚举进程, )
载入 (窗口_正在查询进程, , 假)
.如果真 (是否已创建 (窗口_正在查询进程))
    赋值 (窗口_正在查询进程., 显示窗口)
.如果真结束


.子程序 枚举进程, 空白型, , 
.局部变量 进程信息, 未知类型0x40009, , "0", 
.局部变量 i, 整数型, , , 
.局部变量 表项, 整数型, , , 
.局部变量 匿名局部变量_233, 空白型, , , 
.局部变量 系统进程, 文本型, , , 
.局部变量 后台进程, 文本型, , , 
.局部变量 使用网络, 文本型, , , 
.局部变量 硬件相关, 文本型, , , 
.局部变量 常见错误, 文本型, , , 
.局部变量 内存使用, 文本型, , , 
.局部变量 广告软件, 文本型, , , 
.局部变量 间谍软件, 文本型, , , 
.局部变量 病毒, 文本型, , , 
.局部变量 木马, 文本型, , , 
.局部变量 描述, 文本型, , , 

赋值 (.禁止, 真)
赋值 (.禁止, 假)
全部删除 ()
赋值 (进程信息, 未知支持库函数_10 ())
赋值 (进程数, 取数组成员数 (进程信息))
.计次循环首 (取数组成员数 (进程信息), i)
    处理事件 ()
    .如果真 (等于 (停止, 真))
        赋值 (停止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 真)
        .如果真 (是否已创建 ())
            .调用反馈事件 ()
        .如果真结束
        返回 ()
    .如果真结束
    赋值 (表项, .插入表项 (进程信息 [i], , , , , ))
    表项.保证显示 ()
    表项.置标题 (1, 到文本 (进程信息 [i], ))
    表项.置标题 (2, 到文本 (进程信息 [i], ))
    查询进程 (进程信息 [i], , 系统进程, 后台进程, 使用网络, 硬件相关, 常见错误, 内存使用, 广告软件, 间谍软件, 病毒, 木马, 描述)
    表项.置标题 (3, 系统进程)
    表项.置标题 (4, 后台进程)
    表项.置标题 (5, 使用网络)
    表项.置标题 (6, 硬件相关)
    表项.置标题 (7, 常见错误)
    表项.置标题 (8, 内存使用)
    表项.置标题 (9, 广告软件)
    表项.置标题 (10, 间谍软件)
    表项.置标题 (11, 病毒)
    表项.置标题 (12, 木马)
    表项.置标题 (13, 描述)
    统计数量 ()
.计次循环尾 ()
赋值 (.禁止, 假)

.子程序 标亮字符, 空白型, , 
.参数 字符, 文本型, , 
.参数 颜色, 整数型, , 
.参数 起始位置, 整数型, 可空, 
.参数 返回位置, 整数型, 参考 可空, 

.局部变量 临时, 未知类型0x60004, , , 

赋值 (返回位置, 起始位置.未知支持库函数_16 (字符))
.如果真 (等于 (返回位置, -1))
    返回 ()
.如果真结束
赋值 (., 返回位置)
赋值 (., 取文本长度 (字符))
赋值 (临时., 颜色)
赋值 (临时., #粗体)
临时.未知支持库函数_10 ()
赋值 (., -1)
赋值 (., 0)

.子程序 统计数量, 空白型, , 
.局部变量 表项数, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 临时, 整数型, , , 

赋值 (表项数, 取表项数 ())
赋值 (., 相加 (“现在检测到 ”, 到文本 (表项数), “ 个进程”, #换行符))
.计次循环首 (表项数, i)
    .如果真 (等于 (相减 (i, 1).取标题 (3), #真))
        赋值 (临时, 相加 (临时, 1))
    .如果真结束
    
.计次循环尾 ()
赋值 (., 相加 (., “(系统进程 ”, 到文本 (临时), “ 个”))
赋值 (临时, 0)
.计次循环首 (表项数, i)
    .如果真 (等于 (相减 (i, 1).取标题 (4), #真))
        赋值 (临时, 相加 (临时, 1))
    .如果真结束
    
.计次循环尾 ()
赋值 (., 相加 (., “；后台进程 ”, 到文本 (临时), “ 个”))
赋值 (临时, 0)
.计次循环首 (表项数, i)
    .如果真 (等于 (相减 (i, 1).取标题 (5), #真))
        赋值 (临时, 相加 (临时, 1))
    .如果真结束
    
.计次循环尾 ()
赋值 (., 相加 (., “；使用网络 ”, 到文本 (临时), “ 个”))
赋值 (临时, 0)
.计次循环首 (表项数, i)
    .如果真 (等于 (相减 (i, 1).取标题 (6), #真))
        赋值 (临时, 相加 (临时, 1))
    .如果真结束
    
.计次循环尾 ()
赋值 (., 相加 (., “；硬件相关 ”, 到文本 (临时), “ 个”))
赋值 (临时, 0)
.计次循环首 (表项数, i)
    .如果真 (等于 (相减 (i, 1).取标题 (7), #真))
        赋值 (临时, 相加 (临时, 1))
    .如果真结束
    
.计次循环尾 ()
赋值 (., 相加 (., “；常见错误 ”, 到文本 (临时), “ 个”))
赋值 (临时, 0)
.计次循环首 (表项数, i)
    .如果真 (等于 (相减 (i, 1).取标题 (8), #真))
        赋值 (临时, 相加 (临时, 1))
    .如果真结束
    
.计次循环尾 ()
赋值 (., 相加 (., “；内存使用 ”, 到文本 (临时), “ 个”))
赋值 (临时, 0)
.计次循环首 (表项数, i)
    .如果真 (等于 (相减 (i, 1).取标题 (9), #真))
        赋值 (临时, 相加 (临时, 1))
    .如果真结束
    
.计次循环尾 ()
赋值 (., 相加 (., “；广告软件 ”, 到文本 (临时), “ 个”))
赋值 (临时, 0)
.计次循环首 (表项数, i)
    .如果真 (等于 (相减 (i, 1).取标题 (10), #真))
        赋值 (临时, 相加 (临时, 1))
    .如果真结束
    
.计次循环尾 ()
赋值 (., 相加 (., “；间谍软件 ”, 到文本 (临时), “ 个”))
赋值 (临时, 0)
.计次循环首 (表项数, i)
    .如果真 (等于 (相减 (i, 1).取标题 (11), #真))
        赋值 (临时, 相加 (临时, 1))
    .如果真结束
    
.计次循环尾 ()
赋值 (., 相加 (., “；病毒软件 ”, 到文本 (临时), “ 个”))
赋值 (临时, 0)
.计次循环首 (表项数, i)
    .如果真 (等于 (相减 (i, 1).取标题 (12), #真))
        赋值 (临时, 相加 (临时, 1))
    .如果真结束
    
.计次循环尾 ()
赋值 (., 相加 (., “；木马软件 ”, 到文本 (临时), “ 个)”))
处理事件 ()
赋值 (临时, 0)
标亮字符 (_取文本中间 (., “现在检测到 ”, “ 个进程”), #蓝色, , 临时)
标亮字符 (_取文本中间 (., “系统进程 ”, “ 个”), #蓝色, 相加 (临时, 5), 临时)
标亮字符 (_取文本中间 (., “后台进程 ”, “ 个”), #蓝色, 相加 (临时, 5), 临时)
标亮字符 (_取文本中间 (., “使用网络 ”, “ 个”), #蓝色, 相加 (临时, 5), 临时)
标亮字符 (_取文本中间 (., “硬件相关 ”, “ 个”), #蓝色, 相加 (临时, 5), 临时)
标亮字符 (_取文本中间 (., “常见错误 ”, “ 个”), #蓝色, 相加 (临时, 5), 临时)
标亮字符 (_取文本中间 (., “内存使用 ”, “ 个”), #蓝色, 相加 (临时, 5), 临时)
标亮字符 (_取文本中间 (., “广告软件 ”, “ 个”), #蓝色, 相加 (临时, 5), 临时)
标亮字符 (_取文本中间 (., “间谍软件 ”, “ 个”), #红色, 相加 (临时, 5), 临时)
标亮字符 (_取文本中间 (., “病毒软件 ”, “ 个”), #红色, 相加 (临时, 5), 临时)
标亮字符 (_取文本中间 (., “木马软件 ”, “ 个”), #红色, 相加 (临时, 5), 临时)

.子程序 __启动窗口_尺寸被改变, 空白型, , 
.移动 (取用户区宽度 (), 相减 (取用户区高度 (), .加粗, 80))
.移动 (相加 (.加粗, .删除线), 取用户区宽度 (), )
相减 (相除 (相减 (取用户区宽度 (), .宽度), 2), 50).移动 (相减 (取用户区高度 (), .高度), , )
相加 (相除 (相减 (取用户区宽度 (), .宽度), 2), 50).移动 (相减 (取用户区高度 (), .高度), , )

.子程序 _结束进程_被选择, 空白型, , 
.如果真 (等于 (., -1))
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (#警告, 相加 (#警告图标, #是否钮, #默认按钮二), “警告:”), #否钮))
    返回 ()
.如果真结束
.如果 (未知支持库函数_11 (.取标题 (., )))
    .删除表项 (.)
.否则
    信息框 (“结束进程失败，可能是因为您没有权限。”, #错误图标, “错误:”)
.如果结束


.子程序 _列表框_进程_右键单击表项, 空白型, , 
弹出菜单 ()

.子程序 _按钮_缩小_被单击, 空白型, , 
.局部变量 临时高度, 整数型, 静态, , 

.如果 (等于 (.标题, “↑”))
    赋值 (临时高度, .)
    赋值 (., 相减 (相加 (., .高度, ., 25), 取用户区高度 ()))
    赋值 (.字体大小, 假)
    赋值 (., 假)
    赋值 (., 2)
    赋值 (显示窗口, 真)
    赋值 (.标题, “↓”)
.否则
    赋值 (., 临时高度)
    赋值 (.字体大小, 真)
    赋值 (., 真)
    赋值 (., 1)
    赋值 (显示窗口, 假)
    赋值 (.标题, “↑”)
.如果结束
.如果真 (是否已创建 (窗口_正在查询进程))
    赋值 (窗口_正在查询进程., 显示窗口)
.如果真结束


.子程序 _按钮_停止查询_被单击, 空白型, , 
赋值 (停止, 真)

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
结束 ()

.子程序 _标签1_反馈事件, 整数型, , 
.参数 参数一, 整数型, , 
.参数 参数二, 整数型, , 

.如果真 (是否已创建 ())
    窗口_正在查询进程.销毁 ()
.如果真结束


.程序集 程序集1, , , 

.子程序 查询进程, 空白型, , 
.参数 进程名, 文本型, , 
.参数 系统进程, 文本型, , 
.参数 后台进程, 文本型, , 
.参数 使用网络, 文本型, , 
.参数 硬件相关, 文本型, , 
.参数 常见错误, 文本型, , 
.参数 内存使用, 文本型, , 
.参数 广告软件, 文本型, , 
.参数 间谍软件, 文本型, , 
.参数 病毒, 文本型, , 
.参数 木马, 文本型, , 
.参数 描述, 文本型, , 

.局部变量 源码, 文本型, , , 
.局部变量 URL, 文本型, , , 
.局部变量 进程名称, 文本型, , , 
.局部变量 临时, 文本型, , , 
.局部变量 返回位置, 整数型, , , 
.局部变量 临时数组, 文本型, , "10", 
.局部变量 i, 整数型, , , 

赋值 (源码, 到文本 (未知支持库函数_7 (相加 (“http://www.pctutu.com/process/search.html?k=”, 进程名))))
赋值 (URL, _取文本中间 (源码, 相加 (“<th>・<a href=”, #引号), #引号))
赋值 (进程名称, _取文本中间 (源码, “<span class=keyword>”, “</span>”))
.如果真 (或者 (不等于 (删首尾空 (到小写 (进程名称)), 删首尾空 (到小写 (进程名))), 等于 (URL, “”)))
    赋值 (系统进程, “未知”)
    赋值 (后台进程, “未知”)
    赋值 (使用网络, “未知”)
    赋值 (硬件相关, “未知”)
    赋值 (常见错误, “未知”)
    赋值 (内存使用, “未知”)
    赋值 (广告软件, “未知”)
    赋值 (间谍软件, “未知”)
    赋值 (病毒, “未知”)
    赋值 (木马, “未知”)
    赋值 (描述, “”)
    返回 ()
.如果真结束
赋值 (源码, 到文本 (未知支持库函数_7 (相加 (“http://www.pctutu.com/process/”, URL))))
赋值 (源码, _取文本中间 (源码, “<th>系统进程</th>”, “</table>”))
赋值 (临时, _取文本中间 (源码, 相加 (“ alt=”, #引号), #引号, , 返回位置))
.计次循环首 (10, i)
    赋值 (临时数组 [i], 临时)
    赋值 (临时, _取文本中间 (源码, 相加 (“ alt=”, #引号), #引号, 返回位置, 返回位置))
.计次循环尾 ()
.如果 (等于 (临时数组 [1], “true”))
    赋值 (系统进程, #真)
.否则
    赋值 (系统进程, #假)
.如果结束
.如果 (等于 (临时数组 [2], “true”))
    赋值 (后台进程, #真)
.否则
    赋值 (后台进程, #假)
.如果结束
.如果 (等于 (临时数组 [3], “true”))
    赋值 (使用网络, #真)
.否则
    赋值 (使用网络, #假)
.如果结束
.如果 (等于 (临时数组 [4], “true”))
    赋值 (硬件相关, #真)
.否则
    赋值 (硬件相关, #假)
.如果结束
.如果 (等于 (临时数组 [5], “true”))
    赋值 (常见错误, #真)
.否则
    赋值 (常见错误, #假)
.如果结束
.如果 (等于 (临时数组 [6], “true”))
    赋值 (内存使用, #真)
.否则
    赋值 (内存使用, #假)
.如果结束
.如果 (等于 (临时数组 [7], “true”))
    赋值 (广告软件, #真)
.否则
    赋值 (广告软件, #假)
.如果结束
.如果 (等于 (临时数组 [8], “true”))
    赋值 (间谍软件, #真)
.否则
    赋值 (间谍软件, #假)
.如果结束
.如果 (等于 (临时数组 [9], “true”))
    赋值 (病毒, #真)
.否则
    赋值 (病毒, #假)
.如果结束
.如果 (等于 (临时数组 [10], “true”))
    赋值 (木马, #真)
.否则
    赋值 (木马, #假)
.如果结束
赋值 (描述, _取文本中间 (源码, 相加 (“line-height:26px; padding:7px;”, #引号, “>”), “</td>”))
赋值 (描述, 子文本替换 (描述, “&nbsp;”, “ ”, , , 真))
赋值 (描述, 子文本替换 (描述, “<br>”, “ ”, , , 真))
赋值 (描述, 删首尾空 (描述))

.子程序 _取文本中间, 文本型, , 
.参数 原文本, 文本型, , 
.参数 文本1, 文本型, , 
.参数 文本2, 文本型, , 
.参数 起始位置, 整数型, 可空, 
.参数 返回位置, 整数型, 参考 可空, 

.如果真 (是否为空 (起始位置))
    赋值 (起始位置, 0)
.如果真结束
赋值 (返回位置, 相加 (寻找文本 (原文本, 文本1, 起始位置, 假), 取文本长度 (文本1)))
.如果真 (等于 (返回位置, 相减 (取文本长度 (文本1), 1)))
    赋值 (返回位置, -1)
    返回 (“”)
.如果真结束
返回 (取文本中间 (原文本, 返回位置, 相减 (寻找文本 (原文本, 文本2, 返回位置, 假), 返回位置)))

.窗口程序集 窗口程序集2, , , 

.子程序 _时钟1_周期事件, 空白型, , 
赋值 (.标题, 相加 (“正在查询进程... 第 ”, 到文本 (_启动窗口.取表项数 (.)), “ 个，共 ”, 到文本 (_启动窗口.), “ 个 按ESC键停止”))
赋值 (.最大位置, _启动窗口.)
赋值 (.位置, _启动窗口.取表项数 (.))
.如果真 (等于 (.位置, .最大位置))
    销毁 ()
.如果真结束


.子程序 _窗口_正在查询进程_可否被关闭, 逻辑型, , 
赋值 (., 假)
.如果真 (等于 (信息框 (“正在执行查询，您确信要停止吗？”, 相加 (#询问图标, #是否钮, #默认按钮二), “提示:”), #否钮))
    赋值 (., 真)
    返回 (假)
.如果真结束
赋值 (_启动窗口., 真)
返回 (真)


 ' 不属于任何一个程序集、类模块的函数：
