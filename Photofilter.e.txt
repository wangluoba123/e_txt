 ' 文件类型：Windows窗口程序

 ' 程序名称：Photofilter
 ' 程序描述：Photofilter
@备注:
Photofilter
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\Photofilter.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “Photofilter”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口3
    左边 = 50
    顶边 = 50
    宽度 = 365
    高度 = 169
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “Install”
    帮助文件名 = “”



.常量 GWL_WNDPROC, "-4", , 
.常量 WM_GETMINMAXINFO, "36", , 此消息发送给窗口当它将要改变大小或位置；
.常量 WM_MOUSEMOVE, "512", , 
.常量 WM_NCMOUSEMOVE, "160", , 
.常量 WM_EXITSIZEMOVE, "562", , 
.常量 WM_MOVING, "534", , 
.常量 WM_MOVE, "3", , 
.常量 WM_NCHITTEST, "132", , 
.常量 WM_NCLBUTTONDOWN, "161", , 
.常量 WM_NCLBUTTONUP, "162", , 
.常量 WM_SIZE, "5", , 
.常量 WM_SIZING, "532", , 
.常量 WM_SYSCOMMAND, "274", , 
.常量 WM_KEYUP, "257", , 
.常量 WM_KEYDOWN, "256", , 
.常量 CF_ANSIONLY, "1024", 隐藏, 
.常量 CF_APPLY, "512", 隐藏, 
.常量 CF_BITMAP, "2", 隐藏, 
.常量 CF_BOTH, "3", 隐藏, 
.常量 CF_DIB, "8", 隐藏, 
.常量 CF_DIF, "5", 隐藏, 
.常量 CF_DSPBITMAP, "130", 隐藏, 
.常量 CF_DSPENHMETAFILE, "142", 隐藏, 
.常量 CF_DSPMETAFILEPICT, "131", 隐藏, 
.常量 CF_DSPTEXT, "129", 隐藏, 
.常量 CF_EFFECTS, "256", 隐藏, 
.常量 CF_ENABLEHOOK, "8", 隐藏, 
.常量 CF_ENABLETEMPLATE, "16", 隐藏, 
.常量 CF_ENABLETEMPLATEHANDLE, "32", 隐藏, 
.常量 CF_ENHMETAFILE, "14", 隐藏, 
.常量 CF_FIXEDPITCHONLY, "16384", 隐藏, 
.常量 CF_FORCEFONTEXIST, "65536", 隐藏, 
.常量 CF_GDIOBJFIRST, "768", 隐藏, 
.常量 CF_GDIOBJLAST, "1023", 隐藏, 
.常量 CF_HDROP, "15", 隐藏, 
.常量 CF_INITTOLOGFONTSTRUCT, "64", 隐藏, 
.常量 CF_LIMITSIZE, "8192", 隐藏, 
.常量 CF_LOCALE, "16", 隐藏, 
.常量 CF_MAX, "17", 隐藏, 
.常量 CF_METAFILEPICT, "3", 隐藏, 
.常量 CF_NOFACESEL, "524288", 隐藏, 
.常量 CF_NOOEMFONTS, "2048", 隐藏, 
.常量 CF_NOSIMULATIONS, "4096", 隐藏, 
.常量 CF_NOSIZESEL, "2097152", 隐藏, 
.常量 CF_NOSTYLESEL, "1048576", 隐藏, 
.常量 CF_NOVECTORFONTS, "2048", 隐藏, 
.常量 CF_OEMTEXT, "7", 隐藏, 
.常量 CF_OWNERDISPLAY, "128", 隐藏, 
.常量 CF_PALETTE, "9", 隐藏, 
.常量 CF_PENDATA, "10", 隐藏, 
.常量 CF_PRINTERFONTS, "2", 隐藏, 
.常量 CF_PRIVATEFIRST, "512", 隐藏, 
.常量 CF_PRIVATELAST, "767", 隐藏, 
.常量 CF_RIFF, "11", 隐藏, 
.常量 CF_SCALABLEONLY, "131072", 隐藏, 
.常量 CF_SCREENFONTS, "1", 隐藏, 
.常量 CF_SHOWHELP, "4", 隐藏, 
.常量 CF_SYLK, "4", 隐藏, 
.常量 CF_TEXT, "1", 隐藏, 
.常量 CF_TIFF, "6", 隐藏, 
.常量 CF_TTONLY, "262144", 隐藏, 
.常量 CF_UNICODETEXT, "13", 隐藏, 
.常量 CF_USESTYLE, "128", 隐藏, 
.常量 CF_WAVE, "12", 隐藏, 
.常量 CF_WYSIWYG, "32768", 隐藏, 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' edroptarget {9DA96BF9CEBD45c5BFCF94CBE61671F5} 2 0 拖放支持库
 ' shell 52F260023059454187AF826A3C07AF2A 3 0 操作系统界面功能支持库
 ' shellEx DA19AC3ADD2F4121AAD84AC5FBCAFC71 3 0 扩展功能支持库一



 ' 所需要的模块
 ' MDI窗口 D:\桌面\编程开发\Photofilter\MDI.ec
 ' 剪贴板操作类 D:\桌面\编程开发\Photofilter\剪贴板操作类.ec


数据类型 坐标, , 坐标;POINTAPI
    .成员 横向位置, 整数型, , , X坐标
    .成员 纵向位置, 整数型, , , Y坐标

数据类型 MINMAXINFO, , MINMAXINFO
    .成员 ptReserved, 坐标, , , 
    .成员 ptMaxSize, 坐标, , , 
    .成员 ptMaxPosition, 坐标, , , 
    .成员 ptMinTrackSize, 坐标, , , 
    .成员 ptMaxTrackSize, 坐标, , , 

.全局变量 配置目录, 文本型, , , 
.全局变量 现行图片, 文本型, , , 
.全局变量 总数, 整数型, , , 

.DLL命令 SetWindowLongA, 子程序指针, "user32", "SetWindowLongA", , 在窗口结构中为指定的窗口设置信息　指定数据的前一个值
    .参数 hwnd, 整数型, , 欲为其取得信息的窗口的句柄
    .参数 nIndex, 整数型, , 请参考GetWindowLong函数的nIndex参数的说明
    .参数 dwNewLong, 子程序指针, , 由nIndex指定的窗口信息的新值;

.DLL命令 CallWindowProcA, 整数型, "user32", "CallWindowProcA", , 将消息传答窗口函数　
    .参数 lpPrevWndFunc, 子程序指针, , 
    .参数 hwnd, 整数型, , 
    .参数 msg, 整数型, , 
    .参数 wParam, 整数型, , 
    .参数 lParam, 整数型, , 

.DLL命令 CopyMemory, 空白型, "kernel32", "RtlMoveMemory", , 　
    .参数 pDest, 整数型, , 
    .参数 pSrc, MINMAXINFO, , 
    .参数 ByteLen, 字节型, , 

.DLL命令 系统关于对话框, 空白型, "", "ShellAboutA", , 
    .参数 窗口句柄, 整数型, , 
    .参数 应用程序标题, 文本型, , 
    .参数 其他信息, 文本型, , 
    .参数 图标句柄, 整数型, , 

.DLL命令 CopyMemory1, 空白型, "kernel32", "RtlMoveMemory", , 　
    .参数 pDest, MINMAXINFO, , 
    .参数 pSrc, 整数型, , 
    .参数 ByteLen, 字节型, , 

.DLL命令 DLL命令1, 空白型, "", "", , 

.类模块 MDI窗口类, , , API

.子程序 创建MDI客户区, 空白型, , 成功返回MDI客户区的句柄，失败返回0
.参数 主窗口句柄, 整数型, , 你要设置为NDI窗口的主窗口句柄
.参数 客户区左边, 整数型, 可空, 默认为0
.参数 客户区顶边, 整数型, 可空, 默认为0
.参数 客户区宽度, 整数型, 可空, 默认为主窗口宽度
.参数 客户区高度, 整数型, 可空, 默认为主窗口高度
.参数 是否有滚动条, 逻辑型, 可空, 为假或空则没有默认为没有
.参数 菜单序号, 整数型, 可空, 为空或零，则是第一个菜单，在主菜单第几个菜单项加入文件列表菜单，从0开始。比如主菜单有“文件”、“编辑”、“窗口”和“帮助”菜单项，欲加入“窗口”菜单项，则数值设为 2。
.参数 底图, 字节集, 可空, 客户区的背景图
.参数 子窗口是否独立线程运行, 逻辑型, 可空, 非独立线程会加快子窗口的运行速度。默认为假
.参数 子窗口可否被关闭事件, 子程序指针, 可空, 在窗口被关闭之前产生此事件，用于询问窗口可否被关闭。如果返回假则不允许窗口被关闭，返回真或不返回值允许关闭。
.参数 子窗口将被销毁事件, 子程序指针, 可空, 当窗口将被销毁前产生此事件。窗口被销毁后所有对此窗口及其内部组件的修改都将被作废。如果用复制组件保存的组件数组请自行删除。
.参数 子窗口尺寸被改变事件, 子程序指针, 可空, 当窗口的尺寸被改变后产生此事件。
.参数 子窗口激活状态被改变事件, 子程序指针, 可空, 但子窗口的激活状态被改变是返回两个子窗口句柄参数，参数一=前一个子窗口句柄，参数二=当前活动子窗口句柄。
.参数 子窗口系统按钮命令事件, 子程序指针, 可空, 关闭钮 = 4；最大化钮 =2；最小化钮：1。恢复窗口=3



.子程序 创建MDI子窗口, 整数型, , 返回MDI子窗口句柄
.参数 窗口标题, 文本型, 可空, 



.子程序 设置为子窗口, 空白型, , 要将其他已有的窗口设置为子窗口，请将窗口可视设置为假，这样可避免闪烁。
.参数 窗口句柄, 整数型, , 



.子程序 MDI客户区移动, 空白型, , 此命令用于移动客户区
.参数 左边, 整数型, , 
.参数 顶边, 整数型, , 
.参数 宽度, 整数型, , 
.参数 高度, 整数型, , 



.子程序 取MDI客户区尺寸, 逻辑型, , 不含窗口标题和边界，成功为真，不成功为假，成功返回真
.参数 宽度, 整数型, 参考 可空, 
.参数 高度, 整数型, 参考 可空, 



.子程序 排列图标, 整数型, , 全部最小化子窗口重新排列，成功为非零值


.子程序 最大化活动子窗口, 整数型, , 最大化当前子窗口，成功为非零值


.子程序 最小化活动子窗口, 整数型, , 最小化当前子窗口，成功为非零值


.子程序 取子窗口数量, 整数型, , 


.子程序 恢复活动子窗口, 空白型, , 恢复当前激活的最小化或最大化MDI子窗口


.子程序 关闭活动子窗口, 整数型, , 关闭销毁当前激活的MDI子窗口，没有窗口可否关闭事件。，成功为非零值


.子程序 层叠窗口, 整数型, , 层叠所有的MDI子窗口。，成功为非零值


.子程序 垂直平铺窗口, 整数型, , 垂直平铺所有的MDI子窗口。但子窗口平均充满客户区时无效，成功为非零值


.子程序 水平平铺窗口, 整数型, , 水平平铺所有的MDI子窗口。但子窗口平均充满客户区时无效，成功为非零值


.子程序 前一个窗口, 整数型, , 激活的前一个MDI子窗口，成功为非零值


.子程序 下一个窗口, 整数型, , 激活的下一个MDI子窗口，成功为非零值


.子程序 取活动子窗口标题, 文本型, , 返回当前活动窗口的标题


.子程序 置活动子窗口标题, 整数型, , 非零为失败
.参数 标题, 文本型, , 要进行设置的支持库标题



.子程序 取活动子窗口句柄, 整数型, , 返回活动窗口句柄，成功为非零值


.子程序 置活动子窗口, 整数型, , 成功为非零值
.参数 句柄, 整数型, , 



.子程序 取活动子窗口尺寸, 逻辑型, , 不含标题和边界，成功为真，否则为假
.参数 宽度, 整数型, 参考 可空, 
.参数 高度, 整数型, 参考 可空, 



.子程序 置活动窗口组件, 逻辑型, , 成功为真，否则为假
.参数 组件句柄, 整数型, , 
.参数 左边, 整数型, 可空, 默认为0
.参数 顶边, 整数型, 可空, 默认为0
.参数 宽度, 整数型, 可空, 默认为子窗口客户区宽度
.参数 高度, 整数型, 可空, 默认为子窗口客户区高度
.参数 是否重画, 整数型, 可空, 0或空为不重画，默认为不重画



.窗口程序集 窗口程序集1, , , 

.程序集变量 原窗口, 子程序指针, , , 
.程序集变量 MDI窗口类, MDI窗口类, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 x, 整数型, , , 
.局部变量 y, 整数型, , , 
.局部变量 x1, 整数型, , , 
.局部变量 y1, 整数型, , , 

 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

MDI窗口类.创建MDI客户区 (取窗口句柄 (), 0, 0, 取用户区宽度 (), 取用户区高度 (), 真, 2, , , , , , , )
赋值 (原窗口, SetWindowLongA (取窗口句柄 (), #GWL_WNDPROC, &处理))
赋值 (配置目录, 相加 (取运行目录 (), “\Photofilter.ini”))
赋值 (x, 到整数 (读配置项 (配置目录, “Photofilter”, “左边”, )))
赋值 (y, 到整数 (读配置项 (配置目录, “Photofilter”, “顶边”, )))
赋值 (x1, 到整数 (读配置项 (配置目录, “Photofilter”, “宽度”, )))
赋值 (y1, 到整数 (读配置项 (配置目录, “Photofilter”, “高度”, )))
.如果真 (并且 (等于 (x, -32000), 等于 (y, -32000)))
    连续赋值 (0, x, y, x1, y1)
.如果真结束

.如果真 (并且 (等于 (x, -4), 等于 (y, -4), 等于 (相减 (x1, 8), 取屏幕宽度 ()), 等于 (相减 (y1, 8), 取屏幕高度 ())))
    赋值 (., 3)
    返回 ()
.如果真结束

.如果真 (并且 (不等于 (x1, 0), 不等于 (y1, 0)))
    移动 (x, y, x1, y1)
.如果真结束
' 本源码来自易语言资源网(www.5A5X.com)
未知支持库函数_10 (取窗口句柄 (), 取窗口句柄 (), 0, #F5键)

.子程序 载入图片, 空白型, , 
.局部变量 dz, 文本型, , , 
.局部变量 文件名, 文本型, , , 
.局部变量 文件名2, 文本型, , , 

赋值 (dz, 读配置项 (配置目录, “Photofilter”, “现行图片”, ))
.如果真 (等于 (dz, “”))
    _选择照片_被选择 ()
    返回 ()
.如果真结束
.如果真 (不等于 (dz, “”))
    赋值 (文件名, dz)
    赋值 (现行图片, 文件名)
    .如果真 (是否已创建 (窗口1))
        窗口1.销毁 ()
    .如果真结束
    
    载入 (窗口1, , 假)
    赋值 (窗口1., 取简短文件名 (文件名))
    MDI窗口类.设置为子窗口 (窗口1.取窗口句柄 ())
    MDI窗口类.最大化活动子窗口 ()
    _启动窗口.获取焦点 ()
     ' 本源码来自易语言资源网(www.5A5X.com)
    赋值 (窗口1..图片, 读入文件 (文件名))
    清空 ()
    赋值 (文件名2, 寻找文件 (相加 (取文本左边 (文件名, 倒找文本 (文件名, “\”, , 假)), “\*.JPG”), ))
    赋值 (总数, 0)
    .判断循环首 (不等于 (文件名2, “”))
        赋值 (总数, 相加 (总数, 1))
        相加 (取文本左边 (文件名, 倒找文本 (文件名, “\”, , 假)), 文件名2).加入项目 ()
         ' 输出调试文本 (取文本左边 (文件名, 倒找文本 (文件名, “\”, , 假)) ＋ 文件名2)
        赋值 (文件名2, 寻找文件 ())
    .判断循环尾 ()
    赋值 (窗口1..内容, 取简短文件名 (文件名))
    更新信息 ()
.如果真结束


.子程序 _选择照片_被选择, 空白型, , 
.局部变量 文件名, 文本型, , , 
.局部变量 文件名2, 文本型, , , 

.如果真 (等于 (打开 (), 真))
    赋值 (文件名, .文件名)
    赋值 (现行图片, 文件名)
     ' 输出调试文本 (文件名, 现行图片)
    .如果真 (是否已创建 (窗口1))
        窗口1.销毁 ()
    .如果真结束
     ' 本源码来自易语言资源网(www.5A5X.com)
    载入 (窗口1, , 假)
    赋值 (窗口1., 取简短文件名 (文件名))
    MDI窗口类.设置为子窗口 (窗口1.取窗口句柄 ())
    MDI窗口类.最大化活动子窗口 ()
    _启动窗口.获取焦点 ()
    赋值 (窗口1..图片, 读入文件 (文件名))
    清空 ()
    赋值 (文件名2, 寻找文件 (相加 (取文本左边 (文件名, 倒找文本 (文件名, “\”, , 假)), “\*.JPG”), ))
    赋值 (总数, 0)
    .判断循环首 (不等于 (文件名2, “”))
        赋值 (总数, 相加 (总数, 1))
        相加 (取文本左边 (文件名, 倒找文本 (文件名, “\”, , 假)), 文件名2).加入项目 ()
         ' 输出调试文本 (取文本左边 (文件名, 倒找文本 (文件名, “\”, , 假)) ＋ 文件名2)
        赋值 (文件名2, 寻找文件 ())
    .判断循环尾 ()
    赋值 (窗口1..内容, 取简短文件名 (文件名))
    更新信息 ()
.如果真结束
_启动窗口.获取焦点 ()

.子程序 取现行位数, 整数型, , 
.局部变量 a, 整数型, , , 

.计次循环首 (取项目数 (), a)
    .如果真 (等于 (相减 (a, 1).取项目文本 (), 现行图片))
        跳出循环 ()
    .如果真结束
     ' 本源码来自易语言资源网(www.5A5X.com)
.计次循环尾 ()
返回 (a)

.子程序 取简短文件名, 文本型, , 
.参数 文件名, 文本型, , 

.局部变量 text1, 文本型, , , 
.局部变量 TEXT2, 文本型, , , 
.局部变量 TEXT3, 文本型, , , 

 ' 调试输出 (文件名)
赋值 (text1, 取文本右边 (文件名, 相减 (取文本长度 (文件名), 倒找文本 (文件名, “\”, , 假))))
 ' 调试输出 (text1)
赋值 (TEXT2, 取文本左边 (取文本左边 (文件名, 倒找文本 (文件名, “\”, , 假)), 相减 (取文本长度 (取文本左边 (文件名, 倒找文本 (文件名, “\”, , 假))), 1)))
 ' 调试输出 (TEXT2)
赋值 (TEXT3, 取文本右边 (TEXT2, 相减 (取文本长度 (TEXT2), 倒找文本 (TEXT2, “\”, , 假))))
 ' 调试输出 (TEXT3)
 ' 本源码来自易语言资源网(www.5A5X.com)
返回 (相加 (“\”, TEXT3, “\”, text1))

.子程序 __启动窗口_尺寸被改变, 空白型, , 
MDI窗口类.MDI客户区移动 (0, 0, 取用户区宽度 (), 取用户区高度 ())

.子程序 _垂直平铺窗口_被选择, 空白型, , 
MDI窗口类.垂直平铺窗口 ()
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _水平平铺窗口_被选择, 空白型, , 
MDI窗口类.水平平铺窗口 ()

.子程序 _最大化活动子窗口_被选择, 空白型, , 
MDI窗口类.最大化活动子窗口 ()

.子程序 _最小化活动子窗口_被选择, 空白型, , 
MDI窗口类.最小化活动子窗口 ()

.子程序 处理, 整数型, , 
.参数 hwnd, 整数型, , 
.参数 Msg, 整数型, , 
.参数 wp, 整数型, , 
.参数 lp, 整数型, , 

.局部变量 a, MINMAXINFO, , , 

.判断开始 (等于 (Msg, 534))
    CopyMemory1 (a, lp, 40) ' 40为MINMAXINFO结构长度
     ' .如果真 (小于 (a.ptReserved.横向位置, 0))
         ' a.ptReserved.横向位置 ＝ 0
         ' a.ptMaxSize.横向位置 ＝ 0 ＋ 宽度
    .如果真结束
     ' .如果真 (小于 (a.ptReserved.纵向位置, 0))
         ' a.ptReserved.纵向位置 ＝ 0
         ' a.ptMaxSize.纵向位置 ＝ 0 ＋ 高度
    .如果真结束
     ' .如果真 (大于 (a.ptMaxSize.横向位置, 相减 (取屏幕宽度 (), 0)))
         ' a.ptReserved.横向位置 ＝ 取屏幕宽度 () － 0 － 宽度
         ' a.ptMaxSize.横向位置 ＝ 取屏幕宽度 () － 0
    .如果真结束
     ' .如果真 (大于 (a.ptMaxSize.纵向位置, 相减 (取屏幕高度 (), 0)))
         ' a.ptReserved.纵向位置 ＝ 取屏幕高度 () － 0 － 高度
         ' a.ptMaxSize.纵向位置 ＝ 取屏幕高度 () － 0
    .如果真结束
     ' CopyMemory (lp, a, 40)  ' 40为MINMAXINFO结构长度
.判断 (等于 (Msg, #WM_GETMINMAXINFO))
    CopyMemory1 (a, lp, 40) ' 40为MINMAXINFO结构长度
    赋值 (a.ptMinTrackSize.横向位置, 800) ' 最小X
    赋值 (a.ptMinTrackSize.纵向位置, 600) ' 最小Y
    赋值 (a.ptMaxTrackSize.横向位置, 取屏幕宽度 ()) ' 最大X
    赋值 (a.ptMaxTrackSize.纵向位置, 取屏幕高度 ()) ' 最大Y
    CopyMemory (lp, a, 40) ' 40为MINMAXINFO结构长度
    
.默认
     ' 本源码来自易语言资源网(www.5A5X.com)
.判断结束

返回 (CallWindowProcA (原窗口, hwnd, Msg, wp, lp))


.子程序 __启动窗口_可否被关闭, 逻辑型, , 
写配置项 (配置目录, “Photofilter”, “左边”, 到文本 (.))
写配置项 (配置目录, “Photofilter”, “顶边”, 到文本 (.))
写配置项 (配置目录, “Photofilter”, “宽度”, 到文本 (.))
写配置项 (配置目录, “Photofilter”, “高度”, 到文本 (.))
写配置项 (配置目录, “Photofilter”, “现行图片”, 到文本 (现行图片))

.子程序 __启动窗口_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #空格键), 等于 (键代码, #右光标键)))
    _后一张照片_被选择 ()
.如果真结束
.如果真 (等于 (键代码, #左光标键))
    _前一张照片_被选择 ()
.如果真结束
.如果真 (等于 (键代码, #下光标键))
    _自定义路径_被选择 ()
.如果真结束
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _退出_被选择, 空白型, , 
__启动窗口_可否被关闭 ()
结束 ()
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 __启动窗口_首次激活, 空白型, , 
载入图片 ()

.子程序 _关于我们_被选择, 空白型, , 
系统关于对话框 (取窗口句柄 (), “Photofilter”, “小草软件工作室 (C)2010 - 2015”, 0)

.子程序 _基本设置_被选择, 空白型, , 
 ' .如果真 (是否已创建 (窗口3))
     ' 窗口3.销毁 ()
.如果真结束
载入 (窗口3, _启动窗口, 真)
 ' MDI窗口类.设置为子窗口 (窗口3.取窗口句柄 ())
 ' MDI窗口类.最大化活动子窗口 ()
 ' _启动窗口.获取焦点 ()
 ' 窗口3.编辑框1.获取焦点 ()


.子程序 _标签1_反馈事件, 整数型, , 
.参数 参数一, 整数型, , 
.参数 参数二, 整数型, , 

__启动窗口_可否被关闭 ()
运行 (相加 (取运行目录 (), “\Restart.exe”), 假, )
 ' 本源码来自易语言资源网(www.5A5X.com)

.窗口程序集 窗口程序集2, , , 

.程序集变量 剪贴板操作类, 剪贴板操作类, , , 
.子程序 _窗口1_创建完毕, 空白型, , 
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

.置父窗口 ()
.置父窗口 ()
取窗口句柄 ().未知支持库函数_0 ()
剪贴板操作类.初始化 (取窗口句柄 ())

.子程序 _窗口1_尺寸被改变, 空白型, , 
0.移动 (0, 取用户区宽度 (), 取用户区高度 ())
 ' 透明标签1.移动 (取用户区宽度 () － 20 － 透明标签1.宽度, 取用户区高度 () － 8 － 透明标签1.高度, , )
0.移动 (相减 (取用户区高度 (), 8, .高度, .), 取用户区宽度 (), )
0.置宽度 (相减 (., 1.取宽度 ()))
1.置宽度 (120)
相减 (0.取宽度 (), .宽度, 10).移动 (相加 (0.取栏目顶边 (), 2), , )
相减 (0.取宽度 (), .宽度, 10, .宽度, 10).移动 (相加 (0.取栏目顶边 (), 2), , )
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _图片框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (小于 (横向位置, 相除 (取用户区宽度 (), 2)))
    _前一张照片_被选择 ()
.判断 (大于 (横向位置, 相除 (取用户区宽度 (), 2)))
    _后一张照片_被选择 ()
.默认
    ' 本源码来自易语言资源网(www.5A5X.com)
.判断结束


.子程序 _图片框1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (读配置项 (配置目录, “Photofilter”, “自定义路径”, ), “”))
    赋值 (.标题, “自定义路径”)
.否则
    赋值 (.标题, 取简短文件名 (读配置项 (配置目录, “Photofilter”, “自定义路径”, )))
.如果结束
 ' 本源码来自易语言资源网(www.5A5X.com)
.如果 (等于 (读配置项 (配置目录, “Photofilter”, “自定义路径”, ), “”))
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
.如果结束

赋值 (.标题, 取文本右边 (现行图片, 相减 (取文本长度 (现行图片), 倒找文本 (现行图片, “\”, , 假))))
弹出菜单 (取鼠标水平位置 (), 取鼠标垂直位置 ())

.子程序 _删除照片_被选择, 空白型, , 
.如果真 (是否已创建 (窗口1))
    .如果真 (不等于 (现行图片, “”))
        .如果真 (等于 (信息框 (相加 (“你确定要删除”, #左引号, 取简短文件名 (现行图片), #右引号, “吗？”), 1, “删除照片”), 0))
            删除文件 (现行图片)
            _后一张照片_被选择 ()
        .如果真结束
         ' 本源码来自易语言资源网(www.5A5X.com)
    .如果真结束
    
.如果真结束


.子程序 _前一张照片_被选择, 空白型, , 
.局部变量 n, 整数型, , , 
.局部变量 文件名, 文本型, , , 

.如果真 (是否已创建 (窗口1))
     ' 调试输出 (现行图片)
     ' 调试输出 (列表框1.取项目数 ())
    .如果真 (等于 (_启动窗口.取项目文本 (., 0), 现行图片))
        赋值 (文件名, _启动窗口.取项目文本 (., 相减 (_启动窗口.取项目数 (.), 1)))
         ' 调试输出 (文件名)
        赋值 (现行图片, 文件名)
        赋值 (窗口1..图片, 读入文件 (文件名))
        赋值 (窗口1..内容, 取简短文件名 (文件名))
         ' 输出调试文本 (文件名)
        0.置文本 (相加 (“拍摄时间：”, 到文本 (取文件时间 (现行图片))))
        窗口1.置文本 (., 1, 相加 (“第”, 到文本 (取现行位数 ()), “张\共”, 到文本 (总数), “张”))
        返回 ()
    .如果真结束
    ' 本源码来自易语言资源网(www.5A5X.com)
    .计次循环首 (_启动窗口.取项目数 (.), n)
         ' 调试输出 (列表框1.取项目文本 (n ＋ 1))
         ' 输出调试文本 (n)
        .如果真 (等于 (_启动窗口.取项目文本 (., 相减 (n, 1)), 现行图片))
            赋值 (文件名, _启动窗口.取项目文本 (., 相减 (n, 2)))
             ' 调试输出 (文件名)
            赋值 (现行图片, 文件名)
            赋值 (窗口1..图片, 读入文件 (文件名))
            赋值 (窗口1..内容, 取简短文件名 (文件名))
            输出调试文本 (文件名)
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
    更新信息 ()
.如果真结束


.子程序 _后一张照片_被选择, 空白型, , 
.局部变量 n, 整数型, , , 
.局部变量 文件名, 文本型, , , 

.如果真 (是否已创建 (窗口1))
     ' 调试输出 (现行图片)
     ' 调试输出 (列表框1.取项目数 ())
    .如果真 (等于 (_启动窗口.取项目文本 (., 相减 (_启动窗口.取项目数 (.), 1)), 现行图片))
        赋值 (文件名, _启动窗口.取项目文本 (., 0))
         ' 调试输出 (文件名)
        赋值 (现行图片, 文件名)
        赋值 (窗口1..图片, 读入文件 (文件名))
        赋值 (窗口1..内容, 取简短文件名 (文件名))
         ' 输出调试文本 (文件名)
        0.置文本 (相加 (“拍摄时间：”, 到文本 (取文件时间 (现行图片))))
        窗口1.置文本 (., 1, 相加 (“第”, 到文本 (取现行位数 ()), “张\共”, 到文本 (总数), “张”))
        返回 ()
    .如果真结束
    .计次循环首 (_启动窗口.取项目数 (.), n)
         ' 调试输出 (列表框1.取项目文本 (n ＋ 1))
         ' 输出调试文本 (n)
        .如果真 (等于 (_启动窗口.取项目文本 (., 相减 (n, 1)), 现行图片))
            赋值 (文件名, _启动窗口.取项目文本 (., n))
             ' 调试输出 (文件名)
            赋值 (现行图片, 文件名)
            赋值 (窗口1..图片, 读入文件 (文件名))
            赋值 (窗口1..内容, 取简短文件名 (文件名))
             ' 输出调试文本 (文件名)
            跳出循环 ()
        .如果真结束
        ' 本源码来自易语言资源网(www.5A5X.com)
    .计次循环尾 ()
    更新信息 ()
.如果真结束


.子程序 _超级链接框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

未知支持库函数_6 (2, 取文本左边 (现行图片, 倒找文本 (现行图片, “\”, , 假)), , , )
 ' .如果真 (是否已创建 ())
     ' 窗口2.销毁 ()
.如果真结束
' 本源码来自易语言资源网(www.5A5X.com)
 ' 载入 (窗口2, , 假)
 ' 窗口2.标题 ＝ 取文本左边 (现行图片, 倒找文本 (现行图片, “\”, , 假))
 ' 窗口2.超文本浏览框1.地址 ＝ 取文本左边 (现行图片, 倒找文本 (现行图片, “\”, , 假))
 ' _启动窗口.MDI窗口类.设置为子窗口 (窗口2.取窗口句柄 ())

 ' _启动窗口.获取焦点 ()

.子程序 _超级链接框2_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (不等于 (读配置项 (配置目录, “Photofilter”, “自定义路径”, ), “”))
     ' .如果真 (是否已创建 ())
         ' 窗口4.销毁 ()
    .如果真结束
    ' 本源码来自易语言资源网(www.5A5X.com)
     ' 载入 (窗口4, , 假)
     ' 窗口4.标题 ＝ 读配置项 (配置目录, “Photofilter”, “自定义路径”, )
     ' 窗口4.超文本浏览框1.地址 ＝ 读配置项 (配置目录, “Photofilter”, “自定义路径”, )
     ' _启动窗口.MDI窗口类.设置为子窗口 (窗口4.取窗口句柄 ())
    
     ' _启动窗口.获取焦点 ()
    创建目录 (读配置项 (配置目录, “Photofilter”, “自定义路径”, ))
    未知支持库函数_6 (2, 读配置项 (配置目录, “Photofilter”, “自定义路径”, ), , , )
.否则
    信息框 (相加 (“请在 ”, #左引号, “设置”, #右引号, “==>”, #左引号, “基本设置”, #右引号, “ 中设置复制自定义路径！”), #警告图标, “复制失败”)
.如果结束


.子程序 _拖放对象1_得到文件, 空白型, , 
.参数 接收到的文件路径, 文本型, , 

.局部变量 text1, 文本型, , , 
.局部变量 text2, 文本型, , , 
.局部变量 文件名, 文本型, , , 
.局部变量 文件名2, 文本型, , , 

 ' 输出调试文本 (接收到的文件路径)
赋值 (text1, 取文本右边 (接收到的文件路径, 相减 (取文本长度 (接收到的文件路径), 倒找文本 (接收到的文件路径, “\”, , 假))))
赋值 (text2, 到大写 (取文本右边 (text1, 相减 (取文本长度 (text1), 倒找文本 (text1, “.”, , 假)))))
输出调试文本 (text2)
.如果真 (等于 (text2, “JPG”))
    赋值 (文件名, 接收到的文件路径)
    赋值 (现行图片, 文件名)
    .如果真 (是否已创建 (窗口1))
        窗口1.销毁 ()
    .如果真结束
    ' 本源码来自易语言资源网(www.5A5X.com)
    载入 (窗口1, , 假)
    赋值 (窗口1., 取简短文件名 (文件名))
    _启动窗口.设置为子窗口 (., 窗口1.取窗口句柄 ())
    _启动窗口.最大化活动子窗口 (.)
    _启动窗口.获取焦点 ()
    赋值 (窗口1..图片, 读入文件 (文件名))
    _启动窗口.清空 (.)
    赋值 (文件名2, 寻找文件 (相加 (取文本左边 (文件名, 倒找文本 (文件名, “\”, , 假)), “\*.JPG”), ))
    赋值 (总数, 0)
    .判断循环首 (不等于 (文件名2, “”))
        赋值 (总数, 相加 (总数, 1))
        _启动窗口.加入项目 (., 相加 (取文本左边 (文件名, 倒找文本 (文件名, “\”, , 假)), 文件名2), )
        输出调试文本 (相加 (取文本左边 (文件名, 倒找文本 (文件名, “\”, , 假)), 文件名2))
        赋值 (文件名2, 寻找文件 ())
    .判断循环尾 ()
    赋值 (窗口1..内容, 取简短文件名 (文件名))
    更新信息 ()
.如果真结束


.子程序 更新信息, 空白型, , 
窗口1.置文本 (., 0, 相加 (“拍摄时间：”, 到文本 (取文件时间 (现行图片))))
窗口1.置文本 (., 1, 相加 (“第”, 到文本 (取现行位数 ()), “张\共”, 到文本 (总数), “张”))
赋值 (_启动窗口..初始目录, 取文本左边 (现行图片, 倒找文本 (现行图片, “\”, , 假)))

.子程序 _复制_被选择, 空白型, , 
输出调试文本 (现行图片)
剪贴板操作类.置数据_文件 (现行图片)
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _系统桌面_被选择, 空白型, , 
复制文件 (现行图片, 相加 (未知支持库函数_7 (3), “\”, 取文本右边 (现行图片, 相减 (取文本长度 (现行图片), 倒找文本 (现行图片, “\”, , 假)))))
_后一张照片_被选择 ()

.子程序 _自定义路径_被选择, 空白型, , 
.如果 (不等于 (读配置项 (配置目录, “Photofilter”, “自定义路径”, ), “”))
    创建目录 (读配置项 (配置目录, “Photofilter”, “自定义路径”, ))
    复制文件 (现行图片, 相加 (读配置项 (配置目录, “Photofilter”, “自定义路径”, ), “\”, 取文本右边 (现行图片, 相减 (取文本长度 (现行图片), 倒找文本 (现行图片, “\”, , 假)))))
    _后一张照片_被选择 ()
.否则
    信息框 (相加 (“请在 ”, #左引号, “设置”, #右引号, “==>”, #左引号, “基本设置”, #右引号, “ 中设置复制自定义路径！”), #警告图标, “复制失败”)
.如果结束
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _图片名称_被选择, 空白型, , 
未知支持库函数_6 (4, 现行图片, , , )

.窗口程序集 窗口程序集4, , , 

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 a, 文本型, , , 

赋值 (a, 未知支持库函数_2 (“选择照片自定义复制目录”, ))
.如果真 (不等于 (a, “”))
    赋值 (.内容, a)
    赋值 (a, “”)
.如果真结束
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--


.子程序 _按钮2_被单击, 空白型, , 
写配置项 (配置目录, “Photofilter”, “自定义路径”, .内容)
销毁 ()
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _窗口3_创建完毕, 空白型, , 
赋值 (.内容, 读配置项 (配置目录, “Photofilter”, “自定义路径”, ))

.类模块 剪贴板操作类, , , Clipboard

.子程序 初始化, 空白型, , 
.参数 窗口句柄, 整数型, , 



.子程序 打开, 逻辑型, , OpenClipboard


.子程序 关闭, 整数型, , CloseClipboard


.子程序 清空, 整数型, , EmptyClipboard


.子程序 取格式名称, 文本型, , GetClipboardFormatName
.参数 lFormatID, 整数型, , 



.子程序 取当前可用格式数量, 整数型, , CountClipboardFormats


.子程序 取数据, 整数型, , GetClipboardData
.参数 剪贴板格式, 整数型, , 



.子程序 置数据, 整数型, , SetClipboardData
.参数 剪贴板格式, 整数型, , 
.参数 数据地址, 整数型, , 



.子程序 枚举当前可用格式, 整数型, , EnumClipboardFormats
.参数 结果数组, 整数型, 数组, 请提供变量



.子程序 取数据_HTML, 文本型, , 取已经复制到剪贴板的HTML数据


.子程序 取数据_网页图片, 字节集, , 取已经复制到剪贴板的网页图片数据


.子程序 取数据_位图, 字节集, , 


.子程序 取数据_文件, 整数型, , 取已经复制到剪贴板的文件名，返回文件数
.参数 文件数组, 文本型, 参考 数组, 返回的文件名数组，只能提供变量



.子程序 取数据_文本, 文本型, , 返回存放于当前 Windows 系统剪辑板中的文本。如果当前剪辑板中无文本数据，将返回空文本。


.子程序 置数据_文件, 空白型, , 
.参数 欲复制的文件名, 文本型, , 



.子程序 置数据_位图, 空白型, , 
.参数 位图数据, 字节集, , 



.子程序 置数据_文本, 空白型, , 将指定文本存放到当前 Windows 系统剪辑板中去，剪辑板中的原有内容被覆盖
.参数 准备置入剪辑板的文本, 文本型, , 




 ' 不属于任何一个程序集、类模块的函数：
