 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 647
    高度 = 476
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口2
    左边 = 50
    顶边 = 50
    宽度 = 655
    高度 = 608
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.常量 搜索地址, "“http://search.zol.com.cn/s/product_more.php?kword=”", , 
.常量 头, "“<div class="main clearfix">”", , 
.常量 尾, "“<em class="close"></em> ”", , 
.常量 正则头, "“<dd><a href="”", , 
.常量 正则尾, "“" target="_blank">详细参数”", , 
.常量 正则符, "“(.*?)”", , 
.常量 替换地址, "“http://detail.zol.com.cn/param_copy_*****_blue_4_10_560.html”", , 
.常量 最终结果, "“
<div id="layoutTab" style="margin:0px auto;width:560px;font:14px/26px;border:1px solid #aac4e5; background-color:#aac4e5;overflow:hidden;">
<table style="border:2px solid #aac4e5;font-size:12px;color:#333;" width="100%" cellpadding="0" cellspacing="1">


”", , 
.常量 内容中a, "“	<tr><td colspan="2"  style="line-height:26px;padding:0 5px;padding:10px 0;font-size:12px;text-align:center;" bgcolor="#ffffff">”", , 
.常量 内容中b, "“<B>手机附件</B>”", , 
.常量 替换内容中a, "“<tr style="padding:5px 5px;"><td colspan="2" style="background:#f2f7fd;"><B>基本参数</B>”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' iconv {A0005538-9391-4dd9-B4D6-8EB7B9360F08} 2 0 编码转换支持库
 ' internet 707ca37322474f6ca841f0e224f4b620 2 0 互联网支持库
 ' RegEx 684944CB04624eb7BD5412A519421D34 2 0 正则表达式支持库
 ' HtmlView 5014D8FA6DCA40b68FA626D8183666EB 1 2 超文本浏览框




.全局变量 搜索全文, 文本型, , , 
.全局变量 框架出来了, 文本型, , , 
.全局变量 全局, 整数型, , , 

.DLL命令 Api_CreateThread, 整数型, "", "CreateThread", , 
    .参数 lpThreadAttributes, 整数型, , 
    .参数 dwStackSize, 整数型, , 
    .参数 lpStartAddress, 子程序指针, , 
    .参数 lpParameter, 整数型, , 
    .参数 dwCreationFlags, 整数型, , 
    .参数 lpThreadId, 整数型, 传址, 

.DLL命令 DLL命令1, 空白型, "", "", , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 消息传递, 字节集, , , 
.程序集变量 数据组, 文本型, , "0", 
.子程序 __启动窗口_创建完毕, 空白型, , 


.子程序 _按钮3_被单击, 空白型, , 
启动多线程 (&搜索子程序)

.子程序 搜索子程序, 空白型, , 
.局部变量 c, 整数型, , , 
.局部变量 v, 整数型, , , 
.局部变量 b, 整数型, , , 
.局部变量 m, 字节型, , , 
.局部变量 n, 整数型, , , 
.局部变量 正则, 未知类型0x50001, , , 
.局部变量 结果, 未知类型0x50002, , "0", 
.局部变量 文本, 文本型, , , 
.局部变量 加入项目, 文本型, , , 

赋值 (搜索全文, “”)
赋值 (.内容, “正在搜索,请稍等...”)
赋值 (搜索全文, 到文本 (未知支持库函数_7 (相加 (#搜索地址, URL网址编码 (.内容)))))
赋值 (c, 寻找文本 (搜索全文, #头, , 假))
赋值 (v, 寻找文本 (搜索全文, #尾, , 假))
赋值 (搜索全文, 取文本中间 (搜索全文, c, 相减 (v, c)))
正则.未知支持库函数_3 (相加 (#正则头, #正则符, #正则尾), 假)
赋值 (结果, 正则.未知支持库函数_16 (搜索全文))
.计次循环首 (取数组成员数 (结果), b)
    赋值 (文本, 结果.未知支持库函数_12 ( [b], 搜索全文, 1, ))
    赋值 (.内容, 相加 (“正在搜索  ”, 到文本 (b), “ 条”))
    赋值 (m, 寻找文本 (文本, “http://”, , 假))
    赋值 (n, 寻找文本 (文本, “target”, , 假))
    赋值 (加入项目, 取文本中间 (文本, m, 相减 (n, m)))
    子文本替换 (加入项目, #引号, “”, , , 真).加入项目 ()
    .判断开始 (等于 (b, 取数组成员数 (结果)))
        赋值 (.内容, 相加 (“搜索完成,共计  ”, 到文本 (b), “ 条”))
    .默认
        
    .判断结束
    
.计次循环尾 ()
 ' NOKIA N8    http://detail.zol.com.cn/mobile-laoding/index282466.shtml

.子程序 _列表框7_列表项被选择, 空白型, , 
.局部变量 c, 整数型, , , 
.局部变量 v, 整数型, , , 
.局部变量 项目文本, 文本型, , , 
.局部变量 跳转, 文本型, , , 
.局部变量 修改文本, 文本型, , , 
.局部变量 n, 整数型, , , 
.局部变量 m, 整数型, , , 
.局部变量 中心内容, 文本型, , , 
.局部变量 最终内容, 文本型, , , 

赋值 (全局, 1)
赋值 (项目文本, .取项目文本 (.现行选中项))
赋值 (c, 寻找文本 (项目文本, “index”, , 假))
赋值 (v, 寻找文本 (项目文本, “.shtml”, , 假))
赋值 (跳转, 取文本中间 (项目文本, 相加 (c, 5), 相减 (v, c, 5)))
赋值 (跳转, 子文本替换 (#替换地址, “*****”, 跳转, , , 真))
赋值 (修改文本, 到文本 (未知支持库函数_7 (跳转)))
赋值 (n, 寻找文本 (修改文本, #内容中a, , 假))
赋值 (m, 寻找文本 (修改文本, #内容中b, , 假))
赋值 (中心内容, 取文本中间 (修改文本, n, 相减 (m, n)))
.判断开始 (不等于 (中心内容, “”))
    赋值 (框架出来了, 相加 (#最终结果, 中心内容))
.默认
    赋值 (n, 寻找文本 (修改文本, #替换内容中a, , 假))
    赋值 (m, 寻找文本 (修改文本, #内容中b, , 假))
    赋值 (中心内容, 取文本中间 (修改文本, n, 相减 (m, n)))
    赋值 (框架出来了, 相加 (#最终结果, 中心内容))
.判断结束
.判断开始 (等于 (载入 (窗口2, , 假), 真))
    赋值 (窗口2.., 跳转)
.默认
    
.判断结束



.程序集 功能程序集, , , 

.子程序 URL网址utf8编码, 文本型, , utf8编码转换成网址编码
.参数 原文本, 文本型, , 

.局部变量 局部_数据, 字节集, , , 
.局部变量 i, 整数型, , , 
.局部变量 ii, 文本型, , , 

赋值 (局部_数据, 到字节集 (原文本)) ' 一般的网站这样就可以
赋值 (局部_数据, 未知支持库函数_0 (局部_数据, #, #, )) ' 这一句支持google.cn,因为google.cn现在是utf8编码
.计次循环首 (取字节集长度 (局部_数据), i)
    赋值 (ii, 相加 (ii, “%”, 取十六进制文本 (局部_数据 [i])))
.计次循环尾 ()
返回 (ii)

.子程序 启动多线程, 整数型, , 创建一个线程来启动子程序(返回线程句柄)
.参数 线程子程序, 子程序指针, , 欲启动的线程子程序指针
.参数 传递参数, 整数型, 可空, 

.局部变量 线程号, 整数型, , , 

返回 (Api_CreateThread (0, 0, 线程子程序, 传递参数, 0, 线程号))

.子程序 URL网址编码, 文本型, , 普通文本转换成网址编码
.参数 原文本, 文本型, , 

.局部变量 局部_数据, 字节集, , , 
.局部变量 i, 整数型, , , 
.局部变量 ii, 文本型, , , 

赋值 (局部_数据, 到字节集 (原文本)) ' 一般的网站这样就可以
.计次循环首 (取字节集长度 (局部_数据), i)
    赋值 (ii, 相加 (ii, “%”, 取十六进制文本 (局部_数据 [i])))
.计次循环尾 ()
返回 (ii)

.子程序 返回时间, 文本型, , 
返回 (相加 (到文本 (取年份 (取现行时间 ())), “-”, 到文本 (取月份 (取现行时间 ())), “-”, 到文本 (取日 (取现行时间 ())), “ ”, 到文本 (取小时 (取现行时间 ())), “:”, 到文本 (取分钟 (取现行时间 ())), “:”, 到文本 (取秒 (取现行时间 ()))))

.窗口程序集 窗口程序集3, , , 

.子程序 _窗口2_创建完毕, 空白型, , 
0.移动 (0, 相减 (窗口2., 5), 相减 (窗口2., 60))

.子程序 _窗口2_尺寸被改变, 空白型, , 
0.移动 (0, 相减 (窗口2., 5), 相减 (窗口2., 60))

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()


 ' 不属于任何一个程序集、类模块的函数：
