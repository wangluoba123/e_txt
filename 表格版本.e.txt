 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 1024
    高度 = 768
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 登陆窗口
    左边 = 50
    顶边 = 50
    宽度 = 666
    高度 = 332
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\表格版本.e\登陆窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 图片窗口
    左边 = 50
    顶边 = 50
    宽度 = 590
    高度 = 452
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “单击鼠标右键出现选择虚线框,左键按下移动,可以调整大小,双击保存图像!”
    帮助文件名 = “”

窗口 设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 455
    高度 = 311
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假



.图片 表2, " ' 已保存到：D:\易语言学习\Data\表格版本.e\表2", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' eImgConverter 8FA3AA46276847db8F28E57E7FB97B7F 1 0 图像格式转换支持库
 ' BmpOperate 42305932-06E6-47a5-AC79-8BDCDC58DF61 1 0 位图操作支持库
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库



 ' 所需要的模块
 ' 打印预览2.45 D:\孟\易工作目录\医务科\打印预览 2.45.ec


.全局变量 当前用户, 文本型, , , 
.全局变量 图片临时文件, 文本型, , , 
.全局变量 名称, 文本型, , , 
.全局变量 注册, 逻辑型, , , 
.全局变量 图片名, 文本型, , , 

.窗口程序集 主窗口程序集, , , 

.程序集变量 ff, 未知类型0x30004, , , 
.程序集变量 调整高度, 整数型, , , 
.程序集变量 记录, 整数型, , , 
.程序集变量 当前编号, 文本型, , , 
.程序集变量 当前位置, 文本型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
未知支持库函数_0 (1)
载入 (登陆窗口, , 真)
赋值 (ff., 12)
赋值 (ff., “宋体”)
ff.未知支持库函数_8 ()
ff.未知支持库函数_8 ()
ff.未知支持库函数_8 ()
ff.未知支持库函数_8 ()
ff.未知支持库函数_8 ()
赋值 (.最大位置, 取绝对值 (相减 (.高度, 4, .高度)))
赋值 (调整高度, 20)
相加 (取运行目录 (), “\sfjd.mdb”).打开MDB数据库 ()
赋值 (.内容, 名称)
赋值 (_启动窗口., 相加 (子文本替换 (名称, “ ”, “”, , , 真), “ 当前用户: ”, 当前用户))

.子程序 _图片框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (图片窗口, , 真)

.子程序 _简要案情超级编辑框_内容被改变, 空白型, , 
.局部变量 原始高度, 整数型, , , 
.局部变量 ttt, 整数型, , , 

赋值 (原始高度, .)
赋值 (ttt, 相减 (相乘 (未知支持库函数_1 (), 调整高度), 原始高度))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (., 相加 (., ttt))
赋值 (., 相加 (., ttt))
赋值 (., 相加 (., ttt))
赋值 (., 相加 (., ttt))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.高度, 相加 (.高度, ttt))
赋值 (.最大位置, 取绝对值 (相减 (.高度, 4, .高度)))
赋值 (., 相乘 (未知支持库函数_1 (), 调整高度))
 ' 提示标签.标题 ＝ 到文本 (原始高度) ＋ “ | ” ＋ 到文本 (简要案情超级编辑框.取行数 ()) ＋ “ | ” ＋ 到文本 (简要案情超级编辑框.高度) ＋ “  | ” ＋ 到文本 (调整高度) ＋ “ | ” ＋ 到文本 (ttt)

.子程序 _纵向滚动条_位置被改变, 空白型, , 
赋值 (.顶边, 相减 (2, .位置))


.子程序 _病历摘要超级编辑框_内容被改变, 空白型, , 
.局部变量 原始高度, 整数型, , , 
.局部变量 ttt, 整数型, , , 

赋值 (原始高度, .)
赋值 (ttt, 相减 (相乘 (未知支持库函数_1 (), 调整高度), 原始高度))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (., 相加 (., ttt))
赋值 (., 相加 (., ttt))
赋值 (., 相加 (., ttt))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.高度, 相加 (.高度, ttt))
赋值 (., 相乘 (未知支持库函数_1 (), 调整高度))
赋值 (.最大位置, 取绝对值 (相减 (.高度, 4, .高度)))

.子程序 _法医检验超级编辑框_内容被改变, 空白型, , 
.局部变量 原始高度, 整数型, , , 
.局部变量 ttt, 整数型, , , 

赋值 (原始高度, .)
赋值 (ttt, 相减 (相乘 (未知支持库函数_1 (), 调整高度), 原始高度))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (., 相加 (., ttt))
赋值 (., 相加 (., ttt))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.高度, 相加 (.高度, ttt))
赋值 (., 相乘 (未知支持库函数_1 (), 调整高度))
赋值 (.最大位置, 取绝对值 (相减 (.高度, 4, .高度)))

.子程序 _分析说明超级编辑框_内容被改变, 空白型, , 
.局部变量 原始高度, 整数型, , , 
.局部变量 ttt, 整数型, , , 

赋值 (原始高度, .)
赋值 (ttt, 相减 (相乘 (未知支持库函数_1 (), 调整高度), 原始高度))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (., 相加 (., ttt))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.高度, 相加 (.高度, ttt))
赋值 (., 相乘 (未知支持库函数_1 (), 调整高度))
赋值 (.最大位置, 取绝对值 (相减 (.高度, 4, .高度)))

.子程序 _鉴定结论超级编辑框_内容被改变, 空白型, , 
.局部变量 原始高度, 整数型, , , 
.局部变量 ttt, 整数型, , , 

赋值 (原始高度, .)
赋值 (ttt, 相减 (相乘 (未知支持库函数_1 (), 调整高度), 原始高度))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.顶边, 相加 (.顶边, ttt))
赋值 (.高度, 相加 (.高度, ttt))
赋值 (., 相乘 (未知支持库函数_1 (), 调整高度))
赋值 (.最大位置, 取绝对值 (相减 (.高度, 4, .高度)))

.子程序 文本分行, 文本型, , 把一段长文本按你指定的字数分行
.参数 要处理的文本, 文本型, , 
.参数 是否全角, 逻辑型, 可空, 是否将半角转换为全角,如果为空即不转换
.参数 每行字数, 整数型, 可空, 半角字数，如果为空，将不进行分行操作，直接返回文本内容。
.参数 首空字节数, 整数型, 可空, 在每行前面加入空格,如果为空,为0,即不加空格
.参数 是否强行分行, 逻辑型, 可空, 为真则强行按设定长度分行。为假则保留连续半角数字或字母为一行。默认为假。

.局部变量 结果文本, 文本型, , , 
.局部变量 开始位置, 整数型, , , 
.局部变量 读取长度, 整数型, , , 
.局部变量 半角位置, 整数型, , , 
.局部变量 容器1, 整数型, , , 

赋值 (要处理的文本, 子文本替换 (要处理的文本, #换行符, “”, , , 真))
 ' 要处理的文本 ＝ 子文本替换 (要处理的文本, 字符 (10), “”, , , 真)
赋值 (要处理的文本, 删首尾空 (要处理的文本))
.如果真 (是否为空 (每行字数))
    返回 (要处理的文本)
.如果真结束
.如果真 (是否为空 (是否强行分行))
    赋值 (是否强行分行, 假)
.如果真结束

.如果真 (等于 (是否全角, 真))
    赋值 (要处理的文本, 子文本替换 (要处理的文本, “...”, “…”, 1, , 真))
    赋值 (要处理的文本, 子文本替换 (要处理的文本, “->”, “→”, 1, , 真))
    赋值 (要处理的文本, 子文本替换 (要处理的文本, “<-”, “←”, 1, , 真))
    赋值 (要处理的文本, 子文本替换 (要处理的文本, “--”, “―”, 1, , 真))
    赋值 (要处理的文本, 到全角 (要处理的文本))
.如果真结束

.如果真 (大于或等于 (首空字节数, 1))
    赋值 (要处理的文本, 相加 (取空白文本 (首空字节数), 要处理的文本))
    赋值 (要处理的文本, 子文本替换 (要处理的文本, #换行符, 相加 (#换行符, 取空白文本 (首空字节数)), 1, , 真))
.如果真结束

赋值 (结果文本, 要处理的文本)
赋值 (开始位置, 1)
.判断循环首 (大于 (相减 (取文本长度 (结果文本), 开始位置), 每行字数))
    .判断循环首 (小于 (读取长度, 每行字数))
        .如果 (大于或等于 (取代码 (结果文本, 相加 (开始位置, 读取长度)), 127))
            赋值 (读取长度, 相加 (读取长度, 2))
        .否则
            .如果 (等于 (取文本中间 (结果文本, 相加 (开始位置, 读取长度), 1), “ ”))
                赋值 (读取长度, 相加 (读取长度, 1))
            .否则
                .如果 (不等于 (取文本中间 (结果文本, 相加 (开始位置, 读取长度), 2), #换行符))
                    赋值 (半角位置, 读取长度)
                    赋值 (读取长度, 相加 (读取长度, 1))
                    .判断循环首 (并且 (小于 (取代码 (结果文本, 相加 (开始位置, 读取长度)), 127), 不等于 (取文本中间 (结果文本, 相加 (开始位置, 读取长度), 1), “ ”)))
                        .如果 (不等于 (取文本中间 (结果文本, 相加 (开始位置, 读取长度), 2), #换行符))
                            .如果 (大于或等于 (读取长度, 每行字数))
                                跳出循环 ()
                            .否则
                                赋值 (读取长度, 相加 (读取长度, 1))
                            .如果结束
                            
                        .否则
                            赋值 (开始位置, 相加 (开始位置, 读取长度, 2))
                            赋值 (读取长度, 0)
                            跳出循环 ()
                        .如果结束
                        
                    .判断循环尾 ()
                    .判断开始 (大于或等于 (读取长度, 每行字数))
                        .如果 (等于 (是否强行分行, 假))
                            赋值 (读取长度, 选择 (等于 (半角位置, 0), 每行字数, 半角位置))
                        .否则
                            赋值 (读取长度, 每行字数)
                        .如果结束
                        跳出循环 ()
                    .判断 (并且 (小于 (读取长度, 每行字数), 等于 (取文本中间 (结果文本, 相加 (开始位置, 读取长度), 1), “ ”)))
                        赋值 (读取长度, 相加 (读取长度, 1))
                    .默认
                        
                    .判断结束
                    
                .否则
                    赋值 (开始位置, 相加 (开始位置, 读取长度, 2))
                    赋值 (读取长度, 0)
                .如果结束
                
            .如果结束
            
        .如果结束
        .如果真 (并且 (等于 (读取长度, 相减 (每行字数, 1)), 大于或等于 (取代码 (结果文本, 相加 (开始位置, 读取长度)), 127)))
            跳出循环 ()
        .如果真结束
        
    .判断循环尾 ()
    赋值 (结果文本, 相加 (取文本左边 (结果文本, 相减 (相加 (开始位置, 读取长度), 1)), #换行符, 取文本右边 (结果文本, 相加 (相减 (取文本长度 (结果文本), 读取长度, 开始位置), 1))))
    赋值 (开始位置, 相加 (开始位置, 读取长度, 2))
    赋值 (读取长度, 0)
.判断循环尾 ()
赋值 (结果文本, 子文本替换 (结果文本, #换行符, “”, 相减 (取文本长度 (结果文本), 2), 1, 真))
返回 (结果文本)

.子程序 _工具条_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.判断开始 (等于 (按钮索引, 0))
    连续赋值 (“”, .内容, .内容, ., ., ., ., ., .内容, .内容, .内容, .内容, .内容)
    赋值 (.图片, {  })
    赋值 (.今天, 取日期 (取现行时间 ()))
    赋值 (.今天, 取日期 (取现行时间 ()))
    连续赋值 (调整高度, ., ., ., ., .)
    赋值 (.可视, 真)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    新建 ()
.判断 (等于 (按钮索引, 1))
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 真)
    查阅 ()
.判断 (等于 (按钮索引, 2))
    载入 (设置窗口, , 真)
.默认
    
.判断结束


.子程序 新建, 空白型, , 
赋值 (.可视, 真)
赋值 (.可视, 真)
赋值 (.可视, 假)
赋值 (.字体大小, 假)

.子程序 查阅, 空白型, , 
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.字体大小, 真)
赋值 (.可视, 真)

.子程序 _报表按钮_被单击, 空白型, , 
打印超级列表框 ()

.子程序 _保存按钮_被单击, 空白型, , 
.如果 (相加 (“insert into 数据表 (鉴定书编号,委托人,受鉴定人,受理时间,鉴定书发放日期,书写员,最后修改日期,可视,简要案情,病历摘要,法医检验,分析说明,鉴定结论,鉴定人员1,鉴定人员2,最后修改动作,图片名,检查项目,地点) values ('”, .内容, “','”, .内容, “','”, .内容, “','”, 到文本 (取日期 (.今天)), “','”, 到文本 (取日期 (.今天)), “','”, 当前用户, “','”, 到文本 (取现行时间 ()), “','”, “真”, “','”, ., “','”, ., “','”, ., “','”, ., “','”, ., “','”, .内容, “','”, .内容, “','”, “存”, “','”, 图片名, “','”, .内容, “','”, .内容, “') ”).执行 ())
    .如果 (等于 (信息框 (“你要立即打印吗?”, 相加 (#询问图标, #确认取消钮), “打印提示”), 1))
        
    .否则
        打印 ()
    .如果结束
    赋值 (图片名, “”)
    _工具条_被单击 (0)
.否则
    信息框 (“数据存储失败!请检查数据填写是否完整!”, 0, )
    返回 ()
.如果结束


.子程序 _搜索按钮_被单击, 空白型, , 
.局部变量 查询选择, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 文本变量2, 文本型, , , 
.局部变量 文本变量3, 文本型, , , 
.局部变量 文本变量4, 文本型, , , 

赋值 (查询选择, “where 可视='真'”)
.如果 (等于 (.选中, 真))
    赋值 (查询选择, 相加 (查询选择, “ and 鉴定书编号='”, .内容, “'”))
.否则
    
.如果结束

.如果 (等于 (.选中, 真))
    赋值 (查询选择, 相加 (查询选择, “ and 委托人='”, .内容, “'”))
.否则
    
.如果结束

.如果 (等于 (.选中, 真))
    赋值 (查询选择, 相加 (查询选择, “ and 受鉴定人 like '%”, .内容, “%'”))
.否则
    
.如果结束

.如果 (等于 (.选中, 真))
    赋值 (查询选择, 相加 (查询选择, “ and 鉴定结论 like '%”, .内容, “%'”))
.否则
    
.如果结束

.如果 (等于 (.选中, 真))
    赋值 (查询选择, 相加 (查询选择, “ and 鉴定人员1='”, .内容, “' or 鉴定人员2='”, .内容, “'”))
.否则
    
.如果结束

.如果 (等于 (.选中, 真))
    赋值 (文本变量3, 子文本替换 (到文本 (取日期 (.今天)), “年”, “-”, , , 真))
    赋值 (文本变量3, 子文本替换 (文本变量3, “月”, “-”, , , 真))
    赋值 (文本变量3, 子文本替换 (文本变量3, “日”, “”, , , 真))
    赋值 (文本变量4, 子文本替换 (到文本 (取日期 (.今天)), “年”, “-”, , , 真))
    赋值 (文本变量4, 子文本替换 (文本变量4, “月”, “-”, , , 真))
    赋值 (文本变量4, 子文本替换 (文本变量4, “日”, “”, , , 真))
    赋值 (查询选择, 相加 (查询选择, “ and 受理时间 between #”, 文本变量3, “#and#”, 文本变量4, “#”))
.否则
    
.如果结束

.如果 (等于 (.选中, 真))
    赋值 (文本变量, 子文本替换 (到文本 (取日期 (.今天)), “年”, “-”, , , 真))
    赋值 (文本变量, 子文本替换 (文本变量, “月”, “-”, , , 真))
    赋值 (文本变量, 子文本替换 (文本变量, “日”, “”, , , 真))
    赋值 (文本变量2, 子文本替换 (到文本 (取日期 (.今天)), “年”, “-”, , , 真))
    赋值 (文本变量2, 子文本替换 (文本变量2, “月”, “-”, , , 真))
    赋值 (文本变量2, 子文本替换 (文本变量2, “日”, “”, , , 真))
    赋值 (查询选择, 相加 (查询选择, “ and 鉴定书发放日期 between #”, 文本变量, “#and#”, 文本变量2, “#”))
.否则
    
.如果结束
赋值 (记录, 相加 (“select * from 数据表 ”, 查询选择).查询 ())
 ' _启动窗口.标题 ＝ 查询选择
填充 ()

.子程序 填充, 空白型, , 
全部删除 ()
记录.到首记录 ()
.判断循环首 (等于 (记录.尾记录后 (), 假))
    .插入表项 (记录.读 (2), , , , )
    相减 (取表项数 (), 1).置标题 (1, 记录.读 (3))
    相减 (取表项数 (), 1).置标题 (2, 记录.读 (4))
    相减 (取表项数 (), 1).置标题 (3, 到文本 (记录.读 (5)))
    相减 (取表项数 (), 1).置标题 (4, 到文本 (记录.读 (6)))
    相减 (取表项数 (), 1).置标题 (5, 记录.读 (14))
    相减 (取表项数 (), 1).置标题 (6, 记录.读 (15))
    相减 (取表项数 (), 1).置标题 (7, 记录.读 (16))
    相减 (取表项数 (), 1).置标题 (8, 数值到格式文本 (记录.读 (1), , 假))
    记录.到后一记录 ()
.判断循环尾 ()
记录.关闭记录集 ()
赋值 (.可视, 真)
赋值 (.内容, 相加 (“符合条件报告共:”, 到文本 (取表项数 ()), “例”))

.子程序 _全部按钮_被单击, 空白型, , 
赋值 (记录, “select * from 数据表 ”.查询 ())
填充 ()


.子程序 _鉴定编号选择框_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.文本颜色, #黑色)
    赋值 (.可视, 真)
.否则
    .如果 (等于 (.选中, 假))
        赋值 (.文本颜色, #灰色)
        赋值 (.可视, 假)
    .否则
        
    .如果结束
    
.如果结束


.子程序 _委托主体选择框_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.文本颜色, #黑色)
    赋值 (.可视, 真)
.否则
    .如果 (等于 (.选中, 假))
        赋值 (.文本颜色, #灰色)
        赋值 (.可视, 假)
    .否则
        
    .如果结束
    
.如果结束


.子程序 _受鉴定人选择框_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.文本颜色, #黑色)
    赋值 (.可视, 真)
.否则
    .如果 (等于 (.选中, 假))
        赋值 (.文本颜色, #灰色)
        赋值 (.可视, 假)
    .否则
        
    .如果结束
    
.如果结束


.子程序 _受理日期选择框_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.文本颜色, #黑色)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
.否则
    .如果 (等于 (.选中, 假))
        赋值 (.文本颜色, #灰色)
        赋值 (.可视, 假)
        赋值 (.可视, 假)
    .否则
        
    .如果结束
    
.如果结束


.子程序 _鉴定结论选择框_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.文本颜色, #黑色)
    赋值 (.可视, 真)
.否则
    .如果 (等于 (.选中, 假))
        赋值 (.文本颜色, #灰色)
        赋值 (.可视, 假)
    .否则
        
    .如果结束
    
.如果结束


.子程序 _鉴定人选择框_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.文本颜色, #黑色)
    赋值 (.可视, 真)
.否则
    .如果 (等于 (.选中, 假))
        赋值 (.文本颜色, #灰色)
        赋值 (.可视, 假)
    .否则
        
    .如果结束
    
.如果结束


.子程序 _鉴定日期选择框_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.文本颜色, #黑色)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
.否则
    .如果 (等于 (.选中, 假))
        赋值 (.文本颜色, #灰色)
        赋值 (.可视, 假)
        赋值 (.可视, 假)
    .否则
        
    .如果结束
    
.如果结束


.子程序 _查阅按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    信息框 (“您还没有选择要修改的数据呢！”, #信息图标, “友情提示”)
    返回 ()
.如果真结束
赋值 (当前编号, 到文本 (.取标题 (., 8)))
赋值 (记录, 相加 (“select * from  数据表 where  ID=”, 当前编号).查询 ())
记录.到首记录 ()
赋值 (.内容, 记录.读 (2))
赋值 (.内容, 记录.读 (3))
赋值 (.内容, 记录.读 (4))
赋值 (.今天, 到时间 (记录.读 (5)))
赋值 (.今天, 到时间 (记录.读 (6)))
赋值 (., 记录.读 (10))
赋值 (., 记录.读 (11))
赋值 (., 记录.读 (12))
赋值 (., 记录.读 (13))
赋值 (., 记录.读 (14))
赋值 (.内容, 记录.读 (15))
赋值 (.内容, 记录.读 (16))
赋值 (.内容, 记录.读 (19))
赋值 (.内容, 记录.读 (20))
赋值 (图片名, 记录.读 (18))
赋值 (.图片, 读入文件 (相加 (取运行目录 (), “\photo\”, 图片名)))
处理事件 ()
新建 ()
处理事件 ()
赋值 (.可视, 真)

.子程序 _超级列表框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_查阅按钮_被单击 ()


.子程序 _修改按钮_被单击, 空白型, , 
.如果 (相加 (“update 数据表 set 鉴定书编号='”, .内容, “',委托人='”, .内容, “',受鉴定人='”, .内容, “',受理时间='”, 到文本 (取日期 (.今天)), “',鉴定书发放日期='”, 到文本 (取日期 (.今天)), “',书写员='”, 当前用户, “',最后修改日期='”, 到文本 (取现行时间 ()), “',简要案情='”, ., “',病历摘要='”, ., “',法医检验='”, ., “',分析说明='”, ., “',鉴定结论='”, ., “',鉴定人员1='”, .内容, “',鉴定人员2='”, .内容, “',图片名='”, 图片名, “',检查项目='”, .内容, “',地点='”, .内容, “',最后修改动作='”, “修”, “' where ID=”, 当前编号).执行 ())
    .如果 (等于 (信息框 (“你要立即打印吗？”, 相加 (#询问图标, #确认取消钮), “打印提示”), 1))
        
    .否则
        打印 ()
    .如果结束
    赋值 (图片名, “”)
    _工具条_被单击 (1)
.否则
    信息框 (“修改数据失败,请检查数据是否完整!”, 0, )
    返回 ()
.如果结束


.子程序 _删除按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    信息框 (“您还没有选择要删除的数据呢！”, #信息图标, “友情提示”)
    返回 ()
.如果真结束
赋值 (当前编号, 到文本 (.取标题 (., 8)))
 ' .如果 (等于 (信息框 (“选择数据将被从数据库中彻底删除,并且本次操作无法恢复,请再次认可!”, 相加 (#警告图标, #确认取消钮), “删除提示”), 0))
    相加 (“update 数据表 set 可视='假',书写员='”, 当前用户, “',最后修改日期='”, 到文本 (取现行时间 ()), “',最后修改动作='”, “删”, “' where ID=”, 当前编号).执行 ()
    .删除表项 (.)
.否则
    
.如果结束


.子程序 _直接打印按钮_被单击, 空白型, , 
.如果 (等于 (信息框 (“你将放弃所有对本记录的更改,以原数据打印报告,是否继续?”, 相加 (#是否钮, #询问图标), ), #是钮))
    _查阅按钮_被单击 ()
    打印 ()
.否则
    返回 ()
    
.如果结束


.子程序 打印, 空白型, , 
赋值 (.数据源, “”)
#表2.从字节集读 ()
2.置文本色 (2, , , #红色)
2.置文本 (2, .内容)
8.置文本 (5, 相加 (“辽襄法鉴字第”, .内容, “号”))
5.置数据 (9, 读入文件 (相加 (取运行目录 (), “\photo\”, 图片名)))
11.置文本 (1, 相加 (“    受”, .内容, “委托,我所对”, .内容, .内容, “进行鉴定。”, 到文本 (取日期 (.今天)), “在”, .内容, “进行了检验，阅读了所提供的医疗文书，现根据有关标准做出如下鉴定。”))
13.置文本 (1, .)
15.置文本 (1, .)
17.置文本 (1, .)
19.置文本 (1, .)
21.置文本 (1, .)
调整行高 (11, 32, 1)
调整行高 (13, 32, 1)
调整行高 (15, 32, 1)
调整行高 (17, 32, 1)
调整行高 (19, 32, 1)
调整行高 (21, 32, 1)
26.置文本 (9, 到文本 (取日期 (.今天)))
打印边距调整 ()
赋值 (.数据源, “数据源1”)
打印预览 ()

.子程序 打印边距调整, 空白型, , 根据不同的打印机自动调整合适左右边距
.局部变量 宽, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 打印设置, 打印设置信息, , , 

赋值 (打印设置.左边距, 0)
赋值 (打印设置.右边距, 0)
赋值 (打印设置.上边距, 200)
赋值 (打印设置.下边距, 150)
赋值 (打印设置.页号位置, 5)
打印设置.置打印设置 ()
.计次循环首 (取列数 (), i)
    赋值 (宽, 相加 (宽, i.取列宽 ()))
.计次循环尾 ()
赋值 (打印设置.左边距, 相除 (相减 (取打印页宽 (), 宽), 2))
赋值 (打印设置.右边距, 打印设置.左边距)
打印设置.置打印设置 ()
 ' 此子程序可有效地避免因不同的打印机而造成的左右边距失调（上下边距也用此方法）、

.子程序 调整行高, 空白型, , 根据单元格的内容在固定列宽下自动调整行高
.参数 行, 整数型, , 所要调整的行
.参数 单行字数, 空白型, , 单行所容最大字数
.参数 基本行数, 整数型, , 内容最少或为空时所预留的基本行数

.局部变量 位置, 空白型, , , 
.局部变量 上一位置, 空白型, , , 
.局部变量 行数, 空白型, , , 

.判断循环首 (不等于 (位置, -1))
    赋值 (上一位置, 位置)
    赋值 (位置, 寻找字节集 (到字节集 (行.取文本 (1)), { 13, 10 }, 相加 (位置, 2)))
    .如果真 (大于 (位置, 1))
        赋值 (行数, 相加 (行数, 取整 (整除 (相减 (位置, 上一位置), 相乘 (单行字数, 2))), 1))
    .如果真结束
    
.判断循环尾 ()
 ' 以上判断换行次数
.如果 (大于 (行数, 0))
    赋值 (行数, 相加 (行数, 取整 (整除 (相加 (相减 (取文本长度 (行.取文本 (1)), 上一位置), 2), 相乘 (单行字数, 2))), 1))
    .如果 (小于或等于 (行数, 基本行数))
         ' 行.置行高 (1, 相加 (相乘 (基本行数, 相加 (行.取字体尺寸 (1), 2)), 相乘 (行.取边距 (1), 2)))
     ' .否则
        行.置行高 (1, 相加 (相乘 (行数, 相加 (行.取字体尺寸 (1), 2)), 相乘 (行.取边距 (1), 2)))
    .如果结束
    
.否则
    .如果 (小于 (取文本长度 (行.取文本 (1)), 相乘 (单行字数, 基本行数, 2)))
        行.置行高 (1, 相加 (相乘 (基本行数, 相加 (行.取字体尺寸 (1), 2)), 相乘 (行.取边距 (1), 2)))
    .否则
        行.置行高 (1, 相加 (相乘 (相加 (取整 (整除 (取文本长度 (行.取文本 (1)), 相乘 (单行字数, 2))), 1), 相加 (行.取字体尺寸 (1), 2)), 相乘 (行.取边距 (1), 2)))
    .如果结束
    
.如果结束
 ' 注：在打印预览时，有时会出现看似行高度不够（即最下一行字遮了一部分）或行高度过大（最下一行空出）现象，这是因打印预览时缩放表格时的误差，单击一次“放大”按钮及打印出的表格均可显示正常。
 ' 另注：行高与内容是否相协调，关键在单行字数。在设置单行字数时，一般情况下如果内容变化不是很大，测试时数一下放大一号（单击一次“放大”按钮）打印预览的单行字数就行了；如果内容变化非常大即行高调整很大，最好用打印机打印出预览的内容后再数一下确切的单行字数，这样更精确些。

.子程序 _简要案情超级编辑框_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (当前位置, “简要案情”)
 ' 弹出菜单 (横向位置, 相加 (纵向位置, .))

.子程序 _病历摘要超级编辑框_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (当前位置, “病历摘要”)
弹出菜单 (横向位置, 相加 (纵向位置, .))

.子程序 _法医检验超级编辑框_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (当前位置, “法医检验”)
弹出菜单 (横向位置, 相加 (纵向位置, .))


.子程序 _分析说明超级编辑框_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (当前位置, “分析说明”)
弹出菜单 (横向位置, 相加 (纵向位置, .))

.子程序 _鉴定结论超级编辑框_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (当前位置, “鉴定结论”)
弹出菜单 (横向位置, 相加 (纵向位置, .))


.子程序 _剪切_被选择, 空白型, , 
.判断开始 (等于 (当前位置, “简要案情”))
    未知支持库函数_18 ()
.判断 (等于 (当前位置, “病历摘要”))
    未知支持库函数_18 ()
.判断 (等于 (当前位置, “法医检验”))
    未知支持库函数_18 ()
.判断 (等于 (当前位置, “分析说明”))
    未知支持库函数_18 ()
.判断 (等于 (当前位置, “鉴定结论”))
    未知支持库函数_18 ()
.默认
    
.判断结束


.子程序 _复制_被选择, 空白型, , 
.判断开始 (等于 (当前位置, “简要案情”))
    未知支持库函数_17 ()
.判断 (等于 (当前位置, “病历摘要”))
    未知支持库函数_17 ()
.判断 (等于 (当前位置, “法医检验”))
    未知支持库函数_17 ()
.判断 (等于 (当前位置, “分析说明”))
    未知支持库函数_17 ()
.判断 (等于 (当前位置, “鉴定结论”))
    未知支持库函数_17 ()
.默认
    
.判断结束



.子程序 _粘贴_被选择, 空白型, , 
.判断开始 (等于 (当前位置, “简要案情”))
    未知支持库函数_20 ()
.判断 (等于 (当前位置, “病历摘要”))
    未知支持库函数_20 ()
.判断 (等于 (当前位置, “法医检验”))
    未知支持库函数_20 ()
.判断 (等于 (当前位置, “分析说明”))
    未知支持库函数_20 ()
.判断 (等于 (当前位置, “鉴定结论”))
    未知支持库函数_20 ()
.默认
    
.判断结束



.窗口程序集 登陆窗口程序集, , , 

.程序集变量 记录, 整数型, , , 
.程序集变量 用户, 文本型, , , 
.程序集变量 密码, 文本型, , , 
.程序集变量 次数, 整数型, , , 
.程序集变量 权限代码, 文本型, , , 
.程序集变量 key, 文本型, , , 
.子程序 _登陆窗口_可否被关闭, 逻辑型, , 
返回 (假)

.子程序 _登陆窗口_创建完毕, 空白型, , 
.局部变量 库计次, 整数型, , , 

注册判断 ()
赋值 (.内容, 子文本替换 (名称, “ ”, “”, , , 真))
.如果 (等于 (相加 (取运行目录 (), “\sfjd.mdb”).打开MDB数据库 (), 真))
    赋值 (记录, “select * from 用户表 order by ID ”.查询 ())
    记录.到首记录 ()
    .判断循环首 (等于 (记录.尾记录后 (), 假))
        赋值 (用户, 记录.读 (2))
        用户.加入项目 (相减 (库计次, 1))
        记录.到后一记录 ()
    .判断循环尾 ()
.否则
    信息框 (“连接数据库失败”, 0, )
    结束 ()
.如果结束


.子程序 _确定按钮_被单击, 空白型, , 
赋值 (次数, 相加 (次数, 1))
.如果 (等于 (.内容, 密码))
    赋值 (当前用户, .内容)
    .判断开始 (等于 (权限代码, “管理”))
        
    .判断 (等于 (权限代码, “阅览”))
        _启动窗口.加入状态 (., 0, 4)
        _启动窗口.加入状态 (., 2, 4)
    .判断 (等于 (权限代码, “登记”))
        _启动窗口.加入状态 (., 2, 4)
    .默认
        
    .判断结束
    赋值 (.内容, “”)
    销毁 ()
.否则
    .如果 (大于或等于 (次数, 3))
        结束 ()
    .否则
        信息框 (“密码有误，请重新输入！”, #错误图标, “请核对你的密码!”)
        赋值 (.内容, “”)
        获取焦点 ()
    .如果结束
    
.如果结束


.子程序 _退出按钮_被单击, 空白型, , 
结束 ()

.子程序 _用户组合框_列表项被选择, 空白型, , 
赋值 (记录, 相加 (“select * from 用户表 where 户名 = '”, .取项目文本 (.现行选中项), “'”).查询 ())
记录.到首记录 ()
赋值 (密码, 记录.读 (3))
赋值 (权限代码, 记录.读 (4))
 ' 登陆窗口.标题 ＝ 密码 ＋ 权限代码
 ' 输入法名 ＝ 外部数据库.读 (记录, 5)
获取焦点 ()
赋值 (当前用户, .取项目文本 (.现行选中项))

.子程序 注册判断, 空白型, , 
赋值 (名称, 读配置项 (相加 (取运行目录 (), “\注册.ini”), “信息”, “名称”, ))
赋值 (key, 读配置项 (相加 (取运行目录 (), “\注册.ini”), “信息”, “key”, ))
赋值 (注册, 真)

.窗口程序集 照片窗口程序集, , , 

.程序集变量 ff, 位图, , , 
.子程序 _图片框1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

显示选择范围 (真)
赋值 (.左边, 横向位置)
赋值 (.顶边, 纵向位置)
更新选择范围 ()
赋值 (.左边, 相加 (.左边, .宽度))
赋值 (.顶边, 相加 (.顶边, .高度))

.子程序 _按钮1_被单击, 空白型, , 
.如果真 (打开 ())
    赋值 (.图片, 读入文件 (.文件名))
.如果真结束


.子程序 显示选择范围, 空白型, , 
.参数 是否显示, 逻辑型, , 

.如果 (是否显示)
     ' 透明标签1.可视 ＝ 真
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
.否则
     ' 透明标签1.可视 ＝ 假
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
.如果结束


.子程序 更新选择范围, 空白型, , 
连续赋值 (假, .可视, .可视, .可视, .可视, .可视)
赋值 (.左边, .左边)
赋值 (.顶边, 相减 (.顶边, 1))
赋值 (.宽度, .宽度)
赋值 (.高度, 相除 (相乘 (.宽度, 4), 3))
赋值 (.左边, .左边)
赋值 (.顶边, 相加 (.顶边, .高度, 1))
赋值 (.宽度, .宽度)
赋值 (.左边, 相减 (.左边, 1))
赋值 (.顶边, .顶边)
赋值 (.高度, .高度)
赋值 (.左边, 相加 (.左边, .宽度, 1))
赋值 (.顶边, .顶边)
赋值 (.高度, .高度)
赋值 (.左边, 相加 (.左边, .宽度))
赋值 (.顶边, .顶边)
连续赋值 (真, .可视, .可视, .可视, .可视, .可视)

.子程序 _图片框2_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

161.发送信息 (2, 0)
.如果真 (小于 (.左边, .左边))
    赋值 (.左边, .左边)
.如果真结束
赋值 (.宽度, 相减 (.左边, .左边))
.如果真 (小于 (.顶边, .顶边))
    赋值 (.顶边, .顶边)
.如果真结束
赋值 (.高度, 相减 (.顶边, .顶边))
更新选择范围 ()

.子程序 _图片框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (并且 (大于 (横向位置, .左边), 小于 (横向位置, 相加 (.左边, .宽度)), 大于 (纵向位置, .顶边), 小于 (纵向位置, 相加 (.顶边, .高度))))
    161.发送信息 (2, 0)
    更新选择范围 ()
    赋值 (.左边, 相加 (.左边, .宽度))
    赋值 (.顶边, 相加 (.顶边, .高度))
.否则
    显示选择范围 (假)
.如果结束


.子程序 _图片框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (不等于 (_启动窗口..图片, {  }))
    .如果 (等于 (信息框 (“请注意你的操作将要替换原始图片,并且不能恢复,是否继续?”, 4, ), 6))
        返回 ()
    .否则
        
    .如果结束
    
.默认
    
.判断结束
创建目录 (相加 (取运行目录 (), “\temp”))
赋值 (图片临时文件, 相加 (取运行目录 (), “\temp\001.bmp”))
写到文件 (图片临时文件, 快照 (取窗口句柄 (), 0, 0))
赋值 (_启动窗口..图片, 读入文件 (图片临时文件))
创建目录 (相加 (取运行目录 (), “\photo”))
赋值 (图片名, 到文本 (取现行时间 ()))
未知支持库函数_0 (图片临时文件, 相加 (取运行目录 (), “\photo\”, 图片名), 假, 90, 真, 0)
图片窗口.销毁 ()

.子程序 _图片窗口_创建完毕, 空白型, , 
显示选择范围 (假)

.子程序 _顺时针旋转按钮_被单击, 空白型, , 
未知支持库函数_1 (.文件名, 相加 (取运行目录 (), “\temp.bmp”))
处理事件 ()
ff.载入文件 (相加 (取运行目录 (), “\temp.bmp”))
赋值 (ff, ff.旋转90度 (真))
写到文件 (相加 (取运行目录 (), “\temp1.bmp”), ff.取位图数据 ())
赋值 (.图片, 读入文件 (相加 (取运行目录 (), “\temp1.bmp”)))

.子程序 _逆时针旋转按钮_被单击, 空白型, , 
未知支持库函数_1 (.文件名, 相加 (取运行目录 (), “\temp.bmp”))
处理事件 ()
ff.载入文件 (相加 (取运行目录 (), “\temp.bmp”))
赋值 (ff, ff.旋转90度 (假))
写到文件 (相加 (取运行目录 (), “\temp1.bmp”), ff.取位图数据 ())
赋值 (.图片, 读入文件 (相加 (取运行目录 (), “\temp1.bmp”)))

.子程序 _取消按钮_被单击, 空白型, , 
删除文件 (相加 (取运行目录 (), “\temp.bmp”))
删除文件 (相加 (取运行目录 (), “\temp1.bmp”))
销毁 ()

.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 打印超级列表框, 空白型, , 
.参数 超级列表框, 超级列表框, , 
.参数 题目, 文本型, 可空, 
.参数 页眉, 文本型, 可空, 
.参数 页脚, 文本型, 可空, 
.参数 备注, 文本型, 可空, 



.窗口程序集 设置窗口程序集, , , 

.程序集变量 记录, 整数型, , , 
.程序集变量 当前编号, 文本型, , , 
.子程序 _设置窗口_创建完毕, 空白型, , 
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\注册.ini”), “信息”, “名称”, ))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\注册.ini”), “信息”, “key”, ))
相加 (取运行目录 (), “\sfjd.mdb”).打开MDB数据库 ()
赋值 (记录, “select * from 用户表 order by ID ”.查询 ())
全部删除 ()
记录.到首记录 ()
.判断循环首 (等于 (记录.尾记录后 (), 假))
    .插入表项 (数值到格式文本 (记录.读 (1), , 假), , , , )
    相减 (取表项数 (), 1).置标题 (1, 记录.读 (2))
    相减 (取表项数 (), 1).置标题 (2, 记录.读 (4))
    记录.到后一记录 ()
.判断循环尾 ()
记录.关闭记录集 ()

.子程序 _添加按钮_被单击, 空白型, , 
.如果 (并且 (等于 (.内容, .内容), 不等于 (.内容, “”)))
    .如果 (相加 (“insert into 用户表 (户名,权限,密码) values ('”, .内容, “','”, .内容, “','”, .内容, “') ”).执行 ())
        信息框 (相加 (“用户”, .内容, “添加成功!”), 0, )
    .否则
        信息框 (“数据存储失败!请检查数据填写是否完整!”, 0, )
        返回 ()
    .如果结束
    
.否则
    信息框 (“密码出错,请检查!”, 0, )
    获取焦点 ()
.如果结束


.子程序 _修改按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    信息框 (“您还没有选择要修改的数据呢!”, #信息图标, “友情提示”)
    返回 ()
.如果真结束
赋值 (当前编号, 到文本 (.取标题 (., 0)))
.如果 (并且 (等于 (.内容, .内容), 不等于 (.内容, “”)))
    .如果 (相加 (“update 用户表 set 户名='”, .内容, “',权限='”, .内容, “',密码='”, .内容, “' where ID=”, 当前编号).执行 ())
        信息框 (“数据修改成功!下次进入本程序时,设置自动生效!”, 0, )
    .否则
        信息框 (“修改数据失败,请检查数据是否完整!”, 0, )
        返回 ()
    .如果结束
    
.否则
    信息框 (“密码出错,请检查!”, 0, )
    获取焦点 ()
    
.如果结束



.子程序 _超级列表框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (当前编号, 到文本 (.取标题 (., 0)))
赋值 (.内容, .取标题 (., 1))
赋值 (.内容, .取标题 (., 2))



.子程序 _注册按钮_被单击, 空白型, , 
写配置项 (相加 (取运行目录 (), “\注册.ini”), “信息”, “名称”, .内容)
写配置项 (相加 (取运行目录 (), “\注册.ini”), “信息”, “key”, .内容)


.子程序 _删除按钮_被单击, 空白型, , 



 ' 不属于任何一个程序集、类模块的函数：
