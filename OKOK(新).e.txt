 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 登陆窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 187
    高度 = 156
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 6
    底图方式 = 1
    底色 = 32768 '  0x8000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 _启动窗口
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 5
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\OKOK(新).e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 房台设置
    左边 = 50
    顶边 = 50
    宽度 = 556
    高度 = 444
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “房台设置”
    帮助文件名 = “”

窗口 会员卡
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “会员卡设置”
    帮助文件名 = “”

窗口 入库
    左边 = 50
    顶边 = 50
    宽度 = 617
    高度 = 482
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “进货管理”
    帮助文件名 = “”

窗口 出库
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “出库管理”
    帮助文件名 = “”

窗口 库存查询
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “库存查询”
    帮助文件名 = “”

窗口 业务操作
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “业务操作”
    帮助文件名 = “”

窗口 开台操作
    左边 = 50
    顶边 = 50
    宽度 = 484
    高度 = 280
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 点单操作
    左边 = 50
    顶边 = 50
    宽度 = 476
    高度 = 103
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “点单操作”
    帮助文件名 = “”

窗口 结帐操作
    左边 = 50
    顶边 = 50
    宽度 = 353
    高度 = 403
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “结帐操作”
    帮助文件名 = “”

窗口 人员设置
    左边 = 50
    顶边 = 50
    宽度 = 643
    高度 = 507
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “操作员设置”
    帮助文件名 = “”

窗口 销售明细
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “销售明细”
    帮助文件名 = “”

窗口 关于软件
    左边 = 50
    顶边 = 50
    宽度 = 308
    高度 = 199
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 6
    底图方式 = 1
    底色 = 32768 '  0x8000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于本软件”
    帮助文件名 = “”

窗口 软件注册
    左边 = 50
    顶边 = 50
    宽度 = 316
    高度 = 292
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “软件注册”
    帮助文件名 = “”

窗口 报表汇总
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “销售报表查询”
    帮助文件名 = “”

窗口 结帐报表
    左边 = 50
    顶边 = 50
    宽度 = 222
    高度 = 239
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “结帐报表”
    帮助文件名 = “”

窗口 系统选项
    左边 = 50
    顶边 = 50
    宽度 = 330
    高度 = 306
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “系统设置”
    帮助文件名 = “”

窗口 时间显示
    左边 = 50
    顶边 = 50
    宽度 = 200
    高度 = 68
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “时钟”
    帮助文件名 = “”

窗口 权限设置
    左边 = 50
    顶边 = 50
    宽度 = 503
    高度 = 353
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “人员权限设置”
    帮助文件名 = “”

窗口 密码修改
    左边 = 50
    顶边 = 50
    宽度 = 223
    高度 = 136
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “密码修改”
    帮助文件名 = “”

窗口 备份恢复
    左边 = 50
    顶边 = 50
    宽度 = 333
    高度 = 219
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “数据备份恢复”
    帮助文件名 = “”

窗口 系统初始化
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 148
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “数据库初始化！！！！！！！！”
    帮助文件名 = “”

窗口 会员卡明细
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “会员卡消费明细”
    帮助文件名 = “”

窗口 进货单查询
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “进货单查询”
    帮助文件名 = “”

窗口 返厂单查询
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 407
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “返厂单查询”
    帮助文件名 = “”

窗口 新商品资料
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “商品资料”
    帮助文件名 = “”

窗口 类别编辑
    左边 = 50
    顶边 = 50
    宽度 = 321
    高度 = 483
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “类别编辑”
    帮助文件名 = “”

窗口 进销往来
    左边 = 50
    顶边 = 50
    宽度 = 537
    高度 = 196
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “进销往来”
    帮助文件名 = “”

窗口 销售流水
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “销售实时流水”
    帮助文件名 = “”

窗口 流水明细
    左边 = 50
    顶边 = 50
    宽度 = 468
    高度 = 388
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “流水明细”
    帮助文件名 = “”

窗口 卡编辑
    左边 = 50
    顶边 = 50
    宽度 = 211
    高度 = 179
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “卡编辑”
    帮助文件名 = “”

窗口 收款报表
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “收款报表”
    帮助文件名 = “”

窗口 盘点单编辑
    左边 = 50
    顶边 = 50
    宽度 = 591
    高度 = 432
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “盘点单编辑”
    帮助文件名 = “”

窗口 数据清除
    左边 = 50
    顶边 = 50
    宽度 = 328
    高度 = 278
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “数据清除”
    帮助文件名 = “”

窗口 卡密码
    左边 = 50
    顶边 = 50
    宽度 = 187
    高度 = 169
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “卡密码”
    帮助文件名 = “”

窗口 卡种类别
    左边 = 50
    顶边 = 50
    宽度 = 314
    高度 = 416
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “卡种类别”
    帮助文件名 = “”

窗口 打印机设置
    左边 = 50
    顶边 = 50
    宽度 = 312
    高度 = 209
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “打印设置”
    帮助文件名 = “”

窗口 销售月报
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “销售月报表”
    帮助文件名 = “”

窗口 类别销售
    左边 = 50
    顶边 = 50
    宽度 = 370
    高度 = 559
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “类别销售报表”
    帮助文件名 = “”

窗口 人员资料管理
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “人员资料管理”
    帮助文件名 = “”

窗口 单据折扣
    左边 = 50
    顶边 = 50
    宽度 = 199
    高度 = 127
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “单据折扣”
    帮助文件名 = “”

窗口 查询
    左边 = 50
    顶边 = 50
    宽度 = 311
    高度 = 114
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “查询条件”
    帮助文件名 = “”

窗口 卡输入
    左边 = 50
    顶边 = 50
    宽度 = 186
    高度 = 89
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “密码输入”
    帮助文件名 = “”



.图片 图片1, " ' 已保存到：D:\易语言学习\Data\OKOK(新).e\图片1", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 1 3 高级表格支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' CnCalendar {18C0788E-59AE-4112-B452-6BF0C1B727FB} 1 2 农历日期支持库
 ' eCompress 7B68736E818E41c5A28B0AE4D43C128C 1 1 压缩解压支持库
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 2 6 扩展界面支持库三
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库




.全局变量 人员职务, 文本型, , , 
.全局变量 人员姓名, 文本型, , , 
.全局变量 计次变量, 整数型, , , 
.全局变量 折扣率, 小数型, , , 
.全局变量 金额, 小数型, , , 
.全局变量 月份, 文本型, , , 
.全局变量 日期, 文本型, , , 
.全局变量 小时, 文本型, , , 
.全局变量 分钟, 文本型, , , 
.全局变量 秒钟, 文本型, , , 

.窗口程序集 窗口程序集1, , , 

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 rybhh, 文本型, , , 
.局部变量 rymmh, 文本型, , , 

赋值 (rybhh, .内容)
打开 (相加 (取运行目录 (), “\data\user.edb”), , , , , , )
到首记录 ()
.判断开始 (查找 (等于 (等于 (读 (“rybh”), .内容), 真)))
    赋值 (rymmh, 读 (“rymm”))
.默认
    赋值 (rybhh, 读 (“rybh”))
.判断结束

.如果 (并且 (等于 (.内容, rymmh), 等于 (.内容, rybhh)))
     ' _启动窗口.标签2.标题 ＝ 登陆窗口.编辑框1.内容
    .判断循环首 (等于 (查找 (等于 (读 (“rybh”), .内容)), 真))
        赋值 (人员职务, 读 (“ryzw”))
        赋值 (人员姓名, 读 (“ryxm”))
        跳过 ()
    .判断循环尾 ()
    赋值 (_启动窗口., 相加 (_启动窗口., “  ”, 人员职务, “:”, 人员姓名))
    赋值 (_启动窗口..标题, rybhh)
    关闭 (相加 (取运行目录 (), “\data\user.edb”))
    登陆窗口.销毁 ()
.否则
    信息框 (“密码错误”, 0, “提示：”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    获取焦点 ()
.如果结束
关闭 (相加 (取运行目录 (), “\data\user.edb”))

.子程序 _按钮2_被单击, 空白型, , 
_启动窗口.销毁 ()
销毁 ()

.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (并且 (等于 (字符代码, #回车键), 不等于 (.内容, “”)))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (并且 (等于 (字符代码, #回车键), 不等于 (.内容, “”)))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _登陆窗口_创建完毕, 空白型, , 
打开 (相加 (取运行目录 (), “\data\config.edb”), , , , , , )
赋值 (., 相加 (读 (“单位信息”), “管理系统”))
关闭 (相加 (取运行目录 (), “\data\config.edb”))


.窗口程序集 窗口程序集2, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 时间值, 文本型, , , 
.局部变量 逻辑变量, 逻辑型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 硬盘注册键, 文本型, , , 
.局部变量 期限, 空白型, , , 

 ' 硬盘注册键 ＝ 到文本 (取十六进制文本 (取硬盘特征字 () × 1881696)) ＋ “-” ＋ 到文本 (取十六进制文本 (取硬盘特征字 () × 49826865)) ＋ “-” ＋ 到文本 (取十六进制文本 (取硬盘特征字 () × 138913913)) ＋ “-” ＋ 到文本 (取十六进制文本 (取硬盘特征字 () × 19800624))
 ' 文本变量 ＝ 取文本注册项 (#现行用户, “Software\Microsoft\Internet Explorer\Main\TVKEY”, )
未知支持库函数_0 (#)
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\config.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\userqx.edb”))
赋值 (时间值, 到文本 (相加 (到文本 (取小时 (取现行时间 ())), 到文本 (取分钟 (取现行时间 ())), 到文本 (取秒 (取现行时间 ())))))
打开 (相加 (取运行目录 (), “\data\config.edb”), , , , , , )
 ' 期限 ＝ 取时间间隔 (取现行时间 (), 到时间 (读 (“regkey”)), 5)
 ' .如果真 (等于 (到文本 (读 (“regkey”)), “”))
     ' 系统数据源.置文本 (1, 11, 到文本 (取现行时间 ()))
.如果真结束
 ' .如果真 (并且 (不等于 (文本变量, 硬盘注册键), 小于或等于 (期限, 30)))
     ' 信息框 (“程序没有注册，以试用版运行，期限为30天！还有” ＋ 到文本 (30 － 期限) ＋ “天的使用时间！”, 0, )
     ' _启动窗口.标题 ＝ “咖啡厅茶楼管理系统-试用版”
.如果真结束
 ' .如果真 (等于 (文本变量, 硬盘注册键))
     ' 标题 ＝ 读 (“单位信息”) ＋ “管理系统”
.如果真结束
.如果 (等于 (读 (“显示背景”), “否”))
    赋值 (.可视, 假)
.否则
    赋值 (.可视, 真)
    赋值 (.图片, 读入文件 (读 (“背景图”)))
    载入 (登陆窗口, _启动窗口, 真)
.如果结束
 ' .如果 (并且 (不等于 (文本变量, 硬盘注册键), 小于或等于 (相减 (30, 期限), 0)))
     ' 信息框 (“试用期已过，请注册正式版本！”, 0, )
     ' 销毁 ()
.否则
     ' .如果真 (等于 (文本变量, 硬盘注册键))
         ' 载入 (登陆窗口, _启动窗口, 真)
    .如果真结束
    
.如果结束
关闭 (相加 (取运行目录 (), “\data\config.edb”))

.子程序 __启动窗口_尺寸被改变, 空白型, , 
赋值 (.宽度, _启动窗口.)
赋值 (.高度, _启动窗口.)

.子程序 _退出系统_被选择, 空白型, , 
.局部变量 返回值, 整数型, , , 

赋值 (返回值, 信息框 (“真的退出本软件吗？”, 4, ))
.如果 (等于 (返回值, #是钮))
    运行 (相加 (取运行目录 (), “\autobak.exe”), 假, )
    销毁 ()
.否则
    
.如果结束


.子程序 __启动窗口_被激活, 空白型, , 
打开 (相加 (取运行目录 (), “\data\userqx.edb”), , , , , , )
到首记录 ()
.判断循环首 (等于 (查找 (等于 (读 (“人员编号”), .标题)), 真))
    .如果 (等于 (取记录号 ().取文本 (3), “真”))
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
    .否则
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
    .如果结束
    .如果 (等于 (取记录号 ().取文本 (4), “真”))
        赋值 (.禁止, 假)
    .否则
        赋值 (.禁止, 真)
    .如果结束
    .如果 (等于 (取记录号 ().取文本 (5), “真”))
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
    .否则
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
    .如果结束
    .如果 (等于 (取记录号 ().取文本 (6), “真”))
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
    .否则
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
    .如果结束
    .如果 (等于 (取记录号 ().取文本 (7), “真”))
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
    .否则
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
    .如果结束
    .如果 (等于 (取记录号 ().取文本 (8), “真”))
        赋值 (.禁止, 假)
    .否则
        赋值 (.禁止, 真)
    .如果结束
    .如果 (等于 (取记录号 ().取文本 (9), “真”))
        赋值 (.禁止, 假)
    .否则
        赋值 (.禁止, 真)
    .如果结束
    .如果 (等于 (取记录号 ().取文本 (10), “真”))
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
    .否则
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
    .如果结束
    .如果 (等于 (取记录号 ().取文本 (11), “真”))
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
    .否则
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
    .如果结束
    .如果 (等于 (取记录号 ().取文本 (12), “真”))
        赋值 (.禁止, 假)
    .否则
        赋值 (.禁止, 真)
    .如果结束
    .如果 (等于 (取记录号 ().取文本 (13), “真”))
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
    .否则
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
    .如果结束
    .如果 (等于 (取记录号 ().取文本 (14), “真”))
        赋值 (.禁止, 假)
    .否则
        赋值 (.禁止, 真)
    .如果结束
    .如果 (等于 (取记录号 ().取文本 (15), “真”))
        赋值 (.禁止, 假)
    .否则
        赋值 (.禁止, 真)
    .如果结束
    .如果 (等于 (取记录号 ().取文本 (16), “真”))
        赋值 (.禁止, 假)
    .否则
        赋值 (.禁止, 真)
    .如果结束
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\userqx.edb”))


.子程序 _包台信息_被选择, 空白型, , 
载入 (房台设置, , 真)

.子程序 _会员设置_被选择, 空白型, , 
载入 (会员卡, , 真)

.子程序 _入库管理_被选择, 空白型, , 
载入 (入库, , 真)


.子程序 _出库管理_被选择, 空白型, , 
载入 (出库, , 真)


.子程序 _库存查询_被选择, 空白型, , 
载入 (库存查询, , 真)


.子程序 _销售管理_被选择, 空白型, , 
载入 (业务操作, , 真)

.子程序 _操作员设置_被选择, 空白型, , 
载入 (人员设置, , 真)


.子程序 _重新登陆_被选择, 空白型, , 
打开 (相加 (取运行目录 (), “\data\config.edb”), , , , , , )
赋值 (., 相加 (“【”, 读 (“单位信息”), “管理系统”, “】”, “〓”, “1.0版”))
关闭 (相加 (取运行目录 (), “\data\config.edb”))
载入 (登陆窗口, , 真)

.子程序 _销售明细表_被选择, 空白型, , 
载入 (销售明细, , 真)


.子程序 _关于_被选择, 空白型, , 
载入 (关于软件, , 真)

.子程序 _软件注册_被选择, 空白型, , 
载入 (软件注册, , 真)


.子程序 _销售日报表_被选择, 空白型, , 
载入 (报表汇总, , 真)


.子程序 _系统参数_被选择, 空白型, , 
载入 (系统选项, , 真)


.子程序 _显示时钟_被选择, 空白型, , 
载入 (时间显示, _启动窗口, 假)

.子程序 _权限设定_被选择, 空白型, , 
载入 (权限设置, , 真)


.子程序 _修改密码_被选择, 空白型, , 
载入 (密码修改, , 真)



.子程序 __启动窗口_可否被关闭, 逻辑型, , 
.局部变量 返回值, 整数型, , , 

赋值 (返回值, 信息框 (“真的退出本软件吗？”, 4, ))
.如果 (等于 (返回值, #是钮))
    运行 (相加 (取运行目录 (), “\autobak.exe”), 假, )
    返回 (真)
.否则
    返回 (假)
.如果结束


.子程序 _备份恢复_被选择, 空白型, , 
运行 (相加 (取运行目录 (), “\databak.exe”), 假, )
_启动窗口.销毁 ()

.子程序 _数据库初始化_被选择, 空白型, , 
载入 (系统初始化, , 真)


.子程序 _会员消费_被选择, 空白型, , 
载入 (会员卡明细, , 真)


.子程序 _结帐报表_被选择, 空白型, , 
载入 (结帐报表, , 真)


.子程序 _入库查询_被选择, 空白型, , 
载入 (进货单查询, , 真)


.子程序 _出库查询_被选择, 空白型, , 
载入 (返厂单查询, , 真)


.子程序 _商品资料_被选择, 空白型, , 
载入 (新商品资料, , 真)


.子程序 _类别管理_被选择, 空白型, , 
载入 (类别编辑, , 真)

.子程序 _分类销售表_被选择, 空白型, , 
载入 (类别销售, , 真)

.子程序 _销售流水实时_被选择, 空白型, , 
载入 (销售流水, , 真)


.子程序 _收款员报表_被选择, 空白型, , 
载入 (收款报表, , 真)


.子程序 _报表数据清除_被选择, 空白型, , 
载入 (数据清除, , 真)


.子程序 _计算器_被选择, 空白型, , 
运行 (相加 (取运行目录 (), “\calc.exe”), 假, )

.子程序 _卡种设置_被选择, 空白型, , 
载入 (卡种类别, , 真)


.子程序 _打印设置_被选择, 空白型, , 
载入 (打印机设置, , 真)

.子程序 _销售月报表_被选择, 空白型, , 
载入 (销售月报, , 真)

.子程序 _人员档案_被选择, 空白型, , 
载入 (人员资料管理, , 真)


.子程序 _库存盘点_被选择, 空白型, , 
载入 (盘点单编辑, , 真)


.窗口程序集 窗口程序集3, , , 

.窗口程序集 窗口程序集4, , , 

.子程序 _房台设置_创建完毕, 空白型, , 
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\fjzl.edb”))
0.未知支持库函数_9 (0, #., “房间编号”)
0.未知支持库函数_9 (1, #., “房间名称”)
0.未知支持库函数_9 (2, #., “房间人数”)
0.未知支持库函数_9 (3, #., “房间状态”)
0.未知支持库函数_9 (4, #., “房间种类”)
0.未知支持库函数_9 (5, #., “基本费用”)
获取焦点 ()
打开 (相加 (取运行目录 (), “\data\fjzl.edb”), , , , , , )
到首记录 ()
赋值 (., 相加 (取行数 (), 1))
.判断循环首 (等于 (查找 (大于 (读 (“房间编号”), “”)), 真))
    读 (“房间名称”).加入项目 ()
    取项目数 ().未知支持库函数_9 (0, #., 读 (“房间编号”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“房间名称”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“房间人数”))
    取项目数 ().未知支持库函数_9 (3, #., 读 (“房间状态”))
    取项目数 ().未知支持库函数_9 (4, #., 读 (“房间种类”))
    取项目数 ().未知支持库函数_9 (5, #., 读 (“基本费用”))
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\fjzl.edb”))



.子程序 _按钮1_被单击, 空白型, , 
赋值 (.只读, 假)
赋值 (.允许添加, 真)
赋值 (.允许删除, 假)
到尾记录 ()
相加 (取记录号 (), 1).插入行 (1)
到尾记录 ()
.未知支持库函数_38 ()
相加 (取项目数 (), 1).未知支持库函数_0 (0)
获取焦点 ()
赋值 (.禁止, 真)
赋值 (.禁止, 假)


.子程序 _按钮2_被单击, 空白型, , 
赋值 (.只读, 假)
赋值 (.允许添加, 假)
赋值 (.允许删除, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 假)

.子程序 _按钮3_被单击, 空白型, , 
.局部变量 返回值, 整数型, , , 

赋值 (返回值, 信息框 (“真的要删除这条记录吗？”, 4, ))
.如果真 (等于 (返回值, #是钮))
    赋值 (.只读, 假)
    赋值 (.允许添加, 假)
    赋值 (.允许删除, 真)
    0.删除项目 ()
    取记录号 ().删除行 (1)
    未知支持库函数_3 ().未知支持库函数_36 ()
    赋值 (.只读, 真)
    赋值 (.允许添加, 假)
    赋值 (.允许删除, 假)
.如果真结束


.子程序 _按钮4_被单击, 空白型, , 
赋值 (.只读, 真)
赋值 (.允许添加, 假)
赋值 (.允许删除, 假)
取记录号 ().置文本 (1, .内容)
取记录号 ().置文本 (2, .内容)
取记录号 ().置文本 (3, 到文本 (.内容))
取记录号 ().置文本 (4, “空”)
取记录号 ().置文本 (5, .内容)
取记录号 ().置文本 (6, .内容)
相加 (取项目数 (), 1).未知支持库函数_9 (0, #., .内容)
相加 (取项目数 (), 1).未知支持库函数_9 (1, #., .内容)
相加 (取项目数 (), 1).未知支持库函数_9 (2, #., .内容)
相加 (取项目数 (), 1).未知支持库函数_9 (3, #., “空”)
相加 (取项目数 (), 1).未知支持库函数_9 (4, #., .内容)
相加 (取项目数 (), 1).未知支持库函数_9 (5, #., .内容)
.加入项目 (.内容, )
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)


.子程序 _按钮5_被单击, 空白型, , 
销毁 ()

.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束



.子程序 _编辑框3_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束



.子程序 _表格1_选择行列数改变, 空白型, , 
.局部变量 行数, 整数型, , , 

赋值 (行数, 取光标行号 ())
行数.跳到 ()


.子程序 _组合框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框4_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _高级表格1_被单击, 空白型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 

打开 (相加 (取运行目录 (), “\data\fjzl.edb”), , , , , , )
到首记录 ()
.判断循环首 (等于 (查找 (等于 (读 (“房间编号”), 未知支持库函数_3 ().未知支持库函数_10 (0))), 真))
    取记录号 ().跳到 ()
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\fjzl.edb”))


.窗口程序集 窗口程序集5, , , 

.子程序 _会员卡_创建完毕, 空白型, , 
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\hykk.edb”))
0.未知支持库函数_9 (0, #., “会员卡号”)
0.未知支持库函数_9 (1, #., “顾客姓名”)
0.未知支持库函数_9 (2, #., “联系电话”)
0.未知支持库函数_9 (3, #., “卡种类别”)
0.未知支持库函数_9 (4, #., “折扣率”)
0.未知支持库函数_9 (5, #., “卡内金额”)
获取焦点 ()
打开 (相加 (取运行目录 (), “\data\kzlb.edb”), , , , , , )
到首记录 ()
.判断循环首 (等于 (查找 (大于 (读 (“卡种编号”), 0)), 真))
    读 (“卡种名称”).加入项目 ()
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\kzlb.edb”))
打开 (相加 (取运行目录 (), “\data\hykk.edb”), , , , , , )
到首记录 ()
赋值 (., 相加 (取行数 (), 1))
.判断循环首 (等于 (查找 (大于 (读 (“会员卡号”), 0)), 真))
    读 (“顾客姓名”).加入项目 ()
    取项目数 ().未知支持库函数_9 (0, #., 读 (“会员卡号”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“顾客姓名”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“联系电话”))
    取项目数 ().未知支持库函数_9 (3, #., 读 (“卡种类”))
    取项目数 ().未知支持库函数_9 (4, #., 读 (“折扣率”))
    取项目数 ().未知支持库函数_9 (5, #., 读 (“卡内金额”))
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\hykk.edb”))


.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框3_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _组合框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

获取焦点 ()

.子程序 _编辑框5_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _表格1_选择行列数改变, 空白型, , 
.局部变量 行数, 整数型, , , 

赋值 (行数, 取光标行号 ())
行数.跳到 ()


.子程序 _按钮1_被单击, 空白型, , 
赋值 (.只读, 假)
赋值 (.允许添加, 真)
赋值 (.允许删除, 假)
到尾记录 ()
相加 (取记录号 (), 1).插入行 (1)
到尾记录 ()
.未知支持库函数_38 ()
相加 (取项目数 (), 1).未知支持库函数_0 (0)
获取焦点 ()
赋值 (.禁止, 真)
赋值 (.禁止, 假)


.子程序 _按钮2_被单击, 空白型, , 
赋值 (.只读, 假)
赋值 (.允许添加, 假)
赋值 (.允许删除, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 假)

.子程序 _按钮3_被单击, 空白型, , 
.局部变量 返回值, 整数型, , , 

赋值 (返回值, 信息框 (“真的要删除这条记录吗？”, 4, ))
.如果真 (等于 (返回值, #是钮))
    .如果 (大于 (到数值 (未知支持库函数_3 ().未知支持库函数_10 (5)), 0))
        信息框 (“卡内有余额，不能删除！”, 0, “提示”)
    .否则
        赋值 (.只读, 假)
        赋值 (.允许添加, 假)
        赋值 (.允许删除, 真)
        0.删除项目 ()
        取记录号 ().删除行 (1)
        未知支持库函数_3 ().未知支持库函数_36 ()
        赋值 (.只读, 真)
        赋值 (.允许添加, 假)
        赋值 (.允许删除, 假)
        
    .如果结束
    
.如果真结束


.子程序 _按钮4_被单击, 空白型, , 
赋值 (.只读, 真)
赋值 (.允许添加, 假)
赋值 (.允许删除, 假)
取记录号 ().置文本 (1, .内容)
取记录号 ().置文本 (2, .内容)
取记录号 ().置文本 (3, .内容)
取记录号 ().置文本 (4, .内容)
取记录号 ().置文本 (5, .内容)
取记录号 ().置文本 (6, .内容)
相加 (取项目数 (), 1).未知支持库函数_9 (0, #., .内容)
相加 (取项目数 (), 1).未知支持库函数_9 (1, #., .内容)
相加 (取项目数 (), 1).未知支持库函数_9 (2, #., .内容)
相加 (取项目数 (), 1).未知支持库函数_9 (3, #., .内容)
相加 (取项目数 (), 1).未知支持库函数_9 (4, #., .内容)
相加 (取项目数 (), 1).未知支持库函数_9 (5, #., .内容)
.加入项目 (.内容, )
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)


.子程序 _按钮5_被单击, 空白型, , 
销毁 ()

.子程序 _编辑框6_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _高级表格1_被单击, 空白型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 

打开 (相加 (取运行目录 (), “\data\hykk.edb”), , , , , , )
到首记录 ()
.判断循环首 (等于 (查找 (等于 (读 (“会员卡号”), 到数值 (未知支持库函数_3 ().未知支持库函数_10 (0)))), 真))
    取记录号 ().跳到 ()
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\hykk.edb”))


.子程序 _高级表格1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()


.子程序 _充值_被选择, 空白型, , 
载入 (卡编辑, 会员卡, 假)
赋值 (卡编辑..标题, “充值”)


.子程序 _退款_被选择, 空白型, , 
载入 (卡编辑, 会员卡, 假)
赋值 (卡编辑..标题, “退款”)


.子程序 _添加_被选择, 空白型, , 
赋值 (.只读, 假)
赋值 (.允许添加, 真)
赋值 (.允许删除, 假)
到尾记录 ()
相加 (取记录号 (), 1).插入行 (1)
到尾记录 ()
.未知支持库函数_38 ()
相加 (取项目数 (), 1).未知支持库函数_0 (0)
获取焦点 ()
赋值 (.禁止, 真)
赋值 (.禁止, 假)


.子程序 _修改_被选择, 空白型, , 
赋值 (.只读, 假)
赋值 (.允许添加, 假)
赋值 (.允许删除, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 假)


.子程序 _删除_被选择, 空白型, , 
.局部变量 返回值, 整数型, , , 

赋值 (返回值, 信息框 (“真的要删除这条记录吗？”, 4, ))
.如果真 (等于 (返回值, #是钮))
    .如果 (大于 (到数值 (未知支持库函数_3 ().未知支持库函数_10 (5)), 0))
        信息框 (“卡内有余额，不能删除！”, 0, “提示”)
    .否则
        赋值 (.只读, 假)
        赋值 (.允许添加, 假)
        赋值 (.允许删除, 真)
        0.删除项目 ()
        取记录号 ().删除行 (1)
        未知支持库函数_3 ().未知支持库函数_36 ()
        赋值 (.只读, 真)
        赋值 (.允许添加, 假)
        赋值 (.允许删除, 假)
        
    .如果结束
    
.如果真结束


.子程序 _挂失_被选择, 空白型, , 


.子程序 _密码设置_被选择, 空白型, , 
载入 (卡密码, , 真)


.窗口程序集 窗口程序集6, , , 

.子程序 _入库_创建完毕, 空白型, , 
打开 (相加 (取运行目录 (), “\data\jhdhk.edb”), , , , , , )
到首记录 ()
.判断循环首 (等于 (查找 (不等于 (读 (“进货单号”), “”)), 真))
    读 (“进货单号”).加入项目 ()
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\jhdhk.edb”))
获取焦点 ()
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\jhdhk.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\spzl.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\spkc.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\config.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\jhdk.edb”))
0.未知支持库函数_9 (0, #., “进货单号”)
0.未知支持库函数_9 (1, #., “编码”)
0.未知支持库函数_9 (2, #., “商品名称”)
0.未知支持库函数_9 (3, #., “数量”)
0.未知支持库函数_9 (4, #., “进价”)
0.未知支持库函数_9 (5, #., “总计”)
0.未知支持库函数_32 (100)
1.未知支持库函数_32 (40)
2.未知支持库函数_32 (120)
3.未知支持库函数_32 (40)
4.未知支持库函数_32 (40)
5.未知支持库函数_32 (40)
赋值 (.标题, 到文本 (到数值 (1.取文本 (3))))
赋值 (.标题, “进货”)
打开 (相加 (取运行目录 (), “\data\jhdk.edb”), , , , , , )
到首记录 ()
赋值 (., 相加 (取行数 (), 1))
.判断循环首 (等于 (查找 (不等于 (读 (“进货单号”), “”)), 真))
    读 (“进货单号”).加入项目 ()
    取项目数 ().未知支持库函数_9 (0, #., 读 (“进货单号”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“商品编码”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“商品名称”))
    取项目数 ().未知支持库函数_9 (3, #., 读 (“进货数量”))
    取项目数 ().未知支持库函数_9 (4, #., 读 (“进价”))
    取项目数 ().未知支持库函数_9 (5, #., 读 (“总计”))
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\jhdk.edb”))

.子程序 _编辑框2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (并且 (等于 (字符代码, #回车键), 不等于 (.内容, “”)))
    打开 (相加 (取运行目录 (), “\data\spzl.edb”), , , , , , )
    到首记录 ()
    .判断循环首 (查找 (等于 (读 (“商品编码”), 到数值 (.内容))))
        .如果真 (等于 (.内容, “”))
            .判断循环首 (查找 (等于 (读 (“商品编码”), 到数值 (.内容))))
                赋值 (.内容, 读 (“商品名称”))
                赋值 (.内容, 读 (“单位”))
                赋值 (.内容, “”)
                跳过 ()
            .判断循环尾 ()
        .如果真结束
        获取焦点 ()
        跳过 ()
    .判断循环尾 ()
    关闭 (相加 (取运行目录 (), “\data\spzl.edb”))
    .如果真 (等于 (.内容, “”))
        信息框 (“商品编码错误!”, 0, )
        获取焦点 ()
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
    .如果真结束
    打开 (相加 (取运行目录 (), “\data\spkc.edb”), , , , , , )
    到首记录 ()
    .判断循环首 (查找 (等于 (读 (“商品编码”), 到数值 (.内容))))
        赋值 (.内容, 读 (“商品名称”))
        赋值 (.内容, 读 (“单位”))
        赋值 (.内容, 到文本 (读 (“库存数量”)))
        跳过 ()
    .判断循环尾 ()
    .如果 (等于 (.标题, “修改”))
        赋值 (.内容, 到文本 (相减 (到数值 (.内容), 到数值 (.内容))))
    .否则
        
    .如果结束
    关闭 (相加 (取运行目录 (), “\data\spkc.edb”))
.如果真结束


.子程序 _编辑框6_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框7_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (并且 (等于 (字符代码, #回车键), 不等于 (.内容, “”)))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    获取焦点 ()
.如果真结束


.子程序 _按钮1_被单击, 空白型, , 
赋值 (.标题, “进货”)
赋值 (月份, 到文本 (取月份 (取现行时间 ())))
.如果 (小于 (到数值 (月份), 10))
    赋值 (月份, 相加 (“0”, 月份))
.否则
    
.如果结束
赋值 (日期, 到文本 (取日 (取现行时间 ())))
.如果 (小于 (到数值 (日期), 10))
    赋值 (日期, 相加 (“0”, 日期))
.否则
    
.如果结束
打开 (相加 (取运行目录 (), “\data\jhdk.edb”), , , , , , )
到首记录 ()
.判断循环首 (查找 (近似等于 (读 (“进货单号”), 相加 (到文本 (取年份 (取现行时间 ())), 月份, 日期))))
    0.插入项目 (读 (“进货单号”), )
    跳过 ()
.判断循环尾 ()
赋值 (.标题, 到文本 (取最大值 (到数值 (读 (“进货单号”)), 近似等于 (读 (“进货单号”), 相加 (到文本 (取年份 (取现行时间 ())), 月份, 日期)))))
关闭 (相加 (取运行目录 (), “\data\jhdk.edb”))

.如果 (小于 (取项目数 (), 1))
    赋值 (.内容, 相加 (到文本 (取年份 (取现行时间 ())), 月份, 日期, “0001”))
.否则
    赋值 (.内容, 到文本 (相加 (到数值 (.标题), 1)))
.如果结束
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
相加 (取行数 (), 1).插入行 ()
到尾记录 ()
取记录号 ().置文本 (1, .内容)
.加入项目 (.内容, )
赋值 (.禁止, 真)
赋值 (.禁止, 假)
获取焦点 ()

.子程序 _按钮2_被单击, 空白型, , 
赋值 (.禁止, 假)
赋值 (.禁止, 真)
1.置文本 (3, .标题)

.子程序 _按钮4_被单击, 空白型, , 
.如果 (等于 (.禁止, 假))
    信息框 (“单据没有存盘，请点保存〈按钮〉存盘!”, 0, )
.否则
    1.置文本 (3, .标题)
    入库.销毁 ()
.如果结束


.子程序 _按钮3_被单击, 空白型, , 
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\jhdhk.edb”))
打开 (相加 (取运行目录 (), “\data\jhdhk.edb”), , , , , , )
到首记录 ()
.判断循环首 (查找 (等于 (读 (“进货单号”), .取项目文本 (.现行选中项))))
    取记录号 ().跳到 ()
    取记录号 ().置文本 (2, “验收”)
    .如果 (等于 (取记录号 ().取文本 (2), “验收”))
        信息框 (“验收成功！”, 0, “提示”)
    .否则
        信息框 (“验收失败！”, 0, “提示”)
    .如果结束
    跳过 ()
.判断循环尾 ()

关闭 (相加 (取运行目录 (), “\data\jhdhk.edb”))


.子程序 _编辑框8_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.局部变量 现库存数量, 小数型, , , 

赋值 (现库存数量, 相加 (到数值 (.内容), 到数值 (.内容)))
.如果 (并且 (等于 (字符代码, #回车键), 等于 (.内容, “”))) ' 无进货记录
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    到尾记录 ()
    相加 (取行数 (), 1).插入行 ()
    到尾记录 ()
    取记录号 ().置文本 (1, .内容)
    取记录号 ().置文本 (2, .内容)
    取记录号 ().置文本 (3, .内容)
    取记录号 ().置文本 (4, 到文本 (到数值 (.内容)))
    取记录号 ().置文本 (5, .内容)
    取记录号 ().置文本 (6, .内容)
.否则
    .如果 (并且 (等于 (字符代码, #回车键), 不等于 (.内容, “”))) ' 有进货
        打开 (相加 (取运行目录 (), “\data\spkc.edb”), , , , , , )
        到首记录 ()
        .判断循环首 (等于 (查找 (等于 (读 (“商品编码”), 到整数 (.内容))), 真))
            取记录号 ().跳到 ()
            取记录号 ().置文本 (1, .内容)
            取记录号 ().置文本 (2, .内容)
            取记录号 ().置文本 (3, .内容)
            取记录号 ().置文本 (4, 到文本 (相加 (到数值 (.内容), 到数值 (.内容))))
            取记录号 ().置文本 (5, .内容)
            取记录号 ().置文本 (6, 到文本 (相乘 (现库存数量, 到数值 (.内容))))
            跳过 ()
        .判断循环尾 ()
    .否则
        
    .如果结束
    
.如果结束
打开 (相加 (取运行目录 (), “\data\spzl.edb”), , , , , , )
到首记录 ()
.判断循环首 (查找 (等于 (读 (“商品编码”), 到数值 (.内容))))
    取记录号 ().跳到 ()
    取记录号 ().置文本 (4, .内容)
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\spzl.edb”))
.如果 (等于 (.标题, “进货”))
    .加入项目 (.内容, )
    相加 (取行数 (), 1).插入行 ()
    到尾记录 ()
    取记录号 ().置文本 (1, .内容)
    取记录号 ().置文本 (2, .内容)
    取记录号 ().置文本 (3, .内容)
    取记录号 ().置文本 (4, .内容)
    取记录号 ().置文本 (5, 到文本 (到数值 (.内容)))
    取记录号 ().置文本 (6, .内容)
    取记录号 ().置文本 (7, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    取记录号 ().置文本 (9, 到文本 (取现行时间 ()))
    .未知支持库函数_38 ()
    取项目数 ().未知支持库函数_9 (0, #., .内容)
    取项目数 ().未知支持库函数_9 (1, #., .内容)
    取项目数 ().未知支持库函数_9 (2, #., .内容)
    取项目数 ().未知支持库函数_9 (3, #., .内容)
    取项目数 ().未知支持库函数_9 (4, #., .内容)
    取项目数 ().未知支持库函数_9 (5, #., .内容)
.否则
    未知支持库函数_3 ().置文本 (1, .内容)
    未知支持库函数_3 ().置文本 (2, .内容)
    未知支持库函数_3 ().置文本 (3, .内容)
    未知支持库函数_3 ().置文本 (4, .内容)
    未知支持库函数_3 ().置文本 (5, 到文本 (到数值 (.内容)))
    未知支持库函数_3 ().置文本 (6, .内容)
    未知支持库函数_3 ().置文本 (7, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    未知支持库函数_3 ().未知支持库函数_9 (0, #., .内容)
    未知支持库函数_3 ().未知支持库函数_9 (1, #., .内容)
    未知支持库函数_3 ().未知支持库函数_9 (2, #., .内容)
    未知支持库函数_3 ().未知支持库函数_9 (3, #., .内容)
    未知支持库函数_3 ().未知支持库函数_9 (4, #., .内容)
    未知支持库函数_3 ().未知支持库函数_9 (5, #., .内容)
.如果结束
关闭 (相加 (取运行目录 (), “\data\spkc.edb”))
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
获取焦点 ()
赋值 (.标题, “进货”)

.子程序 _修改_被选择, 空白型, , 
打开 (相加 (取运行目录 (), “\data\jhdhk.edb”), , , , , , )
到首记录 ()
.判断循环首 (查找 (等于 (读 (“进货单号”), .取项目文本 (.现行选中项))))
    取记录号 ().跳到 ()
    跳过 ()
.判断循环尾 ()
.如果 (等于 (取记录号 ().取文本 (2), “验收”))
    信息框 (“已经验收不能修改！”, 0, “提示！！！”)
.否则
    赋值 (.只读, 假)
    赋值 (.允许添加, 真)
    赋值 (.允许删除, 真)
    赋值 (.标题, “修改”)
    赋值 (.内容, 到文本 (相减 (到数值 (.内容), 到数值 (.内容))))
.如果结束
关闭 (相加 (取运行目录 (), “\data\jhdhk.edb”))

.子程序 _表格1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()


.子程序 _表格1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.内容, 取光标行号 ().取文本 (1))
赋值 (.内容, 取光标行号 ().取文本 (2))
赋值 (.内容, 取光标行号 ().取文本 (3))
赋值 (.内容, 取光标行号 ().取文本 (4))
赋值 (.内容, 取光标行号 ().取文本 (5))
赋值 (.内容, 取光标行号 ().取文本 (6))
赋值 (.内容, 取光标行号 ().取文本 (7))
打开 (相加 (取运行目录 (), “\data\spkc.edb”), , , , , , )
到首记录 ()
.判断循环首 (查找 (等于 (读 (“商品编码”), 到数值 (.内容))))
    赋值 (.内容, 到文本 (读 (“库存数量”)))
    取记录号 ().跳到 ()
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\spkc.edb”))
.如果 (等于 (.标题, “修改”))
    赋值 (.内容, 到文本 (相减 (到数值 (.内容), 到数值 (.内容))))
.否则
    
.如果结束



.子程序 _删除_被选择, 空白型, , 
.局部变量 返回值, 整数型, , , 
.局部变量 现库存数量, 小数型, , , 

打开 (相加 (取运行目录 (), “\data\jhdhk.edb”), , , , , , )
到首记录 ()
.判断循环首 (查找 (等于 (读 (“进货单号”), .取项目文本 (.现行选中项))))
    取记录号 ().跳到 ()
    跳过 ()
.判断循环尾 ()
.如果 (等于 (取记录号 ().取文本 (2), “验收”))
    信息框 (“已经验收不能修改！”, 0, “提示！！！”)
.否则
    赋值 (现库存数量, 相减 (到数值 (.内容), 到数值 (.内容)))
    赋值 (返回值, 信息框 (“真的要删除这条记录吗？”, 4, ))
    .如果真 (等于 (返回值, #是钮))
        赋值 (.只读, 假)
        赋值 (.允许添加, 假)
        赋值 (.允许删除, 真)
        未知支持库函数_3 ().删除行 (1)
        未知支持库函数_3 ().未知支持库函数_36 ()
    .如果真结束
    打开 (相加 (取运行目录 (), “\data\spkc.edb”), , , , , , )
    到首记录 ()
    .判断循环首 (等于 (查找 (等于 (读 (“商品编码”), 到整数 (.内容))), 真))
        取记录号 ().跳到 ()
        取记录号 ().置文本 (1, .内容)
        取记录号 ().置文本 (2, .内容)
        取记录号 ().置文本 (3, .内容)
        取记录号 ().置文本 (4, 到文本 (相减 (到数值 (.内容), 到数值 (.内容))))
        取记录号 ().置文本 (5, .内容)
        取记录号 ().置文本 (6, 到文本 (相乘 (现库存数量, 到数值 (.内容))))
        跳过 ()
    .判断循环尾 ()
.如果结束
关闭 (相加 (取运行目录 (), “\data\jhdhk.edb”))


.子程序 _保存_被选择, 空白型, , 
赋值 (.只读, 真)
赋值 (.允许添加, 假)
赋值 (.允许删除, 真)
赋值 (.标题, “进货”)

.子程序 _高级表格1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()


.子程序 _高级表格1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.内容, 未知支持库函数_3 ().取文本 (1))
赋值 (.内容, 未知支持库函数_3 ().取文本 (2))
赋值 (.内容, 未知支持库函数_3 ().取文本 (3))
赋值 (.内容, 未知支持库函数_3 ().取文本 (4))
赋值 (.内容, 未知支持库函数_3 ().取文本 (5))
赋值 (.内容, 未知支持库函数_3 ().取文本 (6))
赋值 (.内容, 未知支持库函数_3 ().取文本 (7))
打开 (相加 (取运行目录 (), “\data\spkc.edb”), , , , , , )
到首记录 ()
.判断循环首 (查找 (等于 (读 (“商品编码”), 到数值 (未知支持库函数_3 ().未知支持库函数_10 (1)))))
    赋值 (.内容, 到文本 (读 (“库存数量”)))
    取记录号 ().跳到 ()
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\spkc.edb”))
.如果 (等于 (.标题, “修改”))
    赋值 (.内容, 到文本 (相减 (到数值 (.内容), 到数值 (.内容))))
.否则
    
.如果结束


.子程序 _列表框3_列表项被选择, 空白型, , 
打开 (相加 (取运行目录 (), “\data\jhdhk.edb”), , , , , , )
到首记录 ()
.判断循环首 (查找 (等于 (读 (“进货单号”), .取项目文本 (.现行选中项))))
    取记录号 ().跳到 ()
    赋值 (.标题, 取记录号 ().取文本 (2))
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\jhdhk.edb”))
清空 ()
未知支持库函数_57 ()
0.未知支持库函数_9 (0, #., “进货单号”)
0.未知支持库函数_9 (1, #., “编码”)
0.未知支持库函数_9 (2, #., “商品名称”)
0.未知支持库函数_9 (3, #., “数量”)
0.未知支持库函数_9 (4, #., “进价”)
0.未知支持库函数_9 (5, #., “总计”)
0.未知支持库函数_32 (100)
1.未知支持库函数_32 (40)
2.未知支持库函数_32 (120)
3.未知支持库函数_32 (40)
4.未知支持库函数_32 (40)
5.未知支持库函数_32 (40)
赋值 (.标题, 到文本 (到数值 (1.取文本 (3))))
 ' 标签10.标题 ＝ “进货”
打开 (相加 (取运行目录 (), “\data\jhdk.edb”), , , , , , )
到首记录 ()
赋值 (., 相加 (取行数 (), 1))
.判断循环首 (等于 (查找 (不等于 (读 (“进货单号”), “”)), 真))
    读 (“进货单号”).加入项目 ()
    取项目数 ().未知支持库函数_9 (0, #., 读 (“进货单号”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“商品编码”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“商品名称”))
    取项目数 ().未知支持库函数_9 (3, #., 读 (“进货数量”))
    取项目数 ().未知支持库函数_9 (4, #., 读 (“进价”))
    取项目数 ().未知支持库函数_9 (5, #., 读 (“总计”))
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\jhdk.edb”))


.窗口程序集 窗口程序集7, , , 

.子程序 _出库_创建完毕, 空白型, , 
打开 (相加 (取运行目录 (), “\data\fcdhk.edb”), , , , , , )
到首记录 ()
.判断循环首 (等于 (查找 (不等于 (读 (“返厂单号”), “”)), 真))
    读 (“返厂单号”).加入项目 ()
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\fcdhk.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\fcdhk.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\spkc.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\config.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\fcdk.edb”))
0.未知支持库函数_9 (0, #., “出库单号”)
0.未知支持库函数_9 (1, #., “编码”)
0.未知支持库函数_9 (2, #., “商品名称”)
0.未知支持库函数_9 (3, #., “数量”)
0.未知支持库函数_9 (4, #., “进价”)
0.未知支持库函数_9 (5, #., “出库日期”)
0.未知支持库函数_32 (100)
1.未知支持库函数_32 (45)
2.未知支持库函数_32 (120)
3.未知支持库函数_32 (45)
4.未知支持库函数_32 (45)
5.未知支持库函数_32 (120)
获取焦点 ()
赋值 (.标题, “出库”)
打开 (相加 (取运行目录 (), “\data\fcdk.edb”), , , , , , )
到首记录 ()
赋值 (., 相加 (取行数 (), 1))
.判断循环首 (等于 (查找 (不等于 (读 (“出库单号”), “”)), 真))
    读 (“出库单号”).加入项目 ()
    取项目数 ().未知支持库函数_9 (0, #., 读 (“出库单号”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“商品编号”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“商品名称”))
    取项目数 ().未知支持库函数_9 (3, #., 读 (“出库数量”))
    取项目数 ().未知支持库函数_9 (4, #., 读 (“进价”))
    取项目数 ().未知支持库函数_9 (5, #., 到文本 (读 (“出库日期”)))
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\fcdk.edb”))


.子程序 _编辑框2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\spkc.edb”))
.如果真 (并且 (等于 (字符代码, #回车键), 不等于 (.内容, “”)))
    打开 (相加 (取运行目录 (), “\data\spkc.edb”), , , , , , )
    到首记录 ()
    .判断循环首 (查找 (等于 (读 (“商品编码”), 到数值 (.内容))))
        赋值 (.内容, 读 (“商品名称”))
        赋值 (.内容, 读 (“单位”))
        赋值 (.内容, 到文本 (读 (“库存数量”)))
        赋值 (.内容, 到文本 (读 (“进价”)))
        跳过 ()
    .判断循环尾 ()
    关闭 (相加 (取运行目录 (), “\data\spkc.edb”))
.如果真结束
.如果真 (等于 (字符代码, #回车键))
    .如果 (不等于 (.内容, “”))
        获取焦点 ()
    .否则
        信息框 (“商品编码错误，或无入库记录！”, 0, )
        赋值 (.内容, “”)
        获取焦点 ()
    .如果结束
    
.如果真结束


.子程序 _编辑框6_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _按钮1_被单击, 空白型, , 
赋值 (月份, 到文本 (取月份 (取现行时间 ())))
.如果 (小于 (到数值 (月份), 10))
    赋值 (月份, 相加 (“0”, 月份))
.否则
    
.如果结束
赋值 (日期, 到文本 (取日 (取现行时间 ())))
.如果 (小于 (到数值 (日期), 10))
    赋值 (日期, 相加 (“0”, 日期))
.否则
    
.如果结束
打开 (相加 (取运行目录 (), “\data\fcdk.edb”), , , , , , )
到首记录 ()
.判断循环首 (查找 (近似等于 (读 (“出库单号”), 相加 (到文本 (取年份 (取现行时间 ())), 月份, 日期))))
    0.插入项目 (读 (“出库单号”), )
    跳过 ()
.判断循环尾 ()
赋值 (.标题, 到文本 (取最大值 (到数值 (读 (“出库单号”)), 近似等于 (读 (“出库单号”), 相加 (到文本 (取年份 (取现行时间 ())), 月份, 日期)))))
关闭 (相加 (取运行目录 (), “\data\fcdk.edb”))
.如果 (小于 (取项目数 (), 1))
    赋值 (.内容, 相加 (到文本 (取年份 (取现行时间 ())), 月份, 日期, “0001”))
.否则
    赋值 (.内容, 到文本 (相加 (到数值 (.标题), 1)))
.如果结束
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
相加 (取行数 (), 1).插入行 ()
到尾记录 ()
取记录号 ().置文本 (1, .内容)
.加入项目 (.内容, )
获取焦点 ()
赋值 (.禁止, 真)
赋值 (.禁止, 假)
赋值 (.标题, “出库”)

.子程序 _按钮2_被单击, 空白型, , 
赋值 (.禁止, 假)
赋值 (.禁止, 真)


.子程序 _按钮3_被单击, 空白型, , 
打开 (相加 (取运行目录 (), “\data\fcdhk.edb”), , , , , , )
到首记录 ()
.判断循环首 (查找 (等于 (读 (“返厂单号”), .取项目文本 (.现行选中项))))
    取记录号 ().跳到 ()
    取记录号 ().置文本 (2, “验收”)
    .如果 (等于 (取记录号 ().取文本 (2), “验收”))
        信息框 (“验收成功！”, 0, “提示”)
    .否则
        信息框 (“验收失败！”, 0, “提示”)
    .如果结束
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\fcdhk.edb”))


.子程序 _编辑框7_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (并且 (等于 (字符代码, #回车键), 不等于 (.内容, “”)))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    获取焦点 ()
.如果真结束


.子程序 _修改_被选择, 空白型, , 
打开 (相加 (取运行目录 (), “\data\fcdhk.edb”), , , , , , )
到首记录 ()
.判断循环首 (查找 (等于 (读 (“返厂单号”), .取项目文本 (.现行选中项))))
    取记录号 ().跳到 ()
    跳过 ()
.判断循环尾 ()
.如果 (等于 (取记录号 ().取文本 (2), “验收”))
    信息框 (“提示！！！”, 0, “已经验收不能修改！”)
.否则
    赋值 (.只读, 假)
    赋值 (.允许添加, 真)
    赋值 (.允许删除, 真)
    赋值 (.标题, “修改”)
    赋值 (.内容, 到文本 (相加 (到数值 (.内容), 到数值 (.内容))))
.如果结束
关闭 (相加 (取运行目录 (), “\data\fcdhk.edb”))

.子程序 _删除明细_被选择, 空白型, , 
.局部变量 现库存数量, 小数型, , , 
.局部变量 返回值, 整数型, , , 

打开 (相加 (取运行目录 (), “\data\fcdhk.edb”), , , , , , )
到首记录 ()
.判断循环首 (查找 (等于 (读 (“返厂单号”), .取项目文本 (.现行选中项))))
    取记录号 ().跳到 ()
    跳过 ()
.判断循环尾 ()
.如果 (等于 (取记录号 ().取文本 (2), “验收”))
    信息框 (“已经验收不能修改！”, 0, “提示！！！”)
.否则
    赋值 (现库存数量, 相加 (到数值 (.内容), 到数值 (.内容)))
    赋值 (返回值, 信息框 (“真的要删除这条记录吗？”, 4, ))
    .如果真 (等于 (返回值, #是钮))
        赋值 (.只读, 假)
        赋值 (.允许添加, 假)
        赋值 (.允许删除, 真)
        未知支持库函数_3 ().删除行 (1)
        未知支持库函数_3 ().未知支持库函数_36 ()
        0.删除项目 ()
    .如果真结束
    打开 (相加 (取运行目录 (), “\data\spkc.edb”), , , , , , )
    到首记录 ()
    .判断循环首 (等于 (查找 (等于 (读 (“商品编码”), 到整数 (.内容))), 真))
        取记录号 ().跳到 ()
        取记录号 ().置文本 (1, .内容)
        取记录号 ().置文本 (2, .内容)
        取记录号 ().置文本 (3, .内容)
        取记录号 ().置文本 (4, 到文本 (相加 (到数值 (.内容), 到数值 (.内容))))
        取记录号 ().置文本 (5, .内容)
        取记录号 ().置文本 (6, 到文本 (相乘 (现库存数量, 到数值 (.内容))))
        跳过 ()
    .判断循环尾 ()
.如果结束
关闭 (相加 (取运行目录 (), “\data\fcdhk.edb”))


.子程序 _表格1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 现库存数量, 小数型, , , 

赋值 (.内容, 取光标行号 ().取文本 (1))
赋值 (.内容, 取光标行号 ().取文本 (2))
赋值 (.内容, 取光标行号 ().取文本 (3))
赋值 (.内容, 取光标行号 ().取文本 (4))
赋值 (.内容, 取光标行号 ().取文本 (5))
打开 (相加 (取运行目录 (), “\data\spkc.edb”), , , , , , )
到首记录 ()
.判断循环首 (查找 (等于 (读 (“商品编码”), 到数值 (.内容))))
    取记录号 ().跳到 ()
    .如果 (等于 (.标题, “修改”))
        赋值 (.内容, 到文本 (相加 (读 (“库存数量”), 到数值 (.内容))))
    .否则
        赋值 (.内容, 到文本 (读 (“库存数量”)))
    .如果结束
    赋值 (.内容, 到文本 (读 (“进价”)))
    跳过 ()
.判断循环尾 ()
.如果 (等于 (.标题, “修改”))
    赋值 (现库存数量, 相加 (到数值 (.内容), 到数值 (.内容)))
.否则
    赋值 (现库存数量, 相减 (到数值 (.内容), 到数值 (.内容)))
.如果结束
关闭 (相加 (取运行目录 (), “\data\spkc.edb”))


.子程序 _表格1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _保存_被选择, 空白型, , 
赋值 (.只读, 真)
赋值 (.允许添加, 假)
赋值 (.允许删除, 假)
赋值 (.标题, “”)

.子程序 _编辑框8_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.局部变量 现库存数量, 小数型, , , 

赋值 (现库存数量, 相加 (到数值 (.内容), 到数值 (.内容)))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\spkc.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\fcdk.edb”))
.如果 (并且 (等于 (字符代码, #回车键), 不等于 (.内容, “”)))
    打开 (相加 (取运行目录 (), “\data\spkc.edb”), , , , , , )
    到首记录 ()
    .判断循环首 (等于 (查找 (等于 (读 (“商品编码”), 到数值 (.内容))), 真))
        取记录号 ().跳到 ()
        赋值 (现库存数量, 相减 (到数值 (.内容), 到数值 (.内容)))
        取记录号 ().置文本 (4, 到文本 (相减 (到数值 (.内容), 到数值 (.内容))))
        取记录号 ().置文本 (6, 到文本 (相乘 (现库存数量, 到数值 (.内容))))
        跳过 ()
    .判断循环尾 ()
    关闭 (相加 (取运行目录 (), “\data\spkc.edb”))
    .如果 (等于 (.标题, “出库”))
        .加入项目 (.内容, )
        相加 (取行数 (), 1).插入行 ()
        到尾记录 ()
        取记录号 ().置文本 (1, .内容)
        取记录号 ().置文本 (2, .内容)
        取记录号 ().置文本 (3, .内容)
        取记录号 ().置文本 (4, .内容)
        取记录号 ().置文本 (5, .内容)
        取记录号 ().置文本 (6, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
        取记录号 ().置文本 (7, 到文本 (取现行时间 ()))
        .未知支持库函数_38 ()
        取项目数 ().未知支持库函数_9 (0, #., .内容)
        取项目数 ().未知支持库函数_9 (1, #., .内容)
        取项目数 ().未知支持库函数_9 (2, #., .内容)
        取项目数 ().未知支持库函数_9 (3, #., .内容)
        取项目数 ().未知支持库函数_9 (4, #., .内容)
        取项目数 ().未知支持库函数_9 (5, #., .内容)
    .否则
        未知支持库函数_3 ().置文本 (1, .内容)
        未知支持库函数_3 ().置文本 (2, .内容)
        未知支持库函数_3 ().置文本 (3, .内容)
        未知支持库函数_3 ().置文本 (4, .内容)
        未知支持库函数_3 ().置文本 (5, .内容)
        未知支持库函数_3 ().置文本 (6, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
        未知支持库函数_3 ().未知支持库函数_9 (0, #., .内容)
        未知支持库函数_3 ().未知支持库函数_9 (1, #., .内容)
        未知支持库函数_3 ().未知支持库函数_9 (2, #., .内容)
        未知支持库函数_3 ().未知支持库函数_9 (3, #., .内容)
        未知支持库函数_3 ().未知支持库函数_9 (4, #., .内容)
        未知支持库函数_3 ().未知支持库函数_9 (5, #., .内容)
        
    .如果结束
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.标题, “出库”)
    获取焦点 ()
.否则
    
.如果结束


.子程序 _高级表格1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()


.子程序 _高级表格1_被单击, 空白型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 

赋值 (.内容, 未知支持库函数_3 ().取文本 (1))
赋值 (.内容, 未知支持库函数_3 ().取文本 (2))
赋值 (.内容, 未知支持库函数_3 ().取文本 (3))
赋值 (.内容, 未知支持库函数_3 ().取文本 (4))
赋值 (.内容, 未知支持库函数_3 ().取文本 (5))
 ' 编辑框7.内容 ＝ 出库数据源.取文本 (高级表格1.取光标行号 (), 6)
赋值 (.内容, 未知支持库函数_3 ().取文本 (6))
打开 (相加 (取运行目录 (), “\data\spkc.edb”), , , , , , )
到首记录 ()
.判断循环首 (查找 (等于 (读 (“商品编码”), 到数值 (.内容))))
    赋值 (.内容, 到文本 (读 (“库存数量”)))
    取记录号 ().跳到 ()
    跳过 ()
.判断循环尾 ()
赋值 (.内容, 到文本 (到数值 (相除 (到数值 (.内容), 到数值 (.内容)))))
关闭 (相加 (取运行目录 (), “\data\spkc.edb”))
.如果 (等于 (.标题, “修改”))
    赋值 (.内容, 到文本 (相加 (到数值 (.内容), 到数值 (.内容))))
.否则
    
.如果结束


.子程序 _按钮4_被单击, 空白型, , 
.如果 (等于 (.禁止, 假))
    信息框 (“单据没有存盘，请点<保存>按钮存盘”, 0, )
.否则
    出库.销毁 ()
.如果结束



.子程序 _列表框3_列表项被选择, 空白型, , 
打开 (相加 (取运行目录 (), “\data\fcdhk.edb”), , , , , , )
到首记录 ()
.判断循环首 (查找 (等于 (读 (“返厂单号”), .取项目文本 (.现行选中项))))
    取记录号 ().跳到 ()
    赋值 (.标题, 取记录号 ().取文本 (2))
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\fcdhk.edb”))
未知支持库函数_57 ()
清空 ()
0.未知支持库函数_9 (0, #., “出库单号”)
0.未知支持库函数_9 (1, #., “编码”)
0.未知支持库函数_9 (2, #., “商品名称”)
0.未知支持库函数_9 (3, #., “数量”)
0.未知支持库函数_9 (4, #., “进价”)
0.未知支持库函数_9 (5, #., “出库日期”)
0.未知支持库函数_32 (100)
1.未知支持库函数_32 (45)
2.未知支持库函数_32 (120)
3.未知支持库函数_32 (45)
4.未知支持库函数_32 (45)
5.未知支持库函数_32 (120)
获取焦点 ()
赋值 (.标题, “出库”)
打开 (相加 (取运行目录 (), “\data\fcdk.edb”), , , , , , )
到首记录 ()
赋值 (., 相加 (取行数 (), 1))
.判断循环首 (等于 (查找 (等于 (读 (“出库单号”), .取项目文本 (.现行选中项))), 真))
    读 (“出库单号”).加入项目 ()
    取项目数 ().未知支持库函数_9 (0, #., 读 (“出库单号”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“商品编号”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“商品名称”))
    取项目数 ().未知支持库函数_9 (3, #., 读 (“出库数量”))
    取项目数 ().未知支持库函数_9 (4, #., 读 (“进价”))
    取项目数 ().未知支持库函数_9 (5, #., 到文本 (读 (“出库日期”)))
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\fcdk.edb”))


.窗口程序集 窗口程序集8, , , 

.子程序 _业务操作_创建完毕, 空白型, , 
.局部变量 时间值1, 文本型, , , 

赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\xfbb.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\xfbbtem.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\xsls.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\xslsss.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\spzl.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\spkc.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\fjzl.edb”))
赋值 (月份, 到文本 (取月份 (取现行时间 ())))
赋值 (日期, 到文本 (取日 (取现行时间 ())))
赋值 (小时, 到文本 (取小时 (取现行时间 ())))
打开 (相加 (取运行目录 (), “\data\config.edb”), , , , , , )
赋值 (时间值1, 读 (“结帐时间”))
关闭 (相加 (取运行目录 (), “\data\config.edb”))
0.未知支持库函数_9 (0, #., “商品编码”)
0.未知支持库函数_9 (1, #., “商品名称”)
0.未知支持库函数_9 (2, #., “单位”)
0.未知支持库函数_9 (3, #., “售价”)
0.未知支持库函数_9 (4, #., “类别”)
0.未知支持库函数_9 (5, #., “折扣率”)
0.未知支持库函数_32 (60)
1.未知支持库函数_32 (100)
2.未知支持库函数_32 (40)
3.未知支持库函数_32 (40)
4.未知支持库函数_32 (40)
获取焦点 ()
打开 (相加 (取运行目录 (), “\data\splb.edb”), , , , , , )
到首记录 ()
.判断循环首 (查找 (大于 (读 (“类别编号”), 0)))
    读 (“类别名称”).未知支持库函数_1 (未知支持库函数_5 ())
    读 (“类别名称”).加入项目 (取项目数 ())
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\splb.edb”))
打开 (相加 (取运行目录 (), “\data\spzl.edb”), , , , , , )
到首记录 ()
赋值 (., 1)
.判断循环首 (查找 (等于 (读 (“类别号”), 1)))
    读 (“商品名称”).加入项目 ()
    取项目数 ()
    赋值 (., 相加 (取项目数 (), 1))
    取项目数 ().未知支持库函数_9 (0, #., 读 (“商品编码”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“商品名称”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“单位”))
    取项目数 ().未知支持库函数_9 (3, #., 读 (“售价”))
    取项目数 ().未知支持库函数_9 (4, #., 读 (“类别”))
    取项目数 ().未知支持库函数_9 (5, #., 读 (“折扣率”))
    跳过 ()
.判断循环尾 ()
1.未知支持库函数_0 (0)
关闭 (相加 (取运行目录 (), “\data\spzl.edb”))
清空 ()
未知支持库函数_57 ()
0.未知支持库函数_9 (0, #., “台名”)
0.未知支持库函数_9 (1, #., “人数”)
0.未知支持库函数_9 (2, #., “状态”)
0.未知支持库函数_9 (3, #., “消费”)
0.未知支持库函数_9 (4, #., “流水号”)
0.未知支持库函数_9 (5, #., “折扣率”)
1.未知支持库函数_0 (0)
打开 (相加 (取运行目录 (), “\data\xfbb.edb”), , , , , , )
到首记录 ()
赋值 (., 1)
.如果 (小于 (到数值 (小时), 到数值 (时间值1)))
    .判断循环首 (查找 (并且 (小于 (到时间 (读 (“开台时间”)), 到时间 (相加 (到文本 (取年份 (取现行时间 ())), “年”, 月份, “月”, 日期, “日”, 时间值1, “时”))), 查找 (等于 (大于 (到时间 (读 (“开台时间”)), 到时间 (相加 (到文本 (取年份 (取现行时间 ())), “年”, 月份, “月”, 到文本 (相减 (到数值 (日期), 1)), “日”))), 真)))))
        到文本 (读 (“流水号”)).加入项目 ()
        取项目数 ()
        赋值 (., 相加 (取项目数 (), 1))
        取项目数 ().未知支持库函数_9 (0, #., 读 (“台名”))
        取项目数 ().未知支持库函数_9 (1, #., 读 (“人数”))
        取项目数 ().未知支持库函数_9 (2, #., 读 (“状态”))
        取项目数 ().未知支持库函数_9 (3, #., 读 (“消费”))
        取项目数 ().未知支持库函数_9 (4, #., 读 (“流水号”))
        取项目数 ().未知支持库函数_9 (5, #., 读 (“折扣率”))
        跳过 ()
    .判断循环尾 ()
.否则
    .如果 (大于 (到数值 (小时), 到数值 (时间值1)))
        .判断循环首 (查找 (等于 (等于 (取日期 (到时间 (读 (“开台时间”))), 取日期 (取现行时间 ())), 真)))
            到文本 (读 (“流水号”)).加入项目 ()
            取项目数 ()
            赋值 (., 相加 (取项目数 (), 1))
            取项目数 ().未知支持库函数_9 (0, #., 读 (“台名”))
            取项目数 ().未知支持库函数_9 (1, #., 读 (“人数”))
            取项目数 ().未知支持库函数_9 (2, #., 读 (“状态”))
            取项目数 ().未知支持库函数_9 (3, #., 读 (“消费”))
            取项目数 ().未知支持库函数_9 (4, #., 读 (“流水号”))
            取项目数 ().未知支持库函数_9 (5, #., 读 (“折扣率”))
            跳过 ()
        .判断循环尾 ()
    .否则
        
    .如果结束
    
.如果结束
关闭 (相加 (取运行目录 (), “\data\xfbb.edb”))

清空 ()
未知支持库函数_57 ()
0.未知支持库函数_9 (0, #., “商品编号”)
0.未知支持库函数_9 (1, #., “商品名称”)
0.未知支持库函数_9 (2, #., “单位”)
0.未知支持库函数_9 (3, #., “销售数量”)
0.未知支持库函数_9 (4, #., “单价”)
0.未知支持库函数_9 (5, #., “总计”)
0.未知支持库函数_9 (6, #., “折扣率”)
打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
到首记录 ()
赋值 (., 1)
.判断循环首 (等于 (查找 (等于 (读 (“流水单号”), .标题)), 真))
    读 (“商品名称”).加入项目 ()
    取项目数 ()
    赋值 (., 相加 (取项目数 (), 1))
    取项目数 ().未知支持库函数_9 (0, #., 读 (“商品编号”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“商品名称”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“单位”))
    取项目数 ().未知支持库函数_9 (3, #., 读 (“销售数量”))
    取项目数 ().未知支持库函数_9 (4, #., 读 (“售价”))
    取项目数 ().未知支持库函数_9 (5, #., 读 (“总计”))
    取项目数 ().未知支持库函数_9 (6, #., 读 (“折扣率”))
    跳过 ()
.判断循环尾 ()
.未知支持库函数_38 ()
相加 (取项目数 (), 1).未知支持库函数_9 (4, #., “合计:”)
相加 (取项目数 (), 1).未知支持库函数_0 (5)
5.未知支持库函数_30 (#.)
5.未知支持库函数_41 (2)
5.未知支持库函数_66 (1, 相加 (取项目数 (), 1), )
关闭 (相加 (取运行目录 (), “\data\xsls.edb”))


.子程序 _开台_被选择, 空白型, , 
载入 (开台操作, , 真)

.子程序 _点单_被选择, 空白型, , 
.如果 (并且 (不等于 (.标题, “”), 等于 (未知支持库函数_3 ().未知支持库函数_10 (2), “结帐”)))
    信息框 (“已经结帐，不能再点单！”, 0, )
.否则
    载入 (点单操作, , 真)
.如果结束


.子程序 _结帐_被选择, 空白型, , 
.如果 (并且 (不等于 (.标题, “”), 等于 (未知支持库函数_3 ().未知支持库函数_10 (2), “结帐”)))
    信息框 (“已经结帐，不能重复结帐！”, 0, )
.否则
    载入 (结帐操作, , 真)
.如果结束


.子程序 _表格2_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _表格1_选择行列数改变, 空白型, , 
赋值 (.标题, 取光标行号 ().取文本 (12))
赋值 (.内容, 取光标行号 ().取文本 (1))
清空 ()
未知支持库函数_57 ()
0.未知支持库函数_9 (0, #., “商品编号”)
0.未知支持库函数_9 (1, #., “商品名称”)
0.未知支持库函数_9 (2, #., “单位”)
0.未知支持库函数_9 (3, #., “销售数量”)
0.未知支持库函数_9 (4, #., “单价”)
0.未知支持库函数_9 (5, #., “总计”)
打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
到首记录 ()
赋值 (., 1)
.判断循环首 (等于 (查找 (等于 (读 (“流水单号”), .标题)), 真))
    读 (“商品名称”).加入项目 ()
    取项目数 ()
    赋值 (., 相加 (取项目数 (), 1))
    取项目数 ().未知支持库函数_9 (0, #., 读 (“商品编号”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“商品名称”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“单位”))
    取项目数 ().未知支持库函数_9 (3, #., 读 (“销售数量”))
    取项目数 ().未知支持库函数_9 (4, #., 读 (“售价”))
    取项目数 ().未知支持库函数_9 (5, #., 读 (“总计”))
    跳过 ()
.判断循环尾 ()
.未知支持库函数_38 ()
5.未知支持库函数_30 (#.)
5.未知支持库函数_41 (2)
5.未知支持库函数_66 (1, 相加 (取项目数 (), 1), )
赋值 (.内容, 到文本 (求和 (到数值 (读 (“总计”)), 等于 (读 (“流水单号”), .标题))))
相加 (取项目数 (), 1).未知支持库函数_9 (4, #., “合计:”)
相加 (取项目数 (), 1).未知支持库函数_9 (5, #., .内容)
相加 (取项目数 (), 1).未知支持库函数_0 (5)
关闭 (相加 (取运行目录 (), “\data\xsls.edb”))

.子程序 _表格1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (取光标行号 ().取文本 (3), “结帐”))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (等于 (取光标行号 ().取文本 (3), “满”))
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    
.如果真结束


.子程序 _表格2_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.禁止, 真)
赋值 (.禁止, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 真)

.子程序 _按钮1_被单击, 空白型, , 
销毁 ()

.子程序 _结帐报表_被选择, 空白型, , 
载入 (结帐报表, , 真)


.子程序 _高级表格1_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()


.子程序 _高级表格1_光标位置改变, 空白型, , 
赋值 (.标题, 未知支持库函数_3 ().未知支持库函数_10 (4))
赋值 (.内容, 未知支持库函数_3 ().未知支持库函数_10 (0))
赋值 (.内容, 未知支持库函数_3 ().未知支持库函数_10 (5))
清空 ()
未知支持库函数_57 ()
0.未知支持库函数_9 (0, #., “商品编号”)
0.未知支持库函数_9 (1, #., “商品名称”)
0.未知支持库函数_9 (2, #., “单位”)
0.未知支持库函数_9 (3, #., “销售数量”)
0.未知支持库函数_9 (4, #., “单价”)
0.未知支持库函数_9 (5, #., “总计”)
0.未知支持库函数_9 (6, #., “折扣率”)
打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
到首记录 ()
赋值 (., 1)
.判断循环首 (等于 (查找 (等于 (读 (“流水单号”), .标题)), 真))
    读 (“商品名称”).加入项目 ()
    取项目数 ()
    赋值 (., 相加 (取项目数 (), 1))
    取项目数 ().未知支持库函数_9 (0, #., 读 (“商品编号”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“商品名称”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“单位”))
    取项目数 ().未知支持库函数_9 (3, #., 读 (“销售数量”))
    取项目数 ().未知支持库函数_9 (4, #., 读 (“售价”))
    取项目数 ().未知支持库函数_9 (5, #., 读 (“总计”))
    取项目数 ().未知支持库函数_9 (6, #., 读 (“折扣率”))
    跳过 ()
.判断循环尾 ()
.未知支持库函数_38 ()
5.未知支持库函数_30 (#.)
5.未知支持库函数_41 (2)
5.未知支持库函数_66 (1, 相加 (取项目数 (), 1), )
赋值 (.内容, 到文本 (求和 (到数值 (读 (“总计”)), 等于 (读 (“流水单号”), .标题))))
相加 (取项目数 (), 1).未知支持库函数_9 (4, #., “合计:”)
相加 (取项目数 (), 1).未知支持库函数_9 (5, #., .内容)
相加 (取项目数 (), 1).未知支持库函数_0 (5)
关闭 (相加 (取运行目录 (), “\data\xsls.edb”))


.子程序 _高级表格1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.禁止, 真)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
 ' 点单.禁止 ＝ 真

.子程序 _标签1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (., 真))
    赋值 (., 假)
    赋值 (.可视, 真)
.否则
    赋值 (., 真)
    赋值 (.可视, 假)
.如果结束


.子程序 _取消单品_被选择, 空白型, , 
.局部变量 返回值, 整数型, , , 

.如果 (并且 (不等于 (.标题, “”), 等于 (未知支持库函数_3 ().未知支持库函数_10 (2), “结帐”)))
    信息框 (“已经结帐，不能取消单品！”, 0, )
.否则
    赋值 (返回值, 信息框 (相加 (“真的要删除”, “《”, 未知支持库函数_3 ().未知支持库函数_10 (1), “》”, “记录吗？”), 4, ))
    .如果真 (等于 (返回值, #是钮))
        打开 (相加 (取运行目录 (), “\data\spkc.edb”), , , , , , )
        到首记录 ()
        .判断循环首 (等于 (查找 (等于 (读 (“商品编码”), 到整数 (未知支持库函数_3 ().未知支持库函数_10 (0)))), 真))
            取记录号 ().跳到 ()
            取记录号 ().置文本 (4, 到文本 (相加 (到数值 (取记录号 ().取文本 (4)), 到数值 (未知支持库函数_3 ().未知支持库函数_10 (3)))))
            取记录号 ().置文本 (6, 到文本 (相加 (到数值 (取记录号 ().取文本 (6)), 到数值 (相乘 (到数值 (未知支持库函数_3 ().未知支持库函数_10 (3)), 到数值 (取记录号 ().取文本 (5)))))))
            跳过 ()
        .判断循环尾 ()
        关闭 (相加 (取运行目录 (), “\data\spkc.edb”))
        打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
        到首记录 ()
        .判断循环首 (并且 (查找 (等于 (读 (“商品编号”), 未知支持库函数_3 ().未知支持库函数_10 (0))), 查找 (等于 (读 (“流水单号”), .标题)), 等于 (查找 (等于 (读 (“销售数量”), 未知支持库函数_3 ().未知支持库函数_10 (3))), 真)))
            取记录号 ().跳到 ()
            取记录号 ().删除行 (1)
            未知支持库函数_3 ().未知支持库函数_36 ()
            0.删除项目 ()
            跳过 ()
        .判断循环尾 ()
        关闭 (相加 (取运行目录 (), “\data\xsls.edb”))
    .如果真结束
    
.如果结束


.子程序 _高级表格2_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()


.子程序 _高级表格2_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.禁止, 真)
赋值 (.禁止, 假)
赋值 (.禁止, 真)


.子程序 _取消单据_被选择, 空白型, , 
.局部变量 返回值, 整数型, , , 

.如果 (大于 (取项目数 (), 0))
    信息框 (“请先取消单品，然后再取消单据！”, 0, )
.否则
    赋值 (返回值, 信息框 (相加 (“真的要删除”, “《”, .标题, “》”, “记录吗？”), 4, ))
    .如果真 (等于 (返回值, #是钮))
        打开 (相加 (取运行目录 (), “\data\xfbb.edb”), , , , , , )
        到首记录 ()
        .判断循环首 (等于 (查找 (等于 (读 (“流水号”), .标题)), 真))
            取记录号 ().跳到 ()
            取记录号 ().删除行 (1)
            未知支持库函数_3 ().未知支持库函数_36 ()
            0.删除项目 ()
            跳过 ()
        .判断循环尾 ()
        关闭 (相加 (取运行目录 (), “\data\xfbb.edb”))
        打开 (相加 (取运行目录 (), “\data\xfbbtem.edb”), , , , , , )
        到首记录 ()
        .判断循环首 (等于 (查找 (等于 (读 (“流水号”), .标题)), 真))
            取记录号 ().跳到 ()
            取记录号 ().删除行 (1)
            跳过 ()
        .判断循环尾 ()
        关闭 (相加 (取运行目录 (), “\data\xfbbtem.edb”))
        打开 (相加 (取运行目录 (), “\data\fjzl.edb”), , , , , , )
        到首记录 ()
        .判断循环首 (查找 (等于 (读 (“房间名称”), .内容))) ' 高级表格1.取数据 (高级表格1.取光标行号 (), 0)))
            取记录号 ().跳到 ()
            取记录号 ().置文本 (3, “0”)
            取记录号 ().置文本 (4, “空”)
            跳过 ()
        .判断循环尾 ()
        关闭 (相加 (取运行目录 (), “\data\fjzl.edb”))
        赋值 (.标题, “”)
    .如果真结束
    
.如果结束


.子程序 _卷帘式菜单1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.标题, 到文本 (相加 (.未知支持库函数_11 (.), 1)))
清空 ()
未知支持库函数_57 ()
0.未知支持库函数_9 (0, #., “商品编码”)
0.未知支持库函数_9 (1, #., “商品名称”)
0.未知支持库函数_9 (2, #., “单位”)
0.未知支持库函数_9 (3, #., “售价”)
0.未知支持库函数_9 (4, #., “类别”)
0.未知支持库函数_32 (60)
1.未知支持库函数_32 (100)
2.未知支持库函数_32 (40)
3.未知支持库函数_32 (40)
4.未知支持库函数_32 (40)
打开 (相加 (取运行目录 (), “\data\spzl.edb”), , , , , , )
到首记录 ()
赋值 (., 1)
.判断循环首 (查找 (等于 (读 (“类别号”), 到数值 (.标题))))
    读 (“商品名称”).加入项目 ()
    取项目数 ()
    赋值 (., 相加 (取项目数 (), 1))
    取项目数 ().未知支持库函数_9 (0, #., 读 (“商品编码”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“商品名称”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“单位”))
    取项目数 ().未知支持库函数_9 (3, #., 读 (“售价”))
    取项目数 ().未知支持库函数_9 (4, #., 读 (“类别”))
    跳过 ()
.判断循环尾 ()
1.未知支持库函数_0 (0)
关闭 (相加 (取运行目录 (), “\data\spzl.edb”))

.子程序 _卷帘式菜单1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

打开 (相加 (取运行目录 (), “\data\spzl.edb”), , , , , , )
到首记录 ()
.判断循环首 (等于 (查找 (等于 (读 (“商品编码”), 到数值 (未知支持库函数_3 ().未知支持库函数_10 (0)))), 真))
    取记录号 ().跳到 ()
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\spzl.edb”))


.子程序 _高级表格3_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()


.子程序 _高级表格2_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (., 真))
    赋值 (., 相加 (., .))
    赋值 (., 假)
    赋值 (., 假)
    赋值 (.可视, 假)
.否则
    赋值 (., 真)
    赋值 (., 真)
    赋值 (.可视, 真)
    赋值 (., 相减 (., .))
.如果结束



.子程序 _列表框4_列表项被选择, 空白型, , 
赋值 (.标题, 到文本 (相加 (.取项目数值 (.现行选中项), 1)))
清空 ()
未知支持库函数_57 ()
0.未知支持库函数_9 (0, #., “商品编码”)
0.未知支持库函数_9 (1, #., “商品名称”)
0.未知支持库函数_9 (2, #., “单位”)
0.未知支持库函数_9 (3, #., “售价”)
0.未知支持库函数_9 (4, #., “类别”)
0.未知支持库函数_9 (5, #., “折扣率”)
0.未知支持库函数_32 (60)
1.未知支持库函数_32 (100)
2.未知支持库函数_32 (40)
3.未知支持库函数_32 (40)
4.未知支持库函数_32 (40)
打开 (相加 (取运行目录 (), “\data\spzl.edb”), , , , , , )
到首记录 ()
赋值 (., 1)
.判断循环首 (查找 (等于 (读 (“类别号”), 到数值 (.标题))))
    读 (“商品名称”).加入项目 ()
    取项目数 ()
    赋值 (., 相加 (取项目数 (), 1))
    取项目数 ().未知支持库函数_9 (0, #., 读 (“商品编码”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“商品名称”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“单位”))
    取项目数 ().未知支持库函数_9 (3, #., 读 (“售价”))
    取项目数 ().未知支持库函数_9 (4, #., 读 (“类别”))
    取项目数 ().未知支持库函数_9 (5, #., 读 (“折扣率”))
    跳过 ()
.判断循环尾 ()
1.未知支持库函数_0 (0)
.判断循环首 (等于 (查找 (等于 (读 (“商品编码”), 到数值 (未知支持库函数_3 ().未知支持库函数_10 (0)))), 真))
    取记录号 ().跳到 ()
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\spzl.edb”))


.子程序 _打折_被选择, 空白型, , 
.如果 (并且 (大于 (取项目数 (), 0), 等于 (未知支持库函数_3 ().未知支持库函数_10 (2), “结帐”)))
    信息框 (“单据已结帐，不能打折！”, 0, “提示！！！”)
.否则
    载入 (单据折扣, , 真)
.如果结束


.子程序 _编辑框3_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.局部变量 折扣, 整数型, , , 
.局部变量 单价, 小数型, , , 
.局部变量 记录, 整数型, , , 

.如果真 (并且 (等于 (字符代码, #回车键), 不等于 (.内容, “”)))
    .计次循环首 (业务操作.取项目数 (.), 计次变量)
        赋值 (.标题, 到文本 (计次变量))
        打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
        到首记录 ()
        查找 (并且 (等于 (读 (“流水单号”), .标题), 查找 (并且 (等于 (读 (“商品编号”), 计次变量.未知支持库函数_10 (0)), 查找 (等于 (读 (“销售数量”), 计次变量.未知支持库函数_10 (3)))))))
        取记录号 ().跳到 ()
        取记录号 ().置文本 (7, 到文本 (相乘 (到数值 (计次变量.未知支持库函数_10 (5)), 到数值 (相除 (到数值 (计次变量.未知支持库函数_10 (6)), 100)))))
        关闭 (相加 (取运行目录 (), “\data\xsls.edb”))
    .计次循环尾 ()
    业务操作.取记录号 (.).置文本 (16, .内容)
    取项目数 ().未知支持库函数_9 (5, #., .内容)
.如果真结束


.窗口程序集 窗口程序集9, , , 

.子程序 _开台操作_创建完毕, 空白型, , 
.局部变量 循环变量, 整数型, , , 

赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\config.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\fjzl.edb”))
赋值 (月份, 到文本 (取月份 (取现行时间 ())))
.如果 (小于 (到数值 (月份), 10))
    赋值 (月份, 相加 (“0”, 月份))
.否则
    
.如果结束
赋值 (日期, 到文本 (取日 (取现行时间 ())))
.如果 (小于 (到数值 (日期), 10))
    赋值 (日期, 相加 (“0”, 日期))
.否则
    
.如果结束

 ' 标签4.标题 ＝ 到文本 (到数值 (系统数据源.取文本 (1, 5)))
打开 (相加 (取运行目录 (), “\data\xfbb.edb”), , , , , , )
到首记录 ()
.判断循环首 (查找 (近似等于 (读 (“流水号”), 相加 (到文本 (取年份 (取现行时间 ())), 月份, 日期))))
    读 (“流水号”).加入项目 ()
    跳过 ()
.判断循环尾 ()
赋值 (.标题, 到文本 (取最大值 (到数值 (读 (“流水号”)), 近似等于 (读 (“流水号”), 相加 (到文本 (取年份 (取现行时间 ())), 月份, 日期)))))
关闭 (相加 (取运行目录 (), “\data\xfbb.edb”))
.如果 (小于 (取项目数 (), 1))
    赋值 (.内容, 相加 (到文本 (取年份 (取现行时间 ())), 月份, 日期, “0001”))
.否则
    赋值 (.内容, 到文本 (相加 (到数值 (.标题), 1)))
.如果结束
 ' 标签4.标题 ＝ 到文本 (到数值 (标签4.标题) ＋ 1)
0.未知支持库函数_9 (0, #., “房间名称”)
0.未知支持库函数_9 (1, #., “房间人数”)
0.未知支持库函数_9 (2, #., “房间状态”)
打开 (相加 (取运行目录 (), “\data\fjzl.edb”), , , , , , )
到首记录 ()
赋值 (., 2)
.判断循环首 (查找 (不等于 (读 (“房间名称”), “”)))
    读 (“房间名称”).加入项目 ()
    取项目数 ()
    赋值 (., 相加 (取项目数 (), 1))
    取项目数 ().未知支持库函数_9 (0, #., 读 (“房间名称”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“房间人数”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“房间状态”))
    跳过 ()
.判断循环尾 ()
获取焦点 ()
关闭 (相加 (取运行目录 (), “\data\fjzl.edb”))

.子程序 _按钮1_被单击, 空白型, , 
打开 (相加 (取运行目录 (), “\data\xfbbtem.edb”), , , , , , )
到尾记录 ()
.如果 (并且 (不等于 (.内容, “”), 大于 (.内容, “0”)))
    业务操作.到尾记录 (.)
    业务操作.插入行 (., 相加 (业务操作.取记录号 (.), 1), )
    业务操作.到尾记录 (.)
    业务操作.置文本 (., 业务操作.取记录号 (.), 1, .内容)
    业务操作.置文本 (., 业务操作.取记录号 (.), 2, .内容)
    业务操作.置文本 (., 业务操作.取记录号 (.), 3, “满”)
    业务操作.置文本 (., 业务操作.取记录号 (.), 5, 到文本 (取现行时间 ()))
    业务操作.置文本 (., 业务操作.取记录号 (.), 6, 到文本 (取现行时间 ()))
    业务操作.置文本 (., 业务操作.取记录号 (.), 12, .内容)
    业务操作.置文本 (., 业务操作.取记录号 (.), 16, .内容)
.否则
    
.如果结束
关闭 (相加 (取运行目录 (), “\data\xfbbtem.edb”))
打开 (相加 (取运行目录 (), “\data\xfbb.edb”), , , , , , )
到尾记录 ()
.如果 (并且 (不等于 (.内容, “”), 大于 (.内容, “0”)))
    未知支持库函数_3 ().置文本 (3, 开台操作..内容)
    未知支持库函数_3 ().置文本 (4, “满”)
    业务操作.到尾记录 (.)
    业务操作.插入行 (., 相加 (业务操作.取记录号 (.), 1), )
    业务操作.到尾记录 (.)
    业务操作.置文本 (., 业务操作.取记录号 (.), 1, .内容)
    业务操作.置文本 (., 业务操作.取记录号 (.), 2, .内容)
    业务操作.置文本 (., 业务操作.取记录号 (.), 3, “满”)
    业务操作.置文本 (., 业务操作.取记录号 (.), 5, 到文本 (取现行时间 ()))
    业务操作.置文本 (., 业务操作.取记录号 (.), 6, 到文本 (取现行时间 ()))
    业务操作.置文本 (., 业务操作.取记录号 (.), 12, .内容)
    业务操作.置文本 (., 业务操作.取记录号 (.), 16, .内容)
    业务操作.未知支持库函数_38 (., , )
    业务操作.加入项目 (., .内容, )
    业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 0, #., .内容)
    业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 1, #., .内容)
    业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 2, #., “满”)
    业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 4, #., .内容)
    业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 5, #., .内容)
    1.置文本 (5, .标题)
    赋值 (业务操作..标题, .内容)
    赋值 (业务操作..内容, .内容)
    开台操作.销毁 ()
    业务操作.未知支持库函数_0 (., 业务操作.取项目数 (.), 0)
.否则
    赋值 (.内容, “”)
    信息框 (“人数不能为空！”, 0, )
    获取焦点 ()
.如果结束
关闭 (相加 (取运行目录 (), “\data\xfbb.edb”))



.子程序 _高级表格1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (未知支持库函数_3 ().未知支持库函数_10 (2), “满”))
    信息框 (“此包台还没结帐不能开台！”, 0, )
.否则
    赋值 (.内容, 未知支持库函数_3 ().未知支持库函数_10 (0))
    获取焦点 ()
.如果结束


.子程序 _编辑框3_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _标签4_反馈事件, 整数型, , 
.参数 参数一, 整数型, , 
.参数 参数二, 整数型, , 

信息框 (“哈哈！”, 0, )

.子程序 _编辑框4_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框4_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #F6键))
    赋值 (.内容, “”)
.如果真结束


.窗口程序集 窗口程序集10, , , 

.子程序 _点单操作_创建完毕, 空白型, , 
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\spkc.edb”))
.如果 (并且 (不等于 (业务操作..标题, “”), 等于 (业务操作..可视, 真)))
    赋值 (.内容, 业务操作.取文本 (., 业务操作.取光标行号 (.), 1))
    赋值 (.内容, 业务操作.取文本 (., 业务操作.取光标行号 (.), 2))
    赋值 (.内容, 业务操作.取文本 (., 业务操作.取光标行号 (.), 3))
    赋值 (.内容, 业务操作.取文本 (., 业务操作.取光标行号 (.), 5))
.否则
    .如果 (不等于 (业务操作..标题, “”))
        赋值 (.内容, 业务操作.未知支持库函数_10 (., 业务操作.未知支持库函数_3 (.), 0))
        赋值 (.内容, 业务操作.未知支持库函数_10 (., 业务操作.未知支持库函数_3 (.), 1))
        赋值 (.内容, 业务操作.未知支持库函数_10 (., 业务操作.未知支持库函数_3 (.), 2))
        赋值 (.内容, 业务操作.未知支持库函数_10 (., 业务操作.未知支持库函数_3 (.), 3))
    .否则
        
    .如果结束
    
.如果结束
打开 (相加 (取运行目录 (), “\data\spkc.edb”), , , , , , )
到首记录 ()
.判断循环首 (查找 (等于 (读 (“商品编码”), 到数值 (.内容))))
    赋值 (.标题, 到文本 (读 (“商品名称”)))
    赋值 (.标题, 到文本 (读 (“库存数量”)))
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\spkc.edb”))
获取焦点 ()


.子程序 _编辑框4_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (并且 (等于 (字符代码, #回车键), 不等于 (.内容, “”)))
    打开 (相加 (取运行目录 (), “\data\spzl.edb”), , , , , , )
    到首记录 ()
    .判断循环首 (查找 (等于 (读 (“商品编码”), 到数值 (.内容))))
        赋值 (.标题, 到文本 (读 (“折扣率”)))
        赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
        跳过 ()
        赋值 (.标题, 读 (“类别”))
    .判断循环尾 ()
    关闭 (相加 (取运行目录 (), “\data\spzl.edb”))
    获取焦点 ()
.如果真结束


.子程序 _按钮1_被单击, 空白型, , 
打开 (相加 (取运行目录 (), “\data\spzl.edb”), , , , , , )
到首记录 ()
.如果 (等于 (.内容, “”))
    信息框 (“数量不能为空！”, 0, )
    获取焦点 ()
.否则
    .判断循环首 (查找 (等于 (读 (“商品编码”), 到数值 (.内容))))
        赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
        赋值 (.标题, 到文本 (读 (“折扣率”)))
        跳过 ()
        赋值 (.标题, 读 (“类别”))
    .判断循环尾 ()
.如果结束
关闭 (相加 (取运行目录 (), “\data\spzl.edb”))
.如果 (并且 (不等于 (.内容, “”), 不等于 (.内容, “”)))
    .如果 (等于 (.标题, “”)) ' 无进货记录
        到尾记录 ()
        相加 (取记录号 (), 1).插入行 ()
        到尾记录 ()
        取记录号 ().置文本 (1, .内容)
        取记录号 ().置文本 (2, .内容)
        取记录号 ().置文本 (3, .内容)
        取记录号 ().置文本 (4, 到文本 (相减 (0, 到数值 (.内容))))
        取记录号 ().置文本 (5, “0”)
        取记录号 ().置文本 (6, “0”)
    .否则
        .如果 (不等于 (.标题, “”)) ' 有进货
            打开 (相加 (取运行目录 (), “\data\spkc.edb”), , , , , , )
            到首记录 ()
            .如果 (并且 (不等于 (.标题, “”), 不等于 (.标题, “”)))
                .判断循环首 (等于 (查找 (等于 (读 (“商品编码”), 到整数 (.内容))), 真))
                    取记录号 ().跳到 ()
                    取记录号 ().置文本 (4, 到文本 (相减 (到数值 (.标题), 到数值 (.内容))))
                    取记录号 ().置文本 (6, 到文本 (相减 (到数值 (取记录号 ().取文本 (6)), 到数值 (相乘 (到数值 (.内容), 到数值 (取记录号 ().取文本 (5)))))))
                    跳过 ()
                .判断循环尾 ()
            .否则
                
            .如果结束
            
        .否则
            
        .如果结束
        
    .如果结束
     ' 编辑框6.内容 ＝ 到文本 (到数值 (编辑框4.内容) × 到数值 (编辑框5.内容))
    业务操作.到尾记录 (.)
    业务操作.插入行 (., 相加 (业务操作.取行数 (.), 1), )
    业务操作.到尾记录 (.)
    业务操作.置文本 (., 业务操作.取记录号 (.), 1, 业务操作..标题)
    业务操作.置文本 (., 业务操作.取记录号 (.), 2, .内容)
    业务操作.置文本 (., 业务操作.取记录号 (.), 3, .内容)
    业务操作.置文本 (., 业务操作.取记录号 (.), 4, .内容)
    业务操作.置文本 (., 业务操作.取记录号 (.), 5, .内容)
    业务操作.置文本 (., 业务操作.取记录号 (.), 6, .内容)
    业务操作.置文本 (., 业务操作.取记录号 (.), 7, .内容)
    业务操作.置文本 (., 业务操作.取记录号 (.), 8, .内容)
    业务操作.置文本 (., 业务操作.取记录号 (.), 10, 到文本 (取现行时间 ()))
    业务操作.置文本 (., 业务操作.取记录号 (.), 11, 人员姓名)
    业务操作.置文本 (., 业务操作.取记录号 (.), 13, .标题)
    业务操作.置文本 (., 业务操作.取记录号 (.), 14, .标题)
     ' ***************************
    业务操作.到尾记录 (.)
    业务操作.插入行 (., 相加 (业务操作.取行数 (.), 1), )
    业务操作.到尾记录 (.)
    业务操作.置文本 (., 业务操作.取记录号 (.), 1, 业务操作..标题)
    业务操作.置文本 (., 业务操作.取记录号 (.), 2, .内容)
    业务操作.置文本 (., 业务操作.取记录号 (.), 3, .内容)
    业务操作.置文本 (., 业务操作.取记录号 (.), 4, .内容)
    业务操作.置文本 (., 业务操作.取记录号 (.), 5, .内容)
    业务操作.置文本 (., 业务操作.取记录号 (.), 6, .内容)
    业务操作.置文本 (., 业务操作.取记录号 (.), 7, .内容)
    业务操作.置文本 (., 业务操作.取记录号 (.), 8, .内容)
    业务操作.置文本 (., 业务操作.取记录号 (.), 10, 到文本 (取现行时间 ()))
    业务操作.置文本 (., 业务操作.取记录号 (.), 11, 人员姓名)
    业务操作.置文本 (., 业务操作.取记录号 (.), 13, .标题)
    业务操作.置文本 (., 业务操作.取记录号 (.), 14, .标题)
     ' *****************************
    业务操作.未知支持库函数_0 (., 相加 (业务操作.取项目数 (.), 1), 0)
    业务操作.未知支持库函数_38 (., , 业务操作.未知支持库函数_3 (.))
    业务操作.未知支持库函数_0 (., 相加 (业务操作.取项目数 (.), 1), 0)
    业务操作.未知支持库函数_9 (., 业务操作.未知支持库函数_3 (.), 0, #., .内容)
    业务操作.未知支持库函数_9 (., 业务操作.未知支持库函数_3 (.), 1, #., .内容)
    业务操作.未知支持库函数_9 (., 业务操作.未知支持库函数_3 (.), 2, #., .内容)
    业务操作.未知支持库函数_9 (., 业务操作.未知支持库函数_3 (.), 3, #., .内容)
    业务操作.未知支持库函数_9 (., 业务操作.未知支持库函数_3 (.), 4, #., .内容)
    业务操作.未知支持库函数_9 (., 业务操作.未知支持库函数_3 (.), 5, #., .内容)
    业务操作.未知支持库函数_9 (., 业务操作.未知支持库函数_3 (.), 6, #., .标题)
    点单操作.销毁 ()
    关闭 (相加 (取运行目录 (), “\data\spkc.edb”))
.否则
    信息框 (“数据不完整，请核实！”, 0, “提示！！！”)
    获取焦点 ()
.如果结束


.子程序 _编辑框2_获得焦点, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.标题, “”)
赋值 (.标题, “”)

.子程序 _编辑框2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    打开 (相加 (取运行目录 (), “\data\spzl.edb”), , , , , , )
    到首记录 ()
    .判断循环首 (查找 (等于 (读 (“商品编码”), 到数值 (.内容))))
        取记录号 ().跳到 ()
        赋值 (.内容, 到文本 (读 (“商品编码”)))
        赋值 (.内容, 读 (“商品名称”))
        赋值 (.内容, 读 (“单位”))
        赋值 (.内容, 到文本 (读 (“售价”)))
         ' 编辑框4.获取焦点 ()
        跳过 ()
    .判断循环尾 ()
    关闭 (相加 (取运行目录 (), “\data\spzl.edb”))
    打开 (相加 (取运行目录 (), “\data\spkc.edb”), , , , , , )
    到首记录 ()
    .判断循环首 (查找 (等于 (读 (“商品编码”), 到数值 (.内容))))
        赋值 (.标题, 到文本 (读 (“商品名称”)))
        赋值 (.标题, 到文本 (读 (“库存数量”)))
        跳过 ()
    .判断循环尾 ()
    关闭 (相加 (取运行目录 (), “\data\spkc.edb”))
    获取焦点 ()
    
.如果真结束


.窗口程序集 窗口程序集11, , , 

.子程序 _结帐操作_创建完毕, 空白型, , 
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\fjzl.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\hykmx.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\hykk.edb”))
0.未知支持库函数_32 (48)
1.未知支持库函数_32 (46)
2.未知支持库函数_32 (35)
3.未知支持库函数_32 (46)
4.未知支持库函数_32 (0)
赋值 (.内容, 业务操作..标题)
赋值 (.标题, 业务操作..内容)
0.未知支持库函数_18 (0, 相加 (取项目数 (), 6), 4, 12)
0.未知支持库函数_9 (0, #., “品名”)
0.未知支持库函数_9 (1, #., “数量”)
0.未知支持库函数_9 (2, #., “单价”)
0.未知支持库函数_9 (3, #., “总计”)
0.未知支持库函数_9 (4, #., “编码”)
打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
到首记录 ()
赋值 (., 2)
.判断循环首 (等于 (查找 (等于 (读 (“流水单号”), .内容)), 真))
    读 (“商品编号”).加入项目 ()
    取项目数 ()
    赋值 (., 相加 (取项目数 (), 2))
    取项目数 ().未知支持库函数_9 (0, #., 取文本左边 (读 (“商品名称”), 13))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“销售数量”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“售价”))
    取项目数 ().未知支持库函数_9 (3, #., 读 (“总计”))
    取项目数 ().未知支持库函数_9 (4, #., 读 (“商品编号”))
    跳过 ()
.判断循环尾 ()
.未知支持库函数_38 ()
相加 (取项目数 (), 1).未知支持库函数_58 (0, 相加 (取项目数 (), 1), 3)
相加 (取项目数 (), 1).未知支持库函数_9 (0, #., “****************************”)
相加 (取项目数 (), 2).未知支持库函数_9 (0, #., “折扣:”)
相加 (取项目数 (), 2).未知支持库函数_9 (1, #., .内容)
相加 (取项目数 (), 2).未知支持库函数_9 (2, #., “合计:”)
相加 (取项目数 (), 2).未知支持库函数_0 (3)
获取焦点 ()
0.未知支持库函数_18 (0, 相加 (取项目数 (), 6), 4, 12)
0.未知支持库函数_25 (1, 相加 (取项目数 (), 1), 2, #.)
1.未知支持库函数_25 (3, 相加 (取项目数 (), 1), 4, #.)
3.未知支持库函数_30 (#.)
1.未知支持库函数_41 (2)
 ' 高级表格1.置单元格小数位数 (3, 2)
3.未知支持库函数_66 (1, 相加 (取项目数 (), 1), )
关闭 (相加 (取运行目录 (), “\data\xsls.edb”))


.子程序 _高级表格1_结束编辑, 空白型, , 
获取焦点 ()
赋值 (.标题, 相加 (取项目数 (), 2).未知支持库函数_10 (3))

.子程序 _编辑框2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

赋值 (折扣率, 相除 (到小数 (.内容), 100))
打开 (相加 (取运行目录 (), “\data\config.edb”), , , , , , )
.如果 (等于 (.标题, “折让”))
    赋值 (金额, 四舍五入 (相减 (到小数 (.标题), 到小数 (.内容)), 读 (“小数金额”)))
.否则
    赋值 (金额, 四舍五入 (到小数 (业务操作..内容), 读 (“小数金额”)))
.如果结束
.如果真 (等于 (.可视, 真))
    赋值 (金额, 相加 (到数值 (.内容), 金额))
.如果真结束
赋值 (.标题, .内容)
.如果真 (等于 (字符代码, #回车键))
    .如果 (大于或等于 (相减 (到数值 (.标题), 到数值 (.标题)), 0))
        赋值 (.内容, 到文本 (四舍五入 (相减 (到数值 (.标题), 金额), 2)))
    .否则
        赋值 (.内容, 到文本 (四舍五入 (相减 (相加 (到数值 (.标题), 到数值 (.标题)), 金额), 2)))
    .如果结束
    .如果真 (小于 (到数值 (.内容), 0))
        信息框 (“现金不足！！！”, 0, )
        赋值 (.内容, “”)
    .如果真结束
    
.如果真结束
.如果真 (并且 (等于 (字符代码, #回车键), 等于 (.可视, 真)))
    .如果 (大于 (相减 (到数值 (.标题), 到数值 (.标题)), 0))
        赋值 (.内容, 到文本 (四舍五入 (相减 (到数值 (.标题), 金额), 2)))
    .否则
        赋值 (.内容, 到文本 (四舍五入 (相减 (相加 (到数值 (.标题), 到数值 (.标题)), 金额), 2)))
    .如果结束
    .如果真 (小于 (到数值 (.内容), 0))
        信息框 (“卡内余额不足！！！”, 0, )
        赋值 (.内容, “”)
    .如果真结束
    
.如果真结束
.如果真 (等于 (字符代码, #回车键))
    相加 (取项目数 (), 2).未知支持库函数_9 (2, #., “合计:”)
    相加 (取项目数 (), 2).未知支持库函数_9 (3, #., .标题)
    .未知支持库函数_38 ()
    相加 (取项目数 (), 3).未知支持库函数_9 (2, #., “实付:”)
    相加 (取项目数 (), 3).未知支持库函数_9 (3, #., 金额)
.如果真结束
获取焦点 ()
关闭 (相加 (取运行目录 (), “\data\config.edb”))

.子程序 _编辑框3_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.局部变量 折扣, 整数型, , , 
.局部变量 单价, 小数型, , , 
.局部变量 记录, 整数型, , , 

打开 (相加 (取运行目录 (), “\data\config.edb”), , , , , , )
赋值 (折扣, 读 (“小数金额”))
关闭 (相加 (取运行目录 (), “\data\config.edb”))
赋值 (.可视, 假)
赋值 (.标题, “”)
赋值 (.内容, “”)
赋值 (折扣率, 相除 (到数值 (.内容), 100))

.如果 (并且 (等于 (字符代码, #回车键), 等于 (.内容, “”)))
    信息框 (“折扣不能为空！”, 0, )
.否则
    .如果真 (并且 (等于 (字符代码, #回车键), 等于 (.标题, “折扣”)))
        赋值 (金额, 四舍五入 (相乘 (到数值 (相加 (取项目数 (), 2).未知支持库函数_10 (3)), 折扣率), 折扣))
        .如果真 (等于 (.可视, 真))
            赋值 (金额, 相加 (到数值 (.内容), 金额))
        .如果真结束
        赋值 (.标题, 到文本 (四舍五入 (相减 (到数值 (.标题), 金额), 2)))
        相加 (取项目数 (), 2).未知支持库函数_9 (0, #., “折扣:”)
        相加 (取项目数 (), 2).未知支持库函数_9 (1, #., .内容)
        获取焦点 ()
    .如果真结束
    .如果真 (并且 (等于 (字符代码, #回车键), 等于 (.标题, “折让”)))
        赋值 (金额, 四舍五入 (相减 (到数值 (相加 (取项目数 (), 2).未知支持库函数_10 (3)), 到数值 (.内容)), 折扣))
        .如果真 (等于 (.可视, 真))
            赋值 (金额, 相加 (到数值 (.内容), 金额))
        .如果真结束
        赋值 (.标题, 到文本 (四舍五入 (相减 (到数值 (.标题), 金额), 2)))
        相加 (取项目数 (), 2).未知支持库函数_9 (0, #., “折让:”)
        相加 (取项目数 (), 2).未知支持库函数_9 (1, #., .内容)
        获取焦点 ()
    .如果真结束
    .如果真 (并且 (等于 (字符代码, #回车键), 不等于 (.内容, “”)))
        .计次循环首 (业务操作.取项目数 (.), 计次变量)
            赋值 (业务操作..标题, 到文本 (计次变量))
            打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
            到首记录 ()
            查找 (并且 (等于 (读 (“流水单号”), .内容), 查找 (并且 (等于 (读 (“商品编号”), 业务操作.未知支持库函数_10 (., 计次变量, 0)), 查找 (等于 (读 (“销售数量”), 业务操作.未知支持库函数_10 (., 计次变量, 3)))))))
            业务操作.跳到 (., 取记录号 ())
            .如果 (小于 (到数值 (.内容), 到数值 (业务操作.未知支持库函数_10 (., 计次变量, 6))))
                业务操作.置文本 (., 业务操作.取记录号 (.), 7, 到文本 (四舍五入 (相乘 (到数值 (业务操作.未知支持库函数_10 (., 计次变量, 5)), 到数值 (相除 (到数值 (业务操作.未知支持库函数_10 (., 计次变量, 6)), 100))), 折扣)))
            .否则
                业务操作.置文本 (., 业务操作.取记录号 (.), 7, 到文本 (四舍五入 (相除 (相乘 (到数值 (业务操作.未知支持库函数_10 (., 计次变量, 5)), 到数值 (.内容)), 100), 折扣)))
            .如果结束
            关闭 (相加 (取运行目录 (), “\data\xsls.edb”))
        .计次循环尾 ()
        .计次循环首 (业务操作.取项目数 (.), 计次变量)
            打开 (相加 (取运行目录 (), “\data\xslsss.edb”), , , , , , )
            到首记录 ()
            查找 (并且 (等于 (读 (“流水单号”), .内容), 查找 (并且 (等于 (读 (“商品编号”), 业务操作.未知支持库函数_10 (., 计次变量, 0)), 查找 (等于 (读 (“销售数量”), 业务操作.未知支持库函数_10 (., 计次变量, 3)))))))
            业务操作.跳到 (., 取记录号 ())
            .如果 (小于 (到数值 (.内容), 到数值 (业务操作.未知支持库函数_10 (., 计次变量, 6))))
                业务操作.置文本 (., 业务操作.取记录号 (.), 7, 到文本 (四舍五入 (相乘 (到数值 (业务操作.未知支持库函数_10 (., 计次变量, 5)), 到数值 (相除 (到数值 (业务操作.未知支持库函数_10 (., 计次变量, 6)), 100))), 折扣)))
            .否则
                业务操作.置文本 (., 业务操作.取记录号 (.), 7, 到文本 (四舍五入 (相除 (相乘 (到数值 (业务操作.未知支持库函数_10 (., 计次变量, 5)), 到数值 (.内容)), 100), 折扣)))
            .如果结束
            关闭 (相加 (取运行目录 (), “\data\xslsss.edb”))
        .计次循环尾 ()
        业务操作.未知支持库函数_57 (.)
        业务操作.清空 (.)
        业务操作.未知支持库函数_9 (., 0, 0, #., “商品编号”)
        业务操作.未知支持库函数_9 (., 0, 1, #., “商品名称”)
        业务操作.未知支持库函数_9 (., 0, 2, #., “单位”)
        业务操作.未知支持库函数_9 (., 0, 3, #., “销售数量”)
        业务操作.未知支持库函数_9 (., 0, 4, #., “单价”)
        业务操作.未知支持库函数_9 (., 0, 5, #., “总计”)
        业务操作.未知支持库函数_9 (., 0, 6, #., “折扣率”)
        打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
        到首记录 ()
        赋值 (业务操作.., 1)
        .判断循环首 (等于 (查找 (等于 (读 (“流水单号”), 业务操作..标题)), 真))
            业务操作.加入项目 (., 读 (“商品名称”), )
            业务操作.取项目数 (.)
            赋值 (业务操作.., 相加 (业务操作.取项目数 (.), 1))
            业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 0, #., 读 (“商品编号”))
            业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 1, #., 读 (“商品名称”))
            业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 2, #., 读 (“单位”))
            业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 3, #., 读 (“销售数量”))
            业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 4, #., 读 (“售价”))
            业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 5, #., 读 (“总计”))
            业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 6, #., 读 (“折扣率”))
            跳过 ()
        .判断循环尾 ()
        业务操作.未知支持库函数_38 (., , )
        业务操作.未知支持库函数_30 (., 5, #.)
        业务操作.未知支持库函数_41 (., 5, 2)
        业务操作.未知支持库函数_66 (., 5, 1, 相加 (业务操作.取项目数 (.), 1), )
        赋值 (业务操作..内容, 到文本 (求和 (到数值 (读 (“总计”)), 等于 (读 (“流水单号”), 业务操作..标题))))
        业务操作.未知支持库函数_9 (., 相加 (业务操作.取项目数 (.), 1), 4, #., “合计:”)
        业务操作.未知支持库函数_9 (., 相加 (业务操作.取项目数 (.), 1), 5, #., 业务操作..内容)
        业务操作.未知支持库函数_0 (., 相加 (业务操作.取项目数 (.), 1), 5)
        关闭 (相加 (取运行目录 (), “\data\xsls.edb”))
        业务操作.置文本 (., 业务操作.取记录号 (.), 16, .内容)
        业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 5, #., .内容)
        清空 ()
        未知支持库函数_57 ()
        0.未知支持库函数_32 (48)
        1.未知支持库函数_32 (46)
        2.未知支持库函数_32 (35)
        3.未知支持库函数_32 (46)
        4.未知支持库函数_32 (0)
        赋值 (.内容, 业务操作..标题)
        赋值 (.标题, 业务操作..内容)
        0.未知支持库函数_18 (0, 相加 (取项目数 (), 6), 4, 12)
        0.未知支持库函数_9 (0, #., “品名”)
        0.未知支持库函数_9 (1, #., “数量”)
        0.未知支持库函数_9 (2, #., “单价”)
        0.未知支持库函数_9 (3, #., “总计”)
        0.未知支持库函数_9 (4, #., “编码”)
        打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
        到首记录 ()
        赋值 (., 2)
        .判断循环首 (等于 (查找 (等于 (读 (“流水单号”), .内容)), 真))
            读 (“商品编号”).加入项目 ()
            取项目数 ()
            赋值 (., 相加 (取项目数 (), 2))
            取项目数 ().未知支持库函数_9 (0, #., 取文本左边 (读 (“商品名称”), 13))
            取项目数 ().未知支持库函数_9 (1, #., 读 (“销售数量”))
            取项目数 ().未知支持库函数_9 (2, #., 读 (“售价”))
            取项目数 ().未知支持库函数_9 (3, #., 读 (“总计”))
            取项目数 ().未知支持库函数_9 (4, #., 读 (“商品编号”))
            跳过 ()
        .判断循环尾 ()
        .未知支持库函数_38 ()
        相加 (取项目数 (), 1).未知支持库函数_58 (0, 相加 (取项目数 (), 1), 3)
        相加 (取项目数 (), 1).未知支持库函数_9 (0, #., “****************************”)
        相加 (取项目数 (), 2).未知支持库函数_9 (0, #., “折扣:”)
        相加 (取项目数 (), 2).未知支持库函数_9 (1, #., .内容)
        相加 (取项目数 (), 2).未知支持库函数_9 (2, #., “合计:”)
        相加 (取项目数 (), 2).未知支持库函数_9 (3, #., 业务操作..内容)
        获取焦点 ()
        0.未知支持库函数_18 (0, 相加 (取项目数 (), 6), 4, 12)
        0.未知支持库函数_25 (1, 相加 (取项目数 (), 1), 2, #.)
        1.未知支持库函数_25 (3, 相加 (取项目数 (), 1), 4, #.)
        3.未知支持库函数_30 (#.)
        1.未知支持库函数_41 (2)
        3.未知支持库函数_41 (2)
        关闭 (相加 (取运行目录 (), “\data\xsls.edb”))
        获取焦点 ()
    .如果真结束
    
.如果结束


.子程序 _编辑框4_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.局部变量 折扣, 整数型, , , 

打开 (相加 (取运行目录 (), “\data\config.edb”), , , , , , )
赋值 (折扣, 读 (“小数金额”))
关闭 (相加 (取运行目录 (), “\data\config.edb”))
打开 (相加 (取运行目录 (), “\data\hykk.edb”), , , , , , )
到首记录 ()
.如果 (并且 (等于 (字符代码, #回车键), 不等于 (.内容, “”)))
    查找 (等于 (读 (“会员卡号”), 到数值 (.内容)))
    .如果真 (查找 (等于 (读 (“会员卡号”), 到数值 (.内容)))) ' 判断卡号是否存在
        获取焦点 ()
        赋值 (.内容, 到文本 (读 (“折扣率”)))
        赋值 (.标题, 到文本 (读 (“卡内金额”)))
        赋值 (.标题, 读 (“卡种类”))
        赋值 (.标题, 读 (“卡密码”))
        赋值 (折扣率, 相除 (到数值 (.内容), 100))
    .如果真结束
    .如果 (不等于 (.标题, “”))
        载入 (卡输入, , 真)
    .否则
        .如果真 (并且 (等于 (字符代码, #回车键), 不等于 (.内容, “”)))
            .计次循环首 (业务操作.取项目数 (.), 计次变量)
                赋值 (业务操作..标题, 到文本 (计次变量))
                打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
                到首记录 ()
                查找 (并且 (等于 (读 (“流水单号”), 结帐操作..内容), 查找 (并且 (等于 (读 (“商品编号”), 业务操作.未知支持库函数_10 (., 计次变量, 0)), 查找 (等于 (读 (“销售数量”), 业务操作.未知支持库函数_10 (., 计次变量, 3)))))))
                业务操作.跳到 (., 取记录号 ())
                .如果 (小于 (到数值 (结帐操作..内容), 到数值 (业务操作.未知支持库函数_10 (., 计次变量, 6))))
                    业务操作.置文本 (., 业务操作.取记录号 (.), 7, 到文本 (四舍五入 (相乘 (到数值 (业务操作.未知支持库函数_10 (., 计次变量, 5)), 到数值 (相除 (到数值 (业务操作.未知支持库函数_10 (., 计次变量, 6)), 100))), 折扣)))
                .否则
                    业务操作.置文本 (., 业务操作.取记录号 (.), 7, 到文本 (四舍五入 (相除 (相乘 (到数值 (业务操作.未知支持库函数_10 (., 计次变量, 5)), 到数值 (结帐操作..内容)), 100), 折扣)))
                .如果结束
                关闭 (相加 (取运行目录 (), “\data\xsls.edb”))
            .计次循环尾 ()
            .计次循环首 (业务操作.取项目数 (.), 计次变量)
                打开 (相加 (取运行目录 (), “\data\xslsss.edb”), , , , , , )
                到首记录 ()
                查找 (并且 (等于 (读 (“流水单号”), 结帐操作..内容), 查找 (并且 (等于 (读 (“商品编号”), 业务操作.未知支持库函数_10 (., 计次变量, 0)), 查找 (等于 (读 (“销售数量”), 业务操作.未知支持库函数_10 (., 计次变量, 3)))))))
                业务操作.跳到 (., 取记录号 ())
                .如果 (小于 (到数值 (结帐操作..内容), 到数值 (业务操作.未知支持库函数_10 (., 计次变量, 6))))
                    业务操作.置文本 (., 业务操作.取记录号 (.), 7, 到文本 (四舍五入 (相乘 (到数值 (业务操作.未知支持库函数_10 (., 计次变量, 5)), 到数值 (相除 (到数值 (业务操作.未知支持库函数_10 (., 计次变量, 6)), 100))), 折扣)))
                .否则
                    业务操作.置文本 (., 业务操作.取记录号 (.), 7, 到文本 (四舍五入 (相除 (相乘 (到数值 (业务操作.未知支持库函数_10 (., 计次变量, 5)), 到数值 (结帐操作..内容)), 100), 折扣)))
                .如果结束
                关闭 (相加 (取运行目录 (), “\data\xslsss.edb”))
            .计次循环尾 ()
            业务操作.未知支持库函数_57 (.)
            业务操作.清空 (.)
            业务操作.未知支持库函数_9 (., 0, 0, #., “商品编号”)
            业务操作.未知支持库函数_9 (., 0, 1, #., “商品名称”)
            业务操作.未知支持库函数_9 (., 0, 2, #., “单位”)
            业务操作.未知支持库函数_9 (., 0, 3, #., “销售数量”)
            业务操作.未知支持库函数_9 (., 0, 4, #., “单价”)
            业务操作.未知支持库函数_9 (., 0, 5, #., “总计”)
            业务操作.未知支持库函数_9 (., 0, 6, #., “折扣率”)
            打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
            到首记录 ()
            赋值 (业务操作.., 1)
            .判断循环首 (等于 (查找 (等于 (读 (“流水单号”), 业务操作..标题)), 真))
                业务操作.加入项目 (., 读 (“商品名称”), )
                业务操作.取项目数 (.)
                赋值 (业务操作.., 相加 (业务操作.取项目数 (.), 1))
                业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 0, #., 读 (“商品编号”))
                业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 1, #., 读 (“商品名称”))
                业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 2, #., 读 (“单位”))
                业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 3, #., 读 (“销售数量”))
                业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 4, #., 读 (“售价”))
                业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 5, #., 读 (“总计”))
                业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 6, #., 读 (“折扣率”))
                跳过 ()
            .判断循环尾 ()
            业务操作.未知支持库函数_38 (., , )
            业务操作.未知支持库函数_30 (., 5, #.)
            业务操作.未知支持库函数_41 (., 5, 2)
            业务操作.未知支持库函数_66 (., 5, 1, 相加 (业务操作.取项目数 (.), 1), )
            赋值 (业务操作..内容, 到文本 (求和 (到数值 (读 (“总计”)), 等于 (读 (“流水单号”), 业务操作..标题))))
            业务操作.未知支持库函数_9 (., 相加 (业务操作.取项目数 (.), 1), 4, #., “合计:”)
            业务操作.未知支持库函数_9 (., 相加 (业务操作.取项目数 (.), 1), 5, #., 业务操作..内容)
            业务操作.未知支持库函数_0 (., 相加 (业务操作.取项目数 (.), 1), 5)
            关闭 (相加 (取运行目录 (), “\data\xsls.edb”))
            业务操作.置文本 (., 业务操作.取记录号 (.), 16, .内容)
            业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 5, #., .内容)
            清空 ()
            未知支持库函数_57 ()
            0.未知支持库函数_32 (48)
            1.未知支持库函数_32 (46)
            2.未知支持库函数_32 (35)
            3.未知支持库函数_32 (46)
            4.未知支持库函数_32 (0)
            赋值 (.内容, 业务操作..标题)
            赋值 (.标题, 业务操作..内容)
            0.未知支持库函数_18 (0, 相加 (取项目数 (), 6), 4, 12)
            0.未知支持库函数_9 (0, #., “品名”)
            0.未知支持库函数_9 (1, #., “数量”)
            0.未知支持库函数_9 (2, #., “单价”)
            0.未知支持库函数_9 (3, #., “总计”)
            0.未知支持库函数_9 (4, #., “编码”)
            打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
            到首记录 ()
            赋值 (., 2)
            .判断循环首 (等于 (查找 (等于 (读 (“流水单号”), .内容)), 真))
                读 (“商品编号”).加入项目 ()
                取项目数 ()
                赋值 (., 相加 (取项目数 (), 2))
                取项目数 ().未知支持库函数_9 (0, #., 取文本左边 (读 (“商品名称”), 13))
                取项目数 ().未知支持库函数_9 (1, #., 读 (“销售数量”))
                取项目数 ().未知支持库函数_9 (2, #., 读 (“售价”))
                取项目数 ().未知支持库函数_9 (3, #., 读 (“总计”))
                取项目数 ().未知支持库函数_9 (4, #., 读 (“商品编号”))
                跳过 ()
            .判断循环尾 ()
            .未知支持库函数_38 ()
            相加 (取项目数 (), 1).未知支持库函数_58 (0, 相加 (取项目数 (), 1), 3)
            相加 (取项目数 (), 1).未知支持库函数_9 (0, #., “****************************”)
            相加 (取项目数 (), 2).未知支持库函数_9 (0, #., “折扣:”)
            相加 (取项目数 (), 2).未知支持库函数_9 (1, #., .内容)
            相加 (取项目数 (), 2).未知支持库函数_9 (2, #., “合计:”)
            相加 (取项目数 (), 2).未知支持库函数_9 (3, #., 业务操作..内容)
            获取焦点 ()
            0.未知支持库函数_18 (0, 相加 (取项目数 (), 6), 4, 12)
            0.未知支持库函数_25 (1, 相加 (取项目数 (), 1), 2, #.)
            1.未知支持库函数_25 (3, 相加 (取项目数 (), 1), 4, #.)
            3.未知支持库函数_30 (#.)
            1.未知支持库函数_41 (2)
            3.未知支持库函数_41 (2)
            关闭 (相加 (取运行目录 (), “\data\xsls.edb”))
            获取焦点 ()
        .如果真结束
         ' 金额 ＝ 四舍五入 (到数值 (业务操作.编辑框2.内容), 读 (“小数金额”))
         ' 打开 (取运行目录 () ＋ “\data\hykk.edb”, , , , , , )
         ' 到首记录 ()
        .如果真 (等于 (.可视, 真))
            赋值 (金额, 相加 (到数值 (.内容), 金额))
        .如果真结束
        .如果真 (查找 (等于 (读 (“会员卡号”), 到数值 (.内容)))) ' 判断卡号是否存在
            赋值 (.标题, “”)
            赋值 (.标题, “”)
            获取焦点 ()
            获取焦点 ()
            相加 (取项目数 (), 2).未知支持库函数_9 (0, #., “折扣”)
            相加 (取项目数 (), 2).未知支持库函数_9 (1, #., .内容)
            获取焦点 ()
            
        .如果真结束
        打开 (相加 (取运行目录 (), “\data\config.edb”), , , , , , )
        .如果 (并且 (等于 (字符代码, #回车键), 等于 (.内容, “”)))
            信息框 (“折扣不能为空！”, 0, )
        .否则
            .如果真 (并且 (等于 (字符代码, #回车键), 等于 (.标题, “折扣”)))
                赋值 (金额, 四舍五入 (到数值 (业务操作..内容), 读 (“小数金额”)))
                .如果真 (等于 (.可视, 真))
                    赋值 (金额, 相加 (到数值 (.内容), 金额))
                .如果真结束
                赋值 (.标题, 到文本 (四舍五入 (相减 (到数值 (.标题), 金额), 2)))
                相加 (取项目数 (), 2).未知支持库函数_9 (0, #., “折扣:”)
                相加 (取项目数 (), 2).未知支持库函数_9 (1, #., .内容)
                获取焦点 ()
            .如果真结束
            .如果真 (并且 (等于 (字符代码, #回车键), 等于 (.标题, “折让”)))
                赋值 (金额, 四舍五入 (相减 (到数值 (相加 (取项目数 (), 2).未知支持库函数_10 (3)), 到数值 (.内容)), 读 (“小数金额”)))
                .如果真 (等于 (.可视, 真))
                    赋值 (金额, 相加 (到数值 (.内容), 金额))
                .如果真结束
                赋值 (.标题, 到文本 (四舍五入 (相减 (到数值 (.标题), 金额), 2)))
                相加 (取项目数 (), 2).未知支持库函数_9 (0, #., “折让:”)
                相加 (取项目数 (), 2).未知支持库函数_9 (1, #., .内容)
                获取焦点 ()
            .如果真结束
            
        .如果结束
        
    .如果结束
    
    
    关闭 (相加 (取运行目录 (), “\data\config.edb”))
.否则
    
.如果结束
关闭 (相加 (取运行目录 (), “\data\hykk.edb”))


.子程序 子程序1, 空白型, , 
.如果真 (等于 (.可视, 真))
    赋值 (金额, 0)
.如果真结束


.子程序 _编辑框4_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #F4键))
    .如果真 (等于 (.内容, “”))
        赋值 (.标题, “”)
        赋值 (.标题, “折扣”)
        赋值 (.内容, “”)
        赋值 (.标题, “”)
        赋值 (.标题, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “100”)
        赋值 (.内容, “”)
        赋值 (.可视, 假)
        获取焦点 ()
        赋值 (.可视, 假)
        赋值 (.可视, 假)
    .如果真结束
    
.如果真结束
.如果真 (等于 (键代码, #F5键))
    赋值 (.标题, “”)
    赋值 (.标题, “”)
    赋值 (.内容, “”)
    赋值 (.可视, 真)
    赋值 (.内容, “”)
    获取焦点 ()
.如果真结束
.如果真 (等于 (键代码, #F6键))
    赋值 (.标题, “”)
    赋值 (.内容, “”)
    赋值 (.标题, “折扣”)
    赋值 (.可视, 真)
    赋值 (.内容, “”)
    获取焦点 ()
    赋值 (.内容, “”)
.如果真结束
.如果真 (等于 (键代码, #F7键))
    赋值 (.标题, “”)
    赋值 (.内容, “”)
    赋值 (.标题, “折让”)
    赋值 (.可视, 真)
    赋值 (.内容, “”)
    获取焦点 ()
    赋值 (.内容, “”)
.如果真结束
.如果真 (等于 (键代码, #F2键))
    赋值 (.可视, 真)
    赋值 (.可视, 假)
.如果真结束
.如果真 (等于 (键代码, #F3键))
    赋值 (.可视, 真)
    赋值 (.可视, 假)
.如果真结束


.子程序 _编辑框3_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #F4键))
    .如果真 (等于 (.内容, “”))
        赋值 (.标题, “”)
        赋值 (.标题, “折扣”)
        赋值 (.内容, “”)
        赋值 (.标题, “”)
        赋值 (.标题, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “100”)
        赋值 (.内容, “”)
        赋值 (.可视, 假)
        获取焦点 ()
        赋值 (.可视, 假)
        赋值 (.可视, 假)
    .如果真结束
    
.如果真结束
.如果真 (等于 (键代码, #F5键))
    赋值 (.标题, “”)
    赋值 (.标题, “”)
    赋值 (.内容, “”)
    赋值 (.可视, 真)
    赋值 (.内容, “”)
    获取焦点 ()
.如果真结束
.如果真 (等于 (键代码, #F6键))
    赋值 (.标题, “”)
    赋值 (.内容, “”)
    赋值 (.标题, “折扣”)
    赋值 (.可视, 真)
    赋值 (.内容, “”)
    获取焦点 ()
    赋值 (.内容, “”)
.如果真结束
.如果真 (等于 (键代码, #F7键))
    赋值 (.标题, “”)
    赋值 (.内容, “”)
    赋值 (.标题, “折让”)
    赋值 (.可视, 真)
    赋值 (.内容, “”)
    获取焦点 ()
    赋值 (.内容, “”)
.如果真结束
.如果真 (等于 (键代码, #F2键))
    赋值 (.可视, 真)
    赋值 (.可视, 假)
.如果真结束
.如果真 (等于 (键代码, #F3键))
    赋值 (.可视, 真)
    赋值 (.可视, 假)
.如果真结束


.子程序 _编辑框2_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #F4键))
    .如果真 (等于 (.内容, “”))
        赋值 (.标题, “”)
        赋值 (.标题, “折扣”)
        赋值 (.内容, “”)
        赋值 (.标题, “”)
        赋值 (.标题, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “100”)
        赋值 (.内容, “”)
        赋值 (.可视, 假)
        获取焦点 ()
        赋值 (.可视, 假)
        赋值 (.可视, 假)
    .如果真结束
    
.如果真结束
.如果真 (等于 (键代码, #F5键))
    赋值 (.标题, “”)
    赋值 (.标题, “”)
    赋值 (.内容, “”)
    赋值 (.可视, 真)
    赋值 (.内容, “”)
    获取焦点 ()
.如果真结束
.如果真 (等于 (键代码, #F6键))
    赋值 (.标题, “”)
    赋值 (.内容, “”)
    赋值 (.标题, “折扣”)
    赋值 (.可视, 真)
    赋值 (.内容, “”)
    获取焦点 ()
    赋值 (.内容, “”)
.如果真结束
.如果真 (等于 (键代码, #F7键))
    赋值 (.标题, “”)
    赋值 (.内容, “”)
    赋值 (.标题, “折让”)
    赋值 (.可视, 真)
    赋值 (.内容, “”)
    获取焦点 ()
    赋值 (.内容, “”)
.如果真结束
.如果真 (等于 (键代码, #F2键))
    赋值 (.可视, 真)
    赋值 (.可视, 假)
.如果真结束
.如果真 (等于 (键代码, #F3键))
    赋值 (.可视, 真)
    赋值 (.可视, 假)
.如果真结束
.如果真 (并且 (等于 (键代码, #F1键), 大于或等于 (到数值 (.内容), 0), 不等于 (.内容, “”)))
    子程序1 ()
    .如果真 (并且 (等于 (.可视, 真), 等于 (.标题, “充值卡”)))
        到尾记录 ()
        相加 (取记录号 (), 1).插入行 (1)
        到尾记录 ()
        取记录号 ().置文本 (1, .内容)
        取记录号 ().置文本 (2, .标题)
        .如果真 (大于 (相减 (到数值 (.标题), 金额), 0))
            打开 (相加 (取运行目录 (), “\data\config.edb”), , , , , , )
            取记录号 ().置文本 (3, 到文本 (四舍五入 (相乘 (到数值 (.标题), 折扣率), 读 (“小数金额”))))
            取记录号 ().置文本 (4, .内容)
            关闭 (相加 (取运行目录 (), “\data\config.edb”))
        .如果真结束
        .如果真 (小于 (相减 (到数值 (.标题), 金额), 0))
            取记录号 ().置文本 (3, 到文本 (金额))
        .如果真结束
        取记录号 ().置文本 (5, 到文本 (取现行时间 ()))
        取记录号 ().置文本 (6, .内容)
        取记录号 ().置文本 (7, “销费”)
        打开 (相加 (取运行目录 (), “\data\hykk.edb”), , , , , , )
        到首记录 ()
        .判断循环首 (查找 (等于 (读 (“会员卡号”), 到数值 (.内容))))
            取记录号 ().跳到 ()
            .如果 (大于 (相减 (到数值 (.标题), 金额), 0))
                取记录号 ().跳到 ()
                取记录号 ().置文本 (6, .内容)
            .否则
                取记录号 ().跳到 ()
                取记录号 ().置文本 (6, “0”)
            .如果结束
            跳过 ()
        .判断循环尾 ()
        关闭 (相加 (取运行目录 (), “\data\hykk.edb”))
    .如果真结束
    .如果真 (并且 (等于 (.可视, 真), 不等于 (.标题, “充值卡”)))
        到尾记录 ()
        相加 (取记录号 (), 1).插入行 (1)
        到尾记录 ()
        取记录号 ().置文本 (1, .内容)
        取记录号 ().置文本 (2, .标题)
        .如果真 (大于 (相减 (到数值 (.标题), 金额), 0))
            打开 (相加 (取运行目录 (), “\data\config.edb”), , , , , , )
            取记录号 ().置文本 (3, 到文本 (四舍五入 (相乘 (到数值 (.标题), 折扣率), 读 (“小数金额”))))
            取记录号 ().置文本 (4, .内容)
            关闭 (相加 (取运行目录 (), “\data\config.edb”))
        .如果真结束
        .如果真 (小于 (相减 (到数值 (.标题), 金额), 0))
            取记录号 ().置文本 (3, 到文本 (金额))
            取记录号 ().置文本 (4, 到文本 (0))
        .如果真结束
        取记录号 ().置文本 (5, 到文本 (取现行时间 ()))
        取记录号 ().置文本 (6, .内容)
        取记录号 ().置文本 (7, “销费”)
    .如果真结束
    .未知支持库函数_38 ()
     ' 高级表格1.置数据 (列表框1.取项目数 () ＋ 3, 0, #表格常量.文本型, “找零:”)
     ' 高级表格1.置数据 (列表框1.取项目数 () ＋ 3, 2, #表格常量.文本型, “实付:”)
     ' 高级表格1.置对齐方式 (列表框1.取项目数 () ＋ 3, 1, , 1, #表格常量.左对齐)
    .如果 (等于 (.标题, “冲值卡”))
        相加 (取项目数 (), 3).未知支持库函数_9 (1, #., 0)
    .否则
        相加 (取项目数 (), 3).未知支持库函数_9 (1, #., 到数值 (.内容))
    .如果结束
    相加 (取项目数 (), 3).未知支持库函数_9 (1, #., 到数值 (.内容))
    相加 (取项目数 (), 3).未知支持库函数_9 (2, #., “实付:”)
    相加 (取项目数 (), 3).未知支持库函数_9 (3, #., 金额)
    .如果真 (等于 (.可视, 真))
        .未知支持库函数_38 ()
        相加 (取项目数 (), 4).未知支持库函数_9 (0, #., “卡号:”)
        相加 (取项目数 (), 4).未知支持库函数_9 (2, #., “余额:”)
        相加 (取项目数 (), 3).未知支持库函数_25 (1, , 1, #.)
        相加 (取项目数 (), 4).未知支持库函数_9 (1, #., .内容)
        .判断开始 (大于 (相减 (到数值 (.标题), 金额), 0))
            相加 (取项目数 (), 4).未知支持库函数_9 (3, #., 相减 (到数值 (.标题), 金额))
        .默认
            相加 (取项目数 (), 4).未知支持库函数_9 (3, #., 0)
        .判断结束
        
    .如果真结束
    打开 (相加 (取运行目录 (), “\data\config.edb”), , , , , , )
    到首记录 ()
    .如果真 (并且 (等于 (.可视, 假), 等于 (.可视, 假)))
        .未知支持库函数_38 ()
        相加 (取项目数 (), 4).未知支持库函数_58 (0, 相加 (取项目数 (), 4), 3)
        相加 (取项目数 (), 4).未知支持库函数_25 (0, , 0, #.)
        相加 (取项目数 (), 4).未知支持库函数_9 (0, #., 相加 (“订座电话：”, 读 (“电话号码”)))
    .如果真结束
    .如果真 (并且 (等于 (.可视, 真), 等于 (.可视, 假)))
        .未知支持库函数_38 ()
        相加 (取项目数 (), 4).未知支持库函数_9 (0, #., “附加费:”)
        相加 (取项目数 (), 4).未知支持库函数_25 (1, , 1, #.)
        相加 (取项目数 (), 4).未知支持库函数_9 (1, #., .内容)
        相加 (取项目数 (), 4).未知支持库函数_9 (2, #., “总计:”)
        相加 (取项目数 (), 4).未知支持库函数_25 (3, , 1, #.)
        相加 (取项目数 (), 4).未知支持库函数_9 (3, #., 到文本 (金额))
        .未知支持库函数_38 ()
        相加 (取项目数 (), 5).未知支持库函数_58 (0, 相加 (取项目数 (), 5), 3)
        相加 (取项目数 (), 5).未知支持库函数_25 (0, , 0, #.)
        相加 (取项目数 (), 5).未知支持库函数_9 (0, #., 相加 (“订座电话：”, 读 (“电话号码”)))
    .如果真结束
    .如果真 (并且 (等于 (.可视, 真), 等于 (.可视, 真)))
        .未知支持库函数_38 ()
        相加 (取项目数 (), 5).未知支持库函数_9 (0, #., “附加费:”)
        相加 (取项目数 (), 5).未知支持库函数_25 (1, , 1, #.)
        相加 (取项目数 (), 5).未知支持库函数_9 (1, #., .内容)
        相加 (取项目数 (), 5).未知支持库函数_9 (2, #., “总计:”)
        相加 (取项目数 (), 5).未知支持库函数_25 (3, , 1, #.)
        相加 (取项目数 (), 5).未知支持库函数_9 (3, #., 到文本 (金额))
        .未知支持库函数_38 ()
        相加 (取项目数 (), 6).未知支持库函数_58 (0, 相加 (取项目数 (), 6), 3)
        相加 (取项目数 (), 6).未知支持库函数_25 (0, , 0, #.)
        相加 (取项目数 (), 6).未知支持库函数_9 (0, #., 相加 (“订座电话：”, 读 (“电话号码”)))
    .如果真结束
    .如果真 (等于 (读 (“是否打印”), “是”))
        假.开始打印 (假, “58mm roll paper”, , .打印区宽度, 相减 (.打印区高度, 200))
        赋值 (.字体.字体大小, 9)
        .如果真 (等于 (.可视, 真))
            相加 (取空白文本 (相除 (相减 (30, 取文本长度 (相加 (读 (“单位信息”), “欢迎您”))), 2)), 读 (“单位信息”), “欢迎您”, #换行符, 到文本 (取日期 (取现行时间 ())), “ ”, “操作员：”, 人员姓名, #换行符, “流水单号：”, .内容, “ ”, “免单状态”, #换行符, “_____________________________”, #换行符, “数量”, “        ”, “单价”, “        ”, “总计”, #换行符, “-----------------------------”, #换行符).写出 ()
        .如果真结束
        .如果真 (等于 (.可视, 真))
            相加 (取空白文本 (相除 (相减 (30, 取文本长度 (相加 (读 (“单位信息”), “欢迎您”))), 2)), 读 (“单位信息”), “欢迎您”, #换行符, 到文本 (取日期 (取现行时间 ())), “ ”, “操作员：”, 人员姓名, #换行符, “流水单号：”, .内容, “ ”, “挂帐状态”, #换行符, “_____________________________”, #换行符, “数量”, “        ”, “单价”, “        ”, “总计”, #换行符, “-----------------------------”, #换行符).写出 ()
        .如果真结束
        .如果真 (并且 (等于 (.可视, 假), 等于 (.可视, 假)))
            相加 (取空白文本 (相除 (相减 (30, 取文本长度 (相加 (读 (“单位信息”), “欢迎您”))), 2)), 读 (“单位信息”), “欢迎您”, #换行符, 到文本 (取日期 (取现行时间 ())), “ ”, “操作员：”, 人员姓名, #换行符, “流水单号：”, .内容, “ ”, “销售状态”, #换行符, “_____________________________”, #换行符, “数量”, “        ”, “单价”, “        ”, “总计”, #换行符, “-----------------------------”, #换行符).写出 ()
        .如果真结束
        .计次循环首 (取项目数 (), 计次变量)
            相加 (计次变量.未知支持库函数_10 (4), 取空白文本 (相减 (18, 取文本长度 (取文本左边 (计次变量.未知支持库函数_10 (4), 16)))), 计次变量.未知支持库函数_10 (0), #换行符, “ ”, 计次变量.未知支持库函数_10 (1), 取空白文本 (相减 (12, 取文本长度 (计次变量.未知支持库函数_10 (2)))), 计次变量.未知支持库函数_10 (2), 取空白文本 (相减 (13, 取文本长度 (计次变量.未知支持库函数_10 (3)))), 计次变量.未知支持库函数_10 (3), #换行符).写出 ()
             ' 打印机1.写出 (取文本左边 (高级表格1.取数据 (计次变量, 0), 13) ＋ 取空白文本 (16 － 取文本长度 (高级表格1.取数据 (计次变量, 0)) － 取文本长度 (高级表格1.取数据 (计次变量, 1))) ＋ 高级表格1.取数据 (计次变量, 1) ＋ 取空白文本 (3) ＋ 高级表格1.取数据 (计次变量, 2) ＋ 取空白文本 (8 － 取文本长度 (高级表格1.取数据 (计次变量, 2)) － 取文本长度 (高级表格1.取数据 (计次变量, 3))) ＋ 高级表格1.取数据 (计次变量, 3) ＋ #换行符)
        .计次循环尾 ()
        相加 (“*****************************”, #换行符).写出 ()
        .如果 (并且 (等于 (.标题, “折扣”), 小于或等于 (到数值 (.标题), 到数值 (.内容))))
            相加 (“折扣：”, .标题, 取空白文本 (相减 (16, 取文本长度 (相加 (“折扣：”, .内容)))), “合计：”, .标题, #换行符, “找零：”, .内容, 取空白文本 (相减 (16, 取文本长度 (相加 (“找零：”, .内容)))), “实付：”, 到文本 (金额), #换行符).写出 ()
        .否则
            .如果 (等于 (.标题, “折让”))
                相加 (“折让：”, .内容, 取空白文本 (相减 (16, 取文本长度 (相加 (“折扣：”, .内容)))), “合计：”, .标题, #换行符, “找零：”, .内容, 取空白文本 (相减 (16, 取文本长度 (相加 (“找零：”, .内容)))), “实付：”, 到文本 (金额), #换行符).写出 ()
            .否则
                相加 (“折扣：”, .内容, 取空白文本 (相减 (16, 取文本长度 (相加 (“折扣：”, .内容)))), “合计：”, .标题, #换行符, “找零：”, .内容, 取空白文本 (相减 (16, 取文本长度 (相加 (“找零：”, .内容)))), “实付：”, 到文本 (金额), #换行符).写出 ()
            .如果结束
            
        .如果结束
        .如果 (并且 (等于 (.可视, 真), 大于或等于 (相减 (到数值 (.标题), 金额), 0)))
            相加 (“卡号：”, .内容, 取空白文本 (相减 (16, 取文本长度 (相加 (“卡号：”, .内容)))), “余额：”, 到文本 (相减 (到数值 (.标题), 金额)), #换行符).写出 ()
        .否则
            .如果真 (等于 (.可视, 真))
                相加 (“卡号：”, .内容, 取空白文本 (相减 (16, 取文本长度 (相加 (“卡号：”, .内容)))), “余额：”, “0”, #换行符).写出 ()
            .如果真结束
            
        .如果结束
        相加 (取空白文本 (相减 (22, 取文本长度 (相加 (“订座号码：”, 读 (“电话号码”))))), “订座号码：”, 读 (“电话号码”), #换行符).写出 ()
         ' 高级表格1.打印到打印机 (打印机1)
        结束打印 ()
    .如果真结束
    关闭 (相加 (取运行目录 (), “\data\config.edb”))
    打开 (相加 (取运行目录 (), “\data\xfbb.edb”), , , , , , )
    到首记录 ()
    查找 (等于 (读 (“流水号”), .内容))
    业务操作.跳到 (., 取记录号 ())
    业务操作.置文本 (., 取记录号 (), 3, “结帐”)
    业务操作.置文本 (., 取记录号 (), 4, .标题)
    业务操作.置文本 (., 取记录号 (), 6, 到文本 (取现行时间 ()))
    业务操作.置文本 (., 取记录号 (), 7, 人员姓名)
    业务操作.置文本 (., 取记录号 (), 8, .标题)
    .如果 (等于 (.标题, “折让”))
        业务操作.置文本 (., 取记录号 (), 10, “100”)
    .否则
        .如果 (大于或等于 (到数值 (.内容), 到数值 (.标题)))
            业务操作.置文本 (., 取记录号 (), 10, .标题)
        .否则
            业务操作.置文本 (., 取记录号 (), 10, .内容)
        .如果结束
        
    .如果结束
    业务操作.置文本 (., 取记录号 (), 13, .内容)
    .如果 (并且 (等于 (.可视, 真), 小于 (到数值 (.标题), 金额)))
        业务操作.置文本 (., 取记录号 (), 9, 到文本 (相减 (金额, 到数值 (.标题))))
        业务操作.置文本 (., 取记录号 (), 14, .标题)
    .否则
        .如果 (并且 (等于 (.可视, 真), 大于或等于 (到数值 (.标题), 金额)))
            业务操作.置文本 (., 取记录号 (), 9, “0”)
            业务操作.置文本 (., 取记录号 (), 14, 到文本 (相减 (到数值 (.标题), 到数值 (.内容))))
        .否则
            
        .如果结束
        
    .如果结束
    .如果 (等于 (.可视, 假))
        业务操作.置文本 (., 取记录号 (), 9, 到文本 (金额))
    .否则
        
    .如果结束
    .如果 (等于 (.可视, 真))
        业务操作.置文本 (., 取记录号 (), 11, 到文本 (四舍五入 (相减 (相加 (到数值 (.标题), 到数值 (.内容)), 金额), 2))) ' 优惠
    .否则
        业务操作.置文本 (., 取记录号 (), 11, 到文本 (四舍五入 (相减 (到数值 (.标题), 金额), 2))) ' 优惠
    .如果结束
    .如果真 (等于 (.可视, 真))
        业务操作.置文本 (., 取记录号 (), 15, .标题)
    .如果真结束
    .如果真 (等于 (.可视, 真))
        业务操作.置文本 (., 取记录号 (), 15, .标题)
    .如果真结束
    .如果真 (并且 (等于 (.可视, 假), 等于 (.可视, 假)))
        业务操作.置文本 (., 取记录号 (), 15, “销售”)
    .如果真结束
    
    .未知支持库函数_38 ()
    业务操作.未知支持库函数_9 (., 业务操作.未知支持库函数_3 (.), 2, #., “结帐”)
    业务操作.未知支持库函数_9 (., 业务操作.未知支持库函数_3 (.), 3, #., 到文本 (金额))
    关闭 (相加 (取运行目录 (), “\data\xfbb.edb”))
    打开 (相加 (取运行目录 (), “\data\xfbbtem.edb”), , , , , , )
    到首记录 ()
    查找 (等于 (读 (“流水号”), .内容))
    业务操作.跳到 (., 取记录号 ())
    业务操作.置文本 (., 取记录号 (), 3, “结帐”)
    业务操作.置文本 (., 取记录号 (), 4, .标题)
    业务操作.置文本 (., 取记录号 (), 6, 到文本 (取现行时间 ()))
    业务操作.置文本 (., 取记录号 (), 7, 人员姓名)
    业务操作.置文本 (., 取记录号 (), 8, .标题)
    .如果 (等于 (.标题, “折让”))
        业务操作.置文本 (., 取记录号 (), 10, “100”)
    .否则
        .如果 (大于或等于 (到数值 (.内容), 到数值 (.标题)))
            业务操作.置文本 (., 取记录号 (), 10, .标题)
        .否则
            业务操作.置文本 (., 取记录号 (), 10, .内容)
        .如果结束
        
    .如果结束
    业务操作.置文本 (., 取记录号 (), 13, .内容)
    .如果 (并且 (等于 (.可视, 真), 小于 (到数值 (.标题), 金额)))
        业务操作.置文本 (., 取记录号 (), 9, 到文本 (相减 (金额, 到数值 (.标题))))
        业务操作.置文本 (., 取记录号 (), 14, .标题)
    .否则
        .如果 (并且 (等于 (.可视, 真), 大于或等于 (到数值 (.标题), 金额)))
            业务操作.置文本 (., 取记录号 (), 9, “0”)
            业务操作.置文本 (., 取记录号 (), 14, 到文本 (相减 (到数值 (.标题), 到数值 (.内容))))
        .否则
            
        .如果结束
        
    .如果结束
    .如果 (等于 (.可视, 假))
        业务操作.置文本 (., 取记录号 (), 9, 到文本 (金额))
    .否则
        
    .如果结束
    .如果 (等于 (.可视, 真))
        业务操作.置文本 (., 取记录号 (), 11, 到文本 (四舍五入 (相减 (相加 (到数值 (.标题), 到数值 (.内容)), 金额), 2))) ' 优惠
    .否则
        业务操作.置文本 (., 取记录号 (), 11, 到文本 (四舍五入 (相减 (到数值 (.标题), 金额), 2))) ' 优惠
    .如果结束
    .如果真 (等于 (.可视, 真))
        业务操作.置文本 (., 取记录号 (), 15, .标题)
    .如果真结束
    .如果真 (等于 (.可视, 真))
        业务操作.置文本 (., 取记录号 (), 15, .标题)
    .如果真结束
    .如果真 (并且 (等于 (.可视, 假), 等于 (.可视, 假)))
        业务操作.置文本 (., 取记录号 (), 15, “销售”)
    .如果真结束
    关闭 (相加 (取运行目录 (), “\data\xfbbtem.edb”))
    
    打开 (相加 (取运行目录 (), “\data\fjzl.edb”), , , , , , )
    到首记录 ()
    .判断循环首 (查找 (等于 (读 (“房间名称”), 业务操作..内容)))
        取记录号 ().置文本 (3, “0”)
        取记录号 ().置文本 (4, “空”)
        跳过 ()
    .判断循环尾 ()
    关闭 (相加 (取运行目录 (), “\data\fjzl.edb”))
    .如果 (等于 (是否已打开 (相加 (取运行目录 (), “\data\fjzl.edb”)), 假))
        信息框 (“结帐成功！”, 0, )
    .否则
        信息框 (“结帐失败！”, 0, )
    .如果结束
    结帐操作.销毁 ()
.如果真结束


.子程序 _选择框1_被单击, 空白型, , 
.如果 (等于 (.可视, 假))
    赋值 (.可视, 真)
    获取焦点 ()
.否则
    赋值 (.可视, 假)
.如果结束


.子程序 _编辑框5_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.窗口程序集 窗口程序集12, , , 

.子程序 _人员设置_创建完毕, 空白型, , 
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\user.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\userqx.edb”))
0.未知支持库函数_9 (0, #., “人员编号”)
0.未知支持库函数_9 (1, #., “人员职务”)
0.未知支持库函数_9 (2, #., “人员姓名”)
0.未知支持库函数_9 (3, #., “人员密码”)
 ' 高级表格1.置密码方式 (1, 3, 人员数据源.取行数 () ＋ 1, 3, 真)
打开 (相加 (取运行目录 (), “\data\user.edb”), , , , , , )
到首记录 ()
赋值 (., 相加 (取行数 (), 1))
.计次循环首 (取行数 (), 计次变量)
    计次变量.未知支持库函数_9 (0, #., 读 (“rybh”))
    计次变量.未知支持库函数_9 (1, #., 读 (“ryzw”))
    计次变量.未知支持库函数_9 (2, #., 读 (“ryxm”))
    计次变量.未知支持库函数_9 (3, #., 读 (“rymm”))
    跳过 ()
.计次循环尾 ()
1.未知支持库函数_51 (3, 相加 (取行数 (), 1), 3, 真)
关闭 (相加 (取运行目录 (), “\data\user.edb”))
获取焦点 ()

.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _组合框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _按钮1_被单击, 空白型, , 
到尾记录 ()
赋值 (.只读, 假)
赋值 (.允许添加, 真)
赋值 (.允许删除, 真)
到尾记录 ()
赋值 (.只读, 假)
赋值 (.允许添加, 真)
赋值 (.允许删除, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
获取焦点 ()

.子程序 _按钮2_被单击, 空白型, , 
赋值 (.只读, 假)
赋值 (.允许添加, 假)
赋值 (.允许删除, 假)
赋值 (.只读, 假)
赋值 (.允许删除, 假)
赋值 (.允许添加, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 假)

.子程序 _按钮3_被单击, 空白型, , 
.局部变量 返回值, 整数型, , , 

赋值 (返回值, 信息框 (“真的要删除这条记录吗？”, 4, ))
.如果真 (等于 (返回值, #是钮))
    赋值 (.只读, 假)
    赋值 (.允许添加, 假)
    赋值 (.允许删除, 真)
    未知支持库函数_3 ().删除行 (1)
    到尾记录 ()
    未知支持库函数_3 ().删除行 (1)
    到尾记录 ()
    未知支持库函数_3 ().未知支持库函数_36 ()
.如果真结束


.子程序 _高级表格1_被单击, 空白型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 

未知支持库函数_3 ().跳到 ()
未知支持库函数_3 ().跳到 ()
赋值 (.内容, 未知支持库函数_3 ().取文本 (1))
赋值 (.内容, 未知支持库函数_3 ().取文本 (2))
赋值 (.内容, 未知支持库函数_3 ().取文本 (3))
赋值 (.内容, 未知支持库函数_3 ().取文本 (4))

.子程序 _按钮5_被单击, 空白型, , 
销毁 ()

.子程序 _按钮4_被单击, 空白型, , 
.如果真 (等于 (.禁止, 真))
    相加 (取记录号 (), 1).插入行 (1)
    到尾记录 ()
    相加 (取记录号 (), 1).插入行 (1)
    到尾记录 ()
    .未知支持库函数_38 ()
    赋值 (.禁止, 假)
    取记录号 ().置文本 (1, .内容)
    取记录号 ().置文本 (2, .内容)
    取记录号 ().置文本 (3, .内容)
    取记录号 ().置文本 (4, .内容)
    1.未知支持库函数_51 (3, 取行数 (), 3, 真)
    取记录号 ().未知支持库函数_9 (0, #., .内容)
    取记录号 ().未知支持库函数_9 (1, #., .内容)
    取记录号 ().未知支持库函数_9 (2, #., .内容)
    取记录号 ().未知支持库函数_9 (3, #., .内容)
    取记录号 ().置文本 (1, .内容)
    取记录号 ().置文本 (2, .内容)
    取记录号 ().置文本 (3, “假”)
    取记录号 ().置文本 (4, “假”)
    取记录号 ().置文本 (5, “假”)
    取记录号 ().置文本 (6, “假”)
    取记录号 ().置文本 (7, “假”)
    取记录号 ().置文本 (8, “假”)
    取记录号 ().置文本 (9, “假”)
    取记录号 ().置文本 (10, “假”)
    取记录号 ().置文本 (11, “假”)
    取记录号 ().置文本 (12, “假”)
    取记录号 ().置文本 (13, “假”)
    取记录号 ().置文本 (14, “假”)
    取记录号 ().置文本 (15, “假”)
    取记录号 ().置文本 (16, “假”)
    赋值 (.允许添加, 假)
    赋值 (.允许删除, 假)
    赋值 (.只读, 真)
    赋值 (.只读, 真)
    赋值 (.允许添加, 假)
    赋值 (.允许删除, 假)
    赋值 (.禁止, 真)
    赋值 (.禁止, 假)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    
.如果真结束
.如果真 (等于 (.禁止, 真))
    未知支持库函数_3 ().跳到 ()
    未知支持库函数_3 ().跳到 ()
    赋值 (.禁止, 假)
    取记录号 ().置文本 (1, .内容)
    取记录号 ().置文本 (2, .内容)
    取记录号 ().置文本 (3, .内容)
    取记录号 ().置文本 (4, .内容)
    1.未知支持库函数_51 (3, 相加 (取行数 (), 1), 3, 真)
    取记录号 ().未知支持库函数_9 (0, #., .内容)
    取记录号 ().未知支持库函数_9 (1, #., .内容)
    取记录号 ().未知支持库函数_9 (2, #., .内容)
    取记录号 ().未知支持库函数_9 (3, #., .内容)
    取记录号 ().置文本 (1, .内容)
    取记录号 ().置文本 (2, .内容)
    赋值 (.允许添加, 假)
    赋值 (.允许删除, 假)
    赋值 (.只读, 真)
    赋值 (.只读, 真)
    赋值 (.允许添加, 假)
    赋值 (.允许删除, 假)
    赋值 (.禁止, 真)
    赋值 (.禁止, 假)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.如果真结束


.子程序 _编辑框3_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.窗口程序集 窗口程序集13, , , 

.子程序 _库存查询_创建完毕, 空白型, , 
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\spkc.edb”))
获取焦点 ()
0.未知支持库函数_9 (0, #., “商品编码”)
0.未知支持库函数_9 (1, #., “商品名称”)
0.未知支持库函数_9 (2, #., “单位”)
0.未知支持库函数_9 (3, #., “库存数”)
0.未知支持库函数_9 (4, #., “进价”)
0.未知支持库函数_9 (5, #., “总计”)
0.未知支持库函数_9 (6, #., “供货商”)
 ' 高级表格1.置列宽 (0, 60)
 ' 高级表格1.置列宽 (1, 120)
 ' 高级表格1.置列宽 (2, 60)
 ' 高级表格1.置列宽 (3, 60)
 ' 高级表格1.置列宽 (4, 60)
 ' 高级表格1.置列宽 (5, 60)
 ' 高级表格1.置列宽 (6, 70)
打开 (相加 (取运行目录 (), “\data\spkc.edb”), , , , , , )
到首记录 ()
赋值 (., 相加 (取行数 (), 1))
.判断循环首 (查找 (等于 (不等于 (读 (“商品名称”), “”), 真)))
    读 (“商品名称”).加入项目 ()
    取项目数 ().未知支持库函数_9 (0, #., 读 (“商品编码”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“商品名称”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“单位”))
    取项目数 ().未知支持库函数_9 (3, #., 读 (“库存数量”))
    取项目数 ().未知支持库函数_9 (4, #., 读 (“进价”))
    取项目数 ().未知支持库函数_9 (5, #., 读 (“总计”))
    取项目数 ().未知支持库函数_9 (6, #., 读 (“供货商”))
    跳过 ()
.判断循环尾 ()
赋值 (.内容, 到文本 (求和 (读 (“库存数量”), 不等于 (读 (“商品编码”), 0))))
赋值 (.标题, 到文本 (求和 (读 (“总计”), 不等于 (读 (“商品编码”), 0))))
关闭 (相加 (取运行目录 (), “\data\spkc.edb”))

.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

打开 (相加 (取运行目录 (), “\data\spkc.edb”), , , , , , )
到首记录 ()
.如果真 (等于 (字符代码, #回车键))
    .如果 (等于 (查找 (等于 (读 (“商品编码”), 到数值 (.内容))), 假))
        信息框 (“商品编码错误或无此记录!”, 0, )
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        获取焦点 ()
    .否则
        .判断循环首 (等于 (查找 (等于 (读 (“商品编码”), 到数值 (.内容))), 真))
            清空 ()
            未知支持库函数_57 ()
            0.未知支持库函数_9 (0, #., “商品编码”)
            0.未知支持库函数_9 (1, #., “商品名称”)
            0.未知支持库函数_9 (2, #., “单位”)
            0.未知支持库函数_9 (3, #., “库存数”)
            0.未知支持库函数_9 (4, #., “进价”)
            0.未知支持库函数_9 (5, #., “总计”)
            0.未知支持库函数_9 (6, #., “供货商”)
             ' 高级表格1.置列宽 (0, 60)
             ' 高级表格1.置列宽 (1, 120)
             ' 高级表格1.置列宽 (2, 60)
             ' 高级表格1.置列宽 (3, 60)
             ' 高级表格1.置列宽 (4, 60)
             ' 高级表格1.置列宽 (5, 60)
             ' 高级表格1.置列宽 (6, 70)
            
            读 (“商品名称”).加入项目 ()
            取项目数 ().未知支持库函数_9 (0, #., 读 (“商品编码”))
            取项目数 ().未知支持库函数_9 (1, #., 读 (“商品名称”))
            取项目数 ().未知支持库函数_9 (2, #., 读 (“单位”))
            取项目数 ().未知支持库函数_9 (3, #., 读 (“库存数量”))
            取项目数 ().未知支持库函数_9 (4, #., 读 (“进价”))
            取项目数 ().未知支持库函数_9 (5, #., 读 (“总计”))
            取项目数 ().未知支持库函数_9 (6, #., 读 (“供货商”))
            赋值 (.内容, “”)
            赋值 (.内容, 取记录号 ().取文本 (4))
            赋值 (.标题, 取记录号 ().取文本 (6))
            跳过 ()
        .判断循环尾 ()
        赋值 (.内容, “”)
    .如果结束
    
.如果真结束
关闭 (相加 (取运行目录 (), “\data\spkc.edb”))

.子程序 _按钮1_被单击, 空白型, , 
销毁 ()

.子程序 _删除_被选择, 空白型, , 
.局部变量 返回值, 整数型, , , 

赋值 (返回值, 信息框 (相加 (“确定要删除”, “《”, 未知支持库函数_3 ().取文本 (2), “》”, “吗？删除后将无法恢复!!”), 4, ))
.如果真 (等于 (返回值, #是钮))
    赋值 (.只读, 假)
    赋值 (.允许添加, 假)
    赋值 (.允许删除, 真)
    未知支持库函数_3 ().删除行 ()
    未知支持库函数_3 ().未知支持库函数_36 ()
.如果真结束


.子程序 _表格1_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _修改_被选择, 空白型, , 
赋值 (.只读, 假)
赋值 (.允许添加, 真)
赋值 (.允许删除, 真)


.子程序 _保存_被选择, 空白型, , 
赋值 (.只读, 真)
赋值 (.允许添加, 假)
赋值 (.允许删除, 假)

.子程序 _高级表格1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()


.窗口程序集 窗口程序集14, , , 

.子程序 _销售明细_创建完毕, 空白型, , 
赋值 (.今天, 取日期 (取现行时间 ()))
未知支持库函数_57 ()
清空 ()
0.未知支持库函数_9 (0, #., “商品编号”)
0.未知支持库函数_9 (1, #., “商品名称”)
0.未知支持库函数_9 (2, #., “单位”)
0.未知支持库函数_9 (3, #., “销售数量”)
0.未知支持库函数_9 (4, #., “单价”)
0.未知支持库函数_9 (5, #., “总计”)
0.未知支持库函数_9 (6, #., “流水号”)
0.未知支持库函数_9 (7, #., “操作员”)
2.未知支持库函数_32 (60)
6.未知支持库函数_32 (110)
打开 (相加 (取运行目录 (), “\data\user.edb”), , , , , , )
到首记录 ()
.判断循环首 (等于 (查找 (大于或等于 (到数值 (读 (“rybh”)), 0)), 真))
    读 (“ryxm”).加入项目 ()
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\user.edb”))

打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
到首记录 ()
赋值 (., 2)
.判断循环首 (查找 (等于 (取日期 (读 (“销售日期”)), .今天)))
    到文本 (读 (“商品名称”)).加入项目 ()
    取项目数 ()
    赋值 (., 相加 (取项目数 (), 1))
    取项目数 ().未知支持库函数_9 (0, #., 读 (“商品编号”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“商品名称”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“单位”))
    取项目数 ().未知支持库函数_9 (3, #., 读 (“销售数量”))
    取项目数 ().未知支持库函数_9 (4, #., 读 (“售价”))
    取项目数 ().未知支持库函数_9 (5, #., 读 (“总计”))
    取项目数 ().未知支持库函数_9 (6, #., 读 (“流水单号”))
    取项目数 ().未知支持库函数_9 (7, #., 读 (“操作员”))
    跳过 ()
.判断循环尾 ()
赋值 (.内容, 到文本 (求和 (到数值 (读 (“销售数量”)), 等于 (取日期 (读 (“销售日期”)), .今天))))
赋值 (.内容, 到文本 (求和 (到数值 (读 (“总计”)), 等于 (取日期 (读 (“销售日期”)), .今天))))
0.未知支持库函数_18 (0, 相加 (取项目数 (), 1), 14, 16)
关闭 (相加 (取运行目录 (), “\data\xsls.edb”))

.子程序 _按钮1_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    .如果 (等于 (.内容, “全部”))
        未知支持库函数_57 ()
        清空 ()
        0.未知支持库函数_9 (0, #., “商品编号”)
        0.未知支持库函数_9 (1, #., “商品名称”)
        0.未知支持库函数_9 (2, #., “单位”)
        0.未知支持库函数_9 (3, #., “销售数量”)
        0.未知支持库函数_9 (4, #., “单价”)
        0.未知支持库函数_9 (5, #., “总计”)
        0.未知支持库函数_9 (6, #., “流水号”)
        0.未知支持库函数_9 (7, #., “操作员”)
        2.未知支持库函数_32 (60)
        6.未知支持库函数_32 (110)
        打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
        到首记录 ()
        赋值 (., 2)
        .判断循环首 (查找 (并且 (大于或等于 (取日期 (读 (“销售日期”)), .今天), 查找 (等于 (小于或等于 (取日期 (读 (“销售日期”)), .今天), 真)))))
            读 (“商品名称”).加入项目 ()
            取项目数 ()
            赋值 (., 相加 (取项目数 (), 1))
            取项目数 ().未知支持库函数_9 (0, #., 读 (“商品编号”))
            取项目数 ().未知支持库函数_9 (1, #., 读 (“商品名称”))
            取项目数 ().未知支持库函数_9 (2, #., 读 (“单位”))
            取项目数 ().未知支持库函数_9 (3, #., 读 (“销售数量”))
            取项目数 ().未知支持库函数_9 (4, #., 读 (“售价”))
            取项目数 ().未知支持库函数_9 (5, #., 读 (“总计”))
            取项目数 ().未知支持库函数_9 (6, #., 读 (“流水单号”))
            取项目数 ().未知支持库函数_9 (7, #., 读 (“操作员”))
            跳过 ()
        .判断循环尾 ()
        赋值 (.内容, 到文本 (求和 (到数值 (读 (“销售数量”)), 并且 (大于或等于 (取日期 (读 (“销售日期”)), .今天), 小于或等于 (取日期 (读 (“销售日期”)), .今天)))))
        赋值 (.内容, 到文本 (求和 (到数值 (读 (“总计”)), 并且 (大于或等于 (取日期 (读 (“销售日期”)), .今天), 小于或等于 (取日期 (读 (“销售日期”)), .今天)))))
        关闭 (相加 (取运行目录 (), “\data\xsls.edb”))
    .否则
        未知支持库函数_57 ()
        清空 ()
        0.未知支持库函数_9 (0, #., “商品编号”)
        0.未知支持库函数_9 (1, #., “商品名称”)
        0.未知支持库函数_9 (2, #., “单位”)
        0.未知支持库函数_9 (3, #., “销售数量”)
        0.未知支持库函数_9 (4, #., “单价”)
        0.未知支持库函数_9 (5, #., “总计”)
        0.未知支持库函数_9 (6, #., “流水号”)
        0.未知支持库函数_9 (7, #., “操作员”)
        2.未知支持库函数_32 (60)
        6.未知支持库函数_32 (110)
        
        打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
        到首记录 ()
        赋值 (., 2)
        .判断循环首 (查找 (并且 (大于或等于 (取日期 (读 (“销售日期”)), .今天), 查找 (并且 (小于或等于 (取日期 (读 (“销售日期”)), .今天), 等于 (查找 (等于 (读 (“操作员”), .内容)), 真))))))
            读 (“商品名称”).加入项目 ()
            取项目数 ()
            赋值 (., 相加 (取项目数 (), 1))
            取项目数 ().未知支持库函数_9 (0, #., 读 (“商品编号”))
            取项目数 ().未知支持库函数_9 (1, #., 读 (“商品名称”))
            取项目数 ().未知支持库函数_9 (2, #., 读 (“单位”))
            取项目数 ().未知支持库函数_9 (3, #., 读 (“销售数量”))
            取项目数 ().未知支持库函数_9 (4, #., 读 (“售价”))
            取项目数 ().未知支持库函数_9 (5, #., 读 (“总计”))
            取项目数 ().未知支持库函数_9 (6, #., 读 (“流水单号”))
            取项目数 ().未知支持库函数_9 (7, #., 读 (“操作员”))
            跳过 ()
        .判断循环尾 ()
        赋值 (.内容, 到文本 (求和 (到数值 (读 (“销售数量”)), 并且 (大于或等于 (取日期 (读 (“销售日期”)), .今天), 小于或等于 (取日期 (读 (“销售日期”)), .今天), 等于 (读 (“操作员”), .内容)))))
        赋值 (.内容, 到文本 (求和 (到数值 (读 (“总计”)), 并且 (大于或等于 (取日期 (读 (“销售日期”)), .今天), 小于或等于 (取日期 (读 (“销售日期”)), .今天), 等于 (读 (“操作员”), .内容)))))
        关闭 (相加 (取运行目录 (), “\data\xsls.edb”))
    .如果结束
    0.未知支持库函数_18 (0, 相加 (取项目数 (), 1), 14, 16)
.否则
    .如果 (等于 (.内容, “全部”))
        未知支持库函数_57 ()
        清空 ()
        0.未知支持库函数_9 (0, #., “商品编号”)
        0.未知支持库函数_9 (1, #., “商品名称”)
        0.未知支持库函数_9 (2, #., “单位”)
        0.未知支持库函数_9 (3, #., “销售数量”)
        0.未知支持库函数_9 (4, #., “单价”)
        0.未知支持库函数_9 (5, #., “总计”)
        0.未知支持库函数_9 (6, #., “流水号”)
        0.未知支持库函数_9 (7, #., “操作员”)
        2.未知支持库函数_32 (60)
        6.未知支持库函数_32 (110)
        打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
        到首记录 ()
        赋值 (., 2)
        .判断循环首 (查找 (等于 (取日期 (读 (“销售日期”)), .今天)))
            到文本 (读 (“商品名称”)).加入项目 ()
            取项目数 ()
            赋值 (., 相加 (取项目数 (), 1))
            取项目数 ().未知支持库函数_9 (0, #., 读 (“商品编号”))
            取项目数 ().未知支持库函数_9 (1, #., 读 (“商品名称”))
            取项目数 ().未知支持库函数_9 (2, #., 读 (“单位”))
            取项目数 ().未知支持库函数_9 (3, #., 读 (“销售数量”))
            取项目数 ().未知支持库函数_9 (4, #., 读 (“售价”))
            取项目数 ().未知支持库函数_9 (5, #., 读 (“总计”))
            取项目数 ().未知支持库函数_9 (6, #., 读 (“流水单号”))
            取项目数 ().未知支持库函数_9 (7, #., 读 (“操作员”))
            跳过 ()
        .判断循环尾 ()
        赋值 (.内容, 到文本 (求和 (到数值 (读 (“销售数量”)), 等于 (取日期 (读 (“销售日期”)), .今天))))
        赋值 (.内容, 到文本 (求和 (到数值 (读 (“总计”)), 等于 (取日期 (读 (“销售日期”)), .今天))))
        关闭 (相加 (取运行目录 (), “\data\xsls.edb”))
    .否则
        未知支持库函数_57 ()
        清空 ()
        0.未知支持库函数_9 (0, #., “商品编号”)
        0.未知支持库函数_9 (1, #., “商品名称”)
        0.未知支持库函数_9 (2, #., “单位”)
        0.未知支持库函数_9 (3, #., “销售数量”)
        0.未知支持库函数_9 (4, #., “单价”)
        0.未知支持库函数_9 (5, #., “总计”)
        0.未知支持库函数_9 (6, #., “流水号”)
        0.未知支持库函数_9 (7, #., “操作员”)
        2.未知支持库函数_32 (60)
        6.未知支持库函数_32 (110)
        打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
        到首记录 ()
        赋值 (., 2)
        .判断循环首 (查找 (并且 (等于 (取日期 (读 (“销售日期”)), .今天), 查找 (等于 (读 (“操作员”), .内容)))))
            到文本 (读 (“商品名称”)).加入项目 ()
            取项目数 ()
            赋值 (., 相加 (取项目数 (), 1))
            取项目数 ().未知支持库函数_9 (0, #., 读 (“商品编号”))
            取项目数 ().未知支持库函数_9 (1, #., 读 (“商品名称”))
            取项目数 ().未知支持库函数_9 (2, #., 读 (“单位”))
            取项目数 ().未知支持库函数_9 (3, #., 读 (“销售数量”))
            取项目数 ().未知支持库函数_9 (4, #., 读 (“售价”))
            取项目数 ().未知支持库函数_9 (5, #., 读 (“总计”))
            取项目数 ().未知支持库函数_9 (6, #., 读 (“流水单号”))
            取项目数 ().未知支持库函数_9 (7, #., 读 (“操作员”))
            跳过 ()
        .判断循环尾 ()
        赋值 (.内容, 到文本 (求和 (到数值 (读 (“销售数量”)), 并且 (等于 (取日期 (读 (“销售日期”)), .今天), 等于 (读 (“操作员”), .内容)))))
        赋值 (.内容, 到文本 (求和 (到数值 (读 (“总计”)), 并且 (等于 (取日期 (读 (“销售日期”)), .今天), 等于 (读 (“操作员”), .内容)))))
        关闭 (相加 (取运行目录 (), “\data\xsls.edb”))
    .如果结束
    
.如果结束
0.未知支持库函数_18 (0, 相加 (取项目数 (), 1), 14, 16)

.子程序 _编辑框1_获得焦点, 空白型, , 
 ' 编辑框1.内容 ＝ “”

.子程序 _编辑框2_获得焦点, 空白型, , 
 ' 编辑框2.内容 ＝ “”


.子程序 _选择框1_被单击, 空白型, , 
.如果 (等于 (.禁止, 真))
    赋值 (.选中, 真)
    赋值 (.禁止, 假)
.否则
    赋值 (.选中, 假)
    赋值 (.禁止, 真)
.如果结束


.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
.如果真 (等于 (字符代码, #回车键))
    未知支持库函数_57 ()
    清空 ()
    0.未知支持库函数_9 (0, #., “商品编号”)
    0.未知支持库函数_9 (1, #., “商品名称”)
    0.未知支持库函数_9 (2, #., “单位”)
    0.未知支持库函数_9 (3, #., “销售数量”)
    0.未知支持库函数_9 (4, #., “单价”)
    0.未知支持库函数_9 (5, #., “总计”)
    0.未知支持库函数_9 (6, #., “流水号”)
    0.未知支持库函数_9 (7, #., “操作员”)
    2.未知支持库函数_32 (60)
    6.未知支持库函数_32 (110)
    打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
    到首记录 ()
    赋值 (., 2)
    .如果 (等于 (.选中, 真))
        .判断循环首 (查找 (并且 (大于或等于 (取日期 (读 (“销售日期”)), .今天), 小于或等于 (取日期 (读 (“销售日期”)), .今天), 等于 (读 (“商品编号”), .内容))))
            到文本 (读 (“商品名称”)).加入项目 ()
            取项目数 ()
            赋值 (., 相加 (取项目数 (), 1))
            取项目数 ().未知支持库函数_9 (0, #., 读 (“商品编号”))
            取项目数 ().未知支持库函数_9 (1, #., 读 (“商品名称”))
            取项目数 ().未知支持库函数_9 (2, #., 读 (“单位”))
            取项目数 ().未知支持库函数_9 (3, #., 读 (“销售数量”))
            取项目数 ().未知支持库函数_9 (4, #., 读 (“售价”))
            取项目数 ().未知支持库函数_9 (5, #., 读 (“总计”))
            取项目数 ().未知支持库函数_9 (6, #., 读 (“流水单号”))
            取项目数 ().未知支持库函数_9 (7, #., 读 (“操作员”))
            跳过 ()
        .判断循环尾 ()
        赋值 (.标题, 到文本 (求和 (到数值 (读 (“销售数量”)), 并且 (大于或等于 (取日期 (读 (“销售日期”)), .今天), 小于或等于 (取日期 (读 (“销售日期”)), .今天), 等于 (读 (“商品编号”), .内容)))))
        赋值 (.标题, 到文本 (求和 (到数值 (读 (“总计”)), 并且 (大于或等于 (取日期 (读 (“销售日期”)), .今天), 小于或等于 (取日期 (读 (“销售日期”)), .今天), 等于 (读 (“商品编号”), .内容)))))
    .否则
        .判断循环首 (查找 (并且 (等于 (取日期 (读 (“销售日期”)), .今天), 等于 (读 (“商品编号”), .内容))))
            到文本 (读 (“商品名称”)).加入项目 ()
            取项目数 ()
            赋值 (., 相加 (取项目数 (), 1))
            取项目数 ().未知支持库函数_9 (0, #., 读 (“商品编号”))
            取项目数 ().未知支持库函数_9 (1, #., 读 (“商品名称”))
            取项目数 ().未知支持库函数_9 (2, #., 读 (“单位”))
            取项目数 ().未知支持库函数_9 (3, #., 读 (“销售数量”))
            取项目数 ().未知支持库函数_9 (4, #., 读 (“售价”))
            取项目数 ().未知支持库函数_9 (5, #., 读 (“总计”))
            取项目数 ().未知支持库函数_9 (6, #., 读 (“流水单号”))
            取项目数 ().未知支持库函数_9 (7, #., 读 (“操作员”))
            跳过 ()
        .判断循环尾 ()
        赋值 (.标题, 到文本 (求和 (到数值 (读 (“销售数量”)), 并且 (等于 (取日期 (读 (“销售日期”)), .今天), 等于 (读 (“商品编号”), .内容)))))
        赋值 (.标题, 到文本 (求和 (到数值 (读 (“总计”)), 并且 (等于 (取日期 (读 (“销售日期”)), .今天), 等于 (读 (“商品编号”), .内容)))))
    .如果结束
    赋值 (.内容, “”)
.如果真结束
关闭 (相加 (取运行目录 (), “\data\xsls.edb”))

.子程序 _按钮2_被单击, 空白型, , 
未知支持库函数_27 ()

.子程序 _高级表格2_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 假)


.子程序 _按钮3_被单击, 空白型, , 
.局部变量 a, 文本型, , , 
.局部变量 b, 文本型, , , 

 ' 高级表格2.可视 ＝ 真
 ' 高级表格2.清空数据 ()
 ' ' 列表框1.清空 ()
 ' 高级表格2.置数据 (0, 0, #表格常量.文本型, “商品编号”)
 ' 高级表格2.置数据 (0, 1, #表格常量.文本型, “商品名称”)
 ' 高级表格2.置数据 (0, 2, #表格常量.文本型, “单位”)
 ' 高级表格2.置数据 (0, 3, #表格常量.文本型, “销售数量”)
 ' 高级表格2.置数据 (0, 4, #表格常量.文本型, “单价”)
 ' 高级表格2.置数据 (0, 5, #表格常量.文本型, “总计”)
 ' 高级表格2.置列宽 (1, 150)
 ' 高级表格2.置列宽 (2, 40)
 ' 高级表格2.置列宽 (6, 120)
 ' 高级表格2.行数 ＝ 列表框1.取项目数 ()
 ' 打开 (取运行目录 () ＋ “\data\xsls.edb”, , , , , , )
 ' 到首记录 ()
 ' .判断循环首 (查找 (不等于 (读 (“商品编码”), “”)))
     ' c
     ' 跳过 ()
 ' .判断循环尾 ()
 ' 关闭 (取运行目录 () ＋ “\data\xsls.edb”)
 ' 高级表格2.置字体尺寸 (0, 0, 列表框1.取项目数 () ＋ 1, 14, 16)

.窗口程序集 窗口程序集15, , , 

.子程序 _软件注册_创建完毕, 空白型, , 
.局部变量 文本变量, 文本型, , , 
.局部变量 硬盘注册键, 文本型, , , 

赋值 (.内容, 到文本 (取硬盘特征字 ()))
赋值 (硬盘注册键, 相加 (到文本 (取十六进制文本 (相乘 (取硬盘特征字 (), 1881696))), “-”, 到文本 (取十六进制文本 (相乘 (取硬盘特征字 (), 49826865))), “-”, 到文本 (取十六进制文本 (相乘 (取硬盘特征字 (), 138913913))), “-”, 到文本 (取十六进制文本 (相乘 (取硬盘特征字 (), 19800624)))))
赋值 (文本变量, 取文本注册项 (#现行用户, “Software\Microsoft\Internet Explorer\Main\TVKEY”, ))
打开 (相加 (取运行目录 (), “\data\config.edb”), , , , , , )
到首记录 ()
.如果真 (等于 (文本变量, 硬盘注册键))
    赋值 (.内容, 读 (“单位信息”))
    赋值 (.内容, “正式注册版”)
    赋值 (.禁止, 真)
.如果真结束
关闭 (相加 (取运行目录 (), “\data\config.edb”))

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 特征字符, 文本型, , , 

赋值 (特征字符, 相加 (到文本 (取十六进制文本 (相乘 (取硬盘特征字 (), 1881696))), “-”, 到文本 (取十六进制文本 (相乘 (取硬盘特征字 (), 49826865))), “-”, 到文本 (取十六进制文本 (相乘 (取硬盘特征字 (), 138913913))), “-”, 到文本 (取十六进制文本 (相乘 (取硬盘特征字 (), 19800624)))))
.如果 (不等于 (.内容, 特征字符))
    信息框 (“注册码错误！请向作者注册，索取正确注册码！”, 0, )
.否则
    信息框 (“谢谢注册！您可以继续使用本软件！请重新启动看是否注册成功！”, 0, )
    写注册项 (#现行用户, “Software\Microsoft\Internet Explorer\Main\TVKEY”, 特征字符)
    销毁 ()
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集16, , , 

.窗口程序集 窗口程序集17, , , 

.子程序 _报表汇总_创建完毕, 空白型, , 
.局部变量 时间值, 日期时间型, , , 

赋值 (.今天, 取日期 (取现行时间 ()))
清空 ()
未知支持库函数_57 ()
0.未知支持库函数_9 (0, #., “台名”)
0.未知支持库函数_9 (1, #., “人数”)
0.未知支持库函数_9 (2, #., “消费”)
0.未知支持库函数_9 (3, #., “开台时间”)
0.未知支持库函数_9 (4, #., “结帐时间”)
0.未知支持库函数_9 (5, #., “操作员”)
0.未知支持库函数_9 (6, #., “总计”)
0.未知支持库函数_9 (7, #., “实付”)
0.未知支持库函数_9 (8, #., “折扣”)
0.未知支持库函数_9 (9, #., “优惠”)
0.未知支持库函数_9 (10, #., “流水号”)
0.未知支持库函数_9 (11, #., “会员卡”)
0.未知支持库函数_9 (12, #., “卡金额”)
0.未知支持库函数_9 (13, #., “标志”)
0.未知支持库函数_9 (14, #., “折扣率”)
0.未知支持库函数_32 (40)
1.未知支持库函数_32 (40)
2.未知支持库函数_32 (40)
3.未知支持库函数_32 (175)
4.未知支持库函数_32 (175)
5.未知支持库函数_32 (70)
6.未知支持库函数_32 (50)
7.未知支持库函数_32 (50)
8.未知支持库函数_32 (50)
9.未知支持库函数_32 (50)
10.未知支持库函数_32 (110)
13.未知支持库函数_32 (40)
0.未知支持库函数_18 (0, 未知支持库函数_7 (), 未知支持库函数_8 (), 12)
打开 (相加 (取运行目录 (), “\data\user.edb”), , , , , , )
到首记录 ()
.判断循环首 (等于 (查找 (大于或等于 (到数值 (读 (“rybh”)), 0)), 真))
    读 (“ryxm”).加入项目 ()
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\user.edb”))

打开 (相加 (取运行目录 (), “\data\xfbb.edb”), , , , , , )
到首记录 ()
赋值 (., 2)
.判断循环首 (查找 (等于 (取日期 (读 (“开台时间”)), .今天)))
    读 (“流水号”).加入项目 ()
    取项目数 ()
    赋值 (., 相加 (取项目数 (), 1))
    取项目数 ().未知支持库函数_9 (0, #., 读 (“台名”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“人数”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“消费”))
    取项目数 ().未知支持库函数_9 (3, #., 到文本 (读 (“开台时间”)))
    取项目数 ().未知支持库函数_9 (4, #., 到文本 (读 (“结帐时间”)))
    取项目数 ().未知支持库函数_9 (5, #., 读 (“操作员”))
    取项目数 ().未知支持库函数_9 (6, #., 读 (“总计”))
    取项目数 ().未知支持库函数_9 (7, #., 读 (“实付”))
    取项目数 ().未知支持库函数_9 (8, #., 读 (“折扣”))
    取项目数 ().未知支持库函数_9 (9, #., 读 (“优惠”))
    取项目数 ().未知支持库函数_9 (10, #., 读 (“流水号”))
    取项目数 ().未知支持库函数_9 (11, #., 读 (“卡号码”))
    取项目数 ().未知支持库函数_9 (12, #., 读 (“卡金额”))
    取项目数 ().未知支持库函数_9 (13, #., 读 (“标志”))
    取项目数 ().未知支持库函数_9 (14, #., 读 (“折扣率”))
    跳过 ()
.判断循环尾 ()
赋值 (.内容, 到文本 (求和 (到数值 (读 (“实付”)), 等于 (取日期 (读 (“结帐时间”)), .今天))))
赋值 (.内容, 到文本 (求和 (到数值 (读 (“总计”)), 等于 (取日期 (读 (“结帐时间”)), .今天))))
.未知支持库函数_38 ()
相加 (取项目数 (), 1).未知支持库函数_9 (5, #., “合计：”)
相加 (取项目数 (), 1).未知支持库函数_9 (6, #., .内容)
相加 (取项目数 (), 1).未知支持库函数_9 (7, #., .内容)
相加 (取项目数 (), 1).未知支持库函数_9 (9, #., 到文本 (求和 (到数值 (读 (“优惠”)), 等于 (取日期 (读 (“结帐时间”)), .今天))))
相加 (取项目数 (), 1).未知支持库函数_9 (12, #., 到文本 (求和 (到数值 (读 (“卡金额”)), 等于 (取日期 (读 (“结帐时间”)), .今天))))
关闭 (相加 (取运行目录 (), “\data\xfbb.edb”))
0.未知支持库函数_18 (0, 相加 (取项目数 (), 1), 14, 16)

.子程序 _选择框1_被单击, 空白型, , 
.如果 (等于 (.禁止, 真))
    赋值 (.选中, 真)
    赋值 (.禁止, 假)
.否则
    赋值 (.选中, 假)
    赋值 (.禁止, 真)
.如果结束


.子程序 _编辑框1_获得焦点, 空白型, , 
 ' 编辑框1.内容 ＝ “”

.子程序 _编辑框2_获得焦点, 空白型, , 
 ' 编辑框2.内容 ＝ “”

.子程序 _按钮1_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    .如果 (等于 (.内容, “全部”))
        清空 ()
        未知支持库函数_57 ()
        0.未知支持库函数_9 (0, #., “台名”)
        0.未知支持库函数_9 (1, #., “人数”)
        0.未知支持库函数_9 (2, #., “消费”)
        0.未知支持库函数_9 (3, #., “开台时间”)
        0.未知支持库函数_9 (4, #., “结帐时间”)
        0.未知支持库函数_9 (5, #., “操作员”)
        0.未知支持库函数_9 (6, #., “总计”)
        0.未知支持库函数_9 (7, #., “实付”)
        0.未知支持库函数_9 (8, #., “折扣”)
        0.未知支持库函数_9 (9, #., “优惠”)
        0.未知支持库函数_9 (10, #., “流水号”)
        0.未知支持库函数_9 (11, #., “会员卡”)
        0.未知支持库函数_9 (12, #., “卡金额”)
        0.未知支持库函数_9 (13, #., “标志”)
        0.未知支持库函数_9 (14, #., “折扣率”)
        0.未知支持库函数_32 (40)
        1.未知支持库函数_32 (40)
        2.未知支持库函数_32 (40)
        3.未知支持库函数_32 (175)
        4.未知支持库函数_32 (175)
        5.未知支持库函数_32 (70)
        6.未知支持库函数_32 (50)
        7.未知支持库函数_32 (50)
        8.未知支持库函数_32 (50)
        9.未知支持库函数_32 (50)
        10.未知支持库函数_32 (110)
        13.未知支持库函数_32 (40)
        打开 (相加 (取运行目录 (), “\data\xfbb.edb”), , , , , , )
        到首记录 ()
        赋值 (., 2)
        .判断循环首 (查找 (并且 (大于或等于 (取日期 (读 (“开台时间”)), .今天), 查找 (等于 (小于或等于 (取日期 (读 (“开台时间”)), .今天), 真)))))
            读 (“流水号”).加入项目 ()
            取项目数 ()
            赋值 (., 相加 (取项目数 (), 1))
            取项目数 ().未知支持库函数_9 (0, #., 读 (“台名”))
            取项目数 ().未知支持库函数_9 (1, #., 读 (“人数”))
            取项目数 ().未知支持库函数_9 (2, #., 读 (“消费”))
            取项目数 ().未知支持库函数_9 (3, #., 到文本 (读 (“开台时间”)))
            取项目数 ().未知支持库函数_9 (4, #., 到文本 (读 (“结帐时间”)))
            取项目数 ().未知支持库函数_9 (5, #., 读 (“操作员”))
            取项目数 ().未知支持库函数_9 (6, #., 读 (“总计”))
            取项目数 ().未知支持库函数_9 (7, #., 读 (“实付”))
            取项目数 ().未知支持库函数_9 (8, #., 读 (“折扣”))
            取项目数 ().未知支持库函数_9 (9, #., 读 (“优惠”))
            取项目数 ().未知支持库函数_9 (10, #., 读 (“流水号”))
            取项目数 ().未知支持库函数_9 (11, #., 读 (“卡号码”))
            取项目数 ().未知支持库函数_9 (12, #., 读 (“卡金额”))
            取项目数 ().未知支持库函数_9 (13, #., 读 (“标志”))
            取项目数 ().未知支持库函数_9 (14, #., 读 (“折扣率”))
            跳过 ()
        .判断循环尾 ()
        赋值 (.内容, 到文本 (求和 (到数值 (读 (“实付”)), 并且 (大于或等于 (取日期 (读 (“开台时间”)), .今天), 小于或等于 (取日期 (读 (“开台时间”)), .今天)))))
        赋值 (.内容, 到文本 (求和 (到数值 (读 (“总计”)), 并且 (大于或等于 (取日期 (读 (“开台时间”)), .今天), 小于或等于 (取日期 (读 (“开台时间”)), .今天)))))
        .未知支持库函数_38 ()
        相加 (取项目数 (), 1).未知支持库函数_9 (5, #., “合计：”)
        相加 (取项目数 (), 1).未知支持库函数_9 (6, #., .内容)
        相加 (取项目数 (), 1).未知支持库函数_9 (7, #., .内容)
        相加 (取项目数 (), 1).未知支持库函数_9 (9, #., 到文本 (求和 (到数值 (读 (“优惠”)), 并且 (大于或等于 (取日期 (读 (“开台时间”)), .今天), 小于或等于 (取日期 (读 (“开台时间”)), .今天)))))
        相加 (取项目数 (), 1).未知支持库函数_9 (12, #., 到文本 (求和 (到数值 (读 (“卡金额”)), 并且 (大于或等于 (取日期 (读 (“开台时间”)), .今天), 小于或等于 (取日期 (读 (“开台时间”)), .今天)))))
        关闭 (相加 (取运行目录 (), “\data\xfbb.edb”))
    .否则
        清空 ()
        未知支持库函数_57 ()
        0.未知支持库函数_9 (0, #., “台名”)
        0.未知支持库函数_9 (1, #., “人数”)
        0.未知支持库函数_9 (2, #., “消费”)
        0.未知支持库函数_9 (3, #., “开台时间”)
        0.未知支持库函数_9 (4, #., “结帐时间”)
        0.未知支持库函数_9 (5, #., “操作员”)
        0.未知支持库函数_9 (6, #., “总计”)
        0.未知支持库函数_9 (7, #., “实付”)
        0.未知支持库函数_9 (8, #., “折扣”)
        0.未知支持库函数_9 (9, #., “优惠”)
        0.未知支持库函数_9 (10, #., “流水号”)
        0.未知支持库函数_9 (11, #., “会员卡”)
        0.未知支持库函数_9 (12, #., “卡金额”)
        0.未知支持库函数_9 (13, #., “标志”)
        0.未知支持库函数_9 (14, #., “折扣率”)
        3.未知支持库函数_32 (160)
        4.未知支持库函数_32 (160)
        10.未知支持库函数_32 (100)
        打开 (相加 (取运行目录 (), “\data\xfbb.edb”), , , , , , )
        到首记录 ()
        赋值 (., 2)
        .判断循环首 (查找 (并且 (大于或等于 (取日期 (读 (“开台时间”)), .今天), 查找 (并且 (小于或等于 (取日期 (读 (“开台时间”)), .今天), 等于 (查找 (等于 (读 (“操作员”), .内容)), 真))))))
            读 (“流水号”).加入项目 ()
            取项目数 ()
            赋值 (., 相加 (取项目数 (), 1))
            取项目数 ().未知支持库函数_9 (0, #., 读 (“台名”))
            取项目数 ().未知支持库函数_9 (1, #., 读 (“人数”))
            取项目数 ().未知支持库函数_9 (2, #., 读 (“消费”))
            取项目数 ().未知支持库函数_9 (3, #., 到文本 (读 (“开台时间”)))
            取项目数 ().未知支持库函数_9 (4, #., 到文本 (读 (“结帐时间”)))
            取项目数 ().未知支持库函数_9 (5, #., 读 (“操作员”))
            取项目数 ().未知支持库函数_9 (6, #., 读 (“总计”))
            取项目数 ().未知支持库函数_9 (7, #., 读 (“实付”))
            取项目数 ().未知支持库函数_9 (8, #., 读 (“折扣”))
            取项目数 ().未知支持库函数_9 (9, #., 读 (“优惠”))
            取项目数 ().未知支持库函数_9 (10, #., 读 (“流水号”))
            取项目数 ().未知支持库函数_9 (11, #., 读 (“卡号码”))
            取项目数 ().未知支持库函数_9 (12, #., 读 (“卡金额”))
            取项目数 ().未知支持库函数_9 (13, #., 读 (“标志”))
            取项目数 ().未知支持库函数_9 (14, #., 读 (“折扣率”))
            跳过 ()
        .判断循环尾 ()
        赋值 (.内容, 到文本 (求和 (到数值 (读 (“实付”)), 并且 (大于或等于 (取日期 (读 (“开台时间”)), .今天), 小于或等于 (取日期 (读 (“开台时间”)), .今天), 等于 (读 (“操作员”), .内容)))))
        赋值 (.内容, 到文本 (求和 (到数值 (读 (“总计”)), 并且 (大于或等于 (取日期 (读 (“开台时间”)), .今天), 小于或等于 (取日期 (读 (“开台时间”)), .今天), 等于 (读 (“操作员”), .内容)))))
        .未知支持库函数_38 ()
        相加 (取项目数 (), 1).未知支持库函数_9 (5, #., “合计：”)
        相加 (取项目数 (), 1).未知支持库函数_9 (6, #., .内容)
        相加 (取项目数 (), 1).未知支持库函数_9 (7, #., .内容)
        相加 (取项目数 (), 1).未知支持库函数_9 (9, #., 到文本 (求和 (到数值 (读 (“优惠”)), 并且 (大于或等于 (取日期 (读 (“开台时间”)), .今天), 小于或等于 (取日期 (读 (“开台时间”)), .今天), 等于 (读 (“操作员”), .内容)))))
        相加 (取项目数 (), 1).未知支持库函数_9 (12, #., 到文本 (求和 (到数值 (读 (“卡金额”)), 并且 (大于或等于 (取日期 (读 (“开台时间”)), .今天), 小于或等于 (取日期 (读 (“开台时间”)), .今天), 等于 (读 (“操作员”), .内容)))))
        关闭 (相加 (取运行目录 (), “\data\xfbb.edb”))
    .如果结束
    
.否则
    .如果 (等于 (.内容, “全部”))
        清空 ()
        未知支持库函数_57 ()
        0.未知支持库函数_9 (0, #., “台名”)
        0.未知支持库函数_9 (1, #., “人数”)
        0.未知支持库函数_9 (2, #., “消费”)
        0.未知支持库函数_9 (3, #., “开台时间”)
        0.未知支持库函数_9 (4, #., “结帐时间”)
        0.未知支持库函数_9 (5, #., “操作员”)
        0.未知支持库函数_9 (6, #., “总计”)
        0.未知支持库函数_9 (7, #., “实付”)
        0.未知支持库函数_9 (8, #., “折扣”)
        0.未知支持库函数_9 (9, #., “优惠”)
        0.未知支持库函数_9 (10, #., “流水号”)
        0.未知支持库函数_9 (11, #., “会员卡”)
        0.未知支持库函数_9 (12, #., “卡金额”)
        0.未知支持库函数_9 (13, #., “标志”)
        0.未知支持库函数_9 (14, #., “折扣率”)
        0.未知支持库函数_32 (40)
        1.未知支持库函数_32 (40)
        2.未知支持库函数_32 (40)
        3.未知支持库函数_32 (175)
        4.未知支持库函数_32 (175)
        5.未知支持库函数_32 (70)
        6.未知支持库函数_32 (50)
        7.未知支持库函数_32 (50)
        8.未知支持库函数_32 (50)
        9.未知支持库函数_32 (50)
        10.未知支持库函数_32 (110)
        13.未知支持库函数_32 (40)
        打开 (相加 (取运行目录 (), “\data\xfbb.edb”), , , , , , )
        到首记录 ()
        赋值 (., 2)
        .判断循环首 (查找 (等于 (取日期 (读 (“开台时间”)), .今天)))
            读 (“流水号”).加入项目 ()
            取项目数 ()
            赋值 (., 相加 (取项目数 (), 1))
            取项目数 ().未知支持库函数_9 (0, #., 读 (“台名”))
            取项目数 ().未知支持库函数_9 (1, #., 读 (“人数”))
            取项目数 ().未知支持库函数_9 (2, #., 读 (“消费”))
            取项目数 ().未知支持库函数_9 (3, #., 到文本 (读 (“开台时间”)))
            取项目数 ().未知支持库函数_9 (4, #., 到文本 (读 (“结帐时间”)))
            取项目数 ().未知支持库函数_9 (5, #., 读 (“操作员”))
            取项目数 ().未知支持库函数_9 (6, #., 读 (“总计”))
            取项目数 ().未知支持库函数_9 (7, #., 读 (“实付”))
            取项目数 ().未知支持库函数_9 (8, #., 读 (“折扣”))
            取项目数 ().未知支持库函数_9 (9, #., 读 (“优惠”))
            取项目数 ().未知支持库函数_9 (10, #., 读 (“流水号”))
            取项目数 ().未知支持库函数_9 (11, #., 读 (“卡号码”))
            取项目数 ().未知支持库函数_9 (12, #., 读 (“卡金额”))
            取项目数 ().未知支持库函数_9 (13, #., 读 (“标志”))
            取项目数 ().未知支持库函数_9 (14, #., 读 (“折扣率”))
            跳过 ()
        .判断循环尾 ()
        赋值 (.内容, 到文本 (求和 (到数值 (读 (“实付”)), 等于 (取日期 (读 (“结帐时间”)), .今天))))
        赋值 (.内容, 到文本 (求和 (到数值 (读 (“总计”)), 等于 (取日期 (读 (“结帐时间”)), .今天))))
        .未知支持库函数_38 ()
        相加 (取项目数 (), 1).未知支持库函数_9 (5, #., “合计：”)
        相加 (取项目数 (), 1).未知支持库函数_9 (6, #., .内容)
        相加 (取项目数 (), 1).未知支持库函数_9 (7, #., .内容)
        相加 (取项目数 (), 1).未知支持库函数_9 (9, #., 到文本 (求和 (到数值 (读 (“优惠”)), 等于 (取日期 (读 (“结帐时间”)), .今天))))
        相加 (取项目数 (), 1).未知支持库函数_9 (12, #., 到文本 (求和 (到数值 (读 (“卡金额”)), 等于 (取日期 (读 (“结帐时间”)), .今天))))
        关闭 (相加 (取运行目录 (), “\data\xfbb.edb”))
    .否则
        清空 ()
        未知支持库函数_57 ()
        0.未知支持库函数_9 (0, #., “台名”)
        0.未知支持库函数_9 (1, #., “人数”)
        0.未知支持库函数_9 (2, #., “消费”)
        0.未知支持库函数_9 (3, #., “开台时间”)
        0.未知支持库函数_9 (4, #., “结帐时间”)
        0.未知支持库函数_9 (5, #., “操作员”)
        0.未知支持库函数_9 (6, #., “总计”)
        0.未知支持库函数_9 (7, #., “实付”)
        0.未知支持库函数_9 (8, #., “折扣”)
        0.未知支持库函数_9 (9, #., “优惠”)
        0.未知支持库函数_9 (10, #., “流水号”)
        0.未知支持库函数_9 (11, #., “会员卡”)
        0.未知支持库函数_9 (12, #., “卡金额”)
        0.未知支持库函数_9 (13, #., “标志”)
        0.未知支持库函数_9 (14, #., “折扣率”)
        0.未知支持库函数_32 (40)
        1.未知支持库函数_32 (40)
        2.未知支持库函数_32 (40)
        3.未知支持库函数_32 (175)
        4.未知支持库函数_32 (175)
        5.未知支持库函数_32 (70)
        6.未知支持库函数_32 (50)
        7.未知支持库函数_32 (50)
        8.未知支持库函数_32 (50)
        9.未知支持库函数_32 (50)
        10.未知支持库函数_32 (110)
        13.未知支持库函数_32 (40)
        打开 (相加 (取运行目录 (), “\data\xfbb.edb”), , , , , , )
        到首记录 ()
        赋值 (., 2)
        .判断循环首 (查找 (并且 (等于 (取日期 (读 (“开台时间”)), .今天), 查找 (等于 (读 (“操作员”), .内容)))))
            读 (“流水号”).加入项目 ()
            取项目数 ()
            赋值 (., 相加 (取项目数 (), 1))
            取项目数 ().未知支持库函数_9 (0, #., 读 (“台名”))
            取项目数 ().未知支持库函数_9 (1, #., 读 (“人数”))
            取项目数 ().未知支持库函数_9 (2, #., 读 (“消费”))
            取项目数 ().未知支持库函数_9 (3, #., 到文本 (读 (“开台时间”)))
            取项目数 ().未知支持库函数_9 (4, #., 到文本 (读 (“结帐时间”)))
            取项目数 ().未知支持库函数_9 (5, #., 读 (“操作员”))
            取项目数 ().未知支持库函数_9 (6, #., 读 (“总计”))
            取项目数 ().未知支持库函数_9 (7, #., 读 (“实付”))
            取项目数 ().未知支持库函数_9 (8, #., 读 (“折扣”))
            取项目数 ().未知支持库函数_9 (9, #., 读 (“优惠”))
            取项目数 ().未知支持库函数_9 (10, #., 读 (“流水号”))
            取项目数 ().未知支持库函数_9 (11, #., 读 (“卡号码”))
            取项目数 ().未知支持库函数_9 (12, #., 读 (“卡金额”))
            取项目数 ().未知支持库函数_9 (13, #., 读 (“标志”))
            取项目数 ().未知支持库函数_9 (14, #., 读 (“折扣率”))
            跳过 ()
        .判断循环尾 ()
        赋值 (.内容, 到文本 (求和 (到数值 (读 (“实付”)), 并且 (等于 (取日期 (读 (“开台时间”)), .今天), 等于 (读 (“操作员”), .内容)))))
        赋值 (.内容, 到文本 (求和 (到数值 (读 (“总计”)), 并且 (等于 (取日期 (读 (“开台时间”)), .今天), 等于 (读 (“操作员”), .内容)))))
        .未知支持库函数_38 ()
        相加 (取项目数 (), 1).未知支持库函数_9 (5, #., “合计：”)
        相加 (取项目数 (), 1).未知支持库函数_9 (6, #., .内容)
        相加 (取项目数 (), 1).未知支持库函数_9 (7, #., .内容)
        相加 (取项目数 (), 1).未知支持库函数_9 (9, #., 到文本 (求和 (到数值 (读 (“优惠”)), 并且 (等于 (取日期 (读 (“开台时间”)), .今天), 等于 (读 (“操作员”), .内容)))))
        相加 (取项目数 (), 1).未知支持库函数_9 (12, #., 到文本 (求和 (到数值 (读 (“卡金额”)), 并且 (等于 (取日期 (读 (“开台时间”)), .今天), 等于 (读 (“操作员”), .内容)))))
        关闭 (相加 (取运行目录 (), “\data\xfbb.edb”))
    .如果结束
    
.如果结束
0.未知支持库函数_18 (0, 相加 (取项目数 (), 1), 14, 16)

.子程序 _高级表格1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (流水明细, 报表汇总, 假)

.子程序 _按钮2_被单击, 空白型, , 
相加 (“《销售日报表》-”, 到文本 (.今天)).未知支持库函数_46 (“宋体”, 16, 真, )
未知支持库函数_27 ()

.窗口程序集 窗口程序集18, , , 

.子程序 _结帐报表_创建完毕, 空白型, , 
.局部变量 时间值, 日期时间型, , , 

赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\xslsss.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\xfbbtem.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\skbb.edb”))
0.未知支持库函数_18 (0, 4, 1, 16)
赋值 (月份, 到文本 (取月份 (取现行时间 ())))
赋值 (日期, 到文本 (取日 (取现行时间 ())))
赋值 (小时, 到文本 (取小时 (取现行时间 ())))
赋值 (分钟, 到文本 (取分钟 (取现行时间 ())))
赋值 (秒钟, 到文本 (取秒 (取现行时间 ())))
打开 (相加 (取运行目录 (), “\data\config.edb”), , , , , , )
.如果 (大于 (到数值 (小时), 到数值 (读 (“结帐时间”))))
    赋值 (时间值, 取日期 (取现行时间 ()))
.否则
    赋值 (时间值, 取日期 (到时间 (相加 (到文本 (取年份 (取现行时间 ())), “年”, 月份, “月”, 到文本 (相减 (到数值 (日期), 1)), “日”, 小时, “时”, 分钟, “分”, 秒钟, “秒”))))
.如果结束
关闭 (相加 (取运行目录 (), “\data\config.edb”))
赋值 (.内容, 未知支持库函数_12 (时间值, “%y-%m-%d”))
打开 (相加 (取运行目录 (), “\data\xfbbtem.edb”), , , , , , )
0.未知支持库函数_25 (0, 3, 0, #.)
0.未知支持库函数_25 (1, 3, 1, #.)
1.未知支持库函数_41 (2)
0.未知支持库函数_9 (0, #., “总计金额：”)
0.未知支持库函数_9 (1, #., 相加 (到文本 (求和 (到数值 (读 (“总计”)), 等于 (取日期 (读 (“结帐时间”)), 时间值))), “元”))
1.未知支持库函数_9 (0, #., “实付金额：”)
1.未知支持库函数_9 (1, #., 相加 (到文本 (求和 (到数值 (读 (“实付”)), 等于 (取日期 (读 (“结帐时间”)), 时间值))), “元”))
2.未知支持库函数_9 (0, #., “优惠金额：”)
2.未知支持库函数_9 (1, #., 相加 (到文本 (求和 (到数值 (读 (“优惠”)), 等于 (取日期 (读 (“结帐时间”)), 时间值))), “元”))
3.未知支持库函数_9 (0, #., “会员卡额：”)
3.未知支持库函数_9 (1, #., 相加 (到文本 (求和 (到数值 (读 (“卡金额”)), 等于 (取日期 (读 (“结帐时间”)), 时间值))), “元”))
4.未知支持库函数_9 (0, #., “操作人员：”)
关闭 (相加 (取运行目录 (), “\data\xfbbtem.edb”))
打开 (相加 (取运行目录 (), “\data\user.edb”), , , , , , )
.判断循环首 (等于 (查找 (等于 (读 (“rybh”), _启动窗口..标题)), 真))
    4.未知支持库函数_9 (1, #., 读 (“ryxm”))
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\user.edb”))

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 返回值, 整数型, , , 
.局部变量 总计, 文本型, , , 
.局部变量 实结, 文本型, , , 
.局部变量 优惠, 文本型, , , 
.局部变量 卡额, 文本型, , , 

赋值 (月份, 到文本 (取月份 (取现行时间 ())))
赋值 (日期, 到文本 (取日 (取现行时间 ())))
赋值 (小时, 到文本 (取小时 (取现行时间 ())))
赋值 (分钟, 到文本 (取分钟 (取现行时间 ())))
赋值 (秒钟, 到文本 (取秒 (取现行时间 ())))
打开 (相加 (取运行目录 (), “\data\xfbbtem.edb”), , , , , , )
到首记录 ()
赋值 (总计, 到文本 (求和 (到数值 (读 (“总计”)), 小于或等于 (取日期 (读 (“结帐时间”)), 取日期 (取现行时间 ())))))
赋值 (实结, 到文本 (求和 (到数值 (读 (“实付”)), 小于或等于 (取日期 (读 (“结帐时间”)), 取日期 (取现行时间 ())))))
赋值 (优惠, 到文本 (求和 (到数值 (读 (“优惠”)), 小于或等于 (取日期 (读 (“结帐时间”)), 取日期 (取现行时间 ())))))
赋值 (卡额, 到文本 (求和 (到数值 (读 (“卡金额”)), 小于或等于 (取日期 (读 (“结帐时间”)), 取日期 (取现行时间 ())))))
关闭 (相加 (取运行目录 (), “\data\xfbbtem.edb”))
赋值 (返回值, 信息框 (“是否进行结帐报表吗？”, 4, ))
.如果真 (等于 (返回值, #是钮))
    打开 (相加 (取运行目录 (), “\data\config.edb”), , , , , , )
    .如果 (大于或等于 (到数值 (小时), 到数值 (读 (“结帐时间”))))
        到尾记录 ()
        相加 (取记录号 (), 1).插入行 ()
        到尾记录 ()
        取记录号 ().置文本 (1, _启动窗口..标题)
        取记录号 ().置文本 (2, 人员姓名)
        取记录号 ().置文本 (3, 总计)
        取记录号 ().置文本 (4, 实结)
        取记录号 ().置文本 (5, 优惠)
        取记录号 ().置文本 (6, 卡额)
        取记录号 ().置文本 (7, 相加 (到文本 (相加 (到文本 (取年份 (取现行时间 ())), “年”, 到文本 (到数值 (月份)), “月”, 到文本 (日期), “日”)), 到文本 (小时), “时”, 到文本 (分钟), “分”, 到文本 (秒钟), “秒”))
    .否则
        到尾记录 ()
        相加 (取记录号 (), 1).插入行 ()
        到尾记录 ()
        取记录号 ().置文本 (1, _启动窗口..标题)
        取记录号 ().置文本 (2, 人员姓名)
        取记录号 ().置文本 (3, 总计)
        取记录号 ().置文本 (4, 实结)
        取记录号 ().置文本 (5, 优惠)
        取记录号 ().置文本 (6, 卡额)
        取记录号 ().置文本 (7, 相加 (到文本 (相加 (到文本 (取年份 (取现行时间 ())), “年”, 到文本 (月份), “月”, 到文本 (相减 (到数值 (日期), 1)), “日”)), 到文本 (小时), “时”, 到文本 (分钟), “分”, 到文本 (秒钟), “秒”))
    .如果结束
    假.开始打印 (假, “58mm roll paper”, , .打印区宽度, 相减 (.打印区高度, 200))
    赋值 (.字体.字体大小, 10)
    相加 (“        ”, “收款员结帐报表”, #换行符, “         ”, 到文本 (取日期 (取现行时间 ())), #换行符, “  ”, “~~~~~~~~~~~~~~~~~~~~~~~~~~~”, #换行符).写出 ()
    相加 (“总计金额：”, “      ”, 总计, “元”, #换行符, “实结金额：”, “      ”, 实结, “元”, #换行符, “优惠金额：”, “      ”, 优惠, “元”, #换行符, “会员卡额：”, “      ”, 卡额, “元”, #换行符, “操作员：”, “      ”, 人员姓名).写出 ()
    关闭 (相加 (取运行目录 (), “\data\config.edb”))
     ' 高级表格1.打印到打印机 (打印机1)
    结束打印 ()
    1.删除行 (取行数 ())
    1.删除行 (取行数 ())
    .如果 (等于 (取行数 (), 0))
        信息框 (“结帐报表成功！！！”, 0, “提示！”)
    .否则
        
    .如果结束
    
.如果真结束


.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.局部变量 返回值, 整数型, , , 

 ' ' 编辑框1.内容 ＝ 格式化日期 (到时间 (编辑框1.内容), “%y-%m-%d”)
 ' .如果真 (等于 (字符代码, #回车键))
     ' 编辑框1.内容 ＝ 格式化日期 (到时间 (编辑框1.内容), “%y-%m-%d”)
     ' 高级表格1.置字体尺寸 (0, 0, 3, 1, 16)
     ' 打开 (取运行目录 () ＋ “\data\xfbbtem.edb”, , , , , , )
     ' 高级表格1.置对齐方式 (0, 0, 3, 0, #表格常量.居中对齐)
     ' 高级表格1.置对齐方式 (0, 1, 3, 1, #表格常量.右对齐)
     ' 高级表格1.置单元格小数位数 (1, 2)
     ' 高级表格1.置数据 (0, 0, #表格常量.文本型, “总计金额：”)
     ' 高级表格1.置数据 (0, 1, #表格常量.文本型, 到文本 (求和 (到数值 (读 (“总计”)), 格式化日期 (读 (“结帐时间”), “%y-%m-%d”) ＝ 编辑框1.内容)) ＋ “元”)
     ' 高级表格1.置数据 (1, 0, #表格常量.文本型, “实付金额：”)
     ' 高级表格1.置数据 (1, 1, #表格常量.文本型, 到文本 (求和 (到数值 (读 (“实付”)), 格式化日期 (读 (“结帐时间”), “%y-%m-%d”) ＝ 编辑框1.内容)) ＋ “元”)
     ' 高级表格1.置数据 (2, 0, #表格常量.文本型, “优惠金额：”)
     ' 高级表格1.置数据 (2, 1, #表格常量.文本型, 到文本 (求和 (到数值 (读 (“优惠”)), 格式化日期 (读 (“结帐时间间”), “%y-%m-%d”) ＝ 编辑框1.内容)) ＋ “元”)
     ' 高级表格1.置数据 (3, 0, #表格常量.文本型, “会员卡额：”)
     ' 高级表格1.置数据 (3, 1, #表格常量.文本型, 到文本 (求和 (到数值 (读 (“卡金额”)), 取日期 (读 (“结帐时间”)) ＝ 取日期 (取现行时间 ()))) ＋ “元”)
     ' 高级表格1.置数据 (4, 0, #表格常量.文本型, “操作人员：”)
     ' 关闭 (取运行目录 () ＋ “\data\xfbbtem.edb”)
     ' 打开 (取运行目录 () ＋ “\data\user.edb”, , , , , , )
     ' .判断循环首 (等于 (查找 (等于 (读 (“rybh”), _启动窗口..标题)), 真))
         ' 高级表格1.置数据 (4, 1, #表格常量.文本型, 读 (“ryxm”))
         ' 跳过 ()
     ' .判断循环尾 ()
     ' 关闭 (取运行目录 () ＋ “\data\user.edb”)
.如果真结束


.子程序 _编辑框1_获得焦点, 空白型, , 
 ' 编辑框1.内容 ＝ “”

.窗口程序集 窗口程序集19, , , 

.子程序 _系统选项_创建完毕, 空白型, , 
.局部变量 是否打印, 文本型, , , 
.局部变量 显示背景, 文本型, , , 

赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\config.edb”))
打开 (相加 (取运行目录 (), “\data\config.edb”), , , , , , )
到首记录 ()
赋值 (.内容, 读 (“单位信息”))
赋值 (.内容, 读 (“电话号码”))
赋值 (.内容, 读 (“背景图”))
赋值 (.内容, 读 (“结帐时间”))
赋值 (.内容, 到文本 (读 (“小数金额”)))
.如果 (等于 (读 (“是否打印”), “是”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束
.如果 (等于 (读 (“显示背景”), “是”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束
关闭 (相加 (取运行目录 (), “\data\config.edb”))

.子程序 _按钮1_被单击, 空白型, , 
赋值 (.过滤器, “图片文件(所有支持的类型)|*.jpg;*.bmp;*.gif”)
.如果真 (等于 (打开 (), 假))
    返回 ()
.如果真结束
.如果真 (文件是否存在 (.文件名))
    赋值 (.内容, .文件名)
.如果真结束


.子程序 _按钮2_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    1.置文本 (6, “是”)
.否则
    .如果 (等于 (.选中, 假))
        1.置文本 (6, “否”)
    .否则
        
    .如果结束
    
.如果结束
.如果 (等于 (.选中, 真))
    1.置文本 (7, “是”)
.否则
    .如果 (等于 (.选中, 假))
        1.置文本 (7, “否”)
    .否则
        
    .如果结束
    
.如果结束
取记录号 ().置文本 (1, .内容)
取记录号 ().置文本 (2, .内容)
取记录号 ().置文本 (8, .内容)
取记录号 ().置文本 (9, .内容)
取记录号 ().置文本 (10, .内容)
赋值 (_启动窗口..图片, 读入文件 (.内容))
赋值 (.只读, 真)
赋值 (.允许添加, 假)
赋值 (.允许删除, 假)

.窗口程序集 窗口程序集20, , , 

.子程序 _时间显示_创建完毕, 空白型, , 
赋值 (.时钟周期, 1000)

.子程序 _时钟1_周期事件, 空白型, , 
赋值 (.标题, 相加 (未知支持库函数_12 (取现行时间 (), “%y-%m-%d”), “ ”, 到文本 (取小时 (取现行时间 ())), “:”, 到文本 (取分钟 (取现行时间 ())), “:”, 到文本 (取秒 (取现行时间 ()))))

.窗口程序集 窗口程序集21, , , 

.子程序 _权限设置_创建完毕, 空白型, , 
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\userqx.edb”))
0.未知支持库函数_9 (0, #., “人员编号”)
0.未知支持库函数_9 (1, #., “人员姓名”)
打开 (相加 (取运行目录 (), “\data\userqx.edb”), , , , , , )
到首记录 ()
赋值 (., 相加 (取行数 (), 1))
.计次循环首 (取行数 (), 计次变量)
    计次变量.未知支持库函数_9 (0, #., 读 (“人员编号”))
    计次变量.未知支持库函数_9 (1, #., 读 (“人员姓名”))
    跳过 ()
.计次循环尾 ()
关闭 (相加 (取运行目录 (), “\data\userqx.edb.edb”))


.子程序 _高级表格1_被单击, 空白型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 

打开 (相加 (取运行目录 (), “\data\userqx.edb”), , , , , , )
到首记录 ()
.判断循环首 (查找 (等于 (读 (“人员编号”), 未知支持库函数_3 ().未知支持库函数_10 (0))))
    赋值 (.内容, 未知支持库函数_3 ().未知支持库函数_10 (0))
    .如果 (等于 (读 (“商品信息”), “真”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    .如果 (等于 (读 (“包台信息”), “真”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    .如果 (等于 (读 (“会员设置”), “真”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    .如果 (等于 (读 (“入库管理”), “真”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    .如果 (等于 (读 (“出库管理”), “真”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    .如果 (等于 (读 (“库存查询”), “真”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    .如果 (等于 (读 (“库存盘点”), “真”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    .如果 (等于 (读 (“销售报表”), “真”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    .如果 (等于 (读 (“销售明细”), “真”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    .如果 (等于 (读 (“人员管理”), “真”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    .如果 (等于 (读 (“数据管理”), “真”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    .如果 (等于 (读 (“系统参数”), “真”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    .如果 (等于 (读 (“权限设置”), “真”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    .如果 (等于 (读 (“密码修改”), “真”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\userqx.edb”))


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 i, 整数型, , , 

打开 (相加 (取运行目录 (), “\data\userqx.edb”), , , , , , )
到首记录 ()
.判断循环首 (等于 (查找 (等于 (读 (“人员编号”), .内容)), 真))
    .如果 (等于 (.选中, 真))
        未知支持库函数_3 ().置文本 (3, “真”)
    .否则
        未知支持库函数_3 ().置文本 (3, “假”)
    .如果结束
    .如果 (等于 (.选中, 真))
        未知支持库函数_3 ().置文本 (4, “真”)
    .否则
        未知支持库函数_3 ().置文本 (4, “假”)
    .如果结束
    .如果 (等于 (.选中, 真))
        未知支持库函数_3 ().置文本 (5, “真”)
    .否则
        未知支持库函数_3 ().置文本 (5, “假”)
    .如果结束
    .如果 (等于 (.选中, 真))
        未知支持库函数_3 ().置文本 (6, “真”)
    .否则
        未知支持库函数_3 ().置文本 (6, “假”)
    .如果结束
    .如果 (等于 (.选中, 真))
        未知支持库函数_3 ().置文本 (7, “真”)
    .否则
        未知支持库函数_3 ().置文本 (7, “假”)
    .如果结束
    .如果 (等于 (.选中, 真))
        未知支持库函数_3 ().置文本 (8, “真”)
    .否则
        未知支持库函数_3 ().置文本 (8, “假”)
    .如果结束
    .如果 (等于 (.选中, 真))
        未知支持库函数_3 ().置文本 (9, “真”)
    .否则
        未知支持库函数_3 ().置文本 (9, “假”)
    .如果结束
    .如果 (等于 (.选中, 真))
        未知支持库函数_3 ().置文本 (10, “真”)
    .否则
        未知支持库函数_3 ().置文本 (10, “假”)
    .如果结束
    .如果 (等于 (.选中, 真))
        未知支持库函数_3 ().置文本 (11, “真”)
    .否则
        未知支持库函数_3 ().置文本 (11, “假”)
    .如果结束
    .如果 (等于 (.选中, 真))
        未知支持库函数_3 ().置文本 (12, “真”)
    .否则
        未知支持库函数_3 ().置文本 (12, “假”)
    .如果结束
    .如果 (等于 (.选中, 真))
        未知支持库函数_3 ().置文本 (13, “真”)
    .否则
        未知支持库函数_3 ().置文本 (13, “假”)
    .如果结束
    .如果 (等于 (.选中, 真))
        未知支持库函数_3 ().置文本 (14, “真”)
    .否则
        未知支持库函数_3 ().置文本 (14, “假”)
    .如果结束
    .如果 (等于 (.选中, 真))
        未知支持库函数_3 ().置文本 (15, “真”)
    .否则
        未知支持库函数_3 ().置文本 (15, “假”)
    .如果结束
    .如果 (等于 (.选中, 真))
        未知支持库函数_3 ().置文本 (16, “真”)
    .否则
        未知支持库函数_3 ().置文本 (16, “假”)
    .如果结束
    跳过 ()
.判断循环尾 ()
.如果 (等于 (i, 0))
    信息框 (“保存成功”, 0, )
.否则
    信息框 (“存盘失败”, 0, )
.如果结束
打开 (相加 (取运行目录 (), “\data\userqx.edb”), , , , , , )

.窗口程序集 窗口程序集22, , , 

.子程序 _密码修改_创建完毕, 空白型, , 
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\user.edb”))
赋值 (.标题, _启动窗口..标题)
获取焦点 ()


.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框3_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

打开 (相加 (取运行目录 (), “\data\user.edb”), , , , , , )
到首记录 ()
.判断循环首 (等于 (查找 (等于 (读 (“rybh”), .标题)), 真))
    取记录号 ().跳到 ()
    .如果 (并且 (等于 (字符代码, #回车键), 不等于 (.内容, 取记录号 ().取文本 (4))))
        信息框 (“旧密码错误，请重新输入！”, 0, )
        赋值 (.内容, “”)
        获取焦点 ()
    .否则
        .如果 (并且 (等于 (字符代码, #回车键), 不等于 (.内容, .内容)))
            信息框 (“校验新密码错误，请重新输入！”, 0, )
            获取焦点 ()
            赋值 (.内容, “”)
            赋值 (.内容, “”)
        .否则
            .如果真 (等于 (字符代码, #回车键))
                获取焦点 ()
            .如果真结束
            
        .如果结束
        
    .如果结束
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\user.edb”))

.子程序 _按钮1_被单击, 空白型, , 
打开 (相加 (取运行目录 (), “\data\user.edb”), , , , , , )
到首记录 ()
.判断循环首 (等于 (查找 (等于 (读 (“rybh”), .标题)), 真))
    取记录号 ().跳到 ()
    取记录号 ().置文本 (4, .内容)
    .如果 (并且 (等于 (读 (“rymm”), .内容), 不等于 (.内容, “”)))
        信息框 (“密码修改成功！！！”, 0, )
    .否则
        信息框 (“密码修改失败！！！”, 0, )
    .如果结束
    跳过 ()
.判断循环尾 ()
密码修改.销毁 ()
关闭 (相加 (取运行目录 (), “\data\user.edb”))


.窗口程序集 窗口程序集23, , , 

.子程序 _按钮1_被单击, 空白型, , 
.如果 (不等于 (.内容, “”))
     ' ZIP压缩.压缩 (取运行目录 () ＋ “\data”, 目标文件名编辑框1.内容)
    .如果 (等于 (相加 (取运行目录 (), “\data”).未知支持库函数_0 (.内容), 1))
        信息框 (“备份成功”, 0, )
    .否则
        信息框 (“备份失败”, 0, )
        
    .如果结束
    赋值 (.内容, “”)
.否则
    
.如果结束
.如果 (不等于 (.内容, “”))
     ' 删除文件 (取运行目录 () ＋ “\data\*.*”)
     ' ZIP压缩.解压 (目标文件名编辑框2.内容, 取运行目录 ())
    .如果 (等于 (.未知支持库函数_2 (.内容, 相加 (取运行目录 (), “\data”)), 1))
        信息框 (“恢复成功”, 0, )
    .否则
        信息框 (“恢复失败”, 0, )
    .如果结束
    赋值 (.内容, “”)
.否则
    
.如果结束


.子程序 _打开文件名_被单击, 空白型, , 
.局部变量 打开文件名, 文本型, , , 

赋值 (.类型, 0)
.如果 (等于 (.内容, “”)) ' 判断是压缩还是解压缩
    .如果真 (等于 (打开 (), 真))
        赋值 (.内容, .文件名)
    .如果真结束
    
.否则
    
.如果结束


.子程序 _保存按钮_被单击, 空白型, , 
赋值 (.类型, 1)
.如果 (等于 (.内容, “”)) ' 判断是压缩还是解压缩
    .如果真 (等于 (打开 (), 真))
        赋值 (.内容, 相加 (.文件名, “.zip”))
    .如果真结束
    
.否则
    
.如果结束


.窗口程序集 窗口程序集24, , , 

.子程序 _系统初始化_创建完毕, 空白型, , 
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\splb.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\skbb.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\spzl.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\fjzl.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\hykk.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\spkc.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\jhdk.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\fcdk.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\xfbb.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\xsls.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\xslsss.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\user.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\userqx.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\hykmx.edb”))

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 返回值, 整数型, , , 

赋值 (返回值, 信息框 (“真的要进行初始化吗？”, 4, ))
.如果真 (等于 (返回值, #是钮))
    1.删除行 (取行数 ())
    1.删除行 (取行数 ())
    1.删除行 (取行数 ())
    1.删除行 (取行数 ())
    1.删除行 (取行数 ())
    1.删除行 (取行数 ())
    1.删除行 (取行数 ())
    1.删除行 (取行数 ())
    1.删除行 (取行数 ())
    1.删除行 (取行数 ())
    1.删除行 (取行数 ())
    1.删除行 (取行数 ())
    1.删除行 (取行数 ())
    1.删除行 (取行数 ())
    1.插入行 (1)
    1.置文本 (1, “0000”)
    1.置文本 (2, “超级管理”)
    1.置文本 (3, “系统管理”)
    1.置文本 (4, “8888”)
    1.插入行 (1)
    1.置文本 (1, “0000”)
    1.置文本 (2, “系统管理”)
    1.置文本 (3, “真”)
    1.置文本 (4, “真”)
    1.置文本 (5, “真”)
    1.置文本 (6, “真”)
    1.置文本 (7, “真”)
    1.置文本 (8, “真”)
    1.置文本 (9, “真”)
    1.置文本 (10, “真”)
    1.置文本 (11, “真”)
    1.置文本 (12, “真”)
    1.置文本 (13, “真”)
    1.置文本 (14, “真”)
    1.置文本 (15, “真”)
    1.置文本 (16, “真”)
    .如果 (等于 (等于 (1.取文本 (16), “真”), 真))
        信息框 (“系统初始化完成！”, 0, )
    .否则
        信息框 (“系统初始化失败！”, 0, )
    .如果结束
    
.如果真结束






.窗口程序集 窗口程序集25, , , 

.子程序 _会员卡明细_创建完毕, 空白型, , 
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\hykmx.edb”))
0.未知支持库函数_9 (0, #., “会员卡号”)
0.未知支持库函数_9 (1, #., “卡种类别”)
0.未知支持库函数_9 (2, #., “消费金额”)
0.未知支持库函数_9 (3, #., “卡内余额”)
0.未知支持库函数_9 (4, #., “消费日期”)
0.未知支持库函数_9 (5, #., “流水单号”)
0.未知支持库函数_9 (6, #., “备注”)
1.未知支持库函数_32 (75)
2.未知支持库函数_32 (75)
3.未知支持库函数_32 (80)
4.未知支持库函数_32 (150)
5.未知支持库函数_32 (82)
6.未知支持库函数_32 (70)
获取焦点 ()
打开 (相加 (取运行目录 (), “\data\hykmx.edb”), , , , , , )
到首记录 ()
赋值 (., 相加 (取行数 (), 1))
.判断循环首 (等于 (查找 (大于 (读 (“会员卡号”), 0)), 真))
    到文本 (读 (“会员卡号”)).加入项目 ()
    取项目数 ().未知支持库函数_9 (0, #., 读 (“会员卡号”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“卡种类别”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“消费金额”))
    取项目数 ().未知支持库函数_9 (3, #., 读 (“卡内余额”))
    取项目数 ().未知支持库函数_9 (4, #., 到文本 (读 (“消费日期”)))
    取项目数 ().未知支持库函数_9 (5, #., 读 (“流水单号”))
    取项目数 ().未知支持库函数_9 (6, #., 读 (“备注”))
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\hykmx.edb”))


.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    0.未知支持库函数_9 (0, #., “会员卡号”)
    0.未知支持库函数_9 (1, #., “卡种类别”)
    0.未知支持库函数_9 (2, #., “消费金额”)
    0.未知支持库函数_9 (3, #., “卡内余额”)
    0.未知支持库函数_9 (4, #., “消费日期”)
    0.未知支持库函数_9 (5, #., “流水单号”)
    0.未知支持库函数_9 (6, #., “备注”)
    1.未知支持库函数_32 (75)
    2.未知支持库函数_32 (75)
    3.未知支持库函数_32 (80)
    4.未知支持库函数_32 (150)
    5.未知支持库函数_32 (82)
    6.未知支持库函数_32 (70)
    获取焦点 ()
    打开 (相加 (取运行目录 (), “\data\hykmx.edb”), , , , , , )
    到首记录 ()
    .如果真 (等于 (字符代码, #回车键))
        .如果 (等于 (查找 (等于 (读 (“会员卡号”), 到数值 (.内容))), 假))
            信息框 (“卡号错误或无此记录!”, 0, )
            赋值 (.内容, “”)
            赋值 (.内容, “”)
            获取焦点 ()
        .否则
            .判断循环首 (等于 (查找 (等于 (读 (“会员卡号”), 到数值 (.内容))), 真))
                赋值 (., 相加 (取行数 (), 1))
                .判断循环首 (等于 (查找 (大于 (读 (“会员卡号”), 0)), 真))
                    到文本 (读 (“会员卡号”)).加入项目 ()
                    取项目数 ().未知支持库函数_9 (0, #., 读 (“会员卡号”))
                    取项目数 ().未知支持库函数_9 (1, #., 读 (“卡种类别”))
                    取项目数 ().未知支持库函数_9 (2, #., 读 (“消费金额”))
                    取项目数 ().未知支持库函数_9 (3, #., 读 (“卡内余额”))
                    取项目数 ().未知支持库函数_9 (4, #., 到文本 (读 (“消费日期”)))
                    取项目数 ().未知支持库函数_9 (5, #., 读 (“流水单号”))
                    取项目数 ().未知支持库函数_9 (6, #., 读 (“备注”))
                    跳过 ()
                .判断循环尾 ()
                赋值 (.内容, “”)
                赋值 (.内容, 到文本 (求和 (读 (“消费金额”), 并且 (等于 (读 (“会员卡号”), 到数值 (.内容)), 等于 (读 (“备注”), “销费”)))))
                赋值 (.内容, 到文本 (求和 (读 (“卡内余额”), 并且 (等于 (读 (“会员卡号”), 到数值 (.内容)), 等于 (读 (“备注”), “销费”)))))
                跳过 ()
            .判断循环尾 ()
            赋值 (.内容, “”)
        .如果结束
        
    .如果真结束
    关闭 (相加 (取运行目录 (), “\data\hykmx.edb”))
.如果真结束


.子程序 _按钮1_被单击, 空白型, , 
“《会员消费报表》-”.未知支持库函数_46 (“宋体”, 25, 真, )
未知支持库函数_27 ()

.窗口程序集 窗口程序集26, , , 

.子程序 _进货单查询_创建完毕, 空白型, , 
0.未知支持库函数_9 (0, #., “进货单号”)
0.未知支持库函数_9 (1, #., “商品编码”)
0.未知支持库函数_9 (2, #., “商品名称”)
0.未知支持库函数_9 (3, #., “单位”)
0.未知支持库函数_9 (4, #., “进货数量”)
0.未知支持库函数_9 (5, #., “进价”)
0.未知支持库函数_9 (6, #., “总计”)
0.未知支持库函数_9 (7, #., “供货商”)
0.未知支持库函数_32 (90)
2.未知支持库函数_32 (130)
3.未知支持库函数_32 (45)
4.未知支持库函数_32 (65)
5.未知支持库函数_32 (65)
6.未知支持库函数_32 (65)
打开 (相加 (取运行目录 (), “\data\jhdk.edb”), , , , , , )
到首记录 ()
赋值 (., 2)
.判断循环首 (等于 (查找 (不等于 (到文本 (读 (“进货单号”)), “”)), 真))
    到文本 (读 (“进货单号”)).加入项目 ()
    取项目数 ()
    赋值 (., 相加 (取项目数 (), 1))
    取项目数 ().未知支持库函数_9 (0, #., 读 (“进货单号”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“商品编码”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“商品名称”))
    取项目数 ().未知支持库函数_9 (3, #., 到文本 (读 (“单位”)))
    取项目数 ().未知支持库函数_9 (4, #., 到文本 (读 (“进货数量”)))
    取项目数 ().未知支持库函数_9 (5, #., 读 (“进价”))
    取项目数 ().未知支持库函数_9 (6, #., 读 (“总计”))
    取项目数 ().未知支持库函数_9 (7, #., 读 (“供货商”))
    跳过 ()
.判断循环尾 ()
赋值 (.内容, 到文本 (求和 (到数值 (读 (“进货数量”)), 不等于 (到文本 (读 (“进货单号”)), “”))))
赋值 (.内容, 到文本 (求和 (到数值 (读 (“总计”)), 不等于 (到文本 (读 (“进货单号”)), “”))))
关闭 (相加 (取运行目录 (), “\data\jhdk.edb”))
获取焦点 ()
0.未知支持库函数_18 (0, 相加 (取项目数 (), 1), 14, 16)

.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    未知支持库函数_57 ()
    清空 ()
    0.未知支持库函数_9 (0, #., “进货单号”)
    0.未知支持库函数_9 (1, #., “商品编码”)
    0.未知支持库函数_9 (2, #., “商品名称”)
    0.未知支持库函数_9 (3, #., “单位”)
    0.未知支持库函数_9 (4, #., “进货数量”)
    0.未知支持库函数_9 (5, #., “进价”)
    0.未知支持库函数_9 (6, #., “总计”)
    0.未知支持库函数_9 (7, #., “供货商”)
    0.未知支持库函数_32 (90)
    2.未知支持库函数_32 (130)
    3.未知支持库函数_32 (45)
    4.未知支持库函数_32 (65)
    5.未知支持库函数_32 (65)
    6.未知支持库函数_32 (65)
    打开 (相加 (取运行目录 (), “\data\jhdk.edb”), , , , , , )
    到首记录 ()
    赋值 (., 2)
    .判断循环首 (查找 (等于 (到文本 (读 (“进货单号”)), .内容)))
        到文本 (读 (“进货单号”)).加入项目 ()
        取项目数 ()
        赋值 (., 相加 (取项目数 (), 1))
        取项目数 ().未知支持库函数_9 (0, #., 读 (“进货单号”))
        取项目数 ().未知支持库函数_9 (1, #., 读 (“商品编码”))
        取项目数 ().未知支持库函数_9 (2, #., 读 (“商品名称”))
        取项目数 ().未知支持库函数_9 (3, #., 到文本 (读 (“单位”)))
        取项目数 ().未知支持库函数_9 (4, #., 到文本 (读 (“进货数量”)))
        取项目数 ().未知支持库函数_9 (5, #., 读 (“进价”))
        取项目数 ().未知支持库函数_9 (6, #., 读 (“总计”))
        取项目数 ().未知支持库函数_9 (7, #., 读 (“供货商”))
        跳过 ()
    .判断循环尾 ()
    赋值 (.内容, 到文本 (求和 (到数值 (读 (“进货数量”)), 等于 (到文本 (读 (“进货单号”)), .内容))))
    赋值 (.内容, 到文本 (求和 (到数值 (读 (“总计”)), 等于 (到文本 (读 (“进货单号”)), .内容))))
    赋值 (.内容, “”)
    关闭 (相加 (取运行目录 (), “\data\jhdk.edb”))
.如果真结束
0.未知支持库函数_18 (0, 相加 (取项目数 (), 1), 14, 16)

.子程序 _编辑框2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    未知支持库函数_57 ()
    清空 ()
    0.未知支持库函数_9 (0, #., “进货单号”)
    0.未知支持库函数_9 (1, #., “商品编码”)
    0.未知支持库函数_9 (2, #., “商品名称”)
    0.未知支持库函数_9 (3, #., “单位”)
    0.未知支持库函数_9 (4, #., “进货数量”)
    0.未知支持库函数_9 (5, #., “进价”)
    0.未知支持库函数_9 (6, #., “总计”)
    0.未知支持库函数_9 (7, #., “供货商”)
    0.未知支持库函数_32 (90)
    2.未知支持库函数_32 (130)
    3.未知支持库函数_32 (45)
    4.未知支持库函数_32 (65)
    5.未知支持库函数_32 (65)
    6.未知支持库函数_32 (65)
    打开 (相加 (取运行目录 (), “\data\jhdk.edb”), , , , , , )
    到首记录 ()
    赋值 (., 2)
    .判断循环首 (查找 (等于 (读 (“商品编码”), 到数值 (.内容))))
        读 (“商品名称”).加入项目 ()
        取项目数 ()
        赋值 (., 相加 (取项目数 (), 1))
        取项目数 ().未知支持库函数_9 (0, #., 读 (“进货单号”))
        取项目数 ().未知支持库函数_9 (1, #., 读 (“商品编码”))
        取项目数 ().未知支持库函数_9 (2, #., 读 (“商品名称”))
        取项目数 ().未知支持库函数_9 (3, #., 到文本 (读 (“单位”)))
        取项目数 ().未知支持库函数_9 (4, #., 到文本 (读 (“进货数量”)))
        取项目数 ().未知支持库函数_9 (5, #., 读 (“进价”))
        取项目数 ().未知支持库函数_9 (6, #., 读 (“总计”))
        取项目数 ().未知支持库函数_9 (7, #., 读 (“供货商”))
        跳过 ()
    .判断循环尾 ()
    赋值 (.内容, 到文本 (求和 (到数值 (读 (“进货数量”)), 等于 (读 (“商品编码”), 到数值 (.内容)))))
    赋值 (.内容, 到文本 (求和 (到数值 (读 (“总计”)), 等于 (读 (“商品编码”), 到数值 (.内容)))))
    赋值 (.内容, “”)
.如果真结束
0.未知支持库函数_18 (0, 相加 (取项目数 (), 1), 14, 16)

.子程序 _按钮1_被单击, 空白型, , 
“《进货单报表》-”.未知支持库函数_46 (“宋体”, 16, 真, )
未知支持库函数_27 ()

.窗口程序集 窗口程序集27, , , 

.子程序 _返厂单查询_创建完毕, 空白型, , 
0.未知支持库函数_9 (0, #., “出库单号”)
0.未知支持库函数_9 (1, #., “商品编号”)
0.未知支持库函数_9 (2, #., “商品名称”)
0.未知支持库函数_9 (3, #., “单位”)
0.未知支持库函数_9 (4, #., “出库数量”)
0.未知支持库函数_9 (5, #., “总价”)
0.未知支持库函数_9 (6, #., “出库日期”)
 ' 高级表格1.置数据 (0, 7, #表格常量.文本型, “供货商”)
0.未知支持库函数_32 (90)
2.未知支持库函数_32 (130)
3.未知支持库函数_32 (45)
4.未知支持库函数_32 (65)
5.未知支持库函数_32 (65)
6.未知支持库函数_32 (130)
打开 (相加 (取运行目录 (), “\data\fcdk.edb”), , , , , , )
到首记录 ()
赋值 (., 2)
.判断循环首 (查找 (不等于 (到文本 (读 (“出库单号”)), “”)))
    到文本 (读 (“出库单号”)).加入项目 ()
    取项目数 ()
    赋值 (., 相加 (取项目数 (), 1))
    取项目数 ().未知支持库函数_9 (0, #., 读 (“出库单号”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“商品编号”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“商品名称”))
    取项目数 ().未知支持库函数_9 (3, #., 到文本 (读 (“单位”)))
    取项目数 ().未知支持库函数_9 (4, #., 到文本 (读 (“出库数量”)))
    取项目数 ().未知支持库函数_9 (5, #., 读 (“进价”))
    取项目数 ().未知支持库函数_9 (6, #., 到文本 (读 (“出库日期”)))
    跳过 ()
.判断循环尾 ()
0.未知支持库函数_18 (0, 相加 (取项目数 (), 1), 6, 14)
赋值 (.内容, 到文本 (求和 (到数值 (读 (“出库数量”)), 不等于 (到文本 (读 (“出库单号”)), “”))))
赋值 (.内容, 到文本 (求和 (到数值 (读 (“进价”)), 不等于 (到文本 (读 (“出库单号”)), “”))))
关闭 (相加 (取运行目录 (), “\data\fcdk.edb”))
获取焦点 ()

.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    未知支持库函数_57 ()
    清空 ()
    0.未知支持库函数_9 (0, #., “出库单号”)
    0.未知支持库函数_9 (1, #., “商品编号”)
    0.未知支持库函数_9 (2, #., “商品名称”)
    0.未知支持库函数_9 (3, #., “单位”)
    0.未知支持库函数_9 (4, #., “出库数量”)
    0.未知支持库函数_9 (5, #., “总价”)
    0.未知支持库函数_9 (6, #., “出库日期”)
    0.未知支持库函数_32 (90)
    2.未知支持库函数_32 (130)
    3.未知支持库函数_32 (45)
    4.未知支持库函数_32 (65)
    5.未知支持库函数_32 (65)
    6.未知支持库函数_32 (130)
    打开 (相加 (取运行目录 (), “\data\fcdk.edb”), , , , , , )
    到首记录 ()
    赋值 (., 2)
    .判断循环首 (查找 (等于 (到文本 (读 (“出库单号”)), .内容)))
        到文本 (读 (“出库单号”)).加入项目 ()
        取项目数 ()
        赋值 (., 相加 (取项目数 (), 1))
        取项目数 ().未知支持库函数_9 (0, #., 读 (“出库单号”))
        取项目数 ().未知支持库函数_9 (1, #., 读 (“商品编号”))
        取项目数 ().未知支持库函数_9 (2, #., 读 (“商品名称”))
        取项目数 ().未知支持库函数_9 (3, #., 到文本 (读 (“单位”)))
        取项目数 ().未知支持库函数_9 (4, #., 到文本 (读 (“出库数量”)))
        取项目数 ().未知支持库函数_9 (5, #., 读 (“进价”))
        取项目数 ().未知支持库函数_9 (6, #., 到文本 (读 (“出库日期”)))
        跳过 ()
    .判断循环尾 ()
    赋值 (.内容, 到文本 (求和 (到数值 (读 (“出库数量”)), 等于 (到文本 (读 (“出库单号”)), .内容))))
    赋值 (.内容, 到文本 (求和 (到数值 (读 (“进价”)), 等于 (到文本 (读 (“出库单号”)), .内容))))
    关闭 (相加 (取运行目录 (), “\data\fcdk.edb”))
    赋值 (.内容, “”)
.如果真结束


.子程序 _编辑框2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    未知支持库函数_57 ()
    清空 ()
    0.未知支持库函数_9 (0, #., “出库单号”)
    0.未知支持库函数_9 (1, #., “商品编号”)
    0.未知支持库函数_9 (2, #., “商品名称”)
    0.未知支持库函数_9 (3, #., “单位”)
    0.未知支持库函数_9 (4, #., “出库数量”)
    0.未知支持库函数_9 (5, #., “总价”)
    0.未知支持库函数_9 (6, #., “出库日期”)
    0.未知支持库函数_32 (90)
    2.未知支持库函数_32 (130)
    3.未知支持库函数_32 (45)
    4.未知支持库函数_32 (65)
    5.未知支持库函数_32 (65)
    6.未知支持库函数_32 (130)
    打开 (相加 (取运行目录 (), “\data\fcdk.edb”), , , , , , )
    到首记录 ()
    赋值 (., 2)
    .判断循环首 (查找 (等于 (读 (“商品编号”), 到数值 (.内容))))
        读 (“商品名称”).加入项目 ()
        取项目数 ()
        赋值 (., 相加 (取项目数 (), 1))
        取项目数 ().未知支持库函数_9 (0, #., 读 (“出库单号”))
        取项目数 ().未知支持库函数_9 (1, #., 读 (“商品编号”))
        取项目数 ().未知支持库函数_9 (2, #., 读 (“商品名称”))
        取项目数 ().未知支持库函数_9 (3, #., 到文本 (读 (“单位”)))
        取项目数 ().未知支持库函数_9 (4, #., 到文本 (读 (“出库数量”)))
        取项目数 ().未知支持库函数_9 (5, #., 读 (“进价”))
        取项目数 ().未知支持库函数_9 (6, #., 到文本 (读 (“出库日期”)))
        跳过 ()
    .判断循环尾 ()
    赋值 (.内容, 到文本 (求和 (到数值 (读 (“出库数量”)), 等于 (读 (“商品编号”), 到数值 (.内容)))))
    赋值 (.内容, 到文本 (求和 (到数值 (读 (“进价”)), 等于 (读 (“商品编号”), 到数值 (.内容)))))
    关闭 (相加 (取运行目录 (), “\data\fcdk.edb”))
    赋值 (.内容, “”)
.如果真结束


.子程序 _按钮1_被单击, 空白型, , 
“《出库报表报表》”.未知支持库函数_46 (“宋体”, 25, 真, )
未知支持库函数_27 ()

.窗口程序集 窗口程序集28, , , 

.子程序 _新商品资料_创建完毕, 空白型, , 
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\spzl.edb”))
打开 (相加 (取运行目录 (), “\data\splb.edb”), , , , , , )
到首记录 ()
.判断循环首 (查找 (大于 (读 (“类别编号”), 0)))
    读 (“类别名称”).未知支持库函数_1 (未知支持库函数_5 ())
    读 (“类别名称”).加入项目 (取项目数 ())
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\splb.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\spzl.edb”))
0.未知支持库函数_9 (0, #., “商品编码”)
0.未知支持库函数_9 (1, #., “商品名称”)
0.未知支持库函数_9 (2, #., “单位”)
0.未知支持库函数_9 (3, #., “售价”)
0.未知支持库函数_9 (4, #., “类别”)
0.未知支持库函数_9 (5, #., “是否折扣”)
0.未知支持库函数_9 (6, #., “折扣率”)
0.未知支持库函数_32 (60)
1.未知支持库函数_32 (180)
2.未知支持库函数_32 (40)
3.未知支持库函数_32 (80)
4.未知支持库函数_32 (80)
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\spzl.edb”))
获取焦点 ()
打开 (相加 (取运行目录 (), “\data\splb.edb”), , , , , , )
到首记录 ()
.判断循环首 (等于 (查找 (大于 (读 (“类别编号”), 0)), 真))
    读 (“类别名称”).加入项目 ()
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\splb.edb”))
打开 (相加 (取运行目录 (), “\data\spzl.edb”), , , , , , )
到首记录 ()
赋值 (., 1)
.判断循环首 (查找 (等于 (读 (“类别号”), 1)))
    读 (“商品名称”).加入项目 ()
    取项目数 ()
    赋值 (., 相加 (取项目数 (), 1))
    取项目数 ().未知支持库函数_9 (0, #., 读 (“商品编码”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“商品名称”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“单位”))
    取项目数 ().未知支持库函数_9 (3, #., 读 (“售价”))
    取项目数 ().未知支持库函数_9 (4, #., 读 (“类别”))
    取项目数 ().未知支持库函数_9 (5, #., 读 (“是否折扣”))
    取项目数 ().未知支持库函数_9 (6, #., 读 (“折扣率”))
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\spzl.edb”))

.子程序 _编辑框2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    打开 (相加 (取运行目录 (), “\data\spzl.edb”), , , , , , )
    到首记录 ()
     ' .判断循环首 (查找 (等于 (读 (“商品编码”), 到数值 (.内容))))
         ' 跳过 ()
     ' .判断循环尾 ()
    .如果 (等于 (查找 (等于 (读 (“商品编码”), 到数值 (.内容))), 真))
        信息框 (“编码重复！！！”, 0, )
        获取焦点 ()
        赋值 (.内容, “”)
    .否则
        获取焦点 ()
    .如果结束
    关闭 (相加 (取运行目录 (), “\data\spzl.edb”))
    获取焦点 ()
.如果真结束


.子程序 _编辑框3_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框4_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框5_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

 ' .如果真 (等于 (字符代码, #回车键))
     ' 编辑框6.获取焦点 ()
.如果真结束


.子程序 _编辑框6_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (并且 (等于 (字符代码, #回车键), 等于 (.禁止, 假)))
    赋值 (.现行选中项, .取项目数值 (.现行选中项))
    获取焦点 ()
.如果真结束


.子程序 _按钮6_被单击, 空白型, , 
赋值 (.只读, 假)
赋值 (.允许添加, 真)
赋值 (.允许删除, 假)
到尾记录 ()
相加 (取记录号 (), 1).插入行 (1)
到尾记录 ()
.未知支持库函数_38 ()
相加 (取项目数 (), 1).未知支持库函数_0 (0)
获取焦点 ()
赋值 (.禁止, 真)
赋值 (.禁止, 假)

.子程序 _按钮2_被单击, 空白型, , 
赋值 (.只读, 假)
赋值 (.允许添加, 假)
赋值 (.允许删除, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 假)

.子程序 _按钮3_被单击, 空白型, , 
.局部变量 返回值, 整数型, , , 

赋值 (返回值, 信息框 (“真的要删除这条记录吗？”, 4, ))
.如果真 (等于 (返回值, #是钮))
    赋值 (.只读, 假)
    赋值 (.允许添加, 假)
    赋值 (.允许删除, 真)
    0.删除项目 ()
    取记录号 ().删除行 (1)
    未知支持库函数_3 ().未知支持库函数_36 ()
    赋值 (.只读, 真)
    赋值 (.允许添加, 假)
    赋值 (.允许删除, 假)
.如果真结束


.子程序 _按钮4_被单击, 空白型, , 
赋值 (.只读, 真)
赋值 (.允许添加, 假)
赋值 (.允许删除, 假)
取记录号 ().置文本 (1, .内容)
取记录号 ().置文本 (2, .内容)
取记录号 ().置文本 (3, .内容)
取记录号 ().置文本 (4, .内容)
取记录号 ().置文本 (5, .内容)
取记录号 ().置文本 (6, .内容)
取记录号 ().置文本 (7, 到文本 (相加 (.未知支持库函数_11 (.现行选中项), 1)))
取记录号 ().置文本 (8, .内容)
取记录号 ().置文本 (9, .内容)
未知支持库函数_3 ().未知支持库函数_9 (0, #., .内容)
未知支持库函数_3 ().未知支持库函数_9 (1, #., .内容)
未知支持库函数_3 ().未知支持库函数_9 (2, #., .内容)
未知支持库函数_3 ().未知支持库函数_9 (3, #., .内容)
未知支持库函数_3 ().未知支持库函数_9 (4, #., .内容)
未知支持库函数_3 ().未知支持库函数_9 (5, #., .内容)
未知支持库函数_3 ().未知支持库函数_9 (6, #., .内容)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 真)

.子程序 _按钮5_被单击, 空白型, , 
.局部变量 返回值, 整数型, , , 

.如果 (等于 (.禁止, 真))
    赋值 (返回值, 信息框 (“资料没有保存，真的要退出吗？”, 4, ))
    .如果 (等于 (返回值, #是钮))
        取记录号 ().删除行 (1)
        销毁 ()
    .否则
        
    .如果结束
    
.否则
    销毁 ()
.如果结束





.子程序 _高级表格1_被单击, 空白型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 

打开 (相加 (取运行目录 (), “\data\spzl.edb”), , , , , , )
到首记录 ()
.判断循环首 (等于 (查找 (等于 (读 (“商品编码”), 到数值 (未知支持库函数_3 ().未知支持库函数_10 (0)))), 真))
    取记录号 ().跳到 ()
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\spzl.edb”))

.子程序 _卷帘式菜单1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.标题, 到文本 (相加 (.未知支持库函数_11 (.), 1)))
清空 ()
未知支持库函数_57 ()
0.未知支持库函数_9 (0, #., “商品编码”)
0.未知支持库函数_9 (1, #., “商品名称”)
0.未知支持库函数_9 (2, #., “单位”)
0.未知支持库函数_9 (3, #., “售价”)
0.未知支持库函数_9 (4, #., “类别”)
0.未知支持库函数_9 (5, #., “是否折扣”)
0.未知支持库函数_9 (6, #., “折扣率”)
0.未知支持库函数_32 (60)
1.未知支持库函数_32 (180)
2.未知支持库函数_32 (40)
3.未知支持库函数_32 (80)
4.未知支持库函数_32 (80)
打开 (相加 (取运行目录 (), “\data\spzl.edb”), , , , , , )
到首记录 ()
赋值 (., 1)
.判断循环首 (查找 (等于 (读 (“类别号”), 到数值 (.标题))))
    读 (“商品名称”).加入项目 ()
    取项目数 ()
    赋值 (., 相加 (取项目数 (), 1))
    取项目数 ().未知支持库函数_9 (0, #., 读 (“商品编码”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“商品名称”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“单位”))
    取项目数 ().未知支持库函数_9 (3, #., 读 (“售价”))
    取项目数 ().未知支持库函数_9 (4, #., 读 (“类别”))
    取项目数 ().未知支持库函数_9 (5, #., 读 (“是否折扣”))
    取项目数 ().未知支持库函数_9 (6, #., 读 (“折扣率”))
    跳过 ()
.判断循环尾 ()
1.未知支持库函数_0 (0)
关闭 (相加 (取运行目录 (), “\data\spzl.edb”))

.子程序 _卷帘式菜单1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

打开 (相加 (取运行目录 (), “\data\spzl.edb”), , , , , , )
到首记录 ()
.判断循环首 (等于 (查找 (等于 (读 (“商品编码”), 到数值 (未知支持库函数_3 ().未知支持库函数_10 (0)))), 真))
    取记录号 ().跳到 ()
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\spzl.edb”))


.子程序 _组合框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

获取焦点 ()

.子程序 _列表框2_列表项被选择, 空白型, , 
赋值 (.标题, 到文本 (相加 (.取项目数值 (.现行选中项), 1)))
清空 ()
未知支持库函数_57 ()
0.未知支持库函数_9 (0, #., “商品编码”)
0.未知支持库函数_9 (1, #., “商品名称”)
0.未知支持库函数_9 (2, #., “单位”)
0.未知支持库函数_9 (3, #., “售价”)
0.未知支持库函数_9 (4, #., “类别”)
0.未知支持库函数_9 (5, #., “是否折扣”)
0.未知支持库函数_9 (6, #., “折扣率”)
0.未知支持库函数_32 (60)
1.未知支持库函数_32 (180)
2.未知支持库函数_32 (40)
3.未知支持库函数_32 (80)
4.未知支持库函数_32 (80)
打开 (相加 (取运行目录 (), “\data\spzl.edb”), , , , , , )
到首记录 ()
赋值 (., 1)
.判断循环首 (查找 (等于 (读 (“类别号”), 到数值 (.标题))))
    读 (“商品名称”).加入项目 ()
    取项目数 ()
    赋值 (., 相加 (取项目数 (), 1))
    取项目数 ().未知支持库函数_9 (0, #., 读 (“商品编码”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“商品名称”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“单位”))
    取项目数 ().未知支持库函数_9 (3, #., 读 (“售价”))
    取项目数 ().未知支持库函数_9 (4, #., 读 (“类别”))
    取项目数 ().未知支持库函数_9 (5, #., 读 (“是否折扣”))
    取项目数 ().未知支持库函数_9 (6, #., 读 (“折扣率”))
    跳过 ()
.判断循环尾 ()
1.未知支持库函数_0 (0)
关闭 (相加 (取运行目录 (), “\data\spzl.edb”))
打开 (相加 (取运行目录 (), “\data\spzl.edb”), , , , , , )
到首记录 ()
.判断循环首 (等于 (查找 (等于 (读 (“商品编码”), 到数值 (未知支持库函数_3 ().未知支持库函数_10 (0)))), 真))
    取记录号 ().跳到 ()
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\spzl.edb”))


.子程序 _按钮1_被单击, 空白型, , 
“《商品基本资料》”.未知支持库函数_46 (“宋体”, 25, 真, )
未知支持库函数_27 ()

.子程序 _按钮7_被单击, 空白型, , 
 ' 标签7.标题 ＝ 到文本 (列表框2.取项目数值 (列表框2.现行选中项) ＋ 1)
清空 ()
未知支持库函数_57 ()
0.未知支持库函数_9 (0, #., “商品编码”)
0.未知支持库函数_9 (1, #., “商品名称”)
0.未知支持库函数_9 (2, #., “单位”)
0.未知支持库函数_9 (3, #., “售价”)
0.未知支持库函数_9 (4, #., “类别”)
0.未知支持库函数_9 (5, #., “是否折扣”)
0.未知支持库函数_9 (6, #., “折扣率”)
0.未知支持库函数_32 (80)
1.未知支持库函数_32 (180)
2.未知支持库函数_32 (40)
3.未知支持库函数_32 (80)
4.未知支持库函数_32 (80)
打开 (相加 (取运行目录 (), “\data\spzl.edb”), , , , , , )
到首记录 ()
赋值 (., 1)
.判断循环首 (查找 (不等于 (读 (“商品编码”), 0)))
    读 (“商品名称”).加入项目 ()
    取项目数 ()
    赋值 (., 相加 (取项目数 (), 1))
    取项目数 ().未知支持库函数_9 (0, #., 读 (“商品编码”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“商品名称”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“单位”))
    取项目数 ().未知支持库函数_9 (3, #., 读 (“售价”))
    取项目数 ().未知支持库函数_9 (4, #., 读 (“类别”))
    取项目数 ().未知支持库函数_9 (5, #., 读 (“是否折扣”))
    取项目数 ().未知支持库函数_9 (6, #., 读 (“折扣率”))
    跳过 ()
.判断循环尾 ()


.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框7_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    .如果 (并且 (等于 (.内容, “否”), 小于 (到数值 (.内容), 100)))
        信息框 (“该商品不允许打折！”, 0, )
        赋值 (.内容, “100”)
    .否则
        获取焦点 ()
    .如果结束
    
.如果真结束


.子程序 _组合框2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (并且 (等于 (字符代码, #回车键), 等于 (.内容, “否”)))
    赋值 (.内容, “100”)
.否则
    赋值 (.内容, “”)
.如果结束
获取焦点 ()

.窗口程序集 窗口程序集29, , , 

.子程序 _类别编辑_创建完毕, 空白型, , 
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\splb.edb”))
0.未知支持库函数_9 (0, #., “类别编号”)
0.未知支持库函数_9 (1, #., “类别名称”)
打开 (相加 (取运行目录 (), “\data\splb.edb”), , , , , , )
到首记录 ()
赋值 (., 相加 (取行数 (), 1))
.判断循环首 (等于 (查找 (不等于 (读 (“类别名称”), “”)), 真))
    读 (“类别名称”).加入项目 ()
    赋值 (., 相加 (取项目数 (), 1))
    取项目数 ().未知支持库函数_9 (0, #., 读 (“类别编号”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“类别名称”))
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\splb.edb”))

.子程序 _按钮1_被单击, 空白型, , 
赋值 (.只读, 假)
赋值 (.允许添加, 真)
赋值 (.允许删除, 假)
到尾记录 ()
相加 (取记录号 (), 1).插入行 (1)
到尾记录 ()
.未知支持库函数_38 ()
相加 (取项目数 (), 1).未知支持库函数_0 (0)
获取焦点 ()
赋值 (.禁止, 真)
赋值 (.禁止, 假)


.子程序 _按钮2_被单击, 空白型, , 
赋值 (.只读, 假)
赋值 (.禁止, 假)

.子程序 _按钮3_被单击, 空白型, , 
.局部变量 返回值, 整数型, , , 

赋值 (返回值, 信息框 (“真的要删除这条记录吗？”, 4, ))
.如果真 (等于 (返回值, #是钮))
    赋值 (.只读, 假)
    赋值 (.允许添加, 假)
    赋值 (.允许删除, 真)
    0.删除项目 ()
    取记录号 ().删除行 (1)
    未知支持库函数_3 ().未知支持库函数_36 ()
    赋值 (.只读, 真)
    赋值 (.允许添加, 假)
    赋值 (.允许删除, 假)
.如果真结束


.子程序 _按钮4_被单击, 空白型, , 
.如果 (等于 (.禁止, 真))
    取记录号 ().置文本 (1, .内容)
    取记录号 ().置文本 (2, .内容)
    .加入项目 (.内容, )
    未知支持库函数_3 ().未知支持库函数_9 (0, #., .内容)
    未知支持库函数_3 ().未知支持库函数_9 (1, #., .内容)
.否则
    取记录号 ().置文本 (1, .内容)
    取记录号 ().置文本 (2, .内容)
    未知支持库函数_3 ().未知支持库函数_9 (0, #., .内容)
    未知支持库函数_3 ().未知支持库函数_9 (1, #., .内容)
.如果结束
赋值 (.只读, 真)
赋值 (.允许删除, 假)
赋值 (.允许添加, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 真)

.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _高级表格1_被单击, 空白型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 

打开 (相加 (取运行目录 (), “\data\splb.edb”), , , , , , )
到首记录 ()
.判断循环首 (等于 (查找 (等于 (到文本 (读 (“类别编号”)), 未知支持库函数_3 ().未知支持库函数_10 (0))), 真))
    取记录号 ().跳到 ()
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\splb.edb”))



.窗口程序集 窗口程序集30, , , 

.子程序 _进销往来_创建完毕, 空白型, , 
.局部变量 出库总计, 小数型, , , 
.局部变量 进货总计, 小数型, , , 

赋值 (.今天, 取日期 (取现行时间 ()))
未知支持库函数_57 ()
清空 ()
0.未知支持库函数_9 (0, #., “进货数量”)
0.未知支持库函数_9 (1, #., “进货金额”)
0.未知支持库函数_9 (2, #., “退货数量”)
0.未知支持库函数_9 (3, #., “退货金额”)
0.未知支持库函数_9 (4, #., “销售数量”)
0.未知支持库函数_9 (5, #., “销售金额”)
0.未知支持库函数_9 (6, #., “库存数量”)
0.未知支持库函数_9 (7, #., “库存金额”)
打开 (相加 (取运行目录 (), “\data\jhdk.edb”), , , , , , )
1.未知支持库函数_9 (0, #., 到文本 (求和 (到数值 (读 (“进货数量”)), 等于 (取日期 (读 (“进货日期”)), .今天))))
1.未知支持库函数_9 (1, #., 到文本 (求和 (到数值 (读 (“总计”)), 等于 (取日期 (读 (“进货日期”)), .今天))))
关闭 (相加 (取运行目录 (), “\data\jhdk.edb”))
打开 (相加 (取运行目录 (), “\data\fcdk.edb”), , , , , , )
1.未知支持库函数_9 (2, #., 到文本 (求和 (到数值 (读 (“出库数量”)), 等于 (取日期 (读 (“出库日期”)), .今天))))
1.未知支持库函数_9 (3, #., 到文本 (求和 (到数值 (读 (“进价”)), 等于 (取日期 (读 (“出库日期”)), .今天))))
关闭 (相加 (取运行目录 (), “\data\fcdk.edb”))
打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
1.未知支持库函数_9 (4, #., 到文本 (求和 (到数值 (读 (“销售数量”)), 等于 (取日期 (读 (“销售日期”)), .今天))))
1.未知支持库函数_9 (5, #., 到文本 (求和 (到数值 (读 (“总计”)), 等于 (取日期 (读 (“销售日期”)), .今天))))
关闭 (相加 (取运行目录 (), “\data\xsls.edb”))
打开 (相加 (取运行目录 (), “\data\spkc.edb”), , , , , , )
1.未知支持库函数_9 (6, #., 到文本 (求和 (到数值 (读 (“库存数量”)), 不等于 (读 (“库存数量”), 0))))
1.未知支持库函数_9 (7, #., 到文本 (求和 (到数值 (读 (“总计”)), 不等于 (读 (“总计”), 0))))
关闭 (相加 (取运行目录 (), “\data\spkc.edb”))
打开 (相加 (取运行目录 (), “\data\jhdk.edb”), , , , , , )
赋值 (进货总计, 求和 (到数值 (读 (“总计”)), 不等于 (读 (“总计”), 0)))
关闭 (相加 (取运行目录 (), “\data\jhdk.edb”))
打开 (相加 (取运行目录 (), “\data\fcdk.edb”), , , , , , )
赋值 (出库总计, 求和 (到数值 (读 (“进价”)), 不等于 (读 (“进价”), 0)))
关闭 (相加 (取运行目录 (), “\data\fcdk.edb”))
赋值 (.内容, 到文本 (相减 (进货总计, 出库总计)))
打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
赋值 (.内容, 到文本 (求和 (到数值 (读 (“总计”)), 不等于 (到数值 (读 (“总计”)), 0))))
关闭 (相加 (取运行目录 (), “\data\xsls.edb”))
赋值 (.内容, 到文本 (相减 (到数值 (.内容), 到数值 (相减 (到数值 (.内容), 到数值 (1.未知支持库函数_10 (7)))))))
赋值 (.内容, 到文本 (1.未知支持库函数_10 (7)))

.子程序 _选择框1_被单击, 空白型, , 
.如果 (等于 (.禁止, 真))
    赋值 (.选中, 真)
    赋值 (.禁止, 假)
.否则
    赋值 (.选中, 假)
    赋值 (.禁止, 真)
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 出库总计, 小数型, , , 
.局部变量 进货总计, 小数型, , , 

.如果 (等于 (.选中, 真))
    打开 (相加 (取运行目录 (), “\data\jhdk.edb”), , , , , , )
    1.未知支持库函数_9 (0, #., 到文本 (求和 (到数值 (读 (“进货数量”)), 并且 (大于或等于 (取日期 (读 (“进货日期”)), .今天), 小于或等于 (取日期 (读 (“进货日期”)), .今天)))))
    1.未知支持库函数_9 (1, #., 到文本 (求和 (到数值 (读 (“总计”)), 并且 (大于或等于 (取日期 (读 (“进货日期”)), .今天), 小于或等于 (取日期 (读 (“进货日期”)), .今天)))))
    关闭 (相加 (取运行目录 (), “\data\jhdk.edb”))
    打开 (相加 (取运行目录 (), “\data\fcdk.edb”), , , , , , )
    1.未知支持库函数_9 (2, #., 到文本 (求和 (到数值 (读 (“出库数量”)), 并且 (大于或等于 (取日期 (读 (“出库日期”)), .今天), 小于或等于 (取日期 (读 (“出库日期”)), .今天)))))
    1.未知支持库函数_9 (3, #., 到文本 (求和 (到数值 (读 (“进价”)), 并且 (大于或等于 (取日期 (读 (“出库日期”)), .今天), 小于或等于 (取日期 (读 (“出库日期”)), .今天)))))
    关闭 (相加 (取运行目录 (), “\data\fcdk.edb”))
    打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
    1.未知支持库函数_9 (4, #., 到文本 (求和 (到数值 (读 (“销售数量”)), 并且 (大于或等于 (取日期 (读 (“销售日期”)), .今天), 小于或等于 (取日期 (读 (“销售日期”)), .今天)))))
    1.未知支持库函数_9 (5, #., 到文本 (求和 (到数值 (读 (“总计”)), 并且 (大于或等于 (取日期 (读 (“销售日期”)), .今天), 小于或等于 (取日期 (读 (“销售日期”)), .今天)))))
    关闭 (相加 (取运行目录 (), “\data\xsls.edb”))
    打开 (相加 (取运行目录 (), “\data\spkc.edb”), , , , , , )
    1.未知支持库函数_9 (6, #., 到文本 (求和 (到数值 (读 (“库存数量”)), 不等于 (读 (“库存数量”), 0))))
    1.未知支持库函数_9 (7, #., 到文本 (求和 (到数值 (读 (“总计”)), 不等于 (读 (“总计”), 0))))
    关闭 (相加 (取运行目录 (), “\data\spkc.edb”))
    打开 (相加 (取运行目录 (), “\data\jhdk.edb”), , , , , , )
    赋值 (进货总计, 求和 (到数值 (读 (“总计”)), 不等于 (读 (“总计”), 0)))
    关闭 (相加 (取运行目录 (), “\data\jhdk.edb”))
    打开 (相加 (取运行目录 (), “\data\fcdk.edb”), , , , , , )
    赋值 (出库总计, 求和 (到数值 (读 (“进价”)), 不等于 (读 (“进价”), 0)))
    关闭 (相加 (取运行目录 (), “\data\fcdk.edb”))
    赋值 (.内容, 到文本 (相减 (进货总计, 出库总计)))
    打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
    赋值 (.内容, 到文本 (求和 (到数值 (读 (“总计”)), 不等于 (到数值 (读 (“总计”)), 0))))
    关闭 (相加 (取运行目录 (), “\data\xsls.edb”))
.否则
    打开 (相加 (取运行目录 (), “\data\jhdk.edb”), , , , , , )
    1.未知支持库函数_9 (0, #., 到文本 (求和 (到数值 (读 (“进货数量”)), 等于 (取日期 (读 (“进货日期”)), .今天))))
    1.未知支持库函数_9 (1, #., 到文本 (求和 (到数值 (读 (“总计”)), 等于 (取日期 (读 (“进货日期”)), .今天))))
    关闭 (相加 (取运行目录 (), “\data\jhdk.edb”))
    打开 (相加 (取运行目录 (), “\data\fcdk.edb”), , , , , , )
    1.未知支持库函数_9 (2, #., 到文本 (求和 (到数值 (读 (“出库数量”)), 等于 (取日期 (读 (“出库日期”)), .今天))))
    1.未知支持库函数_9 (3, #., 到文本 (求和 (到数值 (读 (“进价”)), 等于 (取日期 (读 (“出库日期”)), .今天))))
    关闭 (相加 (取运行目录 (), “\data\fcdk.edb”))
    打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
    1.未知支持库函数_9 (4, #., 到文本 (求和 (到数值 (读 (“销售数量”)), 等于 (取日期 (读 (“销售日期”)), .今天))))
    1.未知支持库函数_9 (5, #., 到文本 (求和 (到数值 (读 (“总计”)), 等于 (取日期 (读 (“销售日期”)), .今天))))
    关闭 (相加 (取运行目录 (), “\data\xsls.edb”))
    打开 (相加 (取运行目录 (), “\data\spkc.edb”), , , , , , )
    1.未知支持库函数_9 (6, #., 到文本 (求和 (到数值 (读 (“库存数量”)), 不等于 (读 (“库存数量”), 0))))
    1.未知支持库函数_9 (7, #., 到文本 (求和 (到数值 (读 (“总计”)), 不等于 (读 (“总计”), 0))))
    关闭 (相加 (取运行目录 (), “\data\spkc.edb”))
    打开 (相加 (取运行目录 (), “\data\jhdk.edb”), , , , , , )
    赋值 (进货总计, 求和 (到数值 (读 (“总计”)), 不等于 (读 (“总计”), 0)))
    关闭 (相加 (取运行目录 (), “\data\jhdk.edb”))
    打开 (相加 (取运行目录 (), “\data\fcdk.edb”), , , , , , )
    赋值 (出库总计, 求和 (到数值 (读 (“进价”)), 不等于 (读 (“进价”), 0)))
    关闭 (相加 (取运行目录 (), “\data\fcdk.edb”))
    赋值 (.内容, 到文本 (相减 (进货总计, 出库总计)))
    打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
    赋值 (.内容, 到文本 (求和 (到数值 (读 (“总计”)), 不等于 (到数值 (读 (“总计”)), 0))))
    关闭 (相加 (取运行目录 (), “\data\xsls.edb”))
.如果结束



.窗口程序集 窗口程序集31, , , 

.子程序 _销售流水_创建完毕, 空白型, , 
赋值 (.今天, 取日期 (取现行时间 ()))
未知支持库函数_57 ()
清空 ()
0.未知支持库函数_9 (0, #., “商品编号”)
0.未知支持库函数_9 (1, #., “商品名称”)
0.未知支持库函数_9 (2, #., “单位”)
0.未知支持库函数_9 (3, #., “销售数量”)
0.未知支持库函数_9 (4, #., “单价”)
0.未知支持库函数_9 (5, #., “总计”)
0.未知支持库函数_9 (6, #., “流水号”)
0.未知支持库函数_9 (7, #., “操作员”)
6.未知支持库函数_32 (80)
打开 (相加 (取运行目录 (), “\data\xslsss.edb”), , , , , , )
到首记录 ()
赋值 (., 2)
.判断循环首 (查找 (等于 (取日期 (读 (“销售日期”)), .今天)))
    到文本 (读 (“商品名称”)).加入项目 ()
    取项目数 ()
    赋值 (., 相加 (取项目数 (), 1))
    取项目数 ().未知支持库函数_9 (0, #., 读 (“商品编号”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“商品名称”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“单位”))
    取项目数 ().未知支持库函数_9 (3, #., 读 (“销售数量”))
    取项目数 ().未知支持库函数_9 (4, #., 读 (“售价”))
    取项目数 ().未知支持库函数_9 (5, #., 读 (“总计”))
    取项目数 ().未知支持库函数_9 (6, #., 读 (“流水单号”))
    取项目数 ().未知支持库函数_9 (7, #., 读 (“操作员”))
    跳过 ()
.判断循环尾 ()
赋值 (.内容, 到文本 (求和 (到数值 (读 (“销售数量”)), 等于 (取日期 (读 (“销售日期”)), .今天))))
赋值 (.内容, 到文本 (求和 (到数值 (读 (“总计”)), 等于 (取日期 (读 (“销售日期”)), .今天))))
关闭 (相加 (取运行目录 (), “\data\xslsss.edb”))

.子程序 _按钮1_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    未知支持库函数_57 ()
    清空 ()
    0.未知支持库函数_9 (0, #., “商品编号”)
    0.未知支持库函数_9 (1, #., “商品名称”)
    0.未知支持库函数_9 (2, #., “单位”)
    0.未知支持库函数_9 (3, #., “销售数量”)
    0.未知支持库函数_9 (4, #., “单价”)
    0.未知支持库函数_9 (5, #., “总计”)
    0.未知支持库函数_9 (6, #., “流水号”)
    0.未知支持库函数_9 (7, #., “操作员”)
    6.未知支持库函数_32 (80)
    打开 (相加 (取运行目录 (), “\data\xslsss.edb”), , , , , , )
    到首记录 ()
    赋值 (., 2)
    .判断循环首 (查找 (并且 (大于或等于 (取日期 (读 (“销售日期”)), .今天), 查找 (等于 (小于或等于 (取日期 (读 (“销售日期”)), .今天), 真)))))
        读 (“商品名称”).加入项目 ()
        取项目数 ()
        赋值 (., 相加 (取项目数 (), 1))
        取项目数 ().未知支持库函数_9 (0, #., 读 (“商品编号”))
        取项目数 ().未知支持库函数_9 (1, #., 读 (“商品名称”))
        取项目数 ().未知支持库函数_9 (2, #., 读 (“单位”))
        取项目数 ().未知支持库函数_9 (3, #., 读 (“销售数量”))
        取项目数 ().未知支持库函数_9 (4, #., 读 (“售价”))
        取项目数 ().未知支持库函数_9 (5, #., 读 (“总计”))
        取项目数 ().未知支持库函数_9 (6, #., 读 (“流水单号”))
        取项目数 ().未知支持库函数_9 (7, #., 读 (“操作员”))
        跳过 ()
    .判断循环尾 ()
    赋值 (.内容, 到文本 (求和 (到数值 (读 (“销售数量”)), 并且 (大于或等于 (取日期 (读 (“销售日期”)), .今天), 小于或等于 (取日期 (读 (“销售日期”)), .今天)))))
    赋值 (.内容, 到文本 (求和 (到数值 (读 (“总计”)), 并且 (大于或等于 (取日期 (读 (“销售日期”)), .今天), 小于或等于 (取日期 (读 (“销售日期”)), .今天)))))
.否则
    未知支持库函数_57 ()
    清空 ()
    0.未知支持库函数_9 (0, #., “商品编号”)
    0.未知支持库函数_9 (1, #., “商品名称”)
    0.未知支持库函数_9 (2, #., “单位”)
    0.未知支持库函数_9 (3, #., “销售数量”)
    0.未知支持库函数_9 (4, #., “单价”)
    0.未知支持库函数_9 (5, #., “总计”)
    0.未知支持库函数_9 (6, #., “流水号”)
    0.未知支持库函数_9 (7, #., “操作员”)
    6.未知支持库函数_32 (80)
    打开 (相加 (取运行目录 (), “\data\xslsss.edb”), , , , , , )
    到首记录 ()
    赋值 (., 2)
    .判断循环首 (查找 (等于 (取日期 (读 (“销售日期”)), .今天)))
        到文本 (读 (“商品名称”)).加入项目 ()
        取项目数 ()
        赋值 (., 相加 (取项目数 (), 1))
        取项目数 ().未知支持库函数_9 (0, #., 读 (“商品编号”))
        取项目数 ().未知支持库函数_9 (1, #., 读 (“商品名称”))
        取项目数 ().未知支持库函数_9 (2, #., 读 (“单位”))
        取项目数 ().未知支持库函数_9 (3, #., 读 (“销售数量”))
        取项目数 ().未知支持库函数_9 (4, #., 读 (“售价”))
        取项目数 ().未知支持库函数_9 (5, #., 读 (“总计”))
        取项目数 ().未知支持库函数_9 (6, #., 读 (“流水单号”))
        取项目数 ().未知支持库函数_9 (7, #., 读 (“操作员”))
        跳过 ()
    .判断循环尾 ()
    赋值 (.内容, 到文本 (求和 (到数值 (读 (“销售数量”)), 等于 (取日期 (读 (“销售日期”)), .今天))))
    赋值 (.内容, 到文本 (求和 (到数值 (读 (“总计”)), 等于 (取日期 (读 (“销售日期”)), .今天))))
    关闭 (相加 (取运行目录 (), “\data\xslsss.edb”))
.如果结束


.子程序 _编辑框1_获得焦点, 空白型, , 
 ' 编辑框1.内容 ＝ “”

.子程序 _编辑框2_获得焦点, 空白型, , 
 ' 编辑框2.内容 ＝ “”


.子程序 _选择框1_被单击, 空白型, , 
.如果 (等于 (.禁止, 真))
    赋值 (.选中, 真)
    赋值 (.禁止, 假)
.否则
    赋值 (.选中, 假)
    赋值 (.禁止, 真)
.如果结束


.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

打开 (相加 (取运行目录 (), “\data\xslsss.edb”), , , , , , )
.如果真 (等于 (字符代码, #回车键))
    未知支持库函数_57 ()
    清空 ()
    0.未知支持库函数_9 (0, #., “商品编号”)
    0.未知支持库函数_9 (1, #., “商品名称”)
    0.未知支持库函数_9 (2, #., “单位”)
    0.未知支持库函数_9 (3, #., “销售数量”)
    0.未知支持库函数_9 (4, #., “单价”)
    0.未知支持库函数_9 (5, #., “总计”)
    0.未知支持库函数_9 (6, #., “流水号”)
    0.未知支持库函数_9 (7, #., “操作员”)
    6.未知支持库函数_32 (80)
    打开 (相加 (取运行目录 (), “\data\xslsss.edb”), , , , , , )
    到首记录 ()
    赋值 (., 2)
    .如果 (等于 (.选中, 真))
        .判断循环首 (查找 (并且 (大于或等于 (取日期 (读 (“销售日期”)), .今天), 小于或等于 (取日期 (读 (“销售日期”)), .今天), 等于 (读 (“商品编号”), .内容))))
            到文本 (读 (“商品名称”)).加入项目 ()
            取项目数 ()
            赋值 (., 相加 (取项目数 (), 1))
            取项目数 ().未知支持库函数_9 (0, #., 读 (“商品编号”))
            取项目数 ().未知支持库函数_9 (1, #., 读 (“商品名称”))
            取项目数 ().未知支持库函数_9 (2, #., 读 (“单位”))
            取项目数 ().未知支持库函数_9 (3, #., 读 (“销售数量”))
            取项目数 ().未知支持库函数_9 (4, #., 读 (“售价”))
            取项目数 ().未知支持库函数_9 (5, #., 读 (“总计”))
            取项目数 ().未知支持库函数_9 (6, #., 读 (“流水单号”))
            取项目数 ().未知支持库函数_9 (7, #., 读 (“操作员”))
            跳过 ()
        .判断循环尾 ()
        赋值 (.标题, 到文本 (求和 (到数值 (读 (“销售数量”)), 并且 (大于或等于 (取日期 (读 (“销售日期”)), .今天), 小于或等于 (取日期 (读 (“销售日期”)), .今天), 等于 (读 (“商品编号”), .内容)))))
        赋值 (.标题, 到文本 (求和 (到数值 (读 (“总计”)), 并且 (大于或等于 (取日期 (读 (“销售日期”)), .今天), 小于或等于 (取日期 (读 (“销售日期”)), .今天), 等于 (读 (“商品编号”), .内容)))))
    .否则
        .判断循环首 (查找 (并且 (等于 (取日期 (读 (“销售日期”)), .今天), 等于 (读 (“商品编号”), .内容))))
            到文本 (读 (“商品名称”)).加入项目 ()
            取项目数 ()
            赋值 (., 相加 (取项目数 (), 1))
            取项目数 ().未知支持库函数_9 (0, #., 读 (“商品编号”))
            取项目数 ().未知支持库函数_9 (1, #., 读 (“商品名称”))
            取项目数 ().未知支持库函数_9 (2, #., 读 (“单位”))
            取项目数 ().未知支持库函数_9 (3, #., 读 (“销售数量”))
            取项目数 ().未知支持库函数_9 (4, #., 读 (“售价”))
            取项目数 ().未知支持库函数_9 (5, #., 读 (“总计”))
            取项目数 ().未知支持库函数_9 (6, #., 读 (“流水单号”))
            取项目数 ().未知支持库函数_9 (7, #., 读 (“操作员”))
            跳过 ()
        .判断循环尾 ()
        赋值 (.标题, 到文本 (求和 (到数值 (读 (“销售数量”)), 并且 (等于 (取日期 (读 (“销售日期”)), .今天), 等于 (读 (“商品编号”), .内容)))))
        赋值 (.标题, 到文本 (求和 (到数值 (读 (“总计”)), 并且 (等于 (取日期 (读 (“销售日期”)), .今天), 等于 (读 (“商品编号”), .内容)))))
    .如果结束
    赋值 (.内容, “”)
.如果真结束
关闭 (相加 (取运行目录 (), “\data\xslsss.edb”))

.窗口程序集 窗口程序集32, , , 

.子程序 _流水明细_创建完毕, 空白型, , 
未知支持库函数_57 ()
清空 ()
赋值 (.内容, 报表汇总.未知支持库函数_10 (., 报表汇总.未知支持库函数_3 (.), 10))
0.未知支持库函数_9 (0, #., “商品编号”)
0.未知支持库函数_9 (1, #., “商品名称”)
0.未知支持库函数_9 (2, #., “单位”)
0.未知支持库函数_9 (3, #., “销售数量”)
0.未知支持库函数_9 (4, #., “单价”)
0.未知支持库函数_9 (5, #., “总计”)
0.未知支持库函数_9 (6, #., “操作员”)
6.未知支持库函数_32 (80)
打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
到首记录 ()
.判断循环首 (查找 (等于 (读 (“流水单号”), .内容)))
    .加入项目 (.内容, )
     ' 列表框1.取项目数 ()
    赋值 (., 相加 (取项目数 (), 1))
    取项目数 ().未知支持库函数_9 (0, #., 读 (“商品编号”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“商品名称”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“单位”))
    取项目数 ().未知支持库函数_9 (3, #., 读 (“销售数量”))
    取项目数 ().未知支持库函数_9 (4, #., 读 (“售价”))
    取项目数 ().未知支持库函数_9 (5, #., 读 (“总计”))
    取项目数 ().未知支持库函数_9 (6, #., 读 (“操作员”))
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\xsls.edb”))

.子程序 _按钮1_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集33, , , 

.子程序 _卡编辑_创建完毕, 空白型, , 
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\hykmx.edb”))
赋值 (.标题, 会员卡.未知支持库函数_10 (., 会员卡.未知支持库函数_3 (.), 0))
赋值 (.标题, 会员卡.未知支持库函数_10 (., 会员卡.未知支持库函数_3 (.), 5))
打开 (相加 (取运行目录 (), “\data\hykmx.edb”), , , , , , )
到首记录 ()
.判断循环首 (等于 (查找 (大于 (读 (“会员卡号”), 0)), 真))
    到文本 (读 (“会员卡号”)).加入项目 ()
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\hykmx.edb”))

.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.局部变量 变量, 小数型, , , 

.如果真 (等于 (字符代码, #回车键))
    .如果 (等于 (.标题, “充值”))
        赋值 (变量, 相加 (到数值 (.标题), 到数值 (.内容)))
        打开 (相加 (取运行目录 (), “\data\hykk.edb”), , , , , , )
        到首记录 ()
        .判断循环首 (等于 (查找 (等于 (到文本 (读 (“会员卡号”)), .标题)), 真))
            会员卡.跳到 (., 取记录号 ())
            会员卡.置文本 (., 会员卡.取记录号 (.), 6, 到文本 (变量))
            跳过 ()
        .判断循环尾 ()
        关闭 (相加 (取运行目录 (), “\data\hykk.edb”))
        相加 (取项目数 (), 1).插入行 ()
        到尾记录 ()
        取记录号 ().置文本 (1, .标题)
        取记录号 ().置文本 (3, .内容)
        取记录号 ().置文本 (4, 到文本 (变量))
        取记录号 ().置文本 (5, 到文本 (取现行时间 ()))
        取记录号 ().置文本 (7, “充值”)
        会员卡.未知支持库函数_9 (., 会员卡.未知支持库函数_3 (.), 5, #., 到文本 (变量))
        赋值 (.内容, “”)
    .否则
        
    .如果结束
    .如果 (等于 (.标题, “退款”))
        赋值 (变量, 相减 (到数值 (.标题), 到数值 (.内容)))
        打开 (相加 (取运行目录 (), “\data\hykk.edb”), , , , , , )
        到首记录 ()
        .判断循环首 (等于 (查找 (等于 (到文本 (读 (“会员卡号”)), .标题)), 真))
            会员卡.跳到 (., 取记录号 ())
            会员卡.置文本 (., 会员卡.取记录号 (.), 6, 到文本 (变量))
            跳过 ()
        .判断循环尾 ()
        关闭 (相加 (取运行目录 (), “\data\hykk.edb”))
        相加 (取项目数 (), 1).插入行 ()
        到尾记录 ()
        取记录号 ().置文本 (1, .标题)
        取记录号 ().置文本 (3, .内容)
        取记录号 ().置文本 (4, 到文本 (变量))
        取记录号 ().置文本 (5, 到文本 (取现行时间 ()))
        取记录号 ().置文本 (7, “退款”)
        会员卡.未知支持库函数_9 (., 会员卡.未知支持库函数_3 (.), 5, #., 到文本 (变量))
        赋值 (.内容, “”)
    .否则
        
    .如果结束
    销毁 ()
.如果真结束


.窗口程序集 窗口程序集34, , , 

.子程序 _收款报表_创建完毕, 空白型, , 
赋值 (.今天, 取日期 (取现行时间 ()))
未知支持库函数_57 ()
清空 ()
0.未知支持库函数_9 (0, #., “人员编号”)
0.未知支持库函数_9 (1, #., “人员姓名”)
0.未知支持库函数_9 (2, #., “总计金额”)
0.未知支持库函数_9 (3, #., “实结金额”)
0.未知支持库函数_9 (4, #., “优惠金额”)
0.未知支持库函数_9 (5, #., “会员卡额”)
0.未知支持库函数_9 (6, #., “报表日期”)
6.未知支持库函数_32 (160)
打开 (相加 (取运行目录 (), “\data\user.edb”), , , , , , )
到首记录 ()
.判断循环首 (等于 (查找 (大于或等于 (到数值 (读 (“rybh”)), 0)), 真))
    读 (“ryxm”).加入项目 ()
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\user.edb”))
打开 (相加 (取运行目录 (), “\data\skbb.edb”), , , , , , )
到首记录 ()
赋值 (., 2)
.判断循环首 (查找 (不等于 (到文本 (读 (“人员编号”)), “”)))
    到文本 (读 (“人员姓名”)).加入项目 ()
    取项目数 ()
    赋值 (., 相加 (取项目数 (), 1))
    取项目数 ().未知支持库函数_9 (0, #., 读 (“人员编号”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“人员姓名”))
    取项目数 ().未知支持库函数_9 (2, #., 读 (“总计金额”))
    取项目数 ().未知支持库函数_9 (3, #., 读 (“实结金额”))
    取项目数 ().未知支持库函数_9 (4, #., 读 (“优惠金额”))
    取项目数 ().未知支持库函数_9 (5, #., 读 (“会员卡额”))
    取项目数 ().未知支持库函数_9 (6, #., 到文本 (读 (“报表日期”)))
    跳过 ()
.判断循环尾 ()
赋值 (.内容, 到文本 (四舍五入 (求和 (到数值 (读 (“总计金额”)), 等于 (取日期 (读 (“报表日期”)), .今天)), 2)))
赋值 (.内容, 到文本 (四舍五入 (求和 (到数值 (读 (“实结金额”)), 等于 (取日期 (读 (“报表日期”)), .今天)), 2)))
赋值 (.内容, 到文本 (四舍五入 (求和 (到数值 (读 (“优惠金额”)), 等于 (取日期 (读 (“报表日期”)), .今天)), 2)))
赋值 (.内容, 到文本 (四舍五入 (求和 (到数值 (读 (“会员卡额”)), 等于 (取日期 (读 (“报表日期”)), .今天)), 2)))
关闭 (相加 (取运行目录 (), “\data\skbb.edb”))


.子程序 _选择框1_被单击, 空白型, , 
.如果 (等于 (.禁止, 真))
    赋值 (.选中, 真)
    赋值 (.禁止, 假)
.否则
    赋值 (.选中, 假)
    赋值 (.禁止, 真)
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    .如果 (等于 (.内容, “全部”))
        未知支持库函数_57 ()
        清空 ()
        0.未知支持库函数_9 (0, #., “人员编号”)
        0.未知支持库函数_9 (1, #., “人员姓名”)
        0.未知支持库函数_9 (2, #., “总计金额”)
        0.未知支持库函数_9 (3, #., “实结金额”)
        0.未知支持库函数_9 (4, #., “优惠金额”)
        0.未知支持库函数_9 (5, #., “会员卡额”)
        0.未知支持库函数_9 (6, #., “报表日期”)
        6.未知支持库函数_32 (160)
        打开 (相加 (取运行目录 (), “\data\skbb.edb”), , , , , , )
        到首记录 ()
        赋值 (., 2)
        .判断循环首 (查找 (并且 (大于或等于 (取日期 (读 (“报表日期”)), .今天), 查找 (等于 (小于或等于 (取日期 (读 (“报表日期”)), .今天), 真)))))
            读 (“人员姓名”).加入项目 ()
            取项目数 ()
            赋值 (., 相加 (取项目数 (), 1))
            取项目数 ().未知支持库函数_9 (0, #., 读 (“人员编号”))
            取项目数 ().未知支持库函数_9 (1, #., 读 (“人员姓名”))
            取项目数 ().未知支持库函数_9 (2, #., 读 (“总计金额”))
            取项目数 ().未知支持库函数_9 (3, #., 读 (“实结金额”))
            取项目数 ().未知支持库函数_9 (4, #., 读 (“优惠金额”))
            取项目数 ().未知支持库函数_9 (5, #., 读 (“会员卡额”))
            取项目数 ().未知支持库函数_9 (6, #., 到文本 (读 (“报表日期”)))
            跳过 ()
        .判断循环尾 ()
        赋值 (.内容, 到文本 (四舍五入 (求和 (到数值 (读 (“总计金额”)), 并且 (大于或等于 (取日期 (读 (“报表日期”)), .今天), 小于或等于 (取日期 (读 (“报表日期”)), .今天))), 2)))
        赋值 (.内容, 到文本 (四舍五入 (求和 (到数值 (读 (“实结金额”)), 并且 (大于或等于 (取日期 (读 (“报表日期”)), .今天), 小于或等于 (取日期 (读 (“报表日期”)), .今天))), 2)))
        赋值 (.内容, 到文本 (四舍五入 (求和 (到数值 (读 (“优惠金额”)), 并且 (大于或等于 (取日期 (读 (“报表日期”)), .今天), 小于或等于 (取日期 (读 (“报表日期”)), .今天))), 2)))
        赋值 (.内容, 到文本 (四舍五入 (求和 (到数值 (读 (“会员卡额”)), 并且 (大于或等于 (取日期 (读 (“报表日期”)), .今天), 小于或等于 (取日期 (读 (“报表日期”)), .今天))), 2)))
        关闭 (相加 (取运行目录 (), “\data\skbb.edb”))
    .否则
        未知支持库函数_57 ()
        清空 ()
        0.未知支持库函数_9 (0, #., “人员编号”)
        0.未知支持库函数_9 (1, #., “人员姓名”)
        0.未知支持库函数_9 (2, #., “总计金额”)
        0.未知支持库函数_9 (3, #., “实结金额”)
        0.未知支持库函数_9 (4, #., “优惠金额”)
        0.未知支持库函数_9 (5, #., “会员卡额”)
        0.未知支持库函数_9 (6, #., “报表日期”)
        6.未知支持库函数_32 (160)
        打开 (相加 (取运行目录 (), “\data\skbb.edb”), , , , , , )
        到首记录 ()
        赋值 (., 2)
        .判断循环首 (查找 (并且 (大于或等于 (取日期 (读 (“报表日期”)), .今天), 查找 (并且 (小于或等于 (取日期 (读 (“报表日期”)), .今天), 等于 (查找 (等于 (读 (“人员姓名”), .内容)), 真))))))
            读 (“人员姓名”).加入项目 ()
            取项目数 ()
            赋值 (., 相加 (取项目数 (), 1))
            取项目数 ().未知支持库函数_9 (0, #., 读 (“人员编号”))
            取项目数 ().未知支持库函数_9 (1, #., 读 (“人员姓名”))
            取项目数 ().未知支持库函数_9 (2, #., 读 (“总计金额”))
            取项目数 ().未知支持库函数_9 (3, #., 读 (“实结金额”))
            取项目数 ().未知支持库函数_9 (4, #., 读 (“优惠金额”))
            取项目数 ().未知支持库函数_9 (5, #., 读 (“会员卡额”))
            取项目数 ().未知支持库函数_9 (6, #., 到文本 (读 (“报表日期”)))
            跳过 ()
        .判断循环尾 ()
        赋值 (.内容, 到文本 (四舍五入 (求和 (到数值 (读 (“总计金额”)), 并且 (大于或等于 (取日期 (读 (“报表日期”)), .今天), 小于或等于 (取日期 (读 (“报表日期”)), .今天), 等于 (读 (“人员姓名”), .内容))), 2)))
        赋值 (.内容, 到文本 (四舍五入 (求和 (到数值 (读 (“实结金额”)), 并且 (大于或等于 (取日期 (读 (“报表日期”)), .今天), 小于或等于 (取日期 (读 (“报表日期”)), .今天), 等于 (读 (“人员姓名”), .内容))), 2)))
        赋值 (.内容, 到文本 (四舍五入 (求和 (到数值 (读 (“优惠金额”)), 并且 (大于或等于 (取日期 (读 (“报表日期”)), .今天), 小于或等于 (取日期 (读 (“报表日期”)), .今天), 等于 (读 (“人员姓名”), .内容))), 2)))
        赋值 (.内容, 到文本 (四舍五入 (求和 (到数值 (读 (“会员卡额”)), 并且 (大于或等于 (取日期 (读 (“报表日期”)), .今天), 小于或等于 (取日期 (读 (“报表日期”)), .今天), 等于 (读 (“人员姓名”), .内容))), 2)))
        关闭 (相加 (取运行目录 (), “\data\skbb.edb”))
    .如果结束
    
.否则
    .如果 (等于 (.内容, “全部”))
        未知支持库函数_57 ()
        清空 ()
        0.未知支持库函数_9 (0, #., “人员编号”)
        0.未知支持库函数_9 (1, #., “人员姓名”)
        0.未知支持库函数_9 (2, #., “总计金额”)
        0.未知支持库函数_9 (3, #., “实结金额”)
        0.未知支持库函数_9 (4, #., “优惠金额”)
        0.未知支持库函数_9 (5, #., “会员卡额”)
        0.未知支持库函数_9 (6, #., “报表日期”)
        6.未知支持库函数_32 (160)
        打开 (相加 (取运行目录 (), “\data\skbb.edb”), , , , , , )
        到首记录 ()
        赋值 (., 2)
        .判断循环首 (查找 (等于 (取日期 (读 (“报表日期”)), .今天)))
            到文本 (读 (“人员姓名”)).加入项目 ()
            取项目数 ()
            赋值 (., 相加 (取项目数 (), 1))
            取项目数 ().未知支持库函数_9 (0, #., 读 (“人员编号”))
            取项目数 ().未知支持库函数_9 (1, #., 读 (“人员姓名”))
            取项目数 ().未知支持库函数_9 (2, #., 读 (“总计金额”))
            取项目数 ().未知支持库函数_9 (3, #., 读 (“实结金额”))
            取项目数 ().未知支持库函数_9 (4, #., 读 (“优惠金额”))
            取项目数 ().未知支持库函数_9 (5, #., 读 (“会员卡额”))
            取项目数 ().未知支持库函数_9 (6, #., 到文本 (读 (“报表日期”)))
            跳过 ()
        .判断循环尾 ()
        赋值 (.内容, 到文本 (四舍五入 (求和 (到数值 (读 (“总计金额”)), 等于 (取日期 (读 (“报表日期”)), .今天)), 2)))
        赋值 (.内容, 到文本 (四舍五入 (求和 (到数值 (读 (“实结金额”)), 等于 (取日期 (读 (“报表日期”)), .今天)), 2)))
        赋值 (.内容, 到文本 (四舍五入 (求和 (到数值 (读 (“优惠金额”)), 等于 (取日期 (读 (“报表日期”)), .今天)), 2)))
        赋值 (.内容, 到文本 (四舍五入 (求和 (到数值 (读 (“会员卡额”)), 等于 (取日期 (读 (“报表日期”)), .今天)), 2)))
        关闭 (相加 (取运行目录 (), “\data\skbb.edb”))
    .否则
        未知支持库函数_57 ()
        清空 ()
        0.未知支持库函数_9 (0, #., “人员编号”)
        0.未知支持库函数_9 (1, #., “人员姓名”)
        0.未知支持库函数_9 (2, #., “总计金额”)
        0.未知支持库函数_9 (3, #., “实结金额”)
        0.未知支持库函数_9 (4, #., “优惠金额”)
        0.未知支持库函数_9 (5, #., “会员卡额”)
        0.未知支持库函数_9 (6, #., “报表日期”)
        6.未知支持库函数_32 (160)
        打开 (相加 (取运行目录 (), “\data\skbb.edb”), , , , , , )
        到首记录 ()
        赋值 (., 2)
        .判断循环首 (查找 (并且 (等于 (取日期 (读 (“报表日期”)), .今天), 查找 (等于 (读 (“人员姓名”), .内容)))))
            到文本 (读 (“人员姓名”)).加入项目 ()
            取项目数 ()
            赋值 (., 相加 (取项目数 (), 1))
            取项目数 ().未知支持库函数_9 (0, #., 读 (“人员编号”))
            取项目数 ().未知支持库函数_9 (1, #., 读 (“人员姓名”))
            取项目数 ().未知支持库函数_9 (2, #., 读 (“总计金额”))
            取项目数 ().未知支持库函数_9 (3, #., 读 (“实结金额”))
            取项目数 ().未知支持库函数_9 (4, #., 读 (“优惠金额”))
            取项目数 ().未知支持库函数_9 (5, #., 读 (“会员卡额”))
            取项目数 ().未知支持库函数_9 (6, #., 到文本 (读 (“报表日期”)))
            跳过 ()
        .判断循环尾 ()
        赋值 (.内容, 到文本 (四舍五入 (求和 (到数值 (读 (“总计金额”)), 并且 (等于 (取日期 (读 (“报表日期”)), .今天), 等于 (读 (“人员姓名”), .内容))), 2)))
        赋值 (.内容, 到文本 (四舍五入 (求和 (到数值 (读 (“实结金额”)), 并且 (等于 (取日期 (读 (“报表日期”)), .今天), 等于 (读 (“人员姓名”), .内容))), 2)))
        赋值 (.内容, 到文本 (四舍五入 (求和 (到数值 (读 (“优惠金额”)), 并且 (等于 (取日期 (读 (“报表日期”)), .今天), 等于 (读 (“人员姓名”), .内容))), 2)))
        赋值 (.内容, 到文本 (四舍五入 (求和 (到数值 (读 (“会员卡额”)), 并且 (等于 (取日期 (读 (“报表日期”)), .今天), 等于 (读 (“人员姓名”), .内容))), 2)))
        关闭 (相加 (取运行目录 (), “\data\skbb.edb”))
    .如果结束
    
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
相加 (“《收款员报表》-”, 到文本 (.今天)).未知支持库函数_46 (“宋体”, 25, 真, )
未知支持库函数_27 ()

.窗口程序集 窗口程序集35, , , 

.子程序 _数据清除_创建完毕, 空白型, , 
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\splb.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\skbb.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\spzl.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\fjzl.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\hykk.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\spkc.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\jhdk.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\fcdk.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\xfbb.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\xsls.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\xslsss.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\user.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\userqx.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\hykmx.edb”))
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\kzlb.edb”))

.子程序 _按钮1_被单击, 空白型, , 
.如果真 (等于 (.选中, 真))
    1.删除行 (取行数 ())
    .如果 (小于或等于 (取行数 (), 0))
        信息框 (“类别数据删除成功！”, 0, )
    .否则
        
    .如果结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    1.删除行 (取行数 ())
    .如果 (小于或等于 (取行数 (), 0))
        信息框 (“商品数据删除成功！”, 0, )
    .否则
        
    .如果结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    1.删除行 (取行数 ())
    .如果 (小于或等于 (取行数 (), 0))
        信息框 (“房台数据删除成功！”, 0, )
    .否则
        
    .如果结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    1.删除行 (取行数 ())
    1.删除行 (取行数 ())
    1.删除行 (取行数 ())
    .如果 (小于或等于 (取行数 (), 0))
        信息框 (“会员数据删除成功！”, 0, )
    .否则
        
    .如果结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    1.删除行 (取行数 ())
    .如果 (小于或等于 (取行数 (), 0))
        信息框 (“销售报表数据删除成功！”, 0, )
    .否则
        
    .如果结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    1.删除行 (取行数 ())
    .如果 (小于或等于 (取行数 (), 0))
        信息框 (“销售明细数据删除成功！”, 0, )
    .否则
        
    .如果结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    1.删除行 (取行数 ())
    1.删除行 (取行数 ())
    .如果 (小于或等于 (取行数 (), 0))
        信息框 (“收款数据删除成功！”, 0, )
    .否则
        
    .如果结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    1.删除行 (取行数 ())
    .如果 (小于或等于 (取行数 (), 0))
        信息框 (“库存数据删除成功！”, 0, )
    .否则
        
    .如果结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    1.删除行 (取行数 ())
    .如果 (小于或等于 (取行数 (), 0))
        信息框 (“入库数据删除成功！”, 0, )
    .否则
        
    .如果结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    1.删除行 (取行数 ())
    .如果 (小于或等于 (取行数 (), 0))
        信息框 (“出库数据删除成功！”, 0, )
    .否则
        
    .如果结束
    
.如果真结束









.窗口程序集 窗口程序集36, , , 

.子程序 _卡密码_创建完毕, 空白型, , 
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\hykk.edb”))
赋值 (.标题, 到文本 (会员卡.未知支持库函数_10 (., 会员卡.未知支持库函数_3 (.), 0)))
获取焦点 ()


.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _按钮1_被单击, 空白型, , 
.如果 (不等于 (.内容, .内容))
    信息框 (“两次密码不同，请重新输入”, 0, )
    获取焦点 ()
    赋值 (.内容, “”)
    赋值 (.内容, “”)
.否则
    会员卡.未知支持库函数_3 (.).置文本 (7, .内容)
    信息框 (“密码设置成功！”, 0, )
    销毁 ()
.如果结束


.窗口程序集 窗口程序集37, , , 

.子程序 _卡种类别_创建完毕, 空白型, , 
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\kzlb.edb”))
0.未知支持库函数_9 (0, #., “卡种编号”)
0.未知支持库函数_9 (1, #., “卡种名称”)
打开 (相加 (取运行目录 (), “\data\kzlb.edb”), , , , , , )
到首记录 ()
赋值 (., 相加 (取行数 (), 1))
.判断循环首 (等于 (查找 (不等于 (读 (“卡种名称”), “”)), 真))
    读 (“卡种名称”).加入项目 ()
    赋值 (., 相加 (取项目数 (), 1))
    取项目数 ().未知支持库函数_9 (0, #., 读 (“卡种编号”))
    取项目数 ().未知支持库函数_9 (1, #., 读 (“卡种名称”))
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\kzlb.edb”))


.子程序 _按钮1_被单击, 空白型, , 
赋值 (.只读, 假)
赋值 (.允许添加, 真)
赋值 (.允许删除, 假)
到尾记录 ()
相加 (取记录号 (), 1).插入行 (1)
到尾记录 ()
.未知支持库函数_38 ()
相加 (取项目数 (), 1).未知支持库函数_0 (0)
获取焦点 ()
赋值 (.禁止, 真)
赋值 (.禁止, 假)


.子程序 _按钮2_被单击, 空白型, , 
赋值 (.只读, 假)
赋值 (.禁止, 假)

.子程序 _按钮3_被单击, 空白型, , 
.局部变量 返回值, 整数型, , , 

赋值 (返回值, 信息框 (“真的要删除这条记录吗？”, 4, ))
.如果真 (等于 (返回值, #是钮))
    赋值 (.只读, 假)
    赋值 (.允许添加, 假)
    赋值 (.允许删除, 真)
    0.删除项目 ()
    取记录号 ().删除行 (1)
    未知支持库函数_3 ().未知支持库函数_36 ()
    赋值 (.只读, 真)
    赋值 (.允许添加, 假)
    赋值 (.允许删除, 假)
.如果真结束


.子程序 _按钮4_被单击, 空白型, , 
.如果 (等于 (.禁止, 真))
    取记录号 ().置文本 (1, .内容)
    取记录号 ().置文本 (2, .内容)
    .加入项目 (.内容, )
    未知支持库函数_3 ().未知支持库函数_9 (0, #., .内容)
    未知支持库函数_3 ().未知支持库函数_9 (1, #., .内容)
.否则
    取记录号 ().置文本 (1, .内容)
    取记录号 ().置文本 (2, .内容)
    未知支持库函数_3 ().未知支持库函数_9 (0, #., .内容)
    未知支持库函数_3 ().未知支持库函数_9 (1, #., .内容)
.如果结束
赋值 (.只读, 真)
赋值 (.允许删除, 假)
赋值 (.允许添加, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 真)

.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _高级表格1_被单击, 空白型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 

打开 (相加 (取运行目录 (), “\data\kzlb.edb”), , , , , , )
到首记录 ()
.判断循环首 (等于 (查找 (等于 (到文本 (读 (“卡种编号”)), 未知支持库函数_3 ().未知支持库函数_10 (0))), 真))
    取记录号 ().跳到 ()
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\kzlb.edb”))



.窗口程序集 窗口程序集38, , , 

.子程序 _打印机设置_创建完毕, 空白型, , 
.局部变量 打印机列表, 文本型, , "0", 
.局部变量 记次变量, 整数型, , , 

.如果 (等于 (打印机设置., “报表打印”))
    赋值 (打印机设置..可视, 真)
    赋值 (打印机设置..可视, 真)
    赋值 (打印机设置..可视, 真)
.否则
    赋值 (打印机设置..可视, 假)
    赋值 (打印机设置..可视, 假)
    赋值 (打印机设置..可视, 假)
.如果结束
赋值 (打印机列表, 未知支持库函数_85 ())
.计次循环首 (取数组成员数 (打印机列表), 记次变量)
    打印机列表.加入项目 ( [记次变量], 记次变量)
.计次循环尾 ()


.子程序 _按钮1_被单击, 空白型, , 
.如果 (等于 (未知支持库函数_87 (.取项目文本 (.现行选中项)), 真))
    信息框 (“设置默认打印机成功”, 0, “设置默认打印机”)
.否则
    信息框 (“设置默认打印机失败”, 0, “设置默认打印机”)
.如果结束
销毁 ()

.子程序 _按钮4_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集39, , , 

.子程序 _销售月报_创建完毕, 空白型, , 
清空 ()
未知支持库函数_57 ()
0.未知支持库函数_9 (0, #., “日期”)
0.未知支持库函数_9 (1, #., “人数”)
0.未知支持库函数_9 (2, #., “消费”)
0.未知支持库函数_9 (3, #., “总计”)
0.未知支持库函数_9 (4, #., “实付”)
0.未知支持库函数_9 (5, #., “优惠”)
0.未知支持库函数_9 (6, #., “卡金额”)
0.未知支持库函数_9 (7, #., “送单”)
0.未知支持库函数_9 (8, #., “挂帐”)
0.未知支持库函数_32 (110)
0.未知支持库函数_18 (0, 未知支持库函数_7 (), 未知支持库函数_8 (), 12)
打开 (相加 (取运行目录 (), “\data\xfbb.edb”), , , , , “daoqin1980”, )
到首记录 ()
.计次循环首 (1, 计次变量)
    到文本 (计次变量).加入项目 ()
    赋值 (., 相加 (取项目数 (), 1))
    取项目数 ().未知支持库函数_9 (0, #., 相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (相减 (相加 (到数值 (取日 (.今天)), 计次变量), 1)), “日”))
    取项目数 ().未知支持库函数_9 (1, #., 到文本 (求和 (到数值 (读 (“人数”)), 等于 (取日期 (读 (“结帐时间”)), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (相减 (相加 (到数值 (取日 (.今天)), 计次变量), 1)), “日”))))))
    取项目数 ().未知支持库函数_9 (2, #., 到文本 (求和 (到数值 (读 (“消费”)), 等于 (取日期 (读 (“结帐时间”)), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (相减 (相加 (到数值 (取日 (.今天)), 计次变量), 1)), “日”))))))
    取项目数 ().未知支持库函数_9 (3, #., 到文本 (求和 (到数值 (读 (“总计”)), 等于 (取日期 (读 (“结帐时间”)), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (相减 (相加 (到数值 (取日 (.今天)), 计次变量), 1)), “日”))))))
    取项目数 ().未知支持库函数_9 (4, #., 到文本 (求和 (到数值 (读 (“实付”)), 等于 (取日期 (读 (“结帐时间”)), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (相减 (相加 (到数值 (取日 (.今天)), 计次变量), 1)), “日”))))))
    取项目数 ().未知支持库函数_9 (5, #., 到文本 (求和 (到数值 (读 (“优惠”)), 等于 (取日期 (读 (“结帐时间”)), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (相减 (相加 (到数值 (取日 (.今天)), 计次变量), 1)), “日”))))))
    取项目数 ().未知支持库函数_9 (6, #., 到文本 (求和 (到数值 (读 (“卡金额”)), 等于 (取日期 (读 (“结帐时间”)), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (相减 (相加 (到数值 (取日 (.今天)), 计次变量), 1)), “日”))))))
    取项目数 ().未知支持库函数_9 (7, #., 到文本 (求和 (到数值 (读 (“总计”)), 并且 (等于 (读 (“标志”), “免单”), 等于 (取日期 (读 (“结帐时间”)), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (相减 (相加 (到数值 (取日 (.今天)), 计次变量), 1)), “日”)))))))
    取项目数 ().未知支持库函数_9 (8, #., 到文本 (求和 (到数值 (读 (“总计”)), 并且 (等于 (读 (“标志”), “挂帐”), 等于 (取日期 (读 (“结帐时间”)), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (相减 (相加 (到数值 (取日 (.今天)), 计次变量), 1)), “日”)))))))
.计次循环尾 ()
.未知支持库函数_38 ()
相加 (取项目数 (), 1).未知支持库函数_9 (0, #., “合计：”)
0.未知支持库函数_18 (0, 相加 (取项目数 (), 1), 14, 16)
关闭 (相加 (取运行目录 (), “\data\xfbb.edb”))

.子程序 _选择框1_被单击, 空白型, , 
.如果 (等于 (.禁止, 真))
    赋值 (.选中, 真)
    赋值 (.禁止, 假)
.否则
    赋值 (.选中, 假)
    赋值 (.禁止, 真)
.如果结束


.子程序 _编辑框1_获得焦点, 空白型, , 
 ' 编辑框1.内容 ＝ “”

.子程序 _编辑框2_获得焦点, 空白型, , 
 ' 编辑框2.内容 ＝ “”

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 时间值, 日期时间型, , , 

清空 ()
未知支持库函数_57 ()
0.未知支持库函数_9 (0, #., “日期”)
0.未知支持库函数_9 (1, #., “人数”)
0.未知支持库函数_9 (2, #., “消费”)
0.未知支持库函数_9 (3, #., “总计”)
0.未知支持库函数_9 (4, #., “实付”)
0.未知支持库函数_9 (5, #., “优惠”)
0.未知支持库函数_9 (6, #., “卡金额”)
0.未知支持库函数_9 (7, #., “送单”)
0.未知支持库函数_9 (8, #., “挂帐”)
0.未知支持库函数_32 (110)
0.未知支持库函数_18 (0, 未知支持库函数_7 (), 未知支持库函数_8 (), 12)
赋值 (., 2)
.如果 (等于 (.选中, 真))
    打开 (相加 (取运行目录 (), “\data\xfbb.edb”), , , , , , )
    到首记录 ()
     ' 时间值 ＝ 取日期 (到时间 (到文本 (取年份 (日期框1.今天)) ＋ “年” ＋ 到文本 (到数值 (取月份 (日期框1.今天)) ＋ 1) ＋ “月” ＋ 到文本 (1) ＋ “日”))
     ' 日期框1.今天 ＝ 取日期 (到时间 (到文本 (取年份 (日期框1.今天)) ＋ “年” ＋ 到文本 (取月份 (日期框1.今天)) ＋ “月” ＋ 到文本 (1) ＋ “日”))
     ' 日期框2.今天 ＝ 到时间 (到文本 (取年份 (日期框1.今天)) ＋ “年” ＋ 到文本 (到数值 (取月份 (日期框1.今天)) ＋ 1) ＋ “月” ＋ 到文本 (1) ＋ “日”)
    .计次循环首 (相加 (取时间间隔 (.今天, .今天, #日), 1), 计次变量)
        到文本 (计次变量).加入项目 ()
        赋值 (., 相加 (取项目数 (), 1))
        取项目数 ().未知支持库函数_9 (0, #., 相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (到数值 (相减 (相加 (取日 (.今天), 计次变量), 1))), “日”))
        取项目数 ().未知支持库函数_9 (1, #., 到文本 (求和 (到数值 (读 (“人数”)), 等于 (取日期 (读 (“结帐时间”)), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (相减 (相加 (到数值 (取日 (.今天)), 计次变量), 1)), “日”))))))
        取项目数 ().未知支持库函数_9 (2, #., 到文本 (求和 (到数值 (读 (“消费”)), 等于 (取日期 (读 (“结帐时间”)), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (相减 (相加 (到数值 (取日 (.今天)), 计次变量), 1)), “日”))))))
        取项目数 ().未知支持库函数_9 (3, #., 到文本 (求和 (到数值 (读 (“总计”)), 等于 (取日期 (读 (“结帐时间”)), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (相减 (相加 (到数值 (取日 (.今天)), 计次变量), 1)), “日”))))))
        取项目数 ().未知支持库函数_9 (4, #., 到文本 (求和 (到数值 (读 (“实付”)), 等于 (取日期 (读 (“结帐时间”)), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (相减 (相加 (到数值 (取日 (.今天)), 计次变量), 1)), “日”))))))
        取项目数 ().未知支持库函数_9 (5, #., 到文本 (求和 (到数值 (读 (“优惠”)), 等于 (取日期 (读 (“结帐时间”)), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (相减 (相加 (到数值 (取日 (.今天)), 计次变量), 1)), “日”))))))
        取项目数 ().未知支持库函数_9 (6, #., 到文本 (求和 (到数值 (读 (“卡金额”)), 等于 (取日期 (读 (“结帐时间”)), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (相减 (相加 (到数值 (取日 (.今天)), 计次变量), 1)), “日”))))))
        取项目数 ().未知支持库函数_9 (7, #., 到文本 (求和 (到数值 (读 (“总计”)), 并且 (等于 (读 (“标志”), “免单”), 等于 (取日期 (读 (“结帐时间”)), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (相减 (相加 (到数值 (取日 (.今天)), 计次变量), 1)), “日”)))))))
        取项目数 ().未知支持库函数_9 (8, #., 到文本 (求和 (到数值 (读 (“总计”)), 并且 (等于 (读 (“标志”), “挂帐”), 等于 (取日期 (读 (“结帐时间”)), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (相减 (相加 (到数值 (取日 (.今天)), 计次变量), 1)), “日”)))))))
    .计次循环尾 ()
    .未知支持库函数_38 ()
    相加 (取项目数 (), 1).未知支持库函数_9 (0, #., “合计：”)
    相加 (取项目数 (), 1).未知支持库函数_9 (1, #., 到文本 (求和 (到数值 (读 (“人数”)), 并且 (大于或等于 (取日期 (读 (“结帐时间”)), 取日期 (到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (到数值 (取日 (.今天))), “日”)))), 小于或等于 (取日期 (读 (“结帐时间”)), .今天)))))
    相加 (取项目数 (), 1).未知支持库函数_9 (2, #., 到文本 (求和 (到数值 (读 (“消费”)), 并且 (大于或等于 (取日期 (读 (“结帐时间”)), 取日期 (到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (到数值 (取日 (.今天))), “日”)))), 小于或等于 (取日期 (读 (“结帐时间”)), .今天)))))
    相加 (取项目数 (), 1).未知支持库函数_9 (3, #., 到文本 (求和 (到数值 (读 (“总计”)), 并且 (大于或等于 (取日期 (读 (“结帐时间”)), 取日期 (到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (到数值 (取日 (.今天))), “日”)))), 小于或等于 (取日期 (读 (“结帐时间”)), .今天)))))
    相加 (取项目数 (), 1).未知支持库函数_9 (4, #., 到文本 (求和 (到数值 (读 (“实付”)), 并且 (大于或等于 (取日期 (读 (“结帐时间”)), 取日期 (到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (到数值 (取日 (.今天))), “日”)))), 小于或等于 (取日期 (读 (“结帐时间”)), .今天)))))
    相加 (取项目数 (), 1).未知支持库函数_9 (5, #., 到文本 (求和 (到数值 (读 (“优惠”)), 并且 (大于或等于 (取日期 (读 (“结帐时间”)), 取日期 (到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (到数值 (取日 (.今天))), “日”)))), 小于或等于 (取日期 (读 (“结帐时间”)), .今天)))))
    相加 (取项目数 (), 1).未知支持库函数_9 (6, #., 到文本 (求和 (到数值 (读 (“卡金额”)), 并且 (大于或等于 (取日期 (读 (“结帐时间”)), 取日期 (到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (到数值 (取日 (.今天))), “日”)))), 小于或等于 (取日期 (读 (“结帐时间”)), .今天)))))
    相加 (取项目数 (), 1).未知支持库函数_9 (7, #., 到文本 (求和 (到数值 (读 (“总计”)), 并且 (等于 (读 (“标志”), “免单”), 大于或等于 (取日期 (读 (“结帐时间”)), 取日期 (到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (到数值 (取日 (.今天))), “日”)))), 小于或等于 (取日期 (读 (“结帐时间”)), .今天)))))
    相加 (取项目数 (), 1).未知支持库函数_9 (8, #., 到文本 (求和 (到数值 (读 (“总计”)), 并且 (等于 (读 (“标志”), “挂帐”), 大于或等于 (取日期 (读 (“结帐时间”)), 取日期 (到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (到数值 (取日 (.今天))), “日”)))), 小于或等于 (取日期 (读 (“结帐时间”)), .今天)))))
    0.未知支持库函数_18 (0, 相加 (取项目数 (), 1), 14, 16)
    关闭 (相加 (取运行目录 (), “\data\xfbb.edb”))
.否则
    打开 (相加 (取运行目录 (), “\data\xfbb.edb”), , , , , , )
    到首记录 ()
    .计次循环首 (1, 计次变量)
        到文本 (计次变量).加入项目 ()
        赋值 (., 相加 (取项目数 (), 1))
        取项目数 ().未知支持库函数_9 (0, #., 相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (到数值 (取日 (.今天))), “日”))
        取项目数 ().未知支持库函数_9 (1, #., 到文本 (求和 (到数值 (读 (“人数”)), 等于 (取日期 (读 (“结帐时间”)), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (到数值 (取日 (.今天))), “日”))))))
        取项目数 ().未知支持库函数_9 (2, #., 到文本 (求和 (到数值 (读 (“消费”)), 等于 (取日期 (读 (“结帐时间”)), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (到数值 (取日 (.今天))), “日”))))))
        取项目数 ().未知支持库函数_9 (3, #., 到文本 (求和 (到数值 (读 (“总计”)), 等于 (取日期 (读 (“结帐时间”)), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (到数值 (取日 (.今天))), “日”))))))
        取项目数 ().未知支持库函数_9 (4, #., 到文本 (求和 (到数值 (读 (“实付”)), 等于 (取日期 (读 (“结帐时间”)), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (到数值 (取日 (.今天))), “日”))))))
        取项目数 ().未知支持库函数_9 (5, #., 到文本 (求和 (到数值 (读 (“优惠”)), 等于 (取日期 (读 (“结帐时间”)), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (到数值 (取日 (.今天))), “日”))))))
        取项目数 ().未知支持库函数_9 (6, #., 到文本 (求和 (到数值 (读 (“卡金额”)), 等于 (取日期 (读 (“结帐时间”)), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (到数值 (取日 (.今天))), “日”))))))
        取项目数 ().未知支持库函数_9 (7, #., 到文本 (求和 (到数值 (读 (“总计”)), 并且 (等于 (读 (“标志”), “免单”), 等于 (取日期 (读 (“结帐时间”)), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (到数值 (取日 (.今天))), “日”)))))))
        取项目数 ().未知支持库函数_9 (8, #., 到文本 (求和 (到数值 (读 (“总计”)), 并且 (等于 (读 (“标志”), “挂帐”), 等于 (取日期 (读 (“结帐时间”)), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (到数值 (取日 (.今天))), “日”)))))))
    .计次循环尾 ()
    .未知支持库函数_38 ()
    相加 (取项目数 (), 1).未知支持库函数_9 (0, #., “合计：”)
    相加 (取项目数 (), 1).未知支持库函数_9 (1, #., 取项目数 ().未知支持库函数_10 (1))
    相加 (取项目数 (), 1).未知支持库函数_9 (2, #., 取项目数 ().未知支持库函数_10 (2))
    相加 (取项目数 (), 1).未知支持库函数_9 (3, #., 取项目数 ().未知支持库函数_10 (3))
    相加 (取项目数 (), 1).未知支持库函数_9 (4, #., 取项目数 ().未知支持库函数_10 (4))
    相加 (取项目数 (), 1).未知支持库函数_9 (5, #., 取项目数 ().未知支持库函数_10 (5))
    相加 (取项目数 (), 1).未知支持库函数_9 (6, #., 取项目数 ().未知支持库函数_10 (6))
    相加 (取项目数 (), 1).未知支持库函数_9 (7, #., 取项目数 ().未知支持库函数_10 (7))
    相加 (取项目数 (), 1).未知支持库函数_9 (8, #., 取项目数 ().未知支持库函数_10 (8))
    0.未知支持库函数_18 (0, 相加 (取项目数 (), 1), 14, 16)
    关闭 (相加 (取运行目录 (), “\data\xfbb.edb”))
.如果结束


.子程序 _高级表格1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

 ' 载入 (流水明细, 报表汇总, 假)

.子程序 _按钮2_被单击, 空白型, , 
相加 (“《销售月报表》-”, 到文本 (取月份 (.今天)), “月”).未知支持库函数_46 (“宋体”, 16, 真, )
#..未知支持库函数_65 (50)
未知支持库函数_27 ()

.窗口程序集 窗口程序集40, , , 

.子程序 _选择框1_被单击, 空白型, , 
.如果 (等于 (.禁止, 真))
    赋值 (.选中, 真)
    赋值 (.禁止, 假)
.否则
    赋值 (.选中, 假)
    赋值 (.禁止, 真)
.如果结束


.子程序 _类别销售_创建完毕, 空白型, , 
0.未知支持库函数_9 (0, #., “编号”)
0.未知支持库函数_9 (1, #., “名称”)
0.未知支持库函数_9 (2, #., “总计”)
0.未知支持库函数_9 (3, #., “实结”)
打开 (相加 (取运行目录 (), “\data\splb.edb”), , , , , , )
到首记录 ()
赋值 (., 2)
.判断循环首 (等于 (查找 (不等于 (读 (“类别名称”), “”)), 真))
    读 (“类别名称”).加入项目 ()
    赋值 (., 相加 (取项目数 (), 1))
    取项目数 ().未知支持库函数_9 (0, #., 读 (“类别编号”))
    取项目数 ().未知支持库函数_9 (1, #., 取文本左边 (读 (“类别名称”), 8))
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\splb.edb”))


.子程序 _按钮1_被单击, 空白型, , 
清空 ()
未知支持库函数_57 ()
0.未知支持库函数_9 (0, #., “编号”)
0.未知支持库函数_9 (1, #., “名称”)
0.未知支持库函数_9 (2, #., “总计”)
0.未知支持库函数_9 (3, #., “实结”)
打开 (相加 (取运行目录 (), “\data\splb.edb”), , , , , , )
到首记录 ()
赋值 (., 2)
.判断循环首 (等于 (查找 (不等于 (读 (“类别名称”), “”)), 真))
    读 (“类别名称”).加入项目 ()
    赋值 (., 相加 (取项目数 (), 1))
    取项目数 ().未知支持库函数_9 (0, #., 读 (“类别编号”))
    取项目数 ().未知支持库函数_9 (1, #., 取文本左边 (读 (“类别名称”), 8))
    跳过 ()
.判断循环尾 ()
关闭 (相加 (取运行目录 (), “\data\splb.edb”))
打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
到首记录 ()
.如果 (等于 (.选中, 真))
    .计次循环首 (相加 (取项目数 (), 1), 计次变量)
        计次变量.未知支持库函数_9 (2, #., 求和 (到数值 (读 (“总计”)), 并且 (等于 (读 (“类别”), 相减 (计次变量, 1).取项目文本 ()), 大于或等于 (取日期 (读 (“销售日期”)), 取日期 (到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (到数值 (取日 (.今天))), “日”)))), 小于或等于 (取日期 (读 (“销售日期”)), 取日期 (到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (到数值 (取日 (.今天))), “日”)))))))
        计次变量.未知支持库函数_9 (3, #., 求和 (到数值 (读 (“实付”)), 并且 (等于 (读 (“类别”), 相减 (计次变量, 1).取项目文本 ()), 大于或等于 (取日期 (读 (“销售日期”)), 取日期 (到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (到数值 (取日 (.今天))), “日”)))), 小于或等于 (取日期 (读 (“销售日期”)), 取日期 (到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (到数值 (取日 (.今天))), “日”)))))))
        跳过 ()
    .计次循环尾 ()
.否则
    .计次循环首 (取项目数 (), 计次变量)
        计次变量.未知支持库函数_9 (2, #., 求和 (到数值 (读 (“总计”)), 并且 (等于 (读 (“类别”), 相减 (计次变量, 1).取项目文本 ()), 等于 (取日期 (读 (“销售日期”)), 取日期 (到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (到数值 (取日 (.今天))), “日”)))))))
        计次变量.未知支持库函数_9 (3, #., 求和 (到数值 (读 (“实付”)), 并且 (等于 (读 (“类别”), 相减 (计次变量, 1).取项目文本 ()), 等于 (取日期 (读 (“销售日期”)), 取日期 (到时间 (相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, 到文本 (到数值 (取日 (.今天))), “日”)))))))
    .计次循环尾 ()
.如果结束
关闭 (相加 (取运行目录 (), “\data\xsls.edb”))

.子程序 _按钮2_被单击, 空白型, , 
 ' 高级表格1.置打印表头 (“《类别销售报表》” ＋ #换行符 ＋ 到文本 (取日期 (日期框1.今天)), “宋体”, 14, 真, )
假.开始打印 (假, “58mm roll paper”, , .打印区宽度, 相减 (.打印区高度, 200))
相加 (取空白文本 (相减 (20, 取文本长度 (“类别销售报表”))), “类别销售报表”, #换行符, “~~~~~~~~~~~~~~~~~~~~~~~~~~~~~”, #换行符).写出 ()
相加 (“编号”, “    ”, “名称”, “    ”, “总计”, “    ”, “实结”, #换行符).写出 ()
.计次循环首 (取项目数 (), 计次变量)
    相加 (计次变量.未知支持库函数_10 (0), “    ”, 计次变量.未知支持库函数_10 (1), “      ”, 计次变量.未知支持库函数_10 (2), “      ”, 计次变量.未知支持库函数_10 (3), #换行符).写出 ()
.计次循环尾 ()
结束打印 ()
 ' 高级表格1.打印预览 ()

.窗口程序集 窗口程序集41, , , 

.子程序 _人员资料管理_创建完毕, 空白型, , 
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\ryzl.edb”))
0.未知支持库函数_9 (0, #., “编号”)
0.未知支持库函数_9 (1, #., “姓名”)
0.未知支持库函数_9 (2, #., “性别”)
0.未知支持库函数_9 (3, #., “职务”)
0.未知支持库函数_9 (4, #., “身份证号”)
0.未知支持库函数_9 (5, #., “电话号码”)
0.未知支持库函数_9 (6, #., “家庭住址”)
0.未知支持库函数_9 (7, #., “备注”)
打开 (相加 (取运行目录 (), “\data\ryzl.edb”), , , , , , )
到首记录 ()
赋值 (., 相加 (取行数 (), 1))
.计次循环首 (取行数 (), 计次变量)
    计次变量.未知支持库函数_9 (0, #., 读 (“编号”))
    计次变量.未知支持库函数_9 (1, #., 读 (“姓名”))
    计次变量.未知支持库函数_9 (2, #., 读 (“性别”))
    计次变量.未知支持库函数_9 (3, #., 读 (“职务”))
    计次变量.未知支持库函数_9 (4, #., 读 (“身份证号”))
    计次变量.未知支持库函数_9 (5, #., 读 (“电话号码”))
    计次变量.未知支持库函数_9 (6, #., 读 (“家庭住址”))
    计次变量.未知支持库函数_9 (7, #., 读 (“备注”))
    跳过 ()
.计次循环尾 ()
关闭 (相加 (取运行目录 (), “\data\ryzl.edb”))
获取焦点 ()


.子程序 _按钮1_被单击, 空白型, , 
到尾记录 ()
赋值 (.只读, 假)
赋值 (.允许添加, 真)
赋值 (.允许删除, 真)
相加 (取记录号 (), 1).插入行 (1)
到尾记录 ()
赋值 (.禁止, 真)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
获取焦点 ()


.子程序 _按钮2_被单击, 空白型, , 
赋值 (.只读, 假)
赋值 (.允许添加, 假)
赋值 (.允许删除, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 假)


.子程序 _按钮3_被单击, 空白型, , 
.局部变量 返回值, 整数型, , , 

赋值 (返回值, 信息框 (“真的要删除这条记录吗？”, 4, ))
.如果真 (等于 (返回值, #是钮))
    赋值 (.只读, 假)
    赋值 (.允许添加, 假)
    赋值 (.允许删除, 真)
    未知支持库函数_3 ().删除行 (1)
    到尾记录 ()
    未知支持库函数_3 ().未知支持库函数_36 ()
.如果真结束



.子程序 _按钮4_被单击, 空白型, , 
.如果真 (等于 (.禁止, 真))
     ' 人员管理数据源.插入行 (人员管理数据源.取记录号 () ＋ 1, 1)
     ' 人员管理数据源.到尾记录 ()
    .未知支持库函数_38 ()
    赋值 (.禁止, 假)
    取行数 ().置文本 (1, .内容)
    取行数 ().置文本 (2, .内容)
    取行数 ().置文本 (3, .内容)
    取行数 ().置文本 (4, .内容)
    取行数 ().置文本 (5, .内容)
    取行数 ().置文本 (6, .内容)
    取行数 ().置文本 (7, .内容)
    取行数 ().置文本 (8, .内容)
    取记录号 ().未知支持库函数_9 (0, #., .内容)
    取记录号 ().未知支持库函数_9 (1, #., .内容)
    取记录号 ().未知支持库函数_9 (2, #., .内容)
    取记录号 ().未知支持库函数_9 (3, #., .内容)
    取记录号 ().未知支持库函数_9 (4, #., .内容)
    取记录号 ().未知支持库函数_9 (5, #., .内容)
    取记录号 ().未知支持库函数_9 (6, #., .内容)
    取记录号 ().未知支持库函数_9 (7, #., .内容)
    赋值 (.允许添加, 假)
    赋值 (.允许删除, 假)
    赋值 (.只读, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 假)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.如果真结束
.如果真 (等于 (.禁止, 真))
    未知支持库函数_3 ().跳到 ()
    赋值 (.禁止, 假)
    取记录号 ().置文本 (1, .内容)
    取记录号 ().置文本 (2, .内容)
    取记录号 ().置文本 (3, .内容)
    取记录号 ().置文本 (4, .内容)
    取记录号 ().置文本 (5, .内容)
    取记录号 ().置文本 (6, .内容)
    取记录号 ().置文本 (7, .内容)
    取记录号 ().置文本 (8, .内容)
    取记录号 ().未知支持库函数_9 (0, #., .内容)
    取记录号 ().未知支持库函数_9 (1, #., .内容)
    取记录号 ().未知支持库函数_9 (2, #., .内容)
    取记录号 ().未知支持库函数_9 (3, #., .内容)
    取记录号 ().未知支持库函数_9 (4, #., .内容)
    取记录号 ().未知支持库函数_9 (5, #., .内容)
    取记录号 ().未知支持库函数_9 (6, #., .内容)
    取记录号 ().未知支持库函数_9 (7, #., .内容)
    赋值 (.允许添加, 假)
    赋值 (.允许删除, 假)
    赋值 (.只读, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 假)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.如果真结束


.子程序 _按钮5_被单击, 空白型, , 
.局部变量 返回值, 整数型, , , 

.如果 (等于 (.禁止, 真))
    赋值 (返回值, 信息框 (“资料没有保存，真的要退出吗？”, 4, ))
    .如果 (等于 (返回值, #是钮))
        取记录号 ().删除行 (1)
        销毁 ()
    .否则
        
    .如果结束
    
.否则
    销毁 ()
.如果结束


.子程序 _高级表格1_被单击, 空白型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 

未知支持库函数_3 ().跳到 ()
赋值 (.内容, 未知支持库函数_3 ().取文本 (1))
赋值 (.内容, 未知支持库函数_3 ().取文本 (2))
赋值 (.内容, 未知支持库函数_3 ().取文本 (3))
赋值 (.内容, 未知支持库函数_3 ().取文本 (4))
赋值 (.内容, 未知支持库函数_3 ().取文本 (5))
赋值 (.内容, 未知支持库函数_3 ().取文本 (6))
赋值 (.内容, 未知支持库函数_3 ().取文本 (7))
赋值 (.内容, 未知支持库函数_3 ().取文本 (8))

.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _组合框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框3_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框4_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框5_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框6_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框7_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _高级表格1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (查询, 人员资料管理, 假)
.计次循环首 (8, 计次变量)
    查询.加入项目 (., 人员资料管理.未知支持库函数_10 (., 0, 相减 (计次变量, 1)), 相减 (计次变量, 1))
.计次循环尾 ()
赋值 (查询..现行选中项, 0)

.窗口程序集 窗口程序集42, , , 

.子程序 _单据折扣_创建完毕, 空白型, , 
赋值 (.标题, 业务操作..标题)
获取焦点 ()

.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.局部变量 折扣, 整数型, , , 
.局部变量 单价, 小数型, , , 
.局部变量 记录, 整数型, , , 

.如果真 (并且 (等于 (字符代码, #回车键), 不等于 (.内容, “”)))
    .计次循环首 (业务操作.取项目数 (.), 计次变量)
        赋值 (业务操作..标题, 到文本 (计次变量))
        打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
        到首记录 ()
        查找 (并且 (等于 (读 (“流水单号”), .标题), 查找 (并且 (等于 (读 (“商品编号”), 业务操作.未知支持库函数_10 (., 计次变量, 0)), 查找 (等于 (读 (“销售数量”), 业务操作.未知支持库函数_10 (., 计次变量, 3)))))))
        业务操作.跳到 (., 取记录号 ())
        .如果 (小于 (到数值 (.内容), 到数值 (业务操作.未知支持库函数_10 (., 计次变量, 6))))
            业务操作.置文本 (., 业务操作.取记录号 (.), 7, 到文本 (相乘 (到数值 (业务操作.未知支持库函数_10 (., 计次变量, 5)), 到数值 (相除 (到数值 (业务操作.未知支持库函数_10 (., 计次变量, 6)), 100)))))
        .否则
            业务操作.置文本 (., 业务操作.取记录号 (.), 7, 到文本 (相除 (相乘 (到数值 (业务操作.未知支持库函数_10 (., 计次变量, 5)), 到数值 (.内容)), 100)))
        .如果结束
        关闭 (相加 (取运行目录 (), “\data\xsls.edb”))
    .计次循环尾 ()
    .计次循环首 (业务操作.取项目数 (.), 计次变量)
        打开 (相加 (取运行目录 (), “\data\xslsss.edb”), , , , , , )
        到首记录 ()
        查找 (并且 (等于 (读 (“流水单号”), .标题), 查找 (并且 (等于 (读 (“商品编号”), 业务操作.未知支持库函数_10 (., 计次变量, 0)), 查找 (等于 (读 (“销售数量”), 业务操作.未知支持库函数_10 (., 计次变量, 3)))))))
        业务操作.跳到 (., 取记录号 ())
        .如果 (小于 (到数值 (.内容), 到数值 (业务操作.未知支持库函数_10 (., 计次变量, 6))))
            业务操作.置文本 (., 业务操作.取记录号 (.), 7, 到文本 (相乘 (到数值 (业务操作.未知支持库函数_10 (., 计次变量, 5)), 到数值 (相除 (到数值 (业务操作.未知支持库函数_10 (., 计次变量, 6)), 100)))))
        .否则
            业务操作.置文本 (., 业务操作.取记录号 (.), 7, 到文本 (相除 (相乘 (到数值 (业务操作.未知支持库函数_10 (., 计次变量, 5)), 到数值 (.内容)), 100)))
        .如果结束
        关闭 (相加 (取运行目录 (), “\data\xslsss.edb”))
    .计次循环尾 ()
    业务操作.未知支持库函数_57 (.)
    业务操作.清空 (.)
    业务操作.未知支持库函数_9 (., 0, 0, #., “商品编号”)
    业务操作.未知支持库函数_9 (., 0, 1, #., “商品名称”)
    业务操作.未知支持库函数_9 (., 0, 2, #., “单位”)
    业务操作.未知支持库函数_9 (., 0, 3, #., “销售数量”)
    业务操作.未知支持库函数_9 (., 0, 4, #., “单价”)
    业务操作.未知支持库函数_9 (., 0, 5, #., “总计”)
    业务操作.未知支持库函数_9 (., 0, 6, #., “折扣率”)
    打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
    到首记录 ()
    赋值 (业务操作.., 1)
    .判断循环首 (等于 (查找 (等于 (读 (“流水单号”), 业务操作..标题)), 真))
        业务操作.加入项目 (., 读 (“商品名称”), )
        业务操作.取项目数 (.)
        赋值 (业务操作.., 相加 (业务操作.取项目数 (.), 1))
        业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 0, #., 读 (“商品编号”))
        业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 1, #., 读 (“商品名称”))
        业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 2, #., 读 (“单位”))
        业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 3, #., 读 (“销售数量”))
        业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 4, #., 读 (“售价”))
        业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 5, #., 读 (“总计”))
        业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 6, #., 读 (“折扣率”))
        跳过 ()
    .判断循环尾 ()
    业务操作.未知支持库函数_38 (., , )
    业务操作.未知支持库函数_30 (., 5, #.)
    业务操作.未知支持库函数_41 (., 5, 2)
    业务操作.未知支持库函数_66 (., 5, 1, 相加 (业务操作.取项目数 (.), 1), )
    赋值 (业务操作..内容, 到文本 (求和 (到数值 (读 (“总计”)), 等于 (读 (“流水单号”), 业务操作..标题))))
    业务操作.未知支持库函数_9 (., 相加 (业务操作.取项目数 (.), 1), 4, #., “合计:”)
    业务操作.未知支持库函数_9 (., 相加 (业务操作.取项目数 (.), 1), 5, #., 业务操作..内容)
    业务操作.未知支持库函数_0 (., 相加 (业务操作.取项目数 (.), 1), 5)
    关闭 (相加 (取运行目录 (), “\data\xsls.edb”))
    业务操作.置文本 (., 业务操作.取记录号 (.), 16, .内容)
    业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 5, #., .内容)
    销毁 ()
.如果真结束


.窗口程序集 窗口程序集43, , , 

.子程序 _按钮1_被单击, 空白型, , 
打开 (相加 (取运行目录 (), “\data\ryzl.edb”), , , , , , )
到首记录 ()
.如果 (等于 (.内容, “等于”))
    .判断循环首 (查找 (等于 (读 (.内容), .内容)))
        人员资料管理.跳到 (., 取记录号 ())
        人员资料管理.未知支持库函数_0 (., 取记录号 (), 0)
        跳过 ()
    .判断循环尾 ()
.否则
    .判断循环首 (查找 (近似等于 (读 (.内容), .内容)))
        人员资料管理.跳到 (., 取记录号 ())
        人员资料管理.未知支持库函数_0 (., 取记录号 (), 0)
        跳过 ()
    .判断循环尾 ()
.如果结束
关闭 (相加 (取运行目录 (), “\data\ryzl.edb”))



.窗口程序集 窗口程序集44, , , 

.子程序 _卡输入_创建完毕, 空白型, , 
赋值 (.标题, 结帐操作..内容)
打开 (相加 (取运行目录 (), “\data\hykk.edb”), , , , , , )
到首记录 ()
.判断循环首 (查找 (等于 (读 (“会员卡号”), 到数值 (.标题))))
    赋值 (.标题, 读 (“卡密码”))
    跳过 ()
.判断循环尾 ()


.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.局部变量 折扣, 整数型, , , 

打开 (相加 (取运行目录 (), “\data\config.edb”), , , , , , )
赋值 (折扣, 读 (“小数金额”))
关闭 (相加 (取运行目录 (), “\data\config.edb”))
.如果 (并且 (等于 (字符代码, #回车键), 等于 (.内容, .标题)))
    打开 (相加 (取运行目录 (), “\data\hykk.edb”), , , , , , )
    到首记录 ()
    .计次循环首 (业务操作.取项目数 (.), 计次变量)
        赋值 (业务操作..标题, 到文本 (计次变量))
        打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
        到首记录 ()
        查找 (并且 (等于 (读 (“流水单号”), 结帐操作..内容), 查找 (并且 (等于 (读 (“商品编号”), 业务操作.未知支持库函数_10 (., 计次变量, 0)), 查找 (等于 (读 (“销售数量”), 业务操作.未知支持库函数_10 (., 计次变量, 3)))))))
        业务操作.跳到 (., 取记录号 ())
        .如果 (小于 (到数值 (结帐操作..内容), 到数值 (业务操作.未知支持库函数_10 (., 计次变量, 6))))
            业务操作.置文本 (., 业务操作.取记录号 (.), 7, 到文本 (四舍五入 (相乘 (到数值 (业务操作.未知支持库函数_10 (., 计次变量, 5)), 到数值 (相除 (到数值 (业务操作.未知支持库函数_10 (., 计次变量, 6)), 100))), 折扣)))
        .否则
            业务操作.置文本 (., 业务操作.取记录号 (.), 7, 到文本 (四舍五入 (相除 (相乘 (到数值 (业务操作.未知支持库函数_10 (., 计次变量, 5)), 到数值 (结帐操作..内容)), 100), 折扣)))
        .如果结束
        关闭 (相加 (取运行目录 (), “\data\xsls.edb”))
    .计次循环尾 ()
    .计次循环首 (业务操作.取项目数 (.), 计次变量)
        打开 (相加 (取运行目录 (), “\data\xslsss.edb”), , , , , , )
        到首记录 ()
        查找 (并且 (等于 (读 (“流水单号”), 结帐操作..内容), 查找 (并且 (等于 (读 (“商品编号”), 业务操作.未知支持库函数_10 (., 计次变量, 0)), 查找 (等于 (读 (“销售数量”), 业务操作.未知支持库函数_10 (., 计次变量, 3)))))))
        业务操作.跳到 (., 取记录号 ())
        .如果 (小于 (到数值 (结帐操作..内容), 到数值 (业务操作.未知支持库函数_10 (., 计次变量, 6))))
            业务操作.置文本 (., 业务操作.取记录号 (.), 7, 到文本 (四舍五入 (相乘 (到数值 (业务操作.未知支持库函数_10 (., 计次变量, 5)), 到数值 (相除 (到数值 (业务操作.未知支持库函数_10 (., 计次变量, 6)), 100))), 折扣)))
        .否则
            业务操作.置文本 (., 业务操作.取记录号 (.), 7, 到文本 (四舍五入 (相除 (相乘 (到数值 (业务操作.未知支持库函数_10 (., 计次变量, 5)), 到数值 (结帐操作..内容)), 100), 折扣)))
        .如果结束
        关闭 (相加 (取运行目录 (), “\data\xslsss.edb”))
    .计次循环尾 ()
    业务操作.未知支持库函数_57 (.)
    业务操作.清空 (.)
    业务操作.未知支持库函数_9 (., 0, 0, #., “商品编号”)
    业务操作.未知支持库函数_9 (., 0, 1, #., “商品名称”)
    业务操作.未知支持库函数_9 (., 0, 2, #., “单位”)
    业务操作.未知支持库函数_9 (., 0, 3, #., “销售数量”)
    业务操作.未知支持库函数_9 (., 0, 4, #., “单价”)
    业务操作.未知支持库函数_9 (., 0, 5, #., “总计”)
    业务操作.未知支持库函数_9 (., 0, 6, #., “折扣率”)
    打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
    到首记录 ()
    赋值 (业务操作.., 1)
    .判断循环首 (等于 (查找 (等于 (读 (“流水单号”), 业务操作..标题)), 真))
        业务操作.加入项目 (., 读 (“商品名称”), )
        业务操作.取项目数 (.)
        赋值 (业务操作.., 相加 (业务操作.取项目数 (.), 1))
        业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 0, #., 读 (“商品编号”))
        业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 1, #., 读 (“商品名称”))
        业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 2, #., 读 (“单位”))
        业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 3, #., 读 (“销售数量”))
        业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 4, #., 读 (“售价”))
        业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 5, #., 读 (“总计”))
        业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 6, #., 读 (“折扣率”))
        跳过 ()
    .判断循环尾 ()
    业务操作.未知支持库函数_38 (., , )
    业务操作.未知支持库函数_30 (., 5, #.)
    业务操作.未知支持库函数_41 (., 5, 2)
    业务操作.未知支持库函数_66 (., 5, 1, 相加 (业务操作.取项目数 (.), 1), )
    赋值 (业务操作..内容, 到文本 (求和 (到数值 (读 (“总计”)), 等于 (读 (“流水单号”), 业务操作..标题))))
    业务操作.未知支持库函数_9 (., 相加 (业务操作.取项目数 (.), 1), 4, #., “合计:”)
    业务操作.未知支持库函数_9 (., 相加 (业务操作.取项目数 (.), 1), 5, #., 业务操作..内容)
    业务操作.未知支持库函数_0 (., 相加 (业务操作.取项目数 (.), 1), 5)
    关闭 (相加 (取运行目录 (), “\data\xsls.edb”))
    业务操作.置文本 (., 业务操作.取记录号 (.), 16, 结帐操作..内容)
    业务操作.未知支持库函数_9 (., 业务操作.取项目数 (.), 5, #., 结帐操作..内容)
    结帐操作.清空 (.)
    结帐操作.未知支持库函数_57 (.)
    结帐操作.未知支持库函数_32 (., 0, 48)
    结帐操作.未知支持库函数_32 (., 1, 46)
    结帐操作.未知支持库函数_32 (., 2, 35)
    结帐操作.未知支持库函数_32 (., 3, 46)
    结帐操作.未知支持库函数_32 (., 4, 0)
    赋值 (结帐操作..内容, 业务操作..标题)
    赋值 (结帐操作..标题, 业务操作..内容)
    结帐操作.未知支持库函数_18 (., 0, 0, 相加 (结帐操作.取项目数 (.), 6), 4, 12)
    结帐操作.未知支持库函数_9 (., 0, 0, #., “品名”)
    结帐操作.未知支持库函数_9 (., 0, 1, #., “数量”)
    结帐操作.未知支持库函数_9 (., 0, 2, #., “单价”)
    结帐操作.未知支持库函数_9 (., 0, 3, #., “总计”)
    结帐操作.未知支持库函数_9 (., 0, 4, #., “编码”)
    打开 (相加 (取运行目录 (), “\data\xsls.edb”), , , , , , )
    到首记录 ()
    赋值 (结帐操作.., 2)
    .判断循环首 (等于 (查找 (等于 (读 (“流水单号”), 结帐操作..内容)), 真))
        结帐操作.加入项目 (., 读 (“商品编号”), )
        结帐操作.取项目数 (.)
        赋值 (结帐操作.., 相加 (结帐操作.取项目数 (.), 2))
        结帐操作.未知支持库函数_9 (., 结帐操作.取项目数 (.), 0, #., 取文本左边 (读 (“商品名称”), 13))
        结帐操作.未知支持库函数_9 (., 结帐操作.取项目数 (.), 1, #., 读 (“销售数量”))
        结帐操作.未知支持库函数_9 (., 结帐操作.取项目数 (.), 2, #., 读 (“售价”))
        结帐操作.未知支持库函数_9 (., 结帐操作.取项目数 (.), 3, #., 读 (“总计”))
        结帐操作.未知支持库函数_9 (., 结帐操作.取项目数 (.), 4, #., 读 (“商品编号”))
        跳过 ()
    .判断循环尾 ()
    结帐操作.未知支持库函数_38 (., , )
    结帐操作.未知支持库函数_58 (., 相加 (结帐操作.取项目数 (.), 1), 0, 相加 (结帐操作.取项目数 (.), 1), 3)
    结帐操作.未知支持库函数_9 (., 相加 (结帐操作.取项目数 (.), 1), 0, #., “****************************”)
    结帐操作.未知支持库函数_9 (., 相加 (结帐操作.取项目数 (.), 2), 0, #., “折扣:”)
    结帐操作.未知支持库函数_9 (., 相加 (结帐操作.取项目数 (.), 2), 1, #., 结帐操作..内容)
    结帐操作.未知支持库函数_9 (., 相加 (结帐操作.取项目数 (.), 2), 2, #., “合计:”)
    结帐操作.未知支持库函数_9 (., 相加 (结帐操作.取项目数 (.), 2), 3, #., 业务操作..内容)
    结帐操作.获取焦点 (.)
    结帐操作.未知支持库函数_18 (., 0, 0, 相加 (结帐操作.取项目数 (.), 6), 4, 12)
    结帐操作.未知支持库函数_25 (., 0, 1, 相加 (结帐操作.取项目数 (.), 1), 2, #.)
    结帐操作.未知支持库函数_25 (., 1, 3, 相加 (结帐操作.取项目数 (.), 1), 4, #.)
    结帐操作.未知支持库函数_30 (., 3, #.)
    结帐操作.未知支持库函数_41 (., 1, 2)
    结帐操作.未知支持库函数_41 (., 3, 2)
    关闭 (相加 (取运行目录 (), “\data\xsls.edb”))
    结帐操作.获取焦点 (.)
    销毁 ()
    结帐操作.获取焦点 (.)
.否则
    .如果真 (并且 (等于 (字符代码, #回车键), 不等于 (.标题, .标题)))
        信息框 (“密码错误！~~”, 0, )
        赋值 (.内容, “”)
        获取焦点 ()
    .如果真结束
    
.如果结束



 ' 不属于任何一个程序集、类模块的函数：
