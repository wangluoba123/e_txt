 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 267
    高度 = 76
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “玻璃特效PNG窗口”
    帮助文件名 = “”

窗口 流量 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 267
    高度 = 76
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 16711935 '  0xFF00FF
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 假
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\Win8_Pns.e\流量_图标.ico
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.图片 cool, " ' 已保存到：D:\易语言学习\Data\Win8_Pns.e\cool", , 
.图片 背景1, " ' 已保存到：D:\易语言学习\Data\Win8_Pns.e\背景1", , 
.图片 背景2, " ' 已保存到：D:\易语言学习\Data\Win8_Pns.e\背景2", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一



 ' 所需要的模块
 ' 彗星真彩控件 E:\autorun.inf\E语言\新的易语言源代码\彗星真彩控件模块.ec


数据类型 MIB_IFROW, , 
    .成员 dwInOctets, 整数型, , , 总共收到(字节)
    .成员 dwOutOctets, 整数型, , , 总共发送(字节)


.DLL命令 设置透明, 整数型, "", "SetLayeredWindowAttributes", , 
    .参数 hwnd, 整数型, , 
    .参数 crkey, 整数型, , 
    .参数 alpha, 字节型, , 
    .参数 dwflags, 整数型, , 

.DLL命令 取窗口风格, 整数型, "", "GetWindowLongA", , 
    .参数 hwnd, 整数型, , 
    .参数 nIndex, 整数型, , 

.DLL命令 设置窗口, 整数型, "", "SetWindowLongA", , 
    .参数 hwnd, 整数型, , 
    .参数 nIndex, 整数型, , 
    .参数 dwNewLong, 空白型, , 

.DLL命令 发送消息_, 整数型, "user32", "SendMessageA", , , 调用一个窗口的窗口函数，将一条消息发给那个窗口。除非消息处理完毕，否则该函数不会返回。SendMessageBynum， ;    SendMessageByString是该函数的“类型安全”声明形式  由具体的消息决定
    .参数 窗口句柄, 整数型, , 要接收消息的那个窗口的句柄
    .参数 信息值, 整数型, , 消息的标识符
    .参数 参数一, 逻辑型, , 具体取决于消息
    .参数 参数二, 整数型, , 具体取决于消息;

.DLL命令 取网络信息, 整数型, "iphlpapi", "GetIfTable", , 
    .参数 信息表, 字节集, 传址, 
    .参数 信息表尺寸, 整数型, 传址, 
    .参数 内参数, 整数型, , 

.DLL命令 API_GetActiveWindow, 整数型, "user32", "GetActiveWindow", , 

.DLL命令 SetCapture, 整数型, "", "SetCapture", , 
    .参数 Hwnd, 整数型, , 

.DLL命令 ReleaseCapture, 整数型, "", "ReleaseCapture", , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 真彩窗口, 真彩窗口, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
真彩窗口.从句柄创建 (_启动窗口.取窗口句柄 ())
真彩窗口.置图片数据 (#cool)
真彩窗口.刷新子控件 ()
载入 (流量, , 假)
 ' _启动窗口.移动 (相减 (取屏幕宽度 (), 267), 相减 (取屏幕高度 (), 110), 267, 76)

.子程序 __启动窗口_位置被改变, 空白型, , 
.如果真 (等于 (是否已创建 (流量), 真))
    流量.移动 (_启动窗口., _启动窗口., , )
.如果真结束


.类模块 真彩图片框, , , By:(彬)泪闯天涯

.子程序 置提示文本, 空白型, , 
.参数 提示文本内容, 文本型, , 
.参数 跟随鼠标, 逻辑型, 可空, 



.子程序 移动, 空白型, , 英文名称：move,改变窗口或窗口组件的位置或尺寸。
.参数 左边, 整数型, 可空, 单位为像素点。如被省略则不改变左边原位置。
.参数 顶边, 整数型, 可空, 单位为像素点。如被省略则不改变顶边原位置。
.参数 宽度, 整数型, 可空, 单位为像素点。如被省略则不改变宽度原位置。
.参数 高度, 整数型, 可空, 单位为像素点。如被省略则不改变高度原位置。
.参数 禁止重绘, 逻辑型, 可空, 



.子程序 取窗口句柄, 整数型, , 


.子程序 是否已创建, 逻辑型, , 


.子程序 重画, 空白型, , 英文名称：invalidate,通知 Windows 系统本窗口或窗口组件上的显示内容需要在以后被全部重画。本命令为初级对象成员命令。


.子程序 发送消息, 整数型, , 
.参数 wMsg, 整数型, , 消息的标识符
.参数 wParam, 整数型, , 具体取决于消息
.参数 lParam, 整数型, , 具体取决于消息;



.子程序 创建, 整数型, , 动态创建一个“真彩图片框”控件，创建成功返回窗口句柄，失败返回0
.参数 父窗口句柄, 整数型, , 
.参数 左边, 整数型, , 
.参数 顶边, 整数型, , 
.参数 宽度, 整数型, , 
.参数 高度, 整数型, , 



.子程序 从句柄创建, 空白型, , 从现有控件创建一个“真彩图片框”
.参数 窗口句柄, 整数型, , 
.参数 图片句柄, 整数型, 可空, 可通过“真彩控件_载入图片”或“真彩控件_载入内存图片”取得图片句柄



.子程序 置图片, 空白型, , 
.参数 图片句柄, 整数型, 可空, 



.子程序 置图片数据, 空白型, , 
.参数 图片字节集, 字节集, , 



.子程序 置显示方式, 空白型, , 指定图片框上图片的显示方式。0.图片居左上,1.缩放图片,2.图片居中
.参数 显示方式, 整数型, , 0.图片居左上,1.缩放图片,2.图片居中



.类模块 真彩按钮, , , By:(彬)泪闯天涯

.子程序 置提示文本, 空白型, , 
.参数 提示文本内容, 文本型, , 
.参数 跟随鼠标, 逻辑型, 可空, 



.子程序 移动, 空白型, , 英文名称：move,改变窗口或窗口组件的位置或尺寸。
.参数 左边, 整数型, 可空, 单位为像素点。如被省略则不改变左边原位置。
.参数 顶边, 整数型, 可空, 单位为像素点。如被省略则不改变顶边原位置。
.参数 宽度, 整数型, 可空, 单位为像素点。如被省略则不改变宽度原位置。
.参数 高度, 整数型, 可空, 单位为像素点。如被省略则不改变高度原位置。
.参数 禁止重绘, 逻辑型, 可空, 



.子程序 取窗口句柄, 整数型, , 


.子程序 是否已创建, 逻辑型, , 


.子程序 重画, 空白型, , 英文名称：invalidate,通知 Windows 系统本窗口或窗口组件上的显示内容需要在以后被全部重画。本命令为初级对象成员命令。


.子程序 发送消息, 整数型, , 
.参数 wMsg, 整数型, , 消息的标识符
.参数 wParam, 整数型, , 具体取决于消息
.参数 lParam, 整数型, , 具体取决于消息;



.子程序 创建, 整数型, , 动态创建一个“真彩按钮”控件，创建成功返回窗口句柄，失败返回0
.参数 父窗口句柄, 整数型, , 
.参数 左边, 整数型, , 
.参数 顶边, 整数型, , 
.参数 宽度, 整数型, , 
.参数 高度, 整数型, , 
.参数 标题, 文本型, 可空, 



.子程序 从句柄创建, 空白型, , 从现有控件创建一个“真彩按钮”
.参数 窗口句柄, 整数型, , 
.参数 图片句柄, 整数型, 可空, 设置按钮默认状态下的图片句柄，可通过“真彩控件_载入图片”或“真彩控件_载入内存图片”取得图片句柄



.子程序 置图片, 空白型, , 
.参数 正常图片, 整数型, 可空, 
.参数 点燃图片, 整数型, 可空, 
.参数 按下图片, 整数型, 可空, 
.参数 禁止图片, 整数型, 可空, 



.子程序 置图片数据, 空白型, , 
.参数 正常图片, 字节集, 可空, 
.参数 点燃图片, 字节集, 可空, 
.参数 按下图片, 字节集, 可空, 
.参数 禁止图片, 字节集, 可空, 



.子程序 置显示方式, 空白型, , 指定按钮图片的显示方式。0.图片居左上,1.缩放图片,2.图片居中
.参数 显示方式, 整数型, , 0.图片居左上,1.缩放图片,2.图片居中



.类模块 真彩窗口, , , By:(彬)泪闯天涯

.子程序 从句柄创建, 逻辑型, , 
.参数 窗口句柄, 整数型, , 



.子程序 置图片, 逻辑型, , 设置一个PNG图片当窗口外形，支持透明通道。注意：设置之后子控件将无法显示
.参数 图片句柄, 整数型, , 可通过“真彩控件_载入图片”或“真彩控件_载入内存图片”取得图片句柄



.子程序 置图片数据, 逻辑型, , 
.参数 图片字节集, 字节集, , 



.子程序 刷新子控件, 空白型, , 


.子程序 移动, 空白型, , 英文名称：move,改变窗口或窗口组件的位置或尺寸。
.参数 左边, 整数型, 可空, 单位为像素点。如被省略则不改变左边原位置。
.参数 顶边, 整数型, 可空, 单位为像素点。如被省略则不改变顶边原位置。
.参数 宽度, 整数型, 可空, 单位为像素点。如被省略则不改变宽度原位置。
.参数 高度, 整数型, 可空, 单位为像素点。如被省略则不改变高度原位置。
.参数 禁止重绘, 逻辑型, 可空, 



.子程序 取窗口句柄, 整数型, , 


.子程序 是否已创建, 逻辑型, , 


.子程序 发送消息, 整数型, , 
.参数 wMsg, 整数型, , 消息的标识符
.参数 wParam, 整数型, , 具体取决于消息
.参数 lParam, 整数型, , 具体取决于消息;



.类模块 真彩编辑框, , , 暂时只支持单行文本。By:(彬)泪闯天涯

.子程序 置提示文本, 空白型, , 
.参数 提示文本内容, 文本型, , 
.参数 跟随鼠标, 逻辑型, 可空, 



.子程序 移动, 空白型, , 英文名称：move,改变窗口或窗口组件的位置或尺寸。
.参数 左边, 整数型, 可空, 单位为像素点。如被省略则不改变左边原位置。
.参数 顶边, 整数型, 可空, 单位为像素点。如被省略则不改变顶边原位置。
.参数 宽度, 整数型, 可空, 单位为像素点。如被省略则不改变宽度原位置。
.参数 高度, 整数型, 可空, 单位为像素点。如被省略则不改变高度原位置。
.参数 禁止重绘, 逻辑型, 可空, 



.子程序 取窗口句柄, 整数型, , 


.子程序 是否已创建, 逻辑型, , 


.子程序 重画, 空白型, , 英文名称：invalidate,通知 Windows 系统本窗口或窗口组件上的显示内容需要在以后被全部重画。本命令为初级对象成员命令。


.子程序 发送消息, 整数型, , 
.参数 wMsg, 整数型, , 消息的标识符
.参数 wParam, 整数型, , 具体取决于消息
.参数 lParam, 整数型, , 具体取决于消息;



.子程序 从句柄创建, 空白型, , 从现有控件创建一个“真彩按钮”
.参数 窗口句柄, 整数型, , 



.子程序 置背景颜色, 空白型, , 
.参数 背景颜色, 整数型, , -1为透明背景，否则为RGB颜色值
.参数 背景透明度, 整数型, 可空, 0-255



.子程序 置边框颜色, 空白型, , 
.参数 边框颜色, 整数型, , -1为透明边框，否则为RGB颜色值
.参数 边框透明度, 整数型, 可空, 0-255



.子程序 置文本颜色, 空白型, , 
.参数 文本颜色, 整数型, , RGB颜色值



.子程序 置背景图片, 空白型, , 
.参数 图片句柄, 整数型, 可空, 



.子程序 置背景图片数据, 空白型, , 
.参数 图片字节集, 字节集, , 



.子程序 置底图方式, 空白型, , 指定图片框上图片的显示方式。0.图片居左上,1.缩放图片,2.图片居中
.参数 底图方式, 整数型, , 0.图片居左上,1.缩放图片,2.图片居中



.子程序 取内容, 文本型, , 


.类模块 真彩动画窗口, , , 

.子程序 创建, 逻辑型, , 
.参数 图片数据, 字节集, 可空, 用来当背景的图片，支持动态GIF、PNG、JPG、BMP，支持背景透明
.参数 父窗口句柄, 整数型, 可空, 参数值指定欲载入窗口的父窗口，父窗口必须已经被创建。如果本参数被省略，表示无父窗口。如果窗口具有父窗口，其位置将永远位于父窗口的上面；当父窗口被关闭时，窗口将自动被关闭。
.参数 窗口位置, 整数型, 可空, 0.相对屏幕居中,1.相对桌面工作区域居中, 2.相对父窗口居中



.子程序 销毁, 空白型, , 


.子程序 取宽度, 整数型, , 


.子程序 取高度, 整数型, , 


.子程序 取窗口句柄, 整数型, , 


.子程序 是否已创建, 逻辑型, , 


.子程序 移动, 空白型, , 英文名称：move,改变窗口或窗口组件的位置或尺寸。
.参数 左边, 整数型, 可空, 单位为像素点。如被省略则不改变左边原位置。
.参数 顶边, 整数型, 可空, 单位为像素点。如被省略则不改变顶边原位置。
.参数 宽度, 整数型, 可空, 单位为像素点。如被省略则不改变宽度原位置。
.参数 高度, 整数型, 可空, 单位为像素点。如被省略则不改变高度原位置。
.参数 禁止重绘, 逻辑型, 可空, 



.子程序 居中显示, 空白型, , 移动窗口，相对于屏幕或桌面、父窗口居中显示
.参数 相对位置, 整数型, , 0.相对屏幕居中,1.相对桌面工作区域居中, 2.相对父窗口居中



.子程序 取窗口尺寸, 空白型, , 取窗口的宽度和高度
.参数 宽度, 整数型, 参考, 
.参数 高度, 整数型, 参考, 



.子程序 随意移动, 逻辑型, , 英文名称为“HitMove”,当用户在窗口上任何位置按下鼠标左键后是否进入窗口整体移动模式。
.参数 是否随意移动, 逻辑型, 可空, 



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 真彩控件_载入图片, 整数型, , 载入指定图片，成功返回图片句柄，失败返回0
.参数 欲被载入的图片, 文本型, , 图片文件名



.子程序 真彩控件_载入内存图片, 整数型, , 载入指定图片，成功返回图片句柄，失败返回0
.参数 欲被载入的图片, 字节集, , 图片数据



.子程序 真彩控件_销毁图片, 空白型, , 
.参数 图片句柄, 整数型, , 



.窗口程序集 窗口程序3, , , 

.程序集变量 信息记录, MIB_IFROW, , "0", 
.程序集变量 原接收总计, 整数型, , , 
.程序集变量 原发送总计, 整数型, , , 
.程序集变量 接收进度条句柄, 整数型, , , 
.程序集变量 发送进度条句柄, 整数型, , , 
.程序集变量 总流量, 小数型, , , 
.程序集变量 总下载流量, 小数型, , , 
.程序集变量 总上传流量, 小数型, , , 
.子程序 _流量_创建完毕, 空白型, , 
设置窗口 (取窗口句柄 (), -20, 位或 (取窗口风格 (取窗口句柄 (), -20), 524288))
设置透明 (取窗口句柄 (), #品红, 200, 1)

.子程序 计算流量, 空白型, , 
.参数 监控编号, 整数型, , 

.局部变量 发送速率, 整数型, , , 
.局部变量 接收速率, 整数型, , , 
.局部变量 整数容器, 整数型, , , 
.局部变量 接收, 文本型, , , 
.局部变量 发送, 文本型, , , 
.局部变量 已上传流量, 文本型, , , 
.局部变量 已下载流量, 文本型, , , 
.局部变量 合计总流量, 文本型, , , 

.如果真 (等于 (原接收总计, 0))
    赋值 (原接收总计, 信息记录 [监控编号], dwInOctets)
.如果真结束
赋值 (接收速率, 相减 (信息记录 [监控编号], dwInOctets, 原接收总计))
赋值 (接收, 数值到格式文本 (相除 (接收速率, 1024), 1, 假))
赋值 (原接收总计, 信息记录 [监控编号], dwInOctets)
赋值 (., 相加 (到文本 (接收), “KB/s”))

.如果真 (等于 (原发送总计, 0))
    赋值 (原发送总计, 信息记录 [监控编号], dwOutOctets)
.如果真结束
赋值 (发送速率, 相减 (信息记录 [监控编号], dwOutOctets, 原发送总计))
赋值 (发送, 数值到格式文本 (相除 (发送速率, 1024), 1, 假))
赋值 (原发送总计, 信息记录 [监控编号], dwOutOctets)
赋值 (., 相加 (到文本 (发送), “KB/s”))


.子程序 _时钟1_周期事件, 空白型, , 
取信息记录 ()
计算流量 (2)

.子程序 取信息记录, 空白型, , 
.局部变量 成员数, 整数型, , , 
.局部变量 信息集, 字节集, , , 
.局部变量 缓冲区尺寸, 整数型, , , 
.局部变量 起始位, 整数型, , , 
.局部变量 整数容器, 整数型, , , 

取网络信息 ({ 0 }, 缓冲区尺寸, 0)
.如果真 (小于或等于 (缓冲区尺寸, 0))
    返回 ()
.如果真结束
赋值 (信息集, 取空白字节集 (缓冲区尺寸))
.如果真 (不等于 (取网络信息 (信息集, 缓冲区尺寸, 1), 0))
    返回 ()
.如果真结束
赋值 (成员数, 取字节集数据 (取字节集左边 (信息集, 4), #整数型, ))
赋值 (信息集, 取字节集右边 (信息集, 相减 (缓冲区尺寸, 4)))
重定义数组 (信息记录, 假, 成员数)
.计次循环首 (成员数, 整数容器)
    赋值 (起始位, 相乘 (相减 (整数容器, 1), 860))
    赋值 (信息记录 [整数容器], dwInOctets, 取字节集数据 (取字节集中间 (信息集, 相加 (起始位, 553), 4), #整数型, ))
    赋值 (信息记录 [整数容器], dwOutOctets, 取字节集数据 (取字节集中间 (信息集, 相加 (起始位, 577), 4), #整数型, ))
.计次循环尾 ()


 ' 不属于任何一个程序集、类模块的函数：
