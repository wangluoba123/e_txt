 ' 文件类型：Windows窗口程序

 ' 程序名称：三轴雕刻机控制软件
 ' 程序描述：
 ' 程序作者：高再校
 ' 邮政编码：315321
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：gzy8@sina.com
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “三轴雕刻机控制软件V1.0”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 452
    高度 = 336
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于三轴雕刻机控制软件”
    帮助文件名 = “”

窗口 端口设置
    左边 = 50
    顶边 = 50
    宽度 = 459
    高度 = 320
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “端口设置”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 450
    高度 = 361
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 2
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.图片 封面图片, " ' 已保存到：D:\易语言学习\Data\三轴雕刻机控制软件v1.1.e\封面图片", , 为在封面窗口上显示的图片数据
.常量 封面显示秒数, "5", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库
 ' spec A512548E76954B6E92C21055517615B0 2 1 特殊功能支持库
 ' iext5 {E5000198-4471-40e2-92BC-D0BA075BDBB2} 1 5 扩展界面支持库五
 ' EdirectX 81690053A86045bf9E362F5DE0BC4095 1 5 DirectX支持库




数据类型 Large_Integer, , 
    .成员 低位, 长整数型, , , 
    .成员 高位, 长整数型, , , 

.全局变量 X方向, 整数型, , , 
.全局变量 X反相, 整数型, , , 
.全局变量 X脉冲数, 整数型, , , 
.全局变量 Y步进, 整数型, , , 
.全局变量 Y方向, 整数型, , , 
.全局变量 Y反相, 整数型, , , 
.全局变量 Y脉冲数, 整数型, , , 
.全局变量 Z步进, 整数型, , , 
.全局变量 Z方向, 整数型, , , 
.全局变量 Z反相, 整数型, , , 
.全局变量 Z脉冲数, 整数型, , , 
.全局变量 并口地址, 整数型, , , 
.全局变量 配置文件名, 文本型, , , 
.全局变量 节名数组, 文本型, , "0", 
.全局变量 局部计次变量, 整数型, , , 
.全局变量 X步进, 整数型, , , 
.全局变量 最大进给速度, 整数型, , , 
.全局变量 最大铣削速度, 整数型, , , 

.DLL命令 并行口输出, 空白型, "IO.DLL", "PortOut", , 
    .参数 Port, 短整数型, , 
    .参数 Data, 字节型, , 

.DLL命令 并行口输入, 字节型, "IO.DLL", "PortIn", , 
    .参数 Port, 短整数型, , 

.DLL命令 并行口置位, 空白型, "IO.DLL", "SetPortBit", , 
    .参数 Port, 短整数型, , 
    .参数 Bit, 字节型, , 

.DLL命令 并行口清位, 空白型, "IO.DLL", "ClrPortBit", , 
    .参数 Port, 短整数型, , 
    .参数 Bit, 字节型, , 

.DLL命令 并行口取位, 短整数型, "IO.DLL", "GetPortBit", , 
    .参数 Port, 短整数型, , 
    .参数 Bit, 字节型, , 

.DLL命令 并行口位否, 空白型, "IO.DLL", "NotPortBit", , 
    .参数 Port, 短整数型, , 
    .参数 Bit, 字节型, , 

.DLL命令 并行口位右移, 短整数型, "IO.DLL", "RightPortShift", , 
    .参数 Port, 短整数型, , 
    .参数 Val, 短整数型, , 

.DLL命令 并行口位左移, 短整数型, "IO.DLL", "LeftPortShift", , 
    .参数 Port, 短整数型, , 
    .参数 Val, 短整数型, , 

.DLL命令 取定时器频率, 整数型, "kernel32.dll", "QueryPerformanceFrequency", , 
    .参数 lpFrequency, Large_Integer, , 

.DLL命令 取定时器当前值, 整数型, "kernel32.dll", "QueryPerformanceCounter", , 
    .参数 lpFrequency, Large_Integer, , 

.窗口程序集 启动窗口程序集, , , 

.程序集变量 跳出变量, 逻辑型, , , 
.程序集变量 文本, 文本型, , "0", 
.程序集变量 待分割文本, 文本型, , , 
.程序集变量 取文本行数, 整数型, , , 
.程序集变量 X轴起点, 小数型, , , 
.程序集变量 Y轴起点, 小数型, , , 
.程序集变量 Z轴起点, 小数型, , , 
.程序集变量 X轴, 小数型, , , 
.程序集变量 Y轴, 小数型, , , 
.程序集变量 Z轴, 小数型, , , 
.程序集变量 文件号, 整数型, , , 
.程序集变量 显示比例, 小数型, , , 
.程序集变量 偏差, 整数型, , , 
.程序集变量 x终点, 整数型, , , 
.程序集变量 y终点, 整数型, , , 
.程序集变量 x动点, 整数型, , , 
.程序集变量 y动点, 整数型, , , 
.程序集变量 总步数, 整数型, , , 
.程序集变量 颜色, 整数型, , , 
.程序集变量 X步数, 整数型, , , 
.程序集变量 Y步数, 整数型, , , 
.程序集变量 x动点1, 整数型, , , 
.程序集变量 y动点1, 整数型, , , 
.程序集变量 z动点1, 整数型, , , 
.程序集变量 Z步数, 整数型, , , 
.程序集变量 步进脉宽, 整数型, , , 
.程序集变量 X每步, 小数型, , , 
.程序集变量 Y每步, 小数型, , , 
.程序集变量 Z每步, 小数型, , , 
.程序集变量 G代码比例, 小数型, , , 
.程序集变量 单步距离, 小数型, , , 
.程序集变量 显示横向位移, 整数型, , , 
.程序集变量 显示纵向位移, 整数型, , , 
.程序集变量 老水平, 整数型, , , 
.程序集变量 老垂直, 整数型, , , 
.程序集变量 x起点, 整数型, , , 
.程序集变量 y起点, 整数型, , , 
.程序集变量 物体标识, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
载入 (窗口1, _启动窗口, 真)
初始化 ()
取窗口句柄 ().未知支持库函数_14 ()
10.未知支持库函数_38 ()
.未知支持库函数_20 (“此处可以直接输入G代码，按回车键即运行”, -1, , , , )
.未知支持库函数_20 (“按此键即运行G代码”, -1, , , , )
赋值 (物体标识, .未知支持库函数_35 (0, 相减 (相除 (.最大位置, 2), 32), , ))

.子程序 初始化, 空白型, , 
未知支持库函数_0 (#)
赋值 (配置文件名, 相加 (取运行目录 (), “\CNC.ini”))
.如果真 (等于 (文件是否存在 (配置文件名), 真))
    赋值 (节名数组, 取配置节名 (配置文件名))
    .计次循环首 (取数组成员数 (节名数组), 局部计次变量)
        .如果真 (等于 (节名数组 [局部计次变量], “端口设置”))
            赋值 (并口地址, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “并口地址”, )))
            赋值 (X步进, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “X步进”, )))
            赋值 (X方向, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “X方向”, )))
            赋值 (X反相, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “X反相”, )))
            赋值 (X脉冲数, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “X脉冲数”, )))
            赋值 (Y步进, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “Y步进”, )))
            赋值 (Y方向, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “Y方向”, )))
            赋值 (Y反相, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “Y反相”, )))
            赋值 (Y脉冲数, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “Y脉冲数”, )))
            赋值 (Z步进, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “Z步进”, )))
            赋值 (Z方向, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “Z方向”, )))
            赋值 (Z反相, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “Z反相”, )))
            赋值 (Z脉冲数, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “Z脉冲数”, )))
            赋值 (最大进给速度, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “最大进给速度”, )))
            赋值 (最大铣削速度, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “最大铣削速度”, )))
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
.如果真结束
赋值 (X轴起点, 0)
赋值 (Y轴起点, 0)
赋值 (.标题, “0.0000”)
赋值 (.标题, “0.0000”)
赋值 (.标题, “0.0000”)
赋值 (.标题, “显示比例:10%”)
赋值 (G代码比例, 1)
赋值 (显示比例, 0.1)
赋值 (步进脉宽, 相乘 (相除 (1, 相乘 (相除 (最大进给速度, 60), X脉冲数)), 100000))
赋值 (.内容, “1”)
赋值 (.内容, “0.01”)
赋值 (单步距离, 到数值 (.内容))
赋值 (X每步, 四舍六入 (相除 (1, X脉冲数), 5))
赋值 (Y每步, 四舍六入 (相除 (1, Y脉冲数), 5))
赋值 (Z每步, 四舍六入 (相除 (1, Z脉冲数), 5))
赋值 (x动点1, 0)
赋值 (y动点1, 0)
赋值 (z动点1, 0)
赋值 (显示横向位移, 相除 (.宽度, 2))
赋值 (显示纵向位移, 相除 (.高度, 2))
赋值 (老水平, 0)
赋值 (老垂直, 0)

.子程序 _关于_被选择, 空白型, , 
载入 (关于窗口, , 真)


.子程序 __启动窗口_被激活, 空白型, , 
假.未知支持库函数_35 (真, 假)

.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.如果真 (等于 (按钮索引, 0))
    打开 ()
    关闭文件 (文件号)
    清除数组 (文本)
    赋值 (.内容, .文件名)
    赋值 (文件号, 打开文件 (.文件名, , ))
    赋值 (取文本行数, 1)
    重画 ()
    赋值 (_启动窗口., 相加 (“三轴雕刻机控制软件V1.0   - ”, .文件名))
    赋值 (老水平, 0)
    赋值 (老垂直, 0)
.如果真结束
.如果真 (等于 (按钮索引, 3))
    .如果真 (小于 (.位置, 150))
        赋值 (.位置, 相加 (.位置, 1))
        _滑块条2_位置被改变 ()
    .如果真结束
    
.如果真结束
.如果真 (等于 (按钮索引, 4))
    .如果真 (大于 (.位置, 1))
        赋值 (.位置, 相减 (.位置, 1))
        _滑块条2_位置被改变 ()
    .如果真结束
    
.如果真结束
.如果真 (等于 (按钮索引, 6))
    载入 (端口设置, _启动窗口, 真)
.如果真结束


.子程序 _打开_被选择, 空白型, , 
打开 ()
关闭文件 (文件号)
清除数组 (文本)
赋值 (.内容, .文件名)
赋值 (文件号, 打开文件 (.文件名, , ))
赋值 (取文本行数, 1)
重画 ()
赋值 (_启动窗口., 相加 (“三轴雕刻机控制软件V1.0  - ”, .文件名))
赋值 (老水平, 0)
赋值 (老垂直, 0)

.子程序 _按钮7_被单击, 空白型, , 
.判断循环首 (不等于 (.内容, “M2”))
    .如果真 (等于 (.内容, “”))
        跳出循环 ()
    .如果真结束
    赋值 (待分割文本, 读入一行 (文件号))
    加入成员 (文本, 分割文本 (待分割文本, #换行符, ))
    赋值 (.内容, “”)
    文本.加入文本 ( [取文本行数], 相加 (“ ”, #换行符))
    赋值 (.内容, 到文本 (取文本行数))
    赋值 (取文本行数, 相加 (取文本行数, 1))
    赋值 (X轴起点, X轴)
    赋值 (Y轴起点, Y轴)
    赋值 (Z轴起点, Z轴)
    G代码解析 ()
    插补 ()
    处理事件 ()
    .如果真 (等于 (跳出变量, 真))
        跳出循环 ()
    .如果真结束
    赋值 (.标题, 数值到格式文本 (X轴, 4, 假))
    赋值 (.标题, 数值到格式文本 (Y轴, 4, 假))
    赋值 (.标题, 数值到格式文本 (Z轴, 4, 假))
.判断循环尾 ()
赋值 (跳出变量, 假)


.子程序 插补, 空白型, , 
赋值 (x起点, 四舍六入 (相除 (相乘 (X轴起点, G代码比例), X每步), 0))
赋值 (y起点, 四舍六入 (相除 (相乘 (Y轴起点, G代码比例), Y每步), 0))
赋值 (x终点, 四舍六入 (相除 (相乘 (X轴, G代码比例), X每步), 0))
赋值 (y终点, 四舍六入 (相除 (相乘 (Y轴, G代码比例), Y每步), 0))
.如果真 (等于 (插补象限 (), 1))
    第一象限插补 ()
.如果真结束
.如果真 (等于 (插补象限 (), 2))
    第二象限插补 ()
.如果真结束
.如果真 (等于 (插补象限 (), 3))
    第三象限插补 ()
.如果真结束
.如果真 (等于 (插补象限 (), 4))
    第四象限插补 ()
.如果真结束
赋值 (Z步数, 四舍六入 (相除 (取绝对值 (相减 (Z轴, Z轴起点)), Z每步), 0))
Z轴插补 ()
返回 ()

.子程序 _按钮8_被单击, 空白型, , 
赋值 (跳出变量, 真)
返回 ()


.子程序 X轴正转, 空白型, , 
赋值 (x动点1, 相加 (x动点1, 1))
处理事件 ()
.如果 (等于 (X反相, 1))
    并行口置位 (并口地址, 相减 (X方向, 2))
.否则
    并行口清位 (并口地址, 相减 (X方向, 2))
.如果结束
并行口清位 (并口地址, 相减 (X步进, 2))
精度延时 (步进脉宽)
显示 ()
并行口位否 (并口地址, 相减 (X步进, 2))
精度延时 (步进脉宽)
赋值 (.标题, 数值到格式文本 (相乘 (x动点1, X每步), 4, 假))
返回 ()

.子程序 X轴反转, 空白型, , 
赋值 (x动点1, 相减 (x动点1, 1))
处理事件 ()
.如果 (等于 (X反相, 1))
    并行口清位 (并口地址, 相减 (X方向, 2))
.否则
    并行口置位 (并口地址, 相减 (X方向, 2))
.如果结束
并行口清位 (并口地址, 相减 (X步进, 2))
精度延时 (步进脉宽)
显示 ()
并行口位否 (并口地址, 相减 (X步进, 2))
精度延时 (步进脉宽)
赋值 (.标题, 数值到格式文本 (相乘 (x动点1, X每步), 4, 假))
返回 ()

.子程序 Y轴正转, 空白型, , 
赋值 (y动点1, 相加 (y动点1, 1))
处理事件 ()
.如果 (等于 (Y反相, 1))
    并行口清位 (并口地址, 相减 (Y方向, 2))
.否则
    并行口置位 (并口地址, 相减 (Y方向, 2))
.如果结束
并行口清位 (并口地址, 相减 (Y步进, 2))
精度延时 (步进脉宽)
显示 ()
并行口位否 (并口地址, 相减 (Y步进, 2))
精度延时 (步进脉宽)
赋值 (.标题, 数值到格式文本 (相乘 (y动点1, Y每步), 4, 假))
返回 ()

.子程序 Y轴反转, 空白型, , 
赋值 (y动点1, 相减 (y动点1, 1))
处理事件 ()
.如果 (等于 (Y反相, 1))
    并行口置位 (并口地址, 相减 (Y方向, 2))
.否则
    并行口清位 (并口地址, 相减 (Y方向, 2))
.如果结束
并行口清位 (并口地址, 相减 (Y步进, 2))
精度延时 (步进脉宽)
显示 ()
并行口位否 (并口地址, 相减 (Y步进, 2))
精度延时 (步进脉宽)
赋值 (.标题, 数值到格式文本 (相乘 (y动点1, Y每步), 4, 假))
返回 ()

.子程序 Z轴正转, 空白型, , 
赋值 (z动点1, 相加 (z动点1, 1))
处理事件 ()
.如果 (等于 (Z反相, 1))
    并行口清位 (并口地址, 相减 (Z方向, 2))
.否则
    并行口置位 (并口地址, 相减 (Z方向, 2))
.如果结束
并行口清位 (并口地址, 相减 (Z步进, 2))
精度延时 (步进脉宽)
赋值 (.位置, 相减 (相除 (.最大位置, 2), 四舍六入 (相乘 (z动点1, Z每步), 0)))
并行口位否 (并口地址, 相减 (Z步进, 2))
精度延时 (步进脉宽)
赋值 (.标题, 数值到格式文本 (相乘 (z动点1, Z每步), 4, 假))
物体标识.未知支持库函数_56 (0, 相减 (相除 (.最大位置, 2), 32, 四舍六入 (相乘 (z动点1, Z每步), 0)), )
返回 ()

.子程序 Z轴反转, 空白型, , 
赋值 (z动点1, 相减 (z动点1, 1))
处理事件 ()
.如果 (等于 (Z反相, 1))
    并行口置位 (并口地址, 相减 (Z方向, 2))
.否则
    并行口清位 (并口地址, 相减 (Z方向, 2))
.如果结束
并行口清位 (并口地址, 相减 (Z步进, 2))
精度延时 (步进脉宽)
赋值 (.位置, 相减 (相除 (.最大位置, 2), 四舍六入 (相乘 (z动点1, Z每步), 0)))
并行口位否 (并口地址, 相减 (Z步进, 2))
精度延时 (步进脉宽)
赋值 (.标题, 数值到格式文本 (相乘 (z动点1, Z每步), 4, 假))
物体标识.未知支持库函数_56 (0, 相减 (相除 (.最大位置, 2), 32, 四舍六入 (相乘 (z动点1, Z每步), 0)), )
返回 ()

.子程序 G代码解析, 空白型, , 
.局部变量 文本1, 文本型, , "0", 
.局部变量 取文本行数1, 整数型, , , 
.局部变量 待分割文本1, 文本型, , , 
.局部变量 文本长度, 整数型, , , 
.局部变量 已分割文本, 文本型, , , 
.局部变量 文本起始位, 整数型, , , 

赋值 (取文本行数1, 1)
.判断循环首 (不等于 (已分割文本, #换行符))
    赋值 (待分割文本1, .内容)
    加入成员 (文本1, 分割文本 (待分割文本1, “ ”, ))
    赋值 (已分割文本, 取文本 (文本1 [取文本行数1], ))
    赋值 (文本长度, 取文本长度 (已分割文本))
    .如果真 (等于 (取文本左边 (已分割文本, 2), “M2”)) ' 程序结束，在程序的最后一段被写入
        赋值 (取文本行数, 1)
        赋值 (跳出变量, 真)
    .如果真结束
    .如果真 (不等于 (寻找文本 (已分割文本, “G1”, 1, 假), -1)) ' 直线插补
        赋值 (颜色, #红色)
        赋值 (步进脉宽, 相乘 (相除 (1, 相乘 (相除 (最大铣削速度, 60), X脉冲数)), 100000))
    .如果真结束
    .如果真 (不等于 (寻找文本 (已分割文本, “G0”, 1, 假), -1)) ' 快速移动
        赋值 (步进脉宽, 相乘 (相除 (1, 相乘 (相除 (最大进给速度, 60), X脉冲数)), 100000))
        赋值 (颜色, #蓝色)
    .如果真结束
    .如果真 (不等于 (寻找文本 (已分割文本, “X”, 1, 假), -1))
        赋值 (文本起始位, 到数值 (寻找文本 (已分割文本, “X”, 1, 假)))
        赋值 (X轴, 到数值 (取文本右边 (已分割文本, 相减 (文本长度, 文本起始位))))
    .如果真结束
    .如果真 (不等于 (寻找文本 (已分割文本, “Y”, 1, 假), -1))
        赋值 (文本起始位, 到数值 (寻找文本 (已分割文本, “Y”, 1, 假)))
        赋值 (Y轴, 到数值 (取文本右边 (已分割文本, 相减 (文本长度, 文本起始位))))
    .如果真结束
    .如果真 (不等于 (寻找文本 (已分割文本, “Z”, 1, 假), -1))
        赋值 (文本起始位, 到数值 (寻找文本 (已分割文本, “Z”, 1, 假)))
        赋值 (Z轴, 到数值 (取文本右边 (已分割文本, 相减 (文本长度, 文本起始位))))
    .如果真结束
    赋值 (取文本行数1, 相加 (取文本行数1, 1))
.判断循环尾 ()
返回 ()

.子程序 _按钮4_被单击, 空白型, , 
.计次循环首 (整除 (单步距离, X每步), )
    X轴正转 ()
.计次循环尾 ()

.子程序 _按钮3_被单击, 空白型, , 
.计次循环首 (整除 (单步距离, X每步), )
    X轴反转 ()
.计次循环尾 ()

.子程序 _按钮2_被单击, 空白型, , 
.计次循环首 (相除 (单步距离, Y每步), )
    Y轴正转 ()
.计次循环尾 ()

.子程序 _按钮1_被单击, 空白型, , 
.计次循环首 (整除 (单步距离, Y每步), )
    Y轴反转 ()
.计次循环尾 ()

.子程序 _按钮6_被单击, 空白型, , 
.计次循环首 (整除 (单步距离, Z每步), )
    Z轴正转 ()
.计次循环尾 ()

.子程序 _按钮5_被单击, 空白型, , 
.计次循环首 (整除 (单步距离, Z每步), )
    Z轴反转 ()
.计次循环尾 ()

.子程序 显示, 空白型, , 
画十字线 (.画板背景色, 老水平, 老垂直)
画十字线 (#浅灰, 相加 (相乘 (x动点1, 显示比例), 显示横向位移), 相减 (.高度, 显示纵向位移, 相乘 (y动点1, 显示比例)))
赋值 (老水平, 相加 (相乘 (x动点1, 显示比例), 显示横向位移))
赋值 (老垂直, 相减 (.高度, 显示纵向位移, 相乘 (y动点1, 显示比例)))
赋值 (.画出方式, 12)
.如果 (大于 (z动点1, 0))
    赋值 (颜色, #蓝色)
.否则
    赋值 (颜色, #红色)
.如果结束
.如果真 (等于 (z动点1, 0))
    赋值 (颜色, #绿色)
.如果真结束
相加 (相乘 (x动点1, 显示比例), 显示横向位移).画点 (相减 (.高度, 显示纵向位移, 相乘 (y动点1, 显示比例)), 颜色)
返回 ()


.子程序 画十字线, 空白型, , 
.参数 颜色, 空白型, , 
.参数 x, 空白型, , 
.参数 y, 空白型, , 

赋值 (.画出方式, 4)
赋值 (.画笔颜色, 颜色)
x.画直线 (0, x, .高度)
0.画直线 (y, .宽度, y)


.子程序 第一象限插补, 空白型, , 
赋值 (总步数, 总步数 ())
赋值 (偏差, 0)
赋值 (x动点, 0)
赋值 (y动点, 0)
.判断循环首 (大于 (总步数, 0))
    .如果 (大于或等于 (偏差, 0))
        X轴正转 ()
        赋值 (x动点, 相加 (x动点, 1))
        赋值 (偏差, 相减 (偏差, Y步数))
    .否则
        Y轴正转 ()
        赋值 (y动点, 相加 (y动点, 1))
        赋值 (偏差, 相加 (偏差, X步数))
    .如果结束
    赋值 (总步数, 相减 (总步数, 1))
.判断循环尾 ()
返回 ()

.子程序 第二象限插补, 空白型, , 
赋值 (总步数, 总步数 ())
赋值 (偏差, 0)
赋值 (x动点, 0)
赋值 (y动点, 0)
.判断循环首 (大于 (总步数, 0))
    .如果 (大于或等于 (偏差, 0))
        Y轴正转 ()
        赋值 (y动点, 相加 (y动点, 1))
        赋值 (偏差, 相减 (偏差, X步数))
    .否则
        X轴反转 ()
        赋值 (x动点, 相加 (x动点, 1))
        赋值 (偏差, 相加 (偏差, Y步数))
    .如果结束
    赋值 (总步数, 相减 (总步数, 1))
.判断循环尾 ()
返回 ()

.子程序 第三象限插补, 空白型, , 
赋值 (总步数, 总步数 ())
赋值 (偏差, 0)
赋值 (x动点, 0)
赋值 (y动点, 0)
.判断循环首 (大于 (总步数, 0))
    .如果 (大于或等于 (偏差, 0))
        X轴反转 ()
        赋值 (x动点, 相加 (x动点, 1))
        赋值 (偏差, 相减 (偏差, Y步数))
    .否则
        Y轴反转 ()
        赋值 (y动点, 相加 (y动点, 1))
        赋值 (偏差, 相加 (偏差, X步数))
    .如果结束
    赋值 (总步数, 相减 (总步数, 1))
.判断循环尾 ()
返回 ()

.子程序 第四象限插补, 空白型, , 
赋值 (总步数, 总步数 ())
赋值 (偏差, 0)
赋值 (x动点, 0)
赋值 (y动点, 0)
.判断循环首 (大于 (总步数, 0))
    .如果 (大于或等于 (偏差, 0))
        Y轴反转 ()
        赋值 (y动点, 相加 (y动点, 1))
        赋值 (偏差, 相减 (偏差, X步数))
    .否则
        X轴正转 ()
        赋值 (x动点, 相加 (x动点, 1))
        赋值 (偏差, 相加 (偏差, Y步数))
    .如果结束
    赋值 (总步数, 相减 (总步数, 1))
.判断循环尾 ()
返回 ()


.子程序 插补象限, 整数型, , 
.如果真 (并且 (大于 (相减 (x终点, x起点), 0), 大于 (相减 (y终点, y起点), 0)))
    返回 (1)
.如果真结束
.如果真 (并且 (大于 (相减 (x终点, x起点), 0), 小于 (相减 (y终点, y起点), 0)))
    返回 (4)
.如果真结束
.如果真 (并且 (小于 (相减 (x终点, x起点), 0), 小于 (相减 (y终点, y起点), 0)))
    返回 (3)
.如果真结束
.如果真 (并且 (小于 (相减 (x终点, x起点), 0), 大于 (相减 (y终点, y起点), 0)))
    返回 (2)
.如果真结束
.如果真 (并且 (大于 (相减 (x终点, x起点), 0), 等于 (相减 (y终点, y起点), 0)))
    返回 (1)
.如果真结束
.如果真 (并且 (等于 (相减 (x终点, x起点), 0), 小于 (相减 (y终点, y起点), 0)))
    返回 (4)
.如果真结束
.如果真 (并且 (小于 (相减 (x终点, x起点), 0), 等于 (相减 (y终点, y起点), 0)))
    返回 (3)
.如果真结束
.如果真 (并且 (等于 (相减 (x终点, x起点), 0), 大于 (相减 (y终点, y起点), 0)))
    返回 (2)
.如果真结束
返回 (0)


.子程序 总步数, 整数型, , 
赋值 (X步数, 取绝对值 (相减 (x终点, x起点)))
赋值 (Y步数, 取绝对值 (相减 (y终点, y起点)))
赋值 (总步数, 相加 (X步数, Y步数))
返回 (总步数)


.子程序 Z轴插补, 空白型, , 
.判断循环首 (大于 (Z步数, 0))
    .如果 (大于 (相减 (Z轴, Z轴起点), 0))
        Z轴正转 ()
        赋值 (Z步数, 相减 (Z步数, 1))
        到循环尾 ()
    .否则
        Z轴反转 ()
    .如果结束
    赋值 (Z步数, 相减 (Z步数, 1))
.判断循环尾 ()

.子程序 _选项2_被选择, 空白型, , 
载入 (端口设置, _启动窗口, 真)


.子程序 _编辑框8_内容被改变, 空白型, , 
赋值 (G代码比例, 到数值 (.内容))


.子程序 __启动窗口_尺寸被改变, 空白型, , 
赋值 (.左边, 相减 (取用户区宽度 (), 160))
赋值 (.左边, 相减 (取用户区宽度 (), 160))
赋值 (.宽度, 相减 (取用户区宽度 (), 160))
赋值 (.高度, 相减 (取用户区高度 (), 160))
赋值 (.顶边, 相加 (.高度, 45))
赋值 (.宽度, .宽度)
赋值 (.宽度, 相减 (.宽度, 70))
赋值 (.高度, 相减 (.高度, 30))
赋值 (.顶边, 相加 (.高度, 10))
赋值 (.左边, 相减 (.宽度, 20))
赋值 (.宽度, .宽度)
赋值 (.最大位置, .宽度)
赋值 (.位置, 相除 (.最大位置, 2))
赋值 (.高度, .高度)
赋值 (.最大位置, .高度)
赋值 (.位置, 相除 (.最大位置, 2))
赋值 (.高度, .高度)
赋值 (显示横向位移, 相除 (.宽度, 2))
赋值 (显示纵向位移, 相除 (.高度, 2))
重画 ()
赋值 (老水平, 0)
赋值 (老垂直, 0)
赋值 (., .高度)
赋值 (.最大位置, .)
赋值 (.位置, 相除 (.最大位置, 2))
赋值 (.单位刻度值, 5)
物体标识.未知支持库函数_56 (0, 相减 (.位置, 32), )

.子程序 _组合框1_列表项被选择, 空白型, , 
赋值 (单步距离, 到数值 (.内容))


.子程序 精度延时, 空白型, , 
.参数 微秒, 长整数型, , 注意单位是微秒

.局部变量 当前值, Large_Integer, , , 
.局部变量 计数, Large_Integer, , , 

取定时器频率 (计数)
取定时器当前值 (当前值)
赋值 (计数.低位, 相加 (相乘 (相除 (计数.低位, 1000000), 微秒), 当前值.低位))
.判断循环首 (小于 (当前值.低位, 计数.低位))
    取定时器当前值 (当前值)
.判断循环尾 ()

.子程序 _横向滚动条1_位置被改变, 空白型, , 
重画 ()
.如果 (大于或等于 (.位置, 相除 (.最大位置, 2)))
    赋值 (显示横向位移, 相加 (相减 (.位置, 相除 (.最大位置, 2)), 相除 (.宽度, 2)))
.否则
    赋值 (显示横向位移, 相减 (相除 (.宽度, 2), 取绝对值 (相减 (.位置, 相除 (.最大位置, 2)))))
.如果结束
赋值 (老水平, 0)
赋值 (老垂直, 0)


.子程序 _纵向滚动条1_位置被改变, 空白型, , 
重画 ()
.如果 (大于或等于 (.位置, 相除 (.最大位置, 2)))
    赋值 (显示纵向位移, 相加 (相减 (.位置, 相除 (.最大位置, 2)), 相除 (.高度, 2)))
.否则
    赋值 (显示纵向位移, 相减 (相除 (.高度, 2), 取绝对值 (相减 (.位置, 相除 (.最大位置, 2)))))
.如果结束
赋值 (老水平, 0)
赋值 (老垂直, 0)

.子程序 _按钮11_被单击, 空白型, , 
赋值 (.标题, “0.0000”)
赋值 (.标题, “0.0000”)
赋值 (.标题, “0.0000”)

.子程序 _滑块条2_位置被改变, 空白型, , 
赋值 (显示比例, 相乘 (0.01, .位置))
赋值 (.标题, 相加 (“显示比例:”, 到文本 (四舍六入 (相乘 (显示比例, 100), 1)), “%”))
重画 ()
赋值 (老水平, 0)
赋值 (老垂直, 0)


.子程序 四舍六入, 双精度小数型, , 
.参数 欲修约值, 双精度小数型, , 
.参数 保留位数, 整数型, , 

.如果真 (不等于 (相减 (相乘 (欲修约值, 求次方 (10, 保留位数)), 取整 (相乘 (欲修约值, 求次方 (10, 保留位数)))), 0.5))
    返回 (四舍五入 (欲修约值, 保留位数))
.如果真结束
.如果真 (等于 (相减 (相乘 (欲修约值, 求次方 (10, 保留位数)), 取整 (相乘 (欲修约值, 求次方 (10, 保留位数)))), 0.5))
    .如果真 (等于 (求余数 (取整 (相乘 (欲修约值, 求次方 (10, 保留位数))), 2), 0))
        返回 (四舍五入 (相减 (欲修约值, 求次方 (10, 相乘 (保留位数, -1))), 保留位数))
    .如果真结束
    .如果真 (等于 (求余数 (取整 (相乘 (欲修约值, 求次方 (10, 保留位数))), 2), 1))
        返回 (四舍五入 (欲修约值, 保留位数))
    .如果真结束
    
.如果真结束
返回 (0)

.子程序 _按钮10_被单击, 空白型, , 
赋值 (X轴起点, 相除 (到数值 (.标题), G代码比例))
赋值 (Y轴起点, 相除 (到数值 (.标题), G代码比例))
赋值 (Z轴起点, 到数值 (.标题))
赋值 (X轴, 0)
赋值 (Y轴, 0)
赋值 (Z轴, 0)
插补 ()

.子程序 _退出_被选择, 空白型, , 
销毁 ()


.子程序 _编辑框2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    赋值 (X轴起点, X轴)
    赋值 (Y轴起点, Y轴)
    赋值 (Z轴起点, Z轴)
    相加 (“ ”, #换行符).加入文本 ()
    G代码解析 ()
    插补 ()
.如果真结束
返回 ()


.子程序 _刷新_被选择, 空白型, , 
重画 ()


.子程序 _输入设备1_键盘按键状态被改变, 空白型, , 
.参数 键值, 整数型, , 
.参数 键状态, 整数型, , 

_时钟1_周期事件 ()


.子程序 _时钟1_周期事件, 空白型, , 
赋值 (.时钟周期, 10)
.如果真 (等于 (.选中, 真))
    .判断开始 (等于 (#.未知支持库函数_46 (), 3))
        _按钮2_被单击 ()
    .判断 (等于 (#.未知支持库函数_46 (), 3))
        _按钮1_被单击 ()
    .判断 (等于 (#.未知支持库函数_46 (), 3))
        _按钮3_被单击 ()
    .判断 (等于 (#.未知支持库函数_46 (), 3))
        _按钮4_被单击 ()
    .判断 (等于 (#.未知支持库函数_46 (), 3))
        _按钮6_被单击 ()
    .判断 (等于 (#.未知支持库函数_46 (), 3))
        _按钮5_被单击 ()
    .默认
        
    .判断结束
    
.如果真结束


.窗口程序集 关于窗口程序集, , , 

.子程序 _关于窗口_创建完毕, 空白型, , 
赋值 (.标题, _启动窗口.)
赋值 (.标题, “版本：1.0.0”)

.子程序 _确定按钮_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集1, , , 

.子程序 _端口设置_创建完毕, 空白型, , 
赋值 (配置文件名, 相加 (取运行目录 (), “\CNC.ini”))
.如果真 (等于 (文件是否存在 (配置文件名), 真))
    赋值 (节名数组, 取配置节名 (配置文件名))
    .计次循环首 (取数组成员数 (节名数组), 局部计次变量)
        .如果真 (等于 (节名数组 [局部计次变量], “端口设置”))
            赋值 (并口地址, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “并口地址”, )))
            赋值 (.内容, 到文本 (并口地址))
            赋值 (X步进, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “X步进”, )))
            赋值 (.内容, 到文本 (X步进))
            赋值 (X方向, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “X方向”, )))
            赋值 (.内容, 到文本 (X方向))
            赋值 (X反相, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “X反相”, )))
            赋值 (.内容, 到文本 (X反相))
            赋值 (X脉冲数, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “X脉冲数”, )))
            赋值 (.内容, 到文本 (X脉冲数))
            赋值 (Y步进, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “Y步进”, )))
            赋值 (.内容, 到文本 (Y步进))
            赋值 (Y方向, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “Y方向”, )))
            赋值 (.内容, 到文本 (Y方向))
            赋值 (Y反相, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “Y反相”, )))
            赋值 (.内容, 到文本 (Y反相))
            赋值 (Y脉冲数, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “Y脉冲数”, )))
            赋值 (.内容, 到文本 (Y脉冲数))
            赋值 (Z步进, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “Z步进”, )))
            赋值 (.内容, 到文本 (Z步进))
            赋值 (Z方向, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “Z方向”, )))
            赋值 (.内容, 到文本 (Z方向))
            赋值 (Z反相, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “Z反相”, )))
            赋值 (.内容, 到文本 (Z反相))
            赋值 (Z脉冲数, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “Z脉冲数”, )))
            赋值 (.内容, 到文本 (Z脉冲数))
            赋值 (最大进给速度, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “最大进给速度”, )))
            赋值 (.内容, 到文本 (最大进给速度))
            赋值 (最大铣削速度, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “最大铣削速度”, )))
            赋值 (.内容, 到文本 (最大铣削速度))
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
    
.如果真结束
.未知支持库函数_20 (“并口地址378H=888”, -1, , , , )
.未知支持库函数_20 (“并口输出端子选择”, -1, , , , )
.未知支持库函数_20 (“此图为并口输出端子排列”, -1, , , , )

.子程序 _按钮1_被单击, 空白型, , 
写配置项 (配置文件名, “端口设置”, “并口地址”, .内容)
写配置项 (配置文件名, “端口设置”, “X步进”, .内容)
写配置项 (配置文件名, “端口设置”, “X方向”, .内容)
写配置项 (配置文件名, “端口设置”, “X反相”, .内容)
写配置项 (配置文件名, “端口设置”, “X脉冲数”, .内容)
写配置项 (配置文件名, “端口设置”, “Y步进”, .内容)
写配置项 (配置文件名, “端口设置”, “Y方向”, .内容)
写配置项 (配置文件名, “端口设置”, “Y反相”, .内容)
写配置项 (配置文件名, “端口设置”, “Y脉冲数”, .内容)
写配置项 (配置文件名, “端口设置”, “Z步进”, .内容)
写配置项 (配置文件名, “端口设置”, “Z方向”, .内容)
写配置项 (配置文件名, “端口设置”, “Z反相”, .内容)
写配置项 (配置文件名, “端口设置”, “Z脉冲数”, .内容)
写配置项 (配置文件名, “端口设置”, “最大进给速度”, .内容)
写配置项 (配置文件名, “端口设置”, “最大铣削速度”, .内容)
销毁 ()

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()


.子程序 _按钮3_被单击, 空白型, , 
赋值 (配置文件名, 相加 (取运行目录 (), “\CNC.ini”))
.如果真 (等于 (文件是否存在 (配置文件名), 真))
    赋值 (节名数组, 取配置节名 (配置文件名))
    .计次循环首 (取数组成员数 (节名数组), 局部计次变量)
        .如果真 (等于 (节名数组 [局部计次变量], “端口设置”))
            赋值 (并口地址, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “并口地址”, )))
            赋值 (X步进, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “X步进”, )))
            赋值 (X方向, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “X方向”, )))
            赋值 (X反相, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “X反相”, )))
            赋值 (X脉冲数, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “X脉冲数”, )))
            赋值 (Y步进, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “Y步进”, )))
            赋值 (Y方向, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “Y方向”, )))
            赋值 (Y反相, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “Y反相”, )))
            赋值 (Y脉冲数, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “Y脉冲数”, )))
            赋值 (Z步进, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “Z步进”, )))
            赋值 (Z方向, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “Z方向”, )))
            赋值 (Z反相, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “Z反相”, )))
            赋值 (Z脉冲数, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “Z脉冲数”, )))
            赋值 (最大进给速度, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “最大进给速度”, )))
            赋值 (最大铣削速度, 到数值 (读配置项 (配置文件名, 节名数组 [局部计次变量], “最大铣削速度”, )))
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
.如果真结束
销毁 ()

.窗口程序集 窗口程序集2, , , 

.子程序 _窗口1_创建完毕, 空白型, , 
.局部变量 图片号, 整数型, , , 

赋值 (.时钟周期, 相乘 (#封面显示秒数, 1000)) ' 设置显示时间

赋值 (图片号, 载入图片 (#封面图片)) ' 载入图片以获取图片的尺寸
.如果真 (不等于 (图片号, 0)) ' 检查是否载入成功
     ' 如成功则根据图片的尺寸调整窗口的尺寸
    赋值 (窗口1., 图片号.取图片宽度 ())
    赋值 (窗口1., 图片号.取图片高度 ())
    赋值 (窗口1., 1) ' 重新居中窗口
    
    卸载图片 (图片号) ' 卸载掉已经载入的图片
    
    赋值 (., #封面图片) ' 显示图片
.如果真结束



.子程序 _时钟1_周期事件, 空白型, , 
销毁 () ' 时间到了自动销毁本告示窗口.

.子程序 _画板1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.子程序 _启动画面窗口_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.子程序 _图片框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.子程序 _透明标签1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()


 ' 不属于任何一个程序集、类模块的函数：
