 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 456
    高度 = 342
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 0
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 界面窗口
    左边 = 112
    顶边 = 24
    宽度 = 704
    高度 = 507
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “员工劳保发放管理系统 V0.5”
    帮助文件名 = “”

窗口 个人信息窗口
    左边 = 50
    顶边 = 50
    宽度 = 592
    高度 = 466
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 基本信息添加窗口
    左边 = 50
    顶边 = 50
    宽度 = 348
    高度 = 458
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 管理注册窗口
    左边 = 50
    顶边 = 50
    宽度 = 252
    高度 = 170
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “初次使用请先注册管理员账号”
    帮助文件名 = “”

窗口 背景窗口
    左边 = 50
    顶边 = 50
    宽度 = 584
    高度 = 447
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 2
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 部门设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 290
    高度 = 229
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “系 统 设 置”
    帮助文件名 = “”

窗口 查询窗口
    左边 = 50
    顶边 = 50
    宽度 = 166
    高度 = 144
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “请选择查询类别”
    帮助文件名 = “”

窗口 系统种类设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 217
    高度 = 265
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 新添项目窗口
    左边 = 50
    顶边 = 50
    宽度 = 257
    高度 = 117
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 管理员设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 358
    高度 = 264
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “管理员设置”
    帮助文件名 = “”

窗口 劳保设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 584
    高度 = 447
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 劳保用品添加窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 138
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “添加劳保用品”
    帮助文件名 = “”

窗口 部门选择窗口
    左边 = 50
    顶边 = 50
    宽度 = 291
    高度 = 326
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “选择劳保发放岗位”
    帮助文件名 = “”

窗口 劳保发放查询窗口
    左边 = 50
    顶边 = 50
    宽度 = 540
    高度 = 471
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “劳保发放明细”
    帮助文件名 = “”

窗口 日期窗口
    左边 = 50
    顶边 = 50
    宽度 = 307
    高度 = 117
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.声音 特效1, " ' 已保存到：D:\易语言学习\Data\参赛.e\特效1", , 
.图片 首页背景, " ' 已保存到：D:\易语言学习\Data\参赛.e\首页背景", , 
.图片 背景, " ' 已保存到：D:\易语言学习\Data\参赛.e\背景", , 
.常量 个人信息数据库, "“Database\Personal information”", , 
.常量 职工号个人信息库, "“职工号”", , 
.常量 姓名个人信息库, "“姓名”", , 
.常量 身份证号个人信息库, "“身份证号”", , 
.常量 民族个人信息库, "“民族”", , 
.常量 血型个人信息库, "“血型”", , 
.常量 性别个人信息库, "“性别”", , 
.常量 出生年月个人信息库, "“出生年月”", , 
.常量 政治面貌个人信息库, "“政治面貌”", , 
.常量 联系电话个人信息库, "“联系电话”", , 
.常量 家庭地址个人信息库, "“家庭地址”", , 
.常量 身份证所属区域个人信息库, "“身份证所属区域”", , 
.常量 文化程度个人信息库, "“文化程度”", , 
.常量 毕业院校个人信息库, "“毕业院校”", , 
.常量 所学专业个人信息库, "“所学专业”", , 
.常量 参加工作时间个人信息库, "“参加工作时间”", , 
.常量 入厂时间个人信息库, "“入厂时间”", , 
.常量 单位名称个人信息库, "“单位名称”", , 
.常量 职务个人信息库, "“职务”", , 
.常量 部门班组个人信息库, "“班组部门”", , 
.常量 用工形式个人信息库, "“用工形式”", , 
.常量 岗位名称个人信息库, "“岗位名称”", , 
.常量 工种个人信息库, "“工种”", , 
.常量 个人照片个人信息库, "“照片”", , 
.常量 状态个人信息库, "“状态”", , 
.常量 单位代码个人信息库, "“单位代码”", , 
.常量 地址代码数据库, "“Database\region”", , 
.常量 区域编码, "“代码”", , 
.常量 对应地址, "“地址”", , 
.常量 类型设置数据库, "“Database\Set sector”", , 
.常量 种类类型设置管理库, "“种类”", , 
.常量 内容名称类型设置管理库, "“内容名称”", , 
.常量 单位识别编码类型设置管理库, "“单位识别编码”", , 
.常量 账户管理数据库, "“Database\Account Management”", , 
.常量 帐户名账户管理库, "“帐户名”", , 
.常量 帐户密码账户管理库, "“帐户密码”", , 
.常量 管理权限账户管理库, "“管理权限”", , 
.常量 用户姓名账户管理库, "“用户姓名”", , 
.常量 劳保设置数据库, "“Database\Labor protection supplies”", , 
.常量 种类劳保管理库, "“种类”", , 
.常量 名称劳保管理库, "“名称”", , 
.常量 限期劳保管理库, "“限期”", , 
.常量 用工形式劳保管理库, "“用工形式”", , 
.常量 发放岗位劳保管理库, "“发放岗位”", , 
.常量 代码劳保管理库, "“代码”", , 
.常量 劳保发放数据库, "“Database\Labor insurance payment”", , 
.常量 职工号劳保发放库, "“职工号”", , 
.常量 日期劳保发放库, "“日期”", , 
.常量 劳保类别劳保发放库, "“劳保类别”", , 
.常量 劳保品名劳保发放库, "“劳保品名”", , 
.常量 签名劳保发放库, "“签名”", , 
.常量 密1, "“qwscx”", , 
.常量 密2, "“ourtd”", , 
.常量 密3, "“SRTWO”", , 
.常量 密4, "“PJYDN”", , 
.常量 密5, "“%*@”", , 
.常量 密6, "“@~>”", , 
.常量 密7, "“*#?”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' eMMedia 824F144B108A4bcbB966F45670D42A00 2 4 多媒体支持库
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 2 6 扩展界面支持库三
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库
 ' eImgConverter 8FA3AA46276847db8F28E57E7FB97B7F 1 0 图像格式转换支持库
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库




.全局变量 覆盖操作全局变量, 文本型, , , 
.全局变量 查询识别符, 文本型, , , 
.全局变量 职工数据职工号, 文本型, , , 
.全局变量 出生年月日, 文本型, , , 
.全局变量 年龄, 整数型, , , 
.全局变量 设置类别, 整数型, , , 
.全局变量 当前目录, 文本型, , , 
.全局变量 系统时间, 日期时间型, , , 
.全局变量 查找内容, 文本型, , , 
.全局变量 窗口句柄, 整数型, , , 
.全局变量 权限, 文本型, , , 
.全局变量 窗口名称, 窗口, , , 

.窗口程序集 启动程序集, , , 

.程序集变量 Midi左音量, 整数型, , , 
.程序集变量 Midi右音量, 整数型, , , 
.程序集变量 输入次数, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 程序启动加载相关数据库，并检查Account Management.edb数据库的记录数是否为空，是则加载管理注册窗口，注册超级管理员账号
.局部变量 序号, 整数型, , , 

未知支持库函数_0 (3)
赋值 (当前目录, 取运行目录 ())
赋值 (系统时间, 取现行时间 ())
赋值 (_启动窗口., #首页背景)
赋值 (_启动窗口., 3)
获取焦点 ()
打开 (#地址代码数据库, , , , , 相加 (#密1, #密2, #密5), )
打开 (#类型设置数据库, , , , , 相加 (#密1, #密4, #密6), )
打开 (#个人信息数据库, , , , , 相加 (#密3, #密5, #密2), )
打开 (#劳保设置数据库, , , , , 相加 (#密5, #密6, #密1), )
打开 (#劳保发放数据库, , , , , 相加 (#密6, #密4, #密1), )
打开 (#账户管理数据库, , , , , , )
.如果真 (等于 (取记录数 (), 0))
    载入 (管理注册窗口, _启动窗口, 真)
.如果真结束
置随机数种子 ()

.子程序 _首页登陆按钮_被单击, 空白型, , 检验账户名和密码是否与数据库中记录相同，是则进入管理系统，否则重新输入，可以输入3次，
.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“用户名或登录密码不能为空，请重新输入。”, 相加 (0, #错误图标), “错误信息！”)
    .判断开始 (等于 (.内容, “”))
        获取焦点 ()
    .默认
        获取焦点 ()
    .判断结束
    输入次数 ()
    返回 ()
.如果真结束
到首记录 ()
.如果 (查找 (等于 (读 (#帐户名账户管理库), .内容)))
    .如果 (等于 (.内容, 读 (#帐户密码账户管理库)))
        恢复系统音量 ()
        载入 (界面窗口, , 假)
        销毁 ()
    .否则
        输入次数 ()
        信息框 (“输入错误，请重新输入！”, 相加 (0, #错误图标), “错误信息！”)
        返回 ()
    .如果结束
    
.否则
    输入次数 ()
    信息框 (“输入错误，请重新输入！”, 相加 (0, #错误图标), “错误信息！”)
    返回 ()
.如果结束


.子程序 输入次数, 空白型, , 记录错误输入次数，错误输入3次后，关闭程序
.局部变量 次数, 整数型, , , 

赋值 (输入次数, 相加 (输入次数, 1))
.如果真 (大于或等于 (输入次数, 3))
    信息框 (“登陆超时，程序将被关闭！”, 相加 (0, #错误图标), “错误信息！”)
    恢复系统音量 ()
    结束 ()
.如果真结束
返回 ()

.子程序 恢复系统音量, 空白型, , 
赋值 (_启动窗口., {  })
Midi左音量.未知支持库函数_8 (Midi右音量)

.子程序 _登录名编辑框_按下某键, 逻辑型, , 如果密码框无内容，回车光标移到密码框，否则会车作用等同于登陆按钮被按下
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    .如果 (等于 (.内容, “”))
        获取焦点 ()
    .否则
        _首页登陆按钮_被单击 ()
    .如果结束
    
.如果真结束


.子程序 _登录密码编辑框_按下某键, 逻辑型, , 回车作用等同于登陆按钮被按下
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _首页登陆按钮_被单击 ()
.如果真结束


.子程序 _透明标签2_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 



.窗口程序集 界面窗口程序集, , , 

.程序集变量 年, 文本型, , , 
.程序集变量 月, 文本型, , , 
.程序集变量 日, 文本型, , , 
.程序集变量 时间, 文本型, , , 
.程序集变量 星期, 整数型, , , 
.子程序 _界面窗口_创建完毕, 空白型, , 判断权限；将状态栏内容填入
.局部变量 用户名, 文本型, , , 

赋值 (权限, 读 (#管理权限账户管理库))
赋值 (用户名, 读 (#帐户名账户管理库))
.如果 (等于 (权限, “超级管理员”))
    
.否则
    0.未知支持库函数_10 (“修改密码”, 1)
.如果结束
连续赋值 (1, .对齐方式, .对齐方式, .对齐方式, .对齐方式)
赋值 (.内容, 相加 (用户名, “（”, 权限, “）”))
赋值 (年, 相加 (到文本 (取时间部分 (系统时间, #年份)), “年”))
赋值 (月, 相加 (到文本 (取时间部分 (系统时间, #月份)), “月”))
赋值 (日, 相加 (到文本 (取时间部分 (系统时间, #日)), “日”))
赋值 (星期, 取时间部分 (系统时间, #星期几))
_时钟1_周期事件 ()
载入 (背景窗口, , 假)

.子程序 _时钟1_周期事件, 空白型, , 时间编辑框内显示系统时间：年、月、日、星期、时、分、秒
赋值 (.时钟周期, 1000)
系统时间转换 ()
赋值 (.内容, 相加 (年, 月, 日, “ ”, 多项选择 (星期, “星期日”, “星期一”, “星期二”, “星期三”, “星期四”, “星期五”, “星期六”), “ ”, 时间))

.子程序 系统时间转换, 空白型, , 提取系统时间，显示为 **时**分**秒
.局部变量 当前时间, 日期时间型, , , 

赋值 (当前时间, 取现行时间 ())
赋值 (时间, 相加 (到文本 (取小时 (当前时间)), “时”, 取文本右边 (相加 (“00”, 到文本 (取时间部分 (当前时间, #分钟))), 2), “分”, 取文本右边 (相加 (“00”, 到文本 (取时间部分 (当前时间, #秒))), 2), “秒”))

.子程序 _卷帘式菜单1_项目被选择, 空白型, , 点击卷帘式菜单，弹出不同窗口
.参数 菜单索引, 整数型, , 
.参数 项目索引, 整数型, , 

.如果真 (等于 (菜单索引, 0))
    销毁多余窗口 ()
    载入 (个人信息窗口, 界面窗口, 假)
    .如果真 (等于 (项目索引, 0))
        销毁多余窗口 ()
        个人信息窗口._添加记录按钮_被单击 ()
    .如果真结束
    .如果真 (等于 (项目索引, 1))
        销毁多余窗口 ()
        个人信息窗口._修改记录按钮_被单击 ()
    .如果真结束
    .如果真 (等于 (项目索引, 2))
        销毁多余窗口 ()
        个人信息窗口._查询记录按钮_被单击 ()
    .如果真结束
    .如果真 (等于 (项目索引, 3))
        销毁多余窗口 ()
        个人信息窗口._删除记录按钮_被单击 ()
    .如果真结束
    
.如果真结束
.如果真 (等于 (菜单索引, 1))
    销毁多余窗口 ()
    .如果真 (等于 (项目索引, 0))
        销毁多余窗口 ()
        载入 (劳保发放查询窗口, 界面窗口, 假)
        赋值 (劳保发放查询窗口., “劳保发放信息”)
        赋值 (劳保发放查询窗口..标题, “劳保发放基本信息”)
        赋值 (劳保发放查询窗口., “否”)
    .如果真结束
    .如果真 (等于 (项目索引, 1))
        销毁多余窗口 ()
        载入 (劳保发放查询窗口, 界面窗口, 假)
        赋值 (劳保发放查询窗口., “劳保发放查询”)
        赋值 (劳保发放查询窗口., “是”)
        连续赋值 (真, 劳保发放查询窗口..可视, 劳保发放查询窗口..可视, 劳保发放查询窗口..可视, 劳保发放查询窗口..可视, 劳保发放查询窗口..可视)
    .如果真结束
    
.如果真结束
.如果真 (等于 (菜单索引, 2))
    销毁多余窗口 ()
    .如果真 (等于 (项目索引, 0))
        载入 (管理员设置窗口, 界面窗口, 假)
    .如果真结束
    .如果真 (等于 (项目索引, 1))
        载入 (部门设置窗口, 界面窗口, 假)
    .如果真结束
    载入 (背景窗口, , 假)
    .如果真 (等于 (项目索引, 2))
        载入 (劳保设置窗口, , 假)
    .如果真结束
    
.如果真结束
.如果真 (等于 (菜单索引, 3))
    销毁多余窗口 ()
    .如果真 (等于 (项目索引, 0))
        未知支持库函数_6 (“help.chm”, , )
    .如果真结束
    .如果真 (等于 (项目索引, 1))
        
    .如果真结束
    
.如果真结束


.子程序 _卷帘式菜单1_菜单被单击, 空白型, , 
.参数 菜单索引, 整数型, , 

销毁多余窗口 ()
.如果真 (等于 (是否已创建 (个人信息窗口), 真))
    个人信息窗口.销毁 ()
.如果真结束
.如果真 (等于 (是否已创建 (劳保设置窗口), 真))
    劳保设置窗口.销毁 ()
.如果真结束
.如果 (等于 (菜单索引, 0))
    载入 (个人信息窗口, 界面窗口, 假)
.否则
    载入 (背景窗口, , 假)
.如果结束


.窗口程序集 个人信息窗口程序集, , , 

.程序集变量 表项索引数组, 整数型, , "0", 
.程序集变量 个人信息库数据总数, 整数型, , , 
.程序集变量 插入列循环次数, 整数型, , , 
.子程序 _个人信息窗口_创建完毕, 空白型, , 创建超级列表框表头内容
.局部变量 表项循环次数局部变量, 整数型, , , 
.局部变量 列宽, 整数型, , , 

置父窗口 (界面窗口.)
移动 (0, 0, 相加 (界面窗口.取用户区宽度 (.), 2), 相加 (界面窗口.取用户区高度 (.), 2))
置个人信息为当前库 ()
.计次循环首 (取字段数 (), 插入列循环次数)
    .如果真 (或者 (等于 (插入列循环次数, 4), 等于 (插入列循环次数, 5), 等于 (插入列循环次数, 7), 等于 (插入列循环次数, 11), 等于 (插入列循环次数, 12), 等于 (插入列循环次数, 13), 等于 (插入列循环次数, 14), 等于 (插入列循环次数, 24)))
        到循环尾 ()
    .如果真结束
    赋值 (列宽, 多项选择 (插入列循环次数, 52, 56, 126, 0, 0, 36, 0, 62, 80, 200, 0, 0, 0, 0, 84, 84, 100, 64, 64, 64, 64, 64, 36, 64, 0))
    插入列循环次数.插入列 (取字段名 (插入列循环次数), 列宽, #中间对齐, , )
.计次循环尾 ()
.如果真 (不等于 (取记录数 (), 0))
    刷新个人信息列表框 ()
.如果真结束


.子程序 刷新个人信息列表框, 空白型, , 
.局部变量 循环次数, 整数型, , , 
.局部变量 表项索引, 整数型, , , 
.局部变量 表项列索引, 整数型, , , 

全部删除 ()
置个人信息为当前库 ()
.计次循环首 (取记录数 (), 循环次数)
    赋值 (表项索引, -1.插入表项 ())
    赋值 (表项列索引, 0)
    .计次循环首 (取字段数 (), 插入列循环次数)
        .如果 (或者 (等于 (插入列循环次数, 4), 等于 (插入列循环次数, 5), 等于 (插入列循环次数, 7), 等于 (插入列循环次数, 11), 等于 (插入列循环次数, 12), 等于 (插入列循环次数, 13), 等于 (插入列循环次数, 14), 等于 (插入列循环次数, 24)))
            到循环尾 ()
        .否则
            .如果 (等于 (插入列循环次数, 23))
                .如果 (等于 (到文本 (读字段 (到文本 (取字段名 (插入列循环次数)), )), “”))
                    表项索引.置标题 (表项列索引, “×”)
                .否则
                    表项索引.置标题 (表项列索引, “√”)
                .如果结束
                赋值 (表项列索引, 相加 (表项列索引, 1))
            .否则
                表项索引.置标题 (表项列索引, 读字段 (到文本 (取字段名 (插入列循环次数)), ))
                赋值 (表项列索引, 相加 (表项列索引, 1))
            .如果结束
            
        .如果结束
        
    .计次循环尾 ()
    跳过 (1)
.计次循环尾 ()

.子程序 _添加记录按钮_被单击, 空白型, , 
销毁多余窗口 ()
载入 (基本信息添加窗口, , 假)

.子程序 _超级列表框1_表项被激活, 空白型, , 
赋值 (表项索引数组, 取被选择表项 ())
赋值 (职工数据职工号, 表项索引数组.取标题 ( [1], ))
赋值 (查询识别符, “查询”)
销毁多余窗口 ()
载入 (基本信息添加窗口, 界面窗口, 假)
置个人信息为当前库 ()
查找 (等于 (读 (#职工号个人信息库), 职工数据职工号))
填入个人信息 ()
赋值 (基本信息添加窗口., 相加 (“  ”, 基本信息添加窗口..内容, “  的基本信息  ”))

.子程序 _修改记录按钮_被单击, 空白型, , 
赋值 (表项索引数组, 取被选择表项 ())
销毁多余窗口 ()
.如果 (等于 (取数组成员数 (表项索引数组), 0))
    .如果真 (等于 (查询识别符, “查询”))
        赋值 (查询识别符, “”)
    .如果真结束
    载入 (查询窗口, 界面窗口, 假)
    返回 ()
.否则
    赋值 (表项索引数组, 取被选择表项 ())
    赋值 (职工数据职工号, 表项索引数组.取标题 ( [1], ))
    赋值 (覆盖操作全局变量, “是”)
    载入 (基本信息添加窗口, 界面窗口, 假)
    赋值 (基本信息添加窗口..标题, “修  改”)
    置个人信息为当前库 ()
    查找 (等于 (读 (#职工号个人信息库), 职工数据职工号))
    填入个人信息 ()
    赋值 (基本信息添加窗口., 相加 (“修改职工  ”, 基本信息添加窗口..内容, “  的基本信息  ”))
    连续赋值 (真, 基本信息添加窗口..可视, 基本信息添加窗口..可视, 基本信息添加窗口..可视)
    连续赋值 (假, 基本信息添加窗口..可视, 基本信息添加窗口..可视, 基本信息添加窗口..可视)
.如果结束


.子程序 _删除记录按钮_被单击, 空白型, , 
赋值 (表项索引数组, 取被选择表项 ())
.如果 (等于 (取数组成员数 (表项索引数组), 0))
    信息框 (“请选择您要删除的数据！”, 0, )
    返回 ()
.否则
    赋值 (职工数据职工号, 表项索引数组.取标题 ( [1], ))
    置个人信息为当前库 ()
    删除 (等于 (读 (#职工号个人信息库), 职工数据职工号))
    .如果 (等于 (信息框 (“此操作将彻底删除该职工信息，确定继续操作”, 相加 (#是否钮, #警告图标), “警告！”), #是钮))
        彻底删除 ()
        .删除表项 (.)
    .否则
        恢复删除 ()
    .如果结束
    
.如果结束


.子程序 _超级列表框1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _添加职工信息_被选择, 空白型, , 
_添加记录按钮_被单击 ()

.子程序 _修改职工信息_被选择, 空白型, , 
_修改记录按钮_被单击 ()

.子程序 _删除职工信息_被选择, 空白型, , 
_删除记录按钮_被单击 ()

.子程序 _查询记录按钮_被单击, 空白型, , 
销毁多余窗口 ()
赋值 (查询识别符, “查询”)
载入 (查询窗口, 界面窗口, 假)
连续赋值 (假, 基本信息添加窗口..可视, 基本信息添加窗口..可视, 基本信息添加窗口..可视)
连续赋值 (真, 基本信息添加窗口..可视, 基本信息添加窗口..可视, 基本信息添加窗口..可视)


.窗口程序集 基本信息添加窗口程序集, , , 

.程序集变量 序号, 整数型, , , 
.程序集变量 单位代码, 文本型, , , 
.程序集变量 暂存识别码, 文本型, , , 
.程序集变量 分割识别码, 文本型, , "0", 
.程序集变量 个人单位代码, 文本型, , , 
.子程序 _基本信息添加窗口_创建完毕, 空白型, , 判断所需的数据库是否打开,没有的话就打开
赋值 (窗口句柄, 取窗口句柄 ())
赋值 (窗口名称, 基本信息添加窗口)
填充下拉菜单 ()
置个人信息为当前库 ()
赋值 (序号, 相加 (取记录数 (), 1))
.如果 (小于 (序号, 10))
    赋值 (基本信息添加窗口., 相加 (“添加个人基本信息： 0”, 到文本 (序号), “号”))
.否则
    赋值 (基本信息添加窗口., 相加 (“添加个人基本信息： ”, 到文本 (序号), “号”))
.如果结束
获取焦点 ()
.如果真 (等于 (查询识别符, “查询”))
    连续赋值 (假, 基本信息添加窗口..可视, 基本信息添加窗口..可视, 基本信息添加窗口..可视)
    连续赋值 (真, 基本信息添加窗口..可视, 基本信息添加窗口..可视, 基本信息添加窗口..可视)
.如果真结束


.子程序 填充下拉菜单, 空白型, , 将文化程度、单位名称、用工形式的内容填充到下拉菜单种
.局部变量 计次填充下拉菜单局部变量, 整数型, , , 

置类型设置为当前库 ()
.计次循环首 (取记录数 (), 计次填充下拉菜单局部变量)
    .如果 (等于 (读 (#种类类型设置管理库), “文化程度”))
        读 (#内容名称类型设置管理库).加入项目 ()
    .否则
        
    .如果结束
    .如果 (等于 (读 (#种类类型设置管理库), “单位名称”))
        读 (#内容名称类型设置管理库).加入项目 ()
    .否则
        
    .如果结束
    .如果 (等于 (读 (#种类类型设置管理库), “用工形式”))
        读 (#内容名称类型设置管理库).加入项目 ()
    .否则
        
    .如果结束
    .如果 (等于 (读 (#种类类型设置管理库), “状态”))
        读 (#内容名称类型设置管理库).加入项目 ()
    .否则
        
    .如果结束
    .如果 (等于 (读 (#种类类型设置管理库), “政治面貌”))
        读 (#内容名称类型设置管理库).加入项目 ()
    .否则
        
    .如果结束
    .如果 (等于 (读 (#种类类型设置管理库), “职务”))
        读 (#内容名称类型设置管理库).加入项目 ()
    .否则
        
    .如果结束
    跳过 (1)
.计次循环尾 ()

.子程序 _保存按钮_被单击, 空白型, , 将个人数据添加到相应数据库中
.如果 (或者 (等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“信息没有填写完整，请填完空项”, 相加 (0, #错误图标), “错误信息”)
    返回 ()
.否则
    
.如果结束
置当前库 (相加 (当前目录, “\”, #个人信息数据库, “.edb”))
.如果 (等于 (覆盖操作全局变量, “是”))
    .如果 (等于 (修改 (.内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .图片, .内容, 个人单位代码), 真))
        信息框 (相加 (.内容, “  的职工信息已被修改！”), 0, “信息修改成功”)
        赋值 (覆盖操作全局变量, “否”)
        刷新个人信息列表框 ()
        基本信息添加窗口.销毁 ()
        返回 ()
    .否则
        赋值 (基本信息添加窗口., 相加 (.内容, “  的职工信息修改失败”))
        返回 ()
    .如果结束
    
.否则
    .如果 (等于 (加记录 (.内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .图片, .内容, 个人单位代码), 真))
        信息框 (“职工信息添加成功”, 0, )
        _重填按钮_被单击 ()
        基本信息列表框显示新加内容 ()
        赋值 (序号, 相加 (序号, 1))
    .否则
        赋值 (基本信息添加窗口., “职工信息添加失败”)
        返回 ()
    .如果结束
    
.如果结束
.如果 (小于 (序号, 10))
    赋值 (基本信息添加窗口., 相加 (“添加个人基本信息： 0”, 到文本 (序号), “号”))
.否则
    赋值 (基本信息添加窗口., 相加 (“添加个人基本信息： ”, 到文本 (序号), “号”))
.如果结束


.子程序 _重填按钮_被单击, 空白型, , 
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
赋值 (.图片, {  })
连续赋值 (-1, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项)
连续赋值 (真, .禁止, .禁止)
获取焦点 ()
.如果 (等于 (.标题, “修  改”))
    赋值 (.标题, “保存添加”)
    .如果 (小于 (序号, 10))
        赋值 (基本信息添加窗口., 相加 (“添加个人基本信息： 0”, 到文本 (序号), “号”))
    .否则
        赋值 (基本信息添加窗口., 相加 (“添加个人基本信息： ”, 到文本 (序号), “号”))
    .如果结束
    
.否则
    
.如果结束


.子程序 _个人照片图片框_被双击, 逻辑型, , 添加个人照片
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 文件尺寸, 整数型, , , 

赋值 (.过滤器, “照片文件(jpg  bmp  gif)|*.jpg;*.bmp;*.gif”)
.如果真 (等于 (打开 (), 真))
    未知支持库函数_0 (.文件名, 相加 (当前目录, “\pic\”, .内容, “.jpg”), 假, 40, 真, 30)
    赋值 (.图片, 读入文件 (相加 (当前目录, “\pic\”, .内容, “.jpg”)))
    删除文件 (相加 (当前目录, “\pic\”, .内容, “.jpg”))
.如果真结束


.子程序 _身份证号编辑框_失去焦点, 空白型, , 根据身份证号码获得性别、所属地域等相关信息
.局部变量 身份证号位数局部变量, 整数型, , , 
.局部变量 性别位局部变量, 文本型, , , 
.局部变量 区域编码局部变量, 文本型, , , 

赋值 (身份证号位数局部变量, 取文本长度 (.内容))
.如果 (或者 (并且 (小于 (身份证号位数局部变量, 18), 不等于 (身份证号位数局部变量, 15)), 大于 (身份证号位数局部变量, 18)))
    信息框 (“你填写的身份证号错误，请填写18位或15位身份证号码！”, 相加 (0, #错误图标), “错误信息”)
    赋值 (.内容, “”)
    返回 ()
.否则
    .如果真 (等于 (身份证号位数局部变量, 15))
        赋值 (性别位局部变量, 取文本右边 (.内容, 1))
        .如果 (等于 (求余数 (到数值 (性别位局部变量), 2), 0))
            赋值 (.内容, “女”)
        .否则
            赋值 (.内容, “男”)
        .如果结束
        
    .如果真结束
    .如果真 (等于 (身份证号位数局部变量, 18))
        赋值 (性别位局部变量, 取文本中间 (.内容, 17, 1))
        .如果 (等于 (求余数 (到数值 (性别位局部变量), 2), 0))
            赋值 (.内容, “女”)
        .否则
            赋值 (.内容, “男”)
        .如果结束
        
    .如果真结束
    
.如果结束
赋值 (区域编码局部变量, 取文本左边 (.内容, 6))
置当前库 (相加 (当前目录, “\”, #地址代码数据库, “.edb”))
到首记录 ()
.如果 (等于 (查找 (等于 (读 (#区域编码), 区域编码局部变量)), 真))
    赋值 (.内容, 读 (#对应地址))
    赋值 (.文本颜色, #黑色)
    .如果真 (等于 (.禁止, 真))
        赋值 (.禁止, 假)
    .如果真结束
    
.否则
    赋值 (.内容, “该身份证信息有误，请核查该证真伪！”)
    赋值 (.文本颜色, #红色)
    赋值 (.禁止, 真)
.如果结束
取出生年月日 ()
计算年龄 ()
赋值 (.内容, 出生年月日)
赋值 (.内容, 到文本 (年龄))
.如果 (小于 (年龄, 16))
    .如果 (等于 (信息框 (“该名职工的年龄过小，未达到法定年龄，是否继续添加该职工信息！”, #是否钮, “警告！”), #否钮))
        _重填按钮_被单击 ()
    .否则
        
    .如果结束
    
.否则
    
.如果结束
置当前库 (相加 (当前目录, “\”, #个人信息数据库, “.edb”))

.子程序 _血型编辑框_字符输入, 整数型, , 血型输入，只能输入“A B AB O”，当输入为小写“a b ab o”时自动转为大写
.参数 字符代码, 整数型, , 

.如果 (等于 (.内容, “A”))
    赋值 (.最大允许长度, 2)
    .如果 (或者 (等于 (字符代码, 98), 等于 (字符代码, 66)))
        返回 (66)
    .否则
        返回 (0)
    .如果结束
    
.否则
    赋值 (.最大允许长度, 1)
.如果结束
.判断开始 (或者 (等于 (字符代码, 65), 等于 (字符代码, 66), 等于 (字符代码, 79), 等于 (字符代码, 97), 等于 (字符代码, 98), 等于 (字符代码, 111)))
    .如果真 (或者 (等于 (字符代码, 97), 等于 (字符代码, 65)))
        返回 (65)
    .如果真结束
    .如果真 (或者 (等于 (字符代码, 98), 等于 (字符代码, 66)))
        返回 (66)
    .如果真结束
    .如果真 (或者 (等于 (字符代码, 111), 等于 (字符代码, 79)))
        返回 (79)
    .如果真结束
    
.默认
    返回 (0)
.判断结束


.子程序 _联系电话编辑框_失去焦点, 空白型, , 判断电话号码位数是否正确
.局部变量 变量电话号码长度, 整数型, , , 

赋值 (变量电话号码长度, 取文本长度 (.内容))
.如果 (或者 (等于 (变量电话号码长度, 11), 等于 (变量电话号码长度, 8), 等于 (变量电话号码长度, 13), 等于 (.内容, “无”)))
    
.否则
    信息框 (相加 (“你填写的电话号码有误，请重新填写，没有电话请填入”, #左引号, “无”, #右引号, “！”), 相加 (0, #错误图标), “错误信息”)
    赋值 (.内容, “”)
    返回 ()
.如果结束


.子程序 _单位组合框_列表项被选择, 空白型, , 选定单位并打开班组部门组合框，给班组部门组合框添加数据
.局部变量 循环次数, 整数型, , , 

赋值 (.禁止, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
清空 ()
清空 ()
置类型设置为当前库 ()
清空 ()
.如果 (等于 (查找 (等于 (读 (#内容名称类型设置管理库), .内容)), 真))
    赋值 (单位代码, 读 (#单位识别编码类型设置管理库))
.否则
    返回 ()
.如果结束
到首记录 ()
.计次循环首 (取记录数 (), 循环次数)
    .如果 (等于 (读 (#种类类型设置管理库), “部门班组”))
        赋值 (分割识别码, 分割文本 (读 (#单位识别编码类型设置管理库), “|”, ))
        赋值 (暂存识别码, 分割识别码 [1])
        .如果真 (等于 (单位代码, 暂存识别码))
            读 (#内容名称类型设置管理库).加入项目 ()
        .如果真结束
        
    .否则
        
    .如果结束
    跳过 (1)
.计次循环尾 ()
置当前库 (相加 (当前目录, “\”, #个人信息数据库, “.edb”))

.子程序 _部门班组组合框_列表项被选择, 空白型, , 选定班组部门并打开岗位组合框，将数据加入到岗位组合框
.局部变量 循环次数, 整数型, , , 

赋值 (.禁止, 假)
清空 ()
赋值 (.禁止, 真)
清空 ()
置类型设置为当前库 ()
.如果 (等于 (查找 (等于 (读 (#内容名称类型设置管理库), .内容)), 真))
    赋值 (单位代码, 读 (#单位识别编码类型设置管理库))
.否则
    返回 ()
.如果结束

到首记录 ()
.计次循环首 (取记录数 (), 循环次数)
    .如果 (等于 (读 (#种类类型设置管理库), “岗位名称”))
        赋值 (分割识别码, 分割文本 (读 (#单位识别编码类型设置管理库), “|”, ))
        赋值 (暂存识别码, 相加 (分割识别码 [1], “|”, 分割识别码 [2]))
        .如果真 (等于 (单位代码, 暂存识别码))
            读 (#内容名称类型设置管理库).加入项目 ()
        .如果真结束
        
    .否则
        
    .如果结束
    跳过 (1)
.计次循环尾 ()
置当前库 (相加 (当前目录, “\”, #个人信息数据库, “.edb”))

.子程序 _岗位名称组合框_列表项被选择, 空白型, , 选定岗位并打开工种组合框，将数据加入到工种组合框中
.局部变量 循环次数, 整数型, , , 
.局部变量 临时单位代码, 文本型, , , 

赋值 (.禁止, 假)
赋值 (.内容, “”)
赋值 (临时单位代码, 单位代码)
置类型设置为当前库 ()
.如果 (等于 (查找 (并且 (等于 (读 (#种类类型设置管理库), “岗位名称”), 等于 (读 (#内容名称类型设置管理库), .内容), 等于 (取文本左边 (读 (#单位识别编码类型设置管理库), 7), 临时单位代码))), 真))
    赋值 (临时单位代码, 读 (#单位识别编码类型设置管理库))
.否则
    
    返回 ()
.如果结束
赋值 (个人单位代码, 到文本 (到数值 (子文本替换 (临时单位代码, “|”, , , , 真))))
到首记录 ()
清空 ()
.计次循环首 (取记录数 (), 循环次数)
    .如果 (等于 (读 (#种类类型设置管理库), “工种”))
        赋值 (分割识别码, 分割文本 (读 (#单位识别编码类型设置管理库), “|”, ))
        赋值 (暂存识别码, 相加 (分割识别码 [1], “|”, 分割识别码 [2], “|”, 分割识别码 [3]))
        .如果真 (等于 (临时单位代码, 暂存识别码))
            读 (#内容名称类型设置管理库).加入项目 ()
        .如果真结束
        
    .否则
        
    .如果结束
    跳过 (1)
.计次循环尾 ()
.如果真 (等于 (取项目数 (), 1))
    赋值 (.现行选中项, 0)
.如果真结束
置当前库 (相加 (当前目录, “\”, #个人信息数据库, “.edb”))

.子程序 _姓名编辑框_字符输入, 整数型, , 仅能输入汉字和回退键
.参数 字符代码, 整数型, , 

.如果 (并且 (小于或等于 (字符代码, 127), 不等于 (字符代码, 8)))
    返回 (0)
.否则
    
.如果结束


.子程序 _职工号编辑框_失去焦点, 空白型, , 检查输入内容是否与数据库现存数据重复，若发现有重复的内容，提示相关信息
.局部变量 职工姓名局部变量, 文本型, , , 
.局部变量 职工身份证局部变量, 文本型, , , 
.局部变量 按钮返回值局部变量, 整数型, , , 

.如果 (等于 (查询识别符, “查询”))
    
.否则
    .如果 (等于 (覆盖操作全局变量, “是”))
        
    .否则
        置个人信息为当前库 ()
        .如果真 (查找 (等于 (读 (#职工号个人信息库), .内容)))
            赋值 (职工姓名局部变量, 读 (#姓名个人信息库))
            赋值 (职工身份证局部变量, 读 (#身份证号个人信息库))
            赋值 (按钮返回值局部变量, 信息框 (相加 (“该职工信息已经存在，是否继续此操作？”, #换行符, #换行符, “该职工基本信息如下：”, #换行符, #换行符, “姓          名：  ”, 职工姓名局部变量, #换行符, #换行符, “该职工身份证号：  ”, 职工身份证局部变量), #是否钮, “提示信息”))
            .如果 (等于 (按钮返回值局部变量, #否钮))
                
            .否则
                赋值 (按钮返回值局部变量, 信息框 (“注意：此操作将覆盖该职工原有数据！是否继续操作！”, #是否钮, “提示信息”))
                .如果 (等于 (按钮返回值局部变量, #否钮))
                    
                .否则
                    赋值 (覆盖操作全局变量, “是”)
                    赋值 (基本信息添加窗口., 相加 (“修改职工  ”, 职工姓名局部变量, “  的基本信息  ”))
                    赋值 (.标题, “修  改”)
                    填入个人信息 ()
                .如果结束
                
            .如果结束
            
        .如果真结束
        
    .如果结束
    
.如果结束


.子程序 _参加工作时间编辑框_失去焦点, 空白型, , 输入完毕后，“进厂工作时间编辑框”内同时填入相同内容
.如果 (等于 (.内容, “”))
    赋值 (.内容, .内容)
    赋值 (.被选择字符数, -1)
.否则
    
.如果结束


.子程序 _关闭按钮_被单击, 空白型, , 
销毁 ()

.子程序 _基本信息添加窗口_将被销毁, 空白型, , 
赋值 (查询识别符, “无”)
赋值 (覆盖操作全局变量, “否”)
赋值 (窗口句柄, 0)

.子程序 _上一个按钮_被单击, 空白型, , 
.如果 (等于 (取记录号 (), 1))
    信息框 (“已到第一条记录！”, 0, )
.否则
    跳过 (-1)
    填入个人信息 ()
    赋值 (基本信息添加窗口., 相加 (“  ”, .内容, “  的基本信息  ”))
    个人信息窗口.选择表项 (., 相减 (取记录数 (), 取记录号 ()))
.如果结束


.子程序 _下一个按钮_被单击, 空白型, , 
.如果 (等于 (取记录号 (), 取记录数 ()))
    信息框 (“已到最后一条记录条！”, 0, )
.否则
    跳过 (1)
    填入个人信息 ()
    赋值 (基本信息添加窗口., 相加 (“  ”, .内容, “  的基本信息  ”))
    个人信息窗口.选择表项 (., 相减 (取记录数 (), 取记录号 ()))
.如果结束


.子程序 _删除按钮_被单击, 空白型, , 
个人信息窗口._删除记录按钮_被单击 ()
基本信息添加窗口.销毁 ()

.窗口程序集 管理注册程序集, , , 

.子程序 _管理注册窗口_创建完毕, 空白型, , 
获取焦点 ()

.子程序 _用户名编辑框_内容被改变, 空白型, , 输入用户名长度不能超过5个汉字或10个字母、数字，否则弹出错误信息
.判断开始 (大于 (取文本长度 (.内容), 10))
    信息框 (“用户名长度不要超过5个汉字或10个字母、数字”, 相加 (0, #错误图标), “错误信息！”)
    获取焦点 ()
.默认
    返回 ()
.判断结束


.子程序 _登陆密码编辑框_内容被改变, 空白型, , 登录密码不能超过6个汉字或12个字母、数字，否则弹出错误信息
.判断开始 (大于 (取文本长度 (.内容), 12))
    信息框 (“密码长度不要超过6个汉字或12个字母、数字”, 相加 (0, #错误图标), “错误信息！”)
    获取焦点 ()
.默认
    返回 ()
.判断结束


.子程序 _初次注册按钮_被单击, 空白型, , 用户名及登录密码不能为空，但也不能少于4个字符，否则弹出错误信息；正确则写入帐户管理数据库，并提示注册成功
.判断开始 (或者 (等于 (.内容, “”), 等于 (.内容, “”), 小于 (取文本长度 (.内容), 4), 小于 (取文本长度 (.内容), 4)))
    信息框 (“输入框内容不能为空或长度不足4个字母、数字”, 相加 (0, #错误图标), “错误信息！”)
    返回 ()
.默认
    
.判断结束
.如果 (等于 (加记录 (.内容, .内容, “超级管理员”), 真))
    赋值 (.输入方式, 2)
    信息框 (“管理员账号注册成功，使用刚注册的用户名登陆本系统！”, 相加 (0, #信息图标), “注册成功”)
    销毁 ()
.否则
    
.如果结束


.子程序 _用户名编辑框_按下某键, 逻辑型, , 输完用户名后，如果登录密码没有输时，点击回车键，光标移至登录密码框，否则等同于点击注册按钮
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    .如果 (等于 (.内容, “”))
        获取焦点 ()
    .否则
        _初次注册按钮_被单击 ()
    .如果结束
    
.如果真结束


.子程序 _登陆密码编辑框_按下某键, 逻辑型, , 输完登录密码后，如果用户名框没有输入，点击回车键，光标移至用户名框，否则等同于点击注册按钮
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    .如果 (等于 (.内容, “”))
        获取焦点 ()
    .否则
        _初次注册按钮_被单击 ()
    .如果结束
    
.如果真结束


.子程序 _管理注册窗口_将被销毁, 空白型, , 注册窗口销毁时，如果帐户管理中仍没有数据，则结束程序运行
.如果 (等于 (取记录数 (), 0))
    结束 ()
.否则
    
.如果结束


.子程序 _初次注册按钮_按下某键, 逻辑型, , 这个就不用再解释了吧
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _初次注册按钮_被单击 ()
.如果真结束


.窗口程序集 背景窗口程序集, , , 

.子程序 _背景窗口_创建完毕, 空白型, , 
置父窗口 (界面窗口.) ' 将_启动窗口的外形框作为此功能窗口的父窗口
移动 (0, 0, 界面窗口.取用户区宽度 (.), 界面窗口.取用户区高度 (.)) ' 调整此功能窗口的位置
赋值 (背景窗口., #背景)




.窗口程序集 部门设置窗口程序集, , , 

.子程序 _部门设置窗口_创建完毕, 空白型, , 判断 系统种类设置窗口是否已被载入，是的话则要进行销毁
.如果 (不等于 (窗口句柄, 0))
    窗口名称.销毁 ()
.否则
    赋值 (窗口句柄, 取窗口句柄 ())
    赋值 (窗口名称, 部门设置窗口)
.如果结束


.子程序 _单选框1_被单击, 空白型, , 
赋值 (设置类别, 1)
销毁 ()
载入 (系统种类设置窗口, , 假)

.子程序 _单选框2_被单击, 空白型, , 
赋值 (设置类别, 2)
销毁 ()
载入 (系统种类设置窗口, , 假)

.子程序 _单选框3_被单击, 空白型, , 
赋值 (设置类别, 3)
销毁 ()
载入 (系统种类设置窗口, , 假)

.子程序 _单选框4_被单击, 空白型, , 
赋值 (设置类别, 4)
销毁 ()
载入 (系统种类设置窗口, , 假)

.子程序 _单选框5_被单击, 空白型, , 
赋值 (设置类别, 5)
销毁 ()
载入 (系统种类设置窗口, , 假)

.子程序 _单选框6_被单击, 空白型, , 
赋值 (设置类别, 6)
销毁 ()
载入 (系统种类设置窗口, , 假)

.子程序 _单选框7_被单击, 空白型, , 
赋值 (设置类别, 7)
销毁 ()
载入 (系统种类设置窗口, , 假)

.子程序 _单选框8_被单击, 空白型, , 
赋值 (设置类别, 8)
销毁 ()
载入 (系统种类设置窗口, , 假)

.子程序 _单选框9_被单击, 空白型, , 
赋值 (设置类别, 9)
销毁 ()
载入 (系统种类设置窗口, , 假)

.子程序 _单选框10_被单击, 空白型, , 
赋值 (设置类别, 10)
销毁 ()
载入 (系统种类设置窗口, , 假)

.子程序 _部门设置窗口_将被销毁, 空白型, , 
赋值 (窗口句柄, 0)

.程序集 公用子程序程序集, , , 

.子程序 基本信息列表框显示新加内容, 空白型, , 
.局部变量 循环次数, 整数型, , , 
.局部变量 表项索引, 整数型, , , 
.局部变量 表项列索引, 整数型, , , 

置个人信息为当前库 ()
到尾记录 ()
赋值 (表项索引, 个人信息窗口.插入表项 (., -1, , , , , ))
赋值 (表项列索引, 0)
.计次循环首 (取字段数 (), 循环次数)
    .如果 (或者 (等于 (循环次数, 4), 等于 (循环次数, 5), 等于 (循环次数, 7), 等于 (循环次数, 11), 等于 (循环次数, 12), 等于 (循环次数, 13), 等于 (循环次数, 14)))
        到循环尾 ()
    .否则
        .如果 (等于 (循环次数, 23))
            .如果 (等于 (到文本 (读字段 (到文本 (取字段名 (循环次数)), )), “”))
                个人信息窗口.置标题 (., 表项索引, 表项列索引, “×”)
            .否则
                个人信息窗口.置标题 (., 表项索引, 表项列索引, “√”)
            .如果结束
            赋值 (表项列索引, 相加 (表项列索引, 1))
        .否则
            个人信息窗口.置标题 (., 表项索引, 表项列索引, 读字段 (到文本 (取字段名 (循环次数)), ))
            赋值 (表项列索引, 相加 (表项列索引, 1))
        .如果结束
        
    .如果结束
    
.计次循环尾 ()

.子程序 填入个人信息, 空白型, , 
.局部变量 部门, 文本型, , , 
.局部变量 岗位, 文本型, , , 
.局部变量 工种, 文本型, , , 

赋值 (部门, 读 (#部门班组个人信息库))
赋值 (岗位, 读 (#岗位名称个人信息库))
赋值 (工种, 读 (#工种个人信息库))
赋值 (基本信息添加窗口..内容, 读 (#姓名个人信息库))
赋值 (基本信息添加窗口..内容, 读 (#身份证号个人信息库))
赋值 (基本信息添加窗口..内容, 读 (#职工号个人信息库))
赋值 (基本信息添加窗口..内容, 读 (#民族个人信息库))
赋值 (基本信息添加窗口..内容, 读 (#血型个人信息库))
赋值 (基本信息添加窗口..内容, 读 (#性别个人信息库))
赋值 (基本信息添加窗口..内容, 读 (#出生年月个人信息库))
赋值 (基本信息添加窗口..内容, 读 (#家庭地址个人信息库))
赋值 (基本信息添加窗口..内容, 读 (#身份证所属区域个人信息库))
赋值 (基本信息添加窗口..内容, 读 (#毕业院校个人信息库))
赋值 (基本信息添加窗口..内容, 读 (#所学专业个人信息库))
赋值 (基本信息添加窗口..内容, 读 (#联系电话个人信息库))
赋值 (基本信息添加窗口..内容, 读 (#参加工作时间个人信息库))
赋值 (基本信息添加窗口..内容, 读 (#入厂时间个人信息库))
基本信息添加窗口.选择 (., 读 (#文化程度个人信息库))
基本信息添加窗口.选择 (., 读 (#单位名称个人信息库))
_单位组合框_列表项被选择 ()
基本信息添加窗口.选择 (., 部门)
_部门班组组合框_列表项被选择 ()
基本信息添加窗口.选择 (., 岗位)
_岗位名称组合框_列表项被选择 ()
基本信息添加窗口.选择 (., 工种)
计算年龄 ()
赋值 (基本信息添加窗口..内容, 到文本 (年龄))
置当前库 (相加 (当前目录, “\”, #个人信息数据库, “.edb”))
基本信息添加窗口.选择 (., 读 (#职务个人信息库))
基本信息添加窗口.选择 (., 读 (#政治面貌个人信息库))
基本信息添加窗口.选择 (., 读 (#状态个人信息库))
基本信息添加窗口.选择 (., 读 (#用工形式个人信息库))
赋值 (基本信息添加窗口..图片, 读 (#个人照片个人信息库))

.子程序 置个人信息为当前库, 空白型, , 
置当前库 (相加 (当前目录, “\”, #个人信息数据库, “.edb”))
到首记录 ()

.子程序 置类型设置为当前库, 空白型, , 
置当前库 (相加 (当前目录, “\”, #类型设置数据库, “.edb”))
到首记录 ()

.子程序 置账户管理为当前库, 空白型, , 
置当前库 (相加 (当前目录, “\”, #账户管理数据库, “.edb”))
到首记录 ()

.子程序 取出生年月日, 空白型, , 
.局部变量 日期, 文本型, , , 
.局部变量 月, 文本型, , , 
.局部变量 日, 文本型, , , 

.如果 (等于 (取文本长度 (基本信息添加窗口..内容), 18))
    赋值 (日期, 取文本中间 (基本信息添加窗口..内容, 7, 8))
    赋值 (月, 取文本中间 (日期, 5, 2))
    赋值 (日, 取文本右边 (日期, 2))
    赋值 (日期, 相加 (取文本左边 (日期, 4), “-”, 月, “-”, 日))
    
.否则
    赋值 (日期, 取文本中间 (基本信息添加窗口..内容, 7, 6))
    赋值 (月, 取文本中间 (日期, 3, 2))
    赋值 (日, 取文本右边 (日期, 2))
    赋值 (日期, 相加 (“19”, 取文本左边 (日期, 2), “-”, 月, “-”, 日))
.如果结束
赋值 (出生年月日, 日期)

.子程序 计算年龄, 空白型, , 
.如果 (或者 (等于 (覆盖操作全局变量, “是”), 等于 (查询识别符, “查询”)))
    赋值 (年龄, 取时间间隔 (系统时间, 到时间 (基本信息添加窗口..内容), 1))
    .如果真 (小于 (取月份 (系统时间), 取月份 (到时间 (基本信息添加窗口..内容))))
        赋值 (年龄, 相减 (年龄, 1))
    .如果真结束
    .如果真 (等于 (取月份 (系统时间), 取月份 (到时间 (基本信息添加窗口..内容))))
        .判断开始 (小于 (取日 (系统时间), 取日 (到时间 (基本信息添加窗口..内容))))
            赋值 (年龄, 相减 (年龄, 1))
        .默认
            
        .判断结束
        
    .如果真结束
    
.否则
    赋值 (年龄, 取时间间隔 (系统时间, 到时间 (出生年月日), 1))
    .如果真 (小于 (取月份 (系统时间), 取月份 (到时间 (出生年月日))))
        赋值 (年龄, 相减 (年龄, 1))
    .如果真结束
    .如果真 (等于 (取月份 (系统时间), 取月份 (到时间 (出生年月日))))
        .判断开始 (小于 (取日 (系统时间), 取日 (到时间 (出生年月日))))
            赋值 (年龄, 相减 (年龄, 1))
        .默认
            
        .判断结束
        
    .如果真结束
    
.如果结束


.子程序 销毁多余窗口, 空白型, , 
.如果真 (不等于 (窗口句柄, 0))
    窗口名称.销毁 ()
.如果真结束


.窗口程序集 查询窗口程序集, , , 

.程序集变量 选择类别, 整数型, , , 
.程序集变量 关键字段名, 文本型, , , 
.子程序 _查询窗口_创建完毕, 空白型, , 
赋值 (窗口句柄, 取窗口句柄 ())
赋值 (窗口名称, 查询窗口)
连续赋值 (假, .可视, .可视, .可视, .可视)

.子程序 _单选框1_被单击, 空白型, , 
赋值 (查询窗口., .标题)
赋值 (选择类别, 1)
连续赋值 (假, .可视, .可视, .可视)
连续赋值 (真, .可视, .可视, .可视)
.如果 (等于 (查询识别符, “查询”))
    赋值 (.可视, 真)
.否则
    赋值 (.顶边, 20)
    赋值 (.顶边, 47)
    赋值 (.顶边, 80)
.如果结束
获取焦点 ()
赋值 (关键字段名, “职工号”)

.子程序 _单选框2_被单击, 空白型, , 
赋值 (查询窗口., .标题)
赋值 (选择类别, 2)
连续赋值 (假, .可视, .可视, .可视)
连续赋值 (真, .可视, .可视, .可视)
.如果 (等于 (查询识别符, “查询”))
    赋值 (.可视, 真)
.否则
    赋值 (.顶边, 20)
    赋值 (.顶边, 47)
    赋值 (.顶边, 80)
.如果结束
获取焦点 ()
赋值 (关键字段名, “姓名”)

.子程序 _单选框3_被单击, 空白型, , 
赋值 (查询窗口., .标题)
赋值 (选择类别, 3)
连续赋值 (假, .可视, .可视, .可视)
连续赋值 (真, .可视, .可视, .可视)
.如果 (等于 (查询识别符, “查询”))
    赋值 (.可视, 真)
.否则
    赋值 (.顶边, 20)
    赋值 (.顶边, 47)
    赋值 (.顶边, 80)
.如果结束
获取焦点 ()
赋值 (关键字段名, “身份证号”)

.子程序 _确定按钮_被单击, 空白型, , 
.局部变量 提示信息, 文本型, , , 

.如果 (等于 (.内容, “”))
    信息框 (“请输入您要查询的关键字！”, 0, )
.否则
    .如果 (并且 (等于 (.选中, 真), 等于 (查询识别符, “查询”)))
        置个人信息为当前库 ()
        查找 (等于 (读 (关键字段名), .内容))
        赋值 (查询识别符, “”)
        查询窗口.销毁 ()
        个人信息窗口.选择表项 (., 相减 (取记录数 (), 取记录号 ()))
    .否则
        载入 (基本信息添加窗口, , 假)
        置个人信息为当前库 ()
        .如果 (等于 (查找 (等于 (读 (关键字段名), .内容)), 真))
            个人信息窗口.选择表项 (., 相减 (取记录数 (), 取记录号 ()))
            填入个人信息 ()
            .如果 (等于 (查询识别符, “查询”))
                赋值 (基本信息添加窗口., 相加 (“  ”, 基本信息添加窗口..内容, “  的基本信息  ”))
            .否则
                赋值 (覆盖操作全局变量, “是”)
                赋值 (基本信息添加窗口..标题, “修  改”)
                赋值 (基本信息添加窗口., 相加 (“修改职工  ”, 基本信息添加窗口..内容, “  的基本信息  ”))
            .如果结束
            查询窗口.销毁 ()
        .否则
            基本信息添加窗口.销毁 ()
            赋值 (提示信息, 多项选择 (选择类别, “职工编号为  ”, “职工姓名为  ”, “职工身份证编号为  ”))
            信息框 (相加 (“未查找到”, 提示信息, .内容, “  的信息，请核实后再进行查找！”), 0, )
            获取焦点 ()
            赋值 (.被选择字符数, -1)
            返回 ()
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 _查询窗口_将被销毁, 空白型, , 杜绝点了查询却未进行，再点击删除出错问题
赋值 (窗口句柄, 0)

.子程序 _关键字编辑框_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (不等于 (.内容, “”))
    .如果真 (等于 (字符代码, #回车键))
        _确定按钮_被单击 ()
    .如果真结束
    
.否则
    
.如果结束


.窗口程序集 系统种类设置窗口程序集, , , 

.子程序 _系统种类设置窗口_创建完毕, 空白型, , 
.局部变量 循环次数, 整数型, , , 

赋值 (窗口句柄, 取窗口句柄 ())
赋值 (窗口名称, 系统种类设置窗口)
置类型设置为当前库 ()
赋值 (系统种类设置窗口., 多项选择 (设置类别, “设置单位车间”, “设置部门班组”, “设置岗位名称”, “设置工种名称”, “设置政治面貌”, “设置学历名称”, “设置职务名称”, “设置用工形式”, “设置在岗状态”, “查看单位部门结构”))
赋值 (查找内容, 多项选择 (设置类别, “单位名称”, “部门班组”, “岗位名称”, “工种”, “政治面貌”, “文化程度”, “职务”, “用工形式”, “状态”, “”))
.如果真 (等于 (设置类别, 10))
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (系统种类设置窗口., 相除 (相减 (取屏幕宽度 (), 290), 2))
    赋值 (系统种类设置窗口., 290)
    赋值 (.高度, 200)
    赋值 (.宽度, 250)
    赋值 (.播放次数, 假)
.如果真结束
.如果真 (或者 (等于 (设置类别, 2), 等于 (设置类别, 3), 等于 (设置类别, 4)))
    赋值 (.可视, 真)
    “先选择单位”.加入项目 ()
    .计次循环首 (取记录数 (), 循环次数)
        .如果 (等于 (读 (#种类类型设置管理库), “单位名称”))
            读 (#内容名称类型设置管理库).加入项目 (到数值 (读 (#单位识别编码类型设置管理库)))
        .否则
            
        .如果结束
        跳过 (1)
    .计次循环尾 ()
    赋值 (.现行选中项, 0)
    赋值 (系统种类设置窗口., 300)
    赋值 (系统种类设置窗口..顶边, 60)
    赋值 (.顶边, 240)
    赋值 (.顶边, 240)
.如果真结束

.如果真 (或者 (大于 (设置类别, 4), 等于 (设置类别, 1)))
    树形框加入数据 ()
.如果真结束


.子程序 _单位名称组合框1_列表项被选择, 空白型, , 
.局部变量 循环次数, 整数型, , , 
.局部变量 单位名称, 文本型, , , 
.局部变量 临时代码, 文本型, , , 
.局部变量 单位代码, 文本型, , , 
.局部变量 分割代码, 文本型, , "0", 

.如果真 (等于 (.现行选中项, 0))
    清空 ()
    返回 ()
.如果真结束

 ' ↑ ****如果选中“先选择单位”，清空树形框的数据，无任何操作。

.如果真 (等于 (设置类别, 2))
    清空 ()
    树形框加入数据 ()
.如果真结束

 ' ↑ ****选择单位列表，并显示选中单位下的班组、部门清单

.如果真 (或者 (等于 (设置类别, 3), 等于 (设置类别, 4)))
    赋值 (单位名称, .内容)
    赋值 (临时代码, 到文本 (.取项目数值 (.现行选中项)))
    赋值 (.可视, 假)
    赋值 (.可视, 真)
    “请继续选择部门、班组”.加入项目 ()
    赋值 (.现行选中项, 0)
    到首记录 ()
    .计次循环首 (取记录数 (), 循环次数)
        .如果 (等于 (读 (#种类类型设置管理库), “部门班组”))
            赋值 (单位代码, 读 (#单位识别编码类型设置管理库))
            赋值 (分割代码, 分割文本 (单位代码, “|”, ))
            .如果真 (等于 (到数值 (临时代码), 到数值 (分割代码 [1])))
                相加 (单位名称, “ \ ”, 读 (#内容名称类型设置管理库)).加入项目 (到数值 (子文本替换 (单位代码, “|”, , , , 真)))
            .如果真结束
            
        .否则
            
        .如果结束
        跳过 (1)
    .计次循环尾 ()
    .如果 (等于 (设置类别, 4))
        赋值 (.左边, 104)
        赋值 (.可视, 真)
        赋值 (.左边, 197)
        赋值 (.顶边, 240)
    .否则
        赋值 (.左边, 150)
    .如果结束
    赋值 (.宽度, 329)
    赋值 (系统种类设置窗口., 370)
    赋值 (系统种类设置窗口..宽度, 329)
    赋值 (.可视, 真)
    赋值 (.左边, 284)
    赋值 (.顶边, 240)
.如果真结束


.子程序 _部门组合框_列表项被选择, 空白型, , 
.局部变量 循环次数, 整数型, , , 
.局部变量 临时代码, 文本型, , , 
.局部变量 单位代码, 文本型, , , 
.局部变量 分割代码, 文本型, , "0", 
.局部变量 单位名称, 文本型, , , 

.如果真 (等于 (.现行选中项, 0))
    清空 ()
    返回 ()
.如果真结束
.如果真 (等于 (设置类别, 3))
    清空 ()
    树形框加入数据 ()
.如果真结束
.如果真 (等于 (设置类别, 4))
    赋值 (临时代码, 到文本 (.取项目数值 (.现行选中项)))
    赋值 (单位名称, .内容)
    赋值 (.可视, 假)
    赋值 (.可视, 真)
    赋值 (.宽度, 329)
    “请选择添加工种的岗位”.加入项目 ()
    赋值 (.现行选中项, 0)
    到首记录 ()
    .计次循环首 (取记录数 (), 循环次数)
        .如果 (等于 (读 (#种类类型设置管理库), “岗位名称”))
            赋值 (单位代码, 读 (#单位识别编码类型设置管理库))
            赋值 (分割代码, 分割文本 (单位代码, “|”, ))
            .如果真 (等于 (到数值 (临时代码), 到数值 (相加 (分割代码 [1], 分割代码 [2]))))
                相加 (单位名称, “ \ ”, 读 (#内容名称类型设置管理库)).加入项目 (到数值 (子文本替换 (单位代码, “|”, , , , 真)))
            .如果真结束
            
        .否则
            
        .如果结束
        跳过 (1)
    .计次循环尾 ()
.如果真结束


.子程序 _岗位组合框_列表项被选择, 空白型, , 
.如果真 (等于 (.现行选中项, 0))
    清空 ()
    返回 ()
.如果真结束
清空 ()
树形框加入数据 ()

.子程序 树形框加入数据, 空白型, , 将对应的数据填入到树形框中
.局部变量 单位识别, 文本型, , , 
.局部变量 循环次数, 整数型, , , 
.局部变量 部门识别, 文本型, , , 
.局部变量 分割代码, 文本型, , "0", 
.局部变量 临时识别码, 文本型, , , 
.局部变量 次数, 整数型, , , 
.局部变量 数组个数, 整数型, , , 
.局部变量 单位代码, 整数型, , , 
.局部变量 循环计次, 整数型, , , 

到首记录 ()
.如果真 (等于 (设置类别, 1))
    .计次循环首 (取记录数 (), 循环次数)
        .如果 (等于 (读 (#种类类型设置管理库), 查找内容))
            .加入项目 (读 (#内容名称类型设置管理库), , , 到数值 (读 (#单位识别编码类型设置管理库)))
        .否则
            
        .如果结束
        跳过 (1)
    .计次循环尾 ()
.如果真结束

.如果真 (等于 (设置类别, 2))
    .加入项目 (相加 (.内容, “ <--(单位)”), , , )
    赋值 (临时识别码, 到文本 (.取项目数值 (.现行选中项)))
    赋值 (单位识别, 相加 (取重复文本 (相减 (3, 取文本长度 (临时识别码)), “0”), 临时识别码))
    .计次循环首 (取记录数 (), 循环次数)
        .如果 (等于 (读 (#种类类型设置管理库), 查找内容))
            赋值 (临时识别码, 读 (#单位识别编码类型设置管理库))
            赋值 (分割代码, 分割文本 (临时识别码, “|”, ))
            .如果真 (等于 (单位识别, 分割代码 [1]))
                0.加入项目 (读 (#内容名称类型设置管理库), , , 到数值 (子文本替换 (读 (#单位识别编码类型设置管理库), “|”, , , , 假)))
            .如果真结束
            
        .否则
            
        .如果结束
        跳过 (1)
    .计次循环尾 ()
    0.扩展 ()
.如果真结束

.如果真 (等于 (设置类别, 3))
    .加入项目 (相加 (.内容, “ <--(部门)”), , , )
    赋值 (临时识别码, 到文本 (.取项目数值 (.现行选中项)))
    .如果 (等于 (查找 (等于 (到数值 (子文本替换 (读 (#单位识别编码类型设置管理库), “|”, , , , 真)), 到数值 (临时识别码))), 真))
        赋值 (单位识别, 读 (#单位识别编码类型设置管理库))
        .计次循环首 (取记录数 (), 循环次数)
            .如果 (等于 (读 (#种类类型设置管理库), 查找内容))
                赋值 (临时识别码, 读 (#单位识别编码类型设置管理库))
                赋值 (分割代码, 分割文本 (临时识别码, “|”, ))
                .如果真 (等于 (到数值 (子文本替换 (单位识别, “|”, , , , 真)), 到数值 (相加 (分割代码 [1], 分割代码 [2]))))
                    0.加入项目 (读 (#内容名称类型设置管理库), , , 到数值 (子文本替换 (读 (#单位识别编码类型设置管理库), “|”, , , , 真)))
                .如果真结束
                
            .否则
                
            .如果结束
            跳过 (1)
        .计次循环尾 ()
        0.扩展 ()
    .否则
        
    .如果结束
    
.如果真结束

.如果真 (等于 (设置类别, 4))
    .加入项目 (相加 (.内容, “ <--(岗位)”), , , )
    赋值 (临时识别码, 到文本 (.取项目数值 (.现行选中项)))
    .如果 (等于 (查找 (等于 (到数值 (子文本替换 (读 (#单位识别编码类型设置管理库), “|”, , , , 真)), 到数值 (临时识别码))), 真))
        赋值 (单位识别, 读 (#单位识别编码类型设置管理库))
        .计次循环首 (取记录数 (), 循环次数)
            .如果 (等于 (读 (#种类类型设置管理库), 查找内容))
                赋值 (临时识别码, 读 (#单位识别编码类型设置管理库))
                赋值 (分割代码, 分割文本 (临时识别码, “|”, ))
                .如果真 (等于 (到数值 (子文本替换 (单位识别, “|”, , , , 真)), 到数值 (相加 (分割代码 [1], 分割代码 [2], 分割代码 [3]))))
                    0.加入项目 (读 (#内容名称类型设置管理库), , , 到数值 (子文本替换 (读 (#单位识别编码类型设置管理库), “|”, , , , 真)))
                .如果真结束
                
            .否则
                
            .如果结束
            跳过 (1)
        .计次循环尾 ()
        0.扩展 ()
    .否则
        
    .如果结束
    
.如果真结束

.如果真 (并且 (大于 (设置类别, 4), 不等于 (设置类别, 10)))
    .计次循环首 (取记录数 (), 循环次数)
        .如果 (等于 (读 (#种类类型设置管理库), 查找内容))
            .加入项目 (读 (#内容名称类型设置管理库), , , )
        .否则
            
        .如果结束
        跳过 (1)
    .计次循环尾 ()
.如果真结束

.如果真 (等于 (设置类别, 10))
    .计次循环首 (取记录数 (), 循环次数)
        .如果真 (等于 (读 (#种类类型设置管理库), “单位名称”))
            .加入项目 (读 (#内容名称类型设置管理库), , , 到数值 (读 (#单位识别编码类型设置管理库)))
        .如果真结束
        .如果真 (等于 (读 (#种类类型设置管理库), “部门班组”))
            赋值 (单位代码, 到数值 (读 (#单位识别编码类型设置管理库)))
            .计次循环首 (取项目数 (), 循环计次)
                .如果真 (等于 (相减 (循环计次, 1).取项目数值 (), 单位代码))
                    相减 (循环计次, 1).加入项目 (读 (#内容名称类型设置管理库), , , 到数值 (子文本替换 (读 (#单位识别编码类型设置管理库), “|”, , , 1, 真)))
                .如果真结束
                
            .计次循环尾 ()
        .如果真结束
        .如果真 (等于 (读 (#种类类型设置管理库), “岗位名称”))
            赋值 (单位代码, 到数值 (子文本替换 (读 (#单位识别编码类型设置管理库), “|”, , , 1, 真)))
            .计次循环首 (取项目数 (), 循环计次)
                .如果真 (等于 (相减 (循环计次, 1).取项目数值 (), 单位代码))
                    相减 (循环计次, 1).加入项目 (读 (#内容名称类型设置管理库), , , 到数值 (子文本替换 (读 (#单位识别编码类型设置管理库), “|”, , , 2, 真)))
                .如果真结束
                
            .计次循环尾 ()
        .如果真结束
        .如果真 (等于 (读 (#种类类型设置管理库), “工种”))
            赋值 (单位代码, 到数值 (子文本替换 (读 (#单位识别编码类型设置管理库), “|”, , , 2, 真)))
            .计次循环首 (取项目数 (), 循环计次)
                .如果真 (等于 (相减 (循环计次, 1).取项目数值 (), 单位代码))
                    相减 (循环计次, 1).加入项目 (读 (#内容名称类型设置管理库), , , 到数值 (子文本替换 (读 (#单位识别编码类型设置管理库), “|”, , , 3, 真)))
                .如果真结束
                
            .计次循环尾 ()
        .如果真结束
        跳过 (1)
    .计次循环尾 ()
.如果真结束


.子程序 _树型框1_开始编辑, 逻辑型, , 
.参数 项目索引, 整数型, , 

.如果 (小于或等于 (设置类别, 4))
    .如果 (或者 (并且 (等于 (设置类别, 2), 等于 (.取缩进层次 (.最大化按钮), 1)), 并且 (等于 (设置类别, 3), 等于 (.取缩进层次 (.最大化按钮), 1))))
        返回 (假)
    .否则
        
    .如果结束
    到首记录 ()
    查找 (并且 (等于 (读 (#内容名称类型设置管理库), 项目索引.取项目文本 ()), 等于 (读 (#种类类型设置管理库), 查找内容)))
.否则
    到首记录 ()
    查找 (并且 (等于 (读 (#内容名称类型设置管理库), 项目索引.取项目文本 ()), 等于 (读 (#种类类型设置管理库), 查找内容)))
.如果结束


.子程序 _树型框1_结束编辑, 逻辑型, , 编辑完后首先要判断下编辑前后的内容是否相同，不同的话再检查在同一子项中是否有重复的项；如果更改的是单位名称，则还需要把所有与该单位相关的部门班组和岗位的单位识别一同修改。
.参数 项目索引, 整数型, , 

.局部变量 父项索引, 整数型, , , 
.局部变量 计数, 整数型, , , 
.局部变量 改前文本, 文本型, , , 
.局部变量 改后文本, 文本型, , , 

赋值 (父项索引, 项目索引.取父项目 ())
赋值 (改前文本, 项目索引.取项目文本 ())
赋值 (改后文本, .回车下移焦点)
.如果真 (等于 (改后文本, “”))
    返回 (假)
.如果真结束
.计次循环首 (取项目数 (), 计数)
    .如果真 (等于 (相减 (计数, 1).取父项目 (), 父项索引))
        .如果真 (并且 (不等于 (改前文本, 相减 (计数, 1).取项目文本 ()), 等于 (相减 (计数, 1).取项目文本 (), 改后文本)))
            信息框 (“你输入的内容与现有的分类名称重复，请重新输入！”, 相加 (0, #信息图标), )
            返回 (假)
        .如果真结束
        
    .如果真结束
    
.计次循环尾 ()
.如果 (不等于 (改前文本, 改后文本))
    .如果 (等于 (修改 (改后文本, ), 真))
        信息框 (“修改成功！”, #信息图标, )
    .否则
        信息框 (“修改失败！请关闭程序，重新操作。”, #信息图标, )
    .如果结束
    
.否则
    
.如果结束


.子程序 _删除按钮系统设置_被单击, 空白型, , 分类判断，如果是部门班组和岗位，则不能删除父项（单位名称）；如果是单位名称，删除时要同时删除该单位下所有子项（即部门班组和岗位）
.局部变量 项目代码, 整数型, , , 
.局部变量 项目名称, 文本型, , , 
.局部变量 循环次数, 整数型, , , 

.如果真 (等于 (.现行选中项, 0))
    信息框 (“请选择要删除的单位！”, #信息图标, “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (.现行选中项, 0))
    信息框 (“请选择要删除的部门或班组！”, #信息图标, “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (.现行选中项, 0))
    信息框 (“请选择要删除的岗位！”, #信息图标, “提示信息”)
    返回 ()
.如果真结束
赋值 (项目名称, .取项目文本 (.最大化按钮))
赋值 (项目代码, .取项目数值 (.最大化按钮))
到首记录 ()
.如果真 (等于 (设置类别, 1))
    .如果真 (等于 (信息框 (相加 (“你选择了”, #左引号, 项目名称, #右引号, “，真的要删除该单位吗？”), 相加 (#警告图标, #是否钮), “警告！！”), #是钮))
        .如果真 (等于 (信息框 (相加 (“要删除”, #左引号, 项目名称, #右引号, “将同时删除该单位下所有部门、班组、岗位及工种，并且不能恢复!”, #换行符, #换行符, “你真的确定要删除”, #左引号, 项目名称, #右引号, “?”), 相加 (#警告图标, #是否钮), “警告！！”), #是钮))
            .删除项目 (.最大化按钮)
            删除 (等于 (到数值 (读 (#单位识别编码类型设置管理库)), 项目代码))
            彻底删除 ()
        .如果真结束
        
    .如果真结束
    
.如果真结束

.如果真 (等于 (设置类别, 2))
    .如果 (小于 (.最大化按钮, 1))
        信息框 (“请选择要删除的部门或班组！”, #信息图标, “提示信息”)
        返回 ()
    .否则
        .如果真 (等于 (信息框 (相加 (“你选择了”, #左引号, .内容, “ \ ”, 项目名称, #右引号, “，真的要删除该部门或班组吗？”), 相加 (#警告图标, #是否钮), “警告！！”), #是钮))
            .如果真 (等于 (信息框 (相加 (“要删除”, #左引号, .内容, “ \ ”, 项目名称, #右引号, “将同时删除该部门或班组下的所有岗位及工种，并且不能恢复!”, #换行符, #换行符, “你真的确定要删除”, #左引号, .内容, “ \ ”, 项目名称, #右引号, “?”), 相加 (#警告图标, #是否钮), “警告！！”), #是钮))
                .删除项目 (.最大化按钮)
                删除 (等于 (到数值 (子文本替换 (读 (#单位识别编码类型设置管理库), “|”, , , 1, 真)), 项目代码))
                彻底删除 ()
            .如果真结束
            
        .如果真结束
        
    .如果结束
    
.如果真结束

.如果真 (等于 (设置类别, 3))
    .如果 (小于 (.最大化按钮, 1))
        信息框 (“请选择要删除的岗位！”, #信息图标, “提示信息”)
        返回 ()
    .否则
        .如果真 (等于 (信息框 (相加 (“你选择了”, #左引号, .内容, “ \ ”, 项目名称, #右引号, “，真的要删除该岗位吗？”), 相加 (#警告图标, #是否钮), “警告！！”), #是钮))
            .如果真 (等于 (信息框 (相加 (“要删除”, #左引号, .内容, “ \ ”, 项目名称, #右引号, “将同时删除该岗位下的所有工种，并且不能恢复!”, #换行符, #换行符, “你真的确定要删除”, #左引号, .内容, “ \ ”, 项目名称, #右引号, “?”), 相加 (#警告图标, #是否钮), “警告！！”), #是钮))
                .删除项目 (.最大化按钮)
                删除 (等于 (到数值 (子文本替换 (读 (#单位识别编码类型设置管理库), “|”, , , 2, 真)), 项目代码))
                彻底删除 ()
            .如果真结束
            
        .如果真结束
        
    .如果结束
    
.如果真结束

.如果真 (大于或等于 (设置类别, 4))
    .如果 (并且 (等于 (设置类别, 4), 小于 (.最大化按钮, 1)))
        信息框 (“请选择要删除的工种！”, #信息图标, “提示信息”)
        返回 ()
    .否则
        .如果真 (等于 (信息框 (相加 (“你选择了”, #左引号, 项目名称, #右引号, “，真的要删除该”, 查找内容, “吗？”), 相加 (#警告图标, #是否钮), “警告！！”), #是钮))
            .如果真 (等于 (信息框 (相加 (“删除”, #左引号, 项目名称, #右引号, “后，该”, 查找内容, “不能被恢复!”, #换行符, #换行符, “你真的确定要删除该”, 查找内容, “?”), 相加 (#警告图标, #是否钮), “警告！！”), #是钮))
                .删除项目 (.最大化按钮)
                删除 (并且 (等于 (读 (#种类类型设置管理库), 查找内容), 等于 (读 (#内容名称类型设置管理库), 项目名称)))
                彻底删除 ()
            .如果真结束
            
        .如果真结束
        
    .如果结束
    
.如果真结束


.子程序 _添加按钮系统设置_被单击, 空白型, , 添加岗位、部门班组时，必须选择父项（即单位名称）
.如果真 (等于 (设置类别, 2))
    .判断开始 (等于 (.取项目数值 (.现行选中项), 0))
        信息框 (“要添加部门、班组请先选择单位！”, #信息图标, “提示信息”)
        返回 ()
    .默认
        
    .判断结束
    
.如果真结束
.如果真 (等于 (设置类别, 3))
    .判断开始 (等于 (.取项目数值 (.现行选中项), 0))
        信息框 (“要添加岗位请先选择单位！”, #信息图标, “提示信息”)
        返回 ()
    .默认
        
    .判断结束
    .判断开始 (等于 (.取项目数值 (.现行选中项), 0))
        信息框 (“要添加岗位还要再选择部门或班组！”, #信息图标, “提示信息”)
        返回 ()
    .默认
        
    .判断结束
    
.如果真结束
.如果真 (等于 (设置类别, 4))
    .判断开始 (等于 (.取项目数值 (.现行选中项), 0))
        信息框 (“要添加工种请先选择单位！”, #信息图标, “提示信息”)
        返回 ()
    .默认
        
    .判断结束
    .判断开始 (等于 (.取项目数值 (.现行选中项), 0))
        信息框 (“要添加工种还要再选择部门或班组！”, #信息图标, “提示信息”)
        返回 ()
    .默认
        
    .判断结束
    .判断开始 (等于 (.取项目数值 (.现行选中项), 0))
        信息框 (“要添加工种请选择岗位！”, #信息图标, “提示信息”)
        返回 ()
    .默认
        
    .判断结束
    
.如果真结束
载入 (新添项目窗口, 系统种类设置窗口, 假)

.子程序 _返回单位按钮_被单击, 空白型, , 
.局部变量 临时识别码, 文本型, , , 
.局部变量 单位识别, 文本型, , , 
.局部变量 循环次数, 整数型, , , 
.局部变量 分割代码, 文本型, , "0", 

清空 ()
清空 ()
清空 ()
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.宽度, 329)
赋值 (.可视, 真)
赋值 (.现行选中项, 0)

.子程序 _返回部门按钮_被单击, 空白型, , 
清空 ()
清空 ()
赋值 (.可视, 假)
赋值 (.可视, 真)
赋值 (.现行选中项, 0)

.子程序 _树型框1_鼠标右键被放开, 逻辑型, , 弹出菜单
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (不等于 (设置类别, 10))
    弹出菜单 ()
.否则
    
.如果结束


.子程序 _添加_被选择, 空白型, , 
_添加按钮系统设置_被单击 ()

.子程序 _重命名_被选择, 空白型, , 
.进入编辑 (.最大化按钮)

.子程序 _删除_被选择, 空白型, , 
_删除按钮系统设置_被单击 ()

.子程序 _系统种类设置窗口_将被销毁, 空白型, , 关闭窗口时 符值窗口局柄为0，让程序判断本窗口是否已载入
赋值 (窗口句柄, 0)

.窗口程序集 新添项目窗口程序集, , , 

.程序集变量 添加子项目, 文本型, , , 
.子程序 _新添项目窗口_创建完毕, 空白型, , 
赋值 (新添项目窗口., 相加 (“新加”, 取文本右边 (系统种类设置窗口., 相减 (取文本长度 (系统种类设置窗口.), 4))))

.子程序 _新添项目确定按钮_被单击, 空白型, , 
.局部变量 循环次数, 整数型, , , 
.局部变量 树形框项目数, 整数型, , , 
.局部变量 父项索引, 整数型, , , 
.局部变量 代码, 文本型, , , 
.局部变量 临时编码, 整数型, , , 
.局部变量 识别编码, 文本型, , , 
.局部变量 临时识别码, 文本型, , , 

.如果 (等于 (.内容, “”))
    返回 ()
.否则
    
.如果结束
 ' 编辑框内容不能为空
赋值 (树形框项目数, 系统种类设置窗口.取项目数 (.))
.如果 (或者 (等于 (设置类别, 2), 等于 (设置类别, 3)))
    .计次循环首 (树形框项目数, 循环次数)
        赋值 (父项索引, 系统种类设置窗口.取父项目 (., 相减 (循环次数, 1)))
        .如果真 (并且 (等于 (系统种类设置窗口.取项目文本 (., 相减 (循环次数, 1)), .内容), 等于 (父项索引, 0)))
            信息框 (“你输入的内容与现有的分类名称重复，请重新输入！”, 相加 (0, #信息图标), )
            赋值 (.被选择字符数, -1)
            返回 ()
        .如果真结束
        
    .计次循环尾 ()
.否则
    .计次循环首 (树形框项目数, 循环次数)
        .如果真 (等于 (系统种类设置窗口.取项目文本 (., 相减 (循环次数, 1)), .内容))
            信息框 (“你输入的内容与现有的分类名称重复，请重新输入！”, 相加 (0, #信息图标), )
            赋值 (.被选择字符数, -1)
            返回 ()
        .如果真结束
        
    .计次循环尾 ()
.如果结束
 ' 以上部分判断编辑框输入的内容是否与同级别的项目有同名的
.如果真 (等于 (设置类别, 1))
    .如果 (等于 (树形框项目数, 0))
        赋值 (临时编码, 1)
    .否则
        赋值 (临时识别码, 到文本 (系统种类设置窗口.取项目数值 (., 相减 (树形框项目数, 1))))
        赋值 (临时编码, 相加 (到数值 (临时识别码), 1))
    .如果结束
    赋值 (识别编码, 相加 (取重复文本 (相减 (3, 取文本长度 (到文本 (临时编码))), “0”), 到文本 (临时编码)))
.如果真结束

.如果真 (等于 (设置类别, 2))
    赋值 (识别编码, 到文本 (系统种类设置窗口.取项目数值 (., 系统种类设置窗口..现行选中项)))
    赋值 (临时识别码, 到文本 (系统种类设置窗口.取项目数值 (., 相减 (树形框项目数, 1))))
    赋值 (临时识别码, 到文本 (相加 (到数值 (取文本右边 (临时识别码, 3)), 1)))
    赋值 (临时识别码, 相加 (取重复文本 (相减 (3, 取文本长度 (临时识别码)), “0”), 临时识别码))
    赋值 (识别编码, 相加 (取重复文本 (相减 (3, 取文本长度 (识别编码)), “0”), 识别编码))
    赋值 (识别编码, 相加 (识别编码, “|”, 临时识别码))
    
.如果真结束

.如果真 (等于 (设置类别, 3))
    赋值 (识别编码, 到文本 (系统种类设置窗口.取项目数值 (., 系统种类设置窗口..现行选中项)))
    到首记录 ()
    .如果 (等于 (查找 (等于 (到数值 (子文本替换 (读 (#单位识别编码类型设置管理库), “|”, , , , 真)), 到数值 (识别编码))), 真))
        赋值 (识别编码, 读 (#单位识别编码类型设置管理库))
        赋值 (临时识别码, 到文本 (系统种类设置窗口.取项目数值 (., 相减 (树形框项目数, 1))))
        赋值 (临时识别码, 到文本 (相加 (到数值 (取文本右边 (临时识别码, 3)), 1)))
        赋值 (临时识别码, 相加 (取重复文本 (相减 (3, 取文本长度 (临时识别码)), “0”), 临时识别码))
        赋值 (识别编码, 相加 (取重复文本 (相减 (3, 取文本长度 (识别编码)), “0”), 识别编码))
        赋值 (识别编码, 相加 (识别编码, “|”, 临时识别码))
    .否则
        
    .如果结束
    
.如果真结束

.如果真 (等于 (设置类别, 4))
    赋值 (识别编码, 到文本 (系统种类设置窗口.取项目数值 (., 系统种类设置窗口..现行选中项)))
    到首记录 ()
    .如果 (等于 (查找 (等于 (到数值 (子文本替换 (读 (#单位识别编码类型设置管理库), “|”, , , , 真)), 到数值 (识别编码))), 真))
        赋值 (识别编码, 读 (#单位识别编码类型设置管理库))
        赋值 (临时识别码, 到文本 (系统种类设置窗口.取项目数值 (., 相减 (树形框项目数, 1))))
        赋值 (临时识别码, 到文本 (相加 (到数值 (取文本右边 (临时识别码, 3)), 1)))
        赋值 (临时识别码, 相加 (取重复文本 (相减 (3, 取文本长度 (临时识别码)), “0”), 临时识别码))
        赋值 (识别编码, 相加 (取重复文本 (相减 (3, 取文本长度 (识别编码)), “0”), 识别编码))
        赋值 (识别编码, 相加 (识别编码, “|”, 临时识别码))
    .否则
        
    .如果结束
    
.如果真结束

.如果 (等于 (加记录 (查找内容, .内容, 识别编码), 真))
    赋值 (识别编码, 子文本替换 (识别编码, “|”, , , , 真))
    .如果 (或者 (等于 (设置类别, 2), 等于 (设置类别, 3), 等于 (设置类别, 4)))
        系统种类设置窗口.加入项目 (., 0, .内容, , , 到数值 (识别编码))
        赋值 (.内容, “”)
        获取焦点 ()
        系统种类设置窗口.扩展 (., 0)
    .否则
        系统种类设置窗口.加入项目 (., , .内容, , , 到数值 (识别编码))
        赋值 (.内容, “”)
        获取焦点 ()
    .如果结束
    信息框 (“项目添加成功！”, 0, )
.否则
    
.如果结束


.子程序 _编辑框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _新添项目确定按钮_被单击 ()
.如果真结束


.窗口程序集 管理员设置窗口程序集, , , 

.程序集变量 事件, 选择框, , , 
.程序集变量 选择框组件, 选择框, , "10", 
.程序集变量 用户名, 文本型, , , 
.程序集变量 删除, 整数型, , , 
.子程序 _管理员设置窗口_创建完毕, 空白型, , 
赋值 (窗口句柄, 取窗口句柄 ())
赋值 (窗口名称, 管理员设置窗口)
置当前库 (相加 (当前目录, “\”, #账户管理数据库, “.edb”))
赋值 (用户名, 读 (#帐户名账户管理库))
.如果 (等于 (权限, “超级管理员”))
    管理员排序 ()
.否则
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (管理员设置窗口., 220)
    赋值 (管理员设置窗口., 168)
    赋值 (.左边, 6)
    赋值 (.左边, 70)
    赋值 (.顶边, 110)
    管理员设置窗口.移动 (相除 (相减 (取屏幕宽度 (), 220), 2), 相除 (相减 (取屏幕高度 (), 168), 2), , )
.如果结束
.如果 (并且 (大于或等于 (取记录数 (), 11), 等于 (权限, “超级管理员”)))
    信息框 (“您添加的管理员数目已经达到最大限度10个人了，不能继续在添加管理员了！”, 0, )
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.否则
    
.如果结束
获取焦点 ()

.子程序 管理员排序, 空白型, , 
.局部变量 循环次数, 整数型, , , 

到首记录 ()
.计次循环首 (取记录数 (), 循环次数)
    .如果 (等于 (读 (#管理权限账户管理库), “管理员”))
        复制窗口组件 (选择框组件 [相减 (循环次数, 1)])
        赋值 (选择框组件 [相减 (循环次数, 1)].标题, 读 (#帐户名账户管理库))
        赋值 (选择框组件 [相减 (循环次数, 1)].可视, 真)
        .如果 (小于或等于 (循环次数, 6))
            赋值 (选择框组件 [相减 (循环次数, 1)].左边, 相减 (相乘 (相减 (循环次数, 1), 66), 55))
        .否则
            赋值 (选择框组件 [相减 (循环次数, 1)].顶边, 60)
            赋值 (选择框组件 [相减 (循环次数, 1)].左边, 相减 (相乘 (相减 (循环次数, 6), 66), 55))
        .如果结束
        
    .否则
        
    .如果结束
    跳过 (1)
.计次循环尾 ()

.子程序 _选择框_被单击, 空白型, , 
赋值 (事件, 取事件组件 ())
连续赋值 (真, .禁止, .禁止, .禁止, .禁止)
.如果 (等于 (事件.选中, 真))
    赋值 (删除, 相加 (删除, 1))
    删除 (等于 (读 (#帐户名账户管理库), 事件.标题))
.否则
    恢复删除 (等于 (读 (#帐户名账户管理库), 事件.标题))
    赋值 (删除, 相减 (删除, 1))
.如果结束


.子程序 _用户名输入编辑框_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

赋值 (.禁止, 真)
赋值 (.禁止, 真)
.如果 (大于或等于 (取文本长度 (.内容), 7))
    信息框 (“用户名长度不要超过7个字母或3个汉字！”, 0, )
    返回 (0)
.否则
    
.如果结束


.子程序 _密码输入编辑框_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

赋值 (.禁止, 真)
赋值 (.禁止, 真)

.子程序 _原始密码输入编辑框_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

赋值 (.禁止, 真)
赋值 (.禁止, 真)

.子程序 _新密码输入编辑框_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

赋值 (.禁止, 真)
赋值 (.禁止, 真)

.子程序 _管理员设置重置按钮_被单击, 空白型, , 
.局部变量 循环次数, 整数型, , , 

.如果真 (或者 (等于 (.禁止, 真), 等于 (.禁止, 真)))
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    获取焦点 ()
.如果真结束
.如果真 (或者 (并且 (等于 (.禁止, 真), 不等于 (取记录数 (), 11)), 并且 (等于 (.禁止, 真), 不等于 (取记录数 (), 11))))
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    获取焦点 ()
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (或者 (并且 (等于 (.禁止, 真), 等于 (取记录数 (), 11)), 并且 (等于 (.禁止, 真), 等于 (取记录数 (), 11))))
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    获取焦点 ()
.如果真结束
.计次循环首 (相减 (取记录数 (), 1), 循环次数)
    .如果 (等于 (选择框组件 [循环次数], 选中, 真))
        赋值 (选择框组件 [循环次数], 选中, 假)
        恢复删除 (等于 (读 (#帐户名账户管理库), 选择框组件 [循环次数], 标题))
    .否则
        
    .如果结束
    赋值 (删除, 0)
.计次循环尾 ()


.子程序 _管理员设置确定按钮_被单击, 空白型, , 
.局部变量 循环次数, 整数型, , , 
.局部变量 记录数, 整数型, , , 

赋值 (记录数, 取记录数 ())
到首记录 ()
.如果真 (并且 (等于 (.禁止, 真), 等于 (.禁止, 真), 等于 (.禁止, 假), 等于 (.禁止, 假)))
    .如果 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
        信息框 (“修改密码，须输入原始密码及新密码，输入框不能为空”, #信息图标, “提示：”)
        返回 ()
    .否则
        查找 (等于 (读 (#帐户名账户管理库), 用户名))
        .如果 (不等于 (读 (#帐户密码账户管理库), .内容))
            信息框 (“原始密码错误，不能修改登录密码！”, #警告图标, “警告！！”)
            返回 ()
        .否则
            修改 (.内容, , )
            信息框 (“密码修改成功，下次登录请使用新密码。”, #信息图标, “提示：”)
            管理员设置窗口.销毁 ()
        .如果结束
        
    .如果结束
    
.如果真结束

.如果真 (并且 (等于 (.禁止, 真), 等于 (.禁止, 真), 等于 (.禁止, 假), 等于 (.禁止, 假)))
    .如果 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
        信息框 (“添加新管理员必须输入用户名和密码，输入框不能留空。”, #信息图标, “提示：”)
        返回 ()
    .否则
        .如果 (等于 (查找 (等于 (读 (#帐户名账户管理库), .内容)), 真))
            信息框 (“你新添的管理员帐号已经存在，请重新输入管理员帐号。”, #信息图标, “提示：”)
            赋值 (.内容, “”)
            获取焦点 ()
            返回 ()
        .否则
            .如果 (小于 (记录数, 11))
                .如果 (等于 (加记录 (.内容, .内容, “管理员”), 真))
                    复制窗口组件 (选择框组件 [记录数])
                    赋值 (选择框组件 [记录数], 标题, .内容)
                    .如果 (小于或等于 (记录数, 5))
                        赋值 (选择框组件 [记录数], 左边, 相减 (相乘 (记录数, 66), 55))
                    .否则
                        赋值 (选择框组件 [记录数], 顶边, 60)
                        赋值 (选择框组件 [记录数], 左边, 相减 (相乘 (相减 (记录数, 5), 66), 55))
                    .如果结束
                    信息框 (“添加管理员成功。”, 0, “成功”)
                    赋值 (选择框组件 [记录数], 可视, 真)
                    _管理员设置重置按钮_被单击 ()
                .否则
                    信息框 (“添加管理员失败，请关闭程序重新运行。”, 0, “失败”)
                    返回 ()
                .如果结束
                
            .否则
                信息框 (“你添加的管理员已经超过了10个,真的需要那么多吗?请删除不需要的管理员账号!”, 0, )
                赋值 (.内容, “”)
                赋值 (.内容, “”)
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果真结束

.如果真 (大于 (删除, 0))
    .如果 (等于 (信息框 (“你选择了要删除的管理员，此次操作将彻底删除选中的管理员帐号，你真的确定这么做吗？”, 相加 (#是否钮, #警告图标), “警告！！”), #是钮))
        .判断循环首 (小于 (循环次数, 相减 (取记录数 (), 1)))
            赋值 (循环次数, 相加 (循环次数, 1))
            选择框组件.销毁 ( [循环次数])
        .判断循环尾 ()
        彻底删除 ()
        管理员排序 ()
        赋值 (删除, 0)
    .否则
        
    .如果结束
    
.如果真结束


.子程序 _管理员设置窗口_将被销毁, 空白型, , 
赋值 (窗口句柄, 0)

.窗口程序集 劳保设置窗口程序集, , , 

.子程序 _劳保设置窗口_创建完毕, 空白型, , 列表框加入表项标题；组合框加入项目
.局部变量 列宽, 整数型, , , 
.局部变量 循环次数, 整数型, , , 
.局部变量 循环计数, 整数型, , , 
.局部变量 加入, 文本型, , , 
.局部变量 有重复, 整数型, , , 

置父窗口 (界面窗口.)
移动 (0, 0, 界面窗口.取用户区宽度 (.), 界面窗口.取用户区高度 (.))
置当前库 (相加 (当前目录, “\”, #劳保设置数据库, “.edb”))
到首记录 ()
.计次循环首 (取字段数 (), 循环次数)
    赋值 (列宽, 多项选择 (循环次数, 80, 78, 38, 60, 200, 0))
    循环次数.插入列 (取字段名 (循环次数), 列宽, #中间对齐, , )
.计次循环尾 ()
“显示所有”.加入项目 ()
.计次循环首 (取记录数 (), 循环次数)
    超级列表框加数据 ()
    赋值 (有重复, 0)
    赋值 (加入, 读 (#种类劳保管理库))
    .计次循环首 (取项目数 (), 循环计数)
        .如果 (等于 (加入, 相减 (循环计数, 1).取项目文本 ()))
            赋值 (有重复, 1)
        .否则
            
        .如果结束
        
    .计次循环尾 ()
    .如果真 (等于 (有重复, 0))
        加入.加入项目 ()
    .如果真结束
    跳过 (1)
.计次循环尾 ()
赋值 (.现行选中项, 0)

.子程序 _劳保种类组合框_列表项被选择, 空白型, , 根据组合框选中内容，超级列表框显示相关内容
.局部变量 循环次数, 整数型, , , 

全部删除 ()
置当前库 (相加 (当前目录, “\”, #劳保设置数据库, “.edb”))
到首记录 ()
.计次循环首 (取记录数 (), 循环次数)
    .如果 (等于 (.内容, “显示所有”))
        超级列表框加数据 ()
    .否则
        .如果 (等于 (读 (#种类劳保管理库), .内容))
            超级列表框加数据 ()
        .否则
            
        .如果结束
        
    .如果结束
    跳过 (1)
.计次循环尾 ()

.子程序 超级列表框加数据, 空白型, , 根据需要超级列表框加入数据
.局部变量 表项索引, 整数型, , , 
.局部变量 表项列索引, 整数型, , , 
.局部变量 循环次数, 整数型, , , 

赋值 (表项索引, -1.插入表项 ())
赋值 (表项列索引, 0)
.计次循环首 (取字段数 (), 循环次数)
    表项索引.置标题 (表项列索引, 读字段 (到文本 (取字段名 (循环次数)), ))
    赋值 (表项列索引, 相加 (表项列索引, 1))
.计次循环尾 ()

.子程序 _劳保新添加按钮_被单击, 空白型, , 关闭不需要的窗口并弹出添加窗口
销毁多余窗口 ()
载入 (劳保用品添加窗口, , 假)

.子程序 _劳保修改按钮_被单击, 空白型, , 
.局部变量 表项索引数组, 整数型, , "0", 

赋值 (表项索引数组, 取被选择表项 ())
销毁多余窗口 ()
.如果 (等于 (取数组成员数 (表项索引数组), 0))
    信息框 (“请选择需要修改的数据！”, 0, “提示信息”)
    返回 ()
.否则
    
.如果结束
_劳保超级列表框_表项被激活 ()

.子程序 _劳保删除按钮_被单击, 空白型, , 
.局部变量 表项索引数组, 整数型, , "0", 

赋值 (表项索引数组, 取被选择表项 ())
销毁多余窗口 ()
.如果 (等于 (取数组成员数 (表项索引数组), 0))
    信息框 (“请选择需要删除的数据！”, 0, “提示信息”)
    返回 ()
.否则
    
.如果结束
.如果 (等于 (信息框 (“你真的要删除该项，删除后不能被恢复！”, 相加 (#是否钮, #警告图标), “警告！”), #是钮))
    删除 (并且 (等于 (读 (#名称劳保管理库), 表项索引数组.取标题 ( [1], 1)), 等于 (读 (#种类劳保管理库), 表项索引数组.取标题 ( [1], 0)), 等于 (读 (#发放岗位劳保管理库), 表项索引数组.取标题 ( [1], 4)), 等于 (读 (#用工形式劳保管理库), 表项索引数组.取标题 ( [1], 3))))
    彻底删除 ()
    .删除表项 (.)
.否则
    
.如果结束


.子程序 _劳保超级列表框_表项被激活, 空白型, , 根据选中表项，弹出添加窗口，将选中的数据填入弹出的窗口中
.局部变量 表项索引数组, 整数型, , "0", 

赋值 (表项索引数组, 取被选择表项 ())
销毁多余窗口 ()
载入 (劳保用品添加窗口, 界面窗口, 假)
到首记录 ()
查找 (并且 (等于 (读 (#名称劳保管理库), 表项索引数组.取标题 ( [1], 1)), 等于 (读 (#种类劳保管理库), 表项索引数组.取标题 ( [1], ))))
赋值 (劳保用品添加窗口..内容, 读 (#名称劳保管理库))
赋值 (劳保用品添加窗口..内容, 读 (#限期劳保管理库))
赋值 (劳保用品添加窗口..内容, 读 (#发放岗位劳保管理库))
赋值 (劳保用品添加窗口..内容, 读 (#代码劳保管理库))
劳保用品添加窗口.选择 (., 读 (#用工形式劳保管理库))
劳保用品添加窗口.选择 (., 读 (#种类劳保管理库))
赋值 (劳保用品添加窗口..标题, “修 改”)
劳保用品添加窗口.删除项目 (., 0)
赋值 (劳保用品添加窗口., “修改劳保用品信息”)

.子程序 _劳保超级列表框_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _添加_被选择, 空白型, , 
_劳保添加按钮_被单击 ()

.子程序 _修改_被选择, 空白型, , 
_劳保修改按钮_被单击 ()

.子程序 _删除_被选择, 空白型, , 
_劳保删除按钮_被单击 ()

.窗口程序集 劳保用品添加窗口程序集, , , 

.程序集变量 记录号, 整数型, , , 
.子程序 _劳保用品添加窗口_创建完毕, 空白型, , 组合框内加入项目，舍去相同内容，只添加不同内容
.局部变量 循环次数, 整数型, , , 
.局部变量 加入, 文本型, , , 
.局部变量 循环计数, 整数型, , , 
.局部变量 有重复, 整数型, , , 

赋值 (窗口句柄, 取窗口句柄 ())
赋值 (窗口名称, 劳保用品添加窗口)
获取焦点 ()
置当前库 (相加 (当前目录, “\”, #类型设置数据库, “.edb”))
到首记录 ()
“所有人员”.加入项目 ()
.计次循环首 (取记录数 (), 循环次数)
    .如果 (等于 (读 (#种类类型设置管理库), “用工形式”))
        读 (#内容名称类型设置管理库).加入项目 ()
    .否则
        
    .如果结束
    跳过 (1)
.计次循环尾 ()
赋值 (.现行选中项, 0)
置当前库 (相加 (当前目录, “\”, #劳保设置数据库, “.edb”))
到首记录 ()
.计次循环首 (取记录数 (), 循环次数)
    赋值 (有重复, 0)
    赋值 (加入, 读 (#种类劳保管理库))
    .计次循环首 (取项目数 (), 循环计数)
        .如果 (等于 (加入, 相减 (循环计数, 1).取项目文本 ()))
            赋值 (有重复, 1)
        .否则
            
        .如果结束
        
    .计次循环尾 ()
    .如果真 (等于 (有重复, 0))
        加入.加入项目 ()
    .如果真结束
    跳过 (1)
.计次循环尾 ()
劳保设置窗口.选择 (..内容)

.子程序 _浏览按钮_被单击, 空白型, , 
载入 (部门选择窗口, 劳保用品添加窗口, 假)

.子程序 _劳保添加按钮_被单击, 空白型, , 首先判断是否有空项；添加大类如果为新，则加入各组合框中；添加、修改的内容是否与现有数据相同；
.局部变量 表项索引, 整数型, , , 
.局部变量 表项列索引, 整数型, , , 
.局部变量 循环次数, 整数型, , , 
.局部变量 添加内容, 文本型, , , 
.局部变量 期限, 文本型, , , 
.局部变量 表项索引数组, 整数型, , "0", 
.局部变量 发放类别, 文本型, , , 

.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“信息不完整，请把空项填完！”, 0, “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (劳保设置窗口.选择 (., .内容), -1))
    劳保设置窗口.加入项目 (., .内容, )
    .加入项目 (.内容, )
.如果真结束
.如果 (等于 (.内容, “年”))
    赋值 (期限, 到文本 (相乘 (到数值 (.内容), 12)))
.否则
    赋值 (期限, .内容)
.如果结束
.计次循环首 (劳保设置窗口.取表项数 (.), 循环次数)
    .如果 (并且 (等于 (劳保设置窗口.取标题 (., 相减 (循环次数, 1), 1), .内容), 等于 (劳保设置窗口.取标题 (., 相减 (循环次数, 1), 0), .内容), 等于 (劳保设置窗口.取标题 (., 相减 (循环次数, 1), 4), .内容), 等于 (劳保设置窗口.取标题 (., 相减 (循环次数, 1), 3), .内容)))
        信息框 (“你所添加的内容已经存在，请核实后继续添加！”, 0, “提示信息”)
        返回 ()
    .否则
        
    .如果结束
    
.计次循环尾 ()
.如果 (等于 (.标题, “修 改”))
    .如果 (等于 (修改 (.内容, .内容, 期限, .内容, .内容, .内容), 真))
        信息框 (“内容修改成功！”, 0, “提示信息”)
        赋值 (表项索引, 劳保设置窗口..)
        .计次循环首 (4, 循环次数)
            赋值 (添加内容, 多项选择 (循环次数, .内容, .内容, 期限, .内容, .内容, .内容))
            劳保设置窗口.置标题 (., 表项索引, 相减 (循环次数, 1), 添加内容)
        .计次循环尾 ()
        销毁 ()
    .否则
        信息框 (“修改内容不成功！”, 0, “提示信息”)
    .如果结束
    
.否则
    .如果 (等于 (.内容, “所有人员”))
        .计次循环首 (相减 (取项目数 (), 1), 循环次数)
            赋值 (发放类别, 循环次数.取项目文本 ())
            到首记录 ()
            .如果 (等于 (查找 (并且 (等于 (读 (#种类劳保管理库), .内容), 等于 (读 (#名称劳保管理库), .内容), 等于 (读 (#限期劳保管理库), 期限), 等于 (读 (#用工形式劳保管理库), 发放类别), 等于 (读 (#发放岗位劳保管理库), .内容))), 真))
                到循环尾 ()
            .否则
                加记录 (.内容, .内容, 期限, 发放类别, .内容, .内容)
            .如果结束
            
        .计次循环尾 ()
        刷新数据 ()
    .否则
        .如果 (等于 (加记录 (.内容, .内容, 期限, .内容, .内容, .内容), 真))
            刷新数据 ()
        .否则
            信息框 (“新记录添加失败，请关闭程序，重新运行！”, 0, )
            返回 ()
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 刷新数据, 空白型, , 
.局部变量 循环次数, 整数型, , , 
.局部变量 表项索引, 整数型, , , 
.局部变量 表项列索引, 整数型, , , 

劳保设置窗口.选择 (., .内容)
劳保设置窗口.全部删除 (.)
到首记录 ()
.计次循环首 (取记录数 (), 循环次数)
    .如果 (等于 (读 (#种类劳保管理库), .内容))
        超级列表框加数据 ()
    .否则
        
    .如果结束
    跳过 (1)
.计次循环尾 ()
赋值 (表项索引, 劳保设置窗口.插入表项 (., -1, , , , , ))
赋值 (表项列索引, 0)
.计次循环首 (取字段数 (), 循环次数)
    劳保设置窗口.置标题 (., 表项索引, 表项列索引, 读字段 (到文本 (取字段名 (循环次数)), ))
    赋值 (表项列索引, 相加 (表项列索引, 1))
.计次循环尾 ()
.如果 (等于 (信息框 (“新记录添加成功，是否继续添加？”, #是否钮, “提示信息”), #是钮))
    连续赋值 (“”, .内容, .内容, .内容, .内容)
    获取焦点 ()
.否则
    劳保用品添加窗口.销毁 ()
.如果结束


.子程序 _劳保用品添加窗口_将被销毁, 空白型, , 
赋值 (窗口句柄, 0)

.窗口程序集 部门选择窗口程序集, , , 

.子程序 _部门选择窗口_创建完毕, 空白型, , 
.局部变量 循环次数, 整数型, , , 
.局部变量 单位代码, 整数型, , , 
.局部变量 循环计次, 整数型, , , 

置类型设置为当前库 ()
.加入项目 (“所有岗位”, , , )
.计次循环首 (取记录数 (), 循环次数)
    .如果真 (等于 (读 (#种类类型设置管理库), “单位名称”))
        .加入项目 (读 (#内容名称类型设置管理库), , , 到数值 (读 (#单位识别编码类型设置管理库)))
    .如果真结束
    .如果真 (等于 (读 (#种类类型设置管理库), “部门班组”))
        赋值 (单位代码, 到数值 (读 (#单位识别编码类型设置管理库)))
        .计次循环首 (取项目数 (), 循环计次)
            .如果真 (等于 (相减 (循环计次, 1).取项目数值 (), 单位代码))
                相减 (循环计次, 1).加入项目 (读 (#内容名称类型设置管理库), , , 到数值 (子文本替换 (读 (#单位识别编码类型设置管理库), “|”, , , 1, 真)))
            .如果真结束
            
        .计次循环尾 ()
    .如果真结束
    .如果真 (等于 (读 (#种类类型设置管理库), “岗位名称”))
        赋值 (单位代码, 到数值 (子文本替换 (读 (#单位识别编码类型设置管理库), “|”, , , 1, 真)))
        .计次循环首 (取项目数 (), 循环计次)
            .如果真 (等于 (相减 (循环计次, 1).取项目数值 (), 单位代码))
                相减 (循环计次, 1).加入项目 (读 (#内容名称类型设置管理库), , , 到数值 (子文本替换 (读 (#单位识别编码类型设置管理库), “|”, , , 2, 真)))
            .如果真结束
            
        .计次循环尾 ()
    .如果真结束
    .如果真 (等于 (读 (#种类类型设置管理库), “工种”))
        赋值 (单位代码, 到数值 (子文本替换 (读 (#单位识别编码类型设置管理库), “|”, , , 2, 真)))
        .计次循环首 (取项目数 (), 循环计次)
            .如果真 (等于 (相减 (循环计次, 1).取项目数值 (), 单位代码))
                相减 (循环计次, 1).加入项目 (读 (#内容名称类型设置管理库), , , 到数值 (子文本替换 (读 (#单位识别编码类型设置管理库), “|”, , , 3, 真)))
            .如果真结束
            
        .计次循环尾 ()
    .如果真结束
    跳过 (1)
.计次循环尾 ()

.子程序 _岗位确定按钮_被单击, 空白型, , 
.局部变量 单位代码, 文本型, , , 
.局部变量 代码长度, 整数型, , , 
.局部变量 单位名称, 文本型, , , 
.局部变量 项目索引, 整数型, , , 

赋值 (单位代码, 到文本 (.取项目数值 (.最大化按钮)))
赋值 (代码长度, 取文本长度 (单位代码))
赋值 (单位名称, .取项目文本 (.最大化按钮))
赋值 (项目索引, .取父项目 (.最大化按钮))
.判断循环首 (真)
    .如果 (等于 (项目索引, -1))
        跳出循环 ()
    .否则
        
    .如果结束
    赋值 (单位名称, 相加 (项目索引.取项目文本 (), “\”, 单位名称))
    赋值 (项目索引, 项目索引.取父项目 ())
.判断循环尾 ()
赋值 (劳保用品添加窗口..内容, 单位名称)
赋值 (劳保用品添加窗口..内容, 单位代码)
部门选择窗口.销毁 ()

.子程序 _部门选择窗口_将被销毁, 空白型, , 
置当前库 (相加 (当前目录, “\”, #劳保设置数据库, “.edb”))

.窗口程序集 劳保发放查询程序集, , , 

.程序集变量 用工形式, 文本型, , , 
.程序集变量 岗位代码, 文本型, , , 
.程序集变量 多选框, 选择框, , "0", 
.程序集变量 浏览时间, 按钮, , "0", 
.程序集变量 职工号, 文本型, , , 
.程序集变量 种类, 文本型, , , 
.程序集变量 职工姓名, 文本型, , , 
.程序集变量 有用数据, 文本型, , "0", 
.程序集变量 查询标识, 文本型, , , 
.子程序 _劳保发放查询窗口_创建完毕, 空白型, , 
.局部变量 循环次数, 整数型, , , 
.局部变量 单位代码, 整数型, , , 
.局部变量 循环计次, 整数型, , , 
.局部变量 父项索引, 整数型, , , 

赋值 (窗口句柄, 取窗口句柄 ())
赋值 (窗口名称, 劳保发放查询窗口)
置类型设置为当前库 ()
.计次循环首 (取记录数 (), 循环次数)
    .如果真 (等于 (读 (#种类类型设置管理库), “单位名称”))
        .加入项目 (读 (#内容名称类型设置管理库), , , 到数值 (读 (#单位识别编码类型设置管理库)))
    .如果真结束
    .如果真 (等于 (读 (#种类类型设置管理库), “部门班组”))
        赋值 (单位代码, 到数值 (读 (#单位识别编码类型设置管理库)))
        .计次循环首 (取项目数 (), 循环计次)
            .如果真 (等于 (相减 (循环计次, 1).取项目数值 (), 单位代码))
                相减 (循环计次, 1).加入项目 (读 (#内容名称类型设置管理库), , , 到数值 (子文本替换 (读 (#单位识别编码类型设置管理库), “|”, , , 1, 真)))
            .如果真结束
            
        .计次循环尾 ()
    .如果真结束
    跳过 (1)
.计次循环尾 ()
置个人信息为当前库 ()
.计次循环首 (取记录数 (), 循环次数)
    赋值 (岗位代码, 读 (#单位代码个人信息库))
    赋值 (单位代码, 到数值 (取文本左边 (岗位代码, 4)))
    .计次循环首 (取项目数 (), 循环计次)
        .如果 (等于 (相减 (循环计次, 1).取项目数值 (), 单位代码))
            赋值 (父项索引, 相减 (循环计次, 1))
            跳出循环 ()
        .否则
            
        .如果结束
        
    .计次循环尾 ()
    父项索引.加入项目 (相加 (读 (#职工号个人信息库), “ ”, 读 (#姓名个人信息库)), , , 到数值 (读 (#职工号个人信息库)))
    跳过 (1)
.计次循环尾 ()

.子程序 _查询按钮1_被单击, 空白型, , 
.局部变量 关键字, 文本型, , , 
.局部变量 查询字符, 文本型, , , 
.局部变量 关键字个数, 整数型, , , 
.局部变量 循环次数, 整数型, , , 
.局部变量 树形框数据, 文本型, , , 
.局部变量 项目数值, 文本型, , , 

.如果 (并且 (等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“请输入查询关键字！”, 0, “提示信息！”)
    返回 ()
.否则
    
.如果结束
.如果真 (不等于 (.内容, “”))
    赋值 (查询字符, “职工号”)
    赋值 (关键字, .内容)
    赋值 (关键字个数, 相加 (关键字个数, 1))
.如果真结束
.如果真 (不等于 (.内容, “”))
    赋值 (查询字符, “姓名”)
    赋值 (关键字, .内容)
    赋值 (关键字个数, 相加 (关键字个数, 1))
.如果真结束
.如果真 (不等于 (.内容, “”))
    .如果 (或者 (等于 (取文本长度 (.内容), 15), 等于 (取文本长度 (.内容), 18)))
        赋值 (查询字符, “身份证号”)
        赋值 (关键字, .内容)
        赋值 (关键字个数, 相加 (关键字个数, 1))
    .否则
        信息框 (“你输入的身份证号码有误，请输入正确的身份证号码。”, 0, “提示信息！”)
        返回 ()
    .如果结束
    
.如果真结束
.如果 (大于 (关键字个数, 1))
    信息框 (“你输入了2个以上的关键字，请清除多余的内容！”, 0, “提示信息！”)
    返回 ()
.否则
    置个人信息为当前库 ()
    .如果 (等于 (查找 (等于 (读 (查询字符), 关键字)), 真))
        赋值 (职工号, 读 (#职工号个人信息库))
        .计次循环首 (取项目数 (), 循环次数)
            .如果 (等于 (循环次数.取缩进层次 (), 3))
                赋值 (项目数值, 到文本 (循环次数.取项目数值 ()))
                赋值 (项目数值, 相加 (取重复文本 (相减 (取文本长度 (职工号), 取文本长度 (项目数值)), “0”), 项目数值))
                .如果真 (等于 (职工号, 项目数值))
                    循环次数.取父项目 ().扩展 ()
                    赋值 (.最大化按钮, 循环次数)
                    _树型框1_项目被选择 (2)
                    跳出循环 ()
                .如果真结束
                
            .否则
                
            .如果结束
            
        .计次循环尾 ()
        连续赋值 (“”, .内容, .内容, .内容)
    .否则
        信息框 (相加 (查询字符, “ 为 ”, 关键字, “ 的信息没有查到，请确认关键字是否正确。”), 0, “提示信息！”)
    .如果结束
    
.如果结束


.子程序 _树型框1_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

.局部变量 计数, 整数型, , , 
.局部变量 循环次数, 整数型, , , 
.局部变量 类别, 文本型, , , 
.局部变量 前一类别, 文本型, , , 
.局部变量 树形框数值, 文本型, , , 

.如果 (不等于 (.取缩进层次 (.最大化按钮), 3))
    返回 ()
.否则
    置个人信息为当前库 ()
    .如果 (不等于 (取文本长度 (读 (#职工号个人信息库)), 取文本长度 (到文本 (.取项目数值 (.最大化按钮)))))
        赋值 (树形框数值, 相加 (取重复文本 (相减 (取文本长度 (读 (#职工号个人信息库)), 取文本长度 (到文本 (.取项目数值 (.最大化按钮)))), “0”), 到文本 (.取项目数值 (.最大化按钮))))
    .否则
        赋值 (树形框数值, 到文本 (.取项目数值 (.最大化按钮)))
    .如果结束
    查找 (等于 (读 (#职工号个人信息库), 树形框数值))
    赋值 (职工号, 读 (#职工号个人信息库))
    赋值 (岗位代码, 读 (#单位代码个人信息库))
    赋值 (用工形式, 读 (#用工形式个人信息库))
    赋值 (职工姓名, 读 (#姓名个人信息库))
    赋值 (.内容, 读 (#姓名个人信息库))
    赋值 (.内容, 读 (#身份证号个人信息库))
    赋值 (.内容, 读 (#联系电话个人信息库))
    赋值 (.内容, 读 (#状态个人信息库))
    赋值 (.内容, 读 (#入厂时间个人信息库))
    赋值 (.内容, 相加 (读 (#单位名称个人信息库), “\”, 读 (#部门班组个人信息库)))
    赋值 (.内容, 读 (#工种个人信息库))
    赋值 (.图片, 读 (#个人照片个人信息库))
    .计次循环首 (取数组成员数 (多选框), 计数)
        .如果真 (是否已创建 (多选框 [计数]))
            多选框.销毁 ( [计数])
        .如果真结束
        .如果真 (是否已创建 (浏览时间 [计数]))
            浏览时间.销毁 ( [计数])
        .如果真结束
        
    .计次循环尾 ()
    .如果 (等于 (查询标识, “是”))
        置当前库 (相加 (当前目录, “\”, #劳保设置数据库, “.edb”))
        到首记录 ()
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        清空 ()
        .计次循环首 (取记录数 (), 循环次数)
            赋值 (类别, 读 (#种类类型设置管理库))
            .如果真 (不等于 (类别, 前一类别))
                赋值 (前一类别, 类别)
                前一类别.加入项目 ()
            .如果真结束
            跳过 (1)
        .计次循环尾 ()
        
    .否则
        多选框列表 ()
    .如果结束
    
.如果结束


.子程序 _组合框1_列表项被选择, 空白型, , 
.局部变量 循环次数, 整数型, , , 
.局部变量 单位码, 文本型, , , 

清空 ()
置当前库 (相加 (当前目录, “\”, #劳保设置数据库, “.edb”))
到首记录 ()
.计次循环首 (取记录数 (), 循环次数)
    赋值 (单位码, 读 (#代码劳保管理库))
    .如果真 (等于 (单位码, “0”))
        赋值 (单位码, 岗位代码)
    .如果真结束
    .如果 (并且 (等于 (读 (#种类劳保管理库), .内容), 等于 (读 (#用工形式劳保管理库), 用工形式), 等于 (单位码, 取文本左边 (岗位代码, 取文本长度 (单位码)))))
        读 (#名称劳保管理库).加入项目 ()
    .否则
        
    .如果结束
    跳过 (1)
.计次循环尾 ()

.子程序 _组合框2_列表项被选择, 空白型, , 
.局部变量 计次, 整数型, , , 

赋值 (.内容, “”)
相加 (#换行符, 职工姓名, “ ”, .内容, “ ”, .内容, “ 的发放明细：”, #换行符, #换行符).加入文本 ()
置当前库 (相加 (当前目录, “\”, #劳保发放数据库, “.edb”))
到首记录 ()
.判断循环首 (真)
    .如果 (等于 (查找 (并且 (等于 (读 (#劳保类别劳保发放库), .内容), 等于 (读 (#劳保品名劳保发放库), .内容), 等于 (读 (#职工号劳保发放库), 职工号))), 真))
        赋值 (计次, 相加 (计次, 1))
        相加 (“第 ”, 到文本 (计次), “ 次 发放时间：”, 到文本 (读 (#日期劳保发放库)), #换行符).加入文本 ()
    .否则
        跳出循环 ()
    .如果结束
    跳过 (1)
.判断循环尾 ()
.如果 (等于 (计次, 0))
    相加 (#换行符, #换行符, #换行符, “没有相应的发放记录!”).加入文本 ()
.否则
    
.如果结束



.子程序 多选框列表, 空白型, , 
.局部变量 循环次数, 整数型, , , 
.局部变量 劳保名称, 文本型, , , 
.局部变量 期限, 文本型, , , 
.局部变量 循环计数, 整数型, , , 
.局部变量 时差, 整数型, , , 
.局部变量 有记录, 整数型, , , 
.局部变量 计数, 整数型, , , 
.局部变量 记录号, 整数型, , , 

置当前库 (相加 (当前目录, “\”, #劳保设置数据库, “.edb”))
到首记录 ()
重定义数组 (多选框, 假, 取记录数 ())
重定义数组 (浏览时间, 假, 取记录数 ())
重定义数组 (有用数据, 假, 取记录数 ())
.计次循环首 (取记录数 (), 循环次数)
    赋值 (有记录, 0)
    .如果 (或者 (等于 (读 (#代码劳保管理库), 取文本左边 (岗位代码, 到数值 (取文本长度 (读 (#代码劳保管理库))))), 等于 (读 (#代码劳保管理库), “0”)))
        .如果 (等于 (读 (#用工形式劳保管理库), 用工形式))
            赋值 (劳保名称, 读 (#名称劳保管理库))
            赋值 (种类, 读 (#种类劳保管理库))
            赋值 (期限, 读 (#限期劳保管理库))
            置当前库 (相加 (当前目录, “\”, #劳保发放数据库, “.edb”))
            到首记录 ()
            .计次循环首 (取记录数 (), 循环计数)
                .如果 (等于 (查找 (并且 (等于 (读 (#职工号劳保发放库), 职工号), 等于 (读 (#劳保类别劳保发放库), 种类), 等于 (读 (#劳保品名劳保发放库), 劳保名称))), 真))
                    赋值 (有记录, 相加 (有记录, 1))
                    赋值 (记录号, 取记录号 ())
                    跳过 (1)
                .否则
                    跳出循环 ()
                .如果结束
                
            .计次循环尾 ()
            跳到 (记录号)
            赋值 (计数, 相加 (计数, 1))
            复制窗口组件 (多选框 [计数])
            赋值 (多选框 [计数], 标记, 到文本 (计数))
            赋值 (多选框 [计数], 可视, 真)
            多选框.移动 ( [计数], 8, 相加 (相乘 (相减 (计数, 1), 22), 20), 282, 20)
            .如果 (不等于 (有记录, 0))
                .判断开始 (大于或等于 (到数值 (期限), 12))
                    赋值 (时差, 取时间间隔 (取现行时间 (), 读 (#日期劳保发放库), #年份))
                    .如果 (小于或等于 (相除 (到数值 (期限), 12), 时差))
                        赋值 (多选框 [计数], 标题, 相加 (劳保名称, “：已到期，上次 ”, 到文本 (读 (#日期劳保发放库)), “ 发放”))
                        复制窗口组件 (浏览时间 [计数])
                        .如果真 (大于 (计数, 0))
                            浏览时间.移动 ( [计数], 290, 相加 (相乘 (相减 (计数, 1), 22), 20), 35, 20)
                        .如果真结束
                        
                    .否则
                        多选框.销毁 ( [计数])
                        赋值 (计数, 相减 (计数, 1))
                    .如果结束
                    
                .默认
                    赋值 (时差, 取时间间隔 (取时间 (取现行时间 ()), 读 (#日期劳保发放库), #月份))
                    .如果 (小于或等于 (到数值 (期限), 时差))
                        赋值 (多选框 [计数], 标题, 相加 (劳保名称, “：已到期，上次 ”, 到文本 (读 (#日期劳保发放库)), “ 发放”))
                        复制窗口组件 (浏览时间 [计数])
                        .如果真 (大于 (计数, 0))
                            浏览时间.移动 ( [计数], 290, 相加 (相乘 (相减 (计数, 1), 22), 20), 35, 20)
                        .如果真结束
                        
                    .否则
                        多选框.销毁 ( [计数])
                        赋值 (计数, 相减 (计数, 1))
                    .如果结束
                    
                .判断结束
                
            .否则
                赋值 (多选框 [计数], 标题, 相加 (劳保名称, “：无发放记录，输入最后发放日期”))
                复制窗口组件 (浏览时间 [计数])
                .如果真 (大于 (计数, 0))
                    浏览时间.移动 ( [计数], 290, 相加 (相乘 (相减 (计数, 1), 22), 20), 35, 20)
                .如果真结束
                
            .如果结束
            .如果真 (大于 (计数, 0))
                赋值 (有用数据 [计数], 相加 (劳保名称, “ ”, 种类, “ ”, 职工号, “ ”, 期限))
            .如果真结束
            
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    置当前库 (相加 (当前目录, “\”, #劳保设置数据库, “.edb”))
    跳过 (1)
.计次循环尾 ()
重定义数组 (多选框, 真, 计数)
重定义数组 (浏览时间, 真, 计数)
.如果 (等于 (计数, 0))
    赋值 (.可视, 真)
.否则
    赋值 (.可视, 假)
.如果结束


.子程序 列表内容排序, 空白型, , 
.局部变量 循环次数, 整数型, , , 
.局部变量 计数, 整数型, , , 

.如果 (等于 (取数组成员数 (多选框), 0))
    赋值 (.可视, 真)
.否则
    .计次循环首 (取数组成员数 (多选框), 循环次数)
        多选框.移动 ( [循环次数], 8, 相加 (相乘 (相减 (循环次数, 1), 22), 20), 282, 20)
        浏览时间.移动 ( [循环次数], 290, 相加 (相乘 (相减 (循环次数, 1), 22), 20), 35, 20)
        赋值 (多选框 [循环次数], 标记, 到文本 (循环次数))
        赋值 (浏览时间 [循环次数], 标记, 到文本 (循环次数))
    .计次循环尾 ()
.如果结束


.子程序 _选择框1_被单击, 空白型, , 
.局部变量 按钮标记, 整数型, , , 
.局部变量 单击选择框, 选择框, , , 

赋值 (单击选择框, 取事件组件 ())
赋值 (按钮标记, 到数值 (单击选择框.标记))
赋值 (浏览时间 [按钮标记], 标记, 到文本 (按钮标记))
.如果 (等于 (取文本右边 (多选框 [按钮标记], 标题, 4), “发放”))
    赋值 (浏览时间 [按钮标记], 标题, “发放”)
.否则
    赋值 (浏览时间 [按钮标记], 标题, “浏览”)
.如果结束
.如果 (等于 (多选框 [按钮标记], 选中, 真))
    赋值 (浏览时间 [按钮标记], 可视, 真)
.否则
    赋值 (浏览时间 [按钮标记], 可视, 假)
.如果结束


.子程序 _时间按钮_被单击, 空白型, , 
.局部变量 浏览按钮标记, 按钮, , , 
.局部变量 按钮标记, 整数型, , , 
.局部变量 劳保品名, 文本型, , "0", 

赋值 (浏览按钮标记, 取事件组件 ())
赋值 (按钮标记, 到数值 (浏览按钮标记.标记))
载入 (日期窗口, 劳保发放查询窗口, 假)
赋值 (日期窗口..内容, 浏览按钮标记.标记)
赋值 (劳保品名, 分割文本 (多选框 [按钮标记], 标题, “：”, 1))
.如果 (等于 (浏览时间 [按钮标记], 标题, “浏览”))
    赋值 (日期窗口..标题, 相加 (“请输入 ”, 职工姓名, “ ”, 劳保品名 [1], “ 最后一次的发放时间”))
.否则
    赋值 (日期窗口..标题, 相加 (“请输入 ”, 职工姓名, “ ”, 劳保品名 [1], “ 本次发放时间”))
.如果结束
赋值 (日期窗口., “ 输入发放日期 ”)
赋值 (日期窗口..标题, 有用数据 [到数值 (日期窗口..内容)])

.子程序 _劳保发放查询窗口_将被销毁, 空白型, , 
赋值 (窗口句柄, 0)

.窗口程序集 日期窗口程序集, , , 

.子程序 _日期窗口_创建完毕, 空白型, , 
.局部变量 循环次数, 整数型, , , 
.局部变量 当月, 文本型, , , 

赋值 (当月, 到文本 (取月份 (系统时间)))
.计次循环首 (31, 循环次数)
    到文本 (相加 (相减 (取年份 (系统时间), 20), 循环次数)).加入项目 ()
    .如果真 (小于或等于 (循环次数, 12))
        到文本 (循环次数).加入项目 ()
    .如果真结束
    .如果真 (或者 (等于 (当月, “1”), 等于 (当月, “3”), 等于 (当月, “5”), 等于 (当月, “7”), 等于 (当月, “8”), 等于 (当月, “10”), 等于 (当月, “12”)))
        到文本 (循环次数).加入项目 ()
    .如果真结束
    .如果真 (或者 (等于 (当月, “4”), 等于 (当月, “6”), 等于 (当月, “9”), 等于 (当月, “11”)))
        .判断开始 (大于 (循环次数, 30))
            跳出循环 ()
        .默认
            到文本 (循环次数).加入项目 ()
        .判断结束
        
    .如果真结束
    .如果真 (等于 (当月, “2”))
        .判断开始 (等于 (求余数 (到数值 (.内容), 4), 0))
            .如果真 (大于 (循环次数, 29))
                跳出循环 ()
            .如果真结束
            到文本 (循环次数).加入项目 ()
        .默认
            .如果真 (大于 (循环次数, 28))
                跳出循环 ()
            .如果真结束
            到文本 (循环次数).加入项目 ()
        .判断结束
        
    .如果真结束
    
.计次循环尾 ()
到文本 (取年份 (系统时间)).选择 ()
当月.选择 ()
到文本 (取日 (系统时间)).选择 ()

.子程序 _月份组合框_列表项被选择, 空白型, , 
.局部变量 循环次数, 整数型, , , 

清空 ()
.计次循环首 (31, 循环次数)
    .如果真 (或者 (等于 (.内容, “1”), 等于 (.内容, “3”), 等于 (.内容, “5”), 等于 (.内容, “7”), 等于 (.内容, “8”), 等于 (.内容, “10”), 等于 (.内容, “12”)))
        到文本 (循环次数).加入项目 ()
    .如果真结束
    .如果真 (或者 (等于 (.内容, “4”), 等于 (.内容, “6”), 等于 (.内容, “9”), 等于 (.内容, “11”)))
        .判断开始 (等于 (循环次数, 31))
            跳出循环 ()
        .默认
            到文本 (循环次数).加入项目 ()
        .判断结束
        
    .如果真结束
    .如果真 (等于 (.内容, “2”))
        .判断开始 (等于 (求余数 (到数值 (.内容), 4), 0))
            .如果真 (大于 (循环次数, 29))
                跳出循环 ()
            .如果真结束
            到文本 (循环次数).加入项目 ()
        .默认
            .如果真 (大于 (循环次数, 28))
                跳出循环 ()
            .如果真结束
            到文本 (循环次数).加入项目 ()
        .判断结束
        
    .如果真结束
    
.计次循环尾 ()

.子程序 _月份组合框_编辑内容被改变, 空白型, , 
_月份组合框_列表项被选择 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 当前库, 文本型, , , 
.局部变量 记号, 整数型, , , 
.局部变量 基本信息, 文本型, , "0", 
.局部变量 时差, 整数型, , , 
.局部变量 期限, 整数型, , , 

置当前库 (相加 (当前目录, “\”, #劳保发放数据库, “.edb”))
赋值 (基本信息, 分割文本 (.标题, “ ”, ))
.如果 (等于 (加记录 (基本信息 [3], 到时间 (相加 (.内容, “年”, .内容, “月”, .内容)), 基本信息 [2], 基本信息 [1]), 真))
    信息框 (“发放记录添加完成！”, 0, “提示信息”)
    赋值 (期限, 到数值 (基本信息 [4]))
    .如果 (大于或等于 (期限, 12))
        赋值 (期限, 相除 (期限, 12))
        赋值 (时差, 取时间间隔 (系统时间, 到时间 (相加 (.内容, “年”, .内容, “月”, .内容)), #年份))
    .否则
        赋值 (时差, 取时间间隔 (系统时间, 到时间 (相加 (.内容, “年”, .内容, “月”, .内容)), #月份))
    .如果结束
    赋值 (记号, 到数值 (.内容))
    .如果 (小于 (时差, 期限))
        劳保发放查询窗口.销毁 (. [记号])
        劳保发放查询窗口.销毁 (. [记号])
        删除成员 (劳保发放查询窗口., 记号, )
        删除成员 (劳保发放查询窗口., 记号, )
        删除成员 (劳保发放查询窗口., 记号, )
        列表内容排序 ()
    .否则
        赋值 (劳保发放查询窗口. [记号], 标题, 相加 (基本信息 [1], “：已到期，上次 ”, .内容, “年”, .内容, “月”, .内容, “ 发放”))
        赋值 (劳保发放查询窗口. [记号], 选中, 假)
        赋值 (劳保发放查询窗口. [记号], 可视, 假)
        
    .如果结束
    销毁 ()
.否则
    
.如果结束



 ' 不属于任何一个程序集、类模块的函数：
