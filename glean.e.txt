 ' 文件类型：Windows窗口程序

 ' 程序名称：资料收集工具
 ' 程序描述：
 ' 程序作者：常博文
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：changbwn@online.ln.cn
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 0
    顶边 = 100
    宽度 = 780
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 5
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\glean.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “Glean（格林－资料收集工具）    测试版”
    帮助文件名 = “”

窗口 导出资料窗口
    左边 = 50
    顶边 = 50
    宽度 = 553
    高度 = 376
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “导出资料”
    帮助文件名 = “”

窗口 获得新资料的目录和标题
    左边 = 50
    顶边 = 50
    宽度 = 521
    高度 = 382
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “获得新资料的目录和标题”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 408
    高度 = 317
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 6
    底图方式 = 1
    底色 = 14803425 '  0xE1E1E1
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “Glean（格林－资料收集工具）”
    帮助文件名 = “”

窗口 新文件夹窗口
    左边 = 50
    顶边 = 50
    宽度 = 429
    高度 = 136
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “新文件夹”
    帮助文件名 = “”

窗口 获得文件格式窗口
    左边 = 50
    顶边 = 50
    宽度 = 417
    高度 = 268
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “获得文件格式”
    帮助文件名 = “”

窗口 文本查找窗口
    左边 = 50
    顶边 = 50
    宽度 = 404
    高度 = 131
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “查找”
    帮助文件名 = “”

窗口 注册窗口
    左边 = 50
    顶边 = 50
    宽度 = 406
    高度 = 235
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “欢迎注册”
    帮助文件名 = “”

窗口 收藏夹窗口
    左边 = 50
    顶边 = 50
    宽度 = 260
    高度 = 300
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “收藏夹”
    帮助文件名 = “”

窗口 日积月累窗口
    左边 = 50
    顶边 = 50
    宽度 = 500
    高度 = 365
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “日积月累”
    帮助文件名 = “”

窗口 成批导入磁盘文件窗口
    左边 = 50
    顶边 = 50
    宽度 = 506
    高度 = 372
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “导入磁盘文件”
    帮助文件名 = “”



.图片 a1, " ' 已保存到：D:\易语言学习\Data\glean.e\a1", , 启动01
.图片 a2, " ' 已保存到：D:\易语言学习\Data\glean.e\a2", , 启动02
.图片 a3, " ' 已保存到：D:\易语言学习\Data\glean.e\a3", , 搜索
.图片 a4, " ' 已保存到：D:\易语言学习\Data\glean.e\a4", , 查找
.图片 a5, " ' 已保存到：D:\易语言学习\Data\glean.e\a5", , IE按钮
.图片 a6, " ' 已保存到：D:\易语言学习\Data\glean.e\a6", , 导出
.图片 a7, " ' 已保存到：D:\易语言学习\Data\glean.e\a7", , 子窗口
.图片 a8, " ' 已保存到：D:\易语言学习\Data\glean.e\a8", , 目录1
.图片 a9, " ' 已保存到：D:\易语言学习\Data\glean.e\a9", , 目录2
.图片 a10, " ' 已保存到：D:\易语言学习\Data\glean.e\a10", , 目录3
.图片 a11, " ' 已保存到：D:\易语言学习\Data\glean.e\a11", , 资料格式
.图片 a12, " ' 已保存到：D:\易语言学习\Data\glean.e\a12", , 资料格式2
.常量 注册表根, "-2147483648", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 9 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 1 扩展界面支持库一
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库
 ' HtmlView 5014D8FA6DCA40b68FA626D8183666EB 1 1 超文本浏览框
 ' Tooltiplib DA19AC3ADD2F4121AAD84AC5FBCAFC71 1 1 提示工具支持库
 ' eOALib 05B2708EF81049a78EED8531D4A8DFB9 3 5 办公组件支持库




数据类型 组件注册信息, , 
    .成员 名称, 文本型, , , 
    .成员 版本, 文本型, , , 
    .成员 文件名, 文本型, , , 
    .成员 路径, 文本型, , , 

.全局变量 入口参数, 文本型, , "0", 程序的入口参数（1--URL，2--模式，3--路径，4--title）
.全局变量 工作路径, 文本型, , , 工作路径
.全局变量 主窗口左边, 整数型, , , 窗口左边
.全局变量 主窗口顶边, 整数型, , , 窗口顶边
.全局变量 主窗口高度, 整数型, , , 窗口高度
.全局变量 主窗口宽度, 整数型, , , 窗口宽度
.全局变量 分隔条左边, 整数型, , , 纵向分割条位置的左边
.全局变量 资料项目索引, 整数型, , , 当前目录、标题共用
.全局变量 目录索引, 整数型, , , 当前目录专用
.全局变量 父目录索引, 整数型, , , 当前目录的父目录的索引
.全局变量 当前选中项, 文本型, , , 记录用户的当前选中项
.全局变量 入口参数个数, 整数型, , , 
.全局变量 新标题名称, 文本型, , , 浏览器右键进入时添加标题用
.全局变量 新资料标志, 逻辑型, , , 
.全局变量 分隔条顶边, 整数型, , , 横向分割条位置的上边
.全局变量 资料被修改, 逻辑型, , , 用于是否存储的判断
.全局变量 文件名集合, 文本型, , , 用于搜索图形文件
.全局变量 新资料格式, 文本型, , , 用于获得新资料名称目录窗口的返回值
.全局变量 rtf资料长度, 整数型, , , 
.全局变量 纯文本字符格式, 未知类型0x30004, , , 记忆纯文本编辑框的字体
.全局变量 浏览器文字大小, 整数型, , , 
.全局变量 当前最大化的控件名称, 文本型, , , 用于规划窗口显示
.全局变量 初始目录1, 文本型, , , 用于打开文件对话框
.全局变量 是否检测保存, 逻辑型, , , 
.全局变量 图形文件目录, 文本型, , , 记录imgdir
.全局变量 注册号有效, 逻辑型, , , 

.DLL命令 枚举指定项的子项, 整数型, "", "RegEnumKeyA", , 
    .参数 hKey, 整数型, , 
    .参数 dwIndex, 整数型, , 
    .参数 lpName, 文本型, , 
    .参数 cbName, 整数型, , 

.DLL命令 创建一个新项, 整数型, "", "RegCreateKeyA", , 
    .参数 hKey, 整数型, , 
    .参数 lpSubKey, 文本型, , 
    .参数 phkResult, 整数型, 传址, 

.DLL命令 执行系统命令, 整数型, "shell32.dll", "ShellExecuteA", , 
    .参数 hwnd, 整数型, , 
    .参数 lpOperation, 文本型, , 
    .参数 lpFile, 文本型, , 
    .参数 lpParameters, 文本型, , 
    .参数 lpDirectory, 文本型, , 
    .参数 nShowCmd, 整数型, , 

.DLL命令 模拟键盘, 空白型, "", "keybd_event", , 
    .参数 bVk, 整数型, , 
    .参数 bScan, 整数型, , 
    .参数 dwFlags, 整数型, , 
    .参数 dwExtraInfo, 整数型, , 

.DLL命令 取磁盘序列号, 空白型, "kernel32.dll", "GetVolumeInformationA", , 
    .参数 lpRootPathName, 文本型, , 
    .参数 lpVolumeNameBuffer, 文本型, , 
    .参数 nVolumeNameSize, 整数型, , 
    .参数 lpVolumeSerialNumber, 整数型, 传址, 
    .参数 lpMaximumComponentLength, 整数型, 传址, 
    .参数 lpFileSystemFlags, 整数型, 传址, 
    .参数 lpFileSystemNameBuffer, 文本型, , 
    .参数 nFileSystemNameSize, 整数型, , 

.DLL命令 窗口句柄, 整数型, "", "GetForegroundWindow", , 

.DLL命令 取焦点句柄, 整数型, "", "GetFocus", , 

.窗口程序集 启动窗口程序集, , , 

.程序集变量 浏览器句柄, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 标识, 文本型, , , 
.局部变量 磁盘序列号, 文本型, , , 
.局部变量 注册号, 文本型, , , 
.局部变量 是否显示日积月累, 逻辑型, , , 
.局部变量 系统目录, 文本型, , , 
.局部变量 组件注册信息1, 组件注册信息, , , 

取命令行 (入口参数)
赋值 (入口参数个数, 取数组成员数 (入口参数))
赋值 (新资料标志, 假)
赋值 (资料被修改, 假)
赋值 (新标题名称, “”)
赋值 (图形文件目录, “”)
赋值 (当前最大化的控件名称, “”)
赋值 (是否检测保存, 真)
赋值 (工作路径, 取运行目录 ())
赋值 (标识, “Software\Microsoft\Internet Explorer\Extensions\{0564DE97-4CDA-4ff8-9A7F-E1997FC843B7}\HotIcon”)
.如果真 (不等于 (文本比较 (工作路径, 取路径子程序 (取文本注册项 (#本地机器, 标识, )), 假), 0))
    赋值 (系统目录, 未知支持库函数_7 (#))
    赋值 (系统目录, 选择 (等于 (取文本右边 (系统目录, 1), “\”), 系统目录, 相加 (系统目录, “\”)))
    .如果真 (取反 (文件是否存在 (相加 (系统目录, “regsvr32.exe”))))
        复制文件 (相加 (工作路径, “\regsvr32_bak.exe”), 相加 (系统目录, “regsvr32.exe”))
    .如果真结束
    执行系统命令 (取窗口句柄 (), “open”, 相加 (系统目录, “regsvr32.exe”), 相加 (“/s ”, 工作路径, “\getresource.dll”), “”, 5) ' 注册
     ' 1--写注册表
     ' 工具按钮调用 geturl.htm -- getresource.dll -- glean.exe
     ' 右键菜单调用 gettext.htm -- getresource.dll -- gettext.exe
     ' 检查 IE 上是否设置了工具图标
    写注册表 ()
    生成html文件 () ' 3--生成 html 程序
.如果真结束

.如果真 (.选中)
    _关闭浏览按钮_被单击 ()
.如果真结束
 ' 设置窗口
全部关闭 ()
读入参数 ()
赋值 (磁盘序列号, 取磁盘序列号子程序 ())
赋值 (注册号, 读配置项 (相加 (工作路径, “\config.ini”), “注册”, “注册号”, “”))
 ' 此处应该验证注册号，（略）
 ' 测试版，只要有内容就通过验证。
.如果 (大于 (取文本长度 (注册号), 0))
    赋值 (注册号有效, 真)
    赋值 (.禁止, 真)
.否则
    赋值 (注册号有效, 假)
    赋值 (_启动窗口.标题, 相加 (_启动窗口.标题, “    未注册”))
.如果结束
__启动窗口_尺寸被改变 ()
打开 (相加 (工作路径, “\data\zlk”), , , , , , )
置当前库 (“zlk”)
彻底删除 ()
.如果 (等于 (取记录数 (), 0))
     ' 资料库结构：z_id,z_fid,z_type,z_type,z_caption,z_zl,z_url,z_imgdir,z_sy
     ' z_type = "D" -- 资料目录（不可以存放文件），"R" -- RTF格式资料，"T"--TXT格式资料，"E"--EWD格式资料
     ' id 两位一级 01－99－AA－XX 第一级，每一级约1300个。(00--为根节点)
     ' 所有资料均放在 DATA 目录之下（以后的版本考虑分目录）
     ' 初始使用，加入初始文件
    置当前库 (“zlk”)
    加记录 (“01”, “00”, “D”, “我的资料目录”, 到字节集 (“【目录说明】（本说明只能使用TXT格式）”), )
    .如果真 (文件是否存在 (相加 (工作路径, “\data\glean简要说明.ewd”)))
        加记录 (“0101”, “01”, “E”, “glean简要说明”, 读入文件 (相加 (工作路径, “\data\glean简要说明.ewd”)), )
    .如果真结束
    .如果真 (文件是否存在 (相加 (工作路径, “\data\glean简要说明.rtf”)))
        加记录 (“0102”, “01”, “R”, “glean简要说明(R)”, 读入文件 (相加 (工作路径, “\data\glean简要说明.rtf”)))
    .如果真结束
    刷新树型框 (“01”)
.否则
    刷新树型框 (当前选中项)
.如果结束
赋值 (.可视, 假)
.如果真 (大于 (入口参数个数, 0))
    添加新的资料 ()
.如果真结束
赋值 (是否显示日积月累, 选择 (等于 (读配置项 (相加 (工作路径, “\config.ini”), “日积月累”, “是否显示日积月累”, “真”), “真”), 真, 假))
赋值 (.选中, 是否显示日积月累)
.如果真 (是否显示日积月累)
    载入 (日积月累窗口, _启动窗口, 假)
.如果真结束
设置浏览器按钮的提示 ()

.子程序 取磁盘序列号子程序, 文本型, , 
.局部变量 超时计数, 整数型, , , 取特征字次数
.局部变量 计数器, 整数型, , , 
.局部变量 特征字, 整数型, , , 

赋值 (超时计数, 20)
赋值 (计数器, 1)
赋值 (特征字, 0)
.判断循环首 (小于或等于 (计数器, 超时计数))
    赋值 (特征字, 取硬盘特征字 ())
    .如果真 (大于 (特征字, 0))
        跳出循环 ()
    .如果真结束
    延时 (300)
    赋值 (计数器, 相加 (计数器, 1))
.判断循环尾 ()
返回 (删全部空 (到文本 (特征字)))

.子程序 写注册表, 空白型, , 写注册表（IE工具按钮、右键）
.局部变量 标识, 文本型, , , 
.局部变量 右键属性, 长整数型, , , 

 ' 工具按钮
赋值 (标识, “Software\Microsoft\Internet Explorer\Extensions\{0564DE97-4CDA-4ff8-9A7F-E1997FC843B7}”)
写注册项 (#本地机器, 相加 (标识, “\”), “”)
写注册项 (#本地机器, 相加 (标识, “\ButtonText”), “启动资料收集工具”)
写注册项 (#本地机器, 相加 (标识, “\CLSID”), “{1FBA04EE-3024-11d2-8F1F-0000F87ABD16}”)
写注册项 (#本地机器, 相加 (标识, “\Default Visible”), “Yes”)
写注册项 (#本地机器, 相加 (标识, “\HotIcon”), 相加 (工作路径, “\glean01.ICO”))
写注册项 (#本地机器, 相加 (标识, “\Icon”), 相加 (工作路径, “\glean02.ICO”))
写注册项 (#本地机器, 相加 (标识, “\MenuStatusBar”), “启动资料收集工具”)
写注册项 (#本地机器, 相加 (标识, “\MenuText”), “启动资料收集工具”)
写注册项 (#本地机器, 相加 (标识, “\Script”), 相加 (工作路径, “\geturl.htm”))
 ' 右键
赋值 (标识, “Software\Microsoft\Internet Explorer\MenuExt\快速保存文本资料”)
写注册项 (#现行用户, 相加 (标识, “\”), 相加 (工作路径, “\gettext.htm”))
赋值 (右键属性, 相加 (相乘 (3, 16), 2))
写注册项 (#现行用户, 相加 (标识, “\Contexts”), 右键属性)

.子程序 删除注册表项子程序, 空白型, , IE按钮右键菜单
.局部变量 标识, 文本型, , , 

赋值 (标识, “Software\Microsoft\Internet Explorer\Extensions\{0564DE97-4CDA-4ff8-9A7F-E1997FC843B3}”)
删除注册项 (#本地机器, 标识)
赋值 (标识, “Software\Microsoft\Internet Explorer\MenuExt\保存到glean(格林)”)
删除注册项 (#现行用户, 标识)
信息框 (“撤销IE浏览器上的按钮和菜单，已经完成。”, 0, )

.子程序 生成html文件, 空白型, , 
.局部变量 转换路径, 文本型, , , 
.局部变量 文件句柄, 整数型, , , 

赋值 (转换路径, 子文本替换 (工作路径, “\”, “\\”, , , 真))
 ' geturl.htm
赋值 (文件句柄, 打开文件 (“geturl.htm”, #重写, ))
写文本行 (文件句柄, 相加 (“<script language=”, #引号, “VBScript”, #引号, “>”))
写文本行 (文件句柄, “Sub OnContextMenu()”)
写文本行 (文件句柄, 相加 (“  set objgetie=CreateObject( ”, #引号, “getresource.getie”, #引号, “)”))
写文本行 (文件句柄, 相加 (“  Call objgetie.geturl(external.menuArguments.location.href,”, #引号, “按钮”, #引号, “,”, #引号, 转换路径, #引号, “,external.menuArguments.Document.Title)”))
写文本行 (文件句柄, “end Sub”)
写文本行 (文件句柄, “call OnContextMenu()”)
写文本行 (文件句柄, “</script>”)
关闭文件 (文件句柄)
 ' gettext.htm
赋值 (文件句柄, 打开文件 (“gettext.htm”, #重写, ))
写文本行 (文件句柄, 相加 (“<SCRIPT LANGUAGE = ”, #引号, “JavaScript”, #引号, “>”))
写文本行 (文件句柄, “  var oWindow = window.external.menuArguments;”)
写文本行 (文件句柄, “  var oDocument = oWindow.document;”)
写文本行 (文件句柄, “  var oSelect = oDocument.selection;”)
写文本行 (文件句柄, “  var oSelectRange = oSelect.createRange();”)
写文本行 (文件句柄, 相加 (“  oSelectRange.execCommand(”, #引号, “Copy”, #引号, “);”))
写文本行 (文件句柄, “</SCRIPT>”)
写文本行 (文件句柄, “”)
写文本行 (文件句柄, 相加 (“<script language=”, 字符 (34), “VBScript”, 字符 (34), “>”))
写文本行 (文件句柄, “Sub OnContextMenu()”)
写文本行 (文件句柄, 相加 (“  set objgetie=CreateObject( ”, #引号, “getresource.getie”, #引号, “)”))
写文本行 (文件句柄, 相加 (“  Call objgetie.geturl(external.menuArguments.location.href,”, #引号, “右键”, #引号, “,”, #引号, 转换路径, #引号, “,external.menuArguments.Document.Title)”))
写文本行 (文件句柄, “end Sub”)
写文本行 (文件句柄, “call OnContextMenu()”)
写文本行 (文件句柄, “</script>”)
关闭文件 (文件句柄)


.子程序 __启动窗口_尺寸被改变, 空白型, , 
.局部变量 计算高度, 整数型, , , 
.局部变量 计数器, 整数型, , , 

 ' 定义窗口尺寸的基本要素
赋值 (主窗口高度, _启动窗口.高度)
赋值 (主窗口宽度, _启动窗口.宽度)
.如果真 (小于 (主窗口高度, 200))
    赋值 (主窗口高度, 200)
    赋值 (_启动窗口.高度, 主窗口高度)
.如果真结束
.如果真 (小于 (主窗口宽度, 300))
    赋值 (主窗口宽度, 300)
    赋值 (_启动窗口.宽度, 主窗口宽度)
.如果真结束
分隔条左边.移动 (22, , 相减 (主窗口高度, 97))
.如果 (.选中)
    相加 (分隔条左边, 4).移动 (分隔条顶边, 相减 (主窗口宽度, 分隔条左边, 15), )
.否则
    0.移动 (分隔条顶边, 相减 (主窗口宽度, 14), )
.如果结束
 ' 没有选择窗口
.如果真 (并且 (等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假)))
    赋值 (., 假)
    赋值 (., 假)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    返回 ()
.如果真结束
 ' 目录外形框
.如果 (.选中)
    赋值 (.可视, 真)
    赋值 (.左边, 0)
    赋值 (.顶边, .)
    赋值 (.高度, .)
    .如果 (等于 (当前最大化的控件名称, “目录外形框”))
        赋值 (., 假)
        赋值 (., 假)
        赋值 (.宽度, 相减 (主窗口宽度, 12))
        赋值 (.可视, 假)
        赋值 (.可视, 真)
        赋值 (.左边, 相减 (.宽度, 33))
    .否则
        赋值 (.宽度, 相减 (分隔条左边, 1))
        赋值 (., 真)
        赋值 (.可视, 真)
        赋值 (.可视, 假)
        赋值 (.左边, 相减 (.宽度, 33))
    .如果结束
    赋值 (.左边, 相减 (.宽度, 17))
    .如果 (小于 (分隔条左边, 135))
        1.移动 (17, 相减 (.宽度, 2), 相减 (.高度, 18))
    .否则
        1.移动 (1, 相减 (.宽度, 2), 相减 (.高度, 2))
    .如果结束
    0.移动 (20, .宽度, 相减 (.高度, 20))
    .如果 (大于 (.宽度, 相加 (.宽度, 12)))
        赋值 (.左边, 相减 (.宽度, .宽度, 12))
    .否则
        赋值 (.左边, 6)
    .如果结束
    .如果 (大于 (.宽度, 20))
        赋值 (.宽度, 相减 (.宽度, 12))
    .否则
        赋值 (.宽度, 8)
    .如果结束
    赋值 (.宽度, .宽度)
    赋值 (计算高度, 相减 (.高度, .顶边, 35))
    .如果 (大于 (计算高度, 10))
        赋值 (.高度, 计算高度)
    .否则
        赋值 (.高度, 10)
    .如果结束
    赋值 (.顶边, 相加 (.顶边, .高度, 2))
    赋值 (.顶边, 相加 (.顶边, 14))
    .如果真 (等于 (当前最大化的控件名称, “目录外形框”))
        赋值 (.可视, 假)
        赋值 (.可视, 假)
        返回 ()
    .如果真结束
    赋值 (.禁止, 假)
    赋值 (计数器, 1)
    .判断循环首 (小于或等于 (计数器, 6))
        相减 (计数器, 1).去除状态 (#禁止)
        赋值 (计数器, 相加 (计数器, 1))
    .判断循环尾 ()
    
.否则
    赋值 (.可视, 假)
    赋值 (., 假)
    赋值 (.禁止, 真)
    赋值 (计数器, 1) ' D版软件不能用计次循环
    .判断循环首 (小于或等于 (计数器, 6))
        相减 (计数器, 1).加入状态 (#禁止)
        赋值 (计数器, 相加 (计数器, 1))
    .判断循环尾 ()
.如果结束
 ' WEB外形框
.如果 (.选中)
    赋值 (.可视, 真)
    赋值 (.顶边, .)
    .如果 (等于 (当前最大化的控件名称, “WEB外形框”))
        赋值 (., 假)
        赋值 (., 假)
        0.移动 (相减 (主窗口宽度, 12), .)
        赋值 (.可视, 假)
        赋值 (.可视, 真)
        赋值 (.左边, 相减 (.宽度, 33))
        赋值 (.禁止, 真)
        赋值 (计数器, 1)
        .判断循环首 (小于或等于 (计数器, 6))
            相减 (计数器, 1).加入状态 (#禁止)
            赋值 (计数器, 相加 (计数器, 1))
        .判断循环尾 ()
        
    .否则
        .如果 (.选中)
            赋值 (., 真)
            赋值 (.高度, 相减 (分隔条顶边, 21))
        .否则
            赋值 (., 假)
            赋值 (.高度, .)
        .如果结束
        赋值 (.左边, .)
        赋值 (.宽度, .)
        赋值 (.可视, 真)
        赋值 (.可视, 假)
        赋值 (.左边, 相减 (.宽度, 33))
    .如果结束
    赋值 (.左边, 相减 (.宽度, 17))
    赋值 (计算高度, 相减 (.宽度, .左边, 63))
    .如果真 (小于 (计算高度, 50))
        赋值 (计算高度, 50)
    .如果真结束
    赋值 (.宽度, 计算高度)
    赋值 (.左边, 相加 (.左边, 计算高度, 1))
    1.移动 (22, 相减 (.宽度, 3), 相减 (.高度, 24))
    .如果真 (等于 (当前最大化的控件名称, “WEB外形框”))
        赋值 (.可视, 假)
        赋值 (.可视, 假)
        返回 ()
    .如果真结束
    
.否则
    赋值 (.可视, 假)
    赋值 (., 假)
.如果结束
 ' 资料选择夹
.如果 (.选中)
    赋值 (.可视, 真)
    .如果 (等于 (当前最大化的控件名称, “资料外形框”))
        赋值 (., 假)
        赋值 (., 假)
        0.移动 (., 相减 (主窗口宽度, 12), .)
        赋值 (.可视, 假)
        赋值 (.可视, 真)
        赋值 (.左边, 相减 (.宽度, 33))
        赋值 (.禁止, 真)
        赋值 (计数器, 1)
        .判断循环首 (小于或等于 (计数器, 6))
            相减 (计数器, 1).加入状态 (#禁止)
            赋值 (计数器, 相加 (计数器, 1))
        .判断循环尾 ()
        
    .否则
        .如果 (.选中)
            赋值 (., 真)
            .移动 (., 相加 (分隔条顶边, 3), ., 相加 (相减 (., 分隔条顶边), 18))
        .否则
            赋值 (., 假)
            .移动 (., ., ., .)
        .如果结束
        赋值 (.可视, 真)
        赋值 (.可视, 假)
        赋值 (.左边, 相减 (.宽度, 33))
    .如果结束
    赋值 (.左边, 相减 (.宽度, 17))
    赋值 (.左边, 1)
    赋值 (.顶边, 1)
    赋值 (.宽度, 相减 (.宽度, 2))
    赋值 (.高度, 相减 (.高度, 2))
    连续赋值 (0, ., .)
    连续赋值 (20, ., .)
    连续赋值 (.宽度, ., .)
    连续赋值 (相减 (.高度, 20), ., .)
    .如果真 (等于 (当前最大化的控件名称, “资料外形框”))
        赋值 (.可视, 假)
        赋值 (.可视, 假)
        返回 ()
    .如果真结束
    
.否则
    赋值 (.可视, 假)
    赋值 (., 假)
.如果结束


.子程序 读入参数, 空白型, , 
赋值 (主窗口左边, 到数值 (读配置项 (相加 (工作路径, “\config.ini”), “窗口”, “主窗口左边”, 到文本 (_启动窗口.左边))))
赋值 (_启动窗口.左边, 主窗口左边)
赋值 (主窗口顶边, 到数值 (读配置项 (相加 (工作路径, “\config.ini”), “窗口”, “主窗口顶边”, 到文本 (_启动窗口.顶边))))
赋值 (_启动窗口.顶边, 主窗口顶边)
赋值 (主窗口宽度, 到数值 (读配置项 (相加 (工作路径, “\config.ini”), “窗口”, “主窗口宽度”, 到文本 (_启动窗口.宽度))))
赋值 (_启动窗口.宽度, 主窗口宽度)
赋值 (主窗口高度, 到数值 (读配置项 (相加 (工作路径, “\config.ini”), “窗口”, “主窗口高度”, 到文本 (_启动窗口.高度))))
赋值 (_启动窗口.高度, 主窗口高度)
赋值 (分隔条左边, 到数值 (读配置项 (相加 (工作路径, “\config.ini”), “窗口”, “分隔条左边”, 到文本 (取整 (相乘 (主窗口宽度, 0.25))))))
赋值 (分隔条顶边, 到数值 (读配置项 (相加 (工作路径, “\config.ini”), “窗口”, “分隔条顶边”, 到文本 (取整 (相乘 (主窗口高度, 0.5))))))
赋值 (当前选中项, 读配置项 (相加 (工作路径, “\config.ini”), “目录”, “当前选中项”, “”))
赋值 (初始目录1, 读配置项 (相加 (工作路径, “\config.ini”), “通用对话框”, “初始目录1”, “”))
赋值 (纯文本字符格式., 读配置项 (相加 (工作路径, “\config.ini”), “文本字体”, “纯文本字体名称”, “宋体”))
赋值 (纯文本字符格式., 到数值 (读配置项 (相加 (工作路径, “\config.ini”), “文本字体”, “纯文本字体大小”, “9”)))
赋值 (纯文本字符格式., 到数值 (读配置项 (相加 (工作路径, “\config.ini”), “文本字体”, “纯文本效果”, “”)))
赋值 (纯文本字符格式., 到数值 (读配置项 (相加 (工作路径, “\config.ini”), “文本字体”, “纯文本纵向偏移”, “”)))
赋值 (纯文本字符格式., 到数值 (读配置项 (相加 (工作路径, “\config.ini”), “文本字体”, “纯文本颜色”, “”)))

.子程序 刷新树型框, 空白型, , 
.参数 当前ID, 文本型, , 当前选中的id,如果空则不设置选中项

.局部变量 计数器, 整数型, , , 
.局部变量 ID号, 文本型, , , 
.局部变量 父索引, 整数型, , , 
.局部变量 父ID号, 文本型, , , 

清空 ()
.如果真 (是否已打开 (“zlkid”))
    关闭 (“zlkid”)
.如果真结束
置当前库 (“zlk”)
排序 (“zlkid”, “z_id”, , , “z_id”, “z_fid”, “z_type”, “z_caption”)
打开 (“zlkid”, , , , , , )
置当前库 (“zlkid”)
到首记录 ()
赋值 (计数器, 0)
赋值 (ID号, 读 (“z_id”))
置当前库 (“zlk”)
到首记录 ()
.如果真 (查找 (等于 (读 (“z_id”), ID号)))
    写 (“z_sy”, 0)
.如果真结束
置当前库 (“zlkid”)
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    赋值 (ID号, 删尾空 (读 (“z_id”)))
    .如果 (等于 (取文本长度 (ID号), 2))
        赋值 (父索引, -1)
    .否则
        赋值 (父ID号, 取文本左边 (ID号, 相减 (取文本长度 (ID号), 2)))
        置当前库 (“zlk”)
        到首记录 ()
        .如果 (查找 (等于 (读 (“z_id”), 父ID号)))
            赋值 (父索引, 读 (“z_sy”))
        .否则
            赋值 (父索引, -1)
        .如果结束
        
    .如果结束
    置当前库 (“zlkid”)
    .判断开始 (等于 (读 (“z_type”), “D”))
        父索引.加入项目 (删尾空 (读 (“z_caption”)), 2, 2, 计数器)
    .判断 (等于 (读 (“z_type”), “R”))
        父索引.加入项目 (删尾空 (读 (“z_caption”)), 3, 3, 计数器)
    .判断 (等于 (读 (“z_type”), “T”))
        父索引.加入项目 (删尾空 (读 (“z_caption”)), 4, 4, 计数器)
    .判断 (等于 (读 (“z_type”), “E”))
        父索引.加入项目 (删尾空 (读 (“z_caption”)), 6, 6, 计数器)
    .默认
        
    .判断结束
    置当前库 (“zlk”)
    到首记录 ()
    .如果真 (查找 (等于 (读 (“z_id”), ID号)))
        写 (“z_sy”, 计数器)
    .如果真结束
    置当前库 (“zlkid”)
    .如果真 (大于 (取文本长度 (删尾空 (当前ID)), 0))
        .如果真 (等于 (ID号, 删尾空 (当前ID)))
            赋值 (资料项目索引, 计数器)
        .如果真结束
        
    .如果真结束
    赋值 (计数器, 相加 (计数器, 1))
    跳过 ()
.判断循环尾 ()
关闭 (“zlkid”)
.如果真 (大于 (取文本长度 (删尾空 (当前ID)), 0))
    赋值 (是否检测保存, 假)
    赋值 (.最大化按钮, 资料项目索引)
    _树型框1_项目被选择 (0)
    赋值 (是否检测保存, 真)
.如果真结束


.子程序 _分隔条1_被拖动, 空白型, , 
.参数 原位置, 整数型, , 
.参数 目的位置, 整数型, , 

.如果真 (小于 (目的位置, 50))
    赋值 (目的位置, 50)
.如果真结束
.如果真 (大于 (目的位置, 相减 (取用户区宽度 (), 50)))
    赋值 (目的位置, 相减 (取用户区宽度 (), 50))
.如果真结束
赋值 (分隔条左边, 目的位置)
__启动窗口_尺寸被改变 ()
返回 ()


.子程序 添加新的资料, 空白型, , 
 ' 浏览器启动
.如果 (大于 (入口参数个数, 0))
    赋值 (新资料标志, 真)
    赋值 (.可视, 真)
    .如果真 (等于 (.选中, 假))
        _浏览器窗口_被选择 ()
    .如果真结束
    .如果真 (.选中)
        _目录窗口_被选择 ()
    .如果真结束
    赋值 (.禁止, 真)
    16.加入状态 (#禁止)
    .如果 (等于 (入口参数 [2], “右键”))
        赋值 (., 取剪辑板文本 ())
        赋值 (新标题名称, 取文本左边 (删全部空 (取剪辑板文本 ()), 40))
        赋值 (.现行子夹, 0)
        赋值 (., 入口参数 [1])
        #.未知支持库函数_0 ()
    .否则
        赋值 (新标题名称, 入口参数 [3])
        赋值 (.现行子夹, 1)
        赋值 (., 入口参数 [1])
        未知支持库函数_2 ()
    .如果结束
    
    赋值 (新标题名称, 效验文件名 (新标题名称, 相加 (工作路径, “\data”)))
    .如果真 (等于 (取文本右边 (新标题名称, 4), “.tmp”))
        赋值 (新标题名称, 取文本左边 (新标题名称, 相减 (取文本长度 (新标题名称), 4)))
    .如果真结束
    
.否则
    赋值 (新标题名称, “”)
.如果结束


.子程序 效验文件名, 文本型, , 注意：无效的文件名返回空
.参数 文件名, 文本型, , 被效验的文件名
.参数 所在目录, 文本型, , 文件名所在目录

.局部变量 特别字符序列, 文本型, , , 
.局部变量 计数器, 整数型, , , 
.局部变量 文本长度, 整数型, , , 
.局部变量 比较字符, 文本型, , , 

.如果真 (不等于 (取文本右边 (所在目录, 1), “\”))
    赋值 (所在目录, 相加 (所在目录, “\”))
.如果真结束
赋值 (特别字符序列, 相加 (“:\/*?. []<>|',;”, #换行符, #引号))
赋值 (计数器, 1)
赋值 (文本长度, 取文本长度 (特别字符序列))
.判断循环首 (小于或等于 (计数器, 文本长度))
    赋值 (比较字符, 取文本中间 (特别字符序列, 计数器, 1))
    .如果真 (大于 (寻找文本 (文件名, 比较字符, , 假), 0))
        子文本替换 (文件名, 比较字符, , , , 真)
    .如果真结束
    赋值 (计数器, 相加 (计数器, 1))
.判断循环尾 ()
.如果真 (等于 (取文本长度 (文件名), 0))
    返回 (文件名)
.如果真结束
.如果真 (大于 (取文本长度 (文件名), 50))
    赋值 (文件名, 取文本左边 (文件名, 20))
.如果真结束
.如果 (文件是否存在 (相加 (所在目录, 文件名)))
    返回 (取临时文件名 (所在目录)) ' 临时文件名是以“.tmp”为扩展名的
.否则
    返回 (文件名)
.如果结束


.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.判断开始 (等于 (按钮索引, 0))
    _添加根目录_被选择 ()
.判断 (等于 (按钮索引, 1))
    _添加当前目录的子目录_被选择 ()
.判断 (等于 (按钮索引, 2))
    _添加标题_被选择 ()
.判断 (等于 (按钮索引, 3))
    _删除目录或标题_被选择 ()
.判断 (等于 (按钮索引, 4))
    _向上_被选择 ()
.判断 (等于 (按钮索引, 5))
    _向下_被选择 ()
.判断 (等于 (按钮索引, 7))
    _打开磁盘文件_被选择 ()
.判断 (等于 (按钮索引, 8))
    _另存为_被选择 ()
.判断 (等于 (按钮索引, 9))
    _保存当前资料_被选择 ()
.判断 (等于 (按钮索引, 10))
    _打印资料_被选择 ()
.判断 (等于 (按钮索引, 11)) ' 查找
    _查找资料_被选择 ()
.判断 (等于 (按钮索引, 13)) ' [文本]下拉框
    弹出菜单 ()
.判断 (等于 (按钮索引, 14))
    _选择字体_被选择 ()
.判断 (等于 (按钮索引, 16))
    _目录窗口_被选择 ()
.判断 (等于 (按钮索引, 17))
    _浏览器窗口_被选择 ()
.判断 (等于 (按钮索引, 18))
    _资料编辑窗口_被选择 ()
.默认
    
.判断结束


.子程序 _添加标题_被选择, 空白型, , 
.局部变量 父ID号, 文本型, , , 
.局部变量 ID号, 文本型, , , 
.局部变量 父ID长度, 整数型, , , 
.局部变量 临时ID号, 文本型, , , 
.局部变量 标题名称, 文本型, , , 
.局部变量 资料格式, 文本型, , , 

是否保存资料 ()
 ' 先添加 zlk
 ' 查出父 ID ，算出自己的 ID
置当前库 (“zlk”)
到首记录 ()
.如果真 (等于 (注册号有效, 假))
    .如果真 (大于或等于 (计算数目 (不等于 (读 (“z_type”), “D”)), 12))
        信息框 (“非注册用户限制资料总数，请你及时注册。”, 0, )
        返回 ()
    .如果真结束
    
.如果真结束
查找 (等于 (读 (“z_sy”), 目录索引))
赋值 (父ID号, 读 (“z_id”))
赋值 (ID号, 相加 (父ID号, “  ”))
赋值 (父ID长度, 取文本长度 (父ID号))
到首记录 ()
.判断循环首 (取反 (尾记录后 ()))
    赋值 (临时ID号, 读 (“z_id”))
    .如果真 (等于 (取文本左边 (临时ID号, 父ID长度), 父ID号))
        .如果真 (大于 (临时ID号, ID号))
            赋值 (ID号, 临时ID号)
        .如果真结束
        
    .如果真结束
    跳过 ()
.判断循环尾 ()
赋值 (ID号, id加1 (取文本左边 (ID号, 相加 (父ID长度, 2))))
.如果 (新资料标志)
    置当前库 (“zlk”)
    .判断开始 (等于 (新资料格式, “丰富格式文本_RTF”))
        赋值 (., 1)
        加记录 (ID号, 父ID号, “R”, 新标题名称, 到字节集 (.), , , )
    .判断 (等于 (新资料格式, “纯文本_TXT”))
        赋值 (., 0)
        加记录 (ID号, 父ID号, “T”, 新标题名称, 到字节集 (.), , , )
    .判断 (等于 (新资料格式, “办公组件格式_EWD”))
         ' 办公组件的“取文件内容”“置文件内容”命令不可用，所以改用如下办法。
        相加 (工作路径, “\data\lszl.ewd”).未知支持库函数_1 ()
        加记录 (ID号, 父ID号, “E”, 新标题名称, 读入文件 (相加 (工作路径, “\data\lszl.ewd”)), , , )
        .如果真 (大于 (入口参数个数, 0)) ' 记录URL
            写 (“z_url”, 入口参数 [1])
        .如果真结束
        
    .默认
        
    .判断结束
    
.否则
    赋值 (标题名称, 取标题名称 (“新建标题”))
    赋值 (新资料格式, “”)
    载入 (获得文件格式窗口, , 真)
    .如果 (等于 (取文本长度 (新资料格式), 0))
        赋值 (资料格式, “R”)
    .否则
        .判断开始 (大于 (寻找文本 (新资料格式, “R”, , 真), 0))
            赋值 (资料格式, “R”)
        .判断 (大于 (寻找文本 (新资料格式, “X”, , 真), 0))
            赋值 (资料格式, “T”)
        .判断 (大于 (寻找文本 (新资料格式, “E”, , 真), 0))
            赋值 (资料格式, “E”)
        .默认
            
        .判断结束
        
    .如果结束
    置当前库 (“zlk”)
    加记录 (ID号, 父ID号, 资料格式, 标题名称, , )
    赋值 (., “”)
    未知支持库函数_2 ()
    赋值 (.现行子夹, 0)
.如果结束
刷新树型框 (ID号)

.子程序 _添加根目录_被选择, 空白型, , 
.局部变量 临时ID号, 文本型, , , 
.局部变量 ID号, 文本型, , , 
.局部变量 标题名称, 文本型, , , 

是否保存资料 ()
 ' 算出新的 ID
置当前库 (“zlk”)
到首记录 ()
赋值 (ID号, “  ”)
.判断循环首 (取反 (尾记录后 ()))
    赋值 (临时ID号, 读 (“z_id”))
    .如果真 (大于 (临时ID号, ID号))
        赋值 (ID号, 临时ID号)
    .如果真结束
    跳过 ()
.判断循环尾 ()
赋值 (ID号, id加1 (取文本左边 (ID号, 2)))
赋值 (标题名称, 取标题名称 (“新建目录”))
加记录 (ID号, “00”, “D”, 标题名称, 到字节集 (“【目录说明】（本说明只能使用TXT格式）”), )
-1.加入项目 (标题名称, 2, 2, )
刷新树型框 (ID号)
资料项目索引.进入编辑 ()

.子程序 _添加当前目录的子目录_被选择, 空白型, , 
.局部变量 父ID号, 文本型, , , 
.局部变量 ID号, 文本型, , , 
.局部变量 父ID长度, 整数型, , , 
.局部变量 临时ID号, 文本型, , , 
.局部变量 标题名称, 文本型, , , 

是否保存资料 ()
 ' 先添加 zlk
 ' 查出父 ID ，算出自己的 ID
置当前库 (“zlk”)
到首记录 ()
查找 (等于 (读 (“z_sy”), 目录索引))
赋值 (父ID号, 读 (“z_id”))
赋值 (ID号, 相加 (父ID号, “  ”))
赋值 (父ID长度, 取文本长度 (父ID号))
.如果真 (大于或等于 (父ID长度, 12))
    信息框 (“分类层次不能超过 6 层”, 0, )
    返回 ()
.如果真结束
到首记录 ()
.判断循环首 (取反 (尾记录后 ()))
    赋值 (临时ID号, 读 (“z_id”))
    .如果真 (等于 (取文本左边 (临时ID号, 父ID长度), 父ID号))
        .如果真 (大于 (临时ID号, ID号))
            赋值 (ID号, 临时ID号)
        .如果真结束
        
    .如果真结束
    跳过 ()
.判断循环尾 ()
赋值 (ID号, id加1 (取文本左边 (ID号, 相加 (父ID长度, 2))))
赋值 (标题名称, 取标题名称 (“新建目录”))
加记录 (ID号, 父ID号, “D”, 标题名称, 到字节集 (“【目录说明】（本说明只能使用TXT格式）”), )
目录索引.加入项目 (标题名称, 2, 2, )
刷新树型框 (ID号)
资料项目索引.进入编辑 ()

.子程序 _删除目录或标题_被选择, 空白型, , 
.局部变量 ID号, 文本型, , , 
.局部变量 删除标志, 逻辑型, , , 

置当前库 (“zlk”)
到首记录 ()
查找 (等于 (读 (“z_sy”), 资料项目索引))
赋值 (ID号, 读 (“z_id”))
赋值 (删除标志, 假)
.如果 (等于 (读 (“z_type”), “D”))
    .如果真 (等于 (信息框 (相加 (“删除的是目录：”, 资料项目索引.取项目文本 (), “，此目录之下的所有资料将被删除！”, #换行符, “请确认你的操作。”), #确认取消钮, “注意！”), 0))
        删除 (等于 (取文本左边 (读 (“z_id”), 取文本长度 (ID号)), ID号))
        赋值 (删除标志, 真)
    .如果真结束
    
.否则
    .如果真 (等于 (信息框 (相加 (“删除项目：”, 资料项目索引.取项目文本 (), #换行符, “请确认你的操作。”), #确认取消钮, “注意！”), 0))
        删除 (等于 (删尾空 (读 (“z_id”)), ID号))
        赋值 (删除标志, 真)
    .如果真结束
    
.如果结束
.如果真 (删除标志)
    彻底删除 ()
    刷新树型框 (“”)
    目录索引.扩展 ()
    0.置文本 (“完成删除”)
.如果真结束


.子程序 _向上_被选择, 空白型, , 
.局部变量 ID号, 文本型, , , 
.局部变量 目标ID号, 文本型, , , 
.局部变量 ID号长度, 整数型, , , 
.局部变量 临时ID号1, 文本型, , , 
.局部变量 临时ID号2, 文本型, , , 
.局部变量 父ID号, 文本型, , , 
.局部变量 新ID号标志, 逻辑型, , , 
.局部变量 目标ID号长度, 整数型, , , 

置当前库 (“zlk”)
到首记录 ()
.如果真 (查找 (等于 (读 (“z_sy”), 资料项目索引)))
    赋值 (ID号, 读 (“z_id”))
    赋值 (父ID号, 读 (“z_fid”))
    .如果真 (是否已打开 (“zlkid”))
        关闭 (“zlkid”)
    .如果真结束
    排序 (“zlkid”, “z_id”, , , “z_id”, “z_fid”, “z_type”)
    打开 (“zlkid”, , , , , , )
    置当前库 (“zlkid”)
    到首记录 ()
    赋值 (ID号长度, 取文本长度 (ID号))
    .如果真 (查找 (等于 (读 (“z_id”), ID号)))
        .如果真 (等于 (取记录号 (), 1)) ' 原记录已经在顶部
            关闭 (“zlkid”)
            返回 ()
        .如果真结束
         ' 查找目标位置
        跳过 (-1)
        .如果真 (首记录前 ())
            关闭 (“zlkid”)
            返回 ()
        .如果真结束
        .如果 (等于 (读 (“z_fid”), 父ID号)) ' 在同一目录之内
            赋值 (目标ID号, 读 (“z_id”))
            赋值 (新ID号标志, 假)
        .否则
            跳过 (-1) ' 跳出本目录
            .如果 (首记录前 ()) ' 本目录在顶部
                关闭 (“zlkid”)
                返回 ()
            .否则
                赋值 (新ID号标志, 真)
                赋值 (目标ID号, 读 (“z_id”))
                .如果 (等于 (读 (“z_type”), “D”))
                    赋值 (目标ID号, 相加 (目标ID号, “01”))
                .否则
                    赋值 (目标ID号长度, 取文本长度 (目标ID号))
                    .判断循环首 (取反 (尾记录后 ()))
                        赋值 (临时ID号1, 读 (“z_id”))
                        .如果真 (等于 (取文本左边 (临时ID号1, 相减 (目标ID号长度, 2)), 取文本左边 (目标ID号, 相减 (目标ID号长度, 2))))
                            .如果真 (大于 (临时ID号1, 目标ID号))
                                赋值 (目标ID号, 临时ID号1)
                            .如果真结束
                            
                        .如果真结束
                        跳过 ()
                    .判断循环尾 ()
                    赋值 (目标ID号, id加1 (取文本左边 (目标ID号, 目标ID号长度))) ' 取得新的目标ID号
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .如果真结束
    关闭 (“zlkid”)
    .如果真 (等于 (取文本长度 (目标ID号), 0))
        返回 ()
    .如果真结束
    置当前库 (“zlk”) ' 修改资料库中的ID数据
    到首记录 ()
    .判断循环首 (取反 (尾记录后 ()))
        赋值 (临时ID号1, 删尾空 (读 (“z_id”)))
        .判断开始 (等于 (取文本左边 (临时ID号1, ID号长度), ID号))
            赋值 (临时ID号2, 相加 (目标ID号, 取文本右边 (临时ID号1, 相减 (取文本长度 (临时ID号1), ID号长度))))
            写 (“z_id”, 临时ID号2)
            写 (“z_fid”, 取文本左边 (临时ID号2, 相减 (取文本长度 (临时ID号2), 2)))
        .判断 (并且 (等于 (新ID号标志, 假), 等于 (取文本左边 (临时ID号1, ID号长度), 目标ID号)))
            赋值 (临时ID号2, 相加 (ID号, 取文本右边 (临时ID号1, 相减 (取文本长度 (临时ID号1), ID号长度))))
            写 (“z_id”, 临时ID号2)
            写 (“z_fid”, 取文本左边 (临时ID号2, 相减 (取文本长度 (临时ID号2), 2)))
        .默认
            
        .判断结束
        跳过 ()
    .判断循环尾 ()
    刷新树型框 (目标ID号)
.如果真结束


.子程序 _向下_被选择, 空白型, , 
.局部变量 ID号, 文本型, , , 
.局部变量 目标ID号, 文本型, , , 
.局部变量 ID号长度, 整数型, , , 
.局部变量 临时ID号1, 文本型, , , 
.局部变量 临时ID号2, 文本型, , , 
.局部变量 父ID号, 文本型, , , 
.局部变量 新ID号标志, 逻辑型, , , 
.局部变量 目标ID号长度, 整数型, , , 

置当前库 (“zlk”)
到首记录 ()
.如果真 (查找 (等于 (读 (“z_sy”), 资料项目索引)))
    赋值 (ID号, 读 (“z_id”))
    赋值 (父ID号, 读 (“z_fid”))
    .如果真 (是否已打开 (“zlkid”))
        关闭 (“zlkid”)
    .如果真结束
    排序 (“zlkid”, “z_id”, , , “z_id”, “z_fid”, “z_type”)
    打开 (“zlkid”, , , , , , )
    置当前库 (“zlkid”)
    到首记录 ()
    赋值 (ID号长度, 取文本长度 (ID号))
    .如果真 (查找 (等于 (读 (“z_id”), ID号)))
        .如果真 (等于 (取记录号 (), 取记录数 ())) ' 原记录已经在底部
            关闭 (“zlkid”)
            返回 ()
        .如果真结束
         ' 查找目标位置
        跳过 ()
        .如果真 (尾记录后 ())
            关闭 (“zlkid”)
            返回 ()
        .如果真结束
        .如果 (不等于 (读 (“z_type”), “D”)) ' 在同一目录之内移动
            .如果 (等于 (读 (“z_fid”), 父ID号))
                赋值 (目标ID号, 读 (“z_id”))
                赋值 (新ID号标志, 假)
            .否则
                赋值 (新ID号标志, 真)
                赋值 (目标ID号, 读 (“z_id”))
            .如果结束
            
        .否则
            赋值 (真)
            赋值 (目标ID号, 相加 (读 (“z_id”), “  ”))
        .如果结束
        .如果真 (新ID号标志)
            赋值 (目标ID号长度, 取文本长度 (目标ID号))
            .判断循环首 (取反 (尾记录后 ()))
                赋值 (读 (“z_id”))
                .如果真 (等于 (取文本左边 (相减 (2)), 取文本左边 (相减 (2))))
                    .如果真 (大于 ())
                        赋值 ()
                    .如果真结束
                    
                .如果真结束
                跳过 ()
            .判断循环尾 ()
            赋值 (id加1 (取文本左边 ())) ' 取得新的目标ID号
        .如果真结束
        
    .如果真结束
    关闭 (“zlkid”)
    .如果真 (等于 (取文本长度 (目标ID号), 0))
        返回 ()
    .如果真结束
    置当前库 (“zlk”) ' 修改资料库中的数据
    到首记录 ()
    .判断循环首 (取反 (尾记录后 ()))
        赋值 (临时ID号1, 删尾空 (读 (“z_id”)))
        .判断开始 (等于 (取文本左边 (临时ID号1, ID号长度), ID号))
            赋值 (临时ID号2, 相加 (目标ID号, 取文本右边 (临时ID号1, 相减 (取文本长度 (临时ID号1), ID号长度))))
            写 (“z_id”, 临时ID号2)
            写 (“z_fid”, 取文本左边 (临时ID号2, 相减 (取文本长度 (临时ID号2), 2)))
        .判断 (并且 (等于 (新ID号标志, 假), 等于 (取文本左边 (临时ID号1, ID号长度), 目标ID号)))
            赋值 (临时ID号2, 相加 (ID号, 取文本右边 (临时ID号1, 相减 (取文本长度 (临时ID号1), ID号长度))))
            写 (“z_id”, 临时ID号2)
            写 (“z_fid”, 取文本左边 (临时ID号2, 相减 (取文本长度 (临时ID号2), 2)))
        .默认
            
        .判断结束
        跳过 ()
    .判断循环尾 ()
    刷新树型框 (目标ID号)
.如果真结束


.子程序 是否保存资料, 空白型, , 
.局部变量 资料类型, 文本型, , , 

.如果真 (是否检测保存)
    .如果 (新资料标志)
        赋值 (资料被修改, 真)
    .否则
        置当前库 (“zlk”)
        赋值 (资料类型, 读 (“z_type”)) ' 仅对原来的保存格式判断
        .判断开始 (或者 (等于 (资料类型, “D”), 等于 (资料类型, “R”), 等于 (资料类型, “T”)))
            .如果 (不等于 (rtf资料长度, 未知支持库函数_0 ()))
                赋值 (资料被修改, 真)
            .否则
                赋值 (资料被修改, 假)
            .如果结束
            
        .判断 (等于 (资料类型, “E”))
            .如果 (未知支持库函数_12 ())
                赋值 (资料被修改, 真)
            .否则
                赋值 (资料被修改, 假)
            .如果结束
            
        .默认
            
        .判断结束
        
    .如果结束
    .如果真 (等于 (.现行子夹, 1)) ' 搜索方式不检测是否修改
        赋值 (资料被修改, 假)
    .如果真结束
    .如果真 (资料被修改)
        .如果真 (等于 (信息框 (“当前资料尚未保存到资料库，是否保存？”, #是否钮, “提示”), 5))
            _保存当前资料_被选择 ()
        .如果真结束
        假.未知支持库函数_11 ()
    .如果真结束
    
.如果真结束


.子程序 id加1, 文本型, , ID号（如0101）的右两位＋1，09＋1＝0A
.参数 ID号, 文本型, , 

.局部变量 临时ID号, 文本型, , , 
.局部变量 十位号码, 文本型, , , 
.局部变量 个位号码, 文本型, , , 
.局部变量 计数序列, 文本型, , , 
.局部变量 位置, 整数型, , , 

赋值 (临时ID号, 取文本右边 (ID号, 2))
.如果真 (等于 (临时ID号, “  ”))
    返回 (相加 (取文本左边 (ID号, 相减 (取文本长度 (ID号), 2)), “01”))
.如果真结束
赋值 (个位号码, 取文本右边 (临时ID号, 1))
赋值 (十位号码, 取文本左边 (临时ID号, 1))
.如果 (等于 (取文本长度 (ID号), 2))
    赋值 (临时ID号, “”)
.否则
    赋值 (临时ID号, 取文本左边 (ID号, 相减 (取文本长度 (ID号), 2)))
.如果结束
赋值 (计数序列, “0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ”)
赋值 (位置, 寻找文本 (计数序列, 个位号码, , 假))
.如果 (等于 (个位号码, “Z”))
    赋值 (个位号码, “0”)
    赋值 (位置, 寻找文本 (计数序列, 十位号码, , 假))
    赋值 (十位号码, 取文本中间 (计数序列, 相加 (位置, 1), 1))
.否则
    赋值 (个位号码, 取文本中间 (计数序列, 相加 (位置, 1), 1))
.如果结束
赋值 (临时ID号, 相加 (临时ID号, 十位号码, 个位号码))
返回 (临时ID号)

.子程序 取标题名称, 文本型, , 在 zlk 中查出一个不重复的标题名
.参数 标题名称, 文本型, , 初始名称

.局部变量 计数器, 整数型, , , 
.局部变量 计数字符, 文本型, , , 
.局部变量 临时标题, 文本型, , , 

置当前库 (“zlk”)
赋值 (临时标题, 标题名称)
赋值 (计数器, 1)
.判断循环首 (小于或等于 (计数器, 99))
    到首记录 ()
    赋值 (计数字符, 删全部空 (到文本 (计数器)))
    .如果真 (等于 (取文本长度 (计数字符), 1))
        赋值 (计数字符, 相加 (“0”, 计数字符))
    .如果真结束
    赋值 (临时标题, 相加 (标题名称, 计数字符))
    .如果真 (取反 (查找 (等于 (读 (“z_caption”), 临时标题))))
        跳出循环 ()
    .如果真结束
    赋值 (计数器, 相加 (计数器, 1))
.判断循环尾 ()
返回 (临时标题)

.子程序 _放弃新资料按钮_被单击, 空白型, , 
未知支持库函数_2 ()
赋值 (., “”)
赋值 (.现行子夹, 0)
赋值 (新资料标志, 假)
16.去除状态 (#禁止)
赋值 (.禁止, 假)
_目录窗口_被选择 ()
赋值 (.可视, 假)
赋值 (资料被修改, 假)

.子程序 _粘贴资料_被选择, 空白型, , 
.如果真 (等于 (浏览器句柄, 取焦点句柄 ()))
    信息框 (“浏览器不能使用粘贴功能。”, 0, )
    返回 ()
.如果真结束
.判断开始 (等于 (.现行子夹, 0))
    未知支持库函数_20 ()
.判断 (等于 (.现行子夹, 1))
    未知支持库函数_20 ()
.默认
    
.判断结束
赋值 (资料被修改, 真)

.子程序 _粘贴_被选择, 空白型, , 
_粘贴资料_被选择 ()

.子程序 _复制资料_被选择, 空白型, , 
.如果真 (等于 (浏览器句柄, 取焦点句柄 ())) ' 由于超文本浏览框没有提供“复制”功能，并且模拟键盘或发消息的方法也同样不可用。
    超文本浏览框1.发送信息 (3 × 16 × 16 ＋ 1, 0, 0) ' 复制消息
    模拟键盘 (162, 0, 0, 0) ' 按下Crtl键
    模拟键盘 (67, 0, 0, 0) ' 按下C键
    模拟键盘 (67, 0, 2, 0) ' 放开C键
    模拟键盘 (162, 0, 2, 0) ' 放开Crtl键
    信息框 (“浏览器的复制功能不能使用本按钮，请用他的右键菜单。”, 0, )
    返回 ()
.如果真结束
.判断开始 (等于 (.现行子夹, 0))
    未知支持库函数_17 ()
.判断 (等于 (.现行子夹, 1))
    未知支持库函数_19 ()
.默认
    
.判断结束


.子程序 _剪切资料_被选择, 空白型, , 
.如果真 (等于 (浏览器句柄, 取焦点句柄 ()))
    信息框 (“浏览器不能使用剪切功能。”, 0, )
    返回 ()
.如果真结束
.判断开始 (等于 (.现行子夹, 0))
    未知支持库函数_18 ()
.判断 (等于 (.现行子夹, 1))
    未知支持库函数_21 ()
.默认
    
.判断结束
赋值 (资料被修改, 真)

.子程序 _删除被选中的资料_被选择, 空白型, , 
.如果真 (等于 (浏览器句柄, 取焦点句柄 ()))
    返回 ()
.如果真结束
.判断开始 (等于 (.现行子夹, 0))
    未知支持库函数_19 ()
.判断 (等于 (.现行子夹, 1))
    未知支持库函数_23 ()
.默认
    
.判断结束
赋值 (资料被修改, 真)

.子程序 _剪切_被选择, 空白型, , 
_剪切资料_被选择 ()

.子程序 _复制_被选择, 空白型, , 
_复制资料_被选择 ()

.子程序 _删除_被选择, 空白型, , 
_删除被选中的资料_被选择 ()

.子程序 _树型框1_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

.局部变量 资料类型, 文本型, , , 

是否保存资料 ()
赋值 (资料项目索引, .取项目数值 (.最大化按钮))
置当前库 (“zlk”)
到首记录 ()
赋值 (目录索引, -1)
赋值 (父目录索引, -1)
.如果真 (查找 (等于 (读 (“z_sy”), 资料项目索引)))
    .如果 (等于 (读 (“z_type”), “D”))
        赋值 (目录索引, 资料项目索引)
    .否则
        赋值 (目录索引, 资料项目索引.取父项目 ())
    .如果结束
    .如果真 (.选中)
        _关闭浏览按钮_被单击 ()
    .如果真结束
    .如果真 (取反 (.选中))
        _资料编辑窗口_被选择 ()
    .如果真结束
    赋值 (资料类型, 读 (“z_type”))
    .判断开始 (等于 (资料类型, “E”))
         ' 办公组件的“取文件内容”“置文件内容”命令不可用，所以改用如下办法。
        写到文件 (相加 (工作路径, “\data\lszl.ewd”), 读 (“z_zl”))
        相加 (工作路径, “\data\lszl.ewd”).未知支持库函数_0 ()
        赋值 (., “”)
        赋值 (.现行子夹, 1)
    .判断 (等于 (资料类型, “R”))
        赋值 (., 1)
        赋值 (., 到文本 (读 (“z_zl”)))
        未知支持库函数_2 ()
        赋值 (.现行子夹, 0)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        13.去除状态 (#禁止)
        14.去除状态 (#禁止)
    .判断 (或者 (等于 (资料类型, “T”), 等于 (资料类型, “D”)))
        赋值 (., 0)
        纯文本字符格式.未知支持库函数_8 ()
        赋值 (., 到文本 (读 (“z_zl”)))
        未知支持库函数_2 ()
        赋值 (.现行子夹, 0)
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
        13.加入状态 (#禁止)
        14.加入状态 (#禁止)
    .默认
        
    .判断结束
    赋值 (rtf资料长度, 未知支持库函数_0 ())
    0.置文本 (“显示资料”)
    1.置文本 (资料项目索引.取项目文本 ())
    _资料选择夹_子夹被改变 ()
    .如果 (等于 (目录索引, -1))
        赋值 (父目录索引, -1)
    .否则
        赋值 (父目录索引, 目录索引.取父项目 ())
    .如果结束
    赋值 (当前选中项, 删尾空 (读 (“z_id”)))
.如果真结束
赋值 (资料被修改, 假)

.子程序 _保存当前资料_被选择, 空白型, , 
.局部变量 资料类型, 文本型, , , 
.局部变量 修改标志, 逻辑型, , , 
.局部变量 类型文本, 文本型, , , 

.如果 (新资料标志) ' 新资料保存
    0.置文本 (“获取标题”)
    载入 (获得新资料的目录和标题, , 真)
    .如果真 (等于 (取文本长度 (新资料格式), 0)) ' 判断是否按了取消键
        返回 ()
    .如果真结束
    
    1.置文本 (新标题名称)
    0.置文本 (“保存资料”)
    _添加标题_被选择 ()
    赋值 (新资料标志, 假)
    _目录窗口_被选择 ()
    赋值 (.禁止, 假)
    16.去除状态 (#禁止)
    赋值 (.可视, 假)
    赋值 (资料被修改, 假)
    赋值 (新标题名称, “”)
.否则
    置当前库 (“zlk”)
    到首记录 ()
    .如果真 (查找 (等于 (读 (“z_sy”), 资料项目索引)))
        赋值 (资料类型, 读 (“z_type”))
        赋值 (修改标志, 假)
        .判断开始 (等于 (资料类型, “D”))
            写 (“z_zl”, 到字节集 (.))
        .判断 (等于 (资料类型, “R”))
            .如果 (等于 (.现行子夹, 0))
                写 (“z_zl”, 到字节集 (.))
            .否则
                赋值 (修改标志, 真)
            .如果结束
            
        .判断 (等于 (资料类型, “T”))
            .如果 (等于 (.现行子夹, 0))
                写 (“z_zl”, 到字节集 (.))
            .否则
                赋值 (修改标志, 真)
            .如果结束
            
        .判断 (等于 (资料类型, “E”))
            .如果 (等于 (.现行子夹, 1))
                相加 (工作路径, “\data\lszl.ewd”).未知支持库函数_1 ()
                写 (“z_zl”, 读入文件 (相加 (工作路径, “\data\lszl.ewd”)))
            .否则
                赋值 (修改标志, 真)
            .如果结束
            
        .默认
            
        .判断结束
        .如果真 (修改标志)
            .如果 (等于 (资料类型, “R”))
                赋值 (类型文本, “RTF格式”)
            .否则
                .如果 (等于 (资料类型, “T”))
                    赋值 (类型文本, “TXT格式”)
                .否则
                    赋值 (类型文本, “EWD格式”)
                .如果结束
                
            .如果结束
            .如果真 (等于 (信息框 (相加 (“资料原格式 ＝ ”, 类型文本, “。是否修改？”, #换行符, “如果修改，”, 类型文本, “资料将丢失”), #是否钮, ), 5))
                载入 (获得文件格式窗口, , 真)
                .判断开始 (等于 (取文本长度 (新资料格式), 0))
                    0.置文本 (“保存失败”)
                    返回 ()
                .判断 (等于 (新资料格式, “丰富格式文本_RTF”))
                    写 (“z_type”, “R”)
                    写 (“z_zl”, 到字节集 (.))
                .判断 (等于 (新资料格式, “纯文本_TXT”))
                    写 (“z_type”, “T”)
                    写 (“z_zl”, 到字节集 (.))
                .判断 (等于 (新资料格式, “办公组件格式_EWD”))
                    写 (“z_type”, “E”)
                    相加 (工作路径, “\data\lszl.ewd”).未知支持库函数_1 ()
                    写 (“z_zl”, 读入文件 (相加 (工作路径, “\data\lszl.ewd”)))
                .默认
                    
                .判断结束
                
            .如果真结束
            
        .如果真结束
        
    .如果真结束
    
.如果结束
赋值 (资料被修改, 假)
假.未知支持库函数_11 ()
赋值 (rtf资料长度, 未知支持库函数_0 ())
0.置文本 (“就绪”)
2.置文本 (“完成保存”)

.子程序 __启动窗口_将被销毁, 空白型, , 
是否保存资料 ()
保存设置 ()

.子程序 __启动窗口_位置被改变, 空白型, , 
赋值 (主窗口左边, _启动窗口.左边)
赋值 (主窗口顶边, _启动窗口.顶边)

.子程序 _目录窗口_被选择, 空白型, , 
.如果 (.选中)
    赋值 (.选中, 假)
    赋值 (.禁止, 真)
    16.去除状态 (#选中)
.否则
    赋值 (.选中, 真)
    赋值 (.禁止, 假)
    16.加入状态 (#选中)
.如果结束
__启动窗口_尺寸被改变 ()

.子程序 _浏览器窗口_被选择, 空白型, , 
.如果 (.选中)
    赋值 (.选中, 假)
    17.去除状态 (#选中)
.否则
    赋值 (.选中, 真)
    17.加入状态 (#选中)
.如果结束
__启动窗口_尺寸被改变 ()

.子程序 _重复操作_被选择, 空白型, , 
.如果真 (等于 (浏览器句柄, 取焦点句柄 ()))
    信息框 (“浏览器不能使用重复操作功能。”, 0, )
    返回 ()
.如果真结束
.判断开始 (等于 (.现行子夹, 0))
    模拟键盘 (162, 0, 0, 0) ' 按下Crtl键
    模拟键盘 (90, 0, 0, 0) ' 按下Z键
    模拟键盘 (90, 0, 2, 0) ' 放开Z键
    模拟键盘 (162, 0, 2, 0) ' 放开Crtl键
.判断 (等于 (.现行子夹, 1))
    未知支持库函数_112 ()
.默认
    
.判断结束


.子程序 _撤销操作_被选择, 空白型, , 
.如果真 (等于 (浏览器句柄, 取焦点句柄 ()))
    信息框 (“浏览器不能使用撤销功能。”, 0, )
    返回 ()
.如果真结束
.判断开始 (等于 (.现行子夹, 0))
    模拟键盘 (162, 0, 0, 0) ' 按下Crtl键
    模拟键盘 (90, 0, 0, 0) ' 按下Z键
    模拟键盘 (90, 0, 2, 0) ' 放开Z键
    模拟键盘 (162, 0, 2, 0) ' 放开Crtl键
.判断 (等于 (.现行子夹, 1))
    未知支持库函数_22 ()
.默认
    
.判断结束


.子程序 _打印资料_被选择, 空白型, , 
.如果真 (等于 (浏览器句柄, 取焦点句柄 ()))
    .如果真 (.开始打印 ())
        #.未知支持库函数_0 ()
        返回 ()
    .如果真结束
    
.如果真结束

.判断开始 (等于 (.现行子夹, 0))
    .如果真 (.开始打印 ())
        .写文本行 (.)
        结束打印 ()
    .如果真结束
    
.判断 (等于 (.现行子夹, 1))
    .未知支持库函数_273 ()
    
.默认
    
.判断结束


.子程序 _关于Glean_被选择, 空白型, , 
载入 (关于窗口, , 真)

.子程序 _查找资料_被选择, 空白型, , 
.如果真 (等于 (浏览器句柄, 取焦点句柄 ()))
    返回 ()
.如果真结束
.判断开始 (等于 (.现行子夹, 0))
    载入 (文本查找窗口, _启动窗口, 假)
.判断 (等于 (.现行子夹, 1))
    未知支持库函数_14 ()
.默认
    
.判断结束


.子程序 _居左_被选择, 空白型, , 
.局部变量 段落格式变量, 未知类型0x30005, , , 

.如果真 (等于 (浏览器句柄, 取焦点句柄 ()))
    信息框 (“浏览器不能使用居左功能。”, 0, )
    返回 ()
.如果真结束
.判断开始 (等于 (.现行子夹, 0))
    赋值 (段落格式变量., 1)
    段落格式变量.未知支持库函数_12 ()
.判断 (等于 (.现行子夹, 1))
    #.未知支持库函数_218 ()
.默认
    
.判断结束


.子程序 _居中_被选择, 空白型, , 
.局部变量 段落格式变量, 未知类型0x30005, , , 

.如果真 (等于 (浏览器句柄, 取焦点句柄 ()))
    信息框 (“浏览器不能使用居中功能。”, 0, )
    返回 ()
.如果真结束
.判断开始 (等于 (.现行子夹, 0))
    赋值 (段落格式变量., 2)
    段落格式变量.未知支持库函数_12 ()
.判断 (等于 (.现行子夹, 1))
    #.未知支持库函数_218 ()
.默认
    
.判断结束


.子程序 _居右_被选择, 空白型, , 
.局部变量 段落格式变量, 未知类型0x30005, , , 

.如果真 (等于 (浏览器句柄, 取焦点句柄 ()))
    信息框 (“浏览器不能使用居右功能。”, 0, )
    返回 ()
.如果真结束
.判断开始 (等于 (.现行子夹, 0))
    赋值 (段落格式变量., 3)
    段落格式变量.未知支持库函数_12 ()
.判断 (等于 (.现行子夹, 1))
    #.未知支持库函数_218 ()
    
.默认
    
.判断结束


.子程序 _选择字体_被选择, 空白型, , 
.局部变量 确认标志, 逻辑型, , , 
.局部变量 字符格式变量, 未知类型0x30004, , , 

.如果真 (等于 (浏览器句柄, 取焦点句柄 ()))
    信息框 (“浏览器不能使用选择字体功能。”, 0, )
    返回 ()
.如果真结束
赋值 (.类型, 2) ' 字体选择
.判断开始 (等于 (.现行子夹, 0))
    赋值 (确认标志, 打开 ())
    .如果真 (确认标志)
        赋值 (字符格式变量., .字体名称)
        赋值 (字符格式变量., .字体大小)
        赋值 (字符格式变量., .字体颜色)
        赋值 (字符格式变量., 选择 (.加粗, 1, 0))
        赋值 (字符格式变量., 选择 (.倾斜, 相加 (字符格式变量., 2), 字符格式变量.))
        赋值 (字符格式变量., 选择 (.下划线, 相加 (字符格式变量., 4), 字符格式变量.))
        赋值 (字符格式变量., 选择 (.删除线, 相加 (字符格式变量., 8), 字符格式变量.))
        字符格式变量.未知支持库函数_10 ()
    .如果真结束
    
.判断 (等于 (.现行子夹, 1))
    未知支持库函数_277 ()
    
.默认
    
.判断结束
赋值 (.字体颜色, 0)
赋值 (.字体名称, “”)
赋值 (.字体大小, 0)
赋值 (.加粗, 假)
赋值 (.倾斜, 假)
赋值 (.下划线, 假)

.子程序 _重作IE浏览器上的按钮和菜单_被选择, 空白型, , 
.局部变量 组件注册信息变量, 组件注册信息, , , 
.局部变量 系统目录, 文本型, , , 

赋值 (系统目录, 未知支持库函数_7 (#))
赋值 (系统目录, 选择 (等于 (取文本右边 (系统目录, 1), “\”), 系统目录, 相加 (系统目录, “\”)))
赋值 (组件注册信息变量, 取组件注册信息 (“getresource.dll”))
.如果真 (不等于 (组件注册信息变量.路径, 相加 (工作路径, “\”)))
    .如果真 (大于 (取文本长度 (组件注册信息变量.路径), 0))
        执行系统命令 (取窗口句柄 (), “open”, 相加 (系统目录, “regsvr32.exe”), 相加 (“/u /s ”, 组件注册信息变量.路径, 组件注册信息变量.文件名), “”, 5) ' 反注册
    .如果真结束
    执行系统命令 (取窗口句柄 (), “open”, 相加 (系统目录, “regsvr32.exe”), 相加 (“/s ”, 工作路径, “\getresource.dll”), “”, 5) ' 注册
.如果真结束
写注册表 ()
生成html文件 () ' 3--生成 html 程序
信息框 (“重作IE浏览器上的按钮和菜单，已经完成。”, 0, )

.子程序 _撤销IE浏览器上的按钮和菜单_被选择, 空白型, , 
.局部变量 系统目录, 文本型, , , 
.局部变量 组件注册信息1, 组件注册信息, , , 

.如果真 (等于 (信息框 (相加 (“重要操作！”, #换行符, “当你需要删除本程序时，需要使用本功能。”, #换行符, “请确认你的操作。”), #确认取消钮, “重要提示”), 0))
    删除注册表项子程序 ()
    赋值 (系统目录, 未知支持库函数_7 (#))
    赋值 (系统目录, 选择 (等于 (取文本右边 (系统目录, 1), “\”), 系统目录, 相加 (系统目录, “\”)))
    赋值 (组件注册信息1, 取组件注册信息 (“getresource.dll”))
    .如果真 (大于 (取文本长度 (组件注册信息1.路径), 0))
        执行系统命令 (取窗口句柄 (), “open”, 相加 (系统目录, “regsvr32.exe”), 相加 (“/u /s ”, 组件注册信息1.路径, 组件注册信息1.文件名), “”, 5) ' 反注册
    .如果真结束
    
.如果真结束
信息框 (“浏览器上的按钮和菜单已经撤销。”, 0, )

.子程序 _导出_被选择, 空白型, , 
.如果真 (等于 (注册号有效, 假))
    信息框 (“非注册用户限制此功能，请你及时注册。”, 0, )
    返回 ()
.如果真结束
载入 (导出资料窗口, , 真)

.子程序 _树型框1_结束编辑, 逻辑型, , 
.参数 项目索引, 整数型, , 

置当前库 (“zlk”)
到首记录 ()
.如果真 (查找 (等于 (读 (“z_sy”), 项目索引)))
    写 (“z_caption”, .回车下移焦点)
    0.置文本 (“完成标题修改”)
.如果真结束


.子程序 _资料选择夹_子夹被改变, 空白型, , 
.判断开始 (等于 (.现行子夹, 0))
    置当前库 (“zlk”)
    赋值 (.选中, 真)
    赋值 (.选中, 假)
    2.置文本 (“RTF格式编辑，你可以拖动复制浏览器中的资料。”)
.判断 (等于 (.现行子夹, 1))
    赋值 (.选中, 假)
    赋值 (.选中, 真)
    2.置文本 (“所见即所得的EWD编辑，可以用复制、拖动从浏览器获取资料。”)
.默认
    
.判断结束


.子程序 _撤销_被选择, 空白型, , 
_撤销操作_被选择 ()

.子程序 禁止编辑, 空白型, , 
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
8.加入状态 (#禁止)
9.加入状态 (#禁止)
13.加入状态 (#禁止)
14.加入状态 (#禁止)

.子程序 打开编辑, 空白型, , 
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
8.去除状态 (#禁止)
9.去除状态 (#禁止)
13.去除状态 (#禁止)
14.去除状态 (#禁止)

.子程序 _目录选择夹_子夹被改变, 空白型, , 
.局部变量 计数器, 整数型, , , 

.如果真 (等于 (.可视, 假))
    返回 ()
.如果真结束
赋值 (资料被修改, 假)
.如果 (并且 (等于 (.现行子夹, 0), .选中))
    假.未知支持库函数_11 ()
    赋值 (.禁止, 假)
    赋值 (计数器, 1)
    .判断循环首 (小于或等于 (计数器, 6))
        相减 (计数器, 1).去除状态 (#禁止)
        赋值 (计数器, 相加 (计数器, 1))
    .判断循环尾 ()
    _树型框1_项目被选择 (1)
    赋值 (是否检测保存, 真)
.否则
    赋值 (.禁止, 真)
    赋值 (计数器, 1)
    .判断循环首 (小于或等于 (计数器, 6))
        相减 (计数器, 1).加入状态 (#禁止)
        赋值 (计数器, 相加 (计数器, 1))
    .判断循环尾 ()
    赋值 (.现行子夹, 0)
    赋值 (., “”)
    未知支持库函数_2 ()
    赋值 (是否检测保存, 假)
    0.置文本 (“搜索”)
    1.置文本 (“”)
    2.置文本 (“请输入搜索内容。(搜索时不要修改资料)”)
.如果结束
赋值 (资料被修改, 假)

.子程序 _查找_被选择, 空白型, , 
_查找资料_被选择 ()

.子程序 _最大目录按钮_被单击, 空白型, , 
赋值 (当前最大化的控件名称, “目录外形框”)
__启动窗口_尺寸被改变 ()

.子程序 _常规目录按钮_被单击, 空白型, , 
赋值 (当前最大化的控件名称, “”)
__启动窗口_尺寸被改变 ()

.子程序 _关闭目录按钮_被单击, 空白型, , 
.如果真 (等于 (当前最大化的控件名称, “目录外形框”))
    赋值 (当前最大化的控件名称, “”)
.如果真结束
_目录窗口_被选择 ()

.子程序 _最大浏览按钮_被单击, 空白型, , 
赋值 (当前最大化的控件名称, “WEB外形框”)
__启动窗口_尺寸被改变 ()

.子程序 _常规浏览按钮_被单击, 空白型, , 
赋值 (当前最大化的控件名称, “”)
__启动窗口_尺寸被改变 ()

.子程序 _关闭浏览按钮_被单击, 空白型, , 
.如果真 (等于 (当前最大化的控件名称, “WEB外形框”))
    赋值 (当前最大化的控件名称, “”)
.如果真结束
_浏览器窗口_被选择 ()

.子程序 _资料编辑窗口_被选择, 空白型, , 
.局部变量 ii, 整数型, , , 

.如果 (.选中)
    赋值 (.选中, 假)
    禁止编辑 ()
    18.去除状态 (#选中)
.否则
    赋值 (.选中, 真)
    18.加入状态 (#选中)
    打开编辑 ()
.如果结束
__启动窗口_尺寸被改变 ()

.子程序 _url编辑框_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    赋值 (., .内容)
.如果真结束


.子程序 _浏览主页按钮_被单击, 空白型, , 
#.未知支持库函数_0 ()

.子程序 _浏览后退按钮_被单击, 空白型, , 
#.未知支持库函数_0 ()

.子程序 _浏览前进按钮_被单击, 空白型, , 
#.未知支持库函数_0 ()

.子程序 _浏览停止按钮_被单击, 空白型, , 
#.未知支持库函数_0 ()

.子程序 _浏览刷新按钮_被单击, 空白型, , 
#.未知支持库函数_0 ()

.子程序 _最大资料按钮_被单击, 空白型, , 
赋值 (当前最大化的控件名称, “资料外形框”)
__启动窗口_尺寸被改变 ()

.子程序 _常规资料按钮_被单击, 空白型, , 
赋值 (当前最大化的控件名称, “”)
__启动窗口_尺寸被改变 ()

.子程序 _关闭资料按钮_被单击, 空白型, , 
.如果真 (等于 (当前最大化的控件名称, “资料外形框”))
    赋值 (当前最大化的控件名称, “”)
.如果真结束
_资料编辑窗口_被选择 ()

.子程序 _分隔条2_被拖动, 空白型, , 
.参数 原位置, 整数型, , 
.参数 目的位置, 整数型, , 

.如果真 (小于 (目的位置, 50))
    赋值 (目的位置, 50)
.如果真结束
.如果真 (大于 (目的位置, 相减 (取用户区高度 (), 50)))
    赋值 (目的位置, 相减 (取用户区高度 (), 50))
.如果真结束
赋值 (分隔条顶边, 目的位置)
__启动窗口_尺寸被改变 ()

.子程序 _超文本浏览框1_已就绪, 空白型, , 
0.置文本 (“就绪”)
赋值 (.内容, .)

.子程序 _超文本浏览框1_状态文本被改变, 空白型, , 
0.置文本 (.)

.子程序 _超文本浏览框1_命令状态被改变, 空白型, , 
.参数 命令, 整数型, , 
.参数 是否被允许, 逻辑型, , 

.如果 (等于 (是否被允许, 假))
    .判断开始 (等于 (命令, #))
        赋值 (.禁止, 真)
    .判断 (等于 (命令, #))
        赋值 (.禁止, 真)
    .默认
        
    .判断结束
    
.否则
    .判断开始 (等于 (命令, #))
        赋值 (.禁止, 假)
    .判断 (等于 (命令, #))
        赋值 (.禁止, 假)
    .默认
        
    .判断结束
    
.如果结束


.子程序 _超文本浏览框1_载入进度改变, 空白型, , 
.参数 进度百分比, 整数型, , 

0.置文本 (相加 (“已经载入 ”, 到文本 (进度百分比), “ %”))

.子程序 _超文本浏览框1_即将跳转, 逻辑型, , 
0.置文本 (相加 (“正在转向 ”, #左引号, ., #右引号))

.子程序 _浏览打印按钮_被单击, 空白型, , 
#.未知支持库函数_0 ()

.子程序 _浏览另存为按钮_被单击, 空白型, , 
#.未知支持库函数_0 ()

.子程序 _RTF丰富文本格式_被选择, 空白型, , 
.如果真 (取反 (.选中))
    _资料编辑窗口_被选择 ()
.如果真结束
赋值 (.现行子夹, 0)
_资料选择夹_子夹被改变 ()

.子程序 _EWD办公组件格式_被选择, 空白型, , 
.如果真 (取反 (.选中))
    _资料编辑窗口_被选择 ()
.如果真结束
赋值 (.现行子夹, 1)
_资料选择夹_子夹被改变 ()

.子程序 _取本地网页按钮_被单击, 空白型, , 
.局部变量 nwz, 整数型, , , 

.如果真 (大于 (取文本长度 (初始目录1), 0))
    赋值 (.文件名, “”)
    赋值 (.过滤器, “”)
    赋值 (.初始目录, 初始目录1)
.如果真结束
赋值 (.类型, 0) ' 打开文件
.如果真 (打开 ())
    赋值 (., .文件名)
    赋值 (nwz, 倒找文本 (.文件名, “\”, , 假))
    .如果真 (大于 (nwz, 0))
        赋值 (初始目录1, 取文本左边 (.文件名, nwz))
    .如果真结束
    
.如果真结束


.子程序 _另存为_被选择, 空白型, , 
.局部变量 文件名称, 文本型, , , 
.局部变量 扩展名, 文本型, , , 
.局部变量 资料, 字节集, , , 
.局部变量 位置, 整数型, , , 

.如果真 (等于 (注册号有效, 假))
    信息框 (“非注册用户限制此功能，请你及时注册。”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (.选中, 假))
    信息框 (“资料编辑窗口未打开，没有资料保存。”, 0, )
    返回 ()
.如果真结束
.判断开始 (等于 (.现行子夹, 0))
    .如果真 (等于 (未知支持库函数_0 (), 0))
        信息框 (“当前编辑窗口没有资料保存。”, 0, )
        返回 ()
    .如果真结束
    赋值 (.类型, 1)
    赋值 (.初始目录, 初始目录1)
    .如果 (新资料标志)
        赋值 (文件名称, 新标题名称)
        赋值 (.文件名, 相加 (文件名称, “.rtf”))
        赋值 (.过滤器, “*.rtf;*.txt”)
    .否则
        赋值 (文件名称, 资料项目索引.取项目文本 ())
        置当前库 (“zlk”)
        .如果 (等于 (读 (“z_type”), “T”))
            赋值 (.文件名, 相加 (文件名称, “.txt”))
            赋值 (.过滤器, “*.txt”)
        .否则
            .如果 (等于 (读 (“z_type”), “D”))
                赋值 (.文件名, 相加 (文件名称, “_目录说明.txt”))
                赋值 (.过滤器, “*.txt”)
            .否则
                赋值 (.文件名, 相加 (文件名称, “.rtf”))
                赋值 (.过滤器, “*.rtf”)
            .如果结束
            
        .如果结束
        
    .如果结束
    .如果真 (打开 ())
        赋值 (文件名称, .文件名)
        赋值 (初始目录1, 取文本左边 (文件名称, 相减 (倒找文本 (文件名称, “\”, , 假), 1)))
        赋值 (扩展名, 取文本右边 (文件名称, 4))
        .如果真 (或者 (不等于 (取文本左边 (扩展名, 1), “.”), 等于 (寻找文本 (“.rtf,.txt”, 扩展名, , 假), 0)))
            赋值 (文件名称, 相加 (文件名称, “.rtf”))
            赋值 (扩展名, “.rtf”)
        .如果真结束
        .如果 (写到文件 (文件名称, 到字节集 (.)))
            0.置文本 (“完成保存”)
        .否则
            0.置文本 (“保存失败”)
        .如果结束
        
    .如果真结束
    
.判断 (等于 (.现行子夹, 1))
    .如果 (新资料标志)
        赋值 (文件名称, 新标题名称)
    .否则
        赋值 (文件名称, 资料项目索引.取项目文本 ())
    .如果结束
    赋值 (.类型, 1)
    赋值 (.文件名, 相加 (文件名称, “.ewd”))
    赋值 (.过滤器, “*.ewd”)
    赋值 (.初始目录, 初始目录1)
    .如果真 (打开 ())
        赋值 (文件名称, .文件名)
        赋值 (初始目录1, 取文本左边 (文件名称, 相减 (倒找文本 (文件名称, “\”, , 假), 1)))
        赋值 (扩展名, 取文本右边 (文件名称, 4))
        .如果真 (或者 (不等于 (取文本左边 (扩展名, 1), “.”), 不等于 (扩展名, “.ewd”)))
            赋值 (文件名称, 相加 (文件名称, “.ewd”))
            赋值 (扩展名, “.ewd”)
        .如果真结束
         ' 取出路径、文件名
        赋值 (位置, 倒找文本 (文件名称, “\”, , 假))
        写到文件 (文件名称, 读 (“z_zl”))
        0.置文本 (“完成保存”)
    .如果真结束
    
.默认
    
.判断结束


.子程序 _打开磁盘文件_被选择, 空白型, , 
.局部变量 文件名, 文本型, , , 
.局部变量 扩展文件名, 文本型, , , 

.如果真 (等于 (注册号有效, 假))
    信息框 (“非注册用户限制此功能，请你及时注册。”, 0, )
    返回 ()
.如果真结束
赋值 (.类型, 0)
赋值 (.文件名, “”)
赋值 (.过滤器, “*.rtf;*.txt;*.ewd”)
赋值 (.初始目录, 初始目录1)
.如果真 (打开 ())
    赋值 (文件名, .文件名)
    赋值 (初始目录1, 取路径子程序 (文件名))
    赋值 (扩展文件名, 取文本右边 (文件名, 4))
    .如果真 (或者 (不等于 (取文本左边 (扩展文件名, 1), “.”), 等于 (寻找文本 (“.rtf,.txt,*.ewd”, 扩展文件名, , 假), 0)))
        信息框 (“资料类型错。”, 0, )
        返回 ()
        
    .如果真结束
    是否保存资料 ()
    .如果真 (.选中)
        _目录窗口_被选择 ()
    .如果真结束
    .如果真 (等于 (.选中, 假))
        _资料编辑窗口_被选择 ()
    .如果真结束
    .判断开始 (等于 (扩展文件名, “.ewd”))
        赋值 (.现行子夹, 1)
        文件名.未知支持库函数_0 ()
    .判断 (或者 (等于 (扩展文件名, “.rtf”), 等于 (扩展文件名, “.txt”)))
        赋值 (.现行子夹, 0)
        .如果 (等于 (扩展文件名, “.rtf”))
            赋值 (., 1)
        .否则
            赋值 (., 0)
        .如果结束
        赋值 (., 到文本 (读入文件 (文件名)))
    .默认
        
    .判断结束
    赋值 (新资料标志, 真)
    赋值 (.可视, 真)
    赋值 (.禁止, 真)
    16.加入状态 (#禁止)
    赋值 (新标题名称, 取文本左边 (文件名, 相减 (取文本长度 (文件名), 4)))
.如果真结束


.子程序 _搜索按钮_被单击, 空白型, , 
.局部变量 搜索的内容, 文本型, , , 
.局部变量 记录号, 整数型, , , 
.局部变量 被搜索的资料, 文本型, , , 
.局部变量 计数器, 整数型, , , 
.局部变量 搜索成功, 逻辑型, , , 

赋值 (搜索的内容, .内容)
.如果真 (等于 (取文本长度 (搜索的内容), 0))
    信息框 (“没有搜索内容。”, 0, )
    返回 ()
.如果真结束
.如果真 (取反 (或者 (.选中, .选中)))
    信息框 (“【搜索标题】和【搜索内容】至少要选中一个。”, 0, )
    返回 ()
.如果真结束
0.置文本 (“正在搜索”)
清空 ()
置当前库 (“zlk”)
赋值 (记录号, 取记录号 ())
赋值 (计数器, 0)
到首记录 ()
.判断循环首 (取反 (尾记录后 ()))
    赋值 (搜索成功, 假)
    .如果真 (.选中)
        赋值 (被搜索的资料, 读 (“z_caption”))
        赋值 (搜索成功, 大于 (寻找文本 (被搜索的资料, 搜索的内容, , 真), 0))
        .如果真 (搜索成功)
            读 (“z_caption”).加入项目 (取记录号 ())
            赋值 (计数器, 相加 (计数器, 1))
        .如果真结束
        
    .如果真结束
    .如果真 (并且 (.选中, 等于 (搜索成功, 假)))
        .判断开始 (等于 (读 (“z_type”), “E”))
            读 (“z_zl”).未知支持库函数_8 ()
            相加 (工作路径, “\data\lszl.txt”).未知支持库函数_4 ()
            赋值 (被搜索的资料, 到文本 (读入文件 (相加 (工作路径, “\data\lszl.txt”))))
        .判断 (或者 (等于 (读 (“z_type”), “R”), 等于 (读 (“z_type”), “D”)))
            赋值 (被搜索的资料, 未知支持库函数_32 (到文本 (读 (“z_zl”))))
        .判断 (等于 (读 (“z_type”), “T”))
            赋值 (被搜索的资料, 到文本 (读 (“z_zl”)))
        .默认
            
        .判断结束
        赋值 (被搜索的资料, 子文本替换 (被搜索的资料, #换行符, , , , 真))
        .如果真 (大于 (寻找文本 (被搜索的资料, 搜索的内容, , 真), 0))
            读 (“z_caption”).加入项目 (取记录号 ())
            赋值 (计数器, 相加 (计数器, 1))
        .如果真结束
        
    .如果真结束
    跳过 ()
.判断循环尾 ()
跳到 (记录号)
.如果 (大于 (计数器, 0))
    2.置文本 (相加 (“搜索到 ”, 到文本 (计数器), “ 篇资料。”))
.否则
    2.置文本 (“没有找到。”)
.如果结束
0.置文本 (“搜索完毕”)

.子程序 _搜索列表框_列表项被选择, 空白型, , 
.局部变量 资料类型, 文本型, , , 
.局部变量 记录号, 整数型, , , 

赋值 (记录号, .取项目数值 (.现行选中项))
置当前库 (“zlk”)
跳到 (记录号)
.如果真 (.选中)
    _关闭浏览按钮_被单击 ()
.如果真结束
.如果真 (取反 (.选中))
    _资料编辑窗口_被选择 ()
.如果真结束
赋值 (资料类型, 读 (“z_type”))
.判断开始 (等于 (资料类型, “E”))
    写到文件 (相加 (工作路径, “\data\lszl.ewd”), 读 (“z_zl”))
    相加 (工作路径, “\data\lszl.ewd”).未知支持库函数_0 ()
    赋值 (., “”)
    赋值 (.现行子夹, 1)
.判断 (或者 (等于 (资料类型, “R”), 等于 (资料类型, “D”)))
    赋值 (., 1)
    赋值 (., 到文本 (读 (“z_zl”)))
    未知支持库函数_2 ()
    赋值 (.现行子夹, 0)
.判断 (等于 (资料类型, “T”))
    赋值 (., 0)
    赋值 (., 到文本 (读 (“z_zl”)))
    未知支持库函数_2 ()
    赋值 (.现行子夹, 0)
.默认
    
.判断结束
赋值 (rtf资料长度, 未知支持库函数_0 ())
0.置文本 (“显示资料”)
1.置文本 (读 (“z_caption”))
_资料选择夹_子夹被改变 ()
赋值 (资料被修改, 假)

.子程序 _搜索编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _搜索按钮_被单击 ()
.如果真结束


.子程序 _注册_被选择, 空白型, , 
载入 (注册窗口, , 真)

.子程序 _浏览收藏夹按钮_被单击, 空白型, , 
载入 (收藏夹窗口, , 真)

.子程序 _日积月累_被选择, 空白型, , 
赋值 (.选中, 真)
载入 (日积月累窗口, , 真)

.子程序 _树型框1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _添加根目录2_被选择, 空白型, , 
_添加根目录_被选择 ()

.子程序 _添加子目录_被选择, 空白型, , 
_添加当前目录的子目录_被选择 ()

.子程序 _添加标题2_被选择, 空白型, , 
_添加标题_被选择 ()

.子程序 _删除_树型框菜单_被选择, 空白型, , 
_删除目录或标题_被选择 ()

.子程序 _上移_被选择, 空白型, , 
_向上_被选择 ()

.子程序 _下移_被选择, 空白型, , 
_向下_被选择 ()

.子程序 _重命名_被选择, 空白型, , 
资料项目索引.进入编辑 ()

.子程序 保存设置, 空白型, , 
写配置项 (相加 (工作路径, “\config.ini”), “窗口”, “主窗口左边”, 到文本 (主窗口左边))
写配置项 (相加 (工作路径, “\config.ini”), “窗口”, “主窗口顶边”, 到文本 (主窗口顶边))
写配置项 (相加 (工作路径, “\config.ini”), “窗口”, “主窗口高度”, 到文本 (主窗口高度))
写配置项 (相加 (工作路径, “\config.ini”), “窗口”, “主窗口宽度”, 到文本 (主窗口宽度))
写配置项 (相加 (工作路径, “\config.ini”), “窗口”, “分隔条左边”, 到文本 (分隔条左边))
写配置项 (相加 (工作路径, “\config.ini”), “窗口”, “分隔条顶边”, 到文本 (分隔条顶边))
写配置项 (相加 (工作路径, “\config.ini”), “目录”, “当前选中项”, 当前选中项)
写配置项 (相加 (工作路径, “\config.ini”), “通用对话框”, “初始目录1”, 初始目录1)
写配置项 (相加 (工作路径, “\config.ini”), “文本字体”, “纯文本字体名称”, 纯文本字符格式.)
写配置项 (相加 (工作路径, “\config.ini”), “文本字体”, “纯文本字体大小”, 到文本 (纯文本字符格式.))
写配置项 (相加 (工作路径, “\config.ini”), “文本字体”, “纯文本效果”, 到文本 (纯文本字符格式.))
写配置项 (相加 (工作路径, “\config.ini”), “文本字体”, “纯文本纵向偏移”, 到文本 (纯文本字符格式.))
写配置项 (相加 (工作路径, “\config.ini”), “文本字体”, “纯文本颜色”, 到文本 (纯文本字符格式.))

.子程序 _查看帮助_被选择, 空白型, , 
运行 (相加 (“hh.exe ”, 工作路径, “\G_HELP.CHM”), 假, 2)

.子程序 取组件注册信息, 组件注册信息, , 注册信息：1－名称，2－版本，3－文件名，4－路径(有尾\)
.参数 被查找的组件文件名, 文本型, , 

.局部变量 键句柄, 整数型, , , 
.局部变量 项名, 文本型, , , 
.局部变量 返回值, 整数型, , , 
.局部变量 序号, 整数型, , , 
.局部变量 组件全名称, 文本型, , , 
.局部变量 位置, 整数型, , , 
.局部变量 组件注册信息1, 组件注册信息, , , 

赋值 (组件注册信息1.名称, “”)
赋值 (组件注册信息1.版本, “”)
赋值 (组件注册信息1.路径, “”)
赋值 (组件注册信息1.文件名, “”)
0.置文本 (“正在搜索组件...”)
.如果真 (等于 (创建一个新项 (#注册表根, “CLSID”, 键句柄), 0)) ' 判断“CLSID”是否存在
    赋值 (项名, 取空白文本 (255))
    赋值 (序号, 0)
    赋值 (返回值, 枚举指定项的子项 (键句柄, 序号, 项名, 取文本长度 (项名))) ' 取序号的项名称，返回值＝0 成功
    .判断循环首 (等于 (返回值, 0))
        赋值 (组件全名称, 取文本注册项 (#根类, 相加 (“CLSID\”, 项名, “\InprocServer32\”), “”))
        赋值 (位置, 倒找文本 (组件全名称, “\”, , 真))
        .如果真 (等于 (文本比较 (取文本右边 (组件全名称, 相减 (取文本长度 (组件全名称), 位置)), 被查找的组件文件名, 假), 0))
            赋值 (组件注册信息1.名称, 取文本注册项 (#根类, 相加 (“CLSID\”, 项名, “\”), “”))
            赋值 (组件注册信息1.文件名, 取文本右边 (组件全名称, 相减 (取文本长度 (组件全名称), 位置)))
            赋值 (组件注册信息1.路径, 取文本左边 (组件全名称, 位置))
            跳出循环 ()
        .如果真结束
        赋值 (项名, 取空白文本 (255))
        赋值 (序号, 相加 (序号, 1))
        赋值 (返回值, 枚举指定项的子项 (键句柄, 序号, 项名, 取文本长度 (项名)))
    .判断循环尾 ()
.如果真结束
0.置文本 (“就绪”)
返回 (组件注册信息1)

.子程序 设置浏览器按钮的提示, 空白型, , 
.局部变量 句柄, 整数型, , , 

赋值 (句柄, 取窗口句柄 ())
未知支持库函数_0 (句柄, “主页”, 假, 假)
赋值 (句柄, 取窗口句柄 ())
未知支持库函数_0 (句柄, “后退”, 假, 假)
赋值 (句柄, 取窗口句柄 ())
未知支持库函数_0 (句柄, “前进”, 假, 假)
赋值 (句柄, 取窗口句柄 ())
未知支持库函数_0 (句柄, “停止”, 假, 假)
赋值 (句柄, 取窗口句柄 ())
未知支持库函数_0 (句柄, “刷新”, 假, 假)
赋值 (句柄, 取窗口句柄 ())
未知支持库函数_0 (句柄, “另存为”, 假, 假)
赋值 (句柄, 取窗口句柄 ())
未知支持库函数_0 (句柄, “收藏夹”, 假, 假)
赋值 (句柄, 取窗口句柄 ())
未知支持库函数_0 (句柄, “取本地网页文件”, 假, 假)
赋值 (句柄, 取窗口句柄 ())
未知支持库函数_0 (句柄, “打印”, 假, 假)

.子程序 _成批导入磁盘文件_被选择, 空白型, , 
.如果真 (等于 (注册号有效, 假))
    信息框 (“非注册用户限制此功能，请你及时注册。”, 0, )
    返回 ()
.如果真结束
载入 (成批导入磁盘文件窗口, , 真)

.子程序 _超文本浏览框1_载入完毕, 空白型, , 
获取焦点 ()
赋值 (浏览器句柄, 取焦点句柄 ())

.子程序 _超级编辑框1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

 ' 检查菜单功能禁止状态
.如果 (未知支持库函数_14 ())
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
.如果结束
.如果 (剪辑板中可有文本 ())
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
.如果结束
.如果 (等于 (., 0))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
.如果结束
.如果 (等于 (., 0)) ' 文本状态
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
.如果结束


弹出菜单 ()

.子程序 _全选_被选择, 空白型, , 
获取焦点 ()
模拟键盘 (162, 0, 0, 0) ' 按下Crtl键
模拟键盘 (65, 0, 0, 0) ' 按下A键
模拟键盘 (65, 0, 2, 0) ' 放开A键
模拟键盘 (162, 0, 2, 0) ' 放开Crtl键

.子程序 _打印_被选择, 空白型, , 
_打印资料_被选择 ()

.窗口程序集 获得新资料的目录和标题窗口程序集, , , 

.程序集变量 选中目录索引, 空白型, , , 
.子程序 _获得新资料的目录和标题_创建完毕, 空白型, , 
.局部变量 ID号, 文本型, , , 
.局部变量 计数器, 整数型, , , 
.局部变量 当前索引, 整数型, , , 

.如果真 (等于 (取文本长度 (新标题名称), 0))
    赋值 (新标题名称, 取标题名称 (“新标题”))
.如果真结束
赋值 (.内容, 新标题名称)
置当前库 (“zlk”)
排序 (“zlkid”, “z_id”, , 等于 (读 (“z_type”), “D”), “z_id”, “z_fid”, “z_type”, “z_caption”)
打开 (“zlkid”, , , , , , )
置当前库 (“zlkid”)
到首记录 ()
赋值 (计数器, 0)
赋值 (当前索引, 0)
.判断循环首 (等于 (尾记录后 (), 假))
    赋值 (ID号, 删尾空 (读 (“z_id”)))
    .如果真 (等于 (读 (“z_type”), “D”))
        相加 (取重复文本 (相减 (取文本长度 (ID号), 2), “-”), 读 (“z_caption”)).加入项目 ()
        .如果真 (大于 (取文本长度 (当前选中项), 0))
            .如果真 (等于 (取文本左边 (ID号, 取文本长度 (当前选中项)), 当前选中项))
                赋值 (当前索引, 计数器)
            .如果真结束
            
        .如果真结束
        
    .如果真结束
    跳过 ()
    赋值 (计数器, 相加 (计数器, 1))
.判断循环尾 ()
赋值 (.现行选中项, 当前索引)
赋值 (.标题, 当前索引.取项目文本 ())
赋值 (.标题, 新标题名称)
.判断开始 (等于 (_启动窗口..现行子夹, 0))
    赋值 (.选中, 真)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.标题, .标题)
.判断 (等于 (_启动窗口..现行子夹, 1))
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 真)
    赋值 (.标题, .标题)
.判断 (等于 (_启动窗口..现行子夹, 2))
    赋值 (.选中, 真)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.标题, .标题)
.默认
    
.判断结束


.子程序 _获得新资料的目录和标题_将被销毁, 空白型, , 
关闭 (“zlkid”)

.子程序 _确认按钮_被单击, 空白型, , 
赋值 (新标题名称, 删全部空 (.内容))
赋值 (新资料格式, .标题)
.如果真 (等于 (取文本长度 (新标题名称), 0))
    赋值 (新标题名称, 取标题名称 (“新标题”))
.如果真结束
置当前库 (“zlkid”)
跳到 (相加 (选中目录索引, 1))
赋值 (当前选中项, 读 (“z_id”))
置当前库 (“zlk”)
到首记录 ()
查找 (等于 (读 (“z_id”), 当前选中项))
赋值 (目录索引, 读 (“z_sy”))
销毁 ()

.子程序 _目录列表框_列表项被选择, 空白型, , 
赋值 (选中目录索引, 获得新资料的目录和标题..现行选中项)
赋值 (.标题, 选中目录索引.取项目文本 ())

.子程序 _标题编辑框_内容被改变, 空白型, , 
赋值 (.标题, .内容)

.子程序 _rtf单选框_被单击, 空白型, , 
.判断开始 (.选中)
    赋值 (.标题, .标题)
.判断 (.选中)
    赋值 (.标题, .标题)
.判断 (.选中)
    赋值 (.标题, .标题)
.默认
    
.判断结束


.子程序 _txt单选框_被单击, 空白型, , 
_rtf单选框_被单击 ()

.子程序 _ewd单选框_被单击, 空白型, , 
_rtf单选框_被单击 ()

.子程序 _取消按钮_被单击, 空白型, , 
赋值 (新资料格式, .标题)
销毁 ()


.窗口程序集 导出资料窗口程序集, , , 

.子程序 _导出资料窗口_创建完毕, 空白型, , 
.局部变量 当前索引, 整数型, , , 
.局部变量 ID号, 文本型, , , 

赋值 (.位置, 0)
置当前库 (“zlk”)
排序 (“zlkid”, “z_id”, , , “z_id”, “z_fid”, “z_type”, “z_caption”)
打开 (“zlkid”, , , , , , )
置当前库 (“zlkid”)
到首记录 ()
赋值 (当前索引, 0)
.判断循环首 (等于 (尾记录后 (), 假))
    赋值 (ID号, 读 (“z_id”))
    .如果 (等于 (读 (“z_type”), “D”))
        相加 (取重复文本 (相乘 (相减 (取文本长度 (ID号), 2), 2), “.”), “【目录】”, 删尾空 (读 (“z_caption”))).加入项目 ()
    .否则
        相加 (取重复文本 (相乘 (相减 (取文本长度 (ID号), 2), 2), “.”), 读 (“z_caption”)).加入项目 ()
    .如果结束
    跳过 ()
.判断循环尾 ()
赋值 (.目录, 相加 (工作路径, “\data”))
赋值 (.内容, 相加 (工作路径, “\data”))
赋值 (.驱动器, 取文本左边 (工作路径, 1))

.子程序 _放弃按钮_被单击, 空白型, , 
销毁 ()

.子程序 _导出按钮_被单击, 空白型, , 
.局部变量 当前目录, 文本型, , "100", 存放目录名称，分级堆栈型。
.局部变量 目录索引, 整数型, , , 目录堆栈索引
.局部变量 ID号, 文本型, , , 
.局部变量 ID号长度, 整数型, , , 
.局部变量 文件名, 文本型, , , 
.局部变量 计数器, 整数型, , , 
.局部变量 标题名称, 文本型, , , 
.局部变量 文件全名, 文本型, , , 
.局部变量 选中项目数, 整数型, , , 选中的项目数，进度条用
.局部变量 项目数, 整数型, , , 
.局部变量 资料, 字节集, , , 
.局部变量 文件名2, 文本型, , , 

赋值 (计数器, 1)
.判断循环首 (小于或等于 (计数器, 100))
    赋值 (当前目录 [计数器], “”)
    赋值 (计数器, 相加 (计数器, 1))
.判断循环尾 ()
赋值 (当前目录 [1], 删尾空 (.内容)) ' 资料的根目录
赋值 (目录索引, 1)
赋值 (选中项目数, 0)
赋值 (计数器, 1)
赋值 (项目数, 取项目数 ())
.判断循环首 (小于或等于 (计数器, 项目数))
    .如果真 (相减 (计数器, 1).是否被选中 ())
        赋值 (选中项目数, 相加 (选中项目数, 1))
    .如果真结束
    赋值 (计数器, 相加 (计数器, 1))
.判断循环尾 ()
置当前库 (“zlkid”)
到首记录 ()
赋值 (计数器, 0)
.判断循环首 (取反 (尾记录后 ()))
    .如果真 (相减 (取记录号 (), 1).是否被选中 ())
        赋值 (计数器, 相加 (计数器, 1))
        赋值 (.位置, 取整 (相除 (相乘 (100, 计数器), 选中项目数)))
        .判断开始 (等于 (读 (“z_type”), “D”))
             ' 首先处理目录的堆栈
            赋值 (ID号, 删尾空 (读 (“z_id”)))
            赋值 (ID号长度, 取文本长度 (ID号))
            赋值 (目录索引, 相加 (取整 (相除 (ID号长度, 2)), 1))
            赋值 (标题名称, 读 (“z_caption”))
            赋值 (文件名, 文件名称非法字符处理 (标题名称))
            赋值 (计数器, 1)
            .判断循环首 (小于或等于 (计数器, 相减 (目录索引, 2)))
                .如果真 (等于 (取文本长度 (当前目录 [相加 (计数器, 1)]), 0))
                    赋值 (当前目录 [相加 (计数器, 1)], 当前目录 [计数器])
                .如果真结束
                赋值 (计数器, 相加 (计数器, 1))
            .判断循环尾 ()
            赋值 (当前目录 [目录索引], 相加 (当前目录 [相减 (目录索引, 1)], “\”, 文件名))
             ' 没有目录则创建
            .如果真 (取反 (改变目录 (当前目录 [目录索引])))
                创建目录 (当前目录 [目录索引])
            .如果真结束
            置当前库 (“zlk”)
            到首记录 ()
            .如果真 (查找 (等于 (读 (“z_id”), ID号)))
                赋值 (资料, 读 (“z_zl”))
                .如果真 (大于 (取字节集长度 (资料), 0))
                    赋值 (文件全名, 相加 (当前目录 [目录索引], “\”, 文件名, “_目录说明.txt”))
                    写到文件 (文件全名, 资料)
                .如果真结束
                
            .如果真结束
            
            置当前库 (“zlkid”)
        .判断 (等于 (读 (“z_type”), “E”))
            赋值 (ID号, 读 (“z_id”))
            置当前库 (“zlk”)
            到首记录 ()
            .如果真 (查找 (等于 (删尾空 (读 (“z_id”)), ID号)))
                赋值 (文件名2, 文件名称非法字符处理 (删尾空 (读 (“z_caption”))))
                赋值 (文件全名, 相加 (当前目录 [目录索引], “\”, 文件名2, “.ewd”))
                 ' 提示用户是否覆盖同名文件
                .如果 (文件是否存在 (文件全名))
                    .如果 (等于 (信息框 (相加 (“文件：”, 文件全名, “ 已经存在，是否覆盖？”), #确认取消钮, “请确认”), 0))
                        写到文件 (文件全名, 读 (“z_zl”))
                    .否则
                        
                    .如果结束
                    
                .否则
                    写到文件 (文件全名, 读 (“z_zl”))
                .如果结束
                
            .如果真结束
            置当前库 (“zlkid”)
        .判断 (或者 (等于 (读 (“z_type”), “R”), 等于 (读 (“z_type”), “T”)))
            赋值 (ID号, 删尾空 (读 (“z_id”)))
            置当前库 (“zlk”)
            到首记录 ()
            .如果真 (查找 (等于 (读 (“z_id”), ID号)))
                赋值 (文件名2, 文件名称非法字符处理 (读 (“z_caption”)))
                .如果 (等于 (读 (“z_type”), “R”))
                    赋值 (文件全名, 相加 (当前目录 [目录索引], “\”, 文件名2, “.rtf”))
                .否则
                    赋值 (文件全名, 相加 (当前目录 [目录索引], “\”, 文件名2, “.txt”))
                .如果结束
                应该提示用户是否覆盖同名文件
                .如果 (文件是否存在 (文件全名))
                    .如果 (等于 (信息框 (相加 (“文件：”, 文件全名, “ 已经存在，是否覆盖？”), #确认取消钮, “请确认”), 0))
                        写到文件 (文件全名, 读 (“z_zl”))
                    .否则
                        
                    .如果结束
                    
                .否则
                    写到文件 (文件全名, 读 (“z_zl”))
                .如果结束
                
            .如果真结束
            置当前库 (“zlkid”)
        .默认
            
        .判断结束
        
    .如果真结束
    跳过 ()
.判断循环尾 ()
改变目录 (工作路径)
信息框 (“完成导出资料。”, 0, )
销毁 ()

.子程序 _目录框1_目录被改变, 空白型, , 
赋值 (.内容, .目录)

.子程序 _驱动器框1_驱动器被改变, 空白型, , 
赋值 (.目录, 相加 (.驱动器, “:\”))
赋值 (.内容, .目录)

.子程序 _目录列表框_选中状态被改变, 空白型, , 
.局部变量 记录号, 整数型, , , 
.局部变量 ID号, 文本型, , , 
.局部变量 ID号长度, 整数型, , , 
.局部变量 目录选中状态, 逻辑型, , , 
.局部变量 记录号2, 整数型, , , 

赋值 (记录号, 相加 (.现行选中项, 1))
置当前库 (“zlkid”)
跳到 (记录号)
.如果真 (等于 (读 (“z_type”), “D”))
    赋值 (ID号, 删尾空 (读 (“z_id”)))
    赋值 (ID号长度, 取文本长度 (ID号))
    赋值 (目录选中状态, 相减 (记录号, 1).是否被选中 ()) ' 选中目录则目录之下均被选中
    .判断循环首 (并且 (等于 (取文本左边 (读 (“z_id”), ID号长度), ID号), 等于 (尾记录后 (), 假)))
        相减 (取记录号 (), 1).选中项目 (目录选中状态)
        跳过 ()
    .判断循环尾 ()
.如果真结束
 ' 目录之下只要有选中的，目录则被选中。
到首记录 ()
.判断循环首 (取反 (尾记录后 ()))
    .如果真 (等于 (读 (“z_type”), “D”))
        赋值 (记录号2, 取记录号 ())
        赋值 (ID号, 读 (“z_id”))
        赋值 (ID号长度, 取文本长度 (ID号))
        .如果 (查找 (并且 (不等于 (读 (“z_type”), “D”), 等于 (取文本左边 (读 (“z_id”), ID号长度), ID号), 相减 (取记录号 (), 1).是否被选中 ())))
            相减 (记录号2, 1).选中项目 (真)
        .否则
            相减 (记录号2, 1).选中项目 (假)
        .如果结束
        跳到 (记录号2)
    .如果真结束
    跳过 ()
.判断循环尾 ()

.子程序 _导出资料窗口_将被销毁, 空白型, , 
关闭 (“zlkid”)

.子程序 _新建目录按钮_被单击, 空白型, , 
载入 (新文件夹窗口, , 真)
刷新显示 ()

.子程序 _全部选择框_被单击, 空白型, , 
.局部变量 是否选中, 逻辑型, , , 

.如果 (.选中)
    赋值 (是否选中, 真)
.否则
    赋值 (是否选中, 假)
.如果结束
置当前库 (“zlkid”)
到首记录 ()
.判断循环首 (取反 (尾记录后 ()))
    相减 (取记录号 (), 1).选中项目 (是否选中)
    跳过 ()
.判断循环尾 ()

.子程序 文件名称非法字符处理, 文本型, , 
.参数 原文件名, 文本型, , 删除文件名中的非法字符

.局部变量 计数器, 整数型, , , 
.局部变量 文本长度, 整数型, , , 
.局部变量 字符序列, 文本型, , , 
.局部变量 返回文件名, 文本型, , , 

赋值 (字符序列, 相加 (“:\/*?. []<>|',;”, #换行符, #引号))
赋值 (返回文件名, 删尾空 (原文件名))
赋值 (计数器, 1)
赋值 (文本长度, 取文本长度 (字符序列))
.判断循环首 (小于或等于 (计数器, 文本长度))
    赋值 (返回文件名, 子文本替换 (返回文件名, 取文本中间 (字符序列, 计数器, 1), , , , 真))
    赋值 (计数器, 相加 (计数器, 1))
.判断循环尾 ()
返回 (返回文件名)

.窗口程序集 关于窗口程序集, , , 

.子程序 _关于窗口_创建完毕, 空白型, , 
连续赋值 (关于窗口.底色, .背景颜色, .背景颜色, .背景颜色)

.子程序 _关于窗口_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.子程序 _图片框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.子程序 _标签1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.子程序 _标签3_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.子程序 _标签5_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.窗口程序集 新文件夹窗口程序集, , , 

.子程序 _新文件夹窗口_创建完毕, 空白型, , 
赋值 (.标题, 删尾空 (导出资料窗口..内容))

.子程序 _确定按钮_被单击, 空白型, , 
.局部变量 目录名称, 文本型, , , 
.局部变量 文本长度, 整数型, , , 
.局部变量 计数器, 整数型, , , 
.局部变量 新目录名, 文本型, , , 

赋值 (目录名称, 删尾空 (.内容))
赋值 (文本长度, 取文本长度 (目录名称))
.如果真 (等于 (文本长度, 0))
    信息框 (“请填写目录名。”, 0, )
    返回 ()
.如果真结束
赋值 (计数器, 1)
.判断循环首 (小于或等于 (计数器, 文本长度))
    .如果真 (大于 (寻找文本 (“<>:|*?/\”, 取文本中间 (目录名称, 计数器, 1), , 假), 0))
        信息框 (“目录名称中不能包含字符（<>:|*?/\）,请修改。”, 0, )
        返回 ()
    .如果真结束
    赋值 (计数器, 相加 (计数器, 1))
.判断循环尾 ()
赋值 (新目录名, 相加 (删尾空 (导出资料窗口..内容), “\”, 目录名称))
创建目录 (新目录名)
赋值 (导出资料窗口..目录, 新目录名)
赋值 (导出资料窗口..内容, 新目录名)
销毁 ()

.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()

.窗口程序集 获得文件格式窗口程序集, , , 

.子程序 _确认按钮_被单击, 空白型, , 
赋值 (新资料格式, .标题)
销毁 ()

.子程序 _获得文件格式窗口_创建完毕, 空白型, , 
.判断开始 (等于 (_启动窗口..现行子夹, 0))
    赋值 (.选中, 真)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.标题, .标题)
.判断 (等于 (_启动窗口..现行子夹, 1))
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 真)
    赋值 (.标题, .标题)
.判断 (等于 (_启动窗口..现行子夹, 2))
    赋值 (.选中, 真)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.标题, .标题)
.默认
    
.判断结束
赋值 (新资料格式, “”)

.子程序 _rtf单选框1_被单击, 空白型, , 
.判断开始 (.选中)
    赋值 (.标题, .标题)
.判断 (.选中)
    赋值 (.标题, .标题)
.判断 (.选中)
    赋值 (.标题, .标题)
.默认
    
.判断结束


.子程序 _txt单选框1_被单击, 空白型, , 
_rtf单选框1_被单击 ()

.子程序 _ewd单选框1_被单击, 空白型, , 
_rtf单选框1_被单击 ()

.子程序 _放弃按钮_被单击, 空白型, , 
销毁 ()

.窗口程序集 文本查找窗口程序集, , , 

.程序集变量 查找位置, 整数型, , , 
.子程序 _查找按钮_被单击, 空白型, , 
.局部变量 查找位置, 整数型, , , 
.局部变量 循环计数, 整数型, , , 
.局部变量 查找文本长度, 空白型, , , 

.如果真 (等于 (取文本长度 (.内容), 0))
    _启动窗口.置文本 (., 2, “没有查找内容。”)
    返回 ()
.如果真结束
.判断开始 (等于 (_启动窗口..现行子夹, 0))
    赋值 (查找文本长度, 取文本长度 (.内容))
    赋值 (查找文本长度, 选择 (开头字符是否汉字子程序 (.内容), 相除 (查找文本长度, 2), 查找文本长度))
    .如果 (.选中)
        赋值 (循环计数, _启动窗口.未知支持库函数_0 (.))
        .判断循环首 (大于 (循环计数, 0))
            赋值 (查找位置, _启动窗口.未知支持库函数_16 (., 循环计数, 假, , .内容))
            .如果真 (并且 (小于 (查找位置, 查找位置), 大于 (查找位置, 0)))
                跳出循环 ()
            .如果真结束
            赋值 (循环计数, 相减 (循环计数, 1))
        .判断循环尾 ()
        .如果 (小于或等于 (循环计数, 0))
            _启动窗口.置文本 (., 2, “搜索完毕”)
            赋值 (_启动窗口.., 0)
        .否则
            赋值 (查找位置, 查找位置)
            _启动窗口.置文本 (., 2, “找到”)
            赋值 (_启动窗口.., 查找位置)
            赋值 (_启动窗口.., 查找文本长度)
            _启动窗口.获取焦点 (.)
        .如果结束
        
    .否则
        赋值 (查找位置, 查找位置)
        赋值 (循环计数, 0)
        .判断循环首 (大于或等于 (查找位置, 0))
            赋值 (查找位置, _启动窗口.未知支持库函数_16 (., 相加 (查找位置, 循环计数), 假, , .内容))
            .如果真 (或者 (大于 (查找位置, 查找位置), 小于 (查找位置, 0)))
                跳出循环 ()
            .如果真结束
            赋值 (循环计数, 相加 (循环计数, 1))
        .判断循环尾 ()
        .如果 (大于 (查找位置, 0))
            赋值 (查找位置, 查找位置)
            _启动窗口.置文本 (., 2, “找到”)
            赋值 (_启动窗口.., 查找位置)
            赋值 (_启动窗口.., 查找文本长度)
            _启动窗口.获取焦点 (.)
        .否则
            _启动窗口.置文本 (., 2, “搜索完毕”)
            赋值 (_启动窗口.., 0)
        .如果结束
        
    .如果结束
    
.判断 (等于 (_启动窗口..现行子夹, 1))
    
.默认
    
.判断结束


.子程序 _查找放弃按钮_被单击, 空白型, , 
销毁 ()

.子程序 _向上单选框_被单击, 空白型, , 
.判断开始 (等于 (_启动窗口..现行子夹, 0))
    .如果 (.选中)
        赋值 (查找位置, _启动窗口.未知支持库函数_0 (.))
    .否则
        赋值 (查找位置, 0)
    .如果结束
    
.判断 (等于 (_启动窗口..现行子夹, 1))
    
    
.默认
    
.判断结束


.子程序 _向下单选框_被单击, 空白型, , 
.判断开始 (等于 (_启动窗口..现行子夹, 0))
    .如果 (.选中)
        赋值 (查找位置, _启动窗口.未知支持库函数_0 (.))
    .否则
        赋值 (查找位置, 0)
    .如果结束
    
.判断 (等于 (_启动窗口..现行子夹, 1))
    
    
.默认
    
.判断结束


.子程序 _查找编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _查找按钮_被单击 ()
.如果真结束


.子程序 _查找编辑框_内容被改变, 空白型, , 
_向上单选框_被单击 ()

.窗口程序集 注册窗口程序集, , , 

.子程序 _注册窗口_创建完毕, 空白型, , 
赋值 (.内容, 取磁盘序列号子程序 ())

.子程序 _确认按钮_被单击, 空白型, , 
写配置项 (相加 (工作路径, “\config.ini”), “注册”, “注册号”, 删全部空 (.内容))
信息框 (相加 (“注册后请退出程序。”, #换行符, “如果你的注册号正确，重新启动程序后将放开对你的所有限制。”), 0, )
销毁 ()

.子程序 _放弃按钮_被单击, 空白型, , 
销毁 ()

.窗口程序集 收藏夹窗口程序集, , , 

.子程序 _收藏夹窗口_创建完毕, 空白型, , 
.局部变量 收藏夹目录, 文本型, , , 
.局部变量 URL名称, 文本型, , , 
.局部变量 位置, 整数型, , , 

0.移动 (0, 相减 (收藏夹窗口.宽度, 5), 相减 (收藏夹窗口.高度, 30))
赋值 (收藏夹目录, 未知支持库函数_7 (#))
赋值 (URL名称, 寻找文件 (相加 (收藏夹目录, “\*.url”), ))
.判断循环首 (大于 (取文本长度 (URL名称), 0))
    赋值 (位置, 倒找文本 (URL名称, “\”, , 假))
    赋值 (URL名称, 取文本右边 (URL名称, 相减 (取文本长度 (URL名称), 位置)))
    赋值 (URL名称, 取文本左边 (URL名称, 相减 (取文本长度 (URL名称), 4)))
    URL名称.加入项目 ()
    赋值 (URL名称, 寻找文件 ())
.判断循环尾 ()

.子程序 _地址列表框_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 索引, 整数型, , , 

赋值 (索引, 相加 (取整 (相除 (纵向位置, 14)), 取顶端可见项目 ()))
赋值 (.现行选中项, 索引)

.子程序 _地址列表框_列表项被选择, 空白型, , 
.局部变量 文件名, 文本型, , , 
.局部变量 收藏夹目录, 文本型, , , 
.局部变量 地址, 文本型, , , 

赋值 (文件名, .取项目文本 (.现行选中项))
赋值 (收藏夹目录, 未知支持库函数_7 (#))
赋值 (文件名, 相加 (收藏夹目录, “\”, 文件名, “.url”))
赋值 (地址, 读配置项 (文件名, “InternetShortcut”, “URL”, ))
赋值 (_启动窗口.., 地址)
销毁 ()

.子程序 _收藏夹窗口_尺寸被改变, 空白型, , 
0.移动 (0, 相减 (收藏夹窗口.宽度, 5), 相减 (收藏夹窗口.高度, 30))

.窗口程序集 日积月累窗口程序集, , , 

.程序集变量 显示索引, 整数型, , , 
.程序集变量 是否显示日积月累, 逻辑型, , , 
.程序集变量 图片组, 字节集, , "0", 
.程序集变量 图片号, 整数型, , , 
.子程序 _关闭按钮_被单击, 空白型, , 
销毁 ()

.子程序 _上一贴按钮_被单击, 空白型, , 
赋值 (显示索引, 相减 (显示索引, 1))
.如果真 (小于 (显示索引, 1))
    赋值 (显示索引, 取数组成员数 (图片组))
.如果真结束
显示子程序 ()

.子程序 _日积月累窗口_创建完毕, 空白型, , 
赋值 (显示索引, 到数值 (读配置项 (相加 (工作路径, “\config.ini”), “日积月累”, “显示索引”, “1”)))
赋值 (.选中, 假)
加入成员 (图片组, #a1)
加入成员 (图片组, #a2)
加入成员 (图片组, #a3)
加入成员 (图片组, #a3)
加入成员 (图片组, #a4)
加入成员 (图片组, #a5)
加入成员 (图片组, #a6)
加入成员 (图片组, #a8)
加入成员 (图片组, #a7)
加入成员 (图片组, #a8)
加入成员 (图片组, #a9)
加入成员 (图片组, #a10)
加入成员 (图片组, #a11)
加入成员 (图片组, #a12)
赋值 (显示索引, 相加 (显示索引, 1))
.如果真 (大于 (显示索引, 取数组成员数 (图片组)))
    赋值 (显示索引, 1)
.如果真结束


.子程序 显示子程序, 空白型, , 
.局部变量 x1, 整数型, , , 
.局部变量 x2, 整数型, , , 
.局部变量 y1, 整数型, , , 
.局部变量 y2, 整数型, , , 
.局部变量 缩放比例, 小数型, , , 
.局部变量 画板宽度, 整数型, , , 
.局部变量 画板高度, 整数型, , , 
.局部变量 图片宽度, 整数型, , , 
.局部变量 图片高度, 整数型, , , 

赋值 (画板宽度, 相乘 (.宽度, 0.98))
赋值 (画板高度, 相乘 (.高度, 0.98))
.清除 ()
赋值 (图片号, 载入图片 (图片组 [显示索引]))
赋值 (图片宽度, 图片号.取图片宽度 ())
赋值 (图片高度, 图片号.取图片高度 ())
.判断开始 (并且 (大于 (画板宽度, 图片宽度), 大于 (画板高度, 图片高度))) ' 图片小
    赋值 (x1, 取整 (相除 (相减 (画板宽度, 图片宽度), 2)))
    赋值 (x2, 图片宽度)
    赋值 (y1, 取整 (相除 (相减 (画板高度, 图片高度), 2)))
    赋值 (y2, 图片高度)
.判断 (并且 (小于 (画板宽度, 图片宽度), 小于 (画板高度, 图片高度))) ' 图片大
    .如果 (大于 (相除 (相减 (图片宽度, 画板宽度), 画板宽度), 相除 (相减 (图片高度, 画板高度), 画板高度))) ' 图片窄
        赋值 (缩放比例, 相除 (画板宽度, 图片宽度))
    .否则
        赋值 (缩放比例, 相除 (画板高度, 图片高度))
    .如果结束
    赋值 (x1, 取整 (相除 (相减 (画板宽度, 相乘 (图片宽度, 缩放比例)), 2)))
    赋值 (x2, 取整 (相乘 (图片宽度, 缩放比例)))
    赋值 (y1, 取整 (相除 (相减 (画板高度, 相乘 (图片高度, 缩放比例)), 2)))
    赋值 (y2, 取整 (相乘 (图片高度, 缩放比例)))
.判断 (小于 (画板宽度, 图片宽度)) ' 图片宽
    赋值 (缩放比例, 相除 (画板宽度, 图片宽度))
    赋值 (x1, 0)
    赋值 (x2, 画板宽度)
    赋值 (y1, 取整 (相除 (相减 (画板高度, 相乘 (图片高度, 缩放比例)), 2)))
    赋值 (y2, 取整 (相乘 (图片高度, 缩放比例)))
.判断 (小于 (画板高度, 图片高度)) ' 图片高
    赋值 (缩放比例, 相除 (画板高度, 图片高度))
    赋值 (x1, 取整 (相除 (相减 (画板宽度, 相乘 (图片宽度, 缩放比例)), 2)))
    赋值 (x2, 取整 (相乘 (图片宽度, 缩放比例)))
    赋值 (y1, 0)
    赋值 (y2, 画板高度)
.默认
    
.判断结束

图片号.画图片 (x1, y1, x2, y2, )
卸载图片 (图片号)


.子程序 _日积月累窗口_将被销毁, 空白型, , 
.如果 (.选中)
    写配置项 (相加 (工作路径, “\config.ini”), “日积月累”, “是否显示日积月累”, “假”)
    赋值 (_启动窗口..选中, 假)
.否则
    写配置项 (相加 (工作路径, “\config.ini”), “日积月累”, “是否显示日积月累”, “真”)
.如果结束
写配置项 (相加 (工作路径, “\config.ini”), “日积月累”, “显示索引”, 到文本 (显示索引))


.子程序 _下一贴按钮_被单击, 空白型, , 
赋值 (显示索引, 相加 (显示索引, 1))
.如果真 (大于 (显示索引, 取数组成员数 (图片组)))
    赋值 (显示索引, 1)
.如果真结束
显示子程序 ()

.子程序 _日积月累窗口_首次激活, 空白型, , 
显示子程序 ()

.窗口程序集 成批导入磁盘文件窗口程序集, , , 

.程序集变量 选中目录索引, 整数型, , , 
.子程序 _成批导入磁盘文件窗口_创建完毕, 空白型, , 
.局部变量 计数器, 整数型, , , 
.局部变量 ID号, 文本型, , , 
.局部变量 驱动器名, 文本型, , , 

置当前库 (“zlk”)
排序 (“zlkid”, “z_id”, , 等于 (读 (“z_type”), “D”), “z_id”, “z_fid”, “z_type”, “z_caption”)
打开 (“zlkid”, , , , , , )
置当前库 (“zlkid”)
到首记录 ()
赋值 (计数器, 0)
赋值 (选中目录索引, 0)
.判断循环首 (等于 (尾记录后 (), 假))
    赋值 (ID号, 读 (“z_id”))
    .如果真 (等于 (读 (“z_type”), “D”))
        相加 (取重复文本 (相减 (取文本长度 (ID号), 2), “-”), 删尾空 (读 (“z_caption”))).加入项目 ()
        .如果真 (大于 (取文本长度 (当前选中项), 0))
            .如果真 (等于 (取文本左边 (ID号, 取文本长度 (当前选中项)), 当前选中项))
                赋值 (选中目录索引, 计数器)
            .如果真结束
            
        .如果真结束
        
    .如果真结束
    跳过 ()
    赋值 (计数器, 相加 (计数器, 1))
.判断循环尾 ()
赋值 (.现行选中项, 选中目录索引)
赋值 (.标题, 选中目录索引.取项目文本 ())
赋值 (驱动器名, 取驱动器名子程序 (初始目录1))
.如果真 (等于 (取文本长度 (驱动器名), 1))
    赋值 (.驱动器, 驱动器名)
.如果真结束
.如果真 (大于 (取文本长度 (初始目录1), 2))
    赋值 (.目录, 初始目录1)
.如果真结束
赋值 (.通配符, “*.txt;*.rtf;*.htm”)
赋值 (.目录, .目录)


.子程序 _驱动器框1_驱动器被改变, 空白型, , 
赋值 (.目录, 相加 (.驱动器, “:\”))

.子程序 _导入按钮_被单击, 空白型, , 
.局部变量 文件名称数组, 文本型, , "0", 
.局部变量 数组成员数, 整数型, , , 
.局部变量 计数器, 整数型, , , 
.局部变量 文件名, 文本型, , , 
.局部变量 扩展名部分, 文本型, , , 
.局部变量 ID号, 文本型, , , 
.局部变量 父ID号, 文本型, , , 
.局部变量 ID长度, 整数型, , , 
.局部变量 临时ID号, 文本型, , , 
.局部变量 名称部分, 文本型, , , 
.局部变量 资料, 字节集, , , 
.局部变量 目录名称, 文本型, , , 

赋值 (初始目录1, .目录)
取所有文件名到数组 (初始目录1, “*.txt,*.rtf,*.htm”, 文件名称数组, )

置当前库 (“zlkid”) ' 找出父id、和起始id号
跳到 (相加 (选中目录索引, 1))
赋值 (父ID号, 读 (“z_id”))
置当前库 (“zlk”)
到首记录 ()
赋值 (ID号, 相加 (父ID号, “00”))
赋值 (ID长度, 取文本长度 (ID号))
.判断循环首 (等于 (尾记录后 (), 假))
    赋值 (临时ID号, 读 (“z_id”))
    .如果真 (等于 (取文本长度 (临时ID号), ID长度))
        .如果真 (大于 (文本比较 (临时ID号, ID号, 真), 0))
            赋值 (ID号, 临时ID号)
        .如果真结束
        
    .如果真结束
    跳过 ()
.判断循环尾 ()
 ' 开始导入资料
赋值 (目录名称, 目录加反斜杠子程序 (初始目录1))
赋值 (数组成员数, 取数组成员数 (文件名称数组))
赋值 (计数器, 1)
.判断循环首 (小于或等于 (计数器, 数组成员数))
    赋值 (文件名, 文件名称数组 [计数器])
    赋值 (名称部分, 取名称部分子程序 (文件名))
    赋值 (扩展名部分, 取扩展名子程序 (文件名))
    赋值 (ID号, id加1 (ID号))
    赋值 (资料, 读入文件 (相加 (目录名称, 文件名)))
    .判断开始 (等于 (文本比较 (扩展名部分, “txt”, 假), 0))
        加记录 (ID号, 父ID号, “T”, 名称部分, 资料, , , )
    .判断 (等于 (文本比较 (扩展名部分, “rtf”, 假), 0))
        加记录 (ID号, 父ID号, “R”, 名称部分, 资料, , , )
    .判断 (等于 (文本比较 (扩展名部分, “ewd”, 假), 0))
        加记录 (ID号, 父ID号, “E”, 名称部分, 资料, 目录名称, 名称部分, )
    .默认
        
    .判断结束
    赋值 (计数器, 相加 (计数器, 1))
.判断循环尾 ()
刷新树型框 (ID号)
销毁 ()

.子程序 _目录框1_目录被改变, 空白型, , 
赋值 (.目录, .目录)

.子程序 _放弃按钮_被单击, 空白型, , 
销毁 ()

.子程序 _目录列表框1_列表项被选择, 空白型, , 
赋值 (.标题, .取项目文本 (.现行选中项))
赋值 (选中目录索引, .现行选中项)

.子程序 _成批导入磁盘文件窗口_将被销毁, 空白型, , 
关闭 (“zlkid”)

.程序集 公用程序集, , , 

.子程序 取文件名子程序, 文本型, , 
.参数 文件名1, 文本型, , 

.局部变量 属性1, 整数型, , , 

赋值 (文件名1, 删尾空 (删首空 (文件名1)))
.如果真 (等于 (取文本长度 (文件名1), 0))
    返回 (“”)
.如果真结束
赋值 (属性1, 取文件属性 (文件名1))
.如果真 (并且 (大于 (位与 (属性1, #子目录), 0), 大于 (属性1, 0)))
    返回 (“”)
.如果真结束
.如果 (大于 (寻找文本 (文件名1, “\”, , 假), 0))
    返回 (取文本右边 (文件名1, 相减 (取文本长度 (文件名1), 倒找文本 (文件名1, “\”, , 假))))
.否则
    返回 (文件名1)
.如果结束


.子程序 取名称部分子程序, 文本型, , 
.参数 文件名1, 文本型, , 

赋值 (文件名1, 删尾空 (删首空 (文件名1)))
.如果真 (等于 (取文本长度 (文件名1), 0))
    返回 (“”)
.如果真结束
赋值 (文件名1, 取文件名子程序 (文件名1))
.如果 (大于 (寻找文本 (文件名1, “.”, , 假), 0))
    返回 (取文本左边 (文件名1, 相减 (倒找文本 (文件名1, “.”, , 假), 1)))
.否则
    返回 (文件名1)
.如果结束


.子程序 取扩展名子程序, 文本型, , 
.参数 文件名1, 文本型, , 

.局部变量 扩展名1, 文本型, , , 

赋值 (文件名1, 删尾空 (删首空 (文件名1)))
.如果真 (等于 (取文本长度 (文件名1), 0))
    返回 (“”)
.如果真结束
赋值 (文件名1, 取文件名子程序 (文件名1))
.如果 (大于 (寻找文本 (文件名1, “.”, , 假), 0))
    赋值 (扩展名1, 取文本右边 (文件名1, 相减 (取文本长度 (文件名1), 倒找文本 (文件名1, “.”, , 假))))
.否则
    赋值 (扩展名1, “”)
.如果结束
.如果 (大于 (取文本长度 (扩展名1), 4))
    返回 (“”)
.否则
    返回 (扩展名1)
.如果结束


.子程序 取路径子程序, 文本型, , 
.参数 文件名1, 文本型, , 

.局部变量 属性1, 整数型, , , 

赋值 (文件名1, 删尾空 (删首空 (文件名1)))
.如果真 (等于 (取文本长度 (文件名1), 0))
    返回 (“”)
.如果真结束
赋值 (属性1, 取文件属性 (文件名1))
.如果真 (并且 (大于 (位与 (属性1, #子目录), 0), 大于 (属性1, 0)))
    返回 (文件名1)
.如果真结束

.如果 (大于 (寻找文本 (文件名1, “\”, , 假), 0))
    返回 (取文本左边 (文件名1, 相减 (倒找文本 (文件名1, “\”, , 假), 1)))
.否则
    返回 (“”)
.如果结束


.子程序 取驱动器名子程序, 文本型, , 
.参数 文件名1, 文本型, , 

.局部变量 驱动器1, 文本型, , , 

赋值 (文件名1, 删尾空 (删首空 (文件名1)))
.如果真 (等于 (取文本长度 (文件名1), 0))
    返回 (“”)
.如果真结束

.如果 (大于 (寻找文本 (文件名1, “:”, , 假), 0))
    赋值 (驱动器1, 取文本左边 (文件名1, 相减 (寻找文本 (文件名1, “:”, , 假), 1)))
    .如果 (等于 (取文本长度 (驱动器1), 0))
        返回 (“”)
    .否则
        返回 (驱动器1)
    .如果结束
    
.否则
    .如果 (文件是否存在 (文件名1))
        返回 (取驱动器名子程序 (取当前目录 ()))
    .否则
        返回 (“”)
    .如果结束
    
.如果结束


.子程序 取当前驱动器名, 文本型, , 
返回 (取驱动器名子程序 (取当前目录 ()))

.子程序 相对路径到绝对路径子程序, 文本型, , 
.参数 参考路径, 文本型, , 
.参数 相对路径, 文本型, , 
.参数 是否显示错误, 逻辑型, 可空, 



.子程序 绝对路径到相对路径子程序, 文本型, , 
.参数 参考路径, 空白型, , 
.参数 绝对路径, 空白型, , 
.参数 是否显示错误, 逻辑型, 可空, 



.子程序 目录加反斜杠子程序, 文本型, , 
.参数 目录1, 文本型, , 

赋值 (目录1, 删尾空 (删首空 (目录1)))
.如果真 (等于 (取文本长度 (目录1), 0))
    返回 (“”)
.如果真结束
返回 (选择 (等于 (取文本右边 (目录1, 1), “\”), 目录1, 相加 (目录1, “\”)))

.子程序 目录减反斜杠子程序, 文本型, , 
.参数 目录1, 文本型, , 

赋值 (目录1, 删尾空 (删首空 (目录1)))
.如果真 (等于 (取文本长度 (目录1), 0))
    返回 (“”)
.如果真结束
返回 (选择 (等于 (取文本右边 (目录1, 1), “\”), 取文本左边 (目录1, 相减 (取文本长度 (目录1), 1)), 目录1))

.子程序 取所有文件名到数组, 空白型, , 
.参数 目录1, 文本型, , 
.参数 查找文件名集合, 文本型, , 多文件名用“，”分隔。可用*?通配符
.参数 找到文件名数组, 文本型, 数组, 
.参数 文件属性1, 整数型, 可空, 与“寻找文件”的参数“文件属性”相同

.局部变量 文件名2, 文本型, , , 
.局部变量 查找文件名1, 文本型, , "1", 例如：“*.txt,*.rtf”;1-*.txt;2-*.rtf
.局部变量 查找文件名个数, 整数型, , , 
.局部变量 计数器, 整数型, , , 

赋值 (目录1, 删尾空 (删首空 (目录1)))
赋值 (目录1, 目录加反斜杠子程序 (目录1))
赋值 (查找文件名集合, 删尾空 (删首空 (查找文件名集合)))
赋值 (查找文件名1, 分割文本 (查找文件名集合, , ))
赋值 (查找文件名个数, 取数组成员数 (查找文件名1))

.如果真 (等于 (取文本长度 (目录1), 0))
    返回 ()
.如果真结束

赋值 (计数器, 1) ' 此处应该用“计数循环”因为“D”版问题，只能用“判断循环”
.判断循环首 (小于或等于 (计数器, 查找文件名个数))
    .如果真 (或者 (等于 (取文本长度 (查找文件名1 [计数器]), 0), 等于 (查找文件名1 [计数器], “.”)))
        返回 ()
    .如果真结束
     ' 取文件名
    .如果 (等于 (文件属性1, 0))
        赋值 (文件名2, 寻找文件 (相加 (目录1, 查找文件名1 [计数器]), ))
    .否则
        赋值 (文件名2, 寻找文件 (相加 (目录1, 查找文件名1 [计数器]), 文件属性1))
    .如果结束
    .判断循环首 (大于 (取文本长度 (文件名2), 0))
        .如果真 (取反 (并且 (等于 (文件属性1, #子目录), 等于 (取文本左边 (文件名2, 1), “.”))))
            加入成员 (找到文件名数组, 文件名2)
        .如果真结束
        .如果 (等于 (文件属性1, 0))
            赋值 (文件名2, 寻找文件 ())
        .否则
            赋值 (文件名2, 寻找文件 (文件属性1))
        .如果结束
        
    .判断循环尾 ()
    赋值 (计数器, 相加 (计数器, 1))
.判断循环尾 ()

.子程序 开头字符是否汉字子程序, 逻辑型, , 
.参数 文本, 文本型, , 

.局部变量 开头字符, 文本型, , , 

.如果真 (等于 (文本, “”))
    返回 (假)
.如果真结束
赋值 (开头字符, 取文本左边 (文本, 1))
.如果 (小于 (取代码 (开头字符, ), 0))
    返回 (真)
.否则
    返回 (假)
.如果结束



 ' 不属于任何一个程序集、类模块的函数：
