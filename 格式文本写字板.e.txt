 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 600
    高度 = 450
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 15197152 '  0xE7E3E0
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\格式文本写字板.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “ 工作日志 Version 2008.5”
    帮助文件名 = “”

窗口 查找窗口
    左边 = 50
    顶边 = 50
    宽度 = 330
    高度 = 141
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\格式文本写字板.e\查找窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库





.窗口程序集 窗口程序集1, , , 

.程序集变量 返回值, 整数型, , , 
.程序集变量 选择区段段落格式, 未知类型0x30005, , , 
.程序集变量 字体数组, 文本型, , "0", 
.程序集变量 计次变量, 整数型, , , 
.程序集变量 文件号, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
未知支持库函数_0 (1)
赋值 (.初始目录, 取运行目录 ())
赋值 (.通配符, “*.rtf”)
赋值 (文件号, 打开文件 (.被选择文件, , ))
赋值 (.内容, 到文本 (取日期 (取现行时间 ())))
赋值 (字体数组, 未知支持库函数_28 ())
.计次循环首 (取数组成员数 (字体数组), 计次变量)
    字体数组.加入项目 ( [计次变量], )
.计次循环尾 ()
赋值 (.现行选中项, 0)
赋值 (., 到整数 (到文本 (读配置项 (相加 (取运行目录 (), “\setup.ini”), “win”, “z”, ))))
赋值 (., 到整数 (到文本 (读配置项 (相加 (取运行目录 (), “\setup.ini”), “win”, “d”, ))))
赋值 (., 到整数 (到文本 (读配置项 (相加 (取运行目录 (), “\setup.ini”), “win”, “k”, ))))
赋值 (., 到整数 (到文本 (读配置项 (相加 (取运行目录 (), “\setup.ini”), “win”, “g”, ))))
赋值 (., 到整数 (到文本 (读配置项 (相加 (取运行目录 (), “\setup.ini”), “win”, “b”, ))))

.子程序 __启动窗口_尺寸被改变, 空白型, , 
赋值 (., 171)
赋值 (.顶边, 相减 (相除 (取用户区高度 (), 2), 10))
赋值 (.高度, .)
赋值 (., 420)
赋值 (.高度, 相减 (取用户区高度 (), 70))
赋值 (.宽度, 相减 (., 18))
赋值 (., 相减 (取用户区高度 (), 70))
赋值 (., 相减 (取用户区宽度 (), 181))
赋值 (.顶边, 相减 (取用户区高度 (), .高度))
赋值 (.宽度, 相减 (取用户区宽度 (), .宽度))
赋值 (.宽度, 相减 (取用户区宽度 (), .宽度))
赋值 (.左边, 相减 (取用户区宽度 (), .宽度))
赋值 (.高度, 相减 (取用户区高度 (), 30))
赋值 (.高度, 相减 (取用户区高度 (), 30))
赋值 (.左边, 相减 (取用户区宽度 (), .宽度))
赋值 (.顶边, 相减 (取用户区高度 (), .高度))
赋值 (.顶边, 相减 (取用户区高度 (), .高度))
赋值 (.左边, 相减 (取用户区宽度 (), 34))
赋值 (.左边, 相减 (取用户区宽度 (), 20))
赋值 (.左边, 相减 (取用户区宽度 (), 40))
赋值 (.左边, 相减 (取用户区宽度 (), 60))
赋值 (.宽度, 相减 (取用户区宽度 (), .宽度))
赋值 (.左边, .左边)
赋值 (.禁止, 取用户区宽度 ())
赋值 (.左边, 相减 (., 10))
.判断开始 (小于 (_启动窗口., 600))
    赋值 (_启动窗口., 600)
.默认
    
.判断结束
.判断开始 (小于 (_启动窗口., 450))
    赋值 (_启动窗口., 450)
.默认
    
.判断结束


.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.局部变量 文件号, 整数型, , , 
.局部变量 选择区段字符格式, 未知类型0x30004, , , 

赋值 (选择区段字符格式, 未知支持库函数_9 ())
.如果真 (等于 (按钮索引, 0))
    赋值 (., “”)
.如果真结束
.如果真 (等于 (按钮索引, 1))
    未知支持库函数_22 ()
.如果真结束
.如果真 (等于 (按钮索引, 2))
    _保存_被选择 ()
    赋值 (.通配符, “*.rtf”)
.如果真结束
.如果真 (等于 (按钮索引, 3))
    未知支持库函数_17 ()
.如果真结束
.如果真 (等于 (按钮索引, 4))
    未知支持库函数_18 ()
.如果真结束
.如果真 (等于 (按钮索引, 5))
    770.发送信息 (0, 0)
.如果真结束
.如果真 (等于 (按钮索引, 7))
    赋值 (选择区段段落格式., #)
    选择区段段落格式.未知支持库函数_12 ()
.如果真结束
.如果真 (等于 (按钮索引, 8))
    赋值 (选择区段段落格式., #)
    选择区段段落格式.未知支持库函数_12 ()
.如果真结束
.如果真 (等于 (按钮索引, 9))
    赋值 (选择区段段落格式., #)
    选择区段段落格式.未知支持库函数_12 ()
.如果真结束
.如果真 (等于 (按钮索引, 10))
    .如果 (等于 (按钮索引, 10))
        赋值 (选择区段字符格式., #粗体)
    .否则
        赋值 (选择区段字符格式., 位异或 (#粗体, #粗体))
    .如果结束
    选择区段字符格式.未知支持库函数_10 ()
.如果真结束
.如果真 (等于 (按钮索引, 11))
    .如果 (等于 (按钮索引, 11))
        赋值 (选择区段字符格式., #斜体)
    .否则
        赋值 (选择区段字符格式., 位异或 (#斜体, #斜体))
    .如果结束
    选择区段字符格式.未知支持库函数_10 ()
.如果真结束
.如果真 (等于 (按钮索引, 12))
    .如果 (等于 (按钮索引, 12))
        赋值 (选择区段字符格式., #下划线)
    .否则
        赋值 (选择区段字符格式., 位异或 (#下划线, #下划线))
    .如果结束
    选择区段字符格式.未知支持库函数_10 ()
.如果真结束
.如果真 (等于 (按钮索引, 13))
.如果真结束


.子程序 _文件框1_双击选择, 空白型, , 
赋值 (文件号, 打开文件 (.被选择文件, , ))
赋值 (., 读入文本 (文件号, ))
关闭文件 (文件号)

.子程序 _文件框1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (返回值, 信息框 (相加 (“   是否删除文档？”, #换行符, “按 ”, #左引号, “ 是 ”, #右引号, “ 钮,删除文档。”), 相加 (#是否钮, #信息图标), “删除文档”))
.如果真 (等于 (返回值, #是钮))
    赋值 (.系统, 真)
    赋值 (.通配符, “*.rtf”)
    删除文件 (.被选择文件)
.如果真结束
赋值 (.系统, 真)
赋值 (.通配符, “*.rtf”)

.子程序 _退出_被选择, 空白型, , 
是否保存 ()
结束 ()

.子程序 _文件另存_被选择, 空白型, , 
赋值 (.类型, 1)
赋值 (.过滤器, “日志文档(*.RTF)|*.RTF|”)
.如果真 (等于 (打开 (), 真))
    写到文件 (.文件名, 到字节集 (.))
    赋值 (.通配符, “*.rtf”)
.如果真结束


.子程序 _保存_被选择, 空白型, , 
写到文件 (相加 (取运行目录 (), “\”, 到文本 (取日期 (取现行时间 ())), 到文本 (取小时 (取现行时间 ())), “时”, 到文本 (取分钟 (取现行时间 ())), “分”, “.rtf”), 到字节集 (.))
信息框 (“文件保存完毕！”, 0, )
赋值 (.通配符, “*.rtf”)

.子程序 _透明标签1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

写配置项 (相加 (取运行目录 (), “\setup.ini”), “win”, “k”, 到文本 (.))
写配置项 (相加 (取运行目录 (), “\setup.ini”), “win”, “g”, 到文本 (.))
写配置项 (相加 (取运行目录 (), “\setup.ini”), “win”, “z”, 到文本 (.))
写配置项 (相加 (取运行目录 (), “\setup.ini”), “win”, “d”, 到文本 (.))
写配置项 (相加 (取运行目录 (), “\setup.ini”), “win”, “b”, 到文本 (.))
是否保存 ()
结束 ()

.子程序 是否保存, 逻辑型, , 
.局部变量 a, 整数型, , , 

.如果真 (等于 (198.发送信息 (0, 0), 1))
    赋值 (a, 信息框 (“文档已改变，是否要保存？”, #取消是否钮, ))
    .判断开始 (等于 (a, 5)) ' 要保存
        _文件另存_被选择 ()
    .判断 (等于 (a, 1)) ' 取消这次操作
        返回 (假)
    .默认
        
    .判断结束
    
.如果真结束
返回 (真)

.子程序 _透明标签2_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (., 0))
    发送信息 (274, 61503, 0)
    赋值 (_启动窗口., 0)
    赋值 (_启动窗口., 相减 (取用户区高度 (), 30))
.否则
    赋值 (., 0)
.如果结束


.子程序 _透明标签7_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

发送信息 (161, 2, 0)

.子程序 _透明标签7_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (., 0))
    发送信息 (274, 61503, 0)
    赋值 (_启动窗口., 0)
    赋值 (_启动窗口., 相减 (取用户区高度 (), 30))
.否则
    赋值 (., 0)
.如果结束


.子程序 _透明标签3_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 2)

.子程序 _复制_被选择, 空白型, , 
获取焦点 ()
未知支持库函数_17 ()

.子程序 _全选_被选择, 空白型, , 
获取焦点 ()
177.发送信息 (0, -1)

.子程序 _粘贴_被选择, 空白型, , 
获取焦点 ()
770.发送信息 (0, 0)

.子程序 _剪切_被选择, 空白型, , 
获取焦点 ()
未知支持库函数_1 (#Del键, , )

.子程序 _打开_被选择, 空白型, , 
.如果真 (打开 ())
    赋值 (文件号, 打开文件 (.文件名, , ))
    赋值 (., 读入文本 (文件号, ))
    关闭文件 (文件号)
.如果真结束


.子程序 _超级编辑框1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (未知支持库函数_14 (), 真))
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
.如果结束
.如果 (等于 (未知支持库函数_21 (), 真))
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
    5.加入状态 (4)
.如果结束
弹出菜单 ()

.子程序 _撤销_被选择, 空白型, , 
未知支持库函数_13 ()

.子程序 _删除_被选择, 空白型, , 
未知支持库函数_19 ()

.子程序 _选择框_加粗_被单击, 空白型, , 
.局部变量 选择区段字符格式, 未知类型0x30004, , , 

赋值 (选择区段字符格式, 未知支持库函数_9 ())
.如果 (等于 (., 真))
    赋值 (选择区段字符格式., #粗体)
.否则
    赋值 (选择区段字符格式., 位异或 (#粗体, #粗体))
.如果结束
选择区段字符格式.未知支持库函数_10 ()

.子程序 _选择框_斜体_被单击, 空白型, , 
.局部变量 选择区段字符格式, 未知类型0x30004, , , 

赋值 (选择区段字符格式, 未知支持库函数_9 ())
.如果 (等于 (., 真))
    赋值 (选择区段字符格式., #斜体)
.否则
    赋值 (选择区段字符格式., 位异或 (#斜体, #斜体))
.如果结束
选择区段字符格式.未知支持库函数_10 ()

.子程序 _选择框_下划线_被单击, 空白型, , 
.局部变量 选择区段字符格式, 未知类型0x30004, , , 

赋值 (选择区段字符格式, 未知支持库函数_9 ())
.如果 (等于 (., 真))
    赋值 (选择区段字符格式., #下划线)
.否则
    赋值 (选择区段字符格式., 位异或 (#下划线, #下划线))
.如果结束
选择区段字符格式.未知支持库函数_10 ()

.子程序 _组合框_字体_列表项被选择, 空白型, , 
.局部变量 选择区段字符格式, 未知类型0x30004, , , 

获取焦点 ()
赋值 (选择区段字符格式, 未知支持库函数_9 ())
赋值 (选择区段字符格式., .内容)
选择区段字符格式.未知支持库函数_10 ()

.子程序 _组合框_字号_列表项被选择, 空白型, , 
.局部变量 选择区段字符格式, 未知类型0x30004, , , 

获取焦点 ()
赋值 (选择区段字符格式, 未知支持库函数_9 ())
赋值 (选择区段字符格式., 到数值 (.内容))
选择区段字符格式.未知支持库函数_10 ()

.子程序 _颜色选择器_文本色_颜色被改变, 空白型, , 
.局部变量 选择区段字符格式, 未知类型0x30004, , , 

获取焦点 ()
赋值 (选择区段字符格式, 未知支持库函数_9 ())
赋值 (选择区段字符格式., .颜色)
选择区段字符格式.未知支持库函数_10 ()

.子程序 _透明标签_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (.内容, “<”))
    赋值 (., 10)
    赋值 (.左边, 2)
    赋值 (.内容, “>”)
    获取焦点 ()
    赋值 (.宽度, 相减 (., 18))
    赋值 (.左边, .左边)
    赋值 (., 相加 (相减 (取用户区宽度 (), 180), 160))
.否则
    赋值 (., 170)
    赋值 (.左边, 相减 (., 10))
    赋值 (., 相减 (取用户区宽度 (), 180))
    赋值 (.内容, “<”)
    获取焦点 ()
    赋值 (.宽度, 相减 (., 18))
    赋值 (.左边, .左边)
.如果结束


.子程序 _帮助按钮_被单击, 空白型, , 
信息框 (相加 (“            格式文本写字板 v2008.6”, #换行符, #换行符, “                程序设计：PANCG            ”, #换行符, #换行符, “          联系：PANCG@MSN.COM”), 0, “  关于”)

.子程序 _插入日期_被选择, 空白型, , 
177.发送信息 (0, -1)
769.发送信息 (0, 0)
770.发送信息 (0, 0)

.子程序 _标签6_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_启动窗口.发送信息 (274, 61442, 0) ' 按住模拟右边框的标签，窗口的右边会被拉动，窗口大小也会变化

.子程序 _标签8_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_启动窗口.发送信息 (274, 61448, 0) ' 按住模拟右下角的标签，窗口的右下角会被拉动，窗口大小也会变化

.子程序 _标签5_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_启动窗口.发送信息 (274, 61441, 0) ' 按住模拟左边框的标签，窗口的左边会被拉动，窗口大小也会变化

.子程序 _标签7_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_启动窗口.发送信息 (274, 61447, 0) ' 按住模拟左下角的标签，窗口的左下角会被拉动，窗口大小也会变化

.子程序 _标签1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_启动窗口.发送信息 (274, 61448, 0) ' 按住模拟右下角的标签，窗口的右下角会被拉动，窗口大小也会变化

.子程序 _标签3_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_启动窗口.发送信息 (274, 61443, 0) ' 按住模拟右下角的标签，窗口的右下角会被拉动，窗口大小也会变化

.子程序 _标签2_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_启动窗口.发送信息 (274, 61444, 0) ' 按住模拟右下角的标签，窗口的右下角会被拉动，窗口大小也会变化

.子程序 _标签4_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_启动窗口.发送信息 (274, 61445, 0) ' 按住模拟右下角的标签，窗口的右下角会被拉动，窗口大小也会变化

.子程序 _透明标签4_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

274.发送信息 (61441, 0)
赋值 (.高度, .)
赋值 (.左边, 相减 (., 10))
赋值 (.左边, .左边)
赋值 (.宽度, 相减 (., 18))
.如果 (小于或等于 (., 80))
    赋值 (., 10)
    赋值 (.左边, 2)
    赋值 (.内容, “>”)
    获取焦点 ()
    赋值 (.宽度, 相减 (., 18))
    赋值 (.左边, .左边)
    赋值 (., 相加 (相减 (取用户区宽度 (), 180), 160))
.否则
    赋值 (.内容, “<”)
.如果结束


.子程序 _内容查找_被选择, 空白型, , 
载入 (查找窗口, , 假)

.窗口程序集 窗口程序集2, , , 

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 前一位置, 整数型, 静态, , 

.如果 (等于 (前一位置, 0))
    赋值 (前一位置, _启动窗口.未知支持库函数_16 (., 0, 真, , .内容))
.否则
    赋值 (前一位置, _启动窗口.未知支持库函数_16 (., 相加 (前一位置, 取文本长度 (.内容)), , , .内容))
.如果结束
赋值 (_启动窗口.., 前一位置)
赋值 (_启动窗口.., 取文本长度 (.内容))
_启动窗口.获取焦点 (.)

.子程序 _输入编辑框_内容被改变, 空白型, , 
赋值 (.禁止, 假)

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _透明标签2_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_按钮2_被单击 ()

.子程序 _透明标签3_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

发送信息 (161, 2, 0)


 ' 不属于任何一个程序集、类模块的函数：
