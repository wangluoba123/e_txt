 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 554
    高度 = 374
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “dwg文档布局批量打印0.4版”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' edroptarget {9DA96BF9CEBD45c5BFCF94CBE61671F5} 1 0 拖放支持库
 ' shellEx DA19AC3ADD2F4121AAD84AC5FBCAFC71 2 0 扩展功能支持库一
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库





.窗口程序集 窗口程序集1, , , 

.程序集变量 文件名, 文本型, , "0", 
.子程序 _打开文件_被单击, 空白型, , 
.局部变量 循环, 整数型, , , 
.局部变量 选中项, 整数型, , , 

赋值 (文件名, 多文件对话框 (“打开dwg文件”, “*.dwg|*.dwg”, 0, , 真))
.计次循环首 (取数组成员数 (文件名), 循环)
    赋值 (选中项, 文件名.加入项目 ( [循环], ))
    选中项.选中项目 (真)
.计次循环尾 ()

.子程序 _拖放对象1_得到文件, 空白型, , 
.参数 接收到的文件路径, 文本型, , 

.局部变量 选中项, 整数型, , , 
.局部变量 循环, 整数型, , , 

赋值 (文件名, 分割文本 (接收到的文件路径, #换行符, ))
.计次循环首 (取数组成员数 (文件名), 循环)
    .如果真 (等于 (取文本右边 (文件名 [循环], 3), “dwg”))
        赋值 (选中项, 文件名.加入项目 ( [循环], ))
        选中项.选中项目 (真)
        
    .如果真结束
    
.计次循环尾 ()

 ' 选择列表框1.加入项目 (接收到的文件路径, )

.子程序 __启动窗口_创建完毕, 空白型, , 
未知支持库函数_11 (“*** AutoCAD SHELL 激活 ***”)
初始化 ()
取窗口句柄 ().未知支持库函数_0 ()
 ' 信息框 (CAD安装目录 (), 0, )

.子程序 初始化, 空白型, , 
.局部变量 循环, 整数型, , , 
.局部变量 默认, 整数型, , , 
.局部变量 打印样式, 变体型, , , 
.局部变量 打印机, 变体型, , , 
.局部变量 纸张类型, 变体型, , , 
.局部变量 数量, 整数型, , , 

清空 ()
清空 ()
清空 ()
.如果真 (CAD是否已运行 ())
    取dwg文档图纸空间 (-1).对象型方法 (“Layout”, ).方法 (“RefreshPlotDeviceInfo”, )
    赋值 (打印样式, 取dwg文档图纸空间 (-1).对象型方法 (“Layout”, ).通用方法 (“GetPlotStyleTableNames”, ))
    赋值 (打印机, 取dwg文档图纸空间 (-1).对象型方法 (“Layout”, ).通用方法 (“GetPlotDeviceNames”, ))
    取dwg文档图纸空间 (-1).对象型方法 (“Layout”, ).写属性 (“ConfigName”, .内容) ' 设置打印机
    赋值 (纸张类型, 取dwg文档图纸空间 (-1).对象型方法 (“Layout”, ).通用方法 (“GetCanonicalMediaNames”, )) ' 通用方法 (“GetCanonicalMediaNames”, )
    赋值 (数量, 打印样式.取数组成员数 ())
    .计次循环首 (数量, 循环)
        打印样式.取文本 (循环).加入项目 ()
    .计次循环尾 ()
    赋值 (数量, 打印机.取数组成员数 ())
    .计次循环首 (数量, 循环)
        打印机.取文本 (循环).加入项目 ()
    .计次循环尾 ()
    赋值 (数量, 纸张类型.取数组成员数 ())
    .如果 (不等于 (数量, 0))
        .计次循环首 (数量, 循环)
            纸张类型.取文本 (循环).加入项目 ()
            .如果真 (等于 (纸张类型.取文本 (循环), “A3”))
                赋值 (默认, 相减 (循环, 1))
            .如果真结束
            
        .计次循环尾 ()
        赋值 (.现行选中项, 默认)
    .否则
        
    .如果结束
    
.如果真结束



.子程序 _选择列表框1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

未知支持库函数_0 (取窗口句柄 (), .取项目文本 (.现行选中项), 假, 假)

.子程序 _开始打印_被单击, 空白型, , 
.局部变量 循环, 整数型, , , 
.局部变量 已打开文件数量, 整数型, , , 
.局部变量 文件, 文本型, , , 
.局部变量 布局数, 整数型, , , 
.局部变量 布局名, 文本型, , "0", 
.局部变量 布局循环, 整数型, , , 
.局部变量 布局, 文本型, , , 
.局部变量 左下, 变体型, , , 
.局部变量 右上, 变体型, , , 

.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“请进行设置打印”, 0, )
    返回 ()
    
.如果真结束
.如果真 (CAD是否已运行 ())
    赋值 (已打开文件数量, 取打开dwg文件数量 ())
    .计次循环首 (已打开文件数量, 循环)
         ' 置当前图形 ()
        .如果 (判断dwg文档是否保存 (相减 (循环, 1)))
            关闭指定dwg文件 (真, 相减 (循环, 1))
        .否则
            .判断开始 (等于 (信息框 (相加 (取dwg文档窗口的标题 (相减 (循环, 1)), “文件作了修改，是否保存修改？”), 相加 (#是否钮, #询问图标), “文件修改”), #是钮))
                关闭指定dwg文件 (真, 相减 (循环, 1))
            .默认
                关闭指定dwg文件 (假, 相减 (循环, 1))
            .判断结束
            
        .如果结束
        
    .计次循环尾 ()
    赋值 (已打开文件数量, 取项目数 ())
    .计次循环首 (已打开文件数量, 循环)
        .如果真 (相减 (循环, 1).是否被选中 ())
            赋值 (文件, 相减 (循环, 1).取项目文本 ())
            打开dwg文件 (文件, , )
            赋值 (布局数, 取dwg文档布局数 (-2))
            .计次循环首 (布局数, 布局循环)
                赋值 (布局, 取dwg文档布局名称 (-1, 相减 (布局循环, 1)))
                .如果真 (不等于 (布局, “Model”))
                    置dwg文档活动布局 (-1, 相减 (布局循环, 1))
                    取dwg文档图纸空间 (-1).对象型方法 (“Layout”, ).写属性 (“CanonicalMediaName”, .内容) ' 设置打印纸张类型
                    
                    取dwg文档图纸空间 (-1).对象型方法 (“Layout”, ).写属性 (“ShowPlotStyles”, 真) ' 打印中应用打印样式
                    取dwg文档图纸空间 (-1).对象型方法 (“Layout”, ).写属性 (“StyleSheet”, .内容) ' 写打印样式
                    取dwg文档图纸空间 (-1).对象型方法 (“Layout”, ).写属性 (“CenterPlot”, 真) ' 居中打印
                    .如果真 (.选中)
                        取dwg文档图纸空间 (-1).对象型方法 (“Layout”, ).写属性 (“PlotType”, 4)
                        
                        左下.创建数组 (5, 2)
                        右上.创建数组 (5, 2)
                        左下.赋值 (0, 1)
                        左下.赋值 (0, 2)
                        右上.赋值 (420, 1)
                        右上.赋值 (297, 2)
                        取dwg文档图纸空间 (-1).对象型方法 (“Layout”, ).方法 (“SetWindowToPlot”, 左下, 右上)
                        
                        
                    .如果真结束
                    .如果真 (.选中)
                        取dwg文档图纸空间 (-1).对象型方法 (“Layout”, ).写属性 (“PlotType”, 4)
                    .如果真结束
                    
                    
                    .如果真 (.选中)
                        dwg文档当前布局打印到设备 (-1, 到数值 (.内容), .内容) ' 打印
                    .如果真结束
                    .如果真 (.选中)
                        dwg文档当前布局打印预览 (-1, 1) ' 打印预览
                    .如果真结束
                    
                .如果真结束
                
            .计次循环尾 ()
             ' dwg文档布局打印到设备 (-1, 布局名, 1, )
            关闭指定dwg文件 (假, -1)
        .如果真结束
        
    .计次循环尾 ()
    
.如果真结束


.子程序 _退出_被单击, 空白型, , 
结束 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 d, 变体型, , , 
.局部变量 a, 变体型, , , 
.局部变量 dx, 对象, , , 
.局部变量 选择集, 对象, , , 

.如果真 (CAD是否已运行 ())
    赋值 (选择集, 取图形 (-1).读对象型属性 (“SelectionSets”, ).对象型方法 (“Add”, “thhhh”))
    
    选择集.方法 (“Select”, 0, a, d, )
    输出调试文本 (a.取数组成员数 ())
.如果真结束


.子程序 CAD安装目录, 文本型, , 
.局部变量 注册项, 文本型, , , 
.局部变量 路径, 文本型, , , 

赋值 (注册项, 子文本替换 (取文本注册项 (#根类, “Applications\acad.exe\shell\open\command\”, ), #引号, “”, , , 真))
赋值 (路径, 取文本左边 (注册项, 倒找文本 (注册项, “\”, , 假)))

返回 (路径)

.子程序 _打印机组合框_列表项被选择, 空白型, , 
.局部变量 循环, 整数型, , , 
.局部变量 默认, 整数型, , , 
.局部变量 纸张类型, 变体型, , , 
.局部变量 数量, 整数型, , , 

清空 ()
.如果真 (CAD是否已运行 ())
    取dwg文档图纸空间 (-1).对象型方法 (“Layout”, ).写属性 (“ConfigName”, .内容) ' 设置打印机
    赋值 (纸张类型, 取dwg文档图纸空间 (-1).对象型方法 (“Layout”, ).通用方法 (“GetCanonicalMediaNames”, )) ' 通用方法 (“GetCanonicalMediaNames”, )
    赋值 (数量, 纸张类型.取数组成员数 ())
    .计次循环首 (数量, 循环)
        纸张类型.取文本 (循环).加入项目 ()
        .如果真 (等于 (纸张类型.取文本 (循环), “A3”))
            赋值 (默认, 相减 (循环, 1))
        .如果真结束
        
    .计次循环尾 ()
    赋值 (.现行选中项, 默认)
    
.如果真结束


.子程序 _图形按钮1_被单击, 空白型, , 
.局部变量 LowerLeft, 变体型, , , 
.局部变量 UpperRight, 变体型, , , 
.局部变量 dx, 对象, , , 
.局部变量 左下, 变体型, , , 
.局部变量 右上, 变体型, , , 


 ' 取dwg文档图纸空间 (-1).对象型方法 (“Layout”, ).方法 (“GetWindowToPlot”, LowerLeft, UpperRight)
 ' 输出调试文本 (LowerLeft.取数组成员数 ())
 ' 输出调试文本 (LowerLeft.取文本 (1))
 ' 输出调试文本 (LowerLeft.取文本 (2))
左下.创建数组 (5, 2)
右上.创建数组 (5, 2)
左下.赋值 (0, 1)
左下.赋值 (0, 2)
右上.赋值 (420, 1)
右上.赋值 (297, 2)
 ' 方法 （"SetWindowToPlot"，LowerLeft，UpperRight）
取dwg文档图纸空间 (-1).对象型方法 (“Layout”, ).方法 (“SetWindowToPlot”, 左下, 右上)
取dwg文档图纸空间 (-1).对象型方法 (“Layout”, ).方法 (“GetWindowToPlot”, LowerLeft, UpperRight)
输出调试文本 (LowerLeft.取数组成员数 ())
输出调试文本 (LowerLeft.取文本 (1))
输出调试文本 (LowerLeft.取文本 (2))
输出调试文本 (UpperRight.取文本 (1))
输出调试文本 (UpperRight.取文本 (2))


.子程序 _窗选范围_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

未知支持库函数_0 (取窗口句柄 (), “默认左下角为0,0点”, 假, 真)

.子程序 _显示范围_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

未知支持库函数_0 (取窗口句柄 (), “布局中显示的结果！”, 假, 真)

.程序集 功能, , , 

.程序集变量 CAD, 对象, , , 
.子程序 CAD是否已运行, 逻辑型, 公开, 
.如果 (CAD.获取 (“Autocad.Application”))
    返回 (真)
.否则
    返回 (假)
.如果结束


.子程序 CAD创建, 逻辑型, 公开, 
.如果 (CAD.创建 (“Autocad.Application”, ))
    CAD.写属性 (“Visible”, 真)
    返回 (真)
.否则
    返回 (假)
    
.如果结束


.子程序 CAD程序, 对象, 公开, 
.如果 (CAD是否已运行 ())
    返回 (CAD)
.否则
    .如果 (CAD创建 ())
        返回 (CAD)
    .否则
        信息框 (“你没有安装AUTOCAD程序，请安装完后再运行本程序”, 0, )
        结束 ()
        返回 (CAD)
    .如果结束
    
.如果结束


.子程序 新建dwg文件, 空白型, , 
CAD.读对象型属性 (“Documents”, ).对象型方法 (“add”, )


.子程序 打开dwg文件, 空白型, 公开, 
.参数 dwg文件名, 文本型, , 完整路径
.参数 只读, 逻辑型, 可空, 
.参数 密码, 文本型, 可空, 

CAD.读对象型属性 (“Documents”, ).对象型方法 (“Open”, dwg文件名, 只读, 密码)

.子程序 关闭全部dwg文件, 空白型, 公开, 本方法会关闭前文件保存修改的文件
CAD.读对象型属性 (“Documents”, ).对象型方法 (“close”, )

.子程序 关闭当前dwg文件, 空白型, 公开, 
.参数 保存, 逻辑型, , 当前关闭前文档是否保存

CAD.读对象型属性 (“ActiveDocument”, ).对象型方法 (“close”, 保存)


.子程序 取图形, 对象, , 根据索引取已打开图形对象,索引小于0时为当前图形
.参数 索引, 整数型, , 根据打开文件的的先后从零开始

.如果 (小于 (索引, 0))
    返回 (CAD.读对象型属性 (“ActiveDocument”, ))
.否则
    返回 (CAD.读对象型属性 (“Documents”, ).对象型方法 (“Item”, 索引))
.如果结束



.子程序 关闭指定dwg文件, 空白型, 公开, 索引小于0时为当前图形
.参数 保存, 逻辑型, , 当前关闭前文档是否保存
.参数 索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始

取图形 (索引).对象型方法 (“close”, 保存)

.子程序 取打开dwg文件数量, 整数型, 公开, 
返回 (CAD.读对象型属性 (“Documents”, ).读数值属性 (“Count”, ))


.子程序 置当前图形, 空白型, 公开, 索引小于0时为当前图形
.参数 索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始

取图形 (索引).方法 (“Activate”, )

.子程序 向图形文件发送命令, 空白型, 公开, 索引小于0时为当前图形
.参数 索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始
.参数 命令, 文本型, , 要发送的命令

取图形 (索引).方法 (“SendCommand”, 命令)

.子程序 置dwg文档窗口状态, 空白型, 公开, 索引小于0时为当前图形
.参数 索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始
.参数 文档窗口状态, 整数型, , 1、正常； 2、最小化； 3、最大化

取图形 (索引).写属性 (“WindowState”, 文档窗口状态)


.子程序 取dwg文档窗口状态, 整数型, 公开, 索引小于0时为当前图形；1、正常； 2、最小化； 3、最大化
.参数 索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始

返回 (取图形 (索引).读属性 (“WindowState”, ))

.子程序 判断dwg文档活动状态, 逻辑型, 公开, 索引小于0时为当前图形
.参数 索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始

返回 (取图形 (索引).读逻辑属性 (“Active”, ))

.子程序 判断dwg文档只度状态, 逻辑型, 公开, 索引小于0时为当前图形
.参数 索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始

返回 (取图形 (索引).读逻辑属性 (“ReadOnly”, ))

.子程序 判断dwg文档是否保存, 逻辑型, 公开, 索引小于0时为当前图形
.参数 索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始

返回 (取图形 (索引).读逻辑属性 (“Saved”, ))

.子程序 取dwg文档完整名称和路径, 文本型, 公开, 索引小于0时为当前图形
.参数 索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始

返回 (取图形 (索引).读逻辑属性 (“FullName”, ))

.子程序 保存dwg文档, 空白型, 公开, 索引小于0时为当前图形
.参数 索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始

取图形 (索引).方法 (“Save”, )

.子程序 置当前活动空间, 空白型, 公开, 索引小于0时为当前图形
.参数 索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始
.参数 活动空间, 整数型, , 0、图纸空间；1、模型空间

取图形 (索引).写属性 (“ActiveSpace”, 活动空间)

.子程序 取dwg文档当前活动空间, 整数型, 公开, 索引小于0时为当前图形；0、图纸空间，1、模型空间
.参数 索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始

返回 (取图形 (索引).读属性 (“ActiveSpace”, ))

.子程序 取dwg文档模型空间, 对象, , 索引小于0时为当前图形
.参数 索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始

返回 (取图形 (索引).读对象型属性 (“ModelSpace”, ))


.子程序 取dwg文档图纸空间, 对象, , 索引小于0时为当前图形
.参数 索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始

返回 (取图形 (索引).读对象型属性 (“PaperSpace”, ))

.子程序 取dwg文档窗口的标题, 文本型, 公开, 索引小于0时为当前图形
.参数 索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始

返回 (取图形 (索引).读文本属性 (“WindowTitle”, ))


.子程序 取dwg文档布局, 对象, , 返回布局对象；文档索引小于0时为当前图形
.参数 文档索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始
.参数 布局索引, 整数型, , 

返回 (取图形 (文档索引).读对象型属性 (“Layouts”, ).对象型方法 (“Item”, 布局索引))

.子程序 取dwg文档布局数, 整数型, 公开, 包含模型空间；文档索引小于0时为当前图形
.参数 文档索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始

返回 (取图形 (文档索引).读对象型属性 (“Layouts”, ).读数值属性 (“Count”, ))


.子程序 取dwg文档布局名称, 文本型, 公开, 文档索引小于0时为当前图形
.参数 文档索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始
.参数 布局索引, 整数型, , 

返回 (取dwg文档布局 (文档索引, 布局索引).读文本属性 (“Name”, ))

.子程序 取dwg文档活动布局, 对象, 公开, 文档索引小于0时为当前图形
.参数 索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始

返回 (取图形 (索引).读对象型属性 (“ActiveLayout”, ))

.子程序 置dwg文档活动布局, 空白型, 公开, 文档索引小于0时为当前图形
.参数 文档索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始
.参数 布局索引, 整数型, , 

取图形 (文档索引).写属性 (“ActiveLayout”, 取dwg文档布局 (文档索引, 布局索引))

.子程序 取dwg文档路径, 文本型, 公开, 文档索引小于0时为当前图形
.参数 索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始

返回 (取图形 (索引).读文本属性 (“Path”, ))



.子程序 dwg文档当前布局打印到设备, 逻辑型, 公开, 打印成功返回真,否则假；文档索引小于0时为当前图形
.参数 文档索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始
.参数 打印分数, 整数型, , 
.参数 打印设备, 文本型, 可空, 空为默认打印机名

取图形 (文档索引).读对象型属性 (“Plot”, ).写属性 (“NumberOfCopies”, 打印分数)
返回 (取图形 (文档索引).读对象型属性 (“Plot”, ).逻辑方法 (“PlotToDevice”, ))
 ' 取图形 (文档索引).读对象型属性 (“Plot”, ).逻辑方法 (“PlotToDevice”, )


.子程序 dwg文档布局打印到设备, 逻辑型, 公开, 打印成功返回真,否则假；文档索引小于0时为当前图形
.参数 文档索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始
.参数 打印布局, 文本型, 数组, 要打印布局名称
.参数 打印分数, 整数型, , 
.参数 打印设备, 文本型, 可空, 空为默认打印机名

取图形 (文档索引).读对象型属性 (“Plot”, ).方法 (“SetLayoutsToPlot”, 打印布局)
取图形 (文档索引).读对象型属性 (“Plot”, ).写属性 (“NumberOfCopies”, 打印分数)
返回 (取图形 (文档索引).读对象型属性 (“Plot”, ).逻辑方法 (“PlotToDevice”, ))

.子程序 dwg文档当前布局打印预览, 空白型, 公开, 文档索引小于0时为当前图形；文档索引小于0时为当前图形
.参数 文档索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始
.参数 预览方式, 整数型, , 0、局部预览；1、全部预览

取图形 (文档索引).读对象型属性 (“Plot”, ).方法 (“DisplayPlotPreview”, 预览方式)


.子程序 退出CAD, 空白型, 公开, 
CAD.方法 (“Quit”, )
CAD.清除 ()

.子程序 取dwg文档图层数, 整数型, 公开, 文档索引小于0时为当前图形
.参数 文档索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始

返回 (取图形 (文档索引).读对象型属性 (“Layers”, ).读数值属性 (“Count”, ))


.子程序 取dwg文档图层, 对象, 公开, 文档索引小于0时为当前图形
.参数 文档索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始
.参数 图层索引, 整数型, , 

返回 (取图形 (文档索引).读对象型属性 (“Layers”, ).对象型方法 (“Item”, 图层索引))


.子程序 取dwg文档图层冻结状态, 逻辑型, 公开, 文档索引小于0时为当前图形
.参数 文档索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始
.参数 图层索引, 整数型, , 

返回 (取dwg文档图层 (文档索引, 图层索引).读逻辑属性 (“Freeze”, ))

.子程序 置dwg文档图层冻结状态, 空白型, 公开, 文档索引小于0时为当前图形
.参数 文档索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始
.参数 图层索引, 整数型, , 
.参数 冻结状态, 逻辑型, , 

取dwg文档图层 (文档索引, 图层索引).写属性 (“Freeze”, 冻结状态)


.子程序 取dwg文档图层开关状态, 逻辑型, 公开, 文档索引小于0时为当前图形
.参数 文档索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始
.参数 图层索引, 整数型, , 

返回 (取dwg文档图层 (文档索引, 图层索引).读逻辑属性 (“LayerOn”, ))

.子程序 置dwg文档图层开关状态, 空白型, 公开, 文档索引小于0时为当前图形
.参数 文档索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始
.参数 图层索引, 整数型, , 
.参数 开关状态, 逻辑型, , 

取dwg文档图层 (文档索引, 图层索引).写属性 (“LayerOn”, 开关状态)


.子程序 取dwg文档图层锁定状态, 逻辑型, 公开, 文档索引小于0时为当前图形
.参数 文档索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始
.参数 图层索引, 整数型, , 

返回 (取dwg文档图层 (文档索引, 图层索引).读逻辑属性 (“Lock”, ))

.子程序 置dwg文档图层锁定状态, 空白型, 公开, 文档索引小于0时为当前图形
.参数 文档索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始
.参数 图层索引, 整数型, , 
.参数 锁定状态, 逻辑型, , 

取dwg文档图层 (文档索引, 图层索引).写属性 (“Lock”, 锁定状态)


.子程序 取dwg文档图层打印状态, 逻辑型, 公开, 文档索引小于0时为当前图形
.参数 文档索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始
.参数 图层索引, 整数型, , 

返回 (取dwg文档图层 (文档索引, 图层索引).读逻辑属性 (“Plottable”, ))

.子程序 置dwg文档图层打印状态, 空白型, 公开, 文档索引小于0时为当前图形
.参数 文档索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始
.参数 图层索引, 整数型, , 
.参数 打印状态, 逻辑型, , 

取dwg文档图层 (文档索引, 图层索引).写属性 (“Plottable”, 打印状态)


.子程序 取dwg文档图层名称, 文本型, 公开, 文档索引小于0时为当前图形
.参数 文档索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始
.参数 图层索引, 整数型, , 

返回 (取dwg文档图层 (文档索引, 图层索引).读逻辑属性 (“Name”, ))

.子程序 置dwg文档图层名称, 空白型, 公开, 文档索引小于0时为当前图形
.参数 文档索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始
.参数 图层索引, 整数型, , 
.参数 图层名称, 文本型, , 

取dwg文档图层 (文档索引, 图层索引).写属性 (“Name”, 图层名称)


.子程序 取dwg文档活动图层, 对象, 公开, 文档索引小于0时为当前图形
.参数 文档索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始

返回 (取图形 (文档索引).读对象型属性 (“ActiveLayer”, ))

.子程序 置dwg文档活动图层, 空白型, 公开, 文档索引小于0时为当前图形
.参数 文档索引, 整数型, , 已打开文件的索引，根据打开文件的先后从零开始
.参数 图层索引, 整数型, , 

取图形 (文档索引).写属性 (“ActiveLayer”, 取dwg文档图层 (文档索引, 图层索引))

.子程序 CAD对象清除, 空白型, , 
CAD.清除 ()

.子程序 选择文字, 对象, , 
.局部变量 选择集, 对象, , , 
.局部变量 选择集数量, 整数型, , , 
.局部变量 是否还有其他图元, 逻辑型, , , 
.局部变量 循环, 整数型, , , 
.局部变量 图元, 对象, , , 

赋值 (选择集, CAD.读对象型属性 (“ActiveDocument”, ).读对象型属性 (“SelectionSets”, ).对象型方法 (“Add”, “thhhh”))
 ' 选择集.方法 (“Delete”, )
 ' 返回 ()
选择集.方法 (“SelectOnScreen”, )
赋值 (选择集数量, 选择集.读数值属性 (“Count”, ))
赋值 (是否还有其他图元, 真)
.判断循环首 (等于 (是否还有其他图元, 真))
    .计次循环首 (选择集数量, 循环)
        赋值 (图元, 选择集.对象型方法 (“Item”, 相减 (循环, 1)))
        输出调试文本 (选择集数量)
        .如果 (不等于 (图元.读文本属性 (“ObjectName”, ), “AcDbText”))
            选择集.方法 (“RemoveItems”, 图元)
            赋值 (选择集数量, 选择集.读数值属性 (“Count”, ))
            赋值 (是否还有其他图元, 真)
            跳出循环 ()
        .否则
            赋值 (是否还有其他图元, 假)
        .如果结束
        
    .计次循环尾 ()
.判断循环尾 ()
赋值 (图元, 选择集)
选择集.方法 (“Delete”, )
返回 (图元)


 ' 不属于任何一个程序集、类模块的函数：
