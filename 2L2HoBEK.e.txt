 ' 文件类型：Windows模块源码

 ' 程序名称：取驱动器列表
 ' 程序描述：2007年12月21日
 ' 程序作者：吕志杰
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库





.DLL命令 GetLogicalDriveStrings, 整数型, "kernel32.dll", "GetLogicalDriveStringsA", , 
    .参数 nBufferLength, 整数型, , 
    .参数 lpBuffer, 字节集, ,   

.DLL命令 GetDriveTypeA, 整数型, "kernel32", "GetDriveTypeA", , 
    .参数 路径, 文本型, , 

.窗口程序集 窗口程序集1, , , 

.子程序 _启动子程序, 整数型, , 
返回 (0)

.子程序 取驱动器列表, 整数型, 公开, 返回驱动器数量
.参数 保存驱动器列表, 文本型, 数组, 
.参数 类型, 空白型, 可空, 默认为1,1.硬盘驱动器；2、.光盘驱动器；3、可移动驱动器；4、网络驱动器。

.局部变量 所有盘符, 字节集, , , 
.局部变量 盘符, 字节集, , "0", 
.局部变量 返回值, 整数型, , , 
.局部变量 计次变量, 整数型, , , 
.局部变量 移动盘, 文本型, , "0", 
.局部变量 硬盘, 文本型, , "0", 
.局部变量 光盘, 文本型, , "0", 
.局部变量 其他, 文本型, , "0", 

赋值 (所有盘符, 取空白字节集 (256))
赋值 (返回值, GetLogicalDriveStrings (256, 所有盘符))
赋值 (所有盘符, 取字节集左边 (所有盘符, 返回值))
赋值 (盘符, 分割字节集 (所有盘符, { 0 }, ))
.计次循环首 (取数组成员数 (盘符), 计次变量)
    .判断开始 (等于 (GetDriveTypeA (到文本 (盘符 [计次变量])), 2)) ' 2=移动驱动器
        加入成员 (移动盘, 到文本 (盘符 [计次变量]))
    .判断 (等于 (GetDriveTypeA (到文本 (盘符 [计次变量])), 3)) ' ３＝硬盘
        加入成员 (硬盘, 到文本 (盘符 [计次变量]))
    .判断 (等于 (GetDriveTypeA (到文本 (盘符 [计次变量])), 5)) ' ５＝光盘
        加入成员 (光盘, 到文本 (盘符 [计次变量]))
    .默认
        加入成员 (其他, 到文本 (盘符 [计次变量])) ' 其他
    .判断结束
    
.计次循环尾 ()
.判断开始 (或者 (等于 (类型, 0), 等于 (类型, 1)))
    赋值 (保存驱动器列表, 硬盘)
.判断 (等于 (类型, 2))
    赋值 (保存驱动器列表, 光盘)
.判断 (等于 (类型, 3))
    赋值 (保存驱动器列表, 移动盘)
.默认
    赋值 (保存驱动器列表, 其他)
.判断结束

返回 (取数组成员数 (保存驱动器列表))


 ' 不属于任何一个程序集、类模块的函数：
