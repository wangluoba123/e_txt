 ' 文件类型：Windows窗口程序

 ' 程序名称：排课助手 V1.0
 ' 程序描述：本软件使用《易语言》编写。
 ' 程序作者：思娇蛮冶
 ' 邮政编码：414202
 ' 联系地址：中国
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：tashihake@163.com
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 0
    顶边 = 20
    宽度 = 610
    高度 = 391
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “排课助手 V0.1”
    帮助文件名 = “”

窗口 启动图片窗口
    左边 = 50
    顶边 = 50
    宽度 = 372
    高度 = 321
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 0
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 2
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\排课软件0.1.e\启动图片窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 排课向导窗口
    左边 = 50
    顶边 = 50
    宽度 = 560
    高度 = 394
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “排课向导”
    帮助文件名 = “”

窗口 总课表窗口
    左边 = 50
    顶边 = 50
    宽度 = 542
    高度 = 368
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “总课表”
    帮助文件名 = “”

窗口 系统设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 314
    高度 = 209
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “系统设置”
    帮助文件名 = “”

窗口 分课表窗口
    左边 = 50
    顶边 = 50
    宽度 = 552
    高度 = 394
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “教师分课表”
    帮助文件名 = “”



.常量 程序信息, "“排课助手 V0.1演示版”", , 
.常量 作者信息, "“        思娇屠虎         (王进)
QQ:84651849 E-mail:tashihake@163.com”", , 
.常量 课程提示, "“”", , 
.图片 图片1, " ' 已保存到：D:\易语言学习\Data\排课软件0.1.e\图片1", , 
.图片 表头, " ' 已保存到：D:\易语言学习\Data\排课软件0.1.e\表头", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 1 3 高级表格支持库
 ' eDB 46E94341933A462383A4DE26B146322C 1 4 数据库操作支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库




.全局变量 功能变量, 逻辑型, , "5", 实现一些特殊事件
.全局变量 总课表信息, 逻辑型, , , 
.全局变量 分课表信息, 逻辑型, , , 
.全局变量 学校全称, 文本型, , , 
.全局变量 教师姓名, 文本型, , "40", 记录教师姓名
.全局变量 个人课程, 文本型, , "40,30,6,10", 人、节次、年级、班级;最多可记录40人，每人30节次
.全局变量 位置课程, 文本型, , "6,10,40,40", 年级，班级，列，人

.DLL命令 调用系统关于窗口, 整数型, "shell32.dll", "ShellAboutA", , 调用关于窗口
    .参数 窗口句柄, 整数型, , 
    .参数 窗口标题, 文本型, , 
    .参数 说明, 文本型, , 
    .参数 图标句柄, 整数型, , 

.窗口程序集 主程序集, , , 思娇屠虎　制作，QQ：84651849 E-mail:tashihake@163.com

.程序集变量 功能变量计时, 整数型, , "5", 实现一些特殊事件
.子程序 __启动窗口_创建完毕, 空白型, , 
_启动窗口.移动 (0, 0, 1024, 738)
赋值 (_启动窗口., 假)
载入 (启动图片窗口, , 假)
赋值 (.时钟周期, 500)
赋值 (功能变量 [1], 真) ' 延时处理

 ' 读入一些设置。
.如果真 (不等于 (读配置项 (相加 (取运行目录 (), “\PKZSxtpz.ini”), “SYSTEM”, “XSFS”, ), “”)) ' 设置图片框显示方式
    赋值 (.显示方式, 相减 (到整数 (读配置项 (相加 (取运行目录 (), “\PKZSxtpz.ini”), “SYSTEM”, “XSFS”, )), 1))
.如果真结束
.如果 (不等于 (读配置项 (相加 (取运行目录 (), “\PKZSxtpz.ini”), “SYSTEM”, “BJYY”, ), “”)) ' 读入设置的图片
    赋值 (.图片, 读入字节集 (打开文件 (读配置项 (相加 (取运行目录 (), “\PKZSxtpz.ini”), “SYSTEM”, “BJYY”, ), , ), 取文件长度 (打开文件 (读配置项 (相加 (取运行目录 (), “\PKZSxtpz.ini”), “SYSTEM”, “BJYY”, ), , ))))
.否则
    赋值 (.显示方式, 1)
    赋值 (.图片, #图片1)
.如果结束
.如果真 (并且 (不等于 (读配置项 (相加 (取运行目录 (), “\PKZSxtpz.ini”), “SYSTEM”, “XTYY”, ), “”), 等于 (读配置项 (相加 (取运行目录 (), “\PKZSxtpz.ini”), “SYSTEM”, “Player”, ), “1”)))
    赋值 (.选中, 真)
    播放MP3 (-1, 读配置项 (相加 (取运行目录 (), “\PKZSxtpz.ini”), “SYSTEM”, “XTYY”, ))
.如果真结束
赋值 (_启动窗口., #程序信息)
4.置文本 (#程序信息)

.子程序 __启动窗口_尺寸被改变, 空白型, , 
5.移动 (60, 相减 (_启动窗口., 20), 相减 (_启动窗口., 140))
4.置宽度 (相减 (_启动窗口., 530))

.子程序 __启动窗口_获得焦点, 空白型, , 
.如果真 (并且 (等于 (_启动窗口., 0), 等于 (总课表信息, 真)))
    总课表窗口.调整层次 (#顶层)
.如果真结束
.如果真 (并且 (等于 (_启动窗口., 1), 等于 (总课表信息, 真)))
    总课表窗口.调整层次 (#顶层)
.如果真结束
.如果真 (并且 (等于 (_启动窗口., 3), 等于 (总课表信息, 真)))
    总课表窗口.调整层次 (#顶层)
.如果真结束
.如果真 (并且 (等于 (_启动窗口., 0), 等于 (分课表信息, 真)))
    分课表窗口.调整层次 (#顶层)
.如果真结束
.如果真 (并且 (等于 (_启动窗口., 1), 等于 (分课表信息, 真)))
    分课表窗口.调整层次 (#顶层)
.如果真结束
.如果真 (并且 (等于 (_启动窗口., 3), 等于 (分课表信息, 真)))
    分课表窗口.调整层次 (#顶层)
.如果真结束


.子程序 __启动窗口_位置被改变, 空白型, , 
.如果真 (并且 (等于 (_启动窗口., 2), 等于 (总课表信息, 真)))
    赋值 (总课表窗口., 假)
.如果真结束
.如果真 (并且 (等于 (_启动窗口., 0), 等于 (总课表信息, 真)))
    赋值 (总课表窗口., 真)
    总课表窗口.获取焦点 ()
.如果真结束
.如果真 (并且 (等于 (_启动窗口., 1), 等于 (总课表信息, 真)))
    赋值 (总课表窗口., 真)
    总课表窗口.获取焦点 ()
.如果真结束
.如果真 (并且 (等于 (_启动窗口., 3), 等于 (总课表信息, 真)))
    赋值 (总课表窗口., 真)
    总课表窗口.获取焦点 ()
.如果真结束
.如果真 (并且 (等于 (_启动窗口., 2), 等于 (分课表信息, 真)))
    赋值 (分课表窗口., 假)
.如果真结束
.如果真 (并且 (等于 (_启动窗口., 0), 等于 (分课表信息, 真)))
    赋值 (分课表窗口., 真)
    分课表窗口.获取焦点 ()
.如果真结束
.如果真 (并且 (等于 (总课表信息, 真), 等于 (总课表窗口., 2)))
    总课表窗口.移动 (相加 (_启动窗口., 10), 相减 (_启动窗口., 60), , )
.如果真结束
.如果真 (并且 (等于 (分课表信息, 真), 等于 (分课表窗口., 2)))
    分课表窗口.移动 (相加 (_启动窗口., 170), 相减 (_启动窗口., 60), , )
.如果真结束
.如果真 (等于 (总课表信息, 真))
    总课表窗口.调整层次 (#顶层)
.如果真结束
.如果真 (等于 (分课表信息, 真))
    分课表窗口.调整层次 (#顶层)
.如果真结束


.子程序 __启动窗口_可否被关闭, 逻辑型, , 
.如果真 (等于 (总课表信息, 真))
    赋值 (总课表窗口., 假)
.如果真结束
.如果真 (等于 (信息框 (“您是否真的要退出？”, 相加 (#询问图标, #是否钮), “让我想一想...”), #是钮))
    结束 ()
.如果真结束
.如果真 (等于 (总课表信息, 真))
    赋值 (总课表窗口., 真)
.如果真结束
返回 (假)

.子程序 _功能时钟_周期事件, 空白型, , 
 ' "功能变量"说明：
 ' 功能变量[1] 截入图片窗口，延时后销毁
 ' 功能变量 [2]延时
5.置文本 (相加 (到文本 (取小时 (取现行时间 ())), “:”, 到文本 (取分钟 (取现行时间 ())), “:”, 到文本 (取秒 (取现行时间 ())), “”))
.如果真 (等于 (功能变量 [1], 真))
    赋值 (功能变量计时 [1], 相加 (功能变量计时 [1], 1))
    .如果真 (小于 (取屏幕宽度 (), 1024))
        .如果真 (等于 (信息框 (相加 (“对不起，你的屏幕分辩率过低”, #换行符, “为了更好的使用本软件，建议设置成1024＊768分辩率”, #换行符, “请问现在是否改变分辩率？”, #换行符, “注意：如果显示器不支持请点 '否 '”), #是否钮, “提示...”), #是钮))
            未知支持库函数_69 (1024, 768, 32, 75)
        .如果真结束
        
    .如果真结束
    .如果真 (等于 (功能变量计时 [1], 4))
        启动图片窗口.销毁 ()
        赋值 (_启动窗口., 真)
        赋值 (功能变量计时 [1], 0)
        赋值 (功能变量 [1], 假)
    .如果真结束
    
.如果真结束
.如果真 (等于 (功能变量 [2], 真)) ' 延时2秒
    赋值 (功能变量计时 [2], 相加 (功能变量计时 [2], 1))
    .如果真 (等于 (功能变量计时 [2], 4))
        连续赋值 (假, 总课表窗口..禁止, 总课表窗口..禁止, 总课表窗口..禁止)
        赋值 (功能变量计时 [2], 0)
        赋值 (功能变量 [2], 假)
    .如果真结束
    
.如果真结束


.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.判断开始 (等于 (按钮索引, 1)) ' 新建
    _新建_被选择 ()
.判断 (等于 (按钮索引, 2)) ' 打开
    打开文档程序 ()
.判断 (等于 (按钮索引, 3)) ' 保存
    .如果 (并且 (等于 (总课表信息, 真), 等于 (分课表信息, 假)))
        _保存按钮_被单击 ()
    .否则
        返回 ()
    .如果结束
    
.判断 (等于 (按钮索引, 5)) ' 打印
    .如果真 (等于 (总课表信息, 真))
        _打印程序 ()
        总课表窗口.调整层次 (#顶层)
    .如果真结束
    返回 ()
.判断 (等于 (按钮索引, 6)) ' 打印预览
    .如果真 (等于 (总课表信息, 真))
        _预览程序 ()
        总课表窗口.调整层次 (#顶层)
    .如果真结束
    返回 ()
.判断 (等于 (按钮索引, 8)) ' 生成总课表
    _生成总课表_被选择 ()
.判断 (等于 (按钮索引, 9)) ' 生成分课表
    _生成各分课表_被选择 ()
.判断 (等于 (按钮索引, 11)) ' 系统设置
    载入 (系统设置窗口, , 真)
.判断 (等于 (按钮索引, 12)) ' 帮助
    _关于_被选择 ()
.判断 (等于 (按钮索引, 13)) ' 退出
    __启动窗口_可否被关闭 ()
.默认
    
.判断结束


.子程序 _新建_被选择, 空白型, , 
.如果真 (等于 (总课表信息, 真))
    赋值 (总课表窗口., 2)
.如果真结束
载入 (排课向导窗口, , 真)

.子程序 _背景图片_被选择, 空白型, , 
.局部变量 图片, 字节集, , , 
.局部变量 文件号, 整数型, , , 

赋值 (.过滤器, “图片文件|*.bmp;*.jpg;*.jpe”)
.如果真 (打开 ())
    赋值 (文件号, 打开文件 (.文件名, , ))
    赋值 (图片, 读入字节集 (文件号, 取文件长度 (文件号)))
    关闭文件 (文件号)
    赋值 (.图片, 图片)
.如果真结束


.子程序 _背景音乐_被选择, 空白型, , 
赋值 (.过滤器, “音乐文件|*.mp3”)
.如果 (等于 (.选中, 假))
    赋值 (.选中, 真)
    .如果真 (打开 ())
        播放MP3 (-1, .文件名)
        写配置项 (相加 (取运行目录 (), “\PKZSxtpz.ini”), “SYSTEM”, “Player”, “1”)
        写配置项 (相加 (取运行目录 (), “\PKZSxtpz.ini”), “SYSTEM”, “XTYY”, .文件名)
    .如果真结束
    
.否则
    赋值 (.选中, 假)
    停止播放 ()
    写配置项 (相加 (取运行目录 (), “\PKZSxtpz.ini”), “SYSTEM”, “Player”, “0”)
.如果结束


.子程序 _设置基本情况_被选择, 空白型, , 
_新建_被选择 ()

.子程序 _生成总课表_被选择, 空白型, , 
载入 (总课表窗口, , 假)

.子程序 _退出_被选择, 空白型, , 
__启动窗口_可否被关闭 ()

.子程序 _左上_被选择, 空白型, , 
赋值 (.显示方式, 0)
赋值 (.选中, 真)
连续赋值 (假, .选中, .选中)


.子程序 _居中_被选择, 空白型, , 
赋值 (.显示方式, 2)
赋值 (.选中, 真)
连续赋值 (假, .选中, .选中)


.子程序 _拉伸_被选择, 空白型, , 
赋值 (.显示方式, 1)
赋值 (.选中, 真)
连续赋值 (假, .选中, .选中)


.子程序 _生成各分课表_被选择, 空白型, , 
.如果真 (等于 (总课表信息, 假))
    信息框 (“没有排总课表，无法生成分课表！”, #信息图标, “出错了...”)
    返回 ()
.如果真结束
.如果真 (等于 (总课表信息, 真))
    赋值 (总课表窗口., 2)
    载入 (分课表窗口, , 假)
.如果真结束


.子程序 _关于_被选择, 空白型, , 
调用系统关于窗口 (_启动窗口.取窗口句柄 (), #程序信息, #作者信息, 0)

.子程序 _使用帮助_被选择, 空白型, , 
信息框 (“本测试版还没有完成，所以帮助就没有写啦。”, #信息图标, “人不懒，没福享”)


.子程序 打开文档程序, 空白型, , 
.局部变量 文本, 文本型, , , 

赋值 (.初始目录, 取运行目录 ())
赋值 (.过滤器, “所有支持文档|*.kba;*.kbb”)
.如果 (等于 (打开 (), 假))
    返回 ()
.否则
    赋值 (文本, .文件名)
    .如果真 (等于 (取文本右边 (文本, 3), “kba”))
        赋值 (学校全称, 取文本中间 (文本, 相加 (倒找文本 (文本, “\”, , 假), 1), 相减 (倒找文本 (文本, “.kb”, , 假), 倒找文本 (文本, “\”, , 假), 1)))
        _生成总课表_被选择 ()
    .如果真结束
    .如果真 (等于 (取文本右边 (文本, 3), “kbb”))
        赋值 (学校全称, 取文本中间 (文本, 相加 (倒找文本 (文本, “\”, , 假), 1), 相减 (倒找文本 (文本, “.kb”, , 假), 倒找文本 (文本, “\”, , 假), 1)))
        _新建_被选择 ()
    .如果真结束
    
.如果结束


.子程序 _打开_被选择, 空白型, , 
打开文档程序 ()

.子程序 _主图片框_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _新建课程表_被选择, 空白型, , 
.如果真 (等于 (总课表信息, 真))
    赋值 (总课表窗口., 2)
.如果真结束
载入 (排课向导窗口, , 真)

.子程序 _打开课程表_被选择, 空白型, , 
打开文档程序 ()

.窗口程序集 排课向导窗口程序集, , , 思娇屠虎　制作，QQ：84651849 E-m参数il:tashihake@163.com

.程序集变量 姓名计次, 整数型, , , 记录现有人数
.程序集变量 周总节次, 整数型, , , 记录现行排课的节次
.程序集变量 校课程总节次, 整数型, , , 记录学校所有年级班级的课程总节次
.程序集变量 个人总节次, 整数型, , , 记录个人课程总节次
.程序集变量 班级总数, 整数型, , , 记录班级总数
.程序集变量 学校路径, 文本型, , , 记录文件路径
.程序集变量 学校名字, 文本型, , "20", 记录已保存学校名字
.程序集变量 学校个数, 整数型, , , 
.程序集变量 检查课程, 逻辑型, , "6,10,30", 用来记录设置课程的检查，最多6年级，10班，30门课程
.程序集变量 组合框状态, 逻辑型, , "11", 记录11个组合框的信息
.子程序 _排课向导窗口_创建完毕, 空白型, , 
.局部变量 a, 整数型, , , 
.局部变量 变量, 整数型, , , 

赋值 (排课向导窗口., 真)
赋值 (排课向导窗口., 395)
_启动窗口.置文本 (., 1, 学校全称)
_启动窗口.置文本 (., 3, “排课向导”)
数组清零 (教师姓名)
连续赋值 (0, 姓名计次, 周总节次, 个人总节次, 班级总数)
.如果真 (文件是否存在 (相加 (取运行目录 (), “\PKZSxtpz.ini”)))
    .计次循环首 (20, a)
        .如果真 (不等于 (取文本长度 (读配置项 (相加 (取运行目录 (), “\PKZSxtpz.ini”), “学校”, 相加 (“XXPZ”, 到文本 (a)), )), 0))
            赋值 (学校个数, 相加 (学校个数, 1))
            赋值 (学校名字 [a], 读配置项 (相加 (取运行目录 (), “\PKZSxtpz.ini”), “学校”, 相加 (“XXPZ”, 到文本 (a)), ))
        .如果真结束
        
    .计次循环尾 ()
.如果真结束


.子程序 _下一步1_被单击, 空白型, , 
赋值 (.现行子夹, 1)
.如果真 (不等于 (取文本长度 (学校全称), 0))
    赋值 (.内容, 学校全称)
.如果真结束
获取焦点 ()

.子程序 _下一步2_被单击, 空白型, , 
.如果真 (或者 (等于 (.内容, “”), 等于 (.现行选中项, -1), 小于 (到整数 (.内容), 2), 小于 (到整数 (.内容), 1), 小于 (到整数 (.内容), 10), 等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“填写不完整或填写有错误！”, #错误图标, “错误”)
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (学校全称, .内容)
_启动窗口.置文本 (., 1, 学校全称)
.如果真 (等于 (.现行选中项, 0))
    赋值 (.禁止, 真)
    连续赋值 (-1, .现行选中项, .现行选中项, .现行选中项)
    赋值 (.禁止, 假)
.如果真结束
.如果真 (等于 (.现行选中项, 1))
    赋值 (.禁止, 假)
    赋值 (.禁止, 真)
    连续赋值 (-1, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项)
.如果真结束

.如果真 (文件是否存在 (学校路径))
    .如果真 (等于 (读配置项 (学校路径, “基本情况”, “教师姓名”, ), “”))
        写配置项 (学校路径, “基本情况”, “教师姓名”, “,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,”)
    .如果真结束
    
.如果真结束
赋值 (班级总数, 到整数 (.内容))
赋值 (校课程总节次, 到整数 (.内容))
赋值 (.现行子夹, 2)

.子程序 _上一步1_被单击, 空白型, , 
赋值 (.现行子夹, 0)

.子程序 _上一步2_被单击, 空白型, , 
赋值 (.现行子夹, 1)

.子程序 _下一步3_被单击, 空白型, , 
.局部变量 变量, 整数型, , "4", 
.局部变量 文本, 文本型, , "11", 
.局部变量 文本2, 文本型, , "4", 

赋值 (周总节次, 0)
.如果 (等于 (.现行选中项, 0))
    .如果真 (小于 (相加 (.现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项), 到整数 (.内容)))
        信息框 (“填写不完整或填写有错误！”, #错误图标, “错误”)
        返回 ()
    .如果真结束
    
.否则
    .如果真 (小于 (相加 (.现行选中项, .现行选中项, .现行选中项), 到整数 (.内容)))
        信息框 (“填写不完整或填写有错误！”, #错误图标, “错误”)
        返回 ()
    .如果真结束
    
.如果结束
赋值 (姓名计次, 0)
数组清零 (教师姓名)
赋值 (变量 [1], 0)
清空 ()
.如果真 (文件是否存在 (学校路径))
    赋值 (教师姓名, 分割文本 (读配置项 (学校路径, “基本情况”, “教师姓名”, ), “,”, ))
.如果真结束
赋值 (变量 [2], 取数组下标 (教师姓名, ))
.如果真 (不等于 (变量 [2], 0))
    .计次循环首 (变量 [2], 变量 [1])
        .如果真 (不等于 (教师姓名 [变量] [1], “”))
            教师姓名.加入项目 ( [变量] [1], )
            赋值 (姓名计次, 相加 (姓名计次, 1))
             ' ---计算所有已填课的总节次
            赋值 (文本, 分割文本 (读配置项 (学校路径, 教师姓名 [变量] [1], “RJKM”, ), “;”, ))
            赋值 (变量 [3], 取数组下标 (文本, ))
            .计次循环首 (变量 [3], 变量 [4])
                赋值 (文本2, 分割文本 (文本 [变量] [4], “,”, ))
                赋值 (周总节次, 相加 (周总节次, 到整数 (文本2 [4])))
                
            .计次循环尾 ()
        .如果真结束
        
    .计次循环尾 ()
.如果真结束


赋值 (.现行子夹, 3)
获取焦点 ()
赋值 (.标题, 相加 (“已安排课：”, 到文本 (周总节次), “节”))
赋值 (.标题, 相加 (“已填：”, 到文本 (姓名计次), “人”))

.子程序 _上一步3_被单击, 空白型, , 
赋值 (.现行子夹, 2)

.子程序 _下一步4_被单击, 空白型, , 
.局部变量 变量, 整数型, , "2", 

.如果真 (小于 (姓名计次, 到整数 (.内容)))
    信息框 (“还有教师没有安排课！”, #错误图标, “错了...”)
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (.现行子夹, 4)
赋值 (.现行选中项, 0)
赋值 (.现行选中项, 4)
清空 ()
清空 ()
“”.加入项目 ()
“”.加入项目 ()
赋值 (变量 [2], 取数组下标 (教师姓名, ))
.如果真 (不等于 (变量 [2], 0))
    .计次循环首 (变量 [2], 变量 [1])
        .如果真 (不等于 (教师姓名 [变量] [1], “”))
            教师姓名.加入项目 ( [变量] [1], )
            教师姓名.加入项目 ( [变量] [1], )
        .如果真结束
        
    .计次循环尾 ()
.如果真结束


.子程序 _上一步4_被单击, 空白型, , 
赋值 (.现行子夹, 4)

.子程序 _完成_被单击, 空白型, , 
.局部变量 a, 整数型, , , 

 ' 保存所有数据
写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “基本情况”, “学校名称”, .内容)
写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “基本情况”, “学校类别”, 到文本 (.现行选中项))
写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “基本情况”, “教师人数”, .内容)
写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “基本情况”, “班级数量”, .内容)
写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “基本情况”, “学生人数”, .内容)
写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “基本情况”, “人总节次”, .内容)
写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “基本情况”, “校总节次”, .内容)
写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “基本情况”, “填置时间”, .内容)
写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “基本情况”, “NJ1”, 到文本 (.现行选中项))
写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “基本情况”, “NJ2”, 到文本 (.现行选中项))
写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “基本情况”, “NJ3”, 到文本 (.现行选中项))
写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “基本情况”, “NJ4”, 到文本 (.现行选中项))
写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “基本情况”, “NJ5”, 到文本 (.现行选中项))
写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “基本情况”, “NJ6”, 到文本 (.现行选中项))
写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “基本情况”, “NJ7”, 到文本 (.现行选中项))
写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “基本情况”, “NJ8”, 到文本 (.现行选中项))
写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “基本情况”, “NJ9”, 到文本 (.现行选中项))
.如果 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “特殊情况”, “TS1”, “1”)
.否则
    写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “特殊情况”, “TS1”, “0”)
.如果结束
.如果 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “特殊情况”, “TS2”, “1”)
.否则
    写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “特殊情况”, “TS2”, “0”)
.如果结束
.如果 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “特殊情况”, “TS3”, “1”)
.否则
    写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “特殊情况”, “TS3”, “0”)
.如果结束
.如果 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “特殊情况”, “TS4”, “1”)
.否则
    写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “特殊情况”, “TS4”, “0”)
.如果结束
.如果 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “特殊情况”, “TS5”, “1”)
.否则
    写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “特殊情况”, “TS5”, “0”)
.如果结束
.如果 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “特殊情况”, “TS6”, “1”)
.否则
    写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “特殊情况”, “TS6”, “0”)
.如果结束
.如果 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “特殊情况”, “TS7”, “1”)
.否则
    写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “特殊情况”, “TS7”, “0”)
.如果结束
.如果 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “特殊情况”, “TS8”, “1”)
.否则
    写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “特殊情况”, “TS8”, “0”)
.如果结束
.如果 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “特殊情况”, “TS9”, “1”)
.否则
    写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “特殊情况”, “TS9”, “0”)
.如果结束
写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “特殊情况”, “TS10-1”, .内容)
写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “特殊情况”, “TS10-2”, .内容)
写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “特殊情况”, “TS11-1”, .内容)
写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “特殊情况”, “TS11-2”, .内容)
写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “特殊情况”, “TS12”, 到文本 (.现行选中项))
写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), “特殊情况”, “TS13”, 到文本 (.现行选中项))
 ' 写学校名称
.计次循环首 (取数组下标 (学校名字, ), a)
    .如果真 (等于 (学校名字 [a], 学校全称))
        _启动窗口.置文本 (., 3, “”)
        .如果真 (等于 (总课表信息, 真))
            赋值 (总课表窗口., 0)
        .如果真结束
        销毁 ()
        返回 ()
    .如果真结束
    
.计次循环尾 ()
赋值 (学校个数, 相加 (学校个数, 1))
写配置项 (相加 (取运行目录 (), “\PKZSxtpz.ini”), “学校”, 相加 (“XXPZ”, 到文本 (学校个数)), 学校全称)

_启动窗口.置文本 (., 3, “”)
.如果真 (等于 (总课表信息, 真))
    赋值 (总课表窗口., 0)
.如果真结束
销毁 ()

.子程序 _按钮2_被单击, 空白型, , 
_启动窗口.置文本 (., 1, “”)
_启动窗口.置文本 (., 3, “”)
.如果真 (等于 (总课表信息, 真))
    赋值 (总课表窗口., 0)
    _启动窗口.置文本 (., 3, “总课表向导”)
.如果真结束
赋值 (学校全称, “”)
销毁 ()

.子程序 _下一位_被单击, 空白型, , 
.局部变量 计次, 整数型, , "4", 
.局部变量 文本内容, 文本型, , , 

 ' 作一些简单的判断，
.如果真 (大于 (姓名计次, 40))
    信息框 (“对不起！本测试版最大只支持40名教师！”, #错误图标, “出错了”)
    返回 ()
.如果真结束
.如果真 (大于 (相加 (姓名计次, 1), 到整数 (.内容)))
    信息框 (相加 (“现人数超过登记总人数。”, #换行符, “新人请先去校长室登记再来！”), #错误图标, “出错了...”)
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“对不起，你没有填教师姓名!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
.计次循环首 (姓名计次, 计次 [1])
    .如果真 (等于 (教师姓名 [计次] [1], .内容))
        信息框 (“重复加入。”, #错误图标, “错误...”)
        返回 ()
    .如果真结束
    
.计次循环尾 ()
赋值 (计次 [2], 相加 (.现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项))
赋值 (周总节次, 相加 (计次 [2], 周总节次))
.如果真 (小于 (到整数 (.内容), 计次 [2]))
    信息框 (“错了吧，现行安排课程已大于一周总节次。”, #错误图标, “出错了...”)
    返回 ()
.如果真结束
.如果真 (大于 (周总节次, 到数值 (.内容)))
    信息框 (“错了吧，现行安排的总课程已大于一周总节次。”, #错误图标, “出错了...”)
    返回 ()
.如果真结束
.如果真 (或者 (等于 (.现行选中项, 0), 等于 (.现行选中项, 0), 等于 (.现行选中项, 0), 等于 (.现行选中项, 0)))
    .如果真 (等于 (信息框 (“对不起，这位教师没有授课吗？”, 相加 (#询问图标, #是否钮), “警告!”), #否钮))
        获取焦点 ()
        返回 ()
    .如果真结束
    
.如果真结束

赋值 (文本内容, .内容)
赋值 (姓名计次, 相加 (姓名计次, 1))
赋值 (教师姓名 [姓名计次], 文本内容)
文本内容.加入项目 ()
赋值 (计次 [3], 取数组下标 (教师姓名, ))
赋值 (文本内容, “”)
.如果真 (不等于 (计次 [3], 0))
    .计次循环首 (计次 [3], 计次 [4])
        赋值 (文本内容, 相加 (文本内容, 教师姓名 [计次] [4], “,”))
    .计次循环尾 ()
    .计次循环首 (相减 (40, 计次 [3]), 计次 [4])
        赋值 (文本内容, 相加 (文本内容, “,”))
    .计次循环尾 ()
    写配置项 (学校路径, “基本情况”, “教师姓名”, 文本内容)
.如果真结束


写配置项 (学校路径, .内容, , )
写配置项 (学校路径, .内容, “XB”, 到文本 (.现行选中项))
写配置项 (学校路径, .内容, “YN”, .内容)
写配置项 (学校路径, .内容, “ZHW”, .内容)
写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), .内容, “RJKM”, 相加 (到文本 (.现行选中项), “,”, 到文本 (.现行选中项), “,”, .内容, “,”, 到文本 (.现行选中项), “;”, 到文本 (.现行选中项), “,”, 到文本 (.现行选中项), “,”, .内容, “,”, 到文本 (.现行选中项), “;”, 到文本 (.现行选中项), “,”, 到文本 (.现行选中项), “,”, .内容, “,”, 到文本 (.现行选中项), “;”, 到文本 (.现行选中项), “,”, 到文本 (.现行选中项), “,”, .内容, “,”, 到文本 (.现行选中项), “;”, 到文本 (.现行选中项), “,”, 到文本 (.现行选中项), “,”, .内容, “,”, 到文本 (.现行选中项), “;”, 到文本 (.现行选中项), “,”, 到文本 (.现行选中项), “,”, .内容, “,”, 到文本 (.现行选中项), “;”, 到文本 (.现行选中项), “,”, 到文本 (.现行选中项), “,”, .内容, “,”, 到文本 (.现行选中项), “;”, 到文本 (.现行选中项), “,”, 到文本 (.现行选中项), “,”, .内容, “,”, 到文本 (.现行选中项), “;”, 到文本 (.现行选中项), “,”, 到文本 (.现行选中项), “,”, .内容, “,”, 到文本 (.现行选中项), “;”, 到文本 (.现行选中项), “,”, 到文本 (.现行选中项), “,”, .内容, “,”, 到文本 (.现行选中项), “;”, 到文本 (.现行选中项), “,”, 到文本 (.现行选中项), “,”, .内容, “,”, 到文本 (.现行选中项)))

连续赋值 (“”, .内容, .内容) ' 清空所有的项目，为下一位输入做好准备
连续赋值 (-1, .现行选中项, .现行选中项)
连续赋值 (-1, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项)
连续赋值 (0, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项)
连续赋值 (0, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项)
赋值 (.标题, 相加 (“已填：”, 到文本 (姓名计次), “人”))
赋值 (.标题, 相加 (“已安排课：”, 到文本 (周总节次), “节”))
获取焦点 ()


.子程序 _姓名框_列表项被选择, 空白型, , 
.局部变量 参数1, 文本型, , "11", 
.局部变量 课程信息, 文本型, , "4", 
.局部变量 文本内容, 文本型, , , 
.局部变量 a, 整数型, , , 

连续赋值 (-1, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项)
赋值 (文本内容, .内容)
赋值 (.现行选中项, 到整数 (读配置项 (学校路径, 文本内容, “XB”, )))
赋值 (.内容, 读配置项 (学校路径, 文本内容, “YN”, ))
赋值 (.内容, 读配置项 (学校路径, 文本内容, “ZHW”, ))
赋值 (参数1, 分割文本 (读配置项 (学校路径, 文本内容, “RJKM”, ), “;”, ))
.如果真 (不等于 (取数组下标 (参数1, ), 0)) ' 读入授课相关数据
    赋值 (课程信息, 分割文本 (参数1 [1], “,”, ))
    赋值 (.现行选中项, 到整数 (课程信息 [1]))
    赋值 (.现行选中项, 到整数 (课程信息 [2]))
    赋值 (.内容, 课程信息 [3])
    赋值 (.现行选中项, 到整数 (课程信息 [4]))
    赋值 (课程信息, 分割文本 (参数1 [2], “,”, ))
    赋值 (.现行选中项, 到整数 (课程信息 [1]))
    赋值 (.现行选中项, 到整数 (课程信息 [2]))
    赋值 (.内容, 课程信息 [3])
    赋值 (.现行选中项, 到整数 (课程信息 [4]))
    赋值 (课程信息, 分割文本 (参数1 [3], “,”, ))
    赋值 (.现行选中项, 到整数 (课程信息 [1]))
    赋值 (.现行选中项, 到整数 (课程信息 [2]))
    赋值 (.内容, 课程信息 [3])
    赋值 (.现行选中项, 到整数 (课程信息 [4]))
    赋值 (课程信息, 分割文本 (参数1 [4], “,”, ))
    赋值 (.现行选中项, 到整数 (课程信息 [1]))
    赋值 (.现行选中项, 到整数 (课程信息 [2]))
    赋值 (.内容, 课程信息 [3])
    赋值 (.现行选中项, 到整数 (课程信息 [4]))
    赋值 (课程信息, 分割文本 (参数1 [5], “,”, ))
    赋值 (.现行选中项, 到整数 (课程信息 [1]))
    赋值 (.现行选中项, 到整数 (课程信息 [2]))
    赋值 (.内容, 课程信息 [3])
    赋值 (.现行选中项, 到整数 (课程信息 [4]))
    赋值 (课程信息, 分割文本 (参数1 [6], “,”, ))
    赋值 (.现行选中项, 到整数 (课程信息 [1]))
    赋值 (.现行选中项, 到整数 (课程信息 [2]))
    赋值 (.内容, 课程信息 [3])
    赋值 (.现行选中项, 到整数 (课程信息 [4]))
    赋值 (课程信息, 分割文本 (参数1 [7], “,”, ))
    赋值 (.现行选中项, 到整数 (课程信息 [1]))
    赋值 (.现行选中项, 到整数 (课程信息 [2]))
    赋值 (.内容, 课程信息 [3])
    赋值 (.现行选中项, 到整数 (课程信息 [4]))
    赋值 (课程信息, 分割文本 (参数1 [8], “,”, ))
    赋值 (.现行选中项, 到整数 (课程信息 [1]))
    赋值 (.现行选中项, 到整数 (课程信息 [2]))
    赋值 (.内容, 课程信息 [3])
    赋值 (.现行选中项, 到整数 (课程信息 [4]))
    赋值 (课程信息, 分割文本 (参数1 [9], “,”, ))
    赋值 (.现行选中项, 到整数 (课程信息 [1]))
    赋值 (.现行选中项, 到整数 (课程信息 [2]))
    赋值 (.内容, 课程信息 [3])
    赋值 (.现行选中项, 到整数 (课程信息 [4]))
    赋值 (课程信息, 分割文本 (参数1 [10], “,”, ))
    赋值 (.现行选中项, 到整数 (课程信息 [1]))
    赋值 (.现行选中项, 到整数 (课程信息 [2]))
    赋值 (.内容, 课程信息 [3])
    赋值 (.现行选中项, 到整数 (课程信息 [4]))
    赋值 (课程信息, 分割文本 (参数1 [11], “,”, ))
    赋值 (.现行选中项, 到整数 (课程信息 [1]))
    赋值 (.现行选中项, 到整数 (课程信息 [2]))
    赋值 (.内容, 课程信息 [3])
    赋值 (.现行选中项, 到整数 (课程信息 [4]))
    
.如果真结束
赋值 (a, 0)
赋值 (a, 相加 (.现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项))
赋值 (周总节次, 相减 (周总节次, a))


.子程序 _按钮1_被单击, 空白型, , 
.如果 (不等于 (.内容, “”))
    _完成_被单击 ()
    _生成总课表_被选择 ()
.否则
    信息框 (“你没有输入学校名，或有错误！”, #错误图标, “请检查...”)
    返回 ()
.如果结束


.子程序 _学校名称_内容被改变, 空白型, , 
赋值 (周总节次, 0)
赋值 (学校全称, .内容)
赋值 (学校路径, 相加 (取运行目录 (), “\”, 学校全称, “.kbb”))
连续赋值 (0, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项)
.如果真 (文件是否存在 (学校路径)) ' 如果有，就读入设置好的内容
    赋值 (.现行选中项, 到整数 (读配置项 (学校路径, “基本情况”, “学校类别”, )))
    赋值 (.内容, 读配置项 (学校路径, “基本情况”, “教师人数”, ))
    赋值 (.内容, 读配置项 (学校路径, “基本情况”, “班级数量”, ))
    赋值 (.内容, 读配置项 (学校路径, “基本情况”, “学生人数”, ))
    赋值 (.内容, 读配置项 (学校路径, “基本情况”, “人总节次”, ))
    赋值 (.内容, 读配置项 (学校路径, “基本情况”, “校总节次”, ))
    赋值 (.内容, 读配置项 (学校路径, “基本情况”, “填置时间”, ))
    赋值 (.现行选中项, 到整数 (读配置项 (学校路径, “基本情况”, “NJ1”, )))
    赋值 (.现行选中项, 到整数 (读配置项 (学校路径, “基本情况”, “NJ2”, )))
    赋值 (.现行选中项, 到整数 (读配置项 (学校路径, “基本情况”, “NJ3”, )))
    赋值 (.现行选中项, 到整数 (读配置项 (学校路径, “基本情况”, “NJ4”, )))
    赋值 (.现行选中项, 到整数 (读配置项 (学校路径, “基本情况”, “NJ5”, )))
    赋值 (.现行选中项, 到整数 (读配置项 (学校路径, “基本情况”, “NJ6”, )))
    赋值 (.现行选中项, 到整数 (读配置项 (学校路径, “基本情况”, “NJ7”, )))
    赋值 (.现行选中项, 到整数 (读配置项 (学校路径, “基本情况”, “NJ8”, )))
    赋值 (.现行选中项, 到整数 (读配置项 (学校路径, “基本情况”, “NJ9”, )))
    .如果真 (等于 (读配置项 (学校路径, “特殊情况”, “TS1”, ), “1”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (读配置项 (学校路径, “特殊情况”, “TS2”, ), “1”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (读配置项 (学校路径, “特殊情况”, “TS3”, ), “1”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (读配置项 (学校路径, “特殊情况”, “TS4”, ), “1”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (读配置项 (学校路径, “特殊情况”, “TS5”, ), “1”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (读配置项 (学校路径, “特殊情况”, “TS6”, ), “1”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (读配置项 (学校路径, “特殊情况”, “TS7”, ), “1”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (读配置项 (学校路径, “特殊情况”, “TS8”, ), “1”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (读配置项 (学校路径, “特殊情况”, “TS9”, ), “1”))
        赋值 (.选中, 真)
    .如果真结束
    
    赋值 (.内容, 读配置项 (学校路径, “特殊情况”, “TS10-1”, ))
    赋值 (.内容, 读配置项 (学校路径, “特殊情况”, “TS10-2”, ))
    赋值 (.内容, 读配置项 (学校路径, “特殊情况”, “TS11-1”, ))
    赋值 (.内容, 读配置项 (学校路径, “特殊情况”, “TS11-2”, ))
    赋值 (.现行选中项, 到整数 (读配置项 (学校路径, “特殊情况”, “TS12”, )))
    赋值 (.现行选中项, 到整数 (读配置项 (学校路径, “特殊情况”, “TS13”, )))
    _启动窗口.置文本 (., 1, 学校全称)
.如果真结束


.子程序 _人总节次_列表项被选择, 空白型, , 
赋值 (.内容, 到文本 (相乘 (到整数 (.内容), 到整数 (.内容))))


.子程序 _下一步5_被单击, 空白型, , 
赋值 (.现行子夹, 5)


.子程序 _上一步5_被单击, 空白型, , 
赋值 (.现行子夹, 3)

.子程序 _框1_列表项被选择, 空白型, , 
.如果真 (小于 (班级总数, 相加 (.现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项)))
    信息框 (“对不起，数据有误！现行设置班级大于学校总班级。”, #错误图标, “不要搞错了...”)
    赋值 (.现行选中项, 0)
.如果真结束


.子程序 _框2_列表项被选择, 空白型, , 
.如果真 (小于 (班级总数, 相加 (.现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项)))
    信息框 (“对不起，数据有误！现行设置班级大于学校总班级。”, #错误图标, “不要搞错了...”)
    赋值 (.现行选中项, 0)
.如果真结束


.子程序 _框3_列表项被选择, 空白型, , 
.如果真 (小于 (班级总数, 相加 (.现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项)))
    信息框 (“对不起，数据有误！现行设置班级大于学校总班级。”, #错误图标, “不要搞错了...”)
    赋值 (.现行选中项, 0)
.如果真结束


.子程序 _框4_列表项被选择, 空白型, , 
.如果真 (小于 (班级总数, 相加 (.现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项)))
    信息框 (“对不起，数据有误！现行设置班级大于学校总班级。”, #错误图标, “不要搞错了...”)
    赋值 (.现行选中项, 0)
.如果真结束


.子程序 _框5_列表项被选择, 空白型, , 
.如果真 (小于 (班级总数, 相加 (.现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项)))
    信息框 (“对不起，数据有误！现行设置班级大于学校总班级。”, #错误图标, “不要搞错了...”)
    赋值 (.现行选中项, 0)
.如果真结束


.子程序 _框6_列表项被选择, 空白型, , 
.如果真 (小于 (班级总数, 相加 (.现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项)))
    信息框 (“对不起，数据有误！现行设置班级大于学校总班级。”, #错误图标, “不要搞错了...”)
    赋值 (.现行选中项, 0)
.如果真结束


.子程序 _框7_列表项被选择, 空白型, , 
.如果真 (小于 (班级总数, 相加 (.现行选中项, .现行选中项, .现行选中项)))
    信息框 (“对不起，数据有误！现行设置班级大于学校总班级。”, #错误图标, “不要搞错了...”)
    赋值 (.现行选中项, 0)
.如果真结束


.子程序 _框8_列表项被选择, 空白型, , 
.如果真 (小于 (班级总数, 相加 (.现行选中项, .现行选中项, .现行选中项)))
    信息框 (“对不起，数据有误！现行设置班级大于学校总班级。”, #错误图标, “不要搞错了...”)
    赋值 (.现行选中项, 0)
.如果真结束


.子程序 _框9_列表项被选择, 空白型, , 
.如果真 (小于 (班级总数, 相加 (.现行选中项, .现行选中项, .现行选中项)))
    信息框 (“对不起，数据有误！现行设置班级大于学校总班级。”, #错误图标, “不要搞错了...”)
    赋值 (.现行选中项, 0)
.如果真结束


.子程序 _删除按钮_被单击, 空白型, , 
.局部变量 文本, 文本型, , "2", 
.局部变量 a, 整数型, , , 
.局部变量 文件号, 整数型, , , 

.如果真 (等于 (取文本长度 (.内容), 0))
    信息框 (“对不起，没有选择教师！”, #信息图标, “出错了...”)
    获取焦点 ()
    返回 ()
.如果真结束

赋值 (文本 [1], .内容)
赋值 (a, .现行选中项)
a.删除项目 ()
写配置项 (学校路径, 文本 [1], , )
赋值 (文件号, 打开文件 (学校路径, #, ))
赋值 (文本 [2], 读入文本 (文件号, ))
移动读写位置 (文件号, , 相减 (寻找文本 (文本 [2], 文本 [1], , 假), 1))
删除数据 (文件号, 取文本长度 (文本 [1]))
关闭文件 (文件号)

赋值 (姓名计次, 相减 (姓名计次, 1))
赋值 (.现行选中项, 相减 (a, 1))
.如果真 (小于 (姓名计次, 0))
    赋值 (姓名计次, 0)
.如果真结束
赋值 (.标题, 相加 (“已填：”, 到文本 (姓名计次), “人”))
赋值 (周总节次, 相减 (周总节次, 相加 (.现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项)))
赋值 (.标题, 相加 (“已安排课：”, 到文本 (周总节次), “节”))
获取焦点 ()

.子程序 _修改按钮_被单击, 空白型, , 
.局部变量 a, 整数型, , , 
.局部变量 b, 整数型, , , 
.局部变量 文本内容, 文本型, , , 

赋值 (a, 0)
赋值 (a, 相加 (.现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项))
赋值 (周总节次, 相加 (a, 周总节次))
.如果真 (小于 (到整数 (.内容), a))
    信息框 (“错了吧，现行安排课程已大于一周总节次。”, #错误图标, “出错了...”)
    返回 ()
.如果真结束
.如果真 (大于 (周总节次, 到数值 (.内容)))
    信息框 (“错了吧，现行安排的总课程已大于一周总节次。”, #错误图标, “出错了...”)
    返回 ()
.如果真结束
.如果真 (或者 (等于 (.现行选中项, 0), 等于 (.现行选中项, 0), 等于 (.现行选中项, 0), 等于 (.现行选中项, 0)))
    .如果真 (等于 (信息框 (“对不起，这位教师没有授课吗？”, 相加 (#询问图标, #是否钮), “警告!”), #否钮))
        获取焦点 ()
        返回 ()
    .如果真结束
    
.如果真结束
写配置项 (学校路径, .内容, , )
写配置项 (学校路径, .内容, “XB”, 到文本 (.现行选中项))
写配置项 (学校路径, .内容, “YN”, .内容)
写配置项 (学校路径, .内容, “ZHW”, .内容)
 ' 写授课情况
写配置项 (相加 (取运行目录 (), “\”, 学校全称, “.kbb”), .内容, “RJKM”, 相加 (到文本 (.现行选中项), “,”, 到文本 (.现行选中项), “,”, .内容, “,”, 到文本 (.现行选中项), “;”, 到文本 (.现行选中项), “,”, 到文本 (.现行选中项), “,”, .内容, “,”, 到文本 (.现行选中项), “;”, 到文本 (.现行选中项), “,”, 到文本 (.现行选中项), “,”, .内容, “,”, 到文本 (.现行选中项), “;”, 到文本 (.现行选中项), “,”, 到文本 (.现行选中项), “,”, .内容, “,”, 到文本 (.现行选中项), “;”, 到文本 (.现行选中项), “,”, 到文本 (.现行选中项), “,”, .内容, “,”, 到文本 (.现行选中项), “;”, 到文本 (.现行选中项), “,”, 到文本 (.现行选中项), “,”, .内容, “,”, 到文本 (.现行选中项), “;”, 到文本 (.现行选中项), “,”, 到文本 (.现行选中项), “,”, .内容, “,”, 到文本 (.现行选中项), “;”, 到文本 (.现行选中项), “,”, 到文本 (.现行选中项), “,”, .内容, “,”, 到文本 (.现行选中项), “;”, 到文本 (.现行选中项), “,”, 到文本 (.现行选中项), “,”, .内容, “,”, 到文本 (.现行选中项), “;”, 到文本 (.现行选中项), “,”, 到文本 (.现行选中项), “,”, .内容, “,”, 到文本 (.现行选中项), “;”, 到文本 (.现行选中项), “,”, 到文本 (.现行选中项), “,”, .内容, “,”, 到文本 (.现行选中项)))
连续赋值 (“”, .内容, .内容) ' 清空所有的项目，为下一位输入做好准备
连续赋值 (-1, .现行选中项, .现行选中项)
连续赋值 (-1, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项)
连续赋值 (0, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项)
获取焦点 ()
赋值 (.标题, 相加 (“已安排课：”, 到文本 (周总节次), “节”))

.子程序 _按钮3_被单击, 空白型, , 
.如果真 (等于 (取文本长度 (.内容), 0))
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“是否真的要删除？”, 相加 (#询问图标, #是否钮), ), #是钮))
    .如果真 (文件是否存在 (相加 (取运行目录 (), “\”, .内容, “.kbb”))) ' 删除文件及置空所有
        删除文件 (相加 (取运行目录 (), “\”, .内容, “.kbb”))
        连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容) ' 清空所有的项目，为下一位输入做好准备
        连续赋值 (-1, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项)
        连续赋值 (-1, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项)
        连续赋值 (0, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项)
        获取焦点 ()
    .如果真结束
    
.如果真结束


.子程序 _组合框1_1_列表项被选择, 空白型, , 自动选取班级“一”
.如果真 (大于 (.现行选中项, 0))
    赋值 (.现行选中项, 1)
.如果真结束
.如果真 (等于 (.现行选中项, 0))
    赋值 (.现行选中项, 0)
    赋值 (.现行选中项, -1)
    赋值 (.现行选中项, 0)
.如果真结束


.子程序 _组合框2_1_列表项被选择, 空白型, , 
.如果真 (大于 (.现行选中项, 0))
    赋值 (.现行选中项, 1)
.如果真结束
.如果真 (等于 (.现行选中项, 0))
    赋值 (.现行选中项, 0)
    赋值 (.现行选中项, -1)
    赋值 (.现行选中项, 0)
.如果真结束


.子程序 _组合框3_1_列表项被选择, 空白型, , 
.如果真 (大于 (.现行选中项, 0))
    赋值 (.现行选中项, 1)
.如果真结束
.如果真 (等于 (.现行选中项, 0))
    赋值 (.现行选中项, 0)
    赋值 (.现行选中项, -1)
    赋值 (.现行选中项, 0)
.如果真结束


.子程序 _组合框4_1_列表项被选择, 空白型, , 
.如果真 (大于 (.现行选中项, 0))
    赋值 (.现行选中项, 1)
.如果真结束
.如果真 (等于 (.现行选中项, 0))
    赋值 (.现行选中项, 0)
    赋值 (.现行选中项, -1)
    赋值 (.现行选中项, 0)
.如果真结束


.子程序 _组合框5_1_列表项被选择, 空白型, , 
.如果真 (大于 (.现行选中项, 0))
    赋值 (.现行选中项, 1)
.如果真结束
.如果真 (等于 (.现行选中项, 0))
    赋值 (.现行选中项, 0)
    赋值 (.现行选中项, -1)
    赋值 (.现行选中项, 0)
.如果真结束


.子程序 _组合框6_1_列表项被选择, 空白型, , 
.如果真 (大于 (.现行选中项, 0))
    赋值 (.现行选中项, 1)
.如果真结束
.如果真 (等于 (.现行选中项, 0))
    赋值 (.现行选中项, 0)
    赋值 (.现行选中项, -1)
    赋值 (.现行选中项, 0)
.如果真结束


.子程序 _组合框7_1_列表项被选择, 空白型, , 
.如果真 (大于 (.现行选中项, 0))
    赋值 (.现行选中项, 1)
.如果真结束
.如果真 (等于 (.现行选中项, 0))
    赋值 (.现行选中项, 0)
    赋值 (.现行选中项, -1)
    赋值 (.现行选中项, 0)
.如果真结束


.子程序 _组合框8_1_列表项被选择, 空白型, , 
.如果真 (等于 (.现行选中项, 0))
    赋值 (.现行选中项, 0)
    赋值 (.现行选中项, -1)
    赋值 (.现行选中项, 0)
.如果真结束
.如果真 (大于 (.现行选中项, 0))
    赋值 (.现行选中项, 1)
.如果真结束


.子程序 _组合框9_1_列表项被选择, 空白型, , 
.如果真 (大于 (.现行选中项, 0))
    赋值 (.现行选中项, 1)
.如果真结束
.如果真 (等于 (.现行选中项, 0))
    赋值 (.现行选中项, 0)
    赋值 (.现行选中项, -1)
    赋值 (.现行选中项, 0)
.如果真结束


.子程序 _组合框10_1_列表项被选择, 空白型, , 
.如果真 (大于 (.现行选中项, 0))
    赋值 (.现行选中项, 1)
.如果真结束
.如果真 (等于 (.现行选中项, 0))
    赋值 (.现行选中项, 0)
    赋值 (.现行选中项, -1)
    赋值 (.现行选中项, 0)
.如果真结束


.子程序 _组合框11_1_列表项被选择, 空白型, , 
.如果真 (大于 (.现行选中项, 0))
    赋值 (.现行选中项, 1)
.如果真结束
.如果真 (等于 (.现行选中项, 0))
    赋值 (.现行选中项, 0)
    赋值 (.现行选中项, -1)
    赋值 (.现行选中项, 0)
.如果真结束


.子程序 _学校类别_列表项被选择, 空白型, , 
.如果真 (等于 (.现行选中项, 1))
    信息框 (“对不起，本测试版不支持初中排课！”, #信息图标, “出错了...”)
    赋值 (.现行选中项, 0)
.如果真结束


.子程序 _组合框1_4_列表项被选择, 空白型, , 计算个人课程总节次
.如果真 (大于 (相加 (周总节次, .现行选中项), 校课程总节次))
    信息框 (“对不起，现安排课数已超过学校所有课的总和。”, #错误图标, “出错了...”)
    赋值 (.现行选中项, 0)
    返回 ()
.如果真结束


.子程序 _组合框2_4_列表项被选择, 空白型, , 
.如果真 (大于 (相加 (周总节次, .现行选中项), 校课程总节次))
    信息框 (“对不起，现安排课数已超过学校所有课的总和。”, #错误图标, “出错了...”)
    赋值 (.现行选中项, 0)
    返回 ()
.如果真结束


.子程序 _组合框3_4_列表项被选择, 空白型, , 
.如果真 (大于 (相加 (周总节次, .现行选中项), 校课程总节次))
    信息框 (“对不起，现安排课数已超过学校所有课的总和。”, #错误图标, “出错了...”)
    赋值 (.现行选中项, 0)
    返回 ()
.如果真结束


.子程序 _组合框4_4_列表项被选择, 空白型, , 
.如果真 (大于 (相加 (周总节次, .现行选中项), 校课程总节次))
    信息框 (“对不起，现安排课数已超过学校所有课的总和。”, #错误图标, “出错了...”)
    赋值 (.现行选中项, 0)
    返回 ()
.如果真结束


.子程序 _组合框5_4_列表项被选择, 空白型, , 
.如果真 (大于 (相加 (周总节次, .现行选中项), 校课程总节次))
    信息框 (“对不起，现安排课数已超过学校所有课的总和。”, #错误图标, “出错了...”)
    赋值 (.现行选中项, 0)
    返回 ()
.如果真结束


.子程序 _组合框6_4_列表项被选择, 空白型, , 
.如果真 (大于 (相加 (周总节次, .现行选中项), 校课程总节次))
    信息框 (“对不起，现安排课数已超过学校所有课的总和。”, #错误图标, “出错了...”)
    赋值 (.现行选中项, 0)
    返回 ()
.如果真结束


.子程序 _组合框7_4_列表项被选择, 空白型, , 
.如果真 (大于 (相加 (周总节次, .现行选中项), 校课程总节次))
    信息框 (“对不起，现安排课数已超过学校所有课的总和。”, #错误图标, “出错了...”)
    赋值 (.现行选中项, 0)
    返回 ()
.如果真结束


.子程序 _组合框8_4_列表项被选择, 空白型, , 
.如果真 (大于 (相加 (周总节次, .现行选中项), 校课程总节次))
    信息框 (“对不起，现安排课数已超过学校所有课的总和。”, #错误图标, “出错了...”)
    赋值 (.现行选中项, 0)
    返回 ()
.如果真结束


.子程序 _组合框9_4_列表项被选择, 空白型, , 
.如果真 (大于 (相加 (周总节次, .现行选中项), 校课程总节次))
    信息框 (“对不起，现安排课数已超过学校所有课的总和。”, #错误图标, “出错了...”)
    赋值 (.现行选中项, 0)
    返回 ()
.如果真结束


.子程序 _组合框10_4_列表项被选择, 空白型, , 
.如果真 (大于 (相加 (周总节次, .现行选中项), 校课程总节次))
    信息框 (“对不起，现安排课数已超过学校所有课的总和。”, #错误图标, “出错了...”)
    赋值 (.现行选中项, 0)
    返回 ()
.如果真结束


.子程序 _组合框11_4_列表项被选择, 空白型, , 
.如果真 (大于 (相加 (周总节次, .现行选中项), 校课程总节次))
    信息框 (“对不起，现安排课数已超过学校所有课的总和。”, #错误图标, “出错了...”)
    赋值 (.现行选中项, 0)
    返回 ()
.如果真结束


.子程序 _组合框1_2_列表项被选择, 空白型, , 检查是否选取不存在的班级
赋值 (.现行选中项, 检查班级程序 (.现行选中项, .现行选中项, .现行选中项))

.子程序 _组合框2_2_列表项被选择, 空白型, , 
赋值 (.现行选中项, 检查班级程序 (.现行选中项, .现行选中项, .现行选中项))

.子程序 _组合框3_2_列表项被选择, 空白型, , 
赋值 (.现行选中项, 检查班级程序 (.现行选中项, .现行选中项, .现行选中项))

.子程序 _组合框4_2_列表项被选择, 空白型, , 
赋值 (.现行选中项, 检查班级程序 (.现行选中项, .现行选中项, .现行选中项))

.子程序 _组合框5_2_列表项被选择, 空白型, , 
赋值 (.现行选中项, 检查班级程序 (.现行选中项, .现行选中项, .现行选中项))

.子程序 _组合框6_2_列表项被选择, 空白型, , 
赋值 (.现行选中项, 检查班级程序 (.现行选中项, .现行选中项, .现行选中项))

.子程序 _组合框7_2_列表项被选择, 空白型, , 
赋值 (.现行选中项, 检查班级程序 (.现行选中项, .现行选中项, .现行选中项))

.子程序 _组合框8_2_列表项被选择, 空白型, , 
赋值 (.现行选中项, 检查班级程序 (.现行选中项, .现行选中项, .现行选中项))

.子程序 _组合框9_2_列表项被选择, 空白型, , 
赋值 (.现行选中项, 检查班级程序 (.现行选中项, .现行选中项, .现行选中项))

.子程序 _组合框10_2_列表项被选择, 空白型, , 
赋值 (.现行选中项, 检查班级程序 (.现行选中项, .现行选中项, .现行选中项))

.子程序 _组合框11_2_列表项被选择, 空白型, , 
赋值 (.现行选中项, 检查班级程序 (.现行选中项, .现行选中项, .现行选中项))

.子程序 检查班级程序, 整数型, , 判断有没有选择超过设定班级数
.参数 参数1, 整数型, , 年级
.参数 参数2, 整数型, , 班级
.参数 参数3, 整数型, , 组合框X_2

.如果真 (等于 (参数1, 1))
    .如果真 (大于 (参数2, .现行选中项))
        信息框 (相加 (“这个年级好像没有”, 到文本 (参数3), “班”), #错误图标, “出错了....”)
        返回 (0)
    .如果真结束
    
.如果真结束
.如果真 (等于 (参数1, 2))
    .如果真 (大于 (参数2, .现行选中项))
        信息框 (相加 (“这个年级好像没有”, 到文本 (参数3), “班”), #错误图标, “出错了....”)
        返回 (0)
    .如果真结束
    
.如果真结束
.如果真 (等于 (参数1, 3))
    .如果真 (大于 (参数2, .现行选中项))
        信息框 (相加 (“这个年级好像没有”, 到文本 (参数3), “班”), #错误图标, “出错了....”)
        返回 (0)
    .如果真结束
    
.如果真结束
.如果真 (等于 (参数1, 4))
    .如果真 (大于 (参数2, .现行选中项))
        信息框 (相加 (“这个年级好像没有”, 到文本 (参数3), “班”), #错误图标, “出错了....”)
        返回 (0)
    .如果真结束
    
.如果真结束
.如果真 (等于 (参数1, 5))
    .如果真 (大于 (参数2, .现行选中项))
        信息框 (相加 (“这个年级好像没有”, 到文本 (参数3), “班”), #错误图标, “出错了....”)
        返回 (0)
    .如果真结束
    
.如果真结束
.如果真 (等于 (参数1, 6))
    .如果真 (大于 (参数2, .现行选中项))
        信息框 (相加 (“这个年级好像没有”, 到文本 (参数3), “班”), #错误图标, “出错了....”)
        返回 (0)
    .如果真结束
    
.如果真结束
返回 (参数3)


.子程序 _组合框1_3_列表项被选择, 空白型, , 判断是否设置重复课程


.子程序 _组合框2_3_列表项被选择, 空白型, , 


.子程序 _组合框3_3_列表项被选择, 空白型, , 


.子程序 _组合框4_3_列表项被选择, 空白型, , 


.子程序 _组合框5_3_列表项被选择, 空白型, , 


.子程序 _组合框6_3_列表项被选择, 空白型, , 


.子程序 _组合框7_3_列表项被选择, 空白型, , 


.子程序 _组合框8_3_列表项被选择, 空白型, , 


.子程序 _组合框9_3_列表项被选择, 空白型, , 


.子程序 _组合框10_3_列表项被选择, 空白型, , 
 ' .如果真 (不等于 (组合框状态 [10], .现行选中项))
     ' 组合框10_3.现行选中项 ＝ 检查课程是否重复程序 (组合框10_1.现行选中项, 组合框10_2.现行选中项, 组合框10_3.现行选中项)
.如果真结束


.子程序 _组合框11_3_列表项被选择, 空白型, , 
 ' .如果真 (不等于 (.现行选中项, 0))
     ' 组合框状态 [11] ＝ 真
     ' 组合框11_3.现行选中项 ＝ 检查课程是否重复程序 (组合框11_1.现行选中项, 组合框11_2.现行选中项, 组合框11_3.现行选中项)
.如果真结束


.子程序 检查课程是否重复程序, 整数型, , 检查课程是否重复设置
.参数 年级, 整数型, , 年级
.参数 班级, 整数型, , 班级
.参数 课程, 整数型, , 课程

.如果 (等于 (组合框状态 [年级] [班级], 课程))
    返回 (课程)
.否则
    赋值 (检查课程 [年级] [班级] [组合框状态] [年级] [班级], 假)
.如果结束

.如果 (等于 (检查课程 [年级] [班级] [课程], 真))
    信息框 (“本班级同类课程已设置！”, #信息图标, “出错了...”)
    返回 (0)
.否则
    赋值 (检查课程 [年级] [班级] [课程], 真)
.如果结束
返回 (课程)

未知函数_1869 () ' *** 缩略程序块 ***
 ' .如果真 (等于 (课程, 1)) ' 语文
    
.如果真结束
 ' .如果真 (等于 (课程, 2)) ' 数学
    
.如果真结束
 ' .如果真 (等于 (课程, 3)) ' 英语
    
.如果真结束
 ' .如果真 (等于 (课程, 4)) ' 作文
    
.如果真结束
 ' .如果真 (等于 (课程, 5)) ' 美术
    
.如果真结束
 ' .如果真 (等于 (课程, 6)) ' 体育
    
.如果真结束
 ' .如果真 (等于 (课程, 7)) ' 思品
    
.如果真结束
 ' .如果真 (等于 (课程, 8)) ' 音乐
    
.如果真结束
 ' .如果真 (等于 (课程, 9)) ' 劳技
    
.如果真结束
 ' .如果真 (等于 (课程, 10)) ' 文体
    
.如果真结束
 ' .如果真 (等于 (课程, 11)) ' 自然
    
.如果真结束
 ' .如果真 (等于 (课程, 12)) ' 社会
    
.如果真结束
 ' .如果真 (等于 (课程, 13)) ' 科技
    
.如果真结束
 ' .如果真 (等于 (课程, 14)) ' 班队
    
.如果真结束
 ' .如果真 (等于 (课程, 15)) ' 写字
    
.如果真结束
 ' .如果真 (等于 (课程, 16)) ' 说话
    
.如果真结束
 ' .如果真 (等于 (课程, 17)) ' 校本
    
.如果真结束
 ' .如果真 (等于 (课程, 18)) ' 生物
    
.如果真结束
 ' .如果真 (等于 (课程, 19)) ' 地理
    
.如果真结束
 ' .如果真 (等于 (课程, 20)) ' 化学
    
.如果真结束
 ' .如果真 (等于 (课程, 21)) ' 历史
    
.如果真结束
 ' .如果真 (等于 (课程, 22)) ' 生命与健康
    
.如果真结束
 ' .如果真 (等于 (课程, 23)) ' 信息技术
    
.如果真结束


.窗口程序集 总课表窗口程序集, , , 思娇屠虎　制作，QQ：84651849 E-mail:tashihake@163.com

.程序集变量 特殊, 逻辑型, , "10", 记录各种特殊选项
.程序集变量 错误信息, 文本型, , , 记录出错信息。
.程序集变量 文件名, 文本型, , , 
.程序集变量 班级位置, 整数型, , "6,10", 记录各班级在表格中的行数
.程序集变量 表格位置, 整数型, , "20,30", 记录表格位置，用来判定此处是否已写数据"20个班，30节课"
.程序集变量 个人总节次, 整数型, , "40", 记录个人总节次，共可记录40个
.程序集变量 计次数, 整数型, , "25", 前21用来记录班级信息，22、23用来记录排课信息,24用来记录人员,25记录语数课的安排
.程序集变量 条件, 逻辑型, , "2", 用来判断是否出错，退出
.子程序 _总课表窗口_创建完毕, 空白型, , 
.局部变量 a, 整数型, , , 

赋值 (总课表窗口., 真)
 ' 表格的一些属性设置
赋值 (总课表信息, 真)
总课表窗口.调整层次 (#顶层)
未知函数_718 () ' *** 缩略程序块 ***
 ' 高级表格1.是否可编辑 ＝ 真
 ' 高级表格1.允许选择块 ＝ 真
 ' 高级表格1.显示打印对话框 ＝ 真
 ' 高级表格1.显示打印按钮 ＝ 真
 ' 高级表格1.回车键功能 ＝ 0
 ' 高级表格1.表格线颜色 ＝ #黑色
 ' 高级表格1.背景颜色 ＝ #白色
 ' 高级表格1.文字颜色 ＝ #黑色
 ' 高级表格1.点燃色 ＝ #黑色
 ' 高级表格1.表格线宽度 ＝ 1
 ' 高级表格1.表头行数 ＝ 0
 ' 高级表格1.表头列数 ＝ 0
 ' 高级表格1.打印页码 ＝ 0
 ' 高级表格1.打印日期 ＝ 0
 ' 高级表格1.行数 ＝ 1
 ' 高级表格1.列数 ＝ 8
 ' _启动窗口.打印机1.
总课表窗口.移动 (相除 (相减 (取屏幕宽度 (), 900), 2), 110, 900, 600)
_启动窗口.置文本 (., 3, “总课表向导”)
.如果真 (不等于 (学校全称, “”))
    读取信息 (学校全称)
.如果真结束
.如果真 (文件是否存在 (相加 (取运行目录 (), “\PKZSxtpz.ini”)))
    .计次循环首 (20, a)
        .如果真 (不等于 (取文本长度 (读配置项 (相加 (取运行目录 (), “\PKZSxtpz.ini”), “学校”, 相加 (“XXPZ”, 到文本 (a)), )), 0))
            读配置项 (相加 (取运行目录 (), “\PKZSxtpz.ini”), “学校”, 相加 (“XXPZ”, 到文本 (a)), ).加入项目 ()
        .如果真结束
        
    .计次循环尾 ()
.如果真结束


.子程序 _总课表窗口_位置被改变, 空白型, , 
.如果真 (等于 (总课表窗口., 2))
    赋值 (总课表窗口., 真)
    总课表窗口.移动 (相加 (_启动窗口., 10), 相减 (_启动窗口., 60), , )
    赋值 (总课表窗口., 假)
.如果真结束
.如果真 (等于 (总课表窗口., 0))
    赋值 (总课表窗口., 假)
    总课表窗口.调整层次 (#顶层)
    赋值 (总课表窗口., 真)
.如果真结束


.子程序 _总课表窗口_尺寸被改变, 空白型, , 
4.移动 (20, 相减 (总课表窗口., 13), 相减 (总课表窗口., 55))
10.移动 (15, 相减 (.宽度, 20), 40)
3.移动 (60, 相减 (.宽度, 8), 相减 (.高度, 63))
相减 (总课表窗口., 取整 (相除 (总课表窗口., 5))).移动 (5, 120, 20)


.子程序 _总课表窗口_将被销毁, 空白型, , 
赋值 (总课表信息, 假)
赋值 (学校全称, “”)
_启动窗口.置文本 (., 1, 学校全称)
_启动窗口.置文本 (., 3, “”)

.子程序 _载入文档, 空白型, , 
读取信息 ()

.子程序 _学校组合框_列表项被选择, 空白型, , 
.局部变量 文本, 文本型, , "5", 

.如果真 (等于 (.现行选中项, -1))
    返回 ()
.如果真结束
.如果 (等于 (文件是否存在 (相加 (取运行目录 (), “\”, .内容, “.kba”)), 真))
    相加 (取运行目录 (), “\”, .内容, “.kba”).未知支持库函数_56 ()
.否则
    读取信息 (.内容)
.如果结束

赋值 (学校全称, .内容)
 ' 设置表头文字
赋值 (文本 [1], 相加 (取运行目录 (), “\”, 学校全称, “.kbb”))
赋值 (文本 [4], 读配置项 (文本 [1], “基本情况”, “填置时间”, ))
赋值 (文本 [2], 取文本中间 (文本 [4], 7, 2))
.如果 (或者 (等于 (文本 [2], “12”), 等于 (文本 [2], “11”), 等于 (文本 [2], “10”), 等于 (文本 [2], “09”), 等于 (文本 [2], “08”), 等于 (文本 [2], “07”), 等于 (到整数 (文本 [2]), 7), 等于 (到整数 (文本 [2]), 8), 等于 (到整数 (文本 [2]), 9)))
    赋值 (文本 [3], “年下学期”)
.否则
    赋值 (文本 [3], “年上学期”)
.如果结束
赋值 (.标题, 相加 (学校全称, 取文本中间 (文本 [4], 1, 4), 文本 [3], “总课表”))
.未知支持库函数_46 (.标题, “黑体”, 30, 真, 2)
赋值 (总课表信息, 真)
_启动窗口.置文本 (., 1, 学校全称)


.子程序 读取信息, 空白型, , 
.参数 参数1, 文本型, 可空, 学校名称

.局部变量 文本, 文本型, , , 

赋值 (_启动窗口..过滤器, “支持文件|*.kbb”)
.如果 (不等于 (参数1, “”))
    赋值 (文本, 相加 (取运行目录 (), “\”, 参数1, “.kbb”))
    赋值 (学校全称, 参数1)
.否则
    .如果真 (_启动窗口.打开 (.))
        赋值 (文本, _启动窗口..文件名)
        .如果真 (等于 (读配置项 (文本, “基本情况”, “学校名称”, ), “”)) ' 如果打开的是不支持的档案，则返回。
            信息框 (“错误的档案!”, #错误图标, “打开错误...”)
            返回 ()
        .如果真结束
        
    .如果真结束
    
.如果结束
.如果真 (等于 (文本, “”))
    返回 ()
.如果真结束
 ' 预置数组
数组清零 (个人总节次)
数组清零 (表格位置)
数组清零 (计次数)
重定义数组 (位置课程, 假, 6, 10, 40, 40)
赋值 (条件 [1], 假)
赋值 (条件 [2], 假)
赋值 (错误信息, “”)

赋值 (文件名, 文本) ' 置一个程序集变量
画小学课表 ()
取课程信息 (文本)
赋值 (总课表窗口., 相加 (“总课表 -- ”, 取文本中间 (文本, 相加 (倒找文本 (文本, “\”, , 假), 1), 相减 (倒找文本 (文本, “.k”, , 假), 倒找文本 (文本, “\”, , 假), 1))))

.子程序 画小学课表, 空白型, , 此课表为标准的小学课表，周一至周五，一天6节课
.局部变量 班级类, 文本型, , "10", 
.局部变量 班级总数, 整数型, , , 
.局部变量 变量, 整数型, , "2", 
.局部变量 课表方向, 逻辑型, , , 

 ' 设置一些表格参数
赋值 (班级类 [1], “1班”)
赋值 (班级类 [2], “2班”)
赋值 (班级类 [3], “3班”)
赋值 (班级类 [4], “4班”)
赋值 (班级类 [5], “5班”)
赋值 (班级类 [6], “6班”)
赋值 (班级类 [7], “7班”)
赋值 (班级类 [8], “8班”)
赋值 (班级类 [9], “9班”)
赋值 (班级类 [10], “10班”)
未知支持库函数_57 ()
赋值 (班级总数, 相加 (到整数 (读配置项 (文件名, “基本情况”, “班级数量”, )), 2)) ' 加2是因为表格前2行是表头
赋值 (变量 [1], 到整数 (读配置项 (文件名, “特殊情况”, “TS13”, )))
.如果真 (等于 (读配置项 (文件名, “特殊情况”, “TS12”, ), “0”))
    赋值 (课表方向, 真)
.如果真结束

 ' 设置课表的行数与列数和一些参数
未知函数_7363 () ' *** 缩略程序块 ***
赋值 (., 35)
.如果真 (不等于 (班级总数, 0))
    赋值 (., 班级总数)
.如果真结束
.如果 (等于 (课表方向, 真))
    赋值 (., 相乘 (变量 [1], 14))
    赋值 (., 24)
.否则
    赋值 (., 相乘 (变量 [1], 14))
    赋值 (., 24)
.如果结束
0.未知支持库函数_25 (0, ., ., #.)
0.未知支持库函数_42 (0, ., ., 真)
 ' 画课表表格
未知函数_2321 () ' *** 缩略程序块 ***
赋值 (变量 [2], 相减 (., 1))
0.未知支持库函数_31 (24)
0.未知支持库函数_58 (1, 0, 6)
0.未知支持库函数_9 (1, #., “星 期 一”)
0.未知支持库函数_58 (8, 0, 13)
0.未知支持库函数_9 (8, #., “星 期 二”)
0.未知支持库函数_58 (15, 0, 20)
0.未知支持库函数_9 (15, #., “星 期 三”)
0.未知支持库函数_58 (22, 0, 27)
0.未知支持库函数_9 (22, #., “星 期 四”)
0.未知支持库函数_58 (29, 0, 34)
0.未知支持库函数_9 (29, #., “星 期 五”)
1.未知支持库函数_31 (24)
1.未知支持库函数_58 (1, 1, 3)
1.未知支持库函数_9 (1, #., “上 午”)
1.未知支持库函数_58 (4, 1, 6)
1.未知支持库函数_9 (4, #., “下 午”)
1.未知支持库函数_58 (8, 1, 10)
1.未知支持库函数_9 (8, #., “上 午”)
1.未知支持库函数_58 (11, 1, 13)
1.未知支持库函数_9 (11, #., “下 午”)
1.未知支持库函数_58 (15, 1, 17)
1.未知支持库函数_9 (15, #., “上 午”)
1.未知支持库函数_58 (18, 1, 20)
1.未知支持库函数_9 (18, #., “下 午”)
1.未知支持库函数_58 (22, 1, 24)
1.未知支持库函数_9 (22, #., “上 午”)
1.未知支持库函数_58 (25, 1, 27)
1.未知支持库函数_9 (25, #., “下 午”)
1.未知支持库函数_58 (29, 1, 31)
1.未知支持库函数_9 (29, #., “上 午”)
1.未知支持库函数_58 (32, 1, 34)
1.未知支持库函数_9 (32, #., “下 午”)
0.未知支持库函数_58 (0, 1, 0)
0.未知支持库函数_58 (7, 变量 [2], 7)
0.未知支持库函数_58 (14, 变量 [2], 14)
0.未知支持库函数_58 (21, 变量 [2], 21)
0.未知支持库函数_58 (28, 变量 [2], 28)
 ' 读入并写入相关的数据
 ' 读入并写入一年级相关数据
赋值 (变量 [2], 到整数 (读配置项 (文件名, “基本情况”, “NJ1”, )))
.如果 (等于 (变量 [2], 1))
    2.未知支持库函数_9 (0, #., “一年级”)
    赋值 (班级总数, 3)
    赋值 (班级位置 [1] [1], 相减 (班级总数, 1))
.否则
    .计次循环首 (变量 [2], 变量 [2])
        相加 (变量 [2], 1).未知支持库函数_9 (0, #., 相加 (“一”, 班级类 [变量] [2]))
        赋值 (班级总数, 相加 (变量 [2], 2))
        赋值 (班级位置 [1] [变量] [2], 相减 (班级总数, 1))
    .计次循环尾 ()
.如果结束
 ' 读入并写入二年级相关数据
赋值 (变量 [2], 到整数 (读配置项 (文件名, “基本情况”, “NJ2”, )))
.如果 (等于 (变量 [2], 1))
    班级总数.未知支持库函数_9 (0, #., “二年级”)
    赋值 (班级总数, 相加 (班级总数, 1))
    赋值 (班级位置 [2] [1], 相减 (班级总数, 1))
.否则
    .计次循环首 (变量 [2], 变量 [2])
        班级总数.未知支持库函数_9 (0, #., 相加 (“二”, 班级类 [变量] [2]))
        赋值 (班级总数, 相加 (班级总数, 1))
        赋值 (班级位置 [2] [变量] [2], 相减 (班级总数, 1))
    .计次循环尾 ()
.如果结束

 ' 读入并写入三年级相关数据
赋值 (变量 [2], 到整数 (读配置项 (文件名, “基本情况”, “NJ3”, )))
.如果 (等于 (变量 [2], 1))
    班级总数.未知支持库函数_9 (0, #., “三年级”)
    赋值 (班级总数, 相加 (班级总数, 1))
    赋值 (班级位置 [3] [1], 相减 (班级总数, 1))
.否则
    .计次循环首 (变量 [2], 变量 [2])
        班级总数.未知支持库函数_9 (0, #., 相加 (“三”, 班级类 [变量] [2]))
        赋值 (班级总数, 相加 (班级总数, 1))
        赋值 (班级位置 [3] [变量] [2], 相减 (班级总数, 1))
    .计次循环尾 ()
.如果结束

 ' 读入并写入四年级相关数据
赋值 (变量 [2], 到整数 (读配置项 (文件名, “基本情况”, “NJ4”, )))
.如果 (等于 (变量 [2], 1))
    班级总数.未知支持库函数_9 (0, #., “四年级”)
    赋值 (班级总数, 相加 (班级总数, 1))
    赋值 (班级位置 [4] [1], 相减 (班级总数, 1))
.否则
    .计次循环首 (变量 [2], 变量 [2])
        班级总数.未知支持库函数_9 (0, #., 相加 (“四”, 班级类 [变量] [2]))
        赋值 (班级总数, 相加 (班级总数, 1))
        赋值 (班级位置 [4] [变量] [2], 相减 (班级总数, 1))
    .计次循环尾 ()
.如果结束

 ' 读入并写入五年级相关数据
赋值 (变量 [2], 到整数 (读配置项 (文件名, “基本情况”, “NJ5”, )))
.如果 (等于 (变量 [2], 1))
    班级总数.未知支持库函数_9 (0, #., “五年级”)
    赋值 (班级总数, 相加 (班级总数, 1))
    赋值 (班级位置 [5] [1], 相减 (班级总数, 1))
.否则
    .计次循环首 (变量 [2], 变量 [2])
        班级总数.未知支持库函数_9 (0, #., 相加 (“五”, 班级类 [变量] [2]))
        赋值 (班级总数, 相加 (班级总数, 1))
        赋值 (班级位置 [5] [变量] [2], 相减 (班级总数, 1))
    .计次循环尾 ()
.如果结束

 ' 读入并写入六年级相关数据
赋值 (变量 [2], 到整数 (读配置项 (文件名, “基本情况”, “NJ6”, )))
.如果 (等于 (变量 [2], 1))
    班级总数.未知支持库函数_9 (0, #., “六年级”)
    赋值 (班级总数, 相加 (班级总数, 1))
    赋值 (班级位置 [6] [1], 相减 (班级总数, 1))
.否则
    .计次循环首 (变量 [2], 变量 [2])
        班级总数.未知支持库函数_9 (0, #., 相加 (“六”, 班级类 [变量] [2]))
        赋值 (班级总数, 相加 (班级总数, 1))
        赋值 (班级位置 [6] [变量] [2], 相减 (班级总数, 1))
    .计次循环尾 ()
.如果结束


.子程序 取课程信息, 空白型, , 有点难度，搞我的头痛好几天
.参数 要打开的文件, 文本型, , 要打开的文件名

.局部变量 教师信息, 文本型, , "40", 最多包含40人次
.局部变量 预读信息, 文本型, , "11", 每人最多可有11个科目的课程
.局部变量 课程信息, 文本型, , "4", 包括：年级、班级、科目、节次
.局部变量 变量, 整数型, , "5", 
.局部变量 计次, 整数型, , "5", 

 ' 读入特殊情况
未知函数_1699 () ' *** 缩略程序块 ***
.如果 (等于 (到整数 (读配置项 (要打开的文件, “特殊情况”, “TS1”, )), 1)) ' 副课不排第一节
    赋值 (特殊 [1], 真)
.否则
    赋值 (特殊 [1], 假)
.如果结束
.如果 (等于 (到整数 (读配置项 (要打开的文件, “特殊情况”, “TS2”, )), 1)) ' 作文课连一起
    赋值 (特殊 [2], 真)
.否则
    赋值 (特殊 [2], 假)
.如果结束
.如果 (等于 (到整数 (读配置项 (要打开的文件, “特殊情况”, “TS3”, )), 1)) ' 班队课排同一堂
    赋值 (特殊 [3], 真)
.否则
    赋值 (特殊 [3], 假)
.如果结束
.如果 (等于 (到整数 (读配置项 (要打开的文件, “特殊情况”, “TS4”, )), 1)) ' 体育课不可同堂
    赋值 (特殊 [4], 真)
.否则
    赋值 (特殊 [4], 假)
.如果结束
.如果 (等于 (到整数 (读配置项 (要打开的文件, “特殊情况”, “TS5”, )), 1)) ' 音乐课不可同堂
    赋值 (特殊 [5], 真)
.否则
    赋值 (特殊 [5], 假)
.如果结束
.如果 (等于 (到整数 (读配置项 (要打开的文件, “特殊情况”, “TS6”, )), 1)) ' 信息技术课不可同堂
    赋值 (特殊 [6], 真)
.否则
    赋值 (特殊 [6], 假)
.如果结束

 ' .如果真 (等于 (到整数 (读配置项 (要打开的文件, “特殊本情况”, “TS7”, )), 1)) ' 其它
     ' 特殊 [7] ＝ 真
.如果真结束
 ' .如果真 (等于 (读配置项 (要打开的文件, “特殊本情况”, “TS8”, ), “1”)) ' 其它
     ' 特殊 [8] ＝ 真
.如果真结束
 ' .如果真 (等于 (读配置项 (要打开的文件, “特殊本情况”, “TS9”, ), “1”)) ' 其它
     ' 特殊 [9] ＝ 真
.如果真结束

赋值 (计次数 [24], 1)
赋值 (教师姓名, 分割文本 (读配置项 (要打开的文件, “基本情况”, “教师姓名”, ), “,”, ))
赋值 (变量 [5], 取数组下标 (教师姓名, ))
 ' 判定课程及安排课程
.计次循环首 (变量 [5], 变量 [1]) ' 读入教师授课信息
    .如果真 (等于 (条件 [1], 真))
        信息框 (错误信息, #信息图标, “出错了...”)
        跳出循环 ()
    .如果真结束
    .如果真 (不等于 (教师姓名 [变量] [1], “”))
        赋值 (计次数 [24], 相加 (计次数 [24], 1))
        赋值 (教师信息 [计次数] [24], 读配置项 (要打开的文件, 教师姓名 [变量] [1], “RJKM”, ))
        赋值 (预读信息, 分割文本 (教师信息 [计次数] [24], “;”, ))
        .计次循环首 (11, 变量 [2]) ' 取出的数据为：年级、班级、科目、节次。
            .如果真 (等于 (条件 [1], 真))
                跳出循环 ()
            .如果真结束
            赋值 (课程信息, 分割文本 (预读信息 [变量] [2], “,”, ))
             ' 课程信息 [1]  年级   ' 课程信息 [2]   班级
             ' 课程信息 [3]  科目   ' 课程信息 [4]   节次
            .如果真 (不等于 (到整数 (课程信息 [1]), 0)) ' 如果不为空就读信息
                赋值 (计次 [2], 相加 (计次 [2], 1))
                .如果真 (不等于 (到整数 (课程信息 [4]), 0)) ' 如果节次不为0就读出相关数据
                    .计次循环首 (到整数 (课程信息 [4]), 计次 [3])
                        赋值 (个人总节次 [计次数] [24], 相加 (个人总节次 [计次数] [24], 1))
                        .如果 (大于 (计次数 [24], 40)) ' 容错处理
                            赋值 (错误信息, 相加 (“教师人数安排过多，”, #换行符, “本测试版本最多只支持40人”, #换行符))
                            赋值 (条件 [1], 真)
                            跳出循环 () ' 万一出错就停止，不至于出现程序错误
                        .否则
                            赋值 (个人课程 [计次数] [24] [个人总节次] [计次数] [24] [到整数 (课程信息 [1])] [到整数 (课程信息 [2])], 课程信息 [3])
                             ' ------ 人　  　　　节次
                             ' 记录下，第几人、第几节，几年级、几班是什么课
                             ' 以下程序段为把课程写入课表
                            .如果 (或者 (等于 (课程信息 [3], “语文”), 等于 (课程信息 [3], “数学”)))
                                赋值 (特殊 [10], 真)
                            .否则
                                赋值 (特殊 [10], 假)
                            .如果结束
                            排课表程序 (到整数 (课程信息 [1]), 到整数 (课程信息 [2]), 个人课程 [计次数] [24] [个人总节次] [计次数] [24] [到整数 (课程信息 [1])] [到整数 (课程信息 [2])], 特殊 [10])
                        .如果结束
                        
                    .计次循环尾 ()
                .如果真结束
                
            .如果真结束
            .如果真 (大于或等于 (变量 [2], 11)) ' 如果一个人的读完了就归0，为下一个作好准备
                赋值 (计次 [2], 0)
            .如果真结束
            
        .计次循环尾 ()
    .如果真结束
    
.计次循环尾 ()
 ' 显示相关数据
赋值 (.标题, 相加 (“ 已排:”, 到文本 (相减 (计次数 [24], 1)), “人  共”, 到文本 (计次数 [22]), “节”))

.子程序 排课表程序, 空白型, , 把课排到课表中
.参数 年级, 整数型, , 年级数
.参数 班级, 整数型, , 班级数
.参数 课程, 文本型, , 要排的课
.参数 课型, 逻辑型, , 正副课

.局部变量 a, 整数型, , , 
.局部变量 b, 整数型, , , 

 ' 这一段真难想，搞的我头痛。代码改了N次，这次终于把排课速度提高了N倍。代码的结构还是非常重要的！哈。。。
 ' 此段代码为核心部份，我实在是水平有限，搞了几天，弄的我头痛，所以弄的一塌糊涂
 ' 所以大家见到的这些，只是一个模型。离真正意义上的程序还差天远
赋值 (b, 班级位置 [年级] [班级])

.判断循环首 (真) ' 判定是否为重复选取
    处理事件 ()
    赋值 (计次数 [21], 多项选择 (取随机数 (1, 30), 1, 2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 20, 22, 23, 24, 25, 26, 27, 29, 30, 31, 32, 33, 34)) ' 取出节次位置
    .计次循环首 (计次数 [b], a)
        .如果真 (等于 (表格位置 [b] [a], 计次数 [21])) ' 如果重复就重取
            赋值 (条件 [2], 真)
            跳出循环 ()
        .如果真结束
        赋值 (计次数 [23], 相加 (计次数 [23], 1)) ' 计算循环次数
        .如果真 (大于 (计次数 [23], 50000)) ' 如果循环次数大于50000就报错，以免进入死循环。
            赋值 (条件 [1], 真)
            赋值 (条件 [2], 假)
            错误信息 ＝ 到文本 (年级) ＋ “年级” ＋ 到文本 (班级) ＋ “班课程安排有误” ＋ #换行符 ＋ “可能安排的课时已超过30节次” ＋ #换行符 ＋ “请试一下重排”
            跳出循环 ()
        .如果真结束
        赋值 (条件 [2], 假)
    .计次循环尾 ()
    .如果真 (等于 (条件 [2], 假)) ' 如果没有重复就跳出，进行下一步
        跳出循环 ()
    .如果真结束
    
.判断循环尾 ()


未知函数_768 () ' *** 缩略程序块 ***
 ' .如果真 (并且 (等于 (特殊 [1], 真), 等于 (课型, 真))) ' 副课不排第一节,语数课时
    
.如果真结束
 ' .如果真 (并且 (等于 (特殊 [1], 真), 等于 (课型, 假))) ' 副课不排第一节，非语数课时
    
.如果真结束
 ' .如果真 (等于 (特殊 [2], 真)) ' 作文课连一起
    
.如果真结束
 ' .如果真 (等于 (特殊 [3], 真)) ' 班队课排同一堂
    
.如果真结束
 ' .如果真 (等于 (特殊 [4], 真)) ' 体育课不可同堂
    
.如果真结束
 ' .如果真 (等于 (特殊 [5], 真)) ' 音乐课不可同堂
    
.如果真结束
 ' .如果真 (等于 (特殊 [6], 真)) ' 信息技术课不可同堂
    
.如果真结束


赋值 (计次数 [22], 相加 (计次数 [22], 1)) ' 计算已安排节次
赋值 (计次数 [b], 相加 (计次数 [b], 1))
.如果 (小于 (计次数 [b], 31)) ' 容错处理
    赋值 (表格位置 [b] [计次数] [b], 计次数 [21])
    b.未知支持库函数_9 (计次数 [21], 1, 课程)
    赋值 (位置课程 [年级] [班级] [计次数] [21] [相减 (计次数 [24], 1)], 课程) ' 记录下课表位置上的课程
     ' ------  年级　班级　　列　　　　　　人            课程
.否则
    赋值 (条件 [1], 真)
.如果结束


.子程序 _预览程序, 空白型, , 
 ' _启动窗口.打印机.开始打印 (, , #A4纸, #横向, , )
 ' _启动窗口.打印机.置自定义纸张类型 (, , , , , , )

赋值 (_启动窗口..顶边空, 250)
赋值 (_启动窗口..左边空, 200)
赋值 (_启动窗口..右边空, 200)
未知支持库函数_27 ()


.子程序 _打印程序, 空白型, , 
 ' 打印机1.置自定义纸张类型 (, , , , , , )
 ' 打印机1.开始打印 (, , #A4纸, #横向, , )

未知支持库函数_26 ()



.子程序 _其它按钮_被单击, 空白型, , 
_载入文档 ()

.子程序 _重排按钮_被单击, 空白型, , 
连续赋值 (真, .禁止, .禁止, .禁止)
读取信息 (.内容)

赋值 (功能变量 [2], 真) ' 防止你们不停的点，造成出错

.子程序 _保存按钮_被单击, 空白型, , 
.局部变量 计次, 整数型, , "5", 

.如果 (等于 (.现行选中项, -1))
    返回 ()
.否则
    相加 (取运行目录 (), “\”, 学校全称, “.kba”).未知支持库函数_55 ()
    信息框 (“保存成功！”, #信息图标, “成功...”)
.如果结束


.窗口程序集 系统设置程序集, , , 思娇屠虎　制作，QQ：84651849 E-m参数il:tashihake@163.com

.程序集变量 打开图片, 字节集, , , 
.子程序 _系统设置窗口_创建完毕, 空白型, , 
系统设置窗口.调整层次 (#顶层)
.如果真 (等于 (_启动窗口..选中, 真))
    赋值 (.选中, 真)
.如果真结束
.如果真 (等于 (_启动窗口..选中, 真))
    赋值 (.选中, 真)
.如果真结束
.如果真 (等于 (_启动窗口..选中, 真))
    赋值 (.选中, 真)
.如果真结束
.如果真 (等于 (_启动窗口..选中, 真))
    赋值 (.选中, 真)
.如果真结束
.如果真 (等于 (_启动窗口..选中, 假))
    赋值 (.选中, 真)
.如果真结束

赋值 (.现行选中项, 0)

.子程序 _取消按钮_被单击, 空白型, , 
系统设置窗口.销毁 ()
_启动窗口.调整层次 (#顶层)
.如果真 (等于 (总课表信息, 真))
    总课表窗口.调整层次 (#顶层)
.如果真结束


.子程序 _确定按钮_被单击, 空白型, , 
.局部变量 图片类, 整数型, , , 
.局部变量 显示类, 整数型, , , 

.如果真 (等于 (.选中, 真))
    赋值 (打开图片, {  })
    赋值 (_启动窗口..图片, {  })
    连续赋值 (假, _启动窗口..选中, _启动窗口..选中, _启动窗口..选中)
    写配置项 (相加 (取运行目录 (), “\PKZSxtpz.ini”), “SYSTEM”, “BJYY”, )
    赋值 (图片类, 0)
.如果真结束
.如果真 (等于 (.选中, 真))
    赋值 (_启动窗口..显示方式, 0)
    赋值 (_启动窗口..选中, 真)
    连续赋值 (假, _启动窗口..选中, _启动窗口..选中)
    赋值 (图片类, 1)
.如果真结束
.如果真 (等于 (.选中, 真))
    赋值 (_启动窗口..显示方式, 2)
    赋值 (_启动窗口..选中, 真)
    连续赋值 (假, _启动窗口..选中, _启动窗口..选中)
    赋值 (图片类, 3)
.如果真结束
.如果真 (等于 (.选中, 真))
    赋值 (_启动窗口..显示方式, 1)
    赋值 (_启动窗口..选中, 真)
    连续赋值 (假, _启动窗口..选中, _启动窗口..选中)
    赋值 (图片类, 2)
.如果真结束
.如果真 (等于 (.选中, 真))
    赋值 (打开图片, {  })
    赋值 (_启动窗口..显示方式, 1)
    赋值 (图片类, 2)
    赋值 (.内容, “”)
    赋值 (_启动窗口..图片, #图片1)
    赋值 (_启动窗口..选中, 真)
    连续赋值 (假, _启动窗口..选中, _启动窗口..选中)
    写配置项 (相加 (取运行目录 (), “\PKZSxtpz.ini”), “SYSTEM”, “BJYY”, )
.如果真结束
.如果真 (不等于 (打开图片, {  }))
    赋值 (_启动窗口..图片, 打开图片)
.如果真结束
.如果真 (等于 (.选中, 真))
    停止播放 ()
.如果真结束
写配置项 (相加 (取运行目录 (), “\PKZSxtpz.ini”), “SYSTEM”, “XSFS”, 到文本 (图片类))
写配置项 (相加 (取运行目录 (), “\PKZSxtpz.ini”), “SYSTEM”, “XSFG”, 到文本 (显示类))
.如果真 (不等于 (.内容, “”))
    写配置项 (相加 (取运行目录 (), “\PKZSxtpz.ini”), “SYSTEM”, “BJYY”, .内容)
.如果真结束

系统设置窗口.销毁 ()
_启动窗口.调整层次 (#顶层)
.如果真 (等于 (总课表信息, 真))
    总课表窗口.调整层次 (#顶层)
.如果真结束


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 文件号, 整数型, , , 

赋值 (_启动窗口..过滤器, “所有支持图片|*.jpg;*.bmp;*.jpge;*.jpe;*.gif”)
.如果真 (_启动窗口.打开 (.))
    赋值 (.内容, _启动窗口..文件名)
    赋值 (文件号, 打开文件 (_启动窗口..文件名, , ))
    赋值 (打开图片, 读入字节集 (文件号, 取文件长度 (文件号)))
    关闭文件 (文件号)
.如果真结束


.子程序 _音乐2_被单击, 空白型, , 
赋值 (_启动窗口..过滤器, “音乐文件|*.mp3”)
.如果 (等于 (_启动窗口.打开 (.), 真))
    播放MP3 (-1, _启动窗口..文件名) ' 不知道为什么有时候也出错
    赋值 (_启动窗口..选中, 真)
    写配置项 (相加 (取运行目录 (), “\PKZSxtpz.ini”), “SYSTEM”, “XTYY”, _启动窗口..文件名)
    写配置项 (相加 (取运行目录 (), “\PKZSxtpz.ini”), “SYSTEM”, “Player”, “1”)
.否则
    赋值 (.选中, 真)
    赋值 (.选中, 假)
.如果结束


.子程序 _音乐1_被单击, 空白型, , 
写配置项 (相加 (取运行目录 (), “\PKZSxtpz.ini”), “SYSTEM”, “Player”, “0”)
停止播放 ()

.窗口程序集 分课表程序集, , , 思娇屠虎　制作，QQ：84651849 E-m参数il:tashihake@163.com

.程序集变量 计次, 整数型, , "5", 
.子程序 _分课表窗口_创建完毕, 空白型, , 
赋值 (分课表信息, 真)
分课表窗口.移动 (100, 110, 850, 600)
分课表窗口.调整层次 (#顶层)
赋值 (.字体.字体大小, 24)

未知函数_817 () ' *** 缩略程序块 ***
 ' 分课表表格.是否可编辑 ＝ 真
 ' 分课表表格.允许选择块 ＝ 真
 ' 分课表表格.显示打印对话框 ＝ 真
 ' 分课表表格.显示打印按钮 ＝ 真
 ' 分课表表格.回车键功能 ＝ 1
 ' 分课表表格.表格线颜色 ＝ #黑色
 ' 分课表表格.背景颜色 ＝ #白色
 ' 分课表表格.文字颜色 ＝ #黑色
 ' 分课表表格.点燃色 ＝ #黑色
 ' 分课表表格.表格线宽度 ＝ 1
 ' 分课表表格.表头行数 ＝ 0
 ' 分课表表格.表头列数 ＝ 0
 ' 分课表表格.打印页码 ＝ 0
 ' 分课表表格.打印日期 ＝ 0
 ' 分课表表格.行数 ＝ 7
 ' 分课表表格.列数 ＝ 8
 ' 分课表表格.行高 ＝ 60
 ' 分课表表格.列宽 ＝ 100
绘制课程表 ()

.子程序 _分课表窗口_尺寸被改变, 空白型, , 
5.移动 (27, 相减 (取用户区宽度 (), 10), 相减 (取用户区高度 (), 34))
5.移动 (10, 相减 (取用户区宽度 (), 30), 40)
5.移动 (69, 相减 (取用户区宽度 (), 20), 相减 (.高度, 75))
相减 (取用户区宽度 (), 200).移动 (5, , )
相减 (取用户区宽度 (), 100).移动 (5, , )
相减 (.宽度, 取整 (相除 (.宽度, 5))).移动 (40, 150, 20)

.子程序 绘制课程表, 空白型, , 
.局部变量 b, 整数型, , , 
.局部变量 a, 整数型, , , 

 ' 加入教师姓名
“”.加入项目 ()
赋值 (b, 取数组下标 (教师姓名, ))
.如果真 (不等于 (b, 0))
    .计次循环首 (b, a)
        .如果真 (不等于 (教师姓名 [a], “”))
            教师姓名.加入项目 ( [a], )
        .如果真结束
        
    .计次循环尾 ()
.如果真结束

 ' 画课程表
0.未知支持库函数_25 (0, 6, 7, 2)
0.未知支持库函数_16 (0, 6, 7, “楷体_GB2312”)

0.未知支持库函数_18 (0, 6, 7, 24)
0.未知支持库函数_20 (0, 6, 7, 1)
0.未知支持库函数_35 (#.)
0.未知支持库函数_9 (0, #., #表头)

0.未知支持库函数_9 (1, 1, “1”)
0.未知支持库函数_9 (2, 1, “2”)
0.未知支持库函数_9 (3, 1, “3”)
0.未知支持库函数_9 (4, 1, “4”)
0.未知支持库函数_9 (5, 1, “5”)
0.未知支持库函数_9 (6, 1, “6”)
0.未知支持库函数_9 (7, 1, “7”)
1.未知支持库函数_9 (0, 1, “星期一”)
2.未知支持库函数_9 (0, 1, “星期二”)
3.未知支持库函数_9 (0, 1, “星期三”)
4.未知支持库函数_9 (0, 1, “星期四”)
5.未知支持库函数_9 (0, 1, “星期五”)
6.未知支持库函数_9 (0, 1, “星期六”)
.未知支持库函数_46 (.标题, “宋体”, 30, 真, 2)


.子程序 _按钮1_被单击, 空白型, , 
未知支持库函数_27 ()

.子程序 _按钮2_被单击, 空白型, , 
未知支持库函数_26 ()

.子程序 _分课表窗口_将被销毁, 空白型, , 
赋值 (分课表信息, 假)
.如果真 (等于 (总课表信息, 真))
    赋值 (总课表窗口., 0)
.如果真结束


.子程序 _姓名分组框_列表项被选择, 空白型, , 主要程序
.局部变量 临时文本, 文本型, , , 

1.未知支持库函数_62 (1, 6, 7)
1.未知支持库函数_18 (1, 6, 7, 14)
1.未知支持库函数_42 (1, 6, 7, 真)
1.未知支持库函数_20 (1, 6, 7, )
 ' 分课表表格.置字体名 (1, 1, 6, 7, “仿宋_GB2312”)
连续赋值 (1, 计次 [3], 计次 [4], 计次 [5])
.如果真 (等于 (取文本长度 (.内容), 0))
    赋值 (.标题, “”)
    返回 ()
.如果真结束
.计次循环首 (40, 计次 [1])
    .如果真 (等于 (教师姓名 [计次] [1], .内容))
        赋值 (临时文本, 教师姓名 [计次] [1])
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
.如果真 (等于 (取文本长度 (临时文本), 0))
    返回 ()
.如果真结束
.判断循环首 (真)
    赋值 (计次 [2], 相加 (计次 [2], 1))
    .如果真 (大于 (计次 [2], 6)) ' 年级
        赋值 (计次 [2], 1)
        赋值 (计次 [3], 相加 (计次 [3], 1))
    .如果真结束
    .如果真 (大于 (计次 [3], 10)) ' 班级
        赋值 (计次 [3], 1)
        赋值 (计次 [4], 相加 (计次 [4], 1))
    .如果真结束
    .如果真 (大于 (计次 [4], 40)) ' 列
        赋值 (计次 [4], 1)
        跳出循环 ()
    .如果真结束
    .如果真 (不等于 (取文本长度 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1]), 0))
        位置转换 (计次 [2], 计次 [3], 计次 [4])
        赋值 (计次 [5], 相加 (计次 [5], 1)) ' 记录节次
    .如果真结束
    
.判断循环尾 ()
赋值 (.标题, 相加 (“姓名：”, .内容, “   节次：”, 到文本 (相减 (计次 [5], 1))))

.子程序 位置转换, 空白型, , 程序列
.参数 年级, 整数型, , 年级
.参数 班级, 整数型, , 班级
.参数 列, 整数型, , 列

.局部变量 a, 整数型, , , 

.如果真 (等于 (列, 1))
    1.未知支持库函数_9 (1, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 2))
    1.未知支持库函数_9 (2, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 3))
    1.未知支持库函数_9 (3, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 4))
    1.未知支持库函数_9 (4, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 5))
    1.未知支持库函数_9 (5, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 6))
    1.未知支持库函数_9 (6, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 8))
    2.未知支持库函数_9 (1, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 9))
    2.未知支持库函数_9 (2, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 10))
    2.未知支持库函数_9 (3, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 11))
    2.未知支持库函数_9 (4, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 12))
    2.未知支持库函数_9 (5, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 13))
    2.未知支持库函数_9 (6, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 15))
    3.未知支持库函数_9 (1, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 16))
    3.未知支持库函数_9 (2, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 17))
    3.未知支持库函数_9 (3, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 18))
    3.未知支持库函数_9 (4, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 19))
    3.未知支持库函数_9 (5, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 20))
    3.未知支持库函数_9 (6, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 22))
    4.未知支持库函数_9 (1, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 23))
    4.未知支持库函数_9 (2, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 24))
    4.未知支持库函数_9 (3, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 25))
    4.未知支持库函数_9 (4, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 26))
    4.未知支持库函数_9 (5, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 27))
    4.未知支持库函数_9 (6, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 29))
    5.未知支持库函数_9 (1, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 30))
    5.未知支持库函数_9 (2, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 31))
    5.未知支持库函数_9 (3, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 32))
    5.未知支持库函数_9 (4, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 33))
    5.未知支持库函数_9 (5, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束
.如果真 (等于 (列, 34))
    5.未知支持库函数_9 (6, 1, 相加 (位置课程 [计次] [2] [计次] [3] [计次] [4] [计次] [1], #换行符, 到文本 (年级), “年级”, 到文本 (班级), “班”))
.如果真结束


.子程序 _按钮3_被单击, 空白型, , 
信息框 (“测试版本，暂不支持！”, #信息图标, “人不懒，没福享”)


.子程序 _分课表窗口_位置被改变, 空白型, , 
.如果真 (等于 (分课表窗口., 2))
    赋值 (分课表窗口., 真)
    分课表窗口.移动 (相加 (_启动窗口., 170), 相减 (_启动窗口., 60), , )
    赋值 (分课表窗口., 假)
.如果真结束
.如果真 (等于 (分课表窗口., 0))
    赋值 (分课表窗口., 假)
    分课表窗口.调整层次 (#顶层)
    赋值 (分课表窗口., 真)
.如果真结束




 ' 不属于任何一个程序集、类模块的函数：
