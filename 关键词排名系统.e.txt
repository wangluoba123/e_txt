 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 329
    高度 = 366
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “2010关键词排名查询系统 QQ:85321262”
    帮助文件名 = “”

窗口 关键词查询
    左边 = 50
    顶边 = 50
    宽度 = 814
    高度 = 521
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 真
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关键词查询”
    帮助文件名 = “”



.图片 托盘图片, " ' 已保存到：D:\易语言学习\Data\关键词排名系统.e\托盘图片", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' internet 707ca37322474f6ca841f0e224f4b620 2 0 互联网支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 3 0 应用接口支持库





.窗口程序集 窗口程序集1, , , 

.子程序 关键词显示, 空白型, , 
.计次循环首 (取记录数 (), )
    读 (“关键词”).加入项目 ()
    跳过 ()
.计次循环尾 ()

关闭 ()


.子程序 __启动窗口_创建完毕, 空白型, , 
打开 (“关键词排名系统.edb”, , , , , , )
关键词显示 ()

.子程序 _按钮添加_被单击, 空白型, , 

.如果 (等于 (.标题, “添加关键词”))
    打开 (“关键词排名系统.edb”, , , , , , )
    赋值 (.内容, “”)
    赋值 (.禁止, 假)
    获取焦点 ()
    赋值 (.标题, “保存关键词”)
.否则
    .如果 (等于 (.内容, “”))
        信息框 (“请添加关键词”, 0, )
    .否则
        打开 (“关键词排名系统.edb”, , , , , , )
        .计次循环首 (取记录数 (), )
            .如果 (等于 (读 (“关键词”), .内容))
                信息框 (相加 (.内容, “ 关键词不能重复添加”), 0, )
                返回 ()
            .否则
                
            .如果结束
            
            跳过 ()
            
        .计次循环尾 ()
        加记录 (.内容)
        
        赋值 (.标题, “添加关键词”)
        信息框 (相加 (“关键词 ”, .内容, “ 添加成功”), 0, )
        .加入项目 (.内容, )
        赋值 (.禁止, 真)
        关闭 ()
        
        
    .如果结束
    
.如果结束



.子程序 _列表框1_列表项被选择, 空白型, , 
 ' 赋值 (.内容, .取项目文本 (.现行选中项))

.子程序 _按钮删除_被单击, 空白型, , 
打开 (“关键词排名系统.edb”, , , , , , )
.计次循环首 (取记录数 (), )
    .如果 (等于 (读 (“关键词”), .内容))
        
        删除 ()
        彻底删除 ()
        .删除项目 (.现行选中项)
    .否则
        跳过 ()
    .如果结束
    
.计次循环尾 ()
关闭 ()

.子程序 _按钮删除1_被单击, 空白型, , 
.如果 (等于 (.内容, “”))
    信息框 (“请输入需要查询的网址”, 0, “警告”)
    获取焦点 ()
.否则
    赋值 (_启动窗口., 假)
     ' _启动窗口.销毁 ()
    载入 (关键词查询, , 假)
.如果结束



.窗口程序集 窗口程序集2, , , 

.程序集变量 关键词, 文本型, , "200", 
.程序集变量 词, 整数型, , , 
.程序集变量 源文件, 字节集, , , 
.程序集变量 网址, 文本型, , , 
.程序集变量 无排名, 整数型, , , 
.程序集变量 推广链接排名, 整数型, , , 
.程序集变量 十位推广排名, 整数型, , , 
.程序集变量 右侧排名, 整数型, , , 
.程序集变量 查询网址, 文本型, , , 
.程序集变量 数据个数, 整数型, , , 
.程序集变量 判断次数, 整数型, , , 
.程序集变量 自然排名, 整数型, , , 
.程序集变量 托盘标题, 文本型, , , 
.子程序 _关键词查询_创建完毕, 空白型, , 
.局部变量 n1, 整数型, , , 

打开 (“关键词排名系统.edb”, , , , , , )
.计次循环首 (取记录数 (), n1)
    赋值 (关键词 [n1], 读 (“关键词”))
    跳过 ()
.计次循环尾 ()
关闭 ()
赋值 (.内容, _启动窗口..内容)
 ' -------------------------------------------下面去空白关键词部分

赋值 (数据个数, 取数组成员数 (关键词))
赋值 (判断次数, 1)

去除空白关键字 ()
 ' -------------------------------------------空白关键词去除结尾
赋值 (.时钟周期, 3000)
赋值 (网址, “http://www.baidu.com/s?wd=”)
赋值 (查询网址, _启动窗口..内容)


.子程序 _按钮添加_被单击, 空白型, , 
.如果 (等于 (.标题, “添加关键词”))
    打开 (“关键词排名系统.edb”, , , , , , )
    赋值 (.内容, “”)
    赋值 (.禁止, 假)
    获取焦点 ()
    赋值 (.标题, “保存关键词”)
    赋值 (.标题, “请添加关键词：”)
.否则
    .如果 (等于 (.内容, “”))
        信息框 (“请添加关键词”, 0, )
    .否则
        打开 (“关键词排名系统.edb”, , , , , , )
        加记录 (.内容)
        
        赋值 (.标题, “添加关键词”)
        信息框 (相加 (“关键词 ”, .内容, “ 添加成功”), 0, )
         ' 加入成员 (关键词, .内容)
        赋值 (.禁止, 真)
        关闭 ()
        赋值 (.标题, “正查询关键词：”)
    .如果结束
    
.如果结束



.子程序 _时钟1_周期事件, 空白型, , 
.局部变量 竞价方式, 文本型, , , 
.局部变量 关键词个数, 整数型, , , 
.局部变量 内容, 文本型, , , 
.局部变量 是否找到, 整数型, , , 
.局部变量 前查找, 整数型, , , 
.局部变量 后查找, 整数型, , , 
.局部变量 排名, 文本型, , , 
.局部变量 推广方式, 文本型, , , 
.局部变量 排名类型, 文本型, , , 
.局部变量 页数, 整数型, , , 

赋值 (关键词个数, 取数组成员数 (关键词))
赋值 (词, 相加 (词, 1))
赋值 (排名类型, “自然排名”)
赋值 (源文件, 未知支持库函数_7 (相加 (网址, 关键词 [词], “&pn=”, 到文本 (相乘 (页数, 10)), “&usm=1”)))
赋值 (内容, 到文本 (源文件))
赋值 (是否找到, 寻找文本 (内容, 查询网址, , 假))

.判断循环首 (并且 (等于 (是否找到, -1), 小于 (页数, 50)))
    赋值 (页数, 相加 (页数, 1))
    赋值 (源文件, 未知支持库函数_7 (相加 (网址, 关键词 [词], “&pn=”, 到文本 (相乘 (页数, 10)), “&usm=1”)))
    赋值 (内容, 到文本 (源文件))
    赋值 (是否找到, 寻找文本 (内容, 查询网址, , 假))
    
.判断循环尾 ()

赋值 (.内容, 关键词 [词])
.如果 (等于 (是否找到, -1))
    赋值 (无排名, 相加 (无排名, 1))
    .插入表项 (到文本 (无排名), , , , )
    相减 (无排名, 1).置标题 (1, 关键词 [词])
    相减 (无排名, 1).置标题 (2, 到文本 (相加 (页数, 1)))
    相减 (无排名, 1).置标题 (3, “无排名”)
    
     ' 编辑框4.加入文本 (到文本 (无排名) ＋ “. ” ＋ 关键词 [词] ＋ “ 没有排名 ” ＋ #换行符)
.否则
    赋值 (前查找, 倒找文本 (到文本 (源文件), 相加 (“id=”, #引号), 是否找到, 假))
    赋值 (推广方式, 取文本中间 (内容, 相加 (前查找, 4), 2))
    .如果 (等于 (推广方式, “ta”))
        赋值 (前查找, 倒找文本 (到文本 (源文件), 相加 (“id=”, #引号, “taw”), 是否找到, 假))
        赋值 (后查找, 寻找文本 (到文本 (源文件), #引号, 前查找, 假))
        赋值 (排名, 取文本中间 (到文本 (源文件), 相加 (前查找, 7), 相减 (后查找, 前查找, 1)))
        赋值 (推广链接排名, 相加 (推广链接排名, 1))
        
        赋值 (排名, 到文本 (相加 (到数值 (排名), 1)))
        .插入表项 (到文本 (推广链接排名), , , , )
        相减 (推广链接排名, 1).置标题 (1, 关键词 [词])
        相减 (推广链接排名, 1).置标题 (2, 到文本 (相加 (页数, 1)))
        相减 (推广链接排名, 1).置标题 (3, 到文本 (排名))
         ' 编辑框1.加入文本 (到文本 (推广链接排名) ＋ “. ” ＋ 关键词 [词] ＋ “ 排名第 ” ＋ 到文本 (页数) ＋ “ 第 ” ＋ 排名 ＋ “ 位” ＋ #换行符)
    .否则
        .如果 (等于 (推广方式, “aw”))
            赋值 (前查找, 倒找文本 (到文本 (源文件), 相加 (“id=”, #引号, “aw”), 是否找到, 假))
            赋值 (后查找, 寻找文本 (到文本 (源文件), #引号, 前查找, 假))
            赋值 (排名, 取文本中间 (到文本 (源文件), 相加 (前查找, 6), 相减 (后查找, 前查找, 1)))
            赋值 (十位推广排名, 相加 (十位推广排名, 1))
            
            赋值 (排名, 到文本 (相加 (到数值 (排名), 1)))
            .插入表项 (到文本 (十位推广排名), , , , )
            相减 (十位推广排名, 1).置标题 (1, 关键词 [词])
            相减 (十位推广排名, 1).置标题 (2, 到文本 (相加 (页数, 1)))
            相减 (十位推广排名, 1).置标题 (3, 到文本 (排名))
            
             ' 编辑框3.加入文本 (到文本 (十位推广排名) ＋ “. ” ＋ 关键词 [词] ＋ “ 排名第 ” ＋ 到文本 (页数) ＋ “ 第 ” ＋ 排名 ＋ “ 位” ＋ #换行符)
        .否则
            .如果 (等于 (推广方式, “bd”))
                赋值 (前查找, 倒找文本 (到文本 (源文件), 相加 (“id=”, #引号, “bdfs”), 是否找到, 假))
                赋值 (后查找, 寻找文本 (到文本 (源文件), #引号, 前查找, 假))
                赋值 (排名, 取文本中间 (到文本 (源文件), 相加 (前查找, 8), 相减 (后查找, 前查找, 1)))
                赋值 (右侧排名, 相加 (右侧排名, 1))
                
                赋值 (排名, 到文本 (相加 (到数值 (排名), 1)))
                .插入表项 (到文本 (右侧排名), , , , )
                相减 (右侧排名, 1).置标题 (1, 关键词 [词])
                相减 (右侧排名, 1).置标题 (2, 到文本 (相加 (页数, 1)))
                相减 (右侧排名, 1).置标题 (3, 到文本 (排名))
            .否则
                赋值 (后查找, 寻找文本 (到文本 (源文件), #引号, 前查找, 假))
                赋值 (自然排名, 相加 (自然排名, 1))
                赋值 (排名, 取文本中间 (到文本 (源文件), 相加 (前查找, 4), 相减 (后查找, 前查找, 1)))
                .插入表项 (到文本 (自然排名), , , , )
                相减 (自然排名, 1).置标题 (1, 关键词 [词])
                相减 (自然排名, 1).置标题 (2, 到文本 (相加 (页数, 1)))
                相减 (自然排名, 1).置标题 (3, 到文本 (到数值 (排名)))
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束

.如果 (大于或等于 (词, 关键词个数))
    赋值 (.时钟周期, 0)
    赋值 (托盘标题, “查询结束，双击查看结果”)
.否则
    赋值 (托盘标题, “正在查询，请稍后查看！”)
.如果结束


赋值 (.内容, 相加 (到文本 (词), “ / ”, 到文本 (关键词个数)))

.子程序 _按钮中断_被单击, 空白型, , 
.如果 (等于 (.标题, “暂停查询”))
    
    赋值 (.时钟周期, 0)
    赋值 (.禁止, 假)
    赋值 (.标题, “继续查询”)
.否则
    赋值 (.时钟周期, 3000)
    赋值 (.禁止, 真)
    赋值 (.标题, “暂停查询”)
.如果结束


.子程序 _按钮3_被单击, 空白型, , 
.如果 (等于 (信息框 (“确认退出关键词查询？”, 1, “警告！！”), 0))
    结束 ()
.否则
    
.如果结束



.子程序 去除空白关键字, 空白型, , 
.局部变量 n1, 整数型, , , 


.如果 (小于或等于 (判断次数, 数据个数))
    
    .如果 (等于 (关键词 [判断次数], “”))
        删除成员 (关键词, 判断次数, )
        
        赋值 (数据个数, 取数组成员数 (关键词))
        赋值 (判断次数, 1)
        
    .否则
        赋值 (判断次数, 相加 (判断次数, 1))
    .如果结束
    
    去除空白关键字 ()
.否则
    
.如果结束


.子程序 _按钮重新查询_被单击, 空白型, , 
全部删除 ()
全部删除 ()
全部删除 ()
全部删除 ()
全部删除 ()
赋值 (词, 0)
赋值 (无排名, 0)
赋值 (推广链接排名, 0)
赋值 (十位推广排名, 0)
赋值 (右侧排名, 0)
赋值 (自然排名, 0)
_关键词查询_创建完毕 ()


.子程序 _关键词查询_托盘事件, 空白型, , 
.参数 操作类型, 整数型, , 

.如果真 (或者 (等于 (操作类型, 1), 等于 (操作类型, 2), 等于 (操作类型, 3)))
    置托盘图标 ({  }, )
    赋值 (关键词查询., 真)
    关键词查询.获取焦点 ()
.如果真结束




.子程序 _关键词查询_可否被关闭, 逻辑型, , 
.如果 (等于 (信息框 (“确认是否关闭程序”, 4, “提示”), #是钮))
    结束 ()
.否则
    返回 (假)
.如果结束





.子程序 _关键词查询_位置被改变, 空白型, , 
.如果 (等于 (关键词查询., 2))
    关键词查询.置托盘图标 (#托盘图片, 托盘标题)
    赋值 (关键词查询., 假)
.否则
    
.如果结束


.子程序 _超级列表框1_表项被激活, 空白型, , 
未知支持库函数_56 (相加 (网址, .取标题 (., 1), “&pn=”, 到文本 (相乘 (相减 (到数值 (.取标题 (., 2)), 1), 10)), “&usm=1”))



.子程序 _超级列表框2_表项被激活, 空白型, , 
未知支持库函数_56 (相加 (网址, .取标题 (., 1), “&pn=”, 到文本 (相乘 (相减 (到数值 (.取标题 (., 2)), 1), 10)), “&usm=1”))


.子程序 _超级列表框3_表项被激活, 空白型, , 
未知支持库函数_56 (相加 (网址, .取标题 (., 1), “&pn=”, 到文本 (相乘 (相减 (到数值 (.取标题 (., 2)), 1), 10)), “&usm=1”))


.子程序 _超级列表框5_表项被激活, 空白型, , 
未知支持库函数_56 (相加 (网址, .取标题 (., 1), “&pn=”, 到文本 (相乘 (相减 (到数值 (.取标题 (., 2)), 1), 10)), “&usm=1”))


.子程序 _超级列表框4_表项被激活, 空白型, , 
未知支持库函数_56 (相加 (网址, .取标题 (., 1), “&pn=”, 到文本 (相乘 (相减 (到数值 (.取标题 (., 2)), 1), 10)), “&usm=1”))


 ' 不属于任何一个程序集、类模块的函数：
