 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 462
    高度 = 513
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “●●易秀作坊SQL2000数据库操作演示（仅供群内学习使用）●●”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库




.全局变量 总记录集句柄, 整数型, , , 
.全局变量 符合记录集句柄, 整数型, , , 
.全局变量 命令行, 文本型, , , 
.全局变量 记录数, 文本型, , , 

.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
未知支持库函数_0 (1)
.如果真 (“mdb.mdb”.打开MDB数据库 ())
     ' 其中“29D66A477092409”是指你计算机名
    信息框 (“打开成功！”, 0, )
    刷新记录数 ()
    返回 ()
.如果真结束
信息框 (“打开失败！”, 0, )
返回 ()

.子程序 _添加数据按钮_被单击, 空白型, , 
.如果 (等于 (等于 (.内容, “”), 真))
    信息框 (“NAME都不写，插个球啊！，欠扁啊你！”, 0, )
    重新填写 ()
.否则
    .如果 (等于 (等于 (.内容, “”), 真))
        信息框 (“AGE也不写，插个球啊！，欠扁啊你！”, 0, )
        重新填写 ()
    .否则
        .如果 (等于 (相加 (“insert into biao1(name,age) select”, “'”, .内容, “'”, “,”, .内容).执行 (), 假))
             ' insert into biao1” ＋ “(name,age)” ＋ “values”………这样的格式是死的，死记硬背住  INSERT INTO就是添加数据的命令
            信息框 (“插入失败！”, 0, )
        .否则
            信息框 (“已成功插入新记录！”, 0, )
            刷新记录数 ()
            重新填写 ()
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 刷新记录数, 空白型, , 
.局部变量 记录数容器, 整数型, , , 

赋值 (记录数容器, “select count(*) from biao1 ”.查询 ())
赋值 (.内容, 到文本 (记录数容器.读 (1)))
赋值 (总记录集句柄, “select * from biao1”.查询 ())
总记录集句柄.重新查询 ()
 ' 记录集句柄（自己定义的全局整型变量）虽然是整数型，但是他不仅仅是存储数字的变量，他可以把所有数据收集起来一代码的形式存储起来，暂时这么理解
 ' 外部数据库1.重新查询 (记录集句柄)  表示刷新新记录到记录集合里（新加的数据虽然在数据库里，但是我们访问数据是通过数据集来提取，所以要刷新记录集）

.子程序 _首记录按钮_被单击, 空白型, , 
总记录集句柄.到首记录 ()
 ' 看到了吧，这里就用上了记录集句柄，这样你应该理解最上边给你的解释了吧
显示信息 ()
 ' 去找显示信息这个字程序看看吧

.子程序 显示信息, 空白型, , 
赋值 (.内容, 总记录集句柄.读 (“name”))
赋值 (.内容, 到文本 (总记录集句柄.读 (“age”)))
赋值 (.内容, 到文本 (总记录集句柄.读 (“id”)))
 ' 这个应该能看懂吧
 ' 在SQL里其实不存在什么当前记录号的，所以就自己建一个递增的整数型数据来代替他，用来作为关键键

.子程序 重新填写, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)

.子程序 _尾记录按钮_被单击, 空白型, , 
总记录集句柄.到尾记录 ()
 ' 看到了吧，这里就用上了记录集句柄，这样你应该理解最上边给你的解释了吧
显示信息 ()

.子程序 _上一条按钮_被单击, 空白型, , 
总记录集句柄.到前一记录 ()
.如果 (总记录集句柄.首记录前 ())
     ' 看到了吧，这里就用上了记录集句柄，这样你应该理解最上边给你的解释了吧
    信息框 (“前面已无记录！”, 0, )
    总记录集句柄.到首记录 ()
    
.否则
    显示信息 ()
.如果结束


.子程序 _下一条按钮_被单击, 空白型, , 
总记录集句柄.到后一记录 ()
.如果 (总记录集句柄.尾记录后 ())
    信息框 (“后面已无记录！”, 0, )
    总记录集句柄.到尾记录 ()
    
.否则
    显示信息 ()
.如果结束


.子程序 _重新填写按钮_被单击, 空白型, , 
重新填写 ()
 ' 去看看重新填写子程序，在上边啦

.子程序 _查询按钮_被单击, 空白型, , 
.局部变量 全部查询SQL命令行, 文本型, , , 
.局部变量 全部查询记录数, 文本型, , , 
.局部变量 与查询SQL命令行, 文本型, , , 
.局部变量 与查询记录数, 文本型, , , 
.局部变量 或查询SQL命令行, 文本型, , , 
.局部变量 或查询记录数, 文本型, , , 

赋值 (全部查询SQL命令行, “select * from biao1”)
赋值 (全部查询记录数, “select count(*) from biao1”)
赋值 (与查询SQL命令行, 相加 (“select * from biao1 where name like '”, .内容, “' and age like '”, .内容, “'”))
赋值 (与查询记录数, 相加 (“select count(*) from biao1 where name like '”, .内容, “' and age like '”, .内容, “'”))
赋值 (或查询SQL命令行, 相加 (“select * from biao1 where name like '”, .内容, “' or age like '”, .内容, “'”))
赋值 (或查询记录数, 相加 (“select count(*) from biao1 where name like '”, .内容, “' or age like '”, .内容, “'”))
 ' 独立拉出来这些命令行是为了以后不用重复写那么多重复的命令，主要看就是不要 where的就是全部查询，有where且有 and的就是必须同时满足这2个条件的记录，有where且有 or 的就是必须只要满足这2个条件其中之一的记录，模糊查找，也就是说只要包含特定的字符即可，比如，有记录1234 那么查找123，也会把1234找出来，因为1234里包含123这个3个字符，那么模式查询的关键字就是 %XXXX%，用%把XXXX（你所提供的关键字）包括起来，当然，由于E书写要求，所以要仔细看上面的书写方式！
 ' 对了，为了让大家容易看清楚下面的判断，实际上不必要这样操作，一般都是模糊搜索，我在这里也建了一个全局变量"命令行"，一个全局变量“记录数”也是为了减少代码重复
总记录集句柄.关闭记录集 ()
符合记录集句柄.关闭记录集 ()
刷新记录数 ()
.如果 (并且 (等于 (.内容, “”), 等于 (等于 (.内容, “”), 真)))
    赋值 (命令行, 全部查询SQL命令行)
    赋值 (记录数, 全部查询记录数)
    查询 ()
.否则
    .如果 (或者 (等于 (.内容, “”), 等于 (等于 (.内容, “”), 真)))
        赋值 (命令行, 或查询SQL命令行)
        赋值 (记录数, 或查询记录数)
        查询 ()
    .否则
        赋值 (命令行, 与查询SQL命令行)
        赋值 (记录数, 与查询记录数)
        查询 ()
    .如果结束
    
.如果结束


.子程序 查询, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 j, 整数型, , , 

 ' 变量i是用来存放总记录数的
 ' 变量j是用来帮助循环的
全部删除 ()
赋值 (符合记录集句柄, 记录数.查询 ())
赋值 (.内容, 到文本 (符合记录集句柄.读 (1)))
赋值 (i, 到数值 (.内容))
赋值 (j, i)
赋值 (符合记录集句柄, 命令行.查询 ())
符合记录集句柄.到首记录 ()
.计次循环首 (i, )
    .插入表项 ()
    相减 (i, j).置标题 (0, 到文本 (符合记录集句柄.读 (“name”)))
    相减 (i, j).置标题 (1, 到文本 (符合记录集句柄.读 (“age”)))
    赋值 (j, 相减 (j, 1))
    符合记录集句柄.到后一记录 ()
.计次循环尾 ()


.子程序 _取消按钮_被单击, 空白型, , 
重新填写 ()

.子程序 _模糊查询按钮_被单击, 空白型, , 
 ' 模糊搜索是不能用 “OR”的，这点上我烦了好久，至于为什么，你自己写出来就知道效果了，你现在只需要知，模糊搜索时只可以用AND连接多条件，不可以用 OR连接条件
总记录集句柄.关闭记录集 ()
符合记录集句柄.关闭记录集 ()
刷新记录数 ()
.如果 (或者 (等于 (.内容, “”), 等于 (等于 (.内容, “”), 真)))
    赋值 (命令行, 相加 (“select * from biao1 where name like '%”, .内容, “%' and age like '%”, .内容, “%'”))
    赋值 (记录数, 相加 (“select count(*) from biao1 where name like '%”, .内容, “%' and age like '%”, .内容, “%'”))
    查询 ()
.否则
    
.如果结束


.子程序 _修改按钮_被单击, 空白型, , 
.如果 (等于 (相加 (“update biao1 set name='”, .内容, “',age='”, .内容, “' where id=”, .内容).执行 (), 假))
     ' where id=” ＋ 记录号编辑框.内容  这个条件是修改当前记录的唯一条件，死记住吧
    信息框 (“修改失败！”, 0, )
.否则
    刷新记录数 ()
    信息框 (“修改成功！”, 0, )
.如果结束



.子程序 _删除按钮_被单击, 空白型, , 
.如果 (等于 (相加 (“delete from biao1 where id=”, .内容).执行 (), 假))
     ' where id=” ＋ 记录号编辑框.内容  这个条件是修改当前记录的唯一条件，死记住吧
    信息框 (“删除失败！”, 0, )
.否则
    
    信息框 (“删除成功！”, 0, )
    刷新记录数 ()
    重新填写 ()
.如果结束



 ' 不属于任何一个程序集、类模块的函数：
