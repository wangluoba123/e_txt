 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：五步数据库自动生成的程序
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 主窗口 ' 在程序启动后自动调入本窗口
    左边 = 0
    顶边 = 0
    宽度 = 800
    高度 = 592
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 power ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 500
    高度 = 293
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “本软件由FUNDERSOFT推出的五步数据库提供技术平台”
    帮助文件名 = “”

窗口 登录窗口
    左边 = 50
    顶边 = 50
    宽度 = 325
    高度 = 210
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “用户登录”
    帮助文件名 = “”



.声音 q, " ' 已保存到：D:\易语言学习\Data\exe.e\q", , 
.图片 bmp, " ' 已保存到：D:\易语言学习\Data\exe.e\bmp", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 3 系统核心支持库
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 1 7 扩展界面支持库三
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 1 XP风格界面库
 ' ExtMenu 9909FBB013704cfa8FE7E739DB7172DE 1 4 超级菜单支持库
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 1 1 高级表格支持库
 ' ESpeechEngine 4AA6F3ADE9264fbe8B618A1FCD60364F 1 1 文本语音转换支持库




数据类型 用户信息, , 
    .成员 用户名, 文本型, , , 
    .成员 密码, 文本型, , , 
    .成员 浏览权限, 逻辑型, , , 
    .成员 录入权限, 逻辑型, , , 

.全局变量 文件路径, 文本型, , , 
.全局变量 程序名, 文本型, , , 
.全局变量 作者信息, 文本型, , "6", 
.全局变量 锁, 逻辑型, , , 
.全局变量 通用变量, 整数型, , , 
.全局变量 用户数, 整数型, , , 
.全局变量 用户变量, 用户信息, , "0", 
.全局变量 管理, 字节集, , , 
.全局变量 皮肤, 整数型, , , 
.全局变量 界面, 整数型, , , 
.全局变量 登录用户, 文本型, , , 
.全局变量 权限, 整数型, , , 
.全局变量 运行次数, 整数型, , , 

.DLL命令 系统关于对话框, 空白型, "", "ShellAboutA", , 
    .参数 窗口句柄, 整数型, , 
    .参数 应用程序标题, 文本型, , 
    .参数 其他信息, 文本型, , 
    .参数 图标句柄, 整数型, , 

.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 本子程序在程序启动后最先执行
赋值 (文件路径, 相加 (取运行目录 (), “\”))


.如果 (并且 (文件是否存在 (相加 (文件路径, “base.fxg”)), 文件是否存在 (相加 (文件路径, “data.fxg”))))
    .如果 (替换打开 (相加 (文件路径, “base.fxg”), , , , , 到文本 ({ 49, 51, 56, 57, 51, 50, 50, 48, 53, 57, 50 }), ))
        .如果真 (文件是否存在 (相加 (未知支持库函数_7 (11), “useeee.edb”)))
            删除文件 (相加 (未知支持库函数_7 (11), “useeee.edb”))
        .如果真结束
        
        
        复制记录 (相加 (未知支持库函数_7 (11), “useeee.edb”), 不等于 (读 (7), “”), “G”, “H”, “I”, “J”)
        
        到首记录 ()
        赋值 (程序名, 读 (6))
        .变量循环首 (1, 6, 1, 通用变量)
            跳到 (相加 (通用变量, 1))
            赋值 (作者信息 [通用变量], 读 (6))
        .变量循环尾 ()
        
        跳到 (8)
        赋值 (管理, 到字节集 (读 (6)))
        跳到 (9)
        赋值 (皮肤, 到数值 (读 (6)))
        跳到 (10)
        赋值 (界面, 到数值 (读 (6)))
        跳到 (11)
        赋值 (运行次数, 到数值 (读 (6)))
        写 (6, 到文本 (相加 (运行次数, 1)))
        赋值 (运行次数, 到数值 (读 (6)))
        
        替换打开 (相加 (未知支持库函数_7 (11), “useeee.edb”), , , , , 到文本 ({ 49, 51, 56, 57, 51, 50, 50, 48, 53, 57, 50 }), )
        赋值 (用户数, 取记录数 ())
        .如果真 (大于 (用户数, 0))
            到首记录 ()
            重定义数组 (用户变量, 假, 用户数)
            .变量循环首 (1, 用户数, 1, 通用变量)
                赋值 (用户变量 [通用变量], 用户名, 读 (1))
                赋值 (用户变量 [通用变量], 密码, 读 (2))
                赋值 (用户变量 [通用变量], 浏览权限, 读 (3))
                赋值 (用户变量 [通用变量], 录入权限, 读 (4))
                
                跳过 (1)
            .变量循环尾 ()
            
        .如果真结束
        
        全部关闭 ()
        载入 (登录窗口, , 真)
    .否则
        信息框 (“配置文件不能够被打开,您将无法正常使用本程序!”, #警告图标, “配置文件打不开”)
        
        
    .如果结束
    
    
.否则
    信息框 (“找不到相关文件：base.fxg，data.fxg 程序无法运行!”, #警告图标, “无相关文件”)
    结束 ()
    
.如果结束


返回 (0) ' 可以根据您的需要返回任意数值


.窗口程序集 窗口程序集1, , , 

.程序集变量 方向, 文本型, , , 
.程序集变量 mm, 文本型, , , 
.程序集变量 作者信息标题, 文本型, , "6", 
.程序集变量 机读文本, 未知类型0x80001, , , 
.程序集变量 语音引擎, 文本型, , "0", 
.程序集变量 查询方式, 整数型, , , 
.程序集变量 中, 小数型, , , 
.程序集变量 用户项, 整数型, , , 
.程序集变量 匿名程序集变量_451, 空白型, , , 
.子程序 _主窗口_创建完毕, 空白型, , 
赋值 (mm, 到文本 (管理))
 ' mm在这里可不是妹妹的意思,因为它是非常重要的变量,所以没有用中文名称.
连续赋值 (mm, .数据库密码, .数据库密码, .数据库密码)
主窗口初始化子程序 ()
用户表格初始化子程序 ()
用户表格填充子程序 ()
语音子程序 ()
界面子程序 ()


.如果真 (不等于 (皮肤, 0))
     ' 更换界面 (1)
.如果真结束

赋值 (锁, 假)
锁提示子程序 ()
状态条子程序 ()



.子程序 用户表格初始化子程序, 空白型, , 

0.未知支持库函数_9 (1, #., “用户名”)
0.未知支持库函数_9 (2, #., “密码”)
0.未知支持库函数_9 (3, #., “统计导出权限”)
0.未知支持库函数_9 (4, #., “录入权限”)

.变量循环首 (1, 100, 1, 通用变量)
    通用变量.未知支持库函数_9 (0, #., 到文本 (通用变量))
.变量循环尾 ()

3.未知支持库函数_32 (100)

0.未知支持库函数_25 (0, 101, 5, 2)
1.未知支持库函数_30 (#.)
2.未知支持库函数_30 (#.)

3.未知支持库函数_30 (#.)
4.未知支持库函数_30 (#.)



.子程序 主窗口初始化子程序, 空白型, , 
赋值 (主窗口., 程序名)

赋值 (.隐藏自身, 真)
赋值 (.现行子夹, 0)

赋值 (.标题, 相加 (“您好!欢迎使用”, 程序名, “!首先请点击左面的菜单选择功能.”))

赋值 (., .)
赋值 (., .)

赋值 (作者信息标题, { “作者：”, “电话：”, “电子邮件：”, “网站：”, “QQ：”, “通讯地址：” })
.变量循环首 (1, 6, 1, 通用变量)
    相减 (通用变量, 1).未知支持库函数_9 (0, #., 作者信息标题 [通用变量])
    相减 (通用变量, 1).未知支持库函数_9 (1, #., 作者信息 [通用变量])
    
.变量循环尾 ()


1.未知支持库函数_32 (150)

赋值 (方向, “左”)
赋值 (.字体, .字体)
赋值 (中, 相除 (“A”.取高度 (), 2))
赋值 (.宽度, 相乘 (取文本长度 (.标题), 中))
赋值 (.左边, .宽度)
赋值 (.时钟周期, 10)


.如果 (替换打开 (相加 (文件路径, “data.fxg”), , , , , mm, ))
    
    .变量循环首 (1, 取字段数 (), 1, 通用变量)
        .如果真 (并且 (不等于 (取字段类型 (通用变量), 7), 不等于 (取字段类型 (通用变量), 8)))
            取字段名 (通用变量).加入项目 ()
            
        .如果真结束
        
    .变量循环尾 ()
     ' 在字段选择列表框里只填入数值与文本型
    赋值 (.现行选中项, 0)
    赋值 (.现行选中项, 0)
    
    .变量循环首 (1, 取字段数 (), 1, 通用变量)
        .如果真 (或者 (等于 (取字段类型 (通用变量), 4), 等于 (取字段类型 (通用变量), 6)))
            取字段名 (通用变量).加入项目 ()
            
        .如果真结束
        
    .变量循环尾 ()
     ' 在统计字段选择列表框里填入数值型字段名称
    
    连续赋值 (0, .现行选中项, .现行选中项)
    
    
    .如果 (复制结构 (相加 (未知支持库函数_7 (11), “ydf.fxg”), ))
        
        赋值 (.数据库文件名, 相加 (未知支持库函数_7 (11), “ydf.fxg”))
        1.添加行 ()
        
        
    .否则
        信息框 (“sorry”, 0, )
        
    .如果结束
    
    全部关闭 ()
    
.否则
    信息框 (“无法打开数据库文件--data.fxg.你将无法正确使用本程序.”, #警告图标, “不能连接到数据库!”)
    
.如果结束

_作者_被选择 ()

.子程序 锁提示子程序, 空白型, , 
.如果 (等于 (锁, 真))
    赋值 (.文本颜色, #红色)
    赋值 (.标题, 相加 (“数据库状态:”, “被锁住!”, #换行符, “您只可以浏览数据库内数据,不可以修改和录入.只有超级管理员才有权限改变数据库的锁状态!”))
.否则
    赋值 (.文本颜色, #蓝色)
    赋值 (.标题, 相加 (“数据库状态:”, “未锁!”, #换行符, “只要您有相应权限,就可以统计,导出,修改和录入数据.只有超级管理员才有权限改变数据库的锁状态!”))
.如果结束


.子程序 用户表格填充子程序, 空白型, , 
.局部变量 列, 整数型, , , 
.局部变量 行, 整数型, , , 

赋值 (用户数, 取数组成员数 (用户变量))
.变量循环首 (1, 用户数, 1, 行)
    .变量循环首 (1, 4, 1, 列)
        行.未知支持库函数_9 (1, #., 用户变量 [行], 用户名)
        行.未知支持库函数_9 (2, #., 用户变量 [行], 密码)
        行.未知支持库函数_9 (3, #., 用户变量 [行], 浏览权限)
        行.未知支持库函数_9 (4, #., 用户变量 [行], 录入权限)
    .变量循环尾 ()
    
    用户变量.未知支持库函数_2 ( [行], 用户名, 0, , , )
    
    跳过 ()
.变量循环尾 ()

.子程序 界面子程序, 空白型, , 
 ' 说明:全选:3 前两个:2 前一个:1 中间一个:4,最后一个,5,后两个6,两头取.7
.如果真 (等于 (界面, 1))
    连续赋值 (真, .可视, .可视, .可视, .可视, .可视)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (.左边, 30)
.如果真结束
.如果真 (等于 (界面, 2))
    连续赋值 (真, .可视, .可视, .可视, .可视, .可视)
    赋值 (., 真)
    赋值 (., 假)
    赋值 (.左边, 30)
    
.如果真结束
.如果真 (等于 (界面, 3))
    连续赋值 (真, .可视, .可视, .可视, .可视, .可视)
    赋值 (., 真)
    赋值 (., 真)
    未知支持库函数_0 (1)
    
.如果真结束
.如果真 (等于 (界面, 4))
    连续赋值 (假, .可视, .可视, .可视, .可视, .可视)
    赋值 (., 真)
    赋值 (., 假)
    赋值 (.左边, 30)
    
.如果真结束
.如果真 (等于 (界面, 5))
    连续赋值 (假, .可视, .可视, .可视, .可视, .可视)
    赋值 (., 假)
    赋值 (., 真)
.如果真结束
.如果真 (等于 (界面, 6))
    连续赋值 (假, .可视, .可视, .可视, .可视, .可视)
    赋值 (., 真)
    赋值 (., 真)
.如果真结束
.如果真 (等于 (界面, 7))
    连续赋值 (真, .可视, .可视, .可视, .可视, .可视)
    赋值 (., 假)
    赋值 (., 真)
.如果真结束



.子程序 语音子程序, 空白型, , 
机读文本.未知支持库函数_0 ()
赋值 (语音引擎, 机读文本.未知支持库函数_9 ())
.如果 (大于 (取数组成员数 (语音引擎), 0))
    机读文本.未知支持库函数_10 (语音引擎 [1])
    赋值 (.内容, “您的计算机支持语音读出查询结果,哈哈,程序可以语音告诉你答案啦!”)
    
.否则
    赋值 (.内容, “您的计算机不支持语音读出查询结果,若想使用此功能,请安装微软OFFICE XP或者以上版本!”)
.如果结束


.子程序 _时钟2_周期事件, 空白型, , 
.如果 (等于 (相加 (.左边, .宽度), 0))
    赋值 (.左边, .宽度)
.否则
    
.如果结束
赋值 (.左边, 相减 (.左边, 1))


.子程序 状态条子程序, 空白型, , 

1.置文本 (登录用户)
.如果真 (等于 (权限, 1))
    3.置文本 (“浏览,统计,导出”)
.如果真结束
.如果真 (等于 (权限, 2))
    3.置文本 (“浏览,录入”)
.如果真结束
.如果真 (等于 (权限, 3))
    3.置文本 (“浏览,统计,导出,录入”)
.如果真结束
.如果真 (等于 (权限, 4))
    3.置文本 (“浏览”)
.如果真结束
.如果真 (等于 (权限, 5))
    3.置文本 (“浏览,统计,导出,录入,数据库及用户管理”)
.如果真结束


.子程序 _卷帘式菜单1_菜单被改变, 空白型, , 
.参数 菜单索引, 整数型, , 

播放音乐 (#q, )

.子程序 逐条录入初始化, 空白型, , 
.局部变量 K, 整数型, , , 

1.删除行 (1)
保存更改 ()
1.添加行 ()



.子程序 _下一步按钮_被单击, 空白型, , 
.如果 (等于 (逐条录入确认 (), 真))
    赋值 (.只读, 假)
    赋值 (.可视, 假)
    
    赋值 (.数据库文件名, 相加 (文件路径, “data.fxg”))
    .添加 (1, 1)
    保存更改 ()
    .如果 (等于 (信息框 (“是否进行下一条记录的输入?”, #是否钮, “本记录已录入数据库”), #是钮))
        全部关闭 ()
        赋值 (.现行子夹, 2)
        逐条录入初始化 ()
    .否则
        全部关闭 ()
        赋值 (.现行子夹, 0)
    .如果结束
    
.否则
    
.如果结束


.子程序 逐条录入确认, 逻辑型, , 
.局部变量 i, 整数型, , , 
.局部变量 录入信息, 文本型, , , 

替换打开 (相加 (文件路径, “data.fxg”), , , , , mm, )

.变量循环首 (1, 取列数 (), 1, i)
    赋值 (录入信息, 相加 (录入信息, 取字段名 (i), “:”, 到文本 (1.取文本 (i)), #换行符))
.变量循环尾 ()
全部关闭 ()

.如果 (等于 (信息框 (相加 (“您录入的记录为:”, #换行符, 录入信息), 1, “录入数据确认”), 0))
    返回 (真)
    
.否则
    返回 (假)
.如果结束


.子程序 _刷新按钮_被单击, 空白型, , 
保存更改 ()
赋值 (.数据库文件名, 相加 (文件路径, “data.fxg”))
刷新显示 ()
.如果 (替换打开 (相加 (文件路径, “data.fxg”), , , , , mm, ))
    赋值 (.内容, 到文本 (取字段数 ()))
    赋值 (.内容, 到文本 (取记录数 ()))
    
.否则
    
.如果结束

全部关闭 ()

.子程序 _卷帘式菜单1_项目被选择, 空白型, , 
.参数 菜单索引, 整数型, , 
.参数 项目索引, 整数型, , 

.局部变量 文件号, 整数型, , , 

.如果真 (并且 (等于 (菜单索引, 0), 等于 (项目索引, 0)))
    赋值 (.现行子夹, 1)
    赋值 (.内容, “”)
    获取焦点 ()
.如果真结束
.如果真 (并且 (等于 (菜单索引, 0), 大于 (项目索引, 0), 小于或等于 (项目索引, 用户数)))
    赋值 (.现行子夹, 7)
    赋值 (用户项, 项目索引)
    赋值 (.内容, “”)
    赋值 (.内容, 项目索引.未知支持库函数_8 ())
    赋值 (.内容, “”)
    获取焦点 ()
    
    
.如果真结束
.如果真 (并且 (等于 (菜单索引, 1), 等于 (项目索引, 0)))
    赋值 (.现行子夹, 4)
    
.如果真结束
.如果真 (并且 (等于 (菜单索引, 1), 等于 (项目索引, 1)))
    赋值 (.现行子夹, 5)
    赋值 (.只读, 真)
    赋值 (.可视, 假)
    赋值 (.数据库文件名, “”)
    _刷新按钮_被单击 ()
.如果真结束
.如果真 (并且 (等于 (菜单索引, 1), 等于 (项目索引, 2)))
    赋值 (.现行子夹, 3)
    赋值 (.起始选择位置, 4)
    获取焦点 ()
.如果真结束
.如果真 (并且 (等于 (菜单索引, 2), 等于 (项目索引, 0)))
    .如果 (等于 (锁, 假))
        .如果 (并且 (不等于 (权限, 1), 不等于 (权限, 4)))
            赋值 (.现行子夹, 2)
            逐条录入初始化 ()
            
        .否则
            信息框 (“您没有录入数据的权限，请联系超级管理员开通！”, #信息图标, “提示”)
        .如果结束
        
    .否则
        信息框 (“数据库已被超级管理员锁住,您只可以查询浏览记录,不可以修改或添加记录!”, 0, “已加锁”)
        
    .如果结束
    
.如果真结束
.如果真 (并且 (等于 (菜单索引, 2), 等于 (项目索引, 1)))
    .如果 (等于 (锁, 假))
        .如果 (并且 (不等于 (权限, 1), 不等于 (权限, 4)))
            赋值 (.现行子夹, 5)
            赋值 (.只读, 假)
            赋值 (.可视, 真)
            赋值 (.数据库文件名, “”)
            _刷新按钮_被单击 ()
            
        .否则
            信息框 (“您没有录入数据的权限，请联系超级管理员开通！”, 0, )
        .如果结束
        
    .否则
        信息框 (“数据库已被超级管理员锁住,您只可以查询浏览记录,不可以修改或添加记录!”, 0, “已加锁”)
        
    .如果结束
    
.如果真结束
.如果真 (并且 (等于 (菜单索引, 2), 等于 (项目索引, 2)))
    
    .如果 (等于 (锁, 假))
        .如果 (并且 (不等于 (权限, 1), 不等于 (权限, 4)))
            赋值 (.现行子夹, 6)
            赋值 (.数据库文件名, “”)
            粘贴子程序 ()
            
        .否则
            信息框 (“您没有录入数据的权限，请联系超级管理员开通！”, #信息图标, “提示”)
        .如果结束
        
    .否则
        信息框 (“数据库已被超级管理员锁住,您只可以查询浏览记录,不可以修改或添加记录!”, 0, “已加锁”)
    .如果结束
    
    
.如果真结束
.如果真 (并且 (等于 (菜单索引, 3), 等于 (项目索引, 0)))
    系统关于对话框 (0, “五步数据库平台支持”, 相加 (作者信息 [1], “  版权所有!”), 0)
.如果真结束
.如果真 (并且 (等于 (菜单索引, 3), 等于 (项目索引, 1)))
    赋值 (.现行子夹, 0)
.如果真结束
.如果真 (并且 (等于 (菜单索引, 4), 等于 (项目索引, 0)))
    载入 (power, , 真)
    
.如果真结束

5.置文本 (相加 (菜单索引.未知支持库函数_7 (), “---”, 项目索引.未知支持库函数_8 ()))


.子程序 _打印按钮_被单击, 空白型, , 
打印设置 ()
.开始打印 ()

.子程序 _管理员确定按钮_被单击, 空白型, , 
.如果 (等于 (.内容, mm))
    连续赋值 (真, .可视, .可视)
    赋值 (.内容, “”)
.否则
    连续赋值 (假, .可视, .可视)
    信息框 (“呵呵~~你不是超级管理员,所以无权操作!”, #警告图标, “密码不对”)
    获取焦点 ()
    赋值 (.被选择字符数, -1)
    
.如果结束


.子程序 _清空数据库按钮_被单击, 空白型, , 
.如果 (等于 (信息框 (“您真的要将数据库内的记录全部清空吗?”, 相加 (1, #询问图标), “清空数据库”), #确认钮))
    替换打开 (相加 (文件路径, “data.fxg”), , , , , mm, )
    清空 ()
    信息框 (“清空数据库全部记录!”, 0, )
    全部关闭 ()
    
.否则
    
.如果结束


.子程序 _查询按钮_被单击, 空白型, , 
赋值 (查询方式, .现行选中项)
查询子程序 ()


.子程序 _查询的打印按钮_被单击, 空白型, , 
打印设置 ()
打印机1.开始打印 (, , , )

.子程序 _组合框1_列表项被选择, 空白型, , 
赋值 (.内容, “”)
获取焦点 ()
赋值 (.数据库文件名, “”)

.子程序 _超级管理员_被选择, 空白型, , 
赋值 (., 0)
_卷帘式菜单1_项目被选择 (0, 0)


.子程序 _条件查询_被选择, 空白型, , 
赋值 (., 1)
_卷帘式菜单1_项目被选择 (1, 0)


.子程序 _全部记录_被选择, 空白型, , 
赋值 (., 1)
_卷帘式菜单1_项目被选择 (1, 1)


.子程序 _语句查询_被选择, 空白型, , 
赋值 (., 1)
_卷帘式菜单1_项目被选择 (1, 2)


.子程序 _逐条录入_被选择, 空白型, , 
赋值 (., 2)
_卷帘式菜单1_项目被选择 (2, 0)


.子程序 _表格录入_被选择, 空白型, , 
赋值 (., 2)
_卷帘式菜单1_项目被选择 (2, 1)


.子程序 _程序_被选择, 空白型, , 
赋值 (., 3)
_卷帘式菜单1_项目被选择 (3, 0)


.子程序 _作者_被选择, 空白型, , 
赋值 (., 3)
_卷帘式菜单1_项目被选择 (3, 1)
连续赋值 (假, .可视, .可视, .可视, .可视)


.子程序 _PowerBy_被选择, 空白型, , 
赋值 (., 4)
_卷帘式菜单1_项目被选择 (4, 0)

.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.如果真 (等于 (按钮索引, 13))
    _PowerBy_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 11))
    _作者_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 10))
    _程序_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 8))
    _粘贴录入_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 7))
    _表格录入_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 6))
    _逐条录入_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 4))
    _语句查询_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 3))
    _全部记录_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 2))
    _条件查询_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 0))
    _超级管理员_被选择 ()
.如果真结束


.子程序 _管理员退出按钮_被单击, 空白型, , 
赋值 (.内容, “”)

连续赋值 (假, 分组框1.可视, 分组框9.可视)
_工具条1_被单击 (11)


.子程序 _语音查询按钮_被单击, 空白型, , 
.局部变量 机读文本, 未知类型0x80001, , , 
.局部变量 结果, 文本型, , , 
.局部变量 匿名局部变量_80, 空白型, , , 

.如果 (等于 (取文本左边 (.内容, 4), “请问”))
    .如果 (不等于 (取文本右边 (.内容, 相减 (取文本长度 (.内容), 4)), “”))
        
        替换打开 (相加 (文件路径, “\data.fxg”), , , , , mm, )
        赋值 (结果, 请问 (取文本右边 (.内容, 相减 (取文本长度 (.内容), 4))))
        .如果真 (等于 (.内容, “”))
            机读文本.未知支持库函数_2 (0, 结果)
        .如果真结束
        
        信息框 (结果, 0, “答案”)
        关闭 ()
        
    .否则
        信息框 (“您的问题是是什么?”, 0, “没有问题”)
        
    .如果结束
    
.否则
    信息框 (“中国乃礼仪之邦,您必须加请问二字!”, 0, “你还没有说请问呢”)
    赋值 (.内容, “请问”)
    赋值 (.起始选择位置, 4)
    获取焦点 ()
    
.如果结束


.子程序 查询子程序, 空白型, , 
.局部变量 是否查询, 逻辑型, , , 

置等待鼠标 ()
赋值 (.数据库文件名, “”)
刷新显示 ()
替换打开 (相加 (文件路径, “data.fxg”), , , , , mm, )
到首记录 ()
.如果真 (等于 (查询方式, 0))
    .如果 (等于 (取字段类型 (.内容), #文本型))
        复制记录 (相加 (未知支持库函数_7 (11), “cxyd.fxg”), 等于 (读 (.内容), .内容), )
        
    .否则
        复制记录 (相加 (未知支持库函数_7 (11), “cxyd.fxg”), 等于 (读 (.内容), 到数值 (.内容)), )
    .如果结束
    
    
    赋值 (是否查询, 真)
    
.如果真结束
.如果真 (等于 (查询方式, 1))
    .如果 (等于 (取字段类型 (.内容), #文本型))
        信息框 (“文本型字段不支持用大于或者小于查询”, 0, )
        获取焦点 ()
        赋值 (是否查询, 假)
        
    .否则
        复制记录 (相加 (未知支持库函数_7 (11), “cxyd.fxg”), 大于 (读 (.内容), 到数值 (.内容)), )
        赋值 (是否查询, 真)
        
    .如果结束
    
.如果真结束
.如果真 (等于 (查询方式, 2))
    .如果 (等于 (取字段类型 (.内容), #文本型))
        信息框 (“文本型字段不支持用大于或者小于查询”, 0, )
        获取焦点 ()
        赋值 (是否查询, 假)
        
    .否则
        复制记录 (相加 (未知支持库函数_7 (11), “cxyd.fxg”), 小于 (读 (.内容), 到数值 (.内容)), )
        赋值 (是否查询, 真)
        
    .如果结束
    
.如果真结束
.如果真 (等于 (查询方式, 3))
    
    .如果 (等于 (取字段类型 (.内容), #文本型))
        复制记录 (相加 (未知支持库函数_7 (11), “cxyd.fxg”), 近似等于 (读 (.内容), .内容), )
        赋值 (是否查询, 真)
        
    .否则
        复制记录 (相加 (未知支持库函数_7 (11), “cxyd.fxg”), 等于 (读 (.内容), 到数值 (.内容)), )
        信息框 (“数值型字段不支持用约大于查询”, 0, )
        获取焦点 ()
        赋值 (是否查询, 假)
    .如果结束
    
.如果真结束

.如果 (等于 (是否查询, 真))
    赋值 (.数据库文件名, 相加 (未知支持库函数_7 (11), “cxyd.fxg”))
    
.否则
    赋值 (.数据库文件名, “”)
    
.如果结束


全部关闭 ()
恢复鼠标 ()





.子程序 _修改密码按钮_被单击, 空白型, , 
.局部变量 新密码, 文本型, , , 

输入框 (相加 (登录用户, “同志，请输入您的新密码!”), “修改密码”, , 新密码, )
.如果 (不等于 (新密码, “”))
    替换打开 (相加 (文件路径, “base.fxg”), , , , , 到文本 ({ 49, 51, 56, 57, 51, 50, 50, 48, 53, 57, 50 }), )
    跳到 (8)
    写 (6, 新密码)
    替换打开 (相加 (文件路径, “data.fxg”), , , , , mm, )
    .如果 (置数据库密码 (新密码))
        信息框 (相加 (“新密码为:”, 新密码, “请务必记好!”), 0, “修改成功!”)
        赋值 (mm, 新密码)
        连续赋值 (mm, .数据库密码, .数据库密码, .数据库密码)
        
    .否则
        信息框 (相加 (“您输入的新密码”, 新密码, “不符合密码文本要求,密码修改不成功,仍为原密码!”), 0, “修改不成功!”)
    .如果结束
    
    
.否则
    信息框 (“密码不能为空”, 0, “您什么都没有输”)
    
.如果结束

全部关闭 ()


.子程序 _导出为EXCEL表格按钮_被单击, 空白型, , 
.如果 (等于 (相加 (1, 1), 3))
     ' 1+1当然不会等于3,这里用到了"数据库到Excel文件"这个模块.这又不符合比赛要求,用这种方法保留代码而已.若要使用时则删除这个如果,再将中间调用模块的代码不置为草稿即可.
    赋值 (.初始目录, 未知支持库函数_7 (1))
    赋值 (.标题, “请输入Excel文件名...”)
    赋值 (.过滤器, “Excel文件（*.xls）|*.xls”)
    赋值 (.默认文件后缀, “xls”)
    赋值 (.类型, 1)
    
    .如果真 (打开 ())
        .如果 (替换打开 (相加 (文件路径, “data.fxg”), , , , , mm, ))
            到首记录 ()
            
             ' 如果 (数据库到Excel文件 (通用对话框1.文件名, 真))
            信息框 (“导出表格文件成功”, 0, )
            
            信息框 (“导出表格文件失败”, 0, )
            
        .否则
            信息框 (“导出表格文件失败”, 0, )
            
        .如果结束
        
    .如果真结束
    
    关闭 ()
    
.否则
    信息框 (“此处要用到数据库到Excel文件模块,所以不支持功能!”, 相加 (0, #信息图标), “此版本不支持此功能”)
.如果结束


.子程序 _导出为网页或文本按钮_被单击, 空白型, , 

.如果 (等于 (相加 (1, 1), 3))
     ' 保留代码的方法,详见上面的注释.
    .如果 (替换打开 (相加 (文件路径, “data.fxg”), , , , , mm, ))
        到首记录 ()
         ' 导出库记录 ()
        
    .否则
        信息框 (“导出文件失败”, 0, )
        
    .如果结束
    
    关闭 ()
    
.否则
    信息框 (“此处要用到数据库到Excel文件模块,所以不支持功能!”, 相加 (0, #信息图标), “此版本不支持此功能”)
.如果结束



.子程序 _解锁数据库按钮_被单击, 空白型, , 
赋值 (锁, 取反 (锁))
.如果真 (等于 (锁, 真))
    信息框 (“数据库已被锁住,任何人只可查询浏览记录,不可以修改或添加记录!”, 0, “已加锁”)
.如果真结束
.如果真 (等于 (锁, 假))
    信息框 (“数据库已被解锁,您可以修改或添加记录!”, 0, “未加锁”)
.如果真结束

锁提示子程序 ()

.子程序 _主窗口_可否被关闭, 逻辑型, , 
.如果 (等于 (信息框 (相加 (“您真的要关闭”, 程序名, “吗?”), 相加 (1, #询问图标), “是否关闭”), 0))
    机读文本.未知支持库函数_1 ()
    全部关闭 ()
    关闭所有文件 ()
    返回 (真)
    
.否则
    返回 (假)
.如果结束


.子程序 请问, 文本型, , 
.参数 问句, 文本型, , 

.局部变量 规范问句, 文本型, , , 
.局部变量 的位置, 整数型, , , 
.局部变量 问题类型, 文本型, , , 
.局部变量 问题位置, 整数型, , , 
.局部变量 定语, 文本型, , , 
.局部变量 主语, 文本型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 结果, 文本型, , , 
.局部变量 a, 文本型, , "0", 
.局部变量 i, 整数型, , , 
.局部变量 匿名局部变量_96, 空白型, , , 
.局部变量 匿名局部变量_97, 空白型, , , 

赋值 (规范问句, 到全角 (删全部空 (问句)))
赋值 (的位置, 寻找文本 (规范问句, “的”, , 真))
.如果真 (不等于 (寻找文本 (规范问句, “是什么”, , 真), -1))
    赋值 (问题类型, “是什么”)
    赋值 (问题位置, 寻找文本 (规范问句, “是什么”, , 真))
.如果真结束
.如果真 (不等于 (寻找文本 (规范问句, “是多少”, , 真), -1))
    赋值 (问题类型, “是多少”)
    赋值 (问题位置, 寻找文本 (规范问句, “是多少”, , 真))
.如果真结束
.如果真 (不等于 (寻找文本 (规范问句, “有多少”, , 真), -1))
    赋值 (问题类型, “有多少”)
    赋值 (问题位置, 寻找文本 (规范问句, “有多少”, , 真))
.如果真结束


赋值 (定语, 到全角 (取文本左边 (规范问句, 的位置)))
赋值 (主语, 到全角 (取文本中间 (规范问句, 相加 (的位置, 2), 相减 (问题位置, 的位置, 2))))

赋值 (字段数, 取字段数 ())

.如果 (不等于 (取字段类型 (主语), 0))
    .变量循环首 (1, 字段数, 1, i)
        .如果 (等于 (取字段类型 (i), #文本型))
            .如果真 (查找 (等于 (读 (i), 定语)))
                赋值 (结果, 相加 (取文本左边 (规范问句, 相加 (问题位置, 1)), 到文本 (读 (主语))))
                跳出循环 ()
            .如果真结束
            
        .否则
            赋值 (结果, 相加 (“没有”, 定语, “的记录!”))
            
        .如果结束
        
        .如果真 (并且 (等于 (i, 字段数), 不等于 (取字段类型 (i), #文本型)))
            赋值 (结果, 相加 (“没有”, 定语, “的记录!”))
            跳出循环 ()
            
        .如果真结束
        
    .变量循环尾 ()
    
.否则
    赋值 (结果, 相加 (“没有”, 主语, “这样的字段名称,或者此类型的字段暂不支持!”))
.如果结束


返回 (结果)



.子程序 _保存用户数据按钮_被单击, 空白型, , 
置等待鼠标 ()
.如果 (替换打开 (相加 (文件路径, “base.fxg”), , , , , 到文本 ({ 49, 51, 56, 57, 51, 50, 50, 48, 53, 57, 50 }), ))
    
    替换 (真, “G”, “”, “H”, “”, “I”, 假, “J”, 假)
    
    到首记录 ()
    
    
    .变量循环首 (1, 100, 1, 通用变量)
        写 (7, 通用变量.未知支持库函数_10 (1))
        写 (8, 通用变量.未知支持库函数_10 (2))
        写 (9, 通用变量.未知支持库函数_10 (3))
        写 (10, 通用变量.未知支持库函数_10 (4))
        跳过 (1)
        
    .变量循环尾 ()
    全部关闭 ()
    恢复鼠标 ()
    .如果真 (等于 (信息框 (“用户信息的增删,权限设置,下次运行本程序时才能生效,现在是否关闭本程序?”, 相加 (#是否钮, #询问图标), “用户数据已保存”), #是钮))
        结束 ()
        
    .如果真结束
    
.否则
    
.如果结束



.子程序 _粘贴录入_被选择, 空白型, , 
赋值 (., 2)
_卷帘式菜单1_项目被选择 (2, 2)


.子程序 粘贴子程序, 空白型, , 
.如果 (剪辑板中可有文本 ())
    赋值 (.内容, 取剪辑板文本 ())
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
    
.如果结束



.子程序 _粘贴表格按钮_被单击, 空白型, , 
赋值 (.只读, 假)
赋值 (.可视, 真)
赋值 (.数据库文件名, “”)
_刷新按钮_被单击 ()
粘贴EXCEL内容 ()



.子程序 粘贴EXCEL内容, 空白型, , 粘贴EXCEL表格内容到指定数据源(注意:表格内容首行和未行单元格内容不能为空!表格列数要与数据源列数要相等且类型相同)
.参数 数据源, 数据源, , 

.局部变量 EXCEL表格内容, 文本型, , , 
.局部变量 首行文本, 文本型, , "0", 
.局部变量 行数, 整数型, , , 
.局部变量 列数, 整数型, , , 
.局部变量 数据源行数, 整数型, , , 
.局部变量 数据源列数, 整数型, , , 
.局部变量 行数据, 文本型, , "0", 
.局部变量 列数据, 文本型, , "0", 
.局部变量 a, 整数型, , , 
.局部变量 b, 整数型, , , 

.如果 (剪辑板中可有文本 ())
    赋值 (EXCEL表格内容, 取剪辑板文本 ())
    赋值 (行数据, 分割文本 (EXCEL表格内容, #换行符, ))
    赋值 (首行文本, 分割文本 (行数据 [1], 字符 (9), ))
    赋值 (行数, 取数组成员数 (行数据))
    赋值 (列数, 取数组成员数 (首行文本))
    赋值 (数据源行数, 数据源.取行数 ())
    赋值 (数据源列数, 数据源.取列数 ())
    
    .如果 (不等于 (数据源列数, 列数))
        信息框 (“您复制的EXCEL表格内容与现数据源列数不相等!”, 0, )
        返回 ()
    .否则
        数据源.添加行 (行数)
        跳到 (相减 (数据源.取行数 (), 行数))
        
        .变量循环首 (1, 行数, 1, a)
            重定义数组 (列数据, 假, 列数)
            赋值 (列数据, 分割文本 (行数据 [a], 字符 (9), ))
            .变量循环首 (1, 列数, 1, b)
                数据源.置文本 (a, b, 列数据 [b])
                
            .变量循环尾 ()
        .变量循环尾 ()
    .如果结束
    
    数据源.保存更改 ()
    数据源.刷新显示 ()
    
    
.否则
    信息框 (“您还没有复制ACCESS表格内容！”, 0, )
.如果结束


.子程序 _统计按钮_被单击, 空白型, , 
.局部变量 字段名, 文本型, , , 
.局部变量 方式, 整数型, , , 

.如果 (替换打开 (相加 (文件路径, “data.fxg”), , , , , mm, ))
    赋值 (.内容, “”)
    赋值 (字段名, .取项目文本 (.现行选中项))
    赋值 (方式, 相加 (.现行选中项, 1))
    .如果 (并且 (不等于 (字段名, “”), 不等于 (方式, 0)))
        .如果真 (等于 (方式, 1))
            赋值 (.内容, 到文本 (求和 (读 (字段名), )))
        .如果真结束
        .如果真 (等于 (方式, 2))
            赋值 (.内容, 到文本 (取最大值 (读 (字段名), )))
        .如果真结束
        .如果真 (等于 (方式, 3))
            赋值 (.内容, 到文本 (取最小值 (读 (字段名), )))
        .如果真结束
        .如果真 (等于 (方式, 4))
            赋值 (.内容, 到文本 (取平均值 (读 (字段名), )))
            
        .如果真结束
        
        
    .否则
        信息框 (“请注意只有数据型的字段才支持此统计功能!”, 0, )
    .如果结束
    
.否则
    
.如果结束

全部关闭 ()

.子程序 _组合框2_列表项被选择, 空白型, , 
赋值 (.内容, “”)

.子程序 _组合框3_列表项被选择, 空白型, , 
赋值 (.内容, “”)


.子程序 _主窗口_尺寸被改变, 空白型, , 
.局部变量 宽, 空白型, , , 
.局部变量 高, 空白型, , , 

赋值 (宽, 主窗口.)
赋值 (高, 主窗口.)

赋值 (.顶边, 相减 (高, 120))
赋值 (.宽度, 相减 (宽, 40))
赋值 (., 相减 (高, 180))
赋值 (.宽度, 相减 (宽, 200))
赋值 (.高度, 相减 (高, 220))
赋值 (.宽度, 相减 (宽, 180))
赋值 (.高度, 相减 (高, 180))
赋值 (.宽度, 相减 (宽, 252))
连续赋值 (相减 (宽, 220), .宽度, .宽度)
连续赋值 (相减 (宽, 232), .宽度, .宽度)
连续赋值 (相减 (高, 220), .高度, .高度)
赋值 (.左边, 相减 (相除 (.宽度, 2), 相除 (.宽度, 2)))
赋值 (.左边, 相减 (相除 (.宽度, 2), 相除 (.宽度, 2)))


.子程序 _统计和数据导出按钮_被单击, 空白型, , 
_刷新按钮_被单击 ()
赋值 (.现行子夹, 8)
连续赋值 (真, .可视, .可视)

.子程序 _确定按钮_被单击, 空白型, , 
.如果 (等于 (.内容, 用户变量 [用户项], 密码))
    .如果 (并且 (不等于 (权限, 4), 不等于 (权限, 2)))
        连续赋值 (真, .可视, .可视)
        赋值 (.内容, “”)
        
    .否则
        信息框 (“您没有统计和导出数据的权限，请联系超级管理员开通！”, 0, )
        
    .如果结束
    
.否则
    连续赋值 (假, .可视, .可视)
    信息框 (“呵呵~~密码不对,所以无权操作!”, #警告图标, “密码不对”)
    获取焦点 ()
    赋值 (.被选择字符数, -1)
    
    
.如果结束


.子程序 _普通退出按钮_被单击, 空白型, , 
赋值 (.内容, “”)
_工具条1_被单击 (11)
连续赋值 (假, .可视, .可视)


.子程序 _全部记录表格_光标位置改变, 空白型, , 
取光标行号 ().跳到 ()


.子程序 _组合框4_列表项被选择, 空白型, , 
获取焦点 ()
赋值 (.数据库文件名, “”)

.子程序 _备份按钮_被单击, 空白型, , 
.局部变量 备份位置, 文本型, , , 
.局部变量 文件名, 文本型, , , 

赋值 (备份位置, 未知支持库函数_2 (“请为您的数据库备份文件选择一个合适的位置.”, ))
.如果真 (不等于 (备份位置, “”))
    赋值 (文件名, 相加 (“备份”, 程序名, 到文本 (取现行时间 ())))
    赋值 (备份位置, 相加 (备份位置, “\”))
    .如果 (复制文件 (相加 (文件路径, “data.fxg”), 相加 (备份位置, 文件名, “.bak”)))
        信息框 (“请注意:只有超级管理员的密码与备份此文件此时的密码一致,才可以将此文件导入数据库!”, 相加 (0, #信息图标), 相加 (“备份成功:”, 备份位置, 文件名, “.bak”))
    .否则
        
    .如果结束
    
.如果真结束


.子程序 _导入备份按钮_被单击, 空白型, , 
.局部变量 备份结构, 文本型, , "0", 
.局部变量 现在结构, 文本型, , "0", 
.局部变量 i, 空白型, , , 

.如果 (打开 ())
    .如果 (替换打开 (.文件名, , , , , mm, ))
        
        重定义数组 (备份结构, 假, 取字段数 ())
        .变量循环首 (1, 取字段数 (), 1, i)
            赋值 (备份结构 [i], 取字段名 (i))
        .变量循环尾 ()
        
        打开 (相加 (文件路径, “data.fxg”), , , , , mm, )
        置当前库 (相加 (文件路径, “data.fxg”))
        
        .如果 (等于 (信息框 (“确实要将备份数据库的内容覆盖现在的数据库吗?”, 相加 (1, #询问图标), “导入数据库备份文件”), #确认钮))
            重定义数组 (现在结构, 假, 取字段数 ())
            .变量循环首 (1, 取字段数 (), 1, i)
                赋值 (现在结构 [i], 取字段名 (i))
            .变量循环尾 ()
            
            .如果 (等于 (到字节集 (现在结构), 到字节集 (备份结构)))
                清空 ()
                .如果 (添加 (.文件名, , ))
                    信息框 (“导入数据库文件成功!您可以退出数据库管理操作,去查询相关记录了”, 0, )
                .否则
                    信息框 (“导入备份数据库文件失败!有可能是备份数据库结构与当前数据库的结构不相符!”, 0, )
                .如果结束
                
                
            .否则
                信息框 (“备份文件的数据库结构与目前数据库的结构不相同,所以无法导入!”, #错误图标, )
            .如果结束
            
        .否则
            
        .如果结束
        
        全部关闭 ()
        
    .否则
        信息框 (“只有当前超级管理员的密码与备份文件生成时的的超级管理员密码一致时,才可以进行导入备份文件操作.”, 0, )
    .如果结束
    
    
    
.否则
    
.如果结束


.窗口程序集 关于窗口程序集, , , 

.子程序 _power_创建完毕, 空白型, , 
赋值 (.图片, #bmp)


.窗口程序集 窗口程序集2, , , 

.子程序 _登录窗口_创建完毕, 空白型, , 
未知支持库函数_0 (1)
赋值 (登录窗口., 相加 (程序名, “----”, 登录窗口.))
“超级管理员”.加入项目 ()

.如果真 (大于 (用户数, 0))
    .变量循环首 (1, 用户数, 1, 通用变量)
        用户变量.加入项目 ( [通用变量], 用户名, )
    .变量循环尾 ()
    
.如果真结束

赋值 (.现行选中项, 0)
.如果 (等于 (运行次数, 1))
    赋值 (.内容, 相加 (“第一次运行”, 程序名, “,超级管理员初始密码为:123,请登录后立即点选超级管理员菜单修改密码！”))
    
.否则
    赋值 (.内容, 相加 (“本程序第”, 到文本 (运行次数), “次登录!”))
    
.如果结束



.子程序 _登录按钮_被单击, 空白型, , 
.局部变量 号, 整数型, , , 
.局部变量 次, 整数型, 静态, , 

.如果 (不等于 (.内容, “”))
    赋值 (号, .现行选中项)
    .如果 (等于 (号, 0))
        .如果 (等于 (.内容, 到文本 (管理)))
            
            赋值 (登录用户, “超级管理员”)
            赋值 (权限, 5)
            
            载入 (主窗口, , 假)
            登录窗口.销毁 ()
            
        .否则
            信息框 (“密码不正确!”, 相加 (0, #警告图标), “错误”)
            赋值 (次, 相加 (次, 1))
            获取焦点 ()
            赋值 (.被选择字符数, -1)
            赋值 (.内容, 相加 (“您只有”, 到文本 (相减 (3, 次)), “次输入正确密码的机会啦！”))
            .如果 (等于 (次, 3))
                结束 ()
            .否则
                
            .如果结束
            
        .如果结束
        
    .否则
        .如果 (并且 (等于 (号.取项目文本 (), 用户变量 [号], 用户名), 等于 (.内容, 用户变量 [号], 密码)))
            赋值 (登录用户, 用户变量 [号], 用户名)
            .如果真 (并且 (等于 (用户变量 [号], 浏览权限, 真), 等于 (用户变量 [号], 录入权限, 假)))
                赋值 (权限, 1)
            .如果真结束
            .如果真 (并且 (等于 (用户变量 [号], 浏览权限, 假), 等于 (用户变量 [号], 录入权限, 真)))
                赋值 (权限, 2)
            .如果真结束
            .如果真 (并且 (等于 (用户变量 [号], 浏览权限, 真), 等于 (用户变量 [号], 录入权限, 真)))
                赋值 (权限, 3)
            .如果真结束
            .如果真 (并且 (等于 (用户变量 [号], 浏览权限, 假), 等于 (用户变量 [号], 录入权限, 假)))
                赋值 (权限, 4)
            .如果真结束
            
            
            载入 (假)
            销毁 ()
            
        .否则
            信息框 (“密码不正确!”, 相加 (0, #警告图标), “错误”)
            赋值 (次, 相加 (次, 1))
            获取焦点 ()
            赋值 (.被选择字符数, -1)
            赋值 (.内容, 相加 (“您只有”, 到文本 (相减 (3, 次)), “次输入正确密码的机会啦！”))
            .如果 (等于 (次, 3))
                结束 ()
            .否则
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.否则
    信息框 (“密码不能为空!”, 相加 (0, #警告图标), “密码为空”)
.如果结束



 ' 不属于任何一个程序集、类模块的函数：
