 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 405
    高度 = 210
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 真
    底图 =  ' 已保存到：D:\易语言学习\Data\电话表查询.e\_启动窗口_底图
    图标 =  ' 已保存到：D:\易语言学习\Data\电话表查询.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “电话查询程序 v1.4”
    帮助文件名 = “”

窗口 表格窗口
    左边 = 50
    顶边 = 50
    宽度 = 400
    高度 = 331
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\电话表查询.e\表格窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “迷你114查号台-列表修改器”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 430
    高度 = 300
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\电话表查询.e\关于窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 导入窗口
    左边 = 50
    顶边 = 50
    宽度 = 799
    高度 = 405
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\电话表查询.e\导入窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “批量导入Excel内容”
    帮助文件名 = “”



.图片 图标1, " ' 已保存到：D:\易语言学习\Data\电话表查询.e\图标1", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二





.窗口程序集 主程序集, , , 

.程序集变量 记录数组, 整数型, , "2", 
.程序集变量 标签表当前页, 整数型, , , 
.程序集变量 标签表当前行, 整数型, , , 
.程序集变量 鼠标位置, 整数型, , , 
.程序集变量 上次查询内容, 文本型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 存档成功, 逻辑型, , , 
.局部变量 取消成功, 逻辑型, , , 


赋值 (标签表当前行, 1)
_查询按钮_被单击 ()

赋值 (存档成功, 置文件属性 (取执行文件名 (), 32))
赋值 (取消成功, 置文件属性 (取执行文件名 (), 0))
.如果真 (取反 (并且 (存档成功, 取消成功)))
    信息框 (“    本程序在只读环境中无法正常运行，请取消磁盘的写保护。如果程序在光盘中,请将程序复制到硬盘或优盘中使用。”, 0, “ 程序不能在只读环境中运行。”)
    结束 ()
.如果真结束

.如果真 (取反 (文件是否存在 (“DHB.EDB”)))
    建立数据库 ()
    _输入按钮_被单击 ()
    标签表帮助 (1)
.如果真结束
置文件属性 (“DHB.EDB”, 32)
打开 (“DHB.EDB”, , , , , , )
赋值 (_启动窗口., #图标1)
_启动窗口.置托盘图标 (#图标1, “迷你114查号台”)



.子程序 _查询按钮_被单击, 空白型, , 

赋值 (.禁止, 真)
赋值 (.禁止, 假)
赋值 (.禁止, 假)

赋值 (., 真)
赋值 (., 假)
赋值 (.边框, 5)

赋值 (.禁止, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)

赋值 (.禁止, 真)
赋值 (.禁止, 真)

赋值 (.标题, “智能查询输入”)
赋值 (.内容, “”)
赋值 (上次查询内容, “”)
获取焦点 ()

重定义数组 (记录数组, 假, 0)

清空输入框表 ()
标签表帮助 (0)


.子程序 _输入按钮_被单击, 空白型, , 

赋值 (.禁止, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 假)

赋值 (.边框, 0)
赋值 (.文本颜色, #黑色)
赋值 (.背景颜色, #白色)
赋值 (., 假)
赋值 (., 真)

赋值 (.禁止, 真)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
获取焦点 ()

赋值 (.标题, “总记录数”)
赋值 (.内容, 到文本 (取记录数 ()))

重定义数组 (记录数组, 假, 0)

清空标签表 ()
清空输入框表 ()


.子程序 _表格按钮_被单击, 空白型, , 

赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 真)

载入 (表格窗口, , 假)


.子程序 _确定按钮_被单击, 空白型, , 

加记录 (到全角 (.内容), 到全角 (.内容), .内容, .内容, .内容, .内容, .内容)
赋值 (.内容, 到文本 (取记录数 ()))

清空输入框表 ()

获取焦点 ()
返回 ()


.子程序 _确定按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 


.如果真 (等于 (键代码, #回车键))
    _确定按钮_被单击 ()
.如果真结束


.子程序 _确定按钮_获得焦点, 空白型, , 
赋值 (_启动窗口., 假)

.子程序 _上翻页按钮_被单击, 空白型, , 
.局部变量 实际页数, 整数型, , , 


赋值 (实际页数, 相减 (整除 (相加 (取数组成员数 (记录数组), 4), 5), 1))
.如果真 (大于 (标签表当前页, 实际页数))
    赋值 (标签表当前页, 实际页数)
.如果真结束
.如果真 (大于 (标签表当前页, 0))
    赋值 (标签表当前页, 相减 (标签表当前页, 1))
    更新标签表 ()
.如果真结束
翻页键状态 ()
更新输入框表 (标签表当前行)


.子程序 _下翻页按钮_被单击, 空白型, , 
.局部变量 实际页数, 整数型, , , 


赋值 (实际页数, 相减 (整除 (相加 (取数组成员数 (记录数组), 4), 5), 1))
.如果真 (小于 (标签表当前页, 0))
    赋值 (标签表当前页, 0)
.如果真结束
.如果真 (小于 (标签表当前页, 实际页数))
    赋值 (标签表当前页, 相加 (标签表当前页, 1))
    更新标签表 ()
.如果真结束
翻页键状态 ()
更新输入框表 (标签表当前行)


.子程序 _关闭按钮_被单击, 空白型, , 
置托盘图标 ()
关闭 ()
结束 ()

.子程序 _帮助按钮_被单击, 空白型, , 
载入 (关于窗口, _启动窗口, 真)


.子程序 _导入按钮_被单击, 空白型, , 
载入 (导入窗口, , 真)


.子程序 __启动窗口_托盘事件, 空白型, , 
.参数 操作类型, 整数型, , 


赋值 (_启动窗口., 真)
赋值 (_启动窗口., 假)
赋值 (_启动窗口., 真)
赋值 (_启动窗口., 假)


.子程序 _标签表1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 


.如果真 (不等于 (鼠标位置, 1))
    赋值 (鼠标位置, 1)
    
    赋值 (.背景颜色, #黄色)
    赋值 (.背景颜色, #银白)
    赋值 (.背景颜色, 16769473)
    赋值 (.背景颜色, #银白)
    赋值 (.背景颜色, 16769473)
    
    更新输入框表 (1)
    赋值 (标签表当前行, 1)
.如果真结束


.子程序 _标签表2_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 


.如果真 (不等于 (鼠标位置, 2))
    赋值 (鼠标位置, 2)
    
    赋值 (.背景颜色, 16769473)
    赋值 (.背景颜色, #黄色)
    赋值 (.背景颜色, 16769473)
    赋值 (.背景颜色, #银白)
    赋值 (.背景颜色, 16769473)
    
    更新输入框表 (2)
    赋值 (标签表当前行, 2)
.如果真结束


.子程序 _标签表3_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 


.如果真 (不等于 (鼠标位置, 3))
    赋值 (鼠标位置, 3)
    
    赋值 (.背景颜色, 16769473)
    赋值 (.背景颜色, #银白)
    赋值 (.背景颜色, #黄色)
    赋值 (.背景颜色, #银白)
    赋值 (.背景颜色, 16769473)
    
    更新输入框表 (3)
    赋值 (标签表当前行, 3)
.如果真结束


.子程序 _标签表4_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 


.如果真 (不等于 (鼠标位置, 4))
    赋值 (鼠标位置, 4)
    
    赋值 (.背景颜色, 16769473)
    赋值 (.背景颜色, #银白)
    赋值 (.背景颜色, 16769473)
    赋值 (.背景颜色, #黄色)
    赋值 (.背景颜色, 16769473)
    
    更新输入框表 (4)
    赋值 (标签表当前行, 4)
.如果真结束


.子程序 _标签表5_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 


.如果真 (不等于 (鼠标位置, 5))
    赋值 (鼠标位置, 5)
    
    赋值 (.背景颜色, 16769473)
    赋值 (.背景颜色, #银白)
    赋值 (.背景颜色, 16769473)
    赋值 (.背景颜色, #银白)
    赋值 (.背景颜色, #黄色)
    
    更新输入框表 (5)
    赋值 (标签表当前行, 5)
.如果真结束


.子程序 __启动窗口_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 


.如果真 (不等于 (鼠标位置, 0))
    赋值 (鼠标位置, 0)
    
    赋值 (.背景颜色, 16769473)
    赋值 (.背景颜色, #银白)
    赋值 (.背景颜色, 16769473)
    赋值 (.背景颜色, #银白)
    赋值 (.背景颜色, 16769473)
.如果真结束


.子程序 建立数据库, 空白型, , 
.局部变量 结构, 字段信息, , "8", 


赋值 (结构 [1].名称, “姓名”)
赋值 (结构 [1].类型, #文本型)
赋值 (结构 [1].最大文本长度, 10)
赋值 (结构 [2].名称, “单位”)
赋值 (结构 [2].类型, #文本型)
赋值 (结构 [2].最大文本长度, 24)
赋值 (结构 [3].名称, “备注”)
赋值 (结构 [3].类型, #文本型)
赋值 (结构 [3].最大文本长度, 32)
赋值 (结构 [4].名称, “办公”)
赋值 (结构 [4].类型, #文本型)
赋值 (结构 [4].最大文本长度, 13)
赋值 (结构 [5].名称, “家里”)
赋值 (结构 [5].类型, #文本型)
赋值 (结构 [5].最大文本长度, 13)
赋值 (结构 [6].名称, “手机”)
赋值 (结构 [6].类型, #文本型)
赋值 (结构 [6].最大文本长度, 11)
赋值 (结构 [7].名称, “小灵通”)
赋值 (结构 [7].类型, #文本型)
赋值 (结构 [7].最大文本长度, 13)
创建 (“DHB.EDB”, 结构)
返回 ()


.子程序 模糊查询, 整数型, , 返回查询到的记录数量
.参数 被查内容, 文本型, , 被查询的"首拼"或"数字"文本内容

.局部变量 临时变量, 整数型, , , 
.局部变量 内容长度, 整数型, , , 
.局部变量 循环变量, 整数型, , , 
.局部变量 几种可能, 整数型, , , 
.局部变量 检查内容, 文本型, , , 


赋值 (几种可能, 1)
赋值 (内容长度, 取文本长度 (被查内容))
.如果真 (大于 (内容长度, 0))
    赋值 (临时变量, 取代码 (被查内容, 1))
    .如果 (或者 (小于 (临时变量, 48), 大于 (临时变量, 57)))
        赋值 (临时变量, 内容长度)
        .如果真 (大于 (临时变量, 1))
            赋值 (循环变量, 0)
            .计次循环首 (相减 (临时变量, 1), 循环变量)
                赋值 (检查内容, 取文本中间 (被查内容, 循环变量, 2))
                .如果真 (等于 (检查内容, “ai”))
                    赋值 (内容长度, 相减 (内容长度, 1))
                .如果真结束
                .如果真 (等于 (检查内容, “ei”))
                    赋值 (内容长度, 相减 (内容长度, 1))
                .如果真结束
                .如果真 (等于 (检查内容, “ao”))
                    赋值 (几种可能, 相加 (几种可能, 1))
                    赋值 (内容长度, 相减 (内容长度, 1))
                .如果真结束
                .如果真 (等于 (检查内容, “ou”))
                    赋值 (内容长度, 相减 (内容长度, 1))
                .如果真结束
                .如果真 (等于 (检查内容, “an”))
                    赋值 (几种可能, 相加 (几种可能, 1))
                    赋值 (内容长度, 相减 (内容长度, 1))
                .如果真结束
                .如果真 (等于 (检查内容, “en”))
                    赋值 (几种可能, 相加 (几种可能, 1))
                    赋值 (内容长度, 相减 (内容长度, 1))
                .如果真结束
                .如果真 (等于 (检查内容, “er”))
                    赋值 (几种可能, 相加 (几种可能, 1))
                    赋值 (内容长度, 相减 (内容长度, 1))
                .如果真结束
                
            .计次循环尾 ()
        .如果真结束
        .如果真 (大于 (临时变量, 2))
            赋值 (循环变量, 0)
            .计次循环首 (相减 (临时变量, 2), 循环变量)
                赋值 (检查内容, 取文本中间 (被查内容, 循环变量, 3))
                .如果真 (等于 (检查内容, “ang”))
                    赋值 (几种可能, 相加 (几种可能, 1))
                    赋值 (内容长度, 相减 (内容长度, 1))
                .如果真结束
                
            .计次循环尾 ()
        .如果真结束
        返回 (汉字查询 (被查内容, 内容长度, 几种可能))
    .否则
        返回 (数字查询 (被查内容))
    .如果结束
    
.如果真结束
重定义数组 (记录数组, 假, 0)
返回 (0)


.子程序 汉字查询, 整数型, , 返回查询到的记录数量.被查询的字段为,姓名、单位、备注.
.参数 被查内容, 文本型, , 被查询的首拼文本内容
.参数 最小长度, 整数型, , 被查询的首拼所对应的查询字数
.参数 几种可能, 整数型, , 被查询的韵母字有几种可能

.局部变量 主循环数, 整数型, , , 
.局部变量 次循环数, 整数型, , , 
.局部变量 韵母计数, 整数型, , , 
.局部变量 子循环数, 整数型, , , 
.局部变量 真记录数, 整数型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 临时文本, 文本型, , , 
.局部变量 文本长度, 整数型, , , 
.局部变量 查询结果, 逻辑型, , , 
.局部变量 总长度, 整数型, , , 


赋值 (最小长度, 相乘 (最小长度, 2))
.如果真 (等于 (最小长度, 0))
    重定义数组 (记录数组, 假, 0)
    返回 (0)
.如果真结束
赋值 (记录总数, 取记录数 ())
重定义数组 (记录数组, 假, 记录总数)
到首记录 ()
赋值 (真记录数, 0)
赋值 (主循环数, 0)
.计次循环首 (记录总数, 主循环数)
    跳到 (主循环数)
    赋值 (查询结果, 假)
    赋值 (次循环数, 0)
    .计次循环首 (3, 次循环数)
        赋值 (临时文本, “”)
        赋值 (临时文本, 读 (次循环数))
        赋值 (文本长度, 取文本长度 (临时文本))
        赋值 (韵母计数, 0)
        .计次循环首 (几种可能, 韵母计数)
            赋值 (总长度, 相加 (最小长度, 相乘 (相减 (韵母计数, 1), 2)))
            .如果真 (大于或等于 (文本长度, 总长度))
                赋值 (子循环数, 0)
                .计次循环首 (相除 (相加 (相减 (文本长度, 总长度), 2), 2), 子循环数)
                    赋值 (查询结果, 输入字比较 (被查内容, 取文本中间 (临时文本, 相减 (相乘 (子循环数, 2), 1), 总长度), 假, 1))
                    .如果真 (等于 (查询结果, 真))
                        跳出循环 ()
                    .如果真结束
                    
                .计次循环尾 ()
            .如果真结束
            .如果真 (等于 (查询结果, 真))
                跳出循环 ()
            .如果真结束
            
        .计次循环尾 ()
        .如果真 (等于 (查询结果, 真))
            赋值 (真记录数, 相加 (真记录数, 1))
            赋值 (记录数组 [真记录数], 主循环数)
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
.计次循环尾 ()
重定义数组 (记录数组, 真, 真记录数)
返回 (真记录数)


.子程序 数字查询, 整数型, , 返回查询到的记录数量.被查询的字段为,备注、办公、家里、手机、小灵通.
.参数 被查内容, 文本型, , 被查询的数字文本内容

.局部变量 主循环数, 整数型, , , 
.局部变量 次循环数, 整数型, , , 
.局部变量 子循环数, 整数型, , , 
.局部变量 真记录数, 整数型, , , 
.局部变量 查询字数, 整数型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 临时文本, 文本型, , , 
.局部变量 文本长度, 整数型, , , 
.局部变量 查询结果, 逻辑型, , , 


赋值 (查询字数, 取文本长度 (被查内容))
.如果真 (等于 (查询字数, 0))
    重定义数组 (记录数组, 假, 0)
    返回 (0)
.如果真结束
赋值 (记录总数, 取记录数 ())
重定义数组 (记录数组, 假, 记录总数)
到首记录 ()
赋值 (真记录数, 0)
赋值 (主循环数, 0)
.计次循环首 (记录总数, 主循环数)
    跳到 (主循环数)
    赋值 (查询结果, 假)
    赋值 (次循环数, 0)
    .计次循环首 (5, 次循环数)
        赋值 (临时文本, “”)
        赋值 (临时文本, 读 (相加 (次循环数, 2)))
        赋值 (文本长度, 取文本长度 (临时文本))
        .如果真 (大于或等于 (文本长度, 查询字数))
            赋值 (子循环数, 0)
            .计次循环首 (相加 (相减 (文本长度, 查询字数), 1), 子循环数)
                .如果真 (等于 (被查内容, 取文本中间 (临时文本, 子循环数, 查询字数)))
                    赋值 (查询结果, 真)
                    跳出循环 ()
                .如果真结束
                
            .计次循环尾 ()
        .如果真结束
        .如果真 (等于 (查询结果, 真))
            赋值 (真记录数, 相加 (真记录数, 1))
            赋值 (记录数组 [真记录数], 主循环数)
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
.计次循环尾 ()
重定义数组 (记录数组, 真, 真记录数)
返回 (真记录数)


.子程序 翻页键状态, 空白型, , 
.局部变量 最大页数, 整数型, , , 


赋值 (最大页数, 相减 (整除 (相加 (取数组成员数 (记录数组), 4), 5), 1))
.如果 (小于 (最大页数, 1))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (标签表当前页, 0)
.否则
    .如果 (大于 (标签表当前页, 0))
        赋值 (.禁止, 假)
    .否则
        赋值 (.禁止, 真)
        赋值 (标签表当前页, 0)
    .如果结束
    .如果 (小于 (标签表当前页, 最大页数))
        赋值 (.禁止, 假)
    .否则
        赋值 (.禁止, 真)
        赋值 (标签表当前页, 最大页数)
    .如果结束
    
.如果结束
返回 ()


.子程序 标签表帮助, 空白型, , 
.参数 显示第几条, 整数型, 可空, 


.如果真 (等于 (显示第几条, 0))
    赋值 (.标题, “ 请在智能查询输入框中输入要查询的电话号码，或汉字的首拼字母。”)
    赋值 (.标题, “ 查询电话号码，可以输入电话号中任意几位连续数字进行模糊查询。”)
    赋值 (.标题, “ 查询汉字信息时，只需输入每个字的拼音声母即可查询，非常方便。”)
    赋值 (.标题, “ 汉字查询同样也可以输入中间几个连续字的声母进行模糊查询。”)
    赋值 (.标题, “ 遇到韵母字时须将韵母全部输入。如：二(er)、安(an)、昂(ang)等。”)
.如果真结束

.如果真 (等于 (显示第几条, 1))
    赋值 (.标题, “ 欢迎使用电话表智能查询程序，本程序拥有智能中文首拼查询功能。”)
    赋值 (.标题, “ 首次运行本程序时，会在程序所在文件夹内创建数据库文件 DHB.EDB 。”)
    赋值 (.标题, “ 新建的数据库文件是空文件，您必须输入一些信息才能使用查询功能。”)
    赋值 (.标题, “ 您可以逐条输入信息，也可从Excel电子表格中用复制和粘贴导入信息。”)
    赋值 (.标题, “ 您所输入的全部信息都被保存在 DHB.EDB 文件内。请妥善保存此文件。”)
.如果真结束



.子程序 更新标签表, 空白型, , 
.局部变量 记录数量, 整数型, , , 
.局部变量 标签页五, 整数型, , , 
.局部变量 剩余数量, 整数型, , , 


赋值 (标签页五, 相乘 (标签表当前页, 5))
赋值 (记录数量, 取数组成员数 (记录数组))
赋值 (剩余数量, 相减 (记录数量, 标签页五))

.如果真 (小于 (标签表当前行, 1))
    赋值 (标签表当前行, 1)
.如果真结束
.如果真 (大于 (标签表当前行, 剩余数量))
    赋值 (标签表当前行, 剩余数量)
.如果真结束

.如果 (等于 (标签表当前行, 1))
    赋值 (.背景颜色, #黄色)
.否则
    赋值 (.背景颜色, 16769473)
.如果结束
.如果 (等于 (标签表当前行, 2))
    赋值 (.背景颜色, #黄色)
.否则
    赋值 (.背景颜色, #银白)
.如果结束
.如果 (等于 (标签表当前行, 3))
    赋值 (.背景颜色, #黄色)
.否则
    赋值 (.背景颜色, 16769473)
.如果结束
.如果 (等于 (标签表当前行, 4))
    赋值 (.背景颜色, #黄色)
.否则
    赋值 (.背景颜色, #银白)
.如果结束
.如果 (等于 (标签表当前行, 5))
    赋值 (.背景颜色, #黄色)
.否则
    赋值 (.背景颜色, 16769473)
.如果结束

.如果 (大于 (记录数量, 0))
    赋值 (.标题, 相加 (到文本 (记录数量), “条”))
    赋值 (.标题, 相加 (到文本 (相加 (标签表当前页, 1)), “/”, 到文本 (整除 (相加 (记录数量, 4), 5)), “页”))
.否则
    赋值 (.标题, “”)
    赋值 (.标题, “”)
.如果结束

.如果 (大于 (剩余数量, 0))
    跳到 (记录数组 [相加 (标签页五, 1)])
    赋值 (.标题, 相加 (到文本 (相加 (标签页五, 1)), “ ”, 读 (1), “ ”, 读 (2), “ ”, 读 (3), “ ”, 读 (4), “ ”, 读 (5), “ ”, 读 (6), “ ”, 读 (7)))
.否则
    赋值 (.标题, “”)
.如果结束

.如果 (大于 (剩余数量, 1))
    跳到 (记录数组 [相加 (标签页五, 2)])
    赋值 (.标题, 相加 (到文本 (相加 (标签页五, 2)), “ ”, 读 (1), “ ”, 读 (2), “ ”, 读 (3), “ ”, 读 (4), “ ”, 读 (5), “ ”, 读 (6), “ ”, 读 (7)))
.否则
    赋值 (.标题, “”)
.如果结束

.如果 (大于 (剩余数量, 2))
    跳到 (记录数组 [相加 (标签页五, 3)])
    赋值 (.标题, 相加 (到文本 (相加 (标签页五, 3)), “ ”, 读 (1), “ ”, 读 (2), “ ”, 读 (3), “ ”, 读 (4), “ ”, 读 (5), “ ”, 读 (6), “ ”, 读 (7)))
.否则
    赋值 (.标题, “”)
.如果结束

.如果 (大于 (剩余数量, 3))
    跳到 (记录数组 [相加 (标签页五, 4)])
    赋值 (.标题, 相加 (到文本 (相加 (标签页五, 4)), “ ”, 读 (1), “ ”, 读 (2), “ ”, 读 (3), “ ”, 读 (4), “ ”, 读 (5), “ ”, 读 (6), “ ”, 读 (7)))
.否则
    赋值 (.标题, “”)
.如果结束

.如果 (大于 (剩余数量, 4))
    跳到 (记录数组 [相加 (标签页五, 5)])
    赋值 (.标题, 相加 (到文本 (相加 (标签页五, 5)), “ ”, 读 (1), “ ”, 读 (2), “ ”, 读 (3), “ ”, 读 (4), “ ”, 读 (5), “ ”, 读 (6), “ ”, 读 (7)))
.否则
    赋值 (.标题, “”)
.如果结束

返回 ()


.子程序 改变标签行, 空白型, , 改变标签表当前行的显示状态
.参数 是否上移, 逻辑型, 可空, 此值为"真"表示要向上移动当前行,如为"假"则表示向下移动.

.局部变量 标签页乘五, 整数型, , , 
.局部变量 数组长度, 整数型, , , 


赋值 (标签页乘五, 相乘 (标签表当前页, 5))
赋值 (数组长度, 取数组成员数 (记录数组))

.如果真 (小于 (标签表当前行, 1))
    赋值 (标签表当前行, 1)
.如果真结束
.如果真 (大于 (标签表当前行, 相减 (数组长度, 标签页乘五)))
    赋值 (标签表当前行, 相减 (数组长度, 标签页乘五))
.如果真结束

.如果 (等于 (是否上移, 真))
    .如果 (大于 (标签表当前行, 1))
        赋值 (标签表当前行, 相减 (标签表当前行, 1))
    .否则
        .如果 (大于 (标签表当前页, 0))
            赋值 (标签表当前页, 相减 (标签表当前页, 1))
            赋值 (标签表当前行, 5)
        .否则
            
        .如果结束
        
    .如果结束
    
.否则
    .如果 (大于 (相减 (整除 (相加 (数组长度, 4), 5), 1), 标签表当前页))
        .如果 (小于 (标签表当前行, 5))
            赋值 (标签表当前行, 相加 (标签表当前行, 1))
        .否则
            赋值 (标签表当前页, 相加 (标签表当前页, 1))
            赋值 (标签表当前行, 1)
        .如果结束
        
    .否则
        .如果 (大于 (相减 (数组长度, 标签页乘五), 标签表当前行))
            赋值 (标签表当前行, 相加 (标签表当前行, 1))
        .否则
            赋值 (标签表当前行, 相减 (数组长度, 标签页乘五))
        .如果结束
        
    .如果结束
    
.如果结束
更新标签表 ()
返回 ()


.子程序 清空标签表, 空白型, , 

赋值 (.标题, “”)
赋值 (.标题, “”)
赋值 (.标题, “”)
赋值 (.标题, “”)
赋值 (.标题, “”)
返回 ()


.子程序 清空输入框表, 空白型, , 

赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)


.子程序 更新输入框表, 空白型, , 
.参数 显示那条, 整数型, 可空, 显示某条标签的内容.注意:此数值不能大于5.如不输入默认为1.

.局部变量 范围容器, 整数型, , , 
.局部变量 数组长度, 整数型, , , 


赋值 (范围容器, 相乘 (标签表当前页, 5))
赋值 (数组长度, 取数组成员数 (记录数组))
.如果真 (小于 (显示那条, 1))
    赋值 (显示那条, 1)
.如果真结束
.如果真 (大于 (显示那条, 5))
    赋值 (显示那条, 5)
.如果真结束
.如果真 (大于 (相减 (数组长度, 范围容器), 0))
    .如果真 (小于或等于 (相加 (范围容器, 显示那条), 数组长度))
        跳到 (记录数组 [相加 (范围容器, 显示那条)])
        赋值 (.内容, 读 (1))
        赋值 (.内容, 读 (2))
        赋值 (.内容, 读 (3))
        赋值 (.内容, 读 (4))
        赋值 (.内容, 读 (5))
        赋值 (.内容, 读 (6))
        赋值 (.内容, 读 (7))
    .如果真结束
    
.如果真结束
返回 ()


.子程序 _姓名框_获得焦点, 空白型, , 
赋值 (_启动窗口., 真)
赋值 (.背景颜色, #白色)
赋值 (.被选择字符数, -1)

.子程序 _姓名框_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)

.子程序 _手机框_获得焦点, 空白型, , 
赋值 (_启动窗口., 真)
赋值 (.背景颜色, #白色)
赋值 (.被选择字符数, -1)

.子程序 _手机框_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)

.子程序 _家里框_获得焦点, 空白型, , 
赋值 (_启动窗口., 真)
赋值 (.背景颜色, #白色)
赋值 (.被选择字符数, -1)

.子程序 _家里框_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)

.子程序 _单位框_获得焦点, 空白型, , 
赋值 (_启动窗口., 真)
赋值 (.背景颜色, #白色)
赋值 (.被选择字符数, -1)

.子程序 _单位框_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)

.子程序 _办公框_获得焦点, 空白型, , 
赋值 (_启动窗口., 真)
赋值 (.背景颜色, #白色)
赋值 (.被选择字符数, -1)

.子程序 _办公框_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)

.子程序 _备注框_获得焦点, 空白型, , 
赋值 (_启动窗口., 真)
赋值 (.背景颜色, #白色)
赋值 (.被选择字符数, -1)

.子程序 _备注框_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)

.子程序 _小灵通框_获得焦点, 空白型, , 
赋值 (_启动窗口., 真)
赋值 (.背景颜色, #白色)
赋值 (.被选择字符数, -1)

.子程序 _小灵通框_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)

.子程序 _查询框_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)
赋值 (.被选择字符数, -1)

.子程序 _查询框_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)

.子程序 _查询框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 


.如果真 (等于 (键代码, #回车键))
    赋值 (.被选择字符数, -1)
.如果真结束

清空标签表 ()

.如果真 (等于 (键代码, #PageUp键))
    _上翻页按钮_被单击 ()
.如果真结束
.如果真 (等于 (键代码, #PageDown键))
    _下翻页按钮_被单击 ()
.如果真结束

.如果真 (等于 (键代码, #左光标键))
    _上翻页按钮_被单击 ()
.如果真结束
.如果真 (等于 (键代码, #右光标键))
    _下翻页按钮_被单击 ()
.如果真结束

.如果真 (等于 (键代码, #上光标键))
    改变标签行 (真)
.如果真结束
.如果真 (等于 (键代码, #下光标键))
    改变标签行 (假)
.如果真结束


.子程序 _查询框_放开某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 


.如果真 (不等于 (.内容, 上次查询内容))
    赋值 (上次查询内容, .内容)
    模糊查询 (.内容)
.如果真结束
更新标签表 ()
翻页键状态 ()
更新输入框表 (标签表当前行)



.窗口程序集 表格程序集, , , 

.子程序 _表格窗口_创建完毕, 空白型, , 

赋值 (表格窗口., 750)
赋值 (表格窗口., 550)
_显示100比例_被选择 ()

赋值 (.数据库文件名, “DHB.EDB”)


.子程序 _表格窗口_尺寸被改变, 空白型, , 

赋值 (.左边, 1)
赋值 (.顶边, 1)
赋值 (.宽度, 相减 (表格窗口.取用户区宽度 (), 2))
赋值 (.高度, 相减 (表格窗口.取用户区高度 (), 2))


.子程序 _表格窗口_将被销毁, 空白型, , 
_查询按钮_被单击 ()


.子程序 _退出_被选择, 空白型, , 
表格窗口.销毁 ()


.子程序 _关于_被选择, 空白型, , 
载入 (关于窗口, 表格窗口, 真)

.子程序 _剪切_被选择, 空白型, , 
取光标行号 ().复制 (取光标列号 (), 取选择行数 (), 取选择列数 ())
取光标行号 ().清除 (取光标列号 (), 取选择行数 (), 取选择列数 ())


.子程序 _复制_被选择, 空白型, , 
取光标行号 ().复制 (取光标列号 (), 取选择行数 (), 取选择列数 ())


.子程序 _粘贴_被选择, 空白型, , 
粘贴到光标处 ()


.子程序 _增加记录_被选择, 空白型, , 
.添加行 ()

.子程序 _删除记录_被选择, 空白型, , 
取光标行号 ().删除行 (取选择行数 ())

.子程序 _表格_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _从Excel批量导入数据_被选择, 空白型, , 
载入 (导入窗口, , 假)
表格窗口.销毁 ()
导入窗口.调整层次 (3)


.子程序 _显示100比例_被选择, 空白型, , 

赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.缩放比, 100)


.子程序 _显示90比例_被选择, 空白型, , 

赋值 (.选中, 假)
赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.缩放比, 90)


.子程序 _显示80比例_被选择, 空白型, , 

赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 真)
赋值 (.缩放比, 80)



.窗口程序集 关于程序集, , , 

.子程序 _关闭按钮_被单击, 空白型, , 
关于窗口.销毁 ()

.窗口程序集 导入程序集, , , 

.程序集变量 按钮状态, 逻辑型, , , 
.程序集变量 是否导入, 逻辑型, , , 
.子程序 _导入窗口_创建完毕, 空白型, , 

赋值 (导入窗口., 400)
赋值 (导入窗口., 799)
赋值 (.禁止, 真)
赋值 (按钮状态, 真)
赋值 (是否导入, 假)
组件位置 ()


.子程序 _导入窗口_尺寸被改变, 空白型, , 
.局部变量 有效高度, 整数型, , , 
.局部变量 中层高度, 整数型, , , 
.局部变量 下层位置, 整数型, , , 


.如果真 (不等于 (导入窗口., 799))
    赋值 (导入窗口., 799)
.如果真结束
.如果真 (小于 (导入窗口., 300))
    赋值 (导入窗口., 300)
.如果真结束

赋值 (有效高度, 导入窗口.取用户区高度 ())
赋值 (中层高度, 相减 (有效高度, 80))
赋值 (下层位置, 相减 (有效高度, 21))

赋值 (.高度, 中层高度)
赋值 (.高度, 中层高度)
赋值 (.高度, 中层高度)
赋值 (.高度, 中层高度)
赋值 (.高度, 中层高度)
赋值 (.高度, 中层高度)
赋值 (.高度, 中层高度)

赋值 (.顶边, 下层位置)
赋值 (.顶边, 下层位置)
赋值 (.顶边, 下层位置)
赋值 (.顶边, 下层位置)
赋值 (.顶边, 下层位置)
赋值 (.顶边, 下层位置)
赋值 (.顶边, 下层位置)



.子程序 组件位置, 空白型, , 

赋值 (.顶边, 3)
赋值 (.左边, 3)
赋值 (.宽度, 675)
赋值 (.高度, 35)

赋值 (.左边, 3)
赋值 (.左边, 3)
赋值 (.左边, 3)
赋值 (.左边, 85)
赋值 (.左边, 85)
赋值 (.左边, 85)
赋值 (.左边, 226)
赋值 (.左边, 226)
赋值 (.左边, 226)
赋值 (.左边, 403)
赋值 (.左边, 403)
赋值 (.左边, 403)
赋值 (.左边, 503)
赋值 (.左边, 503)
赋值 (.左边, 503)
赋值 (.左边, 603)
赋值 (.左边, 603)
赋值 (.左边, 603)
赋值 (.左边, 691)
赋值 (.左边, 691)
赋值 (.左边, 691)

赋值 (.宽度, 80)
赋值 (.宽度, 80)
赋值 (.宽度, 80)
赋值 (.宽度, 139)
赋值 (.宽度, 139)
赋值 (.宽度, 139)
赋值 (.宽度, 175)
赋值 (.宽度, 175)
赋值 (.宽度, 175)
赋值 (.宽度, 98)
赋值 (.宽度, 98)
赋值 (.宽度, 98)
赋值 (.宽度, 98)
赋值 (.宽度, 98)
赋值 (.宽度, 98)
赋值 (.宽度, 86)
赋值 (.宽度, 86)
赋值 (.宽度, 86)
赋值 (.宽度, 98)
赋值 (.宽度, 98)
赋值 (.宽度, 98)

赋值 (.顶边, 41)
赋值 (.顶边, 41)
赋值 (.顶边, 41)
赋值 (.顶边, 41)
赋值 (.顶边, 41)
赋值 (.顶边, 41)
赋值 (.顶边, 41)

赋值 (.顶边, 59)
赋值 (.顶边, 59)
赋值 (.顶边, 59)
赋值 (.顶边, 59)
赋值 (.顶边, 59)
赋值 (.顶边, 59)
赋值 (.顶边, 59)



.子程序 分析行数, 整数型, , 
.参数 处理文本, 文本型, , 

.局部变量 循环计数, 整数型, , , 
.局部变量 字符数量, 整数型, , , 
.局部变量 行数, 整数型, , , 


赋值 (字符数量, 取文本长度 (处理文本))
.计次循环首 (字符数量, 循环计数)
    .如果 (等于 (字符数量, 循环计数))
        .如果真 (并且 (不等于 (取代码 (处理文本, 相减 (循环计数, 1)), 13), 不等于 (取代码 (处理文本, 循环计数), 10)))
            赋值 (行数, 相加 (行数, 1))
        .如果真结束
        
    .否则
        .如果真 (并且 (等于 (取代码 (处理文本, 循环计数), 13), 等于 (取代码 (处理文本, 相加 (循环计数, 1)), 10)))
            赋值 (行数, 相加 (行数, 1))
        .如果真结束
        
    .如果结束
    
.计次循环尾 ()
返回 (行数)



.子程序 最大行数, 整数型, , 
.局部变量 行数数组, 整数型, , "7", 
.局部变量 循环计数, 整数型, , , 
.局部变量 最大值, 整数型, , , 


赋值 (行数数组 [1], 分析行数 (.内容))
赋值 (行数数组 [2], 分析行数 (.内容))
赋值 (行数数组 [3], 分析行数 (.内容))
赋值 (行数数组 [4], 分析行数 (.内容))
赋值 (行数数组 [5], 分析行数 (.内容))
赋值 (行数数组 [6], 分析行数 (.内容))
赋值 (行数数组 [7], 分析行数 (.内容))
赋值 (最大值, 0)
.计次循环首 (7, 循环计数)
    .如果真 (大于 (行数数组 [循环计数], 最大值))
        赋值 (最大值, 行数数组 [循环计数])
    .如果真结束
    
.计次循环尾 ()
返回 (最大值)



.子程序 汉字过滤, 文本型, , 
.参数 过滤文本, 文本型, , 
.参数 过滤长度, 整数型, , 

.局部变量 主循环数, 整数型, , , 
.局部变量 子循环数, 整数型, , , 
.局部变量 新文本, 文本型, , , 
.局部变量 临时文本, 文本型, , , 
.局部变量 临时长度, 整数型, , , 
.局部变量 保留文本, 文本型, , , 
.局部变量 文本长度, 整数型, , , 
.局部变量 上段结尾, 整数型, , , 
.局部变量 输出新行, 逻辑型, , , 


赋值 (新文本, “”)
赋值 (文本长度, 取文本长度 (过滤文本))
赋值 (上段结尾, 1)
.计次循环首 (文本长度, 主循环数)
    
    .如果 (等于 (文本长度, 主循环数))
        .如果真 (并且 (不等于 (取代码 (过滤文本, 相减 (主循环数, 1)), 13), 不等于 (取代码 (过滤文本, 主循环数), 10)))
            赋值 (临时文本, 取文本中间 (过滤文本, 上段结尾, 相减 (相加 (主循环数, 1), 上段结尾)))
            赋值 (输出新行, 真)
        .如果真结束
        
    .否则
        .如果真 (并且 (等于 (取代码 (过滤文本, 主循环数), 13), 等于 (取代码 (过滤文本, 相加 (主循环数, 1)), 10)))
            赋值 (临时文本, 取文本中间 (过滤文本, 上段结尾, 相减 (主循环数, 上段结尾)))
            赋值 (上段结尾, 相加 (主循环数, 2))
            赋值 (输出新行, 真)
        .如果真结束
        
    .如果结束
    
    .如果真 (输出新行)
        赋值 (保留文本, “”)
        赋值 (临时文本, 删全部空 (临时文本))
        赋值 (临时长度, 取文本长度 (临时文本))
        .计次循环首 (临时长度, 子循环数)
            .如果真 (小于 (取代码 (临时文本, 子循环数), 0))
                赋值 (保留文本, 相加 (保留文本, 取文本中间 (临时文本, 子循环数, 1)))
            .如果真结束
            
        .计次循环尾 ()
        .如果真 (大于 (取文本长度 (保留文本), 过滤长度))
            赋值 (保留文本, 取文本左边 (保留文本, 过滤长度))
        .如果真结束
        赋值 (新文本, 相加 (新文本, 保留文本, 字符 (13), 字符 (10)))
        赋值 (输出新行, 假)
    .如果真结束
    
.计次循环尾 ()
赋值 (文本长度, 取文本长度 (新文本))
.判断循环首 (并且 (等于 (取代码 (新文本, 相减 (文本长度, 1)), 13), 等于 (取代码 (新文本, 文本长度), 10)))
    赋值 (新文本, 取文本左边 (新文本, 相减 (文本长度, 2)))
    赋值 (文本长度, 取文本长度 (新文本))
.判断循环尾 ()
赋值 (新文本, 相加 (新文本, 字符 (13), 字符 (10)))
返回 (新文本)




.子程序 数字过滤, 文本型, , 
.参数 过滤文本, 文本型, , 
.参数 过滤长度, 整数型, , 

.局部变量 主循环数, 整数型, , , 
.局部变量 子循环数, 整数型, , , 
.局部变量 新文本, 文本型, , , 
.局部变量 临时文本, 文本型, , , 
.局部变量 临时长度, 整数型, , , 
.局部变量 保留文本, 文本型, , , 
.局部变量 文本长度, 整数型, , , 
.局部变量 上段结尾, 整数型, , , 
.局部变量 输出新行, 逻辑型, , , 


赋值 (新文本, “”)
赋值 (文本长度, 取文本长度 (过滤文本))
赋值 (上段结尾, 1)
.计次循环首 (文本长度, 主循环数)
    
    .如果 (等于 (文本长度, 主循环数))
        .如果真 (并且 (不等于 (取代码 (过滤文本, 相减 (主循环数, 1)), 13), 不等于 (取代码 (过滤文本, 主循环数), 10)))
            赋值 (临时文本, 取文本中间 (过滤文本, 上段结尾, 相减 (相加 (主循环数, 1), 上段结尾)))
            赋值 (输出新行, 真)
        .如果真结束
        
    .否则
        .如果真 (并且 (等于 (取代码 (过滤文本, 主循环数), 13), 等于 (取代码 (过滤文本, 相加 (主循环数, 1)), 10)))
            赋值 (临时文本, 取文本中间 (过滤文本, 上段结尾, 相减 (主循环数, 上段结尾)))
            赋值 (上段结尾, 相加 (主循环数, 2))
            赋值 (输出新行, 真)
        .如果真结束
        
    .如果结束
    
    .如果真 (输出新行)
        赋值 (保留文本, “”)
        赋值 (临时文本, 到半角 (临时文本))
        赋值 (临时文本, 删首尾空 (临时文本))
        赋值 (临时长度, 取文本长度 (临时文本))
        .计次循环首 (临时长度, 子循环数)
            .如果真 (大于或等于 (取代码 (临时文本, 子循环数), 0))
                赋值 (保留文本, 相加 (保留文本, 取文本中间 (临时文本, 子循环数, 1)))
            .如果真结束
            
        .计次循环尾 ()
        .如果真 (大于 (取文本长度 (保留文本), 过滤长度))
            赋值 (保留文本, 取文本左边 (保留文本, 过滤长度))
        .如果真结束
        赋值 (新文本, 相加 (新文本, 保留文本, 字符 (13), 字符 (10)))
        赋值 (输出新行, 假)
    .如果真结束
    
.计次循环尾 ()
赋值 (文本长度, 取文本长度 (新文本))
.判断循环首 (并且 (等于 (取代码 (新文本, 相减 (文本长度, 1)), 13), 等于 (取代码 (新文本, 文本长度), 10)))
    赋值 (新文本, 取文本左边 (新文本, 相减 (文本长度, 2)))
    赋值 (文本长度, 取文本长度 (新文本))
.判断循环尾 ()
赋值 (新文本, 相加 (新文本, 字符 (13), 字符 (10)))
返回 (新文本)



.子程序 混合过滤, 文本型, , 
.参数 过滤文本, 文本型, , 
.参数 过滤长度, 整数型, , 

.局部变量 主循环数, 整数型, , , 
.局部变量 子循环数, 整数型, , , 
.局部变量 新文本, 文本型, , , 
.局部变量 临时文本, 文本型, , , 
.局部变量 临时长度, 整数型, , , 
.局部变量 文本长度, 整数型, , , 
.局部变量 上段结尾, 整数型, , , 
.局部变量 输出新行, 逻辑型, , , 
.局部变量 全角字数, 整数型, , , 


赋值 (新文本, “”)
赋值 (文本长度, 取文本长度 (过滤文本))
赋值 (上段结尾, 1)
.计次循环首 (文本长度, 主循环数)
    
    .如果 (等于 (文本长度, 主循环数))
        .如果真 (并且 (不等于 (取代码 (过滤文本, 相减 (主循环数, 1)), 13), 不等于 (取代码 (过滤文本, 主循环数), 10)))
            赋值 (临时文本, 取文本中间 (过滤文本, 上段结尾, 相减 (相加 (主循环数, 1), 上段结尾)))
            赋值 (输出新行, 真)
        .如果真结束
        
    .否则
        .如果真 (并且 (等于 (取代码 (过滤文本, 主循环数), 13), 等于 (取代码 (过滤文本, 相加 (主循环数, 1)), 10)))
            赋值 (临时文本, 取文本中间 (过滤文本, 上段结尾, 相减 (主循环数, 上段结尾)))
            赋值 (上段结尾, 相加 (主循环数, 2))
            赋值 (输出新行, 真)
        .如果真结束
        
    .如果结束
    
    .如果真 (输出新行)
        赋值 (临时文本, 到半角 (临时文本))
        赋值 (临时文本, 删首尾空 (临时文本))
        赋值 (临时长度, 取文本长度 (临时文本))
        .如果真 (大于 (临时长度, 过滤长度))
            赋值 (临时文本, 取文本左边 (临时文本, 过滤长度))
            赋值 (临时长度, 取文本长度 (临时文本))
            .如果真 (小于 (取代码 (临时文本, 临时长度), 0))
                赋值 (全角字数, 1)
                .计次循环首 (过滤长度, 子循环数)
                    .如果 (小于 (取代码 (临时文本, 相减 (临时长度, 子循环数)), 0))
                        赋值 (全角字数, 相加 (全角字数, 1))
                    .否则
                        跳出循环 ()
                    .如果结束
                    
                .计次循环尾 ()
                .如果真 (不等于 (相乘 (整除 (全角字数, 2), 2), 全角字数))
                    赋值 (临时文本, 取文本左边 (临时文本, 相减 (临时长度, 1)))
                .如果真结束
                
            .如果真结束
            
        .如果真结束
        赋值 (新文本, 相加 (新文本, 临时文本, 字符 (13), 字符 (10)))
        赋值 (输出新行, 假)
    .如果真结束
    
.计次循环尾 ()
赋值 (文本长度, 取文本长度 (新文本))
.判断循环首 (并且 (等于 (取代码 (新文本, 相减 (文本长度, 1)), 13), 等于 (取代码 (新文本, 文本长度), 10)))
    赋值 (新文本, 取文本左边 (新文本, 相减 (文本长度, 2)))
    赋值 (文本长度, 取文本长度 (新文本))
.判断循环尾 ()
赋值 (新文本, 相加 (新文本, 字符 (13), 字符 (10)))
返回 (新文本)



.子程序 _编辑框1_内容被改变, 空白型, , 
赋值 (.标题, 相加 (“共有”, 到文本 (分析行数 (.内容)), “行”))


.子程序 _编辑框2_内容被改变, 空白型, , 
赋值 (.标题, 相加 (“共有”, 到文本 (分析行数 (.内容)), “行”))

.子程序 _编辑框3_内容被改变, 空白型, , 
赋值 (.标题, 相加 (“共有”, 到文本 (分析行数 (.内容)), “行”))

.子程序 _编辑框4_内容被改变, 空白型, , 
赋值 (.标题, 相加 (“共有”, 到文本 (分析行数 (.内容)), “行”))

.子程序 _编辑框5_内容被改变, 空白型, , 
赋值 (.标题, 相加 (“共有”, 到文本 (分析行数 (.内容)), “行”))


.子程序 _编辑框6_内容被改变, 空白型, , 
赋值 (.标题, 相加 (“共有”, 到文本 (分析行数 (.内容)), “行”))

.子程序 _编辑框7_内容被改变, 空白型, , 
赋值 (.标题, 相加 (“共有”, 到文本 (分析行数 (.内容)), “行”))

.子程序 _导入按钮_被单击, 空白型, , 
.局部变量 内容行数, 整数型, , , 
.局部变量 输入内容, 文本型, , , 
.局部变量 内容数组, 文本型, , "7,1", 
.局部变量 主循环数, 整数型, , , 
.局部变量 字符数量, 整数型, , , 
.局部变量 子循环数, 整数型, , , 
.局部变量 上段结尾, 整数型, , , 
.局部变量 行累计数, 整数型, , , 


赋值 (内容行数, 最大行数 ())
.如果真 (小于 (内容行数, 1))
    赋值 (.标题, “请先将要导入的数据粘贴到对应区域内。”)
    返回 ()
.如果真结束
重定义数组 (内容数组, 假, 7, 内容行数)

.计次循环首 (7, 主循环数)
    
    .如果真 (等于 (主循环数, 1))
        赋值 (输入内容, 汉字过滤 (.内容, 10))
    .如果真结束
    .如果真 (等于 (主循环数, 2))
        赋值 (输入内容, 汉字过滤 (.内容, 24))
    .如果真结束
    .如果真 (等于 (主循环数, 3))
        赋值 (输入内容, 混合过滤 (.内容, 32))
    .如果真结束
    .如果真 (等于 (主循环数, 4))
        赋值 (输入内容, 数字过滤 (.内容, 13))
    .如果真结束
    .如果真 (等于 (主循环数, 5))
        赋值 (输入内容, 数字过滤 (.内容, 13))
    .如果真结束
    .如果真 (等于 (主循环数, 6))
        赋值 (输入内容, 数字过滤 (.内容, 11))
    .如果真结束
    .如果真 (等于 (主循环数, 7))
        赋值 (输入内容, 数字过滤 (.内容, 13))
    .如果真结束
    
    赋值 (字符数量, 取文本长度 (输入内容))
    .如果真 (大于 (字符数量, 0))
        .如果 (大于 (字符数量, 1))
            赋值 (上段结尾, 1)
            赋值 (行累计数, 0)
            .计次循环首 (字符数量, 子循环数)
                .如果 (等于 (字符数量, 子循环数))
                    .如果真 (并且 (不等于 (取代码 (输入内容, 相减 (子循环数, 1)), 13), 不等于 (取代码 (输入内容, 子循环数), 10)))
                        赋值 (行累计数, 相加 (行累计数, 1))
                        赋值 (内容数组 [主循环数] [行累计数], 取文本中间 (输入内容, 上段结尾, 相减 (相加 (子循环数, 1), 上段结尾)))
                    .如果真结束
                    
                .否则
                    .如果真 (并且 (等于 (取代码 (输入内容, 子循环数), 13), 等于 (取代码 (输入内容, 相加 (子循环数, 1)), 10)))
                        赋值 (行累计数, 相加 (行累计数, 1))
                        赋值 (内容数组 [主循环数] [行累计数], 取文本中间 (输入内容, 上段结尾, 相减 (子循环数, 上段结尾)))
                        赋值 (上段结尾, 相加 (子循环数, 2))
                    .如果真结束
                    
                .如果结束
                
            .计次循环尾 ()
        .否则
            赋值 (内容数组 [主循环数] [1], 取文本中间 (输入内容, 1, 1))
        .如果结束
        
    .如果真结束
    
.计次循环尾 ()
赋值 (输入内容, “”)

赋值 (主循环数, 0)
.计次循环首 (内容行数, 主循环数)
    加记录 (内容数组 [1] [主循环数], 内容数组 [2] [主循环数], 内容数组 [3] [主循环数], 内容数组 [4] [主循环数], 内容数组 [5] [主循环数], 内容数组 [6] [主循环数], 内容数组 [7] [主循环数])
.计次循环尾 ()

赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)

赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)

赋值 (.禁止, 真)
赋值 (按钮状态, 真)
赋值 (是否导入, 真)
赋值 (.标题, “整理数据”)
赋值 (.标题, “  请将`电子表格'中某一列数据选定并复制，然后粘贴到本窗口对应输入框中。当各列内容都逐个粘贴到对应输入框后，请点击`整理数据'按钮。数据整理之后即可将内容导入数据库中。”)



.子程序 _整理按钮_被单击, 空白型, , 
.局部变量 临时文本, 文本型, , , 


.如果真 (小于 (最大行数 (), 1))
    赋值 (.标题, “  提示：输入框中没有任何内容，请粘贴内容后再点击整理数据按钮。”)
    返回 ()
.如果真结束

.如果 (按钮状态)
    赋值 (临时文本, 汉字过滤 (.内容, 10))
    赋值 (.内容, 临时文本)
    赋值 (临时文本, 汉字过滤 (.内容, 24))
    赋值 (.内容, 临时文本)
    赋值 (临时文本, 混合过滤 (.内容, 32))
    赋值 (.内容, 临时文本)
    赋值 (临时文本, 数字过滤 (.内容, 13))
    赋值 (.内容, 临时文本)
    赋值 (临时文本, 数字过滤 (.内容, 13))
    赋值 (.内容, 临时文本)
    赋值 (临时文本, 数字过滤 (.内容, 11))
    赋值 (.内容, 临时文本)
    赋值 (临时文本, 数字过滤 (.内容, 13))
    赋值 (.内容, 临时文本)
    
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    
    赋值 (.禁止, 假)
    赋值 (按钮状态, 假)
    赋值 (.标题, “重新输入”)
    赋值 (.标题, “  为了便于查询，已将超过每列最大列宽的字符丢弃。姓名与单位名中只保留汉字，字母与数字都会被去除。办公电话、家庭电话、手机、小灵通都只保留数字。只有备注中保留各种字符。”)
    
.否则
    
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    
    赋值 (.禁止, 真)
    赋值 (按钮状态, 真)
    赋值 (.标题, “整理数据”)
    赋值 (.标题, “  请将`电子表格'中某一列数据选定并复制，然后粘贴到本窗口对应输入框中。当各列内容都逐个粘贴到对应输入框后，请点击`整理数据'按钮。数据整理之后即可将内容导入数据库中。”)
    
.如果结束


.子程序 _导入窗口_将被销毁, 空白型, , 
.如果真 (是否导入)
    载入 (表格窗口, , 假)
.如果真结束




 ' 不属于任何一个程序集、类模块的函数：
