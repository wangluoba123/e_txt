 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库





.DLL命令 GetVersion, 整数型, "kernel32.dll", "GetVersion", , ,

.窗口程序集 窗口程序集1, , , 

.子程序 _按钮1_被单击, 空白型, , 
信息框 (取操作系统 (), 64, “操作系统”)

.子程序 取操作系统, 文本型, , 5.0=Win 2000, 5.1=Win XP, 6.0=Vista
.局部变量 lnVer, 整数型, , , 
.局部变量 lnVerNum, 双精度小数型, , , 

赋值 (右移 (左移 (GetVersion (), 16), 16))
赋值 (lnVerNum, 相加 (位与 (lnVer, 255), 相除 (右移 (位与 (lnVer, 65280), 8), 10)))
输出调试文本 (lnVerNum)
.判断开始 (等于 (lnVerNum, 5))
    返回 (“Windows 2000”)
.判断 (等于 (lnVerNum, 5.1))
    返回 (“Windows XP”)
.判断 (等于 (lnVerNum, 5.2))
    返回 (“Windows Server 2003”)
.判断 (等于 (lnVerNum, 6))
    返回 (“Vista”)
.判断 (等于 (lnVerNum, 6.1))
    返回 (“Windows 7”)
.默认
    返回 (“？”)
.判断结束


















 ' 不属于任何一个程序集、类模块的函数：
