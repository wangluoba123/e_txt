 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = 9615478 '  0x92B876
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\公文写作助手.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “公文写作助手（免费版）”
    帮助文件名 = “”

窗口 添加资料
    左边 = 50
    顶边 = 50
    宽度 = 600
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\公文写作助手.e\添加资料_图标.ico
    背景音乐 =  ' 空
    标题 = “添加资料”
    帮助文件名 = “”

窗口 修改资料
    左边 = 50
    顶边 = 50
    宽度 = 600
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\公文写作助手.e\修改资料_图标.ico
    背景音乐 =  ' 空
    标题 = “修改资料”
    帮助文件名 = “”

窗口 关于
    左边 = 50
    顶边 = 50
    宽度 = 257
    高度 = 199
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\公文写作助手.e\关于_图标.ico
    背景音乐 =  ' 空
    标题 = “关于”
    帮助文件名 = “”

窗口 帮助
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\公文写作助手.e\帮助_图标.ico
    背景音乐 =  ' 空
    标题 = “帮助 ”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' eWord2000 F30A56A231354a4a81AB13B54EF21665 1 0 WORD2000支持库





.窗口程序集 窗口程序集1, , , 

.程序集变量 查询1, 空白型, , , 
.程序集变量 查询2, 空白型, , , 
.程序集变量 查询3, 空白型, , , 
.程序集变量 查询4, 空白型, , , 
.程序集变量 主索引, 整数型, , , 
.程序集变量 类别索引, 整数型, , , 
.程序集变量 字号索引, 整数型, , , 
.程序集变量 索引, 文本型, , , 
.程序集变量 记录, 文本型, , , 
.程序集变量 记录1, 文本型, , , 
.程序集变量 是否有子项目, 逻辑型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
相加 (取当前目录 (), “\data\abc.mdb”).打开MDB数据库 ()
清空 ()
赋值 (主索引, 0)
0.加入项目 (“全部资料”, , , )
目录 ()
0.置项目文本 (“全部资料”)
0.扩展 ()
赋值 (索引, “全部资料”)

.子程序 目录, 空白型, , 
赋值 (查询1, “select 分类 from xshk  group by 分类 ”.查询 ())
查询1.到首记录 ()
.判断循环首 (等于 (查询1.尾记录后 (), 假))
    0.加入项目 (到文本 (查询1.读 (1)), 0, , )
    0.置图片 (5)
    0.置选中图片 (2)
    赋值 (主索引, 相加 (主索引, 1))
    赋值 (记录, 查询1.读 (1))
    分类 ()
    查询1.到后一记录 ()
.判断循环尾 ()
查询1.关闭记录集 ()

.子程序 分类, 空白型, , 
赋值 (查询2, 相加 (“select 标题 from xshk where 分类='”, 记录, “' group by 标题 ”).查询 ())
查询2.到首记录 ()
赋值 (类别索引, 主索引)
.判断循环首 (等于 (查询2.尾记录后 (), 假))
    类别索引.加入项目 (到文本 (查询2.读 (1)), 0, , )
    类别索引.置图片 (8)
    类别索引.置选中图片 (2)
    赋值 (主索引, 相加 (主索引, 1))
    赋值 (记录1, 查询2.读 (1))
    标题 ()
    查询2.到后一记录 ()
.判断循环尾 ()
查询2.关闭记录集 ()

.子程序 标题, 空白型, , 
赋值 (查询3, 相加 (“select 章节 from xshk where 分类='”, 记录, “' and  标题='”, 记录1, “' group by 章节”).查询 ())
查询3.到首记录 ()
赋值 (字号索引, 主索引)
.判断循环首 (等于 (查询3.尾记录后 (), 假))
    字号索引.加入项目 (到文本 (查询3.读 (1)), 3, 0, )
    字号索引.置图片 (7)
    字号索引.置选中图片 (2)
    赋值 (主索引, 相加 (主索引, 1))
    查询3.到后一记录 ()
.判断循环尾 ()
查询3.关闭记录集 ()

.子程序 _树型框1_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

赋值 (索引, .取项目文本 (.最大化按钮))
赋值 (查询4, 相加 (“select * from xshk where 分类='”, .取父项目 (.最大化按钮).取父项目 ().取项目文本 (), “' and 标题='”, .取父项目 (.最大化按钮).取项目文本 (), “' and 章节='”, 索引, “' ”).查询 ())
查询4.到首记录 ()
赋值 (.内容, 到文本 (查询4.读 (4)))
查询4.关闭记录集 ()
.如果 (等于 (.是否有子项目 (.最大化按钮), 真))
    赋值 (是否有子项目, 真)
.否则
    赋值 (是否有子项目, 假)
.如果结束


.子程序 __启动窗口_尺寸被改变, 空白型, , 
240.移动 (70, 相减 (_启动窗口., 255), 相减 (_启动窗口., 112))
6.移动 (72, 相减 (.宽度, 3), 相减 (_启动窗口., 115))

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
.如果真 (等于 (信息框 (“是否真的退出？”, 相加 (#询问图标, #确认取消钮), “询问”), #确认钮))
    全部关闭 ()
    结束 ()
.如果真结束
返回 (假)

.子程序 _退出_被选择, 空白型, , 
__启动窗口_可否被关闭 ()

.子程序 _超级按钮1_被单击, 空白型, , 
载入 (添加资料, , 真)

.子程序 _超级按钮2_被单击, 空白型, , 
.如果真 (等于 (.最大化按钮, 0))
    信息框 (“请选择要修改的项目”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (是否有子项目, 真))
    信息框 (“该项目下有子项目,不能修改”, #警告图标, )
    返回 ()
.如果真结束
载入 (修改资料, , 真)

.子程序 _超级按钮3_被单击, 空白型, , 
.如果真 (等于 (.最大化按钮, 0))
    信息框 (“请选择要删除的项目”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (是否有子项目, 真))
    信息框 (“该项目下有子项目,不能删除”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“您真的要删除选中的资料吗？”, 相加 (#警告图标, #确认取消钮), “删除提示”), 1))
    返回 ()
.如果真结束
.如果 (等于 (相加 (“DELETE * FROM xshk  where 分类='”, .取父项目 (.最大化按钮).取父项目 ().取项目文本 (), “' and 标题='”, .取父项目 (.最大化按钮).取项目文本 (), “' and 章节='”, .取项目文本 (.最大化按钮), “'”).执行 (), 假))
    信息框 (“删除失败”, #信息图标, )
.否则
    信息框 (“删除成功”, #信息图标, )
    __启动窗口_创建完毕 ()
    赋值 (.内容, “”)
.如果结束


.子程序 _超级按钮4_被单击, 空白型, , 
载入 (帮助, , 真)

.子程序 _超级按钮5_被单击, 空白型, , 
载入 (关于, , 真)

.子程序 _超级按钮6_被单击, 空白型, , 
_退出_被选择 ()

.子程序 _超级按钮7_被单击, 空白型, , 
.如果真 (等于 (.最大化按钮, 0))
    信息框 (“请选择要导入的项目”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (是否有子项目, 真))
    信息框 (“该项目下有子项目,不能导入”, #警告图标, )
    返回 ()
.如果真结束
写到文件 (“txt.doc”, 到字节集 (.内容))
未知支持库函数_0 ()
赋值 (., 真)
.未知支持库函数_5 (真)
相加 (取运行目录 (), “\txt.doc”).未知支持库函数_12 ()


.窗口程序集 窗口程序集2, , , 

.程序集变量 记录, 整数型, , , 
.子程序 _超级按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _超级按钮1_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (“分类不能为空”, #警告图标, “提醒”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“标题不能为空”, #警告图标, “提醒”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“章节不能为空”, #警告图标, “提醒”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“内容不能为空”, #警告图标, “提醒”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果 (等于 (_启动窗口.执行 (., 相加 (“insert into xshk (分类,标题,章节,内容) values ('”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “')”), ), 真))
    信息框 (“添加成功”, #信息图标, “信息”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    销毁 ()
    __启动窗口_创建完毕 ()
.否则
    信息框 (“添加失败”, #错误图标, “信息”)
.如果结束


.子程序 _添加资料_创建完毕, 空白型, , 
赋值 (记录, _启动窗口.查询 (., “select distinct 分类 from xshk ”))
_启动窗口.到首记录 (., 记录)
.判断循环首 (等于 (_启动窗口.尾记录后 (., 记录), 假))
    _启动窗口.读 (., 记录, 1).加入项目 ()
    赋值 (.现行选中项, -1)
    _启动窗口.到后一记录 (., 记录)
.判断循环尾 ()
_启动窗口.关闭记录集 (., 记录)
赋值 (记录, _启动窗口.查询 (., “select distinct 标题 from xshk ”))
_启动窗口.到首记录 (., 记录)
.判断循环首 (等于 (_启动窗口.尾记录后 (., 记录), 假))
    _启动窗口.读 (., 记录, 1).加入项目 ()
    赋值 (.现行选中项, -1)
    _启动窗口.到后一记录 (., 记录)
.判断循环尾 ()
_启动窗口.关闭记录集 (., 记录)


.窗口程序集 窗口程序集3, , , 

.程序集变量 记录, 整数型, , , 
.子程序 _超级按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _超级按钮1_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (“内容不能为空”, #警告图标, “提醒”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果 (等于 (_启动窗口.执行 (., 相加 (“update xshk set 分类='”, .内容, “',”, “标题='”, .内容, “',”, “章节='”, .内容, “',”, “内容='”, .内容, “'”, “where 分类='”, .内容, “' and  标题='”, .内容, “' and  章节='”, .内容, “'”), ), 真))
    信息框 (“修改成功!”, #信息图标, “提示”)
    销毁 ()
    __启动窗口_创建完毕 ()
    赋值 (_启动窗口..内容, “”)
.否则
    信息框 (“修改失败”, #错误图标, “信息”)
.如果结束


.子程序 _修改资料_创建完毕, 空白型, , 
赋值 (记录, _启动窗口.查询 (., 相加 (“select * from xshk where 分类='”, _启动窗口.取项目文本 (., _启动窗口.取父项目 (., _启动窗口.取父项目 (., _启动窗口..最大化按钮))), “' and 标题='”, _启动窗口.取项目文本 (., _启动窗口.取父项目 (., _启动窗口..最大化按钮)), “' and 章节='”, _启动窗口.取项目文本 (., _启动窗口..最大化按钮), “' ”)))
_启动窗口.到首记录 (., 记录)
赋值 (.内容, _启动窗口.读 (., 记录, “分类”))
赋值 (.内容, _启动窗口.读 (., 记录, “标题”))
赋值 (.内容, _启动窗口.读 (., 记录, “章节”))
赋值 (.内容, _启动窗口.读 (., 记录, “内容”))
_启动窗口.关闭记录集 (., 记录)


 ' 不属于任何一个程序集、类模块的函数：
