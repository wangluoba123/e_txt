 ' 文件类型：未知类型

 ' 程序名称：文本保存
 ' 程序描述：文本保存模块
@备注:
文本保存模块
 ' 程序作者：Heihei7
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.1





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 3 系统核心支持库
 ' spec A512548E76954B6E92C21055517615B0 3 1 特殊功能支持库





.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码
调试输出 (“[ Heihei7 账号、数据 多编码文本输出 模块 Q:342219709 ]”)
返回 (0) ' 可以根据您的需要返回任意数值

.类模块 文本保存, , , 

.程序集变量 文件号组, 整数型, , "0", 
.程序集变量 当前编码格式, 整数型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用
关闭所有写出文件 ()

.子程序 初始化保存文件名, 逻辑型, , 文件基于运行目录 下 新建一个文件夹 后输出数据
.参数 写出名称, 文本型, 数组, 需要创建的项目名称数组，不包含后缀  例：正确输出 和 错误输出  只用{“正确输出”,“错误输出”}
.参数 文件夹名, 文本型, 可空, 输出文件夹名，空则默认为‘输出结果’
.参数 文本编码, 整数型, 可空, 输出数据编码，0=ANSI 1=UTF-8 2=Unicode  默认为 0,ANSI

.局部变量 打开路径, 文本型, , , 
.局部变量 计次, 空白型, , , 
.局部变量 参数_文件号, 空白型, , , 

.如果真 (或者 (小于 (文本编码, 0), 大于 (文本编码, 2)))
    返回 (假)
.如果真结束
.如果真 (或者 (是否为空 (文件夹名), 等于 (文件夹名, “”)))
    赋值 (文件夹名, “输出结果”)
.如果真结束

赋值 (打开路径, 相加 (取运行目录 (), “\”, 文件夹名))
.如果真 (等于 (文件是否存在 (打开路径), 假))
    .如果真 (等于 (创建目录 (打开路径), 假))
        返回 (假)
    .如果真结束
    
.如果真结束

赋值 (打开路径, 相加 (打开路径, “\”))
.计次循环首 (取数组成员数 (写出名称), 计次)
    赋值 (参数_文件号, 打开文件 (相加 (打开路径, 写出名称 [计次], “.txt”), #改读, 1))
    .如果真 (等于 (参数_文件号, 0))
        返回 (假)
    .如果真结束
    移到文件首 (参数_文件号)
    .如果真 (等于 (文本编码, 0)) ' ANSI
        .如果真 (或者 (等于 (读入字节集 (参数_文件号, 3), { 239, 187, 191 }), 等于 (读入字节集 (参数_文件号, 2), { 255, 254 })))
            删除数据 (参数_文件号, 取文件长度 (参数_文件号))
        .如果真结束
        
    .如果真结束
    .如果真 (等于 (文本编码, 1)) ' UTF8
        .如果真 (不等于 (读入字节集 (参数_文件号, 3), { 239, 187, 191 }))
            移到文件首 (参数_文件号)
            删除数据 (参数_文件号, 取文件长度 (参数_文件号))
            写出数据 (参数_文件号, { 239, 187, 191 })
        .如果真结束
        
    .如果真结束
    .如果真 (等于 (文本编码, 2)) ' Unicode
        .如果真 (不等于 (读入字节集 (参数_文件号, 2), { 255, 254 }))
            移到文件首 (参数_文件号)
            删除数据 (参数_文件号, 取文件长度 (参数_文件号))
            写出数据 (参数_文件号, { 255, 254 })
        .如果真结束
        
    .如果真结束
    移到文件尾 (参数_文件号)
    加入成员 (文件号组, 参数_文件号)
.计次循环尾 ()
赋值 (当前编码格式, 文本编码)
返回 (真)

.子程序 关闭所有写出文件, 空白型, , 
关闭所有文件 ()

.子程序 写出T, 逻辑型, , 写出文本型数据 ANSI 调用此程序集 
.参数 写出编号, 整数型, , 顺序与初始化 写出名称 顺序相符，从1开始
.参数 写出文本, 文本型, , 需要写出的文本行

返回 (写出U (写出编号, 到字节集 (写出文本)))

.子程序 写出U, 逻辑型, , 写出字节集数据 UTF-8、Unicode 调用此程序集 
.参数 写出编号, 整数型, , 顺序与初始化 写出名称 顺序相符，从1开始
.参数 写出数据, 字节集, , 需要写出的数据行

.局部变量 整理数据, 字节集, , , 

.如果真 (或者 (小于 (写出编号, 1), 大于 (写出编号, 取数组成员数 (文件号组))))
    返回 (假)
.如果真结束
.如果真 (等于 (当前编码格式, 0)) ' ANSI
    赋值 (整理数据, 相加 (写出数据, { 13, 10 }))
.如果真结束
.如果真 (等于 (当前编码格式, 1)) ' UTF-8
    赋值 (整理数据, 相加 (写出数据, { 13, 10 }))
.如果真结束
.如果真 (等于 (当前编码格式, 2)) ' Unicode
    赋值 (整理数据, 相加 (写出数据, { 13, 0, 10, 0 }))
.如果真结束
返回 (写出字节集 (文件号组 [写出编号], 整理数据))


 ' 不属于任何一个程序集、类模块的函数：
