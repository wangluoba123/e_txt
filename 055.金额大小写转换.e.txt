 ' 文件类型：Windows窗口程序

 ' 程序名称：易语言经典算法 - 金额大小写转换
 ' 程序描述：金额大小写转换。输入小写的数字金额形式，将其转换成大写的金额形式。
 ' 程序作者：大有吴涛易语言软件公司
 ' 邮政编码：116001
 ' 联系地址：辽宁省大连市中山区人民路55号亚太国际金融中心
 ' 联系电话：+86(0411)88995831
 ' 传真号码：+86(0411)88995834
 ' 电子信箱：service@dywt.com.cn
 ' 主页地址：http://www.dywt.com.cn
 ' 版权声明：祝您一帆风顺，心想事成！
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 400
    高度 = 282
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “易语言经典算法 - 金额大小写转换”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 2 0 扩展界面支持库三





.窗口程序集 启动窗口程序集, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
 ' 使用算法：
 ' 问题：金额大小写转换
 ' 问题描述：
 ' 金额大小写转换。输入小写的数字金额形式，将其转换成大写的金额形式。
 ' 问题分析：
 ' 金额的大小写转换，可以先定义两个文本串，一个用于存放大写的数字，比如：壹，贰，
 ' 参等；一个用存放对应每一个金额数字位的名称，比如：分，角，元，拾，佰等等。
 ' 转换时，只要找出每一个小写数字的对应大写形式和它的数字位名称即可。
 ' 通过上面规律可以推导出结果。
 ' 备注：

赋值 (.内容, “1234.56”)

.子程序 _计算图形按钮_被单击, 空白型, , 
.如果 (等于 (.内容, “”))
    赋值 (.标题, “没有输入要转换的数值！”)
    获取焦点 ()
.否则
    .如果 (小于 (相减 (寻找文本 (删首尾空 (.内容), “.”, , 假), 1), 12))
        赋值 (.标题, 大小写转换 (.内容))
    .否则
        赋值 (.标题, “输入的数字位数太长！”)
    .如果结束
    
.如果结束


.子程序 大小写转换, 文本型, , 
.参数 参数串, 文本型, , 接收输入的数字串

.局部变量 数字串1, 文本型, , , 存放输入的数字串
.局部变量 数字串2, 文本型, , , 存放待转换的数字串
.局部变量 串长度, 整数型, , , 存放给定的数字的长度
.局部变量 小数点位置, 整数型, , , 存放小数点的位置
.局部变量 转换后的数字, 文本型, , , 存放转换后的数字串
.局部变量 大写数字串, 文本型, , , 存放大写数字
.局部变量 数字位串, 文本型, , , 存放数字位名称
.局部变量 取出的数字, 文本型, , , 从待转换串中取出的数字
.局部变量 最后结果, 文本型, , , 

 ' 这里先初始化
赋值 (转换后的数字, “”)
赋值 (大写数字串, “零壹贰叁肆伍陆柒捌玖”)
赋值 (数字位串, “分角  元拾佰仟万拾佰仟亿拾佰”)
赋值 (数字串1, 删首尾空 (到文本 (取绝对值 (到数值 (参数串)))))
 ' 取出输入的串长度
赋值 (串长度, 取文本长度 (数字串1))
 ' 查找小数点所在的位置
赋值 (小数点位置, 寻找文本 (数字串1, “.”, , 假))
.如果 (等于 (小数点位置, -1))
    赋值 (小数点位置, 串长度)
.否则
    赋值 (小数点位置, 相减 (串长度, 寻找文本 (数字串1, “.”, , 假)))
.如果结束
 ' 将输入的数字变成金额形式的数字
.判断开始 (等于 (小数点位置, 串长度))
    赋值 (数字串2, 相加 (数字串1, “.00”))
.判断 (等于 (小数点位置, 1))
    赋值 (数字串2, 相加 (数字串1, “0”))
.判断 (等于 (小数点位置, 2))
    赋值 (数字串2, 数字串1)
     ' 只保留输入数字的两位小数
    赋值 (数字串2, 到文本 (四舍五入 (到数值 (数字串1), 2)))
.默认
    
.判断结束

 ' 取出待转换的串长度
赋值 (串长度, 取文本长度 (数字串2))
 ' 进行转换
.判断循环首 (大于或等于 (串长度, 1))
     ' 逐个取出每一个数字
    赋值 (取出的数字, 取文本中间 (数字串2, 相加 (相减 (取文本长度 (数字串2), 串长度), 1), 1))
     ' 逐个数字进行转换
    赋值 (转换后的数字, 相加 (转换后的数字, 选择 (不等于 (取出的数字, “.”), 相加 (取文本中间 (大写数字串, 相加 (相乘 (到数值 (取出的数字), 2), 1), 2), 删首尾空 (取文本中间 (数字位串, 相加 (相乘 (相减 (串长度, 1), 2), 1), 2))), “”)))
    赋值 (串长度, 相减 (串长度, 1))
.判断循环尾 ()
 ' 因为是金额，所以最后加一个“整”字
赋值 (最后结果, 相加 (“转换结果：”, 转换后的数字, “整”))
返回 (最后结果)


 ' 不属于任何一个程序集、类模块的函数：
