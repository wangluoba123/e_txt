 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 420
    高度 = 258
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “语音控制输入法 V 1.2”
    帮助文件名 = “”



.常量 配置文件名, "“xmbspz.ini”", , 
.常量 , , , 
.常量 步骤, "“1 中文  2 英文  3 大写  4 小写”", , 
.图片 图标1, " ' 已保存到：D:\易语言学习\Data\语音控制输入法.e\图标1", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 3 系统核心支持库
 ' ESpeechEngine 4AA6F3ADE9264fbe8B618A1FCD60364F 1 1 文本语音转换支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 0 应用接口支持库
 ' eMMedia 824F144B108A4bcbB966F45670D42A00 1 2 多媒体支持库




.全局变量 键盘布局, 整数型, , "25", 
.全局变量 目录, 文本型, , , 
.全局变量 布局名称, 文本型, , , 
.全局变量 索引值, 整数型, , , 

.DLL命令 获得键盘布局, 整数型, "", "GetKeyboardLayout", , 
    .参数 布局索引, 整数型, , 

.DLL命令 获得键盘布局列表, 整数型, "", "GetKeyboardLayoutList", , 
    .参数 缓冲, 整数型, , 
    .参数 布局数组, 整数型, 数组, 

.DLL命令 获得键盘布局名称, 整数型, "imm32.dll", "ImmGetDescriptionA", , 
    .参数 布局, 整数型, , 
    .参数 布局名称, 文本型, , 应该是容器的名称
    .参数 名称长度, 整数型, , 

.DLL命令 激活键盘布局, 整数型, "", "ActivateKeyboardLayout", , 
    .参数 布局, 整数型, , 
    .参数 标志, 整数型, , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 总数, 整数型, , , 
.程序集变量 音波上限, 整数型, , "0", 
.程序集变量 常用语句, 文本型, , "4", 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 次数, 整数型, , , 

获得键盘布局列表 (10, 键盘布局)
获取焦点 ()
.计次循环首 (20, 次数)
    .如果真 (等于 (键盘布局 [次数], 0))
        赋值 (总数, 相减 (次数, 1))
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
赋值 (.标题, 相加 (“您的系统已安装有输入法：”, 到文本 (总数), “种”))

赋值 (目录, 取当前目录 ())
赋值 (索引值, 1)
获得键盘布局列表 (25, 键盘布局)
激活键盘布局 (键盘布局 [到数值 (读配置项 (相加 (目录, “\”, #配置文件名), “GZDF”, “srf”, ))], 0)
赋值 (索引值, 1)
列表输入法 ()

 ' 把常用的词汇加入到数组变量中
赋值 (.标题, #步骤)
加入成员 (常用语句, “画板”)
加入成员 (常用语句, “计算器”)
加入成员 (常用语句, “记事本”)
加入成员 (常用语句, “扫雷”)
 ' 把我们保存在常用语句中的词汇加入到常用语句中。
0.未知支持库函数_11 (0) ' 我设置的是系统级语音识别
常用语句.未知支持库函数_14 ()
 ' 录音1.录制 ()
未知支持库函数_31 ()
.如果真 (等于 (未知支持库函数_32 (), 真))
    赋值 (.时钟周期, 10)
.如果真结束


.子程序 _语音识别_识别到语音, 空白型, , 
.参数 识别文本, 文本型, , 

.判断开始 (不等于 (寻找文本 (识别文本, “中文”, , 假), -1))
    .如果真 (等于 (未知支持库函数_0 (1), 真))
        未知支持库函数_1 (#CapsLock键, , )
    .如果真结束
    激活键盘布局 (键盘布局 [2], 0)
.判断 (不等于 (寻找文本 (识别文本, “英文”, , 假), -1))
    激活键盘布局 (键盘布局 [1], 0)
.判断 (或者 (不等于 (寻找文本 (识别文本, “大写”, , 假), -1), 不等于 (寻找文本 (识别文本, “大些”, , 假), -1)))
    .如果真 (不等于 (未知支持库函数_0 (1), 真))
        未知支持库函数_1 (#CapsLock键, , )
    .如果真结束
    
.判断 (或者 (不等于 (寻找文本 (识别文本, “小写”, , 假), -1), 不等于 (寻找文本 (识别文本, “消协”, , 假), -1), 不等于 (寻找文本 (识别文本, “小姐”, , 假), -1)))
    .如果真 (等于 (未知支持库函数_0 (1), 真))
        未知支持库函数_1 (#CapsLock键, , )
    .如果真结束
    
.默认
    
.判断结束
赋值 (.内容, 识别文本)

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
 ' 语音识别.释放 ()
{ .置托盘图标 ( }, “”)
返回 (真)


.子程序 _训练按钮_被单击, 空白型, , 
未知支持库函数_13 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 文本, 文本型, , , 
.局部变量 序号, 整数型, , , 

.如果真 (等于 (输入框 (“请输入输入法序号！”, “启动指定输入法：”, .标题, 文本, ), 假))
    返回 ()
.如果真结束
赋值 (序号, 到数值 (文本))
.如果真 (或者 (等于 (序号, 0), 大于 (序号, 总数)))
    赋值 (序号, 1)
.如果真结束
激活键盘布局 (键盘布局 [序号], 0)



.子程序 列表输入法, 空白型, , 
.局部变量 输入法, 整数型, , , 
.局部变量 I, 整数型, , , 

.计次循环首 (15, I) ' 15为设置循环的次数，没有哪位系统中安装了15位输入法吧，如果有，可更改此数字。
    赋值 (布局名称, 取空白文本 (255))
    获得键盘布局列表 (25, 键盘布局)
    获得键盘布局名称 (键盘布局 [索引值], 布局名称, 取文本长度 (布局名称))
    .如果 (等于 (索引值, 1))
        赋值 (布局名称, “英语(美国)”)
    .否则
        
    .如果结束
    
    .如果 (不等于 (删全部空 (布局名称), “”))
        布局名称.加入项目 ()
    .否则
        
    .如果结束
    赋值 (索引值, 相加 (索引值, 1))
.计次循环尾 ()
赋值 (.标题, 相加 (“本系统共安装了”, 到文本 (取项目数 ()), “种输入法”))
赋值 (输入法, 到数值 (读配置项 (相加 (目录, “\”, #配置文件名), “GZDF”, “srf”, )))
赋值 (.标题, 到文本 (输入法))
激活键盘布局 (键盘布局 [输入法], 0)
相减 (输入法, 1).选中项目 (真)
赋值 (.标题, 相加 (“你选中了”, #左引号, 相减 (输入法, 1).取项目文本 (), #右引号, “。”))

.子程序 _选择列表框1_列表项被选择, 空白型, , 
.局部变量 D, 整数型, , , 

.如果 (等于 (.是否被选中 (.现行选中项), 真))
    赋值 (D, 相加 (.现行选中项, 1))
    写配置项 (相加 (目录, “\”, #配置文件名), “GZDF”, “srf”, 到文本 (D))
.否则
    
.如果结束
.如果 (不等于 (D, 0))
    激活键盘布局 (键盘布局 [D], 0)
.否则
    
.如果结束
赋值 (.标题, 到文本 (相加 (.现行选中项, 1)))
赋值 (.标题, 相加 (“你选中了”, #左引号, 相减 (D, 1).取项目文本 (), #右引号, “。”))

.子程序 _按钮2_被单击, 空白型, , 
.如果真 (等于 (未知支持库函数_0 (1), 真))
    未知支持库函数_1 (#CapsLock键, , )
.如果真结束
激活键盘布局 (键盘布局 [2], 0)

.子程序 _按钮3_被单击, 空白型, , 
激活键盘布局 (键盘布局 [1], 0)

.子程序 _按钮5_被单击, 空白型, , 
.如果真 (不等于 (未知支持库函数_0 (1), 真))
    未知支持库函数_1 (#CapsLock键, , )
.如果真结束


.子程序 _按钮4_被单击, 空白型, , 
.如果真 (等于 (未知支持库函数_0 (1), 真))
    未知支持库函数_1 (#CapsLock键, , )
.如果真结束


.子程序 _时钟1_周期事件, 空白型, , 
.局部变量 计次变量, 整数型, , , 
.局部变量 音波, 短整数型, , , 

赋值 (.最大位置, 3000)
音波.未知支持库函数_37 (相减 (相除 (未知支持库函数_36 (), 2), 10))
赋值 (.位置, 到数值 (相减 (音波, 1000)))

.子程序 _显示主窗口_被选择, 空白型, , 
赋值 (_启动窗口.可视, 真)


.子程序 _关于本系统_被选择, 空白型, , 
信息框 (相加 (“这是个可以用语音控制打字时输入法状态的东东哦!”, #换行符, “本系统采用易语言的文本语音支持库,话筒好的话效果会更好一些!”, #换行符, “注意:WINXP用户可以直接用,XP以下系统需要安装微软语音库!”), 0, )


.子程序 _退出_被选择, 空白型, , 
_启动窗口.置托盘图标 ({  }, “”)
结束 ()

.子程序 __启动窗口_位置被改变, 空白型, , 
.如果真 (等于 (_启动窗口.位置, 2))
    _启动窗口.置托盘图标 (#图标1, “”)
    赋值 (_启动窗口.可视, 假)
.如果真结束


.子程序 __启动窗口_托盘事件, 空白型, , 
.参数 操作类型, 整数型, , 

.判断开始 (等于 (操作类型, 2))
    赋值 (_启动窗口.可视, 真)
.判断 (等于 (操作类型, 3))
    弹出托盘菜单 ()
.默认
    
.判断结束



 ' 不属于任何一个程序集、类模块的函数：
