 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假



.常量 服务端是客户, "1", , 请修改：谁是服务处理（服务端0）？  谁是客户处理（客户端1）？


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' commobj {A068799B-7551-46b9-8CA8-EEF8357AFEA4} 2 0 通用对象支持库
 ' spec A512548E76954B6E92C21055517615B0 3 0 特殊功能支持库





.窗口程序集 窗口程序集1, , , 

.程序集变量 客户, 未知类型0x20002, , , 
.程序集变量 服务, 未知类型0x20002, , , 
.子程序 客户发送数据, 逻辑型, , 
.参数 数据, 字节集, , 

返回 (相加 ({ 0, 0, 0, 0, 1, 2, 3, 4 }, 到字节集 (取字节集长度 (数据)), 数据).发送数据 ())

.子程序 服务发送数据, 逻辑型, , 
.参数 数据, 字节集, , 

返回 (.发送数据 (.标记, 相加 ({ 0, 0, 0, 0, 1, 2, 3, 4 }, 到字节集 (取字节集长度 (数据)), 数据), ))

.子程序 获取通信数据, 字节集, , 
.参数 数据类, 未知类型0x20002, , 

.局部变量 数据总长, 空白型, , , 
.局部变量 标志位置, 空白型, , , 
.局部变量 接收数量, 空白型, , , 
.局部变量 命令数据, 字节集, , , 

赋值 (数据总长, 数据类.未知支持库函数_83 ())
赋值 (标志位置, 数据类.未知支持库函数_94 ({ 0, 0, 0, 0, 1, 2, 3, 4 }, ))
.如果真 (不等于 (标志位置, -1))
    .如果真 (不等于 (标志位置, 1))
        数据类.未知支持库函数_89 (1, 标志位置)
        赋值 (标志位置, 1)
    .如果真结束
    赋值 (接收数量, 取字节集数据 (数据类.未知支持库函数_84 (相加 (标志位置, 8), 4), #整数型, ))
     ' 调试输出 (接收数量 ＋ 8 ＋ 4, 数据总长)
    .如果真 (小于或等于 (相加 (接收数量, 8, 4), 数据总长))
        赋值 (命令数据, 数据类.未知支持库函数_84 (相加 (1, 8, 4), 接收数量))
        数据类.未知支持库函数_89 (1, 相加 (接收数量, 8, 4))
         ' 调试输出 (数据类.取长度 ())
    .如果真结束
    
.如果真结束
返回 (命令数据)

.子程序 _客户1_数据到达, 空白型, , 
客户.未知支持库函数_87 (取回数据 ())
.如果 (不等于 (#服务端是客户, 0))
    服务数据处理 (客户)
.否则
    客户数据处理 (客户)
.如果结束


.子程序 _服务器1_数据到达, 空白型, , 
服务.未知支持库函数_87 (取回数据 ())
赋值 (.标记, 取回客户 ())
.如果 (等于 (#服务端是客户, 0))
    服务数据处理 (服务)
.否则
    客户数据处理 (服务)
.如果结束



.子程序 _服务器1_客户进入, 空白型, , 
赋值 (.标记, 取回客户 ())

.子程序 服务过程连接, 空白型, , 
赋值 (.端口, 80)

.子程序 客户过程连接, 空白型, , 
“127.0.0.1”.连接 (80)

.子程序 __启动窗口_创建完毕, 空白型, , 
输出调试文本 (“===========哲编译例程，作者：zhen001  Copyright:2011.5.1============”)
服务过程连接 ()
客户过程连接 ()

.子程序 _按钮2_被单击, 空白型, , 
置随机数种子 ()
.如果 (客户发送数据 (相加 (到字节集 (“客户”), 取空白字节集 (取随机数 ()))))
    
.否则
    客户过程连接 ()
.如果结束



.子程序 _按钮1_被单击, 空白型, , 
置随机数种子 ()
.如果 (服务发送数据 (相加 (到字节集 (“服务”), 取空白字节集 (取随机数 ()))))
    
.否则
    服务过程连接 ()
.如果结束


.子程序 _时钟1_周期事件, 空白型, , 
.如果 (大于 (取随机数 (1, 10), 5))
    _按钮1_被单击 ()
.否则
    _按钮2_被单击 ()
.如果结束



.程序集 程序集1, , , 

.子程序 客户数据处理, 空白型, , 
.参数 数据类, 未知类型0x20002, , 

.局部变量 命令数据, 字节集, , , 

赋值 (命令数据, 获取通信数据 (数据类))
.如果真 (不等于 (命令数据, {  }))
    调试输出 (“客户处理: ”, 取字节集长度 (命令数据), 到文本 (命令数据))
.如果真结束


.程序集 程序集2, , , 

.子程序 服务数据处理, 空白型, , 
.参数 数据类, 未知类型0x20002, , 

.局部变量 命令数据, 字节集, , , 

赋值 (命令数据, 获取通信数据 (数据类))
.如果真 (不等于 (命令数据, {  }))
    调试输出 (“服务处理: ”, 取字节集长度 (命令数据), 到文本 (命令数据))
.如果真结束



 ' 不属于任何一个程序集、类模块的函数：
