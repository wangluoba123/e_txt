 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 主窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 866
    高度 = 585
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “MYSQL 网关服务端”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 452
    高度 = 336
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于窗口”
    帮助文件名 = “”

窗口 全局设置_窗口
    左边 = 50
    顶边 = 50
    宽度 = 469
    高度 = 292
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.常量 封面显示秒数, "4.3", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 2 0 扩展界面支持库二
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 2 0 XP风格界面库
 ' spec A512548E76954B6E92C21055517615B0 3 1 特殊功能支持库
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 2 0 多线程支持库
 ' mysql 7F54B9CE8887428dBA9CEEB94CEF4C72 3 0 MySQL支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 3 0 应用接口支持库
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 3 0 扩展界面支持库三
 ' Exmlrpc A36CFD538657479eBD7C0D287BBB3D95 2 0 远程服务支持库
 ' ExtMenu 9909FBB013704cfa8FE7E739DB7172DE 2 0 超级菜单支持库




.全局变量 全局_配置文件名, 文本型, , , 
.全局变量 匿名全局变量_636, 空白型, , , 
.全局变量 全局_数据库地址, 文本型, , , 
.全局变量 全局_数据库端口, 文本型, , , 
.全局变量 全局_数据库用户名, 文本型, , , 
.全局变量 全局_数据库密码, 文本型, , , 
.全局变量 全局_数据库名称, 文本型, , , 
.全局变量 全局_服务端口, 整数型, , , 
.全局变量 全局_远程服务, 未知类型0xA0001, , , 
.全局变量 匿名全局变量_637, 空白型, , , 
.全局变量 全局_请求数据, 文本型, , "0", 
.全局变量 全局_请求代码, 文本型, , , 
.全局变量 全局_请求信息, 文本型, , , 
.全局变量 全局_客户句柄, 整数型, , , 
.全局变量 全局_客户地址, 文本型, , , 

.窗口程序集 主窗口程序集, , , 

.程序集变量 集_线程句柄, 整数型, , , 
.程序集变量 集_Mysql句柄, 整数型, , , 
.程序集变量 集_记录集句柄, 整数型, , , 
.程序集变量 集_错误信息, 文本型, , , 
.程序集变量 集_总页数, 整数型, , , 
.程序集变量 集_当前页, 整数型, , , 
.程序集变量 集_进位, 双精度小数型, , , 
.程序集变量 集_分页, 整数型, , , 
.程序集变量 集_总记录, 整数型, , , 
.程序集变量 集_当前页记录, 整数型, , , 
.程序集变量 集_指定行, 整数型, , , 
.子程序 _主窗口_创建完毕, 空白型, , 
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

未知支持库函数_0 (#)

.子程序 _关于_被选择, 空白型, , 
载入 (关于窗口, , 真)

.子程序 _全局设置_被选择, 空白型, , 
载入 (全局设置_窗口, 主窗口, 假)

.子程序 _启动数据库_被选择, 空白型, , 
0.置文本 (“连接数据库.....”)
未知支持库函数_0 (&连接数据库, , 集_线程句柄) ' 仅仅为了连接失败的过程中不卡窗口！
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 连接数据库, 空白型, , 
.局部变量 局部_服务端版本, 文本型, , , 
.局部变量 局部_客户端版本, 文本型, , , 

赋值 (集_Mysql句柄, 未知支持库函数_1 (全局_数据库地址, 全局_数据库用户名, 全局_数据库密码, 全局_数据库名称, 到整数 (全局_数据库端口)))
.如果真 (等于 (集_Mysql句柄, 0))
    0.置文本 (“数据库：连接失败！”)
     ' 取错误文本 (集_Mysql句柄, 集_错误信息)
    信息框 (“数据库连接失败@”, 16, )
    未知支持库函数_7 (集_线程句柄)
    返回 ()
.如果真结束
0.置文本 (“数据库：连接成功！”)
1.置文本 (相加 (“连接句柄： ”, 到文本 (集_Mysql句柄)))
未知支持库函数_23 (集_Mysql句柄, 局部_服务端版本)
未知支持库函数_24 (局部_客户端版本)
相加 (“服务器名：   ”, 取主机名 (), #换行符).加入文本 ()
相加 (“本机IP地址： ”, 未知支持库函数_47 (), #换行符).加入文本 ()
相加 (“Mysql服务端版本： ”, 局部_服务端版本, #换行符).加入文本 ()
相加 (“Mysql客户端版本： ”, 局部_客户端版本, #换行符).加入文本 ()
赋值 (.禁止, 真)

.子程序 _关闭数据库_被选择, 空白型, , 
.如果真 (不等于 (集_Mysql句柄, 0))
    未知支持库函数_2 (集_Mysql句柄)
    赋值 (.禁止, 假)
    未知支持库函数_7 (集_线程句柄)
    赋值 (集_Mysql句柄, 0)
    赋值 (集_线程句柄, 0)
    0.置文本 (“数据库：关闭！”)
    赋值 (.内容, “”)
.如果真结束
1.置文本 (相加 (“连接句柄： ”, 到文本 (集_Mysql句柄)))

.子程序 _主窗口_可否被关闭, 逻辑型, , 
.如果真 (不等于 (集_Mysql句柄, 0))
    0.置文本 (“数据库：正在关闭...”)
    未知支持库函数_2 (集_Mysql句柄)
    全局_远程服务.未知支持库函数_2 ()
    赋值 (集_Mysql句柄, 0)
    
.如果真结束
返回 (真)


.子程序 _启动_按钮_被单击, 空白型, , 
.局部变量 局部_线程组, 文本型, , "2", 
.局部变量 局部_处理方式, 逻辑型, , , 
.局部变量 局部_端口号, 整数型, , , 

.如果真 (不等于 (读配置项 (全局_配置文件名, “Server”, “线程池”, ), “”))
    赋值 (局部_线程组, 分割文本 (读配置项 (全局_配置文件名, “Server”, “线程池”, ), “-”, ))
.如果真结束
赋值 (局部_端口号, 到数值 (读配置项 (全局_配置文件名, “Server”, “Port”, )))
赋值 (., 0)
.如果真 (等于 (读配置项 (全局_配置文件名, “Server”, “串行”, ), “True”))
    赋值 (局部_处理方式, 真)
.如果真结束
.如果真 (等于 (读配置项 (全局_配置文件名, “Server”, “串行”, ), “Flase”))
    赋值 (局部_处理方式, 假)
.如果真结束
.如果真 (取反 (全局_远程服务.未知支持库函数_3 (到整数 (局部_线程组 [1]), 到整数 (局部_线程组 [2]))))
    信息框 (“置线程池失败！请重新设置线程池大小！”, 16, )
    返回 ()
.如果真结束
.如果真 (等于 (集_Mysql句柄, 0))
    信息框 (“数据库连接失败或没有连接，请尝试重新连接数据库！”, 16, )
    返回 ()
.如果真结束
.如果真 (等于 (全局_远程服务.未知支持库函数_1 (局部_端口号, &服务处理函数, 局部_处理方式), 假))
    信息框 (“网关服务启动失败！”, 16, )
    相加 (“网关服务启动失败！”, #换行符).加入文本 ()
    返回 ()
.如果真结束
相加 (取格式化时间 (), “网关服务启动成功！”, #换行符, 取格式化时间 (), “当前服务端口： ”, 到文本 (局部_端口号), #换行符).加入文本 ()
赋值 (.禁止, 真)
赋值 (.禁止, 真)

.子程序 服务处理函数, 空白型, , 
.参数 参_消息地址, 整数型, , 

调试输出 (全局_远程服务.未知支持库函数_8 (参_消息地址, 全局_客户句柄))
.如果真 (不等于 (全局_远程服务.未知支持库函数_27 (参_消息地址), 2))
    .判断开始 (等于 (全局_远程服务.未知支持库函数_27 (参_消息地址), -1))
        相加 (取格式化时间 (), “有客到 ”, 到文本 (全局_客户句柄), “ 发生错误”, #换行符).加入文本 ()
    .判断 (等于 (全局_远程服务.未知支持库函数_27 (参_消息地址), 0))
        相加 (取格式化时间 (), “有客到 ”, 到文本 (全局_客户句柄), #换行符).加入文本 ()
    .判断 (等于 (全局_远程服务.未知支持库函数_27 (参_消息地址), 1))
        相加 (取格式化时间 (), “客官慢走 ”, 到文本 (全局_客户句柄), #换行符).加入文本 ()
    .默认
         ' 本源码来自易语言资源网(www.5A5X.com)
    .判断结束
    返回 ()
.如果真结束
.如果真 (等于 (全局_远程服务.未知支持库函数_4 (参_消息地址, 全局_请求代码, 全局_请求信息), 假))
    相加 (取格式化时间 (), “请求失败  ”, 到文本 (全局_客户句柄), #换行符).加入文本 ()
    返回 ()
.如果真结束
重定义数组 (全局_请求数据, 假, 0)
赋值 (全局_请求数据, 分割文本 (全局_请求信息, “|”, ))
.判断开始 (等于 (全局_请求数据 [1], “取表名”))
    _取表名 ()
.判断 (等于 (全局_请求数据 [1], “取字段”))
    _取字段 ()
.判断 (等于 (全局_请求数据 [1], “取数据”))
    _取数据 ()
.判断 (等于 (全局_请求数据 [1], “编码转换”))
    _编码转换 ()
.判断 (等于 (全局_请求数据 [1], “请求分页”))
    _服务_分页数据处理 ()
.默认
    
.判断结束
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 取格式化时间, 文本型, , 
.局部变量 局部_年, 文本型, , , 
.局部变量 局部_月, 文本型, , , 
.局部变量 局部_日, 文本型, , , 
.局部变量 局部_时, 文本型, , , 
.局部变量 局部_分, 文本型, , , 
.局部变量 局部_秒, 文本型, , , 

赋值 (局部_年, 到文本 (取年份 (取现行时间 ())))
赋值 (局部_月, 到文本 (取月份 (取现行时间 ())))
赋值 (局部_日, 到文本 (取日 (取现行时间 ())))
赋值 (局部_时, 到文本 (取小时 (取现行时间 ())))
赋值 (局部_分, 到文本 (取分钟 (取现行时间 ())))
赋值 (局部_秒, 到文本 (取秒 (取现行时间 ())))
.如果真 (小于 (取文本长度 (局部_月), 2))
    赋值 (局部_月, 相加 (“0”, 局部_月))
.如果真结束
.如果真 (小于 (取文本长度 (局部_日), 2))
    赋值 (局部_日, 相加 (“0”, 局部_日))
.如果真结束
.如果真 (小于 (取文本长度 (局部_时), 2))
    赋值 (局部_时, 相加 (“0”, 局部_时))
.如果真结束
.如果真 (小于 (取文本长度 (局部_分), 2))
    赋值 (局部_分, 相加 (“0”, 局部_分))
.如果真结束
.如果真 (小于 (取文本长度 (局部_秒), 2))
    赋值 (局部_秒, 相加 (“0”, 局部_秒))
.如果真结束
返回 (相加 (“【”, 局部_年, “-”, 局部_月, “-”, 局部_日, “ ”, 局部_时, “:”, 局部_分, “:”, 局部_秒, “】”))

.子程序 _停止_按钮_被单击, 空白型, , 
赋值 (.禁止, 真)
赋值 (.禁止, 真)
相加 (取格式化时间 (), “网关服务正在停止.....”, #换行符).加入文本 ()
未知支持库函数_0 (&停止服务, , 集_线程句柄)

.子程序 停止服务, 空白型, , 
全局_远程服务.未知支持库函数_2 ()
相加 (取格式化时间 (), “网关服务已停止..”, #换行符).加入文本 ()
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
 ' 本源码来自易语言资源网(www.5A5X.com)
未知支持库函数_7 (集_线程句柄)
赋值 (集_线程句柄, 0)

.子程序 _启动服务_被选择, 空白型, , 
_启动_按钮_被单击 ()

.子程序 _停止服务_被选择, 空白型, , 
_停止_按钮_被单击 ()

.子程序 _客管_按钮_被单击, 空白型, , 


.子程序 _取表名, 空白型, , 
.局部变量 局部_文本, 文本型, , , 
.局部变量 N, 文本型, , , 

相加 (取格式化时间 (), 到文本 (全局_客户句柄), “ 发送信息――> ”, 全局_请求数据 [1], #换行符).加入文本 ()
.如果真 (等于 (未知支持库函数_33 (集_Mysql句柄), 假))
    未知支持库函数_41 (集_Mysql句柄, 集_错误信息)
    相加 (取格式化时间 (), “服务器处理来自 ”, 到文本 (全局_客户句柄), “ 信息失败！”, #换行符).加入文本 ()
    相加 (取格式化时间 (), 集_错误信息, #换行符).加入文本 ()
    全局_远程服务.未知支持库函数_6 (全局_客户句柄, 相加 (“信息|”, 集_错误信息))
    返回 ()
.如果真结束
赋值 (集_记录集句柄, 未知支持库函数_4 (集_Mysql句柄))
.如果真 (等于 (集_记录集句柄, 0))
    未知支持库函数_41 (集_Mysql句柄, 集_错误信息)
    相加 (取格式化时间 (), 集_错误信息, #换行符).加入文本 ()
    全局_远程服务.未知支持库函数_6 (全局_客户句柄, 相加 (“信息|”, 集_错误信息))
    返回 ()
.如果真结束
调试输出 (未知支持库函数_7 (集_记录集句柄))
赋值 (N, “表名”)
.计次循环首 (未知支持库函数_7 (集_记录集句柄), )
    未知支持库函数_6 (集_记录集句柄, 0, 局部_文本)
    赋值 (N, 相加 (N, “|”, 局部_文本))
    未知支持库函数_10 (集_记录集句柄)
.计次循环尾 ()
调试输出 (N)
.如果真 (等于 (全局_远程服务.未知支持库函数_6 (全局_请求代码, N), 假))
    相加 (取格式化时间 (), “服务器发送文本到 ”, 到文本 (全局_客户句柄), “  失败！”, #换行符).加入文本 ()
    返回 ()
.如果真结束
相加 (取格式化时间 (), “服务器发送文本到  ”, 到文本 (全局_客户句柄), #换行符).加入文本 ()
未知支持库函数_5 (集_记录集句柄)
赋值 (集_记录集句柄, 0)


.子程序 _取字段, 空白型, , 
.局部变量 局部_文本, 文本型, , , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 N, 文本型, , , 

相加 (取格式化时间 (), 到文本 (全局_客户句柄), “ 发送信息――> ”, 全局_请求数据 [1], #换行符).加入文本 ()
.如果真 (等于 (全局_请求数据 [3], “”))
    相加 (取格式化时间 (), “服务器处理来自 ”, 到文本 (全局_客户句柄), “ 信息为空！失败！”, #换行符).加入文本 ()
    返回 ()
.如果真结束
.如果真 (等于 (未知支持库函数_3 (集_Mysql句柄, 相加 (“SELECT * FROM ”, 全局_请求数据 [3])), 假))
    相加 (取格式化时间 (), “服务器处理来自 ”, 到文本 (全局_客户句柄), “ 失败！”, #换行符).加入文本 ()
    .如果真 (等于 (全局_远程服务.未知支持库函数_6 (全局_请求代码, “信息|服务器处理请求<执行SQL语句>失败！”), 假))
        相加 (取格式化时间 (), “服务器发送文本到 ”, 到文本 (全局_客户句柄), “  失败！”, #换行符).加入文本 ()
    .如果真结束
    返回 ()
.如果真结束
赋值 (集_记录集句柄, 未知支持库函数_4 (集_Mysql句柄))
.如果真 (等于 (集_记录集句柄, 0))
    相加 (取格式化时间 (), “执行SQL语句失败！”, #换行符).加入文本 ()
    .如果真 (等于 (全局_远程服务.未知支持库函数_6 (全局_请求代码, “信息|服务器处理请求<取记录集>失败！”), 假))
        相加 (取格式化时间 (), “服务器发送文本到 ”, 到文本 (全局_客户句柄), “  失败！”, #换行符).加入文本 ()
    .如果真结束
    返回 ()
.如果真结束
未知支持库函数_12 (集_记录集句柄)
赋值 (N, 相加 (“字段|”, 到文本 (未知支持库函数_14 (集_记录集句柄))))
.计次循环首 (未知支持库函数_14 (集_记录集句柄), 局部_计次)
    未知支持库函数_15 (集_记录集句柄, 相减 (局部_计次, 1), 局部_文本)
    赋值 (N, 相加 (N, “|”, 局部_文本))
.计次循环尾 ()
调试输出 (N)
.如果真 (等于 (全局_远程服务.未知支持库函数_6 (全局_请求代码, N), 假))
    相加 (取格式化时间 (), “服务器发送文本到 ”, 到文本 (全局_客户句柄), “  失败！”, #换行符).加入文本 ()
    返回 ()
.如果真结束
相加 (取格式化时间 (), “服务器发送文本到  ”, 到文本 (全局_客户句柄), #换行符).加入文本 ()
未知支持库函数_5 (集_记录集句柄)
 ' 延迟 (1000)
 ' 到首行 (集_记录集句柄)
 ' 调试输出 (取记录集行数 (集_记录集句柄))


.子程序 _取数据, 空白型, , 
.局部变量 局部_文本, 文本型, , , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_小计次, 整数型, , , 
.局部变量 N, 文本型, , , 
.局部变量 NN, 整数型, , , 

.如果真 (等于 (未知支持库函数_3 (集_Mysql句柄, 相加 (“SELECT * FROM ”, 全局_请求数据 [3])), 假))
    相加 (取格式化时间 (), “服务器处理来自 ”, 到文本 (全局_客户句柄), “ 失败！”, #换行符).加入文本 ()
    .如果真 (等于 (全局_远程服务.未知支持库函数_6 (全局_请求代码, “信息|服务器处理请求<执行SQL语句>失败！”), 假))
        相加 (取格式化时间 (), “服务器发送文本到 ”, 到文本 (全局_客户句柄), “  失败！”, #换行符).加入文本 ()
    .如果真结束
    返回 ()
.如果真结束
赋值 (集_记录集句柄, 未知支持库函数_4 (集_Mysql句柄))
.如果真 (等于 (集_记录集句柄, 0))
    相加 (取格式化时间 (), “执行SQL语句失败！”, #换行符).加入文本 ()
    返回 ()
.如果真结束
未知支持库函数_12 (集_记录集句柄)
 ' 调试输出 (集_记录集句柄)
.如果真 (等于 (未知支持库函数_7 (集_记录集句柄), 0))
    .如果真 (等于 (全局_远程服务.未知支持库函数_6 (全局_请求代码, “提示|该表项没有任何数据！”), 假))
        相加 (取格式化时间 (), “服务器发送文本到 ”, 到文本 (全局_客户句柄), “  失败！”, #换行符).加入文本 ()
        返回 ()
    .如果真结束
    相加 (取格式化时间 (), “服务器发送文本到  ”, 到文本 (全局_客户句柄), #换行符).加入文本 ()
    返回 ()
.如果真结束
赋值 (NN, 未知支持库函数_7 (集_记录集句柄))
赋值 (集_分页, 50)
.如果 (大于 (NN, 集_分页))
    赋值 (集_进位, 相除 (NN, 集_分页))
    .如果真 (大于 (集_进位, 取整 (集_进位)))
        赋值 (集_进位, 相加 (集_进位, 1))
    .如果真结束
    赋值 (集_总页数, 取整 (集_进位))
    赋值 (集_当前页, 到整数 (全局_请求数据 [2]))
    .如果 (小于 (集_当前页, 集_总页数))
        赋值 (集_当前页记录, 集_分页)
    .否则
        赋值 (集_当前页记录, 相乘 (集_当前页, 集_分页))
        ' 本源码来自易语言资源网(www.5A5X.com)
        赋值 (集_当前页记录, 相减 (NN, 集_当前页记录))
    .如果结束
    .计次循环首 (集_分页, 局部_计次)
        赋值 (N, 相加 (“记录|”, 到文本 (NN), “|”, 到文本 (集_总页数), “|”, 到文本 (集_当前页记录)))
        .计次循环首 (未知支持库函数_14 (集_记录集句柄), 局部_小计次)
            未知支持库函数_6 (集_记录集句柄, 相减 (局部_小计次, 1), 局部_文本)
            赋值 (N, 相加 (N, “|”, 局部_文本))
        .计次循环尾 ()
        .如果真 (等于 (全局_远程服务.未知支持库函数_6 (全局_请求代码, N), 假))
            相加 (取格式化时间 (), “服务器发送文本到 ”, 到文本 (全局_客户句柄), “  失败！”, #换行符).加入文本 ()
            返回 ()
        .如果真结束
        相加 (取格式化时间 (), “服务器发送文本”, N, “到  ”, 到文本 (全局_客户句柄), #换行符).加入文本 ()
        未知支持库函数_10 (集_记录集句柄)
    .计次循环尾 ()
    未知支持库函数_5 (集_记录集句柄)
    赋值 (集_记录集句柄, 0)
.否则
    赋值 (集_总页数, 1)
    赋值 (集_当前页记录, NN)
    .计次循环首 (NN, 局部_计次)
        赋值 (N, 相加 (“记录|”, 到文本 (NN), “|”, 到文本 (集_总页数), “|”, 到文本 (集_当前页记录)))
        .计次循环首 (未知支持库函数_14 (集_记录集句柄), 局部_小计次)
            未知支持库函数_6 (集_记录集句柄, 相减 (局部_小计次, 1), 局部_文本)
            赋值 (N, 相加 (N, “|”, 局部_文本))
        .计次循环尾 ()
        .如果真 (等于 (全局_远程服务.未知支持库函数_6 (全局_请求代码, N), 假))
            相加 (取格式化时间 (), “服务器发送文本到 ”, 到文本 (全局_客户句柄), “  失败！”, #换行符).加入文本 ()
            返回 ()
        .如果真结束
        相加 (取格式化时间 (), “服务器发送文本”, N, “到  ”, 到文本 (全局_客户句柄), #换行符).加入文本 ()
        未知支持库函数_10 (集_记录集句柄)
    .计次循环尾 ()
    未知支持库函数_5 (集_记录集句柄)
    赋值 (集_记录集句柄, 0)
    
.如果结束


.子程序 _编码转换, 空白型, , 
.如果真 (等于 (未知支持库函数_3 (集_Mysql句柄, 相加 (“SET NAMES ”, 全局_请求数据 [2])), 假))
    相加 (取格式化时间 (), “服务器处理来自 ”, 到文本 (全局_客户句柄), “ 失败！”, #换行符).加入文本 ()
    未知支持库函数_41 (集_Mysql句柄, 集_错误信息)
    .如果真 (等于 (全局_远程服务.未知支持库函数_6 (全局_请求代码, 相加 (“信息|”, 集_错误信息)), 假))
        相加 (取格式化时间 (), “服务器发送文本到 ”, 到文本 (全局_客户句柄), “  失败！”, #换行符).加入文本 ()
    .如果真结束
    返回 ()
.如果真结束
.如果真 (等于 (全局_远程服务.未知支持库函数_6 (全局_请求代码, 相加 (“信息|转换到”, 全局_请求数据 [2], “ 成功”)), 假))
    相加 (取格式化时间 (), “服务器发送文本到 ”, 到文本 (全局_客户句柄), “  失败！”, #换行符).加入文本 ()
    返回 ()
.如果真结束
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _服务_分页数据处理, 空白型, , 
.局部变量 NN, 整数型, , , 
.局部变量 N, 文本型, , , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_小计次, 整数型, , , 
.局部变量 局部_文本, 文本型, , , 

赋值 (集_当前页, 到整数 (全局_请求数据 [2]))
.如果真 (等于 (未知支持库函数_3 (集_Mysql句柄, 相加 (“SELECT * FROM ”, 全局_请求数据 [3])), 假))
    相加 (取格式化时间 (), “服务器处理来自 ”, 到文本 (全局_客户句柄), “ 失败！”, #换行符).加入文本 ()
    .如果真 (等于 (全局_远程服务.未知支持库函数_6 (全局_请求代码, “信息|服务器处理请求<执行SQL语句>失败！”), 假))
        相加 (取格式化时间 (), “服务器发送文本到 ”, 到文本 (全局_客户句柄), “  失败！”, #换行符).加入文本 ()
    .如果真结束
    返回 ()
.如果真结束
赋值 (集_记录集句柄, 未知支持库函数_4 (集_Mysql句柄))
.如果真 (等于 (集_记录集句柄, 0))
    相加 (取格式化时间 (), “执行SQL语句失败！”, #换行符).加入文本 ()
    返回 ()
.如果真结束
赋值 (NN, 未知支持库函数_7 (集_记录集句柄))
赋值 (集_指定行, 相乘 (集_当前页, 集_分页))
赋值 (集_当前页记录, 相减 (NN, 集_指定行))
.如果真 (等于 (未知支持库函数_11 (集_记录集句柄, 集_指定行), 假))
    相加 (取格式化时间 (), “服务器处理来自 ”, 到文本 (全局_客户句柄), “ 失败！”, #换行符).加入文本 ()
     ' 取错误文本 (集_Mysql句柄, 集_错误信息)
    .如果真 (等于 (全局_远程服务.未知支持库函数_6 (全局_请求代码, 相加 (“信息|”, “错误：移动指针失败！”)), 假))
        相加 (取格式化时间 (), “服务器发送文本到 ”, 到文本 (全局_客户句柄), “  失败！”, #换行符).加入文本 ()
        返回 ()
    .如果真结束
     ' 本源码来自易语言资源网(www.5A5X.com)
.如果真结束
.如果 (大于或等于 (集_当前页记录, 集_分页))
    .计次循环首 (集_分页, 局部_计次)
        赋值 (N, 相加 (“返回分页数据|”, 到文本 (NN), “|”, 到文本 (集_分页)))
        .计次循环首 (未知支持库函数_14 (集_记录集句柄), 局部_小计次)
            未知支持库函数_6 (集_记录集句柄, 相减 (局部_小计次, 1), 局部_文本)
            赋值 (N, 相加 (N, “|”, 局部_文本))
        .计次循环尾 ()
        .如果真 (等于 (全局_远程服务.未知支持库函数_6 (全局_请求代码, N), 假))
            相加 (取格式化时间 (), “服务器发送文本到 ”, 到文本 (全局_客户句柄), “  失败！”, #换行符).加入文本 ()
            返回 ()
        .如果真结束
        相加 (取格式化时间 (), “服务器发送文本”, N, “到  ”, 到文本 (全局_客户句柄), #换行符).加入文本 ()
        未知支持库函数_10 (集_记录集句柄)
    .计次循环尾 ()
    未知支持库函数_5 (集_记录集句柄)
    赋值 (集_记录集句柄, 0)
    
.否则
    .计次循环首 (集_当前页记录, 局部_计次)
        赋值 (N, 相加 (“返回分页数据|”, 到文本 (NN), “|”, 到文本 (集_当前页记录)))
        .计次循环首 (未知支持库函数_14 (集_记录集句柄), 局部_小计次)
            未知支持库函数_6 (集_记录集句柄, 相减 (局部_小计次, 1), 局部_文本)
            赋值 (N, 相加 (N, “|”, 局部_文本))
        .计次循环尾 ()
        .如果真 (等于 (全局_远程服务.未知支持库函数_6 (全局_请求代码, N), 假))
            相加 (取格式化时间 (), “服务器发送文本到 ”, 到文本 (全局_客户句柄), “  失败！”, #换行符).加入文本 ()
            返回 ()
        .如果真结束
        相加 (取格式化时间 (), “服务器发送文本”, N, “到  ”, 到文本 (全局_客户句柄), #换行符).加入文本 ()
        未知支持库函数_10 (集_记录集句柄)
    .计次循环尾 ()
    未知支持库函数_5 (集_记录集句柄)
    赋值 (集_记录集句柄, 0)
    
.如果结束


.窗口程序集 关于窗口程序集, , , 

.子程序 _关于窗口_创建完毕, 空白型, , 
赋值 (.标题, 主窗口.)
赋值 (.标题, “版本：1.0.0”)

.子程序 _确定按钮_被单击, 空白型, , 
销毁 ()

.子程序 _系统信息按钮_被单击, 空白型, , 
.局部变量 系统信息路径, 文本型, , , 

赋值 (系统信息路径, 取文本注册项 (#本地机器, “SOFTWARE\Microsoft\Shared Tools\MSINFO\PATH”, “”))
.如果真 (等于 (系统信息路径, “”))
    赋值 (系统信息路径, 取文本注册项 (#本地机器, “SOFTWARE\Microsoft\Shared Tools Location\MSINFO”, “”))
    .判断开始 (不等于 (寻找文件 (相加 (系统信息路径, “\MSINFO32.EXE”), ), “”))
        赋值 (系统信息路径, 相加 (系统信息路径, “\MSINFO32.EXE”))
    .默认
        信息框 (“错误 - 文件找不到...”, #错误图标, “错误”)
    .判断结束
    
.如果真结束
.如果 (不等于 (系统信息路径, “”))
    运行 (系统信息路径, 假, )
.否则
    信息框 (“错误 - 注册表项找不到...”, #错误图标, “错误”)
.如果结束


.窗口程序集 全局设置_程序集, , , 

.子程序 _全局设置_窗口_创建完毕, 空白型, , 
未知支持库函数_0 (1)


.子程序 _数据库保存设置_按钮_被单击, 空白型, , 
写配置项 (全局_配置文件名, “Config”, “DBHost”, .内容)
写配置项 (全局_配置文件名, “Config”, “DBPort”, .内容)
写配置项 (全局_配置文件名, “Config”, “DBUser”, .内容)
写配置项 (全局_配置文件名, “Config”, “DBPass”, .内容)
写配置项 (全局_配置文件名, “Config”, “DBBaseName”, .内容)
.如果真 (文件是否存在 (全局_配置文件名))
    信息框 (“保存配置成功！”, 0, )
    读取配置 ()
    返回 ()
.如果真结束
信息框 (“保存配置失败！”, 16, )


.子程序 _数据库读取配置_按钮_被单击, 空白型, , 
.如果真 (文件是否存在 (全局_配置文件名))
    赋值 (.内容, 读配置项 (全局_配置文件名, “Config”, “DBHost”, ))
    赋值 (.内容, 读配置项 (全局_配置文件名, “Config”, “DBPort”, ))
    赋值 (.内容, 读配置项 (全局_配置文件名, “Config”, “DBUser”, ))
    赋值 (.内容, 读配置项 (全局_配置文件名, “Config”, “DBPass”, ))
    赋值 (.内容, 读配置项 (全局_配置文件名, “Config”, “DBBaseName”, ))
    返回 ()
.如果真结束
信息框 (“配置文件不存在！”, 16, )


.子程序 _网关保存设置_按钮_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (“网关端口不能为空！”, 16, )
    返回 ()
.如果真结束
.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“线程池大小不能为空！”, 16, )
    返回 ()
.如果真结束
.如果 (.选中)
    写配置项 (全局_配置文件名, “Server”, “串行”, “True”)
.否则
    写配置项 (全局_配置文件名, “Server”, “串行”, “Flase”)
.如果结束
.如果 (.选中)
    写配置项 (全局_配置文件名, “Server”, “启用IP黑名单”, “True”)
.否则
    写配置项 (全局_配置文件名, “Server”, “启用IP黑名单”, “Flase”)
.如果结束
写配置项 (全局_配置文件名, “Server”, “Port”, .内容)
写配置项 (全局_配置文件名, “Server”, “线程池”, 相加 (.内容, “-”, .内容))
信息框 (“保存成功”, 0, )
读取配置 ()

.子程序 _网关读取配置_按钮_被单击, 空白型, , 
.局部变量 局部_线程池, 文本型, , "2", 

.如果真 (等于 (文件是否存在 (全局_配置文件名), 假))
    返回 ()
.如果真结束
.如果真 (不等于 (读配置项 (全局_配置文件名, “Server”, “线程池”, ), “”))
    赋值 (局部_线程池, 分割文本 (读配置项 (全局_配置文件名, “Server”, “线程池”, ), “-”, ))
    赋值 (.内容, 读配置项 (全局_配置文件名, “Server”, “Port”, ))
    赋值 (.内容, 局部_线程池 [1])
    赋值 (.内容, 局部_线程池 [2])
    .如果真 (等于 (读配置项 (全局_配置文件名, “Server”, “串行”, ), “True”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (读配置项 (全局_配置文件名, “Server”, “串行”, ), “Flase”))
        赋值 (.选中, 假)
    .如果真结束
    .如果真 (等于 (读配置项 (全局_配置文件名, “Server”, “启用IP黑名单”, ), “True”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (读配置项 (全局_配置文件名, “Server”, “启用IP黑名单”, ), “Flase”))
        赋值 (.选中, 假)
    .如果真结束
    
.如果真结束







.程序集 启动程序集, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易程序初始化代码
赋值 (全局_配置文件名, 相加 (取运行目录 (), “\Server.ini”))
.如果真 (等于 (文件是否存在 (全局_配置文件名), 假))
    信息框 (相加 (“在软件目录下并没找到配置文件！”, #换行符, “点击确定载入全局配置设置”), 0, )
    载入 (全局设置_窗口, , 真)
.如果真结束
读取配置 ()
载入 (主窗口, , 假)
_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 


.子程序 读取配置, 空白型, , 
赋值 (全局_数据库地址, 读配置项 (全局_配置文件名, “Config”, “DBHost”, ))
赋值 (全局_数据库端口, 读配置项 (全局_配置文件名, “Config”, “DBPort”, ))
赋值 (全局_数据库用户名, 读配置项 (全局_配置文件名, “Config”, “DBUser”, ))
赋值 (全局_数据库密码, 读配置项 (全局_配置文件名, “Config”, “DBPass”, ))
赋值 (全局_数据库名称, 读配置项 (全局_配置文件名, “Config”, “DBBaseName”, ))



 ' 不属于任何一个程序集、类模块的函数：
