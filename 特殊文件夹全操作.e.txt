 ' 文件类型：Windows窗口程序

 ' 程序名称：文件夹小工具
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 217
    高度 = 161
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 12703169 '  0xC1D5C1
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 帮助
    左边 = 50
    顶边 = 50
    宽度 = 294
    高度 = 295
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 12703169 '  0xC1D5C1
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' edroptarget {9DA96BF9CEBD45c5BFCF94CBE61671F5} 2 0 拖放支持库





.窗口程序集 窗口程序集1, , , 

.程序集变量 状态, 文本型, , , 
.程序集变量 pas, 文本型, , , 
.程序集变量 路径, 文本型, , , 
.子程序 _标签2_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_启动窗口.销毁 ()

.子程序 _标签8_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (帮助, , 真)

.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (状态, “文件夹”)
取窗口句柄 ().未知支持库函数_0 ()

.子程序 _标签4_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (状态, “文件夹”))
    .如果真 (不等于 (.内容, “”))
        创建目录 (相加 (.内容, “\”))
    .如果真结束
    
.如果真结束
.如果真 (等于 (状态, “密码”))
    .如果真 (不等于 (取文本右边 (路径, 1), “.”))
        写配置项 (相加 (路径, “\sn.data”), “密码”, “pas”, .内容)
        文件更名 (路径, 相加 (路径, “..\”))
        赋值 (.标题, “加密成功，请记住密码！”)
    .如果真结束
    
.如果真结束


.子程序 _标签5_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (状态, “文件夹”))
    .如果真 (不等于 (.内容, “”))
        删除目录 (相加 (.内容, “\”))
    .如果真结束
    
.如果真结束
.如果真 (等于 (状态, “密码”))
    .如果 (等于 (取文本右边 (路径, 1), “.”))
        赋值 (pas, 读配置项 (相加 (路径, “..\sn.data”), “密码”, “pas”, ))
        .如果 (等于 (.内容, pas))
            文件更名 (相加 (路径, “.\”), 取文本左边 (路径, 相减 (取文本长度 (路径), 1)))
            删除文件 (相加 (取文本左边 (路径, 相减 (取文本长度 (路径), 1)), “\sn.data”))
            赋值 (.标题, “解密成功！”)
        .否则
            赋值 (.标题, “密码错误，请重新输入：”)
        .如果结束
        
    .否则
        赋值 (.标题, “文件夹未加密！”)
    .如果结束
    
.如果真结束


.子程序 _拖放对象1_得到文件, 空白型, , 
.参数 接收到的文件路径, 文本型, , 

.局部变量 类型, 文本型, , , 

.如果真 (等于 (状态, “文件夹”))
    赋值 (类型, 取文本右边 (接收到的文件路径, 相减 (取文本长度 (接收到的文件路径), 倒找文本 (接收到的文件路径, “\”, , 假))))
    .如果 (不等于 (.内容, “”))
        .如果 (复制文件 (接收到的文件路径, 相加 (.内容, “\”, 类型)))
            赋值 (.标题, “文件保存成功！”)
        .否则
            赋值 (.标题, “失败！不支持文件夹存入！”)
        .如果结束
        
    .否则
        赋值 (.标题, “请输入您想把文件转移到的文件夹”)
    .如果结束
    
.如果真结束
.如果真 (等于 (状态, “密码”))
    赋值 (路径, 接收到的文件路径)
    赋值 (类型, 取文本右边 (接收到的文件路径, 相减 (取文本长度 (接收到的文件路径), 倒找文本 (接收到的文件路径, “\”, , 假))))
    置文件属性 (接收到的文件路径, 相减 (-1, 4, 2))
    .如果 (写到文件 (相加 (接收到的文件路径, “\sn.data”), 到字节集 (“邵长远”)))
        赋值 (.标题, “请输入您的加密密码：”)
    .否则
        .如果 (等于 (取文本右边 (类型, 1), “.”))
            赋值 (.标题, “请输入您的解密密码：”)
        .否则
            赋值 (.标题, “不是文件夹或文件夹不可写！”)
        .如果结束
        
    .如果结束
    
.如果真结束


.子程序 _单选框1_被单击, 空白型, , 
.如果真 (等于 (状态, “密码”))
    赋值 (状态, “文件夹”)
    赋值 (.输入方式, 0)
    赋值 (.标题, “请输入您想创建的文件夹标题：”)
    赋值 (.标题, “创建”)
    赋值 (.标题, “删除”)
.如果真结束


.子程序 _单选框2_被单击, 空白型, , 
.如果真 (等于 (状态, “文件夹”))
    赋值 (状态, “密码”)
    赋值 (.输入方式, 2)
    赋值 (.标题, “请输入您设定的密码：”)
    赋值 (.标题, “加密”)
    赋值 (.标题, “解密”)
.如果真结束


.窗口程序集 窗口程序集2, , , 

.子程序 _标签2_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

帮助.销毁 ()


 ' 不属于任何一个程序集、类模块的函数：
