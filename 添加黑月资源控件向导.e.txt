 ' 文件类型：Windows窗口程序

 ' 程序名称：添加黑月资源控件向导
 ' 程序描述：添加黑月资源控件向导
@备注:
添加黑月资源控件向导
 ' 程序作者：kaien
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：kaienfr@gmail.com
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 268
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “添加黑月资源控件向导 by kaien”
    帮助文件名 = “”



.图片 模版, " ' 已保存到：D:\易语言学习\Data\添加黑月资源控件向导.e\模版", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 2 0 扩展界面支持库二
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' ewizard F4252F5EB88342579B4E216FC410E5D7 2 0 易向导支持库
 ' spec A512548E76954B6E92C21055517615B0 3 0 特殊功能支持库




数据类型 控件属性, , 
    .成员 控件名, 文本型, , , 
    .成员 控件变量名, 文本型, , , 
    .成员 控件ID, 文本型, , , 
    .成员 控件类型, 文本型, , , 


.窗口程序集 窗口程序集1, , , 'kaien 制作 1.0 测试版

.程序集变量 控件属性, 控件属性, , , 
.程序集变量 常量命令, 文本型, , , 
.程序集变量 全局变量命名, 文本型, , , 
.程序集变量 绑定命令, 文本型, , , 
.子程序 _按钮1_被单击, 空白型, , 
.局部变量 结果, 逻辑型, , , 

赋值 (结果, 真)
.如果真 (不等于 (., “”))
    赋值 (结果, 解析常量文本串 (.))
    
.如果真结束

.如果真 (等于 (结果, 假))
    0.置文本 (“常量信息串格式错误”)
    返回 ()
.如果真结束


赋值 (控件属性.控件名, 删首尾空 (.))
.如果真 (等于 (控件属性.控件名, “”))
    0.置文本 (“控件名不能为空”)
    返回 ()
.如果真结束

赋值 (控件属性.控件ID, 删首尾空 (.))
赋值 (控件属性.控件ID, 子文本替换 (控件属性.控件ID, #引号, , , , 真))
.如果真 (等于 (控件属性.控件ID, “”))
    0.置文本 (“控件ID不能为空”)
    返回 ()
.如果真结束

赋值 (控件属性.控件类型, .内容)
.如果真 (等于 (控件属性.控件类型, “”))
    0.置文本 (“选择控件类型”)
    返回 ()
.如果真结束


赋值 (控件属性.控件变量名, 取控件变量名 (控件属性.控件名))

赋值 (常量命令, 相加 (“.常量 ”, 控件属性.控件名, “ , ”, #引号, 控件属性.控件ID, #引号))
赋值 (全局变量命名, 相加 (“.全局变量”, 控件属性.控件变量名, “ , ”, 控件属性.控件类型))
赋值 (绑定命令, 相加 (控件属性.控件变量名, “.绑定 (窗口句柄, #”, 控件属性.控件名, “)”))

赋值 (., 相加 (绑定命令, #换行符))

未知支持库函数_5 (#., “常量”, #., 控件属性.控件名)
未知支持库函数_5 (#., 控件属性.控件名, #., 到整数 (控件属性.控件ID))

未知支持库函数_5 (#., 控件属性.控件类型, #., “$”)
未知支持库函数_5 (#., 控件属性.控件类型, #., 控件属性.控件类型)
未知支持库函数_5 (#., 控件属性.控件类型, #., 控件属性.控件变量名)

未知支持库函数_4 (“a”)
未知支持库函数_13 (#模版, 假)

置剪辑板文本 (.)

0.置文本 (“完成”)

 ' 如许运行后自动销毁，这里去掉注释即可
 ' 销毁 ()

.子程序 取控件变量名, 文本型, , 
.参数 控件名, 文本型, , 

返回 (取文本右边 (控件名, 相减 (取文本长度 (控件名), 寻找文本 (控件名, “_”, , 假))))


.子程序 解析常量文本串, 逻辑型, , 
.参数 文本, 文本型, , 

.局部变量 临时文本组, 文本型, , "0", 


.如果真 (不等于 (取文本左边 (文本, 1), “.”))
    返回 (假)
.如果真结束

 ' 分割解析常量数据
赋值 (文本, 子文本替换 (文本, “.常量 ”, “”, , , 真))
赋值 (文本, 子文本替换 (文本, “ ”, “”, , , 真))
调试输出 (文本)
赋值 (临时文本组, 分割文本 (文本, “,”, ))
.如果真 (不等于 (取数组成员数 (临时文本组), 2))
    返回 (假)
.如果真结束

赋值 (., 临时文本组 [1])
赋值 (., 临时文本组 [2])
赋值 (.内容, 取控件类型 (临时文本组 [1]))

返回 (真)



.子程序 取控件类型, 文本型, , '根据资源名自动判断控件类型。对于自动命名的控件有效
.参数 资源名, 文本型, , 

.局部变量 临时, 文本型, , , 

赋值 (控件属性.控件类型, 取控件变量名 (资源名))

赋值 (临时, 取文本右边 (控件属性.控件类型, 1))
.判断循环首 (并且 (大于或等于 (取代码 (临时, ), 48), 小于或等于 (取代码 (临时, ), 57)))
    赋值 (控件属性.控件类型, 取文本左边 (控件属性.控件类型, 相减 (取文本长度 (控件属性.控件类型), 1)))
    赋值 (临时, 取文本右边 (控件属性.控件类型, 1))
.判断循环尾 ()

.判断开始 (等于 (控件属性.控件类型, “选择框”))
    赋值 (控件属性.控件类型, “复选框类”)
.判断 (等于 (控件属性.控件类型, “状态条”))
    赋值 (控件属性.控件类型, “状态栏类”)
.默认
    赋值 (控件属性.控件类型, 相加 (控件属性.控件类型, “类”))
.判断结束

返回 (控件属性.控件类型)



 ' 不属于任何一个程序集、类模块的函数：
