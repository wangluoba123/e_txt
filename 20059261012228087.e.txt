 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 459
    高度 = 428
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “[世恒帮您学易]-mysql简易浏览器”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' mysql 7F54B9CE8887428dBA9CEEB94CEF4C72 2 1 MySql支持库





.DLL命令 外部接口_设置MySql查询, 文本型, "mysql_find.dll", "外部接口_设置MySql查询", , 
    .参数 参数_MySql句柄, 整数型, , 
    .参数 参数_表名, 文本型, , 
    .参数 字段, 文本型, , 
    .参数 查询条件编号, 文本型, , 
    .参数 显示字段编号, 文本型, , 
    .参数 用户, 文本型, , 
    .参数 范围, 整数型, , 
    .参数 清除, 逻辑型, , 
    .参数 可见, 逻辑型, , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 记录集, 整数型, , , 
.程序集变量 全局句柄, 整数型, , , 
.程序集变量 标签, 标签, , "0", 
.程序集变量 编辑框, 编辑框, , "0", 
.程序集变量 匿名程序集变量_47, 空白型, , , 
.程序集变量 字段, 文本型, , "0", 
.程序集变量 字段类型, 整数型, , "0", 
.程序集变量 匿名程序集变量_45, 空白型, , , 
.子程序 _按钮1_被单击, 空白型, , 
结束 ()


.子程序 _按钮2_被单击, 空白型, , 
列表 (.内容, )

.子程序 列表, 空白型, , 
.参数 条件, 文本型, , 
.参数 超级列表框, 超级列表框, , 

.局部变量 sql, 文本型, , , 
.局部变量 i, 空白型, , , 
.局部变量 j, 空白型, , , 
.局部变量 wb, 文本型, , , 
.局部变量 t, 空白型, , , 
.局部变量 id, 空白型, , , 

未知支持库函数_5 (记录集)
未知支持库函数_3 (全局句柄, 条件)
赋值 (记录集, 未知支持库函数_4 (全局句柄))
未知支持库函数_12 (记录集)
赋值 (.内容, 到文本 (未知支持库函数_7 (记录集)))
 ' 信息框 (取记录集行数 (记录集), 0, )
赋值 (超级列表框., {  })
赋值 (超级列表框., {  })
清除数组 (字段)
.计次循环首 (未知支持库函数_14 (记录集), j)
    赋值 (wb, “”)
    未知支持库函数_15 (记录集, 相减 (j, 1), wb)
    
    加入成员 (字段, wb)
    加入成员 (字段类型, 未知支持库函数_22 (记录集, 相减 (j, 1)))
    
    超级列表框.插入列 (wb, 80, , , )
.计次循环尾 ()

.计次循环首 (取数组成员数 (标签), i)
    .如果真 (是否已创建 (标签 [i]))
        标签.销毁 ( [i])
    .如果真结束
    .如果真 (是否已创建 (编辑框 [i]))
        编辑框.销毁 ( [i])
    .如果真结束
    
.计次循环尾 ()
重定义数组 (标签, 假, 取数组成员数 (字段))
重定义数组 (编辑框, 假, 取数组成员数 (字段))
.计次循环首 (取数组成员数 (字段), i)
    复制窗口组件 (标签 [i])
    赋值 (标签 [i], 可视, 真)
    赋值 (标签 [i], 顶边, 相加 (.顶边, 相乘 (i, .高度)))
    赋值 (标签 [i], 标题, 字段 [i])
    赋值 (标签 [i], 左边, .左边)
    复制窗口组件 (编辑框 [i])
    赋值 (编辑框 [i], 可视, 真)
    赋值 (编辑框 [i], 顶边, 相加 (.顶边, 相乘 (i, .高度)))
    赋值 (编辑框 [i], 左边, .左边)
.计次循环尾 ()
赋值 (_启动窗口., 相加 (.顶边, 相乘 (相加 (未知支持库函数_14 (记录集), 3), .高度)))
.计次循环首 (未知支持库函数_7 (记录集), i)
    赋值 (id, 0)
    .判断开始 (未知支持库函数_6 (记录集, “id”, id))
        赋值 (t, 超级列表框.插入表项 (“”, , , , id))
    .默认
        
    .判断结束
    .计次循环首 (取数组成员数 (字段), j)
        赋值 (wb, “”)
        .如果真 (未知支持库函数_6 (记录集, 字段 [j], wb))
            超级列表框.置标题 (t, 相减 (j, 1), wb)
        .如果真结束
        
    .计次循环尾 ()
    未知支持库函数_10 (记录集)
.计次循环尾 ()

.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (全局句柄, 未知支持库函数_1 (“www.freesql.org”, “jxc”, “542381”, “jxc”, 0))
.判断开始 (小于或等于 (全局句柄, 0))
    .判断开始 (等于 (信息框 (“连接数据库失败，是否现在设置数据库?”, 相加 (#错误图标, #是否钮), ), #是钮))
        结束 ()
    .默认
        结束 ()
    .判断结束
    
.默认
    
.判断结束
赋值 (., 相加 (., “(服务器：www.freesql.org)”))
_按钮2_被单击 ()

.子程序 _超级列表框1_表项被激活, 空白型, , 
.局部变量 i, 整数型, , , 

.计次循环首 (取列数 (), i)
    .判断开始 (是否已创建 (编辑框 [i]))
        赋值 (编辑框 [i], 内容, .取标题 (., 相减 (i, 1)))
    .默认
        
    .判断结束
    
.计次循环尾 ()

.子程序 _超级列表框1_当前表项被改变, 空白型, , 
_超级列表框1_表项被激活 ()

.子程序 _按钮3_被单击, 空白型, , 
.局部变量 i, 整数型, , , 

赋值 (.标记, “1”)
.计次循环首 (取数组成员数 (编辑框), i)
    赋值 (编辑框 [i], 内容, “”)
.计次循环尾 ()
赋值 (.禁止, 真)
赋值 (.禁止, 真)

.子程序 _按钮4_被单击, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 sql, 文本型, , , 

赋值 (sql, “”)
.计次循环首 (取数组成员数 (编辑框), i)
    .判断开始 (不等于 (i, 1))
        .判断开始 (或者 (等于 (内部接口_判断数据类型 (字段类型 [i]), 0), 等于 (内部接口_判断数据类型 (字段类型 [i]), 3)))
            赋值 (sql, 相加 (sql, “`”, 标签 [i], 标题, “`='”, 编辑框 [i], 内容, 选择 (等于 (i, 取数组成员数 (编辑框)), “'”, “',”)))
            
        .判断 (或者 (等于 (内部接口_判断数据类型 (字段类型 [i]), 2), 等于 (内部接口_判断数据类型 (字段类型 [i]), 5), 等于 (内部接口_判断数据类型 (字段类型 [i]), 4)))
            赋值 (sql, 相加 (sql, “`”, 标签 [i], 标题, “`=”, 编辑框 [i], 内容, 选择 (等于 (i, 取数组成员数 (编辑框)), “”, “,”)))
        .默认
            赋值 (sql, 相加 (sql, “`”, 标签 [i], 标题, “`=”, 编辑框 [i], 内容, 选择 (等于 (i, 取数组成员数 (编辑框)), “”, “,”)))
        .判断结束
        
    .默认
        
    .判断结束
    
.计次循环尾 ()
.判断开始 (等于 (.标记, “1”))
    输出调试文本 (sql)
    信息框 (未知支持库函数_3 (全局句柄, 相加 (“insert into gly set ”, sql)), 0, )
    
.判断 (等于 (.标记, “2”))
    输出调试文本 (sql)
    信息框 (未知支持库函数_3 (全局句柄, 相加 (“update gly set ”, sql, “ where id=”, 到文本 (.取表项数值 (.)))), 0, )
.默认
    
.判断结束
赋值 (.禁止, 假)
赋值 (.禁止, 假)


.子程序 _按钮6_被单击, 空白型, , 
赋值 (.标记, “2”)
赋值 (.禁止, 真)
赋值 (.禁止, 真)


.子程序 内部接口_判断数据类型, 整数型, , 1,文本2,逻辑3,数值4,日期时间5,字节集
.参数 参数_字段类型, 整数型, , 

.判断开始 (或者 (等于 (参数_字段类型, 253), 等于 (参数_字段类型, 25403), 等于 (参数_字段类型, 25203), 等于 (参数_字段类型, 25202), 等于 (参数_字段类型, 25208), 等于 (参数_字段类型, 25206), 等于 (参数_字段类型, 252))) ' 文本型,变长文本型，备注型。
    返回 (0)
.判断 (等于 (参数_字段类型, 102)) ' 逻辑型
    返回 (4)
.判断 (或者 (等于 (参数_字段类型, 3), 等于 (参数_字段类型, 2), 等于 (参数_字段类型, 101), 等于 (参数_字段类型, 8))) ' 整数型,字节型,短整数型,长整数型
    返回 (1)
.判断 (或者 (等于 (参数_字段类型, 0), 等于 (参数_字段类型, 4), 等于 (参数_字段类型, 5))) ' 整数型,小数型,双精度小数型
    返回 (2)
.判断 (或者 (等于 (参数_字段类型, 7), 等于 (参数_字段类型, 10), 等于 (参数_字段类型, 11), 等于 (参数_字段类型, 12), 等于 (参数_字段类型, 13))) ' 日期时间型
    返回 (3)
.判断 (或者 (等于 (参数_字段类型, 25201), 等于 (参数_字段类型, 25204), 等于 (参数_字段类型, 25205), 等于 (参数_字段类型, 25207))) ' 字节集型
    返回 (5)
.默认
    返回 (5)
.判断结束


.子程序 _按钮5_被单击, 空白型, , 
.判断开始 (未知支持库函数_3 (全局句柄, 相加 (“delete from gly where id=”, 到文本 (.取表项数值 (.)))))
    .删除表项 (.)
    信息框 (等于 (1, 1), 0, )
.默认
    
.判断结束


.子程序 _按钮7_被单击, 空白型, , 
.局部变量 aa, 文本型, , , 
.局部变量 aaa, 文本型, , "0", 

赋值 (aa, 外部接口_设置MySql查询 (全局句柄, “gly”, “”, “”, “”, “all”, 0, 真, 真))
赋值 (aaa, 分割文本 (aa, “|”, ))
.判断开始 (大于或等于 (取数组成员数 (aaa), 1))
    赋值 (.内容, aaa [1])
    _按钮2_被单击 ()
.默认
    
.判断结束



 ' 不属于任何一个程序集、类模块的函数：
