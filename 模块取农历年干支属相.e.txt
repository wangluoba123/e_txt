 ' 文件类型：Windows模块源码

 ' 程序名称：模块取农历年干支属相
 ' 程序描述：模块取农历年干支()
模块取农历年属相()
模块取日期属相()
@备注:
模块取农历年属相()不区分立春前后.
模块取日期属相()精确到立春前后.
 ' 程序作者：夜。。。未央
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：夜。。。未央 制作
 ' 版本号：1.0
 ' 创建号：24.4





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' CnCalendar {18C0788E-59AE-4112-B452-6BF0C1B727FB} 2 0 农历日期支持库





.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。


.子程序 模块取农历年干支, 文本型, , 根据公历年份数值返回农历年干支文本
.参数 年份数值, 整数型, , 公历年份数值

.局部变量 干支序号, 整数型, , , 
.局部变量 天干, 文本型, , , 
.局部变量 地支, 文本型, , , 

赋值 (干支序号, 相减 (求余数 (年份数值, 60), 3))
.如果真 (小于或等于 (干支序号, 0))
    赋值 (干支序号, 相加 (干支序号, 60))
.如果真结束
赋值 (天干, 子程序取干 (干支序号))
赋值 (地支, 子程序取支 (干支序号))
返回 (相加 (天干, 地支))

.子程序 子程序取干, 文本型, , 
.参数 参数数值, 整数型, , 

.局部变量 right, 文本型, , , 
.局部变量 ret, 文本型, , , 

 ' 1甲、2乙、3丙、4丁、5戊、6己、7庚、8辛、9壬、0癸
赋值 (right, 取文本右边 (到文本 (参数数值), 1))
.判断开始 (等于 (right, “1”))
    赋值 (ret, “甲”)
.判断 (等于 (right, “2”))
    赋值 (ret, “乙”)
.判断 (等于 (right, “3”))
    赋值 (ret, “丙”)
.判断 (等于 (right, “4”))
    赋值 (ret, “丁”)
.判断 (等于 (right, “5”))
    赋值 (ret, “戊”)
.判断 (等于 (right, “6”))
    赋值 (ret, “己”)
.判断 (等于 (right, “7”))
    赋值 (ret, “庚”)
.判断 (等于 (right, “8”))
    赋值 (ret, “辛”)
.判断 (等于 (right, “9”))
    赋值 (ret, “壬”)
.默认
    赋值 (ret, “癸”)
.判断结束
返回 (ret)

.子程序 子程序取支, 文本型, , 
.参数 参数数值, 整数型, , 

.局部变量 数值1, 整数型, , , 
.局部变量 ret, 文本型, , , return

 ' 1子、2丑、3寅、4卯、5辰、6巳、7午、8未、9申、10酉、11戌、0亥
赋值 (数值1, 参数数值)
.如果真 (大于 (数值1, 12))
    赋值 (数值1, 求余数 (数值1, 12))
.如果真结束
.如果真 (等于 (数值1, 12))
    赋值 (数值1, 0)
.如果真结束

.判断开始 (等于 (数值1, 1))
    赋值 (ret, “子”)
.判断 (等于 (数值1, 2))
    赋值 (ret, “丑”)
.判断 (等于 (数值1, 3))
    赋值 (ret, “寅”)
.判断 (等于 (数值1, 4))
    赋值 (ret, “卯”)
.判断 (等于 (数值1, 5))
    赋值 (ret, “辰”)
.判断 (等于 (数值1, 6))
    赋值 (ret, “巳”)
.判断 (等于 (数值1, 7))
    赋值 (ret, “午”)
.判断 (等于 (数值1, 8))
    赋值 (ret, “未”)
.判断 (等于 (数值1, 9))
    赋值 (ret, “申”)
.判断 (等于 (数值1, 10))
    赋值 (ret, “酉”)
.判断 (等于 (数值1, 11))
    赋值 (ret, “戌”)
.默认
    赋值 (ret, “亥”)
.判断结束
返回 (ret)



.子程序 模块取农历年属相, 文本型, , 根据家历年份数值返回农历年属相文本
.参数 年份数值, 整数型, , 

.局部变量 序号, 整数型, , , 
.局部变量 ret, 文本型, , , 

赋值 (ret, 未知支持库函数_6 (年份数值, 序号))
返回 (ret)

.子程序 模块取日期属相, 文本型, , 根据参数日期 回返该日期的属性文本
.参数 参数日期, 日期时间型, 可空, 

.局部变量 序号, 整数型, , , 
.局部变量 ret, 文本型, , ,  

.如果真 (是否为空 (参数日期))
    赋值 (参数日期, 取现行时间 ())
.如果真结束
赋值 (ret, 未知支持库函数_14 (参数日期, 序号))
返回 (ret)



 ' 不属于任何一个程序集、类模块的函数：
