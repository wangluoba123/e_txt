 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 2 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 1 扩展界面支持库一
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 1 0 数据操作支持库一



窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 433
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假






.窗口程序集 窗口程序集1, , , 

.程序集变量 项目名, 文本型, , "2", 
.程序集变量 子项目名, 文本型, , "2", 
.程序集变量 子项目内容, 字节集, , "2", 
.程序集变量 选中项, 空白型, , , 
.程序集变量 内容, 字节集, , , 
.程序集变量 文件, 文本型, , , 
.程序集变量 操作, 空白型, , , 
.程序集变量 旧父项目名, 文本型, , , 
.程序集变量 父项目名, 文本型, , , 
.程序集变量 新父项目名, 文本型, , , 
.程序集变量 子项目名称, 文本型, , , 
.子程序 _按钮3_被单击, 空白型, , 
.局部变量 目录, 文本型, , , 
.局部变量 文件, 文本型, , , 
.局部变量 内容, 字节集, , , 

.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“请输入项目名！”, 16, “错误：（”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (打开 ())
    赋值 (目录, 取文本左边 (.文件名, 倒找文本 (.文件名, “\”, , 真)))
    赋值 (文件, 寻找文件 (相加 (目录, “*.htm”), ))
    .判断循环首 (不等于 (删全部空 (文件), “”))
        赋值 (内容, 读入文件 (相加 (目录, 文件)))
        .如果真 (等于 (到小写 (取文本右边 (文件, 1)), “l”))
            赋值 (文件, 取文本左边 (文件, 相减 (取文本长度 (文件), 1)))
        .如果真结束
        赋值 (文件, 取文本左边 (文件, 相减 (取文本长度 (文件), 4)))
        添加记录 (文件, 内容)
        赋值 (文件, 寻找文件 ())
    .判断循环尾 ()
    未知函数_67174459 ()
.如果真结束
赋值 (.最大化按钮, 选中项)

.子程序 添加记录, 空白型, , 
.参数 文件名, 文本型, , 
.参数 内容值, 字节集, , 

.如果真 (等于 (加记录 (删全部空 (.内容), 文件名, 未知支持库函数_0 (未知支持库函数_3 (内容值, “rock”))), 假))
    信息框 (“添加记录失败！”, 16, “错误：（”)
    结束 ()
.如果真结束


.子程序 初始树型框, 空白型, , 
.局部变量 父项目, 文本型, , , 
.局部变量 次数, 空白型, , , 
.局部变量 层次, 空白型, , , 

清空 ()
到首记录 ()
.如果 (不等于 (取记录数 (), 0))
    赋值 (读 (1))
    -1.加入项目 (读 (1), 1, 0, 1)
    .如果真 (不等于 (读 (2), “”))
        0.加入项目 (读 (2), 2, 3, 1)
    .如果真结束
    赋值 (0)
    .计次循环首 (相减 (取记录数 (), 1), )
        跳过 ()
        .如果真 (不等于 (读 (1), ))
            -1.加入项目 (读 (1), 1, 0, 相加 (层次, 1))
            赋值 (读 (1))
            次数.扩展 ()
            赋值 (相减 (取项目数 (), 1))
        .如果真结束
        .如果真 (不等于 (读 (2), “”))
            次数.加入项目 (读 (2), 2, 3, 相加 (层次, 1))
        .如果真结束
        
    .计次循环尾 ()
    次数.扩展 ()
.否则
    .计次循环首 (8, 次数)
        次数.加入状态 (4)
    .计次循环尾 ()
.如果结束
获取焦点 ()

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 字段集, 字段信息, , "0", 
.局部变量 字段, 字段信息, , , 

.如果真 (等于 (寻找文件 (相加 (取当前目录 (), “\基础.edb”), ), “”))
    赋值 (字段.名称, “项目”)
    赋值 (字段.类型, #文本型)
    赋值 (字段.最大文本长度, 100)
    加入成员 (字段集, 字段)
    赋值 (字段.名称, “子项目”)
    赋值 (字段.类型, #文本型)
    赋值 (字段.最大文本长度, 100)
    加入成员 (字段集, 字段)
    赋值 (字段.名称, “内容”)
    赋值 (字段.类型, #字节集型)
    加入成员 (字段集, 字段)
    创建 (相加 (取当前目录 (), “\基础.edb”), 字段集)
.如果真结束
打开 (相加 (取当前目录 (), “\基础.edb”), , , , , , )
未知函数_67174452 ()
赋值 (.最大化按钮, 选中项)

.子程序 移动记录, 空白型, , 
.参数 当前位置, 空白型, , 
.参数 移动位次, 空白型, , 

跳到 (当前位置)
赋值 (项目名 [1], 读 (1))
赋值 (子项目名 [1], 读 (2))
赋值 (子项目内容 [1], 读 (3))
跳过 (移动位次)
赋值 (项目名 [2], 读 (1))
赋值 (子项目名 [2], 读 (2))
赋值 (子项目内容 [2], 读 (3))
修改 (项目名 [1], 子项目名 [1], 子项目内容 [1])
跳过 (负 (移动位次))
修改 (项目名 [2], 子项目名 [2], 子项目内容 [2])
.置项目文本 (.最大化按钮, 子项目名 [2])
相加 (.最大化按钮, 移动位次).置项目文本 (子项目名 [1])
赋值 (选中项, 相加 (.最大化按钮, 移动位次))

.子程序 插入记录, 空白型, , 
.参数 当前位置, 空白型, , 
.参数 插入位次, 空白型, , 

加空记录 ()
到尾记录 ()
.计次循环首 (相加 (相减 (取记录数 (), 当前位置), 插入位次), )
    跳过 (-1)
    赋值 (项目名 [1], 读 (1))
    赋值 (子项目名 [1], 读 (2))
    赋值 (子项目内容 [1], 读 (3))
    跳过 ()
    修改 (项目名 [1], 子项目名 [1], 子项目内容 [1])
    跳过 (-1)
.计次循环尾 ()

.子程序 _按钮2_被单击, 空白型, , 
.如果真 (等于 (操作, -1))
    信息框 (“请先选择操作方式！”, 16, “错误：（”)
    返回 ()
.如果真结束
.如果真 (添加检查 ())
    .如果真 (等于 (.禁止, 假))
        .如果真 (等于 (取字节集长度 (), 0))
            信息框 (“请选择帮助内容！”, 16, “错误：（”)
            获取焦点 ()
            返回 ()
        .如果真结束
        
    .如果真结束
    .判断开始 (等于 (操作, 0))
        .如果真 (等于 (重复判断 (), 假))
            返回 ()
        .如果真结束
        添加记录 (删全部空 (.内容), 内容)
    .判断 (等于 (操作, 1))
        .如果真 (并且 (等于 (查找 (并且 (等于 (读 (1), 删全部空 (.内容)), 等于 (读 (2), 删全部空 (.内容)))), 真), 不等于 (.取项目数值 (.最大化按钮), 取记录号 ())))
            信息框 (“该项目及子项目已经存在！”, 16, “错误：（”)
            获取焦点 ()
            返回 ()
        .如果真结束
        跳到 (.取项目数值 (.最大化按钮))
        赋值 (读 (1))
        修改记录 (删全部空 (.内容), 内容)
    .判断 (等于 (操作, 2))
        .如果真 (等于 (重复判断 (), 假))
            返回 ()
        .如果真结束
        .如果真 (并且 (等于 (.内容, .取项目文本 (.最大化按钮)), 等于 (.取父项目 (.最大化按钮), -1)))
            信息框 (“该项目名存在！”, 16, “错误：（”)
            返回 ()
        .如果真结束
        插入记录 (选中项.取项目数值 (), 1)
        跳到 (选中项.取项目数值 ())
        修改记录 (删全部空 (.内容), 内容)
    .判断 (等于 (操作, 3))
        .如果真 (等于 (重复判断 (), 假))
            返回 ()
        .如果真结束
        插入记录 (选中项.取项目数值 (), -1)
        跳到 (相加 (选中项.取项目数值 (), 1))
        修改记录 (删全部空 (.内容), 内容)
    .默认
        
    .判断结束
    未知函数_67174536 ()
    赋值 (.最大化按钮, 选中项)
.如果真结束


.子程序 _按钮1_被单击, 空白型, , 
.如果真 (等于 (打开 (), 真))
    赋值 (.文件名)
    赋值 (内容, 读入文件 (文件))
.如果真结束


.子程序 添加检查, 逻辑型, , 
.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“请输入项目名！”, 16, “错误：（”)
    获取焦点 ()
    返回 (假)
.如果真结束
到首记录 ()
.如果真 (等于 (.禁止, 假))
    .如果真 (并且 (等于 (查找 (等于 (读 (1), 删全部空 (.内容))), 真), 等于 (删全部空 (.内容), “”)))
        信息框 (“请输入子项目名！”, 16, “错误：（”)
        获取焦点 ()
        返回 (假)
    .如果真结束
    
.如果真结束
返回 (真)

.子程序 _树型框1_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

.局部变量 次数, 空白型, , , 

赋值 (操作, -1)
赋值 (.禁止, 假)
赋值 (选中项, .最大化按钮)
.计次循环首 (8, 次数)
    次数.去除状态 (4)
    次数.去除状态 (1)
.计次循环尾 ()
.如果真 (等于 (相加 (.最大化按钮, 1).取父项目 (), -1))
    7.加入状态 (4)
.如果真结束
.如果真 (等于 (相减 (.最大化按钮, 1).取父项目 (), -1))
    6.加入状态 (4)
.如果真结束
.如果真 (等于 (.取父项目 (.最大化按钮), -1))
    4.加入状态 (4)
    5.加入状态 (4)
    6.加入状态 (4)
.如果真结束
.如果真 (等于 (选中项, 0))
    4.加入状态 (4)
    6.加入状态 (4)
.如果真结束
.如果真 (等于 (选中项, 相减 (取项目数 (), 1)))
    3.加入状态 (4)
    5.加入状态 (4)
    7.加入状态 (4)
.如果真结束
.如果真 (等于 (相减 (.最大化按钮, 1).取父项目 (), -1))
    4.加入状态 (4)
.如果真结束
.如果真 (等于 (相加 (.最大化按钮, 1).取父项目 (), -1))
    5.加入状态 (4)
.如果真结束
.如果真 (不等于 (.取父项目 (.最大化按钮), -1))
    7.加入状态 (4)
    赋值 (.内容, .取父项目 (.最大化按钮).取项目文本 ())
    赋值 (.内容, .取项目文本 (.最大化按钮))
    返回 ()
.如果真结束
赋值 (.内容, .取项目文本 (.最大化按钮))
赋值 (.内容, “”)

.子程序 修改记录, 空白型, , 
.参数 文件名, 文本型, , 
.参数 内容值, 字节集, , 

.如果 (等于 (.禁止, 真))
    .判断循环首 (等于 (读 (1), ))
        .如果真 (等于 (修改 (删全部空 (.内容), ), 假))
            信息框 (“修改记录失败！”, 16, “错误：（”)
            结束 ()
        .如果真结束
        跳过 ()
    .判断循环尾 ()
.否则
    .如果真 (等于 (修改 (删全部空 (.内容), , 未知支持库函数_0 (未知支持库函数_3 (“rock”))), 假))
        信息框 (“修改记录失败！”, 16, “错误：（”)
        结束 ()
    .如果真结束
    
.如果结束


.子程序 重复判断, 逻辑型, , 
.如果真 (等于 (查找 (并且 (等于 (读 (1), 删全部空 (.内容)), 等于 (读 (2), 删全部空 (.内容)))), 真))
    信息框 (“该项目及子项目已经存在！”, 16, “错误：（”)
    获取焦点 ()
    返回 (假)
.如果真结束
返回 (真)

.子程序 上调一层, 空白型, , 
.如果真 (等于 (信息框 (“如果该子项目上调一层，则其下所有子项目均将变成该子项目的子项目，上调吗？”, 52, “注意！”), 6))
    返回 ()
.如果真结束
跳到 (.取项目数值 (.最大化按钮))
修改 (新父项目名, 子项目名称)
跳过 ()
.判断循环首 (等于 (读 (1), ))
    修改 (新父项目名)
    跳过 ()
.判断循环尾 ()

.子程序 下调一层, 空白型, , 
.如果真 (等于 (信息框 (“如果该父项目下调一层，则其所有子项目均将变成新父项目的子项目，下调吗？”, 52, “注意！”), 6))
    返回 ()
.如果真结束
跳到 (.取项目数值 (.最大化按钮))
修改 (父项目名, 子项目名称)
跳过 ()
.判断循环首 (等于 (读 (1), 子项目名称))
    修改 ()
    跳过 ()
.判断循环尾 ()

.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

赋值 (.禁止, 假)
赋值 (操作, 按钮索引)
赋值 (.标题, “添加”)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
.如果 (等于 (操作, 0))
    赋值 (.可视, 真)
.否则
    赋值 (.可视, 假)
.如果结束
.如果真 (等于 (操作, 1))
    .如果真 (并且 (等于 (.取父项目 (.最大化按钮), -1), 等于 (.是否有子项目 (.最大化按钮), 真)))
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
    .如果真结束
    赋值 (.禁止, 假)
    
.如果真结束
.如果真 (或者 (等于 (操作, 3), 等于 (操作, 2)))
    赋值 (.禁止, 真)
    .如果真 (并且 (等于 (.取父项目 (.最大化按钮), -1), 等于 (操作, 2)))
        赋值 (.禁止, 假)
    .如果真结束
    
.如果真结束
.判断开始 (等于 (操作, 4))
    移动记录 (选中项.取项目数值 (), -1)
.判断 (等于 (操作, 5))
    移动记录 (选中项.取项目数值 (), 1)
.判断 (等于 (操作, 6))
    赋值 (新父项目名, .取项目文本 (.最大化按钮))
    到首记录 ()
    .如果真 (查找 (等于 (读 (1), 新父项目名)))
        信息框 (“以该子项目名为名的父项目已存在！请先改名再上调”, 16, “错误：（”)
        返回 ()
    .如果真结束
    .如果真 (输入框 (“请输入子项目名称！”, “上调一层”, , 子项目名称, ))
        .如果真 (等于 (删全部空 (子项目名称), “”))
            信息框 (“子项目名不能为空！”, 16, “错误：（”)
            返回 ()
        .如果真结束
        跳到 (.取项目数值 (.最大化按钮))
        赋值 (.取父项目 (.最大化按钮).取项目文本 ())
        上调一层 ()
    .如果真结束
    初始树型框 ()
.判断 (等于 (操作, 7))
    跳到 (.取项目数值 (.最大化按钮))
    赋值 (旧父项目名, 读 (1))
    .如果真 (输入框 (“请输入父项目名称！”, “下调一层”, , , ))
        .如果真 (等于 (删全部空 (), “”))
            信息框 (“父项目名不能为空！”, 16, “错误：（”)
            返回 ()
        .如果真结束
        到首记录 ()
        .如果真 (查找 (等于 (读 (1), )))
            .如果真 (不等于 (相减 (.最大化按钮, 1).取父项目 ().取项目文本 (), ))
                .如果 (或者 (不等于 (相减 (.最大化按钮, 1).取项目文本 (), ), 不等于 (相减 (.最大化按钮, 1).取父项目 (), -1)))
                    跳过 (-1)
                    .如果真 (不等于 (读 (1), 旧父项目名))
                        信息框 (“以该项目名为名的父项目已存在！请重新输入父项目名！”, 16, “错误：（”)
                        返回 ()
                    .如果真结束
                    
                .否则
                    信息框 (“该父项目为单独项目！请先插入子项目后再下调！”, 16, “错误：（”)
                    返回 ()
                .如果结束
                
            .如果真结束
            
        .如果真结束
        跳到 (.取项目数值 (.最大化按钮))
        赋值 (子项目名称, 读 (1))
        下调一层 ()
    .如果真结束
    初始树型框 ()
.判断 (等于 (操作, 8))
    .如果 (等于 (.取父项目 (.最大化按钮), -1))
        .如果真 (等于 (信息框 (“这是父项目，如果删除，其子项目将全部删除，删除吗？”, 52, “注意！”), 6))
            返回 ()
        .如果真结束
        到首记录 ()
        删除 (等于 (读 (1), .取项目文本 (.最大化按钮)))
    .否则
        .如果真 (等于 (信息框 (“确实要将该子项目删除吗？”, 52, “注意！”), 6))
            返回 ()
        .如果真结束
        跳到 (.取项目数值 (.最大化按钮))
        删除 ()
    .如果结束
    彻底删除 ()
    初始树型框 ()
.默认
    .如果真 (等于 (操作, 1))
        赋值 (.标题, “修改”)
    .如果真结束
    
.判断结束
获取焦点 ()
赋值 (.最大化按钮, 选中项)


 ' 不属于任何一个程序集、类模块的函数：
