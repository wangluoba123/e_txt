 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.wodesoft.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.wodesoft.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.wodesoft.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 主窗口
    左边 = 50
    顶边 = 50
    宽度 = 700
    高度 = 508
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “工厂图书室管理系统1.1”
    帮助文件名 = “”

窗口 新书入库窗口
    左边 = 50
    顶边 = 50
    宽度 = 369
    高度 = 371
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 借还管理窗口
    左边 = 50
    顶边 = 50
    宽度 = 759
    高度 = 554
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 图书类型管理
    左边 = 50
    顶边 = 50
    宽度 = 269
    高度 = 291
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “图书类型管理窗口”
    帮助文件名 = “”

窗口 查找窗口
    左边 = 50
    顶边 = 50
    宽度 = 518
    高度 = 360
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “查找窗口”
    帮助文件名 = “”

窗口 借书人修改窗口
    左边 = 50
    顶边 = 50
    宽度 = 427
    高度 = 291
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “修改借书人信息”
    帮助文件名 = “”

窗口 提醒器窗口
    左边 = 50
    顶边 = 50
    宽度 = 473
    高度 = 380
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “到期图书提醒”
    帮助文件名 = “”

窗口 登陆窗口
    左边 = 50
    顶边 = 50
    宽度 = 304
    高度 = 172
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理.e\登陆窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “用户登陆”
    帮助文件名 = “”

窗口 _启动窗口
    左边 = 50
    顶边 = 50
    宽度 = 453
    高度 = 215
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理.e\_启动窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 修改密码窗口
    左边 = 50
    顶边 = 50
    宽度 = 342
    高度 = 240
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理.e\修改密码窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “修改密码”
    帮助文件名 = “”

窗口 提醒天数设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 268
    高度 = 194
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “设置提醒天数”
    帮助文件名 = “”

窗口 帮助窗口
    左边 = 50
    顶边 = 50
    宽度 = 379
    高度 = 146
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “帮助”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 253
    高度 = 165
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\图书管理.e\关于窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 查找书
    左边 = 50
    顶边 = 50
    宽度 = 378
    高度 = 84
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “查找图书信息”
    帮助文件名 = “”

窗口 查找人
    左边 = 50
    顶边 = 50
    宽度 = 378
    高度 = 84
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “查找借书人信息”
    帮助文件名 = “”

窗口 查找借还
    左边 = 50
    顶边 = 50
    宽度 = 378
    高度 = 84
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “查找借还信息”
    帮助文件名 = “”



.图片 图标, " ' 已保存到：D:\易语言学习\Data\图书管理.e\图标", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' ExtMenu 9909FBB013704cfa8FE7E739DB7172DE 2 0 超级菜单支持库
 ' eCompress 7B68736E818E41c5A28B0AE4D43C128C 2 0 压缩解压支持库
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 3 0 扩展界面支持库三
 ' eExcel2000 F86EC5989E044d42BC98C692C0B54727 2 0 EXCEL2000支持库




.全局变量 记录集句柄, 整数型, , , 
.全局变量 配置文件名, 文本型, , , 

.DLL命令 UnregisterHotKey, 整数型, "user32.dll", "UnregisterHotKey", , 
    .参数 窗口句柄, 整数型, , 
    .参数 热键id, 整数型, , 

.DLL命令 置窗口特征, 子程序指针, "", "SetWindowLongA", , 
    .参数 窗口句柄, 整数型, , 
    .参数 特征索引, 整数型, , 
    .参数 新特征, 子程序指针, , 

.DLL命令 SendMessageCallback, 空白型, "user32.dll", "SendMessageCallbackA", , 
    .参数 hWnd, 空白型, , 
    .参数 Msg, 空白型, , 
    .参数 wParam, 空白型, , 
    .参数 IParam, 空白型, , 
    .参数 IpResultCallBack, 子程序指针, , 
    .参数 dwData, 空白型, , 

.DLL命令 执行窗口程序, 整数型, "", "CallWindowProcA", , 
    .参数 窗口程序程序指针, 子程序指针, , 
    .参数 窗口句柄, 整数型, , 
    .参数 消息, 整数型, , 
    .参数 参数1, 整数型, , 
    .参数 参数2, 整数型, , 

.DLL命令 RegisterHotKey, 整数型, "user32.dll", "RegisterHotKey", , 
    .参数 hWnd, 整数型, , 
    .参数 id, 整数型, , 
    .参数 fsModifoers, 整数型, , 
    .参数 vk, 整数型, , 

.窗口程序集 主窗口程序集, , , 

.子程序 _主窗口_创建完毕, 空白型, , 
赋值 (., 相减 (相加 (., 454), 取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\tss.mdb”).打开MDB数据库 (“6635210”, , ), 假))
    信息框 (“打开数据库失败，请选择备份文件恢复数据库！”, 0, )
    _恢复数据_被选择 ()
.如果真结束
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _时钟1_周期事件, 空白型, , 
主窗口.置文本 (., 0, 到文本 (取现行时间 ()))


.子程序 _新书入库_被选择, 空白型, , 
赋值 (新书入库窗口., 假)
载入 (新书入库窗口, , 真)
赋值 (新书入库窗口., “添加”)
赋值 (新书入库窗口., “添加图书”)
赋值 (新书入库窗口., 真)


.子程序 _借书登记_被选择, 空白型, , 
赋值 (借还管理窗口., “借书登记”)
赋值 (借还管理窗口., 假)
载入 (借还管理窗口, , 真)
赋值 (借还管理窗口., 真)

.子程序 _还书登记_被选择, 空白型, , 
赋值 (借还管理窗口., “还书登记”)
赋值 (借还管理窗口., 假)
载入 (借还管理窗口, , 真)
赋值 (借还管理窗口., 真)


.子程序 _暂时离开_被选择, 空白型, , 
赋值 (., 假)
主窗口.置托盘图标 (#图标, “离开一下”)
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 退出系统, 逻辑型, , 
.如果真 (等于 (信息框 (“你真的要退出程序？”, 1, “提示信息”), 0))
    销毁 ()
.如果真结束
返回 (假)
返回 (真)


.子程序 _图书管理_被选择, 空白型, , 
赋值 (.可视, 假)
赋值 (.字体大小, 假)
赋值 (.字体大小, 假)
赋值 (.字体大小, 真)
图书管理表镇充 ()


.子程序 _借书人管理_被选择, 空白型, , 
赋值 (.可视, 假)
赋值 (.字体大小, 假)
赋值 (.字体大小, 假)
赋值 (.字体大小, 真)
借书人管理表镇充 ()

.子程序 _借书人管理超级列表框_左键单击表项, 空白型, , 
.如果真 (不等于 (.取标题 (., 1), “”))
    赋值 (借书人修改窗口., 假)
    载入 (借书人修改窗口, , 真)
    赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select * from jsr where lbzj like'”, .取标题 (., 1), “'”)))
    赋值 (借书人修改窗口..内容, 到文本 (主窗口.读 (., 记录集句柄, “lbzj”)))
    赋值 (借书人修改窗口..内容, 到文本 (主窗口.读 (., 记录集句柄, “xm”)))
    赋值 (借书人修改窗口..内容, 到文本 (主窗口.读 (., 记录集句柄, “xb”)))
    赋值 (借书人修改窗口..内容, 到文本 (主窗口.读 (., 记录集句柄, “xmpy”)))
    赋值 (借书人修改窗口..内容, 到文本 (主窗口.读 (., 记录集句柄, “gzq”)))
    赋值 (借书人修改窗口..内容, 到文本 (主窗口.读 (., 记录集句柄, “bz”)))
    赋值 (借书人修改窗口..内容, 到文本 (主窗口.读 (., 记录集句柄, “glr”)))
    赋值 (借书人修改窗口..内容, 到文本 (主窗口.读 (., 记录集句柄, “bzdh”)))
    
    赋值 (借书人修改窗口..内容, 到文本 (主窗口.读 (., 记录集句柄, “grdh”)))
    赋值 (借书人修改窗口..内容, 到文本 (主窗口.读 (., 记录集句柄, “jscs”)))
    赋值 (借书人修改窗口..内容, 到文本 (主窗口.读 (., 记录集句柄, “whbs”)))
    主窗口.关闭记录集 (., 记录集句柄)
    赋值 (借书人修改窗口., 真)
     ' 本源码来自易语言资源网(www.wodesoft.com)
    
.如果真结束


.子程序 _借还列表_被选择, 空白型, , 
赋值 (.可视, 假)
赋值 (.字体大小, 假)
赋值 (.字体大小, 假)
赋值 (.字体大小, 真)
借还列表镇充 ()

.子程序 _借还管理超级列表框_左键单击表项, 空白型, , 
.如果真 (不等于 (.取标题 (., 1), “”))
    赋值 (借还管理窗口., 假)
    赋值 (借还管理窗口., “还书登记”)
    载入 (借还管理窗口, , 真)
    赋值 (借还管理窗口..内容, .取标题 (., 1))
    _内部证件号编辑框_失去焦点 ()
    赋值 (借还管理窗口., 真)
    
.如果真结束


.子程序 图书管理表镇充, 空白型, , 
.局部变量 插入位置, 整数型, , , 

赋值 (记录集句柄, 主窗口.查询 (., “select id,tsid,sm,smpy,rkrq,l,y,s,lx,dj,zz,wz,bz,cjh  from tsk order by tsid”))
全部删除 ()
主窗口.到首记录 (., 记录集句柄)
赋值 (插入位置, 0)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录集句柄), 假))
    插入位置.插入表项 (主窗口.读 (., 记录集句柄, “id”))
    插入位置.置标题 (0, 到文本 (相加 (插入位置, 1)))
    插入位置.置标题 (1, 到文本 (主窗口.读 (., 记录集句柄, “tsid”)))
    插入位置.置标题 (2, 到文本 (主窗口.读 (., 记录集句柄, “sm”)))
    插入位置.置标题 (3, 到文本 (主窗口.读 (., 记录集句柄, “smpy”)))
    插入位置.置标题 (4, 到文本 (主窗口.读 (., 记录集句柄, “rkrq”)))
    插入位置.置标题 (5, 相加 (到文本 (主窗口.读 (., 记录集句柄, “l”)), “-”, 到文本 (主窗口.读 (., 记录集句柄, “y”)), “-”, 到文本 (主窗口.读 (., 记录集句柄, “s”)), “期”))
    插入位置.置标题 (6, 到文本 (主窗口.读 (., 记录集句柄, “dj”)))
    插入位置.置标题 (7, 到文本 (主窗口.读 (., 记录集句柄, “zz”)))
    插入位置.置标题 (8, 到文本 (主窗口.读 (., 记录集句柄, “lx”)))
    插入位置.置标题 (9, 到文本 (主窗口.读 (., 记录集句柄, “wz”)))
    插入位置.置标题 (10, 到文本 (主窗口.读 (., 记录集句柄, “cjh”)))
    插入位置.置标题 (11, 到文本 (主窗口.读 (., 记录集句柄, “bz”)))
    主窗口.到后一记录 (., 记录集句柄)
    赋值 (插入位置, 相加 (插入位置, 1))
.判断循环尾 ()
主窗口.关闭记录集 (., 记录集句柄)


.子程序 借书人管理表镇充, 空白型, , 
.局部变量 插入位置, 整数型, , , 

赋值 (记录集句柄, 主窗口.查询 (., “select * from jsr order by lbzj”))
全部删除 ()
主窗口.到首记录 (., 记录集句柄)
赋值 (插入位置, 0)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录集句柄), 假))
    插入位置.插入表项 (主窗口.读 (., 记录集句柄, “id”))
    插入位置.置标题 (0, 到文本 (相加 (插入位置, 1)))
    插入位置.置标题 (1, 到文本 (主窗口.读 (., 记录集句柄, “lbzj”)))
    插入位置.置标题 (2, 到文本 (主窗口.读 (., 记录集句柄, “xm”)))
    插入位置.置标题 (3, 到文本 (主窗口.读 (., 记录集句柄, “xb”)))
    插入位置.置标题 (4, 到文本 (主窗口.读 (., 记录集句柄, “xmpy”)))
    插入位置.置标题 (5, 到文本 (主窗口.读 (., 记录集句柄, “gzq”)))
    插入位置.置标题 (6, 到文本 (主窗口.读 (., 记录集句柄, “bz”)))
    插入位置.置标题 (7, 到文本 (主窗口.读 (., 记录集句柄, “glr”)))
    插入位置.置标题 (8, 到文本 (主窗口.读 (., 记录集句柄, “bzdh”)))
    插入位置.置标题 (9, 到文本 (主窗口.读 (., 记录集句柄, “grdh”)))
    插入位置.置标题 (10, 到文本 (主窗口.读 (., 记录集句柄, “jscs”)))
    插入位置.置标题 (11, 到文本 (主窗口.读 (., 记录集句柄, “whbs”)))
    主窗口.到后一记录 (., 记录集句柄)
    赋值 (插入位置, 相加 (插入位置, 1))
.判断循环尾 ()
主窗口.关闭记录集 (., 记录集句柄)
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 借还列表镇充, 空白型, , 
.局部变量 插入位置, 整数型, , , 

赋值 (记录集句柄, 主窗口.查询 (., “select * from jss order by jsrq”))
全部删除 ()
主窗口.到首记录 (., 记录集句柄)
赋值 (插入位置, 0)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录集句柄), 假))
    插入位置.插入表项 (主窗口.读 (., 记录集句柄, “id”))
    插入位置.置标题 (0, 到文本 (相加 (插入位置, 1)))
    插入位置.置标题 (1, 到文本 (主窗口.读 (., 记录集句柄, “lbzj”)))
    插入位置.置标题 (2, 到文本 (主窗口.读 (., 记录集句柄, “xm”)))
    插入位置.置标题 (3, 到文本 (主窗口.读 (., 记录集句柄, “smid”)))
    插入位置.置标题 (4, 到文本 (主窗口.读 (., 记录集句柄, “sm”)))
    插入位置.置标题 (5, 到文本 (主窗口.读 (., 记录集句柄, “zj”)))
    插入位置.置标题 (6, 到文本 (主窗口.读 (., 记录集句柄, “yj”)))
    插入位置.置标题 (7, 到文本 (主窗口.读 (., 记录集句柄, “jsrp”)))
    插入位置.置标题 (8, 到文本 (主窗口.读 (., 记录集句柄, “hf”)))
    插入位置.置标题 (9, 到文本 (主窗口.读 (., 记录集句柄, “bz”)))
    主窗口.到后一记录 (., 记录集句柄)
    赋值 (插入位置, 相加 (插入位置, 1))
.判断循环尾 ()
主窗口.关闭记录集 (., 记录集句柄)


.子程序 _到期图书提醒_被选择, 空白型, , 
赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select id,lbzj,xm,sm,smid,jsrq,hf  from jss where hf='未还' and jsrq<#”, 时间到格式文本 (增减时间 (取现行时间 (), #日, 负 (到数值 (读配置项 (配置文件名, “系统”, “提醒天数”, “1”))))), “#”)))
载入 (提醒器窗口, , 真)

.子程序 _主窗口_尺寸被改变, 空白型, , 
.局部变量 分组框高度, 整数型, , , 
.局部变量 分组框宽度, 整数型, , , 

赋值 (分组框高度, 相减 (取用户区高度 (), 50))
赋值 (分组框宽度, 相减 (主窗口., 33))
.移动 (相减 (分组框宽度, 136), 相减 (分组框高度, 12))
.移动 (相减 (分组框宽度, 136), 相减 (分组框高度, 12))
.移动 (相减 (分组框宽度, 136), 相减 (分组框高度, 12))
.移动 (相减 (分组框宽度, 136), 相减 (分组框高度, 12))
赋值 (., 相减 (分组框高度, 12))

.子程序 _修改密码_被选择, 空白型, , 
载入 (修改密码窗口, , 真)


.子程序 _数据备份_被选择, 空白型, , 
关闭 ()
赋值 (.类型, 1)
赋值 (.初始目录, 相加 (取运行目录 (), “\备份\”))
打开 ()
.如果真 (等于 (相加 (取运行目录 (), “\tss.mdb”).未知支持库函数_0 (.文件名), 1))
    赋值 (.文件名, “”)
    信息框 (“数据备份成功，恭喜！恭喜！”, 64, “提示信息：”)
.如果真结束
相加 (取运行目录 (), “\tss.mdb”).打开MDB数据库 (“6635210”, , )


.子程序 _恢复数据_被选择, 空白型, , 
关闭 ()
赋值 (.类型, 0)
赋值 (.初始目录, 相加 (取运行目录 (), “\备份\”))
打开 ()
.如果真 (等于 (.未知支持库函数_2 (.文件名, 取运行目录 ()), 1))
    赋值 (.文件名, “”)
    信息框 (“数据恢复成功，恭喜！恭喜！”, 48, “提示信息：”)
.如果真结束
相加 (取运行目录 (), “\tss.mdb”).打开MDB数据库 (“6635210”, , )


.子程序 _提醒天数设置_被选择, 空白型, , 
载入 (提醒天数设置窗口, , 真)


.子程序 _获取帮助_被选择, 空白型, , 
载入 (帮助窗口, , 真)
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _重新登陆_被选择, 空白型, , 
.如果真 (等于 (信息框 (“确定要重新登陆?”, 1, “提示信息”), 0))
    载入 (_启动窗口, , 真)
.如果真结束
返回 ()

.子程序 _关于_被选择, 空白型, , 
载入 (关于窗口, , 真)


.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.局部变量 密码, 文本型, , , 

.如果真 (等于 (按钮索引, 1))
    _新书入库_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 2))
    _借书登记_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 3))
    _还书登记_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 5))
    _图书管理_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 6))
    _借书人管理_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 7))
    _借还列表_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 9))
    .如果真 (等于 (.字体大小, 真))
        图书管理表镇充 ()
    .如果真结束
    .如果真 (等于 (.字体大小, 真))
        借书人管理表镇充 ()
    .如果真结束
    .如果真 (等于 (.字体大小, 真))
        借还列表镇充 ()
        
    .如果真结束
    
.如果真结束
.如果真 (等于 (按钮索引, 10))
    .如果真 (等于 (.字体大小, 真))
        .如果真 (等于 (输入框 (“请输入超级管理员密码后才有权修改！”, “请输入超级管理员密码后才有权修改！”, , 密码, 4), 真))
            赋值 (记录集句柄, 主窗口.查询 (., “select * from yfk where yfm='超级管理员'”))
            .如果 (等于 (删全部空 (密码), 删全部空 (主窗口.读 (., 记录集句柄, “yfmm”))))
                .如果 (等于 (主窗口.执行 (., 相加 (“update tsk set cjh='在库' where id=”, 到文本 (.取表项数值 (.))), ), 假))
                    信息框 (“操作失败！”, 0, )
                .否则
                    .置标题 (., 10, “在库”)
                .如果结束
                
            .否则
                信息框 (“密码错误，不能进行操作！”, 0, )
                主窗口.关闭记录集 (., )
                返回 ()
            .如果结束
            
        .如果真结束
        
    .如果真结束
    
.如果真结束
.如果真 (等于 (按钮索引, 11))
    .如果真 (等于 (.字体大小, 真))
        .如果真 (等于 (输入框 (“请输入超级管理员密码后才有权修改！”, “请输入超级管理员密码后才有权修改！”, , 密码, 4), 真))
            赋值 (记录集句柄, 主窗口.查询 (., “select * from yfk where yfm='超级管理员'”))
            .如果 (等于 (删全部空 (密码), 删全部空 (主窗口.读 (., 记录集句柄, “yfmm”))))
                .如果 (等于 (主窗口.执行 (., 相加 (“update tsk set cjh='丢失' where id=”, 到文本 (.取表项数值 (.))), ), 假))
                    信息框 (“操作失败！”, 0, )
                .否则
                    .置标题 (., 10, “丢失”)
                .如果结束
                
            .否则
                信息框 (“密码错误，不能进行操作！”, 0, )
                主窗口.关闭记录集 (., )
                返回 ()
            .如果结束
            
        .如果真结束
        
    .如果真结束
    
.如果真结束

.如果真 (等于 (按钮索引, 12))
    _重新登陆_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 13))
    退出系统 ()
.如果真结束



.子程序 _卷帘式菜单1_项目被选择, 空白型, , 
.参数 菜单索引, 整数型, , 
.参数 项目索引, 整数型, , 

.局部变量 行, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 行计次, 整数型, , , 
.局部变量 列计次, 整数型, , , 
.局部变量 字母, 文本型, , "1", 

.如果真 (等于 (菜单索引, 0))
    .如果真 (等于 (项目索引, 0))
        _新书入库_被选择 ()
    .如果真结束
    .如果真 (等于 (项目索引, 1))
        _借书登记_被选择 ()
    .如果真结束
    .如果真 (等于 (项目索引, 2))
        _还书登记_被选择 ()
    .如果真结束
    
.如果真结束
.如果真 (等于 (菜单索引, 1))
    .如果真 (等于 (项目索引, 0))
        _图书管理_被选择 ()
    .如果真结束
    .如果真 (等于 (项目索引, 1))
        _借书人管理_被选择 ()
    .如果真结束
    .如果真 (等于 (项目索引, 2))
        _借还列表_被选择 ()
    .如果真结束
    
.如果真结束
.如果真 (等于 (菜单索引, 2))
    .如果真 (并且 (等于 (主窗口..字体大小, 真), 等于 (项目索引, 0)))
        载入 (查找书, , 真)
    .如果真结束
    .如果真 (并且 (等于 (主窗口..字体大小, 真), 等于 (项目索引, 1)))
        载入 (查找人, , 真)
    .如果真结束
    .如果真 (并且 (等于 (主窗口..字体大小, 真), 等于 (项目索引, 2)))
        载入 (查找借还, , 真)
        
    .如果真结束
    
.如果真结束
.如果真 (等于 (菜单索引, 3))
    .如果真 (并且 (等于 (主窗口..字体大小, 真), 等于 (项目索引, 0)))
        赋值 (.标题, “保存Excel文件”)
        赋值 (.默认文件后缀, “.xls”)
        赋值 (.过滤器, “Excel文件|*.xls”)
        赋值 (.初始目录, 取当前目录 ())
        赋值 (.文件名, 相加 (“导出图书信息”, 到文本 (取现行时间 ()), “.xls”))
        .如果 (等于 (打开 (), 真)) ' 先判断用户是否真的执行了导出命令,如果出现保存提示框后,用户选择了取消,那么,下面的代码将不会执行,就可以避免取消时已经打开的EXCEL程序提示要不要保存的问题
             ' 由于EXCEL表格的列标号是字母A到Z而不是数字,所以得把字母放入一个变量,用变量[数字]来得到相应的列标号字母
            赋值 (字母 [1], “A”)
            加入成员 (字母, “B”)
            加入成员 (字母, “C”)
            加入成员 (字母, “D”)
            加入成员 (字母, “E”)
            加入成员 (字母, “F”)
            加入成员 (字母, “G”)
            加入成员 (字母, “H”)
            加入成员 (字母, “I”)
            加入成员 (字母, “J”)
            加入成员 (字母, “K”)
            加入成员 (字母, “L”)
            加入成员 (字母, “M”)
            赋值 (行, 取表项数 ()) ' 这个行数将来用作循环导出时记录的行数,也就是记录数,导出电子表格需要行循环和列循环,是嵌套的
            赋值 (列, 取列数 ())
            .如果真 (取反 (大于 (取表项数 (), 0))) ' 判断超级列表框中有没表项,如果没有,就是说没有查询出记录,也就不必要导出了
                信息框 (“查询结果列表中没有信息!请先定义条件查询出结果再进行导出.”, 0, )
                返回 ()
                
            .如果真结束
            .如果 (主窗口.未知支持库函数_0 (.)) ' 如果创建失败,证明客户的电脑上没有安装EXCEL,导出是不能成功的,所以判断一下,没有就取消
                
            .否则
                信息框 (“您的计算机没有安装EXCEL2000电子表格软件,请安装EXCEL后再使用此功能!”, 0, )
                返回 ()
            .如果结束
            
            赋值 (主窗口.., 真) ' 通常导出数据时不要显示EXCEL程序,但在编程调试的时候,还是打开为好,看看实际效果,编译时再关掉.要是能不打开EXCEL程序而实现导出就好了,很慢的,
            主窗口.未知支持库函数_6 (., )
            赋值 (主窗口.., 1)
            赋值 (主窗口.., “导出图书信息”)
            .计次循环首 (列, 列计次) ' 这个循环把数据库里的所有字段名读出并写入到EXCEL程序的第二行里面,当作表格的列标题
                赋值 (., 相加 (字母 [列计次], “1”))
                赋值 (., 相加 (字母 [列计次], “1”)) ' 当循环第一次时,字母[列计次]就是字母[1],它的值是A,加字符2后是A2,A2就是EXCEL表格中的第二行第一列,第一行合并了,写入了一个标题
                赋值 (., 相减 (列计次, 1).取列标题 ())
            .计次循环尾 ()
            
            .计次循环首 (行, 行计次)
                .计次循环首 (列, 列计次)
                    赋值 (., 相加 (字母 [列计次], 到文本 (相加 (行计次, 1))))
                    赋值 (., 相加 (字母 [列计次], 到文本 (相加 (行计次, 1))))
                    赋值 (., 相减 (行计次, 1).取标题 (相减 (列计次, 1)))
                .计次循环尾 ()
            .计次循环尾 ()
            未知支持库函数_29 ()
            .未知支持库函数_16 (.文件名)
            
            信息框 (相加 (“导出文件成功!”, #换行符, “该文件保存在”, 取当前目录 (), “下,”, “文件名为:”, .文件名), 0, )
            未知支持库函数_15 ()
            未知支持库函数_3 ()
        .否则
            
            信息框 (“由于用户取消,本次导出没有成功!”, 0, )
            未知支持库函数_15 ()
            未知支持库函数_3 ()
            返回 ()
        .如果结束
         ' 本源码来自易语言资源网(www.wodesoft.com)
        
    .如果真结束
    .如果真 (并且 (等于 (.字体大小, 真), 等于 (项目索引, 1)))
        赋值 (.标题, “保存Excel文件”)
        赋值 (.默认文件后缀, “.xls”)
        赋值 (.过滤器, “Excel文件|*.xls”)
        赋值 (.初始目录, 取当前目录 ())
        赋值 (.文件名, 相加 (“导出借书人信息”, 到文本 (取现行时间 ()), “.xls”))
        .如果 (等于 (打开 (), 真)) ' 先判断用户是否真的执行了导出命令,如果出现保存提示框后,用户选择了取消,那么,下面的代码将不会执行,就可以避免取消时已经打开的EXCEL程序提示要不要保存的问题
             ' 由于EXCEL表格的列标号是字母A到Z而不是数字,所以得把字母放入一个变量,用变量[数字]来得到相应的列标号字母
            赋值 (字母 [1], “A”)
            加入成员 (字母, “B”)
            加入成员 (字母, “C”)
            加入成员 (字母, “D”)
            加入成员 (字母, “E”)
            加入成员 (字母, “F”)
            加入成员 (字母, “G”)
            加入成员 (字母, “H”)
            加入成员 (字母, “I”)
            加入成员 (字母, “J”)
            加入成员 (字母, “K”)
            加入成员 (字母, “L”)
            加入成员 (字母, “M”)
            赋值 (行, 取表项数 ()) ' 这个行数将来用作循环导出时记录的行数,也就是记录数,导出电子表格需要行循环和列循环,是嵌套的
            赋值 (列, 取列数 ())
            .如果真 (取反 (大于 (取表项数 (), 0))) ' 判断超级列表框中有没表项,如果没有,就是说没有查询出记录,也就不必要导出了
                信息框 (“查询结果列表中没有信息!请先定义条件查询出结果再进行导出.”, 0, )
                返回 ()
                
            .如果真结束
            .如果 (主窗口.未知支持库函数_0 (.)) ' 如果创建失败,证明客户的电脑上没有安装EXCEL,导出是不能成功的,所以判断一下,没有就取消
                
            .否则
                信息框 (“您的计算机没有安装EXCEL2000电子表格软件,请安装EXCEL后再使用此功能!”, 0, )
                返回 ()
            .如果结束
            
            赋值 (主窗口.., 真) ' 通常导出数据时不要显示EXCEL程序,但在编程调试的时候,还是打开为好,看看实际效果,编译时再关掉.要是能不打开EXCEL程序而实现导出就好了,很慢的,
            主窗口.未知支持库函数_6 (., )
            赋值 (主窗口.., 1)
            赋值 (主窗口.., “导出借书人信息”)
            .计次循环首 (列, 列计次) ' 这个循环把数据库里的所有字段名读出并写入到EXCEL程序的第二行里面,当作表格的列标题
                赋值 (., 相加 (字母 [列计次], “1”))
                赋值 (., 相加 (字母 [列计次], “1”)) ' 当循环第一次时,字母[列计次]就是字母[1],它的值是A,加字符2后是A2,A2就是EXCEL表格中的第二行第一列,第一行合并了,写入了一个标题
                赋值 (., 相减 (列计次, 1).取列标题 ())
            .计次循环尾 ()
            
            .计次循环首 (行, 行计次)
                .计次循环首 (列, 列计次)
                    赋值 (., 相加 (字母 [列计次], 到文本 (相加 (行计次, 1))))
                    赋值 (., 相加 (字母 [列计次], 到文本 (相加 (行计次, 1))))
                    赋值 (., 相减 (行计次, 1).取标题 (相减 (列计次, 1)))
                .计次循环尾 ()
            .计次循环尾 ()
            未知支持库函数_29 ()
            .未知支持库函数_16 (.文件名)
            
            信息框 (相加 (“导出文件成功!”, #换行符, “该文件保存在”, 取当前目录 (), “下,”, “文件名为:”, .文件名), 0, )
            未知支持库函数_15 ()
            未知支持库函数_3 ()
        .否则
            
            信息框 (“由于用户取消,本次导出没有成功!”, 0, )
            未知支持库函数_15 ()
            未知支持库函数_3 ()
            返回 ()
        .如果结束
        
    .如果真结束
    .如果真 (并且 (等于 (.字体大小, 真), 等于 (项目索引, 2)))
        赋值 (.标题, “保存Excel文件”)
        赋值 (.默认文件后缀, “.xls”)
        赋值 (.过滤器, “Excel文件|*.xls”)
        赋值 (.初始目录, 取当前目录 ())
        赋值 (.文件名, 相加 (“导出借还信息”, 到文本 (取现行时间 ()), “.xls”))
        .如果 (等于 (打开 (), 真)) ' 先判断用户是否真的执行了导出命令,如果出现保存提示框后,用户选择了取消,那么,下面的代码将不会执行,就可以避免取消时已经打开的EXCEL程序提示要不要保存的问题
             ' 由于EXCEL表格的列标号是字母A到Z而不是数字,所以得把字母放入一个变量,用变量[数字]来得到相应的列标号字母
            赋值 (字母 [1], “A”)
            加入成员 (字母, “B”)
            加入成员 (字母, “C”)
            加入成员 (字母, “D”)
            加入成员 (字母, “E”)
            加入成员 (字母, “F”)
            加入成员 (字母, “G”)
            加入成员 (字母, “H”)
            加入成员 (字母, “I”)
            加入成员 (字母, “J”)
            赋值 (行, 取表项数 ()) ' 这个行数将来用作循环导出时记录的行数,也就是记录数,导出电子表格需要行循环和列循环,是嵌套的
            赋值 (列, 取列数 ())
            .如果真 (取反 (大于 (取表项数 (), 0))) ' 判断超级列表框中有没表项,如果没有,就是说没有查询出记录,也就不必要导出了
                信息框 (“查询结果列表中没有信息!请先定义条件查询出结果再进行导出.”, 0, )
                返回 ()
                
            .如果真结束
            .如果 (主窗口.未知支持库函数_0 (.)) ' 如果创建失败,证明客户的电脑上没有安装EXCEL,导出是不能成功的,所以判断一下,没有就取消
                
            .否则
                信息框 (“您的计算机没有安装EXCEL2000电子表格软件,请安装EXCEL后再使用此功能!”, 0, )
                返回 ()
            .如果结束
            
            赋值 (主窗口.., 真) ' 通常导出数据时不要显示EXCEL程序,但在编程调试的时候,还是打开为好,看看实际效果,编译时再关掉.要是能不打开EXCEL程序而实现导出就好了,很慢的,
            主窗口.未知支持库函数_6 (., )
            赋值 (主窗口.., 1)
            赋值 (主窗口.., “导出借还信息”)
            .计次循环首 (列, 列计次) ' 这个循环把数据库里的所有字段名读出并写入到EXCEL程序的第二行里面,当作表格的列标题
                赋值 (., 相加 (字母 [列计次], “1”))
                赋值 (., 相加 (字母 [列计次], “1”)) ' 当循环第一次时,字母[列计次]就是字母[1],它的值是A,加字符2后是A2,A2就是EXCEL表格中的第二行第一列,第一行合并了,写入了一个标题
                赋值 (., 相减 (列计次, 1).取列标题 ())
            .计次循环尾 ()
            
            .计次循环首 (行, 行计次)
                .计次循环首 (列, 列计次)
                    赋值 (., 相加 (字母 [列计次], 到文本 (相加 (行计次, 1))))
                    赋值 (., 相加 (字母 [列计次], 到文本 (相加 (行计次, 1))))
                    赋值 (., 相减 (行计次, 1).取标题 (相减 (列计次, 1)))
                .计次循环尾 ()
            .计次循环尾 ()
            未知支持库函数_29 ()
            .未知支持库函数_16 (.文件名)
            
            信息框 (相加 (“导出文件成功!”, #换行符, “该文件保存在”, 取当前目录 (), “下,”, “文件名为:”, .文件名), 0, )
            未知支持库函数_15 ()
            未知支持库函数_3 ()
        .否则
            
            信息框 (“由于用户取消,本次导出没有成功!”, 0, )
            未知支持库函数_15 ()
            未知支持库函数_3 ()
            返回 ()
        .如果结束
        
    .如果真结束
    
.如果真结束




.子程序 _主窗口_可否被关闭, 逻辑型, , 
返回 (退出系统 ())


.子程序 _退出系统_被选择, 空白型, , 
.如果真 (等于 (信息框 (“你真的要退出程序？”, 1, “提示信息”), 0))
    关闭所有文件 ()
    销毁 ()
.如果真结束
返回 ()



.子程序 同名镇充, 空白型, , 
.局部变量 插入位置, 整数型, , , 

赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select *  from tsk where sm like'”, 新书入库窗口..内容, “'”)))
全部删除 ()
主窗口.到首记录 (., 记录集句柄)
赋值 (插入位置, 0)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录集句柄), 假))
    插入位置.插入表项 (主窗口.读 (., 记录集句柄, “id”))
    插入位置.置标题 (0, 到文本 (相加 (插入位置, 1)))
    插入位置.置标题 (1, 到文本 (主窗口.读 (., 记录集句柄, “tsid”)))
    插入位置.置标题 (2, 到文本 (主窗口.读 (., 记录集句柄, “sm”)))
    插入位置.置标题 (3, 到文本 (主窗口.读 (., 记录集句柄, “smpy”)))
    插入位置.置标题 (4, 到文本 (主窗口.读 (., 记录集句柄, “rkrq”)))
    插入位置.置标题 (5, 相加 (到文本 (主窗口.读 (., 记录集句柄, “l”)), “-”, 到文本 (主窗口.读 (., 记录集句柄, “y”)), “-”, 到文本 (主窗口.读 (., 记录集句柄, “s”)), “期”))
    插入位置.置标题 (6, 到文本 (主窗口.读 (., 记录集句柄, “dj”)))
    插入位置.置标题 (7, 到文本 (主窗口.读 (., 记录集句柄, “zz”)))
    插入位置.置标题 (8, 到文本 (主窗口.读 (., 记录集句柄, “lx”)))
    插入位置.置标题 (9, 到文本 (主窗口.读 (., 记录集句柄, “wz”)))
    插入位置.置标题 (10, 到文本 (主窗口.读 (., 记录集句柄, “cjh”)))
    插入位置.置标题 (11, 到文本 (主窗口.读 (., 记录集句柄, “bz”)))
    主窗口.到后一记录 (., 记录集句柄)
    赋值 (插入位置, 相加 (插入位置, 1))
.判断循环尾 ()
主窗口.关闭记录集 (., 记录集句柄)
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 同类镇充, 空白型, , 
.局部变量 插入位置, 整数型, , , 

赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select *  from tsk where lx like'”, 新书入库窗口..内容, “'”)))
全部删除 ()
主窗口.到首记录 (., 记录集句柄)
赋值 (插入位置, 0)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录集句柄), 假))
    插入位置.插入表项 (主窗口.读 (., 记录集句柄, “id”))
    插入位置.置标题 (0, 到文本 (相加 (插入位置, 1)))
    插入位置.置标题 (1, 到文本 (主窗口.读 (., 记录集句柄, “tsid”)))
    插入位置.置标题 (2, 到文本 (主窗口.读 (., 记录集句柄, “sm”)))
    插入位置.置标题 (3, 到文本 (主窗口.读 (., 记录集句柄, “smpy”)))
    插入位置.置标题 (4, 到文本 (主窗口.读 (., 记录集句柄, “rkrq”)))
    插入位置.置标题 (5, 相加 (到文本 (主窗口.读 (., 记录集句柄, “l”)), “-”, 到文本 (主窗口.读 (., 记录集句柄, “y”)), “-”, 到文本 (主窗口.读 (., 记录集句柄, “s”)), “期”))
    插入位置.置标题 (6, 到文本 (主窗口.读 (., 记录集句柄, “dj”)))
    插入位置.置标题 (7, 到文本 (主窗口.读 (., 记录集句柄, “zz”)))
    插入位置.置标题 (8, 到文本 (主窗口.读 (., 记录集句柄, “lx”)))
    插入位置.置标题 (9, 到文本 (主窗口.读 (., 记录集句柄, “wz”)))
    插入位置.置标题 (10, 到文本 (主窗口.读 (., 记录集句柄, “cjh”)))
    插入位置.置标题 (11, 到文本 (主窗口.读 (., 记录集句柄, “bz”)))
    主窗口.到后一记录 (., 记录集句柄)
    赋值 (插入位置, 相加 (插入位置, 1))
.判断循环尾 ()
主窗口.关闭记录集 (., 记录集句柄)


.子程序 _图书管理超级列表框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (不等于 (.取标题 (., 1), “”))
    赋值 (新书入库窗口., 假)
    赋值 (新书入库窗口., “修改”)
    载入 (新书入库窗口, , 真)
    赋值 (新书入库窗口., “修改图书信息”)
    赋值 (新书入库窗口..标题, “修 改”)
    赋值 (新书入库窗口..禁止, 真)
    赋值 (新书入库窗口..可视, 假)
    赋值 (新书入库窗口..可视, 假)
    赋值 (新书入库窗口..可视, 假)
    赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select rkrq,tsid,sm,smpy,lx,zz,dj,wz,l,y,s,bz,cjh  from tsk where tsid like'”, .取标题 (., 1), “'”)))
    赋值 (新书入库窗口..内容, .取标题 (., 1))
    赋值 (新书入库窗口..内容, 主窗口.读 (., 记录集句柄, “bz”))
    赋值 (新书入库窗口..内容, 到文本 (主窗口.读 (., 记录集句柄, “lx”)))
    赋值 (新书入库窗口..今天, 到时间 (主窗口.读 (., 记录集句柄, “rkrq”)))
    赋值 (新书入库窗口..内容, 主窗口.读 (., 记录集句柄, “sm”))
    赋值 (新书入库窗口..内容, 主窗口.读 (., 记录集句柄, “smpy”))
    赋值 (新书入库窗口..内容, 到文本 (主窗口.读 (., 记录集句柄, “dj”)))
    赋值 (新书入库窗口..内容, 主窗口.读 (., 记录集句柄, “zz”))
    赋值 (新书入库窗口..内容, 主窗口.读 (., 记录集句柄, “wz”))
    赋值 (新书入库窗口..内容, 主窗口.读 (., 记录集句柄, “l”))
    赋值 (新书入库窗口..内容, 主窗口.读 (., 记录集句柄, “y”))
    赋值 (新书入库窗口..内容, 主窗口.读 (., 记录集句柄, “s”))
    主窗口.关闭记录集 (., 记录集句柄)
    赋值 (新书入库窗口..标题, “丢失”)
    赋值 (新书入库窗口..左边, 70)
    赋值 (新书入库窗口..可视, 真)
    赋值 (新书入库窗口..左边, 238)
    赋值 (新书入库窗口., 真) ' 出来
.如果真结束
' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _图书管理超级列表框_当前表项被改变, 空白型, , 
.如果 (或者 (等于 (.取标题 (., 10), “出借”), 等于 (.取标题 (., 10), “丢失”)))
    10.去除状态 (#禁止)
.否则
    10.加入状态 (#禁止)
.如果结束
.如果 (或者 (等于 (.取标题 (., 10), “出借”), 等于 (.取标题 (., 10), “在库”)))
    11.去除状态 (#禁止)
.否则
    11.加入状态 (#禁止)
.如果结束


.窗口程序集 新书入库窗口程序集, , , 

.子程序 _新书入库窗口_创建完毕, 空白型, , 
赋值 (., 相减 (相加 (., 339), 取用户区高度 ()))
赋值 (.内容, 读配置项 (配置文件名, “编号”, “图书编号”, ))
置图书类型 ()

.子程序 _添加_被单击, 空白型, , 
.局部变量 计次变量, 整数型, , , 
.局部变量 选中项, 整数型, , , 
.局部变量 密码, 文本型, , , 
.局部变量 记录集句柄1, 整数型, , , 

.判断开始 (等于 (., “修改”))
     ' 本源码来自易语言资源网(www.wodesoft.com)
    
    
    
    赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select cjh from tsk where tsid like'”, .内容, “'”)))
    .判断开始 (等于 (主窗口.读 (., 记录集句柄, “cjh”), “出借”))
        信息框 (“此书现在出借中，不可修改！”, 48, “提示信息”)
        销毁 ()
        返回 ()
    .判断 (等于 (主窗口.执行 (., 相加 (“Update tsk set   rkrq='”, 时间到格式文本 (.今天), “',  sm='”, .内容, “',  smpy='”, .内容, “',  lx='”, .内容, “',  zz='”, .内容, “',  dj=”, .内容, “,  wz='”, .内容, “',  l='”, .内容, “',y='”, .内容, “',s='”, .内容, “',  bz='”, .内容, “'  where tsk.tsid='”, .内容, “'  ”), ), 假))
        信息框 (“图书修改不成功！可能是数据库正在被其它程序占用！”, 48, “出错信息”)
        返回 ()
        
    .默认
        .如果真 (等于 (.选中, 真))
            .如果真 (等于 (输入框 (“请输入超级管理员密码后才有权修改！”, “请输入超级管理员密码后才有权修改！”, , 密码, 4), 真))
                赋值 (记录集句柄1, 主窗口.查询 (., “select * from yfk where yfm='超级管理员'”))
                
                .如果 (等于 (删全部空 (密码), 删全部空 (主窗口.读 (., 记录集句柄1, “yfmm”))))
                    主窗口.执行 (., 相加 (“Update tsk set  cjh='丢失'  where  tsid='”, .内容, “'”), ) ' 标记为丢失
                .否则
                    信息框 (“密码错误，不可进行此操作!”, 0, )
                    主窗口.关闭记录集 (., 记录集句柄1)
                    返回 ()
                .如果结束
                主窗口.关闭记录集 (., 记录集句柄1)
                
            .如果真结束
            
        .如果真结束
        .如果真 (等于 (.现行选中项, 0))
             ' _图书管理_被选择 ()
        .如果真结束
        .如果真 (等于 (.现行选中项, 1))
            主窗口.同名镇充 ()
        .如果真结束
        .如果真 (等于 (.现行选中项, 2))
            主窗口.同类镇充 ()
        .如果真结束
        销毁 ()
        信息框 (“图书信息修改成功!”, 64, “提示信息”)
        返回 ()
        
         ' 本源码来自易语言资源网(www.wodesoft.com)
    .判断结束
    
.默认
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (选中项, .现行选中项)
    
    .如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
        信息框 (“图书编号、书名必须填！！”, 64, “提示信息：”)
        返回 ()
    .如果真结束
    .如果真 (小于 (到数值 (.内容), 到数值 (.内容)))
        信息框 (“自动编号出错！结束编号一定要比起始编号大才对！请换过来！不明白请看帮助！”, 64, “提示信息：”)
        获取焦点 ()
        返回 ()
    .如果真结束
    .变量循环首 (到数值 (.内容), 到数值 (.内容), 1, 计次变量) ' 自动编号添加图书
        主窗口.启动事务 (.) ' 加个事务，防万一
        赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select COUNT(*)  from tsk  where tsid='”, 删全部空 (.内容), “-”, 到文本 (计次变量), “'”))) ' 判断票号有没搞同了，
        .如果真 (不等于 (主窗口.读 (., 记录集句柄, 1), 0))
            信息框 (相加 (“图书编号 ［”, .内容, “-”, 到文本 (计次变量), “ ］已经被使用，清换个编号！”), #警告图标, “出错信息：”)
            主窗口.回滚事务 (.) ' 出错都回滚，就是不会添加数据
            返回 ()
        .如果真结束
        主窗口.关闭记录集 (., 记录集句柄)
        .如果真 (等于 (主窗口.执行 (., 相加 (“Insert into tsk (rkrq,tsid,sm,smpy,lx,zz,dj,wz,l,y,s,bz) values ('”, 时间到格式文本 (.今天), “','”, 删全部空 (.内容), “-”, 到文本 (计次变量), “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “')”), ), 假))
            信息框 (“图书添加出错，请重新来过！”, 0, “出错信息：”)
            主窗口.回滚事务 (.) ' 出错都回滚，就是不会添加数据
            返回 ()
        .如果真结束
        
    .变量循环尾 ()
    主窗口.提交事务 (.)
    信息框 (“图书添加成功！恭喜！恭喜！”, 64, “提示信息：”)
    .如果真 (等于 (.现行选中项, 0))
        _图书管理_被选择 ()
    .如果真结束
    .如果真 (等于 (.现行选中项, 1))
        主窗口.同名镇充 ()
    .如果真结束
    .如果真 (等于 (.现行选中项, 2))
        主窗口.同类镇充 ()
    .如果真结束
    赋值 (.内容, 取文本右边 (相加 (“000000000000000”, 到文本 (相加 (到数值 (.内容), 1))), 取文本长度 (.内容)))
    赋值 (.现行选中项, 选中项)
    .如果真 (等于 (.选中, 真)) ' 如果清除选中，添加完后清除一些信息
        连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容)
        赋值 (.内容, “0.00”)
        赋值 (.现行选中项, -1)
    .如果真结束
    
    
    
    
.判断结束




.子程序 _书名框_内容被改变, 空白型, , 
 ' 赋值 (.内容, 取首拼 ())

.子程序 _变量框1_失去焦点, 空白型, , 
.如果真 (小于 (到数值 (.内容), 1)) ' 不能为空，空就弄为1，一般不会出现这种情况，不过安全第一吗，哈
    赋值 (.内容, “1”)
.如果真结束


.子程序 _变量框2_失去焦点, 空白型, , 
.如果真 (小于 (到数值 (.内容), 到数值 (.内容)))
    信息框 (“自动编号出错！结束编号一定要比起始编号大才对！请换过来！不明白请看帮助！”, 64, “提示信息：”)
    
.如果真结束


.子程序 置图书类型, 空白型, , 置组合框1的内容
赋值 (记录集句柄, 主窗口.查询 (., “select * from tslx order by bh”))
主窗口.到首记录 (., 记录集句柄) ' 这句不要忘了，不然，哈，好像查到后指针在最后的
.判断循环首 (等于 (主窗口.尾记录后 (., 记录集句柄), 假))
    主窗口.读 (., 记录集句柄, “mc”).加入项目 ()
    主窗口.到后一记录 (., 记录集句柄)
.判断循环尾 ()
主窗口.关闭记录集 (., 记录集句柄)

.子程序 _退出_被单击, 空白型, , 
销毁 ()


.子程序 _新书入库窗口_将被销毁, 空白型, , 
.如果真 (等于 (., “添加”))
    写配置项 (配置文件名, “编号”, “图书编号”, .内容)
    
.如果真结束
' 本源码来自易语言资源网(www.wodesoft.com)


.子程序 _按钮1_被单击, 空白型, , 
载入 (图书类型管理, , 真)


.子程序 _删除_被单击, 空白型, , 
.局部变量 密码, 文本型, , , 

.如果真 (等于 (输入框 (“请输入超级管理员密码后才有权修改！”, “请输入超级管理员密码后才有权修改！”, , 密码, 4), 真))
    赋值 (记录集句柄, 主窗口.查询 (., “select * from yfk where yfm='超级管理员'”))
    .如果 (等于 (删全部空 (密码), 删全部空 (主窗口.读 (., 记录集句柄, “yfmm”))))
        .如果真 (等于 (信息框 (“图书删除后将不可恢复，是否真的要删除”, #是否钮, “提示信息：”), 5))
            赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select cjh from tsk where tsid='”, .内容, “'”)))
            .判断开始 (不等于 (主窗口.读 (., 记录集句柄, 1), “出借”)) ' 书如果出借了就不可以删图书
                主窗口.执行 (., 相加 (“delete from tsk where  tsid='”, .内容, “'”), )
                信息框 (“删除成功！”, 48, “提示信息”)
                销毁 ()
            .默认
                信息框 (“此书出借还没还呢，不可以删除！”, 48, “提示信息”)
            .判断结束
            
        .如果真结束
        
    .否则
        信息框 (“密码错误码不可进行此操作！”, 0, )
        
    .如果结束
    主窗口.关闭记录集 (., 记录集句柄)
    
    
    
.如果真结束





.程序集 共用子程序程序集, , , 

.子程序 时间到格式文本, 文本型, , 2000-2-2（写数据库时用）
.参数 时间, 日期时间型, , 

.局部变量 时间文本, 文本型, , , 

赋值 (时间文本, 相加 (到文本 (取时间部分 (时间, #年份)), “-”, 到文本 (取时间部分 (时间, #月份)), “-”, 到文本 (取时间部分 (时间, #日))))
返回 (时间文本)

.子程序 时间到格式文本2, 文本型, , 2000年02月02日（读数据库时用）
.参数 时间, 日期时间型, , 

.局部变量 时间文本, 文本型, , , 

赋值 (时间文本, 相加 (到文本 (取时间部分 (时间, #年份)), “年”, 取文本右边 (相加 (“00”, 到文本 (取时间部分 (时间, #月份))), 2), “月”, 取文本右边 (相加 (“00”, 到文本 (取时间部分 (时间, #日))), 2), “日”))
返回 (时间文本)

.子程序 取首拼, 文本型, , 取汉字的首拼音
.参数 编辑框, 编辑框, , 要取拼音的编辑框名

.局部变量 计次变量, 整数型, , , 计次变量
.局部变量 文本, 文本型, , , 
.局部变量 拼音, 文本型, , , 

赋值 (文本, 编辑框.内容)
.计次循环首 (取文本长度 (文本), 计次变量)
    .判断开始 (或者 (大于 (取代码 (取文本左边 (文本, 1), ), 127), 小于 (取代码 (取文本左边 (文本, 1), ), 0))) ' 判断是全半角
        .判断开始 (等于 (到大写 (取声母 (取文本左边 (文本, 2), 1)), “”)) ' 是全角但是不是汉字
            赋值 (拼音, 相加 (拼音, 到大写 (取文本左边 (文本, 2))))
        .默认
            赋值 (拼音, 相加 (拼音, 到大写 (取文本左边 (取声母 (取文本左边 (文本, 2), 1), 1))))
        .判断结束
        赋值 (文本, 取文本右边 (文本, 相减 (取文本长度 (文本), 2))) ' 把用过文本的去掉，嘻
    .默认
        赋值 (拼音, 相加 (拼音, 到大写 (取文本左边 (文本, 1))))
        赋值 (文本, 取文本右边 (文本, 相减 (取文本长度 (文本), 1)))
    .判断结束
    
.计次循环尾 ()
返回 (拼音)

.子程序 查询到列表框, 空白型, , 全部显示
.参数 列表框名, 超级列表框, , 超级列表框的名
.参数 图片1, 整数型, 可空, 条件为真所用图片
.参数 字段, 文本型, 可空, 数据库里的字段＝后面的条件
.参数 条件, 文本型, 可空, 用来做判断的条件
.参数 图片2, 整数型, 可空, 如果读字段＝条件则显示这张图片

.局部变量 插入表项位置, 整数型, , , 
.局部变量 计次数, 整数型, , , 
.局部变量 图片索引, 整数型, 静态, , 
.局部变量 新旧, 文本型, , , 

列表框名.全部删除 () ' 每次开始都清除一次列表框
主窗口.到首记录 (., 记录集句柄) ' 这句不要忘了，不然，哈，好像查到后指针在最后的
.判断循环首 (等于 (主窗口.尾记录后 (., 记录集句柄), 假)) ' 到了最后的记录就结束
    赋值 (图片索引, 图片1)
    .如果真 (等于 (主窗口.读 (., 记录集句柄, 字段), 条件))
        赋值 (图片索引, 图片2)
    .如果真结束
    赋值 (插入表项位置, 列表框名.插入表项 (相加 (“  ”, 到文本 (主窗口.读 (., 记录集句柄, “id”))), 图片索引, , , )) ' 第一格放图片和ID，不过ID不让人看到，表项查找的时候有用，嘻！
    .计次循环首 (相减 (列表框名.取列数 (), 1), 计次数)
        列表框名.置标题 (插入表项位置, 计次数, 到文本 (主窗口.读 (., 记录集句柄, 相加 (计次数, 1))))
        .如果真 (等于 (列表框名.取标题 (插入表项位置, 计次数), “100年1月1日”)) ' 去除空日期数据
            列表框名.置标题 (插入表项位置, 计次数, “”)
        .如果真结束
        ' 本源码来自易语言资源网(www.wodesoft.com)
    .计次循环尾 ()
    主窗口.到后一记录 (., 记录集句柄)
.判断循环尾 ()
主窗口.关闭记录集 (., 记录集句柄)


.窗口程序集 图书类型管理程度集, , , 

.子程序 _图书类型管理_创建完毕, 空白型, , 

赋值 (., 相减 (相加 (., 281), 取用户区高度 ()))

 ' 赋值 (记录集句柄, 主窗口.查询 (., “select *  from tslx order by bh”))
查询到列表框 (0)

.子程序 _超级列表框1_当前表项被改变, 空白型, , 将选中的内容显示出来
赋值 (.内容, .取标题 (., 1))
赋值 (.内容, .取标题 (., 2))

.子程序 _添加按钮_被单击, 空白型, , 
.如果真 (等于 (.内容, “”)) ' 判断如果为空就不添加东西
    信息框 (“请先填好要添加的类型编号，编号为显示顺序，最好不要重复！”, 64, “提示信息：”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请先填好要添加的类型名称！”, 64, “提示信息：”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (主窗口.执行 (., 相加 (“Insert into tslx (bh,mc) values('”, .内容, “','”, .内容, “' )”), ), 假))
    信息框 (“数据添加出错，可能是数据库被其它程序占用，请重新退出再进来！”, 48, “出错信息：”)
.如果真结束
主窗口.关闭记录集 (., 记录集句柄)
赋值 (记录集句柄, 主窗口.查询 (., “select *  from tslx order by bh”))
查询到列表框 (0)

' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _修改按钮_被单击, 空白型, , 
.局部变量 原类型, 文本型, , , 修改前的类型

 ' 修改类型的时候除了把tslx库里的类型改了外，还要改以前已经加到tsk库里的图书类型也改过来
赋值 (原类型, .取标题 (., 2))
.如果真 (等于 (主窗口.执行 (., 相加 (“Update tslx set bh='”, .内容, “',mc='”, .内容, “' where  id=”, .取标题 (., 0)), ), 假)) ' 修改图书类型库
    主窗口.回滚事务 (.)
    信息框 (“修改图书类型库时出错！”, 64, “提示信息：”)
    返回 ()
.如果真结束
.如果真 (等于 (主窗口.执行 (., 相加 (“Update tsk set lx='”, .内容, “' where lx='”, 原类型, “'”), ), 假)) ' 修改图书库，把图书库里此类型的名都跟着改一下
    主窗口.回滚事务 (.)
    信息框 (“修改图书库时出错！”, 64, “提示信息：”)
    返回 ()
.如果真结束
主窗口.提交事务 (.)
信息框 (相加 (“图书类型修改成功！库里所有原为［”, 原类型, “］的图书都改为［”, .内容, “］了！”), 64, “提示信息：”)
赋值 (记录集句柄, 主窗口.查询 (., “select *  from tslx order by bh”))
查询到列表框 (0)

.子程序 _删除按钮_被单击, 空白型, , 
.如果真 (等于 (信息框 (“不推荐使用删除功能，尤其是对已经使过的类型！是否确定要删除此类型！”, 52, “提示信息：”), #是钮))
    .如果真 (等于 (主窗口.执行 (., 相加 (“delete from tslx where id=”, .取标题 (., 0)), ), 假))
        信息框 (“删除数据时出错！”, 64, “提示信息：”)
    .如果真结束
    信息框 (“数据已经删除，将不可恢复！”, 64, “提示信息：”)
.如果真结束
赋值 (记录集句柄, 主窗口.查询 (., “select *  from tslx order by bh”))
查询到列表框 (0)


.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.窗口程序集 借还管理窗口程序集, , , 

.程序集变量 窗口句柄, 整数型, , , 热键注册用
.程序集变量 默认窗口程序, 子程序指针, , , 热键注册用
.子程序 _借还管理窗口_创建完毕, 空白型, , 
赋值 (., 相减 (相加 (., 510), 取用户区高度 ()))
赋值 (.禁止, 真)
赋值 (.禁止, 真)
.如果真 (等于 (借还管理窗口., “借书登记”))
    赋值 (借还管理窗口., “借书登记”)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 假)
    赋值 (.标题, “确定借出”)
    赋值 (.标题, “还书介面(&F10)”)
    获取焦点 ()
.如果真结束
.如果真 (等于 (借还管理窗口., “还书登记”))
    赋值 (借还管理窗口., “还书登记”)
    赋值 (.可视, 真)
    赋值 (.标题, “还书人登记”)
    赋值 (.文本颜色, #橙黄)
    赋值 (.可视, 假)
    赋值 (.标题, “确定归还”)
    赋值 (.标题, “借书介面(&F10)”)
    赋值 (.文本颜色, #紫色)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.如果真结束
注册热键部分 ()

.子程序 _内部证件号编辑框_失去焦点, 空白型, , 
.如果真 (不等于 (.内容, “”))
    赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select lbzj,xm,xb,xmpy,gzq,bz,glr,bzdh,grdh  from jsr where lbzj like '”, .内容, “'”)))
    .判断开始 (不等于 (主窗口.读 (., 记录集句柄, “lbzj”), “”))
        主窗口.到首记录 (., 记录集句柄)
        赋值 (.内容, 主窗口.读 (., 记录集句柄, “lbzj”))
        赋值 (.内容, 主窗口.读 (., 记录集句柄, “xm”))
        赋值 (.内容, 主窗口.读 (., 记录集句柄, “xb”))
        赋值 (.内容, 主窗口.读 (., 记录集句柄, “xmpy”))
        赋值 (.内容, 主窗口.读 (., 记录集句柄, “gzq”))
        赋值 (.内容, 主窗口.读 (., 记录集句柄, “bz”))
        赋值 (.内容, 主窗口.读 (., 记录集句柄, “glr”))
        赋值 (.内容, 主窗口.读 (., 记录集句柄, “bzdh”))
        赋值 (.内容, 主窗口.读 (., 记录集句柄, “grdh”))
        主窗口.关闭记录集 (., 记录集句柄)
        .如果真 (等于 (.可视, 真))
            获取焦点 ()
             ' 本源码来自易语言资源网(www.wodesoft.com)
        .如果真结束
        
    .默认
        连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
        连续赋值 (“0”, .内容, .内容)
        全部删除 ()
        
        
    .判断结束
    置表 ()
    .如果真 (等于 (.可视, 真))
        获取焦点 ()
        0.选择表项 ()
    .如果真结束
    
    
.如果真结束

 ' 图书信息部分

.子程序 _图书编号框_失去焦点, 空白型, , 
赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select rkrq,tsid,sm,lx,zz,dj,wz,l,y,s,bz,cjh  from tsk where tsid like'”, .内容, “'”)))
.如果真 (不等于 (.内容, “”))
    .如果真 (等于 (主窗口.读 (., 记录集句柄, “tsid”), “”))
        信息框 (“查无此编号图书，是否输入有误？”, 64, “提示信息：”)
        赋值 (.内容, “”)
        获取焦点 ()
        返回 ()
        
    .如果真结束
    .如果真 (或者 (等于 (主窗口.读 (., 记录集句柄, “cjh”), “出借”), 等于 (主窗口.读 (., 记录集句柄, “cjh”), “丢失”)))
        信息框 (“对不起，此书已经标注借出或丢失，请核实。”, 64, “提示信息：”)
        赋值 (.内容, “”)
        获取焦点 ()
        返回 ()
    .如果真结束
    
.如果真结束
主窗口.到首记录 (., 记录集句柄)
赋值 (.内容, 到文本 (主窗口.读 (., 记录集句柄, “rkrq”)))
赋值 (.内容, 主窗口.读 (., 记录集句柄, “tsid”))
赋值 (.内容, 主窗口.读 (., 记录集句柄, “sm”))
赋值 (.内容, 主窗口.读 (., 记录集句柄, “lx”))
赋值 (.内容, 主窗口.读 (., 记录集句柄, “zz”))
赋值 (.内容, 到文本 (主窗口.读 (., 记录集句柄, “dj”)))
赋值 (.内容, 主窗口.读 (., 记录集句柄, “wz”))
赋值 (.内容, 相加 (主窗口.读 (., 记录集句柄, “l”), “-”, 主窗口.读 (., 记录集句柄, “y”), “-”, 主窗口.读 (., 记录集句柄, “s”)))
赋值 (.内容, 主窗口.读 (., 记录集句柄, “cjh”))
主窗口.关闭记录集 (., 记录集句柄)
.如果真 (不等于 (.内容, “”))
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    获取焦点 ()
.如果真结束
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _姓名编辑框_内容被改变, 空白型, , 
赋值 (.内容, 取首拼 ())

.子程序 _退出窗口按钮_被单击, 空白型, , 
销毁 ()


.子程序 _查找按钮_被单击, 空白型, , 
赋值 (查找窗口., “找人”)
载入 (查找窗口, , 真)


.子程序 _刷新按钮_被单击, 空白型, , 
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
连续赋值 (“0”, .内容, .内容)
全部删除 ()



.子程序 _超级列表框1_左键单击表项, 空白型, , 
赋值 (借还管理窗口., “还书管理”)
赋值 (借还管理窗口., “还书登记”)
赋值 (.可视, 真)
赋值 (.标题, “还书人登记”)
赋值 (.文本颜色, #橙黄)
赋值 (.可视, 假)
赋值 (.标题, “确定归还”)
赋值 (.文本颜色, #紫色)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.内容, .取标题 (., ))
赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select rkrq,tsid,sm,lx,zz,dj,wz,l,y,s,bz  from tsk where tsid like'”, .内容, “'”)))
主窗口.到首记录 (., 记录集句柄)
赋值 (.内容, 主窗口.读 (., 记录集句柄, “tsid”))
赋值 (.内容, 主窗口.读 (., 记录集句柄, “sm”))
赋值 (.内容, 主窗口.读 (., 记录集句柄, “lx”))
赋值 (.内容, 主窗口.读 (., 记录集句柄, “zz”))
赋值 (.内容, 到文本 (主窗口.读 (., 记录集句柄, “dj”)))
赋值 (.内容, 主窗口.读 (., 记录集句柄, “wz”))
赋值 (.内容, 相加 (主窗口.读 (., 记录集句柄, “l”), “-”, 主窗口.读 (., 记录集句柄, “y”), “-”, 主窗口.读 (., 记录集句柄, “s”)))
主窗口.关闭记录集 (., 记录集句柄)
赋值 (.内容, .取标题 (., 4))
赋值 (.内容, .取标题 (., 7))
赋值 (.内容, .取标题 (., 2))
赋值 (.内容, .取标题 (., 3))
赋值 (.标题, “借书介面(&F10)”)
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _确定借还_被单击, 空白型, , 
.如果真 (等于 (.标题, “确定借出”))
    .如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”)))
        信息框 (“所镇信息不全，无法进行借书登记！”, 48, “提示信息：”)
        获取焦点 ()
        返回 ()
    .如果真结束
    
    赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select rkrq,tsid,sm,lx,zz,dj,wz,l,y,s,bz,cjh  from tsk where tsid like'”, .内容, “'”)))
    .如果真 (等于 (主窗口.读 (., 记录集句柄, “cjh”), “出借”))
        信息框 (“对不起，此书已经标注借出，请核实。”, 64, “提示信息：”)
         ' 图书编号框.内容 ＝ “”
        获取焦点 ()
        返回 ()
    .如果真结束
    主窗口.执行 (., 相加 (“insert into jsr (lbzj,xm,xb,xmpy,gzq,bz,glr,bzdh,grdh) values ('”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “')”), , , )
    主窗口.执行 (., 相加 (“insert into jss (lbzj,xm,sm,smid,zj,yj,jsrq,bz) values ('”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, 时间到格式文本 (取现行时间 ()), “','”, .内容, “')”), )
    主窗口.执行 (., 相加 (“Update tsk set cjh= '出借' where tsid='”, .内容, “'”), )
    赋值 (.内容, “出借”)
    主窗口.执行 (., 相加 (“update jsr set jscs=jscs+1,whbs=whbs+1  where lbzj='”, .内容, “'”), )
     ' 图书管理表镇充 ()
     ' 借还列表镇充 ()
     ' 借书人管理表镇充 ()
    信息框 (“恭喜！借书成功！”, 48, “提示信息”)
    获取焦点 ()
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
    连续赋值 (“0”, .内容, .内容)
    置表 ()
    返回 ()
.如果真结束
.如果真 (等于 (., -1))
    信息框 (“未在列表框中选定具体项，无法进行还书！”, 48, “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (.取标题 (., 6), “已还”))
    信息框 (“此书之前已还”, 48, “提示信息：”)
    返回 ()
.如果真结束
.如果真 (等于 (.标题, “确定归还”))
    主窗口.执行 (., 相加 (“update jss set hf='已还' where smid='”, .内容, “'”), )
    主窗口.执行 (., 相加 (“Update jss set bz='”, .内容, “'where smid ='”, .内容, “'”), )
    
    .如果真 (等于 (主窗口.执行 (., 相加 (“Update tsk set cjh= '在库' where tsid='”, .内容, “'”), ), 真))
        置表 ()
        主窗口.执行 (., 相加 (“update jsr set whbs=whbs-1 where lbzj='”, .内容, “'”), )
        
        信息框 (“还书成功”, 48, “提示信息”)
        获取焦点 ()
        0.选择表项 ()
         ' 借还列表镇充 ()
         ' 图书管理表镇充 ()
         ' 借书人管理表镇充 ()
        连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
        连续赋值 (“0”, .内容, .内容)
        
    .如果真结束
    
    
.如果真结束


.子程序 置表, 空白型, , 
.局部变量 插入位置, 整数型, , , 
.局部变量 出借天数, 整数型, , , 

赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select id,smid,sm,zj,yj,jsrq,hf,bz from jss where lbzj like'”, .内容, “'”)))
全部删除 ()
主窗口.到首记录 (., 记录集句柄)
赋值 (插入位置, 0)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录集句柄), 假))
    插入位置.插入表项 (主窗口.读 (., 记录集句柄, “id”))
    插入位置.置标题 (0, 到文本 (主窗口.读 (., 记录集句柄, “smid”)))
    插入位置.置标题 (1, 到文本 (主窗口.读 (., 记录集句柄, “sm”)))
    插入位置.置标题 (2, 到文本 (主窗口.读 (., 记录集句柄, “zj”)))
    插入位置.置标题 (3, 到文本 (主窗口.读 (., 记录集句柄, “yj”)))
    插入位置.置标题 (4, 到文本 (主窗口.读 (., 记录集句柄, “jsrq”)))
    赋值 (出借天数, 取时间间隔 (取日期 (取现行时间 ()), 到时间 (插入位置.取标题 (4)), #日))
    .如果真 (等于 (出借天数, 0))
        赋值 (出借天数, 1)
    .如果真结束
    插入位置.置标题 (5, 到文本 (出借天数))
    插入位置.置标题 (6, 到文本 (主窗口.读 (., 记录集句柄, “hf”)))
    插入位置.置标题 (7, 到文本 (主窗口.读 (., 记录集句柄, “bz”)))
    主窗口.到后一记录 (., 记录集句柄)
    赋值 (插入位置, 相加 (插入位置, 1))
.判断循环尾 ()
主窗口.关闭记录集 (., 记录集句柄)

.子程序 _介面切换按钮_被单击, 空白型, , 
.判断开始 (等于 (.标题, “还书介面(&F10)”))
    赋值 (.标题, “借书介面(&F10)”)
    赋值 (借还管理窗口., “还书登记”)
    赋值 (.可视, 真)
    赋值 (.标题, “还书人登记”)
    赋值 (.文本颜色, #橙黄)
    赋值 (.可视, 假)
    赋值 (.标题, “确定归还”)
    赋值 (.文本颜色, #紫色)
.判断 (等于 (.标题, “借书介面(&F10)”))
    赋值 (.标题, “还书介面(&F10)”)
    赋值 (借还管理窗口., “借书登记”)
    赋值 (.标题, “借书登记”)
    赋值 (.文本颜色, #蓝色)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.文本颜色, #红色)
    赋值 (.可视, 假)
    赋值 (.标题, “确定借出”)
    获取焦点 ()
.默认
    
.判断结束
.取消表项选择 (.)

.子程序 _清除记录按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    信息框 (“对不起，您未在列表框中选中具体的项，无法删除！”, 64, “提示信息：”)
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“您确定要删除该记录吗？”, 1, “提示信息：”), 1))
    .取消表项选择 (.)
    返回 ()
.如果真结束
.判断开始 (不等于 (.取标题 (., 6), “未还”))
    主窗口.执行 (., 相加 (“delete from jss  where smid='”, .取标题 (., 0), “'”), )
    借还列表镇充 ()
.默认
    信息框 (“此书还未还，无法删除！”, 48, “提示信息：”)
    .取消表项选择 (.)
    返回 ()
.判断结束
.删除表项 (.)

.子程序 _超级列表框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (等于 (键代码, #回车键))
    .如果真 (等于 (.取标题 (., 6), “未还”))
        _确定借还_被单击 ()
         ' 本源码来自易语言资源网(www.wodesoft.com)
        
    .如果真结束
    
.默认
    
.判断结束


.子程序 _超级列表框1_当前表项被改变, 空白型, , 
赋值 (.内容, .取标题 (., ))
赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select rkrq,tsid,sm,lx,zz,dj,wz,l,y,s,bz  from tsk where tsid like'”, .内容, “'”)))
主窗口.到首记录 (., 记录集句柄)
赋值 (.内容, 主窗口.读 (., 记录集句柄, “tsid”))
赋值 (.内容, 主窗口.读 (., 记录集句柄, “sm”))
赋值 (.内容, 主窗口.读 (., 记录集句柄, “lx”))
赋值 (.内容, 主窗口.读 (., 记录集句柄, “zz”))
赋值 (.内容, 到文本 (主窗口.读 (., 记录集句柄, “dj”)))
赋值 (.内容, 主窗口.读 (., 记录集句柄, “wz”))
赋值 (.内容, 相加 (主窗口.读 (., 记录集句柄, “l”), “-”, 主窗口.读 (., 记录集句柄, “y”), “-”, 主窗口.读 (., 记录集句柄, “s”)))
主窗口.关闭记录集 (., 记录集句柄)
赋值 (.内容, .取标题 (., 4))
赋值 (.内容, .取标题 (., 7))
赋值 (.内容, .取标题 (., 2))
赋值 (.内容, .取标题 (., 3))


.子程序 注册热键部分, 空白型, , 
赋值 (窗口句柄, 借还管理窗口.取窗口句柄 ())
RegisterHotKey (窗口句柄, #F11键, 0, #F11键)
 ' RegisterHotKey (窗口句柄, #下光标键, 0, #下光标键)
 ' RegisterHotKey (窗口句柄, #上光标键, 0, #上光标键)
RegisterHotKey (窗口句柄, #F10键, 0, #F10键)
 ' RegisterHotKey (窗口句柄, #F8键, 0, #F8键)
 ' RegisterHotKey (窗口句柄, #F3键, 0, #F3键)
赋值 (默认窗口程序, 置窗口特征 (窗口句柄, -4, &热键处理))

.子程序 热键处理, 整数型, , 
.参数 窗口句柄, 整数型, , 
.参数 消息, 整数型, , 
.参数 参数1, 整数型, , 
.参数 参数2, 整数型, , 

.局部变量 表项位置, 整数型, , , 

.如果 (等于 (消息, 786))
    .判断开始 (等于 (参数1, #F11键))
        获取焦点 ()
    .判断 (等于 (参数1, #F10键))
        _介面切换按钮_被单击 ()
    .默认
        
    .判断结束
    返回 (0)
.否则
    
.如果结束
返回 (执行窗口程序 (默认窗口程序, 窗口句柄, 消息, 参数1, 参数2))

.子程序 _图书编号框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _借还管理窗口_将被销毁, 空白型, , 
UnregisterHotKey (窗口句柄, #F11键)
UnregisterHotKey (窗口句柄, #F12键)

.子程序 _内部证件号编辑框_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)


.窗口程序集 查找窗口程序集, , , 

.子程序 _查找窗口_创建完毕, 空白型, , 

赋值 (., 相减 (相加 (., 336), 取用户区高度 ()))



.子程序 _查找_被单击, 空白型, , 
.判断开始 (等于 (.现行选中项, 0))
    赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select id,tsid,sm,lx,wz  from tsk  where  cjh='在库' and smpy like  '%”, .内容, “%'  order by tsid”)))
    查询到列表框 ()
.默认
    赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select id,tsid,sm,lx,wz  from tsk  where cjh='在库' and sm like  '%”, .内容, “%'  order by tsid”)))
    查询到列表框 ()
.判断结束
' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _图书列表框_表项被激活, 空白型, , 
赋值 (借还管理窗口..内容, .取标题 (., 1))
借还管理窗口._图书编号框_失去焦点 ()
销毁 ()

.子程序 _退出_被单击, 空白型, , 
销毁 ()

.窗口程序集 借书人修改窗口程序集, , , 

.子程序 _借书人修改窗口_创建完毕, 空白型, , 

赋值 (., 相减 (相加 (., 260), 取用户区高度 ()))


.子程序 _修改按钮_被单击, 空白型, , 
.判断开始 (等于 (主窗口.执行 (., 相加 (“Update jsr set lbzj='”, .内容, “',  xm='”, .内容, “',  xb='”, .内容, “',  xmpy='”, .内容, “',  gzq='”, .内容, “',  bz='”, .内容, “',  glr='”, .内容, “',  bzdh='”, .内容, “',  grdh='”, .内容, “',jscs=”, .内容, “,whbs=”, .内容, “  where jsr.lbzj='”, .内容, “'  ”), ), 假))
    信息框 (“借书人信息修改不成功！可能是数据库正在被其它程序占用！”, 48, “出错信息”)
    返回 ()
.默认
    信息框 (“恭喜！借书人信息修改成功！”, 64, “提示信息：”)
    _借书人管理_被选择 ()
    销毁 ()
     ' 本源码来自易语言资源网(www.wodesoft.com)
.判断结束


.子程序 _姓名编辑框_内容被改变, 空白型, , 
赋值 (.内容, 取首拼 ())


.子程序 _删除按钮_被单击, 空白型, , 
.如果真 (等于 (信息框 (“借书人信息删除后将不可恢复，是否真的要删除”, #是否钮, “提示信息：”), 5))
    赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select whbs from jsr where lbzj='”, .内容, “'”)))
    .判断开始 (大于或等于 (主窗口.读 (., 记录集句柄, “whbs”), 1))
        信息框 (“此人还有书未还，不可以删除！”, 48, “提示信息”)
        返回 ()
    .默认
        主窗口.执行 (., 相加 (“delete from jsr where  lbzj='”, .内容, “'”), )
        销毁 ()
        _借书人管理_被选择 ()
        ' 本源码来自易语言资源网(www.wodesoft.com)
        
    .判断结束
    
.如果真结束


.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()


.窗口程序集 提醒器窗口程序集, , , 

.子程序 _提醒器窗口_创建完毕, 空白型, , 
.局部变量 天数, 文本型, , , 
.局部变量 插入位置, 整数型, , , 

赋值 (主窗口., 真)
获取焦点 ()
赋值 (., 相减 (相加 (., 355), 取用户区高度 ()))
赋值 (天数, 读配置项 (配置文件名, “系统”, “提醒天数”, “10”))
赋值 (.标题, 相加 (“出借时间超过”, 天数, “天的图书”))
全部删除 ()
主窗口.到首记录 (., 记录集句柄)
赋值 (插入位置, 0)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录集句柄), 假))
    插入位置.插入表项 (主窗口.读 (., 记录集句柄, “id”))
    插入位置.置标题 (0, 到文本 (相加 (插入位置, 1)))
    插入位置.置标题 (1, 到文本 (主窗口.读 (., 记录集句柄, “lbzj”)))
    插入位置.置标题 (2, 到文本 (主窗口.读 (., 记录集句柄, “xm”)))
    插入位置.置标题 (3, 到文本 (主窗口.读 (., 记录集句柄, “smid”)))
    插入位置.置标题 (4, 到文本 (主窗口.读 (., 记录集句柄, “sm”)))
    主窗口.到后一记录 (., 记录集句柄)
    赋值 (插入位置, 相加 (插入位置, 1))
.判断循环尾 ()
主窗口.关闭记录集 (., 记录集句柄)
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _知道了按钮_被单击, 空白型, , 
提醒器窗口.销毁 ()
载入 (主窗口, , 真)

.子程序 _刷新按钮_被单击, 空白型, , 
提醒器窗口.销毁 ()
_到期图书提醒_被选择 ()



.子程序 _知道了按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _知道了按钮_被单击 ()
    
.如果真结束


.子程序 _提醒器超级列表框_左键单击表项, 空白型, , 
.局部变量 j, 整数型, , , 
.局部变量 j2, 整数型, , , 
.局部变量 j3, 整数型, , , 

.如果真 (不等于 (.取标题 (., 1), “”))
    赋值 (借还管理窗口., 假)
    赋值 (借还管理窗口., “还书登记”)
    载入 (借还管理窗口, , 真)
    赋值 (借还管理窗口..内容, .取标题 (., 1))
    _内部证件号编辑框_失去焦点 ()
    赋值 (j, 借还管理窗口.取表项数 (.))
    .计次循环首 (j, j2)
        赋值 (j3, 相减 (j2, 1))
        借还管理窗口.选择表项 (., j3)
        .如果真 (等于 (借还管理窗口.取标题 (., 借还管理窗口.., 0), .取标题 (., 3)))
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
    借还管理窗口.获取焦点 (.)
    _超级列表框1_左键单击表项 ()
    赋值 (借还管理窗口., 真)
    ' 本源码来自易语言资源网(www.wodesoft.com)
    
.如果真结束


.子程序 _提醒器窗口_将被销毁, 空白型, , 
载入 (主窗口, , 真)


.窗口程序集 登陆窗口程序集, , , 

.子程序 _登陆窗口_创建完毕, 空白型, , 
获取焦点 ()
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _确定按钮_被单击, 空白型, , 
.局部变量 项目数值, 文本型, , , 

赋值 (项目数值, 到文本 (.取项目数值 (.现行选中项)))
赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select * from yfk where id like '”, 相加 (项目数值, “'”))))
.判断开始 (不等于 (等于 (.内容, 到文本 (主窗口.读 (., 记录集句柄, “yfmm”))), 真))
    信息框 (“您的登陆密码有误！！”, 48, “错误提示”)
    返回 ()
.默认
    主窗口.关闭记录集 (., 记录集句柄)
    赋值 (登陆窗口., 假)
    _到期图书提醒_被选择 ()
    赋值 (主窗口., 真)
    销毁 ()
    
.判断结束


.子程序 _修改密码按钮_被单击, 空白型, , 
载入 (修改密码窗口, , 真)


.子程序 _退出按钮_被单击, 空白型, , 
结束 ()


.子程序 _组合框1_失去焦点, 空白型, , 


.子程序 _登陆密码编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _确定按钮_被单击 ()
.如果真结束
' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _登陆窗口_可否被关闭, 逻辑型, , 
结束 ()


.窗口程序集 _启动窗口程序集, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
 ' --========  易语言资源网  (www.wodesoft.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.wodesoft.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.wodesoft.com  ================--

赋值 (配置文件名, 相加 (取运行目录 (), “\配置.ini”))
赋值 (., 真)
赋值 (主窗口., 假)
载入 (主窗口, , 假)
延时 (1500)
销毁 ()
载入 (登陆窗口, , 真)


.窗口程序集 修改密码窗口程序集, , , 

.子程序 _修改密码窗口_创建完毕, 空白型, , 

获取焦点 ()
赋值 (记录集句柄, 主窗口.查询 (., “select * from yfk where yfm='超级管理员'”))


.子程序 _确定按钮_被单击, 空白型, , 
.判断开始 (不等于 (.内容, 主窗口.读 (., 记录集句柄, “yfmm”)))
    信息框 (“超级管理员密码有误！无法进行密码修改！”, 48, “出错提示”)
    获取焦点 ()
    返回 ()
.判断 (不等于 (.内容, .内容))
    信息框 (“新密码再次确认有误！请重新输入！”, 48, “出错提示”)
    连续赋值 (“”, .内容, .内容, .内容)
    获取焦点 ()
    返回 ()
.判断 (等于 (主窗口.执行 (., 相加 (“Update yfk set yfmm='”, .内容, “' where yfm='”, .内容, “'”), ), 真))
    信息框 (“修改密码成功！请牢记！”, 64, “提示信息”)
    _退出按钮_被单击 ()
    载入 (_启动窗口, , 真)
    ' 本源码来自易语言资源网(www.wodesoft.com)
.默认
    
.判断结束


.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()


.窗口程序集 提醒天数设置窗口程序集, , , 

.子程序 _提醒天数设置窗口_创建完毕, 空白型, , 
.局部变量 天数, 文本型, , , 


赋值 (天数, 读配置项 (配置文件名, “系统”, “提醒天数”, “10”))
赋值 (.标题, 天数)
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _按钮1_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (“设置提醒天不得为空”, 48, “提示信息”)
.如果真结束
.如果真 (等于 (写配置项 (配置文件名, “系统”, “提醒天数”, .内容), 真))
    信息框 (“更改提醒天数成功！”, 64, “提示信息”)
    _提醒天数设置窗口_创建完毕 ()
    赋值 (.内容, “”)
    
.如果真结束


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()


.子程序 _更改编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _按钮1_被单击 ()
    ' 本源码来自易语言资源网(www.wodesoft.com)
.如果真结束


.窗口程序集 窗口程序集1, , , 

.子程序 _帮助窗口_创建完毕, 空白型, , 



.窗口程序集 窗口程序集2, , , 

.子程序 _关于窗口_创建完毕, 空白型, , 


.窗口程序集 窗口程序集3, , , 

.子程序 _查找书_创建完毕, 空白型, , 


.子程序 _查找_被单击, 空白型, , 
.判断开始 (等于 (.现行选中项, 1))
    赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select id,tsid,sm,smpy,rkrq,l,y,s,lx,dj,zz,wz,bz,cjh from tsk  where smpy like  '%”, .内容, “%'  order by tsid”)))
    查找填充 ()
.判断 (等于 (.现行选中项, 2))
    赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select id,tsid,sm,smpy,rkrq,l,y,s,lx,dj,zz,wz,bz,cjh from tsk  where  sm like  '%”, .内容, “%'  order by tsid”)))
    查找填充 ()
.默认
    赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select id,tsid,sm,smpy,rkrq,l,y,s,lx,dj,zz,wz,bz,cjh   from tsk  where  tsid like  '%”, .内容, “%'  order by tsid”)))
    查找填充 ()
    ' 本源码来自易语言资源网(www.wodesoft.com)
.判断结束


.子程序 查找填充, 空白型, , 
.局部变量 插入位置, 整数型, , , 

主窗口.全部删除 (.)
主窗口.到首记录 (., 记录集句柄)
赋值 (插入位置, 0)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录集句柄), 假))
    主窗口.插入表项 (., 插入位置, , , , , 主窗口.读 (., 记录集句柄, “id”))
    主窗口.置标题 (., 插入位置, 0, 到文本 (相加 (插入位置, 1)))
    主窗口.置标题 (., 插入位置, 1, 到文本 (主窗口.读 (., 记录集句柄, “tsid”)))
    主窗口.置标题 (., 插入位置, 2, 到文本 (主窗口.读 (., 记录集句柄, “sm”)))
    主窗口.置标题 (., 插入位置, 3, 到文本 (主窗口.读 (., 记录集句柄, “smpy”)))
    主窗口.置标题 (., 插入位置, 4, 到文本 (主窗口.读 (., 记录集句柄, “rkrq”)))
    主窗口.置标题 (., 插入位置, 5, 相加 (到文本 (主窗口.读 (., 记录集句柄, “l”)), “-”, 到文本 (主窗口.读 (., 记录集句柄, “y”)), “-”, 到文本 (主窗口.读 (., 记录集句柄, “s”)), “期”))
    主窗口.置标题 (., 插入位置, 6, 到文本 (主窗口.读 (., 记录集句柄, “dj”)))
    主窗口.置标题 (., 插入位置, 7, 到文本 (主窗口.读 (., 记录集句柄, “zz”)))
    主窗口.置标题 (., 插入位置, 8, 到文本 (主窗口.读 (., 记录集句柄, “lx”)))
    主窗口.置标题 (., 插入位置, 9, 到文本 (主窗口.读 (., 记录集句柄, “wz”)))
    主窗口.置标题 (., 插入位置, 10, 到文本 (主窗口.读 (., 记录集句柄, “cjh”)))
    主窗口.置标题 (., 插入位置, 11, 到文本 (主窗口.读 (., 记录集句柄, “bz”)))
    主窗口.到后一记录 (., 记录集句柄)
    赋值 (插入位置, 相加 (插入位置, 1))
.判断循环尾 ()
主窗口.关闭记录集 (., 记录集句柄)





.窗口程序集 窗口程序集4, , , 

.子程序 _查找_被单击, 空白型, , 
.判断开始 (等于 (.现行选中项, 0))
    赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select * from jsr where lbzj like  '%”, .内容, “%'  order by lbzj”)))
    查找人.查找镇充 ()
.判断 (等于 (.现行选中项, 1))
    赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select * from jsr where xm like  '%”, .内容, “%'  order by lbzj”)))
    查找人.查找镇充 ()
.默认
    赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select * from jsr where xmpy like  '%”, .内容, “%'  order by lbzj”)))
    查找人.查找镇充 ()
.判断结束
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 查找镇充, 空白型, , 
.局部变量 插入位置, 整数型, , , 

主窗口.全部删除 (.)
主窗口.到首记录 (., 记录集句柄)
赋值 (插入位置, 0)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录集句柄), 假))
    主窗口.插入表项 (., 插入位置, , , , , 主窗口.读 (., 记录集句柄, “id”))
    主窗口.置标题 (., 插入位置, 0, 到文本 (相加 (插入位置, 1)))
    主窗口.置标题 (., 插入位置, 1, 到文本 (主窗口.读 (., 记录集句柄, “lbzj”)))
    主窗口.置标题 (., 插入位置, 2, 到文本 (主窗口.读 (., 记录集句柄, “xm”)))
    主窗口.置标题 (., 插入位置, 3, 到文本 (主窗口.读 (., 记录集句柄, “xb”)))
    主窗口.置标题 (., 插入位置, 4, 到文本 (主窗口.读 (., 记录集句柄, “xmpy”)))
    主窗口.置标题 (., 插入位置, 5, 到文本 (主窗口.读 (., 记录集句柄, “gzq”)))
    主窗口.置标题 (., 插入位置, 6, 到文本 (主窗口.读 (., 记录集句柄, “bz”)))
    主窗口.置标题 (., 插入位置, 7, 到文本 (主窗口.读 (., 记录集句柄, “glr”)))
    主窗口.置标题 (., 插入位置, 8, 到文本 (主窗口.读 (., 记录集句柄, “bzdh”)))
    主窗口.置标题 (., 插入位置, 9, 到文本 (主窗口.读 (., 记录集句柄, “grdh”)))
    主窗口.置标题 (., 插入位置, 10, 到文本 (主窗口.读 (., 记录集句柄, “jscs”)))
    主窗口.置标题 (., 插入位置, 11, 到文本 (主窗口.读 (., 记录集句柄, “whbs”)))
    主窗口.到后一记录 (., 记录集句柄)
    赋值 (插入位置, 相加 (插入位置, 1))
.判断循环尾 ()
主窗口.关闭记录集 (., 记录集句柄)
' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _查找人_创建完毕, 空白型, , 


.窗口程序集 窗口程序集5, , , 

.子程序 _查找借还_创建完毕, 空白型, , 


.子程序 _查找_被单击, 空白型, , 
.判断开始 (等于 (.现行选中项, 0))
    赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select * from jss where xm  like  '%”, .内容, “%'  order by jsrq ”)))
    查找借还.查找镇充 ()
.默认
    赋值 (记录集句柄, 主窗口.查询 (., 相加 (“select * from jss where sm like  '%”, .内容, “%'  order by jsrq”)))
    查找借还.查找镇充 ()
    ' 本源码来自易语言资源网(www.wodesoft.com)
.判断结束


.子程序 查找镇充, 空白型, , 
.局部变量 插入位置, 整数型, , , 

主窗口.全部删除 (.)
主窗口.到首记录 (., 记录集句柄)
赋值 (插入位置, 0)
.判断循环首 (等于 (主窗口.尾记录后 (., 记录集句柄), 假))
    主窗口.插入表项 (., 插入位置, , , , , 主窗口.读 (., 记录集句柄, “id”))
    主窗口.置标题 (., 插入位置, 0, 到文本 (相加 (插入位置, 1)))
    主窗口.置标题 (., 插入位置, 1, 到文本 (主窗口.读 (., 记录集句柄, “lbzj”)))
    主窗口.置标题 (., 插入位置, 2, 到文本 (主窗口.读 (., 记录集句柄, “xm”)))
    主窗口.置标题 (., 插入位置, 3, 到文本 (主窗口.读 (., 记录集句柄, “smid”)))
    主窗口.置标题 (., 插入位置, 4, 到文本 (主窗口.读 (., 记录集句柄, “sm”)))
    主窗口.置标题 (., 插入位置, 5, 到文本 (主窗口.读 (., 记录集句柄, “zj”)))
    主窗口.置标题 (., 插入位置, 6, 到文本 (主窗口.读 (., 记录集句柄, “yj”)))
    主窗口.置标题 (., 插入位置, 7, 到文本 (主窗口.读 (., 记录集句柄, “jsrp”)))
    主窗口.置标题 (., 插入位置, 8, 到文本 (主窗口.读 (., 记录集句柄, “hf”)))
    主窗口.置标题 (., 插入位置, 9, 到文本 (主窗口.读 (., 记录集句柄, “bz”)))
    主窗口.到后一记录 (., 记录集句柄)
    赋值 (插入位置, 相加 (插入位置, 1))
.判断循环尾 ()
主窗口.关闭记录集 (., 记录集句柄)


.窗口程序集 窗口程序集6, , , 

.子程序 _导出提示_创建完毕, 空白型, , 
 ' 置父窗口 (主窗口)



 ' 不属于任何一个程序集、类模块的函数：
