 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 538
    高度 = 394
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假



.图片 资源_临时数据库, " ' 已保存到：D:\易语言学习\Data\导出超级表格数据到Excel.e\资源_临时数据库", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' eExcel2000 F86EC5989E044d42BC98C692C0B54727 2 0 EXCEL2000支持库
 ' eDB 46E94341933A462383A4DE26B146322C 2 1 数据库操作支持库




.全局变量 全局_数据库连接临时, 未知类型0x40001, , , 

.程序集 程序集_公共, , , 

.子程序 公共_导出超级列表框到Execl, 空白型, , 
.参数 参数_超级列表框, 超级列表框, , 
.参数 参数_通用对话框, 通用对话框, , 
.参数 参数_Excel程序, 未知类型0x30001, 可空, 
.参数 参数_Excel工作簿, 未知类型0x30002, 可空, 
.参数 参数_工作表名, 文本型, 可空, 

.局部变量 局部_列数, 整数型, , , 
.局部变量 局部_行数, 整数型, , , 
.局部变量 局部_临时文件, 文本型, , , 
.局部变量 局部_字段名, 文本型, , , 
.局部变量 局部_字段类型, 文本型, , , 
.局部变量 局部_记录内容, 文本型, , , 
.局部变量 局部_Execl文件, 文本型, , , 
.局部变量 局部_sql, 文本型, , , 
.局部变量 局部_数据库路径, 文本型, , , 
.局部变量 局部_数据库名称, 文本型, , , 
.局部变量 局部_数据库密码, 文本型, , , 

.如果真 (等于 (参数_超级列表框.取表项数 (), 0))
    信息框 (“当前列表没有可导出的数据。”, #信息图标, “温馨提示”)
    返回 ()
.如果真结束

赋值 (参数_通用对话框.类型, 1)
赋值 (参数_通用对话框.过滤器, “Excel文件(*.xls)|*.xls”)
赋值 (参数_通用对话框.默认文件后缀, “.xls”)

.如果真 (取反 (文件是否存在 (相加 (取运行目录 (), “\Excel”))))
    创建目录 (相加 (取运行目录 (), “\Excel”))
.如果真结束
赋值 (参数_通用对话框.初始目录, 相加 (取运行目录 (), “\Excel”))
 ' 本源码来自易语言资源网(www.5A5X.com)
.如果真 (等于 (参数_通用对话框.打开 (), 假))
    返回 ()
.如果真结束

赋值 (局部_Execl文件, 参数_通用对话框.文件名)
.如果真 (文件是否存在 (局部_Execl文件))
    删除文件 (局部_Execl文件)
.如果真结束

.计次循环首 (参数_超级列表框.取列数 (), 局部_列数)
    赋值 (局部_字段名, 相加 (局部_字段名, “[”, 到文本 (参数_超级列表框.取列标题 (相减 (局部_列数, 1))), “],”))
    赋值 (局部_字段类型, 相加 (局部_字段类型, “[”, 到文本 (参数_超级列表框.取列标题 (相减 (局部_列数, 1))), “] varchar,”))
.计次循环尾 ()

赋值 (局部_字段名, 取文本左边 (局部_字段名, 相减 (取文本长度 (局部_字段名), 1)))
赋值 (局部_字段类型, 取文本左边 (局部_字段类型, 相减 (取文本长度 (局部_字段类型), 1)))
赋值 (局部_数据库路径, 相加 (取运行目录 (), “\Data\”))
赋值 (局部_数据库名称, “Data.dat”)
赋值 (局部_数据库密码, “”)

.如果真 (取反 (文件是否存在 (相加 (局部_数据库路径, 局部_数据库名称))))
     ' 复制文件 (取运行目录 () ＋ “\Temp\Data.tmp”, 局部_数据库路径 ＋ 局部_数据库名称)
    写到文件 (相加 (局部_数据库路径, 局部_数据库名称), #资源_临时数据库)
.如果真结束

.如果真 (等于 (全局_数据库连接临时., 假))
    .如果真 (取反 (公共_连接数据库 (全局_数据库连接临时, 局部_数据库路径, 局部_数据库名称, 局部_数据库密码)))
        信息框 (“连接临时数据库文件失败！”, #警告图标, “失败”)
        返回 ()
    .如果真结束
    
.如果真结束

全局_数据库连接临时.未知支持库函数_9 ()
全局_数据库连接临时.未知支持库函数_4 (“drop table Temp”)

赋值 (局部_sql, 相加 (“create table Temp (”, 局部_字段类型, “)”))
.如果真 (取反 (全局_数据库连接临时.未知支持库函数_4 (局部_sql)))
    全局_数据库连接临时.未知支持库函数_11 ()
    信息框 (“创建数据库表失败！”, #错误图标, “失败”)
    返回 ()
.如果真结束

.计次循环首 (参数_超级列表框.取表项数 (), 局部_列数)
    赋值 (局部_记录内容, “”)
    .计次循环首 (参数_超级列表框.取列数 (), 局部_行数)
        赋值 (局部_记录内容, 相加 (局部_记录内容, “'”, 到文本 (参数_超级列表框.取标题 (相减 (局部_列数, 1), 相减 (局部_行数, 1))), “',”))
    .计次循环尾 ()
    
    赋值 (局部_记录内容, 取文本左边 (局部_记录内容, 相减 (取文本长度 (局部_记录内容), 1)))
    赋值 (局部_sql, 相加 (“insert into Temp (”, 局部_字段名, “) values (”, 局部_记录内容, “)”))
    
    .如果真 (取反 (全局_数据库连接临时.未知支持库函数_4 (局部_sql)))
        全局_数据库连接临时.未知支持库函数_11 ()
        信息框 (“导入到临时数据表数据失败！”, #警告图标, “失败”)
        返回 ()
    .如果真结束
     ' 本源码来自易语言资源网(www.5A5X.com)
.计次循环尾 ()

赋值 (局部_sql, 相加 (“select * into [Excel 8.0;database=”, 局部_Execl文件, “].”, 选择 (是否为空 (参数_工作表名), “[Sheet1]”, 参数_工作表名), “ from Temp”))

.如果真 (取反 (全局_数据库连接临时.未知支持库函数_4 (局部_sql)))
    全局_数据库连接临时.未知支持库函数_11 ()
    信息框 (“导出Excel文件失败！”, #错误图标, “失败”)
    返回 ()
.如果真结束

全局_数据库连接临时.未知支持库函数_10 ()
全局_数据库连接临时.未知支持库函数_3 ()
.如果真 (并且 (取反 (是否为空 (参数_Excel程序)), 取反 (是否为空 (参数_Excel工作簿))))
    参数_Excel程序.未知支持库函数_0 ()
    赋值 (参数_Excel程序., 真)
    参数_Excel工作簿.未知支持库函数_6 (参数_Excel程序)
    参数_Excel工作簿.未知支持库函数_15 ()
    参数_Excel工作簿.未知支持库函数_14 (局部_Execl文件)
    参数_Excel工作簿.未知支持库函数_20 ()
.如果真结束
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 公共_状态条置文本, 空白型, , 
.参数 参数_状态条, 状态条, , 
.参数 参数_栏目索引, 整数型, , 
.参数 参数_显示内容, 文本型, , 

参数_状态条.置文本 (参数_栏目索引, 参数_显示内容)

.子程序 公共_连接数据库, 逻辑型, , 连接数据库
.参数 参数_数据库连接, 未知类型0x40001, , 
.参数 参数_数据库路径, 文本型, , 
.参数 参数_数据库名称, 文本型, , 
.参数 参数_数据库密码, 文本型, , 

返回 (参数_数据库连接.未知支持库函数_1 (相加 (参数_数据库路径, 参数_数据库名称), 参数_数据库密码))

.子程序 公共_刷新超级列表框列宽, 空白型, , 
.参数 参数_超级列表框, 超级列表框, , 

.局部变量 局部_计次, 整数型, , , 

处理事件 ()
.计次循环首 (参数_超级列表框.取列数 (), 局部_计次)
    参数_超级列表框.置列宽 (相减 (局部_计次, 1), -2)
.计次循环尾 ()

.窗口程序集 窗口程序集_启动, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 局部_行数, 整数型, , , 
.局部变量 局部_列数, 整数型, , , 
.局部变量 局部_表项索引, 整数型, , , 
.局部变量 局部_列索引, 整数型, , , 

 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

.如果真 (取反 (文件是否存在 (相加 (取运行目录 (), “\Data”))))
    创建目录 (相加 (取运行目录 (), “\Data”))
.如果真结束

赋值 (全局_数据库连接临时, )

置随机数种子 ()
.计次循环首 (30, 局部_列数)
    .插入列 (到文本 (局部_列数), , , , )
.计次循环尾 ()
 ' 本源码来自易语言资源网(www.5A5X.com)
.计次循环首 (200, 局部_行数)
    赋值 (局部_表项索引, .插入表项 ())
    .计次循环首 (取列数 (), 局部_列索引)
        局部_表项索引.置标题 (相减 (局部_列索引, 1), 到文本 (取随机数 (1000, 2000)))
    .计次循环尾 ()
.计次循环尾 ()
公共_刷新超级列表框列宽 ()
公共_状态条置文本 (0, 相加 (“yeasayer software 共有 ”, 到文本 (取表项数 ()), “ 条记录”))
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 __启动窗口_尺寸被改变, 空白型, , 
10.移动 (相减 (取用户区宽度 (), 相乘 (.角度, 2)), 相减 (取用户区高度 (), .加粗, ., 10))
0.置宽度 (.)

.子程序 _按钮_导出数据_被单击, 空白型, , 
公共_导出超级列表框到Execl (“感觉还是很不错的”)


 ' 不属于任何一个程序集、类模块的函数：
