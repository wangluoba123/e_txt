 ' 文件类型：Windows窗口程序

 ' 程序名称：世宝企管系列---世宝财务
 ' 程序描述：http://www.shibao.net
 ' 程序作者：天津市世宝计算机技术中心
 ' 邮政编码：300011
 ' 联系地址：天津市河东区新兆路美福园15-3-101
 ' 联系电话：022-81668229  26546628
 ' 传真号码：022-26546628
 ' 电子信箱：27038580@qq.com
 ' 主页地址：www.shibao.net
 ' 版权声明：世宝企管系列---世宝财务V1.0
 ' 版本号：1.0
 ' 创建号：0.0

窗口 工作窗口
    左边 = 50
    顶边 = 50
    宽度 = 629
    高度 = 464
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 0 '  0x0
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 真
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 真
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 管理套账窗口
    左边 = 50
    顶边 = 50
    宽度 = 363
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “选择套账”
    帮助文件名 = “”

窗口 新建套账窗口
    左边 = 50
    顶边 = 50
    宽度 = 363
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “新建套账”
    帮助文件名 = “”

窗口 编制凭证窗口
    左边 = 50
    顶边 = 50
    宽度 = 634
    高度 = 378
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 真
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “凭证窗口”
    帮助文件名 = “”

窗口 查阅凭证窗口
    左边 = 50
    顶边 = 50
    宽度 = 597
    高度 = 456
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “查阅凭证”
    帮助文件名 = “”

窗口 登陆窗口
    左边 = 50
    顶边 = 50
    宽度 = 256
    高度 = 170
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “登陆窗口”
    帮助文件名 = “”

窗口 购买说明窗口
    左边 = 50
    顶边 = 50
    宽度 = 381
    高度 = 358
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “购买说明”
    帮助文件名 = “”

窗口 提示窗口
    左边 = 50
    顶边 = 50
    宽度 = 481
    高度 = 109
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 询问是否窗口
    左边 = 50
    顶边 = 50
    宽度 = 481
    高度 = 111
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 会计科目窗口
    左边 = 50
    顶边 = 50
    宽度 = 449
    高度 = 383
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “会计科目窗口”
    帮助文件名 = “”

窗口 科目设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 284
    高度 = 145
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “科目设置窗口”
    帮助文件名 = “”

窗口 账务初始化窗口
    左边 = 0
    顶边 = 0
    宽度 = 574
    高度 = 456
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “账务初始化窗口”
    帮助文件名 = “”

窗口 日期窗口
    左边 = 50
    顶边 = 50
    宽度 = 214
    高度 = 91
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 摘要窗口
    左边 = 50
    顶边 = 50
    宽度 = 369
    高度 = 443
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 真
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “摘要窗口”
    帮助文件名 = “”

窗口 金额输入窗口
    左边 = 50
    顶边 = 50
    宽度 = 190
    高度 = 91
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 张数输入窗口
    左边 = 50
    顶边 = 50
    宽度 = 168
    高度 = 90
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 日期输入窗口
    左边 = 50
    顶边 = 50
    宽度 = 124
    高度 = 77
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 月编号窗口
    左边 = 50
    顶边 = 50
    宽度 = 302
    高度 = 90
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 登账结账窗口
    左边 = 50
    顶边 = 50
    宽度 = 517
    高度 = 424
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “凭证登账、结转损益、期末结账窗口”
    帮助文件名 = “”

窗口 账页窗口
    左边 = 50
    顶边 = 50
    宽度 = 620
    高度 = 460
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “明细账窗口”
    帮助文件名 = “”

窗口 结转损益设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 471
    高度 = 214
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “结转损益设置窗口”
    帮助文件名 = “”

窗口 用户列表窗口
    左边 = 50
    顶边 = 50
    宽度 = 124
    高度 = 192
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “用户列表窗口”
    帮助文件名 = “”

窗口 密码修改窗口
    左边 = 50
    顶边 = 50
    宽度 = 200
    高度 = 167
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “密码修改窗口”
    帮助文件名 = “”

窗口 新建用户窗口
    左边 = 50
    顶边 = 50
    宽度 = 193
    高度 = 175
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “新建用户窗口”
    帮助文件名 = “”

窗口 报表窗口
    左边 = 50
    顶边 = 50
    宽度 = 151
    高度 = 112
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “报表窗口”
    帮助文件名 = “”

窗口 出纳窗口
    左边 = 50
    顶边 = 50
    宽度 = 323
    高度 = 191
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “出纳窗口”
    帮助文件名 = “”

窗口 收付科目窗口
    左边 = 50
    顶边 = 50
    宽度 = 160
    高度 = 147
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 日记账窗口
    左边 = 50
    顶边 = 50
    宽度 = 620
    高度 = 457
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “日记账”
    帮助文件名 = “”

窗口 备份与恢复窗口
    左边 = 50
    顶边 = 50
    宽度 = 377
    高度 = 76
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 12632256 '  0xC0C0C0
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “备份与恢复窗口”
    帮助文件名 = “”

窗口 关于世宝
    左边 = 50
    顶边 = 50
    宽度 = 381
    高度 = 327
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于世宝”
    帮助文件名 = “”



.图片 世宝财务图, " ' 已保存到：D:\易语言学习\Data\世宝财务.e\世宝财务图", , 
.常量 标题字, "“世宝企管系列 [世宝财务 V1.0]”", , 
.常量 库密码, "“200407151752”", , 
.常量 信息库, "“套账目录\信息库”", , 
.常量 数据目录, "“套账目录\”", , 
.常量 基本信息, "“基本信息”", , 
.常量 用户, "“用户”", , 
.常量 会计科目, "“会计科目”", , 
.常量 开始等待时间, "3", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 7 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 1 扩展界面支持库一
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库
 ' eExcel2000 F86EC5989E044d42BC98C692C0B54727 1 0 EXCEL2000支持库
 ' eCompress 7B68736E818E41c5A28B0AE4D43C128C 1 0 压缩解压支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二




.全局变量 询问是否窗口选择值, 文本型, , , 
.全局变量 是否付费, 逻辑型, , , 
.全局变量 当前权限, 字节型, , , 
.全局变量 当前用户, 文本型, , , 
.全局变量 当前套账, 文本型, , , 
.全局变量 当前单位, 文本型, , , 
.全局变量 注册号, 长整数型, , , 
.全局变量 钥匙号, 长整数型, , , 
.全局变量 现有套账, 列表框, , , 
.全局变量 提示信息, 文本型, , , 
.全局变量 刚选套账, 文本型, , , 
.全局变量 本账库密码, 文本型, , , 
.全局变量 会计期间, 日期时间型, , , 
.全局变量 登陆窗口被登陆, 逻辑型, , , 
.全局变量 会计科目窗口科目树型框当前选定文本, 文本型, , , 
.全局变量 会计科目窗口科目树型框当前选定文本的上级科目名, 文本型, , , 
.全局变量 会计科目窗口科目树型框当前选定科目级别, 整数型, , , 
.全局变量 匿名全局变量_2072, 空白型, , , 
.全局变量 科目设置窗口状态变量, 文本型, , , 
.全局变量 日期窗口选择值, 日期时间型, , , 
.全局变量 摘要树型框当前选定文本, 文本型, , , 
.全局变量 摘要树型框当前选定文本的所在分类, 文本型, , , 
.全局变量 匿名全局变量_1287, 空白型, , , 
.全局变量 摘要窗口是否被载入, 逻辑型, , , 
.全局变量 张数输入窗口值, 长整数型, , , 
.全局变量 日期输入窗口值, 整数型, , , 
.全局变量 金额输入窗口值, 双精度小数型, , , 
.全局变量 匿名全局变量_1402, 空白型, , , 
.全局变量 当前凭证日期, 日期时间型, , , 
.全局变量 当前凭证编号, 整数型, , , 
.全局变量 当前凭证小编号, 整数型, , , 
.全局变量 当前凭证小编号总数, 整数型, , , 
.全局变量 当前凭证借方金额1, 双精度小数型, , , 
.全局变量 当前凭证借方金额2, 双精度小数型, , , 
.全局变量 当前凭证借方金额3, 双精度小数型, , , 
.全局变量 当前凭证借方金额4, 双精度小数型, , , 
.全局变量 当前凭证借方合计, 双精度小数型, , , 
.全局变量 当前凭证贷方金额1, 双精度小数型, , , 
.全局变量 当前凭证贷方金额2, 双精度小数型, , , 
.全局变量 当前凭证贷方金额3, 双精度小数型, , , 
.全局变量 当前凭证贷方金额4, 双精度小数型, , , 
.全局变量 当前凭证贷方合计, 双精度小数型, , , 
.全局变量 当前凭证附件数, 整数型, , , 
.全局变量 当前凭证总编号, 长整数型, , , 
.全局变量 当前凭证编制, 文本型, , , 
.全局变量 当前凭证摘要4, 文本型, , , 
.全局变量 当前凭证摘要3, 文本型, , , 
.全局变量 当前凭证摘要2, 文本型, , , 
.全局变量 当前凭证摘要1, 文本型, , , 
.全局变量 当前凭证科目4, 文本型, , , 
.全局变量 当前凭证科目3, 文本型, , , 
.全局变量 当前凭证科目2, 文本型, , , 
.全局变量 当前凭证科目1, 文本型, , , 
.全局变量 当前凭证登账, 文本型, , , 
.全局变量 当前凭证审核, 文本型, , , 
.全局变量 当前凭证打印日期, 日期时间型, , , 
.全局变量 匿名全局变量_1825, 空白型, , , 
.全局变量 凭证总数, 长整数型, , , 
.全局变量 摘要窗口是否需要传递, 逻辑型, , , 
.全局变量 科目窗口是否需要传递, 逻辑型, , , 
.全局变量 本月凭证编号有, 长整数型, , , 
.全局变量 匿名全局变量_1822, 空白型, , , 
.全局变量 科目树型框当前类型文本, 文本型, , , 
.全局变量 科目树型框当前类型编号, 整数型, , , 
.全局变量 匿名全局变量_2152, 空白型, , , 
.全局变量 当前账借方余额, 双精度小数型, , , 
.全局变量 当前账贷方余额, 双精度小数型, , , 
.全局变量 当前账余额方向, 文本型, , , 
.全局变量 当前账余额, 双精度小数型, , , 
.全局变量 匿名全局变量_2276, 空白型, , , 
.全局变量 是否到对应呀, 逻辑型, , , 
.全局变量 传递来的日期, 日期时间型, , , 
.全局变量 传递来的月编号, 文本型, , , 
.全局变量 匿名全局变量_2594, 空白型, , , 
.全局变量 用户列表窗口返回文本, 文本型, , , 
.全局变量 匿名全局变量_2664, 空白型, , , 
.全局变量 传递来的小编号, 文本型, , , 
.全局变量 匿名全局变量_2859, 空白型, , , 
.全局变量 传递来的编制凭证种类, 文本型, , , 
.全局变量 看吗账, 文本型, , , 
.全局变量 匿名全局变量_3276, 空白型, , , 
.全局变量 删除套账按钮被点, 逻辑型, , , 
.全局变量 是否打印, 逻辑型, , , 

.程序集 主程序, , , 

.子程序 _启动子程序, 整数型, , 本子程序在程序启动后最先执行
创建目录 (相加 (取运行目录 (), “\”, #数据目录))
算号 ()
.如果 (等于 (是否付费, 假))
    载入 (购买说明窗口, , 真)
.否则
    
.如果结束
载入 (工作窗口, , 假)
是否过期 ()
载入 (管理套账窗口, 工作窗口, 真)
返回 (0) ' 可以根据您的需要返回任意数值

.窗口程序集 工作窗口程序集, , , 

.子程序 _工作窗口_创建完毕, 空白型, , 
赋值 (工作窗口.标题, #标题字)

.子程序 _新建套账_被选择, 空白型, , 
载入 (新建套账窗口, 工作窗口, 真)

.子程序 _打开套账_被选择, 空白型, , 
_关闭套账_被选择 ()
载入 (管理套账窗口, 工作窗口, 真)

.子程序 _管理套账_被选择, 空白型, , 
_打开套账_被选择 ()

.子程序 _退出_被选择, 空白型, , 
销毁 ()

.子程序 _查阅报表_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
载入 (购买说明窗口, , 真)

.子程序 _编辑报表_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
赋值 (.禁止, 真)
.如果 (是否已创建 (报表窗口))
    赋值 (提示信息, “Excel报表已导出、请查看！”)
    载入 (提示窗口, , 真)
.否则
    载入 (报表窗口, , 假)
.如果结束
赋值 (.禁止, 假)

.子程序 _关闭套账_被选择, 空白型, , 
赋值 (本账库密码, “”)
赋值 (当前单位, “”)
赋值 (当前权限, 0)
赋值 (当前用户, “”)
赋值 (刚选套账, “”)
赋值 (登陆窗口被登陆, 假)
赋值 (工作窗口.标题, 相加 (#标题字, “    尚未登陆、请选择套帐！”))
返回 ()

.子程序 _账务初始化_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
赋值 (提示信息, “套账启用后不能再更改初始化数据！”)
载入 (提示窗口, , 真)

.子程序 _科目管理_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
载入 (会计科目窗口, , 真)

.子程序 _编制凭证_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
赋值 (.禁止, 真)
载入 (编制凭证窗口, , 真)
赋值 (.禁止, 假)

.子程序 _审核凭证_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
赋值 (.禁止, 真)
_编制凭证_被选择 ()
赋值 (.禁止, 假)

.子程序 _凭证登账_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
赋值 (.禁止, 真)
载入 (登账结账窗口, , 真)
赋值 (.禁止, 假)

.子程序 _明细分类账_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
赋值 (.禁止, 真)
载入 (账页窗口, , 真)
赋值 (.禁止, 假)

.子程序 _期末结账_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
赋值 (.禁止, 真)
载入 (登账结账窗口, , 真)
赋值 (.禁止, 假)

.子程序 _查阅凭证_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
赋值 (.禁止, 真)
载入 (查阅凭证窗口, , 真)
赋值 (.禁止, 假)

.子程序 _结转损益_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
赋值 (.禁止, 真)
载入 (登账结账窗口, , 真)
赋值 (.禁止, 假)

.子程序 _修改密码_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
载入 (密码修改窗口, , 真)

.子程序 _收现按钮_被单击, 空白型, , 
_日记账_被选择 ()

.子程序 _常用摘要_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
载入 (摘要窗口, , 真)

.子程序 _撤销结账_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证库.edb”), , , , , 本账库密码, )
到首记录 ()
.如果真 (查找 (并且 (等于 (取年份 (读 (“日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“日期”)), 取月份 (会计期间)), 不等于 (读 (“登账”), “”))))
    赋值 (提示信息, “撤销结账前，应先撤销当前月登账！”)
    载入 (提示窗口, , 真)
    关闭 ()
    返回 ()
.如果真结束
关闭 ()
赋值 (提示信息, “是否进行撤销结账操作？”)
载入 (询问是否窗口, , 真)
.如果真 (等于 (询问是否窗口选择值, “不是”))
    返回 ()
.如果真结束

 ' ----
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”), , , , , 本账库密码, )
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (查找 (并且 (等于 (取年份 (读 (“凭证日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“凭证日期”)), 取月份 (会计期间)), 等于 (读 (“摘要”), “期初余额”))))
        删除 ()
    .如果真结束
    跳过 ()
.判断循环尾 ()
彻底删除 ()
关闭 ()

 ' ----------------------------------------------------------------------------------------------
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, #基本信息), , , , , #库密码, )
到首记录 ()
.如果 (等于 (取月份 (会计期间), 1))
    写 (“会计期间”, 到时间 (相加 (到文本 (相加 (取年份 (会计期间), 1)), “年”, “12月1日”)))
.否则
    写 (“会计期间”, 到时间 (相加 (到文本 (取年份 (会计期间)), “年”, 到文本 (相减 (取月份 (会计期间), 1)), “月”, “1日”)))
.如果结束
赋值 (会计期间, 读 (“会计期间”))
赋值 (工作窗口.标题, 相加 (#标题字, “  会计期间：”, 到文本 (取年份 (会计期间)), “年”, 到文本 (取月份 (会计期间)), “月”, “   用户：”, 当前用户, “  ”, 当前单位))
关闭 ()
 ' ----
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”), , , , , 本账库密码, )
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (查找 (并且 (等于 (取年份 (读 (“凭证日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“凭证日期”)), 取月份 (会计期间)), 或者 (等于 (读 (“摘要”), “本月合计”), 等于 (读 (“摘要”), “本年累计”)))))
        删除 ()
    .如果真结束
    跳过 ()
.判断循环尾 ()
彻底删除 ()
关闭 ()

打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库.edb”), , , , , 本账库密码, )
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (查找 (并且 (等于 (取年份 (读 (“凭证日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“凭证日期”)), 取月份 (会计期间)), 不等于 (读 (“摘要”), “期初余额”))))
        删除 ()
    .如果真结束
    跳过 ()
.判断循环尾 ()
彻底删除 ()
关闭 ()
 ' ----
赋值 (提示信息, 相加 (“结账已撤销，当前会计期间：”, 到文本 (取年份 (会计期间)), “年”, 到文本 (取月份 (会计期间)), “月”))
载入 (提示窗口, , 真)

.子程序 登陆提示, 空白型, , 
赋值 (提示信息, “请先选择套账并登陆！”)
载入 (提示窗口, , 真)

.子程序 _撤销审核_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
载入 (编制凭证窗口, , 真)

.子程序 _撤销登账_被选择, 空白型, , 
.局部变量 将减借方, 双精度小数型, , , 
.局部变量 将减贷方, 双精度小数型, , , 
.局部变量 哪个科目, 文本型, , , 

.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
赋值 (提示信息, “是否进行撤销登账操作？”)
载入 (询问是否窗口, , 真)
.如果真 (等于 (询问是否窗口选择值, “不是”))
    返回 ()
.如果真结束
 ' ----
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”), , , , , 本账库密码, )
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库辅1.edb”), , , , , 本账库密码, )
置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”))
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (查找 (并且 (等于 (取年份 (读 (“凭证日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“凭证日期”)), 取月份 (会计期间)), 不等于 (读 (“摘要”), “期初余额”))))
        赋值 (将减借方, 读 (“借方”))
        赋值 (将减贷方, 读 (“贷方”))
        赋值 (哪个科目, 读 (“科目”))
        删除 ()
        置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库辅1.edb”))
        到首记录 ()
        查找 (等于 (读 (“科目”), 哪个科目))
        写 (“借方”, 相减 (读 (“借方”), 将减借方))
        写 (“贷方”, 相减 (读 (“贷方”), 将减贷方))
        写 (“余额”, 相加 (读 (“借方”), 读 (“贷方”)))
        .如果 (大于 (读 (“借方”), 负 (读 (“贷方”))))
            写 (“方向”, “借”)
        .否则
            .如果 (小于 (读 (“借方”), 负 (读 (“贷方”))))
                写 (“方向”, “贷”)
            .否则
                .如果 (等于 (读 (“借方”), 负 (读 (“贷方”))))
                    写 (“方向”, “平”)
                .否则
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .如果真结束
    置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”))
    跳过 ()
.判断循环尾 ()
置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”))
彻底删除 ()
关闭 ()
置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库辅1.edb”))
关闭 ()
 ' ----
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证库.edb”), , , , , 本账库密码, )
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (查找 (并且 (等于 (取年份 (读 (“日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“日期”)), 取月份 (会计期间)))))
        写 (“登账”, “”)
    .如果真结束
    跳过 ()
.判断循环尾 ()
关闭 ()
 ' ----
赋值 (提示信息, “本月登账均已撤销！”)
载入 (提示窗口, , 真)

.子程序 _日记账_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
载入 (日记账窗口, , 真)

.子程序 _Excel固定资产表_被选择, 空白型, , 
_日记账_被选择 ()

.子程序 _工资核算_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
载入 (购买说明窗口, , 真)

.子程序 _生成报表_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
载入 (购买说明窗口, , 真)


.子程序 _导入导出报表_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
载入 (购买说明窗口, , 真)


.子程序 _常用封面_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
.如果 (未知支持库函数_0 ())
    
.否则
    赋值 (提示信息, 相加 (“您的计算机没有安装Microsoft Office Excel电子表格程序！”, #换行符, “导出报表需要 Excel2000 或 以上版本！”))
    载入 (提示窗口, , 真)
    返回 ()
.如果结束
赋值 (., 假)
赋值 (., 真)
未知支持库函数_4 ()
.未知支持库函数_6 ()
未知支持库函数_15 ()
相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “常用封面.xls”).未知支持库函数_14 ()

.子程序 _打印向导_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
载入 (购买说明窗口, , 真)


.子程序 _打印报表_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
载入 (购买说明窗口, , 真)


.子程序 _打印账页_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
载入 (购买说明窗口, , 真)


.子程序 _新建用户_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
载入 (新建用户窗口, , 真)

.子程序 _备份数据_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
载入 (备份与恢复窗口, , 真)

.子程序 _恢复数据_被选择, 空白型, , 
_备份数据_被选择 ()

.子程序 _软件教程_被选择, 空白型, , 
运行 (相加 (取文本左边 (未知支持库函数_7 (#), 3), “Program Files\Internet Explorer\IEXPLORE.EXE ”, 取运行目录 (), “\”, “help\index.htm”), 假, #最大化激活)

.子程序 _如何购买_被选择, 空白型, , 
运行 (相加 (取文本左边 (未知支持库函数_7 (#), 3), “Program Files\Internet Explorer\IEXPLORE.EXE ”, 取运行目录 (), “\”, “help\goumai.htm”), 假, #最大化激活)

.子程序 _关于世宝_被选择, 空白型, , 
载入 (关于世宝, , 真)

.子程序 _总分类账_被选择, 空白型, , 
.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
赋值 (.禁止, 真)
赋值 (看吗账, “总账”)
_明细分类账_被选择 ()
赋值 (.禁止, 假)

.子程序 _编制凭证按钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_编制凭证_被选择 ()

.子程序 _审核凭证按钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_审核凭证_被选择 ()

.子程序 _凭证登账按钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_凭证登账_被选择 ()

.子程序 _结转损益按钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_凭证登账_被选择 ()

.子程序 _期末结账按钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_凭证登账_被选择 ()

.子程序 _报表按钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_编辑报表_被选择 ()

.子程序 _打印向导凭证按钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

运行 (相加 (取文本左边 (未知支持库函数_7 (#), 3), “Program Files\Internet Explorer\IEXPLORE.EXE ”, 取运行目录 (), “\”, “help\dayinxiangdao.htm”), 假, #最大化激活)

.子程序 _查找凭证按钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
_查阅凭证_被选择 ()

.子程序 _总分类账按钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_总分类账_被选择 ()

.子程序 _明细分类账按钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_明细分类账_被选择 ()

.子程序 _日记账按钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_日记账_被选择 ()

.子程序 _收银按钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
载入 (出纳窗口, , 真)

.子程序 _支银按钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
载入 (出纳窗口, , 真)

.子程序 _收现按钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
载入 (出纳窗口, , 真)


.子程序 _支现按钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (登陆窗口被登陆, 假))
    登陆提示 ()
    返回 ()
.如果真结束
载入 (出纳窗口, , 真)


.子程序 _网址透明标签_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

运行 (相加 (取文本左边 (未知支持库函数_7 (#), 3), “Program Files\Internet Explorer\IEXPLORE.EXE www.shibao.net”), 假, )

.子程序 _Excel程序1_工作簿即将关闭, 空白型, , 
.参数 工作簿对象, 对象, , 
.参数 取消关闭, 逻辑型, 参考, 

未知支持库函数_1 ()
未知支持库函数_3 ()


.子程序 _工作窗口_将被销毁, 空白型, , 
.如果真 (等于 (当前用户, “”))
    返回 ()
.如果真结束
赋值 (提示信息, “为防止意外断电、病毒、Windows不稳定或其它的数据安全隐患，是否备份当前套账？”)
载入 (询问是否窗口, , 真)
.如果真 (等于 (询问是否窗口选择值, “是的”))
    载入 (备份与恢复窗口, , 真)
.如果真结束


.窗口程序集 管理套帐程序集, , , 

.子程序 _管理套账窗口_创建完毕, 空白型, , 
.局部变量 套账目录, 文本型, , , 

赋值 (刚选套账, “”)
赋值 (套账目录, 寻找文件 (相加 (取运行目录 (), “\”, #数据目录, “*.*”), #子目录))
.判断循环首 (不等于 (套账目录, “”))
    .如果真 (并且 (不等于 (套账目录, “.”), 不等于 (套账目录, “..”)))
        套账目录.加入项目 ()
    .如果真结束
    赋值 (套账目录, 寻找文件 (#子目录))
.判断循环尾 ()

.子程序 _新建_被单击, 空白型, , 
管理套账窗口.销毁 ()
载入 (新建套账窗口, 工作窗口, 真)

.子程序 _套账列表框_列表项被选择, 空白型, , 
赋值 (刚选套账, 取焦点项目 ().取项目文本 ())

.子程序 _删除_被单击, 空白型, , 
赋值 (删除套账按钮被点, 真)
载入 (登陆窗口, , 真)
.如果 (等于 (登陆窗口被登陆, 真))
    
.否则
    _关闭套账_被选择 ()
    返回 ()
.如果结束
.如果真 (不等于 (当前权限, 1))
    赋值 (提示信息, “您的权限不够！”)
    载入 (提示窗口, , 真)
    _关闭套账_被选择 ()
    返回 ()
.如果真结束
赋值 (提示信息, 相加 (“是否要删除”, “  ”, 当前套账))
载入 (询问是否窗口, , 真)
.如果真 (等于 (询问是否窗口选择值, “不是”))
    _关闭套账_被选择 ()
    返回 ()
.如果真结束
删除目录 (相加 (取运行目录 (), “\”, #数据目录, 当前套账))

赋值 (当前用户, “”)
赋值 (登陆窗口被登陆, 假)

销毁 ()
载入 (管理套账窗口, 工作窗口, 真)
返回 ()

.子程序 _打开_被单击, 空白型, , 
_套账列表框_被双击 (0, 0, 0)

.子程序 _套账列表框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

置等待鼠标 ()
赋值 (删除套账按钮被点, 假)
.如果真 (等于 (刚选套账, “”))
    返回 ()
.如果真结束
载入 (登陆窗口, , 真)
.如果 (等于 (登陆窗口被登陆, 真))
    
.否则
    返回 ()
.如果结束
销毁 ()

.子程序 _帮助_被单击, 空白型, , 
运行 (相加 (取文本左边 (未知支持库函数_7 (#), 3), “Program Files\Internet Explorer\IEXPLORE.EXE ”, 取运行目录 (), “\”, “help\index.htm”), 假, #最大化激活)


.窗口程序集 新建套帐程序集, , , 

.子程序 _新建套账窗口_创建完毕, 空白型, , 
赋值 (.今天, 取现行时间 ())

.子程序 _确定_被单击, 空白型, , 
.局部变量 基本信息字段信息, 字段信息, , "5", 
.局部变量 用户字段信息, 字段信息, , "3", 
.局部变量 新账库密码, 文本型, , , 

.如果真 (等于 (.内容, “”))
    赋值 (提示信息, “套账名称 不能为空！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
.如果真 (等于 (寻找文件 (相加 (取运行目录 (), “\”, #数据目录, 删首尾空 (.内容)), #子目录), 删首尾空 (.内容)))
    赋值 (提示信息, 相加 (.内容, “ 和已有套账同名，请更换！”))
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (提示信息, “管理员名 必须填写！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
.如果真 (不等于 (.内容, .内容))
    赋值 (提示信息, “管理密码 与 密码效验  必须相同！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
.如果真 (创建目录 (相加 (取运行目录 (), “\”, #数据目录, 删首尾空 (.内容))))
    赋值 (基本信息字段信息 [1].名称, “单位名称”)
    赋值 (基本信息字段信息 [1].类型, #文本型)
    赋值 (基本信息字段信息 [1].最大文本长度, 100)
    
    赋值 (基本信息字段信息 [2].名称, “启用日期”)
    赋值 (基本信息字段信息 [2].类型, #日期时间型)
    
    赋值 (基本信息字段信息 [3].名称, “本账密码”)
    赋值 (基本信息字段信息 [3].类型, #文本型)
    赋值 (基本信息字段信息 [3].最大文本长度, 100)
    
    赋值 (基本信息字段信息 [4].名称, “是否启用”)
    赋值 (基本信息字段信息 [4].类型, #逻辑型)
    
    赋值 (基本信息字段信息 [5].名称, “会计期间”)
    赋值 (基本信息字段信息 [5].类型, #日期时间型)
    
    
    创建 (相加 (取运行目录 (), “\”, #数据目录, 删首尾空 (.内容), “\”, #基本信息), 基本信息字段信息)
    打开 (相加 (取运行目录 (), “\”, #数据目录, 删首尾空 (.内容), “\”, #基本信息), , , , , , )
    置数据库密码 (#库密码)
    打开 (相加 (取运行目录 (), “\”, #数据目录, 删首尾空 (.内容), “\”, #基本信息), , , , , #库密码, )
    赋值 (新账库密码, 到文本 (取现行时间 ())) ' 新账 的 库密码 生成
    赋值 (本账库密码, 新账库密码)
    加记录 (.内容, 取日期 (.今天), 新账库密码, 假, 取日期 (.今天)) ' 这是 创建套账的 基本信息库，包括：单位名称、启用日期、本账密码。
    关闭 ()
    赋值 (用户字段信息 [1].名称, “用户名”)
    赋值 (用户字段信息 [1].类型, #文本型)
    赋值 (用户字段信息 [1].最大文本长度, 100)
    赋值 (用户字段信息 [2].名称, “密码”)
    赋值 (用户字段信息 [2].类型, #文本型)
    赋值 (用户字段信息 [3].名称, “权限”)
    赋值 (用户字段信息 [3].类型, #字节型)
    创建 (相加 (取运行目录 (), “\”, #数据目录, 删首尾空 (.内容), “\”, #用户), 用户字段信息)
    打开 (相加 (取运行目录 (), “\”, #数据目录, 删首尾空 (.内容), “\”, #用户), , , , , , )
    置数据库密码 (新账库密码)
    打开 (相加 (取运行目录 (), “\”, #数据目录, 删首尾空 (.内容), “\”, #用户), , , , , 新账库密码, )
    加记录 (.内容, .内容, 1) ' 这是 创建套账的 用户库，包括：用户名、密码、权限。
    关闭 ()
    赋值 (当前套账, 删首尾空 (.内容))
    
     ' ---------------------
    
    复制文件 (相加 (取运行目录 (), “\”, #数据目录, “会计科目.edb”), 相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “会计科目.edb”))
    打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “会计科目.edb”), , , , , #库密码, )
    置数据库密码 (本账库密码)
    关闭 ()
    
    复制文件 (相加 (取运行目录 (), “\”, #数据目录, “凭证库.edb”), 相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证库.edb”))
    打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证库.edb”), , , , , #库密码, )
    置数据库密码 (本账库密码)
    关闭 ()
    
    复制文件 (相加 (取运行目录 (), “\”, #数据目录, “账库.edb”), 相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”))
    打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”), , , , , #库密码, )
    置数据库密码 (本账库密码)
    关闭 ()
    
    复制文件 (相加 (取运行目录 (), “\”, #数据目录, “日记账库.edb”), 相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “日记账库.edb”))
    打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “日记账库.edb”), , , , , #库密码, )
    置数据库密码 (本账库密码)
    关闭 ()
    
    
    复制文件 (相加 (取运行目录 (), “\”, #数据目录, “账库.edb”), 相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库.edb”))
    打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库.edb”), , , , , #库密码, )
    置数据库密码 (本账库密码)
    关闭 ()
    
    
    复制文件 (相加 (取运行目录 (), “\”, #数据目录, “账库辅1.edb”), 相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库辅1.edb”))
    打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库辅1.edb”), , , , , #库密码, )
    置数据库密码 (本账库密码)
    关闭 ()
    
    复制文件 (相加 (取运行目录 (), “\”, #数据目录, “结转损益.edb”), 相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “结转损益.edb”))
    打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “结转损益.edb”), , , , , #库密码, )
    置数据库密码 (本账库密码)
    关闭 ()
     ' -----------以下库  无需密码
    
    复制文件 (相加 (取运行目录 (), “\”, #数据目录, “摘要库.edb”), 相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “摘要库.edb”))
    复制文件 (相加 (取运行目录 (), “\”, #数据目录, “报表临时1.edb”), 相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “报表临时1.edb”))
    复制文件 (相加 (取运行目录 (), “\”, #数据目录, “报表.xls”), 相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “报表.xls”))
    复制文件 (相加 (取运行目录 (), “\”, #数据目录, “常用封面.xls”), 相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “常用封面.xls”))
    
     ' ------------------
    赋值 (当前套账, “”)
    赋值 (提示信息, “新套账创建成功！”)
    新建套账窗口.销毁 ()
    载入 (提示窗口, , 真)
    载入 (管理套账窗口, , 真)
    返回 ()
.如果真结束
赋值 (提示信息, “数据无法写入磁盘！ 请检测您对计算机使用的权限！”)
载入 (提示窗口, , 真)
返回 ()

.子程序 _套账名称编辑框_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (或者 (等于 (字符代码, 92), 等于 (字符代码, 47), 等于 (字符代码, 58), 等于 (字符代码, 42), 等于 (字符代码, 63), 等于 (字符代码, 34), 等于 (字符代码, 60), 等于 (字符代码, 62), 等于 (字符代码, 124)))
    返回 (0)
.如果真结束


.程序集 付费相关程序集, , , 

.子程序 算号, 空白型, , 因本程序为参赛使用，所以加密类程序均都被改动过！！！
.局部变量 下发钥匙, 字段信息, , "1", 
.局部变量 特征字, 整数型, , , 
.局部变量 特征字文本, 文本型, , , 
.局部变量 特征文本数组, 文本型, , "3", 
.局部变量 循环计次, 短整数型, , , 
.局部变量 注册号文本, 文本型, , , 
.局部变量 注册号文本数组, 文本型, , "3", 
.局部变量 取几次, 整数型, , , 

 ' 因本程序为参赛使用，所以加密类程序均都被改动过！！！
赋值 (取几次, 1)
赋值 (特征字, 1)
.判断循环首 (不等于 (特征字, 0))
    延时 (168)
    赋值 (特征字, 取硬盘特征字 ())
    赋值 (取几次, 相加 (取几次, 1))
    .如果真 (不等于 (特征字, 0))
        跳出循环 ()
    .如果真结束
    .如果真 (等于 (取几次, 6))
        跳出循环 ()
    .如果真结束
    
.判断循环尾 ()
.如果真 (等于 (特征字, 0))
    信息框 (“有非法程序、障碍本程序运行，或无法读出硬盘信息，请检查后重试！”, 0, )
    结束 ()
.如果真结束
赋值 (特征字文本, 数值到格式文本 (特征字, , 假))
赋值 (特征文本数组 [1], 取文本左边 (特征字文本, 4))
赋值 (特征文本数组 [2], 取文本右边 (特征字文本, 4))
赋值 (特征文本数组 [3], 取文本中间 (特征字文本, 3, 3))
赋值 (注册号, 相加 (到数值 (特征文本数组 [1]), 相乘 (到数值 (特征文本数组 [2]), 到数值 (特征文本数组 [3])))) ' 算出注册号
赋值 (注册号文本, 数值到格式文本 (注册号, , 假))
赋值 (注册号文本数组 [1], 取文本左边 (注册号文本, 5))
赋值 (注册号文本数组 [2], 取文本右边 (注册号文本, 5))
赋值 (注册号文本数组 [3], 取文本中间 (注册号文本, 2, 5))
赋值 (钥匙号, 相加 (到数值 (注册号文本数组 [1]), 相乘 (到数值 (注册号文本数组 [2]), 到数值 (注册号文本数组 [3])))) ' 算出钥匙号
.如果真 (等于 (打开 (#信息库, , , , , #库密码, ), 假))
    赋值 (下发钥匙 [1].名称, “下发钥匙”)
    赋值 (下发钥匙 [1].类型, #长整数型)
    创建 (#信息库, 下发钥匙)
    打开 (#信息库, , , , , , , )
    加记录 (1)
    置数据库密码 (#库密码)
.如果真结束
.如果 (等于 (读 (“下发钥匙”), 钥匙号))
    赋值 (是否付费, 真)
.否则
    赋值 (是否付费, 假)
.如果结束
关闭 ()
返回 ()

.子程序 是否过期, 空白型, , 本段程序因参赛被删除！
 ' 本过程涉及到其他软件的加密，故此省略见谅！
返回 ()

.窗口程序集 购买说明程序集, , , 

.程序集变量 能否关闭, 逻辑型, , , 
.程序集变量 倒计时, 短整数型, , , 
.子程序 _购买说明窗口_创建完毕, 空白型, , 
赋值 (.内容, 到文本 (注册号))
购买说明窗口.获取焦点 ()
赋值 (倒计时, #开始等待时间)
赋值 (能否关闭, 假)

.子程序 _时钟_周期事件, 空白型, , 
赋值 (.内容, 相加 (到文本 (倒计时), “秒”))
赋值 (倒计时, 相减 (倒计时, 1))
.如果真 (等于 (倒计时, -1))
    赋值 (.时钟周期, 0)
    赋值 (.禁止, 假)
    赋值 (能否关闭, 真)
.如果真结束


.子程序 _购买说明窗口_可否被关闭, 逻辑型, , 
.如果真 (等于 (能否关闭, 真))
    返回 (真)
.如果真结束
返回 (假)

.子程序 _继续试用_被单击, 空白型, , 
购买说明窗口.销毁 ()
载入 (工作窗口, , 假)

.子程序 _输入钥匙_被单击, 空白型, , 
.局部变量 用户输入钥匙号, 长整数型, , , 

输入框 (“　　请输入您的软件钥匙号．．．．．．”, “输入钥匙号”, , 用户输入钥匙号, #输入整数)
打开 (#信息库, , , , , #库密码, , )
写 (“下发钥匙”, 用户输入钥匙号)
购买说明窗口.销毁 ()
信息框 (“钥匙号输入完成、请重新运行本软件、并检查注册是否成功！”, 0, “感谢您能支持正版、支持我们！ +_+”)
结束 ()

.窗口程序集 提示窗口程序集, , , 

.子程序 _关闭提示_被单击, 空白型, , 
提示窗口.销毁 ()
赋值 (提示信息, “”)
返回 ()

.子程序 _提示窗口_创建完毕, 空白型, , 
赋值 (.内容, 提示信息)

.窗口程序集 登陆窗口程序集, , , 

.程序集变量 被选用户, 文本型, , , 
.子程序 _登陆窗口_创建完毕, 空白型, , 
.局部变量 临时循环用1, 空白型, , , 

赋值 (被选用户, “”)
赋值 (登陆窗口被登陆, 假)

.如果真 (等于 (打开 (相加 (取运行目录 (), “\”, #数据目录, 刚选套账, “\”, #基本信息), , , , , #库密码, ), 假))
    赋值 (提示信息, “无法读出套账数据！  请选择套账后重试！”)
    载入 (提示窗口, , 真)
    销毁 ()
    返回 ()
.如果真结束

赋值 (本账库密码, 读 (“本账密码”))
赋值 (当前单位, 读 (“单位名称”))
赋值 (当前套账, 刚选套账)
赋值 (会计期间, 读 (“会计期间”))

关闭 ()
.如果真 (等于 (打开 (相加 (取运行目录 (), “\”, #数据目录, 刚选套账, “\”, #用户), , , , , 本账库密码, ), 假))
    赋值 (提示信息, “无法读出套账数据！  请检查后重试！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
到首记录 ()
.计次循环首 (取记录数 (), 临时循环用1)
    读 (“用户名”).加入项目 ()
    相减 (临时循环用1, 1).置项目数值 (相减 (临时循环用1, 1))
    跳过 ()
.计次循环尾 ()
关闭 ()

.子程序 _登陆_被单击, 空白型, , 
置等待鼠标 ()
打开 (相加 (取运行目录 (), “\”, #数据目录, 刚选套账, “\”, #用户), , , , , 本账库密码, )
到首记录 ()
.如果真 (查找 (等于 (读 (“用户名”), 被选用户)))
    .如果真 (等于 (读 (“密码”), .内容))
        赋值 (当前用户, 读 (“用户名”))
        赋值 (当前权限, 读 (“权限”))
        赋值 (工作窗口.标题, 相加 (#标题字, “  会计期间：”, 到文本 (取年份 (会计期间)), “年”, 到文本 (取月份 (会计期间)), “月”, “   用户：”, 当前用户, “  ”, 当前单位))
        关闭 ()
        销毁 ()
        赋值 (登陆窗口被登陆, 真)
        
        .如果 (等于 (删除套账按钮被点, 真))
            
        .否则
            打开 (相加 (取运行目录 (), “\”, #数据目录, 刚选套账, “\”, #基本信息), , , , , #库密码, )
            .如果真 (等于 (读 (“是否启用”), 假))
                关闭 ()
                载入 (账务初始化窗口, , 真)
                返回 ()
            .如果真结束
            关闭 ()
            
        .如果结束
        返回 ()
    .如果真结束
    
.如果真结束
关闭 ()
赋值 (提示信息, “密码 或 用户名 不正确！”)
载入 (提示窗口, , 真)
赋值 (.内容, “”)
获取焦点 ()
返回 ()

.子程序 _用户名选择_列表项被选择, 空白型, , 
赋值 (被选用户, .取项目文本 (.现行选中项))
获取焦点 ()

.窗口程序集 询问是否窗口程序集, , , 

.子程序 _询问是否窗口_创建完毕, 空白型, , 
赋值 (.内容, 提示信息)

.子程序 _是的_被单击, 空白型, , 
赋值 (询问是否窗口选择值, “是的”)
赋值 (.内容, 提示信息)
销毁 ()
返回 ()

.子程序 _不是_被单击, 空白型, , 
赋值 (询问是否窗口选择值, “不是”)
赋值 (.内容, 提示信息)
销毁 ()
返回 ()

.窗口程序集 会计科目窗口序集, , , 

.程序集变量 树型框数组, 树型框, , "5", 
.子程序 _会计科目窗口_创建完毕, 空白型, , 
赋值 (科目窗口是否需要传递, 假)

赋值 (树型框数组 [1], )
赋值 (树型框数组 [2], )
赋值 (树型框数组 [3], )
赋值 (树型框数组 [4], )
赋值 (树型框数组 [5], )
排列科目 ()
显示科目树 (1)

.子程序 显示科目树, 空白型, , 
.参数 哪个科目, 整数型, , 

赋值 (树型框数组 [1].最大化按钮, -1)
赋值 (树型框数组 [2].最大化按钮, -1)
赋值 (树型框数组 [3].最大化按钮, -1)
赋值 (树型框数组 [4].最大化按钮, -1)
赋值 (树型框数组 [5].最大化按钮, -1)
.如果真 (等于 (哪个科目, 1))
    赋值 (科目树型框当前类型编号, 1)
    赋值 (科目树型框当前类型文本, “资产类”)
.如果真结束
.如果真 (等于 (哪个科目, 2))
    赋值 (科目树型框当前类型编号, 2)
    赋值 (科目树型框当前类型文本, “负债类”)
.如果真结束
.如果真 (等于 (哪个科目, 3))
    赋值 (科目树型框当前类型编号, 3)
    赋值 (科目树型框当前类型文本, “权益类”)
.如果真结束
.如果真 (等于 (哪个科目, 4))
    赋值 (科目树型框当前类型编号, 4)
    赋值 (科目树型框当前类型文本, “成本类”)
.如果真结束
.如果真 (等于 (哪个科目, 5))
    赋值 (科目树型框当前类型编号, 5)
    赋值 (科目树型框当前类型文本, “损益类”)
.如果真结束


.子程序 排列科目, 空白型, , 
.局部变量 循环记次用变量, 整数型, , , 
.局部变量 大循环计次, 整数型, , , 

.计次循环首 (5, 大循环计次)
    树型框数组.清空 ( [大循环计次])
.计次循环尾 ()
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, #会计科目), , , , , 本账库密码, )
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (等于 (读 (“科目分类”), “资产类”))
        赋值 (科目树型框当前类型编号, 1)
    .否则
        .如果 (等于 (读 (“科目分类”), “负债类”))
            赋值 (科目树型框当前类型编号, 2)
        .否则
            .如果 (等于 (读 (“科目分类”), “权益类”))
                赋值 (科目树型框当前类型编号, 3)
            .否则
                .如果 (等于 (读 (“科目分类”), “成本类”))
                    赋值 (科目树型框当前类型编号, 4)
                .否则
                    .如果 (等于 (读 (“科目分类”), “损益类”))
                        赋值 (科目树型框当前类型编号, 5)
                    .否则
                        
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .如果结束
    .如果真 (等于 (读 (“上级科目”), “”))
        树型框数组.加入项目 ( [科目树型框当前类型编号], , 读 (“科目名称”), , , )
    .如果真结束
    .计次循环首 (树型框数组.取项目数 ( [科目树型框当前类型编号]), 循环记次用变量)
        .如果真 (等于 (读 (“上级科目”), 树型框数组.取项目文本 ( [科目树型框当前类型编号], 相减 (循环记次用变量, 1))))
            树型框数组.加入项目 ( [科目树型框当前类型编号], 相减 (循环记次用变量, 1), 读 (“科目名称”), , , )
            树型框数组.扩展 ( [科目树型框当前类型编号], 相减 (循环记次用变量, 1))
        .如果真结束
        
    .计次循环尾 ()
    跳过 ()
    赋值 (树型框数组 [科目树型框当前类型编号], 最大化按钮, -1)
.判断循环尾 ()
关闭 ()

赋值 (会计科目窗口科目树型框当前选定文本, “”)

.子程序 _插入空白_被单击, 空白型, , 
赋值 (科目窗口是否需要传递, 真)
销毁 ()

.子程序 _增加同级科目_被单击, 空白型, , 
赋值 (科目设置窗口状态变量, “增加同级科目”)
载入 (科目设置窗口, , 真)

.子程序 _选择夹_子夹被改变, 空白型, , 
赋值 (会计科目窗口科目树型框当前选定文本, “”)
显示科目树 (相加 (.现行子夹, 1))

.子程序 项目被选择之后, 空白型, , 
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, #会计科目), , , , , 本账库密码, )
到首记录 ()
查找 (等于 (读 (“科目名称”), 会计科目窗口科目树型框当前选定文本))
赋值 (会计科目窗口科目树型框当前选定文本的上级科目名, 读 (“上级科目”))
赋值 (会计科目窗口科目树型框当前选定科目级别, 读 (“科目级别”))
关闭 ()

.子程序 _损益类树型框_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

赋值 (会计科目窗口科目树型框当前选定文本, .取项目文本 (.最大化按钮))
项目被选择之后 ()

.子程序 _成本类树型框_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

赋值 (会计科目窗口科目树型框当前选定文本, .取项目文本 (.最大化按钮))
项目被选择之后 ()

.子程序 _权益类树型框_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

赋值 (会计科目窗口科目树型框当前选定文本, .取项目文本 (.最大化按钮))
项目被选择之后 ()

.子程序 _负债类树型框_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

赋值 (会计科目窗口科目树型框当前选定文本, .取项目文本 (.最大化按钮))
项目被选择之后 ()

.子程序 _资产类树型框_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

赋值 (会计科目窗口科目树型框当前选定文本, .取项目文本 (.最大化按钮))
项目被选择之后 ()

.子程序 _增加下级科目_被单击, 空白型, , 
.如果真 (等于 (会计科目窗口科目树型框当前选定文本, “”))
    赋值 (提示信息, “请选择，要操作的科目！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
赋值 (科目设置窗口状态变量, “增加下级科目”)
载入 (科目设置窗口, , 真)

.子程序 _删除当前选定_被单击, 空白型, , 
.如果真 (等于 (会计科目窗口科目树型框当前选定文本, “”))
    赋值 (提示信息, “请选择，要操作的科目！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
赋值 (提示信息, 相加 (“是否要删除”, “  ”, 会计科目窗口科目树型框当前选定文本, “科目”))
载入 (询问是否窗口, , 真)
.如果真 (等于 (询问是否窗口选择值, “不是”))
    返回 ()
.如果真结束
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, #会计科目), , , , , 本账库密码, )
到首记录 ()
查找 (等于 (读 (“科目名称”), 会计科目窗口科目树型框当前选定文本))
.如果真 (等于 (.是否有子项目 (.最大化按钮), 真))
    赋值 (提示信息, 相加 (会计科目窗口科目树型框当前选定文本, “ 科目，无法删除！（需先删除其下级科目）”))
    载入 (提示窗口, , 真)
    关闭 ()
    返回 ()
.如果真结束
.如果真 (等于 (读 (“是否启用”), “真”))
    赋值 (提示信息, 相加 (会计科目窗口科目树型框当前选定文本, “ 科目，已经被登账！无法删除！”))
    载入 (提示窗口, , 真)
    关闭 ()
    返回 ()
.如果真结束
删除 ()
彻底删除 ()
关闭 ()
赋值 (提示信息, 相加 (“已经成功删除 ”, 会计科目窗口科目树型框当前选定文本))
载入 (提示窗口, , 真)
排列科目 ()
返回 ()

.子程序 _资产类树型框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (科目窗口是否需要传递, 真)
销毁 ()

.子程序 _负债类树型框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (科目窗口是否需要传递, 真)
销毁 ()

.子程序 _权益类树型框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (科目窗口是否需要传递, 真)
销毁 ()

.子程序 _成本类树型框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (科目窗口是否需要传递, 真)
销毁 ()

.子程序 _损益类树型框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (科目窗口是否需要传递, 真)
销毁 ()

.子程序 _将选定科目插入到_被单击, 空白型, , 
赋值 (科目窗口是否需要传递, 真)
销毁 ()

.窗口程序集 科目设置窗口程序集, , , 

.程序集变量 余额方向变量, 文本型, , , 
.子程序 _科目设置窗口_创建完毕, 空白型, , 
赋值 (科目设置窗口.标题, 相加 (科目设置窗口.标题, “  ”, 科目设置窗口状态变量))
赋值 (余额方向变量, “”)

.子程序 _确定_被单击, 空白型, , 
.如果真 (等于 (删全部空 (.内容), “”))
    赋值 (提示信息, “请输入科目名称 ！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
.如果真 (等于 (余额方向变量, “”))
    赋值 (提示信息, “请选择，余额方向 ！”)
     ' ---是否方向检测
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, #会计科目), , , , , 本账库密码, )
.如果真 (查找 (等于 (读 (“科目名称”), .内容)))
    赋值 (提示信息, “输入的科目名称和已有科目相同 ！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
.如果真 (等于 (科目设置窗口状态变量, “增加同级科目”))
    .如果真 (等于 (会计科目窗口科目树型框当前选定文本的上级科目名, “”))
        打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, #会计科目), , , , , 本账库密码, )
        加记录 (.内容, 会计科目窗口科目树型框当前选定文本的上级科目名, 科目树型框当前类型文本, 余额方向变量, “”, 会计科目窗口科目树型框当前选定科目级别)
        关闭 ()
        销毁 ()
        返回 ()
    .如果真结束
    打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, #会计科目), , , , , 本账库密码, )
    加记录 (相加 (会计科目窗口科目树型框当前选定文本的上级科目名, “→”, .内容), 会计科目窗口科目树型框当前选定文本的上级科目名, 科目树型框当前类型文本, 余额方向变量, “”, 会计科目窗口科目树型框当前选定科目级别)
    关闭 ()
    销毁 ()
    返回 ()
.如果真结束
.如果真 (等于 (科目设置窗口状态变量, “增加下级科目”))
    打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, #会计科目), , , , , 本账库密码, )
    加记录 (相加 (会计科目窗口科目树型框当前选定文本, “→”, .内容), 会计科目窗口科目树型框当前选定文本, 科目树型框当前类型文本, 余额方向变量, “”, 相加 (会计科目窗口科目树型框当前选定科目级别, 1))
    关闭 ()
    销毁 ()
    返回 ()
.如果真结束
返回 ()

.子程序 _借方单选框_被单击, 空白型, , 
赋值 (余额方向变量, “借方”)

.子程序 _贷方单选框_被单击, 空白型, , 
赋值 (余额方向变量, “贷方”)

.子程序 _取消_被单击, 空白型, , 
销毁 ()

.子程序 _科目设置窗口_将被销毁, 空白型, , 
排列科目 ()

.窗口程序集 编制凭证窗口程序集, , , 

.子程序 _编制凭证窗口_创建完毕, 空白型, , 
赋值 (编制凭证窗口.可视, 真)
赋值 (本月凭证编号有, 0)
赋值 (.数据库文件名, 相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证库.edb”))
赋值 (.数据库密码, 本账库密码)
到尾记录 ()
窗口刷新 ()

.如果真 (等于 (是否到对应呀, 真))
    .判断循环首 (不等于 (取记录号 (), 1))
        .如果真 (并且 (等于 (.内容, 到文本 (传递来的日期)), 等于 (.内容, 传递来的月编号), 等于 (.内容, 传递来的小编号)))
            跳出循环 ()
        .如果真结束
        -1.跳过 ()
    .判断循环尾 ()
    赋值 (是否到对应呀, 假)
    .如果真 (等于 (是否打印, 真))
        _打印当前_被单击 ()
        赋值 (是否打印, 假)
        销毁 ()
    .如果真结束
    
.如果真结束
返回 ()
 ' -----------------------------------------------------------------------------------
.如果真 (不等于 (传递来的编制凭证种类, “”))
    _新建凭证_被单击 ()
    赋值 (.内容, 传递来的编制凭证种类)
    赋值 (传递来的编制凭证种类, “”)
.如果真结束


.子程序 _打印当前_被单击, 空白型, , 
刷新凭证表格 ()
.打印 ()

.子程序 刷新凭证表格, 空白型, , 
.局部变量 总列数, 整数型, , , 
.局部变量 总行数, 整数型, , , 
.局部变量 当前格内容, 文本型, , , 
.局部变量 当前列, 整数型, , , 
.局部变量 当行数, 整数型, , , 

相加 (取运行目录 (), “\”, #数据目录, “标准凭证.grd”).从文件读 ()
.如果真 (等于 (取屏幕宽度 (), 1024))
    赋值 (.缩放比, 95)
.如果真结束
.如果真 (等于 (取屏幕宽度 (), 800))
    赋值 (.缩放比, 125)
.如果真结束
.如果真 (等于 (取屏幕宽度 (), 640))
    赋值 (.缩放比, 150)
.如果真结束
赋值 (总列数, 取列数 ())
赋值 (总行数, 取行数 ())
.计次循环首 (总列数, 当前列)
    .计次循环首 (总行数, 当行数)
        赋值 (当前格内容, 当行数.取文本 (当前列))
        .如果真 (并且 (等于 (取文本左边 (当前格内容, 1), “[”), 等于 (取文本右边 (当前格内容, 1), “]”)))
            赋值 (当前格内容, 取文本中间 (当前格内容, 2, 相减 (取文本长度 (当前格内容), 2)))
            当行数.置文本 (当前列, “”)
            .如果真 (等于 (当前格内容, “单位”))
                当行数.置文本 (当前列, 当前单位)
            .如果真结束
            .如果真 (等于 (当前格内容, “日期”))
                当行数.置文本 (当前列, 相加 (“ ”, .内容))
            .如果真结束
            .如果真 (等于 (当前格内容, “编号”))
                当行数.置文本 (当前列, .内容)
            .如果真结束
            .如果真 (等于 (当前格内容, “第几”))
                当行数.置文本 (当前列, 相加 (“第”, .内容, “张”))
            .如果真结束
            .如果真 (等于 (当前格内容, “共几”))
                当行数.置文本 (当前列, 相加 (“共”, .内容, “张”))
            .如果真结束
            .如果真 (等于 (当前格内容, “编制”))
                当行数.置文本 (当前列, .内容)
            .如果真结束
            .如果真 (等于 (当前格内容, “附件数”))
                当行数.置文本 (当前列, 相加 (.内容, “张”))
            .如果真结束
            .如果真 (等于 (当前格内容, “摘要1”))
                当行数.置文本 (当前列, .内容)
            .如果真结束
            .如果真 (等于 (当前格内容, “摘要2”))
                当行数.置文本 (当前列, .内容)
            .如果真结束
            .如果真 (等于 (当前格内容, “摘要3”))
                当行数.置文本 (当前列, .内容)
            .如果真结束
            .如果真 (等于 (当前格内容, “摘要4”))
                当行数.置文本 (当前列, .内容)
            .如果真结束
            .如果真 (等于 (当前格内容, “科目1”))
                当行数.置文本 (当前列, .内容)
            .如果真结束
            .如果真 (等于 (当前格内容, “科目2”))
                当行数.置文本 (当前列, .内容)
            .如果真结束
            .如果真 (等于 (当前格内容, “科目3”))
                当行数.置文本 (当前列, .内容)
            .如果真结束
            .如果真 (等于 (当前格内容, “科目4”))
                当行数.置文本 (当前列, .内容)
            .如果真结束
            .如果真 (等于 (当前格内容, “借方金额1”))
                .如果 (等于 (.内容, “”))
                    
                .否则
                    当行数.置文本 (当前列, 数值到格式文本 (到数值 (.内容), 2, 真))
                .如果结束
                
            .如果真结束
            .如果真 (等于 (当前格内容, “借方金额2”))
                .如果 (等于 (.内容, “”))
                    
                .否则
                    当行数.置文本 (当前列, 数值到格式文本 (到数值 (.内容), 2, 真))
                .如果结束
                
            .如果真结束
            .如果真 (等于 (当前格内容, “借方金额3”))
                .如果 (等于 (.内容, “”))
                    
                .否则
                    当行数.置文本 (当前列, 数值到格式文本 (到数值 (.内容), 2, 真))
                .如果结束
                
            .如果真结束
            .如果真 (等于 (当前格内容, “借方金额4”))
                .如果 (等于 (.内容, “”))
                    
                .否则
                    当行数.置文本 (当前列, 数值到格式文本 (到数值 (.内容), 2, 真))
                .如果结束
                
            .如果真结束
            .如果真 (等于 (当前格内容, “贷方金额1”))
                .如果 (等于 (.内容, “”))
                    
                .否则
                    当行数.置文本 (当前列, 数值到格式文本 (到数值 (.内容), 2, 真))
                .如果结束
                
            .如果真结束
            .如果真 (等于 (当前格内容, “贷方金额2”))
                .如果 (等于 (.内容, “”))
                    
                .否则
                    当行数.置文本 (当前列, 数值到格式文本 (到数值 (.内容), 2, 真))
                .如果结束
                
            .如果真结束
            .如果真 (等于 (当前格内容, “贷方金额3”))
                .如果 (等于 (.内容, “”))
                    
                .否则
                    当行数.置文本 (当前列, 数值到格式文本 (到数值 (.内容), 2, 真))
                .如果结束
                
            .如果真结束
            .如果真 (等于 (当前格内容, “贷方金额4”))
                .如果 (等于 (.内容, “”))
                    
                .否则
                    当行数.置文本 (当前列, 数值到格式文本 (到数值 (.内容), 2, 真))
                .如果结束
                
            .如果真结束
            .如果真 (等于 (当前格内容, “借方合计”))
                .如果 (等于 (.内容, “”))
                    
                .否则
                    当行数.置文本 (当前列, 数值到格式文本 (到数值 (.内容), 2, 真))
                .如果结束
                
            .如果真结束
            .如果真 (等于 (当前格内容, “贷方合计”))
                .如果 (等于 (.内容, “”))
                    
                .否则
                    当行数.置文本 (当前列, 数值到格式文本 (到数值 (.内容), 2, 真))
                .如果结束
                
            .如果真结束
            .如果真 (等于 (当前格内容, “登账”))
                当行数.置文本 (当前列, .内容)
            .如果真结束
            .如果真 (等于 (当前格内容, “审核”))
                当行数.置文本 (当前列, .内容)
            .如果真结束
            .如果真 (等于 (当前格内容, “编制”))
                当行数.置文本 (当前列, .内容)
            .如果真结束
            .如果真 (等于 (当前格内容, “打印日期”))
                当行数.置文本 (当前列, 相加 (到文本 (取年份 (取现行时间 ())), “-”, 到文本 (取月份 (取现行时间 ())), “-”, 到文本 (取日 (取现行时间 ()))))
            .如果真结束
            
        .如果真结束
        
    .计次循环尾 ()
.计次循环尾 ()
关闭 ()

.子程序 _打印预览_被单击, 空白型, , 
刷新凭证表格 ()
打印预览 ()

.子程序 _增加子页_被单击, 空白型, , 
.局部变量 刚刚的月编号编辑框内容, 文本型, , , 
.局部变量 刚刚第几编辑框内容, 文本型, , , 
.局部变量 刚刚共几编辑框内容, 文本型, , , 
.局部变量 刚刚日期框编辑框内容, 文本型, , , 

.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”)))
    返回 ()
.如果真结束
赋值 (刚刚日期框编辑框内容, .内容)
赋值 (刚刚共几编辑框内容, .内容)
赋值 (刚刚第几编辑框内容, .内容)
赋值 (刚刚的月编号编辑框内容, .内容)
到尾记录 ()
1.添加行 ()
.跳过 ()
赋值 (.内容, 当前用户)
赋值 (.内容, 刚刚的月编号编辑框内容)
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证库.edb”), , , , , 本账库密码, )
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    查找 (并且 (等于 (取年份 (读 (“日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“日期”)), 取月份 (会计期间))))
    .如果真 (等于 (读 (“月编号”), 到数值 (刚刚的月编号编辑框内容)))
        写 (“共几”, 相加 (读 (“共几”), 1))
    .如果真结束
    跳过 ()
.判断循环尾 ()
关闭 ()
赋值 (.内容, 到文本 (相加 (到数值 (刚刚共几编辑框内容), 1)))
赋值 (.内容, 到文本 (相加 (到数值 (刚刚共几编辑框内容), 1)))
赋值 (.内容, 刚刚日期框编辑框内容)
窗口刷新 ()

.子程序 凭证排序, 空白型, , 
.局部变量 临时排序字段, 文本型, , "3", 
.局部变量 编号变量, 长整数型, , , 

置等待鼠标 ()
-1.跳过 ()
赋值 (编号变量, 1)
赋值 (临时排序字段, { “日期”, “月编号”, “第几” })
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证库.edb”), , , , , 本账库密码, )
排序 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证排序库.edb”), 临时排序字段, , , )
关闭 ()
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证排序库.edb”), , , , , 本账库密码, )
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    写 (“月编号”, 编号变量)
    .如果真 (等于 (读 (“第几”), 读 (“共几”)))
        赋值 (编号变量, 相加 (编号变量, 1))
    .如果真结束
    跳过 ()
.判断循环尾 ()
关闭 ()
复制文件 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证排序库.edb”), 相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证库.edb”))
刷新 ()

.子程序 窗口刷新, 空白型, , 
.局部变量 借方金额合计编辑框内容变量, 双精度小数型, , , 
.局部变量 贷方金额合计编辑框内容变量, 双精度小数型, , , 

赋值 (.内容, 相加 (“单位：”, 当前单位))
.如果真 (等于 (.内容, “1”))
    赋值 (.内容, 到文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容))))
    返回 ()
.如果真结束
.如果真 (并且 (不等于 (.内容, “1”), 等于 (.内容, .内容)))
    -1.跳过 ()
    .跳过 ()
    打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证库.edb”), , , , , 本账库密码, )
    到首记录 ()
    赋值 (借方金额合计编辑框内容变量, 0)
    赋值 (贷方金额合计编辑框内容变量, 0)
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果真 (查找 (并且 (等于 (取年份 (读 (“日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“日期”)), 取月份 (会计期间)), 等于 (读 (“月编号”), 到数值 (.内容)))))
            赋值 (借方金额合计编辑框内容变量, 相加 (借方金额合计编辑框内容变量, 读 (“借方金额1”), 读 (“借方金额2”), 读 (“借方金额3”), 读 (“借方金额4”)))
            赋值 (贷方金额合计编辑框内容变量, 相加 (贷方金额合计编辑框内容变量, 读 (“贷方金额1”), 读 (“贷方金额2”), 读 (“贷方金额3”), 读 (“贷方金额4”)))
        .如果真结束
        跳过 ()
    .判断循环尾 ()
    关闭 ()
    赋值 (.内容, 到文本 (借方金额合计编辑框内容变量))
    赋值 (.内容, 到文本 (贷方金额合计编辑框内容变量))
    返回 ()
.如果真结束
赋值 (.内容, “”)
赋值 (.内容, “”)

.子程序 _摘要1编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (点击可否执行 (), 假))
    返回 ()
.如果真结束
载入 (摘要窗口, , 真)
.如果真 (等于 (摘要窗口是否需要传递, 真))
    赋值 (.内容, 摘要树型框当前选定文本)
.如果真结束
窗口刷新 ()

.子程序 _摘要2编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (点击可否执行 (), 假))
    返回 ()
.如果真结束
载入 (摘要窗口, , 真)
.如果真 (等于 (摘要窗口是否需要传递, 真))
    赋值 (.内容, 摘要树型框当前选定文本)
.如果真结束
窗口刷新 ()

.子程序 _摘要3编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (点击可否执行 (), 假))
    返回 ()
.如果真结束
载入 (摘要窗口, , 真)
.如果真 (等于 (摘要窗口是否需要传递, 真))
    赋值 (.内容, 摘要树型框当前选定文本)
.如果真结束
窗口刷新 ()

.子程序 _摘要4编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (点击可否执行 (), 假))
    返回 ()
.如果真结束
载入 (摘要窗口, , 真)
.如果真 (等于 (摘要窗口是否需要传递, 真))
    赋值 (.内容, 摘要树型框当前选定文本)
.如果真结束
窗口刷新 ()

.子程序 _科目1编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (点击可否执行 (), 假))
    返回 ()
.如果真结束
载入 (会计科目窗口, , 真)
.如果真 (等于 (科目窗口是否需要传递, 真))
    赋值 (.内容, 会计科目窗口科目树型框当前选定文本)
    .如果真 (等于 (.内容, “”))
        赋值 (.内容, “”)
        赋值 (.内容, “”)
    .如果真结束
    
.如果真结束
窗口刷新 ()

.子程序 _科目2编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (点击可否执行 (), 假))
    返回 ()
.如果真结束
载入 (会计科目窗口, , 真)
.如果真 (等于 (科目窗口是否需要传递, 真))
    赋值 (.内容, 会计科目窗口科目树型框当前选定文本)
    .如果真 (等于 (.内容, “”))
        赋值 (.内容, “”)
        赋值 (.内容, “”)
    .如果真结束
    
.如果真结束
窗口刷新 ()

.子程序 _科目3编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (点击可否执行 (), 假))
    返回 ()
.如果真结束
载入 (会计科目窗口, , 真)
.如果真 (等于 (科目窗口是否需要传递, 真))
    赋值 (.内容, 会计科目窗口科目树型框当前选定文本)
    .如果真 (等于 (.内容, “”))
        赋值 (.内容, “”)
        赋值 (.内容, “”)
    .如果真结束
    
.如果真结束
窗口刷新 ()

.子程序 _科目4编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (点击可否执行 (), 假))
    返回 ()
.如果真结束
载入 (会计科目窗口, , 真)
.如果真 (等于 (科目窗口是否需要传递, 真))
    赋值 (.内容, 会计科目窗口科目树型框当前选定文本)
    .如果真 (等于 (.内容, “”))
        赋值 (.内容, “”)
        赋值 (.内容, “”)
    .如果真结束
    
.如果真结束
窗口刷新 ()

.子程序 _借方金额1编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (点击可否执行 (), 假))
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (提示信息, “先输入科目名称！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
载入 (金额输入窗口, , 真)
.如果 (等于 (金额输入窗口值, 0))
    赋值 (.内容, “”)
.否则
    赋值 (.内容, 到文本 (金额输入窗口值))
    赋值 (.内容, “”)
.如果结束
窗口刷新 ()

.子程序 _借方金额2编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (点击可否执行 (), 假))
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (提示信息, “先输入科目名称！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
载入 (金额输入窗口, , 真)
.如果 (等于 (金额输入窗口值, 0))
    赋值 (.内容, “”)
.否则
    赋值 (.内容, 到文本 (金额输入窗口值))
    赋值 (.内容, “”)
.如果结束
窗口刷新 ()

.子程序 _借方金额3编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (点击可否执行 (), 假))
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (提示信息, “先输入科目名称！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束

载入 (金额输入窗口, , 真)
.如果 (等于 (金额输入窗口值, 0))
    赋值 (.内容, “”)
.否则
    赋值 (.内容, 到文本 (金额输入窗口值))
    赋值 (.内容, “”)
.如果结束
窗口刷新 ()

.子程序 _借方金额4编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (点击可否执行 (), 假))
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (提示信息, “先输入科目名称！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束

载入 (金额输入窗口, , 真)
.如果 (等于 (金额输入窗口值, 0))
    赋值 (.内容, “”)
.否则
    赋值 (.内容, 到文本 (金额输入窗口值))
    赋值 (.内容, “”)
.如果结束
窗口刷新 ()

.子程序 _贷方金额1编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (点击可否执行 (), 假))
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (提示信息, “先输入科目名称！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束

载入 (金额输入窗口, , 真)
.如果 (等于 (金额输入窗口值, 0))
    赋值 (.内容, “”)
.否则
    赋值 (.内容, 到文本 (金额输入窗口值))
    赋值 (.内容, “”)
.如果结束
窗口刷新 ()

.子程序 _贷方金额2编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (点击可否执行 (), 假))
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (提示信息, “先输入科目名称！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束

载入 (金额输入窗口, , 真)
.如果 (等于 (金额输入窗口值, 0))
    赋值 (.内容, “”)
.否则
    赋值 (.内容, 到文本 (金额输入窗口值))
    赋值 (.内容, “”)
.如果结束
窗口刷新 ()

.子程序 _贷方金额3编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (点击可否执行 (), 假))
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (提示信息, “先输入科目名称！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束

载入 (金额输入窗口, , 真)
.如果 (等于 (金额输入窗口值, 0))
    赋值 (.内容, “”)
.否则
    赋值 (.内容, 到文本 (金额输入窗口值))
    赋值 (.内容, “”)
.如果结束
窗口刷新 ()

.子程序 _贷方金额4编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (点击可否执行 (), 假))
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (提示信息, “先输入科目名称！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束

载入 (金额输入窗口, , 真)
.如果 (等于 (金额输入窗口值, 0))
    赋值 (.内容, “”)
.否则
    赋值 (.内容, 到文本 (金额输入窗口值))
    赋值 (.内容, “”)
.如果结束
窗口刷新 ()

.子程序 _附件数编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (点击可否执行 (), 假))
    返回 ()
.如果真结束
载入 (张数输入窗口, , 真)
赋值 (.内容, 到文本 (张数输入窗口值))
窗口刷新 ()

.子程序 _日期编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (点击可否执行 (), 假))
    返回 ()
.如果真结束
载入 (日期输入窗口, , 真)
赋值 (.内容, 相加 (到文本 (取年份 (会计期间)), “年”, 到文本 (取月份 (会计期间)), “月”, 到文本 (日期输入窗口值), “日”))
.如果真 (不等于 (.内容, “1”))
    打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证库.edb”), , , , , 本账库密码, )
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        查找 (并且 (等于 (取年份 (读 (“日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“日期”)), 取月份 (会计期间))))
        .如果真 (等于 (读 (“月编号”), 到数值 (.内容)))
            写 (“日期”, 到时间 (.内容))
        .如果真结束
        跳过 ()
    .判断循环尾 ()
    关闭 ()
    
.如果真结束
窗口刷新 ()

.子程序 _月编号编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 临时月编号记录, 长整数型, , , 

赋值 (临时月编号记录, 到数值 (.内容))
.如果真 (等于 (点击可否执行 (), 假))
    返回 ()
.如果真结束
载入 (月编号窗口, , 真)
.如果真 (不等于 (.内容, “1”))
    打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证库.edb”), , , , , 本账库密码, )
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        查找 (并且 (等于 (取年份 (读 (“日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“日期”)), 取月份 (会计期间))))
        .如果真 (等于 (读 (“月编号”), 临时月编号记录))
            写 (“月编号”, 到数值 (.内容))
        .如果真结束
        跳过 ()
    .判断循环尾 ()
    关闭 ()
.如果真结束
窗口刷新 ()

.子程序 _第几编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

返回 ()
.如果真 (等于 (点击可否执行 (), 假))
    返回 ()
.如果真结束
载入 (月编号窗口, , 真)
窗口刷新 ()


.子程序 _共几编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

返回 ()
.如果真 (等于 (点击可否执行 (), 假))
    返回 ()
.如果真结束
载入 (月编号窗口, , 真)
窗口刷新 ()

.子程序 _审核或撤销_被单击, 空白型, , 
.如果真 (不等于 (.内容, “”))
    赋值 (提示信息, “已被登账、无法撤销！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (提示信息, “当前无可操作凭证，可点击[新建凭证]按钮添加凭证。”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “1”))
    .如果真 (或者 (不等于 (.内容, .内容), 等于 (.内容, “0”)))
        赋值 (提示信息, “借、贷方不平！无法通过审核！。”)
        载入 (提示窗口, , 真)
        返回 ()
    .如果真结束
    .如果 (等于 (.内容, “”))
        赋值 (.内容, 当前用户)
    .否则
        赋值 (.内容, “”)
    .如果结束
    返回 ()
.如果真结束
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证库.edb”), , , , , 本账库密码, )
到首记录 ()
.如果真 (查找 (并且 (等于 (取年份 (读 (“日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“日期”)), 取月份 (会计期间)), 等于 (读 (“月编号”), 到数值 (.内容)), 等于 (读 (“第几”), 到数值 (.内容)), 等于 (读 (“借方合计”), 读 (“贷方合计”)))))
    .如果 (等于 (.内容, “”))
        到首记录 ()
        .判断循环首 (等于 (尾记录后 (), 假))
            .如果真 (查找 (并且 (等于 (取年份 (读 (“日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“日期”)), 取月份 (会计期间)), 等于 (读 (“月编号”), 到数值 (.内容)))))
                写 (“审核”, 当前用户)
            .如果真结束
            跳过 ()
        .判断循环尾 ()
        赋值 (.内容, 当前用户)
    .否则
        到首记录 ()
        .判断循环首 (等于 (尾记录后 (), 假))
            .如果真 (查找 (并且 (等于 (取年份 (读 (“日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“日期”)), 取月份 (会计期间)), 等于 (读 (“月编号”), 到数值 (.内容)))))
                写 (“审核”, “”)
            .如果真结束
            跳过 ()
        .判断循环尾 ()
        赋值 (.内容, “”)
    .如果结束
    关闭 ()
    返回 ()
.如果真结束
关闭 ()
赋值 (提示信息, “借、贷方不平！无法通过审核！。”)
载入 (提示窗口, , 真)
返回 ()

.子程序 点击可否执行, 逻辑型, , 
.如果真 (等于 (.内容, “”))
    赋值 (提示信息, “当前无可操作凭证，可点击[新建凭证]按钮添加凭证。”)
    载入 (提示窗口, , 真)
    返回 (假)
.如果真结束
.如果真 (不等于 (.内容, “”))
    赋值 (提示信息, “当前凭证已审核，修改前要先撤销审核。”)
    载入 (提示窗口, , 真)
    返回 (假)
.如果真结束

返回 (真)

.子程序 _新建凭证_被单击, 空白型, , 
.如果 (等于 (取记录号 (), 0))
    
.否则
    .如果真 (或者 (不等于 (.内容, .内容), 等于 (.内容, “”), 等于 (到数值 (.内容), 0)))
        赋值 (提示信息, “当前凭证不完全，如需增加子页，可点击[增加子页]按钮。”)
        载入 (提示窗口, , 真)
        返回 ()
    .如果真结束
    
.如果结束
到尾记录 ()
1.添加行 ()
.跳过 ()
赋值 (.内容, 当前用户)
载入 (日期输入窗口, , 真)
赋值 (.内容, 相加 (到文本 (取年份 (会计期间)), “年”, 到文本 (取月份 (会计期间)), “月”, 到文本 (日期输入窗口值), “日”))
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证库.edb”), , , , , 本账库密码, )
赋值 (.内容, 到文本 (相加 (取最大值 (读 (“月编号”), 并且 (等于 (取年份 (读 (“日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“日期”)), 取月份 (会计期间)))), 1)))
关闭 ()
赋值 (.内容, “1”)
赋值 (.内容, “1”)
窗口刷新 ()

.子程序 _删除凭证_被单击, 空白型, , 
.局部变量 刚刚删除凭证的月编号, 文本型, , , 
.局部变量 刚刚删除凭证的第几, 文本型, , , 

置等待鼠标 ()
.如果真 (等于 (取记录号 (), 0))
    赋值 (提示信息, “当前无凭证！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
.如果真 (不等于 (.内容, “”))
    赋值 (提示信息, “当前凭证已被审核无法删除！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
赋值 (提示信息, “是否要删除当前凭证？”)
载入 (询问是否窗口, , 真)
.如果 (等于 (询问是否窗口选择值, “是的”))
    
.否则
    返回 ()
.如果结束

赋值 (刚刚删除凭证的月编号, .内容)
赋值 (刚刚删除凭证的第几, .内容)
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证库.edb”), , , , , 本账库密码, )
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    查找 (并且 (等于 (取年份 (读 (“日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“日期”)), 取月份 (会计期间))))
    .如果真 (等于 (读 (“月编号”), 到数值 (刚刚删除凭证的月编号)))
        .如果真 (大于 (读 (“第几”), 到数值 (刚刚删除凭证的第几)))
            写 (“第几”, 相减 (读 (“第几”), 1))
        .如果真结束
        .如果真 (大于 (读 (“共几”), 1))
            写 (“共几”, 相减 (读 (“共几”), 1))
        .如果真结束
        
    .如果真结束
    .如果真 (大于 (读 (“月编号”), 到数值 (刚刚删除凭证的月编号)))
        写 (“月编号”, 相减 (读 (“月编号”), 1))
    .如果真结束
    跳过 ()
.判断循环尾 ()
关闭 ()
取记录号 ().删除行 (1)
-1.跳过 ()
窗口刷新 ()

.子程序 _翻到上张_被单击, 空白型, , 
-1.跳过 ()
窗口刷新 ()

.子程序 _翻到下张_被单击, 空白型, , 
1.跳过 ()
窗口刷新 ()

.子程序 _按日期排序本月凭证_被单击, 空白型, , 
.如果真 (等于 (取记录号 (), 1))
    .跳过 ()
    .如果真 (等于 (取记录号 (), 1))
        返回 ()
    .如果真结束
    
.如果真结束
凭证排序 ()

.子程序 _计算器_被单击, 空白型, , 
运行 (相加 (取运行目录 (), “\”, #数据目录, “计算器.exe”), 假, )

.子程序 _审撤全部_被单击, 空白型, , 
.局部变量 是审核还是撤销, 文本型, 静态, , 

到尾记录 ()
.如果真 (等于 (.内容, “”))
    赋值 (提示信息, “当前无可操作凭证。”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
.如果真 (等于 (是审核还是撤销, “”))
    赋值 (是审核还是撤销, “审核”)
.如果真结束
.判断循环首 (不等于 (相加 (到数值 (.内容), 到数值 (.内容)), 2))
    .如果真 (等于 (.内容, .内容))
        .如果真 (或者 (不等于 (.内容, .内容), 等于 (.内容, “0”)))
            赋值 (提示信息, “当前凭证借、贷方不平！无法通过审核！。”)
            载入 (提示窗口, , 真)
            返回 ()
        .如果真结束
        
    .如果真结束
    .如果真 (等于 (.内容, “”))
        .如果真 (等于 (是审核还是撤销, “审核”))
            赋值 (.内容, 当前用户)
        .如果真结束
        .如果真 (等于 (是审核还是撤销, “撤销”))
            赋值 (.内容, “”)
        .如果真结束
        
    .如果真结束
    -1.跳过 ()
.判断循环尾 ()
.如果真 (等于 (.内容, “”))
    .如果 (等于 (是审核还是撤销, “审核”))
        赋值 (.内容, 当前用户)
        赋值 (是审核还是撤销, “撤销”)
        赋值 (提示信息, “本月凭证全部被审核。”)
        载入 (提示窗口, , 真)
    .否则
        .如果 (等于 (是审核还是撤销, “撤销”))
            赋值 (.内容, “”)
            赋值 (是审核还是撤销, “审核”)
            赋值 (提示信息, “本月凭证全部被撤销。”)
            载入 (提示窗口, , 真)
        .否则
            
        .如果结束
        
    .如果结束
    
.如果真结束



.窗口程序集 日期窗口程序集, , , 

.子程序 _取消_被单击, 空白型, , 
赋值 (日期窗口选择值, 会计期间)
销毁 ()

.子程序 _确定_被单击, 空白型, , 
赋值 (日期窗口选择值, .今天)
销毁 ()

.子程序 _日期窗口_创建完毕, 空白型, , 
赋值 (.今天, 会计期间)
获取焦点 ()

.窗口程序集 摘要窗口程序集, , , 

.子程序 _摘要窗口_创建完毕, 空白型, , 
赋值 (摘要窗口是否被载入, 真)
赋值 (摘要窗口是否需要传递, 假)
赋值 (摘要树型框当前选定文本的所在分类, “”)
赋值 (摘要树型框当前选定文本, “”)
摘要树型框刷新子程序 ()

.子程序 _摘要树型框_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

赋值 (摘要树型框当前选定文本, .取项目文本 (.最大化按钮))
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “摘要库.edb”), , , , , , )
到首记录 ()
查找 (等于 (读 (“摘要名称”), 摘要树型框当前选定文本))
赋值 (摘要树型框当前选定文本的所在分类, 读 (“所在分类”))
赋值 (.内容, 摘要树型框当前选定文本)
关闭 ()

.子程序 摘要树型框刷新子程序, 空白型, , 
.局部变量 循环记次用变量, 整数型, , , 

清空 ()
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “摘要库.edb”), , , , , , )
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (等于 (读 (“所在分类”), “”))
        .加入项目 (读 (“摘要名称”), , , )
    .如果真结束
    .计次循环首 (取项目数 (), 循环记次用变量)
        .如果真 (等于 (读 (“所在分类”), 相减 (循环记次用变量, 1).取项目文本 ()))
            相减 (循环记次用变量, 1).加入项目 (读 (“摘要名称”), , , )
        .如果真结束
        
    .计次循环尾 ()
    跳过 ()
.判断循环尾 ()
.计次循环首 (取项目数 (), 循环记次用变量)
    相减 (循环记次用变量, 1).收缩 ()
.计次循环尾 ()
0.扩展 ()
关闭 ()
赋值 (.最大化按钮, -1)
赋值 (摘要树型框当前选定文本, “”)
获取焦点 ()

.子程序 _增加摘要_被单击, 空白型, , 
.局部变量 临时变量, 文本型, , , 

.如果真 (等于 (摘要树型框当前选定文本, “”))
    赋值 (提示信息, “请先为新摘要选择分类！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
.如果真 (不等于 (摘要树型框当前选定文本的所在分类, “”))
    赋值 (提示信息, “请先为新摘要选择分类！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
输入框 (“输入要增设的摘要...”, , , 临时变量, )
.如果真 (等于 (临时变量, “”))
    返回 ()
.如果真结束
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “摘要库.edb”), , , , , , )
加记录 (临时变量, 摘要树型框当前选定文本)
关闭 ()
摘要树型框刷新子程序 ()

.子程序 _新建分类_被单击, 空白型, , 
.局部变量 新摘要名变量, 文本型, , , 

输入框 (“输入新摘要...”, , , 新摘要名变量, )
.如果真 (等于 (新摘要名变量, “”))
    返回 ()
.如果真结束
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “摘要库.edb”), , , , , , )
加记录 (新摘要名变量, “”)
关闭 ()
摘要树型框刷新子程序 ()

.子程序 _修改当前_被单击, 空白型, , 
.局部变量 新名变量, 文本型, , , 

.如果真 (等于 (摘要树型框当前选定文本, “”))
    赋值 (提示信息, “请选侧要修改的摘要！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
输入框 (“修改当前选定...”, , , 新名变量, )
.如果真 (等于 (新名变量, “”))
    返回 ()
.如果真结束
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “摘要库.edb”), , , , , , )
到首记录 ()
查找 (等于 (读 (“摘要名称”), 摘要树型框当前选定文本))
修改 (新名变量)
关闭 ()
摘要树型框刷新子程序 ()

.子程序 _删除当前_被单击, 空白型, , 
.局部变量 临时变量, 文本型, , , 

.如果真 (等于 (摘要树型框当前选定文本, “”))
    赋值 (提示信息, “请选侧要删除的摘要！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
赋值 (提示信息, 相加 (“是否要删除”, “  ”, 摘要树型框当前选定文本))
载入 (询问是否窗口, , 真)
.如果真 (等于 (询问是否窗口选择值, “不是”))
    返回 ()
.如果真结束
.如果真 (等于 (.是否有子项目 (.最大化按钮), 真))
    赋值 (提示信息, 相加 (摘要树型框当前选定文本, “  ，无法删除！（需先删除其下级科目）”))
    载入 (提示窗口, , 真)
    关闭 ()
    返回 ()
.如果真结束
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “摘要库.edb”), , , , , , )
到首记录 ()
查找 (等于 (读 (“摘要名称”), 摘要树型框当前选定文本))
删除 ()
彻底删除 ()
关闭 ()
摘要树型框刷新子程序 ()

.子程序 _摘要窗口_将被销毁, 空白型, , 
赋值 (摘要窗口是否被载入, 假)

.子程序 _将当前摘要插入到_被单击, 空白型, , 
赋值 (摘要窗口是否需要传递, 真)
.如果真 (等于 (.内容, “”))
    赋值 (提示信息, “请输入或选择摘要！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
赋值 (摘要树型框当前选定文本, .内容)
销毁 ()

.子程序 _插入空白_被单击, 空白型, , 
赋值 (摘要窗口是否需要传递, 真)
赋值 (摘要树型框当前选定文本, “”)
销毁 ()

.子程序 _摘要树型框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (摘要窗口是否需要传递, 真)
销毁 ()

.窗口程序集 金额输入窗口程序集, , , 

.子程序 _金额输入窗口_创建完毕, 空白型, , 
获取焦点 ()
赋值 (金额输入窗口值, 0)

.子程序 _确定_被单击, 空白型, , 
赋值 (金额输入窗口值, 到数值 (.内容))
销毁 ()

.子程序 _清除_被单击, 空白型, , 
赋值 (.内容, “”)
销毁 ()

.子程序 _金额输入窗口_将被销毁, 空白型, , 
.如果真 (不等于 (.内容, “”))
    _确定_被单击 ()
.如果真结束


.子程序 _金额输入框_内容被改变, 空白型, , 
.如果真 (等于 (.内容, “-”))
    赋值 (.内容, “”)
    返回 ()
.如果真结束
.如果真 (等于 (取文本左边 (取文本右边 (.内容, 3), 1), “.”))
    获取焦点 ()
.如果真结束


.窗口程序集 附件输入窗口程序集, , , 

.子程序 _清除_被单击, 空白型, , 
销毁 ()

.子程序 _确定_被单击, 空白型, , 
赋值 (张数输入窗口值, 到数值 (.内容))
销毁 ()

.子程序 _张数输入窗口_创建完毕, 空白型, , 
获取焦点 ()
赋值 (张数输入窗口值, 0)

.窗口程序集 日期输入窗口程序集, , , 

.子程序 _日期输入窗口_创建完毕, 空白型, , 
获取焦点 ()

.子程序 _取消_被单击, 空白型, , 
.如果真 (等于 (编制凭证窗口..内容, “”))
    获取焦点 ()
    返回 ()
.如果真结束
销毁 ()

.子程序 _确定_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (日期输入窗口值, 到数值 (.内容))
销毁 ()

.子程序 _日期输入框_内容被改变, 空白型, , 
.如果真 (大于 (到数值 (.内容), 取某月天数 (取年份 (会计期间), 取月份 (会计期间))))
    赋值 (.内容, “”)
    返回 ()
.如果真结束
.如果真 (小于或等于 (到数值 (.内容), 0))
    赋值 (.内容, “1”)
    返回 ()
.如果真结束


.窗口程序集 月编号窗口程序集, , , 

.子程序 _月编号窗口_创建完毕, 空白型, , 
赋值 (.内容, 编制凭证窗口..内容)
赋值 (.内容, 编制凭证窗口..内容)
赋值 (.内容, 编制凭证窗口..内容)

.子程序 _取消_被单击, 空白型, , 
销毁 ()

.子程序 _确定_被单击, 空白型, , 
.如果真 (或者 (等于 (到数值 (.内容), 0), 等于 (到数值 (.内容), 0), 等于 (到数值 (.内容), 0)))
    返回 ()
.如果真结束

打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证库.edb”), , , , , 本账库密码, )
到首记录 ()
.如果真 (查找 (并且 (等于 (取年份 (读 (“日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“日期”)), 取月份 (会计期间)), 等于 (读 (“月编号”), 到数值 (.内容)))))
    赋值 (提示信息, “不能和现有编号相同！”)
    载入 (提示窗口, , 真)
    关闭 ()
    返回 ()
.如果真结束
关闭 ()
赋值 (编制凭证窗口..内容, .内容)
赋值 (编制凭证窗口..内容, .内容)
赋值 (编制凭证窗口..内容, .内容)
销毁 ()

.窗口程序集 登账结账窗口程序集, , , 

.子程序 _登账结账窗口_创建完毕, 空白型, , 
赋值 (.内容, “0”)
赋值 (.内容, “0”)
赋值 (.内容, “0”)
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证库.edb”), , , , , 本账库密码, )
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (查找 (并且 (等于 (取年份 (读 (“日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“日期”)), 取月份 (会计期间)))))
        赋值 (.内容, 到文本 (相加 (到数值 (.内容), 1)))
        .如果真 (不等于 (读 (“登账”), “”))
            赋值 (.内容, 到文本 (相加 (到数值 (.内容), 1)))
        .如果真结束
        .如果真 (等于 (读 (“审核”), “”))
            赋值 (.内容, 到文本 (相加 (到数值 (.内容), 1)))
        .如果真结束
        
    .如果真结束
    跳过 ()
.判断循环尾 ()
关闭 ()
.如果 (等于 (到数值 (.内容), 相加 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
.如果结束
.如果 (等于 (.内容, .内容))
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
.如果结束
结转损益列表框刷新 ()

.子程序 结转损益列表框刷新, 空白型, , 
.局部变量 几次变量, 整数型, , , 

全部删除 ()
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “结转损益.edb”), , , , , 本账库密码, )
到首记录 ()
.计次循环首 (取记录数 (), 几次变量)
    .插入表项 ()
    相减 (几次变量, 1).置标题 (0, 读 (“需要结转的科目”))
    相减 (几次变量, 1).置标题 (1, 读 (“对应科目”))
    跳过 ()
.计次循环尾 ()
关闭 ()

.子程序 _将已审核凭证按编号登账_被单击, 空白型, , 
.局部变量 几张凭证被登账, 整数型, , , 
.局部变量 当前凭证摘要数组, 文本型, , "4", 
.局部变量 当前凭证科目数组, 文本型, , "4", 
.局部变量 当前凭证借方金额数组, 双精度小数型, , "4", 
.局部变量 当前凭证贷方金额数组, 双精度小数型, , "4", 
.局部变量 计次变量, 整数型, , , 
.局部变量 借贷平呀, 文本型, , , 

赋值 (几张凭证被登账, 0)
置等待鼠标 ()
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”), , , , , 本账库密码, )
置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”))
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证库.edb”), , , , , 本账库密码, )
置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证库.edb”))
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (查找 (并且 (等于 (取年份 (读 (“日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“日期”)), 取月份 (会计期间)), 等于 (读 (“登账”), “”))))
        赋值 (当前凭证日期, 读 (“日期”))
        赋值 (当前凭证编号, 读 (“月编号”))
        赋值 (当前凭证摘要数组 [1], 读 (“摘要1”))
        赋值 (当前凭证摘要数组 [2], 读 (“摘要2”))
        赋值 (当前凭证摘要数组 [3], 读 (“摘要3”))
        赋值 (当前凭证摘要数组 [4], 读 (“摘要4”))
        赋值 (当前凭证科目数组 [1], 读 (“科目1”))
        赋值 (当前凭证科目数组 [2], 读 (“科目2”))
        赋值 (当前凭证科目数组 [3], 读 (“科目3”))
        赋值 (当前凭证科目数组 [4], 读 (“科目4”))
        赋值 (当前凭证借方金额数组 [1], 读 (“借方金额1”))
        赋值 (当前凭证借方金额数组 [2], 读 (“借方金额2”))
        赋值 (当前凭证借方金额数组 [3], 读 (“借方金额3”))
        赋值 (当前凭证借方金额数组 [4], 读 (“借方金额4”))
        赋值 (当前凭证贷方金额数组 [1], 负 (读 (“贷方金额1”)))
        赋值 (当前凭证贷方金额数组 [2], 负 (读 (“贷方金额2”)))
        赋值 (当前凭证贷方金额数组 [3], 负 (读 (“贷方金额3”)))
        赋值 (当前凭证贷方金额数组 [4], 负 (读 (“贷方金额4”)))
        赋值 (当前凭证审核, 读 (“审核”))
        .如果真 (等于 (当前凭证审核, “”))
            置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证库.edb”))
            关闭 ()
            置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库辅1.edb”))
            关闭 ()
            置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”))
            关闭 ()
            _登账结账窗口_创建完毕 ()
            返回 ()
        .如果真结束
        
        .计次循环首 (4, 计次变量)
            .如果真 (不等于 (当前凭证科目数组 [计次变量], “”))
                打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库辅1.edb”), , , , , 本账库密码, )
                置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库辅1.edb”))
                到首记录 ()
                .如果 (查找 (等于 (读 (“科目”), 当前凭证科目数组 [计次变量])))
                    赋值 (当前账借方余额, 读 (“借方”))
                    赋值 (当前账贷方余额, 读 (“贷方”))
                    赋值 (当前账余额, 读 (“余额”))
                .否则
                    
                    赋值 (当前账借方余额, 0)
                    赋值 (当前账贷方余额, 0)
                    赋值 (当前账余额, 0)
                .如果结束
                关闭 ()
                置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”))
                
                .如果真 (等于 (当前凭证贷方金额数组 [计次变量], 0)) ' 数在借方
                    .如果 (大于 (相加 (当前凭证借方金额数组 [计次变量], 当前账余额), 0))
                        赋值 (借贷平呀, “借”)
                    .否则
                        .如果 (小于 (相加 (当前凭证借方金额数组 [计次变量], 当前账余额), 0))
                            赋值 (借贷平呀, “贷”)
                        .否则
                            赋值 (借贷平呀, “平”)
                        .如果结束
                        
                    .如果结束
                    加记录 (当前凭证日期, 当前凭证编号, 当前凭证摘要数组 [计次变量], 当前凭证科目数组 [计次变量], 当前凭证借方金额数组 [计次变量], 当前凭证贷方金额数组 [计次变量], 借贷平呀, 相加 (当前凭证借方金额数组 [计次变量], 当前账余额))
                    打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库辅1.edb”), , , , , 本账库密码, )
                    置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库辅1.edb”))
                    到首记录 ()
                    .如果 (查找 (等于 (读 (“科目”), 当前凭证科目数组 [计次变量])))
                        
                    .否则
                        加记录 (当前凭证科目数组 [计次变量], , , , )
                    .如果结束
                    修改 (相加 (当前账借方余额, 当前凭证借方金额数组 [计次变量]), , 借贷平呀, 相加 (当前凭证借方金额数组 [计次变量], 当前账余额))
                    关闭 ()
                    
                .如果真结束
                .如果真 (等于 (当前凭证借方金额数组 [计次变量], 0)) ' 数在贷方
                    .如果 (大于 (相加 (当前凭证贷方金额数组 [计次变量], 当前账余额), 0))
                        赋值 (借贷平呀, “借”)
                    .否则
                        .如果 (小于 (相加 (当前凭证贷方金额数组 [计次变量], 当前账余额), 0))
                            赋值 (借贷平呀, “贷”)
                        .否则
                            赋值 (借贷平呀, “平”)
                        .如果结束
                        
                    .如果结束
                    加记录 (当前凭证日期, 当前凭证编号, 当前凭证摘要数组 [计次变量], 当前凭证科目数组 [计次变量], 当前凭证借方金额数组 [计次变量], 当前凭证贷方金额数组 [计次变量], 借贷平呀, 相加 (当前凭证贷方金额数组 [计次变量], 当前账余额))
                    打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库辅1.edb”), , , , , 本账库密码, )
                    置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库辅1.edb”))
                    到首记录 ()
                    .如果 (查找 (等于 (读 (“科目”), 当前凭证科目数组 [计次变量])))
                        
                    .否则
                        加记录 (当前凭证科目数组 [计次变量], , , , )
                    .如果结束
                    修改 ( (), 相加 (当前账贷方余额, 当前凭证贷方金额数组 [计次变量]), 借贷平呀, 相加 (当前凭证贷方金额数组 [计次变量], 当前账余额))
                    关闭 ()
                .如果真结束
                
            .如果真结束
            
        .计次循环尾 ()
        置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证库.edb”))
        写 (“登账”, 当前用户)
        赋值 (几张凭证被登账, 相加 (几张凭证被登账, 1))
    .如果真结束
    跳过 ()
.判断循环尾 ()
置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证库.edb”))
关闭 ()
置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”))
关闭 ()
恢复鼠标 ()
赋值 (提示信息, 相加 (到文本 (几张凭证被登账), “张凭证被登账。”))
载入 (提示窗口, , 真)
_登账结账窗口_创建完毕 ()

.子程序 结转损益子程序, 空白型, , 
.局部变量 计次变量, 整数型, , , 
.局部变量 编号, 长整数型, , , 
.局部变量 临时余额, 双精度小数型, , , 
.局部变量 linshi, 逻辑型, , , 
.局部变量 临时日期, 日期时间型, , , 

赋值 (临时日期, 到时间 (相加 (到文本 (取年份 (会计期间)), “年”, 到文本 (取月份 (会计期间)), “月”, 到文本 (取某月天数 (取年份 (会计期间), 取月份 (会计期间))), “日”)))
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证库.edb”), , , , , 本账库密码, )
赋值 (编号, 取最大值 (读 (“月编号”), 并且 (等于 (取年份 (读 (“日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“日期”)), 取月份 (会计期间)))))
关闭 ()
.计次循环首 (取表项数 (), 计次变量)
    打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库辅1.edb”), , , , , 本账库密码, )
    .如果 (查找 (等于 (读 (“科目”), 相减 (计次变量, 1).取标题 (0))))
        赋值 (临时余额, 读 (“余额”))
    .否则
        赋值 (临时余额, 0)
    .如果结束
    关闭 ()
    打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证库.edb”), , , , , 本账库密码, )
    置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证库.edb”))
    .如果 (大于 (临时余额, 0))
        加记录 (相加 (编号, 计次变量), 1, 1, 临时日期, “结转损益”, “结转损益”, , , 相减 (计次变量, 1).取标题 (1), 相减 (计次变量, 1).取标题 (0), , , 取绝对值 (临时余额), , , , , 取绝对值 (临时余额), , , 取绝对值 (临时余额), 取绝对值 (临时余额), , ,  (), 当前用户, 当前用户, )
    .否则
        .如果 (小于 (临时余额, 0))
            加记录 (相加 (编号, 计次变量), 1, 1, 临时日期, “结转损益”, “结转损益”, , , 相减 (计次变量, 1).取标题 (0), 相减 (计次变量, 1).取标题 (1), , , 取绝对值 (临时余额), , , , , 取绝对值 (临时余额), , , 取绝对值 (临时余额), 取绝对值 (临时余额), , ,  (), 当前用户, 当前用户, )
            
        .否则
            
        .如果结束
        
    .如果结束
    关闭 ()
.计次循环尾 ()
_将已审核凭证按编号登账_被单击 ()
返回 ()

.子程序 _结转损益并期末结账_被单击, 空白型, , 
.局部变量 哪个科目, 文本型, , , 
.局部变量 本月借方发生额, 双精度小数型, , , 
.局部变量 本月贷方发生额, 双精度小数型, , , 
.局部变量 本月方向, 文本型, , , 
.局部变量 科目合计, 双精度小数型, , , 
.局部变量 本年借方发生额, 双精度小数型, , , 
.局部变量 本年贷方发生额, 双精度小数型, , , 
.局部变量 匿名局部变量_2990, 空白型, , , 
.局部变量 文本数组, 文本型, , "0", 
.局部变量 这条借方金额, 双精度小数型, , , 
.局部变量 这条贷方金额, 双精度小数型, , , 
.局部变量 借方累计额, 双精度小数型, , , 
.局部变量 贷方累计额, 双精度小数型, , , 
.局部变量 匿名局部变量_3379, 空白型, , , 
.局部变量 上期间年, 整数型, , , 
.局部变量 上期间月, 整数型, , , 
.局部变量 上月有的科目名, 文本型, , , 
.局部变量 上月有的科目名对应余额, 双精度小数型, , , 
.局部变量 上月有的科目名对应借方, 双精度小数型, , , 
.局部变量 上月有的科目名对应贷方, 双精度小数型, , , 
.局部变量 上月有的科目名对应方向, 文本型, , , 
.局部变量 匿名局部变量_3389, 空白型, , , 
.局部变量 期初余额, 双精度小数型, , , 

置等待鼠标 ()

赋值 (.禁止, 真)
赋值 (提示信息, 相加 (“当前会计期间为”, 到文本 (取年份 (会计期间)), “年”, 到文本 (取月份 (会计期间)), “月”, “，是否要结转本期损益并结账！”))
载入 (询问是否窗口, , 真)
.如果真 (等于 (询问是否窗口选择值, “不是”))
    赋值 (.禁止, 假)
    返回 ()
.如果真结束
置等待鼠标 ()
结转损益子程序 ()

 ' 开始结分类账
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”), , , , , 本账库密码, )
置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”))
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库辅1.edb”), , , , , 本账库密码, )
置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库辅1.edb”))
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    赋值 (哪个科目, 读 (“科目”))
    赋值 (本月方向, 读 (“方向”))
    赋值 (科目合计, 读 (“余额”))
    置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”))
    到首记录 ()
    赋值 (本月借方发生额, 0)
    赋值 (本月贷方发生额, 0)
    赋值 (本年借方发生额, 0)
    赋值 (本年贷方发生额, 0)
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果真 (查找 (并且 (等于 (读 (“科目”), 哪个科目), 等于 (取年份 (读 (“凭证日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“凭证日期”)), 取月份 (会计期间)), 不等于 (读 (“凭证编号”), 0))))
            赋值 (本月借方发生额, 相加 (本月借方发生额, 读 (“借方”)))
            赋值 (本月贷方发生额, 相加 (本月贷方发生额, 读 (“贷方”)))
        .如果真结束
        跳过 ()
    .判断循环尾 ()
    加记录 (到时间 (相加 (到文本 (取年份 (会计期间)), “年”, 到文本 (取月份 (会计期间)), “月”, 到文本 (取某月天数 (取年份 (会计期间), 取月份 (会计期间))), “日”)), 0, “本月合计”, 哪个科目, 本月借方发生额, 本月贷方发生额, 本月方向, 科目合计)
    .如果真 (等于 (取月份 (会计期间), 12))
        到首记录 ()
        .判断循环首 (等于 (尾记录后 (), 假))
            .如果真 (查找 (并且 (等于 (读 (“科目”), 哪个科目), 等于 (取年份 (读 (“凭证日期”)), 取年份 (会计期间)), 不等于 (读 (“凭证编号”), 0))))
                赋值 (本年借方发生额, 相加 (本年借方发生额, 读 (“借方”)))
                赋值 (本年贷方发生额, 相加 (本年贷方发生额, 读 (“贷方”)))
            .如果真结束
            跳过 ()
        .判断循环尾 ()
        加记录 (到时间 (相加 (到文本 (取年份 (会计期间)), “年”, 到文本 (取月份 (会计期间)), “月”, 到文本 (取某月天数 (取年份 (会计期间), 取月份 (会计期间))), “日”)), 0, “本年累计”, 哪个科目, 本年借方发生额, 本年贷方发生额, 本月方向, 科目合计)
        .如果 (等于 (本月方向, “借”))
            赋值 (本年借方发生额, 科目合计)
            赋值 (本年贷方发生额, 0)
        .否则
            .如果 (等于 (本月方向, “贷”))
                赋值 (本年借方发生额, 0)
                赋值 (本年贷方发生额, 科目合计)
                
            .否则
                .如果 (等于 (本月方向, “平”))
                    赋值 (本年借方发生额, 0)
                    赋值 (本年贷方发生额, 0)
                .否则
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        加记录 (到时间 (相加 (到文本 (相加 (取年份 (会计期间), 1)), “年1月1日”)), 0, “期初余额”, 哪个科目, 本年借方发生额, 本年贷方发生额, 本月方向, 科目合计)
        
    .如果真结束
    置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库辅1.edb”))
    跳过 ()
.判断循环尾 ()
置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”))
关闭 ()
置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库辅1.edb”))
关闭 ()
 ' 分类账结完

 ' 开始登总账
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”), , , , , 本账库密码, )
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库.edb”), , , , , 本账库密码, )
置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”))
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (查找 (并且 (等于 (取年份 (读 (“凭证日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“凭证日期”)), 取月份 (会计期间)), 不等于 (读 (“凭证编号”), 0))))
        赋值 (文本数组, 分割文本 (读 (“科目”), “→”, 1))
        赋值 (这条借方金额, 读 (“借方”))
        赋值 (这条贷方金额, 读 (“贷方”))
        
        置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库.edb”))
        到首记录 ()
        .如果 (查找 (并且 (等于 (取年份 (读 (“凭证日期”)), 取年份 (会计期间)), 等于 (读 (“科目”), 文本数组 [1]), 等于 (读 (“摘要”), “期初余额”))))
            赋值 (期初余额, 读 (“余额”))
        .否则
            赋值 (期初余额, 0)
        .如果结束
        到首记录 ()
        .如果 (查找 (并且 (等于 (取年份 (读 (“凭证日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“凭证日期”)), 取月份 (会计期间)), 等于 (读 (“科目”), 文本数组 [1]), 等于 (读 (“摘要”), “本月合计”))))
            
        .否则
            加记录 (到时间 (相加 (到文本 (取年份 (会计期间)), “年”, 到文本 (取月份 (会计期间)), “月”, 到文本 (取某月天数 (取年份 (会计期间), 取月份 (会计期间))), “日”)), 0, “本月合计”, 文本数组 [1], , , , )
        .如果结束
        写 (“借方”, 相加 (这条借方金额, 读 (“借方”)))
        写 (“贷方”, 相加 (这条贷方金额, 读 (“贷方”)))
        写 (“余额”, 相加 (读 (“借方”), 读 (“贷方”), 期初余额))
        .如果 (大于 (读 (“余额”), 0))
            写 (“方向”, “借”)
        .否则
            .如果 (小于 (读 (“余额”), 0))
                写 (“方向”, “贷”)
            .否则
                .如果 (等于 (读 (“余额”), 0))
                    写 (“方向”, “平”)
                    
                .否则
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
        到首记录 ()
        赋值 (借方累计额, 0)
        赋值 (贷方累计额, 0)
        .判断循环首 (等于 (尾记录后 (), 假))
            .如果真 (查找 (并且 (等于 (取年份 (读 (“凭证日期”)), 取年份 (会计期间)), 等于 (读 (“科目”), 文本数组 [1]), 或者 (等于 (读 (“摘要”), “本月合计”), 等于 (读 (“摘要”), “期初余额”)))))
                赋值 (借方累计额, 相加 (读 (“借方”), 借方累计额))
                赋值 (贷方累计额, 相加 (读 (“贷方”), 贷方累计额))
            .如果真结束
            跳过 ()
        .判断循环尾 ()
        到首记录 ()
        .如果 (查找 (并且 (等于 (取年份 (读 (“凭证日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“凭证日期”)), 取月份 (会计期间)), 等于 (读 (“科目”), 文本数组 [1]), 等于 (读 (“摘要”), “本年累计”))))
            
        .否则
            加记录 (到时间 (相加 (到文本 (取年份 (会计期间)), “年”, 到文本 (取月份 (会计期间)), “月”, 到文本 (取某月天数 (取年份 (会计期间), 取月份 (会计期间))), “日”)), 0, “本年累计”, 文本数组 [1], , , , )
        .如果结束
        写 (“借方”, 借方累计额)
        写 (“贷方”, 贷方累计额)
        .如果 (大于 (读 (“借方”), 负 (读 (“贷方”))))
            写 (“方向”, “借”)
            
        .否则
            .如果 (小于 (读 (“借方”), 负 (读 (“贷方”))))
                写 (“方向”, “贷”)
                
            .否则
                .如果 (等于 (读 (“借方”), 负 (读 (“贷方”))))
                    写 (“方向”, “平”)
                    
                .否则
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        写 (“余额”, 相加 (读 (“借方”), 读 (“贷方”)))
    .如果真结束
    置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”))
    跳过 ()
.判断循环尾 ()
置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”))
关闭 ()
置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库.edb”))
关闭 ()
 ' 开始登本月无发生额科目


复制文件 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库.edb”), 相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库-temp.edb”))

打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库.edb”), , , , , 本账库密码, )
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库-temp.edb”), , , , , 本账库密码, )
.如果 (等于 (取月份 (会计期间), 1))
    赋值 (上期间年, 相减 (取年份 (会计期间), 1))
    赋值 (上期间月, 12)
    
.否则
    赋值 (上期间年, 取年份 (会计期间))
    赋值 (上期间月, 相减 (取月份 (会计期间), 1))
    
.如果结束
置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库-temp.edb”))
到首记录 ()

.循环判断首 ()
    .如果真 (查找 (并且 (等于 (取年份 (读 (“凭证日期”)), 上期间年), 等于 (取月份 (读 (“凭证日期”)), 上期间月), 等于 (读 (“摘要”), “本年累计”))))
        赋值 (上月有的科目名, 读 (“科目”))
        赋值 (上月有的科目名对应借方, 读 (“借方”))
        赋值 (上月有的科目名对应贷方, 读 (“贷方”))
        赋值 (上月有的科目名对应方向, 读 (“方向”))
        赋值 (上月有的科目名对应余额, 读 (“余额”))
        置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库.edb”))
        到首记录 ()
        .如果真 (等于 (查找 (并且 (等于 (取年份 (读 (“凭证日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“凭证日期”)), 取月份 (会计期间)), 等于 (读 (“摘要”), “本年累计”), 等于 (读 (“科目”), 上月有的科目名))), 假))
            加记录 (到时间 (相加 (到文本 (取年份 (会计期间)), “年”, 到文本 (取月份 (会计期间)), “月”, 到文本 (取某月天数 (取年份 (会计期间), 取月份 (会计期间))), “日”)), 0, “本月合计”, 上月有的科目名, 0, 0, 上月有的科目名对应方向, 上月有的科目名对应余额, )
            加记录 (到时间 (相加 (到文本 (取年份 (会计期间)), “年”, 到文本 (取月份 (会计期间)), “月”, 到文本 (取某月天数 (取年份 (会计期间), 取月份 (会计期间))), “日”)), 0, “本年累计”, 上月有的科目名, 上月有的科目名对应借方, 上月有的科目名对应贷方, 上月有的科目名对应方向, 上月有的科目名对应余额, )
        .如果真结束
        
    .如果真结束
    置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库-temp.edb”))
    跳过 ()
.循环判断尾 (等于 (尾记录后 (), 假))

置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库-temp.edb”))
关闭 ()

 ' ---------------
.如果真 (等于 (取月份 (会计期间), 12))
    复制文件 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库.edb”), 相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库-temp.edb”))
    打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库.edb”), , , , , 本账库密码, )
    打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库-temp.edb”), , , , , 本账库密码, )
    
    置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库-temp.edb”))
    到首记录 ()
    .循环判断首 ()
        .如果真 (查找 (并且 (等于 (取年份 (读 (“凭证日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“凭证日期”)), 12), 等于 (读 (“摘要”), “本年累计”))))
            赋值 (哪个科目, 读 (“科目”))
            赋值 (本月方向, 读 (“方向”)) ' 该变量为借用！
            赋值 (期初余额, 读 (“余额”))
             ' -----------------------
            置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库.edb”))
            .如果 (大于 (期初余额, 0))
                赋值 (本年借方发生额, 期初余额)
                赋值 (本年贷方发生额, 0)
            .否则
                .如果 (小于 (期初余额, 0))
                    赋值 (本年借方发生额, 0)
                    赋值 (本年贷方发生额, 期初余额)
                .否则
                    .如果 (等于 (期初余额, 0))
                        赋值 (本年借方发生额, 0)
                        赋值 (本年贷方发生额, 0)
                    .否则
                        
                    .如果结束
                    
                .如果结束
                
            .如果结束
            加记录 (到时间 (相加 (到文本 (相加 (取年份 (会计期间), 1)), “年”, “1”, “月”, “1”, “日”)), 0, “期初余额”, 哪个科目, 本年借方发生额, 本年贷方发生额, 本月方向, 期初余额, )
        .如果真结束
        置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库-temp.edb”))
        跳过 ()
    .循环判断尾 (等于 (尾记录后 (), 假))
.如果真结束
置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库.edb”))
关闭 ()
置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库-temp.edb”))
关闭 ()

 ' 总账登完了

复制文件 (取运行目录 () ＋ “\” ＋ #数据目录 ＋ 当前套账 ＋ “\” ＋ “账库辅1.edb”, 取运行目录 () ＋ “\” ＋ #数据目录 ＋ 当前套账 ＋ “\” ＋ 到文本 (取年份 (会计期间)) ＋ “-” ＋ 到文本 (取月份 (会计期间)))

 ' ----------------------------------------------------------------------------------------------
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, #基本信息), , , , , #库密码, )
到首记录 ()
.如果 (等于 (取月份 (会计期间), 12))
    写 (“会计期间”, 到时间 (相加 (到文本 (相加 (取年份 (会计期间), 1)), “年”, “1月1日”)))
.否则
    写 (“会计期间”, 到时间 (相加 (到文本 (取年份 (会计期间)), “年”, 到文本 (相加 (取月份 (会计期间), 1)), “月”, “1日”)))
.如果结束
赋值 (会计期间, 读 (“会计期间”))
赋值 (工作窗口.标题, 相加 (#标题字, “  会计期间：”, 到文本 (取年份 (会计期间)), “年”, 到文本 (取月份 (会计期间)), “月”, “   用户：”, 当前用户, “  ”, 当前单位))
关闭 ()
销毁 ()
赋值 (提示信息, 相加 (“结转损益与登账完毕！”, #换行符, “会计期间进入：”, 到文本 (取年份 (会计期间)), “年”, 到文本 (取月份 (会计期间)), “月”))
载入 (提示窗口, , 真)

.子程序 _结转损益设置保护_被单击, 空白型, , 
.如果真 (等于 (.禁止, 假))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    返回 ()
.如果真结束
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
返回 ()

.子程序 _新建_被单击, 空白型, , 
载入 (结转损益设置窗口, , 真)
结转损益列表框刷新 ()

.子程序 _修改_被单击, 空白型, , 
.如果真 (等于 (.取标题 (., 0), “”))
    赋值 (提示信息, “请先选择要修改的对象！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束

载入 (结转损益设置窗口, , 真)
结转损益列表框刷新 ()

.子程序 _删除_被单击, 空白型, , 
.如果真 (等于 (.取标题 (., 0), “”))
    赋值 (提示信息, “请先选择要删除的对象！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
赋值 (提示信息, 相加 (.取标题 (., 0), “  >对应科目>  ”, .取标题 (., 1), #换行符, “真的要删除当前选定吗！？”))
载入 (询问是否窗口, , 真)
.如果真 (等于 (询问是否窗口选择值, “不是”))
    返回 ()
.如果真结束
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “结转损益.edb”), , , , , 本账库密码, )
查找 (等于 (读 (“需要结转的科目”), .取标题 (., 0)))
删除 ()
彻底删除 ()
关闭 ()
结转损益列表框刷新 ()

.窗口程序集 账页窗口程序集, , , 

.程序集变量 晕倒, 逻辑型, , , 
.子程序 _账页窗口_创建完毕, 空白型, , 
.如果真 (等于 (看吗账, “总账”))
    赋值 (账页窗口.标题, 相加 (看吗账, “窗口”))
.如果真结束
赋值 (.今天, 到时间 (相加 (到文本 (取年份 (会计期间)), “年”, 到文本 (取月份 (会计期间)), “月1日”)))
赋值 (.今天, 到时间 (相加 (到文本 (取年份 (会计期间)), “年”, 到文本 (取月份 (会计期间)), “月”, 到文本 (取某月天数 (取年份 (会计期间), 取月份 (会计期间))), “日”)))
相加 (取运行目录 (), “\”, #数据目录, “账页.grd”).从文件读 ()
.如果真 (等于 (取屏幕宽度 (), 1024))
    赋值 (.缩放比, 100)
.如果真结束
.如果真 (等于 (取屏幕宽度 (), 800))
    赋值 (.缩放比, 128)
.如果真结束
.如果真 (等于 (取屏幕宽度 (), 640))
    赋值 (.缩放比, 156)
.如果真结束
_选择科目编辑框_鼠标左键被按下 (0, 0, 0)

.子程序 刷新账页表格, 空白型, , 
.局部变量 开始行号, 长整数型, , , 
.局部变量 行号, 长整数型, , , 

1.删除行 (取行数 ())
相加 (取运行目录 (), “\”, #数据目录, “账页.grd”).从文件读 ()
账页表头刷新 ()
置等待鼠标 ()
连续赋值 (相加 (取行数 (), 1), 开始行号, 行号)
.如果真 (等于 (看吗账, “总账”))
    打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库.edb”), , , , , 本账库密码, )
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果真 (查找 (并且 (等于 (读 (“科目”), .内容), 大于或等于 (读 (“凭证日期”), .今天), 小于或等于 (读 (“凭证日期”), .今天))))
            .添加行 ()
            行号.加线条 (1, 1, 7, 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))
            行号.置文本 (1, 相加 (到文本 (取年份 (读 (“凭证日期”))), “-”, 到文本 (取月份 (读 (“凭证日期”))), “-”, 到文本 (取日 (读 (“凭证日期”)))))
            行号.置对齐方式 (1, , , #中左)
            
            行号.置文本 (3, 读 (“摘要”))
            行号.置对齐方式 (3, , , #中左)
            .如果真 (大于 (取文本长度 (读 (“摘要”)), 32))
                行号.置行高 (1, 96)
                .如果真 (大于 (取文本长度 (读 (“摘要”)), 64))
                    行号.置行高 (1, 192)
                .如果真结束
                
            .如果真结束
            .如果 (等于 (读 (“借方”), 0))
                行号.置文本 (4, “0”)
            .否则
                行号.置文本 (4, 数值到格式文本 (读 (“借方”), 2, 真))
            .如果结束
            行号.置对齐方式 (4, , , #中右)
            .如果 (等于 (读 (“贷方”), 0))
                行号.置文本 (5, “0”)
            .否则
                行号.置文本 (5, 数值到格式文本 (负 (读 (“贷方”)), 2, 真))
            .如果结束
            行号.置对齐方式 (5, , , #中右)
            行号.置文本 (6, 读 (“方向”))
            行号.置对齐方式 (6, , , #中中)
            .如果 (等于 (读 (“方向”), “贷”))
                行号.置文本 (7, 数值到格式文本 (负 (读 (“余额”)), 2, 真))
            .否则
                行号.置文本 (7, 数值到格式文本 (读 (“余额”), 2, 真))
            .如果结束
            行号.置对齐方式 (7, , , #中右)
            赋值 (行号, 相加 (行号, 1))
        .如果真结束
        跳过 ()
    .判断循环尾 ()
    关闭 ()
    返回 ()
.如果真结束
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”), , , , , 本账库密码, )
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (查找 (并且 (等于 (读 (“科目”), .内容), 大于或等于 (读 (“凭证日期”), .今天), 小于或等于 (读 (“凭证日期”), .今天))))
        .添加行 ()
        行号.加线条 (1, 1, 7, 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))
        行号.置文本 (1, 相加 (到文本 (取年份 (读 (“凭证日期”))), “-”, 到文本 (取月份 (读 (“凭证日期”))), “-”, 到文本 (取日 (读 (“凭证日期”)))))
        行号.置对齐方式 (1, , , #中左)
        行号.置文本 (2, 到文本 (读 (“凭证编号”)))
        .如果 (等于 (行号.取文本 (2), “0”))
            行号.置文本 (2, “”)
        .否则
            
        .如果结束
        行号.置对齐方式 (2, , , #中中)
        行号.置文本 (3, 读 (“摘要”))
        行号.置对齐方式 (3, , , #中左)
        .如果真 (大于 (取文本长度 (读 (“摘要”)), 32))
            行号.置行高 (1, 96)
            .如果真 (大于 (取文本长度 (读 (“摘要”)), 64))
                行号.置行高 (1, 192)
            .如果真结束
            
        .如果真结束
        .如果 (等于 (读 (“借方”), 0))
            行号.置文本 (4, “”)
            .如果真 (或者 (等于 (读 (“摘要”), “本月合计”), 等于 (读 (“摘要”), “本年累计”)))
                行号.置文本 (4, “0”)
            .如果真结束
            
        .否则
            行号.置文本 (4, 数值到格式文本 (读 (“借方”), 2, 真))
        .如果结束
        行号.置对齐方式 (4, , , #中右)
        .如果 (等于 (读 (“贷方”), 0))
            行号.置文本 (5, “”)
            .如果真 (或者 (等于 (读 (“摘要”), “本月合计”), 等于 (读 (“摘要”), “本年累计”)))
                行号.置文本 (5, “0”)
            .如果真结束
            
        .否则
            行号.置文本 (5, 数值到格式文本 (负 (读 (“贷方”)), 2, 真))
        .如果结束
        行号.置对齐方式 (5, , , #中右)
        行号.置文本 (6, 读 (“方向”))
        行号.置对齐方式 (6, , , #中中)
        .如果 (等于 (读 (“方向”), “贷”))
            行号.置文本 (7, 数值到格式文本 (负 (读 (“余额”)), 2, 真))
        .否则
            行号.置文本 (7, 数值到格式文本 (读 (“余额”), 2, 真))
        .如果结束
        行号.置对齐方式 (7, , , #中右)
        赋值 (行号, 相加 (行号, 1))
    .如果真结束
    跳过 ()
.判断循环尾 ()
关闭 ()

.子程序 _打印_被单击, 空白型, , 
打印预览 ()

.子程序 账页表头刷新, 空白型, , 
.如果 (等于 (看吗账, “总账”))
    1.置文本 (1, 相加 (“ 总账科目：”, .内容, “  ”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天)), “至”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天))))
.否则
    1.置文本 (1, 相加 (“ 明细科目：”, .内容, “  ”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天)), “至”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天))))
.如果结束
刷新 ()

.子程序 _选择科目编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (会计科目窗口, , 真)
赋值 (.内容, 会计科目窗口科目树型框当前选定文本)
获取焦点 ()

.子程序 _列出_被单击, 空白型, , 
.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “点击这里选择要查阅的科目”)))
    赋值 (提示信息, “请先选择会计科目！”)
    载入 (提示窗口, , 真)
    _选择科目编辑框_鼠标左键被按下 (0, 0, 0)
    返回 ()
.如果真结束
刷新账页表格 ()

.子程序 _账页表格_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (晕倒, 真))
    赋值 (传递来的日期, 到时间 (取光标行号 ().取文本 (1)))
    赋值 (传递来的月编号, 取光标行号 ().取文本 (2))
    赋值 (传递来的小编号, “1”)
    赋值 (是否到对应呀, 真)
    .如果真 (或者 (等于 (传递来的月编号, “编号”), 等于 (传递来的月编号, “”)))
        返回 ()
    .如果真结束
    载入 (编制凭证窗口, , 真)
    赋值 (晕倒, 假)
    返回 ()
.如果真结束
赋值 (晕倒, 真)
返回 ()

.子程序 _时钟1_周期事件, 空白型, , 
赋值 (晕倒, 假)

.子程序 _账页窗口_将被销毁, 空白型, , 
赋值 (看吗账, “”)


.子程序 _导出_被单击, 空白型, , 
.局部变量 计次临时, 整数型, , , 

置等待鼠标 ()
.如果 (未知支持库函数_0 ())
    
.否则
    赋值 (提示信息, 相加 (“您的计算机没有安装Microsoft Office Excel电子表格程序！”, #换行符, “导出报表需要 Excel2000 或 以上版本！”))
    载入 (提示窗口, , 真)
    返回 ()
.如果结束
赋值 (., 假)
赋值 (., 真)
未知支持库函数_4 ()
.未知支持库函数_6 ()

赋值 (., 1)
1.未知支持库函数_23 ()

.计次循环首 (取行数 (), 计次临时)
    赋值 (., 相加 (“a”, 到文本 (计次临时)))
    赋值 (., 相加 (“a”, 到文本 (计次临时)))
    赋值 (., 计次临时.取文本 (1))
    
    赋值 (., 相加 (“b”, 到文本 (计次临时)))
    赋值 (., 相加 (“b”, 到文本 (计次临时)))
    赋值 (., 计次临时.取文本 (2))
    
    赋值 (., 相加 (“c”, 到文本 (计次临时)))
    赋值 (., 相加 (“c”, 到文本 (计次临时)))
    赋值 (., 计次临时.取文本 (3))
    
    赋值 (., 相加 (“d”, 到文本 (计次临时)))
    赋值 (., 相加 (“d”, 到文本 (计次临时)))
    赋值 (., 计次临时.取文本 (4))
    
    赋值 (., 相加 (“e”, 到文本 (计次临时)))
    赋值 (., 相加 (“e”, 到文本 (计次临时)))
    赋值 (., 计次临时.取文本 (5))
    
    赋值 (., 相加 (“f”, 到文本 (计次临时)))
    赋值 (., 相加 (“f”, 到文本 (计次临时)))
    赋值 (., 计次临时.取文本 (6))
    
    赋值 (., 相加 (“g”, 到文本 (计次临时)))
    赋值 (., 相加 (“g”, 到文本 (计次临时)))
    赋值 (., 计次临时.取文本 (7))
    
.计次循环尾 ()
未知支持库函数_1 ()
未知支持库函数_3 ()


.窗口程序集 结转损益设置窗口程序集, , , 

.子程序 _取消_被单击, 空白型, , 
销毁 ()

.子程序 _结账前将要结转损益的科目编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (会计科目窗口, , 真)
赋值 (.内容, 会计科目窗口科目树型框当前选定文本)

.子程序 _对应科目编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (会计科目窗口, , 真)
赋值 (.内容, 会计科目窗口科目树型框当前选定文本)

.子程序 _确定_被单击, 空白型, , 
.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    赋值 (提示信息, “请先填写科目！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “结转损益.edb”), , , , , 本账库密码, )
到首记录 ()
.如果 (查找 (等于 (读 (“需要结转的科目”), .内容)))
    修改 (.内容)
.否则
    加记录 (.内容, .内容)
.如果结束
关闭 ()
销毁 ()

.子程序 _结转损益设置窗口_创建完毕, 空白型, , 
赋值 (.内容, 登账结账窗口.取标题 (., 登账结账窗口.., 0))
赋值 (.内容, 登账结账窗口.取标题 (., 登账结账窗口.., 1))

.窗口程序集 查阅凭证窗口程序集, , , 

.子程序 _查阅凭证窗口_创建完毕, 空白型, , 
赋值 (.今天, 到时间 (相加 (到文本 (取年份 (会计期间)), “年”, 到文本 (取月份 (会计期间)), “月1日”)))
赋值 (.今天, 到时间 (相加 (到文本 (取年份 (会计期间)), “年”, 到文本 (取月份 (会计期间)), “月”, 到文本 (取某月天数 (取年份 (会计期间), 取月份 (会计期间))), “日”)))


.子程序 _摘要内容包括编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (摘要窗口, , 真)
赋值 (.内容, 摘要树型框当前选定文本)
赋值 (.选中, 假)

.子程序 _摘要任意选择框_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (.选中, 真))
    载入 (摘要窗口, , 真)
    赋值 (.内容, 摘要树型框当前选定文本)
    赋值 (.选中, 假)
.否则
    赋值 (.内容, “[任意]”)
.如果结束


.子程序 _借方科目包括编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (会计科目窗口, , 真)
赋值 (.内容, 会计科目窗口科目树型框当前选定文本)
赋值 (.选中, 假)

.子程序 _借方科目任意选择框_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (.选中, 真))
    载入 (会计科目窗口, , 真)
    赋值 (.内容, 会计科目窗口科目树型框当前选定文本)
    赋值 (.选中, 假)
.否则
    赋值 (.内容, “[任意]”)
.如果结束


.子程序 _贷方科目包括编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (会计科目窗口, , 真)
赋值 (.内容, 会计科目窗口科目树型框当前选定文本)
赋值 (.选中, 假)

.子程序 _贷方科目任意选择框_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (.选中, 真))
    载入 (会计科目窗口, , 真)
    赋值 (.内容, 会计科目窗口科目树型框当前选定文本)
    赋值 (.选中, 假)
.否则
    赋值 (.内容, “[任意]”)
.如果结束


.子程序 _最小金额编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (金额输入窗口, , 真)
赋值 (.内容, 到文本 (金额输入窗口值))
赋值 (.选中, 假)

.子程序 _最大金额编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (金额输入窗口, , 真)
赋值 (.内容, 到文本 (金额输入窗口值))
赋值 (.选中, 假)

.子程序 _发生金额范围任意选择框_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.内容, “[任意]”)
赋值 (.内容, “[任意]”)

.子程序 _登账编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (用户列表窗口, , 真)
赋值 (.内容, 用户列表窗口返回文本)
赋值 (.选中, 假)


.子程序 _登账任意选择框_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (.选中, 真))
    载入 (用户列表窗口, , 真)
    赋值 (.内容, 用户列表窗口返回文本)
    赋值 (.选中, 假)
.否则
    赋值 (.内容, “[任意]”)
.如果结束


.子程序 _审核编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (用户列表窗口, , 真)
赋值 (.内容, 用户列表窗口返回文本)
赋值 (.选中, 假)

.子程序 _审核任意选择框_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (.选中, 真))
    载入 (用户列表窗口, , 真)
    赋值 (.内容, 用户列表窗口返回文本)
    赋值 (.选中, 假)
.否则
    赋值 (.内容, “[任意]”)
.如果结束


.子程序 _编制编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (用户列表窗口, , 真)
赋值 (.内容, 用户列表窗口返回文本)
赋值 (.选中, 假)

.子程序 _编制任意选择框_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (.选中, 真))
    载入 (用户列表窗口, , 真)
    赋值 (.内容, 用户列表窗口返回文本)
    赋值 (.选中, 假)
.否则
    赋值 (.内容, “[任意]”)
.如果结束


.子程序 _按条件查找_被单击, 空白型, , 
.局部变量 起始日期, 日期时间型, , , 
.局部变量 截至日期, 日期时间型, , , 
.局部变量 摘要内容包括, 文本型, , , 
.局部变量 最小金额, 双精度小数型, , , 
.局部变量 最大金额, 双精度小数型, , , 
.局部变量 循环变量, 长整数型, , , 

置等待鼠标 ()
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “[任意]”)
    赋值 (.选中, 真)
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “[任意]”)
    赋值 (.选中, 真)
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “[任意]”)
    赋值 (.选中, 真)
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “[任意]”)
    赋值 (.选中, 真)
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “[任意]”)
    赋值 (.选中, 真)
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “[任意]”)
    赋值 (.选中, 真)
.如果真结束
赋值 (循环变量, -1)
全部删除 ()
赋值 (起始日期, .今天)
赋值 (截至日期, .今天)
.如果 (等于 (.内容, “[任意]”))
    赋值 (最小金额, 0)
.否则
    赋值 (最小金额, 到数值 (.内容))
.如果结束
.如果 (等于 (.内容, “[任意]”))
    赋值 (最大金额, 999999999)
.否则
    赋值 (最大金额, 到数值 (.内容))
.如果结束

打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “凭证库.edb”), , , , , 本账库密码, )
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (查找 (并且 (大于或等于 (读 (“日期”), 起始日期), 小于或等于 (读 (“日期”), 截至日期), 大于或等于 (读 (“借方合计”), 最小金额), 小于或等于 (读 (“借方合计”), 最大金额))))
        .如果真 (或者 (等于 (读 (“摘要1”), .内容), 等于 (读 (“摘要2”), .内容), 等于 (读 (“摘要3”), .内容), 等于 (读 (“摘要4”), .内容), 等于 (.内容, “[任意]”)))
            .如果真 (或者 (并且 (等于 (读 (“科目1”), .内容), 不等于 (读 (“借方金额1”), 0)), 并且 (等于 (读 (“科目2”), .内容), 不等于 (读 (“借方金额2”), 0)), 并且 (等于 (读 (“科目3”), .内容), 不等于 (读 (“借方金额3”), 0)), 并且 (等于 (读 (“科目4”), .内容), 不等于 (读 (“借方金额4”), 0)), 等于 (.内容, “[任意]”)))
                .如果真 (或者 (并且 (等于 (读 (“科目1”), .内容), 不等于 (读 (“贷方金额1”), 0)), 并且 (等于 (读 (“科目2”), .内容), 不等于 (读 (“贷方金额2”), 0)), 并且 (等于 (读 (“科目3”), .内容), 不等于 (读 (“贷方金额3”), 0)), 并且 (等于 (读 (“科目4”), .内容), 不等于 (读 (“贷方金额4”), 0)), 等于 (.内容, “[任意]”)))
                    .如果真 (或者 (等于 (读 (“登账”), .内容), 等于 (.内容, “[任意]”)))
                        .如果真 (或者 (等于 (读 (“审核”), .内容), 等于 (.内容, “[任意]”)))
                            .如果真 (或者 (等于 (读 (“编制”), .内容), 等于 (.内容, “[任意]”)))
                                赋值 (循环变量, 相加 (循环变量, 1))
                                .插入表项 ()
                                循环变量.置标题 (0, 到文本 (读 (“日期”)))
                                循环变量.置标题 (1, 到文本 (读 (“月编号”)))
                                循环变量.置标题 (2, 到文本 (读 (“第几”)))
                                循环变量.置标题 (3, 到文本 (读 (“共几”)))
                                循环变量.置标题 (4, 读 (“摘要1”))
                                循环变量.置标题 (5, 到文本 (读 (“借方合计”)))
                            .如果真结束
                            
                        .如果真结束
                        
                    .如果真结束
                    
                .如果真结束
                
            .如果真结束
            
        .如果真结束
        
    .如果真结束
    跳过 ()
.判断循环尾 ()
关闭 ()
恢复鼠标 ()

.子程序 _时钟1_周期事件, 空白型, , 
.如果真 (等于 (.背景颜色, #红色))
    赋值 (.背景颜色, #黑色)
    返回 ()
.如果真结束
赋值 (.背景颜色, #红色)

.子程序 _查找凭证超级列表框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (传递来的日期, 到时间 (.取标题 (., 0)))
赋值 (传递来的月编号, .取标题 (., 1))
赋值 (传递来的小编号, .取标题 (., 2))
赋值 (是否到对应呀, 真)
载入 (编制凭证窗口, , 真)
返回 ()

.子程序 _打印全部_被单击, 空白型, , 
.局部变量 计次临时, 整数型, , , 

.计次循环首 (取表项数 (), 计次临时)
    赋值 (传递来的日期, 到时间 (相减 (计次临时, 1).取标题 (0)))
    赋值 (传递来的月编号, 相减 (计次临时, 1).取标题 (1))
    赋值 (传递来的小编号, 相减 (计次临时, 1).取标题 (2))
    赋值 (是否到对应呀, 真)
    赋值 (是否打印, 真)
    载入 (编制凭证窗口, , 真)
.计次循环尾 ()

.窗口程序集 用户列表窗口程序集, , , 

.子程序 _用户列表窗口_创建完毕, 空白型, , 
打开 (相加 (取运行目录 (), “\”, #数据目录, 刚选套账, “\”, #用户), , , , , 本账库密码, )
到首记录 ()
.判断循环首 (不等于 (尾记录后 (), 真))
    读 (“用户名”).加入项目 ()
    跳过 ()
.判断循环尾 ()
关闭 ()

.子程序 _用户列表框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (用户列表窗口返回文本, .取项目文本 (.现行选中项))
销毁 ()

.窗口程序集 密码修改窗口程序集, , , 

.子程序 _取消_被单击, 空白型, , 
销毁 ()

.子程序 _确定_被单击, 空白型, , 
.如果真 (等于 (.内容, .内容))
    打开 (相加 (取运行目录 (), “\”, #数据目录, 刚选套账, “\”, #用户), , , , , 本账库密码, )
    到首记录 ()
    查找 (等于 (读 (“用户名”), 当前用户))
    .如果真 (等于 (.内容, 读 (“密码”)))
        写 (“密码”, .内容)
        关闭 ()
        赋值 (提示信息, “新密码修改成功！”)
        载入 (提示窗口, , 真)
        销毁 ()
        返回 ()
    .如果真结束
    赋值 (提示信息, “原密码不正确！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
赋值 (提示信息, “新密码输入的两次结果不同！”)
载入 (提示窗口, , 真)
返回 ()

.窗口程序集 账务初始化窗口, , , 

.程序集变量 启用套账是否被按下, 逻辑型, , , 
.子程序 _账务初始化窗口_创建完毕, 空白型, , 
.局部变量 几次变量, 整数型, , , 
.局部变量 几次变量2, 整数型, , , 
.局部变量 几次变量3, 整数型, , , 

置等待鼠标 ()
赋值 (启用套账是否被按下, 假)
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, #会计科目), , , , , 本账库密码, )
到首记录 ()
.计次循环首 (取记录数 (), )
    .如果 (等于 (读 (“上级科目”), “”))
        .插入表项 ()
        相减 (几次变量, 1).置标题 (0, 读 (“科目名称”))
    .否则
        .计次循环首 (取表项数 (), 几次变量2)
            .如果真 (等于 (相减 (几次变量2, 1).取标题 (0), 读 (“上级科目”)))
                几次变量2.插入表项 ()
                几次变量2.置标题 (0, 读 (“科目名称”))
                跳出循环 ()
            .如果真结束
            
        .计次循环尾 ()
    .如果结束
    
    跳过 ()
.计次循环尾 ()
关闭 ()
 ' --------------
.如果真 (打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账务初始化.edb”), , , , , 本账库密码, ))
    .计次循环首 (取表项数 (), 几次变量3)
        到首记录 ()
        .如果真 (查找 (等于 (读 (“科目”), 相减 (几次变量3, 1).取标题 (0))))
            相减 (几次变量3, 1).置标题 (1, 到文本 (读 (“借方”)))
            相减 (几次变量3, 1).置标题 (2, 到文本 (读 (“贷方”)))
            相减 (几次变量3, 1).置标题 (3, 读 (“方向”))
            相减 (几次变量3, 1).置标题 (4, 到文本 (读 (“余额”)))
            .如果真 (等于 (相加 (到数值 (相减 (几次变量3, 1).取标题 (1)), 到数值 (相减 (几次变量3, 1).取标题 (2))), 0))
                相减 (几次变量3, 1).置标题 (1, “”)
                相减 (几次变量3, 1).置标题 (2, “”)
                相减 (几次变量3, 1).置标题 (3, “”)
                相减 (几次变量3, 1).置标题 (4, “”)
            .如果真结束
            
        .如果真结束
        
    .计次循环尾 ()
    关闭 ()
    
.如果真结束
初始化合计 ()

.子程序 _科目设置_被单击, 空白型, , 
.局部变量 几次变量2, 整数型, , , 
.局部变量 几次变量, 整数型, , , 

置等待鼠标 ()
载入 (会计科目窗口, , 真)
全部删除 ()
_账务初始化窗口_创建完毕 ()
 ' -------------
.计次循环首 (取表项数 (), )
    相减 (几次变量, 1).取标题 (0)
    .计次循环首 (取表项数 (), 几次变量2)
        .如果真 (近似等于 (相减 (几次变量2, 1).取标题 (0), 相加 (相减 (几次变量, 1).取标题 (0), “→”)))
            相减 (几次变量, 1).置标题 (1, “”)
            相减 (几次变量, 1).置标题 (2, “”)
            相减 (几次变量, 1).置标题 (3, “”)
            相减 (几次变量, 1).置标题 (4, “”)
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
.计次循环尾 ()
_保存修改_被单击 ()

.子程序 _超级列表框_左键单击表项, 空白型, , 
.局部变量 临时变量, 双精度小数型, , , 
.局部变量 临时数组, 整数型, , "0", 
.局部变量 几次变量, 整数型, , , 

赋值 (临时数组, 取被选择表项 ())

.计次循环首 (取表项数 (), 几次变量)
    几次变量.取标题 (0)
    .如果真 (近似等于 (几次变量.取标题 (0), 相加 (临时数组.取标题 ( [1], 0), “→”)))
        赋值 (提示信息, “本科目无需设置金额，如需请在其下级科目添加！”)
        载入 (提示窗口, , 真)
        返回 ()
    .如果真结束
    
.计次循环尾 ()
.如果真 (等于 (取数组成员数 (临时数组), 0))
    返回 ()
.如果真结束
.如果 (输入框 (相加 (“科目：”, 临时数组.取标题 ( [1], 0), “  的期初借方金额为......”), “ 借方”, 临时数组.取标题 ( [1], 1), 临时变量, #输入小数))
    临时数组.置标题 ( [1], 1, 到文本 (取绝对值 (四舍五入 (临时变量, 2))))
.否则
    
.如果结束
.如果 (输入框 (相加 (“科目：”, 临时数组.取标题 ( [1], 0), “  的期初贷方金额为......”), “ 贷方”, 临时数组.取标题 ( [1], 2), 临时变量, #输入小数))
    临时数组.置标题 ( [1], 2, 到文本 (取绝对值 (四舍五入 (临时变量, 2))))
.否则
    
.如果结束
.如果 (大于 (到数值 (临时数组.取标题 ( [1], 1)), 到数值 (临时数组.取标题 ( [1], 2))))
    临时数组.置标题 ( [1], 3, “借”)
    临时数组.置标题 ( [1], 4, 到文本 (相减 (到数值 (临时数组.取标题 ( [1], 1)), 到数值 (临时数组.取标题 ( [1], 2)))))
.否则
    .如果 (小于 (到数值 (临时数组.取标题 ( [1], 1)), 到数值 (临时数组.取标题 ( [1], 2))))
        临时数组.置标题 ( [1], 3, “贷”)
        临时数组.置标题 ( [1], 4, 到文本 (相减 (到数值 (临时数组.取标题 ( [1], 2)), 到数值 (临时数组.取标题 ( [1], 1)))))
    .否则
        .如果 (等于 (到数值 (临时数组.取标题 ( [1], 1)), 到数值 (临时数组.取标题 ( [1], 2))))
            临时数组.置标题 ( [1], 3, “平”)
            临时数组.置标题 ( [1], 4, “0”)
        .否则
            
        .如果结束
        
    .如果结束
    
.如果结束
.如果 (等于 (相加 (到数值 (临时数组.取标题 ( [1], 1)), 到数值 (临时数组.取标题 ( [1], 2))), 0))
    临时数组.置标题 ( [1], 1, “”)
    临时数组.置标题 ( [1], 2, “”)
    临时数组.置标题 ( [1], 3, “”)
    临时数组.置标题 ( [1], 4, “”)
.否则
    
.如果结束
初始化合计 ()

.子程序 初始化合计, 空白型, , 
.局部变量 几次变量, 整数型, , , 
.局部变量 借方合计变量, 双精度小数型, , , 
.局部变量 贷方合计变量, 双精度小数型, , , 

赋值 (借方合计变量, 0)
赋值 (贷方合计变量, 0)
.计次循环首 (取表项数 (), 几次变量)
    赋值 (借方合计变量, 相加 (到数值 (相减 (几次变量, 1).取标题 (1)), 借方合计变量))
    赋值 (贷方合计变量, 相加 (到数值 (相减 (几次变量, 1).取标题 (2)), 贷方合计变量))
.计次循环尾 ()
赋值 (.内容, 到文本 (借方合计变量))
赋值 (.内容, 到文本 (贷方合计变量))
.如果 (等于 (.内容, .内容))
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
.如果结束


.子程序 _保存修改_被单击, 空白型, , 
.局部变量 几次变量, 整数型, , , 

复制文件 (相加 (取运行目录 (), “\”, #数据目录, “账库.edb”), 相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账务初始化.edb”))
打开 (相加 (#数据目录, 当前套账, “\”, “账务初始化.edb”), , , , , #库密码, )
到首记录 ()
.计次循环首 (取表项数 (), 几次变量)
    加记录 (相减 (几次变量, 1).取标题 (0), 到数值 (相减 (几次变量, 1).取标题 (1)), 到数值 (相减 (几次变量, 1).取标题 (2)), 相减 (几次变量, 1).取标题 (3), 到数值 (相减 (几次变量, 1).取标题 (4)))
.计次循环尾 ()
置数据库密码 (本账库密码)
关闭 ()

.子程序 _启用套账_被单击, 空白型, , 
.局部变量 几次变量, 整数型, , , 
.局部变量 启用日期变量, 日期时间型, , , 
.局部变量 文本数组, 文本型, , "0", 
.局部变量 这条借方金额, 双精度小数型, , , 
.局部变量 这条贷方金额, 双精度小数型, , , 

_保存修改_被单击 ()
赋值 (提示信息, “是否启用当前套账？”)
载入 (询问是否窗口, , 真)
.如果真 (等于 (询问是否窗口选择值, “不是”))
    返回 ()
.如果真结束
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, #基本信息), , , , , #库密码, )
到首记录 ()
赋值 (启用日期变量, 到时间 (时间到文本 (读 (“启用日期”), #日期部分)))
关闭 ()
 ' -------------
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”), , , , , 本账库密码, )
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库辅1.edb”), , , , , 本账库密码, )
置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库辅1.edb”))
.计次循环首 (取表项数 (), 几次变量)
    .如果 (并且 (等于 (到数值 (相减 (几次变量, 1).取标题 (1)), 0), 等于 (到数值 (相减 (几次变量, 1).取标题 (2)), 0)))
        
    .否则
        置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”))
        加记录 (启用日期变量, 0, “期初余额”, 相减 (几次变量, 1).取标题 (0), 到数值 (相减 (几次变量, 1).取标题 (1)), 负 (到数值 (相减 (几次变量, 1).取标题 (2))), 相减 (几次变量, 1).取标题 (3), 取绝对值 (到数值 (相减 (几次变量, 1).取标题 (4))), )
        置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库辅1.edb”))
        加记录 (相减 (几次变量, 1).取标题 (0), 到数值 (相减 (几次变量, 1).取标题 (1)), 负 (到数值 (相减 (几次变量, 1).取标题 (2))), 相减 (几次变量, 1).取标题 (3), 取绝对值 (到数值 (相减 (几次变量, 1).取标题 (4))))
    .如果结束
    
.计次循环尾 ()

 ' 开始登总账
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”), , , , , 本账库密码, )
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库.edb”), , , , , 本账库密码, )
置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”))
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    赋值 (文本数组, 分割文本 (读 (“科目”), “→”, 1))
    赋值 (这条借方金额, 读 (“借方”))
    赋值 (这条贷方金额, 读 (“贷方”))
    
    置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库.edb”))
    到首记录 ()
    .如果 (查找 (并且 (等于 (取年份 (读 (“凭证日期”)), 取年份 (会计期间)), 等于 (取月份 (读 (“凭证日期”)), 取月份 (会计期间)), 等于 (读 (“科目”),  [1]), 等于 (读 (“摘要”), “期初余额”))))
        
    .否则
        加记录 (到时间 (相加 (到文本 (取年份 (会计期间)), “年”, 到文本 (取月份 (会计期间)), “月”, 到文本 (取某月天数 (取年份 (会计期间), 取月份 (会计期间))), “日”)), 0, “期初余额”,  [1],  (),  (),  (),  ())
    .如果结束
    写 (“借方”, 相加 (读 (“借方”)))
    写 (“贷方”, 相加 (读 (“贷方”)))
    .如果 (大于 (读 (“借方”), 取绝对值 (读 (“贷方”))))
        写 (“方向”, “借”)
        
    .否则
        .如果 (小于 (读 (“借方”), 取绝对值 (读 (“贷方”))))
            写 (“方向”, “贷”)
            
        .否则
            .如果 (等于 (读 (“借方”), 取绝对值 (读 (“贷方”))))
                写 (“方向”, “平”)
                
            .否则
                
            .如果结束
            
        .如果结束
        
    .如果结束
    写 (“余额”, 相加 (读 (“借方”), 读 (“贷方”)))
    到首记录 ()
    置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”))
    跳过 ()
.判断循环尾 ()
置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “账库.edb”))
关闭 ()
置当前库 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库.edb”))
关闭 ()
 ' 总账登完了

打开 (相加 (取运行目录 (), “\”, #数据目录, 刚选套账, “\”, #基本信息), , , , , #库密码, )
到首记录 ()
写 (“是否启用”, 真)
关闭 ()
赋值 (启用套账是否被按下, 真)
销毁 ()

.子程序 _账务初始化窗口_将被销毁, 空白型, , 
.如果真 (等于 (启用套账是否被按下, 假))
    _关闭套账_被选择 ()
.如果真结束


.窗口程序集 新建用户窗口程序集, , , 

.子程序 _用户列表_被单击, 空白型, , 
载入 (用户列表窗口, , 真)

.子程序 _确定_被单击, 空白型, , 
.局部变量 新账库密码, 文本型, , , 

.如果真 (等于 (.内容, “”))
    赋值 (提示信息, “用户名 必须填写！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
.如果真 (不等于 (.内容, .内容))
    赋值 (提示信息, “密码 与 效验  必须相同！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, #用户), , , , , 本账库密码, )
到首记录 ()
.如果真 (查找 (等于 (读 (“用户名”), 删首尾空 (.内容))))
    赋值 (提示信息, “新用户名与已有用户名不能相同！”)
    载入 (提示窗口, , 真)
    关闭 ()
    返回 ()
.如果真结束
赋值 (提示信息, 相加 (“是否创建用户：”, 删首尾空 (.内容), “  ？”, #换行符, “创建后将不能再删除！”))
载入 (询问是否窗口, , 真)
.如果真 (等于 (询问是否窗口选择值, “不是”))
    关闭 ()
    返回 ()
.如果真结束
加记录 (删首尾空 (.内容), .内容, 2)
关闭 ()
赋值 (提示信息, 相加 (删首尾空 (.内容), “ 用户创建完毕！”))
载入 (提示窗口, , 真)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)

.窗口程序集 报表窗口程序集, , , 

.程序集变量 年份, 整数型, , , 
.程序集变量 月份, 整数型, , , 
.子程序 _年份编辑框_放开某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (取文本长度 (.内容), 4))
    获取焦点 ()
.如果真结束


.子程序 _报表窗口_创建完毕, 空白型, , 
.如果 (等于 (取月份 (会计期间), 1))
    赋值 (.内容, 到文本 (相减 (取年份 (会计期间), 1)))
    赋值 (.内容, “12”)
.否则
    赋值 (.内容, 到文本 (取年份 (会计期间)))
    赋值 (.内容, 到文本 (相减 (取月份 (会计期间), 1)))
.如果结束


.子程序 _月份编辑框_放开某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (大于 (到数值 (.内容), 12))
    赋值 (.内容, “”)
    返回 ()
.如果真结束
.如果真 (小于 (到数值 (.内容), 1))
    赋值 (.内容, “”)
    返回 ()
.如果真结束


.子程序 _导出_被单击, 空白型, , 
.局部变量 行变量, 整数型, , , 
.局部变量 本月借方发生额, 双精度小数型, , , 
.局部变量 本月贷方发生额, 双精度小数型, , , 
.局部变量 临时文本对象, 对象, , , 
.局部变量 真假, 逻辑型, , , 
.局部变量 合计那行, 整数型, , , 
.局部变量 上月月份, 整数型, , , 
.局部变量 上月年份, 整数型, , , 
.局部变量 B列合计, 双精度小数型, , , 
.局部变量 C列合计, 双精度小数型, , , 
.局部变量 F列合计, 双精度小数型, , , 
.局部变量 G列合计, 双精度小数型, , , 

赋值 (年份, 到数值 (.内容))
赋值 (月份, 到数值 (.内容))
置等待鼠标 ()
 ' 检测时间
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, #基本信息), , , , , #库密码, )
到首记录 ()
.如果真 (或者 (大于 (到时间 (相加 (.内容, “-”, .内容, “-”, 到文本 (取某月天数 (到数值 (.内容), 到数值 (.内容))))), 会计期间), 小于 (到时间 (相加 (.内容, “-”, .内容, “-”, 到文本 (取某月天数 (到数值 (.内容), 到数值 (.内容))))), 读 (“启用日期”))))
    赋值 (提示信息, “无此月份数据！请检查！”)
    载入 (提示窗口, , 真)
    关闭 ()
    返回 ()
.如果真结束
关闭 ()

.如果 (未知支持库函数_0 ())
    
.否则
    赋值 (提示信息, 相加 (“您的计算机没有安装Microsoft Office Excel电子表格程序！”, #换行符, “导出报表需要 Excel2000 或 以上版本！”))
    载入 (提示窗口, , 真)
    返回 ()
.如果结束
赋值 (., 假)
赋值 (., 真)
未知支持库函数_4 ()
.未知支持库函数_6 ()
未知支持库函数_15 ()
相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “报表.xls”).未知支持库函数_14 ()

 ' 开始制作“科目汇总表”
赋值 (., 1)
1.未知支持库函数_23 ()

赋值 (., “a1”)
赋值 (., “az300”)
未知支持库函数_25 ()
赋值 (., “宋体”)
赋值 (., 15)
赋值 (., 18)
赋值 (., “G/通用格式”)
赋值 (., #黑色)
赋值 (., 12)
赋值 (., -4108)
赋值 (., -4131)

赋值 (., “a1”)
赋值 (., “c1”)
未知支持库函数_26 ()
赋值 (., 28)
赋值 (., “@”)
赋值 (., “科目汇总表”)
赋值 (., -4108)
赋值 (., 真)
赋值 (., 22)

赋值 (., “c2”)
赋值 (., “c2”)
赋值 (., “@”)
赋值 (., 相加 (.内容, “年”, .内容, “月”))
Excel工作簿1.内容 ＝ 年份编辑框.内容 ＋ “-” ＋ 月份编辑框.内容 ＋ “-” ＋ 到文本 (取某月天数 (到数值 (年份编辑框.内容), 到数值 (月份编辑框.内容)))
赋值 (., -4152)

赋值 (., “a3”)
赋值 (., “c3”)
未知支持库函数_26 ()
赋值 (., 相加 (“单位：”, 当前单位))
赋值 (., -4131)

赋值 (., “a4”)
赋值 (., “a4”)
赋值 (., -4108)
赋值 (., “会计科目”)
赋值 (., 真)
1.未知支持库函数_30 (2, #黑色)

赋值 (., “b4”)
赋值 (., “b4”)
赋值 (., -4108)
赋值 (., “借方发生额”)
赋值 (., 真)
1.未知支持库函数_30 (2, #黑色)

赋值 (., “c4”)
赋值 (., “c4”)
赋值 (., -4108)
赋值 (., “贷方发生额”)
赋值 (., 真)
1.未知支持库函数_30 (2, #黑色)

打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库.edb”), , , , , 本账库密码, )
到首记录 ()
赋值 (行变量, 5)
赋值 (本月借方发生额, 0)
赋值 (本月贷方发生额, 0)
.循环判断首 ()
    .如果真 (查找 (并且 (等于 (读 (“摘要”), “本月合计”), 等于 (取年份 (读 (“凭证日期”)), 到数值 (.内容)), 等于 (取月份 (读 (“凭证日期”)), 到数值 (.内容)))))
        赋值 (., 相加 (“a”, 到文本 (行变量)))
        赋值 (., 相加 (“a”, 到文本 (行变量)))
        赋值 (., 读 (“科目”))
        1.未知支持库函数_30 (2, #黑色)
        
        赋值 (., 相加 (“b”, 到文本 (行变量)))
        赋值 (., 相加 (“b”, 到文本 (行变量)))
        .如果真 (不等于 (取绝对值 (读 (“借方”)), 0))
            赋值 (., -4152)
            赋值 (., “#,##0.00”)
            赋值 (., 到文本 (取绝对值 (读 (“借方”))))
            赋值 (本月借方发生额, 相加 (本月借方发生额, 读 (“借方”)))
        .如果真结束
        1.未知支持库函数_30 (2, #黑色)
        
        赋值 (., 相加 (“c”, 到文本 (行变量)))
        赋值 (., 相加 (“c”, 到文本 (行变量)))
        .如果真 (不等于 (取绝对值 (读 (“贷方”)), 0))
            赋值 (., -4152)
            赋值 (., “#,##0.00”)
            赋值 (., 到文本 (取绝对值 (读 (“贷方”))))
            赋值 (本月贷方发生额, 相加 (本月贷方发生额, 读 (“贷方”)))
        .如果真结束
        1.未知支持库函数_30 (2, #黑色)
        
    .如果真结束
    跳过 ()
    赋值 (行变量, 相加 (行变量, 1))
.循环判断尾 (等于 (尾记录后 (), 假))
关闭 ()
赋值 (行变量, 相减 (行变量, 1))

赋值 (., 相加 (“a”, 到文本 (行变量)))
赋值 (., 相加 (“a”, 到文本 (行变量)))
赋值 (., “合计”)
赋值 (., -4108)
赋值 (., 真)
1.未知支持库函数_30 (2, #黑色)

赋值 (., 相加 (“b”, 到文本 (行变量)))
赋值 (., 相加 (“b”, 到文本 (行变量)))
赋值 (., -4152)
赋值 (., “#,##0.00”)
赋值 (., 到文本 (取绝对值 (本月借方发生额)))
赋值 (., 真)
1.未知支持库函数_30 (2, #黑色)

赋值 (., 相加 (“c”, 到文本 (行变量)))
赋值 (., 相加 (“c”, 到文本 (行变量)))
赋值 (., -4152)
赋值 (., “#,##0.00”)
赋值 (., 到文本 (取绝对值 (本月贷方发生额)))
赋值 (., 真)
1.未知支持库函数_30 (2, #黑色)

赋值 (., 相加 (“a”, 到文本 (相加 (行变量, 1))))
赋值 (., 相加 (“c”, 到文本 (相加 (行变量, 1))))
未知支持库函数_26 ()
赋值 (., 真)
赋值 (., -4152)
赋值 (., 相加 (“制表：”, 当前用户, “     ”, 时间到文本 (取现行时间 (), #日期部分)))

 ' ----------------------------------

打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “报表临时1.edb”), , , , , , )
清空 ()
清空 ()
赋值 (行变量, 4)
赋值 (真假, 真)
.循环判断首 ()
    赋值 (行变量, 相加 (行变量, 1))
    赋值 (., 相加 (“a”, 到文本 (行变量)))
    赋值 (., 相加 (“a”, 到文本 (行变量)))
    赋值 (临时文本对象, 未知支持库函数_13 ())
    加记录 (临时文本对象.读文本属性 (“Value”, ), , )
    .如果真 (等于 (临时文本对象.读文本属性 (“Value”, ), “合计”))
        赋值 (真假, 假)
    .如果真结束
    赋值 (., 相加 (“b”, 到文本 (行变量)))
    赋值 (., 相加 (“b”, 到文本 (行变量)))
    赋值 (临时文本对象, 未知支持库函数_13 ())
    写 (“借方”, 到数值 (临时文本对象.读文本属性 (“Value”, )))
    赋值 (., 相加 (“c”, 到文本 (行变量)))
    赋值 (., 相加 (“c”, 到文本 (行变量)))
    赋值 (临时文本对象, 未知支持库函数_13 ())
    写 (“贷方”, 到数值 (临时文本对象.读文本属性 (“Value”, )))
.循环判断尾 (真假)
关闭 ()

赋值 (., “a1”)
赋值 (., “a1”)
未知支持库函数_28 ()


 ' 开始制作“试算平衡表”
 ' -------------------------------------------------------------------------
赋值 (., 2)
2.未知支持库函数_23 ()

赋值 (., “a1”)
赋值 (., “az300”)
未知支持库函数_25 ()
赋值 (., “宋体”)
赋值 (., 9)
赋值 (., 13)
赋值 (., 10.7)
赋值 (., “G/通用格式”)
赋值 (., #黑色)
赋值 (., -4108)
赋值 (., -4152)

赋值 (., “a1”)
赋值 (., “a1”)
赋值 (., 12)

赋值 (., “a1”)
赋值 (., “g1”)
未知支持库函数_26 ()
赋值 (., 28)
赋值 (., “@”)
赋值 (., “试算平衡表”)
赋值 (., 真)
赋值 (., -4108)
赋值 (., 真)
赋值 (., 22)

赋值 (., “a2”)
赋值 (., “e2”)
未知支持库函数_26 ()
赋值 (., 相加 (“单位：”, 当前单位))
赋值 (., -4131)

赋值 (., “f2”)
赋值 (., “g2”)
未知支持库函数_26 ()
赋值 (., “@”)
赋值 (., 相加 (.内容, “年”, .内容, “月”))

赋值 (., “a3”)
赋值 (., “g4”)
赋值 (., -4108)
赋值 (., -4108)
赋值 (., 真)
1.未知支持库函数_30 (2, #黑色)

赋值 (., “a3”)
赋值 (., “a4”)
未知支持库函数_26 ()
赋值 (., “会计科目”)
1.未知支持库函数_30 (2, #黑色)

赋值 (., “b3”)
赋值 (., “c3”)
未知支持库函数_26 ()
赋值 (., “期初余额”)
1.未知支持库函数_30 (2, #黑色)

赋值 (., “d3”)
赋值 (., “e3”)
未知支持库函数_26 ()
赋值 (., “累计发生”)
1.未知支持库函数_30 (2, #黑色)

赋值 (., “f3”)
赋值 (., “g3”)
未知支持库函数_26 ()
赋值 (., “期末余额”)
1.未知支持库函数_30 (2, #黑色)

赋值 (., “h3”)
赋值 (., “i3”)
未知支持库函数_26 ()
赋值 (., “年初余额”)
赋值 (., #蓝色)
赋值 (., -4108)
赋值 (., 真)

赋值 (., “b4”)
赋值 (., “b4”)
赋值 (., “借方”)
1.未知支持库函数_30 (2, #黑色)

赋值 (., “c4”)
赋值 (., “c4”)
赋值 (., “贷方”)
1.未知支持库函数_30 (2, #黑色)

赋值 (., “d4”)
赋值 (., “d4”)
赋值 (., “借方”)
1.未知支持库函数_30 (2, #黑色)

赋值 (., “e4”)
赋值 (., “e4”)
赋值 (., “贷方”)
1.未知支持库函数_30 (2, #黑色)

赋值 (., “f4”)
赋值 (., “f4”)
赋值 (., “借方”)
1.未知支持库函数_30 (2, #黑色)

赋值 (., “g4”)
赋值 (., “g4”)
赋值 (., “贷方”)
1.未知支持库函数_30 (2, #黑色)

赋值 (., “h4”)
赋值 (., “h4”)
赋值 (., “借方”)
赋值 (., #蓝色)
赋值 (., -4108)
赋值 (., 真)

赋值 (., “i4”)
赋值 (., “i4”)
赋值 (., “贷方”)
赋值 (., #蓝色)
赋值 (., -4108)
赋值 (., 真)

打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “报表临时1.edb”), , , , , , )
到首记录 ()
赋值 (合计那行, 行变量)
赋值 (行变量, 4)
赋值 (本月借方发生额, 0)
赋值 (本月贷方发生额, 0)
.判断循环首 (等于 (尾记录后 (), 假))
    赋值 (行变量, 相加 (行变量, 1))
    赋值 (., 相加 (“a”, 到文本 (行变量)))
    赋值 (., 相加 (“a”, 到文本 (行变量)))
    赋值 (., 读 (“科目”))
    1.未知支持库函数_30 (2, #黑色)
    赋值 (., -4131)
    .如果真 (等于 (读 (“科目”), “合计”))
        赋值 (., -4108)
        赋值 (., 真)
    .如果真结束
    
    赋值 (., 相加 (“d”, 到文本 (行变量)))
    赋值 (., 相加 (“d”, 到文本 (行变量)))
    .如果真 (不等于 (取绝对值 (读 (“借方”)), 0))
        赋值 (., -4152)
        赋值 (., “#,##0.00”)
        赋值 (., 到文本 (取绝对值 (读 (“借方”))))
        赋值 (本月借方发生额, 相加 (本月借方发生额, 读 (“借方”)))
    .如果真结束
    1.未知支持库函数_30 (2, #黑色)
    
    赋值 (., 相加 (“e”, 到文本 (行变量)))
    赋值 (., 相加 (“e”, 到文本 (行变量)))
    .如果真 (不等于 (取绝对值 (读 (“贷方”)), 0))
        赋值 (., -4152)
        赋值 (., “#,##0.00”)
        赋值 (., 到文本 (取绝对值 (读 (“贷方”))))
        赋值 (本月贷方发生额, 相加 (本月贷方发生额, 读 (“贷方”)))
    .如果真结束
    1.未知支持库函数_30 (2, #黑色)
    跳过 ()
.判断循环尾 ()
关闭 ()

 ' --------------------------------------------------------------------

打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “总账库.edb”), , , , , 本账库密码, )
赋值 (行变量, 5)
赋值 (本月借方发生额, 0) ' 借用
赋值 (本月贷方发生额, 0) ' 借用
赋值 (B列合计, 0)
赋值 (C列合计, 0)
赋值 (F列合计, 0)
赋值 (G列合计, 0)
.如果 (等于 (月份, 1))
    赋值 (上月月份, 12)
    赋值 (上月年份, 相减 (年份, 1))
.否则
    赋值 (上月月份, 相减 (月份, 1))
    赋值 (上月年份, 年份)
.如果结束
.循环判断首 ()
    到首记录 ()
    查找 (等于 (取年份 (读 (“凭证日期”)), 年份))
    .如果真 (等于 (读 (“摘要”), “年初余额”))
        .如果 (等于 (读 (“方向”), “借”))
            赋值 (., 相加 (“h”, 到文本 (行变量)))
            赋值 (., 相加 (“h”, 到文本 (行变量)))
            赋值 (., 到文本 (取绝对值 (读 (“借方”))))
            赋值 (., “#,##0.00”)
            赋值 (本月借方发生额, 相加 (本月借方发生额, 取绝对值 (读 (“借方”))))
            赋值 (., #蓝色)
        .否则
            .如果 (等于 (读 (“方向”), “贷”))
                赋值 (., 相加 (“i”, 到文本 (行变量)))
                赋值 (., 相加 (“i”, 到文本 (行变量)))
                赋值 (., 到文本 (取绝对值 (读 (“贷方”))))
                赋值 (., “#,##0.00”)
                赋值 (本月贷方发生额, 相加 (本月贷方发生额, 取绝对值 (读 (“贷方”))))
                赋值 (., #蓝色)
            .否则
                
            .如果结束
            
        .如果结束
        
    .如果真结束
    查找 (并且 (等于 (取年份 (读 (“凭证日期”)), 年份), 等于 (取月份 (读 (“凭证日期”)), 月份)))
    赋值 (., 相加 (“a”, 到文本 (行变量)))
    赋值 (., 相加 (“a”, 到文本 (行变量)))
    赋值 (临时文本对象, 未知支持库函数_13 ())
    .如果真 (查找 (并且 (等于 (读 (“科目”), 临时文本对象.读文本属性 (“Value”, )), 等于 (取年份 (读 (“凭证日期”)), 上月年份), 等于 (取月份 (读 (“凭证日期”)), 上月月份), 等于 (读 (“摘要”), “本年累计”))))
        .如果 (等于 (读 (“方向”), “借”))
            赋值 (., 相加 (“b”, 到文本 (行变量)))
            赋值 (., 相加 (“b”, 到文本 (行变量)))
            赋值 (., 到文本 (取绝对值 (读 (“借方”))))
            赋值 (B列合计, 相加 (B列合计, 取绝对值 (读 (“借方”))))
        .否则
            .如果 (等于 (读 (“方向”), “贷”))
                赋值 (., 相加 (“c”, 到文本 (行变量)))
                赋值 (., 相加 (“c”, 到文本 (行变量)))
                赋值 (., 到文本 (取绝对值 (读 (“贷方”))))
                赋值 (C列合计, 相加 (C列合计, 取绝对值 (读 (“贷方”))))
            .否则
                
            .如果结束
            
        .如果结束
        
    .如果真结束
    .如果真 (查找 (并且 (等于 (读 (“科目”), 临时文本对象.读文本属性 (“Value”, )), 等于 (取年份 (读 (“凭证日期”)), 年份), 等于 (取月份 (读 (“凭证日期”)), 月份), 等于 (读 (“摘要”), “本年累计”))))
        .如果 (等于 (读 (“方向”), “借”))
            赋值 (., 相加 (“f”, 到文本 (行变量)))
            赋值 (., 相加 (“f”, 到文本 (行变量)))
            赋值 (., 到文本 (取绝对值 (读 (“借方”))))
            赋值 (F列合计, 相加 (F列合计, 取绝对值 (读 (“借方”))))
        .否则
            .如果 (等于 (读 (“方向”), “贷”))
                赋值 (., 相加 (“g”, 到文本 (行变量)))
                赋值 (., 相加 (“g”, 到文本 (行变量)))
                赋值 (., 到文本 (取绝对值 (读 (“贷方”))))
                赋值 (G列合计, 相加 (G列合计, 取绝对值 (读 (“贷方”))))
            .否则
                
            .如果结束
            
        .如果结束
        
    .如果真结束
    赋值 (., 相加 (“b”, 到文本 (行变量)))
    赋值 (., 相加 (“b”, 到文本 (行变量)))
    1.未知支持库函数_30 (2, #黑色)
    赋值 (., “#,##0.00”)
    赋值 (., 相加 (“c”, 到文本 (行变量)))
    赋值 (., 相加 (“c”, 到文本 (行变量)))
    1.未知支持库函数_30 (2, #黑色)
    赋值 (., “#,##0.00”)
    赋值 (., 相加 (“f”, 到文本 (行变量)))
    赋值 (., 相加 (“f”, 到文本 (行变量)))
    1.未知支持库函数_30 (2, #黑色)
    赋值 (., “#,##0.00”)
    赋值 (., 相加 (“g”, 到文本 (行变量)))
    赋值 (., 相加 (“g”, 到文本 (行变量)))
    1.未知支持库函数_30 (2, #黑色)
    赋值 (., “#,##0.00”)
    
    赋值 (行变量, 相加 (行变量, 1))
.循环判断尾 (不等于 (行变量, 合计那行))
关闭 ()

赋值 (., 相加 (“b”, 到文本 (行变量)))
赋值 (., 相加 (“b”, 到文本 (行变量)))
1.未知支持库函数_30 (2, #黑色)
赋值 (., 到文本 (B列合计))
赋值 (., “#,##0.00”)
赋值 (., 真)

赋值 (., 相加 (“c”, 到文本 (行变量)))
赋值 (., 相加 (“c”, 到文本 (行变量)))
1.未知支持库函数_30 (2, #黑色)
赋值 (., 到文本 (C列合计))
赋值 (., “#,##0.00”)
赋值 (., 真)

赋值 (., 相加 (“f”, 到文本 (行变量)))
赋值 (., 相加 (“f”, 到文本 (行变量)))
1.未知支持库函数_30 (2, #黑色)
赋值 (., 到文本 (F列合计))
赋值 (., “#,##0.00”)
赋值 (., 真)

赋值 (., 相加 (“g”, 到文本 (行变量)))
赋值 (., 相加 (“g”, 到文本 (行变量)))
1.未知支持库函数_30 (2, #黑色)
赋值 (., 到文本 (G列合计))
赋值 (., “#,##0.00”)
赋值 (., 真)

赋值 (., 相加 (“h”, 到文本 (行变量)))
赋值 (., 相加 (“h”, 到文本 (行变量)))
赋值 (., 到文本 (本月借方发生额))
赋值 (., “#,##0.00”)
赋值 (., 真)
赋值 (., #蓝色)

赋值 (., 相加 (“i”, 到文本 (行变量)))
赋值 (., 相加 (“i”, 到文本 (行变量)))
赋值 (., 到文本 (本月贷方发生额))
赋值 (., “#,##0.00”)
赋值 (., 真)
赋值 (., #蓝色)

赋值 (., 相加 (“b”, 到文本 (行变量)))
赋值 (., 相加 (“g”, 到文本 (行变量)))
赋值 (., 真)



赋值 (., 相加 (“a”, 到文本 (相加 (行变量, 1))))
赋值 (., 相加 (“g”, 到文本 (相加 (行变量, 1))))
未知支持库函数_26 ()
赋值 (., 真)
赋值 (., 相加 (“制表：”, 当前用户, “     ”, 时间到文本 (取现行时间 (), #日期部分)))





赋值 (., “a1”)
赋值 (., “a1”)
未知支持库函数_28 ()

 ' ----------------------


赋值 (., 真)
赋值 (报表窗口.位置, 2)
赋值 (报表窗口.可视, 假)

.子程序 _Excel程序1_工作簿即将关闭, 空白型, , 
.参数 工作簿对象, 对象, , 
.参数 取消关闭, 逻辑型, 参考, 

未知支持库函数_1 ()
未知支持库函数_3 ()
报表窗口.销毁 ()
工作窗口.激活 ()

.子程序 _报表窗口_可否被关闭, 逻辑型, , 
.局部变量 EXCEL程序1对象, 对象, , , 

赋值 (EXCEL程序1对象, 未知支持库函数_2 ())
.如果真 (等于 (EXCEL程序1对象.是否为空 (), 假))
    赋值 (提示信息, “EXCEL程序尚未退出！”)
    载入 (提示窗口, , 真)
    返回 (假)
.如果真结束
返回 (真)

.窗口程序集 出纳窗口程序集, , , 

.子程序 _出纳窗口_创建完毕, 空白型, , 
获取焦点 ()

.子程序 _收单选框_被单击, 空白型, , 
.如果真 (等于 (.选中, 真))
    载入 (收付科目窗口, , 真)
    赋值 (.内容, 会计科目窗口科目树型框当前选定文本)
    _金额编辑框_鼠标左键被按下 (0, 0, 0)
    _摘要编辑框_鼠标左键被按下 (0, 0, 0)
.如果真结束


.子程序 _付单选框_被单击, 空白型, , 
.如果真 (等于 (.选中, 真))
    载入 (收付科目窗口, , 真)
    赋值 (.内容, 会计科目窗口科目树型框当前选定文本)
    _金额编辑框_鼠标左键被按下 (0, 0, 0)
    _摘要编辑框_鼠标左键被按下 (0, 0, 0)
.如果真结束


.子程序 _收付科目编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (收付科目窗口, , 真)
赋值 (.内容, 会计科目窗口科目树型框当前选定文本)


.子程序 _金额编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (金额输入窗口, , 真)
赋值 (.内容, 到文本 (金额输入窗口值))

.子程序 _摘要编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (摘要窗口, , 真)
赋值 (.内容, 摘要树型框当前选定文本)


.子程序 _对方科目编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (会计科目窗口, , 真)
赋值 (.内容, 会计科目窗口科目树型框当前选定文本)


.子程序 _保存_被单击, 空白型, , 
.局部变量 金额, 双精度小数型, , , 
.局部变量 方向, 文本型, , , 
.局部变量 对应科目文本, 文本型, , , 

.如果真 (等于 (.内容, “对方科目（可不填写）”))
    赋值 (.内容, “”)
.如果真结束
.如果真 (并且 (不等于 (.选中, 真), 不等于 (.选中, 真)))
    赋值 (提示信息, “请选择收或付！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
.如果 (等于 (.选中, 真))
    赋值 (金额, 到数值 (.内容))
    赋值 (方向, “收”)
.否则
    赋值 (金额, 负 (到数值 (.内容)))
    赋值 (方向, “付”)
.如果结束
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “日记账库.edb”), , , , , 本账库密码, )
到尾记录 ()
.判断循环首 (或者 (不等于 (读 (“科目”), .内容), 等于 (首记录前 (), 真)))
    跳过 (-1)
    .如果真 (等于 (首记录前 (), 真))
        跳出循环 ()
    .如果真结束
    
.判断循环尾 ()
加记录 (.今天, .内容, 方向, 金额, 相加 (读 (“余额”), 金额), 当前用户, .内容, 对应科目文本)
关闭 ()
销毁 ()

.子程序 _检查_被单击, 空白型, , 
.如果真 (并且 (不等于 (.选中, 真), 不等于 (.选中, 真)))
    赋值 (提示信息, “请选择收或付！”)
    载入 (提示窗口, , 真)
    返回 ()
.如果真结束
.如果 (等于 (.禁止, 假))
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
    
.如果结束
返回 ()

.窗口程序集 收付科目窗口程序集, , , 

.子程序 _收付科目窗口_创建完毕, 空白型, , 
赋值 (会计科目窗口科目树型框当前选定文本, “”)
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, #会计科目), , , , , 本账库密码, )
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (查找 (或者 (近似等于 (读 (“科目名称”), “现金”), 近似等于 (读 (“科目名称”), “银行存款”))))
        读 (“科目名称”).加入项目 ()
    .如果真结束
    跳过 ()
.判断循环尾 ()
关闭 ()

.子程序 _收付科目列表框_列表项被选择, 空白型, , 
赋值 (会计科目窗口科目树型框当前选定文本, .取项目文本 (.现行选中项))
销毁 ()


.窗口程序集 日记帐窗口程序集, , , 

.子程序 _日记账窗口_创建完毕, 空白型, , 


.子程序 _选择科目编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (收付科目窗口, , 真)
赋值 (.内容, 会计科目窗口科目树型框当前选定文本)
获取焦点 ()

.子程序 _添加_被单击, 空白型, , 
载入 (出纳窗口, , 真)

.子程序 _列出_被单击, 空白型, , 
.局部变量 哪行, 整数型, , , 

.如果真 (等于 (.内容, “点击这里选择要查阅的科目”))
    _选择科目编辑框_鼠标左键被按下 (0, 0, 0)
.如果真结束
全部删除 ()
打开 (相加 (取运行目录 (), “\”, #数据目录, 当前套账, “\”, “日记账库.edb”), , , , , 本账库密码, )
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (查找 (并且 (等于 (读 (“科目”), .内容), 大于或等于 (到时间 (时间到文本 (读 (“日期”), #日期部分)), 到时间 (时间到文本 (.今天, #日期部分))), 小于或等于 (到时间 (时间到文本 (读 (“日期”), #日期部分)), 到时间 (时间到文本 (.今天, #日期部分))))))
        赋值 (哪行, -1.插入表项 (相加 (到文本 (取年份 (读 (“日期”))), “-”, 到文本 (取月份 (读 (“日期”))), “-”, 到文本 (取日 (读 (“日期”)))), , , , ))
        哪行.置标题 (1, 读 (“种类”))
        哪行.置标题 (2, 到文本 (读 (“金额”)))
        哪行.置标题 (3, 到文本 (读 (“余额”)))
        哪行.置标题 (4, 读 (“编制”))
        哪行.置标题 (5, 读 (“摘要”))
        哪行.置标题 (6, 读 (“对应”))
    .如果真结束
    跳过 ()
.判断循环尾 ()
关闭 ()

.子程序 _导出_被单击, 空白型, , 
.局部变量 计次临时, 整数型, , , 

置等待鼠标 ()
.如果 (未知支持库函数_0 ())
    
.否则
    赋值 (提示信息, 相加 (“您的计算机没有安装Microsoft Office Excel电子表格程序！”, #换行符, “导出报表需要 Excel2000 或 以上版本！”))
    载入 (提示窗口, , 真)
    返回 ()
.如果结束
赋值 (., 假)
赋值 (., 真)
未知支持库函数_4 ()
.未知支持库函数_6 ()

赋值 (., 1)
1.未知支持库函数_23 ()

.计次循环首 (取表项数 (), 计次临时)
    赋值 (., 相加 (“a”, 到文本 (计次临时)))
    赋值 (., 相加 (“a”, 到文本 (计次临时)))
    赋值 (., 相减 (计次临时, 1).取标题 (0))
    
    赋值 (., 相加 (“b”, 到文本 (计次临时)))
    赋值 (., 相加 (“b”, 到文本 (计次临时)))
    赋值 (., 相减 (计次临时, 1).取标题 (1))
    
    赋值 (., 相加 (“c”, 到文本 (计次临时)))
    赋值 (., 相加 (“c”, 到文本 (计次临时)))
    赋值 (., 相减 (计次临时, 1).取标题 (2))
    
    赋值 (., 相加 (“d”, 到文本 (计次临时)))
    赋值 (., 相加 (“d”, 到文本 (计次临时)))
    赋值 (., 相减 (计次临时, 1).取标题 (3))
    
    赋值 (., 相加 (“e”, 到文本 (计次临时)))
    赋值 (., 相加 (“e”, 到文本 (计次临时)))
    赋值 (., 相减 (计次临时, 1).取标题 (4))
    
    赋值 (., 相加 (“f”, 到文本 (计次临时)))
    赋值 (., 相加 (“f”, 到文本 (计次临时)))
    赋值 (., 相减 (计次临时, 1).取标题 (5))
    
    赋值 (., 相加 (“g”, 到文本 (计次临时)))
    赋值 (., 相加 (“g”, 到文本 (计次临时)))
    赋值 (., 相减 (计次临时, 1).取标题 (6))
    
.计次循环尾 ()
未知支持库函数_1 ()
未知支持库函数_3 ()

.窗口程序集 备份与恢复窗口程序集, , , 

.子程序 _备份单选框_被单击, 空白型, , 
赋值 (., 假)

.子程序 _恢复单选框_被单击, 空白型, , 
赋值 (., 假)

.子程序 _备份与恢复窗口_创建完毕, 空白型, , 
赋值 (., 真)

.子程序 _确定_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    .如果真 (等于 (打开 (), 真))
        赋值 (., 真)
        相加 (取运行目录 (), “\”, #数据目录, 当前套账).未知支持库函数_0 (.文件名)
    .如果真结束
    
.否则
    .如果真 (等于 (打开 (), 真))
        赋值 (., 真)
         ' .未知支持库函数_2 (.文件名, 相加 (取运行目录 (), “\”, #数据目录, 当前套账))
     ' .如果真结束
    
.如果结束
_关闭套账_被选择 ()
销毁 ()

.窗口程序集 关于世宝窗口程序集, , , 

.子程序 _关闭_被单击, 空白型, , 
销毁 ()

.子程序 _如何购买_被单击, 空白型, , 
运行 (相加 (取文本左边 (未知支持库函数_7 (#), 3), “Program Files\Internet Explorer\IEXPLORE.EXE www.shibao.net”), 假, )


 ' 不属于任何一个程序集、类模块的函数：
