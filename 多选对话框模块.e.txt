 ' 文件类型：未知类型

 ' 程序名称：多选文件对话框
 ' 程序描述：根据近在眼前的代码修改而成。
 ' 程序作者：精科软件
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.1
 ' 创建号：0.0





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 9 系统核心支持库




数据类型 文件对话框, , 
    .成员 lStructSize, 整数型, , , 
    .成员 hwndOwner, 整数型, , , 
    .成员 hInstance, 整数型, , , 
    .成员 lpstrFilter, 字节集, , , 
    .成员 lpstrCustomFilter, 文本型, , , 
    .成员 nMaxCustFilter, 整数型, , , 
    .成员 nFilterIndex, 整数型, , , 
    .成员 lpstrFile, 字节集, , , 
    .成员 nMaxFile, 整数型, , , 
    .成员 lpstrFileTitle, 文本型, , , 
    .成员 nMaxFileTitle, 整数型, , , 
    .成员 lpstrInitialDir, 文本型, , , 
    .成员 lpstrTitle, 文本型, , , 
    .成员 flags, 整数型, , , 
    .成员 nFileOffset, 短整数型, , , 
    .成员 nFileEtesion, 短整数型, , , 
    .成员 lpstrDefExt, 文本型, , , 
    .成员 lCustData, 整数型, , , 
    .成员 lpfnHook, 整数型, , , 
    .成员 lpTemplateName, 文本型, , , 


.DLL命令 打开对话框, 整数型, "comdlg32.dll", "GetOpenFileNameA", , 
    .参数 OpenFile, 文件对话框, , 

.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。

.子程序 打开多选对话框, 文本型, 公开, 如果多选文件，返回文件路径以“;”(半角分号)分隔。失败或取消返回空文本。
.参数 窗口句柄, 整数型, 可空, 调用处窗口句柄
.参数 窗口标题, 文本型, 可空, 对话框窗口标题
.参数 过滤器, 文本型, 可空, 格式：“MP3文件(*.mp3)|*.mp3|媒体文件(*.mpg)|*.mpg”
.参数 初始路径, 文本型, 可空, 可以被省略。如果本参数被省略，默认从“我的文档”开始。否则，请给出盘符，如“d:”
.参数 窗口风格, 整数型, 可空, 可以被省略。如果本参数被省略，默认为 0 。位置值从 0 开始。从0－11之间，可以设置多种窗口风格。0.工具栏、只读选择框－未选中；1.工具栏、只读选择框－选中；2.工具栏；3.工具栏、只读选择框－未选中，帮助按钮；4.工具栏、只读选择框－选中，帮助按钮；5.工具栏，帮助按钮；6.普通风格、只读选择框－未选中；7.普通风格、只读选择框－选中；8.普通风格；9.普通风格、只读选择框－未选中，帮助按钮；10.普通风格、只读选择框－选中，帮助按钮；11.普通风格、帮助按钮。

.局部变量 文件列表, 文件对话框, , , 
.局部变量 文件名, 字节集, , , 
.局部变量 文件名数组, 文本型, , "0", 
.局部变量 XH, 整数型, , , 记录循环的次数
.局部变量 多选文件, 文本型, , , 
.局部变量 文件缓冲数, 整数型, , , 决定可以打开文件的个数，原为8192，可打开80个文件
.局部变量 窗口风格3, 整数型, , , 将524800－524863改成为0－20风格参数，方便用户选择

赋值 (文件缓冲数, 98192) ' 大小决定打开文件的数量，此可以打开200个文件
处理事件 ()
赋值 (文件列表.lStructSize, 76)
赋值 (文件列表.hwndOwner, 窗口句柄)
赋值 (文件列表.lpstrFilter, 相加 (子字节集替换 (到字节集 (过滤器), { 124 }, { 0 }, , ), { 0 }, { 0 }))
赋值 (文件列表.lpstrFile, 取空白字节集 (文件缓冲数)) ' 文件名缓冲区，决定能选择文件的多少，如果平均一个文件名100个字符，一次也可以选80多个文件了
赋值 (文件列表.nMaxFile, 文件缓冲数)
赋值 (文件列表.lpstrFileTitle, 取空白文本 (文件缓冲数))
赋值 (文件列表.nMaxFileTitle, 文件缓冲数)
赋值 (文件列表.lpstrInitialDir, 初始路径)
赋值 (文件列表.lpstrTitle, 窗口标题)
文件列表.flags ＝ 524800 ' 原来的
.判断开始 (等于 (窗口风格, 0))
    赋值 (窗口风格3, 524800)
.判断 (等于 (窗口风格, 1))
    赋值 (窗口风格3, 524801)
.判断 (等于 (窗口风格, 2))
    赋值 (窗口风格3, 524804)
.判断 (等于 (窗口风格, 3))
    赋值 (窗口风格3, 524816)
.判断 (等于 (窗口风格, 4))
    赋值 (窗口风格3, 524817)
.判断 (等于 (窗口风格, 5))
    赋值 (窗口风格3, 524820)
.判断 (等于 (窗口风格, 6))
    赋值 (窗口风格3, 524832)
.判断 (等于 (窗口风格, 7))
    赋值 (窗口风格3, 524833)
.判断 (等于 (窗口风格, 8))
    赋值 (窗口风格3, 524836)
.判断 (等于 (窗口风格, 9))
    赋值 (窗口风格3, 524848)
.判断 (等于 (窗口风格, 10))
    赋值 (窗口风格3, 524849)
.判断 (等于 (窗口风格, 11))
    赋值 (窗口风格3, 524852)
.默认
    
.判断结束
处理事件 ()

赋值 (文件列表.flags, 窗口风格3)
.如果 (不等于 (打开对话框 (文件列表), 0)) ' 打开文件成功
    赋值 (文件名, 文件列表.lpstrFile)
    赋值 (文件名, 取字节集左边 (文件名, 相减 (寻找字节集 (文件名, { 0, 0 }), 1)))
    .如果 (不等于 (寻找字节集 (文件名, { 0 }), -1)) ' 是否选择多个文件
        赋值 (文件名数组, 分割文本 (到文本 (子字节集替换 (文件名, { 0 }, { 124 }, , )), “|”, ))
        .如果真 (不等于 (取文本右边 (文件名数组 [1], 1), “\”)) ' 选择多个文件时，第一个数组为路径名，后面为不包括路径的文件名
            赋值 (文件名数组 [1], 相加 (文件名数组 [1], “\”))
        .如果真结束
        .计次循环首 (相减 (取数组成员数 (文件名数组), 1), XH)
            .如果 (不等于 (相减 (取数组成员数 (文件名数组), 1), XH)) ' 最后一个文件名不用加分隔字符“；”
                赋值 (多选文件, 相加 (多选文件, 文件名数组 [1], 文件名数组 [相加 (XH, 1)], “;”))
            .否则
                赋值 (多选文件, 相加 (多选文件, 文件名数组 [1], 文件名数组 [相加 (XH, 1)]))
            .如果结束
            
        .计次循环尾 ()
        返回 (多选文件) ' 返回多个文件名全路径用“;”分隔
    .否则
        返回 (到文本 (文件名)) ' 返回单个文件名全路径
    .如果结束
    
.否则
    返回 (“”) ' 取消返回空文本
.如果结束



 ' 不属于任何一个程序集、类模块的函数：
