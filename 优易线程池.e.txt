 ' 文件类型：Windows模块源码

 ' 程序名称：优易线程池
 ' 程序描述：
 ' 程序作者：qiuzhi
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 2 0 多线程支持库




数据类型 线程数据, , 
    .成员 任务处理函数, 子程序指针, , , 
    .成员 任务参数, 整数型, , , 
    .成员 线程句柄, 整数型, , , 


.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。



.类模块 线程池易版, , , 

.程序集变量 总线程个数, 整数型, , , 
.程序集变量 已运行线程数, 整数型, , , 
.程序集变量 已完成线程数, 整数型, , , 
.程序集变量 线程组, 线程数据, , "0", 
.程序集变量 时钟, 时钟, , , 
.程序集变量 最大运行线程, 整数型, , , 
.程序集变量 强制停止, 逻辑型, , , 
.程序集变量 当前状态, 整数型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
赋值 (已运行线程数, 0)
赋值 (已完成线程数, 0)
赋值 (总线程个数, 0)

.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 创建, 空白型, 公开, 
.参数 个数, 整数型, , 
.参数 占用时钟, 时钟, , 

赋值 (时钟, 占用时钟)
赋值 (强制停止, 假)
赋值 (当前状态, 1)
赋值 (最大运行线程, 个数)
赋值 (时钟.时钟周期, 1)

.子程序 投递任务, 空白型, 公开, 
.参数 任务处理函数, 子程序指针, , 
.参数 任务参数, 整数型, , 

.局部变量 小线程, 线程数据, , , 

赋值 (总线程个数, 相加 (总线程个数, 1))
赋值 (小线程.任务处理函数, 任务处理函数)
赋值 (小线程.任务参数, 任务参数)
加入成员 (线程组, 小线程)


.子程序 处理线程, 空白型, 公开, 
.局部变量 s, 子程序指针, , , 


.如果真 (等于 (强制停止, 真))
    赋值 (当前状态, 2)
    赋值 (已完成线程数, 相加 (已完成线程数, 1))
    返回 ()
.如果真结束

.如果真 (大于或等于 (相减 (已运行线程数, 已完成线程数), 最大运行线程))
    返回 ()
.如果真结束

赋值 (已运行线程数, 相加 (已运行线程数, 1))

.如果真 (大于 (已运行线程数, 总线程个数))
    赋值 (.时钟周期, 0)
    赋值 (0)
    返回 ()
.如果真结束

未知支持库函数_0 (线程组 [已运行线程数], 任务处理函数, 线程组 [已运行线程数], 任务参数, 线程组 [已运行线程数], 线程句柄)




.子程序 取运行中线程数, 整数型, 公开, 
返回 (相减 (已运行线程数, 已完成线程数))

.子程序 取完成线程数, 整数型, 公开, 
返回 (已完成线程数)

.子程序 结束标志, 空白型, 公开, 在线程处理程序后面必加
赋值 (已完成线程数, 相加 (已完成线程数, 1))
.如果真 (大于或等于 (已完成线程数, 总线程个数))
    赋值 (时钟.时钟周期, 0)
    赋值 (当前状态, 0)
.如果真结束


.子程序 状态, 整数型, 公开, 
返回 (当前状态)


.子程序 销毁, 空白型, 公开, 
赋值 (强制停止, 真)




 ' 不属于任何一个程序集、类模块的函数：
