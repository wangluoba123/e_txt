 ' 文件类型：Windows窗口程序

 ' 程序名称：学校智能管理系统
 ' 程序描述：
 ' 程序作者：阮允林
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 624
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 真
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “黄埔试验学校智能管理系统 V1.0 版”
    帮助文件名 = “”

窗口 前言
    左边 = 50
    顶边 = 50
    宽度 = 474
    高度 = 301
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 2
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\黄浦学校.e\前言_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “前言”
    帮助文件名 = “”

窗口 登录窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 400
    高度 = 272
    鼠标指针 = { 0,0,0,0 }
    标记 = “0”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 0
    底色 = 16119285 '  0xF5F5F5
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 真
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “用户登录”
    帮助文件名 = “”

窗口 密码修改窗口
    左边 = 50
    顶边 = 50
    宽度 = 223
    高度 = 204
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 0
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\黄浦学校.e\密码修改窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “密码修改”
    帮助文件名 = “”

窗口 系统设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 580
    高度 = 365
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “系统设置”
    帮助文件名 = “”

窗口 资料录入修改学生
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 资料变更窗口
    左边 = 50
    顶边 = 50
    宽度 = 552
    高度 = 215
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 评语录入窗口
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “评语录入”
    帮助文件名 = “”

窗口 系统配置窗口
    左边 = 50
    顶边 = 50
    宽度 = 513
    高度 = 251
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “系统配置”
    帮助文件名 = “”

窗口 离校说明窗口
    左边 = 50
    顶边 = 50
    宽度 = 286
    高度 = 105
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “离开本校的说明”
    帮助文件名 = “”

窗口 设置科目窗口
    左边 = 50
    顶边 = 50
    宽度 = 635
    高度 = 460
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “设置修改本校的课程科目”
    帮助文件名 = “”

窗口 自设毕业窗口
    左边 = 50
    顶边 = 50
    宽度 = 403
    高度 = 240
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 修改范例窗口
    左边 = 50
    顶边 = 50
    宽度 = 406
    高度 = 285
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “编辑评语范例”
    帮助文件名 = “”

窗口 资料录入修改教员
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 工资系统设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 680
    高度 = 170
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “工资管理设置”
    帮助文件名 = “”

窗口 改升级名窗口
    左边 = 50
    顶边 = 50
    宽度 = 255
    高度 = 125
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “升级班级”
    帮助文件名 = “”

窗口 放大照片窗口
    左边 = 50
    顶边 = 50
    宽度 = 360
    高度 = 500
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = 12607488 '  0xC06000
    最大化按钮 = 真
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “放大照片”
    帮助文件名 = “”

窗口 修改评语窗口
    左边 = 50
    顶边 = 50
    宽度 = 564
    高度 = 123
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “编辑评语”
    帮助文件名 = “”

窗口 自动排课窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 550
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “排课程序”
    帮助文件名 = “”

窗口 日志
    左边 = 50
    顶边 = 50
    宽度 = 472
    高度 = 398
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\黄浦学校.e\日志_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “使用日志！”
    帮助文件名 = “”

窗口 权限结构窗口
    左边 = 50
    顶边 = 50
    宽度 = 500
    高度 = 436
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “用户权限管理系统”
    帮助文件名 = “”

窗口 管理员登录窗口
    左边 = 50
    顶边 = 50
    宽度 = 462
    高度 = 239
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\黄浦学校.e\管理员登录窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “系统管理员登录......”
    帮助文件名 = “”

窗口 卡机设置管理 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 496
    高度 = 350
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “卡机设置管理”
    帮助文件名 = “”

窗口 毕业升级管理 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 517
    高度 = 355
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “报名毕业升级分班管理”
    帮助文件名 = “”

窗口 宿舍管理 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 496
    高度 = 355
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “宿舍设置管理”
    帮助文件名 = “”

窗口 伙食建帐窗口
    左边 = 0
    顶边 = 0
    宽度 = 780
    高度 = 536
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “伙食建帐管理”
    帮助文件名 = “”

窗口 凭证摘要窗口
    左边 = 50
    顶边 = 50
    宽度 = 377
    高度 = 330
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “凭证摘要”
    帮助文件名 = “”

窗口 会计科目窗口
    左边 = 50
    顶边 = 50
    宽度 = 473
    高度 = 349
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “会计科目”
    帮助文件名 = “”

窗口 费用报销窗口
    左边 = 0
    顶边 = 0
    宽度 = 780
    高度 = 535
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “费用报销管理”
    帮助文件名 = “”

窗口 报名单据窗口
    左边 = 50
    顶边 = 50
    宽度 = 648
    高度 = 500
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 6316128 '  0x606060
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “报名单据查询/打印”
    帮助文件名 = “”



.图片 课程表, " ' 已保存到：D:\易语言学习\Data\黄浦学校.e\课程表", , 
.图片 学籍表, " ' 已保存到：D:\易语言学习\Data\黄浦学校.e\学籍表", , 
.图片 教员表, " ' 已保存到：D:\易语言学习\Data\黄浦学校.e\教员表", , 
.图片 管理员数据, " ' 已保存到：D:\易语言学习\Data\黄浦学校.e\管理员数据", , 
.图片 学生数据, " ' 已保存到：D:\易语言学习\Data\黄浦学校.e\学生数据", , 
.图片 教员数据, " ' 已保存到：D:\易语言学习\Data\黄浦学校.e\教员数据", , 
.图片 工资表数据, " ' 已保存到：D:\易语言学习\Data\黄浦学校.e\工资表数据", , 
.图片 图片1, " ' 已保存到：D:\易语言学习\Data\黄浦学校.e\图片1", , 
.图片 , , , 
.常量 软件名, "“智能管理系统V1.2版”", , 
.常量 , , , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' ExtMenu 9909FBB013704cfa8FE7E739DB7172DE 1 6 超级菜单支持库
 ' mysql 7F54B9CE8887428dBA9CEEB94CEF4C72 2 1 MySql支持库
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库
 ' sock A6B983789F624b2cBDFD7D671249C097 1 0 网络通讯支持库
 ' eCompress 7B68736E818E41c5A28B0AE4D43C128C 1 0 压缩解压支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库
 ' EChartBar 9A3F84D7FDEB4a0486F2711D5104B7F7 1 6 数据图表支持库
 ' HtmlView 5014D8FA6DCA40b68FA626D8183666EB 1 1 超文本浏览框支持库
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 1 0 数据操作支持库一



 ' 所需要的模块
 ' 打印预览2.451 $打印预览2.45(注册表配置).ec


数据类型 超级列表框背景图片, , 
    .成员 应用, 整数型, , , 0为清除
    .成员 hBmp, 整数型, , , 
    .成员 图片, 文本型, , , 图片路径
    .成员 cchImageMax, 整数型, , , 另外一个代码的这里是路径长度+1
    .成员 横向百分比, 整数型, , , 
    .成员 纵向百分比, 整数型, , , 

.全局变量 记录日志, 文本型, , , 
.全局变量 登录信息, 文本型, , "10", 
.全局变量 连接句柄, 整数型, , , 
.全局变量 学生分类, 文本型, , , 
.全局变量 修改资料, 逻辑型, , , 
.全局变量 男, 整数型, , , 
.全局变量 女, 整数型, , , 
.全局变量 记录, 整数型, , , 
.全局变量 选择子夹, 整数型, , , 
.全局变量 教员去向, 文本型, , , 
.全局变量 搜索资料, 逻辑型, , , 
.全局变量 打印设置, 打印设置信息, , , 
.全局变量 匿名全局变量_1927, 空白型, , , 
.全局变量 学号位数, 整数型, , , 
.全局变量 风格类型, 整数型, , , 
.全局变量 校名, 文本型, , , 
.全局变量 菜单类型, 整数型, , , 
.全局变量 password, 文本型, , , 
.全局变量 采集类型, 整数型, , , 
.全局变量 处理类型, 整数型, , , 
.全局变量 当前学期, 文本型, , , 
.全局变量 端口句柄, 整数型, , , 

.DLL命令 取活动窗口句柄, 整数型, "user32", "GetActiveWindow", , 获得活动窗口的句柄

.DLL命令 发送消息, 整数型, "", "SendMessageA", , 
    .参数 窗口句柄, 整数型, , 
    .参数 信息值, 整数型, , 
    .参数 参数一, 整数型, , 
    .参数 参数二, 超级列表框背景图片, , 

.DLL命令 置父窗口, 整数型, "", "SetParent", , 
    .参数 控件句柄, 整数型, , 
    .参数 新父句柄, 整数型, , 

.DLL命令 打开端口, 整数型, "EastRiver", "OpenCommPort", , 打开串行端口句柄,调用失败返回-1,端口无效或在使用返回0.
    .参数 Port, 整数型, , 端口号，允许值1-256, 如: COM1=1, COM2=2...COM256=256
    .参数 BaudRate, 整数型, , 端口波特率，允许值：9600、19200、38400、通常是9600

.DLL命令 关闭端口句柄, 逻辑型, "kernel32", "CloseHandle", , 使用Windows API 函数CloseHandle(hObject: HANDLE): BOOL; 来关闭端口句柄
    .参数 hObject, 整数型, , 

.DLL命令 打开联接设备, 整数型, "EastRiver", "ConnectClock", , 联机成功,返回端口句柄,用于其它函数调用
    .参数 Port, 整数型, , 端口号,允许值: 1-256, 如: COM1=1, COM2=2...COM256=256
    .参数 BaudRate, 整数型, , 9600, 19200, 38400, 通常是9600
    .参数 clock_id, 整数型, , 值: 0-255, 由于机显示的机号实际上是两位16进制数,机号范围为: 0x00-0xFF

.DLL命令 断开联接设备, 逻辑型, "EastRiver", "DisConnectClock", , 返回True成功，返回False失败
    .参数 hPort, 整数型, , 端口句柄,通过调用[打开联接设备]函数得到.

.DLL命令 显式联机, 逻辑型, "EastRiver", "CallClock", , True表示联机成功,一般不需要直接调用此函数, 建议使用 ConnectClock 
    .参数 hPort, 整数型, , 端口句柄
    .参数 clock_id, 整数型, , 机号,允许值: 0-255,

.DLL命令 脱机, 逻辑型, "EastRiver", "UnCallClock", , True表示脱机成功
    .参数 hPort, 整数型, , 端口句柄,通过调用OpenCommPort函数得到

.DLL命令 修改机号, 逻辑型, "EastRiver", "SetClockID", , 如果返回为True表示调用成功，如果返回为False表示调用失败
    .参数 hPort, 整数型, , 端口句柄，ER-880系列需要联机ER-210-ER-830不需要联机
    .参数 new_id, 整数型, , 字符显示屏的机型不可以使用A--F的字符作机号0x00-0x09

.DLL命令 取标识字符, 逻辑型, "EastRiver", "ReadClockMark", , 如果返回为True表示调用成功，如果返回为False表示调用失败
    .参数 hPort, 整数型, , 端口句柄, 需要联机
    .参数 Mark, 文本型, , 返回的机具标识字符

.DLL命令 置标识字符, 逻辑型, "EastRiver", "SetClockMark", , 如果返回为True表示调用成功，如果返回为False表示调用失败
    .参数 hPort, 整数型, , 端口句柄, 需要联机
    .参数 Mark, 文本型, , 返回的机具标识字符

.DLL命令 置卡号长度变量, 逻辑型, "EastRiver", "SetCardLength", , 如果返回为True表示调用成功，如果返回为False表示调用失败
    .参数 hPort, 整数型, , 端口句柄, 需要联机
    .参数 dispLen, 整数型, , 新机具显示卡号位数
    .参数 dataLen, 整数型, , 新机具存储卡号位数

.DLL命令 取当前管理卡号码, 逻辑型, "EastRiver", "ReadManagerCard", , 如果返回为True表示调用成功，如果返回为False表示调用失败
    .参数 hPort, 整数型, , 端口句柄, 需要联机
    .参数 CardNo, 文本型, , 返回管理卡号码, 缓冲区需大於20字节长度

.DLL命令 置管理卡, 逻辑型, "EastRiver", "SetManagerCard", , 如果返回为True表示调用成功，如果返回为False表示调用失败
    .参数 hPort, 整数型, , 端口句柄,参数要通过函数OpenCommPort取得
    .参数 CardNo, 文本型, , 管理卡号码, 管理卡号只能是5位长度,不大于65535

.DLL命令 取工作模式, 逻辑型, "EastRiver", "ReadClockMode", , 如果返回为True表示调用成功，如果返回为False表示调用失败
    .参数 hPort, 整数型, , 端口句柄,参数要通过函数OpenCommPort取得
    .参数 mode, 整数型, , 设备的工作模式
    .参数 extraMode, 整数型, , 设备的扩展工作模式
    .参数 systemMode, 整数型, , 系统工作模式 7=1考勤机分时段打卡,7=0考勤机全天打卡

.DLL命令 置工作模式, 逻辑型, "EastRiver", "SetClockMode", , 如果返回为True表示调用成功，如果返回为False表示调用失败
    .参数 hPort, 整数型, , 端口句柄,参数要通过函数OpenCommPort取得
    .参数 mode, 整数型, , 设备的工作模式(低八位)
    .参数 ExtraMode, 整数型, , 设备的扩展工作模式
    .参数 systemMode, 整数型, , 系统工作模式 7=1考勤机分时段打卡,7=0考勤机全天打卡

.DLL命令 显示字符串, 逻辑型, "EastRiver", "ShowClockMessage", , 
    .参数 hPort, 整数型, ,  端口句柄, 需要联机
    .参数 Msg, 文本型, , 一行消息字符串,最多8个中文或是16个英文,自动对中
    .参数 bClearScreen, 逻辑型, , 是否先清屏
    .参数 Line, 整数型, , 显示行号,允许值: 1-4
    .参数 Duration, 双精度小数型, , 持续时间,单位秒

.DLL命令 置常态显示字符串, 逻辑型, "EastRiver", "SetClockNormalMessage", , 
    .参数 hPort, 整数型, ,  端口句柄, 需要联机
    .参数 Msg, 文本型, , 一行消息字符串,最多8个中文或是16个英文,自动对中

.DLL命令 取常态显示字符串, 逻辑型, "EastRiver", "ReadClockNormalMessage", , 
    .参数 hPort, 整数型, ,  端口句柄, 需要联机
    .参数 Msg, 文本型, , 返回机具常态消息,长度至少要大于20个字符

.DLL命令 置刷卡成功显示, 逻辑型, "EastRiver", "SetClockWelcomeMessage", , 
    .参数 hPort, 整数型, ,  端口句柄, 需要联机
    .参数 Msg, 文本型, , 刷卡欢迎消息,最多8个中文或是16个英文,自动对中

.DLL命令 取刷卡成功显示, 逻辑型, "EastRiver", "ReadClockWelcomeMessage", , 
    .参数 hPort, 整数型, ,  端口句柄, 需要联机
    .参数 Msg, 文本型, , 返回刷卡欢迎消息,长度至少要大于20个字符

.DLL命令 取设备时间, 逻辑型, "EastRiver", "ReadClockTime", , 返回为True表示调用成功，如果返回为False表示调用失败
    .参数 hPort, 整数型, , 端口句柄, 需要联机
    .参数 CurTime, 日期时间型, , 返回机具当前时间,VB的Date格式

.DLL命令 置设备时间, 逻辑型, "EastRiver", "SetClockTime", , 返回为True表示调用成功，如果返回为False表示调用失败
    .参数 hPort, 整数型, , 端口句柄, 需要联机
    .参数 SetTime, 日期时间型, , 新的时间,VB的Date格式

.DLL命令 取字符格式设备时间, 逻辑型, "EastRiver", "ReadClockTimeString", , 返回为True表示调用成功，如果返回为False表示调用失败
    .参数 hPort, 整数型, , 端口句柄, 需要联机
    .参数 TimeString, 文本型, , 返回机当前时间,格式:yy年MM月dd日hh时nn分ss秒

.DLL命令 置字符格式设备时间, 逻辑型, "EastRiver", "SetClockTimeString", , 返回为True表示调用成功，如果返回为False表示调用失败
    .参数 hPort, 整数型, , 端口句柄, 需要联机
    .参数 TimeString, 文本型, , 格式:yyyyMMddhhnnss(^2G+w)(yyyy年MM月dd日hh时nn分ss秒)增加一个星期值, w为星期值, 星期天为0, 星期一为1, 星期六为6

.DLL命令 置端口所有的时间, 逻辑型, "EastRiver", "SetPortAllClockTime", , 
    .参数 hPort, 整数型, , 端口句柄,  不联机
    .参数 SetTime, 日期时间型, , 新的时间, VB的Date格式

.DLL命令 置通告消息, 逻辑型, "EastRiver", "SetNotification", , 返回为True表示调用成功，如果返回为False表示调用失败
    .参数 hPort, 整数型, ,  端口句柄, 需要联机
    .参数 Msg, 文本型, , 消息文本, 可以带回车换行符, 最多允许255*16个英文字符
    .参数 nDay, 整数型, , 表示本通知消息的保留时间, 单位(天)
    .参数 WordWrap, 逻辑型, , 当每行超出屏幕宽度时是否自动换行,否则将截断显示

.DLL命令 置IC机密码, 逻辑型, "EastRiver", "SetSecurityCode", , 返回为True表示调用成功，如果返回为False表示调用失败
    .参数 hPort, 整数型, ,  端口句柄, 需要联机
    .参数 oldSecurity, 文本型, , 12位16进制机具旧密码, 若无旧密码, 则设为'FFFFFFFFFFFF'
    .参数 newSecurity, 文本型, , 12位16进制机具新密码, 若功能为删除旧密码, 则设为'FFFFFFFFFFFF'

.DLL命令 取当前客户代码, 逻辑型, "EastRiver", "ReadClientCode", , 
    .参数 hPort, 整数型, , 端口句柄, 需要联机
    .参数 ClientCode, 日期时间型, , 返回当前机具客户代码, IC卡信息存储块号

.DLL命令 置当前客户代码, 逻辑型, "EastRiver", "SetClientCode", , 
    .参数 hPort, 整数型, , 端口句柄, 需要联机
    .参数 ClientCode, 日期时间型, , 新的机具客户代码, IC卡信息存储块号

.DLL命令 读设备存储记录数, 逻辑型, "EastRiver", "ReadClockRecordTotal", , 
    .参数 hPort, 整数型, , 端口句柄, 需要联机
    .参数 data, 整数型, , 返回考勤记录数量

.DLL命令 读设备存储最大记录, 逻辑型, "EastRiver", "ReadMaxClockRecordTotal", , 返回为True表示调用成功，如果返回为False表示调用失败
    .参数 hPort, 整数型, , 端口句柄,需要联机
    .参数 data, 整数型, , 返回设备可以存储的最大考勤记录数

.DLL命令 置打卡时间间隔, 逻辑型, "EastRiver", "SetCardTimeInterval", , 返回为True表示调用成功，如果返回为False表示调用失败
    .参数 hPort, 整数型, , 端口句柄,需要联机
    .参数 timeInterval, 双精度小数型, , 返回打卡时间间隔, 单位秒

.DLL命令 置全天刷卡, 逻辑型, "EastRiver", "SetWholeTimeClock", , 返回为True表示调用成功，如果返回为False表示调用失败
    .参数 hPort, 整数型, , 端口句柄,需要联机

.DLL命令 取刷卡时间段, 整数型, "EastRiver", "ReadClockerTime", , 1-4:刷卡时间段个数 0=读取失败
    .参数 hPort, 整数型, , 端口句柄,需要联机
    .参数 Clocks, 整数型, , 返回打卡时间间隔, 单位秒
    .参数 ArraySize, 整数型, , 如果是VB或是C++需要传数组大小参数

.DLL命令 置刷卡时间段, 逻辑型, "EastRiver", "SetClockerTime", , 返回为True表示调用成功，最多返回4个时间段
    .参数 hPort, 整数型, , 端口句柄,需要联机
    .参数 startTime, 文本型, , 开始时间, 格式:hhmm, 范围:0000-2400
    .参数 ArraySize, 文本型, , 结束时间, 格式:hhmm, 范围:0000-2400

.DLL命令 置重复刷卡间隔, 逻辑型, "EastRiver", "SetRepeatClockerTime", , 返回为True表示调用成功，如果返回为False表示调用失败
    .参数 hPort, 整数型, , 端口句柄,需要联机
    .参数 timeLen, 整数型, , 时间间隔, 设置为 1-99 分钟

.DLL命令 取重复刷卡间隔, 逻辑型, "EastRiver", "ReadRepeatClockerTime", , 返回为True表示调用成功，如果返回为False表示调用失败
    .参数 hPort, 整数型, , 端口句柄,需要联机
    .参数 timeLen, 整数型, , 时间间隔, 设置为 1-99 分钟

.DLL命令 清除所有打铃时间, 逻辑型, "EastRiver", "ClearRing", , 返回为True表示调用成功，如果返回为False表示调用失败
    .参数 hPort, 整数型, , 端口句柄,需要联机

.DLL命令 取设备打铃时间, 整数型, "EastRiver", "ReadRing", , 1-32:有效打铃时间数量 0:失败！最多返回32个打铃
    .参数 hPort, 整数型, , 端口句柄,需要联机
    .参数 RingTimes, 整数型, 数组,  打铃时间数组, 最少需要32个单元
    .参数 ArraySize, 整数型, , VB或是C++需要传数组大小参数

.DLL命令 置设备打铃时间, 逻辑型, "EastRiver", "SetRing", , 返回为True表示调用成功，最多可以设置32次打铃
    .参数 hPort, 整数型, , 端口句柄,需要联机
    .参数 hour, 整数型, , 打铃的起始时间值为 : 0-23
    .参数 minute, 整数型, , 打铃的起始时间值为 : 0-59
    .参数 second, 整数型, , 打铃的起始时间值为 : 0-59
    .参数 ringTimeLen, 整数型, , 为打铃的持续时间, 数值为 1-60 秒

.DLL命令 批读数据, 整数型, "EastRiver", "BatchReadRecord", , 1-16:正确读取记录数 0:记录已读完 -1:错误
    .参数 hPort, 整数型, , 端口句柄,需要联机
    .参数 Records, 文本型, 数组, 返回记录数组, 最少需要16个单元
    .参数 ArraySize, 整数型, , 如果是VB或是C++需要传数组大小参数

.DLL命令 删除存储卡记录, 逻辑型, "EastRiver", "ClearAllReadCard", , 返回值为True表示删除成功，如果返回值为False表示删除失败
    .参数 hPort, 整数型, , 端口句柄,需要联机

.DLL命令 分帧取所有记录, 整数型, "EastRiver", "ReadAllRecord", , 0:无记录>0:成功读取记录数-1,-2:串行通信错误-3:校验错误-4 -5...
    .参数 hPort, 整数型, , 端口句柄,需要联机
    .参数 lpData, 子程序指针, , 指向欲传入回调函数DataProcess()的参数指针作为DataProcess()
    .参数 DataProcess, 整数型, , 指向结构 TReadData 的指针, 数据块包含一条记录
    .参数 Wait, 空白型, , 

.DLL命令 取最新刷卡号, 逻辑型, "EastRiver", "ReadLastCard", , 返回值为True表示调用成功，如果返回值为False表示调用失败
    .参数 hPort, 整数型, , 端口句柄,需要联机
    .参数 key, 文本型, , 返回读得的键盘按键值

.DLL命令 取键盘按键, 逻辑型, "EastRiver", "ReadKeyboardPressKey", , 返回值为True表示调用成功，如果返回值为False表示调用失败
    .参数 hPort, 整数型, , 端口句柄,需要联机
    .参数 key, 文本型, , 返回读得的键盘按键值

.DLL命令 控制开门, 逻辑型, "EastRiver", "SetDoorOpen", , 返回值为True表示调用成功，如果返回值为False表示调用失败
    .参数 hPort, 整数型, , 端口句柄,需要联机

.DLL命令 控制设备状态, 逻辑型, "EastRiver", "SetClockState", , 返回值为True表示调用成功，如果返回值为False表示调用失败
    .参数 hPort, 整数型, , 端口句柄,需要联机
    .参数 state, 整数型, , 状态码, 以二进制位控制

.DLL命令 控制报警器状态, 逻辑型, "EastRiver", "SetAlarm", , 返回值为True表示调用成功，如果返回值为False表示调用失败
    .参数 hPort, 整数型, , 端口句柄,需要联机
    .参数 Alarm, 逻辑型, , True:报警器报警 False:报警器关

.DLL命令 取读卡器感应区卡片代码, 逻辑型, "EastRiver", "GetCardOnReader", , 返回值为True表示调用成功，如果返回值为False表示调用失败
    .参数 hPort, 整数型, , 端口句柄,需要联机
    .参数 clock_id, 整数型, , 机号, 允许值:0-255
    .参数 Card, 整数型, , TCardInfo 指针，存储返回结果

.窗口程序集 A窗口程序集, , , 

.程序集变量 光标行, 整数型, , , 
.程序集变量 选择列, 整数型, , , 
.程序集变量 工资表, 文本型, , , 
.程序集变量 全局搜索, 逻辑型, , , 
.程序集变量 上次单击列, 整数型, , , 
.程序集变量 排序方式, 逻辑型, , , 
.程序集变量 离校原因, 文本型, , , 
.程序集变量 匿名程序集变量_4281, 空白型, , , 
.程序集变量 班级条件, 文本型, , , 
.程序集变量 学期条件, 文本型, , , 
.程序集变量 年份条件, 文本型, , , 
.程序集变量 考试类型, 文本型, , , 
.程序集变量 号码条件, 文本型, , , 
.程序集变量 匿名程序集变量_4282, 空白型, , , 
.程序集变量 号码, 文本型, , "0", 
.程序集变量 搜索条件, 文本型, , , 
.程序集变量 成绩表标题, 文本型, , , 
.程序集变量 工资表标题, 文本型, , , 
.程序集变量 是否修改, 逻辑型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 界面选项, 整数型, , , 
.局部变量 计次, 整数型, , , 

赋值 (风格类型, 到数值 (读配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “Style”, )))
赋值 (菜单类型, 到数值 (读配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “menu”, )))
未知支持库函数_0 (风格类型)
赋值 (., 菜单类型)
载入 (前言, , 真)
载入 (登录窗口, _启动窗口, 真)
 ' 设置背景 (读入文件 (取运行目录 () ＋ “\image\背景.bmp”), #灰色)
_启动窗口.移动 (0, 0, 取屏幕宽度 (), 取屏幕高度 ())
赋值 (学号位数, 到数值 (读配置项 (相加 (取运行目录 (), “\config.ini”), “xsda”, “no”, )))
设置背景 (相加 (取运行目录 (), “\1.jpg”), ) ' 设置超级列表框的背景图片
设置背景 (相加 (取运行目录 (), “\1.jpg”), ) ' 设置超级列表框的背景图片
设置背景 (相加 (取运行目录 (), “\1.jpg”), ) ' 设置超级列表框的背景图片
设置背景 (相加 (取运行目录 (), “\1.jpg”), ) ' 设置超级列表框的背景图片
设置背景 (相加 (取运行目录 (), “\1.jpg”), ) ' 设置超级列表框的背景图片
设置背景 (相加 (取运行目录 (), “\1.jpg”), ) ' 设置超级列表框的背景图片

.如果真 (等于 (文件是否存在 (相加 (取运行目录 (), “\config.ini”)), 假))
    写配置项 (相加 (取运行目录 (), “\config.ini”), “School”, “Name”, “(请设置学校名称)”)
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “Style”, “0”)
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Wages”, “工资表一”, “教员工资表”)
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Wages”, “工资表二”, “教员工资表”)
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Wages”, “工资表三”, “教员工资表”)
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Wages”, “工资表四”, “教员工资表”)
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Wages”, “工资表五”, “教员工资表”)
.如果真结束
赋值 (界面选项, 到数值 (读配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “Style”, “0”)))

.计次循环首 (8, 计次)
    置文件属性 (相加 (取运行目录 (), “\data\00”, 到文本 (计次), “.xsk”), 32)
.计次循环尾 ()
置文件属性 (相加 (取运行目录 (), “\config.ini”), 相加 (2, 32))

赋值 (.标题, 读配置项 (相加 (取运行目录 (), “\config.ini”), “school”, “Name”, ))
赋值 (.内容, 相加 (.标题, #软件名))
赋值 (.标题, 相加 (.标题, “学生就餐刷卡记录”))
赋值 (.标题, 相加 (.标题, “学生上学放学刷卡记录”))
2.置文本 (“当前状态：请选择操作”)
赋值 (校名, 读配置项 (相加 (取运行目录 (), “\config.ini”), “school”, “Name”, ))

.如果 (不等于 (取星期几 (取现行时间 ()), 1))
    3.置文本 (相加 (#软件名, “ 今天是”, 时间到文本 (取现行时间 (), 2), “  星期”, 数值到大写 (相减 (取星期几 (取现行时间 ()), 1), 真)))
.否则
    3.置文本 (相加 (#软件名, “ 今天是”, 时间到文本 (取现行时间 (), 2), “  星期日”))
.如果结束
连续赋值 (真, .禁止, .禁止)

赋值 (_启动窗口., 相加 (读配置项 (相加 (取运行目录 (), “\config.ini”), “School”, “Name”, ), #软件名, “  当前管理员:”, 读配置项 (相加 (取当前目录 (), “\myfial.ini”), “setup”, “SJSMC”, )))
.如果 (小于 (取月份 (取现行时间 ()), 8))
    赋值 (当前学期, “上学期”)
.否则
    赋值 (当前学期, “下学期”)
.如果结束
.如果 (并且 (大于 (取月份 (取现行时间 ()), 7), 小于 (取月份 (取现行时间 ()), 9)))
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
.如果结束
.如果 (并且 (大于或等于 (取月份 (取现行时间 ()), 1), 小于 (取月份 (取现行时间 ()), 3)))
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
.如果结束


.子程序 关闭列表背景, 空白型, , 
清除背景 ()
清除背景 ()
清除背景 ()
清除背景 ()
清除背景 ()
清除背景 ()

.子程序 回主界面, 空白型, , 
连续赋值 (真, .禁止, .禁止)
10.加入状态 (#禁止)
11.加入状态 (#禁止)
25.加入状态 (#禁止)
26.加入状态 (#禁止)
27.加入状态 (#禁止)
28.加入状态 (#禁止)
30.加入状态 (#禁止)
赋值 (.标题, “”)
赋值 (.查询SQL, “”)
连续赋值 (假, .选中)
2.置文本 (“当前状态：请选择操作”)
.如果 (不等于 (取星期几 (取现行时间 ()), 1))
    3.置文本 (相加 (“欢迎使用校务管理系统！”, “今天是”, 时间到文本 (取现行时间 (), 2), “  星期”, 数值到大写 (相减 (取星期几 (取现行时间 ()), 1), 真)))
.否则
    3.置文本 (相加 (“欢迎使用校务管理系统！”, “今天是”, 时间到文本 (取现行时间 (), 2), “  星期日”))
.如果结束
赋值 (.现行子夹, 0)


.子程序 写日志, 空白型, , 
.局部变量 时间, 日期时间型, , , 
.局部变量 取特定, 文本型, , , 

赋值 (时间, 取现行时间 ())
赋值 (取特定, 相加 (到文本 (取年份 (时间)), “-”, 到文本 (取月份 (时间)), “-”, 到文本 (取日 (时间)), “ ”, 到文本 (取小时 (时间)), “:”, 到文本 (取分钟 (时间)), “:”, 到文本 (取秒 (时间))))
赋值 (记录日志, 相加 (未知支持库函数_16 (), “:”, 转换为IP地址 (未知支持库函数_16 ()), “ ”, 记录日志, “ ”, 取特定))
.如果真 (等于 (连接句柄, 0))
    返回 ()
.如果真结束
未知支持库函数_3 (连接句柄, 相加 (“insert into rzjl set rz='”, 记录日志, “';”))

.子程序 _新增用户_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [20], “38”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束

未知支持库函数_2 (连接句柄)
_启动窗口.置文本 (., 0, “ 连接服务器断开！”)
赋值 (_启动窗口..时钟周期, 0)
载入 (权限结构窗口, , 真)

.子程序 _设置密码_被选择, 空白型, , 
赋值 (密码修改窗口., “修改密码”)
载入 (密码修改窗口, , 真)


.子程序 __启动窗口_尺寸被改变, 空白型, , 
赋值 (.可视, 假)
.移动 (取用户区宽度 (), 相减 (取用户区高度 (), .可视))
.判断开始 (小于 (_启动窗口., 800))
    赋值 (_启动窗口., 800)
.判断 (小于 (_启动窗口., 600))
    赋值 (_启动窗口., 600)
.默认
    
.判断结束
4.置宽度 (相减 (_启动窗口., 600))
0.移动 (取用户区宽度 (), 相减 (取用户区高度 (), .可视, .))
.移动 (取用户区宽度 (), 相乘 (取用户区高度 (), 0.6))
赋值 (.顶边, 相减 (相除 (取用户区高度 (), 2), 相除 (.高度, 2), 20))
赋值 (.顶边, 相减 (.顶边, 32))
相减 (.宽度, .宽度, 80).移动 (相减 (.高度, .高度), , )
相减 (.宽度, .宽度, 50).移动 (相加 (相减 (相除 (相减 (.高度, .顶边, .高度), 2), 相除 (.高度, 2)), .顶边, .高度), , )

连续赋值 (相减 (取用户区宽度 (), 4), .宽度, .宽度)
连续赋值 (相减 (.宽度, 4), .宽度, .宽度)

连续赋值 (相减 (取用户区宽度 (), 12), .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度)

连续赋值 (相减 (.宽度, 4), .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .)

赋值 (.左边, 相减 (.宽度, .宽度, 5))
赋值 (.左边, 相减 (.宽度, .宽度, 5))
赋值 (.左边, 相减 (.宽度, .宽度, 20))
 ' 进度 条1.顶边 ＝ 取用户区 高度 () － 进度条1.高度 － 2
.移动 (相减 (.宽度, 10), 相减 (.高度, 23))
.移动 (.宽度, 相减 (取用户区高度 (), .可视, ., .高度, 2))
.移动 (.宽度, 相减 (取用户区高度 (), .可视, ., .高度, 2))
.移动 (.宽度, 相减 (.高度, 37))
1.移动 (相减 (.宽度, 5), 相减 (.高度, 3))
.移动 (.宽度, 相减 (.高度, 37))
1.移动 (相减 (.宽度, 5), 相减 (.高度, 3))
赋值 (.高度, 相减 (.高度, 39))
赋值 (., 相减 (.高度, 40))
缩放成绩表 ()
设置列宽 ()

相减 (.宽度, .宽度, 15).移动 ()
相减 (.宽度, .宽度, 15).移动 ()
相减 (.宽度, .宽度, 20).移动 ()

变教员窗口 ()
变学生窗口 ()
赋值 (.可视, 真)


.子程序 设置列宽, 空白型, , 
.局部变量 计次, 整数型, , , 

连续赋值 (假, _启动窗口..字体大小, _启动窗口..字体大小, _启动窗口..字体大小)
_启动窗口.移动 (., , , _启动窗口..宽度, 相减 (_启动窗口..高度, 37))
_启动窗口.移动 (., , , _启动窗口..宽度, 相减 (_启动窗口..高度, 37))
_启动窗口.移动 (., , , _启动窗口..宽度, 相减 (_启动窗口..高度, 37))
_启动窗口.移动 (., , , _启动窗口..宽度, 相减 (_启动窗口..高度, 37))

_启动窗口.置列宽 (., 1, 相除 (_启动窗口., 11.1))
_启动窗口.置列宽 (., 2, 相除 (_启动窗口., 12))
_启动窗口.置列宽 (., 3, 相除 (_启动窗口., 15))
_启动窗口.置列宽 (., 4, 相除 (_启动窗口., 12.9))
_启动窗口.置列宽 (., 5, 相除 (_启动窗口., 8.8))
_启动窗口.置列宽 (., 6, 相除 (_启动窗口., 9.41))
_启动窗口.置列宽 (., 7, 相除 (_启动窗口., 7.27))
_启动窗口.置列宽 (., 8, 相除 (_启动窗口., 7.27))
_启动窗口.置列宽 (., 9, 相除 (_启动窗口., 7.27))

_启动窗口.置列宽 (., 1, 相除 (_启动窗口., 11.1))
_启动窗口.置列宽 (., 2, 相除 (_启动窗口., 12))
_启动窗口.置列宽 (., 3, 相除 (_启动窗口., 15))
_启动窗口.置列宽 (., 4, 相除 (_启动窗口., 12.9))
_启动窗口.置列宽 (., 5, 相除 (_启动窗口., 8.8))
_启动窗口.置列宽 (., 6, 相除 (_启动窗口., 9.41))
_启动窗口.置列宽 (., 7, 相除 (_启动窗口., 7.27))
_启动窗口.置列宽 (., 8, 相除 (_启动窗口., 7.27))
_启动窗口.置列宽 (., 9, 相除 (_启动窗口., 7.27))

_启动窗口.置列宽 (., 1, 相除 (_启动窗口., 12))
_启动窗口.置列宽 (., 2, 相除 (_启动窗口., 15))
_启动窗口.置列宽 (., 3, 相除 (_启动窗口., 12.9))
_启动窗口.置列宽 (., 4, 相除 (_启动窗口., 11.1))
_启动窗口.置列宽 (., 5, 相除 (_启动窗口., 9))
_启动窗口.置列宽 (., 6, 相除 (_启动窗口., 9))
_启动窗口.置列宽 (., 7, 相除 (_启动窗口., 7.27))
_启动窗口.置列宽 (., 8, 相除 (_启动窗口., 7.27))
_启动窗口.置列宽 (., 9, 相除 (_启动窗口., 7.27))

_启动窗口.置列宽 (., 1, 相除 (_启动窗口., 9))
.计次循环首 (11, 计次)
    _启动窗口.置列宽 (., 相加 (计次, 1), 相除 (_启动窗口., 13))
.计次循环尾 ()
连续赋值 (真, _启动窗口..字体大小, _启动窗口..字体大小, _启动窗口..字体大小)

.子程序 变教员窗口, 空白型, , 
连续赋值 (相除 (_启动窗口., 10), .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度)
连续赋值 (相除 (_启动窗口., 3.333), .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边, .左边, .左边, .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边, .左边, .左边, .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边, .左边, .左边, .左边, .左边, .左边)
相减 (相加 (.左边, .宽度), 1).移动 (相除 (_启动窗口., 5.71), )
.移动 (相减 (.高度, 260))
赋值 (.角度, 相加 (.左边, .宽度, 12))
.移动 (相减 (相加 (.左边, .宽度), .角度), 相减 (.高度, 260))
赋值 (.左边, 相加 (.角度, 5))


.子程序 变学生窗口, 空白型, , 
连续赋值 (相除 (_启动窗口., 10), .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度)
连续赋值 (相除 (_启动窗口., 3.333), .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边, .左边, .左边, .左边)

连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边, .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边, .左边, .左边, .左边)

相减 (相加 (.左边, .宽度), 1).移动 (相除 (_启动窗口., 5.71), )

连续赋值 (相除 (_启动窗口., 13.55), .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度)


连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边)
连续赋值 (相减 (相加 (.左边, .宽度), 1), .左边, .左边, .左边, .左边)

 ' 科目标签10.宽度 ＝ 学生照片框.左边 － 科目标签9.左边 － 科目标签9.宽度
 ' 连续赋值 (科目标签10.宽度, 期中标签10.宽度, 期末标签10.宽度)
 ' 连续赋值 (学生照片框.宽度 ÷ 2, 科目标签11.宽度, 期中标签11.宽度, 期末标签11.宽度, 科目标签12.宽度, 期中标签12.宽度, 期末标签12.宽度)


赋值 (.宽度, 相加 (.宽度, .宽度, .宽度, .宽度))
赋值 (.宽度, 相加 (.宽度, .宽度, .宽度, .宽度))

赋值 (.宽度, 相加 (相减 (.左边, .左边), 1))
赋值 (.宽度, 相加 (相减 (.左边, .左边), 1))

.移动 (相减 (.高度, .顶边, 10))
赋值 (.角度, 相加 (.左边, .宽度, 20))
.移动 (相减 (相加 (.左边, .宽度), .角度), 相减 (.高度, .顶边, 10))
赋值 (.左边, .角度)
赋值 (.左边, 相加 (.左边, .宽度, 3))
赋值 (.左边, 相加 (.左边, .宽度, .宽度, 3))


.子程序 __启动窗口_被激活, 空白型, , 
.判断开始 (等于 (.现行子夹, 1))
    赋值 (.倾斜, 相加 (.倾斜, 1))
    重画 ()
    赋值 (.倾斜, 相减 (.倾斜, 1))
.判断 (等于 (.现行子夹, 2))
    赋值 (.倾斜, 相加 (.倾斜, 1))
    重画 ()
    赋值 (.倾斜, 相减 (.倾斜, 1))
.判断 (等于 (.现行子夹, 3))
    赋值 (.倾斜, 相加 (.倾斜, 1))
    重画 ()
    赋值 (.倾斜, 相减 (.倾斜, 1))
.判断 (等于 (.现行子夹, 4))
    缩放成绩表 ()
.判断 (等于 (.现行子夹, 5))
    赋值 (.倾斜, 相加 (.倾斜, 1))
    重画 ()
    赋值 (.倾斜, 相减 (.倾斜, 1))
.判断 (等于 (.现行子夹, 6))
    赋值 (.倾斜, 相加 (.倾斜, 1))
    重画 ()
    赋值 (.倾斜, 相减 (.倾斜, 1))
.判断 (等于 (.现行子夹, 8))
    赋值 (.倾斜, 相加 (.倾斜, 1))
    重画 ()
    赋值 (.倾斜, 相减 (.倾斜, 1))
.默认
    
.判断结束


.子程序 缩放成绩表, 空白型, , 
赋值 (.缩放比, 100)
获取焦点 ()

.子程序 __启动窗口_被取消激活, 空白型, , 
获取焦点 ()

.子程序 _教务设置_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [12], “22”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束

载入 (系统设置窗口, _启动窗口, 真)


.子程序 _档案查询_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [1], “00”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束

.如果真 (等于 (填充班级名称 (), 假))
    信息框 (“目前没有班级数据，请先进行校务设置!”, 0, “提示”)
    _教务设置_被选择 ()
    返回 ()
.如果真结束

赋值 (学生分类, “在校学生”)
赋值 (.现行选中项, “小学1年级1班”.选择 ())
填充学生姓名 ()
赋值 (., 0)
填充学生资料 ()
 ' 填充查看科目 ()
3.置文本 (“提示： 右击姓名列表可弹出操作菜单，双击照片查看可放大的照片。”)
解除打印禁止 ()
赋值 (.现行子夹, 1)


.子程序 填充查看科目, 空白型, , 填充查看科目
.局部变量 记录集句柄, 整数型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 班级, 文本型, , , 

.如果真 (等于 (连接句柄, 0))
    信息框 (“没有连接到服务器！”, 0, )
    返回 ()
.如果真结束
.判断开始 (等于 (学生分类, “在校学生”))
    赋值 (班级, .内容)
.判断 (等于 (学生分类, “离校学生”))
    赋值 (班级, .标题)
.默认
    
.判断结束

.如果真 (等于 (班级, “”))
    返回 ()
.如果真结束
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select bzr,bj,km1,km2,km3,km4,km5,km6,km7,km8,km9,km10,km11,km12 from system where bj like '%”, 班级, “%' ORDER BY bj DESC;”)), 假)) ' 导出记录
    返回 ()
.如果真结束

赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km1”, 文本变量)
赋值 (.标题, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km2”, 文本变量)
赋值 (.标题, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km3”, 文本变量)
赋值 (.标题, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km4”, 文本变量)
赋值 (.标题, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km5”, 文本变量)
赋值 (.标题, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km6”, 文本变量)
赋值 (.标题, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km7”, 文本变量)
赋值 (.标题, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km8”, 文本变量)
赋值 (.标题, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km9”, 文本变量)
赋值 (.标题, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km10”, 文本变量)
赋值 (.标题, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km11”, 文本变量)
赋值 (.标题, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km12”, 文本变量)
赋值 (.标题, 文本变量)

未知支持库函数_6 (记录集句柄, “bzr”, 文本变量)
赋值 (.标题, 文本变量)

未知支持库函数_5 (记录集句柄)
恢复鼠标 ()

.子程序 _建立档案_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [5], “08”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束

赋值 (修改资料, 假)
载入 (资料录入修改学生, _启动窗口, 真)

.子程序 _修改档案_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [5], “08”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束

赋值 (修改资料, 真)
载入 (资料录入修改学生, _启动窗口, 假)

.子程序 _删除档案_被选择, 空白型, , 
.局部变量 姓名, 文本型, , , 
.局部变量 学号, 文本型, , , 
.局部变量 wb, 文本型, , "0", 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [5], “08”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束

.判断开始 (等于 (.现行子夹, 1))
    .如果真 (等于 (., -1))
        信息框 (“  请选择要删除资料的学生姓名！  ”, 0, “提示”)
        返回 ()
    .如果真结束
    .如果真 (等于 (信息框 (相加 (“    删除资料后其学号也将会作废且不能再次利用！建议如非必要请使用修改资料方法。”, #换行符, #换行符, “  现在您还确认要删除当前学生”, .取标题 (., 0), “的资料吗？  ”), 相加 (#警告图标, #确认取消钮), “询问”), #确认钮))
        赋值 (姓名, .标题)
        赋值 (学号, .标题)
        .如果真 (或者 (等于 (姓名, “”), 等于 (学号, “”)))
            信息框 (“  请选择要删除资料的学生姓名！  ”, 0, “提示”)
            返回 ()
        .如果真结束
        .如果真 (未知支持库函数_20 (连接句柄, “xsda”, 相加 (“xh='”, 学号, “'”)))
            未知支持库函数_20 (连接句柄, “xfb”, 相加 (“xh='”, 学号, “'”))
        .如果真结束
        填充学生资料 ()
    .如果真结束
    
.判断 (等于 (.现行子夹, 2))
    .如果真 (等于 (., -1))
        信息框 (“  请选择要删除资料的学生姓名！  ”, 0, “提示”)
        返回 ()
    .如果真结束
    .如果真 (等于 (信息框 (相加 (“     删除资料后其学号也将会作废且不能再次利用！建议如非必要请使用修改资料方法。”, #换行符, #换行符, “  现在您还确认要删除当前学生”, .取标题 (., 2), “的资料吗？  ”), 相加 (#警告图标, #确认取消钮), “询问”), #确认钮))
        .判断开始 (等于 (学生分类, “离校学生”))
            赋值 (姓名, .取标题 (., 2))
            赋值 (学号, .取标题 (., 1))
            .如果真 (或者 (等于 (姓名, “”), 等于 (学号, “”)))
                信息框 (“  请选择要删除资料的学生姓名！  ”, 0, “提示”)
                返回 ()
            .如果真结束
            .如果真 (未知支持库函数_20 (连接句柄, “xsda”, 相加 (“xh='”, 学号, “'”)))
                未知支持库函数_20 (连接句柄, “xfb”, 相加 (“xh='”, 学号, “'”))
            .如果真结束
            _离退校学生记录_被选择 ()
        .默认
            
        .判断结束
        
    .如果真结束
    
.判断 (等于 (.现行子夹, 3))
    .如果真 (等于 (., -1))
        信息框 (“  请选择要删除资料的学生姓名！  ”, 0, “提示”)
        返回 ()
    .如果真结束
    .如果真 (等于 (信息框 (相加 (“     删除资料后其学号也将会作废且不能再次利用！建议如非必要请使用修改资料方法。”, #换行符, #换行符, “    您确认要删除当前学生”, .取标题 (., 2), “的资料吗？  ”), 相加 (#警告图标, #确认取消钮), “询问”), #确认钮))
        赋值 (姓名, .取标题 (., 2))
        赋值 (学号, .取标题 (., 1))
        .如果真 (或者 (等于 (姓名, “”), 等于 (学号, “”)))
            信息框 (“  请选择要删除资料的学生姓名！  ”, 0, “提示”)
            返回 ()
        .如果真结束
        .如果真 (未知支持库函数_20 (连接句柄, “xsda”, 相加 (“xh='”, 学号, “'”)))
            未知支持库函数_20 (连接句柄, “xfb”, 相加 (“xh='”, 学号, “'”))
            _在校学生记录_被选择 ()
            
        .如果真结束
        
    .如果真结束
    
    
.默认
    信息框 (“  请选择要删除资料的学生姓名！  ”, 0, “提示”)
     ' _查看学生资料_被选择 ()
.判断结束


.子程序 填充学生姓名, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 行, 整数型, , , 
.局部变量 性别变量, 文本型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本量, 文本型, , "0", 
.局部变量 错误, 文本型, , , 
.局部变量 表项, 文本型, , , 
.局部变量 当前班级, 文本型, , , 
.局部变量 姓名变量, 文本型, , , 

置等待鼠标 ()
赋值 (男, 0)
赋值 (女, 0)
.如果真 (等于 (连接句柄, 0))
    返回 ()
.如果真结束
置等待鼠标 ()
.判断开始 (等于 (学生分类, “在校学生”))
    赋值 (表项, .内容)
    .如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select xb,xm,szbj,zxxz from xsda where zxxz like '%”, 学生分类, “%'and szbj like '%”, 表项, “%'ORDER BY xm ASC;”)), 假)) ' 导出记录
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (相加 (“建立记录失败！”, 错误), 0, )
        返回 ()
    .如果真结束
    
.判断 (等于 (学生分类, “毕业学生”))
    .如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select xb,xm,szbj,zxxz from xsda where zxxz like '%”, 学生分类, “%' ORDER BY xm ASC;”)), 假)) ' 导出记录
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (相加 (“建立记录失败！”, 错误), 0, )
        返回 ()
    .如果真结束
    
.判断 (等于 (学生分类, “离校学生”))
    .如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select xb,xm,szbj,zxxz from xsda where zxxz like '%”, 学生分类, “%' ORDER BY xm ASC;”)), 假)) ' 导出记录
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (相加 (“建立记录失败！”, 错误), 0, )
        返回 ()
    .如果真结束
    
.默认
    
.判断结束

赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
全部删除 ()
.计次循环首 (记录数, )
    置等待鼠标 ()
    赋值 (性别变量, “”)
    未知支持库函数_6 (记录集句柄, “xb”, 性别变量)
    .如果 (等于 (性别变量, “男”))
        赋值 (男, 相加 (男, 1))
    .否则
        赋值 (女, 相加 (女, 1))
    .如果结束
    赋值 (姓名变量, “”)
    未知支持库函数_6 (记录集句柄, “xm”, 姓名变量)
    .如果 (等于 (性别变量, “男”))
        .插入表项 (姓名变量, 1, , , )
    .否则
        .插入表项 (姓名变量, 0, , , )
    .如果结束
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)

2.置文本 (“当前状态：录入修改学生资料”)
.判断开始 (等于 (学生分类, “在校学生”))
    2.置文本 (“当前状态：查看在校学生资料”)
    赋值 (.标题, 相加 (“本班共有”, 到文本 (取表项数 ()), “人 其中男”, 到文本 (男), “人 女”, 到文本 (女), “人”))
.判断 (等于 (学生分类, “毕业学生”))
    2.置文本 (“当前状态：查看毕业学生资料”)
    赋值 (.标题, 相加 (“共有”, 到文本 (取表项数 ()), “人毕业 其中男”, 到文本 (男), “人 女”, 到文本 (女), “人”))
.判断 (等于 (学生分类, “离校学生”))
    2.置文本 (“当前状态：查看离校学生资料”)
    赋值 (.标题, 相加 (“共有”, 到文本 (取表项数 ()), “人离校 其中男”, 到文本 (男), “人 女”, 到文本 (女), “人”))
.默认
    
.判断结束
恢复鼠标 ()

.子程序 填充学生资料, 空白型, , 
.局部变量 当前学号, 文本型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 科目成绩, 文本型, , "10", 
.局部变量 当前姓名, 文本型, , , 
.局部变量 当前班级, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 节集变量, 字节集, , , 
.局部变量 学期当前, 文本型, , , 
.局部变量 错误, 文本型, , , 

填充空学生资料 ()
赋值 (当前班级, .内容)
赋值 (学期当前, .内容)
赋值 (离校原因, “”)
.判断开始 (等于 (学生分类, “在校学生”))
    赋值 (当前姓名, .取标题 (., 0))
    .如果真 (等于 (连接句柄, 0))
        返回 ()
    .如果真结束
    置等待鼠标 ()
    .如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select * from xsda where xm like '%”, 当前姓名, “%' and szbj like '%”, 当前班级, “%' and zxxz like '%”, 学生分类, “%' ORDER BY xm ASC;”)), 假)) ' 导出记录
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (相加 (“错误！”, 错误), 0, )
    .如果真结束
    
.判断 (等于 (学生分类, “毕业学生”))
    
.判断 (等于 (学生分类, “离校学生”))
    .如果真 (等于 (连接句柄, 0))
        返回 ()
    .如果真结束
    置等待鼠标 ()
    .如果 (等于 (.现行子夹, 1))
        赋值 (当前姓名, .取标题 (., 0))
    .否则
        赋值 (当前姓名, .取标题 (., 2))
    .如果结束
    .如果真 (等于 (连接句柄, 0))
        返回 ()
    .如果真结束
    置等待鼠标 ()
    .如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select * from xsda where xm like '%”, 当前姓名, “%'  and zxxz like '%”, 学生分类, “%' ORDER BY xm ASC;”)), 假)) ' 导出记录
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (相加 (“错误！”, 错误), 0, )
    .如果真结束
    
.默认
    
.判断结束

赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “xh”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “xm”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “kh”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “xb”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “mz”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cssj”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “rxsj”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “szbj”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “bnfw”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “jtdz”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “zzdh”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “jg”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “hzszd”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “jhra”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “jhrxma”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “gzdwa”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “tela”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “jhrb”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “jhrxmb”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “gzdwb”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “telb”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “tp”, 节集变量)
赋值 (.图片, 节集变量)
未知支持库函数_6 (记录集句柄, “bqpy”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “lxyy”, 文本变量)
赋值 (离校原因, 文本变量)
未知支持库函数_6 (记录集句柄, “zhpy”, 文本变量)
赋值 (.内容, 相加 (#换行符, “本学期评语：”, #换行符, #换行符, .内容, #换行符, #换行符, “综合评价：”, #换行符, #换行符, 文本变量))
未知支持库函数_5 (记录集句柄)

赋值 (当前学号, .标题)
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select * from cjb where xh like '%”, 当前学号, “%' and bj like '%”, 当前班级, “%' and xq like '%”, 学期当前, “%' and kslx like '%期中考试%' and nf like '%”, 到文本 (取年份 (取现行时间 ())), “%';”)), 假)) ' 导出记录
    未知支持库函数_41 (连接句柄, 错误)
    信息框 (相加 (“错误！”, 错误), 0, )
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
赋值 (计次, 未知支持库函数_7 (记录集句柄))
未知支持库函数_12 (记录集句柄)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “cjz1”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjz2”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjz3”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjz4”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjz5”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjz6”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjz7”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjz8”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjz9”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjz10”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjz11”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjz12”, 文本变量)
赋值 (.标题, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “cjm1”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjm2”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjm3”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjm4”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjm5”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjm6”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjm7”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjm8”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjm9”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjm10”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjm11”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjm12”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_5 (记录集句柄)

.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select * from cjb where xh like '%”, 当前学号, “%' and bj like '%”, 当前班级, “%'  and xq like '%”, 学期当前, “%'  and kslx like '%期末考试%' and nf like '%”, 到文本 (取年份 (取现行时间 ())), “%';”)), 假)) ' 导出记录
    未知支持库函数_41 (连接句柄, 错误)
    信息框 (相加 (“错误！”, 错误), 0, )
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
赋值 (计次, 未知支持库函数_7 (记录集句柄))
未知支持库函数_12 (记录集句柄)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “cjz1”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjz2”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjz3”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjz4”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjz5”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjz6”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjz7”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjz8”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjz9”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjz10”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjz11”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjz12”, 文本变量)
赋值 (.标题, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “cjm1”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjm2”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjm3”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjm4”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjm5”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjm6”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjm7”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjm8”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjm9”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjm10”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjm11”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cjm12”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_5 (记录集句柄)

.判断开始 (等于 (学生分类, “在校学生”))
    赋值 (.标题, “本班班主任”)
    赋值 (.标题, .内容)
    赋值 (.标题, 相加 (.标题, .标题, .取标题 (., ), “同学的资料”))
    赋值 (.可视, 假)
    赋值 (.标题, “”)
    
.判断 (等于 (学生分类, “毕业学生”))
    赋值 (.标题, “个人详细资料”)
    赋值 (.标题, “”)
    赋值 (.标题, 相加 (.标题, 取文本左边 (.内容, 6), “毕业生”, .取标题 (., ), “同学的资料”))
    赋值 (.可视, 假)
    赋值 (.标题, “”)
    
.判断 (等于 (学生分类, “离校学生”))
    赋值 (.标题, “个人详细资料”)
    赋值 (.标题, “”)
    赋值 (.标题, 相加 (.标题, .标题, .取标题 (., ), “同学的资料(已离校)”))
    赋值 (.可视, 真)
    赋值 (.标题, 相加 (.标题, “同学已离开本校(点击查看详细)”))
    赋值 (.标题, 相加 (“    ”, .标题, “同学已于”, 记录.读 (“离校时间”), “离开本校”, #换行符, #换行符, “    离开本校的原因是：”, 记录.读 (“离校原因”)))
.默认
    
.判断结束



.子程序 填充空学生资料, 空白型, , 
连续赋值 (“”, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .内容, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .内容)
连续赋值 (“家长姓名”, .标题, .标题)
赋值 (.图片, {  })

.子程序 _教师档案查询_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [2], “02”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束

赋值 (学生分类, “在职教员”)
填充教员 ()
赋值 (., 0)
填教员资料 ()

2.置文本 (“    当前状态：查看在职教员资料”)
3.置文本 (“    提示： 右击姓名列表可弹出操作菜单，双击照片查看可放大的照片。”)
解除打印禁止 ()
赋值 (.现行子夹, 5)

.子程序 填充教员, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 性别变量, 文本型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本量, 文本型, , "0", 
.局部变量 错误, 文本型, , , 
.局部变量 姓名变量, 文本型, , , 

置等待鼠标 ()
赋值 (男, 0)
赋值 (女, 0)
.如果真 (等于 (连接句柄, 0))
    返回 ()
.如果真结束
置等待鼠标 ()
.判断开始 (等于 (学生分类, “在职教员”))
    .如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select xb,xm,zzlx from jyda where zzlx like '%”, 学生分类, “%' ORDER BY xm ASC;”)), 假)) ' 导出记录
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (相加 (“建立记录失败！”, 错误), 0, )
        返回 ()
    .如果真结束
    
.判断 (等于 (学生分类, “退休教员”))
    .如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select xb,xm,zzlx from jyda where zzlx like '%”, 学生分类, “%' ORDER BY xm ASC;”)), 假)) ' 导出记录
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (相加 (“建立记录失败！”, 错误), 0, )
        返回 ()
    .如果真结束
    
.判断 (等于 (学生分类, “调离教员”))
    .如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select xb,xm,zzlx from jyda where zzlx like '%”, 学生分类, “%' ORDER BY xm ASC;”)), 假)) ' 导出记录
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (相加 (“建立记录失败！”, 错误), 0, )
        返回 ()
    .如果真结束
    
.默认
    
.判断结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
全部删除 ()

.计次循环首 (记录数, )
    置等待鼠标 ()
    赋值 (性别变量, “”)
    未知支持库函数_6 (记录集句柄, “xb”, 性别变量)
    .如果 (等于 (性别变量, “男”))
        赋值 (男, 相加 (男, 1))
    .否则
        赋值 (女, 相加 (女, 1))
    .如果结束
    赋值 (姓名变量, “”)
    未知支持库函数_6 (记录集句柄, “xm”, 姓名变量)
    .如果 (等于 (性别变量, “男”))
        .插入表项 (姓名变量, 1, , , )
    .否则
        .插入表项 (姓名变量, 0, , , )
    .如果结束
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)

2.置文本 (“当前状态：录入教员资料”)
.判断开始 (等于 (学生分类, “在校教员”))
    2.置文本 (“当前状态：查看在校教员资料”)
    赋值 (.标题, 相加 (“本班共有”, 到文本 (取表项数 ()), “人 其中男”, 到文本 (男), “人 女”, 到文本 (女), “人”))
.判断 (等于 (学生分类, “退休教员”))
    2.置文本 (“当前状态：查看退休教员资料”)
    赋值 (.标题, 相加 (“共有”, 到文本 (取表项数 ()), “人毕业 其中男”, 到文本 (男), “人 女”, 到文本 (女), “人”))
.判断 (等于 (学生分类, “调离教员”))
    2.置文本 (“当前状态：查看离职教员资料”)
    赋值 (.标题, 相加 (“共有”, 到文本 (取表项数 ()), “人离校 其中男”, 到文本 (男), “人 女”, 到文本 (女), “人”))
.默认
    
.判断结束
恢复鼠标 ()


.子程序 解除打印禁止, 空白型, , 
.如果真 (并且 (等于 (.禁止, 真), 等于 (.禁止, 真)))
    10.去除状态 (#禁止)
    11.去除状态 (#禁止)
    30.去除状态 (#禁止)
    连续赋值 (假, .禁止, .禁止)
    25.去除状态 (#禁止)
    26.去除状态 (#禁止)
    27.去除状态 (#禁止)
    28.去除状态 (#禁止)
.如果真结束

 ' 连续赋值 (假, 打开工资表一.选中, 打开工资表二.选中, 打开工资表三.选中, 打开工资表四.选中, 打开工资表五.选中, 工资表一.选中, 工资表二.选中, 工资表三.选中, 工资表四.选中, 工资表五.选中)

.子程序 填教员资料, 空白型, , 
.局部变量 当前姓名, 文本型, , , 
.局部变量 错误, 文本型, , , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 字节变量, 字节集, , , 

.如果真 (等于 (取表项数 (), 0))
    .判断开始 (等于 (学生分类, “在职教员”))
        赋值 (.标题, 相加 (_启动窗口..标题, “目前没有在职教员的资料”))
    .判断 (等于 (学生分类, “退休教员”))
        赋值 (.标题, 相加 (_启动窗口..标题, “目前没有退休教员的资料”))
    .判断 (等于 (学生分类, “调离教员”))
        赋值 (.标题, 相加 (_启动窗口..标题, “目前没有调离本校的教员资料”))
    .默认
        
    .判断结束
    填充空教员资料 ()
    记录.关闭记录集 ()
    返回 ()
.如果真结束

.判断开始 (等于 (学生分类, “在职教员”))
    赋值 (当前姓名, .取标题 (., 0))
    .如果真 (等于 (连接句柄, 0))
        返回 ()
    .如果真结束
    置等待鼠标 ()
    .如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select * from jyda where xm like '%”, 当前姓名, “%' and zzlx like '%”, 学生分类, “%' ORDER BY xm ASC;”)), 假)) ' 导出记录
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (相加 (“错误！”, 错误), 0, “错误！”)
        返回 ()
    .如果真结束
    
.判断 (等于 (学生分类, “退休教员”))
    
.判断 (等于 (学生分类, “调离教员”))
    
.默认
    
.判断结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “xm”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “xb”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “mz”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “cssj”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “xl”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “zzmm”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “gzsj”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “rxsj”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “zc”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “zw”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “sfz”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “sj”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “dz”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “dh”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “jg”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “hjdz”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “gzxz”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “gzgw”, 文本变量)
赋值 (.标题, 文本变量)

未知支持库函数_6 (记录集句柄, “tp”, 字节变量)
赋值 (.图片, 字节变量)

未知支持库函数_6 (记录集句柄, “jl”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “zl”, 文本变量)
赋值 (.内容, 相加 (“个人简历”, #换行符, #换行符, .内容, #换行符, #换行符, “其它资料”, #换行符, #换行符, 文本变量, “其他资料”))

.判断开始 (等于 (学生分类, “在职教员”))
    赋值 (.标题, 相加 (_启动窗口..标题, .取标题 (., ), “同志的资料”))
    赋值 (.可视, 假)
    赋值 (.标题, “”)
    
.判断 (等于 (学生分类, “退休教员”))
    赋值 (.标题, 相加 (_启动窗口..标题, .取标题 (., ), “同志的资料(已退休)”))
    赋值 (.可视, 真)
    赋值 (.标题, 相加 (.标题, “同志已经自本校退休(点击查看详细)”))
    赋值 (.标题, 相加 (“    ”, .标题, “同志已于”, 记录.读 (“离校时间”), “自本校退休”, #换行符, #换行符, “    有关本次退休的说明：”, 记录.读 (“离校原因”)))
    
.判断 (等于 (学生分类, “调离教员”))
    赋值 (.标题, 相加 (_启动窗口..标题, .取标题 (., ), “同志的资料(已调离)”))
    赋值 (.可视, 真)
    赋值 (.标题, 相加 (.标题, “同志已经调离本校(点击查看详细)”))
    赋值 (.标题, 相加 (“    ”, .标题, “同志已于”, 记录.读 (“离校时间”), “调离本校”, #换行符, #换行符, “    调离本校的原因是：”, 记录.读 (“离校原因”)))
.默认
    
.判断结束

记录.关闭记录集 ()

.子程序 填充空教员资料, 空白型, , 
连续赋值 (“”, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .内容, .标题, .标题, .标题, .内容)
赋值 (.图片, {  })

.子程序 _学生班级调整_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [9], “16”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束

.如果 (或者 (等于 (.现行子夹, 1), 等于 (.现行子夹, 3)))
    .如果真 (并且 (等于 (.现行子夹, 1), 不等于 (学生分类, “在校学生”)))
        信息框 (相加 (“  本操作只能对在校学生操作！您现在操作的是：”, 学生分类, “资料。  ”), 0, )
        返回 ()
    .如果真结束
    .如果 (或者 (不等于 (., -1), 不等于 (., -1)))
        赋值 (选择子夹, 1)
        载入 (资料变更窗口, , 真)
    .否则
        信息框 (“  请先选择需要调整班级的学生所在班级和姓名！  ”, 0, )
    .如果结束
    
.否则
    信息框 (“  请先选择需要调整班级的学生所在班级和姓名！  ”, 0, )
    _档案查询_被选择 ()
.如果结束


.子程序 _学生转退学_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [9], “16”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束

.如果 (或者 (等于 (.现行子夹, 1), 等于 (.现行子夹, 3)))
    .如果 (等于 (学生分类, “在校学生”))
        .如果 (或者 (不等于 (., -1), 不等于 (., -1)))
            赋值 (选择子夹, 0)
            载入 (资料变更窗口, , 真)
        .否则
            信息框 (“  请先选择需要调整班级的学生所在班级和姓名！  ”, 0, )
        .如果结束
        
    .否则
        信息框 (相加 (“  本操作只能对在校学生操作！您现在操作的是：”, 学生分类, “资料。  ”), 0, )
    .如果结束
    
.否则
    信息框 (“  请先选择需要调整班级的学生所在班级和姓名！  ”, 0, )
    _档案查询_被选择 ()
.如果结束



.子程序 _建立教师档案_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [6], “10”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束

赋值 (修改资料, 假)
载入 (资料录入修改教员, _启动窗口, 真)

.子程序 _修改教师档案_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [6], “10”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束

赋值 (修改资料, 真)
载入 (资料录入修改教员, _启动窗口, 真)

.子程序 _删除教师档案_被选择, 空白型, , 
信息框 (“抱歉！不可以删除教员档案！”, 0, )

.子程序 _教师档案打印_被选择, 空白型, , 


.子程序 _教员退休操作_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [10], “18”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束

.如果 (或者 (等于 (.现行子夹, 5), 等于 (.现行子夹, 6)))
    .如果 (等于 (学生分类, “在职教员”))
        .如果 (或者 (不等于 (., -1), 不等于 (., -1)))
            赋值 (教员去向, “退休”)
            赋值 (选择子夹, 3)
            载入 (资料变更窗口, , 真)
            
        .否则
            信息框 (“  请先选择要退休的教员姓名！  ”, 0, )
        .如果结束
        
    .否则
        信息框 (相加 (“  本操作只能对在职教员操作！您现在操作的是：”, 学生分类, “资料。  ”), 0, )
    .如果结束
    
.否则
    信息框 (“请先选择要退休的教员姓名！  ”, 0, )
.如果结束


.子程序 _教员离职操作_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [10], “18”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果 (或者 (等于 (.现行子夹, 5), 等于 (.现行子夹, 6)))
    .如果 (等于 (学生分类, “在职教员”))
        .如果 (或者 (不等于 (., -1), 不等于 (., -1)))
            赋值 (教员去向, “调离”)
            赋值 (选择子夹, 3)
            载入 (资料变更窗口, , 真)
        .否则
            信息框 (“  请先选择要调离本校的教员姓名！  ”, 0, )
        .如果结束
        
    .否则
        信息框 (相加 (“  本操作只能对在职教员操作！您现在操作的是：”, 学生分类, “资料。  ”), 0, )
    .如果结束
    
.否则
    信息框 (“  请先选择要退休的教员姓名！  ”, 0, )
    _教师档案查询_被选择 ()
.如果结束


.子程序 _预览_被选择, 空白型, , 
.判断开始 (等于 (.现行子夹, 1))
    0.初始尺寸 (0)
    .如果 (#学籍表.从字节集读 ())
        打印学籍卡 ()
        打印预览 ()
    .否则
        信息框 (“不能打开模板文件！请与本程序作者联系！”, 0, )
    .如果结束
    
.判断 (等于 (.现行子夹, 2))
    .如果 (等于 (搜索资料, 假))
        .如果 (等于 (学生分类, “毕业学生”))
            打印学生花名册 (.标题, .标题)
        .否则
            打印学生花名册 (.标题, .标题)
        .如果结束
        
    .否则
        打印学生花名册 (.标题)
    .如果结束
    打印预览 ()
    
.判断 (等于 (.现行子夹, 3))
    .如果 (等于 (搜索资料, 假))
        打印学生花名册 (.标题, .标题)
    .否则
        打印学生花名册 (.标题)
    .如果结束
    打印预览 ()
    
.判断 (等于 (.现行子夹, 4))
    打印成绩表 ()
    打印预览 ()
.判断 (等于 (.现行子夹, 5))
    0.初始尺寸 (0)
    .如果 (#教员表.从字节集读 ())
        打印教员卡 ()
        打印预览 ()
    .否则
        信息框 (“不能打开模板文件！请与本程序作者联系！”, 0, )
    .如果结束
    
.判断 (等于 (.现行子夹, 6))
    打印教员花名册 ()
    打印预览 ()
.判断 (等于 (.现行子夹, 7))
    打印工资表 ()
    打印预览 ()
.判断 (等于 (.现行子夹, 8))
    打印统计表 ()
    打印预览 ()
.默认
    
.判断结束


.子程序 _打印_被选择, 空白型, , 
.判断开始 (等于 (.现行子夹, 1))
    0.初始尺寸 (0)
    .如果 (#学籍表.从字节集读 ())
        打印学籍卡 ()
        真.打印 (“打印报表”)
    .否则
        信息框 (“  打开模板文件失败！  ”, #错误图标, “错误”)
    .如果结束
    
.判断 (等于 (.现行子夹, 2))
    .如果 (等于 (搜索资料, 假))
        .如果 (等于 (学生分类, “毕业学生”))
            打印学生花名册 (.标题, .标题)
        .否则
            打印学生花名册 (.标题, .标题)
        .如果结束
        
    .否则
        打印学生花名册 (.标题)
    .如果结束
    真.打印 (“打印报表”)
    
.判断 (等于 (.现行子夹, 3))
    .如果 (等于 (搜索资料, 假))
        打印学生花名册 (.标题, .标题)
    .否则
        打印学生花名册 (.标题)
    .如果结束
    真.打印 (“打印报表”)
    
.判断 (等于 (.现行子夹, 4))
    打印成绩表 ()
    真.打印 (“打印报表”)
.判断 (等于 (.现行子夹, 5))
    0.初始尺寸 (0)
    .如果 (#教员表.从字节集读 ())
        打印教员卡 ()
        真.打印 (“打印报表”)
    .否则
        信息框 (“  打开模板文件失败！  ”, #错误图标, “错误”)
    .如果结束
    
.判断 (等于 (.现行子夹, 6))
    打印教员花名册 ()
    真.打印 (“打印报表”)
.判断 (等于 (.现行子夹, 7))
    打印工资表 ()
    真.打印 (“打印报表”)
.判断 (等于 (.现行子夹, 8))
    打印统计表 ()
    真.打印 (“打印报表”)
.默认
    
.判断结束


.子程序 _课程安排编辑系统_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [3], “04”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束

载入 (自动排课窗口, _启动窗口, 真)

.子程序 _退出图形按钮_被单击, 空白型, , 
_退出_被选择 ()

.子程序 _退出_被选择, 空白型, , 
.如果真 (等于 (信息框 (“确定要退出校务管理系统吗？”, 相加 (#是否钮, #询问图标), “询问”), #是钮))
    结束 ()
.如果真结束


.子程序 __启动窗口_可否被关闭, 逻辑型, , 
.如果 (等于 (信息框 (“确定要退出校务管理系统吗？”, 相加 (#是否钮, #询问图标), “询问”), #是钮))
    结束 ()
.否则
    返回 (假)
.如果结束


.子程序 _关于_被选择, 空白型, , 
载入 (前言, , 真)

.子程序 _智能评语录入_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [6], “10”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束


载入 (评语录入窗口, _启动窗口, 真)


.子程序 _学生成绩录入管理_被选择, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 wb, 文本型, , "0", 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [4], “06”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束


.如果真 (等于 (填充班级名称 (), 假))
    信息框 (“目前没有班级数据，请先进行校务设置！”, 0, “提示”)
    _教务设置_被选择 ()
    返回 ()
.如果真结束
赋值 (.现行选中项, 0)
赋值 (年份条件, 到文本 (取年份 (.今天)))
赋值 (成绩表标题, 相加 (年份条件, “年全校各科目成绩表”))
赋值 (.标题, 相加 (.标题, 成绩表标题))
赋值 (学期条件, .内容)
赋值 (考试类型, .内容)
赋值 (班级条件, .内容)
刷新班级 ()
赋值 (.现行选中项, 0)
刷新成绩表 ()
赋值 (.现行选中项, 0)
解除打印禁止 ()
赋值 (.现行子夹, 4)
获取焦点 ()


.子程序 刷新成绩表, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 T, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 文本量, 文本型, , , 
.局部变量 条件, 文本型, , , 
.局部变量 B, 整数型, , , 
.局部变量 A, 整数型, , , 
.局部变量 C, 整数型, , , 
.局部变量 D, 整数型, , , 
.局部变量 E, 整数型, , , 

0.初始尺寸 (0)
2.添加行 ()
1.插入列 (15)
1.置文本 (1, 成绩表标题)
1.合并 (1, 1, 15)
1.置表头行数 ()

.如果真 (等于 (班级条件, “”))
    返回 ()
.如果真结束
.如果 (等于 (.选中, 假))
    赋值 (条件, 相加 (“bj like '%”, 班级条件, “%' and xh like '%”, 号码条件, “%' and nf like '%”, 年份条件, “%' and xq like '%”, 学期条件, “%' and kslx like '%”, 考试类型, “%'”))
    
.否则
    赋值 (条件, 相加 (“nf like '%”, 年份条件, “%' and xq like '%”, 学期条件, “%' and kslx like '%”, 考试类型, “%'”))
.如果结束


.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select * from cjb where ”, 条件, “ ORDER BY xh ASC;”)), 假)) ' 导出科目记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
赋值 (字段数, 未知支持库函数_14 (记录集句柄))
相乘 (记录数, 2).添加行 ()
未知支持库函数_12 (记录集句柄)
.计次循环首 (记录数, )
    赋值 (C, 0)
    赋值 (D, 0)
    .计次循环首 (字段数, B)
        未知支持库函数_15 (记录集句柄, 相减 (B, 1), 字段名)
        未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
        .如果 (或者 (等于 (字段名, “nf”), 等于 (字段名, “xq”), 等于 (字段名, “kslx”)))
            赋值 (C, 相加 (C, 1))
        .否则
            相加 (A, 2, D).置文本 (相减 (B, C), 文本变量)
            .如果真 (小于或等于 (B, 3))
                相加 (A, 2, D).置文本色 (相减 (B, C), 1, 1, #红色)
            .如果真结束
            
        .如果结束
        .如果真 (等于 (取文本左边 (字段名, 3), “cjm”))
            赋值 (D, 相加 (D, 1))
            相加 (A, 3).置文本 (相加 (D, 3), 文本变量)
        .如果真结束
        
    .计次循环尾 ()
    赋值 (A, 相加 (A, 2))
    未知支持库函数_10 (记录集句柄)
    处理事件 ()
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
恢复鼠标 ()

1.置行高 (1, 70)
1.置字体尺寸 (1, 1, 15, 50)
1.置列宽 (15, 相除 (_启动窗口., 5.11))
3.置列宽 (1, 300)
1.置对齐方式 (1, 取行数 (), 15, 5)
1.置只读方式 (1, 取行数 (), 3, 真)

3.置文本输入格式 (4, 取行数 (), 10, 6)
2.置光标 (4)

获取焦点 ()
2.置文本 (“当前状态：学生成绩管理”)
3.置文本 (“提示：用鼠标或方向键移动方格光标，在光标内输入成绩后按回车键。”)
恢复鼠标 ()


.子程序 _成绩表格_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (等于 (键代码, #回车键))
    取光标行号 ().置光标 (相加 (取光标列号 (), 1))
.默认
    
.判断结束


.子程序 _成绩表格_选择行列数改变, 空白型, , 
.如果真 (小于 (取光标列号 (), 3))
    取光标行号 ().置光标 (3)
.如果真结束
光标行.置背景色 (1, 1, 取列数 (), #白色)
取光标行号 ().置背景色 (1, 1, 取列数 (), #银白)
赋值 (光标行, 取光标行号 ())

.子程序 _重新登录_被选择, 空白型, , 
载入 (登录窗口, _启动窗口, 真)

.子程序 _设置课程科目_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [11], “20”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束

载入 (设置科目窗口, , 真)

.子程序 _查看学生列表框_右键单击表项, 空白型, , 
.判断开始 (等于 (学生分类, “在校学生”))
    弹出菜单 ()
.判断 (等于 (学生分类, “离校学生”))
     ' 弹出 菜单 (学离, , )
.判断 (等于 (学生分类, “毕业学生”))
     ' 弹出 菜单 (学离, , )
.默认
    
.判断结束


.子程序 _查看学生列表框_当前表项被改变, 空白型, , 
填充查看科目 ()
填充学生资料 ()

.子程序 _学期组合_列表项被选择, 空白型, , 
填充查看科目 ()
填充学生资料 ()

.子程序 _查看班级名组合框_列表项被选择, 空白型, , 
赋值 (.现行选中项, .现行选中项)
.如果 (等于 (学生分类, “在校学生”))
     ' 填充查看科目 ()
.否则
    离校科目 ()
.如果结束

获取焦点 ()
填充学生姓名 ()
填充学生资料 ()


.子程序 离校科目, 空白型, , 
赋值 (.标题, “第1科”)
赋值 (.标题, “第2科”)
赋值 (.标题, “第3科”)
赋值 (.标题, “第4科”)
赋值 (.标题, “第5科”)
赋值 (.标题, “第6科”)
赋值 (.标题, “第7科”)
赋值 (.标题, “第8科”)
赋值 (.标题, “第9科”)
赋值 (.标题, “第10科”)

.子程序 _转退学生资料_被选择, 空白型, , 
.如果真 (不等于 (取文本左边 (.标题, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束
清空 ()
“离校学生资料”.加入项目 ()
赋值 (.现行选中项, 0)
赋值 (学生分类, “离校学生”)
填充学生姓名 ()
.如果真 (等于 (取表项数 (), 0))
    填充空学生资料 ()
    赋值 (.标题, “本校目前没有因转学、退学等原因离校的学生资料”)
    信息框 (“目前本校没有因转学、退学等原因离校的学生数据！”, 0, )
    返回 ()
.如果真结束
离校科目 ()
赋值 (., 0)
填充学生资料 ()
3.置文本 (“    提示： 右击姓名列表可弹出操作菜单，双击照片查看可放大的照片。”)
解除打印禁止 ()
赋值 (.现行子夹, 1)

.子程序 _在校学生列表_被选择, 空白型, , 
.如果真 (不等于 (取文本左边 (.标题, 1), “1”))
    信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
    返回 ()
.如果真结束

.如果真 (等于 (填充班级名称 (), 假))
    信息框 (“目前没有班级数据，请先进行校务设置！”, 0, “提示”)
    _教务设置_被选择 ()
    返回 ()
.如果真结束
赋值 (搜索资料, 假)
赋值 (.现行选中项, 0)
赋值 (记录, 相加 (“select 学号,姓名,性别,民族,出生日期,入学日期,所在班级,班内职务,联系电话 from 学籍表 where 所在班级='”, .内容, “' order by 姓名”).查询 ())
填充学生列表 ()
赋值 (.现行子夹, 3)
3.置文本 (“    提示： 双击选择项可查看详细资料，右击选择项可弹出操作菜单！”)
解除打印禁止 ()
赋值 (.现行子夹, 3)


.子程序 置排序标, 空白型, , 
.参数 排序列表框, 超级列表框, , 

.局部变量 计次, 整数型, , , 

.计次循环首 (9, 计次)
    排序列表框.置列图片 (计次, -1)
.计次循环尾 ()
排序列表框.置列图片 (2, 0)
赋值 (排序方式, 真)
赋值 (上次单击列, 2)

.子程序 填充学生列表, 空白型, , 
.局部变量 表项, 整数型, , , 

置排序标 ()
全部删除 ()
赋值 (男, 0)
赋值 (女, 0)
赋值 (.标题, 相加 (.标题, .取项目文本 (.现行选中项), “学生花名册”))
记录.到首记录 ()
.判断循环首 (等于 (记录.尾记录后 (), 假))
    赋值 (表项, .插入表项 (“0”, , , , 相加 (男, 女)))
    表项.置标题 (1, 到文本 (记录.读 (“学号”)))
    表项.置标题 (2, 记录.读 (“姓名”))
    表项.置标题 (3, 记录.读 (“性别”))
    表项.置标题 (4, 记录.读 (“民族”))
    表项.置标题 (5, 记录.读 (“所在班级”))
    
    表项.置标题 (6, 记录.读 (“班内职务”))
    表项.置标题 (7, 记录.读 (“出生日期”))
    表项.置标题 (8, 记录.读 (“入学日期”))
    表项.置标题 (9, 到文本 (记录.读 (“联系电话”)))
    
    .如果 (等于 (记录.读 (“性别”), “男”))
        赋值 (男, 相加 (男, 1))
    .否则
        赋值 (女, 相加 (女, 1))
    .如果结束
    赋值 (.位置, 相加 (.位置, 1))
    .如果真 (等于 (.位置, .最大位置))
        赋值 (.位置, 0)
    .如果真结束
    记录.到后一记录 ()
    处理事件 ()
.判断循环尾 ()
赋值 (.可视, 假)
.如果 (等于 (搜索资料, 假))
    2.置文本 (“    当前状态：在校学生列表”)
    赋值 (.标题, 相加 (“本班共有”, 到文本 (相加 (男, 女)), “人 其中男生”, 到文本 (男), “人 女生”, 到文本 (女), “人”))
.否则
    2.置文本 (“    当前状态：搜索学生资料”)
.如果结束

记录.关闭记录集 ()
赋值 (., 0)


.子程序 _基本信息配置_被选择, 空白型, , 
载入 (系统配置窗口, , 真)

.子程序 _学生照片框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (放大照片窗口, _启动窗口, 真)

.子程序 _教员照片_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (放大照片窗口, _启动窗口, 真)


.子程序 _工具条1_被下拉, 空白型, , 
.参数 按钮索引, 整数型, , 
.参数 下拉横座标, 整数型, , 
.参数 下拉纵座标, 整数型, , 

.如果真 (等于 (按钮索引, 20))
     ' 弹出菜单 (工资管理, , )
.如果真结束


.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.判断开始 (等于 (按钮索引, 0))
    _建立档案_被选择 ()
.判断 (等于 (按钮索引, 1))
    _修改档案_被选择 ()
.判断 (等于 (按钮索引, 2))
    _删除档案_被选择 ()
.判断 (等于 (按钮索引, 3))
    _学生转退学_被选择 ()
.判断 (等于 (按钮索引, 5))
    _建立教师档案_被选择 ()
.判断 (等于 (按钮索引, 6))
    _修改教师档案_被选择 ()
.判断 (等于 (按钮索引, 7))
    _删除教师档案_被选择 ()
.判断 (等于 (按钮索引, 8))
    _凋离教员记录_被选择 ()
.判断 (等于 (按钮索引, 10))
    _预览_被选择 ()
.判断 (等于 (按钮索引, 11))
    _打印_被选择 ()
.判断 (等于 (按钮索引, 13))
    _档案查询_被选择 ()
.判断 (等于 (按钮索引, 14))
    _在校学生记录_被选择 ()
.判断 (等于 (按钮索引, 15))
    _学生成绩录入管理_被选择 ()
.判断 (等于 (按钮索引, 16))
    _智能评语录入_被选择 ()
.判断 (等于 (按钮索引, 18))
    _教师档案查询_被选择 ()
.判断 (等于 (按钮索引, 19))
    _在职教员记录_被选择 ()
.判断 (等于 (按钮索引, 20))
    
.判断 (等于 (按钮索引, 22))
    _课程安排编辑系统_被选择 ()
.判断 (等于 (按钮索引, 23))
    弹出菜单 ()
.判断 (等于 (按钮索引, 25))
    到记录头 ()
.判断 (等于 (按钮索引, 26))
    上一个 ()
.判断 (等于 (按钮索引, 27))
    下一个 ()
.判断 (等于 (按钮索引, 28))
    到记录尾 ()
.判断 (等于 (按钮索引, 30))
    回主界面 ()
.默认
    
.判断结束


.子程序 到记录头, 空白型, , 
.判断开始 (等于 (.现行子夹, 1))
    .如果 (大于 (., 0))
        0.选择表项 ()
        .保证显示 (.)
        填充学生资料 ()
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 2))
    .如果 (大于 (., 0))
        赋值 (., 0)
        .保证显示 (.)
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 3))
    .如果 (大于 (., 0))
        赋值 (., 0)
        .保证显示 (.)
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 4))
    .如果 (大于 (取光标行号 (), 2))
        2.置光标 (取光标列号 ())
         ' _成绩表格_选择行列数改变 ()
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 5))
    .如果 (大于 (., 0))
        赋值 (., 0)
        .保证显示 (.)
        填教员资料 ()
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 6))
    .如果 (大于 (., 0))
        赋值 (., 0)
        .保证显示 (.)
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 7))
    .如果 (大于 (取光标行号 (), 2))
        2.置光标 (取光标列号 ())
         ' _工资表格_选择行列数改变 ()
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 8))
    .如果 (大于 (., 0))
        赋值 (., 0)
        .保证显示 (.)
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.默认
    
.判断结束


.子程序 上一个, 空白型, , 
.判断开始 (等于 (.现行子夹, 1))
    .如果 (大于 (., 0))
        赋值 (., 相减 (., 1))
        填充学生资料 ()
        .保证显示 (.)
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 2))
    .如果 (大于 (., 0))
        赋值 (., 相减 (., 1))
        .保证显示 (.)
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 3))
    .如果 (大于 (., 0))
        赋值 (., 相减 (., 1))
        .保证显示 (.)
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 4))
    .如果 (大于 (取光标行号 (), 2))
        相减 (取光标行号 (), 1).置光标 (取光标列号 ())
         ' _成绩表格_选择行列数改变 ()
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 5))
    .如果 (大于 (., 0))
        赋值 (., 相减 (., 1))
        填教员资料 ()
        .保证显示 (.)
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 6))
    .如果 (大于 (., 0))
        赋值 (., 相减 (., 1))
        .保证显示 (.)
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 7))
    .如果 (大于 (取光标行号 (), 2))
        相减 (取光标行号 (), 1).置光标 (取光标列号 ())
         ' _工资表格_选择行列数改变 ()
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 8))
    .如果 (大于 (., 0))
        赋值 (., 相减 (., 1))
        .保证显示 (.)
    .否则
        信息框 (“已到第一个记录”, 0, “提示”)
    .如果结束
    
.默认
    
.判断结束


.子程序 下一个, 空白型, , 
.判断开始 (等于 (.现行子夹, 1))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        赋值 (., 相加 (., 1))
        填充学生资料 ()
        .保证显示 (.)
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 2))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        赋值 (., 相加 (., 1))
        .保证显示 (.)
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 3))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        赋值 (., 相加 (., 1))
        .保证显示 (.)
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 4))
    .如果 (小于 (取光标行号 (), 取行数 ()))
        相加 (取光标行号 (), 1).置光标 (取光标列号 ())
         ' _成绩表格_选择行列数改变 ()
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 5))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        赋值 (., 相加 (., 1))
        填教员资料 ()
        .保证显示 (.)
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 6))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        赋值 (., 相加 (., 1))
        .保证显示 (.)
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 7))
    .如果 (小于 (取光标行号 (), 相减 (取行数 (), 1)))
        相加 (取光标行号 (), 1).置光标 (取光标列号 ())
         ' _工资表格_选择行列数改变 ()
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 8))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        赋值 (., 相加 (., 1))
        .保证显示 (.)
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.默认
    
.判断结束


.子程序 到记录尾, 空白型, , 
.判断开始 (等于 (.现行子夹, 1))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        赋值 (., 相减 (取表项数 (), 1))
        填充学生资料 ()
        .保证显示 (.)
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 2))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        赋值 (., 相减 (取表项数 (), 1))
        .保证显示 (.)
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 3))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        赋值 (., 相减 (取表项数 (), 1))
        .保证显示 (.)
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 4))
    .如果 (小于 (取光标行号 (), 取行数 ()))
        取行数 ().置光标 (取光标列号 ())
         ' _成绩表格_选择行列数改变 ()
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 5))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        赋值 (., 相减 (取表项数 (), 1))
        填教员资料 ()
        .保证显示 (.)
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 6))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        赋值 (., 相减 (取表项数 (), 1))
        .保证显示 (.)
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 7))
    .如果 (小于 (取光标行号 (), 相减 (取行数 (), 1)))
        相减 (取行数 (), 1).置光标 (取光标列号 ())
         ' _工资表格_选择行列数改变 ()
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.判断 (等于 (.现行子夹, 8))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        赋值 (., 相减 (取表项数 (), 1))
        .保证显示 (.)
    .否则
        信息框 (“已到最后一个记录”, 0, “提示”)
    .如果结束
    
.默认
    
.判断结束


.子程序 _在职教员记录_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [2], “02”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束

赋值 (搜索资料, 假)
赋值 (学生分类, “在职教员”)
8.置列标题 (“调入本校时间”)
6.置项目文本 (“调入本校时间”)
赋值 (搜索条件, 相加 (“zzlx like '%”, 学生分类, “%'”))
填充教员列表 ()
赋值 (.标题, 相加 (“本校在职教员有”, 到文本 (相加 (男, 女)), “人 其中男”, 到文本 (男), “人 女”, 到文本 (女), “人”))
.如果 (大于 (取表项数 (), 0))
    赋值 (.标题, 相加 (.标题, “在职教员花名册”))
.否则
    赋值 (.标题, “目前本校没有在职教员数据”)
.如果结束
2.置文本 (“当前状态：在职教员列表”)
3.置文本 (“提示：双击选择项可查看详细资料，右击选择项可弹出操作菜单！”)
解除打印禁止 ()
赋值 (.现行子夹, 6)


.子程序 _退休教员记录_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [2], “02”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束

赋值 (搜索资料, 假)
赋值 (学生分类, “退休教员”)
9.置列标题 (“退休时间”)
7.置项目文本 (“离校时间”)
赋值 (搜索条件, 相加 (“zzlx like '%”, 学生分类, “%'”))
填充教员列表 ()

赋值 (.标题, 相加 (“自本校退休的教员有”, 到文本 (相加 (男, 女)), “人 其中男”, 到文本 (男), “人 女”, 到文本 (女), “人”))
.如果 (大于 (取表项数 (), 0))
    赋值 (.标题, 相加 (.标题, “退休教员花名册”))
.否则
    赋值 (.标题, “目前本校没有退休教员数据”)
.如果结束

2.置文本 (“当前状态：退休教员列表”)
3.置文本 (“提示： 双击选择项可查看详细资料，右击选择项可弹出操作菜单！”)
解除打印禁止 ()
赋值 (.现行子夹, 6)


.子程序 _凋离教员记录_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [2], “02”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束

赋值 (搜索资料, 假)
赋值 (学生分类, “调离教员”)
9.置列标题 (“调离时间”)
7.置项目文本 (“离校时间”)
赋值 (搜索条件, 相加 (“zzlx like '%”, 学生分类, “%'”))
填充教员列表 ()
赋值 (.标题, 相加 (“已调离本校的教员有”, 到文本 (相加 (男, 女)), “人 其中男”, 到文本 (男), “人 女”, 到文本 (女), “人”))
.如果 (大于 (取表项数 (), 0))
    赋值 (.标题, 相加 (.标题, “调离教员花名册”))
.否则
    赋值 (.标题, “目前本校没有调离教员数据”)
.如果结束
2.置文本 (“当前状态：调离教员列表”)
3.置文本 (“提示： 双击选择项可查看详细资料，右击选择项可弹出操作菜单！”)
解除打印禁止 ()
赋值 (.现行子夹, 6)


.子程序 _在校学生记录_被选择, 空白型, , 在校学生记录
.局部变量 记录集句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 表项, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 班名, 文本型, , , 
.局部变量 wb, 文本型, , "0", 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [1], “00”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束

赋值 (学生分类, “在校学生”)
.如果真 (等于 (填充班级名称 (), 假))
    信息框 (“目前没有班级数据，请先进行校务设置！”, 0, “提示”)
    _教务设置_被选择 ()
    返回 ()
.如果真结束
赋值 (搜索资料, 假)

赋值 (.现行选中项, 0)
赋值 (班名, .内容)
.如果真 (等于 (班名, “”))
    信息框 (“目前没有班级数据!”, 0, “提示”)
    返回 ()
.如果真结束
赋值 (.标题, 相加 (.标题, .取项目文本 (.现行选中项), “学生花名册”))
.如果 (未知支持库函数_3 (连接句柄, 相加 (“select xh,xm,xb,kh,mz,szbj,bnfw,cssj,rxsj,zzdh,zxxz from xsda where szbj like '%”, 班名, “%' and zxxz like '%在校学生%' ORDER BY xh ASC;”)))
    赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
    赋值 (记录数, 未知支持库函数_7 (记录集句柄))
    赋值 (字段数, 未知支持库函数_14 (记录集句柄))
    全部删除 ()
    赋值 (男, 0)
    赋值 (女, 0)
    未知支持库函数_12 (记录集句柄)
    .计次循环首 (记录数, )
        赋值 (表项, -1.插入表项 ())
        .计次循环首 (字段数, 列)
            未知支持库函数_15 (记录集句柄, 相减 (列, 1), 字段名)
            未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
            表项.置标题 (列, 文本变量)
            .如果真 (并且 (等于 (字段名, “xb”), 等于 (文本变量, “男”)))
                赋值 (男, 相加 (男, 1))
            .如果真结束
            .如果真 (并且 (等于 (字段名, “xb”), 等于 (文本变量, “女”)))
                赋值 (女, 相加 (女, 1))
            .如果真结束
            
        .计次循环尾 ()
        未知支持库函数_10 (记录集句柄)
        处理事件 ()
    .计次循环尾 ()
    未知支持库函数_5 (记录集句柄)
    .如果 (等于 (搜索资料, 假))
        2.置文本 (“当前状态：在校学生列表”)
        赋值 (.标题, 相加 (“本班共有”, 到文本 (相加 (男, 女)), “人 其中男生”, 到文本 (男), “人 女生”, 到文本 (女), “人”))
    .否则
        2.置文本 (“    当前状态：搜索学生资料”)
    .如果结束
    
    赋值 (.现行子夹, 3)
    3.置文本 (“ 提示： 双击选择项可查看详细资料，右击选择项可弹出操作菜单！”)
    解除打印禁止 ()
    赋值 (.现行子夹, 3)
.否则
    信息框 (“提取数据错误！”, 0, “提示”)
.如果结束



.子程序 _毕业学生记录_被选择, 空白型, , 
.局部变量 原分类, 文本型, , , 
.局部变量 wb, 文本型, , "0", 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 表项, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [1], “00”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束

赋值 (.可视, 假)
赋值 (.可视, 真)
全部删除 ()
赋值 (.标题, 相加 (.标题, 取文本左边 (时间到文本 (.今天, #日期部分), 6), “毕业学生花名册”))
.如果 (未知支持库函数_3 (连接句柄, “select xh,xm,xb,lskh,mz,szbj,bnfw,cssj,lxsj,zzdh,zxxz from xsda where zxxz like '%毕业学生%' ORDER BY xh ASC;”))
    赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
    赋值 (记录数, 未知支持库函数_7 (记录集句柄))
    赋值 (字段数, 未知支持库函数_14 (记录集句柄))
    赋值 (男, 0)
    赋值 (女, 0)
    未知支持库函数_12 (记录集句柄)
    .计次循环首 (记录数, )
        赋值 (表项, -1.插入表项 ())
        .计次循环首 (字段数, 列)
            未知支持库函数_15 (记录集句柄, 相减 (列, 1), 字段名)
            未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
            表项.置标题 (列, 文本变量)
            .如果真 (并且 (等于 (字段名, “xb”), 等于 (文本变量, “男”)))
                赋值 (男, 相加 (男, 1))
            .如果真结束
            .如果真 (并且 (等于 (字段名, “xb”), 等于 (文本变量, “女”)))
                赋值 (女, 相加 (女, 1))
            .如果真结束
            
        .计次循环尾 ()
        未知支持库函数_10 (记录集句柄)
        处理事件 ()
    .计次循环尾 ()
    未知支持库函数_5 (记录集句柄)
.否则
    
.如果结束
.如果真 (等于 (取表项数 (), 0))
    信息框 (“没有毕业生数据！”, 0, )
    返回 ()
.如果真结束
赋值 (., 0)
2.置文本 (“当前状态：毕业学生列表”)

赋值 (搜索资料, 假)
赋值 (.可视, 真)
赋值 (.标题, “本届搜索”)
赋值 (.现行子夹, 2)
赋值 (.可视, 假)
赋值 (学生分类, “毕业学生”)
赋值 (原分类, 学生分类)
解除打印禁止 ()
赋值 (.标题, 相加 (“本年度毕业生”, 到文本 (相加 (男, 女)), “人 其中男生”, 到文本 (男), “人 女生”, 到文本 (女), “人”))


.子程序 _离退校学生记录_被选择, 空白型, , 
.局部变量 原分类, 文本型, , , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 表项, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 wb, 文本型, , "0", 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [1], “00”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束

赋值 (原分类, 学生分类)
赋值 (学生分类, “离校学生”)
赋值 (.可视, 假)
赋值 (.标题, “开始搜索”)
赋值 (搜索资料, 假)
.如果真 (等于 (填充班级名称 (), 假))
    信息框 (“目前没有班级数据，请先进行校务设置！”, 0, “提示”)
    _教务设置_被选择 ()
    返回 ()
.如果真结束
赋值 (搜索资料, 假)
.如果 (未知支持库函数_3 (连接句柄, “select xh,xm,xb,lskh,mz,szbj,bnfw,cssj,lxsj,zzdh,zxxz from xsda where zxxz like '%离校学生%' ORDER BY xh ASC;”))
    赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
    赋值 (记录数, 未知支持库函数_7 (记录集句柄))
    赋值 (字段数, 未知支持库函数_14 (记录集句柄))
    全部删除 ()
    赋值 (男, 0)
    赋值 (女, 0)
    未知支持库函数_12 (记录集句柄)
    .计次循环首 (记录数, )
        赋值 (表项, -1.插入表项 ())
        .计次循环首 (字段数, 列)
            未知支持库函数_15 (记录集句柄, 相减 (列, 1), 字段名)
            未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
            表项.置标题 (列, 文本变量)
            .如果真 (并且 (等于 (字段名, “xb”), 等于 (文本变量, “男”)))
                赋值 (男, 相加 (男, 1))
            .如果真结束
            .如果真 (并且 (等于 (字段名, “xb”), 等于 (文本变量, “女”)))
                赋值 (女, 相加 (女, 1))
            .如果真结束
            
        .计次循环尾 ()
        未知支持库函数_10 (记录集句柄)
        处理事件 ()
    .计次循环尾 ()
    未知支持库函数_5 (记录集句柄)
.否则
    
.如果结束

赋值 (., 0)
.如果真 (等于 (取表项数 (), 0))
    赋值 (学生分类, 原分类)
    信息框 (“目前本校没有因转学、退学等原因离校的学生数据！”, 0, )
    返回 ()
.如果真结束

赋值 (.标题, 相加 (“本校因转学、退学等原因离校的共有”, 到文本 (相加 (男, 女)), “人 其中男生”, 到文本 (男), “人 女生”, 到文本 (女), “人”))
赋值 (.可视, 真)
赋值 (.标题, 相加 (.标题, “因转学、退学等原因离校的学生花名册”))
2.置文本 (“当前状态：转退学生列表”)
赋值 (.现行子夹, 2)


.子程序 填充教员列表, 空白型, , 
.局部变量 表项, 空白型, , , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 列, 整数型, , , 
.局部变量 error, 文本型, , , 

置等待鼠标 ()
.计次循环首 (9, 表项)
    表项.置列图片 (-1)
.计次循环尾 ()
1.置列图片 (0)
赋值 (排序方式, 真)
赋值 (上次单击列, 1)
 ' 进度条1.调整层次 (#顶层)
 ' 进度条1.位置 ＝ 0
 ' 进度条1.可视 ＝ 真
全部删除 ()
赋值 (男, 0)
赋值 (女, 0)
未知支持库函数_3 (连接句柄, 相加 (“select xm,xb,mz,xl,zc,zw,gzsj,rxsj,dh,sfz,zzlx from jyda where ”, 搜索条件, “ ORDER BY xm ASC;”))
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
赋值 (字段数, 未知支持库函数_14 (记录集句柄))
未知支持库函数_12 (记录集句柄)
.计次循环首 (记录数, )
    赋值 (表项, -1.插入表项 ())
    .计次循环首 (字段数, 列)
        未知支持库函数_15 (记录集句柄, 相减 (列, 1), 字段名)
        未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
        表项.置标题 (列, 文本变量)
        .如果真 (并且 (等于 (字段名, “xb”), 等于 (文本变量, “男”)))
            赋值 (男, 相加 (男, 1))
        .如果真结束
        .如果真 (并且 (等于 (字段名, “xb”), 等于 (文本变量, “女”)))
            赋值 (女, 相加 (女, 1))
        .如果真结束
        
    .计次循环尾 ()
    未知支持库函数_10 (记录集句柄)
    处理事件 ()
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
.如果 (等于 (搜索资料, 真))
    2.置文本 (“当前状态：搜索教员资料”)
.否则
    
.如果结束
获取焦点 ()
恢复鼠标 ()

 ' 取错误文本 (连接句柄, error)
 ' 信息框 (“提取数据错误！” ＋ error, 0, “提示”)


.子程序 _全校搜索_被单击, 空白型, , 全校搜索
.局部变量 记录集句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 表项, 整数型, , , 
.局部变量 列, 整数型, , , 

.如果真 (等于 (填充班级名称 (), 假))
    信息框 (“目前没有班级数据，请先进行校务设置！”, 0, “提示”)
    _教务设置_被选择 ()
    返回 ()
.如果真结束
赋值 (搜索资料, 假)
赋值 (.标题, 相加 (.标题, “全校学生花名册”))
.如果 (.选中)
    .如果 (未知支持库函数_3 (连接句柄, “select xh,xm,xb,kh,mz,szbj,bnfw,cssj,rxsj,zzdh,zxxz from xsda where zxxz like '%在校学生%' ORDER BY xh ASC;”))
        赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
        赋值 (记录数, 未知支持库函数_7 (记录集句柄))
        赋值 (字段数, 未知支持库函数_14 (记录集句柄))
        全部删除 ()
        赋值 (男, 0)
        赋值 (女, 0)
        未知支持库函数_12 (记录集句柄)
        .计次循环首 (记录数, )
            赋值 (表项, -1.插入表项 ())
            .计次循环首 (字段数, 列)
                未知支持库函数_15 (记录集句柄, 相减 (列, 1), 字段名)
                未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
                表项.置标题 (列, 文本变量)
                .如果真 (并且 (等于 (字段名, “xb”), 等于 (文本变量, “男”)))
                    赋值 (男, 相加 (男, 1))
                .如果真结束
                .如果真 (并且 (等于 (字段名, “xb”), 等于 (文本变量, “女”)))
                    赋值 (女, 相加 (女, 1))
                .如果真结束
                
            .计次循环尾 ()
            未知支持库函数_10 (记录集句柄)
            处理事件 ()
        .计次循环尾 ()
        未知支持库函数_5 (记录集句柄)
        .如果 (等于 (搜索资料, 假))
            2.置文本 (“当前状态：在校学生列表”)
            赋值 (.标题, 相加 (“本班共有”, 到文本 (相加 (男, 女)), “人 其中男生”, 到文本 (男), “人 女生”, 到文本 (女), “人”))
        .否则
            2.置文本 (“    当前状态：搜索学生资料”)
        .如果结束
         ' 置排序标 ()
        赋值 (.现行子夹, 3)
        3.置文本 (“ 提示： 双击选择项可查看详细资料，右击选择项可弹出操作菜单！”)
        解除打印禁止 ()
        赋值 (.现行子夹, 3)
    .否则
        信息框 (“提取数据错误！”, 0, “提示”)
    .如果结束
    
.否则
    .如果 (未知支持库函数_3 (连接句柄, “select xh,xm,xb,kh,mz,szbj,bnfw,cssj,rxsj,zzdh,zxxz from xsda  ORDER BY xh ASC;”))
        赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
        赋值 (记录数, 未知支持库函数_7 (记录集句柄))
        赋值 (字段数, 未知支持库函数_14 (记录集句柄))
        全部删除 ()
        赋值 (男, 0)
        赋值 (女, 0)
        未知支持库函数_12 (记录集句柄)
        .计次循环首 (记录数, )
            赋值 (表项, -1.插入表项 ())
            .计次循环首 (字段数, 列)
                未知支持库函数_15 (记录集句柄, 相减 (列, 1), 字段名)
                未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
                表项.置标题 (列, 文本变量)
                .如果真 (并且 (等于 (字段名, “xb”), 等于 (文本变量, “男”)))
                    赋值 (男, 相加 (男, 1))
                .如果真结束
                .如果真 (并且 (等于 (字段名, “xb”), 等于 (文本变量, “女”)))
                    赋值 (女, 相加 (女, 1))
                .如果真结束
                
            .计次循环尾 ()
            未知支持库函数_10 (记录集句柄)
            处理事件 ()
        .计次循环尾 ()
        未知支持库函数_5 (记录集句柄)
        .如果 (等于 (搜索资料, 假))
            2.置文本 (“当前状态：在校学生列表”)
            赋值 (.标题, 相加 (“本班共有”, 到文本 (相加 (男, 女)), “人 其中男生”, 到文本 (男), “人 女生”, 到文本 (女), “人”))
        .否则
            2.置文本 (“    当前状态：搜索学生资料”)
        .如果结束
         ' 置排序标 ()
        赋值 (.现行子夹, 3)
        3.置文本 (“ 提示： 双击选择项可查看详细资料，右击选择项可弹出操作菜单！”)
        解除打印禁止 ()
        赋值 (.现行子夹, 3)
    .否则
        信息框 (“提取数据错误！”, 0, “提示”)
    .如果结束
    
.如果结束



.子程序 _在校生列表班级组合框_列表项被选择, 空白型, , 在校生列表班级组合框
.局部变量 记录集句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 表项, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 班名, 文本型, , , 

赋值 (搜索资料, 假)
赋值 (班名, .内容)
.如果真 (等于 (班名, “”))
    信息框 (“目前没有班级数据!”, 0, “提示”)
    返回 ()
.如果真结束
赋值 (.标题, 相加 (.标题, .取项目文本 (.现行选中项), “学生花名册”))
.如果 (未知支持库函数_3 (连接句柄, 相加 (“select xh,xm,xb,kh,mz,szbj,bnfw,cssj,rxsj,zzdh,zxxz from xsda where szbj like '%”, 班名, “%' and zxxz like '%在校学生%' ORDER BY xh ASC;”)))
    赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
    赋值 (记录数, 未知支持库函数_7 (记录集句柄))
    赋值 (字段数, 未知支持库函数_14 (记录集句柄))
    全部删除 ()
    赋值 (男, 0)
    赋值 (女, 0)
    未知支持库函数_12 (记录集句柄)
    .计次循环首 (记录数, )
        赋值 (表项, -1.插入表项 ())
        .计次循环首 (字段数, 列)
            未知支持库函数_15 (记录集句柄, 相减 (列, 1), 字段名)
            未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
            表项.置标题 (列, 文本变量)
            .如果真 (并且 (等于 (字段名, “xb”), 等于 (文本变量, “男”)))
                赋值 (男, 相加 (男, 1))
            .如果真结束
            .如果真 (并且 (等于 (字段名, “xb”), 等于 (文本变量, “女”)))
                赋值 (女, 相加 (女, 1))
            .如果真结束
            
        .计次循环尾 ()
        未知支持库函数_10 (记录集句柄)
        处理事件 ()
    .计次循环尾 ()
    未知支持库函数_5 (记录集句柄)
    .如果 (等于 (搜索资料, 假))
        2.置文本 (“当前状态：在校学生列表”)
        赋值 (.标题, 相加 (“本班共有”, 到文本 (相加 (男, 女)), “人 其中男生”, 到文本 (男), “人 女生”, 到文本 (女), “人”))
    .否则
        2.置文本 (“    当前状态：搜索学生资料”)
    .如果结束
     ' 置排序标 ()
    赋值 (.现行子夹, 3)
    3.置文本 (“ 提示： 双击选择项可查看详细资料，右击选择项可弹出操作菜单！”)
    解除打印禁止 ()
    赋值 (.现行子夹, 3)
.否则
    信息框 (“提取数据错误！”, 0, “提示”)
.如果结束


.子程序 _班内搜索_被单击, 空白型, , 班内搜索
.局部变量 记录集句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 表项, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 班名, 文本型, , , 
.局部变量 字段, 文本型, , , 

.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“ 请输入搜索条件！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (搜索资料, 真)
赋值 (全局搜索, 假)
.如果真 (等于 (填充班级名称 (), 假))
    信息框 (“目前没有班级数据，请先进行校务设置！”, 0, “提示”)
    _教务设置_被选择 ()
    返回 ()
.如果真结束
.判断开始 (等于 (.内容, “姓名”))
    赋值 (班名, .内容)
    赋值 (字段, “xm”)
.判断 (等于 (.内容, “学号”))
    赋值 (班名, .内容)
    赋值 (字段, “xh”)
.判断 (等于 (.内容, “民族”))
    赋值 (班名, .内容)
    赋值 (字段, “mz”)
.判断 (等于 (.内容, “所在班级”))
    赋值 (班名, .内容)
    赋值 (字段, “szbj”)
.判断 (等于 (.内容, “班内职务”))
    赋值 (班名, .内容)
    赋值 (字段, “bnfw”)
.判断 (等于 (.内容, “入学日期”))
    赋值 (班名, .内容)
    赋值 (字段, “rxsj”)
.判断 (等于 (.内容, “出生日期”))
    赋值 (班名, .内容)
    赋值 (字段, “cssj”)
.默认
    
.判断结束

.如果真 (等于 (班名, “”))
    信息框 (“目前没有班级数据!”, 0, “提示”)
    返回 ()
.如果真结束
赋值 (.标题, 相加 (.标题, .取项目文本 (.现行选中项), “学生花名册”))
.如果 (未知支持库函数_3 (连接句柄, 相加 (“select xh,xm,xb,kh,mz,szbj,bnfw,cssj,rxsj,zzdh,zxxz from xsda where ”, 字段, “ like '%”, 班名, “%' and zxxz like '%在校学生%' ORDER BY xh ASC;”)))
    赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
    赋值 (记录数, 未知支持库函数_7 (记录集句柄))
    赋值 (字段数, 未知支持库函数_14 (记录集句柄))
    全部删除 ()
    赋值 (男, 0)
    赋值 (女, 0)
    未知支持库函数_12 (记录集句柄)
    .计次循环首 (记录数, )
        赋值 (表项, -1.插入表项 ())
        .计次循环首 (字段数, 列)
            未知支持库函数_15 (记录集句柄, 相减 (列, 1), 字段名)
            未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
            表项.置标题 (列, 文本变量)
            .如果真 (并且 (等于 (字段名, “xb”), 等于 (文本变量, “男”)))
                赋值 (男, 相加 (男, 1))
            .如果真结束
            .如果真 (并且 (等于 (字段名, “xb”), 等于 (文本变量, “女”)))
                赋值 (女, 相加 (女, 1))
            .如果真结束
            
        .计次循环尾 ()
        未知支持库函数_10 (记录集句柄)
        处理事件 ()
    .计次循环尾 ()
    未知支持库函数_5 (记录集句柄)
    
    赋值 (.标题, 相加 (.标题, .内容, “部分学生花名册”))
    .如果 (等于 (取表项数 (), 0))
        信息框 (“未找到符合条件的资料！”, 0, )
    .否则
        信息框 (相加 (#换行符, #换行符, “  搜索结果：在”, .内容, “搜索到”, 到文本 (相加 (男, 女)), “个符合条件的学生资料 其中男生”, 到文本 (男), “人 女生”, 到文本 (女), “人  ”), #信息图标, “搜索结果!”)
    .如果结束
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.否则
    信息框 (“提取数据错误！”, 0, “提示”)
.如果结束


.子程序 _在校生列表框_表项被激活, 空白型, , 
.如果真 (等于 (填充班级名称 (), 假))
    信息框 (“目前没有班级数据，请先进行系统设置!”, 0, “提示”)
    _教务设置_被选择 ()
    返回 ()
.如果真结束
填充查看科目 ()
赋值 (学生分类, “在校学生”)
.取标题 (., 5).选择 ()
填充学生姓名 ()
.查找表项数值 (到数值 (.取标题 (., 1))).选择表项 ()
.保证显示 (.)
填充学生资料 ()
3.置文本 (“    提示： 右击姓名列表可弹出操作菜单，双击照片查看可放大的照片。”)
解除打印禁止 ()
赋值 (.现行子夹, 1)


.子程序 _在校生列表框_表头被单击, 空白型, , 
.参数 被单击列索引, 整数型, , 

.局部变量 比较类型, 整数型, , , 

置等待鼠标 ()
.如果 (等于 (被单击列索引, 上次单击列))
    赋值 (排序方式, 取反 (排序方式))
    被单击列索引.置列图片 (取绝对值 (相减 (被单击列索引.取列图片 (), 1)))
.否则
    赋值 (排序方式, 真)
    上次单击列.置列图片 (-1)
    被单击列索引.置列图片 (0)
.如果结束

.判断开始 (或者 (等于 (被单击列索引, 1), 等于 (被单击列索引, 9)))
    赋值 (比较类型, 0)
.判断 (或者 (等于 (被单击列索引, 7), 等于 (被单击列索引, 8)))
    赋值 (比较类型, 2)
.默认
    赋值 (比较类型, 1)
.判断结束

超级列表框排序 (被单击列索引, 比较类型, 真, 排序方式)
赋值 (上次单击列, 被单击列索引)
恢复鼠标 ()


.子程序 _在校生列表框_右键单击表项, 空白型, , 
弹出菜单 ()


.子程序 _毕业离校列表框_右键单击表项, 空白型, , 
弹出菜单 ()

.子程序 _毕业离校列表框_表项被激活, 空白型, , 
.判断开始 (等于 (学生分类, “离校学生”))
    填充学生姓名 ()
    .取标题 (., 2).查找表项 ().选择表项 ()
    .保证显示 (.)
    填充学生资料 ()
    2.置文本 (“    当前状态：查看离校学生资料”)
    3.置文本 (“    提示： 右击姓名列表可弹出操作菜单，双击照片查看可放大的照片。”)
    解除打印禁止 ()
    赋值 (.现行子夹, 1)
.判断 (等于 (学生分类, “毕业学生”))
    赋值 (记录, “select * from 毕业时间表 ”.查询 ())
    .如果真 (等于 (记录, 0))
        记录.关闭记录集 ()
        返回 ()
    .如果真结束
    清空 ()
    记录.到首记录 ()
    .判断循环首 (等于 (记录.尾记录后 (), 假))
        记录.读 (“毕业时间”).加入项目 ()
        记录.到后一记录 ()
    .判断循环尾 ()
    记录.关闭记录集 ()
    .取标题 (., 8).选择 ()
    填充学生姓名 ()
    .取标题 (., 2).查找表项 ().选择表项 ()
    .保证显示 (.)
    填充学生资料 ()
    2.置文本 (“    当前状态：查看毕业学生资料”)
    3.置文本 (“    提示： 双击照片查看可放大的照片。毕业学生的资料不能被修改。”)
    解除打印禁止 ()
    赋值 (.现行子夹, 1)
.默认
    
.判断结束


.子程序 _毕业离校列表框_表头被单击, 空白型, , 
.参数 被单击列索引, 整数型, , 

.局部变量 比较类型, 整数型, , , 

置等待鼠标 ()
.如果 (等于 (被单击列索引, 上次单击列))
    赋值 (排序方式, 取反 (排序方式))
    被单击列索引.置列图片 (取绝对值 (相减 (被单击列索引.取列图片 (), 1)))
.否则
    赋值 (排序方式, 真)
    上次单击列.置列图片 (-1)
    被单击列索引.置列图片 (0)
.如果结束

.判断开始 (或者 (等于 (被单击列索引, 1), 等于 (被单击列索引, 9)))
    赋值 (比较类型, 0)
.判断 (或者 (等于 (被单击列索引, 7), 等于 (被单击列索引, 8)))
    赋值 (比较类型, 2)
.默认
    赋值 (比较类型, 1)
.判断结束

超级列表框排序 (被单击列索引, 比较类型, 真, 排序方式)
赋值 (上次单击列, 被单击列索引)
恢复鼠标 ()


.子程序 _复学操作_被选择, 空白型, , 
 ' 如果真 (权限标签.标题 ≠ “1111”)
 ' 信息框 (“  抱歉！您没有当前的操作权限！  ”, 0, )
 ' 返回 ()
赋值 (选择子夹, 4)
载入 (资料变更窗口, , 真)

.子程序 _档案彻底删除_被选择, 空白型, , 
赋值 (选择子夹, 5)
载入 (资料变更窗口, , 真)

.子程序 _搜索离校_被单击, 空白型, , 搜索离校
.局部变量 记录集句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 表项, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 班名, 文本型, , , 
.局部变量 字段, 文本型, , , 
.局部变量 原分类, 文本型, , , 

.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“ 请输入搜索条件！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (搜索资料, 真)
赋值 (全局搜索, 假)
.判断开始 (等于 (.内容, “姓名”))
    赋值 (班名, .内容)
    赋值 (字段, “xm”)
.判断 (等于 (.内容, “学号”))
    赋值 (班名, .内容)
    赋值 (字段, “xh”)
.判断 (等于 (.内容, “民族”))
    赋值 (班名, .内容)
    赋值 (字段, “mz”)
.判断 (等于 (.内容, “班内职务”))
    赋值 (班名, .内容)
    赋值 (字段, “bnfw”)
.判断 (等于 (.内容, “入学日期”))
    赋值 (班名, .内容)
    赋值 (字段, “rxsj”)
.判断 (等于 (.内容, “出生日期”))
    赋值 (班名, .内容)
    赋值 (字段, “cssj”)
.判断 (等于 (.内容, “离校日期”))
    赋值 (班名, .内容)
    赋值 (字段, “lxsj”)
.默认
    
.判断结束

.如果真 (等于 (班名, “”))
    信息框 (“目前没有班级数据!”, 0, “提示”)
    返回 ()
.如果真结束
.判断开始 (等于 (学生分类, “离校学生”))
    .如果 (未知支持库函数_3 (连接句柄, 相加 (“select xh,xm,xb,kh,mz,szbj,bnfw,cssj,lxsj,zzdh,zxxz from xsda where ”, 字段, “ like '%”, 班名, “%' and zxxz like '%离校学生%' ORDER BY xh ASC;”)))
        赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
        赋值 (记录数, 未知支持库函数_7 (记录集句柄))
        赋值 (字段数, 未知支持库函数_14 (记录集句柄))
        全部删除 ()
        赋值 (男, 0)
        赋值 (女, 0)
        未知支持库函数_12 (记录集句柄)
        .计次循环首 (记录数, )
            赋值 (表项, -1.插入表项 ())
            .计次循环首 (字段数, 列)
                未知支持库函数_15 (记录集句柄, 相减 (列, 1), 字段名)
                未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
                表项.置标题 (列, 文本变量)
                .如果真 (并且 (等于 (字段名, “xb”), 等于 (文本变量, “男”)))
                    赋值 (男, 相加 (男, 1))
                .如果真结束
                .如果真 (并且 (等于 (字段名, “xb”), 等于 (文本变量, “女”)))
                    赋值 (女, 相加 (女, 1))
                .如果真结束
                
            .计次循环尾 ()
            未知支持库函数_10 (记录集句柄)
            处理事件 ()
        .计次循环尾 ()
        未知支持库函数_5 (记录集句柄)
        
        赋值 (., 0)
        .如果真 (等于 (取表项数 (), 0))
            信息框 (“目前本校没有因转学、退学等原因离校的学生数据！”, 0, )
            返回 ()
        .如果真结束
        赋值 (.标题, 相加 (“本校因转学、退学等原因离校的共有”, 到文本 (相加 (男, 女)), “人 其中男生”, 到文本 (男), “人 女生”, 到文本 (女), “人”))
        赋值 (.可视, 真)
        赋值 (.标题, 相加 (.标题, “因转学、退学等原因部分离校的学生花名册”))
        2.置文本 (“当前状态：转退学生列表”)
        赋值 (.现行子夹, 2)
        
    .否则
        信息框 (“提取数据错误！”, 0, “提示”)
    .如果结束
    
.判断 (等于 (学生分类, “毕业学生”))
    .如果 (未知支持库函数_3 (连接句柄, 相加 (“select xh,xm,xb,lskh,mz,szbj,bnfw,cssj,lxsj,zzdh,zxxz from xsda where ”, 字段, “ like '%”, 班名, “%' and zxxz like '%毕业学生%' ORDER BY xh ASC;”)))
        赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
        赋值 (记录数, 未知支持库函数_7 (记录集句柄))
        赋值 (字段数, 未知支持库函数_14 (记录集句柄))
        全部删除 ()
        赋值 (男, 0)
        赋值 (女, 0)
        未知支持库函数_12 (记录集句柄)
        .计次循环首 (记录数, )
            赋值 (表项, -1.插入表项 ())
            .计次循环首 (字段数, 列)
                未知支持库函数_15 (记录集句柄, 相减 (列, 1), 字段名)
                未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
                表项.置标题 (列, 文本变量)
                .如果真 (并且 (等于 (字段名, “xb”), 等于 (文本变量, “男”)))
                    赋值 (男, 相加 (男, 1))
                .如果真结束
                .如果真 (并且 (等于 (字段名, “xb”), 等于 (文本变量, “女”)))
                    赋值 (女, 相加 (女, 1))
                .如果真结束
                
            .计次循环尾 ()
            未知支持库函数_10 (记录集句柄)
            处理事件 ()
        .计次循环尾 ()
        未知支持库函数_5 (记录集句柄)
        赋值 (., 0)
        .如果真 (等于 (取表项数 (), 0))
            信息框 (“目前本校没有毕业的学生数据！”, 0, )
            返回 ()
        .如果真结束
        赋值 (.标题, 相加 (“本校部分毕业生”, 到文本 (相加 (男, 女)), “人 其中男生”, 到文本 (男), “人 女生”, 到文本 (女), “人”))
        
    .否则
        
    .如果结束
    
.默认
    信息框 (“提取数据错误！”, 0, “提示”)
    
.判断结束


.子程序 _历届搜索_被单击, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 表项, 整数型, , , 
.局部变量 日期, 文本型, , , 

全部删除 ()
赋值 (.标题, 相加 (.标题, 取文本左边 (时间到文本 (.今天, #日期部分), 6), “毕业学生花名册”))
赋值 (日期, 取文本左边 (时间到文本 (.今天, #日期部分), 6))
.如果 (未知支持库函数_3 (连接句柄, 相加 (“select xh,xm,xb,lskh,mz,szbj,bnfw,cssj,lxsj,zzdh,zxxz from xsda where zxxz like '%毕业学生%' and lxsj like '%”, 日期, “%' ORDER BY xh ASC;”)))
    赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
    赋值 (记录数, 未知支持库函数_7 (记录集句柄))
    赋值 (字段数, 未知支持库函数_14 (记录集句柄))
    赋值 (男, 0)
    赋值 (女, 0)
    未知支持库函数_12 (记录集句柄)
    .计次循环首 (记录数, )
        赋值 (表项, -1.插入表项 ())
        .计次循环首 (字段数, 列)
            未知支持库函数_15 (记录集句柄, 相减 (列, 1), 字段名)
            未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
            表项.置标题 (列, 文本变量)
            .如果真 (并且 (等于 (字段名, “xb”), 等于 (文本变量, “男”)))
                赋值 (男, 相加 (男, 1))
            .如果真结束
            .如果真 (并且 (等于 (字段名, “xb”), 等于 (文本变量, “女”)))
                赋值 (女, 相加 (女, 1))
            .如果真结束
            
        .计次循环尾 ()
        未知支持库函数_10 (记录集句柄)
        处理事件 ()
    .计次循环尾 ()
    未知支持库函数_5 (记录集句柄)
.否则
    
.如果结束
.如果真 (等于 (取表项数 (), 0))
    信息框 (“没有毕业生数据！”, 0, )
    返回 ()
.如果真结束
赋值 (., 0)
2.置文本 (“当前状态：毕业学生列表”)
赋值 (.标题, 相加 (“本年度毕业生”, 到文本 (相加 (男, 女)), “人 其中男生”, 到文本 (男), “人 女生”, 到文本 (女), “人”))

.子程序 _学生详细档案_被选择, 空白型, , 
清空 ()
“离校学生资料”.加入项目 ()
赋值 (.现行选中项, 0)
赋值 (学生分类, “离校学生”)
填充学生姓名 ()
.如果真 (等于 (取表项数 (), 0))
    赋值 (.标题, “本校目前没有因转学、退学等原因离校的学生资料”)
    信息框 (“目前本校没有因转学、退学等原因离校的学生数据！”, 0, )
    返回 ()
.如果真结束
离校科目 ()
赋值 (., 0)
填充学生资料 ()
3.置文本 (“提示： 右击姓名列表可弹出操作菜单，双击照片查看可放大的照片。”)
解除打印禁止 ()
赋值 (.现行子夹, 1)


.子程序 _变动标签_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (离校说明窗口, _启动窗口, 真)


.子程序 _录入成绩按钮_被单击, 空白型, , 
.局部变量 wb, 文本型, , "0", 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [8], “14”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束


赋值 (选择子夹, 6)
载入 (资料变更窗口, , 真)


.子程序 _平均成绩统计钮_被单击, 空白型, , 


.子程序 _选择框_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    连续赋值 (真, .禁止, .禁止, .禁止)
.否则
    连续赋值 (假, .禁止, .禁止, .禁止)
.如果结束


.子程序 _日期框_选择日期被改变, 空白型, , 
.局部变量 号, 文本型, , , 

赋值 (号码, 分割文本 (.内容, “(”, ))
.如果真 (大于或等于 (取数组成员数 (号码), 2))
    赋值 (号, 取文本左边 (号码 [2], 相减 (取文本长度 (号码 [2]), 1)))
    赋值 (号码条件, 号)
.如果真结束
赋值 (班级条件, .内容)
赋值 (年份条件, 到文本 (取年份 (.今天)))
赋值 (学期条件, .内容)
赋值 (考试类型, .内容)
.如果 (等于 (.选中, 真))
    赋值 (成绩表标题, 相加 (年份条件, “年”, 学期条件, “〖”, 考试类型, “〗”, “各科目成绩表”))
.否则
    .如果 (等于 (.内容, “”))
        赋值 (成绩表标题, 相加 (年份条件, “年”, 学期条件, “〖”, 考试类型, “〗”, .内容, “各科目成绩表”))
    .否则
        赋值 (成绩表标题, 相加 (年份条件, “年”, 学期条件, “〖”, 考试类型, “〗”, .内容, 号码 [1], “同学各科目成绩表”))
    .如果结束
    
.如果结束
赋值 (.标题, 相加 (.标题, 成绩表标题))
刷新成绩表 ()


.子程序 _学期组合框_列表项被选择, 空白型, , 
.局部变量 号, 文本型, , , 

赋值 (号码, 分割文本 (.内容, “(”, ))
.如果真 (大于或等于 (取数组成员数 (号码), 2))
    赋值 (号, 取文本左边 (号码 [2], 相减 (取文本长度 (号码 [2]), 1)))
    赋值 (号码条件, 号)
.如果真结束
赋值 (班级条件, .内容)
赋值 (年份条件, 到文本 (取年份 (.今天)))
赋值 (学期条件, .内容)
赋值 (考试类型, .内容)
.如果 (等于 (.选中, 真))
    赋值 (成绩表标题, 相加 (年份条件, “年”, 学期条件, “〖”, 考试类型, “〗”, “各科目成绩表”))
.否则
    .如果 (等于 (.内容, “”))
        赋值 (成绩表标题, 相加 (年份条件, “年”, 学期条件, “〖”, 考试类型, “〗”, .内容, “各科目成绩表”))
    .否则
        赋值 (成绩表标题, 相加 (年份条件, “年”, 学期条件, “〖”, 考试类型, “〗”, .内容, 号码 [1], “同学各科目成绩表”))
    .如果结束
    
.如果结束
赋值 (.标题, 相加 (.标题, 成绩表标题))
刷新成绩表 ()


.子程序 _考试时间组合框_列表项被选择, 空白型, , 
.局部变量 号, 文本型, , , 

赋值 (号码, 分割文本 (.内容, “(”, ))
.如果真 (大于或等于 (取数组成员数 (号码), 2))
    赋值 (号, 取文本左边 (号码 [2], 相减 (取文本长度 (号码 [2]), 1)))
    赋值 (号码条件, 号)
.如果真结束
赋值 (班级条件, .内容)
赋值 (年份条件, 到文本 (取年份 (.今天)))
赋值 (学期条件, .内容)
赋值 (考试类型, .内容)
.如果 (等于 (.选中, 真))
    赋值 (成绩表标题, 相加 (年份条件, “年”, 学期条件, “〖”, 考试类型, “〗”, “各科目成绩表”))
.否则
    .如果 (等于 (.内容, “”))
        赋值 (成绩表标题, 相加 (年份条件, “年”, 学期条件, “〖”, 考试类型, “〗”, .内容, “各科目成绩表”))
    .否则
        赋值 (成绩表标题, 相加 (年份条件, “年”, 学期条件, “〖”, 考试类型, “〗”, .内容, 号码 [1], “同学各科目成绩表”))
    .如果结束
    
.如果结束
赋值 (.标题, 相加 (.标题, 成绩表标题))

刷新成绩表 ()


.子程序 _班级组合框_列表项被选择, 空白型, , 
.局部变量 号, 文本型, , , 

赋值 (班级条件, .内容)
刷新班级 ()
赋值 (.现行选中项, 0)
赋值 (号码, 分割文本 (.内容, “(”, ))
.如果真 (大于或等于 (取数组成员数 (号码), 2))
    赋值 (号, 取文本左边 (号码 [2], 相减 (取文本长度 (号码 [2]), 1)))
    赋值 (号码条件, 号)
    赋值 (班级条件, .内容)
    赋值 (年份条件, 到文本 (取年份 (.今天)))
    赋值 (学期条件, .内容)
    赋值 (考试类型, .内容)
    .如果 (等于 (.选中, 真))
        赋值 (成绩表标题, 相加 (年份条件, “年”, 学期条件, “〖”, 考试类型, “〗”, “各科目成绩表”))
    .否则
        .如果 (等于 (.内容, “”))
            赋值 (成绩表标题, 相加 (年份条件, “年”, 学期条件, “〖”, 考试类型, “〗”, .内容, “各科目成绩表”))
        .否则
            赋值 (成绩表标题, 相加 (年份条件, “年”, 学期条件, “〖”, 考试类型, “〗”, .内容, 号码 [1], “同学各科目成绩表”))
        .如果结束
        
    .如果结束
    赋值 (.标题, 相加 (.标题, 成绩表标题))
    刷新成绩表 ()
    
.如果真结束


.子程序 _姓名组合框_列表项被选择, 空白型, , 
.局部变量 号, 文本型, , , 

赋值 (号码, 分割文本 (.内容, “(”, ))
.如果真 (大于或等于 (取数组成员数 (号码), 2))
    赋值 (号, 取文本左边 (号码 [2], 相减 (取文本长度 (号码 [2]), 1)))
    赋值 (号码条件, 号)
    赋值 (班级条件, .内容)
    赋值 (年份条件, 到文本 (取年份 (.今天)))
    赋值 (学期条件, .内容)
    赋值 (考试类型, .内容)
    .如果 (等于 (.选中, 真))
        赋值 (成绩表标题, 相加 (年份条件, “年”, 学期条件, “〖”, 考试类型, “〗”, “各科目成绩表”))
    .否则
        .如果 (等于 (.内容, “”))
            赋值 (成绩表标题, 相加 (年份条件, “年”, 学期条件, “〖”, 考试类型, “〗”, .内容, “各科目成绩表”))
        .否则
            赋值 (成绩表标题, 相加 (年份条件, “年”, 学期条件, “〖”, 考试类型, “〗”, .内容, 号码 [1], “同学各科目成绩表”))
        .如果结束
        
    .如果结束
    赋值 (.标题, 相加 (.标题, 成绩表标题))
    刷新成绩表 ()
    
.如果真结束


.子程序 刷新班级, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 T, 整数型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 文本量, 文本型, , , 

.如果真 (等于 (连接句柄, 0))
    信息框 (“没有连接到服务器！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select xh,xm,szbj,zxxz from xsda where szbj like '%”, 班级条件, “%' and zxxz like '%在校学生%' ORDER BY xh ASC;”)), 假)) ' 导出姓名班级记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
赋值 (字段数, 未知支持库函数_14 (记录集句柄))
清空 ()
未知支持库函数_12 (记录集句柄)
.计次循环首 (记录数, T)
    赋值 (文本变量, “”)
    赋值 (文本量, “”)
    未知支持库函数_6 (记录集句柄, “xh”, 文本变量)
    未知支持库函数_6 (记录集句柄, “xm”, 文本量)
    相加 (文本量, “(”, 文本变量, “)”).加入项目 ()
    未知支持库函数_10 (记录集句柄)
    处理事件 ()
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)


.子程序 _查看教员列表框_当前表项被改变, 空白型, , 
填教员资料 ()

.子程序 _查看教员列表框_右键单击表项, 空白型, , 
.如果 (等于 (学生分类, “在职教员”))
    弹出菜单 ()
.否则
    
.如果结束


.子程序 _搜索教员钮_被单击, 空白型, , 
.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“请输入搜索条件！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (搜索资料, 真)
.判断开始 (等于 (.内容, “姓名”))
    赋值 (搜索条件, 相加 (“zzlx like '%”, 学生分类, “%' and xm link '%”, .内容, “'”))
.判断 (等于 (.内容, “性别”))
    赋值 (搜索条件, 相加 (“zzlx like '%”, 学生分类, “%' and xb link '%”, .内容, “'”))
.判断 (等于 (.内容, “民族”))
    赋值 (搜索条件, 相加 (“zzlx like '%”, 学生分类, “%' and mz link '%”, .内容, “'”))
.判断 (等于 (.内容, “学历”))
    赋值 (搜索条件, 相加 (“zzlx like '%”, 学生分类, “%' and xl link '%”, .内容, “'”))
.判断 (等于 (.内容, “职称”))
    赋值 (搜索条件, 相加 (“zzlx like '%”, 学生分类, “%' and zc link '%”, .内容, “'”))
.判断 (等于 (.内容, “职务或岗位”))
    赋值 (搜索条件, 相加 (“zzlx like '%”, 学生分类, “%' and gzgw link '%”, .内容, “'”))
.判断 (等于 (.内容, “参加工作时间”))
    赋值 (搜索条件, 相加 (“zzlx like '%”, 学生分类, “%' and rxsj link '%”, .内容, “'”))
.判断 (等于 (.内容, “住宅电话”))
    赋值 (搜索条件, 相加 (“zzlx like '%”, 学生分类, “%' and dh link '%”, .内容, “'”))
.默认
    赋值 (搜索条件, 相加 (“zzlx like '%”, 学生分类, “%'”))
.判断结束

填充教员列表 ()
.如果 (等于 (取表项数 (), 0))
    信息框 (“未找到符合条件的资料！”, 0, )
.否则
    信息框 (相加 (#换行符, #换行符, “  搜索结果：在全校搜索到”, 到文本 (取表项数 ()), “个符合条件的教员资料 其中男”, 到文本 (男), “人 女”, 到文本 (女), “人  ”), 0, )
.如果结束
获取焦点 ()
赋值 (.被选择字符数, 取文本长度 (.内容))


.子程序 _教员列表框_表项被激活, 空白型, , 
填充教员 ()
.判断开始 (等于 (学生分类, “在职教员”))
    赋值 (.标题, 相加 (“目前本校在职教员有”, 到文本 (取表项数 ()), “人，其中男”, 到文本 (男), “人，女”, 到文本 (女), “人。”))
    2.置文本 (“    当前状态：查看在职教员资料”)
    3.置文本 (“    提示： 右击姓名列表可弹出操作菜单，双击照片查看可放大的照片。”)
.判断 (等于 (学生分类, “退休教员”))
    赋值 (.标题, 相加 (“目前自本校退休的教员有”, 到文本 (取表项数 ()), “人，其中男”, 到文本 (男), “人，女”, 到文本 (女), “人。”))
    2.置文本 (“    当前状态：查看退休教员资料”)
    3.置文本 (“    提示： 双击照片查看可放大的照片。退休教员的资料不能被修改。”)
.判断 (等于 (学生分类, “调离教员”))
    赋值 (.标题, 相加 (“目前调离本校的教员有”, 到文本 (取表项数 ()), “人，其中男”, 到文本 (男), “人，女”, 到文本 (女), “人。”))
    2.置文本 (“当前状态：查看调离本校的教员资料”)
    3.置文本 (“    提示： 双击照片查看可放大的照片。调离教员的资料不能被修改。”)
.默认
    
.判断结束
.查找表项数值 (到数值 (.取标题 (., 0))).选择表项 ()
.保证显示 (.)
填教员资料 ()
解除打印禁止 ()
赋值 (.现行子夹, 5)


.子程序 _教员列表框_右键单击表项, 空白型, , 
.如果 (等于 (学生分类, “在职教员”))
    弹出菜单 ()
.否则
    弹出菜单 ()
.如果结束


.子程序 _教员列表框_表头被单击, 空白型, , 
.参数 被单击列索引, 整数型, , 

.局部变量 比较类型, 整数型, , , 

置等待鼠标 ()
.如果 (等于 (被单击列索引, 上次单击列))
    赋值 (排序方式, 取反 (排序方式))
    被单击列索引.置列图片 (取绝对值 (相减 (被单击列索引.取列图片 (), 1)))
.否则
    赋值 (排序方式, 真)
    上次单击列.置列图片 (-1)
    被单击列索引.置列图片 (0)
.如果结束

.判断开始 (等于 (被单击列索引, 9))
    赋值 (比较类型, 0)
.判断 (或者 (等于 (被单击列索引, 7), 等于 (被单击列索引, 8)))
    赋值 (比较类型, 2)
.默认
    赋值 (比较类型, 1)
.判断结束

超级列表框排序 (被单击列索引, 比较类型, 真, 排序方式)
赋值 (上次单击列, 被单击列索引)
恢复鼠标 ()


.子程序 _教员详细档案_被选择, 空白型, , 


.子程序 _教员恢复操作_被选择, 空白型, , 
.局部变量 变动姓名, 文本型, , , 
.局部变量 变动号码, 文本型, , , 
.局部变量 条件, 文本型, , , 
.局部变量 error, 文本型, , , 

.如果 (等于 (_启动窗口..现行子夹, 5))
    .如果真 (等于 (., -1))
        信息框 (“  请选择要恢复资料的教员姓名！  ”, 0, “提示”)
        返回 ()
    .如果真结束
    赋值 (变动号码, .标题)
    赋值 (变动姓名, .标题)
    
.否则
    .如果真 (等于 (., -1))
        信息框 (“  请选择要恢复资料的教员姓名！  ”, 0, “提示”)
        返回 ()
    .如果真结束
    赋值 (变动号码, .取标题 (., 10))
    赋值 (变动姓名, .取标题 (., 1))
.如果结束

.如果真 (不等于 (信息框 (“  您确定要将当前教员的档案资料恢复到在职教员数据中吗？  ”, 相加 (#询问图标, #确认取消钮), “询问”), #确认钮))
    返回 ()
.如果真结束
赋值 (条件, 相加 (“sfz='”, 变动号码, “'”))
.如果真 (等于 (连接句柄, 0))
    载入 (登录窗口, , 真)
    返回 ()
.如果真结束
.如果 (未知支持库函数_19 (连接句柄, “jyda”, “txsj=' ',txyy=' ',zzlx='在职教员'”, 条件))
    赋值 (搜索条件, “zzlx like '%在职教员%'”)
    .判断开始 (等于 (学生分类, “退休教员”))
        _退休教员记录_被选择 ()
    .判断 (等于 (学生分类, “调离教员”))
        _凋离教员记录_被选择 ()
    .默认
        
    .判断结束
    赋值 (_启动窗口.., 0)
    赋值 (记录日志, 相加 (“教员”, 变动姓名, “恢复操作成功”))
    写日志 ()
    信息框 (“恢复退休教员档案操作完成！”, 0, )
    
.否则
    未知支持库函数_41 (连接句柄, error)
    赋值 (.标题, 相加 (_启动窗口..标题, “目前没有退休教员的资料”))
    信息框 (相加 (“恢复退休教员档案操作失败！”, error), 0, )
.如果结束


.子程序 _教员档案彻底删除_被选择, 空白型, , 
.如果 (等于 (_启动窗口..现行子夹, 5))
    .如果真 (等于 (., -1))
        信息框 (“  请选择要删除资料的教员姓名！  ”, 0, “提示”)
        返回 ()
    .如果真结束
    
.否则
    .如果真 (等于 (., -1))
        信息框 (“  请选择要删除资料的教员姓名！  ”, 0, “提示”)
        返回 ()
    .如果真结束
    
.如果结束

.判断开始 (等于 (学生分类, “调离教员”))
    .如果真 (等于 (信息框 (“  您确认要删除当前教员的资料吗？  ”, 相加 (#警告图标, #确认取消钮), “询问”), #确认钮))
        .如果 (等于 (.现行子夹, 1))
            相加 (“delete * from 调离表 where 编号=”, 到文本 (.取表项数值 (.))).执行 ()
            .删除表项 (.)
            赋值 (., 0)
            .如果真 (大于 (取表项数 (), 0))
                填充教员资料 ()
            .如果真结束
            
        .否则
            相加 (“delete * from 调离表 where 编号=”, .取标题 (., 0)).执行 ()
            .删除表项 (.)
            赋值 (., 0)
        .如果结束
        
    .如果真结束
    
.判断 (等于 (学生分类, “退休教员”))
    .如果真 (等于 (信息框 (“  您确认要删除当前教员的资料吗？  ”, 相加 (#警告图标, #确认取消钮), “询问”), #确认钮))
        .如果 (等于 (.现行子夹, 1))
            相加 (“delete * from 退休表 where 编号=”, 到文本 (.取表项数值 (.))).执行 ()
            .删除表项 (.)
            赋值 (., 0)
            .如果真 (大于 (取表项数 (), 0))
                填充教员资料 ()
            .如果真结束
            
        .否则
            相加 (“delete * from 退休表 where 编号=”, .取标题 (., 0)).执行 ()
            .删除表项 (.)
            赋值 (., 0)
        .如果结束
        
    .如果真结束
    
.默认
    
.判断结束


.子程序 _放大_被选择, 空白型, , 
赋值 (.缩放比, 相加 (.缩放比, 10))

.子程序 _缩小_被选择, 空白型, , 
赋值 (.缩放比, 相减 (.缩放比, 10))

.子程序 _打印预览_被选择, 空白型, , 
打印预览 ()

.子程序 _成绩表格_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _就餐刷卡记录_被选择, 空白型, , 
2.置文本 (“当前状态：查看就餐刷卡记录”)
3.置文本 (“提示：右击姓名列表可弹出操作菜单。”)
赋值 (.现行子夹, 9)


.子程序 _上放学刷卡记录_被选择, 空白型, , 
2.置文本 (“当前状态：上放学刷卡记录”)
3.置文本 (“提示：右击姓名列表可弹出操作菜单。”)
赋值 (.现行子夹, 10)


.子程序 _教员工资_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [18], “34”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束

2.置文本 (“当前状态：工资表”)
3.置文本 (“提示：右击姓名列表可弹出操作菜单。”)
打开工资表 ()
赋值 (.现行子夹, 7)

.子程序 _时钟2_周期事件, 空白型, , 
.如果 (等于 (0.取图片 (), 260))
    0.置图片 (259)
.否则
    0.置图片 (260)
.如果结束


.子程序 _操作日志_被选择, 空白型, , 
载入 (日志, , 假)

.子程序 _学生成绩分析_被选择, 空白型, , 
.如果真 (等于 (填充班级名称 (), 假))
    信息框 (“目前没有班级数据，请先进行校务设置!”, 0, “提示”)
    _教务设置_被选择 ()
    返回 ()
.如果真结束
赋值 (.现行选中项, 0)
赋值 (.现行子夹, 11)


.子程序 _刷新曲线按钮_被单击, 空白型, , 
.局部变量 条件, 文本型, , , 
.局部变量 姓名, 文本型, , , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 B, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 科目数, 整数型, , , 
.局部变量 分数, 整数型, , , 
.局部变量 N, 整数型, , , 
.局部变量 T, 整数型, , , 
.局部变量 科目成员, 文本型, , "0", 
.局部变量 分成员, 文本型, , "0", 
.局部变量 I, 整数型, , , 

赋值 (.现行选中项, 0)
赋值 (年份条件, 到文本 (取年份 (.今天)))
赋值 (成绩表标题, 相加 (年份条件, “年学生成绩分析图”))
赋值 (.标题, 相加 (.标题, 成绩表标题))
赋值 (学期条件, .内容)
赋值 (考试类型, .内容)
赋值 (班级条件, .内容)
 ' 姓名 ＝ 姓名框.内容


.如果真 (等于 (班级条件, “”))
    返回 ()
.如果真结束
赋值 (条件, 相加 (“bj like '%”, 班级条件, “%' and xh like '%”, 号码条件, “%' and nf like '%”, 年份条件, “%' and xq like '%”, 学期条件, “%' and kslx like '%”, 考试类型, “%'”))

.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select * from cjb where ”, 条件, “ ORDER BY xh ASC;”)), 假)) ' 导出科目记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
赋值 (字段数, 未知支持库函数_14 (记录集句柄))
未知支持库函数_12 (记录集句柄)
赋值 (., 记录数)

未知支持库函数_12 (记录集句柄)
.计次循环首 (记录数, T)
    未知支持库函数_6 (记录集句柄, “xm”, 文本变量)
    赋值 (., 相减 (T, 1))
    赋值 (., 文本变量)
    未知支持库函数_10 (记录集句柄)
    处理事件 ()
.计次循环尾 ()

未知支持库函数_12 (记录集句柄)
.计次循环首 (记录数, T)
    .计次循环首 (字段数, B)
        未知支持库函数_15 (记录集句柄, 相减 (B, 1), 字段名)
        未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
        .如果真 (等于 (取文本左边 (字段名, 3), “cjz”))
            .如果真 (不等于 (文本变量, “”))
                加入成员 (科目成员, 文本变量)
                
            .如果真结束
            
        .如果真结束
        .如果真 (等于 (取文本左边 (字段名, 3), “cjm”))
            加入成员 (分成员, 文本变量)
            
        .如果真结束
        
    .计次循环尾 ()
    赋值 (., 科目数)
    
    .计次循环首 (科目数, I)
        赋值 (., 相减 (I, 1))
        赋值 (., 相加 (科目成员 [I], “成绩”))
        赋值 (., 到数值 (分成员 [I]))
        .判断开始 (等于 (I, 1))
            赋值 (., #蓝色)
        .判断 (等于 (I, 2))
            赋值 (., #红色)
        .判断 (等于 (I, 3))
            赋值 (., #绿色)
        .判断 (等于 (I, 4))
            赋值 (., #黄色)
        .判断 (等于 (I, 5))
            赋值 (., #紫色)
        .判断 (等于 (I, 6))
            赋值 (., #蓝灰)
        .判断 (等于 (I, 7))
            赋值 (., #粉红)
        .判断 (等于 (I, 8))
            赋值 (., #嫩黄)
        .判断 (等于 (I, 9))
            赋值 (., #嫩绿)
        .判断 (等于 (I, 10))
            赋值 (., #橙黄)
        .判断 (等于 (I, 11))
            赋值 (., #艳青)
        .判断 (等于 (I, 12))
            赋值 (., #桃红)
        .默认
            赋值 (., #深灰)
        .判断结束
        
    .计次循环尾 ()
    未知支持库函数_10 (记录集句柄)
    处理事件 ()
.计次循环尾 ()

未知支持库函数_5 (记录集句柄)
恢复鼠标 ()


.子程序 _班级框_列表项被选择, 空白型, , 
.局部变量 班条件, 文本型, , , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 文本量, 文本型, , , 

.如果真 (等于 (连接句柄, 0))
    信息框 (“没有连接到服务器！”, 0, )
    返回 ()
.如果真结束
赋值 (班条件, .内容)
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select xh,xm,szbj,zxxz from xsda where szbj like '%”, 班条件, “%' and zxxz like '%在校学生%' ORDER BY xh ASC;”)), 假)) ' 导出姓名班级记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
清空 ()
未知支持库函数_12 (记录集句柄)
.计次循环首 (记录数, )
    未知支持库函数_6 (记录集句柄, “xm”, 文本量)
    文本量.加入项目 ()
    未知支持库函数_10 (记录集句柄)
    处理事件 ()
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
赋值 (.现行选中项, 0)

.子程序 _记事本_被选择, 空白型, , 
运行 (“NOTEPAD.EXE”, 假, )

.子程序 _计算器_被选择, 空白型, , 
运行 (“CALC.EXE”, 假, )

.子程序 _音乐1_被选择, 空白型, , 
赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)
.判断开始 (文件是否存在 (相加 (取运行目录 (), “\Sound\Music1.mid”)))
    停止播放 ()
    播放音乐 (相加 (取运行目录 (), “\sound\Music1.mid”), 真)
.判断 (文件是否存在 (相加 (取运行目录 (), “\Sound\Music1.wav”)))
    停止播放 ()
    播放音乐 (相加 (取运行目录 (), “\sound\Music1.wav”), 真)
.判断 (文件是否存在 (相加 (取运行目录 (), “\Sound\Music1.mp3”)))
    停止播放 ()
    播放MP3 (-1, 相加 (取运行目录 (), “\sound\Music1.mp3”))
.默认
    信息框 (相加 (“找不到背景音乐文件”, #左引号, “Music1”, #右引号, “或该文件已损坏！”), 0, )
.判断结束


.子程序 _音乐2_被选择, 空白型, , 
赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)
.判断开始 (文件是否存在 (相加 (取运行目录 (), “\Sound\Music2.mid”)))
    停止播放 ()
    播放音乐 (相加 (取运行目录 (), “\sound\Music2.mid”), 真)
.判断 (文件是否存在 (相加 (取运行目录 (), “\Sound\Music2.wav”)))
    停止播放 ()
    播放音乐 (相加 (取运行目录 (), “\sound\Music2.wav”), 真)
.判断 (文件是否存在 (相加 (取运行目录 (), “\Sound\Music2.mp3”)))
    停止播放 ()
    播放MP3 (-1, 相加 (取运行目录 (), “\sound\Music2.mp3”))
.默认
    信息框 (相加 (“找不到背景音乐文件”, #左引号, “Music2”, #右引号, “或该文件已损坏！”), 0, )
.判断结束


.子程序 _其它音乐_被选择, 空白型, , 
.如果真 (打开 ())
    停止播放 ()
    赋值 (.选中, 真)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    .如果 (等于 (取文本右边 (.文件名, 3), “mp3”))
        播放MP3 (-1, .文件名)
    .否则
        播放音乐 (.文件名, 真)
    .如果结束
    
.如果真结束


.子程序 _关闭音乐_被选择, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
停止播放 ()

.子程序 __启动窗口_将被销毁, 空白型, , 
删除文件 (相加 (取当前目录 (), “\myfial.ini”))

.子程序 _刷卡机系统设置_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

赋值 (.现行子夹, 0)
载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [12], “22”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束

载入 (卡机设置管理, _启动窗口, 真)


.子程序 _毕业升级分班管理_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

赋值 (.现行子夹, 0)
载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [5], “08”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
赋值 (处理类型, 1)
载入 (毕业升级管理, _启动窗口, 真)

.子程序 _宿舍管理_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

赋值 (.现行子夹, 0)
载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [19], “38”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
载入 (宿舍管理, , 真)

.子程序 _打开本校网站_被选择, 空白型, , 
.局部变量 地址, 文本型, , , 

.如果 (输入框 (“    输入本校网站地址。如：http:// www.runlian.net”, “输入网址：......”, “http://localhost/huangpu.php”, 地址, #输入文本))
    赋值 (., 地址)
    赋值 (.现行子夹, 13)
.否则
    赋值 (.现行子夹, 0)
.如果结束



.子程序 _伙食建帐_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

赋值 (.现行子夹, 0)
载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [15], “28”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题须请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束

赋值 (采集类型, 1)
载入 (伙食建帐窗口, , 真)

.子程序 _选择夹_子夹被改变, 空白型, , 
赋值 (., “”)

.子程序 _物资采购建帐_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

赋值 (.现行子夹, 0)
载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [13], “24”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束


赋值 (采集类型, 2)
载入 (伙食建帐窗口, , 真)


.子程序 打开工资表, 逻辑型, , 
刷新工资表 ()
取工资表 ()
赋值 (工资表标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 到文本 (取月份 (取现行时间 ())), “月份教师工资表”))
赋值 (.标题, 工资表标题)
赋值 (.内容, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 到文本 (取月份 (取现行时间 ())), “月份”))
解除打印禁止 ()
获取焦点 ()
赋值 (.现行子夹, 7)
返回 (真)

.子程序 _标题设置_被选择, 空白型, , 
载入 (工资系统设置窗口, , 真)
获取焦点 ()

.子程序 _工资设置按钮_被单击, 空白型, , 
_标题设置_被选择 ()

.子程序 刷新工资表, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 条件, 文本型, , , 
.局部变量 A, 整数型, , , 

0.初始尺寸 (0)
2.添加行 ()
1.插入列 (12)
1.置列宽 (12, 相除 (_启动窗口., 4.2))
1.置列宽 (1, 150)
12.置列宽 (1, 260)
1.合并 (1, 2, 1)
1.合并 (2, 2, 1)
1.合并 (3, 1, 5)
1.合并 (8, 1, 2)
1.合并 (10, 2, 1)
1.合并 (11, 2, 1)
1.合并 (12, 2, 1)
1.置文本 (1, “序号”)
1.置文本 (2, “姓 名”)
1.置文本 (3, “应发工资”)
1.置文本 (8, “扣回工资”)
2.置文本 (3, “基本工资”)
2.置文本 (4, “加班工资”)
2.置文本 (5, “奖 金”)
2.置文本 (6, “补 贴1”)
2.置文本 (7, “补 贴2”)
2.置文本 (8, “请假扣除”)
2.置文本 (9, “其它扣除”)
1.置文本 (10, “实发工资”)
1.置文本 (11, “备 注”)
1.置文本 (12, “签 名”)
2.置表头行数 ()

检查连接 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, “select xm from jyda;”), 假))
    提示错误 ()
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
相加 (记录数, 2).添加行 ()
.计次循环首 (记录数, A)
    相加 (A, 2).置文本 (1, 到文本 (A))
    未知支持库函数_6 (记录集句柄, “xm”, 文本变量)
    相加 (A, 2).置文本 (2, 文本变量)
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)

相加 (记录数, 4).置文本 (1, “合计”)
相加 (记录数, 4).置文本 (2, “人民币：”)

1.置只读方式 (1, 取行数 (), 2, 真)
1.置对齐方式 (1, 取行数 (), 12, 5)
3.置文本输入格式 (3, 相减 (取行数 (), 4), 6, 6)
3.置光标 (2)
2.置行高 (取行数 (), 65)
获取焦点 ()
2.置文本 (“当前状态：工资管理”)
3.置文本 (“提示：用鼠标或方向键移动方格光标。”)


.子程序 _工资表格_内容被改变, 空白型, , 
.参数 行号, 整数型, , 
.参数 列号, 整数型, , 
.参数 行数, 整数型, , 
.参数 列数, 整数型, , 

.局部变量 记录行数, 整数型, , , 
.局部变量 记录列数, 整数型, , , 
.局部变量 H, 整数型, , , 
.局部变量 L, 整数型, , , 
.局部变量 匿名局部变量_13910, 空白型, , , 
.局部变量 金额, 双精度小数型, , , 
.局部变量 金额1, 双精度小数型, , , 
.局部变量 金, 双精度小数型, , , 

赋值 (记录行数, 相减 (取行数 (), 4))
赋值 (记录列数, 相减 (取列数 (), 4))
.计次循环首 (记录行数, H)
    赋值 (L, 0)
    赋值 (金额, 0)
    .计次循环首 (相减 (记录列数, 3), L)
        赋值 (金额, 相加 (金额, 到数值 (相加 (H, 2).取文本 (相加 (L, 2)))))
    .计次循环尾 ()
    赋值 (L, 0)
    赋值 (金额1, 0)
    .计次循环首 (相减 (记录列数, 6), L)
        赋值 (金额1, 相加 (金额1, 到数值 (相加 (H, 2).取文本 (相加 (L, 7)))))
    .计次循环尾 ()
    赋值 (金, 相减 (金额, 金额1))
    相加 (H, 2).置文本 (10, 数值到格式文本 (金, 2, 假))
.计次循环尾 ()


.计次循环首 (记录列数, L)
    赋值 (金额, 0)
    .计次循环首 (记录行数, H)
        赋值 (金额, 四舍五入 (相加 (金额, 到数值 (相加 (H, 2).取文本 (相加 (L, 2)))), 2))
    .计次循环尾 ()
    .如果 (不等于 (金额, 0))
        取行数 ().置文本 (相加 (L, 2), 数值到格式文本 (金额, 2, 假))
    .否则
        取行数 ().置文本 (相加 (L, 2), “”)
        
    .如果结束
    
.计次循环尾 ()



.子程序 _插入一行钮_被单击, 空白型, , 
.局部变量 工资字节集, 字节集, , , 
.局部变量 总金额, 文本型, , , 

.如果真 (或者 (等于 (.标题, “0”), 等于 (.标题, “”)))
    返回 ()
.如果真结束
检查连接 ()
保存更改 ()
刷新显示 ()
赋值 (工资字节集, 存到字节集 ())
赋值 (总金额, 取行数 ().取文本 (10))

.如果 (取数据库重复记录 (连接句柄, “gzb”, “bm”, .标题))
    .如果真 (未知支持库函数_19 (连接句柄, “gzb”, 相加 (“jbsj='”, 时间到文本 (取现行时间 (), #日期部分), “',jbr='”, 读配置项 (相加 (取当前目录 (), “\myfial.ini”), “setup”, “SJSMC”, ), “',zje='”, 总金额, “'”), 相加 (“bm='”, .标题, “'”)))
        .如果真 (未知支持库函数_46 (连接句柄, “gzb”, “gzb”, 相加 (“bm='”, .标题, “'”), 工资字节集))
            赋值 (记录日志, 相加 (“更新”, .标题, “记录完成”))
            写日志 ()
            信息框 (相加 (“更新”, .标题, “记录完成!”), 0, )
            取工资表 ()
            返回 ()
        .如果真结束
        
    .如果真结束
    提示错误 ()
.否则
    .如果真 (未知支持库函数_18 (连接句柄, “gzb”, 相加 (“bm='”, .标题, “',jbsj='”, 时间到文本 (取现行时间 (), #日期部分), “',jbr='”, 读配置项 (相加 (取当前目录 (), “\myfial.ini”), “setup”, “SJSMC”, ), “',zje='”, 总金额, “'”)))
        .如果真 (未知支持库函数_46 (连接句柄, “gzb”, “gzb”, 相加 (“bm='”, .标题, “'”), 工资字节集))
            赋值 (记录日志, 相加 (“增加”, .标题, “记录完成”))
            写日志 ()
            信息框 (相加 (“增加”, .标题, “记录完成!”), 0, )
            取工资表 ()
            返回 ()
        .如果真结束
        
    .如果真结束
    提示错误 ()
    
.如果结束


.子程序 _新建按钮_被单击, 空白型, , 
.如果真 (等于 (是否修改, 假))
    刷新工资表 ()
    载入 (工资系统设置窗口, , 真)
    获取焦点 ()
.如果真结束


.子程序 取工资表, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 bl, 文本型, , , 

检查连接 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, “select bm from gzb ORDER BY bm ASC;”), 假))
    提示错误 ()
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
清空 ()
.计次循环首 (记录数, )
    未知支持库函数_6 (记录集句柄, “bm”, bl)
    bl.加入项目 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
赋值 (.现行选中项, 0)

.子程序 _工资表组合框_列表项被选择, 空白型, , 
.局部变量 表名, 文本型, , , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 工资, 字节集, , , 

赋值 (表名, .内容)
.如果真 (等于 (表名, “”))
    返回 ()
.如果真结束
检查连接 ()
.如果真 (未知支持库函数_3 (连接句柄, 相加 (“select bm,gzb from gzb where bm='”, 表名, “';”)))
    赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
    赋值 (记录数, 未知支持库函数_7 (记录集句柄))
    0.初始尺寸 (0)
    未知支持库函数_6 (记录集句柄, “gzb”, 工资)
    工资.从字节集读 ()
    刷新显示 ()
    赋值 (.标题, 表名)
    返回 ()
.如果真结束
提示错误 ()


.子程序 _删除一行钮_被单击, 空白型, , 
.局部变量 表名, 文本型, , , 

赋值 (表名, .内容)
.如果真 (等于 (表名, “”))
    返回 ()
.如果真结束
检查连接 ()
.如果真 (等于 (信息框 (相加 (“此操作将删除”, 表名, “，按确认键继续！”), 相加 (#确认取消钮, #警告图标), “删除警告!!!”), #取消钮))
    返回 ()
.如果真结束
.如果真 (未知支持库函数_20 (连接句柄, “gzb”, 相加 (“bm='”, 表名, “'”)))
    赋值 (记录日志, 相加 (“删除”, .标题, “记录完成”))
    写日志 ()
    信息框 (相加 (“删除”, .标题, “记录完成!”), 0, )
    刷新工资表 ()
    取工资表 ()
    返回 ()
.如果真结束
提示错误 ()


.子程序 _工资表格_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (等于 (键代码, #Del键))
    取光标行号 ().清除 (取光标列号 (), 取选择行数 (), 取选择列数 ())
.判断 (等于 (键代码, #回车键))
    取光标行号 ().置光标 (相加 (取光标列号 (), 1))
.默认
    
.判断结束


.子程序 _凭证摘要设置_被选择, 空白型, , 
载入 (凭证摘要窗口, , 真)

.子程序 _凭证科目设置_被选择, 空白型, , 
载入 (会计科目窗口, , 真)

.子程序 _费用报销_被选择, 空白型, , 
载入 (费用报销窗口, , 真)


.子程序 _新学期学生报名_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

赋值 (.现行子夹, 0)
载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [5], “08”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
赋值 (处理类型, 2)
载入 (毕业升级管理, , 真)

.子程序 _报名单据查询打印_被选择, 空白型, , 
.局部变量 wb, 文本型, , "0", 

赋值 (.现行子夹, 0)
载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [5], “08”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
载入 (报名单据窗口, , 真)


.子程序 _离校刷卡记录_被选择, 空白型, , 


.窗口程序集 登录窗口程序集, , , 

.程序集变量 数量, 整数型, , , 
.程序集变量 数量A, 整数型, , , 
.程序集变量 时间, 整数型, , , 
.子程序 _按钮1_被单击, 空白型, , 
置等待鼠标 ()
赋值 (., “正在远程数据库连接,需要10多秒等待......”)
登录 ()
赋值 (记录日志, “登录MYSQL成功”)
写日志 ()

.子程序 登录, 空白型, , 
.局部变量 ID, 文本型, , , 
.局部变量 增加记录值, 文本型, , , 
.局部变量 新建, 逻辑型, , , 
.局部变量 nem, 文本型, , , 
.局部变量 服务器版本, 文本型, , , 

赋值 (ID, .内容)
赋值 (nem, .内容)
赋值 (连接句柄, 未知支持库函数_1 (ID, nem, .内容, .内容, 到数值 (.内容)))
.如果 (等于 (连接句柄, 0))
    信息框 (“连接远程MySQL数据库失败！”, #信息图标, “提示！”)
    赋值 (数量, 0)
    赋值 (数量A, 0)
    赋值 (时间, 0)
    返回 ()
.否则
    写配置项 (相加 (取当前目录 (), “\myfial.ini”), “setup”, “net”, ID)
    写配置项 (相加 (取当前目录 (), “\myfial.ini”), “setup”, “SJSMC”, nem)
    写配置项 (相加 (取当前目录 (), “\myfial.ini”), “setup”, “yhyy2”, 文本加密 (.内容, “Ntmdbzdb”))
    写配置项 (相加 (取当前目录 (), “\myfial.ini”), “setup”, “WD”, 文本加密 (.内容, “Ntmdbzdb”))
.如果结束

赋值 (新建, 假)
.如果 (等于 (未知支持库函数_27 (连接句柄, .内容), 假))
    .如果 (未知支持库函数_25 (连接句柄, .内容))
        赋值 (新建, 真)
        信息框 (相加 (“第一次登录服务器，创建库《”, .内容, “》成功！”), 0, )
    .否则
        
    .如果结束
    
.否则
    
.如果结束
未知支持库函数_2 (连接句柄)
赋值 (连接句柄, 0)

.如果真 (等于 (ID, “”))
    信息框 (“没有登录域或IP地址！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (nem, “”))
    信息框 (“没有选择用户名！”, 0, )
    返回 ()
.如果真结束
赋值 (连接句柄, 未知支持库函数_1 (ID, nem, .内容, .内容, 到数值 (.内容)))
.如果 (不等于 (连接句柄, 0))
    赋值 (., 相加 (“数据库连接成功!”, “ 数据库句柄:”, 到文本 (连接句柄)))
    删除成员 (登录信息, 1, 6)
    加入成员 (登录信息, ID)
    加入成员 (登录信息, nem)
    加入成员 (登录信息, .内容)
    加入成员 (登录信息, .内容)
    加入成员 (登录信息, .内容)
    加入成员 (登录信息, ID)
    .如果真 (打开 (相加 (取运行目录 (), “\sql\sysmm.edb”), , , , , , ))
        到首记录 ()
        .如果 (查找 (等于 (读 (3), ID)))
            
        .否则
            加记录 (ID)
        .如果结束
        到首记录 ()
        .如果 (查找 (等于 (读 (6), nem)))
            修改 (nem, )
        .否则
            加记录 (nem, , nem)
        .如果结束
        关闭 (相加 (取运行目录 (), “\sql\sysmm.edb”))
    .如果真结束
    销毁 ()
.否则
    _启动窗口.置文本 (., 0, “ 连接服务器失败！”) ' 245
    _启动窗口.置文本 (., 1, “mySQL连接断开”)
    _启动窗口.置图片 (., 0, 245) ' 245
    赋值 (_启动窗口..时钟周期, 0)
    赋值 (.内容, “”)
    返回 ()
.如果结束
_启动窗口.置文本 (., 0, “ 连接服务器成功！”)
赋值 (_启动窗口..时钟周期, 500)
未知支持库函数_23 (连接句柄, 服务器版本)
_启动窗口.置文本 (., 1, 相加 (“服务器版本:”, 服务器版本))
 ' 创建日志库 ()
赋值 (_启动窗口., 相加 (读配置项 (相加 (取运行目录 (), “\config.ini”), “School”, “Name”, ), #软件名, “  当前管理员:”, 读配置项 (相加 (取当前目录 (), “\myfial.ini”), “setup”, “SJSMC”, )))

.子程序 _按钮2_被单击, 空白型, , 
.如果真 (等于 (信息框 (“此操作将不能登录服务器,并且无法进行数据交换操作！需要继续操作吗？”, 相加 (#信息图标, #是否钮), ), 5))
    未知支持库函数_2 (连接句柄)
    赋值 (连接句柄, 0)
    _启动窗口.置文本 (., 0, “ 连接服务器断开！”) ' 245
    _启动窗口.置图片 (., 0, 245) ' 245
    赋值 (_启动窗口..时钟周期, 0)
    销毁 ()
.如果真结束


.子程序 _按钮3_被单击, 空白型, , 
.如果真 (等于 (信息框 (“此操作将不能登录服务器,并且关闭系统”, 相加 (#信息图标, #是否钮), ), 5))
    未知支持库函数_2 (连接句柄)
    赋值 (连接句柄, 0)
    销毁 ()
    结束 ()
.如果真结束


.子程序 找ID库, 空白型, , 
.如果真 (等于 (打开 (相加 (取运行目录 (), “\sql\sysmm.edb”), , , , , , ), 假))
    创建临时库 ()
.如果真结束
关闭 (相加 (取运行目录 (), “\sql\sysmm.edb”))
.如果真 (等于 (打开 (相加 (取运行目录 (), “\sql\sysmm.edb”), , , , , , ), 假))
    返回 ()
.如果真结束
到首记录 ()
.计次循环首 (取记录数 (), )
    .如果真 (不等于 (读 (3), “”))
        读 (3).加入项目 ()
    .如果真结束
    .如果真 (不等于 (读 (6), “”))
        读 (6).加入项目 ()
    .如果真结束
    跳过 ()
.计次循环尾 ()
到首记录 ()
关闭 (相加 (取运行目录 (), “\sql\sysmm.edb”))

.子程序 创建日志库, 空白型, , 日志库
.局部变量 字段MYSQL, 未知类型0x40001, , "1", 

.如果真 (等于 (未知支持库函数_32 (连接句柄, “rzjl”), 假))
    赋值 (字段MYSQL [1]., #)
    赋值 (字段MYSQL [1]., “rz”)
    赋值 (字段MYSQL [1]., #)
    赋值 (字段MYSQL [1]., #)
    赋值 (字段MYSQL [1]., “60”)
    .如果真 (等于 (未知支持库函数_29 (连接句柄, “rzjl”, 字段MYSQL), 假))
        信息框 (“建立日志库失败！”, 0, )
    .如果真结束
    
.如果真结束


.子程序 创建临时库, 空白型, , 建立用户名称还原
.局部变量 字段, 字段信息, , "7", 

赋值 (字段 [1].名称, “序号”)
赋值 (字段 [1].类型, #文本型)
赋值 (字段 [1].最大文本长度, 6)
赋值 (字段 [2].名称, “文件名”)
赋值 (字段 [2].类型, #文本型)
赋值 (字段 [2].最大文本长度, 150)
赋值 (字段 [3].名称, “用户名”)
赋值 (字段 [3].类型, #文本型)
赋值 (字段 [3].最大文本长度, 30)
赋值 (字段 [4].名称, “ID”)
赋值 (字段 [4].类型, #文本型)
赋值 (字段 [4].最大文本长度, 30)
赋值 (字段 [5].名称, “是否保留”)
赋值 (字段 [5].类型, #逻辑型)
赋值 (字段 [6].名称, “YHID”)
赋值 (字段 [6].类型, #文本型)
赋值 (字段 [6].最大文本长度, 20)
赋值 (字段 [7].名称, “YHMC”)
赋值 (字段 [7].类型, #字节集型)
创建 (相加 (取运行目录 (), “\sql\sysmm.edb”), 字段)

.子程序 _登录窗口_创建完毕, 空白型, , 
未知支持库函数_0 (风格类型)
找ID库 ()


.窗口程序集 前言程序集, , , 

.子程序 _前言_创建完毕, 空白型, , 
赋值 (.时钟周期, 1000)

.子程序 _时钟1_周期事件, 空白型, , 
.局部变量 sec, 整数型, 静态, , 

赋值 (sec, 相加 (sec, 1))
.如果真 (等于 (sec, 3))
    销毁 ()
.如果真结束


.子程序 _前言_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.程序集 _模块_模拟MDI窗口, , , ** 不要更改此处 MDI3.5.ec

.子程序 设MDI父窗口, 整数型, , 返回父窗口的客户区句柄，可根据需要使用
.参数 父窗口, 窗口, , 
.参数 客户区左, 整数型, 可空, 客户区左边,本模块默认为:1
.参数 客户区顶, 整数型, 可空, 客户区顶边,本模块默认为:28
.参数 客户区宽, 整数型, 可空, 客户区宽边,本模块默认为:父窗口的宽度-10
.参数 客户区高, 整数型, 可空, 客户区宽边,本模块默认为:父窗口的高度-93

 ' ** 本子程序功能由系统自动转交对应模块实现，可以删除但不能修改。

.子程序 设MDI子窗口, 空白型, , 
.参数 子窗, 窗口, , 

 ' ** 本子程序功能由系统自动转交对应模块实现，可以删除但不能修改。

.子程序 层叠, 空白型, , 对MDI子窗口进行层叠排列
 ' ** 本子程序功能由系统自动转交对应模块实现，可以删除但不能修改。

.子程序 平铺, 空白型, , 对MDI子窗口进行平铺排列
 ' ** 本子程序功能由系统自动转交对应模块实现，可以删除但不能修改。

.子程序 设置背景, 空白型, , 
.参数 背景图片, 字节集, 可空, 可为空，数据类型为图片字节集数据
.参数 背景颜色, 整数型, 可空, 可为空，数据类型为整数型或颜色常量值

 ' ** 本子程序功能由系统自动转交对应模块实现，可以删除但不能修改。

.子程序 改变客户区, 空白型, , 
.参数 客户区左, 整数型, 可空, 客户区左边,本模块默认为:1
.参数 客户区顶, 整数型, 可空, 客户区顶边,本模块默认为:28
.参数 客户区宽, 整数型, 可空, 客户区宽边,本模块默认为:父窗口的宽度-10
.参数 客户区高, 整数型, 可空, 客户区宽边,本模块默认为:父窗口的高度-93

 ' ** 本子程序功能由系统自动转交对应模块实现，可以删除但不能修改。

.程序集 _模块_阿拉伯数字转换汉文数字(1-99), , , ** 不要更改此处 阿拉伯数字转换汉文数字模块.ec

.子程序 数字转换, 文本型, , 1至99之间的一个整数阿拉伯数字转换成汉文数字
.参数 数字, 整数型, , 

 ' ** 本子程序功能由系统自动转交对应模块实现，可以删除但不能修改。

.程序集 _模块_加密配置文件操作模块, , , ** 不要更改此处 ini40.ec

.子程序 读加密配置项, 文本型, , 读取失败，返回空文本
.参数 配置文件名, 文本型, , 省略路径,默认为保存在windows系统目录下
.参数 文件密码, 文本型, 可空, 
.参数 配置节名, 文本型, , 
.参数 配置项名, 文本型, , 
.参数 默认文本, 文本型, 可空, 

 ' ** 本子程序功能由系统自动转交对应模块实现，可以删除但不能修改。

.子程序 写加密配置项, 逻辑型, , 
.参数 配置文件名, 文本型, , 省略路径,默认为保存在windows系统目录下
.参数 文件密码, 文本型, 可空, 
.参数 配置节名, 文本型, , 
.参数 配置项名, 文本型, , 
.参数 欲写入值, 文本型, , 不允许写入空值。

 ' ** 本子程序功能由系统自动转交对应模块实现，可以删除但不能修改。

.子程序 取加密配置节名, 逻辑型, , 
.参数 配置文件名, 文本型, , 省略路径,默认为保存在windows系统目录下
.参数 文件密码, 文本型, 可空, 
.参数 配置节名称数组, 文本型, 数组, 保存取出的配置文件节名称数组

 ' ** 本子程序功能由系统自动转交对应模块实现，可以删除但不能修改。

.子程序 取加密配置项名, 逻辑型, , 
.参数 配置文件名, 文本型, , 省略路径,默认为保存在windows系统目录下
.参数 文件密码, 文本型, 可空, 
.参数 配置节名, 文本型, , 欲取出项目数组的小节名称
.参数 配置项名称数组, 文本型, 数组, 保存取出的配置项名称数组

 ' ** 本子程序功能由系统自动转交对应模块实现，可以删除但不能修改。

.子程序 删除加密配置小节, 逻辑型, , 
.参数 配置文件名, 文本型, , 
.参数 文件密码, 文本型, 可空, 
.参数 配置节名, 文本型, , 

 ' ** 本子程序功能由系统自动转交对应模块实现，可以删除但不能修改。

.子程序 删除加密配置项目, 逻辑型, , 
.参数 配置文件名, 文本型, , 
.参数 文件密码, 文本型, 可空, 
.参数 配置节名, 文本型, , 
.参数 配置项名, 文本型, , 

 ' ** 本子程序功能由系统自动转交对应模块实现，可以删除但不能修改。

.子程序 置配置文件密码, 逻辑型, , 注意，本子程序同样适用于其它任意格式文件的加解密操作！如果在执行本操作时程序被非法中止，将可能导致数据丢失，请用程序自动生成的bak文件手工恢复至原文件。
.参数 配置文件名, 文本型, , 
.参数 原文件密码, 文本型, 可空, 如果原来无密码，则设为“”或保留为空。
.参数 新文件密码, 文本型, 可空, 如果欲取消密码，则设为“”或保留为空。如果新密码等于原密码，将不做任何操作，直接返回真。

 ' ** 本子程序功能由系统自动转交对应模块实现，可以删除但不能修改。

.窗口程序集 用户管理窗口程序集, , , 

.子程序 _密码修改窗口_创建完毕, 空白型, , 
赋值 (.标题, 相加 (“当前用户：”, 读配置项 (相加 (取当前目录 (), “\myfial.ini”), “setup”, “SJSMC”, )))

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 密码, 文本型, , , 
.局部变量 用户, 文本型, , , 
.局部变量 错误, 文本型, , , 

.如果真 (不等于 (.内容, 文本解密 (读配置项 (相加 (取当前目录 (), “\myfial.ini”), “setup”, “WD”, ), “Ntmdbzdb”)))
    信息框 (“ 抱歉！您输入原旧密码不正确，请重新输入！”, 0, “错误！”)
    获取焦点 ()
    返回 ()
.如果真结束

.如果真 (不等于 (信息框 (“  是否修改该用户登录信息？不作修改请按取消键！”, 相加 (#确认取消钮, #警告图标), “修改警告！”), #确认钮))
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“ 抱歉！请您输入密码！”, 0, “错误！”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (小于或等于 (取文本长度 (.内容), 3))
    信息框 (“ 抱歉！请您输入密码位太少，密码位在4-16之间！”, 0, “错误！”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (不等于 (.内容, .内容))
    信息框 (“ 抱歉！您输入两组密码不相同，请重新输入！”, 0, “错误！”)
    获取焦点 ()
    返回 ()
.如果真结束
未知支持库函数_3 (连接句柄, “use mysql;”)
赋值 (密码, .内容)
赋值 (用户, 读配置项 (相加 (取当前目录 (), “\myfial.ini”), “setup”, “SJSMC”, ))
.如果 (未知支持库函数_3 (连接句柄, 相加 (“UPDATE user SET Password=PASSWORD('”, 密码, “') WHERE user='”, 用户, “';”)))
    信息框 (“密码修改完成！”, 0, )
.否则
    未知支持库函数_41 (连接句柄, 错误)
    信息框 (相加 (“密码修改失败！”, 错误), 0, )
.如果结束
未知支持库函数_3 (连接句柄, “FLUSH PRIVILEGES;”)
未知支持库函数_3 (连接句柄, “use huangpu;”)
销毁 ()

.程序集 _模块_字节集模块, , , ** 不要更改此处 字节集.ec

.子程序 取十进制, 整数型, , 将非十进制的标准格式文本转换成十进制整数值
.参数 欲转换的值, 文本型, , 欲转换的值，文本型！
.参数 数值类型, 整数型, 可空, 0，#十六进制；1，#十进制（默认）；2，#八进制；3，#二进制

 ' ** 本子程序功能由系统自动转交对应模块实现，可以删除但不能修改。

.子程序 还原为字节集, 字节集, , 将一串十六进制文本还原为字节集
.参数 文本, 文本型, , 如“00BFAD00AFD4FD4F9E054F9FF91FC5FF2076FBAFDB071044”

 ' ** 本子程序功能由系统自动转交对应模块实现，可以删除但不能修改。

.子程序 查看字节集, 文本型, , 以文本表示字节集，适合于字节集的调试用
.参数 字节集, 字节集, , 要查看的字节集

 ' ** 本子程序功能由系统自动转交对应模块实现，可以删除但不能修改。

.子程序 字节集到十六进制, 文本型, , 将字节集用16进制表示
.参数 字节集, 字节集, , 用于转换的字节集

 ' ** 本子程序功能由系统自动转交对应模块实现，可以删除但不能修改。

.窗口程序集 修改设置程序集, , , 

.程序集变量 修改设置, 逻辑型, , , 
.子程序 _系统设置窗口_创建完毕, 空白型, , 
.局部变量 表项, 整数型, , , 

未知支持库函数_0 (风格类型)
赋值 (.现行子夹, 0)
连续赋值 (_启动窗口..标题, .标题, .内容)
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\config.ini”), “xsda”, “no”, ))
刷新设置表 ()

.子程序 _系统设置窗口_被取消激活, 空白型, , 
获取焦点 ()

.子程序 _选择年级组合框_列表项被选择, 空白型, , 
获取焦点 ()

.子程序 _班级名列表框_获得焦点, 空白型, , 
重画 ()

.子程序 _添加学校按钮_被单击, 空白型, , 
写配置项 (相加 (取运行目录 (), “\config.ini”), “School”, “Name”, .内容)
置文件属性 (相加 (取运行目录 (), “\config.ini”), 2)
赋值 (.标题, .内容)
赋值 (_启动窗口..标题, 读配置项 (相加 (取运行目录 (), “\config.ini”), “school”, “Name”, ))
赋值 (_启动窗口..内容, 相加 (_启动窗口..标题, #软件名))
赋值 (_启动窗口., 相加 (读配置项 (相加 (取运行目录 (), “\config.ini”), “School”, “Name”, ), #软件名))

.子程序 _添加班级按钮_被单击, 空白型, , 
.局部变量 班级, 文本型, , , 
.局部变量 添加内容, 文本型, , , 
.局部变量 班级名称, 文本型, , , 
.局部变量 班级分类, 文本型, , , 
.局部变量 辅导员, 文本型, , , 
.局部变量 表项, 整数型, , , 


.如果真 (或者 (并且 (等于 (.现行子夹, 0), 等于 (删全部空 (.内容), “”)), 等于 (.现行子夹, 2)))
    信息框 (“请选择或输入通用班级名称！”, 0, “提示”)
    返回 ()
.如果真结束
.如果真 (并且 (等于 (.现行子夹, 1), 等于 (删全部空 (.内容), “”)))
    信息框 (“请输入自设的班级名称！”, 0, “提示”)
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入班主任的姓名”, 0, “提示”)
    返回 ()
.如果真结束

.判断开始 (等于 (.现行子夹, 0))
    赋值 (班级名称, 相加 (.内容, .内容))
    赋值 (辅导员, .内容)
    赋值 (班级分类, “标准班级”)
.判断 (等于 (.现行子夹, 1))
    赋值 (班级名称, .内容)
    赋值 (辅导员, .内容)
    赋值 (班级分类, “自设班级”)
    
.默认
    
.判断结束
.如果真 (等于 (连接句柄, 0))
    信息框 (“没有连接到服务器！”, 0, )
    返回 ()
.如果真结束

.如果真 (取数据库重复记录 (连接句柄, “system”, “bj”, 班级名称))
    信息框 (相加 (班级名称, “已经存在！”), 0, )
    返回 ()
.如果真结束

赋值 (添加内容, 相加 (“bj='”, 班级名称, “', bzr='”, .内容, “',fdy='”, 辅导员, “',bl='”, 班级分类, “',xf='”, .内容, “',xzf='”, .内容, “',hsf='”, .内容, “',glf='”, .内容, “'”))
.如果 (未知支持库函数_18 (连接句柄, “system”, 添加内容))
    刷新设置表 ()
    .如果真 (或者 (等于 (_启动窗口..现行子夹, 1), 等于 (_启动窗口..现行子夹, 3), 等于 (_启动窗口..现行子夹, 4), 等于 (_启动窗口..现行子夹, 8)))
        赋值 (修改设置, 真)
    .如果真结束
    赋值 (记录日志, “添加班级设置信息成功”)
    写日志 ()
.否则
    信息框 (“添加班级数据失败！”, 相加 (0, #错误图标), “提示信息”)
.如果结束


.子程序 刷新设置表, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 行, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 表项数, 整数型, , , 

.如果真 (等于 (连接句柄, 0))
    信息框 (“没有连接到服务器！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (未知支持库函数_3 (连接句柄, “select bj,bzr,fdy,bl,xf,xzf,hsf,glf from system  ORDER BY bj DESC;”), 假)) ' 导出记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (字段数, 未知支持库函数_14 (记录集句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
全部删除 ()
-1.插入表项 ()
.计次循环首 (记录数, 行)
    置等待鼠标 ()
    赋值 (表项数, -1.插入表项 ())
    .计次循环首 (字段数, 列)
        未知支持库函数_15 (记录集句柄, 相减 (列, 1), 字段名)
        赋值 (文本变量, “”)
        未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
        .如果真 (不等于 (文本变量, “”))
            表项数.置标题 (相减 (列, 1), 文本变量)
        .如果真结束
        
    .计次循环尾 ()
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
恢复鼠标 ()

.如果真 (等于 (连接句柄, 0))
    信息框 (“没有连接到服务器！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (未知支持库函数_3 (连接句柄, “select xm,zzlx from jyda where zzlx like '%在职教员%' ORDER BY xm ASC;”), 假)) ' 导出教员姓名记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
清空 ()
清空 ()
.计次循环首 (记录数, )
    置等待鼠标 ()
    未知支持库函数_6 (记录集句柄, “xm”, 文本变量)
    相加 (文本变量, “老师”).加入项目 ()
    相加 (文本变量, “老师”).加入项目 ()
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
恢复鼠标 ()



.子程序 _修改班主任按钮_被单击, 空白型, , 
.局部变量 更新内容, 文本型, , , 
.局部变量 班级名称, 文本型, , , 
.局部变量 班级分类, 文本型, , , 
.局部变量 辅导员, 文本型, , , 

.如果真 (等于 (.取标题 (., 0), “”))
    信息框 (“ 请选择要修改班主任姓名的班级！ ”, 0, )
    返回 ()
.如果真结束
.判断开始 (或者 (等于 (.现行子夹, 0), 等于 (.现行子夹, 2)))
    赋值 (班级名称, .取标题 (., 0))
    赋值 (辅导员, .内容)
    赋值 (班级分类, “标准班级”)
.判断 (等于 (.现行子夹, 1))
    赋值 (班级名称, .取标题 (., 0))
    赋值 (辅导员, .内容)
    赋值 (班级分类, “自设班级”)
.默认
    
.判断结束
赋值 (更新内容, 相加 (“bzr='”, .内容, “',fdy='”, 辅导员, “',bl='”, 班级分类, “',xf='”, .内容, “',xzf='”, .内容, “',hsf='”, .内容, “',glf='”, .内容, “'”))
.如果 (未知支持库函数_19 (连接句柄, “system”, 更新内容, 相加 (“bj='”, 班级名称, “'”)))
    刷新设置表 ()
    赋值 (记录日志, “更新班级设置信息成功”)
    写日志 ()
    
.否则
    信息框 (“更新数据失败！”, 相加 (0, #错误图标), “提示信息”)
.如果结束


.子程序 _删除班级按钮_被单击, 空白型, , 
.局部变量 班级名称, 文本型, , , 

.如果真 (等于 (., -1))
    信息框 (“请在列表中选择要删除的班级”, 0, )
    返回 ()
.如果真结束
赋值 (班级名称, .取标题 (., 0))
.如果真 (等于 (信息框 (相加 (“您确定要删除”, .取标题 (., 0), “的全部资料吗？”), 相加 (#确认取消钮, #警告图标), “询问”), #确认钮))
    .如果 (未知支持库函数_20 (连接句柄, “system”, 相加 (“bj='”, 班级名称, “'”)))
        刷新设置表 ()
        赋值 (记录日志, “删除班级设置信息成功”)
        写日志 ()
    .否则
        信息框 (“删除数据失败！”, 相加 (0, #错误图标), “提示信息”)
    .如果结束
    赋值 (修改设置, 真)
.如果真结束


.子程序 _课程设置按钮_被单击, 空白型, , 
.如果真 (或者 (等于 (_启动窗口..现行子夹, 1), 等于 (_启动窗口..现行子夹, 4), 等于 (_启动窗口..现行子夹, 8)))
    赋值 (修改设置, 真)
.如果真结束
获取焦点 ()
载入 (设置科目窗口, 系统设置窗口, 真)

.子程序 _退出设置按钮_被单击, 空白型, , 
.如果真 (等于 (修改设置, 真))
    回主界面 ()
.如果真结束
系统设置窗口.销毁 ()

.子程序 _系统设置窗口_将被销毁, 空白型, , 
.如果真 (等于 (修改设置, 真))
    回主界面 ()
.如果真结束


.子程序 _班级名列表框_当前表项被改变, 空白型, , 
.局部变量 班, 文本型, , "2", 

连续赋值 (“”, .内容, .内容, .内容, .内容, .内容)
赋值 (班, 分割文本 (.取标题 (., 0), “级”, ))
.如果 (大于或等于 (取数组成员数 (班), 2))
    赋值 (.现行选中项, 相加 (班 [1], “级”).选择 ())
    赋值 (.现行选中项, 班.选择 ( [2]))
    赋值 (.现行子夹, 0)
.否则
    赋值 (.内容, .取标题 (., 0))
    赋值 (.现行子夹, 1)
.如果结束
赋值 (.现行选中项, .取标题 (., 1).选择 ())
赋值 (.现行选中项, .取标题 (., 2).选择 ())
赋值 (.现行选中项, .取标题 (., 2).选择 ())

赋值 (.内容, .取标题 (., 4))
赋值 (.内容, .取标题 (., 5))
赋值 (.内容, .取标题 (., 6))
赋值 (.内容, .取标题 (., 7))

.子程序 _删除班级按钮1_被单击, 空白型, , 
刷新设置表 ()

.子程序 _添加学校按钮1_被单击, 空白型, , 
写配置项 (相加 (取运行目录 (), “\config.ini”), “xsda”, “no”, .内容)
赋值 (学号位数, 到数值 (读配置项 (相加 (取运行目录 (), “\config.ini”), “xsda”, “no”, )))



.子程序 _单选框1_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    连续赋值 (假, .禁止, .禁止, .禁止, .禁止)
.否则
    
.如果结束


.子程序 _单选框2_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    连续赋值 (真, .禁止, .禁止, .禁止, .禁止)
.否则
    
.如果结束


.窗口程序集 学生资料录入程序集, , , 

.程序集变量 姓名参考, 文本型, , , 
.程序集变量 性别参考, 文本型, , , 
.程序集变量 报名打开, 逻辑型, , , 
.程序集变量 已修改, 逻辑型, , , 
.程序集变量 是否免费, 文本型, , , 
.子程序 _资料录入修改学生_位置被改变, 空白型, , 资料录入修改学生位置改变

_启动窗口.移动 (资料录入修改学生., 资料录入修改学生., , )
赋值 (报名打开, 假)
赋值 (是否免费, “0”)
连续赋值 (相减 (资料录入修改学生., 8), .宽度, .宽度)
.移动 (.宽度, 相减 (取用户区高度 (), ., .高度, .高度, 6))
.移动 (相加 (.顶边, .高度), , )
连续赋值 (相除 (_启动窗口., 10), .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度)

连续赋值 (相除 (_启动窗口., 3.35), .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度)
连续赋值 (相加 (.左边, .宽度), .左边, .左边, .左边, .左边, .左边, .左边, .左边)
连续赋值 (相加 (.左边, .宽度), .左边, .左边, .左边, .左边, .左边, .左边)
连续赋值 (相加 (.左边, .宽度), .左边, .左边, .左边, .左边, .左边, .左边, .左边)
相加 (.左边, .宽度).移动 (相除 (_启动窗口., 5.71), )
连续赋值 (相除 (_启动窗口., 12), .宽度, .宽度, .宽度, .宽度, .宽度, .宽度)
赋值 (., 相加 (相除 (相减 (.宽度, .), 2), .左边))
连续赋值 (.宽度, .宽度, .宽度)
连续赋值 (相加 (.左边, .宽度), .左边, .左边)
连续赋值 (相加 (.左边, .宽度), .左边, .左边)
连续赋值 (相加 (.左边, .宽度), .左边, .左边)
连续赋值 (相加 (.左边, .宽度), .左边, .左边)
赋值 (.宽度, 相减 (.左边, .左边, .宽度, .宽度))
赋值 (.宽度, 相减 (.左边, .左边, .宽度, .宽度))
连续赋值 (相加 (.左边, .宽度), .左边, .左边)
连续赋值 (相加 (.左边, .宽度), .左边, .左边)
连续赋值 (.左边, .左边, .左边)
.移动 (相减 (.高度, .顶边, 8))
赋值 (.高度, 相减 (.高度, .顶边, 4))
赋值 (.高度, 相减 (.高度, .顶边, 4))
赋值 (.角度, 相加 (.左边, .宽度, 20))
.移动 (相减 (相加 (.左边, .宽度), .角度), 相减 (.高度, .加粗, 8))
赋值 (.左边, .角度)
赋值 (.左边, 相加 (.左边, .宽度))
赋值 (.宽度, 相减 (.宽度, 4))
赋值 (.宽度, .宽度)
连续赋值 (相减 (相除 (.宽度, 2), 6), .宽度, .宽度)
赋值 (.左边, .左边)
赋值 (.左边, 相加 (.左边, .宽度, 12))
相减 (.宽度, ., ., 100).移动 ()
相减 (.宽度, ., 50).移动 ()

.子程序 _资料录入修改学生_创建完毕, 空白型, , 
未知支持库函数_0 (风格类型)
资料录入修改学生.移动 (_启动窗口., _启动窗口., _启动窗口., _启动窗口.)
.如果真 (等于 (刷新表 (), 假))
    信息框 (“目前没有班级数据！请先进行校务设置！”, 0, )
    销毁 ()
    _教务设置_被选择 ()
    返回 ()
.如果真结束
填充列表学生姓名 ()
当前学期.选择 ()
.如果 (等于 (修改资料, 假))
    赋值 (.背景颜色, #白色)
    3.置文本 (“  提示：请先选择要添加学生资料的班级，输入资料后按[保存数据]。”)
    赋值 (资料录入修改学生., “添加学生资料”)
    赋值 (.标题, 相加 (“您现在要添加的是”, .取项目文本 (.现行选中项), “的学生资料”))
    赋值 (.标题, “  <<  请选择要添加学生资料的班级”)
    赋值 (., “保存数据”)
    赋值 (.字体名称, 真)
    填充空资料 ()
    赋值 (资料录入修改学生., 真)
    
    .如果真 (等于 (学号位数, 0))
        信息框 (“目前没有学号位数数据！请先进行教务设置！”, 0, )
        销毁 ()
        _教务设置_被选择 ()
        返回 ()
    .如果真结束
    赋值 (.最大允许长度, 学号位数)
    .如果 (小于或等于 (到数值 (取票据序号 (连接句柄, “xsda”, “xh”, “”, 学号位数)), 0))
        赋值 (.输入方式, 8)
        赋值 (.内容, 到文本 (1001))
        信息框 (“为保证学号的连续性与唯一性，第一次添加学生资料可以任意输入学号，保存资料后学号栏将会按第一次的学号自动递增，而且不能再编辑或修改！”, #警告图标, “提示”)
        获取焦点 ()
        赋值 (.被选择字符数, 取文本长度 (.内容))
        赋值 (学号位数, 取文本长度 (.内容))
        写配置项 (相加 (取运行目录 (), “\config.ini”), “xsda”, “no”, 到文本 (学号位数))
        
    .否则
        赋值 (.输入方式, 1)
        赋值 (.背景颜色, #银白)
        赋值 (.内容, 到文本 (相加 (到数值 (取票据序号 (连接句柄, “xsda”, “xh”, “”, 学号位数)), 1)))
        获取焦点 ()
        
    .如果结束
    
.否则
    赋值 (.输入方式, 1)
    赋值 (.背景颜色, #银白)
    3.置文本 (“  提示：请先选择要修改资料的学生姓名，修改完成后按[保存修改]。”)
    赋值 (资料录入修改学生., “修改学生资料”)
    赋值 (., “保存修改”)
    赋值 (.字体名称, 假)
    .判断开始 (并且 (等于 (_启动窗口..现行子夹, 1), 等于 (学生分类, “在校学生”)))
        赋值 (.现行选中项, _启动窗口..现行选中项)
        
        填充列表学生姓名 ()
        
        _启动窗口.查找表项 (..标题, , ).选择表项 ()
    .判断 (等于 (_启动窗口..现行子夹, 3))
        赋值 (.现行选中项, _启动窗口..现行选中项)
        
        填充列表学生姓名 ()
        
        _启动窗口.取标题 (., _启动窗口.., 2).查找表项 ().选择表项 ()
    .默认
        赋值 (.现行选中项, 0)
        
        填充列表学生姓名 ()
        
        0.选择表项 ()
    .判断结束
    .保证显示 (.)
    
    填充修改资料 ()
    
    赋值 (.标题, “请选择要修改学生资料的班级和学生姓名”)
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果结束


赋值 (.标题, .取项目文本 (.现行选中项))
赋值 (已修改, 假)
.如果 (等于 (., “保存修改”))
    赋值 (., 假)
.否则
    赋值 (., 真)
.如果结束




.子程序 填充列表学生姓名, 空白型, , 填充列表学生姓名
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 行, 整数型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 列, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本量, 文本型, , "0", 
.局部变量 错误, 文本型, , , 
.局部变量 D, 整数型, , , 
.局部变量 表项, 整数型, , , 
.局部变量 当前班级, 文本型, , , 
.局部变量 姓名变量, 文本型, , , 

置等待鼠标 ()
赋值 (男, 0)
赋值 (女, 0)
.如果真 (等于 (连接句柄, 0))
    返回 ()
.如果真结束
赋值 (当前班级, .取项目文本 (.现行选中项))
.如果真 (等于 (连接句柄, 0))
    返回 ()
.如果真结束
置等待鼠标 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select szbj,xb,xm from xsda where szbj like '%”, 当前班级, “%'ORDER BY xm ASC;”)), 假)) ' 导出记录
    未知支持库函数_41 (连接句柄, 错误)
    信息框 (相加 (“建立记录失败！”, 错误), 0, )
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
全部删除 ()
.计次循环首 (记录数, 行)
    置等待鼠标 ()
    赋值 (文本变量, “”)
    赋值 (姓名变量, “”)
    未知支持库函数_6 (记录集句柄, “xb”, 文本变量)
    .如果 (等于 (文本变量, “男”))
        赋值 (男, 相加 (男, 1))
    .否则
        赋值 (女, 相加 (女, 1))
    .如果结束
    未知支持库函数_6 (记录集句柄, “xm”, 姓名变量)
    .如果 (等于 (文本变量, “男”))
        .插入表项 (姓名变量, 1, , , )
    .否则
        .插入表项 (姓名变量, 0, , , )
    .如果结束
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
2.置文本 (“当前状态：录入修改学生资料”)
赋值 (.标题, 相加 (“目前”, .内容, “共有”, 到文本 (记录数), “名学生  其中男生”, 到文本 (男), “人  女生”, 到文本 (女), “人”))
恢复鼠标 ()

.子程序 刷新表, 逻辑型, , 刷新学生班级组合框
.局部变量 记录集句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 行, 整数型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 字段名, 文本型, , , 

.如果真 (等于 (连接句柄, 0))
    信息框 (“ 没有连接到服务器！”, 0, )
    返回 (假)
.如果真结束
.如果真 (等于 (未知支持库函数_3 (连接句柄, “select bj from system  ORDER BY bj ASC;”), 假)) ' 导出记录
    返回 (假)
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
清空 ()
.计次循环首 (记录数, 行)
    置等待鼠标 ()
    未知支持库函数_6 (记录集句柄, “bj”, 文本变量)
    .如果真 (不等于 (文本变量, “”))
        文本变量.加入项目 ()
    .如果真结束
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
恢复鼠标 ()
返回 (真)


.子程序 填充学费标准, 空白型, , 填充学费标准
.局部变量 当前班级, 文本型, , , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 错误, 文本型, , , 

赋值 (当前班级, .取项目文本 (.现行选中项))
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select bj,xf,xzf,hsf,glf from system where bj like '%”, 当前班级, “%'ORDER BY bj ASC;”)), 假)) ' 导出学费记录
    未知支持库函数_41 (连接句柄, 错误)
    信息框 (相加 (“错误！”, 错误), 0, )
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “xf”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “xzf”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “hsf”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “glf”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_5 (记录集句柄)


.子程序 _学生班级组合框_列表项被选择, 空白型, , 学生班级组合框
获取焦点 ()
填充列表学生姓名 ()
.如果 (等于 (修改资料, 真))
    赋值 (., 0)
    填充学费标准 ()
    填充修改资料 ()
.否则
    填充学费标准 ()
    赋值 (.标题, 相加 (“您现在要添加的是”, .取项目文本 (.现行选中项), “的学生资料”))
    获取焦点 ()
.如果结束
赋值 (.标题, .取项目文本 (.现行选中项))


.子程序 _学生姓名列表框_当前表项被改变, 空白型, , 填充修改资料
.如果真 (等于 (修改资料, 真))
    填充修改资料 ()
    赋值 (.标题, 相加 (“您现在修改的是”, .取项目文本 (.现行选中项), .取标题 (., ), “同学的资料”))
.如果真结束


.子程序 填充修改资料, 空白型, , 填充修改资料
.局部变量 当前姓名, 文本型, , , 
.局部变量 当前班级, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 节集变量, 字节集, , , 

.如果真 (等于 (取表项数 (), 0))
    赋值 (.标题, 相加 (“目前”, .内容, “没有学生资料！请选择其他班级修改资料！”))
    填充空资料 ()
    信息框 (相加 (“目前”, .内容, “没有学生资料！请选择其他班级修改资料！”), 0, )
    返回 ()
.如果真结束
赋值 (当前班级, .取项目文本 (.现行选中项))
赋值 (当前姓名, .取标题 (., 0))
.如果真 (等于 (连接句柄, 0))
    返回 ()
.如果真结束
置等待鼠标 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select * from xsda where xm like '%”, 当前姓名, “%' and szbj like '%”, 当前班级, “%'ORDER BY xm ASC;”)), 假)) ' 导出记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
填充空资料 ()
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “xh”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “xm”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “kh”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “xb”, 文本变量)
文本变量.选择 ()
未知支持库函数_6 (记录集句柄, “mz”, 文本变量)
文本变量.选择 ()
未知支持库函数_6 (记录集句柄, “cssj”, 文本变量)
赋值 (.今天, 到时间 (文本变量))
未知支持库函数_6 (记录集句柄, “rxsj”, 文本变量)
赋值 (.今天, 到时间 (文本变量))
未知支持库函数_6 (记录集句柄, “szbj”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录集句柄, “bnfw”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “jtdz”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “zzdh”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “jg”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “hzszd”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “jhra”, 文本变量)
文本变量.选择 ()
未知支持库函数_6 (记录集句柄, “jhrxma”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “gzdwa”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “tela”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “jhrb”, 文本变量)
文本变量.选择 ()
未知支持库函数_6 (记录集句柄, “jhrxmb”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “gzdwb”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “telb”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “tp”, 节集变量)
赋值 (.图片, 节集变量)
未知支持库函数_6 (记录集句柄, “bqpy”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “zhpy”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “ssh”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “cwh”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “sfmf”, 文本变量)
.如果 (等于 (文本变量, “1”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束

未知支持库函数_6 (记录集句柄, “xf”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “xzf”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “hsf”, 文本变量)
赋值 (.内容, 文本变量)

未知支持库函数_5 (记录集句柄)
赋值 (姓名参考, .内容)
赋值 (性别参考, .内容)

赋值 (.标题, 相加 (“您现在修改的是”, .取项目文本 (.现行选中项), .取标题 (., ), “同学的资料”))
未知支持库函数_5 (记录集句柄)


.子程序 填充空资料, 空白型, , 填充空资料
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
赋值 (.选中, 假)
赋值 (.图片, #图片1)

.子程序 _保存数据钮_被单击, 空白型, , 保存数据钮
.局部变量 资料, 文本型, , , 
.局部变量 图片资料, 字节集, , , 
.局部变量 匿名局部变量_2113, 空白型, , , 
.局部变量 错误, 文本型, , , 
.局部变量 条件, 文本型, , , 
.局部变量 资料2, 文本型, , , 

.判断开始 (等于 (., “保存数据”))
    .如果真 (等于 (删全部空 (.内容), “”))
        信息框 (“    请输入学生的学号！    ”, 0, “提示”)
        获取焦点 ()
        返回 ()
    .如果真结束
    .如果真 (等于 (删全部空 (.内容), “”))
        信息框 (“    请输入学生的姓名！    ”, 0, “提示”)
        获取焦点 ()
        返回 ()
    .如果真结束
    .如果真 (等于 (删全部空 (.内容), “”))
        信息框 (“  请选择学生班级！    ”, 0, “提示”)
        获取焦点 ()
        返回 ()
    .如果真结束
    .如果真 (取数据库重复记录 (连接句柄, “xsda”, “xh”, .内容))
        信息框 (“被增加的学号重复！增加失败！”, #信息图标, “注意学号重复！”)
        返回 ()
    .如果真结束
    .如果真 (不等于 (学号位数, 取文本长度 (.内容)))
        信息框 (“目前的学号位数不正确！请先进行教务设置！”, 0, )
        _教务设置_被选择 ()
        返回 ()
    .如果真结束
    
    赋值 (资料, 相加 (“xh='”, .内容, “',xm='”, .内容, “',kh='”, .内容, “',xb='”, .内容, “',mz='”, .内容, “',cssj='”, 时间到文本 (.今天, 2), “',rxsj='”, 时间到文本 (.今天, 2), “',szbj='”, .标题, “',bnfw='”, .内容, “',jtdz='”, .内容, “',zzdh='”, .内容, “',hzszd='”, .内容, “',jg='”, .内容, “',jhra='”, .内容, “',jhrxma='”, .内容, “',gzdwa='”, .内容, “',tela='”, .内容, “',jhrb='”, .内容, “',jhrxmb='”, .内容, “',gzdwb='”, .内容, “',telb='”, .内容, “',bqpy='”, .内容, “',zhpy='”, .内容, “',zxxz='在校学生',ssh='”, .内容, “',cwh='”, .内容, “',sfmf='”, 是否免费, “',xf='”, .内容, “',xzf='”, .内容, “',hsf='”, .内容, “'”))
    
    赋值 (图片资料, .图片)
    .如果真 (等于 (未知支持库函数_18 (连接句柄, “xsda”, 资料), 假))
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (相加 (“建立记录失败！”, 错误), 0, )
        返回 ()
    .如果真结束
    .如果 (未知支持库函数_46 (连接句柄, “xsda”, “tp”, 相加 (“xh='”, .内容, “'”), 图片资料))
        信息框 (“建立记录完成！”, 0, “完成记录！”)
        赋值 (记录日志, 相加 (“增加学生”, .内容, “成功”))
        写日志 ()
        赋值 (.内容, 到文本 (相加 (到数值 (.内容), 1)))
        .如果真 (不等于 (.输入方式, 1))
            赋值 (.输入方式, 1)
            赋值 (.背景颜色, #银白)
        .如果真结束
        
        填充空资料 ()
        填充列表学生姓名 ()
        .查找表项 (.内容, , ).选择表项 ()
        .保证显示 (.)
        获取焦点 ()
        赋值 (已修改, 真)
        
    .否则
        信息框 (“保存数据失败！”, 0, )
        
    .如果结束
    
.判断 (等于 (., “保存修改”))
    .如果真 (等于 (信息框 (相加 (“您确定要更新”, .内容, “同学的记录信息吗？”), #确认取消钮, “询问”), #取消钮))
        返回 ()
    .如果真结束
    .如果真 (小于 (取表项数 (), 1))
        信息框 (相加 (“目前”, .内容, “没有学生资料！请选择其他班级修改资料！”), 0, )
        填充空资料 ()
        返回 ()
    .如果真结束
    .如果真 (等于 (删全部空 (.内容), “”))
        信息框 (“  请输入学生的姓名！    ”, 0, “提示”)
        获取焦点 ()
        返回 ()
    .如果真结束
    .如果真 (等于 (删全部空 (.内容), “”))
        信息框 (“  请选择学生班级！    ”, 0, “提示”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (资料, 相加 (“xm='”, .内容, “',kh='”, .内容, “',xb='”, .内容, “',mz='”, .内容, “',cssj='”, 时间到文本 (.今天, 2), “',rxsj='”, 时间到文本 (.今天, 2), “',szbj='”, .标题, “',bnfw='”, .内容, “',jtdz='”, .内容, “',zzdh='”, .内容, “',hzszd='”, .内容, “',jg='”, .内容, “',jhra='”, .内容, “',jhrxma='”, .内容, “',gzdwa='”, .内容, “',tela='”, .内容, “',jhrb='”, .内容, “',jhrxmb='”, .内容, “',gzdwb='”, .内容, “',telb='”, .内容, “',bqpy='”, .内容, “',zhpy='”, .内容, “',zxxz='在校学生',ssh='”, .内容, “',cwh='”, .内容, “',sfmf='”, 是否免费, “',xf='”, .内容, “',xzf='”, .内容, “',hsf='”, .内容, “'”))
    赋值 (条件, 相加 (“xh='”, .内容, “'”))
    .如果真 (等于 (未知支持库函数_19 (连接句柄, “xsda”, 资料, 条件), 假))
        信息框 (“更新数据失败！”, 0, )
        返回 ()
    .如果真结束
    赋值 (图片资料, .图片)
    
    .如果 (未知支持库函数_46 (连接句柄, “xsda”, “tp”, 条件, 图片资料))
        赋值 (记录日志, 相加 (“修改学生”, .内容, “成功”))
        写日志 ()
        填充空资料 ()
        填充列表学生姓名 ()
        .查找表项 (.内容, , ).选择表项 ()
        .保证显示 (.)
        赋值 (已修改, 真)
        信息框 (“修改记录完成！”, 0, “完成修改记录！”)
    .否则
        信息框 (“更新数据失败！”, 0, )
        返回 ()
        
        
    .如果结束
    
    
.默认
    
.判断结束


.子程序 _选择照片钮_鼠标左键被放开, 逻辑型, , 选择照片
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 图片, 字节集, , , 

.如果真 (打开 ())
    赋值 (图片, 读入文件 (.文件名))
    .如果真 (大于 (取字节集长度 (图片), 相乘 (65, 1000)))
        信息框 (“图片尺寸太大，请保持尺寸在65KB以内！”, #警告图标, “错误提示！”)
        返回 ()
    .如果真结束
    赋值 (.图片, 图片)
.如果真结束


.子程序 _删除照片钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (不等于 (.图片, #图片1))
    .如果真 (等于 (信息框 (相加 (“您确定要删除”, .内容, “同学的照片吗？”), 相加 (#确认取消钮, #询问图标), “询问”), #确认钮))
        赋值 (.图片, #图片1)
    .如果真结束
    
.如果真结束


.子程序 _资料录入修改学生_将被销毁, 空白型, , 
.如果真 (已修改)
    .判断开始 (并且 (等于 (_启动窗口..现行子夹, 1), 等于 (.内容, _启动窗口..内容), 等于 (已修改, 真)))
        回主界面 ()
    .判断 (并且 (等于 (_启动窗口..现行子夹, 3), 等于 (.内容, _启动窗口..内容), 等于 (已修改, 真)))
        回主界面 ()
    .默认
        
    .判断结束
    
.如果真结束


.子程序 _退出钮_被单击, 空白型, , 
.如果 (已修改)
    .判断开始 (并且 (等于 (_启动窗口..现行子夹, 1), 等于 (.内容, _启动窗口..内容), 等于 (已修改, 真)))
        回主界面 ()
        销毁 ()
    .判断 (并且 (等于 (_启动窗口..现行子夹, 3), 等于 (.内容, _启动窗口..内容), 等于 (已修改, 真)))
        回主界面 ()
        销毁 ()
    .默认
        
    .判断结束
    
.否则
    销毁 ()
.如果结束


.子程序 _本学期评语编辑框_内容被改变, 空白型, , 
.如果 (大于 (186.发送信息 (0, 0), 14))
    赋值 (.输入方式, 1)
    .判断循环首 (大于 (186.发送信息 (0, 0), 14))
        赋值 (.内容, 取文本左边 (.内容, 相减 (取文本长度 (.内容), 2)))
    .判断循环尾 ()
    信息框 (“本学期评价最多输入14行内容！”, 0, )
    赋值 (.起始选择位置, 取文本长度 (.内容))
    赋值 (.输入方式, 0)
.否则
    赋值 (.输入方式, 0)
.如果结束


.子程序 _本学期评语钮_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.标题, “综合评价”)
赋值 (.标题, “● 本学期评语”)
赋值 (.标题, “ 本学期评语：”)
赋值 (.可视, 真)
赋值 (.可视, 真)
#顶层.调整层次 ()
赋值 (.可视, 假)
#底层.调整层次 ()
获取焦点 ()

.子程序 _综合评价钮_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.标题, “● 综合评价”)
赋值 (.标题, “本学期评语”)
赋值 (.标题, “ 综合评价：”)
赋值 (.可视, 假)
赋值 (.可视, 真)
#顶层.调整层次 ()
赋值 (.可视, 假)
#底层.调整层次 ()
获取焦点 ()
赋值 (.起始选择位置, 取文本长度 (.内容))


.子程序 _清除评语钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (等于 (.标题, “ 本学期评语：”))
    .如果真 (不等于 (.内容, “”))
        .如果真 (等于 (信息框 (“您确定要清除本学期评价的内容吗？”, #确认取消钮, “询问”), #确认钮))
            赋值 (.内容, “”)
        .如果真结束
        
    .如果真结束
    
.判断 (等于 (.标题, “ 综合评价：”))
    .如果真 (不等于 (.内容, “”))
        .如果真 (等于 (信息框 (“您确定要清除综合评价的内容吗？”, #确认取消钮, “询问”), #确认钮))
            赋值 (.内容, “”)
        .如果真结束
        
    .如果真结束
    
.默认
    
.判断结束


.子程序 _资料录入修改学生_被取消激活, 空白型, , 
获取焦点 ()

.子程序 _学号编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #减号键))
    返回 (假)
.如果真结束
.如果 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.否则
    
.如果结束



.子程序 _姓名编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _性别组合框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _民族组合框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _出生日期框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _入学日期框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _班内职务组合框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _住址编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _住宅电话编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _籍贯编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _户籍编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _家长组合框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _父亲编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _父亲单位编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _父电话编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _家长组合框2_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _母亲编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _母亲单位编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _母电话编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    .判断开始 (等于 (.标题, “ 本学期评语：”))
        获取焦点 ()
    .判断 (等于 (.标题, “ 综合评价：”))
        获取焦点 ()
    .默认
        
    .判断结束
    
.如果真结束


.子程序 _本学期评语编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #Tab键))
    获取焦点 ()
.如果真结束


.子程序 _综合评价编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #Tab键))
    获取焦点 ()
.如果真结束


.子程序 _学生班级组合框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    .如果 (等于 (.字体名称, 假))
        获取焦点 ()
    .否则
        获取焦点 ()
        赋值 (.被选择字符数, 取文本长度 (.内容))
    .如果结束
    
.如果真结束


.子程序 _学生姓名列表框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _保存数据钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (或者 (等于 (键代码, #Tab键), 等于 (键代码, #回车键)))
    获取焦点 ()
.判断 (等于 (键代码, #空格键))
    _保存数据钮_被单击 ()
.默认
    
.判断结束


.子程序 _退出钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (或者 (等于 (键代码, #Tab键), 等于 (键代码, #回车键)))
    获取焦点 ()
.判断 (等于 (键代码, #空格键))
    _退出钮_被单击 ()
.默认
    
.判断结束


.子程序 _学号编辑框_内容被改变, 空白型, , 
.局部变量 学号首位, 文本型, , , 

赋值 (学号首位, 取文本左边 (.内容, 1))
.如果真 (并且 (等于 (学号首位, “0”), 大于 (取文本长度 (.内容), 1)))
    信息框 (“学号的第一位数字不能为 0 ！  ”, 0, )
.如果真结束


.子程序 _资料录入修改学生_可否被关闭, 逻辑型, , 
_退出钮_被单击 ()

.子程序 _超级按钮_被单击, 空白型, , 
载入 (评语录入窗口, 资料录入修改学生, 真)



.子程序 _报名数据钮_被单击, 空白型, , 
.如果 (等于 (报名打开, 假))
    赋值 (报名打开, 真)
    赋值 (.可视, 真)
.否则
    赋值 (报名打开, 假)
    赋值 (.可视, 假)
.如果结束


.子程序 _是否免费选择框_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (是否免费, “1”)
.否则
    赋值 (是否免费, “0”)
.如果结束



.子程序 _所在班级_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.禁止, 假)

.程序集 通用程序集, , , 

.子程序 填充班级名称, 逻辑型, , 填充班级名称
.参数 通用班名组合框, 组合框, , 

.局部变量 记录集句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 行, 整数型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 字段名, 文本型, , , 

.如果真 (等于 (连接句柄, 0))
    信息框 (“ 没有连接到服务器！”, 0, )
    返回 (假)
.如果真结束
.如果真 (等于 (未知支持库函数_3 (连接句柄, “select bj,bzr from system  ORDER BY bj ASC;”), 假)) ' 导出记录
    返回 (假)
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
通用班名组合框.清空 ()
.计次循环首 (记录数, 行)
    置等待鼠标 ()
    未知支持库函数_6 (记录集句柄, “bj”, 文本变量)
    .如果真 (不等于 (文本变量, “”))
        通用班名组合框.加入项目 (文本变量, )
    .如果真结束
    未知支持库函数_6 (记录集句柄, “bzr”, 文本变量)
    .如果真 (不等于 (文本变量, “”))
        _启动窗口.加入项目 (., 文本变量, )
    .如果真结束
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
恢复鼠标 ()
返回 (真)

.子程序 超级列表框排序, 整数型, , 返回排序时间
.参数 对象, 超级列表框, , 
.参数 列索引, 整数型, , 
.参数 类型, 整数型, 可空, 0数值型;1文本型;2日期时间型;3逻辑型;其它默认文本型
.参数 区分大小写, 逻辑型, 可空, 真 区分大小写;假 不区分大小写
.参数 排序方式, 逻辑型, 可空, 真 正序(从小到大);假 倒序(从大到小)

.局部变量 排序时间, 整数型, , , 
.局部变量 排序变量, 文本型, , "0", 
.局部变量 序号数组, 整数型, , "0", 
.局部变量 变量, 整数型, , , 
.局部变量 数据, 文本型, , , 
.局部变量 列数, 整数型, , , 
.局部变量 行数, 整数型, , , 
.局部变量 单元数, 整数型, , , 

赋值 (排序时间, 取启动时间 ())
赋值 (类型, 选择 (并且 (大于或等于 (类型, 0), 小于或等于 (类型, 3)), 类型, 1))
赋值 (区分大小写, 选择 (是否为空 (区分大小写), 真, 区分大小写))
赋值 (排序方式, 选择 (是否为空 (排序方式), 真, 排序方式))
.计次循环首 (对象.取表项数 (), 变量)
    赋值 (数据, 对象.取标题 (相减 (变量, 1), 列索引))
    .如果 (不等于 (类型, 3))
        赋值 (单元数, 二分查找 (排序变量, 数据, 类型, 区分大小写))
        插入成员 (排序变量, 单元数, 数据)
        插入成员 (序号数组, 单元数, 相减 (变量, 1))
    .否则
        插入成员 (序号数组, 选择 (等于 (数据, “假”), 变量, 1), 相减 (变量, 1))
    .如果结束
    
.计次循环尾 ()
赋值 (列数, 对象.取列数 ())
赋值 (行数, 取数组成员数 (序号数组))
赋值 (单元数, 相乘 (行数, 列数))
重定义数组 (排序变量, 假, 单元数)
.计次循环首 (单元数, 变量)
    赋值 (排序变量 [变量], 对象.取标题 (序号数组 [取绝对值 (相减 (选择 (排序方式, -1, 行数), 整除 (相减 (变量, 1), 列数)))], 求余数 (相减 (变量, 1), 列数)))
.计次循环尾 ()
.计次循环首 (单元数, 变量)
    对象.置标题 (整除 (相减 (变量, 1), 列数), 求余数 (相减 (变量, 1), 列数), 排序变量 [变量])
.计次循环尾 ()
返回 (相减 (取启动时间 (), 排序时间))

.子程序 二分查找, 整数型, , 
.参数 数组, 文本型, 数组, 
.参数 待查, 文本型, , 
.参数 类型, 整数型, , 
.参数 区分大小写, 逻辑型, , 

.局部变量 位置, 整数型, , , 
.局部变量 数组总数, 整数型, , , 
.局部变量 对分, 整数型, , , 
.局部变量 数值A, 双精度小数型, , , 
.局部变量 数值B, 双精度小数型, , , 
.局部变量 文本, 文本型, , , 

赋值 (位置, 1)
赋值 (数组总数, 取数组成员数 (数组))
.如果真 (等于 (数组总数, 0))
    返回 (1)
.如果真结束
.判断开始 (等于 (类型, 0))
    赋值 (数值A, 到数值 (待查))
    .如果真 (大于或等于 (数值A, 到数值 (数组 [数组总数])))
        返回 (相加 (数组总数, 1))
    .如果真结束
    .如果真 (小于或等于 (数值A, 到数值 (数组 [1])))
        返回 (1)
    .如果真结束
    
    .判断循环首 (小于 (位置, 相减 (数组总数, 1)))
        赋值 (对分, 整除 (相加 (位置, 数组总数), 2))
        赋值 (数值B, 到数值 (数组 [对分]))
        .如果真 (等于 (数值A, 数值B))
            赋值 (位置, 对分)
            跳出循环 ()
        .如果真结束
        
        .如果 (小于 (数值A, 数值B))
            赋值 (数组总数, 对分)
        .否则
            赋值 (位置, 对分)
        .如果结束
        
    .判断循环尾 ()
.判断 (等于 (类型, 1))
    .如果真 (大于或等于 (文本比较 (待查, 数组 [数组总数], 区分大小写), 0))
        返回 (相加 (数组总数, 1))
    .如果真结束
    .如果真 (小于或等于 (文本比较 (待查, 数组 [1], 区分大小写), 0))
        返回 (1)
    .如果真结束
    .判断循环首 (小于 (位置, 相减 (数组总数, 1)))
        赋值 (对分, 整除 (相加 (位置, 数组总数), 2))
        .如果真 (等于 (文本比较 (待查, 数组 [对分], 区分大小写), 0))
            赋值 (位置, 对分)
            跳出循环 ()
        .如果真结束
        .如果 (小于 (文本比较 (待查, 数组 [对分], 区分大小写), 0))
            赋值 (数组总数, 对分)
        .否则
            赋值 (位置, 对分)
        .如果结束
        
    .判断循环尾 ()
    
.判断 (等于 (类型, 2))
    赋值 (数值A, 取字节集数据 (到字节集 (到时间 (待查)), #双精度小数型))
    .如果真 (大于或等于 (数值A, 取字节集数据 (到字节集 (到时间 (数组 [数组总数])), #双精度小数型)))
        返回 (相加 (数组总数, 1))
    .如果真结束
    .如果真 (小于或等于 (数值A, 取字节集数据 (到字节集 (到时间 (数组 [1])), #双精度小数型)))
        返回 (1)
    .如果真结束
    .判断循环首 (小于 (位置, 相减 (数组总数, 1)))
        赋值 (对分, 整除 (相加 (位置, 数组总数), 2))
        赋值 (数值B, 取字节集数据 (到字节集 (到时间 (数组 [对分])), #双精度小数型))
        .如果真 (等于 (数值A, 数值B))
            赋值 (位置, 对分)
            跳出循环 ()
        .如果真结束
        .如果 (小于 (数值A, 数值B))
            赋值 (数组总数, 对分)
        .否则
            赋值 (位置, 对分)
        .如果结束
        
    .判断循环尾 ()
.默认
    
.判断结束
返回 (相加 (位置, 1))

.子程序 检查连接, 空白型, , 检查是否连接，失败提示！
.如果真 (等于 (连接句柄, 0))
    .如果真 (等于 (信息框 (“    登录错误或连接断开！重新连接按确定！”, 相加 (#确认取消钮, #信息图标), “登录错误！”), #确认钮))
        赋值 (_启动窗口..时钟周期, 0)
        _启动窗口.置文本 (., 0, “数据库连接失败”)
        载入 (登录窗口, , 真)
    .如果真结束
    
.如果真结束


.子程序 提示错误, 空白型, , 提示连接错误
.局部变量 错误, 文本型, , , 

未知支持库函数_41 (连接句柄, 错误)
信息框 (相加 (“连接错误：原因：”, 错误), #错误图标, “错误提示！”)


.子程序 文本加密, 文本型, , 参数1(加密文本),参数2(密码)
.参数 加密文本, 文本型, , 
.参数 密码, 文本型, 可空, 

.局部变量 a, 文本型, , , 
.局部变量 b, 文本型, , "0", 
.局部变量 c, 空白型, , , 
.局部变量 b1, 文本型, , "0", 
.局部变量 b2, 文本型, , "0", 
.局部变量 t, 文本型, , , 
.局部变量 t1, 文本型, , "0", 
.局部变量 t2, 空白型, , , 

数组清零 (t1)
赋值 (t, “我操你妈个比，看什么看？不服气干掉你~~~1234567890我操你妈qwertyuiopasdfghjklzxcvbnm个比，看1234567890什么看？不服气干掉你~~~1234567890我操你妈qwertyuiopasdfghjklzxcvbnm个比，看1234567890什么看？不服气干掉你~~~1234567890我操你妈个比，看1234567890什么看？不服气干掉你~~~1234567890我操你妈个比，看1234567890什么看？不服气干掉你~~~1234567890我操你妈个比，看1234567890什么看？不服qwertyuiopasdfghjklzxcvbnm气干掉你~~~1234567890我操你妈个比，看1234567890什么看？不服气干掉你~~~1234567890我操你妈个比，看1234567890什么看？不服qwertyuiopasdfghjklzxcvbnm气干掉你~~~1234567890我操你妈个比，看1234567890什么看？不服气干掉你~~~1234567890我操你妈个比，看1234567890什么看？不服气干掉你~~~1234567890我操你妈个比，看1234567890什么看？不服qwertyuiopasdfghjklzxcvbnm气干掉你~~~1234567890我操你妈个比，看1234567890什么看？不服气干掉你~~~1234567890我操你妈个比，看1234567890什么看？不服气qwertyuiopasdfghjklzxcvbnm干掉你~~~1234567890”)
.计次循环首 (取文本长度 (t), t2)
    加入成员 (t1, 取文本中间 (t, t2, 1))
.计次循环尾 ()

赋值 (a, “”)
赋值 (c, 1)
数组清零 (b)
数组清零 (b1)

.如果 (不等于 (密码, “”))
    .如果 (不等于 (求余数 (取绝对值 (取文本长度 (密码)), 2), 1))
        赋值 (a, 相加 (加密文本, “*”, 密码, “ ”))
    .否则
        赋值 (a, 相加 (加密文本, “*”, 密码))
    .如果结束
    
.否则
    赋值 (a, 加密文本)
    
    
.如果结束


.计次循环首 (取文本长度 (a), c)
    加入成员 (b, 取文本中间 (a, c, 1))
.计次循环尾 ()
.如果 (小于或等于 (取数组成员数 (b), 3))
    赋值 (c, 取数组成员数 (b))
    .计次循环首 (取数组成员数 (b), )
        加入成员 (b1, b [c])
        赋值 (c, 相减 (c, 1))
    .计次循环尾 ()
    赋值 (c, 1)
    赋值 (a, “”)
    .计次循环首 (取数组成员数 (b1), c)
        赋值 (a, 相加 (a, b1 [c]))
    .计次循环尾 ()
    返回 (a)
.否则
    
.如果结束

.如果 (等于 (求余数 (取绝对值 (取数组成员数 (b)), 2), 1))
    赋值 (c, 1)
    .计次循环首 (相除 (相减 (取数组成员数 (b), 1), 2), )
        加入成员 (b1, b [c])
        置随机数种子 ()
        加入成员 (b1, t1 [取随机数 (1, 取数组成员数 (t1))])
        赋值 (c, 相加 (c, 2))
    .计次循环尾 ()
    赋值 (c, 2)
    .计次循环首 (相除 (相减 (取数组成员数 (b), 1), 2), )
        加入成员 (b1, b [c])
        置随机数种子 ()
        加入成员 (b1, t1 [取随机数 (1, 取数组成员数 (t1))])
        赋值 (c, 相加 (c, 2))
    .计次循环尾 ()
    加入成员 (b1, b [取数组成员数 (b)])
.否则
    赋值 (c, 1)
    .计次循环首 (相除 (取数组成员数 (b), 2), )
        加入成员 (b1, b [c])
        置随机数种子 ()
        加入成员 (b1, t1 [取随机数 (1, 取数组成员数 (t1))])
        赋值 (c, 相加 (c, 2))
    .计次循环尾 ()
    赋值 (c, 2)
    .计次循环首 (相除 (取数组成员数 (b), 2), )
        加入成员 (b1, b [c])
        置随机数种子 ()
        加入成员 (b1, t1 [取随机数 (1, 取数组成员数 (t1))])
        赋值 (c, 相加 (c, 2))
    .计次循环尾 ()
.如果结束
赋值 (a, “”)
赋值 (c, 1)
.计次循环首 (取数组成员数 (b1), c)
    赋值 (a, 相加 (a, b1 [c]))
.计次循环尾 ()


返回 (a)

.子程序 文本解密, 文本型, , 参数1(解密文本),参数2(密码)
.参数 解密文本, 文本型, , 
.参数 密码, 文本型, 可空, 

.局部变量 a, 文本型, , , 
.局部变量 b, 文本型, , "0", 
.局部变量 c, 空白型, , , 
.局部变量 b1, 文本型, , "0", 
.局部变量 b2, 文本型, , "0", 
.局部变量 b3, 文本型, , "0", 
.局部变量 实际密码, 文本型, , , 
.局部变量 a1, 文本型, , , 

赋值 (a, “”)
赋值 (c, 1)
数组清零 (b)
数组清零 (b1)

赋值 (a, 解密文本)
.计次循环首 (取文本长度 (a), c)
    加入成员 (b1, 取文本中间 (a, c, 1))
.计次循环尾 ()

.如果 (小于或等于 (取数组成员数 (b1), 3))
    赋值 (c, 取数组成员数 (b1))
    .计次循环首 (取数组成员数 (b1), )
        加入成员 (b2, b1 [c])
        赋值 (c, 相减 (c, 1))
    .计次循环尾 ()
    赋值 (c, 1)
    赋值 (a, “”)
    .计次循环首 (取数组成员数 (b2), c)
        赋值 (a, 相加 (a, b2 [c]))
    .计次循环尾 ()
    返回 (a)
.否则
    
.如果结束

.如果 (不等于 (求余数 (取绝对值 (取数组成员数 (b1)), 2), 1))
    赋值 (c, 1)
    .计次循环首 (取数组成员数 (b1), )
        .如果真 (小于或等于 (c, 取数组成员数 (b1)))
            加入成员 (b3, b1 [c])
        .如果真结束
        赋值 (c, 相加 (c, 2))
    .计次循环尾 ()
    删除成员 (b1, 取数组成员数 (b1), 1)
.否则
    赋值 (c, 1)
    .计次循环首 (取数组成员数 (b1), )
        .如果真 (小于或等于 (c, 取数组成员数 (b1)))
            加入成员 (b3, b1 [c])
        .如果真结束
        赋值 (c, 相加 (c, 2))
    .计次循环尾 ()
.如果结束


.如果 (等于 (求余数 (取绝对值 (取数组成员数 (b3)), 2), 1))
    赋值 (c, 1)
    .计次循环首 (相除 (相减 (取数组成员数 (b3), 1), 2), c)
        加入成员 (b2, b3 [c])
        加入成员 (b2, b3 [相加 (c, 相除 (相减 (取数组成员数 (b3), 1), 2))])
    .计次循环尾 ()
    加入成员 (b2, b3 [取数组成员数 (b3)])
    
.否则
    赋值 (c, 1)
    .计次循环首 (相除 (取数组成员数 (b3), 2), c)
        加入成员 (b2, b3 [c])
        加入成员 (b2, b3 [相加 (c, 相除 (取数组成员数 (b3), 2))])
    .计次循环尾 ()
    
.如果结束
赋值 (a, “”)
赋值 (c, 1)
.计次循环首 (取数组成员数 (b2), c)
    赋值 (a, 相加 (a, b2 [c]))
.计次循环尾 ()



.如果 (不等于 (寻找文本 (a, “*”, , 假), -1))
    .如果 (等于 (删尾空 (取文本右边 (a, 相减 (取文本长度 (a), 寻找文本 (a, “*”, , 假)))), 密码))
        赋值 (a1, 取文本中间 (a, 1, 相减 (寻找文本 (a, “*”, , 假), 1)))
    .否则
        信息框 (“密码错误，请核对！”, 0, )
        
    .如果结束
    
.否则
    赋值 (a1, a)
    
.如果结束



返回 (a1)

.子程序 设置背景, 空白型, , 设置超级列表框背景
.参数 超级列表框, 超级列表框, , 要添加背景的超级列表框
.参数 图片, 文本型, 可空, 要添加的背景图片，为空时清除背景
.参数 平铺, 逻辑型, 可空, 是否平铺，为空则为真

.局部变量 背景图片, 超级列表框背景图片, , , 

.如果真 (是否为空 (平铺))
    赋值 (平铺, 真)
.如果真结束
.如果 (或者 (是否为空 (图片), 小于或等于 (取文本长度 (图片), 0)))
    赋值 (背景图片.应用, 0)
.否则
    超级列表框.发送信息 (4134, 0, -1) ' 让文本背景透明
    赋值 (背景图片.应用, 位或 (2, 选择 (平铺, 16, 0)))
    赋值 (背景图片.图片, 图片) ' 图片路径
    赋值 (背景图片.横向百分比, 0)
    赋值 (背景图片.纵向百分比, 100) ' 左边与顶边偏移百分比，如果上面用平铺的话就没什么意义了
.如果结束
发送消息 (超级列表框.取窗口句柄 (), 4164, 0, 背景图片)

.子程序 清除背景, 空白型, , 清除超级列表框的背景
.参数 超级列表框, 超级列表框, , 

.局部变量 背景图片, 超级列表框背景图片, , , 

赋值 (背景图片.应用, 0)
发送消息 (超级列表框.取窗口句柄 (), 4164, 0, 背景图片)

.子程序 取票据序号, 文本型, , 取出MYSQL数据库文本型序号，失败返回空文本
.参数 SQL连接句柄, 整数型, , SQL连接句柄
.参数 表名, 文本型, , 数据表名
.参数 字段, 文本型, , 字段名(放置序号的字段名)
.参数 识别符, 文本型, 可空, 序号前缀识别符（如：PVW00000前的PVW）
.参数 位数, 整数型, , 序号位数

.局部变量 记录集句柄, 空白型, , , 
.局部变量 字段数, 空白型, , , 
.局部变量 记录数, 空白型, , , 
.局部变量 文本变量, 文本型, , , 

.如果真 (等于 (SQL连接句柄, 0))
    返回 (“”)
.如果真结束
.如果真 (等于 (未知支持库函数_3 (SQL连接句柄, 相加 (“select ”, 字段, “ from ”, 表名, “ where ”, 字段, “  like '%”, 识别符, “%' ORDER BY ”, 字段, “ DESC;”)), 假))
    返回 (“”)
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (字段数, 未知支持库函数_14 (记录集句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
未知支持库函数_6 (记录集句柄, 字段, 文本变量)
未知支持库函数_5 (记录集句柄)
.如果 (不等于 (文本变量, “”))
    返回 (取文本右边 (文本变量, 位数))
.否则
    返回 (“”)
.如果结束


.子程序 取数据库重复记录, 逻辑型, , 取出MYSQL取数据库重复的记录，发现重复返回真
.参数 SQL连接句柄, 整数型, , SQL连接句柄
.参数 表名, 文本型, , 数据表名
.参数 字段, 文本型, , 字段名(放置序号的字段名)
.参数 记录名, 文本型, , 存在重复的文本记录

.局部变量 记录集句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 

.如果真 (等于 (SQL连接句柄, 0))
    返回 (假)
.如果真结束
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select ”, 字段, “ from ”, 表名, “ where ”, 字段, “='”, 记录名, “';”)), 假))
    返回 (假)
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
未知支持库函数_5 (记录集句柄)
.如果 (大于或等于 (记录数, 1))
    返回 (真)
.否则
    返回 (假)
.如果结束


.子程序 取库特定记录, 文本型, , 取出MYSQL取数据库的特定单字段记录，发现返回文本
.参数 SQL连接句柄, 整数型, , SQL连接句柄
.参数 表名, 文本型, , 数据表名
.参数 条件字段, 文本型, , 寻找条件的字段名，只能是单字段。
.参数 位置字段, 文本型, , 被寻找位置的字段名，只能是单字段
.参数 条件记录, 文本型, , 存在的文本记录

.局部变量 记录集句柄, 整数型, , , 
.局部变量 文本, 文本型, , , 

.如果真 (等于 (SQL连接句柄, 0))
    返回 (“0”)
.如果真结束
.如果真 (等于 (未知支持库函数_3 (SQL连接句柄, 相加 (“select ”, 条件字段, “,”, 位置字段, “ from ”, 表名, “ where ”, 条件字段, “='”, 条件记录, “';”)), 假))
    返回 (“0”)
.如果真结束
赋值 (文本, “0”)
赋值 (记录集句柄, 未知支持库函数_4 (SQL连接句柄))
未知支持库函数_6 (记录集句柄, 位置字段, 文本)
未知支持库函数_5 (记录集句柄)
.如果 (不等于 (文本, “”))
    返回 (文本)
.否则
    返回 (“0”)
.如果结束


.窗口程序集 资料变更程序集, , , 

.程序集变量 变动号码, 文本型, , , 
.程序集变量 变动姓名, 文本型, , , 
.程序集变量 变动卡号, 文本型, , , 
.程序集变量 变动年份, 文本型, , , 
.程序集变量 变动学期, 文本型, , , 
.程序集变量 考试时间, 文本型, , , 
.程序集变量 变动班级, 文本型, , , 
.子程序 _资料变更窗口_创建完毕, 空白型, , 
.局部变量 学生信息, 文本型, , "0", 

未知支持库函数_0 (风格类型)
赋值 (资料变更窗口., 相减 (相加 (资料变更窗口., 190), 资料变更窗口.取用户区高度 ()))
.判断开始 (等于 (选择子夹, 0))
    赋值 (.现行子夹, 0)
    赋值 (资料变更窗口., “学生因转学、退学等原因离开本校”)
    赋值 (.标题, “学生转学退学离校”)
    .如果 (等于 (_启动窗口..现行子夹, 1))
        赋值 (变动号码, _启动窗口..标题)
        赋值 (变动姓名, _启动窗口..标题)
        赋值 (变动班级, _启动窗口..标题)
        赋值 (变动卡号, _启动窗口..标题)
    .否则
        赋值 (变动号码, _启动窗口.取标题 (., _启动窗口.., 1))
        赋值 (变动姓名, _启动窗口.取标题 (., _启动窗口.., 2))
        赋值 (变动卡号, _启动窗口.取标题 (., _启动窗口.., 4))
        赋值 (变动班级, _启动窗口.取标题 (., _启动窗口.., 6))
    .如果结束
    赋值 (.标题, 相加 (“您确定”, 变动班级, “的”, 变动姓名, “同学要离开本校吗？”))
    
.判断 (等于 (选择子夹, 1))
    赋值 (.现行子夹, 1)
    赋值 (.标题, “调整学生班级”)
    赋值 (资料变更窗口., “调整学生班级”)
    .如果 (填充班级名称 ())
        .如果 (等于 (_启动窗口..现行子夹, 1))
            赋值 (变动号码, _启动窗口..标题)
            赋值 (变动姓名, _启动窗口..标题)
            赋值 (变动班级, _启动窗口..标题)
        .否则
            赋值 (变动号码, _启动窗口.取标题 (., _启动窗口.., 1))
            赋值 (变动姓名, _启动窗口.取标题 (., _启动窗口.., 2))
            赋值 (变动班级, _启动窗口.取标题 (., _启动窗口.., 6))
        .如果结束
        赋值 (.标题, 相加 (变动姓名, “同学目前在本校”, 变动班级, “就读。您确定要调整”, 变动姓名, “同学的班级吗？”))
    .否则
        信息框 (“目前没有班级数据，请先进行校务设置!”, 0, “提示”)
        销毁 ()
        _教务设置_被选择 ()
        返回 ()
    .如果结束
    
.判断 (等于 (选择子夹, 2))
    赋值 (.现行子夹, 2)
    赋值 (资料变更窗口., “学生升级毕业”)
    赋值 (.标题, “学生升级毕业”)
    
.判断 (等于 (选择子夹, 3))
    .判断开始 (等于 (教员去向, “退休”))
        赋值 (资料变更窗口., “本校教员退休”)
        清空 ()
        “正常退休”.加入项目 ()
        “内退”.加入项目 ()
        赋值 (.现行选中项, 0)
        赋值 (.标题, “本校教员退休”)
        赋值 (.标题, “退休说明：”)
        赋值 (.标题, “教员退休日期：”)
        
    .判断 (等于 (教员去向, “调离”))
        赋值 (资料变更窗口., “教员调离本校”)
        清空 ()
        “正常调动工作”.加入项目 ()
        赋值 (.现行选中项, 0)
        赋值 (.标题, “教员调离本校”)
        赋值 (.标题, “调离原因：”)
        赋值 (.标题, “教员调离日期：”)
    .默认
        
    .判断结束
    
    .如果 (等于 (_启动窗口..现行子夹, 5))
        赋值 (变动号码, _启动窗口..标题)
        赋值 (.标题, 相加 (“您确定姓名为”, _启动窗口..标题, “的教员离开本校吗？”))
        赋值 (变动姓名, _启动窗口..标题)
        赋值 (_启动窗口..现行子夹, 5)
        
    .否则
        赋值 (变动号码, _启动窗口.取标题 (., _启动窗口.., 10))
        赋值 (变动姓名, _启动窗口.取标题 (., _启动窗口.., 1))
        赋值 (.标题, 相加 (“您确定姓名为”, 变动姓名, “的教员离开本校吗？”))
        赋值 (_启动窗口..现行子夹, 6)
        
    .如果结束
    
    赋值 (.现行子夹, 3)
    
.判断 (等于 (选择子夹, 4))
    .如果 (填充班级名称 ())
        赋值 (资料变更窗口., “离校学生复学”)
        赋值 (.标题, “离开本校的学生复学”)
        .如果 (等于 (_启动窗口..现行子夹, 1))
            .如果 (不等于 (_启动窗口.., -1))
                赋值 (变动号码, 到文本 (_启动窗口.取表项数值 (., _启动窗口..)))
                赋值 (变动姓名, _启动窗口.取标题 (., _启动窗口.., 0))
                赋值 (变动卡号, _启动窗口.取标题 (., _启动窗口.., 4))
            .否则
                信息框 (“  请选择要复学的学生姓名！  ”, 0, “提示”)
                销毁 ()
                返回 ()
            .如果结束
            
        .否则
            .如果 (不等于 (_启动窗口.., -1))
                赋值 (变动班级, _启动窗口.取标题 (., _启动窗口.., 6))
                赋值 (变动号码, _启动窗口.取标题 (., _启动窗口.., 1))
                赋值 (变动姓名, _启动窗口.取标题 (., _启动窗口.., 2))
                赋值 (变动卡号, _启动窗口.取标题 (., _启动窗口.., 4))
                赋值 (.现行选中项, 变动班级.选择 ())
                赋值 (.内容, 变动卡号)
            .否则
                信息框 (“  请选择要复学的学生姓名！  ”, 0, “提示”)
                销毁 ()
                返回 ()
            .如果结束
            
        .如果结束
        赋值 (.标题, 相加 (“您确定姓名为”, 变动姓名, “的学生复学吗？”))
        赋值 (.现行子夹, 4)
        
    .否则
        信息框 (“  载入班级数据失败！  ”, #错误图标, “错误”)
        销毁 ()
        返回 ()
    .如果结束
    
.判断 (等于 (选择子夹, 5))
    赋值 (资料变更窗口., “彻底删除离校学生”)
    赋值 (.标题, “彻底删除离校学生”)
    .如果 (等于 (_启动窗口..现行子夹, 1))
        .如果 (不等于 (_启动窗口.., -1))
            赋值 (变动号码, 到文本 (_启动窗口.取表项数值 (., _启动窗口..)))
            赋值 (变动姓名, _启动窗口.取标题 (., _启动窗口.., 0))
            赋值 (变动卡号, _启动窗口.取标题 (., _启动窗口.., 4))
        .否则
            信息框 (“ 请选择要删除的学生姓名！  ”, 0, “提示”)
            销毁 ()
            返回 ()
        .如果结束
        
    .否则
        .如果 (不等于 (_启动窗口.., -1))
            赋值 (变动班级, _启动窗口.取标题 (., _启动窗口.., 6))
            赋值 (变动号码, _启动窗口.取标题 (., _启动窗口.., 1))
            赋值 (变动姓名, _启动窗口.取标题 (., _启动窗口.., 2))
            赋值 (变动卡号, _启动窗口.取标题 (., _启动窗口.., 4))
            赋值 (.现行选中项, 变动班级.选择 ())
            赋值 (.内容, 变动卡号)
        .否则
            信息框 (“  请选择要删除的学生姓名！  ”, 0, “提示”)
            销毁 ()
            返回 ()
        .如果结束
        
    .如果结束
    赋值 (.标题, 相加 (“您确定要对姓名为”, 变动姓名, “的学生做彻底删除吗？”))
    赋值 (.现行子夹, 5)
    
.判断 (等于 (选择子夹, 6))
    .如果真 (等于 (_启动窗口..现行子夹, 4))
        赋值 (.标题, 相加 (到文本 (取年份 (_启动窗口..今天)), “年”, _启动窗口..内容, _启动窗口..内容, “各科目成绩录入”))
        .如果 (不等于 (_启动窗口..现行选中项, -1))
            .如果 (不等于 (_启动窗口..现行选中项, -1))
                赋值 (学生信息, 分割文本 (_启动窗口..内容, “(”, ))
                .如果真 (大于或等于 (取数组成员数 (学生信息), 2))
                    赋值 (变动姓名, 学生信息 [1])
                    赋值 (变动号码, 取文本左边 (学生信息 [2], 相减 (取文本长度 (学生信息 [2]), 1)))
                    赋值 (变动班级, _启动窗口..内容)
                .如果真结束
                
            .否则
                信息框 (“ 请选择学生姓名！  ”, 0, “提示”)
                销毁 ()
                返回 ()
            .如果结束
            
        .否则
            信息框 (“ 请选择学生所在班级！  ”, 0, “提示”)
            销毁 ()
            返回 ()
        .如果结束
        
    .如果真结束
    取科目 ()
    赋值 (资料变更窗口., 相加 (“ ”, 变动姓名, “ 同学各科目成绩录入”))
    赋值 (.标题, 相加 (“您现在将对”, 变动姓名, “同学进行成绩录入操作！ 此操纵不可逆,请录入前注意数据的正确性！”))
    赋值 (.现行子夹, 6)
    赋值 (.今天, _启动窗口..今天)
    赋值 (.现行选中项, _启动窗口.选择 (..内容))
    赋值 (.现行选中项, _启动窗口.选择 (..内容))
    
    _考试时组合框_列表项被选择 ()
.默认
    
.判断结束
赋值 (资料变更窗口., 真)


.子程序 _离校确定钮_被单击, 空白型, , 离校
.局部变量 条件, 文本型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请选择学生离校的原因！”, 0, )
    返回 ()
.如果真结束
赋值 (条件, 相加 (“xh='”, 变动号码, “'”))
.如果真 (等于 (连接句柄, 0))
    载入 (登录窗口, , 真)
    返回 ()
.如果真结束
.如果 (未知支持库函数_19 (连接句柄, “xsda”, 相加 (“lxsj='”, 时间到文本 (.今天, 2), “',lxyy='”, .内容, “',zxxz='离校学生',kh='',lskh='”, 变动卡号, “'”), 条件))
    填充学生资料 ()
    填充学生姓名 ()
    填充查看科目 ()
    赋值 (_启动窗口.., 0)
    信息框 (“完成学生转学退学离校操作！”, 0, )
    _在校学生记录_被选择 ()
    销毁 ()
.否则
    信息框 (“学生转学退学离校操作失败！”, 0, )
    销毁 ()
.如果结束


.子程序 _取消钮_被单击, 空白型, , 
销毁 ()

.子程序 _调整确定钮_被单击, 空白型, , 调整
.局部变量 条件, 文本型, , , 

.如果真 (等于 (.内容, 变动班级))
    信息框 (相加 (“该生目前已在”, .内容, “，无须调整！”), 0, )
    返回 ()
.如果真结束
赋值 (条件, 相加 (“xh='”, 变动号码, “'”))
.如果真 (等于 (连接句柄, 0))
    载入 (登录窗口, , 真)
    返回 ()
.如果真结束
.如果 (未知支持库函数_19 (连接句柄, “xsda”, 相加 (“szbj='”, .内容, “'”), 条件))
    填充学生资料 ()
    填充学生姓名 ()
    填充查看科目 ()
    赋值 (_启动窗口.., 0)
    信息框 (“完成调班操作！”, 0, )
    _在校学生记录_被选择 ()
    销毁 ()
    
.否则
    信息框 (“调班操作失败！”, 0, )
    销毁 ()
.如果结束


.子程序 _退休确定钮_被单击, 空白型, , 
.局部变量 条件, 文本型, , , 
.局部变量 error, 文本型, , , 

.判断开始 (等于 (教员去向, “退休”))
    .如果真 (等于 (.内容, “”))
        信息框 (“请选择学生离校的原因！”, 0, )
        返回 ()
    .如果真结束
    赋值 (条件, 相加 (“sfz='”, 变动号码, “'”))
    .如果真 (等于 (连接句柄, 0))
        载入 (登录窗口, , 真)
        返回 ()
    .如果真结束
    .如果 (未知支持库函数_19 (连接句柄, “jyda”, 相加 (“txsj='”, 时间到文本 (.今天, 2), “',txyy='”, .内容, “',zzlx='退休教员'”), 条件))
        赋值 (_启动窗口., “zzlx like '%在职教员%'”)
        填充教员列表 ()
        填充教员 ()
        填教员资料 ()
        赋值 (_启动窗口.., 0)
        赋值 (记录日志, 相加 (“教员”, 变动姓名, “退休操作成功”))
        写日志 ()
        信息框 (“完成教员退休操作！”, 0, )
        销毁 ()
        
    .否则
        未知支持库函数_41 (连接句柄, error)
        信息框 (相加 (“教员退休操作失败！”, error), 0, )
        销毁 ()
    .如果结束
    
    
.判断 (等于 (教员去向, “调离”))
    .如果真 (等于 (.内容, “”))
        信息框 (“请选择学生离校的原因！”, 0, )
        返回 ()
    .如果真结束
    赋值 (条件, 相加 (“sfz='”, 变动号码, “'”))
    .如果真 (等于 (连接句柄, 0))
        载入 (登录窗口, , 真)
        返回 ()
    .如果真结束
    .如果 (未知支持库函数_19 (连接句柄, “jyda”, 相加 (“txsj='”, 时间到文本 (.今天, 2), “',txyy='”, .内容, “',zzlx='调离教员'”), 条件))
        赋值 (_启动窗口., “zzlx like '%在职教员%'”)
        填充教员列表 ()
        填充教员 ()
        填教员资料 ()
        赋值 (_启动窗口.., 0)
        赋值 (记录日志, 相加 (“教员”, 变动姓名, “退休操作成功”))
        写日志 ()
        信息框 (“完成教员调离操作！”, 0, )
        销毁 ()
    .否则
        未知支持库函数_41 (连接句柄, error)
        信息框 (相加 (“教员调离操作失败！”, error), 0, )
        销毁 ()
        
    .如果结束
    
.默认
    
.判断结束


.子程序 _复学确定钮_被单击, 空白型, , 
.局部变量 条件, 文本型, , , 

.如果 (等于 (学生分类, “毕业学生”))
    赋值 (条件, 相加 (“xh='”, 变动号码, “'”))
    .如果真 (取数据库重复记录 (连接句柄, “xsda”, “kh”, .内容))
        信息框 (“改学生的原卡号已经被使用，请更换新卡号！”, #信息图标, “重复错误！”)
        赋值 (.内容, “”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (变动卡号, .内容)
    .如果真 (等于 (连接句柄, 0))
        载入 (登录窗口, , 真)
        返回 ()
    .如果真结束
    .如果 (未知支持库函数_19 (连接句柄, “xsda”, 相加 (“kh='”, 变动卡号, “',lxsj='',szbj='”, .内容, “',lxyy=' ',lskh=' ',zxxz='在校学生'”), 条件))
        填充学生资料 ()
        填充学生姓名 ()
        填充查看科目 ()
        _启动窗口._历届搜索_被单击 ()
        信息框 (“学生复学操作完成！”, 0, )
        销毁 ()
    .否则
        信息框 (“学生复学操作失败！”, 0, )
        销毁 ()
    .如果结束
    
.否则
    赋值 (条件, 相加 (“xh='”, 变动号码, “'”))
    .如果真 (取数据库重复记录 (连接句柄, “xsda”, “kh”, .内容))
        信息框 (“改学生的原卡号已经被使用，请更换新卡号！”, #信息图标, “重复错误！”)
        赋值 (.内容, “”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (变动卡号, .内容)
    .如果真 (等于 (连接句柄, 0))
        载入 (登录窗口, , 真)
        返回 ()
    .如果真结束
    .如果 (未知支持库函数_19 (连接句柄, “xsda”, 相加 (“kh='”, 变动卡号, “',szbj='”, .内容, “',lxsj=' ',lxyy=' ',lskh=' ',zxxz='在校学生'”), 条件))
        填充学生资料 ()
        填充学生姓名 ()
        填充查看科目 ()
        销毁 ()
    .否则
        信息框 (“学生复学操作失败！”, 0, )
        销毁 ()
    .如果结束
    
    
.如果结束


.子程序 _复学确定钮1_被单击, 空白型, , 
.局部变量 条件, 文本型, , , 

.如果真 (等于 (变动号码, “”))
    信息框 (“没有选择学生号！”, 0, )
    返回 ()
.如果真结束
赋值 (条件, 相加 (“xh='”, 变动号码, “'”))
.如果真 (等于 (连接句柄, 0))
    载入 (登录窗口, , 真)
    返回 ()
.如果真结束
.如果 (未知支持库函数_20 (连接句柄, “xsda”, 条件))
    赋值 (_启动窗口.., 0)
    信息框 (“完成调班操作！”, 0, )
    _离退校学生记录_被选择 ()
    销毁 ()
    
.否则
    信息框 (“调班操作失败！”, 0, )
    销毁 ()
.如果结束


.子程序 _科目保存_被单击, 空白型, , 
.局部变量 资料, 文本型, , , 
.局部变量 年份, 文本型, , , 
.局部变量 学期, 文本型, , , 
.局部变量 考试时, 文本型, , , 
.局部变量 错误, 文本型, , , 

.如果真 (等于 (连接句柄, 0))
    载入 (登录窗口, , 真)
    返回 ()
.如果真结束
.如果真 (等于 (变动号码, “”))
    信息框 (“没有选择学生号！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (变动班级, “”))
    信息框 (“没有选择班级！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入至少一个科目的分数！”, 0, )
    返回 ()
.如果真结束
赋值 (年份, 到文本 (取年份 (_启动窗口..今天)))
赋值 (学期, _启动窗口..内容)
赋值 (考试时, _启动窗口..内容)
.如果真 (取数据库重复记录 (连接句柄, “cjb”, “bj”, 变动班级))
    .如果真 (取数据库重复记录 (连接句柄, “cjb”, “xh”, 变动号码))
        .如果真 (取数据库重复记录 (连接句柄, “cjb”, “xq”, 学期))
            .如果真 (取数据库重复记录 (连接句柄, “cjb”, “nf”, 年份))
                .如果真 (取数据库重复记录 (连接句柄, “cjb”, “kslx”, 考试时))
                    信息框 (相加 (“抱歉！ ”, 变动姓名, “同学本学期的考试成绩已经录入！”), 0, )
                    返回 ()
                .如果真结束
                
            .如果真结束
            
        .如果真结束
        
    .如果真结束
    
.如果真结束
赋值 (资料, 相加 (“xh='”, 变动号码, “',xm='”, 变动姓名, “',bj='”, 变动班级, “',nf='”, 年份, “',xq='”, 学期, “',kslx='”, 考试时, “',cjz1='”, .内容, “',cjz2='”, .内容, “',cjz3='”, .内容, “',cjz4='”, .内容, “',cjz5='”, .内容, “',cjz6='”, .内容, “',cjz7='”, .内容, “',cjz8='”, .内容, “',cjz9='”, .内容, “',cjz10='”, .内容, “',cjm1='”, .内容, “',cjm2='”, .内容, “',cjm3='”, .内容, “',cjm4='”, .内容, “',cjm5='”, .内容, “',cjm6='”, .内容, “',cjm7='”, .内容, “',cjm8='”, .内容, “',cjm9='”, .内容, “',cjm10='”, .内容, “'”))
.如果 (未知支持库函数_18 (连接句柄, “cjb”, 资料))
    信息框 (相加 (变动姓名, “同学的成绩录入完成！”), #信息图标, “ 提示！”)
    赋值 (记录日志, 相加 (变动姓名, “同学的成绩录入完成”))
    写日志 ()
    销毁 ()
.否则
    未知支持库函数_41 (连接句柄, 错误)
    信息框 (相加 (变动姓名, “同学的成绩录入错误！”, 错误), #信息图标, “ 提示！”)
    
.如果结束



.子程序 _修改按钮_被单击, 空白型, , 
.局部变量 资料, 文本型, , , 
.局部变量 年份, 文本型, , , 
.局部变量 学期, 文本型, , , 
.局部变量 考试时, 文本型, , , 
.局部变量 错误, 文本型, , , 
.局部变量 条件, 文本型, , , 

.如果真 (等于 (连接句柄, 0))
    载入 (登录窗口, , 真)
    返回 ()
.如果真结束
.如果真 (等于 (变动号码, “”))
    信息框 (“没有选择学生号！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (变动班级, “”))
    信息框 (“没有选择班级！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“没有科目分数！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入至少一个科目的分数！”, 0, )
    返回 ()
.如果真结束

赋值 (变动年份, 到文本 (取年份 (.今天)))
赋值 (变动学期, .内容)
赋值 (考试时间, .内容)

赋值 (条件, 相加 (“bj like '%”, 变动班级, “%' and xh like '%”, 变动号码, “%' and nf like '%”, 变动年份, “%' and xq like '%”, 变动学期, “%' and kslx like '%”, 考试时间, “%'”))

赋值 (资料, 相加 (“cjz1='”, .内容, “',cjz2='”, .内容, “',cjz3='”, .内容, “',cjz4='”, .内容, “',cjz5='”, .内容, “',cjz6='”, .内容, “',cjz7='”, .内容, “',cjz8='”, .内容, “',cjz9='”, .内容, “',cjz10='”, .内容, “',cjm1='”, .内容, “',cjm2='”, .内容, “',cjm3='”, .内容, “',cjm4='”, .内容, “',cjm5='”, .内容, “',cjm6='”, .内容, “',cjm7='”, .内容, “',cjm8='”, .内容, “',cjm9='”, .内容, “',cjm10='”, .内容, “'”))

.如果 (未知支持库函数_19 (连接句柄, “cjb”, 资料, 条件))
    信息框 (相加 (变动姓名, “同学的成绩更新完成！”), #信息图标, “ 提示！”)
    赋值 (记录日志, 相加 (变动姓名, “同学的成绩更新完成”))
    写日志 ()
    销毁 ()
.否则
    未知支持库函数_41 (连接句柄, 错误)
    信息框 (相加 (变动姓名, “同学的成绩更新错误！”, 错误), #信息图标, “ 提示！”)
    
.如果结束


.子程序 _修改选择框_被单击, 空白型, , 
.如果 (等于 (.选中, 假))
    连续赋值 (真, .禁止, .禁止, .禁止, .禁止)
    连续赋值 (假, .禁止)
    赋值 (.标题, 相加 (到文本 (取年份 (_启动窗口..今天)), “年”, _启动窗口..内容, _启动窗口..内容, “各科目成绩录入”))
    赋值 (资料变更窗口., 相加 (“ ”, 变动姓名, “ 同学各科目成绩录入”))
    
.否则
    连续赋值 (假, .禁止, .禁止, .禁止, .禁止)
    连续赋值 (真, .禁止)
    赋值 (.标题, 相加 (到文本 (取年份 (_启动窗口..今天)), “年”, _启动窗口..内容, _启动窗口..内容, “各科目成绩修改”))
    赋值 (资料变更窗口., 相加 (“ ”, 变动姓名, “ 同学各科目成绩修改”))
    
.如果结束


.子程序 _日期框_选择日期被改变, 空白型, , 
.如果真 (等于 (变动班级, “”))
    返回 ()
.如果真结束
.如果真 (等于 (变动号码, “”))
    返回 ()
.如果真结束
取科目 ()
赋值 (变动年份, 到文本 (取年份 (.今天)))
赋值 (变动学期, .内容)
赋值 (考试时间, .内容)
取成绩 ()

.子程序 _学期组合框_列表项被选择, 空白型, , 
.如果真 (等于 (变动班级, “”))
    返回 ()
.如果真结束
.如果真 (等于 (变动号码, “”))
    返回 ()
.如果真结束
取科目 ()
赋值 (变动年份, 到文本 (取年份 (.今天)))
赋值 (变动学期, .内容)
赋值 (考试时间, .内容)
取成绩 ()


.子程序 _考试时组合框_列表项被选择, 空白型, , 
.如果真 (等于 (变动班级, “”))
    返回 ()
.如果真结束
.如果真 (等于 (变动号码, “”))
    返回 ()
.如果真结束
取科目 ()
赋值 (变动年份, 到文本 (取年份 (.今天)))
赋值 (变动学期, .内容)
赋值 (考试时间, .内容)
取成绩 ()


.子程序 取科目, 空白型, , 
.局部变量 文本变量, 文本型, , , 
.局部变量 记录集句柄, 整数型, , , 

.如果真 (等于 (变动班级, “”))
    返回 ()
.如果真结束
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select bzr,bj,km1,km2,km3,km4,km5,km6,km7,km8,km9,km10 from system where bj like '%”, 变动班级, “%' ORDER BY bj DESC;”)), 假)) ' 导出记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km1”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km2”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km3”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km4”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km5”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km6”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km7”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km8”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km9”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km10”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_5 (记录集句柄)


.子程序 取成绩, 空白型, , 
.局部变量 文本变量, 文本型, , , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 条件, 文本型, , , 

.如果真 (等于 (变动班级, “”))
    返回 ()
.如果真结束
.如果真 (等于 (变动年份, “”))
    返回 ()
.如果真结束
.如果真 (等于 (变动号码, “”))
    返回 ()
.如果真结束
.如果真 (等于 (变动学期, “”))
    返回 ()
.如果真结束
.如果真 (等于 (考试时间, “”))
    返回 ()
.如果真结束
赋值 (条件, 相加 (“bj like '%”, 变动班级, “%' and xh like '%”, 变动号码, “%' and nf like '%”, 变动年份, “%' and xq like '%”, 变动学期, “%' and kslx like '%”, 考试时间, “%'”))
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select * from cjb where ”, 条件, “;”)), 假)) ' 导出记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
.如果 (等于 (未知支持库函数_7 (记录集句柄), 0))
    .如果 (等于 (.选中, 真))
        连续赋值 (真, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
    .否则
        连续赋值 (假, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
    .如果结束
    
.否则
    连续赋值 (假, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
.如果结束

未知支持库函数_12 (记录集句柄)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “cjm1”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “cjm2”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “cjm3”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “cjm4”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “cjm5”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “cjm6”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “cjm7”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “cjm8”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “cjm9”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “cjm10”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_5 (记录集句柄)


.窗口程序集 系统配置程序集, , , 

.子程序 _系统配置窗口_创建完毕, 空白型, , 
赋值 (风格类型, 到数值 (读配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “Style”, )))
赋值 (菜单类型, 到数值 (读配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “menu”, )))
.判断开始 (等于 (风格类型, 1))
    赋值 (.选中, 真)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
.判断 (等于 (风格类型, 2))
    赋值 (.选中, 真)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
.判断 (等于 (风格类型, 3))
    赋值 (.选中, 真)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
.默认
    赋值 (.选中, 真)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
.判断结束

.判断开始 (等于 (菜单类型, 1))
    赋值 (.选中, 真)
    连续赋值 (假, .选中, .选中, .选中, .选中, .选中)
.判断 (等于 (菜单类型, 2))
    赋值 (.选中, 真)
    连续赋值 (假, .选中, .选中, .选中, .选中, .选中)
.判断 (等于 (菜单类型, 3))
    赋值 (.选中, 真)
    连续赋值 (假, .选中, .选中, .选中, .选中, .选中)
.判断 (等于 (菜单类型, 4))
    赋值 (.选中, 真)
    连续赋值 (假, .选中, .选中, .选中, .选中, .选中)
.判断 (等于 (菜单类型, 5))
    赋值 (.选中, 真)
    连续赋值 (假, .选中, .选中, .选中, .选中, .选中)
.判断 (等于 (菜单类型, 6))
    赋值 (.选中, 真)
    连续赋值 (假, .选中, .选中, .选中, .选中, .选中)
.默认
    
.判断结束



.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
.判断开始 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “Style”, “0”)
    赋值 (风格类型, 0)
.判断 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “Style”, “1”)
    赋值 (风格类型, 1)
.判断 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “Style”, “2”)
    赋值 (风格类型, 2)
.判断 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “Style”, “3”)
    赋值 (风格类型, 3)
.默认
    
.判断结束

.判断开始 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “menu”, “1”)
    赋值 (菜单类型, 1)
.判断 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “menu”, “2”)
    赋值 (菜单类型, 2)
.判断 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “menu”, “3”)
    赋值 (菜单类型, 3)
.判断 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “menu”, “4”)
    赋值 (菜单类型, 4)
.判断 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “menu”, “5”)
    赋值 (菜单类型, 5)
.判断 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “menu”, “6”)
    赋值 (菜单类型, 6)
.默认
    
.判断结束
赋值 (风格类型, 到数值 (读配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “Style”, )))
赋值 (菜单类型, 到数值 (读配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “menu”, )))
赋值 (_启动窗口.., 菜单类型)
销毁 ()

.窗口程序集 教员资料录入程序集, , , 

.程序集变量 性别参考, 文本型, , , 
.程序集变量 教员序号, 整数型, , , 
.程序集变量 已修改, 逻辑型, , , 
.程序集变量 附加打开, 逻辑型, , , 
.子程序 _资料录入修改教员_创建完毕, 空白型, , 
未知支持库函数_0 (风格类型)
资料录入修改教员.移动 (_启动窗口., _启动窗口., _启动窗口., _启动窗口.)
1.置文本 (_启动窗口.取文本 (., 1))
赋值 (已修改, 假)

填充教员名 ()
.如果 (等于 (修改资料, 假))
    
    赋值 (.图片, #图片1)
    2.置文本 (“当前状态：添加教员资料”)
    3.置文本 (“提示：请输入资料后按[保存数据]按钮。”)
    赋值 (资料录入修改教员., “添加教员资料”)
    赋值 (.标题, 相加 (“添加”, _启动窗口..标题, “的教员资料”))
    赋值 (., “保存数据”)
    赋值 (.字体名称, 真)
    赋值 (.标题, “教员姓名列表”)
    
.否则
    赋值 (.字体名称, 假)
    赋值 (.禁止, 真)
    .如果真 (等于 (取表项数 (), 0))
        信息框 (“目前本校没有在职教员数据！请先添加教员数据！”, 0, )
        资料录入修改教员.销毁 ()
        返回 ()
    .如果真结束
    .如果 (或者 (等于 (_启动窗口..现行子夹, 5), 等于 (_启动窗口..现行子夹, 6)))
        _启动窗口.查找表项 (..标题, , ).选择表项 ()
    .否则
        
    .如果结束
    0.选择表项 ()
    填充教员资料 ()
    2.置文本 (“当前状态：修改教员资料”)
    3.置文本 (“提示：请先选择要修改资料的教员姓名，修改完成后按[保存修改]。”)
    赋值 (资料录入修改教员., “修改教员资料”)
    赋值 (., “保存修改”)
    赋值 (.标题, “请选择要修改资料的教员姓名”)
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果结束


.子程序 _资料录入修改教员_位置被改变, 空白型, , 
_启动窗口.移动 (资料录入修改教员., 资料录入修改教员., , )
连续赋值 (相减 (资料录入修改教员., 8), .宽度, .宽度)
.移动 (.宽度, 相减 (取用户区高度 (), ., .高度, .高度, 6))
赋值 (.顶边, 相加 (.顶边, .高度, 1))
连续赋值 (相除 (_启动窗口., 10), .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度)
连续赋值 (相除 (_启动窗口., 3.333), .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度, .宽度)
连续赋值 (相加 (.左边, .宽度), .左边, .左边, .左边, .左边, .左边, .左边, .左边, .左边, .左边)
连续赋值 (相加 (.左边, .宽度), .左边, .左边, .左边, .左边, .左边, .左边, .左边, .左边, .左边)
连续赋值 (相加 (.左边, .宽度), .左边, .左边, .左边, .左边, .左边, .左边, .左边, .左边, .左边, .左边)
赋值 (., 相加 (相除 (相减 (.宽度, .), 2), .左边))
相加 (.左边, .宽度).移动 (相除 (_启动窗口., 5.71), )
.移动 (相减 (.高度, .顶边, 8))
赋值 (.高度, 相减 (.高度, .顶边, 4))
赋值 (.高度, 相减 (.高度, .顶边, 4))
赋值 (.角度, 相加 (.左边, .宽度, 20))
.移动 (相减 (相加 (.左边, .宽度), .角度), 相减 (.高度, .加粗, 8))
相减 (.宽度, ., ., 100).移动 ()
相减 (.宽度, ., 50).移动 ()
赋值 (.宽度, 相减 (.宽度, 4))
赋值 (.左边, 相加 (.左边, .宽度, 10))
连续赋值 (相减 (相除 (.宽度, 2), 6), .宽度, .宽度)
赋值 (.左边, .左边)
赋值 (.左边, 相加 (.左边, .宽度, 12))


.子程序 填充教员名, 空白型, , 填充教员名
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 行, 整数型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 列, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本量, 文本型, , "0", 
.局部变量 错误, 文本型, , , 
.局部变量 D, 整数型, , , 
.局部变量 表项, 整数型, , , 
.局部变量 当前班级, 文本型, , , 
.局部变量 姓名变量, 文本型, , , 

置等待鼠标 ()
赋值 (男, 0)
赋值 (女, 0)
.如果真 (等于 (连接句柄, 0))
    返回 ()
.如果真结束
置等待鼠标 ()

.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select xb,xm,zzlx from jyda where zzlx like '%”, “在职教员”, “%'ORDER BY xm ASC;”)), 假)) ' 导出记录
    未知支持库函数_41 (连接句柄, 错误)
    信息框 (相加 (“建立记录失败！”, 错误), 0, )
    返回 ()
.如果真结束

赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
全部删除 ()
.计次循环首 (记录数, 行)
    置等待鼠标 ()
    赋值 (文本变量, “”)
    赋值 (姓名变量, “”)
    未知支持库函数_6 (记录集句柄, “xb”, 文本变量)
    .如果 (等于 (文本变量, “男”))
        赋值 (男, 相加 (男, 1))
    .否则
        赋值 (女, 相加 (女, 1))
    .如果结束
    未知支持库函数_6 (记录集句柄, “xm”, 姓名变量)
    .如果 (等于 (文本变量, “男”))
        .插入表项 (姓名变量, 1, , , )
        
    .否则
        .插入表项 (姓名变量, 0, , , )
    .如果结束
    
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
2.置文本 (“当前状态：录入教员资料”)
赋值 (.标题, 相加 (“目前共有”, 到文本 (记录数), “名教员  其中男教员”, 到文本 (男), “人  女教员”, 到文本 (女), “人”))
恢复鼠标 ()

.子程序 填充教员资料, 空白型, , 填充教员资料
.局部变量 当前姓名, 文本型, , , 
.局部变量 当前班级, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 节集变量, 字节集, , , 

.如果真 (等于 (取表项数 (), 0))
    赋值 (.标题, “目前没有教员资料！”)
    填空资料 ()
    返回 ()
.如果真结束

赋值 (当前姓名, .取标题 (., 0))

.如果真 (等于 (连接句柄, 0))
    返回 ()
.如果真结束
置等待鼠标 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select * from jyda where xm like '%”, 当前姓名, “%' and zzlx like '%”, “在职教员”, “%'ORDER BY xm ASC;”)), 假)) ' 导出记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
填空资料 ()
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “xm”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “xb”, 文本变量)
赋值 (.现行选中项, 文本变量.选择 ())
未知支持库函数_6 (记录集句柄, “mz”, 文本变量)
赋值 (.现行选中项, 文本变量.选择 ())
未知支持库函数_6 (记录集句柄, “xl”, 文本变量)
赋值 (.现行选中项, 文本变量.选择 ())
未知支持库函数_6 (记录集句柄, “cssj”, 文本变量)
赋值 (.今天, 到时间 (文本变量))
未知支持库函数_6 (记录集句柄, “zzmm”, 文本变量)
赋值 (.现行选中项, 文本变量.选择 ())
未知支持库函数_6 (记录集句柄, “gzsj”, 文本变量)
赋值 (.今天, 到时间 (文本变量))
未知支持库函数_6 (记录集句柄, “rxsj”, 文本变量)
赋值 (.今天, 到时间 (文本变量))
未知支持库函数_6 (记录集句柄, “zc”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “zw”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “sfz”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “sj”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “dz”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “dh”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “jg”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “hjdz”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “jbgz”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “fjgz”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “hsbt”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “shbx”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “tp”, 节集变量)
赋值 (.图片, 节集变量)
未知支持库函数_6 (记录集句柄, “gzgw”, 文本变量)
赋值 (.现行选中项, 文本变量.选择 ())
未知支持库函数_6 (记录集句柄, “jl”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “zl”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “gzxz”, 文本变量)
赋值 (.现行选中项, 文本变量.选择 ())
未知支持库函数_6 (记录集句柄, “zzlx”, 文本变量)
未知支持库函数_5 (记录集句柄)

赋值 (.标题, 相加 (“您现在修改的是”, _启动窗口..标题, .取标题 (., ), “同志的资料”))


.子程序 填空资料, 空白型, , 
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)


.子程序 _教员名列表框_当前表项被改变, 空白型, , 
填充教员资料 ()


.子程序 _选择照片钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 图片, 字节集, , , 

.如果真 (打开 ())
    赋值 (图片, 读入文件 (.文件名))
    .如果真 (大于 (取字节集长度 (图片), 相乘 (65, 1000)))
        信息框 (“图片尺寸太大，请保持尺寸在65KB以内！”, #警告图标, “错误提示！”)
        返回 ()
    .如果真结束
    赋值 (.图片, 读入文件 (.文件名))
.如果真结束


.子程序 _删除照片钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (不等于 (.图片, #图片1))
    .如果真 (等于 (信息框 (相加 (“您确定要删除”, .内容, “的照片吗？”), 相加 (#确认取消钮, #询问图标), “询问”), #确认钮))
        赋值 (.图片, #图片1)
    .如果真结束
    
.如果真结束


.子程序 _教员资料录入修改窗口_被取消激活, 空白型, , 
获取焦点 ()

.子程序 _简历编辑框_内容被改变, 空白型, , 
.如果 (大于 (186.发送信息 (0, 0), 19))
    赋值 (.输入方式, 1)
    .判断循环首 (大于 (186.发送信息 (0, 0), 19))
        赋值 (.内容, 取文本左边 (.内容, 相减 (取文本长度 (.内容), 2)))
    .判断循环尾 ()
    信息框 (“个人简历最多输入19行内容！”, 0, )
    赋值 (.起始选择位置, 取文本长度 (.内容))
    赋值 (.输入方式, 0)
.否则
    赋值 (.输入方式, 0)
.如果结束


.子程序 _个人简历钮_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.标题, “● 个人简历”)
赋值 (.标题, “其他资料”)
赋值 (.标题, “ 个人简历：”)
赋值 (.可视, 真)
赋值 (.可视, 真)
#顶层.调整层次 ()
赋值 (.可视, 假)
#底层.调整层次 ()
获取焦点 ()

.子程序 _其它资料钮_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.标题, “个人简历”)
赋值 (.标题, “● 其他资料”)
赋值 (.标题, “ 其它资料：”)
赋值 (.可视, 假)
赋值 (.可视, 真)
#顶层.调整层次 ()
赋值 (.可视, 假)
#底层.调整层次 ()
获取焦点 ()
赋值 (.起始选择位置, 取文本长度 (.内容))

.子程序 _清除内容钮_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (等于 (.标题, “个人简历：”))
    .如果真 (不等于 (.内容, “”))
        .如果真 (等于 (信息框 (“您确定要清除个人简历的内容吗？”, #确认取消钮, “询问”), #确认钮))
            赋值 (.内容, “”)
            
        .如果真结束
        
    .如果真结束
    
.判断 (等于 (.标题, “ 其它资料：”))
    .如果真 (不等于 (.内容, “”))
        .如果真 (等于 (信息框 (“您确定要清除其他资料的内容吗？”, #确认取消钮, “询问”), #确认钮))
            赋值 (.内容, “”)
        .如果真结束
        
    .如果真结束
    
.默认
    
.判断结束


.子程序 _教员姓名编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _教员性别组合框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _教员民族组合框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _教员出生日期框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _教员学历组合框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _教员政治组合框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _教员参加工作日期框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _教员调入日期框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _教员职称组合框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.如果真结束


.子程序 _教员职务组合框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _身份证编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _教员手机编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _教员家庭住址编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _教员住宅电话编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _教员籍贯编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _教员户籍编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (等于 (.标题, “个人简历：”))
    获取焦点 ()
.判断 (等于 (.标题, “ 其它资料：”))
    获取焦点 ()
.默认
    
.判断结束


.子程序 _保存数据钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.判断 (等于 (键代码, #空格键))
    _保存数据钮_被单击 ()
.默认
    
.判断结束


.子程序 _退出钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
.判断 (等于 (键代码, #空格键))
    _退出钮_被单击 ()
.默认
    
.判断结束


.子程序 _教员名列表框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #回车键), 等于 (键代码, #Tab键)))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
.如果真结束


.子程序 _保存数据钮_被单击, 空白型, , 
.局部变量 资料, 文本型, , , 
.局部变量 图片资料, 字节集, , , 
.局部变量 匿名局部变量_4785, 空白型, , , 
.局部变量 错误, 文本型, , , 
.局部变量 条件, 文本型, , , 

.判断开始 (等于 (., “保存数据”))
    .如果真 (等于 (删全部空 (.内容), “”))
        信息框 (“请输入教员姓名！”, #错误图标, “错误”)
        获取焦点 ()
        返回 ()
    .如果真结束
    .如果真 (等于 (删全部空 (.内容), “”))
        信息框 (“请输入教员身份证！”, #错误图标, “错误”)
        获取焦点 ()
        返回 ()
    .如果真结束
    .如果真 (取数据库重复记录 (连接句柄, “jyda”, “sfz”, .内容))
        信息框 (“被增加的身份证号重复！增加失败！”, #信息图标, “注意身份证号重复！”)
        返回 ()
    .如果真结束
    检查教员输入 ()
    
    赋值 (资料, 相加 (“xm='”, .内容, “',xb='”, .内容, “',mz='”, .内容, “',cssj='”, 时间到文本 (.今天, 2), “',xl='”, .内容, “',zzmm='”, .内容, “',gzsj='”, 时间到文本 (.今天, 2), “',rxsj='”, 时间到文本 (.今天, 2), “',zc='”, .内容, “',zw='”, .内容, “',sfz='”, .内容, “',sj='”, .内容, “',dz='”, .内容, “',dh='”, .内容, “',jg='”, .内容, “',hjdz='”, .内容, “',jbgz='”, .内容, “',fjgz='”, .内容, “',hsbt='”, .内容, “',shbx='”, .内容, “',gzxz='”, .内容, “',gzgw='”, .内容, “',zzlx='在职教员',jl='”, .内容, “',zl='”, .内容, “'”))
    
    赋值 (图片资料, .图片)
    .如果真 (等于 (未知支持库函数_18 (连接句柄, “jyda”, 资料), 假))
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (相加 (“建立记录失败！”, 错误), 0, )
        返回 ()
    .如果真结束
    .如果真 (等于 (删全部空 (.内容), “”))
        信息框 (“请输入教员身份证！”, #错误图标, “错误”)
        获取焦点 ()
        返回 ()
    .如果真结束
    
    .如果 (未知支持库函数_46 (连接句柄, “jyda”, “tp”, 相加 (“sfz='”, .内容, “'”), 图片资料))
        信息框 (“建立记录完成！”, 0, “完成记录！”)
        赋值 (记录日志, 相加 (“增加学生”, .内容, “成功”))
        写日志 ()
        .查找表项 (.内容, , ).选择表项 ()
        .保证显示 (.)
        获取焦点 ()
        赋值 (已修改, 真)
        填充教员名 ()
    .否则
        信息框 (“保存数据失败！”, 0, )
        
    .如果结束
    
.判断 (等于 (., “保存修改”))
    .如果真 (等于 (信息框 (相加 (“您确定要更新”, .内容, “同学的记录信息吗？”), #确认取消钮, “询问”), #取消钮))
        返回 ()
    .如果真结束
    赋值 (资料, 相加 (“xm='”, .内容, “',xb='”, .内容, “',mz='”, .内容, “',cssj='”, 时间到文本 (.今天, 2), “',xl='”, .内容, “',zzmm='”, .内容, “',gzsj='”, 时间到文本 (.今天, 2), “',rxsj='”, 时间到文本 (.今天, 2), “',zc='”, .内容, “',zw='”, .内容, “',sj='”, .内容, “',dz='”, .内容, “',dh='”, .内容, “',jg='”, .内容, “',hjdz='”, .内容, “',jbgz='”, .内容, “',fjgz='”, .内容, “',hsbt='”, .内容, “',shbx='”, .内容, “',gzxz='”, .内容, “',gzgw='”, .内容, “',zzlx='在职教员',jl='”, .内容, “',zl='”, .内容, “'”))
    
    赋值 (条件, 相加 (“sfz='”, .内容, “'”))
    
    .如果真 (等于 (未知支持库函数_19 (连接句柄, “jyda”, 资料, 条件), 假))
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (相加 (“更新数据失败！”, 错误), 0, )
        返回 ()
    .如果真结束
    赋值 (图片资料, .图片)
    
    .如果 (未知支持库函数_46 (连接句柄, “jyda”, “tp”, 条件, 图片资料))
        赋值 (记录日志, 相加 (“更新教员”, .内容, “成功”))
        写日志 ()
        .查找表项 (.内容, , ).选择表项 ()
        .保证显示 (.)
        赋值 (已修改, 真)
        填充教员名 ()
        信息框 (“修改记录完成！”, 0, “完成修改记录！”)
        
    .否则
        信息框 (“更新数据失败！”, 0, )
        返回 ()
        
        
    .如果结束
    
    
.默认
    
.判断结束


.子程序 检查教员输入, 空白型, , 检查教员输入
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “-”)
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “-”)
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “-”)
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “-”)
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “-”)
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “-”)
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “-”)
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “-”)
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “-”)
.如果真结束
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “-”)
.如果真结束


.子程序 _退出钮_被单击, 空白型, , 
资料录入修改教员.销毁 ()

.子程序 _教员资料录入修改窗口_将被销毁, 空白型, , 
.判断开始 (并且 (等于 (_启动窗口..现行子夹, 5), 等于 (已修改, 真)))
    回主界面 ()
.判断 (并且 (等于 (_启动窗口..现行子夹, 6), 等于 (已修改, 真)))
    回主界面 ()
.默认
    
.判断结束


.子程序 _附加钮_被单击, 空白型, , 
.如果 (等于 (附加打开, 假))
    赋值 (附加打开, 真)
    赋值 (.可视, 真)
    2.调整层次 ()
    1.调整层次 ()
    
.否则
    赋值 (附加打开, 假)
    赋值 (.可视, 假)
.如果结束


.窗口程序集 设置科目程序集, , , 

.程序集变量 主副课, 文本型, , "12", 
.程序集变量 主使用时, 整数型, , , 
.程序集变量 副使用时, 整数型, , , 
.子程序 _设置科目窗口_创建完毕, 空白型, , 
未知支持库函数_0 (风格类型)
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
连续赋值 (假, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中)
连续赋值 (“0”, 主副课 [1], 主副课 [2], 主副课 [3], 主副课 [4], 主副课 [5], 主副课 [6], 主副课 [7], 主副课 [8], 主副课 [9], 主副课 [10], 主副课 [11], 主副课 [12], .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
老师程序 ()
赋值 (.现行选中项, 0)
.如果 (填充班级名称 ())
    填充班级名称 ()
    “小学1年级1班”.选择 ()
    “小学1年级1班”.选择 ()
    填充科目 ()
    赋值 (.选中, 假)
    赋值 (.禁止, 假)
    赋值 (.标题, 相加 (“设置修改”, .内容, “的课程科目”))
.否则
    信息框 (“目前没有班级数据，请先进行系统设置!”, 0, “提示”)
    销毁 ()
    _教务设置_被选择 ()
.如果结束


.子程序 老师程序, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 文本变量, 文本型, , , 

.如果真 (等于 (连接句柄, 0))
    信息框 (“没有连接到服务器！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (未知支持库函数_3 (连接句柄, “select xm,zzlx from jyda where zzlx like '%在职教员%' ORDER BY xm ASC;”), 假)) ' 导出教员姓名记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
清空 ()
.计次循环首 (记录数, )
    置等待鼠标 ()
    未知支持库函数_6 (记录集句柄, “xm”, 文本变量)
    .如果 (或者 (等于 (取文本左边 (文本变量, 4), “欧阳”), 等于 (取文本左边 (文本变量, 4), “诸葛”), 等于 (取文本左边 (文本变量, 4), “司马”), 等于 (取文本左边 (文本变量, 4), “上官”), 等于 (取文本左边 (文本变量, 4), “东方”), 等于 (取文本左边 (文本变量, 4), “皇甫”), 等于 (取文本左边 (文本变量, 4), “尉迟”), 等于 (取文本左边 (文本变量, 4), “澹台”), 等于 (取文本左边 (文本变量, 4), “公冶”), 等于 (取文本左边 (文本变量, 4), “濮阳”), 等于 (取文本左边 (文本变量, 4), “淳于”), 等于 (取文本左边 (文本变量, 4), “公孙”), 等于 (取文本左边 (文本变量, 4), “长孙”), 等于 (取文本左边 (文本变量, 4), “慕容”), 等于 (取文本左边 (文本变量, 4), “宇文”), 等于 (取文本左边 (文本变量, 4), “令狐”), 等于 (取文本左边 (文本变量, 4), “司徒”), 等于 (取文本左边 (文本变量, 4), “司空”), 等于 (取文本左边 (文本变量, 4), “轩辕”), 等于 (取文本左边 (文本变量, 4), “徐离”), 等于 (取文本左边 (文本变量, 4), “万俟”), 等于 (取文本左边 (文本变量, 4), “夏侯”), 等于 (取文本左边 (文本变量, 4), “闻人”), 等于 (取文本左边 (文本变量, 4), “赫连”), 等于 (取文本左边 (文本变量, 4), “宗政”), 等于 (取文本左边 (文本变量, 4), “单于”), 等于 (取文本左边 (文本变量, 4), “太叔”), 等于 (取文本左边 (文本变量, 4), “申屠”), 等于 (取文本左边 (文本变量, 4), “公羊”)))
        相加 (取文本左边 (文本变量, 4), “老师”).加入项目 ()
    .否则
        相加 (取文本左边 (文本变量, 2), “老师”).加入项目 ()
    .如果结束
    
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
恢复鼠标 ()


.子程序 填充科目, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 行, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 表项数, 整数型, , , 
.局部变量 班级, 文本型, , , 

赋值 (班级, .内容)
.如果真 (等于 (班级, “”))
    返回 ()
.如果真结束
.如果真 (等于 (连接句柄, 0))
    信息框 (“没有连接到服务器！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select bj,km1,km2,km3,km4,km5,km6,km7,km8,km9,km10,km11,km12,zf1,zf2,zf3,zf4,zf5,zf6,zf7,zf8,zf9,zf10,zf11,zf12,ks1,ks2,ks3,ks4,ks5,ks6,ks7,ks8,ks9,ks10,ks11,ks12,ls1,ls2,ls3,ls4,ls5,ls6,ls7,ls8,ls9,ls10,ls11,ls12,sfjk,kcsj,sw,xw,ws,zk,fk from system where bj like '%”, 班级, “%' ORDER BY bj DESC;”)), 假)) ' 导出记录
    返回 ()
.如果真结束
连续赋值 (假, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中)
连续赋值 (“0”, 主副课 [1], 主副课 [2], 主副课 [3], 主副课 [4], 主副课 [5], 主副课 [6], 主副课 [7], 主副课 [8], 主副课 [9], 主副课 [10], 主副课 [11], 主副课 [12], .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km1”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km2”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km3”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km4”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km5”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km6”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km7”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km8”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km9”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km10”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km11”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “km12”, 文本变量)
赋值 (.内容, 文本变量)

赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “ls1”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “ls2”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “ls3”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “ls4”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “ls5”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “ls6”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “ls7”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “ls8”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “ls9”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “ls10”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “ls11”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “ls12”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “zk”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “fk”, 文本变量)
赋值 (.内容, 文本变量)

未知支持库函数_6 (记录集句柄, “zf1”, 文本变量)
.如果 (或者 (等于 (文本变量, “0”), 等于 (文本变量, “”)))
    赋值 (.选中, 假)
    赋值 (.标题, “副课”)
.否则
    赋值 (.选中, 真)
    赋值 (.标题, “主课”)
.如果结束
未知支持库函数_6 (记录集句柄, “zf2”, 文本变量)
.如果 (或者 (等于 (文本变量, “0”), 等于 (文本变量, “”)))
    赋值 (.选中, 假)
    赋值 (.标题, “副课”)
.否则
    赋值 (.选中, 真)
    赋值 (.标题, “主课”)
.如果结束
未知支持库函数_6 (记录集句柄, “zf3”, 文本变量)
.如果 (或者 (等于 (文本变量, “0”), 等于 (文本变量, “”)))
    赋值 (.选中, 假)
    赋值 (.标题, “副课”)
.否则
    赋值 (.选中, 真)
    赋值 (.标题, “主课”)
.如果结束
未知支持库函数_6 (记录集句柄, “zf4”, 文本变量)
.如果 (或者 (等于 (文本变量, “0”), 等于 (文本变量, “”)))
    赋值 (.选中, 假)
    赋值 (.标题, “副课”)
.否则
    赋值 (.选中, 真)
    赋值 (.标题, “主课”)
.如果结束
未知支持库函数_6 (记录集句柄, “zf5”, 文本变量)
.如果 (或者 (等于 (文本变量, “0”), 等于 (文本变量, “”)))
    赋值 (.选中, 假)
    赋值 (.标题, “副课”)
.否则
    赋值 (.选中, 真)
    赋值 (.标题, “主课”)
.如果结束
未知支持库函数_6 (记录集句柄, “zf6”, 文本变量)
.如果 (或者 (等于 (文本变量, “0”), 等于 (文本变量, “”)))
    赋值 (.选中, 假)
    赋值 (.标题, “副课”)
.否则
    赋值 (.选中, 真)
    赋值 (.标题, “主课”)
.如果结束
未知支持库函数_6 (记录集句柄, “zf7”, 文本变量)
.如果 (或者 (等于 (文本变量, “0”), 等于 (文本变量, “”)))
    赋值 (.选中, 假)
    赋值 (.标题, “副课”)
.否则
    赋值 (.选中, 真)
    赋值 (.标题, “主课”)
.如果结束
未知支持库函数_6 (记录集句柄, “zf8”, 文本变量)
.如果 (或者 (等于 (文本变量, “0”), 等于 (文本变量, “”)))
    赋值 (.选中, 假)
    赋值 (.标题, “副课”)
.否则
    赋值 (.选中, 真)
    赋值 (.标题, “主课”)
.如果结束
未知支持库函数_6 (记录集句柄, “zf9”, 文本变量)
.如果 (或者 (等于 (文本变量, “0”), 等于 (文本变量, “”)))
    赋值 (.选中, 假)
    赋值 (.标题, “副课”)
.否则
    赋值 (.选中, 真)
    赋值 (.标题, “主课”)
.如果结束
未知支持库函数_6 (记录集句柄, “zf10”, 文本变量)
.如果 (或者 (等于 (文本变量, “0”), 等于 (文本变量, “”)))
    赋值 (.选中, 假)
    赋值 (.标题, “副课”)
.否则
    赋值 (.选中, 真)
    赋值 (.标题, “主课”)
.如果结束
未知支持库函数_6 (记录集句柄, “zf11”, 文本变量)
.如果 (或者 (等于 (文本变量, “0”), 等于 (文本变量, “”)))
    赋值 (.选中, 假)
    赋值 (.标题, “副课”)
.否则
    赋值 (.选中, 真)
    赋值 (.标题, “主课”)
.如果结束
未知支持库函数_6 (记录集句柄, “zf12”, 文本变量)
.如果 (或者 (等于 (文本变量, “0”), 等于 (文本变量, “”)))
    赋值 (.选中, 假)
    赋值 (.标题, “副课”)
.否则
    赋值 (.选中, 真)
    赋值 (.标题, “主课”)
.如果结束

赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “ks1”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “ks2”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “ks3”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “ks4”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “ks5”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “ks6”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “ks7”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “ks8”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “ks9”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “ks10”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “ks11”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “ks12”, 文本变量)
赋值 (.内容, 文本变量)

未知支持库函数_6 (记录集句柄, “kcsj”, 文本变量)
.判断开始 (或者 (等于 (文本变量, “5”), 等于 (文本变量, “”)))
    赋值 (.选中, 真)
    连续赋值 (假, .选中, .选中, .选中)
.判断 (等于 (文本变量, “5.5”))
    赋值 (.选中, 真)
    连续赋值 (假, .选中, .选中, .选中)
.判断 (等于 (文本变量, “6”))
    赋值 (.选中, 真)
    连续赋值 (假, .选中, .选中, .选中)
.判断 (等于 (文本变量, “7”))
    赋值 (.选中, 真)
    连续赋值 (假, .选中, .选中, .选中)
.默认
    
.判断结束
未知支持库函数_6 (记录集句柄, “sfjk”, 文本变量)
.如果 (或者 (等于 (文本变量, “0”), 等于 (文本变量, “”)))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
未知支持库函数_6 (记录集句柄, “sw”, 文本变量)
.如果 (等于 (文本变量, “”))
    赋值 (.内容, “4”)
.否则
    赋值 (.内容, 文本变量)
.如果结束
未知支持库函数_6 (记录集句柄, “xw”, 文本变量)
.如果 (等于 (文本变量, “”))
    赋值 (.内容, “2”)
.否则
    赋值 (.内容, 文本变量)
.如果结束
未知支持库函数_6 (记录集句柄, “ws”, 文本变量)
.如果 (等于 (文本变量, “”))
    赋值 (.内容, “2”)
.否则
    赋值 (.内容, 文本变量)
.如果结束
未知支持库函数_5 (记录集句柄)
恢复鼠标 ()

获取焦点 ()
赋值 (.被选择字符数, -1)


.子程序 _科目班级名组合框_列表项被选择, 空白型, , 
赋值 (.标题, 相加 (“设置修改”, .内容, “的课程科目”))
赋值 (.标题, 相加 (“老师来带”, .内容, “课程。”))
连续赋值 (“0”, 主副课 [1], 主副课 [2], 主副课 [3], 主副课 [4], 主副课 [5], 主副课 [6], 主副课 [7], 主副课 [8], 主副课 [9], 主副课 [10], 主副课 [11], 主副课 [12], .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
连续赋值 (假, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中)
填充科目 ()

.子程序 _选择框1_被单击, 空白型, , 
.如果 (.选中)
    赋值 (.禁止, 真)
    赋值 (.禁止, 假)
    赋值 (.禁止, 真)
    赋值 (.禁止, 假)
    赋值 (.标题, 相加 (“设置修改”, .内容, “的课程科目与左边年级科目统一”))
.否则
    赋值 (.禁止, 假)
    赋值 (.禁止, 真)
    赋值 (.禁止, 假)
    赋值 (.禁止, 真)
    赋值 (.标题, 相加 (“设置修改”, .内容, “的课程科目”))
.如果结束


.子程序 _保存按钮_被单击, 空白型, , 保存
.局部变量 资料, 文本型, , , 
.局部变量 条件A, 文本型, , , 
.局部变量 条件B, 文本型, , , 
.局部变量 加课, 文本型, , , 
.局部变量 时间类型, 文本型, , , 

选择刷新程序 ()
.判断开始 (.选中)
    赋值 (时间类型, “5”)
.判断 (.选中)
    赋值 (时间类型, “5.5”)
.判断 (.选中)
    赋值 (时间类型, “6”)
.判断 (.选中)
    赋值 (时间类型, “7”)
.默认
    
.判断结束
.如果 (.选中)
    赋值 (加课, “1”)
.否则
    赋值 (加课, “0”)
    
.如果结束
赋值 (资料, 相加 (“km1='”, .内容, “',km2='”, .内容, “',km3='”, .内容, “',km4='”, .内容, “',km5='”, .内容, “',km6='”, .内容, “',km7='”, .内容, “',km8='”, .内容, “',km9='”, .内容, “',km10='”, .内容, “',km11='”, .内容, “',km12='”, .内容, “',zf1='”, 主副课 [1], “',zf2='”, 主副课 [2], “',zf3='”, 主副课 [3], “',zf4='”, 主副课 [4], “',zf5='”, 主副课 [5], “',zf6='”, 主副课 [6], “',zf7='”, 主副课 [7], “',zf8='”, 主副课 [8], “',zf9='”, 主副课 [9], “',zf10='”, 主副课 [10], “',zf11='”, 主副课 [11], “',zf12='”, 主副课 [12], “',ks1='”, .内容, “',ks2='”, .内容, “',ks3='”, .内容, “',ks4='”, .内容, “',ks5='”, .内容, “',ks6='”, .内容, “',ks7='”, .内容, “',ks8='”, .内容, “',ks9='”, .内容, “',ks10='”, .内容, “',ks11='”, .内容, “',ks12='”, .内容, “',ls1='”, .内容, “',ls2='”, .内容, “',ls3='”, .内容, “',ls4='”, .内容, “',ls5='”, .内容, “',ls6='”, .内容, “',ls7='”, .内容, “',ls8='”, .内容, “',ls9='”, .内容, “',ls10='”, .内容, “',ls11='”, .内容, “',ls12='”, .内容, “',kcsj='”, 时间类型, “',sfjk='”, 加课, “',sw='”, .内容, “',xw='”, .内容, “',ws='”, .内容, “',zk='”, .内容, “',fk='”, .内容, “'”))
.如果真 (等于 (.内容, “”))
    信息框 (“没有选择班级！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (条件A, 相加 (“bj='”, .内容, “'”))
.如果真 (等于 (信息框 (“当前的课程科目将修改本班级科目！是否继续操作？”, #确认取消钮, “是否确认？”), #取消钮))
    返回 ()
.如果真结束
.如果 (未知支持库函数_19 (连接句柄, “system”, 资料, 条件A))
    信息框 (相加 (.内容, “的课程科目数据已保存！”), 0, )
.否则
    信息框 (“设置修改科目失败！”, 0, “错误”)
.如果结束




.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _科目编辑框2_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _科目编辑框3_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _科目编辑框4_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _科目编辑框5_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _科目编辑框6_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _科目编辑框7_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _科目编辑框8_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _科目编辑框9_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _科目编辑框10_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _设置科目窗口_将被销毁, 空白型, , 
.如果真 (等于 (_启动窗口..现行子夹, 4))
    _启动窗口.获取焦点 (.)
.如果真结束


.子程序 _选择1_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.标题, “主课”)
    赋值 (主副课 [1], “1”)
.否则
    赋值 (.标题, “副课”)
    赋值 (主副课 [1], “0”)
    
.如果结束


.子程序 选择刷新程序, 空白型, , 
_选择1_被单击 ()
_选择2_被单击 ()
_选择3_被单击 ()
_选择4_被单击 ()
_选择5_被单击 ()
_选择6_被单击 ()
_选择7_被单击 ()
_选择8_被单击 ()
_选择9_被单击 ()
_选择10_被单击 ()
_选择11_被单击 ()
_选择12_被单击 ()

.子程序 _选择2_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.标题, “主课”)
    赋值 (主副课 [2], “1”)
.否则
    赋值 (.标题, “副课”)
    赋值 (主副课 [2], “0”)
    
.如果结束


.子程序 _选择3_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.标题, “主课”)
    赋值 (主副课 [3], “1”)
.否则
    赋值 (.标题, “副课”)
    赋值 (主副课 [3], “0”)
    
.如果结束


.子程序 _选择4_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.标题, “主课”)
    赋值 (主副课 [4], “1”)
.否则
    赋值 (.标题, “副课”)
    赋值 (主副课 [4], “0”)
    
.如果结束


.子程序 _选择5_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.标题, “主课”)
    赋值 (主副课 [5], “1”)
.否则
    赋值 (.标题, “副课”)
    赋值 (主副课 [5], “0”)
    
.如果结束


.子程序 _选择6_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.标题, “主课”)
    赋值 (主副课 [6], “1”)
.否则
    赋值 (.标题, “副课”)
    赋值 (主副课 [6], “0”)
    
.如果结束


.子程序 _选择7_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.标题, “主课”)
    赋值 (主副课 [7], “1”)
.否则
    赋值 (.标题, “副课”)
    赋值 (主副课 [7], “0”)
    
.如果结束


.子程序 _选择8_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.标题, “主课”)
    赋值 (主副课 [8], “1”)
.否则
    赋值 (.标题, “副课”)
    赋值 (主副课 [8], “0”)
    
.如果结束


.子程序 _选择9_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.标题, “主课”)
    赋值 (主副课 [9], “1”)
.否则
    赋值 (.标题, “副课”)
    赋值 (主副课 [9], “0”)
    
.如果结束


.子程序 _选择10_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.标题, “主课”)
    赋值 (主副课 [10], “1”)
.否则
    赋值 (.标题, “副课”)
    赋值 (主副课 [10], “0”)
    
.如果结束


.子程序 _选择11_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.标题, “主课”)
    赋值 (主副课 [11], “1”)
.否则
    赋值 (.标题, “副课”)
    赋值 (主副课 [11], “0”)
    
.如果结束


.子程序 _选择12_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.标题, “主课”)
    赋值 (主副课 [12], “1”)
.否则
    赋值 (.标题, “副课”)
    赋值 (主副课 [12], “0”)
    
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 资料, 文本型, , , 
.局部变量 条件A, 文本型, , , 
.局部变量 条件B, 文本型, , , 
.局部变量 加课, 文本型, , , 
.局部变量 时间类型, 文本型, , , 

选择刷新程序 ()
.判断开始 (.选中)
    赋值 (时间类型, “5”)
.判断 (.选中)
    赋值 (时间类型, “5.5”)
.判断 (.选中)
    赋值 (时间类型, “6”)
.判断 (.选中)
    赋值 (时间类型, “7”)
.默认
    
.判断结束
.如果 (.选中)
    赋值 (加课, “1”)
.否则
    赋值 (加课, “0”)
.如果结束

赋值 (资料, 相加 (“km1='”, .内容, “',km2='”, .内容, “',km3='”, .内容, “',km4='”, .内容, “',km5='”, .内容, “',km6='”, .内容, “',km7='”, .内容, “',km8='”, .内容, “',km9='”, .内容, “',km10='”, .内容, “',km11='”, .内容, “',km12='”, .内容, “',zf1='”, 主副课 [1], “',zf2='”, 主副课 [2], “',zf3='”, 主副课 [3], “',zf4='”, 主副课 [4], “',zf5='”, 主副课 [5], “',zf6='”, 主副课 [6], “',zf7='”, 主副课 [7], “',zf8='”, 主副课 [8], “',zf9='”, 主副课 [9], “',zf10='”, 主副课 [10], “',zf11='”, 主副课 [11], “',zf12='”, 主副课 [12], “',ks1='”, .内容, “',ks2='”, .内容, “',ks3='”, .内容, “',ks4='”, .内容, “',ks5='”, .内容, “',ks6='”, .内容, “',ks7='”, .内容, “',ks8='”, .内容, “',ks9='”, .内容, “',ks10='”, .内容, “',ks11='”, .内容, “',ks12='”, .内容, “',ls1='”, .内容, “',ls2='”, .内容, “',ls3='”, .内容, “',ls4='”, .内容, “',ls5='”, .内容, “',ls6='”, .内容, “',ls7='”, .内容, “',ls8='”, .内容, “',ls9='”, .内容, “',ls10='”, .内容, “',ls11='”, .内容, “',ls12='”, .内容, “',kcsj='”, 时间类型, “',sfjk='”, 加课, “',sw='”, .内容, “',xw='”, .内容, “',ws='”, .内容, “',zk='”, .内容, “',fk='”, .内容, “'”))
.如果真 (等于 (.内容, “”))
    信息框 (“没有选择需要统一的班级！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (条件A, 相加 (“bj='”, .内容, “'”))
.如果真 (等于 (信息框 (“当前的课程科目将与左边班级科目统一！是否继续操作？”, #确认取消钮, “是否确认？”), #取消钮))
    返回 ()
.如果真结束
.如果 (未知支持库函数_19 (连接句柄, “system”, 资料, 条件A))
    信息框 (相加 (.内容, “的课程科目数据已保存！”), 0, )
.否则
    信息框 (“设置修改科目失败！”, 0, “错误”)
.如果结束



.子程序 _时钟1_周期事件, 空白型, , 
.如果 (等于 (.文本颜色, #深青))
    赋值 (.背景颜色, #浅灰)
    赋值 (.文本颜色, #蓝灰)
.否则
    赋值 (.背景颜色, #浅灰)
    赋值 (.文本颜色, #深青)
    
.如果结束



.子程序 _主课编辑框_内容被改变, 空白型, , 
.如果真 (大于 (相加 (到数值 (.内容), 到数值 (.内容)), 到数值 (.内容)))
    信息框 (相加 (“    抱歉！您输入的课时已经超过了总课时！最大课时只有”, 到文本 (相减 (到数值 (.内容), 到数值 (.内容))), “节，请重新再来！”), #信息图标, “提示！”)
    赋值 (.内容, “0”)
    获取焦点 ()
.如果真结束
赋值 (.最大位置, 到数值 (.内容))
赋值 (.位置, 到数值 (.内容))
赋值 (.内容, 相加 (到文本 (四舍五入 (相乘 (相除 (到数值 (.内容), 到数值 (.内容)), 100), 0)), “%”))

.子程序 _副课编辑框_内容被改变, 空白型, , 
.如果真 (大于 (相加 (到数值 (.内容), 到数值 (.内容)), 到数值 (.内容)))
    信息框 (相加 (“    抱歉！您输入的课时已经超过了总课时！最大课时只有”, 到文本 (相减 (到数值 (.内容), 到数值 (.内容))), “节，请重新再来！”), #信息图标, “提示！”)
    赋值 (.内容, “0”)
    获取焦点 ()
.如果真结束
赋值 (.最大位置, 到数值 (.内容))
赋值 (.位置, 到数值 (.内容))
赋值 (.内容, 相加 (到文本 (四舍五入 (相乘 (相除 (到数值 (.内容), 到数值 (.内容)), 100), 0)), “%”))

.子程序 统计课时, 空白型, , 
赋值 (主使用时, 0)
赋值 (副使用时, 0)
.如果 (等于 (.选中, 真))
    赋值 (主使用时, 相加 (主使用时, 到数值 (.内容)))
.否则
    赋值 (副使用时, 相加 (副使用时, 到数值 (.内容)))
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (主使用时, 相加 (主使用时, 到数值 (.内容)))
.否则
    赋值 (副使用时, 相加 (副使用时, 到数值 (.内容)))
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (主使用时, 相加 (主使用时, 到数值 (.内容)))
.否则
    赋值 (副使用时, 相加 (副使用时, 到数值 (.内容)))
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (主使用时, 相加 (主使用时, 到数值 (.内容)))
.否则
    赋值 (副使用时, 相加 (副使用时, 到数值 (.内容)))
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (主使用时, 相加 (主使用时, 到数值 (.内容)))
.否则
    赋值 (副使用时, 相加 (副使用时, 到数值 (.内容)))
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (主使用时, 相加 (主使用时, 到数值 (.内容)))
.否则
    赋值 (副使用时, 相加 (副使用时, 到数值 (.内容)))
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (主使用时, 相加 (主使用时, 到数值 (.内容)))
.否则
    赋值 (副使用时, 相加 (副使用时, 到数值 (.内容)))
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (主使用时, 相加 (主使用时, 到数值 (.内容)))
.否则
    赋值 (副使用时, 相加 (副使用时, 到数值 (.内容)))
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (主使用时, 相加 (主使用时, 到数值 (.内容)))
.否则
    赋值 (副使用时, 相加 (副使用时, 到数值 (.内容)))
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (主使用时, 相加 (主使用时, 到数值 (.内容)))
.否则
    赋值 (副使用时, 相加 (副使用时, 到数值 (.内容)))
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (主使用时, 相加 (主使用时, 到数值 (.内容)))
.否则
    赋值 (副使用时, 相加 (副使用时, 到数值 (.内容)))
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (主使用时, 相加 (主使用时, 到数值 (.内容)))
.否则
    赋值 (副使用时, 相加 (副使用时, 到数值 (.内容)))
.如果结束


.子程序 _课时1_内容被改变, 空白型, , 
统计课时 ()
.如果 (.选中)
    .如果真 (大于 (主使用时, 到数值 (.内容)))
        信息框 (“    抱歉！您输入的课时已经超过了主课时！请重新再来！”, #信息图标, “提示！”)
        赋值 (.内容, “ 0”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (.最大位置, 到数值 (.内容))
    赋值 (.位置, 相减 (到数值 (.内容), 主使用时))
    赋值 (.内容, 相加 (到文本 (相减 (100, 四舍五入 (相乘 (相除 (主使用时, 到数值 (.内容)), 100), 0))), “%”))
.否则
    .如果真 (大于 (副使用时, 到数值 (.内容)))
        信息框 (“    抱歉！您输入的课时已经超过了副课时！请重新再来！”, #信息图标, “提示！”)
        赋值 (.内容, “0”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (.最大位置, 到数值 (.内容))
    赋值 (.位置, 相减 (到数值 (.内容), 副使用时))
    赋值 (.内容, 相加 (到文本 (相减 (100, 四舍五入 (相乘 (相除 (副使用时, 到数值 (.内容)), 100), 0))), “%”))
.如果结束


.子程序 _课时2_内容被改变, 空白型, , 
统计课时 ()
.如果 (等于 (.选中, 真))
    .如果真 (大于 (主使用时, 到数值 (.内容)))
        信息框 (“    抱歉！您输入的课时已经超过了主课时！请重新再来！”, #信息图标, “提示！”)
        赋值 (.内容, “0”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (.最大位置, 到数值 (.内容))
    赋值 (.位置, 相减 (到数值 (.内容), 主使用时))
    赋值 (.内容, 相加 (到文本 (相减 (100, 四舍五入 (相乘 (相除 (主使用时, 到数值 (.内容)), 100), 0))), “%”))
.否则
    .如果真 (大于 (副使用时, 到数值 (.内容)))
        信息框 (“    抱歉！您输入的课时已经超过了副课时！请重新再来！”, #信息图标, “提示！”)
        赋值 (.内容, “0”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (.最大位置, 到数值 (.内容))
    赋值 (.位置, 相减 (到数值 (.内容), 副使用时))
    赋值 (.内容, 相加 (到文本 (相减 (100, 四舍五入 (相乘 (相除 (副使用时, 到数值 (.内容)), 100), 0))), “%”))
    
.如果结束


.子程序 _课时3_内容被改变, 空白型, , 
统计课时 ()
.如果 (.选中)
    .如果真 (大于 (主使用时, 到数值 (.内容)))
        信息框 (“    抱歉！您输入的课时已经超过了主课时！请重新再来！”, #信息图标, “提示！”)
        赋值 (.内容, “ 0”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (.最大位置, 到数值 (.内容))
    赋值 (.位置, 相减 (到数值 (.内容), 主使用时))
    赋值 (.内容, 相加 (到文本 (相减 (100, 四舍五入 (相乘 (相除 (主使用时, 到数值 (.内容)), 100), 0))), “%”))
    
.否则
    .如果真 (大于 (副使用时, 到数值 (.内容)))
        信息框 (“    抱歉！您输入的课时已经超过了副课时！请重新再来！”, #信息图标, “提示！”)
        赋值 (.内容, “0”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (.最大位置, 到数值 (.内容))
    赋值 (.位置, 相减 (到数值 (.内容), 副使用时))
    赋值 (.内容, 相加 (到文本 (相减 (100, 四舍五入 (相乘 (相除 (副使用时, 到数值 (.内容)), 100), 0))), “%”))
    
.如果结束


.子程序 _课时4_内容被改变, 空白型, , 
统计课时 ()
.如果 (.选中)
    .如果真 (大于 (主使用时, 到数值 (.内容)))
        信息框 (“    抱歉！您输入的课时已经超过了主课时！请重新再来！”, #信息图标, “提示！”)
        赋值 (.内容, “ 0”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (.最大位置, 到数值 (.内容))
    赋值 (.位置, 相减 (到数值 (.内容), 主使用时))
    赋值 (.内容, 相加 (到文本 (相减 (100, 四舍五入 (相乘 (相除 (主使用时, 到数值 (.内容)), 100), 0))), “%”))
    
.否则
    .如果真 (大于 (副使用时, 到数值 (.内容)))
        信息框 (“    抱歉！您输入的课时已经超过了副课时！请重新再来！”, #信息图标, “提示！”)
        赋值 (.内容, “0”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (.最大位置, 到数值 (.内容))
    赋值 (.位置, 相减 (到数值 (.内容), 副使用时))
    赋值 (.内容, 相加 (到文本 (相减 (100, 四舍五入 (相乘 (相除 (副使用时, 到数值 (.内容)), 100), 0))), “%”))
    
.如果结束


.子程序 _课时5_内容被改变, 空白型, , 
统计课时 ()
.如果 (.选中)
    .如果真 (大于 (主使用时, 到数值 (.内容)))
        信息框 (“    抱歉！您输入的课时已经超过了主课时！请重新再来！”, #信息图标, “提示！”)
        赋值 (.内容, “ 0”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (.最大位置, 到数值 (.内容))
    赋值 (.位置, 相减 (到数值 (.内容), 主使用时))
    赋值 (.内容, 相加 (到文本 (相减 (100, 四舍五入 (相乘 (相除 (主使用时, 到数值 (.内容)), 100), 0))), “%”))
    
.否则
    .如果真 (大于 (副使用时, 到数值 (.内容)))
        信息框 (“    抱歉！您输入的课时已经超过了副课时！请重新再来！”, #信息图标, “提示！”)
        赋值 (.内容, “0”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (.最大位置, 到数值 (.内容))
    赋值 (.位置, 相减 (到数值 (.内容), 副使用时))
    赋值 (.内容, 相加 (到文本 (相减 (100, 四舍五入 (相乘 (相除 (副使用时, 到数值 (.内容)), 100), 0))), “%”))
    
.如果结束


.子程序 _课时6_内容被改变, 空白型, , 
统计课时 ()
.如果 (.选中)
    .如果真 (大于 (主使用时, 到数值 (.内容)))
        信息框 (“    抱歉！您输入的课时已经超过了主课时！请重新再来！”, #信息图标, “提示！”)
        赋值 (.内容, “ 0”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (.最大位置, 到数值 (.内容))
    赋值 (.位置, 相减 (到数值 (.内容), 主使用时))
    赋值 (.内容, 相加 (到文本 (相减 (100, 四舍五入 (相乘 (相除 (主使用时, 到数值 (.内容)), 100), 0))), “%”))
    
.否则
    .如果真 (大于 (副使用时, 到数值 (.内容)))
        信息框 (“    抱歉！您输入的课时已经超过了副课时！请重新再来！”, #信息图标, “提示！”)
        赋值 (.内容, “0”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (.最大位置, 到数值 (.内容))
    赋值 (.位置, 相减 (到数值 (.内容), 副使用时))
    赋值 (.内容, 相加 (到文本 (相减 (100, 四舍五入 (相乘 (相除 (副使用时, 到数值 (.内容)), 100), 0))), “%”))
    
.如果结束


.子程序 _课时7_内容被改变, 空白型, , 
统计课时 ()
.如果 (.选中)
    .如果真 (大于 (主使用时, 到数值 (.内容)))
        信息框 (“    抱歉！您输入的课时已经超过了主课时！请重新再来！”, #信息图标, “提示！”)
        赋值 (.内容, “ 0”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (.最大位置, 到数值 (.内容))
    赋值 (.位置, 相减 (到数值 (.内容), 主使用时))
    赋值 (.内容, 相加 (到文本 (相减 (100, 四舍五入 (相乘 (相除 (主使用时, 到数值 (.内容)), 100), 0))), “%”))
    
.否则
    .如果真 (大于 (副使用时, 到数值 (.内容)))
        信息框 (“    抱歉！您输入的课时已经超过了副课时！请重新再来！”, #信息图标, “提示！”)
        赋值 (.内容, “0”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (.最大位置, 到数值 (.内容))
    赋值 (.位置, 相减 (到数值 (.内容), 副使用时))
    赋值 (.内容, 相加 (到文本 (相减 (100, 四舍五入 (相乘 (相除 (副使用时, 到数值 (.内容)), 100), 0))), “%”))
    
.如果结束


.子程序 _课时8_内容被改变, 空白型, , 
统计课时 ()
.如果 (.选中)
    .如果真 (大于 (主使用时, 到数值 (.内容)))
        信息框 (“    抱歉！您输入的课时已经超过了主课时！请重新再来！”, #信息图标, “提示！”)
        赋值 (.内容, “ 0”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (.最大位置, 到数值 (.内容))
    赋值 (.位置, 相减 (到数值 (.内容), 主使用时))
    赋值 (.内容, 相加 (到文本 (相减 (100, 四舍五入 (相乘 (相除 (主使用时, 到数值 (.内容)), 100), 0))), “%”))
    
.否则
    .如果真 (大于 (副使用时, 到数值 (.内容)))
        信息框 (“    抱歉！您输入的课时已经超过了副课时！请重新再来！”, #信息图标, “提示！”)
        赋值 (.内容, “0”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (.最大位置, 到数值 (.内容))
    赋值 (.位置, 相减 (到数值 (.内容), 副使用时))
    赋值 (.内容, 相加 (到文本 (相减 (100, 四舍五入 (相乘 (相除 (副使用时, 到数值 (.内容)), 100), 0))), “%”))
    
.如果结束


.子程序 _课时9_内容被改变, 空白型, , 
统计课时 ()
.如果 (.选中)
    .如果真 (大于 (主使用时, 到数值 (.内容)))
        信息框 (“    抱歉！您输入的课时已经超过了主课时！请重新再来！”, #信息图标, “提示！”)
        赋值 (.内容, “ 0”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (.最大位置, 到数值 (.内容))
    赋值 (.位置, 相减 (到数值 (.内容), 主使用时))
    赋值 (.内容, 相加 (到文本 (相减 (100, 四舍五入 (相乘 (相除 (主使用时, 到数值 (.内容)), 100), 0))), “%”))
    
.否则
    .如果真 (大于 (副使用时, 到数值 (.内容)))
        信息框 (“    抱歉！您输入的课时已经超过了副课时！请重新再来！”, #信息图标, “提示！”)
        赋值 (.内容, “0”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (.最大位置, 到数值 (.内容))
    赋值 (.位置, 相减 (到数值 (.内容), 副使用时))
    赋值 (.内容, 相加 (到文本 (相减 (100, 四舍五入 (相乘 (相除 (副使用时, 到数值 (.内容)), 100), 0))), “%”))
    
.如果结束


.子程序 _课时10_内容被改变, 空白型, , 
统计课时 ()
.如果 (.选中)
    .如果真 (大于 (主使用时, 到数值 (.内容)))
        信息框 (“    抱歉！您输入的课时已经超过了主课时！请重新再来！”, #信息图标, “提示！”)
        赋值 (.内容, “ 0”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (.最大位置, 到数值 (.内容))
    赋值 (.位置, 相减 (到数值 (.内容), 主使用时))
    赋值 (.内容, 相加 (到文本 (相减 (100, 四舍五入 (相乘 (相除 (主使用时, 到数值 (.内容)), 100), 0))), “%”))
    
.否则
    .如果真 (大于 (副使用时, 到数值 (.内容)))
        信息框 (“    抱歉！您输入的课时已经超过了副课时！请重新再来！”, #信息图标, “提示！”)
        赋值 (.内容, “0”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (.最大位置, 到数值 (.内容))
    赋值 (.位置, 相减 (到数值 (.内容), 副使用时))
    赋值 (.内容, 相加 (到文本 (相减 (100, 四舍五入 (相乘 (相除 (副使用时, 到数值 (.内容)), 100), 0))), “%”))
    
.如果结束


.子程序 _课时11_内容被改变, 空白型, , 
统计课时 ()
.如果 (.选中)
    .如果真 (大于 (主使用时, 到数值 (.内容)))
        信息框 (“    抱歉！您输入的课时已经超过了主课时！请重新再来！”, #信息图标, “提示！”)
        赋值 (.内容, “ 0”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (.最大位置, 到数值 (.内容))
    赋值 (.位置, 相减 (到数值 (.内容), 主使用时))
    赋值 (.内容, 相加 (到文本 (相减 (100, 四舍五入 (相乘 (相除 (主使用时, 到数值 (.内容)), 100), 0))), “%”))
    
.否则
    .如果真 (大于 (副使用时, 到数值 (.内容)))
        信息框 (“    抱歉！您输入的课时已经超过了副课时！请重新再来！”, #信息图标, “提示！”)
        赋值 (.内容, “0”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (.最大位置, 到数值 (.内容))
    赋值 (.位置, 相减 (到数值 (.内容), 副使用时))
    赋值 (.内容, 相加 (到文本 (相减 (100, 四舍五入 (相乘 (相除 (副使用时, 到数值 (.内容)), 100), 0))), “%”))
    
.如果结束


.子程序 _课时12_内容被改变, 空白型, , 
统计课时 ()
.如果 (.选中)
    .如果真 (大于 (主使用时, 到数值 (.内容)))
        信息框 (“    抱歉！您输入的课时已经超过了主课时！请重新再来！”, #信息图标, “提示！”)
        赋值 (.内容, “ 0”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (.最大位置, 到数值 (.内容))
    赋值 (.位置, 相减 (到数值 (.内容), 主使用时))
    赋值 (.内容, 相加 (到文本 (相减 (100, 四舍五入 (相乘 (相除 (主使用时, 到数值 (.内容)), 100), 0))), “%”))
    
.否则
    .如果真 (大于 (副使用时, 到数值 (.内容)))
        信息框 (“    抱歉！您输入的课时已经超过了副课时！请重新再来！”, #信息图标, “提示！”)
        赋值 (.内容, “0”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (.最大位置, 到数值 (.内容))
    赋值 (.位置, 相减 (到数值 (.内容), 副使用时))
    赋值 (.内容, 相加 (到文本 (相减 (100, 四舍五入 (相乘 (相除 (副使用时, 到数值 (.内容)), 100), 0))), “%”))
    
.如果结束


.子程序 _老师1_获得焦点, 空白型, , 
连续赋值 (16762052, .背景颜色, .背景颜色, .背景颜色)
连续赋值 (#白色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
.选择 (.内容)


.子程序 _老师2_获得焦点, 空白型, , 
连续赋值 (16762052, .背景颜色, .背景颜色, .背景颜色)
连续赋值 (#白色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
.选择 (.内容)


.子程序 _老师3_获得焦点, 空白型, , 
连续赋值 (16762052, .背景颜色, .背景颜色, .背景颜色)
连续赋值 (#白色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
.选择 (.内容)

.子程序 _老师4_获得焦点, 空白型, , 
连续赋值 (16762052, .背景颜色, .背景颜色, .背景颜色)
.选择 (.内容)
连续赋值 (#白色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)

.子程序 _老师5_获得焦点, 空白型, , 
连续赋值 (16762052, .背景颜色, .背景颜色, .背景颜色)
.选择 (.内容)
连续赋值 (#白色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)

.子程序 _老师6_获得焦点, 空白型, , 
连续赋值 (16762052, .背景颜色, .背景颜色, .背景颜色)
.选择 (.内容)
连续赋值 (#白色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)

.子程序 _老师7_获得焦点, 空白型, , 
连续赋值 (16762052, .背景颜色, .背景颜色, .背景颜色)
.选择 (.内容)
连续赋值 (#白色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)

.子程序 _老师8_获得焦点, 空白型, , 
连续赋值 (16762052, .背景颜色, .背景颜色, .背景颜色)
.选择 (.内容)
连续赋值 (#白色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)

.子程序 _老师9_获得焦点, 空白型, , 
连续赋值 (16762052, .背景颜色, .背景颜色, .背景颜色)
.选择 (.内容)
连续赋值 (#白色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)

.子程序 _老师10_获得焦点, 空白型, , 
连续赋值 (16762052, .背景颜色, .背景颜色, .背景颜色)
.选择 (.内容)
连续赋值 (#白色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)

.子程序 _老师11_获得焦点, 空白型, , 
连续赋值 (16762052, .背景颜色, .背景颜色, .背景颜色)
.选择 (.内容)
连续赋值 (#白色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)

.子程序 _老师12_获得焦点, 空白型, , 
连续赋值 (16762052, .背景颜色, .背景颜色, .背景颜色)
.选择 (.内容)
连续赋值 (#白色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)

.子程序 _老师组合框_列表项被选择, 空白型, , 
.判断开始 (等于 (.背景颜色, 16762052))
    赋值 (.内容, .内容)
.判断 (等于 (.背景颜色, 16762052))
    赋值 (.内容, .内容)
.判断 (等于 (.背景颜色, 16762052))
    赋值 (.内容, .内容)
.判断 (等于 (.背景颜色, 16762052))
    赋值 (.内容, .内容)
.判断 (等于 (.背景颜色, 16762052))
    赋值 (.内容, .内容)
.判断 (等于 (.背景颜色, 16762052))
    赋值 (.内容, .内容)
.判断 (等于 (.背景颜色, 16762052))
    赋值 (.内容, .内容)
.判断 (等于 (.背景颜色, 16762052))
    赋值 (.内容, .内容)
.判断 (等于 (.背景颜色, 16762052))
    赋值 (.内容, .内容)
.判断 (等于 (.背景颜色, 16762052))
    赋值 (.内容, .内容)
.判断 (等于 (.背景颜色, 16762052))
    赋值 (.内容, .内容)
.判断 (等于 (.背景颜色, 16762052))
    赋值 (.内容, .内容)
.默认
    
.判断结束


.子程序 _加课选择_被单击, 空白型, , 
.如果 (.选中)
    赋值 (.文本颜色, #黑色)
    赋值 (.文本颜色, #黑色)
    赋值 (.禁止, 假)
.否则
    赋值 (.文本颜色, #浅灰)
    赋值 (.文本颜色, #浅灰)
    赋值 (.禁止, 真)
    
.如果结束
课计算程序 ()

.子程序 _单选框1_被单击, 空白型, , 
课计算程序 ()

.子程序 _单选框2_被单击, 空白型, , 
课计算程序 ()

.子程序 _单选框3_被单击, 空白型, , 
课计算程序 ()

.子程序 _单选框4_被单击, 空白型, , 
课计算程序 ()

.子程序 课计算程序, 空白型, , 
.判断开始 (.选中)
    .如果 (.选中)
        赋值 (.内容, 到文本 (相乘 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容)), 5)))
    .否则
        赋值 (.内容, 到文本 (相乘 (相加 (到数值 (.内容), 到数值 (.内容)), 5)))
    .如果结束
    
.判断 (.选中)
    .如果 (.选中)
        赋值 (.内容, 到文本 (相乘 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容)), 6)))
    .否则
        赋值 (.内容, 到文本 (相乘 (相加 (到数值 (.内容), 到数值 (.内容)), 6)))
    .如果结束
    
    
.判断 (.选中)
    .如果 (.选中)
        赋值 (.内容, 到文本 (相加 (相乘 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容)), 5), 4)))
    .否则
        赋值 (.内容, 到文本 (相加 (相乘 (相加 (到数值 (.内容), 到数值 (.内容)), 5), 4)))
    .如果结束
    
    
.判断 (.选中)
    .如果 (.选中)
        赋值 (.内容, 到文本 (相乘 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容)), 7)))
    .否则
        赋值 (.内容, 到文本 (相乘 (相加 (到数值 (.内容), 到数值 (.内容)), 7)))
    .如果结束
    
    
.默认
    
.判断结束
统计课时 ()

.子程序 _上午_内容被改变, 空白型, , 
课计算程序 ()

.子程序 _下午_内容被改变, 空白型, , 
课计算程序 ()

.子程序 _晚上_内容被改变, 空白型, , 
课计算程序 ()

.子程序 _按钮2_被单击, 空白型, , 
.如果真 (等于 (是否已创建 (自动排课窗口), 假))
    载入 (自动排课窗口, , 假)
.如果真结束
赋值 (自动排课窗口., .内容)
自动排课窗口.生成空课程表 ()
销毁 ()

.子程序 _课时1_获得焦点, 空白型, , 
连续赋值 (16762052, .背景颜色, .背景颜色, .背景颜色)
连续赋值 (#白色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)

.子程序 _课时2_获得焦点, 空白型, , 
连续赋值 (16762052, .背景颜色, .背景颜色, .背景颜色)
连续赋值 (#白色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)

.子程序 _课时3_获得焦点, 空白型, , 
连续赋值 (16762052, .背景颜色, .背景颜色, .背景颜色)
连续赋值 (#白色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)

.子程序 _课时4_获得焦点, 空白型, , 
连续赋值 (16762052, .背景颜色, .背景颜色, .背景颜色)
连续赋值 (#白色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)

.子程序 _课时5_获得焦点, 空白型, , 
连续赋值 (16762052, .背景颜色, .背景颜色, .背景颜色)
连续赋值 (#白色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)

.子程序 _课时6_获得焦点, 空白型, , 
连续赋值 (16762052, .背景颜色, .背景颜色, .背景颜色)
连续赋值 (#白色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)

.子程序 _课时7_获得焦点, 空白型, , 
连续赋值 (16762052, .背景颜色, .背景颜色, .背景颜色)
连续赋值 (#白色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)

.子程序 _课时8_获得焦点, 空白型, , 
连续赋值 (16762052, .背景颜色, .背景颜色, .背景颜色)
连续赋值 (#白色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)

.子程序 _课时9_获得焦点, 空白型, , 
连续赋值 (16762052, .背景颜色, .背景颜色, .背景颜色)
连续赋值 (#白色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)

.子程序 _课时10_获得焦点, 空白型, , 
连续赋值 (16762052, .背景颜色, .背景颜色, .背景颜色)
连续赋值 (#白色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)

.子程序 _课时11_获得焦点, 空白型, , 
连续赋值 (16762052, .背景颜色, .背景颜色, .背景颜色)
连续赋值 (#白色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)

.子程序 _课时12_获得焦点, 空白型, , 
连续赋值 (16762052, .背景颜色, .背景颜色, .背景颜色)
连续赋值 (#白色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)

.窗口程序集 放大照片窗口程序集, , , 

.程序集变量 图号, 整数型, , , 
.子程序 _放大照片窗口_创建完毕, 空白型, , 
赋值 (放大照片窗口., 相减 (相加 (放大照片窗口., 475), 放大照片窗口.取用户区高度 ()))
赋值 (.可视, 假)
.判断开始 (等于 (_启动窗口..现行子夹, 1))
    赋值 (图号, 载入图片 (_启动窗口..图片))
    赋值 (.图片, _启动窗口..图片)
.判断 (等于 (_启动窗口..现行子夹, 5))
    赋值 (图号, 载入图片 (_启动窗口..图片))
    赋值 (.图片, _启动窗口..图片)
.默认
    
.判断结束


.子程序 _放大照片窗口_尺寸被改变, 空白型, , 
移动图片 ()

.子程序 移动图片, 空白型, , 
.局部变量 图宽度, 整数型, , , 
.局部变量 图高度, 整数型, , , 
.局部变量 宽比例, 小数型, , , 
.局部变量 高比例, 小数型, , , 

赋值 (图宽度, 图号.取图片宽度 ())
赋值 (图高度, 图号.取图片高度 ())
赋值 (宽比例, 相除 (图宽度, 图高度))
赋值 (高比例, 相除 (图高度, 图宽度))
.如果 (大于 (图宽度, 图高度))
    赋值 (.宽度, 放大照片窗口.取用户区宽度 ())
    赋值 (.高度, 相乘 (.宽度, 高比例))
    .如果真 (大于 (.高度, 放大照片窗口.取用户区高度 ()))
        赋值 (.高度, 放大照片窗口.取用户区高度 ())
        赋值 (.宽度, 相乘 (.高度, 宽比例))
    .如果真结束
    
.否则
    赋值 (.高度, 放大照片窗口.取用户区高度 ())
    赋值 (.宽度, 相乘 (.高度, 宽比例))
    .如果真 (大于 (.宽度, 放大照片窗口.取用户区宽度 ()))
        赋值 (.宽度, 放大照片窗口.取用户区宽度 ())
        赋值 (.高度, 相乘 (.宽度, 高比例))
    .如果真结束
    
.如果结束

相减 (相除 (放大照片窗口.取用户区宽度 (), 2), 相除 (.宽度, 2)).移动 (相减 (相除 (放大照片窗口.取用户区高度 (), 2), 相除 (.高度, 2)), , )

.子程序 _放大照片窗口_首次激活, 空白型, , 
赋值 (.可视, 真)

.窗口程序集 评语录入窗口程序集, , , 

.程序集变量 评语类别, 整数型, , , 
.程序集变量 分类文本, 文本型, , , 
.程序集变量 评语库, 文本型, , , 
.程序集变量 优劣分类, 文本型, , , 
.程序集变量 分类, 整数型, , , 
.程序集变量 分类号, 文本型, , , 
.程序集变量 评语号码, 文本型, , , 
.程序集变量 评语姓名, 文本型, , , 
.程序集变量 项目记录, 整数型, , , 
.子程序 _评语录入窗口_创建完毕, 空白型, , 
未知支持库函数_0 (风格类型)
赋值 (., 菜单类型)
赋值 (评语录入窗口., 相减 (相加 (评语录入窗口., 575), 评语录入窗口.取用户区高度 ()))
赋值 (.现行选中项, 0)
.如果 (填充班级名称 ())
    “小学1年级1班”.选择 ()
    填充评语姓名 ()
    赋值 (., 0)
    
    填充评语 ()
    赋值 (.现行选中项, 0)
    赋值 (评语类别, 1)
    填充评语数据库 ()
    赋值 (.背景颜色, 取颜色值 (200, 255, 200))
    连续赋值 (#默认色, .背景颜色, .背景颜色)
    赋值 (.现行选中项, 0)
    赋值 (分类, 135)
    赋值 (优劣分类, “优等生”)
    赋值 (评语库, “小学库”)
    填充范例 (“优等生评语范例”)
    
.否则
    信息框 (“目前没有班级数据，请先进行校务设置！”, 0, “提示”)
    销毁 ()
    _教务设置_被选择 ()
.如果结束


.子程序 填充评语姓名, 空白型, , 填充评语姓名
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 行, 整数型, , , 
.局部变量 表项数, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 

置等待鼠标 ()
全部删除 ()
.如果真 (等于 (连接句柄, 0))
    信息框 (“没有连接到服务器！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select xh,xm,zxxz,szbj from xsda where szbj like '%”, .内容, “%' and zxxz like '%在校学生%' ORDER BY xh ASC;”)), 假)) ' 导出记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (字段数, 未知支持库函数_14 (记录集句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
.计次循环首 (记录数, 行)
    置等待鼠标 ()
    赋值 (表项数, -1.插入表项 ())
    .计次循环首 (字段数, 列)
        未知支持库函数_15 (记录集句柄, 相减 (列, 1), 字段名)
        赋值 (文本变量, “”)
        未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
        .如果真 (不等于 (文本变量, “”))
            表项数.置标题 (相减 (列, 1), 文本变量)
        .如果真结束
        
    .计次循环尾 ()
    表项数.置图片 (0, 112)
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
恢复鼠标 ()

.子程序 填充评语, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 文本变量, 文本型, , , 

.如果 (大于 (取表项数 (), 0))
    赋值 (.标题, 相加 (“您正在录入”, .内容, .取标题 (., 1), “同学的评语”))
.否则
    赋值 (.标题, 相加 (“目前”, .内容, “没有学生数据，请选择其它班级！”))
.如果结束
.如果真 (等于 (连接句柄, 0))
    载入 (登录窗口, , 真)
    返回 ()
.如果真结束
置等待鼠标 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select xm,xh,bqpy,zhpy from xsda where xh like '%”, 评语号码, “%' and xm like '%”, 评语姓名, “%';”)), 假)) ' 导出记录
    返回 ()
.如果真结束

赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “bqpy”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (文本变量, “”)
未知支持库函数_6 (记录集句柄, “zhpy”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_5 (记录集句柄)
恢复鼠标 ()


.子程序 _评语班级名组合框_列表项被选择, 空白型, , 
获取焦点 ()
填充评语姓名 ()
.如果 (大于 (取表项数 (), 0))
    赋值 (., 0)
    赋值 (评语号码, .取标题 (., 0))
    赋值 (评语姓名, .取标题 (., 1))
    填充评语 ()
.否则
    赋值 (.标题, 相加 (“目前”, .内容, “没有学生数据，请选择其它班级！”))
    信息框 (相加 (“  目前”, .内容, “没有学生数据，请选择其它班级！  ”), 0, “提示”)
.如果结束


.子程序 _选择词条库组合框_列表项被选择, 空白型, , 选择词条库
获取焦点 ()
赋值 (评语类别, 1)
.判断开始 (等于 (.现行选中项, -1))
    赋值 (.现行选中项, 0)
    赋值 (评语库, “小学库”)
.判断 (等于 (.现行选中项, 0))
    赋值 (评语库, “小学库”)
.判断 (等于 (.现行选中项, 1))
    赋值 (评语库, “中学库”)
.默认
    
.判断结束
填充评语数据库 ()

.子程序 _评语姓名列表框_当前表项被改变, 空白型, , 
.如果真 (等于 (., -1))
    赋值 (., 0)
.如果真结束
赋值 (评语号码, .取标题 (., 0))
赋值 (评语姓名, .取标题 (., 1))
填充评语 ()
获取焦点 ()
赋值 (.起始选择位置, 取文本长度 (.内容))

.子程序 _本学期评语编辑框_内容被改变, 空白型, , 
超范围检查 ()

.子程序 超范围检查, 空白型, , 
.如果真 (大于 (186.发送信息 (0, 0), 14))
    信息框 (“本学期评语最多输入14行内容！”, 0, )
    获取焦点 ()
    赋值 (.起始选择位置, 取文本长度 (.内容))
.如果真结束


.子程序 _评语词条列表框_右键单击表项, 空白型, , 
弹出菜单 ()

.子程序 _修改评语词条_被选择, 空白型, , 
.如果 (不等于 (., -1))
    赋值 (修改资料, 真)
    载入 (修改评语窗口, 评语录入窗口, 真)
.否则
    信息框 (“    请选择要编辑修改的评语词条！    ”, 0, “提示”)
.如果结束


.子程序 _添加评语词条_被选择, 空白型, , 
赋值 (修改资料, 假)
载入 (修改评语窗口, 评语录入窗口, 真)

.子程序 _删除评语词条_被选择, 空白型, , 
.局部变量 数量号, 文本型, , , 
.局部变量 条件, 文本型, , , 
.局部变量 错误, 文本型, , , 

.如果真 (等于 (., -1))
    信息框 (“    请选择要删除的评语词条！    ”, 0, “提示”)
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“您确定要删除当前选择的评语词条吗？    ”, 相加 (#确认取消钮, #询问图标), “询问”), #确认钮))
    赋值 (数量号, .取标题 (., 1))
    .如果真 (或者 (等于 (评语库, “”), 等于 (分类文本, “”), 等于 (数量号, “”)))
        信息框 (“记录条件出错！！！”, 0, )
        返回 ()
    .如果真结束
    .如果真 (等于 (连接句柄, 0))
        返回 ()
    .如果真结束
    
    赋值 (条件, 相加 (“xxlx='”, 评语库, “' and flwb='”, 分类文本, “' and xh='”, 数量号, “'”))
    .如果 (未知支持库函数_20 (连接句柄, “pyb”, 条件))
        .保证显示 (.)
        填充评语数据库 ()
    .否则
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (相加 (“修改评语失败！”, 错误), #错误图标, “错误”)
    .如果结束
    
.如果真结束


.子程序 _评语词条列表框_开始编辑, 逻辑型, , 
.参数 表项索引, 整数型, , 

.局部变量 文本, 文本型, , , 

赋值 (文本, 表项索引.取标题 (0))
.如果真 (大于 (取文本长度 (文本), 100))
    表项索引.置标题 (0, 取文本左边 (文本, 100))
.如果真结束


.子程序 _标题1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (评语类别, 1)
填充评语数据库 ()

.子程序 _标题2_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (评语类别, 2)
填充评语数据库 ()

.子程序 _标题3_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (评语类别, 3)
填充评语数据库 ()

.子程序 _标题4_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (评语类别, 4)
填充评语数据库 ()

.子程序 _标题5_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (评语类别, 5)
填充评语数据库 ()

.子程序 _标题6_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (评语类别, 6)
填充评语数据库 ()

.子程序 _标题7_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (评语类别, 7)
填充评语数据库 ()

.子程序 _标题8_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 填充评语数据库, 空白型, , 
.局部变量 表项, 整数型, , , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 行, 整数型, , , 
.局部变量 表项数, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 分类A, 整数型, , , 

.判断开始 (等于 (评语类别, 1))
    赋值 (.背景颜色, 取颜色值 (200, 255, 200))
    连续赋值 (#默认色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    赋值 (分类文本, “分类1”)
    赋值 (分类A, 14)
    
.判断 (等于 (评语类别, 2))
    赋值 (.背景颜色, 取颜色值 (200, 255, 200))
    连续赋值 (#默认色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    赋值 (分类文本, “分类2”)
    赋值 (分类A, 27)
.判断 (等于 (评语类别, 3))
    赋值 (.背景颜色, 取颜色值 (200, 255, 200))
    连续赋值 (#默认色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    赋值 (分类文本, “分类3”)
    赋值 (分类A, 28)
.判断 (等于 (评语类别, 4))
    赋值 (.背景颜色, 取颜色值 (200, 255, 200))
    连续赋值 (#默认色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    赋值 (分类文本, “分类4”)
    赋值 (分类A, 29)
.判断 (等于 (评语类别, 5))
    赋值 (.背景颜色, 取颜色值 (200, 255, 200))
    连续赋值 (#默认色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    赋值 (分类文本, “分类5”)
    赋值 (分类A, 30)
.判断 (等于 (评语类别, 6))
    赋值 (.背景颜色, 取颜色值 (200, 255, 200))
    连续赋值 (#默认色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    赋值 (分类文本, “分类6”)
    赋值 (分类A, 26)
.判断 (等于 (评语类别, 7))
    赋值 (.背景颜色, 取颜色值 (200, 255, 200))
    连续赋值 (#默认色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    赋值 (分类文本, “分类7”)
    赋值 (分类A, 31)
.默认
    
.判断结束
全部删除 ()
.如果真 (等于 (连接句柄, 0))
    载入 (登录窗口, , 真)
    返回 ()
.如果真结束
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select xxlx,flwb,pysj,xh from pyb where xxlx like '%”, 评语库, “%' and flwb like '%”, 分类文本, “%' ORDER BY flwb ASC;”)), 假)) ' 导出记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (字段数, 未知支持库函数_14 (记录集句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
赋值 (项目记录, 记录数)
.计次循环首 (记录数, 行)
    置等待鼠标 ()
    赋值 (表项数, -1.插入表项 ())
    赋值 (文本变量, “”)
    未知支持库函数_6 (记录集句柄, “pysj”, 文本变量)
    .如果真 (不等于 (文本变量, “”))
        表项数.置标题 (0, 文本变量)
        表项数.置图片 (0, 分类A)
    .如果真结束
    赋值 (文本变量, “”)
    未知支持库函数_6 (记录集句柄, “xh”, 文本变量)
    表项数.置标题 (1, 文本变量)
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
恢复鼠标 ()
赋值 (., 0)

.子程序 _保存评语按钮_被单击, 空白型, , 
.局部变量 更新条件, 文本型, , , 
.局部变量 错误, 文本型, , , 

.如果真 (或者 (等于 (取表项数 (), 0), 等于 (., -1)))
    信息框 (“请选择要录入评语的学生姓名！”, 0, “提示”)
    返回 ()
.如果真结束
.如果真 (等于 (评语号码, “”))
    信息框 (“请选择要录入评语的学生姓名！”, 0, “提示”)
    返回 ()
.如果真结束
.如果真 (等于 (连接句柄, 0))
    载入 (登录窗口, , 真)
    返回 ()
.如果真结束
.如果真 (大于 (取文本长度 (.内容), 16777215))
    信息框 (“综合评语太大！”, 0, )
    返回 ()
.如果真结束
赋值 (更新条件, 相加 (“xh='”, 评语号码, “' and xm='”, 评语姓名, “'”))
.如果 (未知支持库函数_19 (连接句柄, “xsda”, 相加 (“bqpy='”, .内容, “',zhpy='”, .内容, “'”), 更新条件))
    .如果 (小于 (., 相减 (取表项数 (), 1)))
        信息框 (相加 (.取标题 (., 1), “同学的评语已保存！即将录入的是”, 相加 (., 1).取标题 (1), “同学的评语。”), 0, )
        赋值 (., 相加 (., 1))
        
    .否则
        信息框 (相加 (.取标题 (., 1), “同学的评语已保存！”), 0, )
    .如果结束
    
.否则
    未知支持库函数_41 (连接句柄, 错误)
    信息框 (相加 (“ 错误！”, 错误), 0, )
.如果结束


.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _综合评价钮_被单击, 空白型, , 
.如果 (不等于 (.内容, “”))
    赋值 (.内容, 相加 (.内容, #换行符, #换行符, 时间到文本 (取现行时间 (), 2), “录入的评语：”, #换行符, #换行符, .内容))
.否则
    赋值 (.内容, 相加 (时间到文本 (取现行时间 (), 2), “录入的评语：”, #换行符, #换行符, .内容))
.如果结束
赋值 (.起始选择位置, 取文本长度 (.内容))


.子程序 _随机录入按钮_被单击, 空白型, , 随机录入
.局部变量 待选, 文本型, , "0", 
.局部变量 计次, 整数型, , , 
.局部变量 随机数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 行, 整数型, , , 
.局部变量 文本变量, 文本型, , , 

置等待鼠标 ()
置随机数种子 ()
赋值 (.内容, “”)
.计次循环首 (7, 计次)
    清除数组 (待选)
    .如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select xxlx,flwb,pysj from pyb where xxlx like '%”, 评语库, “%' and flwb like '%分类”, 到文本 (计次), “%' ORDER BY flwb ASC;”)), 假)) ' 导出记录
        返回 ()
    .如果真结束
    赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
    未知支持库函数_12 (记录集句柄)
    赋值 (记录数, 未知支持库函数_7 (记录集句柄))
    .计次循环首 (记录数, 行)
        置等待鼠标 ()
        赋值 (文本变量, “”)
        未知支持库函数_6 (记录集句柄, “pysj”, 文本变量)
        加入成员 (待选, 文本变量)
        未知支持库函数_10 (记录集句柄)
        处理事件 ()
    .计次循环尾 ()
    未知支持库函数_5 (记录集句柄)
    
    .如果真 (大于 (取数组成员数 (待选), 0))
        赋值 (随机数, 取随机数 (1, 取数组成员数 (待选)))
        .如果 (等于 (.内容, “”))
            赋值 (.内容, 相加 (“    ”, 待选 [随机数]))
        .否则
            待选.加入文本 ( [随机数])
        .如果结束
        
    .如果真结束
    
.计次循环尾 ()
恢复鼠标 ()

.子程序 _清空按钮_被单击, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)

.子程序 _分类操作转换钮_被单击, 空白型, , 
.如果 (等于 (.标题, “自动转分类”))
    赋值 (.标题, “手动选分类”)
.否则
    赋值 (.标题, “自动转分类”)
.如果结束


.子程序 _词条范例转换钮_被单击, 空白型, , 
.如果 (等于 (.标题, “按优劣学评语录入”))
    赋值 (.禁止, 真)
    赋值 (.标题, “单句自选评语录入”)
    赋值 (.现行子夹, 1)
.否则
    赋值 (.禁止, 假)
    赋值 (.标题, “按优劣学评语录入”)
    赋值 (.现行子夹, 0)
.如果结束


.子程序 _优等生评语范例钮_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.背景颜色, 取颜色值 (200, 255, 200))
连续赋值 (#默认色, .背景颜色, .背景颜色)
赋值 (优劣分类, “优等生”)
赋值 (分类, 135)
填充范例 (“优等生评语范例”)

.子程序 _中等生评语范例钮_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.背景颜色, 取颜色值 (200, 255, 200))
连续赋值 (#默认色, .背景颜色, .背景颜色)
赋值 (优劣分类, “中等生”)
赋值 (分类, 150)
填充范例 (“中等生评语范例”)

.子程序 _后进生评语范例钮_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.背景颜色, 取颜色值 (200, 255, 200))
连续赋值 (#默认色, .背景颜色, .背景颜色)
赋值 (优劣分类, “后进生”)
赋值 (分类, 136)
填充范例 (“后进生评语范例”)

.子程序 _选择范例库组合框_列表项被选择, 空白型, , 
获取焦点 ()
赋值 (.背景颜色, 取颜色值 (200, 255, 200))
连续赋值 (#默认色, .背景颜色, .背景颜色)
.判断开始 (等于 (.现行选中项, -1))
    赋值 (.现行选中项, 0)
    赋值 (评语库, “小学库”)
.判断 (等于 (.现行选中项, 0))
    赋值 (评语库, “小学库”)
.判断 (等于 (.现行选中项, 1))
    赋值 (评语库, “中学库”)
.默认
    
.判断结束

填充范例 (“优等生评语范例”)

.子程序 填充范例, 空白型, , 填充范例
.参数 范例分类, 文本型, , 

.局部变量 编号, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 表项数, 整数型, , , 
.局部变量 文本变量, 文本型, , , 

.如果真 (等于 (连接句柄, 0))
    载入 (登录窗口, , 真)
    返回 ()
.如果真结束
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select ylfl,ylsj,ylxh from pyb where xxlx like '%”, 评语库, “%' and ylfl like '%”, 优劣分类, “%' ORDER BY flwb ASC;”)), 假)) ' 导出记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
赋值 (项目记录, 0)
赋值 (项目记录, 记录数)
全部删除 ()
.计次循环首 (记录数, )
    置等待鼠标 ()
    赋值 (表项数, -1.插入表项 ())
    赋值 (文本变量, “”)
    未知支持库函数_6 (记录集句柄, “ylsj”, 文本变量)
    .如果真 (不等于 (文本变量, “”))
        表项数.置标题 (0, 取文本左边 (文本变量, 100))
        表项数.置图片 (0, 分类)
        
    .如果真结束
    
    赋值 (文本变量, “”)
    未知支持库函数_6 (记录集句柄, “ylxh”, 文本变量)
    表项数.置标题 (1, 文本变量)
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
恢复鼠标 ()

.子程序 _范例评语列表框_当前表项被改变, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 文本变量, 文本型, , , 

赋值 (分类号, “”)
.如果真 (等于 (连接句柄, 0))
    载入 (登录窗口, , 真)
    返回 ()
.如果真结束
置等待鼠标 ()
赋值 (文本变量, “”)
赋值 (分类号, .取标题 (., 1))
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select ylfl,ylsj,ylxh from pyb where xxlx like '%”, 评语库, “%' and ylxh like '%”, 分类号, “%' and ylfl like '%”, 优劣分类, “%' ORDER BY flwb ASC;”)), 假)) ' 导出记录
    返回 ()
.如果真结束

赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
未知支持库函数_6 (记录集句柄, “ylsj”, 文本变量)
赋值 (.内容, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_5 (记录集句柄)
恢复鼠标 ()


.子程序 _范例评语列表框_右键单击表项, 空白型, , 
弹出菜单 ()

.子程序 _修改范例评语_被选择, 空白型, , 
.如果真 (等于 (., -1))
    信息框 (“请选择要修改的范例评语！”, 0, )
    返回 ()
.如果真结束
赋值 (修改资料, 真)
载入 (修改范例窗口, 评语录入窗口, 真)

.子程序 _添加范例评语_被选择, 空白型, , 
赋值 (修改资料, 假)
载入 (修改范例窗口, 评语录入窗口, 真)

.子程序 _删除范例评语_被选择, 空白型, , 
.局部变量 表项, 整数型, , , 
.局部变量 条件, 文本型, , , 

.如果真 (等于 (., -1))
    信息框 (“    请选择要删除的评语范例！    ”, 0, “提示”)
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“您确定要删除当前选择的评语范例吗？    ”, 相加 (#确认取消钮, #询问图标), “询问”), #确认钮))
    赋值 (条件, 相加 (“ xxlx='”, 评语录入窗口., “' and ylxh='”, 评语录入窗口., “' and ylfl='”, 评语录入窗口., “'”))
    .如果 (未知支持库函数_20 (连接句柄, “pyb”, 条件))
        赋值 (表项, .)
        表项.删除表项 ()
        .如果真 (大于 (取表项数 (), 0))
            赋值 (., 相减 (表项, 1))
            .保证显示 (.)
            _范例评语列表框_当前表项被改变 ()
        .如果真结束
        
    .否则
        信息框 (“操作失败！”, #错误图标, “错误”)
        
    .如果结束
    
.如果真结束


.子程序 _评语录入窗口_被取消激活, 空白型, , 
获取焦点 ()

.子程序 _方案组合框_列表项被选择, 空白型, , 
.判断开始 (等于 (.现行选中项, 0))
    连续赋值 (#白色, ., ., ., ., ., ., .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    连续赋值 (#黑色, ., ., ., .文本颜色, .文本颜色, .文本颜色)
.判断 (等于 (.现行选中项, 1))
    连续赋值 (#白色, ., ., ., ., ., ., .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    连续赋值 (取颜色值 (128, 128, 0), ., ., ., .文本颜色, .文本颜色, .文本颜色)
.判断 (等于 (.现行选中项, 2))
    连续赋值 (#青蓝, ., ., ., ., ., ., .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    连续赋值 (#白色, ., ., ., .文本颜色, .文本颜色, .文本颜色)
.判断 (等于 (.现行选中项, 3))
    连续赋值 (取颜色值 (128, 128, 192), ., ., ., ., ., ., .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    连续赋值 (#黄色, ., ., ., .文本颜色, .文本颜色, .文本颜色)
.判断 (等于 (.现行选中项, 4))
    连续赋值 (取颜色值 (0, 52, 0), ., ., ., ., ., ., .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    连续赋值 (#白色, ., ., ., .文本颜色, .文本颜色, .文本颜色)
.判断 (等于 (.现行选中项, 5))
    连续赋值 (#黑色, ., ., ., ., ., ., .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
    连续赋值 (#银白, ., ., ., .文本颜色, .文本颜色, .文本颜色)
.默认
    
.判断结束


.子程序 _字体组合框_列表项被选择, 空白型, , 
.判断开始 (等于 (.现行选中项, 0))
    连续赋值 (9, ..字体大小, ..字体大小, ..字体大小, .字体.字体大小, .字体.字体大小, .字体.字体大小)
.判断 (等于 (.现行选中项, 1))
    连续赋值 (10, ..字体大小, ..字体大小, ..字体大小, .字体.字体大小, .字体.字体大小, .字体.字体大小)
.判断 (等于 (.现行选中项, 2))
    连续赋值 (11, ..字体大小, ..字体大小, ..字体大小, .字体.字体大小, .字体.字体大小, .字体.字体大小)
.判断 (等于 (.现行选中项, 3))
    连续赋值 (12, ..字体大小, ..字体大小, ..字体大小, .字体.字体大小, .字体.字体大小, .字体.字体大小)
.默认
    
.判断结束


.子程序 _评语词条列表框_表项被激活, 空白型, , 
.如果真 (或者 (等于 (取表项数 (), 0), 等于 (., -1)))
    信息框 (“请选择要录入评语的学生姓名！”, 0, “提示”)
    返回 ()
.如果真结束

获取焦点 ()
赋值 (.起始选择位置, 取文本长度 (.内容))
.如果 (等于 (.内容, “”))
    相加 (“    ”, .取标题 (., 0)).加入文本 ()
.否则
    .取标题 (., 0).加入文本 ()
.如果结束

超范围检查 ()
.如果真 (等于 (.标题, “自动转分类”))
    赋值 (评语类别, 相加 (评语类别, 1))
    .如果真 (大于 (评语类别, 7))
        赋值 (评语类别, 1)
    .如果真结束
    填充评语数据库 ()
.如果真结束


.子程序 _评语录入窗口_尺寸被改变, 空白型, , 
评语录入窗口.移动 (0, 0, , )

.窗口程序集 工资系统设置窗口程序集, , , 

.子程序 _工资系统设置窗口_创建完毕, 空白型, , 
.局部变量 计数, 整数型, , , 
.局部变量 年, 整数型, , , 

未知支持库函数_0 (风格类型)
赋值 (工资系统设置窗口., 相减 (相加 (工资系统设置窗口., 145), 工资系统设置窗口.取用户区高度 ()))
赋值 (.标题, 相加 (“设置修改 ”, _启动窗口..内容, “ 的工资项目名称”))
赋值 (年, 相减 (取年份 (取现行时间 ()), 5))
清空 ()
.计次循环首 (10, 计数)
    相加 (到文本 (相加 (年, 计数)), “年”).加入项目 ()
.计次循环尾 ()
相加 (到文本 (取年份 (取现行时间 ())), “年”).选择 ()
相加 (到文本 (取月份 (取现行时间 ())), “月”).选择 ()
赋值 (.内容, _启动窗口..标题)
赋值 (.内容, _启动窗口.取文本 (., 2, 3))
赋值 (.内容, _启动窗口.取文本 (., 2, 4))
赋值 (.内容, _启动窗口.取文本 (., 2, 5))
赋值 (.内容, _启动窗口.取文本 (., 2, 6))
赋值 (.内容, _启动窗口.取文本 (., 2, 7))
赋值 (.内容, _启动窗口.取文本 (., 2, 8))
赋值 (.内容, _启动窗口.取文本 (., 2, 9))
获取焦点 ()
赋值 (.被选择字符数, 取文本长度 (.内容))


.子程序 _确定按钮_被单击, 空白型, , 
写配置项 (相加 (取运行目录 (), “\config.ini”), “Wages”, _启动窗口..内容, .内容)
_启动窗口.置表头行数 (., 0)
赋值 (_启动窗口..标题, .内容)
赋值 (_启动窗口..内容, 相加 (.内容, .内容))
_启动窗口.置文本 (., 2, 3, .内容)
_启动窗口.置文本 (., 2, 4, .内容)
_启动窗口.置文本 (., 2, 5, .内容)
_启动窗口.置文本 (., 2, 6, .内容)
_启动窗口.置文本 (., 2, 7, .内容)
_启动窗口.置文本 (., 2, 8, .内容)
_启动窗口.置文本 (., 2, 9, .内容)
_启动窗口.置表头行数 (., 2)
_启动窗口.获取焦点 (.)
销毁 ()

.子程序 _取消按钮_被单击, 空白型, , 
_启动窗口.获取焦点 (.)
销毁 ()

.子程序 _工资系统设置窗口_将被销毁, 空白型, , 
_启动窗口.获取焦点 (.)

.子程序 _工资表标题编辑框_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _工资项目编辑框1_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _工资项目编辑框2_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _工资项目编辑框3_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _工资项目编辑框4_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _工资项目编辑框5_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _工资项目编辑框6_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _工资项目编辑框7_获得焦点, 空白型, , 
赋值 (.被选择字符数, 取文本长度 (.内容))

.子程序 _年份组合框_列表项被选择, 空白型, , 
获取焦点 ()

.子程序 _月份组合框_列表项被选择, 空白型, , 
获取焦点 ()

.窗口程序集 改升级名窗口程序集, , , 

.子程序 _改升级名窗口_创建完毕, 空白型, , 
未知支持库函数_0 (风格类型)
赋值 (改升级名窗口., 相减 (相加 (改升级名窗口., 100), 改升级名窗口.取用户区高度 ()))
赋值 (.标题, 自设毕业窗口.取标题 (., 自设毕业窗口.., 0))
赋值 (.内容, .标题)
获取焦点 ()
赋值 (.被选择字符数, -1)

.子程序 _确定按钮_被单击, 空白型, , 
.如果 (不等于 (删全部空 (.内容), 删全部空 (.标题)))
    .如果 (不等于 (删全部空 (.内容), “”))
        自设毕业窗口.置标题 (., 自设毕业窗口.., 1, 删全部空 (.内容))
        销毁 ()
    .否则
        信息框 (“请输入升级后的班级名称！”, 0, )
    .如果结束
    
.否则
    信息框 (“升级前和升级后的名称相同！如果该班不需要升级请按取消钮后重新选择班级。”, 0, )
.如果结束


.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()

.窗口程序集 离校说明窗口程序集, , , 

.子程序 _离校说明窗口_创建完毕, 空白型, , 
赋值 (离校说明窗口., 相减 (相加 (离校说明窗口., 80), 离校说明窗口.取用户区高度 ()))

赋值 (.内容, 相加 (#换行符, _启动窗口..标题, _启动窗口.))


.窗口程序集 修改范例窗口程序集, , , 

.子程序 _修改范例窗口_创建完毕, 空白型, , 
未知支持库函数_0 (风格类型)
赋值 (修改范例窗口., 相减 (相加 (修改范例窗口., 260), 修改范例窗口.取用户区高度 ()))
.如果 (等于 (修改资料, 真))
    赋值 (.内容, 评语录入窗口..内容)
    赋值 (.标题, “修改评语范例”)
.否则
    赋值 (.内容, “”)
    赋值 (.标题, “添加评语范例”)
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 分类, 文本型, , , 
.局部变量 错误, 文本型, , , 
.局部变量 条件, 文本型, , , 
.局部变量 类号, 文本型, , , 

.判断开始 (并且 (等于 (修改资料, 假), 等于 (.标题, “添加评语范例”)))
    .判断开始 (等于 (评语录入窗口..背景颜色, 取颜色值 (200, 255, 200)))
        赋值 (分类, “优等生评语范例”)
    .判断 (等于 (评语录入窗口..背景颜色, 取颜色值 (200, 255, 200)))
        赋值 (分类, “中等生评语范例”)
    .判断 (等于 (评语录入窗口..背景颜色, 取颜色值 (200, 255, 200)))
        赋值 (分类, “后进生评语范例”)
    .默认
        
    .判断结束
    
    赋值 (类号, 相加 (取文本左边 (评语录入窗口., 5), 到文本 (相加 (评语录入窗口., 1))))
    赋值 (条件, 相加 (“ xxlx='”, 评语录入窗口., “',ylxh='”, 类号, “',ylfl='”, 评语录入窗口., “',ylsj='”, .内容, “'”))
    .如果 (未知支持库函数_18 (连接句柄, “pyb”, 条件))
        .判断开始 (等于 (评语录入窗口., “优等生”))
            填充范例 (“优等生评语范例”)
        .判断 (等于 (评语录入窗口., “中等生”))
            填充范例 (“中等生评语范例”)
        .判断 (等于 (评语录入窗口., “后进生”))
            填充范例 (“后进生评语范例”)
        .默认
            
        .判断结束
        
        赋值 (评语录入窗口.., 相减 (评语录入窗口.取表项数 (.), 1))
        评语录入窗口.保证显示 (., 评语录入窗口..)
        
        _范例评语列表框_当前表项被改变 ()
        销毁 ()
        
    .否则
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (相加 (“修改评语范例失败！”, 错误), #错误图标, “错误”)
        销毁 ()
    .如果结束
    
.判断 (并且 (等于 (修改资料, 真), 等于 (.标题, “修改评语范例”)))
    
    赋值 (条件, 相加 (“ xxlx='”, 评语录入窗口., “' and ylxh='”, 评语录入窗口., “' and ylfl='”, 评语录入窗口., “'”))
    
    .如果 (未知支持库函数_19 (连接句柄, “pyb”, 相加 (“ylsj='”, .内容, “'”), 条件))
        .判断开始 (等于 (评语录入窗口., “优等生”))
            填充范例 (“优等生评语范例”)
        .判断 (等于 (评语录入窗口., “中等生”))
            填充范例 (“中等生评语范例”)
        .判断 (等于 (评语录入窗口., “后进生”))
            填充范例 (“后进生评语范例”)
        .默认
            
        .判断结束
        _范例评语列表框_当前表项被改变 ()
        销毁 ()
        
    .否则
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (相加 (“修改评语范例失败！”, 错误), #错误图标, “错误”)
        销毁 ()
    .如果结束
    
.默认
    
.判断结束


.子程序 _编辑框1_内容被改变, 空白型, , 
.如果真 (大于 (186.发送信息 (0, 0), 14))
    .判断循环首 (大于 (186.发送信息 (0, 0), 14))
        赋值 (.内容, 取文本左边 (.内容, 相减 (取文本长度 (.内容), 2)))
    .判断循环尾 ()
    信息框 (“评语最多输入14行内容！”, 0, )
    获取焦点 ()
    赋值 (.起始选择位置, 取文本长度 (.内容))
.如果真结束


.窗口程序集 评语窗口程序集, , , 

.子程序 _修改评语窗口_创建完毕, 空白型, , 
未知支持库函数_0 (风格类型)
.如果 (等于 (修改资料, 真))
    赋值 (.内容, 评语录入窗口.取标题 (., 评语录入窗口.., 0))
    赋值 (.标题, “修改评语”)
.否则
    赋值 (.内容, “”)
    赋值 (.标题, “添加评语”)
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 错误, 文本型, , , 
.局部变量 条件, 文本型, , , 
.局部变量 类号, 文本型, , , 
.局部变量 库名, 文本型, , , 
.局部变量 数量号, 文本型, , , 

.判断开始 (并且 (等于 (修改资料, 假), 等于 (.标题, “添加评语”)))
    赋值 (库名, 评语录入窗口.)
    赋值 (类号, 评语录入窗口.)
    赋值 (数量号, 相加 (类号, 到文本 (相加 (评语录入窗口., 1))))
    .如果真 (或者 (等于 (库名, “”), 等于 (类号, “”), 等于 (数量号, “”)))
        信息框 (“记录条件出错！！！”, 0, )
        返回 ()
    .如果真结束
    .如果真 (等于 (连接句柄, 0))
        返回 ()
    .如果真结束
    .如果真 (等于 (.内容, “”))
        信息框 (“没有记录内容！”, 0, )
        返回 ()
    .如果真结束
    赋值 (条件, 相加 (“xxlx='”, 库名, “',flwb='”, 类号, “',xh='”, 数量号, “',pysj='”, .内容, “'”))
    .如果 (未知支持库函数_18 (连接句柄, “pyb”, 条件))
        评语录入窗口.保证显示 (., 评语录入窗口..)
        填充评语数据库 ()
        销毁 ()
    .否则
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (相加 (“添加新的评语词条失败！”, 错误), #错误图标, “错误”)
    .如果结束
    
    
.判断 (并且 (等于 (修改资料, 真), 等于 (.标题, “修改评语”)))
    赋值 (库名, 评语录入窗口.)
    赋值 (类号, 评语录入窗口.)
    赋值 (数量号, 评语录入窗口.取标题 (., 评语录入窗口.., 1))
    .如果真 (或者 (等于 (库名, “”), 等于 (类号, “”), 等于 (数量号, “”)))
        信息框 (“记录条件出错！！！”, 0, )
        返回 ()
    .如果真结束
    .如果真 (等于 (连接句柄, 0))
        返回 ()
    .如果真结束
    .如果真 (等于 (.内容, “”))
        信息框 (“没有记录内容！”, 0, )
        返回 ()
    .如果真结束
    
    赋值 (条件, 相加 (“xxlx='”, 库名, “' and flwb='”, 类号, “' and xh='”, 数量号, “'”))
    
    .如果 (未知支持库函数_19 (连接句柄, “pyb”, 相加 (“pysj='”, .内容, “'”), 条件))
        评语录入窗口.保证显示 (., 评语录入窗口..)
        填充评语数据库 ()
        销毁 ()
        
    .否则
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (相加 (“修改评语失败！”, 错误), #错误图标, “错误”)
        销毁 ()
    .如果结束
    
.默认
    
.判断结束


.窗口程序集 排课程序窗口程序集, , , 

.程序集变量 课程, 文本型, , "0", 
.程序集变量 总课时数, 整数型, , , 
.程序集变量 匿名程序集变量_6759, 空白型, , , 
.程序集变量 课目周类型, 文本型, , , 
.程序集变量 加课, 文本型, , , 
.程序集变量 班级, 文本型, , , 
.程序集变量 选择项目, 整数型, , , 
.程序集变量 单元格成员A, 文本型, , "0", 
.程序集变量 单元格成员B, 文本型, , "0", 
.程序集变量 光标行A, 整数型, , , 
.程序集变量 光标行B, 整数型, , , 
.程序集变量 光标列A, 整数型, , , 
.程序集变量 光标列B, 整数型, , , 
.程序集变量 横向A, 整数型, , , 
.程序集变量 纵向A, 整数型, , , 
.程序集变量 背景色成员, 整数型, , "0", 
.程序集变量 背景色成员A, 整数型, , "0", 
.程序集变量 背景色成员B, 整数型, , "0", 
.程序集变量 课程表位置, 文本型, , , 
.程序集变量 记录A, 逻辑型, , , 
.子程序 _自动排课窗口_创建完毕, 空白型, , 
.局部变量 学期, 文本型, , , 

赋值 (., 菜单类型)
未知支持库函数_0 (风格类型)
.如果 (填充班级名称 ())
    “小学1年级1班”.选择 ()
    显示课目 ()
.否则
    
.如果结束
.如果真 (等于 (班级, “”))
    赋值 (班级, .内容)
.如果真结束
赋值 (记录A, 假)
.如果 (小于或等于 (取月份 (取现行时间 ()), 8))
    赋值 (学期, “上学期”)
.否则
    赋值 (学期, “下学期”)
.如果结束
1.置文本 (1, 相加 (校名, 到文本 (取年份 (取现行时间 ())), “年”, 学期, 取文本左边 (班级, 4), “课程表”))
赋值 (.标题, 相加 (校名, 到文本 (取年份 (取现行时间 ())), “年”, 学期, 取文本左边 (班级, 4), “课程表编辑系统”))
赋值 (自动排课窗口., 相加 (校名, “课程表编辑系统”))
显示课程表 ()
_科目列表框1_当前表项被改变 ()

.子程序 显示课程表, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 表项, 整数型, , , 
.局部变量 文本变量, 文本型, , , 

.如果真 (等于 (连接句柄, 0))
    信息框 (“没有连接到服务器！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (未知支持库函数_3 (连接句柄, “select nfxq from kcb ORDER BY nfxq ASC;”), 假)) ' 导出记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
未知支持库函数_12 (记录集句柄)
全部删除 ()
.计次循环首 (记录数, )
    置等待鼠标 ()
    赋值 (表项, .插入表项 ())
    未知支持库函数_6 (记录集句柄, “nfxq”, 文本变量)
    表项.置标题 (0, 文本变量)
    表项.置图片 (0, 0)
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
未知支持库函数_73 ()

.子程序 _自动排课窗口_尺寸被改变, 空白型, , 
赋值 (.宽度, 相减 (自动排课窗口., 7))
赋值 (.宽度, 相减 (自动排课窗口., 7))
赋值 (.宽度, 相减 (自动排课窗口., 11))
.移动 (相减 (自动排课窗口., 192), 相减 (自动排课窗口., 119))
.移动 (相减 (自动排课窗口., .加粗, 46))
.移动 (相加 (.宽度, 3), 相加 (.高度, 3))


.子程序 显示课目, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 T, 整数型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 科目, 整数型, , , 
.局部变量 课程数, 整数型, , , 

赋值 (班级, .内容)
.如果真 (等于 (班级, “”))
    返回 ()
.如果真结束
.如果真 (等于 (连接句柄, 0))
    信息框 (“没有连接到服务器！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select bj,km1,km2,km3,km4,km5,km6,km7,km8,km9,km10,km11,km12,zf1,zf2,zf3,zf4,zf5,zf6,zf7,zf8,zf9,zf10,zf11,zf12,ks1,ks2,ks3,ks4,ks5,ks6,ks7,ks8,ks9,ks10,ks11,ks12,ls1,ls2,ls3,ls4,ls5,ls6,ls7,ls8,ls9,ls10,ls11,ls12 from system where bj like '%”, 班级, “%' ORDER BY bj DESC;”)), 假)) ' 导出记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
未知支持库函数_12 (记录集句柄)
全部删除 ()
.计次循环首 (12, T)
    赋值 (文本变量, “”)
    未知支持库函数_6 (记录集句柄, 相加 (“km”, 到文本 (T)), 文本变量)
    .如果真 (不等于 (文本变量, “”))
        赋值 (科目, -1.插入表项 ())
        科目.置标题 (0, 文本变量)
        科目.置图片 (0, 3)
        未知支持库函数_6 (记录集句柄, 相加 (“zf”, 到文本 (T)), 文本变量)
        .如果真 (不等于 (文本变量, “”))
            .如果 (等于 (文本变量, “1”))
                科目.置标题 (1, “主 课”)
            .否则
                科目.置标题 (1, “副 课”)
                
            .如果结束
            
        .如果真结束
        未知支持库函数_6 (记录集句柄, 相加 (“ks”, 到文本 (T)), 文本变量)
        .如果真 (不等于 (文本变量, “”))
            科目.置标题 (2, 文本变量)
            赋值 (课程数, 相加 (课程数, 到数值 (文本变量)))
        .如果真结束
        未知支持库函数_6 (记录集句柄, 相加 (“ls”, 到文本 (T)), 文本变量)
        .如果真 (不等于 (文本变量, “”))
            科目.置标题 (3, 文本变量)
            赋值 (课程数, 相加 (课程数, 到数值 (文本变量)))
        .如果真结束
        
        
    .如果真结束
    未知支持库函数_10 (记录集句柄)
    处理事件 ()
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
0.置文本 (相加 (“ 当前班级的课程科目有”, 到文本 (相加 (科目, 1)), “项， 每周的课程共有”, 到文本 (课程数), “节。”))

.子程序 _按钮2_被单击, 空白型, , 
载入 (设置科目窗口, , 真)


.子程序 _按钮1_被单击, 空白型, , 
赋值 (.选中, 真)
赋值 (.选中, 假)
清除 ()
自动排课 ()
赋值 (记录A, 假)

.子程序 生成空课程表, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 每周天数, 文本型, , , 
.局部变量 是否加课, 文本型, , , 
.局部变量 上午, 文本型, , , 
.局部变量 下午, 文本型, , , 
.局部变量 晚上, 文本型, , , 
.局部变量 A, 整数型, , , 
.局部变量 班级数量, 整数型, , , 
.局部变量 一年级班, 整数型, , , 
.局部变量 二年级班, 整数型, , , 
.局部变量 三年级班, 整数型, , , 
.局部变量 四年级班, 整数型, , , 
.局部变量 五年级班, 整数型, , , 
.局部变量 六年级班, 整数型, , , 
.局部变量 行数, 整数型, , , 
.局部变量 列数, 整数型, , , 
.局部变量 T, 整数型, , , 

.如果真 (等于 (班级, “”))
    信息框 (“Error! 没有选择班级名！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (连接句柄, 0))
    信息框 (“没有连接到服务器！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select bj,sfjk,kcsj,sw,xw,ws from system where bj like '%”, 取文本左边 (班级, 4), “%' ORDER BY bj ASC;”)), 假)) ' 导出记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
未知支持库函数_6 (记录集句柄, “kcsj”, 每周天数)
未知支持库函数_6 (记录集句柄, “sfjk”, 是否加课)
未知支持库函数_6 (记录集句柄, “sw”, 上午)
未知支持库函数_6 (记录集句柄, “xw”, 下午)
未知支持库函数_6 (记录集句柄, “ws”, 晚上)
.如果真 (等于 (上午, “”))
    赋值 (上午, “4”)
    赋值 (下午, “2”)
    赋值 (晚上, “2”)
    赋值 (是否加课, “0”)
.如果真结束
未知支持库函数_5 (记录集句柄)

.计次循环首 (取项目数 (), A)
    .如果真 (等于 (取文本左边 (相减 (A, 1).取项目文本 (), 4), 取文本左边 (班级, 4)))
        赋值 (班级数量, 相加 (班级数量, 1))
        .如果真 (等于 (取文本中间 (相减 (A, 1).取项目文本 (), 5, 5), “1年级”))
            赋值 (一年级班, 相加 (一年级班, 1))
        .如果真结束
        .如果真 (等于 (取文本中间 (相减 (A, 1).取项目文本 (), 5, 5), “2年级”))
            赋值 (二年级班, 相加 (二年级班, 1))
        .如果真结束
        .如果真 (等于 (取文本中间 (相减 (A, 1).取项目文本 (), 5, 5), “3年级”))
            赋值 (三年级班, 相加 (三年级班, 1))
        .如果真结束
        .如果真 (等于 (取文本中间 (相减 (A, 1).取项目文本 (), 5, 5), “4年级”))
            赋值 (四年级班, 相加 (四年级班, 1))
        .如果真结束
        .如果真 (等于 (取文本中间 (相减 (A, 1).取项目文本 (), 5, 5), “5年级”))
            赋值 (五年级班, 相加 (五年级班, 1))
        .如果真结束
        .如果真 (等于 (取文本中间 (相减 (A, 1).取项目文本 (), 5, 5), “6年级”))
            赋值 (六年级班, 相加 (六年级班, 1))
        .如果真结束
        
    .如果真结束
    处理事件 ()
.计次循环尾 ()
0.初始尺寸 (0)
1.插入行 (3)
1.插入列 (3)

2.置文本 (1, “年级/班级”)
2.置行高 (2, 70)
2.合并 (1, 2, 3)

.如果真 (不等于 (一年级班, 0))
    赋值 (行数, 相加 (取行数 (), 1))
    一年级班.添加行 ()
    .判断开始 (等于 (一年级班, 2))
        行数.置文本 (1, “ 一年级”)
    .判断 (等于 (一年级班, 3))
        行数.置文本 (1, “     一年级”)
    .判断 (大于 (一年级班, 3))
        行数.置文本 (1, “            一年级”)
    .默认
        行数.置文本 (1, “一年级”)
    .判断结束
    行数.合并 (1, 一年级班, 1)
    赋值 (A, 0)
    .计次循环首 (一年级班, A)
        相减 (相加 (行数, A), 1).合并 (2, 1, 2)
        相减 (相加 (行数, A), 1).置文本 (2, 相加 (到文本 (A), “班”))
    .计次循环尾 ()
.如果真结束
.如果真 (不等于 (二年级班, 0))
    赋值 (行数, 相加 (取行数 (), 1))
    二年级班.添加行 ()
    .判断开始 (等于 (二年级班, 2))
        行数.置文本 (1, “ 二年级”)
    .判断 (等于 (二年级班, 3))
        行数.置文本 (1, “     二年级”)
    .判断 (大于 (二年级班, 3))
        行数.置文本 (1, “            二年级”)
    .默认
        行数.置文本 (1, “二年级”)
    .判断结束
    行数.合并 (1, 二年级班, 1)
    赋值 (A, 0)
    .计次循环首 (二年级班, A)
        相减 (相加 (行数, A), 1).合并 (2, 1, 2)
        相减 (相加 (行数, A), 1).置文本 (2, 相加 (到文本 (A), “班”))
    .计次循环尾 ()
.如果真结束
.如果真 (不等于 (三年级班, 0))
    赋值 (行数, 相加 (取行数 (), 1))
    三年级班.添加行 ()
    .判断开始 (等于 (三年级班, 2))
        行数.置文本 (1, “ 三年级”)
    .判断 (等于 (三年级班, 3))
        行数.置文本 (1, “     三年级”)
    .判断 (大于 (三年级班, 3))
        行数.置文本 (1, “            三年级”)
    .默认
        行数.置文本 (1, “三年级”)
    .判断结束
    行数.合并 (1, 三年级班, 1)
    赋值 (A, 0)
    .计次循环首 (三年级班, A)
        相减 (相加 (行数, A), 1).合并 (2, 1, 2)
        相减 (相加 (行数, A), 1).置文本 (2, 相加 (到文本 (A), “班”))
    .计次循环尾 ()
.如果真结束
.如果真 (不等于 (四年级班, 0))
    赋值 (行数, 相加 (取行数 (), 1))
    四年级班.添加行 ()
    .判断开始 (等于 (四年级班, 2))
        行数.置文本 (1, “ 四年级”)
    .判断 (等于 (四年级班, 3))
        行数.置文本 (1, “     四年级”)
    .判断 (大于 (四年级班, 3))
        行数.置文本 (1, “            四年级”)
    .默认
        行数.置文本 (1, “四年级 ”)
    .判断结束
    
    行数.合并 (1, 四年级班, 1)
    赋值 (A, 0)
    .计次循环首 (四年级班, A)
        相减 (相加 (行数, A), 1).合并 (2, 1, 2)
        相减 (相加 (行数, A), 1).置文本 (2, 相加 (到文本 (A), “班”))
    .计次循环尾 ()
.如果真结束
.如果真 (不等于 (五年级班, 0))
    赋值 (行数, 相加 (取行数 (), 1))
    五年级班.添加行 ()
    .判断开始 (等于 (五年级班, 2))
        行数.置文本 (1, “ 五年级”)
    .判断 (等于 (五年级班, 3))
        行数.置文本 (1, “     五年级”)
    .判断 (大于 (五年级班, 3))
        行数.置文本 (1, “            五年级”)
    .默认
        行数.置文本 (1, “五年级 ”)
    .判断结束
    行数.合并 (1, 五年级班, 1)
    赋值 (A, 0)
    .计次循环首 (五年级班, A)
        相减 (相加 (行数, A), 1).合并 (2, 1, 2)
        相减 (相加 (行数, A), 1).置文本 (2, 相加 (到文本 (A), “班”))
    .计次循环尾 ()
.如果真结束
.如果真 (不等于 (六年级班, 0))
    赋值 (行数, 相加 (取行数 (), 1))
    六年级班.添加行 ()
    .判断开始 (等于 (六年级班, 2))
        行数.置文本 (1, “ 六年级”)
    .判断 (等于 (六年级班, 3))
        行数.置文本 (1, “     六年级”)
    .判断 (大于 (六年级班, 3))
        行数.置文本 (1, “            六年级”)
    .默认
        行数.置文本 (1, “六年级 ”)
    .判断结束
    行数.合并 (1, 六年级班, 1)
    赋值 (A, 0)
    .计次循环首 (六年级班, A)
        相减 (相加 (行数, A), 1).合并 (2, 1, 2)
        相减 (相加 (行数, A), 1).置文本 (2, 相加 (到文本 (A), “班”))
    .计次循环尾 ()
.如果真结束

.如果 (等于 (是否加课, “0”))
    .判断开始 (等于 (每周天数, “5”))
        赋值 (列数, 相加 (取列数 (), 1))
        赋值 (行数, 相加 (取行数 (), 1))
        列数.插入列 (相加 (到数值 (上午), 到数值 (下午)))
        2.置文本 (列数, “星期一”)
        3.置文本 (列数, “上 午”)
        3.置文本 (相加 (列数, 到数值 (上午)), “下 午”)
        2.合并 (列数, 1, 相加 (到数值 (上午), 到数值 (下午)))
        3.合并 (列数, 1, 到数值 (上午))
        3.合并 (相加 (列数, 到数值 (上午)), 1, 到数值 (下午))
        
        赋值 (列数, 相加 (取列数 (), 1))
        赋值 (行数, 相加 (取行数 (), 1))
        列数.插入列 (相加 (到数值 (上午), 到数值 (下午)))
        2.置文本 (列数, “星期二”)
        3.置文本 (列数, “上 午”)
        3.置文本 (相加 (列数, 到数值 (上午)), “下 午”)
        2.合并 (列数, 1, 相加 (到数值 (上午), 到数值 (下午)))
        3.合并 (列数, 1, 到数值 (上午))
        3.合并 (相加 (列数, 到数值 (上午)), 1, 到数值 (下午))
        
        赋值 (列数, 相加 (取列数 (), 1))
        赋值 (行数, 相加 (取行数 (), 1))
        列数.插入列 (相加 (到数值 (上午), 到数值 (下午)))
        2.置文本 (列数, “星期三”)
        3.置文本 (列数, “上 午”)
        3.置文本 (相加 (列数, 到数值 (上午)), “下 午”)
        2.合并 (列数, 1, 相加 (到数值 (上午), 到数值 (下午)))
        3.合并 (列数, 1, 到数值 (上午))
        3.合并 (相加 (列数, 到数值 (上午)), 1, 到数值 (下午))
        
        赋值 (列数, 相加 (取列数 (), 1))
        赋值 (行数, 相加 (取行数 (), 1))
        列数.插入列 (相加 (到数值 (上午), 到数值 (下午)))
        2.置文本 (列数, “星期四”)
        3.置文本 (列数, “上 午”)
        3.置文本 (相加 (列数, 到数值 (上午)), “下 午”)
        2.合并 (列数, 1, 相加 (到数值 (上午), 到数值 (下午)))
        3.合并 (列数, 1, 到数值 (上午))
        3.合并 (相加 (列数, 到数值 (上午)), 1, 到数值 (下午))
        
        赋值 (列数, 相加 (取列数 (), 1))
        赋值 (行数, 相加 (取行数 (), 1))
        列数.插入列 (相加 (到数值 (上午), 到数值 (下午)))
        2.置文本 (列数, “星期五”)
        3.置文本 (列数, “上 午”)
        3.置文本 (相加 (列数, 到数值 (上午)), “下 午”)
        2.合并 (列数, 1, 相加 (到数值 (上午), 到数值 (下午)))
        3.合并 (列数, 1, 到数值 (上午))
        3.合并 (相加 (列数, 到数值 (上午)), 1, 到数值 (下午))
        
    .判断 (或者 (等于 (每周天数, “5.5”), 等于 (每周天数, “6”)))
        赋值 (列数, 相加 (取列数 (), 1))
        赋值 (行数, 相加 (取行数 (), 1))
        列数.插入列 (相加 (到数值 (上午), 到数值 (下午)))
        2.置文本 (列数, “星期一”)
        3.置文本 (列数, “上 午”)
        3.置文本 (相加 (列数, 到数值 (上午)), “下 午”)
        2.合并 (列数, 1, 相加 (到数值 (上午), 到数值 (下午)))
        3.合并 (列数, 1, 到数值 (上午))
        3.合并 (相加 (列数, 到数值 (上午)), 1, 到数值 (下午))
        
        赋值 (列数, 相加 (取列数 (), 1))
        赋值 (行数, 相加 (取行数 (), 1))
        列数.插入列 (相加 (到数值 (上午), 到数值 (下午)))
        2.置文本 (列数, “星期二”)
        3.置文本 (列数, “上 午”)
        3.置文本 (相加 (列数, 到数值 (上午)), “下 午”)
        2.合并 (列数, 1, 相加 (到数值 (上午), 到数值 (下午)))
        3.合并 (列数, 1, 到数值 (上午))
        3.合并 (相加 (列数, 到数值 (上午)), 1, 到数值 (下午))
        
        赋值 (列数, 相加 (取列数 (), 1))
        赋值 (行数, 相加 (取行数 (), 1))
        列数.插入列 (相加 (到数值 (上午), 到数值 (下午)))
        2.置文本 (列数, “星期三”)
        3.置文本 (列数, “上 午”)
        3.置文本 (相加 (列数, 到数值 (上午)), “下 午”)
        2.合并 (列数, 1, 相加 (到数值 (上午), 到数值 (下午)))
        3.合并 (列数, 1, 到数值 (上午))
        3.合并 (相加 (列数, 到数值 (上午)), 1, 到数值 (下午))
        
        赋值 (列数, 相加 (取列数 (), 1))
        赋值 (行数, 相加 (取行数 (), 1))
        列数.插入列 (相加 (到数值 (上午), 到数值 (下午)))
        2.置文本 (列数, “星期四”)
        3.置文本 (列数, “上 午”)
        3.置文本 (相加 (列数, 到数值 (上午)), “下 午”)
        2.合并 (列数, 1, 相加 (到数值 (上午), 到数值 (下午)))
        3.合并 (列数, 1, 到数值 (上午))
        3.合并 (相加 (列数, 到数值 (上午)), 1, 到数值 (下午))
        
        赋值 (列数, 相加 (取列数 (), 1))
        赋值 (行数, 相加 (取行数 (), 1))
        列数.插入列 (相加 (到数值 (上午), 到数值 (下午)))
        2.置文本 (列数, “星期五”)
        3.置文本 (列数, “上 午”)
        3.置文本 (相加 (列数, 到数值 (上午)), “下 午”)
        2.合并 (列数, 1, 相加 (到数值 (上午), 到数值 (下午)))
        3.合并 (列数, 1, 到数值 (上午))
        3.合并 (相加 (列数, 到数值 (上午)), 1, 到数值 (下午))
        
        赋值 (列数, 相加 (取列数 (), 1))
        赋值 (行数, 相加 (取行数 (), 1))
        列数.插入列 (相加 (到数值 (上午), 到数值 (下午)))
        2.置文本 (列数, “星期六”)
        3.置文本 (列数, “上 午”)
        .如果 (等于 (每周天数, “6”))
            3.置文本 (相加 (列数, 到数值 (上午)), “下 午”)
        .否则
            3.置文本 (相加 (列数, 到数值 (上午)), “休 息”)
        .如果结束
        2.合并 (列数, 1, 相加 (到数值 (上午), 到数值 (下午)))
        3.合并 (列数, 1, 到数值 (上午))
        3.合并 (相加 (列数, 到数值 (上午)), 1, 到数值 (下午))
        
    .判断 (等于 (每周天数, “7”))
        赋值 (列数, 相加 (取列数 (), 1))
        赋值 (行数, 相加 (取行数 (), 1))
        列数.插入列 (相加 (到数值 (上午), 到数值 (下午)))
        2.置文本 (列数, “星期一”)
        3.置文本 (列数, “上 午”)
        3.置文本 (相加 (列数, 到数值 (上午)), “下 午”)
        2.合并 (列数, 1, 相加 (到数值 (上午), 到数值 (下午)))
        3.合并 (列数, 1, 到数值 (上午))
        3.合并 (相加 (列数, 到数值 (上午)), 1, 到数值 (下午))
        
        赋值 (列数, 相加 (取列数 (), 1))
        赋值 (行数, 相加 (取行数 (), 1))
        列数.插入列 (相加 (到数值 (上午), 到数值 (下午)))
        2.置文本 (列数, “星期二”)
        3.置文本 (列数, “上 午”)
        3.置文本 (相加 (列数, 到数值 (上午)), “下 午”)
        2.合并 (列数, 1, 相加 (到数值 (上午), 到数值 (下午)))
        3.合并 (列数, 1, 到数值 (上午))
        3.合并 (相加 (列数, 到数值 (上午)), 1, 到数值 (下午))
        
        赋值 (列数, 相加 (取列数 (), 1))
        赋值 (行数, 相加 (取行数 (), 1))
        列数.插入列 (相加 (到数值 (上午), 到数值 (下午)))
        2.置文本 (列数, “星期三”)
        3.置文本 (列数, “上 午”)
        3.置文本 (相加 (列数, 到数值 (上午)), “下 午”)
        2.合并 (列数, 1, 相加 (到数值 (上午), 到数值 (下午)))
        3.合并 (列数, 1, 到数值 (上午))
        3.合并 (相加 (列数, 到数值 (上午)), 1, 到数值 (下午))
        
        赋值 (列数, 相加 (取列数 (), 1))
        赋值 (行数, 相加 (取行数 (), 1))
        列数.插入列 (相加 (到数值 (上午), 到数值 (下午)))
        2.置文本 (列数, “星期四”)
        3.置文本 (列数, “上 午”)
        3.置文本 (相加 (列数, 到数值 (上午)), “下 午”)
        2.合并 (列数, 1, 相加 (到数值 (上午), 到数值 (下午)))
        3.合并 (列数, 1, 到数值 (上午))
        3.合并 (相加 (列数, 到数值 (上午)), 1, 到数值 (下午))
        
        赋值 (列数, 相加 (取列数 (), 1))
        赋值 (行数, 相加 (取行数 (), 1))
        列数.插入列 (相加 (到数值 (上午), 到数值 (下午)))
        2.置文本 (列数, “星期五”)
        3.置文本 (列数, “上 午”)
        3.置文本 (相加 (列数, 到数值 (上午)), “下 午”)
        2.合并 (列数, 1, 相加 (到数值 (上午), 到数值 (下午)))
        3.合并 (列数, 1, 到数值 (上午))
        3.合并 (相加 (列数, 到数值 (上午)), 1, 到数值 (下午))
        
        赋值 (列数, 相加 (取列数 (), 1))
        赋值 (行数, 相加 (取行数 (), 1))
        列数.插入列 (相加 (到数值 (上午), 到数值 (下午)))
        2.置文本 (列数, “星期六”)
        3.置文本 (列数, “上 午”)
        3.置文本 (相加 (列数, 到数值 (上午)), “下 午”)
        2.合并 (列数, 1, 相加 (到数值 (上午), 到数值 (下午)))
        3.合并 (列数, 1, 到数值 (上午))
        3.合并 (相加 (列数, 到数值 (上午)), 1, 到数值 (下午))
        
        赋值 (列数, 相加 (取列数 (), 1))
        赋值 (行数, 相加 (取行数 (), 1))
        列数.插入列 (相加 (到数值 (上午), 到数值 (下午)))
        2.置文本 (列数, “星期日”)
        3.置文本 (列数, “上 午”)
        3.置文本 (相加 (列数, 到数值 (上午)), “下 午”)
        2.合并 (列数, 1, 相加 (到数值 (上午), 到数值 (下午)))
        3.合并 (列数, 1, 到数值 (上午))
        3.合并 (相加 (列数, 到数值 (上午)), 1, 到数值 (下午))
        
    .默认
        
    .判断结束
    
.否则
    
.如果结束
1.置行高 (取列数 (), 100)
1.合并 (1, 1, 取列数 ())

1.置字体属性 (1, 1, 1, #粗体)
1.置字体尺寸 (1, 1, 1, 60)

.如果 (.选中)
    4.置行高 (相减 (取行数 (), 3), 100)
.否则
    4.置行高 (相减 (取行数 (), 3), 160)
    
.如果结束
1.置列宽 (取列数 (), 70)
2.置字体尺寸 (4, 2, 取列数 (), 42)
2.置字体属性 (4, 2, 取列数 (), #粗体)
4.置字体属性 (1, 取行数 (), 2, #粗体)
1.置对齐方式 (1, 取行数 (), 取列数 (), #中中)
3.置表头行数 ()
.计次循环首 (相减 (取行数 (), 3), )
    赋值 (T, 相加 (T, 2))
    相加 (T, 3).置背景色 (2, 1, 相减 (取列数 (), 1), .颜色)
.计次循环尾 ()
2.置背景色 (1, 相减 (取行数 (), 1), 1, #银白)
2.置背景色 (2, 2, 相减 (取列数 (), 1), #银白)

1.置文本 (1, 相加 (校名, 到文本 (取年份 (取现行时间 ())), “年”, 当前学期, 取文本左边 (班级, 4), “课程表”))

.子程序 置打印机设置, 空白型, , 
.局部变量 设置信息, 打印设置信息, , , 
.局部变量 打印左边距, 整数型, , , 

赋值 (设置信息.上边距, 10)
赋值 (设置信息.下边距, 10)
赋值 (设置信息.左边距, 120)
赋值 (设置信息.右边距, 0)
赋值 (设置信息.纸张类型, #A4纸)
赋值 (设置信息.纸张方向, #横向)
赋值 (设置信息.自动添加表格线, 真)
赋值 (设置信息.自动填充, 真)
赋值 (设置信息.页号位置, #下右页号)
赋值 (设置信息.打印缩放比, 115)
设置信息.置打印设置 ()

.子程序 置打印机设置1, 空白型, , 
.局部变量 设置信息, 打印设置信息, , , 
.局部变量 打印左边距, 整数型, , , 

赋值 (设置信息.上边距, 10)
赋值 (设置信息.下边距, 10)
赋值 (设置信息.左边距, 10)
赋值 (设置信息.右边距, 0)
赋值 (设置信息.纸张类型, #A4纸)
赋值 (设置信息.纸张方向, #纵向)
赋值 (设置信息.自动添加表格线, 真)
赋值 (设置信息.自动填充, 假)
赋值 (设置信息.页号位置, #下右页号)
赋值 (设置信息.打印缩放比, #缩放到纸宽)
设置信息.置打印设置 ()

.子程序 _排课班级名组合框_列表项被选择, 空白型, , 
显示课目 ()

.子程序 自动排课, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 A, 整数型, , , 
.局部变量 课时, 整数型, , , 
.局部变量 科目, 文本型, , , 
.局部变量 科目成员, 文本型, , "0", 
.局部变量 主副课, 文本型, , , 
.局部变量 主副课成员, 文本型, , "0", 
.局部变量 老师, 文本型, , , 
.局部变量 老师成员, 文本型, , "0", 
.局部变量 课时成员, 整数型, , "0", 
.局部变量 T, 整数型, , , 
.局部变量 课程制, 文本型, , , 
.局部变量 R, 整数型, , , 
.局部变量 基本列, 整数型, , , 
.局部变量 基本行, 整数型, , , 
.局部变量 班级名, 文本型, , "0", 
.局部变量 匿名局部变量_8404, 空白型, , , 
.局部变量 N, 整数型, , , 

生成空课程表 ()
.如果真 (等于 (连接句柄, 0))
    信息框 (“没有连接到服务器！”, 0, )
    返回 ()
.如果真结束
.如果 (等于 (.内容, “”))
    赋值 (班级, “小学1年级1班”)
.否则
    赋值 (班级, .内容)
.如果结束

.计次循环首 (取项目数 (), A)
    .如果真 (等于 (取文本左边 (相减 (A, 1).取项目文本 (), 4), 取文本左边 (班级, 4)))
        加入成员 (班级名, 相减 (A, 1).取项目文本 ())
    .如果真结束
    
.计次循环尾 ()

.计次循环首 (取数组成员数 (班级名), N)
    赋值 (班级, “”)
    赋值 (班级, 班级名 [N])
    赋值 (总课时数, 0)
    .如果真 (等于 (班级, “”))
        跳出循环 ()
    .如果真结束
    置等待鼠标 ()
    .如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select * from system where bj like '%”, 班级, “%' ORDER BY bj ASC;”)), 假)) ' 导出记录
        返回 ()
    .如果真结束
    赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
    未知支持库函数_12 (记录集句柄)
    .计次循环首 (12, A)
        未知支持库函数_6 (记录集句柄, 相加 (“ks”, 到文本 (A)), 课时)
        赋值 (总课时数, 相加 (总课时数, 课时))
        加入成员 (课时成员, 课时)
    .计次循环尾 ()
    .如果真 (等于 (总课时数, 0))
        赋值 (总课时数, 30)
    .如果真结束
    
    赋值 (A, 0)
    未知支持库函数_12 (记录集句柄)
    .计次循环首 (12, A)
        未知支持库函数_6 (记录集句柄, 相加 (“km”, 到文本 (A)), 科目)
        加入成员 (科目成员, 科目)
    .计次循环尾 ()
    赋值 (A, 0)
    未知支持库函数_12 (记录集句柄)
    .计次循环首 (12, A)
        未知支持库函数_6 (记录集句柄, 相加 (“zf”, 到文本 (A)), 主副课)
        加入成员 (主副课成员, 主副课)
    .计次循环尾 ()
    赋值 (A, 0)
    未知支持库函数_12 (记录集句柄)
    .计次循环首 (12, A)
        未知支持库函数_6 (记录集句柄, 相加 (“ls”, 到文本 (A)), 老师)
        加入成员 (老师成员, 老师)
    .计次循环尾 ()
    未知支持库函数_6 (记录集句柄, “kcsj”, 课程制)
    .如果真 (等于 (课程制, “”))
        赋值 (课程制, “5”)
    .如果真结束
    未知支持库函数_5 (记录集句柄)
    赋值 (A, 0)
    
    赋值 (基本列, 3)
    赋值 (基本行, 相加 (3, N))
    赋值 (R, 0)
    .计次循环首 (取数组成员数 (科目成员), A)
        .计次循环首 (课时成员 [A], T)
            赋值 (R, 相加 (R, 1))
            .如果 (.选中)
                基本行.置文本 (相加 (基本列, R), 科目成员 [A])
            .否则
                基本行.置文本 (相加 (基本列, R), 老师成员 [A])
            .如果结束
            .如果真 (.选中)
                .判断开始 (等于 (A, 1))
                    基本行.置背景色 (相加 (基本列, R), 1, 1, 16769505)
                .判断 (等于 (A, 2))
                    基本行.置背景色 (相加 (基本列, R), 1, 1, 10210815)
                .判断 (等于 (A, 3))
                    基本行.置背景色 (相加 (基本列, R), 1, 1, 14145535)
                .判断 (等于 (A, 4))
                    基本行.置背景色 (相加 (基本列, R), 1, 1, #蓝灰)
                .判断 (等于 (A, 5))
                    基本行.置背景色 (相加 (基本列, R), 1, 1, 16763135)
                .判断 (等于 (A, 6))
                    基本行.置背景色 (相加 (基本列, R), 1, 1, 10478740)
                .判断 (等于 (A, 7))
                    基本行.置背景色 (相加 (基本列, R), 1, 1, 13565951)
                .判断 (等于 (A, 8))
                    基本行.置背景色 (相加 (基本列, R), 1, 1, 11461874)
                .判断 (等于 (A, 9))
                    基本行.置背景色 (相加 (基本列, R), 1, 1, 16761283)
                .判断 (等于 (A, 10))
                    基本行.置背景色 (相加 (基本列, R), 1, 1, 15987102)
                .判断 (等于 (A, 11))
                    基本行.置背景色 (相加 (基本列, R), 1, 1, 13030854)
                .判断 (等于 (A, 12))
                    基本行.置背景色 (相加 (基本列, R), 1, 1, 16772351)
                .默认
                    
                .判断结束
                
            .如果真结束
            
        .计次循环尾 ()
    .计次循环尾 ()
    清除数组 (老师成员)
    清除数组 (科目成员)
    清除数组 (课时成员)
    清除数组 (主副课成员)
    赋值 (课程制, “”)
    赋值 (基本列, 0)
.计次循环尾 ()
未知支持库函数_73 ()

.子程序 _颜色选择器1_颜色被改变, 空白型, , 
.局部变量 T, 整数型, , , 

.计次循环首 (相减 (取行数 (), 3), )
    赋值 (T, 相加 (T, 2))
    相加 (T, 3).置背景色 (2, 1, 相减 (取列数 (), 1), .颜色)
.计次循环尾 ()
.判断开始 (等于 (.颜色, 14675967))
    2.置背景色 (1, 相减 (取行数 (), 1), 1, #银白)
    2.置背景色 (2, 2, 相减 (取列数 (), 1), #银白)
.判断 (等于 (.颜色, #白色))
    2.置背景色 (1, 相减 (取行数 (), 1), 1, #白色)
    2.置背景色 (2, 2, 相减 (取列数 (), 1), #白色)
.默认
    2.置背景色 (1, 相减 (取行数 (), 1), 1, 15990760)
    2.置背景色 (2, 2, 相减 (取列数 (), 1), 15990760)
    
    
.判断结束



.子程序 _选择框1_被单击, 空白型, , 
赋值 (.选中, 真)
.如果 (.选中)
    赋值 (.标题, “显示教师”)
.否则
    赋值 (.标题, “显示课程”)
.如果结束
生成空课程表 ()
自动排课 ()
赋值 (记录A, 假)

.子程序 _选择框2_被单击, 空白型, , 
.局部变量 wb, 文本型, , "0", 

.如果真 (等于 (.选中, 真))
    载入 (管理员登录窗口, _启动窗口, 真)
    .如果真 (等于 (password, “”))
        返回 ()
    .如果真结束
    赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
    .如果真 (不等于 (取数组成员数 (wb), 20))
        信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
        返回 ()
    .如果真结束
    .如果真 (等于 (wb [7], “12”))
        信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
        返回 ()
    .如果真结束
    
.如果真结束

赋值 (.选中, 真)
.如果 (.选中)
    赋值 (.只读, 假)
    赋值 (.禁止, 假)
    赋值 (.标题, “显示模式”)
    0.置表头行数 ()
.否则
    赋值 (.只读, 真)
    赋值 (.禁止, 真)
    赋值 (.标题, “编辑模式”)
    3.置表头行数 ()
.如果结束
赋值 (选择项目, 0)
清除 ()

.子程序 _表格1_光标位置改变, 空白型, , 


.子程序 _按钮3_被单击, 空白型, , 
.如果 (.选中)
    置打印机设置 ()
.否则
    置打印机设置1 ()
.如果结束
打印预览 ()

.子程序 _表格1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

课目调换 ()

.子程序 _表格1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 A, 整数型, , , 
.局部变量 S, 整数型, , , 
.局部变量 N, 整数型, , , 

.如果真 (或者 (小于 (取光标行号 (), 4), 小于 (取光标列号 (), 4)))
    返回 ()
.如果真结束
.如果真 (等于 (.选中, 假))
    返回 ()
.如果真结束
.如果真 (等于 (.只读, 真))
    返回 ()
.如果真结束
连续赋值 (假, .可视, .可视, .可视)
.如果真 (大于 (取光标行号 (), 2))
    .如果真 (大于 (选择项目, 2))
        赋值 (选择项目, 0)
        取光标行号 ().置背景色 (4, 1, 相减 (取列数 (), 2), 取光标行号 ().取背景色 (2))
        返回 ()
    .如果真结束
    
    .判断开始 (等于 (选择项目, 0))
        清除数组 (背景色成员)
        .计次循环首 (相减 (取列数 (), 3), S)
            加入成员 (背景色成员, 取光标行号 ().取背景色 (相加 (S, 3)))
        .计次循环尾 ()
        
        .计次循环首 (取选择列数 (), A)
            加入成员 (单元格成员A, 取光标行号 ().取文本 (相减 (相加 (取光标列号 (), A), 1)))
            加入成员 (背景色成员A, 取光标行号 ().取背景色 (相减 (相加 (取光标列号 (), A), 1)))
        .计次循环尾 ()
        取光标行号 ().置背景色 (取光标列号 (), 1, 取选择列数 (), #绿色)
        赋值 (光标行A, 取光标行号 ())
        赋值 (光标列A, 取光标列号 ())
        赋值 (选择项目, 相加 (选择项目, 1))
        赋值 (横向A, 横向位置)
        赋值 (纵向A, 纵向位置)
        连续赋值 (真, .可视)
        相加 (横向A, 177).移动 (相加 (纵向A, 80), , )
        相加 (.左边, 8).移动 (相加 (.顶边, 24), 0, )
        .移动 (.左边, .顶边, , )
        
    .判断 (等于 (选择项目, 1))
        赋值 (光标行B, 取光标行号 ())
        赋值 (光标列B, 取光标列号 ())
        .如果真 (不等于 (光标行B, 光标行A))
            信息框 (“抱歉！不同班级将不允许进行课程互换！”, #信息图标, “错误！”)
            返回 ()
        .如果真结束
        
        .计次循环首 (取选择列数 (), A)
            加入成员 (单元格成员B, 取光标行号 ().取文本 (相减 (相加 (取光标列号 (), A), 1)))
            加入成员 (背景色成员B, 取光标行号 ().取背景色 (相减 (相加 (取光标列号 (), A), 1)))
        .计次循环尾 ()
        赋值 (选择项目, 相加 (选择项目, 1))
        
        .如果真 (不等于 (取数组成员数 (单元格成员B), 取数组成员数 (单元格成员A)))
            信息框 (“抱歉！您选择互换的课程数不正确！”, 0, )
            清除 ()
        .如果真结束
        延时 (500)
        
        赋值 (S, 0)
        .计次循环首 (取数组成员数 (背景色成员), S)
            取光标行号 ().置背景色 (相加 (3, S), 1, 1, 背景色成员 [S])
        .计次循环尾 ()
        课目调换 ()
    .默认
        
    .判断结束
    .如果 (小于 (选择项目, 2))
        赋值 (.只读, 假)
    .否则
        赋值 (.只读, 真)
    .如果结束
    
.如果真结束


.子程序 清除, 空白型, , 
.局部变量 S, 整数型, , , 

.如果 (.选中)
    .计次循环首 (取数组成员数 (背景色成员), S)
        取光标行号 ().置背景色 (相加 (3, S), 1, 1, 背景色成员 [S])
    .计次循环尾 ()
.否则
    取光标行号 ().置背景色 (4, 1, 相减 (取列数 (), 2), 取光标行号 ().取背景色 (2))
.如果结束
赋值 (选择项目, 0)
赋值 (.只读, 假)
清除数组 (单元格成员A)
清除数组 (单元格成员B)
清除数组 (背景色成员A)
清除数组 (背景色成员B)
 ' 清除数组 (背景色成员)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)

.子程序 课目调换, 空白型, , 
.局部变量 N, 整数型, , , 
.局部变量 S, 整数型, , , 

.如果真 (不等于 (光标行B, 光标行A))
    信息框 (“抱歉！不同的班级作无法课程互换！”, #信息图标, “错误！”)
.如果真结束
.如果真 (等于 (选择项目, 2))
    .计次循环首 (取数组成员数 (单元格成员A), N)
        光标行A.置文本 (相减 (相加 (光标列A, N), 1), 单元格成员B [N])
        光标行B.置文本 (相减 (相加 (光标列B, N), 1), 单元格成员A [N])
        光标行A.置背景色 (相减 (相加 (光标列A, N), 1), 1, 1, 背景色成员B [N])
        光标行B.置背景色 (相减 (相加 (光标列B, N), 1), 1, 1, 背景色成员A [N])
    .计次循环尾 ()
    清除数组 (背景色成员)
    .计次循环首 (相减 (取列数 (), 3), S)
        加入成员 (背景色成员, 取光标行号 ().取背景色 (相加 (S, 3)))
    .计次循环尾 ()
.如果真结束
清除 ()

.子程序 _表格1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (.选中, 假))
    返回 ()
.如果真结束
.如果真 (或者 (小于或等于 (取光标行号 (), 3), 小于或等于 (取光标列号 (), 3)))
    返回 ()
.如果真结束
.如果真 (等于 (选择项目, 1))
    相加 (横向位置, 177).移动 (.顶边, , )
    .如果 (大于 (横向位置, 横向A))
        相加 (.左边, 8).移动 (相加 (.顶边, 24), 相减 (横向位置, 横向A), )
    .否则
        相加 (.左边, 8).移动 (相加 (.顶边, 24), 相减 (横向A, 横向位置), )
    .如果结束
    连续赋值 (真, .可视, .可视, .可视)
.如果真结束




.子程序 _按钮5_被单击, 空白型, , 
.局部变量 文件, 字节集, , , 
.局部变量 数据, 文本型, , , 
.局部变量 条件, 文本型, , , 
.局部变量 匿名局部变量_8876, 空白型, , , 
.局部变量 时间, 文本型, , , 
.局部变量 学期, 文本型, , , 
.局部变量 错误, 文本型, , , 

保存更改 ()
赋值 (文件, 存到字节集 ())
.如果 (小于或等于 (取月份 (取现行时间 ()), 8))
    赋值 (学期, “上学期”)
.否则
    赋值 (学期, “下学期”)
.如果结束

.如果 (等于 (课程表位置, “”))
    赋值 (时间, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 学期))
.否则
    赋值 (时间, 课程表位置)
.如果结束

赋值 (数据, 相加 (“xxlx='”, 取文本左边 (班级, 4), “',nfxq='”, 时间, “'”))

.如果 (取数据库重复记录 (连接句柄, “kcb”, “nfxq”, 时间))
    .如果真 (等于 (未知支持库函数_46 (连接句柄, “kcb”, “kcb”, 相加 (“nfxq='”, 时间, “'”), 文件), 假))
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (相加 (“错误！-”, 错误), 0, )
        返回 ()
    .如果真结束
    
.否则
    .如果 (等于 (未知支持库函数_18 (连接句柄, “kcb”, 数据), 假))
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (相加 (“错误！-”, 错误), 0, )
        返回 ()
    .否则
        .如果真 (等于 (未知支持库函数_46 (连接句柄, “kcb”, “kcb”, 相加 (“nfxq='”, 时间, “'”), 文件), 假))
            未知支持库函数_41 (连接句柄, 错误)
            信息框 (相加 (“错误！-”, 错误), 0, )
            返回 ()
        .如果真结束
        
    .如果结束
    
.如果结束

赋值 (记录日志, 相加 (“增加”, 时间, “记录完成”))
写日志 ()
显示课程表 ()
信息框 (相加 (“保存”, 课程表位置, “课程表模板文件完成！”), #信息图标, “保存文件”)

.子程序 _科目列表框1_当前表项被改变, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 表项, 整数型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 条件, 文本型, , , 
.局部变量 图片变量, 字节集, , , 

.如果真 (等于 (连接句柄, 0))
    信息框 (“没有连接到服务器！”, 0, )
    返回 ()
.如果真结束
置等待鼠标 ()
赋值 (.选中, 真)
赋值 (条件, .取标题 (., 0))
赋值 (课程表位置, 条件)
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select nfxq,kcb from kcb where nfxq like '%”, 条件, “%' ORDER BY nfxq ASC;”)), 假)) ' 导出记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
未知支持库函数_6 (记录集句柄, “kcb”, 图片变量)
未知支持库函数_5 (记录集句柄)
0.初始尺寸 (0)
图片变量.从字节集读 ()
未知支持库函数_73 ()
赋值 (记录A, 假)

.子程序 _删除按钮_被单击, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 表项, 整数型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 条件, 文本型, , , 
.局部变量 图片变量, 字节集, , , 
.局部变量 错误, 文本型, , , 

.如果真 (等于 (连接句柄, 0))
    信息框 (“没有连接到服务器！”, 0, )
    返回 ()
.如果真结束
置等待鼠标 ()
赋值 (条件, .取标题 (., 0))
.如果真 (等于 (条件, “”))
    信息框 (“没有选择删除条件！”, 0, )
    返回 ()
.如果真结束
.如果 (未知支持库函数_20 (连接句柄, “kcb”, 相加 (“nfxq='”, 条件, “'”)))
    赋值 (记录日志, 相加 (“删除”, 条件, “记录完成”))
    写日志 ()
    信息框 (“删除课程表文件完成！”, #信息图标, “删除文件”)
    显示课程表 ()
    
.否则
    未知支持库函数_41 (连接句柄, 错误)
    信息框 (相加 (“删除错误！-”, 错误), 0, )
    返回 ()
    
.如果结束








.子程序 _色彩选择_被单击, 空白型, , 
.局部变量 文件, 字节集, , , 
.局部变量 T, 整数型, , , 
.局部变量 S, 整数型, , , 

保存更改 ()
赋值 (文件, 存到字节集 ())
.如果真 (等于 (记录A, 假))
    删除文件 (相加 (取运行目录 (), “\sql\lswj.ttr”))
    .如果真 (写到文件 (相加 (取运行目录 (), “\sql\lswj.ttr”), 文件))
        赋值 (记录A, 真)
    .如果真结束
    
.如果真结束

.如果 (.选中)
    赋值 (.禁止, 真)
    赋值 (., 真)
    .如果 (相加 (取运行目录 (), “\sql\lswj.ttr”).从文件读 ())
        刷新显示 ()
    .否则
        信息框 (“打开模板文件失败！”, #信息图标, “打开文件”)
    .如果结束
    
.否则
    赋值 (.禁止, 假)
    赋值 (., 假)
    .计次循环首 (相减 (取行数 (), 3), S)
        相加 (S, 3).置背景色 (2, 1, 相减 (取列数 (), 1), #白色)
    .计次循环尾 ()
    .计次循环首 (相减 (取行数 (), 3), )
        赋值 (T, 相加 (T, 2))
        相加 (T, 3).置背景色 (2, 1, 相减 (取列数 (), 1), .颜色)
    .计次循环尾 ()
    
.如果结束


.子程序 _超级按钮_被单击, 空白型, , 
赋值 (.颜色, 14675967)
_颜色选择器1_颜色被改变 ()

.窗口程序集 窗口程序集2, , , 

.子程序 _自设毕业窗口_创建完毕, 空白型, , 
未知支持库函数_0 (风格类型)

.窗口程序集 日志窗口程序集, , , 

.子程序 _日志_创建完毕, 空白型, , 
赋值 (.时钟周期, 100)

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 wb, 文本型, , "0", 

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (等于 (取数组成员数 (wb), 20))
    .如果真 (等于 (wb [17], “33”))
        .如果真 (未知支持库函数_20 (连接句柄, “rzjl”, “”))
            全部删除 ()
            信息框 (“删除完成！”, 0, )
        .如果真结束
        返回 ()
    .如果真结束
    
.如果真结束
信息框 (相加 (“    权限问题！”, #换行符, #换行符, “您没有删除日志的权限！！！ 有问题请系”, #换行符, “统管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)


.子程序 _时钟1_周期事件, 空白型, , 
.局部变量 时间, 小数型, , , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 

赋值 (.时钟周期, 0)
全部删除 ()
赋值 (时间, 相除 (取启动时间 (), 1000, 60, 60))
.插入表项 ()
0.置图片 (66)
0.置标题 (相加 (“主机名：”, 取主机名 ()))
.插入表项 ()
1.置图片 (83)
1.置标题 (相加 (“主机IP：”, 转换为IP地址 (取主机名 ())))
.插入表项 ()
2.置图片 (293)
2.置标题 (相加 (“当前日期：”, 时间到文本 (取现行时间 (), #日期部分)))
.插入表项 ()
3.置图片 (244)
3.置标题 (相加 (“本电脑已连续运行：”, 到文本 (取整 (时间)), “小时”, 到文本 (四舍五入 (相乘 (相减 (时间, 取整 (时间)), 60), 0)), “分钟”))
.如果 (不等于 (连接句柄, 0))
    未知支持库函数_3 (连接句柄, “select * from rzjl”)
    赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
.否则
    返回 ()
.如果结束
未知支持库函数_12 (记录集句柄)
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
.计次循环首 (记录数, 列)
    置等待鼠标 ()
    未知支持库函数_15 (记录集句柄, 相减 (列, 1), 字段名)
    未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
    .插入表项 ()
    相加 (列, 3).置图片 (284)
    相加 (列, 3).置标题 (文本变量)
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
赋值 (.内容, 相加 (“日志记录：”, 到文本 (相减 (取表项数 (), 4)), “ 条。”))
恢复鼠标 ()

.子程序 _按钮3_被单击, 空白型, , 
赋值 (.时钟周期, 100)

.程序集 打印程序集, , , 

.子程序 打印学籍卡, 空白型, , 
填学籍卡 ()
赋值 (打印设置, _启动窗口.取打印设置 (.))
设置打印 (1, 2, 200, 200, 150, 200, -1)
_启动窗口.置打印设置 (., 打印设置)

.子程序 设置打印, 空白型, , 
.参数 纸张方向, 整数型, 可空, 
.参数 纸张类型, 整数型, 可空, 
.参数 左边距, 整数型, 可空, 
.参数 右边距, 整数型, 可空, 
.参数 上边距, 整数型, 可空, 
.参数 下边距, 整数型, 可空, 
.参数 打印缩放比, 整数型, 可空, 

赋值 (打印设置.纸张方向, 纸张方向)
赋值 (打印设置.纸张类型, 纸张类型)
赋值 (打印设置.左边距, 左边距)
赋值 (打印设置.右边距, 右边距)
赋值 (打印设置.上边距, 上边距)
赋值 (打印设置.下边距, 下边距)
赋值 (打印设置.打印缩放比, 打印缩放比)


.子程序 填学籍卡, 空白型, , 
.如果 (并且 (等于 (_启动窗口..标题, “”), 等于 (_启动窗口..标题, “”), 等于 (_启动窗口..标题, “”)))
    _启动窗口.置文本 (., 1, 1, 相加 (_启动窗口..标题, “学籍表”))
    返回 ()
.否则
    _启动窗口.置文本 (., 1, 1, _启动窗口..标题)
.如果结束
_启动窗口.置文本 (., 2, 12, 时间到文本 (取现行时间 (), #日期部分))
_启动窗口.置文本 (., 3, 2, _启动窗口..标题)
_启动窗口.置文本 (., 3, 8, _启动窗口..标题)
_启动窗口.置文本 (., 4, 2, _启动窗口..标题)
_启动窗口.置文本 (., 4, 8, _启动窗口..标题)
_启动窗口.置文本 (., 5, 2, _启动窗口..标题)
_启动窗口.置文本 (., 5, 8, _启动窗口..标题)
_启动窗口.置文本 (., 6, 2, _启动窗口..标题)
_启动窗口.置文本 (., 6, 8, _启动窗口..标题)
_启动窗口.置文本 (., 7, 2, _启动窗口..标题)
_启动窗口.置文本 (., 7, 8, _启动窗口..标题)
_启动窗口.置文本 (., 8, 2, _启动窗口..标题)
_启动窗口.置文本 (., 8, 8, _启动窗口..标题)
_启动窗口.置文本 (., 9, 1, _启动窗口..标题)
_启动窗口.置文本 (., 9, 2, _启动窗口..标题)
_启动窗口.置文本 (., 9, 4, _启动窗口..标题)
_启动窗口.置文本 (., 9, 10, _启动窗口..标题)
_启动窗口.置文本 (., 10, 1, _启动窗口..标题)
_启动窗口.置文本 (., 10, 2, _启动窗口..标题)
_启动窗口.置文本 (., 10, 4, _启动窗口..标题)
_启动窗口.置文本 (., 10, 10, _启动窗口..标题)
_启动窗口.置文本 (., 16, 1, _启动窗口..内容)
_启动窗口.置数据 (., 3, 12, _启动窗口..图片)
_启动窗口.置文本 (., 12, 2, _启动窗口..标题)
_启动窗口.置文本 (., 12, 3, _启动窗口..标题)
_启动窗口.置文本 (., 12, 4, _启动窗口..标题)
_启动窗口.置文本 (., 12, 5, _启动窗口..标题)
_启动窗口.置文本 (., 12, 6, _启动窗口..标题)
_启动窗口.置文本 (., 12, 8, _启动窗口..标题)
_启动窗口.置文本 (., 12, 9, _启动窗口..标题)
_启动窗口.置文本 (., 12, 10, _启动窗口..标题)
_启动窗口.置文本 (., 12, 11, _启动窗口..标题)
_启动窗口.置文本 (., 12, 13, _启动窗口..标题)

_启动窗口.置文本 (., 13, 2, _启动窗口..标题)
_启动窗口.置文本 (., 13, 3, _启动窗口..标题)
_启动窗口.置文本 (., 13, 4, _启动窗口..标题)
_启动窗口.置文本 (., 13, 5, _启动窗口..标题)
_启动窗口.置文本 (., 13, 6, _启动窗口..标题)
_启动窗口.置文本 (., 13, 8, _启动窗口..标题)
_启动窗口.置文本 (., 13, 9, _启动窗口..标题)
_启动窗口.置文本 (., 13, 10, _启动窗口..标题)
_启动窗口.置文本 (., 13, 11, _启动窗口..标题)
_启动窗口.置文本 (., 13, 13, _启动窗口..标题)
_启动窗口.置文本 (., 14, 2, _启动窗口..标题)
_启动窗口.置文本 (., 14, 3, _启动窗口..标题)
_启动窗口.置文本 (., 14, 4, _启动窗口..标题)
_启动窗口.置文本 (., 14, 5, _启动窗口..标题)
_启动窗口.置文本 (., 14, 6, _启动窗口..标题)
_启动窗口.置文本 (., 14, 8, _启动窗口..标题)
_启动窗口.置文本 (., 14, 9, _启动窗口..标题)
_启动窗口.置文本 (., 14, 10, _启动窗口..标题)
_启动窗口.置文本 (., 14, 11, _启动窗口..标题)
_启动窗口.置文本 (., 14, 13, _启动窗口..标题)
_启动窗口.置文本 (., 16, 8, _启动窗口..标题)
.如果 (等于 (学生分类, “在校学生”))
    _启动窗口.置文本 (., 2, 1, “班主任：”)
    _启动窗口.置文本 (., 2, 2, _启动窗口..标题)
.否则
    _启动窗口.置文本 (., 2, 1, “”)
    _启动窗口.打印数据源.置文本 (2, 2, “”) 
    
.如果结束


.子程序 打印学生花名册, 空白型, , 
.参数 打印列表框, 超级列表框, , 
.参数 打印标题, 文本型, 可空, 
.参数 打印副标题, 文本型, 可空, 可写入如打印时间等

.局部变量 计次, 整数型, , , 
.局部变量 次数, 整数型, , , 

置等待鼠标 ()
_启动窗口.初始尺寸 (., 0, 0)
_启动窗口.添加行 (., 3)
_启动窗口.插入列 (., 1, 9)
_启动窗口.置列宽 (., 1, 2, 240)
_启动窗口.置列宽 (., 3, 1, 140)
_启动窗口.置列宽 (., 4, 1, 240)
_启动窗口.置列宽 (., 5, 2, 300)
_启动窗口.置列宽 (., 7, 3, 360)
_启动窗口.合并 (., 1, 1, 1, 9)
_启动窗口.合并 (., 2, 1, 1, 7)
_启动窗口.置行高 (., 1, 1, 180)
_启动窗口.置行高 (., 3, 1, 80)
_启动窗口.置对齐方式 (., 1, 1, 3, 9, #中中)
_启动窗口.置对齐方式 (., 2, 1, 1, 7, #中左)
_启动窗口.置对齐方式 (., 2, 8, 1, 1, #中右)
_启动窗口.置字体名 (., 1, 1, 1, 1, “楷体_GB2312”)
_启动窗口.置字体尺寸 (., 1, 1, 1, 1, 80)
_启动窗口.置字体属性 (., 1, 1, 3, 11, #粗体)
_启动窗口.置文本 (., 1, 1, 打印标题)
_启动窗口.置文本 (., 2, 1, 打印副标题)
_启动窗口.置文本 (., 2, 8, “打印日期：”)
_启动窗口.置文本 (., 2, 9, 时间到文本 (取现行时间 (), #日期部分))
.计次循环首 (打印列表框.取列数 (), 计次)
    _启动窗口.置文本 (., 3, 计次, 打印列表框.取列标题 (计次))
.计次循环尾 ()
_启动窗口.置表头行数 (., 3)
.计次循环首 (打印列表框.取表项数 (), 计次)
    _启动窗口.添加行 (., 1)
    .计次循环首 (打印列表框.取列数 (), 次数)
        _启动窗口.置文本 (., 相加 (计次, 3), 次数, 打印列表框.取标题 (相减 (计次, 1), 次数))
    .计次循环尾 ()
.计次循环尾 ()

_启动窗口.加线条 (., 3, 1, 相加 (_启动窗口.取行数 (.), 1), 9, 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))
_启动窗口.置行高 (., 4, 相减 (_启动窗口.取行数 (.), 3), 70)
_启动窗口.置对齐方式 (., 4, 1, 相减 (_启动窗口.取行数 (.), 3), 9, #中中)
赋值 (打印设置, _启动窗口.取打印设置 (.))
设置打印 (1, 2, 200, 200, 150, 220, -1)
赋值 (打印设置.每页打印行数, 0)
赋值 (打印设置.页号位置, 6)
赋值 (打印设置.自动填充, 真)
_启动窗口.置打印设置 (., 打印设置)
恢复鼠标 ()

.子程序 打印成绩表, 空白型, , 
置等待鼠标 ()
_启动窗口.初始尺寸 (., 0, 0)
_启动窗口.添加行 (., 2)
_启动窗口.插入列 (., 1, 12)
_启动窗口.合并 (., 1, 1, 1, 12)
_启动窗口.合并 (., 2, 9, 1, 2)
_启动窗口.合并 (., 2, 11, 1, 2)
_启动窗口.置行高 (., 1, 1, 150)
_启动窗口.置行高 (., 2, 1, 60)
_启动窗口.置列宽 (., 1, 2, 220)
_启动窗口.置列宽 (., 3, 10, 213)
_启动窗口.置文本 (., 1, 1, 相加 (_启动窗口..标题, _启动窗口.取项目文本 (., _启动窗口..现行选中项), _启动窗口.取项目文本 (., _启动窗口..现行选中项), “表”))
_启动窗口.置字体属性 (., 1, 1, 1, 1, 1)
_启动窗口.置字体尺寸 (., 1, 1, 1, 1, 80)
_启动窗口.置字体名 (., 1, 1, 1, 1, “楷体_GB2312”)
_启动窗口.置对齐方式 (., 1, 1, 1, 1, #中中)
_启动窗口.置对齐方式 (., 2, 9, 1, 1, #中右)
_启动窗口.置对齐方式 (., 2, 11, 1, 1, #中左)
_启动窗口.置文本 (., 2, 9, “打印日期：”)
_启动窗口.置文本 (., 2, 11, 时间到文本 (取现行时间 (), 2))
_启动窗口.添加 (., _启动窗口., , )
_启动窗口.加线条 (., 3, 1, _启动窗口.取行数 (.), _启动窗口.取列数 (.), 相加 (1, 2, 4, 8, 16, 32))
_启动窗口.置背景色 (., 1, 1, _启动窗口.取行数 (.), _启动窗口.取列数 (.), #白色)
_启动窗口.置表头行数 (., 3)

赋值 (打印设置, _启动窗口.取打印设置 (.))
设置打印 (1, 2, 200, 200, 150, 220, -1)
赋值 (打印设置.每页打印行数, 0)
赋值 (打印设置.页号位置, 6)
赋值 (打印设置.自动填充, 真)
_启动窗口.置打印设置 (., 打印设置)
恢复鼠标 ()

.子程序 打印统计表, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 次数, 整数型, , , 

置等待鼠标 ()
_启动窗口.初始尺寸 (., 0, 0)
_启动窗口.添加行 (., 3)
_启动窗口.插入列 (., 1, 12)
_启动窗口.置列宽 (., 1, 1, 360)
_启动窗口.置列宽 (., 2, 11, 200)
_启动窗口.合并 (., 1, 1, 1, 12)
_启动窗口.合并 (., 2, 9, 1, 2)
_启动窗口.合并 (., 2, 11, 1, 2)
_启动窗口.置行高 (., 1, 1, 180)
_启动窗口.置行高 (., 3, 1, 80)
_启动窗口.置对齐方式 (., 1, 1, 3, 12, #中中)
_启动窗口.置对齐方式 (., 2, 11, 1, 1, #中左)
_启动窗口.置对齐方式 (., 2, 9, 1, 1, #中右)
_启动窗口.置字体名 (., 1, 1, 1, 1, “楷体_GB2312”)
_启动窗口.置字体尺寸 (., 1, 1, 1, 1, 80)
_启动窗口.置字体属性 (., 1, 1, 3, 12, #粗体)

_启动窗口.置文本 (., 1, 1, _启动窗口..标题)
_启动窗口.置文本 (., 2, 9, “打印日期：”)
_启动窗口.置文本 (., 2, 11, 时间到文本 (取现行时间 (), #日期部分))

.计次循环首 (_启动窗口.取列数 (.), 计次)
    _启动窗口.置文本 (., 3, 计次, _启动窗口.取列标题 (., 计次))
.计次循环尾 ()
_启动窗口.置表头行数 (., 3)
.计次循环首 (_启动窗口.取表项数 (.), 计次)
    _启动窗口.添加行 (., 1)
    .计次循环首 (_启动窗口.取列数 (.), 次数)
        _启动窗口.置文本 (., 相加 (计次, 3), 次数, _启动窗口.取标题 (., 相减 (计次, 1), 次数))
    .计次循环尾 ()
.计次循环尾 ()


_启动窗口.加线条 (., 3, 1, 相加 (_启动窗口.取行数 (.), 1), 12, 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))
_启动窗口.置行高 (., 4, 相减 (_启动窗口.取行数 (.), 3), 70)
_启动窗口.置对齐方式 (., 4, 1, 相减 (_启动窗口.取行数 (.), 3), 12, #中中)
赋值 (打印设置, _启动窗口.取打印设置 (.))
设置打印 (1, 2, 200, 200, 150, 220, -1)
赋值 (打印设置.每页打印行数, 0)
赋值 (打印设置.页号位置, 6)
赋值 (打印设置.自动填充, 真)
_启动窗口.置打印设置 (., 打印设置)
恢复鼠标 ()


.子程序 打印教员卡, 空白型, , 
置等待鼠标 ()
填教员卡 ()
赋值 (打印设置, _启动窗口.取打印设置 (.))
设置打印 (1, 2, 200, 200, 150, 200, -1)
_启动窗口.置打印设置 (., 打印设置)
恢复鼠标 ()

.子程序 填教员卡, 空白型, , 
.如果 (并且 (等于 (_启动窗口.取表项数 (.), 0), 等于 (_启动窗口..标题, “”), 等于 (_启动窗口..标题, “”)))
    _启动窗口.置文本 (., 1, 1, 相加 (_启动窗口..标题, “教员登记表表”))
    返回 ()
.否则
    _启动窗口.置文本 (., 1, 1, _启动窗口..标题)
.如果结束
_启动窗口.置文本 (., 2, 5, “打印时间：”)
_启动窗口.置文本 (., 2, 6, 时间到文本 (取现行时间 (), 2))
_启动窗口.置文本 (., 3, 2, _启动窗口..标题)
_启动窗口.置文本 (., 3, 5, _启动窗口..标题)
_启动窗口.置文本 (., 4, 2, _启动窗口..标题)
_启动窗口.置文本 (., 4, 5, _启动窗口..标题)
_启动窗口.置文本 (., 5, 2, _启动窗口..标题)
_启动窗口.置文本 (., 5, 5, _启动窗口..标题)
_启动窗口.置文本 (., 6, 2, _启动窗口..标题)
_启动窗口.置文本 (., 6, 5, _启动窗口..标题)
_启动窗口.置文本 (., 7, 2, _启动窗口..标题)
_启动窗口.置文本 (., 7, 5, _启动窗口..标题)
_启动窗口.置文本 (., 8, 2, _启动窗口..标题)
_启动窗口.置文本 (., 8, 5, _启动窗口..标题)
_启动窗口.置文本 (., 9, 2, _启动窗口..标题)
_启动窗口.置文本 (., 9, 5, _启动窗口..标题)
_启动窗口.置文本 (., 10, 2, _启动窗口..标题)
_启动窗口.置文本 (., 10, 5, _启动窗口..标题)
_启动窗口.置文本 (., 13, 1, _启动窗口..内容)
_启动窗口.置数据 (., 3, 6, _启动窗口..图片)
_启动窗口.置文本 (., 13, 5, _启动窗口..标题)


.子程序 打印教员花名册, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 次数, 整数型, , , 

_启动窗口.初始尺寸 (., 0, 0)
_启动窗口.添加行 (., 3)
_启动窗口.插入列 (., 1, 9)
_启动窗口.置列宽 (., 1, 1, 240)
_启动窗口.置列宽 (., 2, 1, 140)
_启动窗口.置列宽 (., 3, 2, 240)
_启动窗口.置列宽 (., 5, 2, 300)
_启动窗口.置列宽 (., 7, 3, 360)
_启动窗口.合并 (., 1, 1, 1, 10)
_启动窗口.置行高 (., 1, 1, 180)
_启动窗口.置行高 (., 2, 2, 80)
_启动窗口.置对齐方式 (., 1, 1, 3, 9, #中中)
_启动窗口.置对齐方式 (., 2, 8, 1, 1, #中右)
_启动窗口.置对齐方式 (., 2, 9, 1, 1, #中左)
_启动窗口.置字体名 (., 1, 1, 1, 1, “楷体_GB2312”)
_启动窗口.置字体尺寸 (., 1, 1, 1, 1, 80)
_启动窗口.置字体属性 (., 1, 1, 3, 9, #粗体)
_启动窗口.置文本 (., 1, 1, _启动窗口..标题)
_启动窗口.置文本 (., 2, 8, “打印日期：”)
_启动窗口.置文本 (., 2, 9, 时间到文本 (取现行时间 (), #日期部分))
.计次循环首 (_启动窗口.取列数 (.), 计次)
    _启动窗口.置文本 (., 3, 计次, _启动窗口.取列标题 (., 计次))
.计次循环尾 ()
_启动窗口.置表头行数 (., 3)
.计次循环首 (_启动窗口.取表项数 (.), 计次)
    _启动窗口.添加行 (., 1)
    .计次循环首 (_启动窗口.取列数 (.), 次数)
        _启动窗口.置文本 (., 相加 (计次, 3), 次数, _启动窗口.取标题 (., 相减 (计次, 1), 次数))
    .计次循环尾 ()
.计次循环尾 ()
_启动窗口.置行高 (., 4, 相减 (_启动窗口.取行数 (.), 3), 70)
_启动窗口.置对齐方式 (., 4, 1, 相减 (_启动窗口.取行数 (.), 3), 10, #中中)
_启动窗口.加线条 (., 3, 1, 相加 (_启动窗口.取行数 (.), 1), 10, 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))
赋值 (打印设置, _启动窗口.取打印设置 (.))
设置打印 (1, 2, 200, 200, 150, 150, -1)
赋值 (打印设置.每页打印行数, 0)
赋值 (打印设置.页号位置, 6)
赋值 (打印设置.自动填充, 真)
_启动窗口.置打印设置 (., 打印设置)

.子程序 打印工资表, 空白型, , 
_启动窗口.初始尺寸 (., 0, 0)
_启动窗口.添加行 (., 2)
_启动窗口.插入列 (., 1, 12)
_启动窗口.合并 (., 1, 1, 1, 12)
_启动窗口.置行高 (., 1, 1, 150)
_启动窗口.置行高 (., 2, 1, 60)
_启动窗口.置列宽 (., 1, 12, 相除 (_启动窗口., 4.2))
_启动窗口.置列宽 (., 1, 1, 150)
_启动窗口.置列宽 (., 12, 1, 260)

_启动窗口.置文本 (., 1, 1, _启动窗口..标题)
_启动窗口.置字体属性 (., 1, 1, 1, 1, 1)
_启动窗口.置字体尺寸 (., 1, 1, 1, 1, 80)
_启动窗口.置字体名 (., 1, 1, 1, 1, “楷体_GB2312”)
_启动窗口.置对齐方式 (., 1, 1, 1, 1, #中中)
_启动窗口.置文本 (., 2, 1, “制表：”)
_启动窗口.置文本 (., 2, 3, “会计：”)
_启动窗口.置文本 (., 2, 5, “出纳：”)

_启动窗口.置文本 (., 2, 12, _启动窗口..内容)
_启动窗口.添加 (., _启动窗口., , )
_启动窗口.置背景色 (., 1, 1, _启动窗口.取行数 (.), _启动窗口.取列数 (.), #白色)
_启动窗口.加线条 (., 3, 1, _启动窗口.取行数 (.), _启动窗口.取列数 (.), 相加 (1, 2, 4, 8, 16, 32))
_启动窗口.置表头行数 (., 4)

赋值 (打印设置, _启动窗口.取打印设置 (.))
设置打印 (1, 2, 120, 120, 50, 80, -1)
赋值 (打印设置.每页打印行数, 0)
赋值 (打印设置.页号位置, 6)
赋值 (打印设置.自动填充, 假)
_启动窗口.置打印设置 (., 打印设置)

.窗口程序集 权限结构窗口程序集, , , 

.程序集变量 权限值, 文本型, , , 
.子程序 _关闭按钮_被单击, 空白型, , 
销毁 ()

.子程序 _清空按钮_被单击, 空白型, , 
连续赋值 (假, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中)

.子程序 _权限结构窗口_创建完毕, 空白型, , 
.局部变量 错误, 文本型, , , 

赋值 (连接句柄, 未知支持库函数_1 (读配置项 (相加 (取当前目录 (), “\myfial.ini”), “setup”, “net”, ), 文本解密 (读配置项 (相加 (取当前目录 (), “\myfial.ini”), “setup”, “yhyy2”, ), “Ntmdbzdb”), 文本解密 (读配置项 (相加 (取当前目录 (), “\myfial.ini”), “setup”, “WD”, ), “Ntmdbzdb”), “”, 3306))
.如果真 (等于 (连接句柄, 0))
    信息框 (相加 (“连接MySql失败，原因：0001”, 错误), 0, )
    返回 ()
.如果真结束
_启动窗口.置文本 (., 0, “ 连接服务器成功！”)
赋值 (_启动窗口..时钟周期, 500)
取用户 ()


.子程序 取用户, 空白型, , 
.局部变量 错误, 文本型, , , 
.局部变量 记录句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本, 文本型, , , 
.局部变量 B, 整数型, , , 
.局部变量 项目, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 A, 整数型, , , 
.局部变量 用户, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 文本量, 文本型, , , 

.如果真 (等于 (连接句柄, 0))
    返回 ()
.如果真结束
.如果真 (等于 (未知支持库函数_37 (连接句柄), 假))
    未知支持库函数_41 (连接句柄, 错误)
    信息框 (相加 (“error!”, 错误), 0, )
    返回 ()
.如果真结束
赋值 (记录句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录句柄))
赋值 (字段数, 未知支持库函数_14 (记录句柄))
赋值 (.内容, 相加 (“现有用户数量”, 到文本 (记录数), “位”))
全部删除 ()
未知支持库函数_12 (记录句柄)
.计次循环首 (记录数, B)
    赋值 (项目, -1.插入表项 ())
    未知支持库函数_15 (记录句柄, 0, 字段名)
    未知支持库函数_6 (记录句柄, 字段名, 文本)
    项目.置标题 (4, 文本)
    未知支持库函数_15 (记录句柄, 1, 字段名)
    未知支持库函数_6 (记录句柄, 字段名, 文本)
    项目.置标题 (1, 文本)
    未知支持库函数_15 (记录句柄, 2, 字段名)
    未知支持库函数_6 (记录句柄, 字段名, 文本)
    项目.置标题 (2, 文本)
    项目.置图片 (0, 254)
    项目.置标题 (0, 到文本 (B))
    未知支持库函数_10 (记录句柄)
.计次循环尾 ()
未知支持库函数_5 (记录句柄)
未知支持库函数_3 (连接句柄, “use huangpu;”)
.计次循环首 (取表项数 (), A)
    置等待鼠标 ()
    连续赋值 (“”, 文本变量, 文本量)
    赋值 (用户, 相减 (A, 1).取标题 (1))
    未知支持库函数_3 (连接句柄, 相加 (“select * from sqlmy where yhID like '%”, 用户, “%';”))
    赋值 (记录句柄, 未知支持库函数_4 (连接句柄))
    未知支持库函数_6 (记录句柄, “yhlx”, 文本变量)
    .如果真 (等于 (文本变量, “”))
        赋值 (文本变量, “远程用户”)
    .如果真结束
    相减 (A, 1).置标题 (3, 文本变量)
    未知支持库函数_6 (记录句柄, “dlxx”, 文本量)
    相减 (A, 1).置标题 (5, 文本量)
.计次循环尾 ()
未知支持库函数_5 (记录句柄)
恢复鼠标 ()



.子程序 _用户列表框_当前表项被改变, 空白型, , 
.局部变量 用户, 文本型, , , 
.局部变量 记录句柄, 整数型, , , 
.局部变量 wb, 文本型, , , 
.局部变量 错误, 文本型, , , 
.局部变量 权值, 文本型, , "0", 
.局部变量 R, 整数型, , , 

.如果 (大于或等于 (., 0))
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.如果结束
赋值 (用户, .取标题 (., 1))
赋值 (.内容, .取标题 (., 4))
赋值 (.内容, 用户)
_清空按钮_被单击 ()
.如果真 (等于 (用户, “”))
    返回 ()
.如果真结束
检查连接 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select * from sqlmy where yhID like '%”, 用户, “%';”)), 假))
    提示错误 ()
    返回 ()
.如果真结束
赋值 (记录句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录句柄)
未知支持库函数_6 (记录句柄, “dlxx”, wb)
未知支持库函数_5 (记录句柄)
.如果真 (等于 (wb, “”))
    返回 ()
.如果真结束
赋值 (权值, 分割文本 (文本解密 (wb, “lz的cxntmdg8ygd”), “.”, ))
赋值 (R, 0)
.计次循环首 (取数组成员数 (权值), R)
    .如果真 (等于 (权值 [R], “01”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (权值 [R], “03”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (权值 [R], “05”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (权值 [R], “07”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (权值 [R], “09”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (权值 [R], “11”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (权值 [R], “13”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (权值 [R], “15”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (权值 [R], “17”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (权值 [R], “19”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (权值 [R], “21”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (权值 [R], “23”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (权值 [R], “25”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (权值 [R], “27”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (权值 [R], “29”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (权值 [R], “31”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (权值 [R], “33”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (权值 [R], “35”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (权值 [R], “37”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (权值 [R], “39”))
        赋值 (.选中, 真)
    .如果真结束
    
.计次循环尾 ()

.子程序 _增加按钮_被单击, 空白型, , 
.局部变量 权限, 整数型, , , 
.局部变量 登录, 文本型, , , 
.局部变量 错误, 文本型, , , 
.局部变量 登录域内容, 文本型, , , 

检查连接 ()
.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“ 抱歉！请您输入用户名或登录域名。”, 0, “错误！”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“ 抱歉！请您输入密码！”, 0, “错误！”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (小于或等于 (取文本长度 (.内容), 3))
    信息框 (“ 抱歉！请您输入密码位太少，密码位在4-16之间！”, 0, “错误！”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (不等于 (.内容, .内容))
    信息框 (“ 抱歉！您输入两组密码不相同，请重新输入！”, 0, “错误！”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果 (等于 (.内容, “localhost”))
    赋值 (登录域内容, “%”)
.否则
    赋值 (登录域内容, .内容)
.如果结束
.如果真 (未知支持库函数_36 (连接句柄, .内容, 登录域内容))
    信息框 (“ 抱歉！您输入用户名已经在数据库中使用，请重新输入！”, 0, “错误！”)
    获取焦点 ()
    返回 ()
.如果真结束
 ' 判断 (查看1.选中 ＝ 真 或 查看3.选中 ＝ 真 或 查看4.选中 ＝ 真 且 查看5.选中 ＝ 假 且 查看6.选中 ＝ 假 且 查看8.选中 ＝ 假 且 查看9.选中 ＝ 假 且 查看10.选中 ＝ 假 且 查看11.选中 ＝ 假)
 ' 权限 ＝ #查询权限 ＋ #查询权限

.判断开始 (或者 (等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真)))
    赋值 (权限, 255)
.默认
    赋值 (权限, 255)
.判断结束
取权限状态 ()
.如果真 (等于 (权限值, “”))
    信息框 (相加 (“创建用户”, .内容, “失败！原因： 权限值”), 0, )
    返回 ()
.如果真结束
.如果真 (未知支持库函数_34 (连接句柄, 登录域内容, .内容, .内容, “huangpu”, “*”, 权限))
    .如果真 (未知支持库函数_18 (连接句柄, “sqlmy”, 相加 (“yhID='”, .内容, “',dly='”, .内容, “',yhlx='本地用户',dlxx='”, 权限值, “'”)))
        赋值 (记录日志, 相加 (“创建用户:”, .内容, “完成”))
        写日志 ()
        取用户 ()
        信息框 (相加 (“创建用户:”, .内容, “完成！”), 0, )
        返回 ()
    .如果真结束
    
.如果真结束
未知支持库函数_41 (连接句柄, 错误)
信息框 (相加 (“创建用户”, .内容, “失败！原因：”, 错误), 0, )


.子程序 取权限状态, 空白型, , 
.局部变量 权限状态, 文本型, , "0", 
.局部变量 I, 整数型, , , 
.局部变量 权限状态值, 文本型, , , 
.局部变量 权限数量, 整数型, , , 

赋值 (权限数量, 20)
重定义数组 (权限状态, 假, 权限数量)
.如果 (等于 (.选中, 假))
    赋值 (权限状态 [1], “00”)
.否则
    赋值 (权限状态 [1], “01”)
.如果结束
.如果 (等于 (.选中, 假))
    赋值 (权限状态 [2], “02”)
.否则
    赋值 (权限状态 [2], “03”)
.如果结束
.如果 (等于 (.选中, 假))
    赋值 (权限状态 [3], “04”)
.否则
    赋值 (权限状态 [3], “05”)
.如果结束
.如果 (等于 (.选中, 假))
    赋值 (权限状态 [4], “06”)
.否则
    赋值 (权限状态 [4], “07”)
.如果结束
.如果 (等于 (.选中, 假))
    赋值 (权限状态 [5], “08”)
.否则
    赋值 (权限状态 [5], “09”)
.如果结束
.如果 (等于 (.选中, 假))
    赋值 (权限状态 [6], “10”)
.否则
    赋值 (权限状态 [6], “11”)
.如果结束
.如果 (等于 (.选中, 假))
    赋值 (权限状态 [7], “12”)
.否则
    赋值 (权限状态 [7], “13”)
.如果结束
.如果 (等于 (.选中, 假))
    赋值 (权限状态 [8], “14”)
.否则
    赋值 (权限状态 [8], “15”)
.如果结束
.如果 (等于 (.选中, 假))
    赋值 (权限状态 [9], “16”)
.否则
    赋值 (权限状态 [9], “17”)
.如果结束
.如果 (等于 (.选中, 假))
    赋值 (权限状态 [10], “18”)
.否则
    赋值 (权限状态 [10], “19”)
.如果结束
.如果 (等于 (.选中, 假))
    赋值 (权限状态 [11], “20”)
.否则
    赋值 (权限状态 [11], “21”)
.如果结束
.如果 (等于 (.选中, 假))
    赋值 (权限状态 [12], “22”)
.否则
    赋值 (权限状态 [12], “23”)
.如果结束
.如果 (等于 (.选中, 假))
    赋值 (权限状态 [13], “24”)
.否则
    赋值 (权限状态 [13], “25”)
.如果结束
.如果 (等于 (.选中, 假))
    赋值 (权限状态 [14], “26”)
.否则
    赋值 (权限状态 [14], “27”)
.如果结束
.如果 (等于 (.选中, 假))
    赋值 (权限状态 [15], “28”)
.否则
    赋值 (权限状态 [15], “29”)
.如果结束
.如果 (等于 (.选中, 假))
    赋值 (权限状态 [16], “30”)
.否则
    赋值 (权限状态 [16], “31”)
.如果结束
.如果 (等于 (.选中, 假))
    赋值 (权限状态 [17], “32”)
.否则
    赋值 (权限状态 [17], “33”)
.如果结束
.如果 (等于 (.选中, 假))
    赋值 (权限状态 [18], “34”)
.否则
    赋值 (权限状态 [18], “35”)
.如果结束
.如果 (等于 (.选中, 假))
    赋值 (权限状态 [19], “36”)
.否则
    赋值 (权限状态 [19], “37”)
.如果结束
.如果 (等于 (.选中, 假))
    赋值 (权限状态 [20], “38”)
.否则
    赋值 (权限状态 [20], “39”)
.如果结束
.计次循环首 (权限数量, I)
    赋值 (权限状态值, 相加 (权限状态值, “.”, 权限状态 [I]))
.计次循环尾 ()
赋值 (权限状态值, 取文本右边 (权限状态值, 相减 (取文本长度 (权限状态值), 1)))
赋值 (权限值, 文本加密 (权限状态值, “lz的cxntmdg8ygd”))

.子程序 _修改按钮_被单击, 空白型, , 
.局部变量 权限, 文本型, , , 
.局部变量 登录, 文本型, , , 
.局部变量 错误, 文本型, , , 
.局部变量 登录域内容, 文本型, , , 
.局部变量 密码, 文本型, , , 
.局部变量 用户, 文本型, , , 

检查连接 ()
.如果真 (不等于 (信息框 (“  是否修改该用户登录信息？不作修改请按取消键！”, 相加 (#确认取消钮, #警告图标), “修改警告！”), #确认钮))
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“ 抱歉！请您输入用户名或登录域名。”, 0, “错误！”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“ 抱歉！请您输入密码！”, 0, “错误！”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (小于或等于 (取文本长度 (.内容), 3))
    信息框 (“ 抱歉！请您输入密码位太少，密码位在4-16之间！”, 0, “错误！”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (不等于 (.内容, .内容))
    信息框 (“ 抱歉！您输入两组密码不相同，请重新输入！”, 0, “错误！”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果 (等于 (.内容, “localhost”))
    赋值 (登录域内容, “%”)
.否则
    赋值 (登录域内容, .内容)
.如果结束

.如果真 (或者 (等于 (.选中, 真), 等于 (.选中, 真), 并且 (等于 (.选中, 真), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假))))
    赋值 (权限, “select_priv='Y',Insert_priv='N',update_priv='N',delete_priv='N',Create_priv='N',Drop_priv='N',Reload_priv='N',Shutdown_priv='N',Process_priv='N',File_priv='N',grant_priv='Y',References_priv='N',Index_priv='N',Alter_priv='N',Show_db_priv='N',Super_priv='N',Create_tmp_table_priv='N',Lock_tables_priv='N',Execute_priv='N',Repl_client_priv='N'”)
    .如果真 (或者 (等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真)))
        赋值 (权限, “select_priv='Y',Insert_priv='Y',update_priv='Y',delete_priv='Y',Create_priv='N',Drop_priv='N',Reload_priv='N',Shutdown_priv='N',Process_priv='N',File_priv='N',grant_priv='N',References_priv='N',Index_priv='N',Alter_priv='N',Show_db_priv='N',Super_priv='N',Create_tmp_table_priv='N',Lock_tables_priv='N',Execute_priv='N',Repl_client_priv='N'”)
    .如果真结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    赋值 (权限, “select_priv='Y',Insert_priv='Y',update_priv='Y',delete_priv='Y',Create_priv='Y',Drop_priv='Y',Reload_priv='Y',Shutdown_priv='Y',Process_priv='Y',File_priv='Y',grant_priv='Y',References_priv='Y',Index_priv='Y',Alter_priv='Y',Show_db_priv='N',Super_priv='N',Create_tmp_table_priv='N',Lock_tables_priv='N',Execute_priv='N',Repl_client_priv='N'”)
.如果真结束
.如果真 (并且 (等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假)))
    赋值 (权限, “select_priv='N',Insert_priv='N',update_priv='N',delete_priv='N',Create_priv='N',Drop_priv='N',Reload_priv='N',Shutdown_priv='N',Process_priv='N',File_priv='N',grant_priv='Y',References_priv='N',Index_priv='N',Alter_priv='N',Show_db_priv='N',Super_priv='N',Create_tmp_table_priv='N',Lock_tables_priv='N',Execute_priv='N',Repl_client_priv='N'”)
    
.如果真结束




取权限状态 ()
.如果真 (等于 (权限值, “”))
    信息框 (相加 (“创建用户”, .内容, “失败！原因： 权限值”), 0, )
    返回 ()
.如果真结束
.如果真 (未知支持库函数_38 (连接句柄, 登录域内容, .内容, “huangpu”, “*”, 255))
    未知支持库函数_3 (连接句柄, “use mysql;”)
    赋值 (密码, .内容)
    赋值 (用户, .内容)
    .如果真 (未知支持库函数_3 (连接句柄, 相加 (“UPDATE user SET Password=PASSWORD('”, 密码, “') WHERE user='”, 用户, “';”)))
        未知支持库函数_3 (连接句柄, 相加 (“UPDATE user SET ”, 权限, “ WHERE user='”, 用户, “';”))
        未知支持库函数_3 (连接句柄, “FLUSH PRIVILEGES;”)
        未知支持库函数_3 (连接句柄, “use huangpu;”)
        .如果 (取数据库重复记录 (连接句柄, “sqlmy”, “yhID”, 用户))
            .如果真 (未知支持库函数_19 (连接句柄, “sqlmy”, 相加 (“dly='”, .内容, “',yhlx='本地用户',dlxx='”, 权限值, “'”), 相加 (“yhID='”, 用户, “'”)))
                赋值 (记录日志, 相加 (“修改用户:”, 用户, “完成”))
                写日志 ()
                取用户 ()
                信息框 (相加 (“修改用户:”, 用户, “完成！”), 0, )
                赋值 (.禁止, 真)
                赋值 (.禁止, 真)
                返回 ()
            .如果真结束
            
        .否则
            .如果真 (未知支持库函数_18 (连接句柄, “sqlmy”, 相加 (“yhID='”, 用户, “',dly='”, .内容, “',yhlx='本地用户',dlxx='”, 权限值, “'”)))
                赋值 (记录日志, 相加 (“修改用户:”, 用户, “完成”))
                写日志 ()
                取用户 ()
                信息框 (相加 (“修改用户:”, 用户, “完成！”), 0, )
                赋值 (.禁止, 真)
                赋值 (.禁止, 真)
                返回 ()
                
            .如果真结束
            
        .如果结束
        
    .如果真结束
    未知支持库函数_3 (连接句柄, “use huangpu;”)
.如果真结束
未知支持库函数_41 (连接句柄, 错误)
信息框 (相加 (“修改用户”, .内容, “失败！原因：”, 错误), 0, )

.子程序 _删除按钮_被单击, 空白型, , 
.局部变量 错误, 文本型, , , 

检查连接 ()
.如果真 (等于 (.内容, “admin”))
    信息框 (“ 抱歉！ADMIN 是主管理员身份,请不要删除,您可以修改它的密码！”, #警告图标, “警告！！”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (不等于 (信息框 (“  是否删除该用户登录信息？不作修改请按取消键！”, 相加 (#确认取消钮, #警告图标), “删除警告！”), #确认钮))
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“ 抱歉！请您输入用户名或登录域名。”, 0, “错误！”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (未知支持库函数_35 (连接句柄, .内容, .内容))
    .如果真 (未知支持库函数_20 (连接句柄, “sqlmy”, 相加 (“yhID='”, .内容, “'”)))
        赋值 (记录日志, 相加 (“删除用户:”, .内容, “完成”))
        写日志 ()
        取用户 ()
        信息框 (相加 (“删除用户:”, .内容, “完成！”), 0, )
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
        返回 ()
    .如果真结束
    
.如果真结束
未知支持库函数_41 (连接句柄, 错误)
信息框 (相加 (“删除用户”, .内容, “失败！原因：”, 错误), 0, )


.子程序 _权限结构窗口_将被销毁, 空白型, , 
未知支持库函数_2 (连接句柄)
赋值 (连接句柄, 未知支持库函数_1 (读配置项 (相加 (取当前目录 (), “\myfial.ini”), “setup”, “net”, ), 文本解密 (读配置项 (相加 (取当前目录 (), “\myfial.ini”), “setup”, “yhyy2”, ), “Ntmdbzdb”), 文本解密 (读配置项 (相加 (取当前目录 (), “\myfial.ini”), “setup”, “WD”, ), “Ntmdbzdb”), “huangpu”, 3306))
.如果真 (等于 (连接句柄, 0))
    _启动窗口.置文本 (., 0, “ 连接服务器断开！”)
    赋值 (_启动窗口..时钟周期, 0)
    信息框 (“连接MySql失败，原因：0001”, 0, )
    返回 ()
.如果真结束


.子程序 _全选按钮_被单击, 空白型, , 
连续赋值 (真, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中)


.窗口程序集 管理员登录窗口程序集, , , 

.程序集变量 CI, 整数型, , , 
.子程序 _管理员登录窗口_创建完毕, 空白型, , 
找ID库 ()
赋值 (.时钟周期, 300)
赋值 (password, “”)
赋值 (CI, 0)

.子程序 _时钟_周期事件, 空白型, , 
.判断开始 (等于 (.内容, “■ □ □ □ □ □ □ □”))
    赋值 (.内容, “□ ■ □ □ □ □ □ □”)
.判断 (等于 (.内容, “□ ■ □ □ □ □ □ □”))
    赋值 (.内容, “□ □ ■ □ □ □ □ □”)
.判断 (等于 (.内容, “□ □ ■ □ □ □ □ □”))
    赋值 (.内容, “□ □ □ ■ □ □ □ □”)
.判断 (等于 (.内容, “□ □ □ ■ □ □ □ □”))
    赋值 (.内容, “□ □ □ □ ■ □ □ □”)
.判断 (等于 (.内容, “□ □ □ □ ■ □ □ □”))
    赋值 (.内容, “□ □ □ □ □ ■ □ □”)
.判断 (等于 (.内容, “□ □ □ □ □ ■ □ □”))
    赋值 (.内容, “□ □ □ □ □ □ ■ □”)
.判断 (等于 (.内容, “□ □ □ □ □ □ ■ □”))
    赋值 (.内容, “□ □ □ □ □ □ □ ■”)
.判断 (等于 (.内容, “□ □ □ □ □ □ □ ■”))
    赋值 (.内容, “■ □ □ □ □ □ □ □”)
.默认
    
.判断结束


.子程序 _关闭按钮_被单击, 空白型, , 
赋值 (password, “”)
销毁 ()

.子程序 找ID库, 空白型, , 
.局部变量 记忆位, 整数型, , , 

.如果真 (等于 (打开 (相加 (取运行目录 (), “\sql\sysmm.edb”), , , , , , ), 假))
    返回 ()
.如果真结束
到首记录 ()
.如果真 (等于 (读 (5), 真))
    赋值 (.选中, 真)
    .计次循环首 (取记录数 (), )
        .如果真 (不等于 (读 (6), “”))
            读 (6).加入项目 ()
            赋值 (记忆位, 到数值 (读 (4)))
        .如果真结束
        跳过 ()
    .计次循环尾 ()
    赋值 (.现行选中项, 读配置项 (相加 (取当前目录 (), “\myfial.ini”), “setup”, “SJSMC”, ).选择 ())
.如果真结束
关闭 (相加 (取运行目录 (), “\sql\sysmm.edb”))

.子程序 _选择框1_被单击, 空白型, , 
.如果真 (等于 (打开 (相加 (取运行目录 (), “\sql\sysmm.edb”), , , , , , ), 假))
    返回 ()
.如果真结束
到首记录 ()
.如果 (.选中)
    修改 (真, )
.否则
    清空 ()
    加空记录 ()
.如果结束
关闭 (相加 (取运行目录 (), “\sql\sysmm.edb”))


.子程序 _登录按钮_被单击, 空白型, , 
.局部变量 用户, 文本型, , , 
.局部变量 记录句柄, 整数型, , , 
.局部变量 密码, 文本型, , , 

赋值 (用户, .内容)
赋值 (密码, .内容)
.如果真 (等于 (用户, “”))
    赋值 (password, “”)
    返回 ()
.如果真结束
检查连接 ()
未知支持库函数_3 (连接句柄, “use mysql;”)
.如果 (取数据库重复记录 (连接句柄, “user”, “user”, 用户))
    未知支持库函数_3 (连接句柄, “use huangpu;”)
    .如果真 (等于 (等于 (密码, 文本解密 (读配置项 (相加 (取当前目录 (), “\myfial.ini”), “setup”, “WD”, ), “Ntmdbzdb”)), 假))
        赋值 (password, “”)
        赋值 (CI, 相加 (CI, 1))
        信息框 (相加 (“    登录失败！”, #换行符, #换行符, “您所提供的用户名或密码不正确，若有问题请与管理员联系！”, #换行符, #换行符, “    您还有 ”, 到文本 (相减 (3, CI)), “ 次机会！”), #错误图标, “ 权限错误！”)
        .如果真 (大于或等于 (CI, 3))
            赋值 (CI, 0)
            销毁 ()
        .如果真结束
        返回 ()
    .如果真结束
    
.否则
    赋值 (password, “”)
    赋值 (CI, 相加 (CI, 1))
    信息框 (相加 (“    登录失败！”, #换行符, #换行符, “您所提供的用户名或密码不正确，若有问题请与管理员联系！”, #换行符, #换行符, “    您还有 ”, 到文本 (相减 (3, CI)), “ 次机会！”), #错误图标, “ 权限错误！”)
    .如果真 (大于或等于 (CI, 3))
        赋值 (CI, 0)
        销毁 ()
    .如果真结束
    返回 ()
.如果结束
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select * from sqlmy where yhID like '%”, 用户, “%';”)), 假))
    提示错误 ()
    赋值 (password, “”)
    返回 ()
.如果真结束
赋值 (记录句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录句柄)
未知支持库函数_6 (记录句柄, “dlxx”, password)
未知支持库函数_5 (记录句柄)
写配置项 (相加 (取当前目录 (), “\myfial.ini”), “setup”, “SJSMC”, 用户)
写配置项 (相加 (取当前目录 (), “\myfial.ini”), “setup”, “WD”, 文本加密 (.内容, “Ntmdbzdb”))
销毁 ()

.窗口程序集 卡机设置窗口程序集, , , 

.程序集变量 设备联接句柄, 整数型, , , 
.子程序 _卡机设置管理_创建完毕, 空白型, , 
赋值 (风格类型, 到数值 (读配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “Style”, )))
未知支持库函数_0 (风格类型)
赋值 (端口句柄, 打开端口 (1, 19200))
赋值 (设备联接句柄, 打开联接设备 (2, 9600, 1))
赋值 (., 相加 (., 到文本 (端口句柄), “|”, 到文本 (设备联接句柄)))
关闭端口句柄 (端口句柄)
刷新D表 ()
赋值 (.现行子夹, 1)

.子程序 _按钮3_被单击, 空白型, , 
.局部变量 条件, 文本型, , , 

.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“没有输入机号或机名称!”, 0, )
    返回 ()
.如果真结束
检查连接 ()
.如果真 (取数据库重复记录 (连接句柄, “skjb”, “kh”, .内容))
    信息框 (“机号重复,请更换其它卡机!”, 0, )
    返回 ()
.如果真结束
赋值 (条件, 相加 (“kh='”, .内容, “',kjm='”, .内容, “',dk='”, .内容, “',sd='”, .内容, “',kjlx='”, .内容, “',bb='”, .内容, “'”))
.如果真 (等于 (未知支持库函数_18 (连接句柄, “skjb”, 条件), 假))
    提示错误 ()
    返回 ()
.如果真结束
赋值 (记录日志, 相加 (“增加刷卡机”, .内容))
写日志 ()
刷新D表 ()

.子程序 刷新D表, 空白型, , 
.局部变量 记录句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 A, 整数型, , , 
.局部变量 B, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 

检查连接 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, “select * from skjb ORDER BY kh ASC;”), 假))
    提示错误 ()
    返回 ()
.如果真结束
赋值 (记录句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录句柄))
赋值 (字段数, 未知支持库函数_14 (记录句柄))
未知支持库函数_12 (记录句柄)
全部删除 ()
.计次循环首 (记录数, )
    赋值 (A, -1.插入表项 ())
    .计次循环首 (字段数, B)
        未知支持库函数_15 (记录句柄, 相减 (B, 1), 字段名)
        未知支持库函数_6 (记录句柄, 字段名, 文本变量)
        A.置标题 (相减 (B, 1), 文本变量)
    .计次循环尾 ()
    未知支持库函数_10 (记录句柄)
    A.置图片 (0, 93)
    处理事件 ()
.计次循环尾 ()
未知支持库函数_5 (记录句柄)


.子程序 _超级列表框1_当前表项被改变, 空白型, , 
.局部变量 卡机, 文本型, , , 
.局部变量 记录句柄, 整数型, , , 
.局部变量 文本变量, 文本型, , , 

检查连接 ()
赋值 (卡机, .取标题 (., 0))
.如果真 (等于 (卡机, “”))
    返回 ()
.如果真结束
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select * from skjb where kh='”, 卡机, “' ORDER BY kh ASC;”)), 假))
    提示错误 ()
    返回 ()
.如果真结束
赋值 (记录句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录句柄)
未知支持库函数_6 (记录句柄, “kh”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录句柄, “kjm”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录句柄, “dk”, 文本变量)
文本变量.选择 ()
未知支持库函数_6 (记录句柄, “sd”, 文本变量)
文本变量.选择 ()
未知支持库函数_6 (记录句柄, “kjlx”, 文本变量)
文本变量.选择 ()
未知支持库函数_6 (记录句柄, “bb”, 文本变量)
文本变量.选择 ()
未知支持库函数_5 (记录句柄)
赋值 (., 相加 (“卡机设置管理 - 当前选择卡机号:”, 卡机))

.子程序 _按钮4_被单击, 空白型, , 
.局部变量 条件, 文本型, , , 

.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“没有输入机号或机名称!”, 0, )
    返回 ()
.如果真结束
检查连接 ()
赋值 (条件, 相加 (“kjm='”, .内容, “',dk='”, .内容, “',sd='”, .内容, “',kjlx='”, .内容, “',bb='”, .内容, “'”))
.如果真 (等于 (未知支持库函数_19 (连接句柄, “skjb”, 条件, 相加 (“kh='”, .内容, “'”)), 假))
    提示错误 ()
    返回 ()
.如果真结束
赋值 (记录日志, 相加 (“更新刷卡机”, .内容))
写日志 ()
刷新D表 ()

.子程序 _按钮5_被单击, 空白型, , 
.局部变量 卡机, 文本型, , , 

检查连接 ()
赋值 (卡机, .取标题 (., 0))
.如果真 (等于 (卡机, “”))
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“ 是否删除当前选择的机号?”, 相加 (#确认取消钮, #询问图标), “ 删除警告!”), #取消钮))
    返回 ()
.如果真结束
.如果真 (等于 (未知支持库函数_20 (连接句柄, “skjh”, 相加 (“kh='”, .内容, “'”)), 假))
    提示错误 ()
    返回 ()
.如果真结束
赋值 (记录日志, 相加 (“删除刷卡机”, .内容))
写日志 ()
刷新D表 ()


.窗口程序集 毕业升级管理程序集, , , 

.子程序 _毕业升级管理_创建完毕, 空白型, , 
填充班级 ()
填充升级姓名 ()
打开升级列表 ()
打开分班列表 ()
设置背景 (相加 (取运行目录 (), “\1.jpg”), )
设置背景 (相加 (取运行目录 (), “\1.jpg”), )
.判断开始 (等于 (处理类型, 1))
    赋值 (.现行子夹, 0)
    赋值 (.标题, 相加 (“毕业升级分班管理-”, 1.取子夹名称 ()))
.判断 (等于 (处理类型, 2))
    赋值 (.现行子夹, 3)
    打开表1 ()
    赋值 (.标题, 相加 (“毕业升级分班管理-”, 4.取子夹名称 ()))
    
.默认
    
.判断结束
当前学期.选择 ()


.子程序 填充班级, 空白型, , 
.局部变量 A, 整数型, , , 
.局部变量 班, 文本型, , "0", 

.如果真 (等于 (填充班级名称 (), 假))
    返回 ()
.如果真结束
填充班级名称 ()
“(所有学生)”.加入项目 ()
.计次循环首 (取项目数 (), A)
    赋值 (班, 分割文本 (相减 (A, 0).取项目文本 (), “级”, ))
    .如果真 (大于或等于 (取数组成员数 (班), 2))
        .如果真 (等于 (班.选择 ( [1]), -1))
            相加 (班 [1], “级”).加入项目 ()
            相加 (班 [1], “级”).加入项目 ()
            相加 (班 [1], “级”).加入项目 ()
            相加 (班 [1], “级”).加入项目 ()
        .如果真结束
        
    .如果真结束
    
.计次循环尾 ()
“小学1年级1班”.选择 ()
“小学2年级”.选择 ()
“小学1年级”.选择 ()
相加 (取文本左边 (.内容, 9), “1班”).选择 ()
“小学2年级”.选择 ()
“小学1年级”.选择 ()

.子程序 _组合框1_列表项被选择, 空白型, , 
填充升级姓名 ()
.如果 (或者 (等于 (取文本左边 (.内容, 9), “小学6年级”), 等于 (取文本左边 (.内容, 9), “初中3年级”), 等于 (取文本左边 (.内容, 9), “高中3年级”)))
    赋值 (.选中, 真)
    赋值 (.禁止, 假)
.否则
    赋值 (.选中, 假)
    赋值 (.禁止, 真)
.如果结束


.子程序 填充升级姓名, 空白型, , 填充升级姓名表
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 行, 整数型, , , 
.局部变量 表项数, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 

置等待鼠标 ()
全部删除 ()
全部删除 ()
检查连接 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select xh,xm,xb,kh,zxxz,szbj from xsda where szbj like '%”, .内容, “%' and zxxz like '%在校学生%' ORDER BY xh ASC;”)), 假)) ' 导出记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (字段数, 未知支持库函数_14 (记录集句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
.计次循环首 (记录数, 行)
    置等待鼠标 ()
    赋值 (表项数, -1.插入表项 ())
    赋值 (文本变量, “”)
    未知支持库函数_6 (记录集句柄, “xh”, 文本变量)
    .如果真 (不等于 (文本变量, “”))
        表项数.置标题 (0, 文本变量)
    .如果真结束
    未知支持库函数_6 (记录集句柄, “xm”, 文本变量)
    .如果真 (不等于 (文本变量, “”))
        表项数.置标题 (1, 文本变量)
    .如果真结束
    未知支持库函数_6 (记录集句柄, “xb”, 文本变量)
    .如果真 (不等于 (文本变量, “”))
        表项数.置标题 (3, 文本变量)
    .如果真结束
    未知支持库函数_6 (记录集句柄, “kh”, 文本变量)
    .如果真 (不等于 (文本变量, “”))
        表项数.置标题 (2, 文本变量)
    .如果真结束
    表项数.置图片 (0, 135)
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
赋值 (.标题, 相加 (“本班共有学生”, 到文本 (取表项数 ()), “名”))
赋值 (.标题, 相加 (“本班升级”, 到文本 (取表项数 ()), “名,留级0名”))
恢复鼠标 ()
刷新显示 ()
刷新显示 ()
.如果 (等于 (取表项数 (), 0))
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
.如果结束
.如果 (等于 (取表项数 (), 0))
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
.如果结束


.子程序 _升级列表框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 表项数, 整数型, , , 

.如果真 (等于 (.取标题 (., 0), “”))
    返回 ()
.如果真结束
赋值 (表项数, -1.插入表项 ())
表项数.置标题 (0, .取标题 (., 0))
表项数.置标题 (1, .取标题 (., 1))
表项数.置标题 (2, .取标题 (., 2))
表项数.置标题 (3, .取标题 (., 3))
表项数.置图片 (0, 136)
.删除表项 (.)
赋值 (.标题, 相加 (“本班升级”, 到文本 (取表项数 ()), “名,留级”, 到文本 (取表项数 ()), “名”))
.如果 (等于 (取表项数 (), 0))
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
.如果结束
.如果 (等于 (取表项数 (), 0))
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
.如果结束


.子程序 _留级列表框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 表项数, 整数型, , , 

.如果真 (等于 (.取标题 (., 0), “”))
    返回 ()
.如果真结束
赋值 (表项数, -1.插入表项 ())
表项数.置标题 (0, .取标题 (., 0))
表项数.置标题 (1, .取标题 (., 1))
表项数.置标题 (2, .取标题 (., 2))
表项数.置标题 (3, .取标题 (., 3))
表项数.置图片 (0, 135)
.删除表项 (.)
赋值 (.标题, 相加 (“本班升级”, 到文本 (取表项数 ()), “名,留级”, 到文本 (取表项数 ()), “名”))
.如果 (等于 (取表项数 (), 0))
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
.如果结束
.如果 (等于 (取表项数 (), 0))
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
.如果结束


.子程序 _按钮3_被单击, 空白型, , 
.如果真 (等于 (., -1))
    返回 ()
.如果真结束
_升级列表框_被双击 (0, 0, 0)

.子程序 _按钮1_被单击, 空白型, , 
.如果真 (等于 (., -1))
    返回 ()
.如果真结束
_留级列表框_被双击 (0, 0, 0)


.子程序 _选择夹1_子夹被改变, 空白型, , 
.判断开始 (等于 (.现行子夹, 0))
    赋值 (.标题, 相加 (“报名、毕业、升级、分班管理-”, 1.取子夹名称 ()))
.判断 (等于 (.现行子夹, 1))
    赋值 (.标题, 相加 (“报名、毕业、升级、分班管理-”, 2.取子夹名称 ()))
.判断 (等于 (.现行子夹, 2))
    赋值 (.标题, 相加 (“报名、毕业、升级、分班管理-”, 3.取子夹名称 ()))
.判断 (等于 (.现行子夹, 3))
    赋值 (.标题, 相加 (“报名、毕业、升级、分班管理-”, 4.取子夹名称 ()))
.默认
    
.判断结束
.如果真 (并且 (等于 (处理类型, 1), 等于 (.现行子夹, 3)))
    赋值 (.现行子夹, 0)
    信息框 (“当前不能操作报名项,请从总务管理[学生报名]菜单进入!”, #信息图标, )
    赋值 (.标题, 相加 (“报名、毕业、升级、分班管理-”, 1.取子夹名称 ()))
    
.如果真结束


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 A, 整数型, , , 
.局部变量 学生号, 文本型, , , 
.局部变量 条件, 文本型, , , 
.局部变量 错误, 文本型, , , 
.局部变量 升, 逻辑型, , , 

.如果真 (等于 (取表项数 (), 0))
    信息框 (“抱歉！升级框里没有升级学员！请选择需要升级的班级。”, 0, )
    返回 ()
.如果真结束
检查连接 ()

.如果真 (不等于 (信息框 (“    本操作将1年级升2年级，2年级升3年级．．．毕业年级毕业。请先将不毕业或留级的学生调到右边后进行升级保存操作！由于本操作不可逆，强烈建议您升级前注意升级资料的准确性！按确认键将保存升级。”, 相加 (#确认取消钮, #警告图标), “ 升级前警告！”), #确认钮))
    返回 ()
.如果真结束
.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“抱歉！没有选择升级班级！请选择需要升级的班级或年级。”, 0, )
    返回 ()
.如果真结束

.如果真 (等于 (未知支持库函数_19 (连接句柄, “xsda”, “xf=' ',xzf=' ',hsf=' '”, 相加 (“szbj='”, .内容, “'”)), 假))
    未知支持库函数_41 (连接句柄, 错误)
    信息框 (相加 (“错误！原因：”, 错误), 0, )
    返回 ()
.如果真结束

.计次循环首 (取表项数 (), A)
    赋值 (学生号, 相减 (A, 1).取标题 (0))
    赋值 (条件, 相加 (“xh='”, 学生号, “',xm='”, 相减 (A, 1).取标题 (1), “',kh='”, 相减 (A, 1).取标题 (2), “',xb='”, 相减 (A, 1).取标题 (3), “',sjzt='留级',sjqbj='”, .内容, “',xsznj='”, .内容, “',sjsj='”, 时间到文本 (取现行时间 (), #日期部分), “',sfbm='0'”))
    .如果真 (等于 (未知支持库函数_18 (连接句柄, “sjby”, 条件), 假))
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (相加 (“错误！原因：”, 错误), 0, )
        跳出循环 ()
    .如果真结束
    .如果真 (等于 (未知支持库函数_19 (连接句柄, “xsda”, “zxxz='升级学生',szbj=' ',xf=' ',xzf=' ',xzf=' ',bm=' ',bnfw='学生',bm='0'”, 相加 (“xh='”, 学生号, “'”)), 假))
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (相加 (“错误！原因：”, 错误), 0, )
        跳出循环 ()
    .如果真结束
    
    处理事件 ()
    赋值 (升, 真)
.计次循环尾 ()


.计次循环首 (取表项数 (), A)
    赋值 (学生号, 相减 (A, 1).取标题 (0))
    
    .如果 (或者 (等于 (取文本左边 (.内容, 9), “小学6年级”), 等于 (取文本左边 (.内容, 9), “初中3年级”), 等于 (取文本左边 (.内容, 9), “高中3年级”), 等于 (.选中, 真)))
        
        赋值 (条件, 相加 (“xh='”, 学生号, “',xm='”, 相减 (A, 1).取标题 (1), “',kh='”, 相减 (A, 1).取标题 (2), “',sjzt='毕业',sjqbj='”, .内容, “',xsznj='”, .内容, “',sjsj='”, 时间到文本 (取现行时间 (), #日期部分), “'”))
        
    .否则
        赋值 (条件, 相加 (“xh='”, 学生号, “',xm='”, 相减 (A, 1).取标题 (1), “',xb='”, 相减 (A, 1).取标题 (3), “',kh='”, 相减 (A, 1).取标题 (2), “',sjzt='升级',sjqbj='”, .内容, “',xsznj='”, .内容, “',sjsj='”, 时间到文本 (取现行时间 (), #日期部分), “',sfbm='0'”))
        .如果真 (等于 (未知支持库函数_18 (连接句柄, “sjby”, 条件), 假))
            未知支持库函数_41 (连接句柄, 错误)
            信息框 (相加 (“错误！原因：”, 错误), 0, )
            赋值 (升, 假)
            跳出循环 ()
        .如果真结束
        
    .如果结束
    .如果 (或者 (等于 (取文本左边 (.内容, 9), “小学6年级”), 等于 (取文本左边 (.内容, 9), “初中3年级”), 等于 (取文本左边 (.内容, 9), “高中3年级”), 等于 (.选中, 真)))
        .如果真 (等于 (未知支持库函数_19 (连接句柄, “xsda”, 相加 (“zxxz='毕业学生',kh=' ',szbj=' ',bnfw='学生',lskh='”, 相减 (A, 1).取标题 (2), “',lxsj='”, 时间到文本 (取现行时间 (), #日期部分), “',bm='0'”), 相加 (“xh='”, 学生号, “'”)), 假))
            未知支持库函数_41 (连接句柄, 错误)
            信息框 (相加 (“错误！原因：”, 错误), 0, )
            赋值 (升, 假)
            跳出循环 ()
        .如果真结束
        
    .否则
        .如果真 (等于 (未知支持库函数_19 (连接句柄, “xsda”, “zxxz='升级学生',szbj=' ',xf=' ',xzf=' ',hsf=' ',bnfw='学生',bm='0'”, 相加 (“xh='”, 学生号, “'”)), 假))
            未知支持库函数_41 (连接句柄, 错误)
            信息框 (相加 (“错误！原因：”, 错误), 0, )
            赋值 (升, 假)
            跳出循环 ()
        .如果真结束
        
    .如果结束
    处理事件 ()
    赋值 (升, 真)
.计次循环尾 ()


.如果真 (等于 (升, 真))
    赋值 (记录日志, 相加 (“执行”, .内容, “全班同学升级或毕业操作完成”))
    写日志 ()
    信息框 (相加 (.内容, “全体同学升级或毕业操作完成！”), 0, )
    填充升级姓名 ()
.如果真结束


.子程序 _组合框5_列表项被选择, 空白型, , 
打开升级列表 ()

.子程序 打开升级列表, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 行, 整数型, , , 
.局部变量 表项数, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 

置等待鼠标 ()
全部删除 ()
.如果真 (等于 (.内容, “”))
    返回 ()
.如果真结束
检查连接 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select * from sjby where xsznj like '%”, .内容, “%' ORDER BY xh ASC;”)), 假)) ' 导出记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (字段数, 未知支持库函数_14 (记录集句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
.计次循环首 (记录数, 行)
    置等待鼠标 ()
    赋值 (表项数, -1.插入表项 ())
    赋值 (文本变量, “”)
    .计次循环首 (字段数, 列)
        未知支持库函数_15 (记录集句柄, 相减 (列, 1), 字段名)
        未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
        .如果真 (不等于 (文本变量, “”))
            表项数.置标题 (相减 (列, 1), 文本变量)
        .如果真结束
        
    .计次循环尾 ()
    .如果 (等于 (表项数.取标题 (4), “升级”))
        表项数.置图片 (0, 137)
    .否则
        表项数.置图片 (0, 138)
    .如果结束
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
赋值 (.内容, 相加 (“当前”, .内容, “共有新学生”, 到文本 (取表项数 ()), “名”))
刷新显示 ()
刷新显示 ()
恢复鼠标 ()


.子程序 _组合框3_列表项被选择, 空白型, , 
打开分班列表 ()
相加 (取文本左边 (.内容, 9), “1班”).选择 ()


.子程序 打开分班列表, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 行, 整数型, , , 
.局部变量 表项数, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 

置等待鼠标 ()
全部删除 ()
全部删除 ()
.如果真 (等于 (.内容, “”))
    返回 ()
.如果真结束
检查连接 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select xh,xm,kh from sjby where xsznj like '%”, .内容, “%' ORDER BY xh ASC;”)), 假)) ' 导出记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (字段数, 未知支持库函数_14 (记录集句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
.计次循环首 (记录数, 行)
    置等待鼠标 ()
    赋值 (表项数, -1.插入表项 ())
    赋值 (文本变量, “”)
    .计次循环首 (字段数, 列)
        未知支持库函数_15 (记录集句柄, 相减 (列, 1), 字段名)
        未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
        .如果真 (不等于 (文本变量, “”))
            表项数.置标题 (相减 (列, 1), 文本变量)
        .如果真结束
        
    .计次循环尾 ()
    表项数.置图片 (0, 135)
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
赋值 (.标题, 相加 (“本年级共有学生”, 到文本 (取表项数 ()), “名”))
刷新显示 ()
恢复鼠标 ()
.如果 (等于 (取表项数 (), 0))
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
.如果结束
.如果 (等于 (取表项数 (), 0))
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
.如果结束



.子程序 _升级列表框3_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 表项数, 整数型, , , 

.如果真 (等于 (.取标题 (., 0), “”))
    返回 ()
.如果真结束
赋值 (表项数, -1.插入表项 ())
表项数.置标题 (0, .取标题 (., 0))
表项数.置标题 (1, .取标题 (., 1))
表项数.置标题 (2, .取标题 (., 2))
表项数.置图片 (0, 254)
.删除表项 (.)
赋值 (.标题, 相加 (“本年级共有学生名”, 到文本 (取表项数 ()), “名”))
赋值 (.标题, 相加 (“分配本班”, 到文本 (取表项数 ()), “名”))
.如果 (等于 (取表项数 (), 0))
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
.如果结束
.如果 (等于 (取表项数 (), 0))
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
.如果结束


.子程序 _升级列表框4_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 表项数, 整数型, , , 

.如果真 (等于 (.取标题 (., 0), “”))
    返回 ()
.如果真结束
赋值 (表项数, -1.插入表项 ())
表项数.置标题 (0, .取标题 (., 0))
表项数.置标题 (1, .取标题 (., 1))
表项数.置标题 (2, .取标题 (., 2))
表项数.置图片 (0, 135)
.删除表项 (.)
赋值 (.标题, 相加 (“本年级共有学生名”, 到文本 (取表项数 ()), “名”))
赋值 (.标题, 相加 (“分配本班”, 到文本 (取表项数 ()), “名”))
.如果 (等于 (取表项数 (), 0))
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
.如果结束
.如果 (等于 (取表项数 (), 0))
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
.如果结束


.子程序 _按钮6_被单击, 空白型, , 
.如果真 (等于 (., -1))
    返回 ()
.如果真结束
_升级列表框3_被双击 (0, 0, 0)


.子程序 _按钮5_被单击, 空白型, , 
.如果真 (等于 (., -1))
    返回 ()
.如果真结束
_升级列表框4_被双击 (0, 0, 0)


.子程序 _按钮4_被单击, 空白型, , 
.局部变量 A, 整数型, , , 
.局部变量 学生号, 文本型, , , 
.局部变量 错误, 文本型, , , 
.局部变量 条件, 文本型, , , 
.局部变量 分, 逻辑型, , , 

.如果真 (等于 (取表项数 (), 0))
    信息框 (“抱歉！年级框里没有分班学员！请选择需要分班的班级。”, 0, )
    返回 ()
.如果真结束
检查连接 ()
.如果真 (不等于 (信息框 (“   本操作将某年级所有升级到的同学进行分班。请先选择班级再单击[分到]键或双击学生,调到右边进行分班保存操作！由于本操作不可逆，强烈建议您在分班前注意分班同学的准确性！按确认键将保存升级。”, 相加 (#确认取消钮, #警告图标), “ 分班前警告！”), #确认钮))
    返回 ()
.如果真结束
.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“抱歉！没有选择分班班级！请选择需要分班的班级或年级。”, 0, )
    返回 ()
.如果真结束
.计次循环首 (取表项数 (), A)
    赋值 (学生号, 相减 (A, 1).取标题 (0))
    赋值 (条件, 相加 (“xh='”, 学生号, “'”))
    .如果真 (等于 (未知支持库函数_19 (连接句柄, “xsda”, 相加 (“zxxz='在校学生',szbj='”, .内容, “',bnfw='学生'”), 条件), 假))
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (相加 (“错误！原因：”, 错误), 0, )
        赋值 (分, 假)
        跳出循环 ()
    .如果真结束
    .如果真 (等于 (未知支持库函数_20 (连接句柄, “sjby”, 条件), 假))
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (相加 (“错误！原因：”, 错误), 0, )
        赋值 (分, 假)
        跳出循环 ()
    .如果真结束
    处理事件 ()
    赋值 (分, 真)
.计次循环尾 ()
.如果真 (等于 (分, 真))
    赋值 (记录日志, 相加 (“执行”, .内容, “全年级同学分班操作完成”))
    写日志 ()
    信息框 (相加 (.内容, “全体同学分班操作完成！”), 0, )
.如果真结束
打开分班列表 ()
填充升级姓名 ()
打开升级列表 ()


.子程序 _选择框2_被单击, 空白型, , 
.局部变量 A, 整数型, , , 
.局部变量 班, 文本型, , "0", 

.如果 (.选中)
    连续赋值 (假, .选中, .选中, .禁止, .字体名称)
    连续赋值 (真, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
    .如果真 (等于 (填充班级名称 (), 假))
        返回 ()
    .如果真结束
    清空 ()
    “(所有学生)”.加入项目 ()
    .计次循环首 (取项目数 (), A)
        赋值 (班, 分割文本 (相减 (A, 0).取项目文本 (), “级”, ))
        .如果真 (大于或等于 (取数组成员数 (班), 2))
            .如果真 (等于 (班.选择 ( [1]), -1))
                相加 (班 [1], “级”).加入项目 ()
            .如果真结束
            
        .如果真结束
        
    .计次循环尾 ()
    “小学1年级”.选择 ()
    
.否则
    
.如果结束
_组合框6_列表项被选择 ()

.子程序 _选择框4_被单击, 空白型, , 
.局部变量 班, 文本型, , "0", 
.局部变量 A, 整数型, , , 

.如果真 (等于 (填充班级名称 (), 假))
    返回 ()
.如果真结束
清空 ()
“(所有学生)”.加入项目 ()
.计次循环首 (取项目数 (), A)
    赋值 (班, 分割文本 (相减 (A, 0).取项目文本 (), “级”, ))
    .如果真 (大于或等于 (取数组成员数 (班), 2))
        .如果真 (等于 (班.选择 ( [1]), -1))
            相加 (班 [1], “级”).加入项目 ()
        .如果真结束
        
    .如果真结束
    
.计次循环尾 ()
“小学1年级”.选择 ()

.如果 (.选中)
    连续赋值 (假, .选中, .选中, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
    连续赋值 (真, .字体名称)
.否则
    
.如果结束


.子程序 _选择框3_被单击, 空白型, , 
.如果 (.选中)
    连续赋值 (假, .选中, .选中, .禁止, .字体名称)
    连续赋值 (真, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
    清空 ()
    填充班级名称 ()
    赋值 (.现行选中项, 0)
.否则
    
.如果结束
_组合框6_列表项被选择 ()

.子程序 _组合框6_列表项被选择, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 文本变量, 文本型, , , 

.判断开始 (.选中)
    打开表1 ()
.判断 (.选中)
    打开表2 ()
.默认
    
.判断结束
置等待鼠标 ()
.如果真 (等于 (.内容, “”))
    返回 ()
.如果真结束
检查连接 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select bj,xf,xzf,hsf from system where bj like '%”, .内容, “%';”)), 假)) ' 导出记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
未知支持库函数_6 (记录集句柄, “xf”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “xzf”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录集句柄, “hsf”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_5 (记录集句柄)
恢复鼠标 ()
打开表3 ()

.子程序 打开表1, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 行, 整数型, , , 
.局部变量 表项数, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 

置等待鼠标 ()
.如果真 (等于 (.内容, “”))
    返回 ()
.如果真结束
检查连接 ()
全部删除 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select xh,xm,xb,kh,sfbm from sjby where xsznj like '%”, .内容, “%'and sfbm='0' ORDER BY xh ASC;”)), 假)) ' 导出记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (字段数, 未知支持库函数_14 (记录集句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
.计次循环首 (记录数, 行)
    置等待鼠标 ()
    赋值 (表项数, -1.插入表项 ())
    赋值 (文本变量, “”)
    .计次循环首 (字段数, 列)
        未知支持库函数_15 (记录集句柄, 相减 (列, 1), 字段名)
        未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
        .如果真 (不等于 (文本变量, “”))
            表项数.置标题 (相减 (列, 1), 文本变量)
        .如果真结束
        
    .计次循环尾 ()
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
赋值 (.标题, 相加 (“本年级共有未报名学生：”, 到文本 (取表项数 ()), “名”))
刷新显示 ()
恢复鼠标 ()


.子程序 打开表2, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 行, 整数型, , , 
.局部变量 表项数, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 

置等待鼠标 ()
.如果真 (等于 (.内容, “”))
    返回 ()
.如果真结束
检查连接 ()
全部删除 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select xh,xm,xb,kh,zxxz,xf from xsda where szbj like '%”, .内容, “%' and zxxz='在校学生' and xf='' ORDER BY xh ASC;”)), 假)) ' 导出记录
    提示错误 ()
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (字段数, 未知支持库函数_14 (记录集句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
.计次循环首 (记录数, 行)
    置等待鼠标 ()
    赋值 (表项数, -1.插入表项 ())
    赋值 (文本变量, “”)
    .计次循环首 (字段数, 列)
        未知支持库函数_15 (记录集句柄, 相减 (列, 1), 字段名)
        未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
        .如果真 (不等于 (文本变量, “”))
            表项数.置标题 (相减 (列, 1), 文本变量)
        .如果真结束
        
    .计次循环尾 ()
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
赋值 (.标题, 相加 (“本班共有未报名学生：”, 到文本 (取表项数 ()), “名”))
刷新显示 ()
恢复鼠标 ()


.子程序 _选择夹1_将改变子夹, 逻辑型, , 
.判断开始 (等于 (处理类型, 2))
    赋值 (.现行子夹, 3)
.默认
    
.判断结束



.子程序 _报名列表框1_当前表项被改变, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 文本变量, 文本型, , , 

连续赋值 (“”, .内容, .内容, .内容)
赋值 (.现行选中项, -1)
赋值 (.内容, .取标题 (., 0))
赋值 (.内容, .取标题 (., 1))
赋值 (.内容, .取标题 (., 3))
.如果真 (等于 (.内容, “”))
    返回 ()
.如果真结束
检查连接 ()
取库特定记录 (连接句柄, “xsda”, “xh”, “xb”, .内容).选择 ()


.子程序 _按钮8_被单击, 空白型, , 
打印超级列表框 (相加 (校名, 到文本 (取年份 (取现行时间 ())), “年”, 当前学期, “学生报名统计表”), 相加 (.内容, “统计状况：”), “制表：                           审核：”, )

.子程序 _按钮9_被单击, 空白型, , 
打印超级列表框 (相加 (校名, 到文本 (取年份 (取现行时间 ())), “学生升留级状况表”), 相加 (.内容, “统计状况：”), “制表：                           审核：”, )


.子程序 _选择框5_被单击, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 文本变量, 文本型, , , 

.如果 (.选中)
    赋值 (.内容, “0.00”)
    赋值 (.内容, “0.00”)
    赋值 (.内容, “0.00”)
    连续赋值 (真, .禁止, .禁止, .禁止)
.否则
    置等待鼠标 ()
    .如果真 (等于 (.内容, “”))
        返回 ()
    .如果真结束
    检查连接 ()
    .如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select bj,xf,xzf,hsf from system where bj like '%”, .内容, “%';”)), 假)) ' 导出记录
        返回 ()
    .如果真结束
    赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
    未知支持库函数_12 (记录集句柄)
    未知支持库函数_6 (记录集句柄, “xf”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录集句柄, “xzf”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录集句柄, “hsf”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_5 (记录集句柄)
    恢复鼠标 ()
    连续赋值 (假, .禁止, .禁止, .禁止)
    
.如果结束


.子程序 _按钮7_被单击, 空白型, , 
.局部变量 处理数据, 文本型, , , 
.局部变量 免费, 文本型, , , 

.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“请输入报名信息！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
检查连接 ()
.如果 (.选中)
    赋值 (免费, “1”)
.否则
    赋值 (免费, “ ”)
.如果结束
赋值 (处理数据, “”)
.判断开始 (.选中) ' 新学生报名
    .如果真 (取数据库重复记录 (连接句柄, “xsda”, “xh”, .内容))
        信息框 (“    此学生的学号已经被使用，有可能不是新生,请到档案查询一下！再换学号或按已在校形式报名！”, #信息图标, “重复信息！”)
        返回 ()
    .如果真结束
    赋值 (处理数据, 相加 (“xh='”, .内容, “',xm='”, .内容, “',kh='”, .内容, “',xb='”, .内容, “',xf='”, .内容, “',xzf='”, .内容, “',hsf='”, .内容, “',sfmf='”, 免费, “',rxsj='”, 时间到文本 (取现行时间 (), #时间部分), “',bnfw='学生',zxxz='升级学生',bm='1',szbj='”, .内容, “'”))
    .如果真 (等于 (信息框 (相加 (“    执行新生报名后新同学的详细信息，必须等进行分班后再到[学生管理]-[修改档案]中完成全部信息修改！”, #换行符, “由于此操作不可逆，请在报名前仔细填写报名费等其它报名信息！”), 相加 (#警告图标, #确认取消钮), “报名提示！！！”), #取消钮))
        返回 ()
    .如果真结束
    .如果真 (未知支持库函数_18 (连接句柄, “xsda”, 处理数据))
        .如果真 (未知支持库函数_18 (连接句柄, “sjby”, 相加 (“xh='”, .内容, “',xm='”, .内容, “',kh='”, .内容, “',xb='”, .内容, “',sjzt='”, “新生”, “',xsznj='”, .内容, “',sfbm='1'”)))
            赋值 (记录日志, 相加 (“执行”, .内容, “同学报名操作完成”))
            写日志 ()
            信息框 (相加 (“执行”, .内容, “同学报名操作完成”), 0, )
            _组合框6_列表项被选择 ()
            返回 ()
        .如果真结束
        
    .如果真结束
    提示错误 ()
    返回 ()
.默认
    .判断开始 (.选中) ' 未分班学生报名
        赋值 (处理数据, 相加 (“xf='”, .内容, “',xzf='”, .内容, “',hsf='”, .内容, “',sfmf='”, 免费, “',rxsj='”, 时间到文本 (取现行时间 (), #时间部分), “',bnfw='学生',bm='1',szbj='”, .内容, “'”))
        .如果真 (等于 (信息框 (“    执行报名后需要对新同学进行分班。由于此操作不可逆，请在报名前仔细填写报名费等其它报名信息！”, 相加 (#警告图标, #确认取消钮), “报名提示！！！”), #取消钮))
            返回 ()
        .如果真结束
        .如果真 (未知支持库函数_19 (连接句柄, “xsda”, 处理数据, 相加 (“xh='”, .内容, “'”)))
            .如果真 (未知支持库函数_19 (连接句柄, “sjby”, “sfbm='1'”, 相加 (“xh='”, .内容, “'”)))
                赋值 (记录日志, 相加 (“执行”, .内容, “同学报名操作完成”))
                写日志 ()
                信息框 (相加 (“执行”, .内容, “同学报名操作完成”), 0, )
                _组合框6_列表项被选择 ()
                返回 ()
                
            .如果真结束
            
        .如果真结束
        提示错误 ()
        返回 ()
    .判断 (.选中) ' 已分班学生报名
        赋值 (处理数据, 相加 (“xf='”, .内容, “',xzf='”, .内容, “',hsf='”, .内容, “',sfmf='”, 免费, “',rxsj='”, 时间到文本 (取现行时间 (), #日期部分), “',bnfw='学生',bm='1',szbj='”, .内容, “'”))
        .如果真 (等于 (信息框 (“   由于此操作不可逆，请在报名前仔细填写报名费等其它报名信息！”, 相加 (#警告图标, #确认取消钮), “报名提示！！！”), #取消钮))
            返回 ()
        .如果真结束
        .如果真 (未知支持库函数_19 (连接句柄, “xsda”, 处理数据, 相加 (“xh='”, .内容, “'”)))
            赋值 (记录日志, 相加 (“执行”, .内容, “同学报名操作完成”))
            写日志 ()
            信息框 (相加 (“执行”, .内容, “同学报名操作完成”), 0, )
            _组合框6_列表项被选择 ()
            返回 ()
            
        .如果真结束
        提示错误 ()
        返回 ()
    .默认
        
    .判断结束
    
.判断结束



.子程序 打开表3, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 行, 整数型, , , 
.局部变量 表项数, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 

置等待鼠标 ()
.如果真 (等于 (.内容, “”))
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “(所有学生)”))
    信息框 (“请选择正确的班级！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
检查连接 ()
全部删除 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select xh,xm,xb,kh,szbj,xf,xzf,hsf from xsda where szbj like '%”, .内容, “%' and bm='1' ORDER BY xh ASC;”)), 假)) ' 导出记录
    提示错误 ()
    返回 ()
.如果真结束

赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (字段数, 未知支持库函数_14 (记录集句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
.计次循环首 (记录数, 行)
    置等待鼠标 ()
    赋值 (表项数, -1.插入表项 ())
    赋值 (文本变量, “”)
    .计次循环首 (字段数, 列)
        未知支持库函数_15 (记录集句柄, 相减 (列, 1), 字段名)
        未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
        .如果真 (不等于 (文本变量, “”))
            表项数.置标题 (相减 (列, 1), 文本变量)
        .如果真结束
        
    .计次循环尾 ()
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
.如果 (或者 (等于 (.选中, 真), 等于 (.选中, 真)))
    赋值 (.标题, 相加 (“本年级已报名学生共有：”, 到文本 (取表项数 ()), “名”))
.否则
    赋值 (.标题, 相加 (“本班已报名学生共有：”, 到文本 (取表项数 ()), “名”))
    
.如果结束
刷新显示 ()
恢复鼠标 ()


.子程序 _按钮10_被单击, 空白型, , 
.局部变量 学杂费, 文本型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“没有选择报名学生。。。。。。！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (载入 (报名单据窗口, 毕业升级管理, 假), 假))
    返回 ()
.如果真结束
赋值 (报名单据窗口., .内容)
赋值 (报名单据窗口., .内容)
赋值 (报名单据窗口., .内容)
赋值 (报名单据窗口., .内容)
赋值 (报名单据窗口., .内容)
赋值 (报名单据窗口., .内容)
.如果 (.选中)
    赋值 (报名单据窗口., “1”)
.否则
    赋值 (报名单据窗口., “0”)
.如果结束
报名单据窗口.置文本 (., 3, 6, 相加 (.内容, “同学缴来(”, .内容, “)学费或学杂费等,共计如下金额：”))
赋值 (学杂费, 数值到格式文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容)), 2, 假))
报名单据窗口.置文本 (., 5, 6, 数值到金额 (到数值 (学杂费), 假))
报名单据窗口.置文本 (., 12, 1, 学杂费)
报名单据窗口.置文本 (., 6, 1, 相加 (.内容, “同学缴来学费”))
报名单据窗口.选择 (., .内容)

报名单据窗口.置文本 (., 6, 19, 取文本右边 (学杂费, 1))
报名单据窗口.置文本 (., 6, 18, 取文本中间 (学杂费, 相减 (取文本长度 (学杂费), 1), 1))
报名单据窗口.置文本 (., 6, 17, 取文本中间 (学杂费, 相减 (取文本长度 (学杂费), 3), 1))
报名单据窗口.置文本 (., 6, 16, 取文本中间 (学杂费, 相减 (取文本长度 (学杂费), 4), 1))
报名单据窗口.置文本 (., 6, 15, 取文本中间 (学杂费, 相减 (取文本长度 (学杂费), 5), 1))
报名单据窗口.置文本 (., 6, 14, 取文本中间 (学杂费, 相减 (取文本长度 (学杂费), 6), 1))
报名单据窗口.置文本 (., 6, 13, 取文本中间 (学杂费, 相减 (取文本长度 (学杂费), 7), 1))
报名单据窗口.置文本 (., 6, 12, 取文本中间 (学杂费, 相减 (取文本长度 (学杂费), 8), 1))
报名单据窗口.置文本 (., 6, 11, 取文本中间 (学杂费, 相减 (取文本长度 (学杂费), 9), 1))
报名单据窗口.置文本 (., 6, 10, 取文本中间 (学杂费, 相减 (取文本长度 (学杂费), 10), 1))
赋值 (报名单据窗口..只读, 假)


.子程序 _报名列表框_当前表项被改变, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 文本变量, 文本型, , , 

连续赋值 (“”, .内容, .内容, .内容)
赋值 (.内容, .取标题 (., 0))
赋值 (.内容, .取标题 (., 1))
赋值 (.内容, .取标题 (., 3))
赋值 (.现行选中项, -1)
.如果真 (等于 (.内容, “”))
    返回 ()
.如果真结束
取库特定记录 (连接句柄, “xsda”, “xh”, “xb”, .内容).选择 ()

.窗口程序集 宿舍管理程序集, , , 

.子程序 _宿舍管理_创建完毕, 空白型, , 
.如果 (填充班级名称 ())
    赋值 (.现行选中项, 0)
    刷新宿舍 ()
    填充学生 ()
    _组合框1_列表项被选择 ()
    
    填教员名 ()
    _教师名_列表项被选择 ()
    填充教员表 ()
    赋值 (.标题, “学校学生宿舍安排管理”)
.否则
    
.如果结束


.子程序 填教员名, 空白型, , 填充教员名
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 行, 整数型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 列, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本量, 文本型, , "0", 
.局部变量 错误, 文本型, , , 
.局部变量 D, 整数型, , , 
.局部变量 表项, 整数型, , , 
.局部变量 当前班级, 文本型, , , 
.局部变量 姓名变量, 文本型, , , 
.局部变量 性别变量, 文本型, , , 

置等待鼠标 ()
检查连接 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select xb,xm,sfz,zzlx from jyda where zzlx like '%”, “在职教员”, “%'ORDER BY xm ASC;”)), 假)) ' 导出记录
    未知支持库函数_41 (连接句柄, 错误)
    信息框 (相加 (“建立记录失败！”, 错误), 0, )
    返回 ()
.如果真结束

赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
清空 ()
.计次循环首 (记录数, 行)
    置等待鼠标 ()
    未知支持库函数_6 (记录集句柄, “sfz”, 文本变量)
    未知支持库函数_6 (记录集句柄, “xm”, 姓名变量)
    未知支持库函数_6 (记录集句柄, “xb”, 性别变量)
    相加 (姓名变量, “-”, 文本变量, “-”, 性别变量).加入项目 ()
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
赋值 (.现行选中项, 0)
赋值 (.内容, 相加 (“本校共有”, 到文本 (记录数), “名教员”))
恢复鼠标 ()

.子程序 _组合框1_列表项被选择, 空白型, , 
.局部变量 分开, 文本型, , "0", 

清除学生 ()
赋值 (分开, 分割文本 (.内容, “-”, ))
.如果真 (大于或等于 (取数组成员数 (分开), 3))
    赋值 (.标题, 分开 [1])
    .如果 (等于 (分开 [3], “1”))
        “男”.选择 ()
    .否则
        “女”.选择 ()
    .如果结束
    赋值 (.标题, .内容)
    赋值 (.标题, 分开 [2])
.如果真结束
赋值 (.标题, .内容)
赋值 (.标题, .内容)
赋值 (.标题, .内容)
填充学生表 ()

.子程序 清除学生, 空白型, , 
连续赋值 (“”, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题)
 ' 组合框3.现行选中项 ＝ -1
 ' 组合框2.现行选中项 ＝ -1

.子程序 _编辑框3_内容被改变, 空白型, , 
.局部变量 分开, 文本型, , "0", 

清除学生 ()
赋值 (分开, 分割文本 (.内容, “-”, ))
.如果真 (大于或等于 (取数组成员数 (分开), 3))
    赋值 (.标题, 分开 [1])
    .如果 (等于 (分开 [3], “1”))
        “男”.选择 ()
    .否则
        “女”.选择 ()
    .如果结束
    赋值 (.标题, .内容)
    赋值 (.标题, 分开 [2])
.如果真结束
赋值 (.标题, .内容)
赋值 (.标题, .内容)
赋值 (.标题, .内容)

.子程序 _组合框2_列表项被选择, 空白型, , 
.局部变量 分开, 文本型, , "0", 

清除学生 ()
赋值 (分开, 分割文本 (.内容, “-”, ))
.如果真 (大于或等于 (取数组成员数 (分开), 3))
    赋值 (.标题, 分开 [1])
    .如果 (等于 (分开 [3], “1”))
        “男”.选择 ()
    .否则
        “女”.选择 ()
    .如果结束
    赋值 (.标题, .内容)
    赋值 (.标题, 分开 [2])
.如果真结束
赋值 (.标题, .内容)
赋值 (.标题, .内容)
赋值 (.标题, .内容)

.子程序 _组合框3_列表项被选择, 空白型, , 
.局部变量 分开, 文本型, , "0", 

清除学生 ()
赋值 (分开, 分割文本 (.内容, “-”, ))
.如果真 (大于或等于 (取数组成员数 (分开), 3))
    赋值 (.标题, 分开 [1])
    .如果 (等于 (分开 [3], “1”))
        “男”.选择 ()
    .否则
        “女”.选择 ()
    .如果结束
    赋值 (.标题, .内容)
    赋值 (.标题, 分开 [2])
.如果真结束
赋值 (.标题, .内容)
赋值 (.标题, .内容)
赋值 (.标题, .内容)

.子程序 _教师名_列表项被选择, 空白型, , 
.局部变量 分开, 文本型, , "0", 

赋值 (.标题, .内容)
赋值 (.标题, .内容)
赋值 (分开, 分割文本 (.内容, “-”, ))
.如果真 (大于或等于 (取数组成员数 (分开), 3))
    赋值 (.标题, 分开 [1])
    赋值 (.标题, 分开 [2])
    赋值 (.标题, 分开 [3])
    分开.选择 ( [3])
.如果真结束


.子程序 _床位号_列表项被选择, 空白型, , 
.局部变量 分开, 文本型, , "0", 

赋值 (.标题, .内容)
赋值 (.标题, .内容)
赋值 (分开, 分割文本 (.内容, “-”, ))
.如果真 (大于或等于 (取数组成员数 (分开), 3))
    赋值 (.标题, 分开 [1])
    赋值 (.标题, 分开 [2])
    赋值 (.标题, 分开 [3])
    分开.选择 ( [3])
    
.如果真结束


.子程序 填充学生, 空白型, , 填充升级姓名表
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 文本, 文本型, , , 
.局部变量 A, 文本型, , , 
.局部变量 文, 文本型, , , 

置等待鼠标 ()
检查连接 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select xh,xm,xb,zxxz,szbj from xsda where szbj like '%”, .内容, “%' and zxxz like '%在校学生%' ORDER BY xh ASC;”)), 假)) ' 导出记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
清空 ()
赋值 (字段数, 未知支持库函数_14 (记录集句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
.计次循环首 (记录数, )
    置等待鼠标 ()
    赋值 (文本变量, “”)
    未知支持库函数_6 (记录集句柄, “xm”, 文本变量)
    未知支持库函数_6 (记录集句柄, “xb”, 文本)
    未知支持库函数_6 (记录集句柄, “xh”, 文)
    .如果 (等于 (文本, “男”))
        赋值 (A, “1”)
    .否则
        赋值 (A, “0”)
    .如果结束
    
    .如果真 (不等于 (文本变量, “”))
        相加 (文本变量, “-”, 文, “-”, A).加入项目 ()
    .如果真结束
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
赋值 (.标题, 相加 (“本班共有学生”, 到文本 (取项目数 ()), “名”))
恢复鼠标 ()
赋值 (.现行选中项, 0)

.子程序 _按钮3_被单击, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 条件, 文本型, , , 

.如果真 (或者 (等于 (.标题, “”), 等于 (.标题, “”), 等于 (.标题, “”), 等于 (.标题, “”), 等于 (.标题, “”), 等于 (.标题, “”)))
    信息框 (“被保存的信息不全面！”, 0, “错误 ”)
    返回 ()
.如果真结束
检查连接 ()
.如果真 (大于或等于 (.查找表项 (.标题, 0, ), 0))
    信息框 (相加 (.标题, “同学已经安排了床位，如果需要更换床位请删除后保存！”), 0, )
    返回 ()
.如果真结束
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select ssh,cwh from xsda where ssh='”, .标题, “' and cwh='”, .标题, “';”)), 假))
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
未知支持库函数_5 (记录集句柄)
.如果真 (大于 (记录数, 0))
    信息框 (“此床位已经被使用！请更换其它床位。”, 0, )
    返回 ()
.如果真结束
赋值 (记录数, 0)
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select ssh,xb from xsda where ssh='”, .标题, “' and xb='”, .标题, “';”)), 假))
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
未知支持库函数_5 (记录集句柄)
.如果真 (等于 (记录数, 0))
    .如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select ssh,cwh from xsda where ssh='”, .标题, “';”)), 假))
        返回 ()
    .如果真结束
    赋值 (记录数, 0)
    赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
    赋值 (记录数, 未知支持库函数_7 (记录集句柄))
    未知支持库函数_5 (记录集句柄)
    .如果真 (不等于 (记录数, 0))
        信息框 (“此宿舍已被异性同学使用！请更换其它宿舍。”, 0, )
        返回 ()
    .如果真结束
    
.如果真结束

.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select ssh from jyda where ssh='”, .标题, “';”)), 假))
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
未知支持库函数_5 (记录集句柄)
.如果真 (大于 (记录数, 0))
    信息框 (“此宿舍已经被教师使用！请更换其它宿舍。”, 0, )
    返回 ()
.如果真结束
赋值 (记录数, 0)


赋值 (条件, 相加 (“xh='”, .标题, “'”))
.如果 (未知支持库函数_19 (连接句柄, “xsda”, 相加 (“ssh='”, .标题, “',cwh='”, .标题, “'”), 条件))
    赋值 (记录日志, 相加 (“更新”, .标题, “同学宿舍完成”))
    写日志 ()
    填充学生表 ()
.否则
    信息框 (相加 (“更新”, .标题, “同学宿舍失败！”), 0, )
.如果结束


.子程序 填充学生表, 空白型, , 填充升级姓名表
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 AA, 整数型, , , 
.局部变量 项目, 整数型, , , 

置等待鼠标 ()
清除学生 ()
全部删除 ()
检查连接 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select xh,xm,xb,ssh,cwh,szbj,zxxz from xsda where szbj like '%”, .内容, “%' and zxxz like '%在校学生%' ORDER BY xh ASC;”)), 假)) ' 导出记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (字段数, 未知支持库函数_14 (记录集句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
.计次循环首 (记录数, )
    置等待鼠标 ()
    赋值 (文本变量, “”)
    未知支持库函数_6 (记录集句柄, “ssh”, 文本变量)
    .如果真 (不等于 (文本变量, “”))
        赋值 (项目, -1.插入表项 ())
        .计次循环首 (字段数, AA)
            未知支持库函数_15 (记录集句柄, 相减 (AA, 1), 字段名)
            未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
            项目.置标题 (相减 (AA, 1), 文本变量)
        .计次循环尾 ()
        项目.置图片 (0, 254)
    .如果真结束
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
赋值 (.内容, 相加 (“本班共有学生”, 到文本 (取表项数 ()), “名”))
恢复鼠标 ()
赋值 (.现行选中项, 0)

.子程序 _超级列表框1_当前表项被改变, 空白型, , 
赋值 (.标题, .取标题 (., 0))
赋值 (.标题, .取标题 (., 1))
赋值 (.标题, .取标题 (., 2))
.选择 (.标题)
赋值 (.标题, .取标题 (., 3))
.选择 (.标题)
赋值 (.标题, .取标题 (., 4))
.选择 (.标题)
赋值 (.标题, .取标题 (., 5))
.选择 (.标题)
相加 (.标题, “-”, .标题, “-”).选择 ()

.子程序 _按钮4_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (“ 请输入新的宿舍号码！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (取文本左边 (.内容, 1), “0”))
    信息框 (“ 新的宿舍号码第一位不能为‘0’位！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (取数据库重复记录 (连接句柄, “setup”, “ssh”, .内容))
    信息框 (“ 此宿舍号码已存在！！！”, 0, )
    赋值 (.内容, “”)
    获取焦点 ()
    返回 ()
.如果真结束
检查连接 ()
.如果 (未知支持库函数_18 (连接句柄, “setup”, 相加 (“ssh='”, .内容, “'”)))
    赋值 (.内容, 到文本 (相加 (到数值 (.内容), 1)))
    信息框 (“ 添加新宿舍号完成！”, 0, )
    刷新宿舍 ()
.否则
    信息框 (“ 添加新宿舍号失败！！”, 0, )
.如果结束


.子程序 刷新宿舍, 空白型, , 
.局部变量 记录句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 A, 整数型, , , 
.局部变量 临时文本, 文本型, , , 

检查连接 ()
.如果真 (未知支持库函数_3 (连接句柄, “select * from setup  ORDER BY ssh ASC; ”))
    赋值 (记录句柄, 未知支持库函数_4 (连接句柄))
    赋值 (记录数, 未知支持库函数_7 (记录句柄))
    未知支持库函数_12 (记录句柄)
    清空 ()
    清空 ()
    清空 ()
    .计次循环首 (记录数, A)
        未知支持库函数_6 (记录句柄, “ssh”, 临时文本)
        .如果真 (不等于 (临时文本, “”))
            临时文本.加入项目 ()
            临时文本.加入项目 ()
            临时文本.加入项目 ()
        .如果真结束
        未知支持库函数_10 (记录句柄)
        处理事件 ()
    .计次循环尾 ()
    未知支持库函数_5 (记录句柄)
    赋值 (.现行选中项, 0)
    赋值 (.现行选中项, 0)
    赋值 (.标题, 相加 (“现在宿舍共有”, 到文本 (取项目数 ()), “间！”))
.如果真结束


.子程序 _按钮7_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (“ 请选择宿舍号码！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
检查连接 ()
.如果 (未知支持库函数_20 (连接句柄, “setup”, 相加 (“ssh='”, .内容, “'”)))
    信息框 (“ 删除宿舍号完成！”, 0, )
    刷新宿舍 ()
    赋值 (.内容, “”)
.否则
    信息框 (“ 删除宿舍号失败！！”, 0, )
.如果结束


.子程序 _列表框1_列表项被选择, 空白型, , 
赋值 (.内容, .取项目文本 (.现行选中项))

.子程序 _按钮2_被单击, 空白型, , 
赋值 (.现行子夹, 2)
.判断开始 (等于 (.现行子夹, 0))
    赋值 (.标题, “学校学生宿舍安排管理”)
.判断 (等于 (.现行子夹, 1))
    赋值 (.标题, “学校教师宿舍安排管理”)
.判断 (等于 (.现行子夹, 2))
    赋值 (.标题, “增加/删除宿舍”)
.默认
    
.判断结束


.子程序 _按钮5_被单击, 空白型, , 
.如果真 (等于 (., -1))
    信息框 (“请选择被删除的同学住室！”, 0, )
    返回 ()
.如果真结束
.如果真 (不等于 (信息框 (相加 (“您必须删除”, .标题, “同学的住室信息吗？”), #是否钮, “!!!”), 5))
    返回 ()
.如果真结束
检查连接 ()
.如果真 (等于 (未知支持库函数_19 (连接句柄, “xsda”, “ssh=' ',cwh=' '”, 相加 (“xh='”, .标题, “'”)), 假))
    信息框 (“ 删除失败！”, 0, )
    返回 ()
.如果真结束
填充学生表 ()


.子程序 _编辑框3_列表项被选择, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 AA, 整数型, , , 
.局部变量 项目, 整数型, , , 

清除学生 ()
置等待鼠标 ()
全部删除 ()
检查连接 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select xh,xm,xb,ssh,cwh,szbj,zxxz from xsda where ssh like '%”, .内容, “%' and zxxz like '%在校学生%' ORDER BY xh ASC;”)), 假)) ' 导出记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (字段数, 未知支持库函数_14 (记录集句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
.计次循环首 (记录数, )
    置等待鼠标 ()
    赋值 (文本变量, “”)
    未知支持库函数_6 (记录集句柄, “ssh”, 文本变量)
    .如果真 (不等于 (文本变量, “”))
        赋值 (项目, -1.插入表项 ())
        .计次循环首 (字段数, AA)
            未知支持库函数_15 (记录集句柄, 相减 (AA, 1), 字段名)
            未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
            项目.置标题 (相减 (AA, 1), 文本变量)
        .计次循环尾 ()
        项目.置图片 (0, 254)
    .如果真结束
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
赋值 (.内容, 相加 (“本宿舍共有”, 0.取标题 (2), “生”, 到文本 (取表项数 ()), “名”))
恢复鼠标 ()
赋值 (.现行选中项, 0)


.子程序 _按钮12_被单击, 空白型, , 
销毁 ()

.子程序 _按钮10_被单击, 空白型, , 
赋值 (.现行子夹, 0)
.判断开始 (等于 (.现行子夹, 0))
    赋值 (.标题, “学校学生宿舍安排管理”)
.判断 (等于 (.现行子夹, 1))
    赋值 (.标题, “学校教师宿舍安排管理”)
.判断 (等于 (.现行子夹, 2))
    赋值 (.标题, “增加/删除宿舍”)
.默认
    
.判断结束


.子程序 _按钮11_被单击, 空白型, , 
赋值 (.现行子夹, 1)
.判断开始 (等于 (.现行子夹, 0))
    赋值 (.标题, “学校学生宿舍安排管理”)
.判断 (等于 (.现行子夹, 1))
    赋值 (.标题, “学校教师宿舍安排管理”)
.判断 (等于 (.现行子夹, 2))
    赋值 (.标题, “增加/删除宿舍”)
.默认
    
.判断结束


.子程序 _按钮8_被单击, 空白型, , 
赋值 (.现行子夹, 2)
.判断开始 (等于 (.现行子夹, 0))
    赋值 (.标题, “学校学生宿舍安排管理”)
.判断 (等于 (.现行子夹, 1))
    赋值 (.标题, “学校教师宿舍安排管理”)
.判断 (等于 (.现行子夹, 2))
    赋值 (.标题, “增加/删除宿舍”)
.默认
    
.判断结束


.子程序 _宿舍号_列表项被选择, 空白型, , 
.局部变量 分开, 文本型, , "0", 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 AA, 整数型, , , 
.局部变量 项目, 整数型, , , 

赋值 (.标题, .内容)
赋值 (.标题, .内容)
赋值 (分开, 分割文本 (.内容, “-”, ))
.如果真 (大于或等于 (取数组成员数 (分开), 3))
    赋值 (.标题, 分开 [1])
    赋值 (.标题, 分开 [2])
    赋值 (.标题, 分开 [3])
    分开.选择 ( [3])
    
.如果真结束
置等待鼠标 ()
清除学生 ()
全部删除 ()
检查连接 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select sfz,xm,xb,ssh,cwh,zzlx from jyda where zzlx like '%在职教员%' and ssh like '%”, .内容, “%' ORDER BY xm ASC;”)), 假)) ' 导出记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (字段数, 未知支持库函数_14 (记录集句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
.计次循环首 (记录数, )
    置等待鼠标 ()
    赋值 (文本变量, “”)
    未知支持库函数_6 (记录集句柄, “ssh”, 文本变量)
    .如果真 (不等于 (文本变量, “”))
        赋值 (项目, -1.插入表项 ())
        .计次循环首 (字段数, AA)
            未知支持库函数_15 (记录集句柄, 相减 (AA, 1), 字段名)
            未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
            项目.置标题 (相减 (AA, 1), 文本变量)
        .计次循环尾 ()
        项目.置图片 (0, 254)
    .如果真结束
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
赋值 (.内容, 相加 (“本宿舍共有教员”, 到文本 (取表项数 ()), “位”))
恢复鼠标 ()


.子程序 _性别_列表项被选择, 空白型, , 
.局部变量 分开, 文本型, , "0", 

赋值 (.标题, .内容)
赋值 (.标题, .内容)
赋值 (分开, 分割文本 (.内容, “-”, ))
.如果真 (大于或等于 (取数组成员数 (分开), 3))
    赋值 (.标题, 分开 [1])
    赋值 (.标题, 分开 [2])
    赋值 (.标题, 分开 [3])
    分开.选择 ( [3])
    
.如果真结束


.子程序 _按钮6_被单击, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 条件, 文本型, , , 

.如果真 (或者 (等于 (.标题, “”), 等于 (.标题, “”), 等于 (.标题, “”), 等于 (.标题, “”)))
    信息框 (“被保存的信息不全面！”, 0, “错误 ”)
    返回 ()
.如果真结束
检查连接 ()
.如果真 (大于或等于 (.查找表项 (.标题, 0, ), 0))
    信息框 (相加 (.标题, “老师已经安排了床位，如果需要更换床位请删除后保存！”), 0, )
    返回 ()
.如果真结束

.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select ssh,cwh from jyda where ssh='”, .标题, “' and cwh='”, .标题, “';”)), 假))
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
未知支持库函数_5 (记录集句柄)
.如果真 (大于 (记录数, 0))
    信息框 (“此床位已经被使用！请更换其它床位。”, 0, )
    返回 ()
.如果真结束
赋值 (记录数, 0)

.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select ssh from xsda where ssh='”, .标题, “';”)), 假))
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
未知支持库函数_5 (记录集句柄)
.如果真 (大于 (记录数, 0))
    信息框 (“此宿舍已经被学生使用！请更换其它宿舍。”, 0, )
    返回 ()
.如果真结束
赋值 (记录数, 0)


赋值 (条件, 相加 (“sfz='”, .标题, “'”))
.如果 (未知支持库函数_19 (连接句柄, “jyda”, 相加 (“ssh='”, .标题, “',cwh='”, .标题, “'”), 条件))
    赋值 (记录日志, 相加 (“保存”, .标题, “教员宿舍完成”))
    写日志 ()
    填充教员表 ()
.否则
    信息框 (相加 (“保存”, .标题, “教员宿舍失败！”), 0, )
.如果结束


.子程序 填充教员表, 空白型, , 填充教员姓名表
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 AA, 整数型, , , 
.局部变量 项目, 整数型, , , 

置等待鼠标 ()
清除学生 ()
全部删除 ()
检查连接 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, “select sfz,xm,xb,ssh,cwh,zzlx from jyda where zzlx like '%在职教员%' ORDER BY xm ASC;”), 假)) ' 导出记录
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (字段数, 未知支持库函数_14 (记录集句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
.计次循环首 (记录数, )
    置等待鼠标 ()
    赋值 (文本变量, “”)
    未知支持库函数_6 (记录集句柄, “ssh”, 文本变量)
    .如果真 (不等于 (文本变量, “”))
        赋值 (项目, -1.插入表项 ())
        .计次循环首 (字段数, AA)
            未知支持库函数_15 (记录集句柄, 相减 (AA, 1), 字段名)
            未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
            项目.置标题 (相减 (AA, 1), 文本变量)
        .计次循环尾 ()
        项目.置图片 (0, 254)
    .如果真结束
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
赋值 (.内容, 相加 (“本校共有教员”, 到文本 (取表项数 ()), “位”))
恢复鼠标 ()

.子程序 _按钮1_被单击, 空白型, , 
.如果真 (等于 (., -1))
    信息框 (“请选择被删除的教员住室！”, 0, )
    返回 ()
.如果真结束
.如果真 (不等于 (信息框 (相加 (“您决定删除”, .标题, “老师的住室信息吗？”), #是否钮, “!!!”), 5))
    返回 ()
.如果真结束
检查连接 ()
.如果真 (等于 (未知支持库函数_19 (连接句柄, “jyda”, “ssh=' ',cwh=' '”, 相加 (“sfz='”, .标题, “'”)), 假))
    信息框 (“ 删除失败！”, 0, )
    返回 ()
.如果真结束
填充教员表 ()


.子程序 _超级列表框2_当前表项被改变, 空白型, , 
清除学生 ()
赋值 (.标题, .取标题 (., 0))
赋值 (.标题, .取标题 (., 1))
赋值 (.标题, .取标题 (., 2))
赋值 (.标题, .取标题 (., 3))
赋值 (.标题, .取标题 (., 4))
.选择 (.标题)
.选择 (.标题)
.选择 (.标题)
相加 (.标题, “-”, .标题, “-”).选择 ()

.窗口程序集 伙食建帐窗口程序集, , , 

.程序集变量 项目位, 整数型, , , 
.程序集变量 搜索时间, 文本型, , , 
.程序集变量 金额, 双精度小数型, , , 
.程序集变量 空, 逻辑型, , "5", 
.子程序 _伙食建帐窗口_创建完毕, 空白型, , 
赋值 (项目位, 0)
.判断开始 (等于 (采集类型, 1))
    赋值 (伙食建帐窗口., “伙食建帐管理”)
    赋值 (.标题, 相加 (_启动窗口..标题, “伙食费用采集”))
.判断 (等于 (采集类型, 2))
    赋值 (伙食建帐窗口., “固定资产或耗材建帐管理”)
    赋值 (.标题, 相加 (_启动窗口..标题, “固定资产或耗材费用采集”))
.默认
    
.判断结束
赋值 (.内容, _启动窗口..标题)
赋值 (.内容, 到文本 (取月份 (取现行时间 ())))
赋值 (.内容, 到文本 (取日 (取现行时间 ())))
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\myfial.ini”), “setup”, “SJSMC”, ))
刷新货名 ()
赋值 (搜索时间, 相加 (到文本 (取年份 (.今天)), “-”, .内容, “-”))
填列表 ()

.子程序 _H10_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (项目位, 1)
赋值 (.顶边, 相加 (.顶边, 4))
赋值 (.可视, 真)
赋值 (.可视, 假)
连续赋值 (真, .可视, .可视, .可视, .可视)

.子程序 _H11_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (项目位, 2)
赋值 (.顶边, 相加 (.顶边, 4))
赋值 (.可视, 真)
赋值 (.可视, 假)
连续赋值 (真, .可视, .可视, .可视, .可视)

.子程序 _H12_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (项目位, 3)
赋值 (.顶边, 相加 (.顶边, 4))
赋值 (.可视, 假)
赋值 (.可视, 真)
连续赋值 (真, .可视, .可视, .可视, .可视)

.子程序 _H13_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (项目位, 4)
赋值 (.顶边, 相加 (.顶边, 4))
赋值 (.可视, 真)
赋值 (.可视, 假)
连续赋值 (真, .可视, .可视, .可视, .可视)

.子程序 _H14_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (项目位, 5)
赋值 (.顶边, 相加 (.顶边, 4))
赋值 (.可视, 假)
赋值 (.可视, 真)
连续赋值 (真, .可视, .可视, .可视, .可视)

.子程序 _蔬菜组合框_列表项被选择, 空白型, , 
.判断开始 (等于 (项目位, 1))
    赋值 (.内容, .内容)
    赋值 (.可视, 真)
.判断 (等于 (项目位, 2))
    赋值 (.内容, .内容)
    赋值 (.可视, 真)
.判断 (等于 (项目位, 3))
    赋值 (.内容, .内容)
    赋值 (.可视, 真)
.判断 (等于 (项目位, 4))
    赋值 (.内容, .内容)
    赋值 (.可视, 真)
.判断 (等于 (项目位, 5))
    赋值 (.内容, .内容)
    赋值 (.可视, 真)
.默认
    
.判断结束
赋值 (项目位, 0)
赋值 (.可视, 假)
连续赋值 (真, .可视, .可视, .可视, .可视, .可视)

.子程序 _编辑框1_调节钮被按下, 空白型, , 
.参数 按钮值, 整数型, , 

.如果 (等于 (按钮值, 1))
    .如果真 (大于或等于 (到数值 (到数值 (.内容)), 12))
        返回 ()
    .如果真结束
    赋值 (.内容, 到文本 (相加 (到数值 (.内容), 1)))
.否则
    .如果真 (小于或等于 (到数值 (到数值 (.内容)), 1))
        返回 ()
    .如果真结束
    赋值 (.内容, 到文本 (相减 (到数值 (.内容), 1)))
.如果结束



.子程序 _编辑框2_调节钮被按下, 空白型, , 
.参数 按钮值, 整数型, , 

.如果 (等于 (按钮值, 1))
    .如果真 (大于或等于 (到数值 (到数值 (.内容)), 31))
        返回 ()
    .如果真结束
    赋值 (.内容, 到文本 (相加 (到数值 (.内容), 1)))
.否则
    .如果真 (小于或等于 (到数值 (到数值 (.内容)), 1))
        返回 ()
    .如果真结束
    赋值 (.内容, 到文本 (相减 (到数值 (.内容), 1)))
.如果结束


.子程序 _H20_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (项目位, 1)
赋值 (.顶边, 相加 (.顶边, 4))
赋值 (.可视, 真)
赋值 (.可视, 假)
连续赋值 (真, .可视, .可视, .可视, .可视)


.子程序 _H21_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (项目位, 2)
赋值 (.顶边, 相加 (.顶边, 4))
赋值 (.可视, 真)
赋值 (.可视, 假)
连续赋值 (真, .可视, .可视, .可视, .可视)

.子程序 _H22_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (项目位, 3)
赋值 (.顶边, 相加 (.顶边, 4))
赋值 (.可视, 真)
赋值 (.可视, 假)
连续赋值 (真, .可视, .可视, .可视, .可视)


.子程序 _H23_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (项目位, 4)
赋值 (.顶边, 相加 (.顶边, 4))
赋值 (.可视, 真)
赋值 (.可视, 假)
连续赋值 (真, .可视, .可视, .可视, .可视)


.子程序 _H24_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (项目位, 5)
赋值 (.顶边, 相加 (.顶边, 4))
赋值 (.可视, 真)
赋值 (.可视, 假)
连续赋值 (真, .可视, .可视, .可视, .可视)


.子程序 _单位组合框_列表项被选择, 空白型, , 
.判断开始 (等于 (项目位, 1))
    赋值 (.内容, .内容)
    赋值 (.可视, 真)
.判断 (等于 (项目位, 2))
    赋值 (.内容, .内容)
    赋值 (.可视, 真)
.判断 (等于 (项目位, 3))
    赋值 (.内容, .内容)
    赋值 (.可视, 真)
.判断 (等于 (项目位, 4))
    赋值 (.内容, .内容)
    赋值 (.可视, 真)
.判断 (等于 (项目位, 5))
    赋值 (.内容, .内容)
    赋值 (.可视, 真)
.默认
    
.判断结束
赋值 (项目位, 0)
赋值 (.可视, 假)
连续赋值 (真, .可视, .可视, .可视, .可视, .可视)


.子程序 _H40_内容被改变, 空白型, , 
.局部变量 小金额, 双精度小数型, , , 
.局部变量 分割金额, 文本型, , "0", 
.局部变量 小写, 双精度小数型, , , 

赋值 (小金额, 四舍五入 (相乘 (到数值 (.内容), 到数值 (.内容)), 2))
赋值 (分割金额, 分割文本 (到文本 (小金额), “.”, ))
.如果 (大于或等于 (取数组成员数 (分割金额), 2))
    赋值 (.内容, 取文本右边 (分割金额 [1], 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 1), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 2), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 3), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 4), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 5), 1))
    赋值 (.内容, 到文本 (到数值 (取文本左边 (分割金额 [2], 1))))
    赋值 (.内容, 到文本 (到数值 (取文本右边 (分割金额 [2], 1))))
.否则
    赋值 (.内容, 取文本右边 (分割金额 [1], 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 1), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 2), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 3), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 4), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 5), 1))
    赋值 (.内容, “0”)
    赋值 (.内容, “0”)
.如果结束
.如果真 (或者 (等于 (到数值 (.内容), 0), 等于 (到数值 (.内容), 0)))
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
    赋值 (小写, 0)
    返回 ()
.如果真结束
计数 ()
.如果真 (大于 (取文本长度 (.内容), 10))
    信息框 (“抱歉！您填写的金额值已超出票额最大值，数量将自动改写为零，请再重新输入数量！”, 0, “金额溢出！”)
    赋值 (.内容, “0”)
.如果真结束


.子程序 _H30_内容被改变, 空白型, , 
_H40_内容被改变 ()

.子程序 _H41_内容被改变, 空白型, , 
.局部变量 小金额, 双精度小数型, , , 
.局部变量 分割金额, 文本型, , "0", 
.局部变量 小写, 双精度小数型, , , 

赋值 (小金额, 四舍五入 (相乘 (到数值 (.内容), 到数值 (.内容)), 2))
赋值 (分割金额, 分割文本 (到文本 (小金额), “.”, ))
.如果 (大于或等于 (取数组成员数 (分割金额), 2))
    赋值 (.内容, 取文本右边 (分割金额 [1], 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 1), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 2), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 3), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 4), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 5), 1))
    赋值 (.内容, 到文本 (到数值 (取文本左边 (分割金额 [2], 1))))
    赋值 (.内容, 到文本 (到数值 (取文本右边 (分割金额 [2], 1))))
.否则
    赋值 (.内容, 取文本右边 (分割金额 [1], 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 1), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 2), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 3), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 4), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 5), 1))
    赋值 (.内容, “0”)
    赋值 (.内容, “0”)
.如果结束
.如果真 (或者 (等于 (到数值 (.内容), 0), 等于 (到数值 (.内容), 0)))
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
    赋值 (小写, 0)
    返回 ()
.如果真结束
计数 ()
.如果真 (大于 (取文本长度 (.内容), 10))
    信息框 (“抱歉！您填写的金额值已超出票额最大值，数量将自动改写为零，请再重新输入数量！”, 0, “金额溢出！”)
    赋值 (.内容, “0”)
.如果真结束


.子程序 计数, 空白型, , 
.局部变量 小写, 双精度小数型, , , 

赋值 (小写, 相加 (四舍五入 (相乘 (到数值 (.内容), 到数值 (.内容)), 2), 四舍五入 (相乘 (到数值 (.内容), 到数值 (.内容)), 2), 四舍五入 (相乘 (到数值 (.内容), 到数值 (.内容)), 2), 四舍五入 (相乘 (到数值 (.内容), 到数值 (.内容)), 2), 四舍五入 (相乘 (到数值 (.内容), 到数值 (.内容)), 2)))
赋值 (.内容, 数值到格式文本 (小写, 2, 假))
赋值 (.内容, 数值到金额 (小写, 假))

.子程序 _H31_内容被改变, 空白型, , 
_H41_内容被改变 ()

.子程序 _H42_内容被改变, 空白型, , 
.局部变量 小金额, 双精度小数型, , , 
.局部变量 分割金额, 文本型, , "0", 
.局部变量 小写, 双精度小数型, , , 

赋值 (小金额, 四舍五入 (相乘 (到数值 (.内容), 到数值 (.内容)), 2))
赋值 (分割金额, 分割文本 (到文本 (小金额), “.”, ))
.如果 (大于或等于 (取数组成员数 (分割金额), 2))
    赋值 (.内容, 取文本右边 (分割金额 [1], 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 1), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 2), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 3), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 4), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 5), 1))
    赋值 (.内容, 到文本 (到数值 (取文本左边 (分割金额 [2], 1))))
    赋值 (.内容, 到文本 (到数值 (取文本右边 (分割金额 [2], 1))))
.否则
    赋值 (.内容, 取文本右边 (分割金额 [1], 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 1), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 2), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 3), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 4), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 5), 1))
    赋值 (.内容, “0”)
    赋值 (.内容, “0”)
.如果结束
.如果真 (或者 (等于 (到数值 (.内容), 0), 等于 (到数值 (.内容), 0)))
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
    赋值 (小写, 0)
    返回 ()
.如果真结束
计数 ()
.如果真 (大于 (取文本长度 (.内容), 10))
    信息框 (“抱歉！您填写的金额值已超出票额最大值，数量将自动改写为零，请再重新输入数量！”, 0, “金额溢出！”)
    赋值 (.内容, “ 0”)
.如果真结束


.子程序 _H32_内容被改变, 空白型, , 
_H42_内容被改变 ()

.子程序 _H43_内容被改变, 空白型, , 
.局部变量 小金额, 双精度小数型, , , 
.局部变量 分割金额, 文本型, , "0", 
.局部变量 小写, 双精度小数型, , , 

赋值 (小金额, 四舍五入 (相乘 (到数值 (.内容), 到数值 (.内容)), 2))
赋值 (分割金额, 分割文本 (到文本 (小金额), “.”, ))
.如果 (大于或等于 (取数组成员数 (分割金额), 2))
    赋值 (.内容, 取文本右边 (分割金额 [1], 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 1), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 2), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 3), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 4), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 5), 1))
    赋值 (.内容, 到文本 (到数值 (取文本左边 (分割金额 [2], 1))))
    赋值 (.内容, 到文本 (到数值 (取文本右边 (分割金额 [2], 1))))
.否则
    赋值 (.内容, 取文本右边 (分割金额 [1], 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 1), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 2), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 3), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 4), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 5), 1))
    赋值 (.内容, “0”)
    赋值 (.内容, “0”)
.如果结束
.如果真 (或者 (等于 (到数值 (.内容), 0), 等于 (到数值 (.内容), 0)))
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
    赋值 (小写, 0)
    返回 ()
.如果真结束
计数 ()
.如果真 (大于 (取文本长度 (.内容), 10))
    信息框 (“抱歉！您填写的金额值已超出票额最大值，数量将自动改写为零，请再重新输入数量！”, 0, “金额溢出！”)
    赋值 (.内容, “ 0”)
.如果真结束


.子程序 _H33_内容被改变, 空白型, , 
_H43_内容被改变 ()

.子程序 _H44_内容被改变, 空白型, , 
.局部变量 小金额, 双精度小数型, , , 
.局部变量 分割金额, 文本型, , "0", 
.局部变量 小写, 双精度小数型, , , 

赋值 (小金额, 四舍五入 (相乘 (到数值 (.内容), 到数值 (.内容)), 2))
赋值 (分割金额, 分割文本 (到文本 (小金额), “.”, ))
.如果 (大于或等于 (取数组成员数 (分割金额), 2))
    赋值 (.内容, 取文本右边 (分割金额 [1], 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 1), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 2), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 3), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 4), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 5), 1))
    赋值 (.内容, 到文本 (到数值 (取文本左边 (分割金额 [2], 1))))
    赋值 (.内容, 到文本 (到数值 (取文本右边 (分割金额 [2], 1))))
.否则
    赋值 (.内容, 取文本右边 (分割金额 [1], 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 1), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 2), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 3), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 4), 1))
    赋值 (.内容, 取文本中间 (分割金额 [1], 相减 (取文本长度 (分割金额 [1]), 5), 1))
    赋值 (.内容, “0”)
    赋值 (.内容, “0”)
.如果结束
.如果真 (或者 (等于 (到数值 (.内容), 0), 等于 (到数值 (.内容), 0)))
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
    赋值 (小写, 0)
    返回 ()
.如果真结束
计数 ()
.如果真 (大于 (取文本长度 (.内容), 10))
    信息框 (“抱歉！您填写的金额值已超出票额最大值，数量将自动改写为零，请再重新输入数量！”, 0, “金额溢出！”)
    赋值 (.内容, “ 0”)
.如果真结束


.子程序 _H34_内容被改变, 空白型, , 
_H44_内容被改变 ()

.子程序 保存货名, 空白型, , 
.局部变量 数据库, 文本型, , , 

赋值 (数据库, 相加 (取运行目录 (), “\sql\SCMSQL.edb”))
.判断开始 (等于 (采集类型, 1))
    .如果真 (打开 (数据库, , , , , , ))
        置当前库 (数据库)
        到首记录 ()
        .如果 (查找 (等于 (.内容, 读 (1))))
            
        .否则
            .如果真 (不等于 (.内容, “”))
                加记录 (.内容)
            .如果真结束
            
        .如果结束
        到首记录 ()
        .如果 (查找 (等于 (.内容, 读 (1))))
            
        .否则
            .如果真 (不等于 (.内容, “”))
                加记录 (.内容)
            .如果真结束
            
        .如果结束
        到首记录 ()
        .如果 (查找 (等于 (.内容, 读 (1))))
            
        .否则
            .如果真 (不等于 (.内容, “”))
                加记录 (.内容)
            .如果真结束
            
        .如果结束
        到首记录 ()
        .如果 (查找 (等于 (.内容, 读 (1))))
            
        .否则
            .如果真 (不等于 (.内容, “”))
                加记录 (.内容)
            .如果真结束
            
        .如果结束
        到首记录 ()
        .如果 (查找 (等于 (.内容, 读 (1))))
            
        .否则
            .如果真 (不等于 (.内容, “”))
                加记录 (.内容)
            .如果真结束
            
        .如果结束
        关闭 (数据库)
    .如果真结束
    
.判断 (等于 (采集类型, 2))
    .如果真 (打开 (数据库, , , , , , ))
        置当前库 (数据库)
        到首记录 ()
        .如果 (查找 (等于 (.内容, 读 (2))))
            
        .否则
            .如果真 (不等于 (.内容, “”))
                加记录 (.内容)
            .如果真结束
            
        .如果结束
        .如果 (查找 (等于 (.内容, 读 (2))))
            
        .否则
            .如果真 (不等于 (.内容, “”))
                加记录 (.内容)
            .如果真结束
            
        .如果结束
        .如果 (查找 (等于 (.内容, 读 (2))))
            
        .否则
            .如果真 (不等于 (.内容, “”))
                加记录 (.内容)
            .如果真结束
            
        .如果结束
        .如果 (查找 (等于 (.内容, 读 (2))))
            
        .否则
            .如果真 (不等于 (.内容, “”))
                加记录 (.内容)
            .如果真结束
            
        .如果结束
        .如果 (查找 (等于 (.内容, 读 (2))))
            
        .否则
            .如果真 (不等于 (.内容, “”))
                加记录 (.内容)
            .如果真结束
            
        .如果结束
        关闭 (数据库)
    .如果真结束
    
.默认
    
.判断结束


.子程序 刷新货名, 空白型, , 
.局部变量 数据库, 文本型, , , 

赋值 (数据库, 相加 (取运行目录 (), “\sql\SCMSQL.edb”))
.判断开始 (等于 (采集类型, 1))
    .如果真 (打开 (数据库, , , , , , ))
        置当前库 (数据库)
        到首记录 ()
        清空 ()
        .计次循环首 (取记录数 (), )
            .如果真 (不等于 (读 (1), “”))
                读 (1).加入项目 ()
            .如果真结束
            跳过 ()
        .计次循环尾 ()
        关闭 (数据库)
        赋值 (.现行选中项, 0)
    .如果真结束
    
.判断 (等于 (采集类型, 2))
    .如果真 (打开 (数据库, , , , , , ))
        置当前库 (数据库)
        到首记录 ()
        清空 ()
        .计次循环首 (取记录数 (), )
            .如果真 (不等于 (读 (2), “”))
                读 (2).加入项目 ()
            .如果真结束
            跳过 ()
        .计次循环尾 ()
        关闭 (数据库)
        赋值 (.现行选中项, 0)
    .如果真结束
    
.默认
    
.判断结束


.子程序 _保存_被单击, 空白型, , 
.局部变量 条件, 文本型, , "5", 
.局部变量 错误, 文本型, , , 

保存货名 ()
检查连接 ()
.如果真 (等于 (.内容, “”))
    信息框 (“请填写收据编号！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“第一项必须填写数据！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (取数据库重复记录 (连接句柄, “scb”, “djh”, .内容))
    信息框 (“收据号填写重复！！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (条件 [1], 相加 (“djh='”, .内容, “',fksj='”, 到文本 (取年份 (.今天)), “-”, .内容, “-”, .内容, “',fkr='”, .内容, “',shy='”, .内容, “',skr='”, .内容, “',tpr='”, .内容, “',hh='”, .内容, “',pmgg='”, .内容, “',dw='”, .内容, “',sl='”, .内容, “',dj='”, .内容, “',sw='”, .内容, “',w='”, .内容, “',q='”, .内容, “',b='”, .内容, “',s='”, .内容, “',y='”, .内容, “',j='”, .内容, “',f='”, .内容, “',zje='”, .内容, “',bz='”, .内容, “',cjlx='”, 到文本 (采集类型), “',SY='1'”))
赋值 (条件 [2], 相加 (“djh='”, .内容, “',fksj='”, 到文本 (取年份 (.今天)), “-”, .内容, “-”, .内容, “',fkr='”, .内容, “',shy='”, .内容, “',skr='”, .内容, “',tpr='”, .内容, “',hh='”, .内容, “',pmgg='”, .内容, “',dw='”, .内容, “',sl='”, .内容, “',dj='”, .内容, “',sw='”, .内容, “',w='”, .内容, “',q='”, .内容, “',b='”, .内容, “',s='”, .内容, “',y='”, .内容, “',j='”, .内容, “',f='”, .内容, “',zje='”, .内容, “',bz='”, .内容, “',cjlx='”, 到文本 (采集类型), “',SY='2'”))
赋值 (条件 [3], 相加 (“djh='”, .内容, “',fksj='”, 到文本 (取年份 (.今天)), “-”, .内容, “-”, .内容, “',fkr='”, .内容, “',shy='”, .内容, “',skr='”, .内容, “',tpr='”, .内容, “',hh='”, .内容, “',pmgg='”, .内容, “',dw='”, .内容, “',sl='”, .内容, “',dj='”, .内容, “',sw='”, .内容, “',w='”, .内容, “',q='”, .内容, “',b='”, .内容, “',s='”, .内容, “',y='”, .内容, “',j='”, .内容, “',f='”, .内容, “',zje='”, .内容, “',bz='”, .内容, “',cjlx='”, 到文本 (采集类型), “',SY='3'”))
赋值 (条件 [4], 相加 (“djh='”, .内容, “',fksj='”, 到文本 (取年份 (.今天)), “-”, .内容, “-”, .内容, “',fkr='”, .内容, “',shy='”, .内容, “',skr='”, .内容, “',tpr='”, .内容, “',hh='”, .内容, “',pmgg='”, .内容, “',dw='”, .内容, “',sl='”, .内容, “',dj='”, .内容, “',sw='”, .内容, “',w='”, .内容, “',q='”, .内容, “',b='”, .内容, “',s='”, .内容, “',y='”, .内容, “',j='”, .内容, “',f='”, .内容, “',zje='”, .内容, “',bz='”, .内容, “',cjlx='”, 到文本 (采集类型), “',SY='4'”))
赋值 (条件 [5], 相加 (“djh='”, .内容, “',fksj='”, 到文本 (取年份 (.今天)), “-”, .内容, “-”, .内容, “',fkr='”, .内容, “',shy='”, .内容, “',skr='”, .内容, “',tpr='”, .内容, “',hh='”, .内容, “',pmgg='”, .内容, “',dw='”, .内容, “',sl='”, .内容, “',dj='”, .内容, “',sw='”, .内容, “',w='”, .内容, “',q='”, .内容, “',b='”, .内容, “',s='”, .内容, “',y='”, .内容, “',j='”, .内容, “',f='”, .内容, “',zje='”, .内容, “',bz='”, .内容, “',cjlx='”, 到文本 (采集类型), “',SY='5'”))
.如果真 (不等于 (.内容, “”))
    .如果真 (等于 (未知支持库函数_18 (连接句柄, “scb”, 条件 [1]), 假))
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (错误, 0, )
        返回 ()
    .如果真结束
    
.如果真结束
.如果真 (不等于 (.内容, “”))
    .如果真 (等于 (未知支持库函数_18 (连接句柄, “scb”, 条件 [2]), 假))
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (错误, 0, )
        返回 ()
    .如果真结束
    
.如果真结束
.如果真 (不等于 (.内容, “”))
    .如果真 (等于 (未知支持库函数_18 (连接句柄, “scb”, 条件 [3]), 假))
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (错误, 0, )
        返回 ()
    .如果真结束
    
.如果真结束
.如果真 (不等于 (.内容, “”))
    .如果真 (等于 (未知支持库函数_18 (连接句柄, “scb”, 条件 [4]), 假))
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (错误, 0, )
        返回 ()
    .如果真结束
    
.如果真结束
.如果真 (不等于 (.内容, “”))
    .如果真 (等于 (未知支持库函数_18 (连接句柄, “scb”, 条件 [5]), 假))
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (错误, 0, )
        返回 ()
    .如果真结束
    
.如果真结束
.如果 (等于 (采集类型, 1))
    赋值 (记录日志, 相加 (“完成伙食票据”, .内容, “记录”))
    写日志 ()
    信息框 (相加 (“完成伙食票据”, .内容, “记录”), 0, )
.否则
    赋值 (记录日志, 相加 (“完成资产票据”, .内容, “记录”))
    写日志 ()
    信息框 (相加 (“完成资产票据”, .内容, “记录”), 0, )
.如果结束
赋值 (.内容, 到文本 (相加 (到数值 (.内容), 1)))
赋值 (搜索时间, 相加 (到文本 (取年份 (.今天)), “-”, .内容, “-”))
填列表 ()
刷新货名 ()
清空内容 ()

.子程序 清空内容, 空白型, , 
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)

.子程序 _单位组合框_获得焦点, 空白型, , 
赋值 (.可视, 假)
连续赋值 (真, .可视, .可视, .可视, .可视, .可视)

.子程序 _蔬菜组合框_获得焦点, 空白型, , 
赋值 (.可视, 假)
连续赋值 (真, .可视, .可视, .可视, .可视, .可视)


.子程序 填列表, 空白型, , 
.局部变量 记录句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 表项索引, 整数型, , , 
.局部变量 A, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 s, 整数型, , , 
.局部变量 W, 文本型, , "0", 
.局部变量 N, 整数型, , , 

检查连接 ()
置等待鼠标 ()
.判断开始 (等于 (采集类型, 1))
    .如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select djh,fksj,zje,tpr,fkr,shy from scb where fksj like '%”, 搜索时间, “%' and cjlx like '%1%' ORDER BY djh ASC;”)), 假))
        提示错误 ()
        返回 ()
    .如果真结束
    
.判断 (等于 (采集类型, 2))
    .如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select djh,fksj,zje,tpr,fkr,shy from scb where fksj like '%”, 搜索时间, “%' and cjlx like '%2%' ORDER BY djh ASC;”)), 假))
        提示错误 ()
        返回 ()
    .如果真结束
    
    
.默认
    
.判断结束

赋值 (记录句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录句柄))
赋值 (字段数, 未知支持库函数_14 (记录句柄))
未知支持库函数_12 (记录句柄)
全部删除 ()
.计次循环首 (记录数, )
    置等待鼠标 ()
    未知支持库函数_6 (记录句柄, “djh”, 文本变量)
    
    .如果真 (等于 (文本变量.查找表项 (0, ), -1))
        赋值 (表项索引, -1.插入表项 ())
        .计次循环首 (字段数, A)
            赋值 (文本变量, “”)
            赋值 (字段名, “”)
            未知支持库函数_15 (记录句柄, 相减 (A, 1), 字段名)
            未知支持库函数_6 (记录句柄, 字段名, 文本变量)
            表项索引.置标题 (相减 (A, 1), 文本变量)
        .计次循环尾 ()
    .如果真结束
    未知支持库函数_10 (记录句柄)
    表项索引.置图片 (0, 12)
    处理事件 ()
.计次循环尾 ()
未知支持库函数_5 (记录句柄)
赋值 (A, 0)
赋值 (金额, 0)
清空 ()
.计次循环首 (取表项数 (), A)
    .如果真 (或者 (等于 (相减 (A, 1).取标题 (5), “”), 等于 (相减 (A, 1).取标题 (5), “空”)))
        相减 (A, 1).取标题 (0).加入项目 ()
    .如果真结束
    赋值 (W, 分割文本 (相减 (A, 1).取标题 (2), “,”, ))
    .如果 (大于或等于 (取数组成员数 (W), 2))
        赋值 (文本变量, “”)
        .计次循环首 (取数组成员数 (W), N)
            赋值 (文本变量, 相加 (文本变量, W [N]))
        .计次循环尾 ()
        赋值 (金额, 相加 (到数值 (文本变量), 金额))
    .否则
        赋值 (金额, 相加 (到数值 (相减 (A, 1).取标题 (2)), 金额))
        
    .如果结束
    
.计次循环尾 ()
赋值 (.标题, 相加 (“未审核单据有”, 到文本 (取项目数 ()), “张”))
赋值 (.内容, 数值到格式文本 (金额, 2, 真))
赋值 (.内容, 到文本 (取表项数 ()))
赋值 (.现行选中项, 0)
恢复鼠标 ()

.子程序 _按月按钮_被单击, 空白型, , 
赋值 (搜索时间, 相加 (到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”))
填列表 ()
赋值 (.内容, 到文本 (0))
赋值 (.内容, 数值到格式文本 (0, 2, 假))

.子程序 _按日按钮_被单击, 空白型, , 
赋值 (搜索时间, 相加 (到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天))))
填列表 ()
赋值 (.内容, 到文本 (取表项数 ()))
赋值 (.内容, 数值到格式文本 (金额, 2, 真))

.子程序 _超级列表框1_当前表项被改变, 空白型, , 
.局部变量 项目名, 文本型, , , 
.局部变量 记录句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 时间, 日期时间型, , , 

赋值 (项目名, .取标题 (., 0))
.如果真 (等于 (项目名, “”))
    返回 ()
.如果真结束
检查连接 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select * from scb where djh='”, 项目名, “' ORDER BY djh ASC;”)), 假))
    提示错误 ()
    返回 ()
.如果真结束
赋值 (记录句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录句柄))
未知支持库函数_12 (记录句柄)
清空内容 ()
.如果真 (大于或等于 (记录数, 1))
    未知支持库函数_6 (记录句柄, “djh”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “fksj”, 文本变量)
    赋值 (时间, 到时间 (相加 (文本变量, “-12:01:01”)))
    赋值 (.今天, 时间)
    赋值 (.内容, 到文本 (取月份 (时间)))
    赋值 (.内容, 到文本 (取日 (时间)))
    未知支持库函数_6 (记录句柄, “fkje”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “tpr”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “fkr”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “shy”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “hh”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “pmgg”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “dw”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “sl”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “dj”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “sw”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “w”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “q”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “b”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “s”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “y”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “j”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “f”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “zje”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “bz”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “skr”, 文本变量)
    赋值 (.内容, 文本变量)
    
.如果真结束
未知支持库函数_10 (记录句柄)
.如果真 (大于或等于 (记录数, 2))
    未知支持库函数_6 (记录句柄, “djh”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “fksj”, 文本变量)
    赋值 (时间, 到时间 (相加 (文本变量, “-12:01:01”)))
    赋值 (.今天, 时间)
    赋值 (.内容, 到文本 (取月份 (时间)))
    赋值 (.内容, 到文本 (取日 (时间)))
    未知支持库函数_6 (记录句柄, “fkje”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “tpr”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “fkr”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “shy”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “hh”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “pmgg”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “dw”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “sl”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “dj”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “sw”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “w”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “q”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “b”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “s”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “y”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “j”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “f”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “zje”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “bz”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “skr”, 文本变量)
    赋值 (.内容, 文本变量)
    
.如果真结束
未知支持库函数_10 (记录句柄)
.如果真 (大于或等于 (记录数, 3))
    未知支持库函数_6 (记录句柄, “djh”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “fksj”, 文本变量)
    赋值 (时间, 到时间 (相加 (文本变量, “-12:01:01”)))
    赋值 (.今天, 时间)
    赋值 (.内容, 到文本 (取月份 (时间)))
    赋值 (.内容, 到文本 (取日 (时间)))
    未知支持库函数_6 (记录句柄, “fkje”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “tpr”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “fkr”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “shy”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “hh”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “pmgg”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “dw”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “sl”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “dj”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “sw”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “w”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “q”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “b”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “s”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “y”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “j”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “f”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “zje”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “bz”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “skr”, 文本变量)
    赋值 (.内容, 文本变量)
    
.如果真结束
未知支持库函数_10 (记录句柄)
.如果真 (大于或等于 (记录数, 4))
    未知支持库函数_6 (记录句柄, “djh”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “fksj”, 文本变量)
    赋值 (时间, 到时间 (相加 (文本变量, “-12:01:01”)))
    赋值 (.今天, 时间)
    赋值 (.内容, 到文本 (取月份 (时间)))
    赋值 (.内容, 到文本 (取日 (时间)))
    未知支持库函数_6 (记录句柄, “fkje”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “tpr”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “fkr”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “shy”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “hh”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “pmgg”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “dw”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “sl”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “dj”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “sw”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “w”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “q”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “b”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “s”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “y”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “j”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “f”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “zje”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “bz”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “skr”, 文本变量)
    赋值 (.内容, 文本变量)
    
.如果真结束
未知支持库函数_10 (记录句柄)
.如果真 (大于或等于 (记录数, 5))
    未知支持库函数_6 (记录句柄, “djh”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “fksj”, 文本变量)
    赋值 (时间, 到时间 (相加 (文本变量, “-12:01:01”)))
    赋值 (.今天, 时间)
    赋值 (.内容, 到文本 (取月份 (时间)))
    赋值 (.内容, 到文本 (取日 (时间)))
    未知支持库函数_6 (记录句柄, “fkje”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “tpr”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “fkr”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “shy”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “hh”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “pmgg”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “dw”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “sl”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “dj”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “sw”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “w”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “q”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “b”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “s”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “y”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “j”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “f”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “zje”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “bz”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “skr”, 文本变量)
    赋值 (.内容, 文本变量)
    
.如果真结束
未知支持库函数_5 (记录句柄)
.如果 (等于 (.内容, “”))
    赋值 (空 [1], 真)
.否则
    赋值 (空 [1], 假)
.如果结束
.如果 (等于 (.内容, “”))
    赋值 (空 [2], 真)
.否则
    赋值 (空 [2], 假)
.如果结束
.如果 (等于 (.内容, “”))
    赋值 (空 [3], 真)
.否则
    赋值 (空 [3], 假)
.如果结束
.如果 (等于 (.内容, “”))
    赋值 (空 [4], 真)
.否则
    赋值 (空 [4], 假)
.如果结束
.如果 (等于 (.内容, “”))
    赋值 (空 [5], 真)
.否则
    赋值 (空 [5], 假)
.如果结束


.子程序 _删除_被单击, 空白型, , 
.局部变量 wb, 文本型, , "0", 
.局部变量 项目名, 文本型, , , 

赋值 (项目名, .取标题 (., 0))
.如果真 (等于 (项目名, “”))
    返回 ()
.如果真结束
检查连接 ()
.如果真 (等于 (信息框 (“您决定删除此条记录吗？否则请按取消键！”, 相加 (#确认取消钮, #警告图标), “删除警告！！！”), #取消钮))
    返回 ()
.如果真结束
.如果 (或者 (等于 (.取标题 (., 5), “”), 等于 (.取标题 (., 5), “空”)))
    .如果 (未知支持库函数_20 (连接句柄, “scb”, 相加 (“djh='”, 项目名, “'”)))
        赋值 (记录日志, 相加 (“删除伙食记录 ”, 项目名, “成功”))
        写日志 ()
        信息框 (相加 (“删除伙食记录 ”, 项目名, “成功!”), 0, )
        填列表 ()
    .否则
        提示错误 ()
    .如果结束
    
.否则
    .如果真 (等于 (信息框 (相加 (“权限警告！”, #换行符, “    通过审核过的单据您当前无权删除！如果您拥有删除权，请单击[确认]键后输入密码！”), #确认取消钮, “警告！”), #取消钮))
        返回 ()
    .如果真结束
    .判断开始 (等于 (采集类型, 1))
        载入 (管理员登录窗口, _启动窗口, 真)
        .如果真 (等于 (password, “”))
            返回 ()
        .如果真结束
        赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
        .如果真 (不等于 (取数组成员数 (wb), 20))
            信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
            返回 ()
        .如果真结束
        .如果真 (等于 (wb [16], “30”))
            信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
            返回 ()
        .如果真结束
        .如果 (未知支持库函数_20 (连接句柄, “scb”, 相加 (“djh='”, 项目名, “'”)))
            赋值 (记录日志, 相加 (“删除伙食记录 ”, 项目名, “成功”))
            写日志 ()
            信息框 (相加 (“删除伙食记录 ”, 项目名, “成功!”), 0, )
            填列表 ()
        .否则
            提示错误 ()
        .如果结束
        
        
    .判断 (等于 (采集类型, 2))
        载入 (管理员登录窗口, _启动窗口, 真)
        .如果真 (等于 (password, “”))
            返回 ()
        .如果真结束
        赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
        .如果真 (不等于 (取数组成员数 (wb), 20))
            信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
            返回 ()
        .如果真结束
        .如果真 (等于 (wb [14], “26”))
            信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
            返回 ()
        .如果真结束
        .如果 (未知支持库函数_20 (连接句柄, “scb”, 相加 (“djh='”, 项目名, “'”)))
            赋值 (记录日志, 相加 (“删除伙食记录 ”, 项目名, “成功”))
            写日志 ()
            信息框 (相加 (“删除伙食记录 ”, 项目名, “成功!”), 0, )
            填列表 ()
        .否则
            提示错误 ()
        .如果结束
        
    .默认
        
    .判断结束
    
.如果结束



.子程序 _条件按钮_被单击, 空白型, , 
.局部变量 记录句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 表项索引, 整数型, , , 
.局部变量 A, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 s, 整数型, , , 
.局部变量 W, 文本型, , "0", 
.局部变量 N, 整数型, , , 
.局部变量 搜索条件, 文本型, , , 

检查连接 ()
置等待鼠标 ()
.判断开始 (等于 (采集类型, 1))
    .判断开始 (等于 (.现行选中项, 0))
        赋值 (搜索条件, 相加 (“where djh like '%”, .内容, “%' and cjlx like '%1%'”))
    .判断 (等于 (.现行选中项, 1))
        赋值 (搜索条件, 相加 (“where tpr like '%”, .内容, “%' and cjlx like '%1%'”))
    .判断 (等于 (.现行选中项, 2))
        赋值 (搜索条件, 相加 (“where shy like '%”, .内容, “%' and cjlx like '%1%'”))
    .默认
        赋值 (搜索条件, 相加 (“where fksj like '%”, 搜索时间, “%' and cjlx like '%1%'”))
    .判断结束
    
.判断 (等于 (采集类型, 2))
    .判断开始 (等于 (.现行选中项, 0))
        赋值 (搜索条件, 相加 (“where djh like '%”, .内容, “%' and cjlx like '%2%'”))
    .判断 (等于 (.现行选中项, 1))
        赋值 (搜索条件, 相加 (“where tpr like '%”, .内容, “%' and cjlx like '%2%'”))
    .判断 (等于 (.现行选中项, 2))
        赋值 (搜索条件, 相加 (“where shy like '%”, .内容, “%' and cjlx like '%2%'”))
    .默认
        赋值 (搜索条件, 相加 (“where fksj like '%”, 搜索时间, “%' and cjlx like '%2%'”))
    .判断结束
    
    
.默认
    
.判断结束

.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select djh,fksj,zje,tpr,fkr,shy from scb ”, 搜索条件, “ ORDER BY djh ASC;”)), 假))
    提示错误 ()
    返回 ()
.如果真结束
赋值 (记录句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录句柄))
赋值 (字段数, 未知支持库函数_14 (记录句柄))
未知支持库函数_12 (记录句柄)
全部删除 ()
.计次循环首 (记录数, )
    置等待鼠标 ()
    未知支持库函数_6 (记录句柄, “djh”, 文本变量)
    .如果真 (等于 (文本变量.查找表项 (0, ), -1))
        赋值 (表项索引, -1.插入表项 ())
        .计次循环首 (字段数, A)
            赋值 (文本变量, “”)
            赋值 (字段名, “”)
            未知支持库函数_15 (记录句柄, 相减 (A, 1), 字段名)
            未知支持库函数_6 (记录句柄, 字段名, 文本变量)
            表项索引.置标题 (相减 (A, 1), 文本变量)
        .计次循环尾 ()
    .如果真结束
    未知支持库函数_10 (记录句柄)
    表项索引.置图片 (0, 12)
    处理事件 ()
.计次循环尾 ()
未知支持库函数_5 (记录句柄)
赋值 (A, 0)
赋值 (金额, 0)
清空 ()
.计次循环首 (取表项数 (), A)
    .如果真 (或者 (等于 (相减 (A, 1).取标题 (5), “”), 等于 (相减 (A, 1).取标题 (5), “空”)))
        相减 (A, 1).取标题 (0).加入项目 ()
    .如果真结束
    赋值 (W, 分割文本 (相减 (A, 1).取标题 (2), “,”, ))
    .如果 (大于或等于 (取数组成员数 (W), 2))
        赋值 (文本变量, “”)
        .计次循环首 (取数组成员数 (W), N)
            赋值 (文本变量, 相加 (文本变量, W [N]))
        .计次循环尾 ()
        赋值 (金额, 相加 (到数值 (文本变量), 金额))
    .否则
        赋值 (金额, 相加 (到数值 (相减 (A, 1).取标题 (2)), 金额))
        
    .如果结束
    
.计次循环尾 ()
赋值 (.标题, 相加 (“未审核单据有”, 到文本 (取项目数 ()), “张”))
赋值 (.内容, 数值到格式文本 (金额, 2, 真))
赋值 (.内容, 到文本 (取表项数 ()))
赋值 (.现行选中项, 0)
赋值 (.内容, 到文本 (0))
赋值 (.内容, 数值到格式文本 (0, 2, 假))
恢复鼠标 ()


.子程序 _审核按钮_被单击, 空白型, , 
.局部变量 wb, 文本型, , "0", 
.局部变量 签名, 文本型, , , 
.局部变量 票, 文本型, , , 

赋值 (票, .内容)
.如果真 (等于 (票, “”))
    信息框 (“请选择被审核的票据号！”, 0, )
    返回 ()
.如果真结束
.判断开始 (等于 (采集类型, 1))
    载入 (管理员登录窗口, _启动窗口, 真)
    .如果真 (等于 (password, “”))
        返回 ()
    .如果真结束
    赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
    .如果真 (不等于 (取数组成员数 (wb), 20))
        信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
        返回 ()
    .如果真结束
    .如果真 (等于 (wb [16], “30”))
        信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
        返回 ()
    .如果真结束
    .如果真 (输入框 (相加 (“票据号[”, 票, “]审核提示！”, #换行符, “    您当前拥有对伙食采购的审查权，请输入您的签名！”), “物资采购单据审查”, “您的签名”, 签名, ))
        .如果真 (等于 (签名, “”))
            信息框 (“没有签名！”, 0, )
            返回 ()
        .如果真结束
        .如果真 (未知支持库函数_19 (连接句柄, “scb”, 相加 (“shy='”, 签名, “'”), 相加 (“djh='”, 票, “'”)))
            信息框 (相加 (“审核票据号”, 票, “]完成”), 0, )
            赋值 (记录日志, 相加 (“审核票据号”, 票, “]完成”))
            写日志 ()
            填列表 ()
        .如果真结束
        
    .如果真结束
    
.判断 (等于 (采集类型, 2))
    载入 (管理员登录窗口, _启动窗口, 真)
    .如果真 (等于 (password, “”))
        返回 ()
    .如果真结束
    赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
    .如果真 (不等于 (取数组成员数 (wb), 20))
        信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
        返回 ()
    .如果真结束
    .如果真 (等于 (wb [14], “26”))
        信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
        返回 ()
    .如果真结束
    .如果真 (输入框 (相加 (“票据号[”, 票, “]审核提示！”, #换行符, “    您当前拥有对物资采购的审查权，请输入您的签名！”), “物资采购单据审查”, “您的签名”, 签名, ))
        .如果真 (等于 (签名, “”))
            信息框 (“没有签名！”, 0, )
            返回 ()
        .如果真结束
        .如果真 (未知支持库函数_19 (连接句柄, “scb”, 相加 (“shy='”, 签名, “'”), 相加 (“djh='”, 票, “'”)))
            信息框 (相加 (“审核票据号”, 票, “]完成”), 0, )
            赋值 (记录日志, 相加 (“审核票据号”, 票, “]完成”))
            写日志 ()
            填列表 ()
        .如果真结束
        
    .如果真结束
    
.默认
    
.判断结束



.子程序 _新建_被单击, 空白型, , 
.局部变量 数, 整数型, , , 
.局部变量 数A, 文本型, , , 

清空内容 ()
赋值 (.今天, 取现行时间 ())
赋值 (.内容, 到文本 (取月份 (取现行时间 ())))
赋值 (.内容, 到文本 (取日 (取现行时间 ())))
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “100000”)
.如果真结束
赋值 (数A, 相加 (取文本左边 (.内容, 1), 到文本 (相加 (取表项数 (), 1))))
.判断开始 (等于 (取文本长度 (.内容), 取文本长度 (数A)))
    赋值 (.内容, 相加 (取文本左边 (.内容, 1), 到文本 (相加 (取表项数 (), 1))))
.判断 (等于 (相减 (取文本长度 (.内容), 取文本长度 (数A)), 1))
    赋值 (.内容, 相加 (取文本左边 (.内容, 1), “0”, 到文本 (相加 (取表项数 (), 1))))
.判断 (等于 (相减 (取文本长度 (.内容), 取文本长度 (数A)), 2))
    赋值 (.内容, 相加 (取文本左边 (.内容, 1), “00”, 到文本 (相加 (取表项数 (), 1))))
.判断 (等于 (相减 (取文本长度 (.内容), 取文本长度 (数A)), 3))
    赋值 (.内容, 相加 (取文本左边 (.内容, 1), “000”, 到文本 (相加 (取表项数 (), 1))))
.判断 (等于 (相减 (取文本长度 (.内容), 取文本长度 (数A)), 4))
    赋值 (.内容, 相加 (取文本左边 (.内容, 1), “0000”, 到文本 (相加 (取表项数 (), 1))))
.判断 (等于 (相减 (取文本长度 (.内容), 取文本长度 (数A)), 5))
    赋值 (.内容, 相加 (取文本左边 (.内容, 1), “00000”, 到文本 (相加 (取表项数 (), 1))))
.判断 (等于 (相减 (取文本长度 (.内容), 取文本长度 (数A)), 6))
    赋值 (.内容, 相加 (取文本左边 (.内容, 1), “000000”, 到文本 (相加 (取表项数 (), 1))))
.判断 (等于 (相减 (取文本长度 (.内容), 取文本长度 (数A)), 7))
    赋值 (.内容, 相加 (取文本左边 (.内容, 1), “0000000”, 到文本 (相加 (取表项数 (), 1))))
.判断 (等于 (相减 (取文本长度 (.内容), 取文本长度 (数A)), 8))
    赋值 (.内容, 相加 (取文本左边 (.内容, 1), “00000000”, 到文本 (相加 (取表项数 (), 1))))
.默认
    
.判断结束




.子程序 _修改_被单击, 空白型, , 
.局部变量 条件, 文本型, , "5", 
.局部变量 错误, 文本型, , , 
.局部变量 收据, 文本型, , , 
.局部变量 增加条件, 文本型, , , 

检查连接 ()
赋值 (收据, .内容)
.如果真 (等于 (收据, “”))
    信息框 (“请填写收据编号！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“第一项必须填写数据！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (不等于 (.内容, “”))
    信息框 (“抱歉！审核过的单据不可以修改！！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (条件 [1], 相加 (“fksj='”, 到文本 (取年份 (.今天)), “-”, .内容, “-”, .内容, “',fkr='”, .内容, “',shy='”, .内容, “',skr='”, .内容, “',tpr='”, .内容, “',hh='”, .内容, “',pmgg='”, .内容, “',dw='”, .内容, “',sl='”, .内容, “',dj='”, .内容, “',sw='”, .内容, “',w='”, .内容, “',q='”, .内容, “',b='”, .内容, “',s='”, .内容, “',y='”, .内容, “',j='”, .内容, “',f='”, .内容, “',zje='”, .内容, “',bz='”, .内容, “',cjlx='”, 到文本 (采集类型), “',SY='1'”))
赋值 (条件 [2], 相加 (“fksj='”, 到文本 (取年份 (.今天)), “-”, .内容, “-”, .内容, “',fkr='”, .内容, “',shy='”, .内容, “',skr='”, .内容, “',tpr='”, .内容, “',hh='”, .内容, “',pmgg='”, .内容, “',dw='”, .内容, “',sl='”, .内容, “',dj='”, .内容, “',sw='”, .内容, “',w='”, .内容, “',q='”, .内容, “',b='”, .内容, “',s='”, .内容, “',y='”, .内容, “',j='”, .内容, “',f='”, .内容, “',zje='”, .内容, “',bz='”, .内容, “',cjlx='”, 到文本 (采集类型), “',SY='2'”))
赋值 (条件 [3], 相加 (“fksj='”, 到文本 (取年份 (.今天)), “-”, .内容, “-”, .内容, “',fkr='”, .内容, “',shy='”, .内容, “',skr='”, .内容, “',tpr='”, .内容, “',hh='”, .内容, “',pmgg='”, .内容, “',dw='”, .内容, “',sl='”, .内容, “',dj='”, .内容, “',sw='”, .内容, “',w='”, .内容, “',q='”, .内容, “',b='”, .内容, “',s='”, .内容, “',y='”, .内容, “',j='”, .内容, “',f='”, .内容, “',zje='”, .内容, “',bz='”, .内容, “',cjlx='”, 到文本 (采集类型), “',SY='3'”))
赋值 (条件 [4], 相加 (“fksj='”, 到文本 (取年份 (.今天)), “-”, .内容, “-”, .内容, “',fkr='”, .内容, “',shy='”, .内容, “',skr='”, .内容, “',tpr='”, .内容, “',hh='”, .内容, “',pmgg='”, .内容, “',dw='”, .内容, “',sl='”, .内容, “',dj='”, .内容, “',sw='”, .内容, “',w='”, .内容, “',q='”, .内容, “',b='”, .内容, “',s='”, .内容, “',y='”, .内容, “',j='”, .内容, “',f='”, .内容, “',zje='”, .内容, “',bz='”, .内容, “',cjlx='”, 到文本 (采集类型), “',SY='4'”))
赋值 (条件 [5], 相加 (“fksj='”, 到文本 (取年份 (.今天)), “-”, .内容, “-”, .内容, “',fkr='”, .内容, “',shy='”, .内容, “',skr='”, .内容, “',tpr='”, .内容, “',hh='”, .内容, “',pmgg='”, .内容, “',dw='”, .内容, “',sl='”, .内容, “',dj='”, .内容, “',sw='”, .内容, “',w='”, .内容, “',q='”, .内容, “',b='”, .内容, “',s='”, .内容, “',y='”, .内容, “',j='”, .内容, “',f='”, .内容, “',zje='”, .内容, “',bz='”, .内容, “',cjlx='”, 到文本 (采集类型), “',SY='5'”))
.如果真 (不等于 (.内容, “”))
    .如果真 (等于 (未知支持库函数_19 (连接句柄, “scb”, 条件 [1], 相加 (“djh='”, 收据, “'and SY='1'”)), 假))
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (错误, 0, )
        返回 ()
    .如果真结束
    .如果真 (等于 (空 [1], 真))
        赋值 (增加条件, 相加 (“djh='”, 收据, “',”, 条件 [1]))
        .如果真 (等于 (未知支持库函数_18 (连接句柄, “scb”, 增加条件), 假))
            未知支持库函数_41 (连接句柄, 错误)
            信息框 (错误, 0, )
            返回 ()
        .如果真结束
        
    .如果真结束
    
.如果真结束

.如果真 (不等于 (.内容, “”))
    .如果真 (等于 (未知支持库函数_19 (连接句柄, “scb”, 条件 [2], 相加 (“djh='”, 收据, “'and SY='2'”)), 假))
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (错误, 0, )
        返回 ()
    .如果真结束
    .如果真 (等于 (空 [2], 真))
        赋值 (增加条件, 相加 (“djh='”, 收据, “',”, 条件 [2]))
        .如果真 (等于 (未知支持库函数_18 (连接句柄, “scb”, 增加条件), 假))
            未知支持库函数_41 (连接句柄, 错误)
            信息框 (错误, 0, )
            返回 ()
        .如果真结束
        
    .如果真结束
    
.如果真结束
.如果真 (不等于 (.内容, “”))
    .如果真 (等于 (未知支持库函数_19 (连接句柄, “scb”, 条件 [3], 相加 (“djh='”, 收据, “'and SY='3'”)), 假))
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (错误, 0, )
        返回 ()
    .如果真结束
    .如果真 (等于 (空 [3], 真))
        赋值 (增加条件, 相加 (“djh='”, 收据, “',”, 条件 [3]))
        .如果真 (等于 (未知支持库函数_18 (连接句柄, “scb”, 增加条件), 假))
            未知支持库函数_41 (连接句柄, 错误)
            信息框 (错误, 0, )
            返回 ()
        .如果真结束
        
    .如果真结束
    
.如果真结束
.如果真 (不等于 (.内容, “”))
    .如果真 (等于 (未知支持库函数_19 (连接句柄, “scb”, 条件 [4], 相加 (“djh='”, 收据, “'and SY='4'”)), 假))
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (错误, 0, )
        返回 ()
    .如果真结束
    .如果真 (等于 (空 [4], 真))
        赋值 (增加条件, 相加 (“djh='”, 收据, “',”, 条件 [4]))
        .如果真 (等于 (未知支持库函数_18 (连接句柄, “scb”, 增加条件), 假))
            未知支持库函数_41 (连接句柄, 错误)
            信息框 (错误, 0, )
            返回 ()
        .如果真结束
        
    .如果真结束
    
.如果真结束
.如果真 (不等于 (.内容, “”))
    .如果真 (等于 (未知支持库函数_19 (连接句柄, “scb”, 条件 [5], 相加 (“djh='”, 收据, “'and SY='5'”)), 假))
        未知支持库函数_41 (连接句柄, 错误)
        信息框 (错误, 0, )
        返回 ()
    .如果真结束
    .如果真 (等于 (空 [5], 真))
        赋值 (增加条件, 相加 (“djh='”, 收据, “',”, 条件 [5]))
        .如果真 (等于 (未知支持库函数_18 (连接句柄, “scb”, 增加条件), 假))
            未知支持库函数_41 (连接句柄, 错误)
            信息框 (错误, 0, )
            返回 ()
        .如果真结束
        
    .如果真结束
    
.如果真结束
.如果 (等于 (采集类型, 1))
    赋值 (记录日志, 相加 (“完成更新伙食票据”, 收据, “记录”))
    写日志 ()
    信息框 (相加 (“完成更新伙食票据”, 收据, “记录”), 0, )
.否则
    赋值 (记录日志, 相加 (“完成更新资产票据”, 收据, “记录”))
    写日志 ()
    信息框 (相加 (“完成更新资产票据”, 收据, “记录”), 0, )
.如果结束
赋值 (.内容, 到文本 (相加 (到数值 (收据), 1)))
清空内容 ()
赋值 (搜索时间, 相加 (到文本 (取年份 (.今天)), “-”, .内容, “-”))
填列表 ()


.窗口程序集 凭证摘要窗口程序集, , , 

.程序集变量 项目文本, 文本型, , , 
.程序集变量 内容, 文本型, , , 
.子程序 _列表框1_列表项被选择, 空白型, , 
.局部变量 记录句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 文本变量, 文本型, , , 

赋值 (项目文本, .取项目文本 (.现行选中项))
赋值 (., 相加 (“凭证摘要-摘要类别：”, 项目文本))
检查连接 ()
.如果 (等于 (项目文本, “(所有类别)”))
    .如果真 (等于 (未知支持库函数_3 (连接句柄, “select zy from kjkm order by zy asc;”), 假))
        提示错误 ()
        返回 ()
    .如果真结束
    
.否则
    .如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select zylb,zy from kjkm where zylb like '%”, 项目文本, “%' order by zy asc;”)), 假))
        提示错误 ()
        返回 ()
    .如果真结束
    
.如果结束
赋值 (记录句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录句柄))
清空 ()
未知支持库函数_12 (记录句柄)
.计次循环首 (记录数, )
    未知支持库函数_6 (记录句柄, “zy”, 文本变量)
    .如果真 (不等于 (文本变量, “”))
        文本变量.加入项目 ()
    .如果真结束
    未知支持库函数_10 (记录句柄)
.计次循环尾 ()
未知支持库函数_5 (记录句柄)


.子程序 _凭证摘要窗口_创建完毕, 空白型, , 
显示摘要 ()


.子程序 _按钮1_被单击, 空白型, , 
检查连接 ()
.如果真 (等于 (.内容, “”))
    信息框 (“请输入摘要！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (未知支持库函数_18 (连接句柄, “kjkm”, 相加 (“zylb='”, 项目文本, “',zy='”, .内容, “'”)), 假))
    提示错误 ()
    返回 ()
.如果真结束
显示摘要 ()

.子程序 显示摘要, 空白型, , 
.局部变量 记录句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 文本变量, 文本型, , , 

检查连接 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, “select zy from kjkm order by zy asc;”), 假))
    提示错误 ()
    返回 ()
.如果真结束
赋值 (记录句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录句柄))
清空 ()
未知支持库函数_12 (记录句柄)
.计次循环首 (记录数, )
    未知支持库函数_6 (记录句柄, “zy”, 文本变量)
    .如果真 (不等于 (文本变量, “”))
        文本变量.加入项目 ()
    .如果真结束
    未知支持库函数_10 (记录句柄)
.计次循环尾 ()
未知支持库函数_5 (记录句柄)

.子程序 _按钮5_被单击, 空白型, , 
销毁 ()

.子程序 _列表框2_列表项被选择, 空白型, , 
.局部变量 记录句柄, 整数型, , , 
.局部变量 文本变量, 文本型, , , 

赋值 (.内容, .取项目文本 (.现行选中项))
赋值 (内容, .内容)
检查连接 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select zylb,zy from kjkm where zy like '%”, .内容, “';”)), 假))
    提示错误 ()
    返回 ()
.如果真结束
赋值 (记录句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录句柄)
未知支持库函数_6 (记录句柄, “zylb”, 文本变量)
未知支持库函数_5 (记录句柄)
文本变量.选择 ()
赋值 (项目文本, .取项目文本 (.现行选中项))
赋值 (., 相加 (“凭证摘要-摘要类别：”, 项目文本))


.子程序 _按钮2_被单击, 空白型, , 
检查连接 ()
.如果真 (等于 (.内容, “”))
    信息框 (“请输入摘要！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (未知支持库函数_19 (连接句柄, “kjkm”, 相加 (“zy='”, .内容, “',zylb='”, 项目文本, “'”), 相加 (“zy='”, 内容, “'”)), 假))
    提示错误 ()
    返回 ()
.如果真结束
显示摘要 ()


.子程序 _按钮3_被单击, 空白型, , 
检查连接 ()
.如果真 (等于 (.内容, “”))
    信息框 (“请输入摘要！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (未知支持库函数_20 (连接句柄, “kjkm”, 相加 (“zy='”, .内容, “'”)), 假))
    提示错误 ()
    返回 ()
.如果真结束
显示摘要 ()


.窗口程序集 会计科目窗口程序集, , , 

.程序集变量 名称, 文本型, , , 
.程序集变量 项目文本, 文本型, , , 
.子程序 _会计科目窗口_创建完毕, 空白型, , 
显示科目 ()

.子程序 _按钮1_被单击, 空白型, , 
检查连接 ()
赋值 (项目文本, .取项目文本 (.现行选中项))
.如果真 (等于 (项目文本, “(所有类别)”))
    返回 ()
.如果真结束
.如果真 (等于 (项目文本, “”))
    信息框 (“请选择科目大类！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入科目代码！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入科目名称！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (取数据库重复记录 (连接句柄, “kjkm”, “kmbh”, .内容))
    信息框 (“您输入科目已存在！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (未知支持库函数_18 (连接句柄, “kjkm”, 相加 (“kmdl='”, 项目文本, “',kmzl='”, .内容, “',kmbh='”, .内容, “',kmmc='”, .内容, “'”)), 假))
    提示错误 ()
    返回 ()
.如果真结束
显示科目 ()
相减 (取表项数 (), 1).保证显示 ()

.子程序 显示科目, 空白型, , 
.局部变量 记录句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 项目名, 整数型, , , 
.局部变量 B, 整数型, , , 
.局部变量 字段名, 文本型, , , 

检查连接 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, “select kmdl,kmzl,kmbh,kmmc from kjkm order by kmbh asc;”), 假))
    提示错误 ()
    返回 ()
.如果真结束
赋值 (记录句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录句柄))
赋值 (字段数, 未知支持库函数_14 (记录句柄))
全部删除 ()
未知支持库函数_12 (记录句柄)
.计次循环首 (记录数, )
    赋值 (文本变量, “”)
    未知支持库函数_6 (记录句柄, “kmdl”, 文本变量)
    .如果真 (不等于 (文本变量, “”))
        赋值 (项目名, -1.插入表项 ())
        赋值 (文本变量, “”)
        .计次循环首 (字段数, B)
            未知支持库函数_15 (记录句柄, 相减 (B, 1), 字段名)
            未知支持库函数_6 (记录句柄, 字段名, 文本变量)
            项目名.置标题 (相减 (B, 1), 文本变量)
        .计次循环尾 ()
    .如果真结束
    未知支持库函数_10 (记录句柄)
    处理事件 ()
.计次循环尾 ()
未知支持库函数_5 (记录句柄)

.子程序 _按钮2_被单击, 空白型, , 
检查连接 ()
.如果真 (等于 (项目文本, “(所有类别)”))
    返回 ()
.如果真结束
.如果真 (等于 (项目文本, “”))
    信息框 (“请选择被修改的科目大类！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入被修改的科目代码！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入被修改的科目名称！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (未知支持库函数_19 (连接句柄, “kjkm”, 相加 (“kmdl='”, 项目文本, “',kmzl='”, .内容, “',kmbh='”, .内容, “',kmmc='”, .内容, “'”), 相加 (“kmmc='”, 名称, “'”)), 假))
    提示错误 ()
    返回 ()
.如果真结束
显示科目 ()
相减 (取表项数 (), 1).保证显示 ()

.子程序 _超级列表框1_当前表项被改变, 空白型, , 
赋值 (名称, .取标题 (., 3))
赋值 (.内容, 名称)
赋值 (.内容, .取标题 (., 2))
赋值 (.内容, .取标题 (., 1))
.取标题 (., 0).选择 ()
赋值 (., 相加 (“会计科目 - ”, .内容, 名称))

.子程序 _按钮3_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (未知支持库函数_20 (连接句柄, “kjkm”, 相加 (“kmbh='”, .内容, “' and kmmc='”, .内容, “'”)), 假))
    提示错误 ()
    返回 ()
.如果真结束
显示科目 ()

.子程序 _按钮5_被单击, 空白型, , 
销毁 ()

.子程序 _组合框1_列表项被选择, 空白型, , 
.局部变量 记录句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 B, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 项目名, 整数型, , , 
.局部变量 字段数, 整数型, , , 

赋值 (项目文本, .取项目文本 (.现行选中项))
检查连接 ()
.如果 (等于 (项目文本, “(所有类别)”))
    .如果真 (等于 (未知支持库函数_3 (连接句柄, “select kmdl,kmzl,kmbh,kmmc from kjkm order by kmbh asc;”), 假))
        提示错误 ()
        返回 ()
    .如果真结束
    
.否则
    .如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select kmdl,kmzl,kmbh,kmmc from kjkm where kmdl like '%”, 项目文本, “%' order by zy asc;”)), 假))
        提示错误 ()
        返回 ()
    .如果真结束
    
.如果结束
赋值 (记录句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录句柄))
赋值 (字段数, 未知支持库函数_14 (记录句柄))
全部删除 ()
未知支持库函数_12 (记录句柄)
.计次循环首 (记录数, )
    赋值 (文本变量, “”)
    未知支持库函数_6 (记录句柄, “kmdl”, 文本变量)
    .如果真 (不等于 (文本变量, “”))
        赋值 (项目名, -1.插入表项 ())
        赋值 (文本变量, “”)
        .计次循环首 (字段数, B)
            未知支持库函数_15 (记录句柄, 相减 (B, 1), 字段名)
            未知支持库函数_6 (记录句柄, 字段名, 文本变量)
            项目名.置标题 (相减 (B, 1), 文本变量)
        .计次循环尾 ()
    .如果真结束
    未知支持库函数_10 (记录句柄)
    处理事件 ()
.计次循环尾 ()
未知支持库函数_5 (记录句柄)



.窗口程序集 费用报销窗口程序集, , , 

.程序集变量 搜索时间, 文本型, , , 
.程序集变量 项目位, 整数型, , , 
.程序集变量 总额, 双精度小数型, , , 
.程序集变量 号, 文本型, , , 
.程序集变量 DD, 整数型, , , 
.程序集变量 空, 逻辑型, , "6", 
.子程序 _费用报销窗口_创建完毕, 空白型, , 
赋值 (.内容, 到文本 (取月份 (取现行时间 ())))
赋值 (.内容, 到文本 (取日 (取现行时间 ())))
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\myfial.ini”), “setup”, “SJSMC”, ))
填收据列表 ()
赋值 (搜索时间, 相加 (到文本 (取年份 (.今天)), “-”, .内容, “-”))
填费用列表 ()

.子程序 填费用列表, 空白型, , 填费用单列表
.局部变量 记录句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 表项索引, 整数型, , , 
.局部变量 A, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 W, 文本型, , "0", 
.局部变量 N, 整数型, , , 
.局部变量 额, 双精度小数型, , , 

检查连接 ()
置等待鼠标 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select djh,djsl,zje,bxr,fhr,cny,pzr,sjh,djsj from fybxd where djsj like '%”, 搜索时间, “%' ORDER BY djh ASC;”)), 假))
    提示错误 ()
    返回 ()
.如果真结束
赋值 (记录句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录句柄))
赋值 (字段数, 未知支持库函数_14 (记录句柄))
未知支持库函数_12 (记录句柄)
全部删除 ()
.计次循环首 (记录数, )
    置等待鼠标 ()
    未知支持库函数_6 (记录句柄, “djh”, 文本变量)
    .如果真 (等于 (文本变量.查找表项 (0, ), -1))
        赋值 (表项索引, -1.插入表项 ())
        .计次循环首 (字段数, A)
            赋值 (文本变量, “”)
            赋值 (字段名, “”)
            未知支持库函数_15 (记录句柄, 相减 (A, 1), 字段名)
            未知支持库函数_6 (记录句柄, 字段名, 文本变量)
            表项索引.置标题 (相减 (A, 1), 文本变量)
        .计次循环尾 ()
    .如果真结束
    未知支持库函数_10 (记录句柄)
    表项索引.置图片 (0, 12)
    处理事件 ()
.计次循环尾 ()
未知支持库函数_5 (记录句柄)
赋值 (A, 0)
赋值 (额, 0)
清空 ()
.计次循环首 (取表项数 (), A)
    .如果真 (或者 (等于 (相减 (A, 1).取标题 (6), “”), 等于 (相减 (A, 1).取标题 (6), “空”)))
        相减 (A, 1).取标题 (0).加入项目 ()
    .如果真结束
    赋值 (W, 分割文本 (相减 (A, 1).取标题 (2), “,”, ))
    .如果 (大于或等于 (取数组成员数 (W), 2))
        赋值 (文本变量, “”)
        .计次循环首 (取数组成员数 (W), N)
            赋值 (文本变量, 相加 (文本变量, W [N]))
        .计次循环尾 ()
        赋值 (额, 相加 (到数值 (文本变量), 额))
    .否则
        赋值 (额, 相加 (到数值 (相减 (A, 1).取标题 (2)), 额))
        
    .如果结束
    
.计次循环尾 ()
赋值 (.标题, 相加 (“未审核单据有”, 到文本 (取项目数 ()), “张”))
赋值 (.内容, 数值到格式文本 (额, 2, 真))
赋值 (.内容, 到文本 (取表项数 ()))
赋值 (.现行选中项, 0)
恢复鼠标 ()

.子程序 填收据列表, 空白型, , 填收款收据列表
.局部变量 记录句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 表项索引, 整数型, , , 
.局部变量 A, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 s, 整数型, , , 
.局部变量 W, 文本型, , "0", 
.局部变量 N, 整数型, , , 

检查连接 ()
置等待鼠标 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, “select djh,zje,sfbx from scb ORDER BY djh ASC;”), 假))
    提示错误 ()
    返回 ()
.如果真结束
赋值 (记录句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录句柄))
赋值 (字段数, 未知支持库函数_14 (记录句柄))
未知支持库函数_12 (记录句柄)
全部删除 ()
.计次循环首 (记录数, )
    置等待鼠标 ()
    未知支持库函数_6 (记录句柄, “djh”, 文本变量)
    .如果真 (等于 (文本变量.查找表项 (0, ), -1))
        未知支持库函数_6 (记录句柄, “sfbx”, 文本变量)
        .如果真 (或者 (等于 (文本变量, “”), 等于 (文本变量, “0”)))
            赋值 (表项索引, -1.插入表项 ())
            .计次循环首 (字段数, A)
                赋值 (文本变量, “”)
                赋值 (字段名, “”)
                未知支持库函数_15 (记录句柄, 相减 (A, 1), 字段名)
                未知支持库函数_6 (记录句柄, 字段名, 文本变量)
                表项索引.置标题 (相减 (A, 1), 文本变量)
            .计次循环尾 ()
        .如果真结束
        
    .如果真结束
    未知支持库函数_10 (记录句柄)
    处理事件 ()
.计次循环尾 ()
未知支持库函数_5 (记录句柄)
恢复鼠标 ()

.子程序 _编辑框1_调节钮被按下, 空白型, , 
.参数 按钮值, 整数型, , 

.如果 (等于 (按钮值, 1))
    .如果真 (大于或等于 (到数值 (到数值 (.内容)), 12))
        返回 ()
    .如果真结束
    赋值 (.内容, 到文本 (相加 (到数值 (.内容), 1)))
.否则
    .如果真 (小于或等于 (到数值 (到数值 (.内容)), 1))
        返回 ()
    .如果真结束
    赋值 (.内容, 到文本 (相减 (到数值 (.内容), 1)))
.如果结束



.子程序 _编辑框2_调节钮被按下, 空白型, , 
.参数 按钮值, 整数型, , 

.如果 (等于 (按钮值, 1))
    .如果真 (大于或等于 (到数值 (到数值 (.内容)), 31))
        返回 ()
    .如果真结束
    赋值 (.内容, 到文本 (相加 (到数值 (.内容), 1)))
.否则
    .如果真 (小于或等于 (到数值 (到数值 (.内容)), 1))
        返回 ()
    .如果真结束
    赋值 (.内容, 到文本 (相减 (到数值 (.内容), 1)))
.如果结束


.子程序 _保存按钮_被单击, 空白型, , 
.局部变量 条件, 文本型, , "6", 
.局部变量 错误, 文本型, , , 
.局部变量 收据, 文本型, , , 
.局部变量 增加条件, 文本型, , , 

检查连接 ()
赋值 (收据, .内容)
.如果真 (等于 (收据, “”))
    信息框 (“请填写收据编号！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“第一项必须填写数据！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果 (取数据库重复记录 (连接句柄, “fybxd”, “djh”, .内容))
    .如果真 (等于 (信息框 (“此费用报销单据已存在！继续执行将修改存在的单据。否则更改单号！”, 相加 (#询问图标, #确认取消钮), “询问!”), #取消钮))
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (条件 [1], 相加 (“djsj='”, 到文本 (取年份 (.今天)), “-”, .内容, “-”, .内容, “',djsl='”, .标题, “',zje='”, .标题, “',bxr='”, .内容, “',fhr='”, .标题, “',cny='”, .标题, “',pzr='”, .标题, “',bmzg='”, .内容, “',lkr='”, .内容, “',yt='”, .内容, “',je='”, .内容, “',djzs='”, .内容, “',bz='”, .内容, “',jk='”, .内容, “',tk='”, .内容, “',bxbm='”, .内容, “',sjh='”, .标题, “'”))
    赋值 (条件 [2], 相加 (“djsj='”, 到文本 (取年份 (.今天)), “-”, .内容, “-”, .内容, “',djsl='”, .标题, “',zje='”, .标题, “',bxr='”, .内容, “',fhr='”, .标题, “',cny='”, .标题, “',pzr='”, .标题, “',bmzg='”, .内容, “',lkr='”, .内容, “',yt='”, .内容, “',je='”, .内容, “',djzs='”, .内容, “',bz='”, .内容, “',jk='”, .内容, “',tk='”, .内容, “',bxbm='”, .内容, “',sjh='”, .标题, “'”))
    赋值 (条件 [3], 相加 (“djsj='”, 到文本 (取年份 (.今天)), “-”, .内容, “-”, .内容, “',djsl='”, .标题, “',zje='”, .标题, “',bxr='”, .内容, “',fhr='”, .标题, “',cny='”, .标题, “',pzr='”, .标题, “',bmzg='”, .内容, “',lkr='”, .内容, “',yt='”, .内容, “',je='”, .内容, “',djzs='”, .内容, “',bz='”, .内容, “',jk='”, .内容, “',tk='”, .内容, “',bxbm='”, .内容, “',sjh='”, .标题, “'”))
    赋值 (条件 [4], 相加 (“djsj='”, 到文本 (取年份 (.今天)), “-”, .内容, “-”, .内容, “',djsl='”, .标题, “',zje='”, .标题, “',bxr='”, .内容, “',fhr='”, .标题, “',cny='”, .标题, “',pzr='”, .标题, “',bmzg='”, .内容, “',lkr='”, .内容, “',yt='”, .内容, “',je='”, .内容, “',djzs='”, .内容, “',bz='”, .内容, “',jk='”, .内容, “',tk='”, .内容, “',bxbm='”, .内容, “'”))
    赋值 (条件 [5], 相加 (“djsj='”, 到文本 (取年份 (.今天)), “-”, .内容, “-”, .内容, “',djsl='”, .标题, “',zje='”, .标题, “',bxr='”, .内容, “',fhr='”, .标题, “',cny='”, .标题, “',pzr='”, .标题, “',bmzg='”, .内容, “',lkr='”, .内容, “',yt='”, .内容, “',je='”, .内容, “',djzs='”, .内容, “',bz='”, .内容, “',jk='”, .内容, “',tk='”, .内容, “',bxbm='”, .内容, “',sjh='”, .标题, “'”))
    赋值 (条件 [6], 相加 (“djsj='”, 到文本 (取年份 (.今天)), “-”, .内容, “-”, .内容, “',djsl='”, .标题, “',zje='”, .标题, “',bxr='”, .内容, “',fhr='”, .标题, “',cny='”, .标题, “',pzr='”, .标题, “',bmzg='”, .内容, “',lkr='”, .内容, “',yt='”, .内容, “',je='”, .内容, “',djzs='”, .内容, “',bz='”, .内容, “',jk='”, .内容, “',tk='”, .内容, “',bxbm='”, .内容, “',sjh='”, .标题, “'”))
    
    .如果 (不等于 (.内容, “”))
        .如果真 (等于 (未知支持库函数_19 (连接句柄, “fybxd”, 条件 [1], 相加 (“djh='”, 收据, “'and sy='1'”)), 假))
            未知支持库函数_41 (连接句柄, 错误)
            信息框 (错误, 0, )
            返回 ()
        .如果真结束
        .如果真 (等于 (空 [1], 真))
            赋值 (增加条件, 相加 (“djh='”, 收据, “',”, 条件 [1], “,sy='1'”))
            .如果真 (等于 (未知支持库函数_18 (连接句柄, “fybxd”, 增加条件), 假))
                未知支持库函数_41 (连接句柄, 错误)
                信息框 (错误, 0, )
                返回 ()
            .如果真结束
            
        .如果真结束
        
    .否则
        .如果真 (等于 (空 [1], 假))
            赋值 (增加条件, 相加 (“djh='”, 收据, “'and sy='1'”))
            .如果真 (等于 (未知支持库函数_20 (连接句柄, “fybxd”, 增加条件), 假))
                未知支持库函数_41 (连接句柄, 错误)
                信息框 (错误, 0, )
                返回 ()
            .如果真结束
            
        .如果真结束
        
        
    .如果结束
    
    
    .如果 (不等于 (.内容, “”))
        .如果真 (等于 (未知支持库函数_19 (连接句柄, “fybxd”, 条件 [2], 相加 (“djh='”, 收据, “'and sy='2'”)), 假))
            未知支持库函数_41 (连接句柄, 错误)
            信息框 (错误, 0, )
            返回 ()
        .如果真结束
        .如果真 (等于 (空 [2], 真))
            赋值 (增加条件, 相加 (“djh='”, 收据, “',”, 条件 [2], “,sy='2'”))
            .如果真 (等于 (未知支持库函数_18 (连接句柄, “fybxd”, 增加条件), 假))
                未知支持库函数_41 (连接句柄, 错误)
                信息框 (错误, 0, )
                返回 ()
            .如果真结束
            
        .如果真结束
        
    .否则
        .如果真 (等于 (空 [2], 假))
            赋值 (增加条件, 相加 (“djh='”, 收据, “'and sy='2'”))
            .如果真 (等于 (未知支持库函数_20 (连接句柄, “fybxd”, 增加条件), 假))
                未知支持库函数_41 (连接句柄, 错误)
                信息框 (错误, 0, )
                返回 ()
            .如果真结束
            
        .如果真结束
        
    .如果结束
    
    .如果 (不等于 (.内容, “”))
        .如果真 (等于 (未知支持库函数_19 (连接句柄, “fybxd”, 条件 [3], 相加 (“djh='”, 收据, “'and sy='3'”)), 假))
            未知支持库函数_41 (连接句柄, 错误)
            信息框 (错误, 0, )
            返回 ()
        .如果真结束
        .如果真 (等于 (空 [3], 真))
            赋值 (增加条件, 相加 (“djh='”, 收据, “',”, 条件 [3], “,sy='3'”))
            .如果真 (等于 (未知支持库函数_18 (连接句柄, “fybxd”, 增加条件), 假))
                未知支持库函数_41 (连接句柄, 错误)
                信息框 (错误, 0, )
                返回 ()
            .如果真结束
            
        .如果真结束
        
    .否则
        .如果真 (等于 (空 [3], 假))
            赋值 (增加条件, 相加 (“djh='”, 收据, “'and sy='3'”))
            .如果真 (等于 (未知支持库函数_20 (连接句柄, “fybxd”, 增加条件), 假))
                未知支持库函数_41 (连接句柄, 错误)
                信息框 (错误, 0, )
                返回 ()
            .如果真结束
            
        .如果真结束
        
    .如果结束
    
    .如果 (不等于 (.内容, “”))
        .如果真 (等于 (未知支持库函数_19 (连接句柄, “fybxd”, 条件 [4], 相加 (“djh='”, 收据, “'and sy='4'”)), 假))
            未知支持库函数_41 (连接句柄, 错误)
            信息框 (错误, 0, )
            返回 ()
        .如果真结束
        .如果真 (等于 (空 [4], 真))
            赋值 (增加条件, 相加 (“djh='”, 收据, “',”, 条件 [4], “,sy='4'”))
            .如果真 (等于 (未知支持库函数_18 (连接句柄, “fybxd”, 增加条件), 假))
                未知支持库函数_41 (连接句柄, 错误)
                信息框 (错误, 0, )
                返回 ()
            .如果真结束
            
        .如果真结束
        
    .否则
        .如果真 (等于 (空 [4], 假))
            赋值 (增加条件, 相加 (“djh='”, 收据, “'and sy='4'”))
            .如果真 (等于 (未知支持库函数_20 (连接句柄, “fybxd”, 增加条件), 假))
                未知支持库函数_41 (连接句柄, 错误)
                信息框 (错误, 0, )
                返回 ()
            .如果真结束
            
        .如果真结束
        
    .如果结束
    
    .如果 (不等于 (.内容, “”))
        .如果真 (等于 (未知支持库函数_19 (连接句柄, “fybxd”, 条件 [5], 相加 (“djh='”, 收据, “'and sy='5'”)), 假))
            未知支持库函数_41 (连接句柄, 错误)
            信息框 (错误, 0, )
            返回 ()
        .如果真结束
        .如果真 (等于 (空 [5], 真))
            赋值 (增加条件, 相加 (“djh='”, 收据, “',”, 条件 [5], “,sy='5'”))
            .如果真 (等于 (未知支持库函数_18 (连接句柄, “fybxd”, 增加条件), 假))
                未知支持库函数_41 (连接句柄, 错误)
                信息框 (错误, 0, )
                返回 ()
            .如果真结束
            
        .如果真结束
        
    .否则
        .如果真 (等于 (空 [5], 假))
            赋值 (增加条件, 相加 (“djh='”, 收据, “'and sy='5'”))
            .如果真 (等于 (未知支持库函数_20 (连接句柄, “fybxd”, 增加条件), 假))
                未知支持库函数_41 (连接句柄, 错误)
                信息框 (错误, 0, )
                返回 ()
            .如果真结束
            
        .如果真结束
        
    .如果结束
    
    .如果 (不等于 (.内容, “”))
        .如果真 (等于 (未知支持库函数_19 (连接句柄, “fybxd”, 条件 [6], 相加 (“djh='”, 收据, “'and sy='6'”)), 假))
            未知支持库函数_41 (连接句柄, 错误)
            信息框 (错误, 0, )
            返回 ()
        .如果真结束
        .如果真 (等于 (空 [6], 真))
            赋值 (增加条件, 相加 (“djh='”, 收据, “',”, 条件 [6], “,sy='6'”))
            .如果真 (等于 (未知支持库函数_18 (连接句柄, “fybxd”, 增加条件), 假))
                未知支持库函数_41 (连接句柄, 错误)
                信息框 (错误, 0, )
                返回 ()
            .如果真结束
            
        .如果真结束
        
    .否则
        .如果真 (等于 (空 [6], 假))
            赋值 (增加条件, 相加 (“djh='”, 收据, “'and sy='6'”))
            .如果真 (等于 (未知支持库函数_20 (连接句柄, “fybxd”, 增加条件), 假))
                未知支持库函数_41 (连接句柄, 错误)
                信息框 (错误, 0, )
                返回 ()
            .如果真结束
            
        .如果真结束
        
    .如果结束
    赋值 (记录日志, 相加 (“更新费用报销单票据”, 收据, “记录”))
    写日志 ()
    信息框 (相加 (“更新费用报销单票据”, 收据, “记录”), 0, )
    
.否则
    赋值 (条件 [1], 相加 (“djh='”, 收据, “',djsj='”, 到文本 (取年份 (.今天)), “-”, .内容, “-”, .内容, “',djsl='”, .标题, “',zje='”, .标题, “',bxr='”, .内容, “',fhr='”, .标题, “',cny='”, .标题, “',pzr='”, .标题, “',bmzg='”, .内容, “',lkr='”, .内容, “',yt='”, .内容, “',je='”, .内容, “',djzs='”, .内容, “',bz='”, .内容, “',jk='”, .内容, “',tk='”, .内容, “',bxbm='”, .内容, “',sy='1',sjh='”, .标题, “'”))
    赋值 (条件 [2], 相加 (“djh='”, 收据, “',djsj='”, 到文本 (取年份 (.今天)), “-”, .内容, “-”, .内容, “',djsl='”, .标题, “',zje='”, .标题, “',bxr='”, .内容, “',fhr='”, .标题, “',cny='”, .标题, “',pzr='”, .标题, “',bmzg='”, .内容, “',lkr='”, .内容, “',yt='”, .内容, “',je='”, .内容, “',djzs='”, .内容, “',bz='”, .内容, “',jk='”, .内容, “',tk='”, .内容, “',bxbm='”, .内容, “',sy='2',sjh='”, .标题, “'”))
    赋值 (条件 [3], 相加 (“djh='”, 收据, “',djsj='”, 到文本 (取年份 (.今天)), “-”, .内容, “-”, .内容, “',djsl='”, .标题, “',zje='”, .标题, “',bxr='”, .内容, “',fhr='”, .标题, “',cny='”, .标题, “',pzr='”, .标题, “',bmzg='”, .内容, “',lkr='”, .内容, “',yt='”, .内容, “',je='”, .内容, “',djzs='”, .内容, “',bz='”, .内容, “',jk='”, .内容, “',tk='”, .内容, “',bxbm='”, .内容, “',sy='3',sjh='”, .标题, “'”))
    赋值 (条件 [4], 相加 (“djh='”, 收据, “',djsj='”, 到文本 (取年份 (.今天)), “-”, .内容, “-”, .内容, “',djsl='”, .标题, “',zje='”, .标题, “',bxr='”, .内容, “',fhr='”, .标题, “',cny='”, .标题, “',pzr='”, .标题, “',bmzg='”, .内容, “',lkr='”, .内容, “',yt='”, .内容, “',je='”, .内容, “',djzs='”, .内容, “',bz='”, .内容, “',jk='”, .内容, “',tk='”, .内容, “',bxbm='”, .内容, “',sy='4',sjh='”, .标题, “'”))
    赋值 (条件 [5], 相加 (“djh='”, 收据, “',djsj='”, 到文本 (取年份 (.今天)), “-”, .内容, “-”, .内容, “',djsl='”, .标题, “',zje='”, .标题, “',bxr='”, .内容, “',fhr='”, .标题, “',cny='”, .标题, “',pzr='”, .标题, “',bmzg='”, .内容, “',lkr='”, .内容, “',yt='”, .内容, “',je='”, .内容, “',djzs='”, .内容, “',bz='”, .内容, “',jk='”, .内容, “',tk='”, .内容, “',bxbm='”, .内容, “',sy='5',sjh='”, .标题, “'”))
    赋值 (条件 [6], 相加 (“djh='”, 收据, “',djsj='”, 到文本 (取年份 (.今天)), “-”, .内容, “-”, .内容, “',djsl='”, .标题, “',zje='”, .标题, “',bxr='”, .内容, “',fhr='”, .标题, “',cny='”, .标题, “',pzr='”, .标题, “',bmzg='”, .内容, “',lkr='”, .内容, “',yt='”, .内容, “',je='”, .内容, “',djzs='”, .内容, “',bz='”, .内容, “',jk='”, .内容, “',tk='”, .内容, “',bxbm='”, .内容, “',sy='6',sjh='”, .标题, “'”))
    
    .如果真 (不等于 (.内容, “”))
        .如果真 (等于 (未知支持库函数_18 (连接句柄, “fybxd”, 条件 [1]), 假))
            未知支持库函数_41 (连接句柄, 错误)
            信息框 (错误, 0, )
            返回 ()
        .如果真结束
        
    .如果真结束
    .如果真 (不等于 (.内容, “”))
        .如果真 (等于 (未知支持库函数_18 (连接句柄, “fybxd”, 条件 [2]), 假))
            未知支持库函数_41 (连接句柄, 错误)
            信息框 (错误, 0, )
            返回 ()
        .如果真结束
        
    .如果真结束
    .如果真 (不等于 (.内容, “”))
        .如果真 (等于 (未知支持库函数_18 (连接句柄, “fybxd”, 条件 [3]), 假))
            未知支持库函数_41 (连接句柄, 错误)
            信息框 (错误, 0, )
            返回 ()
        .如果真结束
        
    .如果真结束
    .如果真 (不等于 (.内容, “”))
        .如果真 (等于 (未知支持库函数_18 (连接句柄, “fybxd”, 条件 [4]), 假))
            未知支持库函数_41 (连接句柄, 错误)
            信息框 (错误, 0, )
            返回 ()
        .如果真结束
        
    .如果真结束
    .如果真 (不等于 (.内容, “”))
        .如果真 (等于 (未知支持库函数_18 (连接句柄, “fybxd”, 条件 [5]), 假))
            未知支持库函数_41 (连接句柄, 错误)
            信息框 (错误, 0, )
            返回 ()
        .如果真结束
        
    .如果真结束
    .如果真 (不等于 (.内容, “”))
        .如果真 (等于 (未知支持库函数_18 (连接句柄, “fybxd”, 条件 [6]), 假))
            未知支持库函数_41 (连接句柄, 错误)
            信息框 (错误, 0, )
            返回 ()
        .如果真结束
        
    .如果真结束
    赋值 (记录日志, 相加 (“完成费用报销单票据”, 收据, “记录”))
    写日志 ()
    信息框 (相加 (“完成费用报销单票据”, 收据, “记录”), 0, )
    
.如果结束
赋值 (.内容, 到文本 (相加 (到数值 (收据), 1)))
清空内容 ()
赋值 (搜索时间, 相加 (到文本 (取年份 (.今天)), “-”, .内容, “-”))
填费用列表 ()

.子程序 清空内容, 空白型, , 
.局部变量 A, 整数型, , , 

连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .标题, .内容, .内容, .标题, .标题, .内容, .内容, .标题, .标题, .标题, .标题, .标题, .标题)
赋值 (DD, 0)
赋值 (号, “”)
赋值 (总额, 0)
.计次循环首 (6, A)
    相减 (A, 1).置标题 (3, “”)
.计次循环尾 ()

.子程序 _A1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (项目位, 1)
赋值 (.顶边, .顶边)
赋值 (.可视, 真)
赋值 (.字体大小, 真)
赋值 (.可视, 真)
赋值 (.可视, 假)
赋值 (DD, 0)
赋值 (号, “”)
赋值 (总额, 0)
连续赋值 (假, .可视, .可视, .可视, .可视, .可视)
连续赋值 (真, .可视, .可视, .可视, .可视, .可视)

.子程序 _A2_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (项目位, 2)
赋值 (.顶边, .顶边)
赋值 (.可视, 真)
赋值 (.字体大小, 真)
赋值 (.可视, 假)
赋值 (.可视, 真)
赋值 (DD, 0)
赋值 (号, “”)
赋值 (总额, 0)
连续赋值 (假, .可视, .可视, .可视, .可视, .可视)
连续赋值 (真, .可视, .可视, .可视, .可视, .可视)

.子程序 _A3_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (项目位, 3)
赋值 (.顶边, .顶边)
赋值 (.可视, 真)
赋值 (.字体大小, 真)
赋值 (.可视, 假)
赋值 (.可视, 真)

赋值 (DD, 0)
赋值 (号, “”)
赋值 (总额, 0)
连续赋值 (假, .可视, .可视, .可视, .可视, .可视)
连续赋值 (真, .可视, .可视, .可视, .可视, .可视)

.子程序 _A4_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (项目位, 4)
赋值 (.顶边, .顶边)
赋值 (.可视, 真)
赋值 (.字体大小, 真)
赋值 (.可视, 假)
赋值 (.可视, 真)

赋值 (DD, 0)
赋值 (号, “”)
赋值 (总额, 0)
连续赋值 (假, .可视, .可视, .可视, .可视, .可视)
连续赋值 (真, .可视, .可视, .可视, .可视, .可视)

.子程序 _A5_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (项目位, 5)
赋值 (.顶边, .顶边)
赋值 (.可视, 真)
赋值 (.字体大小, 真)
赋值 (.可视, 假)
赋值 (.可视, 真)

赋值 (DD, 0)
赋值 (号, “”)
赋值 (总额, 0)
连续赋值 (真, .可视, .可视, .可视, .可视, .可视)
连续赋值 (假, .可视, .可视, .可视, .可视, .可视)


.子程序 _A6_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (项目位, 6)
赋值 (.顶边, .顶边)
赋值 (.可视, 真)
赋值 (.字体大小, 真)
赋值 (.可视, 假)
赋值 (.可视, 真)
赋值 (DD, 0)
赋值 (号, “”)
赋值 (总额, 0)
连续赋值 (真, .可视, .可视, .可视, .可视, .可视)
连续赋值 (假, .可视, .可视, .可视, .可视, .可视)

.子程序 _组合框_列表项被选择, 空白型, , 
.判断开始 (等于 (项目位, 1))
    赋值 (.内容, .内容)
    赋值 (.可视, 真)
.判断 (等于 (项目位, 2))
    赋值 (.内容, .内容)
    赋值 (.可视, 真)
.判断 (等于 (项目位, 3))
    赋值 (.内容, .内容)
    赋值 (.可视, 真)
.判断 (等于 (项目位, 4))
    赋值 (.内容, .内容)
    赋值 (.可视, 真)
.判断 (等于 (项目位, 5))
    赋值 (.内容, .内容)
    赋值 (.可视, 真)
.判断 (等于 (项目位, 6))
    赋值 (.内容, .内容)
    赋值 (.可视, 真)
.默认
    
.判断结束
赋值 (项目位, 0)
赋值 (.可视, 假)
赋值 (.字体大小, 假)
连续赋值 (真, .可视, .可视, .可视, .可视, .可视, .可视)
连续赋值 (假, .可视, .可视, .可视, .可视, .可视, .可视)

.子程序 _组合框_失去焦点, 空白型, , 
赋值 (项目位, 0)
赋值 (.可视, 假)
连续赋值 (真, .可视, .可视, .可视, .可视, .可视, .可视)

.子程序 _超级列表框2_当前表项被改变, 空白型, , 
.局部变量 位, 整数型, , , 


.判断开始 (等于 (项目位, 1))
    .如果真 (不等于 (.取标题 (., 3), “A”))
        .如果真 (等于 (信息框 (相加 (“是否将[ ”, .取标题 (., 0), “ ]单据填入此栏?”), 相加 (#确认取消钮, #询问图标), “单据填入提示!”), #确认钮))
            .置标题 (., 3, “A”)
            赋值 (总额, 相加 (总额, 到数值 (.取标题 (., 1))))
            赋值 (号, 相加 (.取标题 (., 0), “,”, 号))
            赋值 (DD, 相加 (DD, 1))
            赋值 (.内容, 数值到格式文本 (总额, 2, 假))
            赋值 (.标题, 号)
            赋值 (.内容, 到文本 (DD))
        .如果真结束
        
    .如果真结束
    
    
.判断 (等于 (项目位, 2))
    .如果真 (不等于 (.取标题 (., 3), “A”))
        .如果真 (等于 (信息框 (相加 (“是否将[ ”, .取标题 (., 0), “ ]单据填入此栏?”), 相加 (#确认取消钮, #询问图标), “单据填入提示!”), #确认钮))
            .置标题 (., 3, “A”)
            赋值 (总额, 相加 (总额, 到数值 (.取标题 (., 1))))
            赋值 (号, 相加 (.取标题 (., 0), “,”, 号))
            赋值 (DD, 相加 (DD, 1))
            赋值 (.内容, 数值到格式文本 (总额, 2, 假))
            赋值 (.标题, 号)
            赋值 (.内容, 到文本 (DD))
        .如果真结束
        
    .如果真结束
    
    
.判断 (等于 (项目位, 3))
    .如果真 (不等于 (.取标题 (., 3), “A”))
        .如果真 (等于 (信息框 (相加 (“是否将[ ”, .取标题 (., 0), “ ]单据填入此栏?”), 相加 (#确认取消钮, #询问图标), “单据填入提示!”), #确认钮))
            .置标题 (., 3, “A”)
            赋值 (总额, 相加 (总额, 到数值 (.取标题 (., 1))))
            赋值 (号, 相加 (.取标题 (., 0), “,”, 号))
            赋值 (DD, 相加 (DD, 1))
            赋值 (.内容, 数值到格式文本 (总额, 2, 假))
            赋值 (.标题, 号)
            赋值 (.内容, 到文本 (DD))
        .如果真结束
        
    .如果真结束
    
    
.判断 (等于 (项目位, 4))
    .如果真 (不等于 (.取标题 (., 3), “A”))
        .如果真 (等于 (信息框 (相加 (“是否将[ ”, .取标题 (., 0), “ ]单据填入此栏?”), 相加 (#确认取消钮, #询问图标), “单据填入提示!”), #确认钮))
            .置标题 (., 3, “A”)
            赋值 (总额, 相加 (总额, 到数值 (.取标题 (., 1))))
            赋值 (号, 相加 (.取标题 (., 0), “,”, 号))
            赋值 (DD, 相加 (DD, 1))
            赋值 (.内容, 数值到格式文本 (总额, 2, 假))
            赋值 (.标题, 号)
            赋值 (.内容, 到文本 (DD))
        .如果真结束
        
    .如果真结束
    
    
.判断 (等于 (项目位, 5))
    .如果真 (不等于 (.取标题 (., 3), “A”))
        .如果真 (等于 (信息框 (相加 (“是否将[ ”, .取标题 (., 0), “ ]单据填入此栏?”), 相加 (#确认取消钮, #询问图标), “单据填入提示!”), #确认钮))
            .置标题 (., 3, “A”)
            赋值 (总额, 相加 (总额, 到数值 (.取标题 (., 1))))
            赋值 (号, 相加 (.取标题 (., 0), “,”, 号))
            赋值 (DD, 相加 (DD, 1))
            赋值 (.内容, 数值到格式文本 (总额, 2, 假))
            赋值 (.标题, 号)
            赋值 (.内容, 到文本 (DD))
        .如果真结束
        
    .如果真结束
    
    
.判断 (等于 (项目位, 6))
    .如果真 (不等于 (.取标题 (., 3), “A”))
        .如果真 (等于 (信息框 (相加 (“是否将[ ”, .取标题 (., 0), “ ]单据填入此栏?”), 相加 (#确认取消钮, #询问图标), “单据填入提示!”), #确认钮))
            .置标题 (., 3, “A”)
            赋值 (总额, 相加 (总额, 到数值 (.取标题 (., 1))))
            赋值 (号, 相加 (.取标题 (., 0), “,”, 号))
            赋值 (DD, 相加 (DD, 1))
            赋值 (.内容, 数值到格式文本 (总额, 2, 假))
            赋值 (.标题, 号)
            赋值 (.内容, 到文本 (DD))
        .如果真结束
        
    .如果真结束
    
.默认
    
.判断结束


.子程序 _保存按钮1_被单击, 空白型, , 
清空内容 ()


.子程序 _B1_内容被改变, 空白型, , 
赋值 (.标题, 数值到格式文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容)), 2, 假))
赋值 (.内容, 数值到金额 (到数值 (.标题), 假))

.子程序 _B2_内容被改变, 空白型, , 
赋值 (.标题, 数值到格式文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容)), 2, 假))
赋值 (.内容, 数值到金额 (到数值 (.标题), 假))

.子程序 _B3_内容被改变, 空白型, , 
赋值 (.标题, 数值到格式文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容)), 2, 假))
赋值 (.内容, 数值到金额 (到数值 (.标题), 假))

.子程序 _B4_内容被改变, 空白型, , 
赋值 (.标题, 数值到格式文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容)), 2, 假))
赋值 (.内容, 数值到金额 (到数值 (.标题), 假))

.子程序 _B5_内容被改变, 空白型, , 
赋值 (.标题, 数值到格式文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容)), 2, 假))
赋值 (.内容, 数值到金额 (到数值 (.标题), 假))

.子程序 _B6_内容被改变, 空白型, , 
赋值 (.标题, 数值到格式文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容)), 2, 假))
赋值 (.内容, 数值到金额 (到数值 (.标题), 假))

.子程序 _C1_内容被改变, 空白型, , 
赋值 (.标题, 到文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容))))


.子程序 _C2_内容被改变, 空白型, , 
赋值 (.标题, 到文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容))))


.子程序 _C3_内容被改变, 空白型, , 
赋值 (.标题, 到文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容))))


.子程序 _C4_内容被改变, 空白型, , 
赋值 (.标题, 到文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容))))


.子程序 _C5_内容被改变, 空白型, , 
赋值 (.标题, 到文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容))))


.子程序 _C6_内容被改变, 空白型, , 
赋值 (.标题, 到文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容))))


.子程序 _超级列表框1_当前表项被改变, 空白型, , 
.局部变量 项目名, 文本型, , , 
.局部变量 记录句柄, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 时间, 日期时间型, , , 

赋值 (项目名, .取标题 (., 0))

.如果真 (等于 (项目名, “”))
    返回 ()
.如果真结束
检查连接 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select * from fybxd where djh='”, 项目名, “' ORDER BY djh ASC;”)), 假))
    提示错误 ()
    返回 ()
.如果真结束
赋值 (记录句柄, 未知支持库函数_4 (连接句柄))
赋值 (记录数, 未知支持库函数_7 (记录句柄))
未知支持库函数_12 (记录句柄)
清空内容 ()

未知支持库函数_6 (记录句柄, “djh”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录句柄, “djsj”, 文本变量)
赋值 (时间, 到时间 (相加 (文本变量, “-12:01:01”)))
赋值 (.今天, 时间)
赋值 (.内容, 到文本 (取月份 (时间)))
赋值 (.内容, 到文本 (取日 (时间)))
未知支持库函数_6 (记录句柄, “bxr”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录句柄, “fhr”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录句柄, “cny”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录句柄, “pzr”, 文本变量)
赋值 (.标题, 文本变量)
未知支持库函数_6 (记录句柄, “bmzg”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录句柄, “lkr”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录句柄, “jk”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录句柄, “tk”, 文本变量)
赋值 (.内容, 文本变量)
未知支持库函数_6 (记录句柄, “bxbm”, 文本变量)
赋值 (.内容, 文本变量)

.如果真 (大于或等于 (记录数, 1))
    未知支持库函数_6 (记录句柄, “yt”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “je”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “djzs”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “sjh”, 文本变量)
    赋值 (.标题, 文本变量)
    
.如果真结束
未知支持库函数_10 (记录句柄)
.如果真 (大于或等于 (记录数, 2))
    未知支持库函数_6 (记录句柄, “yt”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “je”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “djzs”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “sjh”, 文本变量)
    赋值 (.标题, 文本变量)
    
.如果真结束
未知支持库函数_10 (记录句柄)
.如果真 (大于或等于 (记录数, 3))
    未知支持库函数_6 (记录句柄, “yt”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “je”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “djzs”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “sjh”, 文本变量)
    赋值 (.标题, 文本变量)
    
.如果真结束
未知支持库函数_10 (记录句柄)
.如果真 (大于或等于 (记录数, 4))
    未知支持库函数_6 (记录句柄, “yt”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “je”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “djzs”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “sjh”, 文本变量)
    赋值 (.标题, 文本变量)
    
.如果真结束
未知支持库函数_10 (记录句柄)
.如果真 (大于或等于 (记录数, 5))
    未知支持库函数_6 (记录句柄, “yt”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “je”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “djzs”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “sjh”, 文本变量)
    赋值 (.标题, 文本变量)
    
.如果真结束
未知支持库函数_10 (记录句柄)
.如果真 (大于或等于 (记录数, 6))
    未知支持库函数_6 (记录句柄, “yt”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “je”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “djzs”, 文本变量)
    赋值 (.内容, 文本变量)
    未知支持库函数_6 (记录句柄, “sjh”, 文本变量)
    赋值 (.标题, 文本变量)
    
.如果真结束
未知支持库函数_10 (记录句柄)
未知支持库函数_5 (记录句柄)
.如果 (等于 (.内容, “”))
    赋值 (空 [1], 真)
.否则
    赋值 (空 [1], 假)
.如果结束
.如果 (等于 (.内容, “”))
    赋值 (空 [2], 真)
.否则
    赋值 (空 [2], 假)
.如果结束
.如果 (等于 (.内容, “”))
    赋值 (空 [3], 真)
.否则
    赋值 (空 [3], 假)
.如果结束
.如果 (等于 (.内容, “”))
    赋值 (空 [4], 真)
.否则
    赋值 (空 [4], 假)
.如果结束
.如果 (等于 (.内容, “”))
    赋值 (空 [5], 真)
.否则
    赋值 (空 [5], 假)
.如果结束
.如果 (等于 (.内容, “”))
    赋值 (空 [6], 真)
.否则
    赋值 (空 [6], 假)
.如果结束


.子程序 _新建A_被单击, 空白型, , 
.局部变量 数A, 文本型, , , 

清空内容 ()
赋值 (.今天, 取现行时间 ())
赋值 (.内容, 到文本 (取月份 (取现行时间 ())))
赋值 (.内容, 到文本 (取日 (取现行时间 ())))
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “100000”)
.如果真结束
赋值 (数A, 相加 (取文本左边 (.内容, 1), 到文本 (相加 (取表项数 (), 1))))
.判断开始 (等于 (取文本长度 (.内容), 取文本长度 (数A)))
    赋值 (.内容, 相加 (取文本左边 (.内容, 1), 到文本 (相加 (取表项数 (), 1))))
.判断 (等于 (相减 (取文本长度 (.内容), 取文本长度 (数A)), 1))
    赋值 (.内容, 相加 (取文本左边 (.内容, 1), “0”, 到文本 (相加 (取表项数 (), 1))))
.判断 (等于 (相减 (取文本长度 (.内容), 取文本长度 (数A)), 2))
    赋值 (.内容, 相加 (取文本左边 (.内容, 1), “00”, 到文本 (相加 (取表项数 (), 1))))
.判断 (等于 (相减 (取文本长度 (.内容), 取文本长度 (数A)), 3))
    赋值 (.内容, 相加 (取文本左边 (.内容, 1), “000”, 到文本 (相加 (取表项数 (), 1))))
.判断 (等于 (相减 (取文本长度 (.内容), 取文本长度 (数A)), 4))
    赋值 (.内容, 相加 (取文本左边 (.内容, 1), “0000”, 到文本 (相加 (取表项数 (), 1))))
.判断 (等于 (相减 (取文本长度 (.内容), 取文本长度 (数A)), 5))
    赋值 (.内容, 相加 (取文本左边 (.内容, 1), “00000”, 到文本 (相加 (取表项数 (), 1))))
.判断 (等于 (相减 (取文本长度 (.内容), 取文本长度 (数A)), 6))
    赋值 (.内容, 相加 (取文本左边 (.内容, 1), “000000”, 到文本 (相加 (取表项数 (), 1))))
.判断 (等于 (相减 (取文本长度 (.内容), 取文本长度 (数A)), 7))
    赋值 (.内容, 相加 (取文本左边 (.内容, 1), “0000000”, 到文本 (相加 (取表项数 (), 1))))
.判断 (等于 (相减 (取文本长度 (.内容), 取文本长度 (数A)), 8))
    赋值 (.内容, 相加 (取文本左边 (.内容, 1), “00000000”, 到文本 (相加 (取表项数 (), 1))))
.默认
    
.判断结束


.子程序 _按月按钮_被单击, 空白型, , 
赋值 (搜索时间, 相加 (到文本 (取年份 (.今天)), “-”, .内容, “-”))
填费用列表 ()

.子程序 _按日按钮_被单击, 空白型, , 
赋值 (搜索时间, 相加 (到文本 (取年份 (.今天)), “-”, .内容, “-”, .内容))
填费用列表 ()

.子程序 _完全按钮_被单击, 空白型, , 
赋值 (搜索时间, 到文本 (取年份 (.今天)))
填费用列表 ()


.子程序 _报销批准按钮_被单击, 空白型, , 
.局部变量 wb, 文本型, , "0", 
.局部变量 签名, 文本型, , , 
.局部变量 票, 文本型, , , 
.局部变量 位, 整数型, , , 

赋值 (票, .内容)
.如果真 (等于 (票, “”))
    信息框 (“请选择被审核的票据号！”, 0, )
    返回 ()
.如果真结束
赋值 (位, 票.查找表项 (0, ))
.如果真 (等于 (位.取标题 (3), “”))
    信息框 (“选择的票据号没有报销人签名！”, #信息图标, “越级错误！！！”)
    返回 ()
.如果真结束
.如果真 (等于 (位.取标题 (4), “”))
    信息框 (“选择的票据号没有被会计复核！”, #信息图标, “越级错误！！！”)
    返回 ()
.如果真结束
.如果真 (等于 (位.取标题 (5), “”))
    .如果真 (等于 (信息框 (“选择的票据号没有被出纳签名！是否强制执行？”, 相加 (#询问图标, #是否钮), ), #否钮))
        返回 ()
    .如果真结束
    
.如果真结束

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [18], “34”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束

.如果真 (输入框 (相加 (“费用报销单号[”, 票, “]批准提示！”, #换行符, “    您当前拥有对费用报销单的批准权，请输入您的签名！”), “费用报销单审查批准！”, “您的签名”, 签名, ))
    .如果真 (等于 (签名, “”))
        信息框 (“没有签名！”, 0, )
        返回 ()
    .如果真结束
    .如果真 (未知支持库函数_19 (连接句柄, “fybxd”, 相加 (“pzr='”, 签名, “'”), 相加 (“djh='”, 票, “'”)))
        信息框 (相加 (“费用报销单号[”, 票, “]已批准”), 0, )
        赋值 (记录日志, 相加 (“费用报销单号[”, 票, “]批准”))
        写日志 ()
        赋值 (搜索时间, 相加 (到文本 (取年份 (.今天)), “-”, .内容, “-”))
        填费用列表 ()
    .如果真结束
    
.如果真结束




.子程序 _出纳员_被单击, 空白型, , 
.局部变量 wb, 文本型, , "0", 
.局部变量 签名, 文本型, , , 
.局部变量 票, 文本型, , , 
.局部变量 位, 整数型, , , 

赋值 (票, .内容)
.如果真 (等于 (票, “”))
    信息框 (“请选择被审核的票据号！”, 0, )
    返回 ()
.如果真结束
赋值 (位, 票.查找表项 (0, ))
.如果真 (等于 (位.取标题 (3), “”))
    信息框 (“选择的票据号没有报销人签名！”, #信息图标, “越级错误！！！”)
    返回 ()
.如果真结束
.如果真 (输入框 (相加 (“费用报销单号[”, 票, “]出纳签名提示！”, #换行符, “    请输入您的签名！”), “费用报销单出纳签名！”, “您的签名”, 签名, ))
    .如果真 (等于 (签名, “”))
        信息框 (“没有签名！”, 0, )
        返回 ()
    .如果真结束
    .如果真 (未知支持库函数_19 (连接句柄, “fybxd”, 相加 (“cny='”, 签名, “'”), 相加 (“djh='”, 票, “'”)))
        信息框 (相加 (“费用报销单号[”, 票, “]已复核”), 0, )
        赋值 (搜索时间, 相加 (到文本 (取年份 (.今天)), “-”, .内容, “-”))
        填费用列表 ()
    .如果真结束
    
.如果真结束


.子程序 _会计复核_被单击, 空白型, , 
.局部变量 wb, 文本型, , "0", 
.局部变量 签名, 文本型, , , 
.局部变量 票, 文本型, , , 
.局部变量 位, 整数型, , , 

赋值 (票, .内容)
.如果真 (等于 (票, “”))
    信息框 (“请选择被审核的票据号！”, 0, )
    返回 ()
.如果真结束
赋值 (位, 票.查找表项 (0, ))
.如果真 (等于 (位.取标题 (3), “”))
    信息框 (“选择的票据号没有报销人签名！”, #信息图标, “越级错误！！！”)
    返回 ()
.如果真结束

载入 (管理员登录窗口, _启动窗口, 真)
.如果真 (等于 (password, “”))
    返回 ()
.如果真结束
赋值 (wb, 分割文本 (文本解密 (password, “lz的cxntmdg8ygd”), “.”, ))
.如果真 (不等于 (取数组成员数 (wb), 20))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束
.如果真 (等于 (wb [14], “26”))
    信息框 (相加 (“  抱歉！权限问题！”, #换行符, #换行符, “您没有当前的操作权限,有问题请管理员解决！”, #换行符, #换行符), #警告图标, “登录权限不够！”)
    返回 ()
.如果真结束

.如果真 (输入框 (相加 (“费用报销单号[”, 票, “]复核提示！”, #换行符, “    您当前拥有对费用报销单的复核权，请输入您的签名！”), “费用报销单复核审查！”, “您的签名”, 签名, ))
    .如果真 (等于 (签名, “”))
        信息框 (“没有签名！”, 0, )
        返回 ()
    .如果真结束
    .如果真 (未知支持库函数_19 (连接句柄, “fybxd”, 相加 (“fhr='”, 签名, “'”), 相加 (“djh='”, 票, “'”)))
        信息框 (相加 (“费用报销单号[”, 票, “]已复核”), 0, )
        赋值 (搜索时间, 相加 (到文本 (取年份 (.今天)), “-”, .内容, “-”))
        填费用列表 ()
    .如果真结束
    
.如果真结束



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 打印超级列表框, 空白型, , 
.参数 超级列表框, 超级列表框, , 
.参数 题目, 文本型, 可空, 
.参数 页眉, 文本型, 可空, 
.参数 页脚, 文本型, 可空, 
.参数 备注, 文本型, 可空, 



.窗口程序集 报名单据窗口程序集, , , 

.程序集变量 xh, 文本型, , , 
.程序集变量 xm, 文本型, , , 
.程序集变量 bj, 文本型, , , 
.程序集变量 xf, 文本型, , , 
.程序集变量 xzf, 文本型, , , 
.程序集变量 hsf, 文本型, , , 
.程序集变量 sfmf, 文本型, , , 
.子程序 _报名单据窗口_创建完毕, 空白型, , 
赋值 (风格类型, 到数值 (读配置项 (相加 (取运行目录 (), “\config.ini”), “Interface”, “Style”, )))
未知支持库函数_0 (风格类型)
填充班级模板 ()
12.置光标 (1)

.子程序 填充班级模板, 空白型, , 
.如果真 (等于 (填充班级名称 (), 假))
    返回 ()
.如果真结束
“小学1年级1班”.选择 ()
0.初始尺寸 (0)
相加 (取运行目录 (), “\RECEIPT.rtd”).从文件读 ()
2.置文本 (11, 时间到文本 (取现行时间 (), #日期部分))
10.置文本 (1, 时间到文本 (取现行时间 (), #日期部分))

.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.判断开始 (等于 (按钮索引, 1))
    保存单据 ()
.判断 (等于 (按钮索引, 2))
    删除单据 ()
.判断 (等于 (按钮索引, 4))
    打印预览 ()
.判断 (等于 (按钮索引, 5))
    赋值 (.缩放比, 相加 (.缩放比, 10))
.判断 (等于 (按钮索引, 6))
    赋值 (.缩放比, 相减 (.缩放比, 10))
.判断 (等于 (按钮索引, 8))
    
.判断 (等于 (按钮索引, 9))
    
.判断 (等于 (按钮索引, 11))
    填表B ()
.判断 (等于 (按钮索引, 12))
    填表A ()
.默认
    
.判断结束


.子程序 保存单据, 空白型, , 
.局部变量 单据, 文本型, , , 
.局部变量 数据, 文本型, , , 
.局部变量 数据2, 字节集, , , 

赋值 (单据, 1.取文本 (15))
.如果真 (等于 (单据, “”))
    信息框 (“ 未输入单据号。。。。。。！”, 0, )
    返回 ()
.如果真结束
.如果真 (取数据库重复记录 (连接句柄, “xfsjb”, “djh”, 单据))
    信息框 (“此单据号已经被使用！！！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (取库特定记录 (连接句柄, “xsda”, “xh”, “bm”, xh), “0”))
    信息框 (“    抱歉！ 当前需要开单的同学还没有进行报名保存操作。请首先执行报名，即单击[报名]键！”, #信息图标, “ 越界错误！”)
    销毁 ()
    返回 ()
.如果真结束
.如果真 (取数据库重复记录 (连接句柄, “xfsjb”, “djh”, 单据))
    返回 ()
.如果真结束

保存更改 ()
刷新显示 ()
赋值 (数据, 相加 (“djh='”, 单据, “',xh='”, xh, “',xm='”, xm, “',bj='”, bj, “',nf='”, 到文本 (取年份 (取现行时间 ())), “',xq='”, 当前学期, “',xf='”, xf, “',xzf='”, xzf, “',hsf='”, hsf, “',sfmf='”, sfmf, “'”))
赋值 (数据2, 未知支持库函数_0 (存到字节集 ()))
检查连接 ()
.如果真 (未知支持库函数_18 (连接句柄, “xfsjb”, 数据))
    .如果真 (未知支持库函数_46 (连接句柄, “xfsjb”, “data”, 相加 (“xh='”, xh, “'”), 数据2))
        赋值 (记录日志, 相加 (“保存”, xm, “同学报名费单据完成”))
        写日志 ()
        信息框 (相加 (“保存”, xm, “同学报名费单据完成！”), 0, )
        填表A ()
        返回 ()
        
    .如果真结束
    
.如果真结束
提示错误 ()

.子程序 删除单据, 空白型, , 
信息框 (“不能随便删除当前单据！！！”, 0, )

.子程序 _表格_内容被改变, 空白型, , 
.参数 行号, 整数型, , 
.参数 列号, 整数型, , 
.参数 行数, 整数型, , 
.参数 列数, 整数型, , 

.判断开始 (并且 (等于 (行号, 1), 等于 (列号, 15)))
    4.置文本 (1, 1.取文本 (15))
.判断 (并且 (等于 (行号, 2), 等于 (列号, 11)))
    10.置文本 (1, 2.取文本 (11))
.判断 (并且 (等于 (行号, 7), 等于 (列号, 6)))
    8.置文本 (1, 7.取文本 (6))
.默认
    
.判断结束


.子程序 填表A, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 行, 整数型, , , 
.局部变量 表项数, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 FA, 双精度小数型, , , 
.局部变量 FB, 双精度小数型, , , 
.局部变量 FC, 双精度小数型, , , 

置等待鼠标 ()
.如果真 (等于 (.内容, “”))
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “(所有学生)”))
    信息框 (“请选择正确的班级！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
检查连接 ()
全部删除 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select djh,xh,xm,bj,xf,xzf,hsf from xfsjb where bj like '%”, .内容, “%' ORDER BY djh ASC;”)), 假)) ' 导出记录
    提示错误 ()
    返回 ()
.如果真结束

赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (字段数, 未知支持库函数_14 (记录集句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
连续赋值 (0, FA, FB, FC)
.计次循环首 (记录数, 行)
    置等待鼠标 ()
    赋值 (表项数, -1.插入表项 ())
    赋值 (文本变量, “”)
    .计次循环首 (字段数, 列)
        未知支持库函数_15 (记录集句柄, 相减 (列, 1), 字段名)
        未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
        .如果真 (等于 (字段名, “xf”))
            赋值 (FA, 相加 (FA, 到数值 (文本变量)))
        .如果真结束
        .如果真 (等于 (字段名, “xzf”))
            赋值 (FB, 相加 (FB, 到数值 (文本变量)))
        .如果真结束
        .如果真 (等于 (字段名, “hsf”))
            赋值 (FC, 相加 (FC, 到数值 (文本变量)))
        .如果真结束
        .如果真 (不等于 (文本变量, “”))
            表项数.置标题 (相减 (列, 1), 文本变量)
        .如果真结束
        
    .计次循环尾 ()
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
赋值 (.标题, 相加 (“已报名学生共有：”, 到文本 (取表项数 ()), “名”))
刷新显示 ()
赋值 (.标题, 数值到格式文本 (FA, 2, 假))
赋值 (.标题, 数值到格式文本 (FB, 2, 假))
赋值 (.标题, 数值到格式文本 (FC, 2, 假))
赋值 (.标题, 数值到格式文本 (相加 (FA, FB, FC), 2, 假))
恢复鼠标 ()


.子程序 填表B, 空白型, , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 行, 整数型, , , 
.局部变量 表项数, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 FA, 双精度小数型, , , 
.局部变量 FB, 双精度小数型, , , 
.局部变量 FC, 双精度小数型, , , 

置等待鼠标 ()
.如果真 (等于 (.内容, “”))
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “(所有学生)”))
    信息框 (“请选择正确的班级！”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
检查连接 ()
全部删除 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, “select djh,xh,xm,bj,xf,xzf,hsf from xfsjb ORDER BY djh ASC;”), 假)) ' 导出记录
    提示错误 ()
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
赋值 (字段数, 未知支持库函数_14 (记录集句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
连续赋值 (0, FA, FB, FC)
.计次循环首 (记录数, 行)
    置等待鼠标 ()
    赋值 (表项数, -1.插入表项 ())
    赋值 (文本变量, “”)
    .计次循环首 (字段数, 列)
        未知支持库函数_15 (记录集句柄, 相减 (列, 1), 字段名)
        未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
        .如果真 (等于 (字段名, “xf”))
            赋值 (FA, 相加 (FA, 到数值 (文本变量)))
        .如果真结束
        .如果真 (等于 (字段名, “xzf”))
            赋值 (FB, 相加 (FB, 到数值 (文本变量)))
        .如果真结束
        .如果真 (等于 (字段名, “hsf”))
            赋值 (FC, 相加 (FC, 到数值 (文本变量)))
        .如果真结束
        .如果真 (不等于 (文本变量, “”))
            表项数.置标题 (相减 (列, 1), 文本变量)
        .如果真结束
        
    .计次循环尾 ()
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)
赋值 (.标题, 相加 (“全校已报名学生共有：”, 到文本 (取表项数 ()), “名”))
刷新显示 ()
赋值 (.标题, 数值到格式文本 (FA, 2, 假))
赋值 (.标题, 数值到格式文本 (FB, 2, 假))
赋值 (.标题, 数值到格式文本 (FC, 2, 假))
赋值 (.标题, 数值到格式文本 (相加 (FA, FB, FC), 2, 假))
恢复鼠标 ()


.子程序 _组合框1_列表项被选择, 空白型, , 
填表A ()

.子程序 _超级列表框_当前表项被改变, 空白型, , 
.局部变量 号, 文本型, , , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 字节, 字节集, , , 
.局部变量 字节A, 字节集, , , 

赋值 (号, .取标题 (., 0))
检查连接 ()
.如果真 (等于 (未知支持库函数_3 (连接句柄, 相加 (“select djh,data from xfsjb where djh='”, 号, “' ORDER BY djh ASC;”)), 假))
    提示错误 ()
    返回 ()
.如果真结束
赋值 (记录集句柄, 未知支持库函数_4 (连接句柄))
未知支持库函数_12 (记录集句柄)
未知支持库函数_6 (记录集句柄, “data”, 字节)
未知支持库函数_5 (记录集句柄)
赋值 (字节A, 未知支持库函数_1 (字节))

0.初始尺寸 (0)
字节A.从字节集读 ()


 ' 不属于任何一个程序集、类模块的函数：
