 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 391
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\自动点击辅助工具.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “自动点击辅助工具-测试版”
    帮助文件名 = “”



.图片 图片1, " ' 已保存到：D:\易语言学习\Data\自动点击辅助工具.e\图片1", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 0 系统核心支持库
 ' eLIB DA19BC3ADD2F4121ABD84AC5FBCAFC71 1 3 ｅＬＩＢ＋＋EX
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 0 应用接口支持库




数据类型 POINT, , 
    .成员 x, 整数型, , , X轴坐标
    .成员 y, 整数型, , , Y轴坐标

数据类型 rect, , 
    .成员 左边, 空白型, , , 
    .成员 顶边, 空白型, , , 
    .成员 右边, 空白型, , , 
    .成员 底边, 空白型, , , 

.全局变量 句柄, 整数型, , , 
.全局变量 鼠标钩子句柄, 整数型, , , 
.全局变量 ls, 短整数型, , , 
.全局变量 窗口范围, rect, , , 
.全局变量 标志位, 短整数型, , , 

.DLL命令 取进程ID, 整数型, "", "GetWindowLongA", , 
    .参数 hWnd, 整数型, , 
    .参数 nIndex, 整数型, , 功能索引

.DLL命令 投递消息, 整数型, "", "PostMessageA", , 
    .参数 hwnd, 整数型, , 窗口句柄
    .参数 wMsg, 整数型, , 请参考发送消息
    .参数 wParam, 整数型, , 请参考发送消息
    .参数 lParam, 整数型, , 请参考发送消息

.DLL命令 取场景句柄, 整数型, "user32.dll", "GetDC", , 
    .参数 hwnd, 整数型, , 

.DLL命令 取RGB值, 整数型, "gdi32.dll", "GetPixel", , 
    .参数 场景句柄, 整数型, , 
    .参数 x, 整数型, , 
    .参数 y, 整数型, , 

.DLL命令 取窗口的范围矩形_, 整数型, "user32.dll", "GetWindowRect", , 获得整个窗口的范围矩形，窗口的边框、标题栏、滚动条及菜单等都在这个矩形内
    .参数 句柄, 整数型, , Long，想获得范围矩形的那个窗口的句柄
    .参数 大小, rect, 传址, RECT，屏幕坐标中随同窗口装载的矩形

.窗口程序集 窗口程序集1, , , 

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 X1, 整数型, , , 
.局部变量 Y1, 整数型, , , 

赋值 (句柄, 到数值 (.内容))
赋值 (X1, 到数值 (.内容))
赋值 (Y1, 到数值 (.内容))
赋值 (i, 相加 (相乘 (Y1, 65536), X1))
处理事件 ()
投递消息 (句柄, 513, 0, i) ' 发送控件鼠标左键被按下的信息
投递消息 (句柄, 514, 0, i) ' 发送控件鼠标左键被放开的信息
返回 ()

.子程序 _按钮2_被单击, 空白型, , 
赋值 (鼠标钩子句柄, 未知支持库函数_17 (&鼠标处理子程序))
返回 ()

.子程序 鼠标处理子程序, 空白型, , 
.参数 鼠标状态, 整数型, , 
.参数 X, 整数型, , 
.参数 Y, 整数型, , 

.局部变量 场景句柄, 整数型, , , 

.判断开始 (等于 (鼠标状态, #))
    处理事件 ()
    赋值 (.内容, 到文本 (未知支持库函数_78 ()))
    赋值 (.内容, 未知支持库函数_76 (到数值 (.内容)))
    赋值 (.内容, 未知支持库函数_77 (到数值 (.内容)))
    赋值 (.内容, 相加 (“名:”, 取得进程名 (到数值 (.内容)), “ ”, “ID:”, 到文本 (取进程ID (到数值 (.内容), -12))))
    取窗口的范围矩形_ (到数值 (.内容), 窗口范围)
    赋值 (.内容, 到文本 (相减 (X, 窗口范围.左边)))
    赋值 (.内容, 到文本 (相减 (Y, 窗口范围.顶边)))
    赋值 (场景句柄, 取场景句柄 (0))
    赋值 (.内容, 到文本 (取RGB值 (场景句柄, X, Y)))
    赋值 (.背景颜色, 到数值 (.内容))
    
.默认
    .如果真 (等于 (鼠标状态, #))
        未知支持库函数_18 (0)
        返回 ()
    .如果真结束
    
.判断结束
返回 ()

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
赋值 (_启动窗口., 2)
赋值 (_启动窗口., 假)
_启动窗口.置托盘图标 (#图片1, “自动点击辅助工具”)
返回 (假)

.子程序 __启动窗口_托盘事件, 空白型, , 
.参数 操作类型, 整数型, , 

.如果 (等于 (操作类型, 3))
    弹出托盘菜单 ()
    
.否则
    赋值 (_启动窗口., 真)
    赋值 (_启动窗口., 0)
.如果结束
返回 ()

.子程序 _按钮3_被单击, 空白型, , 
结束 ()

.子程序 _退出_被选择, 空白型, , 
置托盘图标 ()
结束 ()

.子程序 _选择框1_被单击, 空白型, , 
.如果真 (等于 (.选中, 真))
    赋值 (_启动窗口., 真)
.如果真结束
.如果真 (等于 (.选中, 假))
    赋值 (_启动窗口., 假)
.如果真结束
返回 ()

.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (标志位, 0)
赋值 (.选中, 真)
赋值 (_启动窗口., 真)
相加 (“说明：点击开始按钮开始”, #换行符, “取坐标，单击鼠标左键停”, #换行符, “止,点击模拟自动点击按”, #换行符, “钮进行测试。”).滚动写行 ()
返回 ()

.子程序 _编辑框9_内容被改变, 空白型, , 
.如果真 (等于 (标志位, 1))
    赋值 (.内容, 取十六进制文本 (到数值 (.内容)))
.如果真结束
返回 ()

.子程序 _编辑框8_内容被改变, 空白型, , 
.如果真 (等于 (标志位, 2))
    赋值 (.内容, 到文本 (十六进制到十进制 (.内容)))
.如果真结束
返回 ()

.子程序 _编辑框9_获得焦点, 空白型, , 
赋值 (标志位, 1)
返回 ()

.子程序 _编辑框8_获得焦点, 空白型, , 
赋值 (标志位, 2)
返回 ()

.子程序 十六进制到十进制, 整数型, , 
.参数 十六进制文本, 文本型, , 

.局部变量 文本, 文本型, , , 
.局部变量 最终值, 整数型, , , 
.局部变量 i, 整数型, , , 中间循环变量
.局部变量 临时数值, 文本型, , , 每一位上的值

赋值 (文本, 到小写 (十六进制文本))
.变量循环首 (1, 取文本长度 (文本), 1, i)
    赋值 (临时数值, 取文本中间 (文本, i, 1))
    .如果 (并且 (大于或等于 (取代码 (临时数值, ), 取代码 (“a”, )), 小于或等于 (取代码 (临时数值, ), 取代码 (“f”, ))))
        赋值 (最终值, 相加 (最终值, 相乘 (相加 (相减 (取代码 (临时数值, ), 取代码 (“a”, )), 10), 求次方 (16, 相减 (取文本长度 (文本), i)))))
    .否则
        赋值 (最终值, 相加 (最终值, 相乘 (到数值 (临时数值), 求次方 (16, 相减 (取文本长度 (文本), i)))))
    .如果结束
    
.变量循环尾 ()
返回 (最终值)

.程序集 _模块_进程名&窗口句柄互取, , , ** 不要更改此处 窗口句柄&进程名互取.ec

.子程序 取得窗口句柄, 整数型, , 按进程名（运行程序文件名）取得窗口句柄，失败返回0
.参数 文件名, 文本型, , 要取窗口句柄的进程名

 ' ** 本子程序功能由系统自动转交对应模块实现，可以删除但不能修改。

.子程序 取得进程名, 文本型, , 按窗口句柄取得进程名
.参数 窗口句柄, 整数型, , 要取进程名的窗口句柄

 ' ** 本子程序功能由系统自动转交对应模块实现，可以删除但不能修改。


 ' 不属于任何一个程序集、类模块的函数：
