 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 430
    高度 = 274
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\sd.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “XHX杀毒软件 Version1.2（本杀软宗旨：非特征码检测，做到智能判断）”
    帮助文件名 = “”

窗口 设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 227
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15131837 '  0xE6E4BD
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\sd.e\设置窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “系统设置”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 5 系统核心支持库
 ' ExtMenu 9909FBB013704cfa8FE7E739DB7172DE 1 6 超级菜单支持库
 ' internet 707ca37322474f6ca841f0e224f4b620 1 0 互联网支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 1 3 高级表格支持库




.全局变量 文本变量, 文本型, , , 
.全局变量 广告软件, 文本型, , , 
.全局变量 病毒, 文本型, , , 
.全局变量 木马, 文本型, , , 
.全局变量 描述, 文本型, , , 
.全局变量 系统进程, 未知类型0x40009, , "0", 
.全局变量 次数, 整数型, , , 
.全局变量 记录, 整数型, , , 
.全局变量 整数容器, 整数型, , "10", 
.全局变量 文件号, 整数型, , , 
.全局变量 文本容器, 文本型, , "10", 
.全局变量 病毒名, 文本型, , , 
.全局变量 病毒PID, 整数型, , , 

.窗口程序集 窗口程序集1, , , 

.子程序 _关于2_被选择, 空白型, , 
信息框 (相加 (“上网最恐怖的事莫过于新病毒出来的时候，尽管电脑上我们都装有各种强大的杀毒软件，也配置了定时自动更新病毒库，但病毒总是要先于病毒库的更新的，所以中招的每次都不会是少数，本杀毒软件便可以采用智能化方式杀遍通常的新病毒！”, #换行符, #换行符, “XHX杀毒软件”, #换行符, #换行符, “许宏旭 编”), 0, )

.子程序 __启动窗口_首次激活, 空白型, , 
_启动窗口.置托盘图标 (_启动窗口., “XHX杀毒软件V1.0（本杀软宗旨：非特征码检测，做到智能判断）”)
.如果真 (等于 (文件是否存在 (“start.rec”), 真))
    检测 ()
.如果真结束
赋值 (.可视, 假)
连续赋值 (真, ., ., ., ., .)

.子程序 杀毒, 空白型, , 
.局部变量 驱动器列表, 文本型, , "0", 

运行 (相加 (“ntsd -c q -p”, 到文本 (病毒PID)), 假, )
运行 (“delreg.bat”, 假, )
运行 (“import.bat”, 假, )
赋值 (驱动器列表, 未知支持库函数_5 (0))
.计次循环首 (取数组成员数 (驱动器列表), 整数容器 [4])
    目录杀毒 (相加 (驱动器列表 [整数容器] [4], “:\”))
.计次循环尾 ()

.子程序 目录杀毒, 空白型, , 
.参数 目录, 文本型, , 

.局部变量 文件名, 文本型, , , 

赋值 (文件名, 寻找文件 (相加 (目录, 病毒名), ))
.判断循环首 (不等于 (文件名, “”))
    相加 (目录, 文件名).加入项目 ()
    删除文件 (相加 (目录, 文件名))
    赋值 (文件名, 寻找文件 ())
.判断循环尾 ()
赋值 (文件名, 寻找文件 (相加 (目录, “*.*”), #子目录))
.判断循环首 (不等于 (文件名, “”))
    .如果真 (不等于 (取文本左边 (文件名, 1), “.”))
        目录杀毒 (相加 (目录, 文件名))
    .如果真结束
    赋值 (文件名, 寻找文件 (#子目录))
.判断循环尾 ()

.子程序 _备份_被选择, 空白型, , 
连续赋值 (假, ., ., ., ., .)
赋值 (.可视, 真)
刷新显示 ()
赋值 (系统进程, 未知支持库函数_10 ())
.计次循环首 (取数组成员数 (系统进程), 次数)
    赋值 (文本变量, 到文本 (未知支持库函数_7 (相加 (“http://www.pctutu.com/process/search.html?k=”, 系统进程 [次数], ))))
    赋值 (.内容, 取文本右边 (文本变量, 相减 (取文本长度 (文本变量), 寻找文本 (文本变量, “・<a href=”, , 真), 10)))
    赋值 (.内容, 相加 (“http://www.pctutu.com/process/”, 取文本左边 (.内容, 寻找文本 (.内容, “.htm”, , 真)), “htm”))
    赋值 (文本变量, 到文本 (未知支持库函数_7 (.内容)))
    赋值 (.内容, 取文本右边 (文本变量, 相减 (取文本长度 (文本变量), 寻找文本 (文本变量, “广告软件”, , 真), 37)))
    赋值 (广告软件, 取文本左边 (.内容, 相减 (寻找文本 (.内容, “.jpg”, , 真), 1)))
    赋值 (.内容, 取文本右边 (文本变量, 相减 (取文本长度 (文本变量), 寻找文本 (文本变量, “病毒”, , 真), 33)))
    赋值 (病毒, 取文本左边 (.内容, 相减 (寻找文本 (.内容, “.jpg”, , 真), 1)))
    赋值 (.内容, 取文本右边 (文本变量, 相减 (取文本长度 (文本变量), 寻找文本 (文本变量, “木马”, , 真), 45)))
    赋值 (木马, 取文本左边 (.内容, 相减 (寻找文本 (.内容, “.jpg”, , 真), 1)))
    .如果 (或者 (等于 (广告软件, “true”), 等于 (病毒, “true”), 等于 (木马, “true”)))
        赋值 (记录, 50)
        跳出循环 ()
    .否则
        赋值 (记录, 0)
    .如果结束
    赋值 (.标题, 相加 (“正在检测……”, 到文本 (次数), “/”, 到文本 (取数组成员数 (系统进程))))
    刷新显示 ()
.计次循环尾 ()
.如果 (不等于 (记录, 50))
    运行 (“record.bat”, 假, )
    信息框 (“已备份！”, 0, )
.否则
    .如果真 (等于 (信息框 (相加 (“您的计算机可能存在风险，建议不要备份！风险进程：”, 系统进程 [次数], , #换行符, “还要继续备份吗？”), 4, ), 5))
        信息框 (“已备份！”, 0, )
    .如果真结束
    
.如果结束
连续赋值 (真, ., ., ., ., .)
赋值 (.可视, 假)

.子程序 _超级按钮4_被单击, 空白型, , 
_关于2_被选择 ()

.子程序 _超级按钮1_被单击, 空白型, , 
_备份_被选择 ()

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
.如果真 (等于 (整数容器 [1], 0))
    信息框 (“杀毒软件还在运行当中……请查看右下角托盘处！单击弹出杀毒软件主界面。”, 0, )
.如果真结束
赋值 (_启动窗口., 假)
返回 (假)

.子程序 __启动窗口_托盘事件, 空白型, , 
.参数 操作类型, 整数型, , 

.如果 (等于 (操作类型, 1))
    .如果 (等于 (_启动窗口., 真))
        赋值 (_启动窗口., 假)
    .否则
        赋值 (_启动窗口., 真)
    .如果结束
    
.否则
    .如果真 (等于 (操作类型, 3))
        弹出托盘菜单 ()
    .如果真结束
    
.如果结束


.子程序 _退出2_被选择, 空白型, , 
销毁 ()

.子程序 __启动窗口_将被销毁, 空白型, , 
_启动窗口.置托盘图标 ({  }, “”)

.子程序 _超级按钮2_被单击, 空白型, , 
赋值 (.可视, 真)
刷新显示 ()
连续赋值 (假, ., ., ., ., .)
检测 ()
赋值 (.可视, 假)
连续赋值 (真, ., ., ., ., .)

.子程序 检测, 空白型, , 
赋值 (记录, 0)
赋值 (系统进程, 未知支持库函数_10 ())
.计次循环首 (取数组成员数 (系统进程), 次数)
    赋值 (文本变量, 到文本 (未知支持库函数_7 (相加 (“http://www.pctutu.com/process/search.html?k=”, 系统进程 [次数], ))))
    赋值 (.内容, 取文本右边 (文本变量, 相减 (取文本长度 (文本变量), 寻找文本 (文本变量, “・<a href=”, , 真), 10)))
    赋值 (.内容, 相加 (“http://www.pctutu.com/process/”, 取文本左边 (.内容, 寻找文本 (.内容, “.htm”, , 真)), “htm”))
    赋值 (文本变量, 到文本 (未知支持库函数_7 (.内容)))
    赋值 (.内容, 取文本右边 (文本变量, 相减 (取文本长度 (文本变量), 寻找文本 (文本变量, “广告软件”, , 真), 37)))
    赋值 (广告软件, 取文本左边 (.内容, 相减 (寻找文本 (.内容, “.jpg”, , 真), 1)))
    赋值 (.内容, 取文本右边 (文本变量, 相减 (取文本长度 (文本变量), 寻找文本 (文本变量, “病毒”, , 真), 33)))
    赋值 (病毒, 取文本左边 (.内容, 相减 (寻找文本 (.内容, “.jpg”, , 真), 1)))
    赋值 (.内容, 取文本右边 (文本变量, 相减 (取文本长度 (文本变量), 寻找文本 (文本变量, “木马”, , 真), 45)))
    赋值 (木马, 取文本左边 (.内容, 相减 (寻找文本 (.内容, “.jpg”, , 真), 1)))
    .如果 (或者 (等于 (广告软件, “true”), 等于 (病毒, “true”), 等于 (木马, “true”)))
        赋值 (记录, 50)
        跳出循环 ()
    .否则
        赋值 (记录, 0)
    .如果结束
    赋值 (.标题, 相加 (“正在检测……”, 到文本 (次数), “/”, 到文本 (取数组成员数 (系统进程))))
    刷新显示 ()
.计次循环尾 ()
.如果 (不等于 (记录, 50))
    运行 (“record.bat”, 假, )
.否则
    .如果真 (等于 (信息框 (相加 (“您的计算机可能存在风险！风险进程：”, 系统进程 [次数], , #换行符, “是否处理？”), 4, ), 5))
        赋值 (病毒名, 系统进程 [次数], )
        赋值 (病毒PID, 系统进程 [次数], )
        运行 (“check.bat”, 假, )
        赋值 (文件号, 打开文件 (“c:\check.txt”, 1, ))
        .计次循环首 (4, )
            读入一行 (文件号)
        .计次循环尾 ()
        .判断循环首 (等于 (是否在文件尾 (文件号, ), 假))
            赋值 (文本容器 [1], 读入一行 (文件号))
            赋值 (整数容器 [2], 倒找文本 (文本容器 [1], “ ”, , 真))
            .如果 (等于 (取文本右边 (文本容器 [1], 相减 (取文本长度 (文本容器 [1]), 整数容器 [2])), 到文本 (系统进程 [次数], )))
                .如果 (等于 (信息框 (“经过确认，您的电脑极有可能已经感染病毒，请问是否清除？”, 4, ), 5))
                    杀毒 ()
                    跳出循环 ()
                .否则
                    信息框 (“您的计算机可能受到病毒感染，请注意保养！”, 0, )
                    跳出循环 ()
                .如果结束
                
            .否则
                .如果真 (等于 (信息框 (“查到的病毒有可能是间谍软件或恶意软件，但也有%10~15%的可能是正常软件，请问还要继续吗？”, 4, ), 5))
                    杀毒 ()
                    跳出循环 ()
                .如果真结束
                
            .如果结束
            
        .判断循环尾 ()
    .如果真结束
    
.如果结束


.子程序 _检测_被选择, 空白型, , 
_超级按钮2_被单击 ()

.子程序 _系统设置_被选择, 空白型, , 
载入 (设置窗口, , 假)

.子程序 __启动窗口_创建完毕, 空白型, , 
.如果真 (等于 (文件是否存在 (“reg.rec”), 假))
    赋值 (., 真)
    赋值 (.禁止, 真)
    赋值 (.时钟周期, 0)
.如果真结束


.子程序 _系统设置2_被选择, 空白型, , 
_系统设置_被选择 ()

.子程序 _关于_被选择, 空白型, , 
_关于2_被选择 ()

.子程序 _退出_被选择, 空白型, , 
销毁 ()

.子程序 _时钟1_周期事件, 空白型, , 
检测 ()

.子程序 _超级按钮3_被单击, 空白型, , 
_系统设置2_被选择 ()

.子程序 _超级按钮5_被单击, 空白型, , 


.子程序 _时钟2_周期事件, 空白型, , 
处理事件 ()
_启动窗口.刷新显示 ()
刷新显示 ()
刷新显示 ()
刷新显示 ()
刷新显示 ()
刷新显示 ()
刷新显示 ()

.窗口程序集 窗口程序集2, , , 

.子程序 _按钮1_被单击, 空白型, , 
.如果真 (等于 (文件是否存在 (“reg.rec”), 真))
    .如果 (等于 (.选中, 真))
        未知支持库函数_25 (“XHX杀毒软件V1.2”, 相加 (取当前目录 (), “\XHX杀毒软件V1.2.exe”), 0)
    .否则
        未知支持库函数_83 (“XHX杀毒软件V1.2”)
    .如果结束
    .如果 (等于 (.选中, 真))
        “start.rec”.未知支持库函数_55 ()
    .否则
        删除文件 (“start.rec”)
    .如果结束
    
.如果真结束
.如果真 (并且 (等于 (.内容, 到文本 (取硬盘特征字 ())), 等于 (文件是否存在 (“reg.rec”), 假)))
    “reg.rec”.未知支持库函数_55 ()
    信息框 (“请重启本软件！”, 0, )
.如果真结束


.子程序 _设置窗口_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _特征字_被选择, 空白型, , 
信息框 (取硬盘特征字 (), 0, )


 ' 不属于任何一个程序集、类模块的函数：
