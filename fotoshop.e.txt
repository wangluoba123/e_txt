 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 0
    顶边 = 0
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “Fotushop 浮图 - 新世纪艺术图片生成系统”
    帮助文件名 = “”

窗口 工具盘窗口 ' 矩形单选框1
    左边 = 500
    顶边 = 50
    宽度 = 63
    高度 = 353
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 0
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 0
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\fotoshop.e\工具盘窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 调色板窗口
    左边 = 400
    顶边 = 420
    宽度 = 212
    高度 = 148
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 真
    图标 =  ' 已保存到：D:\易语言学习\Data\fotoshop.e\调色板窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 画板打印设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 725
    高度 = 393
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “打印”
    帮助文件名 = “”



.图片 扫描程序, " ' 已保存到：D:\易语言学习\Data\fotoshop.e\扫描程序", , 
.图片 LOGO6, " ' 已保存到：D:\易语言学习\Data\fotoshop.e\LOGO6", , 
.图片 LOGO7, " ' 已保存到：D:\易语言学习\Data\fotoshop.e\LOGO7", , 
.图片 , , , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 3 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 1 扩展界面支持库一




数据类型 绘画数据, , 
    .成员 外形, 空白型, , , 
    .成员 线宽, 空白型, , , 
    .成员 填充类型, 空白型, , , 
    .成员 前景, 空白型, , , 
    .成员 背景, 空白型, , , 
    .成员 左边, 空白型, , , 
    .成员 上边, 空白型, , , 
    .成员 右边, 空白型, , , 
    .成员 下边, 空白型, , , 

.全局变量 默认宽度, 整数型, , , 
.全局变量 默认高度, 整数型, , , 
.全局变量 匿名全局变量_257, 空白型, , , 
.全局变量 原鼠标X标, 整数型, , , 
.全局变量 原鼠标Y标, 整数型, , , 
.全局变量 现鼠标X标, 整数型, , , 
.全局变量 现鼠标Y标, 整数型, , , 
.全局变量 匿名全局变量_247, 空白型, , , 
.全局变量 匿名全局变量_248, 空白型, , , 
.全局变量 图片号, 整数型, , , 
.全局变量 内存图片, 字节集, , , 
.全局变量 比例宽, 长整数型, , , 
.全局变量 比例高, 长整数型, , , 

.DLL命令 俘获鼠标, 空白型, "", "SetCapture", , 
    .参数 窗口句柄, 整数型, , 

.DLL命令 取颜色, 整数型, "", "GetPixel", , 
    .参数 设备场景句柄, 整数型, , 
    .参数 X坐标, 整数型, , 
    .参数 Y坐标, 整数型, , 

.DLL命令 取设备场景句柄, 整数型, "", "GetDC", , 
    .参数 窗口句柄, 整数型, , 

.DLL命令 释放鼠标, 空白型, "", "ReleaseCapture", , 

.窗口程序集 启动窗口程序, , , 

.程序集变量 旧图片号_, 整数型, , , 
.程序集变量 新图片号_, 整数型, , , 
.程序集变量 高度_, 整数型, , , 
.程序集变量 宽度_, 整数型, , , 
.程序集变量 刚刚打开_, 逻辑型, , , 
.程序集变量 匿名程序集变量_251, 空白型, , , 
.程序集变量 切片高度_, 整数型, , , 
.程序集变量 切片次数_, 整数型, , , 
.程序集变量 切片顶边_, 整数型, , , 
.程序集变量 匿名程序集变量_25, 空白型, , , 
.程序集变量 切片文件_, 文本型, , , 
.程序集变量 循环次数_, 整数型, , , 
.程序集变量 匿名程序集变量_675, 空白型, , , 
.程序集变量 正在绘画, 逻辑型, , , 
.程序集变量 当前绘画, 未知类型0x410102A8, , , 
.程序集变量 所有数据, 未知类型0x410102A8, , "0", 
.程序集变量 匿名程序集变量_676, 空白型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (_启动窗口.宽度, 取屏幕宽度 ())
赋值 (.高度, 取屏幕高度 ())
载入 (工具盘窗口, , 假)
载入 (调色板窗口, , 假)
赋值 (工具盘窗口..选中, 真)
赋值 (工具盘窗口..选中, 真)


.子程序 __启动窗口_尺寸被改变, 空白型, , 
赋值 (.宽度, 相减 (_启动窗口.宽度, 9))
赋值 (.高度, 相减 (_启动窗口.高度, 67))

连续赋值 (.左边, .左边, .左边, .左边)
连续赋值 (.顶边, .顶边, .顶边, .顶边)

赋值 (.左边, 相减 (相加 (.左边, .宽度), 18))
赋值 (.高度, 相减 (.高度, 20))

赋值 (.顶边, 相减 (.高度, 18))
赋值 (.宽度, 相减 (相加 (.左边, .宽度), 20))

赋值 (.左边, 相减 (.左边, 1))
赋值 (.顶边, 相减 (.顶边, 1))

新图片号_.画图片 (0, 0, .宽度, .高度, )

.子程序 _横向滚动条_位置被改变, 空白型, , 
赋值 (.左边, 相减 (0, .位置))


.子程序 _纵向滚动条_位置被改变, 空白型, , 
赋值 (.顶边, 相减 (0, .位置))


.子程序 _合并图片_被选择, 空白型, , 
.如果真 (等于 (创建临时目录 (), 假))
    信息框 (“创建临时目录失败！”, 16, “错误信息”)
    返回 ()
.如果真结束
 ' *****************************************









 ' *****************************************
.如果真 (等于 (删除临时目录 (), 假))
    信息框 (“删除临时目录失败！”, 16, “错误信息”)
    返回 ()
.如果真结束


.子程序 创建临时目录, 逻辑型, , 
.如果真 (等于 (寻找文件 (相加 (取当前目录 (), “\tep”), #子目录), “”))
    .如果真 (等于 (创建目录 (相加 (取当前目录 (), “\tep”)), 假))
        返回 (假)
    .如果真结束
    
.如果真结束
返回 (真)

.子程序 删除临时目录, 逻辑型, , 
.如果真 (不等于 (寻找文件 (相加 (取当前目录 (), “\tep”), #子目录), “”))
    .如果真 (等于 (删除目录 (相加 (取当前目录 (), “\tep”)), 假))
        返回 (假)
    .如果真结束
    
.如果真结束
返回 (真)


.子程序 _打开_被选择, 空白型, , 
赋值 (工具盘窗口.可视, 假)
赋值 (调色板窗口.可视, 假)

赋值 (.初始目录, 取当前目录 ())
.如果真 (打开 ())
    赋值 (旧图片号_, 新图片号_)
    赋值 (新图片号_, 载入图片 (.文件名))
    赋值 (图片号, 新图片号_)
    赋值 (读入文件 (.文件名))
    赋值 (.可视, 真)
    
    赋值 (.左边, 0)
    赋值 (.顶边, 0)
    赋值 (.宽度, 新图片号_.取图片宽度 ())
    赋值 (.高度, 新图片号_.取图片高度 ())
    
    新图片号_.画图片 (0, 0, .宽度, .高度, )
    
    .如果 (大于 (.宽度, 默认宽度))
        赋值 (.禁止, 假)
        赋值 (.最大位置, 相减 (.宽度, 默认宽度))
    .否则
        赋值 (.禁止, 真)
    .如果结束
    
    .如果 (大于 (.高度, 默认高度))
        赋值 (.禁止, 假)
        赋值 (.最大位置, 相减 (.高度, 默认高度))
    .否则
        赋值 (.禁止, 真)
    .如果结束
    
    赋值 (刚刚打开_, 真)
    卸载图片 (旧图片号_)
.如果真结束

赋值 (工具盘窗口.可视, 真)
赋值 (调色板窗口.可视, 真)


.子程序 _画板1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (不等于 (新图片号_, 0))
    弹出菜单 ()
.如果真结束


.子程序 _放大图片_被选择, 空白型, , 
.如果真 (或者 (大于 (相乘 (.宽度, 1.2), 2500), 大于 (相乘 (.高度, 1.2), 2500)))
    信息框 (“已经放大到极限！”, 0, )
    返回 ()
.如果真结束

赋值 (.左边, 0)
赋值 (.顶边, 0)
赋值 (.宽度, 相乘 (.宽度, 1.2))
赋值 (.高度, 相乘 (.高度, 1.2))

新图片号_.画图片 (0, 0, .宽度, .高度, )

.如果 (大于 (.宽度, 默认宽度))
    赋值 (.禁止, 假)
    赋值 (.最大位置, 相减 (.宽度, 默认宽度))
.否则
    赋值 (.禁止, 真)
.如果结束

.如果 (大于 (.高度, 默认高度))
    赋值 (.禁止, 假)
    赋值 (.最大位置, 相减 (.高度, 默认高度))
.否则
    赋值 (.禁止, 真)
.如果结束


.子程序 _缩小图片_被选择, 空白型, , 
赋值 (.左边, 0)
赋值 (.顶边, 0)
赋值 (.宽度, 相乘 (.宽度, 0.8))
赋值 (.高度, 相乘 (.高度, 0.8))

新图片号_.画图片 (0, 0, .宽度, .高度, )

.如果 (大于 (.宽度, 默认宽度))
    赋值 (.禁止, 假)
    赋值 (.最大位置, 相减 (.宽度, 默认宽度))
.否则
    赋值 (.禁止, 真)
.如果结束

.如果 (大于 (.高度, 默认高度))
    赋值 (.禁止, 假)
    赋值 (.最大位置, 相减 (.高度, 默认高度))
.否则
    赋值 (.禁止, 真)
.如果结束


.子程序 _合适大小_被选择, 空白型, , 


.子程序 _实际大小_被选择, 空白型, , 
赋值 (.左边, 0)
赋值 (.顶边, 0)
赋值 (.宽度, 新图片号_.取图片宽度 ())
赋值 (.高度, 新图片号_.取图片高度 ())

新图片号_.画图片 (0, 0, .宽度, .高度, )

.如果 (大于 (.宽度, 默认宽度))
    赋值 (.禁止, 假)
    赋值 (.最大位置, 相减 (.宽度, 默认宽度))
.否则
    赋值 (.禁止, 真)
.如果结束

.如果 (大于 (.高度, 默认高度))
    赋值 (.禁止, 假)
    赋值 (.最大位置, 相减 (.高度, 默认高度))
.否则
    赋值 (.禁止, 真)
.如果结束


.子程序 _画板1_鼠标左键被按下2, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.鼠标指针, 到字节集 (8))
赋值 (原鼠标X标, 取鼠标水平位置 ())
赋值 (原鼠标Y标, 取鼠标垂直位置 ())

赋值 (刚刚打开_, 假)

.子程序 _画板1_鼠标左键被放开2, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.鼠标指针, 到字节集 (0))
赋值 (现鼠标X标, 取鼠标水平位置 ())
赋值 (现鼠标Y标, 取鼠标垂直位置 ())
.如果真 (等于 (刚刚打开_, 假))
    .如果真 (或者 (不等于 (原鼠标X标, 现鼠标X标), 不等于 (原鼠标Y标, 现鼠标Y标)))
        赋值 (.左边, 相减 (相加 (.左边, 现鼠标X标), 原鼠标X标))
        赋值 (.顶边, 相减 (相加 (.顶边, 现鼠标Y标), 原鼠标Y标))
        
        .清除 ()
        新图片号_.画图片 (0, 0, .宽度, .高度, )
    .如果真结束
    
.如果真结束


.子程序 _隐藏工具盘_被选择, 空白型, , 
.如果 (等于 (工具盘窗口.可视, 真))
    赋值 (工具盘窗口.可视, 假)
    赋值 (.标题, “显示工具盘”)
.否则
    赋值 (工具盘窗口.可视, 真)
    赋值 (.标题, “隐藏工具盘”)
    
.如果结束


.子程序 __启动窗口_可否被关闭, 逻辑型, , 
结束 ()

.子程序 _退出_被选择, 空白型, , 
结束 ()


.子程序 _图片框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (不等于 (图片号, 0))
    返回 ()
.如果真结束
_打开_被选择 ()

.子程序 _保存_被选择, 空白型, , 
.如果真 (等于 (图片号, 0))
    返回 ()
.如果真结束
赋值 (.初始目录, 取当前目录 ())
.如果真 (打开 ())
    写到文件 (.文件名, .取图片 ())
.如果真结束


.子程序 _打印设置_被选择, 空白型, , 
赋值 (工具盘窗口.可视, 假)
赋值 (调色板窗口.可视, 假)

.如果 (不等于 (图片号, 0))
    
.否则
    赋值 (.初始目录, 取当前目录 ())
    .如果真 (打开 ())
        .如果真 (等于 (删首尾空 (.文件名), “”))
            赋值 (工具盘窗口.可视, 真)
            赋值 (调色板窗口.可视, 真)
            返回 ()
        .如果真结束
        赋值 (图片号, 载入图片 (.文件名))
        图片号.画图片 (0, 0, , , )
        赋值 (内存图片, 读入文件 (.文件名))
        .如果真 (等于 (图片号, 0))
            赋值 (工具盘窗口.可视, 真)
            赋值 (调色板窗口.可视, 真)
            返回 ()
        .如果真结束
        
    .如果真结束
    
.如果结束

.如果真 (等于 (图片号, 0))
    赋值 (工具盘窗口.可视, 真)
    赋值 (调色板窗口.可视, 真)
    返回 ()
.如果真结束

赋值 (.可视, 真)
载入 (画板打印设置窗口, , 真)

赋值 (工具盘窗口.可视, 真)
赋值 (调色板窗口.可视, 真)


.子程序 _底片_被选择, 空白型, , 
.如果真 (等于 (图片号, 0))
    返回 ()
.如果真结束
.如果 (等于 (.标题, “底片”))
    赋值 (.图片, 读入文件 (.文件名))
    载入图片 (.图片).画图片 (0, 0, .宽度, .高度, 2)
    赋值 (.标题, “从底片恢复”)
.否则
    赋值 (.图片, 读入文件 (.文件名))
    载入图片 (.图片).画图片 (0, 0, .宽度, .高度, 1)
    赋值 (.标题, “底片”)
.如果结束


.子程序 _隐藏调色盘_被选择, 空白型, , 
.如果 (等于 (调色板窗口.可视, 真))
    赋值 (调色板窗口.可视, 假)
    赋值 (.标题, “显示调色盘”)
.否则
    赋值 (调色板窗口.可视, 真)
    赋值 (.标题, “隐藏调色盘”)
.如果结束


.子程序 _关闭_被选择, 空白型, , 
赋值 (图片号, 0)
赋值 (.图片, {  })
赋值 (.底图, {  })
赋值 (.可视, 假)


.子程序 _扫描图片_被选择, 空白型, , 
.局部变量 文件号, 整数型, , , 

.如果真 (等于 (文件是否存在 (相加 (取当前目录 (), “\Twack_32.exe”)), 假))
    赋值 (文件号, 打开文件 (“Twack_32.exe”, 4, 1))
    写出字节集 (文件号, #扫描程序)
    关闭文件 (文件号)
.如果真结束
运行 (“Twack_32.exe”, 假, )

.子程序 _画板1_绘画, 空白型, , 
.参数 重画区左边, 整数型, , 
.参数 重画区上边, 整数型, , 
.参数 重画区右边, 整数型, , 
.参数 重画区下边, 整数型, , 

.局部变量 容器1, 空白型, , , 

赋值 (.画出方式, 12)
.计次循环首 (取数组成员数 (), 容器1)
    未知函数_67174975 ( [容器1], 真)
.计次循环尾 ()


.子程序 _画板1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (真))
    未知函数_67174982 ()
    赋值 (., 横向位置)
    赋值 (., 纵向位置)
    未知函数_67174982 ()
.如果真结束


.子程序 _画板1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (工具盘窗口..选中, 真))
    赋值 (.鼠标指针, 到字节集 (8))
    赋值 (原鼠标X标, 取鼠标水平位置 ())
    赋值 (原鼠标Y标, 取鼠标垂直位置 ())
    
    赋值 (刚刚打开_, 假)
    
    返回 (真)
    
.如果真结束

赋值 (.画笔颜色, #白色)
赋值 (.画笔粗细, 未知函数_67174992 ())
赋值 (.刷子类型, 0)
赋值 (.画笔类型, 1)
赋值 (.自动重画, 假)

赋值 (., 未知函数_67174993 ())
赋值 (当前绘画.前景, 工具盘窗口..颜色)
赋值 (当前绘画.背景, 工具盘窗口..颜色)
赋值 (., 未知函数_67174992 ())
赋值 (., 未知函数_67174995 ())
连续赋值 (横向位置, ., .)
连续赋值 (纵向位置, ., .)

赋值 (.画出方式, 6)
未知函数_67174994 ()
赋值 (真)
未知函数_167838292 (取窗口句柄 ())


.子程序 _画板1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (工具盘窗口..选中, 真))
    赋值 (.鼠标指针, 到字节集 (0))
    赋值 (现鼠标X标, 取鼠标水平位置 ())
    赋值 (现鼠标Y标, 取鼠标垂直位置 ())
    .如果真 (等于 (刚刚打开_, 假))
        .如果真 (或者 (不等于 (原鼠标X标, 现鼠标X标), 不等于 (原鼠标Y标, 现鼠标Y标)))
            赋值 (.左边, 相减 (相加 (.左边, 现鼠标X标), 原鼠标X标))
            赋值 (.顶边, 相减 (相加 (.顶边, 现鼠标Y标), 原鼠标Y标))
            
            .清除 ()
            新图片号_.画图片 (0, 0, .宽度, .高度, )
        .如果真结束
        
    .如果真结束
    
    返回 (真)
.如果真结束

.如果真 (等于 (真))
    未知函数_67175102 ()
    未知函数_167838397 ()
    赋值 (假)
    加入成员 ()
    未知函数_67175103 (., ., ., .)
    相减 (., 6).部分重画 (相减 (., 6), 相加 (相减 (., .), 12), 相加 (相减 (., .), 12))
    刷新显示 ()
.如果真结束
赋值 (.自动重画, 真)


.子程序 规范矩形, 空白型, , 
.参数 左边, 空白型, 参考, 
.参数 上边, 空白型, 参考, 
.参数 右边, 空白型, 参考, 
.参数 下边, 空白型, 参考, 

.局部变量 容器1, 空白型, , , 

.如果真 (大于 (左边, 右边))
    赋值 (容器1, 左边)
    赋值 (左边, 右边)
    赋值 (右边, 容器1)
.如果真结束
.如果真 (大于 (上边, 下边))
    赋值 (容器1, 上边)
    赋值 (上边, 下边)
    赋值 (下边, 容器1)
.如果真结束


.子程序 绘画, 空白型, , 
.参数 数据, 未知类型0x4101028B, , 
.参数 是否设置画板, 逻辑型, 可空, 

.局部变量 左边, 空白型, , , 
.局部变量 上边, 空白型, , , 
.局部变量 右边, 空白型, , , 
.局部变量 下边, 空白型, , , 

.如果真 (等于 (是否为空 (是否设置画板), 假))
    赋值 (.画笔粗细, 数据.)
    赋值 (.刷子颜色, 数据.)
    赋值 (.刷子类型, 选择 (等于 (数据., 1), 0, 1))
    赋值 (.画笔颜色, 选择 (等于 (数据., 3), 数据., 数据.))
.如果真结束
赋值 (左边, 数据.)
赋值 (右边, 数据.)
赋值 (上边, 数据.)
赋值 (下边, 数据.)
.如果 (等于 (数据., 1))
    左边.画直线 (上边, 右边, 下边)
.否则
    未知函数_67175052 (左边, 上边, 右边, 下边)
    .判断开始 (等于 (数据., 2))
        左边.画椭圆 (上边, 右边, 下边)
    .判断 (等于 (数据., 3))
        左边.画矩形 (上边, 右边, 下边)
    .默认
        左边.画圆角矩形 (上边, 右边, 下边, 相除 (相减 (右边, 左边), 4), )
    .判断结束
    
.如果结束


.子程序 取画笔宽度, 整数型, , 
返回 (到数值 (工具盘窗口..内容))


.子程序 取填充类型, 整数型, , 
.判断开始 (等于 (工具盘窗口..选中, 真))
    返回 (2)
.判断 (等于 (工具盘窗口..选中, 真))
    返回 (3)
.默认
    返回 (1)
.判断结束


.子程序 取外形类型, 整数型, , 
.判断开始 (等于 (工具盘窗口..选中, 真))
    返回 (1)
.判断 (等于 (工具盘窗口..选中, 真))
    返回 (2)
.判断 (等于 (工具盘窗口..选中, 真))
    返回 (3)
.默认
    返回 (4)
.判断结束


.子程序 _新建_被选择, 空白型, , 
赋值 (.可视, 真)

.子程序 _关于_被选择, 空白型, , 
赋值 (工具盘窗口.可视, 假)
赋值 (调色板窗口.可视, 假)
信息框 (相加 (“本程序由易语言生成.”, #换行符, “易语言书架出品!”), 0, )
赋值 (工具盘窗口.可视, 真)
赋值 (调色板窗口.可视, 真)

.子程序 _帮助内容_被选择, 空白型, , 
赋值 (工具盘窗口.可视, 假)
赋值 (调色板窗口.可视, 假)
信息框 (相加 (“可以双击窗口中间打开新图片,”, #换行符, “可以保存图片到文件,”, #换行符, “可以底片显示图片,以及恢复.”, #换行符, “可以打印图片,所见即所得;”, #换行符, “可以显示与隐藏工具条.”, #换行符, “还可以画线,画圆,以及画方.”, #换行符, “可以扫描照片,”), 0, )
赋值 (工具盘窗口.可视, 真)
赋值 (调色板窗口.可视, 真)


.子程序 _显示工具盘_被选择, 空白型, , 
.如果 (等于 (工具盘窗口.可视, 真))
    赋值 (工具盘窗口.可视, 假)
.否则
    赋值 (工具盘窗口.可视, 真)
.如果结束


.窗口程序集 工具盘窗口程序集, , , 

.子程序 _工具盘窗口_创建完毕, 空白型, , 
工具盘窗口.调整层次 (#顶层)
工具盘窗口.宽度 ＝ 50

.子程序 _按钮2_被单击, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 真)
赋值 (.选中, 假)

_启动窗口._缩小图片_被选择 ()


.子程序 _按钮1_被单击, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 真)

_启动窗口._放大图片_被选择 ()

.子程序 _图形按钮1_被单击, 空白型, , 
.如果 (等于 (.标记, “6”))
    赋值 (.标记, “7”)
    赋值 (.正常图片, #LOGO7)
.否则
    赋值 (.标记, “6”)
    赋值 (.正常图片, #LOGO6)
    
.如果结束


.子程序 _标签2_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

工具盘窗口.投递信息 (161, 2, 0)

.子程序 _直线单选框_被单击, 空白型, , 
赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)

赋值 (.时钟周期, 0)


.子程序 _圆单选框_被单击, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)

赋值 (.时钟周期, 0)


.子程序 _矩形单选框_被单击, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)

赋值 (.时钟周期, 0)


.子程序 _圆角矩形单选_被单击, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)

赋值 (.时钟周期, 0)


.子程序 _矩形单选框1_被单击, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.时钟周期, 0)


.子程序 _圆角矩形单选1_被单击, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)

赋值 (.时钟周期, 50)


.子程序 _编辑框1_内容被改变, 空白型, , 
赋值 (.高度, 到数值 (.内容))

.子程序 _填充单选框1_被单击, 空白型, , 
赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)



.子程序 _填充单选框2_被单击, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 真)
赋值 (.选中, 假)


.子程序 _填充单选框3_被单击, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 真)


.子程序 _时钟1_周期事件, 空白型, , 
标签1.标题 ＝ “颜色值：” ＋ 到文本 (取颜色 (取设备场景句柄 (0), 取鼠标水平位置 (), 取鼠标垂直位置 ()))
赋值 (.颜色, 取颜色 (取设备场景句柄 (0), 取鼠标水平位置 (), 取鼠标垂直位置 ()))

.窗口程序集 打印窗口程序集, , , 

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _选择框1_被单击, 空白型, , 


.子程序 _画板左下_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

161.投递信息 (2, 0)


.子程序 _画板左_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

161.投递信息 (2, 0)

.子程序 _画板右_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

161.投递信息 (2, 0)

.子程序 _画板上_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

161.投递信息 (2, 0)

.子程序 _画板左上_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

161.投递信息 (2, 0)

.子程序 _画板右上_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

161.投递信息 (2, 0)

.子程序 _画板下_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

161.投递信息 (2, 0)

.子程序 _画板右下_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

161.投递信息 (2, 0)

.子程序 _画板右下_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

#底层.调整层次 ()

.如果真 (小于 (.左边, .左边))
    返回 (假)
.如果真结束
.如果真 (大于 (.顶边, .顶边))
    返回 (假)
.如果真结束

赋值 (.高度, 相加 (相减 (.顶边, .顶边), 4))
赋值 (.宽度, 相加 (相减 (.左边, .左边), 4))

根据图片大小确定夹点 ()
写比例 ()

.子程序 _画板左上_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (大于 (.顶边, .顶边))
    返回 (假)
.如果真结束
.如果真 (小于 (.左边, .左边))
    返回 (假)
.如果真结束

赋值 (.左边, .左边)
赋值 (.顶边, .顶边)

赋值 (.顶边, 相加 (.顶边, 2))
赋值 (.左边, 相加 (.左边, 2))
赋值 (.高度, 相加 (相减 (.顶边, .顶边), 4))
赋值 (.宽度, 相加 (相减 (.左边, .左边), 4))

根据图片大小确定夹点 ()
写比例 ()

.子程序 _画板右上_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (小于 (.左边, .左边))
    返回 (假)
.如果真结束
.如果真 (大于 (.顶边, .顶边))
    返回 (假)
.如果真结束

赋值 (.左边, .左边)
赋值 (.顶边, 相加 (.顶边, 2))
赋值 (.高度, 相加 (相减 (.顶边, .顶边), 4))
赋值 (.宽度, 相加 (相减 (.左边, .左边), 4))

根据图片大小确定夹点 ()
写比例 ()

.子程序 _画板左下_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (小于 (.左边, .左边))
    返回 (假)
.如果真结束
.如果真 (大于 (.顶边, .顶边))
    返回 (假)
.如果真结束

赋值 (.顶边, 相加 (.顶边, 2))
赋值 (.左边, 相加 (.左边, 2))
赋值 (.高度, 相加 (相减 (.顶边, .顶边), 4))
赋值 (.宽度, 相加 (相减 (.左边, .左边), 4))

根据图片大小确定夹点 ()
写比例 ()

.子程序 _画板右_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (小于 (.左边, .左边))
    返回 (假)
.如果真结束

赋值 (.宽度, 相加 (相减 (.左边, .左边), 4))

根据图片大小确定夹点 ()
写比例 ()

.子程序 _画板左_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (小于 (.左边, .左边))
    返回 (假)
.如果真结束

赋值 (.左边, 相加 (.左边, 2))
赋值 (.宽度, 相加 (相减 (.左边, .左边), 4))

根据图片大小确定夹点 ()
写比例 ()

.子程序 _画板中央_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

#底层.调整层次 ()
根据图片大小确定夹点 ()
写比例 ()

.子程序 _图片框1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

#底层.调整层次 ()
根据图片大小确定夹点 ()
写比例 ()

.子程序 _画板下_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (大于 (.顶边, .顶边))
    返回 (假)
.如果真结束

赋值 (.顶边, 相加 (.顶边, 2))
赋值 (.高度, 相加 (相减 (.顶边, .顶边), 4))

根据图片大小确定夹点 ()
写比例 ()

.子程序 _画板上_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (大于 (.顶边, .顶边))
    返回 (假)
.如果真结束

赋值 (.顶边, 相加 (.顶边, 2))
赋值 (.高度, 相加 (相减 (.顶边, .顶边), 4))
赋值 (.宽度, 相加 (相减 (.左边, .左边), 4))
根据图片大小确定夹点 ()
写比例 ()

.子程序 _画板打印设置窗口_创建完毕, 空白型, , 
画板1.复制 (0, 0, 打印画板窗口.画板1.画板宽度, 画板1.画板高度, 画板1, 0, 0, )
 ' 把画板1中的指定矩形区域（左上角坐标为(0,0)、宽高分别是画板2的宽高）复制到画板2的(0，0)处。
赋值 (图片号, 载入图片 (内存图片)) ' “载入图片”是系统库函数之一（见工作夹“支持库”子夹中中“其它”类），载入指定图片，以供画板、打印机等控件的“画图片”、“取图片宽度”、“取图片高度”之类“方法”使用。如成功则返回被载入图片的图片号，失败返回 0。“载入图片”的参数也可以是图片文件名（全路径及扩展名，如：“载入图片("d:\图片.gif")”）。

编辑框高度.内容 ＝ 到文本 (四舍五入 (画板1.取图片高度 (图片号) × 0.01, 2))
编辑框宽度.内容 ＝ 到文本 (四舍五入 (画板1.取图片宽度 (图片号) × 0.01, 2))
赋值 (.内容, 到文本 (四舍五入 (相乘 (图片号.取图片高度 (), 0.01), 2)))
赋值 (.内容, 到文本 (四舍五入 (相乘 (图片号.取图片宽度 (), 0.01), 2)))
到文本 (画板1.取图片宽度 (图片号))
赋值 (.左边, 2)
赋值 (.顶边, 2)
.如果 (并且 (小于 (到数值 (.内容), 20), 小于 (到数值 (.内容), 27.6)))
    赋值 (.高度, 相乘 (相除 (图片号.取图片高度 (), 27.6), .高度, 0.01))
    赋值 (.宽度, 相乘 (相除 (图片号.取图片宽度 (), 20), .宽度, 0.01))
    赋值 (.内容, 到文本 (四舍五入 (相乘 (相除 (.高度, .高度), 27.6), 2)))
    赋值 (.内容, 到文本 (四舍五入 (相乘 (相除 (.宽度, .宽度), 20), 2)))
    
.否则
    赋值 (.高度, 相乘 (相除 (图片号.取图片高度 (), 27.6), .高度, 0.01))
    赋值 (.宽度, 相乘 (相除 (图片号.取图片宽度 (), 20), .宽度, 0.01))
    赋值 (.内容, 到文本 (四舍五入 (相乘 (相除 (.高度, .高度), 27.6), 2)))
    赋值 (.内容, 到文本 (四舍五入 (相乘 (相除 (.宽度, .宽度), 20), 2)))
    
.如果结束
根据图片大小确定夹点 ()

赋值 (比例宽, .宽度)
赋值 (比例高, .高度)
写比例 ()


赋值 (.图片, 读入文件 (_启动窗口..文件名))
图片号.画图片 (0, 0, .宽度, .高度, )

赋值 (.标题, “纸宽 = 210 毫米”)
赋值 (.标题, “纸高 = 297 毫米”)
赋值 (.标题, 相加 (“图宽 = ”, 到文本 (相乘 (图片号.取图片宽度 (), 0.1))))
赋值 (.标题, 相加 (“图高 = ”, 到文本 (相乘 (图片号.取图片高度 (), 0.1))))

赋值 (.标记, .内容)
赋值 (.标记, .内容)
赋值 (.标记, .内容)
赋值 (.标记, .内容)


.子程序 _按钮1_被单击, 空白型, , 
真.开始打印 (真, , )
图片号.画图片 (相乘 (到数值 (.内容), 100), 相乘 (到数值 (.内容), 100), 相乘 (到数值 (.内容), 100), 相乘 (到数值 (.内容), 100), )
打印机1.画图片 (图片号, 1, 1, 画板1.取图片宽度 (图片号), 画板1.取图片高度 (图片号), )
结束打印 ()


.子程序 写比例, 空白型, , 
赋值 (.内容, 到文本 (四舍五入 (相乘 (相除 (.高度, .高度), 27.6), 2)))
赋值 (.内容, 到文本 (四舍五入 (相乘 (相除 (.宽度, .宽度), 20), 2)))
赋值 (.内容, 到文本 (四舍五入 (相乘 (相除 (.顶边, .高度), 27.6), 2))) ' 到文本 (四舍五入 (画板中央.高度 ÷ 图片框1.高度 × 27.6, 2))
赋值 (.内容, 到文本 (四舍五入 (相乘 (相除 (.左边, .宽度), 20), 2))) '  到文本 (四舍五入 (画板中央.宽度 ÷ 图片框1.宽度 × 20, 2))
????????????????????????
.如果真 (等于 (0))
    信息框 (“比例宽有问题!”, 0, )
    赋值 (100)
.如果真结束
.如果真 (等于 (0))
    信息框 (“比例高有问题!”, 0, )
    赋值 (100)
.如果真结束
.如果真 (等于 (.宽度, 0))
    信息框 (“画板中央.宽度”, 0, )
    赋值 (.宽度, 1)
.如果真结束
.如果真 (等于 (.高度, 0))
    信息框 (“画板中央.高度”, 0, )
    赋值 (.高度, 1)
.如果真结束

赋值 (.内容, 相加 (“宽:”, 到文本 (四舍五入 (相乘 (相除 (.宽度, 比例宽), 100), 2)), “%”, “    高:”, 到文本 (四舍五入 (相乘 (相除 (.高度, 比例高), 100), 2)), “%”))



.子程序 _按钮3_被单击, 空白型, , 
信息框 (“载入图片,保存图片,打印图片,在打印图片中,可以动态调节图片的大小,看到比例尺,所见即所得.”, 0, )

.子程序 _编辑框缩放_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 可以, 逻辑型, , , 

.如果真 (等于 (键代码, #回车键))
    .如果 (大于 (到数值 (.内容), 1))
        
    .否则
        信息框 (“输入的不是数值.”, 0, )
        返回 (假)
    .如果结束
    
    .如果 (大于 (四舍五入 (相乘 (相除 (.宽度, 比例宽), 100), 2), 四舍五入 (相乘 (相除 (.高度, 比例高), 100), 2)))
        赋值 (.标记, 到文本 (四舍五入 (相乘 (相除 (.宽度, 比例宽), 100), 2)))
    .否则
        赋值 (.标记, 到文本 (四舍五入 (相乘 (相除 (.高度, 比例高), 100), 2)))
    .如果结束
    
    赋值 (可以, 假)
    
    .如果 (大于 (到数值 (.内容), 到数值 (.标记)))
        .如果 (等于 (信息框 (相加 (“最好介于数值”, .标记, “之间.”, #换行符, “是否确认强制执行?”), #是否钮, “请确认”), #是钮))
            赋值 (可以, 真)
        .否则
            返回 (假)
        .如果结束
        
    .否则
        赋值 (可以, 真)
    .如果结束
    
    .如果真 (等于 (可以, 真))
        赋值 (.高度, 相乘 (到数值 (.内容), 0.01, 比例高))
        赋值 (.宽度, 相乘 (到数值 (.内容), 0.01, 比例宽))
        赋值 (.内容, 到文本 (四舍五入 (相乘 (相除 (.高度, .高度), 27.6), 2)))
        赋值 (.内容, 到文本 (四舍五入 (相乘 (相除 (.宽度, .宽度), 20), 2)))
        赋值 (.内容, 相加 (“宽:”, 到文本 (四舍五入 (相乘 (相除 (.宽度, 比例宽), 100), 2)), “%”, “    高:”, 到文本 (四舍五入 (相乘 (相除 (.高度, 比例高), 100), 2)), “%”))
        
        根据图片大小确定夹点 ()
        写比例 ()
    .如果真结束
    
.如果真结束


.子程序 _画板中央_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (不等于 (.标记, “0”)) ' 如果图片居中被选择为真,#四向箭头型,那么不能随意移动样图了.
    161.投递信息 (2, 0)
    根据图片大小确定夹点 ()
    #底层.调整层次 ()
    写比例 ()
.如果真结束


.子程序 根据图片大小确定夹点, 空白型, , 
相减 (.左边, 2).移动 (相减 (.顶边, 2), , )
相减 (相加 (相除 (.宽度, 2), .左边), 1).移动 (相减 (.顶边, 2), , )
相减 (相加 (.左边, .宽度), 4).移动 (相减 (.顶边, 2), , )
相减 (.左边, 2).移动 (相减 (相加 (相除 (.高度, 2), .顶边), 2, 1), , )
相减 (相加 (.左边, .宽度), 4).移动 (相减 (相加 (相除 (.高度, 2), .顶边), 2, 1), , )
相减 (.左边, 2).移动 (相减 (相加 (.高度, .顶边), 4), , )
相减 (相加 (相除 (.宽度, 2), .左边), 2, 1).移动 (相减 (相加 (.高度, .顶边), 4), , )
相减 (相加 (.左边, .宽度), 4).移动 (相减 (相加 (.高度, .顶边), 4), , )

返回 ()


.子程序 _编辑框顶_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (#回车键))
    赋值 (.标记, .内容)
    赋值 (.标记, .内容)
    赋值 (.标记, .内容)
    赋值 (.标记, .内容)
    处理输入框 ()
    误差处理 ()
.如果真结束


.子程序 _编辑框左_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (#回车键))
    赋值 (.标记, .内容)
    赋值 (.标记, .内容)
    赋值 (.标记, .内容)
    赋值 (.标记, .内容)
    处理输入框 ()
    误差处理 ()
.如果真结束


.子程序 _编辑框高度_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (#回车键))
    赋值 (.标记, .内容)
    赋值 (.标记, .内容)
    赋值 (.标记, .内容)
    赋值 (.标记, .内容)
    处理输入框 ()
    误差处理 ()
.如果真结束


.子程序 _编辑框宽度_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (#回车键))
    赋值 (.标记, .内容)
    赋值 (.标记, .内容)
    赋值 (.标记, .内容)
    赋值 (.标记, .内容)
    处理输入框 ()
    误差处理 ()
.如果真结束


.子程序 处理输入框, 空白型, , 
赋值 (.左边, 相乘 (相除 (到数值 (.内容), 20), .宽度))
赋值 (.顶边, 相乘 (相除 (到数值 (.内容), 27.6), .高度))
赋值 (.宽度, 相乘 (相除 (到数值 (.内容), 20), .宽度))
赋值 (.高度, 相乘 (相除 (到数值 (.内容), 27.6), .高度))

赋值 (.内容, 到文本 (四舍五入 (相乘 (相除 (.高度, .高度), 27.6), 2)))
赋值 (.内容, 到文本 (四舍五入 (相乘 (相除 (.宽度, .宽度), 20), 2)))
赋值 (.内容, 相加 (“宽:”, 到文本 (四舍五入 (相乘 (相除 (.宽度, 比例宽), 100), 2)), “%”, “    高:”, 到文本 (四舍五入 (相乘 (相除 (.高度, 比例高), 100), 2)), “%”))

根据图片大小确定夹点 ()
写比例 ()


.子程序 误差处理, 空白型, , 
.如果真 (小于 (相减 (到数值 (.标记), 到数值 (.内容)), 0.5))
    赋值 (.内容, .标记)
.如果真结束
.如果真 (小于 (相减 (到数值 (.标记), 到数值 (.内容)), 0.5))
    赋值 (.内容, .标记)
.如果真结束
.如果真 (小于 (相减 (到数值 (.标记), 到数值 (.内容)), 0.5))
    赋值 (.内容, .标记)
.如果真结束
.如果真 (小于 (相减 (到数值 (.标记), 到数值 (.内容)), 0.5))
    赋值 (.内容, .标记)
.如果真结束


.子程序 _单选框1_被单击, 空白型, , 
.如果真 (等于 (.选中, 真))
    赋值 (.可视, 真)
    赋值 (.可视, 假)
    赋值 (.标题, “纸宽 = 210 毫米”)
    赋值 (.标题, “纸高 = 297 毫米”)
    赋值 (.标题, 相加 (“图宽 = ”, 到文本 (相乘 (图片号.取图片宽度 (), 0.1))))
    赋值 (.标题, 相加 (“图高 = ”, 到文本 (相乘 (图片号.取图片高度 (), 0.1))))
    
.如果真结束

.如果真 (等于 (.选中, 真))
    赋值 (.可视, 假)
    赋值 (.可视, 真)
    赋值 (.标题, “纸宽 = 297 毫米”)
    赋值 (.标题, “纸高 = 210 毫米”)
    赋值 (.标题, 相加 (“图宽 = ”, 到文本 (相乘 (图片号.取图片宽度 (), 0.1))))
    赋值 (.标题, 相加 (“图高 = ”, 到文本 (相乘 (图片号.取图片高度 (), 0.1))))
.如果真结束


.子程序 _单选框2_被单击, 空白型, , 
.如果真 (等于 (.选中, 真))
    赋值 (.可视, 真)
    赋值 (.可视, 假)
    赋值 (.标题, “纸宽 = 210 毫米”)
    赋值 (.标题, “纸高 = 297 毫米”)
    赋值 (.标题, 相加 (“图宽 = ”, 到文本 (相乘 (图片号.取图片宽度 (), 0.1))))
    赋值 (.标题, 相加 (“图高 = ”, 到文本 (相乘 (图片号.取图片高度 (), 0.1))))
    
.如果真结束

.如果真 (等于 (.选中, 真))
    赋值 (.可视, 假)
    赋值 (.可视, 真)
    赋值 (.标题, “纸宽 = 297 毫米”)
    赋值 (.标题, “纸高 = 210 毫米”)
    赋值 (.标题, 相加 (“图宽 = ”, 到文本 (相乘 (图片号.取图片宽度 (), 0.1))))
    赋值 (.标题, 相加 (“图高 = ”, 到文本 (相乘 (图片号.取图片高度 (), 0.1))))
.如果真结束


.子程序 _选择框3_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.标记, “0”)
.否则
    赋值 (.标记, “8”)
.如果结束

.如果真 (等于 (.选中, 真))
    .移动 ()
    
    
    
    
.如果真结束



 ' 不属于任何一个程序集、类模块的函数：
