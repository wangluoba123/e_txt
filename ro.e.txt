 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 500
    高度 = 500
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 2
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\ro.e\_启动窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “牛刀小试RO”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 302
    高度 = 363
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\ro.e\窗口1_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' flash.npk {D27CDB6E-AE6D-11cf-96B8-444553540000}##0 1 0 FLASH动画支持库 1,{D27CDB6E-AE6D-11CF-96B8-444553540000},ShockwaveFlash,{109,118,119,112,113,114,115,116,126,127,128,129,130,131,132,142,143,144,145,146,147,148,151,152,153,154,155,156,157,158,172,191,193,198,199,200,191,},{196,195,194,192,190,171,170,159,141,140,139,138,137,136,135,134,133,107,102,106,123,121,120,105,125,124,-525,},{-609,1958,150,197,}0,{1171A62F-05D2-11D1-83FC-00A0C9089C5A},FlashProp,{},{},{}0,{D27CDB70-AE6D-11CF-96B8-444553540000},IFlashFactory,{},{},{}0,{A6EF9860-C720-11D0-9337-00A0C90DCAA9},IDispatchEx,{1610743808,1610743809,1610743810,1610743811,1610743812,1610743813,1610743814,1610743815,},{},{}0,{6D5140C1-7436-11CE-8034-00AA006009FA},IServiceProvider,{1610678272,},{},{}0,{D27CDB71-AE6D-11CF-96B8-444553540000},FlashObjectInterface,{},{},{}
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库
 ' mysql 7F54B9CE8887428dBA9CEEB94CEF4C72 2 1 MySql支持库
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 1 1 多线程支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二




.全局变量 配置信息, 文本型, , "5", 

.窗口程序集 窗口程序集1, , , 

.程序集变量 端口状态, 逻辑型, , , 
.程序集变量 图片1, 字节集, , , 
.程序集变量 图片2, 字节集, , , 
.程序集变量 图片3, 字节集, , , 
.程序集变量 图片4, 字节集, , , 
.程序集变量 许可证号, 整数型, , , 
.程序集变量 文件号, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
0.未知支持库函数_15 (相加 (取运行目录 (), “\index\1.swf”))
赋值 (.时钟周期, 10000)
赋值 (图片1, 读入文件 (相加 (取运行目录 (), “\index\1.jpg”)))
赋值 (图片2, 读入文件 (相加 (取运行目录 (), “\index\2.jpg”)))
赋值 (图片3, 读入文件 (相加 (取运行目录 (), “\index\3.jpg”)))
赋值 (许可证号, 未知支持库函数_1 ())
图片显示 ()
赋值 (图片4, 图片1)
.如果 (等于 (读配置项 (), 真))
    未知支持库函数_0 (&_时钟1_周期事件, )
    未知支持库函数_0 (&主机信息, )
    
.否则
    信息框 (“无法读取配置文件”, 0, )
.如果结束




.子程序 在线人数, 空白型, , 
.局部变量 句柄, 整数型, , , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 人数, 文本型, , , 


赋值 (句柄, 未知支持库函数_1 (配置信息 [1], 配置信息 [2], 配置信息 [3], 配置信息 [4], ))
.如果 (不等于 (句柄, 0))
    .如果真 (未知支持库函数_3 (句柄, “select * from sstatus”))
        赋值 (记录集句柄, 未知支持库函数_4 (句柄))
        .如果 (不等于 (记录集句柄, 0))
            未知支持库函数_6 (记录集句柄, 2, 人数)
            赋值 (.内容, 人数)
            未知支持库函数_5 (记录集句柄)
            未知支持库函数_2 (句柄)
            
        .否则
            
        .如果结束
        
    .如果真结束
    
    
    
.否则
    
.如果结束


.子程序 主机信息, 空白型, , 
赋值 (端口状态, 未知支持库函数_54 (到数值 (配置信息 [5]), 配置信息 [1]))
.如果 (等于 (端口状态, 真))
    赋值 (.填充颜色, #绿色)
.否则
    赋值 (.填充颜色, #红色)
.如果结束
在线人数 ()


.子程序 图片显示, 空白型, , 
赋值 (.图片, 图片4)
.如果 (等于 (图片4, 图片1))
    赋值 (图片4, 图片2)
    
.否则
    .如果 (等于 (图片4, 图片2))
        赋值 (图片4, 图片3)
        
    .否则
        .如果 (等于 (图片4, 图片3))
            赋值 (图片4, 图片1)
            
        .否则
            
        .如果结束
        
    .如果结束
    
.如果结束






.子程序 _时钟1_周期事件, 空白型, , 
图片显示 ()


.子程序 __启动窗口_将被销毁, 空白型, , 
未知支持库函数_2 (许可证号)


.子程序 _超级按钮1_被单击, 空白型, , 
运行 (相加 (取运行目录 (), “\仙境传说.exe”), 假, )
赋值 (_启动窗口., 2)







.子程序 _超级按钮2_被单击, 空白型, , 
载入 (窗口1, , 真)




.子程序 _超级按钮3_被单击, 空白型, , 
销毁 ()


.子程序 读配置项, 逻辑型, , 
.局部变量 文本信息, 文本型, , , 

赋值 (文件号, 打开加密文件 (相加 (取运行目录 (), “\system.txt”), 1, , “love400”, ))
赋值 (文本信息, 读入文本 (文件号, ))
赋值 (配置信息, 分割文本 (文本信息, “|”, ))
.如果 (不等于 (取数组成员数 (配置信息), 0))
    返回 (真)
.否则
    返回 (假)
.如果结束


.窗口程序集 窗口程序集2, , , 

.程序集变量 句柄, 整数型, , , 
.程序集变量 时间, 文本型, , , 
.程序集变量 用户名, 文本型, , , 
.程序集变量 密码, 文本型, , , 
.程序集变量 性别, 文本型, , , 
.程序集变量 电子信箱, 文本型, , , 
.程序集变量 真实姓名, 文本型, , , 
.程序集变量 日期, 日期时间型, , , 
.程序集变量 ip, 文本型, , , 
.程序集变量 许可证号, 整数型, , , 
.子程序 _超级按钮3_被单击, 空白型, , 
销毁 ()
未知支持库函数_2 (句柄)
未知支持库函数_2 (许可证号)


.子程序 注册, 空白型, , 
.局部变量 子记录集句柄, 整数型, , , 
.局部变量 字段名, 文本型, , , 

.如果 (不等于 (句柄, 0))
    赋值 (ip, 转换为IP地址 (取主机名 ()))
    赋值 (日期, 取现行时间 ())
    赋值 (时间, 相加 (到文本 (取年份 (日期)), “－”, 到文本 (取月份 (日期)), “－”, 到文本 (取日 (日期)), 到文本 (取小时 (日期)), “：”, 到文本 (取分钟 (日期)), “：”, 到文本 (取秒 (日期))))
    .如果 (不等于 (.内容, “”))
        赋值 (用户名, 删全部空 (.内容))
        
    .否则
        信息框 (“用户名不能为空，请输入用户名”, 0, )
        赋值 (.内容, “”)
        
    .如果结束
    .如果 (等于 (.内容, .内容))
        赋值 (密码, .内容)
    .否则
        信息框 (“两次密码输入不相同，请重新输入”, 0, )
        赋值 (.内容, “”)
        赋值 (.内容, “”)
    .如果结束
    .如果 (等于 (.选中, 真))
        赋值 (性别, “M”)
    .否则
        .如果 (等于 (.选中, 真))
            赋值 (性别, “F”)
        .否则
            信息框 (“请选择性别”, 0, )
            
            
        .如果结束
        .如果 (不等于 (.内容, “”))
            赋值 (电子信箱, .内容)
        .否则
            信息框 (“请输入电子邮件地址”, 0, )
        .如果结束
        .如果 (等于 (未知支持库函数_3 (句柄, 相加 (“select * from login where userid ='”, 用户名, “'”)), 真))
            赋值 (子记录集句柄, 未知支持库函数_4 (句柄))
            未知支持库函数_6 (子记录集句柄, 1, 字段名)
            .如果 (等于 (字段名, 用户名))
                信息框 (“用户名已经存在，请重新输入”, 0, )
                
            .否则
                .如果 (等于 (未知支持库函数_3 (句柄, 相加 (“insert into login set userid='”, 用户名, “',user_pass='”, 密码, “',sex='”, 性别, “',email='”, 电子信箱, “',last_ip='”, ip, “'”)), 真))
                    信息框 (“注册成功，现在你可以登陆游戏了”, 0, )
                    赋值 (.内容, “”)
                    赋值 (.内容, “”)
                    赋值 (.内容, “”)
                    赋值 (.内容, “”)
                    赋值 (.内容, “”)
                    
                    
                    
                .否则
                    信息框 (“注册执行失败”, 0, )
                .如果结束
                
            .如果结束
            
        .否则
            信息框 (“查找执行失败”, 0, )
        .如果结束
        
        
    .如果结束
    .如果 (不等于 (.内容, “”))
        赋值 (电子信箱, .内容)
    .否则
        信息框 (“请输入电子邮件地址”, 0, )
    .如果结束
    .如果 (等于 (未知支持库函数_3 (句柄, 相加 (“select * from login where userid ='”, 用户名, “'”)), 真))
        赋值 (子记录集句柄, 未知支持库函数_4 (句柄))
        未知支持库函数_6 (子记录集句柄, 1, 字段名)
        .如果 (等于 (字段名, 用户名))
            信息框 (“用户名已经存在，请重新输入”, 0, )
            
        .否则
            .如果 (等于 (未知支持库函数_3 (句柄, 相加 (“insert into login set userid='”, 用户名, “',user_pass='”, 密码, “',sex='”, 性别, “',email='”, 电子信箱, “',last_ip='”, ip, “'”)), 真))
                信息框 (“注册成功，现在你可以登陆游戏了”, 0, )
                赋值 (.内容, “”)
                赋值 (.内容, “”)
                赋值 (.内容, “”)
                赋值 (.内容, “”)
                赋值 (.内容, “”)
            .否则
                信息框 (“注册失败”, 0, )
            .如果结束
            
        .如果结束
        
    .否则
        信息框 (“查询失败”, 0, )
    .如果结束
    
    
.否则
    信息框 (“句柄获得失败”, 0, )
.如果结束



.子程序 _超级按钮1_被单击, 空白型, , 
未知支持库函数_0 (&注册, )


.子程序 _超级按钮2_被单击, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)


.子程序 _窗口1_创建完毕, 空白型, , 
赋值 (许可证号, 未知支持库函数_1 ())
未知支持库函数_0 (&数据库连接, )



.子程序 数据库连接, 空白型, , 
赋值 (句柄, 未知支持库函数_1 (配置信息 [1], 配置信息 [2], 配置信息 [3], 配置信息 [4], ))



 ' 不属于任何一个程序集、类模块的函数：
