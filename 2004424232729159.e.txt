 ' 文件类型：Windows窗口程序

 ' 程序名称：MySql数据库例程
 ' 程序描述：本程序用作演示MySql数据库的使用方法。
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 493
    高度 = 475
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “易语言帮助文档 - MySql数据库例程”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 1 扩展界面支持库一
 ' mysql 7F54B9CE8887428dBA9CEEB94CEF4C72 1 1 MySql支持库





.窗口程序集 窗口程序集1, , , 

.程序集变量 句柄, 整数型, , , 
.程序集变量 记录集句柄, 整数型, , , 
.程序集变量 table, 文本型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.如果真 (等于 (未知支持库函数_0 (“c:\mysql\”), 真))
    “设置MySql数据库路径正确！”.加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.如果真结束
赋值 (table, “test”)


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 name, 文本型, , , 
.局部变量 number, 文本型, , , 
.局部变量 索引, 整数型, , , 

.如果 (等于 (句柄, 0))
    “正在连接MySql数据库文件，请稍候。。。”.加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
    赋值 (句柄, 未知支持库函数_1 (“”, “root”, “”, “test”, 0))
    .如果真 (不等于 (句柄, 0))
        相加 (“MySql数据库连接成功，数据库句柄为：”, 到文本 (句柄)).加入项目 ()
        赋值 (.现行选中项, 相减 (取项目数 (), 1))
        未知支持库函数_3 (句柄, 相加 (“select * from ”, table))
        赋值 (记录集句柄, 未知支持库函数_4 (句柄))
        填充列表 ()
        赋值 (.禁止, 假)
          深蓝I 16:41:23  服务端听口：17955  》》外网服务器  客户.连接("0.0.0.0."17955)  地址=服务器.取回可户（）  把地址存入sql     其他可户就可以通过， 取来的ip和端口连接了！
    .如果真结束
    
.否则
    “数据库已经打开！”.加入项目 ()
    赋值 (.现行选中项, 相加 (取项目数 (), 1))
.如果结束


.子程序 填充列表, 空白型, , 
.局部变量 字段数, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 行, 整数型, , , 
.局部变量 wd, 文本型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 日期变量, 日期时间型, , , 
.局部变量 单精度变量, 小数型, , , 
.局部变量 双精度变量, 双精度小数型, , , 
.局部变量 逻辑变量, 逻辑型, , , 
.局部变量 货币变量, 双精度小数型, , , 
.局部变量 整型变量, 空白型, , , 
.局部变量 值, 文本型, , , 
.局部变量 字段名, 文本型, , , 

未知支持库函数_12 (记录集句柄)
赋值 (字段数, 未知支持库函数_14 (记录集句柄))
赋值 (记录数, 未知支持库函数_7 (记录集句柄))
赋值 (.标题, 相加 (“当前表有”, 到文本 (字段数), “个字段,”, 到文本 (记录数), “条记录”))
.计次循环首 (取列数 (), i)
    0.删除列 ()
.计次循环尾 ()
全部删除 ()
组合框3.清空 ()
组合框1.清空 ()
.计次循环首 ()
    未知支持库函数_15 (记录集句柄, 相减 (i, 1), wd)
    .插入列 (wd, 80, , , )
    组合框1.加入项目 (记录集1.取字段名 (i － 1), )
    合框3.加入项目 (记录集1.取字段名 (i － 1), )
.计次循环尾 ()
组合框1.现行选中项 ＝ 0
组合框3.现行选中项 ＝ 0
.计次循环首 (记录数, 行)
    .计次循环首 ()
        未知支持库函数_15 (记录集句柄, 相减 (列, 1), 字段名)
        未知支持库函数_6 (记录集句柄, 字段名, 文本变量)
        赋值 (值, 文本变量)
        .如果 (等于 (列, 1))
            .插入表项 (值, , , , )
            
        .否则
            相减 (行, 1).置标题 (相减 (列, 1), 值)
        .如果结束
        
    .计次循环尾 ()
    处理事件 ()
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()



.子程序 _按钮3_被单击, 空白型, , 
.局部变量 语句, 文本型, , , 
.局部变量 索引, 整数型, , , 
.局部变量 name, 文本型, , , 
.局部变量 number, 文本型, , , 
.局部变量 子记录集句柄, 整数型, , , 

.如果真 (等于 (输入框 (“SQL语句”, , “select * from test”, 语句, ), 真))
    未知支持库函数_3 (句柄, 语句)
    相加 (语句, “正在执行。。。”).加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
    全部删除 ()
    赋值 (子记录集句柄, 未知支持库函数_4 (句柄))
    .计次循环首 (未知支持库函数_7 (子记录集句柄), )
        未知支持库函数_6 (子记录集句柄, “name”, name)
        赋值 (索引, .插入表项 (name, , , , ))
        未知支持库函数_6 (子记录集句柄, “number”, number)
        索引.置标题 (1, number)
        未知支持库函数_10 (子记录集句柄)
    .计次循环尾 ()
    未知支持库函数_5 (子记录集句柄)
    相加 (语句, “执行完毕！”).加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.如果真结束


.子程序 _按钮4_被单击, 空白型, , 
.局部变量 字段内容, 文本型, , , 

.如果 (等于 (未知支持库函数_6 (记录集句柄, “name”, 字段内容), 真))
    相加 (“字段内容为：”, 字段内容).加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.否则
    “MySql数据库尚未打开,请先打开数据库在操作！”.加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.如果结束



.子程序 _按钮5_被单击, 空白型, , 
.如果 (不等于 (句柄, 0))
    相加 (“记录集行数为：”, 到文本 (未知支持库函数_7 (记录集句柄))).加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.否则
    “MySql数据库尚未打开,请先打开数据库在操作！”.加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.如果结束



.子程序 _按钮6_被单击, 空白型, , 
.如果 (不等于 (句柄, 0))
    相加 (“字段总数为：”, 到文本 (未知支持库函数_14 (记录集句柄))).加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.否则
    “MySql数据库尚未打开,请先打开数据库在操作！”.加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.如果结束


.子程序 _按钮7_被单击, 空白型, , 
.局部变量 字段名变量, 文本型, , , 

.如果 (不等于 (句柄, 0))
    未知支持库函数_15 (记录集句柄, 1, 字段名变量)
    相加 (“序号为1的字段名为：”, 字段名变量).加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.否则
    “MySql数据库尚未打开,请先打开数据库在操作！”.加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.如果结束


.子程序 _按钮8_被单击, 空白型, , 
.如果 (不等于 (句柄, 0))
    .如果 (等于 (未知支持库函数_10 (记录集句柄), 真))
        “到下一行成功”.加入项目 ()
        赋值 (.现行选中项, 相减 (取项目数 (), 1))
    .否则
        “到尾记录”.加入项目 ()
        赋值 (.现行选中项, 相减 (取项目数 (), 1))
    .如果结束
    
.否则
    “MySql数据库尚未打开,请先打开数据库在操作！”.加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.如果结束


.子程序 _按钮9_被单击, 空白型, , 
.局部变量 行号, 整数型, , , 

.如果真 (等于 (输入框 (“指定行号”, , , 行号, #整数型), 真))
    .如果真 (等于 (未知支持库函数_11 (记录集句柄, 行号), 真))
        “到指定行成功”.加入项目 ()
        赋值 (.现行选中项, 相减 (取项目数 (), 1))
    .如果真结束
    
.如果真结束


.子程序 _按钮2_被单击, 空白型, , 
未知支持库函数_2 (句柄)
“MySql数据库已经关闭，需要再次操作，请打开数据库！”.加入项目 ()
赋值 (.现行选中项, 相减 (取项目数 (), 1))
赋值 (句柄, 0)
赋值 (记录集句柄, 0)

.子程序 _按钮10_被单击, 空白型, , 
.如果 (不等于 (句柄, 0))
    .如果真 (等于 (未知支持库函数_12 (记录集句柄), 真))
        “到首行成功！”.加入项目 ()
        赋值 (.现行选中项, 相减 (取项目数 (), 1))
    .如果真结束
    
.否则
    “MySql数据库尚未打开,请先打开数据库在操作！”.加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.如果结束



.子程序 _按钮11_被单击, 空白型, , 
.如果 (不等于 (句柄, 0))
    .如果真 (等于 (未知支持库函数_13 (记录集句柄), 真))
        “到尾行成功！”.加入项目 ()
        赋值 (.现行选中项, 相减 (取项目数 (), 1))
    .如果真结束
    
.否则
    “MySql数据库尚未打开,请先打开数据库在操作！”.加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.如果结束


.子程序 _按钮12_被单击, 空白型, , 
.局部变量 语句, 文本型, , , 
.局部变量 name, 文本型, , , 
.局部变量 索引, 整数型, , , 
.局部变量 number, 文本型, , , 
.局部变量 子记录集句柄, 整数型, , , 

.如果真 (等于 (输入框 (“SQL语句,我们这里在第一个字段name中查找”, , , 语句, ), 真))
    赋值 (子记录集句柄, 未知支持库函数_17 (句柄, “test”, “name”, 语句, “ASC”))
    .计次循环首 (未知支持库函数_7 (子记录集句柄), )
        未知支持库函数_6 (子记录集句柄, “name”, name)
        赋值 (索引, .插入表项 (name, , , , ))
        未知支持库函数_6 (子记录集句柄, 2, number)
        索引.置标题 (1, number)
        未知支持库函数_10 (子记录集句柄)
    .计次循环尾 ()
    相加 (语句, “执行完毕！”).加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.如果真结束


.子程序 _按钮13_被单击, 空白型, , 
.局部变量 name, 文本型, , , 
.局部变量 索引, 整数型, , , 
.局部变量 number, 文本型, , , 
.局部变量 i, 空白型, , , 

.计次循环首 (10, i)
    .如果真 (等于 (未知支持库函数_18 (句柄, “test”, 相加 (“name='888',number=”, 到文本 (i))), 真))
        全部删除 ()
        未知支持库函数_5 (记录集句柄)
        未知支持库函数_3 (句柄, “select * from test”)
        赋值 (记录集句柄, 未知支持库函数_4 (句柄))
        未知支持库函数_12 (记录集句柄)
        .计次循环首 (未知支持库函数_7 (记录集句柄), )
            未知支持库函数_6 (记录集句柄, “name”, name)
            赋值 (索引, .插入表项 (name, , , , ))
            未知支持库函数_6 (记录集句柄, “number”, number)
            索引.置标题 (1, number)
            未知支持库函数_10 (记录集句柄)
        .计次循环尾 ()
        “增加记录执行完毕！”.加入项目 ()
        赋值 (.现行选中项, 相减 (取项目数 (), 1))
    .如果真结束
    
.计次循环尾 ()



.子程序 _按钮14_被单击, 空白型, , 
.局部变量 name, 文本型, , , 
.局部变量 索引, 整数型, , , 
.局部变量 number, 文本型, , , 

.如果真 (等于 (未知支持库函数_19 (句柄, “test”, “name='111',number=110”, “name='888'”), 真))
    全部删除 ()
    未知支持库函数_5 (记录集句柄)
    未知支持库函数_3 (句柄, “select * from test”)
    赋值 (记录集句柄, 未知支持库函数_4 (句柄))
    未知支持库函数_12 (记录集句柄)
    .计次循环首 (未知支持库函数_7 (记录集句柄), )
        未知支持库函数_6 (记录集句柄, “name”, name)
        赋值 (索引, .插入表项 (name, , , , ))
        未知支持库函数_6 (记录集句柄, “number”, number)
        索引.置标题 (1, number)
        未知支持库函数_10 (记录集句柄)
    .计次循环尾 ()
    “更新记录执行完毕！”.加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.如果真结束


.子程序 _按钮15_被单击, 空白型, , 
.局部变量 name, 文本型, , , 
.局部变量 索引, 整数型, , , 
.局部变量 number, 文本型, , , 

.如果真 (等于 (未知支持库函数_20 (句柄, “test”, “name='888'”), 真))
    未知支持库函数_5 (记录集句柄)
    全部删除 ()
    赋值 (记录集句柄, 未知支持库函数_4 (句柄))
    .计次循环首 (未知支持库函数_7 (记录集句柄), )
        未知支持库函数_6 (记录集句柄, “name”, name)
        赋值 (索引, .插入表项 (name, , , , ))
        未知支持库函数_6 (记录集句柄, 2, number)
        索引.置标题 (1, number)
        未知支持库函数_10 (记录集句柄)
    .计次循环尾 ()
    “删除成功！”.加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.如果真结束


.子程序 _按钮16_被单击, 空白型, , 
.局部变量 序号变量, 整数型, , , 

.如果真 (等于 (未知支持库函数_16 (记录集句柄, “name”, 序号变量), 真))
    相加 (“字段name的序号为：”, 到文本 (序号变量)).加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.如果真结束


.子程序 _按钮17_被单击, 空白型, , 
.局部变量 i, 空白型, , , 
.局部变量 i1, 空白型, , , 
.局部变量 m, 文本型, , "0", 
.局部变量 lx, 文本型, , , 
.局部变量 cd, 整数型, , , 
.局部变量 sql, 文本型, , , 
.局部变量 sql1, 文本型, , , 
.局部变量 j, 空白型, , , 
.局部变量 n, 文本型, , , 
.局部变量 t, 逻辑型, , , 
.局部变量 月, 空白型, , , 
.局部变量 日, 空白型, , , 
.局部变量 年份, 空白型, , , 

到首记录 ()
.计次循环首 (取记录数 (), i)
    赋值 (sql, “”)
    .计次循环首 (取字段数 (), j)
        赋值 (n, 汉字助记码 (取字段名 (j)))
        .如果 (等于 (取字段类型 (j), #文本型))
            赋值 (sql1, 相加 (n, “='”, 读字段 (j, ), “',”))
            
        .否则
            .如果 (等于 (取字段类型 (j), #日期时间型))
                赋值 (年份, 取时间部分 (读字段 (j, ), #年份))
                赋值 (月, 取时间部分 (读字段 (j, ), #月份))
                赋值 (日, 取时间部分 (读字段 (j, ), #日))
                赋值 (sql1, 相加 (n, “='”, 到文本 (年份), “-”, 到文本 (月), “-”, 到文本 (日), “',”))
                输出调试文本 (到文本 (年份) ＋ “-” ＋ 到文本 (月) ＋ “-” ＋ 到文本 (日))
                
            .否则
                .如果 (或者 (等于 (取字段类型 (j), #双精度小数型), 等于 (取字段类型 (j), #小数型)))
                    赋值 (sql1, 相加 (n, “=”, 到文本 (读字段 (j, )), “,”))
                    sql1 ＝ n ＋ “ ” ＋ lx ＋ “(,”
                .否则
                    赋值 (sql1, 相加 (n, “='”, 到文本 (读字段 (j, )), “',”))
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
        赋值 (相加 ())
    .计次循环尾 ()
    赋值 (sql, 取文本左边 (sql, 相减 (取文本长度 (sql), 1)))
    输出调试文本 (相加 (“insert into ”, table, “ set ”, sql, “;”))
    .如果 (未知支持库函数_3 (句柄, 相加 (“insert into ”, table, “ set ”, sql, “;”)))
        输出调试文本 (相加 (“insert into ”, table, “ set ”, sql, “;”))
        赋值 (t, 真)
    .否则
        赋值 (t, 假)
    .如果结束
    跳过 ()
    处理事件 ()
.计次循环尾 ()
.如果 (不等于 (t, 假))
    信息框 (“转换成功”, 0, )
    赋值 (.禁止, 真)
    
.否则
    
.如果结束



.子程序 _按钮18_被单击, 空白型, , 
.局部变量 i, 空白型, , , 
.局部变量 m, 文本型, , "0", 
.局部变量 lx, 文本型, , , 
.局部变量 cd, 整数型, , , 
.局部变量 sql, 文本型, , , 
.局部变量 sql1, 文本型, , , 
.局部变量 j, 空白型, , , 
.局部变量 n, 文本型, , , 

到首记录 ()
赋值 (sql, “”)
赋值 (n, “”)
.计次循环首 (取字段数 (), i)
    赋值 (n, 汉字助记码 (取字段名 (i)))
    .如果 (等于 (取字段类型 (i), #文本型))
        赋值 (lx, “varchar”)
        赋值 (cd, 取字段尺寸 (i))
        赋值 (sql1, 相加 (n, “ ”, lx, “ (”, 到文本 (cd), “),”))
        
    .否则
        .如果 (等于 (取字段类型 (i), #日期时间型))
            赋值 (lx, “date”)
            赋值 (sql1, 相加 (n, “ ”, lx, “,”))
            
        .否则
            .如果 (或者 (等于 (取字段类型 (i), #双精度小数型), 等于 (取字段类型 (i), #小数型)))
                赋值 (lx, “double”)
                赋值 (cd, 取字段尺寸 (i))
                赋值 (sql1, 相加 (n, “ ”, lx, “ (”, 到文本 (cd), “,4),”))
                sql1 ＝ n ＋ “ ” ＋ lx ＋ “(,”
            .否则
                赋值 (lx, “int”)
                赋值 (cd, 取字段尺寸 (i))
                赋值 (sql1, 相加 (n, “ ”, lx, “ (”, 到文本 (cd), “),”))
                sql1 ＝ n ＋ “ ” ＋ lx ＋ “,”
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
    
    赋值 (sql, 相加 (sql, sql1))
.计次循环尾 ()
赋值 (取文本左边 (相减 (取文本长度 (), 1)))
输入框 (“选择表名”, “选择表名”, table, table, )
.如果 (不等于 (“”))
    .如果 (等于 (未知支持库函数_3 (句柄, 相加 (“select * from ”, table)), 假))
        .如果 (未知支持库函数_3 (句柄, 相加 (“create table ”, table, “ (”, sql, “);”)))
            信息框 (相加 (“表”, , “创建成功”), 0, )
        .否则
            
        .如果结束
        
    .否则
        信息框 (相加 (“表”, , “已存在，请重新选择”), 0, )
        
    .如果结束
    
.否则
    
.如果结束
输出调试文本 (相加 (“create table ”, , “ (”, sql, “);”))
赋值 (.禁止, 真)

.子程序 _按钮19_被单击, 空白型, , 
.局部变量 c, 文本型, , "0", 

打开 ()
打开 (.文件名, , , , , , )
取文本左边 (通用对话框1.文件名, 取文本左边 (通用对话框1.文件名,取文本长度 (通用对话框1.文件名) － 倒找文本 (通用对话框1.文件名, “\”, , 假)), 寻找文本 (通用对话框1.文件名, 取文本左边 (取文本长度 (通用对话框1.文件名) － 倒找文本 (通用对话框1.文件名, “\”, , 假), ), “.”, 假)))
赋值 (c, 分割文本 (取文本右边 (.文件名, 相减 (取文本长度 (.文件名), 倒找文本 (.文件名, “\”, , 假))), “.”, ))
.如果 (不等于 (取数组成员数 (c), 0))
    赋值 (table, 汉字助记码 (c [1]))
    到首记录 ()
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    
.否则
    
.如果结束




.子程序 _按钮20_被单击, 空白型, , 
信息框 (未知支持库函数_3 (句柄, “create database sfsf”), 0, )


.程序集 _模块_汉字助记码, , , ** 不要更改此处 汉字助记码.ec

.子程序 汉字助记码, 文本型, , 
.参数 汉字, 文本型, , 

 ' ** 本子程序功能由系统自动转交对应模块实现，可以删除但不能修改。


 ' 不属于任何一个程序集、类模块的函数：
