 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 867
    高度 = 562
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\进销存.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “ 易博进销存管理软件---测试版1.0”
    帮助文件名 = “”

窗口 进货窗口
    左边 = 50
    顶边 = 50
    宽度 = 668
    高度 = 389
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\进销存.e\进货窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “ 添加进货记录”
    帮助文件名 = “”

窗口 销售窗口
    左边 = 50
    顶边 = 50
    宽度 = 880
    高度 = 580
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\进销存.e\销售窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “ 添加销售记录”
    帮助文件名 = “”

窗口 销售提货单打印
    左边 = 50
    顶边 = 50
    宽度 = 613
    高度 = 414
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\进销存.e\销售提货单打印_图标.ico
    背景音乐 =  ' 空
    标题 = “ 销售单打印”
    帮助文件名 = “”

窗口 付款清单
    左边 = 50
    顶边 = 50
    宽度 = 613
    高度 = 414
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\进销存.e\付款清单_图标.ico
    背景音乐 =  ' 空
    标题 = “付款清单”
    帮助文件名 = “”

窗口 系统设置
    左边 = 50
    顶边 = 50
    宽度 = 440
    高度 = 376
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\进销存.e\系统设置_图标.ico
    背景音乐 =  ' 空
    标题 = “基本设置”
    帮助文件名 = “”

窗口 恢复备份
    左边 = 50
    顶边 = 50
    宽度 = 273
    高度 = 117
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\进销存.e\恢复备份_图标.ico
    背景音乐 =  ' 空
    标题 = “恢复备份”
    帮助文件名 = “”



.常量 序列号, "“序列号”", , 
.常量 采购单号, "“采购单号”", , 
.常量 进货日期, "“进货日期”", , 
.常量 品名, "“品名”", , 
.常量 采购价格, "“采购价格”", , 
.常量 采购员, "“采购员”", , 
.常量 供货商, "“供货商”", , 
.常量 采购票据, "“采购票据”", , 
.常量 类别, "“类别”", , 
.常量 销售日期, "“销售日期”", , 
.常量 销售单号, "“销售单号”", , 
.常量 销售价格, "“销售价格”", , 
.常量 客户名称, "“客户名称”", , 
.常量 联系电话, "“联系电话”", , 
.常量 联系地址, "“联系地址”", , 
.常量 销售票据, "“销售票据”", , 
.常量 利润额, "“利润额”", , 
.常量 销售员, "“销售员”", , 
.常量 状态, "“状态”", , 
.常量 单位, "“单位”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 3 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 1 扩展界面支持库一
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二




.全局变量 记录集句柄, 空白型, , , 
.全局变量 N, 空白型, , , 
.全局变量 选择栏, 空白型, , , 
.全局变量 数据库总数, 空白型, , , 
.全局变量 数量, 整数型, , , 
.全局变量 当前品名, 文本型, , , 
.全局变量 总金额, 小数型, , , 
.全局变量 末尾, 整数型, , , 
.全局变量 当前行号, 空白型, , , 
.全局变量 库存记录号, 整数型, , , 
.全局变量 销售记录号, 整数型, , , 
.全局变量 添加记录号, 整数型, , , 
.全局变量 采样日期1, 日期时间型, , , 
.全局变量 日期到文本1, 整数型, , , 
.全局变量 日期到文本2, 整数型, , , 
.全局变量 日期到文本3, 整数型, , , 
.全局变量 采样日期2, 日期时间型, , , 
.全局变量 采样日期3, 日期时间型, , , 
.全局变量 采购额, 小数型, , , 
.全局变量 销售额, 小数型, , , 
.全局变量 当前供货商, 文本型, , , 
.全局变量 金额, 小数型, , , 
.全局变量 利润额, 小数型, , , 

.窗口程序集 主程序窗口, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 连接文本, 文本型, , , 

赋值 (连接文本, 相加 (取运行目录 (), “\sjk\ybwl.edb”))
打开 (连接文本, , , , , “797300”, )
置数据库密码 ()
.如果真 (等于 (连接文本, “”))
    信息框 (“未找到主数据库文件”, 0, )
.如果真结束

_日期框1_选择日期被改变 ()
_日期框2_选择日期被改变 ()


.子程序 _进货单_被单击, 空白型, , 
载入 (进货窗口, , 真)

.子程序 _销售单_被单击, 空白型, , 
载入 (销售窗口, , 真)

.子程序 显示查找, 空白型, , 
.局部变量 行号, 整数型, , , 

赋值 (行号, 取行数 ())
.添加行 ()
赋值 (行号, 相加 (行号, 1))
行号.置文本 (1, 读 (#进货日期))
行号.置文本 (2, 读 (#品名))
行号.置文本 (3, 读 (#采购单号))
行号.置文本 (4, 读 (#序列号))
行号.置文本 (5, 读 (#采购价格))
行号.置文本 (6, 读 (#采购员))
行号.置文本 (7, 读 (#供货商))
行号.置文本 (8, 读 (#采购票据))
行号.置文本 (9, 读 (#类别))
行号.置文本 (10, 读 (#单位))
行号.置文本 (11, 读 (#销售日期))
行号.置文本 (12, 读 (#销售单号))
行号.置文本 (13, 读 (#销售价格))
行号.置文本 (14, 读 (#客户名称))
行号.置文本 (15, 读 (#联系电话))
行号.置文本 (16, 读 (#联系地址))
行号.置文本 (17, 读 (#销售票据))
行号.置文本 (18, 读 (#利润额))
行号.置文本 (19, 读 (#销售员))
行号.置文本 (20, 读 (#状态))
赋值 (.标题, 相加 (“共  ”, 到文本 (相减 (行号, 1)), “  件”))

.子程序 _开始查询_被单击, 空白型, , 
.如果真 (等于 (相加 (取运行目录 (), “\sjk\查询单.grd”).从文件读 (), 假))
    信息框 (“打开库存单模板失败！”, 相加 (#确认钮, #错误图标), “错误”)
    返回 ()
.如果真结束

赋值 (.标题, 相加 (“共  ”, 到文本 (0), “  件”))
.如果 (并且 (等于 (.内容, “”), 等于 (.内容, “”)))
    所有查询 ()
.否则
    
    .如果 (不等于 (.内容, “”))
        
    .否则
        信息框 (“请输入查询内容！”, 0, )
        返回 ()
    .如果结束
    .如果 (不等于 (.内容, “”))
        
    .否则
        信息框 (“请选择查询类型！”, 0, )
        返回 ()
    .如果结束
    
    .如果 (等于 (.选中, 真))
        时间查询 ()
    .否则
        模糊查询 ()
    .如果结束
    
    赋值 (销售额, 0)
    赋值 (采购额, 0)
    赋值 (利润额, 0)
.如果结束


.子程序 模糊查询, 空白型, , 
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (近似等于 (读 (到文本 (.取项目文本 (.现行选中项))), 到文本 (.内容)))
        显示查找 ()
        计算 ()
    .否则
        
    .如果结束
    跳过 ()
.判断循环尾 ()
合计 ()

.子程序 时间查询, 空白型, , 
.如果 (大于或等于 (相减 (到数值 (日期到文本2), 到数值 (日期到文本1)), 0))
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (等于 (.选中, 真))
            赋值 (采样日期3, 到时间 (到文本 (读 (#进货日期))))
            库日期到文本 ()
            .如果真 (并且 (近似等于 (读 (到文本 (.取项目文本 (.现行选中项))), 到文本 (.内容)), 小于或等于 (日期到文本1, 日期到文本3), 小于或等于 (日期到文本3, 日期到文本2)))
                显示查找 ()
                计算 ()
            .如果真结束
            跳过 ()
        .否则
            .如果真 (不等于 (读 (#销售日期), “”))
                赋值 (采样日期3, 到时间 (读 (#销售日期)))
                库日期到文本 ()
                .如果真 (并且 (近似等于 (读 (到文本 (.取项目文本 (.现行选中项))), 到文本 (.内容)), 大于或等于 (日期到文本3, 日期到文本1), 小于或等于 (日期到文本3, 日期到文本2)))
                    显示查找 ()
                    计算 ()
                .如果真结束
                
            .如果真结束
            跳过 ()
        .如果结束
        
    .判断循环尾 ()
    合计 ()
.否则
    信息框 (“请在第一个日期框中选择开始日期，在第二个日期框中选择截止日期！”, 0, )
.如果结束


.子程序 _查询内容编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (#回车键))
    _开始查询_被单击 ()
.如果真结束


.子程序 _查询类型组合框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (#回车键))
    _开始查询_被单击 ()
.如果真结束


.子程序 日期到文本1, 空白型, , 
.局部变量 年, 文本型, , , 
.局部变量 月, 文本型, , , 
.局部变量 日, 文本型, , , 

赋值 (日期到文本1, 0)
赋值 (年, 到文本 (取年份 (采样日期1)))
赋值 (月, 到文本 (取月份 (采样日期1)))
赋值 (日, 到文本 (取日 (采样日期1)))
赋值 (日期到文本1, 到数值 (相加 (年, 月, 日)))

.子程序 日期到文本2, 空白型, , 
.局部变量 年, 文本型, , , 
.局部变量 月, 文本型, , , 
.局部变量 日, 文本型, , , 

赋值 (日期到文本2, 0)
赋值 (年, 到文本 (取年份 (采样日期2)))
赋值 (月, 到文本 (取月份 (采样日期2)))
赋值 (日, 到文本 (取日 (采样日期2)))
赋值 (日期到文本2, 到数值 (相加 (年, 月, 日)))


.子程序 库日期到文本, 空白型, , 
.局部变量 年, 文本型, , , 
.局部变量 月, 文本型, , , 
.局部变量 日, 文本型, , , 

赋值 (日期到文本3, 0)
赋值 (年, 到文本 (取年份 (采样日期3)))
赋值 (月, 到文本 (取月份 (采样日期3)))
赋值 (日, 到文本 (取日 (采样日期3)))
赋值 (日期到文本3, 到数值 (相加 (年, 月, 日)))

.子程序 _日期框1_选择日期被改变, 空白型, , 
赋值 (采样日期1, .今天)
日期到文本1 ()

.子程序 _日期框2_选择日期被改变, 空白型, , 
赋值 (采样日期2, .今天)
日期到文本2 ()

.子程序 _库存查询_被单击, 空白型, , 
赋值 (.标题, 相加 (“共  ”, 到文本 (0), “  件”))
.如果真 (等于 (相加 (取运行目录 (), “\sjk\查询单.grd”).从文件读 (), 假))
    信息框 (“打开库存单模板失败！”, 相加 (#确认钮, #错误图标), “错误”)
    返回 ()
.如果真结束

.如果 (等于 (.选中, 真))
    库存时间查询 ()
.否则
    库存模糊查询 ()
.如果结束

赋值 (销售额, 0)
赋值 (采购额, 0)
赋值 (利润额, 0)


.子程序 库存模糊查询, 空白型, , 
.如果 (并且 (等于 (.内容, “”), 等于 (到文本 (.取项目文本 (.现行选中项)), “”)))
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果真 (等于 (读 (#销售日期), “”))
            显示查找 ()
            计算 ()
        .如果真结束
        跳过 ()
    .判断循环尾 ()
    合计 ()
    
.否则
    .如果 (并且 (不等于 (到文本 (.取项目文本 (.现行选中项)), “”), 不等于 (.内容, “”)))
        到首记录 ()
        .判断循环首 (等于 (尾记录后 (), 假))
            .如果真 (并且 (近似等于 (读 (到文本 (.取项目文本 (.现行选中项))), 到文本 (.内容)), 等于 (读 (#销售日期), “”)))
                显示查找 ()
                计算 ()
            .如果真结束
            跳过 ()
        .判断循环尾 ()
        合计 ()
        
    .否则
        信息框 (“请确认您选择的查询类型与查询内容的准确性！”, 0, )
    .如果结束
    
.如果结束


.子程序 库存时间查询, 空白型, , 

.如果 (大于或等于 (相减 (到数值 (日期到文本2), 到数值 (日期到文本1)), 0))
    .如果 (并且 (等于 (.内容, “”), 等于 (到文本 (.取项目文本 (.现行选中项)), “”)))
        到首记录 ()
        .判断循环首 (等于 (尾记录后 (), 假))
            赋值 (采样日期3, 到时间 (到文本 (读 (#进货日期))))
            库日期到文本 ()
            .如果真 (并且 (等于 (读 (#销售日期), “”), 小于或等于 (日期到文本1, 日期到文本3), 小于或等于 (日期到文本3, 日期到文本2)))
                显示查找 ()
                计算 ()
            .如果真结束
            跳过 ()
        .判断循环尾 ()
        合计 ()
    .否则
        .如果 (并且 (不等于 (到文本 (.取项目文本 (.现行选中项)), “”), 不等于 (.内容, “”)))
            到首记录 ()
            .判断循环首 (等于 (尾记录后 (), 假))
                赋值 (采样日期3, 到时间 (到文本 (读 (#进货日期))))
                库日期到文本 ()
                .如果真 (并且 (近似等于 (读 (到文本 (.取项目文本 (.现行选中项))), 到文本 (.内容)), 等于 (读 (#销售日期), “”), 小于或等于 (日期到文本1, 日期到文本3), 小于或等于 (日期到文本3, 日期到文本2)))
                    显示查找 ()
                    计算 ()
                .如果真结束
                跳过 ()
            .判断循环尾 ()
            合计 ()
        .否则
            信息框 (“请确认您选择的查询类型与查询内容的准确性！”, 0, )
        .如果结束
        
    .如果结束
    
.否则
    信息框 (“请在第一个日期框中选择开始日期，在第二个日期框中选择截止日期！”, 0, )
.如果结束


.子程序 _销售查询_被单击, 空白型, , 
赋值 (.标题, 相加 (“共  ”, 到文本 (0), “  件”))
.如果真 (等于 (相加 (取运行目录 (), “\sjk\查询单.grd”).从文件读 (), 假))
    信息框 (“打开库存单模板失败！”, 相加 (#确认钮, #错误图标), “错误”)
    返回 ()
.如果真结束

.如果 (等于 (.选中, 真))
    销售时间查询 ()
.否则
    销售模糊查询 ()
.如果结束

赋值 (销售额, 0)
赋值 (采购额, 0)
赋值 (利润额, 0)


.子程序 销售模糊查询, 空白型, , 
.如果 (并且 (等于 (.内容, “”), 等于 (到文本 (.取项目文本 (.现行选中项)), “”)))
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果真 (不等于 (读 (#销售日期), “”))
            显示查找 ()
            计算 ()
        .如果真结束
        跳过 ()
    .判断循环尾 ()
    合计 ()
.否则
    .如果 (并且 (不等于 (到文本 (.取项目文本 (.现行选中项)), “”), 不等于 (.内容, “”)))
        到首记录 ()
        .判断循环首 (等于 (尾记录后 (), 假))
            .如果真 (并且 (近似等于 (读 (到文本 (.取项目文本 (.现行选中项))), 到文本 (.内容)), 不等于 (读 (#销售日期), “”)))
                显示查找 ()
                计算 ()
            .如果真结束
            跳过 ()
        .判断循环尾 ()
        合计 ()
    .否则
        信息框 (“请确认您选择的查询类型与查询内容的准确性！”, 0, )
    .如果结束
    
.如果结束


.子程序 销售时间查询, 空白型, , 
.如果 (大于或等于 (相减 (到数值 (日期到文本2), 到数值 (日期到文本1)), 0))
    .如果 (并且 (等于 (.内容, “”), 等于 (到文本 (.取项目文本 (.现行选中项)), “”)))
        到首记录 ()
        .判断循环首 (等于 (尾记录后 (), 假))
            赋值 (采样日期3, 到时间 (到文本 (读 (#进货日期))))
            库日期到文本 ()
            .如果真 (并且 (不等于 (读 (#销售日期), “”), 小于或等于 (日期到文本1, 日期到文本3), 小于或等于 (日期到文本3, 日期到文本2)))
                显示查找 ()
                计算 ()
            .如果真结束
            跳过 ()
        .判断循环尾 ()
        合计 ()
    .否则
        .如果 (并且 (不等于 (到文本 (.取项目文本 (.现行选中项)), “”), 不等于 (.内容, “”)))
            到首记录 ()
            .判断循环首 (等于 (尾记录后 (), 假))
                赋值 (采样日期3, 到时间 (到文本 (读 (#进货日期))))
                库日期到文本 ()
                .如果真 (并且 (近似等于 (读 (到文本 (.取项目文本 (.现行选中项))), 到文本 (.内容)), 不等于 (读 (#销售日期), “”), 小于或等于 (日期到文本1, 日期到文本3), 小于或等于 (日期到文本3, 日期到文本2)))
                    显示查找 ()
                    计算 ()
                .如果真结束
                跳过 ()
            .判断循环尾 ()
            合计 ()
        .否则
            信息框 (“请确认您选择的查询类型与查询内容的准确性！”, 0, )
        .如果结束
        
    .如果结束
    
.否则
    信息框 (“请在第一个日期框中选择开始日期，在第二个日期框中选择截止日期！”, 0, )
.如果结束


.子程序 计算, 空白型, , 
赋值 (采购额, 相加 (采购额, 到数值 (读 (#采购价格))))
赋值 (销售额, 相加 (销售额, 到数值 (读 (#销售价格))))
赋值 (利润额, 相加 (利润额, 到数值 (读 (#利润额))))

.子程序 合计, 空白型, , 
赋值 (.内容, 数值到格式文本 (采购额, 2, 假))
赋值 (.内容, 数值到格式文本 (销售额, 2, 假))
赋值 (.内容, 数值到格式文本 (利润额, 2, 假))


.子程序 _退出_被选择, 空白型, , 
销毁 ()

.子程序 __启动窗口_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _设置_被选择, 空白型, , 
载入 (系统设置, , 真)

.子程序 __启动窗口_将被销毁, 空白型, , 
置数据库密码 (“797300”)

.子程序 _关于_被选择, 空白型, , 
信息框 (相加 (“易博经销存管理软件”, 字符 (10), “ 版本：1.0 测试版”, 字符 (10), “    作者：陈军”, 字符 (10), “   2004年6月16日”), 0, )

.子程序 _帮助_被选择, 空白型, , 
信息框 (“自己摸索吧！没来得急写呢！”, 0, )

.子程序 _备份_被选择, 空白型, , 
.如果 (复制文件 (相加 (取运行目录 (), “\sjk\ybwl.edb”), 相加 (读配置项 (相加 (取运行目录 (), “\系统信息.ini”), “备份路径”, “备份路径”, ), 读配置项 (相加 (取运行目录 (), “\系统信息.ini”), “最前备份”, “最前备份”, ))))
    .如果 (等于 (读配置项 (相加 (取运行目录 (), “\系统信息.ini”), “最前备份”, “最前备份”, ), “BAK2.dat”))
        写配置项 (相加 (取运行目录 (), “\系统信息.ini”), “最前备份”, “最前备份”, “BAK1.dat”)
        信息框 (“备份成功！”, 0, )
        
    .否则
        写配置项 (相加 (取运行目录 (), “\系统信息.ini”), “最前备份”, “最前备份”, “BAK2.dat”)
        信息框 (“备份成功！”, 0, )
        
    .如果结束
    
.否则
    创建目录 (读配置项 (相加 (取运行目录 (), “\”, “系统信息.ini”), “备份路径”, “备份路径”, ))
    复制文件 (相加 (取运行目录 (), “\sjk\ybwl.edb”), 相加 (读配置项 (相加 (取运行目录 (), “\系统信息.ini”), “备份路径”, “备份路径”, ), 读配置项 (相加 (取运行目录 (), “\系统信息.ini”), “最前备份”, “最前备份”, )))
    .如果 (等于 (读配置项 (相加 (取运行目录 (), “\系统信息.ini”), “最前备份”, “最前备份”, ), “BAK2.dat”))
        写配置项 (相加 (取运行目录 (), “\系统信息.ini”), “最前备份”, “最前备份”, “BAK1.dat”)
        信息框 (“备份成功！”, 0, )
        
    .否则
        写配置项 (相加 (取运行目录 (), “\系统信息.ini”), “最前备份”, “最前备份”, “BAK2.dat”)
        信息框 (“备份成功！”, 0, )
        
    .如果结束
    
.如果结束


.子程序 _恢复_被选择, 空白型, , 
载入 (恢复备份, , 真)

.子程序 所有查询, 空白型, , 
.如果 (等于 (.选中, 真))
    所有时间查询 ()
.否则
    所有模糊查询 ()
.如果结束
赋值 (销售额, 0)
赋值 (采购额, 0)
赋值 (利润额, 0)


.子程序 所有时间查询, 空白型, , 
.如果 (等于 (.选中, 真))
    .如果 (大于或等于 (相减 (到数值 (日期到文本2), 到数值 (日期到文本1)), 0))
        到首记录 ()
        .判断循环首 (等于 (尾记录后 (), 假))
            赋值 (采样日期3, 到时间 (到文本 (读 (#进货日期))))
            库日期到文本 ()
            .如果真 (并且 (小于或等于 (日期到文本1, 日期到文本3), 小于或等于 (日期到文本3, 日期到文本2)))
                显示查找 ()
                计算 ()
            .如果真结束
            跳过 ()
        .判断循环尾 ()
        合计 ()
    .否则
        信息框 (“请在第一个日期框中选择开始日期，在第二个日期框中选择截止日期！”, 0, )
    .如果结束
    
.否则
    .如果 (大于或等于 (相减 (到数值 (日期到文本2), 到数值 (日期到文本1)), 0))
        到首记录 ()
        .判断循环首 (等于 (尾记录后 (), 假))
            .如果真 (不等于 (读 (#销售日期), “”))
                赋值 (采样日期3, 到时间 (到文本 (读 (#销售日期))))
                库日期到文本 ()
                .如果真 (并且 (小于或等于 (日期到文本1, 日期到文本3), 小于或等于 (日期到文本3, 日期到文本2)))
                    显示查找 ()
                    计算 ()
                .如果真结束
                
            .如果真结束
            跳过 ()
        .判断循环尾 ()
        合计 ()
    .否则
        信息框 (“请在第一个日期框中选择开始日期，在第二个日期框中选择截止日期！”, 0, )
    .如果结束
    
.如果结束


.子程序 所有模糊查询, 空白型, , 
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    显示查找 ()
    计算 ()
    跳过 ()
.判断循环尾 ()
合计 ()


.窗口程序集 添加程序窗口, , , 

.子程序 _进货窗口_创建完毕, 空白型, , 
打开 (到文本 (相加 (取运行目录 (), “\sjk\ybwl.edb”)), , , , , , )
获取焦点 ()
赋值 (N, 0)
在判断重复时使用的变量N的初始化。
赋值 (.内容, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 到文本 (取月份 (取现行时间 ())), “月”, 到文本 (取日 (取现行时间 ())), “日”))
使添加窗口打开时，显示信息为数据库最后一条信息。

到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (不等于 (读 (#采购员), “”))
        .如果真 (不等于 (读 (#采购员), 读 (#采购员).选择 ().取项目文本 ()))
            到文本 (读 (“采购员”)).加入项目 ()
        .如果真结束
        
    .如果真结束
    跳过 ()
.判断循环尾 ()
从数据库中提取组合框所需的不重复内容。

到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (不等于 (读 (#采购票据), “”))
        .如果真 (不等于 (读 (#采购票据), 读 (#采购票据).选择 ().取项目文本 ()))
            到文本 (读 (“采购票据”)).加入项目 ()
        .如果真结束
        
    .如果真结束
    跳过 ()
.判断循环尾 ()
同上

到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (不等于 (读 (#单位), “”))
        .如果真 (不等于 (读 (#单位), 读 (#单位).选择 ().取项目文本 ()))
            到文本 (读 (“单位”)).加入项目 ()
        .如果真结束
        
    .如果真结束
    跳过 ()
.判断循环尾 ()
同上
添加到表格 ()

.子程序 _添加_被单击, 空白型, , 
.局部变量 指针原位, 整数型, , , 

.如果 (不等于 (.内容, “”))
    
.否则
    信息框 (“请输入品名！”, 0, )
    返回 ()
.如果结束
.如果 (不等于 (.内容, “”))
    
.否则
    信息框 (“请输入进价！”, 0, )
    返回 ()
.如果结束
.如果 (不等于 (.内容, “”))
    
.否则
    信息框 (“请选择或填写采购！”, 0, )
    返回 ()
.如果结束
.如果 (不等于 (.内容, “”))
    
.否则
    信息框 (“请选择或填写供货商！”, 0, )
    返回 ()
.如果结束
.如果 (不等于 (.内容, “”))
    
.否则
    信息框 (“请选择或填写发票类型！”, 0, )
    返回 ()
.如果结束
.如果 (不等于 (.内容, “”))
    
.否则
    信息框 (“请选择或填写类别！”, 0, )
    返回 ()
.如果结束

以上为判断必填内容是否填写正确！

判断重复 ()

.如果真 (不等于 (N, 1))
    加记录 (.内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
    到尾记录 ()
    添加到表格 ()
    赋值 (指针原位, 取记录号 ())
    赋值 (添加记录号, 取记录号 ())
    记录指针当前位置，防止因按下“添加”按钮后，指针被置为尾记录，使显示信息出现错误。
.如果真结束
赋值 (N, 0)
经过判断重复后，判断N的值是否被改变，确定是否添加记录。
跳到 (相加 (指针原位, 1))
恢复指针原位。
取行数 ().置光标 (1)
_表格_光标位置改变 ()
返回 ()


.子程序 判断重复, 空白型, , 
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (等于 (读 (#序列号), .内容))
        信息框 (相加 (“系统中已经有＃”, .内容, “的记录！”), #信息图标, “信息：”)
        赋值 (N, 1)
    .如果真结束
    
    跳过 ()
    
.判断循环尾 ()

.子程序 _修改_被单击, 空白型, , 
.局部变量 光标行号, 空白型, , , 

赋值 (.内容, “0”)
赋值 (光标行号, 取光标行号 ())
记录光标行号当前位置。
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (等于 (.取文本 (4), 读 (#序列号)))
        填充 ()
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
    .如果真结束
    跳过 ()
.判断循环尾 ()


.子程序 清除, 空白型, , 
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)


.子程序 填充, 空白型, , 
赋值 (.内容, 读 (#采购单号))
赋值 (.内容, 读 (#进货日期))
赋值 (.内容, 读 (#品名))
赋值 (.内容, 读 (#序列号))
赋值 (.内容, 读 (#采购价格))
赋值 (.内容, 读 (#采购员))
赋值 (.内容, 读 (#供货商))
赋值 (.内容, 读 (#采购票据))
赋值 (.内容, 读 (#类别))
赋值 (.内容, 读 (#单位))

.子程序 _提交_被单击, 空白型, , 
.局部变量 光标行号, 空白型, , , 

到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (等于 (取光标行号 ().取文本 (4), 读 (#序列号)))
        修改 (.内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
        相加 (取记录号 (), 1).删除行 ()
        添加到表格 ()
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
    .如果真结束
    跳过 ()
.判断循环尾 ()

.子程序 _删除_被单击, 空白型, , 
.如果真 (不等于 (.标题, “0”))
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果真 (等于 (读 (#序列号), 取光标行号 ().取文本 (4)))
            .如果真 (等于 (信息框 (“您确认要删除当前记录吗？”, 1, ), #确认钮))
                删除 (等于 (读 (#序列号), 取光标行号 ().取文本 (4)))
                彻底删除 ()
                添加到表格 ()
            .如果真结束
            跳过 ()
        .如果真结束
        跳过 ()
    .判断循环尾 ()
.如果真结束
赋值 (.禁止, 真)
赋值 (.禁止, 真)

.子程序 _向上_被单击, 空白型, , 
相减 (取光标行号 (), 1).置光标 (取光标列号 ())
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (等于 (取光标行号 ().取文本 (4), 读 (#序列号)))
        .如果 (不等于 (取光标行号 (), 2))
            赋值 (.禁止, 假)
            填充 ()
            
        .否则
            填充 ()
            赋值 (.禁止, 真)
            赋值 (.禁止, 假)
        .如果结束
        
    .如果真结束
    跳过 ()
.判断循环尾 ()


.子程序 _向下_被单击, 空白型, , 
相加 (取光标行号 (), 1).置光标 (取光标列号 ())
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (等于 (取光标行号 ().取文本 (4), 读 (#序列号)))
        .如果 (不等于 (取光标行号 (), 取行数 ()))
            赋值 (.禁止, 假)
            填充 ()
            
        .否则
            填充 ()
            赋值 (.禁止, 假)
            赋值 (.禁止, 真)
        .如果结束
        
    .如果真结束
    跳过 ()
.判断循环尾 ()

.子程序 _表格_光标位置改变, 空白型, , 
.局部变量 光标行号, 空白型, , , 

赋值 (光标行号, 取光标行号 ())
赋值 (.禁止, 真)
赋值 (.禁止, 真)
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (等于 (光标行号.取文本 (4), 读 (#序列号)))
        填充 ()
    .如果真结束
    跳过 ()
.判断循环尾 ()


.子程序 _品名_获得焦点, 空白型, , 
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (不等于 (读 (#品名), “”))
        .如果真 (不等于 (读 (#品名), 读 (#品名).选择 ().取项目文本 ()))
            到文本 (读 (“品名”)).加入项目 ()
        .如果真结束
        
    .如果真结束
    跳过 ()
.判断循环尾 ()


.子程序 _类别_获得焦点, 空白型, , 
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (不等于 (读 (#类别), “”))
        .如果真 (不等于 (读 (#类别), 读 (#类别).选择 ().取项目文本 ()))
            到文本 (读 (“类别”)).加入项目 ()
        .如果真结束
        
    .如果真结束
    跳过 ()
.判断循环尾 ()


.子程序 _供货商_获得焦点, 空白型, , 
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (不等于 (读 (#供货商), “”))
        .如果真 (不等于 (读 (#供货商), 读 (#供货商).选择 ().取项目文本 ()))
            到文本 (读 (“供货商”)).加入项目 ()
        .如果真结束
        
    .如果真结束
    跳过 ()
.判断循环尾 ()

.子程序 显示, 空白型, , 
.局部变量 行号, 空白型, , , 


赋值 (行号, 取行数 ())
.添加行 ()
赋值 (相加 (1))
行号.置文本 (1, 读 (#品名))
行号.置文本 (2, 读 (#进货日期))
行号.置文本 (3, 读 (#采购单号))
行号.置文本 (4, 读 (#序列号))
行号.置文本 (5, 读 (#采购价格))
行号.置文本 (6, 读 (#采购员))
行号.置文本 (7, 读 (#供货商))
行号.置文本 (8, 读 (#采购票据))
行号.置文本 (9, 读 (#类别))
行号.置文本 (10, 读 (#单位))


.子程序 添加到表格, 空白型, , 
赋值 (.内容, “0”)
.如果真 (等于 (相加 (取运行目录 (), “\sjk\库存单.grd”).从文件读 (), 假))
    信息框 (“打开添加单模板失败！”, 相加 (#确认钮, #错误图标), “错误”)
    返回 ()
.如果真结束
保存更改 ()
填写表头。
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (并且 (等于 (读 (#进货日期), .内容), 等于 (读 (#销售日期), “”)))
        显示 ()
        全部选择 ()
        赋值 (.标题, 到文本 (取选择行数 ()))
        赋值 (.标题, “总件数：”)
    .如果真结束
    跳过 ()
.判断循环尾 ()
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (等于 (读 (#进货日期), .内容))
        填充 ()
        跳出循环 ()
    .如果真结束
    跳过 ()
.判断循环尾 ()


.子程序 _计算_被单击, 空白型, , 
.局部变量 进货总额, 空白型, , , 

赋值 (.内容, “0”)
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (等于 (.内容, 读 (#进货日期)))
        赋值 (进货总额, 到数值 (读 (#采购价格)))
        赋值 (.内容, 到文本 (相加 (到数值 (.内容), 进货总额)))
    .如果真结束
    跳过 ()
.判断循环尾 ()


.子程序 _进货日期_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    添加到表格 ()
.如果真结束


.子程序 _付款单_被单击, 空白型, , 
载入 (付款清单, , 真)

.窗口程序集 销售程序窗口, , , 

.子程序 _销售窗口_创建完毕, 空白型, , 
打开 (到文本 (相加 (取运行目录 (), “\sjk\ybwl.edb”)), , , , , , )
赋值 (.内容, “0”)
赋值 (.内容, 到文本 (到数值 (读配置项 (相加 (取运行目录 (), “\”, “系统信息.ini”), “销售单号”, “销售单号”, ))))
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (不等于 (读 (#销售票据), “”))
        .如果真 (不等于 (读 (#销售票据), 读 (#销售票据).选择 ().取项目文本 ()))
            到文本 (读 (“销售票据”)).加入项目 ()
        .如果真结束
        
    .如果真结束
    跳过 ()
.判断循环尾 ()

到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (不等于 (读 (#销售员), “”))
        .如果真 (不等于 (读 (#销售员), 读 (#销售员).选择 ().取项目文本 ()))
            到文本 (读 (“销售员”)).加入项目 ()
        .如果真结束
        
    .如果真结束
    跳过 ()
.判断循环尾 ()

到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (等于 (读 (#销售单号), .内容))
        添加到销售 ()
    .如果真结束
    跳过 ()
.判断循环尾 ()
填客户信息 ()

.子程序 _类别组合框_列表项被选择, 空白型, , 
.如果真 (等于 (相加 (取运行目录 (), “\sjk\库存单.grd”).从文件读 (), 假))
    信息框 (“打开库存单模板失败！”, 相加 (#确认钮, #错误图标), “错误”)
    返回 ()
.如果真结束
保存更改 ()

到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (并且 (等于 (读 (#销售日期), “”), 等于 (读 (#类别), .内容)))
        赋值 (库存记录号, 取记录号 ())
        显示库存 ()
    .如果真结束
    跳过 ()
.判断循环尾 ()

.子程序 _添加_被单击, 空白型, , 
.局部变量 售价, 小数型, , , 

赋值 (售价, 0)
.如果 (不等于 (.内容, “”))
    
.否则
    信息框 (“请输入销售日期！”, 0, )
    返回 ()
.如果结束
.如果 (不等于 (.内容, “”))
    
.否则
    信息框 (“请输入销售单号！”, 0, )
    返回 ()
.如果结束
.如果 (不等于 (.内容, “”))
    
.否则
    信息框 (“请输入客户名称！”, 0, )
    返回 ()
.如果结束
.如果 (不等于 (.内容, “”))
    
.否则
    信息框 (“请输入联系电话！”, 0, )
    返回 ()
.如果结束
.如果 (不等于 (.内容, “”))
    
.否则
    信息框 (“请输入联系地址！”, 0, )
    返回 ()
.如果结束
.如果 (不等于 (.内容, “”))
    
.否则
    信息框 (“请输入销售票据类型！”, 0, )
    返回 ()
.如果结束
.如果 (不等于 (.内容, “”))
    
.否则
    信息框 (“请输入销售员名称！”, 0, )
    返回 ()
.如果结束

跳到 (取光标行号 ())
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (等于 (读 (#序列号), 取光标行号 ().取文本 (4)))
        .如果真 (等于 (输入框 (“请确保您输入的价格正确！”, “请输入销售价格！”, “0”, 售价, ), 真))
            .如果 (小于或等于 (相减 (售价, 到数值 (读 (#采购价格))), 0))
                .如果真 (等于 (输入框 (“您刚才输入的销售价格经核算，利润额等于或小于0，请重新输入确认！”, “请输入销售价格！”, “0”, 售价, 3), 真))
                    修改 (.内容, .内容, 数值到格式文本 (售价, 2, 假), .内容, .内容, .内容, .内容, 数值到格式文本 (相减 (售价, 到数值 (读 (#采购价格))), 2, 假), .内容)
                    _类别组合框_列表项被选择 ()
                    添加到销售 ()
                .如果真结束
                
            .否则
                修改 (.内容, .内容, 数值到格式文本 (售价, 2, 假), .内容, .内容, .内容, .内容, 数值到格式文本 (相减 (售价, 到数值 (读 (#采购价格))), 2, 假), .内容)
                _类别组合框_列表项被选择 ()
                添加到销售 ()
            .如果结束
            
        .如果真结束
        
    .如果真结束
    跳过 ()
.判断循环尾 ()

.如果 (大于 (取行数 (), 1))
    
.否则
    信息框 (“请选择销售内容！”, 0, )
    返回 ()
.如果结束

赋值 (.内容, “0”)
赋值 (.禁止, 假)


.子程序 添加到销售, 空白型, , 
.如果真 (等于 (相加 (取运行目录 (), “\sjk\出库单.grd”).从文件读 (), 假))
    信息框 (“打开库存单模板失败！”, 相加 (#确认钮, #错误图标), “错误”)
    返回 ()
.如果真结束
保存更改 ()

到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (等于 (读 (#销售单号), .内容))
        显示销售 ()
        全部选择 ()
        赋值 (.标题, 到文本 (取选择行数 ()))
    .如果真结束
    跳过 ()
.判断循环尾 ()


.子程序 _删除_被单击, 空白型, , 
.如果真 (不等于 (.标题, “0”))
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果真 (等于 (读 (#序列号), 取光标行号 ().取文本 (3)))
            .如果真 (等于 (信息框 (“您确认要删除当前记录吗？”, 1, ), #确认钮))
                修改 (“”, “”, “”, “”, “”, “”, “”, “”, “”, “”)
                _类别组合框_列表项被选择 ()
                添加到销售 ()
            .如果真结束
            跳过 ()
        .如果真结束
        跳过 ()
    .判断循环尾 ()
    赋值 (.内容, “0”)
.如果真结束


.子程序 _计算_被单击, 空白型, , 
.局部变量 当前利润额, 小数型, , , 

赋值 (.内容, “0”)
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (等于 (.内容, 读 (#销售单号)))
        赋值 (当前利润额, 到数值 (读 (#利润额)))
        赋值 (.内容, 数值到格式文本 (相加 (到数值 (.内容), 当前利润额), 2, 假))
    .如果真结束
    跳过 ()
.判断循环尾 ()


.子程序 _客户名称组合框_列表项被选择, 空白型, , 
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (等于 (.取项目文本 (.现行选中项), 读 (#客户名称)))
        赋值 (.内容, 读 (#联系电话))
        赋值 (.内容, 读 (#联系地址))
    .如果真结束
    跳过 ()
.判断循环尾 ()


.子程序 _打印项_被单击, 空白型, , 
载入 (销售提货单打印, , 真)

.子程序 _类别组合框_获得焦点, 空白型, , 
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (不等于 (读 (#类别), “”))
        .如果真 (不等于 (读 (#类别), 读 (#类别).选择 ().取项目文本 ()))
            到文本 (读 (“类别”)).加入项目 ()
        .如果真结束
        
    .如果真结束
    跳过 ()
.判断循环尾 ()


.子程序 _客户名称组合框_获得焦点, 空白型, , 
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (不等于 (读 (#客户名称), “”))
        .如果真 (不等于 (读 (#客户名称), 读 (#客户名称).选择 ().取项目文本 ()))
            到文本 (读 (“客户名称”)).加入项目 ()
        .如果真结束
        
    .如果真结束
    跳过 ()
.判断循环尾 ()


.子程序 显示库存, 空白型, , 
.局部变量 行号, 整数型, , , 

跳到 (库存记录号)
赋值 (行号, 取行数 ())
.添加行 ()
赋值 (行号, 相加 (行号, 1))
行号.置文本 (1, 读 (#品名))
行号.置文本 (2, 读 (#进货日期))
行号.置文本 (3, 读 (#采购单号))
行号.置文本 (4, 读 (#序列号))
行号.置文本 (5, 读 (#采购价格))
行号.置文本 (6, 读 (#采购员))
行号.置文本 (7, 读 (#供货商))
行号.置文本 (8, 读 (#采购票据))
行号.置文本 (9, 读 (#类别))
行号.置文本 (10, 读 (#单位))
赋值 (.标题, 相加 (“共  ”, 到文本 (相减 (行号, 1)), “  件”))

.子程序 显示销售, 空白型, , 
.局部变量 行号, 空白型, , , 

赋值 (行号, 取行数 ())
.添加行 ()
赋值 (相加 (1))
行号.置文本 (2, 读 (#品名))
行号.置文本 (5, 读 (#销售价格))
行号.置文本 (7, 读 (#利润额))
行号.置文本 (3, 读 (#序列号))
行号.置文本 (6, 读 (#采购价格))
行号.置文本 (1, 读 (#类别))
行号.置文本 (4, 读 (#单位))

.子程序 _新销售单_被单击, 空白型, , 

赋值 (.内容, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 到文本 (取月份 (取现行时间 ())), “月”, 到文本 (取日 (取现行时间 ())), “日”))
写配置项 (相加 (取运行目录 (), “\”, “系统信息.ini”), “销售单号”, “销售单号”, 到文本 (相加 (到数值 (读配置项 (相加 (取运行目录 (), “\”, “系统信息.ini”), “销售单号”, “销售单号”, )), 1)))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\”, “系统信息.ini”), “销售单号”, “销售单号”, ))
.如果真 (等于 (相加 (取运行目录 (), “\sjk\出库单.grd”).从文件读 (), 假))
    信息框 (“打开库存单模板失败！”, 相加 (#确认钮, #错误图标), “错误”)
    返回 ()
.如果真结束
保存更改 ()
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 真)
赋值 (.输入方式, 1)

.子程序 _销售单号_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (相加 (取运行目录 (), “\sjk\出库单.grd”).从文件读 (), 假))
    信息框 (“打开库存单模板失败！”, 相加 (#确认钮, #错误图标), “错误”)
    返回 ()
.如果真结束
保存更改 ()

.如果真 (等于 (键代码, 13))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果真 (等于 (读 (#销售单号), .内容))
            添加到销售 ()
        .如果真结束
        跳过 ()
    .判断循环尾 ()
.如果真结束
填客户信息 ()

.子程序 _销售窗口_将被销毁, 空白型, , 
.如果真 (大于 (到数值 (.内容), 1000000))
    .如果 (大于 (取行数 (), 1))
        
    .否则
        写配置项 (相加 (取运行目录 (), “\”, “系统信息.ini”), “销售单号”, “销售单号”, 到文本 (相减 (到数值 (读配置项 (相加 (取运行目录 (), “\”, “系统信息.ini”), “销售单号”, “销售单号”, )), 1)))
        赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\”, “系统信息.ini”), “销售单号”, “销售单号”, ))
        赋值 (.禁止, 假)
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
        赋值 (.输入方式, 0)
        添加到销售 ()
        返回 ()
        
    .如果结束
    赋值 (.内容, “0”)
    赋值 (.禁止, 假)
    
.如果真结束


.子程序 _清除空单_被单击, 空白型, , 
.如果真 (大于 (到数值 (.内容), 1000000))
    .如果 (大于 (取行数 (), 1))
        
    .否则
        写配置项 (相加 (取运行目录 (), “\”, “系统信息.ini”), “销售单号”, “销售单号”, 到文本 (相减 (到数值 (读配置项 (相加 (取运行目录 (), “\”, “系统信息.ini”), “销售单号”, “销售单号”, )), 1)))
        赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\”, “系统信息.ini”), “销售单号”, “销售单号”, ))
        赋值 (.禁止, 假)
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
        赋值 (.输入方式, 0)
        添加到销售 ()
        返回 ()
        
    .如果结束
    赋值 (.内容, “0”)
    赋值 (.禁止, 假)
.如果真结束


.子程序 _修改_被单击, 空白型, , 
.如果真 (并且 (大于 (到数值 (.内容), 1000000), 大于 (取行数 (), 1)))
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 真)
.如果真结束


.子程序 填客户信息, 空白型, , 
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (等于 (读 (#销售单号), .内容))
        填充销售 ()
        跳出循环 ()
    .如果真结束
    跳过 ()
.判断循环尾 ()


.子程序 填充销售, 空白型, , 
赋值 (.内容, 读 (#销售日期))
赋值 (.内容, 读 (#销售单号))
赋值 (.内容, 读 (#销售单号))
赋值 (.内容, 读 (#联系电话))
赋值 (.内容, 读 (#联系地址))
赋值 (.内容, 读 (#销售票据))
赋值 (.内容, 读 (#销售员))

.窗口程序集 销售提货单, , , 

.子程序 _销售提货单打印_创建完毕, 空白型, , 
赋值 (数量, 0)
赋值 (总金额, 0)
赋值 (末尾, 0)
创建表头 ()
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (并且 (等于 (读 (#销售单号), 销售窗口..内容), 等于 (读 (#状态), “”)))
        赋值 (当前品名, 读 (#品名))
        判断同品名 ()
    .如果真结束
    跳过 ()
.判断循环尾 ()

.子程序 判断同品名, 空白型, , 
赋值 (数量, 0)
赋值 (当前行号, 取记录号 ())
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (并且 (等于 (读 (#销售单号), 销售窗口..内容), 等于 (读 (#品名), 当前品名)))
        赋值 (数量, 相加 (数量, 1))
        修改 (“1”)
    .如果真结束
    跳过 ()
.判断循环尾 ()
填写 ()

.子程序 创建表头, 空白型, , 
.如果真 (等于 (相加 (取运行目录 (), “\sjk\提货单.grd”).从文件读 (), 假))
    信息框 (“打开提货单模板失败！”, 相加 (#确认钮, #错误图标), “错误”)
    返回 ()
.如果真结束

1.置文本 (1, 读配置项 (相加 (取运行目录 (), “\”, “用户信息.ini”), “用户信息”, “用户名称”, ))
保存更改 ()
1.添加行 ()
3.合并 (1, , 7)
3.置对齐方式 (1, , , #中中)
3.置文本 (1, 到文本 (销售窗口..内容))
1.添加行 ()
4.合并 (1, , 5)
4.置文本 (1, 相加 (“客户名称：”, 到文本 (销售窗口..内容)))
4.置文本 (6, “No.”)
4.置对齐方式 (6, , 1, #中右)
4.置文本 (7, 到文本 (销售窗口..内容))
1.添加行 ()
5.置文本 (1, “序号”)
5.置文本 (2, “类 别”)
5.置文本 (3, “货    物    名    称”)
5.置文本 (4, “单位”)
5.置文本 (5, “数量”)
5.置文本 (6, “单  价”)
5.置文本 (7, “小  计”)
5.置对齐方式 (1, , 7, #中中)
5.置表头行数 ()
5.加线条 (1, 1, 7, 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))

.子程序 填写, 空白型, , 
.局部变量 开始行号, 整数型, , , 
.局部变量 行号, 整数型, , , 
.局部变量 行数, 整数型, , , 

跳到 (当前行号)
保存更改 ()
连续赋值 (相加 (取行数 (), 1), 开始行号, 行号)

.添加行 ()
行号.置文本 (1, 到文本 (相减 (行号, 5)))
行号.置对齐方式 (1, , , #中中)
行号.置文本 (2, 读 (#类别))
行号.置文本 (3, 当前品名)
行号.置文本 (4, 读 (#单位))
行号.置对齐方式 (4, , , #中中)
行号.置文本 (5, 到文本 (数量))
行号.置对齐方式 (5, , , #中中)
行号.置文本 (6, 读 (“销售价格”))
行号.置对齐方式 (6, , , #中右)
行号.置文本 (7, 数值到格式文本 (相乘 (到数值 (读 (#销售价格)), 数量), 2, 假))
行号.置对齐方式 (7, , , #中右)
赋值 (总金额, 相加 (总金额, 相乘 (到数值 (读 (#销售价格)), 数量)))
赋值 (末尾, 相加 (末尾, 数量))
赋值 (行号, 相加 (行号, 1))


.如果真 (等于 (到文本 (末尾), 销售窗口..标题))
    赋值 (行数, 相减 (行号, 4))
    6.加线条 (1, 行数, 7, 相加 (#左边框, #上边框, #右边框, #下边框, #垂直线))
    .添加行 ()
    行号.合并 (1, , 2)
    行号.置文本 (1, “合   计：”)
    行号.置对齐方式 (1, , , #中中)
    行号.置文本 (3, 相加 (“大写：”, 到文本 (数值到金额 (总金额, 假))))
    行号.置文本 (7, 数值到格式文本 (总金额, 2, 假))
    行号.置对齐方式 (7, , , #中右)
    到数值 (行号).加线条 (1, 1, 7, 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))
    
    .添加行 ()
    赋值 (行号, 相加 (行号, 1))
    行号.合并 (1, , 5)
    行号.置文本 (1, 相加 (“送货地址： ”, 销售窗口..内容))
    行号.置文本 (6, “票据类型：”)
    行号.置对齐方式 (6, , , #中中)
    行号.置文本 (7, 销售窗口..内容)
    行号.置对齐方式 (7, , , #中中)
    .添加行 ()
    赋值 (行号, 相加 (行号, 1))
    行号.合并 (1, , 7)
    行号.置文本 (1, 相加 (“联系电话： ”, 销售窗口..内容))
    
    赋值 (行数, 相加 (相减 (行号, 开始行号), 2))
    到数值 (相减 (行号, 1)).加线条 (1, 2, 7, 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))
    .添加行 ()
    赋值 (行号, 相加 (行号, 1))
    行号.合并 (1, , 7)
    行号.置文本 (1, “           开单：                            送货人：                            收货人：”)
.如果真结束


.子程序 _打印预览_被单击, 空白型, , 
打印预览 ()

.子程序 _打印设置_被单击, 空白型, , 
打印设置 ()

.子程序 _打印_被单击, 空白型, , 
.打印 (“销售提货单”)

.子程序 _销售提货单打印_将被销毁, 空白型, , 
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (等于 (读 (#状态), “1”))
        修改 (“”)
    .如果真结束
    跳过 ()
.判断循环尾 ()
赋值 (总金额, 0)
赋值 (末尾, 0)

.窗口程序集 系统配置, , , 

.子程序 _确定_被单击, 空白型, , 
写配置项 (相加 (取运行目录 (), “\”, “用户信息.ini”), “用户信息”, “用户名称”, .内容)
写配置项 (相加 (取运行目录 (), “\”, “用户信息.ini”), “用户信息”, “联系人”, .内容)
写配置项 (相加 (取运行目录 (), “\”, “用户信息.ini”), “用户信息”, “联系电话”, .内容)

.子程序 _系统设置_创建完毕, 空白型, , 
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\”, “用户信息.ini”), “用户信息”, “用户名称”, ))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\”, “用户信息.ini”), “用户信息”, “联系人”, ))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\”, “用户信息.ini”), “用户信息”, “联系电话”, ))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\”, “系统信息.ini”), “销售单号”, “销售单号”, ))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\”, “系统信息.ini”), “备份路径”, “备份路径”, ))

.子程序 _确定1_被单击, 空白型, , 
写配置项 (相加 (取运行目录 (), “\”, “供货商信息.ini”), .内容, “供货商名称”, .内容)
写配置项 (相加 (取运行目录 (), “\”, “供货商信息.ini”), .内容, “联系人”, .内容)
写配置项 (相加 (取运行目录 (), “\”, “供货商信息.ini”), .内容, “联系电话”, .内容)
写配置项 (相加 (取运行目录 (), “\”, “供货商信息.ini”), .内容, “开户行”, .内容)
写配置项 (相加 (取运行目录 (), “\”, “供货商信息.ini”), .内容, “帐号”, .内容)


.子程序 _确定2_被单击, 空白型, , 
写配置项 (相加 (取运行目录 (), “\”, “系统信息.ini”), “销售单号”, “销售单号”, .内容)
写配置项 (相加 (取运行目录 (), “\”, “系统信息.ini”), “备份路径”, “备份路径”, .内容)

.窗口程序集 付款清单, , , 

.子程序 _付款清单_创建完毕, 空白型, , 
赋值 (总金额, 0)
创建清单表头 ()
赋值 (末尾, 0)
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (并且 (等于 (读 (#进货日期), 进货窗口..内容), 等于 (读 (#状态), “”)))
        赋值 (当前供货商, 读 (#供货商))
        判断同名 ()
    .如果真结束
    跳过 ()
.判断循环尾 ()


.子程序 判断同名, 空白型, , 
赋值 (当前行号, 取记录号 ())
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (并且 (等于 (读 (#进货日期), 进货窗口..内容), 等于 (读 (#供货商), 当前供货商)))
        赋值 (金额, 相加 (到数值 (读 (#采购价格)), 金额))
        赋值 (末尾, 相加 (末尾, 1))
        修改 (“1”)
    .如果真结束
    跳过 ()
.判断循环尾 ()
填清单 ()


.子程序 创建清单表头, 空白型, , 
.如果真 (等于 (相加 (取运行目录 (), “\sjk\付款清单.grd”).从文件读 (), 假))
    信息框 (“打开付款清单模板失败！”, 相加 (#确认钮, #错误图标), “错误”)
    返回 ()
.如果真结束
1.置文本 (1, 读配置项 (相加 (取运行目录 (), “\”, “用户信息.ini”), “用户信息”, “用户名称”, ))
2.置文本 (1, 相加 (进货窗口..内容, “付款清单”))
3.加线条 (1, 1, 8, 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))
保存更改 ()

.子程序 填清单, 空白型, , 
.局部变量 开始行号, 整数型, , , 
.局部变量 行号, 整数型, , , 
.局部变量 行数, 整数型, , , 
.局部变量 件数, 整数型, , , 

赋值 (件数, 0)
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (等于 (读 (#进货日期), 进货窗口..内容))
        赋值 (件数, 相加 (件数, 1))
    .如果真结束
    跳过 ()
.判断循环尾 ()

跳到 ()
保存更改 ()
连续赋值 (相加 (取行数 (), 1), 开始行号, 行号)

.添加行 ()
行号.置文本 (1, 到文本 (相减 (行号, 3)))
行号.置对齐方式 (1, , , #中中)
行号.置文本 (2, 当前供货商)
行号.置文本 (3, 读配置项 (相加 (取运行目录 (), “\”, “供货商信息.ini”), 当前供货商, “联系人”, ))
行号.置对齐方式 (3, , , #中中)
行号.置文本 (4, 读配置项 (相加 (取运行目录 (), “\”, “供货商信息.ini”), 当前供货商, “联系电话”, ))
行号.置文本 (5, 读配置项 (相加 (取运行目录 (), “\”, “供货商信息.ini”), 当前供货商, “开户行”, ))
行号.置文本 (6, 读配置项 (相加 (取运行目录 (), “\”, “供货商信息.ini”), 当前供货商, “帐号”, ))
行号.置文本 (7, 数值到格式文本 (金额, 2, 假))
行号.置对齐方式 (7, , , #中右)
赋值 (总金额, 相加 (总金额, 金额))
赋值 (金额, 0)
赋值 (行号, 相加 (行号, 1))
.如果真 (等于 (末尾, 件数))
    赋值 (行数, 相减 (行号, 4))
    4.加线条 (1, 行数, 8, 相加 (#左边框, #上边框, #右边框, #下边框, #垂直线))
    .添加行 ()
    行号.置文本 (1, “合计：”)
    行号.置对齐方式 (1, , , #中中)
    行号.合并 (2, , 5)
    行号.置文本 (2, 相加 (“大写：”, 到文本 (数值到金额 (总金额, 假))))
    行号.置文本 (7, 数值到格式文本 (总金额, 2, 假))
    行号.置对齐方式 (7, , , #中右)
    到数值 (行号).加线条 (1, 1, 8, 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))
.如果真结束


.子程序 _付款清单_将被销毁, 空白型, , 
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 ()

.子程序 _打印设置_被单击, 空白型, , 
打印设置 ()

.子程序 _打印预览_被单击, 空白型, , 
打印预览 ()

.子程序 _打印_被单击, 空白型, , 
.打印 (“付款清单”)

.窗口程序集 恢复备份, , , 

.子程序 _按钮1_被单击, 空白型, , 
.如果真 (等于 (信息框 (“您确定要恢复备份一吗？”, 1, ), #确认钮))
    复制文件 (相加 (读配置项 (相加 (取运行目录 (), “\系统信息.ini”), “备份路径”, “备份路径”, ), “BAK1.dat”), 相加 (取运行目录 (), “\sjk\ybwl.edb”))
.如果真结束
销毁 ()

.子程序 _按钮2_被单击, 空白型, , 
.如果真 (等于 (信息框 (“您确定要恢复备份一吗？”, 1, ), #确认钮))
    复制文件 (相加 (读配置项 (相加 (取运行目录 (), “\系统信息.ini”), “备份路径”, “备份路径”, ), “BAK2.dat”), 相加 (取运行目录 (), “\sjk\ybwl.edb”))
.如果真结束
销毁 ()


 ' 不属于任何一个程序集、类模块的函数：
