 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.wodesoft.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.wodesoft.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.wodesoft.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 416
    高度 = 395
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “桌面墙纸设置”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库




数据类型 GUID, , 
    .成员 DATA1, 整数型, , , 
    .成员 DATA2, 短整数型, , , 
    .成员 DATA3, 短整数型, , , 
    .成员 DATA4, 字节型, , "8", 

数据类型 COMPONENTSOPT, , 
    .成员 dwSize, 空白型, , , 
    .成员 fEnableComponents, 逻辑型, , , 
    .成员 fActiveDesktop, 逻辑型, , , 


.DLL命令 CoCreateInstance, 整数型, "ole32.dll", "", , 
    .参数 CLSID, GUID, , 
    .参数 pUnkOuter, 空白型, , 
    .参数 服务器类型, 空白型, , 
    .参数 接口的IID, GUID, , 
    .参数 接口指针的地址, 空白型, 传址, 

.DLL命令 IIDFromString, 整数型, "ole32.dll", "", , 
    .参数 lpszIID, 字节集, , 
    .参数 iid, GUID, , 

.DLL命令 CoInitialize, 整数型, "ole32.dll", "", , 
    .参数 k, 空白型, , 

.DLL命令 StringFromIID, 空白型, "ole32.dll", "", , 
    .参数 lpszIID, GUID, , 
    .参数 iid, 空白型, 传址, 

.DLL命令 MultiByteToWideChar, 整数型, "", "", , 
    .参数 CodePage, 空白型, , 
    .参数 dwFlags, 空白型, , 
    .参数 lpWideCharStr, 文本型, , 
    .参数 cchWideChar, 空白型, , 
    .参数 lpMultiByteStr, 字节集, , 
    .参数 cchMultiByte, 空白型, , 

.DLL命令 取文本地址, 整数型, "aaa.dll", "取变量地址", , 
    .参数 aa, 文本型, , 

.DLL命令 取字节集地址, 整数型, "aaa.dll", "取变量地址", , 
    .参数 aa, 字节集, , 

.DLL命令 取整数地址, 整数型, "aaa.dll", "取变量地址", , 
    .参数 aa, 空白型, 传址, 

.DLL命令 CallWindowProcA, 整数型, "", "", , 
    .参数 lpPrevWndFunc, 空白型, , 
    .参数 hwnd, 空白型, , 
    .参数 msg, 空白型, , 
    .参数 wParam, 空白型, , 
    .参数 iparam, 空白型, , 

.DLL命令 取长整数地址, 整数型, "aaa.dll", "取变量地址", , 
    .参数 aa, 长整数型, 传址, 

.DLL命令 IIDFromString1, 整数型, "ole32.dll", "IIDFromString", , 
    .参数 lpszIID, 字节集, , 
    .参数 iid, 字节集, , 

.DLL命令 CoUninitialize, 空白型, "ole32.dll", "", , 

.DLL命令 WideCharToMultiByte, 整数型, "", "", , 
    .参数 CodePage, 空白型, , 
    .参数 dwFlags, 空白型, , 
    .参数 lpWideCharStr, 空白型, , 
    .参数 cchWideChar, 空白型, , 
    .参数 lpMultiByteStr, 字节集, , 
    .参数 cchMultiByte, 空白型, , 
    .参数 lpDefaultChar, 空白型, , 
    .参数 lpUsedDefaultChar, 空白型, , 

.DLL命令 OleCreatePropertyFrame, 整数型, "olepro32.dll", "OleCreatePropertyFrame", , 
    .参数 a, 空白型, , 
    .参数 b, 空白型, , 
    .参数 c, 空白型, , 
    .参数 d, 空白型, , 
    .参数 e, 空白型, , 
    .参数 f, 空白型, , 
    .参数 g, 空白型, , 
    .参数 h, 空白型, , 
    .参数 i, 空白型, , 
    .参数 j, 空白型, , 
    .参数 k, 空白型, , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 参数列表, 空白型, , "10", 
.程序集变量 接口入口指针, 空白型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
 ' --========  易语言资源网  (www.wodesoft.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.wodesoft.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.wodesoft.com  ================--

CoInitialize (0)


.子程序 到可变字符, 文本型, , 
.参数 地址, 空白型, , 

.局部变量 转换后文本, 字节集, , , 
.局部变量 转换长度, 空白型, , , 

赋值 (转换长度, WideCharToMultiByte (936, 0, 地址, -1, 转换后文本, 0, 0, 0))
赋值 (转换后文本, 取空白字节集 (相加 (转换长度, 1)))
赋值 (转换长度, WideCharToMultiByte (936, 0, 地址, -1, 转换后文本, 转换长度, 0, 0))
返回 (取文本左边 (到文本 (转换后文本), 转换长度))

.子程序 运行子程序, 整数型, , 
.参数 子程序入口地址, 空白型, , 
.参数 参数个数, 空白型, 可空, 
.参数 参数指针, 空白型, 可空, 

.局部变量 参数lll, 字节集, , , 
.局部变量 n, 整数型, , , 
.局部变量 运行代码, 字节集, , , 

赋值 (运行代码, {  })
.计次循环首 (参数个数, n)
    赋值 (参数lll, 指针到字节集 (相加 (参数指针, 相乘 (相减 (参数个数, n), 4)), 4))
    赋值 (运行代码, 相加 (运行代码, { 104 }, 参数lll)) ' 形成压栈代码
.计次循环尾 ()
赋值 (运行代码, 相加 (运行代码, { 255, 21 }, 到字节集 (子程序入口地址), { 194, 16, 0 })) ' 形成调用代码
返回 (CallWindowProcA (取字节集地址 (运行代码), 0, 0, 0, 0)) ' 运行形成的代码并返回
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 到宽字符, 字节集, , 
.参数 待转换文本, 文本型, , 

.局部变量 转换后文本, 字节集, , , 
.局部变量 转换长度, 空白型, , , 

赋值 (转换后文本, 取空白字节集 (相乘 (取文本长度 (待转换文本), 2)))
赋值 (转换长度, MultiByteToWideChar (936, 0, 待转换文本, 取文本长度 (待转换文本), 转换后文本, 相乘 (取文本长度 (待转换文本), 2)))
返回 (取字节集左边 (转换后文本, 相乘 (转换长度, 2)))

.子程序 读数, 整数型, , 
.参数 地址, 空白型, , 

.局部变量 a, 字节集, , , 

赋值 (a, 指针到字节集 (地址, 4))
.如果真 (等于 (取字节集长度 (a), 4))
    返回 (相加 (相乘 (a [4], 256, 256, 256), 相乘 (a [3], 256, 256), 相乘 (a [2], 256), a [1]))
.如果真结束
返回 (0)

.子程序 _按钮2_被单击, 空白型, , 
.如果 (文件是否存在 (.))
    .如果 (设置墙纸 (., .))
        赋值 (., “设置成功！”)
    .否则
        赋值 (., “设置失败!”)
    .如果结束
     ' 本源码来自易语言资源网(www.wodesoft.com)
.否则
    信息框 (“请输入正确的文件名!”, 0, )
.如果结束


.子程序 _按钮3_被单击, 空白型, , 
打开 ()
.如果真 (不等于 (., “”))
    赋值 (., 读入文件 (.))
    赋值 (., .)
.如果真结束


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 文件名缓冲, 字节集, , , 
.局部变量 文件名, 文本型, , , 
.局部变量 a, 空白型, , , 
.局部变量 样式, 空白型, , "2", 
.局部变量 匿名局部变量_178, 空白型, , , 
.局部变量 clsid, GUID, , , 
.局部变量 信息标记, 字节集, , , 
.局部变量 iid, GUID, , , 
.局部变量 标志, 字节集, , , 
.局部变量 匿名局部变量_179, 空白型, , , 

赋值 (信息标记, 相加 (到宽字符 (“{75048700-EF1F-11D0-9888-006097DEACF9}”), { 0, 0 }))
IIDFromString (信息标记, clsid)
赋值 (信息标记, 相加 (到宽字符 (“{F490EB00-1240-11D1-9888-006097DEACF9}”), { 0, 0 }))
IIDFromString (信息标记, iid)
赋值 (a, CoCreateInstance (clsid, 0, 1, iid, 接口入口指针))
.如果真 (不等于 (接口入口指针, 0))
    赋值 (文件名缓冲, 取空白字节集 (260))
    赋值 (参数列表 [1], 接口入口指针)
    赋值 (参数列表 [2], 取字节集地址 (文件名缓冲))
    赋值 (参数列表 [3], 260)
    赋值 (参数列表 [4], 0)
    赋值 (a, 运行子程序 (相加 (读数 (接口入口指针), 16), 4, 取整数地址 (参数列表 [1]))) ' GetWallpaper ( wszWallpaper, MAX_PATH, 0 )
    .如果 (等于 (a, 0))
        赋值 (文件名, 到文本 (到可变字符 (取字节集地址 (文件名缓冲))))
        赋值 (., 文件名)
        赋值 (., 读入文件 (文件名))
        赋值 (参数列表 [1], 接口入口指针)
        赋值 (样式 [1], 8)
        赋值 (参数列表 [2], 取整数地址 (样式 [1]))
        赋值 (参数列表 [3], 0)
        赋值 (a, 运行子程序 (相加 (读数 (接口入口指针), 24), 3, 取整数地址 (参数列表 [1])))
        .如果 (等于 (a, 0))
            赋值 (., 样式 [2])
        .否则
            信息框 (“样式获取失败”, 0, )
        .如果结束
         ' 本源码来自易语言资源网(www.wodesoft.com)
    .否则
        信息框 (“获取失败”, 0, )
    .如果结束
    运行子程序 (相加 (读数 (接口入口指针), 8), 1, 取整数地址 (参数列表 [1])) ' 释放接口
    返回 ()
.如果真结束

信息框 (“创建对象失败”, 0, )



.子程序 设置墙纸, 逻辑型, , 
.参数 文件名, 文本型, , 
.参数 样式, 空白型, , 

.局部变量 文件名缓冲, 字节集, , , 
.局部变量 a, 空白型, , , 
.局部变量 样式格式组, 空白型, , "2", 
.局部变量 匿名局部变量_199, 空白型, , , 
.局部变量 clsid, GUID, , , 
.局部变量 信息标记, 字节集, , , 
.局部变量 iid, GUID, , , 
.局部变量 标志, 字节集, , , 
.局部变量 匿名局部变量_204, 空白型, , , 

赋值 (信息标记, 相加 (到宽字符 (“{75048700-EF1F-11D0-9888-006097DEACF9}”), { 0, 0 }))
IIDFromString (信息标记, clsid)
赋值 (信息标记, 相加 (到宽字符 (“{F490EB00-1240-11D1-9888-006097DEACF9}”), { 0, 0 }))
IIDFromString (信息标记, iid)
赋值 (a, CoCreateInstance (clsid, 0, 1, iid, 接口入口指针))
.如果真 (不等于 (接口入口指针, 0))
    赋值 (文件名缓冲, 相加 (到宽字符 (文件名), 取空白字节集 (2)))
    赋值 (参数列表 [1], 接口入口指针)
    赋值 (参数列表 [2], 取字节集地址 (文件名缓冲))
    赋值 (参数列表 [3], 0)
    赋值 (a, 运行子程序 (相加 (读数 (接口入口指针), 20), 3, 取整数地址 (参数列表 [1]))) ' SetWallpaper(wszWallpaper, 0)
    .如果 (等于 (a, 0))
        赋值 (参数列表 [1], 接口入口指针)
        赋值 (样式格式组 [1], 8)
        赋值 (样式格式组 [2], 样式)
        赋值 (参数列表 [2], 取整数地址 (样式格式组 [1]))
        赋值 (参数列表 [3], 0)
        赋值 (a, 运行子程序 (相加 (读数 (接口入口指针), 28), 3, 取整数地址 (参数列表 [1])))
        .如果 (等于 (a, 0))
            赋值 (参数列表 [2], 7)
            赋值 (a, 运行子程序 (相加 (读数 (接口入口指针), 12), 2, 取整数地址 (参数列表 [1])))
            .如果真 (不等于 (a, 0))
                运行子程序 (相加 (读数 (接口入口指针), 8), 1, 取整数地址 (参数列表 [1])) ' 释放接口
                返回 (假)
            .如果真结束
             ' 本源码来自易语言资源网(www.wodesoft.com)
        .否则
            运行子程序 (相加 (读数 (接口入口指针), 8), 1, 取整数地址 (参数列表 [1])) ' 释放接口
            返回 (假)
        .如果结束
        
    .否则
        运行子程序 (相加 (读数 (接口入口指针), 8), 1, 取整数地址 (参数列表 [1])) ' 释放接口
        返回 (假)
    .如果结束
    运行子程序 (相加 (读数 (接口入口指针), 8), 1, 取整数地址 (参数列表 [1])) ' 释放接口
    返回 (真)
.如果真结束
返回 (假)


.子程序 __启动窗口_将被销毁, 空白型, , 
CoUninitialize ()



 ' 不属于任何一个程序集、类模块的函数：
