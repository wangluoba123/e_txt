 ' 文件类型：Windows模块源码

 ' 程序名称：网络时间验证
 ' 程序描述：取网络时间判断剩余使用天数
 ' 程序作者：魅~→h落№
 ' 邮政编码：
 ' 联系地址：广西百色
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：easylove520@qq.com
 ' 主页地址：http://51988676.ys168.com
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' sock A6B983789F624b2cBDFD7D671249C097 1 0 网络通讯支持库
 ' spec A512548E76954B6E92C21055517615B0 2 1 特殊功能支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库




.全局变量 现在时间, 日期时间型, , , 
.全局变量 开始时间, 日期时间型, , , 
.全局变量 总天数, 整数型, , , 

.程序集 程序集1, , , 

.程序集变量 客户1, 未知类型0x20002, , , 
.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。
输出调试文本 (置时间数据 (2008, 2, 2, 30))
输出调试文本 (取特征字 ())


.子程序 置时间数据, 整数型, , 返回值为剩余天数.整数型, 网络时间服务器参数可空,若连接服务器失败则返回-1
.参数 开始时间年份, 整数型, , 例如 2008 年则写 2008
.参数 开始时间月份, 整数型, , 例如 2月份 则写 2
.参数 开始时间日, 整数型, , 例如 30号 则写 30
.参数 天数期限, 整数型, , 例如 20天 则写 20
.参数 网络时间服务器, 文本型, 可空, 默认为203.129.68.14

赋值 (开始时间, 指定时间 (开始时间年份, 开始时间月份, 开始时间日, 0, 0, 0))
赋值 (总天数, 天数期限)
.如果真 (等于 (网络时间服务器, “”))
    赋值 (网络时间服务器, “203.129.68.14”)
.如果真结束
.如果 (等于 (客户1.未知支持库函数_8 (网络时间服务器, 13), 真))
    延迟 (100)
    数据到达 ()
    延迟 (100)
    返回 (判断剩余时间 ())
.否则
    返回 (-1)
.如果结束
返回 (0)



.子程序 数据到达, 空白型, , 取回时间数据
.局部变量 内容, 文本型, , , 
.局部变量 日, 整数型, , , 
.局部变量 月A, 文本型, , , 
.局部变量 年, 整数型, , , 
.局部变量 时, 整数型, , , 
.局部变量 分, 整数型, , , 
.局部变量 秒, 整数型, , , 
.局部变量 月, 整数型, , , 

赋值 (内容, 到文本 (客户1.未知支持库函数_10 (0)))

赋值 (日, 到整数 (取文本左边 (内容, 2)))

赋值 (月A, 取文本中间 (内容, 4, 3))

赋值 (月, 判断月份 (月A)) ' 翻译月份为中文

赋值 (年, 到整数 (取文本中间 (内容, 8, 4)))

赋值 (时, 到整数 (取文本中间 (内容, 13, 2)))

赋值 (分, 到整数 (取文本中间 (内容, 16, 2)))

赋值 (秒, 到整数 (取文本中间 (内容, 19, 2)))
输出调试文本 (“---------------------------模块作者: 魅~→h落№---------------------------”)
输出调试文本 (“”)
输出调试文本 (“------------------------模块名称: 网络时间服务器验证------------------------”)
输出调试文本 (“”)
输出调试文本 (“--------------------------E-mail:easylove520@qq.com--------------------------”)
输出调试文本 (“”)
输出调试文本 (“-----------------------资源站:http://51988676.ys168.com-----------------------”)

赋值 (现在时间, 指定时间 (年, 月, 日, 时, 分, 秒))


.子程序 判断月份, 整数型, , 判断返回的月份数据翻译成中文
.参数 月份, 文本型, , 

.判断开始 (等于 (月份, “JAN”))
    返回 (1)
.判断 (等于 (月份, “FEB”))
    返回 (2)
.判断 (等于 (月份, “MAR”))
    返回 (3)
.判断 (等于 (月份, “APR”))
    返回 (4)
.判断 (等于 (月份, “MAY”))
    返回 (5)
.判断 (等于 (月份, “JUN”))
    返回 (6)
.判断 (等于 (月份, “JUL”))
    返回 (7)
.判断 (等于 (月份, “AUG”))
    返回 (8)
.判断 (等于 (月份, “SEP”))
    返回 (9)
.判断 (等于 (月份, “OCT”))
    返回 (10)
.判断 (等于 (月份, “NOV”))
    返回 (11)
.判断 (等于 (月份, “DEC”))
    返回 (12)
.默认
    
.判断结束
返回 (0)


.子程序 判断剩余时间, 整数型, , 判断剩余天数
.如果 (小于 (相减 (取年份 (现在时间), 取年份 (开始时间), 相除 (总天数, 365)), 0))
    赋值 (总天数, 相减 (总天数, 相乘 (相减 (取年份 (现在时间), 取年份 (开始时间)), 365)))
    .如果 (小于 (相减 (取月份 (现在时间), 取月份 (开始时间), 相除 (总天数, 30)), 0))
        赋值 (总天数, 相减 (总天数, 相乘 (相减 (取月份 (现在时间), 取月份 (开始时间)), 30)))
        .如果 (小于 (相减 (取日 (现在时间), 取日 (开始时间), 总天数), 0))
            赋值 (总天数, 相减 (总天数, 相减 (取日 (现在时间), 取日 (开始时间))))
            返回 (总天数)
        .否则
            返回 (0)
        .如果结束
        
    .否则
        返回 (0)
    .如果结束
    
.否则
    返回 (0)
.如果结束


.子程序 取特征字, 文本型, , 
.局部变量 硬盘特征字, 整数型, , , 
.局部变量 cpu, 未知类型0x40003, , , 
.局部变量 cpu号, 文本型, , , 

赋值 (硬盘特征字, 取硬盘特征字 ())
未知支持库函数_17 (cpu)
赋值 (cpu号, cpu.)

.如果真 (等于 (取硬盘特征字 (), 0))
    延迟 (100)
    赋值 (硬盘特征字, 取硬盘特征字 ())
    .如果真 (等于 (取硬盘特征字 (), 0))
        延迟 (100)
        赋值 (硬盘特征字, 取硬盘特征字 ())
        .如果真 (等于 (取硬盘特征字 (), 0))
            延迟 (100)
            赋值 (硬盘特征字, 取硬盘特征字 ())
            .如果真 (等于 (取硬盘特征字 (), 0))
                赋值 (硬盘特征字, 247331517)
                
            .如果真结束
            
        .如果真结束
        
    .如果真结束
    
.如果真结束
赋值 (cpu号, 相加 (到文本 (硬盘特征字), cpu号))
赋值 (cpu号, 取字节集数据 (到字节集 (cpu号), 10, ))

返回 (cpu号)



 ' 不属于任何一个程序集、类模块的函数：
