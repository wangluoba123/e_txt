 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 432
    高度 = 510
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 16501922 '  0xFBCCA2
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' internet 707ca37322474f6ca841f0e224f4b620 2 0 互联网支持库
 ' iconv {A0005538-9391-4dd9-B4D6-8EB7B9360F08} 2 0 编码转换支持库
 ' HtmlView 5014D8FA6DCA40b68FA626D8183666EB 2 2 超文本浏览框支持库
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 2 0 XP风格界面库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 3 0 应用接口支持库





.DLL命令 新父窗口, 整数型, "user32", "SetParent", , 指定一个窗口的新父（在vb里使用：利用这个函数，vb可以多种形式支持子窗口。例如，可将控件从一个容器移至窗体中的另一个。用这个函数在窗体间移动控件是相当冒险的，但却不失为一个有效的办法。如真的这样做，请在关闭任何一个窗体之前，注意用SetParent将控件的父设回原来的那个）  前一个父窗口的句柄
    .参数 hWndChild, 整数型, , 子窗口的句柄
    .参数 hWndNewParent, 整数型, , hWndChild的新父;

.DLL命令 寻找顶级窗口, 整数型, "user32", "FindWindowA", , 寻找窗口列表中第一个符合指定条件的顶级窗口（在vb里使用：FindWindow最常见的一个用途是获得ThunderRTMain类的隐藏窗口的句柄；该类是所有运行中vb执行程序的一部分。获得句柄后，可用api函数GetWindowText取得这个窗口的名称；该名也是应用程序的标题）  找到窗口的句柄。如未找到相符窗口，则返回零。会设置GetLastError
    .参数 窗口类名, 文本型, , 指向包含了窗口类名的空中止（C语言）字串的指针；或设为零，表示接收任何类
    .参数 窗口文本, 文本型, , 指向包含了窗口文本（或标签）的空中止（C语言）字串的指针；或设为零，表示接收任何窗口标题  示例Dim hw&

.窗口程序集 窗口程序集1, , , 

.程序集变量 皮肤, 整数型, , , 
.程序集变量 缩小, 逻辑型, , , 
.程序集变量 窗口宽, 整数型, , , 
.程序集变量 配置文件地址, 文本型, , , 
.程序集变量 窗口高, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 窗口句柄, 整数型, , , 

 ' 皮肤_加载皮肤 (8)
 ' 皮肤 ＝ 1
未知支持库函数_0 (1)
赋值 (配置文件地址, 相加 (取当前目录 (), “/pz.ini”))
赋值 (窗口句柄, 寻找顶级窗口 (“Progman”, “Program Manager”)) ' Program Manager 桌面的标题
新父窗口 (取窗口句柄 (), 窗口句柄)
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

赋值 (窗口宽, _启动窗口.宽度)
赋值 (窗口高, _启动窗口.高度)
0.移动 (22, 窗口宽, 相减 (窗口高, 22))
3.移动 (窗口高, , )
相减 (窗口宽, .宽度).移动 (窗口高, , )
写组合框 ()
_组合框_一级_列表项被选择 ()
_组合框_二级_列表项被选择 ()
.如果真 (等于 (文件是否存在 (配置文件地址), 真))
    赋值 (.现行选中项, 到数值 (读配置项 (配置文件地址, “默认选项”, “一级地区”, )))
    _组合框_一级_列表项被选择 ()
    赋值 (.现行选中项, 到数值 (读配置项 (配置文件地址, “默认选项”, “二级地区”, )))
    _组合框_二级_列表项被选择 ()
    赋值 (.现行选中项, 到数值 (读配置项 (配置文件地址, “默认选项”, “三级地区”, )))
    
    输出调试文本 (到数值 (读配置项 (配置文件地址, “默认选项”, “一级菜单”, )))
.如果真结束
_按钮_查询_被单击 ()
赋值 (缩小, 假)

.子程序 读地区列表, 文本型, , 
.参数 上级地区, 文本型, 可空, 

.局部变量 变_地址, 文本型, , , 
.局部变量 变_内容, 文本型, , , 

.如果 (等于 (是否为空 (上级地区), 真))
     ' 一级菜单
     ' http://www.weather.com.cn/data/list3/city.xml
    赋值 (变_地址, “http://www.weather.com.cn/data/list3/city.xml”)
    
.否则
     ' 本源码来自易语言资源网(www.5A5X.com)
     ' 二级或三级
     ' http://www.weather.com.cn/data/list3/city"+上级地区+".xml
    赋值 (变_地址, 相加 (“http://www.weather.com.cn/data/list3/city”, 上级地区, “.xml”))
.如果结束

赋值 (变_内容, 到文本 (未知支持库函数_0 (未知支持库函数_7 (变_地址), #, #, )))
输出调试文本 (变_内容)
返回 (变_内容)

.子程序 写组合框, 空白型, , 
.参数 参_对象, 组合框, , 
.参数 参_编码, 文本型, 可空, 

.局部变量 变_地区, 文本型, , "0", 
.局部变量 变_地名, 文本型, , "0", 
.局部变量 变_计次, 整数型, , , 
.局部变量 变_编码长度, 整数型, , , 

参_对象.清空 ()
.如果真 (等于 (是否为空 (参_编码), 假))
    赋值 (变_编码长度, 取文本长度 (参_编码))
    .如果真 (或者 (等于 (变_编码长度, 1), 等于 (变_编码长度, 3), 等于 (变_编码长度, 5)))
        赋值 (参_编码, 相加 (“0”, 参_编码))
         ' 组合框数值只能存数字，不能存文字，所以要补码
    .如果真结束
     ' 本源码来自易语言资源网(www.5A5X.com)
.如果真结束
赋值 (变_地区, 分割文本 (读地区列表 (参_编码), “,”, ))
.计次循环首 (取数组下标 (变_地区, ), 变_计次)
    赋值 (变_地名, 分割文本 (变_地区 [变_计次], “|”, ))
    参_对象.加入项目 (变_地名 [2], 到数值 (变_地名 [1]))
.计次循环尾 ()
赋值 (参_对象.现行选中项, 0)

.子程序 _按钮_查询_被单击, 空白型, , 
.局部变量 变_四级地区编码, 文本型, , "0", 
.局部变量 变_三级地区编码, 文本型, , , 
.局部变量 变_长度, 整数型, , , 

赋值 (.禁止, 真)
赋值 (.标题, “正在刷新”)
赋值 (变_三级地区编码, 到文本 (.取项目数值 (.现行选中项)))
赋值 (变_长度, 取文本长度 (变_三级地区编码))
.如果真 (等于 (变_长度, 5))
    赋值 (变_三级地区编码, 相加 (“0”, 变_三级地区编码))
.如果真结束
赋值 (变_四级地区编码, 分割文本 (读地区列表 (变_三级地区编码), “|”, ))
读天气预报信息 (相加 (“http://www.weather.com.cn/weather/”, 变_四级地区编码 [2], “.shtml”))
赋值 (., 相加 (取运行目录 (), “/demo.html”))
赋值 (.禁止, 假)
赋值 (.标题, “查  询”)

.子程序 读天气预报信息, 空白型, , 
.参数 查询地址, 文本型, , 

.局部变量 信息内容, 文本型, , , 
.局部变量 结果, 逻辑型, , , 

处理事件 ()
赋值 (信息内容, 到文本 (未知支持库函数_0 (未知支持库函数_7 (查询地址), #, #, 结果)))
 ' 编辑框1.内容 ＝ 信息内容
处理事件 ()
格式化信息 (信息内容)


.子程序 格式化信息, 空白型, , 
.参数 信息内容, 文本型, , 

.局部变量 格式信息, 文本型, , , 
.局部变量 找到位置, 整数型, , , 
.局部变量 信息长度, 长整数型, , , 
.局部变量 原替换文本, 文本型, , , 
.局部变量 要替换文本, 文本型, , , 
.局部变量 段一, 文本型, , , 
.局部变量 段二, 文本型, , , 
.局部变量 位一, 整数型, , , 
.局部变量 位二, 整数型, , , 

赋值 (格式信息, 信息内容)

赋值 (信息长度, 取文本长度 (格式信息))
 ' 找到位置 ＝ 寻找文本 (格式信息, “<!--day 1-->”, , 假)
赋值 (找到位置, 寻找文本 (格式信息, “weatherYubaoBox”, , 假))
赋值 (格式信息, 取文本右边 (格式信息, 相加 (相减 (信息长度, 找到位置), 13)))

赋值 (信息长度, 取文本长度 (格式信息))
赋值 (找到位置, 寻找文本 (格式信息, “<!-- Live start-->”, , 假))
赋值 (格式信息, 取文本左边 (格式信息, 相加 (找到位置, 17)))

赋值 (位一, 寻找文本 (格式信息, “<h1”, , 假))
赋值 (段一, 取文本左边 (格式信息, 相减 (位一, 1)))
 ' 本源码来自易语言资源网(www.5A5X.com)
赋值 (信息长度, 取文本长度 (格式信息))
赋值 (位二, 寻找文本 (格式信息, “h1>”, , 假))
赋值 (段二, 取文本右边 (格式信息, 相减 (信息长度, 位二, 2)))

赋值 (格式信息, 相加 (段一, “”, 段二))

赋值 (信息长度, 取文本长度 (格式信息))
赋值 (位二, 寻找文本 (格式信息, “<script”, , 假))
赋值 (段二, 取文本左边 (格式信息, 相减 (位二, 1)))

赋值 (格式信息, 段二)

 ' 原替换文本 ＝ “src=” ＋ #引号 ＋ “/”
 ' 要替换文本 ＝ “src=” ＋ #引号 ＋ “http://www.weather.com.cn/”

赋值 (原替换文本, “/m2/i/icon_weather/29x20/”)
赋值 (要替换文本, “ico/”)

输出调试文本 (要替换文本)
输出调试文本 (寻找文本 (格式信息, 原替换文本, , 假))

赋值 (格式信息, 子文本替换 (格式信息, 原替换文本, 要替换文本, , , 真))
赋值 (格式信息, 子文本替换 (格式信息, “weatherYubao2”, , , , 真))

赋值 (.内容, 格式信息)

更新信息 (格式信息)
 ' 输出调试文本 (写到文件 (取运行目录 () ＋ “/demo.htm”, 格式信息))


.子程序 更新信息, 空白型, , 
.参数 信息内容, 文本型, , 

.局部变量 文件号, 整数型, , , 
.局部变量 文件名, 文本型, , , 
.局部变量 临时数据1, 文本型, , , 
.局部变量 临时数据2, 文本型, , , 

赋值 (文件名, 相加 (取运行目录 (), “/demo.html”))
赋值 (临时数据1, 相加 (“<LINK href=”, #引号, “ico/public.css”, #引号, “ type=text/css rel=stylesheet>”))
赋值 (临时数据2, 相加 (“<LINK href=”, #引号, “ico/mainBox.css”, #引号, “ type=text/css rel=stylesheet>”))

赋值 (文件号, 打开文件 (文件名, #重写, ))
.如果 (大于 (文件号, 0))
    写出文本 (文件号, 相加 (“<div class=”, #引号, “weatherYubao”, #引号, “  id=”, #引号, “7d”, #引号, “>”))
    写出文本 (文件号, 信息内容)
    移到文件尾 (文件号)
    插入文本 (文件号, 临时数据1)
    插入文本 (文件号, 临时数据2)
    
.否则
    
    信息框 (“文件位置出错”, 0, )
.如果结束

关闭文件 (文件号)


.子程序 _按钮_退出_被单击, 空白型, , 
.如果真 (等于 (信息框 (“你要关闭程序吗？”, 相加 (#信息图标, #是否钮), “提示信息”), #是钮))
    结束 ()
.如果真结束


.子程序 _按钮_缩小_被单击, 空白型, , 
.如果 (等于 (缩小, 假))
    _启动窗口.移动 (相减 (取屏幕宽度 (), 85), 5, 80, 50)
    0.移动 (0, 80, 50)
    赋值 (.标题, “天气预报”)
    赋值 (缩小, 真)
    赋值 (.可视, 假)
    
.否则
    
    _启动窗口.移动 (相减 (取屏幕宽度 (), 437), 5, 432, 534)
    352.移动 (0, 48, 24)
    赋值 (.标题, “缩小”)
    赋值 (缩小, 假)
    赋值 (.可视, 真)
    
.如果结束


.子程序 __启动窗口_位置被改变, 空白型, , 
_按钮_缩小_被单击 ()

.子程序 _组合框_一级_列表项被选择, 空白型, , 
写组合框 (到文本 (.取项目数值 (.现行选中项)))
_组合框_二级_列表项被选择 ()

.子程序 _组合框_二级_列表项被选择, 空白型, , 
写组合框 (到文本 (.取项目数值 (.现行选中项)))

.子程序 写入默认配置, 空白型, , 
' 本源码来自易语言资源网(www.5A5X.com)
写配置项 (配置文件地址, “默认选项”, “一级地区”, 到文本 (.现行选中项))
写配置项 (配置文件地址, “默认选项”, “二级地区”, 到文本 (.现行选中项))
写配置项 (配置文件地址, “默认选项”, “三级地区”, 到文本 (.现行选中项))

.子程序 _按钮1_被单击, 空白型, , 
写入默认配置 ()

.子程序 _透明标签2_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

未知支持库函数_56 (“http://www.weather.com.cn/”)



 ' 不属于任何一个程序集、类模块的函数：
