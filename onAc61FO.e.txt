 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 窗口_主窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 519
    高度 = 360
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “易语言论坛助手”
    帮助文件名 = “”

窗口 窗口_登录论坛
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 209
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “登录论坛”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' internet 707ca37322474f6ca841f0e224f4b620 1 0 互联网支持库
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 1 1 多线程支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一




数据类型 用户信息, , 
    .成员 用户名, 文本型, , , 
    .成员 收件箱, 整数型, , , 
    .成员 注册时间, 文本型, , , 
    .成员 登录次数, 整数型, , , 
    .成员 等级, 文本型, , , 
    .成员 金钱, 整数型, , , 
    .成员 积分, 整数型, , , 
    .成员 魅力, 整数型, , , 
    .成员 主题, 整数型, , , 
    .成员 文章, 整数型, , , 
    .成员 精华, 整数型, , , 
    .成员 被删, 整数型, , , 

数据类型 板块, , 
    .成员 板块名, 文本型, , , 
    .成员 板块ID, 文本型, , , 


.窗口程序集 __启动窗口程序集, , , 

.程序集变量 论坛首页, 文本型, , , 
.程序集变量 用户信息, 用户信息, , , 
.子程序 _启动子程序, 整数型, , 
载入 (窗口_主窗口, , 假)
返回 (0)

.子程序 取用户信息, 空白型, , 
.局部变量 寻找, 整数型, , , 

赋值 (寻找, 相加 (寻找文本 (论坛首页, “<div>您的帐号 <b>”, , 假), 17))
.如果真 (不等于 (寻找, 相加 (-1, 17)))
    赋值 (用户信息.用户名, 取文本中间 (论坛首页, 寻找, 相减 (寻找文本 (论坛首页, “</b>”, 寻找, 假), 寻找)))
    赋值 (寻找, 寻找文本 (论坛首页, “收件箱”, 寻找, 假))
    赋值 (寻找, 寻找文本 (论坛首页, “<font”, 寻找, 假))
    赋值 (寻找, 相加 (寻找文本 (论坛首页, 相加 (#引号, “>”), 寻找, 假), 2))
    赋值 (用户信息.收件箱, 到整数 (取文本中间 (论坛首页, 寻找, 相减 (寻找文本 (论坛首页, “</font>”, 寻找, 假), 寻找))))
    赋值 (寻找, 相加 (寻找文本 (论坛首页, “注册：<b>”, , 假), 9))
    赋值 (用户信息.注册时间, 取文本中间 (论坛首页, 寻找, 相减 (寻找文本 (论坛首页, “</b>”, 寻找, 假), 寻找)))
    赋值 (寻找, 相加 (寻找文本 (论坛首页, “登录 <b>”, , 假), 8))
    赋值 (用户信息.登录次数, 到整数 (取文本中间 (论坛首页, 寻找, 相减 (寻找文本 (论坛首页, “</b>”, 寻找, 假), 寻找))))
    赋值 (寻找, 相加 (寻找文本 (论坛首页, “等级：<b>”, , 假), 9))
    赋值 (用户信息.等级, 取文本中间 (论坛首页, 寻找, 相减 (寻找文本 (论坛首页, “</b>”, 寻找, 假), 寻找)))
    赋值 (寻找, 相加 (寻找文本 (论坛首页, “金钱：<b>”, , 假), 9))
    赋值 (用户信息.金钱, 到整数 (取文本中间 (论坛首页, 寻找, 相减 (寻找文本 (论坛首页, “</b>”, 寻找, 假), 寻找))))
    赋值 (寻找, 相加 (寻找文本 (论坛首页, “积分：<b>”, , 假), 9))
    赋值 (用户信息.积分, 到整数 (取文本中间 (论坛首页, 寻找, 相减 (寻找文本 (论坛首页, “</b>”, 寻找, 假), 寻找))))
    赋值 (寻找, 相加 (寻找文本 (论坛首页, “魅力：<b>”, , 假), 9))
    赋值 (用户信息.魅力, 到整数 (取文本中间 (论坛首页, 寻找, 相减 (寻找文本 (论坛首页, “</b>”, 寻找, 假), 寻找))))
    赋值 (寻找, 相加 (寻找文本 (论坛首页, “主题：<b>”, , 假), 9))
    赋值 (用户信息.主题, 到整数 (取文本中间 (论坛首页, 寻找, 相减 (寻找文本 (论坛首页, “</b>”, 寻找, 假), 寻找))))
    赋值 (寻找, 相加 (寻找文本 (论坛首页, “文章：<b>”, , 假), 9))
    赋值 (用户信息.文章, 到整数 (取文本中间 (论坛首页, 寻找, 相减 (寻找文本 (论坛首页, “</b>”, 寻找, 假), 寻找))))
    赋值 (寻找, 相加 (寻找文本 (论坛首页, “精华：<b>”, , 假), 9))
    赋值 (用户信息.精华, 到整数 (取文本中间 (论坛首页, 寻找, 相减 (寻找文本 (论坛首页, “</b>”, 寻找, 假), 寻找))))
    赋值 (寻找, 相加 (寻找文本 (论坛首页, “被删：<b>”, , 假), 9))
    赋值 (用户信息.被删, 到整数 (取文本中间 (论坛首页, 寻找, 相减 (寻找文本 (论坛首页, “</b>”, 寻找, 假), 寻找))))
.如果真结束
.如果 (等于 (用户信息.用户名, “”))
    赋值 (.标题, “您还没有登录论坛，请”)
    赋值 (.可视, 真)
    赋值 (.禁止, 假)
    赋值 (.禁止, 真)
.否则
    赋值 (.标题, 相加 (“用户名: ”, 用户信息.用户名))
    赋值 (.标题, 相加 (.标题, “　　　收件箱: ”, 到文本 (用户信息.收件箱)))
    赋值 (.标题, 相加 (.标题, “　　　登录次数: ”, 到文本 (用户信息.登录次数)))
    赋值 (.标题, 相加 (.标题, #换行符, “注册时间: ”, 用户信息.注册时间))
    赋值 (.标题, 相加 (.标题, “　　　等级: ”, 到文本 (用户信息.等级)))
    赋值 (.标题, 相加 (.标题, “　　　金钱: ”, 到文本 (用户信息.金钱)))
    赋值 (.标题, 相加 (.标题, #换行符, “魅力: ”, 到文本 (用户信息.魅力)))
    赋值 (.标题, 相加 (.标题, “　　　积分: ”, 到文本 (用户信息.积分)))
    赋值 (.标题, 相加 (.标题, “　　　主题数: ”, 到文本 (用户信息.主题)))
    赋值 (.标题, 相加 (.标题, #换行符, “文章数: ”, 到文本 (用户信息.文章)))
    赋值 (.标题, 相加 (.标题, “　　　精华: ”, 到文本 (用户信息.精华)))
    赋值 (.标题, 相加 (.标题, “　　　被删: ”, 到文本 (用户信息.被删)))
    赋值 (.可视, 假)
    赋值 (.禁止, 真)
    赋值 (.禁止, 假)
.如果结束


.子程序 列出板块, 空白型, , 
.局部变量 寻找, 整数型, , , 
.局部变量 临时文本, 文本型, , , 
.局部变量 板块, 文本型, , , 
.局部变量 i, 整数型, , , 

赋值 (论坛首页, 到文本 (未知支持库函数_7 (“http://bbs.dywt.com.cn/index.asp”)))
全部删除 ()
赋值 (寻找, 相加 (寻找文本 (论坛首页, 相加 (“boardid=”, #引号), , 假), 9))
.判断循环首 (不等于 (寻找, 相加 (-1, 9)))
    处理事件 ()
    .如果真 (大于 (寻找文本 (论坛首页, 相加 (“parentid=”, #引号, “0”), 寻找, 假), 寻找文本 (论坛首页, “>”, 寻找, 假)))
        赋值 (板块, 取文本中间 (论坛首页, 寻找, 相减 (寻找文本 (论坛首页, #引号, 寻找, 假), 寻找)))
        赋值 (寻找, 相加 (寻找文本 (论坛首页, 相加 (“boardtype=”, #引号), 寻找, 假), 11))
        赋值 (临时文本, 取文本中间 (论坛首页, 寻找, 相减 (寻找文本 (论坛首页, #引号, 寻找, 假), 寻找)))
        赋值 (临时文本, 子文本替换 (临时文本, “&lt;”, “<”, , , 真))
        赋值 (临时文本, 子文本替换 (临时文本, “&gt;”, “>”, , , 真))
        .插入表项 (临时文本, , , , ).置标题 (1, 板块)
    .如果真结束
    赋值 (寻找, 相加 (寻找文本 (论坛首页, 相加 (“boardid=”, #引号), 寻找, 假), 9))
.判断循环尾 ()
赋值 (.可视, 假)
取用户信息 ()

.子程序 _窗口_主窗口_创建完毕, 空白型, , 
未知支持库函数_0 (&列出板块, )
搜索帖子 (“http://bbs.dywt.com.cn/index.asp?boardid=124”)

.子程序 _窗口_主窗口_尺寸被改变, 空白型, , 
赋值 (.宽度, 相减 (取用户区宽度 (), 相乘 (2, .左边)))
.移动 (相减 (取用户区宽度 (), 相乘 (2, .左边)), 相减 (取用户区高度 (), .顶边, 2))
.移动 (相减 (取用户区宽度 (), 相乘 (2, .)), 相减 (取用户区高度 (), ., 5))
.移动 (., 相减 (., .高度))
相减 (取用户区宽度 (), 相乘 (.宽度, 4), 10).移动 (相加 (., .), , )
相减 (取用户区宽度 (), 相乘 (.宽度, 3), 10).移动 (相加 (., .), , )
相减 (取用户区宽度 (), 相乘 (.宽度, 2), 10).移动 (相加 (., .), , )
相减 (取用户区宽度 (), 相乘 (.宽度, 1), 10).移动 (相加 (., .), , )
相减 (.左边, .宽度).移动 (.顶边, , )
#顶层.调整层次 ()
相除 (相减 (取用户区宽度 (), .宽度), 2).移动 (相除 (相减 (取用户区高度 (), .高度), 2), , )

.子程序 注销用户, 空白型, , 
未知支持库函数_7 (“http://bbs.dywt.com.cn/logout.asp”)

.子程序 _按钮_登录_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (窗口_登录论坛, , 真)

.子程序 _登陆_被选择, 空白型, , 
_按钮_登录_鼠标左键被按下 (0, 0, 0)

.子程序 _注销_被选择, 空白型, , 
注销用户 ()
运行 (相加 (取运行目录 (), “\”, 取执行文件名 ()), 假, )
销毁 ()

.子程序 搜索帖子, 空白型, , 
.参数 网址, 文本型, , 

.局部变量 源码, 文本型, , , 

赋值 (源码, 到文本 (未知支持库函数_7 (网址)))


.窗口程序集 _窗口_登陆论坛程序集, , , 

.子程序 _窗口_登录论坛_创建完毕, 空白型, , 
赋值 (.图片, 未知支持库函数_7 (“http://bbs.dywt.com.cn/DV_getcode.asp”))

.子程序 _按钮_登录_被单击, 空白型, , 
.局部变量 结果, 文本型, , , 

赋值 (结果, 到文本 (未知支持库函数_7 (相加 (“http://bbs.dywt.com.cn/login.asp?action=chk&CookieDate=3&username=”, .内容, “&password=”, .内容, “&codestr=”, .内容))))
.如果 (不等于 (寻找文本 (结果, “返回首页”, , 假), -1))
    信息框 (“登陆成功！”, #信息图标, “信息:”)
    _窗口_主窗口_创建完毕 ()
    销毁 ()
.否则
    信息框 (“登陆失败！”, #错误图标, “错误:”)
    _窗口_登录论坛_创建完毕 ()
.如果结束


.子程序 _按钮_取消_被单击, 空白型, , 
销毁 ()

.子程序 _图片框_验证码_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_窗口_登录论坛_创建完毕 ()


 ' 不属于任何一个程序集、类模块的函数：
