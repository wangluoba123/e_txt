 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 470
    高度 = 350
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\增强型记事本.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “胡子记事本 v1.7”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库
 ' commobj {A068799B-7551-46b9-8CA8-EEF8357AFEA4} 1 0 通用对象支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' edroptarget {9DA96BF9CEBD45c5BFCF94CBE61671F5} 1 0 拖放支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二





.窗口程序集 窗口程序集1, , , 

.程序集变量 用户区高, 整数型, , , 
.程序集变量 用户区宽, 整数型, , , 
.程序集变量 快速文本, 未知类型0x30001, , , 
.程序集变量 已保存, 逻辑型, , , 
.程序集变量 原文件, 文本型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 命令行数组, 文本型, , "0", 

赋值 (_启动窗口., 真)
赋值 (已保存, 假)
赋值 (., 真)
赋值 (., 假)
赋值 (., 假)
赋值 (., 假)
取窗口句柄 ().未知支持库函数_0 ()

取命令行 (命令行数组)
.如果真 (大于 (取数组成员数 (命令行数组), 0))
    .如果真 (不等于 (命令行数组 [1], “”))
        赋值 (., 到文本 (读入文件 (命令行数组 [1])))
        赋值 (原文件, .)
        赋值 (_启动窗口., 相加 (“胡子记事本 v1.7  -”, 命令行数组 [1]))
        赋值 (已保存, 真)
    .如果真结束
    
.如果真结束


.子程序 _拖放对象1_得到文件, 空白型, , 
.参数 接收到的文件路径, 文本型, , 

赋值 (., 到文本 (读入文件 (接收到的文件路径)))
赋值 (_启动窗口., 相加 (“胡子记事本 v1.7  -”, 接收到的文件路径))
赋值 (原文件, .)
赋值 (已保存, 真)

.子程序 __启动窗口_尺寸被改变, 空白型, , 
赋值 (.高度, 取用户区高度 ())
赋值 (.宽度, 取用户区宽度 ())
赋值 (.顶边, 相减 (取用户区高度 (), 17))
赋值 (用户区宽, 相减 (取用户区宽度 (), 8))
赋值 (用户区高, 相减 (取用户区高度 (), 44))
.如果真 (等于 (_启动窗口., 真))
    赋值 (., 用户区高)
    赋值 (., 用户区宽)
.如果真结束


.子程序 _打开_被选择, 空白型, , 
赋值 (.类型, 0)
赋值 (.初始目录, 未知支持库函数_7 (1))
打开 ()
赋值 (., 到文本 (读入文件 (.文件名)))
赋值 (原文件, .)
赋值 (已保存, 真)
 ' '快速文本.从文件读 (通用对话框1.文件名)
 ' '超级编辑框1.内容 ＝ 快速文本.取文本 (, )
 ' 超级编辑框1.读入文档 ()  ''默认为RTF格式文档
赋值 (_启动窗口., 相加 (“胡子记事本 v1.7  -”, .文件名))

.子程序 _退出_被选择, 空白型, , 
销毁 ()


.子程序 _保存_被选择, 空白型, , 
.局部变量 首行, 文本型, , , 
.局部变量 文件名字, 文本型, , , 
.局部变量 行未位置, 整数型, , , 
.局部变量 保存路径, 文本型, , , 
.局部变量 路径位置, 整数型, , , 
.局部变量 已保存路径, 文本型, , , 

赋值 (.类型, 1)
赋值 (已保存路径, 到文本 (读入文件 (相加 (未知支持库函数_7 (#), “\hu_path.ini”))))

输出调试文本 (已保存路径)
输出调试文本 (取文本长度 (已保存路径))
.如果 (不等于 (已保存路径, “”))
    赋值 (.初始目录, 已保存路径)
.否则
    赋值 (.初始目录, 未知支持库函数_7 (1))
.如果结束

赋值 (行未位置, 寻找文本 (., #换行符, , 假))
赋值 (首行, 取文本左边 (., 相减 (行未位置, 1))) ' 删除行末的换行符
赋值 (首行, 删全部空 (首行))
赋值 (文件名字, 相加 (已保存路径, “\”, 首行, “.txt”))
 ' 输出调试文本 (“文件名为：” ＋ 首行)

.如果真 (大于 (., 0))
    赋值 (首行, .)
    赋值 (文件名字, 相加 (已保存路径, “\”, 首行, “.txt”))
.如果真结束

赋值 (.文件名, 文件名字)
.如果真 (打开 ())
    写到文件 (.文件名, 到字节集 (.))
    赋值 (路径位置, 倒找文本 (.文件名, “\”, , 假))
    赋值 (保存路径, 取文本左边 (.文件名, 相减 (路径位置, 1)))
    写到文件 (相加 (未知支持库函数_7 (#), “\hu_path.ini”), 到字节集 (保存路径))
    赋值 (_启动窗口., 相加 (“胡子记事本 v1.7  -”, .文件名))
    赋值 (原文件, .)
    赋值 (已保存, 真)
.如果真结束


.子程序 _撤销_被选择, 空白型, , 
未知支持库函数_1 (#Ctrl键, #Z键, )
 ' 超级编辑框1.发送信息 (199, 0, 0)

.子程序 _剪切_被选择, 空白型, , 
768.发送信息 (0, 0)

.子程序 _复制_被选择, 空白型, , 
769.发送信息 (0, 0)

.子程序 _粘贴_被选择, 空白型, , 
770.发送信息 (0, 0)

.子程序 _删除_被选择, 空白型, , 
.如果 (大于 (., 0))
    未知支持库函数_1 (#退格键, , )
.否则
    未知支持库函数_1 (#Del键, , )
.如果结束


.子程序 _关于胡子记事本_被选择, 空白型, , 
信息框 (相加 (“胡子记事本 v1.7”, #换行符, #换行符, “编程：胡杰”, #换行符, “联系：石嘴山市二中”, #换行符, “信箱：nxhujiee@tom.com”, #换行符, “网址：http://nxhujiee.zj.com        ”), 64, “关于……”)


.子程序 _新建_被选择, 空白型, , 
.局部变量 返回值, 空白型, , , 

.如果真 (大于 (., “”))
    赋值 (返回值, 信息框 (“是否保存当前文本？”, 相加 (#是否钮, #询问图标), ))
    .如果真 (等于 (返回值, #是钮))
        赋值 (.类型, 1)
        _保存_被选择 ()
    .如果真结束
    
.如果真结束
赋值 (., “”)
赋值 (_启动窗口., “胡子记事本 v1.7”)

.子程序 _超级编辑框1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.弹出菜单 ()


.子程序 _插入分割线_被选择, 空白型, , 
置剪辑板文本 (相加 (#换行符, “━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━”))
770.发送信息 (0, 0)
未知支持库函数_1 (#右光标键, , )

.子程序 _全选_被选择, 空白型, , 
赋值 (., -1)
 ' 超级编辑框1.发送信息 (177, 0, -1)

.子程序 _全选并复制到剪贴板_被选择, 空白型, , 
赋值 (., -1)
置剪辑板文本 (.)


.子程序 _删除全部空行_被选择, 空白型, , 
.局部变量 行数, 整数型, , , 
.局部变量 行长, 整数型, , , 
.局部变量 行文本, 文本型, , "0", 
.局部变量 行, 整数型, , , 

赋值 (行文本, 分割文本 (., #换行符, ))
赋值 (行数, 取数组成员数 (行文本))
赋值 (., “”)
.计次循环首 (行数, 行)
    .如果真 (大于 (取文本长度 (行文本 [行]), 1))
        赋值 (., 相加 (., 行文本 [行], #换行符))
    .如果真结束
    
.计次循环尾 ()
 ' 子文本替换 (超级编辑框1.内容, #换行符 ＋ #换行符, #换行符, , , 真)


.子程序 _删除所有行首空格_被选择, 空白型, , 
.局部变量 行文本, 文本型, , "0", 
.局部变量 行数, 整数型, , , 
.局部变量 行, 整数型, , , 

赋值 (行文本, 分割文本 (., #换行符, ))
赋值 (行数, 取数组成员数 (行文本))
赋值 (., “”)
.计次循环首 (行数, 行)
    .如果真 (大于 (取文本长度 (行文本 [行]), 1))
        赋值 (., 相加 (., 删首尾空 (行文本 [行]), #换行符))
    .如果真结束
    
.计次循环尾 ()


.子程序 _字数行数统计_被选择, 空白型, , 
.局部变量 字符数, 文本型, , , 
.局部变量 行数, 文本型, , , 
.局部变量 找位置, 整数型, , , 
.局部变量 找到的, 整数型, , , 
.局部变量 行, 整数型, , , 

.如果 (等于 (., 0))
    赋值 (字符数, 到文本 (取文本长度 (.)))
    .判断循环首 (不等于 (找到的, -1))
        赋值 (找到的, 寻找文本 (., #换行符, 找位置, 假))
        .如果真 (大于或等于 (找到的, 0))
            赋值 (行, 相加 (行, 1))
        .如果真结束
        赋值 (找位置, 相加 (找到的, 1))
    .判断循环尾 ()
    赋值 (行数, 到文本 (相加 (行, 1)))
    
.否则
    赋值 (字符数, 到文本 (.))
    .判断循环首 (不等于 (找到的, -1))
        赋值 (找到的, 寻找文本 (., #换行符, 找位置, 假))
        .如果真 (大于或等于 (找到的, 0))
            赋值 (行, 相加 (行, 1))
        .如果真结束
        赋值 (找位置, 相加 (找到的, 1))
    .判断循环尾 ()
    赋值 (行数, 到文本 (相加 (行, 1)))
.如果结束

信息框 (相加 (“字数/行数统计结果：”, #换行符, #换行符, “  字数： ”, 字符数, #换行符, “  行数： ”, 行数), 64, “字数/行数统计”)


.子程序 _帮助_被选择, 空白型, , 
信息框 (相加 (“简单说明：”, #换行符, #换行符, “ 1、这是一个用易语言编写的演示程序。比Windows     ”, #换行符, “自带的记事本功能强大一些。 ”, #换行符, #换行符, “2、保存文件时可自动取首行做文件名，也可以用文”, #换行符, “中选定的文本做文件名。”, #换行符, #换行符, “3、其他功能都在菜单上了。纯绿色免费软件，没有”, #换行符, “任何限制。”), 48, “帮助信息”)

.子程序 _插入当前日期_被选择, 空白型, , 
.局部变量 日期, 文本型, , , 

赋值 (日期, 到文本 (取日期 (取现行时间 ())))
置剪辑板文本 (日期)
770.发送信息 (0, 0)


.子程序 _首行缩进_被选择, 空白型, , 
.局部变量 处理后文本, 文本型, , , 

赋值 (处理后文本, 子文本替换 (., #换行符, 相加 (#换行符, “    ”), , , 真))
置剪辑板文本 (处理后文本)
未知支持库函数_1 (#Ctrl键, #A键, )
未知支持库函数_1 (#Ctrl键, #V键, )


.子程序 _删除同类字符_被选择, 空白型, , 
.局部变量 选中文字, 文本型, , , 
.局部变量 删同类后, 文本型, , , 

赋值 (选中文字, .)
赋值 (删同类后, 子文本替换 (., 选中文字, “”, 1, , 真))
置剪辑板文本 (删同类后)
赋值 (., “”)
未知支持库函数_1 (#Ctrl键, #A键, )
未知支持库函数_1 (#Ctrl键, #V键, )


.子程序 _插入当前时间_被选择, 空白型, , 
.局部变量 时间, 文本型, , , 

赋值 (时间, 文本替换 (到文本 (取时间 (取现行时间 ())), 1, 12, ))
置剪辑板文本 (时间)
770.发送信息 (0, 0)


.子程序 _段后插入空行_被选择, 空白型, , 
.局部变量 插入空行后, 文本型, , , 

赋值 (插入空行后, 子文本替换 (., #换行符, 相加 (#换行符, #换行符), 1, , 真))
置剪辑板文本 (插入空行后)
赋值 (., “”)
未知支持库函数_1 (#Ctrl键, #A键, )
未知支持库函数_1 (#Ctrl键, #V键, )


.子程序 __启动窗口_可否被关闭, 逻辑型, , 
.局部变量 按钮, 整数型, , , 

.如果真 (等于 (., “”))
    赋值 (已保存, 真)
.如果真结束
.如果真 (等于 (., 假))
    赋值 (已保存, 真)
.如果真结束
.如果真 (不等于 (., 原文件))
    赋值 (已保存, 假)
.如果真结束

.如果真 (等于 (已保存, 假))
    赋值 (按钮, 信息框 (“是否保存文档？”, 相加 (#是否钮, #询问图标), “提示：”))
    .如果 (等于 (按钮, #是钮))
        _保存_被选择 ()
    .否则
        _启动窗口.销毁 ()
    .如果结束
    
.如果真结束
.如果真 (等于 (已保存, 真))
    _启动窗口.销毁 ()
.如果真结束


.子程序 _全角转半角_被选择, 空白型, , 
.如果 (等于 (., 0))
    赋值 (., 到半角 (.))
.否则
    赋值 (., 到半角 (.))
.如果结束


.子程序 _半角转全角_被选择, 空白型, , 
.如果 (等于 (., 0))
    赋值 (., 到全角 (.))
.否则
    赋值 (., 到全角 (.))
.如果结束


.子程序 _时钟1_周期事件, 空白型, , 
.如果真 (等于 (剪辑板中可有文本 (), 真))
    770.发送信息 (0, 0)
    置剪辑板文本 (相加 (#换行符, 字符 (13)))
     ' 模拟按键 (#回车键, , )
    770.发送信息 (0, 0)
    清除剪辑板 ()
.如果真结束


.子程序 _打开监视剪贴板_被选择, 空白型, , 
清除剪辑板 ()
赋值 (.选中, 真)
赋值 (.选中, 假)
15.加入状态 (#按下)
16.去除状态 (#按下)
赋值 (.时钟周期, 2000)
信息框 (相加 (“自动监视剪贴板功能已打开！”, #换行符, #换行符, “剪贴板中的内容将被自动依次粘贴到记事本中。”, #换行符, “如需恢复正常使用，请及时关闭自动监视状态。”), #警告图标, )


.子程序 _关闭监视剪贴板_被选择, 空白型, , 
清除剪辑板 ()
赋值 (.时钟周期, 0)
赋值 (.选中, 假)
赋值 (.选中, 真)
16.加入状态 (#按下)
15.去除状态 (#按下)
信息框 (“自动监视剪贴板功能已关闭！”, #警告图标, )

.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.如果真 (等于 (按钮索引, 0))
    _新建_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 1))
    _打开_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 2))
    _保存_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 4))
    768.发送信息 (0, 0)
.如果真结束
.如果真 (等于 (按钮索引, 5))
    769.发送信息 (0, 0)
.如果真结束
.如果真 (等于 (按钮索引, 6))
    770.发送信息 (0, 0)
.如果真结束
.如果真 (等于 (按钮索引, 8))
    199.发送信息 (0, 0)
.如果真结束
.如果真 (等于 (按钮索引, 9))
    .如果 (大于 (., 0))
        未知支持库函数_1 (#退格键, , )
    .否则
        未知支持库函数_1 (#Shift键, #右光标键, #退格键)
         ' 模拟按键 (#Del键, , )
    .如果结束
    
.如果真结束
.如果真 (等于 (按钮索引, 10))
    _全选并复制到剪贴板_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 12))
    _插入分割线_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 13))
    _插入当前日期_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 15))
    _打开监视剪贴板_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 16))
    _关闭监视剪贴板_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 18))
    _是否总在最前_被选择 ()
.如果真结束


.子程序 _是否总在最前_被选择, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
    赋值 (_启动窗口., 假)
    18.去除状态 (#按下)
.否则
    赋值 (.选中, 真)
    赋值 (_启动窗口., 真)
    18.加入状态 (#按下)
.如果结束


.子程序 _查找替换_被选择, 空白型, , 
.局部变量 输入文本, 文本型, , , 
.局部变量 原字串, 文本型, , , 
.局部变量 新字串, 文本型, , , 
.局部变量 空格位置, 整数型, , , 

输入框 (相加 (“请输入要查找的内容和替换的内容，并用半角空格隔开。”, #换行符, “    如：电脑 计算机”, #换行符, “    (如果有选中的文字，则只在选中部分中查找替换。)”), “查找替换”, , 输入文本, )
赋值 (空格位置, 寻找文本 (输入文本, 取空白文本 (1), , 假))
赋值 (原字串, 取文本左边 (输入文本, 相减 (空格位置, 1)))
赋值 (新字串, 取文本右边 (输入文本, 相减 (取文本长度 (输入文本), 空格位置)))
输出调试文本 (原字串)
输出调试文本 (新字串)
.如果 (等于 (., “”))
    赋值 (., 子文本替换 (., 原字串, 新字串, , , 真))
.否则
    赋值 (., 子文本替换 (., 原字串, 新字串, , , 真))
.如果结束


.子程序 _删除选中段落中的换行符_被选择, 空白型, , 
赋值 (., 子文本替换 (., #换行符, “”, , , 真))


.子程序 _行末插入硬回车_被选择, 空白型, , 
.局部变量 行, 整数型, , , 
.局部变量 行文本数组, 文本型, , "0", 
.局部变量 n, 整数型, , , 

赋值 (.可视, 真)
赋值 (.标题, “可以通过改变窗口的宽度增加或减少文本行的字数。”)
.计次循环首 (未知支持库函数_1 (), 行)
    加入成员 (行文本数组, 相加 (删尾空 (相减 (行, 1).未知支持库函数_2 ()), 字符 (10)))
.计次循环尾 ()

赋值 (., “”)
.计次循环首 (取数组成员数 (行文本数组), n)
    .如果 (等于 (取文本右边 (行文本数组 [n], 1), #换行符))
        赋值 (., 相加 (., 行文本数组 [n], #换行符))
    .否则
        赋值 (., 相加 (., 行文本数组 [n], 字符 (13), #换行符))
    .如果结束
    
.计次循环尾 ()

.子程序 _标签1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.可视, 取反 (.可视))


.子程序 _删除一行_被选择, 空白型, , 
.局部变量 行号, 整数型, , , 
.局部变量 行文本, 文本型, , , 
.局部变量 行长, 整数型, , , 

赋值 (行号, .未知支持库函数_5 ())
赋值 (行文本, 行号.未知支持库函数_2 ())
赋值 (行长, 相除 (取文本长度 (行文本), 2))
.如果 (大于 (行长, 1))
    赋值 (., 行号.未知支持库函数_4 ())
    赋值 (., 行长)
    未知支持库函数_19 ()
.否则
    未知支持库函数_1 (#Del键, , )
.如果结束


.子程序 _删除到行首_被选择, 空白型, , 
 ' 模拟按键 (#Shift键, #Home键, #Del键)

.子程序 _是否自动折行_被选择, 空白型, , 
赋值 (., 取反 (.))
赋值 (.选中, 取反 (.选中))

.子程序 _保存为带分行符_被选择, 空白型, , 
_行末插入硬回车_被选择 ()
_保存_被选择 ()


 ' 不属于任何一个程序集、类模块的函数：
