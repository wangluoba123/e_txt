 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 140
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\永硕刷分器.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “永硕刷人气工具 - 追异”
    帮助文件名 = “”



.常量 头信息, "“<iframe name="frxcx" id="frxcx" src="”", , 
.常量 尾信息, "“" style="display:none;"></iframe>”", , 
.常量 头信息2, "“parent.$('zxrsts1').innerHTML=”", , 
.常量 尾信息2, "“;”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库




数据类型 线程信息, 公开, 
    .成员 线程号, 整数型, , , 启动线程时返回的线程号
    .成员 状态, 字节型, , , 0=未启动，1=启动，2=停止
    .成员 账号字典指针, 整数型, , , 这个指针指定指定线程当前破解的账号
    .成员 密码字典指针, 整数型, , , 字典的首地址
    .成员 字典大小, 整数型, , , 字典占用的大小

数据类型 关键路段, 公开, CRITICAL_SECTION
    .成员 DebugInfo, 整数型, , , 调试信息
    .成员 LockCount, 整数型, , , 锁定统计
    .成员 RecursionCount, 整数型, , , 
    .成员 OwningThread, 整数型, , , 
    .成员 LockSemaphore, 整数型, , , 
    .成员 SpinCount, 整数型, , , 


.DLL命令 CreateThread, 整数型, "", "", , 
    .参数 lpThreadAttributes, 整数型, , 
    .参数 dwStackSize, 整数型, , 
    .参数 lpStartAddress, 子程序指针, , 
    .参数 lpParameter, 整数型, , 
    .参数 dwCreationFlags, 整数型, , 
    .参数 lpThreadId, 整数型, 传址, 

.DLL命令 暂停线程_, 整数型, "kernel32.dll", "SuspendThread", , 公开, 返回原先的暂停计数
    .参数 线程号, 整数型, , 

.DLL命令 信息框_, 整数型, "user32.dll", "MessageBoxA", 公开, MessageBox,产生一个对话框，参照系统信息框
    .参数 父窗口句柄, 整数型, , hwnd
    .参数 提示信息, 文本型, , lPMsg
    .参数 标题, 文本型, , lPCap
    .参数 按钮, 整数型, , Button' 参数值由以下几组常量值组成，在将这些常量值相加以生成参数值时，每组值只能取用一个数字（第五组除外）：' 第一组（描述对话框中显示按钮的类型与数目）：' 0、#确认钮； 1、#确认取消钮； 2、#放弃重试忽略钮； 3、#取消是否钮；     4、#是否钮； 5、#重试取消钮' 第二组（描述图标的样式）：' 16、#错误图标； 32、#询问图标； 48、#警告图标； 64、#信息图标' 第三组（说明哪一个按钮是缺省默认值）：' 0、#默认按钮一； 256、#默认按钮二； 512、#默认按钮三； 768、#默认按钮四' 第四组（决定如何等待消息框结束）：' 0、#程序等待； 4096、#系统等待' 第五组（其它）：' 65536、#位于前台； 524288、#文本右对齐

.DLL命令 创建线程_, 整数型, "kernel32.dll", "CreateThread", 公开, 成功返回线程号，失败返回0，注意线程号与线程句柄的区别，一般内部使用线程号，外部使用线程句柄
    .参数 安全结构, 整数型, , 
    .参数 堆栈大小, 整数型, , 
    .参数 线程入口, 子程序指针, , 
    .参数 线程参数, 整数型, , 
    .参数 是否执行, 整数型, , 0=执行，4=挂起
    .参数 线程句柄, 整数型, 传址, 

.DLL命令 恢复线程_, 整数型, "kernel32.dll", "ResumeThread", , 公开, 返回原先的暂停计数
    .参数 线程句柄, 整数型, , 

.DLL命令 取自线程句柄_, 整数型, "kernel32.dll", "GetCurrentThread", , 公开, 返回=-2

.DLL命令 删除许可证_, 空白型, "kernel32", "DeleteCriticalSection", , 删除许可证 DeleteCriticalSection
    .参数 lpCriticalSection, 关键路段, 传址, lpCriticalSection

.DLL命令 创建许可证_, 空白型, "kernel32", "InitializeCriticalSection", , 创建许可证 InitializeCriticalSection
    .参数 lpCriticalSection, 关键路段, 传址, lpCriticalSection

.DLL命令 退出许可区_, 空白型, "kernel32", "LeaveCriticalSection", , 退出许可区 LeaveCriticalSection
    .参数 lpCriticalSection, 关键路段, 传址, lpCriticalSection

.DLL命令 进入许可区_, 空白型, "kernel32", "EnterCriticalSection", , 进入许可区 EnterCriticalSection
    .参数 lpCriticalSection, 关键路段, 传址, lpCriticalSection

.DLL命令 等待线程_, 整数型, "", "WaitForSingleObject", , 线程不存在返回-1
    .参数 句柄, 整数型, , 
    .参数 超时, 整数型, , 

.DLL命令 MsgWaitForMultipleObjects, 整数型, "", "MsgWaitForMultipleObjects", , 
    .参数 nCount, 整数型, , 
    .参数 pHandles, 整数型, 传址, 
    .参数 fWaitAll, 逻辑型, , 
    .参数 dwMilliseconds, 整数型, , 
    .参数 dwWakeMask, 整数型, , 

.DLL命令 TerminateThread, 逻辑型, "", "", , 
    .参数 hThread, 整数型, , 
    .参数 dwExitCode, 整数型, , 

.DLL命令 CloseHandle, 逻辑型, "", "CloseHandle", , 
    .参数 hObject, 整数型, , 

.DLL命令 InternetOpenA, 整数型, "WinINet.dll", "", , 
    .参数 lpszAgent, 文本型, , 
    .参数 dwAccessType, 整数型, , 
    .参数 lpszProxyName, 文本型, , 
    .参数 lpszProxyBypass, 文本型, , 
    .参数 dwFlags, 整数型, , 

.DLL命令 InternetConnectA, 整数型, "WinINet.dll", "", , 
    .参数 hInternet, 整数型, , 
    .参数 lpszServerName, 文本型, , 
    .参数 nServerPort, 整数型, , 
    .参数 lpszUserName, 文本型, , 
    .参数 lpszPassword, 文本型, , 
    .参数 dwService, 整数型, , 
    .参数 dwFlags, 整数型, , 
    .参数 dwContext, 整数型, , 

.DLL命令 InternetCloseHandle, 逻辑型, "WinINet.dll", "", , 
    .参数 hInternet, 整数型, , 

.DLL命令 HttpOpenRequestA, 整数型, "WinINet.dll", "", , 
    .参数 hConnect, 整数型, , 
    .参数 lpszVerb, 文本型, , 
    .参数 lpszObjectName, 文本型, , 
    .参数 lpszVersion, 文本型, , 
    .参数 lpszReferer, 文本型, , 
    .参数 lplpszAcceptTypes, 文本型, , 
    .参数 dwFlags, 整数型, , 
    .参数 dwContext, 整数型, , 

.DLL命令 HttpAddRequestHeaders, 空白型, "wininet.dll", "HttpAddRequestHeadersA", , 
    .参数 hRequest, 整数型, , 
    .参数 lpszHeaders, 文本型, 传址, 
    .参数 dwHeadersLength, 整数型, , 
    .参数 dwModifiers, 整数型, , 

.DLL命令 HttpSendRequestA, 逻辑型, "WinINet.dll", "", , 
    .参数 hRequest, 整数型, , 
    .参数 lpszHeaders, 文本型, , 
    .参数 dwHeadersLength, 整数型, , 
    .参数 lpOptional, 字节集, , 
    .参数 dwOptionalLength, 整数型, , 

.DLL命令 InternetReadFile, 逻辑型, "WinINet.dll", "", , 
    .参数 hFile, 整数型, , 
    .参数 lpBuffer, 字节集, 传址, 
    .参数 dwNumberOfBytesToRead, 整数型, , 
    .参数 lpdwNumberOfBytesRead, 整数型, 传址, 

.DLL命令 HttpQueryInfoA, 逻辑型, "WinINet.dll", "", , 
    .参数 hRequest, 整数型, , 
    .参数 dwInfoLevel, 整数型, , 
    .参数 lpvBuffer, 文本型, 传址, 
    .参数 lpdwBufferLength, 整数型, 传址, 
    .参数 lpdwIndex, 整数型, , 

.DLL命令 InternetSetCookieA, 逻辑型, "WinINet.dll", "", , 
    .参数 lpszUrl, 文本型, , 
    .参数 lpszCookieName, 文本型, , 
    .参数 lpszCookieData, 文本型, , 

.DLL命令 退出线程_, 整数型, "kernel32", "ExitThread", , 
    .参数 线程句柄, 整数型, , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 已读取刷分地址, 逻辑型, , , 
.程序集变量 刷分地址, 文本型, , , 
.程序集变量 开刷了, 逻辑型, , , 
.子程序 _按钮1_被单击, 空白型, , 
.如果 (开刷了)
    赋值 (., 真)
    连续赋值 (假, 已读取刷分地址, 开刷了)
.否则
    创建线程_ (0, 0, &正式开刷, 0, 0, 0)
    赋值 (., 真)
.如果结束
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--


.子程序 GET提交, 空白型, , 
.参数 返回文本, 文本型, 参考, 

赋值 (返回文本, 到文本 (访问网页 (., , , , , , , 10, , )))

.子程序 GET提交2, 空白型, , 
.参数 返回文本, 文本型, , 

赋值 (返回文本, 到文本 (访问网页 (返回文本, , , , , , , 10, , )))
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 正式开刷, 空白型, , 
.局部变量 文本, 文本型, , , 
.局部变量 头位置, 整数型, , , 
.局部变量 尾位置, 整数型, , , 
.局部变量 高效刷次数, 整数型, 静态, , 

赋值 (., “停刷”)
赋值 (开刷了, 真)
赋值 (., 假)
.判断循环首 (开刷了)
    .如果 (.)
        .如果真 (或者 (等于 (已读取刷分地址, 假), 大于 (高效刷次数, 100)))
            赋值 (高效刷次数, 0)
            GET提交 (文本)
            赋值 (头位置, 相加 (寻找文本 (文本, #头信息, , 真), 37))
            赋值 (尾位置, 寻找文本 (文本, #尾信息, 头位置, 真))
            赋值 (刷分地址, 取文本中间 (文本, 头位置, 相减 (尾位置, 头位置)))
            .如果真 (不等于 (刷分地址, “”))
                赋值 (已读取刷分地址, 真)
            .如果真结束
             ' 本源码来自易语言资源网(www.5A5X.com)
        .如果真结束
        赋值 (高效刷次数, 相加 (高效刷次数, 1))
        赋值 (文本, 刷分地址)
    .否则
        GET提交 (文本)
        赋值 (头位置, 相加 (寻找文本 (文本, #头信息, , 真), 37))
        赋值 (尾位置, 寻找文本 (文本, #尾信息, 头位置, 真))
        赋值 (文本, 取文本中间 (文本, 头位置, 相减 (尾位置, 头位置)))
    .如果结束
    GET提交2 (文本)
    赋值 (头位置, 相加 (寻找文本 (文本, #头信息2, , 真), 30))
    赋值 (尾位置, 寻找文本 (文本, #尾信息2, 头位置, 真))
    赋值 (., 到文本 (到整数 (取文本中间 (文本, 头位置, 相减 (尾位置, 头位置)))))
.判断循环尾 ()
赋值 (., “开刷”)
赋值 (., 假)

.子程序 __启动窗口_位置被改变, 空白型, , 
.如果真 (等于 (., 2))
    置托盘图标 (., “永硕刷人气工具”)
    赋值 (., 假)
.如果真结束
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 __启动窗口_托盘事件, 空白型, , 
.参数 操作类型, 整数型, , 

赋值 (., 真)
赋值 (., 1)
置托盘图标 ()


.程序集 网页访问, , , 

.子程序 访问网页, 字节集, , 
.参数 完整网址, 文本型, , 
.参数 访问方式, 文本型, 可空, "GET" or "POST",为空默认"GET"
.参数 代理地址, 文本型, 可空, 
.参数 用户名, 文本型, 可空, 
.参数 密码, 文本型, 可空, 
.参数 附加协议头, 文本型, 可空, 
.参数 提交信息, 文本型, 可空, "POST"专用
.参数 超时值, 整数型, 可空, 单位秒，默认90
.参数 返回状态文本, 文本型, 参考 可空, 在Send之后可以获取状态文本
.参数 COOKIES, 文本型, 可空, 

.局部变量 线程句柄, 整数型, , , 
.局部变量 ret, 整数型, , , 
.局部变量 内存文件号, 整数型, , , 
.局部变量 访问成功状态, 文本型, , , 
.局部变量 状态文本, 文本型, , , 
.局部变量 网页内容, 字节集, , , 

 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

赋值 (内存文件号, 打开内存文件 ())
写出数据 (内存文件号, “MissWho”, 完整网址, 访问方式, 代理地址, 用户名, 密码, 附加协议头, 到字节集 (提交信息), COOKIES)
.如果真 (或者 (是否为空 (超时值), 等于 (超时值, 0)))
    赋值 (超时值, 90)
.如果真结束
赋值 (线程句柄, CreateThread (0, 0, &ReadFile, 内存文件号, 0, 0))
.循环判断首 ()
    赋值 (ret, MsgWaitForMultipleObjects (1, 线程句柄, 假, 相乘 (超时值, 1000), 1215))
    处理事件 ()
.循环判断尾 (并且 (不等于 (ret, 0), 不等于 (ret, 258)))
TerminateThread (线程句柄, 0)
CloseHandle (线程句柄)
移到文件首 (内存文件号)
读入数据 (内存文件号, 访问成功状态, 状态文本, 网页内容, COOKIES)
赋值 (COOKIES, 删首尾空 (COOKIES))
关闭文件 (内存文件号)
.如果真 (或者 (不等于 (访问成功状态, “MissWho_OK”), 等于 (ret, 258)))
    赋值 (网页内容, {  })
     ' 本源码来自易语言资源网(www.5A5X.com)
.如果真结束
.如果真 (等于 (是否为空 (返回状态文本), 假))
    赋值 (返回状态文本, 状态文本)
.如果真结束
返回 (网页内容)

.子程序 ReadFile, 逻辑型, , 
.参数 内存文件号, 整数型, , 

.局部变量 访问成功状态, 文本型, , , 
.局部变量 完整网址, 文本型, , , 
.局部变量 访问方式, 文本型, , , "GET" or "POST",为空默认"GET"
.局部变量 代理地址, 文本型, , , 
.局部变量 用户名, 文本型, , , 
.局部变量 密码, 文本型, , , 
.局部变量 附加协议头, 文本型, , , 
.局部变量 提交信息, 字节集, , , "POST"专用
.局部变量 返回协议头, 文本型, , , 
.局部变量 网页返回内存文件号, 整数型, , , 
.局部变量 COOKIES, 文本型, , , 
.局部变量 请求句柄, 整数型, , , 
.局部变量 连接句柄, 整数型, , , 
.局部变量 返回句柄, 整数型, , , 
.局部变量 域名, 文本型, , , 
.局部变量 页面地址, 文本型, , , 
.局部变量 是否代理地址, 逻辑型, , , 
.局部变量 lpBuffer, 字节集, , , 
.局部变量 临时文件号, 整数型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 文件内容, 字节集, , , 

.如果真 (等于 (内存文件号, 0))
    返回 (假)
.如果真结束
移到文件首 (内存文件号)
读入数据 (内存文件号, 访问成功状态)
.如果真 (不等于 (访问成功状态, “MissWho”))
    返回 (假)
.如果真结束
读入数据 (内存文件号, 完整网址, 访问方式, 代理地址, 用户名, 密码, 附加协议头, 提交信息, COOKIES)
 ' 输出调试文本 (Cookie)

移到文件首 (内存文件号)
删除数据 (内存文件号, 取文件长度 (内存文件号))
赋值 (域名, 取域名 (完整网址))
赋值 (页面地址, 取页面地址 (完整网址))
赋值 (是否代理地址, 不等于 (删全部空 (代理地址), “”))
 ' 本源码来自易语言资源网(www.5A5X.com)
 ' 建立基础连接
赋值 (请求句柄, InternetOpenA (“Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)”, 选择 (是否代理地址, 3, 1), 选择 (是否代理地址, 相加 (“http=”, 代理地址), 字符 (0)), 字符 (0), 0))
.如果真 (等于 (请求句柄, 0))
    返回 (假)
.如果真结束
赋值 (连接句柄, InternetConnectA (请求句柄, 域名, 取端口 (完整网址), 选择 (不等于 (删全部空 (用户名), “”), 用户名, 字符 (0)), 选择 (不等于 (删全部空 (密码), “”), 密码, 字符 (0)), 3, 0, 0))
.如果真 (等于 (连接句柄, 0))
    InternetCloseHandle (请求句柄)
    返回 (假)
.如果真结束
.如果 (不等于 (删首尾空 (COOKIES), “”))
     ' 禁止WinInet自行添加cookie
    赋值 (返回句柄, HttpOpenRequestA (连接句柄, 访问方式, 页面地址, “HTTP/1.1”, 字符 (0), 字符 (0), 位或 (524288, 2147483648), 0))
.否则
    赋值 (返回句柄, HttpOpenRequestA (连接句柄, 访问方式, 页面地址, “HTTP/1.1”, 字符 (0), 字符 (0), 2147483648, 0))
.如果结束
 ' 本源码来自易语言资源网(www.5A5X.com)
.如果真 (等于 (返回句柄, 0))
    InternetCloseHandle (连接句柄)
    InternetCloseHandle (请求句柄)
    返回 (假)
.如果真结束

 ' 补充协议头
.如果真 (等于 (寻找文本 (附加协议头, “Accept: ”, 1, 真), -1))
    赋值 (附加协议头, 相加 (附加协议头, “Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */*”, #换行符))
.如果真结束
.如果真 (等于 (寻找文本 (附加协议头, “Referer: ”, 1, 真), -1))
    赋值 (附加协议头, 相加 (附加协议头, “Referer: ”, 完整网址, #换行符))
.如果真结束
.如果真 (等于 (寻找文本 (附加协议头, “Accept-Language: ”, 1, 真), -1))
    赋值 (附加协议头, 相加 (附加协议头, “Accept-Language: zh-cn”, #换行符))
.如果真结束
.如果真 (不等于 (删首尾空 (COOKIES), “”))
     ' 添加cookie
    赋值 (COOKIES, 相加 (“Cookie: ”, COOKIES, #换行符))
    HttpAddRequestHeaders (返回句柄, COOKIES, 取文本长度 (COOKIES), 0)
.如果真结束


 ' 附带信息发送请求
.判断开始 (或者 (等于 (访问方式, “”), 等于 (到大写 (访问方式), “GET”)))
    HttpSendRequestA (返回句柄, 附加协议头, 取文本长度 (附加协议头), 到字节集 (字符 (0)), 0)
.判断 (等于 (到大写 (访问方式), “POST”))
    .如果真 (大于 (取字节集长度 (提交信息), 0))
        .如果真 (等于 (寻找文本 (附加协议头, “Content-Type: ”, 1, 真), -1))
            赋值 (附加协议头, 相加 (附加协议头, “Content-Type: application/x-www-form-urlencoded”, #换行符))
        .如果真结束
        赋值 (附加协议头, 相加 (附加协议头, “Content-Length: ”, 到文本 (取字节集长度 (提交信息)), #换行符))
    .如果真结束
    HttpSendRequestA (返回句柄, 附加协议头, 取文本长度 (附加协议头), 提交信息, 取字节集长度 (提交信息))
.默认
    InternetCloseHandle (返回句柄)
    InternetCloseHandle (连接句柄)
    InternetCloseHandle (请求句柄)
    返回 (假)
.判断结束

 ' 读取页面数据
赋值 (网页返回内存文件号, 打开内存文件 ())
.循环判断首 ()
    赋值 (lpBuffer, 取空白字节集 (512))
    InternetReadFile (返回句柄, lpBuffer, 取字节集长度 (lpBuffer), 临时文件号)
     ' 避免文件过大造成的字节集相加降低效率，这里使用内存文件操作。
    写出字节集 (网页返回内存文件号, 取字节集左边 (lpBuffer, 临时文件号))
     ' lpBody ＝ lpBody ＋ 取字节集左边 (lpBuffer, dwNumber)
.循环判断尾 (不等于 (临时文件号, 0))
 ' 本源码来自易语言资源网(www.5A5X.com)
 ' 取服务器回传协议头
赋值 (返回协议头, 取空白文本 (1024))
HttpQueryInfoA (返回句柄, 22, 返回协议头, 1024, 0)

移到文件首 (网页返回内存文件号)
移到文件首 (内存文件号)
写出数据 (内存文件号, “MissWho_OK”, 返回协议头, 读入字节集 (网页返回内存文件号, 取文件长度 (网页返回内存文件号)))
关闭文件 (网页返回内存文件号)

 ' 关闭句柄
InternetCloseHandle (返回句柄)
InternetCloseHandle (连接句柄)
InternetCloseHandle (请求句柄)

 ' 设置COOKIE
.如果真 (大于 (寻找文本 (返回协议头, “Set-Cookie: ”, 1, 真), 0))
    赋值 (临时文件号, 打开内存文件 ())
    写出文本 (临时文件号, 返回协议头)
    移到文件首 (临时文件号)
    赋值 (COOKIES, “”)
    .判断循环首 (等于 (是否在文件尾 (临时文件号, 假), 假))
        赋值 (页面地址, 读入一行 (临时文件号))
        .如果真 (大于 (寻找文本 (页面地址, “Set-Cookie: ”, 1, 真), 0))
            赋值 (页面地址, 文本替换 (页面地址, 1, 12, ))
            赋值 (返回句柄, 寻找文本 (页面地址, “=”, 1, 真))
            InternetSetCookieA (相加 (“http://”, 域名), 取文本左边 (页面地址, 相减 (返回句柄, 1)), 取文本右边 (页面地址, 相减 (取文本长度 (页面地址), 返回句柄)))
            赋值 (COOKIES, 相加 (COOKIES, 格式化COOKIE (页面地址), “;”))
        .如果真结束
         ' 本源码来自易语言资源网(www.5A5X.com)
    .判断循环尾 ()
    移到文件尾 (内存文件号)
    写出数据 (内存文件号, COOKIES)
    关闭文件 (临时文件号)
.如果真结束
返回 (真)

.子程序 格式化COOKIE, 文本型, , 
.参数 cookie, 文本型, , 

返回 (取文本左边 (cookie, 相减 (寻找文本 (cookie, “;”, , 真), 1)))

.子程序 取端口, 整数型, , 
.参数 网址, 文本型, , 

.局部变量 符号位置, 整数型, , , 
.局部变量 域名, 文本型, , , 

.如果 (不等于 (文本比较 (取文本左边 (网址, 7), “http://”, 假), 0))
    赋值 (符号位置, 寻找文本 (网址, “/”, , 真))
    .如果 (大于 (符号位置, 0))
        赋值 (域名, 取文本左边 (网址, 相减 (符号位置, 1)))
    .否则
        赋值 (域名, 网址)
    .如果结束
    
.否则
    赋值 (符号位置, 寻找文本 (网址, “/”, 8, 真))
    .如果 (大于 (符号位置, 0))
        赋值 (域名, 取文本中间 (网址, 8, 相减 (符号位置, 8)))
    .否则
        赋值 (域名, 文本替换 (网址, 1, 7, ))
    .如果结束
    
.如果结束
赋值 (符号位置, 寻找文本 (域名, “:”, 1, 真))
.如果 (大于 (符号位置, 0))
    赋值 (域名, 取文本右边 (域名, 相减 (取文本长度 (域名), 符号位置)))
.否则
    赋值 (域名, “80”)
.如果结束
返回 (到数值 (域名))
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 取页面地址, 文本型, , 
.参数 网址, 文本型, , 

.局部变量 页面地址, 文本型, , , 
.局部变量 符号位置, 整数型, , , 
.局部变量 域名, 文本型, , , 

赋值 (域名, 取域名 (网址))
赋值 (符号位置, 寻找文本 (网址, “/”, 寻找文本 (网址, 域名, 1, 真), 真))
.如果 (大于 (符号位置, 0))
    赋值 (页面地址, 取文本右边 (网址, 相加 (相减 (取文本长度 (网址), 符号位置), 1)))
.否则
    赋值 (页面地址, “/”)
.如果结束
返回 (页面地址)

.子程序 取域名, 文本型, , 
.参数 网址, 文本型, , 

.局部变量 符号位置, 整数型, , , 
.局部变量 域名, 文本型, , , 

.如果 (不等于 (文本比较 (取文本左边 (网址, 7), “http://”, 假), 0))
    赋值 (符号位置, 寻找文本 (网址, “/”, , 真))
    .如果 (大于 (符号位置, 0))
        赋值 (域名, 取文本左边 (网址, 相减 (符号位置, 1)))
    .否则
        赋值 (域名, 网址)
    .如果结束
    ' 本源码来自易语言资源网(www.5A5X.com)
.否则
    赋值 (符号位置, 寻找文本 (网址, “/”, 8, 真))
    .如果 (大于 (符号位置, 0))
        赋值 (域名, 取文本中间 (网址, 8, 相减 (符号位置, 8)))
    .否则
        赋值 (域名, 文本替换 (网址, 1, 7, ))
    .如果结束
    
.如果结束
赋值 (符号位置, 寻找文本 (域名, “:”, 1, 真))
.如果真 (大于 (符号位置, 0))
    赋值 (域名, 取文本左边 (域名, 相减 (符号位置, 1)))
.如果真结束
返回 (到小写 (域名))



 ' 不属于任何一个程序集、类模块的函数：
