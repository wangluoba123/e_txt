 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 795
    高度 = 439
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 添加会员
    左边 = 50
    顶边 = 50
    宽度 = 302
    高度 = 195
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “添加会员”
    帮助文件名 = “”

窗口 会员加钱
    左边 = 50
    顶边 = 50
    宽度 = 303
    高度 = 109
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “会员加钱”
    帮助文件名 = “”

窗口 修改会员
    左边 = 50
    顶边 = 50
    宽度 = 302
    高度 = 175
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “修改会员”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一





.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
.如果真 (等于 (文件是否存在 (相加 (取运行目录 (), “\hy.edb”)), 假))
    信息框 (“会员数据库不存在，请确定您的程序的完整性，请不要随便挪动数据库文件位置！”, #错误图标, “收费助手”)
    结束 ()
.如果真结束

刷新列表 ()


.子程序 刷新列表, 空白型, , 
.局部变量 计次, 整数型, , , 

打开 (相加 (取运行目录 (), “\hy.edb”), “hy”, 假, #无限制, , “124943922”, )
全部删除 ()
到首记录 ()
.计次循环首 (取记录数 (), 计次)
    相减 (计次, 1).插入表项 (到文本 (计次), , , , ) ' 参数一，插入位置，因为是计次循环，默认第一个位置为0，所以依次类推，往后都是循环次数减1。参数二，标题，本来我这是需要取电脑号的，因为软件按到底说是应该有客户端和服务端的，因暂时只有服务端，所以电脑名称用循环次数表示，有多少条数据库记录，就循环多少次，就显示多少电脑，哈哈。
    相减 (计次, 1).置标题 (1, 到文本 (读 (“会员卡号”))) ' 参数一，表项索引，和上面的插入位置索引是一样的，所以都是循环次数减1，参数二，列索引，这个很明显的，表项后面的第几列就填几，参数三，标题，呵呵当然从数据库中读出来的。
    相减 (计次, 1).置标题 (2, 到文本 (读 (“证件号码”)))
    相减 (计次, 1).置标题 (3, 读 (“上机时间”))
    相减 (计次, 1).置标题 (4, 到文本 (读 (“押金余额”)))
    相减 (计次, 1).置标题 (5, 到文本 (读 (“卡上余额”)))
    相减 (计次, 1).置标题 (6, 读 (“姓名”))
    跳到 (相加 (计次, 1)) ' 一条数据读完之后自动跳到下一条，所以为计次加1，如果不跳转到下一条，则会一直循环读那一条。
.计次循环尾 ()


.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

跳到 (相加 (., 1))
.如果真 (等于 (按钮索引, 0))
    载入 (添加会员, , 真)
.如果真结束
.如果真 (等于 (按钮索引, 1))
    .如果 (等于 (., -1))
        信息框 (“请选择您要删除的会员。”, #信息图标, “收费助手”)
    .否则
        .如果真 (等于 (信息框 (“是否真的要删除此会员，确认将被删除，取消将被放弃此操作。”, 相加 (#询问图标, #确认取消钮), “收费助手”), #确认钮))
            删除 ()
            彻底删除 ()
            刷新列表 ()
        .如果真结束
        
    .如果结束
    
.如果真结束
.如果真 (等于 (按钮索引, 2))
    .如果 (等于 (., -1))
        信息框 (“请选择您要修改的会员。”, #信息图标, “收费助手”)
    .否则
        载入 (真)
    .如果结束
    
.如果真结束
.如果真 (等于 (按钮索引, 3))
    .如果 (等于 (., -1))
        信息框 (“请选择需要加钱的会员卡号。”, #信息图标, “收费助手”)
    .否则
        载入 (会员加钱, , 真)
    .如果结束
    
.如果真结束
.如果真 (等于 (按钮索引, 4))
    刷新列表 ()
.如果真结束


.子程序 _时钟1_周期事件, 空白型, , 
刷新列表 ()


.窗口程序集 窗口程序集2, , , 

.子程序 _按钮2_被单击, 空白型, , 
添加会员.销毁 ()


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 金钱, 整数型, , , 
.局部变量 现行时间, 文本型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“会员卡号不能为空，请重新输入！”, #信息图标, “收费助手”)
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请正确填写开卡人的真实姓名！”, #信息图标, “收费助手”)
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“证件号码不能为空，请填写有效的证件号码！”, #信息图标, “收费助手”)
.如果真结束
.如果 (等于 (.内容, “”))
    信息框 (“请填写开卡金额！”, #信息图标, “收费助手”)
.否则
    加空记录 ()
    写 (“会员卡号”, 到整数 (.内容))
    写 (“姓名”, .内容)
    写 (“证件号码”, 到长整数 (.内容))
    赋值 (金钱, 到整数 (.内容))
    写 (“押金余额”, 到整数 (.内容))
    写 (“卡上余额”, 到整数 (.内容))
    赋值 (现行时间, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 到文本 (取月份 (取现行时间 ())), “月”, 到文本 (取日 (取现行时间 ())), “日”))
    写 (“冲值时间”, 现行时间)
    刷新列表 ()
    添加会员.销毁 ()
.如果结束



.窗口程序集 窗口程序集3, , , 

.子程序 _修改会员_创建完毕, 空白型, , 
赋值 (.内容, 到文本 (读 (“会员卡号”)))
赋值 (.内容, 读 (“姓名”))
赋值 (.内容, 到文本 (读 (“证件号码”)))



.子程序 _按钮1_被单击, 空白型, , 
写 (“会员卡号”, 到整数 (.内容))
写 (“姓名”, .内容)
写 (“ 证件号码”, 到整数 (.内容))
刷新列表 ()
修改会员.销毁 ()


.子程序 _按钮2_被单击, 空白型, , 
修改会员.销毁 ()


.窗口程序集 窗口程序集4, , , 

.子程序 _按钮2_被单击, 空白型, , 
会员加钱.销毁 ()


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 卡上余额, 整数型, , , 
.局部变量 现在金额, 整数型, , , 

赋值 (卡上余额, 读 (“卡上余额”))
赋值 (现在金额, 相加 (卡上余额, 到整数 (.内容)))
写 (“卡上余额”, 现在金额)
写 (“押金余额”, 现在金额)
刷新列表 ()
会员加钱.销毁 ()




 ' 不属于任何一个程序集、类模块的函数：
