 ' 文件类型：Windows窗口程序

 ' 程序名称：找别扭标记图辅助工具  --  爱燕城 Http://Www.2Yan.Com 荣誉出品
 ' 程序描述：找别扭标记图辅助工具  --  爱燕城 Http://Www.2Yan.Com 荣誉出品
 ' 程序作者：小可
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：Http://Www.1Vr.Cn
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 512
    高度 = 445
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “找别扭标记图辅助工具  --  爱燕城 Http://Www.2Yan.Com 荣誉出品 2007-08-13 14:00:48”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' Shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库
 ' eImgConverter 8FA3AA46276847db8F28E57E7FB97B7F 1 0 图像格式转换支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库





.窗口程序集 窗口程序集1, , , 

.程序集变量 临时文件地址, 文本型, , , 
.程序集变量 下载的图片, 字节集, , , 
.子程序 _画板_左图_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

打开 ()
.如果真 (不等于 (.文件名, “”))
    
    赋值 (.宽度, 未知支持库函数_31 (.文件名))
    赋值 (.高度, 未知支持库函数_32 (.文件名))
    
    统一调整位置过程 ()
    
    
    赋值 (.可视, 假)
    赋值 (.底图, 读入文件 (.文件名))
.如果真结束


.子程序 统一调整位置过程, 空白型, , 
赋值 (.顶边, 5)
赋值 (.顶边, 5)

赋值 (.左边, 5)
赋值 (.左边, 相加 (.宽度, 15))

赋值 (_启动窗口.宽度, 相加 (.宽度, .宽度, 25))

.如果 (大于 (相减 (.高度, .高度), 0))
    赋值 (_启动窗口.高度, 相加 (.高度, 50, .高度))
.否则
    赋值 (_启动窗口.高度, 相加 (.高度, 50, .高度))
.如果结束

赋值 (.顶边, 相减 (_启动窗口.高度, 30, .高度))


.子程序 _画板_右图_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

打开 ()
.如果真 (不等于 (.文件名, “”))
    
    赋值 (.宽度, 未知支持库函数_31 (.文件名))
    赋值 (.高度, 未知支持库函数_32 (.文件名))
    
    统一调整位置过程 ()
    
    赋值 (.可视, 假)
    赋值 (.底图, 读入文件 (.文件名))
.如果真结束


.子程序 __启动窗口_将被销毁, 空白型, , 
.如果真 (文件是否存在 (临时文件地址))
    删除文件 (临时文件地址)
.如果真结束


.子程序 _画板_左图_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 


相减 (横向位置, 12).画椭圆 (相加 (纵向位置, 12), 相加 (横向位置, 12), 相减 (纵向位置, 12))
相减 (横向位置, 12).画椭圆 (相加 (纵向位置, 12), 相加 (横向位置, 12), 相减 (纵向位置, 12))



.子程序 _画板_右图_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

相减 (12).画椭圆 (相加 (12), 相加 (12), 相减 (12))
相减 (12).画椭圆 (相加 (12), 相加 (12), 相减 (12))


.子程序 _按钮_保存标记图_被单击, 空白型, , 
.局部变量 保存文件地址, 文本型, , , 
.局部变量 临时保存图片地址, 文本型, , , 

.如果 (或者 (大于 (到数值 (.内容), 100), 小于 (到数值 (.内容), 1)))
    信息框 (“图片压缩率应为'1-100'之间!”, 相加 (0, #错误图标), “错误”)
.否则
    置随机数种子 ()
    赋值 (相加 (未知支持库函数_7 (#), “2yan_”, 到文本 (取随机数 (1000, 99999)), “.jpg”))
    赋值 (相加 (未知支持库函数_7 (#), “2yan_”, 到文本 (取随机数 (1000, 99999)), “.tmp”))
     ' 隐藏控件,调整窗口大小
     ' 连续赋值 (假, 按钮_保存标记图.可视, 标签_压缩率.可视, 编辑框_压缩率.可视)
    .如果 (大于 (相减 (.高度, .宽度), 0))
        赋值 (_启动窗口.高度, 相加 (.高度, 40))
    .否则
        赋值 (_启动窗口.高度, 相加 (.高度, 40))
    .如果结束
    
    赋值 (.可视, 假)
    处理事件 ()
     ' 截图到临时文件夹,然后转换格式到桌面
    .如果真 (写到文件 (快照 (取窗口句柄 (), , )))
        .如果真 (等于 (未知支持库函数_0 (临时保存图片地址, 保存文件地址, 假, 到数值 (.内容), 真, 0), 1))
            置剪辑板文本 ()
            信息框 (相加 (“已成功保存到”, #换行符, 保存文件地址, #换行符, “图片地址已经复制到剪辑板”), 相加 (0, #信息图标), “保存”)
        .如果真结束
        
    .如果真结束
     ' 显示控件
     ' 连续赋值 (真, 按钮_保存标记图.可视, 标签_压缩率.可视, 编辑框_压缩率.可视)
    赋值 (.可视, 真)
    统一调整位置过程 ()
.如果结束


.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (.过滤器, “图片文件(*.bmp,*.jpg,*.gif)|*.gif;*.jpg;*.bmp|所有文件(*.*)|*.*”)
赋值 (.初始目录, 未知支持库函数_7 (#))


.子程序 _标签_未载入图片左_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_画板_左图_鼠标右键被放开 (横向位置, 纵向位置, 功能键状态)


.子程序 _标签_未载入图片右_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_画板_右图_鼠标右键被放开 (横向位置, 纵向位置, 功能键状态)

.子程序 _按钮_竖排图片_被单击, 空白型, , 
打开 ()
.如果真 (不等于 (.文件名, “”))
    
     ' 调整画板大小
    赋值 (.宽度, 未知支持库函数_31 (.文件名))
    赋值 (.高度, 相除 (未知支持库函数_32 (.文件名), 2))
    赋值 (.宽度, 未知支持库函数_31 (.文件名))
    赋值 (.高度, 相除 (未知支持库函数_32 (.文件名), 2))
    
    未知函数_67174607 ()
    
    
    赋值 (.宽度, 未知支持库函数_31 (.文件名))
    赋值 (.高度, 未知支持库函数_32 (.文件名))
    赋值 (.底图, 读入文件 (.文件名))
     ' 左侧
    0.复制 (0, 未知支持库函数_31 (.文件名), 相除 (未知支持库函数_32 (.文件名), 2), , , , )
     ' 右侧
    0.复制 (相除 (未知支持库函数_32 (.文件名), 2), 未知支持库函数_31 (.文件名), 相除 (未知支持库函数_32 (.文件名), 2), , , , )
.如果真结束


.子程序 _按钮_横排图片_被单击, 空白型, , 
打开 ()
.如果真 (不等于 (.文件名, “”))
     ' 调整画板大小
    赋值 (.宽度, 相除 (未知支持库函数_31 (.文件名), 2))
    赋值 (.高度, 未知支持库函数_32 (.文件名))
    赋值 (.宽度, 相除 (未知支持库函数_31 (.文件名), 2))
    赋值 (.高度, 未知支持库函数_32 (.文件名))
    
    
    统一自动载图调整控件过程 ()
    
    赋值 (.宽度, 未知支持库函数_31 (.文件名))
    赋值 (.高度, 未知支持库函数_32 (.文件名))
    赋值 (.底图, 读入文件 (.文件名))
    
    
     ' 左侧
     ' 0.复制 (0, 相除 (未知支持库函数_31 (.文件名), 2), 未知支持库函数_32 (.文件名), , , , )
     ' 右侧
    相除 (未知支持库函数_31 (.文件名), 2).复制 (0, 相除 (未知支持库函数_31 (.文件名), 2), 未知支持库函数_32 (.文件名), , , , )
.如果真结束


.子程序 统一自动载图调整控件过程, 空白型, , 

赋值 (.可视, 假)
赋值 (.可视, 假)

赋值 (.顶边, 5)
赋值 (.顶边, 5)

赋值 (.左边, 5)
赋值 (.左边, 相加 (.宽度, 15))

赋值 (.宽度, 相加 (.宽度, .宽度, 25))

.如果 (大于 (相减 (.高度, .高度), 0))
    赋值 (.高度, 相加 (.高度, 50, .高度))
.否则
    赋值 (.高度, 相加 (.高度, 50, .高度))
.如果结束

赋值 (.顶边, 相减 (.高度, 30, .高度))


 ' 不属于任何一个程序集、类模块的函数：
