 ' 文件类型：Windows窗口程序

 ' 程序名称：E写字板
 ' 程序描述：云外归鸟制作
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 460
    高度 = 402
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “我的写字板1.1”
    帮助文件名 = “”

窗口 日期和时间
    左边 = 50
    顶边 = 50
    宽度 = 266
    高度 = 210
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “日期和时间”
    帮助文件名 = “”

窗口 查找
    左边 = 50
    顶边 = 50
    宽度 = 412
    高度 = 128
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “查找”
    帮助文件名 = “”

窗口 替换
    左边 = 50
    顶边 = 50
    宽度 = 409
    高度 = 186
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “替换”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 289
    高度 = 206
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于我的写字板”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' KRNLN d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二




数据类型 记录堆栈, , 
    .成员 范围, 空白型, , , 
    .成员 数值, 空白型, , , 

数据类型 堆栈, , 
    .成员 选择开始, 空白型, , , 
    .成员 文本, 文本型, , , 


.DLL命令 取场景句柄_API, 整数型, "", "GetDC", , 
    .参数 hwnd, 空白型, , 

.DLL命令 枚举字体_API, 空白型, "", "EnumFontFamiliesA", , 
    .参数 hdc, 空白型, , 
    .参数 lpszFamily, 空白型, , 
    .参数 lpEnumFontFamProc, 子程序指针, , 
    .参数 lparam, 空白型, , 

.DLL命令 删除场景_API, 空白型, "", "ReleaseDC", , 
    .参数 hwnd, 空白型, , 
    .参数 hdc, 空白型, , 

.DLL命令 TestLenM2W, 整数型, "", "MultiByteToWideChar", , MultiByteToWideChar (950, 0, pszBig5, -1, wszUnicode,iLen);
    .参数 a, 空白型, , 
    .参数 b0, 空白型, , 
    .参数 pszBig5, 文本型, , 
    .参数 a_1, 空白型, , 
    .参数 a0, 空白型, , 
    .参数 a1, 空白型, , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 现行文件名, 文本型, , , 
.程序集变量 是否已被修改, 逻辑型, , , 
.程序集变量 起始寻找位置, 空白型, , , 
.程序集变量 是否区分大小写, 逻辑型, , , 
.程序集变量 是否匹配单词, 逻辑型, , , 
.程序集变量 欲寻找文本, 文本型, , , 
.程序集变量 dqzfgs, 未知类型0x30004, , , 
.程序集变量 ztm, 堆栈, , "0", 
.程序集变量 zdx, 记录堆栈, , "0", 
.程序集变量 trapUndo, 逻辑型, , , 
.程序集变量 重复堆栈, 堆栈, , "0", 
.程序集变量 撤消堆栈, 堆栈, , "0", 
.程序集变量 检测中, 逻辑型, , , 
.子程序 __启动窗口_尺寸被改变, 空白型, , 
赋值 (., 相减 (_启动窗口., 8))
赋值 (., 相加 (相减 (_启动窗口., .可视, .高度, ., .), 12))
赋值 (.高度, .)

.子程序 _打开_被选择, 空白型, , 
.如果真 (等于 (询问保存文档 (), 假))
    trapUndo ＝ 假
    重定义数组 (重复堆栈, 假, 0)
    重定义数组 (撤消堆栈, 假, 0)
    赋值 (现行文件名, 未知支持库函数_22 ())
    trapUndo ＝ 真
    .如果真 (不等于 (现行文件名, “”))
        赋值 (., 相加 (“我的写字板1.1 ― ”, 现行文件名))
        赋值 (是否已被修改, 假)
    .如果真结束
    
.如果真结束


.子程序 询问保存文档, 逻辑型, , 返回真表示用户选择了中止
.局部变量 询问返回, 整数型, , , 

.如果真 (等于 (是否已被修改, 真))
    赋值 (询问返回, 信息框 (“文件已经被修改，是否保存？”, 相加 (#取消是否钮, #询问图标), “询问”))
    .如果真 (等于 (询问返回, #是钮))
        _保存_被选择 ()
    .如果真结束
    .如果真 (等于 (询问返回, #取消钮))
        返回 (真)
    .如果真结束
    
.如果真结束
返回 (假)

.子程序 _另存为_被选择, 空白型, , 
赋值 (.类型, 1)
赋值 (.标题, “请输入或选择欲保存到的文件名：”)
.如果 (打开 ())
    .如果 (等于 (到小写 (取文本右边 (.文件名, 3)), “txt”))
        赋值 (., 0)
    .否则
        赋值 (., 1)
    .如果结束
    保存文档 (.文件名)
.否则
    
.如果结束


.子程序 保存文档, 空白型, , 
.参数 文件名, 文本型, , 

.局部变量 保存文件名, 文本型, , , 
.局部变量 文件号, 整数型, , , 

保存文件名 ＝ 选择 (是否为空 (文件名), 现行文件名, 文件名)
设置修改状态 (假)
赋值 (文件号, 打开文件 (文件名, #重写, ))
.如果真 (不等于 (文件号, 0))
    .如果 (等于 (写出文本 (文件号, .), 真))
        赋值 (现行文件名, 文件名)
        赋值 (., 相加 (“我的写字板1.1 ― ”, 现行文件名))
        加入常用文件名 (保存文件名)
        赋值 (是否已被修改, 假)
    .否则
        
    .如果结束
    关闭文件 (文件号)
    返回 ()
.如果真结束
信息框 (相加 (“保存”, 文件名, “文件失败！”), #错误图标, “错误”)

.子程序 _保存_被选择, 空白型, , 
.局部变量 文件名, 文本型, , , 

.判断开始 (等于 (到小写 (取文本右边 (现行文件名, 3)), “txt”))
    赋值 (., 0)
    赋值 (文件名, 现行文件名)
    保存文档 (文件名)
.判断 (等于 (到小写 (取文本右边 (现行文件名, 3)), “rtf”))
    赋值 (., 1)
    赋值 (文件名, 现行文件名)
    保存文档 (文件名)
.默认
    _另存为_被选择 ()
.判断结束


.子程序 _超级编辑框1_内容被改变, 空白型, , 
.局部变量 临时堆栈, 堆栈, , , 

赋值 (是否已被修改, 真)
.如果真 (trapUndo)
    重定义数组 (重复堆栈, 假, 0)
    赋值 (临时堆栈.选择开始, .)
    赋值 (临时堆栈.文本, .)
    加入成员 (撤消堆栈, 临时堆栈)
    .如果真 (大于 (取数组成员数 (撤消堆栈), 20))
        删除成员 (撤消堆栈, 1, )
    .如果真结束
    禁止控制 ()
.如果真结束


.子程序 禁止控制, 空白型, , 
赋值 (.禁止, 取反 (大于 (取数组成员数 (撤消堆栈), 1)))
赋值 (.禁止, 取反 (大于 (取数组成员数 (重复堆栈), 0)))
.如果 (.禁止)
    10.加入状态 (#禁止)
.否则
    10.去除状态 (#禁止)
.如果结束
.如果 (.禁止)
    9.加入状态 (#禁止)
.否则
    9.去除状态 (#禁止)
.如果结束
_超级编辑框1_选择区被改变 ()


.子程序 _新建_被选择, 空白型, , 
.如果真 (等于 (询问保存文档 (), 假))
    赋值 (., “”)
    赋值 (., “我的写字板1.1”)
    设置修改状态 (假)
    赋值 (现行文件名, “”)
    赋值 (是否已被修改, 假)
.如果真结束


.子程序 _撤消_被选择, 空白型, , 
撤消 ()

.子程序 _剪切_被选择, 空白型, , 
未知支持库函数_18 ()

.子程序 _复制_被选择, 空白型, , 
未知支持库函数_17 ()

.子程序 _粘贴_被选择, 空白型, , 
未知支持库函数_20 ()

.子程序 _全选_被选择, 空白型, , 
赋值 (., -1)

.子程序 _重复_被选择, 空白型, , 
重复 ()

.子程序 _删除_被选择, 空白型, , 
赋值 (., “”)

.子程序 _日期时间_被选择, 空白型, , 
载入 (日期和时间, , 真)

.子程序 _超级编辑框1_选择区被改变, 空白型, , 
.局部变量 ln, 逻辑型, , , 
.局部变量 检测字符格, 未知类型0x30004, , , 
.局部变量 检测段落, 未知类型0x30005, , , 
.局部变量 n, 空白型, , , 

1.置文本 (相加 (“所选择的字节数:”, 到文本 (.)))
3.置文本 (相加 (“第”, 到文本 (.未知支持库函数_5 (.)), “行”))
4.置文本 (相加 (“光标在”, 到文本 (.), “字节数处”))
.如果真 (trapUndo)
    .如果真 (等于 (., 0))
        赋值 (ln, 真)
    .如果真结束
    赋值 (.禁止, ln)
    赋值 (.禁止, ln)
    赋值 (.禁止, 取反 (剪辑板中可有文本 ()))
    赋值 (.禁止, ln)
    赋值 (ln, 假)
    .如果真 (等于 (取文本长度 (.), 0))
        赋值 (ln, 真)
    .如果真结束
    赋值 (.禁止, ln)
    .如果 (.禁止)
        6.加入状态 (#禁止)
    .否则
        6.去除状态 (#禁止)
    .如果结束
    .如果 (.禁止)
        7.加入状态 (#禁止)
    .否则
        7.去除状态 (#禁止)
    .如果结束
    .如果 (.禁止)
        8.加入状态 (#禁止)
    .否则
        8.去除状态 (#禁止)
    .如果结束
    
.如果真结束
赋值 (检测字符格, 未知支持库函数_9 ())
赋值 (检测段落, 未知支持库函数_11 ())
赋值 (.内容, 检测字符格.)
.如果 (等于 (检测字符格., 0))
    赋值 (.内容, “”)
.否则
    赋值 (.内容, 到文本 (检测字符格.))
.如果结束

.如果 (等于 (位与 (检测字符格., #粗体), #粗体))
    0.加入状态 (#选中)
.否则
    0.去除状态 (#选中)
.如果结束
.如果 (等于 (位与 (检测字符格., #斜体), #斜体))
    1.加入状态 (#选中)
.否则
    1.去除状态 (#选中)
.如果结束
.如果 (等于 (位与 (检测字符格., #下划线), #下划线))
    2.加入状态 (#选中)
.否则
    2.去除状态 (#选中)
.如果结束

置工具条状态 (检测字符格, 检测段落, 检测字符格.效果)
.计次循环首 (3, n)
    相加 (n, 3).去除状态 (#选中)
.计次循环尾 ()

.判断开始 (等于 (检测段落., 1))
    4.加入状态 (#选中)
.判断 (等于 (检测段落., 2))
    5.加入状态 (#选中)
.判断 (等于 (检测段落., 3))
    6.加入状态 (#选中)
.默认
    
.判断结束





.子程序 撤消, 空白型, , 
.局部变量 DeleteFlag, 逻辑型, , , 1087
.局部变量 objElement, 堆栈, , , 
.局部变量 chg, 文本型, , , 
.局部变量 d, 空白型, , , 

.如果真 (并且 (大于 (取数组成员数 (撤消堆栈), 1), trapUndo))
    赋值 (trapUndo, 假)
    赋值 (objElement, 撤消堆栈 [相减 (取数组成员数 (撤消堆栈), 1)])
    赋值 (., objElement.选择开始)
    赋值 (., objElement.文本)
    赋值 (., 0)
    加入成员 (重复堆栈, 撤消堆栈 [取数组成员数 (撤消堆栈)])
    删除成员 (撤消堆栈, 取数组成员数 (撤消堆栈), )
.如果真结束
禁止控制 ()
赋值 (trapUndo, 真)
获取焦点 ()

.子程序 重复, 空白型, , 
.局部变量 DeleteFlag, 逻辑型, , , 
.局部变量 objElement, 堆栈, , , 

.如果真 (并且 (大于 (取数组成员数 (重复堆栈), 0), trapUndo))
    赋值 (trapUndo, 假)
    赋值 (objElement, 重复堆栈 [取数组成员数 (重复堆栈)])
    赋值 (., objElement.文本)
    赋值 (., 0)
    赋值 (., objElement.选择开始)
    加入成员 (撤消堆栈, objElement)
    删除成员 (重复堆栈, 取数组成员数 (重复堆栈), )
.如果真结束
禁止控制 ()
赋值 (trapUndo, 真)
获取焦点 ()

.子程序 取字符长度, 整数型, , 
.参数 文本, 文本型, 参考, 

.局部变量 len, 整数型, , , 

赋值 (len, 未知函数_167838617 (936, 0, 文本, -1, 0, 0))
返回 (相减 (len, 1))

.子程序 查寻, 逻辑型, , 
.局部变量 所在位置, 空白型, , , 

赋值 (所在位置, 起始寻找位置.未知支持库函数_16 (是否区分大小写, 是否匹配单词, 欲寻找文本))
.如果 (等于 (所在位置, -1))
    信息框 (相加 (#左引号, “写字板”, #右引号, “已完成搜索文档。”), #信息图标, “写字板”)
    赋值 (起始寻找位置, 0)
    
.否则
    赋值 (., 所在位置)
    赋值 (., 取字符长度 (欲寻找文本))
    相减 (所在位置.未知支持库函数_5 (), 未知支持库函数_3 ()).未知支持库函数_6 ()
    赋值 (起始寻找位置, 相加 (所在位置, 取文本长度 (欲寻找文本)))
    返回 (真)
.如果结束
返回 (假)

.子程序 _查找_被选择, 空白型, , 
载入 (查找, , 真)

.子程序 _查找下一个_被选择, 空白型, , 
.如果真 (不等于 (欲寻找文本, “”))
    查寻 ()
.如果真结束


.子程序 _替换_被选择, 空白型, , 
载入 (替换, , 假)

.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.判断开始 (等于 (按钮索引, 0))
    _新建_被选择 ()
.判断 (等于 (按钮索引, 1))
    _打开_被选择 ()
.判断 (等于 (按钮索引, 2))
    _保存_被选择 ()
.判断 (等于 (按钮索引, 3))
    .如果真 (.开始打印 ())
        超级编辑框打印 (1, 1000)
        结束打印 ()
    .如果真结束
    
.判断 (等于 (按钮索引, 4))
    
.判断 (等于 (按钮索引, 5))
    _查找_被选择 ()
.判断 (等于 (按钮索引, 6))
    未知支持库函数_18 ()
.判断 (等于 (按钮索引, 7))
    未知支持库函数_17 ()
.判断 (等于 (按钮索引, 8))
    未知支持库函数_20 ()
.判断 (等于 (按钮索引, 9))
    _重复_被选择 ()
.判断 (等于 (按钮索引, 10))
    _撤消_被选择 ()
.判断 (等于 (按钮索引, 11))
    _日期时间_被选择 ()
.默认
    
.判断结束


.子程序 _工具条2_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.局部变量 段落, 未知类型0x30005, , , 

.判断开始 (等于 (按钮索引, 0))
    置字符格式 ()
.判断 (等于 (按钮索引, 1))
    置字符格式 ()
.判断 (等于 (按钮索引, 2))
    置字符格式 ()
.判断 (等于 (按钮索引, 3))
    514.发送信息 (0, 0)
.判断 (等于 (按钮索引, 4))
    赋值 (段落., 1)
.判断 (等于 (按钮索引, 5))
    赋值 (段落., 2)
.判断 (等于 (按钮索引, 6))
    赋值 (段落., 3)
.默认
    
.判断结束
.如果真 (大于或等于 (按钮索引, 4))
    段落.未知支持库函数_12 ()
.如果真结束


.子程序 _超级编辑框1_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 __启动窗口_创建完毕, 空白型, , 
取系统字体列表 ()
赋值 (dqzfgs, 未知支持库函数_7 ())
赋值 (.内容, dqzfgs.)
赋值 (.内容, 到文本 (dqzfgs.))

赋值 (trapUndo, 真)
禁止控制 ()
_超级编辑框1_内容被改变 ()
_超级编辑框1_选择区被改变 ()

.子程序 置工具条状态, 空白型, , 
.参数 当前字符格, 未知类型0x30004, , 
.参数 当前段落格, 未知类型0x30005, , 
.参数 包含效果, 空白型, , 

.局部变量 n, 空白型, , , 

赋值 (.内容, 当前字符格.)
.如果 (等于 (当前字符格., 0))
    赋值 (.内容, “”)
.否则
    赋值 (.内容, 到文本 (当前字符格.))
.如果结束
.如果 (等于 (位与 (当前字符格., #粗体), #粗体))
    0.加入状态 (#按下)
.否则
    0.去除状态 (#按下)
.如果结束
.如果 (等于 (位与 (当前字符格., #斜体), #斜体))
    1.加入状态 (#按下)
.否则
    1.去除状态 (#按下)
.如果结束
.如果 (等于 (位与 (当前字符格., #下划线), #下划线))
    2.加入状态 (#按下)
.否则
    2.去除状态 (#按下)
.如果结束
.如果 (等于 (位异或 (位与 (当前字符格., 1), 位与 (包含效果, 1)), 1))
    0.加入状态 (#变灰)
.否则
    0.去除状态 (#变灰)
.如果结束
.如果 (等于 (位异或 (位与 (当前字符格., 2), 位与 (包含效果, 2)), 2))
    1.加入状态 (#变灰)
.否则
    1.去除状态 (#变灰)
.如果结束
.如果 (等于 (位异或 (位与 (当前字符格., 4), 位与 (包含效果, 4)), 4))
    2.加入状态 (#变灰)
.否则
    2.去除状态 (#变灰)
.如果结束

.计次循环首 (3, n)
    相加 (n, 3).去除状态 (#变灰)
.计次循环尾 ()
.判断开始 (等于 (当前段落格., 1))
    4.加入状态 (#选中)
.判断 (等于 (当前段落格., 2))
    5.加入状态 (#选中)
.判断 (等于 (当前段落格., 3))
    6.加入状态 (#选中)
.默认
    .计次循环首 (3, n)
        相加 (n, 3).去除状态 (#选中)
        相加 (n, 3).加入状态 (#变灰)
    .计次循环尾 ()
.判断结束



.子程序 置字符格式, 空白型, , 
.参数 en, 逻辑型, 可空, 

.局部变量 val, 空白型, , , 
.局部变量 zfs, 未知类型0x30004, 静态, , 
.局部变量 n, 空白型, , , 

赋值 (zfs., .取项目文本 (.现行选中项))
.如果 (en)
    赋值 (zfs., 到数值 (.内容))
.否则
    赋值 (zfs., 到数值 (.取项目文本 (.现行选中项)))
.如果结束

.计次循环首 (3, n)
    .如果真 (等于 (位与 (相减 (n, 1).取状态 (), #选中), #选中))
        赋值 (val, 相加 (val, 求次方 (2, 相减 (n, 1))))
    .如果真结束
    
.计次循环尾 ()
赋值 (zfs., val)
赋值 (zfs., .颜色)
zfs.未知支持库函数_10 ()


.子程序 _组合框1_列表项被选择, 空白型, , 
.局部变量 mc, 未知类型0x30004, , , 

置字符格式 ()
获取焦点 ()

.子程序 _组合框2_列表项被选择, 空白型, , 

置字符格式 ()
获取焦点 ()

.子程序 _组合框1_将弹出列表, 空白型, , 
获取焦点 ()

.子程序 _组合框2_将弹出列表, 空白型, , 
获取焦点 ()

.子程序 _组合框2_放开某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    置字符格式 (真)
    获取焦点 ()
.如果真结束


.子程序 _颜色选择器1_颜色被改变, 空白型, , -16777216 
置字符格式 ()

.子程序 _设置字体_被选择, 空白型, , 
.局部变量 zfs, 未知类型0x30004, 静态, , 

赋值 (zfs, 未知支持库函数_9 ())

赋值 (.类型, 2)
赋值 (.字体大小, zfs.)
赋值 (.字体名称, zfs.)
赋值 (.字体颜色, zfs.)
赋值 (.加粗, 等于 (位与 (0.取状态 (), #选中), #选中))
赋值 (.倾斜, 等于 (位与 (1.取状态 (), #选中), #选中))
赋值 (.下划线, 等于 (位与 (2.取状态 (), #选中), #选中))
.如果真 (打开 ())
    赋值 (zfs., .字体名称)
    赋值 (zfs., .字体大小)
    赋值 (zfs., .字体颜色)
    .判断开始 (.加粗)
        赋值 (zfs., 相加 (zfs., 1))
    .判断 (.倾斜)
        赋值 (zfs., 相加 (zfs., 2))
    .判断 (.下划线)
        赋值 (zfs., 相加 (zfs., 4))
    .默认
        
    .判断结束
    zfs.未知支持库函数_10 ()
.如果真结束


.子程序 _关于_被选择, 空白型, , 
载入 (关于窗口, , 真)

.子程序 _退出_被选择, 空白型, , 
.如果真 (不等于 (询问保存文档 (), 真))
    销毁 ()
.如果真结束


.子程序 __启动窗口_可否被关闭, 逻辑型, , 
返回 (不等于 (询问保存文档 (), 真))

.子程序 _打印_被选择, 空白型, , 
.如果真 (.开始打印 ())
    超级编辑框打印 (1, 1000)
    结束打印 ()
.如果真结束


.窗口程序集 窗口程序集2, , , 

.子程序 _日期和时间_创建完毕, 空白型, , 
.局部变量 NOW, 日期时间型, , , 
.局部变量 year, 文本型, , , 
.局部变量 mon, 文本型, , , 
.局部变量 day, 文本型, , , 
.局部变量 week, 文本型, , , 
.局部变量 hour, 文本型, , , 
.局部变量 min, 文本型, , , 
.局部变量 sec, 文本型, , , 
.局部变量 weekn, 空白型, , , 
.局部变量 hour12, 文本型, , , 

赋值 (NOW, 取现行时间 ())
赋值 (year, 到文本 (取年份 (NOW)))
赋值 (mon, 到文本 (取月份 (NOW)))
赋值 (day, 到文本 (取日 (NOW)))
赋值 (weekn, 取星期几 (NOW))
.如果 (等于 (weekn, 1))
    赋值 (week, “星期日”)
.否则
    赋值 (week, 相加 (“星期”, 数值到大写 (相减 (weekn, 1), 真)))
.如果结束
赋值 (hour, 到文本 (取小时 (NOW)))
赋值 (min, 到文本 (取分钟 (NOW)))
赋值 (sec, 到文本 (取秒 (NOW)))
相加 (year, “-”, mon, “-”, day).加入项目 ()
相加 (取文本右边 (year, 2), “-”, mon, “-”, day).加入项目 ()
到文本 (取日期 (NOW)).加入项目 ()
相加 (year, “ ”, mon, “ ”, day).加入项目 ()
相加 (week, “ ”, year, “ ”, mon, “ ”, day).加入项目 ()
相加 (week, “ ”, 到文本 (取日期 (NOW))).加入项目 ()
相加 (hour, “:”, min).加入项目 ()
相加 (hour, “:”, min, “:”, sec).加入项目 ()
.如果 (小于 (到数值 (hour), 12))
    相加 (“上午 ”, hour, “:”, min, “:”, sec).加入项目 ()
    .如果真 (等于 (取文本长度 (hour), 1))
        赋值 (hour, 相加 (“0”, hour))
    .如果真结束
    相加 (“上午 ”, hour, “:”, min, “:”, sec).加入项目 ()
    
.否则
    .如果 (大于 (到数值 (hour), 12))
        赋值 (hour12, 到文本 (相减 (到数值 (hour), 12)))
    .否则
        赋值 (hour12, hour)
    .如果结束
    相加 (“下午 ”, hour12, “:”, min, “:”, sec).加入项目 ()
    .如果真 (等于 (取文本长度 (hour12), 1))
        赋值 (hour12, 相加 (“0”, hour12))
    .如果真结束
    相加 (“下午 ”, hour12, “:”, min, “:”, sec).加入项目 ()
.如果结束
赋值 (.现行选中项, 0)


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
赋值 (_启动窗口., 假)
赋值 (_启动窗口.., 0)
赋值 (_启动窗口.., .取项目文本 (.现行选中项))
赋值 (_启动窗口.., 1)
赋值 (_启动窗口., 真)
_超级编辑框1_内容被改变 ()
销毁 ()

.窗口程序集 窗口程序集3, , , 

.子程序 _查找_创建完毕, 空白型, , 
.如果真 (不等于 (_启动窗口., “”))
    赋值 (.内容, _启动窗口.)
    赋值 (.被选择字符数, -1)
    赋值 (.禁止, 假)
.如果真结束
赋值 (.选中, _启动窗口.)
赋值 (.选中, _启动窗口.)

.子程序 _选择框1_被单击, 空白型, , 
赋值 (_启动窗口., .选中)


.子程序 _选择框2_被单击, 空白型, , 
赋值 (_启动窗口., .选中)


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
赋值 (_启动窗口., .内容)
_启动窗口.查寻 ()
销毁 ()

.子程序 _编辑框1_内容被改变, 空白型, , 
.如果 (等于 (.内容, “”))
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
.如果结束


.子程序 _选择框1_被单击1, 空白型, , 
赋值 (_启动窗口., .选中)

.子程序 _选择框2_被单击1, 空白型, , 
赋值 (_启动窗口., .选中)

.窗口程序集 窗口程序集4, , , 

.程序集变量 寻找结果, 逻辑型, , , 
.子程序 _替换_创建完毕, 空白型, , 
.如果真 (不等于 (_启动窗口., “”))
    赋值 (.内容, _启动窗口.)
    赋值 (.被选择字符数, -1)
    连续赋值 (假, .禁止, .禁止, .禁止)
.如果真结束
赋值 (.选中, _启动窗口.)
赋值 (.选中, _启动窗口.)


.子程序 _选择框1_被单击, 空白型, , 
赋值 (_启动窗口., .选中)


.子程序 _选择框2_被单击, 空白型, , 
赋值 (_启动窗口., .选中)


.子程序 _编辑框1_内容被改变, 空白型, , 
.如果 (等于 (.内容, “”))
    连续赋值 (真, .禁止, .禁止, .禁止)
.否则
    连续赋值 (假, .禁止, .禁止, .禁止)
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
赋值 (_启动窗口., .内容)
.如果 (寻找结果)
    赋值 (_启动窗口.., .内容)
    _启动窗口.激活 ()
    替换.调整层次 (#顶层)
    赋值 (寻找结果, 假)
.否则
    赋值 (寻找结果, _启动窗口.查寻 ())
    .如果真 (寻找结果)
        赋值 (_启动窗口.., .内容)
        _启动窗口.激活 ()
        替换.调整层次 (#顶层)
        赋值 (寻找结果, 假)
        
    .如果真结束
    
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
赋值 (_启动窗口., .内容)
赋值 (寻找结果, _启动窗口.查寻 ())
_启动窗口.激活 ()
替换.调整层次 (#顶层)


.子程序 _按钮3_被单击, 空白型, , 
赋值 (_启动窗口., .内容)
.如果真 (寻找结果)
    赋值 (_启动窗口., 假)
    赋值 (_启动窗口.., .内容)
    
.如果真结束
.判断循环首 (_启动窗口.查寻 ())
    赋值 (_启动窗口., 假)
    赋值 (_启动窗口.., .内容)
.判断循环尾 ()
赋值 (_启动窗口., 真)
_超级编辑框1_内容被改变 ()
销毁 ()

.子程序 _按钮4_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集5, , , 

.子程序 _按钮1_被单击, 空白型, , 
销毁 ()

.程序集 取系统字体列表程序集, , , 

.子程序 取系统字体列表, 空白型, , 
.局部变量 hdc, 空白型, , , 

赋值 (hdc, 取场景句柄_API (0))
枚举字体_API (hdc, 0, &FontFamily, 0)
删除场景_API (0, hdc)

.子程序 FontFamily, 整数型, , 
.参数 ELGFont, 整数型, , 
.参数 ntm, 空白型, , 
.参数 fonttype, 空白型, , 
.参数 lparam, 空白型, , 

_启动窗口.加入项目 (., 指针到文本 (相加 (ELGFont, 28)), )
返回 (1)

.程序集 _模块_超级编辑框打印, , , ** 不要更改此处 超级编辑框打印1.2.ec

.子程序 超级编辑框打印, 整数型, , 打印开始成功后调用
.参数 超级编辑框, 未知类型0x30006, , 
.参数 打印机, 打印机, , 
.参数 开始字符位置, 整数型, , 
.参数 结束字符位置, 整数型, , 

 ' ** 本子程序功能由系统自动转交对应模块实现，可以删除但不能修改。


 ' 不属于任何一个程序集、类模块的函数：
