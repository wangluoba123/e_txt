 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 6 系统核心支持库



 ' 所需要的模块
 ' 彗星正则表达式类 C:\Documents and Settings\Administrator\桌面\cookie管理\彗星正则表达式类.ec



.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 winhttp, 对象, , , 
.局部变量 协议头, 文本型, , , 

winhttp.创建 (“WinHttp.WinHttpRequest.5.1”, ) ' 创建WINHTTP对象
winhttp.方法 (“open”, “GET”, “http://bbs.eyuyan.com”, 假)
winhttp.方法 (“SetRequestHeader”, “Cookie”, 读COOKIES (“eyuyan.com”)) ' 带Cookies访问
winhttp.方法 (“send”, ) ' 发送请求
赋值 (协议头, winhttp.读文本属性 (“GetAllResponseHeaders”, )) ' 取返回的协议头
存COOKIES (协议头, “eyuyan.com”) ' 保存COOKIES
输出调试文本 (读COOKIES (“eyuyan.com”)) ' 读出来

.子程序 存COOKIES, 逻辑型, , 
.参数 协议头, 文本型, , 
.参数 域名, 文本型, , 例：baidu.com  google.com

.局部变量 正则表达式类, 未知类型0x49010012, , , 
.局部变量 数量, 整数型, , , 
.局部变量 i, 整数型, , , 

.如果真 (等于 (协议头, “”))
    返回 (假)
.如果真结束
正则表达式类.未知函数_67174408 (“Set-Cookie: (.*?)=(.*?);”) ' 通过正则搜索所有COOKIE
正则表达式类.未知函数_67174411 (协议头)
赋值 (数量, 正则表达式类.未知函数_67174412 ())
.如果真 (等于 (数量, 0))
    返回 (假)
.如果真结束
.计次循环首 (数量, i)
    写配置项 (相加 (取运行目录 (), “\cookie\”, 域名, “.ini”), “cookies”, 正则表达式类.未知函数_67174414 (i, 1), 正则表达式类.未知函数_67174414 (i, 2)) ' 按域名将COOKIES分类
.计次循环尾 ()
返回 (真)

.子程序 读COOKIES, 文本型, , 
.参数 域名, 文本型, , 例：baidu.com  google.com

.局部变量 文件名, 文本型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 局部_COOKIES, 文本型, , , 
.局部变量 局部_文本, 文本型, , , 

赋值 (文件名, 寻找文件 (相加 (取运行目录 (), “\cookie\”, 域名, “.ini”), ))
赋值 (文件号, 打开文件 (相加 (取运行目录 (), “\cookie\”, 文件名), #读入, #无限制))
.如果真 (等于 (文件号, 0))
    返回 (“”) ' COOKIE文件不存在，返回空
.如果真结束
.循环判断首 ()
    赋值 (局部_文本, 删首尾空 (读入一行 (文件号)))
    .如果真 (或者 (等于 (删全部空 (局部_文本), “”), 近似等于 (局部_文本, “[”)))
        到循环尾 ()
    .如果真结束
    赋值 (局部_COOKIES, 相加 (局部_COOKIES, 局部_文本, “; ”))
.循环判断尾 (等于 (是否在文件尾 (文件号, ), 假))
.如果真 (不等于 (删全部空 (局部_COOKIES), “”))
    返回 (局部_COOKIES)
.如果真结束
关闭文件 (文件号)
返回 (“”)

.类模块 彗星正则表达式类, , , 

.子程序 创建, 逻辑型, , 根据指定的正则表达式文本创建一个正则表达式对象。本对象中的原有内容将被释放
.参数 正则表达式文本, 文本型, , 比如“易语言4\.0(模块|支持库)?”
.参数 忽略大小写, 逻辑型, 可空, 可以被省略。默认值为真。本参数指定这个正则表达式在创建成功后进行匹配、搜索、替换时，是否区分大小写。
.参数 匹配多行, 逻辑型, 可空, 可以被省略。默认值为真。如果本成员值为真，字符“^”不仅匹配目标文本的开头，而且匹配目标文本中换行符（字符(10)，字符(13)或 #换行符）的后面；字符“$”不仅匹配目标文本的结尾，而且匹配目标文本中换行符的前面。否则字符“^”仅仅匹配目标文本的开头，“$”也仅仅匹配目标文本的结尾。
.参数 全局匹配, 逻辑型, 可空, 



.子程序 取文本, 文本型, , 返回以文本形式表示的正则表达式。如果该对象尚未创建，则返回空文本。本命令为高级对象成员命令。


.子程序 替换, 文本型, , 替换在正则表达式查找中找到的文本。
.参数 欲被替换的文本, 文本型, , 将要进行文本替换的字符串
.参数 用作替换的文本, 文本型, 可空, 用作替换的文本



.子程序 搜索全部, 整数型, , 使用指定的正则表达式搜索指定文本中与该表达式匹配的所有子文本。返回匹配结果数量
.参数 欲被搜索的文本, 文本型, , 



.子程序 取匹配数量, 整数型, , 


.子程序 取匹配文本, 文本型, , 
.参数 匹配索引, 整数型, , 第几个匹配文本，索引值从1开始



.子程序 取子匹配文本, 文本型, , 
.参数 匹配索引, 整数型, , 第几个匹配文本，索引值从1开始
.参数 子表达式索引, 整数型, , 欲取其值的子表达式。该参数对应与正则表达式中的一个子表达式（以圆括号标记）。索引从1开始。



.子程序 取子表达式个数, 整数型, , 


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 初始化COM库, 整数型, , 在多线程的程序里创建COM对象前先初始化，一个线程只能调用一次


.子程序 取消COM库初始化, 空白型, , 取消COM库的初始化



 ' 不属于任何一个程序集、类模块的函数：
