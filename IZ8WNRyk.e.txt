 ' 文件类型：Windows窗口程序

 ' 程序名称：系统程序监察
 ' 程序描述：
 ' 程序作者：阿I・阿爸
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5a5x.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5a5x.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5a5x.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 165
    高度 = 83
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “系统程序监察”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 3 0 应用接口支持库
 ' sock A6B983789F624b2cBDFD7D671249C097 2 0 网络通讯支持库
 ' internet 707ca37322474f6ca841f0e224f4b620 2 0 互联网支持库
 ' eImgConverter 8FA3AA46276847db8F28E57E7FB97B7F 2 0 图像格式转换支持库





.DLL命令 API_Beep, 整数型, "kernel32.dll", "Beep", , 用于生成简单的声音  TRUE（非零）表示成功，否则返回零。会设置GetLastError
    .参数 声音频率, 整数型, , 声音频率（从37Hz到32767Hz）。在windows95中忽略
    .参数 声音持续时间, 整数型, , 声音的持续时间，以毫秒为单位。如为-1，表示一直播放声音，直到再次调用该函数为止。在windows95中会被忽略;

.窗口程序集 窗口程序集1, , , 

.程序集变量 窗口句柄数组下标, 整数型, , , 
.程序集变量 窗口句柄数组, 文本型, , "0", 
.程序集变量 窗口标题, 文本型, , , 
.程序集变量 窗口标题数组, 文本型, , "0", 
.程序集变量 窗口标题数组下标, 整数型, , , 
.程序集变量 本机IP, 文本型, , , 
.程序集变量 文件号, 整数型, , , 
.程序集变量 本机名字, 文本型, , , 
.程序集变量 当前目录, 文本型, , , 
.程序集变量 限制程序数组, 文本型, , "0", 
.程序集变量 例外程序数组, 文本型, , "0", 
.程序集变量 例外程序, 文本型, , , 
.程序集变量 例外程序数组下标, 整数型, , , 
.程序集变量 限制程序数组下标, 整数型, , , 
.程序集变量 自启动, 逻辑型, , , 
.程序集变量 IP, 文本型, , , 
.程序集变量 IP长度, 整数型, , , 
.程序集变量 IP点位, 整数型, , , 
.程序集变量 本机配置文件名, 文本型, , , 
.程序集变量 成功, 逻辑型, , , 
.程序集变量 窗口标题数量, 整数型, , , 
.程序集变量 例外程序数量, 整数型, , , 
.程序集变量 打开文件, 整数型, , , 
.程序集变量 版本号, 文本型, , , 
.程序集变量 限制程序数量, 整数型, , , 
.程序集变量 当前版本号, 文本型, , , 
.程序集变量 找到文本, 整数型, , , 
.程序集变量 计算机描述, 文本型, , , 
.程序集变量 截图文件名, 文本型, , , 
.程序集变量 现行时间, 日期时间型, , , 
.程序集变量 年, 整数型, , , 
.程序集变量 月, 整数型, , , 
.程序集变量 日, 整数型, , , 
.程序集变量 时, 整数型, , , 
.程序集变量 分, 整数型, , , 
.程序集变量 秒, 整数型, , , 
.程序集变量 流水号, 文本型, , , 
.程序集变量 程序名, 文本型, , , 
.程序集变量 系统进程数组, 未知类型0x20009, , "0", 
.程序集变量 匿名程序集变量_184, 空白型, , , 
.程序集变量 系统进程数组下标, 整数型, , , 
.程序集变量 运行次数, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
 ' --========  易语言资源网  (www.5a5x.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5a5x.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5a5x.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5a5x.com  ================--

暂停 ()
_禁止多重启动 ()
未知支持库函数_11 (“updata.exe”)
赋值 (当前版本号, “20091208”)
_取计算机描述 ()
_自动更新 ()
_注册自启动 ()
_取配置文件名 ()
_更新配置文件 ()
_取例外程序表 ()
_取限制程序表 ()
_剔除例外程序 ()
_取所有窗口列表 ()
_程序比对 ()

.子程序 _通知增加新配置, 空白型, , 
暂停 ()
赋值 (成功, 未知支持库函数_0 (“邮件服务器IP或地址”, , “发件人邮箱地址”, “发件人邮箱密码”, 60000))
.如果真 (等于 (成功, 假))
    未知支持库函数_0 (“邮箱服务器IP或地址”, , “发件人邮箱地址”, “发件人邮箱密码”, 60000)
.如果真结束
未知支持库函数_5 (相加 (“机器名字：”, 未知支持库函数_16 (), “(”, 计算机描述, “)，IP：”, 未知支持库函数_47 (), “，未有配置文件：”, 本机配置文件名, “，需要建立！”), 相加 (“机器名字：”, 未知支持库函数_16 (), “(”, 计算机描述, “)”, #换行符, “ＩＰ地址：”, 未知支持库函数_47 (), #换行符, “配置文件：”, 本机配置文件名), “发件人邮箱地址”, , , “发件人邮箱地址”, “发件人邮箱地址”)
未知支持库函数_1 ()
 ' 本源码来自易语言资源网(www.5a5x.com)

.子程序 _更新配置文件, 空白型, , 
暂停 ()
赋值 (成功, 未知支持库函数_8 (“邮件服务器IP或地址”, , , 21, ))
.如果真 (等于 (成功, 假))
    未知支持库函数_8 (“FTP服务器地址或IP”, , , 21, )
.如果真结束
未知支持库函数_16 (“Monitoring”)
.循环判断首 ()
    赋值 (成功, 未知支持库函数_10 (“MonPRG.ini”, “C:\Program Files\Monitoring\MonPRG.ini”, ))
.循环判断尾 (等于 (成功, 假))
赋值 (成功, 未知支持库函数_10 (本机配置文件名, 相加 (“C:\Program Files\Monitoring\”, 本机配置文件名), ))
.如果真 (等于 (成功, 假))
    _通知增加新配置 ()
.如果真结束
未知支持库函数_9 ()

.子程序 _取配置文件名, 空白型, , 
暂停 ()
赋值 (IP长度, 取文本长度 (未知支持库函数_47 ()))
赋值 (IP, 取文本右边 (未知支持库函数_47 (), 相减 (IP长度, 10)))
赋值 (本机名字, 未知支持库函数_16 ())
赋值 (本机配置文件名, 相加 (IP, 本机名字, “.ini”))

.子程序 _取所有窗口列表, 空白型, , 
暂停 ()
赋值 (窗口句柄数组, 未知支持库函数_75 ())
赋值 (窗口句柄数组下标, 1)
 ' 本源码来自易语言资源网(www.5a5x.com)
.计次循环首 (取数组成员数 (窗口句柄数组), )
    赋值 (窗口标题, 未知支持库函数_76 (到数值 (窗口句柄数组 [窗口句柄数组下标])))
    .如果真 (不等于 (窗口标题, “”))
        加入成员 (窗口标题数组, 窗口标题)
    .如果真结束
    赋值 (窗口句柄数组下标, 相加 (窗口句柄数组下标, 1))
.计次循环尾 ()

.子程序 _程序比对, 空白型, , 
暂停 ()
赋值 (窗口标题数量, 取数组成员数 (窗口标题数组))
赋值 (窗口标题数组下标, 1)

赋值 (限制程序数量, 取数组成员数 (限制程序数组))
赋值 (限制程序数组下标, 1)

.循环判断首 ()
    .循环判断首 ()
        赋值 (找到文本, 寻找文本 (窗口标题数组 [窗口标题数组下标], 限制程序数组 [限制程序数组下标], , 假))
        .如果真 (不等于 (找到文本, -1))
            暂停 ()
            _受限处理 ()
        .如果真结束
        赋值 (限制程序数组下标, 相加 (限制程序数组下标, 1))
    .循环判断尾 (不等于 (限制程序数组下标, 相加 (限制程序数量, 1)))
    赋值 (限制程序数组下标, 1)
    赋值 (窗口标题数组下标, 相加 (窗口标题数组下标, 1))
.循环判断尾 (不等于 (窗口标题数组下标, 相加 (窗口标题数量, 1)))
 ' 本源码来自易语言资源网(www.5a5x.com)
清除数组 (窗口句柄数组)
清除数组 (窗口标题数组)
清除数组 (限制程序数组)
清除数组 (例外程序数组)
清除数组 (系统进程数组)

.子程序 _受限处理, 空白型, , 
暂停 ()
 ' 计次循环首 (10, )
 ' API_Beep (700, 500)
 ' API_Beep (1300, 500)

_截图处理 ()
 ' 终止进程 (窗口标题数组 [窗口标题数组下标])

赋值 (成功, 未知支持库函数_0 (“邮件服务器IP或地址”, , “发件人邮箱地址”, “发件人邮箱密码”, 60000))
.如果真 (等于 (成功, 假))
    未知支持库函数_0 (“邮箱服务器IP或地址”, , “发件人邮箱地址”, “发件人邮箱密码”, 60000)
.如果真结束
未知支持库函数_4 ()
未知支持库函数_2 (相加 (截图文件名, “.JPG”))
未知支持库函数_5 (相加 (“机器名字：”, 未知支持库函数_16 (), “(”, 计算机描述, “)，IP：”, 未知支持库函数_47 (), “ ，运行了受限程序：”, 窗口标题数组 [窗口标题数组下标], “，受限程序被关闭！”), 相加 (“机器名字：”, 未知支持库函数_16 (), “(”, 计算机描述, “)”, #换行符, “ＩＰ地址：”, 未知支持库函数_47 (), #换行符, “受限程序：”, 窗口标题数组 [窗口标题数组下标], #换行符, “运行时间：”, 到文本 (取现行时间 ())), “发件人邮箱地址”, , , “发件人邮箱地址”, “发件人邮箱地址”)
未知支持库函数_1 ()
删除文件 (相加 (截图文件名, “.JPG”))

.子程序 _截图处理, 空白型, , 
赋值 (现行时间, 取现行时间 ())
赋值 (年, 取年份 (现行时间))
赋值 (月, 取月份 (现行时间))
赋值 (日, 取日 (现行时间))
赋值 (时, 取小时 (现行时间))
赋值 (分, 取分钟 (现行时间))
赋值 (秒, 取秒 (现行时间))
赋值 (流水号, 相加 (到文本 (年), 到文本 (月), 到文本 (日), 到文本 (时), 到文本 (分), 到文本 (秒)))
赋值 (截图文件名, 相加 (未知支持库函数_16 (), “(”, 计算机描述, “)_”, 流水号))
未知支持库函数_74 (#., 相加 (截图文件名, “.BMP”))

未知支持库函数_0 (相加 (截图文件名, “.BMP”), 相加 (截图文件名, “.JPG”), 假, 75, 真, 0)
删除文件 (相加 (截图文件名, “.BMP”))

.子程序 _取限制程序表, 空白型, , 
暂停 ()
重定义数组 (限制程序数组, 假, 1)
赋值 (限制程序数组下标, 1)
赋值 (文件号, 打开文件 (“MonPRG.ini”, #读入, #禁止读写))
赋值 (限制程序数组 [限制程序数组下标], 读入一行 (文件号))
.循环判断首 ()
    加入成员 (限制程序数组, 读入一行 (文件号))
.循环判断尾 (等于 (是否在文件尾 (文件号, 真), 假))
 ' 本源码来自易语言资源网(www.5a5x.com)
关闭文件 (文件号)

.子程序 _取例外程序表, 空白型, , 
暂停 ()
重定义数组 (例外程序数组, 假, 1)
赋值 (例外程序数组下标, 1)
赋值 (文件号, 打开文件 (本机配置文件名, #读入, #禁止读写))
赋值 (例外程序数组 [例外程序数组下标], 读入一行 (文件号))
.循环判断首 ()
    加入成员 (例外程序数组, 读入一行 (文件号))
.循环判断尾 (等于 (是否在文件尾 (文件号, 真), 假))

.如果真 (等于 (例外程序数组 [取数组成员数 (例外程序数组)], “”))
    删除成员 (例外程序数组, 取数组成员数 (例外程序数组), 1)
.如果真结束

关闭文件 (文件号)

.子程序 _剔除例外程序, 空白型, , 
暂停 ()
赋值 (限制程序数组下标, 1)
赋值 (例外程序数组下标, 1)
.计次循环首 (取数组成员数 (限制程序数组), )
    赋值 (例外程序数组下标, 1)
    .计次循环首 (取数组成员数 (例外程序数组), )
        .如果真 (等于 (限制程序数组 [限制程序数组下标], 例外程序数组 [例外程序数组下标]))
            赋值 (限制程序数组 [限制程序数组下标], “”)
        .如果真结束
        赋值 (例外程序数组下标, 相加 (例外程序数组下标, 1))
    .计次循环尾 ()
    赋值 (限制程序数组下标, 相加 (限制程序数组下标, 1))
.计次循环尾 ()

赋值 (限制程序数组下标, 1)
.计次循环首 (取数组成员数 (限制程序数组), )
    .如果 (等于 (限制程序数组 [限制程序数组下标], “”))
        删除成员 (限制程序数组, 限制程序数组下标, 1)
    .否则
        赋值 (限制程序数组下标, 相加 (限制程序数组下标, 1))
    .如果结束
    
.计次循环尾 ()

.子程序 _时钟_自动更新_周期事件, 空白型, , 
暂停 ()
_自动更新 ()
_取配置文件名 ()
_更新配置文件 ()

.子程序 _注册自启动, 空白型, , 
暂停 ()
赋值 (自启动, 注册项是否存在 (#本地机器, “SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Monitoring”))
.如果真 (等于 (自启动, 假))
    写注册项 (#本地机器, “SOFTWARE\Microsoft\Windows\CurrentVersion\Run\Monitoring”, 相加 (取运行目录 (), “\Monitoring.exe”))
.如果真结束


.子程序 _自动更新, 空白型, , 
暂停 ()
 ' 本源码来自易语言资源网(www.5a5x.com)
.如果真 (不等于 (取当前目录 (), “C:\Program Files\Monitoring\”))
    复制文件 (“Monitoring.exe”, “C:\Program Files\Monitoring\Monitoring.exe”)
.如果真结束

改变目录 (“C:\Program Files\Monitoring\”)

赋值 (成功, 未知支持库函数_8 (“邮件服务器IP或地址”, , , 21, ))
.如果真 (等于 (成功, 假))
    未知支持库函数_8 (“FTP服务器地址或IP”, , , 21, )
.如果真结束
未知支持库函数_16 (“Monitoring”)
.循环判断首 ()
    赋值 (成功, 未知支持库函数_10 (“ver.ini”, “C:\Program Files\Monitoring\ver.ini”, ))
.循环判断尾 (等于 (成功, 假))
未知支持库函数_9 ()
赋值 (文件号, 打开文件 (“ver.ini”, #读入, #禁止读))
赋值 (版本号, 读入一行 (文件号))
关闭文件 (文件号)
.如果真 (不等于 (版本号, 当前版本号))
    赋值 (成功, 未知支持库函数_8 (“邮件服务器IP或地址”, , , 21, ))
    .如果真 (等于 (成功, 假))
        未知支持库函数_8 (“FTP服务器地址或IP”, , , 21, )
    .如果真结束
    未知支持库函数_16 (“Monitoring”)
    .循环判断首 ()
        赋值 (成功, 未知支持库函数_10 (“updata.exe”, “C:\Program Files\Monitoring\updata.exe”, ))
    .循环判断尾 (等于 (成功, 假))
    未知支持库函数_9 ()
    运行 (“updata.exe”, 假, )
    结束 ()
.如果真结束


.子程序 _时钟_系统监察_周期事件, 空白型, , 
暂停 ()
_取例外程序表 ()
_取限制程序表 ()
_剔除例外程序 ()
_取所有窗口列表 ()
_程序比对 ()

.子程序 _取计算机描述, 空白型, , 
暂停 ()
赋值 (计算机描述, 取文本注册项 (#本地机器, “SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters\srvcomment”, ))

.子程序 _禁止多重启动, 空白型, , 
暂停 ()
赋值 (程序名, 取执行文件名 ())
赋值 (系统进程数组, 未知支持库函数_10 ())
赋值 (系统进程数组下标, 1)
赋值 (运行次数, 0)
 ' 本源码来自易语言资源网(www.5a5x.com)
.循环判断首 ()
    .如果真 (等于 (系统进程数组 [系统进程数组下标], , 程序名))
        赋值 (运行次数, 相加 (运行次数, 1))
    .如果真结束
    .如果真 (等于 (运行次数, 2))
        结束 ()
    .如果真结束
    赋值 (系统进程数组下标, 相加 (系统进程数组下标, 1))
.循环判断尾 (不等于 (系统进程数组下标, 相加 (取数组成员数 (系统进程数组), 1)))



 ' 不属于任何一个程序集、类模块的函数：
