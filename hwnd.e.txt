 ' 文件类型：Windows模块源码

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0



.常量 GW_CHILD, "5", , 
.常量 GW_HWNDFIRST, "0", , 
.常量 GW_HWNDLAST, "1", , 
.常量 GW_HWNDNEXT, "2", , 
.常量 GW_HWNDPREV, "3", , 
.常量 GW_OWNER, "4", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库





.DLL命令 SendMessage, 整数型, "", "SendMessageA", , 
    .参数 hwnd, 整数型, , 
    .参数 a, 整数型, , 
    .参数 b, 整数型, , 
    .参数 c, 整数型, , 

.DLL命令 SendMessage2, 整数型, "", "SendMessageA", , 
    .参数 hwnd, 整数型, , 
    .参数 a, 整数型, , 
    .参数 b, 整数型, , 
    .参数 c, 文本型, , 

.DLL命令 GetClassName, 整数型, "", "GetClassNameA", , 
    .参数 hwnd, 整数型, , 
    .参数 name, 文本型, , 
    .参数 nMaxCount, 整数型, , 

.DLL命令 GetWindowText, 空白型, "", "GetWindowTextA", , 
    .参数 hwnd, 整数型, , 
    .参数 name, 文本型, , 
    .参数 nMaxCount, 整数型, , 

.DLL命令 FindWindow, 整数型, "", "FindWindowA", , 
    .参数 class, 文本型, , 
    .参数 title, 文本型, , 

.DLL命令 ShowWindow, 整数型, "user32", "ShowWindow", , 
    .参数 hwnd, 整数型, , 
    .参数 nCmdShow, 整数型, , 

.DLL命令 GetParent, 整数型, "", "GetParent", 公开, user32.dll判断指定窗口的父窗口  父窗口的句柄。如窗口没有父，或遇到错误，则返回零。
    .参数 窗口句柄, 整数型, , 欲测试的窗口的句柄;

.DLL命令 GetWindow, 整数型, "", "GetWindow", , 获得一个窗口的句柄，该窗口与某源窗口有特定的关系
    .参数 源窗口, 整数型, , 
    .参数 关系, 整数型, , 

.DLL命令 EnableWindow, 空白型, "", "EnableWindow", , 
    .参数 hwnd, 整数型, , 
    .参数 bEnable, 逻辑型, , 

.DLL命令 GetWindowLong, 整数型, "user32.dll", "GetWindowLongA", , 
    .参数 句柄, 整数型, , 
    .参数 信息, 整数型, , 

.DLL命令 SetWindowPos, 逻辑型, "user32.dll", "SetWindowPos", , 
    .参数 hWnd, 整数型, , 
    .参数 hWndlnsertAfter, 整数型, , 
    .参数 X, 整数型, , 
    .参数 Y, 整数型, , 
    .参数 cx, 整数型, , 
    .参数 cy, 整数型, , 
    .参数 Flags, 整数型, , 

.DLL命令 FindWindowEx, 整数型, "user32", "FindWindowExA", 公开, , 在窗口列表中寻找与指定条件相符的第一个子窗口  找到的窗口的句柄。如未找到相符窗口，则返回零。会设置GetLastError
    .参数 窗口句柄1, 整数型, , 在其中查找子的父窗口。如设为零，表示使用桌面窗口（通常说的顶级窗口都被认为是桌面的子窗口，所以也会对它们进行查找）
    .参数 窗口句柄2, 整数型, , 从这个窗口后开始查找。这样便可利用对FindWindowEx的多次调用找到符合条件的所有子窗口。如设为零，表示从第一个子窗口开始搜索
    .参数 欲搜索的类名, 文本型, , 欲搜索的类名。“”表示忽略
    .参数 欲搜索的标题, 文本型, , 欲搜索的标题。“”表示忽略;

.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码
_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
.局部变量 窗口, 句柄操作类, , , 
.局部变量 编辑框, 句柄操作类, , , 
.局部变量 Backspace, 句柄操作类, , , 
.局部变量 按钮8, 句柄操作类, , , 

 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

运行 (“calc.exe”, 假, )
.判断循环首 (等于 (窗口.通过标题创建 (“计算器”), 0))
    处理事件 ()
.判断循环尾 ()
窗口.置内容 (“句柄操作类模块演示”)
延时 (1000)
窗口.置内容 (“这个窗口已经被禁止，5秒后恢复”)
窗口.禁止 (真)
延时 (5000)
窗口.禁止 (假)
窗口.置内容 (“----------这个窗口已经被置顶，5秒后恢复”)
窗口.总在最前 (真)
延时 (5000)
窗口.总在最前 (假)
窗口.置内容 (“现在演示取得/修改/禁止子窗口”)
编辑框.创建 (窗口.取子句柄 ())
编辑框.置内容 (“这是我改的.”)
延时 (3000)
窗口.置内容 (“现在你看Backspace，被禁止了哦！”)
Backspace.创建 (窗口.寻找子句柄_标题 (“Backspace”))
Backspace.禁止 (真)
延时 (3000)
窗口.置内容 (“Backspace看不见了”)
Backspace.可视 (假)
延时 (3000)
窗口.置内容 (“现在我来点击8，20下”)
按钮8.创建 (窗口.寻找子句柄_标题 (“8”))
.计次循环首 (20, )
    按钮8.按钮_点击 ()
     ' 本源码来自易语言资源网(www.5A5X.com)
    
.计次循环尾 ()
延时 (3000)
窗口.置内容 (“再见~~~~~~~~~~~~~~”)
延时 (1000)
窗口.销毁 ()
 ' 窗口.置内容 (“现在这个窗口已经关不掉了”)

.类模块 句柄操作类, , , 

.程序集变量 hwnd, 整数型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 创建, 逻辑型, , 成功返回真，失败返回假。
.参数 句柄, 整数型, , 

赋值 (hwnd, 句柄)
返回 (真)

.子程序 通过标题创建, 整数型, 公开, 成功返回句柄，失败返回0。
.参数 标题, 文本型, , 

.局部变量 空, 文本型, , , 

赋值 (hwnd, FindWindow (空, 标题))
 ' 本源码来自易语言资源网(www.5A5X.com)

返回 (hwnd)

.子程序 通过类名创建, 整数型, 公开, 成功返回句柄，失败返回0。
.参数 类名, 文本型, , 

.局部变量 空, 文本型, , , 

赋值 (hwnd, FindWindow (类名, 空))
返回 (hwnd)

.子程序 通过标题类名创建, 整数型, 公开, 比单独通过标题/类名的，避免了同类名。成功返回句柄，失败返回0。
.参数 标题, 文本型, , 
.参数 类名, 文本型, , 

赋值 (hwnd, FindWindow (类名, 标题))
返回 (hwnd)

.子程序 取当前句柄, 整数型, 公开, 返回当前正在操作的句柄。
返回 (hwnd)

.子程序 发送信息, 整数型, , 返回SendMessage返回的数值。
.参数 参数1, 整数型, , 
.参数 参数2, 整数型, 可空, 
.参数 参数3, 整数型, 可空, 

返回 (SendMessage (hwnd, 参数1, 参数2, 参数3))

.子程序 发送文本信息, 整数型, , 返回SendMessage返回的数值。
.参数 参数1, 整数型, , 
.参数 参数2, 整数型, 可空, 
.参数 文本参数, 文本型, 可空, 

返回 (SendMessage2 (hwnd, 参数1, 参数2, 文本参数))

.子程序 取标题, 文本型, , 取操作句柄的标题。
.局部变量 save, 文本型, , , 

赋值 (save, 取空白文本 (256))
GetWindowText (hwnd, save, 256)
返回 (save)

.子程序 取内容, 文本型, , 取操作句柄的标题。
.局部变量 save, 文本型, , , 

赋值 (save, 取空白文本 (SendMessage (hwnd, 14, 0, 0)))
SendMessage2 (hwnd, 13, 取文本长度 (save), save)
返回 (save)

.子程序 置内容, 整数型, , 设置操作句柄的标题。成功返回1，失败返回0。
.参数 内容, 文本型, , 

返回 (SendMessage2 (hwnd, 12, 0, 内容))

.子程序 取类名, 文本型, , 取操作句柄的类名。
.局部变量 save, 文本型, , , 

赋值 (save, 取空白文本 (256))
GetClassName (hwnd, save, 256)
返回 (save)

.子程序 销毁, 整数型, , 销毁操作句柄。
返回 (SendMessage (hwnd, 16, 0, 0))

.子程序 可视, 逻辑型, , 第一个参数为空表示取是否可视。
.参数 可视, 逻辑型, 可空, 

.如果 (是否为空 (可视))
    返回 (等于 (位或 (GetWindowLong (hwnd, -16), 268435456), GetWindowLong (hwnd, -16)))
.否则
    ShowWindow (hwnd, 选择 (可视, 1, 0))
    返回 (可视)
.如果结束


.子程序 禁止, 逻辑型, 公开, 第一个参数为空表示取是否禁止。
.参数 禁止, 逻辑型, 可空, 

.如果 (是否为空 (禁止))
    返回 (等于 (位或 (GetWindowLong (hwnd, -16), 134217728), GetWindowLong (hwnd, -16)))
.否则
    EnableWindow (hwnd, 取反 (禁止))
    返回 (禁止)
.如果结束
 ' 本源码来自易语言资源网(www.5A5X.com)


.子程序 总在最前, 逻辑型, 公开, 第一个参数为空表示取是否置顶。
.参数 禁止, 逻辑型, 可空, 

.如果 (是否为空 (禁止))
    返回 (等于 (位或 (GetWindowLong (hwnd, -20), 8), GetWindowLong (hwnd, -20)))
.否则
    SetWindowPos (hwnd, 选择 (禁止, -1, -2), 0, 0, 0, 0, 3)
    返回 (禁止)
.如果结束


.子程序 取父句柄, 整数型, , 
返回 (GetParent (hwnd))

.子程序 取子句柄, 整数型, , 取得子窗口中的第一个窗口句柄
返回 (GetWindow (hwnd, #GW_CHILD))

.子程序 寻找子句柄_类名, 整数型, , 
.参数 类名, 文本型, , 

返回 (FindWindowEx (hwnd, 0, 类名, 字符 (0)))

.子程序 寻找子句柄_标题, 整数型, , 
.参数 标题, 文本型, , 

返回 (FindWindowEx (hwnd, 0, 字符 (0), 标题))

.子程序 取上一个句柄, 整数型, , 取得上一个窗口句柄
返回 (GetWindow (hwnd, #GW_HWNDLAST))

.子程序 取下一个句柄, 整数型, 公开, 取得下一个窗口句柄
返回 (GetWindow (hwnd, #GW_HWNDPREV))

.子程序 取窗口风格, 整数型, 公开, 
返回 (GetWindowLong (hwnd, -16))

.子程序 取窗口扩展风格, 整数型, 公开, 
返回 (GetWindowLong (hwnd, -20))
 ' 本源码来自易语言资源网(www.5A5X.com)


.子程序 按钮_点击, 空白型, , 其它操作不加了。郁闷。
SendMessage (hwnd, 245, 0, 0)


 ' 不属于任何一个程序集、类模块的函数：
