 ' 文件类型：Windows窗口程序

 ' 程序名称：易用账本
 ' 程序描述：
 ' 程序作者：葛大强
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口

XTTTTTT[┏─┓┏──────────────────────────────┓┏─┓
U┌→例程源码U│大││代码写人生，行行彰显作者心性；网络看世相，处处演绎红尘烟云。││大│
U大XTTTTa│强│┣──────────────────────────────┫│强│
U强U　　　　　│学││⒈学习重基础，多看帮助，多看支持库说明　　　　　　　　　　　││源│
U学^TTT[　│易││⒉从基本的流程控制、变量操作入手，多写基础例程　　　　　　　││码│
U易→零基础U　│之││⒊脚踏实地，从自己能做的地方开始　　　　　　　　　　　　　　││特│
U程XTTTa　│基││⒋遇着问题，可以先放一放，把其他地方弄好，再回头解决问题　　││别│
U序U　　　　　│础││⒌没人能帮你学习，只有自己。学或不学，都在于自己。　　　　　││整│
U集^TTTT[│例││⒍邮箱：daqiangclub@163.com 　　　　　　　　　　　　　　　　││理│
U└→详细注释U│程││⒎留言：http://hi.baidu.com/%B4%F3%C7%BF%B9%A4%D7%F7%CA%D2　││版│
^TTTTTTa┗─┛┗──────────────────────────────┛┗─┛

    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “易用账本（大强作品）”
    帮助文件名 = “”

窗口 窗口关于
    左边 = 50
    顶边 = 50
    宽度 = 320
    高度 = 240
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于 易用账本”
    帮助文件名 = “”

窗口 窗口登录
    左边 = 50
    顶边 = 50
    宽度 = 400
    高度 = 300
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 12632256 '  0xC0C0C0
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “欢迎使用”
    帮助文件名 = “”



.常量 关于文本, "“
　　感谢您使用《易用账本》软件！
　　本软件可以帮您记录每一笔收入与支出，可以快速查询你所记录的账目。
　　本软件在设计上力求使用方便、操作简单，你只需点击几个按钮，就能完成记账。每个按钮都操作说明，一看便知其功能。
　　本软件使用全中文可视化的编程语言易语言来编写，软件更适合中国人使用。
　　如果您对本软件有任何的意见或建议，请与我们联系。


”", , 
.常量 帮助文本, "“
账目查询　点击［查询最近一周的账目］或［查询近30天的账目］，就可以　　
　　　　　自动查出最近一周或最近30天之内的账目记录；点击［用户自定
　　　　　义时间查询］，系统自动为您查询您指定时间内的账目记录。在
　　　　　使用自定义查询的时候，请别忘了选择要查询的起止时间，然后
　　　　　点击［立即查询］，就可以获得查询结果了。

添加账目　点击［添加账目］按钮，右边的添加账目功能即被激活，你只需
　　　　　选择要记账的日期、收／支情况，填写收支的金额数值与简要的
　　　　　收支说明，然后点击［确认添加］，即可完成记账。如果您觉得
　　　　　输入有误，可以点击［清除重写］，系统会为您把所有内容恢复
　　　　　到原始状态，等待您的输入。

修改密码　这个版本没有设置修改密码的功能，以后会设置的。

退出系统　您可以关闭窗口或点击［退出系统］按钮，以退出本软件。在使
　　　　　用本软件的时候请务必正确退出，以确保您记录的每一条数据都
　　　　　能够正确保存。

　　再次感谢您使用本软件！”", , 
.图片 空白数据库, " ' 已保存到：D:\易语言学习\Data\易用账本.e\空白数据库", , mydata.mdb账本空白数据库，默认用户名：ADMIN，用户密码：888，数据库密码：391545711


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一



 ' 所需要的模块
 ' 压缩ACCESS数据库模块 $压缩ACCESS数据库.ec



.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
 ' XTTTTTT[┏─┓┏──────────────────────────────┓┏─┓
 ' U┌→例程源码U│大││代码写人生，行行彰显作者心性；网络看世相，处处演绎红尘烟云。││大│
 ' U大XTTTTa│强│┣──────────────────────────────┫│强│
 ' U强U          │学││⒈学习重基础，多看帮助，多看支持库说明                      ││源│
 ' U学^TTT[  │易││⒉从基本的流程控制、变量操作入手，多写基础例程              ││码│
 ' U易→零基础U  │之││⒊脚踏实地，从自己能做的地方开始                            ││特│
 ' U程XTTTa  │基││⒋遇着问题，可以先放一放，把其他地方弄好，再回头解决问题    ││别│
 ' U序U          │础││⒌没人能帮你学习，只有自己。学或不学，都在于自己。          ││整│
 ' U集^TTTT[│例││⒍邮箱：daqiangclub@163.com                                 ││理│
 ' U└→详细注释U│程││⒎留言：http://hi.baidu.com/%B4%F3%C7%BF%B9%A4%D7%F7%CA%D2  ││版│
 ' ^TTTTTTa┗─┛┗──────────────────────────────┛┗─┛
 ' 数据库名：mydata.mdb，密码：391545711
 ' 用户表名：USERLIST
 ' 字段：ID，自动编号
 ' 字段：USERNAME，文本，用户名
 ' 字段：USERKEY，文本，用户密码
 ' 数据表名：USERDATA
 ' 字段：ID，自动编号
 ' 字段：DATE，日期时间，账目录入时间
 ' 字段：NOTE，文本，账目摘要
 ' 字段：DATA，数字，收支金额
 ' 字段：USERID，数字，记账用户的ID
 ' XTTTTTT[┏─┓┏──────────────────────────────┓┏─┓
 ' U┌→例程源码U│大││代码写人生，行行彰显作者心性；网络看世相，处处演绎红尘烟云。││大│
 ' U大XTTTTa│强│┣──────────────────────────────┫│强│
 ' U强U          │学││⒈学习重基础，多看帮助，多看支持库说明                      ││源│
 ' U学^TTT[  │易││⒉从基本的流程控制、变量操作入手，多写基础例程              ││码│
 ' U易→零基础U  │之││⒊脚踏实地，从自己能做的地方开始                            ││特│
 ' U程XTTTa  │基││⒋遇着问题，可以先放一放，把其他地方弄好，再回头解决问题    ││别│
 ' U序U          │础││⒌没人能帮你学习，只有自己。学或不学，都在于自己。          ││整│
 ' U集^TTTT[│例││⒍邮箱：daqiangclub@163.com                                 ││理│
 ' U└→详细注释U│程││⒎留言：http://hi.baidu.com/%B4%F3%C7%BF%B9%A4%D7%F7%CA%D2  ││版│
 ' ^TTTTTTa┗─┛┗──────────────────────────────┛┗─┛
 ' 数据库文件不存在，则写出空白数据库
.如果真 (取反 (文件是否存在 (相加 (取运行目录 (), “\mydata.mdb”))))
    写到文件 (相加 (取运行目录 (), “\mydata.mdb”), #空白数据库)
.如果真结束
 ' 打开数据库
.如果真 (取反 (相加 (取运行目录 (), “\mydata.mdb”).打开MDB数据库 (“391545711”, , )))
    信息框 (“打开数据库失败，系统将关闭。”, 16, “系统出错”)
    结束 ()
.如果真结束
 ' 载入用户登陆窗口
载入 (窗口登录, , 真)
 ' XTTTTTT[┏─┓┏──────────────────────────────┓┏─┓
 ' U┌→例程源码U│大││代码写人生，行行彰显作者心性；网络看世相，处处演绎红尘烟云。││大│
 ' U大XTTTTa│强│┣──────────────────────────────┫│强│
 ' U强U          │学││⒈学习重基础，多看帮助，多看支持库说明                      ││源│
 ' U学^TTT[  │易││⒉从基本的流程控制、变量操作入手，多写基础例程              ││码│
 ' U易→零基础U  │之││⒊脚踏实地，从自己能做的地方开始                            ││特│
 ' U程XTTTa  │基││⒋遇着问题，可以先放一放，把其他地方弄好，再回头解决问题    ││别│
 ' U序U          │础││⒌没人能帮你学习，只有自己。学或不学，都在于自己。          ││整│
 ' U集^TTTT[│例││⒍邮箱：daqiangclub@163.com                                 ││理│
 ' U└→详细注释U│程││⒎留言：http://hi.baidu.com/%B4%F3%C7%BF%B9%A4%D7%F7%CA%D2  ││版│
 ' ^TTTTTTa┗─┛┗──────────────────────────────┛┗─┛
赋值 (_启动窗口., 真)
 ' 登陆成功后显示一周账目
赋值 (.选中, 真)
_单选一周_被单击 ()


.子程序 禁止按钮功能, 空白型, , 
连续赋值 (真, .禁止, .禁止, .禁止, .禁止)
赋值 (.输入方式, 1)
赋值 (.输入方式, 1)
赋值 (.标题, “账目详情”)


.子程序 允许按钮功能, 空白型, , 
连续赋值 (假, .禁止, .禁止, .禁止, .禁止)
赋值 (.输入方式, 0)
赋值 (.最大允许长度, 200)
赋值 (.输入方式, 4)
赋值 (.最大允许长度, 12)


.子程序 _单选一周_被单击, 空白型, , 
禁止按钮功能 ()
连续赋值 (真, .禁止, .禁止, .禁止)
赋值 (.今天, 取现行时间 ())
赋值 (.今天, 增减时间 (.今天, 5, -7))
查询子程序 ()


.子程序 _单选30天_被单击, 空白型, , 
禁止按钮功能 ()
连续赋值 (真, .禁止, .禁止, .禁止)
赋值 (.今天, 取现行时间 ())
赋值 (.今天, 增减时间 (.今天, 5, -30))
查询子程序 ()


.子程序 _单选自定义_被单击, 空白型, , 
禁止按钮功能 ()
连续赋值 (假, .禁止, .禁止, .禁止)
连续赋值 (取现行时间 (), .最大日期, .今天, .最大日期, .今天)


.子程序 _按钮查询_被单击, 空白型, , 
.如果真 (大于 (.今天, .今天))
    信息框 (相加 (“对不起，起始时间不能晚于起始时间”, #换行符, “请重新设置”), 48, “系统提示”)
    获取焦点 ()
    返回 ()
.如果真结束
查询子程序 ()


.子程序 _编辑框金额_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, 取代码 (“-”, )))
    返回 (0)
.如果真结束


.子程序 _编辑框金额_失去焦点, 空白型, , 
赋值 (.内容, 到文本 (到数值 (.内容)))


.子程序 _按钮添加账目_被单击, 空白型, , 
允许按钮功能 ()
_按钮重写_被单击 ()
赋值 (.最大日期, 取现行时间 ())
赋值 (.今天, 取现行时间 ())
赋值 (.最小日期, 增减时间 (取现行时间 (), 5, -10))
赋值 (.标题, “添加账目”)


.子程序 _按钮确认入账_被单击, 空白型, , 
.判断开始 (小于或等于 (.现行选中项, 0))
    信息框 (“请选择出入或支出　　”, 48, “系统提示”)
    获取焦点 ()
    返回 ()
.判断 (等于 (到数值 (.内容), 0))
    信息框 (“请填写收支金额　　”, 48, “系统提示”)
    获取焦点 ()
    返回 ()
.判断 (等于 (.内容, “”))
    信息框 (“请填写收支说明　　”, 48, “系统提示”)
    获取焦点 ()
    返回 ()
.默认
     ' XTTTTTT[┏─┓┏──────────────────────────────┓┏─┓
     ' U┌→例程源码U│大││代码写人生，行行彰显作者心性；网络看世相，处处演绎红尘烟云。││大│
     ' U大XTTTTa│强│┣──────────────────────────────┫│强│
     ' U强U          │学││⒈学习重基础，多看帮助，多看支持库说明                      ││源│
     ' U学^TTT[  │易││⒉从基本的流程控制、变量操作入手，多写基础例程              ││码│
     ' U易→零基础U  │之││⒊脚踏实地，从自己能做的地方开始                            ││特│
     ' U程XTTTa  │基││⒋遇着问题，可以先放一放，把其他地方弄好，再回头解决问题    ││别│
     ' U序U          │础││⒌没人能帮你学习，只有自己。学或不学，都在于自己。          ││整│
     ' U集^TTTT[│例││⒍邮箱：daqiangclub@163.com                                 ││理│
     ' U└→详细注释U│程││⒎留言：http://hi.baidu.com/%B4%F3%C7%BF%B9%A4%D7%F7%CA%D2  ││版│
     ' ^TTTTTTa┗─┛┗──────────────────────────────┛┗─┛
.判断结束
 ' XTTTTTT[┏─┓┏──────────────────────────────┓┏─┓
 ' U┌→例程源码U│大││代码写人生，行行彰显作者心性；网络看世相，处处演绎红尘烟云。││大│
 ' U大XTTTTa│强│┣──────────────────────────────┫│强│
 ' U强U          │学││⒈学习重基础，多看帮助，多看支持库说明                      ││源│
 ' U学^TTT[  │易││⒉从基本的流程控制、变量操作入手，多写基础例程              ││码│
 ' U易→零基础U  │之││⒊脚踏实地，从自己能做的地方开始                            ││特│
 ' U程XTTTa  │基││⒋遇着问题，可以先放一放，把其他地方弄好，再回头解决问题    ││别│
 ' U序U          │础││⒌没人能帮你学习，只有自己。学或不学，都在于自己。          ││整│
 ' U集^TTTT[│例││⒍邮箱：daqiangclub@163.com                                 ││理│
 ' U└→详细注释U│程││⒎留言：http://hi.baidu.com/%B4%F3%C7%BF%B9%A4%D7%F7%CA%D2  ││版│
 ' ^TTTTTTa┗─┛┗──────────────────────────────┛┗─┛
.如果真 (等于 (信息框 (相加 (“记录日期：”, 时间到文本 (.今天, 2), #换行符, .取项目文本 (.现行选中项), “：”, .内容, #换行符, #换行符, “确定记账请按[是]，重写请按[否]”), 相加 (4, 32, 256), “入账确认”), 5))
    添加新账目 ()
.如果真结束


.子程序 _按钮重写_被单击, 空白型, , 
连续赋值 (“”, .内容, .内容)
赋值 (.现行选中项, 0)
赋值 (.今天, 取现行时间 ())
获取焦点 ()


.子程序 _按钮帮助_被单击, 空白型, , 
信息框 (#帮助文本, 64, “系统帮助”)


.子程序 _按钮改密_被单击, 空白型, , 
信息框 (“对不起，暂不提供密码修改功能。　”, 64, “系统提示”)


.子程序 _按钮关于_被单击, 空白型, , 
载入 (窗口关于, , 真)


.子程序 _按钮退出_被单击, 空白型, , 
.如果真 (是否退出 ())
    销毁 ()
.如果真结束


.子程序 _账目列表_当前表项被改变, 空白型, , 
.局部变量 SQL, 文本型, , , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 账目金额, 整数型, , , 

 ' 数据表名：USERDATA
 ' 字段：ID，自动编号
 ' 字段：DATE，日期时间，账目录入时间
 ' 字段：NOTE，文本，账目摘要
 ' 字段：DATA，数字，收支金额
 ' 字段：USERID，数字，记账用户的ID
赋值 (SQL, 相加 (“select * from USERDATA where USERID=”, .标记, “and ID=”, 到文本 (.取表项数值 (.))))

赋值 (记录集句柄, SQL.查询 ()) ' 查询数据库
.如果真 (等于 (记录集句柄, 0)) ' 查询失败的处理
    信息框 (“数据库查询失败！　”, 48, “查询出错”)
    返回 ()
.如果真结束

禁止按钮功能 ()

记录集句柄.到首记录 ()

赋值 (.今天, 记录集句柄.读 (“DATE”))
赋值 (账目金额, 到数值 (记录集句柄.读 (“DATA”)))
赋值 (.现行选中项, 选择 (大于 (账目金额, 0), 1, 2))
赋值 (.内容, 到文本 (取绝对值 (账目金额)))
赋值 (.内容, 记录集句柄.读 (“NOTE”))

记录集句柄.关闭记录集 ()


.子程序 查询子程序, 空白型, , 
.局部变量 SQL, 文本型, , , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 X, 整数型, , , 
.局部变量 起始时间, 文本型, , , 
.局部变量 截止时间, 文本型, , , 

 ' 数据表名：USERDATA
 ' 字段：ID，自动编号
 ' 字段：DATE，日期时间，账目录入时间
 ' 字段：NOTE，文本，账目摘要
 ' 字段：DATA，数字，收支金额
 ' 字段：USERID，数字，记账用户的ID
赋值 (起始时间, 相加 (到文本 (取时间部分 (.今天, #年份)), “-”, 到文本 (取时间部分 (.今天, #月份)), “-”, 到文本 (取时间部分 (.今天, #日))))

赋值 (截止时间, 相加 (到文本 (取时间部分 (.今天, #年份)), “-”, 到文本 (取时间部分 (.今天, #月份)), “-”, 到文本 (取时间部分 (.今天, #日))))

赋值 (SQL, 相加 (“select * from USERDATA where USERID=”, .标记, “and DATE between #”, 起始时间, “# and #”, 截止时间, “# order by DATE ASC”)) ' 数据库查询语句命令

赋值 (记录集句柄, SQL.查询 ()) ' 查询数据库
.如果真 (等于 (记录集句柄, 0)) ' 查询失败的处理
    信息框 (“数据库查询失败！　”, 48, “查询出错”)
    返回 ()
.如果真结束
 ' 查询成功，则进行如下操作
禁止按钮功能 ()
 ' 清空超级列表框
全部删除 ()
 ' 到首记录
记录集句柄.到首记录 ()
 ' 填充超级列表框
赋值 (X, 0)
.判断循环首 (取反 (记录集句柄.尾记录后 ()))
    X.插入表项 (记录集句柄.读 (“ID”))
    
    X.置标题 (0, 到文本 (记录集句柄.读 (“DATE”))) ' 日期
    X.置标题 (1, 取文本左边 (记录集句柄.读 (“NOTE”), 40)) ' 事由
    X.置标题 (2, 到文本 (记录集句柄.读 (“DATA”))) ' 金额
    
    记录集句柄.到后一记录 ()
    
    赋值 (X, 相加 (X, 1))
.判断循环尾 ()
记录集句柄.关闭记录集 ()

赋值 (., 相减 (取表项数 (), 1))



.子程序 添加新账目, 空白型, , 
.局部变量 SQL, 文本型, , , 
.局部变量 添加成功, 逻辑型, , , 
.局部变量 入账时间, 文本型, , , 

 ' 数据表名：USERDATA
 ' 字段：ID，自动编号
 ' 字段：DATE，日期时间，账目录入时间
 ' 字段：NOTE，文本，账目摘要
 ' 字段：DATA，数字，收支金额
 ' 字段：USERID，数字，记账用户的ID
赋值 (入账时间, 相加 (到文本 (取时间部分 (.今天, #年份)), “-”, 到文本 (取时间部分 (.今天, #月份)), “-”, 到文本 (取时间部分 (.今天, #日))))
 ' 信息框 (入账时间, 0, )

赋值 (SQL, 相加 (“INSERT INTO USERDATA ([DATE] , [NOTE] , [DATA] , [USERID] ) VALUES ( #”, 入账时间, “# , '”, .内容, “' , ”, 到文本 (相乘 (多项选择 (.现行选中项, 1, -1), 到数值 (.内容))), “ , ”, .标记, “)”))


赋值 (添加成功, SQL.执行 ())

.如果 (添加成功)
    .如果 (等于 (信息框 (相加 (“账目添加成功！继续记账吗？”, .内容, #换行符, #换行符, “继续记账请按[是]，否则请按[否]　　”), 相加 (4, 64, 256), “添加成功”), 5))
        _按钮重写_被单击 ()
    .否则
        _按钮查询_被单击 ()
        
    .如果结束
    
.否则
    信息框 (相加 (“对不起，账目没能添加成功！　　”, #换行符, “请稍后再试。”), 16, “添加失败”)
    
.如果结束


.子程序 __启动窗口_可否被关闭, 逻辑型, , 
是否退出 ()


.子程序 是否退出, 逻辑型, , 
.如果 (等于 (信息框 (“真的要退出吗？”, 相加 (1, 32, 256), “确认退出”), 1))
    返回 (假)
.否则
    返回 (真)
.如果结束


.子程序 __启动窗口_将被销毁, 空白型, , 
结束处理 ()


.子程序 结束处理, 空白型, , 
 ' 关闭数据库
关闭 ()
 ' 压缩数据库
压缩ACCESS数据库 (相加 (取运行目录 (), “\mydata.mdb”), “391545711”)



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 压缩ACCESS数据库, 整数型, , 压缩指定的ACCESS数据库。请注意先关闭数据库。返回0成功，返回1则是创建系统对象失败，返回2是调用失败，返回3是数据库使用中
.参数 路径, 文本型, , ACCESS数据库文件所在路径，必须是电脑中确实存在的文件
.参数 密码, 文本型, 可空, ACCESS数据库密码，如果没有密码，请留空，否则请给出ACCESS的密码



.窗口程序集 窗口程序集2, , , 

.子程序 _窗口关于_创建完毕, 空白型, , 
赋值 (.内容, #关于文本)
获取焦点 ()


.子程序 _按钮1_被单击, 空白型, , 
销毁 ()


.窗口程序集 窗口程序集3, , , 

.子程序 _窗口登录_创建完毕, 空白型, , 
赋值 (_启动窗口..标记, “”)
赋值 (.内容, “”)
读取用户名 ()


.子程序 _按钮登录确认_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (“请输入用户名！　”, 48, “系统提示”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入用户密码！　”, 48, “系统提示”)
    获取焦点 ()
    返回 ()
.如果真结束
判断密码输入是否正确 ()


.子程序 _按钮放弃登录_被单击, 空白型, , 
结束处理 ()
结束 ()


.子程序 _窗口登录_可否被关闭, 逻辑型, , 
返回 (假)



.子程序 读取用户名, 空白型, , 
.局部变量 SQL, 文本型, , , 
.局部变量 用户记录集, 整数型, , , 

 ' 用户表名：USERLIST
 ' 字段：ID，自动编号
 ' 字段：USERNAME，文本，用户名
 ' 字段：USERKEY，文本，用户密码

清空 ()

赋值 (SQL, “select * from USERLIST”)
赋值 (用户记录集, _启动窗口.查询 (., SQL))
_启动窗口.到首记录 (., 用户记录集)
.判断循环首 (取反 (_启动窗口.尾记录后 (., 用户记录集)))
    _启动窗口.读 (., 用户记录集, “USERNAME”).加入项目 (到数值 (_启动窗口.读 (., 用户记录集, “ID”)))
    _启动窗口.到后一记录 (., 用户记录集)
.判断循环尾 ()


.子程序 判断密码输入是否正确, 空白型, , 
.局部变量 SQL, 文本型, , , 
.局部变量 用户记录集, 整数型, , , 
.局部变量 YY, 整数型, , , 

 ' 用户表名：USERLIST
 ' 字段：ID，自动编号
 ' 字段：USERNAME，文本，用户名
 ' 字段：USERKEY，文本，用户密码
赋值 (YY, 0)

赋值 (SQL, 相加 (“select * from USERLIST where USERNAME='”, .内容, “' and USERKEY='”, .内容, “'”))
赋值 (用户记录集, _启动窗口.查询 (., SQL))
_启动窗口.到首记录 (., 用户记录集)
.判断循环首 (取反 (_启动窗口.尾记录后 (., 用户记录集)))
    赋值 (_启动窗口..标记, 到文本 (_启动窗口.读 (., 用户记录集, “ID”)))
    _启动窗口.到后一记录 (., 用户记录集)
    赋值 (YY, 相加 (YY, 1))
.判断循环尾 ()
_启动窗口.关闭记录集 (., 用户记录集)
.如果真 (等于 (YY, 0))
    信息框 (相加 (“对不起，你输入的名或密码有误，”, #换行符, “请重新输入用户名与密码！　”), 48, “系统提示”)
    赋值 (.被选择字符数, -1)
    获取焦点 ()
    返回 ()
.如果真结束

销毁 ()



 ' 不属于任何一个程序集、类模块的函数：
