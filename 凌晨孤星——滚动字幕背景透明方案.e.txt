 ' 文件类型：Windows窗口程序

 ' 程序名称：滚动字幕背景透明方案
 ' 程序描述：
 ' 程序作者：凌晨孤星
 ' 邮政编码：528251
 ' 联系地址：广东省佛山市南海区
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：lzj85@163.com
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 267
    高度 = 181
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “凌晨孤星―滚动字幕背景透明方案”
    帮助文件名 = “”



.常量 str, "“将进酒 

君不见黄河之水天上来。 
奔流到海不复回。 
君不见高堂明镜悲白发。 
朝如青丝暮成雪。 
人生得意须尽欢。 
莫使金樽空对月。 
天生我材必有用。 
千金散尽还复来。 
烹羊宰牛且为乐。 
会须一饮三百杯。 
岑夫子。 
丹丘生。 
将进酒 
杯莫停。 
与君歌一曲。 
请君为我侧耳听。 
钟鼓馔玉不足贵。  
但愿长醉不复醒。  
古来圣贤皆寂寞。 
惟有饮者留其名。 
陈王昔时宴平乐。 
斗酒十千恣欢谑。 
主人何为言少钱。 
径须沽取对君酌。 
五花马。 
千金裘。 
呼儿将出换美酒。 
与尔同销万古愁。 ”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库




数据类型 RECT, , 
    .成员 x1, 整数型, , , 
    .成员 y1, 整数型, , , 
    .成员 x2, 整数型, , , 
    .成员 y2, 整数型, , , 


.DLL命令 GetWindowLongA, 整数型, "user32.dll", "GetWindowLongA", , 
    .参数 hwnd, 空白型, , 
    .参数 nIndex, 空白型, , 

.DLL命令 SetWindowLongA, 整数型, "user32.dll", "SetWindowLongA", , 
    .参数 hwnd, 空白型, , 
    .参数 nIndex, 空白型, , 
    .参数 dwNewLong, 空白型, , 

.DLL命令 SetLayeredWindowAttributes, 整数型, "user32.dll", "SetLayeredWindowAttributes", , 
    .参数 hwnd, 空白型, , 
    .参数 crKey, 空白型, , 
    .参数 bAlpha, 空白型, , 
    .参数 dwFlags, 空白型, , 

.程序集 程序集1, , , 

.程序集变量 画板, 画板, , , 
.程序集变量 画板_临时1, 画板, , , 
.程序集变量 画板_临时2, 画板, , , 
.程序集变量 透明色, 整数型, , , 
.程序集变量 文本颜色, 整数型, , , 
.程序集变量 文本输出矩形区域, RECT, , , 
.程序集变量 上渐变_高度, 整数型, , , 
.程序集变量 上渐变_颜色, 整数型, , , 
.程序集变量 下渐变_高度, 整数型, , , 
.程序集变量 下渐变_颜色, 整数型, , , 
.子程序 初始化, 空白型, 公开, 
.参数 画板1, 画板, 参考, 
.参数 画板2, 画板, 参考, 
.参数 画板3, 画板, 参考, 

赋值 (画板1., 真)
赋值 (画板1., 真)
赋值 (画板2., 真)
赋值 (画板2., 假)
赋值 (画板3., 真)
赋值 (画板3., 假)
连续赋值 (画板1., 画板2., 画板3.)
连续赋值 (画板1., 画板2., 画板3.)

赋值 (画板, 画板1)
赋值 (画板_临时1, 画板2)
赋值 (画板_临时2, 画板3)


.子程序 置透明颜色, 空白型, 公开, 
.参数 颜色值, 整数型, , 

赋值 (透明色, 颜色值)

.子程序 置文本颜色, 空白型, 公开, 
.参数 颜色值, 整数型, , 

赋值 (文本颜色, 颜色值)

.子程序 置文字输出矩形区域, 空白型, 公开, 
.参数 x1, 整数型, , 
.参数 y1, 整数型, , 
.参数 x2, 整数型, , 
.参数 y2, 整数型, , 

赋值 (文本输出矩形区域.x1, x1)
赋值 (文本输出矩形区域.y1, y1)
赋值 (文本输出矩形区域.x2, x2)
赋值 (文本输出矩形区域.y2, y2)

.子程序 置上渐变, 空白型, 公开, 
.参数 高度, 整数型, , 
.参数 颜色, 整数型, , 

赋值 (上渐变_高度, 高度)
赋值 (上渐变_颜色, 颜色)


.子程序 置下渐变, 空白型, 公开, 
.参数 高度, 整数型, , 
.参数 颜色, 整数型, , 

赋值 (下渐变_高度, 高度)
赋值 (下渐变_颜色, 颜色)


.子程序 输出文本, 空白型, 公开, 
.参数 x, 整数型, , 
.参数 y, 整数型, , 
.参数 文本, 文本型, , 

 ' 填充一个黑色矩形，然后写上白色文字
赋值 (画板_临时1., #黑色)
画板_临时1.填充矩形 (0, 0, 画板_临时1., 画板_临时1.)
赋值 (画板_临时1., #白色)
画板_临时1.定位写出 (x, y, 文本)
 ' 填充一个黑色矩形，然后画上渐变矩形和下渐变矩形
赋值 (画板_临时2., #黑色)
画板_临时2.填充矩形 (0, 0, 画板_临时2., 画板_临时2.)
赋值 (画板_临时2., 文本颜色)
画板_临时2.填充矩形 (文本输出矩形区域.x1, 文本输出矩形区域.y1, 文本输出矩形区域.x2, 文本输出矩形区域.y2)
画板_临时2.画渐变矩形 (文本输出矩形区域.x1, 文本输出矩形区域.y1, 相减 (文本输出矩形区域.x2, 文本输出矩形区域.x1), 上渐变_高度, #从上到下, 上渐变_颜色, 文本颜色)
画板_临时2.画渐变矩形 (文本输出矩形区域.x1, 相减 (文本输出矩形区域.y2, 下渐变_高度), 相减 (文本输出矩形区域.x2, 文本输出矩形区域.x1), 下渐变_高度, #从下到上, 下渐变_颜色, 文本颜色)

画板_临时1.复制 (文本输出矩形区域.x1, 文本输出矩形区域.y1, 文本输出矩形区域.x2, 文本输出矩形区域.y2, 画板_临时2, 文本输出矩形区域.x1, 文本输出矩形区域.y1, #位与) ' 得到渐变颜色的文字和黑色的背景

 ' 填充一个透明色矩形，然后写上黑色文字
赋值 (画板_临时1., 透明色)
画板_临时1.填充矩形 (0, 0, 画板_临时1., 画板_临时1.)
赋值 (画板_临时1., #黑色)
画板_临时1.定位写出 (x, y, 文本)
画板_临时1.填充矩形 (0, 0, 画板_临时1., 文本输出矩形区域.y1)
画板_临时1.填充矩形 (0, 0, 文本输出矩形区域.x1, 画板_临时1.)
画板_临时1.填充矩形 (文本输出矩形区域.x2, 0, 画板_临时1., 画板_临时1.)
画板_临时1.填充矩形 (0, 文本输出矩形区域.y2, 画板_临时1., 画板_临时1.)
画板_临时2.复制 (0, 0, 画板_临时2., 画板_临时2., 画板_临时1, 0, 0, #位或) ' 得到渐变颜色的文字和透明色的背景

画板_临时1.复制 (0, 0, 画板_临时1., 画板_临时1., 画板, 0, 0, #拷贝)


.窗口程序集 窗口程序集1, , , 

.程序集变量 n, 整数型, , , 
.子程序 _按钮1_被单击, 空白型, , 


.子程序 __启动窗口_创建完毕, 空白型, , 
SetWindowLongA (取窗口句柄 (), -20, 位或 (GetWindowLongA (取窗口句柄 (), -20), 524288))
SetLayeredWindowAttributes (取窗口句柄 (), #黑色, 0, 1)

初始化 ()
置透明颜色 (#黑色)
置文本颜色 (#红色)
置上渐变 (15, 相加 (#黑色, 1))
置下渐变 (15, 相加 (#黑色, 1))
置文字输出矩形区域 (0, 0, ., .) ' 这里设置文字的显示区域

赋值 (n, 150)

.子程序 _时钟1_周期事件, 空白型, , 
.判断开始 (并且 (大于或等于 (n, -420), 小于或等于 (n, 150)))
    赋值 (n, 相减 (n, 1))
.默认
    赋值 (n, 150)
.判断结束
输出文本 (0, n, #str)


 ' 不属于任何一个程序集、类模块的函数：
