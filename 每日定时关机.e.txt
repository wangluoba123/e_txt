 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.wodesoft.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.wodesoft.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.wodesoft.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 198
    高度 = 162
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\每日定时关机.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “每日定时关机”
    帮助文件名 = “”

窗口 提醒窗口
    左边 = 50
    顶边 = 50
    宽度 = 190
    高度 = 127
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 已保存到：D:\易语言学习\Data\每日定时关机.e\提醒窗口_背景音乐
    标题 = “关机提醒”
    帮助文件名 = “”



.图片 _Skin_ShanMeng窄版, " ' 已保存到：D:\易语言学习\Data\每日定时关机.e\_Skin_ShanMeng窄版", 隐藏, 
.图片 _Skin_Areo, " ' 已保存到：D:\易语言学习\Data\每日定时关机.e\_Skin_Areo", 隐藏, 
.图片 _Skin_QQ_2009, " ' 已保存到：D:\易语言学习\Data\每日定时关机.e\_Skin_QQ_2009", 隐藏, 
.图片 _Skin_QQ_2008, " ' 已保存到：D:\易语言学习\Data\每日定时关机.e\_Skin_QQ_2008", 隐藏, 
.图片 _Skin_QQ_Game, " ' 已保存到：D:\易语言学习\Data\每日定时关机.e\_Skin_QQ_Game", 隐藏, 
.图片 _Skin_Black, " ' 已保存到：D:\易语言学习\Data\每日定时关机.e\_Skin_Black", 隐藏, 
.图片 _Skin_中国风, " ' 已保存到：D:\易语言学习\Data\每日定时关机.e\_Skin_中国风", 隐藏, 
.图片 _Skin_Office_2007, " ' 已保存到：D:\易语言学习\Data\每日定时关机.e\_Skin_Office_2007", 隐藏, 
.图片 _Skin_WhiteFire, " ' 已保存到：D:\易语言学习\Data\每日定时关机.e\_Skin_WhiteFire", 隐藏, 
.图片 _Skin_纯净皮肤, " ' 已保存到：D:\易语言学习\Data\每日定时关机.e\_Skin_纯净皮肤", 隐藏, 
.图片 _Skin_MSN, " ' 已保存到：D:\易语言学习\Data\每日定时关机.e\_Skin_MSN", 隐藏, 
.图片 _Skin_炫绿, " ' 已保存到：D:\易语言学习\Data\每日定时关机.e\_Skin_炫绿", 隐藏, 
.图片 _Skin_积木, " ' 已保存到：D:\易语言学习\Data\每日定时关机.e\_Skin_积木", 隐藏, 
.图片 _Skin_QQ影音, " ' 已保存到：D:\易语言学习\Data\每日定时关机.e\_Skin_QQ影音", 隐藏, 
.图片 _Skin_Itunes, " ' 已保存到：D:\易语言学习\Data\每日定时关机.e\_Skin_Itunes", 隐藏, 
.图片 _Skin_悬浮镂空, " ' 已保存到：D:\易语言学习\Data\每日定时关机.e\_Skin_悬浮镂空", 隐藏, 
.图片 _Skin_Adamant, " ' 已保存到：D:\易语言学习\Data\每日定时关机.e\_Skin_Adamant", 隐藏, 
.图片 _Skin_Longhorn, " ' 已保存到：D:\易语言学习\Data\每日定时关机.e\_Skin_Longhorn", 隐藏, 
.图片 _Skin_Storm, " ' 已保存到：D:\易语言学习\Data\每日定时关机.e\_Skin_Storm", 隐藏, 
.图片 _Skin_Asus, " ' 已保存到：D:\易语言学习\Data\每日定时关机.e\_Skin_Asus", 隐藏, 
.常量 关机, "1", 隐藏, 
.常量 重启, "2", 隐藏, 
.常量 注销, "3", 隐藏, 
.常量 休眠, "4", 隐藏, 
.常量 睡眠, "5", 隐藏, 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库



 ' 所需要的模块
 ' 内存皮肤 R:\模块_内存皮肤.ec
 ' 新关闭系统模块 R:\新关闭系统模块.ec



.窗口程序集 窗口程序集1, , , 

.程序集变量 pop, 整数型, , , 
.程序集变量 日, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
 ' --========  易语言资源网  (www.wodesoft.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.wodesoft.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.wodesoft.com  ================--

赋值 (., 到文本 (取现行时间 ()))
赋值 (pop, 0)
赋值 (日, 取时间部分 (取现行时间 (), #日))

.如果真 (注册项是否存在 (#本地机器, “SOFTWARE\Microsoft\Windows\CurrentVersion\Run\每日定时关机”))
    赋值 (., 真)
    赋值 (., 真)
.如果真结束

_启动窗口.置托盘图标 (_启动窗口., “每日定时关机”)

_资源皮肤 (#_Skin_QQ_2009)
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _时钟1_周期事件, 空白型, , 
.局部变量 时, 整数型, , , 
.局部变量 分, 整数型, , , 
.局部变量 秒, 整数型, , , 

赋值 (., 到文本 (取现行时间 ()))

赋值 (时, 取时间部分 (取现行时间 (), #小时))
赋值 (分, 取时间部分 (取现行时间 (), #分钟))
赋值 (秒, 取时间部分 (取现行时间 (), #秒))
 ' 调试输出 (时, 分)

.如果真 (并且 (等于 (时, 23), 等于 (分, 55), 大于或等于 (秒, 30), 等于 (pop, 0)))
    赋值 (pop, 1)
    载入 (提醒窗口, _启动窗口, 真)
.如果真结束

.如果真 (并且 (等于 (pop, 1), 不等于 (日, 取时间部分 (取现行时间 (), #日))))
    赋值 (pop, 0)
.如果真结束


.子程序 _选择框_开机自动运行_被单击, 空白型, , 
.如果 (.)
    赋值 (., 真)
    写注册项 (#本地机器, “SOFTWARE\Microsoft\Windows\CurrentVersion\Run\每日定时关机”, 相加 (取当前目录 (), “\”, 取执行文件名 ()))
.否则
    赋值 (., 假)
    删除注册项 (#本地机器, “SOFTWARE\Microsoft\Windows\CurrentVersion\Run\每日定时关机”)
.如果结束


.子程序 __启动窗口_托盘事件, 空白型, , 
.参数 操作类型, 整数型, , 

 ' .如果真 (等于 (操作类型, #单击左键))
     ' .如果 (等于 (_启动窗口., 真))
         ' _启动窗口.可视 ＝ 假
    .否则
         ' _启动窗口.可视 ＝ 真
    .如果结束
    
     ' _启动窗口.总在最前 ＝ 真
     ' _启动窗口.总在最前 ＝ 假
.如果真结束

.如果真 (等于 (操作类型, #单击右键))
    弹出托盘菜单 ()
.如果真结束

' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
赋值 (_启动窗口., 假)
返回 (假)


.子程序 _退出_被选择, 空白型, , 
_启动窗口.置托盘图标 ({  }, “”)
结束 ()


.子程序 _开机自动运行_被选择, 空白型, , 
.如果 (.)
    赋值 (., 假)
    赋值 (., 假)
    删除注册项 (#本地机器, “SOFTWARE\Microsoft\Windows\CurrentVersion\Run\每日定时关机”)
.否则
    赋值 (., 真)
    赋值 (., 真)
    写注册项 (#本地机器, “SOFTWARE\Microsoft\Windows\CurrentVersion\Run\每日定时关机”, 相加 (取当前目录 (), “\”, 取执行文件名 ()))
.如果结束
' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _显示隐藏窗口_被选择, 空白型, , 
.如果 (等于 (_启动窗口., 真))
    赋值 (_启动窗口., 假)
.否则
    赋值 (_启动窗口., 真)
.如果结束
赋值 (_启动窗口., 真)
赋值 (_启动窗口., 假)


.窗口程序集 窗口程序集2, , , 

.程序集变量 秒数, 整数型, , , 
.子程序 _提醒窗口_创建完毕, 空白型, , 
赋值 (提醒窗口., 真)
赋值 (秒数, 30)


.子程序 _按钮_取消_被单击, 空白型, , 
销毁 (真)


.子程序 _时钟1_周期事件, 空白型, , 
.如果 (大于 (秒数, 0))
    赋值 (秒数, 相减 (秒数, 1))
    赋值 (., 到文本 (秒数))
.否则
    赋值 (., 0)
    新关闭系统 (#关机, 真)
    销毁 ()
.如果结束


.子程序 _按钮_关机_被单击, 空白型, , 
赋值 (., 0)
新关闭系统 (1, 真)
销毁 ()


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 _资源皮肤, 空白型, , 字节集皮肤
.参数 皮肤, 字节集, , 
.参数 皮肤密码, 文本型, 可空, 
.参数 色调, 整数型, 可空, 取值范围 1-360
.参数 饱和度, 整数型, 可空, 取值范围 1-256
.参数 亮度, 整数型, 可空, 取值范围 1-256



.子程序 _阴影特效, 空白型, , 
.参数 有效性, 逻辑型, 可空, 



.子程序 _标题栏菜单, 空白型, , 
.参数 窗口句柄, 整数型, , 
.参数 有效性, 逻辑型, 可空, 



.子程序 _锁定皮肤, 空白型, , 有助表格或列表效率问题
.参数 句柄, 整数型, , 控件句柄
.参数 锁定, 逻辑型, 可空, 



.子程序 _调整皮肤颜色, 空白型, , 
.参数 色调, 整数型, , 取值范围-180-180,默认值0
.参数 饱和度, 整数型, , 取值范围-100-100,默认值0
.参数 亮度, 整数型, , 取值范围-100-100,默认值0



.子程序 _释放, 空白型, , 结束前执行,释放内存


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 新关闭系统, 逻辑型, , 本命令可以执行关机、重启、注销、休眠、睡眠等Windows系统操作。成功返回真，失败返回假。本命令为初级命令。
.参数 关闭方式, 整数型, , 本参数可以为以下常量值之一： 1: #关机(Shutdown); 2: #重启(Reboot); 3: #注销(Logoff); 4: #休眠(Hibernate); 5: #睡眠(Sleep)。
.参数 是否强制执行, 逻辑型, 可空, 本参数指定是否不等待当前正在运行的所有软件正常结束而立即执行指定的操作。如果本参数被省略，默认值为假。




 ' 不属于任何一个程序集、类模块的函数：
