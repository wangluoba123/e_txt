 ' 文件类型：Windows模块源码

 ' 程序名称：状态条广播
 ' 程序描述：
 ' 程序作者：xj22710
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：51235174@qq.com
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一





.程序集 程序集1, , , 

.程序集变量 背景画板, 画板, , , 
.程序集变量 移动速度, 整数型, , , 
.程序集变量 字幕状态条, 状态条, , , 
.程序集变量 状态条字幕项目, 整数型, , , 
.程序集变量 控制时钟, 时钟, , , 
.程序集变量 文本标签, 标签, , , 
.程序集变量 文本, 文本型, , "0", 
.程序集变量 次数, 整数型, , , 
.子程序 _启动子程序, 整数型, , 
返回 (0)

.子程序 _临时子程序, 空白型, , 


.子程序 公告初始化, 空白型, , 在程序开始执行后，首次开始公告前，必须先执行此命令，同时请提供4个组件(画板、标签、状态条、时钟)
.参数 公告文本, 文本型, 数组, 公告文本，请提供文本型数组变量
.参数 画板, 画板, , 画板组件
.参数 标签, 标签, , 标签组件
.参数 状态条, 状态条, , 用于显示公告的状态条
.参数 时钟, 时钟, , 用于控制公告滚动速度的时钟
.参数 状态条项目, 整数型, 可空, 用于显示公告的状态条项目，0=项目1，1=项目2，以次类推 如果该参数省略，默认为0 (注意：用以显示公告的状态条，至少要包含有一个项目)
.参数 速度, 整数型, 可空, 单位毫秒，默认为20毫秒

赋值 (背景画板, 画板)
赋值 (文本, 公告文本)
赋值 (文本标签, 标签)
赋值 (字幕状态条, 状态条)
赋值 (控制时钟, 时钟)
赋值 (状态条字幕项目, 状态条项目)
赋值 (移动速度, 速度)

赋值 (背景画板.高度, 19)
赋值 (背景画板.宽度, 相减 (字幕状态条.取栏目宽度 (状态条字幕项目), 2))
赋值 (背景画板.顶边, 相加 (字幕状态条., 2))
赋值 (背景画板.左边, 字幕状态条.取栏目左边 (状态条字幕项目))

赋值 (文本标签.高度, 14)
文本标签.置父窗口 (背景画板)
赋值 (文本标签.顶边, 3)
连续赋值 (0, 背景画板.边框, 文本标签.边框)

.如果真 (小于或等于 (移动速度, 0))
    赋值 (移动速度, 20)
.如果真结束
赋值 (次数, 1)
赋值 (文本标签.标题, 公告文本 [1])
赋值 (文本标签.左边, 背景画板.宽度)
赋值 (文本标签.宽度, 相乘 (取文本长度 (文本 [1]), 6))
背景画板.调整层次 ()

.子程序 开始公告, 逻辑型, , 状态条开始循环滚动显示公告内容，成功返回真，否则返回假
.如果 (大于 (移动速度, 0))
    .如果真 (等于 (文本标签.可视, 假))
        赋值 (文本标签.可视, 真)
    .如果真结束
    .如果真 (等于 (背景画板.可视, 假))
        赋值 (背景画板.可视, 真)
    .如果真结束
    赋值 (控制时钟.时钟周期, 移动速度)
    返回 (真)
.否则
    返回 (假)
.如果结束


.子程序 公告过程, 空白型, , 请将此命令置于“开始公告”命令中提供的“时钟”的周期事件中运行
.如果真 (等于 (相加 (文本标签.左边, 文本标签.宽度), 0))
    .如果真 (大于 (取数组成员数 (文本), 1))
        .如果 (小于 (次数, 取数组成员数 (文本)))
            赋值 (次数, 相加 (次数, 1))
            赋值 (文本标签.标题, 文本 [次数])
        .否则
            赋值 (次数, 1)
            赋值 (文本标签.标题, 文本 [1])
        .如果结束
        赋值 (文本标签.宽度, 相乘 (取文本长度 (文本 [次数]), 6))
    .如果真结束
    赋值 (文本标签.左边, 背景画板.宽度)
.如果真结束
赋值 (文本标签.左边, 相减 (文本标签.左边, 1))

.子程序 停止公告, 逻辑型, , 状态条停止循环滚动显示，成功返回真，否则返回假
.参数 显示公告, 逻辑型, 可空, 本参数决定在停止滚动显示公告后，是否在状态条上静态显示公告内容，如果真显示公告文本第一条，否则不显示  如果省略本参数，默认为假

.如果 (大于 (移动速度, 0))
    .如果 (大于 (控制时钟.时钟周期, 0))
        赋值 (控制时钟.时钟周期, 0)
        .如果 (等于 (显示公告, 假))
            背景画板.调整层次 (#底层)
        .否则
            赋值 (文本标签.标题, 文本 [1])
            赋值 (文本标签.左边, 0)
            赋值 (文本标签.宽度, 相乘 (取文本长度 (文本 [1]), 6))
        .如果结束
        赋值 (次数, 1)
        返回 (真)
    .否则
        返回 (假)
    .如果结束
    
.否则
    返回 (假)
.如果结束


.子程序 置公告文本色, 逻辑型, , 设置公告的文本颜色，成功返回真，否则返回假
.参数 颜色值, 整数型, 可空, 指定公告文字的颜色，请提供颜色常量或数值   如果该参数冷略，默认为#黑色

.如果 (不等于 (取数组成员数 (文本), 0))
    .如果 (等于 (颜色值, 0))
        赋值 (文本标签.文本颜色, #黑色)
    .否则
        赋值 (文本标签.文本颜色, 颜色值)
    .如果结束
    返回 (真)
.否则
    返回 (假)
.如果结束




 ' 不属于任何一个程序集、类模块的函数：
