 ' 文件类型：Windows窗口程序

 ' 程序名称：服务端查询程序
 ' 程序描述：服务端查询程序
 ' 程序作者：新丰工作室  赵承华
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 642
    高度 = 457
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “查询与数据库操作”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 6 系统核心支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 2 扩展界面支持库二
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 1 6 高级表格支持库




.全局变量 查询单日时间, 文本型, , , 
.全局变量 查询开始时间, 文本型, , , 
.全局变量 查询结束时间, 文本型, , , 
.全局变量 库记录数组, 整数型, , "0", 

.窗口程序集 窗口程序集1, , , 

.程序集变量 查询单日, 日期时间型, , , 
.程序集变量 查询开始, 日期时间型, , , 
.程序集变量 查询结束, 日期时间型, , , 
.程序集变量 今天日期, 文本型, , , 
.程序集变量 发送姓名, 文本型, , , 
.程序集变量 姓名数组, 文本型, , "0", 
.程序集变量 口令数组, 文本型, , "0", 
.程序集变量 数据时间, 日期时间型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 a11, 整数型, , , 


赋值 (.选中, 真)
打开 (相加 (取运行目录 (), “\bcsj.edb”), , , , , , )
置当前库 (“接收数据”)
到首记录 ()
赋值 (., 1)
赋值 (., 3)
2.未知支持库函数_32 (320)
0.未知支持库函数_9 (0, 1, “日期”)
0.未知支持库函数_9 (1, 1, “姓名”)
0.未知支持库函数_9 (2, 1, “报餐”)

赋值 (今天日期, “”)

赋值 (今天日期, 到文本 (取日期 (.今天)))
清除数组 (库记录数组)
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (等于 (读 (“rq”), 今天日期))
        .未知支持库函数_38 ()
        相减 (., 1).未知支持库函数_9 (0, 1, 今天日期)
        相减 (., 1).未知支持库函数_9 (1, 1, 读 (“xm”))
        相减 (., 1).未知支持库函数_9 (2, 1, 读 (“bc”))
        取记录号 ()
        加入成员 (库记录数组, 取记录号 ())
        
    .如果真结束
    
    跳过 ()
.判断循环尾 ()
赋值 (.标题, 相加 (“数据显示----共有”, 到文本 (相减 (., 1)), “条数据”))
关闭 ()


打开 (相加 (取运行目录 (), “\yg.edb”), “yg”, , , , , )
到首记录 ()
赋值 (发送姓名, “”)

.判断循环首 (等于 (尾记录后 (), 假))
    赋值 (发送姓名, 相加 (发送姓名, 读 (“yg”), “|”))
    加入成员 (姓名数组, 读 (“yg”))
    加入成员 (口令数组, 读 (“kl”))
    跳过 ()
.判断循环尾 ()
关闭 ()
.计次循环首 (取数组成员数 (姓名数组), a11)
    
    姓名数组.加入项目 ( [a11], )
    
.计次循环尾 ()


赋值 (.标题, 相加 (“提示：现有用户”, 到文本 (取项目数 ()), “人”))
.如果真 (大于 (取项目数 (), 0))
    赋值 (.现行选中项, 0)
    赋值 (.内容, 口令数组 [相加 (.现行选中项, 1)])
.如果真结束





.子程序 _日期框1_选择日期被改变, 空白型, , 
赋值 (查询单日时间, 到文本 (取日期 (.今天)))
赋值 (查询单日, 取日期 (.今天))


.子程序 _日期框2_选择日期被改变, 空白型, , 
赋值 (查询开始时间, 到文本 (取日期 (.今天)))
赋值 (查询开始, 取日期 (.今天))


.子程序 _日期框3_选择日期被改变, 空白型, , 
赋值 (查询结束时间, 到文本 (取日期 (.今天)))
赋值 (查询结束, 取日期 (.今天))


.子程序 _按钮3_被单击, 空白型, , 
.如果 (或者 (等于 (.内容, “”), 等于 (.现行选中项, -1)))
    信息框 (“您还没有选择要修改的用户名或新设置的口令不能为空！”, 0, )
    获取焦点 ()
    返回 ()
    
.否则
    打开 (相加 (取运行目录 (), “\yg.edb”), “yg”, , , , , )
    到首记录 ()
    
    
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果真 (等于 (读 (“yg”), .取项目文本 (.现行选中项)))
            写 (“kl”, .内容)
            跳出循环 ()
            
        .如果真结束
        
        
        跳过 ()
    .判断循环尾 ()
    关闭 ()
    赋值 (口令数组 [相加 (.现行选中项, 1)], .内容)
    赋值 (.内容, .内容)
    信息框 (相加 (.取项目文本 (.现行选中项), “的新口令已经设置成功！新口令为：”, .内容, “，请通知该用户使用新的口令报餐！”), 0, )
    赋值 (.内容, “”)
    
.如果结束


.子程序 _按钮6_被单击, 空白型, , 
.局部变量 a11, 整数型, , , 

.如果 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“用户姓名或口令不能为空！”, 0, )
    返回 ()
    
    获取焦点 ()
.否则
    打开 (相加 (取运行目录 (), “\yg.edb”), “yg”, , , , , )
    到首记录 ()
    赋值 (a11, 0)
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果真 (等于 (读 (“yg”), .内容))
            赋值 (a11, 2)
            
        .如果真结束
        跳过 ()
    .判断循环尾 ()
    .如果真 (等于 (a11, 2))
        信息框 (“数据库中已经存在您要添加的姓名，请重新选择操作！”, 0, )
        返回 ()
        
    .如果真结束
    
    加记录 (.内容, .内容)
    
    关闭 ()
    
    .加入项目 (.内容, )
    加入成员 (姓名数组, .内容)
    加入成员 (口令数组, .内容)
    信息框 (“已经成功添加了该用户在数据库中！”, 0, )
    
    
    
.如果结束


赋值 (.标题, 相加 (“提示：现有用户”, 到文本 (取项目数 ()), “人”))


.子程序 _按钮7_被单击, 空白型, , 
.局部变量 a11, 整数型, , , 

.如果 (等于 (.内容, “”))
    信息框 (“用户姓名不能为空！”, 0, )
    获取焦点 ()
.否则
    赋值 (a11, 0)
    打开 (相加 (取运行目录 (), “\yg.edb”), “yg”, , , , , )
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果真 (等于 (读 (“yg”), .内容))
            删除 ()
            赋值 (a11, 2)
            
        .如果真结束
        跳过 ()
    .判断循环尾 ()
    .如果真 (等于 (a11, 0))
        信息框 (“数据库中没有您填写的员工姓名”, 0, )
        返回 ()
        
    .如果真结束
    
    .如果真 (等于 (a11, 2))
        彻底删除 ()
        信息框 (“该记录已经在数据库中完全删除！”, 0, )
    .如果真结束
    
    到首记录 ()
    清除数组 (姓名数组)
    清除数组 (口令数组)
    .判断循环首 (等于 (尾记录后 (), 假))
        加入成员 (姓名数组, 读 (“yg”))
        加入成员 (口令数组, 读 (“kl”))
        跳过 ()
    .判断循环尾 ()
    
    清空 ()
    
    .计次循环首 (取数组成员数 (姓名数组), a11)
        
        姓名数组.加入项目 ( [a11], )
        
    .计次循环尾 ()
    关闭 ()
    
    
.如果结束

赋值 (.标题, 相加 (“提示：现有用户”, 到文本 (取项目数 ()), “人”))


.子程序 _按钮1_被单击, 空白型, , 
打开 (相加 (取运行目录 (), “\bcsj.edb”), , , , , , )

清除数组 (库记录数组)

.如果真 (等于 (.选中, 真))
    到首记录 ()
    赋值 (查询单日时间, 到文本 (取日期 (.今天)))
    赋值 (., 1)
    赋值 (., 3)
    2.未知支持库函数_32 (320)
    0.未知支持库函数_9 (0, 1, “日期”)
    0.未知支持库函数_9 (1, 1, “姓名”)
    0.未知支持库函数_9 (2, 1, “报餐”)
    
    
    .判断循环首 (等于 (尾记录后 (), 假))
        
        .如果 (等于 (.选中, 真))
            .如果真 (并且 (等于 (读 (“rq”), 查询单日时间), 等于 (读 (“xm”), .内容)))
                .未知支持库函数_38 ()
                相减 (., 1).未知支持库函数_9 (0, 1, 读 (“rq”))
                相减 (., 1).未知支持库函数_9 (1, 1, 读 (“xm”))
                相减 (., 1).未知支持库函数_9 (2, 1, 读 (“bc”))
                取记录号 ()
                加入成员 (库记录数组, 取记录号 ())
                
                
                
            .如果真结束
            
        .否则
            .如果真 (等于 (读 (“rq”), 查询单日时间))
                .未知支持库函数_38 ()
                相减 (., 1).未知支持库函数_9 (0, 1, 读 (“rq”))
                相减 (., 1).未知支持库函数_9 (1, 1, 读 (“xm”))
                相减 (., 1).未知支持库函数_9 (2, 1, 读 (“bc”))
                取记录号 ()
                加入成员 (库记录数组, 取记录号 ())
                
            .如果真结束
            
        .如果结束
        
        
        跳过 ()
    .判断循环尾 ()
    
.如果真结束

.如果真 (等于 (.选中, 真))
    到首记录 ()
    赋值 (查询开始时间, 到文本 (取日期 (.今天)))
    赋值 (查询开始, 取日期 (.今天))
    赋值 (查询结束时间, 到文本 (取日期 (.今天)))
    赋值 (查询结束, 取日期 (.今天))
    
    
    
    
    赋值 (., 1)
    赋值 (., 3)
    2.未知支持库函数_32 (320)
    0.未知支持库函数_9 (0, 1, “日期”)
    0.未知支持库函数_9 (1, 1, “姓名”)
    0.未知支持库函数_9 (2, 1, “报餐”)
    
    
    .判断循环首 (等于 (尾记录后 (), 假))
        
        .如果 (等于 (.选中, 真))
            赋值 (数据时间, 到时间 (读 (“rq”)))
            
            .如果真 (并且 (大于或等于 (取时间间隔 (查询结束, 数据时间, #日), 0), 小于或等于 (取时间间隔 (查询开始, 数据时间, #日), 0), 等于 (读 (“xm”), .内容)))
                .未知支持库函数_38 ()
                相减 (., 1).未知支持库函数_9 (0, 1, 读 (“rq”))
                相减 (., 1).未知支持库函数_9 (1, 1, 读 (“xm”))
                相减 (., 1).未知支持库函数_9 (2, 1, 读 (“bc”))
                取记录号 ()
                加入成员 (库记录数组, 取记录号 ())
                
            .如果真结束
            
        .否则
            赋值 (数据时间, 到时间 (读 (“rq”)))
            .如果真 (并且 (大于或等于 (取时间间隔 (查询结束, 数据时间, #日), 0), 小于或等于 (取时间间隔 (查询开始, 数据时间, #日), 0)))
                .未知支持库函数_38 ()
                相减 (., 1).未知支持库函数_9 (0, 1, 读 (“rq”))
                相减 (., 1).未知支持库函数_9 (1, 1, 读 (“xm”))
                相减 (., 1).未知支持库函数_9 (2, 1, 读 (“bc”))
                取记录号 ()
                加入成员 (库记录数组, 取记录号 ())
                
            .如果真结束
            
        .如果结束
        
        
        跳过 ()
    .判断循环尾 ()
.如果真结束


关闭 ()
赋值 (.标题, 相加 (“数据显示----共有”, 到文本 (相减 (., 1)), “条数据”))

.子程序 _按钮8_被单击, 空白型, , 
未知支持库函数_27 ()


.子程序 _按钮9_被单击, 空白型, , 
未知支持库函数_26 ()


.子程序 _按钮2_被单击, 空白型, , 
.如果真 (等于 (打开 (), 真))
    .未知支持库函数_55 (.文件名)
    信息框 (“保存表格文件成功！”, 0, )
    
.如果真结束


.子程序 _按钮5_被单击, 空白型, , 
.如果 (等于 (复制文件 (相加 (取运行目录 (), “\yg.edb”), 相加 (取运行目录 (), “\bak\yg.edb”)), 真))
    信息框 (“备份数据库文件yg.edb成功！备份的数据库在bak目录下！”, 0, )
.否则
    信息框 (“备份数据库yg.edb失败！请检查！”, 0, )
.如果结束

.如果 (等于 (复制文件 (相加 (取运行目录 (), “\bcsj.edb”), 相加 (取运行目录 (), “\bak\bcsj.edb”)), 真))
    信息框 (“备份数据库文件bcsj.edb成功！备份的数据库在bak目录下！”, 0, )
.否则
    信息框 (“备份数据库bcsj.edb失败！请检查！”, 0, )
.如果结束



.子程序 _按钮10_被单击, 空白型, , 
.如果 (等于 (打开 (), 真))
    .未知支持库函数_56 (.文件名)
.否则
    
.如果结束


.子程序 __启动窗口_将被销毁, 空白型, , 
关闭 ()


.子程序 _组合框1_列表项被选择, 空白型, , 
.如果真 (不等于 (.现行选中项, -1))
    赋值 (.内容, 口令数组 [相加 (.现行选中项, 1)])
.如果真结束


.子程序 _按钮4_被单击, 空白型, , 
.局部变量 as1, 整数型, , , 

打开 (相加 (取运行目录 (), “\bcsj.edb”), , , , , , )

到首记录 ()
赋值 (., 1)
赋值 (., 3)
2.未知支持库函数_32 (320)
0.未知支持库函数_9 (0, 1, “日期”)
0.未知支持库函数_9 (1, 1, “姓名”)
0.未知支持库函数_9 (2, 1, “报餐”)

清除数组 (库记录数组)
.判断循环首 (等于 (尾记录后 (), 假))
    .未知支持库函数_38 ()
    相减 (., 1).未知支持库函数_9 (0, 1, 读 (“rq”))
    相减 (., 1).未知支持库函数_9 (1, 1, 读 (“xm”))
    相减 (., 1).未知支持库函数_9 (2, 1, 读 (“bc”))
    取记录号 ()
    加入成员 (库记录数组, 取记录号 ())
    跳过 ()
.判断循环尾 ()
关闭 ()
赋值 (.标题, 相加 (“数据显示----共有”, 到文本 (相减 (., 1)), “条数据”))

.子程序 _高级表格1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _删除一条记录_被选择, 空白型, , 
.局部变量 as1, 整数型, , , 

打开 (相加 (取运行目录 (), “\bcsj.edb”), , , , , , )

赋值 (as1, 未知支持库函数_3 ())

.如果 (不等于 (as1, -1))
    跳到 (库记录数组 [as1])
    删除 ()
    信息框 (“删除成功！”, 0, )
.否则
    信息框 (“删除失败！”, 0, )
.如果结束


彻底删除 ()
as1.未知支持库函数_36 ()

关闭 ()



 ' 不属于任何一个程序集、类模块的函数：
