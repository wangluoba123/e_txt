 ' 文件类型：Windows模块源码

 ' 程序名称：枫式热键 FS1.3
 ' 程序描述：    这是一款不用支持库就能实现系统热键功能的易模块！
    她既不需要标签反馈事件，也不需要热键标识变量且不需要程序结束前释放热键！
    而且最重要的是她的热键是完全独立于当前程序的！~也就是说：普通的注册系统热键只能注册一个程序，而另一个程序如要注册相同的热键，则要等原来注册热键的程序释放掉此热键才能够注册成功！
    而此枫式热键就不会产生这种问题，因为她的结构是独立于系统型的热键的！     她简直就可以称之为是次世代的热键模块！~！~哈哈~~~~天才吧！！
 ' 程序作者：流川枫   QQ350773875
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.3
 ' 创建号：0.0



.常量 小键盘数字_FS, "96", 公开, 该常量是小键盘数字虚拟键码的起始值，只需在该常量上递加一个附值即可。比如小键盘上的5，转义为虚拟键码就是 #小键盘数字_FS+5；其他数字那就加其数字；要是0的话就可以省略了。
.常量 小键盘星号_FS, "106", 公开, 小键盘上的星号(*)键。
.常量 小键盘加号_FS, "107", 公开, 小键盘上的加号(+)键。
.常量 小键盘减号_FS, "109", 公开, 小键盘上的减号(-)键。
.常量 小键盘除号_FS, "111", 公开, 小键盘上的除号(/)键。
.常量 小键盘句号_FS, "110", 公开, 小键盘上的句号(.)键。
.常量 Shift左_FS, "160", 公开, 键盘左边的Shift键。
.常量 Shift右_FS, "161", 公开, 键盘右边的Shift键。
.常量 Ctrl左_FS, "162", 公开, 键盘左边的Cctrl键。
.常量 Ctrl右_FS, "163", 公开, 键盘右边的Cctrl键。
.常量 Alt左_FS, "164", 公开, 键盘左边的Alt键。
.常量 Alt右_FS, "165", 公开, 键盘右边的Alt键。
.常量 Win左_FS, "91", 公开, 键盘左边的Windows键。
.常量 Win右_FS, "92", 公开, 键盘右边的Windows键。
.常量 鼠标左键_FS, "1", 公开, 鼠标左键。（备注：该函数支持鼠标按钮，但是，它检查的不是物理按钮映射到的逻辑按钮的状态，而实际物理按钮的状态。例如，函数调用GetAsyncKeystate（VK_LBUTTON）总是返回物理的鼠标左按钮的状态，而不管该按钮映射为逻辑上的左按钮，可以调用GetsystemMetrics（SM_SWAPBUTON）来确定系统当前物理鼠标按钮与逻辑鼠标按钮的对应关系，当鼠标按钮被左右交换后，函数返回TRUE。）
.常量 鼠标右键_FS, "2", 公开, 鼠标右键。（备注：该函数支持鼠标按钮，但是，它检查的不是物理按钮映射到的逻辑按钮的状态，而实际物理按钮的状态。例如，函数调用GetAsyncKeystate（VK_LBUTTON）总是返回物理的鼠标左按钮的状态，而不管该按钮映射为逻辑上的左按钮，可以调用GetsystemMetrics（SM_SWAPBUTON）来确定系统当前物理鼠标按钮与逻辑鼠标按钮的对应关系，当鼠标按钮被左右交换后，函数返回TRUE。）
.常量 鼠标中键_FS, "4", 公开, 鼠标中键。
.图片 动态调用代码, " ' 已保存到：D:\易语言学习\Data\枫式热键模块 FS1.3.e\动态调用代码", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库




数据类型 热键数据, 公开, 枫式热键专用的数据类型。
    .成员 触发条键, 整数型, , "1", 热键的键值，如果是多个按键组成的热键则定义多个成员然后分别填写键值。（注意：其中的状态键不能用易常量里的 #某某键状态 ，而是要直接用其键就行！比如#Ctrl键而不是#Ctrl键状态。）
    .成员 函数指针, 子程序指针, , , 热程序的子程序指针。（注意：热程序有一个参数，此参数可以为文本型或者整型，如果为文本型系统调用热程序时会传递给函数一个唯一的哈希标符，而如果为整型则系统会传递给函数一个哈希标符的内存地址。）
    .成员 哈希标符, 文本型, , , 此数据为 热键的哈希标志符，可以为任意文本。如果注册一个同名的哈希标符热键再绑定其热键的话，系统则会自动覆盖原来同名的热键集。并且在调用热程序时，系统会把唯一的哈希标符传递给函数！

.全局变量 热键队列, 热键数据, , "0", 枫式热键对象集。

.DLL命令 取文本指针_API, 整数型, "", "lstrcpyn", , 
    .参数 欲取其指针的变量, 文本型, 传址, 
    .参数 欲取其指针的变量, 文本型, 传址, 
    .参数 保留, 整数型, , 0

.DLL命令 创建时钟_API, 整数型, "", "SetTimer", , 
    .参数 窗口句柄, 整数型, , hwnd
    .参数 事件标识符, 整数型, , nIDEvent
    .参数 时钟周期, 整数型, , uElapse
    .参数 回调函数地址, 子程序指针, , lpTimerFunc

.DLL命令 注销时钟_API, 逻辑型, "", "KillTimer", , 
    .参数 窗口句柄, 整数型, , hwnd
    .参数 事件标识符, 整数型, , nIDEvent

.DLL命令 动态调用子程序_API, 整数型, "", "CallWindowProcA", , 
    .参数 动态调用代码, 字节集, , 一定要用本人编写的
    .参数 子程序, 子程序指针, , 子程序指针
    .参数 参数, 整数型, 数组, 为整数数组，参数1为成员1…类推；文本型和字节集型（自定义结构）为指针
    .参数 参数数目, 整数型, , 一定要和参数数组相符，不然会出错
    .参数 是否C调用, 逻辑型, , 真为cdecl调用方式，假为stdcall调用方式（即标准WINAPI方式）

.DLL命令 测试虚拟键_API, 整数型, "", "GetAsyncKeyState", , 
    .参数 键代码, 整数型, , vKey Long，欲测试的虚拟键的键码 

.程序集 程序集, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。

.程序集 枫式热键程序集, , , 

.程序集变量 时钟句柄, 空白型, , , 
.子程序 绑定热键, 空白型, 公开, 绑定一个枫式热键。
.参数 _热键集, 热键数据, , 欲绑定的热键对象。

.局部变量 i, 空白型, , , 

赋值 (i, 查找热键 (_热键集.哈希标符))
.如果 (小于 (i, 1))
    加入成员 (热键队列, _热键集)
.否则
    赋值 (热键队列 [i], _热键集)
.如果结束


.子程序 取消热键, 逻辑型, 公开, 取消一个枫式热键。成功返回真，否则返回假。
.参数 哈希标符, 文本型, 可空, 欲取消热键的哈希标符。（注意：如果参数为空则取消所有已绑定的热键！）

.局部变量 i, 空白型, , , 

.如果 (是否为空 (哈希标符))
    清除数组 (热键队列)
.否则
    赋值 (i, 查找热键 (哈希标符))
    .如果 (大于 (i, 0))
        删除成员 (热键队列, i, )
    .否则
        返回 (假)
    .如果结束
    
.如果结束
返回 (真)

.子程序 查找热键, 整数型, , 
.参数 哈希标符, 文本型, , 

.局部变量 i, 空白型, , , 

.计次循环首 (取数组成员数 (热键队列), i)
    .如果真 (等于 (哈希标符, 热键队列 [i], 哈希标符))
        返回 (i)
    .如果真结束
    
.计次循环尾 ()
返回 (0)

.子程序 监视热键, 空白型, 公开, 系统开始自动监视热键。（特别提醒：刷新时间设为0时仍会监视热键，而如果刷新时间设为负数时则会停止监视！）
.参数 刷新时间, 整数型, 可空, 设置热键监视的刷新时间。（注意：如果为本参数小于零则暂停监视！）

 ' 载入 (win32RJ, , 假)
 ' win32RJ.监视时钟.时钟周期 ＝ 刷新时间
终止热键 ()
赋值 (时钟句柄, 创建时钟_API (0, 0, 刷新时间, &_监视热键_周期事件))

.子程序 终止热键, 逻辑型, 公开, 终止热键成功返回真，系统未监视热键返回假。
.局部变量 零食, 逻辑型, , , 

 ' 如果真 (是否已创建 (win32RJ))
 ' win32RJ.销毁 ()
赋值 (零食, 注销时钟_API (0, 时钟句柄))
赋值 (时钟句柄, 0)
返回 (零食)

.窗口程序集 win32FSRJ程序集, , , 

.子程序 _监视热键_周期事件, 空白型, , 
.局部变量 i, 空白型, , , 
.局部变量 wb地址, 空白型, , "1", 

.判断循环首 (大于 (取数组成员数 (热键队列), i))
    赋值 (i, 相加 (i, 1))
    .如果真 (等于 (热键检测 (i), 真))
        赋值 (wb地址 [1], 取文本指针_API (热键队列 [i], 哈希标符, 热键队列 [i], 哈希标符, 0))
        动态调用子程序_API (#动态调用代码, 热键队列 [i], 函数指针, wb地址, 1, 假)
        跳出循环 ()
    .如果真结束
    
.判断循环尾 ()

.子程序 热键检测, 逻辑型, , 
.参数 编号, 空白型, , 

.局部变量 i, 空白型, , , 
.局部变量 s, 空白型, , , 

.计次循环首 (取数组成员数 (热键队列 [编号], 触发条键), i)
    赋值 (s, 测试虚拟键_API (热键队列 [编号], 触发条键 [i]))
    .如果真 (或者 (等于 (s, 0), 等于 (s, 1)))
        返回 (假)
    .如果真结束
    
.计次循环尾 ()
返回 (真)


 ' 不属于任何一个程序集、类模块的函数：
