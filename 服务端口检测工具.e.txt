 ' 文件类型：Windows窗口程序

 ' 程序名称：服务器端口检查工具
 ' 程序描述：服务器端口检查工具 V2.1
@备注:
最后更新日期 2010-10-13 16:30
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：2.1
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 0
    顶边 = 0
    宽度 = 806
    高度 = 400
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “服务端口检测工具”
    帮助文件名 = “”

窗口 窗口_增加服务器
    左边 = 50
    顶边 = 50
    宽度 = 300
    高度 = 230
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “增加服务器”
    帮助文件名 = “”

窗口 窗口_系统设置
    左边 = 50
    顶边 = 50
    宽度 = 376
    高度 = 141
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “系统设置”
    帮助文件名 = “”

窗口 窗口_修改服务器
    左边 = 50
    顶边 = 50
    宽度 = 300
    高度 = 230
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “修改服务器”
    帮助文件名 = “”

窗口 窗口_服务器异常
    左边 = 50
    顶边 = 50
    宽度 = 256
    高度 = 158
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “警告”
    帮助文件名 = “”



.常量 _状态, "0", , 
.常量 _索引, "1", , 
.常量 _服务器名称, "2", , 
.常量 _端口, "3", , 
.常量 _统计, "4", , 
.常量 _IP, "5", , 
.常量 _线路, "6", , 
.常量 _负责人, "7", , 
.常量 _联系电话, "8", , 
.常量 _飞信账号, "9", , 
.常量 _飞信密码, "10", , 
.常量 _是否检测, "11", , 
.常量 , , , 
.常量 , , , 
.常量 __服务器名称_pz, "“name”", , 
.常量 __IP_pz, "“ip”", , 
.常量 __端口_pz, "“port”", , 
.常量 __负责人_pz, "“fzr”", , 
.常量 __联系电话_pz, "“tel”", , 
.常量 __飞信账号_pz, "“fetion”", , 
.常量 __飞信密码_pz, "“pwd”", , 
.常量 __线路_pz, "“connect”", , 
.常量 , , , 
.常量 , , , 
.常量 _软件标题, "“′静等花落、服务器端口检测工具 V2.1”", , 
.常量 , , , 
.常量 , , , 
.常量 管理员飞信账号, "“XXXXXXXXXXX”", , 请自行更改
.常量 管理员飞信密码, "“XXXXXXXXXXX”", , 
.常量 管理员收信号码, "“XXXXXXXXXXX”", , 请自行更改
.常量 飞信特殊字符, "“一些特殊字符可以用其对应的ASCII码替换，记得前面加%就行了......
#              %23
&              %26  
水平制表符    %09
垂直制表符    %0B
换行      %0A
空格      %20
双引号      %22
+              %2B
|              %7C ”", , 一些特殊字符
.常量 , , , 
.常量 管理员飞信账号2, "“XXXXXXXXXXX”", , 请自行更改
.常量 管理员飞信密码2, "“XXXXXXX”", , 
.常量 管理员收信号码2, "“XXXXXXXXXXX”", , 请自行更改
.图片 弹窗底图, " ' 已保存到：D:\易语言学习\Data\服务端口检测工具.e\弹窗底图", , 
.图片 托盘图标, " ' 已保存到：D:\易语言学习\Data\服务端口检测工具.e\托盘图标", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 3 0 应用接口支持库
 ' iext5 {E5000198-4471-40e2-92BC-D0BA075BDBB2} 2 0 扩展界面支持库五
 ' EDataStructure 0AFF5F28B2CB42ce906AA27D6E485457 2 0 数据结构支持库
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 2 0 多线程支持库
 ' internet 707ca37322474f6ca841f0e224f4b620 2 0 互联网支持库
 ' shellEx DA19AC3ADD2F4121AAD84AC5FBCAFC71 3 0 扩展功能支持库一




.全局变量 配置文件, 文本型, , , 
.全局变量 自动检查, 逻辑型, , , 
.全局变量 最大错误数, 整数型, , , 
.全局变量 autocheck, 文本型, , , 
.全局变量 checktime, 文本型, , , 
.全局变量 maxerror, 文本型, , , 
.全局变量 配置节名, 文本型, , "0", 
.全局变量 日志文件, 整数型, , , 
.全局变量 现在时间, 日期时间型, , , 
.全局变量 首次载入完毕, 逻辑型, , , 
.全局变量 刷新线程句柄, 整数型, , , 
.全局变量 匿名全局变量_2077, 空白型, , , 
.全局变量 匿名全局变量_2078, 空白型, , , 
.全局变量 匿名全局变量_2079, 空白型, , , 
.全局变量 匿名全局变量_2080, 空白型, , , 
.全局变量 服务器名称, 文本型, , , 
.全局变量 IP, 文本型, , , 
.全局变量 端口, 文本型, , , 
.全局变量 负责人, 文本型, , , 
.全局变量 联系电话, 文本型, , , 
.全局变量 匿名全局变量_2081, 空白型, , , 
.全局变量 匿名全局变量_2304, 空白型, , , 
.全局变量 匿名全局变量_2305, 空白型, , , 
.全局变量 管理员短信通知, 逻辑型, , , 

.窗口程序集 窗口程序集_启动窗口, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 命令行参数, 文本型, , "0", 
.局部变量 X, 整数型, , , 
.局部变量 是否隐藏运行, 逻辑型, , , 

 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

载入 (窗口_服务器异常, , 假)
取命令行 (命令行参数)
.计次循环首 (取数组成员数 (命令行参数), X)
    处理事件 ()
    .判断开始 (等于 (命令行参数 [X], “/hide”))
        赋值 (是否隐藏运行, 真)
    .默认
        
    .判断结束
    .判断开始 (等于 (命令行参数 [X], “/admin”))
        赋值 (管理员短信通知, 真)
    .默认
         ' 本源码来自易语言资源网(www.5A5X.com)
    .判断结束
    
.计次循环尾 ()




.判断开始 (是否隐藏运行)
    _启动窗口.置托盘图标 (#托盘图标, #_软件标题)
.默认
    赋值 (_启动窗口., 真)
    赋值 (_启动窗口., 真)
.判断结束



赋值 (_启动窗口., #_软件标题)
创建目录 (相加 (取运行目录 (), “\log”))

赋值 (配置文件, 相加 (取运行目录 (), “\set.ini”))


赋值 (日志文件, 打开文件 (相加 (取运行目录 (), “\log\”, 到文本 (取日期 (取现行时间 ())), “.log”), #改读, #无限制))
插入文本行 (日志文件, 相加 (“程序启动成功！”, 到文本 (取现行时间 ())))



载入配置文件_ ()



.子程序 读取服务器列表_, 空白型, , 
.局部变量 I, 整数型, , , 
.局部变量 X, 整数型, , , 
.局部变量 索引, 整数型, , , 

赋值 (配置节名, 取配置节名 (配置文件))
赋值 (I, 取数组成员数 (配置节名))
.计次循环首 (I, X)
    处理事件 ()
    .判断开始 (等于 (取文本长度 (配置节名 [X]), 取文本长度 (到文本 (到数值 (配置节名 [X])))))
        赋值 (索引, -1.插入表项 (“等待检测”, 1, , , ))
        索引.置标题 (#_索引, 配置节名 [X])
        索引.置标题 (#_服务器名称, 读配置项 (配置文件, 配置节名 [X], #__服务器名称_pz, ))
        索引.置标题 (#_端口, 读配置项 (配置文件, 配置节名 [X], #__端口_pz, ))
        索引.置标题 (#_统计, “0”)
        索引.置标题 (#_IP, 读配置项 (配置文件, 配置节名 [X], #__IP_pz, ))
        索引.置标题 (#_负责人, 读配置项 (配置文件, 配置节名 [X], #__负责人_pz, ))
        索引.置标题 (#_联系电话, 读配置项 (配置文件, 配置节名 [X], #__联系电话_pz, ))
        索引.置标题 (#_飞信账号, 读配置项 (配置文件, 配置节名 [X], #__飞信账号_pz, ))
        索引.置标题 (#_飞信密码, 读配置项 (配置文件, 配置节名 [X], #__飞信密码_pz, ))
        索引.置标题 (#_线路, 读配置项 (配置文件, 配置节名 [X], #__线路_pz, ))
        索引.置标题 (#_是否检测, “0”)
    .默认
        
    .判断结束
    
    处理事件 ()
.计次循环尾 ()

赋值 (.时钟周期, 1000)

.子程序 _超级列表框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_远程方式HTTP_被选择 ()

.子程序 _刷新显示服务器状态, 空白型, , 
未知支持库函数_0 (&子程序_刷新, , 刷新线程句柄)

.子程序 子程序_刷新, 空白型, , 
.局部变量 X, 整数型, , , 

赋值 (.时钟周期, 0)
赋值 (.禁止, 真)
赋值 (_启动窗口., 相加 (#_软件标题, 取空白文本 (5), “当前监管服务端口有”, 到文本 (取表项数 ()), “个;其中网通服务器为”, _判断电信网通 ()))
.计次循环首 (取表项数 (), X)
    处理事件 ()
    .判断开始 (等于 (相减 (X, 1).取标题 (#_是否检测), “0”))
        
        相减 (X, 1).置标题 (#_状态, “正在检测”)
        相减 (X, 1).置图片 (#_状态, 3)
        .判断开始 (相减 (X, 1).取标题 (#_IP).连接 (到整数 (相减 (X, 1).取标题 (#_端口))))
            相减 (X, 1).置图片 (#_状态, 0)
            相减 (X, 1).置标题 (#_状态, “连接正常”)
            
            .判断开始 (大于或等于 (到整数 (相减 (X, 1).取标题 (#_统计)), 最大错误数))
                
                插入文本行 (日志文件, 相加 (“服务器恢复正常！服务器名称：”, 相减 (X, 1).取标题 (#_服务器名称), “IP为：”, 相减 (X, 1).取标题 (5), “端口为：”, 相减 (X, 1).取标题 (3), 取空白文本 (5), 到文本 (取现行时间 ())))
                
                .判断开始 (管理员短信通知)
                    未知支持库函数_7 (相加 (“http://sms.api.bz/fetion.php?username=”, #管理员飞信账号, “&password=”, #管理员飞信密码, “&sendto=”, #管理员收信号码, “&message=%0A下列服务器已恢复:%0A服务器名:”, 相减 (X, 1).取标题 (#_服务器名称), “%0AIP:”, 相减 (X, 1).取标题 (#_IP), “%0A负责人:”, 相减 (X, 1).取标题 (#_负责人), “%0A电话:”, 相减 (X, 1).取标题 (#_联系电话)))
                    
                    未知支持库函数_7 (相加 (“http://sms.api.bz/fetion.php?username=”, #管理员飞信账号2, “&password=”, #管理员飞信密码2, “&sendto=”, #管理员收信号码2, “&message=%0A下列服务器已恢复:%0A服务器名:”, 相减 (X, 1).取标题 (#_服务器名称), “%0AIP:”, 相减 (X, 1).取标题 (#_IP), “%0A负责人:”, 相减 (X, 1).取标题 (#_负责人), “%0A电话:”, 相减 (X, 1).取标题 (#_联系电话)))
                    
                    
                .默认
                    
                .判断结束
                
                未知支持库函数_7 (相加 (“http://sms.api.bz/fetion.php?username=”, 相减 (X, 1).取标题 (#_飞信账号), “&password=”, 相减 (X, 1).取标题 (#_飞信密码), “&sendto=”, 相减 (X, 1).取标题 (#_飞信账号), “&message=%0A”, 相减 (X, 1).取标题 (#_负责人), “您好,您所管辖IP为:”, 相减 (X, 1).取标题 (#_IP), “的服务器已经恢复正常！”))
                
                
                相减 (X, 1).置标题 (#_统计, “0”)
            .默认
                相减 (X, 1).置标题 (#_统计, “0”)
            .判断结束
            
        .判断 (小于 (到整数 (相减 (X, 1).取标题 (#_统计)), 最大错误数))
            相减 (X, 1).置图片 (#_状态, 1)
            相减 (X, 1).置标题 (#_状态, “连接异常”)
            相减 (X, 1).置标题 (#_统计, 到文本 (相加 (到数值 (相减 (X, 1).取标题 (#_统计)), 1)))
        .默认
            相减 (X, 1).置图片 (#_状态, 2)
            相减 (X, 1).置标题 (#_状态, “连接失败”)
            相减 (X, 1).置标题 (#_统计, 到文本 (相加 (到数值 (相减 (X, 1).取标题 (#_统计)), 1)))
            
            插入文本行 (日志文件, 相加 (“有服务器异常，请检查！服务器名称：”, 相减 (X, 1).取标题 (#_服务器名称), “IP为：”, 相减 (X, 1).取标题 (#_IP), “端口为：”, 相减 (X, 1).取标题 (#_端口), 取空白文本 (5), 到文本 (取现行时间 ())))
            
            .判断开始 (管理员短信通知)
                未知支持库函数_7 (相加 (“http://sms.api.bz/fetion.php?username=”, #管理员飞信账号, “&password=”, #管理员飞信密码, “&sendto=”, #管理员收信号码, “&message=%0A异常服务器信息:%0A服务器名:”, 相减 (X, 1).取标题 (#_服务器名称), “%0AIP:”, 相减 (X, 1).取标题 (#_IP), “%0A负责人:”, 相减 (X, 1).取标题 (#_负责人), “%0A电话:”, 相减 (X, 1).取标题 (#_联系电话)))
                
                未知支持库函数_7 (相加 (“http://sms.api.bz/fetion.php?username=”, #管理员飞信账号2, “&password=”, #管理员飞信密码2, “&sendto=”, #管理员收信号码2, “&message=%0A异常服务器信息:%0A服务器名:”, 相减 (X, 1).取标题 (#_服务器名称), “%0AIP:”, 相减 (X, 1).取标题 (#_IP), “%0A负责人:”, 相减 (X, 1).取标题 (#_负责人), “%0A电话:”, 相减 (X, 1).取标题 (#_联系电话)))
                
            .默认
                
            .判断结束
            
            
            
            .判断开始 (不等于 (相减 (X, 1).取标题 (#_飞信密码), “”))
                未知支持库函数_7 (相加 (“http://sms.api.bz/fetion.php?username=”, 相减 (X, 1).取标题 (#_飞信账号), “&password=”, 相减 (X, 1).取标题 (#_飞信密码), “&sendto=”, 相减 (X, 1).取标题 (#_飞信账号), “&message=%0A”, 相减 (X, 1).取标题 (#_负责人), “您好,您所管辖IP为:”, 相减 (X, 1).取标题 (#_IP), “的服务器有异常，请及时检查！”))
                
                
            .默认
                
            .判断结束
            赋值 (服务器名称, 相减 (X, 1).取标题 (#_服务器名称))
            赋值 (IP, 相减 (X, 1).取标题 (#_IP))
            赋值 (端口, 相减 (X, 1).取标题 (#_端口))
            赋值 (负责人, 相减 (X, 1).取标题 (#_负责人))
            赋值 (联系电话, 相减 (X, 1).取标题 (#_联系电话))
            
            .判断开始 (是否已创建 (窗口_服务器异常))
                .判断开始 (窗口_服务器异常.)
                    刷新异常信息_ ()
                .默认
                    _窗口_服务器异常_创建 ()
                .判断结束
                
            .默认
                载入 (窗口_服务器异常, , 假)
            .判断结束
            
        .判断结束
        
    .默认
        
    .判断结束
    
    处理事件 ()
    
.计次循环尾 ()
 ' 本源码来自易语言资源网(www.5A5X.com)

断开连接 ()
赋值 (.禁止, 假)
赋值 (.时钟周期, 相乘 (到整数 (checktime), 1000))
未知支持库函数_7 (刷新线程句柄)

.子程序 _时钟_刷新显示_周期事件, 空白型, , 
处理事件 ()
关闭文件 (日志文件)
赋值 (日志文件, 打开文件 (相加 (取运行目录 (), “\log\”, 到文本 (取日期 (取现行时间 ())), “.log”), #改读, #无限制))
.判断开始 (等于 (自动检查, 真))
    _刷新显示服务器状态 ()
.默认
    
.判断结束



.子程序 _远程方式HTTP_被选择, 空白型, , 

未知支持库函数_56 (相加 (“http://”, .取标题 (., 5), “:”, .取标题 (., 3)))



.子程序 _远程方式Mstsc_被选择, 空白型, , 

.判断开始 (等于 (信息框 (相加 (“准备连接的端口为:”, .取标题 (., #_端口), “.点取消连接默认端口.”), 相加 (#询问图标, #确认取消钮), “询问”), 0))
    运行 (相加 (“CMD.exe /c mstsc /v:”, .取标题 (., #_IP), “:”, .取标题 (., #_端口)), 假, 1)
.默认
    运行 (相加 (“CMD.exe /c mstsc /v:”, .取标题 (., #_IP)), 假, 1)
.判断结束


.子程序 _超级列表框_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 现行选中项_tem, 整数型, , , 

赋值 (现行选中项_tem, .)

.判断开始 (等于 (现行选中项_tem.取标题 (#_是否检测), “0”))
    赋值 (.可视, 真)
    赋值 (.可视, 假)
.默认
    赋值 (.可视, 假)
    赋值 (.可视, 真)
    
.判断结束


.判断开始 (不等于 (., -1))
    弹出菜单 ()
.默认
    返回 (假)
.判断结束





.子程序 __启动窗口_将被销毁, 空白型, , 
赋值 (.时钟周期, 0)
关闭文件 (日志文件)
断开连接 ()
置托盘图标 ()
结束 ()

.子程序 _刷新状态_被单击, 空白型, , 
_刷新显示服务器状态 ()

.子程序 _查看日志_被单击, 空白型, , 
运行 (相加 (“notepad”, 取空白文本 (1), 取运行目录 (), “\log\”, 到文本 (取日期 (取现行时间 ())), “.log”), 假, )


.子程序 _运行CMD_被单击, 空白型, , 
 ' 运行 (“cmd.exe /k echo off&echo 智游服务端口检测工具 V1.0&echo 请输入要执行的命令然后按回车键确认!”, 假, )
载入 (窗口_服务器异常, _启动窗口, 假)

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
保存环境设置_ ()
.判断开始 (等于 (信息框 (“是否关闭？关闭后将不能实时查看服务器状态！”, 相加 (#询问图标, #确认取消钮), “询问”), 0))
    返回 (真)
.默认
    返回 (假)
.判断结束


.子程序 保存环境设置_, 空白型, , 
写配置项 (配置文件, “HxH”, “All”, 到文本 (相加 (100, 取表项数 ())))
写配置项 (配置文件, “setting”, “autocheck”, autocheck)
写配置项 (配置文件, “setting”, “checktime”, checktime)
写配置项 (配置文件, “setting”, “maxerror”, maxerror)

.子程序 载入配置文件_, 空白型, , 
赋值 (autocheck, 读配置项 (配置文件, “setting”, “autocheck”, “ 1”))
赋值 (checktime, 读配置项 (配置文件, “setting”, “checktime”, “30”))
赋值 (maxerror, 读配置项 (配置文件, “setting”, “maxerror”, “3”))
.判断开始 (不等于 (autocheck, “”))
    .判断开始 (等于 (到整数 (autocheck), 1))
        赋值 (自动检查, 真)
    .默认
        赋值 (自动检查, 假)
    .判断结束
    
.默认
    赋值 (autocheck, “1”)
.判断结束
处理事件 ()
.判断开始 (不等于 (checktime, “”))
    
.默认
    赋值 (.时钟周期, 相乘 (30, 1000))
.判断结束

.判断开始 (不等于 (maxerror, “”))
    赋值 (最大错误数, 到整数 (maxerror))
.默认
    赋值 (最大错误数, 3)
.判断结束

读取服务器列表_ ()


.子程序 _增加服务器_被单击, 空白型, , 
载入 (窗口_增加服务器, _启动窗口, 真)

.子程序 _删除服务器_被选择, 空白型, , 
.判断开始 (等于 (信息框 (“确认删除服务器？此操作不可逆！”, 相加 (#询问图标, #确认取消钮), “询问”), 0))
    写配置项 (配置文件, .取标题 (., 1), , )
    .删除表项 (.)
.默认
    
.判断结束


.子程序 _系统设置_被单击, 空白型, , 
载入 (窗口_系统设置, _启动窗口, 真)


.子程序 __启动窗口_托盘事件, 空白型, , 
.参数 操作类型, 整数型, , 

.判断开始 (等于 (操作类型, #单击右键))
    
    弹出菜单 ()
    
.默认
    
    赋值 (_启动窗口., 真)
    赋值 (_启动窗口., 1)
    赋值 (_启动窗口., 真)
.判断结束



.子程序 _隐藏运行_被单击, 空白型, , 
_启动窗口.置托盘图标 (#托盘图标, #_软件标题)




赋值 (_启动窗口., 假)
赋值 (_启动窗口., 假)


.子程序 _修改服务器_被选择, 空白型, , 
载入 (窗口_修改服务器, _启动窗口, 真)

.子程序 _超级列表框_表项被激活, 空白型, , 


.子程序 _超级列表框_当前表项被改变, 空白型, , 

取鼠标水平位置 ().未知支持库函数_26 (取鼠标垂直位置 (), 相加 (“联系人：”, .取标题 (., #_负责人), #换行符, “电话：”, .取标题 (., #_联系电话)), -1, )


.子程序 _退出_被选择, 空白型, , 
_启动窗口.销毁 ()

.子程序 _关于_被选择, 空白型, , 

信息框 (“服务器端口实时监测工具！”, 相加 (#信息图标, #确认钮), #_软件标题)

.子程序 _超文本浏览框1_载入完毕, 空白型, , 
输出调试文本 (“载入完毕”)
赋值 (首次载入完毕, 真)


.子程序 __启动窗口_位置被改变, 空白型, , 
.判断开始 (等于 (_启动窗口., 2))
    _隐藏运行_被单击 ()
.默认
    
.判断结束


.子程序 _后台运行_被选择, 空白型, , 
_隐藏运行_被单击 ()

.子程序 _刷新本服务器状态_被选择, 空白型, , 
.局部变量 现行选中项_tem, 整数型, , , 

赋值 (现行选中项_tem, .)
.判断开始 (.禁止)
    信息框 (“请耐心等待刷新完成...”, #信息图标, #_软件标题)
.默认
    赋值 (.禁止, 真)
    赋值 (.时钟周期, 0)
    现行选中项_tem.置标题 (#_状态, “正在检测”)
    输出调试文本 (现行选中项_tem.取标题 (#_状态))
    现行选中项_tem.置图片 (#_状态, 3)
    .判断开始 (现行选中项_tem.取标题 (#_IP).连接 (到整数 (现行选中项_tem.取标题 (#_端口))))
        现行选中项_tem.置图片 (#_状态, 0)
        现行选中项_tem.置标题 (#_状态, “连接正常”)
        
        .判断开始 (大于或等于 (到整数 (现行选中项_tem.取标题 (#_统计)), 最大错误数))
            
            插入文本行 (日志文件, 相加 (“服务器恢复正常！服务器名称：”, 现行选中项_tem.取标题 (#_服务器名称), “IP为：”, 现行选中项_tem.取标题 (5), “端口为：”, 现行选中项_tem.取标题 (3), 取空白文本 (5), 到文本 (取现行时间 ())))
            .判断开始 (管理员短信通知)
                未知支持库函数_7 (相加 (“http://sms.api.bz/fetion.php?username=”, #管理员飞信账号, “&password=”, #管理员飞信密码, “&sendto=”, #管理员收信号码, “&message=%0A下列服务器已恢复:%0A服务器名:”, 现行选中项_tem.取标题 (#_服务器名称), “%0AIP:”, 现行选中项_tem.取标题 (#_IP), “%0A负责人:”, 现行选中项_tem.取标题 (#_负责人), “%0A电话:”, 现行选中项_tem.取标题 (#_联系电话)))
                
                未知支持库函数_7 (相加 (“http://sms.api.bz/fetion.php?username=”, #管理员飞信账号2, “&password=”, #管理员飞信密码2, “&sendto=”, #管理员收信号码2, “&message=%0A下列服务器已恢复:%0A服务器名:”, 现行选中项_tem.取标题 (#_服务器名称), “%0AIP:”, 现行选中项_tem.取标题 (#_IP), “%0A负责人:”, 现行选中项_tem.取标题 (#_负责人), “%0A电话:”, 现行选中项_tem.取标题 (#_联系电话)))
                
            .默认
                 ' 本源码来自易语言资源网(www.5A5X.com)
            .判断结束
            
            
            未知支持库函数_7 (相加 (“http://sms.api.bz/fetion.php?username=”, 现行选中项_tem.取标题 (#_飞信账号), “&password=”, 现行选中项_tem.取标题 (#_飞信密码), “&sendto=”, 现行选中项_tem.取标题 (#_飞信账号), “&message=%0A”, 现行选中项_tem.取标题 (#_负责人), “您好,您所管辖IP为:”, 现行选中项_tem.取标题 (#_IP), “的服务器已经恢复正常！”))
            
            
            现行选中项_tem.置标题 (#_统计, “0”)
        .默认
            
        .判断结束
        
    .判断 (小于 (到整数 (现行选中项_tem.取标题 (#_统计)), 最大错误数))
        现行选中项_tem.置图片 (#_状态, 1)
        现行选中项_tem.置标题 (#_状态, “连接异常”)
        现行选中项_tem.置标题 (#_统计, 到文本 (相加 (到数值 (现行选中项_tem.取标题 (#_统计)), 1)))
    .默认
        现行选中项_tem.置图片 (#_状态, 2)
        现行选中项_tem.置标题 (#_状态, “连接失败”)
        现行选中项_tem.置标题 (#_统计, 到文本 (相加 (到数值 (现行选中项_tem.取标题 (#_统计)), 1)))
        
        插入文本行 (日志文件, 相加 (“有服务器异常，请检查！服务器名称：”, 现行选中项_tem.取标题 (#_服务器名称), “IP为：”, 现行选中项_tem.取标题 (#_IP), “端口为：”, 现行选中项_tem.取标题 (#_端口), 取空白文本 (5), 到文本 (取现行时间 ())))
        .判断开始 (等于 (信息框 (“是否飞信通知相关人员?”, 相加 (#询问图标, #确认取消钮), #_软件标题), 0))
            未知支持库函数_7 (相加 (“http://sms.api.bz/fetion.php?username=”, #管理员飞信账号, “&password=”, #管理员飞信密码, “&sendto=”, #管理员收信号码, “&message=%0A异常服务器信息:%0A服务器名:”, 现行选中项_tem.取标题 (#_服务器名称), “%0AIP:”, 现行选中项_tem.取标题 (#_IP), “%0A负责人:”, 现行选中项_tem.取标题 (#_负责人), “%0A电话:”, 现行选中项_tem.取标题 (#_联系电话)))
            
            未知支持库函数_7 (相加 (“http://sms.api.bz/fetion.php?username=”, #管理员飞信账号2, “&password=”, #管理员飞信密码2, “&sendto=”, #管理员收信号码2, “&message=%0A异常服务器信息:%0A服务器名:”, 现行选中项_tem.取标题 (#_服务器名称), “%0AIP:”, 现行选中项_tem.取标题 (#_IP), “%0A负责人:”, 现行选中项_tem.取标题 (#_负责人), “%0A电话:”, 现行选中项_tem.取标题 (#_联系电话)))
            
            .判断开始 (不等于 (现行选中项_tem.取标题 (#_飞信密码), “”))
                未知支持库函数_7 (相加 (“http://sms.api.bz/fetion.php?username=”, 现行选中项_tem.取标题 (#_飞信账号), “&password=”, 现行选中项_tem.取标题 (#_飞信密码), “&sendto=”, 现行选中项_tem.取标题 (#_飞信账号), “&message=%0A”, 现行选中项_tem.取标题 (#_负责人), “您好,您所管辖IP为:”, 现行选中项_tem.取标题 (#_IP), “的服务器有异常，请及时检查！”))
                
                
            .默认
                
            .判断结束
            
        .默认
            
        .判断结束
        
        
        
        
        赋值 (服务器名称, 现行选中项_tem.取标题 (#_服务器名称))
        赋值 (IP, 现行选中项_tem.取标题 (#_IP))
        赋值 (端口, 现行选中项_tem.取标题 (#_端口))
        赋值 (负责人, 现行选中项_tem.取标题 (#_负责人))
        赋值 (联系电话, 现行选中项_tem.取标题 (#_联系电话))
        
        .判断开始 (是否已创建 (窗口_服务器异常))
            .判断开始 (窗口_服务器异常.)
                刷新异常信息_ ()
            .默认
                _窗口_服务器异常_创建 ()
            .判断结束
            
        .默认
            载入 (窗口_服务器异常, , 假)
        .判断结束
        
    .判断结束
    
    赋值 (.禁止, 假)
    赋值 (.时钟周期, 相乘 (到整数 (checktime), 1000))
.判断结束


.子程序 _暂停刷新本服务器_被选择, 空白型, , 
.局部变量 现行选中项_tem, 整数型, , , 

赋值 (现行选中项_tem, .)
现行选中项_tem.置标题 (#_是否检测, “1”)
现行选中项_tem.置图片 (#_状态, 2)
现行选中项_tem.置标题 (#_状态, “暂停检测”)

' 本源码来自易语言资源网(www.5A5X.com)


.子程序 _继续刷新本服务器_被选择, 空白型, , 
.局部变量 现行选中项_tem, 整数型, , , 

赋值 (现行选中项_tem, .)
现行选中项_tem.置标题 (#_是否检测, “0”)
现行选中项_tem.置图片 (#_状态, 3)
现行选中项_tem.置标题 (#_状态, “等待检测”)


.窗口程序集 窗口程序集_增加服务器, , , 

.子程序 _按钮_添加_添加服务器_被单击, 空白型, , 
.局部变量 配置新节名, 文本型, , , 
.局部变量 索引_, 文本型, , , 
.局部变量 现行选中项_tem, 整数型, , , 

赋值 (配置新节名, 到文本 (相加 (到数值 (读配置项 (配置文件, “HxH”, “All”, “100”)), 1)))

赋值 (索引_, 到文本 (_启动窗口.插入表项 (., -1, “等待监测”, 3, , , )))

.判断开始 (大于或等于 (到数值 (读配置项 (配置文件, “HxH”, “All”, )), 100))
    写配置项 (配置文件, 配置新节名, #__服务器名称_pz, .内容)
    写配置项 (配置文件, 配置新节名, #__IP_pz, .内容)
    写配置项 (配置文件, 配置新节名, #__端口_pz, .内容)
    写配置项 (配置文件, 配置新节名, #__负责人_pz, .内容)
    写配置项 (配置文件, 配置新节名, #__联系电话_pz, .内容)
    写配置项 (配置文件, 配置新节名, #__飞信账号_pz, .内容)
    写配置项 (配置文件, 配置新节名, #__飞信密码_pz, .内容)
    
    .判断开始 (等于 (.选中, 真))
        写配置项 (配置文件, 配置新节名, #__线路_pz, .标题)
    .判断 (等于 (.选中, 真))
        写配置项 (配置文件, 配置新节名, #__线路_pz, .标题)
    .默认
        
    .判断结束
    
    
    
.默认
    
.判断结束


_启动窗口.置标题 (., 到整数 (索引_), #_索引, 索引_)
_启动窗口.置标题 (., 到整数 (索引_), #_服务器名称, .内容)
_启动窗口.置标题 (., 到整数 (索引_), #_端口, .内容)
_启动窗口.置标题 (., 到整数 (索引_), #_统计, “0”)
_启动窗口.置标题 (., 到整数 (索引_), #_IP, .内容)
_启动窗口.置标题 (., 到整数 (索引_), #_负责人, .内容)
_启动窗口.置标题 (., 到整数 (索引_), #_联系电话, .内容)
_启动窗口.置标题 (., 到整数 (索引_), #_飞信账号, .内容)
_启动窗口.置标题 (., 到整数 (索引_), #_飞信密码, .内容)


_启动窗口.置标题 (., 到整数 (索引_), #_是否检测, “0”)


.判断开始 (等于 (.选中, 真))
    _启动窗口.置标题 (., 到整数 (索引_), #_线路, .标题)
.判断 (等于 (.选中, 真))
    _启动窗口.置标题 (., 到整数 (索引_), #_线路, .标题)
    
.默认
    
.判断结束
_刷新显示服务器状态 ()
窗口_增加服务器.销毁 ()

.子程序 _按钮_使用飞信_添加服务器_被单击, 空白型, , 
.判断开始 (等于 (.标题, “使用飞信”))
    赋值 (.标题, “我不是移动”)
    赋值 (窗口_增加服务器., 490)
    居中窗口_ (窗口_增加服务器)
    
    ' 本源码来自易语言资源网(www.5A5X.com)
.判断 (等于 (.标题, “我不是移动”))
    赋值 (.标题, “使用飞信”)
    赋值 (窗口_增加服务器., 310)
    居中窗口_ (窗口_增加服务器)
    
    
.默认
    
.判断结束


.子程序 _窗口_增加服务器_创建完毕, 空白型, , 
居中窗口_ (窗口_增加服务器)


.窗口程序集 窗口程序集_系统设置, , , 

.程序集变量 F5, 整数型, , , 
.子程序 _按钮1_被单击, 空白型, , 
.判断开始 (等于 (.选中, 真))
    赋值 (autocheck, “1”)
.默认
    赋值 (autocheck, “0”)
.判断结束

赋值 (checktime, .内容)
赋值 (maxerror, .内容)

.判断开始 (不等于 (autocheck, “”))
    .判断开始 (等于 (到整数 (autocheck), 1))
        赋值 (自动检查, 真)
    .默认
        赋值 (自动检查, 假)
    .判断结束
    
.默认
    
.判断结束
处理事件 ()
.判断开始 (不等于 (checktime, “”))
    .判断开始 (大于或等于 (到数值 (.内容), 15))
        .判断开始 (小于 (到数值 (.内容), 30))
            .判断开始 (等于 (信息框 (“建议数值为30-60秒之间,是否设置为30秒？”, 相加 (#询问图标, #确认取消钮, #默认按钮一), “询问”), 0))
                赋值 (.内容, “30”)
                赋值 (_启动窗口..时钟周期, 相乘 (30, 1000))
            .默认
                
            .判断结束
            
        .默认
            赋值 (_启动窗口..时钟周期, 相乘 (到整数 (checktime), 1000))
        .判断结束
        
        
        
    .默认
        信息框 (“最小数值为15秒，请返回重新输入!”, 相加 (#警告图标, #确认钮), “错误”)
        返回 ()
    .判断结束
    
    
    
.默认
    赋值 (_启动窗口..时钟周期, 相乘 (30, 1000))
.判断结束

.判断开始 (不等于 (maxerror, “”))
    赋值 (最大错误数, 到整数 (maxerror))
.默认
    赋值 (最大错误数, 3)
.判断结束

.判断开始 (.选中)
    .判断开始 (.选中)
        .判断开始 (.选中)
            写注册项 (#本地机器, “SOFTWARE\Microsoft\Windows\CurrentVersion\Run\服务端检测软件”, 相加 (取运行目录 (), “\”, 取执行文件名 (), “ /hide /admin”))
        .默认
            写注册项 (#本地机器, “SOFTWARE\Microsoft\Windows\CurrentVersion\Run\服务端检测软件”, 相加 (取运行目录 (), “\”, 取执行文件名 (), “ /hide”))
        .判断结束
        
    .默认
        写注册项 (#本地机器, “SOFTWARE\Microsoft\Windows\CurrentVersion\Run\服务端检测软件”, 相加 (取运行目录 (), “\”, 取执行文件名 ()))
    .判断结束
    
    
    
    
    
.默认
    删除注册项 (#本地机器, “SOFTWARE\Microsoft\Windows\CurrentVersion\Run\服务端检测软件”)
.判断结束



写配置项 (配置文件, “setting”, “autocheck”, autocheck)
写配置项 (配置文件, “setting”, “checktime”, checktime)
写配置项 (配置文件, “setting”, “maxerror”, maxerror)

.判断开始 (.选中)
    赋值 (管理员短信通知, 真)
.默认
    
.判断结束



未知支持库函数_11 (窗口_系统设置.取窗口句柄 (), F5)

窗口_系统设置.销毁 ()

.子程序 _窗口_系统设置_创建完毕, 空白型, , 
.判断开始 (等于 (读配置项 (配置文件, “setting”, “autocheck”, ), “1”))
    赋值 (.选中, 真)
.默认
    赋值 (.选中, 假)
    
.判断结束
赋值 (checktime, 读配置项 (配置文件, “setting”, “checktime”, ))
 ' 本源码来自易语言资源网(www.5A5X.com)
.判断开始 (不等于 (checktime, “”))
    赋值 (.内容, checktime)
.默认
    赋值 (.内容, “30”)
.判断结束


赋值 (F5, 未知支持库函数_10 (窗口_系统设置.取窗口句柄 (), 取窗口句柄 (), 0, #F5键))
.判断开始 (等于 (F5, 0))
    赋值 (.可视, 真)
.默认
    
.判断结束
赋值 (.内容, 到文本 (最大错误数))

.子程序 _编辑框2_内容被改变, 空白型, , 
.判断开始 (小于 (到数值 (.内容), 0))
    赋值 (.内容, 到文本 (取绝对值 (到数值 (.内容))))
.默认
    
.判断结束



.子程序 _自启动_隐藏启动_选择框_被单击, 空白型, , 
.判断开始 (.选中)
    .判断开始 (取反 (.选中))
        连续赋值 (真, .选中)
    .默认
        
    .判断结束
    
.默认
    
.判断结束


.子程序 _自启动_选择框_被单击, 空白型, , 
.判断开始 (取反 (.选中))
    .判断开始 (.选中)
        连续赋值 (假, .选中)
    .默认
        ' 本源码来自易语言资源网(www.5A5X.com)
    .判断结束
    
.默认
    
.判断结束


.子程序 _标签1_反馈事件, 整数型, , 
.参数 参数一, 整数型, , 
.参数 参数二, 整数型, , 


.判断开始 (等于 (信息框 (“是否服务器产生事件时通知管理员？”, 相加 (#询问图标, #确认取消钮), #_软件标题), 0))
    赋值 (.选中, 真)
.默认
    赋值 (.选中, 假)
.判断结束


.窗口程序集 窗口程序集_修改服务器, , , 

.程序集变量 索引_, 文本型, , , 
.子程序 _窗口_修改服务器_创建完毕, 空白型, , 
居中窗口_ (窗口_修改服务器)
赋值 (索引_, _启动窗口.取标题 (., _启动窗口.., #_索引))
 ' 本源码来自易语言资源网(www.5A5X.com)




赋值 (.内容, _启动窗口.取标题 (., _启动窗口.., #_服务器名称))
赋值 (.内容, _启动窗口.取标题 (., _启动窗口.., #_IP))
赋值 (.内容, _启动窗口.取标题 (., _启动窗口.., #_端口))
赋值 (.内容, _启动窗口.取标题 (., _启动窗口.., #_负责人))
赋值 (.内容, _启动窗口.取标题 (., _启动窗口.., #_联系电话))
赋值 (.内容, _启动窗口.取标题 (., _启动窗口.., #_飞信账号))
赋值 (.内容, _启动窗口.取标题 (., _启动窗口.., #_飞信密码))


.判断开始 (不等于 (.内容, “”))
    _按钮_使用飞信_修改服务器_被单击 ()
.默认
    
.判断结束

.判断开始 (等于 (_启动窗口.取标题 (., _启动窗口.., #_线路), “网通”))
    赋值 (.选中, 真)
    赋值 (.选中, 假)
.判断 (等于 (_启动窗口.取标题 (., _启动窗口.., #_线路), “电信”))
    赋值 (.选中, 真)
    赋值 (.选中, 假)
.默认
    
.判断结束





.子程序 _按钮_修改_修改服务器_被单击, 空白型, , 
.局部变量 节名__, 文本型, , , 
.局部变量 现行选中项, 整数型, , , 

赋值 (节名__, _启动窗口.取标题 (., _启动窗口.., #_索引))
赋值 (现行选中项, _启动窗口..)

_启动窗口.置标题 (., 现行选中项, #_状态, “等待刷新”)
_启动窗口.置图片 (., 现行选中项, #_状态, 1)
_启动窗口.置标题 (., 现行选中项, #_索引, 索引_)
_启动窗口.置标题 (., 现行选中项, #_服务器名称, .内容)
_启动窗口.置标题 (., 现行选中项, #_端口, .内容)
_启动窗口.置标题 (., 现行选中项, #_统计, “0”)
_启动窗口.置标题 (., 现行选中项, #_IP, .内容)
_启动窗口.置标题 (., 现行选中项, #_负责人, .内容)
_启动窗口.置标题 (., 现行选中项, #_联系电话, .内容)
_启动窗口.置标题 (., 现行选中项, #_飞信账号, .内容)
_启动窗口.置标题 (., 现行选中项, #_飞信密码, .内容)
' 本源码来自易语言资源网(www.5A5X.com)
.判断开始 (等于 (.选中, 真))
    
    写配置项 (配置文件, 节名__, #__线路_pz, .标题)
    _启动窗口.置标题 (., 现行选中项, #_线路, .标题)
.判断 (等于 (.选中, 真))
    写配置项 (配置文件, 节名__, #__线路_pz, .标题)
    _启动窗口.置标题 (., 现行选中项, #_线路, .标题)
.默认
    
.判断结束

写配置项 (配置文件, 节名__, #__服务器名称_pz, .内容)
写配置项 (配置文件, 节名__, #__IP_pz, .内容)
写配置项 (配置文件, 节名__, #__端口_pz, .内容)
写配置项 (配置文件, 节名__, #__负责人_pz, .内容)
写配置项 (配置文件, 节名__, #__联系电话_pz, .内容)
写配置项 (配置文件, 节名__, #__飞信账号_pz, .内容)
写配置项 (配置文件, 节名__, #__飞信密码_pz, .内容)



窗口_修改服务器.销毁 ()

.子程序 _按钮_使用飞信_修改服务器_被单击, 空白型, , 
.判断开始 (等于 (.标题, “使用飞信”))
    赋值 (.标题, “我不是移动”)
    赋值 (窗口_修改服务器., 490)
    居中窗口_ (窗口_修改服务器)
    
    
.判断 (等于 (.标题, “我不是移动”))
    赋值 (.标题, “使用飞信”)
    赋值 (窗口_修改服务器., 310)
    居中窗口_ (窗口_修改服务器)
    
    
.默认
    
.判断结束



.程序集 程序集_子, , , 

.子程序 _判断电信网通, 文本型, , 
.局部变量 节点, 未知类型0x50001, , , 
.局部变量 X, 整数型, , , 
.局部变量 N, 整数型, , , 
.局部变量 IP_, 文本型, , "0", 
.局部变量 Connect, 文本型, , "0", 
.局部变量 cnc, 整数型, , , 
.局部变量 tel, 整数型, , , 

赋值 (cnc, 0)
赋值 (tel, 0)
赋值 (X, _启动窗口.取表项数 (.))
重定义数组 (IP_, 假, X)
重定义数组 (Connect, 假, X)


.计次循环首 (X, N)
    赋值 (IP_ [N], _启动窗口.取标题 (., 相减 (N, 1), #_IP))
    赋值 (Connect [N], _启动窗口.取标题 (., 相减 (N, 1), #_线路))
    处理事件 ()
.计次循环尾 ()

.计次循环首 (取数组成员数 (IP_), N)
    .判断开始 (节点.未知支持库函数_3 (IP_ [N], 真))
        
        .判断开始 (等于 (Connect [N], “网通”))
            赋值 (cnc, 相加 (cnc, 1))
        .判断 (等于 (Connect [N], “电信”))
            赋值 (tel, 相加 (tel, 1))
        .默认
            
        .判断结束
        
        
    .默认
        
    .判断结束
    
    
    
.计次循环尾 ()


返回 (相加 (到文本 (cnc), “台,电信服务器为”, 到文本 (tel), “台.”))


.子程序 居中窗口_, 空白型, , 使窗口居屏幕正中间
.参数 窗口名字, 窗口, , 要操作的窗口名字。

赋值 (窗口名字.左边, 相减 (相除 (取屏幕宽度 (), 2), 相除 (窗口名字.宽度, 2)))
赋值 (窗口名字.顶边, 相减 (相除 (取屏幕高度 (), 2), 相除 (窗口名字.高度, 2)))

.窗口程序集 窗口程序集1, , , 

.子程序 _窗口_服务器异常_创建, 空白型, , 
.判断开始 (是否已创建 (窗口_服务器异常))
    赋值 (.图片, #弹窗底图)
    赋值 (.高度, 窗口_服务器异常.)
    赋值 (.宽度, 窗口_服务器异常.)
    
    窗口_服务器异常.置外形图片 (#弹窗底图, )
    
    赋值 (窗口_服务器异常., 相加 (取屏幕高度 (), 100))
    赋值 (窗口_服务器异常., 相减 (取屏幕宽度 (), 窗口_服务器异常., 3))
    赋值 (窗口_服务器异常., 真)
    赋值 (窗口_服务器异常., 真)
    赋值 (.时钟周期, 100)
    
    赋值 (.内容, 服务器名称)
    
    赋值 (.内容, 相加 (“服务器名称:”, 服务器名称))
    赋值 (.内容, 相加 (“服务器IP:”, IP, “:”, 端口))
    赋值 (.内容, 相加 (“负责人:”, 负责人))
    赋值 (.内容, 相加 (“联系电话:”, 联系电话))
    赋值 (.内容, 相加 (“发现时间:”, 到文本 (取现行时间 ())))
    
.默认
    
.判断结束


.子程序 _弹出窗口_时钟_周期事件, 空白型, , 
.局部变量 每次变量, 整数型, 静态, , 
.局部变量 变量单位, 整数型, , , 

处理事件 ()
.判断开始 (是否已创建 (窗口_服务器异常))
    赋值 (变量单位, 相除 (窗口_服务器异常., 20))
    赋值 (每次变量, 相加 (每次变量, 1))
    赋值 (窗口_服务器异常., 真)
    赋值 (窗口_服务器异常., 相减 (取屏幕高度 (), 相乘 (每次变量, 变量单位)))
    .如果真 (小于 (窗口_服务器异常., 相减 (取屏幕高度 (), ., 25)))
        赋值 (每次变量, 0)
        赋值 (.时钟周期, 0)
    .如果真结束
    
    
    
.默认
    
.判断结束




.子程序 _关闭按钮_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 


赋值 (窗口_服务器异常., 假)

.子程序 刷新异常信息_, 空白型, , 
.判断开始 (是否已创建 (窗口_服务器异常))
    赋值 (.内容, 服务器名称)
    
    赋值 (.内容, 相加 (“服务器名称:”, 服务器名称))
    赋值 (.内容, 相加 (“服务器IP:”, IP, “:”, 端口))
    赋值 (.内容, 相加 (“负责人:”, 负责人))
    赋值 (.内容, 相加 (“联系电话:”, 联系电话))
    赋值 (.内容, 相加 (“发现时间:”, 到文本 (取现行时间 ())))
    
    
.默认
    
.判断结束



 ' 不属于任何一个程序集、类模块的函数：
