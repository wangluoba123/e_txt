 ' 文件类型：Windows模块源码

 ' 程序名称：日期时间框
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 月历窗口
    左边 = 50
    顶边 = 50
    宽度 = 266
    高度 = 143
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 时间窗口
    左边 = 50
    顶边 = 50
    宽度 = 244
    高度 = 166
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 16746496 '  0xFF8800
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 2 0 多线程支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 2 1 高级表格支持库



 ' 所需要的模块
 ' 高精度等待 D:\程序\网络\管理\物流系统\高精度等待.ec


数据类型 时间数据类型, , 
    .成员 编辑框, 编辑框, 传址, , 
    .成员 跳动, 逻辑型, , , 

数据类型 坐标结构, , 
    .成员 底坐标, 整数型, , , 
    .成员 左坐标, 整数型, , , 
    .成员 右坐标, 整数型, , , 
    .成员 顶坐标, 整数型, , , 

.全局变量 时间编辑框, 未知类型0x41010015, , "0", 
.全局变量 时间编辑框许可证, 整数型, , , 

.DLL命令 取组件坐标, 空白型, "", "GetWindowRect", , 
    .参数 组件句柄, 整数型, , 
    .参数 RECT结构, 未知类型0x41010019, , 

.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。


.子程序 日期时间框_绑定, 空白型, 公开, 
.参数 编辑框, 编辑框, 参考, 
.参数 时间跳动, 逻辑型, , 如果为真，时间跟随秒钟跳动。
.参数 指定时间, 日期时间型, 可空, 如果为空跟随系统时间

未知支持库函数_3 ()
重定义数组 (真, 相加 (取数组成员数 (), 1))
赋值 ( [取数组成员数 ()]., 编辑框)
赋值 ( [取数组成员数 ()]., 时间跳动)
未知支持库函数_4 ()
.如果 (等于 (是否为空 (指定时间), 真))
    赋值 (编辑框.内容, 取标准时间文本 (取现行时间 (), 真, 1))
.否则
    赋值 (编辑框.内容, 取标准时间文本 (指定时间, 真, 1))
.如果结束
 ' 编辑框.输入方式 ＝ 1

.子程序 日期时间框_鼠标左键被放开, 逻辑型, 公开, 
.参数 编辑框, 编辑框, 参考, 

.局部变量 选择位置, 整数型, , , 
.局部变量 结构, 未知类型0x41010036, , , 

赋值 (选择位置, 编辑框.起始选择位置)
输出调试文本 (相加 (“日期时间框_选择.选择位置=”, 到文本 (选择位置)))
未知函数_167837751 (取窗口句柄 (), )
.判断开始 (小于 (选择位置, 11))
    赋值 (.禁止, 真)
    载入 (假)
    未知函数_67174456 ()
    赋值 (.左边, 结构.)
    赋值 (.顶边, 结构.)
    赋值 (.可视, 真)
    赋值 (编辑框.禁止, 假)
.判断 (大于 (选择位置, 10))
    赋值 (.禁止, 真)
    载入 (假)
    未知函数_67174457 (编辑框)
    赋值 (.左边, 结构.)
    赋值 (.顶边, 结构.)
    赋值 (.可视, 真)
    赋值 (.禁止, 假)
.默认
    
.判断结束
返回 (真)

.子程序 取标准时间文本, 文本型, , 
.参数 转换时间, 日期时间型, , 需要转换的时间
.参数 是否补零, 逻辑型, , 是否自动补零
.参数 返回格式, 整数型, , 1、日期时间；2、日期；3、时间

.局部变量 年, 文本型, , , 
.局部变量 月, 文本型, , , 
.局部变量 日, 文本型, , , 
.局部变量 时, 文本型, , , 
.局部变量 分, 文本型, , , 
.局部变量 秒, 文本型, , , 
.局部变量 日期, 文本型, , , 
.局部变量 时间, 文本型, , , 

赋值 (年, 到文本 (取年份 (转换时间)))
赋值 (月, 到文本 (取月份 (转换时间)))
赋值 (日, 到文本 (取日 (转换时间)))
赋值 (时, 到文本 (取小时 (转换时间)))
赋值 (分, 到文本 (取分钟 (转换时间)))
赋值 (秒, 到文本 (取秒 (转换时间)))
.如果真 (等于 (是否补零, 真))
    .如果真 (等于 (取文本长度 (月), 1))
        赋值 (月, 相加 (“0”, 月))
    .如果真结束
    .如果真 (等于 (取文本长度 (日), 1))
        赋值 (日, 相加 (“0”, 日))
    .如果真结束
    .如果真 (等于 (取文本长度 (时), 1))
        赋值 (时, 相加 (“0”, 时))
    .如果真结束
    .如果真 (等于 (取文本长度 (分), 1))
        赋值 (分, 相加 (“0”, 分))
    .如果真结束
    .如果真 (等于 (取文本长度 (秒), 1))
        赋值 (秒, 相加 (“0”, 秒))
    .如果真结束
    
.如果真结束
赋值 (日期, 相加 (年, “-”, 月, “-”, 日))
赋值 (时间, 相加 (时, “:”, 分, “:”, 秒))
.判断开始 (等于 (返回格式, 1))
    返回 (相加 (日期, “ ”, 时间))
.判断 (等于 (返回格式, 2))
    返回 (日期)
.判断 (等于 (返回格式, 3))
    返回 (时间)
.默认
    返回 (相加 (日期, “ ”, 时间))
.判断结束


.子程序 时间跳动子程序, 空白型, , 
.局部变量 计次变量, 整数型, , , 

未知函数_67174470 (500000)
未知支持库函数_3 ()
.计次循环首 (取数组成员数 (), 计次变量)
    .如果真 (大于 (计次变量, 取数组成员数 ()))
        跳出循环 ()
    .如果真结束
    .如果真 (等于 ( [计次变量], , 真))
        赋值 ( [计次变量], .内容, 取标准时间文本 (取现行时间 (), 真, 1))
    .如果真结束
    
.计次循环尾 ()
.如果真 (不等于 (取数组成员数 (), 0))
    赋值 (计次变量, 0)
    .循环判断首 ()
        赋值 (计次变量, 相加 (计次变量, 1))
        .如果真 (等于 (取数组成员数 (), 0))
            跳出循环 ()
        .如果真结束
        .如果 (等于 (是否已创建 ( [计次变量], ), 假))
            删除成员 (计次变量, 1)
            赋值 (计次变量, 相减 (计次变量, 1))
        .否则
            赋值 (计次变量, 相加 (计次变量, 1))
        .如果结束
        
    .循环判断尾 (大于 (取数组成员数 (), 计次变量))
.如果真结束
未知支持库函数_4 ()
时间跳动子程序 ()

.窗口程序集 月历窗口程序集, , , 

.程序集变量 编辑框, 编辑框, , , 
.程序集变量 左键, 逻辑型, , , 
.程序集变量 改变, 整数型, , , 
.子程序 _月历窗口_创建完毕, 空白型, , 
赋值 (假)
赋值 (改变, 0)

.子程序 _月历窗口_被取消激活, 空白型, , 
.如果真 (等于 (可有焦点 (), 假))
    输出调试文本 (“_月历窗口_被取消激活”)
.如果真结束
销毁 ()

.子程序 月历窗口_组件, 空白型, , 
.参数 组件, 编辑框, 参考, 

赋值 (编辑框, 组件)
赋值 (.时钟周期, 1)
赋值 (.首选择日, 到时间 (组件.内容))

.子程序 _时钟1_周期事件, 空白型, , 
.如果真 (等于 (是否已创建 (编辑框), 假))
    销毁 ()
.如果真结束


.子程序 _月历_选择日期被改变, 空白型, , 
输出调试文本 (相加 (“_月历_选择日期被改变”, 到文本 (取现行时间 ())))
赋值 (改变, 相加 (改变, 1))
赋值 (.时钟周期, 50)
 ' 销毁 ()

.子程序 _左年按钮_被单击, 空白型, , 
赋值 (.首选择日, 增减时间 (.首选择日, #年份, -1))

.子程序 _右年按钮_被单击, 空白型, , 
赋值 (.首选择日, 增减时间 (.首选择日, #年份, 1))


.子程序 _月历_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

输出调试文本 (相加 (“_月历_鼠标左键被按下”, 到文本 (取现行时间 ())))
赋值 (左键, 真)
赋值 (.时钟周期, 50)

.子程序 _左键时钟_周期事件, 空白型, , 
.如果 (并且 (等于 (左键, 真), 小于 (改变, 2)))
    赋值 (编辑框.内容, 相加 (未知函数_67174507 (.首选择日, 真, 2), “ ”, 未知函数_67174507 (到时间 (编辑框.内容), 真, 3)))
    销毁 ()
.否则
    赋值 (左键, 假)
    赋值 (改变, 0)
.如果结束


.窗口程序集 时间窗口程序集, , , 

.程序集变量 编辑框, 编辑框, , , 
.子程序 _时间窗口_创建完毕, 空白型, , 


.子程序 时间窗口_组件, 空白型, , 
.参数 组件, 编辑框, 参考, 

.局部变量 循环次数, 整数型, , , 
.局部变量 计次变量, 整数型, , , 
.局部变量 行数, 整数型, , , 
.局部变量 列数, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 行, 整数型, , , 

赋值 ()
未知支持库函数_57 ()
.判断开始 (并且 (大于 (组件.起始选择位置, 10), 小于 (组件.起始选择位置, 14)))
    赋值 (循环次数, 24)
    赋值 (.内容, “小时”)
.判断 (并且 (大于 (组件.起始选择位置, 13), 小于 (组件.起始选择位置, 17)))
    赋值 (循环次数, 60)
    赋值 (.内容, “分钟”)
.判断 (并且 (大于 (组件.起始选择位置, 16), 小于 (组件.起始选择位置, 20)))
    赋值 (循环次数, 60)
    赋值 (.内容, “秒钟”)
.默认
    
.判断结束
赋值 (行数, .)
赋值 (列数, .)
.计次循环首 (循环次数, 计次变量)
    行.未知支持库函数_9 (列, #, 选择 (等于 (取文本长度 (到文本 (相减 (计次变量, 1))), 1), 相加 (“0”, 到文本 (相减 (计次变量, 1))), 到文本 (相减 (计次变量, 1))))
    .如果 (等于 (相加 (列, 1), 列数))
        .如果 (等于 (相加 (行, 1), 行数))
            跳出循环 ()
        .否则
            赋值 (行, 相加 (行, 1))
        .如果结束
        赋值 (列, 0)
    .否则
        赋值 (列, 相加 (列, 1))
    .如果结束
    
.计次循环尾 ()

.子程序 _时间窗口_被取消激活, 空白型, , 
销毁 ()

.子程序 _时间窗口_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.局部变量 替换文本, 文本型, , , 
.局部变量 时间文本, 文本型, , , 
.局部变量 选择位置, 整数型, , , 

赋值 (时间文本, 编辑框.内容)
赋值 (替换文本, 时间文本)
.判断开始 (并且 (大于 (编辑框.起始选择位置, 10), 小于 (编辑框.起始选择位置, 14)))
    赋值 (选择位置, 1)
    赋值 (时间文本, 相加 (取文本中间 (时间文本, 12, 2), 字符 (字符代码)))
    .如果真 (大于 (到整数 (时间文本), 23))
        赋值 (时间文本, 取文本右边 (时间文本, 相减 (取文本长度 (时间文本), 1)))
        .如果真 (大于 (到整数 (时间文本), 23))
            赋值 (取文本右边 (相减 (取文本长度 (), 1)))
        .如果真结束
        
    .如果真结束
    赋值 (时间文本, 到文本 (到整数 (时间文本)))
    赋值 (时间文本, 选择 (等于 (取文本长度 (时间文本), 1), 相加 (“0”, 时间文本), 时间文本))
    赋值 (替换文本, 相加 (取文本左边 (替换文本, 11), 时间文本, 取文本右边 (替换文本, 相减 (取文本长度 (替换文本), 13))))
.判断 (并且 (大于 (编辑框.起始选择位置, 13), 小于 (编辑框.起始选择位置, 17)))
    赋值 (选择位置, 2)
    赋值 (时间文本, 相加 (取文本中间 (时间文本, 15, 2), 字符 (字符代码)))
    .如果真 (大于 (到整数 (时间文本), 59))
        赋值 (取文本右边 (相减 (取文本长度 (), 1)))
        .如果真 (大于 (到整数 (时间文本), 59))
            赋值 (取文本右边 (相减 (取文本长度 (), 1)))
        .如果真结束
        
    .如果真结束
    赋值 (到文本 (到整数 ()))
    赋值 (选择 (等于 (取文本长度 (), 1), 相加 (“0”, ), ))
    赋值 (替换文本, 相加 (取文本左边 (替换文本, 14), 时间文本, 取文本右边 (替换文本, 相减 (取文本长度 (替换文本), 16))))
.判断 (并且 (大于 (编辑框.起始选择位置, 16), 小于 (编辑框.起始选择位置, 20)))
    赋值 (选择位置, 3)
    赋值 (时间文本, 相加 (取文本中间 (时间文本, 18, 2), 字符 (字符代码)))
    .如果真 (大于 (到整数 (时间文本), 59))
        赋值 (取文本右边 (相减 (取文本长度 (), 1)))
        .如果真 (大于 (到整数 (时间文本), 59))
            赋值 (取文本右边 (相减 (取文本长度 (), 1)))
        .如果真结束
        
    .如果真结束
    赋值 (到文本 (到整数 ()))
    赋值 (选择 (等于 (取文本长度 (), 1), 相加 (“0”, ), ))
    赋值 (替换文本, 相加 (取文本左边 (替换文本, 17), 时间文本, 取文本右边 (替换文本, 相减 (取文本长度 (替换文本), 19))))
.默认
    
.判断结束
输出调试文本 (相加 (“_时间窗口_字符输入.字符=”, 字符 (字符代码), “时间文本=”, 时间文本, “替换文本=”, 替换文本))
赋值 (编辑框.内容, 替换文本)
.判断开始 (等于 (选择位置, 1))
    赋值 (编辑框.起始选择位置, 11)
.判断 (等于 (选择位置, 2))
    赋值 (编辑框.起始选择位置, 14)
.判断 (等于 (选择位置, 3))
    赋值 (编辑框.起始选择位置, 17)
.默认
    
.判断结束
 ' 时间文本

.子程序 _时间窗口_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (键代码, #退格键), 等于 (键代码, #Del键), 等于 (键代码, #回车键)))
    销毁 ()
.如果真结束
.如果真 (或者 (等于 (键代码, #左光标键), 等于 (键代码, #右光标键)))
    .如果 (等于 (键代码, #左光标键))
        .判断开始 (并且 (大于 (编辑框.起始选择位置, 16), 小于 (编辑框.起始选择位置, 20)))
            赋值 (编辑框.起始选择位置, 14)
        .判断 (并且 (大于 (编辑框.起始选择位置, 13), 小于 (编辑框.起始选择位置, 17)))
            赋值 (.起始选择位置, 11)
        .默认
            
        .判断结束
        
    .否则
        .如果 (等于 (键代码, #右光标键))
            .判断开始 (并且 (大于 (编辑框.起始选择位置, 10), 小于 (编辑框.起始选择位置, 14)))
                赋值 (.起始选择位置, 14)
            .判断 (并且 (大于 (编辑框.起始选择位置, 13), 小于 (编辑框.起始选择位置, 17)))
                赋值 (.起始选择位置, 17)
            .默认
                
            .判断结束
            
        .否则
            
        .如果结束
        
    .如果结束
    时间窗口_组件 (编辑框)
.如果真结束



.子程序 _时间窗口时钟_周期事件, 空白型, , 
.如果真 (等于 (是否已创建 (), 假))
    销毁 ()
.如果真结束


.子程序 _时间高级表格_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

_时间窗口_字符输入 (字符代码)

.子程序 _时间高级表格_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

_时间窗口_按下某键 (键代码, 功能键状态)

.子程序 _时间高级表格_被单击, 空白型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 

.局部变量 替换文本, 文本型, , , 
.局部变量 时间文本, 文本型, , , 
.局部变量 选择位置, 整数型, , , 

赋值 (时间文本, 未知支持库函数_3 ().未知支持库函数_10 (未知支持库函数_4 ()))
.如果真 (不等于 (时间文本, “”))
     ' 时间文本 ＝ 编辑框.内容
    赋值 (.内容)
    .判断开始 (并且 (大于 (.起始选择位置, 10), 小于 (.起始选择位置, 14)))
        赋值 (1)
        赋值 (相加 (取文本左边 (11), , 取文本右边 (相减 (取文本长度 (), 13))))
    .判断 (并且 (大于 (.起始选择位置, 13), 小于 (.起始选择位置, 17)))
        赋值 (2)
        赋值 (相加 (取文本左边 (14), , 取文本右边 (相减 (取文本长度 (), 16))))
    .判断 (并且 (大于 (.起始选择位置, 16), 小于 (.起始选择位置, 20)))
        赋值 (3)
        赋值 (相加 (取文本左边 (17), , 取文本右边 (相减 (取文本长度 (), 19))))
    .默认
        
    .判断结束
    赋值 (.内容, )
    .判断开始 (等于 (1))
        赋值 (.起始选择位置, 11)
    .判断 (等于 (2))
        赋值 (.起始选择位置, 14)
    .判断 (等于 (3))
        赋值 (.起始选择位置, 17)
    .默认
        
    .判断结束
    
.如果真结束
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 替换文本, 文本型, , , 

赋值 (.内容)
赋值 (替换文本, 相加 (取文本左边 (替换文本, 11), “00:00:00”, 取文本右边 (替换文本, 相减 (取文本长度 (替换文本), 19))))
赋值 (.内容, )
销毁 ()

.子程序 _按钮2_被单击, 空白型, , 
.局部变量 替换文本, 文本型, , , 

赋值 (.内容)
赋值 (替换文本, 相加 (取文本左边 (替换文本, 11), “23:59:59”, 取文本右边 (替换文本, 相减 (取文本长度 (替换文本), 19))))
赋值 (编辑框.内容, 替换文本)
销毁 ()


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 高精度等待, 空白型, , 
.参数 微秒, 整数型, , 1000微秒 = 1毫秒 ； 1000毫秒 = 1秒




 ' 不属于任何一个程序集、类模块的函数：
