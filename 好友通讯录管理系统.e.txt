 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 529
    高度 = 405
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “好友通讯录管理系统”
    帮助文件名 = “”

窗口 登陆窗口
    左边 = 50
    顶边 = 50
    宽度 = 317
    高度 = 198
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “登陆窗口”
    帮助文件名 = “”

窗口 欢迎窗口
    左边 = 50
    顶边 = 50
    宽度 = 377
    高度 = 222
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “欢迎窗口”
    帮助文件名 = “”

窗口 修改密码窗口
    左边 = 50
    顶边 = 50
    宽度 = 300
    高度 = 211
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “ 修改密码窗口”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于窗口”
    帮助文件名 = “”

窗口 好友资料窗口
    左边 = 50
    顶边 = 50
    宽度 = 658
    高度 = 488
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “好友资料窗口”
    帮助文件名 = “”



.常量 当前版本, "“V 1.0”", , 
.常量 db1, "“db1”", , 
.常量 , , , 
.常量 常量2, "", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 5 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 6 扩展界面支持库一
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 2 6 扩展界面支持库三
 ' eDB 46E94341933A462383A4DE26B146322C 1 6 数据库操作支持库




.全局变量 姓名, 文本型, , , 
.全局变量 性别, 文本型, , , 
.全局变量 生日, 文本型, , , 
.全局变量 电话, 文本型, , , 
.全局变量 学历, 文本型, , , 
.全局变量 手机, 文本型, , , 
.全局变量 毕业院校, 文本型, , , 
.全局变量 工作单位, 文本型, , , 
.全局变量 家庭地址, 文本型, , , 
.全局变量 好友靓照, 字节集, , , 
.全局变量 循环数, 整数型, , , 
.全局变量 记录集句柄, 整数型, , , 

.窗口程序集 启动窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
载入 (欢迎窗口, _启动窗口, 真)
赋值 (.宽度, 取屏幕宽度 ())
赋值 (.高度, 取屏幕高度 ())
赋值 (., 相减 (取屏幕高度 (), 110))
赋值 (.左边, 相减 (.左边, .))
赋值 (., 取屏幕宽度 ())


.子程序 _记事本_被选择, 空白型, , 
运行 (“notepad.exe”, 假, )


.子程序 _计算器_被选择, 空白型, , 
 ' 运行 (“calc.exe”, 假, )


.子程序 _小画家_被选择, 空白型, , 
 ' 运行 (“mspaint.exe”, 假, )


.子程序 _纸牌_被选择, 空白型, , 
 ' 运行 (“Solitaire.exe”, 假, )


.子程序 _关于_被选择, 空白型, , 
载入 (关于窗口, _启动窗口, 真)


.子程序 _时钟1_周期事件, 空白型, , 
.如果真 (等于 (.标记, “_启动窗口”))
    _启动窗口.置文本 (., 0, 到文本 (取现行时间 ()))
.如果真结束
0.置文本 (相加 (“当前时间：”, 到文本 (取现行时间 ())))


.子程序 _重新登陆_被选择, 空白型, , 
赋值 (登陆窗口., “登录窗口”)
.如果真 (等于 (是否已创建 (登陆窗口), 假))
    载入 (登陆窗口, , 真)
    
.如果真结束


.子程序 _修改密码_被选择, 空白型, , 
 ' 载入 (修改密码窗口, _启动窗口, 真)


.子程序 _好友资料_被选择, 空白型, , 
载入 (好友资料窗口, _启动窗口, 真)


.子程序 _卷帘式菜单1_项目被选择, 空白型, , 
.参数 菜单索引, 整数型, , 
.参数 项目索引, 整数型, , 

.如果真 (等于 (菜单索引, 0))
    .如果真 (等于 (项目索引, 0))
        _好友资料_被选择 ()
        
    .如果真结束
    .如果真 (等于 (项目索引, 1))
        _退出系统_被选择 ()
    .如果真结束
    
.如果真结束
.如果真 (等于 (菜单索引, 1))
    .如果真 (等于 (项目索引, 0))
        _记事本_被选择 ()
    .如果真结束
    .如果真 (等于 (项目索引, 1))
        _计算器_被选择 ()
    .如果真结束
    .如果真 (等于 (项目索引, 2))
        _小画家_被选择 ()
    .如果真结束
    
.如果真结束
.如果真 (等于 (菜单索引, 2))
    .如果真 (等于 (项目索引, 0))
        _重新登陆_被选择 ()
    .如果真结束
    .如果真 (等于 (项目索引, 1))
        _修改密码_被选择 ()
    .如果真结束
    
.如果真结束
.如果真 (等于 (菜单索引, 3))
    .如果真 (等于 (项目索引, 0))
        _关于_被选择 ()
        
    .如果真结束
    
.如果真结束


.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.如果真 (等于 (按钮索引, 0))
    _好友资料_被选择 ()
    
.如果真结束
.如果真 (等于 (按钮索引, 1))
    _重新登陆_被选择 ()
    
.如果真结束
.如果真 (等于 (按钮索引, 2))
    _修改密码_被选择 ()
    
.如果真结束
.如果真 (等于 (按钮索引, 3))
    _计算器_被选择 ()
    
.如果真结束
.如果真 (等于 (按钮索引, 4))
    _退出系统_被选择 ()
    
.如果真结束


.子程序 _退出系统_被选择, 空白型, , 
结束 ()


.窗口程序集 登陆窗口程序集, , , 

.子程序 _登陆窗口_创建完毕, 空白型, , 
赋值 (.标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 到文本 (取月份 (取现行时间 ())), “月”, 到文本 (取日 (取现行时间 ())), “日”))


.子程序 _登陆窗口_可否被关闭, 逻辑型, , 
结束 ()


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 用户名, 文本型, , , 
.局部变量 密码, 文本型, , , 

相加 (取运行目录 (), “\db1.mdb”).未知支持库函数_1 (“”)
.未知支持库函数_12 ()
“修改密码”.未知支持库函数_14 (#)
“用户名”.未知支持库函数_26 (用户名)
“密码”.未知支持库函数_26 (密码)
.如果真 (等于 (.内容, 用户名))
    .如果 (等于 (.内容, 密码))
        登陆窗口.销毁 ()
        返回 ()
    .否则
        信息框 (“密码输入错误，请重新输入！”, 0, )
        获取焦点 ()
        赋值 (.内容, “”)
        返回 ()
    .如果结束
    
.如果真结束
信息框 (“用户名输入错误，请重新输入！”, 0, )
获取焦点 ()
赋值 (.内容, “”)
返回 ()



.子程序 _按钮2_被单击, 空白型, , 
结束 ()


.子程序 _登录用户编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _按钮1_被单击 ()
    
.如果真结束


.子程序 _登录密码编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _按钮1_被单击 ()
    
.如果真结束



.窗口程序集 欢迎窗口程序集, , , 

.程序集变量 等待, 整数型, , , 
.子程序 _欢迎窗口_创建完毕, 空白型, , 
赋值 (.时钟周期, 100)


.子程序 _时钟1_周期事件, 空白型, , 
.判断开始 (等于 (.内容, “■ □ □ □ □”))
    赋值 (.内容, “□ ■ □ □ □”)
.判断 (等于 (.内容, “□ ■ □ □ □”))
    赋值 (.内容, “□ □ ■ □ □”)
.判断 (等于 (.内容, “□ □ ■ □ □”))
    赋值 (.内容, “□ □ □ ■ □”)
.判断 (等于 (.内容, “□ □ □ ■ □”))
    赋值 (.内容, “□ □ □ □ ■”)
.判断 (等于 (.内容, “□ □ □ □ ■”))
    赋值 (.内容, “■ □ □ □ □”)
.默认
    
.判断结束
刷新显示 ()
赋值 (等待, 相加 (等待, 1))
.如果真 (大于或等于 (等待, 15))
    赋值 (.时钟周期, 0)
    欢迎窗口.销毁 ()
    载入 (登陆窗口, _启动窗口, 真)
    
.如果真结束


.子程序 _图片框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 



.窗口程序集 修改密码窗口程序集, , , 

.子程序 _修改密码窗口_创建完毕, 空白型, , 


.子程序 _修改密码窗口_可否被关闭, 逻辑型, , 
销毁 ()


.子程序 _按钮4_被单击, 空白型, , 
销毁 ()


.子程序 _按钮3_被单击, 空白型, , 
.局部变量 用户名, 文本型, , , 
.局部变量 密码, 文本型, , , 

相加 (取运行目录 (), “\db1.mdb”).未知支持库函数_1 (“”)
.未知支持库函数_12 ()
“修改密码”.未知支持库函数_14 (#)
“用户名”.未知支持库函数_26 (用户名)
“密码”.未知支持库函数_26 (密码)
.如果 (不等于 (.内容, 密码))
    信息框 (“输入的旧密码错误！”, 0, )
    获取焦点 ()
    赋值 (.内容, “”)
.否则
    .如果 (等于 (.内容, .内容))
        1.未知支持库函数_19 ()
        未知支持库函数_17 ()
        “用户名”.未知支持库函数_20 (用户名)
        “密码”.未知支持库函数_20 (.内容)
        信息框 (“更改密码成功！”, 0, )
        未知支持库函数_18 ()
         ' 记录集1.刷新显示 ()
        修改密码窗口.销毁 ()
        返回 ()
    .否则
        
    .如果结束
    信息框 (“两次输入的新密码不同！”, 0, )
    获取焦点 ()
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    
.如果结束


.子程序 _分组框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 



.窗口程序集 关于窗口程序集, , , 

.子程序 _关于窗口_可否被关闭, 逻辑型, , 
销毁 ()


.子程序 _关于窗口_创建完毕, 空白型, , 
赋值 (.标题, “本软件是由易语言编写，只能作为学习用，不作为商业用途！”)


.窗口程序集 好友资料窗口程序集, , , 

.子程序 _好友资料窗口_创建完毕, 空白型, , 
赋值 (好友资料窗口., 相加 (好友资料窗口., #当前版本))
.如果真 (相加 (取运行目录 (), “\db1.mdb”).打开MDB数据库 ())
    赋值 (记录集句柄, “select * from 好友资料表 ”.查询 ())
    .如果 (等于 (记录集句柄, 0))
        信息框 (“查询好友资料失败！”, 0, )
    .否则
        记录集句柄.到首记录 ()
        .如果 (等于 (相加 (取运行目录 (), “\db1.mdb”).未知支持库函数_1 (“”), 真))
            .如果 (等于 (.未知支持库函数_12 (), 真))
                “好友资料表”.未知支持库函数_14 (#)
                未知支持库函数_34 ()
                信息框 (“数据库连接成功！”, 0, )
            .否则
                信息框 (“记录集连接失败！”, 0, )
            .如果结束
            返回 ()
        .否则
            
        .如果结束
        
    .如果结束
    
.如果真结束
信息框 (“数据库连接失败！”, 0, )
返回 ()


.子程序 _好友资料窗口_可否被关闭, 逻辑型, , 
销毁 ()


.子程序 _退出_被单击, 空白型, , 
销毁 ()


.子程序 _添加按钮_被单击, 空白型, , 
.如果 (等于 (.标题, “添 加”))
    赋值 (.标题, “保 存”)
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容)
    获取焦点 ()
.否则
    .如果 (等于 (.内容, “”))
        信息框 (“请填写好友的资料！”, 0, “系统提示”)
        获取焦点 ()
    .否则
        “姓名”.未知支持库函数_26 (姓名)
        “性别”.未知支持库函数_26 (性别)
        “生日”.未知支持库函数_26 (生日)
        “电话”.未知支持库函数_26 (电话)
        “学历”.未知支持库函数_26 (学历)
        “手机”.未知支持库函数_26 (手机)
        “毕业院校”.未知支持库函数_26 (毕业院校)
        “工作单位”.未知支持库函数_26 (工作单位)
        “家庭地址”.未知支持库函数_26 (家庭地址)
        “好友靓照”.未知支持库函数_50 (好友靓照)
        未知支持库函数_17 ()
        “姓名”.未知支持库函数_20 (.内容)
        “性别”.未知支持库函数_20 (.取项目文本 (.现行选中项))
        “生日”.未知支持库函数_20 (时间到文本 (.今天, 2))
        “电话”.未知支持库函数_20 (.内容)
        “学历”.未知支持库函数_20 (.取项目文本 (.现行选中项))
        “手机”.未知支持库函数_20 (.内容)
        “毕业院校”.未知支持库函数_20 (.内容)
        “工作单位”.未知支持库函数_20 (.内容)
        “家庭地址”.未知支持库函数_20 (.内容)
        “好友靓照”.未知支持库函数_49 (.图片)
         ' 添加好友资料到超级列表框 ()  ' ////这个据只时删除失败。
        信息框 (“好友资料保存成功！”, 0, “系统提示：”)
        未知支持库函数_18 ()
        刷新显示 ()
        赋值 (.标题, “添 加”)
    .如果结束
    
.如果结束


.子程序 添加好友资料到超级列表框, 空白型, , 
全部删除 ()
未知支持库函数_34 ()
.计次循环首 (., )
    “姓名”.未知支持库函数_26 (姓名)
    “性别”.未知支持库函数_26 (性别)
    “生日”.未知支持库函数_26 (生日)
    “电话”.未知支持库函数_26 (电话)
    “学历”.未知支持库函数_26 (学历)
    “手机”.未知支持库函数_26 (手机)
    “毕业院校”.未知支持库函数_26 (毕业院校)
    “工作单位”.未知支持库函数_26 (工作单位)
    “家庭地址”.未知支持库函数_26 (家庭地址)
    “好友靓照”.未知支持库函数_50 (好友靓照)
    赋值 (循环数, .插入表项 ())
    循环数.置标题 (0, 姓名)
    循环数.置标题 (1, 性别)
    循环数.置标题 (2, 生日)
    循环数.置标题 (3, 电话)
    循环数.置标题 (4, 学历)
    循环数.置标题 (5, 手机)
    循环数.置标题 (6, 毕业院校)
    循环数.置标题 (7, 工作单位)
    循环数.置标题 (8, 家庭地址)
    循环数.置标题 (9, 到文本 (好友靓照))
    未知支持库函数_36 ()
    刷新显示 ()
    
.计次循环尾 ()

.子程序 _删除_被单击, 空白型, , 
.如果真 (不等于 (.内容, “”))
    .如果 (等于 (信息框 (“确定要删除当前好友资料吗？”, 相加 (#是否钮, #询问图标), “询问窗口”), #是钮))
        #.未知支持库函数_19 ()
        连续赋值 (“”, .内容, .内容, .内容, .内容, .内容)
        获取焦点 ()
        未知支持库函数_18 ()
        刷新显示 ()
        刷新显示 ()
        信息框 (“好友资料成功删除！”, 0, )
    .否则
        
    .如果结束
    返回 ()
.如果真结束
信息框 (“没有好友资料要删除！”, 0, “系统提示”)

.子程序 _查找_被单击, 空白型, , 没有写完
.如果真 (不等于 (.内容, “”))
    “姓名”.未知支持库函数_45 (#)
    “姓名”.未知支持库函数_26 (姓名)
    
    未知支持库函数_17 ()
    “姓名”.未知支持库函数_20 (.内容)
    返回 ()
    
.如果真结束
信息框 (“请输入你要查找的好友名字！”, 0, )


.子程序 _显示记录按钮_被单击, 空白型, , 
全部删除 ()
未知支持库函数_34 ()
.计次循环首 (., )
    “姓名”.未知支持库函数_26 (姓名)
    “性别”.未知支持库函数_26 (性别)
    “生日”.未知支持库函数_26 (生日)
    “电话”.未知支持库函数_26 (电话)
    “学历”.未知支持库函数_26 (学历)
    “手机”.未知支持库函数_26 (手机)
    “毕业院校”.未知支持库函数_26 (毕业院校)
    “工作单位”.未知支持库函数_26 (工作单位)
    “家庭地址”.未知支持库函数_26 (家庭地址)
    “好友靓照”.未知支持库函数_50 (好友靓照)
    赋值 (循环数, .插入表项 ())
    循环数.置标题 (0, 姓名)
    循环数.置标题 (1, 性别)
    循环数.置标题 (2, 生日)
    循环数.置标题 (3, 电话)
    循环数.置标题 (4, 学历)
    循环数.置标题 (5, 手机)
    循环数.置标题 (6, 毕业院校)
    循环数.置标题 (7, 工作单位)
    循环数.置标题 (8, 家庭地址)
    循环数.置标题 (9, 到文本 (好友靓照))
    未知支持库函数_36 ()
.计次循环尾 ()
基本资料区显示好友资料 ()

.子程序 基本资料区显示好友资料, 空白型, , 
 ' 姓名编辑框.内容 ＝ 姓名
赋值 (.内容, 到文本 (记录集句柄.读 (2)))
赋值 (.内容, 到文本 (记录集句柄.读 (3)))
赋值 (.今天, 到时间 (记录集句柄.读 (4)))
赋值 (.内容, 到文本 (记录集句柄.读 (5)))
赋值 (.内容, 到文本 (记录集句柄.读 (6)))
赋值 (.内容, 到文本 (记录集句柄.读 (7)))
赋值 (.内容, 到文本 (记录集句柄.读 (8)))
赋值 (.内容, 到文本 (记录集句柄.读 (9)))
赋值 (.内容, 到文本 (记录集句柄.读 (10)))
赋值 (.图片, 到字节集 (记录集句柄.读 (11)))

.子程序 _向前_被单击, 空白型, , odbc
记录集句柄.到前一记录 ()
.如果 (记录集句柄.首记录前 ())
    信息框 (“前面已无记录”, 0, )
    记录集句柄.到首记录 ()
.否则
    基本资料区显示好友资料 ()
    
    
.如果结束


.子程序 _向后_被单击, 空白型, , odbc
记录集句柄.到后一记录 ()
.如果 (记录集句柄.尾记录后 ())
    信息框 (“后面以无记录”, 0, )
    记录集句柄.到尾记录 ()
.否则
    基本资料区显示好友资料 ()
    
    
.如果结束


.子程序 _到首记录_被单击, 空白型, , odbc
记录集句柄.到首记录 ()
基本资料区显示好友资料 ()


.子程序 _到尾记录_被单击, 空白型, , odbc
记录集句柄.到尾记录 ()
基本资料区显示好友资料 ()


.子程序 _载入靓照按钮_被单击, 空白型, , 
打开 ()
赋值 (.图片, 读入文件 (.文件名))



 ' 不属于任何一个程序集、类模块的函数：
