 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 监视窗口
    左边 = 50
    顶边 = 50
    宽度 = 535
    高度 = 403
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假



.常量 INFINITE, "-1", , 
.常量 WAIT_OBJECT_0, "0", , 
.常量 WAIT_ABANDONED, "128", , 
.常量 WAIT_IO_COMPLETION, "192", , 
.常量 WAIT_TIMEOUT, "258", , 
.常量 STATUS_PENDING, "259", , 
.常量 FILE_NOTIFY_CHANGE_FILE_NAME, "1", , 
.常量 FILE_NOTIFY_CHANGE_DIR_NAME, "2", , 
.常量 FILE_NOTIFY_CHANGE_ATTRIBUTES, "4", , 
.常量 FILE_NOTIFY_CHANGE_SIZE, "8", , 
.常量 FILE_NOTIFY_CHANGE_LAST_WRITE, "16", , 
.常量 FILE_NOTIFY_CHANGE_LAST_ACCESS, "32", , 
.常量 FILE_NOTIFY_CHANGE_CREATION, "64", , 
.常量 FILE_NOTIFY_CHANGE_SECURITY, "256", , 
.常量 FILE_NOTIFY_FLAGS, "21", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库





.DLL命令 监视对象改变信息, 整数型, "kernel32.dll", "FindFirstChangeNotificationA", , 
    .参数 目录名, 文本型, , 
    .参数 子目录, 整数型, , 
    .参数 过滤, 整数型, , 

.DLL命令 关闭监视信息对象, 整数型, "kernel32.dll", "FindCloseChangeNotification", , 
    .参数 句柄, 整数型, , 

.DLL命令 监视下一个改变信息, 整数型, "kernel32.dll", "FindNextChangeNotification", , 
    .参数 句柄, 整数型, , 

.DLL命令 设置反应属性, 整数型, "kernel32.dll", "WaitForSingleObject", , 
    .参数 句柄, 整数型, , 
    .参数 时间, 整数型, , 

.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 本子程序在程序启动后最先执行
载入 (监视窗口, , 假)
返回 (0) ' 可以根据您的需要返回任意数值

.窗口程序集 窗口程序集1, , , 

.程序集变量 监视句柄, 整数型, , , 
.程序集变量 监视, 整数型, , , 
.程序集变量 标志, 逻辑型, , , 
.子程序 _开始按钮_被单击, 空白型, , 
.局部变量 监视目录, 文本型, , , 
.局部变量 监视状态, 整数型, , , 
.局部变量 临时数, 整数型, , , 

赋值 (监视目录, “c:\bat”)
.如果真 (等于 (寻找文件 (监视目录, #子目录), “”))
    创建目录 (监视目录)
.如果真结束

.如果 (不等于 (寻找文件 (监视目录, #子目录), “”))
    赋值 (假)
    赋值 (., 真)
    赋值 (., 相加 (“开始监测”, , “，你可以到目录下面测试txt类文件”))
    
    监视动作 (监视目录)
    赋值 (监视句柄, 创建监视对象 (监视目录, #FILE_NOTIFY_FLAGS))
    赋值 (监视状态, 监视目录 (监视句柄, 100))
    .如果 (等于 (监视状态, 0))
        监视动作 (监视目录)
        赋值 (., “监视目录已经改变..”)
        
        .循环判断首 ()
            赋值 (监视状态, 监视目录 (监视句柄, 100))
            .如果 (等于 (监视状态, -1))
                赋值 (., 相加 (“监视有信息改变..”, 监视目录))
            .否则
                监视动作 (监视目录)
                赋值 (., “监视目录已经改变..”)
            .如果结束
            处理事件 ()
        .循环判断尾 (等于 (监视状态, 0))
    .否则
        赋值 (., 相加 (“监视有信息改变..”, 监视目录))
    .如果结束
    
.否则
    信息框 (“没有改文件目录存在!!”, 0, )
.如果结束


.子程序 创建监视对象, 整数型, , 
.参数 路径, 文本型, , 
.参数 标识, 整数型, , 

返回 (监视对象改变信息 (路径, 0, 标识))

.子程序 撤消监视对象, 空白型, , 
.参数 句柄, 整数型, , 

.局部变量 临时数, 整数型, , , 

赋值 (标志, 真)

赋值 (临时数, 关闭监视信息对象 (句柄))

.子程序 监视目录, 整数型, , 
.参数 句柄, 整数型, , 
.参数 时间, 整数型, , 

.局部变量 临时, 整数型, , , 

.循环判断首 ()
    赋值 (临时, 设置反应属性 (句柄, 时间))
    处理事件 ()
.循环判断尾 (并且 (不等于 (临时, 0), 等于 (标志, 假)))
返回 (临时)

.子程序 监视更改, 整数型, , 
.参数 句柄, 整数型, , 
.参数 时间, 整数型, , 

.局部变量 临时, 整数型, , , 

赋值 (临时, 监视下一个改变信息 (句柄))
.循环判断首 ()
    赋值 (未知函数_167837788 ())
    处理事件 ()
.循环判断尾 (并且 (不等于 (0), 等于 (假)))
返回 ()


.子程序 监视动作, 空白型, , 
.参数 路径, 文本型, , 

.局部变量 名字, 文本型, , , 

赋值 (., “”)
赋值 (名字, 寻找文件 (相加 (路径, “\*.txt”), ))
.如果真 (不等于 (名字, “”))
    相加 (“路径 :”, 路径).加入文本 ()
    相加 (“名字:”, 名字).加入文本 ()
    相加 (“大小:”, 到文本 (取文件尺寸 (相加 (路径, “\”, 名字)))).加入文本 ()
    相加 (“属性:”, 取属性 (取文件属性 (相加 (路径, “\”, 名字)))).加入文本 ()
.如果真结束


.子程序 取属性, 文本型, , 
.参数 临时, 整数型, , 

.判断开始 (等于 (临时, 1))
    返回 (“只读文件”)
.判断 (等于 (临时, 2))
    返回 (“隐藏文件”)
.判断 (等于 (临时, 4))
    返回 (“系统文件”)
.判断 (等于 (临时, 16))
    返回 (“子目录”)
.判断 (等于 (临时, 32))
    返回 (“存档文件”)
.默认
    
.判断结束
返回 (“未知”)

.子程序 _停止按钮_被单击, 空白型, , 
撤消监视对象 (监视句柄)
赋值 (监视句柄, 0)
赋值 (., 假)

.子程序 _退出按钮_被单击, 空白型, , 
.如果真 (大于 (监视句柄, 0))
    撤消监视对象 (监视句柄)
.如果真结束
结束 ()


 ' 不属于任何一个程序集、类模块的函数：
