 ' 文件类型：Windows窗口程序

 ' 程序名称：好友录（全面操作EDB）
 ' 程序描述：一个学习易语言数据库操作的例程
 ' 程序作者：葛大强
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：大强QQ：391545711
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口

XTTTTTT[┏─┓┏──────────────────────────────┓┏─┓
U┌→例程源码U│大││代码写人生，行行彰显作者心性；网络看世相，处处演绎红尘烟云。││大│
U大XTTTTa│强│┣──────────────────────────────┫│强│
U强U　　　　　│学││⒈学习重基础，多看帮助，多看支持库说明　　　　　　　　　　　││源│
U学^TTT[　│易││⒉从基本的流程控制、变量操作入手，多写基础例程　　　　　　　││码│
U易→零基础U　│之││⒊脚踏实地，从自己能做的地方开始　　　　　　　　　　　　　　││特│
U程XTTTa　│基││⒋遇着问题，可以先放一放，把其他地方弄好，再回头解决问题　　││别│
U序U　　　　　│础││⒌没人能帮你学习，只有自己。学或不学，都在于自己。　　　　　││整│
U集^TTTT[│例││⒍邮箱：daqiangclub@163.com 　　　　　　　　　　　　　　　　││理│
U└→详细注释U│程││⒎留言：http://hi.baidu.com/%B4%F3%C7%BF%B9%A4%D7%F7%CA%D2　││版│
^TTTTTTa┗─┛┗──────────────────────────────┛┗─┛

    左边 = 50
    顶边 = 50
    宽度 = 600
    高度 = 450
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “好友录(全面操作EDB例程)”
    帮助文件名 = “”

窗口 窗口分类管理
    左边 = 50
    顶边 = 50
    宽度 = 250
    高度 = 300
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “分类管理”
    帮助文件名 = “”



.图片 空相片, " ' 已保存到：D:\易语言学习\Data\好友录(EDB).e\空相片", , 未有相片时的图片
.图片 大强相片, " ' 已保存到：D:\易语言学习\Data\好友录(EDB).e\大强相片", , 
.常量 字段1, "“类别”", , 好友的分类
.常量 字段2, "“姓名”", , 好友姓名
.常量 字段3, "“性别”", , 好友性别
.常量 字段4, "“生日”", , 好友生日
.常量 字段5, "“地址”", , 好友地址
.常量 字段6, "“备注”", , 好友说明
.常量 字段7, "“相片”", , 好友相片
.常量 分类库, "“分类库”", , 存放好友分类的数据库
.常量 好友库, "“好友库”", , 存放好友资料的数据库
.常量 备注说明, "“　　易语言数据库操作快捷方便。查询、增删、修改记录也特别好用。美中不足的是，易语言数据库只支持一个表。如果数据较多，不可以放在一张表里，用易语言数据库就显得烦琐了。即便如此，在一些地方还是用易库好些。因为数据库可以加密，到目前为止还没有针对易库密码的破解之法，这就增加了数据的保密性。

易语言数据库简要说明

一、易语言数据库文件的组成

　　.edb　数据库主文件
　　.edt　数据库辅助数据文件，仅在数据库中存在备注型或者字节集型字段时才存在，文件名称除了后缀外与数据库主文件相同，它必须与.edb文件放在同一目录中。
　　.enx　数据库索引文件。使用 B+ 树结构，由用户根据需要自行创建，用作加快记录的查找速度。

二、数据库的内部结构

　　易语言数据库由行和列组成，其中每一行被称为一条记录，每一列称为一个字段。
　　字段具有“名称”、“类型”、“最大文本长度”三个属性，有关介绍如下：
　　<1>、名称： 字段名称文本的长度必须在 16 个字符以内；(一个英文字母为一个字符长度，一个中文为两个字符长度)
　　<2>、类型： 可以为以下常量值之一： 1、#字节型； 2、#短整数型； 3、#整数型； 4、#长整数型； 5、#小数型； 6、#双精度小数型； 7、#逻辑型； 8、#日期时间型； 10、#文本型； 11、#字节集型； 12、#备注型；
　　<3>、最大文本长度： 此属性仅当字段类型为“文本型”时才有效，用作指定文本的最大可能长度，其值范围必须在 1 到 512 之间。如果字段类型不为“文本型”，本属性无效。当写入数据到数据库中的文本型字段内时，多出的部分将被自动剪切。

三、系统中的“数据库”菜单功能

　　可以使用“数据库”菜单下的“结构编辑器”来创建一个指定结构的数据库或者修改一个已存在数据库的现有结构。然后，使用“记录编辑器”可以加入或修改初始记录数据。
　　值得告诉大家的是：这两个菜单功能皆通过调用 dbmanger.exe 文件（由 数据库管理器.e 易程序生成）来完成，数据库管理器.e 源程序已经随易语言系统一起提供，用户可以对其进行修改或者扩充，使之更能满足您的需要。

”", , 关于数据库的一些说明


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库





.窗口程序集 窗口程序集1, , , 

.程序集变量 好友ID, 整数型, , "0", 
.程序集变量 现行好友, 整数型, , , 
.程序集变量 分类目录, 文本型, , , 
.程序集变量 好友目录, 文本型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 程序启动时首先要进行的一些初始化操作
.局部变量 分类库字段, 字段信息, , "1", 好友分类数据库
.局部变量 好友库字段, 字段信息, , "7", 好友资料数据库
.局部变量 字段号, 整数型, , , 

 ' XTTTTTT[┏─┓┏──────────────────────────────┓┏─┓
 ' U┌→例程源码U│大││代码写人生，行行彰显作者心性；网络看世相，处处演绎红尘烟云。││大│
 ' U大XTTTTa│强│┣──────────────────────────────┫│强│
 ' U强U          │学││⒈学习重基础，多看帮助，多看支持库说明                      ││源│
 ' U学^TTT[  │易││⒉从基本的流程控制、变量操作入手，多写基础例程              ││码│
 ' U易→零基础U  │之││⒊脚踏实地，从自己能做的地方开始                            ││特│
 ' U程XTTTa  │基││⒋遇着问题，可以先放一放，把其他地方弄好，再回头解决问题    ││别│
 ' U序U          │础││⒌没人能帮你学习，只有自己。学或不学，都在于自己。          ││整│
 ' U集^TTTT[│例││⒍邮箱：daqiangclub@163.com                                 ││理│
 ' U└→详细注释U│程││⒎留言：http://hi.baidu.com/%B4%F3%C7%BF%B9%A4%D7%F7%CA%D2  ││版│
 ' ^TTTTTTa┗─┛┗──────────────────────────────┛┗─┛

 ' 数据库文件路径
赋值 (分类目录, 相加 (取运行目录 (), “\fenlei.edb”)) ' 分类库目录
赋值 (好友目录, 相加 (取运行目录 (), “\data.edb”)) ' 好友库目录

 ' 以下是数据库的结构，朋友们可以用自己建立数据库
 ' 库名:fenlei.edb   这是好友分类数据库的文件名
 ' 字段:类别,文本型,8   类别名称，可以用4个汉字或者8个字母
 ' 库名:data.edb   这是好友资料数据库的文件名
 ' 字段:类别,文本型,8     类别名称，与分类数据库中的类别一致
 ' 字段:姓名,文本型,20    好友姓名，最多10个汉字
 ' 字段:性别,文本型,2     好友性别，“男”或者“女”
 ' 字段:生日,日期时间型    好友生日，日期时间型，只取日期部分
 ' 字段:地址,文本型,512    好友地址，最多允许256个汉字
 ' 字段:备注,备注型     好友备注，备注型字段，可放置文本型数据，文本无长度限制
 ' 字段:相片,字节集型   这里放置好友相片。如果需要，可以放置任何数据。
 ' 以上是数据库说明

事件转移 () ' 备用按钮，可以根据自己的需要设置新功能。设置后，本句要删除。

.如果真 (或者 (取反 (文件是否存在 (分类目录)), 取反 (文件是否存在 (好友目录)), 取反 (文件是否存在 (相加 (取运行目录 (), “\data.edt”))))) ' 本行判断数据库文件是否存在。如果不存在就重新建立数据库。
     ' EDT文件是易库存放备注及字节集型字段信息的专属文件，如果损坏，数据库将无法正常使用，所以也必须检查是否存在
     ' 字段信息设置
    .计次循环首 (7, 字段号) ' 对字段名称赋值
        赋值 (好友库字段 [字段号], , 多项选择 (字段号, #字段1, #字段2, #字段3, #字段4, #字段5, #字段6, #字段7)) ' 把字段名称设置为常量，方便以后的操作。这里用一个循环就可以对所有字段赋值。
    .计次循环尾 ()
     ' 对字段类型赋值
    连续赋值 (#文本型, 好友库字段 [1]., 好友库字段 [2]., 好友库字段 [3]., 好友库字段 [5].)
    赋值 (好友库字段 [4]., #日期时间型)
    赋值 (好友库字段 [6]., #备注型)
    赋值 (好友库字段 [7]., #字节集型)
     ' 文本型字段要设置最大文本长度
    赋值 (好友库字段 [1]., 8)
    赋值 (好友库字段 [2]., 20)
    赋值 (好友库字段 [3]., 2)
    赋值 (好友库字段 [5]., 512)
     ' 对分类库的字段赋值
    赋值 (分类库字段 [1], 好友库字段 [1])
     ' 定义字段信息
     ' 建立数据库
    创建 (分类目录, 分类库字段) ' 此库存放好友分类
    创建 (好友目录, 好友库字段) ' 此库存放好友资料
     ' 以上是建立新数据库
     ' 写入作者资料信息
     ' 以下是重建数据库之后，首先加入作者资料
    打开 (分类目录, #分类库, , , , , )
    加记录 (“软件作者”) ' 在分类库中加入一个类别
    置数据库密码 (“123456”) ' 设置数据库密码
    替换打开 (好友目录, #好友库, , , , , ) ' 打开好友库
    加记录 (“软件作者”, “葛大强”, “男”, , “代码写人生，行行彰显作者心性；网络看世相，处处演绎红尘烟云。做真实自己，于人于己都无愧。”, #备注说明, #大强相片) ' 在好友资料库中写入大强的资料。
    置数据库密码 (“123456”) ' 设置数据库密码
    关闭 () ' 关闭数据库
.如果真结束
 ' 打开数据库
打开 (分类目录, #分类库, , , , “123456”, )
打开 (好友目录, #好友库, , , , “123456”, )
禁止编辑 ()
读好友类别 () ' 这是自定义的子程序，从数据库中读取好友的类别。


.子程序 _按钮添加好友_被单击, 空白型, , 添加好友资料
.如果真 (小于或等于 (取项目数 (), 1)) ' 判断是否有类别。如果没有，则打开类别管理功能，以添加类别
    _按钮分类管理_被单击 () ' 对好友类别进行管理的子程序
    返回 () ' 没有好友分类，则退出添加好友的功能
.如果真结束
.如果 (等于 (., “添加好友”)) ' 判断“添加好友”按钮的状态
    允许编辑 () ' 对好友各项资料解除禁止
    赋值 (., “保存资料”) ' 更改按钮的标题
    赋值 (., “0”) ' 由于添加新好友，不能对其他好友进行修改和删除，所以设置调节器的标记，以使修改、删除的功能失效
    清空资料 () ' 把资料清空，以填写新资料
    赋值 (现行好友, 0) ' 由于添加新好友，不能对其他好友进行修改和删除，所以设置现行好友为0，以使修改、删除的功能失效
    赋值 (., 真) ' 禁止修改
    赋值 (., 真) ' 禁止管理分类
    赋值 (., 真) ' 禁止删除
    赋值 (., 真) ' 由于是新好友，没有相片可以导出，禁止导出相片
.否则
     ' 字段:类别,文本型,8
     ' 字段:姓名,文本型,20
     ' 字段:性别,文本型,2
     ' 字段:生日,日期时间型
     ' 字段:地址,文本型,512
     ' 字段:备注,备注型
     ' 字段:相片,字节集型
     ' 以上是好友的资料项目
    .如果真 (取反 (资料是否完整 ())) ' 判断是否完成了资料的填写
        返回 () ' 未填写完整的资料，则返回，重新填写
    .如果真结束
    .如果 (加记录 (.取项目文本 (.), ., .取项目文本 (.), 取日期 (.), ., ., .)) ' 添加记录。注意，记录的每一项内容与字段的类型一定要相对应，否则就会出错。
        信息框 (相加 (“添加好友成功”, “　　”), 64, “成功”) ' 添加成功
    .否则
        信息框 (相加 (“添加好友失败”, “　　”), 48, “失败”) ' 添加失败
    .如果结束
    赋值 (., “添加好友”) ' 还原按钮标题
    赋值 (., 假) ' 解除按钮禁止状态
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    禁止编辑 () ' 禁止编辑资料
    读好友类别 () ' 读取好友分类
.如果结束


.子程序 资料是否完整, 逻辑型, , 验证好友资料是否完整
.局部变量 文本资料, 编辑框, , , 
.局部变量 NN, 整数型, , , 

.计次循环首 (3, NN) ' 检测姓名、地址、备注是否填写
    赋值 (文本资料, 取标记组件 (相加 (NN, 99990)))
    .如果真 (等于 (删全部空 (文本资料.), “”))
        赋值 (文本资料., -1)
        文本资料.获取焦点 ()
        信息框 (相加 (“请填写”, 取文本右边 (取组件名称 (文本资料), 4), “　　”), 48, “注意”)
        返回 (假)
    .如果真结束
    
.计次循环尾 ()
.判断开始 (大于或等于 (取时间间隔 (., 取现行时间 (), 1), 0)) ' 判断是否选择了好友生日
    信息框 (相加 (“请选择好友生日”, “　　”), 48, “注意”)
    获取焦点 ()
.判断 (等于 (., 0)) ' 判断是否选择了好友分类
    信息框 (相加 (“请选择好友类别”, “　　”), 48, “注意”)
    获取焦点 ()
.判断 (等于 (., 0)) ' 判断是否选择了性别
    信息框 (相加 (“请选择好友性别”, “　　”), 48, “注意”)
    获取焦点 ()
.默认
    返回 (真)
.判断结束
返回 (假)


.子程序 _按钮修改资料_被单击, 空白型, , 修改好友资料
.如果真 (等于 (现行好友, 0)) ' 判断是否有好友资料
    信息框 (相加 (“没有可修改的好友”, “　　”), 48, “注意”)
    返回 ()
.如果真结束
.如果 (等于 (., “修改资料”)) ' 改变按钮标题
    赋值 (., “保存资料”)
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., 真)
    允许编辑 ()
    读 (1).选择 () ' 选择好友原来所在的分类
.否则
     ' 字段:类别,文本型,8
     ' 字段:姓名,文本型,20
     ' 字段:性别,文本型,2
     ' 字段:生日,日期时间型
     ' 字段:地址,文本型,255
     ' 字段:备注,备注型
     ' 字段:相片,字节集型
     ' 以上是好友资料的项目
    .如果真 (取反 (资料是否完整 ())) ' 判断是否完成了资料的填写
        返回 () ' 未填写完整的资料，则返回，重新填写
    .如果真结束
    .如果 (修改 (.取项目文本 (.), ., .取项目文本 (.), 取日期 (.), ., ., .)) ' 修改记录。
        信息框 (相加 (“修改好友成功”, “　　”), 64, “成功”) ' 修改成功
    .否则
        信息框 (相加 (“修改好友失败”, “　　”), 48, “失败”) ' 修改失败
    .如果结束
    赋值 (., “修改资料”) ' 还原按钮标题
    赋值 (., 假) ' 还原按钮状态
    赋值 (., 假)
    赋值 (., 假)
    禁止编辑 () ' 还原资料编辑状态
.如果结束


.子程序 _按钮删除好友_被单击, 空白型, , 删除好友资料
.如果真 (等于 (现行好友, 0)) ' 判断是否选择了好友
    信息框 (相加 (“没有可删除的好友”, “　　”), 48, “注意”)
    返回 ()
.如果真结束
删除 ()
.如果 (等于 (信息框 (相加 (“删除好友，该好友的资料将全部被删除。”, #换行符, “真要删除吗？”), 36, “确定吗？”), 5)) ' 确认删除好友
    彻底删除 ()
    赋值 (., “0”) ' 删除后，没有选择好友
    读好友类别 () ' 重新读取好友资料
.否则
    恢复删除 ()
.如果结束


.子程序 _按钮更改相片_被单击, 空白型, , 更新好友相片
.如果真 (并且 (不等于 (., “保存资料”), 不等于 (., “保存资料”))) ' 判断是否可以更改相片
    信息框 (相加 (“非编辑状态下不可更换相片！”, “　　”), 48, “注意”)
    返回 ()
.如果真结束
赋值 (., 0) ' 打开对话框
赋值 (., “请选择好友相片”)
.如果真 (打开 ()) ' 选择好友相片
    赋值 (., 读入文件 (.)) ' 读入相片
    赋值 (., “”) ' 清除对话框的文件名
.如果真结束


.子程序 _调节器浏览_调节钮被按下, 空白型, , 如果有好友资料存在，可以用来浏览好友资料
.参数 按钮值, 整数型, , 

.如果 (并且 (大于或等于 (到数值 (.), 1), 小于或等于 (到数值 (.), 取数组成员数 (好友ID)))) ' 调节器的标记是否超出了好友记录的范围
    赋值 (., 到文本 (相加 (到数值 (.), 按钮值)))
    .判断开始 (等于 (到数值 (.), 0))
        赋值 (., “1”)
    .判断 (大于 (到数值 (.), 取数组成员数 (好友ID)))
        赋值 (., 到文本 (取数组成员数 (好友ID)))
    .默认
        赋值 (现行好友, 好友ID [到数值 (.)]) ' 把好友在库中的ID放在外形框的标记中，以方便以后调用
        显示好友 () ' 显示好友的资料
    .判断结束
    
.否则
    信息框 (相加 (“对不起，没有好友可以显示。”, “　　”), 48, “注意”)
    赋值 (现行好友, 0)
    清空资料 () ' 没有资料时，清空各个编辑框、还原日期、性别等
    禁止编辑 ()
.如果结束


.子程序 显示好友, 空白型, , 显示指定的好友资料
置当前库 (#好友库)
标签跳转 (现行好友) ' 到好友记录
 ' 字段:类别,文本型,8
赋值 (., 读 (2)) ' 字段:姓名,文本型,20
赋值 (., 相加 (到数值 (取反 (等于 (读 (3), “男”))), 1)) ' 字段:性别,文本型,2
赋值 (., 到时间 (读 (4))) ' 字段:生日,日期时间型
赋值 (., 读 (5)) ' 字段:地址,文本型,512
赋值 (., 读 (6)) ' 字段:备注,备注型
赋值 (., 读 (7)) ' 字段:相片,字节集型
禁止编辑 () ' 禁止编辑资料


.子程序 读好友ID, 空白型, , 读好友记录在库中的ID编号
.参数 类别, 文本型, , 好友的类别，指定查找哪一类别的好友

 ' 字段:类别,文本型,8
置当前库 (#好友库)
重定义数组 (好友ID, 假, 0) ' 重新定义记录好友ID的数组
赋值 (现行好友, 0)
到首记录 ()
 ' 是否指定了类别
.如果 (等于 (类别, “所有好友”)) ' 选择了所有好友，读所有记录
    .如果真 (等于 (取记录数 (), 0))
        信息框 (相加 (“对不起，没有好友记录！”, “　　”), 48, “注意”)
        赋值 (., 真)
        清空资料 ()
        返回 ()
    .如果真结束
    .计次循环首 (取记录数 (), )
        加入成员 (好友ID, 取标签 ()) ' 把好友在记录中的记录号读出来，放在数组中
        跳过 (1)
    .计次循环尾 ()
.否则
     ' 如果选择了某一组，则寻找该组好友
    .如果真 (取反 (查找 (等于 (读 (1), 类别)))) ' 该组好友不存在
        信息框 (相加 (“对不起，没有好友记录！”, “　　”), 48, “注意”)
        赋值 (., 真)
        清空资料 ()
        返回 ()
    .如果真结束
    .循环判断首 () ' 存在则读取编号
        加入成员 (好友ID, 取标签 ()) ' 把好友在记录中的记录号读出来，放在数组中
        跳过 () ' 将当前数据库中当前记录指针向前或者向后移动数条记录。成功返回真，失败返回假。本命令为初级命令。
         ' 参数<1>的名称为“欲跳过的记录数”，类型为“整数型（int）”，可以被省略。参数值如果为负数，则向前移动，否则向后移动。如果本参数被省略，默认值为 1 ，即向后移动一条记录。
    .循环判断尾 (查找 (等于 (读 (1), 类别))) ' 如果还有，则继续读
.如果结束
赋值 (., “1”)
赋值 (., 假)
_调节器浏览_调节钮被按下 (0)


.子程序 读好友类别, 空白型, , 读取好友分类到组合框
.局部变量 记录数, 整数型, , , 

 ' 字段:类别,文本型,8
清空资料 ()
清空 () ' 清空分类
“所有好友”.加入项目 () ' 添加一个“所有好友”的分类，以浏览所有好友
置当前库 (#分类库) ' 查询好友分类
赋值 (记录数, 取记录数 ())
.如果 (大于 (记录数, 0))
    到首记录 ()
    .计次循环首 (记录数, )
        读 (1).加入项目 (取标签 ()) ' 读入类别
        跳过 ()
    .计次循环尾 ()
    赋值 (., 0)
    _组合框分类_列表项被选择 ()
.否则
    信息框 (相加 (“对不起，没有分类记录！”, “　　”, #换行符, “请添加好友分类。”), 48, “注意”) ' 没有好友分类，要求添加
    _按钮分类管理_被单击 () ' 添加分类
.如果结束


.子程序 _组合框分类_列表项被选择, 空白型, , 选择好友分类
.如果 (并且 (等于 (., “添加好友”), 等于 (., “修改资料”))) ' 如果处于非编辑状态，则改变选择好友
    读好友ID (.取项目文本 (.)) ' 重新读取好友编号
.否则
    返回 () ' 如果处于编辑状态，则只改变选择，不对好友的编号读取产生影响。
.如果结束


.子程序 允许编辑, 空白型, , 
连续赋值 (0, ., ., .)
赋值 (., 假)
赋值 (., 真)
赋值 (., 0)


.子程序 禁止编辑, 空白型, , 
连续赋值 (1, ., ., .)
赋值 (., 真)
赋值 (., 假)


.子程序 清空资料, 空白型, , 清空好友资料以便重新输入
连续赋值 (“”, ., ., .)
赋值 (., #空相片)
赋值 (., 取现行时间 ())
赋值 (., 0)


.子程序 _按钮导出相片_被单击, 空白型, , 导出好友相片到文件
.如果真 (等于 (., #空相片))
    信息框 (相加 (“对不起，不可导出空相片”, “　　”), 48, “注意”)
    返回 ()
.如果真结束
赋值 (., 1)
赋值 (., “请选择保存位置”)
.如果真 (打开 ())
    写到文件 (., .)
    赋值 (., “”)
.如果真结束


.子程序 _按钮分类管理_被单击, 空白型, , 管理好友分类
载入 (窗口分类管理, _启动窗口, 真)
读好友类别 ()


.子程序 __启动窗口_可否被关闭, 逻辑型, , 退出程序的处理
.如果真 (等于 (信息框 (“真要退出吗？”, 36, “退出？”), 5)) ' 确定退出
    全部关闭 () ' 关闭数据库
    返回 (真)
.如果真结束
返回 (假)


.子程序 _按钮备用1_被单击, 空白型, , 备用按钮
信息框 (“此按钮没有设置功能。您可以根据需要自己添加。　　”, 64, “系统提示”) ' 提示信息，可以根据自己的需要改成自己的代码。


.窗口程序集 窗口程序集2, , , 

.子程序 _窗口分类管理_创建完毕, 空白型, , 
 ' XTTTTTT[┏─┓┏──────────────────────────────┓┏─┓
 ' U┌→例程源码U│大││代码写人生，行行彰显作者心性；网络看世相，处处演绎红尘烟云。││大│
 ' U大XTTTTa│强│┣──────────────────────────────┫│强│
 ' U强U          │学││⒈学习重基础，多看帮助，多看支持库说明                      ││源│
 ' U学^TTT[  │易││⒉从基本的流程控制、变量操作入手，多写基础例程              ││码│
 ' U易→零基础U  │之││⒊脚踏实地，从自己能做的地方开始                            ││特│
 ' U程XTTTa  │基││⒋遇着问题，可以先放一放，把其他地方弄好，再回头解决问题    ││别│
 ' U序U          │础││⒌没人能帮你学习，只有自己。学或不学，都在于自己。          ││整│
 ' U集^TTTT[│例││⒍邮箱：daqiangclub@163.com                                 ││理│
 ' U└→详细注释U│程││⒎留言：http://hi.baidu.com/%B4%F3%C7%BF%B9%A4%D7%F7%CA%D2  ││版│
 ' ^TTTTTTa┗─┛┗──────────────────────────────┛┗─┛
读好友类别列表 ()


.子程序 读好友类别列表, 空白型, , 读好友类别
.局部变量 SS, 整数型, , , 

置当前库 (#分类库) ' 说明操作的是哪个数据库
赋值 (SS, 取记录数 ())
清空 ()
赋值 (., “”)
赋值 (., “”)
.如果真 (等于 (SS, 0)) ' 是否有记录
    获取焦点 ()
    返回 ()
.如果真结束
到首记录 ()
.计次循环首 (SS, ) ' 读入记录
    读 (1).加入项目 (取标签 ())
    跳过 ()
.计次循环尾 ()


.子程序 _按钮添_被单击, 空白型, , 添加新类别
.局部变量 II, 整数型, , , 

.如果 (或者 (等于 (删全部空 (.), “”), 等于 (., “全部好友”), 等于 (., “所有好友”))) ' 判断输入内容是否合法
    赋值 (., -1)
    获取焦点 ()
.否则
    .计次循环首 (取项目数 (), II) ' 重名处理
        .如果真 (等于 (., 相减 (II, 1).取项目文本 ())) ' 重名
            信息框 (相加 (“对不起，该分类已经存在！”, “　　”), 48, “注意”)
            赋值 (., -1)
            获取焦点 ()
            返回 ()
        .如果真结束
        
    .计次循环尾 ()
    .如果 (加记录 (.)) ' 添加新类别
        信息框 (相加 (“添加成功”, “　　”), 64, “成功”)
    .否则
        信息框 (相加 (“添加失败”, “　　”), 48, “失败”)
    .如果结束
    读好友类别列表 ()
.如果结束


.子程序 _按钮改_被单击, 空白型, , 修改好友类别
.局部变量 II, 整数型, , , 

.如果 (或者 (等于 (删全部空 (.), “”), 等于 (., “全部好友”), 等于 (., “所有好友”))) ' 判断输入是否合法
    赋值 (., -1)
    获取焦点 ()
.否则
    .计次循环首 (取项目数 (), II) ' 重名处理
        .如果真 (等于 (II, 相加 (., 1))) ' 不与自己原来的名字比较
            到循环尾 ()
        .如果真结束
        .如果真 (等于 (., 相减 (II, 1).取项目文本 ())) ' 重名
            信息框 (相加 (“对不起，该分类已经存在！”, “　　”), 48, “重名”)
            赋值 (., -1)
            获取焦点 ()
            返回 ()
        .如果真结束
        
    .计次循环尾 ()
    标签跳转 (.取项目数值 (.)) ' 改名
    .如果 (修改 (.)) ' 更新好友类别并更新好友所属类别
        置当前库 (#好友库) ' 修改好友所属类别
        到首记录 ()
        .判断循环首 (查找 (等于 (读 (1), .取项目文本 (.))))
            写 (1, .) ' 修改
        .判断循环尾 ()
        信息框 (相加 (“修改成功”, “　　”), 64, “成功”)
    .否则
        信息框 (相加 (“修改失败”, “　　”), 48, “失败”)
    .如果结束
    读好友类别列表 ()
.如果结束


.子程序 _按钮删_被单击, 空白型, , 删除类别
.如果真 (等于 (., -1))
    返回 ()
.如果真结束
置当前库 (#好友库) ' 删除好友
到首记录 ()
.判断循环首 (查找 (等于 (读 (1), .取项目文本 (.))))
    删除 ()
    跳过 ()
.判断循环尾 ()
.如果 (等于 (信息框 (相加 (“删除分类，本组内的好友将全部被删除。”, “　　”, #换行符, “真要删除吗？”), 36, “请确定”), 5)) ' 确认删除
    彻底删除 () ' 彻底删除
    置当前库 (#分类库) ' 删除分类
    标签跳转 (.取项目数值 (.))
    删除 ()
    彻底删除 ()
.否则
    恢复删除 () ' 取消删除
.如果结束
读好友类别列表 ()


.子程序 _按钮退_被单击, 空白型, , 退出管理
销毁 ()


.子程序 _列表框1_列表项被选择, 空白型, , 选择好友分类
赋值 (., .取项目文本 (.))


.子程序 _编辑框添加_字符输入, 整数型, , 只能用汉字
.参数 字符代码, 整数型, , 

.如果真 (并且 (小于 (字符代码, 127), 不等于 (字符代码, #退格键)))
    返回 (0)
.如果真结束


.子程序 _编辑框修改_字符输入, 整数型, , 只能用汉字
.参数 字符代码, 整数型, , 

.如果真 (并且 (小于 (字符代码, 127), 不等于 (字符代码, #退格键)))
    返回 (0)
.如果真结束



 ' 不属于任何一个程序集、类模块的函数：
