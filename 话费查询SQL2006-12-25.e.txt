 ' 文件类型：Windows窗口程序

 ' 程序名称：G、C查询系统
 ' 程序描述：
 ' 程序作者：徐明明
 ' 邮政编码：235100
 ' 联系地址：中国联通濉溪分公司
 ' 联系电话：13084057002
 ' 传真号码：
 ' 电子信箱：13084057002@ah165.net
 ' 主页地址：www.12cool.net
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 1024
    高度 = 718
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 真
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “联通濉溪分公司”
    帮助文件名 = “”

窗口 明细
    左边 = 50
    顶边 = 50
    宽度 = 723
    高度 = 433
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “联通濉溪分公司”
    帮助文件名 = “”

窗口 登陆窗口
    左边 = 50
    顶边 = 50
    宽度 = 333
    高度 = 234
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “登陆综合查询系统”
    帮助文件名 = “”

窗口 工号窗口
    左边 = 50
    顶边 = 50
    宽度 = 715
    高度 = 495
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “用户设置”
    帮助文件名 = “”

窗口 增加权限组
    左边 = 50
    顶边 = 50
    宽度 = 360
    高度 = 307
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “添加权限组”
    帮助文件名 = “”

窗口 修改工号窗口
    左边 = 50
    顶边 = 50
    宽度 = 715
    高度 = 495
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “用户设置”
    帮助文件名 = “”

窗口 地区部门
    左边 = 50
    顶边 = 50
    宽度 = 327
    高度 = 223
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “增加部门”
    帮助文件名 = “”

窗口 修改密码
    左边 = 50
    顶边 = 50
    宽度 = 359
    高度 = 259
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “操作员密码修改”
    帮助文件名 = “”

窗口 增加地区
    左边 = 50
    顶边 = 50
    宽度 = 327
    高度 = 223
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “增加地区”
    帮助文件名 = “”

窗口 注册未成功
    左边 = 50
    顶边 = 50
    宽度 = 572
    高度 = 465
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “软件注册”
    帮助文件名 = “”



.常量 标题, "“综合查询系统”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 2 5 扩展界面支持库三
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 1 3 高级表格支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' eExcel2000 F86EC5989E044d42BC98C692C0B54727 1 0 EXCEL2000支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' EChartBar 9A3F84D7FDEB4a0486F2711D5104B7F7 1 6 数据图表支持库
 ' ExtMenu 9909FBB013704cfa8FE7E739DB7172DE 1 6 超级菜单支持库
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 1 0 数据操作支持库一
 ' CnCalendar {18C0788E-59AE-4112-B452-6BF0C1B727FB} 1 2 农历日期支持库
 ' sock A6B983789F624b2cBDFD7D671249C097 1 0 网络通讯支持库




.全局变量 外部数据, 外部数据库, , , 
.全局变量 数据, 外部数据库, , , 
.全局变量 记录集句柄一, 空白型, , , 
.全局变量 查询语句, 文本型, , , 
.全局变量 查询记录, 空白型, , , 
.全局变量 操作员, 文本型, , , 
.全局变量 idd, 文本型, , , 
.全局变量 rsc, 空白型, , , 
.全局变量 a01, 文本型, , , 
.全局变量 b01, 文本型, , , 
.全局变量 c01, 文本型, , , 
.全局变量 d01, 文本型, , , 
.全局变量 e01, 文本型, , , 
.全局变量 a001, 文本型, , , 
.全局变量 b001, 文本型, , , 
.全局变量 c001, 整数型, , , 
.全局变量 d001, 整数型, , , 
.全局变量 e001, 文本型, , , 
.全局变量 f001, 文本型, , , 
.全局变量 g001, 整数型, , , 
.全局变量 原始硬盘特征代码, 文本型, , , 
.全局变量 新特征代码, 整数型, , , 
.全局变量 h001, 整数型, , , 
.全局变量 退出时间, 日期时间型, , , 
.全局变量 登陆IP, 文本型, , "0", 
.全局变量 权限组, 文本型, , , 
.全局变量 reg, 文本型, , , 

.DLL命令 设置, 空白型, "", "WinExec", , 
    .参数 h, 文本型, , 
    .参数 z, 整数型, , 

.DLL命令 取父菜单句柄, 整数型, "", "GetMenu", , 返回父菜单句柄
    .参数 父窗口句柄, 整数型, , 

.DLL命令 取菜单项目数, 整数型, "", "GetMenuItemCount", , 返回菜单项目数
    .参数 菜单句柄, 整数型, , 

.DLL命令 设置菜单, 空白型, "", "EnableMenuItem", , 禁止或允许
    .参数 菜单句柄, 整数型, , 由“取弹出菜句柄”获得
    .参数 标识符, 整数型, , 欲允许或禁止的一个菜单条目的标识符。由“取项目ID”获得
    .参数 常数, 整数型, , 只能指定下述常数：4允许5禁止

.DLL命令 取菜单项名, 整数型, "", "GetMenuStringA", , 在lpString中返回的字串的长度
    .参数 菜单句柄, 整数型, , 
    .参数 标识符, 整数型, , 
    .参数 名称, 文本型, 传址, 
    .参数 长度, 整数型, , 256
    .参数 常数, 整数型, , 

.DLL命令 取弹出菜句柄, 整数型, "", "GetSubMenu", , 
    .参数 菜单句柄, 整数型, , 由“取父菜单句柄”获得
    .参数 位置, 整数型, , 条目在菜单中的位置。第一个条目的编号是0

.DLL命令 提示信息, 整数型, "user32.dll", "MessageBoxA", , 
    .参数 句柄, 整数型, , 取运行的窗口句柄
    .参数 内容, 文本型, , 提示的内容信息
    .参数 标题, 文本型, , 提示框的标题
    .参数 按钮, 整数型, , 参加信息框的按钮

.DLL命令 取项目ID, 整数型, "", "GetMenuItemID", , 返回位于菜单中指定位置处的条目的菜单ID
    .参数 菜单句柄, 整数型, , 
    .参数 位置, 整数型, , 条目在菜单中的位置。第一个条目的编号是0

.窗口程序集 启动窗口程序集, , , 

.程序集变量 开始日期, 文本型, , , 
.程序集变量 计次1, 整数型, , , 
.程序集变量 结束日期, 文本型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 逻辑值, 逻辑型, , , 
.局部变量 用户名, 文本型, , , 
.局部变量 密码, 文本型, , , 
.局部变量 服务, 文本型, , , 
.局部变量 连接文本, 文本型, , , 
.局部变量 mdb, 文本型, , , 
.局部变量 lj, 文本型, , , 
.局部变量 DATABASE2, 文本型, , , 
.局部变量 unserver, 文本型, , , 

赋值 (数据, )
赋值 (.时钟周期, 1000)
赋值 (操作员, “';hbsxxmm”)
赋值 (unserver, “127.0.0.1”)
赋值 (mdb, “19780313”)
赋值 (lj, “sa”)
赋值 (DATABASE2, “sxunicom”)
.如果真 (等于 (数据.打开 (相加 (“ODBC;DBQ=UNICOM;DRIVER={SQL SERVER};SERVER=”, unserver, “;DATABASE=”, DATABASE2, “;UID=”, lj, “;pwd=”, mdb, “;”), ), 假))
    信息框 (“打开指定数据库失败，请检查是否数据库文件已经被移动！”, #警告图标, “系统消息”)
    结束 ()
.如果真结束
检测 ()
载入 (登陆窗口, , 真)
.判断开始 (等于 (打开 (相加 (取运行目录 (), “\data\dr.edb”), “我的库”, , , , , ), 真)) ' 这里打开你要加入的数据库名
    置当前库 (“我的库”)
    赋值 (., 0)
    赋值 (., 真)
    赋值 (外部数据, )
     ' 用户名 ＝ “HB_ADMIN”
     ' 密码 ＝ “svadf7”
     ' 服务 ＝ “ahcxnew”
     ' 连接文本 ＝ “DRIVER={Microsoft ODBC for Oracle};UID=” ＋ 用户名 ＋ “;PWD=” ＋ 密码 ＋ “;SERVER=” ＋ 服务 ＋ “;”
     ' 逻辑值 ＝ 外部数据.打开 (连接文本, )
    .判断开始 (等于 (逻辑值, 真))
        
    .默认
         ' 信息框 (“连接失败！请与管理员联系！电话：13084057002” ＋ #换行符, 0, “提示信息”)
         ' 销毁 ()
    .判断结束
    
.默认
    信息框 (“数据库丢失!请与管理员联系!”, 0, )
    结束 ()
.判断结束




.子程序 _时钟1_周期事件, 空白型, , 
4.置文本 (到文本 (取现行时间 ()))

.子程序 _CG号码查询_被选择, 空白型, , 
.局部变量 nian, 整数型, , , 
.局部变量 yue, 整数型, , , 
.局部变量 NIAN1, 整数型, , , 

赋值 (., 1)
赋值 (.内容, “”)
获取焦点 ()
赋值 (.最大允许长度, 11)
赋值 (.现行选中项, -1)
清空 ()
赋值 (.今天, 取现行时间 ())
赋值 (nian, 取年份 (到时间 (.今天)))
.判断循环首 (小于或等于 (yue, 11))
    赋值 (yue, 相加 (yue, 1))
    .判断开始 (大于 (yue, 9))
        .判断开始 (小于或等于 (yue, 取月份 (到时间 (.今天))))
            相加 (到文本 (nian), 到文本 (yue)).加入项目 ()
        .默认
            
        .判断结束
        
    .判断 (小于或等于 (yue, 取月份 (到时间 (.今天))))
        相加 (到文本 (nian), “0”, 到文本 (yue)).加入项目 ()
    .默认
        
    .判断结束
    
.判断循环尾 ()
全部删除 ()
记录操作事件 (“CG号码查询”)

.子程序 _按钮GC_被单击, 空白型, , 
.局部变量 记录集, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 STATUS, 文本型, , , 
.局部变量 ruwangtc, 文本型, , , 
.局部变量 b, 文本型, , , 
.局部变量 状态记录, 整数型, , , 
.局部变量 zhut, 文本型, , , 
.局部变量 taocan, 文本型, , , 
.局部变量 套餐记录, 整数型, , , 
.局部变量 taocan1, 文本型, , , 

全部删除 ()
.判断开始 (等于 (.内容, “”))
    信息框 (“请输入要查询的手机号码?”, 0, “提示信息”)
    获取焦点 ()
.判断 (等于 (.内容, “”))
    信息框 (“请选择查询月份”, 0, “提示信息”)
    获取焦点 ()
.默认
    赋值 (记录集, 外部数据.查询 (相加 (“SELECT DISTINCT CUSTOMER_CREDIT, BB_SERVICE_RELATION_T_314.SERVICE_KIND,SERVICE_FAVOUR_ID,SERVICE_ID,SUM(FEE1+FEE2+FEE3+FEE4+FEE11+FEE12+FEE13+FEE14) AS HUAFEI, FIRST_NAME,COMM_ADDRESS,HOME_PHONE,SERVICE_START_DATE,NOTE,BB_SERVICE_RELATION_T_314.SERVING_STATUS FROM BF_GATHER_FEE_T_314_”, .内容, “,BB_SERVICE_RELATION_T_314,BB_CUSTOMER_INFO_T_314 WHERE BB_SERVICE_RELATION_T_314.USER_ID=BF_GATHER_FEE_T_314_”, .内容, “.USER_ID AND BB_CUSTOMER_INFO_T_314.CUSTOMER_ID=BF_GATHER_FEE_T_314_”, .内容, “.CUSTOMER_ID AND SERVICE_ID='”, .内容, “' GROUP BY SERVICE_ID,FIRST_NAME,COMM_ADDRESS,HOME_PHONE,SERVICE_START_DATE,SERVICE_FAVOUR_ID,BB_SERVICE_RELATION_T_314.SERVICE_KIND,NOTE,BB_SERVICE_RELATION_T_314.SERVING_STATUS,CUSTOMER_CREDIT”)))
    赋值 (b, 到文本 (外部数据.读 (记录集, 1)))
    .如果 (等于 (b, “”))
        信息框 (“无任何查询结果!请重新选择!”, 0, “提示信息”)
        全部删除 ()
    .否则
        .计次循环首 (取列数 (), 计次)
            相减 (取列数 (), 1).删除列 ()
        .计次循环尾 ()
        .插入列 (“序号”, 36, #中间对齐, , )
        .插入列 (“手机号码”, 90, #中间对齐, , )
        .插入列 (“用户姓名”, 100, #中间对齐, , )
        .插入列 (“入网套餐”, 138, #中间对齐, , )
        .插入列 (“话费”, 50, #中间对齐, , )
        .插入列 (“出帐话费月份”, 100, #中间对齐, , )
        .插入列 (“用户状态”, 150, #中间对齐, , )
        外部数据.到首记录 (记录集)
        .判断循环首 (等于 (外部数据.尾记录后 (记录集), 假))
            .插入表项 ()
            相减 (取表项数 (), 1).置标题 (0, 到文本 (相加 (i, 1)))
            相减 (取表项数 (), 1).置标题 (1, 外部数据.读 (记录集, “SERVICE_ID”))
            相减 (取表项数 (), 1).置标题 (2, 到文本 (外部数据.读 (记录集, “FIRST_NAME”)))
            赋值 (taocan, 到文本 (外部数据.读 (记录集, “SERVICE_FAVOUR_ID”)))
            赋值 (taocan1, 到文本 (外部数据.读 (记录集, “SERVICE_KIND”)))
            赋值 (套餐记录, 外部数据.查询 (相加 (“select * from PM_SUBPRODUCT_INFO_T where F_SUBPRODUCT_ID= '”, taocan, “' and F_USE_CITY=314 and F_SERVICE_KIND='”, taocan1, “'”)))
            赋值 (ruwangtc, 到文本 (外部数据.读 (套餐记录, “F_SUBPRODUCT_NAME”)))
            相减 (取表项数 (), 1).置标题 (3, ruwangtc)
            相减 (取表项数 (), 1).置标题 (4, 到文本 (外部数据.读 (记录集, “HUAFEI”)))
            相减 (取表项数 (), 1).置标题 (5, .内容)
            赋值 (zhut, 到文本 (外部数据.读 (记录集, “SERVING_STATUS”)))
            赋值 (状态记录, 外部数据.查询 (相加 (“select * from BB_SERVING_STATUS_T where kind= '”, zhut, “' ”)))
            赋值 (STATUS, 到文本 (外部数据.读 (状态记录, “NAME”)))
            相减 (取表项数 (), 1).置标题 (6, STATUS)
            赋值 (i, 相加 (i, 1))
            外部数据.到后一记录 (记录集)
        .判断循环尾 ()
        外部数据.关闭记录集 (记录集)
        外部数据.关闭记录集 (套餐记录)
        外部数据.关闭记录集 (状态记录)
        记录操作事件 (相加 (.内容, .内容, “成功”))
    .如果结束
    返回 ()
.判断结束


.子程序 _GC批量查询_被选择, 空白型, , 
.局部变量 nian1, 整数型, , , 
.局部变量 yue1, 整数型, , , 

赋值 (., 2)
清空 ()
赋值 (.内容, “”)
赋值 (.现行选中项, -1)
清空 ()
未知支持库函数_57 ()
赋值 (.今天, 取现行时间 ())
赋值 (nian1, 取年份 (到时间 (.今天)))
.判断循环首 (小于或等于 (yue1, 11))
    赋值 (yue1, 相加 (yue1, 1))
    .判断开始 (大于 (yue1, 9))
        .判断开始 (小于或等于 (yue1, 取月份 (到时间 (.今天))))
            相加 (到文本 (nian1), 到文本 (yue1)).加入项目 ()
        .默认
            
        .判断结束
        
    .判断 (小于或等于 (yue1, 取月份 (到时间 (.今天))))
        相加 (到文本 (nian1), “0”, 到文本 (yue1)).加入项目 ()
    .默认
        
    .判断结束
    
.判断循环尾 ()
记录操作事件 (“GC批量查询”)

.子程序 _话费统计_被选择, 空白型, , 
赋值 (., 4)

.子程序 _关闭GC_被单击, 空白型, , 
赋值 (., 0)
赋值 (.内容, “”)
赋值 (.现行选中项, -1)
全部删除 ()

.子程序 _按钮3_被单击, 空白型, , 
赋值 (., 0)
赋值 (.内容, “”)
赋值 (.现行选中项, -1)
未知支持库函数_57 ()

.子程序 _按钮2_被单击, 空白型, , 
.局部变量 记录集1, 整数型, , , 
.局部变量 套餐记录1, 整数型, , , 
.局部变量 taocan2, 文本型, , , 
.局部变量 taocan3, 文本型, , , 
.局部变量 ruwangtc2, 文本型, , , 
.局部变量 STATUS1, 文本型, , , 
.局部变量 状态记录1, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 循环变量1, 整数型, , , 
.局部变量 num, 文本型, , , 
.局部变量 zhut1, 文本型, , , 

赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
.判断开始 (等于 (.内容, “”))
    信息框 (“请选择查询月份!”, 0, “提示信息”)
    赋值 (., 假)
    赋值 (.可视, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    返回 ()
.判断 (等于 (.内容, “”))
    信息框 (“请导入文本文件!”, 0, “提示信息”)
    赋值 (., 假)
    赋值 (.可视, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    返回 ()
.默认
    赋值 (.可视, 真)
    赋值 (.位置, 1)
    赋值 (计次, 取记录数 ())
    .计次循环首 (计次, 循环变量1)
        赋值 (., 真)
        赋值 (.位置, 相加 (.位置, 1))
        赋值 (.最大位置, 计次)
        赋值 (num, 循环变量1.未知支持库函数_10 (1))
        赋值 (.标题, 到文本 (num))
        处理事件 ()
        赋值 (记录集1, 外部数据.查询 (相加 (“SELECT DISTINCT CUSTOMER_CREDIT, BB_SERVICE_RELATION_T_314.SERVICE_KIND,SERVICE_FAVOUR_ID,SERVICE_ID,SUM(FEE1+FEE2+FEE3+FEE4+FEE11+FEE12+FEE13+FEE14) AS HUAFEI,FIRST_NAME,COMM_ADDRESS,HOME_PHONE,SERVICE_START_DATE,NOTE,BB_SERVICE_RELATION_T_314.SERVING_STATUS FROM BF_GATHER_FEE_T_314_”, .内容, “,BB_SERVICE_RELATION_T_314,BB_CUSTOMER_INFO_T_314 WHERE BB_SERVICE_RELATION_T_314.USER_ID=BF_GATHER_FEE_T_314_”, .内容, “.USER_ID AND BB_CUSTOMER_INFO_T_314.CUSTOMER_ID=BF_GATHER_FEE_T_314_”, .内容, “.CUSTOMER_ID AND SERVICE_ID='”, num, “' AND BB_SERVICE_RELATION_T_314.SERVICE_KIND IN(8,9) GROUP BY SERVICE_ID,FIRST_NAME,COMM_ADDRESS,HOME_PHONE,SERVICE_START_DATE,SERVICE_FAVOUR_ID,BB_SERVICE_RELATION_T_314.SERVICE_KIND,NOTE,BB_SERVICE_RELATION_T_314.SERVING_STATUS,CUSTOMER_CREDIT”)))
        赋值 (taocan2, 到文本 (外部数据.读 (记录集1, “SERVICE_FAVOUR_ID”)))
        赋值 (taocan3, 到文本 (外部数据.读 (记录集1, “SERVICE_KIND”)))
        赋值 (套餐记录1, 外部数据.查询 (相加 (“select * from PM_SUBPRODUCT_INFO_T where F_SUBPRODUCT_ID= '”, taocan2, “' and F_USE_CITY=314 and F_SERVICE_KIND='”, taocan3, “'”)))
        赋值 (ruwangtc2, 到文本 (外部数据.读 (套餐记录1, “F_SUBPRODUCT_NAME”)))
        赋值 (zhut1, 到文本 (外部数据.读 (记录集1, “SERVING_STATUS”)))
        赋值 (状态记录1, 外部数据.查询 (相加 (“select * from BB_SERVING_STATUS_T where kind= '”, zhut1, “' ”)))
        赋值 (STATUS1, 到文本 (外部数据.读 (状态记录1, “NAME”)))
        循环变量1.未知支持库函数_9 (2, #., 到文本 (外部数据.读 (记录集1, “FIRST_NAME”)))
        循环变量1.未知支持库函数_9 (3, #., ruwangtc2)
        循环变量1.未知支持库函数_9 (4, #., 到文本 (外部数据.读 (记录集1, “HUAFEI”)))
        循环变量1.未知支持库函数_9 (5, #., 到文本 (外部数据.读 (记录集1, “SERVICE_START_DATE”)))
        循环变量1.未知支持库函数_9 (6, #., STATUS1)
        跳过 ()
        外部数据.关闭记录集 (记录集1)
        外部数据.关闭记录集 (套餐记录1)
        外部数据.关闭记录集 (状态记录1)
    .计次循环尾 ()
    赋值 (., 假)
    赋值 (.可视, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    记录操作事件 (相加 (“批量查询”, .内容, “成功”))
.判断结束
返回 ()

.子程序 _浏览_被单击, 空白型, , 
.局部变量 文本, 文本型, , , 
.局部变量 文本行, 文本型, , "0", 
.局部变量 变量, 整数型, , , 
.局部变量 文本列, 文本型, , "0", 
.局部变量 KK, 整数型, , , 
.局部变量 循环变量1, 整数型, , , 
.局部变量 循环变量2, 整数型, , , 
.局部变量 字段类型, 整数型, , , 
.局部变量 H, 整数型, , , 

清空 ()
未知支持库函数_57 ()
赋值 (.过滤器, “文本文件(*.TXT)|*.txt”)
赋值 (.类型, 0)
.如果真 (打开 ())
    赋值 (.内容, .文件名)
    赋值 (文本, 到文本 (读入文件 (.文件名))) ' 把 文本文件 替换成他的路径
    赋值 (文本行, 分割文本 (文本, #换行符, ))
    置等待鼠标 ()
    .变量循环首 (1, 取数组成员数 (文本行), 1, 变量)
        .判断循环首 (不等于 (寻找文本 (文本行 [变量], 字符 (11), , 假), -1))
            赋值 (文本行 [变量], 子文本替换 (文本行 [变量], 字符 (11), 字符 (11), , , 真))
        .判断循环尾 ()
        重定义数组 (文本列, 假, 0)
        赋值 (文本列, 分割文本 (文本行 [变量], 字符 (11), )) ' 中间的空格要与文本对应
        .变量循环首 (相加 (取数组成员数 (文本列), 1), 1, 1, KK)
            赋值 (文本列 [KK], “”)
        .变量循环尾 ()
        加记录 (文本列 [1])
    .变量循环尾 ()
    恢复鼠标 ()
    赋值 (., 0)
    赋值 (., 0)
    赋值 (., 相加 (取记录数 (), 1))
    到首记录 ()
    .计次循环首 (取记录数 (), 循环变量1)
        .计次循环首 (取字段数 (), 循环变量2)
            赋值 (H, 相加 (H, 1))
            循环变量1.未知支持库函数_9 (循环变量2, #., 到文本 (读 (循环变量2)))
            循环变量1.未知支持库函数_9 (相减 (循环变量2, 1), #., 到文本 (H))
        .计次循环尾 ()
        跳过 ()
    .计次循环尾 ()
    0.未知支持库函数_9 (0, #., “序号”)
    0.未知支持库函数_32 (30)
    0.未知支持库函数_9 (1, #., “手机号码”)
    0.未知支持库函数_25 (0, 相减 (., .), 6, #.)
    1.未知支持库函数_32 (72)
    0.未知支持库函数_9 (2, #., “用户姓名”)
    2.未知支持库函数_32 (100)
    0.未知支持库函数_9 (3, #., “入网套餐”)
    3.未知支持库函数_32 (140)
    0.未知支持库函数_9 (4, #., “话费”)
    4.未知支持库函数_32 (70)
    0.未知支持库函数_9 (5, #., “入网日期”)
    5.未知支持库函数_32 (130)
    0.未知支持库函数_9 (6, #., “状态”)
    6.未知支持库函数_32 (100)
    关闭 (.文件名)
.如果真结束


.子程序 _导出按钮_被单击, 空白型, , 
.局部变量 单元格对象, 对象, , , 

.判断开始 (等于 (.内容, “”))
    信息框 (“请导入文本文件!”, 0, “提示信息”)
    返回 ()
.默认
    .如果真 (并且 (等于 (., 0), 等于 (., 0)))
        返回 ()
    .如果真结束
    .如果真 (等于 (未知支持库函数_0 (), 假))
        信息框 (“Excel程序创建失败！ ”, 0, )
        返回 ()
    .如果真结束
    .如果真 (等于 (.未知支持库函数_6 (), 假))
        信息框 (“Excel工作簿连接Excel程序失败！ ”, 0, )
        返回 ()
    .如果真结束
    赋值 (.初始目录, 取运行目录 ())
    赋值 (.过滤器, “Excel工作簿|*.xls”)
    赋值 (.类型, 1)
    赋值 (.默认文件后缀, “.xls”)
    .如果真 (等于 (打开 (), 假))
        未知支持库函数_1 ()
        未知支持库函数_15 ()
        未知支持库函数_11 (“Excel.exe”)
        返回 ()
    .如果真结束
    未知支持库函数_2 ()
    未知支持库函数_12 ()
    赋值 (., “a1”)
    赋值 (., “a1”)
    赋值 (单元格对象, 未知支持库函数_13 ())
    单元格对象.通用方法 (“PasteSpecial”, )
    .未知支持库函数_16 (.文件名)
    单元格对象.清除 ()
    未知支持库函数_1 ()
    未知支持库函数_15 ()
     ' 终止进程 (“Excel.exe”)
    信息框 (“导出完成”, 0, )
.判断结束


.子程序 _版本_被选择, 空白型, , 
.局部变量 c, 文本型, , , 
.局部变量 d, 文本型, , , 

赋值 (., 8)
赋值 (.内容, a01)
赋值 (.内容, b01)
赋值 (.内容, c01)
赋值 (.内容, d01)

.子程序 _超级按钮2_被单击, 空白型, , 
赋值 (., 0)

.子程序 _查询GSM按钮_被单击, 空白型, , 
.局部变量 查询GSM记录, 整数型, , , 
.局部变量 查询CDMA记录, 整数型, , , 
.局部变量 GSM1, 文本型, , , 
.局部变量 代理名称1, 整数型, , , 
.局部变量 name, 文本型, , , 
.局部变量 ID, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 代理名称2, 整数型, , , 
.局部变量 循环1, 整数型, , , 
.局部变量 循环2, 整数型, , , 
.局部变量 今日, 文本型, , , 
.局部变量 结束今日, 文本型, , , 
.局部变量 今月, 文本型, , , 
.局部变量 结束今月, 文本型, , , 
.局部变量 GH, 文本型, , , 
.局部变量 GH1, 文本型, , , 

0.未知支持库函数_9 (0, #., “序号”)
0.未知支持库函数_32 (40)
0.未知支持库函数_9 (1, #., “代理商名称”)
0.未知支持库函数_25 (0, 相减 (., .), 6, #.)
1.未知支持库函数_32 (250)
0.未知支持库函数_9 (2, #., “GSM数量”)
2.未知支持库函数_32 (100)
0.未知支持库函数_9 (3, #., “CDMA数量”)
3.未知支持库函数_32 (100)
0.未知支持库函数_9 (4, #., “合计”)
4.未知支持库函数_32 (185)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.可视, 真)
赋值 (.位置, 1)
.判断开始 (小于或等于 (取日 (.今天), 9))
    赋值 (今日, 相加 (“0”, 到文本 (取日 (.今天))))
.默认
    赋值 (今日, 到文本 (取日 (.今天)))
.判断结束
.判断开始 (小于或等于 (取日 (.今天), 9))
    赋值 (结束今日, 相加 (“0”, 到文本 (取日 (.今天))))
.默认
    赋值 (结束今日, 到文本 (取日 (.今天)))
.判断结束
.判断开始 (小于或等于 (取月份 (.今天), 9))
    赋值 (今月, 相加 (“0”, 到文本 (取月份 (.今天))))
.默认
    赋值 (今月, 到文本 (取月份 (.今天)))
.判断结束
.判断开始 (小于或等于 (取月份 (.今天), 9))
    赋值 (结束今月, 相加 (“0”, 到文本 (取月份 (.今天))))
.默认
    赋值 (结束今月, 到文本 (取月份 (.今天)))
.判断结束
赋值 (开始日期, 相加 (到文本 (取年份 (.今天)), “-”, 今月, “-”, 今日))
赋值 (结束日期, 相加 (到文本 (取年份 (.今天)), “-”, 结束今月, “-”, 结束今日))
.如果 (大于 (到时间 (.今天), 到时间 (.今天)))
    信息框 (“[开始日期]不能大于[截止日期]”, #信息图标, “提示”)
.否则
    赋值 (GSM1, 相加 (“133”, “%”))
    赋值 (GH, 相加 (“SX_”, “%”))
    赋值 (GH1, 相加 (“sf_”, “%”))
    
    .判断开始 (等于 (.取项目文本 (.现行选中项), “不区分”))
        赋值 (代理名称1, 外部数据.查询 (“SELECT * FROM BD_DEALER_T WHERE city_code='314' and belongs_part='53141001' and valid_status='1'”))
        赋值 (代理名称2, 外部数据.查询 (“SELECT count(*) as 合计 FROM BD_DEALER_T WHERE city_code='314' and belongs_part='53141001' and valid_status='1'”))
        赋值 (计次, 到整数 (外部数据.读 (代理名称2, “合计”)))
        外部数据.到首记录 (代理名称1)
        .计次循环首 (计次, 循环1)
            赋值 (., 真)
            赋值 (.位置, 相加 (.位置, 1))
            赋值 (.最大位置, 计次)
            赋值 (.标题, 到文本 (外部数据.读 (代理名称1, 2)))
            赋值 (.标题, 到文本 (外部数据.读 (代理名称1, 3)))
            处理事件 ()
            赋值 (查询GSM记录, 外部数据.查询 (相加 (“SELECT count(distinct SERVICE_ID)合计1 FROM BB_SERVICE_RELATION_T_314 WHERE source_id= '”, .标题, “' and not SERVICE_ID like  '”, GSM1, “' and to_char(SERVICE_START_DATE,'yyyy-mm-dd')>='”, 开始日期, “' and to_char(SERVICE_START_DATE,'yyyy-mm-dd')<='”, 结束日期, “'”)))
            赋值 (查询CDMA记录, 外部数据.查询 (相加 (“SELECT count(distinct SERVICE_ID)合计2 FROM BB_SERVICE_RELATION_T_314 WHERE source_id= '”, .标题, “' and SERVICE_ID like  '”, GSM1, “' and to_char(SERVICE_START_DATE,'yyyy-mm-dd')>='”, 开始日期, “' and to_char(SERVICE_START_DATE,'yyyy-mm-dd')<='”, 结束日期, “'”)))
            赋值 (., 相加 (计次, 1))
            循环1.未知支持库函数_9 (0, #., 循环1)
            循环1.未知支持库函数_9 (1, #., 相加 (到文本 (外部数据.读 (代理名称1, 2)), “|”, 到文本 (外部数据.读 (代理名称1, 3))))
            循环1.未知支持库函数_9 (2, #., 到文本 (外部数据.读 (查询GSM记录, “合计1”)))
            循环1.未知支持库函数_9 (3, #., 到文本 (外部数据.读 (查询CDMA记录, “合计2”)))
            循环1.未知支持库函数_9 (4, #., 到文本 (相加 (到数值 (外部数据.读 (查询GSM记录, “合计1”)), 到数值 (外部数据.读 (查询CDMA记录, “合计2”)))))
            外部数据.到后一记录 (代理名称1)
            外部数据.关闭记录集 (查询GSM记录)
            外部数据.关闭记录集 (查询CDMA记录)
        .计次循环尾 ()
        外部数据.关闭记录集 (代理名称1)
        外部数据.关闭记录集 (代理名称2)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.可视, 假)
        赋值 (., 假)
    .默认
        赋值 (., 真)
        赋值 (.位置, 相加 (.位置, 1))
        赋值 (.最大位置, 1)
        赋值 (.标题, 到文本 (外部数据.读 (代理名称1, 3)))
        处理事件 ()
        赋值 (查询GSM记录, 外部数据.查询 (相加 (“SELECT count(distinct SERVICE_ID)GSM FROM BB_SERVICE_RELATION_T_314 WHERE source_id= '”, 取文本左边 (.取项目文本 (.现行选中项), 8), “' and not SERVICE_ID like  '”, GSM1, “' and to_char(SERVICE_START_DATE,'yyyy-mm-dd')>='”, 开始日期, “' and to_char(SERVICE_START_DATE,'yyyy-mm-dd')<='”, 结束日期, “' and SERVICE_KIND IN (8,9)”)))
        赋值 (查询CDMA记录, 外部数据.查询 (相加 (“SELECT count(distinct SERVICE_ID)CDMA FROM BB_SERVICE_RELATION_T_314 WHERE source_id= '”, 取文本左边 (.取项目文本 (.现行选中项), 8), “' and SERVICE_ID like  '”, GSM1, “' and to_char(SERVICE_START_DATE,'yyyy-mm-dd')>='”, 开始日期, “' and to_char(SERVICE_START_DATE,'yyyy-mm-dd')<='”, 结束日期, “' and SERVICE_KIND IN (8,9)”)))
        赋值 (., 2)
        1.未知支持库函数_9 (0, #., “1”)
        1.未知支持库函数_9 (1, #., .取项目文本 (.现行选中项))
        1.未知支持库函数_9 (2, #., 到文本 (外部数据.读 (查询GSM记录, “GSM”)))
        1.未知支持库函数_9 (3, #., 到文本 (外部数据.读 (查询CDMA记录, “CDMA”)))
        1.未知支持库函数_9 (4, #., 到文本 (相加 (到数值 (外部数据.读 (查询GSM记录, “GSM”)), 到数值 (外部数据.读 (查询CDMA记录, “CDMA”)))))
        外部数据.关闭记录集 (查询GSM记录)
        外部数据.关闭记录集 (查询CDMA记录)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.可视, 假)
        赋值 (., 假)
    .判断结束
    
.如果结束
记录操作事件 (相加 (“放号统计”, .取项目文本 (.现行选中项), 开始日期, “至”, 结束日期, “成功”))

.子程序 _放号统计_被选择, 空白型, , 
.局部变量 代理名称, 整数型, , , 

未知支持库函数_57 ()
赋值 (., 3)
清空 ()
“不区分”.加入项目 ()
赋值 (代理名称, 外部数据.查询 (“SELECT * FROM BD_DEALER_T WHERE city_code='314' and belongs_part='53141001' and valid_status='1'”))
外部数据.到首记录 (代理名称)
.判断循环首 (等于 (外部数据.尾记录后 (代理名称), 假))
    相加 (外部数据.读 (代理名称, 2), “|”, 外部数据.读 (代理名称, 3)).加入项目 ()
    外部数据.到后一记录 (代理名称)
.判断循环尾 ()
外部数据.关闭记录集 (代理名称)

.子程序 _高级表格GSM_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 xunhuan, 整数型, , , 

载入 (明细, , 真)
置等待鼠标 ()
处理事件 ()

.子程序 循环1, 文本型, , 
返回 (未知支持库函数_3 ().未知支持库函数_10 (1))


.子程序 _导出GSM按钮_被单击, 空白型, , 
.局部变量 单元格对象, 对象, , , 

.如果真 (并且 (等于 (., 0), 等于 (., 0)))
    返回 ()
.如果真结束
.如果真 (等于 (未知支持库函数_0 (), 假))
    信息框 (“Excel程序创建失败！ ”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (.未知支持库函数_6 (), 假))
    信息框 (“Excel工作簿连接Excel程序失败！ ”, 0, )
    返回 ()
.如果真结束
赋值 (.初始目录, 取运行目录 ())
赋值 (.过滤器, “Excel工作簿|*.xls”)
赋值 (.类型, 1)
赋值 (.默认文件后缀, “.xls”)
.如果真 (等于 (打开 (), 假))
    未知支持库函数_1 ()
    未知支持库函数_15 ()
    未知支持库函数_11 (“Excel.exe”)
    返回 ()
.如果真结束
未知支持库函数_2 ()
未知支持库函数_12 ()
赋值 (., “a1”)
赋值 (., “a1”)
赋值 (单元格对象, 未知支持库函数_13 ())
单元格对象.通用方法 (“PasteSpecial”, )
.未知支持库函数_16 (.文件名)
单元格对象.清除 ()
未知支持库函数_1 ()
未知支持库函数_15 ()
未知支持库函数_11 (“Excel.exe”)
信息框 (“导出完成”, 0, )


.子程序 _关闭GSM按钮_被单击, 空白型, , 
赋值 (., 0)

.子程序 _工号设置_被选择, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 权限查询, 整数型, , , 
.局部变量 部门查询, 整数型, , , 
.局部变量 v, 文本型, , , 

全部删除 ()
赋值 (., 5)
赋值 (查询语句, “select * from 用户资料 where 权限组<>'6'”)
数据.关闭记录集 (查询记录)
赋值 (查询记录, 数据.查询 (查询语句))
数据.到首记录 (查询记录)
.计次循环首 (取列数 (), 计次)
    相减 (取列数 (), 1).删除列 ()
.计次循环尾 ()
.插入列 (“序号”, 36, #中间对齐, , )
.插入列 (“工号”, 80, #中间对齐, , )
.插入列 (“权限”, 80, #中间对齐, , )
.插入列 (“部门”, 130, #中间对齐, , )
.插入列 (“姓名”, 80, #中间对齐, , )
.插入列 (“联系电话”, 90, #中间对齐, , )
.插入列 (“联系地址”, 200, #中间对齐, , )
.插入列 (“创建日期”, 180, #中间对齐, , )
.插入列 (“是否禁用”, 80, #中间对齐, , )
.插入列 (“创建人”, 50, #中间对齐, , )
.插入列 (“备注”, 200, #中间对齐, , )
数据.到首记录 (查询记录)
.判断循环首 (等于 (数据.尾记录后 (查询记录), 假))
    .插入表项 ()
    相减 (取表项数 (), 1).置标题 (0, 到文本 (相加 (i, 1)))
    相减 (取表项数 (), 1).置标题 (1, 数据.读 (查询记录, “工号”))
    赋值 (权限查询, 数据.查询 (相加 (“select * from 权限类型 where 权限设置='”, 到文本 (数据.读 (查询记录, “权限”)), “'”)))
    相减 (取表项数 (), 1).置标题 (2, 到文本 (数据.读 (权限查询, “权限类型”)))
    赋值 (部门查询, 数据.查询 (相加 (“select * from 部门类型 where 地区代码=”, 取文本中间 (到文本 (数据.读 (查询记录, “部门”)), 1, 6), “ and 部门代码=”, 取文本中间 (到文本 (数据.读 (查询记录, “部门”)), 8, 7), “”)))
    相减 (取表项数 (), 1).置标题 (3, 到文本 (相加 (数据.读 (部门查询, “地区”), 数据.读 (部门查询, “部门”))))
    相减 (取表项数 (), 1).置标题 (4, 到文本 (数据.读 (查询记录, “姓名”)))
    相减 (取表项数 (), 1).置标题 (5, 到文本 (数据.读 (查询记录, “联系电话”)))
    相减 (取表项数 (), 1).置标题 (6, 到文本 (数据.读 (查询记录, “联系地址”)))
    相减 (取表项数 (), 1).置标题 (7, 到文本 (数据.读 (查询记录, “创建日期”)))
    .如果 (等于 (到文本 (数据.读 (查询记录, “是否禁用”)), “假”))
        相减 (取表项数 (), 1).置标题 (8, “正常”)
        相减 (取表项数 (), 1).置标题 (9, 到文本 (数据.读 (查询记录, “创建人员”)))
        相减 (取表项数 (), 1).置标题 (10, 到文本 (数据.读 (查询记录, “备注”)))
        赋值 (i, 相加 (i, 1))
        数据.到后一记录 (查询记录)
    .否则
        相减 (取表项数 (), 1).置标题 (8, “停用”)
        相减 (取表项数 (), 1).置标题 (9, 到文本 (数据.读 (查询记录, “创建人员”)))
        相减 (取表项数 (), 1).置标题 (10, 到文本 (数据.读 (查询记录, “备注”)))
        赋值 (i, 相加 (i, 1))
        数据.到后一记录 (查询记录)
    .如果结束
    
.判断循环尾 ()
数据.关闭记录集 (查询记录)
数据.关闭记录集 (权限查询)
数据.关闭记录集 (部门查询)
记录操作事件 (“工号设置被选择成功”)

.子程序 _添加_被单击, 空白型, , 
载入 (工号窗口, , 真)
记录操作事件 (“载入增加工号窗口”)

.子程序 _权限设置_被选择, 空白型, , 
.局部变量 t, 整数型, , , 

记录操作事件 (“权限设置登陆成功”)
赋值 (., 6)
清空 ()
赋值 (.标题, “修 改”)
赋值 (.禁止, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.内容, “”)

赋值 (查询语句, “select count(*) from 权限类型 where 是否禁用=0 and 权限类型<>'超级管理员'”)
数据.关闭记录集 (查询记录)
赋值 (查询记录, 数据.查询 (查询语句))
赋值 (t, 数据.读 (查询记录, 1))
数据.关闭记录集 (查询记录)
赋值 (查询语句, “select * from 权限类型 where 是否禁用=0 and 权限类型<>'超级管理员'”)
赋值 (查询记录, 数据.查询 (查询语句))
数据.到首记录 (查询记录)
.计次循环首 (t, )
    数据.读 (查询记录, 2).加入项目 ()
    数据.到后一记录 (查询记录)
.计次循环尾 ()
赋值 (.禁止, 真)

.子程序 _组合框权限设置_列表项被选择, 空白型, , 
.局部变量 t, 空白型, , , 
.局部变量 禁止项目, 文本型, , "0", 
.局部变量 父菜单句柄, 整数型, , , 
.局部变量 项目数, 整数型, , , 
.局部变量 菜单句柄, 整数型, , , 
.局部变量 父项目数, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 项目ID, 整数型, , , 
.局部变量 s, 整数型, , , 
.局部变量 项目名, 文本型, , , 
.局部变量 禁止项目1, 文本型, , "0", 
.局部变量 父菜单句柄1, 整数型, , , 
.局部变量 项目数1, 整数型, , , 
.局部变量 菜单句柄1, 整数型, , , 
.局部变量 父项目数1, 整数型, , , 
.局部变量 项目ID1, 整数型, , , 
.局部变量 s1, 整数型, , , 
.局部变量 项目名1, 文本型, , , 
.局部变量 禁止项目2, 文本型, , "0", 
.局部变量 父菜单句柄2, 整数型, , , 
.局部变量 项目数2, 整数型, , , 
.局部变量 菜单句柄2, 整数型, , , 
.局部变量 父项目数2, 整数型, , , 
.局部变量 项目ID2, 整数型, , , 
.局部变量 s2, 整数型, , , 
.局部变量 项目名2, 文本型, , , 
.局部变量 起始位置, 整数型, , , 
.局部变量 中间位置, 整数型, , , 
.局部变量 禁止项目3, 文本型, , "0", 
.局部变量 父菜单句柄3, 整数型, , , 
.局部变量 项目数3, 整数型, , , 
.局部变量 菜单句柄3, 整数型, , , 
.局部变量 父项目数3, 整数型, , , 
.局部变量 项目ID3, 整数型, , , 
.局部变量 s3, 整数型, , , 
.局部变量 项目名3, 文本型, , , 
.局部变量 起始位置1, 整数型, , , 
.局部变量 中间位置1, 整数型, , , 
.局部变量 禁止项目4, 文本型, , "0", 
.局部变量 父菜单句柄4, 整数型, , , 
.局部变量 项目数4, 整数型, , , 
.局部变量 菜单句柄4, 整数型, , , 
.局部变量 父项目数4, 整数型, , , 
.局部变量 项目ID4, 整数型, , , 
.局部变量 s4, 整数型, , , 
.局部变量 项目名4, 文本型, , , 
.局部变量 起始位置4, 整数型, , , 
.局部变量 中间位置4, 整数型, , , 

清空 ()
清空 ()
清空 ()
清空 ()
清空 ()
 ' 初始菜单 ()
赋值 (查询语句, 相加 (“select * from 权限类型 where 权限类型='”, .取项目文本 (.现行选中项), “'”))
赋值 (查询记录, 数据.查询 (查询语句))
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
数据.到首记录 (查询记录)
赋值 (父菜单句柄, 取父菜单句柄 (_启动窗口.取窗口句柄 ()))
赋值 (菜单句柄, 取弹出菜句柄 (父菜单句柄, 0))
赋值 (项目数, 取菜单项目数 (菜单句柄))
赋值 (禁止项目, 分割文本 (数据.读 (查询记录, 3), “,”, 项目数))
.计次循环首 (项目数, s)
    赋值 (项目ID, 取项目ID (菜单句柄, 相减 (s, 1)))
    赋值 (项目名, 取空白文本 (50))
    项目名.加入项目 (取菜单项名 (菜单句柄, 项目ID, 项目名, 51, 2))
    .计次循环首 (项目数, s)
        .如果真 (等于 (禁止项目 [s], “0”))
            相减 (s, 1).选中项目 ()
             ' 设置菜单 (父菜单句柄, 项目ID, 4)
        .如果真结束
        
    .计次循环尾 ()
.计次循环尾 ()
赋值 (父菜单句柄1, 取父菜单句柄 (_启动窗口.取窗口句柄 ()))
赋值 (菜单句柄1, 取弹出菜句柄 (父菜单句柄1, 1))
赋值 (项目数1, 取菜单项目数 (菜单句柄1))
赋值 (禁止项目1, 分割文本 (取文本中间 (数据.读 (查询记录, 3), 相加 (项目数, 项目数, 1), 相加 (项目数1, 项目数1)), “,”, 项目数1))
.计次循环首 (项目数1, s1)
    赋值 (项目ID1, 取项目ID (菜单句柄1, 相减 (s1, 1)))
    赋值 (项目名1, 取空白文本 (50))
    项目名1.加入项目 (取菜单项名 (菜单句柄1, 项目ID1, 项目名1, 51, 2))
    .计次循环首 (项目数1, s1)
        .如果真 (等于 (禁止项目1 [s1], “0”))
            相减 (s1, 1).选中项目 ()
             ' 设置菜单 (父菜单句柄, 项目ID, 4)
        .如果真结束
        
    .计次循环尾 ()
.计次循环尾 ()
赋值 (父菜单句柄2, 取父菜单句柄 (_启动窗口.取窗口句柄 ()))
赋值 (菜单句柄2, 取弹出菜句柄 (父菜单句柄2, 2))
赋值 (项目数2, 取菜单项目数 (菜单句柄2))
赋值 (起始位置, 相加 (到整数 (相减 (相加 (相减 (相乘 (项目数, 2), 1), 相乘 (项目数1, 2)), 1)), 3))
赋值 (中间位置, 相减 (相乘 (项目数2, 2), 1))
赋值 (禁止项目2, 分割文本 (取文本中间 (数据.读 (查询记录, 3), 起始位置, 中间位置), “,”, 项目数2))
.计次循环首 (项目数2, s2)
    赋值 (项目ID2, 取项目ID (菜单句柄2, 相减 (s2, 1)))
    赋值 (项目名2, 取空白文本 (50))
    项目名2.加入项目 (取菜单项名 (菜单句柄2, 项目ID2, 项目名2, 51, 2))
    .计次循环首 (项目数2, s2)
        .如果真 (等于 (禁止项目2 [s2], “0”))
            相减 (s2, 1).选中项目 ()
             ' 设置菜单 (父菜单句柄, 项目ID, 4)
        .如果真结束
        
    .计次循环尾 ()
.计次循环尾 ()
赋值 (父菜单句柄3, 取父菜单句柄 (_启动窗口.取窗口句柄 ()))
赋值 (菜单句柄3, 取弹出菜句柄 (父菜单句柄3, 3))
赋值 (项目数3, 取菜单项目数 (菜单句柄3))
赋值 (起始位置1, 相加 (到整数 (相减 (相加 (相减 (相加 (相减 (相乘 (项目数, 2), 1), 相乘 (项目数1, 2)), 1), 相乘 (项目数2, 2)), 1)), 4))
赋值 (中间位置1, 相减 (相乘 (项目数3, 2), 1))
赋值 (禁止项目3, 分割文本 (取文本中间 (数据.读 (查询记录, 3), 起始位置1, 中间位置1), “,”, 项目数3))
.计次循环首 (项目数3, s3)
    赋值 (项目ID3, 取项目ID (菜单句柄3, 相减 (s3, 1)))
    赋值 (项目名3, 取空白文本 (50))
    项目名3.加入项目 (取菜单项名 (菜单句柄3, 项目ID3, 项目名3, 51, 2))
    .计次循环首 (项目数3, s3)
        .如果真 (等于 (禁止项目3 [s3], “0”))
            相减 (s3, 1).选中项目 ()
        .如果真结束
        
    .计次循环尾 ()
.计次循环尾 ()
赋值 (父菜单句柄4, 取父菜单句柄 (_启动窗口.取窗口句柄 ()))
赋值 (菜单句柄4, 取弹出菜句柄 (父菜单句柄4, 4))
赋值 (项目数4, 取菜单项目数 (菜单句柄4))
赋值 (起始位置4)

.子程序 _修改权限_被单击, 空白型, , 
.局部变量 权限脚本, 文本型, , , 
.局部变量 i, 整数型, , , 
.局部变量 项目, 整数型, , , 
.局部变量 权限记录, 整数型, , , 
.局部变量 权限脚本1, 文本型, , , 
.局部变量 权限脚本2, 文本型, , , 
.局部变量 权限记录1, 整数型, , , 

.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “超级管理员”)))
    信息框 (“请选择要修改的权限组!”, 0, )
    返回 ()
.如果真结束
.如果 (等于 (.标题, “修 改”))
    赋值 (.禁止, 假)
    赋值 (.标题, “提交”)
    赋值 (.禁止, 真)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
.否则
    赋值 (.标题, “修 改”)
    赋值 (.禁止, 假)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.内容, “”)
    .计次循环首 (取项目数 (), 项目)
        .如果 (等于 (相减 (项目, 1).是否被选中 (), 真))
            赋值 (i, 0)
            到文本 (i).加入文本 (“,”)
        .否则
            赋值 (i, 1)
            到文本 (i).加入文本 (“,”)
        .如果结束
        
    .计次循环尾 ()
    .计次循环首 (取项目数 (), 项目)
        .如果 (等于 (相减 (项目, 1).是否被选中 (), 真))
            赋值 (i, 0)
            到文本 (i).加入文本 (“,”)
        .否则
            赋值 (i, 1)
            到文本 (i).加入文本 (“,”)
        .如果结束
        
    .计次循环尾 ()
    .计次循环首 (取项目数 (), 项目)
        .如果 (等于 (相减 (项目, 1).是否被选中 (), 真))
            赋值 (i, 0)
            到文本 (i).加入文本 (“,”)
        .否则
            赋值 (i, 1)
            到文本 (i).加入文本 (“,”)
        .如果结束
        
    .计次循环尾 ()
    .计次循环首 (取项目数 (), 项目)
        .如果 (等于 (相减 (项目, 1).是否被选中 (), 真))
            赋值 (i, 0)
            到文本 (i).加入文本 (“,”)
        .否则
            赋值 (i, 1)
            到文本 (i).加入文本 (“,”)
        .如果结束
        
    .计次循环尾 ()
    .计次循环首 (取项目数 (), 项目)
        .如果 (等于 (相减 (项目, 1).是否被选中 (), 真))
            赋值 (i, 0)
            到文本 (i).加入文本 (“,”)
        .否则
            赋值 (i, 1)
            到文本 (i).加入文本 (“,”)
        .如果结束
        
    .计次循环尾 ()
    赋值 (权限脚本, 相加 (“update 权限类型 set 权限设置='”, .内容, “' where 权限类型='”, .内容, “'”))
    赋值 (权限脚本1, 相加 (“select * from 权限类型 where 权限类型='”, .内容, “'”))
    赋值 (权限记录, 数据.查询 (权限脚本1))
    赋值 (权限脚本2, 相加 (“select * from  用户资料 where 权限='”, 到文本 (数据.读 (权限记录, 3)), “'”))
    赋值 (权限记录1, 数据.查询 (权限脚本2))
    数据.到首记录 (权限记录1)
    .判断循环首 (等于 (数据.尾记录后 (权限记录1), 假))
        数据.执行 (相加 (“update 用户资料 set 权限='”, .内容, “' where 工号='”, 到文本 (数据.读 (权限记录1, 2)), “'”), )
        数据.到后一记录 (权限记录1)
    .判断循环尾 ()
    .如果 (等于 (数据.执行 (权限脚本, ), 真))
        信息框 (“修改成功!”, 0, )
        记录操作事件 (相加 (.内容, “权限修改成功”))
         ' 数据.关闭记录集 ()
    .否则
        信息框 (“权限修改失败,请重试!”, 0, )
    .如果结束
    数据.关闭记录集 (权限记录)
    数据.关闭记录集 (权限记录1)
    
.如果结束


.子程序 _赠送话费查询_被选择, 空白型, , 
.局部变量 nian1, 整数型, , , 
.局部变量 yue1, 整数型, , , 

赋值 (., 9)
清空 ()
赋值 (.内容, “”)
赋值 (.现行选中项, -1)
清空 ()
未知支持库函数_57 ()
赋值 (.今天, 取现行时间 ())
赋值 (nian1, 取年份 (到时间 (.今天)))
.判断循环首 (小于或等于 (yue1, 11))
    赋值 (yue1, 相加 (yue1, 1))
    .判断开始 (大于 (yue1, 9))
        .判断开始 (小于或等于 (yue1, 取月份 (到时间 (.今天))))
            相加 (到文本 (nian1), 到文本 (yue1)).加入项目 ()
        .默认
            
        .判断结束
        
    .判断 (小于或等于 (yue1, 取月份 (到时间 (.今天))))
        相加 (到文本 (nian1), “0”, 到文本 (yue1)).加入项目 ()
    .默认
        
    .判断结束
    
.判断循环尾 ()


.子程序 _浏览1_被单击, 空白型, , 
.局部变量 文本, 文本型, , , 
.局部变量 文本行, 文本型, , "0", 
.局部变量 变量, 整数型, , , 
.局部变量 文本列, 文本型, , "0", 
.局部变量 KK, 整数型, , , 
.局部变量 循环变量1, 整数型, , , 
.局部变量 循环变量2, 整数型, , , 
.局部变量 字段类型, 整数型, , , 
.局部变量 H, 整数型, , , 

清空 ()
未知支持库函数_57 ()
赋值 (.过滤器, “文本文件(*.TXT)|*.txt”)
赋值 (.类型, 0)
.如果真 (打开 ())
    赋值 (.内容, .文件名)
    赋值 (文本, 到文本 (读入文件 (.文件名))) ' 把 文本文件 替换成他的路径
    赋值 (文本行, 分割文本 (文本, #换行符, ))
    置等待鼠标 ()
    .变量循环首 (1, 取数组成员数 (文本行), 1, 变量)
        .判断循环首 (不等于 (寻找文本 (文本行 [变量], 字符 (11), , 假), -1))
            赋值 (文本行 [变量], 子文本替换 (文本行 [变量], 字符 (11), 字符 (11), , , 真))
        .判断循环尾 ()
        重定义数组 (文本列, 假, 0)
        赋值 (文本列, 分割文本 (文本行 [变量], 字符 (11), )) ' 中间的空格要与文本对应
        .变量循环首 (相加 (取数组成员数 (文本列), 1), 1, 1, KK)
            赋值 (文本列 [KK], “”)
        .变量循环尾 ()
        加记录 (文本列 [1])
    .变量循环尾 ()
    恢复鼠标 ()
    赋值 (., 0)
    赋值 (., 0)
    赋值 (., 相加 (取记录数 (), 1))
    到首记录 ()
    .计次循环首 (取记录数 (), 循环变量1)
        .计次循环首 (取字段数 (), 循环变量2)
            赋值 (H, 相加 (H, 1))
            循环变量1.未知支持库函数_9 (循环变量2, #., 到文本 (读 (循环变量2)))
            循环变量1.未知支持库函数_9 (相减 (循环变量2, 1), #., 到文本 (H))
        .计次循环尾 ()
        跳过 ()
    .计次循环尾 ()
    0.未知支持库函数_9 (0, #., “序号”)
    0.未知支持库函数_32 (30)
    0.未知支持库函数_9 (1, #., “手机号码”)
    0.未知支持库函数_25 (0, 相减 (., .), 6, #.)
    1.未知支持库函数_32 (72)
    0.未知支持库函数_9 (2, #., “用户姓名”)
    2.未知支持库函数_32 (100)
    0.未知支持库函数_9 (3, #., “入网套餐”)
    3.未知支持库函数_32 (140)
    0.未知支持库函数_9 (4, #., “赠送话费”)
    4.未知支持库函数_32 (70)
    0.未知支持库函数_9 (5, #., “入网日期”)
    5.未知支持库函数_32 (130)
    0.未知支持库函数_9 (6, #., “状态”)
    6.未知支持库函数_32 (100)
    0.未知支持库函数_9 (7, #., “备注”)
    7.未知支持库函数_32 (100)
    0.未知支持库函数_9 (8, #., “备注1”)
    8.未知支持库函数_32 (100)
    关闭 (.文件名)
.如果真结束


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 记录集1, 整数型, , , 
.局部变量 套餐记录1, 整数型, , , 
.局部变量 taocan2, 文本型, , , 
.局部变量 taocan3, 文本型, , , 
.局部变量 ruwangtc2, 文本型, , , 
.局部变量 STATUS1, 文本型, , , 
.局部变量 状态记录1, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 循环变量1, 整数型, , , 
.局部变量 num, 文本型, , , 
.局部变量 zhut1, 文本型, , , 

赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
.判断开始 (等于 (.内容, “”))
    信息框 (“请选择查询月份!”, 0, “提示信息”)
    赋值 (., 假)
    赋值 (.可视, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    返回 ()
.判断 (等于 (.内容, “”))
    信息框 (“请导入文本文件!”, 0, “提示信息”)
    赋值 (., 假)
    赋值 (.可视, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    返回 ()
.默认
    赋值 (.可视, 真)
    赋值 (.位置, 1)
    赋值 (计次, 取记录数 ())
    .计次循环首 (计次, 循环变量1)
        赋值 (., 真)
        赋值 (.位置, 相加 (.位置, 1))
        赋值 (.最大位置, 计次)
        赋值 (num, 循环变量1.未知支持库函数_10 (1))
        赋值 (.标题, 到文本 (num))
        处理事件 ()
        赋值 (记录集1, 外部数据.查询 (相加 (“SELECT DISTINCT CUSTOMER_CREDIT, BB_SERVICE_RELATION_T_314.SERVICE_KIND,SERVICE_FAVOUR_ID,SERVICE_ID,SUM(FEE1+FEE2+FEE3+FEE4+FEE11+FEE12+FEE13+FEE14) AS HUAFEI,FIRST_NAME,COMM_ADDRESS,HOME_PHONE,SERVICE_START_DATE,NOTE,BB_SERVICE_RELATION_T_314.SERVING_STATUS,BP FROM BF_GATHER_FEE_T_314_”, .内容, “,BB_SERVICE_RELATION_T_314,BB_CUSTOMER_INFO_T_314 WHERE BB_SERVICE_RELATION_T_314.USER_ID=BF_GATHER_FEE_T_314_”, .内容, “.USER_ID AND BB_CUSTOMER_INFO_T_314.CUSTOMER_ID=BF_GATHER_FEE_T_314_”, .内容, “.CUSTOMER_ID AND SERVICE_ID='”, num, “' AND BF_GATHER_FEE_T_314_”, .内容, “.FEE_KIND='384' AND BB_SERVICE_RELATION_T_314.SERVICE_KIND IN(8,9) GROUP BY SERVICE_ID,FIRST_NAME,COMM_ADDRESS,HOME_PHONE,SERVICE_START_DATE,SERVICE_FAVOUR_ID,BB_SERVICE_RELATION_T_314.SERVICE_KIND,NOTE,BB_SERVICE_RELATION_T_314.SERVING_STATUS,CUSTOMER_CREDIT,BP”)))
        赋值 (taocan2, 到文本 (外部数据.读 (记录集1, “SERVICE_FAVOUR_ID”)))
        赋值 (taocan3, 到文本 (外部数据.读 (记录集1, “SERVICE_KIND”)))
        赋值 (套餐记录1, 外部数据.查询 (相加 (“select * from PM_SUBPRODUCT_INFO_T where F_SUBPRODUCT_ID= '”, taocan2, “' and F_USE_CITY=314 and F_SERVICE_KIND='”, taocan3, “'”)))
        赋值 (ruwangtc2, 到文本 (外部数据.读 (套餐记录1, “F_SUBPRODUCT_NAME”)))
        赋值 (zhut1, 到文本 (外部数据.读 (记录集1, “SERVING_STATUS”)))
        赋值 (状态记录1, 外部数据.查询 (相加 (“select * from BB_SERVING_STATUS_T where kind= '”, zhut1, “' ”)))
        赋值 (STATUS1, 到文本 (外部数据.读 (状态记录1, “NAME”)))
        循环变量1.未知支持库函数_9 (2, #., 到文本 (外部数据.读 (记录集1, “FIRST_NAME”)))
        循环变量1.未知支持库函数_9 (3, #., ruwangtc2)
        循环变量1.未知支持库函数_9 (4, #., 到文本 (外部数据.读 (记录集1, “HUAFEI”)))
        循环变量1.未知支持库函数_9 (5, #., 到文本 (外部数据.读 (记录集1, “SERVICE_START_DATE”)))
        循环变量1.未知支持库函数_9 (6, #., STATUS1)
        循环变量1.未知支持库函数_9 (7, #., 到文本 (外部数据.读 (记录集1, “NOTE”)))
        循环变量1.未知支持库函数_9 (8, #., 到文本 (外部数据.读 (记录集1, “BP”)))
        跳过 ()
        外部数据.关闭记录集 (记录集1)
        外部数据.关闭记录集 (套餐记录1)
        外部数据.关闭记录集 (状态记录1)
    .计次循环尾 ()
    赋值 (., 假)
    赋值 (.可视, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    记录操作事件 (相加 (.内容, “赠送话费统计成功”))
.判断结束
返回 ()


.子程序 _导出按钮1_被单击, 空白型, , 
.局部变量 单元格对象, 对象, , , 

.判断开始 (等于 (.内容, “”))
    信息框 (“请导入文本文件!”, 0, “提示信息”)
    返回 ()
.默认
    .如果真 (并且 (等于 (., 0), 等于 (., 0)))
        返回 ()
    .如果真结束
    .如果真 (等于 (未知支持库函数_0 (), 假))
        信息框 (“Excel程序创建失败！ ”, 0, )
        返回 ()
    .如果真结束
    .如果真 (等于 (.未知支持库函数_6 (), 假))
        信息框 (“Excel工作簿连接Excel程序失败！ ”, 0, )
        返回 ()
    .如果真结束
    赋值 (.初始目录, 取运行目录 ())
    赋值 (.过滤器, “Excel工作簿|*.xls”)
    赋值 (.类型, 1)
    赋值 (.默认文件后缀, “.xls”)
    .如果真 (等于 (打开 (), 假))
        未知支持库函数_1 ()
        未知支持库函数_15 ()
        未知支持库函数_11 (“Excel.exe”)
        返回 ()
    .如果真结束
    未知支持库函数_2 ()
    未知支持库函数_12 ()
    赋值 (., “a1”)
    赋值 (., “a1”)
    赋值 (单元格对象, 未知支持库函数_13 ())
    单元格对象.通用方法 (“PasteSpecial”, )
    .未知支持库函数_16 (.文件名)
    单元格对象.清除 ()
    未知支持库函数_1 ()
    未知支持库函数_15 ()
    未知支持库函数_11 (“Excel.exe”)
    信息框 (“导出完成”, 0, )
.判断结束


.子程序 _按钮4_被单击, 空白型, , 
赋值 (., 0)
赋值 (.内容, “”)
赋值 (.现行选中项, -1)
未知支持库函数_57 ()

.子程序 _放弃_被单击, 空白型, , 
赋值 (.标题, “修 改”)
赋值 (.禁止, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.内容, “”)

.子程序 _取消_被单击, 空白型, , 
赋值 (., 0)

.子程序 _增加_被单击, 空白型, , 
载入 (增加权限组, , 真)
记录操作事件 (“登陆增加权限组成功”)

.子程序 _单选框1_被单击, 空白型, , 
.局部变量 t, 空白型, , , 

.计次循环首 (取项目数 (), t)
    相减 (t, 1).选中项目 ()
.计次循环尾 ()

.子程序 _单选框2_被单击, 空白型, , 
.局部变量 t, 空白型, , , 

.计次循环首 (取项目数 (), t)
    相减 (t, 1).选中项目 (假)
.计次循环尾 ()

.子程序 _单选框3_被单击, 空白型, , 
.局部变量 t, 空白型, , , 

.计次循环首 (取项目数 (), t)
    相减 (t, 1).选中项目 ()
.计次循环尾 ()

.子程序 _单选框4_被单击, 空白型, , 
.局部变量 t, 空白型, , , 

.计次循环首 (取项目数 (), t)
    相减 (t, 1).选中项目 (假)
.计次循环尾 ()

.子程序 _单选框5_被单击, 空白型, , 
.局部变量 t, 空白型, , , 

.计次循环首 (取项目数 (), t)
    相减 (t, 1).选中项目 ()
.计次循环尾 ()

.子程序 _单选框6_被单击, 空白型, , 
.局部变量 t, 空白型, , , 

.计次循环首 (取项目数 (), t)
    相减 (t, 1).选中项目 (假)
.计次循环尾 ()

.子程序 _单选框7_被单击, 空白型, , 
.局部变量 t, 空白型, , , 

.计次循环首 (取项目数 (), t)
    相减 (t, 1).选中项目 ()
.计次循环尾 ()

.子程序 _单选框8_被单击, 空白型, , 
.局部变量 t, 空白型, , , 

.计次循环首 (取项目数 (), t)
    相减 (t, 1).选中项目 (假)
.计次循环尾 ()

.子程序 _单选框9_被单击, 空白型, , 
.局部变量 t, 空白型, , , 

.计次循环首 (取项目数 (), t)
    相减 (t, 1).选中项目 ()
.计次循环尾 ()

.子程序 _单选框10_被单击, 空白型, , 
.局部变量 t, 空白型, , , 

.计次循环首 (取项目数 (), t)
    相减 (t, 1).选中项目 (假)
.计次循环尾 ()

.子程序 _刷新_被单击, 空白型, , 
_工号设置_被选择 ()

.子程序 _工号列表框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (idd, .取标题 (., 1))
载入 (修改工号窗口, , 真)
记录操作事件 (相加 (“载入修改”, idd, “工号成功”))

.子程序 _地区设置_被选择, 空白型, , 
载入 (地区部门, , 真)
记录操作事件 (“载入增加部门成功”)

.子程序 _系统参数_被选择, 空白型, , 
.局部变量 权限类型, 整数型, , , 
.局部变量 地区类型, 整数型, , , 

赋值 (., 7)
记录操作事件 (“登陆系统参数修改”)
清空 ()
系统初始化 ()
赋值 (权限类型, 数据.查询 (“select * from 权限类型 where 权限类型<>'超级管理员'”))
数据.到首记录 (权限类型)
.判断循环首 (等于 (数据.尾记录后 (权限类型), 假))
    数据.读 (权限类型, 2).加入项目 ()
    数据.到后一记录 (权限类型)
.判断循环尾 ()
数据.关闭记录集 (权限类型)

清空 ()
赋值 (地区类型, 数据.查询 (“select distinct 地区 from 部门类型”))
数据.到首记录 (地区类型)
.判断循环首 (等于 (数据.尾记录后 (地区类型), 假))
    数据.读 (地区类型, “地区”).加入项目 ()
    数据.到后一记录 (地区类型)
.判断循环尾 ()
数据.关闭记录集 (地区类型)

.子程序 _权限组组合框_列表项被选择, 空白型, , 
.局部变量 权限类型1, 整数型, , , 

赋值 (权限类型1, 数据.查询 (相加 (“select * from 权限类型 where 权限类型='”, .内容, “'”)))
.如果 (等于 (数据.读 (权限类型1, 7), 真))
    赋值 (.标题, “停止使用”)
    赋值 (.选中, 真)
.否则
    赋值 (.标题, “正常使用”)
    赋值 (.选中, 假)
.如果结束
数据.关闭记录集 (权限类型1)

.子程序 _按钮5_被单击, 空白型, , 
.局部变量 i, 文本型, , , 
.局部变量 权限语句, 文本型, , , 

.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “超级管理员”)))
    信息框 (“请选择要修改的权限组!”, 0, )
    返回 ()
.如果真结束
.判断开始 (等于 (.选中, 真))
    赋值 (i, “1”)
    赋值 (权限语句, 相加 (“update 权限类型 set  是否禁用=”, i, “ where 权限类型='”, .内容, “'”))
.判断 (等于 (.选中, 假))
    赋值 (i, “0”)
    赋值 (权限语句, 相加 (“update 权限类型 set  是否禁用=”, i, “ where 权限类型='”, .内容, “'”))
.默认
    
.判断结束
.如果 (等于 (数据.执行 (权限语句, ), 假))
    信息框 (“执行失败，请重试！”, 0, )
    记录操作事件 (相加 (.内容, i, “修改失败”))
    返回 ()
.否则
    信息框 (“修改成功”, 0, )
    记录操作事件 (相加 (.内容, i, “修改成功”))
    _系统参数_被选择 ()
.如果结束



.子程序 _地区组合框_列表项被选择, 空白型, , 
.局部变量 n, 整数型, , , 
.局部变量 地区类型, 整数型, , , 

清空 ()
赋值 (地区类型, 数据.查询 (相加 (“select * from 地区类型 where 地区='”, .内容, “'”)))
.如果 (等于 (数据.读 (地区类型, “是否禁用”), 真))
    赋值 (.标题, “停止使用”)
    赋值 (.选中, 真)
.否则
    赋值 (.标题, “正常使用”)
    赋值 (.选中, 假)
.如果结束
数据.关闭记录集 (地区类型)

赋值 (查询语句, 相加 (“select count(*) from 部门类型 where 地区='”, .取项目文本 (.现行选中项), “'”))
数据.关闭记录集 (查询记录)
赋值 (查询记录, 数据.查询 (查询语句))
赋值 (n, 到整数 (数据.读 (查询记录, 1)))
数据.关闭记录集 (查询记录)
赋值 (查询语句, 相加 (“select * from 部门类型 where 地区='”, .取项目文本 (.现行选中项), “'”))
赋值 (查询记录, 数据.查询 (查询语句))
数据.到首记录 (查询记录)
.计次循环首 (n, )
    数据.读 (查询记录, “部门”).加入项目 ()
    数据.到后一记录 (查询记录)
.计次循环尾 ()

.子程序 _部门组合框_列表项被选择, 空白型, , 
.局部变量 部门类型, 整数型, , , 

赋值 (部门类型, 数据.查询 (相加 (“select * from 部门类型 where 部门='”, .取项目文本 (.现行选中项), “' and 地区='”, .内容, “'”)))
.如果 (等于 (数据.读 (部门类型, 8), 真))
    赋值 (.标题, “停止使用”)
    赋值 (.选中, 真)
.否则
    赋值 (.标题, “正常使用”)
    赋值 (.选中, 假)
.如果结束
数据.关闭记录集 (部门类型)

.子程序 _按钮6_被单击, 空白型, , 
.局部变量 i, 文本型, , , 
.局部变量 部门语句, 文本型, , , 

.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“请选择地区和部门!”, 0, )
    返回 ()
.如果真结束
.判断开始 (等于 (.选中, 真))
    赋值 (i, “1”)
    赋值 (部门语句, 相加 (“update 部门类型 set  是否禁用=”, i, “ where 部门='”, .内容, “' and 地区='”, .内容, “'”))
.判断 (等于 (.选中, 假))
    赋值 (i, “0”)
    赋值 (部门语句, 相加 (“update 部门类型 set  是否禁用=”, i, “ where 部门='”, .内容, “' and 地区='”, .内容, “'”))
.默认
    
.判断结束
.如果 (等于 (数据.执行 (部门语句, ), 假))
    信息框 (“执行失败，请重试！”, 0, )
    记录操作事件 (相加 (.内容, i, “修改失败”))
    返回 ()
.否则
    信息框 (“修改成功”, 0, )
    记录操作事件 (相加 (.内容, i, “修改成功”))
    _系统参数_被选择 ()
.如果结束


.子程序 _密码修改_被选择, 空白型, , 
载入 (修改密码, , 真)

.子程序 _按钮7_被单击, 空白型, , 
.局部变量 i, 文本型, , , 
.局部变量 地区语句, 文本型, , , 
.局部变量 部门记录, 文本型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请选择地区!”, 0, )
    返回 ()
.如果真结束
.判断开始 (等于 (.选中, 真))
    赋值 (i, “1”)
    赋值 (地区语句, 相加 (“update 地区类型 set  是否禁用=”, i, “ where 地区='”, .内容, “'”))
    赋值 (部门记录, 相加 (“update 部门类型 set 是否禁用=”, i, “ where  地区='”, .内容, “'”))
.判断 (等于 (.选中, 假))
    赋值 (i, “0”)
    
    赋值 (地区语句, 相加 (“update 地区类型 set  是否禁用=”, i, “ where 地区='”, .内容, “'”))
    赋值 (部门记录, 相加 (“update 部门类型 set 是否禁用=”, i, “ where  地区='”, .内容, “'”))
.默认
    
.判断结束
.如果 (等于 (数据.执行 (地区语句, ), 假))
    信息框 (“执行失败，请重试！”, 0, )
    记录操作事件 (相加 (.内容, i, “修改失败”))
    返回 ()
.否则
    .如果 (等于 (数据.执行 (部门记录, ), 假))
        信息框 (“执行失败，请重试！”, 0, )
        记录操作事件 (相加 (.内容, i, “修改失败”))
        返回 ()
    .否则
        信息框 (“修改成功”, 0, )
        记录操作事件 (相加 (.内容, i, “修改成功”))
        _系统参数_被选择 ()
    .如果结束
    
.如果结束


.子程序 __启动窗口_将被销毁, 空白型, , 
 ' 外部数据.关闭 ()
数据.关闭 ()

.子程序 _注册_被选择, 空白型, , 
载入 (注册未成功, , 真)


.子程序 _切换用户_被选择, 空白型, , 
载入 (登陆窗口, , 真)

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
.局部变量 句柄, 整数型, , , 

赋值 (句柄, _启动窗口.取窗口句柄 ())
.如果真 (等于 (提示信息框 (相加 (“确定要退出”, #左引号, #标题, #右引号, “吗？”), #标题, 33, , 句柄), 2))
    返回 (假)
.如果真结束
数据.执行 (相加 (“insert LOG (登陆工号,操作事件,权限组,退出时间,登陆IP) values ('”, 操作员, “','退出','”, 权限组, “',”, 到文本 (退出时间), “,'”, 登陆IP [1], “')”), )
返回 (真)


.窗口程序集 明细窗口程序集, , , 

.程序集变量 GSM1, 文本型, , , 
.程序集变量 GH1, 文本型, , , 
.程序集变量 GH, 文本型, , , 
.子程序 _明细_创建完毕, 空白型, , 
.局部变量 查询G记录, 整数型, , , 
.局部变量 查询G记录1, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 套餐记录1, 整数型, , , 
.局部变量 taocan2, 文本型, , , 
.局部变量 ruwangtc2, 文本型, , , 
.局部变量 taocan3, 文本型, , , 

赋值 (_启动窗口..可视, 假)
赋值 (.可视, 真)
赋值 (.位置, 1)
赋值 (.内容, _启动窗口.循环1 ())
赋值 (.内容, 相加 (_启动窗口., “至”, _启动窗口.))
0.未知支持库函数_9 (0, #., “序号”)
0.未知支持库函数_32 (40)
0.未知支持库函数_9 (1, #., “手机号码”)
0.未知支持库函数_25 (0, 相减 (., .), 6, #.)
1.未知支持库函数_32 (100)
0.未知支持库函数_9 (2, #., “入网日期”)
2.未知支持库函数_32 (200)
0.未知支持库函数_9 (3, #., “入网套餐”)
3.未知支持库函数_32 (200)
0.未知支持库函数_9 (4, #., “操作员”)
4.未知支持库函数_32 (70)
赋值 (GSM1, 相加 (“133”, “%”))
赋值 (GH, 相加 (“SX_”, “%”))
赋值 (GH1, 相加 (“sf_”, “%”))
赋值 (查询G记录, 外部数据.查询 (相加 (“SELECT * FROM BB_SERVICE_RELATION_T_314 WHERE source_id= '”, 取文本左边 (_启动窗口.循环1 (), 8), “' and not SERVICE_ID like  '”, GSM1, “' and to_char(SERVICE_START_DATE,'yyyy-mm-dd')>='”, _启动窗口., “' and to_char(SERVICE_START_DATE,'yyyy-mm-dd')<='”, _启动窗口., “' and SERVICE_KIND IN (8,9)”)))
赋值 (查询G记录1, 外部数据.查询 (相加 (“SELECT count(DISTINCT SERVICE_ID)行 FROM BB_SERVICE_RELATION_T_314 WHERE source_id= '”, 取文本左边 (_启动窗口.循环1 (), 8), “' and not SERVICE_ID like  '”, GSM1, “' and to_char(SERVICE_START_DATE,'yyyy-mm-dd')>='”, _启动窗口., “' and to_char(SERVICE_START_DATE,'yyyy-mm-dd')<='”, _启动窗口., “' and SERVICE_KIND IN (8,9)”)))
外部数据.到首记录 (查询G记录)
赋值 (., 相加 (到整数 (外部数据.读 (查询G记录1, “行”)), 1))
.判断循环首 (等于 (外部数据.尾记录后 (查询G记录), 假))
    赋值 (.位置, 相加 (.位置, 1))
    赋值 (.最大位置, 到整数 (外部数据.读 (查询G记录1, “行”)))
    处理事件 ()
    相加 (i, 1).未知支持库函数_9 (0, #., 相加 (i, 1))
    相加 (i, 1).未知支持库函数_9 (1, #., 到文本 (外部数据.读 (查询G记录, “SERVICE_ID”)))
    相加 (i, 1).未知支持库函数_9 (2, #., 到文本 (外部数据.读 (查询G记录, “SERVICE_START_DATE”)))
    赋值 (taocan2, 到文本 (外部数据.读 (查询G记录, “SERVICE_FAVOUR_ID”)))
    赋值 (taocan3, 到文本 (外部数据.读 (查询G记录, “SERVICE_KIND”)))
    赋值 (套餐记录1, 外部数据.查询 (相加 (“select * from PM_SUBPRODUCT_INFO_T where F_SUBPRODUCT_ID= '”, taocan2, “' and F_USE_CITY=314 and F_SERVICE_KIND='”, taocan3, “'”)))
    赋值 (ruwangtc2, 到文本 (外部数据.读 (套餐记录1, “F_SUBPRODUCT_NAME”)))
    相加 (i, 1).未知支持库函数_9 (3, #., ruwangtc2)
    相加 (i, 1).未知支持库函数_9 (4, #., 到文本 (外部数据.读 (查询G记录, “ACCEPT_PERSON”)))
    赋值 (i, 相加 (i, 1))
    外部数据.到后一记录 (查询G记录)
.判断循环尾 ()
赋值 (.可视, 假)
外部数据.关闭记录集 (查询G记录)
外部数据.关闭记录集 (查询G记录1)
外部数据.关闭记录集 (套餐记录1)


.子程序 _按钮1_被单击, 空白型, , 
明细.销毁 ()

.子程序 _单选框2_被单击, 空白型, , 
.局部变量 查询G记录, 整数型, , , 
.局部变量 查询G记录1, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 套餐记录1, 整数型, , , 
.局部变量 taocan2, 文本型, , , 
.局部变量 ruwangtc2, 文本型, , , 
.局部变量 taocan3, 文本型, , , 

赋值 (.可视, 真)
赋值 (.位置, 1)
赋值 (查询G记录, 外部数据.查询 (相加 (“SELECT * FROM BB_SERVICE_RELATION_T_314 WHERE source_id= '”, 取文本左边 (_启动窗口.循环1 (), 8), “' and SERVICE_ID like  '”, GSM1, “' and to_char(SERVICE_START_DATE,'yyyy-mm-dd')>='”, _启动窗口., “' and to_char(SERVICE_START_DATE,'yyyy-mm-dd')<='”, _启动窗口., “' and SERVICE_KIND IN (8,9)”)))
赋值 (查询G记录1, 外部数据.查询 (相加 (“SELECT count(DISTINCT SERVICE_ID)行 FROM BB_SERVICE_RELATION_T_314 WHERE source_id= '”, 取文本左边 (_启动窗口.循环1 (), 8), “' and SERVICE_ID like  '”, GSM1, “' and to_char(SERVICE_START_DATE,'yyyy-mm-dd')>='”, _启动窗口., “' and to_char(SERVICE_START_DATE,'yyyy-mm-dd')<='”, _启动窗口., “' and SERVICE_KIND IN (8,9)”)))
外部数据.到首记录 (查询G记录)
赋值 (., 相加 (到整数 (外部数据.读 (查询G记录1, “行”)), 1))
.判断循环首 (等于 (外部数据.尾记录后 (查询G记录), 假))
    赋值 (.位置, 相加 (.位置, 1))
    赋值 (.最大位置, 到整数 (外部数据.读 (查询G记录1, “行”)))
    处理事件 ()
    相加 (i, 1).未知支持库函数_9 (0, #., 相加 (i, 1))
    相加 (i, 1).未知支持库函数_9 (1, #., 到文本 (外部数据.读 (查询G记录, “SERVICE_ID”)))
    相加 (i, 1).未知支持库函数_9 (2, #., 到文本 (外部数据.读 (查询G记录, “SERVICE_START_DATE”)))
    赋值 (taocan2, 到文本 (外部数据.读 (查询G记录, “SERVICE_FAVOUR_ID”)))
    赋值 (taocan3, 到文本 (外部数据.读 (查询G记录, “SERVICE_KIND”)))
    赋值 (套餐记录1, 外部数据.查询 (相加 (“select * from PM_SUBPRODUCT_INFO_T where F_SUBPRODUCT_ID= '”, taocan2, “' and F_USE_CITY=314 and F_SERVICE_KIND='”, taocan3, “'”)))
    赋值 (ruwangtc2, 到文本 (外部数据.读 (套餐记录1, “F_SUBPRODUCT_NAME”)))
    相加 (i, 1).未知支持库函数_9 (3, #., ruwangtc2)
    相加 (i, 1).未知支持库函数_9 (4, #., 到文本 (外部数据.读 (查询G记录, “ACCEPT_PERSON”)))
    赋值 (i, 相加 (i, 1))
    外部数据.到后一记录 (查询G记录)
.判断循环尾 ()
赋值 (.可视, 假)
外部数据.关闭记录集 (查询G记录)
外部数据.关闭记录集 (查询G记录1)
外部数据.关闭记录集 (套餐记录1)

.子程序 _单选框1_被单击, 空白型, , 
_明细_创建完毕 ()

.窗口程序集 登陆窗口程序集, , , 

.程序集变量 llll, 空白型, , , 
.子程序 _登陆窗口_创建完毕, 空白型, , 
赋值 (llll, 1)
版本 ()
赋值 (.标题, a01)
赋值 (.标题, b01)
赋值 (.标题, e01)
赋值 (.内容, “”)
加密程序 ()

.子程序 _登陆_被单击, 空白型, , 
.局部变量 脚本, 文本型, , , 
.局部变量 权限检测9, 整数型, , , 
.局部变量 检测结果9, 整数型, , , 
.局部变量 加密, 文本型, , , 

赋值 (.内容, “”)
赋值 (脚本, 相加 (“select * from 用户资料 where 工号='”, .内容, “'”))
赋值 (记录集句柄一, 数据.查询 (脚本))
.判断开始 (等于 (数据.读 (记录集句柄一, 1), 0))
    .如果 (等于 (llll, 3))
        信息框 (“安全设置将关闭程序!”, 0, )
        记录操作事件 (相加 (.内容, “登陆失败”))
        结束 ()
    .否则
        信息框 (“登陆用户名不正确!请与管理员联系。”, 0, )
        记录操作事件 (相加 (.内容, “登陆失败”))
        赋值 (llll, 相加 (llll, 1))
    .如果结束
    
.默认
    数据.到首记录 (记录集句柄一)
    .判断开始 (等于 (数据.读 (记录集句柄一, 11), 真))
        .如果 (等于 (llll, 3))
            信息框 (“安全设置将关闭程序!”, 0, )
            记录操作事件 (“登陆失败！”)
            结束 ()
        .否则
            信息框 (“此工号已被停用!请与管理员联系!”, 0, )
            记录操作事件 (相加 (.内容, “停用导致登陆失败！”))
            赋值 (llll, 相加 (llll, 1))
        .如果结束
        
    .默认
        .判断循环首 (等于 (数据.尾记录后 (记录集句柄一), 假))
            置等待鼠标 ()
            .计次循环首 (取文本长度 (.内容), c001)
                赋值 (f001, 取文本中间 (.内容, c001, 1))
                赋值 (g001, 寻找文本 (a001, f001, 1, 假))
                赋值 (.内容, 相加 (.内容, 取文本中间 (b001, g001, 1)))
            .计次循环尾 ()
            赋值 (加密, .内容)
            .如果 (等于 (到文本 (数据.读 (记录集句柄一, “密码”)), 加密))
                赋值 (操作员, 到文本 (数据.读 (记录集句柄一, “工号”)))
                登陆检测 ()
                _启动窗口.置文本 (., 0, e01)
                _启动窗口.置文本 (., 1, 操作员)
                赋值 (权限检测9, 数据.查询 (相加 (“select * from 用户资料 where 工号='”, 操作员, “'”)))
                赋值 (检测结果9, 数据.查询 (相加 (“select * from 权限类型 where IDQ=”, 数据.读 (权限检测9, 5))))
                _启动窗口.置文本 (., 2, 到文本 (数据.读 (检测结果9, 2)))
                _启动窗口.置文本 (., 3, 到文本 (数据.读 (权限检测9, “姓名”)))
                _启动窗口.置文本 (., 5, b01)
                _启动窗口.置文本 (., 6, a01)
                记录操作事件 (“登陆成功”)
                销毁 ()
            .否则
                .如果 (等于 (llll, 3))
                    信息框 (“安全设置将关闭程序!”, 0, )
                    记录操作事件 (相加 (.内容, “登陆失败”))
                    结束 ()
                .否则
                    信息框 (“登陆密码不正确!”, 0, )
                    记录操作事件 (相加 (.内容, “密码不正确”))
                    赋值 (llll, 相加 (llll, 1))
                .如果结束
                
            .如果结束
            数据.到后一记录 (记录集句柄一)
        .判断循环尾 ()
    .判断结束
    
.判断结束


.子程序 _按钮_被单击, 空白型, , 
.如果 (等于 (操作员, “';hbsxxmm”))
    结束 ()
    数据.关闭 ()
.否则
    登陆窗口.销毁 ()
     ' 外部数据.关闭 ()
    
.如果结束



.窗口程序集 工号窗口程序集, , , 

.子程序 _工号窗口_创建完毕, 空白型, , 
.局部变量 T, 空白型, , , 
.局部变量 H, 整数型, , , 

加密程序 ()
赋值 (.内容, “”)
赋值 (查询语句, “select count(*) from 权限类型 where 权限类型<>'超级管理员'”)
数据.关闭记录集 (查询记录)
赋值 (查询记录, 数据.查询 (查询语句))
赋值 (T, 数据.读 (查询记录, 1))
数据.关闭记录集 (查询记录)
赋值 (查询语句, “select * from 权限类型 where 权限类型<>'超级管理员'”)
赋值 (查询记录, 数据.查询 (查询语句))
数据.到首记录 (查询记录)
.计次循环首 (T, )
    数据.读 (查询记录, 2).加入项目 ()
    数据.到后一记录 (查询记录)
.计次循环尾 ()
赋值 (查询语句, “select count(DISTINCT 地区) from 地区类型”)
数据.关闭记录集 (查询记录)
赋值 (查询记录, 数据.查询 (查询语句))
赋值 (H, 到整数 (数据.读 (查询记录, 1)))
数据.关闭记录集 (查询记录)
赋值 (查询语句, “select distinct 地区 from 部门类型”)
赋值 (查询记录, 数据.查询 (查询语句))
数据.到首记录 (查询记录)
.计次循环首 (H, )
    数据.读 (查询记录, “地区”).加入项目 ()
    数据.到后一记录 (查询记录)
.计次循环尾 ()


.子程序 _地区组合框_列表项被选择, 空白型, , 
.局部变量 n, 整数型, , , 

清空 ()
赋值 (查询语句, 相加 (“select count(*) from 部门类型 where 地区='”, .取项目文本 (.现行选中项), “' and 是否禁用=0”))
数据.关闭记录集 (查询记录)
赋值 (查询记录, 数据.查询 (查询语句))
赋值 (n, 到整数 (数据.读 (查询记录, 1)))
数据.关闭记录集 (查询记录)
赋值 (查询语句, 相加 (“select * from 部门类型 where 地区='”, .取项目文本 (.现行选中项), “' and 是否禁用=0”))
赋值 (查询记录, 数据.查询 (查询语句))
数据.到首记录 (查询记录)
.计次循环首 (n, )
    数据.读 (查询记录, “部门”).加入项目 ()
    数据.到后一记录 (查询记录)
.计次循环尾 ()

.子程序 _提交_被单击, 空白型, , 
.局部变量 工号, 文本型, , , 
.局部变量 权限记录集, 整数型, , , 
.局部变量 部门记录集, 整数型, , , 
.局部变量 地区部门, 文本型, , , 
.局部变量 加密, 文本型, , , 

赋值 (工号, 相加 (“hbsx_”, .内容))
.如果 (或者 (等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“请检查输入内容是否正确！”, 0, )
.否则
    赋值 (查询语句, 相加 (“select count(*) from 用户资料 where 工号='”, 工号, “'”))
    数据.关闭记录集 (查询记录)
    赋值 (查询记录, 数据.查询 (查询语句))
    数据.到首记录 (查询记录)
    .如果 (大于 (数据.读 (查询记录, 1), 0))
        信息框 (“添加的工号已经存在！”, 0, )
        数据.关闭记录集 (查询记录)
        返回 ()
    .否则
        数据.关闭记录集 (查询记录)
        赋值 (权限记录集, 数据.查询 (相加 (“select * from 权限类型 where 权限类型='”, .取项目文本 (.现行选中项), “'”)))
        .判断开始 (等于 (数据.读 (权限记录集, 1), 0))
            信息框 (“此权限可能已被删除!请与管理员联系!!”, 0, )
            返回 ()
        .默认
            赋值 (部门记录集, 数据.查询 (相加 (“select * from 部门类型 where 部门='”, .取项目文本 (.现行选中项), “' and 地区='”, .取项目文本 (.现行选中项), “'”)))
            .判断开始 (等于 (数据.读 (部门记录集, 1), 0))
                信息框 (“此部门可能已被删除!请与管理员联系!!”, 0, )
                返回 ()
            .默认
                .计次循环首 (取文本长度 (“aaaaaa”), c001)
                    赋值 (f001, 取文本中间 (“aaaaaa”, c001, 1))
                    赋值 (g001, 寻找文本 (a001, f001, 1, 假))
                    赋值 (.内容, 相加 (.内容, 取文本中间 (b001, g001, 1)))
                .计次循环尾 ()
                赋值 (加密, .内容)
                赋值 (地区部门, 相加 (到文本 (数据.读 (部门记录集, 3)), “,”, 到文本 (数据.读 (部门记录集, 5))))
                赋值 (查询语句, 相加 (“insert 用户资料 (工号,密码,权限,权限组,部门,姓名,联系电话,联系地址,创建人员,是否禁用,备注) values ('”, 工号, “','”, 加密, “','”, 到文本 (数据.读 (权限记录集, 3)), “','”, 到文本 (数据.读 (权限记录集, “IDQ”)), “','”, 地区部门, “','”, .内容, “','”, .内容, “','”, .内容, “','”, 操作员, “', 0 ,'”, .内容, “')”))
                .如果 (等于 (数据.执行 (查询语句, ), 假))
                    信息框 (“执行失败，请重试！”, 0, )
                    记录操作事件 (相加 (查询语句, “执行失败”))
                    赋值 (.内容, “”)
                    返回 ()
                .否则
                    信息框 (相加 (“添加成功！工号为:hbsx_”, .内容, “  初始密码为：aaaaaa”), 0, )
                    记录操作事件 (相加 (“执行成功”, 查询语句))
                    数据.关闭记录集 (查询记录)
                    数据.关闭记录集 (权限记录集)
                    数据.关闭记录集 (部门记录集)
                    赋值 (.内容, “”)
                    _工号设置_被选择 ()
                .如果结束
                
            .判断结束
            
        .判断结束
        
    .如果结束
    
.如果结束


.子程序 _取消_被单击, 空白型, , 
数据.关闭记录集 (查询记录)
销毁 ()

.子程序 _重填_被单击, 空白型, , 
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容)
连续赋值 (-1, .现行选中项, .现行选中项, .现行选中项)


.窗口程序集 增加权限程序集, , , 

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 权限记录, 整数型, , , 
.局部变量 n, 整数型, , , 
.局部变量 父菜单句柄, 整数型, , , 
.局部变量 菜单句柄, 整数型, , , 
.局部变量 项目数, 整数型, , , 
.局部变量 父项目数, 整数型, , , 
.局部变量 i, 整数型, , , 

.如果 (等于 (.内容, “”))
    信息框 (“名称不能为空”, 0, )
.否则
    赋值 (权限记录, 数据.查询 (相加 (“select * from 权限类型 where 权限类型='”, .内容, “'”)))
    .如果 (大于 (数据.读 (权限记录, 1), 0))
        信息框 (“权限组已经存在!”, 0, )
        返回 ()
    .否则
        赋值 (父菜单句柄, 取父菜单句柄 (_启动窗口.取窗口句柄 ()))
        赋值 (父项目数, 取菜单项目数 (父菜单句柄))
        .计次循环首 (父项目数, i)
            赋值 (菜单句柄, 取弹出菜句柄 (父菜单句柄, 相减 (i, 1)))
            赋值 (n, 取菜单项目数 (菜单句柄))
            .计次循环首 (n, )
                “1”.加入文本 (“,”)
            .计次循环尾 ()
        .计次循环尾 ()
        .如果 (等于 (数据.执行 (相加 (“insert 权限类型 (权限类型,权限设置,权限说明,创建人员) values ('”, .内容, “','”, .内容, “','”, .内容, “','”, 操作员, “')”), ), 真))
            信息框 (“增加成功!”, 0, )
            记录操作事件 (相加 (.内容, “权限组增加成功”))
            数据.关闭记录集 (权限记录)
            增加权限组.销毁 ()
            赋值 (_启动窗口.., 6)
        .否则
            信息框 (“增加失败!”, 0, )
            记录操作事件 (相加 (.内容, “权限组增加失败”))
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
增加权限组.销毁 ()

.窗口程序集 修改工号窗口程序集, , , 

.子程序 _修改工号窗口_创建完毕, 空白型, , 
.局部变量 T, 整数型, , , 
.局部变量 H, 整数型, , , 
.局部变量 权限查询, 整数型, , , 
.局部变量 地区查询, 整数型, , , 
.局部变量 文本, 文本型, , "0", 
.局部变量 文本内容, 整数型, , , 

加密程序 ()
赋值 (.内容, “”)
赋值 (查询语句, “select count(*) from 权限类型 where 权限类型<>'超级管理员'”)
数据.关闭记录集 (查询记录)
赋值 (查询记录, 数据.查询 (查询语句))
赋值 (T, 数据.读 (查询记录, 1))
数据.关闭记录集 (查询记录)
赋值 (查询语句, “select * from 权限类型 where 权限类型<>'超级管理员'”)
赋值 (查询记录, 数据.查询 (查询语句))
数据.到首记录 (查询记录)
.计次循环首 (T, )
    数据.读 (查询记录, 2).加入项目 ()
    数据.到后一记录 (查询记录)
.计次循环尾 ()
赋值 (查询语句, “select count(DISTINCT 地区) from 地区类型”)
数据.关闭记录集 (查询记录)
赋值 (查询记录, 数据.查询 (查询语句))
赋值 (H, 到整数 (数据.读 (查询记录, 1)))
数据.关闭记录集 (查询记录)
赋值 (查询语句, “select distinct 地区 from 部门类型”)
赋值 (查询记录, 数据.查询 (查询语句))
数据.到首记录 (查询记录)
.计次循环首 (H, )
    数据.读 (查询记录, “地区”).加入项目 ()
    数据.到后一记录 (查询记录)
.计次循环尾 ()

赋值 (rsc, 数据.查询 (相加 (“select * from 用户资料 where 工号 ='”, idd, “'”)))
数据.重新查询 (rsc)
赋值 (.内容, 到文本 (数据.读 (rsc, 2)))
赋值 (权限查询, 数据.查询 (相加 (“select * from 权限类型 where IDQ=”, 数据.读 (rsc, 5))))
赋值 (.内容, 到文本 (数据.读 (权限查询, 2)))
赋值 (文本, 分割文本 (到文本 (数据.读 (rsc, 6)), “,”, 2))
 ' 文本内容 ＝ 到数值 ()
赋值 (地区查询, 数据.查询 (相加 (“select * from 部门类型 where 地区代码= ”, 文本 [1], “ and 部门代码=”, 文本 [2])))
赋值 (.内容, 到文本 (数据.读 (地区查询, 2)))
赋值 (.内容, 到文本 (数据.读 (地区查询, 4)))
赋值 (.内容, 到文本 (数据.读 (rsc, 3)))
赋值 (h001, 取文本长度 (.内容))
.计次循环首 (取文本长度 (.内容), c001)
    赋值 (f001, 取文本中间 (.内容, c001, 1))
    赋值 (g001, 寻找文本 (b001, f001, 1, 假))
    赋值 (.内容, 相加 (.内容, 取文本中间 (a001, g001, 1)))
.计次循环尾 ()
赋值 (.内容, 取文本右边 (.内容, 相减 (取文本长度 (.内容), h001)))
赋值 (.内容, .内容)
赋值 (.内容, 到文本 (数据.读 (rsc, 7)))
赋值 (.内容, 到文本 (数据.读 (rsc, 8)))
赋值 (.内容, 到文本 (数据.读 (rsc, 10)))
赋值 (.选中, 数据.读 (rsc, 11))
赋值 (.内容, 到文本 (数据.读 (rsc, 12)))
赋值 (.内容, 到文本 (数据.读 (rsc, 9)))
赋值 (.内容, 到文本 (数据.读 (rsc, 13)))
数据.关闭记录集 (rsc)
数据.关闭记录集 (权限查询)
数据.关闭记录集 (地区查询)

.子程序 _地区组合框_列表项被选择, 空白型, , 
.局部变量 n, 整数型, , , 

清空 ()
赋值 (查询语句, 相加 (“select count(*) from 部门类型 where 地区='”, .取项目文本 (.现行选中项), “' and 是否禁用=0”))
数据.关闭记录集 (查询记录)
赋值 (查询记录, 数据.查询 (查询语句))
赋值 (n, 到整数 (数据.读 (查询记录, 1)))
数据.关闭记录集 (查询记录)
赋值 (查询语句, 相加 (“select * from 部门类型 where 地区='”, .取项目文本 (.现行选中项), “' and 是否禁用=0”))
赋值 (查询记录, 数据.查询 (查询语句))
数据.到首记录 (查询记录)
.计次循环首 (n, )
    数据.读 (查询记录, “部门”).加入项目 ()
    数据.到后一记录 (查询记录)
.计次循环尾 ()

.子程序 _提交_被单击, 空白型, , 
.局部变量 工号, 文本型, , , 
.局部变量 权限记录集, 整数型, , , 
.局部变量 部门记录集, 整数型, , , 
.局部变量 地区部门1, 文本型, , , 
.局部变量 i, 文本型, , , 
.局部变量 加密, 文本型, , , 

赋值 (工号, .内容)
.判断开始 (等于 (.内容, “超级管理员”))
    信息框 (“不能增加超级管理员！”, 0, )
.默认
    .如果 (或者 (等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”)))
        信息框 (“请检查输入内容是否正确！”, 0, )
    .否则
        .判断开始 (不等于 (.内容, .内容))
            信息框 (“密码和确认密码不一致!”, 0, )
        .默认
            数据.关闭记录集 (查询记录)
            赋值 (权限记录集, 数据.查询 (相加 (“select * from 权限类型 where 权限类型='”, .内容, “'”)))
            .判断开始 (等于 (数据.读 (权限记录集, 1), 0))
                信息框 (“此权限可能已被删除!请与管理员联系!!”, 0, )
                返回 ()
            .默认
                赋值 (部门记录集, 数据.查询 (相加 (“select * from 部门类型 where 部门= '”, .内容, “' and 地区='”, .内容, “'”)))
                .判断开始 (等于 (数据.读 (部门记录集, 1), 0))
                    信息框 (“此部门可能已被删除!请与管理员联系!!”, 0, )
                    返回 ()
                .默认
                    .计次循环首 (取文本长度 (.内容), c001)
                        赋值 (f001, 取文本中间 (.内容, c001, 1))
                        赋值 (g001, 寻找文本 (a001, f001, 1, 假))
                        赋值 (.内容, 相加 (.内容, 取文本中间 (b001, g001, 1)))
                    .计次循环尾 ()
                    赋值 (加密, .内容)
                    赋值 (地区部门1, 相加 (到文本 (数据.读 (部门记录集, 3)), “,”, 到文本 (数据.读 (部门记录集, 5))))
                    .判断开始 (等于 (.选中, 真))
                        赋值 (i, “1”)
                    .默认
                        赋值 (i, “0”)
                    .判断结束
                    赋值 (查询语句, 相加 (“update 用户资料 set  权限='”, 到文本 (数据.读 (权限记录集, 3)), “',权限组='”, 到文本 (数据.读 (权限记录集, “IDQ”)), “',部门='”, 地区部门1, “',姓名='”, .内容, “',联系电话='”, .内容, “',联系地址='”, .内容, “',创建人员='”, 操作员, “',是否禁用=”, i, “ ,备注='”, .内容, “',密码='”, 加密, “' where 工号='”, 工号, “'”))
                    .如果 (等于 (数据.执行 (查询语句, ), 假))
                        信息框 (“执行失败，请重试！”, 0, )
                        记录操作事件 (相加 (查询语句, “执行失败”))
                        赋值 (.内容, “”)
                        返回 ()
                    .否则
                        记录操作事件 (相加 (查询语句, “执行成功”))
                        信息框 (“修改成功”, 0, )
                        数据.关闭记录集 (查询记录)
                        数据.关闭记录集 (权限记录集)
                        数据.关闭记录集 (部门记录集)
                        数据.关闭记录集 (查询记录)
                        _工号设置_被选择 ()
                        赋值 (.内容, “”)
                        修改工号窗口.销毁 ()
                    .如果结束
                    
                .判断结束
                
            .判断结束
            
        .判断结束
        
    .如果结束
    
    
.判断结束


.子程序 _取消_被单击, 空白型, , 
修改工号窗口.销毁 ()

.程序集 公共程序集, , , 

.子程序 初始菜单, 空白型, , 
.局部变量 父菜单句柄, 整数型, , , 
.局部变量 项目数, 整数型, , , 
.局部变量 菜单句柄, 整数型, , , 
.局部变量 父项目数, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 h, 整数型, , , 
.局部变量 项目ID, 整数型, , , 

赋值 (父菜单句柄, 取父菜单句柄 (_启动窗口.取窗口句柄 ()))
赋值 (父项目数, 取菜单项目数 (父菜单句柄))
.计次循环首 (父项目数, i)
    赋值 (菜单句柄, 取弹出菜句柄 (父菜单句柄, 相减 (i, 1)))
    赋值 (项目数, 取菜单项目数 (菜单句柄))
    .计次循环首 (项目数, h)
        赋值 (项目ID, 取项目ID (菜单句柄, 相减 (h, 1)))
        设置菜单 (父菜单句柄, 项目ID, 5)
    .计次循环尾 ()
.计次循环尾 ()



.子程序 登陆检测, 空白型, , 
.局部变量 权限检测, 文本型, , , 
.局部变量 检测结果, 整数型, , , 
.局部变量 权限设置, 文本型, , "0", 
.局部变量 s, 整数型, , , 
.局部变量 父菜单句柄, 整数型, , , 
.局部变量 父项目数, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 项目数, 整数型, , , 
.局部变量 菜单句柄, 整数型, , , 
.局部变量 h, 整数型, , , 
.局部变量 项目ID, 整数型, , , 
.局部变量 项目名, 文本型, , , 

_启动窗口.清空 (.)
赋值 (权限检测, 相加 (“select * from 用户资料 where 工号='”, 操作员, “'”))
赋值 (检测结果, 数据.查询 (权限检测))
数据.到首记录 (检测结果)
赋值 (权限设置, 分割文本 (数据.读 (检测结果, 4), “,”, ))
赋值 (父菜单句柄, 取父菜单句柄 (_启动窗口.取窗口句柄 ()))
赋值 (父项目数, 取菜单项目数 (父菜单句柄))
.计次循环首 (父项目数, i)
    赋值 (菜单句柄, 取弹出菜句柄 (父菜单句柄, 相减 (i, 1)))
    赋值 (项目数, 取菜单项目数 (菜单句柄))
    .计次循环首 (项目数, h)
        赋值 (项目ID, 取项目ID (菜单句柄, 相减 (h, 1)))
        赋值 (项目名, 取空白文本 (50))
        _启动窗口.加入项目 (., 项目名, 取菜单项名 (菜单句柄, 项目ID, 项目名, 51, 2))
        .计次循环首 (_启动窗口.取项目数 (.), s)
             ' 输出调试文本 (到文本 (s))
            .判断开始 (等于 (权限设置 [s], “0”))
                设置菜单 (父菜单句柄, 项目ID, 4)
            .判断 (等于 (权限设置 [s], “1”))
                设置菜单 (父菜单句柄, 项目ID, 5)
            .默认
                
            .判断结束
            
        .计次循环尾 ()
    .计次循环尾 ()
.计次循环尾 ()
数据.关闭记录集 (检测结果)

.子程序 系统初始化, 空白型, , 
连续赋值 (“”, _启动窗口..标题, _启动窗口..标题, _启动窗口..标题)

.子程序 版本, 空白型, , 
.局部变量 版本查询, 整数型, , , 
.局部变量 标题, 文本型, , , 

赋值 (版本查询, 数据.查询 (“select * from INFO”))
赋值 (a01, 数据.读 (版本查询, 4))
赋值 (b01, 数据.读 (版本查询, 2))
赋值 (c01, 数据.读 (版本查询, 5))
赋值 (d01, 数据.读 (版本查询, 6))
赋值 (标题, 数据.读 (版本查询, “注册标题”))
.判断开始 (等于 (数据.读 (版本查询, 3), 假))
    赋值 (e01, 相加 (标题, “――”, reg))
    赋值 (_启动窗口., e01)
    数据.关闭记录集 (版本查询)
.默认
    赋值 (e01, 相加 (标题, “――”, “已注册”))
    赋值 (_启动窗口..标题, “已注册”)
    赋值 (_启动窗口., e01)
    数据.关闭记录集 (版本查询)
.判断结束


.子程序 加密程序, 空白型, , 
赋值 (a001, 相加 (“~!@#$%&*()_+-={}|[]\:”, #引号, “;<>?,./0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ ”, #换行符))
 ' 置随机数种子 (取启动时间 ())
.计次循环首 (取文本长度 (a001), c001)
    赋值 (d001, 取随机数 (1, 取文本长度 (a001)))
    赋值 (e001, 取文本中间 (a001, d001, 1))
    赋值 (b001, 相加 (b001, e001))
    赋值 (a001, 子文本替换 (a001, e001, “”, 1, , 真))
.计次循环尾 ()
赋值 (a001, 相加 (“~!@#$%&*()_+-={}|[]\:”, #引号, “;<>?,./0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ ”, #换行符))



.子程序 本机硬盘特征字, 整数型, , 
赋值 (原始硬盘特征代码, 取十六进制文本 (取硬盘特征字 ()))
.如果 (不等于 (原始硬盘特征代码, “0”))
    赋值 (新特征代码, 位异或 (到数值 (原始硬盘特征代码), 8815000518))
     ' 返回 (新特征代码)
 ' .否则
    赋值 (新特征代码, 位异或 (19780228, 8815000518))
    返回 (新特征代码)
.如果结束




.子程序 检测, 空白型, , 
.局部变量 tt, 空白型, , , 
.局部变量 脚本, 整数型, , , 

赋值 (reg, “未注册！本软件为共享软件(30天试用)，若想功能得到保障请注册！”)
赋值 (脚本, 数据.查询 (“select count(*) from INFO”))
.如果 (不等于 (数据.读 (脚本, 1), 1))
    数据.执行 (相加 (“insert into INFO(系统开发,系统版本,注册信息,注册地址,注册标题,使用期限,到期时间) values ('软件作者:徐明明','系统版本:正式版V1.0','联通濉溪分公司','联通濉溪分公司','联通濉溪分公司','试用','”, 未知支持库函数_12 (取现行时间 (), “%y-%m-%d”), “')”), )
    数据.关闭记录集 (脚本)
.否则
    赋值 (脚本, 数据.查询 (“select * from INFO”))
    .判断开始 (等于 (数据.读 (脚本, 3), 假))
        数据.到首记录 (脚本)
        赋值 (tt, 取时间间隔 (到时间 (未知支持库函数_12 (取现行时间 (), “%y-%m-%d”)), 到时间 (数据.读 (脚本, “到期时间”)), #日))
        .如果 (或者 (大于或等于 (tt, 30), 小于 (tt, 0)))
            信息框 (“软件试用期已到，功能将受到限制，请注册正版软件！”, 0, )
            赋值 (_启动窗口..可视, 假)
            赋值 (_启动窗口..可视, 假)
            赋值 (_启动窗口..可视, 假)
            赋值 (_启动窗口..可视, 假)
            赋值 (_启动窗口..可视, 假)
            赋值 (_启动窗口..可视, 假)
        .否则
            .如果 (并且 (大于或等于 (tt, 25), 小于或等于 (tt, 30)))
                信息框 (相加 (“软件试用期剩余：”, 到文本 (相减 (30, tt)), “天,过试用期后功能将受到限制，请注册！”), 0, )
            .否则
                
            .如果结束
            
        .如果结束
        
    .判断 (等于 (数据.读 (脚本, 3), 真))
        数据.到首记录 (脚本)
        赋值 (tt, 取时间间隔 (到时间 (未知支持库函数_12 (取现行时间 (), “%y-%m-%d”)), 到时间 (数据.读 (脚本, “到期时间”)), #日))
        输出调试文本 (tt)
        .如果 (大于或等于 (tt, 0))
            信息框 (“软件版本已过期，请更换新版本！”, 0, )
            结束 ()
        .否则
            .如果 (并且 (大于或等于 (tt, -5), 小于或等于 (tt, -1)))
                信息框 (相加 (“软件版本过期时间剩余：”, 到文本 (负 (tt)), “天,过期后请更换新版本！”), 0, )
            .否则
                
            .如果结束
            
        .如果结束
        
    .默认
        
    .判断结束
    数据.关闭记录集 (脚本)
.如果结束


.子程序 提示信息框, 整数型, , 代替系统自代的信息框,可以不受窗体最前限制，加入错误信息.确定=1,取消=2
.参数 提示内容, 文本型, , 
.参数 提示标题, 文本型, , 
.参数 提示按钮, 整数型, , 
.参数 错误信息, 文本型, 可空, 错误信息代码
.参数 窗口句柄, 整数型, 可空, 欲显示信息框的窗体句柄

.如果真 (取反 (是否为空 (错误信息)))
    赋值 (提示内容, 相加 (提示内容, #换行符, #换行符, “错误代码：”, 错误信息))
.如果真结束
.如果真 (是否为空 (窗口句柄))
    赋值 (窗口句柄, _启动窗口.取窗口句柄 ())
.如果真结束
返回 (提示信息 (窗口句柄, 提示内容, 提示标题, 提示按钮))

.子程序 记录操作事件, 空白型, , 
.参数 文本行内容, 文本型, , 

.局部变量 工号, 文本型, , , 
.局部变量 操作事件, 文本型, , , 
.局部变量 操作时间, 日期时间型, , , 

赋值 (工号, 操作员)
 ' 输出调试文本 (工号)
赋值 (操作事件, 子文本替换 (文本行内容, “'”, “ ”, , , 假))
 ' 输出调试文本 (操作事件)
赋值 (操作时间, 取现行时间 ())
 ' 输出调试文本 (操作时间)
赋值 (退出时间, 取现行时间 ())
 ' 输出调试文本 (退出时间)
赋值 (登陆IP, 未知支持库函数_17 ())
 ' 输出调试文本 (登陆IP [1])
赋值 (权限组, _启动窗口.取文本 (., 2))
 ' 输出调试文本 (权限组)
数据.执行 (相加 (“insert LOG (登陆工号,权限组,操作事件,操作时间,登陆IP) values ('”, 操作员, “','”, 权限组, “','”, 操作事件, “',”, 时间到文本 (操作时间, ), “,'”, 登陆IP [1], “')”), )


.窗口程序集 地区窗口程序集, , , 

.子程序 _地区部门_创建完毕, 空白型, , 
.局部变量 地区查询, 整数型, , , 

清空 ()
赋值 (地区查询, 数据.查询 (“select * from 地区类型”))
数据.到首记录 (地区查询)
.判断循环首 (等于 (数据.尾记录后 (地区查询), 假))
    数据.读 (地区查询, “地区”).加入项目 ()
    数据.到后一记录 (地区查询)
.判断循环尾 ()
数据.关闭记录集 (地区查询)

.子程序 _按钮2_被单击, 空白型, , 
地区部门.销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 地区记录, 整数型, , , 
.局部变量 地区代码, 文本型, , , 
.局部变量 i, 整数型, , , 
.局部变量 部门代码, 文本型, , , 
.局部变量 地区代码1, 整数型, , , 
.局部变量 地区代码2, 整数型, , , 
.局部变量 部门类型, 整数型, , , 

.如果 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“名称不能为空”, 0, )
.否则
    赋值 (地区记录, 数据.查询 (相加 (“select * from 部门类型 where 地区='”, .内容, “' and 部门='”, .内容, “'”)))
    .如果 (大于 (数据.读 (地区记录, 1), 0))
        信息框 (“部门已经存在!”, 0, )
        返回 ()
    .否则
        赋值 (地区代码2, 数据.查询 (相加 (“select * from 地区类型 where 地区='”, .内容, “'”)))
        赋值 (地区代码1, 数据.查询 (相加 (“select * from 部门类型 where 地区='”, .内容, “' order by 部门代码”)))
        赋值 (地区代码, 到文本 (数据.读 (地区代码2, 3)))
         ' 部门类型 ＝ 数据.查询 (“select * from 部门类型 where 地区='” ＋ 组合框1.内容 ＋ “'”)
        .判断开始 (大于 (数据.读 (地区代码1, 1), 0))
            赋值 (部门代码, 到文本 (相加 (数据.读 (地区代码1, “部门代码”), 1)))
            .如果 (等于 (数据.执行 (相加 (“insert 部门类型 (地区,地区代码,部门,部门代码,创建人员) values ('”, .内容, “',”, 地区代码, “,'”, .内容, “',”, 部门代码, “,'”, 操作员, “')”), ), 真))
                信息框 (“增加成功!”, 0, )
                记录操作事件 (相加 (.内容, “部门增加成功”))
                数据.关闭记录集 (地区记录)
                地区部门.销毁 ()
                赋值 (_启动窗口.., 0)
            .否则
                信息框 (“增加失败!”, 0, )
                记录操作事件 (相加 (.内容, “部门增加失败”))
            .如果结束
            
        .默认
            赋值 (部门代码, 相加 (到文本 (数据.读 (地区代码2, “地区代码”)), “1”))
            .如果 (等于 (数据.执行 (相加 (“insert 部门类型 (地区,地区代码,部门,部门代码,创建人员) values ('”, .内容, “',”, 地区代码, “,'”, .内容, “',”, 部门代码, “,'”, 操作员, “')”), ), 真))
                信息框 (“增加成功!”, 0, )
                记录操作事件 (相加 (.内容, “部门增加成功”))
                数据.关闭记录集 (地区记录)
                地区部门.销毁 ()
                赋值 (_启动窗口.., 0)
            .否则
                信息框 (“增加失败!”, 0, )
                记录操作事件 (相加 (.内容, “部门增加失败”))
            .如果结束
            
        .判断结束
        
    .如果结束
    
.如果结束


.子程序 _按钮3_被单击, 空白型, , 
载入 (增加地区, , 真)


.窗口程序集 密码修改程序集, , , 

.子程序 _修改密码_创建完毕, 空白型, , 
赋值 (.标题, 操作员)
赋值 (.内容, “”)
赋值 (.内容, “”)
加密程序 ()

.子程序 _超级按钮2_被单击, 空白型, , 
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容)

.子程序 _超级按钮3_被单击, 空白型, , 
.局部变量 脚本, 文本型, , , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 加密, 文本型, , , 
.局部变量 加密1, 文本型, , , 

赋值 (.内容, “”)
.如果 (或者 (不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”), 大于 (取文本长度 (.内容), 15)))
    赋值 (脚本, 相加 (“select * from 用户资料 where 工号='”, 操作员, “'”))
    赋值 (记录集句柄, 数据.查询 (脚本))
    数据.到首记录 (记录集句柄)
    .判断循环首 (等于 (数据.尾记录后 (记录集句柄), 假))
        .计次循环首 (取文本长度 (.内容), c001)
            赋值 (f001, 取文本中间 (.内容, c001, 1))
            赋值 (g001, 寻找文本 (a001, f001, 1, 假))
            赋值 (.内容, 相加 (.内容, 取文本中间 (b001, g001, 1)))
        .计次循环尾 ()
        赋值 (加密, .内容)
        .如果 (不等于 (到文本 (数据.读 (记录集句柄, “密码”)), 加密))
            信息框 (“原始密码不正确,不能修改!”, 0, )
            返回 ()
        .否则
            
        .如果结束
        
        数据.到后一记录 (记录集句柄)
    .判断循环尾 ()
    .如果 (不等于 (.内容, .内容))
        信息框 (“新密码不一致,请重新输入!”, 0, )
        返回 ()
    .否则
        .计次循环首 (取文本长度 (.内容), c001)
            赋值 (f001, 取文本中间 (.内容, c001, 1))
            赋值 (g001, 寻找文本 (a001, f001, 1, 假))
            赋值 (.内容, 相加 (.内容, 取文本中间 (b001, g001, 1)))
        .计次循环尾 ()
        赋值 (加密1, .内容)
        赋值 (脚本, 相加 (“update 用户资料 set 密码='”, .内容, “' where 工号='”, 操作员, “'”))
        .如果 (等于 (数据.执行 (脚本, ), 真))
            信息框 (“密码修改成功,请牢记你的新密码!”, 0, )
            记录操作事件 (相加 (操作员, “密码修改成功”))
            赋值 (.内容, “”)
            赋值 (.内容, “”)
            赋值 (.内容, “”)
            赋值 (.内容, “”)
            赋值 (.内容, “”)
            修改密码.销毁 ()
        .否则
            信息框 (“密码修改失败,请重试!”, 0, )
            记录操作事件 (相加 (操作员, “密码修改失败”))
            赋值 (.内容, “”)
            返回 ()
        .如果结束
        
    .如果结束
    
.否则
    信息框 (“请添写全部信息!”, 0, )
    返回 ()
.如果结束


.窗口程序集 增加地区程序集, , , 

.子程序 _按钮2_被单击, 空白型, , 
增加地区.销毁 ()
载入 (地区部门, , 真)


.子程序 _增加地区_将被销毁, 空白型, , 
增加地区.销毁 ()
载入 (地区部门, , 真)


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 地区查询, 整数型, , , 
.局部变量 地区代码, 整数型, , , 
.局部变量 地区代码1, 文本型, , , 

.判断开始 (等于 (.内容, “”))
    信息框 (“名称不能为空”, 0, )
.默认
    赋值 (地区查询, 数据.查询 (相加 (“select * from 地区类型 where 地区='”, .内容, “'”)))
    .判断开始 (大于 (数据.读 (地区查询, 1), 0))
        信息框 (“地区名称已经存在!”, 0, )
        返回 ()
    .默认
        赋值 (地区代码, 数据.查询 (“select * from 地区类型 order by 地区代码”))
        .判断开始 (大于 (数据.读 (地区代码, 1), 0))
            赋值 (地区代码1, 到文本 (相加 (数据.读 (地区代码, 3), 100)))
            .如果 (等于 (数据.执行 (相加 (“insert 地区类型 (地区,地区代码,创建人员) values ('”, .内容, “',”, 地区代码1, “,'”, 操作员, “')”), ), 真))
                信息框 (“增加成功!”, 0, )
                记录操作事件 (相加 (.内容, “部门增加成功”))
                数据.关闭记录集 (地区代码)
                增加地区.销毁 ()
                _地区部门_创建完毕 ()
            .否则
                信息框 (“增加失败!”, 0, )
                记录操作事件 (相加 (.内容, “部门增加失败”))
            .如果结束
            
        .默认
            赋值 (地区代码1, “235000”)
            .如果 (等于 (数据.执行 (相加 (“insert 地区类型 (地区,地区代码,创建人员) values ('”, .内容, “',”, 地区代码1, “,'”, 操作员, “')”), ), 真))
                信息框 (“增加成功!”, 0, )
                记录操作事件 (相加 (.内容, “部门增加成功”))
                数据.关闭记录集 (地区代码)
                增加地区.销毁 ()
                _地区部门_创建完毕 ()
            .否则
                信息框 (“增加失败!”, 0, )
                记录操作事件 (相加 (.内容, “部门增加失败”))
            .如果结束
            
        .判断结束
        
        
    .判断结束
    
.判断结束


.窗口程序集 注册窗口程序集, , , 

.程序集变量 模数, 文本型, , , 
.子程序 _注册未成功_创建完毕, 空白型, , 
.局部变量 脚本, 整数型, , , 

赋值 (., 假)
赋值 (脚本, 数据.查询 (“select * from INFO”))
.判断开始 (等于 (数据.读 (脚本, “是否注册”), 假))
    赋值 (.内容, 数据.读 (脚本, “注册标题”))
    本机硬盘特征字 ()
    赋值 (.内容, 到文本 (新特征代码))
    相加 (“    您可通过以下联系方式给我们汇款，并且在汇款后第一时间通过各种方式通知我们，并将软件的序列号”, 到文本 (新特征代码), “告诉我们，我们收到款后，马上向您发放注册码，升级您为注册用户，提供免费的技术咨询服务。其它相关事宜可进一步去我们咨询或联系！”, #换行符, #换行符, “    安徽省淮北市濉溪县联通分公司”, #换行符, “     徐明明(收)”, #换行符, “    email: 13084057002@ah165.net”, #换行符, “    网站:  http://www.12cool.net”, #换行符, “    电话:  13084057002”, #换行符, “    联系人：徐明明”).加入文本 ()
    数据.关闭记录集 (脚本)
.默认
    赋值 (.内容, “注册名称”)
    赋值 (.内容, “已注册”)
    赋值 (.标题, “注册码”)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.标题, “已注册”)
    赋值 (.禁止, 真)
    赋值 (.内容, 数据.读 (脚本, “注册码”))
    赋值 (.内容, 数据.读 (脚本, “注册标题”))
    本机硬盘特征字 ()
    赋值 (.内容, 到文本 (新特征代码))
    相加 (“    感谢你升级您为注册用户， 您可通过以下联系方式通知我们，我们将提供长期的技术咨询服务。其它相关事宜可进一步去我们咨询或联系！”, #换行符, #换行符, “    安徽省淮北市濉溪县联通分公司”, #换行符, “     徐明明(收)”, #换行符, “    email: 13084057002@ah165.net”, #换行符, “    网站:  http://www.12cool.net”, #换行符, “    电话:  13084057002”, #换行符, “    联系人：徐明明”).加入文本 ()
    数据.关闭记录集 (脚本)
    返回 ()
.判断结束


.子程序 _注册按钮_被单击, 空白型, , 
.局部变量 注册, 整数型, , , 
.局部变量 到期时间1, 文本型, , , 
.局部变量 脚本, 整数型, , , 

赋值 (模数, “759ADE9A38458CD98B8F83B6FA43D8E1A96516975491D7D8FB142F861ABA7FB38B05A695480B82C9BD540D59F9CCFC1AC2A2BD1FB74079CB486478E4BCE1B4447C913E2BDB6AC61BC94F9C3CD5B065CEB117ACB490A64FF4062C8112663D124059670A2430932E2BDD58F0705FAB4FA0E3E84A3352F7296D0E4F1DB166DE4041”)
.判断开始 (等于 (.内容, “”))
    信息框 (“名称不能为空”, 0, )
.默认
    .如果 (等于 (未知支持库函数_6 (到字节集 (.内容), .内容, “15A5B”, 模数), 真))
        赋值 (到期时间1, 相加 (到文本 (相加 (取年份 (取现行时间 ()), 1)), “-”, 到文本 (取月份 (取现行时间 ())), “-”, 到文本 (取日 (取现行时间 ()))))
        .如果 (等于 (数据.执行 (相加 (“update INFO set 是否注册=0,注册时间='”, 未知支持库函数_12 (取现行时间 (), “%y-%m-%d”), “',注册信息='”, .内容, “',使用期限='一年',到期时间='”, 未知支持库函数_12 (到时间 (到期时间1), “%y-%m-%d”), “',注册码='”, .内容, “'”), ), 假))
            信息框 (“注册失败”, 0, )
            记录操作事件 (相加 (.内容, “注册失败”))
        .否则
            信息框 (“注册成功！请重新启动程序”, 64, )
            记录操作事件 (相加 (.内容, “注册成功”))
            注册未成功.销毁 ()
        .如果结束
        
    .否则
        信息框 (相加 (“你输入的注册码有误，请联系软件作者！”, #换行符, “希望得到你的注册支持,使软件更加完美!”, #换行符, “13084057002”, #换行符, “EMAIL:13084057002@ah165.net ”), 0, “请联系作者！”)
        返回 ()
        
    .如果结束
    
    
    
    
.判断结束



 ' 不属于任何一个程序集、类模块的函数：
