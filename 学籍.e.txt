 ' 文件类型：Windows窗口程序

 ' 程序名称：学籍管理系统
 ' 程序描述：
 ' 程序作者：皮秀波
 ' 邮政编码：222137
 ' 联系地址：江苏省赣榆县夹山乡小学
 ' 联系电话：0518-6551840
 ' 传真号码：
 ' 电子信箱：pxb2000@163.com
 ' 主页地址：无
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 2 0 系统核心支持库



窗口 登陆窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 496
    高度 = 281
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 已保存到：D:\易语言学习\Data\学籍.e\登陆窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “连云港市小学学籍管理系统－－皮秀波  制作”
    帮助文件名 = “”

窗口 _启动窗口
    左边 = 0
    顶边 = 0
    宽度 = 823
    高度 = 592
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 真
    图标 =  ' 已保存到：D:\易语言学习\Data\学籍.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 512
    高度 = 287
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于本软件”
    帮助文件名 = “”

窗口 系统设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 508
    高度 = 488
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 编排考场窗口
    左边 = 50
    顶边 = 50
    宽度 = 555
    高度 = 449
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 浏览考场窗口
    左边 = 50
    顶边 = 50
    宽度 = 750
    高度 = 560
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 选择班级窗口
    左边 = 50
    顶边 = 50
    宽度 = 299
    高度 = 133
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 选择照片窗口
    左边 = 50
    顶边 = 50
    宽度 = 535
    高度 = 381
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “请选择学生的照片”
    帮助文件名 = “”

窗口 转出窗口
    左边 = 50
    顶边 = 50
    宽度 = 310
    高度 = 233
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 调班窗口
    左边 = 50
    顶边 = 50
    宽度 = 312
    高度 = 204
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 休学窗口
    左边 = 50
    顶边 = 50
    宽度 = 325
    高度 = 234
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 332
    高度 = 231
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 窗口2
    左边 = 50
    顶边 = 50
    宽度 = 344
    高度 = 210
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 窗口3
    左边 = 50
    顶边 = 50
    宽度 = 358
    高度 = 207
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 窗口4
    左边 = 50
    顶边 = 50
    宽度 = 231
    高度 = 190
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 窗口5
    左边 = 50
    顶边 = 50
    宽度 = 315
    高度 = 150
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 窗口6
    左边 = 50
    顶边 = 50
    宽度 = 284
    高度 = 195
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 窗口7
    左边 = 50
    顶边 = 50
    宽度 = 397
    高度 = 261
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 窗口9
    左边 = 50
    顶边 = 50
    宽度 = 389
    高度 = 260
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假



.图片 信息卡, " ' 已保存到：D:\易语言学习\Data\学籍.e\信息卡", , 
.图片 花名册, " ' 已保存到：D:\易语言学习\Data\学籍.e\花名册", , 
.图片 增加表, " ' 已保存到：D:\易语言学习\Data\学籍.e\增加表", , 
.图片 减少表, " ' 已保存到：D:\易语言学习\Data\学籍.e\减少表", , 
.图片 成绩单, " ' 已保存到：D:\易语言学习\Data\学籍.e\成绩单", , 
.常量 学校库, "“xuexiao.edb”", , 
.常量 学校名称, "“学校名称”", , 
.常量 学校编号, "“学校编号”", , 
.常量 校长, "“校长”", , 
.常量 班级库, "“banji.edb”", , 
.常量 学校编号1, "“学校编号”", , 
.常量 学校名称1, "“学校名称”", , 
.常量 班级名, "“班级名”", , 
.常量 语文教师, "“语文教师”", , 
.常量 数学教师, "“数学教师”", , 
.常量 学籍库, "“xueji.edb”", , 
.常量 学校编号2, "“学校编号”", , 
.常量 班级名1, "“班级名”", , 
.常量 学籍号, "“学籍号”", , 
.常量 姓名, "“姓名”", , 
.常量 性别, "“性别”", , 
.常量 民族, "“民族”", , 
.常量 籍贯, "“籍贯”", , 
.常量 出生年月, "“出生年月”", , 
.常量 户口所在地, "“户口所在地”", , 
.常量 户口性质, "“户口性质”", , 
.常量 家庭住址, "“家庭住址”", , 
.常量 父母户口所在地, "“父母户口所在地”", , 
.常量 本人户口所在地, "“本人户口所在地”", , 
.常量 监护人称谓, "“监护人称谓”", , 
.常量 监护人姓名, "“监护人姓名”", , 
.常量 监护人工作单位, "“监护人工作单位”", , 
.常量 监护人电话, "“监护人电话”", , 
.常量 照片, "“照片”", , 
.常量 学籍管理, "“学籍管理”", , 
.常量 系统设置, "“系统设置”", , 
.常量 入学年月, "“入学年月”", , 
.常量 时间, "“时间”", , 
.常量 原因, "“原因”", , 
.常量 目的地, "“目的地”", , 
.常量 类型, "“类型”", , 


.全局变量 班级, 文本型, , , 
.全局变量 选择图片, 字节集, , , 
.全局变量 学校名称, 文本型, , , 
.全局变量 班级名, 文本型, , , 
.全局变量 姓名, 文本型, , , 
.全局变量 学籍号, 文本型, , , 
.全局变量 类型, 文本型, , , 
.全局变量 目的地, 文本型, , , 
.全局变量 原因, 文本型, , , 
.全局变量 时间, 文本型, , , 
.全局变量 照片, 字节集, , , 
.全局变量 监护人电话, 文本型, , , 
.全局变量 监护人工作单位, 文本型, , , 
.全局变量 监护人姓名, 文本型, , , 
.全局变量 监护人称谓, 文本型, , , 
.全局变量 本人户口所在地, 文本型, , , 
.全局变量 父母户口所在地, 文本型, , , 
.全局变量 家庭住址, 文本型, , , 
.全局变量 户口性质, 文本型, , , 
.全局变量 户口所在地, 文本型, , , 
.全局变量 入学年月, 文本型, , , 
.全局变量 出生年月, 文本型, , , 
.全局变量 籍贯, 文本型, , , 
.全局变量 民族, 文本型, , , 
.全局变量 性别, 文本型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 学校字段, 字段信息, , "3", 
.程序集变量 班级字段, 字段信息, , "5", 
.程序集变量 学籍字段, 字段信息, , "19", 
.程序集变量 成绩字段, 字段信息, , "10", 
.程序集变量 hz, 字节集, , , 
.程序集变量 判断增改, 文本型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (., 取屏幕宽度 ())
赋值 (., 相减 (取屏幕高度 (), 25))
赋值 (_启动窗口., 0)
赋值 (., 0)
赋值 (., #浅灰)
赋值 (., 1)
赋值 (., 真)
.如果真 (等于 (文件是否存在 (“xuexiao.edb”), 假))
    赋值 (学校字段 [1]., #学校编号)
    赋值 (学校字段 [1]., #文本型)
    赋值 (学校字段 [1]., 2)
    赋值 (学校字段 [2]., #学校名称)
    赋值 (学校字段 [2]., #文本型)
    赋值 (学校字段 [2]., 20)
    赋值 (学校字段 [3]., #校长)
    赋值 (学校字段 [3]., #文本型)
    赋值 (学校字段 [3]., 8)
    .如果真 (等于 (创建 (“xuexiao.edb”, 学校字段), 假))
        信息框 (“创建系统数据库失败！”, #错误图标, “错误”)
        结束 ()
    .如果真结束
    
.如果真结束
.如果真 (等于 (打开 (“xuexiao.edb”, , , , , , ), 假))
    信息框 (“无法打开系统数据库！”, #错误图标, “错误”)
    结束 ()
.如果真结束

.如果真 (等于 (文件是否存在 (“banji.edb”), 假))
    赋值 (班级字段 [1]., #学校编号)
    赋值 (班级字段 [1]., #文本型)
    赋值 (班级字段 [1]., 2)
    赋值 (班级字段 [2]., #学校名称)
    赋值 (班级字段 [2]., #文本型)
    赋值 (班级字段 [2]., 20)
    赋值 (班级字段 [3]., #班级名)
    赋值 (班级字段 [3]., #文本型)
    赋值 (班级字段 [3]., 6)
    赋值 (班级字段 [4]., #语文教师)
    赋值 (班级字段 [4]., #文本型)
    赋值 (班级字段 [4]., 8)
    赋值 (班级字段 [5]., #数学教师)
    赋值 (班级字段 [5]., #文本型)
    赋值 (班级字段 [5]., 8)
    .如果真 (等于 (创建 (“banji.edb”, 班级字段), 假))
        信息框 (“创建系统数据库失败！”, #错误图标, “错误”)
        结束 ()
    .如果真结束
    
.如果真结束
.如果真 (等于 (打开 (“banji.edb”, , , , , , ), 假))
    信息框 (“无法打开系统数据库！”, #错误图标, “错误”)
    结束 ()
.如果真结束

.如果真 (等于 (文件是否存在 (“xueji.edb”), 假))
    赋值 (学籍字段 [1]., #学校名称)
    赋值 (学籍字段 [1]., #文本型)
    赋值 (学籍字段 [1]., 20)
    赋值 (学籍字段 [2]., #班级名)
    赋值 (学籍字段 [2]., #文本型)
    赋值 (学籍字段 [2]., 6)
    赋值 (学籍字段 [3]., #学籍号)
    赋值 (学籍字段 [3]., #文本型)
    赋值 (学籍字段 [3]., 10)
    赋值 (学籍字段 [4]., #姓名)
    赋值 (学籍字段 [4]., #文本型)
    赋值 (学籍字段 [4]., 8)
    赋值 (学籍字段 [5]., #性别)
    赋值 (学籍字段 [5]., #文本型)
    赋值 (学籍字段 [5]., 2)
    赋值 (学籍字段 [6]., #民族)
    赋值 (学籍字段 [6]., #文本型)
    赋值 (学籍字段 [6]., 4)
    赋值 (学籍字段 [7]., #籍贯)
    赋值 (学籍字段 [7]., #文本型)
    赋值 (学籍字段 [7]., 20)
    赋值 (学籍字段 [8]., #出生年月)
    赋值 (学籍字段 [8]., #文本型)
    赋值 (学籍字段 [8]., 14)
    赋值 (学籍字段 [9]., #入学年月)
    赋值 (学籍字段 [9]., #文本型)
    赋值 (学籍字段 [9]., 14)
    
    赋值 (学籍字段 [10]., #户口所在地)
    赋值 (学籍字段 [10]., #文本型)
    赋值 (学籍字段 [10]., 20)
    赋值 (学籍字段 [11]., #户口性质)
    赋值 (学籍字段 [11]., #文本型)
    赋值 (学籍字段 [11]., 4)
    赋值 (学籍字段 [12]., #家庭住址)
    赋值 (学籍字段 [12]., #文本型)
    赋值 (学籍字段 [12]., 30)
    赋值 (学籍字段 [13]., #父母户口所在地)
    赋值 (学籍字段 [13]., #文本型)
    赋值 (学籍字段 [13]., 40)
    赋值 (学籍字段 [14]., #本人户口所在地)
    赋值 (学籍字段 [14]., #文本型)
    赋值 (学籍字段 [14]., 40)
    赋值 (学籍字段 [15]., #监护人称谓)
    赋值 (学籍字段 [15]., #文本型)
    赋值 (学籍字段 [15]., 6)
    赋值 (学籍字段 [16]., #监护人姓名)
    赋值 (学籍字段 [16]., #文本型)
    赋值 (学籍字段 [16]., 8)
    赋值 (学籍字段 [17]., #监护人工作单位)
    赋值 (学籍字段 [17]., #文本型)
    赋值 (学籍字段 [17]., 30)
    赋值 (学籍字段 [18]., #监护人电话)
    赋值 (学籍字段 [18]., #文本型)
    赋值 (学籍字段 [18]., 12)
    赋值 (学籍字段 [19]., #照片)
    赋值 (学籍字段 [19]., #字节集型)
    
    .如果真 (等于 (创建 (“xueji.edb”, 学籍字段), 假))
        信息框 (“创建系统数据库失败！”, #错误图标, “错误”)
        结束 ()
    .如果真结束
    
.如果真结束
.如果真 (等于 (打开 (“xueji.edb”, , , , , , ), 假))
    信息框 (“无法打开系统数据库！”, #错误图标, “错误”)
    结束 ()
.如果真结束
填充组合框1 ()
.如果 (大于 (取项目数 (), 0))
    填充组合框2 ()
    .如果 (大于 (取项目数 (), 0))
        填充列表框1 ()
        .如果 (大于 (取项目数 (), 0))
            赋值 (., 0)
            填充学籍 ()
            
        .否则
            列表框空 ()
        .如果结束
        
    .否则
        列表框空 ()
    .如果结束
    
.否则
    信息框 (“请先设置学校及班级信息!”, 0, “提示”)
    _系统设置_被选择 ()
.如果结束


.子程序 填充学籍, 空白型, , 
置当前库 (“xueji”)
到首记录 ()
.如果 (查找 (并且 (等于 (读 (#学校名称), .取项目文本 (.)), 等于 (读 (#班级名), .取项目文本 (.)), 等于 (读 (#姓名), .取项目文本 (.)))))
    赋值 (., 读 (#学籍号))
    赋值 (., 读 (#姓名))
    .如果 (等于 (读 (#性别), “男”))
        赋值 (., 真)
    .否则
        赋值 (., 假)
    .如果结束
    .如果 (等于 (读 (#户口性质), “城镇”))
        赋值 (., 真)
    .否则
        赋值 (., 假)
    .如果结束
    读 (#民族).选择 ()
    赋值 (., 读 (#出生年月))
    赋值 (., 读 (#入学年月))
    读 (#户口所在地).选择 ()
    赋值 (., 读 (#家庭住址))
    赋值 (., 读 (#籍贯))
    赋值 (., 读 (#父母户口所在地))
    赋值 (., 读 (#本人户口所在地))
    赋值 (., 读 (#监护人姓名))
    赋值 (., 读 (#监护人工作单位))
    赋值 (., 读 (#监护人电话))
    读 (#监护人称谓).选择 ()
    赋值 (., 读 (#照片))
    
.否则
    列表框空 ()
.如果结束


.子程序 填充组合框1, 空白型, , 
置当前库 (“xuexiao”)
.如果 (不等于 (取记录数 (), 0))
    到首记录 ()
    .计次循环首 (取记录数 (), )
        读 (#学校名称).加入项目 ()
        跳过 ()
    .计次循环尾 ()
    赋值 (., 0)
.否则
    
.如果结束


.子程序 填充组合框2, 空白型, , 
置当前库 (“banji”)
.如果 (不等于 (取记录数 (), 0))
    到首记录 ()
    .计次循环首 (取记录数 (), )
        .如果 (等于 (读 (#学校名称), .取项目文本 (.)))
            读 (#班级名).加入项目 ()
        .否则
            
        .如果结束
        跳过 ()
    .计次循环尾 ()
    赋值 (., 0)
.否则
    
.如果结束


.子程序 填充列表框1, 空白型, , 
置当前库 (“xueji”)
.如果 (不等于 (取记录数 (), 0))
    到首记录 ()
    .计次循环首 (取记录数 (), )
        .如果 (并且 (等于 (读 (#学校名称), .取项目文本 (.)), 等于 (读 (#班级名), .取项目文本 (.))))
            读 (#姓名).加入项目 ()
        .否则
            
        .如果结束
        跳过 ()
    .计次循环尾 ()
.否则
    
.如果结束
赋值 (., 相加 (“本班共”, 数值到格式文本 (取项目数 (), , 假), “人”))

.子程序 列表框空, 空白型, , 
赋值 (., “”)
赋值 (., “”)
赋值 (., 假)
赋值 (., 假)
“汉族”.选择 ()
赋值 (., “”)
“本县区内”.选择 ()
赋值 (., “”)
赋值 (., “”)
“爸爸”.选择 ()
赋值 (., )

.子程序 _系统设置_被选择, 空白型, , 
载入 (系统设置窗口, _启动窗口, 真)
清空 ()
清空 ()
清空 ()
填充组合框1 ()
.如果 (大于 (取项目数 (), 0))
    填充组合框2 ()
    .如果 (大于 (取项目数 (), 0))
        填充列表框1 ()
        .如果 (大于 (取项目数 (), 0))
            赋值 (., 0)
            填充学籍 ()
        .否则
            列表框空 ()
        .如果结束
        
    .否则
        列表框空 ()
    .如果结束
    
.否则
    列表框空 ()
.如果结束


.子程序 _编排考场_被选择, 空白型, , 
载入 (编排考场窗口, _启动窗口, 真)

.子程序 _关于系统_被选择, 空白型, , 
载入 (关于窗口, _启动窗口, 真)

.子程序 _组合框1_列表被关闭, 空白型, , 
清空 ()
清空 ()
填充组合框2 ()
.如果 (大于 (取项目数 (), 0))
    填充列表框1 ()
    .如果 (大于 (取项目数 (), 0))
        赋值 (., 0)
        填充学籍 ()
    .否则
        列表框空 ()
    .如果结束
    
.否则
    列表框空 ()
.如果结束


.子程序 _组合框2_列表被关闭, 空白型, , 
清空 ()
填充列表框1 ()
.如果 (大于 (取项目数 (), 0))
    赋值 (., 0)
    填充学籍 ()
.否则
    列表框空 ()
.如果结束


.子程序 _列表框1_列表项被选择, 空白型, , 
填充学籍 ()


.子程序 _编辑框5_内容被改变, 空白型, , 
赋值 (., .)
赋值 (., .)
赋值 (., .)

.子程序 _选择照片钮_被单击, 空白型, , 
载入 (选择照片窗口, _启动窗口, 真)
.如果 (大于 (取字节集长度 (选择图片), 0))
    赋值 (., 选择图片)
.否则
    
.如果结束


.子程序 _增加钮_被单击, 空白型, , 
赋值 (判断增改, “增加”)
赋值 (., 真)
赋值 (., 真)
赋值 (., 真)
赋值 (., 真)
赋值 (., 真)
赋值 (., 真)

赋值 (., 真)
赋值 (., 真)
赋值 (., 真)


赋值 (., #白色)
赋值 (., 3)
赋值 (., 假)
赋值 (., 真)
赋值 (., 假)
赋值 (., 假)
赋值 (., -1)
赋值 (., “”)
赋值 (., “”)
赋值 (., 假)
赋值 (., 假)
“汉族”.选择 ()
赋值 (., “”)
“本县区内”.选择 ()
赋值 (., “”)
赋值 (., “”)
“爸爸”.选择 ()
赋值 (., )
获取焦点 ()

.子程序 _保存钮_被单击, 空白型, , 
.如果 (等于 (判断增改, “增加”))
    赋值 (.)
    置当前库 (“xueji”)
    到首记录 ()
    .如果 (并且 (等于 (取文本长度 (.), 10), 不等于 (., “”)))
        .如果 (等于 (查找 (等于 (读 (#学籍号), )), 假))
            .加入项目 (., )
            .选择 (.)
            赋值 (., #白色)
            赋值 (., 0)
            
            子程序1 ()
            赋值 (., “”)
            赋值 (., 假)
            赋值 (., 假)
            “汉族”.选择 ()
            赋值 (., “”)
            “本县区内”.选择 ()
            赋值 (., “”)
            赋值 (., “”)
            “爸爸”.选择 ()
            赋值 (., )
            获取焦点 ()
        .否则
            信息框 (相加 (“学籍号为”, , “的学生已经存在！”), 0, )
            获取焦点 ()
        .如果结束
        
    .否则
        信息框 (“应把学生的学籍号及姓名输入完整！”, 0, )
    .如果结束
    
.否则
    .如果 (等于 (判断增改, “修改”))
        赋值 (., #浅灰)
        赋值 (., 1)
        赋值 (., 真)
        赋值 (., 假)
        赋值 (., 假)
        赋值 (., 假)
        赋值 (., 假)
        赋值 (., 假)
        赋值 (., 假)
        赋值 (., 真)
        赋值 (., 真)
        赋值 (., 假)
        赋值 (., 假)
        赋值 (., 假)
        
        置当前库 (“xueji”)
        到首记录 ()
        .如果 (查找 (并且 (等于 (读 (#学校名称), .取项目文本 (.)), 等于 (读 (#班级名), .取项目文本 (.)), 等于 (读 (#学籍号), .))))
            删除 ()
            彻底删除 ()
            赋值 (.取项目文本 (.))
            赋值 (.取项目文本 (.))
            赋值 (.)
            赋值 (.)
            .如果 (等于 (., 假))
                赋值 (“女”)
            .否则
                赋值 (“男”)
            .如果结束
            赋值 (.取项目文本 (.))
            赋值 (.)
            赋值 (.)
            赋值 (.)
            赋值 (.取项目文本 (.))
            .如果 (等于 (., 假))
                赋值 (“农业”)
            .否则
                赋值 (“城镇”)
            .如果结束
            赋值 (.)
            赋值 (.)
            赋值 (.)
            赋值 (.取项目文本 (.))
            赋值 (.)
            赋值 (.)
            赋值 (.)
            赋值 (.)
            加记录 ()
            清空 ()
            填充列表框1 ()
            .选择 ()
            填充学籍 ()
            
        .否则
            信息框 (“修改出错”, 0, )
        .如果结束
        
    .否则
        .如果 (等于 (判断增改, “转入”))
            赋值 (.)
            置当前库 (“xueji”)
            到首记录 ()
            .如果 (并且 (等于 (取文本长度 (.), 10), 不等于 (., “”)))
                .如果 (等于 (查找 (等于 (读 (#学籍号), )), 假))
                    .加入项目 (., )
                    .选择 (.)
                    赋值 (., #白色)
                    赋值 (., 0)
                    子程序1 ()
                .否则
                    信息框 (相加 (“学籍号为”, , “的学生已经存在！”), 0, )
                .如果结束
                
            .否则
                信息框 (“应把学生的学籍号及姓名输入完整！”, 0, )
            .如果结束
            
        .否则
            
        .如果结束
        
        
    .如果结束
    
.如果结束


.子程序 子程序1, 空白型, , 
.局部变量 ss, 文本型, , , 
.局部变量 w, 文本型, , , 

赋值 (.取项目文本 (.))
赋值 (.取项目文本 (.))
赋值 (.)
赋值 (.)
.如果 (等于 (., 假))
    赋值 (“女”)
.否则
    赋值 (“男”)
.如果结束
赋值 (.取项目文本 (.))
赋值 (.)
赋值 (.)
赋值 (.)
赋值 (.取项目文本 (.))
.如果 (等于 (., 假))
    赋值 (“农业”)
.否则
    赋值 (“城镇”)
.如果结束
赋值 (.)
赋值 (.)
赋值 (.)
赋值 (.取项目文本 (.))
赋值 (.)
赋值 (.)
赋值 (.)
赋值 (.)
置当前库 (“xueji”)
加记录 ()
.如果 (等于 (判断增改, “转入”))
    .如果真 (等于 (文件是否存在 (“biandong.edb”), 假))
        赋值 (学籍字段 [1]., #学校名称)
        赋值 ( [1]., #文本型)
        赋值 ( [1]., 20)
        赋值 ( [2]., #班级名)
        赋值 ( [2]., #文本型)
        赋值 ( [2]., 6)
        赋值 ( [3]., #学籍号)
        赋值 ( [3]., #文本型)
        赋值 ( [3]., 10)
        赋值 ( [4]., #姓名)
        赋值 ( [4]., #文本型)
        赋值 ( [4]., 8)
        赋值 ( [5]., #性别)
        赋值 ( [5]., #文本型)
        赋值 ( [5]., 2)
        赋值 ( [6]., #民族)
        赋值 ( [6]., #文本型)
        赋值 ( [6]., 4)
        赋值 ( [7]., #籍贯)
        赋值 ( [7]., #文本型)
        赋值 ( [7]., 20)
        赋值 ( [8]., #出生年月)
        赋值 ( [8]., #文本型)
        赋值 ( [8]., 14)
        赋值 ( [9]., #入学年月)
        赋值 ( [9]., #文本型)
        赋值 ( [9]., 14)
        
        赋值 ( [10]., #户口所在地)
        赋值 ( [10]., #文本型)
        赋值 ( [10]., 20)
        赋值 ( [11]., #户口性质)
        赋值 ( [11]., #文本型)
        赋值 ( [11]., 4)
        赋值 ( [12]., #家庭住址)
        赋值 ( [12]., #文本型)
        赋值 ( [12]., 30)
        赋值 ( [13]., #父母户口所在地)
        赋值 ( [13]., #文本型)
        赋值 ( [13]., 40)
        赋值 ( [14]., #本人户口所在地)
        赋值 ( [14]., #文本型)
        赋值 ( [14]., 40)
        赋值 ( [15]., #监护人称谓)
        赋值 ( [15]., #文本型)
        赋值 ( [15]., 6)
        赋值 ( [16]., #监护人姓名)
        赋值 ( [16]., #文本型)
        赋值 ( [16]., 8)
        赋值 ( [17]., #监护人工作单位)
        赋值 ( [17]., #文本型)
        赋值 ( [17]., 30)
        赋值 ( [18]., #监护人电话)
        赋值 ( [18]., #文本型)
        赋值 ( [18]., 12)
        赋值 ( [19]., #照片)
        赋值 ( [19]., #字节集型)
        赋值 ( [20]., #时间)
        赋值 ( [20]., #文本型)
        赋值 ( [20]., 14)
        
        赋值 ( [21]., #原因)
        赋值 ( [21]., #文本型)
        赋值 ( [21]., 30)
        
        赋值 ( [22]., #目的地)
        赋值 ( [22]., #文本型)
        赋值 ( [22]., 30)
        赋值 ( [23]., #类型)
        赋值 ( [23]., #文本型)
        赋值 ( [23]., 8)
        
        .如果真 (等于 (创建 (“biandong.edb”, ), 假))
            信息框 (“创建系统数据库失败！”, #错误图标, “错误”)
            结束 ()
        .如果真结束
        
    .如果真结束
    .如果真 (等于 (打开 (“biandong.edb”, , , , , , ), 假))
        信息框 (“无法打开系统数据库！”, #错误图标, “错误”)
        结束 ()
    .如果真结束
    输入框 (“请输入转学的原因:”, , , , )
    赋值 (“转入增加”)
    赋值 (时间到文本 (取现行时间 (), 2))
    置当前库 (“biandong”)
    加记录 ()
    关闭 (“biandong”)
    _取消钮_被单击 ()
.否则
    .如果 (等于 (., 真))
        赋值 (ss, 取文本左边 (., 7))
        赋值 (w, 数值到格式文本 (相加 (到数值 (取文本右边 (., 3)), 1), , 假))
        .如果 (等于 (取文本长度 (), 1))
            赋值 (., 相加 (ss, “00”, w))
        .否则
            .如果 (等于 (取文本长度 (), 2))
                赋值 (., 相加 (ss, “0”, w))
            .否则
                .如果 (等于 (取文本长度 (), 3))
                    赋值 (., 相加 (ss, w))
                .否则
                    .如果 (大于或等于 (取文本长度 (w), 4))
                        信息框 (“学生数最多为999人！！！”, 0, “学生数过多”)
                        _取消钮_被单击 ()
                    .否则
                        
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .否则
        
    .如果结束
    
    
.如果结束


.子程序 _取消钮_被单击, 空白型, , 
赋值 (., 0)
填充学籍 ()
赋值 (., #浅灰)
赋值 (., 1)
赋值 (., 真)
赋值 (., 假)
赋值 (., 假)
赋值 (., 假)
赋值 (., 假)
赋值 (., 假)
赋值 (., 假)
赋值 (., 真)
赋值 (., 真)
赋值 (., 假)
赋值 (., 假)
赋值 (., 假)

.子程序 _修改钮_被单击, 空白型, , 
赋值 (判断增改, “修改”)
赋值 (., 真)
赋值 (., 真)
赋值 (., 真)
赋值 (., 真)
赋值 (., 真)
赋值 (., 真)
赋值 (., 真)
赋值 (., 真)
赋值 (., 真)
赋值 (., 假)
赋值 (., 假)
赋值 (., #浅灰)
赋值 (., 1)
获取焦点 ()
赋值 (., 8)
赋值 (., 8)

.子程序 _转出钮_被单击, 空白型, , 
.如果 (不等于 (., “”))
    赋值 (学校名称, .取项目文本 (.))
    赋值 (班级名, .取项目文本 (.))
    赋值 (姓名, .)
    赋值 (学籍号, .)
    载入 (转出窗口, _启动窗口, 真)
    _组合框2_列表被关闭 ()
    
.否则
    信息框 (“请选择好学生！”, 0, )
.如果结束


.子程序 _编辑框7_内容被改变, 空白型, , 
赋值 (., .)
赋值 (., .)

.子程序 _调班钮_被单击, 空白型, , 
.如果 (不等于 (., “”))
    赋值 (学校名称, .取项目文本 (.))
    赋值 (班级名, .取项目文本 (.))
    赋值 (姓名, .)
    赋值 (学籍号, .)
    载入 (调班窗口, _启动窗口, 真)
    _组合框2_列表被关闭 ()
    
.否则
    信息框 (“请选择好学生！”, 0, )
.如果结束


.子程序 _休学钮_被单击, 空白型, , 
.如果 (不等于 (., “”))
    赋值 (学校名称, .取项目文本 (.))
    赋值 (班级名, .取项目文本 (.))
    赋值 (姓名, .)
    赋值 (学籍号, .)
    载入 (休学窗口, _启动窗口, 真)
    _组合框2_列表被关闭 ()
    
.否则
    信息框 (“请选择好学生！”, 0, )
.如果结束


.子程序 _流失钮_被单击, 空白型, , 
.如果 (不等于 (., “”))
    赋值 (学校名称, .取项目文本 (.))
    赋值 (班级名, .取项目文本 (.))
    赋值 (姓名, .)
    赋值 (学籍号, .)
    载入 (窗口1, _启动窗口, 真)
    _组合框2_列表被关闭 ()
    
.否则
    信息框 (“请选择好学生！”, 0, )
.如果结束


.子程序 _学籍增加_被选择, 空白型, , 
_增加钮_被单击 ()

.子程序 _学生调班_被选择, 空白型, , 
_调班钮_被单击 ()

.子程序 _学籍转出_被选择, 空白型, , 
_转出钮_被单击 ()

.子程序 _学生休学_被选择, 空白型, , 
_休学钮_被单击 ()

.子程序 _学生流失_被选择, 空白型, , 
_流失钮_被单击 ()

.子程序 _图片框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_选择照片钮_被单击 ()

.子程序 _花名册_被选择, 空白型, , 
载入 (窗口2, , 真)

.子程序 _组合框1_列表项被选择, 空白型, , 
_组合框1_列表被关闭 ()

.子程序 _组合框2_列表项被选择, 空白型, , 
_组合框2_列表被关闭 ()

.子程序 _学籍卡_被选择, 空白型, , 
载入 (窗口4, _启动窗口, 真)

.子程序 _学籍变动表_被选择, 空白型, , 
载入 (窗口6, _启动窗口, 真)

.子程序 _学生证_被选择, 空白型, , 
信息框 (“暂时未提供打印学生证功能！”, 0, “不好意思^-^”)

.子程序 _学籍转入_被选择, 空白型, , 
_增加钮_被单击 ()
赋值 (判断增改, “转入”)

.子程序 _学生复学_被选择, 空白型, , 
载入 (窗口7, _启动窗口, 真)

.子程序 _学生毕业_被选择, 空白型, , 
.如果 (文件是否存在 (“biye.edb”))
    .如果 (等于 (信息框 (“六年级学生毕业数据已存在,覆盖吗?”, #是否钮, ), #是钮))
        .如果 (等于 (信息框 (“六年级学生全部毕业吗?如果不是全部毕业,请先把不毕业的学生调到相应的班级,再进行学生毕业处理。选择［确定］，继续；选择［取消］，退出。”, #确认取消钮, ), #确认钮))
            置当前库 (“xueji”)
            复制记录 (“biye.edb”, 等于 (取文本左边 (读 (#班级名), 2), “六”), )
            删除 (等于 (取文本左边 (读 (#班级名), 2), “六”))
            彻底删除 ()
            置当前库 (“banji”)
            删除 (等于 (取文本左边 (读 (#班级名), 2), “六”))
            彻底删除 ()
            _组合框1_列表被关闭 ()
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    
.否则
    .如果 (等于 (信息框 (“六年级学生全部毕业吗?如果不是全部毕业,请先把不毕业的学生调到相应的班级,再进行学生毕业处理。选择［确定］，继续；选择［取消］，退出。”, #确认取消钮, ), #确认钮))
        置当前库 (“xueji”)
        复制记录 (“biye.edb”, 等于 (取文本左边 (读 (#班级名), 2), “六”), )
        删除 (等于 (取文本左边 (读 (#班级名), 2), “六”))
        彻底删除 ()
        置当前库 (“banji”)
        删除 (等于 (取文本左边 (读 (#班级名), 2), “六”))
        彻底删除 ()
        _组合框1_列表被关闭 ()
    .否则
        
    .如果结束
    
.如果结束


.子程序 _学生留级_被选择, 空白型, , 
信息框 (“请直接将该生调到相应班级!”, 0, )
_调班钮_被单击 ()

.子程序 _学生升级_被选择, 空白型, , 
.如果 (等于 (取文本注册表项 (#学籍管理, #系统设置, “升级”, “否”), “是”))
    .如果 (等于 (信息框 (相加 (“你已经在”, 取文本注册表项 (#学籍管理, #系统设置, “升级时间”, “”), “进行过升级处理了，还要升级吗？”), #是否钮, ), #是钮))
        置当前库 (“banji”)
        到首记录 ()
        .如果 (查找 (等于 (取文本左边 (读 (#班级名), 2), “六”)))
            .如果 (等于 (信息框 (“六年级学生学籍进行毕业处理吗？”, #是否钮, ), #是钮))
                .如果 (文件是否存在 (“biye.edb”))
                    .如果 (等于 (信息框 (“六年级学生毕业数据已存在,覆盖吗?”, #是否钮, ), #是钮))
                        .如果 (等于 (信息框 (“六年级学生全部毕业吗?如果不是全部毕业,请先把不毕业的学生调到相应的班级,再进行学生毕业处理。选择［确定］，继续；选择［取消］，退出。”, #确认取消钮, ), #确认钮))
                            置当前库 (“xueji”)
                            复制记录 (“biye.edb”, 等于 (取文本左边 (读 (#班级名), 2), “六”), )
                            删除 (等于 (取文本左边 (读 (#班级名), 2), “六”))
                            彻底删除 ()
                            置当前库 (“banji”)
                            删除 (等于 (取文本左边 (读 (#班级名), 2), “六”))
                            彻底删除 ()
                        .否则
                            
                        .如果结束
                        
                    .否则
                        
                    .如果结束
                    
                .否则
                    .如果 (等于 (信息框 (“六年级学生全部毕业吗?如果不是全部毕业,请先把不毕业的学生调到相应的班级,再进行学生毕业处理。选择［确定］，继续；选择［取消］，退出。”, #确认取消钮, ), #确认钮))
                        置当前库 (“xueji”)
                        复制记录 (“biye.edb”, 等于 (取文本左边 (读 (#班级名), 2), “六”), )
                        删除 (等于 (取文本左边 (读 (#班级名), 2), “六”))
                        彻底删除 ()
                        置当前库 (“banji”)
                        删除 (等于 (取文本左边 (读 (#班级名), 2), “六”))
                        彻底删除 ()
                    .否则
                        
                    .如果结束
                    
                .如果结束
                
                
                子程序2 ()
            .否则
                信息框 (“六年级学生不进行毕业处理，其他学生不能升级？”, 0, )
            .如果结束
            
        .否则
            子程序2 ()
        .如果结束
        
    .否则
        
    .如果结束
    
.否则
    
.如果结束


.子程序 子程序2, 空白型, , 
置当前库 (“xueji”)
替换 (等于 (取文本左边 (读 (#班级名), 2), “五”), #班级名, 文本替换 (读 (#班级名), 1, 2, “六”))
替换 (等于 (取文本左边 (读 (#班级名), 2), “四”), #班级名, 文本替换 (读 (#班级名), 1, 2, “五”))
替换 (等于 (取文本左边 (读 (#班级名), 2), “三”), #班级名, 文本替换 (读 (#班级名), 1, 2, “四”))
替换 (等于 (取文本左边 (读 (#班级名), 2), “二”), #班级名, 文本替换 (读 (#班级名), 1, 2, “三”))
替换 (等于 (取文本左边 (读 (#班级名), 2), “一”), #班级名, 文本替换 (读 (#班级名), 1, 2, “二”))
置当前库 (“banji”)
替换 (等于 (取文本左边 (读 (#班级名), 2), “五”), #班级名, 文本替换 (读 (#班级名), 1, 2, “六”))
替换 (等于 (取文本左边 (读 (#班级名), 2), “四”), #班级名, 文本替换 (读 (#班级名), 1, 2, “五”))
替换 (等于 (取文本左边 (读 (#班级名), 2), “三”), #班级名, 文本替换 (读 (#班级名), 1, 2, “四”))
替换 (等于 (取文本左边 (读 (#班级名), 2), “二”), #班级名, 文本替换 (读 (#班级名), 1, 2, “三”))
替换 (等于 (取文本左边 (读 (#班级名), 2), “一”), #班级名, 文本替换 (读 (#班级名), 1, 2, “二”))
写注册表项 (#学籍管理, #系统设置, “升级时间”, 时间到文本 (取现行时间 (), 2))
写注册表项 (#学籍管理, #系统设置, “升级”, “是”)
_组合框1_列表被关闭 ()


.子程序 _退出系统_被选择, 空白型, , 
置当前库 (“xueji”)
排序 (“temp.edb”, #学籍号, , , )
全部关闭 ()
删除文件 (“xueji.edb”)
文件更名 (“temp.edb”, “xueji.edb”)
全部关闭 ()
结束 ()

.子程序 _音乐开关_被选择, 空白型, , 
.如果 (等于 (_启动窗口., 0))
    赋值 (_启动窗口., 2)
.否则
    赋值 (_启动窗口., 0)
.如果结束


.子程序 _备份数据_被选择, 空白型, , 
.局部变量 文件名, 文本型, , , 

.如果 (或者 (等于 (寻找文件 (“BAK”, 16), “BAK”), 等于 (寻找文件 (“BAK”, 16), “Bak”)))
    
.否则
    创建目录 (“BAK”)
.如果结束
赋值 (文件名, 寻找文件 (相加 (取当前目录 (), “\*.ED?”), ))
.判断循环首 (不等于 (“”))
    复制文件 (文件名, 相加 (取当前目录 (), “\BAK\”, 文件名))
    赋值 (寻找文件 ())
.判断循环尾 ()
信息框 (“数据备份完毕！”, 0, )


.子程序 _恢复数据_被选择, 空白型, , 
.局部变量 文件名, 文本型, , , 
.局部变量 ml, 文本型, , , 

.如果 (或者 (等于 (寻找文件 (“BAK”, 16), “BAK”), 等于 (寻找文件 (“BAK”, 16), “Bak”)))
    赋值 (ml, 取当前目录 ())
    改变目录 (相加 (取当前目录 (), “\Bak\”))
    全部关闭 ()
    赋值 (文件名, 寻找文件 (相加 (取当前目录 (), “\*.ED?”), ))
    .判断循环首 (不等于 (“”))
        复制文件 (文件名, 相加 (ml, “\”, 文件名))
        赋值 (寻找文件 ())
    .判断循环尾 ()
    改变目录 (ml)
    .如果真 (等于 (打开 (“xuexiao.edb”, , , , , , ), 假))
        信息框 (“无法打开系统数据库！”, #错误图标, “错误”)
        结束 ()
    .如果真结束
    .如果真 (等于 (打开 (“banji.edb”, , , , , , ), 假))
        信息框 (“无法打开系统数据库！”, #错误图标, “错误”)
        结束 ()
    .如果真结束
    .如果真 (等于 (打开 (“xueji.edb”, , , , , , ), 假))
        信息框 (“无法打开系统数据库！”, #错误图标, “错误”)
        结束 ()
    .如果真结束
    清空 ()
    清空 ()
    清空 ()
    填充组合框1 ()
    .如果 (大于 (取项目数 (), 0))
        填充组合框2 ()
        .如果 (大于 (取项目数 (), 0))
            填充列表框1 ()
            .如果 (大于 (取项目数 (), 0))
                赋值 (., 0)
                填充学籍 ()
                
            .否则
                列表框空 ()
            .如果结束
            
        .否则
            列表框空 ()
        .如果结束
        
    .否则
        
    .如果结束
    信息框 (“数据恢复完毕！”, 0, )
    
.否则
    
.如果结束



.子程序 _成绩单_被选择, 空白型, , 
载入 (窗口9, _启动窗口, 真)

.子程序 _数据排序_被选择, 空白型, , 
置当前库 (“xueji”)
排序 (“temp.edb”, #学籍号, , , )
全部关闭 ()
删除文件 (“xueji.edb”)
文件更名 (“temp.edb”, “xueji.edb”)
.如果真 (等于 (打开 (“xuexiao.edb”, , , , , , ), 假))
    信息框 (“无法打开系统数据库！”, #错误图标, “错误”)
    结束 ()
.如果真结束
.如果真 (等于 (打开 (“banji.edb”, , , , , , ), 假))
    信息框 (“无法打开系统数据库！”, #错误图标, “错误”)
    结束 ()
.如果真结束
.如果真 (等于 (打开 (“xueji.edb”, , , , , , ), 假))
    信息框 (“无法打开系统数据库！”, #错误图标, “错误”)
    结束 ()
.如果真结束
清空 ()
清空 ()
清空 ()
填充组合框1 ()
.如果 (大于 (取项目数 (), 0))
    填充组合框2 ()
    .如果 (大于 (取项目数 (), 0))
        填充列表框1 ()
        .如果 (大于 (取项目数 (), 0))
            赋值 (., 0)
            填充学籍 ()
            
        .否则
            列表框空 ()
        .如果结束
        
    .否则
        列表框空 ()
    .如果结束
    
.否则
    
.如果结束
信息框 (“数据排序完毕！”, 0, )

.子程序 __启动窗口_将被销毁, 空白型, , 
_退出系统_被选择 ()

.窗口程序集 窗口程序集2, , , 

.程序集变量 字段1, 文本型, , , 
.程序集变量 字段2, 文本型, , , 
.程序集变量 字段3, 文本型, , , 
.程序集变量 字段4, 文本型, , , 
.程序集变量 字段5, 文本型, , , 
.子程序 _按钮6_被单击, 空白型, , 
载入 (浏览考场窗口, , 真)

.子程序 _编排考场窗口_创建完毕, 空白型, , 
赋值 (., “30”)
赋值 (., “1”)
赋值 (., “01”)
置当前库 (“xuexiao”)
到首记录 ()
.计次循环首 (取记录数 (), )
    读 (#学校名称).加入项目 ()
    读 (#学校名称).加入项目 ()
    跳过 ()
.计次循环尾 ()
赋值 (., 0)
赋值 (., 0)
.如果 (文件是否存在 (“banji1.edb”))
    打开 (“banji1.edb”, , , , , , )
    
.否则
    置当前库 (“banji”)
    复制记录 (“banji1.edb”, , )
    打开 (“banji1.edb”, , , , , , )
    
.如果结束
.如果 (文件是否存在 (“banji2.edb”))
    打开 (“banji2.edb”, , , , , , )
    
.否则
    置当前库 (“banji”)
    复制结构 (“banji2.edb”, )
    打开 (“banji2.edb”, , , , , , )
    
.如果结束
置当前库 (“banji1”)
到首记录 ()
清空 ()
.计次循环首 (取记录数 (), )
    .如果 (等于 (读 (#学校名称), .取项目文本 (.)))
        读 (#班级名).加入项目 ()
    .否则
        
    .如果结束
    跳过 ()
.计次循环尾 ()
置当前库 (“banji2”)
到首记录 ()
清空 ()
.计次循环首 (取记录数 (), )
    .如果 (等于 (读 (#学校名称), .取项目文本 (.)))
        读 (#班级名).加入项目 ()
    .否则
        
    .如果结束
    跳过 ()
.计次循环尾 ()
赋值 (., 相加 (“已选”, 数值到格式文本 (取项目数 (), , 假), “个班”))



.子程序 _列表框1_列表项被选择, 空白型, , 
置当前库 (“banji1”)
到首记录 ()
.如果 (查找 (并且 (等于 (读 (#学校名称), .取项目文本 (.)), 等于 (读 (#班级名), .取项目文本 (.)))))
    赋值 (字段1, 读 (1))
    赋值 (字段2, 读 (2))
    赋值 (字段3, 读 (3))
    赋值 (字段4, 读 (4))
    赋值 (字段5, 读 (5))
    删除 (并且 (等于 (读 (#学校名称), .取项目文本 (.)), 等于 (读 (#班级名), .取项目文本 (.))))
    彻底删除 ()
    置当前库 (“banji2”)
    加记录 (字段1, 字段2, 字段3, 字段4, 字段5)
    .取项目文本 (.).加入项目 ()
    .删除项目 (.)
    赋值 (., 相加 (“已选”, 数值到格式文本 (取项目数 (), , 假), “个班”))
.否则
    
.如果结束




.子程序 _列表框2_列表项被选择, 空白型, , 
置当前库 (“banji2”)
到首记录 ()
.如果 (查找 (并且 (等于 (读 (#学校名称), .取项目文本 (.)), 等于 (读 (#班级名), .取项目文本 (.)))))
    赋值 (字段1, 读 (1))
    赋值 (字段2, 读 (2))
    赋值 (字段3, 读 (3))
    赋值 (字段4, 读 (4))
    赋值 (字段5, 读 (5))
    删除 (并且 (等于 (读 (#学校名称), .取项目文本 (.)), 等于 (读 (#班级名), .取项目文本 (.))))
    彻底删除 ()
    置当前库 (“banji1”)
    加记录 (字段1, 字段2, 字段3, 字段4, 字段5)
    .取项目文本 (.).加入项目 ()
    .删除项目 (.)
    赋值 (., 相加 (“已选”, 数值到格式文本 (取项目数 (), , 假), “个班”))
    
.否则
    信息框 (“出错！！！”, 0, )
.如果结束



.子程序 _组合框1_列表被关闭, 空白型, , 
置当前库 (“banji_temp”)
到首记录 ()
清空 ()
.计次循环首 (取记录数 (), )
    .如果 (等于 (读 (#学校名称), .取项目文本 (.)))
        读 (#班级名).加入项目 ()
    .否则
        
    .如果结束
    跳过 ()
.计次循环尾 ()


.子程序 _按钮7_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集3, , , 

.子程序 _浏览考场窗口_创建完毕, 空白型, , 
赋值 (浏览考场窗口., 0)
赋值 (浏览考场窗口., 相除 (相减 (取屏幕宽度 (), 浏览考场窗口.), 2))

.窗口程序集 窗口程序集4, , , 

.子程序 _系统设置窗口_创建完毕, 空白型, , 
赋值 (., 取文本注册表项 (#学籍管理, #系统设置, “县(区)”, “赣榆”))
赋值 (., 取文本注册表项 (#学籍管理, #系统设置, “乡(镇)”, “青口”))
清空 ()
清空 ()
置当前库 (“xuexiao”)
到首记录 ()
.计次循环首 (取记录数 (), )
    读 (#学校名称).加入项目 ()
    跳过 ()
.计次循环尾 ()
赋值 (., 0)
置当前库 (“banji”)
到首记录 ()
.计次循环首 (取记录数 (), )
    .如果 (等于 (读 (#学校名称), .取项目文本 (.)))
        读 (#班级名).加入项目 ()
    .否则
        
    .如果结束
    跳过 ()
.计次循环尾 ()
赋值 (., 0)
到首记录 ()
.如果 (查找 (并且 (等于 (读 (#学校名称), .取项目文本 (.)), 等于 (读 (#班级名), .取项目文本 (.)))))
    赋值 (., 读 (#语文教师))
    赋值 (., 读 (#数学教师))
.否则
    
.如果结束
置当前库 (“xuexiao”)
到首记录 ()
.如果 (查找 (等于 (读 (#学校名称), .取项目文本 (.))))
    赋值 (., 读 (#校长))
.否则
    
.如果结束


.子程序 _列表框1_列表项被选择, 空白型, , 
清空 ()
置当前库 (“banji”)
到首记录 ()
.计次循环首 (取记录数 (), )
    .如果 (等于 (读 (#学校名称), .取项目文本 (.)))
        读 (#班级名).加入项目 ()
    .否则
        
    .如果结束
    跳过 ()
.计次循环尾 ()
.如果 (大于 (取项目数 (), 0))
    赋值 (., 0)
    到首记录 ()
    .如果 (查找 (并且 (等于 (读 (#学校名称), .取项目文本 (.)), 等于 (读 (#班级名), .取项目文本 (.)))))
        .如果 (不等于 (读 (#语文教师), “”))
            赋值 (., 读 (#语文教师))
        .否则
            
        .如果结束
        .如果 (不等于 (读 (#数学教师), “”))
            赋值 (., 读 (#数学教师))
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    
.否则
    赋值 (., “”)
    赋值 (., “”)
.如果结束
置当前库 (“xuexiao”)
到首记录 ()
.如果 (查找 (等于 (读 (#学校名称), .取项目文本 (.))))
    .如果 (不等于 (读 (#校长), “”))
        赋值 (., 读 (#校长))
    .否则
        赋值 (., “”)
    .如果结束
    
.否则
    
.如果结束


.子程序 _列表框2_列表项被选择, 空白型, , 
置当前库 (“banji”)
到首记录 ()
.如果 (查找 (并且 (等于 (读 (#学校名称), .取项目文本 (.)), 等于 (读 (#班级名), .取项目文本 (.)))))
    .如果 (不等于 (读 (#语文教师), “”))
        赋值 (., 读 (#语文教师))
    .否则
        赋值 (., “”)
    .如果结束
    .如果 (不等于 (读 (#数学教师), “”))
        赋值 (., 读 (#数学教师))
    .否则
        赋值 (., “”)
    .如果结束
    
.否则
    
.如果结束


.子程序 _按钮6_被单击, 空白型, , 
写注册表项 (#学籍管理, #系统设置, “县(区)”, .)
写注册表项 (#学籍管理, #系统设置, “乡(镇)”, .)
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 学校名, 文本型, , , 
.局部变量 校长名, 文本型, , , 

.如果 (输入框 (“请输入学校名称:”, “学籍管理系统”, , 学校名, ))
    .如果 (不等于 (学校名, “”))
        学校名.加入项目 ()
        学校名.选择 ()
        清空 ()
        赋值 (., “”)
        赋值 (., “”)
        赋值 (., “”)
        .如果 (输入框 (“请输入校长姓名:”, “学籍管理系统”, , 校长名, ))
            .如果 (不等于 (校长名, “”))
                赋值 (., 校长名)
            .否则
                赋值 (., “”)
            .如果结束
            
        .否则
            
        .如果结束
        置当前库 (“xuexiao”)
        加记录 (学校名, 校长名)
    .否则
        
    .如果结束
    
.否则
    
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 标志, 逻辑型, , , 
.局部变量 校名, 文本型, , , 

赋值 (校名, .取项目文本 (.))
.如果 (不等于 (校名, “”))
    载入 (选择班级窗口, , 真)
    置当前库 (“banji”)
    赋值 (标志, 真)
    .如果 (不等于 (班级, “”))
        到首记录 ()
        .计次循环首 (取记录数 (), )
            .如果 (并且 (等于 (读 (#学校名称), .取项目文本 (.)), 等于 (读 (#班级名), 班级)))
                信息框 (相加 (.取项目文本 (.), “已经有”, 班级, “班”), 0, )
                赋值 (标志, 假)
                跳出循环 ()
            .否则
                跳过 ()
            .如果结束
            
        .计次循环尾 ()
        .如果 (等于 (标志, 真))
            加记录 (.取项目文本 (.), 班级, )
            班级.加入项目 ()
            班级.选择 ()
            赋值 (., “”)
            赋值 (., “”)
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    
.否则
    信息框 (“请先选择一个学校！”, 0, “提示”)
.如果结束


.子程序 _编辑框3_失去焦点, 空白型, , 
置当前库 (“xuexiao”)
到首记录 ()
查找 (等于 (读 (#学校名称), .取项目文本 (.)))
修改 (.)
获取焦点 ()

.子程序 _编辑框3_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, #回车键))
    _编辑框3_失去焦点 ()
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框4_失去焦点, 空白型, , 
置当前库 (“banji”)
到首记录 ()
查找 (并且 (等于 (读 (#学校名称), .取项目文本 (.)), 等于 (读 (#班级名), .取项目文本 (.))))
修改 (.)
获取焦点 ()

.子程序 _编辑框4_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (#回车键))
    _编辑框4_失去焦点 ()
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框5_失去焦点, 空白型, , 
置当前库 (“banji”)
到首记录 ()
查找 (并且 (等于 (读 (#学校名称), .取项目文本 (.)), 等于 (读 (#班级名), .取项目文本 (.))))
修改 (.)

.子程序 _编辑框5_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (#回车键))
    _编辑框5_失去焦点 ()
.否则
    
.如果结束


.子程序 _按钮3_被单击, 空白型, , 
.局部变量 校名, 文本型, , , 

赋值 (校名, .取项目文本 (.))
.如果 (不等于 (校名, “”))
    .如果 (等于 (信息框 (相加 (“你确定要删除[”, 校名, “]吗?如果按下[确定],将删除该校的所有信息!!!”), 1, ), #确认钮))
        赋值 (校名, .取项目文本 (.))
        置当前库 (“xuexiao”)
        到首记录 ()
        .计次循环首 (取记录数 (), )
            .如果 (等于 (读 (#学校名称), 校名))
                删除 ()
            .否则
                
            .如果结束
            跳过 ()
        .计次循环尾 ()
        彻底删除 ()
        置当前库 (“banji”)
        到首记录 ()
        .计次循环首 (取记录数 (), )
            .如果 (等于 (读 (#学校名称), 校名))
                删除 ()
            .否则
                
            .如果结束
            跳过 ()
        .计次循环尾 ()
        彻底删除 ()
        置当前库 (“xueji”)
        到首记录 ()
        .计次循环首 (取记录数 (), )
            .如果 (等于 (读 (#学校名称), 校名))
                删除 ()
            .否则
                
            .如果结束
            跳过 ()
        .计次循环尾 ()
        彻底删除 ()
        .删除项目 (.)
        清空 ()
        赋值 (., “”)
        信息框 (“该校信息已经全部删除!!!”, 0, )
    .否则
        
    .如果结束
    
.否则
    信息框 (“请先选择一个学校！”, 0, “提示”)
.如果结束


.子程序 _按钮4_被单击, 空白型, , 
.局部变量 班名, 文本型, , , 
.局部变量 校名, 文本型, , , 

赋值 (校名, .取项目文本 (.))
赋值 (班名, .取项目文本 (.))
.如果 (不等于 (班名, “”))
    .如果 (等于 (信息框 (相加 (“你确定要删除[”, 校名, “]的[”, 班名, “]班吗?如果按下[确定],将删除该班的所有信息!!!”), 1, ), #确认钮))
        赋值 (校名, .取项目文本 (.))
        赋值 (班名, .取项目文本 (.))
        置当前库 (“banji”)
        到首记录 ()
        .计次循环首 (取记录数 (), )
            .如果 (并且 (等于 (读 (#学校名称), 校名), 等于 (读 (#班级名), 班名)))
                删除 ()
            .否则
                
            .如果结束
            跳过 ()
        .计次循环尾 ()
        彻底删除 ()
        置当前库 (“xueji”)
        到首记录 ()
        .计次循环首 (取记录数 (), )
            .如果 (并且 (等于 (读 (#学校名称), 校名), 等于 (读 (#班级名), 班名)))
                删除 ()
            .否则
                
            .如果结束
            跳过 ()
        .计次循环尾 ()
        彻底删除 ()
        .删除项目 (.)
        赋值 (., “”)
        赋值 (., “”)
        信息框 (“该班信息已经全部删除!!!”, 0, )
    .否则
        
    .如果结束
    
.否则
    信息框 (“请先选择一个班级！”, 0, )
.如果结束


.窗口程序集 窗口程序集5, , , 

.子程序 _按钮1_被单击, 空白型, , 
赋值 (班级, 相加 (.取项目文本 (.), “(”, .取项目文本 (.), “)”))
销毁 ()

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集6, , , 

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 a, 字节集, , , 

赋值 (选择图片, .)
.如果 (大于 (取字节集长度 (选择图片), 0))
    赋值 (选择图片, .)
.否则
    赋值 (选择图片, a)
    
.如果结束
销毁 ()

.子程序 _目录框1_目录被改变, 空白型, , 
赋值 (., .)

.子程序 _驱动器框1_驱动器被改变, 空白型, , 
连续赋值 (相加 (., “:\”), ., .)


.子程序 _选择照片窗口_空闲, 逻辑型, , 
.参数 已空闲时间, 整数型, , 

.局部变量 已显示文件, 文本型, 静态, , 
.局部变量 现在应显示文件, 文本型, , , 

.如果真 (大于 (已空闲时间, 10))
    .如果真 (并且 (等于 (取文本长度 (.), 0), 大于 (取文本长度 (已显示文件), 0)))
        赋值 (., {  })
        赋值 (已显示文件, “”)
        返回 (假)
    .如果真结束
    赋值 (现在应显示文件, .)
    .如果真 (不等于 (取文本右边 (现在应显示文件, 1), “\”))
        赋值 (现在应显示文件, 相加 (现在应显示文件, “\”))
    .如果真结束
    赋值 (现在应显示文件, 相加 (现在应显示文件, .))
    .如果 (不等于 (现在应显示文件, 已显示文件))
        赋值 (., 读入文件 (现在应显示文件))
        赋值 (已显示文件, 现在应显示文件)
    .否则
        返回 (假)
    .如果结束
    
.如果真结束
返回 (真)


.窗口程序集 窗口程序集7, , , 

.子程序 _按钮1_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集8, , , 

.子程序 _按钮1_被单击, 空白型, , 
.如果 (等于 (., “123”))
    
.否则
    信息框 (“用户名或密码错误，请核对后重新输入！”, 0, )
    
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
结束 ()

.子程序 _登陆窗口_创建完毕, 空白型, , 
获取焦点 ()

.窗口程序集 窗口程序集9, , , 

.程序集变量 学籍字段, 字段信息, , "23", 
.子程序 _转出窗口_创建完毕, 空白型, , 
.如果真 (等于 (文件是否存在 (“biandong.edb”), 假))
    赋值 (学籍字段 [1]., #学校名称)
    赋值 ( [1]., #文本型)
    赋值 (学籍字段 [1]., 20)
    赋值 ( [2]., #班级名)
    赋值 ( [2]., #文本型)
    赋值 ( [2]., 6)
    赋值 ( [3]., #学籍号)
    赋值 ( [3]., #文本型)
    赋值 ( [3]., 10)
    赋值 ( [4]., #姓名)
    赋值 ( [4]., #文本型)
    赋值 ( [4]., 8)
    赋值 ( [5]., #性别)
    赋值 ( [5]., #文本型)
    赋值 ( [5]., 2)
    赋值 ( [6]., #民族)
    赋值 ( [6]., #文本型)
    赋值 ( [6]., 4)
    赋值 ( [7]., #籍贯)
    赋值 ( [7]., #文本型)
    赋值 ( [7]., 20)
    赋值 ( [8]., #出生年月)
    赋值 ( [8]., #文本型)
    赋值 ( [8]., 14)
    赋值 ( [9]., #入学年月)
    赋值 ( [9]., #文本型)
    赋值 ( [9]., 14)
    
    赋值 ( [10]., #户口所在地)
    赋值 ( [10]., #文本型)
    赋值 ( [10]., 20)
    赋值 ( [11]., #户口性质)
    赋值 ( [11]., #文本型)
    赋值 ( [11]., 4)
    赋值 ( [12]., #家庭住址)
    赋值 ( [12]., #文本型)
    赋值 ( [12]., 30)
    赋值 ( [13]., #父母户口所在地)
    赋值 ( [13]., #文本型)
    赋值 ( [13]., 40)
    赋值 ( [14]., #本人户口所在地)
    赋值 ( [14]., #文本型)
    赋值 ( [14]., 40)
    赋值 ( [15]., #监护人称谓)
    赋值 ( [15]., #文本型)
    赋值 ( [15]., 6)
    赋值 ( [16]., #监护人姓名)
    赋值 ( [16]., #文本型)
    赋值 ( [16]., 8)
    赋值 ( [17]., #监护人工作单位)
    赋值 ( [17]., #文本型)
    赋值 ( [17]., 30)
    赋值 ( [18]., #监护人电话)
    赋值 ( [18]., #文本型)
    赋值 ( [18]., 12)
    赋值 ( [19]., #照片)
    赋值 ( [19]., #字节集型)
    赋值 (学籍字段 [20]., #时间)
    赋值 (学籍字段 [20]., #文本型)
    赋值 (学籍字段 [20]., 14)
    
    赋值 (学籍字段 [21]., #原因)
    赋值 (学籍字段 [21]., #文本型)
    赋值 (学籍字段 [21]., 30)
    
    赋值 (学籍字段 [22]., #目的地)
    赋值 (学籍字段 [22]., #文本型)
    赋值 (学籍字段 [22]., 30)
    赋值 (学籍字段 [23]., #类型)
    赋值 (学籍字段 [23]., #文本型)
    赋值 (学籍字段 [23]., 8)
    
    .如果真 (等于 (创建 (“biandong.edb”, 学籍字段), 假))
        信息框 (“创建系统数据库失败！”, #错误图标, “错误”)
        结束 ()
    .如果真结束
    
.如果真结束
.如果真 (等于 (打开 (“biandong.edb”, , , , , , ), 假))
    信息框 (“无法打开系统数据库！”, #错误图标, “错误”)
    结束 ()
.如果真结束

获取焦点 ()
赋值 (转出窗口., 相加 (学校名称, 班级名, “班”))
赋值 (., 相加 (“姓名：”, 姓名, “  学籍号为：”, 学籍号))

.子程序 _按钮3_被单击, 空白型, , 
关闭 (“biandong”)
销毁 ()

.子程序 _按钮2_被单击, 空白型, , 
.如果 (并且 (不等于 (., “”), 不等于 (., “”)))
    置当前库 (“xueji”)
    到首记录 ()
    .如果 (查找 (并且 (等于 (读 (#学校名称), 学校名称), 等于 (读 (#班级名), 班级名), 等于 (读 (#学籍号), 学籍号))))
        赋值 (读 (#性别))
        赋值 (读 (#民族))
        赋值 (读 (#籍贯))
        赋值 (读 (#出生年月))
        赋值 (读 (#入学年月))
        赋值 (读 (#户口所在地))
        赋值 (读 (#户口性质))
        赋值 (读 (#家庭住址))
        赋值 (读 (#父母户口所在地))
        赋值 (读 (#本人户口所在地))
        赋值 (读 (#监护人称谓))
        赋值 (读 (#监护人姓名))
        赋值 (读 (#监护人工作单位))
        赋值 (读 (#监护人电话))
        赋值 (读 (#照片))
        赋值 (时间到文本 (., 2))
        赋值 (.)
        赋值 (.)
        赋值 (“减少”)
        删除 ()
        彻底删除 ()
        置当前库 (“biandong”)
        加记录 (学校名称, 班级名, 学籍号, 姓名, 性别, 民族, 籍贯, 出生年月, 入学年月, 户口所在地, 户口性质, 家庭住址, 父母户口所在地, 本人户口所在地, 监护人称谓, 监护人姓名, 监护人工作单位, 监护人电话, 照片, 时间, 原因, 目的地, 类型)
        销毁 ()
    .否则
        信息框 (“系统出现未知错误！请关闭本软件，然后重新运行！”, 0, )
    .如果结束
    
.否则
    信息框 (“请把转学原因及转往学校填写完整”, 0, )
    获取焦点 ()
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
.如果 (并且 (不等于 (., “”), 不等于 (., “”)))
    置当前库 (“xueji”)
    到首记录 ()
    .如果 (查找 (并且 (等于 (读 (#学校名称), 学校名称), 等于 (读 (#班级名), 班级名), 等于 (读 (#学籍号), 学籍号))))
        赋值 (读 (#性别))
        赋值 (读 (#民族))
        赋值 (读 (#籍贯))
        赋值 (读 (#出生年月))
        赋值 (读 (#入学年月))
        赋值 (读 (#户口所在地))
        赋值 (读 (#户口性质))
        赋值 (读 (#家庭住址))
        赋值 (读 (#父母户口所在地))
        赋值 (读 (#本人户口所在地))
        赋值 (读 (#监护人称谓))
        赋值 (读 (#监护人姓名))
        赋值 (读 (#监护人工作单位))
        赋值 (读 (#监护人电话))
        赋值 (读 (#照片))
        赋值 (时间到文本 (., 2))
        赋值 (.)
        赋值 (.)
        赋值 (“转出减少”)
        删除 ()
        彻底删除 ()
        置当前库 (“biandong”)
        加记录 (学校名称, 班级名, 学籍号, 姓名, 性别, 民族, 籍贯, 出生年月, 入学年月, 户口所在地, 户口性质, 家庭住址, 父母户口所在地, 本人户口所在地, 监护人称谓, 监护人姓名, 监护人工作单位, 监护人电话, 照片, 时间, 原因, 目的地, 类型)
        信息框 (“开始打印转学证。。。”, 0, )
        信息框 (“暂时未提供打印转学证功能！”, 0, )
        销毁 ()
    .否则
        信息框 (“系统出现未知错误！请关闭本软件，然后重新运行！”, 0, )
    .如果结束
    
.否则
    信息框 (“请把转学原因及转往学校填写完整”, 0, )
    获取焦点 ()
.如果结束



.子程序 _转出窗口_将被销毁, 空白型, , 
关闭 (“biandong”)


.窗口程序集 窗口程序集10, , , 

.子程序 _调班窗口_创建完毕, 空白型, , 
赋值 (., 相加 (“姓名：”, 姓名, “  学籍号：”, 学籍号))
赋值 (调班窗口., 相加 (学校名称, 班级名, “班”))
置当前库 (“xuexiao”)
.如果 (不等于 (取记录数 (), 0))
    到首记录 ()
    .计次循环首 (取记录数 (), )
        读 (#学校名称).加入项目 ()
        跳过 ()
    .计次循环尾 ()
    赋值 (., 0)
    置当前库 (“banji”)
    .如果 (不等于 (取记录数 (), 0))
        到首记录 ()
        .计次循环首 (取记录数 (), )
            .如果 (等于 (读 (#学校名称), .取项目文本 (.)))
                读 (#班级名).加入项目 ()
            .否则
                
            .如果结束
            跳过 ()
        .计次循环尾 ()
        赋值 (., 0)
    .否则
        信息框 (“无可用的学校及班级信息，不能调班！”, 0, )
        销毁 ()
    .如果结束
    
.否则
    信息框 (“无可用的学校及班级信息，不能调班！”, 0, )
    销毁 ()
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
置当前库 (“xueji”)
到首记录 ()
.如果 (查找 (并且 (等于 (读 (#学校名称), 学校名称), 等于 (读 (#班级名), 班级名), 等于 (读 (#学籍号), 学籍号))))
    修改 (.取项目文本 (.), .取项目文本 (.), , , , , , , , , , , , , , , , , , )
    销毁 ()
.否则
    信息框 (“系统出现未知错误！调班不成功！”, 0, )
    返回 ()
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集11, , , 

.程序集变量 学籍字段, 字段信息, , "23", 
.子程序 _休学窗口_创建完毕, 空白型, , 
.如果真 (等于 (文件是否存在 (“biandong.edb”), 假))
    赋值 ( [1]., #学校名称)
    赋值 ( [1]., #文本型)
    赋值 ( [1]., 20)
    赋值 ( [2]., #班级名)
    赋值 ( [2]., #文本型)
    赋值 ( [2]., 6)
    赋值 ( [3]., #学籍号)
    赋值 ( [3]., #文本型)
    赋值 ( [3]., 10)
    赋值 ( [4]., #姓名)
    赋值 ( [4]., #文本型)
    赋值 ( [4]., 8)
    赋值 ( [5]., #性别)
    赋值 ( [5]., #文本型)
    赋值 ( [5]., 2)
    赋值 ( [6]., #民族)
    赋值 ( [6]., #文本型)
    赋值 ( [6]., 4)
    赋值 ( [7]., #籍贯)
    赋值 ( [7]., #文本型)
    赋值 ( [7]., 20)
    赋值 ( [8]., #出生年月)
    赋值 ( [8]., #文本型)
    赋值 ( [8]., 14)
    赋值 ( [9]., #入学年月)
    赋值 ( [9]., #文本型)
    赋值 ( [9]., 14)
    
    赋值 ( [10]., #户口所在地)
    赋值 ( [10]., #文本型)
    赋值 ( [10]., 20)
    赋值 ( [11]., #户口性质)
    赋值 ( [11]., #文本型)
    赋值 ( [11]., 4)
    赋值 ( [12]., #家庭住址)
    赋值 ( [12]., #文本型)
    赋值 ( [12]., 30)
    赋值 ( [13]., #父母户口所在地)
    赋值 ( [13]., #文本型)
    赋值 ( [13]., 40)
    赋值 ( [14]., #本人户口所在地)
    赋值 ( [14]., #文本型)
    赋值 ( [14]., 40)
    赋值 ( [15]., #监护人称谓)
    赋值 ( [15]., #文本型)
    赋值 ( [15]., 6)
    赋值 ( [16]., #监护人姓名)
    赋值 ( [16]., #文本型)
    赋值 ( [16]., 8)
    赋值 ( [17]., #监护人工作单位)
    赋值 ( [17]., #文本型)
    赋值 ( [17]., 30)
    赋值 ( [18]., #监护人电话)
    赋值 ( [18]., #文本型)
    赋值 ( [18]., 12)
    赋值 ( [19]., #照片)
    赋值 ( [19]., #字节集型)
    赋值 ( [20]., #时间)
    赋值 ( [20]., #文本型)
    赋值 ( [20]., 14)
    
    赋值 ( [21]., #原因)
    赋值 ( [21]., #文本型)
    赋值 ( [21]., 30)
    
    赋值 ( [22]., #目的地)
    赋值 ( [22]., #文本型)
    赋值 ( [22]., 30)
    赋值 ( [23]., #类型)
    赋值 ( [23]., #文本型)
    赋值 ( [23]., 8)
    
    .如果真 (等于 (创建 (“biandong.edb”, ), 假))
        信息框 (“创建系统数据库失败！”, #错误图标, “错误”)
        结束 ()
    .如果真结束
    
.如果真结束
.如果真 (等于 (打开 (“biandong.edb”, , , , , , ), 假))
    信息框 (“无法打开系统数据库！”, #错误图标, “错误”)
    结束 ()
.如果真结束

获取焦点 ()
赋值 (休学窗口., 相加 (学校名称, 班级名, “班”))
赋值 (., 相加 (“姓名：”, 姓名, “  学籍号为：”, 学籍号))


.子程序 _按钮2_被单击, 空白型, , 
关闭 (“biandong”)
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
.如果 (不等于 (., “”))
    置当前库 (“xueji”)
    到首记录 ()
    .如果 (查找 (并且 (等于 (读 (#学校名称), 学校名称), 等于 (读 (#班级名), 班级名), 等于 (读 (#学籍号), 学籍号))))
        赋值 (读 (#性别))
        赋值 (读 (#民族))
        赋值 (读 (#籍贯))
        赋值 (读 (#出生年月))
        赋值 (读 (#入学年月))
        赋值 (读 (#户口所在地))
        赋值 (读 (#户口性质))
        赋值 (读 (#家庭住址))
        赋值 (读 (#父母户口所在地))
        赋值 (读 (#本人户口所在地))
        赋值 (读 (#监护人称谓))
        赋值 (读 (#监护人姓名))
        赋值 (读 (#监护人工作单位))
        赋值 (读 (#监护人电话))
        赋值 (读 (#照片))
        赋值 (时间到文本 (., 2))
        赋值 (.)
        赋值 (“”)
        赋值 (“休学减少”)
        删除 ()
        彻底删除 ()
        置当前库 (“biandong”)
        加记录 (学校名称, 班级名, 学籍号, 姓名, , , , , , , , , , , , , , , , , , , )
        销毁 ()
    .否则
        信息框 (“系统出现未知错误！请关闭本软件，然后重新运行！”, 0, )
    .如果结束
    
.否则
    信息框 (“请输入休学原因！”, 0, )
    获取焦点 ()
.如果结束


.子程序 _休学窗口_将被销毁, 空白型, , 
关闭 (“biandong”)


.窗口程序集 窗口程序集12, , , 

.程序集变量 学籍字段, 字段信息, , "23", 
.子程序 _窗口1_创建完毕, 空白型, , 
.如果真 (等于 (文件是否存在 (“biandong.edb”), 假))
    赋值 ( [1]., #学校名称)
    赋值 ( [1]., #文本型)
    赋值 ( [1]., 20)
    赋值 ( [2]., #班级名)
    赋值 ( [2]., #文本型)
    赋值 ( [2]., 6)
    赋值 ( [3]., #学籍号)
    赋值 ( [3]., #文本型)
    赋值 ( [3]., 10)
    赋值 ( [4]., #姓名)
    赋值 ( [4]., #文本型)
    赋值 ( [4]., 8)
    赋值 ( [5]., #性别)
    赋值 ( [5]., #文本型)
    赋值 ( [5]., 2)
    赋值 ( [6]., #民族)
    赋值 ( [6]., #文本型)
    赋值 ( [6]., 4)
    赋值 ( [7]., #籍贯)
    赋值 ( [7]., #文本型)
    赋值 ( [7]., 20)
    赋值 ( [8]., #出生年月)
    赋值 ( [8]., #文本型)
    赋值 ( [8]., 14)
    赋值 ( [9]., #入学年月)
    赋值 ( [9]., #文本型)
    赋值 ( [9]., 14)
    
    赋值 ( [10]., #户口所在地)
    赋值 ( [10]., #文本型)
    赋值 ( [10]., 20)
    赋值 ( [11]., #户口性质)
    赋值 ( [11]., #文本型)
    赋值 ( [11]., 4)
    赋值 ( [12]., #家庭住址)
    赋值 ( [12]., #文本型)
    赋值 ( [12]., 30)
    赋值 ( [13]., #父母户口所在地)
    赋值 ( [13]., #文本型)
    赋值 ( [13]., 40)
    赋值 ( [14]., #本人户口所在地)
    赋值 ( [14]., #文本型)
    赋值 ( [14]., 40)
    赋值 ( [15]., #监护人称谓)
    赋值 ( [15]., #文本型)
    赋值 ( [15]., 6)
    赋值 ( [16]., #监护人姓名)
    赋值 ( [16]., #文本型)
    赋值 ( [16]., 8)
    赋值 ( [17]., #监护人工作单位)
    赋值 ( [17]., #文本型)
    赋值 ( [17]., 30)
    赋值 ( [18]., #监护人电话)
    赋值 ( [18]., #文本型)
    赋值 ( [18]., 12)
    赋值 ( [19]., #照片)
    赋值 ( [19]., #字节集型)
    赋值 ( [20]., #时间)
    赋值 ( [20]., #文本型)
    赋值 ( [20]., 14)
    
    赋值 ( [21]., #原因)
    赋值 ( [21]., #文本型)
    赋值 ( [21]., 30)
    
    赋值 ( [22]., #目的地)
    赋值 ( [22]., #文本型)
    赋值 ( [22]., 30)
    赋值 ( [23]., #类型)
    赋值 ( [23]., #文本型)
    赋值 ( [23]., 8)
    
    .如果真 (等于 (创建 (“biandong.edb”, ), 假))
        信息框 (“创建系统数据库失败！”, #错误图标, “错误”)
        结束 ()
    .如果真结束
    
.如果真结束
.如果真 (等于 (打开 (“biandong.edb”, , , , , , ), 假))
    信息框 (“无法打开系统数据库！”, #错误图标, “错误”)
    结束 ()
.如果真结束

获取焦点 ()
赋值 (窗口1., 相加 (学校名称, 班级名, “班”))
赋值 (., 相加 (“姓名：”, 姓名, “  学籍号为：”, 学籍号))

.子程序 _按钮2_被单击, 空白型, , 
关闭 (“biandong”)
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
.如果 (不等于 (., “”))
    置当前库 (“xueji”)
    到首记录 ()
    .如果 (查找 (并且 (等于 (读 (#学校名称), 学校名称), 等于 (读 (#班级名), 班级名), 等于 (读 (#学籍号), 学籍号))))
        赋值 (读 (#性别))
        赋值 (读 (#民族))
        赋值 (读 (#籍贯))
        赋值 (读 (#出生年月))
        赋值 (读 (#入学年月))
        赋值 (读 (#户口所在地))
        赋值 (读 (#户口性质))
        赋值 (读 (#家庭住址))
        赋值 (读 (#父母户口所在地))
        赋值 (读 (#本人户口所在地))
        赋值 (读 (#监护人称谓))
        赋值 (读 (#监护人姓名))
        赋值 (读 (#监护人工作单位))
        赋值 (读 (#监护人电话))
        赋值 (读 (#照片))
        赋值 (时间到文本 (., 2))
        赋值 (.)
        赋值 (“”)
        赋值 (“流失减少”)
        删除 ()
        彻底删除 ()
        置当前库 (“biandong”)
        加记录 (学校名称, 班级名, 学籍号, 姓名, , , , , , , , , , , , , , , , , , , )
        关闭 (“biandong”)
        销毁 ()
    .否则
        信息框 (“系统出现未知错误！请关闭本软件，然后重新运行！”, 0, )
    .如果结束
    
.否则
    信息框 (“请输入流失原因！”, 0, )
    获取焦点 ()
.如果结束



.子程序 _窗口1_将被销毁, 空白型, , 
关闭 (“biandong”)


.窗口程序集 窗口程序集13, , , 

.子程序 _按钮1_被单击, 空白型, , 
返回 ()

.窗口程序集 窗口程序集14, , , 

.程序集变量 i, 整数型, , , 
.程序集变量 合计, 整数型, , , 
.程序集变量 男生, 整数型, , , 
.程序集变量 女生, 整数型, , , 
.子程序 _窗口2_创建完毕, 空白型, , 
置当前库 (“xuexiao”)
.如果 (不等于 (取记录数 (), 0))
    到首记录 ()
    .计次循环首 (取记录数 (), )
        读 (#学校名称).加入项目 ()
        跳过 ()
    .计次循环尾 ()
    赋值 (., 0)
    置当前库 (“banji”)
    .如果 (不等于 (取记录数 (), 0))
        到首记录 ()
        .计次循环首 (取记录数 (), )
            .如果 (等于 (读 (#学校名称), .取项目文本 (.)))
                读 (#班级名).加入项目 ()
            .否则
                
            .如果结束
            跳过 ()
        .计次循环尾 ()
        赋值 (., 0)
        _组合框2_列表被关闭 ()
    .否则
        信息框 (“无可用的班级信息，不能打印花名册！”, 0, )
        销毁 ()
    .如果结束
    
.否则
    信息框 (“无可用的学校信息，不能打印花名册！”, 0, )
    销毁 ()
.如果结束



.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 填写表头, 空白型, , 
2.置文本 (1, 取文本注册表项 (#学籍管理, #系统设置, “县(区)”, “赣榆”))
2.置文本 (3, 取文本注册表项 (#学籍管理, #系统设置, “乡(镇)”, “青口”))
2.置文本 (5, 相加 (.取项目文本 (.), .取项目文本 (.)))
2.置文本 (10, 相加 (数值到格式文本 (男生, , 假), “人”))
2.置文本 (12, 相加 (数值到格式文本 (女生, , 假), “人”))
2.置文本 (14, 相加 (数值到格式文本 (合计, , 假), “人”))
2.置文本 (17, 时间到文本 (取现行时间 (), 2))

.子程序 _组合框1_列表项被选择, 空白型, , 
_组合框1_列表被关闭 ()

.子程序 _组合框2_列表被关闭, 空白型, , 
置当前库 (“xueji”)
到首记录 ()
赋值 (合计, 0)
.计次循环首 (取记录数 (), )
    .如果 (并且 (等于 (读 (#学校名称), .取项目文本 (.)), 等于 (读 (#班级名), .取项目文本 (.))))
        .如果 (等于 (读 (#性别), “男”))
            赋值 (男生, 相加 (男生, 1))
        .否则
            赋值 (女生, 相加 (女生, 1))
        .如果结束
        赋值 (合计, 相加 (合计, 1))
    .否则
        
    .如果结束
    跳过 ()
.计次循环尾 ()

.子程序 _组合框1_列表被关闭, 空白型, , 
清空 ()
置当前库 (“banji”)
.如果 (不等于 (取记录数 (), 0))
    到首记录 ()
    .计次循环首 (取记录数 (), )
        .如果 (等于 (读 (#学校名称), .取项目文本 (.)))
            读 (#班级名).加入项目 ()
        .否则
            
        .如果结束
        跳过 ()
    .计次循环尾 ()
    赋值 (., 0)
.否则
    信息框 (“无可用的班级信息，不能打印花名册！”, 0, )
.如果结束
置当前库 (“xueji”)
到首记录 ()
赋值 (合计, 0)
.计次循环首 (取记录数 (), )
    .如果 (并且 (等于 (读 (#学校名称), .取项目文本 (.)), 等于 (读 (#班级名), .取项目文本 (.))))
        .如果 (等于 (读 (#性别), “男”))
            赋值 (男生, 相加 (男生, 1))
        .否则
            赋值 (女生, 相加 (女生, 1))
        .如果结束
        
        赋值 (合计, 相加 (合计, 1))
    .否则
        
    .如果结束
    跳过 ()
.计次循环尾 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 x, 整数型, , , 页数
.局部变量 a, 整数型, , , 

.如果 (不等于 (合计, 0))
    置当前库 (“xueji”)
    到首记录 ()
    赋值 (x, 整除 (合计, 15))
    .如果 (大于 (求余数 (合计, 15), 0))
        赋值 (x, 相加 (x, 1))
    .否则
        
    .如果结束
    
    .计次循环首 (x, a)
        #花名册.从字节集读 ()
        填写表头 ()
        赋值 (i, 5)
        .判断循环首 (不等于 (i, 20))
            .如果 (尾记录后 ())
                跳出循环 ()
            .否则
                .如果 (并且 (等于 (读 (#学校名称), .取项目文本 (.)), 等于 (读 (#班级名), .取项目文本 (.))))
                    .置文本 (1, 读 (#学籍号))
                    .置文本 (3, 读 (#姓名))
                    .置文本 (5, 读 (#性别))
                    .置文本 (6, 读 (#民族))
                    .置文本 (7, 读 (#出生年月))
                    .置文本 (11, 读 (#入学年月))
                    .置文本 (13, 读 (#监护人称谓))
                    .置文本 (14, 读 (#监护人姓名))
                    .置文本 (15, 读 (#监护人工作单位))
                    .置文本 (17, 读 (#户口所在地))
                    赋值 (相加 (1))
                .否则
                    
                .如果结束
                跳过 ()
            .如果结束
            
        .判断循环尾 ()
        20.置文本 (17, 相加 (“第”, 数值到格式文本 (a, , 假), “页共”, 数值到格式文本 (x, , 假), “页”))
        假.打印 ()
    .计次循环尾 ()
    
.否则
    信息框 (“本班级没有学生！”, 0, )
.如果结束


.子程序 _组合框2_列表项被选择, 空白型, , 
_组合框2_列表被关闭 ()

.窗口程序集 窗口程序集15, , , 

.子程序 _窗口3_创建完毕, 空白型, , 
返回 ()

.窗口程序集 窗口程序集16, , , 

.子程序 _窗口3_创建完毕, 空白型, , 
置当前库 (“xuexiao”)
.如果 (不等于 (取记录数 (), 0))
    到首记录 ()
    .计次循环首 (取记录数 (), )
        读 (#学校名称).加入项目 ()
        跳过 ()
    .计次循环尾 ()
    赋值 (., 0)
    置当前库 (“banji”)
    .如果 (不等于 (取记录数 (), 0))
        到首记录 ()
        .计次循环首 (取记录数 (), )
            .如果 (等于 (读 (#学校名称), .取项目文本 (.)))
                读 (#班级名).加入项目 ()
            .否则
                
            .如果结束
            跳过 ()
        .计次循环尾 ()
        赋值 (., 0)
    .否则
        
    .如果结束
    
.否则
    
.如果结束



.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
置当前库 (“xueji”)
到首记录 ()
.计次循环首 (取记录数 (), )
    .如果 (并且 (等于 (读 (#学校名称), .取项目文本 (.)), 等于 (读 (#班级名), .取项目文本 (.))))
        #信息卡.从字节集读 ()
        2.置文本 (1, 取文本注册表项 (#学籍管理, #系统设置, “县(区)”, “赣榆”))
        2.置文本 (5, 相加 (取文本注册表项 (#学籍管理, #系统设置, “乡(镇)”, “青口”), 读 (#学校名称)))
        3.置文本 (5, 读 (#学籍号))
        3.置文本 (7, 读 (#姓名))
        4.置文本 (5, 读 (#出生年月))
        4.置文本 (7, 读 (#性别))
        5.置文本 (5, 读 (#入学年月))
        5.置文本 (7, 读 (#民族))
        6.置文本 (5, 读 (#户口所在地))
        6.置文本 (7, 读 (#户口性质))
        7.置文本 (5, 读 (#家庭住址))
        8.置文本 (5, 读 (#父母户口所在地))
        9.置文本 (5, 读 (#本人户口所在地))
        11.置文本 (3, 读 (#监护人称谓))
        11.置文本 (6, 读 (#监护人工作单位))
        11.置文本 (9, 读 (#监护人电话))
        .如果 (等于 (窗口4.., 真))
            3.置数据 (8, 读 (#照片))
        .否则
            
        .如果结束
        假.打印 (“信息卡”)
    .否则
        
    .如果结束
    跳过 ()
.计次循环尾 ()
销毁 ()

.子程序 _学校组合框_列表被关闭, 空白型, , 
置当前库 (“banji”)
.如果 (不等于 (取记录数 (), 0))
    到首记录 ()
    .计次循环首 (取记录数 (), )
        .如果 (等于 (读 (#学校名称), .取项目文本 (.)))
            读 (#班级名).加入项目 ()
        .否则
            
        .如果结束
        跳过 ()
    .计次循环尾 ()
    赋值 (., 0)
.否则
    信息框 (“无可用的班级信息，不能打印信息卡！”, 0, )
.如果结束


.窗口程序集 窗口程序集17, , , 

.子程序 _按钮1_被单击, 空白型, , 
.如果 (.)
    载入 (窗口3, , 真)
.否则
    载入 (窗口5, , 真)
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集18, , , 

.子程序 _窗口5_创建完毕, 空白型, , 
赋值 (., _启动窗口..)
赋值 (., 0)
赋值 (., 10)

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
置当前库 (“xueji”)
到首记录 ()
.如果 (查找 (等于 (读 (#学籍号), .)))
    #信息卡.从字节集读 ()
    2.置文本 (1, 取文本注册表项 (#学籍管理, #系统设置, “县(区)”, “赣榆”))
    2.置文本 (5, 相加 (取文本注册表项 (#学籍管理, #系统设置, “乡(镇)”, “青口”), 读 (#学校名称)))
    3.置文本 (5, 读 (#学籍号))
    3.置文本 (7, 读 (#姓名))
    4.置文本 (5, 读 (#出生年月))
    4.置文本 (7, 读 (#性别))
    5.置文本 (5, 读 (#入学年月))
    5.置文本 (7, 读 (#民族))
    6.置文本 (5, 读 (#户口所在地))
    6.置文本 (7, 读 (#户口性质))
    7.置文本 (5, 读 (#家庭住址))
    8.置文本 (5, 读 (#父母户口所在地))
    9.置文本 (5, 读 (#本人户口所在地))
    11.置文本 (3, 读 (#监护人称谓))
    11.置文本 (5, 读 (#监护人姓名))
    11.置文本 (6, 读 (#监护人工作单位))
    11.置文本 (9, 读 (#监护人电话))
    .如果 (等于 (窗口4.., 真))
        3.置数据 (8, 读 (#照片))
    .否则
        
    .如果结束
    假.打印 (相加 (., “信息卡”))
    信息框 (相加 (“学籍号为”, ., “学生的学籍卡打印完毕！”), 0, )
    获取焦点 ()
.否则
    信息框 (相加 (“未找到学籍号为”, ., “的学生！”), 0, )
    获取焦点 ()
.如果结束


.窗口程序集 窗口程序集19, , , 

.子程序 _窗口6_创建完毕, 空白型, , 
.如果 (文件是否存在 (“biandong.edb”))
    .如果真 (等于 (打开 (“biandong.edb”, , , , , , ), 假))
        信息框 (“无法打开系统数据库！”, #错误图标, “错误”)
        销毁 ()
    .如果真结束
    
.否则
    
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 时间1, 文本型, , , 
.局部变量 时间2, 文本型, , , 
.局部变量 x, 整数型, , , 页数
.局部变量 a, 整数型, , , 
.局部变量 减少, 整数型, , , 
.局部变量 增加, 整数型, , , 
.局部变量 i, 整数型, , , 

.如果 (小于或等于 (取月份 (取现行时间 ()), 8))
    赋值 (时间1, 数值到格式文本 (相减 (取年份 (取现行时间 ()), 1), , 假))
    赋值 (时间2, 数值到格式文本 (取年份 (取现行时间 ()), , 假))
.否则
    赋值 (时间1, 数值到格式文本 (取年份 (取现行时间 ()), , 假))
    赋值 (时间2, 数值到格式文本 (相加 (取年份 (取现行时间 ()), 1), , 假))
.如果结束
置当前库 (“biandong”)
到首记录 ()
.计次循环首 (取记录数 (), )
    .如果 (等于 (取文本右边 (读 (#类型), 4), “减少”))
        赋值 (减少, 相加 (减少, 1))
    .否则
        .如果 (等于 (取文本右边 (读 (#类型), 4), “增加”))
            赋值 (增加, 相加 (增加, 1))
        .否则
            
        .如果结束
        
    .如果结束
    跳过 ()
.计次循环尾 ()
.如果 (.)
    .如果 (大于 (增加, 0))
        置当前库 (“biandong”)
        到首记录 ()
        赋值 (x, 整除 (增加, 15))
        .如果 (大于 (求余数 (增加, 15), 0))
            赋值 (x, 相加 (x, 1))
        .否则
            
        .如果结束
        .计次循环首 (x, a)
            #增加表.从字节集读 ()
            1.置文本 (1, 相加 (“连云港市”, 时间1, “―”, 时间2, “学年度小学增加学生登记表”))
            2.置文本 (1, 取文本注册表项 (#学籍管理, #系统设置, “县(区)”, “赣榆”))
            2.置文本 (3, 取文本注册表项 (#学籍管理, #系统设置, “乡(镇)”, “青口”))
            2.置文本 (11, 时间到文本 (取现行时间 (), 2))
            赋值 (5)
            .判断循环首 (不等于 (20))
                .如果 (尾记录后 ())
                    跳出循环 ()
                .否则
                    .如果 (等于 (取文本右边 (读 (#类型), 4), “增加”))
                        i.置文本 (1, 读 (#学校名称))
                        i.置文本 (2, 读 (#班级名))
                        i.置文本 (3, 读 (#学籍号))
                        i.置文本 (4, 读 (#姓名))
                        i.置文本 (5, 读 (#性别))
                        i.置文本 (6, 读 (#出生年月))
                        .如果 (等于 (取文本左边 (读 (#类型), 4), “转入”))
                            i.置文本 (7, “√”)
                        .否则
                            .如果 (等于 (取文本左边 (读 (#类型), 4), “复学”))
                                i.置文本 (8, “√”)
                            .否则
                                i.置文本 (9, “√”)
                            .如果结束
                            
                        .如果结束
                        i.置文本 (10, 读 (#时间))
                        赋值 (相加 (1))
                    .否则
                        
                    .如果结束
                    跳过 ()
                .如果结束
                
            .判断循环尾 ()
            20.置文本 (10, 相加 (“第”, 数值到格式文本 (a, , 假), “页共”, 数值到格式文本 (x, , 假), “页”))
            假.打印 ()
        .计次循环尾 ()
    .否则
        信息框 (“本学年没有增加学生！”, 0, )
    .如果结束
    
.否则
    .如果 (大于 (减少, 0))
        置当前库 (“biandong”)
        到首记录 ()
        赋值 (x, 整除 (减少, 15))
        .如果 (大于 (求余数 (减少, 15), 0))
            赋值 (x, 相加 (x, 1))
        .否则
            
        .如果结束
        .计次循环首 (x, a)
            #减少表.从字节集读 ()
            1.置文本 (1, 相加 (“连云港市”, 时间1, “―”, 时间2, “学年度小学减少学生登记表”))
            2.置文本 (1, 取文本注册表项 (#学籍管理, #系统设置, “县(区)”, “赣榆”))
            2.置文本 (3, 取文本注册表项 (#学籍管理, #系统设置, “乡(镇)”, “青口”))
            2.置文本 (13, 时间到文本 (取现行时间 (), 2))
            
            赋值 (5)
            .判断循环首 (不等于 (20))
                .如果 (尾记录后 ())
                    跳出循环 ()
                .否则
                    .如果 (等于 (取文本右边 (读 (#类型), 4), “减少”))
                        i.置文本 (1, 读 (#学校名称))
                        i.置文本 (2, 读 (#班级名))
                        i.置文本 (3, 读 (#学籍号))
                        i.置文本 (4, 读 (#姓名))
                        i.置文本 (5, 读 (#性别))
                        i.置文本 (6, 读 (#出生年月))
                        .如果 (等于 (取文本左边 (读 (#类型), 4), “转出”))
                            i.置文本 (7, “√”)
                        .否则
                            .如果 (等于 (取文本左边 (读 (#类型), 4), “休学”))
                                i.置文本 (8, “√”)
                            .否则
                                .如果 (等于 (取文本左边 (读 (#类型), 4), “退学”))
                                    i.置文本 (9, “√”)
                                .否则
                                    .如果 (等于 (取文本左边 (读 (#类型), 4), “流失”))
                                        i.置文本 (10, “√”)
                                    .否则
                                        i.置文本 (11, “√”)
                                        
                                    .如果结束
                                    
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        i.置文本 (12, 读 (#时间))
                        赋值 (相加 (1))
                    .否则
                        
                    .如果结束
                    跳过 ()
                .如果结束
                
            .判断循环尾 ()
            20.置文本 (12, 相加 (“第”, 数值到格式文本 (a, , 假), “页共”, 数值到格式文本 (x, , 假), “页”))
            假.打印 ()
        .计次循环尾 ()
    .否则
        信息框 (“本学年没有减少学生！”, 0, )
    .如果结束
    
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
关闭 (“biandong”)
销毁 ()

.窗口程序集 窗口程序集20, , , 

.子程序 _窗口7_创建完毕, 空白型, , 
.如果 (文件是否存在 (“biandong.edb”))
    .如果 (打开 (“biandong.edb”, , , , , , ))
        置当前库 (“biandong”)
        到首记录 ()
        .计次循环首 (取记录数 (), )
            .如果 (等于 (取文本左边 (读 (#类型), 4), “休学”))
                读 (#姓名).加入项目 ()
                
            .否则
                
            .如果结束
            跳过 ()
        .计次循环尾 ()
        置当前库 (“xuexiao”)
        .如果 (不等于 (取记录数 (), 0))
            到首记录 ()
            .计次循环首 (取记录数 (), )
                读 (#学校名称).加入项目 ()
                跳过 ()
            .计次循环尾 ()
            赋值 (., 0)
        .否则
            
        .如果结束
        置当前库 (“banji”)
        .如果 (不等于 (取记录数 (), 0))
            到首记录 ()
            .计次循环首 (取记录数 (), )
                .如果 (等于 (读 (#学校名称), .取项目文本 (.)))
                    读 (#班级名).加入项目 ()
                .否则
                    
                .如果结束
                跳过 ()
            .计次循环尾 ()
            赋值 (., 0)
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    
.否则
    
.如果结束


.子程序 _组合框1_列表被关闭, 空白型, , 
清空 ()
置当前库 (“banji”)
.如果 (不等于 (取记录数 (), 0))
    到首记录 ()
    .计次循环首 (取记录数 (), )
        .如果 (等于 (读 (#学校名称), .取项目文本 (.)))
            读 (#班级名).加入项目 ()
        .否则
            
        .如果结束
        跳过 ()
    .计次循环尾 ()
    赋值 (., 0)
.否则
    
.如果结束


.子程序 _列表框1_列表项被选择, 空白型, , 
置当前库 (“biandong”)
到首记录 ()
.如果 (查找 (等于 (读 (#姓名), .取项目文本 (.))))
    赋值 (., 相加 (“休学时间：”, 读 (#时间)))
    赋值 (., 相加 (“原班为：”, 读 (#学校名称), 读 (#班级名), “班”))
    读 (#学校名称).选择 ()
    读 (#班级名).选择 ()
.否则
    
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
关闭 (“biandong”)
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
.如果 (不等于 (.取项目文本 (.), “”))
    置当前库 (“biandong”)
    到首记录 ()
    .如果 (查找 (等于 (读 (#姓名), .取项目文本 (.))))
        赋值 (学校名称, .取项目文本 (.))
        赋值 (班级名, .取项目文本 (.))
        赋值 (学籍号, 读 (#学籍号))
        赋值 (姓名, 读 (#姓名))
        赋值 (读 (#性别))
        赋值 (读 (#民族))
        赋值 (读 (#籍贯))
        赋值 (读 (#出生年月))
        赋值 (读 (#入学年月))
        赋值 (读 (#户口所在地))
        赋值 (读 (#户口性质))
        赋值 (读 (#家庭住址))
        赋值 (读 (#父母户口所在地))
        赋值 (读 (#本人户口所在地))
        赋值 (读 (#监护人称谓))
        赋值 (读 (#监护人姓名))
        赋值 (读 (#监护人工作单位))
        赋值 (读 (#监护人电话))
        赋值 (读 (#照片))
        赋值 (时间到文本 (取现行时间 (), 2))
        修改 (学校名称, 班级名, 学籍号, 姓名, 性别, 民族, 籍贯, 出生年月, 入学年月, 户口所在地, 户口性质, 家庭住址, 父母户口所在地, 本人户口所在地, 监护人称谓, 监护人姓名, 监护人工作单位, 监护人电话, 照片, 时间, “”, , “复学增加”)
        置当前库 (“xueji”)
        加记录 (学校名称, 班级名, 学籍号, 姓名, 性别, 民族, 籍贯, 出生年月, 入学年月, 户口所在地, 户口性质, 家庭住址, 父母户口所在地, 本人户口所在地, 监护人称谓, 监护人姓名, 监护人工作单位, 监护人电话, 照片)
        .删除项目 (.)
        信息框 (“该生已经复学!”, 0, )
    .否则
        信息框 (“系统出错，该生复学操作不成功！”, 0, )
    .如果结束
    
.否则
    信息框 (“请选择学生姓名！”, 0, )
.如果结束



.窗口程序集 窗口程序集21, , , 

.程序集变量 a, 文本型, , , 
.程序集变量 b, 文本型, , , 
.子程序 _按钮1_被单击, 空白型, , 
销毁 ()

.子程序 _窗口9_创建完毕, 空白型, , 
置当前库 (“xuexiao”)
.如果 (不等于 (取记录数 (), 0))
    到首记录 ()
    .计次循环首 (取记录数 (), )
        读 (#学校名称).加入项目 ()
        跳过 ()
    .计次循环尾 ()
    赋值 (., 0)
    置当前库 (“banji”)
    .如果 (不等于 (取记录数 (), 0))
        到首记录 ()
        .计次循环首 (取记录数 (), )
            .如果 (等于 (读 (#学校名称), .取项目文本 (.)))
                读 (#班级名).加入项目 ()
            .否则
                
            .如果结束
            跳过 ()
        .计次循环尾 ()
        赋值 (., 0)
    .否则
        信息框 (“无可用的班级信息，不能打印成绩单！”, 0, )
        销毁 ()
    .如果结束
    
.否则
    信息框 (“无可用的学校信息，不能打印成绩单！”, 0, )
    销毁 ()
.如果结束
_单选框3_被单击 ()

.子程序 _按钮2_被单击, 空白型, , 
置当前库 (“banji”)
到首记录 ()
.如果 (等于 (., 真))
    .计次循环首 (取记录数 (), )
        赋值 (a, 读 (#学校名称))
        赋值 (b, 读 (#班级名))
        子程序1 ()
        置当前库 (“banji”)
        跳过 ()
    .计次循环尾 ()
    
.否则
    
.如果结束

.如果 (等于 (., 真))
    .计次循环首 (取记录数 (), )
        .如果 (等于 (取文本左边 (读 (#班级名), 2), 取文本左边 (.取项目文本 (.), 2)))
            赋值 (a, 读 (#学校名称))
            赋值 (b, 读 (#班级名))
            子程序1 ()
            置当前库 (“banji”)
            
        .否则
            
        .如果结束
        跳过 ()
    .计次循环尾 ()
    
.否则
    
.如果结束

.如果 (等于 (., 真))
    赋值 (a, .取项目文本 (.))
    赋值 (b, .取项目文本 (.))
    子程序1 ()
.否则
    
.如果结束


.子程序 子程序1, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 x, 整数型, , , 
.局部变量 合计, 整数型, , , 
.局部变量 p, 整数型, , , 

置当前库 (“xueji”)
到首记录 ()
.计次循环首 (取记录数 (), )
    .如果 (并且 (等于 (读 (#学校名称), a), 等于 (读 (#班级名), b)))
        赋值 (合计, 相加 (合计, 1))
    .否则
        
    .如果结束
    跳过 ()
.计次循环尾 ()
.如果 (不等于 (合计, 0))
    到首记录 ()
    赋值 (x, 整除 (合计, 25))
    .如果 (大于 (求余数 (合计, 25), 0))
        赋值 (相加 (1))
    .否则
        
    .如果结束
    
    .计次循环首 (x, p)
        #成绩单.从字节集读 ()
        2.置文本 (1, 取文本注册表项 (#学籍管理, #系统设置, “乡(镇)”, “青口”))
        2.置文本 (4, 相加 (a, b, “班”))
        2.置文本 (9, 时间到文本 (., 2))
        赋值 (i, 4)
        .判断循环首 (不等于 (i, 29))
            .如果 (尾记录后 ())
                跳出循环 ()
            .否则
                
                .如果 (并且 (等于 (读 (#学校名称), a), 等于 (读 (#班级名), b)))
                    i.置文本 (5, 读 (#学籍号))
                    i.置文本 (6, 读 (#姓名))
                    赋值 (相加 (1))
                .否则
                    
                .如果结束
                跳过 ()
            .如果结束
            
        .判断循环尾 ()
        29.置文本 (7, “本班人数：”)
        29.置文本 (11, 相加 (数值到格式文本 (合计, , 假), “人”))
        29.置文本 (2, 相加 (“第”, 数值到格式文本 (p, , 假), “页共”, 数值到格式文本 (x, , 假), “页”))
        假.打印 (“成绩单”)
    .计次循环尾 ()
    
.否则
    信息框 (相加 (a, b, “班没有学生！”), 0, )
.如果结束


.子程序 _单选框3_被单击, 空白型, , 
赋值 (., 真)
赋值 (., 真)
赋值 (., 真)

.子程序 _单选框2_被单击, 空白型, , 
赋值 (., 假)
赋值 (., 真)
赋值 (., 真)


.子程序 _单选框1_被单击, 空白型, , 
赋值 (., 真)
赋值 (., 假)
赋值 (., 假)


.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 本子程序在程序启动后最先执行
载入 (登陆窗口, , 真)


 ' 不属于任何一个程序集、类模块的函数：
