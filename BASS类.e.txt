 ' 文件类型：Windows模块源码

 ' 程序名称：BASS类
 ' 程序描述：隐身马甲
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0



.图片 BASS, " ' 已保存到：D:\易语言学习\Data\BASS类.e\BASS", 公开, 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' shell 52F260023059454187AF826A3C07AF2A 3 0 操作系统界面功能支持库





.DLL命令 BASS_Init, 逻辑型, "bass.dll", "BASS_Init", 公开, 初始化
    .参数 device, 整数型, , 
    .参数 freq, 整数型, , 
    .参数 flags, 整数型, , 
    .参数 win, 整数型, , 
    .参数 clsid, 整数型, , 

.DLL命令 BASS_Free, 逻辑型, "bass.dll", "BASS_Free", 公开, 释放Bass

.DLL命令 BASS_StreamCreateFile, 整数型, "bass.dll", "BASS_StreamCreateFile", 公开, 打开路径文件
    .参数 mem, 逻辑型, , 
    .参数 file, 文本型, , 
    .参数 offset, 长整数型, , 
    .参数 length, 长整数型, , 
    .参数 flags, 整数型, , 

.DLL命令 BASS_StreamCreateFile1, 整数型, "bass.dll", "BASS_StreamCreateFile", 公开, 打开内存文件
    .参数 mem, 逻辑型, , 
    .参数 file, 字节集, , 
    .参数 offset, 长整数型, , 
    .参数 length, 长整数型, , 
    .参数 flags, 整数型, , 

.DLL命令 BASS_StreamCreateURL, 整数型, "bass.dll", "BASS_StreamCreateURL", 公开, 打开网络文件
    .参数 url, 文本型, , 
    .参数 offset, 整数型, , 
    .参数 flags, 整数型, , 
    .参数 proc, 整数型, , 
    .参数 user, 整数型, , 

.DLL命令 BASS_ChannelPlay, 逻辑型, "bass.dll", "BASS_ChannelPlay", 公开, 播放
    .参数 handle, 整数型, , 
    .参数 restart, 逻辑型, , 

.DLL命令 BASS_ChannelPause, 逻辑型, "bass.dll", "BASS_ChannelPause", 公开, 暂停
    .参数 handle, 整数型, , 

.DLL命令 BASS_ChannelStop, 逻辑型, "bass.dll", "BASS_ChannelStop", 公开, 停止
    .参数 handle, 整数型, , 

.DLL命令 BASS_ChannelGetPosition, 长整数型, "bass.dll", "BASS_ChannelGetPosition", 公开, 取播放位置
    .参数 handle, 整数型, , 
    .参数 mode, 整数型, , 

.DLL命令 BASS_ChannelSetPosition, 逻辑型, "bass.dll", "BASS_ChannelSetPosition", 公开, 置播放位置
    .参数 handle, 整数型, , 
    .参数 pos, 长整数型, , 
    .参数 mode, 整数型, , 

.DLL命令 BASS_ChannelGetLength, 长整数型, "bass.dll", "BASS_ChannelGetLength", 公开, 取媒体长度
    .参数 handle, 整数型, , 
    .参数 mode, 整数型, , 

.DLL命令 BASS_ChannelGetTags, 文本型, "bass.dll", "BASS_ChannelGetTags", 公开, 取媒体标签
    .参数 handle, 整数型, , 
    .参数 tags, 整数型, , 

.DLL命令 BASS_ChannelIsActive, 整数型, "bass.dll", "BASS_ChannelIsActive", 公开, 取播放状态
    .参数 handle, 整数型, , 

.DLL命令 BASS_StreamFree, 逻辑型, "bass.dll", "BASS_StreamFree", 公开, 关闭文件
    .参数 handle, 整数型, , 

.DLL命令 BASS_ChannelGetData, 整数型, "bass.dll", "BASS_ChannelGetData", 公开, 取频谱信息
    .参数 handle, 整数型, , 
    .参数 buffer, 小数型, 数组, 128
    .参数 length, 整数型, , 2147483648

.DLL命令 BASS_SetVolume, 逻辑型, "bass.dll", "BASS_SetVolume", 公开, 设置音量
    .参数 volume, 小数型, , 0.01~1

.DLL命令 BASS_GetVolume, 小数型, "bass.dll", "BASS_GetVolume", 公开, 获取音量

.DLL命令 BASS_ChannelBytes2Seconds, 双精度小数型, "bass.dll", "BASS_ChannelBytes2Seconds", 公开, 位置到时间
    .参数 handle, 整数型, , 
    .参数 pos, 长整数型, , 

.DLL命令 BASS_ChannelSeconds2Bytes, 长整数型, "bass.dll", "BASS_ChannelSeconds2Bytes", 公开, 时间到位置
    .参数 handle, 整数型, , 
    .参数 pos, 双精度小数型, , 

.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码
.局部变量 A, 文本型, , , 

赋值 (A, 相加 (未知支持库函数_7 (11), “bass.dll”))
.如果真 (取反 (文件是否存在 (A)))
    写到文件 (A, #BASS)
.如果真结束
_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值


.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。


.类模块 BASS类, , , 

.程序集变量 集_临时画板, 画板, , , 
.程序集变量 集_已经初始化, 逻辑型, , , 
.程序集变量 集_画背景图片, 逻辑型, , , 
.程序集变量 集_历史峰值, 小数型, , "128", 
.程序集变量 集_历史顶端, 小数型, , "128", 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
置DLL装载目录 (未知支持库函数_7 (11))


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 初始化, 逻辑型, 公开, __启动窗口_创建完毕
.参数 设备ID, 整数型, 可空, 默认为-1(当前设备)...
.参数 采样率, 整数型, 可空, 默认为44100...
.参数 标志, 整数型, 可空, 默认为0...
.参数 窗口句柄, 整数型, 可空, 默认为0...

.局部变量 设备_, 整数型, , , 
.局部变量 采样_, 整数型, , , 
.局部变量 标志_, 整数型, , , 
.局部变量 句柄_, 整数型, , , 

.判断开始 (是否为空 (设备ID))
    赋值 (设备_, -1)
.默认
    赋值 (设备_, 设备ID)
.判断结束
 ' 本源码来自易语言资源网(www.5A5X.com)
.判断开始 (是否为空 (采样率))
    赋值 (采样_, 44100)
.默认
    赋值 (采样_, 采样率)
.判断结束

.判断开始 (是否为空 (标志))
    赋值 (标志_, 0)
.默认
    赋值 (标志_, 标志)
.判断结束

.判断开始 (是否为空 (窗口句柄))
    赋值 (句柄_, 0)
.默认
    赋值 (句柄_, 窗口句柄)
.判断结束
返回 (BASS_Init (设备_, 采样_, 标志_, 句柄_, 0))
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 释放Bass, 逻辑型, 公开, __启动窗口_可否被关闭
返回 (BASS_Free ())


.子程序 打开文件, 整数型, 公开, 成功返回文件句柄,失败返回0...
.参数 文件全路径, 文本型, 可空, 从路径打开...
.参数 文件资源, 字节集, 可空, 从内存资源打开...
.参数 Url地址, 文本型, 可空, 从网络资源打开...
.参数 起始位置, 整数型, 可空, 默认为0...

.局部变量 A, 整数型, , , 

.如果真 (并且 (等于 (文件全路径, “”), 等于 (文件资源, {  }), 等于 (Url地址, “”)))
    返回 (0)
.如果真结束
 ' 本源码来自易语言资源网(www.5A5X.com)
.如果 (取反 (是否为空 (起始位置)))
    赋值 (A, 起始位置)
.否则
    赋值 (A, 0)
.如果结束

.判断开始 (文件是否存在 (文件全路径))
    返回 (BASS_StreamCreateFile (假, 文件全路径, A, 0, 0))
.判断 (不等于 (文件资源, {  }))
    返回 (BASS_StreamCreateFile1 (真, 文件资源, A, 取字节集长度 (文件资源), 0))
.判断 (不等于 (Url地址, “”))
    返回 (BASS_StreamCreateURL (Url地址, A, 0, 0, 0))
.默认
    返回 (0)
.判断结束


.子程序 播放, 逻辑型, 公开, 
.参数 文件句柄, 整数型, , 打开文件 ()
.参数 播放模式, 逻辑型, 可空, 真=重新播放,假=继续播放,默认为真...

.局部变量 A, 逻辑型, , , 

.如果真 (等于 (文件句柄, 0))
    返回 (假)
.如果真结束
 ' 本源码来自易语言资源网(www.5A5X.com)
.如果 (是否为空 (播放模式))
    赋值 (A, 真)
.否则
    赋值 (A, 播放模式)
.如果结束
返回 (BASS_ChannelPlay (文件句柄, A))


.子程序 暂停, 逻辑型, 公开, 
.参数 文件句柄, 整数型, , 打开文件 ()

返回 (BASS_ChannelPause (文件句柄))


.子程序 停止, 逻辑型, 公开, 
.参数 文件句柄, 整数型, , 打开文件 ()

返回 (BASS_ChannelStop (文件句柄))
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 取播放位置, 长整数型, 公开, 
.参数 文件句柄, 整数型, , 打开文件 ()

返回 (BASS_ChannelGetPosition (文件句柄, 0))


.子程序 置播放位置, 逻辑型, 公开, 
.参数 文件句柄, 整数型, , 打开文件 ()
.参数 播放位置, 长整数型, , 

返回 (BASS_ChannelSetPosition (文件句柄, 播放位置, 0))
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 取媒体长度, 长整数型, 公开, 
.参数 文件句柄, 整数型, , 打开文件 ()

返回 (BASS_ChannelGetLength (文件句柄, 0))


.子程序 取媒体标签, 文本型, 公开, 
.参数 文件句柄, 整数型, , 打开文件 ()

返回 (BASS_ChannelGetTags (文件句柄, 0))


.子程序 取播放状态, 整数型, 公开, 0=停止,1=播放,3=暂停...
.参数 文件句柄, 整数型, , 打开文件 ()

返回 (BASS_ChannelIsActive (文件句柄))


.子程序 关闭文件, 逻辑型, 公开, 
.参数 文件句柄, 整数型, , 打开文件 ()

返回 (BASS_StreamFree (文件句柄))
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 取频谱信息, 整数型, 公开, 失败返回-1...
.参数 文件句柄, 整数型, , 打开文件 ()
.参数 保存结果, 小数型, 数组, 

.局部变量 A, 整数型, , , 
.局部变量 B, 小数型, , "128", 

赋值 (A, BASS_ChannelGetData (文件句柄, B, 2147483648))
赋值 (保存结果, B)
返回 (A)


.子程序 置音量, 逻辑型, 公开, 0.01~0.99...
.参数 音量大小, 小数型, , 0为静音,1为最大音

返回 (BASS_SetVolume (音量大小))


.子程序 取音量, 小数型, 公开, 
返回 (BASS_GetVolume ())
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 位置到时间, 双精度小数型, 公开, 返回位置对应的时间(秒)...
.参数 文件句柄, 整数型, , 打开文件 ()
.参数 播放位置, 长整数型, , 

返回 (BASS_ChannelBytes2Seconds (文件句柄, 播放位置))


.子程序 时间到位置, 长整数型, 公开, 返回时间对应的位置...
.参数 文件句柄, 整数型, , 打开文件 ()
.参数 播放时间, 双精度小数型, , 秒

返回 (BASS_ChannelSeconds2Bytes (文件句柄, 播放时间))


.子程序 GetRGBValue, 整数型, , 
.参数 RGB, 整数型, , 
.参数 index, 整数型, , 

.局部变量 B, 整数型, , , 
.局部变量 G, 整数型, , , 
.局部变量 R, 整数型, , , 

赋值 (B, 取整 (相除 (RGB, 256, 256)))
赋值 (G, 取整 (相除 (相减 (RGB, 相乘 (B, 256, 256)), 256)))
赋值 (R, 相减 (RGB, 相乘 (B, 256, 256), 相乘 (G, 256)))
.判断开始 (等于 (index, 1))
    返回 (R)
.判断 (等于 (index, 2))
    返回 (G)
.判断 (等于 (index, 3))
    返回 (B)
.默认
    返回 (0)
.判断结束
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 画频谱, 空白型, 公开, 时钟频率~30+/-...
.参数 临时画板, 画板, , 临时画板...
.参数 文件句柄, 整数型, , 文件句柄...
.参数 背景渐变颜色上, 整数型, 可空, 默认为黑色...
.参数 背景渐变颜色下, 整数型, 可空, 默认为黑色...
.参数 频谱线颜色, 整数型, 可空, 默认为黄色...
.参数 频谱线距离, 整数型, 可空, 默认为3...

.局部变量 A, 整数型, , "4", 
.局部变量 B, 小数型, , "128", 
.局部变量 C, 整数型, , , 
.局部变量 D, 整数型, , , 
.局部变量 E, 整数型, , , 

.如果真 (等于 (集_已经初始化, 假))
    复制窗口组件 (临时画板, 集_临时画板)
    .如果真 (大于 (取字节集长度 (集_临时画板.底图), 0))
        赋值 (集_画背景图片, 真)
    .如果真结束
    赋值 (集_已经初始化, 真)
.如果真结束
赋值 (A [1], 选择 (是否为空 (背景渐变颜色上), #黑色, 背景渐变颜色上))
赋值 (A [2], 选择 (是否为空 (背景渐变颜色下), #黑色, 背景渐变颜色下))
赋值 (A [3], 选择 (是否为空 (频谱线颜色), #黄色, 频谱线颜色))
赋值 (A [4], 选择 (是否为空 (频谱线距离), 3, 频谱线距离))
集_临时画板.清除 ()
赋值 (集_临时画板.画笔颜色, A [3])
.如果真 (等于 (集_画背景图片, 假))
    .如果真 (或者 (不等于 (A [1], #黑色), 不等于 (A [2], #黑色)))
        集_临时画板.画渐变矩形 (0, 0, 集_临时画板.宽度, 集_临时画板.高度, 1, A [1], A [2])
    .如果真结束
    
.如果真结束
 ' 本源码来自易语言资源网(www.5A5X.com)
.如果真 (不等于 (BASS_ChannelGetData (文件句柄, B, 2147483648), -1))
    .变量循环首 (1, 集_临时画板.宽度, A [4], C)
        .如果真 (小于 (D, 128))
            赋值 (D, 相加 (D, 1))
            赋值 (E, 相乘 (B [D], 集_临时画板.高度, 10))
            .如果 (大于 (E, 集_历史峰值 [D]))
                赋值 (集_历史峰值 [D], E)
                .如果真 (大于 (集_历史峰值 [D], 相减 (集_临时画板.高度, 2)))
                    赋值 (集_历史峰值 [D], 相减 (集_临时画板.高度, 2))
                    赋值 (集_历史顶端 [D], 集_临时画板.高度)
                .如果真结束
                
                .如果真 (大于 (集_历史峰值 [D], 相加 (集_历史顶端 [D], 2)))
                    赋值 (集_历史顶端 [D], 相加 (集_历史峰值 [D], 2))
                .如果真结束
                
            .否则
                赋值 (集_历史峰值 [D], 相减 (集_历史峰值 [D], 3))
                赋值 (集_历史顶端 [D], 相减 (集_历史顶端 [D], 1))
                .如果真 (小于 (集_历史峰值 [D], 1))
                    赋值 (集_历史峰值 [D], 1)
                .如果真结束
                
            .如果结束
            集_临时画板.画直线 (C, 相减 (集_临时画板.高度, 集_历史峰值 [D]), C, 集_临时画板.高度)
            .如果真 (大于 (集_历史顶端 [D], 2))
                集_临时画板.画直线 (C, 相减 (集_临时画板.高度, 集_历史顶端 [D]), 相加 (C, 1), 相减 (集_临时画板.高度, 集_历史顶端 [D]))
            .如果真结束
            
        .如果真结束
        ' 本源码来自易语言资源网(www.5A5X.com)
    .变量循环尾 ()
    集_临时画板.复制 (0, 0, 集_临时画板.宽度, 集_临时画板.高度, 临时画板, 0, 0, )
.如果真结束



 ' 不属于任何一个程序集、类模块的函数：
