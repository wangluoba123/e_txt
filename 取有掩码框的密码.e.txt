 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 304
    高度 = 405
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “密码查看器”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库




数据类型 坐标, , 坐标;
    .成员 横向位置, 整数型, , , 
    .成员 纵向位置, 整数型, , , 

数据类型 矩形, , 矩形;
    .成员 左边, 整数型, , , 
    .成员 顶边, 整数型, , , 
    .成员 右边, 整数型, , , 
    .成员 底边, 整数型, , , 


.DLL命令 发送消息, 整数型, "user32", "SendMessageA", , 调用一个窗口的窗口函数，将一条消息发给那个窗口。除非消息处理完毕，否则该函数不会返回。SendMessageBynum， ;    SendMessageByString是该函数的“类型安全”声明形式  由具体的消息决定
    .参数 窗口句柄, 整数型, , 要接收消息的那个窗口的句柄
    .参数 消息值, 整数型, , 消息的标识符
    .参数 参数一, 整数型, , 具体取决于消息
    .参数 参数二, 文本型, , 具体取决于消息;

.DLL命令 判断窗口句柄, 整数型, "user32", "IsWindow", , 判断一个窗口句柄是否有效  非零表示成功，零表示失败
    .参数 窗口句柄, 整数型, , 待检查窗口的句柄;

.DLL命令 取鼠标位置, 整数型, "user32", "GetCursorPos", , 获取鼠标指针的当前位置  非零表示成功，零表示失败。会设置GetLastError
    .参数 位置, 坐标, , POINTAPI，随同指针在屏幕像素坐标中的位置载入的一个结构;

.DLL命令 取窗口句柄, 整数型, "user32", "WindowFromPoint", , 返回包含了指定点的窗口的句柄。忽略屏蔽、隐藏以及透明窗口  包含了指定点的窗口的句柄。如指定的点处没有窗口存在，则返回零
    .参数 x点值, 整数型, , x点值
    .参数 y点值, 整数型, , y点值;

.DLL命令 屏蔽窗口矩形, 整数型, "user32", "InvalidateRect", , 这个函数屏蔽一个窗口客户区的全部或部分区域。这会导致窗口在事件期间部分重画  非零表示成功，零表示失败
    .参数 窗口句柄, 整数型, , 待屏蔽窗口的句柄
    .参数 屏蔽矩形, 整数型, , RECT，用于描述待屏蔽矩形部分的一个矩形结构。可用InvalidateRectBynum函数，同时将lpRect设为零（Long数据类型），从而屏蔽（或禁用）整个窗口
    .参数 重画前删除, 整数型, , TRUE（非零）导致指定的区域在重画前先删除;

.DLL命令 俘获鼠标, 整数型, "user32", "SetCapture", , 将鼠标捕获设置到指定的窗口。在鼠标按钮按下的时候，这个窗口会为当前应用程序或整个系统接收所有鼠标输入  之前拥有鼠标捕获的窗口的句柄
    .参数 窗口句柄, 整数型, , 要接收所有鼠标输入的窗口的句柄;

.DLL命令 释放鼠标, 整数型, "user32", "ReleaseCapture", , 为当前的应用程序释放鼠标捕获  TRUE（非零）表示成功，零表示失败

.DLL命令 取字符长度, 整数型, "", "GetWindowTextLengthA", , 
    .参数 句柄, 整数型, , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 开始, 逻辑型, , , 
.程序集变量 方法, 逻辑型, , , 真,为方法1,假,为方法2
.程序集变量 完成, 逻辑型, , , 
.子程序 __启动窗口_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (完成, 真))
    取密码 ()
.如果真结束


.子程序 取密码, 空白型, , 
.局部变量 窗口句柄, 整数型, , , 
.局部变量 返回窗口句柄, 整数型, , , 
.局部变量 坐标, 坐标, , , 
.局部变量 密码, 文本型, , , 
.局部变量 长度, 整数型, , , 

.如果 (等于 (开始, 真))
    取鼠标位置 (坐标)
    赋值 (窗口句柄, 取窗口句柄 (坐标.横向位置, 坐标.纵向位置))
    赋值 (返回窗口句柄, 判断窗口句柄 (窗口句柄))
    .如果真 (不等于 (返回窗口句柄, 0))
        .如果 (等于 (方法, 真))
            赋值 (长度, 相加 (取字符长度 (窗口句柄), 1))
            赋值 (密码, 取空白文本 (长度))
            发送消息 (窗口句柄, 13, 长度, 密码) ' 标识符13和196性质一样。标识符12置文本。
             ' 发送消息 (窗口句柄, 196, 255, 密码)
            信息框 (密码, 0, )
        .否则
            发送消息 (窗口句柄, 204, 0, “0”)
            屏蔽窗口矩形 (窗口句柄, 0, 1)
             ' 消息值=2时隐藏和锁定
            wMsg=10时有焦点字体变灰色
            wMsg=11时有焦点字体隐藏可视
             ' wMsg=12时置文本
            wMsg=16时删除当前被单击的
            wMsg=48时有焦点字体变五号字体
            wMsg=80时窗体最小化
             ' wMsg=204时屏蔽“*”（密码框隐藏密码被显示）
            
        .如果结束
        
    .如果真结束
    
    赋值 (开始, 假)
    赋值 (完成, 假)
    释放鼠标 ()
.否则
    赋值 (开始, 真)
    赋值 (完成, 真)
    俘获鼠标 (_启动窗口.取窗口句柄 ())
.如果结束




.子程序 __启动窗口_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

信息框 (“双狮软件工作室出品 作者:林劲国（TLSWR）”, 0, “关于”)

.子程序 _按钮1_被单击, 空白型, , 
赋值 (方法, 真)
取密码 ()

.子程序 _按钮2_被单击, 空白型, , 
赋值 (方法, 假)
取密码 ()


 ' 不属于任何一个程序集、类模块的函数：
