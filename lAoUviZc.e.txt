 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 635
    高度 = 437
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 14664617 '  0xDFC3A9
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “软件批量安装器v1.1－－子涵工作室”
    帮助文件名 = “”

窗口 进度窗口
    左边 = 5
    顶边 = 600
    宽度 = 504
    高度 = 79
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.图片 手动1, " ' 已保存到：D:\易语言学习\Data\lAoUviZc.e\手动1", , 
.图片 手动2, " ' 已保存到：D:\易语言学习\Data\lAoUviZc.e\手动2", , 
.图片 自动1, " ' 已保存到：D:\易语言学习\Data\lAoUviZc.e\自动1", , 
.图片 自动2, " ' 已保存到：D:\易语言学习\Data\lAoUviZc.e\自动2", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 6 系统核心支持库
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 2 6 扩展界面支持库三
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 1 1 多线程支持库




.全局变量 软件路径, 文本型, , "0", 
.全局变量 软件名称, 文本型, , "0", 

.窗口程序集 启动窗口程序集, , , 

.程序集变量 CDROM, 文本型, , , 
.程序集变量 安装参数, 文本型, , "0", 
.程序集变量 播放, 整数型, , , 0=第一次播放，1＝正在播放，2＝暂停播放
.程序集变量 选择框, 选择框, , "15", 
.程序集变量 手动安装, 图形按钮, , "15", 
.程序集变量 自动安装, 图形按钮, , "15", 
.程序集变量 历史文本, 文本型, , "10", 
.程序集变量 上下移动, 逻辑型, , , 
.程序集变量 步进值, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 i, 整数型, , , 

赋值 (CDROM, 取文本左边 (取运行目录 (), 3))
 ' .如果真 (取反 (文件是否存在 (相加 (CDROM, “Czhchen\Auto\Music.mp3”))))
     ' 结束 ()
.如果真结束
取命令行 (安装参数)
赋值 (., 相减 (相加 (., 437), 取用户区高度 ()))
.计次循环首 (15, i)
    赋值 (选择框 [i], 取标记组件 (i))
    赋值 (手动安装 [i], 取标记组件 (相加 (i, 15)))
    赋值 (手动安装 [i], 正常图片, #手动1)
    赋值 (手动安装 [i], 点燃图片, #手动2)
    赋值 (自动安装 [i], 取标记组件 (相加 (i, 30)))
    赋值 (自动安装 [i], 正常图片, #自动1)
    赋值 (自动安装 [i], 点燃图片, #自动2)
    .如果 (大于 (取数组成员数 (安装参数), 0))
        .如果真 (等于 (安装参数 [1], “-A”))
            赋值 (手动安装 [i], 可视, 假)
            赋值 (自动安装 [i], 可视, 假)
        .如果真结束
        
    .否则
        .如果真 (大于 (i, 1))
            事件转移 (选择框 [i], )
            事件转移 (手动安装 [i], )
            事件转移 (自动安装 [i], )
        .如果真结束
        
    .如果结束
    
.计次循环尾 ()
赋值 (.Internet地址, CDROM)
.如果真 (大于 (取数组成员数 (安装参数), 0))
    .如果真 (等于 (安装参数 [1], “-A”))
        赋值 (.可视, 假)
        赋值 (.可视, 真)
        赋值 (.时钟周期, 1000)
        赋值 (.标题, “5”)
    .如果真结束
    
.如果真结束
写历史文本 ()
赋值 (., 真)
赋值 (步进值, 1)
赋值 (上下移动, 取反 (上下移动))
赋值 (.时钟周期, 60)

.子程序 写历史文本, 空白型, , 
赋值 (历史文本 [1], 相加 (“光盘名称：子涵系统9.5号光盘”, #换行符, “光盘版本：v9.5版”, #换行符, “发行日期：2005年7月”, #换行符, “光盘特色：更新大量软件、加入一键还原软件、修正DOS启动盘的几处BUG、修正某些电脑自动安装超级解霸v9失败的错误！更多...”))
赋值 (历史文本 [2], 相加 (“光盘名称：子涵系统9号光盘”, #换行符, “光盘版本：v9.3版”, #换行符, “发行日期：2005年1月”, #换行符, “光盘特色：全新设计的光盘、去掉了Win98系统，加入联想OEM版XP，成为双XP版系统盘、加入100M常用软件、重新设计DOS启动！更多...”))
赋值 (历史文本 [3], 相加 (“光盘名称：子涵系统8号光盘”, #换行符, “光盘版本：v8.6版”, #换行符, “发行日期：2004年4月”, #换行符, “光盘特色：将WinXP升级成SP1系统、设计了自动、半自动、手动安装系统功能、DOS系统增加了NTFS分区操作功能！更多...”))
赋值 (历史文本 [4], 相加 (“光盘名称：子涵系统8号光盘”, #换行符, “光盘版本：v8.3版”, #换行符, “发行日期：2003年12月”, #换行符, “光盘特色：重新设计的DOS启动系统，加入了DOS下中文支持、更新了DM、PQMagic，加入自编的全自动GHOST伴侣！更多...”))
赋值 (历史文本 [5], 相加 (“光盘名称：子涵系统8号光盘”, #换行符, “光盘版本：v8.0版”, #换行符, “发行日期：2003年6月”, #换行符, “光盘特色：因WinXP系统的逐渐流行，在7.5版的基础上去掉一些软件加入了VLK大客户版XP、全新设计的DOS启动系统！更多...”))
赋值 (历史文本 [6], 相加 (“光盘名称：子涵系统7.5号光盘”, #换行符, “光盘版本：v7.5版”, #换行符, “发行日期：2002年10月”, #换行符, “光盘特色：重新制作Win98的GHOST镜像系统，更加稳定、安装Win98时自动安装NVIDIA显卡最新驱动、更新了一些常用软件！更多...”))
赋值 (历史文本 [7], 相加 (“光盘名称：子涵系统7号光盘”, #换行符, “光盘版本：v7.1版”, #换行符, “发行日期：2002年1月”, #换行符, “光盘特色：全新设计的光盘图形启动界面、Win98的GHOST系统和安装系统双系统合一、并加入大量软件，和自己破解的网吧管理系统！更多...”))
赋值 (历史文本 [8], 相加 (“光盘名称：子涵系统6号光盘”, #换行符, “光盘版本：v6版”, #换行符, “发行日期：2001年5月”, #换行符, “光盘特色：重新制作Win98的GHOST镜像系统，更加稳定、革新DOS系统，自编大量批处理命令，简化操作、融入大量当时最新软件！更多...”))
赋值 (历史文本 [9], 相加 (“光盘名称：子涵系统5号光盘”, #换行符, “光盘版本：v5版”, #换行符, “发行日期：2000年2月”, #换行符, “光盘特色：在Win98安装系统盘上又加入了Win98GHOST系统、自编批处理命令，自动GHOST和自动安装Win98系统，加入常用软件！更多...”))
赋值 (历史文本 [10], 相加 (“光盘名称：子涵系统4号光盘”, #换行符, “光盘版本：v4版”, #换行符, “发行日期：1999年7月”, #换行符, “光盘特色：225M小光盘系统，方便携带，使用、精简版的Win98GHOST系统，大量实用的DOS命令，设计初衷为方便上门服务使用！更多...”))

.子程序 _倒计时钟_周期事件, 空白型, , 
赋值 (.标题, 到文本 (相减 (到数值 (.标题), 1)))
.如果真 (等于 (.标题, “0”))
    赋值 (.时钟周期, 0)
    赋值 (.可视, 假)
    _安装钮_被单击 ()
.如果真结束


.子程序 _常ACD选框_被单击, 空白型, , 
.局部变量 事件选择框, 选择框, , , 

赋值 (事件选择框, 取事件组件 ())
赋值 (事件选择框.文本颜色, 选择 (事件选择框.选中, #红褐, #深青))
.判断开始 (等于 (事件选择框, ))
    赋值 (.选中, .选中)
    赋值 (.文本颜色, 选择 (.选中, #红褐, #深青))
.判断 (等于 (事件选择框, ))
    赋值 (.选中, .选中)
    赋值 (.文本颜色, 选择 (.选中, #红褐, #深青))
.默认
    
.判断结束
.如果真 (.可视)
    赋值 (.时钟周期, 0)
    赋值 (.可视, 假)
.如果真结束


.子程序 取安装路径, 空白型, , 
.参数 方式, 整数型, , 1=取所有被选中的软件路径。2＝取单个软件手动路径。3＝取单个软件自动路径
.参数 标记号, 整数型, 可空, 

.局部变量 i, 整数型, , , 

清除数组 (软件路径)
清除数组 (软件名称)
.判断开始 (等于 (方式, 1))
    .计次循环首 (15, i)
        .如果真 (并且 (选择框 [i], 选中, 不等于 (i, 9), 不等于 (i, 11)))
            加入成员 (软件路径, 软件手动自动安装路径 (假, i))
            加入成员 (软件名称, 选择框 [i], 标题)
        .如果真结束
        
    .计次循环尾 ()
.判断 (等于 (方式, 2))
    加入成员 (软件路径, 软件手动自动安装路径 (真, 标记号))
    加入成员 (软件名称, 选择框 [标记号], 标题)
.判断 (等于 (方式, 3))
    加入成员 (软件路径, 软件手动自动安装路径 (假, 标记号))
    加入成员 (软件名称, 选择框 [标记号], 标题)
.默认
    
.判断结束


.子程序 软件手动自动安装路径, 文本型, , 
.参数 手动或自动, 逻辑型, , 真＝手动路径。假＝自动路径
.参数 标记号, 整数型, , 

.如果 (手动或自动)
    返回 (相加 (CDROM, “Soft\”, 多项选择 (标记号, “常用工具\ACDSee3.1.EXE”, “常用工具\WinRAR3.51.exe”, “常用工具\金山快译2005.exe”, “常用工具\极点五笔5.0.exe”, “常用工具\拼音加加4.01.msi”, “媒体工具\Winamp5.112Pro.exe”, “媒体工具\WinDVD_6\Setup.exe”, “媒体工具\超级解霸v9\Hero.exe”, “媒体工具\超级解霸v9\Crack.exe”, “媒体工具\RealPlayer10.5\RealPlayer10.5.EXE”, “媒体工具\RealPlayer10.5\RPCRACK.EXE”, “网络工具\QQ2006.exe”, “网络工具\FlashGet1.71.exe”, “网络工具\Maxthon1.5.exe”, “网络工具\FoxMail6.0.exe”)))
.否则
    返回 (多项选择 (标记号, 相加 (CDROM, “Soft\常用工具\ACDSee3.1.EXE /S”), 相加 (CDROM, “Soft\常用工具\WinRAR3.51.exe /s”), 相加 (CDROM, “Soft\常用工具\金山快译2005.EXE /verysilent /sp- /norestart”), 相加 (CDROM, “Soft\常用工具\极点五笔5.0.exe /S”), 相加 (CDROM, “Czhchen\Auto\APyjj.exe”), 相加 (CDROM, “Czhchen\Auto\AWp.exe”), 相加 (CDROM, “Czhchen\Auto\AWd.exe”), 相加 (CDROM, “Czhchen\Auto\AHe.exe”), “”, 相加 (CDROM, “Czhchen\Auto\ARP.exe”), “”, 相加 (CDROM, “Czhchen\Auto\AQQ.exe”), 相加 (CDROM, “Czhchen\Auto\AFG.exe”), 相加 (CDROM, “Soft\网络工具\Maxthon1.5.exe /S”), 相加 (CDROM, “Soft\网络工具\Foxmail6.0.exe /verysilent /sp- /norestart”)))
.如果结束


.子程序 _手动钮_被单击, 空白型, , 
.局部变量 事件钮, 图形按钮, , , 

赋值 (事件钮, 取事件组件 ())
取安装路径 (2, 相减 (到数值 (事件钮.标记), 15))
运行 (软件路径 [1], 真, )

.子程序 _自动钮_被单击, 空白型, , 
.局部变量 事件钮, 图形按钮, , , 

赋值 (事件钮, 取事件组件 ())
取安装路径 (3, 相减 (到数值 (事件钮.标记), 30))
赋值 (.标题, 相加 (“正在安装『”, 软件名称 [1], “』请稍等....”))
1.调整层次 ()
赋值 (_启动窗口., 真)
未知支持库函数_0 (&单个自动安装软件, )

.子程序 单个自动安装软件, 空白型, , 
运行 (软件路径 [1], 真, )
2.调整层次 ()
赋值 (_启动窗口., 假)


.子程序 _高级选择夹_子夹被改变, 空白型, , 
.局部变量 文本, 文本型, , , 

.如果真 (.可视)
    .如果 (等于 (., 0))
        赋值 (.标题, “浏览光盘目录...”)
        赋值 (.Internet地址, CDROM)
    .否则
        赋值 (.标题, 相加 (“浏览”, .未知支持库函数_40 (.), “...”))
        赋值 (.Internet地址, 相加 (CDROM, “Soft\”, .未知支持库函数_40 (.)))
    .如果结束
    
.如果真结束
连续赋值 (0, .时钟周期, .高度)
赋值 (.顶边, 80)
赋值 (上下移动, 假)
.如果真 (.可视)
    赋值 (.时钟周期, 0)
    赋值 (.可视, 假)
.如果真结束


.子程序 _安装钮_被单击, 空白型, , 
赋值 (.时钟周期, 0)
取安装路径 (1)
赋值 (_启动窗口., 假)
载入 (进度窗口, _启动窗口, 假)

.子程序 _取消钮_被单击, 空白型, , 
销毁 ()

.子程序 _最小化钮_被单击, 空白型, , 
赋值 (., 2)

.子程序 _关闭钮_被单击, 空白型, , 
销毁 ()

.子程序 _高级钮_被单击, 空白型, , 
.如果真 (.可视)
    赋值 (.时钟周期, 0)
    赋值 (.可视, 假)
.如果真结束
弹出菜单 ()

.子程序 _典型安装_被选择, 空白型, , 
操作选框 ({ 1, 2, 4, 6, 8, 9, 12, 13, 14 }, 真, 假, 假)

.子程序 _完整安装_被选择, 空白型, , 
操作选框 (真, 真)

.子程序 操作选框, 空白型, , 
.参数 那些选框, 整数型, 可空 数组, 
.参数 是否选中, 逻辑型, 可空, 
.参数 全部操作, 逻辑型, , 
.参数 全部选中, 逻辑型, , 

.局部变量 i, 整数型, , , 

.如果 (全部操作)
    .计次循环首 (15, i)
        赋值 (选择框 [i], 选中, 全部选中)
    .计次循环尾 ()
.否则
    .计次循环首 (15, i)
        赋值 (选择框 [i], 选中, 假)
    .计次循环尾 ()
    .计次循环首 (取数组成员数 (那些选框), i)
        赋值 (选择框 [那些选框] [i], 选中, 是否选中)
    .计次循环尾 ()
.如果结束


.子程序 _关于_被选择, 空白型, , 
信息框 (相加 (“软件批量安装器v1.11”, #换行符, #换行符, “作者:子涵工作室！”, #换行符, “E-Mail:ZiHanWorkroom@126.com”), 0, “子涵工作室！”)

.子程序 _常手超框_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (.可视)
    赋值 (.时钟周期, 0)
    赋值 (.可视, 假)
.如果真结束


.子程序 _音乐钮_被单击, 空白型, , 
.判断开始 (等于 (播放, 0))
    播放MP3 (-1, 相加 (CDROM, “Czhchen\Auto\Music.mp3”))
    赋值 (播放, 1)
.判断 (等于 (播放, 1))
    暂停播放MP3 ()
    赋值 (播放, 2)
.判断 (等于 (播放, 2))
    继续播放MP3 ()
    赋值 (播放, 1)
.默认
    
.判断结束


.子程序 _帮助钮_被单击, 空白型, , 
.如果真 (.可视)
    赋值 (.时钟周期, 0)
    赋值 (.可视, 假)
.如果真结束
运行 (相加 (“hh.exe ”, CDROM, “Help.chm”), 假, )

.子程序 _历史钮_被单击, 空白型, , 
.如果真 (.可视)
    赋值 (.时钟周期, 0)
    赋值 (.可视, 假)
.如果真结束
赋值 (步进值, 1)
赋值 (上下移动, 取反 (上下移动))
赋值 (.时钟周期, 60)

.子程序 _历史时钟_周期事件, 空白型, , 
.如果 (上下移动)
    .如果 (小于 (.高度, 78))
        赋值 (.高度, 相加 (.高度, 3))
    .否则
        赋值 (.顶边, 相减 (.顶边, 1))
        .如果真 (小于或等于 (.顶边, -80))
            赋值 (.顶边, 80)
            .如果 (大于 (步进值, 10))
                赋值 (上下移动, 假)
            .否则
                赋值 (.标题, 历史文本 [步进值])
                赋值 (步进值, 相加 (步进值, 1))
            .如果结束
            
        .如果真结束
        
    .如果结束
    
.否则
    .如果 (大于 (.高度, 0))
        赋值 (.高度, 相减 (.高度, 3))
    .否则
        赋值 (.顶边, 80)
        赋值 (.时钟周期, 0)
    .如果结束
    
.如果结束


.子程序 _邮件钮_被单击, 空白型, , 
跳转 ()

.子程序 _目录浏览框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (.可视)
    赋值 (.时钟周期, 0)
    赋值 (.可视, 假)
.如果真结束


.子程序 _右键总在最前_被选择, 空白型, , 
赋值 (.选中, 取反 (.选中))
赋值 (., .选中)

.子程序 _异常说明_被选择, 空白型, , 
信息框 (相加 (“异常现象： 软件在进行自动安装时遇见某些特别情况无法自动完成安装将导致无限等待状态！类似死机！”, #换行符, #换行符, “异常原因： 软件在进行自动安装的时候为了防止用户操作鼠标或键盘导致自动安装程序中的脚本命令失败，作者特意锁定了键盘和鼠标，待到安装结束后将自动解锁。有时候自动安装程序异常中止导致没有正确解锁，程序进入无限等待状态，使人误认为死机！”, #换行符, #换行符, “处理方法： 这时可以按Ctrl+Alt+Del热启动键一次即可解锁，然后将异常的程序手动安装完就可以了。”), 0, “子涵工作室！－－异常情况处理”)

.窗口程序集 进度窗口程序集, , , 

.子程序 _进度窗口_创建完毕, 空白型, , 
移动 (5, 相减 (取屏幕高度 (), ., 到数值 (_启动窗口..标题)), , )
赋值 (.最大位置, 相乘 (取数组成员数 (软件路径), 10))
赋值 (., 真)
赋值 (.时钟周期, 10)
未知支持库函数_0 (&安装软件, )

.子程序 安装软件, 空白型, , 
.局部变量 i, 整数型, , , 

.计次循环首 (取数组成员数 (软件路径), i)
    赋值 (.标题, 相加 (“ ”, 软件名称 [i]))
    运行 (软件路径 [i], 真, )
    赋值 (.位置, 相乘 (i, 10))
.计次循环尾 ()
结束 ()

.子程序 _进度时钟_周期事件, 空白型, , 
赋值 (.位置, 相加 (.位置, 1))
.如果真 (大于或等于 (.位置, 100))
    赋值 (.位置, 0)
.如果真结束



 ' 不属于任何一个程序集、类模块的函数：
