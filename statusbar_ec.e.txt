 ' 文件类型：Windows窗口程序

 ' 程序名称：状态栏控件2.0
 ' 程序描述：用纯净的api函数通过易模块封装，简便的实现了一个状态栏控件。
注意！
――――――
和1.0以及1.2有很大改动，请阅读readme之后再使用，对于改动给你带来的不便表示深深的歉意。
――――――
 ' 程序作者：影
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 2 0 系统核心支持库





.常量 WS_CHILD, "1073741824", , 
.常量 WS_VISIBLE, "268435456", , 
.常量 WM_SIZE, "5", , 
.常量 SIZE_RESTORED, "0", , 
.常量 SB_SETTEXT, "1025", , 
.常量 SB_SETPARTS, "1028", , 
.常量 SBT_TOOLTIPS, "2048", , 
.常量 SB_SETTIPTEXT, "1040", , 


数据类型 状态栏和父窗口, , 
    .成员 状态栏句柄, 整数型, , , 
    .成员 父窗口, 窗口, , , 


.DLL命令 外部_创建状态栏, 整数型, "comctl32", "CreateStatusWindowA", , 返回获得的句柄
    .参数 样式, 整数型, , 
    .参数 文字, 文本型, , 
    .参数 父窗口句柄, 整数型, , 
    .参数 控件标识, 整数型, , 

.DLL命令 外部_移动窗口, 逻辑型, "user32.dll", "MoveWindow", , 
    .参数 窗口句柄, 整数型, , 
    .参数 左边, 整数型, , 
    .参数 顶边, 整数型, , 
    .参数 宽度, 整数型, , 
    .参数 高度, 整数型, , 
    .参数 是否重画, 逻辑型, , 

.DLL命令 外部_发送消息, 空白型, "user32.dll", "SendMessageA", , 
    .参数 发送对象句柄, 整数型, , 
    .参数 消息, 整数型, , 
    .参数 辅助参数一, 整数型, , 
    .参数 辅助参数二, 整数型, , 

.DLL命令 外部_发送消息_SB_SETTEXT, 空白型, "user32.dll", "SendMessageA", , 
    .参数 发送对象句柄, 整数型, , 
    .参数 消息, 整数型, , 
    .参数 辅助参数一, 整数型, , 
    .参数 辅助参数二, 文本型, , 

.DLL命令 外部_发送消息_SB_SETPARTS, 空白型, "user32.dll", "SendMessageA", , 
    .参数 发送对象句柄, 整数型, , 
    .参数 消息, 整数型, , 
    .参数 辅助参数一, 整数型, , 
    .参数 辅助参数二, 整数型, 数组, 

.DLL命令 外部_获得最后的错误, 整数型, "Kernel32", "GetLastError", , 

.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在模块初始化代码执行完毕后调用模块测试代码

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的参数及返回值类型。


.程序集 _接口程序集, , , 在本程序集中定义的子程序可被模块外部程序访问，注意如果不存在本程序集就不能作为易模块编译。

.程序集变量 状态栏结构, 状态栏和父窗口, , "0", 
.子程序 模块_创建状态栏, 整数型, , 返回批号
.参数 父窗口, 窗口, , 你想要添加状态栏的窗口的句柄
.参数 状态栏标识, 整数型, , 一个随意的数字
.参数 初始文本, 文本型, 可空, 就用空吧
.参数 分割块数组, 整数型, 可空 数组, 可以为空，{25,,25,50}

.局部变量 状态栏句柄, 整数型, , , 
.局部变量 状态栏和父窗口, 状态栏和父窗口, , , 
.局部变量 批号, 整数型, , , 

.如果真 (是否为空 (初始文本))
    赋值 (初始文本, 父窗口.)
.如果真结束
赋值 (状态栏句柄, 外部_创建状态栏 (位或 (#WS_CHILD, #WS_VISIBLE, #SBT_TOOLTIPS), 初始文本, 父窗口.取窗口句柄 (), 状态栏标识))
赋值 (状态栏和父窗口.状态栏句柄, 状态栏句柄)
赋值 (状态栏和父窗口.父窗口, 父窗口)
加入成员 (状态栏结构, 状态栏和父窗口)
赋值 (批号, 取数组成员数 (状态栏结构))
.如果真 (取反 (是否为空 (分割块数组)))
    模块_分割状态栏 (批号, 分割块数组)
.如果真结束
返回 (批号)

.子程序 模块_分割状态栏, 空白型, , 
.参数 批号, 整数型, , 
.参数 分割块数组, 整数型, 数组, 改变了！使用比例{25,25,50}

.局部变量 块的个数, 整数型, , , 
.局部变量 循环, 整数型, , , 
.局部变量 当前位置, 整数型, , , 
.局部变量 临时数组, 整数型, , "0", 

赋值 (取数组成员数 (分割块数组))
重定义数组 (临时数组, 假, 块的个数)
.变量循环首 (1, 块的个数, 1, 循环)
    .判断开始 (等于 (分割块数组 [循环], -1))
        赋值 (临时数组 [循环], -1)
        跳出循环 ()
    .默认
        赋值 (临时数组 [循环], 相加 (当前位置, 整除 (相乘 (状态栏结构 [批号], 父窗口., 分割块数组 [循环]), 100)))
        赋值 (当前位置, 相加 (当前位置, 临时数组 [循环]))
    .判断结束
    
.变量循环尾 ()
外部_发送消息_SB_SETPARTS (状态栏结构 [批号], 状态栏句柄, #SB_SETPARTS, 块的个数, 临时数组)

.子程序 模块_修正状态栏位置, 空白型, , 在窗口的尺寸改变中使用
.参数 批号, 整数型, , 
.参数 分割块数组, 整数型, 数组, 

外部_发送消息 (状态栏结构 [批号], 状态栏句柄, #WM_SIZE, #SIZE_RESTORED, 0)
模块_分割状态栏 (批号, 分割块数组)

.子程序 模块_在状态栏上写出文本, 空白型, , 
.参数 批号, 整数型, , 
.参数 写出的文本, 文本型, , 
.参数 对应的块, 整数型, , 1起

外部_发送消息_SB_SETTEXT (状态栏结构 [批号], 状态栏句柄, #SB_SETTEXT, 相减 (对应的块, 1), 写出的文本)


 ' 不属于任何一个程序集、类模块的函数：
