 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 500
    高度 = 570
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “影视信息搜集器 v1.0(技术支持QQ: 806681818)”
    帮助文件名 = “”



.常量 分割符, "“<div id="AdditionalAD">”", , 
.常量 头一, "“ alt="”", , 
.常量 头二, "“><img src="”", , 
.常量 头三, "“RecordContent">”", , 
.常量 去除一, "“<span id="HL">”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库
 ' internet 707ca37322474f6ca841f0e224f4b620 1 0 互联网支持库
 ' RegEx 684944CB04624eb7BD5412A519421D34 1 2 正则表达式支持库
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 1 1 多线程支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 3 扩展界面支持库一



 ' 所需要的模块
 ' 编码转换大全 $模块_编码转换大全.EC
 ' 彗星HTTP应用模块 $模块_彗星HTTP应用模块.EC


数据类型 详细信息, , 
    .成员 图片路径, 文本型, , , 
    .成员 图片数据, 字节集, , , 
    .成员 片名, 文本型, , , 
    .成员 上映, 文本型, , , 
    .成员 地区, 文本型, , , 
    .成员 语言, 文本型, , , 
    .成员 类型, 文本型, , , 
    .成员 导演, 文本型, , , 
    .成员 主演, 文本型, , , 
    .成员 剧情, 文本型, , , 


.DLL命令 WideCharToMultiByte, 整数型, "kernel32", "WideCharToMultiByte", 公开, 
    .参数 CodePage, 整数型, , 
    .参数 dwFlags, 整数型, , 
    .参数 lpWideCharStr, 字节集, 传址, 
    .参数 cchWideChar, 整数型, , 
    .参数 lpMultiByteStr, 文本型, 传址, 
    .参数 cchMultiByte, 整数型, , 
    .参数 lpDefaultChar, 整数型, , 
    .参数 lpUsedDefaultChar, 整数型, , 

.DLL命令 MultiByteToWideChar, 整数型, "", "MultiByteToWideChar", 公开, 
    .参数 CodePage, 整数型, , 
    .参数 dwFlags, 整数型, , 
    .参数 lpMultiByteStr, 文本型, 传址, 
    .参数 cchMultiByte, 整数型, , 
    .参数 lpWideCharStr, 字节集, 传址, 
    .参数 cchWideChar, 整数型, , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 网页内容, 文本型, , , 
.程序集变量 影视信息, 文本型, , "0", 
.程序集变量 详细信息, 详细信息, , "0", 
.程序集变量 线程句柄, 整数型, , "2", 
.程序集变量 当前索引, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (., 是否为调试版 ())
.如果真 (等于 (是否为调试版 (), 真))
    赋值 (.内容, “赌神”)
.如果真结束
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\配置文件.ini”), “配置”, “路径”, 取运行目录 ()))

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
未知支持库函数_6 (线程句柄 [1])
未知支持库函数_6 (线程句柄 [2])

.子程序 _按钮1_被单击, 空白型, , 
赋值 (.禁止, 真)
未知支持库函数_0 (&采集信息, 线程句柄 [1], )
0.置文本 (“就绪:”)

.子程序 _按钮2_被单击, 空白型, , 
.局部变量 A, 文本型, , , 

赋值 (A, 未知支持库函数_2 (“请选择一个导出信息的路径:”, ))
.如果真 (不等于 (A, “”))
    赋值 (.内容, A)
    写配置项 (相加 (取运行目录 (), “\配置文件.ini”), “配置”, “路径”, A)
.如果真结束


.子程序 _按钮3_被单击, 空白型, , 
.局部变量 A, 文本型, , , 
.局部变量 B, 文本型, , , 
.局部变量 C, 整数型, , , 
.局部变量 D, 编辑框, , , 
.局部变量 E, 文本型, , , 
.局部变量 F, 文本型, , , 

赋值 (A, .内容)
.如果真 (不等于 (取文本右边 (A, 1), “\”))
    赋值 (A, 相加 (A, “\”))
.如果真结束
赋值 (B, 相减 (当前索引, 1).取项目文本 ())
写到文件 (相加 (A, B, “.JPG”), .图片)
.计次循环首 (8, C)
    赋值 (D, 取标记组件 (C))
    赋值 (E, 相加 (E, 多项选择 (C, “片名”, “上映”, “地区”, “语言”, “类型”, “导演”, “主演”, “剧情”), “: ”, D.内容, #换行符))
.计次循环尾 ()
.判断开始 (等于 (写到文件 (相加 (A, B, “.TXT”), 到字节集 (E)), 真))
    信息框 (“导出信息成功:”, #信息图标, “提示信息”)
.默认
    .如果真 (等于 (信息框 (相加 (“自动保存文件名称不合法,”, #换行符, “是否自定义保存文件名称?”), 相加 (#错误图标, #是否钮), “提示信息”), #是钮))
        .如果真 (等于 (输入框 (“请输入保存文件名称:”, “导出信息”, , F, ), 真))
            写到文件 (相加 (A, F, “.JPG”), .图片)
            .判断开始 (等于 (写到文件 (相加 (A, F, “.TXT”), 到字节集 (E)), 真))
                信息框 (“导出信息成功:”, #信息图标, “提示信息”)
            .默认
                信息框 (“导出信息失败:”, #错误图标, “提示信息”)
            .判断结束
            
        .如果真结束
        
    .如果真结束
    
.判断结束


.子程序 _编辑框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (并且 (等于 (键代码, #回车键), 等于 (.禁止, 假)))
    _按钮1_被单击 ()
.如果真结束


.子程序 采集信息, 空白型, , 
.局部变量 A, 文本型, , "0", 
.局部变量 B, 文本型, , "0", 

.如果真 (等于 (删全部空 (.内容), “”))
    赋值 (.禁止, 假)
    返回 ()
.如果真结束
0.置文本 (相加 (“正在搜索: ”, .内容, “...”))
赋值 (网页内容, 到文本 (UTF8到Ansi (未知支持库函数_7 (相加 (“http://so.mdbchina.com/query/”, 彗星URL编码_UTF8 (.内容))))))
.如果真 (大于 (寻找文本 (网页内容, “抱歉，没有找到与”, , 假), 0))
    信息框 (“未找到相关信息:”, #信息图标, “提示信息”)
    0.置文本 (“就绪:”)
    赋值 (.禁止, 假)
    返回 ()
.如果真结束
赋值 (A, 分割文本 (网页内容, “搜索用时”, ))
.如果真 (不等于 (取数组成员数 (A), 2))
    信息框 (“读取信息错误:”, #错误图标, “提示信息”)
    0.置文本 (“就绪:”)
    赋值 (.禁止, 假)
    返回 ()
.如果真结束
赋值 (B, 分割文本 (A [2], #分割符, ))
.如果真 (不等于 (取数组成员数 (B), 2))
    信息框 (“读取信息错误:”, #错误图标, “提示信息”)
    0.置文本 (“就绪:”)
    赋值 (.禁止, 假)
    返回 ()
.如果真结束
赋值 (影视信息, 分割文本 (B [1], “<\a><\span><\div><\div>”, ))
删除成员 (影视信息, 取数组成员数 (影视信息), 1)
提取网页信息 ()
0.置文本 (“就绪:”)
赋值 (.禁止, 假)

.子程序 提取网页信息, 空白型, , 
.局部变量 A, 整数型, , , 
.局部变量 B, 未知类型0x40001, , , 
.局部变量 C, 未知类型0x40002, , "0", 
.局部变量 D, 文本型, , , 
.局部变量 E, 详细信息, , "0", 

清空 ()
重定义数组 (详细信息, 假, 取数组成员数 (影视信息))
.计次循环首 (取数组成员数 (影视信息), A)
     ' 获取片名
    B.未知支持库函数_3 (相加 (#头一, “(.*?)”, #引号), )
    B.未知支持库函数_16 (影视信息 [A])
    赋值 (C, B.未知支持库函数_16 (影视信息 [A]))
    .如果真 (大于 (寻找文本 (C.未知支持库函数_12 ( [1], 影视信息 [A], 1, ), .内容, , 假), 0))
        赋值 (详细信息 [A], 片名, C.未知支持库函数_12 ( [1], 影视信息 [A], 1, ))
        详细信息.加入项目 ( [A], 片名, )
         ' 获取海报地址
        B.未知支持库函数_3 (相加 (#头二, “(.*?)”, #引号), )
        赋值 (C, B.未知支持库函数_16 (影视信息 [A]))
        赋值 (详细信息 [A], 图片路径, C.未知支持库函数_12 ( [1], 影视信息 [A], 1, ))
         ' 获取上映时间
        .判断开始 (大于 (寻找文本 (影视信息 [A], “上映：”, , 假), 0))
            B.未知支持库函数_3 (“上映：.*?<”, )
            赋值 (C, B.未知支持库函数_16 (影视信息 [A]))
            赋值 (D, C.未知支持库函数_11 ( [1], 影视信息 [A], ))
            赋值 (D, 取文本中间 (D, 7, 相减 (取文本长度 (D), 7)))
            赋值 (详细信息 [A], 上映, D)
        .默认
            赋值 (详细信息 [A], 上映, “未知”)
        .判断结束
         ' 获取地区
        .判断开始 (大于 (寻找文本 (影视信息 [A], “地区：”, , 假), 0))
            B.未知支持库函数_3 (“地区：.*?<”, )
            赋值 (C, B.未知支持库函数_16 (影视信息 [A]))
            赋值 (D, C.未知支持库函数_11 ( [1], 影视信息 [A], ))
            赋值 (D, 取文本中间 (D, 7, 相减 (取文本长度 (D), 7)))
            赋值 (详细信息 [A], 地区, D)
        .默认
            赋值 (详细信息 [A], 地区, “未知”)
        .判断结束
         ' 获取语言
        .判断开始 (大于 (寻找文本 (影视信息 [A], “语言：”, , 假), 0))
            B.未知支持库函数_3 (“语言：.*?<”, )
            赋值 (C, B.未知支持库函数_16 (影视信息 [A]))
            赋值 (D, C.未知支持库函数_11 ( [1], 影视信息 [A], ))
            赋值 (D, 取文本中间 (D, 7, 相减 (取文本长度 (D), 7)))
            赋值 (详细信息 [A], 语言, D)
        .默认
            赋值 (详细信息 [A], 语言, “未知”)
        .判断结束
         ' 获取类型
        .判断开始 (大于 (寻找文本 (影视信息 [A], “类型：”, , 假), 0))
            B.未知支持库函数_3 (“类型：.*?<”, )
            赋值 (C, B.未知支持库函数_16 (影视信息 [A]))
            赋值 (D, C.未知支持库函数_11 ( [1], 影视信息 [A], ))
            赋值 (D, 取文本中间 (D, 7, 相减 (取文本长度 (D), 7)))
            赋值 (详细信息 [A], 类型, D)
        .默认
            赋值 (详细信息 [A], 类型, “未知”)
        .判断结束
         ' 获取导演
        .判断开始 (大于 (寻找文本 (影视信息 [A], “导演：”, , 假), 0))
            B.未知支持库函数_3 (“导演：.*?<”, )
            赋值 (C, B.未知支持库函数_16 (影视信息 [A]))
            赋值 (D, C.未知支持库函数_11 ( [1], 影视信息 [A], ))
            赋值 (D, 取文本中间 (D, 7, 相减 (取文本长度 (D), 7)))
            赋值 (详细信息 [A], 导演, D)
        .默认
            赋值 (详细信息 [A], 导演, “未知”)
        .判断结束
         ' 获取主演
        .判断开始 (大于 (寻找文本 (影视信息 [A], “主演：”, , 假), 0))
            B.未知支持库函数_3 (“主演：.*?<”, )
            赋值 (C, B.未知支持库函数_16 (影视信息 [A]))
            赋值 (D, C.未知支持库函数_11 ( [1], 影视信息 [A], ))
            赋值 (D, 取文本中间 (D, 7, 相减 (取文本长度 (D), 7)))
            赋值 (详细信息 [A], 主演, D)
        .默认
            赋值 (详细信息 [A], 主演, “未知”)
        .判断结束
         ' 获取剧情
        B.未知支持库函数_3 (相加 (#头三, “(.*?)<\\div><\\div>”), )
        赋值 (C, B.未知支持库函数_16 (影视信息 [A]))
        .判断开始 (不等于 (取数组成员数 (C), 0))
            赋值 (D, C.未知支持库函数_12 ( [1], 影视信息 [A], 1, ))
            赋值 (D, 子文本替换 (D, #去除一, , , , 真))
            赋值 (D, 子文本替换 (D, “<\span>”, , , , 真))
            赋值 (详细信息 [A], 剧情, D)
        .默认
            赋值 (详细信息 [A], 剧情, “未找到相关剧情:”)
        .判断结束
        
    .如果真结束
    0.置文本 (相加 (“正在采集: ”, 详细信息 [A], 片名))
.计次循环尾 ()
.计次循环首 (取数组成员数 (详细信息), A)
    .如果真 (不等于 (详细信息 [A], 片名, “”))
        加入成员 (E, 详细信息 [A])
    .如果真结束
    
.计次循环尾 ()
复制数组 (详细信息, E)
未知支持库函数_0 (&读取海报, , 线程句柄 [2])

.子程序 读取海报, 空白型, , 
.局部变量 A, 整数型, , , 
.局部变量 B, 字节集, , , 

.计次循环首 (取数组成员数 (详细信息), A)
    0.置文本 (相加 (“正在下载海报: ”, 详细信息 [A], 片名))
    赋值 (B, 未知支持库函数_7 (详细信息 [A], 图片路径))
    赋值 (详细信息 [A], 图片数据, B)
    处理事件 ()
.计次循环尾 ()
.如果真 (不等于 (取项目数 (), 0))
    赋值 (.现行选中项, 0)
    _列表框1_列表项被选择 ()
.如果真结束
0.置文本 (“就绪:”)
赋值 (.禁止, 假)

.子程序 _列表框1_列表项被选择, 空白型, , 
.局部变量 A, 整数型, , , 

赋值 (A, 相加 (.现行选中项, 1))
赋值 (.内容, 详细信息 [A], 片名)
赋值 (.内容, 详细信息 [A], 上映)
赋值 (.内容, 详细信息 [A], 地区)
赋值 (.内容, 详细信息 [A], 语言)
赋值 (.内容, 详细信息 [A], 类型)
赋值 (.内容, 详细信息 [A], 导演)
赋值 (.内容, 详细信息 [A], 主演)
赋值 (.内容, 详细信息 [A], 剧情)
赋值 (.图片, 详细信息 [A], 图片数据)
赋值 (当前索引, A)


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 Ansi到UTF8, 字节集, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 文件名, 文本型, , 



.子程序 UTF8到Ansi, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 UTF8编码, 字节集, , 



.子程序 Unicode到Ansi, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 Unicode编码, 字节集, , Unicode码字节集数据



.子程序 Ansi到Unicode, 字节集, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 待转文本, 文本型, , Ansi码文本，只针对中文或双字节全角字符



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 彗星URL编码, 文本型, , 返回已编码的URL
.参数 Bin_URL, 文本型, , 



.子程序 彗星URL编码_UTF8, 文本型, , 返回已编码的URL
.参数 Bin_URL, 文本型, , 



.子程序 彗星URL解码, 文本型, , 返回已解码的URL
.参数 Bin_URL, 文本型, , 



.子程序 彗星URL解码_UTF8, 文本型, , 返回已解码的URL
.参数 Bin_URL, 文本型, , 



.子程序 彗星HTTP读文件, 字节集, , 有可能线程阻塞,请在外部加超时判断
.参数 完整网址, 文本型, , 
.参数 访问方式, 文本型, 可空, "GET" or "POST",为空默认"GET"
.参数 代理地址, 文本型, 可空, 
.参数 附加协议头, 文本型, 可空, 
.参数 提交信息, 文本型, 可空, "POST"专用
.参数 网页头, 文本型, 参考 可空, 返回网页头部信息



.子程序 彗星HTTP读文本, 文本型, , 有可能线程阻塞,请在外部加超时判断
.参数 完整网址, 文本型, , 
.参数 访问方式, 文本型, 可空, "GET" or "POST",为空默认"GET"
.参数 代理地址, 文本型, 可空, 
.参数 附加协议头, 文本型, 可空, 
.参数 提交信息, 文本型, 可空, "POST"专用
.参数 网页头, 文本型, 参考 可空, 返回网页头部信息



.子程序 彗星打开指定网址, 空白型, , 调用默认浏览器打开指定网址
.参数 要打开的网址, 文本型, , 




 ' 不属于任何一个程序集、类模块的函数：
