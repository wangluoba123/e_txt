 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 639
    高度 = 388
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “易数据库表格打印工具”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 2 系统核心支持库





.窗口程序集 窗口程序集1, , , 

.程序集变量 项目, 文本型, , "0", 
.程序集变量 尺寸, 整数型, , "0", 
.程序集变量 表格设置, 文本型, , "5", 
.程序集变量 选择框, 选择框, , "0", 
.程序集变量 项目组合框, 组合框, , "0", 
.程序集变量 条件组合框, 组合框, , "0", 
.程序集变量 首编辑框, 编辑框, , "0", 
.程序集变量 尾编辑框, 编辑框, , "0", 
.程序集变量 首日期框, 日期框, , "0", 
.程序集变量 尾日期框, 日期框, , "0", 
.程序集变量 到标签, 标签, , "0", 
.程序集变量 真假组合框, 组合框, , "0", 
.程序集变量 配置文件, 文本型, , , 
.程序集变量 选择, 逻辑型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (., 相加 (“    《易语言数据库表格打印工具》是专为易语言数据库设置的表格打印工具，利用本工具，你可以轻松地将易语言数据库以表格形式打印出来。”, #换行符, #换行符, “    你可以筛选符合条件的记录，并选择需要打印的字段以及设置字段打印的宽度。同时，你还可以设置表格的标题和说明文本。通过使用本工具，你将可以方便地打印各类登记表格。”, #换行符, #换行符, “    本工具目前版本为1.0，如果在使用过程中发现问题，欢迎及时与我联系！Email：qdhf@pub.nt.jsinfo.net。”))
连续赋值 (真, ., ., ., ., ., ., .)

.子程序 _上一步_被单击, 空白型, , 
赋值 (., “”)
赋值 (., 相减 (., 1))
赋值 (., 假)
赋值 (., 真)
.判断开始 (等于 (., 0))
    赋值 (., 假)
    赋值 (选择, 假)
.判断 (等于 (., 1))
    .如果真 (不等于 (取当前库 (), “print”))
        关闭 ()
        置当前库 (“print”)
    .如果真结束
    
.默认
    
.判断结束


.子程序 _下一步_被单击, 空白型, , 
.局部变量 容器1, 整数型, , , 

.判断开始 (等于 (., 1))
    .计次循环首 (相减 (取数组成员数 (选择框), 1), 容器1)
        .判断开始 (或者 (等于 (取字段类型 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), #字节型), 等于 (取字段类型 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), #短整数型), 等于 (取字段类型 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), #整数型), 等于 (取字段类型 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), #长整数型), 等于 (取字段类型 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), #小数型), 等于 (取字段类型 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), #双精度小数型)))
            .判断开始 (等于 (条件组合框.取项目文本 ( [容器1], 条件组合框 [容器1], ), “介于……”))
                复制记录 (“printtool1.tmp”, 并且 (大于或等于 (读 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), 到数值 (首编辑框 [容器1], )), 小于或等于 (读 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), 到数值 (尾编辑框 [容器1], ))), )
            .判断 (等于 (条件组合框.取项目文本 ( [容器1], 条件组合框 [容器1], ), “大于……”))
                复制记录 (“printtool1.tmp”, 大于 (读 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), 到数值 (首编辑框 [容器1], )), )
            .判断 (等于 (条件组合框.取项目文本 ( [容器1], 条件组合框 [容器1], ), “大于等于”))
                复制记录 (“printtool1.tmp”, 大于或等于 (读 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), 到数值 (首编辑框 [容器1], )), )
            .判断 (等于 (条件组合框.取项目文本 ( [容器1], 条件组合框 [容器1], ), “小于……”))
                复制记录 (“printtool1.tmp”, 小于 (读 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), 到数值 (首编辑框 [容器1], )), )
            .判断 (等于 (条件组合框.取项目文本 ( [容器1], 条件组合框 [容器1], ), “小于等于”))
                复制记录 (“printtool1.tmp”, 小于或等于 (读 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), 到数值 (首编辑框 [容器1], )), )
            .判断 (等于 (条件组合框.取项目文本 ( [容器1], 条件组合框 [容器1], ), “等于……”))
                复制记录 (“printtool1.tmp”, 等于 (读 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), 到数值 (首编辑框 [容器1], )), )
            .默认
                
            .判断结束
            
        .判断 (或者 (等于 (取字段类型 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), #文本型), 等于 (取字段类型 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), #备注型)))
            .判断开始 (等于 (条件组合框.取项目文本 ( [容器1], 条件组合框 [容器1], ), “全等于”))
                复制记录 (“printtool1.tmp”, 等于 (读 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), 首编辑框 [容器1], ), )
            .判断 (等于 (条件组合框.取项目文本 ( [容器1], 条件组合框 [容器1], ), “左等于”))
                复制记录 (“printtool1.tmp”, 近似等于 (读 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), 首编辑框 [容器1], ), )
            .判断 (等于 (条件组合框.取项目文本 ( [容器1], 条件组合框 [容器1], ), “包含…”))
                复制记录 (“printtool1.tmp”, 不等于 (寻找文本 (读 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), 首编辑框 [容器1], , , 真), -1), )
            .默认
                
            .判断结束
            
        .判断 (等于 (取字段类型 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), #日期时间型))
            .判断开始 (等于 (条件组合框.取项目文本 ( [容器1], 条件组合框 [容器1], ), “介于……”))
                复制记录 (“printtool1.tmp”, 并且 (大于或等于 (到时间 (时间到文本 (读 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), #日期部分)), 到时间 (时间到文本 (首日期框 [容器1], , #日期部分))), 小于或等于 (到时间 (时间到文本 (读 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), #日期部分)), 到时间 (时间到文本 (尾日期框 [容器1], , #日期部分)))), )
            .判断 (等于 (条件组合框.取项目文本 ( [容器1], 条件组合框 [容器1], ), “大于……”))
                复制记录 (“printtool1.tmp”, 大于 (到时间 (时间到文本 (读 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), #日期部分)), 到时间 (时间到文本 (首日期框 [容器1], , #日期部分))), )
            .判断 (等于 (条件组合框.取项目文本 ( [容器1], 条件组合框 [容器1], ), “大于等于”))
                复制记录 (“printtool1.tmp”, 大于或等于 (到时间 (时间到文本 (读 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), #日期部分)), 到时间 (时间到文本 (首日期框 [容器1], , #日期部分))), )
            .判断 (等于 (条件组合框.取项目文本 ( [容器1], 条件组合框 [容器1], ), “小于……”))
                复制记录 (“printtool1.tmp”, 小于 (到时间 (时间到文本 (读 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), #日期部分)), 到时间 (时间到文本 (首日期框 [容器1], , #日期部分))), )
            .判断 (等于 (条件组合框.取项目文本 ( [容器1], 条件组合框 [容器1], ), “小于等于”))
                复制记录 (“printtool1.tmp”, 小于或等于 (到时间 (时间到文本 (读 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), #日期部分)), 到时间 (时间到文本 (首日期框 [容器1], , #日期部分))), )
            .判断 (等于 (条件组合框.取项目文本 ( [容器1], 条件组合框 [容器1], ), “等于……”))
                复制记录 (“printtool1.tmp”, 等于 (到时间 (时间到文本 (读 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), #日期部分)), 到时间 (时间到文本 (首日期框 [容器1], , #日期部分))), )
            .默认
                
            .判断结束
            
        .判断 (等于 (取字段类型 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), #逻辑型))
            复制记录 (“printtool1.tmp”, 等于 (读 (项目组合框.取项目文本 ( [容器1], 项目组合框 [容器1], )), 选择 (等于 (真假组合框 [容器1], , 0), 真, 假)), )
            
        .默认
            
        .判断结束
        打开 (“printtool1.tmp”, , , , , , )
        复制记录 (“printtool2.tmp”, , )
        关闭 ()
        打开 (“printtool2.tmp”, , , , , , )
    .计次循环尾 ()
.判断 (等于 (., 2))
    清除数组 (项目)
    .计次循环首 (取项目数 (), 容器1)
        加入成员 (项目, 相减 (容器1, 1).取项目文本 ())
    .计次循环尾 ()
    复制记录 (“printtool.tmp”, , 项目)
    关闭 ()
    打开 (“printtool.tmp”, , , , , , )
    删除文件 (“printtool1.tmp”)
    删除文件 (“printtool1.edt”)
    删除文件 (“printtool2.tmp”)
    删除文件 (“printtool2.edt”)
.默认
    
.判断结束
赋值 (., 相加 (., 1))
赋值 (., 真)
.如果真 (等于 (., 3))
    赋值 (., 真)
    赋值 (., 假)
.如果真结束
未知函数_67174429 ()

.子程序 _打印_被单击, 空白型, , 
.局部变量 打印设置, 打印设置信息, , , 

赋值 (., #A4纸)
赋值 (., #横向)
赋值 (., 200)
赋值 (., 200)
赋值 (., 200)
赋值 (., 200)
赋值 (., #下中页号)
赋值 (., 真)
赋值 (., -1)
.置打印设置 ()
打印预览 ()

.子程序 _选择夹1_子夹被改变, 空白型, , 
.局部变量 容器1, 整数型, , , 
.局部变量 容器2, 整数型, , , 
.局部变量 名称, 文本型, , , 
.局部变量 打印, 逻辑型, , , 
.局部变量 数值, 整数型, , "0", 
.局部变量 文件号, 整数型, , , 
.局部变量 临时文本, 文本型, , , 

.判断开始 (等于 (., 1))
    .如果真 (等于 (选择, 真))
        赋值 (., 假)
        赋值 (., 假)
        清空 ()
        .计次循环首 (取字段数 (), )
            .如果真 (不等于 (取字段类型 (容器1), #字节集型))
                取字段名 (容器1).加入项目 (容器1)
            .如果真结束
            
        .计次循环尾 ()
        赋值 (., 真)
        赋值 (., 真)
        连续赋值 (假, ., ., ., ., ., .)
        赋值 (., “”)
        赋值 (., “”)
        .如果真 (等于 (取数组成员数 (选择框), 0))
            加入成员 (选择框, )
            加入成员 (项目组合框, )
            加入成员 (条件组合框, )
            加入成员 (首编辑框, )
            加入成员 (尾编辑框, )
            加入成员 (首日期框, )
            加入成员 (尾日期框, )
            加入成员 (到标签, )
            加入成员 (真假组合框, )
        .如果真结束
        .计次循环首 (取数组成员数 (选择框), 容器1)
            .如果真 (大于 (容器1, 1))
                选择框.销毁 ( [容器1])
                项目组合框.销毁 ( [容器1])
                条件组合框.销毁 ( [容器1])
                首编辑框.销毁 ( [容器1])
                尾编辑框.销毁 ( [容器1])
                首日期框.销毁 ( [容器1])
                尾日期框.销毁 ( [容器1])
                到标签.销毁 ( [容器1])
                真假组合框.销毁 ( [容器1])
            .如果真结束
            
        .计次循环尾 ()
    .如果真结束
    
.判断 (等于 (., 2))
    赋值 (文件号, 打开文件 (#读入, ))
    .如果真 (不等于 (0))
        读入数据 (文件号, 临时文本)
        重定义数组 (假, 到数值 ())
        重定义数组 (假, 到数值 ())
        读入数据 (文件号, 项目, 尺寸, 表格设置)
        关闭文件 ()
    .如果真结束
    重定义数组 (数值, 假, 取数组成员数 ())
    清空 ()
    清空 ()
    .计次循环首 (取字段数 (), )
        赋值 (名称, 取字段名 (容器1))
        .计次循环首 (取数组成员数 (项目), 容器2)
            .如果真 (等于 (名称, 项目 [容器2]))
                赋值 (数值 [容器2], 容器1)
                赋值 (打印, 真)
                跳出循环 ()
            .如果真结束
            
        .计次循环尾 ()
        .如果真 (等于 (打印, 假))
            取字段名 (容器1).加入项目 (容器1)
        .如果真结束
        赋值 (打印, 假)
    .计次循环尾 ()
    .计次循环首 (取数组成员数 (项目), 容器1)
        项目.加入项目 ( [容器1], 数值 [容器1])
    .计次循环尾 ()
    
.判断 (等于 (., 3))
    3.初始尺寸 (取数组成员数 (项目))
    .计次循环首 (取数组成员数 (), 容器1)
        3.置文本 (容器1, 项目 [容器1])
    .计次循环尾 ()
    1.合并 (1, 1, 取列数 ())
    2.合并 (1, 1, 取列数 ())
    赋值 (., 表格设置 [1])
    赋值 (., 表格设置 [3])
    赋值 (., 到数值 (表格设置 [2]))
    赋值 (., 到数值 (表格设置 [4]))
    赋值 (., 表格设置 [5])
    1.置文本 (1, .)
    2.置文本 (1, .)
    3.置表头行数 ()
    1.置对齐方式 (1, 1, 1, 多项选择 (相加 (., 1), #中中, #中左, #中右))
    2.置对齐方式 (1, 1, 1, 多项选择 (相加 (., 1), #中中, #中左, #中右))
    3.置对齐方式 (1, 1, 取数组成员数 (项目), #中中)
    .计次循环首 (取数组成员数 (), 容器1)
        .如果真 (小于或等于 (容器1, 取列数 ()))
            容器1.置列宽 (1, 选择 (等于 (尺寸 [容器1], 0), 选择 (大于 (相乘 (取字段尺寸 (容器1), 36), 800), 800, 相乘 (取字段尺寸 (容器1), 36)), 尺寸 [容器1]))
        .如果真结束
        
    .计次循环尾 ()
    1.置字体属性 (1, 1, 1, #粗体)
    3.置字体属性 (1, 1, 取列数 (), #粗体)
    关闭 ()
    赋值 (., “printtool.tmp”)
    .添加 ()
    2.置字体尺寸 (1, 相减 (取行数 (), 1), 取列数 (), 选择 (大于 (取整 (相除 (相乘 (3.取行高 (), 2), 3)), 50), 50, 取整 (相除 (相乘 (3.取行高 (), 2), 3))))
    1.置字体尺寸 (1, 1, 1, 相乘 (2.取字体尺寸 (1), 2))
    3.加线条 (1, 相减 (取行数 (), 2), 取列数 (), 相加 (#左边框, #右边框, #上边框, #下边框, #水平线, #垂直线))
    2.置行高 (相减 (取行数 (), 1), 到数值 (.))
    1.置行高 (1, 相乘 (3.取行高 (), 2))
.默认
    
.判断结束


.子程序 __启动窗口_将被销毁, 空白型, , 
全部关闭 ()
删除文件 (“printtool.tmp”)
删除文件 (“printtool.edt”)

以下为子夹一中的操作

.子程序 _浏览按钮_被单击, 空白型, , 
.如果真 (打开 ())
    全部关闭 ()
    赋值 (., .)
    赋值 (., 真)
    .如果 (打开 (., “print”, , , , , ))
        清除数组 (项目)
        清除数组 (尺寸)
        重定义数组 (表格设置, 假, 5)
        赋值 (表格设置 [1], “易数据库打印表格”)
        赋值 (表格设置 [2], “0”)
        赋值 (表格设置 [3], 相加 (“打印日期：”, 时间到文本 (取现行时间 (), #日期部分)))
        赋值 (表格设置 [4], “1”)
        赋值 (表格设置 [5], “55”)
        赋值 (相加 (取文本左边 (., 相减 (倒找文本 (., “.”, , 假), 1)), “.ept”))
        .如果真 (等于 (.))
            赋值 (相加 (取文本左边 (., 相减 (倒找文本 (., “.”, , 假), 1)), “.epd”))
        .如果真结束
        赋值 (., “”)
        赋值 (., 假)
    .否则
        信息框 (相加 (“打开数据库”, #左引号, ., #右引号, “失败！”), #错误图标, )
    .如果结束
    赋值 (选择, 真)
.如果真结束

以下为子夹二中的操作

.子程序 _选择框1_被单击, 空白型, , 
.局部变量 事件选择框, 选择框, , , 
.局部变量 索引, 整数型, , , 
.局部变量 容器1, 整数型, , , 

赋值 (事件选择框, 取事件组件 ())
赋值 (索引, 到数值 (事件选择框.))
.如果 (等于 (事件选择框., 真))
    重定义数组 (选择框, 真, 相加 (索引, 1))
    重定义数组 (项目组合框, 真, 相加 (索引, 1))
    重定义数组 (条件组合框, 真, 相加 (索引, 1))
    重定义数组 (首编辑框, 真, 相加 (索引, 1))
    重定义数组 (尾编辑框, 真, 相加 (索引, 1))
    重定义数组 (首日期框, 真, 相加 (索引, 1))
    重定义数组 (尾日期框, 真, 相加 (索引, 1))
    重定义数组 (到标签, 真, 相加 (索引, 1))
    重定义数组 (真假组合框, 真, 相加 (索引, 1))
    复制窗口组件 (选择框 [相加 (索引, 1)])
    复制窗口组件 (项目组合框 [相加 (索引, 1)])
    .计次循环首 (取字段数 (), )
        .如果真 (不等于 (取字段类型 (), #字节集型))
            项目组合框.加入项目 ( [相加 (索引, 1)], 取字段名 (容器1), 容器1)
        .如果真结束
        
    .计次循环尾 ()
    复制窗口组件 (条件组合框 [相加 (索引, 1)])
    复制窗口组件 (首编辑框 [相加 (索引, 1)])
    复制窗口组件 (尾编辑框 [相加 (索引, 1)])
    复制窗口组件 (首日期框 [相加 (索引, 1)])
    复制窗口组件 (尾日期框 [相加 (索引, 1)])
    复制窗口组件 (到标签 [相加 (索引, 1)])
    复制窗口组件 (真假组合框 [相加 (索引, 1)])
    连续赋值 (到文本 (相加 (索引, 1)), 选择框 [相加 (索引, 1)]., 项目组合框 [相加 (索引, 1)]., 条件组合框 [相加 (索引, 1)]., 首编辑框 [相加 (索引, 1)]., 尾编辑框 [相加 (索引, 1)]., 首日期框 [相加 (索引, 1)]., 尾日期框 [相加 (索引, 1)]., 到标签 [相加 (索引, 1)]., 真假组合框 [相加 (索引, 1)].)
    连续赋值 (真, 选择框 [相加 (索引, 1)]., 项目组合框 [相加 (索引, 1)]., 条件组合框 [相加 (索引, 1)].)
    选择框.移动 ( [相加 (索引, 1)], 选择框 [索引], , 相加 (选择框 [索引], , 30), , )
    项目组合框.移动 ( [相加 (索引, 1)], 项目组合框 [索引], , 相加 (项目组合框 [索引], , 30), , )
    条件组合框.移动 ( [相加 (索引, 1)], 条件组合框 [索引], , 相加 (条件组合框 [索引], , 30), , )
    首编辑框.移动 ( [相加 (索引, 1)], 首编辑框 [索引], , 相加 (首编辑框 [索引], , 30), , )
    尾编辑框.移动 ( [相加 (索引, 1)], 尾编辑框 [索引], , 相加 (尾编辑框 [索引], , 30), , )
    首日期框.移动 ( [相加 (索引, 1)], 首日期框 [索引], , 相加 (首日期框 [索引], , 30), , )
    尾日期框.移动 ( [相加 (索引, 1)], 尾日期框 [索引], , 相加 (尾日期框 [索引], , 30), , )
    到标签.移动 ( [相加 (索引, 1)], 到标签 [索引], , 相加 (到标签 [索引], , 30), , )
    真假组合框.移动 ( [相加 (索引, 1)], 真假组合框 [索引], , 相加 (真假组合框 [索引], , 30), , )
    .如果真 (大于 (相加 (选择框 [相加 (索引, 1)]., 30), .))
        赋值 (., 相加 (选择框 [相加 (索引, 1)]., 35))
        赋值 (., 相减 (., .))
        赋值 (., .)
        .移动 (相减 (., .), , )
        赋值 (., 假)
    .如果真结束
    .如果真 (大于 (索引, 1))
        赋值 (选择框 [相减 (索引, 1)]., 真)
    .如果真结束
    连续赋值 (假, 项目组合框 [索引], , 条件组合框 [索引], , 首编辑框 [索引], , 尾编辑框 [索引], , 首日期框 [索引], , 尾日期框 [索引], , 真假组合框 [索引], )
    连续赋值 (真, 项目组合框 [相加 (索引, 1)]., 条件组合框 [相加 (索引, 1)]., 首编辑框 [相加 (索引, 1)]., 尾编辑框 [相加 (索引, 1)]., 首日期框 [相加 (索引, 1)]., 尾日期框 [相加 (索引, 1)]., 真假组合框 [相加 (索引, 1)].)
.否则
    连续赋值 (真, 项目组合框 [索引], , 条件组合框 [索引], , 首编辑框 [索引], , 尾编辑框 [索引], , 首日期框 [索引], , 尾日期框 [索引], , 真假组合框 [索引], )
    选择框.销毁 ( [相加 (索引, 1)])
    项目组合框.销毁 ( [相加 (索引, 1)])
    条件组合框.销毁 ( [相加 (索引, 1)])
    首编辑框.销毁 ( [相加 (索引, 1)])
    尾编辑框.销毁 ( [相加 (索引, 1)])
    首日期框.销毁 ( [相加 (索引, 1)])
    尾日期框.销毁 ( [相加 (索引, 1)])
    到标签.销毁 ( [相加 (索引, 1)])
    真假组合框.销毁 ( [相加 (索引, 1)])
    .如果真 (大于 (索引, 1))
        赋值 (选择框 [相减 (索引, 1)]., 假)
    .如果真结束
    .如果 (大于 (选择框 [索引], , .))
        赋值 (., 相加 (选择框 [索引], , 35))
        赋值 (., 相减 (., .))
        赋值 (., .)
        .移动 (相减 (., .), , )
        赋值 (., 假)
    .否则
        赋值 (., 真)
    .如果结束
    重定义数组 (选择框, 真, 索引)
    重定义数组 (项目组合框, 真, 索引)
    重定义数组 (条件组合框, 真, 索引)
    重定义数组 (首编辑框, 真, 索引)
    重定义数组 (尾编辑框, 真, 索引)
    重定义数组 (首日期框, 真, 索引)
    重定义数组 (尾日期框, 真, 索引)
    重定义数组 (到标签, 真, 索引)
    重定义数组 (真假组合框, 真, 索引)
.如果结束


.子程序 _项目组合框1_列表项被选择, 空白型, , 
.局部变量 事件组合框, 组合框, , , 
.局部变量 索引, 整数型, , , 

赋值 (事件组合框, 取事件组件 ())
赋值 (索引, 到数值 (事件组合框.))
条件组合框.清空 ( [索引])
连续赋值 (假, 首编辑框 [索引], , 尾编辑框 [索引], , 首日期框 [索引], , 尾日期框 [索引], , 到标签 [索引], , 真假组合框 [索引], )
首编辑框.移动 ( [索引], , , 128, )
首日期框.移动 ( [索引], , , 128, )
.判断开始 (或者 (等于 (取字段类型 (事件组合框.取项目文本 (事件组合框.)), #字节型), 等于 (取字段类型 (事件组合框.取项目文本 (事件组合框.)), #短整数型), 等于 (取字段类型 (事件组合框.取项目文本 (事件组合框.)), #整数型), 等于 (取字段类型 (事件组合框.取项目文本 (事件组合框.)), #长整数型), 等于 (取字段类型 (事件组合框.取项目文本 (事件组合框.)), #小数型), 等于 (取字段类型 (事件组合框.取项目文本 (事件组合框.)), #双精度小数型)))
    条件组合框.加入项目 ( [索引], “大于……”, )
    条件组合框.加入项目 ( [索引], “大于等于”, )
    条件组合框.加入项目 ( [索引], “等于……”, )
    条件组合框.加入项目 ( [索引], “小于……”, )
    条件组合框.加入项目 ( [索引], “小于等于”, )
    条件组合框.加入项目 ( [索引], “介于……”, )
    赋值 (条件组合框 [索引], , 0)
    赋值 (首编辑框 [索引], , 真)
    首编辑框.移动 ( [索引], , , 288, )
.判断 (或者 (等于 (取字段类型 (事件组合框.取项目文本 (事件组合框.)), #文本型), 等于 (取字段类型 (事件组合框.取项目文本 (事件组合框.)), #备注型)))
    条件组合框.加入项目 ( [索引], “全等于”, )
    条件组合框.加入项目 ( [索引], “左等于”, )
    条件组合框.加入项目 ( [索引], “包含…”, )
    赋值 (条件组合框 [索引], , 0)
    赋值 (首编辑框 [索引], , 真)
    首编辑框.移动 ( [索引], , , 288, )
.判断 (等于 (取字段类型 (事件组合框.取项目文本 (事件组合框.)), #日期时间型))
    条件组合框.加入项目 ( [索引], “大于……”, )
    条件组合框.加入项目 ( [索引], “大于等于”, )
    条件组合框.加入项目 ( [索引], “等于……”, )
    条件组合框.加入项目 ( [索引], “小于……”, )
    条件组合框.加入项目 ( [索引], “小于等于”, )
    条件组合框.加入项目 ( [索引], “介于……”, )
    赋值 (条件组合框 [索引], , 0)
    赋值 (首日期框 [索引], , 真)
    首日期框.移动 ( [索引], , , 288, )
.判断 (等于 (取字段类型 (事件组合框.取项目文本 (事件组合框.)), #逻辑型))
    条件组合框.加入项目 ( [索引], “等于”, )
    赋值 (条件组合框 [索引], , 0)
    赋值 (真假组合框 [索引], , 真)
.默认
    
.判断结束


.子程序 _条件组合框1_列表项被选择, 空白型, , 
.局部变量 事件组合框, 组合框, , , 
.局部变量 索引, 整数型, , , 

赋值 (事件组合框, 取事件组件 ())
赋值 (索引, 到数值 (事件组合框.))
连续赋值 (假, 首编辑框 [索引], , 尾编辑框 [索引], , 首日期框 [索引], , 尾日期框 [索引], , 到标签 [索引], , 真假组合框 [索引], )
首编辑框.移动 ( [索引], , , 128, )
首日期框.移动 ( [索引], , , 128, )
.判断开始 (等于 (取字段类型 (项目组合框.取项目文本 ( [索引], 项目组合框 [索引], )), #日期时间型))
    .如果 (等于 (事件组合框.取项目文本 (事件组合框.), “介于……”))
        连续赋值 (真, 首日期框 [索引], , 到标签 [索引], , 尾日期框 [索引], )
    .否则
        赋值 (首日期框 [索引], , 真)
        首日期框.移动 ( [索引], , , 288, )
    .如果结束
    
.判断 (等于 (取字段类型 (项目组合框.取项目文本 ( [索引], 项目组合框 [索引], )), #逻辑型))
    赋值 (真假组合框 [索引], , 真)
.默认
    .如果 (等于 (事件组合框.取项目文本 (事件组合框.), “介于……”))
        连续赋值 (真, 首编辑框 [索引], , 到标签 [索引], , 尾编辑框 [索引], )
    .否则
        赋值 (首编辑框 [索引], , 真)
        首编辑框.移动 ( [索引], , , 288, )
    .如果结束
    
.判断结束


.子程序 _纵向滚动条1_位置被改变, 空白型, , 
.移动 (负 (.), , )

以下为子夹三中的操作

.子程序 _列表框1_列表项被选择, 空白型, , 
连续赋值 (假, ., .)
连续赋值 (真, ., ., ., .)
赋值 (., -1)

.子程序 _列表框2_列表项被选择, 空白型, , 
连续赋值 (真, ., .)
连续赋值 (假, ., ., ., .)
.如果 (小于或等于 (取项目数 (), 1))
    连续赋值 (真, ., ., .)
.否则
    .判断开始 (等于 (., 0))
        赋值 (., 真)
    .判断 (等于 (., 相减 (取项目数 (), 1)))
        赋值 (., 真)
    .默认
        连续赋值 (假, ., .)
    .判断结束
    
.如果结束
赋值 (., -1)

.子程序 _选择按钮_被单击, 空白型, , 
.局部变量 内容, 文本型, , , 
.局部变量 索引, 整数型, , , 
.局部变量 当前项, 整数型, , , 

赋值 (当前项, .)
赋值 (内容, .取项目文本 (.))
赋值 (索引, .取项目数值 (.))
.删除项目 (.)
内容.加入项目 (索引)
.如果真 (等于 (取项目数 (), 0))
    连续赋值 (假, ., .)
.如果真结束
赋值 (., 选择 (大于或等于 (相减 (取项目数 (), 1), 当前项), 当前项, 相减 (取项目数 (), 1)))
_列表框1_列表项被选择 ()

.子程序 _全选按钮_被单击, 空白型, , 
.局部变量 容器1, 整数型, , , 

清空 ()
清空 ()
.计次循环首 (取字段数 (), )
    取字段名 (容器1).加入项目 (容器1)
.计次循环尾 ()
连续赋值 (真, ., ., ., ., ., .)

.子程序 _全删按钮_被单击, 空白型, , 
.局部变量 容器1, 整数型, , , 

清空 ()
清空 ()
.计次循环首 (取字段数 (), )
    取字段名 (容器1).加入项目 (容器1)
.计次循环尾 ()
连续赋值 (真, ., ., ., ., ., .)

.子程序 _删除按钮_被单击, 空白型, , 
.局部变量 内容, 文本型, , , 
.局部变量 索引, 整数型, , , 
.局部变量 容器1, 整数型, , , 
.局部变量 当前项, 整数型, , , 
.局部变量 插入, 逻辑型, , , 

赋值 (当前项, .)
赋值 (内容, .取项目文本 (.))
赋值 (索引, .取项目数值 (.))
.删除项目 (.)
.计次循环首 (取项目数 (), 容器1)
    .如果真 (大于 (相减 (容器1, 1).取项目数值 (), 索引))
        相减 (容器1, 1).插入项目 (内容, 索引)
        赋值 (插入, 真)
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
.如果真 (等于 (插入, 假))
    内容.加入项目 (索引)
.如果真结束
.如果真 (等于 (取项目数 (), 0))
    连续赋值 (真, ., ., ., .)
.如果真结束
赋值 (., 选择 (大于或等于 (相减 (取项目数 (), 1), 当前项), 当前项, 相减 (取项目数 (), 1)))
_列表框2_列表项被选择 ()

.子程序 _上调按钮_被单击, 空白型, , 
.局部变量 当前索引, 整数型, , , 
.局部变量 内容, 文本型, , , 
.局部变量 数值, 整数型, , , 

赋值 (当前索引, .)
赋值 (内容, 当前索引.取项目文本 ())
赋值 (数值, 当前索引.取项目数值 ())
当前索引.删除项目 ()
相减 (当前索引, 1).插入项目 (内容, 数值)
赋值 (., 相减 (当前索引, 1))
.如果真 (等于 (相减 (当前索引, 1), 0))
    赋值 (., 真)
.如果真结束
.如果真 (小于 (相减 (当前索引, 1), 取项目数 ()))
    赋值 (., 假)
.如果真结束


.子程序 _下调按钮_被单击, 空白型, , 
.局部变量 当前索引, 整数型, , , 
.局部变量 内容, 文本型, , , 
.局部变量 数值, 整数型, , , 

赋值 (当前索引, .)
赋值 (内容, 当前索引.取项目文本 ())
赋值 (数值, 当前索引.取项目数值 ())
当前索引.删除项目 ()
相加 (当前索引, 1).插入项目 (内容, 数值)
赋值 (., 相加 (当前索引, 1))
.如果真 (等于 (相加 (当前索引, 1), 相减 (取项目数 (), 1)))
    赋值 (., 真)
.如果真结束
.如果真 (大于 (相加 (当前索引, 1), 0))
    赋值 (., 假)
.如果真结束


.子程序 _保存按钮1_被单击, 空白型, , 
.局部变量 容器1, 整数型, , , 
.局部变量 文件号, 整数型, , , 

清除数组 ()
.计次循环首 (取项目数 (), 容器1)
    加入成员 (相减 (1).取项目文本 ())
.计次循环尾 ()
重定义数组 (尺寸, 真, 取数组成员数 (项目))
赋值 (文件号, 打开文件 (配置文件, #重写, ))
写出数据 (文件号, 到文本 (取数组成员数 (项目)), 项目, 尺寸, 表格设置)
关闭文件 (文件号)

以下为子夹三中的操作

.子程序 _编辑框2_内容被改变, 空白型, , 
1.置文本 (1, .)
刷新 ()

.子程序 _编辑框3_内容被改变, 空白型, , 
2.置文本 (1, .)
刷新 ()

.子程序 _编辑框3_获得焦点, 空白型, , 
赋值 (., -1)

.子程序 _编辑框2_获得焦点, 空白型, , 
赋值 (., -1)

.子程序 _组合框1_列表项被选择, 空白型, , 
1.置对齐方式 (1, 1, 1, 多项选择 (相加 (., 1), #中中, #中左, #中右))
刷新 ()

.子程序 _组合框2_列表项被选择, 空白型, , 
2.置对齐方式 (1, 1, 1, 多项选择 (相加 (., 1), #中中, #中左, #中右))
刷新 ()

.子程序 _编辑框4_内容被改变, 空白型, , 
2.置行高 (相减 (取行数 (), 2), 到数值 (.))
1.置行高 (1, 相乘 (3.取行高 (), 2))
2.置字体尺寸 (1, 相减 (取行数 (), 1), 取列数 (), 选择 (大于 (取整 (相除 (相乘 (3.取行高 (), 2), 3)), 50), 50, 取整 (相除 (相乘 (3.取行高 (), 2), 3))))
1.置字体尺寸 (1, 1, 1, 相乘 (2.取字体尺寸 (1), 2))
刷新显示 ()

.子程序 _保存按钮2_被单击, 空白型, , 
.局部变量 容器1, 整数型, , , 
.局部变量 文件号, 整数型, , , 

清除数组 ()
.计次循环首 (取列数 (), 容器1)
    加入成员 (容器1.取列宽 ())
.计次循环尾 ()
重定义数组 (假, 5)
赋值 ( [1], .)
赋值 ( [2], 到文本 (.))
赋值 ( [3], .)
赋值 ( [4], 到文本 (.))
赋值 ( [5], .)
赋值 (文件号, 打开文件 (配置文件, #重写, ))
写出数据 (文件号, 到文本 (取数组成员数 (尺寸)), 项目, 尺寸, )
关闭文件 ()


 ' 不属于任何一个程序集、类模块的函数：
