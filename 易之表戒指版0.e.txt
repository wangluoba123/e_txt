 ' 文件类型：Windows窗口程序

 ' 程序名称：易之表
 ' 程序描述：本例程演示了有关报表、数据处理框架方面的基本内容,您可以将她进一步开发以获得更强的功能。本程序也可以用作编排报表模板文件。
 ' 程序作者：吴涛
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 823
    高度 = 309
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “易之表”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 286
    高度 = 190
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于易之表”
    帮助文件名 = “”

窗口 表格属性窗口
    左边 = 50
    顶边 = 50
    宽度 = 364
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “表格属性”
    帮助文件名 = “”

窗口 颜色选择窗口
    左边 = 50
    顶边 = 50
    宽度 = 295
    高度 = 149
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “请选择颜色:”
    帮助文件名 = “”

窗口 新建设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 167
    高度 = 182
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “新建设置”
    帮助文件名 = “”



.图片 bar1, " ' 已保存到：D:\易语言学习\Data\易之表戒指版0.e\bar1", , 
.常量 易之表, "“易之表”", , 
.常量 用户习惯, "“用户习惯”", , 
.常量 WM_DROPFILES, "563", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 2 系统核心支持库
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 1 扩展界面支持库一




数据类型 CHOOSECOLOR, , 
    .成员 lStructSize, 整数型, , , 36
    .成员 hwndOwner, 整数型, , , 
    .成员 hInstance, 整数型, , , 
    .成员 rgbResult, 整数型, , , 
    .成员 lpCustColors, 文本型, , , 
    .成员 flags, 整数型, , , 
    .成员 lCustData, 整数型, , , 
    .成员 lpfnHook, 整数型, , , 
    .成员 lpTemplateName, 文本型, , , 

.全局变量 颜色选择标题, 文本型, , , 
.全局变量 返回颜色有效, 逻辑型, , , 
.全局变量 返回颜色, 整数型, , , 
.全局变量 颜色判断, 逻辑型, , , 真为文本色，假为背景色

.DLL命令 设置窗口是否接受拖放, 逻辑型, "shell32.dll", "DragAcceptFiles", , 设置窗口是否接受拖放
    .参数 hWnd, 整数型, , 
    .参数 isAccept, 逻辑型, 传址, true:接收拖放

.DLL命令 结束拖放, 空白型, "shell32.dll", "DragFinish", , 结束拖放
    .参数 hDrop, 整数型, , hDrop取自WM_DROPFILES消息的wParam参数

.DLL命令 取被拖放文件名, 整数型, "shell32.dll", "DragQueryFileA", , 
    .参数 hDrop, 整数型, , hDrop取自WM_DROPFILES消息的wParam参数
    .参数 index_of_file, 整数型, , 如果为 -1,DragQueryFile返回已传送文件数
    .参数 buf, 文本型, , 
    .参数 size_of_buf, 整数型, 传址, 

.DLL命令 SetWindowLong, 整数型, "", "SetWindowLongA", , 
    .参数 hwnd, 整数型, , 
    .参数 nIndex, 整数型, , 
    .参数 dwNewLong, 子程序指针, , 

.DLL命令 CallWindowProc, 整数型, "", "CallWindowProcA", , 
    .参数 lpPrevWndFunc, 整数型, , 
    .参数 hwnd, 整数型, , 
    .参数 wmsg, 整数型, , 
    .参数 wparam, 整数型, , 
    .参数 lparam, 整数型, , 

.DLL命令 外部_获得程序句柄, 整数型, "", "GetModuleHandleA", , 
    .参数 模块名, 整数型, , 

.DLL命令 ChooseColor, 整数型, "comdlg32.dll", "ChooseColorA", , 
    .参数 pChoosecolor, CHOOSECOLOR, , 

.窗口程序集 启动窗口窗口程序集, , , 

.程序集变量 现行文件名, 文本型, , , 
.程序集变量 是否被修改, 逻辑型, , , 
.程序集变量 proc, 子程序指针, , , 
.程序集变量 oldhwndproc, 整数型, , , 
.程序集变量 拖放文件名称, 文本型, , , 
.程序集变量 拖放文件个数, 整数型, , , 
.程序集变量 i, 整数型, , , 
.程序集变量 临时目录, 文本型, , , 
.程序集变量 撤消重复数量, 整数型, , , 
.程序集变量 撤消重复位置, 整数型, , , 
.程序集变量 撤消重复数据, 字节集, , , 
.程序集变量 货币符号, 字节型, , "0", 5
.程序集变量 组合框以前内容, 文本型, , , 
.程序集变量 组合框以前行列号数, 整数型, , "4", 
.子程序 __启动窗口_尺寸被改变, 空白型, , 
5.移动 (相加 (29, 28, 26), 相减 (取用户区宽度 (), 10), 相减 (取用户区高度 (), 10, ., 24, 28, 26))
赋值 (.宽度, 相减 (取用户区宽度 (), 134))
相减 (取栏目数 (), 1).置宽度 (65)
相减 (取栏目数 (), 2).置宽度 (90)
相减 (取栏目数 (), 3).置宽度 (90)
相减 (取栏目数 (), 4).置宽度 (105)
相减 (取栏目数 (), 5).置宽度 (105)
相减 (取栏目数 (), 6).置宽度 (100)
相减 (取栏目数 (), 7).置宽度 (100)

0.置宽度 (相减 (取用户区宽度 (), 65, 180, 210, 100, 100))
.如果真 (小于 (取用户区宽度 (), 相加 (65, 180, 210)))
    0.置宽度 (1)
.如果真结束


.子程序 _新建_被选择, 空白型, , 
.局部变量 a, 文本型, , , 
.局部变量 字体尺寸, 整数型, , , 

.如果真 (等于 (询问保存文档 (), 假))
    载入 (新建设置窗口, , 真)
    .如果真 (等于 (新建设置窗口., 真))
        新建设置窗口.初始尺寸 (., 新建设置窗口.)
        赋值 (是否被修改, 假)
        赋值 (现行文件名, “”)
        修改判断 ()
        赋值 (字体尺寸, 相除 (相乘 (18, 10), 72, 0.0394)) ' 由于字体对话框返回的字体尺寸是以1/72英寸为单位,现将其转换为0.1MM.
        取光标行号 ().置字体尺寸 (取光标列号 (), 取行数 (), 取列数 (), 字体尺寸)
        取光标行号 ().置行高 (取行数 (), 90)
        
        _表格1_选择行列数改变 ()
        赋值 (撤消重复数量, 1)
        赋值 (撤消重复位置, 1)
        撤消重复数据 ＝ 数据源1.存到字节集 ()
        相加 (临时目录, 到文本 (撤消重复数量), “.tmp”).存到文件 ()
        赋值 (.禁止, 假)
        赋值 (.禁止, 真)
        10.去除状态 (#禁止)
        11.加入状态 (#禁止)
    .如果真结束
    
.如果真结束


.子程序 _打开1_被选择, 空白型, , 
_打开_被选择 ()

.子程序 _打开_被选择, 空白型, , 
.局部变量 文件号, 整数型, , , 
.局部变量 字体尺寸, 整数型, , , 

.如果真 (等于 (询问保存文档 (), 假))
    赋值 (.标题, “请输入欲打开的表格文件名：”)
    赋值 (.类型, 0)
    .如果真 (等于 (打开 (), 真))
        打开并读入文件 (.文件名)
        _表格1_选择行列数改变 ()
        赋值 (撤消重复数量, 1)
        赋值 (撤消重复位置, 1)
        赋值 (撤消重复数据, 存到字节集 ())
        相加 (临时目录, 到文本 (撤消重复数量), “.tmp”).存到文件 ()
        赋值 (字体尺寸, 相除 (相乘 (18, 10), 72, 0.0394)) ' 由于字体对话框返回的字体尺寸是以1/72英寸为单位,现将其转换为0.1MM.
        取光标行号 ().置字体尺寸 (取光标列号 (), 取行数 (), 取列数 (), 字体尺寸)
        取光标行号 ().置行高 (取行数 (), 90)
    .如果真结束
    
.如果真结束


.子程序 打开并读入文件, 空白型, , 
.参数 文件名, 文本型, , 

.如果 (等于 (文件名.从文件读 (), 假))
    信息框 (“打开文件失败！”, #错误图标, “错误”)
.否则
    赋值 (是否被修改, 假)
    赋值 (现行文件名, 文件名)
    赋值 (.标题, 相加 (“易之表 - ”, 现行文件名))
    修改判断 ()
.如果结束


.子程序 _保存_被选择, 空白型, , 
保存文档 ()

.子程序 _另存为_被选择, 空白型, , 
赋值 (.标题, “请输入欲另存到的表格文件名：”)
赋值 (.类型, 1)
.如果真 (等于 (打开 (), 真))
    保存文档 (.文件名)
.如果真结束


.子程序 _打印_被选择, 空白型, , 
.如果真 (打印设置 ())
    设置修改 ()
    .打印 ()
.如果真结束


.子程序 _退出_被选择, 空白型, , 
.如果真 (等于 (询问保存文档 (), 假))
    销毁 () ' 通过销毁主窗口退出程序
.如果真结束


.子程序 _剪切_被选择, 空白型, , 
设置修改 ()
取光标行号 ().复制 (取光标列号 (), 取选择行数 (), 取选择列数 ())
取光标行号 ().清除 (取光标列号 (), 取选择行数 (), 取选择列数 ())

.子程序 _复制_被选择, 空白型, , 
取光标行号 ().复制 (取光标列号 (), 取选择行数 (), 取选择列数 ())

.子程序 _粘贴_被选择, 空白型, , 
设置修改 ()
粘贴到光标处 ()

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
返回 (取反 (询问保存文档 ()))

.子程序 询问保存文档, 逻辑型, , 返回真表示用户选择了中止
.局部变量 询问返回, 整数型, , , 

.如果真 (等于 (是否被修改, 真))
    赋值 (询问返回, 信息框 (“文件已经被修改，是否保存？”, 相加 (#取消是否钮, #询问图标), “询问”))
    .如果真 (等于 (询问返回, #取消钮))
        返回 (真)
    .如果真结束
    .如果真 (等于 (询问返回, #是钮))
        .如果真 (等于 (保存文档 (), 真))
            返回 (真)
        .如果真结束
        
    .如果真结束
    
.如果真结束
返回 (假)

.子程序 保存文档, 逻辑型, , 返回真表示用户选择了中止
.参数 文件名, 文本型, 可空, 

.局部变量 保存文件名, 文本型, , , 
.局部变量 文件号, 整数型, , , 

赋值 (保存文件名, 选择 (是否为空 (文件名), 现行文件名, 文件名))
.如果真 (等于 (保存文件名, “”))
    赋值 (.标题, “请输入欲保存到的表格文件名：”)
    赋值 (.类型, 1)
    .如果真 (等于 (打开 (), 假))
        修改判断 ()
        返回 (真)
    .如果真结束
    赋值 (保存文件名, .文件名)
.如果真结束
赋值 (是否被修改, 假)
.如果 (等于 (保存文件名.存到文件 (), 假))
    信息框 (“保存文件失败！”, #错误图标, “错误”)
.否则
    赋值 (现行文件名, 保存文件名)
.如果结束
修改判断 ()
返回 (假)

.子程序 _打印设置_被选择, 空白型, , 
.如果真 (打印设置 ())
    设置修改 ()
.如果真结束


.子程序 _打印预览_被选择, 空白型, , 
打印预览 ()

.子程序 _清空_被选择, 空白型, , 
设置修改 ()
取光标行号 ().清除 (取光标列号 (), 取选择行数 (), 取选择列数 ())

.子程序 _组合_被选择, 空白型, , 
设置修改 ()
取光标行号 ().合并 (取光标列号 (), 取选择行数 (), 取选择列数 ())

.子程序 _分解_被选择, 空白型, , 
设置修改 ()
取光标行号 ().分解 (取光标列号 ())

.子程序 _插入行_被选择, 空白型, , 
设置修改 ()
.如果 (不等于 (.数据提供者, “数据库提供者1”))
    取光标行号 ().插入行 ()
.否则
    相加 (取行数 (), 1).插入行 ()
    取行数 ().置光标 (1)
.如果结束


.子程序 _插入列_被选择, 空白型, , 
设置修改 ()
取光标列号 ().插入列 ()

.子程序 _删除行_被选择, 空白型, , 
设置修改 ()
取光标行号 ().删除行 (取选择行数 ())

.子程序 _删除列_被选择, 空白型, , 
设置修改 ()
取光标列号 ().删除列 (取选择列数 ())

.子程序 _比例50_被选择, 空白型, , 
赋值 (.缩放比, 50)

.子程序 _比例100_被选择, 空白型, , 
赋值 (.缩放比, 100)

.子程序 _比例200_被选择, 空白型, , 
赋值 (.缩放比, 200)

.子程序 _等宽_被选择, 空白型, , 
等宽缩放 ()

.子程序 _关于易之表_被选择, 空白型, , 
载入 (关于窗口, , 真)

.子程序 _打开数据库1_被选择, 空白型, , 
_打开数据库_被选择 ()

.子程序 _打开数据库_被选择, 空白型, , 此功能用作演示合并多个数据提供者数据的方法
.如果真 (并且 (等于 (询问保存文档 (), 假), 等于 (打开 (), 真), 不等于 (.文件名, “”)))
    打开数据库 (.文件名)
    _表格1_选择行列数改变 ()
    赋值 (撤消重复数量, 1)
    赋值 (撤消重复位置, 1)
    撤消重复数据 ＝ 数据源1.存到字节集 ()
    相加 (临时目录, 到文本 (撤消重复数量), “.tmp”).存到文件 ()
.如果真结束


.子程序 打开数据库, 空白型, , 
.参数 欲打开数据库文件, 文本型, , 

.局部变量 字段数, 整数型, , , 
.局部变量 字段索引, 整数型, , , 
.局部变量 字段名称, 文本型, , "0", 
.局部变量 重试次数, 整数型, , , 
.局部变量 数据库密码, 文本型, , , 

.如果 (是否已加密 (欲打开数据库文件))
    .计次循环首 (3, 重试次数)
        .如果真 (等于 (密码输入框 (数据库密码, 相减 (重试次数, 1)), 假))
            返回 ()
        .如果真结束
        .如果真 (打开 (欲打开数据库文件, , , , , 数据库密码, ))
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
    
.否则
    打开 (欲打开数据库文件, , , , , , )
.如果结束

.如果真 (是否已打开 (欲打开数据库文件))
    置等待鼠标 ()
    
    赋值 (字段数, 取字段数 ())
    .计次循环首 (字段数, 字段索引)
        .如果真 (不等于 (取字段类型 (字段索引), #字节集型))
            加入成员 (字段名称, 取字段名 (字段索引))
        .如果真结束
        
    .计次循环尾 ()
    关闭 ()
    
    赋值 (字段数, 取数组成员数 (字段名称))
    1.初始尺寸 (字段数)
    .计次循环首 (字段数, 字段索引)
        1.置文本 (字段索引, 字段名称 [字段索引])
    .计次循环尾 ()
    1.置字体属性 (1, , 字段数, #粗体)
    1.置表头行数 ()
    赋值 (.数据库文件名, 欲打开数据库文件)
    赋值 (.数据库密码, 数据库密码)
    .添加 ()
    赋值 (是否被修改, 假)
    赋值 (现行文件名, “”)
    修改判断 ()
    赋值 (.标题, 相加 (“易之表 - ”, 欲打开数据库文件))
    恢复鼠标 ()
.如果真结束


.子程序 _表格1_内容被改变, 空白型, , 
.参数 行号, 整数型, , 
.参数 列号, 整数型, , 
.参数 行数, 整数型, , 
.参数 列数, 整数型, , 

.如果真 (或者 (等于 (行号.取类型 (列号), #文本), 等于 (行号.取类型 (列号), #图片文件名)))
    赋值 (.内容, 行号.取文本 (列号))
.如果真结束

设置修改 ()

.子程序 _修改数据库_被选择, 空白型, , 此功能用作演示数据提供者属性用法
.如果真 (并且 (等于 (询问保存文档 (), 假), 等于 (打开 (), 真), 不等于 (.文件名, “”)))
    赋值 (.数据库文件名, .文件名)
    赋值 (.数据库密码, “?”)
    赋值 (.数据提供者, “数据库提供者1”) ' 请注意使用数据库提供者与使用通用提供者的不同.如不能改变表格行高等.这是由提供者的数据存储能力决定的.
.如果真结束


.子程序 _退出数据库修改_被选择, 空白型, , 
赋值 (.数据提供者, “通用提供者1”)

.子程序 _表格1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.禁止, 选择 (等于 (.数据提供者, “数据库提供者1”), 真, 假))
赋值 (.禁止, 选择 (等于 (.数据提供者, “数据库提供者1”), 真, 假))
弹出菜单 ()

.子程序 _置行高_被选择, 空白型, , 
.局部变量 行高, 整数型, , , 

.如果真 (并且 (输入框 (“请输入新行高（单位0.1毫米）”, “新行高”, , 行高, #输入整数), 大于 (行高, 0)))
    取光标行号 ().置行高 (取选择行数 (), 行高)
    设置修改 ()
.如果真结束


.子程序 _置列宽_被选择, 空白型, , 
.局部变量 列宽, 整数型, , , 

.如果真 (并且 (输入框 (“请输入新列宽（单位0.1毫米）”, “新列宽”, , 列宽, #输入整数), 大于 (列宽, 0)))
    取光标列号 ().置列宽 (取选择列数 (), 列宽)
    设置修改 ()
.如果真结束


.子程序 _表格属性_被选择, 空白型, , 
载入 (表格属性窗口, , 真)

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 参数文本, 文本型, , "0", 感谢"西风"朋友提供此段代码.
.局部变量 a, 整数型, , , 
.局部变量 临时参数文本, 文本型, , , 
.局部变量 字体尺寸, 整数型, , , 

赋值 (临时目录, 未知支持库函数_7 (#))
.如果真 (不等于 (取文本右边 (临时目录, 1), “\”))
    赋值 (临时目录, 相加 (临时目录, “\”))
.如果真结束
赋值 (临时目录, 取临时文件名 (临时目录))
创建目录 (临时目录)
赋值 (临时目录, 相加 (临时目录, “\”))
赋值 (撤消重复数量, 1)
赋值 (撤消重复位置, 1)
撤消重复数据 ＝ 数据源1.存到字节集 ()
写到文件 (临时目录 ＋ 到文本 (撤消重复数量) ＋ “.tmp”, 撤消重复数据)
gjt1.
赋值 (.表格线颜色, 取数值注册表项 (#易之表, #用户习惯, “表格线颜色”, #黑色))
赋值 (.背景颜色, 取数值注册表项 (#易之表, #用户习惯, “表景颜色”, #白色))
赋值 (.允许选择块, 不等于 (取数值注册表项 (#易之表, #用户习惯, “允许选择块”, 1), 0))
赋值 (.显示标尺, 不等于 (取数值注册表项 (#易之表, #用户习惯, “显示标尺”, 1), 0))
赋值 (.显示空表格线, 不等于 (取数值注册表项 (#易之表, #用户习惯, “显示空表格线”, 1), 0))
赋值 (.禁止调整行高, 不等于 (取数值注册表项 (#易之表, #用户习惯, “禁止调整行高”, 0), 0))
赋值 (.禁止调整列宽, 不等于 (取数值注册表项 (#易之表, #用户习惯, “禁止调整列宽”, 0), 0))
赋值 (.允许粘贴扩展, 不等于 (取数值注册表项 (#易之表, #用户习惯, “允许粘贴扩展”, 1), 0))

赋值 (字体尺寸, 相除 (相乘 (18, 10), 72, 0.0394)) ' 由于字体对话框返回的字体尺寸是以1/72英寸为单位,现将其转换为0.1MM.
取光标行号 ().置字体尺寸 (取光标列号 (), 取行数 (), 取列数 (), 字体尺寸)
取光标行号 ().置行高 (取行数 (), 90)

关联数据库 ()
取命令行 (参数文本)
.如果真 (大于 (取数组成员数 (参数文本), 0))
    .计次循环首 (取数组成员数 (参数文本), a)
        赋值 (临时参数文本, 相加 (临时参数文本, 参数文本 [a], “ ”))
    .计次循环尾 ()
    赋值 (临时参数文本, 删尾空 (临时参数文本))
    .如果真 (文件是否存在 (临时参数文本))
        .判断开始 (等于 (取文本右边 (临时参数文本, 4), “.grd”))
            打开并读入文件 (临时参数文本)
        .判断 (等于 (取文本右边 (临时参数文本, 4), “.edb”))
            数据库提供者1.数据库文件名 ＝ 临时参数文本
            数据源1.数据提供者 ＝ “数据库提供者1” ' 请注意使用数据库提供者与使用通用提供者的不同.如不能改变表格行高等.这是由提供者的数据存储能力决定的.
            打开数据库 (临时参数文本)
        .默认
            
        .判断结束
        
    .如果真结束
    
.如果真结束
赋值 (proc, &winproc)
赋值 (oldhwndproc, SetWindowLong (取窗口句柄 (), -4, proc))
设置窗口是否接受拖放 (取窗口句柄 (), 真)
1.置背景色 (1, 取行数 (), 取列数 (), #白色)
相加 (临时目录, 到文本 (撤消重复数量), “.tmp”).存到文件 ()
_表格1_选择行列数改变 ()
获取组合框内容 ()

.子程序 __启动窗口_将被销毁, 空白型, , 
写注册表项 (#易之表, #用户习惯, “表格线颜色”, .表格线颜色)
写注册表项 (#易之表, #用户习惯, “背景颜色”, .背景颜色)
写注册表项 (#易之表, #用户习惯, “允许选择块”, 选择 (.允许选择块, 1, 0))
写注册表项 (#易之表, #用户习惯, “显示标尺”, 选择 (.显示标尺, 1, 0))
写注册表项 (#易之表, #用户习惯, “显示空表格线”, 选择 (.显示空表格线, 1, 0))
写注册表项 (#易之表, #用户习惯, “禁止调整行高”, 选择 (.禁止调整行高, 1, 0))
写注册表项 (#易之表, #用户习惯, “禁止调整列宽”, 选择 (.禁止调整列宽, 1, 0))
写注册表项 (#易之表, #用户习惯, “允许粘贴扩展”, 选择 (.允许粘贴扩展, 1, 0))
删除目录 (临时目录)

.子程序 _添加数据_被选择, 空白型, , 
赋值 (.标题, “请输入欲添加进来的表格文件名：”)
赋值 (.类型, 0)
.如果真 (等于 (打开 (), 真))
    .如果 (等于 (.从文件读 (.文件名), 假)) ' 数据源2仅在此处使用
        信息框 (“打开欲添加文件失败！”, #错误图标, “错误”)
    .否则
        .添加 ()
        设置修改 ()
        1.初始尺寸 (1) ' 因为使用的是通用提供者2,所以可以初始化尺寸.在此处清除通用提供者2内的数据.
    .如果结束
    
.如果真结束


.子程序 _文本型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置类型 (取光标列号 (), 取选择行数 (), 取选择列数 (), #文本型)
相减 (取栏目数 (), 6).置文本 (多项选择 (取光标行号 ().取类型 (取光标列号 ()), “文本型”, “图片文件名型”, “图片数据型”, “字节集数据型”))

.子程序 _图片文件名型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置类型 (取光标列号 (), 取选择行数 (), 取选择列数 (), #图片文件名)
相减 (取栏目数 (), 6).置文本 (多项选择 (取光标行号 ().取类型 (取光标列号 ()), “文本型”, “图片文件名型”, “图片数据型”, “字节集数据型”))

.子程序 _图片数据型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置类型 (取光标列号 (), 取选择行数 (), 取选择列数 (), #图片数据)
相减 (取栏目数 (), 6).置文本 (多项选择 (取光标行号 ().取类型 (取光标列号 ()), “文本型”, “图片文件名型”, “图片数据型”, “字节集数据型”))

.子程序 _字节集数据型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置类型 (取光标列号 (), 取选择行数 (), 取选择列数 (), #字节集数据)
相减 (取栏目数 (), 6).置文本 (多项选择 (取光标行号 ().取类型 (取光标列号 ()), “文本型”, “图片文件名型”, “图片数据型”, “字节集数据型”))

.子程序 _文本颜色_被选择, 空白型, , 
赋值 (颜色判断, 真)
赋值 (颜色选择标题, “请选择文本颜色:”)
载入 (颜色选择窗口, , 真)
.如果真 (等于 (返回颜色有效, 真))
    设置修改 ()
    取光标行号 ().置文本色 (取光标列号 (), 取选择行数 (), 取选择列数 (), 返回颜色)
.如果真结束


.子程序 _背景颜色_被选择, 空白型, , 
赋值 (颜色判断, 假)
赋值 (颜色选择标题, “请选择背景颜色:”)
载入 (颜色选择窗口, , 真)
.如果真 (等于 (返回颜色有效, 真))
    设置修改 ()
    取光标行号 ().置背景色 (取光标列号 (), 取选择行数 (), 取选择列数 (), 返回颜色)
.如果真结束


.子程序 _字体_被选择, 空白型, , 
.局部变量 字体属性, 整数型, , , 
.局部变量 字体尺寸, 双精度小数型, , , 

.如果真 (等于 (打开 (), 真))
    .如果真 (等于 (.加粗, 真))
        赋值 (字体属性, 相加 (字体属性, #粗体))
    .如果真结束
    .如果真 (等于 (.倾斜, 真))
        赋值 (字体属性, 相加 (字体属性, #斜体))
    .如果真结束
    .如果真 (等于 (.删除线, 真))
        赋值 (字体属性, 相加 (字体属性, #删除线))
    .如果真结束
    .如果真 (等于 (.下划线, 真))
        赋值 (字体属性, 相加 (字体属性, #下划线))
    .如果真结束
    取光标行号 ().置字体属性 (取光标列号 (), 取选择行数 (), 取选择列数 (), 字体属性)
    取光标行号 ().置字体名 (取光标列号 (), 取选择行数 (), 取选择列数 (), .字体名称)
    赋值 (字体尺寸, 相除 (相乘 (.字体大小, 10), 72, 0.0394)) ' 由于字体对话框返回的字体尺寸是以1/72英寸为单位,现将其转换为0.1MM.
    取光标行号 ().置字体尺寸 (取光标列号 (), 取选择行数 (), 取选择列数 (), 字体尺寸)
    设置修改 ()
.如果真结束


.子程序 _边距_被选择, 空白型, , 
.局部变量 边距, 整数型, , , 

.如果真 (输入框 (“请输入边距(单位0.1MM):”, “单元格边距设置”, “9”, 边距, #输入整数))
    设置修改 ()
    取光标行号 ().置边距 (取光标列号 (), 取选择行数 (), 取选择列数 (), 边距)
.如果真结束


.子程序 _通常型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #通常型)
相减 (取栏目数 (), 7).置文本 (多项选择 (相加 (取光标行号 ().取文本输入格式 (取光标列号 ()), 1), “通常型”, “字节型”, “短整数型”, “整数型”, “长整数型”, “小数型”, “双精度小数型”, “逻辑型”, “日期时间型”))

.子程序 _字节型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #字节型)
相减 (取栏目数 (), 7).置文本 (多项选择 (相加 (取光标行号 ().取文本输入格式 (取光标列号 ()), 1), “通常型”, “字节型”, “短整数型”, “整数型”, “长整数型”, “小数型”, “双精度小数型”, “逻辑型”, “日期时间型”))

.子程序 _短整数型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #短整数型)
相减 (取栏目数 (), 7).置文本 (多项选择 (相加 (取光标行号 ().取文本输入格式 (取光标列号 ()), 1), “通常型”, “字节型”, “短整数型”, “整数型”, “长整数型”, “小数型”, “双精度小数型”, “逻辑型”, “日期时间型”))

.子程序 _整数型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #整数型)
相减 (取栏目数 (), 7).置文本 (多项选择 (相加 (取光标行号 ().取文本输入格式 (取光标列号 ()), 1), “通常型”, “字节型”, “短整数型”, “整数型”, “长整数型”, “小数型”, “双精度小数型”, “逻辑型”, “日期时间型”))

.子程序 _长整数型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #长整数型)
相减 (取栏目数 (), 7).置文本 (多项选择 (相加 (取光标行号 ().取文本输入格式 (取光标列号 ()), 1), “通常型”, “字节型”, “短整数型”, “整数型”, “长整数型”, “小数型”, “双精度小数型”, “逻辑型”, “日期时间型”))

.子程序 _小数型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #小数型)
相减 (取栏目数 (), 7).置文本 (多项选择 (相加 (取光标行号 ().取文本输入格式 (取光标列号 ()), 1), “通常型”, “字节型”, “短整数型”, “整数型”, “长整数型”, “小数型”, “双精度小数型”, “逻辑型”, “日期时间型”))

.子程序 _双精度小数型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #双精度小数型)
相减 (取栏目数 (), 7).置文本 (多项选择 (相加 (取光标行号 ().取文本输入格式 (取光标列号 ()), 1), “通常型”, “字节型”, “短整数型”, “整数型”, “长整数型”, “小数型”, “双精度小数型”, “逻辑型”, “日期时间型”))

.子程序 _逻辑型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #逻辑型)
相减 (取栏目数 (), 7).置文本 (多项选择 (相加 (取光标行号 ().取文本输入格式 (取光标列号 ()), 1), “通常型”, “字节型”, “短整数型”, “整数型”, “长整数型”, “小数型”, “双精度小数型”, “逻辑型”, “日期时间型”))

.子程序 _日期时间型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #日期时间型)
相减 (取栏目数 (), 7).置文本 (多项选择 (相加 (取光标行号 ().取文本输入格式 (取光标列号 ()), 1), “通常型”, “字节型”, “短整数型”, “整数型”, “长整数型”, “小数型”, “双精度小数型”, “逻辑型”, “日期时间型”))

.子程序 _上左_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #上左)
相减 (取栏目数 (), 8).置文本 (多项选择 (取光标行号 ().取对齐方式 (取光标列号 ()), “上左”, “上中”, “上右”, “中左”, “中中”, “中右”, “下左”, “下中”, “下右”, “缩放图片”, “居中图片”, “缩放居中图片”, “平铺图片”, “缩放平铺图片”))

.子程序 _上中_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #上中)
相减 (取栏目数 (), 8).置文本 (多项选择 (取光标行号 ().取对齐方式 (取光标列号 ()), “上左”, “上中”, “上右”, “中左”, “中中”, “中右”, “下左”, “下中”, “下右”, “缩放图片”, “居中图片”, “缩放居中图片”, “平铺图片”, “缩放平铺图片”))

.子程序 _上右_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #上右)
相减 (取栏目数 (), 8).置文本 (多项选择 (取光标行号 ().取对齐方式 (取光标列号 ()), “上左”, “上中”, “上右”, “中左”, “中中”, “中右”, “下左”, “下中”, “下右”, “缩放图片”, “居中图片”, “缩放居中图片”, “平铺图片”, “缩放平铺图片”))

.子程序 _中左_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #中左)
相减 (取栏目数 (), 8).置文本 (多项选择 (取光标行号 ().取对齐方式 (取光标列号 ()), “上左”, “上中”, “上右”, “中左”, “中中”, “中右”, “下左”, “下中”, “下右”, “缩放图片”, “居中图片”, “缩放居中图片”, “平铺图片”, “缩放平铺图片”))

.子程序 _中中_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #中中)
相减 (取栏目数 (), 8).置文本 (多项选择 (取光标行号 ().取对齐方式 (取光标列号 ()), “上左”, “上中”, “上右”, “中左”, “中中”, “中右”, “下左”, “下中”, “下右”, “缩放图片”, “居中图片”, “缩放居中图片”, “平铺图片”, “缩放平铺图片”))

.子程序 _中右_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #中右)
相减 (取栏目数 (), 8).置文本 (多项选择 (取光标行号 ().取对齐方式 (取光标列号 ()), “上左”, “上中”, “上右”, “中左”, “中中”, “中右”, “下左”, “下中”, “下右”, “缩放图片”, “居中图片”, “缩放居中图片”, “平铺图片”, “缩放平铺图片”))

.子程序 _下左_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #下左)
相减 (取栏目数 (), 8).置文本 (多项选择 (取光标行号 ().取对齐方式 (取光标列号 ()), “上左”, “上中”, “上右”, “中左”, “中中”, “中右”, “下左”, “下中”, “下右”, “缩放图片”, “居中图片”, “缩放居中图片”, “平铺图片”, “缩放平铺图片”))

.子程序 _下中_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #下中)
相减 (取栏目数 (), 8).置文本 (多项选择 (取光标行号 ().取对齐方式 (取光标列号 ()), “上左”, “上中”, “上右”, “中左”, “中中”, “中右”, “下左”, “下中”, “下右”, “缩放图片”, “居中图片”, “缩放居中图片”, “平铺图片”, “缩放平铺图片”))

.子程序 _下右_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #下右)
相减 (取栏目数 (), 8).置文本 (多项选择 (取光标行号 ().取对齐方式 (取光标列号 ()), “上左”, “上中”, “上右”, “中左”, “中中”, “中右”, “下左”, “下中”, “下右”, “缩放图片”, “居中图片”, “缩放居中图片”, “平铺图片”, “缩放平铺图片”))

.子程序 _缩放图片_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #缩放图片)
相减 (取栏目数 (), 8).置文本 (多项选择 (取光标行号 ().取对齐方式 (取光标列号 ()), “上左”, “上中”, “上右”, “中左”, “中中”, “中右”, “下左”, “下中”, “下右”, “缩放图片”, “居中图片”, “缩放居中图片”, “平铺图片”, “缩放平铺图片”))

.子程序 _居中图片_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #居中图片)
相减 (取栏目数 (), 8).置文本 (多项选择 (取光标行号 ().取对齐方式 (取光标列号 ()), “上左”, “上中”, “上右”, “中左”, “中中”, “中右”, “下左”, “下中”, “下右”, “缩放图片”, “居中图片”, “缩放居中图片”, “平铺图片”, “缩放平铺图片”))

.子程序 _缩放居中图片_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #缩放居中图片)
相减 (取栏目数 (), 8).置文本 (多项选择 (取光标行号 ().取对齐方式 (取光标列号 ()), “上左”, “上中”, “上右”, “中左”, “中中”, “中右”, “下左”, “下中”, “下右”, “缩放图片”, “居中图片”, “缩放居中图片”, “平铺图片”, “缩放平铺图片”))

.子程序 _平铺图片_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #平铺图片)
相减 (取栏目数 (), 8).置文本 (多项选择 (取光标行号 ().取对齐方式 (取光标列号 ()), “上左”, “上中”, “上右”, “中左”, “中中”, “中右”, “下左”, “下中”, “下右”, “缩放图片”, “居中图片”, “缩放居中图片”, “平铺图片”, “缩放平铺图片”))

.子程序 _缩放平铺图片_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #缩放平铺图片)
相减 (取栏目数 (), 8).置文本 (多项选择 (取光标行号 ().取对齐方式 (取光标列号 ()), “上左”, “上中”, “上右”, “中左”, “中中”, “中右”, “下左”, “下中”, “下右”, “缩放图片”, “居中图片”, “缩放居中图片”, “平铺图片”, “缩放平铺图片”))

.子程序 _添加边框_被选择, 空白型, , 
设置修改 ()
取光标行号 ().加线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), 相加 (#左边框, #上边框, #右边框, #下边框))

.子程序 _添加全部表格线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().加线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))

.子程序 _添加水平表格线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().加线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), #水平线)

.子程序 _添加垂直表格线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().加线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), #垂直线)

.子程序 _添加单斜线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().删线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), 相加 (#单斜线, #双斜线, #交叉线))
取光标行号 ().加线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), #单斜线)

.子程序 _添加双斜线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().删线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), 相加 (#单斜线, #双斜线, #交叉线))
取光标行号 ().加线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), #双斜线)

.子程序 _添加交叉线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().删线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), 相加 (#单斜线, #双斜线, #交叉线))
取光标行号 ().加线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), #交叉线)

.子程序 _清除内部表格线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().删线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), 相加 (#水平线, #垂直线))

.子程序 _清除斜线或交叉线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().删线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), 相加 (#单斜线, #双斜线, #交叉线))

.子程序 _清除所有表格线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().删线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))

.子程序 _写入图片数据_被选择, 空白型, , 
 ' 图片文件名称可以直接以文本方式写入.
.如果真 (等于 (打开 (), 真))
    设置修改 ()
    取光标行号 ().置数据 (取光标列号 (), 读入文件 (.文件名))
.如果真结束


.子程序 _置表头行数_被选择, 空白型, , 
.局部变量 表头行数, 整数型, , , 

.如果真 (输入框 (“请输入表头行数:”, “表头行数设置”, “0”, 表头行数, #输入整数))
    设置修改 ()
    表头行数.置表头行数 ()
.如果真结束


.子程序 _置表头列数_被选择, 空白型, , 
.局部变量 表头列数, 整数型, , , 

.如果真 (输入框 (“请输入表头列数:”, “表头列数设置”, “0”, 表头列数, #输入整数))
    设置修改 ()
    表头列数.置表头列数 ()
.如果真结束


.子程序 关联数据库, 逻辑型, , 感谢"西风"朋友提供此段代码.
.如果 (是否为调试版 ())
    返回 (假)
.否则
    返回 (并且 (写注册项 (#根类, “.edb\”, “edbfile”), 写注册项 (#根类, “edbfile\”, “易数据库”), 写注册项 (#根类, “edbfile\DefaultIcon\”, 相加 (选择 (等于 (取文本右边 (取运行目录 (), 1), “\”), 取运行目录 (), 相加 (取运行目录 (), “\”)), 取执行文件名 (), “,0”)), 写注册项 (#根类, “edbfile\shell\open\command\”, 相加 (选择 (等于 (取文本右边 (取运行目录 (), 1), “\”), 取运行目录 (), 相加 (取运行目录 (), “\”)), 取执行文件名 (), “ %1”))))
.如果结束


.子程序 设置修改, 空白型, , 
.局部变量 a, 整数型, , , 

.如果真 (不等于 (.数据提供者, “数据库提供者1”))
    赋值 (是否被修改, 真)
    如果 (文件是否存在 (临时目录 ＋ 到文本 (撤消重复位置 ＋ 1) ＋ “.tmp”) ＝ 真)
    判断循环首 (文件是否存在 (临时目录 ＋ 到文本 (撤消重复位置 ＋ a) ＋ “.tmp”) ＝ 真)
    赋值 (撤消重复数量, 相加 (撤消重复位置, 1))
    赋值 (撤消重复位置, 相加 (撤消重复位置, 1))
    赋值 (撤消重复数据, 存到字节集 ())
    相加 (临时目录, 到文本 (撤消重复数量), “.tmp”).存到文件 ()
    赋值 (.禁止, 假)
    赋值 (.禁止, 真)
    10.去除状态 (#禁止)
    11.加入状态 (#禁止)
    修改判断 ()
.如果真结束


.子程序 winproc, 整数型, , 回调列表框
.参数 hwnd, 整数型, , 
.参数 wmsg, 整数型, , 
.参数 wparam, 整数型, , 
.参数 lparam, 整数型, , 

.判断开始 (等于 (wmsg, #WM_DROPFILES))
    赋值 (拖放文件个数, 取被拖放文件名 (wparam, -1, 拖放文件名称, 256))
    .计次循环首 (拖放文件个数, i)
        赋值 (拖放文件名称, 取空白文本 (256))
        取被拖放文件名 (wparam, 相减 (i, 1), 拖放文件名称, 256)
        .如果 (等于 (i, 1))
            .如果真 (等于 (询问保存文档 (), 假))
                .判断开始 (等于 (取文本右边 (拖放文件名称, 4), “.grd”))
                    打开并读入文件 (拖放文件名称)
                .判断 (等于 (取文本右边 (拖放文件名称, 4), “.edb”))
                    打开数据库 (拖放文件名称)
                .默认
                    
                .判断结束
                
            .如果真结束
            
        .否则
            
            未知支持库函数_6 (#, 相加 (取运行目录 (), “\”, 取执行文件名 ()), 拖放文件名称, )
        .如果结束
        
    .计次循环尾 ()
    结束拖放 (wparam)
.默认
    返回 (CallWindowProc (oldhwndproc, hwnd, wmsg, wparam, lparam))
    返回 (0)
.判断结束
返回 (0)

.子程序 _表格1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (功能键状态, #Alt键状态))
    .判断开始 (等于 (键代码, #下光标键))
        微调大高度 ()
        相减 (取栏目数 (), 4).置文本 (相加 (“行高：”, 到文本 (相除 (取光标行号 ().取行高 (), 10)), “mm”))
    .判断 (等于 (键代码, #上光标键))
        微调小高度 ()
        相减 (取栏目数 (), 4).置文本 (相加 (“行高：”, 到文本 (相除 (取光标行号 ().取行高 (), 10)), “mm”))
    .判断 (等于 (键代码, #左光标键))
        微调小宽度 ()
        相减 (取栏目数 (), 5).置文本 (相加 (“列宽：”, 到文本 (相除 (取光标列号 ().取列宽 (), 10)), “mm”))
    .判断 (等于 (键代码, #右光标键))
        微调大宽度 ()
        相减 (取栏目数 (), 5).置文本 (相加 (“列宽：”, 到文本 (相除 (取光标列号 ().取列宽 (), 10)), “mm”))
    .默认
        
    .判断结束
    
.如果真结束


.子程序 微调大高度, 空白型, , 
.局部变量 a, 整数型, , , 

.如果真 (不等于 (.数据提供者, “数据库提供者1”))
    .计次循环首 (取选择行数 (), a)
        相减 (相加 (取光标行号 (), a), 1).置行高 (1, 相加 (相减 (相加 (取光标行号 (), a), 1).取行高 (), 1))
    .计次循环尾 ()
.如果真结束


.子程序 微调小高度, 空白型, , 
.局部变量 a, 整数型, , , 

.如果真 (不等于 (.数据提供者, “数据库提供者1”))
    .计次循环首 (取选择行数 (), a)
        .如果真 (大于 (相减 (相加 (取光标行号 (), a), 1).取行高 (), 3))
            相减 (相加 (取光标行号 (), a), 1).置行高 (1, 相减 (相减 (相加 (取光标行号 (), a), 1).取行高 (), 1))
        .如果真结束
        
    .计次循环尾 ()
.如果真结束


.子程序 微调大宽度, 空白型, , 
.局部变量 a, 整数型, , , 

.计次循环首 (取选择列数 (), a)
    相减 (相加 (取光标列号 (), a), 1).置列宽 (1, 相加 (相减 (相加 (取光标行号 (), a), 1).取列宽 (), 1))
.计次循环尾 ()

.子程序 微调小宽度, 空白型, , 
.局部变量 a, 整数型, , , 

.计次循环首 (取选择列数 (), a)
    .如果真 (大于 (相减 (相加 (取光标列号 (), a), 1).取列宽 (), 3))
        相减 (相加 (取光标列号 (), a), 1).置列宽 (1, 相减 (相减 (相加 (取光标行号 (), a), 1).取列宽 (), 1))
    .如果真结束
    
.计次循环尾 ()

.子程序 修改判断, 空白型, , 
.如果 (等于 (是否被修改, 真))
    .如果真 (不等于 (取文本左边 (.标题, 1), “*”))
        赋值 (.标题, 相加 (“* ”, .标题))
        相减 (取栏目数 (), 1).置文本 (“已修改”)
    .如果真结束
    
.否则
    .如果真 (等于 (取文本左边 (.标题, 1), “*”))
        赋值 (.标题, 取文本右边 (.标题, 相减 (取文本长度 (.标题), 2)))
        相减 (取栏目数 (), 1).置文本 (“未修改”)
    .如果真结束
    
.如果结束


.子程序 _微调减少高度_被选择, 空白型, , 
微调小高度 ()

.子程序 _微调增加高度_被选择, 空白型, , 
微调大高度 ()

.子程序 _微调减少宽度_被选择, 空白型, , 
微调小宽度 ()

.子程序 _微调增加宽度_被选择, 空白型, , 
微调大宽度 ()

.子程序 _撤消_被选择, 空白型, , 
.如果真 (大于 (撤消重复位置, 1))
    .如果真 (文件是否存在 (相加 (临时目录, 到文本 (相减 (撤消重复位置, 1)), “.tmp”)))
        赋值 (撤消重复位置, 相减 (撤消重复位置, 1))
        撤消重复数据 ＝ 读入文件 (临时目录 ＋ 到文本 (撤消重复位置) ＋ “.tmp”)
        相加 (临时目录, 到文本 (撤消重复位置), “.tmp”).从文件读 ()
        数据源1.从字节集读 (撤消重复数据)
        .如果真 (等于 (撤消重复位置, 1))
            赋值 (.禁止, 真)
            10.加入状态 (#禁止)
        .如果真结束
        赋值 (.禁止, 假)
        11.去除状态 (#禁止)
        
    .如果真结束
    
.如果真结束


.子程序 _重复_被选择, 空白型, , 
.如果真 (小于 (撤消重复位置, 撤消重复数量))
    .如果真 (文件是否存在 (相加 (临时目录, 到文本 (相加 (撤消重复位置, 1)), “.tmp”)))
        赋值 (撤消重复位置, 相加 (撤消重复位置, 1))
        撤消重复数据 ＝ 读入文件 (临时目录 ＋ 到文本 (撤消重复位置) ＋ “.tmp”)
        相加 (临时目录, 到文本 (撤消重复位置), “.tmp”).从文件读 ()
        数据源1.从字节集读 (撤消重复数据)
        .如果真 (等于 (撤消重复位置, 撤消重复数量))
            赋值 (.禁止, 真)
            11.加入状态 (#禁止)
        .如果真结束
        赋值 (.禁止, 假)
        10.去除状态 (#禁止)
    .如果真结束
    
.如果真结束


.子程序 _表格1_光标位置改变, 空白型, , 
.局部变量 行号, 整数型, , , 
.局部变量 列号, 整数型, , , 

.如果真 (并且 (等于 (取选择行数 (), 1), 等于 (取选择列数 (), 1)))
    赋值 (行号, 取光标行号 ())
    赋值 (列号, 取光标列号 ())
    相减 (取栏目数 (), 3).置文本 (相加 (“行号：”, 到文本 (行号)))
    相减 (取栏目数 (), 2).置文本 (相加 (“列号：”, 到文本 (列号)))
    相减 (取栏目数 (), 4).置文本 (相加 (“行高：”, 到文本 (相除 (行号.取行高 (), 10)), “mm”))
    相减 (取栏目数 (), 5).置文本 (相加 (“列宽：”, 到文本 (相除 (列号.取列宽 (), 10)), “mm”))
    相减 (取栏目数 (), 6).置文本 (多项选择 (行号.取类型 (列号), “文本型”, “图片文件名型”, “图片数据型”, “字节集数据型”))
    相减 (取栏目数 (), 7).置文本 (多项选择 (相加 (行号.取文本输入格式 (列号), 1), “通常型”, “字节型”, “短整数型”, “整数型”, “长整数型”, “小数型”, “双精度小数型”, “逻辑型”, “日期时间型”))
    相减 (取栏目数 (), 8).置文本 (多项选择 (行号.取对齐方式 (列号), “上左”, “上中”, “上右”, “中左”, “中中”, “中右”, “下左”, “下中”, “下右”, “缩放图片”, “居中图片”, “缩放居中图片”, “平铺图片”, “缩放平铺图片”))
    .如果真 (或者 (等于 (行号.取类型 (列号), #文本), 等于 (行号.取类型 (列号), #图片文件名)))
        赋值 (.内容, 行号.取文本 (列号))
    .如果真结束
    赋值 (.颜色, 行号.取文本色 (列号))
    赋值 (.颜色, 行号.取背景色 (列号))
    .如果 (等于 (位与 (行号.取字体属性 (列号), #粗体), #粗体))
        3.加入状态 (#选中)
    .否则
        3.去除状态 (#选中)
    .如果结束
    
    .如果 (不等于 (位与 (行号.取字体属性 (列号), #斜体), 0))
        4.加入状态 (#选中)
    .否则
        4.去除状态 (#选中)
    .如果结束
    
    .如果 (不等于 (位与 (行号.取字体属性 (列号), #下划线), 0))
        5.加入状态 (#选中)
    .否则
        5.去除状态 (#选中)
    .如果结束
    赋值 (.内容, 到文本 (四舍五入 (相除 (相乘 (行号.取字体尺寸 (列号), 72, 0.0394), 10), )))
.如果真结束


.子程序 _表格1_选择行列数改变, 空白型, , 
.局部变量 行号, 整数型, , , 
.局部变量 列号, 整数型, , , 
.局部变量 总宽度, 整数型, , , 
.局部变量 总高度, 整数型, , , 
.局部变量 a, 整数型, , , 

赋值 (行号, 取光标行号 ())
赋值 (列号, 取光标列号 ())

.如果真 (或者 (等于 (行号.取类型 (列号), #文本), 等于 (行号.取类型 (列号), #图片文件名)))
    赋值 (.内容, 行号.取文本 (列号))
.如果真结束

.如果真 (或者 (大于 (取选择行数 (), 1), 大于 (取选择列数 (), 1)))
    相减 (取栏目数 (), 3).置文本 (相加 (“行数：”, 到文本 (取选择行数 ())))
    相减 (取栏目数 (), 2).置文本 (相加 (“列数：”, 到文本 (取选择列数 ())))
    
    .计次循环首 (取选择列数 (), a)
        赋值 (总宽度, 相加 (总宽度, 相减 (相加 (列号, a), 1).取列宽 ()))
    .计次循环尾 ()
    相减 (取栏目数 (), 8).置文本 (多项选择 (行号.取对齐方式 (列号), “上左”, “上中”, “上右”, “中左”, “中中”, “中右”, “下左”, “下中”, “下右”, “缩放图片”, “居中图片”, “缩放居中图片”, “平铺图片”, “缩放平铺图片”))
    相减 (取栏目数 (), 7).置文本 (多项选择 (相加 (行号.取文本输入格式 (列号), 1), “通常型”, “字节型”, “短整数型”, “整数型”, “长整数型”, “小数型”, “双精度小数型”, “逻辑型”, “日期时间型”))
    相减 (取栏目数 (), 6).置文本 (多项选择 (行号.取类型 (列号), “文本型”, “图片文件名型”, “图片数据型”, “字节集数据型”))
    相减 (取栏目数 (), 5).置文本 (相加 (“总宽：”, 到文本 (相除 (总宽度, 10)), “mm”))
    .计次循环首 (取选择行数 (), a)
        赋值 (总高度, 相加 (总高度, 相减 (相加 (行号, a), 1).取行高 ()))
    .计次循环尾 ()
    相减 (取栏目数 (), 4).置文本 (相加 (“总高：”, 到文本 (相除 (总高度, 10)), “mm”))
    赋值 (.颜色, 行号.取文本色 (列号))
    赋值 (.颜色, 行号.取背景色 (列号))
    .如果 (等于 (位与 (行号.取字体属性 (列号), #粗体), #粗体))
        3.加入状态 (#选中)
    .否则
        3.去除状态 (#选中)
    .如果结束
    
    .如果 (不等于 (位与 (行号.取字体属性 (列号), #斜体), 0))
        4.加入状态 (#选中)
    .否则
        4.去除状态 (#选中)
    .如果结束
    
    .如果 (不等于 (位与 (行号.取字体属性 (列号), #下划线), 0))
        5.加入状态 (#选中)
    .否则
        5.去除状态 (#选中)
    .如果结束
    赋值 (.内容, 到文本 (四舍五入 (相除 (相乘 (行号.取字体尺寸 (列号), 72, 0.0394), 10), )))
.如果真结束
_表格1_光标位置改变 ()

.子程序 _表格1_行高被改变, 空白型, , 
.参数 行号, 整数型, , 

_表格1_选择行列数改变 ()

.子程序 _表格1_列宽被改变, 空白型, , 
.参数 列号, 整数型, , 

_表格1_选择行列数改变 ()

.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.判断开始 (等于 (按钮索引, 0))
    _新建_被选择 ()
.判断 (等于 (按钮索引, 1))
    弹出菜单 (隐藏打开, , )
.判断 (等于 (按钮索引, 2))
    _保存_被选择 ()
.判断 (等于 (按钮索引, 4))
    _打印预览_被选择 ()
.判断 (等于 (按钮索引, 5))
    _打印_被选择 ()
.判断 (等于 (按钮索引, 7))
    _剪切_被选择 ()
.判断 (等于 (按钮索引, 8))
    _复制_被选择 ()
.判断 (等于 (按钮索引, 9))
    _粘贴_被选择 ()
.判断 (等于 (按钮索引, 10))
    _撤消_被选择 ()
.判断 (等于 (按钮索引, 11))
    _重复_被选择 ()
.判断 (等于 (按钮索引, 13))
    _置行高_被选择 ()
.判断 (等于 (按钮索引, 14))
    _置列宽_被选择 ()
.默认
    
.判断结束


.子程序 _工具条1_被下拉, 空白型, , 
.参数 按钮索引, 整数型, , 
.参数 下拉横座标, 整数型, , 
.参数 下拉纵座标, 整数型, , 

.判断开始 (等于 (按钮索引, 1))
    弹出菜单 (下拉横座标, 下拉纵座标)
.判断 (等于 (按钮索引, 15))
    弹出菜单 (下拉横座标, 下拉纵座标)
.判断 (等于 (按钮索引, 16))
    弹出菜单 (下拉横座标, 下拉纵座标)
.默认
    
.判断结束


.子程序 _编辑框1_内容被改变, 空白型, , 
.局部变量 行号, 整数型, , , 
.局部变量 列号, 整数型, , , 

赋值 (行号, 取光标行号 ())
赋值 (列号, 取光标列号 ())

.如果真 (或者 (等于 (行号.取类型 (列号), #文本), 等于 (行号.取类型 (列号), #图片文件名)))
    .如果真 (不等于 (.内容, 行号.取文本 (列号)))
        行号.置文本 (列号, .内容)
        赋值 (是否被修改, 真)
        赋值 (撤消重复数量, 相加 (撤消重复位置, 1))
        赋值 (撤消重复位置, 相加 (撤消重复位置, 1))
        赋值 (撤消重复数据, 存到字节集 ())
        相加 (临时目录, 到文本 (撤消重复数量), “.tmp”).存到文件 ()
        赋值 (.禁止, 假)
        赋值 (.禁止, 真)
        10.去除状态 (#禁止)
        11.加入状态 (#禁止)
        
        修改判断 ()
    .如果真结束
    
.如果真结束


.子程序 _颜色选择器1_颜色被改变, 空白型, , 文本颜色
取光标行号 ().置文本色 (取光标列号 (), 取选择行数 (), 取选择列数 (), .颜色)

.子程序 _颜色选择器2_颜色被改变, 空白型, , 背景颜色
取光标行号 ().置背景色 (取光标列号 (), 取选择行数 (), 取选择列数 (), .颜色)

.子程序 _工具条2_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.局部变量 行号, 整数型, , , 
.局部变量 列号, 整数型, , , 
.局部变量 颜色返回值, 整数型, , , 

赋值 (行号, 取光标行号 ())
赋值 (列号, 取光标列号 ())
.判断开始 (等于 (按钮索引, 0))
    _组合_被选择 ()
.判断 (等于 (按钮索引, 1))
    _分解_被选择 ()
.判断 (等于 (按钮索引, 3))
    .判断开始 (等于 (位与 (3.取状态 (), #选中), #选中))
        取光标行号 ().置字体属性 (取光标列号 (), 取选择行数 (), 取选择列数 (), 相加 (行号.取字体属性 (列号), #粗体))
    .默认
        取光标行号 ().置字体属性 (取光标列号 (), 取选择行数 (), 取选择列数 (), 相减 (行号.取字体属性 (列号), #粗体))
    .判断结束
    设置修改 ()
.判断 (等于 (按钮索引, 4))
    .判断开始 (等于 (位与 (4.取状态 (), #选中), #选中))
        取光标行号 ().置字体属性 (取光标列号 (), 取选择行数 (), 取选择列数 (), 相加 (行号.取字体属性 (列号), #斜体))
    .默认
        取光标行号 ().置字体属性 (取光标列号 (), 取选择行数 (), 取选择列数 (), 相减 (行号.取字体属性 (列号), #斜体))
    .判断结束
    设置修改 ()
.判断 (等于 (按钮索引, 5))
    .判断开始 (等于 (位与 (5.取状态 (), #选中), #选中))
        取光标行号 ().置字体属性 (取光标列号 (), 取选择行数 (), 取选择列数 (), 相加 (行号.取字体属性 (列号), #下划线))
    .默认
        取光标行号 ().置字体属性 (取光标列号 (), 取选择行数 (), 取选择列数 (), 相减 (行号.取字体属性 (列号), #下划线))
    .判断结束
    设置修改 ()
.判断 (等于 (按钮索引, 6))
    赋值 (颜色返回值, 显示颜色对话框 ())
    .如果真 (不等于 (颜色返回值, -1))
        赋值 (.颜色, 颜色返回值)
        取光标行号 ().置背景色 (取光标列号 (), 取选择行数 (), 取选择列数 (), .颜色)
    .如果真结束
    
.判断 (等于 (按钮索引, 7))
    赋值 (颜色返回值, 显示颜色对话框 ())
    .如果真 (不等于 (颜色返回值, -1))
        赋值 (.颜色, 颜色返回值)
        取光标行号 ().置文本色 (取光标列号 (), 取选择行数 (), 取选择列数 (), .颜色)
    .如果真结束
    
.判断 (等于 (按钮索引, 9))
    
.判断 (等于 (按钮索引, 10)) ' 左对齐
    .判断开始 (小于 (行号.取对齐方式 (列号), 4))
        行号.置对齐方式 (列号, 取选择行数 (), 取选择列数 (), #上左)
    .判断 (并且 (大于 (行号.取对齐方式 (列号), 3), 小于 (行号.取对齐方式 (列号), 7)))
        行号.置对齐方式 (列号, 取选择行数 (), 取选择列数 (), #中左)
    .判断 (并且 (大于 (行号.取对齐方式 (列号), 6), 小于 (行号.取对齐方式 (列号), 10)))
        行号.置对齐方式 (列号, 取选择行数 (), 取选择列数 (), #下左)
    .默认
        
    .判断结束
    相减 (取栏目数 (), 8).置文本 (多项选择 (取光标行号 ().取对齐方式 (取光标列号 ()), “上左”, “上中”, “上右”, “中左”, “中中”, “中右”, “下左”, “下中”, “下右”, “缩放图片”, “居中图片”, “缩放居中图片”, “平铺图片”, “缩放平铺图片”))
    设置修改 ()
.判断 (等于 (按钮索引, 11))
    .判断开始 (小于 (行号.取对齐方式 (列号), 4))
        行号.置对齐方式 (列号, 取选择行数 (), 取选择列数 (), #上中)
    .判断 (并且 (大于 (行号.取对齐方式 (列号), 3), 小于 (行号.取对齐方式 (列号), 7)))
        行号.置对齐方式 (列号, 取选择行数 (), 取选择列数 (), #中中)
    .判断 (并且 (大于 (行号.取对齐方式 (列号), 6), 小于 (行号.取对齐方式 (列号), 10)))
        行号.置对齐方式 (列号, 取选择行数 (), 取选择列数 (), #下中)
    .默认
        
    .判断结束
    相减 (取栏目数 (), 8).置文本 (多项选择 (取光标行号 ().取对齐方式 (取光标列号 ()), “上左”, “上中”, “上右”, “中左”, “中中”, “中右”, “下左”, “下中”, “下右”, “缩放图片”, “居中图片”, “缩放居中图片”, “平铺图片”, “缩放平铺图片”))
    设置修改 ()
.判断 (等于 (按钮索引, 12))
    .判断开始 (小于 (行号.取对齐方式 (列号), 4))
        行号.置对齐方式 (列号, 取选择行数 (), 取选择列数 (), #上右)
    .判断 (并且 (大于 (行号.取对齐方式 (列号), 3), 小于 (行号.取对齐方式 (列号), 7)))
        行号.置对齐方式 (列号, 取选择行数 (), 取选择列数 (), #中右)
    .判断 (并且 (大于 (行号.取对齐方式 (列号), 6), 小于 (行号.取对齐方式 (列号), 10)))
        行号.置对齐方式 (列号, 取选择行数 (), 取选择列数 (), #下右)
    .默认
        
    .判断结束
    相减 (取栏目数 (), 8).置文本 (多项选择 (取光标行号 ().取对齐方式 (取光标列号 ()), “上左”, “上中”, “上右”, “中左”, “中中”, “中右”, “下左”, “下中”, “下右”, “缩放图片”, “居中图片”, “缩放居中图片”, “平铺图片”, “缩放平铺图片”))
    设置修改 ()
.判断 (等于 (按钮索引, 13))
    .判断开始 (或者 (等于 (行号.取对齐方式 (列号), 1), 等于 (行号.取对齐方式 (列号), 4), 等于 (行号.取对齐方式 (列号), 7)))
        行号.置对齐方式 (列号, 取选择行数 (), 取选择列数 (), #上左)
    .判断 (或者 (等于 (行号.取对齐方式 (列号), 2), 等于 (行号.取对齐方式 (列号), 5), 等于 (行号.取对齐方式 (列号), 8)))
        行号.置对齐方式 (列号, 取选择行数 (), 取选择列数 (), #上中)
    .判断 (或者 (等于 (行号.取对齐方式 (列号), 3), 等于 (行号.取对齐方式 (列号), 6), 等于 (行号.取对齐方式 (列号), 9)))
        行号.置对齐方式 (列号, 取选择行数 (), 取选择列数 (), #上右)
    .默认
        
    .判断结束
    相减 (取栏目数 (), 8).置文本 (多项选择 (取光标行号 ().取对齐方式 (取光标列号 ()), “上左”, “上中”, “上右”, “中左”, “中中”, “中右”, “下左”, “下中”, “下右”, “缩放图片”, “居中图片”, “缩放居中图片”, “平铺图片”, “缩放平铺图片”))
    设置修改 ()
.判断 (等于 (按钮索引, 14))
    .判断开始 (或者 (等于 (行号.取对齐方式 (列号), 1), 等于 (行号.取对齐方式 (列号), 4), 等于 (行号.取对齐方式 (列号), 7)))
        行号.置对齐方式 (列号, 取选择行数 (), 取选择列数 (), #中左)
    .判断 (或者 (等于 (行号.取对齐方式 (列号), 2), 等于 (行号.取对齐方式 (列号), 5), 等于 (行号.取对齐方式 (列号), 8)))
        行号.置对齐方式 (列号, 取选择行数 (), 取选择列数 (), #中中)
    .判断 (或者 (等于 (行号.取对齐方式 (列号), 3), 等于 (行号.取对齐方式 (列号), 6), 等于 (行号.取对齐方式 (列号), 9)))
        行号.置对齐方式 (列号, 取选择行数 (), 取选择列数 (), #中右)
    .默认
        
    .判断结束
    相减 (取栏目数 (), 8).置文本 (多项选择 (取光标行号 ().取对齐方式 (取光标列号 ()), “上左”, “上中”, “上右”, “中左”, “中中”, “中右”, “下左”, “下中”, “下右”, “缩放图片”, “居中图片”, “缩放居中图片”, “平铺图片”, “缩放平铺图片”))
    设置修改 ()
.判断 (等于 (按钮索引, 15))
    .判断开始 (或者 (等于 (行号.取对齐方式 (列号), 1), 等于 (行号.取对齐方式 (列号), 4), 等于 (行号.取对齐方式 (列号), 7)))
        行号.置对齐方式 (列号, 取选择行数 (), 取选择列数 (), #下左)
    .判断 (或者 (等于 (行号.取对齐方式 (列号), 2), 等于 (行号.取对齐方式 (列号), 5), 等于 (行号.取对齐方式 (列号), 8)))
        行号.置对齐方式 (列号, 取选择行数 (), 取选择列数 (), #下中)
    .判断 (或者 (等于 (行号.取对齐方式 (列号), 3), 等于 (行号.取对齐方式 (列号), 6), 等于 (行号.取对齐方式 (列号), 9)))
        行号.置对齐方式 (列号, 取选择行数 (), 取选择列数 (), #下右)
    .默认
        
    .判断结束
    相减 (取栏目数 (), 8).置文本 (多项选择 (取光标行号 ().取对齐方式 (取光标列号 ()), “上左”, “上中”, “上右”, “中左”, “中中”, “中右”, “下左”, “下中”, “下右”, “缩放图片”, “居中图片”, “缩放居中图片”, “平铺图片”, “缩放平铺图片”))
    设置修改 ()
.判断 (等于 (按钮索引, 17))
    赋值 (颜色返回值, 显示颜色对话框 ())
    .如果真 (不等于 (颜色返回值, -1))
        赋值 (.颜色, 颜色返回值)
        表格1.表格线颜色
        数据源1.置背景色 (表格1.取光标行号 (), 表格1.取光标列号 (), 表格1.取选择行数 (), 表格1.取选择列数 (), 颜色选择器2.颜色)
    .如果真结束
    
    
.判断 (等于 (按钮索引, 19))
    
.判断 (等于 (按钮索引, 20))
    
.判断 (等于 (按钮索引, 21))
    
.判断 (等于 (按钮索引, 22))
    
.判断 (等于 (按钮索引, 23))
    
.判断 (等于 (按钮索引, 24))
    
.判断 (等于 (按钮索引, 25))
    
.判断 (等于 (按钮索引, 26))
    
.判断 (等于 (按钮索引, 27))
    
.默认
    
.判断结束


.子程序 _工具条2_被下拉, 空白型, , 
.参数 按钮索引, 整数型, , 
.参数 下拉横座标, 整数型, , 
.参数 下拉纵座标, 整数型, , 

.判断开始 (等于 (按钮索引, 18))
    连续赋值 (假, .可视, .可视, .可视, .可视)
    弹出菜单 (下拉横座标, 下拉纵座标)
    连续赋值 (真, .可视, .可视, .可视, .可视)
.判断 (等于 (按钮索引, 19))
    连续赋值 (假, .可视, .可视, .可视, .可视, .可视, .可视)
    弹出菜单 (下拉横座标, 下拉纵座标)
    连续赋值 (真, .可视, .可视, .可视, .可视, .可视, .可视)
.默认
    
.判断结束


.子程序 _人民币符号_被选择, 空白型, , 


.子程序 _美圆符号_被选择, 空白型, , 


.子程序 _欧元符号_被选择, 空白型, , 


.子程序 _财务大写_被选择, 空白型, , 


.子程序 _普通数字_被选择, 空白型, , 


.子程序 _组合框2_列表项被选择, 空白型, , 
.局部变量 字体尺寸, 整数型, , , 

赋值 (.内容, .取项目文本 (.现行选中项))
赋值 (字体尺寸, 相除 (相乘 (到数值 (.内容), 10), 72, 0.0394))
取光标行号 ().置字体尺寸 (取光标列号 (), 取选择行数 (), 取选择列数 (), 字体尺寸)
设置修改 ()

.子程序 _组合框2_编辑内容被改变, 空白型, , 
.局部变量 字体尺寸, 整数型, , , 
.局部变量 a, 整数型, , , 

.计次循环首 (取文本长度 (.内容), a)
    .如果真 (或者 (小于 (取代码 (.内容, a), 48), 大于 (取代码 (.内容, a), 57)))
        返回 ()
    .如果真结束
    
.计次循环尾 ()
获取组合框内容 ()
赋值 (字体尺寸, 相除 (相乘 (到数值 (.内容), 10), 72, 0.0394))
取光标行号 ().置字体尺寸 (取光标列号 (), 取选择行数 (), 取选择列数 (), 字体尺寸)
设置修改 ()

.子程序 _组合框2_失去焦点, 空白型, , 
.局部变量 a, 整数型, , , 

.计次循环首 (取文本长度 (.内容), a)
    .如果真 (或者 (小于 (取代码 (.内容, a), 48), 大于 (取代码 (.内容, a), 57)))
        组合框以前行列号数.置字体尺寸 ( [1], 组合框以前行列号数 [2], 组合框以前行列号数 [3], 组合框以前行列号数 [4], 到数值 (组合框以前内容))
        赋值 (.内容, 组合框以前内容)
        设置修改 ()
        返回 ()
    .如果真结束
    
.计次循环尾 ()

.窗口程序集 关于窗口程序集, , , 

.子程序 _按钮1_被单击, 空白型, , 
销毁 ()

.窗口程序集 表格属性窗口程序集, , , 

.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()

.子程序 _确定按钮_被单击, 空白型, , 
赋值 (_启动窗口..表格线颜色, .颜色)
赋值 (_启动窗口..背景颜色, .颜色)
赋值 (_启动窗口..允许选择块, .选中)
赋值 (_启动窗口..显示标尺, .选中)
赋值 (_启动窗口..显示空表格线, .选中)
赋值 (_启动窗口..禁止调整行高, .选中)
赋值 (_启动窗口..禁止调整列宽, .选中)
赋值 (_启动窗口..允许粘贴扩展, .选中)
销毁 ()

.子程序 _表格属性窗口_创建完毕, 空白型, , 
赋值 (.颜色, _启动窗口..表格线颜色)
赋值 (.颜色, _启动窗口..背景颜色)
赋值 (.选中, _启动窗口..允许选择块)
赋值 (.选中, _启动窗口..显示标尺)
赋值 (.选中, _启动窗口..显示空表格线)
赋值 (.选中, _启动窗口..禁止调整行高)
赋值 (.选中, _启动窗口..禁止调整列宽)
赋值 (.选中, _启动窗口..允许粘贴扩展)

.窗口程序集 颜色选择窗口程序集, , , 

.子程序 _颜色选择窗口_创建完毕, 空白型, , 
赋值 (返回颜色有效, 假)
赋值 (.标题, 颜色选择标题)
.判断开始 (等于 (颜色判断, 真))
    赋值 (.颜色, _启动窗口.取文本色 (., _启动窗口.取光标行号 (.), _启动窗口.取光标列号 (.)))
.默认
    赋值 (.颜色, _启动窗口.取背景色 (., _启动窗口.取光标行号 (.), _启动窗口.取光标列号 (.)))
.判断结束


.子程序 _确认按钮_被单击, 空白型, , 
赋值 (返回颜色有效, 真)
赋值 (返回颜色, .颜色)
销毁 ()

.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()

.窗口程序集 建设置窗口程序集, , , 

.程序集变量 行数, 整数型, , , 
.程序集变量 列数, 整数型, , , 
.程序集变量 创建判断, 逻辑型, , , 真为创建，假为不创建
.子程序 _新建设置窗口_创建完毕, 空白型, , 


.子程序 _按钮1_被单击, 空白型, , 确定
赋值 (行数, 到数值 (.内容))
赋值 (列数, 到数值 (.内容))
销毁 ()
赋值 (创建判断, 真)

.子程序 _按钮2_被单击, 空白型, , 取消
赋值 (创建判断, 假)
销毁 ()

.子程序 _新建设置窗口_将被销毁, 空白型, , 
赋值 (创建判断, 假)

.子程序 _编辑框1_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)

.子程序 _编辑框2_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)

.子程序 _编辑框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _按钮1_被单击 ()
.如果真结束


.子程序 _编辑框2_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _按钮1_被单击 ()
.如果真结束


.子程序 _编辑框1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.被选择字符数, -1)

.子程序 _编辑框2_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.被选择字符数, -1)

.程序集 附加程序集, , , 

.子程序 显示颜色对话框, 整数型, , 
.局部变量 CC, CHOOSECOLOR, , , 
.局部变量 CustomColors, 字节型, , "65", 

赋值 (CC.lStructSize, 36)
赋值 (CC.hwndOwner, _启动窗口.取窗口句柄 ())
赋值 (CC.hInstance, 外部_获得程序句柄 (0))
CC.lpCustColors ＝ “”
.计次循环首 (65, )
    赋值 (CC.lpCustColors, 相加 (CC.lpCustColors, 字符 (255)))
.计次循环尾 ()
赋值 (CC.flags, 0)
CC.lpTemplateName ＝ “sssss”
.如果 (不等于 (ChooseColor (CC), 0))
    返回 (CC.rgbResult)
.否则
    返回 (-1)
.如果结束


.子程序 获取组合框内容, 空白型, , 
赋值 (_启动窗口., _启动窗口..内容)
赋值 (_启动窗口. [1], _启动窗口.取光标行号 (.))
赋值 (_启动窗口. [2], _启动窗口.取光标列号 (.))
赋值 (_启动窗口. [3], _启动窗口.取选择行数 (.))
赋值 (_启动窗口. [4], _启动窗口.取选择列数 (.))


 ' 不属于任何一个程序集、类模块的函数：
