 ' 文件类型：Windows窗口程序

 ' 程序名称：打字练习_完全版
 ' 程序描述：演示打字练习的完全版,有漂亮的界面及各种设置.
 ' 程序作者：大连大有吴涛易语言软件开发有限公司
 ' 邮政编码：116001
 ' 联系地址：辽宁省大连市中山区人民路55号1409室
 ' 联系电话：(0411)88995831
 ' 传真号码：(0411)88995834
 ' 电子信箱：service@dywt.com.cn
 ' 主页地址：http://www.dywt.com.cn
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 690
    高度 = 540
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\打字练习_完全.e\_启动窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口_设置
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “效果设置”
    帮助文件名 = “”



.图片 爆炸, " ' 已保存到：D:\易语言学习\Data\打字练习_完全.e\爆炸", , 
.声音 发射1, " ' 已保存到：D:\易语言学习\Data\打字练习_完全.e\发射1", , 
.声音 发射2, " ' 已保存到：D:\易语言学习\Data\打字练习_完全.e\发射2", , 
.声音 发射11, " ' 已保存到：D:\易语言学习\Data\打字练习_完全.e\发射11", , 
.声音 爆炸声, " ' 已保存到：D:\易语言学习\Data\打字练习_完全.e\爆炸声", , 
.声音 碰撞, " ' 已保存到：D:\易语言学习\Data\打字练习_完全.e\碰撞", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一




数据类型 字符数据, , 
    .成员 标识符, 整数型, , , 
    .成员 字符, 文本型, , , 
    .成员 位置, 整数型, , , 


.窗口程序集 窗口程序集1, , , 

.程序集变量 集_模板ID, 整数型, , , 
.程序集变量 集_总分, 整数型, , , 
.程序集变量 集_字符数据, 字符数据, , "0", 
.程序集变量 集_级别, 整数型, , , 
.程序集变量 集_停止, 逻辑型, , , 
.程序集变量 集_计时, 整数型, , , 
.程序集变量 集_加速补偿, 整数型, , , 
.程序集变量 集_练习字数, 整数型, , , 
.程序集变量 匿名程序集变量_477, 空白型, , , 
.程序集变量 集_爆炸效果, 逻辑型, , , 
.程序集变量 集_声音效果, 字节型, , , 
.程序集变量 集_字符类型, 字节型, , , 
.程序集变量 集_底图, 文本型, , , 
.程序集变量 集_设置文件, 文本型, , , 
.子程序 开始, 空白型, , 
.参数 创建序号, 整数型, 可空, 

.局部变量 I, 整数型, , , 
.局部变量 字符数据, 字符数据, , , 
.局部变量 速度, 空白型, , , 

.如果真 (等于 (集_停止, 真))
    返回 ()
.如果真结束
获取焦点 ()
置随机数种子 ()
.判断开始 (是否为空 (创建序号))
    赋值 (速度, 相减 (550, 相乘 (集_级别, 50)))
    .变量循环首 (1, 10, 1, I)
        .判断开始 (等于 (集_字符类型, 0))
            赋值 (字符数据.字符, 字符 (选择 (等于 (取随机数 (1, 2), 1), 取随机数 (#键0, #键9), 取随机数 (#A键, #Z键))))
        .判断 (等于 (集_字符类型, 1))
            赋值 (字符数据.字符, 字符 (取随机数 (#A键, #Z键)))
        .判断 (等于 (集_字符类型, 2))
            赋值 (字符数据.字符, 字符 (取随机数 (#键0, #键9)))
        .默认
            
        .判断结束
        赋值 (字符数据.标识符, 集_模板ID.未知支持库函数_85 (相乘 (I, 42), 0, 真, ))
        字符数据.未知支持库函数_41 (.标识符, 字符数据.字符, , .)
        字符数据.未知支持库函数_72 (.标识符, 10, 速度, 0, 0, 真, 1, 假, )
        赋值 (字符数据.位置, I)
        加入成员 (集_字符数据, 字符数据)
    .变量循环尾 ()
    赋值 (集_练习字数, 10)
    赋值 (., 到文本 (集_练习字数))
.默认
    赋值 (速度, 相减 (550, 相乘 (集_级别, 50), 集_加速补偿))
    .判断开始 (等于 (集_字符类型, 0))
        赋值 (字符数据.字符, 字符 (选择 (等于 (取随机数 (1, 2), 1), 取随机数 (#键0, #键9), 取随机数 (#A键, #Z键))))
    .判断 (等于 (集_字符类型, 1))
        赋值 (字符数据.字符, 字符 (取随机数 (#A键, #Z键)))
    .判断 (等于 (集_字符类型, 2))
        赋值 (字符数据.字符, 字符 (取随机数 (#键0, #键9)))
    .默认
        
    .判断结束
    赋值 (字符数据.标识符, 集_模板ID.未知支持库函数_85 (相乘 (创建序号, 42), 0, 真, ))
    字符数据.未知支持库函数_41 (.标识符, 字符数据.字符, , .)
    字符数据.未知支持库函数_72 (.标识符, 10, 速度, 0, 0, 真, 1, 假, )
    赋值 (字符数据.位置, 创建序号)
    加入成员 (集_字符数据, 字符数据)
    赋值 (集_练习字数, 相加 (集_练习字数, 1))
.判断结束
赋值 (., 到文本 (集_练习字数))


.子程序 _动画框1_碰撞到边界, 逻辑型, , 
.参数 物体标识值, 整数型, , 
.参数 横坐标, 整数型, , 
.参数 纵坐标, 整数型, , 
.参数 边界类型, 整数型, , 

.局部变量 I, 整数型, , , 

.计次循环首 (取数组下标 (集_字符数据, ), I)
    .如果真 (等于 (集_字符数据 [I], 标识符, 物体标识值))
        .判断开始 (等于 (集_爆炸效果, 真))
            物体标识值.未知支持库函数_44 (#爆炸, -2)
            物体标识值.未知支持库函数_56 (相减 (横坐标, 28), 纵坐标, 假)
            物体标识值.未知支持库函数_77 (1, 真, , )
            播放音乐 (#爆炸声, )
        .默认
            物体标识值.未知支持库函数_36 ()
            
        .判断结束
        开始 (集_字符数据 [I], 位置)
        删除成员 (集_字符数据, I, 1)
        赋值 (., 相加 (到文本 (四舍五入 (相除 (相乘 (集_总分, 100), 集_练习字数), 1)), “%”))
        赋值 (., 相加 (到文本 (四舍五入 (相除 (相减 (取启动时间 (), 集_计时), 1000, 集_总分), 1)), “字/秒”))
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()

.子程序 _动画框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 I, 整数型, , , 
.局部变量 子弹ID, 整数型, , , 

.如果真 (或者 (并且 (大于或等于 (键代码, #键0), 小于或等于 (键代码, #键9)), 并且 (大于或等于 (键代码, #A键), 小于或等于 (键代码, #Z键))))
    .计次循环首 (取数组下标 (集_字符数据, ), I)
        .如果真 (等于 (集_字符数据 [I], 字符, 字符 (键代码)))
            赋值 (子弹ID, .未知支持库函数_35 (0, 0, 真, ))
            子弹ID.未知支持库函数_56 (相加 (相乘 (集_字符数据 [I], 位置, 42), 5), ., 真)
            子弹ID.未知支持库函数_72 (20, 10, , , 真, 2, 真, )
            .判断开始 (等于 (集_声音效果, 1))
                播放音乐 (#发射1, )
            .判断 (等于 (集_声音效果, 2))
                播放音乐 (#发射2, )
            .默认
                
            .判断结束
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
.如果真结束


.子程序 _动画框1_碰撞到物体, 空白型, , 
.参数 碰撞物体标识值, 整数型, , 
.参数 横坐标, 整数型, , 
.参数 纵坐标, 整数型, , 
.参数 被碰撞物体标识值, 整数型, , 

.局部变量 I, 整数型, , , 

.计次循环首 (取数组下标 (集_字符数据, ), I)
    .如果真 (等于 (集_字符数据 [I], 标识符, 被碰撞物体标识值))
        .判断开始 (等于 (集_爆炸效果, 真))
            被碰撞物体标识值.未知支持库函数_44 (#爆炸, -2)
            被碰撞物体标识值.未知支持库函数_56 (相减 (横坐标, 28), 相减 (纵坐标, 40), 假)
            被碰撞物体标识值.未知支持库函数_77 (1, 真, , )
        .默认
            被碰撞物体标识值.未知支持库函数_74 (10, 10, , )
            被碰撞物体标识值.未知支持库函数_86 (300)
        .判断结束
        赋值 (集_总分, 相加 (集_总分, 1))
        .如果真 (并且 (等于 (求余数 (集_总分, 10), 0), 小于 (到数值 (.内容), 10)))
            赋值 (集_加速补偿, 相加 (集_加速补偿, 10))
            .如果真 (并且 (等于 (求余数 (集_加速补偿, 50), 0), 小于 (到数值 (.内容), 10)))
                赋值 (.内容, 到文本 (相加 (到数值 (.内容), 1)))
            .如果真结束
            
        .如果真结束
        赋值 (., 相加 (到文本 (四舍五入 (相除 (相乘 (集_总分, 100), 集_练习字数), 1)), “%”))
        赋值 (., 相加 (到文本 (四舍五入 (相除 (相减 (取启动时间 (), 集_计时), 1000, 集_总分), 1)), “字/秒”))
        开始 (集_字符数据 [I], 位置)
        删除成员 (集_字符数据, I, 1)
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()

.子程序 _按钮_开始_被单击, 空白型, , 
赋值 (.禁止, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (集_级别, 到数值 (.内容))
赋值 (集_模板ID, .未知支持库函数_35 (0, 0, 假, ))
赋值 (集_计时, 取启动时间 ())
开始 ()
赋值 (.时钟周期, 1000)


.子程序 _按钮_停止_被单击, 空白型, , 
赋值 (集_停止, 真)
赋值 (.时钟周期, 0)
未知支持库函数_37 ()
清除数组 (集_字符数据)
赋值 (集_停止, 假)
赋值 (集_总分, 0)
赋值 (集_计时, 0)
赋值 (集_加速补偿, 0)
赋值 (集_练习字数, 0)
赋值 (.禁止, 真)
赋值 (.禁止, 假)
赋值 (.禁止, 假)


.子程序 _时钟1_周期事件, 空白型, , 
.局部变量 秒数, 整数型, , , 
.局部变量 时, 文本型, , , 
.局部变量 分, 文本型, , , 
.局部变量 秒, 文本型, , , 

赋值 (秒数, 相除 (相减 (取启动时间 (), 集_计时), 1000))
赋值 (时, 到文本 (整除 (秒数, 3600)))
赋值 (分, 到文本 (整除 (秒数, 60)))
赋值 (秒, 到文本 (求余数 (秒数, 60)))
赋值 (., 相加 (选择 (等于 (取文本长度 (时), 1), “0”, “”), 时, “:”, 选择 (等于 (取文本长度 (分), 1), “0”, “”), 分, “:”, 选择 (等于 (取文本长度 (秒), 1), “0”, “”), 秒))


.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 级别设置, 整数型, , , 

赋值 (集_设置文件, 相加 (取运行目录 (), “\setup.ini”))
赋值 (集_爆炸效果, 选择 (等于 (读配置项 (集_设置文件, “Setup”, “爆炸效果”, “真”), “真”), 真, 假))
赋值 (集_声音效果, 到数值 (读配置项 (集_设置文件, “Setup”, “声音效果”, “1”)))
赋值 (集_字符类型, 到数值 (读配置项 (集_设置文件, “Setup”, “字符类型”, )))
赋值 (., 到数值 (读配置项 (集_设置文件, “Setup”, “背景颜色”, )))
赋值 (集_底图, 读配置项 (集_设置文件, “Setup”, “底图”, ))
赋值 (..字体大小, 到数值 (读配置项 (集_设置文件, “Font”, “字体大小”, “22”)))
赋值 (..字体名称, 读配置项 (集_设置文件, “Font”, “字体名称”, “黑体”))
赋值 (..下划线, 选择 (等于 (读配置项 (集_设置文件, “Font”, “下划线”, “假”), “真”), 真, 假))
赋值 (..加粗, 选择 (等于 (读配置项 (集_设置文件, “Font”, “加粗”, “真”), “真”), 真, 假))
赋值 (..倾斜, 选择 (等于 (读配置项 (集_设置文件, “Font”, “倾斜”, “假”), “真”), 真, 假))
赋值 (..删除线, 选择 (等于 (读配置项 (集_设置文件, “Font”, “删除线”, “假”), “真”), 真, 假))
.如果真 (不等于 (集_底图, “”))
    .判断开始 (文件是否存在 (集_底图))
        赋值 (., 读入文件 (集_底图))
    .默认
        赋值 (集_底图, “”)
    .判断结束
    
.如果真结束
赋值 (级别设置, 到数值 (读配置项 (集_设置文件, “Setup”, “级别设置”, “1”)))
.判断开始 (小于 (级别设置, 1))
    赋值 (级别设置, 1)
.判断 (大于 (级别设置, 10))
    赋值 (级别设置, 10)
.默认
    
.判断结束
赋值 (.内容, 到文本 (级别设置))


.子程序 _按钮_退出_被单击, 空白型, , 
_按钮_停止_被单击 ()
写配置项 (集_设置文件, “Setup”, “爆炸效果”, 到文本 (集_爆炸效果))
写配置项 (集_设置文件, “Setup”, “声音效果”, 到文本 (集_声音效果))
写配置项 (集_设置文件, “Setup”, “字符类型”, 到文本 (集_字符类型))
写配置项 (集_设置文件, “Setup”, “背景颜色”, 到文本 (.))
.判断开始 (并且 (不等于 (集_底图, “”), 文件是否存在 (集_底图)))
    写配置项 (集_设置文件, “Setup”, “底图”, 集_底图)
.默认
    写配置项 (集_设置文件, “Setup”, “底图”, )
.判断结束
写配置项 (集_设置文件, “Setup”, “级别设置”, .内容)
写配置项 (集_设置文件, “Font”, “字体大小”, 到文本 (..字体大小))
写配置项 (集_设置文件, “Font”, “字体名称”, ..字体名称)
写配置项 (集_设置文件, “Font”, “下划线”, 到文本 (..下划线))
写配置项 (集_设置文件, “Font”, “加粗”, 到文本 (..加粗))
写配置项 (集_设置文件, “Font”, “倾斜”, 到文本 (..倾斜))
写配置项 (集_设置文件, “Font”, “删除线”, 到文本 (..删除线))
结束 ()


.子程序 _按钮_设置_被单击, 空白型, , 
_按钮_停止_被单击 ()
载入 (窗口_设置, , 真)


.窗口程序集 窗口程序集2, , , 

.程序集变量 集_字体, 字体, , , 
.子程序 _按钮1_被单击, 空白型, , 
.如果真 (打开 ())
    .判断开始 (大于 (取代码 (.字体名称, ), 0))
        赋值 (.标题, .字体名称)
    .默认
        赋值 (.标题, 相加 (.字体名称, “，ABCD1234”))
    .判断结束
    赋值 (.文本颜色, .字体颜色)
    赋值 (.字体.字体大小, .字体大小)
    赋值 (.字体.字体名称, .字体名称)
    赋值 (.字体.下划线, .下划线)
    赋值 (.字体.加粗, .加粗)
    赋值 (.字体.倾斜, .倾斜)
    赋值 (.字体.删除线, .删除线)
.如果真结束


.子程序 _窗口_设置_创建完毕, 空白型, , 
赋值 (.字体, _启动窗口..)
.判断开始 (大于 (取代码 (.字体.字体名称, ), 0))
    赋值 (.标题, .字体.字体名称)
.默认
    赋值 (.标题, 相加 (.字体.字体名称, “，ABCD1234”))
.判断结束
赋值 (.文本颜色, _启动窗口..)
赋值 (.字体大小, .字体.字体大小)
赋值 (.字体名称, .字体.字体名称)
赋值 (.下划线, .字体.下划线)
赋值 (.加粗, .字体.加粗)
赋值 (.倾斜, .字体.倾斜)
赋值 (.删除线, .字体.删除线)
.判断开始 (等于 (_启动窗口., 真))
    赋值 (.现行选中项, 0)
.默认
    赋值 (.现行选中项, 1)
.判断结束
赋值 (.现行选中项, _启动窗口.)
赋值 (.颜色, _启动窗口..)
赋值 (.现行选中项, _启动窗口.)
赋值 (.内容, _启动窗口.)

.子程序 _按钮_确定_被单击, 空白型, , 
赋值 (_启动窗口.., .文本颜色)
赋值 (_启动窗口.., .字体)
.判断开始 (等于 (.现行选中项, 0))
    赋值 (_启动窗口., 真)
.默认
    赋值 (_启动窗口., 假)
.判断结束
赋值 (_启动窗口., .现行选中项)
.判断开始 (等于 (_启动窗口., 0))
    赋值 (_启动窗口.., {  })
.判断 (等于 (_启动窗口., 1))
    赋值 (_启动窗口.., #爆炸声)
.判断 (等于 (_启动窗口., 2))
    赋值 (_启动窗口.., #碰撞)
.默认
    
.判断结束
赋值 (_启动窗口.., .颜色)
.判断开始 (并且 (不等于 (删首尾空 (.内容), “”), 等于 (文件是否存在 (.内容), 真)))
    赋值 (_启动窗口.., 读入文件 (删首尾空 (.内容)))
    赋值 (_启动窗口., 删首尾空 (.内容))
.默认
    赋值 (_启动窗口., “”)
    赋值 (_启动窗口.., {  })
.判断结束
赋值 (_启动窗口., .现行选中项)
销毁 ()


.子程序 _按钮_取消_被单击, 空白型, , 
销毁 ()


.子程序 _按钮2_被单击, 空白型, , 
.如果真 (打开 ())
    赋值 (.内容, .文件名)
.如果真结束


.子程序 _按钮_还原默认_被单击, 空白型, , 
赋值 (.现行选中项, 0)
赋值 (.现行选中项, 1)
赋值 (.现行选中项, 0)
赋值 (.颜色, #黑色)
赋值 (.字体.字体大小, 22)
赋值 (.字体.字体名称, “黑体”)
赋值 (.字体.下划线, 假)
赋值 (.字体.加粗, 真)
赋值 (.字体.倾斜, 假)
赋值 (.字体.删除线, 假)
赋值 (.标题, “黑体，ABCD1234”)
赋值 (.内容, “”)



 ' 不属于任何一个程序集、类模块的函数：
