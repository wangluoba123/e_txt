 ' 文件类型：Windows窗口程序

 ' 程序名称：Excel过滤器
 ' 程序描述：
 ' 程序作者：子涵工作室！
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：zihanworkroom@126.com
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 377
    高度 = 379
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 真
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “Excel过滤器 v1.0”
    帮助文件名 = “”



.图片 Data, " ' 已保存到：D:\易语言学习\Data\EXCEL.e\Data", , 
.常量 字母, "“ABCDEFGHIJKLMNOPQRSTUVWXYZ”", , 
.常量 密文, "“ZiHanWorkroom@126.com”", , 
.常量 数据库, "“Data”", , 
.常量 设置名称, "“设置名称”", , 
.常量 第一过滤列号, "“第一过滤列号”", , 
.常量 第一过滤值, "“第一过滤值”", , 
.常量 第二过滤, "“第二过滤”", , 
.常量 第二过滤列号, "“第二过滤列号”", , 
.常量 第二过滤值, "“第二过滤值”", , 
.常量 第三过滤, "“第三过滤”", , 
.常量 第三过滤列号, "“第三过滤列号”", , 
.常量 第三过滤值, "“第三过滤值”", , 
.常量 第四过滤, "“第四过滤”", , 
.常量 第四过滤列号, "“第四过滤列号”", , 
.常量 第四过滤值, "“第四过滤值”", , 
.常量 开始行数, "“开始行数”", , 
.常量 自动保存, "“自动保存”", , 
.常量 自动备份, "“自动备份”", , 
.常量 后台过滤, "“后台过滤”", , 
.常量 完成退出, "“完成退出”", , 
.常量 删除列号, "“删除列号”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' eExcel2000 F86EC5989E044d42BC98C692C0B54727 1 0 EXCEL2000支持库
 ' iext5 {E5000198-4471-40e2-92BC-D0BA075BDBB2} 1 2 扩展界面支持库五




.全局变量 重新创建, 逻辑型, , , 
.全局变量 选择区域对象, 对象, , , 
.全局变量 Excel对象, 对象, , , 
.全局变量 使用总行数, 整数型, , , 
.全局变量 行列对象, 对象, , , 
.全局变量 删除列号, 文本型, , "0", 
.全局变量 新增设置, 文本型, , "0", 
.全局变量 删除设置, 文本型, , "0", 
.全局变量 数据库文件名, 文本型, , , 

.DLL命令 消息, 整数型, "", "MessageBoxA", , 
    .参数 句柄, 整数型, , 
    .参数 内容, 文本型, , 
    .参数 标题, 文本型, , 
    .参数 按钮, 整数型, , 

.窗口程序集 启动窗口程序集, , , 

.程序集变量 表格对象, 对象, , , 
.程序集变量 工作簿对象, 对象, , , 
.程序集变量 范围对象, 对象, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
窗口位置设置 ()
调用Excel程序 ()
等待设置 (假)
赋值 (数据库文件名, 相加 (取运行目录 (), “\Data.db”))
读设置文件到组合框 ()
事件转移 () ' 将在三和四选择框上发生的事件转移到二选择框上
事件转移 ()
气球提示 ()

.子程序 窗口位置设置, 空白型, , 
赋值 (., 相减 (相加 (., 354), 取用户区高度 ())) ' 让界面适应所有操作系统
移动 (相减 (取屏幕宽度 (), .), 相减 (取屏幕高度 (), ., 34), , )
赋值 (_启动窗口., 真) ' 加速显示出界面

.子程序 等待设置, 空白型, , 
.参数 显示等待, 逻辑型, , 真＝显示，假＝不显示

连续赋值 (显示等待, .可视, .可视)
连续赋值 (取反 (显示等待), .可视, .可视, .可视, .可视)

.子程序 调用Excel程序, 空白型, , 
.如果真 (取反 (未知支持库函数_0 ())) ' 创建EXCEL程序，调用COM对象
    消息框 (“调用EXCEL的COM对象失败！可能是没有安装EXCEL的缘故，请检查！”, 16)
    __启动窗口_将被销毁 ()
    结束 ()
.如果真结束
赋值 (Excel对象, 未知支持库函数_2 ()) ' 取出excel.application对象
.未知支持库函数_6 () ' 将工作簿关联上EXCEL程序
未知支持库函数_15 () ' 关闭由置程序产生的BOOK1工作簿

.子程序 __启动窗口_将被销毁, 空白型, , 
.如果真 (.)
    .如果真 (等于 (消息框 (“退出程序时是否同时关闭已打开的Excel程序？”, 36), 6))
        未知支持库函数_4 ()
        未知支持库函数_3 ()
    .如果真结束
    
.如果真结束
Excel对象.清除 () ' 清除对象以释放内存
表格对象.清除 ()
行列对象.清除 ()
选择区域对象.清除 ()

.子程序 读设置文件到组合框, 空白型, , 
.局部变量 节名, 文本型, , "0", 
.局部变量 计次, 整数型, , , 

.如果真 (文件是否存在 (数据库文件名))
    .如果 (打开 (数据库文件名, #数据库, , , , #密文, ))
        清空 ()
        “临时设置”.加入项目 ()
        .计次循环首 (取记录数 (), 计次)
            读数据库文本值 (#设置名称, 计次).加入项目 ()
        .计次循环尾 ()
        赋值 (.现行选中项, 0)
    .否则
        .如果真 (等于 (消息框 (“保存设置的文件读取错误，是否重新建立？”, 33), 1))
            写到文件 (数据库文件名, #Data)
            打开 (数据库文件名, #数据库, , , , #密文, )
        .如果真结束
        
    .如果结束
    
.如果真结束


.子程序 气球提示, 空白型, , 
.未知支持库函数_20 (“打开一个需要过滤的Excel文件！”, -1, , , , )
.未知支持库函数_20 (“可选择不同的设置，如果临时使用请选择‘临时设置’！”, -1, , , , )
.未知支持库函数_20 (“新增一个设置项目，保存对此类文件的设置！”, -1, , , , )
.未知支持库函数_20 (“删除被选中的设置项目！”, -1, , , , )
.未知支持库函数_20 (“欲对其过滤的列号，例：E 即对‘E’列进行操作！”, -1, , , , )
.未知支持库函数_20 (“过滤对应列时的条件值，满足此条件时再对比其他条件，都满足时，即删除所在的行！”, -1, , , , )
.未知支持库函数_20 (“第二个条件列，与第一条件列成‘并且’的关系，即两个条件同时都满足时，删除所在的行！”, -1, , , , )
.未知支持库函数_20 (“欲对其过滤的列号，例：F 即对‘F’列进行操作！”, -1, , , , )
.未知支持库函数_20 (“过滤对应列时的条件值，满足此条件时再对比其他条件，都满足时，即删除所在的行！”, -1, , , , )
.未知支持库函数_20 (“第三个条件列，与第一、第二条件列成‘并且’的关系，即两个条件同时都满足时，删除所在的行！”, -1, , , , )
.未知支持库函数_20 (“欲对其过滤的列号，例：G 即对‘G’列进行操作！”, -1, , , , )
.未知支持库函数_20 (“过滤对应列时的条件值，满足此条件时再对比其他条件，都满足时，即删除所在的行！”, -1, , , , )
.未知支持库函数_20 (“第四个条件列，与第一、第二、第三条件列成‘并且’的关系，即两个条件同时都满足时，删除所在的行！”, -1, , , , )
.未知支持库函数_20 (“欲对其过滤的列号，例：H 即对‘H’列进行操作！”, -1, , , , )
.未知支持库函数_20 (“过滤对应列时的条件值，满足此条件时再对比其他条件，都满足时，即删除所在的行！”, -1, , , , )
.未知支持库函数_20 (“保存新增、删除或修改的设置！”, -1, , , , )
.未知支持库函数_20 (“过滤后删除不想存在的列！”, -1, , , , )
.未知支持库函数_20 (“添加要删除的列号到添加框中！即删除此列”, -1, , , , )
.未知支持库函数_20 (“删除条件框中的条件！即不删除此列”, -1, , , , )
.未知支持库函数_20 (“从表格的第几行开始过滤！”, -1, , , , )
.未知支持库函数_20 (“过滤完成后自动保存文件！”, -1, , , , )
.未知支持库函数_20 (“过滤前先备份一份文件，文件名以‘过滤备份_’开始！”, -1, , , , )
.未知支持库函数_20 (“不显示出Excel程序，如果表格中的记录数量太多，建议启用此功能，这将提高过滤的速度！”, -1, , , , )
.未知支持库函数_20 (“过滤完毕后自动退出此程序！”, -1, , , , )

.子程序 _浏览钮_被单击, 空白型, , 
.局部变量 使用总行数, 整数型, , , 

赋值 (.类型, 0)
赋值 (.过滤器, “*.xls|*.xls”)
等待设置 (真)
.如果真 (取反 (打开 ()))
    等待设置 (假)
    返回 ()
.如果真结束
.如果真 (重新创建)
    调用Excel程序 ()
.如果真结束
赋值 (.标题, .文件名)
.如果真 (取反 (.未知支持库函数_14 (.标题))) ' 打开EXCEL文件
    消息框 (“EXCEL文件打开失败，可能是文件损坏，请更换文件再执行！”, 48)
    等待设置 (假)
    返回 ()
.如果真结束
赋值 (., 真) ' 显示出表格
赋值 (., 1) ' 设置表格的工作簿为第一工作簿
读取对象属性 ()
等待设置 (假)

.子程序 读取对象属性, 空白型, , 
.局部变量 行对象, 对象, , , 
.局部变量 列对象, 对象, , , 
.局部变量 使用总列数, 整数型, , , 

赋值 (工作簿对象, 未知支持库函数_10 ())
赋值 (表格对象, 未知支持库函数_12 ())
赋值 (范围对象, 表格对象.读对象型属性 (“UsedRange”, ))
赋值 (行对象, 范围对象.读对象型属性 (“Rows”, ))
赋值 (使用总行数, 行对象.读数值属性 (“Count”, ))
赋值 (列对象, 范围对象.读对象型属性 (“Columns”, ))
赋值 (使用总列数, 列对象.读数值属性 (“Count”, ))
赋值 (.最大位置, 使用总行数)

.子程序 _开始钮_被单击, 空白型, , 
.局部变量 列号, 文本型, , "0", 
.局部变量 过滤值, 文本型, , "0", 

.如果真 (等于 (.标题, “”))
    消息框 (“还没有打开文件，请先打开要过滤的Excel文件！”, 64)
    返回 ()
.如果真结束
.如果真 (检查输入内容 (“一”))
    返回 ()
.如果真结束
加入成员 (列号, .内容)
加入成员 (过滤值, .内容)
.如果真 (.选中)
    .如果真 (检查输入内容 (“二”))
        返回 ()
    .如果真结束
    加入成员 (列号, .内容)
    加入成员 (过滤值, .内容)
.如果真结束
.如果真 (.选中)
    .如果真 (检查输入内容 (“三”))
        返回 ()
    .如果真结束
    加入成员 (列号, .内容)
    加入成员 (过滤值, .内容)
.如果真结束
.如果真 (.选中)
    .如果真 (检查输入内容 (“四”))
        返回 ()
    .如果真结束
    加入成员 (列号, .内容)
    加入成员 (过滤值, .内容)
.如果真结束
.如果真 (并且 (大于 (.最大位置, 500), 等于 (.选中, 假)))
    .如果真 (等于 (消息框 (相加 (“该文件总计有‘”, 到文本 (.最大位置), “’行记录，建议启用‘后台过滤’功能，这将提高过滤速度！”, #换行符, #换行符, “是否启用‘后台过滤’功能？”), 36), 6))
        赋值 (.选中, 真)
    .如果真结束
    
.如果真结束
.如果真 (.选中)
    复制文件 (.标题, 相加 (工作簿对象.读文本属性 (“Path”, ), “\过滤备份_”, 工作簿对象.读文本属性 (“Name”, )))
.如果真结束
赋值 (., 取反 (.选中))
消息框 (相加 (“程序执行完毕！执行结果如下：”, #换行符, #换行符, “共计过滤行数： ”, 到文本 (过滤删除行 (列号, 过滤值)), “ /行！”, #换行符, “共计过滤列数： ”, 到文本 (过滤删除列 ()), “ /列”), 64)
.如果真 (.选中)
    工作簿对象.方法 (“Save”, )
.如果真结束
清除数据 (真)
赋值 (.现行选中项, 0)
.如果 (.选中)
    Excel对象.方法 (“Quit”, )
    销毁 ()
.否则
    .如果真 (取反 (_启动窗口..))
        赋值 (_启动窗口.., 真)
    .如果真结束
    
.如果结束


.子程序 _退出钮_被单击, 空白型, , 
_启动窗口.销毁 ()

.子程序 _添列号钮_被单击, 空白型, , 
.局部变量 计次变量, 整数型, , , 

.如果真 (等于 (.内容, “”))
    消息框 (“未填入有效列号，请正确填入要删除的列号！”, 48)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (或者 (小于 (取代码 (.内容, ), 65), 大于 (取代码 (.内容, ), 90)))
    消息框 (“输入的列号无效，请对应Excel文件中相应的列输入！”, 48)
    获取焦点 ()
    赋值 (.被选择字符数, -1)
    返回 ()
.如果真结束
.计次循环首 (取数组成员数 (删除列号), 计次变量)
    .如果真 (等于 (.内容, 删除列号 [计次变量]))
        消息框 (“此列号已在列表中，不要重复添加！”, 48)
        获取焦点 ()
        赋值 (.被选择字符数, -1)
        返回 ()
    .如果真结束
    
.计次循环尾 ()
相加 (“欲删除的列号： ”, .内容).加入项目 ()
删除列排序 ()
赋值 (.内容, “”)
获取焦点 ()

.子程序 删除列排序, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 项目文本, 文本型, , , 

清除数组 (删除列号)
.计次循环首 (取项目数 (), 计次)
    赋值 (项目文本, 相减 (计次, 1).取项目文本 ())
    加入成员 (删除列号, 取文本右边 (项目文本, 相减 (取文本长度 (项目文本), 15)))
.计次循环尾 ()

.子程序 _删列号钮_被单击, 空白型, , 
.如果真 (小于 (.现行选中项, 0))
    消息框 (“未选择要放弃删除的列号，请重新选择！”, 64)
    返回 ()
.如果真结束
.删除项目 (.现行选中项)
删除列排序 ()

.子程序 清除数据, 空白型, , 
.参数 清除打开的文件, 逻辑型, , 真＝清除，假＝不清除

赋值 (.位置, 0)
连续赋值 (假, .选中, .选中, .选中, .选中, .选中, .选中, .选中)
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
连续赋值 (#浅灰, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
清空 ()
.如果真 (清除打开的文件)
    赋值 (.标题, “”)
.如果真结束
赋值 (.内容, “1”)
清除数组 (删除列号)

.子程序 _设置组框_列表项被选择, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 本项记录号, 整数型, , , 

清除数据 (假)
.如果真 (等于 (.现行选中项, 0))
    返回 ()
.如果真结束
赋值 (本项记录号, 查询记录 (.内容))
赋值 (.内容, 读数据库文本值 (#第一过滤列号, 本项记录号))
赋值 (.内容, 读数据库文本值 (#第一过滤值, 本项记录号))
赋值 (.选中, 读数据库逻辑值 (#第二过滤, 本项记录号))
.如果真 (.选中)
    设置选择框 ()
    赋值 (.内容, 读数据库文本值 (#第二过滤列号, 本项记录号))
    赋值 (.内容, 读数据库文本值 (#第二过滤值, 本项记录号))
.如果真结束
赋值 (.选中, 读数据库逻辑值 (#第三过滤, 本项记录号))
.如果真 (.选中)
    设置选择框 ()
    赋值 (.内容, 读数据库文本值 (#第三过滤列号, 本项记录号))
    赋值 (.内容, 读数据库文本值 (#第三过滤值, 本项记录号))
.如果真结束
赋值 (.选中, 读数据库逻辑值 (#第四过滤, 本项记录号))
.如果真 (.选中)
    设置选择框 ()
    赋值 (.内容, 读数据库文本值 (#第四过滤列号, 本项记录号))
    赋值 (.内容, 读数据库文本值 (#第四过滤值, 本项记录号))
.如果真结束
赋值 (.内容, 读数据库文本值 (#开始行数, 本项记录号))
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “1”)
.如果真结束
赋值 (.选中, 读数据库逻辑值 (#自动保存, 本项记录号))
赋值 (.选中, 读数据库逻辑值 (#自动备份, 本项记录号))
赋值 (.选中, 读数据库逻辑值 (#后台过滤, 本项记录号))
赋值 (.选中, 读数据库逻辑值 (#完成退出, 本项记录号))
赋值 (删除列号, 分割文本 (读数据库文本值 (#删除列号, 本项记录号), “$”, ))
.计次循环首 (取数组成员数 (删除列号), 计次)
    相加 (“欲删除第 ”, 到大写 (删除列号 [计次]), “ 列”).加入项目 ()
.计次循环尾 ()

.子程序 _删除设置钮_被单击, 空白型, , 
.如果真 (等于 (.现行选中项, 0))
    消息框 (相加 (#左引号, “临时设置”, #右引号, “是为临时使用时设置的，不可删除！”), 64)
    返回 ()
.如果真结束
.如果真 (等于 (消息框 (相加 (“确定要删除”, #左引号, .内容, #右引号, “设置吗？”), 33), 2))
    返回 ()
.如果真结束
加入成员 (删除设置, .内容)
.删除项目 (.现行选中项)
赋值 (.现行选中项, 0)
清除数据 (假)

.子程序 _新增设置钮_被单击, 空白型, , 
.局部变量 新增配置名, 文本型, , , 
.局部变量 计次, 整数型, , , 

.如果真 (输入框 (“请输入新增设置的项目名：”, “子涵工作室！”, , 新增配置名, ))
    .计次循环首 (取项目数 (), 计次)
        .如果真 (等于 (新增配置名, 相减 (计次, 1).取项目文本 ()))
            消息框 (“新增设置的项目名和已有名称重复，请重新输入！”, 48)
            _新增设置钮_被单击 ()
            返回 ()
        .如果真结束
        
    .计次循环尾 ()
    加入成员 (新增设置, 新增配置名)
    赋值 (.现行选中项, 新增配置名.加入项目 ())
    清除数据 (假)
.如果真结束


.子程序 _保存设置钮_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 新记录, 逻辑型, , , 真为已经加了的新记录，假

.如果真 (取反 (文件是否存在 (数据库文件名)))
    写到文件 (数据库文件名, #Data)
.如果真结束
.如果真 (取反 (是否已打开 (数据库文件名)))
    打开 (数据库文件名, #数据库, , , , #密文, )
.如果真结束
.计次循环首 (取数组成员数 (删除设置), 计次)
    .如果真 (不等于 (查询记录 (删除设置 [计次]), -1))
        删除 ()
    .如果真结束
    
.计次循环尾 ()
.如果真 (大于 (取数组成员数 (删除设置), 0))
    彻底删除 ()
.如果真结束
.计次循环首 (取数组成员数 (新增设置), 计次)
    .如果 (等于 (新增设置 [计次], .内容))
        加记录 (新增设置 [计次], .内容, .内容, .选中, .内容, .内容, .选中, .内容, .内容, .选中, .内容, .内容, .内容, .选中, .选中, .选中, .选中, 格式化删除文本 ())
        赋值 (新记录, 真)
    .否则
        加记录 (新增设置 [计次])
    .如果结束
    
.计次循环尾 ()
清除数组 (新增设置)
.如果真 (并且 (大于 (.现行选中项, 0), 取反 (新记录)))
    .如果真 (不等于 (查询记录 (.内容), -1))
        修改 (.内容, .内容, .内容, .选中, .内容, .内容, .选中, .内容, .内容, .选中, .内容, .内容, .内容, .选中, .选中, .选中, .选中, 格式化删除文本 ())
    .如果真结束
    
.如果真结束


.子程序 _二列选框_被单击, 空白型, , 
.局部变量 事件选择框, 选择框, , , 

赋值 (事件选择框, 取事件组件 ())
设置选择框 (事件选择框)

.子程序 设置选择框, 空白型, , 
.参数 选择框, 选择框, , 

.局部变量 号框, 编辑框, , , 
.局部变量 值框, 编辑框, , , 

赋值 (号框, 多项选择 (到数值 (选择框.标记), , , ))
赋值 (值框, 多项选择 (到数值 (选择框.标记), , , ))
连续赋值 (取反 (选择框.选中), 号框.禁止, 值框.禁止)
连续赋值 (“”, 号框.内容, 值框.内容)
连续赋值 (选择 (选择框.选中, #白色, #浅灰), 号框.背景颜色, 值框.背景颜色)
号框.获取焦点 ()

.子程序 _Excel程序_工作簿即将关闭, 空白型, , 
.参数 工作簿对象, 对象, , 
.参数 取消关闭, 逻辑型, 参考, 

.如果 (不等于 (., “Microsoft Excel - Book1”))
    赋值 (重新创建, 真)
    清除数据 (真)
    赋值 (.现行选中项, 0)
    未知支持库函数_3 ()
.否则
    赋值 (重新创建, 假)
.如果结束


.子程序 _选择夹_子夹被改变, 空白型, , 
.如果真 (等于 (.现行子夹, 2))
    _启动窗口.未知支持库函数_26 (., 取鼠标水平位置 (), 取鼠标垂直位置 (), “<font size=22 color=Green>            子涵工作室！</font><br><hr color=red><br>联系作者：<a href=mailto:ZiHanWorkroom@126.com> 电子邮箱：ZiHanWorkroom@126.com</a><br>　　　　　　  OICQ：9596173</a>”, 0, )
.如果真结束


.程序集 功能程序集, , , 

.子程序 消息框, 整数型, , 
.参数 内容, 文本型, , 
.参数 按钮, 整数型, , 

返回 (消息 (_启动窗口.取窗口句柄 (), 内容, “子涵工作室！”, 按钮))

.子程序 设置单元格, 空白型, , 
.参数 单元格, 文本型, , 

连续赋值 (单元格, _启动窗口.., _启动窗口..)
_启动窗口.未知支持库函数_28 (.)

.子程序 读单元格内容, 文本型, , 
.参数 单元格, 文本型, , 

设置单元格 (单元格)
返回 (_启动窗口..)

.子程序 删除行, 空白型, , 
赋值 (选择区域对象, Excel对象.读对象型属性 (“Selection”, ))
赋值 (行列对象, 选择区域对象.读对象型属性 (“EntireRow”, ))
行列对象.通用方法 (“Delete”, )

.子程序 删除列, 空白型, , 
赋值 (选择区域对象, Excel对象.读对象型属性 (“Selection”, ))
赋值 (行列对象, 选择区域对象.读对象型属性 (“EntireColumn”, ))
行列对象.通用方法 (“Delete”, )

.子程序 检查输入内容, 逻辑型, , 假＝有内容，真=没有内容
.参数 编辑框1, 编辑框, , 
.参数 编辑框2, 编辑框, , 
.参数 号数, 文本型, , 

.如果真 (等于 (删首尾空 (编辑框1.内容), “”))
    消息框 (相加 (“已选择了过滤的第”, 号数, “列，请输入第”, 号数, “过滤的列号！如：G”), 64)
    编辑框1.获取焦点 ()
    返回 (真)
.如果真结束
.如果真 (或者 (小于 (取代码 (编辑框1.内容, ), 65), 大于 (取代码 (编辑框1.内容, ), 90)))
    消息框 (“输入的列号无效，请对应Excel文件中相应的列输入！”, 48)
    编辑框1.获取焦点 ()
    赋值 (编辑框1.被选择字符数, -1)
    返回 (真)
.如果真结束
.如果真 (等于 (删首尾空 (编辑框2.内容), “”))
    消息框 (相加 (“已选择了过滤的第”, 号数, “列，请输入欲过滤的值！如：”, #左引号, “0”, #右引号), 64)
    编辑框2.获取焦点 ()
    返回 (真)
.如果真结束
返回 (假)

.子程序 取表格列数, 整数型, , 
.局部变量 计次, 整数型, , , 
.局部变量 延长值, 整数型, , , 

.循环判断首 ()
    .如果真 (等于 (读单元格内容 (相加 (取文本中间 (#字母, 相加 (计次, 1), 1), “1”)), “”))
        赋值 (延长值, 相加 (延长值, 1))
    .如果真结束
    赋值 (计次, 相加 (计次, 1))
.循环判断尾 (小于 (延长值, 4))
设置单元格 (“A1”)
返回 (相减 (计次, 延长值))

.子程序 过滤删除行, 整数型, , 返回共删除多少行
.参数 条件文本, 文本型, 数组, 
.参数 过滤文本, 文本型, 数组, 

.局部变量 行数, 整数型, , , 
.局部变量 总数计次, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 相等, 逻辑型, , "4", 
.局部变量 删除行数, 整数型, , , 
.局部变量 延长值, 整数型, , , 

.如果 (等于 (_启动窗口..内容, “”))
    赋值 (行数, 1)
.否则
    赋值 (行数, 到数值 (_启动窗口..内容))
.如果结束
.计次循环首 (使用总行数, 总数计次)
    处理事件 ()
    .计次循环首 (取数组成员数 (条件文本), 计次)
        .如果 (等于 (读单元格内容 (相加 (条件文本 [计次], 到文本 (行数))), 过滤文本 [计次]))
            赋值 (相等 [计次], 真)
        .否则
            赋值 (相等 [计次], 假)
        .如果结束
        
    .计次循环尾 ()
    .如果 (多项选择 (相减 (计次, 1), 相等 [1], 并且 (相等 [1], 相等 [2]), 并且 (相等 [1], 相等 [2], 相等 [3]), 并且 (相等 [1], 相等 [2], 相等 [3], 相等 [4])))
        删除行 ()
        赋值 (删除行数, 相加 (删除行数, 1))
    .否则
        赋值 (行数, 相加 (行数, 1))
    .如果结束
    赋值 (_启动窗口..位置, 总数计次)
.计次循环尾 ()
返回 (删除行数)

.子程序 过滤删除列, 整数型, , 返回共删除多少列
.局部变量 计次, 整数型, , , 

.如果 (大于 (取数组成员数 (删除列号), 0))
    .计次循环首 (取数组成员数 (删除列号), 计次)
        设置单元格 (相加 (前移列号 (删除列号 [计次], 相减 (计次, 1)), “1”))
        删除列 ()
    .计次循环尾 ()
    返回 (相减 (计次, 1))
.否则
    返回 (0)
.如果结束


.子程序 前移列号, 文本型, , 
.参数 当前字符, 文本型, , 
.参数 推进位, 整数型, , 

.如果真 (等于 (当前字符, “A”))
    返回 (当前字符)
.如果真结束
返回 (字符 (到字节 (相减 (取代码 (当前字符, ), 推进位))))

.子程序 读数据库文本值, 文本型, , 
.参数 匿名参数_896, 空白型, , 
.参数 字段, 文本型, , 
.参数 记录号, 整数型, , 

到首记录 ()
跳到 (记录号)
返回 (读 (字段))

.子程序 读数据库逻辑值, 逻辑型, , 
.参数 字段, 文本型, , 
.参数 记录号, 整数型, , 

到首记录 ()
跳到 (记录号)
返回 (读 (字段))

.子程序 查询记录, 整数型, , 返回查询到记录号,未找到返回-1
.参数 条件文本, 文本型, , 

到首记录 ()
.如果 (查找 (等于 (读 (#设置名称), 条件文本)))
    返回 (取记录号 ())
.否则
    返回 (-1)
.如果结束


.子程序 格式化删除文本, 文本型, , 
.局部变量 文本, 文本型, , , 
.局部变量 计次, 整数型, , , 

.计次循环首 (取数组成员数 (删除列号), 计次)
    赋值 (文本, 相加 (文本, 删除列号 [计次], “$”))
.计次循环尾 ()
返回 (文本)


 ' 不属于任何一个程序集、类模块的函数：
