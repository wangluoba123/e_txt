 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口
    左边 = 50
    顶边 = 50
    宽度 = 396
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “例程：利用i吧 实现自动更新等功能 - By：NowAnt”
    帮助文件名 = “”



.常量 正则_取回复, "“楼</p><pclass="thread_content">(.*?)</p>”", , 
.常量 , , , 
.常量 PROV_RSA_FULL, "1", , 
.常量 CRYPT_NEWKEYSET, "8", , 
.常量 ALG_TYPE_ANY, "0", , 
.常量 ALG_SID_MD2, "1", , 
.常量 ALG_SID_MD4, "2", , 
.常量 ALG_SID_MD5, "3", , 
.常量 ALG_SID_SHA1, "4", , 
.常量 HP_HASHVAL, "2", , 散列值
.常量 HP_HASHSIZE, "4", , 散列值长度
.常量 CRYPT_VERIFYCONTEXT, "-268435456", , 
.常量 CRYPT_MACHINE_KEYSET, "32", , 
.常量 MS_DEF_PROV, "“Microsoft Base Cryptographic Provider v1.0”", , 
.常量 ALG_CLASS_HASH, "32768", , 
.常量 CALG_MD2, "32769", 公开, 
.常量 CALG_MD4, "32770", 公开, 
.常量 CALG_MD5, "32771", 公开, 
.常量 CALG_SHA1, "32772", 公开, 
.常量 PBM_SETPOS, "1026", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' RegEx 684944CB04624eb7BD5412A519421D34 2 0 正则表达式支持库



 ' 所需要的模块
 ' 七号内存配置项 C:\Documents and Settings\wodesoft-dj\桌面\利用i吧更新程序配置\内存配置项.ec
 ' 新编码转换大全 C:\Documents and Settings\wodesoft-dj\桌面\利用i吧更新程序配置\新编码转换大全v4.1.ec
 ' HTTP访问模块 路过已错过 第三次修正 完美终结版 C:\Documents and Settings\wodesoft-dj\桌面\利用i吧更新程序配置\Http访问模块.ec



.DLL命令 CryptAcquireContext, 逻辑型, "advapi32.dll", "CryptAcquireContextA", , 获取一个CSP(加密服务提供者)句柄，要进行加密解密操作的话，必须调用该函数。最后还要使用CryptReleaseContext 函数来释放CSP句柄。若成功，返回TRUE,否则返回FALSE,可调用GetLastError（）来获取错误代码
    .参数 PhProv, 整数型, 传址, 返回CSP句柄
    .参数 PszContainer, 整数型, , 关键字容器的名字。当 dwFlags 被设为 CRYPT_VERIFYCONTEXT 时， pszContainer 必须被设为 0。一般 pszContainer 为NULL时，一个缺省钥匙容器名字被使用
    .参数 pszProvider, 文本型, , 指定的CSP提供者的名字，是以0结尾的字符串，若为NULL，则使用缺省CSP
    .参数 dwProvType, 整数型, , 指定CSP提供者的类型,MD5取PROV_RSA_FULL
    .参数 dwFlags, 整数型, , 标志,多设置为0,CRYPT_VERIFYCONTEXT or CRYPT_MACHINE_KEYSET

.DLL命令 CryptCreateHash, 逻辑型, "advapi32.dll", "", , 创建哈希(加密)句柄
    .参数 hProv, 整数型, , CSP句柄,可以由函数CryptAcquireContext获取
    .参数 Algid, 整数型, , 选择hash算法，比如CALG_MD5等
    .参数 hKey, 整数型, , HMAC 和MAC算法时有用
    .参数 dwFlags, 整数型, , 保留，传入0即可
    .参数 phHash, 整数型, 传址, 返回哈希句柄

.DLL命令 CryptHashData, 逻辑型, "advapi32.dll", "", , 载入哈希数据
    .参数 hHash, 整数型, , 哈希句柄
    .参数 pbData, 字节集, 传址, 数据地址
    .参数 dwDataLen, 整数型, , 数据长度
    .参数 dwFlags, 整数型, , 标志，设为0

.DLL命令 CryptGetHashSize, 逻辑型, "advapi32.dll", "CryptGetHashParam", , 获得哈希值(二进制)
    .参数 hHash, 整数型, , 哈希句柄
    .参数 dwType, 整数型, , 获取类型
    .参数 pbBuff, 整数型, 传址, 缓存地址
    .参数 dwBuffLen, 整数型, 传址, 缓存长度
    .参数 dwFlags, 整数型, , 标志，设为0

.DLL命令 CryptGetHashParam, 逻辑型, "advapi32.dll", "", , 获得哈希值(二进制)
    .参数 hHash, 整数型, , 哈希句柄
    .参数 dwType, 整数型, , 获取类型
    .参数 pbBuff, 字节集, 传址, 缓存地址
    .参数 dwBuffLen, 整数型, 传址, 缓存长度
    .参数 dwFlags, 整数型, , 标志，设为0

.DLL命令 CryptDestroyHash, 逻辑型, "advapi32.dll", "", , 释放哈希句柄
    .参数 hHash, 整数型, , 哈希句柄

.DLL命令 CryptReleaseContext, 逻辑型, "advapi32.dll", "", , 释放CSP
    .参数 hProv, 整数型, , CSP句柄
    .参数 dwFlags, 整数型, , 标志，设为0

.DLL命令 SendMessage, 空白型, "", "SendMessageA", , 
    .参数 h, 整数型, , 
    .参数 w, 整数型, , 
    .参数 a, 整数型, , 
    .参数 b, 整数型, , 

.DLL命令 ShellExecuteA, 整数型, "", "ShellExecuteA", , 执行命令
    .参数 hwnd, 整数型, , 
    .参数 lpOperation, 文本型, , 
    .参数 lpFile, 文本型, , 
    .参数 lpParameters, 文本型, , 
    .参数 lpDirectory, 文本型, , 
    .参数 nShowCmd, 短整数型, , 

.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

 ' 编辑框_密码.内容 ＝ 生成密钥 ()

.子程序 _按钮_加密_被单击, 空白型, , 
赋值 (.内容, 文本加密 (.内容, .内容))

.子程序 _按钮_解密_被单击, 空白型, , 
赋值 (.内容, 文本解密 (.内容, .内容))

.子程序 _按钮_测试_被单击, 空白型, , ★
.局部变量 返回文本, 文本型, , , 
.局部变量 匹配结果, 文本型, , "0", 
.局部变量 i, 整数型, , , 

 ' 只会匹配i贴吧一楼之后的回复，可在一楼写上些东西，比如，放个51啦统计的图片，但不要放过多内容，以免影响读取速度
 ' 每次更新先设置允许回复，回复完加密内容后再删除旧的楼层，并设置为不可回复。
 ' 支持读取多个回复，但建议各楼层的内容不要相同，并且更新后把旧的回复删掉。
 ' 本源码来自易语言资源网(www.5A5X.com)
赋值 (返回文本, 到文本 (访问网页 (.内容)))
赋值 (返回文本, 删全部空 (返回文本))
赋值 (返回文本, 子文本替换 (返回文本, 字符 (13), , , , 真)) ' 回车符
赋值 (返回文本, 子文本替换 (返回文本, 字符 (10), , , , 真)) ' 换行符
赋值 (返回文本, 子文本替换 (返回文本, 字符 (9), , , , 真)) ' 制表符
正则搜索 (返回文本, #正则_取回复, 匹配结果)
连续赋值 (“”, .内容, .内容)
.计次循环首 (取数组成员数 (匹配结果), i)
    匹配结果.加入文本 ( [i])
.计次循环尾 ()
赋值 (.内容, 文本解密 (.内容, .内容))
解析配置 ()

.子程序 解析配置, 空白型, , ★
.局部变量 内存配置, 内存配置项, , , 
.局部变量 临时1, 文本型, , , 
.局部变量 临时2, 文本型, , , 

内存配置.从内存中加载 (.内容)
赋值 (临时1, 内存配置.读内存配置项 (“其他配置”, “图片地址”))
.如果真 (不等于 (0, 取文本长度 (临时1))) ' 如果长度为0表示不执行此操作。
    赋值 (.图片, 访问网页 (临时1))
.如果真结束
 ' 本源码来自易语言资源网(www.5A5X.com)
赋值 (临时1, 内存配置.读内存配置项 (“版本控制”, “最新版本”))
.如果真 (不等于 (0, 取文本长度 (临时1)))
    .如果 (等于 (临时1, .内容))
         ' 版本相同，可以用MD5效验程序是否完整。运行已编译的程序并把版本号改为12042可以看到效果
        赋值 (临时1, 内存配置.读内存配置项 (“版本控制”, “ＭＤ５值”))
        .如果真 (不等于 (0, 取文本长度 (临时1)))
            赋值 (临时2, 数据_取文件数据摘要 (取执行文件名 (), #CALG_MD5))
            .如果 (不等于 (临时1, 临时2))
                信息框 (“程序文件遭破坏，请重新下载安装！”, #错误图标, “错误”)
                结束 ()
            .否则
                信息框 (“程序文件效验通过。”, #信息图标, “提示”)
            .如果结束
            
        .如果真结束
        
    .否则
         ' 版本不同，根据配置决定是否提示更新
        赋值 (临时1, 内存配置.读内存配置项 (“版本控制”, “新版提示”))
        赋值 (临时2, 内存配置.读内存配置项 (“版本控制”, “强制更新”))
        .如果 (并且 (不等于 (0, 取文本长度 (临时2)), 等于 (到整数 (临时2), 1)))
             ' 强制更新
            信息框 (临时1, #信息图标, “更新”)
            执行指定命令 (内存配置.读内存配置项 (“版本控制”, “更新链接”))
            返回 ()
        .否则
             ' 不强制更新
            .如果真 (等于 (#是钮, 信息框 (相加 (临时1, #换行符, “是否更新？”), 相加 (#是否钮, #询问图标), “更新”)))
                执行指定命令 (内存配置.读内存配置项 (“版本控制”, “更新链接”))
                返回 ()
            .如果真结束
             ' 本源码来自易语言资源网(www.5A5X.com)
        .如果结束
        
    .如果结束
    
    
.如果真结束

赋值 (临时1, 内存配置.读内存配置项 (“公告控制”, “显示公告”))
.如果真 (不等于 (0, 取文本长度 (临时1)))
    赋值 (临时1, 内存配置.读内存配置项 (“公告控制”, “公告内容”))
    信息框 (临时1, #信息图标, “公告”)
.如果真结束

 ' [版本控制]
 ' 最新版本=12042
 ' ＭＤ５值=
 ' 强制更新=0
 ' 新版提示=新版本已发布，请及时更新！
 ' 更新链接=http://www.baidu.com

 ' [公告控制]
 ' 显示公告=1
 ' 公告内容=Hello World！
 ' [其他配置]
 ' 图片地址=

.子程序 _按钮_取自身MD5_被单击, 空白型, , 
置剪辑板文本 (数据_取文件数据摘要 (取执行文件名 (), #CALG_MD5))
信息框 (“程序自身MD5值已复制到剪辑版”, #信息图标, “提示”)


.子程序 数据_取文件数据摘要, 文本型, 公开, 返回指定文件的数据摘要,如果获取失败将返回空文本，本命令为初级命令。
.参数 文件名, 文本型, , 欲取其数据摘要的文件名。
.参数 算法类型, 整数型, 可空, 欲取其数据摘要的算法类型，默认采用MD5算法，有4个选项，1：#CALG_MD2 表示采用MD2编码;2：#CALG_MD4 ,表示采用MD4编码,3：#CALG_MD5, 表示采用MD5编码;4：#CALG_SHA1，表示采用SHA1编码，其他编码请查询MSDN。
.参数 进度条句柄, 整数型, 可空, 本参数实现进度条百分比显示，可以由命令“进度条.取窗口句柄()”获取；
.参数 分块大小, 整数型, 可空, 此参数设置每次读取文件的大小，默认为10M，即1024的10*1024*1024；

.局部变量 hCtx, 整数型, , , 
.局部变量 返回, 逻辑型, , , 
.局部变量 hProv, 整数型, , , CSP句柄
.局部变量 hHash, 整数型, , , 哈希句柄
.局部变量 bHash, 字节集, , , 
.局部变量 i, 整数型, , , 
.局部变量 临时文本, 文本型, , , 
.局部变量 dwBufferSize, 整数型, , , 
.局部变量 flen, 整数型, , , 
.局部变量 hFile, 整数型, , , 
.局部变量 len, 整数型, , , 
.局部变量 buf, 字节集, , , 


 ' ' '试图获取缺省的密钥容器
赋值 (返回, CryptAcquireContext (hProv, 0, #MS_DEF_PROV, #PROV_RSA_FULL, 相加 (#CRYPT_VERIFYCONTEXT, #CRYPT_MACHINE_KEYSET)))
.如果真 (取反 (返回))
     ' 输出调试文本 (“模块_取数据摘要:获取缺省的密钥容器失败！”)
     ' 若失败,就创建一个缺省密钥容器
    赋值 (返回, CryptAcquireContext (hProv, 0, #MS_DEF_PROV, #PROV_RSA_FULL, 相加 (#CRYPT_NEWKEYSET, #CRYPT_MACHINE_KEYSET)))
    .如果真 (取反 (返回))
        输出调试文本 (“模块_取文件摘要:创建密钥容器失败！”)
        返回 (“”)
    .如果真结束
     ' 本源码来自易语言资源网(www.5A5X.com)
.如果真结束
 ' 输出调试文本 (“CSP句柄=” ＋ 到文本 (hProv))
 ' 创建散列句柄
.如果真 (是否为空 (算法类型))
    赋值 (算法类型, #CALG_MD5)
.如果真结束
赋值 (返回, CryptCreateHash (hProv, 算法类型, 0, 0, hHash))
.如果真 (取反 (返回))
    输出调试文本 (“模块_取文件摘要:创建散列句柄失败！”)
    CryptReleaseContext (hProv, 0)
    返回 (“”)
.如果真结束

赋值 (hFile, 打开文件 (到文本 (文件名), #读入, ))
 ' 输出调试文本 (到文本 (数据或文件名), hFile)
.如果真 (不等于 (hFile, 0))
    赋值 (flen, 取文件长度 (hFile))
    .判断循环首 (是否在文件尾 (flen, ))
        .如果真 (是否为空 (分块大小))
            赋值 (分块大小, 相乘 (1024, 1024, 10))
        .如果真结束
        赋值 (buf, 读入字节集 (hFile, 分块大小))
        赋值 (len, 取字节集长度 (buf))
        .如果真 (等于 (buf, {  }))
            跳出循环 ()
        .如果真结束
        .如果真 (取反 (CryptHashData (hHash, buf, len, 0)))
            跳出循环 ()
        .如果真结束
        赋值 (i, 相加 (i, len))
        .如果真 (不等于 (进度条句柄, 0))
            SendMessage (进度条句柄, #PBM_SETPOS, 到整数 (相乘 (相除 (i, flen), 100)), 0)
        .如果真结束
         ' 输出调试文本 (到整数 (i ÷ flen × 100))
    .判断循环尾 ()
    关闭文件 (flen)
.如果真结束

 ' 得到散列值尺寸
赋值 (返回, CryptGetHashSize (hHash, #HP_HASHSIZE, dwBufferSize, 4, 0))
赋值 (bHash, 取空白字节集 (dwBufferSize))

 ' 输出调试文本 (dwBufferSize)
 ' 本源码来自易语言资源网(www.5A5X.com)
 ' 获得散列值
赋值 (返回, CryptGetHashParam (hHash, #HP_HASHVAL, bHash, dwBufferSize, 0))
.判断开始 (返回)
    .计次循环首 (dwBufferSize, i)
        赋值 (临时文本, 相加 (临时文本, 取文本右边 (相加 (“0”, 到小写 (取十六进制文本 (bHash [i]))), 2)))
    .计次循环尾 ()
.默认
    输出调试文本 (“模块_取文件摘要:获得散列值失败！”)
.判断结束
CryptDestroyHash (hHash)
CryptReleaseContext (hProv, 0)

返回 (临时文本)


.子程序 数据_取数据摘要, 文本型, 公开, 返回一段字节集数据的数据摘要文本,如果获取失败将返回空文本，本命令为初级命令。
.参数 数据, 字节集, , 欲取其数据摘要的数据。
.参数 算法类型, 整数型, 可空, 欲取其数据摘要的算法类型，默认采用MD5算法，有4个选项，1：#CALG_MD2 表示采用MD2编码;2：#CALG_MD4 ,表示采用MD4编码,3：#CALG_MD5, 表示采用MD5编码;4：#CALG_SHA1，表示采用SHA1编码，其他编码请查询MSDN。
.参数 数据摘要字节集, 字节集, 可空, 如果提供了变量，程序会把数据摘要的字节集数据写入此变量已满足特殊需求。

.局部变量 hCtx, 整数型, , , 
.局部变量 返回, 逻辑型, , , 
.局部变量 hProv, 整数型, , , CSP句柄
.局部变量 hHash, 整数型, , , 哈希句柄
.局部变量 bHash, 字节集, , , 
.局部变量 i, 整数型, , , 
.局部变量 临时文本, 文本型, , , 
.局部变量 dwBufferSize, 整数型, , , 
.局部变量 flen, 整数型, , , 
.局部变量 hFile, 整数型, , , 

 ' CALG_MD2 ＝ #ALG_CLASS_HASH ＋ #ALG_TYPE_ANY ＋ #ALG_SID_MD2
 ' CALG_MD4 ＝ #ALG_CLASS_HASH ＋ #ALG_TYPE_ANY ＋ #ALG_SID_MD4
 ' CALG_SHA1 ＝ #ALG_CLASS_HASH ＋ #ALG_TYPE_ANY ＋ #ALG_SID_SHA1
 ' CALG_MD5 ＝ #ALG_CLASS_HASH ＋ #ALG_TYPE_ANY ＋ #ALG_SID_MD5
.如果真 (是否为空 (算法类型))
    赋值 (算法类型, #CALG_MD5)
.如果真结束

 ' ' '试图获取缺省的密钥容器
赋值 (返回, CryptAcquireContext (hProv, 0, #MS_DEF_PROV, #PROV_RSA_FULL, 相加 (#CRYPT_VERIFYCONTEXT, #CRYPT_MACHINE_KEYSET)))
.如果真 (取反 (返回))
     ' 输出调试文本 (“模块_取数据摘要:获取缺省的密钥容器失败！”)
     ' 若失败,就创建一个缺省密钥容器
    赋值 (返回, CryptAcquireContext (hProv, 0, #MS_DEF_PROV, #PROV_RSA_FULL, 相加 (#CRYPT_NEWKEYSET, #CRYPT_MACHINE_KEYSET)))
    .如果真 (取反 (返回))
        输出调试文本 (“模块_取数据摘要:创建密钥容器失败！”)
        返回 (“”)
    .如果真结束
    
.如果真结束
 ' 输出调试文本 (“CSP句柄=” ＋ 到文本 (hProv))

 ' 创建散列句柄
赋值 (返回, CryptCreateHash (hProv, 算法类型, 0, 0, hHash))
.如果真 (取反 (返回))
    输出调试文本 (“模块_取数据摘要:创建散列句柄失败！”)
    CryptReleaseContext (hProv, 0)
    返回 (“”)
.如果真结束
 ' 输出调试文本 (“散列句柄=” ＋ 到文本 (hHash))

 ' 载入散列数据，进行哈希运算
赋值 (返回, CryptHashData (hHash, 数据, 取字节集长度 (数据), 0))
 ' 输出调试文本 (到文本 (数据), 取字节集长度 (数据))
.如果真 (取反 (返回))
    CryptDestroyHash (hHash)
    CryptReleaseContext (hProv, 0)
    返回 (“”)
.如果真结束
 ' 得到散列值尺寸
赋值 (返回, CryptGetHashSize (hHash, #HP_HASHSIZE, dwBufferSize, 4, 0))
赋值 (bHash, 取空白字节集 (dwBufferSize))

 ' 输出调试文本 (dwBufferSize)

 ' 获得散列值
赋值 (返回, CryptGetHashParam (hHash, #HP_HASHVAL, bHash, dwBufferSize, 0))
.如果真 (等于 (是否为空 (数据摘要字节集), 假))
     ' 调试输出 (bHash)
    赋值 (数据摘要字节集, bHash)
.如果真结束

.判断开始 (返回)
    .计次循环首 (dwBufferSize, i)
        赋值 (临时文本, 相加 (临时文本, 取文本右边 (相加 (“0”, 到小写 (取十六进制文本 (bHash [i]))), 2)))
    .计次循环尾 ()
.默认
    输出调试文本 (“模块_取数据摘要:获得散列值失败！”)
.判断结束

CryptDestroyHash (hHash)
CryptReleaseContext (hProv, 0)
返回 (临时文本)

 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 正则搜索, 文本型, 公开, 匹配成功返回文本型结果，失败或没有结果返回空，参数三为数组型结果
.参数 待搜文本, 文本型, , 
.参数 正则表达式, 文本型, , 
.参数 匹配结果, 文本型, 参考 可空 数组, 
.参数 是否区分大小写, 逻辑型, 可空, 默认为真

.局部变量 RegExp, 未知类型0x20001, , , 
.局部变量 result, 未知类型0x20002, , "0", 
.局部变量 i, 整数型, , , 
.局部变量 j, 整数型, , , 
.局部变量 m, 整数型, , , 
.局部变量 n, 整数型, , , 
.局部变量 str, 文本型, , , 
.局部变量 arr, 文本型, , "0", 

赋值 (str, “”)
.如果真 (等于 (假, 是否为空 (匹配结果)))
    清除数组 (匹配结果)
.如果真结束
.如果真 (是否为空 (是否区分大小写))
    赋值 (是否区分大小写, 真)
.如果真结束
RegExp.未知支持库函数_3 (正则表达式, 是否区分大小写)
赋值 (result, RegExp.未知支持库函数_16 (待搜文本))
赋值 (i, 取数组成员数 (result))
.如果真 (不等于 (0, i))
    赋值 (m, RegExp.未知支持库函数_6 ())
    .如果 (等于 (m, 0))
        .计次循环首 (i, j)
            加入成员 (arr, result.未知支持库函数_11 ( [j], 待搜文本, ))
        .计次循环尾 ()
    .否则
        .计次循环首 (i, j)
            .计次循环首 (m, n)
                加入成员 (arr, result.未知支持库函数_12 ( [j], 待搜文本, n, ))
            .计次循环尾 ()
        .计次循环尾 ()
    .如果结束
    赋值 (m, 取数组成员数 (arr))
    .计次循环首 (m, n)
        赋值 (str, 相加 (str, arr [n]))
    .计次循环尾 ()
.如果真结束
.如果真 (等于 (假, 是否为空 (匹配结果)))
    复制数组 (匹配结果, arr)
.如果真结束
返回 (str)

.子程序 执行指定命令, 空白型, 公开, ShellExecute.可以打开任意文件/文件夹/网址 等
.参数 欲操作文件名, 文本型, , 欲操作的文件/文件夹/网址等
.参数 命令行参数, 文本型, 可空, 若FileName参数是一个可执行程序，则此参数指定命令行参数,否则为空
.参数 默认当前目录, 文本型, 可空, 本参数提供命令执行时的默认当前目录，如果被省略，默认为空文本
.参数 窗口显示方式, 短整数型, 可空, 0=#隐藏窗口； 1=#普通激活； 2=#最小化激活； 3=#最大化激活； 4=#普通不激活； 6=#最小化不激活。默认=#普通激活

.如果真 (是否为空 (命令行参数))
    赋值 (命令行参数, “”)
.如果真结束
.如果真 (是否为空 (默认当前目录))
    赋值 (默认当前目录, “”)
.如果真结束
.如果真 (是否为空 (窗口显示方式))
    赋值 (窗口显示方式, 1)
.如果真结束
' 本源码来自易语言资源网(www.5A5X.com)
ShellExecuteA (0, “open”, 欲操作文件名, 命令行参数, 默认当前目录, 窗口显示方式)

.类模块 内存配置项, , , 

.子程序 写内存配置项, 逻辑型, , 
.参数 节名, 文本型, , 
.参数 项目名, 文本型, , 
.参数 项目值, 文本型, , 



.子程序 读内存配置项, 文本型, , 
.参数 节名, 文本型, , 
.参数 项目名, 文本型, , 



.子程序 删除内存配置项, 逻辑型, , 
.参数 节名, 文本型, , 
.参数 项目名, 文本型, 可空, 如果此参数为空，则删除该节名下所有项目



.子程序 清空内存配置项, 空白型, , 为节省内存空间，优化内存，请在不需要使用时执行此方法。


.子程序 取节数, 整数型, , 


.子程序 取项目数, 整数型, , 
.参数 节名, 文本型, 可空, 为空则取所有项目数



.子程序 取所有节名, 整数型, , 返回节数
.参数 节名列表, 文本型, 参考 数组, 用来接收节名列表



.子程序 取项目名, 整数型, , 返回相应项目数
.参数 节名, 文本型, , 
.参数 项目名列表, 文本型, 参考 数组, 用来接收项目名列表



.子程序 从文件中加载, 逻辑型, , 将一配置文件内容加载到内存配置中，但不管内存配置项如何变动不会对该配置文件进行任何修改。
.参数 配置文件名, 文本型, , 例 c:\config.ini



.子程序 保存到配置文件, 逻辑型, , 将当前内存配置内容写出到文件
.参数 配置文件名, 文本型, , 例： c:\config.ini



.子程序 从内存中加载, 逻辑型, , 将一符合配置文件格式的内存数据加载到内存配置中。
.参数 文本数据, 文本型, , 如果是字节集数据，请用“到文本()”命令来转换成文本型数据



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 UTF8转ANSI, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 UTF8, 字节集, , 待转换UTF-8编码字节集



.子程序 UNICODE转ANSI, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 Unicode数据, 字节集, , Unicode码字节集数据



.子程序 ANSI转UNICODE, 字节集, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 文本, 文本型, , Ansi码文本，只针对中文或双字节全角字符



.子程序 UTF8转UNICODE, 字节集, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 UTF8, 字节集, , 待转换UTF-8编码字节集



.子程序 UNICODE转UTF8, 字节集, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 UNICODE, 字节集, , 待转换UNICODE编码字节集



.子程序 ANSI转UTF8, 字节集, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 文本, 文本型, , 要转换为UTF8编码的文本



.子程序 BASE64编码, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 待编码数据, 字节集, , 



.子程序 BASE64解码, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 待解码数据, 文本型, , 



.子程序 文本加密, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 文本, 文本型, , 待加密文本（本加密方法为动态随机加密，所以每次加密后的文本都不同）
.参数 密匙, 文本型, 可空, 长度为62任意不重复单字节可见字符，默认为：ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz



.子程序 文本解密, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 文本, 文本型, , 待解密文本
.参数 密匙, 文本型, 可空, 必须跟加密时相同的密匙文本



.子程序 ANSI转USC2, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 文本, 文本型, , 



.子程序 USC2转ANSI, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 USC2, 文本型, , 



.子程序 Uuencode编码, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 文件名, 文本型, , 待编码全路径文件名



.子程序 Uuencode解码, 字节集, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 文件名, 文本型, , 待解码全路径文件名
.参数 原始文件名, 文本型, 参考 可空, 返回原始全路径文件名



.子程序 ANSI转UTF16BE, 字节集, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 文本, 文本型, , 



.子程序 短信PDU编码, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 短信中心号码, 文本型, , 
.参数 被叫手机号码, 文本型, , 
.参数 短信内容, 文本型, , 



.子程序 UNICODE_网编码, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 文本, 文本型, , 把“易语言”文本转换为“&#26131;&#35821;&#35328;”形式的unicode编码
.参数 头连接符, 文本型, 可空, 默认：“&#”
.参数 尾连接符, 文本型, 可空, 默认：“;”



.子程序 UNICODE_网解码, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 文本, 文本型, , 把“&#26131;&#35821;&#35328;”形式的unicode编码转换为“易语言”
.参数 头连接符, 文本型, 可空, 默认：“&#”
.参数 尾连接符, 文本型, 可空, 默认：“;”



.子程序 短信PDU解码, 文本型, , 成功返回短信内容。因接收的PDU文本和发送的PDU文本格式的差异，所以别指望能正确地解码短信编码后的文本
.参数 PDU文本, 文本型, , 接收到的完整的短信PDU字符串
.参数 短信中心, 文本型, 参考 可空, 
.参数 来电号码, 文本型, 参考 可空, 
.参数 来电时间, 日期时间型, 参考 可空, 



.子程序 unescape编码1, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 文本, 文本型, , 待编码URL文本，不支持双字节字符（包括中文）



.子程序 unescape解码1, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 文本, 文本型, , 待解码unescape编码文本



.子程序 unescape编码2, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 文本, 文本型, , 待编码URL文本，不支持双字节字符（包括中文）



.子程序 unescape解码2, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 文本, 文本型, , 待解码的unescape编码文本



.子程序 Escape编码, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 文本, 文本型, , 待编码文本



.子程序 Escape解码, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 文本, 文本型, , Escape编码后文本



.子程序 Encode编码, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 文本, 文本型, , 待编码URL文本



.子程序 Encode解码, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 文本, 文本型, , Encode编码后文本



.子程序 生成密钥, 文本型, , 自动生成加密用密钥字符串，方便文本加密时使用，注意：本子程序不要直接在程序中调用


.子程序 ANSI转UTF8_算法, 字节集, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 文本, 文本型, , 



.子程序 UTF8转ANSI_算法, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 UTF8字节集, 字节集, , 



.子程序 Fs2You真实地址解码, 文本型, , 
.参数 Fs2You地址, 文本型, , 以Fs2You开头的原地址



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 访问网页, 字节集, , 
.参数 完整网址, 文本型, , 
.参数 访问方式, 文本型, 可空, "GET" or "POST",为空默认"GET"
.参数 代理地址, 文本型, 可空, 
.参数 用户名, 文本型, 可空, 
.参数 密码, 文本型, 可空, 
.参数 附加协议头, 文本型, 可空, 
.参数 提交信息, 文本型, 可空, "POST"专用
.参数 超时值, 整数型, 可空, 单位秒，默认90
.参数 返回状态文本, 文本型, 参考 可空, 在Send之后可以获取状态文本



.子程序 取域名, 文本型, , 
.参数 网址, 文本型, , 
.参数 不过滤端口, 逻辑型, 可空, 



.子程序 取端口, 整数型, , 
.参数 网址, 文本型, , 



.子程序 取页面地址, 文本型, , 
.参数 网址, 文本型, , 




 ' 不属于任何一个程序集、类模块的函数：
