 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 228
    高度 = 146
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 13350799 '  0xCBB78F
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\bxTvGfxU.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “加密锁”
    帮助文件名 = “”



.图片 tools, " ' 已保存到：D:\易语言学习\Data\bxTvGfxU.e\tools", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' edroptarget {9DA96BF9CEBD45c5BFCF94CBE61671F5} 1 0 拖放支持库
 ' eSkin {ACE18985-6AE2-49F1-929D-78C05B10F789} 2 0 易语言皮肤支持库
 ' iext5 {E5000198-4471-40e2-92BC-D0BA075BDBB2} 1 5 扩展界面支持库五



 ' 所需要的模块
 ' 禁止重复运行 $禁止重复运行.ec



.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 a, 文本型, , "0", 
.局部变量 接收到的文件路径, 文本型, , , 

禁止重复运行 (“程序已在运行中，不用再运行。”)
未知支持库函数_0 (“0.skn”, )
_启动窗口.取窗口句柄 ().未知支持库函数_0 ()
赋值 (., 真)
取命令行 (a)
.如果真 (不等于 (取数组下标 (a, 1), 0))
    赋值 (接收到的文件路径, a [1])
    .判断开始 (等于 (接收到的文件路径, “”))
        返回 ()
    .判断 (等于 (取文本长度 (接收到的文件路径), 3))
        返回 ()
    .默认
        
    .判断结束
    _拖放对象1_得到文件 (接收到的文件路径)
.如果真结束
 ' 标签1.标题 ＝ #换行符 ＋ #换行符 ＋ #换行符 ＋ #换行符 ＋ “把你要加密的文件夹交给我”
写注册项 (#根类, “Folder\shell\文件夹密锁\command\”, 相加 (取运行目录 (), “\”, 取执行文件名 ()))

.子程序 _拖放对象1_得到文件, 空白型, , 
.参数 接收到的文件路径, 文本型, , 

.局部变量 文件属性, 整数型, , , 
.局部变量 密码1, 文本型, , , 
.局部变量 密码2, 文本型, , , 
.局部变量 解密密码, 文本型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 文件名, 文本型, , "0", 

 ' 标签1.标题 ＝ #换行符 ＋ #换行符 ＋ #换行符 ＋ “点击我帮你加密”
赋值 (文件名, 分割文本 (接收到的文件路径, #换行符, ))
赋值 (接收到的文件路径, 文件名 [1])
赋值 (文件属性, 取文件属性 (接收到的文件路径)) ' 判断拖放进来的目标是文件夹还是文件，根据相应的属性进行处理
.如果真 (不等于 (位与 (文件属性, #子目录), 0))
    赋值 (文件号, 打开文件 (相加 (接收到的文件路径, “.\jm.dat”), #读入, #禁止读写))
    赋值 (解密密码, 读入一行 (文件号))
    关闭文件 (文件号)
    .如果 (不等于 (解密密码, “”))
         ' 标签1.标题 ＝ #换行符 ＋ #换行符 ＋ #换行符 ＋ “点击我帮你解密”  ' 用于判断目录是否已经加过密。jm.dat是程序加密后在所加密的目录下生成的标志文件。
        .如果真 (输入框 (相加 (“请输入”, #引号, 取文本左边 (接收到的文件路径, 相减 (取文本长度 (接收到的文件路径), 1)), #引号, “文件夹的密码”), “录入密码”, , 密码1, #输入密码))
            .如果 (不等于 (密码1, 解密密码))
                信息框 (“密码不正确，重新录入密码。”, 0, )
            .否则
                 ' 核心命令：此句命令将加密后的目录名修改成正常的目录名。
                文件更名 (相加 (接收到的文件路径, “.\”), 取文本左边 (接收到的文件路径, 相减 (取文本长度 (接收到的文件路径), 1)))
                删除文件 (相加 (接收到的文件路径, “\jm.dat”))
                信息框 (“解密成功。”, 0, )
                 ' 标签1.标题 ＝ #换行符 ＋ #换行符 ＋ #换行符 ＋ #换行符 ＋ “把你要加密的文件夹交给我”
            .如果结束
            
        .如果真结束
        返回 ()
    .否则
        .如果真 (输入框 (相加 (“请输入”, #引号, 接收到的文件路径, #引号, “你要加密的密码”), “输入密码”, , 密码1, #输入密码))
            .如果真 (输入框 (相加 (“请再次输入”, #引号, 接收到的文件路径, #引号, “验证密码避免遗忘：”), “输入密码”, , 密码2, #输入密码))
                .如果 (等于 (密码1, 密码2))
                    .如果 (不等于 (密码1, “”))
                        .如果 (文件更名 (接收到的文件路径, 相加 (接收到的文件路径, “..\”))) ' 核心命令：此句命令将正常的目录名加密成无法访问的目录名。
                            写到文件 (相加 (接收到的文件路径, “..\jm.dat”), 到字节集 (密码1)) ' 生成加密目录标志文件及密码记录
                            信息框 (“加密成功。”, 0, )
                             ' 标签1.标题 ＝ #换行符 ＋ #换行符 ＋ #换行符 ＋ #换行符 ＋ “把你要加密的文件夹交给我”
                        .否则
                            
                            
                            
                            
                        .如果结束
                        
                    .否则
                        信息框 (“不录入密码不能加密。”, 0, )
                    .如果结束
                    
                .否则
                    信息框 (“两次输入密码不相同。”, 0, )
                .如果结束
                
                
            .如果真结束
            
        .如果真结束
        返回 ()
    .如果结束
    
.如果真结束


.子程序 _取消菜单项_被选择, 空白型, , 
.如果真 (等于 (信息框 (相加 (“      请在卸载前使用该功能      ”, #换行符, #换行符, “      你确定要取消菜单项吗？”), #是否钮, “ 询问”), #是钮))
    删除注册项 (#根类, “Folder\shell\文件夹密锁\command\”)
    删除注册项 (#根类, “Folder\shell\文件夹密锁\command\”)
    删除注册项 (#根类, “Folder\shell\文件夹密锁\”)
    结束 ()
.如果真结束
返回 ()

.子程序 _help_被选择, 空白型, , 
取鼠标水平位置 ().未知支持库函数_26 (取鼠标垂直位置 (), “<table border=1 bordercolor=#555555 cellspacing=0 cellpadding=0><tr><td width=100% bgcolor=#555555><font color=#FFFFFF size=4> 帮助                                  ×</font></td></tr><tr><td width=100% bgcolor=#ffffdf> <br>     本程序启动添加到了文件夹的右键菜单项里，按 <br><br> 右键点选菜单项即可运行。 <br><br>     加密或解密文件夹，请直接把选择的文件夹拖到 <br><br> 本程序窗口里录入密码即可。 <br><br>     鼠标拖动文件夹时在资源管理器右边操作为宜。<br><br>     操作时请关闭无关的程序窗口。<br><br> <font color=#ff5555>注意！ <br><br>   计算机用户权限不足不能添加系统菜单项。 <br><br>   卸载本程序之前请将所有加过密的文件夹解密。 <br><br>   你若总是遗忘密码，劝告你不要使用本软件。<br></td></tr></table>”, -1, )

.子程序 _关于_被选择, 空白型, , 
取鼠标水平位置 ().未知支持库函数_26 (取鼠标垂直位置 (), “<table border=1 bordercolor=#555555 cellspacing=0 cellpadding=0><tr><td width=100% bgcolor=#555555><font color=#FFFFFF size=4> 关于                         ×</font></td></tr><tr><td width=100% bgcolor=#ffffdf><br><center><font size=4>文件夹加密工具</font><br><br>本软件授权为免费共享<br><br>编程：阿目<br><br>MSN：PANCG@MSN.COM<br><br>版权所有(C)2007PANCG<br><br>                2007-11-05</td></tr></table>”, -1, )

.子程序 _退出_被选择, 空白型, , 
结束 ()

.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 禁止重复运行, 空白型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 互斥体文本, 文本型, 可空, 互斥体特征文本




 ' 不属于任何一个程序集、类模块的函数：
