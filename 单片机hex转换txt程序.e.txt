 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 414
    高度 = 296
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\单片机hex转换txt程序.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “HEX/TXT转换软件”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库




.全局变量 文件号, 整数型, , , 

.窗口程序集 启动窗口程序集, , , 

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.禁止, 假)
赋值 (.类型, 0)
.如果真 (等于 (打开 (), 真))
    .如果真 (不等于 (文件号, 0))
        关闭文件 (文件号)
    .如果真结束
    赋值 (文件号, 打开文件 (.文件名, , ))
    赋值 (.内容, 读入文本 (文件号, ))
    .如果 (小于 (寻找文本 (.内容, “01FF”, , 真), 1))
        信息框 (“文件格式错误”, 0, )
        返回 ()
    .否则
        赋值 (.标题, .文件名)
    .如果结束
    
.如果真结束


.子程序 _按钮3_被单击, 空白型, , 
.如果 (等于 (.内容, “”))
    信息框 (“请先打开HEX文件”, 0, )
.否则
    .如果 (等于 (.内容, “”))
        信息框 (“请先转换HEX文件”, 0, )
        返回 ()
    .否则
        保存文档 ()
    .如果结束
    
    
.如果结束


.子程序 保存文档, 逻辑型, , 返回真表示用户选择了中止
.参数 文件名, 文本型, 可空, 

.局部变量 保存文件名, 文本型, , , 
.局部变量 现行文件名, 文本型, , , 

赋值 (保存文件名, 选择 (是否为空 (文件名), 现行文件名, 文件名))
.如果真 (等于 (保存文件名, “”))
    赋值 (.标题, “请输入欲保存到的文本文件名：”)
    赋值 (.类型, 1)
    .如果真 (等于 (打开 (), 假))
        返回 (真)
    .如果真结束
    赋值 (保存文件名, .文件名)
.如果真结束
赋值 (文件号, 打开文件 (保存文件名, #重写, ))
.如果真 (不等于 (文件号, 0))
    .如果 (等于 (写出文本 (文件号, .内容), 真))
        关闭文件 (文件号)
        赋值 (现行文件名, 保存文件名)
        赋值 (., 相加 (“程序”, 现行文件名))
        返回 (假)
    .否则
        关闭文件 (文件号)
    .如果结束
    
.如果真结束
信息框 (“保存文件失败！”, #错误图标, “错误”)
返回 (假)

.子程序 __启动窗口_创建完毕, 空白型, , 
未知支持库函数_0 (1)

.子程序 _按钮4_被单击, 空白型, , 
.局部变量 变量0, 整数型, , , 
.局部变量 变量1, 整数型, , , 
.局部变量 变量2, 整数型, , , 
.局部变量 变量3, 整数型, , , 

.如果 (等于 (.内容, “”))
    信息框 (“请先打开HEX文件”, 0, )
    返回 ()
.否则
    .如果 (小于 (寻找文本 (.内容, “01FF”, , 真), 1))
        信息框 (“文件格式错误”, 0, )
        返回 ()
    .否则
        
    .如果结束
    
.如果结束
赋值 (变量1, 10)
赋值 (.禁止, 真)
移到文件首 (到数值 (文件号))
赋值 (变量0, 到数值 (模块_进制转换 (取文本中间 (.内容, 4, 4), 到数值 (16), 到数值 (10))))
.循环判断首 ()
    赋值 (.内容, “”)
    读入一行 (文件号).加入文本 ()
    赋值 (变量3, 到数值 (模块_进制转换 (取文本中间 (.内容, 4, 4), 到数值 (16), 到数值 (10))))
    .如果 (等于 (相减 (变量3, 变量0), 0))
        
    .否则
        .计次循环首 (相减 (变量3, 变量0), )
            相加 (到文本 (取十六进制文本 (变量0)), “:FF”, #换行符).加入文本 ()
            相加 (“FF”, #换行符).加入文本 ()
            赋值 (变量0, 相加 (变量0, 1))
        .计次循环尾 ()
    .如果结束
    赋值 (变量0, 变量3)
    赋值 (变量2, 到数值 (模块_进制转换 (取文本中间 (.内容, 2, 2), 到数值 (16), 到数值 (10))))
    .计次循环首 (到数值 (变量2), )
        相加 (到文本 (取十六进制文本 (变量0)), “:”, 取文本中间 (.内容, 变量1, 2), #换行符).加入文本 ()
        相加 (取文本中间 (.内容, 变量1, 2), #换行符).加入文本 ()
        赋值 (.标题, 相加 (“转换到TXT文件：”, 到文本 (变量0), “个代码(不包括OK）”))
        赋值 (变量1, 相加 (变量1, 2))
        赋值 (变量0, 相加 (变量0, 1))
    .计次循环尾 ()
    移动读写位置 (到数值 (.内容), #现行位置, 相加 (#现行位置, 1))
    赋值 (变量1, 10)
.循环判断尾 (不等于 (取文本右边 (.内容, 4), “01FF”))
相加 (“ok”, #换行符).加入文本 ()
信息框 (“转换完毕”, 0, )

.程序集 _模块_进制转换, , , ** 不要更改此处 模块_数制转换.ec

.子程序 模块_进制转换, 文本型, , 可以将从二进制到三十六进制的数值随意进行转换，不可以转换负数以及小数。
.参数 被转换文本, 文本型, , 
.参数 被转换进制, 整数型, , 
.参数 转换的进制, 整数型, , 

 ' ** 本子程序功能由系统自动转交对应模块实现，可以删除但不能修改。

.窗口程序集 窗口程序集1, , , 

.子程序 _按钮1_被单击, 空白型, , 
销毁 ()

.子程序 _标签1_反馈事件, 整数型, , 


.子程序 _窗口1_创建完毕, 空白型, , 
鸣叫 ()

.窗口程序集 窗口程序集2, , , 

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()


.子程序 _按钮1_被单击, 空白型, , 
运行 (相加 (取运行目录 (), “\PORT95NT.exe”), 假, )
销毁 ()


.窗口程序集 窗口程序集3, , , 

.子程序 _窗口2_创建完毕, 空白型, , 
鸣叫 ()

.窗口程序集 窗口程序集4, , , 


 ' 不属于任何一个程序集、类模块的函数：
