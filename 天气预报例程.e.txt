 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 450
    高度 = 260
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “国内主要城市72小时天气预报”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 6 系统核心支持库
 ' internet 707ca37322474f6ca841f0e224f4b620 1 0 互联网支持库



 ' 所需要的模块
 ' 72小时天气预报模块 E:\软件源码\天气预报模块\72小时天气预报模块.ec



.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 局部_临时数组, 文本型, , "0", 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_城市, 文本型, , "0", 

赋值 (局部_临时数组, 分割文本 (未知函数_67174407 (), “|”, ))
.计次循环首 (取数组成员数 (局部_临时数组), 局部_计次)
    赋值 (局部_城市, 分割文本 (局部_临时数组 [局部_计次], “,”, ))
    .如果真 (等于 (取数组成员数 (局部_城市), 2))
        局部_城市.加入项目 ( [1], 到整数 (局部_城市 [2]))
    .如果真结束
    
.计次循环尾 ()

.子程序 _组合框1_列表项被选择, 空白型, , 
.局部变量 局部_返回文本, 文本型, , "0", 
.局部变量 局部_今天天气, 文本型, , "0", 
.局部变量 局部_明天天气, 文本型, , "0", 
.局部变量 局部_后天天气, 文本型, , "0", 

赋值 (.标题, 相加 (“正在获取”, .取项目文本 (.现行选中项), “地区的天气信息，请稍候...”))
连续赋值 (“”, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题, .标题)
连续赋值 ({  }, .图片, .图片, .图片)
处理事件 ()
置等待鼠标 ()

赋值 (局部_返回文本, 分割文本 (未知函数_67174428 (“192.168.1.240:808”, 到文本 (.取项目数值 (.现行选中项))), “#”, ))
.如果真 (不等于 (取数组成员数 (局部_返回文本), 3))
    输出调试文本 (取数组成员数 (局部_返回文本))
    信息框 (“获取天气预报失败!”, #错误图标, )
    返回 ()
.如果真结束
赋值 (分割文本 ( [1], “|”, ))
赋值 (分割文本 ( [2], “|”, ))
赋值 (局部_后天天气, 分割文本 (局部_返回文本 [3], “|”, ))
.如果真 (或者 (不等于 (取数组成员数 (局部_今天天气), 5), 不等于 (取数组成员数 (局部_明天天气), 5), 不等于 (取数组成员数 (局部_后天天气), 5)))
    输出调试文本 (取数组成员数 (局部_今天天气))
    信息框 (“获取天气预报失败!”, #错误图标, )
    返回 ()
.如果真结束
赋值 (.标题, 未知函数_67174535 (取现行时间 (), “-”))
赋值 (.标题, 未知函数_67174535 (增减时间 (取现行时间 (), #日, 1), “-”))
赋值 (.标题, 未知函数_67174535 (增减时间 (取现行时间 (), #日, 2), “-”))

赋值 (.图片, 未知支持库函数_7 (局部_今天天气 [1]))
赋值 (.图片, 未知支持库函数_7 (局部_明天天气 [1]))
赋值 (.图片, 未知支持库函数_7 (局部_后天天气 [1]))
 ' 其实这里应该是把所有天气到图片添加到资源中直接调用，速度会快很多，就是不知道图片都有哪些，……%%嘿嘿

赋值 (.标题, 局部_今天天气 [2])
赋值 (.标题, 局部_明天天气 [2])
赋值 (.标题, 局部_后天天气 [2])

赋值 (.标题, 相加 (局部_今天天气 [3], “～”, 局部_今天天气 [4]))
赋值 (.标题, 相加 (局部_明天天气 [3], “～”, 局部_明天天气 [4]))
赋值 (.标题, 相加 (局部_后天天气 [3], “～”, 局部_后天天气 [4]))

赋值 (.标题, 局部_今天天气 [5])
赋值 (.标题, 局部_明天天气 [5])
赋值 (.标题, 局部_后天天气 [5])

赋值 (.标题, “”)
恢复鼠标 ()


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 取72小时天气预报, 文本型, , 获取指定城市72小时天气预报信息，返回该城市72小时天气预报文字及图片地址，以"-"分隔每日，以"|"分隔日天气信息
.参数 参数_代理服务器地址, 文本型, 可空, 如省略，则不使用代理服务器
.参数 参数_地区代码, 文本型, , 可由 取城市代码() 命令获得



.子程序 取城市代码, 文本型, , 获取指定城市代码，如参数城市未在列表中，则返回空文本
.参数 参数_地名, 文本型, , 请提供国内主要城市名



.子程序 取所有城市代码, 文本型, , 返回模块中提供的所有城市名称及城市代码，以"|"分隔城市，以","分隔城市名称和代码


.子程序 转换启动时间, 日期时间型, , 将启动时间转换成时间格式。（启动时间在24小时以内）
.参数 启动时间, 整数型, , 单位：秒



.子程序 星期几, 文本型, , 
.参数 日期, 日期时间型, , 



.子程序 增强日期, 文本型, , 2003-11-6　变成　2003-11-06
.参数 时间, 日期时间型, , 
.参数 日期分隔符, 文本型, 可空, 默认为：年、月、日



.子程序 增强时间, 文本型, , 17:2:9　变成　17:02:09
.参数 时间, 日期时间型, , 
.参数 样式, 字节型, 可空, 显示时间的样式。无参数，17:20:09；参数1，12时08分32秒；参数2，PM 01:20:09




 ' 不属于任何一个程序集、类模块的函数：
