 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 142
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库





.窗口程序集 窗口程序集1, , , 

.子程序 _按钮1_被单击, 空白型, , 
.如果真 (打开 ())
    赋值 (., .)
    赋值 (., 假)
.如果真结束


.子程序 压缩mdb数据库, 整数型, , 请注意先关闭数据库.返回0成功，返回1则是创建系统对象失败，返回1是调用失败，返回3是数据库使用中
.参数 路径, 文本型, , 
.参数 密码, 文本型, 可空, 

.局部变量 Engine, 对象, , , 
.局部变量 tmp, 文本型, , , 

.如果真 (等于 (Engine.创建 (“JRO.JetEngine”, ), 假))
    返回 (1)
.如果真结束
赋值 (tmp, 取临时文件名 ())
Engine.方法 (“CompactDatabase”, 相加 (“Provider=Microsoft.Jet.OLEDB.4.0;Data Source=”, 路径, 选择 (是否为空 (密码), “”, 相加 (“;Jet OLEDB:Database Password=”, 密码))), 相加 (“Provider=Microsoft.Jet.OLEDB.4.0;Data Source=”, tmp, 选择 (等于 (密码, “”), “”, 相加 (“;Jet OLEDB:Database Password=”, 密码))))
.如果真 (不等于 (Engine.取错误 (), “”))
    返回 (2)
.如果真结束
Engine.清除 ()
.如果真 (等于 (删除文件 (路径), 假))
    删除文件 (tmp)
    返回 (3)
.如果真结束
.如果真 (等于 (复制文件 (tmp, 路径), 假))
    返回 (3)
.如果真结束
返回 (选择 (删除文件 (tmp), 0, 3))

.子程序 _按钮2_被单击, 空白型, , 
信息框 (多项选择 (压缩mdb数据库 (编辑框1.内容, 编辑框2.内容) ＋ 1, “压缩成功！”, “对不起，您的系统文件或系统函数被破坏！”, “对不起，您所选定文件格式错误”, “对不起，请先关闭数据库”), 64, )

.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (., 相加 (取文本注册项 (3, “Software\FlySky\E\Install\Path”, ), “krnln\samples\MSAccess.mdb”))


 ' 不属于任何一个程序集、类模块的函数：
