 ' 文件类型：Windows窗口程序

 ' 程序名称：Shuewood Slider
 ' 程序描述：
 ' 程序作者：叶晶音
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 336
    高度 = 256
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 0
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\kVU1TOol.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “Shuewood Slider 幻灯 ”
    帮助文件名 = “”

窗口 窗口_程序配置
    左边 = 50
    顶边 = 50
    宽度 = 345
    高度 = 251
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “Shuewood Slider 配置”
    帮助文件名 = “”



.常量 向前, "1", , 
.常量 不变, "0", , 
.常量 后退, "-1", , 
.图片 播放按钮, " ' 已保存到：D:\易语言学习\Data\kVU1TOol.e\播放按钮", , 
.图片 暂停按钮, " ' 已保存到：D:\易语言学习\Data\kVU1TOol.e\暂停按钮", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库




数据类型 文件夹信息_, , BROWSEINFO
    .成员 窗口句柄, 整数型, , , hOwner
    .成员 根目录, 整数型, , , pidlRoot
    .成员 显示名称, 文本型, , , pszDisplayName
    .成员 标题, 文本型, , , lpszTitle
    .成员 标志, 整数型, , , ulFlags
    .成员 回调函数地址, 整数型, , , lpfn
    .成员 回调函数参数, 整数型, , , lParam
    .成员 图像索引, 整数型, , , iImage

数据类型 画图信息_, , 
    .成员 左边, 整数型, , , 
    .成员 顶边, 整数型, , , 
    .成员 宽度, 整数型, , , 
    .成员 高度, 整数型, , , 

数据类型 查找的文件信息_, , WIN32_FIND_DATA
    .成员 dwFileAttributes, 整数型, , , 
    .成员 dwLowDateTime, 整数型, , , 
    .成员 dwHighDateTime, 整数型, , , 
    .成员 dwLowDateTime1, 整数型, , , 
    .成员 dwHighDateTime1, 整数型, , , 
    .成员 dwLowDateTime2, 整数型, , , 
    .成员 dwHighDateTime2, 整数型, , , 
    .成员 nFileSizeHigh, 整数型, , , 
    .成员 nFileSizeLow, 整数型, , , 
    .成员 dwReserved0, 整数型, , , 
    .成员 dwReserved1, 整数型, , , 
    .成员 cFileName, 字节型, , "260", 
    .成员 cAlternate, 字节型, , "14", 

.全局变量 全局_图片列表, 文本型, , "0", 
.全局变量 全局_幻灯周期, 整数型, , , 
.全局变量 全局_幻灯大小, 整数型, , , 
.全局变量 全局_当前图片, 整数型, , , 
.全局变量 全局_图片路径, 文本型, , , 
.全局变量 全局_缩放图片, 逻辑型, , , 

.DLL命令 从列表id取路径_, 整数型, "shell32.dll", "SHGetPathFromIDListA", , 
    .参数 结构指针, 整数型, , pIdl
    .参数 路径, 文本型, 传址, pszPath

.DLL命令 浏览文件夹对话框_, 整数型, "shell32.dll", "SHBrowseForFolderA", , 
    .参数 浏览文件夹结构, 文件夹信息_, , 

.DLL命令 释放分配内容_, 空白型, "ole32.dll", "CoTaskMemFree", , CoTaskMemFree
    .参数 内存块指针, 整数型, , pv

.DLL命令 设置时钟_, 整数型, "user32.dll", "SetTimer", , 
    .参数 窗口句柄, 整数型, , hwnd，窗口句柄
    .参数 事件标识符, 整数型, , nIDEvent，定时器ID，多个定时器时，可以通过该ID判断是哪个定时器
    .参数 时钟周期, 整数型, , uElapse，时间间隔，单位是毫秒
    .参数 回调函数地址, 子程序指针, , lpTimerFunc，回调函数指针，指向周期调用的函数

.DLL命令 销毁时钟_, 整数型, "user32.dll", "KillTimer", , 
    .参数 窗口句柄, 整数型, , hwnd
    .参数 事件标识符, 整数型, , nIDEvent

.DLL命令 关闭搜索句柄_, 整数型, "kernel32.dll", "FindClose", , FindClose,关闭由FindFirstFile函数创建的一个搜索句柄
    .参数 搜索句柄, 整数型, , hFindFile，由FindFirstFile函数提供的搜索句柄

.DLL命令 查找文件_, 整数型, "kernel32.dll", "FindFirstFileA", , 
    .参数 文件名, 文本型, , lpFileName，欲搜索的文件名
    .参数 文件信息, 查找的文件信息_, , lpFindFileData，参见相关帮助

.DLL命令 查找下一个文件_, 整数型, "kernel32.dll", "FindNextFileA", , 
    .参数 搜索句柄, 整数型, , hFindFile，参见相关帮助
    .参数 文件有关信息, 查找的文件信息_, , lpFindFileData，参见相关帮助

.窗口程序集 窗口程序集_启动窗口, , , 

.程序集变量 变量_播放状态, 逻辑型, , , 用于标记是否正在播放幻灯
.子程序 子程序_打开浏览文件夹对话框, 文本型, , 打开浏览文件夹的对话框，并返回选择的文件夹路径。没选择返回空。
.参数 参数_窗口句柄, 整数型, , 调用打开浏览文件夹对话框的窗口的句柄。
.参数 参数_标题, 文本型, , 在浏览文件夹对话框上显示的标题。

.局部变量 局部_浏览文件夹结构, 文件夹信息_, , , 
.局部变量 局部_返回值, 整数型, , , 
.局部变量 局部_路径, 文本型, , , 

赋值 (局部_浏览文件夹结构.窗口句柄, 参数_窗口句柄)
赋值 (局部_浏览文件夹结构.标题, 参数_标题)
赋值 (局部_浏览文件夹结构.标志, 1)
赋值 (局部_返回值, 浏览文件夹对话框_ (局部_浏览文件夹结构))
.如果 (不等于 (局部_返回值, 0))
    赋值 (局部_路径, 取空白文本 (260))
    从列表id取路径_ (局部_返回值, 局部_路径)
    释放分配内容_ (局部_返回值)
    返回 (局部_路径)
.否则
    返回 (“”)
.如果结束


.子程序 子程序_改变窗口大小, 空白型, , 
.如果 (不等于 (_启动窗口., 取屏幕宽度 ()))
    赋值 (_启动窗口., 3)
.否则
    子程序_应用设置 ()
.如果结束


.子程序 子程序_置图片文件列表, 空白型, , 查找指定目录下所有的图片文件的文件名，返回一个文本型数组
.参数 参数_文件路径, 文本型, , 要查找的路径
.参数 参数_文件列表, 文本型, 数组, 目录下图片文件的文件名列表，不包括文件路径

.局部变量 局部_当前文件, 文本型, , , 
.局部变量 局部_文件类型, 文本型, , , 
.局部变量 局部_文件信息, 查找的文件信息_, , , 
.局部变量 局部_返回值, 整数型, , , 
.局部变量 局部_文件名, 文本型, , , 

重定义数组 (参数_文件列表, 假, 0)
赋值 (局部_文件名, “”)
.如果 (改变目录 (参数_文件路径))
    赋值 (局部_返回值, 查找文件_ (相加 (参数_文件路径, “\*.*”), 局部_文件信息))
    .如果真 (不等于 (局部_返回值, 0))
        赋值 (局部_当前文件, 到文本 (局部_文件信息.cFileName))
        .判断循环首 (不等于 (局部_当前文件, 局部_文件名))
            赋值 (局部_文件名, 局部_当前文件)
            赋值 (局部_文件类型, 取文本右边 (局部_文件名, 4))
            .如果真 (或者 (等于 (局部_文件类型, “.JPG”), 等于 (局部_文件类型, “.GIF”), 等于 (局部_文件类型, “.BMP”), 等于 (局部_文件类型, “.jpg”), 等于 (局部_文件类型, “.gif”), 等于 (局部_文件类型, “.bmp”)))
                加入成员 (参数_文件列表, 局部_文件名)
                处理事件 ()
            .如果真结束
            查找下一个文件_ (局部_返回值, 局部_文件信息)
            赋值 (局部_当前文件, 到文本 (局部_文件信息.cFileName))
        .判断循环尾 ()
        关闭搜索句柄_ (局部_返回值)
        子程序_文本数组排序 (参数_文件列表)
    .如果真结束
    处理事件 ()
.否则
    
.如果结束


.子程序 子程序_文本数组排序, 空白型, , 
.参数 参数_文本数组, 文本型, 数组, 

.局部变量 局部_数组成员数, 整数型, , , 
.局部变量 局部_当前成员, 整数型, , , 
.局部变量 局部_结果数组, 文本型, , "0", 
.局部变量 局部_计数, 整数型, , , 
.局部变量 局部_逆序数, 整数型, , , 

赋值 (局部_数组成员数, 取数组成员数 (参数_文本数组))
重定义数组 (局部_结果数组, 假, 局部_数组成员数)
赋值 (局部_逆序数, 0)
.计次循环首 (局部_数组成员数, 局部_当前成员)
    .计次循环首 (局部_数组成员数, 局部_计数)
        .如果 (大于或等于 (文本比较 (参数_文本数组 [局部_当前成员], 参数_文本数组 [局部_计数], 假), 0))
            赋值 (局部_逆序数, 相加 (局部_逆序数, 1))
        .否则
            
        .如果结束
        
    .计次循环尾 ()
    赋值 (局部_结果数组 [局部_逆序数], 参数_文本数组 [局部_当前成员])
    赋值 (局部_逆序数, 0)
.计次循环尾 ()
处理事件 ()
重定义数组 (参数_文本数组, 真, 局部_数组成员数)
赋值 (参数_文本数组, 局部_结果数组)

.子程序 子程序_应用设置, 空白型, , 
.如果真 (等于 (全局_幻灯大小, 1))
    赋值 (_启动窗口., 336)
.如果真结束
.如果真 (等于 (全局_幻灯大小, 2))
    赋值 (_启动窗口., 656)
.如果真结束
.如果真 (等于 (全局_幻灯大小, 3))
    赋值 (_启动窗口., 816)
.如果真结束
.如果真 (等于 (全局_幻灯大小, 4))
    赋值 (_启动窗口., 1040)
.如果真结束
赋值 (_启动窗口., 1)
.如果真 (变量_播放状态)
    子程序_暂停播放 ()
    子程序_播放幻灯 ()
.如果真结束


.子程序 子程序_显示图片, 空白型, , 让画板_主图片显示图片，方向参数决定显示方向。
.参数 参数_方向, 整数型, , 显示图片变化的方向，可以是：1 #向前、0 #不变、-1 #后退

.局部变量 局部_图片数量, 整数型, , , 
.局部变量 局部_返回值, 整数型, , , 
.局部变量 局部_原图高度, 整数型, , , 
.局部变量 局部_原图宽度, 整数型, , , 
.局部变量 局部_目标图片, 画图信息_, , , 

赋值 (局部_图片数量, 取数组成员数 (全局_图片列表))
.如果真 (大于 (局部_图片数量, 0))
    赋值 (全局_当前图片, 相加 (全局_当前图片, 参数_方向))
    .如果真 (并且 (等于 (全局_当前图片, 0), 等于 (参数_方向, 0)))
        赋值 (全局_当前图片, 1)
    .如果真结束
    .如果真 (并且 (等于 (全局_当前图片, 0), 等于 (参数_方向, -1)))
        赋值 (全局_当前图片, 局部_图片数量)
    .如果真结束
    .如果真 (大于 (全局_当前图片, 局部_图片数量))
        赋值 (全局_当前图片, 1)
    .如果真结束
    赋值 (局部_返回值, 载入图片 (相加 (全局_图片路径, “\”, 全局_图片列表 [全局_当前图片])))
    处理事件 ()
    赋值 (局部_原图宽度, 局部_返回值.取图片宽度 ())
    赋值 (局部_原图高度, 局部_返回值.取图片高度 ())
    子程序_使图片适合画板 (局部_原图宽度, 局部_原图高度, 局部_目标图片)
    0.清除 (0, ., .)
    局部_返回值.画图片 (局部_目标图片.左边, 局部_目标图片.顶边, 局部_目标图片.宽度, 局部_目标图片.高度, #拷贝)
    卸载图片 (局部_返回值)
.如果真结束


.子程序 子程序_使图片适合画板, 空白型, , 
.参数 参数_原图宽度, 整数型, , 
.参数 参数_原图高度, 整数型, , 
.参数 参数_结果图片, 画图信息_, , 

.如果真 (大于或等于 (相除 (参数_原图高度, 参数_原图宽度), 0.75))
     ' 以高度决定宽度
    .如果 (全局_缩放图片)
        赋值 (参数_结果图片.高度, .)
        赋值 (参数_结果图片.顶边, 0)
        赋值 (参数_结果图片.宽度, 取整 (相乘 (相除 (参数_结果图片.高度, 参数_原图高度), 参数_原图宽度)))
        赋值 (参数_结果图片.左边, 取整 (相除 (相减 (., 参数_结果图片.宽度), 2)))
    .否则
        .如果真 (大于或等于 (参数_原图高度, .))
            赋值 (参数_结果图片.高度, .)
            赋值 (参数_结果图片.顶边, 0)
            赋值 (参数_结果图片.宽度, 取整 (相乘 (相除 (参数_结果图片.高度, 参数_原图高度), 参数_原图宽度)))
            赋值 (参数_结果图片.左边, 取整 (相除 (相减 (., 参数_结果图片.宽度), 2)))
        .如果真结束
        .如果真 (小于 (参数_原图高度, .))
            赋值 (参数_结果图片.高度, 参数_原图高度)
            赋值 (参数_结果图片.顶边, 取整 (相除 (相减 (., 参数_结果图片.高度), 2)))
            赋值 (参数_结果图片.宽度, 参数_原图宽度)
            赋值 (参数_结果图片.左边, 取整 (相除 (相减 (., 参数_结果图片.宽度), 2)))
            
        .如果真结束
        
    .如果结束
    
.如果真结束
.如果真 (小于 (相除 (参数_原图高度, 参数_原图宽度), 0.75))
     ' 以宽度决定高度
    .如果 (全局_缩放图片)
        赋值 (参数_结果图片.宽度, .)
        赋值 (参数_结果图片.左边, 0)
        赋值 (参数_结果图片.高度, 取整 (相乘 (相除 (参数_结果图片.宽度, 参数_原图宽度), 参数_原图高度)))
        赋值 (参数_结果图片.顶边, 取整 (相除 (相减 (., 参数_结果图片.高度), 2)))
    .否则
        .如果真 (大于或等于 (参数_原图宽度, .))
            赋值 (参数_结果图片.宽度, .)
            赋值 (参数_结果图片.左边, 0)
            赋值 (参数_结果图片.高度, 取整 (相乘 (相除 (参数_结果图片.宽度, 参数_原图宽度), 参数_原图高度)))
            赋值 (参数_结果图片.顶边, 取整 (相除 (相减 (., 参数_结果图片.高度), 2)))
        .如果真结束
        .如果真 (小于 (参数_原图宽度, .))
            赋值 (参数_结果图片.宽度, 参数_原图宽度)
            赋值 (参数_结果图片.左边, 取整 (相除 (相减 (., 参数_结果图片.宽度), 2)))
            赋值 (参数_结果图片.高度, 参数_原图高度)
            赋值 (参数_结果图片.顶边, 取整 (相除 (相减 (., 参数_结果图片.高度), 2)))
        .如果真结束
        
    .如果结束
    
.如果真结束


.子程序 子程序_周期事件, 空白型, , 
.参数 hwnd, 空白型, , 
.参数 uMsg, 空白型, , 
.参数 idevent, 空白型, , 
.参数 dwTime, 空白型, , 

子程序_显示图片 (#向前)

.子程序 子程序_播放幻灯, 空白型, , 
设置时钟_ (_启动窗口.取窗口句柄 (), 1, 相乘 (全局_幻灯周期, 1000), &子程序_周期事件)
赋值 (变量_播放状态, 真)
赋值 (., #暂停按钮)
赋值 (., “暂停(&Pause)”)

.子程序 子程序_暂停播放, 空白型, , 
销毁时钟_ (_启动窗口.取窗口句柄 (), 1)
赋值 (变量_播放状态, 假)
赋值 (., #播放按钮)
赋值 (., “播放(&Play)”)

.子程序 _图形按钮_关闭程序_被单击, 空白型, , 
结束 ()

.子程序 _图形按钮_最小化_被单击, 空白型, , 
赋值 (_启动窗口., 2)

.子程序 _图形按钮_全屏幕_被单击, 空白型, , 
子程序_改变窗口大小 ()

.子程序 __启动窗口_尺寸被改变, 空白型, , 
.如果 (等于 (_启动窗口., 1040))
    赋值 (_启动窗口., 784)
    赋值 (全局_幻灯大小, 4)
.否则
    .如果真 (等于 (_启动窗口., 336))
        赋值 (_启动窗口., 256)
        赋值 (全局_幻灯大小, 1)
    .如果真结束
    .如果真 (等于 (_启动窗口., 640))
        赋值 (_启动窗口., 480)
    .如果真结束
    .如果真 (等于 (_启动窗口., 656))
        赋值 (_启动窗口., 496)
        赋值 (全局_幻灯大小, 2)
    .如果真结束
    .如果真 (等于 (_启动窗口., 800))
        赋值 (_启动窗口., 600)
    .如果真结束
    .如果真 (等于 (_启动窗口., 816))
        赋值 (_启动窗口., 616)
        赋值 (全局_幻灯大小, 3)
    .如果真结束
    .如果真 (等于 (_启动窗口., 1024))
        赋值 (_启动窗口., 768)
    .如果真结束
    .如果真 (大于 (_启动窗口., 1024))
        赋值 (_启动窗口., 1040)
        赋值 (_启动窗口., 1)
    .如果真结束
    
.如果结束
赋值 (., 相减 (_启动窗口., 16))
赋值 (., 相减 (_启动窗口., 8))
赋值 (., 相减 (_启动窗口., 16))
赋值 (., 相减 (_启动窗口., 8))
赋值 (., 相减 (_启动窗口., 8))
赋值 (., 相减 (_启动窗口., 16))
赋值 (., 相减 (_启动窗口., 8))
赋值 (., 相减 (_启动窗口., 16))
赋值 (., 相减 (_启动窗口., 8))
赋值 (., 相减 (_启动窗口., 8))
赋值 (., 相减 (_启动窗口., 16))
赋值 (., 相减 (., 16))
赋值 (., 相减 (., 16))
赋值 (., 相减 (相除 (_启动窗口., 2), 4))
赋值 (., 相减 (., 16))
赋值 (., 相加 (., 15))
赋值 (., 相减 (_启动窗口., 16))
赋值 (., 相减 (_启动窗口., 16))
子程序_显示图片 (#不变)

.子程序 __启动窗口_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

子程序_改变窗口大小 ()

.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (全局_幻灯大小, 1)
赋值 (全局_幻灯周期, 5)
赋值 (全局_当前图片, 0)
赋值 (全局_图片路径, “”)
赋值 (全局_缩放图片, 假)
赋值 (变量_播放状态, 假)
重定义数组 (全局_图片列表, 假, 0)
赋值 (., 真)

.子程序 _画板_主图片_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

子程序_改变窗口大小 ()

.子程序 _图形按钮_浏览文件夹_被单击, 空白型, , 选择图片所在文件夹
.局部变量 局部_图片列表, 文本型, , "0", 
.局部变量 局部_图片路径, 文本型, , , 

重定义数组 (局部_图片列表, 假, 0)
赋值 (局部_图片路径, 子程序_打开浏览文件夹对话框 (_启动窗口.取窗口句柄 (), “请选择图片目录”))
子程序_置图片文件列表 (局部_图片路径, 局部_图片列表)
.如果 (大于 (取数组成员数 (局部_图片列表), 0))
    赋值 (全局_图片路径, 局部_图片路径)
    赋值 (全局_图片列表, 局部_图片列表)
    赋值 (., 假)
    赋值 (全局_当前图片, 1)
    子程序_显示图片 (#不变)
    子程序_播放幻灯 ()
.否则
    
.如果结束


.子程序 _图形按钮_控制_被单击, 空白型, , 
.如果真 (不等于 (取数组成员数 (全局_图片列表), 0))
    .如果 (变量_播放状态)
        子程序_暂停播放 ()
    .否则
        子程序_播放幻灯 ()
    .如果结束
    
.如果真结束


.子程序 _图形按钮_配置_被单击, 空白型, , 
载入 (窗口_程序配置, _启动窗口, 真)

.子程序 _图形按钮_前进_被单击, 空白型, , 
.如果真 (不等于 (取数组成员数 (全局_图片列表), 0))
    子程序_显示图片 (#向前)
    子程序_暂停播放 ()
.如果真结束


.子程序 _图形按钮_后退_被单击, 空白型, , 
.如果真 (不等于 (取数组成员数 (全局_图片列表), 0))
    子程序_显示图片 (#后退)
    子程序_暂停播放 ()
.如果真结束


.子程序 _配置_被选择, 空白型, , 
载入 (窗口_程序配置, _启动窗口, 真)

.子程序 _退出_被选择, 空白型, , 
结束 ()

.子程序 _播放控制_被选择, 空白型, , 
.如果真 (不等于 (取数组成员数 (全局_图片列表), 0))
    .如果 (变量_播放状态)
        子程序_暂停播放 ()
    .否则
        子程序_播放幻灯 ()
    .如果结束
    
.如果真结束


.子程序 _关于本程序_被选择, 空白型, , 
信息框 (相加 (“Shuewood Slider 幻灯播放程序 V1.0.1 Alpha build 0082 简体中文版”, #换行符, “这是一个免费程序，你可以随意复制和传播它。但是请保持它的版权信息和程序的完整性。”, #换行符, “作者：Warland Lynia(奇迹鸟)”, #换行符, “Email：qcmaster@163.com”, #换行符, “Web：http://my.mofile.com/robinhood002”), 64, “关于Shuewood Slider 幻灯播放程序”)

.子程序 _画板_主图片_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _选择文件夹_被选择, 空白型, , 
_图形按钮_浏览文件夹_被单击 ()

.窗口程序集 窗口程序集_程序配置, , , 

.子程序 _编辑框1_内容被改变, 空白型, , 
.如果真 (大于 (到数值 (.), 60))
    赋值 (., “60”)
.如果真结束
.如果真 (等于 (到数值 (.), 0))
    赋值 (., “1”)
.如果真结束


.子程序 _按钮_取消_被单击, 空白型, , 
窗口_程序配置.销毁 ()

.子程序 _按钮_恢复默认_被单击, 空白型, , 
赋值 (., 真)
赋值 (., 假)
赋值 (., 假)
赋值 (., 假)
赋值 (., “5”)
赋值 (., 假)
赋值 (全局_缩放图片, 假)
赋值 (全局_幻灯大小, 1)
赋值 (全局_幻灯周期, 5)

.子程序 _按钮_确定_被单击, 空白型, , 
.如果真 (等于 (., 真))
    赋值 (全局_幻灯大小, 1)
.如果真结束
.如果真 (等于 (., 真))
    赋值 (全局_幻灯大小, 2)
.如果真结束
.如果真 (等于 (., 真))
    赋值 (全局_幻灯大小, 3)
.如果真结束
.如果真 (等于 (., 真))
    赋值 (全局_幻灯大小, 4)
.如果真结束
赋值 (全局_缩放图片, .)
赋值 (全局_幻灯周期, 到数值 (.))
子程序_应用设置 ()
窗口_程序配置.销毁 ()

.子程序 _窗口_程序配置_创建完毕, 空白型, , 
.局部变量 局部_屏幕宽度, 整数型, , , 

赋值 (局部_屏幕宽度, 取屏幕宽度 ())
.如果真 (小于或等于 (局部_屏幕宽度, 640))
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., 真)
.如果真结束
.如果真 (小于或等于 (局部_屏幕宽度, 800))
    赋值 (., 假)
    赋值 (., 真)
    赋值 (., 真)
.如果真结束
.如果真 (小于或等于 (局部_屏幕宽度, 1024))
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 真)
.如果真结束
.如果真 (大于 (局部_屏幕宽度, 1024))
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
.如果真结束
.如果真 (等于 (全局_幻灯大小, 1))
    赋值 (., 真)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
.如果真结束
.如果真 (等于 (全局_幻灯大小, 2))
    赋值 (., 假)
    赋值 (., 真)
    赋值 (., 假)
    赋值 (., 假)
.如果真结束
.如果真 (等于 (全局_幻灯大小, 3))
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 真)
    赋值 (., 假)
.如果真结束
.如果真 (等于 (全局_幻灯大小, 4))
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 真)
.如果真结束
赋值 (., 全局_缩放图片)
赋值 (., 到文本 (全局_幻灯周期))


 ' 不属于任何一个程序集、类模块的函数：
