 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 509
    高度 = 426
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “示例多个技巧应用”
    帮助文件名 = “”

窗口 应用改变列标题布局
    左边 = 50
    顶边 = 50
    宽度 = 784
    高度 = 585
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 计算字段
    左边 = 50
    顶边 = 50
    宽度 = 541
    高度 = 417
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “自定义字段显示文字”
    帮助文件名 = “”

窗口 文字突出显示窗口
    左边 = 50
    顶边 = 50
    宽度 = 541
    高度 = 417
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “文字突出显示”
    帮助文件名 = “”

窗口 切换行选中状态窗口
    左边 = 50
    顶边 = 50
    宽度 = 715
    高度 = 536
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 重新排序窗口
    左边 = 50
    顶边 = 50
    宽度 = 601
    高度 = 441
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “按列重新排序示例”
    帮助文件名 = “”

窗口 负数红字显示
    左边 = 50
    顶边 = 50
    宽度 = 521
    高度 = 503
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “负数红字显示”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' gregn40.npk {715CBE0F-4F50-46EF-B009-CACED3A5C866}#4.0#0 1 0 grproLib 0,{F803AE1D-B578-490A-A1FE-38976AD2B625},IGRGroup,{3,4,5,},{11,10,6,2,1,},{}0,{07120975-B963-4F85-9B4D-0AC979FEBB5D},IGRObject,{},{},{}0,{5C2FC87F-12F8-4A09-8A4A-792671C03C74},IGRGroupHeader,{2,3,8,106,},{208,207,206,205,204,203,202,201,105,104,103,102,20,10,9,7,6,5,4,1,},{}0,{36971202-D715-4AFC-83D4-7C0DDD8872E8},IGRGroupSection,{2,3,8,106,},{105,104,103,102,20,10,9,7,6,5,4,1,},{}0,{77FD1006-7067-41FF-A712-0F356A6ACE8C},IGRSection,{2,3,8,},{20,10,9,7,6,5,4,1,},{}0,{D4708B2F-DC00-4EF6-9559-A5DD9E86047C},IGRFont,{1,2,1,},{10,9,8,7,6,5,4,3,},{}0,{48636E6A-758E-46C0-B37A-C2A2CAC9469A},IGRControls,{0,-4,2,3,4,5,6,},{1,},{}0,{07120975-B963-4F75-9B4D-0AC979FEBB5D},IGRControl,{4,6,30,31,32,33,34,35,36,37,38,39,40,41,50,51,52,53,},{28,27,26,25,24,23,22,21,20,18,17,14,13,12,11,10,9,8,5,3,2,1,},{}0,{894581CD-48E7-4FD0-9184-7E8BD1563BE0},GRControlType,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRControlType,{},{1073741834,1073741833,1073741832,1073741831,1073741830,1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{CC0F0DB7-E7CE-4625-9636-2539CD1D8A0B},GRAnchorStyles,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRAnchorStyle,{},{1073741827,1073741826,1073741825,1073741824,},{}0,{A3081B46-DDE5-4EF5-B425-A1FDEDCD4489},GRDockStyle,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRDockStyle,{},{1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{6824D157-008C-4011-AC18-DD06F93D7F30},GRCenterStyle,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRCenterStyle,{},{1073741827,1073741826,1073741825,1073741824,},{}0,{132FDE21-7F91-4210-9F24-89296F70727B},GRBorderStyles,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRBorderStyle,{},{1073741827,1073741826,1073741825,1073741824,},{}0,{A9684343-169F-4FA3-AA8C-1D9D09224E24},GRAlignColumnStyle,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRAlignColumnSideStyle,{},{1073741826,1073741825,1073741824,},{}0,{35AE9572-D5B1-44FF-AF1D-E1E4559FEB72},GRBackStyle,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRBackStyle,{},{1073741825,1073741824,},{}0,{317E6B05-678A-4D20-A85B-29AD1C6CAC26},GRPrintType,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRPrintType,{},{1073741825,1073741824,},{}0,{4E540578-5C41-40AC-95D8-898F511F7D19},GRDisplayCursor,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRDisplayCursor,{},{1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{6A246AC9-1715-40B6-A483-DE9F3E8DA43C},IGRTextBox,{4,6,30,31,32,33,34,35,36,37,38,39,40,41,50,51,52,53,},{110,109,108,107,106,105,104,103,102,100,28,27,26,25,24,23,22,21,20,18,17,14,13,12,11,10,9,8,5,3,2,1,},{}0,{38EFB0EF-1C46-4840-8C3F-C32C089A0D33},GRTextAlign,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRTextAlign,{},{1073741832,1073741831,1073741830,1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{6E67E792-F184-4E77-B5A4-8AD9ABDF774F},GRFieldType,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRFieldType,{},{1073741830,1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{E66EBBF5-ED8D-44E7-8A6C-E6579ADCC7D4},IGRChart,{4,6,30,31,32,33,34,35,36,37,38,39,40,41,50,51,52,53,103,141,141,143,143,144,144,180,181,182,183,},{170,161,160,149,148,147,146,145,142,140,132,131,130,126,125,124,123,122,121,120,113,112,111,110,104,102,101,28,27,26,25,24,23,22,21,20,18,17,14,13,12,11,10,9,8,5,3,2,1,},{}0,{13B14F32-370D-44B3-B601-56FA540622FD},GRChartType,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRChartType,{},{1073741826,1073741825,1073741824,},{}0,{B4AF4881-7230-4AE0-8D3A-02F96F339454},IGRStaticBox,{4,6,30,31,32,33,34,35,36,37,38,39,40,41,50,51,52,53,},{201,200,110,109,108,107,106,105,104,103,102,100,28,27,26,25,24,23,22,21,20,18,17,14,13,12,11,10,9,8,5,3,2,1,},{}0,{C04A6143-7500-41EF-8062-BD89A0A92D40},IGRShapeBox,{4,6,30,31,32,33,34,35,36,37,38,39,40,41,50,51,52,53,},{121,120,110,108,107,106,105,104,101,28,27,26,25,24,23,22,21,20,18,17,14,13,12,11,10,9,8,5,3,2,1,},{}0,{B003E61B-E95A-40B2-8CB2-D55AA56F8FDE},GRShapeType,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRShapeBoxType,{},{1073741830,1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{0DEAAFDB-2933-47AC-B266-8F03DE6338DD},GRPenStyle,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRPenStyle,{},{1073741830,1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{7804DD94-1861-4232-87EF-39037B418CF2},GRLineType,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRLineType,{},{1073741831,1073741830,1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{28845384-ED9F-4D2E-986E-D52AC37A108F},IGRSystemVarBox,{4,6,30,31,32,33,34,35,36,37,38,39,40,41,50,51,52,53,},{201,200,110,109,108,107,106,105,104,103,102,100,28,27,26,25,24,23,22,21,20,18,17,14,13,12,11,10,9,8,5,3,2,1,},{}0,{6613E652-BAEC-4ADE-A8FD-85DFCD70854E},GRSystemVarType,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRSystemVar,{},{1073741831,1073741830,1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{FE9AA791-4C55-4E06-A592-08D8DF88A941},IGRFieldBox,{4,6,30,31,32,33,34,35,36,37,38,39,40,41,50,51,52,53,},{200,110,109,108,107,106,105,104,103,102,100,28,27,26,25,24,23,22,21,20,18,17,14,13,12,11,10,9,8,5,3,2,1,},{}0,{24DE1EBE-5D9C-40EC-A11A-21AF7D0C0D36},IGRSummaryBox,{4,6,30,31,32,33,34,35,36,37,38,39,40,41,50,51,52,53,},{203,202,201,200,110,109,108,107,106,105,104,103,102,100,28,27,26,25,24,23,22,21,20,18,17,14,13,12,11,10,9,8,5,3,2,1,},{}0,{57EBAB7D-A526-4E04-8419-247595ACDA27},GRSummaryFun,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRSummaryFun,{},{1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{C04A6148-7500-41EF-8062-BD89A0A92D40},IGRPictureBox,{4,6,30,31,32,33,34,35,36,37,38,39,40,41,50,51,52,53,104,110,112,104,},{105,103,102,101,28,27,26,25,24,23,22,21,20,18,17,14,13,12,11,10,9,8,5,3,2,1,},{}0,{B003E61B-E95A-40B3-8CB2-D55AA56F8FDE},GRPictureAlignment,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRPictureAlignment,{},{1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{B003E61B-E96A-40B3-8CB2-D55AA56F8FDE},GRPictureSizeMode,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRPictureSizeMode,{},{1073741827,1073741826,1073741825,1073741824,},{}0,{5C038FCC-BB3A-4F99-86AC-139D730A5C8C},GRSystemImage,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRSystemImage,{},{1073741831,1073741830,1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{C04A6148-7511-41EF-8062-BD89A0A92D40},IGRRichTextBox,{4,6,30,31,32,33,34,35,36,37,38,39,40,41,50,51,52,53,110,},{104,103,102,101,28,27,26,25,24,23,22,21,20,18,17,14,13,12,11,10,9,8,5,3,2,1,},{}0,{39A2C13A-D695-44BD-8339-A94FA64CB62B},IGRMemoBox,{4,6,30,31,32,33,34,35,36,37,38,39,40,41,50,51,52,53,},{210,209,208,207,206,205,204,203,202,201,200,110,109,108,107,106,105,104,103,102,100,28,27,26,25,24,23,22,21,20,18,17,14,13,12,11,10,9,8,5,3,2,1,},{}0,{3E5F5B68-76AD-4901-94EE-D370231D6EB5},GRTextOrientation,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRTextOrientation,{},{1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{CDAA7F5B-E100-49B7-93F2-6B66FC93BE55},IGRSubReport,{4,6,30,31,32,33,34,35,36,37,38,39,40,41,50,51,52,53,101,101,},{104,103,102,28,27,26,25,24,23,22,21,20,18,17,14,13,12,11,10,9,8,5,3,2,1,},{}0,{C4D3E1B2-EB0A-4D06-B2B2-B9A0E5E5708F},IGRSections,{0,-4,2,3,4,},{1,},{}0,{E005D9F9-8093-4E0E-9AA7-55F1C8096B46},GRSectionType,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRSectionType,{},{1073741831,1073741830,1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{CB11F828-A97B-4BC3-9B7A-9D2DDEB1C229},IGRDetailGrid,{2,40,41,42,43,44,45,50,51,52,53,54,55,56,},{22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,1,},{}0,{8F30B065-CE80-49C2-9898-D1C67BBF4C11},GRPageColumnDirection,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRPageColumnDirection,{},{1073741825,1073741824,},{}0,{9F918AEE-5C34-4EC7-BA4D-829588964D93},GRColumnPrintAdaptMethod,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRColumnPrintAdaptMethod,{},{1073741831,1073741830,1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{0B1C4720-6C96-4FBA-BD8E-AFB487A94638},GRNewPageStyle,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRNewPageStyle,{},{1073741827,1073741826,1073741825,1073741824,},{}0,{23F65787-D22B-4CA6-BA49-D22B63CA353A},IGRColumnContent,{2,3,8,24,159,180,},{173,172,158,157,25,20,10,9,7,6,5,4,1,},{}0,{C765E825-5F52-44CB-AAB6-FA89376DA4C0},IGRColumnSection,{2,3,8,24,},{25,20,10,9,7,6,5,4,1,},{}0,{AF39550B-2A23-418A-ACEC-812C70EA5A62},IGRColumnContentCells,{0,-4,3,},{1,},{}0,{BB12AEBD-5839-4A5E-9944-65B6798381C8},IGRColumnContentCell,{4,9,10,50,60,},{55,54,53,52,51,14,13,12,8,7,6,5,3,2,1,},{}0,{E2F421D7-73FA-462F-9BF5-7DA3E512CA00},IGRColumnCell,{4,9,10,},{14,13,12,8,7,6,5,3,2,1,},{}0,{72A79692-2F9E-4FEC-92CC-6B4A7375A3D6},IGRColumn,{5,6,7,},{4,3,2,},{}0,{83CC68EF-B558-45BB-8023-6C4F3BDADA7B},IGRColumnTitleCell,{4,9,10,60,61,65,66,},{53,52,51,50,14,13,12,8,7,6,5,3,2,1,},{}0,{08513FC1-CCCE-4603-8DD1-35BA1CA8D1CD},IGRColumnTitle,{2,3,8,24,156,},{164,25,20,10,9,7,6,5,4,1,},{}0,{97502458-7024-4194-9598-5B62001D8C1A},IGRColumnTitleCells,{0,-4,3,6,7,},{1,},{}0,{DA073B30-05A7-4433-9BA4-E9DD697A3A0B},GRRepeatStyle,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRRepeatStyle,{},{1073741827,1073741826,1073741825,1073741824,},{}0,{42F6AF5F-5FC4-4F44-9812-1FBD9224CE2C},IGRColumns,{0,-4,2,3,4,5,},{1,},{}0,{488B2328-67C0-42D1-A133-303FF60D8AE2},IGRGroups,{0,-4,2,3,4,5,},{1,},{}0,{93CD76F7-5439-437F-8FA5-A650F2CA773C},IGRRecordset,{1,30,31,32,33,34,35,36,37,38,39,40,41,43,44,45,46,},{23,22,21,20,12,11,10,9,8,7,6,5,4,3,2,},{}0,{F00CE27D-D1E3-4EF6-9877-BF3233EBF551},IGRFields,{0,-4,2,3,4,5,},{1,},{}0,{04CEA260-DD00-4954-A81F-F0A201343CB9},IGRField,{5,30,31,5,},{20,16,15,14,13,12,11,10,9,8,7,6,4,3,2,1,},{}0,{00000000-0000-0000-0000-000000000000},LONG_PTR,{},{},{}0,{FF26DE0B-6A74-4B4D-863B-9215CA55A1BC},GRGridRowType,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRDetailGridRowType,{},{1073741826,1073741825,1073741824,},{}0,{7FC1D3A0-693F-486E-BDF3-02E98F50F9F3},IGRPageHeader,{2,3,8,},{20,10,9,7,6,5,4,1,},{}0,{AACDAA8B-5EBB-4CC7-BCB9-C300FE7184A5},IGRPageFooter,{2,3,8,},{20,10,9,7,6,5,4,1,},{}0,{F82DF93F-5FF2-40A6-B50B-016666EC08CA},IGRReportHeader,{2,3,8,},{107,106,105,20,10,9,7,6,5,4,1,},{}0,{B2CC2C43-CF42-4E38-BDBB-5C04DF11793F},IGRReportFooter,{2,3,8,},{108,107,106,105,20,10,9,7,6,5,4,1,},{}0,{D40307C2-9342-4C0D-9734-A103418186FE},IGRParameters,{0,-4,2,3,4,5,},{1,},{}0,{23AF6C8A-0F15-45E3-A10D-9373BB15AC86},IGRParameter,{3,3,},{13,12,11,10,9,8,7,4,2,1,},{}0,{43F958BE-80B0-4796-8E1E-65491B1B1B15},GRParameterDataType,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRParameterDataType,{},{1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{B46455D8-7F29-4DF7-9CF8-56B3D8A9DECE},GRUnit,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRUnit,{},{1073741825,1073741824,},{}0,{CF6671CE-BF4D-47FE-968C-EF7C8642BF90},GRScriptType,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRScriptType,{},{1073741825,1073741824,},{}0,{9F284C9C-9A84-48C3-873D-2B1B0BFFDFC0},GRStorageFormat,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRStorageFormat,{},{1073741827,1073741826,1073741825,1073741824,},{}0,{1857E38D-78BB-47EF-8D79-E2E75016BEF0},GRPaperOrientation,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRPaperOrientation,{},{1073741826,1073741825,1073741824,},{}0,{8F20CAE4-4834-49AD-A5F1-D9F8A39CB686},GRPaperSourceKind,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRPaperSourceKind,{},{1073741838,1073741837,1073741836,1073741835,1073741834,1073741833,1073741832,1073741831,1073741830,1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{B32A741E-6B5A-4B11-829D-79740831615F},GRCollateKind,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRCollateKind,{},{1073741826,1073741825,1073741824,},{}0,{98EB2E1C-D193-4649-853F-0796CB030D40},GRDuplexKind,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRDuplexKind,{},{1073741827,1073741826,1073741825,1073741824,},{}0,{C1FC7BFF-5097-450D-BBC2-745BF46B478F},GRPaperKind,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRPaperKind,{},{1073741869,1073741868,1073741867,1073741866,1073741865,1073741864,1073741863,1073741862,1073741861,1073741860,1073741859,1073741858,1073741857,1073741856,1073741855,1073741854,1073741853,1073741852,1073741851,1073741850,1073741849,1073741848,1073741847,1073741846,1073741845,1073741844,1073741843,1073741842,1073741841,1073741840,1073741839,1073741838,1073741837,1073741836,1073741835,1073741834,1073741833,1073741832,1073741831,1073741830,1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{17B23325-7316-4098-9FE3-B5A1C24DB296},IGRPrinter,{51,52,53,},{43,42,41,40,24,23,22,21,20,19,18,17,16,15,14,13,12,11,7,6,5,4,3,2,1,},{}0,{CC18C8CD-0535-4869-8214-55B766B09AB2},GRPrintRangeType,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRPrintRangeType,{},{1073741826,1073741825,1073741824,},{}0,{CC18C8CD-0525-4769-8214-55B766B09AB2},GRPrintPageType,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRPrintPageType,{},{1073741826,1073741825,1073741824,},{}0,{01056F48-F4AB-4D9F-BE45-614F3313717D},IGRImageList,{1,3,4,6,7,},{2,},{}0,{CE18C8CD-0525-4869-8214-55B766B09AB2},GRReportDisplayMode,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRReportDisplayMode,{},{1073741826,1073741825,1073741824,},{}0,{FEFD0FDE-919E-4667-B5BC-435E171107AB},GRPrintGenerateStyle,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRPrintGenerateStyle,{},{1073741826,1073741825,1073741824,},{}0,{F28567EB-0F37-4701-A474-2FCB2DC353DD},GRExportType,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRExportType,{},{1073741830,1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{60EB191F-5E63-41E7-807F-C66EC7A8EF26},IGRExportOption,{2,3,4,5,6,7,8,20,},{9,1,},{}0,{60EB191F-5E63-41E7-808F-C66EC7A8EF26},IGRE2XLSOption,{2,3,4,5,6,7,8,20,},{56,55,54,53,52,51,50,9,1,},{}0,{3BB506AB-425B-43B0-BC82-28A61FCCF686},IGRE2TXTOption,{2,3,4,5,6,7,8,20,},{56,55,54,53,52,51,50,9,1,},{}0,{F5D15E31-FA9A-42BE-BE9C-8688E7D9D6A0},IGRE2HTMOption,{2,3,4,5,6,7,8,20,},{57,56,55,54,53,52,51,50,9,1,},{}0,{F4AA885F-AF9C-4032-A65A-F3DFD458C289},IGRE2RTFOption,{2,3,4,5,6,7,8,20,},{9,1,},{}0,{273631DD-1CAC-49E9-92EE-584F48921A1E},IGRE2PDFOption,{2,3,4,5,6,7,8,20,},{9,1,},{}0,{F623A5E8-4AE4-494E-975B-3C5404428625},IGRE2CSVOption,{2,3,4,5,6,7,8,20,},{54,53,52,51,50,9,1,},{}0,{81727F33-8D8C-45DC-B525-07ABDC5FB652},IGRE2IMGOption,{2,3,4,5,6,7,8,20,},{50,9,1,},{}0,{C2883B98-3A72-4A6B-8D40-3EAC694A52CA},GRExportImageType,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRExportImageType,{},{1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{5BCB27BB-9750-4B28-9384-77801FB0D4EB},IGRSharePrintSetupObject,{51,52,53,},{23,22,21,20,19,18,17,16,15,14,13,12,11,},{}0,{5A0CE871-44CF-4341-BA6B-0EE444783B86},GRSharePrintSetupOption,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRSharePrintSetupOption,{},{1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{C4ACA069-B92C-401A-B175-354E00D538D9},IGRLine,{4,6,30,31,32,33,34,35,36,37,38,39,40,41,50,51,52,53,},{107,106,105,104,103,102,101,28,27,26,25,24,23,22,21,20,18,17,14,13,12,11,10,9,8,5,3,2,1,},{}0,{0B950C08-D99A-4A90-9D8B-E8A0DCF6D11B},GROCGroupHeaderVAlign,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGROCGroupHeaderVAlign,{},{1073741826,1073741825,1073741824,},{}0,{FADD92D3-6351-4088-B14F-AD4EB326722D},GRNewPageColumnStyle,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRNewPageColumnStyle,{},{1073741827,1073741826,1073741825,1073741824,},{}0,{C05ACBDB-C2F8-4D02-AD46-55B9061BDF89},GRGrpKpTogetherStyle,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRGrpKpTogetherStyle,{},{1073741826,1073741825,1073741824,},{}0,{B753063D-AEBA-4E5E-B53A-F89B68F1F622},IGRGroupFooter,{2,3,8,106,},{201,105,104,103,102,20,10,9,7,6,5,4,1,},{}0,{13C28AD0-F195-4319-B7D7-A1BDAA329FB6},GridppReport,{2,3,4,5,6,7,10,17,35,37,75,76,100,101,102,103,104,105,106,107,108,110,111,112,113,114,115,116,117,120,121,122,123,124,125,130,131,132,133,134,135,136,137,138,140,141,143,144,146,147,150,160,162,170,171,172,173,181,182,183,185,186,35,37,},{180,94,93,92,91,90,85,84,83,82,81,80,73,72,71,70,69,68,67,66,65,64,63,62,61,54,53,52,51,50,40,39,38,23,36,34,32,31,30,25,22,21,16,18,15,14,13,12,11,9,8,1,},{1,2,3,4,30,31,32,33,34,35,36,37,23,20,22,40,41,42,43,}0,{CC18C8CD-0525-4869-8214-55B766B09AB2},GRShiftStates,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRShiftState,{},{1073741830,1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{14143D7A-5315-4B64-8B07-99A2B79D4BFE},GRMouseButton,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRMouseButton,{},{1073741826,1073741825,1073741824,},{}1,{613F3AE0-D4EB-4F9F-B750-576C0970034F},GRDisplayViewer,{1,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,41,42,43,1,},{62,78,77,76,75,74,73,72,71,70,61,60,57,56,55,54,53,52,51,50,-504,9,8,7,6,5,4,3,2,},{-600,-601,-602,-603,-604,-605,-607,-606,1,2,3,4,5,6,7,8,11,12,13,14,9,10,}0,{55DB78A0-8CFA-40AE-A444-3D91BE983048},GRViewerBorderStyle,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRViewerBorderStyle,{},{1073741826,1073741825,1073741824,},{}1,{E497F563-E14C-48EC-87FA-E9C514D3BC0A},GRPrintViewer,{2,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,2,},{37,36,35,34,33,32,30,31,4,3,1,},{-600,-601,-602,-603,-604,-605,-607,-606,1,2,3,4,7,8,9,}0,{55DB78E0-8CFA-40AE-A444-3D91BE983048},GRPrintViewMode,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRPrintViewMode,{},{1073741826,1073741825,1073741824,},{}0,{EEB33C85-D0C1-4D37-82B0-519DF2B3A120},GRToolControlType,{},{},{}2,{00000000-0000-0000-0000-000000000000},tagGRToolControlType,{},{1073741841,1073741840,1073741839,1073741838,1073741837,1073741836,1073741835,1073741834,1073741833,1073741832,1073741831,1073741830,1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}





.窗口程序集 启动窗口程序集, , , 本程序由水影初始创建，如果你要了解 Grid++Report 的最新信息，请访问 http://www.rubylong.cn。

.程序集变量 报表说明, 文本型, , "0", 
.程序集变量 选中项目, 整数型, , , 
.子程序 _按钮_运行_被单击, 空白型, , 
.判断开始 (等于 (.现行选中项, 0))
    载入 (应用改变列标题布局, , 真)
.判断 (等于 (.现行选中项, 1))
    载入 (计算字段, , 真)
.判断 (等于 (.现行选中项, 2))
    载入 (负数红字显示, , 真)
.判断 (等于 (.现行选中项, 3))
    载入 (文字突出显示窗口, , 真)
.判断 (等于 (.现行选中项, 4))
    载入 (切换行选中状态窗口, , 真)
.判断 (等于 (.现行选中项, 5))
    载入 (重新排序窗口, , 真)
.默认
    
.判断结束


.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 全部文本, 文本型, , "0", 
.局部变量 I, 整数型, , , 

赋值 (全部文本, 分割文本 (到文本 (读入文件 (相加 (取运行目录 (), “\..\reports\HowTo.txt”))), “>>”, ))
删除成员 (全部文本, 1, )
重定义数组 (报表说明, 假, 取数组成员数 (全部文本))

.计次循环首 (取数组成员数 (全部文本), I)
    取文本左边 (全部文本 [I], 寻找文本 (全部文本 [I], #换行符, , 假)).加入项目 ()
    赋值 (报表说明 [I], 全部文本 [I])
.计次循环尾 ()
赋值 (.现行选中项, 0)
_列表框1_列表项被选择 ()

.子程序 _按钮_退出_被单击, 空白型, , 
销毁 ()

.子程序 _列表框1_列表项被选择, 空白型, , 
赋值 (.标题, 报表说明 [相加 (.现行选中项, 1)])


.窗口程序集 应用列布局变化窗口程序集, , , 本程序由水影初始创建，如果你要了解 Grid++Report 的最新信息，请访问 http://www.rubylong.cn。

.程序集变量 主报表, 未知类型0x20094, , ,  GridppReport
.程序集变量 数据库连接文本, 文本型, , , 
.子程序 _应用改变列标题布局_创建完毕, 空白型, , 
主报表.未知支持库函数_1436 (相加 (取运行目录 (), “\..\reports\双层表头.grf”))
赋值 (数据库连接文本, 相加 (“ODBC;DBQ=”, 取运行目录 (), “\..\data\Northwind.mdb”, “;Driver={Microsoft Access Driver (*.mdb)};”))
赋值 ( [主报表.未知支持库函数_1393 ().未知支持库函数_655 ()]., 数据库连接文本)
主报表.未知支持库函数_1495 ()
未知支持库函数_1476 ()

.子程序 _按钮1_被单击, 空白型, , 
未知支持库函数_1482 ()
主报表.未知支持库函数_1429 (真)


.窗口程序集 计算字段程序集, , , 本程序由水影初始创建，如果你要了解 Grid++Report 的最新信息，请访问 http://www.rubylong.cn。

.程序集变量 主报表, 未知类型0x20094, , ,  GridppReport
.程序集变量 数据库连接文本, 文本型, , , 
.子程序 _按钮1_被单击, 空白型, , 
主报表.未知支持库函数_1429 (真)

.子程序 _计算字段_创建完毕, 空白型, , 
主报表.未知支持库函数_1436 (相加 (取运行目录 (), “\..\reports\计算字段.grf”))
赋值 (数据库连接文本, 相加 (“ODBC;DBQ=”, 取运行目录 (), “\..\data\Northwind.mdb”, “;Driver={Microsoft Access Driver (*.mdb)};”))
赋值 ( [主报表.未知支持库函数_1393 ().未知支持库函数_655 ()]., 数据库连接文本)
 ' 增加对应字段定义，也可以在模板文件中定义好，在此就不用编程定义
主报表.未知支持库函数_1386 ()
主报表.未知支持库函数_1495 ()
未知支持库函数_1476 ()

.子程序 _报表事件1_BeforePostRecord, 空白型, , 
赋值 ( [主报表.未知支持库函数_1411 (“CalcAmount”)]., 相乘 ( [主报表.未知支持库函数_1411 (“UnitPrice”)].,  [主报表.未知支持库函数_1411 (“Quantity”)].))

.子程序 _计算字段_尺寸被改变, 空白型, , 
赋值 (., 相减 (.宽度, 30))
赋值 (., 相减 (.高度, 90))

.窗口程序集 文字突出显示程序集, , , 本程序由水影初始创建，如果你要了解 Grid++Report 的最新信息，请访问 http://www.rubylong.cn。

.程序集变量 主报表, 未知类型0x20094, , ,  GridppReport
.程序集变量 数据库连接文本, 文本型, , , 
.程序集变量 内容行, 未知类型0x20048, , ,  IGRColumnContent
.程序集变量 总计内容格, 未知类型0x2004B, , ,  IGRColumnContentCell
.程序集变量 总计字段, 未知类型0x20057, , ,  IGRField
.子程序 _报表事件1_SectionFormat, 空白型, , 
.参数 pSender, 未知类型0x20005, , 

.局部变量 字体加粗, 逻辑型, , , 
.局部变量 字体加斜, 逻辑型, , , 
.局部变量 文本颜色, 整数型, , , 
.局部变量 背景颜色, 整数型, , , 

 ' .如果真 (等于 (内容行., pSender.))
     ' ' 当Amount字段的值大于等于5000时，将Amount显示为粗体，绿色,背景色为白色
     ' ' 当Amount字段的值大于等于1000时，将Amount显示为正常体，黄色,背景色为蓝色
     ' ' 当Amount字段的值小于1000时，将Amount显示为正常体，红色，背景色为白色
     ' ' 当为打印输出状态时，颜色始终为黑色,背景色始终为白色
     ' .判断开始 (大于或等于 (总计字段., 5000))
         ' 字体加粗 ＝ 真
         ' 字体加斜 ＝ 假
         ' 文本颜色 ＝ #绿色
         ' 背景颜色 ＝ #白色
     ' .判断 (大于或等于 (总计字段., 1000))
         ' 字体加粗 ＝ 假
         ' 字体加斜 ＝ 假
         ' 文本颜色 ＝ #黄色
         ' 背景颜色 ＝ #蓝色
    .默认
         ' 字体加粗 ＝ 假
         ' 字体加斜 ＝ 真
         ' 文本颜色 ＝ #红色
         ' 背景颜色 ＝ #白色
    .判断结束
    
    
     ' .如果真 (等于 (主报表., #)) ' 设定主报表显示器的输出状态为报表处于打印页面生成过程中
         ' 文本颜色 ＝ #黑色
         ' 背景颜色 ＝ #白色
        
    .如果真结束
    
     ' 总计内容格.GetFont ().Bold ＝ 字体加粗
     ' 总计内容格.GetFont ().Italic ＝ 字体加斜
     ' 总计内容格.ForeColor ＝ 文本颜色
     ' 总计内容格.BackColor ＝ 背景颜色
    
.如果真结束


.子程序 _报表事件1_Initialize, 空白型, , 
 ' 主报表.ControlByName (“MsgTextBox”).Visible ＝ 假
 ' ' 为了提高运行效率，在此记录下在响应事件中用到的报表对象的接口指针。
 ' 内容行 ＝ 主报表.GetDetailGrid ().GetColumnContent ()
 ' 总计内容格 ＝ 主报表.GetDetailGrid ().GetColumnContent ().GetContentCells ().GetItem (“Amount”)  ' 根据报表内容格名称取得内容格接口
 ' 总计字段 ＝ 主报表.FieldByName (“Amount”)  ' 根据字段名获取报表字段

.子程序 _按钮1_被单击, 空白型, , 
 ' 主报表.PrintPreview (真)  ' 执行打印预览，

.子程序 _文字突出显示窗口_创建完毕, 空白型, , 
.局部变量 查询语句, 文本型, , , 

 ' 主报表.LoadFromFile (取运行目录 () ＋ “\..\Reports\Sale summary by product.grf”)
 ' 数据库连接文本 ＝ “ODBC;DBQ=” ＋ 取运行目录 () ＋ “\..\data\Northwind.mdb” ＋ “;Driver={Microsoft Access Driver (*.mdb)};”
 ' 查询语句 ＝ “select d.Productid,p.ProductName,sum(d.Quantity) as Quantity,sum(d.UnitPrice*d.Quantity*(1-d.Discount)) as Amount from orders m inner join ([Order Details] d inner join Products p on d.ProductID=p.ProductID) on m.orderid=d.orderid where m.OrderDate between #1/1/97# And #12/31/97# group by d.Productid,p.ProductName order by d.Productid”
 ' 主报表.GetDetailGrid ().GetRecordset ().ConnectionString ＝ 数据库连接文本
 ' 主报表.GetDetailGrid ().GetRecordset ().QuerySQL ＝ 查询语句
 ' 主报表.挂接事件 (报表事件1)
 ' 查询显示器1.SetReport (主报表)
 ' 查询显示器1.Start ()


.子程序 _报表事件1_FetchRecord, 空白型, , 
.参数 pEof, 逻辑型, 参考, 

 ' 调试输出 (55)

.子程序 _文字突出显示窗口_尺寸被改变, 空白型, , 
 ' 查询显示器1.宽度 ＝ 宽度 － 50
 ' 查询显示器1.高度 ＝ 高度 － 100

.窗口程序集 切换列选中程序集, , , 本程序由水影初始创建，如果你要了解 Grid++Report 的最新信息，请访问 http://www.rubylong.cn。

.程序集变量 主报表, 未知类型0x20094, , ,  GridppReport
.程序集变量 数据库连接文本, 文本型, , , 
.子程序 _切换行选中状态窗口_创建完毕, 空白型, , 
 ' 主报表.LoadFromFile (取运行目录 () ＋ “\..\reports\CheckBoxColumn.grf”)
 ' 数据库连接文本 ＝ “ODBC;DBQ=” ＋ 取运行目录 () ＋ “\..\data\Northwind.mdb” ＋ “;Driver={Microsoft Access Driver (*.mdb)};”  ' 在本例程不需要本行代码，可以屏蔽，因模板文件已经设置（hgf686注）

 ' ' 设置与数据源的连接串，因为在设计时指定的数据库路径是绝对路径。
 ' ' 主报表.GetDetailGrid ().GetRecordset ().ConnectionString ＝ 数据库连接文本  ' 在本例程不需要本行代码，可以屏蔽（hgf686注）
 ' 主报表.挂接事件 (报表事件1)
 ' 查询显示器1.SetReport (主报表)
 ' 查询显示器1.Start ()

.子程序 _报表事件1_BeforePostRecord, 空白型, , 
 ' .如果真 (等于 ( [主报表.未知支持库函数_1411 (“Checked”)]., 真))
     ' 主报表.FieldByName (“Checked”).AsInteger ＝ #tagGRSystemImage.grsi3DUnchecked
.如果真结束


.子程序 _查询显示器1_ContentCellClick, 空白型, , 
.参数 pSender, 未知类型0x2004B, ,  IGRColumnContentCell

.局部变量 参数对象, 对象, , , 
.局部变量 字段对象, 对象, , , 
.局部变量 文本框, 未知类型0x2003A, , , 

 ' 参数对象.取接口 (pSender.GetColumn (), )
 ' 字段对象.取接口 (主报表.ColumnByName (“CheckBox”), )
 ' .如果真 (参数对象.是否相等 (字段对象))
     ' 主报表.GetDetailGrid ().GetRecordset ().Edit ()
     ' .如果 (等于 ( [主报表.未知支持库函数_1411 (“Checked”)]., #))
         ' 主报表.FieldByName (“Checked”).AsInteger ＝ #tagGRSystemImage.grsi3DChecked
    .否则
         ' 主报表.FieldByName (“Checked”).AsInteger ＝ #tagGRSystemImage.grsi3DUnchecked
    .如果结束
     ' 主报表.GetDetailGrid ().GetRecordset ().Post ()
     ' 查询显示器1.UpdateSelCell ()
    
    
    
     ' 文本框 ＝ 主报表.ControlByName (“CheckedRowMemo”).GetAsMemoBox ()
     ' 文本框.Text ＝ “选中行：”
     ' 主报表.GetDetailGrid ().GetRecordset ().First ()
     ' .判断循环首 (取反 (主报表.未知支持库函数_1393 ().未知支持库函数_655 ().未知支持库函数_872 ()))
         ' .如果真 (等于 ( [主报表.未知支持库函数_1411 (“Checked”)]., #))
             ' 文本框.Text ＝ 文本框.Text ＋ “;” ＋ 主报表.FieldByName (“CustomerID”).AsString
        .如果真结束
         ' 主报表.GetDetailGrid ().GetRecordset ().Next ()
     ' .判断循环尾 ()
    
     ' 查询显示器1.UpdateControl (主报表.ControlByName (“CheckedRowMemo”))
    
.如果真结束


.子程序 _按钮2_被单击, 空白型, , 
 ' 主报表.PrintPreview (真)

.子程序 _按钮1_被单击, 空白型, , 
 ' 主报表.Print (真)

.窗口程序集 按列排序窗口程序集, , , 本程序由水影初始创建，如果你要了解 Grid++Report 的最新信息，请访问 http://www.rubylong.cn。

.程序集变量 主报表, 未知类型0x20094, , , GridppReport
.程序集变量 数据库连接文本, 文本型, , , 
.子程序 _重新排序窗口_创建完毕, 空白型, , 
 ' 主报表.LoadFromFile (取运行目录 () ＋ “\..\reports\ResortRegroup.grf”)
 ' 数据库连接文本 ＝ “ODBC;DBQ=” ＋ 取运行目录 () ＋ “\..\data\Northwind.mdb” ＋ “;Driver={Microsoft Access Driver (*.mdb)};”
 ' 主报表.GetDetailGrid ().GetRecordset ().ConnectionString ＝ 数据库连接文本
 ' 主报表.挂接事件 (报表事件1)
 ' 查询显示器1.SetReport (主报表)
 ' 查询显示器1.Start ()


.子程序 _报表事件1_BeforeSort, 空白型, , 
.参数 SortFields, 文本型, , 

.局部变量 标题框, 未知类型0x20023, , , IGRStaticBox

 ' .判断开始 (等于 (SortFields, “OrderDate”))
     ' 主报表.GetDetailGrid ().GetGroups ().GetItem (1).ByFields ＝ SortFields
 ' .判断 (或者 (等于 (SortFields, “CustomerID”), 等于 (SortFields, “CompanyName”)))
     ' 主报表.GetDetailGrid ().GetGroups ().GetItem (1).ByFields ＝ “CustomerID”
 ' .判断 (等于 (SortFields, “ProductName”))
     ' 主报表.GetDetailGrid ().GetGroups ().GetItem (1).ByFields ＝ SortFields
 ' .判断 (等于 (SortFields, “EmployeeName”))
     ' 主报表.GetDetailGrid ().GetGroups ().GetItem (1).ByFields ＝ SortFields
.判断 (等于 (SortFields, “OrderID”))
     ' 主报表.GetDetailGrid ().GetGroups ().GetItem (1).ByFields ＝ SortFields
.默认
     ' 主报表.GetDetailGrid ().GetGroups ().GetItem (1).ByFields ＝ “”
.判断结束

 ' ' 首先根据排序字段找到对应的列标题格,然后根据标题格文字设置付标题文字
 ' 标题框 ＝ 主报表.ControlByName (“SubTitleBox”).GetAsStaticBox ()
 ' 标题框.Text ＝ “按” ＋ 主报表.ColumnByName (SortFields).GetTitleCell ().Text ＋ “排序分组统计”
 ' 查询显示器1.UpdateControl (主报表.ControlByName (“SubTitleBox”))


.子程序 _按钮1_被单击, 空白型, , 
 ' 主报表.PrintPreview (真)


.窗口程序集 窗口程序集1, , , 

.程序集变量 主报表, 未知类型0x20094, , , 
.程序集变量 折扣后金额字段, 未知类型0x20057, , , 
.程序集变量 折扣后金额统计框, 未知类型0x2002F, , , 
.程序集变量 折扣后金额内容格, 未知类型0x2004B, , , 
.程序集变量 内容行, 未知类型0x20048, , , 
.程序集变量 分组尾, 未知类型0x20093, , , 
.子程序 _按钮1_被单击, 空白型, , 
 ' 查询显示器1.PostColumnLayout ()
 ' 主报表.PrintPreview (真)


.子程序 _负数红字显示_创建完毕, 空白型, , 
.局部变量 数据库连接文本, 文本型, , , 

 ' 主报表.LoadFromFile (取运行目录 () ＋ “\..\reports\RedNegativeText.grf”)
 ' 数据库连接文本 ＝ “ODBC;DBQ=” ＋ 取运行目录 () ＋ “\..\data\Northwind.mdb” ＋ “;Driver={Microsoft Access Driver (*.mdb)};”
 ' 主报表.挂接事件 (GridppReport事件1)
 ' 查询显示器1.SetReport (主报表)
 ' 查询显示器1.Start ()

.子程序 _GridppReport事件1_Initialize, 空白型, , 
 ' ' 为了提高运行效率，在此记录下在响应事件中用到的报表对象的接口指针。
 ' 内容行 ＝ 主报表.GetDetailGrid ().GetColumnContent ()
 ' 折扣后金额内容格 ＝ 内容行.GetContentCells ().GetItem (“NetAmount”)
 ' 折扣后金额字段 ＝ 主报表.FieldByName (“NetAmount”)
 ' 折扣后金额统计框 ＝ 主报表.ControlByName (“NetAmountSummaryBox”).GetAsSummaryBox ()
 ' 分组尾 ＝ 主报表.GetDetailGrid ().GetGroups ().GetItem (1).GetFooter ()


.子程序 _GridppReport事件1_BeforePostRecord, 空白型, , 
 ' ' 将折后金额字段的值减掉一个固定值，使其既有正值又有负值
 ' ' 这样的处理主要是为了得到需要的试验数据
 ' 折扣后金额字段.AsFloat ＝ 折扣后金额字段.AsFloat － 500


.子程序 _GridppReport事件1_FieldGetDisplayText, 空白型, , 
.参数 pSender, 未知类型0x20057, , 

.局部变量 参数对象, 对象, , , 
.局部变量 折扣金额对象, 对象, , , 
.局部变量 文本, 文本型, , , 

 ' ' <<为了实现列负数红字显示>>
 ' ' 当报表在查询显示时，如果字段值为负数，去掉其显示文字前面的负号
 ' 参数对象.取接口 (pSender, )
 ' 折扣金额对象.取接口 (折扣后金额字段, )
 ' .如果真 (并且 (等于 (主报表., #), 参数对象.是否相等 (折扣金额对象)))
     ' .如果真 (小于 (折扣后金额字段., 0))
         ' 文本 ＝ 折扣后金额字段.DisplayText
         ' 折扣后金额字段.DisplayText ＝ 取文本右边 (文本, 取文本长度 (文本) － 1)
    .如果真结束
    
.如果真结束


.子程序 _GridppReport事件1_TextBoxGetDisplayText, 空白型, , 
.参数 pSender, 未知类型0x2001B, , 

.局部变量 参数对象, 对象, , , 
.局部变量 统计框对象, 对象, , , 
.局部变量 文本, 文本型, , , 

 ' ' <<为了实现列负数红字显示>>
 ' ' 当报表在查询显示时，如果字段值为负数，去掉其显示文字前面的负号
 ' 参数对象.取接口 (pSender, )
 ' 统计框对象.取接口 (折扣后金额统计框, )
 ' .如果真 (并且 (等于 (主报表., #), 参数对象.是否相等 (统计框对象)))
     ' .如果真 (小于 (折扣后金额统计框., 0))
         ' 文本 ＝ 折扣后金额统计框.DisplayText
         ' 折扣后金额统计框.DisplayText ＝ 取文本右边 (文本, 取文本长度 (文本) － 1)
    .如果真结束
    
.如果真结束


.子程序 _GridppReport事件1_SectionFormat, 空白型, , 
.参数 pSender, 未知类型0x20005, , 

.局部变量 文本, 文本型, , , 
.局部变量 参数对象, 对象, , , 
.局部变量 内容行对象, 对象, , , 
.局部变量 分组尾对象, 对象, , , 
.局部变量 文本颜色, 整数型, , , 

 ' ' <<为了实现列负数红字显示>>
 ' 参数对象.取接口 (pSender, )
 ' 内容行对象.取接口 (内容行, )
 ' 分组尾对象.取接口 (分组尾, )
 ' .判断开始 (参数对象.是否相等 (内容行对象))
     ' 文本颜色 ＝ #黑色
     ' ' 当字段的值为负数时且在屏幕查询显示报表时，改变内容格的文字显示颜色为红色
     ' .如果真 (并且 (等于 (主报表., #), 小于 (折扣后金额字段., 0)))
         ' 文本颜色 ＝ #红色
    .如果真结束
     ' 折扣后金额内容格.ForeColor ＝ 文本颜色
 ' .判断 (参数对象.是否相等 (分组尾对象))
     ' 文本颜色 ＝ #黑色
     ' ' 当统计值为负数时且在屏幕查询显示报表时，改变显示统计值绝对值得静态框的
     ' ' 文字显示颜色为红色
     ' .如果真 (并且 (等于 (主报表., #), 小于 (折扣后金额统计框., 0)))
         ' 文本颜色 ＝ #红色
    .如果真结束
     ' 折扣后金额统计框.ForeColor ＝ 文本颜色
    
.默认
    
.判断结束


.子程序 _负数红字显示_尺寸被改变, 空白型, , 
 ' 查询显示器1.宽度 ＝ 宽度 － 30
 ' 查询显示器1.高度 ＝ 高度 － 80



 ' 不属于任何一个程序集、类模块的函数：
