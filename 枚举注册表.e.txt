 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 474
    高度 = 441
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “注册表项的枚举”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库





.DLL命令 RegEnumKeyEx, 整数型, "", "RegEnumKeyExA", , 
    .参数 hKey, 整数型, , 
    .参数 dwIndex, 整数型, , 
    .参数 lpName, 文本型, , 
    .参数 lpcbName, 整数型, , 
    .参数 lpReserved, 整数型, , 0
    .参数 lpClass, 文本型, , 
    .参数 lpcbClass, 整数型, , 
    .参数 lpftLastWriteTime, 日期时间型, , 

.DLL命令 RegEnumKey, 整数型, "", "RegEnumKeyA", , 
    .参数 hKey, 整数型, , 
    .参数 dwIndex, 整数型, , 
    .参数 lpName, 文本型, , 
    .参数 cbName, 整数型, , 

.DLL命令 RegCreateKey, 整数型, "", "RegCreateKeyA", , 
    .参数 hKey, 整数型, , 
    .参数 lpSubKey, 文本型, , 
    .参数 phkResult, 整数型, 传址, 

.DLL命令 RegOpenKey, 整数型, "", "RegOpenKeyA", , 
    .参数 hKey, 整数型, , 
    .参数 lpSubKey, 文本型, , 
    .参数 phkResult, 整数型, , 

.DLL命令 RegOpenKeyEx, 整数型, "", "RegOpenKeyExA", , 
    .参数 hKey, 短整数型, , 
    .参数 lpSubKey, 文本型, 传址, 
    .参数 ulOptions, 整数型, 传址, 
    .参数 samDesired, 整数型, 传址, 
    .参数 phkResult, 整数型, 传址, 

.DLL命令 RegCloseKey, 空白型, "", "RegCloseKey", , 
    .参数 hKey, 整数型, , 

.DLL命令 RegEnumValue, 整数型, "", "RegEnumValueA", , 
    .参数 hKey, 整数型, , Long，一个已打开项的句柄，或者指定一个标准项名
    .参数 dwIndex, 整数型, , Long，欲获取值的索引。注意第一个值的索引编号为零
    .参数 lpValueName, 文本型, 传址, String，用于装载位于指定索引处值名的一个缓冲区
    .参数 lpcbValueName, 整数型, 传址, Long，用于装载lpValueName缓冲区长度的一个变量。一旦返回，它会设为实际载入缓冲区的字符数量
    .参数 lpReserved, 整数型, , Long，未用；设为零
    .参数 lpType, 整数型, 传址, Long，用于装载值的类型代码的变量
    .参数 lpData, 文本型, 传址, Byte，用于装载值数据的一个缓冲区
    .参数 lpcbData, 整数型, 传址, Long，用于装载lpData缓冲区长度的一个变量。一旦返回，它会设为实际载入缓冲区的字符数量

.窗口程序集 窗口程序集1, , , 

.程序集变量 tmp, 文本型, , , 
.程序集变量 句柄, 整数型, , , 
.程序集变量 返回值, 整数型, , , 
.程序集变量 jzi, 文本型, , , 
.子程序 _组合框1_列表项被选择, 空白型, , 
赋值 (., 等于 (., 0))
清空 ()
清空 ()
.如果真 (等于 (., -1))
    返回 ()
.如果真结束
赋值 (., “”)
赋值 (jzi, “”)
赋值 (tmp, 取空白文本 (255))
赋值 (返回值, RegEnumKey (.取项目数值 (.), 取项目数 (), tmp, 取文本长度 (tmp)))
.判断循环首 (等于 (返回值, 0))
    tmp.加入项目 ()
    赋值 (tmp, 取空白文本 (255))
    赋值 (返回值, RegEnumKey (.取项目数值 (.), 取项目数 (), tmp, 取文本长度 (tmp)))
.判断循环尾 ()

.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (., 0)

.子程序 _列表框2_列表项被选择, 空白型, , 
.局部变量 z, 子程序指针, , , 
.局部变量 容器, 整数型, , , 

赋值 (., 相加 (jzi, “\”, .取项目文本 (.)))
赋值 (容器, .取项目数值 (.))
输出调试文本 (到文本 (容器))
赋值 (z, 多项选择 (相加 (容器, 1), &默认, &取文本, &取数值, &取字节集, &取数值, &取数值))
赋值 (., 多项选择 (相加 (容器, 1), “”, “文本”, “数值”, “字节集”, “数值”, “数值”))
编辑框2.内容 ＝ 指针到文本 (z)

.子程序 取文本, 文本型, , 
.局部变量 x, 文本型, , , 

赋值 (x, 取文本注册项 (选择 (等于 (., 1), 1, 相加 (., 1)), 选择 (不等于 (取文本右边 (., 6), “(默认)”), ., 取文本左边 (., 相减 (取文本长度 (.), 6))), ))
返回 (x)

.子程序 取数值, 文本型, , 
.局部变量 x, 文本型, , , 

赋值 (x, 到文本 (取数值注册项 (选择 (等于 (., 1), 1, 相加 (., 1)), ., )))
返回 (x)

.子程序 取字节集, 文本型, , 
.局部变量 容器, 字节集, , , 
.局部变量 i, 整数型, , , 
.局部变量 fh, 文本型, , , 

赋值 (容器, 取字节集注册项 (选择 (等于 (., 1), 1, 相加 (., 1)), ., ))
.计次循环首 (取字节集长度 (容器), i)
    赋值 (fh, 相加 (fh, 到文本 (容器 [i]), “,”))
.计次循环尾 ()
返回 (fh)

.子程序 _列表框1_双击选择, 空白型, , 
.局部变量 q, 整数型, , , 
.局部变量 值的类型, 整数型, , , 
.局部变量 值数据, 文本型, , , 
.局部变量 x, 整数型, , , 

.如果真 (大于 (取项目数 (), 0))
    赋值 (jzi, 相加 (jzi, 选择 (等于 (jzi, “”), “”, “\”), .取项目文本 (.)))
.如果真结束
赋值 (q, RegCreateKey (.取项目数值 (.), jzi, 句柄))
清空 ()
赋值 (tmp, 取空白文本 (255))
赋值 (返回值, RegEnumKey (句柄, x, tmp, 取文本长度 (tmp)))
.判断循环首 (等于 (返回值, 0))
    tmp.加入项目 ()
    赋值 (tmp, 取空白文本 (255))
    赋值 (x, 相加 (x, 1))
    赋值 (返回值, RegEnumKey (句柄, x, tmp, 取文本长度 (tmp)))
.判断循环尾 ()
清空 ()
赋值 (tmp, 取空白文本 (255))
赋值 (值数据, 取空白文本 (255))
赋值 (x, 0)
赋值 (返回值, RegEnumValue (句柄, x, tmp, 取文本长度 (tmp), 0, 值的类型, 值数据, 取文本长度 (值数据)))
.判断循环首 (等于 (返回值, 0))
    .如果真 (等于 (删全部空 (tmp), “”))
        赋值 (tmp, “(默认)”)
    .如果真结束
    相加 (tmp, “=”, 值数据).加入项目 ()
    赋值 (x, 相加 (x, 1))
    赋值 (tmp, 取空白文本 (255))
    赋值 (值数据, 取空白文本 (255))
    赋值 (返回值, RegEnumValue (句柄, x, tmp, 取文本长度 (tmp), 0, 值的类型, 值数据, 取文本长度 (值数据)))
    .如果真 (等于 (值的类型, 0))
        暂停 ()
    .如果真结束
    
.判断循环尾 ()
.如果真 (等于 (x, 0))
    “(默认)”.加入项目 (0)
.如果真结束
赋值 (., “”)
RegCloseKey (句柄)

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 容器, 整数型, , , 

赋值 (容器, 倒找文本 (jzi, “\”, , 真))
.判断开始 (等于 (容器, -1))
    .如果 (等于 (., “”))
        信息框 (“无法再向上”, 0, )
        返回 ()
    .否则
        清空 ()
        清空 ()
        赋值 (., “”)
        _组合框1_列表项被选择 ()
    .如果结束
    
.判断 (大于 (容器, 0))
    赋值 (jzi, 取文本左边 (jzi, 相减 (取文本长度 (jzi), 1)))
    清空 ()
    清空 ()
    赋值 (., “”)
    赋值 (jzi, 取文本左边 (jzi, 相减 (容器, 1)))
    赋值 (., jzi)
    _列表框1_双击选择 ()
.默认
    
.判断结束


.子程序 默认, 文本型, , 
返回 (“未设置键值”)


 ' 不属于任何一个程序集、类模块的函数：
