 ' 文件类型：Windows模块源码

 ' 程序名称：配置文件全操作
 ' 程序描述：    本模块提供了对配置文件（*.ini）的所有操作，包括创建、修改、读取及删除。
    本模块由西风制作。2008.8.20
 ' 程序作者：西风
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：4.0
 ' 创建号：0.0





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 5 系统核心支持库





.DLL命令 取配置文件指定节下所有项_, 整数型, "kernel32", "GetPrivateProfileStringA", , 为初始化文件中指定的条目取得字串
    .参数 节名称, 文本型, , 
    .参数 项名称, 整数型, , 0
    .参数 默认内容, 文本型, , 
    .参数 返回文本, 字节集, , 
    .参数 返回文本长度, 整数型, , 
    .参数 配置文件名称, 文本型, , 

.DLL命令 取配置文件所有节_, 整数型, "kernel32", "GetPrivateProfileStringA", , 为初始化文件中指定的条目取得字串
    .参数 节名称, 整数型, , 0
    .参数 项名称, 整数型, , 0
    .参数 默认内容, 文本型, , 
    .参数 返回文本, 字节集, , 
    .参数 返回文本长度, 整数型, , 
    .参数 配置文件名称, 文本型, , 

.DLL命令 写入配置文件_, 整数型, "kernel32.dll", "WritePrivateProfileStringA", , 如果配置文件不存在则将被创建
    .参数 小节名, 文本型, , 就是用中括号括起来的内容
    .参数 项目名, 文本型, , 就是等号前边的内容
    .参数 项目值, 文本型, , 就是等号后面的内容
    .参数 文件名, 文本型, , 就是你要写入的配置文件

.DLL命令 读取配置数值_, 整数型, "kernel32.dll", "GetPrivateProfileIntA", , 
    .参数 小节名, 文本型, , 就是用中括号括起来的内容
    .参数 项目名, 文本型, , 就是等号前边的内容
    .参数 默认值, 整数型, , 如果找不到对应的项目则返回该值
    .参数 文件名, 文本型, , 就是你要读取的配置文件

.DLL命令 读取配置文本_, 整数型, "kernel32.dll", "GetPrivateProfileStringA", , 
    .参数 小节名, 文本型, , 就是用中括号括起来的内容
    .参数 项目名, 文本型, , 就是等号前边的内容
    .参数 默认值, 文本型, , 可以为“”
    .参数 返回文本, 文本型, , 一般将长度设定为255
    .参数 返回文本缓冲长度, 整数型, , 
    .参数 文件名, 文本型, , 就是你要读取的配置文件

.DLL命令 删除配置文件项_, 整数型, "kernel32", "WritePrivateProfileStringA", , 
    .参数 小节名, 文本型, , 就是用中括号括起来的内容
    .参数 项目名, 文本型, , 就是等号前边的内容
    .参数 项目值, 整数型, , 0
    .参数 文件名, 文本型, , 就是你要写入的配置文件

.DLL命令 删除配置文件小节_, 整数型, "kernel32", "WritePrivateProfileStringA", , 
    .参数 小节名, 文本型, , 就是用中括号括起来的内容
    .参数 项目名, 整数型, , 0
    .参数 项目值, 整数型, , 0
    .参数 文件名, 文本型, , 就是你要写入的配置文件

.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在模块初始化代码执行完毕后调用模块测试代码
返回 (0)


.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的参数及返回值类型。


.程序集 _接口程序集, , , 在本程序集中定义的子程序可被模块外部程序访问，注意如果不存在本程序集就不能作为易模块编译。

.子程序 写配置文件, 整数型, 公开, 创建或修改参数“配置文件名”指定的配置文件，非零表示成功
.参数 配置文件名, 文本型, , 全路径配置文件名，如果省略路径，则默认在windows目录下
.参数 小节名, 文本型, , 
.参数 项目名, 文本型, , 
.参数 项目值, 文本型, , 

返回 (写入配置文件_ (小节名, 项目名, 项目值, 配置文件名))


.子程序 读配置文本, 文本型, 公开, 
.参数 配置文件名, 文本型, , 全路径配置文件名，如果省略路径，则默认在windows目录下
.参数 小节名, 文本型, , 
.参数 项目名, 文本型, , 
.参数 默认值, 文本型, , 如果该项目不存在，默认返回的文本内容

.局部变量 返回文本, 文本型, , , 

赋值 (返回文本, 取空白文本 (255))
读取配置文本_ (小节名, 项目名, 默认值, 返回文本, 255, 配置文件名)
返回 (删首尾空 (返回文本))


.子程序 读配置数值, 整数型, 公开, 只能返回整数。一般情况下建议用“读配置文本”
.参数 配置文件名, 文本型, , 全路径配置文件名，如果省略路径，则默认在windows目录下
.参数 小节名, 文本型, , 
.参数 项目名, 文本型, , 
.参数 默认值, 整数型, , 如果该项目不存在，默认返回的数值

返回 (读取配置数值_ (小节名, 项目名, 默认值, 配置文件名))


.子程序 删除配置节, 整数型, 公开, 删除配置文件中某个小节的全部内容，非零表示成功
.参数 配置文件名, 文本型, , 全路径配置文件名，如果省略路径，则默认在windows目录下
.参数 小节名, 文本型, , 欲删除的小节名

返回 (删除配置文件小节_ (小节名, 0, 0, 配置文件名))


.子程序 删除配置项, 整数型, 公开, 删除配置文件中指定小节下某个项目，非零表示成功
.参数 配置文件名, 文本型, , 全路径配置文件名，如果省略路径，则默认在windows目录下
.参数 小节名, 文本型, , 欲删除项目所在的小节
.参数 项目名, 文本型, , 欲删除的项目名 

返回 (删除配置文件项_ (小节名, 项目名, 0, 配置文件名))


.子程序 取所有配置节名, 文本型, 公开, 返回所有节名称，以换行符（#换行符）分隔
.参数 配置文件名, 文本型, , 全路径配置文件名，如果省略路径，则默认在windows目录下

.局部变量 结果, 字节集, , , 
.局部变量 节名数组, 字节集, , "0", 
.局部变量 索引, 整数型, , , 
.局部变量 返回节名称, 文本型, , , 

赋值 (结果, 取空白字节集 (255))
取配置文件所有节_ (0, 0, “”, 结果, 256, 配置文件名)
赋值 (节名数组, 分割字节集 (结果, { 0 }, ))
.计次循环首 (取数组成员数 (节名数组), 索引)
    .如果真 (大于 (取字节集长度 (节名数组 [索引]), 0))
        赋值 (返回节名称, 相加 (返回节名称, 到文本 (节名数组 [索引]), #换行符))
    .如果真结束
    
.计次循环尾 ()
返回 (取文本左边 (返回节名称, 相减 (取文本长度 (返回节名称), 2)))


.子程序 取所有配置项名, 文本型, 公开, 返回指定节名称下所有项目名称，以换行符（#换行符）分隔
.参数 配置文件名, 文本型, , 全路径配置文件名，如果省略路径，则默认在windows目录下
.参数 小节名, 文本型, , 要取出其所有项目的节名称

.局部变量 结果, 字节集, , , 
.局部变量 项名数组, 字节集, , "0", 
.局部变量 索引, 整数型, , , 
.局部变量 返回项名称, 文本型, , , 

赋值 (结果, 取空白字节集 (255))
取配置文件指定节下所有项_ (小节名, 0, “”, 结果, 256, 配置文件名)
赋值 (项名数组, 分割字节集 (结果, { 0 }, ))
.计次循环首 (取数组成员数 (项名数组), 索引)
    .如果真 (大于 (取字节集长度 (项名数组 [索引]), 0))
        赋值 (返回项名称, 相加 (返回项名称, 到文本 (项名数组 [索引]), #换行符))
    .如果真结束
    
.计次循环尾 ()
返回 (取文本左边 (返回项名称, 相减 (取文本长度 (返回项名称), 2)))



 ' 不属于任何一个程序集、类模块的函数：
