 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 477
    高度 = 446
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 273
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假



.常量 风格_默认, "0", , 
.常量 风格_注释, "1", , 
.常量 风格_注释行, "2", , 
.常量 风格_注释文档, "3", , 
.常量 风格_数字, "4", , 
.常量 风格_关键字, "5", , 
.常量 风格_字符串, "6", , 
.常量 风格_字符, "7", , 
.常量 风格_UUID, "8", , 
.常量 风格_预处理程序, "9", , 
.常量 风格_操作符, "10", , 
.常量 风格_标识符, "11", , 
.常量 风格_字符结束, "12", , 
.常量 风格_VERBATIM, "13", , 
.常量 风格_正则表达式, "14", , 
.常量 风格_注释行文档, "15", , 
.常量 风格_关键字二, "16", , 
.常量 风格_注释关键字文档, "17", , 
.常量 风格_注释错误关键字文档, "18", , 
.常量 风格_全局类, "19", , 
.图片 配置文本, " ' 已保存到：D:\易语言学习\Data\yish.e\配置文本", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' CodeStyleEdit {E5E6A8E356A843bd94609DDD678BD6D8} 1 0 代码编辑框支持库
 ' RegEx 684944CB04624eb7BD5412A519421D34 1 2 正则表达式支持库



 ' 所需要的模块
 ' 控制台交互操作模块 C:\Documents and Settings\admin\桌面\Edit_yis_5.11\D编辑器\控制台交互操作模块.ec


数据类型 风格结构, , 
    .成员 name, 文本型, , , 
    .成员 styleID, 空白型, , , 
    .成员 fgColor, 空白型, , , 
    .成员 bgColor, 空白型, , , 
    .成员 fontName, 文本型, , , 
    .成员 fontStyle, 空白型, , , 
    .成员 fontSize, 空白型, , , 

.全局变量 风格组, 风格结构, , "20", 
.全局变量 当前文件名, 文本型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 颜色值, 空白型, , , 
.程序集变量 reg, 未知类型0x30001, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 cmd, 文本型, , "1", 

输出调试文本 (控制台_连接 (“y_dmd\y_dmd\dmd\dmd\bin”))
赋值 (.初始目录, 取当前目录 ())
取命令行 (cmd)


reg.未知支持库函数_3 (“.+\((.+)\)[:|：](.+)”, )



.如果真 (大于 (取数组成员数 (cmd), 0)) ' 后跟命令文本
    0.未知支持库函数_10 (到文本 (读入文件 (cmd [1])))
.如果真结束



读入风格文件 (“配置.txt”)

5.未知支持库函数_15 ()
#..未知支持库函数_80 ()



.计次循环首 (20, i)
    风格组.未知支持库函数_73 ( [i], styleID, 风格组 [i], fgColor)
    风格组.未知支持库函数_74 ( [i], styleID, 风格组 [i], bgColor)
.计次循环尾 ()

 ' 代码编辑框1.置风格前景色 (11, 0)
 ' 代码编辑框1.置风格前景色 (5, 16711680)
 ' 代码编辑框1.置风格前景色 (16, 8409343)
 ' 代码编辑框1.置风格前景色 (4, 33023)

 ' 代码编辑框1.置风格前景色 (6, 8421504)

 ' 代码编辑框1.置风格前景色 (7, 65535)
 ' 代码编辑框1.置风格前景色 (10, 8388608)

 ' 代码编辑框1.置风格前景色 (1, 32768)
 ' 代码编辑框1.置风格前景色 (2, 32768)
 ' 代码编辑框1.置风格前景色 (3, 32768)
 ' 代码编辑框1.置风格前景色 (15, 32768)
 ' 代码编辑框1.置风格前景色 (17, 32768)


0.未知支持库函数_82 (“if else switch case default break goto return for while do continue typedef sizeof NULL new delete throw try catch  operator this const_cast static_cast dynamic_cast reinterpret_cast true false null using typeid and and_eq bitand bitor compl not not_eq or or_eq xor xor_eq void struct union enum char short int long double float signed unsigned const static extern auto register volatile bool class private protected public friend inline template virtual asm explicit typename import”)

 ' 代码编辑框1.置关键字 (1, “void struct union enum char short int long double float signed unsigned const static extern auto register volatile bool class private protected public friend inline template virtual asm explicit typename”)

 ' 代码编辑框.置风格前景色 (语言结构.属性数组 [属性下标].风格ID, 语言结构.属性数组 [属性下标].前景颜色)
 ' 背景色
 ' 代码编辑框.置风格背景色 (语言结构.属性数组 [属性下标].风格ID, 语言结构.属性数组 [属性下标].背景颜色)





子程序1 ()

.子程序 子程序1, 空白型, , 

返回 ()

.子程序 __启动窗口_将被销毁, 空白型, , 
写出风格文件 (“配置.txt”)

.子程序 _设置参数_被选择, 空白型, , 
载入 (窗口1, , 真)

.子程序 __启动窗口_尺寸被改变, 空白型, , 
.移动 (相减 (., 20), 相减 (., .高度, 70))
.移动 (相加 (., 10), ., )

.子程序 _代码编辑框1_处理新字符, 空白型, , 
.参数 接收到的字符, 文本型, , 

.局部变量 当前行, 空白型, , , 
.局部变量 当前缩进, 空白型, , , 
.局部变量 当前位置, 空白型, , , 

.如果真 (等于 (到字节集 (接收到的字符), { 13 }))
    赋值 (当前位置, 未知支持库函数_43 ())
    赋值 (当前行, 当前位置.未知支持库函数_46 ())
    赋值 (当前缩进, 相减 (当前行, 1).未知支持库函数_101 ())
    
    当前行.未知支持库函数_100 (当前缩进)
    当前行.未知支持库函数_102 ().未知支持库函数_41 ()
.如果真结束


.子程序 __启动窗口_可否被关闭, 逻辑型, , 
返回 (未知函数_67174625 ())

.子程序 _编译程序_被选择, 空白型, , 
.如果真 (不等于 (删首尾空 (当前文件名), “”))
    .如果真 (等于 (文件是否存在 (当前文件名), 假))
        返回 ()
    .如果真结束
    赋值 (.内容, “”)
    输出调试文本 (未知函数_67174623 (相加 (“dmd.exe ”, 当前文件名, “ -version=OLE_COM”)))
    未知函数_67174624 ()
    
.如果真结束


.子程序 _运行程序_被选择, 空白型, , 
赋值 (.内容, “”)
输出调试文本 (未知函数_67174623 (“t”))
未知函数_67174624 ()



.子程序 _编辑框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 begin, 空白型, , , 
.局部变量 end, 空白型, , , 
.局部变量 行文本, 文本型, , , 
.局部变量 结果, 未知类型0x30002, , , 
.局部变量 错误行号, 空白型, , , 

赋值 (begin, 倒找文本 (.内容, #换行符, .起始选择位置, 假))
赋值 (end, 寻找文本 (.内容, #换行符, .起始选择位置, 假))
赋值 (行文本, 取文本中间 (.内容, begin, 相减 (end, begin)))
赋值 (结果, reg.未知支持库函数_7 (行文本, 1, ))
赋值 (错误行号, 到数值 (结果.未知支持库函数_12 (行文本, 1, )))
.如果真 (并且 (大于 (错误行号, 0), 小于 (错误行号, 未知支持库函数_36 ())))
    获取焦点 ()
    相减 (错误行号, 1).未知支持库函数_42 ()
    
.如果真结束


.子程序 _打开文件_被选择, 空白型, , 
.如果真 (打开 ())
    未知支持库函数_11 ()
    到文本 (读入文件 (.文件名)).未知支持库函数_7 (-1)
    赋值 (当前文件名, .文件名)
.如果真结束


.子程序 _保存文件_被选择, 空白型, , 
.如果真 (等于 (当前文件名, “”))
    .如果真 (打开 ())
        赋值 (当前文件名, .文件名)
    .如果真结束
    
.如果真结束

 ' 代码编辑框1.清空编辑框 ()
 ' 代码编辑框1.加入文本 (到文本 (读入文件 (通用对话框1.文件名)), -1)
写到文件 (当前文件名, 到字节集 (未知支持库函数_35 ().未知支持库函数_0 ()))

.程序集 程序集1, , , 

.子程序 初始化风格数组, 空白型, , 
赋值 (风格组 [1], “风格_默认”) ' "0"
赋值 (风格组 [2], “风格_注释”) ' "1"
赋值 (风格组 [3], “风格_注释行”) ' "2"
赋值 (风格组 [4], “风格_注释文档”) ' "3"
赋值 (风格组 [5], “风格_数字”) ' "4"
赋值 (风格组 [6], “风格_关键字”) ' "5"
赋值 (风格组 [7], “风格_字符串”) ' "6"
赋值 (风格组 [8], “风格_字符”) ' "7"
赋值 (风格组 [9], “风格_UUID”) ' "8"
赋值 (风格组 [10], “风格_预处理程序”) ' "9"
赋值 (风格组 [11], “风格_操作符”) ' "10"
赋值 (风格组 [12], “风格_标识符”) ' "11"
赋值 (风格组 [13], “风格_字符结束”) ' "12"
赋值 (风格组 [14], “风格_VERBATIM”) ' "13"
赋值 (风格组 [15], “风格_正则表达式”) ' "14"
赋值 (风格组 [16], “风格_注释行文档”) ' "15"
赋值 (风格组 [17], “风格_关键字二”) ' "16"
赋值 (风格组 [18], “风格_注释关键字文档”) ' "17"
赋值 (风格组 [19], “风格_注释错误关键字文档”) ' "18"
赋值 (风格组 [20], “风格_全局类”) ' "19"


.子程序 读入风格文件, 空白型, , 
.参数 fileName, 文本型, , 

.局部变量 bin, 字节集, , , 
.局部变量 s_, 文本型, , , 
.局部变量 ss_, 文本型, , "1", 
.局部变量 int_i, 空白型, , , 
.局部变量 i, 整数型, , , 
.局部变量 行文本, 文本型, , "7", 

.如果真 (等于 (文件是否存在 (fileName), 假))
    .如果真 (等于 (写到文件 (fileName, #配置文本), 假))
        返回 ()
    .如果真结束
    
.如果真结束

赋值 (bin, 读入文件 (fileName))
赋值 (s_, 到文本 (bin))
赋值 (ss_, 分割文本 (s_, “;”, ))
赋值 (int_i, 取数组成员数 (ss_))
输出调试文本 (int_i)
.如果真 (大于 (int_i, 20))
    赋值 (int_i, 20)
.如果真结束
.计次循环首 (int_i, i)
    赋值 (行文本, 分割文本 (ss_ [i], “,”, ))
    赋值 (风格组 [i], name, 行文本 [1])
    赋值 (风格组 [i], styleID, 到数值 (行文本 [2]))
    赋值 (风格组 [i], fgColor, 到数值 (行文本 [3]))
    赋值 (风格组 [i], bgColor, 到数值 (行文本 [4]))
    
    赋值 (风格组 [i], fontName, 行文本 [5])
    赋值 (风格组 [i], fontSize, 到数值 (行文本 [6]))
    赋值 (风格组 [i], fontStyle, 到数值 (行文本 [7]))
    
.计次循环尾 ()


.子程序 写出风格文件, 空白型, , 
.参数 fileName, 文本型, , 

.局部变量 bin, 字节集, , , 
.局部变量 s_, 文本型, , , 
.局部变量 文本全, 文本型, , , 
.局部变量 int_i, 空白型, , , 
.局部变量 i, 整数型, , , 
.局部变量 行文本, 文本型, , "7", 

.计次循环首 (20, i)
     ' 行文本 ＝ 分割文本 (ss_ [i], “,”, )
    赋值 (行文本 [1], 风格组 [i], name)
    赋值 (行文本 [2], 到文本 (风格组 [i], styleID))
    赋值 (行文本 [3], 到文本 (风格组 [i], fgColor))
    赋值 (行文本 [4], 到文本 (风格组 [i], bgColor))
    
    赋值 (行文本 [5], 风格组 [i], fontName)
    赋值 (行文本 [6], 到文本 (风格组 [i], fontSize))
    赋值 (行文本 [7], 到文本 (风格组 [i], fontStyle))
    
    
    赋值 (文本全, 相加 (文本全, 行文本 [1], “,”, 行文本 [2], “,”, 行文本 [3], “,”, 行文本 [4], “,”, 行文本 [5], “,”, 行文本 [6], “,”, 行文本 [7], “;”))
.计次循环尾 ()

.如果真 (文件是否存在 (fileName))
    删除文件 (fileName)
    
.如果真结束
写到文件 (fileName, 到字节集 (文本全))

.窗口程序集 窗口程序集2, , , 

.子程序 _窗口1_创建完毕, 空白型, , 
.局部变量 i, 整数型, , , 


.计次循环首 (20, i)
    风格组.加入项目 ( [i], name, 风格组 [i], styleID)
.计次循环尾 ()



.子程序 _列表框1_列表项被选择, 空白型, , 
.局部变量 now, 空白型, , , 

赋值 (now, 相加 (.现行选中项, 1))
.如果真 (小于或等于 (now, 0))
    返回 ()
.如果真结束
赋值 (.颜色, 风格组 [now], fgColor)
赋值 (.颜色, 风格组 [now], bgColor)
赋值 (., 到文本 (风格组 [now], styleID))

.子程序 _窗口1_将被销毁, 空白型, , 
.局部变量 i, 空白型, , , 

.计次循环首 (20, i)
    _启动窗口.未知支持库函数_73 (., 风格组 [i], styleID, 风格组 [i], fgColor)
    _启动窗口.未知支持库函数_74 (., 风格组 [i], styleID, 风格组 [i], bgColor)
.计次循环尾 ()


.子程序 _颜色选择器1_颜色被改变, 空白型, , 
.局部变量 now, 空白型, , , 

赋值 (now, 相加 (.现行选中项, 1))
.如果真 (小于或等于 (now, 0))
    返回 ()
.如果真结束
赋值 (风格组 [now], fgColor, .颜色)

.子程序 _颜色选择器2_颜色被改变, 空白型, , 
.局部变量 now, 空白型, , , 

赋值 (now, 相加 (.现行选中项, 1))
.如果真 (小于或等于 (now, 0))
    返回 ()
.如果真结束
赋值 (风格组 [now], bgColor, .颜色)


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 控制台_连接, 整数型, , 连接到创建的一个隐式控制台,以实现对控制台的标准输入与输出操作.返回控制台的进程ID,0意味着失败,非0表示成功.,如果返回-1说明控制台已经连接.
.参数 运行目录, 文本型, 可空, 创建控制台时所在的目录,默认在系统目录,如果不为空,请在目录名后加上"\",否则会连接失败.



.子程序 控制台_标准输入, 整数型, , 向已经连接的控制台输入命令(标准输入),返回输入命令的实际长度,返回0意味着失败,非0表示成功.
.参数 命令名, 文本型, , 可以是任何控制台命令.



.子程序 控制台_标准输出, 逻辑型, , 取回已连接控制台的命令提示(控制台标准输出与标准错误输出,也就是"回显"),成功返回真,失败返回假.
.参数 输出对象, 编辑框, , 要输出到的编辑框.



.子程序 控制台_断开连接, 逻辑型, , 断开一个已经连接的控制台,成功返回真,失败返回假.注意:在标准输入里输入命令"exit"也可以达到断开连接的目地.



 ' 不属于任何一个程序集、类模块的函数：
