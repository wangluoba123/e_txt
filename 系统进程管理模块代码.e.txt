 ' 文件类型：未知类型

 ' 程序名称：进程管理
 ' 程序描述：[神2也教你学E] - 系统进程管理(感谢近在眼前)
 ' 程序作者：BoyChong谢栋
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：boychong2@eyou.com
 ' 主页地址：http://www.zzhx.bak.cn
 ' 版权声明：武汉华中师范大学汉口分校
 ' 版本号：1.0
 ' 创建号：0.0





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 7 系统核心支持库




数据类型 进程信息, , 
    .成员 类型大小, 整数型, , , 296
    .成员 引用次数, 整数型, , , 
    .成员 进程标识, 整数型, , , 
    .成员 默认堆标识, 整数型, , , 只能被此类API使用
    .成员 模块标识, 整数型, , , 同上
    .成员 线程数, 整数型, , , 
    .成员 父进程标识, 整数型, , , 
    .成员 基类优先级, 整数型, , , 由该进程创建的线程的基优先级
    .成员 标识, 整数型, , , 系统保留保留，不用
    .成员 执行文件名, 字节型, , "260", 


.DLL命令 创建快照, 整数型, "", "CreateToolhelp32Snapshot", , 
    .参数 标识, 整数型, , 
    .参数 进程标识, 整数型, , 

.DLL命令 取第一个进程, 逻辑型, "", "Process32First", , 
    .参数 快照句柄, 整数型, , 
    .参数 进程信息, 进程信息, , 

.DLL命令 关闭句柄, 逻辑型, "kernel32", "CloseHandle", , 
    .参数 对象句柄, 整数型, , 

.DLL命令 打开进程, 整数型, "", "OpenProcess", , 返回Handle
    .参数 值, 整数型, , 
    .参数 信息, 整数型, , 
    .参数 进程ID, 整数型, , 

.DLL命令 结束指定进程, 空白型, "", "TerminateProcess", , 
    .参数 句柄, 整数型, , 
    .参数 信息, 整数型, , 

.DLL命令 取下一个进程, 逻辑型, "", "Process32Next", , 
    .参数 快照句柄, 整数型, , 
    .参数 进程信息, 进程信息, , 

.程序集 程序集1, , , 

.程序集变量 进程列表, 进程信息, , , 
.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。

.子程序 取系统进程, 逻辑型, 公开, 
.参数 存放进程的文本数组, 文本型, 数组, 此文本数组变量将用来存放进程信息，您可以设置数组数为0

.局部变量 进程快照, 整数型, , , 
.局部变量 临时, 逻辑型, , , 
.局部变量 进程名, 文本型, , , 

重定义数组 (存放进程的文本数组, 假, 0)
赋值 (进程快照, 创建快照 (15, 0))
.如果真 (等于 (进程快照, 0))
    返回 (假)
.如果真结束
赋值 (进程列表.类型大小, 296)
赋值 (临时, 取第一个进程 (进程快照, 进程列表))
.判断循环首 (不等于 (临时, 假))
    加入成员 (存放进程的文本数组, 到文本 (到字节集 (进程列表.执行文件名)))
    赋值 (临时, 取下一个进程 (进程快照, 进程列表))
.判断循环尾 ()
返回 (真)

.子程序 取进程句柄, 整数型, , 
.参数 进程文件名, 文本型, , 

.局部变量 结果, 逻辑型, , , 
.局部变量 进程快照, 整数型, , , 
.局部变量 线程快照, 整数型, , , 
.局部变量 进程信息, 进程信息, , , 
.局部变量 句柄, 整数型, , , 
.局部变量 文件名, 文本型, , , 

赋值 (进程信息.类型大小, 296)
赋值 (进程快照, 创建快照 (位或 (2, 0), 0))
检查 (不等于 (进程快照, -1))
赋值 (结果, 取第一个进程 (进程快照, 进程信息))
检查 (结果)
.判断循环首 (结果)
    赋值 (文件名, 取字节集数据 (到字节集 (.), 10))
    .如果真 (等于 (文件名, 进程文件名))
        赋值 (句柄, 打开进程 (1, 0, 进程信息.进程标识))
        跳出循环 ()
    .如果真结束
    赋值 (结果, 取下一个进程 (进程快照, 进程信息))
    赋值 (句柄, 0)
.判断循环尾 ()
赋值 (结果, 关闭句柄 (进程快照))
返回 (句柄)

.子程序 结束进程, 空白型, 公开, 
.参数 欲结束进程的名称, 文本型, , 如：qq.exe

结束指定进程 (取进程句柄 (欲结束进程的名称), 0)


 ' 不属于任何一个程序集、类模块的函数：
