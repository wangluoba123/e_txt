 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 809
    高度 = 597
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “小学远教资源浏览器  (V2.0)”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 289
    高度 = 224
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\远程教育.e\窗口1_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “设置”
    帮助文件名 = “”

窗口 窗口2
    左边 = 50
    顶边 = 50
    宽度 = 388
    高度 = 262
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' HtmlView 5014D8FA6DCA40b68FA626D8183666EB 1 1 超文本浏览框支持库
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 2 5 扩展界面支持库三
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库





.窗口程序集 窗口程序集1, , , 

.程序集变量 记录地址, 文本型, , , 
.子程序 _卷帘式菜单1_项目被选择, 空白型, , 
.参数 菜单索引, 整数型, , 
.参数 项目索引, 整数型, , 

.如果真 (等于 (菜单索引, 0)) ' 菜单A中的项目被选择 （第一个菜单的索引为0，下一个为1，以次类推）
    0.置文本 (“浏览网页”)
    
    .如果真 (等于 (项目索引, 0)) ' 第一个项目被选择（第一个项目的索引为0，下一个为1，以次类推）
        赋值 (., 相加 (.内容, “xxpd\homepage\”, .内容, “\index.htm”))
    .如果真结束
    .如果真 (等于 (项目索引, 1))
        赋值 (., 相加 (.内容, “jjtz\peixunjiaoxue\index.html”))
    .如果真结束
    .如果真 (等于 (项目索引, 2))
        赋值 (., 相加 (.内容, “xinwen\xinwen_index.htm”))
    .如果真结束
    .如果真 (等于 (项目索引, 3))
        赋值 (., 相加 (.内容, “xxpd\kczy\”, .内容, “\yw\1\kebiao-bsd.htm”))
    .如果真结束
    .如果真 (等于 (项目索引, 4))
        赋值 (., 相加 (.内容, “xxpd\xxzd\”, .内容, “\yu_wen\ke_biao_ban\1_nianji\kechengfudao\index.htm”))
    .如果真结束
    .如果真 (等于 (项目索引, 5))
        赋值 (., 相加 (.内容, “xxpd\ztjy\06-07\index.htm”))
    .如果真结束
    .如果真 (等于 (项目索引, 6))
        赋值 (., 相加 (.内容, “xxpd\jsfz\”, .内容, “\ztbg\index.htm”))
    .如果真结束
    .如果真 (等于 (项目索引, 7))
        赋值 (., 相加 (.内容, “snwh\index.htm”))
    .如果真结束
    .如果真 (等于 (项目索引, 8))
        赋值 (., 相加 (.内容, “wnfw\wnfw_index.htm”))
    .如果真结束
    .如果真 (等于 (项目索引, 9))
        赋值 (., 相加 (.内容, “xxpd\syzn\”, .内容, “\index.htm”))
    .如果真结束
    .如果真 (等于 (项目索引, 10))
        赋值 (., 相加 (.内容, “xxpd\wzdh\”, .内容, “\index.htm”))
    .如果真结束
    
.如果真结束
.如果真 (等于 (菜单索引, 1))
    0.置文本 (“资源整理”)
    .如果真 (等于 (项目索引, 0))
        赋值 (., 相加 (.内容, “cidazy”))
    .如果真结束
    
.如果真结束
.如果真 (等于 (菜单索引, 2))
    0.置文本 (“资源整理”)
    .如果真 (等于 (项目索引, 0))
        赋值 (., 相加 (.内容, “xxpd\jsfz”))
    .如果真结束
    .如果真 (等于 (项目索引, 1))
        赋值 (., 相加 (.内容, “xxpd\kczy”))
    .如果真结束
    .如果真 (等于 (项目索引, 2))
        赋值 (., 相加 (.内容, “xxpd\kxrs”))
    .如果真结束
    .如果真 (等于 (项目索引, 3))
        赋值 (., 相加 (.内容, “xxpd\xxzd”))
    .如果真结束
    .如果真 (等于 (项目索引, 4))
        赋值 (., 相加 (.内容, “xxpd\ztjy”))
    .如果真结束
    .如果真 (等于 (项目索引, 5))
        赋值 (., 相加 (.内容, “xxpd\syzn”))
    .如果真结束
    .如果真 (等于 (项目索引, 6))
        赋值 (., 相加 (.内容, “xxpd\wzdh”))
    .如果真结束
    .如果真 (等于 (项目索引, 7))
        赋值 (., 相加 (.内容, “xxpd\bz”))
    .如果真结束
    
.如果真结束
.如果真 (等于 (菜单索引, 3))
    0.置文本 (“资源整理”)
    .如果真 (等于 (项目索引, 0))
        赋值 (., 相加 (.内容, “sci”))
    .如果真结束
    
.如果真结束
.如果真 (等于 (菜单索引, 4))
    0.置文本 (“资源整理”)
    .如果真 (等于 (项目索引, 0))
        赋值 (., 相加 (.内容, “snwh\wsdg”))
    .如果真结束
    .如果真 (等于 (项目索引, 1))
        赋值 (., 相加 (.内容, “snwh\rwxk”))
    .如果真结束
    .如果真 (等于 (项目索引, 2))
        赋值 (., 相加 (.内容, “snwh\kpzc”))
    .如果真结束
    .如果真 (等于 (项目索引, 3))
        赋值 (., 相加 (.内容, “snwh\jsmc”))
    .如果真结束
    .如果真 (等于 (项目索引, 4))
        赋值 (., 相加 (.内容, “snwh\qwyx”))
    .如果真结束
    
.如果真结束
.如果真 (等于 (菜单索引, 5))
    0.置文本 (“资源整理”)
    .如果真 (等于 (项目索引, 0))
        赋值 (., 相加 (.内容, “wnfw”))
    .如果真结束
    
.如果真结束
.如果真 (等于 (菜单索引, 6))
    0.置文本 (“资源整理”)
    .如果真 (等于 (项目索引, 0))
        赋值 (., 相加 (.内容, “xinwen”))
    .如果真结束
    
.如果真结束
.如果真 (等于 (菜单索引, 7))
    0.置文本 (“资源整理”)
    .如果真 (等于 (项目索引, 0))
        赋值 (., 相加 (.内容, “gglm”))
    .如果真结束
    
.如果真结束
.如果真 (等于 (菜单索引, 8))
    0.置文本 (“资源整理”)
    .如果真 (等于 (项目索引, 0))
        赋值 (., 相加 (.内容, “xxls”))
    .如果真结束
    
.如果真结束
.如果真 (等于 (菜单索引, 9))
    0.置文本 (“资源整理”)
    .如果真 (等于 (项目索引, 0))
        赋值 (., 相加 (.内容, “jjtz”))
    .如果真结束
    
.如果真结束


.子程序 __启动窗口_尺寸被改变, 空白型, , 
未知支持库函数_0 (3)
赋值 (.禁止, 相减 (_启动窗口., 2))
赋值 (., 相减 (_启动窗口., ., .))
赋值 (., 相加 (相减 (_启动窗口., 相乘 (.可视, 3)), .))
赋值 (., 相加 (相减 (_启动窗口., 相乘 (.可视, 3)), .))
赋值 (., 相加 (., 10))
赋值 (.宽度, 相加 (相减 (_启动窗口., 相乘 (.可视, 3)), .))
赋值 (.左边, 相加 (.宽度, .宽度))
赋值 (.宽度, 相加 (相减 (., 相乘 (., 2)), 相乘 (., 2), 4))


.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (.内容, 到文本 (读配置项 (相加 (取运行目录 (), “/FileTray.ini”), “设置”, “接收根目录”, )))
赋值 (.内容, 到文本 (读配置项 (相加 (取运行目录 (), “/FileTray.ini”), “设置”, “年度”, )))
0.置文本 (“资源整理”)
.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    载入 (窗口1, , 真)
    返回 ()
.如果真结束


.子程序 _超文本浏览框1_即将跳转, 逻辑型, , 
3.置文本 (相加 (“地址 ”, #左引号, ., #右引号))

.子程序 _工具条1_被下拉, 空白型, , 
.参数 按钮索引, 整数型, , 
.参数 下拉横座标, 整数型, , 
.参数 下拉纵座标, 整数型, , 

弹出菜单 (下拉横座标, 下拉纵座标)

.子程序 _超文本浏览框1_载入进度改变, 空白型, , 
.参数 进度百分比, 整数型, , 

2.置文本 (相加 (“已经载入 ”, 到文本 (进度百分比), “ %”))

.子程序 _超文本浏览框1_已就绪, 空白型, , 
1.置文本 (“就绪”)
赋值 (.内容, .)

.子程序 _超文本浏览框1_状态文本被改变, 空白型, , 
1.置文本 (.)
.如果真 (等于 (取文本左边 (., 4), “http”))
    赋值 (记录地址, .)
.如果真结束


.子程序 _超文本浏览框1_命令状态被改变, 空白型, , 
.参数 命令, 整数型, , 
.参数 是否被允许, 逻辑型, , 

.如果 (等于 (是否被允许, 假))
    .判断开始 (等于 (命令, #))
        4.加入状态 (#禁止)
        赋值 (.禁止, 真)
    .判断 (等于 (命令, #))
        3.加入状态 (#禁止)
        赋值 (.禁止, 真)
    .默认
        
    .判断结束
    
.否则
    .判断开始 (等于 (命令, #))
        4.去除状态 (#禁止)
        赋值 (.禁止, 假)
    .判断 (等于 (命令, #))
        3.去除状态 (#禁止)
        赋值 (.禁止, 假)
    .默认
        
    .判断结束
    
.如果结束


.子程序 _地址编辑框_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #回车键))
    赋值 (., .内容)
.如果真结束


.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.判断开始 (等于 (按钮索引, 0))
    弹出菜单 ()
.判断 (等于 (按钮索引, 1))
    弹出菜单 ()
.判断 (等于 (按钮索引, 2))
    赋值 (., 相加 (.内容, “\xxpd\homepage\”, .内容, “\index.htm”))
.判断 (等于 (按钮索引, 3))
    #.未知支持库函数_0 ()
.判断 (等于 (按钮索引, 4))
    #.未知支持库函数_0 ()
.判断 (等于 (按钮索引, 5))
    #.未知支持库函数_0 ()
.判断 (等于 (按钮索引, 6))
    #.未知支持库函数_0 ()
.判断 (等于 (按钮索引, 8))
    选择字体大小 (2) ' 恢复到中等尺寸
.判断 (等于 (按钮索引, 9))
    #.未知支持库函数_0 ()
.判断 (等于 (按钮索引, 10))
    载入 (窗口2, , 真)
.默认
    
.判断结束


.子程序 _另存为_被选择, 空白型, , 
#.未知支持库函数_0 ()

.子程序 _打印_被选择, 空白型, , 
#.未知支持库函数_0 ()

.子程序 _打印预览_被选择, 空白型, , 
#.未知支持库函数_0 ()

.子程序 _页面设置_被选择, 空白型, , 
#.未知支持库函数_0 ()

.子程序 _退出_被选择, 空白型, , 
销毁 ()

.子程序 _关于浏览器_被选择, 空白型, , 
信息框 (相加 (“菜牛工作室”, #换行符, #换行符, “   QQ：2006251”), #确认钮, “关于！”)

.子程序 _前进_被选择, 空白型, , 
#.未知支持库函数_0 ()

.子程序 _后退_被选择, 空白型, , 
#.未知支持库函数_0 ()

.子程序 _到首页_被选择, 空白型, , 
#.未知支持库函数_0 ()

.子程序 _到搜索页_被选择, 空白型, , 
#.未知支持库函数_0 ()

.子程序 _刷新_被选择, 空白型, , 
#.未知支持库函数_0 ()

.子程序 _停止_被选择, 空白型, , 
#.未知支持库函数_0 ()

.子程序 _最大_被选择, 空白型, , 
选择字体大小 (4)

.子程序 _较大_被选择, 空白型, , 
选择字体大小 (3)

.子程序 _中等_被选择, 空白型, , 
选择字体大小 (2)

.子程序 _较小_被选择, 空白型, , 
选择字体大小 (1)

.子程序 _最小_被选择, 空白型, , 
选择字体大小 (0)

.子程序 选择字体大小, 空白型, , 同时设置菜单项的选中状态
.参数 字体大小, 整数型, , 

.局部变量 字体菜单项, 菜单, , "5", 
.局部变量 容器1, 整数型, , , 

赋值 (字体菜单项 [1], )
赋值 (字体菜单项 [2], )
赋值 (字体菜单项 [3], )
赋值 (字体菜单项 [4], )
赋值 (字体菜单项 [5], )
.计次循环首 (5, 容器1)
    赋值 (字体菜单项 [容器1], 选中, 假)
.计次循环尾 ()
赋值 (字体菜单项 [相加 (字体大小, 1)].选中, 真)
赋值 (., 字体大小)

.子程序 _图形按钮1_被单击, 空白型, , 
赋值 (., .内容)


.窗口程序集 窗口程序集2, , , 

.子程序 _按钮1_被单击, 空白型, , 
.如果 (等于 (.内容, “”))
    信息框 (“请选择年度！”, 0, “提示”)
    返回 ()
.否则
    写配置项 (相加 (取运行目录 (), “/FileTray.ini”), “设置”, “接收根目录”, 到文本 (.内容))
    写配置项 (相加 (取运行目录 (), “/FileTray.ini”), “设置”, “年度”, 到文本 (.内容))
    赋值 (_启动窗口..内容, .内容)
    赋值 (_启动窗口..内容, .内容)
    销毁 ()
    
.如果结束


.子程序 _窗口1_创建完毕, 空白型, , 
未知支持库函数_0 (2)


.子程序 _按钮2_被单击, 空白型, , 
赋值 (.内容, 到文本 (读配置项 (“C:\FileTray\FileTray.ini”, “设置”, “接收根目录”, )))

.窗口程序集 窗口程序集3, , , 

.子程序 _图片框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()


 ' 不属于任何一个程序集、类模块的函数：
