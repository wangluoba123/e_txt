 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假



.常量 无效的句柄值, "-1", 隐藏, 
.常量 属性设备描述, "0", 隐藏, 
.常量 属性硬件ID, "1", 隐藏, 
.常量 属性匹配设备ID, "2", 隐藏, 
.常量 属性服务, "4", 隐藏, 
.常量 属性设备类, "7", 隐藏, 
.常量 属性类GUID, "8", 隐藏, 
.常量 属性驱动, "9", 隐藏, 
.常量 属性配置标志, "10", 隐藏, 
.常量 属性硬件厂商名, "11", 隐藏, 
.常量 属性友好名, "12", 隐藏, 
.常量 属性LocationInformation, "13", 隐藏, 
.常量 属性物理设备对象名, "14", 隐藏, 
.常量 属性兼容, "15", 隐藏, 
.常量 属性UiNumber, "16", 隐藏, 
.常量 属性上层过滤驱动程序, "17", 隐藏, 
.常量 属性下层过滤驱动程序, "18", 隐藏, 
.常量 属性总线类型GUID, "19", 隐藏, 
.常量 属性LegacyBusType, "20", 隐藏, 
.常量 属性总线号, "21", 隐藏, 
.常量 属性枚举, "22", 隐藏, 
.常量 属性SECURITY, "23", 隐藏, 
.常量 属性SECURITY_SDS, "24", 隐藏, 
.常量 属性设备类型, "25", 隐藏, 
.常量 属性独占, "26", 隐藏, 
.常量 属性设备特征, "27", 隐藏, 
.常量 属性地址, "28", 隐藏, 
.常量 属性UiNumberDescFormat, "29", 隐藏, 
.常量 属性设备电源数据, "30", 隐藏, 
.常量 属性RemovalPolicy, "31", 隐藏, 
.常量 属性Hardware_Removal_Policy, "32", 隐藏, 
.常量 属性Removal_Policy_Override, "33", 隐藏, 
.常量 属性设备安装状态, "34", 隐藏, 
.常量 属性设备路径, "35", 隐藏, 
.常量 永远等待, "-1", 隐藏, 
.常量 立即返回, "1", 隐藏, 
.常量 等待, "2", 隐藏, 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库



 ' 所需要的模块
 ' U盘操作模块 C:\Documents and Settings\djl\桌面\usb限制\usb.ec


数据类型 _硬件信息, 公开, 
    .成员 设备描述, 文本型, , , 
    .成员 硬件ID, 文本型, , , 多段文本,已用换行符分割
    .成员 匹配设备ID, 文本型, , , 多段文本,已用换行符分割
    .成员 服务, 文本型, , , 
    .成员 设备类, 文本型, , , 
    .成员 类GUID, 文本型, , , 
    .成员 驱动, 文本型, , , 
    .成员 配置标志, 整数型, , , 
    .成员 硬件厂商名, 文本型, , , 
    .成员 友好名, 文本型, , , 
    .成员 LocationInformation, 文本型, , , 
    .成员 物理设备对象名, 文本型, , , 
    .成员 兼容, 整数型, , , 
    .成员 UiNumber, 整数型, , , 
    .成员 上层过滤驱动程序, 文本型, , , 多段文本,已用换行符分割
    .成员 下层过滤驱动程序, 文本型, , , 多段文本,已用换行符分割
    .成员 总线类型GUID, 字节集, , , 长度16
    .成员 LegacyBusType, 整数型, , , 
    .成员 总线号, 整数型, , , 
    .成员 枚举, 文本型, , , 
    .成员 SECURITY, 整数型, , , 没有实现,似乎没有什么用
    .成员 SECURITY_SDS, 整数型, , , 没有实现,似乎没有什么用
    .成员 设备类型, 整数型, , , 
    .成员 独占, 整数型, , , 
    .成员 设备特征, 整数型, , , 
    .成员 地址, 整数型, , , 
    .成员 UiNumberDescFormat, 文本型, , , 
    .成员 设备电源数据, 字节集, , , 
    .成员 RemovalPolicy, 整数型, , , 
    .成员 Hardware_Removal_Policy, 整数型, , , 
    .成员 Removal_Policy_Override, 整数型, , , 
    .成员 设备安装状态, 整数型, , , 
    .成员 设备路径, 文本型, , , 

数据类型 _设备信息数据, 公开, 
    .成员 结构尺寸, 整数型, , , 
    .成员 类GUID1, 整数型, , , 
    .成员 类GUID2, 整数型, , , 
    .成员 类GUID3, 整数型, , , 
    .成员 类GUID4, 整数型, , , 
    .成员 设备实例, 整数型, , , 
    .成员 保留, 整数型, , , 

数据类型 _移除U盘线程数据, 公开, 
    .成员 设备实例, 整数型, , , 该项不必初始化
    .成员 失败重试次数, 整数型, , , 
    .成员 失败重试延时, 整数型, , , 


.窗口程序集 窗口程序集1, , , 

.程序集变量 磁盘空间, 整数型, , , 
.程序集变量 盘符, 文本型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (到文本 (未知函数_67174594 ()))
赋值 (取磁盘总空间 ())
.如果 (大于 (517624))
    未知函数_67174595 (真)
.否则
    返回 ()
.如果结束



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 是U盘盘符, 逻辑型, , 
.参数 参文_盘符, 文本型, , 



.子程序 取U盘盘符列表, 文本型, , 001


.子程序 安全移除U盘, 整数型, , 配合[打开USB类设备信息,取下一个U盘,关闭USB类设备信息]使用
.参数 参_设备信息数据, _设备信息数据, , 该参数由'取下一个U盘'的第三个参数获得
.参数 参整_执行方式, 整数型, , #立即返回,#等待
.参数 参_线程数据, _移除U盘线程数据, , 



.子程序 禁用USB存储设备服务, 逻辑型, , 禁用驱动服务
.参数 参逻_禁止, 逻辑型, 可空, 



.子程序 强制移除U盘, 空白型, , 未实现的,在以后实现


.子程序 取U盘盘符数量, 整数型, , 002


.子程序 取U盘数量, 整数型, , 


.子程序 置U盘只读, 逻辑型, , 需要windows xp sp2支持
.参数 参逻_只读, 逻辑型, , 



.子程序 注册USB设备改变事件, 子程序指针, , 
.参数 参整_窗口句柄, 整数型, , 
.参数 参针_设备插入处理子程序, 子程序指针, , 
.参数 参针_设备移除处理子程序, 子程序指针, , 



.子程序 取消注册USB设备改变事件, 空白型, , 


.子程序 打开USB类设备信息, 整数型, , 


.子程序 取下一个U盘, 逻辑型, , 
.参数 参整_设备信息句柄, 整数型, , 
.参数 参整_设备索引, 整数型, 参考, 
.参数 参_设备信息数据, _设备信息数据, 可空, 写出当前U盘的设备信息数据



.子程序 关闭USB类设备信息, 逻辑型, , 
.参数 参整_设备信息句柄, 整数型, , 



.子程序 填充硬件信息, 空白型, , 
.参数 参整_设备信息句柄, 整数型, , 
.参数 参_设备信息数据, _设备信息数据, , 
.参数 参_硬件信息, _硬件信息, , 



.子程序 取硬件信息_i, 逻辑型, , 取硬件数值信息
.参数 参整_设备信息句柄, 整数型, , 
.参数 参整_设备信息数据, _设备信息数据, , 
.参数 参整_属性代码, 整数型, , 
.参数 参整_返回值, 整数型, 参考, 



.子程序 取硬件信息_t, 逻辑型, , 取硬件文本信息
.参数 参整_设备信息句柄, 整数型, , 
.参数 参_设备信息数据, _设备信息数据, , 
.参数 参整_属性代码, 整数型, , 
.参数 参文_缓冲区, 文本型, , 
.参数 参整_缓冲区尺寸, 整数型, 参考, in out



.子程序 关闭句柄, 逻辑型, , 
.参数 参整_句柄, 整数型, , 



.子程序 安全移除U盘独立, 整数型, , 如果请求了线程句柄,则返回线程的句柄值;否则返回0
.参数 参整_序号, 整数型, , 按枚举到U盘先后的顺序,从1开始;如果为0则移除所有U盘
.参数 参整_失败重试次数, 整数型, , 为空,则不重试
.参数 参整_失败重试延时, 整数型, , ms
.参数 参逻_请求线程句柄, 逻辑型, , 弹出U盘采用新线程方式,该参数为真,表示需要请求得到线程的句柄



.子程序 取线程退出代码, 逻辑型, , 
.参数 参整_线程句柄, 整数型, , 
.参数 参整_退出代码, 整数型, 参考, 



.子程序 等待事件对象, 整数型, , 
.参数 参整_事件句柄, 整数型, , 
.参数 参整_等待超时值, 整数型, , 



.子程序 取兼容文本, 文本型, , _硬件信息.兼容
.参数 参整_兼容代码, 整数型, , 



.子程序 取RemovalPolicy文本, 文本型, , _硬件信息.RemovalPolicy;_硬件信息.Hardware_Removal_Policy;_硬件信息.Removal_Policy_Override
.参数 参整_RemovalPolicy, 整数型, , 



.子程序 取设备安装状态文本, 文本型, , _硬件信息.设备安装状态
.参数 参整_设备安装状态, 整数型, , 



.子程序 取设备类型文本, 文本型, , _硬件信息.设备类型
.参数 参整_设备类型, 整数型, , 



.子程序 取LegacyBusType文本, 文本型, , 
.参数 参整_总线类型, 整数型, , 




 ' 不属于任何一个程序集、类模块的函数：
