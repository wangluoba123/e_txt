 ' 文件类型：Windows窗口程序

 ' 程序名称：会员消费关系系统
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 595
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 真
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “会员消费关系系统”
    帮助文件名 = “”

窗口 用户权限设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 438
    高度 = 360
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “用户权限设置”
    帮助文件名 = “”

窗口 添加用户窗口
    左边 = 50
    顶边 = 50
    宽度 = 623
    高度 = 383
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “添加用户”
    帮助文件名 = “”

窗口 修改密码窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “修改密码
”
    帮助文件名 = “”

窗口 会员资料录入窗口
    左边 = 50
    顶边 = 50
    宽度 = 780
    高度 = 550
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “会员资料录入”
    帮助文件名 = “”

窗口 会员资金充值窗口
    左边 = 50
    顶边 = 50
    宽度 = 512
    高度 = 416
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “会员资金充值”
    帮助文件名 = “”

窗口 员工资料录入窗口
    左边 = 50
    顶边 = 50
    宽度 = 780
    高度 = 550
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “员工资料录入”
    帮助文件名 = “”

窗口 商品资料录入窗口
    左边 = 50
    顶边 = 50
    宽度 = 780
    高度 = 550
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “商品资料录入”
    帮助文件名 = “”

窗口 会员购买商品录入窗口
    左边 = 50
    顶边 = 50
    宽度 = 780
    高度 = 550
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “会员购买商品”
    帮助文件名 = “”

窗口 会员资金结余查询窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “会员资金结余查询”
    帮助文件名 = “”

窗口 商品进货窗口
    左边 = 50
    顶边 = 50
    宽度 = 512
    高度 = 416
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “商品进货”
    帮助文件名 = “”

窗口 会员资料查询窗口
    左边 = 50
    顶边 = 50
    宽度 = 780
    高度 = 550
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “会员资料查询”
    帮助文件名 = “”

窗口 会员消费情况查询窗口
    左边 = 50
    顶边 = 50
    宽度 = 780
    高度 = 550
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “会员消费情况查询”
    帮助文件名 = “”

窗口 会员消费金额查询窗口
    左边 = 50
    顶边 = 50
    宽度 = 780
    高度 = 550
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “会员消费金额查询”
    帮助文件名 = “”

窗口 员工资料查询窗口
    左边 = 50
    顶边 = 50
    宽度 = 780
    高度 = 550
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “员工
资料查询”
    帮助文件名 = “”

窗口 员工业绩查询窗口
    左边 = 50
    顶边 = 50
    宽度 = 780
    高度 = 550
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “员工业绩查询”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 325
    高度 = 272
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 2
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 真
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 商品资料查询窗口
    左边 = 50
    顶边 = 50
    宽度 = 780
    高度 = 550
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “商品资料查询”
    帮助文件名 = “”

窗口 商品销售额查询窗口
    左边 = 50
    顶边 = 50
    宽度 = 780
    高度 = 550
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “商品销售额查询”
    帮助文件名 = “”

窗口 会员修改窗口
    左边 = 50
    顶边 = 50
    宽度 = 485
    高度 = 314
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “会员修改”
    帮助文件名 = “”

窗口 员工修改窗口
    左边 = 50
    顶边 = 50
    宽度 = 485
    高度 = 314
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “员工修改”
    帮助文件名 = “”

窗口 窗口2
    左边 = 50
    顶边 = 50
    宽度 = 330
    高度 = 234
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “用户登陆”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 1 3 高级表格支持库
 ' ExtMenu 9909FBB013704cfa8FE7E739DB7172DE 1 6 超级菜单支持库
 ' twain 730FA7B73AAB409a8554F9553CF2DD87 1 5 数码设备支持库
 ' eExcel2000 F86EC5989E044d42BC98C692C0B54727 1 0 EXCEL2000支持库
 ' CnCalendar {18C0788E-59AE-4112-B452-6BF0C1B727FB} 1 2 农历日期支持库



 ' 所需要的模块
 ' excel模块 $excel保存.ec
 ' id $id.ec
 ' excel导出 $excels.ec
 ' commodity $commodity.ec
 ' mydb数据库模块 E:\编程开发\项目\sql数据库\mydb数据库模块.ec


.全局变量 机器号, 文本型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 记录集, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 数据库文件名, 文本型, , , 

CNSQL初始化 (“本DLL版权属鼎龙科技所有！只授权给个人学习和使用。非授权请勿商业应用！联系电话13955016851。”)
赋值 (_启动窗口., 假)
未知支持库函数_0 (2)
赋值 (.底图, 读入文件 (相加 (取运行目录 (), “\phopo\beauty210.jpg”)))
赋值 (_启动窗口., 相减 (相加 (_启动窗口., 551), _启动窗口.取用户区高度 ()))
赋值 (数据库文件名, 读配置项 (相加 (取运行目录 (), “\run.ini”), “数据库文件”, “数据库”, ))
 ' CNSQL连接 (“127.0.0.1”, 198, “admin”, “admin”, 5000)
.如果 (CNSQL打开数据库 (相加 (“.\data\”, 数据库文件名), “”, “”, 2, 5000))
    载入 (窗口2, , 真)
.否则
    信息框 (“数据库不存在，请检查数据库是否正常”, 0, )
.如果结束



.子程序 _用户及权限管理_被选择, 空白型, , 
载入 (用户权限设置窗口, _启动窗口, 真)


.子程序 _修改密码_被选择, 空白型, , 
载入 (修改密码窗口, _启动窗口, 真)


.子程序 _使用单位_被选择, 空白型, , 
 ' 载入 (使用单位窗口, _启动窗口, 真)


.子程序 _会员资料录入_被选择, 空白型, , 
载入 (会员资料录入窗口, _启动窗口, 真)


.子程序 _员工资料录入_被选择, 空白型, , 
载入 (员工资料录入窗口, _启动窗口, 真)


.子程序 _商品资料录入_被选择, 空白型, , 
载入 (商品资料录入窗口, _启动窗口, 真)


.子程序 _会员购买商品_被选择, 空白型, , 
载入 (会员购买商品录入窗口, _启动窗口, 真)


.子程序 _会员资金充值_被选择, 空白型, , 
载入 (会员资金充值窗口, _启动窗口, 真)


.子程序 _商品进货_被选择, 空白型, , 
载入 (商品进货窗口, _启动窗口, 真)

.子程序 _会员资料查询_被选择, 空白型, , 
载入 (会员资料查询窗口, _启动窗口, 真)


.子程序 _会员消费情况查询_被选择, 空白型, , 
载入 (会员消费情况查询窗口, _启动窗口, 真)


.子程序 _会员消费金额查询_被选择, 空白型, , 
载入 (会员消费金额查询窗口, _启动窗口, 真)


.子程序 _员工资料查询_被选择, 空白型, , 
载入 (员工资料查询窗口, _启动窗口, 真)


.子程序 _员工业绩查询_被选择, 空白型, , 
载入 (员工业绩查询窗口, _启动窗口, 真)


.子程序 _会员资金结余查询_被选择, 空白型, , 
载入 (会员资金结余查询窗口, _启动窗口, 真)


.子程序 _商品资料查询_被选择, 空白型, , 
载入 (商品资料查询窗口, _启动窗口, 真)


.子程序 _商品销售额查询_被选择, 空白型, , 
载入 (商品销售额查询窗口, _启动窗口, 真)


.子程序 _关于_被选择, 空白型, , 
信息框 (相加 (“本软件有袁峥嵘编写”, #换行符, “地址：伊宁市飞机场路8号”, #换行符, “联系电话：13179998263”), #信息图标, )


.子程序 _联系我们_被选择, 空白型, , 
载入 (窗口1, , 真)


.子程序 _退出_被选择, 空白型, , 
.如果真 (等于 (信息框 (“你确定要真的退出么”, 相加 (#询问图标, #是否钮), ), #是钮))
    CNSQL关闭数据库 ()
    CNSQL关闭连接 ()
    CNSQL卸载 ()
    _启动窗口.销毁 ()
.如果真结束





.子程序 __启动窗口_可否被关闭, 逻辑型, , 
_退出_被选择 ()


.窗口程序集 窗口程序集2, , , 

.程序集变量 sss, 整数型, , , 
.程序集变量 匿名程序集变量_3209, 空白型, , , 
.子程序 _添加按钮_被单击, 空白型, , 
载入 (添加用户窗口, _启动窗口, 真)




.子程序 _用户权限设置窗口_创建完毕, 空白型, , 
.局部变量 次数, 整数型, , , 
.局部变量 x, 整数型, , , 



赋值 (.图片, 读入文件 (相加 (取运行目录 (), “\phopo\1138709-butterfly27-embed.jpg”)))
赋值 (sss, CNSQL查询SQL (“select * from 登陆表”))
CNSQL到首记录 (sss)
赋值 (x, 1)
清空 ()
赋值 (.位置.字体大小, 14)
.加入项目 (“管理人员 ”, , , )
赋值 (.位置.字体大小, 10)
.判断循环首 (不等于 (CNSQL是否尾记录后 (sss), 真))
    0.加入项目 (CNSQL读文本 (sss, “用户姓名”), , , )
    CNSQL到后一记录 (sss)
.判断循环尾 ()
0.扩展 ()


.子程序 _树型框1_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 


CNSQL到首记录 (sss)

.判断循环首 (不等于 (CNSQL读文本 (sss, “用户姓名”), .取项目文本 (.最大化按钮)))
    
    CNSQL到后一记录 (sss)
    .如果 (等于 (.最大化按钮, 0))
        跳出循环 ()
    .否则
        
    .如果结束
    
.判断循环尾 ()
赋值 (.图片, 到字节集 (CNSQL读文本 (sss, “用户照片”)))
.如果 (等于 (.最大化按钮, 0))
    赋值 (.图片, 读入文件 (相加 (取运行目录 (), “\phopo\1138709-butterfly27-embed.jpg”)))
    
.否则
    
.如果结束


.子程序 _取消按钮_被单击, 空白型, , 
用户权限设置窗口.销毁 ()
CNSQL关闭查询 (sss)


.窗口程序集 窗口程序集3, , , 

.子程序 _添加用户窗口_创建完毕, 空白型, , 
未知支持库函数_0 (2)
赋值 (., 1)
真.未知支持库函数_7 (60)


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 zz, 字节集, , , 

相加 (取运行目录 (), “\txet\sss.bmp”).未知支持库函数_11 ()
赋值 (.图片, 读入文件 (相加 (取运行目录 (), “\txet\sss.bmp”)))


.子程序 _按钮1_被单击, 空白型, , 
赋值 (.图片, {  })


.子程序 _取消按钮_被单击, 空白型, , 
.局部变量 x, 整数型, , , 

添加用户窗口.销毁 ()
用户权限设置窗口.刷新显示 (.)


_用户权限设置窗口_创建完毕 ()


.子程序 _确定按钮_被单击, 空白型, , 
.局部变量 xxx, 文本型, , , 

.判断开始 (等于 (.选中, 真))
    赋值 (xxx, “管理员”)
.判断 (等于 (.选中, 真))
    赋值 (xxx, “操作员”)
.判断 (等于 (.选中, 真))
    赋值 (xxx, “访问者”)
.默认
    
.判断结束
.如果 (等于 (.内容, .内容))
    CNSQL开始事务 ()
    .如果 (等于 (CNSQL执行命令 (相加 (“insert into 登陆表 values('”, 到文本 (.内容), “','”, 到文本 (.内容), “','”, xxx, “',?)”), .图片), 真))
        信息框 (“数据保存成功”, 0, )
        CNSQL提交事务 ()
        赋值 (.图片, {  })
        连续赋值 (“”, .内容, .内容, .内容)
        
    .否则
        信息框 (“数据保存失败”, 0, )
        CNSQL回滚事务 ()
    .如果结束
    
.否则
    信息框 (“密码错误请查询”, 0, )
    
    
    
    
.如果结束







.窗口程序集 窗口程序集4, , , 

.子程序 _商品表格_光标位置改变, 空白型, , 


.子程序 _商品资料录入窗口_创建完毕, 空白型, , 
商品ID编号 ()
商品表格初始化 ()


.子程序 商品ID编号, 空白型, , 
.局部变量 数据集合, 整数型, , , 
.局部变量 数据编号, 整数型, , , 

赋值 (数据集合, CNSQL查询SQL (“select * from 商品表”))
CNSQL到尾记录 (数据集合)
赋值 (数据编号, CNSQL读数值 (数据集合, “商品ID”))
赋值 (.标题, 到文本 (相加 (到数值 (数据编号), 1)))
CNSQL关闭查询 (数据集合)


.子程序 商品表格初始化, 空白型, , 
1.未知支持库函数_62 (1, ., .)
0.未知支持库函数_9 (0, #., “序号”)
0.未知支持库函数_9 (1, #., “商品ID”)
0.未知支持库函数_9 (2, #., “商品编号”)
0.未知支持库函数_9 (3, #., “商品名称”)
0.未知支持库函数_9 (4, #., “商品类型”)
0.未知支持库函数_9 (5, #., “单价”)
0.未知支持库函数_9 (6, #., “存货”)
0.未知支持库函数_9 (7, #., “单位”)
0.未知支持库函数_9 (8, #., “产地”)
0.未知支持库函数_9 (9, #., “用途”)
0.未知支持库函数_25 (0, ., ., #.)
0.未知支持库函数_32 (30)
1.未知支持库函数_32 (70)
2.未知支持库函数_32 (70)
3.未知支持库函数_32 (70)
4.未知支持库函数_32 (80)
5.未知支持库函数_32 (70)
6.未知支持库函数_32 (70)
7.未知支持库函数_32 (150)
8.未知支持库函数_32 (150)
9.未知支持库函数_32 (150)
5.未知支持库函数_30 (#.)
6.未知支持库函数_30 (#.)


.子程序 _按钮1_被单击, 空白型, , 
CNSQL开始事务 ()
.如果 (等于 (CNSQL执行命令 (相加 (“insert into 商品表 (商品编号,商品名称,商品类型,单价,存货,单位,产地,用途) values (”, .内容, “,'”, .内容, “','”, .内容, “',”, .内容, “,”, .内容, “,'”, .内容, “','”, .内容, “','”, .内容, “')”), ), 真))
    CNSQL提交事务 ()
    信息框 (“数据保存成功”, 0, )
    商品表格输入 ()
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
    
    获取焦点 ()
    赋值 (.标题, 到文本 (相加 (到数值 (.标题), 1)))
.否则
    CNSQL回滚事务 ()
    
.如果结束


.子程序 商品表格输入, 空白型, , //把数据录入的数据显示到表格里
.局部变量 插入一行, 整数型, , , 

赋值 (插入一行, .)
到文本 (插入一行).未知支持库函数_38 (插入一行)
插入一行.未知支持库函数_9 (1, #., .标题)
插入一行.未知支持库函数_9 (2, #., .内容)
插入一行.未知支持库函数_9 (3, #., .内容)
插入一行.未知支持库函数_9 (4, #., .内容)
插入一行.未知支持库函数_9 (5, #., .内容)
插入一行.未知支持库函数_9 (6, #., .内容)
插入一行.未知支持库函数_9 (7, #., .内容)
插入一行.未知支持库函数_9 (8, #., .内容)
插入一行.未知支持库函数_9 (9, #., .内容)


.子程序 _清屏按钮_被单击, 空白型, , 
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)

.子程序 _删除按钮_被单击, 空白型, , 
.局部变量 即将删除ID, 文本型, , , 

.如果 (大于或等于 (到数值 (.), 2))
    
    CNSQL开始事务 ()
    赋值 (即将删除ID, 到文本 (到数值 (未知支持库函数_3 ()).未知支持库函数_10 (1)))
    .如果 (CNSQL执行命令 (相加 (“delete from 商品表 where 商品ID=”, 即将删除ID), ))
        到数值 (未知支持库函数_3 ()).未知支持库函数_36 ()
        CNSQL提交事务 ()
    .否则
        CNSQL回滚事务 ()
    .如果结束
    
.否则
    信息框 (“没有要删除的数据”, 0, )
    
.如果结束




.子程序 _EXCEL导出按钮_被单击, 空白型, , 
excel导出 (“商品录入清单”, “填报单位：中华保险公司”)


.子程序 _按钮2_被单击, 空白型, , 
赋值 (., #白色)
“商品录入清单”.未知支持库函数_46 (“华文行楷”, 20, 真, 2)
未知支持库函数_27 ()
未知支持库函数_26 ()
赋值 (., #浅灰)


.子程序 _商品表格_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 商品录入记录集句柄, 整数型, , , 

.如果 (大于 (未知支持库函数_3 (), 0))
    赋值 (商品录入记录集句柄, CNSQL查询SQL (相加 (“select * from 商品表 where 商品ID=”, 到数值 (未知支持库函数_3 ()).未知支持库函数_10 (1))))
    CNSQL关闭查询 (商品录入记录集句柄)
     ' 修改商品 (商品表格, _启动窗口.数据库)
.否则
    
.如果结束




.窗口程序集 窗口程序集5, , , 

.子程序 _超级链接框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 



.子程序 _窗口1_创建完毕, 空白型, , 
赋值 (窗口1., 读入文件 (相加 (取运行目录 (), “\phopo\c3.jpg”)))


.窗口程序集 窗口程序集6, , , 

.程序集变量 会员录入记录句柄, 整数型, , , 
.程序集变量 BBB, 文本型, , , 
.子程序 _录入按钮_被单击, 空白型, , 
CNSQL开始事务 ()
.如果 (等于 (CNSQL执行命令 (相加 (“insert into 会员表 (会员编号,会员姓名,性别,民族,学历,生日,电话,地址,入会时间,备注,职业,结余,欠款,点数,级别) values (”, .内容, “,'”, 到文本 (.内容), “','”, 到文本 (.内容), “','”, 到文本 (.内容), “','”, 到文本 (.内容), “','”, 时间到文本 (.今天, ), “','”, 到文本 (.内容), “','”, 到文本 (.内容), “','”, 时间到文本 (.今天, ), “','”, 到文本 (.内容), “','”, 到文本 (.内容), “',”, .内容, “,”, .内容, “,”, .内容, “,'”, 到文本 (.内容), “')”), ), 真))
    CNSQL提交事务 ()
    信息框 (“数据保存成功”, #信息图标, )
    表格输入 ()
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
    获取焦点 ()
    赋值 (.标题, 到文本 (相加 (到数值 (.标题), 1)))
.否则
    CNSQL回滚事务 ()
    
.如果结束



.子程序 _会员资料录入窗口_创建完毕, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 学历, 文本型, , "0", 
.局部变量 职业, 文本型, , "0", 
.局部变量 运行文件, 文本型, , , 


赋值 (运行文件, 相加 (取运行目录 (), “\run.ini”))
赋值 (.内容, 到文本 (读配置项 (运行文件, “性别”, “性别1”, ).加入项目 ()))
赋值 (.内容, 到文本 (读配置项 (运行文件, “性别”, “性别2”, ).加入项目 ()))
赋值 (学历, 分割文本 (读配置项 (运行文件, “学历”, “学历”, ), “，”, ))
.计次循环首 (取数组成员数 (学历), i)
    赋值 (.内容, 到文本 (学历.加入项目 ( [i], )))
.计次循环尾 ()
赋值 (职业, 分割文本 (读配置项 (运行文件, “职业”, “职业”, ), “，”, ))
.计次循环首 (取数组成员数 (职业), i)
    赋值 (.内容, 到文本 (职业.加入项目 ( [i], )))
.计次循环尾 ()
赋值 (.现行选中项, 0)
赋值 (.现行选中项, 0)
赋值 (.现行选中项, 0)
会员ID编号 ()
表格初始化 ()

.子程序 _学历组合框_编辑内容被改变, 空白型, , 
赋值 (.现行选中项, 到数值 (.内容))

.子程序 _性别组合框_编辑内容被改变, 空白型, , 
赋值 (.现行选中项, 到数值 (.内容))

.子程序 _职业组合框_编辑内容被改变, 空白型, , 
赋值 (.现行选中项, 到数值 (.内容))


.子程序 表格初始化, 空白型, , //对会员表进行初始化操作
.局部变量 次数, 整数型, , , 

1.未知支持库函数_62 (1, ., .)
0.未知支持库函数_9 (0, #., “序号”)
0.未知支持库函数_9 (1, #., “会员编号”)
0.未知支持库函数_9 (2, #., “姓名”)
0.未知支持库函数_9 (3, #., “性别”)
0.未知支持库函数_9 (4, #., “民族”)
0.未知支持库函数_9 (5, #., “学历”)
0.未知支持库函数_9 (6, #., “生日”)
0.未知支持库函数_9 (7, #., “电话”)
0.未知支持库函数_9 (8, #., “地址”)
0.未知支持库函数_9 (9, #., “入会时间”)
0.未知支持库函数_9 (10, #., “职业”)
0.未知支持库函数_9 (11, #., “结余”)
0.未知支持库函数_9 (12, #., “欠款”)
0.未知支持库函数_9 (13, #., “备注”)
0.未知支持库函数_9 (14, #., “机器号”)
0.未知支持库函数_9 (15, #., “点数”)
0.未知支持库函数_9 (16, #., “会员级别”)
0.未知支持库函数_25 (0, ., ., #.)
0.未知支持库函数_32 (35)
1.未知支持库函数_32 (60)
2.未知支持库函数_32 (80)
3.未知支持库函数_32 (35)
4.未知支持库函数_32 (80)
5.未知支持库函数_32 (35)
6.未知支持库函数_32 (80)
7.未知支持库函数_32 (80)
8.未知支持库函数_32 (100)
9.未知支持库函数_32 (80)
10.未知支持库函数_32 (35)
11.未知支持库函数_32 (60)
12.未知支持库函数_32 (60)
13.未知支持库函数_32 (150)
14.未知支持库函数_32 (50)
15.未知支持库函数_32 (50)
16.未知支持库函数_32 (80)
6.未知支持库函数_30 (#.)
9.未知支持库函数_30 (#.)
11.未知支持库函数_30 (#.)
12.未知支持库函数_30 (#.)
11.未知支持库函数_41 (2)
12.未知支持库函数_41 (2)
 ' 会员表格.行数 ＝ 20
 ' .计次循环首 (., 次数)
     ' 会员表格.置数据 (次数, 0, #表格常量.文本型, 次数)
     ' 次数 ＝ 次数 ＋ 1
 ' .计次循环尾 ()


.子程序 表格输入, 空白型, , //把数据录入的数据显示到表格里
.局部变量 插入一行, 整数型, , , 

赋值 (插入一行, .)
到文本 (插入一行).未知支持库函数_38 (插入一行)
插入一行.未知支持库函数_9 (1, #., .内容)
插入一行.未知支持库函数_9 (2, #., .内容)
插入一行.未知支持库函数_9 (3, #., .内容)
插入一行.未知支持库函数_9 (4, #., .内容)
插入一行.未知支持库函数_9 (5, #., .内容)
插入一行.未知支持库函数_9 (6, #., 时间到文本 (.今天, ))
插入一行.未知支持库函数_9 (7, #., .内容)
插入一行.未知支持库函数_9 (8, #., .内容)
插入一行.未知支持库函数_9 (9, #., 时间到文本 (.今天, ))
插入一行.未知支持库函数_9 (10, #., .内容)
插入一行.未知支持库函数_9 (11, #., .内容)
插入一行.未知支持库函数_9 (12, #., .内容)
插入一行.未知支持库函数_9 (13, #., .内容)
插入一行.未知支持库函数_9 (14, #., .标题)
插入一行.未知支持库函数_9 (15, #., .内容)
插入一行.未知支持库函数_9 (16, #., .内容)


.子程序 _打印按钮_被单击, 空白型, , 
赋值 (., #白色)
“录入会员清单”.未知支持库函数_46 (“华文行楷”, 20, 真, 2)
未知支持库函数_27 ()
 ' 会员表格.打印 ()
赋值 (., #浅灰)


.子程序 _EXCEL导出按钮_被单击, 空白型, , 
.局部变量 标尺, 文本型, , , 
.局部变量 行数, 整数型, , , 
.局部变量 列数, 整数型, , , 



未知支持库函数_0 ()
.未知支持库函数_6 ()
相加 (取运行目录 (), “\Normal\会员录入模版.xlt”).未知支持库函数_14 ()
赋值 (标尺, “ABCDEFGHIJKLMNOP”)
赋值 (., 1)
.计次循环首 (., 行数)
    .计次循环首 (16, 列数)
        赋值 (., 相加 (取文本中间 (标尺, 列数, 1), 到文本 (相加 (行数, 2))))
        赋值 (., 相加 (取文本中间 (标尺, 列数, 1), 到文本 (相加 (行数, 2))))
        赋值 (., 相减 (行数, 1).未知支持库函数_10 (相减 (列数, 1)))
        1.未知支持库函数_30 (2, 0)
    .计次循环尾 ()
.计次循环尾 ()
赋值 (., 真)
未知支持库函数_1 ()









.子程序 _清屏按钮_被单击, 空白型, , 
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)


.子程序 _删除按钮_被单击, 空白型, , 
.如果 (大于或等于 (., 2))
    CNSQL开始事务 ()
    赋值 (机器号, 到文本 (到数值 (未知支持库函数_3 ()).未知支持库函数_10 (14)))
    .如果 (CNSQL执行命令 (相加 (“delete from 会员表 where 会员ID=”, 机器号), ))
        到数值 (未知支持库函数_3 ()).未知支持库函数_36 ()
        CNSQL提交事务 ()
        
    .否则
        CNSQL回滚事务 ()
    .如果结束
    
.否则
    信息框 (“没有要删除的数据”, 0, )
    
.如果结束


.子程序 _会员表格_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 会员录入记录句柄, 整数型, , 


.如果 (大于 (未知支持库函数_3 (), 0))
    赋值 (机器号, 到数值 (未知支持库函数_3 ()).未知支持库函数_10 (14))
     ' 信息框 (机器号, 0, )
    赋值 (会员录入记录句柄, CNSQL查询SQL (相加 (“select * from 会员表 where 会员ID= ”, 机器号)))
     ' BBB ＝ CNSQL读文本 (会员录入记录句柄, “会员姓名”)
     ' 信息框 (BBB, 0, )
    载入 (会员修改窗口, , 真)
    CNSQL关闭查询 (会员录入记录句柄)
    
.否则
    返回 ()
    
.如果结束




.子程序 会员ID编号, 空白型, , 
.局部变量 数据集合, 整数型, , , 
.局部变量 数据编号, 整数型, , , 

赋值 (数据集合, CNSQL查询SQL (“select  * from 会员表 ”))
CNSQL到尾记录 (数据集合)
赋值 (数据编号, CNSQL读数值 (数据集合, “会员ID”))
赋值 (.标题, 到文本 (相加 (到数值 (数据编号), 1)))
CNSQL关闭查询 (数据集合)

.子程序 _会员表格_光标位置改变, 空白型, , 


.窗口程序集 窗口程序集7, , , 

.程序集变量 会员窗口表格, 未知类型0x40001, , , 
.子程序 _会员修改窗口_创建完毕, 空白型, , 
.局部变量 表格数组, 文本型, , "16", 
.局部变量 次数, 整数型, , , 

赋值 (会员窗口表格, 会员资料录入窗口.)
.计次循环首 (16, 次数)
    赋值 (表格数组 [次数], 到文本 (会员窗口表格.未知支持库函数_10 (到数值 (会员资料录入窗口.未知支持库函数_3 (.)), 次数)))
.计次循环尾 ()
赋值 (.内容, 表格数组 [2])
赋值 (.内容, 表格数组 [3])
赋值 (.内容, 表格数组 [1])
赋值 (.内容, 表格数组 [4])
赋值 (.内容, 表格数组 [5])
赋值 (.今天, 到时间 (表格数组 [6]))
赋值 (.今天, 到时间 (表格数组 [9]))
赋值 (.内容, 表格数组 [10])
赋值 (.内容, 表格数组 [11])
赋值 (.内容, 表格数组 [12])
赋值 (.内容, 表格数组 [7])
赋值 (.内容, 表格数组 [8])
赋值 (.内容, 表格数组 [13])
赋值 (.内容, 表格数组 [15])
赋值 (.内容, 表格数组 [16])


.子程序 _按钮1_被单击, 空白型, , 
CNSQL开始事务 ()
.如果 (等于 (CNSQL执行命令 (相加 (“update 会员表 set 会员编号='”, .内容, “',”, “会员姓名='”, .内容, “',”, “性别='”, .内容, “',”, “民族='”, .内容, “',”, “学历='”, .内容, “',”, “生日='”, 时间到文本 (.今天, ), “',”, “电话='”, .内容, “',”, “地址='”, .内容, “',”, “入会时间='”, 时间到文本 (.今天, ), “',”, “备注='”, .内容, “',”, “职业='”, .内容, “',”, “结余=”, .内容, “,”, “欠款=”, .内容, “,”, “点数=”, .内容, “,”, “级别='”, .内容, “'”, “ where 会员ID=”, 机器号), ), 真))
    CNSQL提交事务 ()
    信息框 (“修改成功”, 0, )
.否则
    CNSQL回滚事务 ()
    信息框 (“修改不成功”, 0, )
    
.如果结束
会员窗口表格.未知支持库函数_9 (到数值 (会员窗口表格.未知支持库函数_3 ()), 1, #., .内容)
会员窗口表格.未知支持库函数_9 (到数值 (会员窗口表格.未知支持库函数_3 ()), 2, #., .内容)
会员窗口表格.未知支持库函数_9 (到数值 (会员窗口表格.未知支持库函数_3 ()), 3, #., .内容)
会员窗口表格.未知支持库函数_9 (到数值 (会员窗口表格.未知支持库函数_3 ()), 4, #., .内容)
会员窗口表格.未知支持库函数_9 (到数值 (会员窗口表格.未知支持库函数_3 ()), 5, #., .内容)
会员窗口表格.未知支持库函数_9 (到数值 (会员窗口表格.未知支持库函数_3 ()), 6, #., 时间到文本 (.今天, ))
会员窗口表格.未知支持库函数_9 (到数值 (会员窗口表格.未知支持库函数_3 ()), 7, #., .内容)
会员窗口表格.未知支持库函数_9 (到数值 (会员窗口表格.未知支持库函数_3 ()), 8, #., .内容)
会员窗口表格.未知支持库函数_9 (到数值 (会员窗口表格.未知支持库函数_3 ()), 9, #., 时间到文本 (.今天, ))
会员窗口表格.未知支持库函数_9 (到数值 (会员窗口表格.未知支持库函数_3 ()), 10, #., .内容)
会员窗口表格.未知支持库函数_9 (到数值 (会员窗口表格.未知支持库函数_3 ()), 11, #., .内容)
会员窗口表格.未知支持库函数_9 (到数值 (会员窗口表格.未知支持库函数_3 ()), 12, #., .内容)
会员窗口表格.未知支持库函数_9 (到数值 (会员窗口表格.未知支持库函数_3 ()), 13, #., .内容)
会员窗口表格.未知支持库函数_9 (到数值 (会员窗口表格.未知支持库函数_3 ()), 15, #., .内容)
会员窗口表格.未知支持库函数_9 (到数值 (会员窗口表格.未知支持库函数_3 ()), 16, #., .内容)
销毁 ()


.窗口程序集 窗口程序集8, , , 

.子程序 _员工资料录入窗口_创建完毕, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 学历, 文本型, , "0", 
.局部变量 运行文件, 文本型, , , 

赋值 (运行文件, 相加 (取运行目录 (), “\run.ini”))
赋值 (.内容, 到文本 (读配置项 (运行文件, “性别”, “性别1”, ).加入项目 ()))
赋值 (.内容, 到文本 (读配置项 (运行文件, “性别”, “性别2”, ).加入项目 ()))
赋值 (学历, 分割文本 (读配置项 (运行文件, “学历”, “学历”, ), “，”, ))
.计次循环首 (取数组成员数 (学历), i)
    赋值 (.内容, 到文本 (学历.加入项目 ( [i], )))
.计次循环尾 ()
赋值 (.现行选中项, 0)
赋值 (.现行选中项, 0)
员工表格初始化 ()
员工ID编号 ()





.子程序 _按钮1_被单击, 空白型, , 

CNSQL开始事务 ()
.如果 (等于 (CNSQL执行命令 (相加 (“insert into 员工表 (员工编号,员工姓名,性别,民族,学历,生日,电话,住址,加盟时间,备注) values (”, .内容, “,'”, 到文本 (.内容), “','”, 到文本 (.内容), “','”, 到文本 (.内容), “','”, 到文本 (.内容), “','”, 时间到文本 (.今天, ), “','”, 到文本 (.内容), “','”, 到文本 (.内容), “','”, 时间到文本 (.今天, ), “','”, 到文本 (.内容), “')”), ), 真))
    CNSQL提交事务 ()
    信息框 (“数据保存成功”, #信息图标, )
    员工表格输入 ()
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
    获取焦点 ()
    赋值 (.标题, 到文本 (相加 (到数值 (.标题), 1)))
.否则
    CNSQL回滚事务 ()
    
.如果结束



.子程序 _学历组合框_编辑内容被改变, 空白型, , 
赋值 (.现行选中项, 到数值 (.内容))


.子程序 _性别组合框_编辑内容被改变, 空白型, , 
赋值 (.现行选中项, 到数值 (.内容))


.子程序 员工表格初始化, 空白型, , //对会员表进行初始化操作
.局部变量 次数, 整数型, , , 

1.未知支持库函数_62 (1, ., .)
0.未知支持库函数_9 (0, #., “序号”)
0.未知支持库函数_9 (1, #., “员工ID”)
0.未知支持库函数_9 (2, #., “员工编号”)
0.未知支持库函数_9 (3, #., “员工姓名”)
0.未知支持库函数_9 (4, #., “性别”)
0.未知支持库函数_9 (5, #., “民族”)
0.未知支持库函数_9 (6, #., “学历”)
0.未知支持库函数_9 (7, #., “生日”)
0.未知支持库函数_9 (8, #., “电话”)
0.未知支持库函数_9 (9, #., “住址”)
0.未知支持库函数_9 (10, #., “加盟时间”)
0.未知支持库函数_9 (11, #., “备注”)
0.未知支持库函数_25 (0, ., ., #.)
0.未知支持库函数_32 (35)
1.未知支持库函数_32 (60)
2.未知支持库函数_32 (80)
3.未知支持库函数_32 (80)
4.未知支持库函数_32 (35)
5.未知支持库函数_32 (35)
6.未知支持库函数_32 (35)
7.未知支持库函数_32 (100)
8.未知支持库函数_32 (100)
9.未知支持库函数_32 (150)
10.未知支持库函数_32 (100)
11.未知支持库函数_32 (150)
12.未知支持库函数_32 (60)
7.未知支持库函数_30 (#.)
10.未知支持库函数_30 (#.)


.子程序 员工表格输入, 空白型, , //把数据录入的数据显示到表格里
.局部变量 插入一行, 整数型, , , 

赋值 (插入一行, .)
到文本 (插入一行).未知支持库函数_38 (插入一行)
插入一行.未知支持库函数_9 (1, #., .标题)
插入一行.未知支持库函数_9 (2, #., .内容)
插入一行.未知支持库函数_9 (3, #., .内容)
插入一行.未知支持库函数_9 (4, #., .内容)
插入一行.未知支持库函数_9 (5, #., .内容)
插入一行.未知支持库函数_9 (6, #., .内容)
插入一行.未知支持库函数_9 (7, #., 时间到文本 (.今天, ))
插入一行.未知支持库函数_9 (8, #., .内容)
插入一行.未知支持库函数_9 (9, #., .内容)
插入一行.未知支持库函数_9 (10, #., 时间到文本 (.今天, ))
插入一行.未知支持库函数_9 (11, #., .内容)


.子程序 员工ID编号, 空白型, , 
.局部变量 数据集合, 整数型, , , 
.局部变量 数据编号, 整数型, , , 

赋值 (数据集合, CNSQL查询SQL (“select  * from 员工表 ”))
CNSQL到尾记录 (数据集合)
赋值 (数据编号, CNSQL读数值 (数据集合, “员工ID”))
赋值 (.标题, 到文本 (相加 (到数值 (数据编号), 1)))
CNSQL关闭查询 (数据集合)


.子程序 _按钮2_被单击, 空白型, , 
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容)


.子程序 _按钮3_被单击, 空白型, , 
.局部变量 标尺, 文本型, , , 
.局部变量 行数, 整数型, , , 
.局部变量 列数, 整数型, , , 

_超级按钮1_被单击 ()




.子程序 _超级按钮1_被单击, 空白型, , 
.局部变量 行数, 整数型, , , 
.局部变量 标尺, 文本型, , , 
.局部变量 列数, 整数型, , , 
.局部变量 列项目库, 文本型, , , 
.局部变量 列表项, 文本型, , "0", 

.如果 (未知支持库函数_0 ())
    .未知支持库函数_6 ()
    赋值 (., 假)
    赋值 (., 真)
    未知支持库函数_4 ()
    赋值 (., 1)
    1.未知支持库函数_23 ()
    未知支持库函数_25 ()
    赋值 (., “宋体”)
    赋值 (., 15)
    赋值 (., 10)
    赋值 (., “G/通用格式”)
    赋值 (., “@”)
    赋值 (., #红色)
    赋值 (., 9)
    赋值 (., -4108)
    赋值 (., -4130)
    赋值 (., “a1”)
    赋值 (., “k1”)
    未知支持库函数_26 ()
    赋值 (., 28)
    赋值 (., “@”)
    赋值 (., “员工录入清单表”)
    赋值 (., -4108)
    赋值 (., 真)
    赋值 (., 18)
    赋值 (., “a3”)
    赋值 (., “g3”)
    未知支持库函数_26 ()
    赋值 (., 20)
    赋值 (., “单位：伊宁市飞机场路8号”)
    赋值 (., -4130)
    赋值 (标尺, “ABCDEFGHIJK”)
    赋值 (列项目库, “员工ID,员工编号,员工姓名,性别,民族,学历,生日,电话,住址,加盟时间,备注”)
    赋值 (列表项, 分割文本 (列项目库, “,”, ))
    .计次循环首 (11, 列数)
        赋值 (., 相加 (取文本中间 (标尺, 列数, 1), 到文本 (4)))
        赋值 (., 相加 (取文本中间 (标尺, 列数, 1), 到文本 (4)))
        赋值 (., 列表项 [列数])
        1.未知支持库函数_30 (2, 50)
    .计次循环尾 ()
    .计次循环首 (相减 (., 1), 行数)
        .计次循环首 (11, 列数)
            赋值 (., #蓝色)
            赋值 (., 相加 (取文本中间 (标尺, 列数, 1), 到文本 (相加 (行数, 4))))
            赋值 (., 相加 (取文本中间 (标尺, 列数, 1), 到文本 (相加 (行数, 4))))
            赋值 (., 10)
            赋值 (., 行数.未知支持库函数_10 (列数))
            1.未知支持库函数_30 (2, 210)
        .计次循环尾 ()
    .计次循环尾 ()
    
.否则
    信息框 (“你的计算机上没有EXCEL程序”, 0, )
    返回 ()
    未知支持库函数_1 ()
    
.如果结束






.子程序 _按钮5_被单击, 空白型, , 
.局部变量 计算机编号, 文本型, , , 



.如果 (大于或等于 (到数值 (.), 2))
    CNSQL开始事务 ()
    赋值 (计算机编号, 到文本 (到数值 (未知支持库函数_3 ()).未知支持库函数_10 (1)))
    .如果 (CNSQL执行命令 (相加 (“delete from 员工表 where 员工ID=”, 计算机编号), ))
        到数值 (未知支持库函数_3 ()).未知支持库函数_36 ()
        CNSQL提交事务 ()
    .否则
        CNSQL回滚事务 ()
    .如果结束
    
.否则
    信息框 (“没有可以删除的数据”, 0, )
    
.如果结束


.子程序 _修改按钮_被单击, 空白型, , 
.如果 (大于或等于 (到数值 (.), 2))
    
.否则
    信息框 (“没有要修改的内容”, 0, )
    
.如果结束


.子程序 _员工表格_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 员工录入记录句柄, 整数型, , 


.如果 (大于 (未知支持库函数_3 (), 0))
    赋值 (机器号, 到数值 (未知支持库函数_3 ()).未知支持库函数_10 (1))
     ' 信息框 (机器号, 0, )
    赋值 (员工录入记录句柄, CNSQL查询SQL (相加 (“select * from 员工表 where 员工ID= ”, 机器号)))
    载入 (员工修改窗口, , 真)
    CNSQL关闭查询 (员工录入记录句柄)
    
.否则
    返回 ()
    
.如果结束


.子程序 _按钮4_被单击, 空白型, , 
赋值 (., #白色)
“录入员工清单”.未知支持库函数_46 (“华文行楷”, 20, 真, 2)
未知支持库函数_27 ()
未知支持库函数_26 ()
赋值 (., #浅灰)



.窗口程序集 窗口程序集9, , , 

.子程序 _员工资料查询窗口_创建完毕, 空白型, , 
赋值 (.今天)

.子程序 _查询按钮_被单击, 空白型, , 
.局部变量 员工查询条件, 文本型, , "6", 
.局部变量 员工查询日期条件, 文本型, , "4", 
.局部变量 次数, 整数型, , , 
.局部变量 日期次数, 整数型, , , 
.局部变量 x1_句柄, 整数型, , , 
.局部变量 当前行数1, 整数型, , , 

全部删除 ()
.计次循环首 (6, 次数)
    赋值 (员工查询条件 [次数], 多项选择 (次数, .内容, .内容, .内容, .内容, .内容, .内容))
.计次循环尾 ()
.计次循环首 (4, 日期次数)
    赋值 (员工查询日期条件 [日期次数], 多项选择 (日期次数, 未知支持库函数_12 (.今天, “%y-%m-%d”), 未知支持库函数_12 (.今天, “%y-%m-%d”), 未知支持库函数_12 (.今天, “%y-%m-%d”), 未知支持库函数_12 (.今天, “%y-%m-%d”)))
.计次循环尾 ()
赋值 (x1_句柄, CNSQL查询SQL (相加 (“select * from 员工表 where 员工编号 like '%”, 员工查询条件 [1], “%'”, “ and”, “ 员工姓名 like '%”, 员工查询条件 [2], “%'”, “ and”, “ 性别 like '%”, 员工查询条件 [3], “%'”, “ and”, “ 民族 like '%”, 员工查询条件 [4], “%'”, “ and”, “ 学历 like '%”, 员工查询条件 [5], “%'”, “ and”, “ 电话 like '%”, 员工查询条件 [6], “%'”, “ and”, “ 生日 BETWEEN”, “#”, 员工查询日期条件 [1], “#”, “and”, “#”, 员工查询日期条件 [2], “#”, “and”, “ 加盟时间 BETWEEN”, “#”, 员工查询日期条件 [3], “#”, “and”, “#”, 员工查询日期条件 [4], “#”)))

CNSQL到首记录 (x1_句柄)
.判断循环首 (不等于 (CNSQL是否尾记录后 (x1_句柄), 真))
    赋值 (当前行数1, .插入表项 ())
    
    当前行数1.置标题 (0, 到文本 (CNSQL读文本 (x1_句柄, “员工编号”)))
    当前行数1.置标题 (1, 到文本 (CNSQL读文本 (x1_句柄, “员工姓名”)))
    当前行数1.置标题 (2, 到文本 (CNSQL读文本 (x1_句柄, “性别”)))
    当前行数1.置标题 (3, 到文本 (CNSQL读文本 (x1_句柄, “民族”)))
    当前行数1.置标题 (4, 到文本 (CNSQL读文本 (x1_句柄, “学历”)))
    当前行数1.置标题 (5, 到文本 (CNSQL读文本 (x1_句柄, “生日”)))
    当前行数1.置标题 (6, 到文本 (CNSQL读文本 (x1_句柄, “电话”)))
    当前行数1.置标题 (7, 到文本 (CNSQL读文本 (x1_句柄, “住址”)))
    当前行数1.置标题 (8, 到文本 (CNSQL读文本 (x1_句柄, “加盟时间”)))
    当前行数1.置标题 (9, 到文本 (CNSQL读文本 (x1_句柄, “备注”)))
    CNSQL到后一记录 (x1_句柄)
    
.判断循环尾 ()



.子程序 _按钮1_被单击, 空白型, , 
excel保存 (“员工查询表”)


.子程序 _清屏按钮_被单击, 空白型, , 
全部删除 ()


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 标示数据, 文本型, , , 
.局部变量 打印行, 整数型, , , 
.局部变量 打印列, 整数型, , , 
.局部变量 匿名局部变量_3050, 空白型, , , 




.如果真 (等于 (相加 (取运行目录 (), “\Normal\员工查询表.grd”).从文件读 (), 假))
    信息框 (“没有找到员工查询表，请你仔细检查，或者和系统管理员联系”, 相加 (#错误图标, #确认钮), “提示错误”)
    
.如果真结束
5.插入行 (取表项数 ())
.计次循环首 (取列数 (), 打印列)
    .计次循环首 (取表项数 (), 打印行)
        赋值 (标示数据, 相加 (打印行, 3).取文本 (打印列))
        4.置对齐方式 (1, 取表项数 (), 取列数 (), #中中)
        相加 (打印行, 4).置文本 (打印列, 标示数据)
        .判断开始 (等于 (标示数据, “<员工编号>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (0))
        .判断 (等于 (标示数据, “<员工姓名>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (1))
        .判断 (等于 (标示数据, “<性别>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (2))
        .判断 (等于 (标示数据, “<民族>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (3))
        .判断 (等于 (标示数据, “<学历>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (4))
        .判断 (等于 (标示数据, “<生日>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (5))
        .判断 (等于 (标示数据, “<电话>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (6))
        .判断 (等于 (标示数据, “<住址>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (7))
        .判断 (等于 (标示数据, “<加盟时间>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (8))
        .判断 (等于 (标示数据, “<备注>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (9))
        .默认
            
        .判断结束
        
    .计次循环尾 ()
.计次循环尾 ()

打印预览 ()


.窗口程序集 窗口程序集10, , , 

.程序集变量 员工窗口表格, 未知类型0x40001, , , 
.子程序 _员工修改窗口_创建完毕, 空白型, , 
.局部变量 表格数组, 文本型, , "11", 
.局部变量 次数, 整数型, , , 

赋值 (员工窗口表格, 员工资料录入窗口.)
.计次循环首 (11, 次数)
    赋值 (表格数组 [次数], 到文本 (员工窗口表格.未知支持库函数_10 (到数值 (员工窗口表格.未知支持库函数_3 ()), 次数)))
.计次循环尾 ()
赋值 (.内容, 表格数组 [2])
赋值 (.内容, 表格数组 [4])
赋值 (.内容, 表格数组 [3])
赋值 (.内容, 表格数组 [5])
赋值 (.内容, 表格数组 [6])
赋值 (.今天, 到时间 (表格数组 [7]))
赋值 (.今天, 到时间 (表格数组 [10]))
赋值 (.内容, 表格数组 [8])
赋值 (.内容, 表格数组 [9])
赋值 (.内容, 表格数组 [11])
赋值 (.内容, 表格数组 [1])


.子程序 _按钮1_被单击, 空白型, , 
CNSQL开始事务 ()
.如果 (等于 (CNSQL执行命令 (相加 (“update 员工表 set 员工编号='”, .内容, “',”, “员工姓名='”, .内容, “',”, “性别='”, .内容, “',”, “民族='”, .内容, “',”, “学历='”, .内容, “',”, “生日='”, 时间到文本 (.今天, ), “',”, “电话='”, .内容, “',”, “住址='”, .内容, “',”, “加盟时间='”, 时间到文本 (.今天, ), “',”, “备注='”, .内容, “'”, “ where 员工ID=”, 机器号), ), 真))
    
    CNSQL提交事务 ()
    信息框 (“修改成功”, 0, )
.否则
    CNSQL回滚事务 ()
    信息框 (“修改不成功”, 0, )
    
.如果结束
员工窗口表格.未知支持库函数_9 (到数值 (员工窗口表格.未知支持库函数_3 ()), 1, #., .内容)
员工窗口表格.未知支持库函数_9 (到数值 (员工窗口表格.未知支持库函数_3 ()), 2, #., .内容)
员工窗口表格.未知支持库函数_9 (到数值 (员工窗口表格.未知支持库函数_3 ()), 3, #., .内容)
员工窗口表格.未知支持库函数_9 (到数值 (员工窗口表格.未知支持库函数_3 ()), 4, #., .内容)
员工窗口表格.未知支持库函数_9 (到数值 (员工窗口表格.未知支持库函数_3 ()), 5, #., .内容)
员工窗口表格.未知支持库函数_9 (到数值 (员工窗口表格.未知支持库函数_3 ()), 6, #., .内容)
员工窗口表格.未知支持库函数_9 (到数值 (员工窗口表格.未知支持库函数_3 ()), 7, #., 时间到文本 (.今天, ))
员工窗口表格.未知支持库函数_9 (到数值 (员工窗口表格.未知支持库函数_3 ()), 8, #., .内容)
员工窗口表格.未知支持库函数_9 (到数值 (员工窗口表格.未知支持库函数_3 ()), 9, #., .内容)
员工窗口表格.未知支持库函数_9 (到数值 (员工窗口表格.未知支持库函数_3 ()), 10, #., .内容)
员工窗口表格.未知支持库函数_9 (到数值 (员工窗口表格.未知支持库函数_3 ()), 11, #., 时间到文本 (.今天, ))
员工窗口表格.未知支持库函数_9 (到数值 (员工窗口表格.未知支持库函数_3 ()), 13, #., .内容)
销毁 ()


.窗口程序集 窗口程序集11, , , 

.子程序 _商品进货窗口_创建完毕, 空白型, , 
商品进货表格初始化 ()
初始表数据 ()


.子程序 初始表数据, 空白型, , 
.局部变量 商品_句柄, 整数型, , , 
.局部变量 插入行, 整数型, , , 

赋值 (商品_句柄, CNSQL查询SQL (“select 商品编号,商品名称,单价,存货 from 商品表”))
CNSQL到首记录 (商品_句柄)
.判断循环首 (不等于 (CNSQL是否尾记录后 (商品_句柄), 真))
    赋值 (插入行, 相加 (插入行, 1))
    到文本 (插入行).未知支持库函数_38 (插入行)
    插入行.未知支持库函数_9 (1, #., CNSQL读文本 (商品_句柄, “商品编号”))
    插入行.未知支持库函数_9 (2, #., CNSQL读文本 (商品_句柄, “商品名称”))
    插入行.未知支持库函数_9 (3, #., CNSQL读文本 (商品_句柄, “存货”))
    插入行.未知支持库函数_9 (4, #., 到文本 (四舍五入 (到数值 (CNSQL读文本 (商品_句柄, “单价”)), 2)))
    CNSQL到后一记录 (商品_句柄)
.判断循环尾 ()


CNSQL关闭查询 (商品_句柄)


.子程序 商品进货表格初始化, 空白型, , 
1.未知支持库函数_62 (1, ., .)
0.未知支持库函数_9 (0, #., “序号”)
0.未知支持库函数_9 (1, #., “商品编号”)
0.未知支持库函数_9 (2, #., “商品名称”)
0.未知支持库函数_9 (3, #., “商品数量”)
0.未知支持库函数_9 (4, #., “单价”)
0.未知支持库函数_32 (35)
1.未知支持库函数_32 (60)
2.未知支持库函数_32 (80)
3.未知支持库函数_32 (80)
4.未知支持库函数_32 (80)
0.未知支持库函数_25 (0, 0, ., #.)


.子程序 _按钮1_被单击, 空白型, , 
excel导出 (“wo debiaoge”, “ddddddd”)

.子程序 _确定按钮_被单击, 空白型, , 
.局部变量 行, 整数型, , , 
.局部变量 总行数, 整数型, , , 
.局部变量 打印列, 整数型, , , 
.局部变量 打印行, 整数型, , , 
.局部变量 文本数据, 文本型, , , 

赋值 (总行数, 相减 (., 1))
CNSQL开始事务 ()
.如果 (等于 (CNSQL执行命令 (相加 (“update 商品表 set 存货='”, 到文本 (相加 (到数值 (.内容), 到数值 (.标题))), “',”, “单价='”, .内容, “'”, “where 商品编号=”, .内容), ), 真))
    CNSQL提交事务 ()
    信息框 (“数据保存成功”, 相加 (0, #信息图标), “保存成功”)
    
.否则
    CNSQL回滚事务 ()
    信息框 (“数据无法保存，请你检查数据库是否存在”, 相加 (0, #警告图标), “失败”)
    
.如果结束
.计次循环首 (总行数, 行)
    1.未知支持库函数_36 ()
    赋值 (行, 相加 (行, 1))
.计次循环尾 ()
初始表数据 ()

相加 (取运行目录 (), “\Normal\商品进货单.grd”).从文件读 ()
.计次循环首 (取列数 (), 打印列)
    .计次循环首 (取行数 (), 打印行)
        赋值 (文本数据, 打印行.取文本 (打印列))
        .判断开始 (等于 (文本数据, “<商品名称>”))
            打印行.置文本 (打印列, .标题)
        .判断 (等于 (文本数据, “<商品编号>”))
            打印行.置文本 (打印列, .内容)
        .判断 (等于 (文本数据, “<库存>”))
            打印行.置文本 (打印列, .标题)
        .判断 (等于 (文本数据, “<本次进货>”))
            打印行.置文本 (打印列, .内容)
        .判断 (等于 (文本数据, “<合计>”))
            打印行.置文本 (打印列, 到文本 (相加 (到数值 (.内容), 到数值 (.标题))))
        .判断 (等于 (文本数据, “<单价>”))
            打印行.置文本 (打印列, .内容)
        .判断 (等于 (文本数据, “<日期>”))
            打印行.置文本 (打印列, 时间到文本 (取日期 (取现行时间 ()), ))
        .默认
            
        .判断结束
        
    .计次循环尾 ()
.计次循环尾 ()
.打印 ()

连续赋值 (“”, .内容, .内容, .内容, .标题, .标题)


.子程序 _取消按钮_被单击, 空白型, , 
商品进货窗口.销毁 ()

.子程序 _标签3_反馈事件, 整数型, , 
.参数 参数一, 整数型, , 
.参数 参数二, 整数型, , 



.子程序 _编辑框1_失去焦点, 空白型, , 
.局部变量 商品查询_句柄, 整数型, , , 

赋值 (商品查询_句柄, CNSQL查询SQL (相加 (“select * from 商品表 where 商品编号=”, .内容)))
赋值 (.标题, 到文本 (CNSQL读文本 (商品查询_句柄, “商品名称”)))
赋值 (.标题, 到文本 (CNSQL读文本 (商品查询_句柄, “存货”)))
CNSQL关闭查询 (商品查询_句柄)


.子程序 _编辑框1_内容被改变, 空白型, , 


.窗口程序集 窗口程序集12, , , 

.子程序 _会员购买商品录入窗口_创建完毕, 空白型, , 
会员购买商品表格初始化 ()





.子程序 会员购买商品表格初始化, 空白型, , 
1.未知支持库函数_62 (1, ., .)
0.未知支持库函数_9 (0, #., “序号”)
0.未知支持库函数_9 (1, #., “会员编号”)
0.未知支持库函数_9 (2, #., “商品编号”)
0.未知支持库函数_9 (3, #., “员工编号”)
0.未知支持库函数_9 (4, #., “日期”)
0.未知支持库函数_9 (5, #., “商品名称”)
0.未知支持库函数_9 (6, #., “数量”)
0.未知支持库函数_9 (7, #., “金额”)
0.未知支持库函数_32 (30)
1.未知支持库函数_32 (70)
2.未知支持库函数_32 (70)
3.未知支持库函数_32 (70)
4.未知支持库函数_32 (80)
5.未知支持库函数_32 (120)
6.未知支持库函数_32 (80)
7.未知支持库函数_32 (80)
0.未知支持库函数_25 (0, ., ., #.)


.子程序 _保存按钮_被单击, 空白型, , 
.局部变量 商品数量, 整数型, , , 

.如果 (并且 (不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”)))
    .判断开始 (大于或等于 (到数值 (.标题), 到数值 (.标题)))
        赋值 (.标题, 到文本 (相减 (到数值 (.标题), 到数值 (.标题))))
    .判断 (小于 (到数值 (.标题), 到数值 (.标题)))
        赋值 (.标题, 到文本 (相减 (相加 (到数值 (.标题), 到数值 (.标题)), 到数值 (.标题))))
        
        赋值 (.标题, “”)
    .默认
        
    .判断结束
    赋值 (商品数量, 查询商品数量 ())
    .如果 (大于或等于 (商品数量, 0))
        CNSQL开始事务 ()
        .如果 (等于 (CNSQL执行命令 (相加 (“insert into 交易表 (会员编号,商品编号,员工编号,日期,数量,金额) values ( ”, .内容, “,”, .内容, “,”, .内容, “,'”, 时间到文本 (.今天, ), “',”, .内容, “,'”, .标题, “ ')”), ), 真))
            CNSQL提交事务 ()
            信息框 (“数据保存成功”, 0, )
            会员购买表格输入 ()
            连续赋值 (“”, .内容, .内容, .标题, .标题, .标题, .标题)
        .否则
            CNSQL回滚事务 ()
            信息框 (“数据保存失败，请检查”, 0, )
        .如果结束
        
    .否则
        信息框 (到文本 (商品数量), 0, )
        
    .如果结束
    
.否则
    信息框 (“数据填写不全，请仔细核对”, 0, )
.如果结束


.子程序 会员购买表格输入, 空白型, , 
.局部变量 增加一行, 整数型, , , 

赋值 (增加一行, .)
到文本 (增加一行).未知支持库函数_38 (增加一行)
增加一行.未知支持库函数_9 (0, #., 增加一行)
增加一行.未知支持库函数_9 (1, #., .内容)
增加一行.未知支持库函数_9 (2, #., .内容)
增加一行.未知支持库函数_9 (3, #., .内容)
增加一行.未知支持库函数_9 (4, #., 时间到文本 (.今天, ))
增加一行.未知支持库函数_9 (5, #., .标题)

增加一行.未知支持库函数_9 (6, #., .内容)
增加一行.未知支持库函数_9 (7, #., .标题)



.子程序 _按钮1_被单击, 空白型, , 
excel导出 (“会员购买商品表格”, “中华联合财产保险公司”)


.子程序 _按钮4_被单击, 空白型, , 
.局部变量 交易表数据库句柄, 整数型, , , 
.局部变量 交易表, 整数型, , , 

赋值 (交易表数据库句柄, CNSQL查询SQL (相加 (“select * from 会员表 where 会员编号=”, .内容)))
赋值 (.标题, CNSQL读文本 (交易表数据库句柄, “会员姓名”))
赋值 (.标题, 到文本 (CNSQL读文本 (交易表数据库句柄, “结余”)))
赋值 (.标题, 到文本 (CNSQL读文本 (交易表数据库句柄, “欠款”)))
赋值 (.标题, 到文本 (CNSQL读文本 (交易表数据库句柄, “点数”)))
赋值 (.标题, CNSQL读文本 (交易表数据库句柄, “级别”))
CNSQL关闭查询 (交易表数据库句柄)

.子程序 _按钮2_被单击, 空白型, , 
赋值 (.内容, .内容)


.子程序 _商品编号编辑框_失去焦点, 空白型, , 
.局部变量 商品表句柄, 整数型, , , 

赋值 (商品表句柄, CNSQL查询SQL (相加 (“select * from 商品表 where 商品编号=”, .内容)))
.如果 (不等于 (商品表句柄, 0))
    赋值 (.标题, CNSQL读文本 (商品表句柄, “商品名称”))
    赋值 (.标题, 到文本 (四舍五入 (到数值 (CNSQL读文本 (商品表句柄, “单价”)), 2)))
    赋值 (.调节器上限值, 到数值 (CNSQL读文本 (商品表句柄, “存货”)))
.否则
    信息框 (“数据查询失败”, 0, )
    返回 ()
.如果结束

CNSQL关闭查询 (商品表句柄)

.子程序 _员工编号编辑框_失去焦点, 空白型, , 
.局部变量 员工_句柄, 整数型, , , 

赋值 (员工_句柄, CNSQL查询SQL (相加 (“select * from 员工表 where 员工编号=”, .内容)))
.如果 (不等于 (员工_句柄, 0))
    赋值 (.标题, CNSQL读文本 (员工_句柄, “员工姓名”))
    
.否则
    信息框 (“数据查询失败，请核对再次输入”, 0, )
    返回 ()
    
.如果结束
CNSQL关闭查询 (员工_句柄)


.子程序 _购买数量编辑框_失去焦点, 空白型, , 
赋值 (.标题, 到文本 (四舍五入 (相乘 (到数值 (.标题), 到数值 (.内容), 相减 (1, 相除 (到数值 (.标题), 10))), 2)))
赋值 (.标题, 到文本 (四舍五入 (相减 (相乘 (到数值 (.标题), 到数值 (.内容)), 到数值 (.标题)), 2)))
.如果真 (大于 (到数值 (.内容), 到数值 (.调节器上限值)))
    信息框 (相加 (“你输入的商品数量过大现在商品共计数量：”, 到文本 (.调节器上限值)), 0, )
    获取焦点 ()
    
.如果真结束


.子程序 _结算按钮_被单击, 空白型, , 
.局部变量 次数, 整数型, , , 
.局部变量 金额合计, 小数型, , , 

相加 (取运行目录 (), “\Normal\会员结算单.grd”).从文件读 ()
.计次循环首 (., 次数)
    1.添加行 ()
    相加 (3, 次数).置文本 (1, 到文本 (次数.未知支持库函数_10 (2)))
    相加 (3, 次数).置文本 (2, 到文本 (次数.未知支持库函数_10 (5)))
    相加 (3, 次数).置文本 (3, 到文本 (次数.未知支持库函数_10 (6)))
    相加 (3, 次数).置文本 (4, 到文本 (次数.未知支持库函数_10 (7)))
    赋值 (金额合计, 相加 (金额合计, 到数值 (次数.未知支持库函数_10 (7))))
.计次循环尾 ()
4.加线条 (1, 相减 (取行数 (), 3), 取列数 (), 相加 (#左边框, #右边框, #上边框, #下边框, #水平线, #垂直线))
4.置字体尺寸 (1, 相减 (取行数 (), 3), 取列数 (), 35)
2.置文本 (2, .标题)
2.置文本 (4, 时间到文本 (.今天, #日期部分))
取行数 ().置文本 (1, “合计”)
取行数 ().置文本 (4, 到文本 (金额合计))
取行数 ().置文本 (2, “******”)
取行数 ().置文本 (3, “******”)
假.打印 ()



.子程序 查询商品数量, 整数型, , 
.局部变量 交易表_句柄, 整数型, , , 
.局部变量 出库商品数量, 整数型, , , 
.局部变量 出库商品, 整数型, , , 
.局部变量 商品表_句柄, 整数型, , , 
.局部变量 商品数量, 整数型, , , 
.局部变量 合计商品数量, 整数型, , , 

赋值 (交易表_句柄, CNSQL查询SQL (相加 (“select * from 交易表 where 商品编号=”, .内容)))
CNSQL到首记录 (交易表_句柄)
.判断循环首 (等于 (CNSQL是否尾记录后 (交易表_句柄), 假))
    赋值 (出库商品, 到数值 (CNSQL读文本 (交易表_句柄, “数量”)))
    赋值 (出库商品数量, 相加 (出库商品数量, 出库商品))
    CNSQL到后一记录 (交易表_句柄)
.判断循环尾 ()
CNSQL关闭查询 (交易表_句柄)
赋值 (商品表_句柄, CNSQL查询SQL (相加 (“select * from 商品表 where 商品编号=”, .内容)))
CNSQL到首记录 (商品表_句柄)
赋值 (商品数量, 到数值 (CNSQL读文本 (商品表_句柄, “存货”)))
CNSQL关闭查询 (商品表_句柄)
赋值 (合计商品数量, 相减 (商品数量, 出库商品数量, 到数值 (.内容)))
返回 (合计商品数量)



.窗口程序集 窗口程序集13, , , 

.子程序 _会员资金充值窗口_创建完毕, 空白型, , 
会员资金充值表格初始化 ()


.子程序 会员资金充值表格初始化, 空白型, , //对表格进行初始化
1.未知支持库函数_62 (1, ., .)
0.未知支持库函数_9 (0, #., “序号”)
0.未知支持库函数_9 (1, #., “会员编号”)
0.未知支持库函数_9 (2, #., “会员姓名”)
0.未知支持库函数_9 (3, #., “上次欠款”)
0.未知支持库函数_9 (4, #., “充值金额”)
0.未知支持库函数_9 (5, #., “结余金额”)
0.未知支持库函数_32 (35)
1.未知支持库函数_32 (60)
2.未知支持库函数_32 (80)
3.未知支持库函数_32 (80)
4.未知支持库函数_32 (80)
5.未知支持库函数_32 (80)
0.未知支持库函数_25 (0, 0, ., #.)


.子程序 _取消按钮_被单击, 空白型, , 
会员资金充值窗口.销毁 ()


.子程序 _确定按钮_被单击, 空白型, , 
.局部变量 插入一行, 整数型, , , 

赋值 (插入一行, 到数值 (.))
到文本 (.).未知支持库函数_38 (插入一行)
插入一行.未知支持库函数_9 (1, #., .内容)
插入一行.未知支持库函数_9 (2, #., .标题)
插入一行.未知支持库函数_9 (3, #., 到文本 (相减 (到数值 (.标题), 到数值 (.内容))))
插入一行.未知支持库函数_9 (4, #., .内容)
插入一行.未知支持库函数_9 (5, #., .标题)
.如果 (大于或等于 (到数值 (.标题), 0))
    CNSQL开始事务 ()
    .如果 (等于 (CNSQL执行命令 (相加 (“update 会员表 set 结余='”, .标题, “',”, “欠款='”, 到文本 (0), “'”, “where 会员编号=”, .内容), ), 真))
        CNSQL提交事务 ()
        信息框 (“充值成功，谢谢合作”, 0, )
        
    .否则
        信息框 (“出问题了，请检查，谢谢”, 0, )
        CNSQL回滚事务 ()
        
    .如果结束
    
.否则
    .如果真 (小于 (到数值 (.标题), 0))
        CNSQL开始事务 ()
        .如果 (等于 (CNSQL执行命令 (相加 (“update 会员表 set 欠款='”, .标题, “'”, “where 会员编号=”, .内容), ), 真))
            CNSQL提交事务 ()
            信息框 (相加 (“充值成功，谢谢合作，你现在还欠：”, .标题, “元钱，请你尽快充值”), 相加 (#确认钮, #警告图标), “还欠着呢！”)
            
        .否则
            信息框 (“出问题了，请检查”, 0, )
            CNSQL回滚事务 ()
        .如果结束
        
    .如果真结束
    
.如果结束

连续赋值 (“”, .内容, .内容, .标题, .标题, .标题)

.子程序 _打印按钮_被单击, 空白型, , 
.局部变量 次数1, 整数型, , , 
.局部变量 表格位置, 整数型, , , 
.局部变量 页数, 整数型, , , 
.局部变量 当前页, 整数型, , , 
.局部变量 打印设置, 打印设置信息, , , 
.局部变量 列数, 整数型, , , 
.局部变量 次数, 整数型, , , 
.局部变量 行数, 整数型, , , 

相加 (取运行目录 (), “\Normal\充值回单.grd”).从文件读 ()
 ' 设置打印时每页打印行数
赋值 (打印设置, 取打印设置 ())
赋值 (打印设置.每页打印行数, 取行数 ())
赋值 (打印设置.左边距, 100)
赋值 (打印设置.右边距, 100)
赋值 (打印设置.上边距, 100)
赋值 (打印设置.下边距, 100)
打印设置.置打印设置 ()
 ' 下面的代码是将表格模版列宽表格位置拷贝到数据源容器
赋值 (列数, 3)
0.初始尺寸 (列数)
.计次循环首 (列数, 次数)
    次数.置列宽 (1, 次数.取列宽 ())
.计次循环尾 ()
.如果 (等于 (整除 (., 4), 0))
    赋值 (页数, 相除 (., 4))
.否则
    赋值 (页数, 相加 (取整 (相除 (., 4)), 1))
.如果结束

.计次循环首 (页数, 当前页)
    .计次循环首 (4, 次数1)
        赋值 (表格位置, 相减 (次数1, 1))
        赋值 (行数, 相加 (次数1, 相乘 (相减 (当前页, 1), 4)))
        相加 (2, 相乘 (9, 表格位置)).置文本 (2, 到文本 (行数.未知支持库函数_10 (1)))
        相加 (3, 相乘 (9, 表格位置)).置文本 (2, 到文本 (行数.未知支持库函数_10 (2)))
        相加 (4, 相乘 (9, 表格位置)).置文本 (2, 到文本 (行数.未知支持库函数_10 (4)))
        相加 (5, 相乘 (9, 表格位置)).置文本 (2, 到文本 (行数.未知支持库函数_10 (3)))
        相加 (6, 相乘 (9, 表格位置)).置文本 (2, 到文本 (行数.未知支持库函数_10 (5)))
    .计次循环尾 ()
    .添加 ()
.计次循环尾 ()
打印预览 ()





.子程序 _查询按钮_被单击, 空白型, , 
.局部变量 资金充值_句柄, 整数型, , , 

赋值 (资金充值_句柄, CNSQL查询SQL (相加 (“select * from 会员表 where 会员编号=”, .内容)))
.如果 (不等于 (资金充值_句柄, 0))
    赋值 (.标题, CNSQL读文本 (资金充值_句柄, “会员姓名”))
    .如果 (不等于 (CNSQL读数值 (资金充值_句柄, “结余”), 0))
        赋值 (.标题, 到文本 (CNSQL读文本 (资金充值_句柄, “结余”)))
    .否则
        .如果 (不等于 (CNSQL读数值 (资金充值_句柄, “欠款”), 0))
            赋值 (.标题, 相加 (“-”, 到文本 (CNSQL读文本 (资金充值_句柄, “欠款”))))
        .否则
            信息框 (“查询不到数据，请检查”, 0, )
        .如果结束
        
    .如果结束
    
.否则
    信息框 (“查询不到数据，请检查”, 0, )
    
.如果结束


.子程序 _编辑框2_失去焦点, 空白型, , 
赋值 (.标题, 到文本 (相加 (到数值 (.内容), 到数值 (.标题))))


.窗口程序集 窗口程序集14, , , 

.子程序 _修改密码窗口_创建完毕, 空白型, , 


.窗口程序集 窗口程序集15, , , 

.子程序 _商品资料查询窗口_创建完毕, 空白型, , 


.子程序 _按钮3_被单击, 空白型, , 
excel保存 (“商品销售查询表”)


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 sp_句柄, 整数型, , , 
.局部变量 sy_句柄, 整数型, , , 
.局部变量 插入一行, 整数型, , , 

全部删除 ()
赋值 (sy_句柄, CNSQL查询SQL (相加 (“select * from 商品表 where  商品编号 like'%”, .内容, “%'”, “ and”, “ 商品名称 like'%”, .内容, “%'”, “ and”, “ 产地 like'%”, .内容, “%'”, “ and”, “ 单价>=”, .内容, “ and”, “ 单价<=”, .内容)))
CNSQL到首记录 (sy_句柄)
.判断循环首 (等于 (CNSQL是否尾记录后 (sy_句柄), 假))
    赋值 (插入一行, .插入表项 ())
    插入一行.置标题 (0, 到文本 (CNSQL读文本 (sy_句柄, “商品编号”)))
    插入一行.置标题 (1, 到文本 (CNSQL读文本 (sy_句柄, “商品名称”)))
    插入一行.置标题 (2, 到文本 (CNSQL读文本 (sy_句柄, “商品类型”)))
    插入一行.置标题 (3, 到文本 (CNSQL读文本 (sy_句柄, “单价”)))
    赋值 (sp_句柄, CNSQL查询SQL (相加 (“select sum(数量) as 数量合计 from 交易表 where 商品编号=”, 插入一行.取标题 (0))))
    
    插入一行.置标题 (4, 到文本 (相减 (CNSQL读数值 (sy_句柄, “存货”), CNSQL读数值 (sp_句柄, “数量合计”))))
    插入一行.置标题 (5, 到文本 (CNSQL读文本 (sy_句柄, “单位”)))
    插入一行.置标题 (6, 到文本 (CNSQL读文本 (sy_句柄, “产地”)))
    插入一行.置标题 (7, 到文本 (CNSQL读文本 (sy_句柄, “用途”)))
    插入一行.置标题 (8, 到文本 (CNSQL读文本 (sy_句柄, “存货”)))
    
    CNSQL关闭查询 (sp_句柄)
    CNSQL到后一记录 (sy_句柄)
.判断循环尾 ()




.子程序 _按钮2_被单击, 空白型, , 
全部删除 ()


.子程序 _按钮4_被单击, 空白型, , 
.局部变量 打印行数, 整数型, , , 
.局部变量 打印列数, 整数型, , , 
.局部变量 打印文本, 文本型, , , 

.如果真 (等于 (相加 (取运行目录 (), “\Normal\商品资料查询表.grd”).从文件读 (), 假))
    信息框 (“没有找到商品资料查询表，请你仔细检查,或者和系统管理员联系”, 相加 (#错误图标, #确认钮), “提示信息”)
    
.如果真结束
5.插入行 (取表项数 ())
.计次循环首 (取列数 (), 打印列数)
    .计次循环首 (取表项数 (), 打印行数)
        赋值 (打印文本, 相加 (打印行数, 3).取文本 (打印列数))
        4.置对齐方式 (1, 取表项数 (), 取列数 (), #中中)
        相加 (打印行数, 4).置文本 (打印列数, 打印文本)
        .判断开始 (等于 (打印文本, “<商品编号>”))
            相加 (打印行数, 3).置文本 (打印列数, 相减 (打印行数, 1).取标题 (0))
        .判断 (等于 (打印文本, “<商品名称>”))
            相加 (打印行数, 3).置文本 (打印列数, 相减 (打印行数, 1).取标题 (1))
            
        .判断 (等于 (打印文本, “<商品类型>”))
            相加 (打印行数, 3).置文本 (打印列数, 相减 (打印行数, 1).取标题 (2))
            
        .判断 (等于 (打印文本, “<单价>”))
            相加 (打印行数, 3).置文本 (打印列数, 相减 (打印行数, 1).取标题 (3))
            
        .判断 (等于 (打印文本, “<存货>”))
            相加 (打印行数, 3).置文本 (打印列数, 相减 (打印行数, 1).取标题 (4))
            
        .判断 (等于 (打印文本, “<单位>”))
            相加 (打印行数, 3).置文本 (打印列数, 相减 (打印行数, 1).取标题 (5))
            
        .判断 (等于 (打印文本, “<地产>”))
            相加 (打印行数, 3).置文本 (打印列数, 相减 (打印行数, 1).取标题 (6))
            
        .判断 (等于 (打印文本, “<用途>”))
            相加 (打印行数, 3).置文本 (打印列数, 相减 (打印行数, 1).取标题 (7))
            
        .判断 (等于 (打印文本, “<期初数量>”))
            相加 (打印行数, 3).置文本 (打印列数, 相减 (打印行数, 1).取标题 (8))
            
        .默认
            
        .判断结束
        
    .计次循环尾 ()
.计次循环尾 ()
打印预览 ()

.窗口程序集 窗口程序集16, , , 

.子程序 _会员消费金额查询窗口_创建完毕, 空白型, , 


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 s1_句柄, 整数型, , , 
.局部变量 当前行数, 整数型, , , 

全部删除 ()
赋值 (s1_句柄, CNSQL查询SQL (相加 (“select 会员编号,sum(金额) as 合计金额 from 交易表 where 会员编号 like'%”, .内容, “%'”, “ group by 会员编号 ”)))
CNSQL到首记录 (s1_句柄)
.判断循环首 (不等于 (CNSQL是否尾记录后 (s1_句柄), 真))
    赋值 (当前行数, .插入表项 ())
    当前行数.置标题 (0, 到文本 (到数值 (CNSQL读文本 (s1_句柄, “会员编号”))))
    当前行数.置标题 (1, 到文本 (四舍五入 (到数值 (CNSQL读文本 (s1_句柄, “合计金额”)), 2)))
    CNSQL到后一记录 (s1_句柄)
.判断循环尾 ()
CNSQL关闭查询 (s1_句柄)


.子程序 _按钮2_被单击, 空白型, , 
全部删除 ()
全部删除 ()


.子程序 _按钮3_被单击, 空白型, , 

excel保存 (“会员消费明细清单”)


.子程序 _超级列表框1_左键单击表项, 空白型, , 
.局部变量 s2_句柄, 整数型, , , 
.局部变量 当前行数, 整数型, , , 


全部删除 ()
赋值 (s2_句柄, CNSQL查询SQL (相加 (“select *  from 交易表,商品表 where 交易表.商品编号=商品表.商品编号 and 交易表.会员编号 like'%”, 到文本 (.取标题 (., 0)), “%'”)))
CNSQL到首记录 (s2_句柄)
.判断循环首 (不等于 (CNSQL是否尾记录后 (s2_句柄), 真))
    赋值 (当前行数, .插入表项 ())
    当前行数.置标题 (0, 到文本 (到数值 (CNSQL读文本 (s2_句柄, “商品编号”))))
    当前行数.置标题 (1, 到文本 (到数值 (CNSQL读文本 (s2_句柄, “商品名称”))))
    当前行数.置标题 (2, 到文本 (到数值 (CNSQL读文本 (s2_句柄, “单价”))))
    当前行数.置标题 (3, 到文本 (到数值 (CNSQL读文本 (s2_句柄, “单位”))))
    当前行数.置标题 (4, 到文本 (到数值 (CNSQL读文本 (s2_句柄, “数量”))))
    当前行数.置标题 (5, 到文本 (到数值 (CNSQL读文本 (s2_句柄, “金额”))))
    当前行数.置标题 (6, 到文本 (取日期 (CNSQL读日期 (s2_句柄, “日期”))))
    CNSQL到后一记录 (s2_句柄)
.判断循环尾 ()
.插入表项 ()
CNSQL关闭查询 (s2_句柄)


.子程序 _按钮4_被单击, 空白型, , 
.局部变量 文本数据, 文本型, , , 
.局部变量 打印列, 整数型, , , 
.局部变量 打印行, 整数型, , , 
.局部变量 标示数据, 文本型, , , 

.如果真 (等于 (相加 (取运行目录 (), “\Normal\会员消费清单.grd”).从文件读 (), 假))
    信息框 (“没有找到会员消费清单，请你仔细检查，或者和系统管理员联系”, 相加 (#错误图标, #确认钮), “提示错误”)
    
.如果真结束
5.插入行 (取表项数 ())
2.置文本 (2, .取标题 (., 0))

.计次循环首 (取列数 (), 打印列)
    .计次循环首 (取表项数 (), 打印行)
        赋值 (标示数据, 相加 (打印行, 3).取文本 (打印列))
        4.置对齐方式 (1, 取表项数 (), 取列数 (), #中中)
        相加 (打印行, 4).置文本 (打印列, 标示数据)
        .判断开始 (等于 (标示数据, “<商品编号>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (0))
        .判断 (等于 (标示数据, “<商品名称>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (1))
        .判断 (等于 (标示数据, “<单价>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (2))
        .判断 (等于 (标示数据, “<单位>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (3))
        .判断 (等于 (标示数据, “<购买数量>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (4))
        .判断 (等于 (标示数据, “<交易金额>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (5))
        .判断 (等于 (标示数据, “<消费日期>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (6))
        .默认
            
        .判断结束
        
    .计次循环尾 ()
.计次循环尾 ()

打印预览 ()




.窗口程序集 窗口程序集17, , , 

.子程序 _会员资料查询窗口_创建完毕, 空白型, , 


.子程序 _查询按钮_被单击, 空白型, , 
.局部变量 查询条件数组, 文本型, , "7", 
.局部变量 会员查询_句柄, 整数型, , , 
.局部变量 次数3, 整数型, , , 
.局部变量 查询日期数组, 日期时间型, , "4", 
.局部变量 次数4, 整数型, , , 
.局部变量 次数5, 整数型, , , 
.局部变量 当前行数, 整数型, , , 

全部删除 ()
.计次循环首 (7, 次数3)
    赋值 (查询条件数组 [次数3], 多项选择 (次数3, .内容, .内容, .内容, .内容, .内容, .内容, .内容))
.计次循环尾 ()
.计次循环首 (4, 次数4)
    赋值 (查询日期数组 [次数4], 多项选择 (次数4, .今天, .今天, .今天, .今天))
.计次循环尾 ()
赋值 (会员查询_句柄, CNSQL查询SQL (相加 (“select * from 会员表 where 会员编号 like'%”, 查询条件数组 [1], “%'”, “and”, “ 会员姓名 like'%”, 查询条件数组 [2], “%'”, “and”, “ 性别 like'%”, 查询条件数组 [3], “%'”, “and”, “ 职业 like'%”, 查询条件数组 [4], “%'”, “and”, “ 学历 like'%”, 查询条件数组 [5], “%'”, “and”, “ 电话 like'%”, 查询条件数组 [6], “%'”, “and”, “ 民族 like'%”, 查询条件数组 [7], “%'”)))
CNSQL到首记录 (会员查询_句柄)
.判断循环首 (不等于 (CNSQL是否尾记录后 (会员查询_句柄), 真))
    
    赋值 (当前行数, .插入表项 ())
    当前行数.置标题 (0, 到文本 (相加 (当前行数, 1)))
    当前行数.置标题 (1, 到文本 (CNSQL读文本 (会员查询_句柄, “会员编号”)))
    当前行数.置标题 (2, 到文本 (CNSQL读文本 (会员查询_句柄, “会员姓名”)))
    当前行数.置标题 (3, 到文本 (CNSQL读文本 (会员查询_句柄, “性别”)))
    当前行数.置标题 (4, 到文本 (CNSQL读文本 (会员查询_句柄, “民族”)))
    当前行数.置标题 (5, 到文本 (CNSQL读文本 (会员查询_句柄, “学历”)))
    当前行数.置标题 (6, 到文本 (CNSQL读文本 (会员查询_句柄, “生日”)))
    当前行数.置标题 (7, 到文本 (CNSQL读文本 (会员查询_句柄, “电话”)))
    当前行数.置标题 (8, 到文本 (CNSQL读文本 (会员查询_句柄, “地址”)))
    当前行数.置标题 (9, 到文本 (CNSQL读文本 (会员查询_句柄, “入会时间”)))
    当前行数.置标题 (10, 到文本 (CNSQL读文本 (会员查询_句柄, “职业”)))
    当前行数.置标题 (11, 到文本 (CNSQL读文本 (会员查询_句柄, “结余”)))
    当前行数.置标题 (12, 到文本 (CNSQL读文本 (会员查询_句柄, “欠款”)))
    当前行数.置标题 (13, 到文本 (CNSQL读文本 (会员查询_句柄, “点数”)))
    当前行数.置标题 (14, 到文本 (CNSQL读文本 (会员查询_句柄, “级别”)))
    当前行数.置标题 (15, 到文本 (CNSQL读文本 (会员查询_句柄, “备注”)))
    CNSQL到后一记录 (会员查询_句柄)
.判断循环尾 ()






.子程序 _EXCEL导出按钮_被单击, 空白型, , 
.局部变量 匿名局部变量_2683, 空白型, , , 

excel保存 (“会员资料查询表”) ' 模块应用


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 文本数据, 文本型, , , 
.局部变量 打印列, 整数型, , , 
.局部变量 打印行, 整数型, , , 
.局部变量 标示数据, 文本型, , , 



.如果真 (等于 (相加 (取运行目录 (), “\Normal\会员资料查询表.grd”).从文件读 (), 假))
    信息框 (“没有找到会员资料查询表，请你仔细检查”, 相加 (#错误图标, #确认钮), “提示”)
.如果真结束
5.插入行 (取表项数 ())


.计次循环首 (取列数 (), 打印列)
    .计次循环首 (取表项数 (), 打印行)
        赋值 (标示数据, 相加 (打印行, 3).取文本 (打印列))
        相加 (打印行, 4).置文本 (打印列, 标示数据)
        赋值 (文本数据, 相加 (打印行, 3).取文本 (打印列))
        .判断开始 (等于 (文本数据, “<会员编号>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (1))
        .判断 (等于 (文本数据, “<会员姓名>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (2))
        .判断 (等于 (文本数据, “<性别>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (3))
        .判断 (等于 (文本数据, “<学历>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (5))
        .判断 (等于 (文本数据, “<电话>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (7))
        .判断 (等于 (文本数据, “<地址>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (8))
        .判断 (等于 (文本数据, “<结余>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (11))
        .判断 (等于 (文本数据, “<欠款>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (12))
        .默认
            
        .判断结束
        
    .计次循环尾 ()
.计次循环尾 ()
打印预览 ()


.子程序 _清屏按钮_被单击, 空白型, , 
全部删除 ()


.窗口程序集 窗口程序集18, , , 

.子程序 _按钮1_被单击, 空白型, , 
excel保存 (“会员消费情况查询”)

.子程序 _会员消费情况查询窗口_创建完毕, 空白型, , 
赋值 (.今天)

.子程序 _查询按钮_被单击, 空白型, , 
.局部变量 查询条件数组, 文本型, , "2", 
.局部变量 会员消费表_句柄, 整数型, , , 
.局部变量 次数3, 整数型, , , 
.局部变量 查询日期数组, 文本型, , "2", 
.局部变量 次数4, 整数型, , , 
.局部变量 次数5, 整数型, , , 
.局部变量 当前行数, 整数型, , , 
.局部变量 kkkk, 整数型, , , 

全部删除 ()
.计次循环首 (2, 次数3)
    赋值 (查询条件数组 [次数3], 多项选择 (次数3, .内容, .内容))
.计次循环尾 ()
.计次循环首 (2, 次数4)
    赋值 (查询日期数组 [次数4], 多项选择 (次数4, 未知支持库函数_12 (.今天, “%y-%m-%d”), 未知支持库函数_12 (.今天, “%y-%m-%d”)))
.计次循环尾 ()
赋值 (会员消费表_句柄, CNSQL查询SQL (相加 (“select * from 交易表,商品表 where 交易表.商品编号=商品表.商品编号 and  会员编号 like'%”, 查询条件数组 [1], “%'”, “ and”, “ 日期 BETWEEN”, “#”, 查询日期数组 [1], “#”, “ and”, “ #”, 查询日期数组 [2], “#”, “ and”, “ 会员编号 in (select 会员编号 from 会员表 where   会员姓名 like'%”, 查询条件数组 [2], “%')”)))
CNSQL到首记录 (会员消费表_句柄)
.判断循环首 (不等于 (CNSQL是否尾记录后 (会员消费表_句柄), 真))
    赋值 (当前行数, .插入表项 ())
    当前行数.置标题 (0, 到文本 (相加 (当前行数, 1)))
    当前行数.置标题 (1, 到文本 (CNSQL读文本 (会员消费表_句柄, “商品编号”)))
    当前行数.置标题 (2, 到文本 (CNSQL读文本 (会员消费表_句柄, “商品名称”)))
    当前行数.置标题 (3, 到文本 (四舍五入 (到数值 (CNSQL读文本 (会员消费表_句柄, “单价”)), 2)))
    当前行数.置标题 (4, 到文本 (CNSQL读文本 (会员消费表_句柄, “单位”)))
    当前行数.置标题 (5, 到文本 (四舍五入 (CNSQL读数值 (会员消费表_句柄, “数量”), 0)))
    当前行数.置标题 (6, 到文本 (四舍五入 (到数值 (CNSQL读文本 (会员消费表_句柄, “金额”)), 2)))
    当前行数.置标题 (7, 到文本 (取日期 (CNSQL读日期 (会员消费表_句柄, “日期”))))
    CNSQL到后一记录 (会员消费表_句柄)
.判断循环尾 ()


CNSQL关闭查询 (会员消费表_句柄)


.子程序 _清屏按钮_被单击, 空白型, , 
全部删除 ()


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 文本数据, 文本型, , , 
.局部变量 打印列, 整数型, , , 
.局部变量 打印行, 整数型, , , 
.局部变量 标示数据, 文本型, , , 


.如果真 (等于 (相加 (取运行目录 (), “\Normal\会员消费情况表.grd”).从文件读 (), 假))
    信息框 (“没有找到会员消费情况表，请你仔细检查，或者和系统管理员联系”, 相加 (#错误图标, #确认钮), “提示错误”)
    
.如果真结束
5.插入行 (取表项数 ())
.计次循环首 (取列数 (), 打印列)
    .计次循环首 (取表项数 (), 打印行)
        赋值 (标示数据, 相加 (打印行, 3).取文本 (打印列))
        4.置对齐方式 (1, 取表项数 (), 取列数 (), #中中)
        相加 (打印行, 4).置文本 (打印列, 标示数据)
        .判断开始 (等于 (标示数据, “<序号>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (0))
        .判断 (等于 (标示数据, “<商品编号>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (1))
        .判断 (等于 (标示数据, “<商品名称>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (2))
        .判断 (等于 (标示数据, “<单价>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (3))
        .判断 (等于 (标示数据, “<单位>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (4))
        .判断 (等于 (标示数据, “<购买数量>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (5))
        .判断 (等于 (标示数据, “<交易金额>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (6))
        .判断 (等于 (标示数据, “<消费日期>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (7))
        .默认
            
        .判断结束
        
    .计次循环尾 ()
.计次循环尾 ()
打印预览 ()



.窗口程序集 窗口程序集19, , , 

.子程序 _会员欠款窗口_创建完毕, 空白型, , 


.子程序 _按钮1_被单击, 空白型, , 


.窗口程序集 窗口程序集20, , , 

.子程序 _会员资金结余查询窗口_创建完毕, 空白型, , 


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 s1_句柄, 整数型, , , 
.局部变量 s2_句柄, 整数型, , , 

赋值 (s1_句柄, CNSQL查询SQL (相加 (“select 结余,欠款 from 会员表 where 会员编号=”, 到文本 (.内容))))
赋值 (s2_句柄, CNSQL查询SQL (相加 (“select sum(金额) as 合计金额 from 交易表 where 会员编号=”, 到文本 (.内容))))
赋值 (.内容, 到文本 (四舍五入 (相减 (到数值 (CNSQL读文本 (s1_句柄, “结余”)), 到数值 (CNSQL读文本 (s1_句柄, “欠款”)), 到数值 (CNSQL读文本 (s2_句柄, “合计金额”))), 2)))
CNSQL关闭查询 (s1_句柄)
CNSQL关闭查询 (s2_句柄)


.子程序 _按钮2_被单击, 空白型, , 
会员资金结余查询窗口.销毁 ()


.窗口程序集 窗口程序集21, , , 

.子程序 _商品销售额查询窗口_创建完毕, 空白型, , 
赋值 (.今天)

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 xs_句柄, 整数型, , , 
.局部变量 本行, 整数型, , , 

全部删除 ()
赋值 (xs_句柄, CNSQL查询SQL (相加 (“select 商品编号,sum(金额) as 金额合计 from 交易表 where 商品编号 like'%”, .内容, “%'”, “ and”, “ 日期 BETWEEN”, “#”, 未知支持库函数_12 (.今天, “%y-%m-%d”), “#”, “ and”, “#”, 未知支持库函数_12 (.今天, “%y-%m-%d”), “#”, “group by 商品编号”)))
CNSQL到首记录 (xs_句柄)
.判断循环首 (不等于 (CNSQL是否尾记录后 (xs_句柄), 真))
    赋值 (本行, .插入表项 ())
    本行.置标题 (0, 到文本 (CNSQL读文本 (xs_句柄, “商品编号”)))
    本行.置标题 (1, 到文本 (CNSQL读文本 (xs_句柄, “金额合计”)))
    CNSQL到后一记录 (xs_句柄)
.判断循环尾 ()


.子程序 _按钮3_被单击, 空白型, , 
excel保存 (“商品销售额查询”)


.子程序 _按钮2_被单击, 空白型, , 
全部删除 ()


.子程序 _按钮4_被单击, 空白型, , 
.局部变量 打印列, 整数型, , , 
.局部变量 打印行, 整数型, , , 
.局部变量 打印文本, 文本型, , , 


.如果真 (等于 (相加 (取运行目录 (), “\Normal\商品销售额查询.grd”).从文件读 (), 假))
    信息框 (“没有找到商品销售额表，请你仔细检查，或者和系统管理员联系”, 相加 (#错误图标, #确认钮), “提示信息”)
    
.如果真结束
5.插入行 (取表项数 ())
.计次循环首 (取列数 (), 打印列)
    .计次循环首 (取表项数 (), 打印行)
        赋值 (打印文本, 相加 (打印行, 3).取文本 (打印列))
        4.置对齐方式 (1, 取表项数 (), 取列数 (), #中中)
        相加 (打印行, 4).置文本 (打印列, 打印文本)
        .判断开始 (等于 (打印文本, “<商品编号>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (0))
        .判断 (等于 (打印文本, “<商品销售额>”))
            相加 (打印行, 3).置文本 (打印列, 相减 (打印行, 1).取标题 (1))
        .默认
            
        .判断结束
        
    .计次循环尾 ()
.计次循环尾 ()

打印预览 ()



.窗口程序集 窗口程序集22, , , 

.子程序 _查询按钮_被单击, 空白型, , 
.局部变量 yg_句柄, 整数型, , , 
.局部变量 y1_句柄, 整数型, , , 
.局部变量 当前行数, 整数型, , , 
.局部变量 y3, 整数型, , , 

全部删除 ()
赋值 (yg_句柄, CNSQL查询SQL (相加 (“select 员工编号,sum(金额) as 合计 from 交易表 where  员工编号 like'%”, .内容, “%'”, “ and”, “ 日期 BETWEEN”, “#”, 未知支持库函数_12 (.今天, “%y-%m-%d”), “#”, “ and”, “#”, 未知支持库函数_12 (.今天, “%y-%m-%d”), “#”, “ or”, “ 金额>=”, .内容, “ or”, “ 金额<=”, .内容, “ and”, “ 员工编号 in (select 员工编号 from 员工表 where 员工姓名 like'%”, .内容, “%')”, “group by 员工编号”)))

CNSQL到首记录 (yg_句柄)
.判断循环首 (不等于 (CNSQL是否尾记录后 (yg_句柄), 真))
    赋值 (当前行数, .插入表项 ())
    当前行数.置标题 (0, 到文本 (CNSQL读文本 (yg_句柄, “员工编号”)))
    赋值 (y1_句柄, CNSQL查询SQL (相加 (“select 员工姓名 from 员工表 where 员工编号=”, 当前行数.取标题 (0))))
    当前行数.置标题 (1, 到文本 (CNSQL读文本 (y1_句柄, “员工姓名”)))
    当前行数.置标题 (2, 到文本 (CNSQL读文本 (yg_句柄, “合计”)))
    CNSQL到后一记录 (yg_句柄)
    CNSQL关闭查询 (y1_句柄)
.判断循环尾 ()




.子程序 _清屏按钮_被单击, 空白型, , 
全部删除 ()


.子程序 _按钮1_被单击, 空白型, , 
excel保存 (“员工业绩表”)


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 取列数, 整数型, , , 
.局部变量 取行数, 整数型, , , 
.局部变量 标示数据, 文本型, , , 


.如果真 (不等于 (相加 (取运行目录 (), “\Normal\员工业绩表.grd”).从文件读 (), 真))
    信息框 (“没有找到员工业绩表，请你仔细检查，或者和系统管理员联系”, 相加 (#错误图标, #确认钮), “错误提示”)
    
.如果真结束
5.插入行 (取表项数 ())
.计次循环首 (取列数 (), 取列数)
    .计次循环首 (取表项数 (), 取行数)
        赋值 (标示数据, 相加 (取行数, 3).取文本 (取列数))
        4.置对齐方式 (1, 取表项数 (), 取列数 (), #中中)
        相加 (取行数, 4).置文本 (取列数, 标示数据)
        .判断开始 (等于 (标示数据, “<员工编号>”))
            相加 (取行数, 3).置文本 (取列数, 相减 (取行数, 1).取标题 (0))
        .判断 (等于 (标示数据, “<员工姓名>”))
            相加 (取行数, 3).置文本 (取列数, 相减 (取行数, 1).取标题 (1))
        .判断 (等于 (标示数据, “<销售金额>”))
            相加 (取行数, 3).置文本 (取列数, 相减 (取行数, 1).取标题 (2))
        .默认
            
        .判断结束
        
    .计次循环尾 ()
.计次循环尾 ()
打印预览 ()




.窗口程序集 窗口程序集23, , , 

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 登陆_句柄, 整数型, , , 

赋值 (登陆_句柄, CNSQL查询SQL (相加 (“select 用户密码 from 登陆表 where 用户姓名='”, 到文本 (相加 (删首尾空 (.内容), “'”)))))
.如果 (不等于 (.内容, “”))
    .如果 (等于 (到文本 (CNSQL读文本 (登陆_句柄, “用户密码”)), 到文本 (删首尾空 (.内容))))
        
        信息框 (“密码核对正确，恭喜”, 0, )
        赋值 (_启动窗口., 真)
        销毁 ()
        
    .否则
        信息框 (“密码不对，请你仔细核对”, 0, )
    .如果结束
    CNSQL关闭查询 (登陆_句柄)
    
.否则
    信息框 (“请输入用户”, 0, )
    
.如果结束


.子程序 _取消按钮2_被单击, 空白型, , 
CNSQL关闭数据库 ()
CNSQL关闭连接 ()
CNSQL卸载 ()
结束 ()



.子程序 _窗口2_可否被关闭, 逻辑型, , 
_取消按钮2_被单击 ()



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 excel保存, 空白型, , 
.参数 保存文件名, 通用对话框, , 
.参数 超级列表框, 超级列表框, , 
.参数 excel开始, 未知类型0x70001, , 
.参数 excel工作本, 未知类型0x70002, , 
.参数 表头名, 文本型, , 



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 机器编号, 空白型, , 
.参数 数据库, 外部数据库, , //填写数据库控件
.参数 数据库句柄, 整数型, , //数据库的句柄
.参数 数据编号, 整数型, , //数据的编号
.参数 标签, 标签, , //显示流水号
.参数 数据表单, 文本型, , //数据库的表单
.参数 id, 文本型, , 



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 excel导出, 空白型, , 
.参数 excel程序, 未知类型0x70001, , //填写excel程序控件
.参数 excel工作簿, 未知类型0x70002, , //填写excel工作簿控件
.参数 高级表格, 未知类型0x40001, , //填写高级表格名称
.参数 表头名称, 文本型, , //填写excel报表表头名称
.参数 单位, 文本型, , //填写报表单位



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 修改商品, 空白型, , 
.参数 高级表格, 未知类型0x40001, , //高级表格
.参数 数据, 外部数据库, , //外部数据库



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 CNSQL修复数据库, 整数型, , 修复数据库,请注意先关闭数据库.返回0成功，返回1则是创建系统对象失败，返回2是调用失败，返回3是数据库使用中
.参数 数据库文件名, 文本型, , 
.参数 数据库密码, 文本型, 可空, 
.参数 数据库类型, 短整数型, , 



.子程序 CNSQL打开数据库, 逻辑型, , 打开数据库
.参数 数据库文件名, 文本型, , 
.参数 数据库密码, 文本型, , 
.参数 管理密码, 文本型, , 
.参数 数据库类型, 短整数型, , 
.参数 超时时间, 整数型, , 



.子程序 CNSQL关闭数据库, 空白型, , 


.子程序 CNSQL执行命令, 逻辑型, , 
.参数 SQL语句, 文本型, , 
.参数 附加数据, 字节集, 可空, 



.子程序 CNSQL查询, 整数型, , 返回查询句柄
.参数 返回字段, 文本型, , * 返回所有 多字段用,隔开
.参数 被查询表, 文本型, , 多表用,隔开
.参数 查询条件, 文本型, , 



.子程序 CNSQL关闭查询, 空白型, , 
.参数 查询句柄, 整数型, , 



.子程序 CNSQL取记录数, 整数型, , 
.参数 查询句柄, 整数型, , 



.子程序 CNSQL到首记录, 空白型, , 
.参数 查询句柄, 整数型, , 



.子程序 CNSQL到尾记录, 空白型, , 
.参数 查询句柄, 整数型, , 



.子程序 CNSQL到前一记录, 空白型, , 
.参数 查询句柄, 整数型, , 



.子程序 CNSQL到后一记录, 空白型, , 
.参数 查询句柄, 整数型, , 



.子程序 CNSQL是否尾记录后, 逻辑型, , 
.参数 查询句柄, 整数型, , 



.子程序 CNSQL是否首记录, 逻辑型, , 
.参数 查询句柄, 整数型, , 



.子程序 CNSQL加入记录, 逻辑型, , 
.参数 加入表名, 文本型, , 
.参数 加入字段名, 文本型, , 多字段用,隔开
.参数 加入记录, 文本型, , 多字段用,隔开，如是字节集用？代替
.参数 附加数据, 字节集, 可空, 



.子程序 CNSQL更新记录, 逻辑型, , 
.参数 更新表名, 文本型, , 
.参数 更新记录, 文本型, , 字段名=记录 多字段用,隔开
.参数 更新条件, 文本型, , 
.参数 附加数据, 字节集, 可空, 



.子程序 CNSQL删除记录, 逻辑型, , 
.参数 删除表名, 文本型, , 
.参数 删除条件, 文本型, , 



.子程序 CNSQL全部删除, 逻辑型, , 
.参数 删除表名, 文本型, , 



.子程序 CNSQL读文本, 文本型, , 
.参数 查询句柄, 整数型, , 
.参数 字段名, 文本型, , 



.子程序 CNSQL读日期, 日期时间型, , 
.参数 查询句柄, 整数型, , 
.参数 字段名, 文本型, , 



.子程序 CNSQL读数值, 双精度小数型, , 
.参数 查询句柄, 整数型, , 
.参数 字段名, 文本型, , 



.子程序 CNSQL读字节集, 字节集, , 
.参数 查询句柄, 整数型, , 
.参数 字段名, 文本型, , 



.子程序 CNSQL修改数据库密码, 逻辑型, , 不要打开数据库
.参数 数据库文件名, 文本型, , 
.参数 数据库原密码, 文本型, , 
.参数 数据库新密码, 文本型, , 
.参数 数据库类型, 短整数型, , 



.子程序 CNSQL修改密码, 逻辑型, , 只能打开数据库后修改
.参数 数据库新密码, 文本型, , 



.子程序 CNSQL开始事务, 逻辑型, , 


.子程序 CNSQL提交事务, 逻辑型, , 


.子程序 CNSQL回滚事务, 逻辑型, , 


.子程序 CNSQL初始化, 逻辑型, , 
.参数 版权, 文本型, , 本DLL版权属鼎龙科技所有！只授权给个人学习和使用。非授权请勿商业应用！联系电话13955016851。



.子程序 CNSQL卸载, 空白型, , 


.子程序 CNSQL连接, 逻辑型, , 
.参数 ip地址, 文本型, , 
.参数 端口, 短整数型, , 
.参数 用户名, 文本型, , 
.参数 密码, 文本型, , 
.参数 超时时间, 整数型, , 



.子程序 CNSQL关闭连接, 空白型, , 


.子程序 CNSQL查询SQL, 整数型, , 
.参数 SQL语句, 文本型, , 




 ' 不属于任何一个程序集、类模块的函数：
