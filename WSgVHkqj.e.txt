 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 238
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\WSgVHkqj.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “粉网定时任务执行器”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 279
    高度 = 86
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “任务提示”
    帮助文件名 = “”

窗口 窗口2
    左边 = 50
    顶边 = 50
    宽度 = 205
    高度 = 85
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “延迟设置”
    帮助文件名 = “”

窗口 窗口3
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 117
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “软件使用帮助”
    帮助文件名 = “”

窗口 窗口4
    左边 = 50
    顶边 = 50
    宽度 = 293
    高度 = 63
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口5
    左边 = 50
    顶边 = 50
    宽度 = 293
    高度 = 63
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口6
    左边 = 50
    顶边 = 50
    宽度 = 293
    高度 = 63
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口7
    左边 = 50
    顶边 = 50
    宽度 = 293
    高度 = 63
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口8
    左边 = 50
    顶边 = 50
    宽度 = 293
    高度 = 63
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库




数据类型 进程信息, , 
    .成员 size, 整数型, , , 
    .成员 usage, 整数型, , , 
    .成员 id, 整数型, , , 
    .成员 hid, 整数型, , , 
    .成员 mid, 整数型, , , 
    .成员 threads, 整数型, , , 
    .成员 pid, 整数型, , , 
    .成员 clbase, 整数型, , , 
    .成员 flag, 整数型, , , 
    .成员 exefile, 字节型, , "256", 


.DLL命令 API_投递消息, 整数型, "user32", "PostMessageA", , 将一条消息投递到指定窗口的消息队列。投递的消息会在Windows事件处理过程中得到处理。在那个时候，会随同投递的消息调用指定窗口的窗口函数。特别适合那些不需要立即处理的窗口消息的发送  如消息投递成功，则返回TRUE（非零）。会设置GetLastError
    .参数 hwnd, 整数型, , 接收消息的那个窗口的句柄。如设为HWND_BROADCAST，表示投递给系统中的所有顶级窗口。如设为零，表示投递一条线程消息（参考PostThreadMessage）
    .参数 wMsg, 整数型, , 消息标识符
    .参数 wParam, 整数型, , 具体由消息决定
    .参数 lParam, 整数型, , 具体由消息决定;

.DLL命令 API_获得窗口关联进程ID, 整数型, "user32", "GetWindowThreadProcessId", , ;    获取与指定窗口关联在一起的一个进程和线程标识符  拥有窗口的线程的标识符
    .参数 hwnd, 整数型, , 指定窗口句柄;
    .参数 lpdwProcessId, 整数型, 传址, 指定一个变量，用于装载拥有那个窗口的一个进程的标识符

.DLL命令 API_取进程快照, 整数型, "", "CreateToolhelp32Snapshot", , CreateToolhelp32Snapshot
    .参数 falg, 整数型, , 
    .参数 id, 整数型, , 

.DLL命令 API_枚举父窗口, 整数型, "user32.dll", "EnumWindows", , 枚举窗口列表中的所有父窗口（顶级和被所有窗口）  非零表示成功，零表示失败
    .参数 函数指针, 子程序指针, , 指向为每个子窗口都调用的一个函数的指针。用AddressOf运算符获得函数在标准模式下的地址
    .参数 自定义数值, 整数型, , 在枚举期间，传递给dwcbkd32.ocx定制控件之EnumWindows事件的值。这个值的含义是由程序员规定的;

.DLL命令 API_快照中获取进程列表, 整数型, "", "Process32First", , Process32First
    .参数 hSnapShot, 整数型, , 
    .参数 uProcess, 进程信息, , 

.DLL命令 API_遍历快照中进程列表, 整数型, "", "Process32Next", , Process32Next
    .参数 hSnapShot, 整数型, , 
    .参数 uProcess, 进程信息, , 

.DLL命令 API_关闭内核对象, 整数型, "kernel32", "CloseHandle", , 关闭一个内核对象。其中包括文件、文件映射、进程、线程、安全和同步对象等。涉及文件处理时，这个函数通常与vb的close命令相似。应尽可能的使用close，因为它支持vb的差错控制。注意这个函数使用的文件句柄与vb的文件编号是完全不同的  非零表示成功，零表示失败。会设置GetLastError
    .参数 对象句柄, 整数型, , 欲关闭的一个对象的句柄;

.窗口程序集 窗口程序集1, , , 

.程序集变量 时间变量, 文本型, , , 
.程序集变量 设置时间, 文本型, , , 
.程序集变量 任务设置, 文本型, , , 
.程序集变量 进程ID, 整数型, , , 
.程序集变量 任务类型, 文本型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (.内容, 相加 (“当前时间: ”, 到文本 (取小时 (取现行时间 ())), “:”, 到文本 (取分钟 (取现行时间 ())), “:”, 到文本 (取秒 (取现行时间 ()))))
赋值 (.时钟周期, 999)
赋值 (.内容, 到文本 (取小时 (取现行时间 ())))
赋值 (.内容, 到文本 (取分钟 (取现行时间 ())))
赋值 (.内容, 到文本 (取秒 (取现行时间 ())))
赋值 (.时钟周期, 100)
未知支持库函数_0 (1)

.子程序 _时钟1_周期事件, 空白型, , 
赋值 (.内容, 相加 (“当前时间: ”, 到文本 (取小时 (取现行时间 ())), “:”, 到文本 (取分钟 (取现行时间 ())), “:”, 到文本 (取秒 (取现行时间 ()))))

.子程序 _选择框1_被单击, 空白型, , 
.判断开始 (等于 (.选中, 真))
    赋值 (.时钟周期, 999)
    赋值 (.标题, “取消启动任务”)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.默认
    赋值 (.标题, “开始启动任务”)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    
.判断结束


.子程序 _时钟2_周期事件, 空白型, , 
赋值 (设置时间, 相加 (.内容, .内容, .内容))
赋值 (时间变量, 相加 (到文本 (取小时 (取现行时间 ())), 到文本 (取分钟 (取现行时间 ())), 到文本 (取秒 (取现行时间 ()))))
.判断开始 (不等于 (设置时间, 时间变量))
    
.判断 (等于 (任务类型, “静默”))
    判断任务 ()
.默认
    赋值 (.时钟周期, 0)
    赋值 (.选中, 假)
    载入 (窗口1, , 真)
.判断结束


.子程序 判断任务, 空白型, , 
.判断开始 (等于 (任务设置, “关机”))
    运行 (“Shutdown -s -f”, 假, )
.判断 (等于 (任务设置, “注销”))
    运行 (“Shutdown -l -f”, 假, )
.判断 (等于 (任务设置, “重启”))
    运行 (“Shutdown -r -f”, 假, )
.判断 (等于 (任务设置, “命令”))
    运行 (窗口4..内容, 假, )
.判断 (等于 (任务设置, “程序”))
    运行 (窗口5..内容, 假, )
.判断 (等于 (任务设置, “网页”))
    赋值 (.Internet地址, 窗口6..内容)
    跳转 ()
.判断 (等于 (任务设置, “结束”))
    API_枚举父窗口 (&枚举窗口句柄, 0)
.判断 (等于 (任务设置, “提示”))
    信息框 (窗口7..内容, 0, “粉网消息”)
.默认
    
.判断结束


.子程序 枚举窗口句柄, 逻辑型, , 
.参数 窗口句柄, 整数型, , 

.局部变量 待结束进程名, 文本型, , , 
.局部变量 进程句柄, 整数型, , , 
.局部变量 进程快照, 整数型, , , 
.局部变量 进程信息, 进程信息, , , 


.如果真 (不等于 (窗口句柄, 0))
    赋值 (待结束进程名, 到文本 (窗口8..内容))
    API_获得窗口关联进程ID (窗口句柄, 进程ID)
    
    赋值 (进程快照, API_取进程快照 (15, 0))
    .如果真 (不等于 (进程快照, 0))
        赋值 (进程信息.size, 296)
        赋值 (进程句柄, API_快照中获取进程列表 (进程快照, 进程信息))
        .判断循环首 (不等于 (进程句柄, 0))
            .如果真 (不等于 (进程信息.id, 0))
                 ' 输出调试文本 (到文本 (到字节集 (进程信息.exefile)))  ' 进程名
                .如果真 (并且 (等于 (进程ID, 进程信息.id), 等于 (到小写 (待结束进程名), 到小写 (到文本 (到字节集 (进程信息.exefile))))))
                    .如果真 (等于 (信息框 (相加 (“是否立即终止进程：”, 到文本 (到小写 (到文本 (到字节集 (进程信息.exefile))))), 相加 (#询问图标, #是否钮), ), #是钮))
                        API_投递消息 (窗口句柄, 18, 0, 0)
                         ' 输出调试文本 (窗口句柄)
                        信息框 (“结束进程成功！”, 64, )
                        
                    .如果真结束
                    
                    跳出循环 ()
                .如果真结束
                
            .如果真结束
            赋值 (进程句柄, API_遍历快照中进程列表 (进程快照, 进程信息))
        .判断循环尾 ()
        API_关闭内核对象 (进程快照)
        
    .如果真结束
    
    
    返回 (真)
.如果真结束

返回 (假)

.子程序 _时钟3_周期事件, 空白型, , 
.判断开始 (等于 (.选中, 真))
    _选择框1_被单击 ()
.默认
    _选择框1_被单击 ()
.判断结束


.子程序 _单选框1_被单击, 空白型, , 
未知支持库函数_0 (1)


.子程序 _单选框2_被单击, 空白型, , 
未知支持库函数_0 (2)

.子程序 _单选框3_被单击, 空白型, , 
未知支持库函数_0 (3)

.子程序 _单选框4_被单击, 空白型, , 
未知支持库函数_0 (4)

.子程序 _图片框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

跳转 ()

.子程序 _按钮2_被单击, 空白型, , 
赋值 (_启动窗口., 假)

.子程序 _按钮1_被单击, 空白型, , 
载入 (窗口3, , 真)

.子程序 _单选框5_被单击, 空白型, , 
赋值 (任务设置, “关机”)

.子程序 _单选框9_被单击, 空白型, , 
赋值 (任务设置, “注销”)

.子程序 _单选框6_被单击, 空白型, , 
赋值 (任务设置, “重启”)

.子程序 _单选框10_被单击, 空白型, , 
赋值 (任务设置, “命令”)
载入 (窗口4, , 假)

.子程序 _单选框7_被单击, 空白型, , 
赋值 (任务设置, “程序”)
载入 (窗口5, , 假)

.子程序 _单选框11_被单击, 空白型, , 
赋值 (任务设置, “网页”)
载入 (窗口6, , 假)

.子程序 _单选框8_被单击, 空白型, , 
赋值 (任务设置, “结束”)
载入 (窗口8, , 假)

.子程序 _单选框12_被单击, 空白型, , 
赋值 (任务设置, “提示”)
载入 (窗口7, , 假)

.子程序 _选择框3_被单击, 空白型, , 
赋值 (任务类型, “静默”)
赋值 (.输入方式, 1)

.子程序 _选择框2_被单击, 空白型, , 
.判断开始 (等于 (.选中, 真))
    运行 (相加 (取当前目录 (), “\粉网挂机锁.exe”), 假, )
.默认
    
.判断结束


.窗口程序集 窗口程序集2, , , 

.程序集变量 倒记时, 整数型, , , 
.子程序 _按钮2_被单击, 空白型, , 
赋值 (_启动窗口..时钟周期, 0)
赋值 (_启动窗口..选中, 假)
赋值 (.时钟周期, 0)
信息框 (“任务已经停止”, 0, “通知”)
销毁 ()

.子程序 _按钮3_被单击, 空白型, , 
赋值 (.时钟周期, 0)
载入 (窗口2, , 真)
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
赋值 (.时钟周期, 0)
_启动窗口.判断任务 ()

.子程序 _窗口1_创建完毕, 空白型, , 
赋值 (倒记时, 到整数 (_启动窗口..内容))
赋值 (.标题, _启动窗口..内容)
赋值 (.时钟周期, 1000)

.子程序 _时钟1_周期事件, 空白型, , 
.判断开始 (等于 (.标题, 到文本 (倒记时)))
    赋值 (倒记时, 相减 (倒记时, 1))
    赋值 (.标题, 到文本 (倒记时))
    .判断开始 (等于 (.标题, “0”))
        _按钮1_被单击 ()
    .默认
        
    .判断结束
    
.默认
    
.判断结束


.窗口程序集 窗口程序集3, , , 

.子程序 _窗口2_创建完毕, 空白型, , 
赋值 (.内容, _启动窗口..内容)
赋值 (.时钟周期, 100)

.子程序 _按钮1_被单击, 空白型, , 
赋值 (_启动窗口..内容, .内容)
赋值 (_启动窗口..内容, .内容)
赋值 (_启动窗口..内容, .内容)
赋值 (_启动窗口..内容, .内容)
赋值 (_启动窗口..选中, 真)
信息框 (“设置成功!”, 0, “通知”)
销毁 ()

.子程序 _时钟1_周期事件, 空白型, , 
赋值 (.内容, _启动窗口..内容)

.窗口程序集 窗口程序集4, , , 

.子程序 _按钮1_被单击, 空白型, , 
赋值 (窗口4., 假)


.窗口程序集 窗口程序集5, , , 

.子程序 _按钮1_被单击, 空白型, , 
打开 ()
赋值 (.内容, .文件名)
赋值 (窗口5., 假)

.窗口程序集 窗口程序集6, , , 

.子程序 _按钮1_被单击, 空白型, , 
赋值 (窗口6., 假)


.窗口程序集 窗口程序集7, , , 

.子程序 _按钮1_被单击, 空白型, , 
赋值 (窗口7., 假)


.窗口程序集 窗口程序集8, , , 

.子程序 _按钮1_被单击, 空白型, , 
赋值 (窗口8., 假)



 ' 不属于任何一个程序集、类模块的函数：
