 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 385
    高度 = 282
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “文件拖放例程（何震提供）”
    帮助文件名 = “”



.常量 WM_DROPFILES, "563", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 6 系统核心支持库



 ' 所需要的模块
 ' 回调函数1.0 F:\旧资源网\系统工具\文件拖放例程 1.0\模块_回调函数.ec



.DLL命令 设置窗口是否接受拖放, 逻辑型, "shell32.dll", "DragAcceptFiles", , 设置窗口是否接受拖放
    .参数 hWnd, 整数型, , 
    .参数 isAccept, 逻辑型, , true:接收拖放

.DLL命令 结束拖放, 空白型, "shell32.dll", "DragFinish", , 结束拖放
    .参数 hDrop, 整数型, , hDrop取自WM_DROPFILES消息的wParam参数

.DLL命令 取被拖放文件数, 整数型, "shell32.dll", "DragQueryFile", , 取被拖放文件名
    .参数 hDrop, 整数型, , hDrop取自WM_DROPFILES消息的wParam参数
    .参数 index_of_file, 整数型, , 如果为 -1,DragQueryFile返回已传送文件数
    .参数 buf, 整数型, , 
    .参数 size_of_buf, 整数型, , 

.DLL命令 取被拖放文件名, 空白型, "shell32.dll", "DragQueryFile", , 
    .参数 hDrop, 整数型, , hDrop取自WM_DROPFILES消息的wParam参数
    .参数 index_of_file, 整数型, , 如果为 -1,DragQueryFile返回已传送文件数
    .参数 buf, 文本型, , 
    .参数 size_of_buf, 整数型, , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 FileNumber, 整数型, , , 
.程序集变量 FileName, 文本型, , , 
.程序集变量 wMsg, 整数型, , , 
.程序集变量 循环容器, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
未知函数_67174435 (取窗口句柄 (), , ) ' 第一个参数必须是窗口单元的句柄，不能是窗口的句柄，否则会非法操作
设置窗口是否接受拖放 (取窗口句柄 (), 真)
赋值 (FileName, 取空白文本 (255))

.子程序 _标签1_反馈事件, 整数型, , 
.参数 参数一, 整数型, , 
.参数 参数二, 整数型, , 

 ' 不应该在此处拦截
赋值 (wMsg, 参数二)

.子程序 _标签2_反馈事件, 整数型, , 
.参数 参数一, 整数型, , 
.参数 参数二, 整数型, , 

.判断开始 (等于 (wMsg, #WM_DROPFILES))
    赋值 (FileNumber, 取被拖放文件数 (参数一, -1, 0, 0))
    .计次循环首 (FileNumber, 循环容器)
        取被拖放文件名 (参数一, 相减 (循环容器, 1), FileName, 256)
        FileName.加入项目 ()
        赋值 (FileName, 取空白文本 (256))
    .计次循环尾 ()
    结束拖放 (参数一)
.默认
    
.判断结束
返回 (0) ' 其他消息让原窗口处理，如果不返回也可以，但是有可能会有不可预计的错误，所以尽量返回(0)

.子程序 _按钮2_被单击, 空白型, , 
结束 ()

.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 定义回调函数, 空白型, , 同一控件，此函数只能用一次，反馈标签1不用返回，反馈标签2必须要返回值，具体拦截请参照例程
.参数 控件句柄, 整数型, , 
.参数 反馈标签1, 标签, , 接收拦截消息的标签名称，接收hwnd,wMsg
.参数 反馈标签2, 标签, , 接收拦截消息的标签名称，接收wParam,lParam




 ' 不属于任何一个程序集、类模块的函数：
