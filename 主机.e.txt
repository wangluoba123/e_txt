 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 6 系统核心支持库
 ' twain 730FA7B73AAB409a8554F9553CF2DD87 1 5 数码设备支持库
 ' Exmlrpc A36CFD538657479eBD7C0D287BBB3D95 1 3 远程服务支持库



 ' 所需要的模块
 ' 斩月_图像相关模块 E:\志\软件\易语言\工程\远程扫描仪\斩月_图像相关模块.ec


数据类型 矩形区域, 公开, 
    .成员 左边, 整数型, , , 
    .成员 顶边, 整数型, , , 
    .成员 右边, 整数型, , , 
    .成员 底边, 整数型, , , 


.窗口程序集 窗口程序集1, , , 

.程序集变量 对方地址, 文本型, , , 
.程序集变量 客户端, 未知类型0x30002, , , 
.子程序 _数据报1_数据到达, 空白型, , 
.局部变量 s, 文本型, , , 


赋值 (s, 到文本 (取回数据 ()))

.如果 (并且 (不等于 (取文本左边 (s, 1), “k”), 不等于 (s, “”)))
    赋值 (对方地址, s)
     ' 数据报1.发送数据 (, 19729, “ko”)
.否则
    .如果真 (等于 (s, “ksm”)) ' 收到扫描指令
        客户端.未知支持库函数_15 (2010, 对方地址, 假, &请求客户端)
        .发送数据 (19729, “主机正在启动扫描仪”)
        扫描 ()
    .如果真结束
    
.如果结束



.子程序 __启动窗口_创建完毕, 空白型, , 
未知支持库函数_3 ()

.子程序 扫描, 空白型, , 
假.未知支持库函数_0 (0)
赋值 (., 2)
赋值 (., 150)
赋值 (., 150)
赋值 (., 0)
赋值 (., 11)
赋值 (., 0)
赋值 (., 8.5)
假.未知支持库函数_1 ()


.子程序 _TWAIN组件_图片传送完毕, 空白型, , 
.参数 图片, 字节集, , 
.参数 图片宽度, 整数型, , 
.参数 图片高度, 整数型, , 

.局部变量 l, 逻辑型, , , 
.局部变量 编号, 文本型, , , 

.发送数据 (19729, “扫描完成，正在转换格式”)
写到文件 (相加 (取运行目录 (), “\temp.jpg”), 图像_转换图片格式 (图片, 2))
.发送数据 (19729, “转换格式完成，正在发送”)
赋值 (l, 客户端.未知支持库函数_20 (读入文件 (相加 (取运行目录 (), “\temp.jpg”))))
.如果 (l)
    .发送数据 (19729, “发送成功”)
.否则
    .发送数据 (19729, “发送失败”)
.如果结束
 ' 客户端.断开 ()

.子程序 _按钮1_被单击, 空白型, , 
扫描 ()

.子程序 请求客户端, 空白型, , 
.参数 参数, 整数型, , 



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 图像_取屏幕宽度, 整数型, , 单位为像素。


.子程序 图像_取屏幕高度, 整数型, , 单位为像素。


.子程序 图像_快照, 字节集, , 功能与支持库基本相同。
.参数 窗口句柄, 整数型, 可空, 指定欲捕获其显示内容的窗口。为空则捕捉全屏。
.参数 输出宽度, 整数型, 可空, 指定图片的输出宽度。如果小于0，参数值指定的是最终图片输出宽度相对于所取得图片宽度的百分比；如果等于0，则按图片原宽度输出；如果大于0，指定输出图片的绝对宽度。如果本参数被省略，默认值为0。
.参数 输出高度, 整数型, 可空, 指定图片的输出高度。如果小于0，参数值指定的是最终图片输出高度相对于所取得图片高度的百分比；如果等于0，则按图片原高度输出；如果大于0，指定输出图片的绝对高度。如果本参数被省略，默认值为0。



.子程序 图像_图片句柄取图片, 字节集, , 返回的图片格式为位图。
.参数 hBitmap, 整数型, , 



.子程序 图像_窗口快照, 字节集, , 能对被其他窗口挡住的未最小化窗口进行截图。
.参数 窗口句柄, 整数型, 可空, 要截取的窗口的句柄。为空则捕捉全屏。
.参数 输出宽度, 整数型, 可空, 指定图片的输出宽度。如果小于0，参数值指定的是最终图片输出宽度相对于所取得图片宽度的百分比；如果等于0，则按图片原宽度输出；如果大于0，指定输出图片的绝对宽度。如果本参数被省略，默认值为0。
.参数 输出高度, 整数型, 可空, 指定图片的输出高度。如果小于0，参数值指定的是最终图片输出高度相对于所取得图片高度的百分比（最小为10%）；如果等于0，则按图片原高度输出；如果大于0，指定输出图片的绝对高度。如果本参数被省略，默认值为0。



.子程序 图像_释放图片句柄, 逻辑型, , 用了 图像_取图片句柄() 得到的句柄后一定要用本函数释放，不然会造成内存泄露。
.参数 图像句柄, 整数型, , 



.子程序 图像_取图片句柄, 整数型, , 支持bmp、gif、jpg、cur、ico等。感谢叮咚茶提供的极强悍源码，没有这个函数整个模块没法做了。。。
.参数 图形数据, 字节集, , 
.参数 输出宽度, 整数型, 可空, 
.参数 输出高度, 整数型, 可空, 



.子程序 图像_置图片尺寸, 字节集, , 返回新的图片数据。
.参数 原图片, 字节集, , 
.参数 新宽度, 整数型, 可空, 留空默认保持原大小，下同。
.参数 新高度, 整数型, 可空, 



.子程序 图像_取图片宽度, 整数型, , 支持bmp、gif、jpg、cur、ico等，不支持某些格式的图片(如png)，请先转换为bmp。
.参数 图片, 字节集, , 



.子程序 图像_取图片高度, 整数型, , 支持bmp、gif、jpg、cur、ico等，不支持某些格式的图片(如png)，请先转换为bmp。
.参数 图片, 字节集, , 



.子程序 图像_取剪贴板图片, 字节集, , 


.子程序 图像_置剪贴板图片, 逻辑型, , 
.参数 图片, 字节集, , 



.子程序 图像_转换图片格式, 字节集, , 支持bmp、jpg、gif、tiff、png互转。感谢凌晨孤星提供如此强大的代码。。。
.参数 图像数据, 字节集, , 被转换的图像数据
.参数 转换后的格式, 整数型, , 转换后的图片格式。1、bmp；2、jpg；3、gif；4、tiff；5、png



.子程序 图像_截取屏幕区域, 字节集, , 
.参数 截取范围, 矩形区域, , 
.参数 输出宽度, 整数型, 可空, 指定图片的输出宽度。如果小于0，参数值指定的是最终图片输出宽度相对于所取得图片宽度的百分比；如果等于0，则按图片原宽度输出；如果大于0，指定输出图片的绝对宽度。如果本参数被省略，默认值为0。
.参数 输出高度, 整数型, 可空, 指定图片的输出高度。如果小于0，参数值指定的是最终图片输出高度相对于所取得图片高度的百分比（最小为10%）；如果等于0，则按图片原高度输出；如果大于0，指定输出图片的绝对高度。如果本参数被省略，默认值为0。




 ' 不属于任何一个程序集、类模块的函数：
