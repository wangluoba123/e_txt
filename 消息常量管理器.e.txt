 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：联系作者：QQ702160662
手机:13568610323
 ' 程序作者：闭关修炼
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 1000
    高度 = 740
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 65280 '  0xFF00
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “闭关修练常量管理器”
    帮助文件名 = “”



.图片 压缩常量库, " ' 已保存到：D:\易语言学习\Data\消息常量管理器.e\压缩常量库", , 
.图片 Windows系统定义的消息类别, " ' 已保存到：D:\易语言学习\Data\消息常量管理器.e\Windows系统定义的消息类别", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' commobj {A068799B-7551-46b9-8CA8-EEF8357AFEA4} 2 0 通用对象支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 3 0 扩展界面支持库三
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 2 0 数据操作支持库一




数据类型 消息常量, , 
    .成员 消息分类, 文本型, , , 

数据类型 自定义_常量类型, 公开, 
    .成员 常量名称, 文本型, , , 
    .成员 常量值, 文本型, , , 
    .成员 公开, 文本型, , , 
    .成员 备注, 文本型, , , 


.窗口程序集 窗口程序集1, , , 

.程序集变量 常量_旧数组库, 自定义_常量类型, , "0", 
.程序集变量 常量_重复_新组, 自定义_常量类型, , "0", 
.程序集变量 常量_重复_在旧位置, 整数型, , "0", 
.程序集变量 常量_重复_在新位置, 整数型, , "0", 
.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (_启动窗口., 300)
赋值 (_启动窗口., 70)
赋值 (_启动窗口., 真)
_启动窗口.移动 (300, 300, , )
0.移动 (0, 300, 50)
赋值 (.可视, 真)
处理事件 ()
加载数据库到内存数组 ()
显示常量信息到超级列表框 (常量_旧数组库)
 ' 内存数组保存到源码格式文件 (常量_旧数组库, 到文本 (取现行时间 ()) ＋ “.txt”)
赋值 (.可视, 假)
_启动窗口.移动 (0, 0, 1000, 740)

.子程序 __启动窗口_将被销毁, 空白型, , 
删除文件 (“常量信息.edb”)

.子程序 加载数据库到内存数组, 空白型, , 
.局部变量 临时常量, 自定义_常量类型, , , 
.局部变量 i, 整数型, , , 

.如果真 (等于 (文件是否存在 (“常量信息.edb”), 假))
    写到文件 (“常量信息.edb”, 未知支持库函数_1 (#压缩常量库))
.如果真结束

.如果真 (等于 (打开 (“常量信息.edb”, “常量库”, , , , , ), 假))
    返回 ()
.如果真结束
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    赋值 (临时常量.常量名称, 读 (1))
    赋值 (临时常量.常量值, 读 (2))
    赋值 (临时常量.备注, 读 (4))
    加入成员 (常量_旧数组库, 临时常量)
    跳过 ()
.判断循环尾 ()
关闭 ()

.子程序 显示常量信息到超级列表框, 空白型, , 
.参数 参_常量数组, 自定义_常量类型, 数组, 

.局部变量 i, 整数型, , , 

.计次循环首 (取数组成员数 (参_常量数组), i)
    .插入表项 (i)
    相减 (i, 1).置标题 (0, 参_常量数组 [i], 常量名称)
    相减 (i, 1).置标题 (1, 参_常量数组 [i], 常量值)
    相减 (i, 1).置标题 (2, 参_常量数组 [i], 备注)
.计次循环尾 ()

.子程序 内存数组保存到源码格式文件, 空白型, , 
.参数 参_常量数组, 自定义_常量类型, 数组, 
.参数 参_文件名, 文本型, 可空, 
.参数 参_显示到编辑框, 逻辑型, 可空, 

.局部变量 快果, 未知类型0x20001, , , 
.局部变量 i, 整数型, , , 
.局部变量 文件号, 整数型, , , 

.如果真 (等于 (参_文件名, “”))
    赋值 (参_文件名, 相加 (到文本 (取现行时间 ()), “常量源码格式备份.txt”))
.如果真结束
快果.未知支持库函数_26 ()
快果.未知支持库函数_27 (相加 (“.版本 2”, #换行符, #换行符), “”)
.计次循环首 (取数组成员数 (参_常量数组), i)
    .如果真 (等于 (删全部空 (参_常量数组 [i], 常量值), “”))
        到循环尾 ()
    .如果真结束
    
    快果.未知支持库函数_27 (相加 (“.常量 ”, 删尾空 (参_常量数组 [i], 常量名称), “, ”))
    快果.未知支持库函数_27 (相加 (删首尾空 (参_常量数组 [i], 常量值), “, ”))
    快果.未知支持库函数_27 (相加 (删尾空 (参_常量数组 [i], 公开), “, ”))
    赋值 (参_常量数组 [i], 备注, 删全部空 (参_常量数组 [i], 备注))
    .如果真 (不等于 (参_常量数组 [i], 备注, “”))
        快果.未知支持库函数_27 (参_常量数组 [i], 备注)
    .如果真结束
    快果.未知支持库函数_27 (#换行符)
.计次循环尾 ()
赋值 (文件号, 打开文件 (参_文件名, #重写, ))
写出文本 (文件号, 快果.未知支持库函数_24 ())
关闭文件 (文件号)
.如果真 (等于 (参_显示到编辑框, 真))
    赋值 (.内容, 快果.未知支持库函数_24 ())
.如果真结束


.子程序 到整数_十六进制文本_代码法, 整数型, , 返回十进制的整数值
.参数 十六进制文本, 文本型, , 

.局部变量 十进制数值, 整数型, , , 
.局部变量 文本长度, 整数型, , , 
.局部变量 循环, 整数型, , , 
.局部变量 单个数值, 整数型, , , 

赋值 (文本长度, 取文本长度 (十六进制文本))
.变量循环首 (1, 文本长度, 1, 循环)
    赋值 (单个数值, 取代码 (十六进制文本, 循环))
    .判断开始 (并且 (大于或等于 (单个数值, 48), 小于或等于 (单个数值, 57)))
        赋值 (单个数值, 相减 (单个数值, 48))
    .判断 (并且 (大于或等于 (单个数值, 65), 小于或等于 (单个数值, 70)))
        赋值 (单个数值, 相减 (单个数值, 55))
    .默认
        
    .判断结束
    赋值 (十进制数值, 相加 (十进制数值, 相乘 (单个数值, 求次方 (16, 相减 (文本长度, 循环)))))
.变量循环尾 ()
返回 (十进制数值)

.子程序 _按钮_编辑框新常量源码_处理常量资源_被单击, 空白型, , 
赋值 (_启动窗口., “正在进行数据处理,请稍等。。。。。”)
加入新常量 ()
赋值 (., 2)
赋值 (_启动窗口., “闭关修练常量管理器”)

.子程序 加入新常量, 空白型, , 
.局部变量 分割一级, 文本型, , "0", 
.局部变量 分割二级, 文本型, , "0", 
.局部变量 快文本, 未知类型0x20001, , , 
.局部变量 常量_新资源, 自定义_常量类型, , "0", 
.局部变量 J, 整数型, , , 
.局部变量 X, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 找到, 逻辑型, , , 
.局部变量 临时文本, 文本型, , , 

.如果真 (等于 (.内容, “”))
    返回 ()
.如果真结束
 ' 第一步,对新常量源码格式资源进行结构化处理,以变量形式保存在内存中,以便比较
快文本.未知支持库函数_27 (子文本替换 (子文本替换 (.内容, 相加 (“.版本 2”, #换行符, #换行符), “”, , 1, 真), “.常量 ”, “”, , , 真))
赋值 (分割一级, 分割文本 (快文本.未知支持库函数_24 (), #换行符, ))
重定义数组 (常量_新资源, 假, 取数组成员数 (分割一级))
.计次循环首 (取数组成员数 (分割一级), X)
    赋值 (分割二级, 分割文本 (分割一级 [X], “, ”, ))
    赋值 (常量_新资源 [X], 常量名称, 分割二级 [1])
    .如果真 (小于 (取数组成员数 (分割二级), 2))
        到循环尾 ()
    .如果真结束
    
    赋值 (分割二级 [2], 子文本替换 (分割二级 [2], #引号, “”, , , 真))
    赋值 (分割二级 [2], 子文本替换 (分割二级 [2], #左引号, “”, , , 真))
    赋值 (分割二级 [2], 子文本替换 (分割二级 [2], #右引号, “”, , , 真))
    赋值 (临时文本, 子文本替换 (分割二级 [2], “-”, “”, 1, 1, 真))
    .判断开始 (等于 (到文本 (相乘 (到数值 (相加 (“0.”, 临时文本)), 求次方 (10, 取文本长度 (临时文本)))), 临时文本))
        赋值 (常量_新资源 [X], 常量值, 分割二级 [2])
    .默认
        赋值 (常量_新资源 [X], 常量值, 相加 (#左引号, 分割二级 [2], #右引号))
    .判断结束
    
    .如果真 (大于或等于 (取数组成员数 (分割二级), 4))
        .变量循环首 (4, 取数组成员数 (分割二级), 1, i)
            赋值 (常量_新资源 [X], 备注, 相加 (常量_新资源 [X], 备注, 分割二级 [i]))
        .变量循环尾 ()
    .如果真结束
    
.计次循环尾 ()
 ' 第二步, 开始合并常量集,将新资源与老资源进行比较合并
.计次循环首 (取数组成员数 (常量_新资源), X) ' 把新资源的结构变量,依次放入老资源中进行比较
    赋值 (找到, 假)
    .计次循环首 (取数组成员数 (常量_旧数组库), J)
         ' 第一次大循环,都分找到和没有找到两种情况,一但在小循环中找到,就置为真,并作相应的处理,然后跳出小循环
        .如果真 (等于 (常量_旧数组库 [J], 常量名称, 常量_新资源 [X], 常量名称))
            赋值 (找到, 真)
            .判断开始 (或者 (不等于 (常量_旧数组库 [J], 常量值, 常量_新资源 [X], 常量值), 不等于 (常量_旧数组库 [J], 备注, 常量_新资源 [X], 备注)))
                 ' 新资源相对于老资源重复,所以存放到超级列表框,另行处理,
                 ' 但至少证常量值或备注说明内容中,至少有一个不相同,因为那是完全重复的情况,可以不理会
                .如果真 (等于 (常量_旧数组库 [J], 常量值, 常量_新资源 [X], 常量值))
                    .如果真 (不等于 (寻找文本 (常量_旧数组库 [J], 备注, 常量_新资源 [X], 备注, , 假), -1))
                        跳出循环 ()
                    .如果真结束
                    .如果真 (不等于 (寻找文本 (常量_新资源 [X], 备注, 常量_旧数组库 [J], 备注, , 假), -1))
                        赋值 (常量_旧数组库 [J], 备注, 常量_新资源 [X], 备注)
                        跳出循环 ()
                    .如果真结束
                    赋值 (常量_旧数组库 [J], 备注, 相加 (常量_旧数组库 [J], 备注, 常量_新资源 [X], 备注))
                    跳出循环 ()
                .如果真结束
                加入成员 (常量_重复_新组, 常量_新资源 [X])
                加入成员 (常量_重复_在旧位置, J)
            .默认
                跳出循环 () ' 完全相同时就直接跳出循环
            .判断结束
            
        .如果真结束
        
    .计次循环尾 ()
    .如果真 (等于 (找到, 假)) ' 说明这确实是老资源中没有的,应当加入进去
        加入成员 (常量_旧数组库, 常量_旧数组库 [X])
    .如果真结束
    
.计次循环尾 ()


.计次循环首 (取数组成员数 (常量_重复_在旧位置), i)
    相减 (i, 1).插入项目 (常量_旧数组库 [常量_重复_在旧位置] [i], 常量名称, 常量_重复_在旧位置 [i])
.计次循环尾 ()
内存数组保存到源码格式文件 (常量_重复_新组, )

.子程序 _编辑框_查找内容_内容被改变, 空白型, , 
.局部变量 x, 整数型, , , 
.局部变量 常量_找到, 自定义_常量类型, , "0", 
.局部变量 长度, 整数型, , , 
.局部变量 文本, 文本型, , , 
.局部变量 要查找, 逻辑型, , , 
.局部变量 已加入, 逻辑型, , , 

.如果真 (等于 (.内容, “”))
    返回 ()
.如果真结束
赋值 (文本, .内容)
赋值 (长度, 取文本长度 (文本))

.判断开始 (.选中)
    赋值 (要查找, 真)
.判断 (.选中)
    赋值 (要查找, 真)
.判断 (.选中)
    赋值 (要查找, 真)
.默认
    
.判断结束

.如果真 (等于 (要查找, 假))
    返回 ()
.如果真结束

.计次循环首 (取数组成员数 (常量_旧数组库), x)
    赋值 (已加入, 假)
    .如果真 (.选中)
        .如果真 (等于 (取文本左边 (常量_旧数组库 [x], 常量名称, 长度), 文本))
            加入成员 (常量_找到, 常量_旧数组库 [x])
            赋值 (已加入, 真)
        .如果真结束
        
    .如果真结束
    .如果真 (并且 (.选中, 等于 (已加入, 假)))
        .如果真 (等于 (常量_旧数组库 [x], 常量值, 文本))
            加入成员 (常量_找到, 常量_旧数组库 [x])
            赋值 (已加入, 真)
        .如果真结束
        
    .如果真结束
    .如果真 (并且 (.选中, 等于 (已加入, 假)))
        .如果真 (不等于 (寻找文本 (常量_旧数组库 [x], 备注, 文本, , 假), -1))
            加入成员 (常量_找到, 常量_旧数组库 [x])
            赋值 (已加入, 真)
        .如果真结束
        
    .如果真结束
    
.计次循环尾 ()

全部删除 ()
.计次循环首 (取数组成员数 (常量_找到), x)
    .插入表项 (x)
    相减 (x, 1).置标题 (0, 常量_找到 [x], 常量名称)
    相减 (x, 1).置标题 (1, 常量_找到 [x], 常量值)
    相减 (x, 1).置标题 (2, 常量_找到 [x], 备注)
.计次循环尾 ()

.子程序 _编辑框_备注_内容被改变, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 长度, 整数型, , , 
.局部变量 文本, 文本型, , , 

.如果真 (等于 (.内容, “”))
    返回 ()
.如果真结束
赋值 (文本, .内容)
赋值 (长度, 取文本长度 (文本))

.子程序 _按钮_编辑框新常量源码_清空_被单击, 空白型, , 
赋值 (.内容, “”)

.子程序 _按钮_保存修改_被单击, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 常量名, 文本型, , , 
.局部变量 快果, 未知类型0x20001, , , 
.局部变量 文件号, 整数型, , , 

.如果真 (等于 (.内容, “”))
    返回 ()
.如果真结束

.置标题 (., 2, .内容)
赋值 (常量名, .取标题 (., 0))
.计次循环首 (取数组成员数 (常量_旧数组库), i)
    .如果真 (等于 (常量_旧数组库 [i], 常量名称, 常量名))
        赋值 (常量_旧数组库 [i], 备注, .内容)
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()

快果.未知支持库函数_26 ()
快果.未知支持库函数_27 (相加 (“.版本 2”, #换行符, #换行符), “”)
.计次循环首 (取数组成员数 (常量_旧数组库), i)
    .如果真 (等于 (删全部空 (常量_旧数组库 [i], 常量值), “”))
        到循环尾 ()
    .如果真结束
    
    快果.未知支持库函数_27 (相加 (“.常量 ”, 删尾空 (常量_旧数组库 [i], 常量名称), “, ”))
    快果.未知支持库函数_27 (相加 (删首尾空 (常量_旧数组库 [i], 常量值), “, ”))
    快果.未知支持库函数_27 (相加 (删尾空 (常量_旧数组库 [i], 公开), “, ”))
    赋值 (常量_旧数组库 [i], 备注, 删全部空 (常量_旧数组库 [i], 备注))
    .如果真 (不等于 (常量_旧数组库 [i], 备注, “”))
        快果.未知支持库函数_27 (常量_旧数组库 [i], 备注)
    .如果真结束
    快果.未知支持库函数_27 (#换行符)
.计次循环尾 ()
赋值 (文件号, 打开文件 (“e:\常量收集修改成果.txt”, #重写, ))
写出文本 (文件号, 快果.未知支持库函数_24 ())
关闭文件 (文件号)


.子程序 _选择列表框_重复_常量_列表项被选择, 空白型, , 
.局部变量 J, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 X, 整数型, , , 

赋值 (J, .取项目数值 (.现行选中项))
赋值 (.内容, 常量_旧数组库 [J], 常量值)
.计次循环首 (取数组成员数 (常量_重复_在旧位置), i)
    .如果真 (等于 (常量_重复_在旧位置 [i], J))
        赋值 (X, i)
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
赋值 (.内容, 常量_重复_新组 [X], 常量值)
.判断开始 (等于 (常量_旧数组库 [J], 备注, “”))
    .判断开始 (等于 (常量_重复_新组 [X], 备注, “”))
        返回 ()
    .默认
        赋值 (常量_旧数组库 [J], 备注, 常量_重复_新组 [X], 备注)
    .判断结束
    赋值 (.内容, 常量_旧数组库 [J], 备注)
.判断 (等于 (常量_重复_新组 [X], 备注, “”))
    返回 ()
.默认
    赋值 (.内容, 相加 (常量_旧数组库 [J], 备注, #换行符, “新常量备注为：”, #换行符, 常量_重复_新组 [X], 备注))
.判断结束


.子程序 _超级列表框_列表常量资源_左键单击表项, 空白型, , 
赋值 (., 3)
赋值 (.内容, .取标题 (., 1))
赋值 (.内容, .取标题 (., 2))

相加 (“..常量名称：”, .取标题 (., 0), #换行符).加入文本 ()

.子程序 _按钮_保存常量值_被单击, 空白型, , 


.子程序 _按钮1_被单击, 空白型, , 
赋值 (.内容, “”)


 ' 不属于任何一个程序集、类模块的函数：
