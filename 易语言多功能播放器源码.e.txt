 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 530
    高度 = 430
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.常量 隐藏所有, "“invisible”", 隐藏, 界面模式
.常量 只显示视频或者音频效果, "“none”", 隐藏, 界面模式
.常量 MINI模式, "“mini”", 隐藏, 界面模式
.常量 完整模式, "“full”", 隐藏, 界面模式
.常量 自定义效果, "“custom”", 隐藏, 界面模式
.常量 本媒体剪辑的作者, "“Author”", 隐藏, 项目信息
.常量 位比率, "“Bitrate”", 隐藏, 项目信息(秒为单位)
.常量 版权信息, "“Copyright”", 隐藏, 项目信息
.常量 当前位比率, "“CurrenBitrate”", 隐藏, 项目信息(秒为单位)
.常量 媒体内容的描述, "“Description”", 隐藏, 项目信息
.常量 持续时间, "“Duration”", 隐藏, 项目信息(秒为单位)
.常量 文件大小, "“FileSize”", 隐藏, 项目信息(Bytes为单位)
.常量 文件格式, "“FileType”", 隐藏, 项目信息


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' internet 707ca37322474f6ca841f0e224f4b620 2 0 互联网支持库
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 2 0 多线程支持库
 ' script EDF19861DC454d15BA0B9E3FF9CA4F57 2 0 脚本语言支持组件
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 3 0 应用接口支持库



 ' 所需要的模块
 ' MP3地址歌词搜索模块 F:\我的文档\桌面\mp3lrc.ec
 ' Windows媒体播放器 F:\我的文档\桌面\媒体播放器.ec



.窗口程序集 窗口程序集1, , , 

.程序集变量 当前控件名, 画板, , , 
.程序集变量 新控件名, 画板, , , 
.程序集变量 切换中, 逻辑型, , , 
.程序集变量 窗口目标高度, 小数型, , , 
.程序集变量 窗口加速度, 小数型, , , 
.程序集变量 窗口差值, 小数型, , , 
.程序集变量 窗口速度, 小数型, , , 
.程序集变量 控件差值, 小数型, , , 
.程序集变量 控件加速度, 小数型, , , 
.程序集变量 控件速度, 小数型, , , 
.程序集变量 播放器, 未知类型0x49010197, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (当前控件名, )
赋值 (., 270)
赋值 (., 相加 (当前控件名.顶边, 当前控件名.高度, 40))
赋值 (., 相除 (相减 (取屏幕宽度 (), .), 2))
赋值 (., 相除 (相减 (取屏幕高度 (), .), 2))
播放器.未知函数_67174746 (取窗口句柄 (), 3, 310, 238, 65, 1)
赋值 (., “天气预报”)
赋值 (.起始选择位置, -1)
.判断开始 (等于 (未知支持库函数_52 (), 真))
    _切换按钮1_被单击 ()
    未知支持库函数_0 (&_天气按钮_被单击, , )
    未知支持库函数_0 (&_载入歌曲_被单击, , )
.默认
    信息框 (“请检查网络连接是否正常！”, 0, “连接网络失败！”)
    _切换按钮2_被单击 ()
.判断结束


.子程序 _切换按钮1_被单击, 空白型, , 
切换动画 ()
获取焦点 ()
赋值 (., “天气预报”)
赋值 (.可视, 真)
赋值 (.可视, 假)
赋值 (.可视, 假)

.子程序 _切换按钮2_被单击, 空白型, , 
切换动画 ()
获取焦点 ()
赋值 (., “计算器”)
赋值 (.可视, 假)
赋值 (.可视, 真)
赋值 (.可视, 假)

.子程序 _切换按钮3_被单击, 空白型, , 
切换动画 ()
获取焦点 ()
赋值 (., “音乐播放器”)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 真)

.子程序 切换动画, 空白型, , 
.参数 控件名, 画板, , 

.如果真 (等于 (切换中, 假))
    赋值 (_启动窗口., 控件名)
    赋值 (_启动窗口..左边, 290)
    赋值 (_启动窗口..顶边, 40)
    赋值 (切换中, 真)
    赋值 (.时钟周期, 10)
.如果真结束


.子程序 _动画时钟_周期事件, 空白型, , 
赋值 (窗口目标高度, 相加 (新控件名.顶边, 新控件名.高度, 40))
赋值 (窗口差值, 相减 (窗口目标高度, .))
赋值 (窗口加速度, 相乘 (窗口差值, 0.22))
赋值 (窗口速度, 相加 (窗口速度, 窗口加速度))
赋值 (窗口速度, 四舍五入 (相乘 (窗口速度, 0.6), ))
赋值 (., 相加 (., 窗口速度))
赋值 (., 相除 (相减 (取屏幕高度 (), .), 2))
赋值 (控件差值, 相减 (新控件名.左边, 10))
赋值 (控件加速度, 相乘 (控件差值, 0.22))
赋值 (控件速度, 相加 (控件速度, 控件加速度))
赋值 (控件速度, 四舍五入 (相乘 (控件速度, 0.6), ))
赋值 (新控件名.左边, 相减 (新控件名.左边, 控件速度))
.如果真 (不等于 (当前控件名, 新控件名))
    赋值 (当前控件名.左边, 相减 (新控件名.左边, 290))
.如果真结束
.如果真 (并且 (等于 (控件速度, 0), 等于 (窗口速度, 0)))
    赋值 (切换中, 假)
    赋值 (.时钟周期, 0)
    .如果真 (不等于 (当前控件名, 新控件名))
        赋值 (当前控件名, 新控件名)
    .如果真结束
    
.如果真结束


.子程序 _天气按钮_被单击, 空白型, , 
.局部变量 内容, 文本型, , , 
.局部变量 每条, 文本型, , "0", 
.局部变量 张数, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 结果, 文本型, , , 
.局部变量 开始, 整数型, , , 
.局部变量 结束, 整数型, , , 

赋值 (.禁止, 真)
处理事件 ()
.如果 (等于 (.内容, “”))
    赋值 (内容, 到文本 (未知支持库函数_7 (“http://www.soso.com/tb.q?cid=tb.tq&cin=&city=”)))
.否则
    赋值 (内容, 到文本 (未知支持库函数_7 (相加 (“http://www.soso.com/tb.q?cid=tb.tq&cin=&city=”, .内容))))
.如果结束
赋值 (每条, 分割文本 (内容, “CDATA”, ))
赋值 (张数, 取数组成员数 (每条))
赋值 (.内容, “”)
.计次循环首 (张数, i)
    处理事件 ()
    .如果真 (大于 (i, 1))
        赋值 (开始, 寻找文本 (每条 [i], “[”, 1, 假))
        赋值 (结束, 寻找文本 (每条 [i], “]”, , 假))
        赋值 (结果, 相加 (取文本中间 (每条 [i], 相加 (开始, 1), 相减 (结束, 2)), #换行符))
        .如果真 (等于 (i, 2))
            赋值 (.内容, 相加 (.内容, “当前城市：”))
        .如果真结束
        .如果真 (等于 (i, 3))
            赋值 (.内容, 相加 (.内容, “查询日期：”))
        .如果真结束
        .如果真 (等于 (i, 4))
            赋值 (.内容, 相加 (.内容, #换行符, “今天温度：”))
        .如果真结束
        .如果真 (等于 (i, 5))
            赋值 (.内容, 相加 (.内容, “今天天气：”))
        .如果真结束
        .如果真 (等于 (i, 6))
            赋值 (.内容, 相加 (.内容, “今天风向：”))
        .如果真结束
        .如果真 (等于 (i, 7))
            赋值 (.内容, 相加 (.内容, #换行符, “明天温度：”))
        .如果真结束
        .如果真 (等于 (i, 8))
            赋值 (.内容, 相加 (.内容, “明天天气：”))
        .如果真结束
        .如果真 (等于 (i, 9))
            赋值 (.内容, 相加 (.内容, “明天风向：”))
        .如果真结束
        .如果真 (等于 (i, 10))
            赋值 (.内容, 相加 (.内容, #换行符, “后天温度：”))
        .如果真结束
        .如果真 (等于 (i, 11))
            赋值 (.内容, 相加 (.内容, “后天天气：”))
        .如果真结束
        .如果真 (等于 (i, 12))
            赋值 (.内容, 相加 (.内容, “后天风向：”))
        .如果真结束
        赋值 (.内容, 相加 (.内容, 结果))
    .如果真结束
    
.计次循环尾 ()
赋值 (.禁止, 假)

.子程序 _收缩时钟_周期事件, 空白型, , 
.如果 (或者 (小于 (取鼠标水平位置 (), .), 大于 (取鼠标水平位置 (), 相加 (., .)), 小于 (取鼠标垂直位置 (), .), 大于 (取鼠标垂直位置 (), 相加 (., .))))
    .判断开始 (小于或等于 (., 0))
        移动 (相减 (3, .), , , ) ' 此4为向左边移动窗口后，在左边留出来的位置
    .判断 (大于或等于 (相加 (., .), 取屏幕宽度 ()))
        移动 (相减 (取屏幕宽度 (), 3), , , ) ' ★此5为向右边移动窗口后，在右边留出来的位置＾啵
    .判断 (小于或等于 (., 0))
        移动 (相加 (相减 (0, .), 3), , ) ' 此0不要改，因为他是当窗口的底为顶边，此24为向上移动窗口后，在上面留出来的位置
    .默认
        
    .判断结束
    
.否则
    .判断开始 (小于或等于 (., 0))
        移动 (0, , , )
    .判断 (等于 (., 相减 (取屏幕宽度 (), 3))) ' ★此5为光标向右边移动到屏幕边时，窗口出来。此5与上面的5必须一样
        移动 (相减 (取屏幕宽度 (), .), , , )
    .判断 (小于或等于 (., 0))
        移动 (0, , ) ' 此0为光标向上移动窗口时，窗口顶边的位置，即窗口落下来了＾ω＾
    .默认
        
    .判断结束
    
.如果结束


.子程序 _计算器编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, 13))
    赋值 (.内容, .未知支持库函数_1 (.内容))
    赋值 (_启动窗口., 数值到金额 (到数值 (.内容), 假))
    赋值 (.起始选择位置, -1)
.如果真结束
.如果真 (等于 (键代码, 46))
    赋值 (.内容, “”)
    赋值 (_启动窗口., “计算器”)
.如果真结束
.如果 (或者 (并且 (大于或等于 (键代码, 48), 小于或等于 (键代码, 57)), 等于 (键代码, 8), 等于 (键代码, 107), 等于 (键代码, 189), 等于 (键代码, 106), 等于 (键代码, 191), 等于 (键代码, 190), 等于 (键代码, 37), 等于 (键代码, 38), 等于 (键代码, 39), 等于 (键代码, 40), 等于 (键代码, 17), 等于 (键代码, 67), 等于 (键代码, 86), 等于 (键代码, 16), 等于 (键代码, 187), 等于 (键代码, 88)))
    返回 (真)
.否则
    返回 (假)
.如果结束


.子程序 _天气编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, 13))
    _天气按钮_被单击 ()
.如果真结束


.子程序 _载入歌曲_被单击, 空白型, , 
.局部变量 临时文本, 文本型, , , 
.局部变量 文本, 文本型, , "3", 
.局部变量 临时文体集, 文本型, , "5", 
.局部变量 b1, 空白型, , , 
.局部变量 b2, 空白型, , , 
.局部变量 b3, 空白型, , , 
.局部变量 a1, 空白型, , , 
.局部变量 a2, 空白型, , , 

全部删除 ()
赋值 (临时文本, 到文本 (未知支持库函数_7 (“http://list.mp3.baidu.com/top/top500.html”)))
赋值 (b1, 1)
.计次循环首 (500, b3)
    处理事件 ()
    赋值 (b1, 相加 (寻找文本 (临时文本, “<tr>”, 相加 (b2, 4), 假), 4))
    赋值 (b2, 寻找文本 (临时文本, “</tr>”, b1, 假))
    赋值 (临时文体集, 分割文本 (取文本中间 (临时文本, b1, 相减 (b2, b1)), “</td>”, ))
    .插入表项 ()
    相减 (b3, 1).置标题 (0, 到文本 (b3))
    赋值 (a1, 寻找文本 (临时文体集 [3], “</a>”, , 假)) ' 歌曲名
    赋值 (a2, 相加 (倒找文本 (临时文体集 [3], “>”, a1, 假), 1))
    赋值 (文本 [1], 取文本中间 (临时文体集 [3], a2, 相减 (a1, a2)))
    相减 (b3, 1).置标题 (1, 文本 [1])
    赋值 (a1, 寻找文本 (临时文体集 [4], “</a>”, , 假)) ' 艺术家
    赋值 (a2, 相加 (倒找文本 (临时文体集 [4], “>”, a1, 假), 1))
    赋值 (文本 [2], 取文本中间 (临时文体集 [4], a2, 相减 (a1, a2)))
    相减 (b3, 1).置标题 (2, 文本 [2])
    赋值 (a1, 相加 (寻找文本 (临时文体集 [5], “href=”, , 假), 6)) ' 搜索
    赋值 (a2, 寻找文本 (临时文体集 [5], #引号, 相加 (a1, 6), 假))
    赋值 (文本 [3], 取文本中间 (临时文体集 [5], a1, 相减 (a2, a1)))
    相减 (b3, 1).置标题 (5, 文本 [3])
.计次循环尾 ()

.子程序 _超级列表框2_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (不等于 (., -1))
    播放器.未知函数_67174755 (未知函数_67174872 (.取标题 (., 1), .取标题 (., 2)))
.如果真结束


.子程序 _播放循环时钟_周期事件, 空白型, , 
.判断开始 (等于 (播放器.未知函数_67174756 (), 1))
    赋值 (., 相加 (., 1))
    播放器.未知函数_67174755 (未知函数_67174872 (.取标题 (., 1), .取标题 (., 2)))
.默认
    
.判断结束


.子程序 _播放按钮_被单击, 空白型, , 
赋值 (.禁止, 真)
.判断开始 (等于 (.内容, “”))
    0.选择表项 ()
    播放器.未知函数_67174755 (未知函数_67174872 (.取标题 (., 1), .取标题 (., 2)))
.默认
    播放器.未知函数_67174755 (未知函数_67174872 (.内容, ))
.判断结束
赋值 (.禁止, 假)

.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 获取MP3歌词, 文本型, , 
.参数 搜索名称, 文本型, , 
.参数 搜索歌手, 文本型, 可空, 



.子程序 获取MP3地址, 文本型, , 
.参数 搜索歌曲, 文本型, , 
.参数 搜索歌手, 文本型, 可空, 



.类模块 播放器, , , 

.子程序 创建, 整数型, , 
.参数 父窗口, 整数型, , 
.参数 左边, 整数型, 可空, 
.参数 顶边, 整数型, 可空, 
.参数 宽度, 整数型, 可空, 
.参数 高度, 整数型, 可空, 
.参数 控件ID, 整数型, 可空, 



.子程序 左边, 整数型, , 
.参数 左边, 整数型, 可空, 



.子程序 顶边, 整数型, , 
.参数 顶边, 整数型, 可空, 



.子程序 宽度, 整数型, , 
.参数 宽度, 整数型, 可空, 



.子程序 高度, 整数型, , 
.参数 高度, 整数型, 可空, 



.子程序 移动, 空白型, , 
.参数 左边, 整数型, 可空, 
.参数 顶边, 整数型, 可空, 
.参数 宽度, 整数型, 可空, 
.参数 高度, 整数型, 可空, 



.子程序 可视, 逻辑型, , 
.参数 可视, 逻辑型, 可空, 



.子程序 禁止, 逻辑型, , 
.参数 禁止, 逻辑型, 可空, 



.子程序 销毁, 空白型, , 


.子程序 地址, 文本型, , 可以是网络地址或本地地址
.参数 地址, 文本型, 可空, 



.子程序 取播放状态, 整数型, , 0. 未知状态；1. 播放暂停；2. 播放暂停；3. 正在播放；4. 向前搜索；5. 向后搜索；6. 正在缓冲；7. 等待加载；8. 播放结束；9. 准备新媒体；10. 播放准备就绪；11. 尝试重新连接；12. 上一次状态


.子程序 取打开状态, 整数型, , 0. 不确定；1. 播放列表被改变；2. 正在定位播放列表；3. 正在连接播放列表；4. 正在加载播放列表；5. 正在打开播放列表；6. 播放列表打开；7. 播放列表被改变；8. 媒体被改变；9. 定位媒体10. 连接媒体；11. 加载媒体；12. 正在打开媒体文件；13. 媒体被打开；14. 开始获取编码器；15. 结束编码器获取；16. 开始许可证获取；17. 结束许可证获取；18. 开始个性化设置；19. 结束个性化设置；20. 正在等待；21. 打开未知类型的URL


.子程序 取状态, 文本型, , 


.子程序 取版本信息, 文本型, , 


.子程序 取是否在线, 逻辑型, , 


.子程序 可用, 逻辑型, , 
.参数 可用, 逻辑型, 可空, 



.子程序 全屏模式, 逻辑型, , 
.参数 全屏模式, 逻辑型, 可空, 



.子程序 菜单可用, 逻辑型, , 
.参数 菜单可用, 逻辑型, 可空, 



.子程序 界面模式, 文本型, , 
.参数 界面模式, 文本型, 可空, 



.子程序 自适应尺寸, 逻辑型, , 
.参数 自适应尺寸, 逻辑型, 可空, 



.子程序 无窗口模式, 逻辑型, , 
.参数 无窗口模式, 逻辑型, 可空, 



.子程序 远程模式, 逻辑型, , 
.参数 远程模式, 逻辑型, , 



.子程序 播放, 空白型, , 


.子程序 暂停, 空白型, , 


.子程序 停止, 空白型, , 


.子程序 快进, 空白型, , 


.子程序 快退, 空白型, , 


.子程序 下一个, 空白型, , 


.子程序 前一个, 空白型, , 


.子程序 取当前位置文本, 文本型, , 


.子程序 当前位置, 双精度小数型, , 
.参数 当前位置, 双精度小数型, 可空, 



.子程序 取项目信息, 文本型, , 
.参数 项目名, 文本型, , 



.子程序 置项目信息, 空白型, , 
.参数 项目名, 文本型, , 
.参数 值, 文本型, , 



.子程序 按序取项目信息, 文本型, , 
.参数 lAtom, 整数型, , 



.子程序 取属性的数量, 整数型, , 


.子程序 取播放位置文本, 文本型, , 


.子程序 取播放位置, 整数型, , 


.子程序 取标记数量, 整数型, , 


.子程序 取源图像高度, 整数型, , 


.子程序 取源图像宽度, 整数型, , 


.子程序 取媒体名称, 文本型, , 


.子程序 取源连接, 文本型, , 


.子程序 音量, 整数型, , 音量的范围为0 ~ 100。
.参数 音量, 整数型, 可空, 



.子程序 立体声平衡, 整数型, , 范围为:-100 ~ 100。
.参数 立体声平衡, 整数型, 可空, 



.子程序 播放次数, 整数型, , 
.参数 播放次数, 整数型, 可空, 



.子程序 静音, 逻辑型, , 
.参数 静音, 逻辑型, 可空, 



.子程序 自动播放, 逻辑型, , 
.参数 自动播放, 逻辑型, 可空, 



.子程序 取跳过帧数, 整数型, , 


.子程序 取帧数, 整数型, , 


.子程序 取下载进度, 整数型, , 


.子程序 取最大带宽, 整数型, , 
.参数 最大带宽, 整数型, 可空, 



.子程序 取位比率, 整数型, , 


.子程序 取实际帧数, 整数型, , 


.子程序 缓冲时间, 整数型, , 范围为：0 ~ 60秒，默认为5秒。
.参数 缓冲时间, 整数型, 可空, 



.子程序 取缓冲进度, 整数型, , 


.子程序 取缓冲数量, 整数型, , 


.子程序 取接收质量, 整数型, , 


.子程序 取丢包数, 整数型, , 


.子程序 取已接收数据包, 整数型, , 


.子程序 取被覆盖数据包数, 整数型, , 


.子程序 取带宽, 整数型, , 



 ' 不属于任何一个程序集、类模块的函数：
