 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 420
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假



.常量 HKEY_CLASSES_ROOT, "-2147483648", , 
.常量 HKEY_CURRENT_CONFIG, "-2147483643", , 
.常量 HKEY_CURRENT_USER, "-2147483647", , 
.常量 HKEY_LOCAL_MACHINE, "-2147483646", , 
.常量 HKEY_USERS, "-2147483645", , 
.常量 REG_EXPAND_SZ, "2", , 
.常量 REG_SZ, "1", , 
.常量 REG_MULTI_SZ, "7", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 2 0 扩展界面支持库二
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一





.DLL命令 注册表_打开, 整数型, "advapi32.dll", "RegOpenKeyExA", , 0表示成功
    .参数 根目录, 整数型, , 
    .参数 全路径注册项名, 文本型, , 
    .参数 ulOptions, 整数型, , 设为0
    .参数 要进行的操作, 整数型, , 
    .参数 句柄, 整数型, 传址, 打开后返回的句柄

.DLL命令 注册表_取值, 整数型, "advapi32.dll", "RegQueryValueExA", , 0表示成功
    .参数 已打开的句柄, 整数型, , 
    .参数 要取值的键值, 文本型, , 
    .参数 未用, 整数型, , 设为0
    .参数 取回数据类型的变量, 整数型, 传址, 
    .参数 取回数值的缓冲区, 文本型, 传址, 
    .参数 缓冲区长度, 整数型, 传址, 

.DLL命令 注册表_关闭, 整数型, "advapi32.dll", "RegCloseKey", , 0表示成功
    .参数 要关闭的句柄, 整数型, , 

.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 图标组, 字节集, , , 

赋值 (., 子程序_读取注册表关联图标 (“c:\SkinH_EL.7z”, 16, 16))
 ' 超级列表框1.图片组 ＝ 合并图片组 (超级列表框1.图片组, 子程序_读取注册表关联图标 (“c:\setp.exe”, 16, 16))
赋值 (., 未知支持库函数_25 (., 子程序_读取注册表关联图标 (“c:\CDlinux”, 16, 16)))
 ' 输出调试文本 (取图片组图片数 (超级列表框1.图片组))
.插入表项 (0, , , )
.插入表项 (1, , , )
 ' 超级列表框1.插入表项 (, , 2, , , )

.子程序 子程序_读取注册表关联图标, 字节集, , 返回一个字节集型的图标,可以利用"合并图片组"命令添加到超级列表框的图片组
.参数 文件名, 文本型, , 完整路径名
.参数 图标宽度, 整数型, , 
.参数 图标高度, 整数型, , 

.局部变量 文件类型, 文本型, , , 
.局部变量 注册文件类型名, 文本型, , , 
.局部变量 注册表中图标信息, 文本型, , , 
.局部变量 图标位置, 文本型, , "2", 
.局部变量 取得的图标, 字节集, , , 
.局部变量 注册表句柄, 整数型, , , 
.局部变量 数据类型, 整数型, , , 
.局部变量 是文件, 逻辑型, , , 

 ' 获取文件类型
.如果 (等于 (文件是否存在 (文件名), 真))
    赋值 (是文件, 取反 (取字节集数据 (到字节集 (位与 (取文件属性 (文件名), #子目录)), #逻辑型, )))
.否则
     ' 文件不存在视为普通文件
    赋值 (是文件, 真)
.如果结束

.如果 (等于 (是文件, 真))
    赋值 (注册文件类型名, 取文本右边 (文件名, 相加 (相减 (取文本长度 (文件名), 倒找文本 (文件名, “.”, , 假)), 1)))
    赋值 (文件类型, 取空白文本 (255))
    赋值 (注册表_打开 (#HKEY_CLASSES_ROOT, 注册文件类型名, 0, 1, 注册表句柄), 0)
    注册表_取值 (注册表句柄, “”, 0, 数据类型, 文件类型, 255) ' 0表示成功
    注册表_关闭 (注册表句柄)
.否则
    赋值 (文件类型, “directory”)
.如果结束

.如果真 (不等于 (注册表_打开 (#HKEY_CLASSES_ROOT, 相加 (文件类型, “\\defaulticon”), 0, 1, 注册表句柄), 0))
    注册表_打开 (#HKEY_CLASSES_ROOT, “unknown\\defaulticon”, 0, 1, 注册表句柄)
.如果真结束
赋值 (注册表中图标信息, 取空白文本 (255))
.如果 (等于 (注册表_取值 (注册表句柄, “”, 0, 数据类型, 注册表中图标信息, 255), 0)) ' 0表示成功
     ' 获取图标的具体位置
    .判断开始 (等于 (“%1”))
         ' 直接读取文件中的图标
        赋值 ( [1], )
        赋值 ( [2], “0”)
    .默认
        赋值 (图标位置, 分割文本 (注册表中图标信息, “,”, ))
    .判断结束
    
.否则
     ' 读取错误时
    赋值 (图标位置 [1], “c:\windows\system32\shell32.dll”)
    赋值 ( [2], “0”)
    
.如果结束

赋值 (取得的图标, 未知支持库函数_30 (图标宽度, 图标高度))
未知支持库函数_26 (取得的图标, 图标位置 [1], 到数值 (图标位置 [2]), 真)
注册表_关闭 (注册表句柄)
返回 (取得的图标)



 ' 不属于任何一个程序集、类模块的函数：
