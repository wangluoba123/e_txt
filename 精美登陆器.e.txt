 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 706
    高度 = 504
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\精美登陆器.e\_启动窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “bx道online”
    帮助文件名 = “”

窗口 _账号管理
    左边 = 50
    顶边 = 50
    宽度 = 323
    高度 = 232
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “账号管理”
    帮助文件名 = “”



.图片 ckclient, " ' 已保存到：D:\易语言学习\Data\精美登陆器.e\ckclient", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库
 ' HtmlView 5014D8FA6DCA40b68FA626D8183666EB 1 1 超文本浏览框支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 1 1 多线程支持库
 ' internet 707ca37322474f6ca841f0e224f4b620 1 0 互联网支持库



 ' 所需要的模块
 ' 进度下载模块 E:\e[4.03]\ecom\求真进度下载模块.ec


数据类型 私服结构, , 
    .成员 服务器ip, 文本型, , , 
    .成员 服务器端口, 文本型, , , 
    .成员 服务器名称, 文本型, , , 

.全局变量 私服列表, 私服结构, , "0", 

.窗口程序集 窗口程序集1, , , 

.子程序 _图形按钮1_被单击, 空白型, , 
赋值 (., 2)

.子程序 _图形按钮6_被单击, 空白型, , 
未知支持库函数_56 (“http://www.qnian.cn”)

.子程序 _图形按钮2_被单击, 空白型, , 
销毁 ()

.子程序 __启动窗口_创建完毕, 空白型, , 




.子程序 读取列表, 空白型, , 
.局部变量 文件号, 整数型, , , 
.局部变量 文本, 文本型, , "0", 
.局部变量 temp, 私服结构, , , 

赋值 (文件号, 打开文件 (相加 (取运行目录 (), “\john.dll”), #读写, #无限制))
.如果真 (不等于 (文件号, 0))
    .判断循环首 (等于 (是否在文件尾 (文件号, 真), 假))
        赋值 (文本, 分割文本 (读入一行 (文件号), “,”, ))
        .如果真 (大于 (取数组下标 (文本, ), 1))
            文本.加入项目 ( [3], )
            赋值 (temp.服务器ip, 文本 [1])
            赋值 (temp.服务器端口, 文本 [2])
            赋值 (temp.服务器名称, 文本 [3])
            加入成员 (私服列表, temp)
        .如果真结束
        
    .判断循环尾 ()
    关闭文件 (文件号)
.如果真结束
赋值 (.现行选中项, 0)

.子程序 _图形按钮3_被单击, 空白型, , 
.局部变量 列表索引, 整数型, , , 
.局部变量 i, 整数型, , , 

赋值 (列表索引, 相加 (.现行选中项, 1))
.如果 (文件是否存在 (相加 (取运行目录 (), “\logon.bmp”)))
    .如果真 (等于 (文件是否存在 (相加 (取运行目录 (), “\John.dat”)), 假))
        写到文件 (相加 (取运行目录 (), “\John.dat”), #ckclient)
    .如果真结束
    写配置项 (相加 (取运行目录 (), “\ClientIni.ini”), “CLIENT”, “NAMEOFLEND”, 私服列表 [列表索引], 服务器名称)
    写配置项 (相加 (取运行目录 (), “\CPatch.ini”), “PATCH”, “DIV_ADDRESS”, 私服列表 [列表索引], 服务器ip)
    写配置项 (相加 (取运行目录 (), “\CPatch.ini”), “PATCH”, “PATCH_ADDRESS”, 私服列表 [列表索引], 服务器ip)
    运行 (相加 (取运行目录 (), “\John.dat”), 假, )
    销毁 ()
.否则
    信息框 (“请把登陆器放到千年游戏目录下”, 相加 (0, #信息图标), )
    销毁 ()
.如果结束


.子程序 _图形按钮5_被单击, 空白型, , 
载入 (_账号管理, , 真)


.子程序 在线更新, 空白型, , 
.局部变量 http文本, 文本型, , , 
.局部变量 文本, 文本型, , "0", 
.局部变量 config, 文本型, , "0", 
.局部变量 文件句柄, 整数型, , , 
.局部变量 clientver, 文本型, , , 
.局部变量 下载文件, 字节集, , , 
.局部变量 c, 文本型, , , 
.局部变量 i, 整数型, , , 

赋值 (http文本, 到文本 (未知支持库函数_7 (“http://127.0.0.1/update/up.txt”)))
赋值 (文本, 分割文本 (http文本, #换行符, ))
赋值 (config, 分割文本 (文本 [1], “|”, ))
赋值 (文件句柄, 打开文件 (相加 (取运行目录 (), “\john.dll”), #读入, #无限制))
.判断循环首 (等于 (是否在文件尾 (文件句柄, 真), 假))
    赋值 (clientver, 读入一行 (文件句柄))
.判断循环尾 ()
关闭文件 (文件句柄)
.如果 (不等于 (clientver, config [1]))
    .计次循环首 (相减 (取数组下标 (文本, ), 1), i)
        赋值 (c, 文本 [相加 (i, 1)])
        赋值 (下载文件, 进度下载 (config [2], 相加 (“update\”, c), 假, , , , , , , ))
        写到文件 (相加 (取运行目录 (), “\”, c), 下载文件)
    .计次循环尾 ()
    赋值 (.标题, “登陆器更新完毕!!”)
    读取列表 ()
.否则
    赋值 (.标题, “您的登陆器是最新版本!”)
    读取列表 ()
.如果结束


.子程序 __启动窗口_首次激活, 空白型, , 
在线更新 ()

.窗口程序集 窗口程序集2, , , 

.程序集变量 服务器ip, 文本型, , , 
.程序集变量 服务器名称, 文本型, , , 
.子程序 __账号管理_创建完毕, 空白型, , 
程序初始化 ()

.子程序 程序初始化, 空白型, , 
.局部变量 列表索引, 整数型, , , 

赋值 (列表索引, 相加 (_启动窗口..现行选中项, 1))
赋值 (服务器名称, 私服列表 [列表索引], 服务器名称)
赋值 (服务器ip, 私服列表 [列表索引], 服务器ip)
赋值 (., 相加 (服务器名称, “ - 注册账号”))
未知支持库函数_0 (&连接服务器, 1)

.子程序 连接服务器, 空白型, , 
.如果 (等于 (服务器ip.连接 (3200), 真))
    1.置文本 (“服务器连接账号管理服务器成功！”)
.否则
    1.置文本 (“服务器连接账号管理服务器失败！”)
.如果结束


.子程序 _注册确定_被单击, 空白型, , 
.如果 (或者 (等于 (1.取文本 (), “服务器连接账号管理服务器失败！”), 等于 (1.取文本 (), “正在连接中，请稍候。。。”)))
    信息框 (“正在连接服务器，或者连接失败！”, 相加 (0, #警告图标), )
.否则
    .如果 (或者 (等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”)))
        信息框 (“请完整填写信息！”, 相加 (0, #警告图标), )
    .否则
        .如果 (不等于 (.内容, .内容))
            信息框 (“两次密码不一样！”, 相加 (0, #警告图标), )
        .否则
            相加 (“注册账号|”, .内容, “|”, .内容, “|”, .内容, “|”, .内容).发送数据 ()
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 _修改确定_被单击, 空白型, , 
.如果 (或者 (等于 (1.取文本 (), “服务器连接账号管理服务器失败！”), 等于 (1.取文本 (), “正在连接中，请稍候。。。”)))
    信息框 (“正在连接服务器，或者连接失败！”, 相加 (0, #警告图标), )
.否则
    .如果 (或者 (等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”)))
        信息框 (“请完整填写信息！”, 相加 (0, #警告图标), )
    .否则
        .如果 (不等于 (.内容, .内容))
            信息框 (“两次密码不一样！”, 相加 (0, #警告图标), )
        .否则
            相加 (“修改密码|”, .内容, “|”, .内容, “|”, .内容).发送数据 ()
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 _找回确定_被单击, 空白型, , 
.如果 (或者 (等于 (1.取文本 (), “服务器连接账号管理服务器失败！”), 等于 (1.取文本 (), “正在连接中，请稍候。。。”)))
    信息框 (“正在连接服务器，或者连接失败！”, 相加 (0, #警告图标), )
.否则
    .如果 (或者 (等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”)))
        信息框 (“请完整填写信息！”, 相加 (0, #警告图标), )
    .否则
        .如果 (不等于 (.内容, .内容))
            信息框 (“两次密码不一样！”, 相加 (0, #警告图标), )
        .否则
            相加 (“找回密码|”, .内容, “|”, .内容, “|”, .内容, “|”, .内容).发送数据 ()
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 _客户1_数据到达, 空白型, , 
.局部变量 到达数据, 文本型, , , 

赋值 (到达数据, 到文本 (取回数据 ()))
.如果真 (等于 (到达数据, “注册成功”))
    1.置文本 (“注册成功，请妥善保管您的账号！”)
.如果真结束
.如果真 (等于 (到达数据, “账号重复”))
    1.置文本 (“注册失败，账号重复，请更换账号！”)
.如果真结束
.如果真 (等于 (到达数据, “修改成功”))
    1.置文本 (“恭喜您，修改密码成功！”)
.如果真结束
.如果真 (等于 (到达数据, “修改失败”))
    1.置文本 (“修改失败，请重新填写信息！”)
.如果真结束
.如果真 (等于 (到达数据, “找回成功”))
    1.置文本 (“恭喜您，找回密码成功！”)
.如果真结束
.如果真 (等于 (到达数据, “找回失败”))
    1.置文本 (“找回失败，请重新填写信息！”)
.如果真结束


.子程序 __账号管理_将被销毁, 空白型, , 
断开连接 ()

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _按钮4_被单击, 空白型, , 
销毁 ()

.子程序 _按钮6_被单击, 空白型, , 
销毁 ()

.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 进度下载, 字节集, , 
.参数 网址, 文本型, , 如：www.qzsa.net
.参数 路径, 文本型, , 如：file/123.zip
.参数 下载方式, 逻辑型, 可空, 真：续传。假：重新下载。默认为假
.参数 超时设置, 整数型, 可空, 如果小于0就不进行超时处理，单位：秒。为0或不进行设置时，则默认为300秒(5分钟)。不要设得太小，也不要设得太大。
.参数 进度条, 进度条, 参考 可空, 这个不用说了吧？
.参数 文件尺寸, 标签, 参考 可空, 单位：字节（Bit）
.参数 下载状态, 标签, 参考 可空, 
.参数 已下载, 标签, 参考 可空, 单位：字节（Bit）
.参数 下载速度, 标签, 参考 可空, 单位：KB/S
.参数 剩余时间, 标签, 参考 可空, 单位：秒



.子程序 取消下载, 空白型, , 


.子程序 连线测试, 逻辑型, , 未连接Internet返回假，反之返回真
.参数 网址, 文本型, 可空, 如果指定网址，将检测该网址是否能连接。如不指定，将检查是否已连接Internet




 ' 不属于任何一个程序集、类模块的函数：
