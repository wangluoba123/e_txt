 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假



.常量 常量1, "“@cls
@title 无法确认当前用户是否合法。
@ECHO 为防止非法用户，CMD已被管理员禁用，如果您是合法用户，请联系管理员.
@echo 按任意键退出......
@pause>nul
@exit”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库




数据类型 项目标识符列表_, , ITEMIDLIST
    .成员 结构大小, 整数型, , , cb
    .成员 标识符长度, 字节型, , "255", abID


.DLL命令 api获取特别文件夹位置, 整数型, "shell32.dll", "SHGetSpecialFolderLocation", , 
    .参数 窗口句柄, 整数型, , hwndOwner
    .参数 文件夹位置, 整数型, , nFolder
    .参数 结构, 项目标识符列表_, 传址, pIdl

.DLL命令 api从列表id取路径, 整数型, "", "SHGetPathFromIDListA", , $(b)
    .参数 结构指针, 整数型, , pIdl
    .参数 路径, 文本型, 传址, pszPath

.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 


.子程序 _按钮1_被单击, 空白型, , 
写注册项 (#本地机器, “SOFTWARE\Microsoft\Command Processor\AutoRun”, “tswl.cmd”)
写到文件 (相加 (模块1取特定目录 (37), “\tswl.cmd”), 到字节集 (#常量1))
赋值 (., “已禁用”)

.子程序 _按钮2_被单击, 空白型, , 
写注册项 (#本地机器, “SOFTWARE\Microsoft\Command Processor\AutoRun”, “”)
删除文件 (相加 (模块1取特定目录 (37), “\tswl.cmd”))
赋值 (., “已解禁”)


.子程序 模块1取特定目录, 文本型, , 抄自外挂海模块
.参数 欲获取目录类型, 整数型, 可空, 

.局部变量 路径, 文本型, , , 
.局部变量 标示结构, 项目标识符列表_, , , 
.局部变量 目录类型, 整数型, , , 

.如果真 (等于 (欲获取目录类型, 99))
    输出调试文本 (“0我的桌面 2我的程序 5我的文档 6我的收藏夹 7我的启动 8我最近的文档 9我的发送到 11我的开始菜单 13我的音乐 14我的视频 16我的桌面 20系统字体 22开始菜单组 23程序组 24启动组 25桌面 31收藏夹 32我的浏览器临时目录 33我的Cookies 34我的历史记录 36Windows安装目录 37系统目录 38文件安装目录 39我的图片 40用户目录 41系统目录 46文档 47管理工具 48我的管理工具 53音乐 54图片 55视频”)
.如果真结束
.如果 (等于 (欲获取目录类型, 1))
    赋值 (目录类型, 34)
.否则
    赋值 (目录类型, 欲获取目录类型)
.如果结束

api获取特别文件夹位置 (0, 目录类型, 标示结构)
赋值 (路径, 取空白文本 (255))
api从列表id取路径 (标示结构.结构大小, 路径)
.如果真 (等于 (路径, “”))
    返回 (“”)
.如果真结束
.如果真 (等于 (欲获取目录类型, 1))
    赋值 (路径, 子文本替换 (路径, “History”, “Temp”, , , 真))
.如果真结束
返回 (路径)


 ' 不属于任何一个程序集、类模块的函数：
