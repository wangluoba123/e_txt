 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 966
    高度 = 273
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “mp3复读软件-李智勇(164565877)”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 6 系统核心支持库





.DLL命令 取短文件名, 整数型, "kernel32.dll", "GetShortPathNameA", , 
    .参数 长文件名, 文本型, , 
    .参数 短文件名, 文本型, , 
    .参数 缓冲区长度, 整数型, , 

.DLL命令 发送指令, 整数型, "winmm.dll", "mciSendStringA", , 
    .参数 参数1, 文本型, , 
    .参数 参数2, 文本型, , 
    .参数 参数3, 整数型, , 
    .参数 参数4, 整数型, , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 设备, 文本型, , , 
.程序集变量 复读长度原位置, 整数型, , , 
.程序集变量 左边指针原位置, 整数型, , , 
.程序集变量 右边指针原位置, 整数型, , , 
.程序集变量 复读长度原宽度, 整数型, , , 
.程序集变量 游标最大位置, 整数型, , , 
.程序集变量 游标单位刻度值, 双精度小数型, , , 
.程序集变量 游标左边原位置, 整数型, , , 
.程序集变量 左边界, 整数型, , , 播放时间
.程序集变量 右边界, 整数型, , , 
.程序集变量 跳到播放, 整数型, , , 
.程序集变量 游标顶边原位置, 整数型, , , 
.程序集变量 左边指针顶边原位置, 整数型, , , 
.程序集变量 右边指针顶边原位置, 整数型, , , 
.程序集变量 时间标签顶边原位置, 整数型, , , 
.程序集变量 文件长度, 双精度小数型, , , 
.子程序 _打开_被单击, 空白型, , 
.局部变量 文件长度, 文本型, , , 
.局部变量 代码, 整数型, , , 
.局部变量 信息长度, 整数型, , , 
.局部变量 信息, 文本型, , , 

赋值 (., “请选择音乐文件”)
赋值 (., “MP3(*.mp3);WAV(*.wav)|*.MP3;*.wav”)
.如果 (打开 ())
    赋值 (., .)
    赋值 (设备, 取空白文本 (255))
    取短文件名 (., 设备, 255)
    赋值 (文件长度, 取空白文本 (255))
    赋值 (代码, 发送指令 (相加 (“status ”, 设备, “ length”), 文件长度, 255, 0))
    .如果 (等于 (代码, 0))
        赋值 (文件长度, 取文本左边 (文件长度, 8))
        赋值 (游标最大位置, 到数值 (文件长度))
        赋值 (文件长度, 到文本 (整除 (到数值 (文件长度), 1000)))
        赋值 (左边界, 0)
        赋值 (右边界, 游标最大位置)
        输出调试文本 (游标最大位置)
        赋值 (游标单位刻度值, 相除 (游标最大位置, 900))
        输出调试文本 (游标单位刻度值)
        赋值 (文件长度, 相加 (到文本 (整除 (到数值 (文件长度), 60)), “分”, 到文本 (相减 (到数值 (文件长度), 相乘 (整除 (到数值 (文件长度), 60), 60))), “秒”))
        赋值 (., 相加 (“时间总长：”, 文件长度))
        
    .否则
        
    .如果结束
    
    
.否则
    
.如果结束


.子程序 _播放按钮_被单击, 空白型, , 
.局部变量 状态, 文本型, 静态, , 


赋值 (状态, 取空白文本 (255))
发送指令 (相加 (“status ”, 设备, “ mode”), 状态, 255, 0)
.判断开始 (等于 (到小写 (状态), “stopped”))
    发送指令 (相加 (“open ”, 设备), “”, 0, 0)
    发送指令 (相加 (“play ”, 设备), “”, 0, 0)
    赋值 (., “暂停”)
    赋值 (., “当前状态：正在播放”)
    赋值 (., 50)
.判断 (等于 (到小写 (状态), “playing”))
    发送指令 (相加 (“pause ”, 设备), “”, 0, 0)
    赋值 (., “播放”)
    赋值 (., “当前状态：暂停播放”)
    赋值 (., 0)
.判断 (等于 (到小写 (状态), “paused”))
    发送指令 (相加 (“resume ”, 设备), “”, 0, 0)
    赋值 (., “暂停”)
    赋值 (., “当前状态：正在播放”)
    赋值 (., 1000)
.默认
    
.判断结束
 ' MCI_STATUS_POSITION

.子程序 _时钟_周期事件, 空白型, , 
.局部变量 状态, 文本型, , , 
.局部变量 ls, 整数型, , , 
.局部变量 aa, 文本型, , , 
.局部变量 文件长度, 双精度小数型, , , 
.局部变量 匿名局部变量_232, 空白型, , , 

赋值 (状态, 取空白文本 (255))
未知函数_167837871 (相加 (“status ”, , “ POSITION”), , 255, 0)
赋值 (., 相加 (游标左边原位置, 相除 (到数值 (状态), 游标单位刻度值)))
赋值 (文件长度, 整除 (到数值 (状态), 1000))
赋值 (., 相加 (到文本 (整除 (文件长度, 60)), “分”, 到文本 (相减 (文件长度, 相乘 (整除 (文件长度, 60), 60))), “秒”))
赋值 (., .)
.如果真 (等于 (., 真))
    .如果真 (大于 (到数值 (状态), 右边界))
        赋值 (跳到播放, 左边界)
        
        输出调试文本 ()
        .如果 (等于 (., “暂停”))
            赋值 (., 0)
            未知函数_167837913 (相加 (“seek ”, , “ to ”, 到文本 ()), “”, 0, 0)
            未知函数_167837913 (相加 (“play ”, ), “”, 0, 0)
            赋值 (., 1000)
        .否则
            未知函数_167837913 (相加 (“seek ”, , “ to ”, 到文本 ()), “”, 0, 0)
        .如果结束
        赋值 (., .)
        
    .如果真结束
    
.如果真结束
.如果真 (大于或等于 (到数值 (状态), 游标最大位置))
    _停止按钮_被单击 ()
.如果真结束


.子程序 _停止按钮_被单击, 空白型, , 
发送指令 (相加 (“stop ”, 设备), “”, 0, 0)
发送指令 (相加 (“close ”, 设备), “”, 0, 0)
赋值 (., “播放”)
赋值 (., “当前状态：停止播放”)
赋值 (., 0)
赋值 (., 游标左边原位置)
赋值 (., 900)
赋值 (., .)
赋值 (., “”)
赋值 (., “”)
赋值 (., “”)
赋值 (., “”)

赋值 (., “”)

.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (., .)
赋值 (., .)
赋值 (., .)
赋值 (复读长度原位置, .)
赋值 (复读长度原宽度, .)
赋值 (左边指针原位置, .)
赋值 (左边指针顶边原位置, .)
赋值 (右边指针原位置, .)
赋值 (右边指针顶边原位置, .)
赋值 (游标左边原位置, .)
赋值 (游标顶边原位置, .)
赋值 (时间标签顶边原位置, .)
赋值 (., “”)
赋值 (., “”)
赋值 (., “”)

 ' 输出调试文本 (右边指针.左边 － 左边指针.左边)
输出调试文本 (相加 (到文本 (.), “  左边指针”, 到文本 (.), “   ”, “右边指针”, 到文本 (.), “长度  ”, 到文本 (相减 (., .))))

.子程序 _指针时钟_周期事件, 空白型, , 
赋值 (., “”)

.子程序 _开始复读_被单击, 空白型, , 

.如果 (等于 (., 真))
    赋值 (., 假)
    赋值 (., 左边指针原位置)
    赋值 (., 右边指针原位置)
    赋值 (., 复读长度原宽度)
    赋值 (., “开始复读”)
.否则
    赋值 (., 真)
    赋值 (., “停止复读”)
    赋值 (., 相加 (“复读时长： ”, 子文本替换 (., “时间总长：”, , , , 真)))
    赋值 (., “复读开始时间： 0”)
    赋值 (., 相加 (“复读结束时间：”, 子文本替换 (., “时间总长：”, , , , 真)))
    
.如果结束


.子程序 _左边指针_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 状态, 整数型, , , 

.如果真 (等于 (., 真))
    161.发送信息 (2, 0)
    赋值 (., 左边指针顶边原位置)
    .如果 (大于 (., .))
        赋值 (., 相减 (., 10))
        赋值 (., 10)
        赋值 (., 相加 (相减 (., 左边指针原位置), 复读长度原位置))
    .否则
        赋值 (., 相加 (相减 (., ), ))
        赋值 (., 相减 (., .))
        
    .如果结束
    
    .如果真 (小于 (., .))
        赋值 (., 相加 (., 5))
        .如果 (大于 (., 相减 (相加 (., .), 15)))
            未知函数_67174588 ()
            赋值 (., 相加 (900))
        .否则
            赋值 (相乘 (相减 (., 游标左边原位置), 游标单位刻度值))
            
            输出调试文本 ()
            .如果 (等于 (., “暂停”))
                赋值 (., 0)
                未知函数_167837885 (相加 (“seek ”, , “ to ”, 到文本 ()), “”, 0, 0)
                未知函数_167837885 (相加 (“play ”, ), “”, 0, 0)
                赋值 (., 1000)
            .否则
                未知函数_167837885 (相加 (“seek ”, , “ to ”, 到文本 ()), “”, 0, 0)
            .如果结束
            赋值 (., 相减 (取鼠标水平位置 (), 250))
        .如果结束
        
    .如果真结束
    
    赋值 (左边界, 相乘 (相减 (., 复读长度原位置), 游标单位刻度值))
    赋值 (文件长度, 整除 (左边界, 1000))
    赋值 (., 相加 (“复读开始时间： ”, 到文本 (整除 (文件长度, 60)), “分”, 到文本 (相减 (文件长度, 相乘 (整除 (文件长度, 60), 60))), “秒”))
    赋值 (文件长度, 整除 (相减 (右边界, 左边界), 1000))
    赋值 (., 相加 (“复读时长： ”, 到文本 (整除 (文件长度, 60)), “分”, 到文本 (相减 (文件长度, 相乘 (整除 (文件长度, 60), 60))), “秒”))
.如果真结束


.子程序 _右边指针_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (., 真))
    161.发送信息 (2, 0)
    赋值 (., 右边指针顶边原位置)
    .如果 (小于 (., .))
        赋值 (., 相加 (., 10))
        赋值 (., 10)
    .否则
        赋值 (., 相减 (., .))
        
    .如果结束
    .如果真 (大于 (., .))
        赋值 (跳到播放, 左边界)
        输出调试文本 ()
        .如果 (等于 (., “暂停”))
            赋值 (., 0)
            未知函数_167837902 (相加 (“seek ”, , “ to ”, 到文本 ()), “”, 0, 0)
            未知函数_167837902 (相加 (“play ”, ), “”, 0, 0)
            赋值 (., 1000)
        .否则
            未知函数_167837902 (相加 (“seek ”, , “ to ”, 到文本 ()), “”, 0, 0)
        .如果结束
        赋值 (., .)
        
    .如果真结束
    赋值 (右边界, 相乘 (相减 (相加 (., .), 复读长度原位置), 游标单位刻度值))
    赋值 (文件长度, 整除 (右边界, 1000))
    赋值 (., 相加 (“复读结束时间： ”, 到文本 (整除 (文件长度, 60)), “分”, 到文本 (相减 (文件长度, 相乘 (整除 (文件长度, 60), 60))), “秒”))
    赋值 (整除 (相减 (), 1000))
    赋值 (., 相加 (“复读时长： ”, 到文本 (整除 (60)), “分”, 到文本 (相减 (相乘 (整除 (60), 60))), “秒”))
    
.如果真结束


.子程序 _游标_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (或者 (等于 (., “暂停”), 小于 (., 相加 (., .))))
    161.发送信息 (2, 0)
    赋值 (., 游标顶边原位置)
    .如果 (大于 (., 相减 (相加 (., .), 15)))
        _停止按钮_被单击 ()
        赋值 (., 相加 (游标左边原位置, 900))
    .否则
         ' 游标.左边 ＝ 游标左边原位置 ＋ 到数值 (状态) ÷ 游标单位刻度值
        赋值 (相乘 (相减 (., 游标左边原位置), 游标单位刻度值))
        输出调试文本 ()
        .如果 (等于 (., “暂停”))
            赋值 (., 0)
            未知函数_167837877 (相加 (“seek ”, , “ to ”, 到文本 ()), “”, 0, 0)
            未知函数_167837877 (相加 (“play ”, ), “”, 0, 0)
            赋值 (., 1000)
        .否则
            未知函数_167837877 (相加 (“seek ”, , “ to ”, 到文本 ()), “”, 0, 0)
        .如果结束
        赋值 (., 相减 (取鼠标水平位置 (), 250))
    .如果结束
    
.如果真结束



 ' 不属于任何一个程序集、类模块的函数：
