 ' 文件类型：Windows模块源码

 ' 程序名称：磁盘操作
 ' 程序描述：模块_创建多级目录
模块_取文件夹尺寸
模块_复制文件夹
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库





.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。


.子程序 模块_取文件夹尺寸, 双精度小数型, , 失败返回-1
.参数 文件夹路径, 文本型, , 
.参数 子文件夹数量, 整数型, 参考 可空, 提供变量，保存子文件夹数量
.参数 子文件数量, 整数型, 参考 可空, 提供变量，子文件数量
.参数 是否处理事件, 逻辑型, , 

.局部变量 路径数组, 文本型, , "0", 

.如果真 (大于 (取文本长度 (文件夹路径), 3))
    .如果真 (等于 (寻找文件 (文件夹路径, 相加 (#系统文件, #隐藏文件, #只读文件, #存档文件, #子目录)), “”)) ' 没有此文件或文件夹
        返回 (-1)
    .如果真结束
    .如果真 (等于 (寻找文件 (文件夹路径, #子目录), “”)) ' 如果是文件
        返回 (取文件尺寸 (文件夹路径))
    .如果真结束
    
.如果真结束

加入成员 (路径数组, 文件夹路径)
.如果真 (不等于 (取文本右边 (路径数组 [1], 1), “\”))
    赋值 (路径数组 [1], 相加 (路径数组 [1], “\”))
.如果真结束
.判断开始 (并且 (等于 (是否为空 (子文件夹数量), 真), 等于 (是否为空 (子文件数量), 真)))
    返回 (寻找文件夹_无子文件夹无子文件 (路径数组, 是否处理事件))
.判断 (并且 (等于 (是否为空 (子文件夹数量), 假), 等于 (是否为空 (子文件数量), 真)))
    返回 (寻找文件夹_有子文件夹无子文件 (路径数组, 子文件夹数量, 是否处理事件))
.判断 (并且 (等于 (是否为空 (子文件夹数量), 真), 等于 (是否为空 (子文件数量), 假)))
    返回 (寻找文件夹_无子文件夹有子文件 (路径数组, 子文件数量, 是否处理事件))
.判断 (并且 (等于 (是否为空 (子文件夹数量), 假), 等于 (是否为空 (子文件数量), 假)))
    返回 (寻找文件夹_有子文件夹有子文件 (路径数组, 子文件夹数量, 子文件数量, 是否处理事件))
.默认
    
.判断结束
返回 (-1)

.子程序 模块_复制文件夹, 逻辑型, 公开, 成功返回真，失败返回假
.参数 被复制的文件夹, 文本型, , 
.参数 复制到的文件夹, 文本型, , 
.参数 是否处理事件, 逻辑型, , 

.局部变量 路径, 文本型, , , 
.局部变量 被复制的文件夹数组, 文本型, , "0", 
.局部变量 复制到的文件夹文本, 文本型, , , 

.如果真 (等于 (寻找文件 (被复制的文件夹, #子目录), “”))
    .如果真 (不等于 (寻找文件 (被复制的文件夹, 相加 (#存档文件, #只读文件, #隐藏文件, #系统文件)), “”))
        返回 (复制文件 (被复制的文件夹, 复制到的文件夹))
    .如果真结束
    返回 (假)
.如果真结束
.如果真 (并且 (等于 (创建目录 (复制到的文件夹), 假), 等于 (寻找文件 (复制到的文件夹, #子目录), “”), 等于 (位与 (取文件属性 (复制到的文件夹), #子目录), 0), 大于 (取文本长度 (复制到的文件夹), 3)))
    返回 (假)
.如果真结束
赋值 (路径, 被复制的文件夹)
.如果真 (不等于 (取文本右边 (路径, 1), “\”))
    赋值 (路径, 相加 (路径, “\”))
.如果真结束
加入成员 (被复制的文件夹数组, “”)
赋值 (复制到的文件夹文本, 复制到的文件夹)
.如果真 (不等于 (取文本右边 (复制到的文件夹文本, 1), “\”))
    赋值 (复制到的文件夹文本, 相加 (复制到的文件夹文本, “\”))
.如果真结束
返回 (复制文件夹 (路径, 被复制的文件夹数组, 复制到的文件夹文本, 是否处理事件))

.子程序 模块_创建多级目录, 整数型, , 1：创建失败 2：目录已经存在 0：创建成功
.参数 目录完整路径, 文本型, , 

.局部变量 文件夹名称组, 文本型, , "0", 
.局部变量 数组成员数量, 整数型, , , 
.局部变量 临时文本, 文本型, , , 
.局部变量 计次变量, 整数型, , , 

复制数组 (文件夹名称组, 分割文本 (目录完整路径, “\”, ))
赋值 (数组成员数量, 取数组成员数 (文件夹名称组))
.如果真 (小于 (数组成员数量, 2))
    返回 (1)
.如果真结束
赋值 (临时文本, 文件夹名称组 [1]) ' 磁盘符号
.如果真 (不等于 (取文本长度 (临时文本), 2)) ' c:
    返回 (1)
.如果真结束
.如果真 (不等于 (取文本右边 (临时文本, 1), “:”)) ' 是否为“:”
    返回 (1)
.如果真结束

.计次循环首 (相减 (数组成员数量, 1), 计次变量)
    .如果真 (或者 (等于 (文件夹名称组 [相加 (计次变量, 1)], “.”), 等于 (文件夹名称组 [相加 (计次变量, 1)], “..”), 等于 (文件夹名称组 [相加 (计次变量, 1)], “”)))
        返回 (1)
    .如果真结束
    赋值 (临时文本, 相加 (临时文本, “\”, 文件夹名称组 [相加 (计次变量, 1)]))
    .如果 (等于 (寻找文件 (临时文本, #子目录), “”))
        .如果真 (等于 (创建目录 (临时文本), 假))
            返回 (1) ' 创建失败
        .如果真结束
        
    .否则
        .如果真 (等于 (计次变量, 相减 (数组成员数量, 1)))
            返回 (2) ' 最后一个文件夹已经存在
        .如果真结束
        
    .如果结束
    
.计次循环尾 ()
返回 (0)

.程序集 功能程序集, , , 

.子程序 寻找文件夹_无子文件夹无子文件, 双精度小数型, , 
.参数 文件夹路径数组, 文本型, 参考 数组, 结尾有"\"
.参数 是否处理事件, 逻辑型, , 

.局部变量 文件名, 文本型, , , 
.局部变量 文件大小, 双精度小数型, , , 
.局部变量 临时数组, 文本型, , "0", 
.局部变量 临时数值, 整数型, , , 
.局部变量 i, 整数型, , , 

加入成员 (临时数组, 文件夹路径数组 [1])
.判断开始 (等于 (是否处理事件, 真))
    .循环判断首 ()
        赋值 (文件名, 寻找文件 (相加 (文件夹路径数组 [1], “*.*”), #子目录))
        .判断循环首 (不等于 (文件名, “”))
            .如果真 (并且 (不等于 (文件名, “.”), 不等于 (文件名, “..”)))
                加入成员 (文件夹路径数组, 相加 (文件夹路径数组 [1], 文件名, “\”))
                加入成员 (临时数组, 相加 (文件夹路径数组 [1], 文件名, “\”))
            .如果真结束
            赋值 (文件名, 寻找文件 (#子目录))
            处理事件 ()
        .判断循环尾 ()
        删除成员 (文件夹路径数组, 1, 1)
    .循环判断尾 (大于 (取数组成员数 (文件夹路径数组), 0))
    赋值 (临时数值, 取数组成员数 (临时数组))
    .计次循环首 (临时数值, i)
        赋值 (文件名, 寻找文件 (相加 (临时数组 [i], “*.*”), ))
        .判断循环首 (不等于 (文件名, “”))
            赋值 (文件大小, 相加 (文件大小, 取文件尺寸 (相加 (临时数组 [i], 文件名))))
            赋值 (文件名, 寻找文件 ())
            处理事件 ()
        .判断循环尾 ()
    .计次循环尾 ()
.默认
    .循环判断首 ()
        赋值 (文件名, 寻找文件 (相加 (文件夹路径数组 [1], “*.*”), #子目录))
        .判断循环首 (不等于 (文件名, “”))
            .如果真 (并且 (不等于 (文件名, “.”), 不等于 (文件名, “..”)))
                加入成员 (文件夹路径数组, 相加 (文件夹路径数组 [1], 文件名, “\”))
                加入成员 (临时数组, 相加 (文件夹路径数组 [1], 文件名, “\”))
            .如果真结束
            赋值 (文件名, 寻找文件 (#子目录))
        .判断循环尾 ()
        删除成员 (文件夹路径数组, 1, 1)
    .循环判断尾 (大于 (取数组成员数 (文件夹路径数组), 0))
    赋值 (临时数值, 取数组成员数 (临时数组))
    .计次循环首 (临时数值, i)
        赋值 (文件名, 寻找文件 (相加 (临时数组 [i], “*.*”), ))
        .判断循环首 (不等于 (文件名, “”))
            赋值 (文件大小, 相加 (文件大小, 取文件尺寸 (相加 (临时数组 [i], 文件名))))
            赋值 (文件名, 寻找文件 ())
        .判断循环尾 ()
    .计次循环尾 ()
.判断结束
返回 (文件大小)

.子程序 寻找文件夹_有子文件夹无子文件, 双精度小数型, , 
.参数 文件夹路径数组, 文本型, 参考 数组, 
.参数 子文件夹数量, 整数型, 参考 可空, 
.参数 是否处理事件, 逻辑型, , 

.局部变量 文件名, 文本型, , , 
.局部变量 文件大小, 双精度小数型, , , 
.局部变量 临时数组, 文本型, , "0", 
.局部变量 临时数值, 整数型, , , 
.局部变量 i, 整数型, , , 

加入成员 (临时数组, 文件夹路径数组 [1])
.判断开始 (等于 (是否处理事件, 真))
    .循环判断首 ()
        赋值 (文件名, 寻找文件 (相加 (文件夹路径数组 [1], “*.*”), #子目录))
        .判断循环首 (不等于 (文件名, “”))
            .如果真 (并且 (不等于 (文件名, “.”), 不等于 (文件名, “..”)))
                加入成员 (文件夹路径数组, 相加 (文件夹路径数组 [1], 文件名, “\”))
                加入成员 (临时数组, 相加 (文件夹路径数组 [1], 文件名, “\”))
                赋值 (子文件夹数量, 相加 (子文件夹数量, 1))
            .如果真结束
            赋值 (文件名, 寻找文件 (#子目录))
            处理事件 ()
        .判断循环尾 ()
        删除成员 (文件夹路径数组, 1, 1)
    .循环判断尾 (大于 (取数组成员数 (文件夹路径数组), 0))
    赋值 (临时数值, 取数组成员数 (临时数组))
    .计次循环首 (临时数值, i)
        赋值 (文件名, 寻找文件 (相加 (临时数组 [i], “*.*”), ))
        .判断循环首 (不等于 (文件名, “”))
            赋值 (文件大小, 相加 (文件大小, 取文件尺寸 (相加 (临时数组 [i], 文件名))))
            赋值 (文件名, 寻找文件 ())
            处理事件 ()
        .判断循环尾 ()
    .计次循环尾 ()
.默认
    .循环判断首 ()
        赋值 (文件名, 寻找文件 (相加 (文件夹路径数组 [1], “*.*”), #子目录))
        .判断循环首 (不等于 (文件名, “”))
            .如果真 (并且 (不等于 (文件名, “.”), 不等于 (文件名, “..”)))
                加入成员 (文件夹路径数组, 相加 (文件夹路径数组 [1], 文件名, “\”))
                加入成员 (临时数组, 相加 (文件夹路径数组 [1], 文件名, “\”))
                赋值 (子文件夹数量, 相加 (子文件夹数量, 1))
            .如果真结束
            赋值 (文件名, 寻找文件 (#子目录))
        .判断循环尾 ()
        删除成员 (文件夹路径数组, 1, 1)
    .循环判断尾 (大于 (取数组成员数 (文件夹路径数组), 0))
    赋值 (临时数值, 取数组成员数 (临时数组))
    .计次循环首 (临时数值, i)
        赋值 (文件名, 寻找文件 (相加 (临时数组 [i], “*.*”), ))
        .判断循环首 (不等于 (文件名, “”))
            赋值 (文件大小, 相加 (文件大小, 取文件尺寸 (相加 (临时数组 [i], 文件名))))
            赋值 (文件名, 寻找文件 ())
        .判断循环尾 ()
    .计次循环尾 ()
.判断结束
返回 (文件大小)

.子程序 寻找文件夹_无子文件夹有子文件, 双精度小数型, , 
.参数 文件夹路径数组, 文本型, 参考 数组, 
.参数 子文件数量, 整数型, 参考 可空, 
.参数 是否处理事件, 逻辑型, , 

.局部变量 文件名, 文本型, , , 
.局部变量 文件大小, 双精度小数型, , , 
.局部变量 临时数组, 文本型, , "0", 
.局部变量 临时数值, 整数型, , , 
.局部变量 i, 整数型, , , 

加入成员 (临时数组, 文件夹路径数组 [1])
.判断开始 (等于 (是否处理事件, 真))
    .循环判断首 ()
        赋值 (文件名, 寻找文件 (相加 (文件夹路径数组 [1], “*.*”), #子目录))
        .判断循环首 (不等于 (文件名, “”))
            .如果真 (并且 (不等于 (文件名, “.”), 不等于 (文件名, “..”)))
                加入成员 (文件夹路径数组, 相加 (文件夹路径数组 [1], 文件名, “\”))
                加入成员 (临时数组, 相加 (文件夹路径数组 [1], 文件名, “\”))
            .如果真结束
            赋值 (文件名, 寻找文件 (#子目录))
            处理事件 ()
        .判断循环尾 ()
        删除成员 (文件夹路径数组, 1, 1)
    .循环判断尾 (大于 (取数组成员数 (文件夹路径数组), 0))
    赋值 (临时数值, 取数组成员数 (临时数组))
    .计次循环首 (临时数值, i)
        赋值 (文件名, 寻找文件 (相加 (临时数组 [i], “*.*”), ))
        .判断循环首 (不等于 (文件名, “”))
            赋值 (文件大小, 相加 (文件大小, 取文件尺寸 (相加 (临时数组 [i], 文件名))))
            赋值 (子文件数量, 相加 (子文件数量, 1))
            赋值 (文件名, 寻找文件 ())
            处理事件 ()
        .判断循环尾 ()
    .计次循环尾 ()
.默认
    .循环判断首 ()
        赋值 (文件名, 寻找文件 (相加 (文件夹路径数组 [1], “*.*”), #子目录))
        .判断循环首 (不等于 (文件名, “”))
            .如果真 (并且 (不等于 (文件名, “.”), 不等于 (文件名, “..”)))
                加入成员 (文件夹路径数组, 相加 (文件夹路径数组 [1], 文件名, “\”))
                加入成员 (临时数组, 相加 (文件夹路径数组 [1], 文件名, “\”))
            .如果真结束
            赋值 (文件名, 寻找文件 (#子目录))
        .判断循环尾 ()
        删除成员 (文件夹路径数组, 1, 1)
    .循环判断尾 (大于 (取数组成员数 (文件夹路径数组), 0))
    赋值 (临时数值, 取数组成员数 (临时数组))
    .计次循环首 (临时数值, i)
        赋值 (文件名, 寻找文件 (相加 (临时数组 [i], “*.*”), ))
        .判断循环首 (不等于 (文件名, “”))
            赋值 (文件大小, 相加 (文件大小, 取文件尺寸 (相加 (临时数组 [i], 文件名))))
            赋值 (子文件数量, 相加 (子文件数量, 1))
            赋值 (文件名, 寻找文件 ())
        .判断循环尾 ()
    .计次循环尾 ()
    
.判断结束
返回 (文件大小)

.子程序 寻找文件夹_有子文件夹有子文件, 双精度小数型, , 
.参数 文件夹路径数组, 文本型, 参考 数组, 
.参数 子文件夹数量, 整数型, 参考 可空, 
.参数 子文件数量, 整数型, 参考 可空, 
.参数 是否处理事件, 逻辑型, , 

.局部变量 文件名, 文本型, , , 
.局部变量 文件大小, 双精度小数型, , , 
.局部变量 临时数组, 文本型, , "0", 
.局部变量 临时数值, 整数型, , , 
.局部变量 i, 整数型, , , 

加入成员 (临时数组, 文件夹路径数组 [1])
.判断开始 (等于 (是否处理事件, 真))
    .循环判断首 ()
        赋值 (文件名, 寻找文件 (相加 (文件夹路径数组 [1], “*.*”), #子目录))
        .判断循环首 (不等于 (文件名, “”))
            .如果真 (并且 (不等于 (文件名, “.”), 不等于 (文件名, “..”)))
                加入成员 (文件夹路径数组, 相加 (文件夹路径数组 [1], 文件名, “\”))
                加入成员 (临时数组, 相加 (文件夹路径数组 [1], 文件名, “\”))
                赋值 (子文件夹数量, 相加 (子文件夹数量, 1))
            .如果真结束
            赋值 (文件名, 寻找文件 (#子目录))
            处理事件 ()
        .判断循环尾 ()
        删除成员 (文件夹路径数组, 1, 1)
    .循环判断尾 (大于 (取数组成员数 (文件夹路径数组), 0))
    赋值 (临时数值, 取数组成员数 (临时数组))
    .计次循环首 (临时数值, i)
        赋值 (文件名, 寻找文件 (相加 (临时数组 [i], “*.*”), ))
        .判断循环首 (不等于 (文件名, “”))
            赋值 (文件大小, 相加 (文件大小, 取文件尺寸 (相加 (临时数组 [i], 文件名))))
            赋值 (子文件数量, 相加 (子文件数量, 1))
            赋值 (文件名, 寻找文件 ())
            处理事件 ()
        .判断循环尾 ()
    .计次循环尾 ()
.默认
    .循环判断首 ()
        赋值 (文件名, 寻找文件 (相加 (文件夹路径数组 [1], “*.*”), #子目录))
        .判断循环首 (不等于 (文件名, “”))
            .如果真 (并且 (不等于 (文件名, “.”), 不等于 (文件名, “..”)))
                加入成员 (文件夹路径数组, 相加 (文件夹路径数组 [1], 文件名, “\”))
                加入成员 (临时数组, 相加 (文件夹路径数组 [1], 文件名, “\”))
                赋值 (子文件夹数量, 相加 (子文件夹数量, 1))
            .如果真结束
            赋值 (文件名, 寻找文件 (#子目录))
        .判断循环尾 ()
        删除成员 (文件夹路径数组, 1, 1)
    .循环判断尾 (大于 (取数组成员数 (文件夹路径数组), 0))
    赋值 (临时数值, 取数组成员数 (临时数组))
    .计次循环首 (临时数值, i)
        赋值 (文件名, 寻找文件 (相加 (临时数组 [i], “*.*”), ))
        .判断循环首 (不等于 (文件名, “”))
            赋值 (文件大小, 相加 (文件大小, 取文件尺寸 (相加 (临时数组 [i], 文件名))))
            赋值 (子文件数量, 相加 (子文件数量, 1))
            赋值 (文件名, 寻找文件 ())
        .判断循环尾 ()
    .计次循环尾 ()
.判断结束
返回 (文件大小)

.子程序 复制文件夹, 逻辑型, , 
.参数 路径, 文本型, , 结尾有"\"
.参数 被复制的文件夹数组, 文本型, 参考 数组, 
.参数 复制到的文件夹, 文本型, , 
.参数 是否处理事件, 逻辑型, , 

.局部变量 文件名, 文本型, , , 
.局部变量 临时数组, 文本型, , "0", 
.局部变量 临时数值, 整数型, , , 
.局部变量 i, 整数型, , , 

加入成员 (临时数组, “”)
.判断开始 (等于 (是否处理事件, 真))
    .循环判断首 ()
        赋值 (文件名, 寻找文件 (相加 (路径, 被复制的文件夹数组 [1], “*.*”), #子目录))
        .判断循环首 (不等于 (文件名, “”))
            .如果真 (并且 (不等于 (文件名, “.”), 不等于 (文件名, “..”)))
                创建目录 (相加 (复制到的文件夹, 被复制的文件夹数组 [1], 文件名))
                加入成员 (被复制的文件夹数组, 相加 (被复制的文件夹数组 [1], 文件名, “\”))
                加入成员 (临时数组, 相加 (被复制的文件夹数组 [1], 文件名, “\”))
            .如果真结束
            赋值 (文件名, 寻找文件 (#子目录))
            处理事件 ()
        .判断循环尾 ()
        删除成员 (被复制的文件夹数组, 1, 1)
    .循环判断尾 (大于 (取数组成员数 (被复制的文件夹数组), 0))
    赋值 (临时数值, 取数组成员数 (临时数组))
    .计次循环首 (临时数值, i)
        赋值 (文件名, 寻找文件 (相加 (路径, 临时数组 [i], “*.*”), ))
        .判断循环首 (不等于 (文件名, “”))
            .如果真 (等于 (复制文件 (相加 (路径, 临时数组 [i], 文件名), 相加 (复制到的文件夹, 临时数组 [i], 文件名)), 假))
                返回 (假)
            .如果真结束
            赋值 (文件名, 寻找文件 ())
            处理事件 ()
        .判断循环尾 ()
    .计次循环尾 ()
.默认
    .循环判断首 ()
        赋值 (文件名, 寻找文件 (相加 (路径, 被复制的文件夹数组 [1], “*.*”), #子目录))
        .判断循环首 (不等于 (文件名, “”))
            .如果真 (并且 (不等于 (文件名, “.”), 不等于 (文件名, “..”)))
                创建目录 (相加 (复制到的文件夹, 被复制的文件夹数组 [1], 文件名))
                加入成员 (被复制的文件夹数组, 相加 (被复制的文件夹数组 [1], 文件名, “\”))
                加入成员 (临时数组, 相加 (被复制的文件夹数组 [1], 文件名, “\”))
            .如果真结束
            赋值 (文件名, 寻找文件 (#子目录))
        .判断循环尾 ()
        删除成员 (被复制的文件夹数组, 1, 1)
    .循环判断尾 (大于 (取数组成员数 (被复制的文件夹数组), 0))
    赋值 (临时数值, 取数组成员数 (临时数组))
    .计次循环首 (临时数值, i)
        赋值 (文件名, 寻找文件 (相加 (路径, 临时数组 [i], “*.*”), ))
        .判断循环首 (不等于 (文件名, “”))
            .如果真 (等于 (复制文件 (相加 (路径, 临时数组 [i], 文件名), 相加 (复制到的文件夹, 临时数组 [i], 文件名)), 假))
                返回 (假)
            .如果真结束
            赋值 (文件名, 寻找文件 ())
        .判断循环尾 ()
    .计次循环尾 ()
.判断结束
返回 (真)


 ' 不属于任何一个程序集、类模块的函数：
