 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 2 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 1 扩展界面支持库一



窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 500
    高度 = 381
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 真
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口1 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 250
    高度 = 252
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 真
    图标 =  ' 已保存到：D:\易语言学习\Data\wallpaperelf(0123).e\窗口1_图标.ico
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口2
    左边 = 50
    顶边 = 50
    宽度 = 250
    高度 = 190
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 真
    图标 =  ' 已保存到：D:\易语言学习\Data\wallpaperelf(0123).e\窗口2_图标.ico
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口3 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 113
    高度 = 46
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 真
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.图片 询问图片, " ' 已保存到：D:\易语言学习\Data\wallpaperelf(0123).e\询问图片", , 
.图片 错误图片, " ' 已保存到：D:\易语言学习\Data\wallpaperelf(0123).e\错误图片", , 
.图片 信息图片, " ' 已保存到：D:\易语言学习\Data\wallpaperelf(0123).e\信息图片", , 


.全局变量 窗口标题, 文本型, , , 
.全局变量 提示信息, 文本型, , , 
.全局变量 描述图标, 文本型, , , 
.全局变量 显示按钮, 文本型, , , 
.全局变量 询问确定取消, 文本型, , , 

.DLL命令 更换墙纸, 整数型, "user32", "SystemParametersInfoA", , 
    .参数 a, 整数型, , 
    .参数 b, 逻辑型, , 
    .参数 c, 文本型, , 
    .参数 d, 整数型, , 

.DLL命令 读配置文本, 整数型, "kernel32.dll", "GetPrivateProfileStringA", , 
    .参数 小节名, 文本型, , 就是用中括号括起来的内容
    .参数 项目名, 文本型, , 就是等号前边的内容
    .参数 默认值, 文本型, , 可以为“”
    .参数 缓冲容器, 文本型, , 定义一个文本型变量,并赋N长的空白文本
    .参数 缓冲容积, 整数型, , 应与缓冲容器的长度相等为N
    .参数 文件名, 文本型, , 就是你要写入的那个文件

.DLL命令 写配置文件, 整数型, "kernel32.dll", "WritePrivateProfileStringA", , 如果配置文件不存在则将被创建
    .参数 小节名, 文本型, , 就是用中括号括起来的内容
    .参数 项目名, 文本型, , 就是等号前边的内容
    .参数 项目值, 文本型, , 就是等号后面的内容
    .参数 文件名, 文本型, , 就是你要写入的那个文件

.DLL命令 读配置整数, 整数型, "kernel32.dll", "GetPrivateProfileIntA", , 
    .参数 小节名, 文本型, , 就是用中括号括起来的内容
    .参数 项目名, 文本型, , 就是等号前边的内容
    .参数 默认值, 整数型, , 如果找不到对应的项目则返回该值
    .参数 文件名, 文本型, , 就是你要写入的那个文件

.窗口程序集 窗口程序集1, , , 

.程序集变量 lj, 文本型, , , 
.程序集变量 lbxzx, 整数型, , , 
.程序集变量 已显示文件, 文本型, , , 
.程序集变量 是否已修改, 逻辑型, , , 
.程序集变量 是否结束, 逻辑型, , , 
.子程序 _图形按钮12_被单击, 空白型, , 
载入 (窗口1, _启动窗口, 真)

.子程序 _图形按钮2_被单击, 空白型, , 
赋值 (_启动窗口.位置, 2)

.子程序 _图形按钮1_被单击, 空白型, , 
.如果真 (等于 (是否已修改, 真))
    是否修改 ()
.如果真结束

结束 ()

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 hz, 文本型, , , 
.局部变量 xtb, 整数型, , , 
.局部变量 ini, 文本型, , , 

.如果 (文件是否存在 (相加 (取运行目录 (), “\Wallpaper.ini”)))
    赋值 (ini, 取空白文本 (100))
    读配置文本 (“lujing”, “lj”, “”, ini, 100, 相加 (取运行目录 (), “\Wallpaper.ini”))
    赋值 (.内容, ini)
    打开 (ini, , , , , , )
    到首记录 ()
    .计次循环首 (取记录数 (), )
        赋值 (hz, 取文本右边 (读 (1), 3))
        .如果真 (等于 (hz, “bmp”))
            赋值 (xtb, 0)
        .如果真结束
        .如果真 (等于 (hz, “jpg”))
            赋值 (xtb, 1)
        .如果真结束
        .如果真 (等于 (hz, “gif”))
            赋值 (xtb, 2)
        .如果真结束
        .插入表项 (读 (1), xtb, , , 到数值 (读 (2)))
        跳过 ()
    .计次循环尾 ()
    .如果真 (不等于 (取表项数 (), 0))
        赋值 (lj, 0.取标题 ())
    .如果真结束
    
    .判断开始 (等于 (0.取表项数值 (), 1))
        赋值 (.选中, 真)
    .判断 (等于 (0.取表项数值 (), 2))
        赋值 (.选中, 真)
    .判断 (等于 (0.取表项数值 (), 3))
        赋值 (.选中, 真)
    .默认
        
    .判断结束
    读取设置 ()
    赋值 (是否结束, 真)
.否则
    写配置文件 (“shezhi”, “genghuanshunxu”, “0”, 相加 (取运行目录 (), “\Wallpaper.ini”))
    写配置文件 (“shezhi”, “bizhisuoyin”, “0”, 相加 (取运行目录 (), “\Wallpaper.ini”))
    写配置文件 (“shezhi”, “genghuanfangshi”, “0”, 相加 (取运行目录 (), “\Wallpaper.ini”))
    写配置文件 (“shezhi”, “fenzhong”, “10”, 相加 (取运行目录 (), “\Wallpaper.ini”))
    写配置文件 (“shezhi”, “shifouyunxing”, “0”, 相加 (取运行目录 (), “\Wallpaper.ini”))
    子程序1 ()
.如果结束


.子程序 子程序1, 空白型, , 
.如果 (等于 (打开 (), 真))
    赋值 (.内容, .文件名)
    创建壁纸列表 ()
    写配置文件 (“lujing”, “lj”, .内容, 相加 (取运行目录 (), “\Wallpaper.ini”))
    __启动窗口_创建完毕 ()
.否则
    子程序1 ()
.如果结束


.子程序 读取设置, 空白型, , 
.如果真 (等于 (取文本注册项 (#本地机器, “Software\Microsoft\Windows\CurrentVersion\Run\WallPaper”, ), 相加 (取运行目录 (), “\wallpaper.exe”)))
    赋值 (.选中, 真)
.如果真结束
.如果 (等于 (读配置整数 (“shezhi”, “genghuanshunxu”, 0, 相加 (取运行目录 (), “\Wallpaper.ini”)), 0))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 真)
.如果结束
.如果 (等于 (读配置整数 (“shezhi”, “genghuanfangshi”, 0, 相加 (取运行目录 (), “\Wallpaper.ini”)), 0))
    赋值 (.选中, 真)
    赋值 (.禁止, 真)
.否则
    赋值 (.选中, 真)
    赋值 (.内容, 数值到格式文本 (读配置整数 (“shezhi”, “fenzhong”, 5, 相加 (取运行目录 (), “\Wallpaper.ini”)), , 假))
.如果结束


.子程序 _图形按钮3_被单击, 空白型, , 
.局部变量 hz, 文本型, , , 
.局部变量 xtb, 整数型, , , 
.局部变量 wjlj, 文本型, , , 

.如果真 (等于 (打开 (), 真))
    赋值 (wjlj, .文件名)
    赋值 (hz, 取文本右边 (wjlj, 3))
    .如果真 (等于 (“bmp”))
        赋值 (xtb, 0)
    .如果真结束
    .如果真 (等于 (“jpg”))
        赋值 (xtb, 1)
    .如果真结束
    .如果真 (等于 (“gif”))
        赋值 (xtb, 2)
    .如果真结束
    .插入表项 (wjlj, xtb, , , 1)
    赋值 (是否已修改, 真)
    赋值 (lj, wjlj)
    赋值 (lbxzx, 相减 (取表项数 (), 1))
.如果真结束


.子程序 __启动窗口_将被销毁, 空白型, , 
关闭 (.内容)

.子程序 _图形按钮4_被单击, 空白型, , 
.局部变量 xzx, 整数型, , , 

.如果 (不等于 (., -1))
    赋值 (xzx, .)
    xzx.删除表项 ()
    赋值 (是否已修改, 真)
    .如果 (并且 (不等于 (取表项数 (), 0), 不等于 (xzx, 0)))
        赋值 (lj, 相减 (xzx, 1).取标题 ())
        赋值 (lbxzx, 相减 (xzx, 1))
    .否则
        赋值 (lj, “-1”)
        赋值 (.图片, {  })
        赋值 (lbxzx, -1)
    .如果结束
    
    
.否则
    鸣叫 ()
.如果结束


.子程序 _图形按钮5_被单击, 空白型, , 
.局部变量 选中项, 整数型, , , 
.局部变量 图片索引, 整数型, , , 
.局部变量 上移标题, 文本型, , , 
.局部变量 表项数值, 整数型, , , 

赋值 (选中项, .)
.如果 (不等于 (选中项, -1))
    .如果 (大于 (选中项, 0))
        赋值 (图片索引, 选中项.取图片 ())
        赋值 (上移标题, 选中项.取标题 ())
        赋值 (表项数值, 选中项.取表项数值 ())
        选中项.删除表项 ()
        相减 (选中项, 1).插入表项 (上移标题, 图片索引, , , 表项数值)
        赋值 (., 相减 (选中项, 1))
        赋值 (是否已修改, 真)
    .否则
        鸣叫 ()
    .如果结束
    
.否则
    鸣叫 ()
.如果结束


.子程序 _图形按钮6_被单击, 空白型, , 
.局部变量 选中项, 整数型, , , 
.局部变量 图片索引, 整数型, , , 
.局部变量 下移标题, 文本型, , , 
.局部变量 表项数值, 整数型, , , 

赋值 (选中项, .)
.如果 (不等于 (选中项, -1))
    .如果 (不等于 (选中项, 相减 (取表项数 (), 1)))
        赋值 (图片索引, 选中项.取图片 ())
        赋值 (下移标题, 选中项.取标题 ())
        赋值 (表项数值, 选中项.取表项数值 ())
        选中项.删除表项 ()
        相加 (选中项, 1).插入表项 (下移标题, 图片索引, , , 表项数值)
        赋值 (., 相加 (选中项, 1))
        赋值 (是否已修改, 真)
    .否则
        鸣叫 ()
    .如果结束
    
.否则
    鸣叫 ()
.如果结束


.子程序 _超级列表框1_当前表项被改变, 空白型, , 
赋值 (.显示方式, 2)
赋值 (lbxzx, .)
赋值 (lj, “”)
赋值 (lj, lbxzx.取标题 ())
.判断开始 (等于 (lbxzx.取表项数值 (), 1))
    赋值 (.选中, 真)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
.判断 (等于 (lbxzx.取表项数值 (), 2))
    赋值 (.选中, 假)
    赋值 (.选中, 真)
    赋值 (.选中, 假)
.判断 (等于 (lbxzx.取表项数值 (), 3))
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 真)
.默认
    
.判断结束
赋值 (.标题, )

.子程序 __启动窗口_空闲, 逻辑型, , 
.参数 已空闲时间, 整数型, , 

.如果真 (大于 (已空闲时间, 100))
    .如果 (并且 (不等于 (lj, 已显示文件), 不等于 (lj, “-1”)))
        赋值 (.图片, {  })
        赋值 (.图片, 读入文件 ())
        赋值 (已显示文件, lj)
    .否则
        返回 (假)
    .如果结束
    
.如果真结束
返回 (真)

.子程序 _单选框1_被单击, 空白型, , 
赋值 (.显示方式, 2)
.如果真 (不等于 (lbxzx, -1))
    lbxzx.置表项数值 (1)
    赋值 (是否已修改, 真)
.如果真结束


.子程序 _单选框2_被单击, 空白型, , 
 图片框1.显示方式 ＝ 0
.如果真 (不等于 (lbxzx, -1))
    lbxzx.置表项数值 (2)
    赋值 (是否已修改, 真)
.如果真结束


.子程序 _单选框3_被单击, 空白型, , 
赋值 (.显示方式, 1)
.如果真 (不等于 (lbxzx, -1))
    lbxzx.置表项数值 (3)
    赋值 (是否已修改, 真)
.如果真结束


.子程序 _图形按钮13_被单击, 空白型, , 
赋值 (.初始目录, 取运行目录 ())
.如果真 (等于 (打开 (), 真))
    关闭 (.内容)
    全部删除 ()
    赋值 (.内容, .文件名)
    创建壁纸列表 ()
    赋值 (.图片, {  })
.如果真结束


.子程序 创建壁纸列表, 空白型, , 
.局部变量 字段表, 字段信息, , "2", 

赋值 (字段表 [1].名称, “A”)
赋值 (字段表 [1].类型, #文本型)
赋值 (字段表 [1].最大文本长度, 100)
赋值 (字段表 [2].名称, “B”)
赋值 (字段表 [2].类型, #文本型)
赋值 (字段表 [2].最大文本长度, 1)
.如果 (等于 (创建 (.内容, 字段表), 真))
    赋值 (.标题, 相加 (“创建”, .内容, “成功。”))
    打开 (.内容, , , , , , )
.否则
    鸣叫 ()
    赋值 (.标题, 相加 (“创建”, .内容, “失败。”))
    赋值 (.内容, “”)
.如果结束


.子程序 _图形按钮7_被单击, 空白型, , 
.局部变量 i, 整数型, , , 

.如果真 (等于 (是否已修改, 真))
    .如果 (不等于 (取表项数 (), 0))
        赋值 (i, 0)
        .如果真 (不等于 (取记录数 (), 0))
            清空 ()
            到首记录 ()
        .如果真结束
        .计次循环首 (取表项数 (), )
            加记录 (i.取标题 (), 数值到格式文本 (i.取表项数值 (), , 假))
            赋值 (i, 相加 (i, 1))
        .计次循环尾 ()
        赋值 (.标题, “保存成功。”)
        赋值 (是否已修改, 假)
    .否则
        清空 ()
    .如果结束
    
.如果真结束


.子程序 _图形按钮8_被单击, 空白型, , 
.局部变量 hz, 文本型, , , 
.局部变量 xtb, 整数型, , , 

赋值 (.初始目录, 取运行目录 ())
.如果真 (等于 (打开 (), 真))
    关闭 (.内容)
    全部删除 ()
    赋值 (.内容, .文件名)
    打开 (.内容, , , , , , )
    到首记录 ()
    .计次循环首 (取记录数 (), )
        赋值 (取文本右边 (读 (1), 3))
        .如果真 (等于 (“bmp”))
            赋值 (0)
        .如果真结束
        .如果真 (等于 (“jpg”))
            赋值 (1)
        .如果真结束
        .如果真 (等于 (“gif”))
            赋值 (2)
        .如果真结束
        .插入表项 (读 (1), xtb, , , 到数值 (读 (2)))
        跳过 ()
    .计次循环尾 ()
    .如果真 (不等于 (取表项数 (), 0))
        赋值 (lj, 0.取标题 ())
    .如果真结束
    赋值 (.标题, “读取成功。”)
    赋值 (lbxzx, 0)
.如果真结束


.子程序 _单选框4_被单击, 空白型, , 
赋值 (.禁止, 真)

.子程序 _单选框5_被单击, 空白型, , 
赋值 (.禁止, 假)
获取焦点 ()
赋值 (.被选择字符数, -1)

.子程序 _图形按钮10_被单击, 空白型, , 
结束 ()

.子程序 _图形按钮9_被单击, 空白型, , 
_图形按钮11_被单击 ()
.如果真 (等于 (是否结束, 真))
    .如果真 (等于 (读配置整数 (“shezhi”, “shifouyunxing”, 0, 相加 (取运行目录 (), “\Wallpaper.ini”)), 0))
        赋值 (窗口标题, “询问：”)
        赋值 (描述图标, “询问图标”)
        赋值 (提示信息, “    是否现在就运行壁纸更换程序？”)
        赋值 (显示按钮, “quedingquxiao”)
        载入 (窗口2, _启动窗口, 真)
        .如果 (等于 (询问确定取消, “确定”))
            赋值 (询问确定取消, “”)
            运行 (相加 (取运行目录 (), “\wallpaper.exe”), 假, )
        .否则
            
        .如果结束
        
    .如果真结束
    结束 ()
.如果真结束


.子程序 _图形按钮11_被单击, 空白型, , 
.如果 (不等于 (取表项数 (), 0))
    .如果真 (等于 (.选中, 真))
        .如果真 (等于 (.内容, “”))
            赋值 (窗口标题, “信息：”)
            赋值 (描述图标, “信息图标”)
            赋值 (提示信息, “请先输入更换时间！”)
            赋值 (显示按钮, “确定”)
            载入 (窗口2, _启动窗口, 真)
            获取焦点 ()
            赋值 (是否结束, 假)
            返回 ()
        .如果真结束
        
    .如果真结束
    
    .如果 (等于 (.选中, 真))
        .如果真 (等于 (写注册项 (#本地机器, “Software\Microsoft\Windows\CurrentVersion\Run\WallPaper”, 相加 (取运行目录 (), “\wallpaper.exe”)), 假))
             信息框 (, 0, )
        .如果真结束
        
    .否则
        .如果真 (等于 (删除注册项 (#本地机器, “Software\Microsoft\Windows\CurrentVersion\Run\WallPaper”), 假))
             信息框 (, 0, )
        .如果真结束
        
    .如果结束
    .如果 (等于 (.选中, 真))
        写配置文件 (“shezhi”, “genghuanshunxu”, “0”, 相加 (取运行目录 (), “\Wallpaper.ini”))
    .否则
        写配置文件 (“shezhi”, “genghuanshunxu”, “1”, 相加 (取运行目录 (), “\Wallpaper.ini”))
    .如果结束
    .如果 (等于 (.选中, 真))
        写配置文件 (“shezhi”, “genghuanfangshi”, “0”, 相加 (取运行目录 (), “\Wallpaper.ini”))
    .否则
        写配置文件 (“shezhi”, “genghuanfangshi”, “1”, 相加 (取运行目录 (), “\Wallpaper.ini”))
    .如果结束
    写配置文件 (“lujing”, “lj”, .内容, 相加 (取运行目录 (), “\Wallpaper.ini”))
    写配置文件 (“shezhi”, “fenzhong”, .内容, 相加 (取运行目录 (), “\Wallpaper.ini”))
    赋值 (是否结束, 真)
    
.否则
    赋值 (窗口标题, “信息：”)
    赋值 (描述图标, “信息图标”)
    赋值 (提示信息, “请先添加壁纸！”)
    赋值 (显示按钮, “确定”)
    载入 (窗口2, _启动窗口, 真)
    赋值 (是否结束, 假)
.如果结束
是否修改 ()

.子程序 是否修改, 空白型, , 
.如果真 (等于 (是否已修改, 真))
    赋值 (窗口标题, “询问：”)
    赋值 (描述图标, “询问图标”)
    赋值 (提示信息, “壁纸列表已修改，是否要保存？”)
    赋值 (显示按钮, “quedingquxiao”)
    载入 (窗口2, _启动窗口, 真)
    .如果 (等于 (询问确定取消, “确定”))
        赋值 (询问确定取消, “”)
        _图形按钮7_被单击 ()
    .否则
        
    .如果结束
    
.如果真结束


.子程序 _图形按钮14_被单击, 空白型, , 
赋值 (.可视, 真)
载入 (窗口3, _启动窗口, 假)
赋值 (窗口3.可视, 真)

.子程序 _图形按钮15_被单击, 空白型, , 
.局部变量 sfcj, 逻辑型, , , 

赋值 (.可视, 假)
 sfcj ＝ 是否已创建 (窗口3)
如果真 (sfcj ＝ 真)
 窗口3.销毁 ()


.子程序 _图片框1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (窗口3, _启动窗口, 假)
赋值 (窗口3.左边, 取鼠标水平位置 ())
赋值 (窗口3.顶边, 取鼠标垂直位置 ())
赋值 (窗口3.可视, 真)

.窗口程序集 窗口程序集2, , , 

.子程序 _图形按钮9_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集3, , , 

.子程序 _窗口2_创建完毕, 空白型, , 
鸣叫 ()
.如果 (等于 (显示按钮, “确定”))
    
.否则
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 假)
.如果结束
.判断开始 (等于 (描述图标, “信息图标”))
    赋值 (.图片, #信息图片)
.判断 (等于 (描述图标, “询问图标”))
    赋值 (.图片, #询问图片)
.判断 (等于 (描述图标, “错误图标”))
    赋值 (.图片, #错误图片)
.默认
    
.判断结束
赋值 (.标题, 窗口标题)
赋值 (.标题, 提示信息)

.子程序 _图形按钮3_被单击, 空白型, , 
销毁 ()

.子程序 _图形按钮4_被单击, 空白型, , 
赋值 (询问确定取消, “确定”)
销毁 ()

.子程序 _图形按钮2_被单击, 空白型, , 
赋值 (询问确定取消, “取消”)
销毁 ()

.窗口程序集 窗口程序集4, , , 

.程序集变量 壁纸路径, 文本型, , , 
.程序集变量 显示, 文本型, , , 
.子程序 _窗口3_创建完毕, 空白型, , 
赋值 (窗口3.左边, 相加 (_启动窗口.左边, 28))
赋值 (窗口3.顶边, 相加 (_启动窗口.顶边, 76))

.子程序 _窗口3_失去焦点, 空白型, , 
赋值 (_启动窗口..可视, 假)
销毁 ()

.子程序 _图形按钮1_被单击, 空白型, , 
.局部变量 xzx, 整数型, , , 
.局部变量 图片格式, 文本型, , , 

赋值 (xzx, _启动窗口..)
.如果 (不等于 (xzx, -1))
    赋值 (壁纸路径, _启动窗口.取标题 (., xzx, ))
    赋值 (显示, 数值到格式文本 (_启动窗口.取表项数值 (., xzx), , 假))
    赋值 (图片格式, 取文本右边 (壁纸路径, 3))
    .如果 (等于 (图片格式, “bmp”))
        修改注册表 ()
        更换墙纸 (20, 真, 壁纸路径, 1)
    .否则
        JPGGIF转BMP ()
        修改注册表 ()
        更换墙纸 (20, 真, 相加 (取运行目录 (), “\wallpaper.bmp”), 1)
    .如果结束
    
.否则
     信息框 (, 0, )
    鸣叫 ()
.如果结束
_启动窗口.获取焦点 ()

.子程序 _图形按钮2_被单击, 空白型, , 
更换墙纸 (20, 真, “”, 1)
_启动窗口.获取焦点 ()

.子程序 修改注册表, 空白型, , 
.局部变量 TileWallpaper, 逻辑型, , , 
.局部变量 WallpaperStyle, 逻辑型, , , 

.判断开始 (等于 (显示, “1”))
    赋值 (TileWallpaper, 写注册项 (#现行用户, “Control Panel\Desktop\TileWallpaper”, “0”))
    赋值 (WallpaperStyle, 写注册项 (#现行用户, “Control Panel\Desktop\WallpaperStyle”, “0”))
    .如果真 (或者 (等于 (TileWallpaper, 假), 等于 (WallpaperStyle, 假)))
        信息框 (“修改显示属性失败！”, #错误图标, “错误”)
    .如果真结束
    
.判断 (等于 (显示, “2”))
    赋值 (TileWallpaper, 写注册项 (#现行用户, “Control Panel\Desktop\TileWallpaper”, “1”))
    赋值 (WallpaperStyle, 写注册项 (#现行用户, “Control Panel\Desktop\WallpaperStyle”, “0”))
    .如果真 (或者 (等于 (TileWallpaper, 假), 等于 (WallpaperStyle, 假)))
        信息框 (“修改显示属性失败！”, #错误图标, “错误”)
    .如果真结束
    
.判断 (等于 (显示, “3”))
    赋值 (TileWallpaper, 写注册项 (#现行用户, “Control Panel\Desktop\TileWallpaper”, “0”))
    赋值 (WallpaperStyle, 写注册项 (#现行用户, “Control Panel\Desktop\WallpaperStyle”, “2”))
    .如果真 (或者 (等于 (TileWallpaper, 假), 等于 (WallpaperStyle, 假)))
        信息框 (“修改显示属性失败！”, #错误图标, “错误”)
    .如果真结束
    
.默认
    
.判断结束


.子程序 JPGGIF转BMP, 空白型, , 
.局部变量 图片号, 整数型, , , 
.局部变量 文件号, 整数型, , , 

赋值 (图片号, 载入图片 (壁纸路径))
赋值 (.宽度, 图片号.取图片宽度 ())
赋值 (.高度, 图片号.取图片高度 ())
图片号.画图片 (0, 0, .宽度, .高度, )
赋值 (文件号, 打开文件 (相加 (取运行目录 (), “\wallpaper.bmp”), #改写, ))
写出字节集 (.取图片 (.宽度, .高度))
.清除 ()
关闭文件 ()


 ' 不属于任何一个程序集、类模块的函数：
