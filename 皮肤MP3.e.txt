 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 299
    高度 = 413
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\皮肤MP3.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “简简单单MP3”
    帮助文件名 = “”



.声音 系统优化, " ' 已保存到：D:\易语言学习\Data\皮肤MP3.e\系统优化", , 
.常量 致爱丽丝, "“200 lklklikjh-- cehi-- egij-- elklklikch-- cehi-- ejih-- 0lklklikjh-- cehi-- egij-- elklklikjh-- cehi-- ejih-- ijkl-- gmlk-- flkj-- ekji--”", , 
.常量 雨的印记, "“300 gjkk-l-l---jkl g-n-i---inop j-q-l--
r-r-q-p---i--- l-q-p-n- i-o-j--- nm
m-n-g---j---”", , 
.常量 祈祷, "“200 g-acb-bcb--- caa-aacde-edddd-----
zacd-dge---dcc-a-acc-caaaa-----”", , 
.常量 同一首歌, "“240 z---c-d-e--fe-c-d---c-a-c-------
z---c-d-e-efg-c-f--eg-deedd-----
e---g-i-i-hh---g-ghi--hge-------
f--fg-h-g-fed---b-baz-a-c-------”", , 
.常量 男儿当自强, "“200 h-j-hjhgh---h-j-hjghk---
l-j-k-n-l-k-l-j- >kljk< h- >jkhj< g-
0hjkj>hj<g-hjg-0-0- 
hjhgh-0- jkj>hj<g-0-
hjghk-0- lnklo---”", , 
.常量 祝你生日快乐, "“240 ggh-g-j-i--- ggh-g-k-j---
ggn-l-j-i-h--- 0-
mml-j-k-j---”", , 
.常量 沧海一声笑, "“120 h>hg<e>ed<c--- e>ed<c>az<z-
z>za<z>za<c>cd<egh>hged<cd---”", , 
.常量 小城故事, "“240 e--ghghjhgg----- g--hedegd-------
d--eg-hjh-hjh-g- g-gde-d-c-------
cacde---deacz--- acdegejhg-------
j-jhg-ghg-ged--- g-ghe-d-c-------”", , 
.常量 月亮代表我的心, "“240 0zc--eg--cb--eg-0gh-ij--h-g------
edc--cc-edc--cc- ded-ca-ded-----
0zc--eg--cb--eg-0gh-ij--h-g------
edc--cc-edc--cc- ded--ab-cdc-----
ege--dc-g-i----- aba--ba--ze-----
ge--dc-g-b----- abc--cc-ded-----
0zc--eg--cb--eg-- gh--ij--h-g----
edc--cc- edc--cc-ded--ab-cdc-----”", , 
.常量 水手, "“240 a-ede-defgfde- 
0->0e<f>fe<dcd>dc<decbacb---
a-ede-def>ff<ede--- f>fe<dcd>dc<debba>za<a---”", , 
.常量 , , , 
.常量 , , , 
.常量 键代码A, "65", , 
.常量 键代码Z, "90", , 
.常量 键代码0, "48", , 
.常量 键代码_小于号, "60", , 
.常量 键代码_大于号, "62", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 2 0 扩展界面支持库二
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' eMMedia 824F144B108A4bcbB966F45670D42A00 3 0 多媒体支持库
 ' shell 52F260023059454187AF826A3C07AF2A 3 0 操作系统界面功能支持库
 ' HtmlView 5014D8FA6DCA40b68FA626D8183666EB 2 2 超文本浏览框支持库
 ' EDataStructure 0AFF5F28B2CB42ce906AA27D6E485457 2 0 数据结构支持库
 ' spec A512548E76954B6E92C21055517615B0 3 1 特殊功能支持库





.窗口程序集 窗口程序集1, , , 

.程序集变量 音乐长度, 整数型, , , 
.程序集变量 标签播放模式, 整数型, , , 
.程序集变量 现行播放文件, 文本型, , , 
.程序集变量 音乐位置, 整数型, , , 
.程序集变量 左音量, 整数型, , , 
.程序集变量 右音量, 整数型, , , 
.程序集变量 播放模式, 逻辑型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 i, 整数型, , , 

 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

4.未知支持库函数_0 ()
左音量.未知支持库函数_7 (右音量)
赋值 (.位置, 相除 (左音量, 655.34))
赋值 (.标题, 到文本 (.位置))

赋值 (., 306)
赋值 (., 219)
.如果真 (等于 (未知支持库函数_20 (), 0))
    信息框 (“未发现MIDI设备！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (0.未知支持库函数_22 (), 假))
    信息框 (“未能打开默认MIDI设备！”, 0, )
    返回 ()
.如果真结束
置MIDI组件 ()
构造音符对照表 ()
获取焦点 ()
构造乐谱列表 ()
赋值 (.时钟周期, 1000)

.子程序 _时钟1_周期事件, 空白型, , 
.局部变量 刻度位置, 整数型, , , 
.局部变量 当前音乐时长, 整数型, , , 

赋值 (音乐位置, 未知支持库函数_63 ())
赋值 (刻度位置, 相乘 (相除 (音乐位置, 音乐长度), 100))
赋值 (.位置, 刻度位置)
赋值 (当前音乐时长, 未知支持库函数_64 ())
.如果真 (大于或等于 (相除 (未知支持库函数_63 (), 1000), 当前音乐时长))
    赋值 (.时钟周期, 100)
    _图形按钮2_被单击 ()
    _图形按钮3_被单击 ()
.如果真结束
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _滑块条1_位置被改变, 空白型, , 
相乘 (相除 (.位置, 100), 音乐长度).未知支持库函数_66 ()

.子程序 _超级按钮1_被单击, 空白型, , 
赋值 (.过滤器, “媒体文件（*.mp3）|*.mp3”)
.如果真 (等于 (打开 (), 真))
    .插入表项 (取文本右边 (.文件名, 相减 (取文本长度 (.文件名), 倒找文本 (.文件名, “\”, , 假))), , , , )
    相减 (取表项数 (), 1).置标题 (1, .文件名)
    获取焦点 ()
.如果真结束
赋值 (.时钟周期, 100)
' 本源码来自易语言资源网(www.5A5X.com)
赋值 (.时钟周期, 100)

.子程序 _超级按钮4_被单击, 空白型, , 
.局部变量 文件夹, 文本型, , , 

赋值 (文件夹, 未知支持库函数_2 (“请选择文件夹,搜索MP3”, 假))
.如果真 (等于 (文件夹, “”))
    返回 ()
.如果真结束
添加MP3文件 (文件夹)
获取焦点 ()
赋值 (.时钟周期, 100)
赋值 (.时钟周期, 100)

.子程序 添加MP3文件, 空白型, , 
.参数 搜索目录, 文本型, , 

.局部变量 文件名, 文本型, , , 
.局部变量 子目录, 文本型, , , 


.如果真 (不等于 (取文本右边 (搜索目录, 1), “\”))
    赋值 (搜索目录, 相加 (搜索目录, “\”))
.如果真结束

赋值 (文件名, 寻找文件 (相加 (搜索目录, “*.mp3”), 39))
.判断循环首 (不等于 (文件名, “”))
    处理事件 ()
    .如果真 (并且 (不等于 (文件名, “.”), 不等于 (文件名, “..”)))
        .插入表项 (文件名, , , , )
        相减 (取表项数 (), 1).置标题 (1, 相加 (搜索目录, 文件名))
    .如果真结束
    赋值 (文件名, 寻找文件 ())
.判断循环尾 ()
赋值 (子目录, 寻找文件 (相加 (搜索目录, “*.*”), #子目录))
.判断循环首 (不等于 (子目录, “”))
    .如果真 (并且 (不等于 (子目录, “.”), 不等于 (子目录, “..”)))
        处理事件 ()
        添加MP3文件 (相加 (搜索目录, 子目录))
    .如果真结束
    赋值 (子目录, 寻找文件 (#子目录))
.判断循环尾 ()

.子程序 窗口1_创建完毕, 空白型, , 
赋值 (.位置, 180)
赋值 (.位置, 170)
赋值 (.位置, 160)
赋值 (.位置, 150)
赋值 (.位置, 140)
赋值 (.位置, 135)
赋值 (.位置, 130)
赋值 (.位置, 125)
赋值 (.位置, 120)
赋值 (.位置, 115)
赋值 (.位置, 110)
赋值 (.位置, 105)
赋值 (.位置, 100)
赋值 (.位置, 95)
赋值 (.位置, 90)
赋值 (.位置, 85)
赋值 (.位置, 80)
赋值 (.位置, 75)
赋值 (.位置, 70)
赋值 (.位置, 65)
赋值 (.位置, 60)
赋值 (.位置, 55)
赋值 (.位置, 50)
赋值 (.位置, 45)
赋值 (.位置, 40)
赋值 (.位置, 35)
赋值 (.位置, 30)
赋值 (.位置, 25)
赋值 (.位置, 20)
赋值 (.位置, 15)
赋值 (.位置, 10)
赋值 (.位置, 10)
赋值 (.位置, 10)
赋值 (.位置, 5)
赋值 (.位置, 28)
赋值 (.位置, 59)
赋值 (.位置, 20)
赋值 (.位置, 35)
赋值 (.位置, 70)
赋值 (.位置, 10)
赋值 (.位置, 40)

.子程序 _时钟2_周期事件, 空白型, , 
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))
赋值 (.位置, 相加 (.位置, 取随机数 (0, 100)))

.子程序 _时钟3_周期事件, 空白型, , 
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))
赋值 (.位置, 取随机数 (0, 100))

.子程序 _音量调节滑块条_位置被改变, 空白型, , 
_启动窗口.未知支持库函数_8 (., 相乘 (.位置, 655.34), 相乘 (.位置, 655.34))
赋值 (.标题, 到文本 (.位置))

.子程序 _系统主音量_音量改变, 空白型, , 
左音量.未知支持库函数_7 (右音量)
赋值 (.位置, 相除 (左音量, 655.34))
赋值 (.标题, 到文本 (.位置))

.子程序 _组合框2_列表项被选择, 空白型, , 
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _图形按钮1_被单击, 空白型, , 
赋值 (., 相减 (., 1))
未知支持库函数_57 ()
.取标题 (., 1).未知支持库函数_56 ()
-1.未知支持库函数_66 ()
获取焦点 ()
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _图形按钮2_被单击, 空白型, , 
赋值 (., 相加 (., 1))
未知支持库函数_57 ()
.取标题 (., 1).未知支持库函数_56 ()
-1.未知支持库函数_66 ()
获取焦点 ()

.子程序 _图形按钮3_被单击, 空白型, , 
.如果真 (等于 (取表项数 (), 0))
    信息框 (“播放列表里没有文件，请添加。”, 相加 (0, #警告图标), )
    返回 ()
.如果真结束
.如果真 (等于 (., -1))
    赋值 (., 0)
.如果真结束
' 本源码来自易语言资源网(www.5A5X.com)
.取标题 (., 1).未知支持库函数_56 ()
-1.未知支持库函数_66 ()
获取焦点 ()
赋值 (.时钟周期, 500) ' 时钟是用来自动播放下一首的


.子程序 _图形按钮4_被单击, 空白型, , 
.如果真 (等于 (未知支持库函数_61 (), 1))
    获取焦点 ()
.如果真结束
未知支持库函数_67 ()



.子程序 _超级按钮2_被单击, 空白型, , 
赋值 (., .内容)

.子程序 _按键接收器_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

处理按下某键 (键代码, 功能键状态)
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _按键接收器_放开某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

处理放开某键 (键代码, 功能键状态)


.子程序 设置编辑框只读状态, 空白型, , 
.参数 编辑框, 编辑框, , 
.参数 只读, 逻辑型, , 

赋值 (编辑框.禁止, 只读)
赋值 (编辑框.背景颜色, 选择 (只读, #默认色, #白色))

.子程序 _按钮_播放乐谱_被单击, 空白型, , 
.如果真 (等于 (., “0”))
    赋值 (., “1”)
    赋值 (., “停止播放”)
    设置编辑框只读状态 (真)
    设置编辑框只读状态 (真)
    播放乐谱 (.内容, 到整数 (.内容))
.如果真结束
' 本源码来自易语言资源网(www.5A5X.com)
停止播放乐谱 ()
赋值 (., “0”)
赋值 (., “自动播放”)
设置编辑框只读状态 (假)
设置编辑框只读状态 (假)


.子程序 _按键接收器_获得焦点, 空白型, , 
赋值 (.选中, 真)
赋值 (.背景颜色, #绿色)
赋值 (.标题, “已处于弹奏模式，请按键盘”)

.子程序 _按键接收器_失去焦点, 空白型, , 
赋值 (.选中, 假)
赋值 (.背景颜色, #嫩黄)
赋值 (.标题, “点击此处进入弹奏模式”)
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 构造乐谱列表, 空白型, , 
清空 ()
“1 - 致爱丽丝”.加入项目 ()
“2 - 雨的印记”.加入项目 ()
“3 - 祈祷”.加入项目 ()
“4 - 同一首歌”.加入项目 ()
“5 - 男儿当自强”.加入项目 ()
“6 - 祝你生日快乐”.加入项目 ()
“7 - 沧海一声笑”.加入项目 ()
“8 - 小城故事”.加入项目 ()
“9 - 月亮代表我的心”.加入项目 ()
“10 - 水手”.加入项目 ()
赋值 (.现行选中项, 0)
_组合框_预定义乐谱_列表项被选择 ()


.子程序 _组合框_预定义乐谱_列表项被选择, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 乐谱常量, 文本型, , , 

赋值 (i, 相加 (.现行选中项, 1))
赋值 (乐谱常量, 多项选择 (i, #致爱丽丝, #雨的印记, #祈祷, #同一首歌, #男儿当自强, #祝你生日快乐, #沧海一声笑, #小城故事, #月亮代表我的心, #水手))
' 本源码来自易语言资源网(www.5A5X.com)
赋值 (.内容, 取常量中的乐谱 (乐谱常量))
赋值 (.内容, 到文本 (取常量中的每分钟拍数 (乐谱常量)))

获取焦点 ()


.子程序 取常量中的每分钟拍数, 整数型, , 
.参数 s, 文本型, , 

返回 (到整数 (取文本左边 (s, 3)))


.子程序 取常量中的乐谱, 文本型, , 
.参数 s, 文本型, , 

返回 (取文本右边 (s, 相减 (取文本长度 (s), 4)))
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _编辑框_乐谱_内容被改变, 空白型, , 
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _时钟4_周期事件, 空白型, , 
赋值 (_启动窗口..内容, 到文本 (取现行时间 ()))

.程序集 播放处理, , , 

.程序集变量 _midi, 未知类型0x40003, , , 
.程序集变量 _演奏中音符, 整数型, , , 为0表示没有演奏
.程序集变量 _音符对照表, 未知类型0x70007, , , 
.程序集变量 _已按下键代码, 整数型, , , 为0表示没键被按下
.程序集变量 _用户要求停止播放, 逻辑型, , , 
.子程序 置MIDI组件, 空白型, , 
.参数 midi, 未知类型0x40003, , 

赋值 (_midi, midi)
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--


.子程序 演奏音符, 空白型, , 
.参数 音符, 整数型, , 
.参数 简谱, 文本型, 可空, 
.参数 持续时间, 整数型, 可空, 以毫秒为单位，为0表示一直演奏下去（直到“停止演奏音符()”被调用）

.如果真 (大于 (_演奏中音符, 0))
    .如果 (等于 (音符, _演奏中音符))
        返回 ()
    .否则
        停止演奏音符 () ' 如何处理和弦？
    .如果结束
    
.如果真结束
_midi.未知支持库函数_29 (音符, )
赋值 (_演奏中音符, 音符)
调试输出 (相加 (“正在演奏：”, 简谱, “ (”, 到文本 (_演奏中音符), “)”))

.如果真 (大于 (持续时间, 0))
    延迟 (持续时间)
    停止演奏音符 ()
.如果真结束


.子程序 停止演奏音符, 空白型, , 
_midi.未知支持库函数_30 (_演奏中音符, )
赋值 (_演奏中音符, 0)
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 处理按下某键, 空白型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 音符, 整数型, , , 
.局部变量 简谱, 文本型, , , 

.如果真 (等于 (键代码, _已按下键代码))
    返回 ()
.如果真结束
赋值 (_已按下键代码, 键代码)

赋值 (音符, 查询键代码对应音符 (键代码, 简谱))
.如果真 (大于 (音符, 0))
    演奏音符 (音符, 简谱)
.如果真结束
 ' 本源码来自易语言资源网(www.5A5X.com)
处理事件 ()


.子程序 处理放开某键, 空白型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

停止演奏音符 ()
赋值 (_已按下键代码, 0)


.子程序 构造音符对照表, 空白型, , 
 ' A..Z;
 ' 本源码来自易语言资源网(www.5A5X.com)
 ' ..5 - ..7
添加字符音符对 (“S”, 43, “..5”)
添加字符音符对 (“T”, 45, “..6”)
添加字符音符对 (“U”, 47, “..7”)
 ' .1 - .7
添加字符音符对 (“V”, 48, “.1”)
添加字符音符对 (“W”, 50, “.2”)
添加字符音符对 (“X”, 52, “.3”)
添加字符音符对 (“Y”, 53, “.4”)
添加字符音符对 (“Z”, 55, “.5”)
添加字符音符对 (“A”, 57, “.6”)
添加字符音符对 (“B”, 59, “.7”)
 ' 1 - 7
添加字符音符对 (“C”, 60, “1”)
添加字符音符对 (“D”, 62, “2”)
添加字符音符对 (“E”, 64, “3”)
添加字符音符对 (“F”, 65, “4”)
添加字符音符对 (“G”, 67, “5”)
添加字符音符对 (“H”, 69, “6”)
添加字符音符对 (“I”, 71, “7”)
 ' 1. - 7.
添加字符音符对 (“J”, 72, “1.”)
添加字符音符对 (“K”, 74, “2.”)
添加字符音符对 (“L”, 76, “3.”)
添加字符音符对 (“M”, 77, “4.”)
添加字符音符对 (“N”, 79, “5.”)
添加字符音符对 (“O”, 81, “6.”)
添加字符音符对 (“P”, 83, “7.”)
 ' 1.. - 3..
添加字符音符对 (“Q”, 84, “1..”)
添加字符音符对 (“R”, 86, “2..”)
 ' 添加字符音符对 (“S”, 88, “3..”)


.子程序 添加键代码音符对, 空白型, , 
.参数 键代码, 整数型, , 
.参数 音符, 整数型, , 
.参数 简谱, 文本型, , 

.局部变量 node, 未知类型0x70001, , , 

node.未知支持库函数_3 (“音符”, 音符)
node.未知支持库函数_3 (“简谱”, 简谱)
_音符对照表.未知支持库函数_91 (到字节集 (键代码), node)
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 添加字符音符对, 空白型, , 
.参数 字符, 文本型, , 
.参数 音符, 整数型, , 
.参数 简谱, 文本型, , 

添加键代码音符对 (取代码 (到大写 (字符), ), 音符, 简谱)


.子程序 查询键代码对应音符, 整数型, , 返回0表示没有对应音符
.参数 键代码, 整数型, , 
.参数 简谱, 文本型, 参考, 

.局部变量 node, 未知类型0x70001, , , 
.局部变量 x, 整数型, , , 

.如果真 (_音符对照表.未知支持库函数_92 (到字节集 (键代码), node))
    node.未知支持库函数_8 (“音符”, x)
    node.未知支持库函数_11 (“简谱”, 简谱)
.如果真结束
返回 (x)
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 播放乐谱, 空白型, , 
.参数 乐谱, 文本型, , 
.参数 每分钟播放拍数, 整数型, 可空, 默认为120

.局部变量 i, 整数型, , , 
.局部变量 j, 整数型, , , 
.局部变量 键代码, 整数型, , , 
.局部变量 拍数, 整数型, , , 以拍数为播放单位
.局部变量 短线键代码, 整数型, , , 
.局部变量 音符, 整数型, , , 
.局部变量 简谱, 文本型, , , 
.局部变量 乐谱字符数, 整数型, , , 
.局部变量 速率, 整数型, , , 1024表示正常, 乘2快一倍, 除2慢一倍

.如果真 (是否为空 (每分钟播放拍数))
    赋值 (每分钟播放拍数, 120)
.如果真结束

.如果真 (等于 (乐谱, “”))
    返回 ()
.如果真结束
 ' 本源码来自易语言资源网(www.5A5X.com)
赋值 (乐谱, 到大写 (乐谱))
赋值 (乐谱字符数, 取文本长度 (乐谱))
赋值 (短线键代码, 取代码 (“-”, ))
赋值 (速率, 1024)
赋值 (_用户要求停止播放, 假)
赋值 (i, 1)
.判断循环首 (小于或等于 (i, 乐谱字符数))
    .如果真 (_用户要求停止播放)
        跳出循环 ()
    .如果真结束
    
    赋值 (键代码, 取代码 (乐谱, i))
    .如果真 (或者 (并且 (大于或等于 (键代码, #键代码A), 小于或等于 (键代码, #键代码Z)), 等于 (键代码, #键代码0))) ' a - z, 0
        赋值 (拍数, 1)
        .判断循环首 (等于 (取代码 (乐谱, 相加 (i, 1)), 短线键代码))
            赋值 (拍数, 相加 (拍数, 1))
            赋值 (i, 相加 (i, 1))
        .判断循环尾 ()
        赋值 (音符, 查询键代码对应音符 (键代码, 简谱))
        .如果 (不等于 (键代码, #键代码0))
            演奏音符 (音符, 简谱, 计算音符播放时间 (每分钟播放拍数, 拍数, 速率))
        .否则
            延迟 (计算音符播放时间 (每分钟播放拍数, 拍数, 速率))
        .如果结束
         ' 本源码来自易语言资源网(www.5A5X.com)
        赋值 (i, 相加 (i, 1))
        处理事件 ()
        到循环尾 ()
    .如果真结束
    
    .判断开始 (等于 (键代码, #键代码_大于号)) ' >, 播放速度加倍
        赋值 (速率, 相乘 (速率, 2))
    .判断 (等于 (键代码, #键代码_小于号)) ' <, 播放速度降一倍
        赋值 (速率, 整除 (速率, 2))
    .默认
        
    .判断结束
    
    赋值 (i, 相加 (i, 1))
    处理事件 ()
.判断循环尾 ()


.子程序 计算音符播放时间, 整数型, , 
.参数 每分钟播放拍数, 整数型, , 
.参数 几拍, 整数型, , 播放几拍
.参数 速率, 整数型, , 1024表示正常, 乘2快一倍, 除2慢一倍

.局部变量 x, 整数型, , , 

赋值 (x, 相乘 (相除 (相乘 (60, 1000), 每分钟播放拍数), 几拍))
返回 (相除 (相乘 (x, 1024), 速率))
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 停止播放乐谱, 空白型, , 
赋值 (_用户要求停止播放, 真)



 ' 不属于任何一个程序集、类模块的函数：
