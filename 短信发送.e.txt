 ' 文件类型：Windows窗口程序

 ' 程序名称：短信发送
 ' 程序描述：
 ' 程序作者：许胜慧
 ' 邮政编码：100000
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：xsh_xsh@163.com
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 主窗口
    左边 = 0
    顶边 = 0
    宽度 = 635
    高度 = 415
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 5
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\短信发送.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “短信发送”
    帮助文件名 = “”

窗口 短信范文
    左边 = 50
    顶边 = 50
    宽度 = 506
    高度 = 370
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 5
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\短信发送.e\短信范文_图标.ico
    背景音乐 =  ' 空
    标题 = “短信范文”
    帮助文件名 = “”

窗口 短信记录
    左边 = 50
    顶边 = 50
    宽度 = 506
    高度 = 300
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\短信发送.e\短信记录_图标.ico
    背景音乐 =  ' 空
    标题 = “发送记录”
    帮助文件名 = “”

窗口 加范文窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\短信发送.e\加范文窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “收藏”
    帮助文件名 = “”

窗口 用户名窗口
    左边 = 50
    顶边 = 50
    宽度 = 350
    高度 = 197
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 6
    底图方式 = 2
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 真
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\短信发送.e\用户名窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “用户登录”
    帮助文件名 = “”

窗口 管理窗口
    左边 = 50
    顶边 = 50
    宽度 = 552
    高度 = 423
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “管理窗口”
    帮助文件名 = “”

窗口 更改金额窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 6
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “更改金额窗口”
    帮助文件名 = “”

窗口 查看回复窗口
    左边 = 50
    顶边 = 50
    宽度 = 500
    高度 = 300
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\短信发送.e\查看回复窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “查看回复窗口”
    帮助文件名 = “”

窗口 配置odbc窗口
    左边 = 50
    顶边 = 50
    宽度 = 376
    高度 = 243
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “配置ODBC”
    帮助文件名 = “”



.图片 tianqi, " ' 已保存到：D:\易语言学习\Data\短信发送.e\tianqi", 公开, 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' HtmlView 5014D8FA6DCA40b68FA626D8183666EB 1 1 超文本浏览框支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 2 5 扩展界面支持库三
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 1 3 高级表格支持库
 ' internet 707ca37322474f6ca841f0e224f4b620 1 0 互联网支持库
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 1 0 数据操作支持库一
 ' iext5 {E5000198-4471-40e2-92BC-D0BA075BDBB2} 1 5 扩展界面支持库五
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库



 ' 所需要的模块
 ' 在线更新模块 C:\Program Files\e\ecom\模块_在线更新.ec


.全局变量 号码, 文本型, , , 
.全局变量 短信内容, 文本型, , , 
.全局变量 范文插入, 文本型, , , 
.全局变量 登录名, 文本型, , , 
.全局变量 修改状态, 逻辑型, , , 
.全局变量 服务器, 文本型, , , 
.全局变量 系统用户, 文本型, , , 
.全局变量 系统用户密码, 文本型, , , 
.全局变量 本数据库, 文本型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 yhqm, 文本型, , , 
.程序集变量 发送字节, 整数型, , , 
.程序集变量 豆号数, 整数型, , , 
.程序集变量 条数, 整数型, , , 
.程序集变量 剩余, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
未知支持库函数_0 (#)
.如果真 (取反 (文件是否存在 (相加 (取运行目录 (), “\tianqi.html”))))
    写到文件 (相加 (取运行目录 (), “\tianqi.html”), #tianqi)
.如果真结束

载入 (用户名窗口, , 真)
赋值 (., 相加 (取运行目录 (), “\tianqi.html”))
赋值 (.内容, 相加 (“版本”, 取文本左边 (到文本 (读入文件 (相加 (取运行目录 (), “\edition.ini”))), 4), “ 双击升级”))
.如果真 (等于 (登录名, “sys”))
    赋值 (.可视, 真)
    赋值 (.禁止, 假)
.如果真结束


.子程序 _内容框_内容被改变, 空白型, , 
赋值 (发送字节, 相加 (取文本长度 (.内容), 取文本长度 (.内容)))
赋值 (.内容, 到文本 (发送字节))
计算条数 ()

.子程序 计算条数, 空白型, , 
赋值 (豆号数, 相加 (相除 (倒找文本 (.内容, “.”, , 真), 12), 1))
.判断开始 (等于 (发送字节, 0))
    赋值 (条数, 0)
.判断 (并且 (大于 (发送字节, 0), 小于 (发送字节, 140)))
    赋值 (条数, 1)
.判断 (并且 (大于或等于 (发送字节, 140), 小于 (发送字节, 280)))
    赋值 (条数, 2)
.判断 (并且 (大于或等于 (发送字节, 280), 小于 (发送字节, 420)))
    赋值 (条数, 3)
.判断 (大于 (发送字节, 420))
    赋值 (条数, 4)
.默认
    
.判断结束

.如果真 (等于 (豆号数, 0))
    赋值 (豆号数, 1)
.如果真结束
赋值 (.内容, 到文本 (相乘 (条数, 豆号数)))
赋值 (短信内容, .内容)


.子程序 _发送_被单击, 空白型, , 
.局部变量 SQL, 文本型, , , 

赋值 (号码, 子文本替换 (.内容, “.”, “,”, , , 真))
赋值 (短信内容, .内容)
赋值 (yhqm, .内容)
赋值 (SQL, 相加 (“insert into fsjl (发送人,已发短信,接收号码,发送日期,发送条数) values ('”, 登录名, “','”, 短信内容, “','”, 号码, “','”, 时间到文本 (取现行时间 (), ), “','”, .内容, “')”))
.判断开始 (等于 (取文本长度 (.内容), 0))
    信息框 (“不能发送空短信！”, 0, “错误”)
    获取焦点 ()
.判断 (或者 (小于 (取文本长度 (.内容), 10), 不等于 (取文本左边 (.内容, 1), “1”)))
    信息框 (“请输入手机号，或输入的手机号有误！”, 0, “错误”)
    赋值 (.内容, “”)
    获取焦点 ()
.判断 (大于 (剩余, 到整数 (.内容)))
    .判断开始 (不等于 (取字节集数据 (未知支持库函数_7 (相加 (“http://211.154.163.64:8080/send.jsp?circle=****&pwd=****&mobile=”, 号码, “%20&service=BZ&mtype=XXXF&msgid=3956724&message=”, 短信内容, yhqm)), #整数型, ), 0)) ' 此行内**为用户名与密码。。因为是公司的。所以不能公开，请谅解。
        .如果 (SQL.执行 ())
            信息框 (“本条短信已成功发送!”, 0, )
        .否则
            
        .如果结束
        
    .默认
        信息框 (“短信记录失败,请与管理员联系！”, 0, “错误”)
    .判断结束
    
.默认
    信息框 (“剩余金额不足！”, 0, “提示”)
.判断结束


.子程序 _取消_被单击, 空白型, , 
结束 ()

.子程序 _插入范文_被单击, 空白型, , 
载入 (短信范文, , 真)


.子程序 _发送记录_被单击, 空白型, , 
载入 (短信记录, , 真)


.子程序 __启动窗口_被激活, 空白型, , 
赋值 (.内容, 相加 (“当前用户:”, 登录名))
服务器.打开SQL数据库 (系统用户, 系统用户密码, 本数据库, , )
赋值 (剩余, 到整数 (相加 (“select * from je where 用户名='”, 登录名, “'”).查询 ().读 (5)))
赋值 (.内容, 相加 (“可发短信条数： ”, 到文本 (剩余)))
赋值 (.内容, 短信内容)
赋值 (.内容, 号码)
计算条数 ()

.子程序 _号码框_内容被改变, 空白型, , 
赋值 (号码, .内容)
计算条数 ()

.子程序 _按钮1_被单击, 空白型, , 
赋值 (号码, .内容)
.如果 (打开 ())
    赋值 (.内容, 读入文本 (打开文件 (.文件名, , ), ))
.否则
    赋值 (.内容, 号码)
.如果结束


.子程序 _其它工具_被单击, 空白型, , 
载入 (管理窗口, , 真)


.子程序 _回复按钮_被单击, 空白型, , 
载入 (查看回复窗口, , 真)


.子程序 _透明标签9_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

更新 (“短信发送”, “http://192.168.1.88/dxfs/update.txt”, , 真, _启动窗口., , , 1)


.子程序 _按钮2_被单击, 空白型, , 
生成列表 ()


.子程序 _注消_被单击, 空白型, , 
载入 (用户名窗口, , 真)


.子程序 _时钟1_周期事件, 空白型, , 
.如果真 (等于 (未知支持库函数_78 (), 取窗口句柄 ()))
    取鼠标水平位置 ().未知支持库函数_26 (取鼠标垂直位置 (), “当前版本只支持TXT文件格式,多个号码间请用豆号相隔例:  131234567890,13555566666,15912345645”, -1, 真)
.如果真结束


.子程序 _签名框_内容被改变, 空白型, , 
赋值 (发送字节, 相加 (取文本长度 (.内容), 取文本长度 (.内容)))
赋值 (.内容, 到文本 (发送字节))
计算条数 ()


.类模块 超文本浏览框, , , 

.窗口程序集 窗口程序集3, , , 

.子程序 _短信范文_创建完毕, 空白型, , 
未知支持库函数_0 (#)
赋值 (.连接文本, 相加 (“ ODBC;Description=”, 本数据库, “;DRIVER=SQL Server;SERVER=”, 服务器, “;UID=”, 系统用户, “;PWD=”, 系统用户密码, “;APP=易语言;WSID=XUSHENGHUI;DATABASE=”, 本数据库, “;Network=DBMSSOCN”))
赋值 (.查询SQL, 相加 (“select * from fw where 收藏人 in('默认','”, 登录名, “')”))


.子程序 _短信范文_尺寸被改变, 空白型, , 
0.移动 (37, 取用户区宽度 (), 相减 (取用户区高度 (), 37))

.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

服务器.打开SQL数据库 (系统用户, 系统用户密码, 本数据库, , )
.判断开始 (等于 (按钮索引, 1))
    赋值 (短信内容, 取光标行号 ().取文本 (1))
    销毁 ()
.判断 (等于 (按钮索引, 5))
    销毁 ()
.判断 (等于 (按钮索引, 2))
    赋值 (范文插入, 取光标行号 ().取文本 (1))
    赋值 (修改状态, 真)
    载入 (加范文窗口, , 真)
     ' 外部数据库1.执行 (“update fw set 范文='” ＋ 数据源1.取文本 (范文表格.取光标行号 (), 1) ＋ “' where 行数='” ＋ 到文本 (范文表格.取光标行号 ()) ＋ “'”, )
.判断 (等于 (按钮索引, 3))
    相加 (“delete from fw where 行数='”, 到文本 (取光标行号 ()), “'”).执行 ()
.默认
    
.判断结束


.窗口程序集 窗口程序集4, , , 

.子程序 _短信记录_创建完毕, 空白型, , 
未知支持库函数_0 (#)
赋值 (.连接文本, 相加 (“ ODBC;Description=”, 本数据库, “;DRIVER=SQL Server;SERVER=”, 服务器, “;UID=”, 系统用户, “;PWD=”, 系统用户密码, “;APP=易语言;WSID=XUSHENGHUI;DATABASE=”, 本数据库, “;Network=DBMSSOCN”))
.判断开始 (不等于 (登录名, “sys”))
    赋值 (.查询SQL, 相加 (“select * from fsjl where 发送人='”, 登录名, “'”))
.默认
    赋值 (.查询SQL, “select * from fsjl”)
.判断结束


.子程序 _短信记录_尺寸被改变, 空白型, , 
0.移动 (37, 取用户区宽度 (), 相减 (取用户区高度 (), 37))

.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.如果真 (等于 (按钮索引, 1))
    .如果 (等于 (取光标行号 ().取文本 (2), “”))
        信息框 (“请选择一条记录再重发！”, 0, )
    .否则
        赋值 (短信内容, 取光标行号 ().取文本 (2))
        赋值 (号码, 取光标行号 ().取文本 (3))
        销毁 ()
    .如果结束
    
.如果真结束
.如果真 (等于 (按钮索引, 2))
    赋值 (范文插入, 取光标行号 ().取文本 (2))
    载入 (加范文窗口, , 真)
.如果真结束
.如果真 (等于 (按钮索引, 4))
    销毁 ()
.如果真结束


.窗口程序集 窗口程序集2, , , 

.子程序 _加范文窗口_创建完毕, 空白型, , 
.局部变量 行数, 整数型, , , 

未知支持库函数_0 (#)
赋值 (.连接文本, 相加 (“ ODBC;Description=”, 本数据库, “;DRIVER=SQL Server;SERVER=”, 服务器, “;UID=”, 系统用户, “;PWD=”, 系统用户密码, “;APP=易语言;WSID=XUSHENGHUI;DATABASE=”, 本数据库, “;Network=DBMSSOCN”))
赋值 (.内容, 范文插入)
.变量循环首 (1, 取行数 (), 1, 行数)
    删全部空 (行数.取文本 (1)).加入项目 ()
.变量循环尾 ()
赋值 (.查询SQL, “”)
赋值 (.现行选中项, 0)
.如果真 (等于 (登录名, “sys”))
    赋值 (.可视, 真)
    赋值 (.禁止, 假)
.如果真结束

.如果 (修改状态)
    #底层.调整层次 ()
    赋值 (.禁止, 真)
    #顶层.调整层次 ()
    赋值 (.禁止, 假)
    赋值 (.标题, “要修改的信息：”)
.否则
    #顶层.调整层次 ()
    赋值 (.禁止, 假)
    #底层.调整层次 ()
    赋值 (.禁止, 真)
    赋值 (.标题, “要收藏的信息：”)
.如果结束


.子程序 _反回按钮_被单击, 空白型, , 
销毁 ()


.子程序 _确定按钮_被单击, 空白型, , 
.局部变量 SQL, 文本型, , , 

服务器.打开SQL数据库 (系统用户, 系统用户密码, 本数据库, , )
赋值 (SQL, 相加 (“insert into fw (范文,类型,收藏人) values ('”, 范文插入, “','”, .取项目文本 (.现行选中项), “','”, 登录名, “')”))
SQL.执行 ()
销毁 ()


.子程序 _组合框1_编辑内容被改变, 空白型, , 
赋值 (.禁止, 假)


.子程序 _按钮1_被单击, 空白型, , 
.加入项目 (.内容, )
相加 (“insert into lx (类型) values ('”, .取项目文本 (.现行选中项), “')”).执行 ()


.子程序 _按钮2_被单击, 空白型, , 
相加 (“delete from lx where 类型='”, .取项目文本 (.现行选中项), “')”).执行 ()


.窗口程序集 窗口程序集6, , , 

.子程序 _用户名窗口_创建完毕, 空白型, , 
.局部变量 行数, 整数型, , , 

.判断开始 (等于 (文件是否存在 (相加 (取运行目录 (), “\odbc.ini”)), 真))
    赋值 (服务器, 到文本 (未知支持库函数_4 (到字节集 (读配置项 (相加 (取运行目录 (), “\odbc.ini”), “odbc”, “ip”, )), “xsh”, #)))
    赋值 (系统用户, 到文本 (未知支持库函数_4 (到字节集 (读配置项 (相加 (取运行目录 (), “\odbc.ini”), “odbc”, “system”, )), “xsh”, #)))
    赋值 (系统用户密码, 到文本 (未知支持库函数_4 (到字节集 (读配置项 (相加 (取运行目录 (), “\odbc.ini”), “odbc”, “pwd”, )), “xsh”, #)))
    赋值 (本数据库, 到文本 (未知支持库函数_4 (到字节集 (读配置项 (相加 (取运行目录 (), “\odbc.ini”), “odbc”, “data”, )), “xsh”, #)))
.默认
    载入 (配置odbc窗口, , 真)
.判断结束

未知支持库函数_0 (#)
赋值 (.连接文本, 相加 (“ ODBC;Description=”, 本数据库, “;DRIVER=SQL Server;SERVER=”, 服务器, “;UID=”, 系统用户, “;PWD=”, 系统用户密码, “;APP=易语言;WSID=XUSHENGHUI;DATABASE=”, 本数据库, “;Network=DBMSSOCN”))
赋值 (.查询SQL, “yhm”)
.变量循环首 (1, 取行数 (), 1, 行数)
    删全部空 (行数.取文本 (1)).加入项目 ()
.变量循环尾 ()
赋值 (.查询SQL, “”)
赋值 (.现行选中项, 0)
服务器.打开SQL数据库 (系统用户, 系统用户密码, 本数据库, , )

.子程序 _退出_被单击, 空白型, , 
结束 ()


.子程序 _确定_被单击, 空白型, , 
.局部变量 sql, 整数型, , , 
.局部变量 MM, 文本型, , , 

赋值 (sql, 相加 (“select * from yhm where userid='”, .取项目文本 (.现行选中项), “'”).查询 ())
赋值 (MM, sql.读 (2))
.判断开始 (等于 (.内容, 删全部空 (MM)))
    赋值 (登录名, .取项目文本 (.现行选中项))
    清空 ()
    销毁 ()
.默认
    用户名窗口.调整层次 (#次高层)
    信息框 (“输入的密码不正确!”, 0, “错误”)
    用户名窗口.调整层次 (#最高层)
    赋值 (.内容, “”)
    获取焦点 ()
.判断结束


.子程序 _密码框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, 13))
    _确定_被单击 ()
.如果真结束


.窗口程序集 窗口程序集7, , , 

.程序集变量 行一, 整数型, , , 
.子程序 _管理窗口_创建完毕, 空白型, , 
.局部变量 行数, 整数型, , , 
.局部变量 sql, 整数型, , , 
.局部变量 金额查, 逻辑型, , , 
.局部变量 金额改, 逻辑型, , , 
.局部变量 用户管, 逻辑型, , , 

赋值 (.连接文本, 相加 (“ ODBC;Description=”, 本数据库, “;DRIVER=SQL Server;SERVER=”, 服务器, “;UID=”, 系统用户, “;PWD=”, 系统用户密码, “;APP=易语言;WSID=XUSHENGHUI;DATABASE=”, 本数据库, “;Network=DBMSSOCN”))
赋值 (.连接文本, 相加 (“ ODBC;Description=”, 本数据库, “;DRIVER=SQL Server;SERVER=”, 服务器, “;UID=”, 系统用户, “;PWD=”, 系统用户密码, “;APP=易语言;WSID=XUSHENGHUI;DATABASE=”, 本数据库, “;Network=DBMSSOCN”))
赋值 (.查询SQL, “yhm”)
.变量循环首 (1, 取行数 (), 1, 行数)
    删全部空 (行数.取文本 (1)).加入项目 ()
.变量循环尾 ()
赋值 (.查询SQL, “”)
服务器.打开SQL数据库 (系统用户, 系统用户密码, 本数据库, , )
赋值 (sql, 相加 (“select * from yhm where userid='”, 登录名, “'”).查询 ())
赋值 (金额查, sql.读 (3))
赋值 (金额改, sql.读 (4))
赋值 (用户管, sql.读 (5))
.如果真 (等于 (金额查, 假))
    0.未知支持库函数_26 (0, 真)
.如果真结束
.如果真 (等于 (金额改, 假))
    0.未知支持库函数_26 (1, 真)
.如果真结束
.如果真 (等于 (用户管, 假))
    1.未知支持库函数_24 (真)
.如果真结束


.子程序 _卷帘式菜单1_项目被选择, 空白型, , 
.参数 菜单索引, 整数型, , 
.参数 项目索引, 整数型, , 

.判断开始 (并且 (等于 (菜单索引, 0), 等于 (项目索引, 0)))
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.查询SQL, “jejl”)
    赋值 (.查询SQL, “je”)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    菜单初始化1 ()
    菜单初始化3 ()
    菜单初始化4 ()
    菜单初始化5 ()
.判断 (并且 (等于 (菜单索引, 0), 等于 (项目索引, 1)))
    载入 (更改金额窗口, , 真)
.判断 (并且 (等于 (菜单索引, 0), 等于 (项目索引, 2)))
    销毁 ()
.判断 (并且 (等于 (菜单索引, 1), 等于 (项目索引, 0)))
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    菜单初始化0 ()
    菜单初始化3 ()
    菜单初始化4 ()
    菜单初始化5 ()
.判断 (并且 (等于 (菜单索引, 1), 等于 (项目索引, 1)))
    赋值 (.可视, 真)
    赋值 (.禁止, 假)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 假)
    菜单初始化0 ()
    菜单初始化1 ()
    菜单初始化3 ()
    菜单初始化4 ()
    菜单初始化5 ()
.判断 (并且 (等于 (菜单索引, 1), 等于 (项目索引, 2)))
    赋值 (.可视, 真)
    赋值 (.禁止, 假)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 假)
    菜单初始化0 ()
    菜单初始化1 ()
    菜单初始化4 ()
    菜单初始化5 ()
.判断 (并且 (等于 (菜单索引, 1), 等于 (项目索引, 3)))
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.禁止, 假)
    赋值 (.可视, 真)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    菜单初始化0 ()
    菜单初始化1 ()
    菜单初始化3 ()
    菜单初始化5 ()
.判断 (并且 (等于 (菜单索引, 2), 或者 (等于 (项目索引, 0), 等于 (项目索引, 1))))
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    菜单初始化0 ()
    菜单初始化1 ()
    菜单初始化3 ()
    菜单初始化4 ()
    .判断开始 (等于 (项目索引, 0))
        获取焦点 ()
    .判断 (等于 (项目索引, 1))
        获取焦点 ()
    .默认
        
    .判断结束
    
.默认
    
.判断结束


.子程序 菜单初始化0, 空白型, , 
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.查询SQL, “”)
赋值 (.查询SQL, “”)


.子程序 菜单初始化1, 空白型, , 
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)


.子程序 菜单初始化3, 空白型, , 
赋值 (.可视, 假)
赋值 (.可视, 假)


.子程序 菜单初始化4, 空白型, , 
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)

.子程序 菜单初始化5, 空白型, , 
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (., 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)


.子程序 _重置_被单击, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)


.子程序 _添加_被单击, 空白型, , 
.局部变量 SQL, 文本型, , , 

服务器.打开SQL数据库 (系统用户, 系统用户密码, 本数据库, , )
.判断开始 (或者 (等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“用户名、密码不能为空，请填写完整的内容！”, #警告图标, “登录错误”)
.判断 (不等于 (.内容, .内容))
    信息框 (“两次输入的密码不相同，请重新填写正！”, #警告图标, “登录错误”)
.默认
    赋值 (SQL, 相加 (“insert into yhm (userid,password) values ('”, .内容, “','”, .内容, “')”))
    .如果 (SQL.执行 ())
        信息框 (“添加用户名成功!”, 0, )
    .否则
        信息框 (“添加用户名失败!”, 0, )
    .如果结束
    
.判断结束


.子程序 _修改密码按钮_被单击, 空白型, , 
.局部变量 SQL, 文本型, , , 

赋值 (SQL, 相加 (“update yhm set password='”, .内容, “' where userid='”, .取项目文本 (.现行选中项), “'”))
.如果 (SQL.执行 ())
    信息框 (“修改密码成功!”, 0, )
.否则
    信息框 (“修改密码失败!”, 0, )
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 sql, 整数型, , , 

.判断开始 (小于 (取文本长度 (.内容), 7))
    信息框 (“至少需要7位手机号码！！”, 0, )
.默认
    赋值 (., 真)
    0.未知支持库函数_32 (110)
    1.未知支持库函数_32 (110)
    2.未知支持库函数_32 (110)
    3.未知支持库函数_32 (0)
    0.未知支持库函数_9 (0, #., “手机号码”)
    0.未知支持库函数_9 (1, #., “所在城市”)
    0.未知支持库函数_9 (2, #., “手机卡类型”)
    赋值 (sql, 相加 (“select * from sjgsd where 号码='”, 取文本左边 (.内容, 7), “'”).查询 ())
    1.未知支持库函数_9 (0, #., .内容)
    1.未知支持库函数_9 (1, #., sql.读 (3))
    1.未知支持库函数_9 (2, #., sql.读 (4))
    赋值 (., 2)
.判断结束
sql.关闭记录集 ()

.子程序 _按钮2_被单击, 空白型, , 
.判断开始 (小于 (取文本长度 (.内容), 3))
    信息框 (“输入太少!”, 0, )
.默认
    赋值 (., 真)
    0.未知支持库函数_32 (100)
    1.未知支持库函数_32 (100)
    2.未知支持库函数_32 (100)
    3.未知支持库函数_32 (100)
    0.未知支持库函数_9 (0, #., “省洲名称”)
    0.未知支持库函数_9 (1, #., “地区名称”)
    0.未知支持库函数_9 (2, #., “邮政编码”)
    0.未知支持库函数_9 (3, #., “电话区号”)
    赋值 (.查询SQL, 相加 (“select * from csqhyb where 电话区号 like '”, 删全部空 (.内容), “%'”))
    .变量循环首 (1, 相加 (取行数 (), 1), 1, 行一)
        赋值 (., 相加 (取行数 (), 1))
        行一.未知支持库函数_9 (0, #., 行一.取文本 (1))
        行一.未知支持库函数_9 (1, #., 行一.取文本 (2))
        行一.未知支持库函数_9 (2, #., 行一.取文本 (3))
        行一.未知支持库函数_9 (3, #., 行一.取文本 (4))
    .变量循环尾 ()
    赋值 (.查询SQL, “”)
    
.判断结束


.子程序 _按钮3_被单击, 空白型, , 
.判断开始 (等于 (.内容, “”))
    信息框 (“不能为空!”, 0, )
.默认
    赋值 (., 真)
    赋值 (., 假)
    0.未知支持库函数_32 (100)
    1.未知支持库函数_32 (100)
    2.未知支持库函数_32 (100)
    3.未知支持库函数_32 (100)
    0.未知支持库函数_9 (0, #., “省洲名称”)
    0.未知支持库函数_9 (1, #., “地区名称”)
    0.未知支持库函数_9 (2, #., “邮政编码”)
    0.未知支持库函数_9 (3, #., “电话区号”)
    赋值 (.查询SQL, 相加 (“select * from csqhyb where 地区名称 like '”, 删全部空 (.内容), “%'”))
    .变量循环首 (1, 相加 (取行数 (), 1), 1, 行一)
        赋值 (., 相加 (取行数 (), 1))
        行一.未知支持库函数_9 (0, #., 行一.取文本 (1))
        行一.未知支持库函数_9 (1, #., 行一.取文本 (2))
        行一.未知支持库函数_9 (2, #., 行一.取文本 (3))
        行一.未知支持库函数_9 (3, #., 行一.取文本 (4))
    .变量循环尾 ()
    赋值 (.查询SQL, “”)
    
.判断结束


.子程序 _按钮4_被单击, 空白型, , 
.判断开始 (小于 (取文本长度 (.内容), 4))
    信息框 (“输入太少!”, 0, )
.默认
    赋值 (., 真)
    赋值 (., 假)
    0.未知支持库函数_32 (100)
    1.未知支持库函数_32 (100)
    2.未知支持库函数_32 (100)
    3.未知支持库函数_32 (100)
    0.未知支持库函数_9 (0, #., “省洲名称”)
    0.未知支持库函数_9 (1, #., “地区名称”)
    0.未知支持库函数_9 (2, #., “邮政编码”)
    0.未知支持库函数_9 (3, #., “电话区号”)
    赋值 (.查询SQL, 相加 (“select * from csqhyb where 邮政编码 like '”, 删全部空 (.内容), “%'”))
    .变量循环首 (1, 相加 (取行数 (), 1), 1, 行一)
        赋值 (., 相加 (取行数 (), 1))
        行一.未知支持库函数_9 (0, #., 行一.取文本 (1))
        行一.未知支持库函数_9 (1, #., 行一.取文本 (2))
        行一.未知支持库函数_9 (2, #., 行一.取文本 (3))
        行一.未知支持库函数_9 (3, #., 行一.取文本 (4))
    .变量循环尾 ()
    赋值 (.查询SQL, “”)
.判断结束


.子程序 _手机号框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, 13))
    _按钮1_被单击 ()
.如果真结束


.子程序 _区号框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, 13))
    _按钮2_被单击 ()
.如果真结束


.子程序 _城市框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, 13))
    _按钮3_被单击 ()
    
.如果真结束


.子程序 _邮编框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, 13))
    _按钮4_被单击 ()
    
.如果真结束


.子程序 _按钮5_被单击, 空白型, , 
.局部变量 SQL, 文本型, , , 

赋值 (SQL, 相加 (“delete from yhm where userid='”, .取项目文本 (.现行选中项), “'”))
.如果 (SQL.执行 ())
    信息框 (“删除用户名成功!”, 0, )
.否则
    信息框 (“删除用户名失败!”, 0, )
.如果结束


.子程序 _列表按钮_被单击, 空白型, , 
.局部变量 SQL, 文本型, , , 
.局部变量 jc, 整数型, , , 
.局部变量 jg, 整数型, , , 
.局部变量 yg, 整数型, , , 

.如果 (0.是否被选中 ())
    赋值 (jc, 1)
.否则
    赋值 (jc, 0)
.如果结束

.如果 (1.是否被选中 ())
    赋值 (jg, 1)
.否则
    赋值 (jg, 0)
.如果结束

.如果 (2.是否被选中 ())
    赋值 (yg, 1)
.否则
    赋值 (yg, 0)
.如果结束

赋值 (SQL, 相加 (“update yhm set 金额查询='”, 到文本 (jc), “',金额管理='”, 到文本 (jg), “',用户管理='”, 到文本 (yg), “' where userid='”, .取项目文本 (.现行选中项), “'”))
.如果 (SQL.执行 ())
    信息框 (“更改用户权限成功!”, 0, )
.否则
    信息框 (“更改用户权限失败!”, 0, )
.如果结束


.子程序 _用户名组合框_列表项被选择, 空白型, , 
.局部变量 jc, 逻辑型, , , 
.局部变量 jg, 逻辑型, , , 
.局部变量 yg, 逻辑型, , , 
.局部变量 sql, 整数型, , , 

赋值 (sql, 相加 (“select * from yhm where userid='”, .取项目文本 (.现行选中项), “'”).查询 ())
赋值 (jc, sql.读 (3))
赋值 (jg, sql.读 (4))
赋值 (yg, sql.读 (5))
.如果 (jc)
    0.选中项目 (真)
.否则
    0.选中项目 (假)
.如果结束

.如果 (jg)
    1.选中项目 (真)
.否则
    1.选中项目 (假)
.如果结束

.如果 (yg)
    2.选中项目 (真)
.否则
    2.选中项目 (假)
.如果结束


.窗口程序集 窗口程序集8, , , 

.程序集变量 选定名, 文本型, , , 
.程序集变量 SQL, 整数型, , , 
.子程序 _更改金额窗口_创建完毕, 空白型, , 
.局部变量 行数, 整数型, , , 

未知支持库函数_0 (#)
赋值 (.连接文本, 相加 (“ ODBC;Description=”, 本数据库, “;DRIVER=SQL Server;SERVER=”, 服务器, “;UID=”, 系统用户, “;PWD=”, 系统用户密码, “;APP=易语言;WSID=XUSHENGHUI;DATABASE=”, 本数据库, “;Network=DBMSSOCN”))
赋值 (.查询SQL, “je”)
.变量循环首 (1, 取行数 (), 1, 行数)
    删全部空 (行数.取文本 (1)).加入项目 ()
.变量循环尾 ()
赋值 (.查询SQL, “”)
服务器.打开SQL数据库 (系统用户, 系统用户密码, 本数据库, , )

.子程序 _按钮确定_被单击, 空白型, , 
.如果 (相加 (“insert into jejl (用户名,增加金额,日期,操作员) values ('”, .取项目文本 (.现行选中项), “',”, .内容, “,'”, 时间到文本 (取现行时间 (), ), “','”, 登录名, “')”).执行 ())
    信息框 (“更改金额成功”, 0, )
.否则
    信息框 (“更改金额失败”, 1, )
.如果结束


.子程序 _按钮返回1_被单击, 空白型, , 
销毁 ()


.子程序 _用户名组合框_列表项被选择, 空白型, , 
赋值 (SQL, 相加 (“select * from je where 用户名='”, .取项目文本 (.现行选中项), “'”).查询 ())
赋值 (.内容, 相加 (“该用户现有金额:￥”, SQL.读 (2)))
赋值 (.内容, 相加 (“剩余短信条数：”, 到文本 (SQL.读 (5))))


.子程序 _更改金额窗口_被激活, 空白型, , 
赋值 (SQL, 相加 (“select * from je where 用户名='”, .取项目文本 (.现行选中项), “'”).查询 ())
赋值 (.内容, 相加 (“该用户现有金额:￥”, SQL.读 (2)))
赋值 (.内容, 相加 (“剩余短信条数：”, 到文本 (SQL.读 (5))))


.窗口程序集 窗口程序集9, , , 

.子程序 _查看回复窗口_创建完毕, 空白型, , 
未知支持库函数_0 (#)
服务器.打开SQL数据库 (系统用户, 系统用户密码, 本数据库, , )
赋值 (.连接文本, 相加 (“ ODBC;Description=”, 本数据库, “;DRIVER=SQL Server;SERVER=”, 服务器, “;UID=”, 系统用户, “;PWD=”, 系统用户密码, “;APP=易语言;WSID=XUSHENGHUI;DATABASE=”, 本数据库, “;Network=DBMSSOCN”))

.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.局部变量 查询号码, 文本型, , , 
.局部变量 sql, 整数型, , , 
.局部变量 全部号码, 文本型, , , 
.局部变量 行, 整数型, , , 

.如果真 (等于 (按钮索引, 2))
    输入框 (“输入要查询的号码!多个号码间用逗号相隔．”, “按号码查询”, , 查询号码, )
    赋值 (., 相加 (“http://www.chinabdn.com/MsgList.asp?mobile=”, 查询号码))
    
.如果真结束

.如果真 (等于 (按钮索引, 4))
    销毁 ()
.如果真结束

.如果真 (等于 (按钮索引, 1))
    赋值 (.查询SQL, 相加 (“select DISTINCT(接收号码) from fsjl where 发送人='”, 登录名, “'”))
    .变量循环首 (1, 取行数 (), 1, 行)
        赋值 (全部号码, 相加 (行.取文本 (1), “,”, 全部号码))
    .变量循环尾 ()
    赋值 (., 相加 (“http://www.chinabdn.com/MsgList.asp?mobile=”, 全部号码))
    赋值 (.查询SQL, “”)
.如果真结束


.窗口程序集 窗口程序集10, , , 

.子程序 _按钮1确定_被单击, 空白型, , 
.局部变量 一, 字节集, , , 
.局部变量 二, 字节集, , , 
.局部变量 三, 字节集, , , 
.局部变量 四, 字节集, , , 

改变目录 (取运行目录 ())
赋值 (一, 未知支持库函数_3 (到字节集 (.内容), “xsh”, #))
赋值 (二, 未知支持库函数_3 (到字节集 (.内容), “xsh”, #))
赋值 (三, 未知支持库函数_3 (到字节集 (.内容), “xsh”, #))
赋值 (四, 未知支持库函数_3 (到字节集 (.内容), “xsh”, #))
.判断开始 (等于 (.内容, “”))
    信息框 (“请输入服务器IP”, 0, )
.判断 (等于 (写配置项 (相加 (取运行目录 (), “\odbc.ini”), “odbc”, “ip”, 到文本 (一)), 假))
    信息框 (“ODBC配置失败”, 0, )
    删除文件 (“odbc.ini”)
.判断 (等于 (写配置项 (相加 (取运行目录 (), “\odbc.ini”), “odbc”, “system”, 到文本 (二)), 假))
    信息框 (“ODBC配置失败”, 0, )
    删除文件 (“odbc.ini”)
.判断 (等于 (写配置项 (相加 (取运行目录 (), “\odbc.ini”), “odbc”, “pwd”, 到文本 (三)), 假))
    信息框 (“ODBC配置失败”, 0, )
    删除文件 (“odbc.ini”)
.判断 (等于 (写配置项 (相加 (取运行目录 (), “\odbc.ini”), “odbc”, “data”, 到文本 (四)), 假))
    信息框 (“ODBC配置失败”, 0, )
    删除文件 (“odbc.ini”)
.默认
    赋值 (服务器, 到文本 (未知支持库函数_4 (到字节集 (读配置项 (相加 (取运行目录 (), “\odbc.ini”), “odbc”, “ip”, )), “xsh”, #)))
    赋值 (系统用户, 到文本 (未知支持库函数_4 (到字节集 (读配置项 (相加 (取运行目录 (), “\odbc.ini”), “odbc”, “system”, )), “xsh”, #)))
    赋值 (系统用户密码, 到文本 (未知支持库函数_4 (到字节集 (读配置项 (相加 (取运行目录 (), “\odbc.ini”), “odbc”, “pwd”, )), “xsh”, #)))
    赋值 (本数据库, 到文本 (未知支持库函数_4 (到字节集 (读配置项 (相加 (取运行目录 (), “\odbc.ini”), “odbc”, “data”, )), “xsh”, #)))
    .如果 (服务器.打开SQL数据库 (系统用户, 系统用户密码, 本数据库, , ))
        信息框 (“ODBC配置成功”, 0, )
        .关闭记录集 ()
        销毁 ()
    .否则
        信息框 (“连接服务器失败”, 0, )
        删除文件 (“odbc.ini”)
        .关闭记录集 ()
    .如果结束
    
.判断结束


.子程序 _按钮1取消_被单击, 空白型, , 
结束 ()



.子程序 _配置odbc窗口_创建完毕, 空白型, , 
.局部变量 背景, 整数型, , , 

未知支持库函数_0 (#)


.子程序 _编辑框4_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, 13))
    _按钮1确定_被单击 ()
.如果真结束


.子程序 _编辑框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, 13))
    获取焦点 ()
.如果真结束


.子程序 _编辑框2_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, 13))
    获取焦点 ()
.如果真结束


.子程序 _编辑框3_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, 13))
    获取焦点 ()
.如果真结束


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 更新, 空白型, , 提供一个升级窗口，可自定义欢迎文本。
.参数 软件名称, 文本型, , 软件的名称，必须的
.参数 更新列表地址, 文本型, , 在服务器上的更新列表路径，例如：HTTP://www.66608.com/update.edb，请使用"生成列表"来创建列表数据库
.参数 自定义欢迎文本, 文本型, 可空, 在更新启动时显示的欢迎语句，如果不填写则使用默认。
.参数 是否搜寻正在运行的程序, 逻辑型, 可空, 如果要更新的文件正在运行的话，将不会更新成功，所以在运行时会搜寻指定标题的窗口，如果为假则不搜寻窗口。
.参数 要搜寻的程序标题, 文本型, 可空, 要搜寻的标题（如果“是否搜寻正在运行的程序”为假的话，此参数无效）
.参数 是否最小化升级窗口, 逻辑型, 可空, 如果为空,即为非最小化检查,而是弹出一个标准大窗口输入后检查.如果自动检查,检查到有新版本了,会弹出是否要升级的窗口.
.参数 要关闭的窗口句柄, 文本型, 可空, 如果空,即为没有可自动关闭的窗口.
.参数 是否需要XP化按钮, 整数型, 可空, 如果为0,即为非XP按钮,0.#无风格;  1.#蓝色风格;  2.#绿色风格;  3.#银色风格



.子程序 生成列表, 空白型, , 用来生成更新所用的列表数据库



 ' 不属于任何一个程序集、类模块的函数：
