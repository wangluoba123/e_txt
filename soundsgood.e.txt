 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 280
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 2
    底色 = 16761856 '  0xFFC400
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 16
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 已保存到：D:\易语言学习\Data\soundsgood.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “SoundsGood”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 228
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 65535 '  0xFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 21
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口2
    左边 = 50
    顶边 = 50
    宽度 = 280
    高度 = 74
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 65535 '  0xFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 2
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口3
    左边 = 50
    顶边 = 50
    宽度 = 190
    高度 = 46
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 16761856 '  0xFFC400
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 2
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口4
    左边 = 50
    顶边 = 50
    宽度 = 166
    高度 = 85
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 0 '  0x0
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 29
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口5
    左边 = 50
    顶边 = 50
    宽度 = 250
    高度 = 78
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 0 '  0x0
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 1
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口6
    左边 = 50
    顶边 = 50
    宽度 = 178
    高度 = 96
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 0 '  0x0
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 2
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.图片 眼1, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\眼1", , 
.图片 眼2, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\眼2", , 
.图片 嘴1, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\嘴1", , 
.图片 嘴2, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\嘴2", , 
.图片 最小1, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\最小1", , 
.图片 最小2, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\最小2", , 
.图片 关闭1, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\关闭1", , 
.图片 关闭2, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\关闭2", , 
.图片 出现1, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\出现1", , 
.图片 出现2, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\出现2", , 
.图片 帮助1, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\帮助1", , 
.图片 帮助2, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\帮助2", , 
.图片 下一首1, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\下一首1", , 
.图片 下一首2, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\下一首2", , 
.图片 上一首1, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\上一首1", , 
.图片 上一首2, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\上一首2", , 
.图片 暂停1, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\暂停1", , 
.图片 暂停2, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\暂停2", , 
.图片 弹出1, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\弹出1", , 
.图片 弹出2, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\弹出2", , 
.图片 加入1, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\加入1", , 
.图片 加入2, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\加入2", , 
.图片 上移1, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\上移1", , 
.图片 上移2, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\上移2", , 
.图片 下移1, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\下移1", , 
.图片 下移2, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\下移2", , 
.图片 搜索1, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\搜索1", , 
.图片 搜索2, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\搜索2", , 
.图片 打开1, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\打开1", , 
.图片 打开2, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\打开2", , 
.图片 保存1, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\保存1", , 
.图片 保存2, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\保存2", , 
.图片 停止1, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\停止1", , 
.图片 停止2, " ' 已保存到：D:\易语言学习\Data\soundsgood.e\停止2", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 6 系统核心支持库




.全局变量 当前轨道, 文本型, , , 
.全局变量 总轨道, 文本型, , , 
.全局变量 time, 文本型, , , 
.全局变量 分, 文本型, , , 
.全局变量 秒, 文本型, , , 
.全局变量 是否已播放, 逻辑型, , , 
.全局变量 正在播放CD, 逻辑型, , , 
.全局变量 正在播放音乐, 逻辑型, , , 
.全局变量 正在队列播放, 逻辑型, , , 
.全局变量 帮助, 逻辑型, , , 

.DLL命令 获得音量w, 整数型, "winmm.dll", "waveOutGetVolume", , 
    .参数 uDeviceID, 整数型, , 
    .参数 lpdwVolume, 整数型, 传址, 

.DLL命令 设置音量w, 整数型, "winmm.dll", "waveOutSetVolume", , 
    .参数 uDeviceID, 整数型, , 
    .参数 dwVolume, 整数型, , 

.DLL命令 获得音量m, 整数型, "winmm.dll", "midiOutGetVolume", , 
    .参数 uDeviceID, 整数型, , 
    .参数 lpdwVolume, 整数型, 传址, 

.DLL命令 设置音量m, 整数型, "winmm.dll", "midiOutSetVolume", , 
    .参数 uDeviceID, 整数型, , 
    .参数 dwVolume, 整数型, , 

.DLL命令 播放命令, 整数型, "winmm.dll", "mciSendStringA", , 
    .参数 lpstrCommad, 文本型, , 
    .参数 lpstrReturnString, 文本型, , 
    .参数 wReturnLength, 整数型, , 
    .参数 hCallback, 整数型, , 

.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (., #眼1)
赋值 (., #眼1)
赋值 (., #嘴1)
赋值 (., #最小1)
赋值 (., #关闭1)
赋值 (., #出现1)
赋值 (., #帮助1)
赋值 (., #停止1)

.子程序 _CD播放_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #停止1)
赋值 (., #眼1)
赋值 (., #嘴1)
.如果真 (并且 (小于 (取鼠标水平位置 (), 相加 (., 110)), 大于 (取鼠标水平位置 (), 相加 (., 80))))
    赋值 (., #眼2)
.如果真结束
赋值 (., 假)
.如果真 (等于 (帮助, 真))
    赋值 (窗口4.., “打开并播放打开的CD音乐...”)
    赋值 (窗口4., 相减 (取鼠标水平位置 (), 窗口4., 5))
    赋值 (窗口4., 相减 (取鼠标垂直位置 (), 相除 (窗口4., 2)))
    赋值 (窗口4., 真)
.如果真结束


.子程序 _打开_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #停止1)
赋值 (., #眼1)
赋值 (., #嘴1)
.如果真 (并且 (小于 (取鼠标水平位置 (), 相加 (., 190)), 大于 (取鼠标水平位置 (), 相加 (., 160))))
    赋值 (., #眼2)
.如果真结束
赋值 (., 假)
.如果真 (等于 (帮助, 真))
    赋值 (窗口4.., “打开并播放打开的MP3\MID\WAV音乐...”)
    赋值 (窗口4., 相减 (取鼠标水平位置 (), 窗口4., 5))
    赋值 (窗口4., 相减 (取鼠标垂直位置 (), 相除 (窗口4., 2)))
    赋值 (窗口4., 真)
.如果真结束


.子程序 _播放_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #停止1)
赋值 (., #眼1)
赋值 (., #眼1)
.如果 (并且 (小于 (取鼠标水平位置 (), 相加 (., 151)), 大于 (取鼠标水平位置 (), 相加 (., 123)), 大于 (取鼠标垂直位置 (), 相加 (., 130)), 小于 (取鼠标垂直位置 (), 相加 (., 162))))
    赋值 (., #嘴2)
    赋值 (., 假)
.否则
    赋值 (., #嘴1)
    赋值 (., 真)
.如果结束
.如果真 (等于 (帮助, 真))
    赋值 (窗口4.., “播放音乐\继续播放已经停止或暂停的音乐...”)
    赋值 (窗口4., 相减 (取鼠标水平位置 (), 窗口4., 5))
    赋值 (窗口4., 相减 (取鼠标垂直位置 (), 相除 (窗口4., 2)))
    赋值 (窗口4., 真)
.如果真结束


.子程序 __启动窗口_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #眼1)
赋值 (., #眼1)
赋值 (., #嘴1)
赋值 (., #最小1)
赋值 (., #关闭1)
赋值 (., #出现1)
赋值 (., #帮助1)
赋值 (., #停止1)
赋值 (., 72)
赋值 (., 152)
赋值 (., 120)
赋值 (., 120)
赋值 (., 72)
赋值 (., 120)
赋值 (., 100)
赋值 (., 152)
赋值 (., 真)

.子程序 _出现_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #出现2)
赋值 (., 假)
.如果真 (等于 (帮助, 真))
    赋值 (窗口4.., “查看MP3播放列表...”)
    赋值 (窗口4., 相减 (取鼠标水平位置 (), 窗口4., 5))
    赋值 (窗口4., 相减 (取鼠标垂直位置 (), 相除 (窗口4., 2)))
    赋值 (窗口4., 真)
.如果真结束


.子程序 _最小_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #最小2)
赋值 (., 假)
.如果真 (等于 (帮助, 真))
    赋值 (窗口4.., “最小化呀...”)
    赋值 (窗口4., 相减 (取鼠标水平位置 (), 窗口4., 5))
    赋值 (窗口4., 相减 (取鼠标垂直位置 (), 相除 (窗口4., 2)))
    赋值 (窗口4., 真)
.如果真结束


.子程序 _关闭_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #关闭2)
赋值 (., 假)
.如果真 (等于 (帮助, 真))
    赋值 (窗口4.., “关闭!不知道吗...”)
    赋值 (窗口4., 相减 (取鼠标水平位置 (), 窗口4., 5))
    赋值 (窗口4., 相减 (取鼠标垂直位置 (), 相除 (窗口4., 2)))
    赋值 (窗口4., 真)
.如果真结束


.子程序 _帮助_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #帮助2)
赋值 (., 假)

.子程序 _关闭_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 122)

.子程序 _最小_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 154)

.子程序 _CD播放_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (., #眼2))
    赋值 (., 75)
.如果真结束


.子程序 _打开_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (., #眼2))
    赋值 (., 75)
.如果真结束


.子程序 _出现_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 122)

.子程序 __启动窗口_位置被改变, 空白型, , 
赋值 (窗口1., 相加 (., .))
赋值 (窗口1., .)
赋值 (窗口2., 相加 (., .))
赋值 (窗口2., .)

.子程序 _帮助_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 154)

.子程序 子程序1, 空白型, , 
.参数 a, 文本型, 可空, 

载入 (窗口4, _启动窗口, 假)
赋值 (窗口4.., a)
.判断循环首 (小于 (窗口4., 相减 (., 窗口4.)))
    赋值 (窗口4., 相加 (窗口4., 5))
.判断循环尾 ()

.子程序 __启动窗口_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (并且 (等于 (键代码, 27), 是否已创建 (窗口4)))
    窗口4.销毁 ()
.如果真结束


.子程序 _播放_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (., #嘴2))
    赋值 (., 123)
.如果真结束


.子程序 子程序2, 空白型, , 
.参数 CD, 逻辑型, , 
.参数 文本, 文本型, 可空, 

载入 (窗口2, _启动窗口, 假)
.如果 (等于 (CD, 真))
    赋值 (窗口2.., 960)
    赋值 (窗口2.., 假)
    赋值 (窗口2.., 假)
    赋值 (窗口2.., 假)
    赋值 (窗口2.., 假)
    赋值 (窗口2.., 真)
.否则
    赋值 (窗口2.., 0)
    赋值 (窗口2.., 真)
    赋值 (窗口2.., 真)
    赋值 (窗口2.., 真)
    赋值 (窗口2.., 真)
    赋值 (窗口2.., 假)
    .如果 (正在播放音乐)
        赋值 (窗口2.., 相加 (“   正在播放：”, 窗口3.除去多余 (文本)))
    .否则
        赋值 (窗口2.., 相加 (“   正在播放：”, 文本))
    .如果结束
    
.如果结束
.判断循环首 (小于 (窗口2., 相加 (., .)))
    赋值 (窗口2., 相加 (窗口2., 2))
.判断循环尾 ()

.子程序 __启动窗口_将被销毁, 空白型, , 
.局部变量 容器, 短整数型, , , 
.局部变量 列表, 文本型, 静态, , 

停止播放CD ()
关闭CD ()

.子程序 _停止_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #眼1)
赋值 (., #眼1)
赋值 (., #嘴1)
赋值 (., #停止2)
赋值 (., 假)
.如果真 (等于 (帮助, 真))
    赋值 (窗口4.., “停止所有打开的音乐...”)
    赋值 (窗口4., 相减 (取鼠标水平位置 (), 窗口4., 5))
    赋值 (窗口4., 相减 (取鼠标垂直位置 (), 相除 (窗口4., 2)))
    赋值 (窗口4., 真)
.如果真结束


.子程序 _停止_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (是否已播放)
    停止播放 ()
    停止播放CD ()
    关闭CD ()
    赋值 (窗口2.., 0)
    赋值 (窗口2.., “   正在播放：”)
.否则
    子程序1 (“现在还没有播放音乐,不能停止...”)
.如果结束


.子程序 _播放_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 容器1, 整数型, , , 
.局部变量 待播放, 文本型, , "0", 

.如果真 (等于 (., #嘴2))
    赋值 (., 120)
    停止播放 ()
    .如果 (等于 (正在播放CD, 真))
        .如果真 (等于 (窗口2.., 0))
            打开CD ()
        .如果真结束
        .如果 (大于 (到数值 (总轨道 ()), 1))
            播放CD ()
            赋值 (窗口2.., 960)
            赋值 (是否已播放, 真)
        .否则
            子程序1 ()
        .如果结束
        
    .否则
        .如果 (等于 (正在播放音乐, 真))
            停止播放CD ()
            .如果 (等于 (取文本右边 (., 1), 到文本 (3)))
                播放MP3 (-1, .)
            .否则
                播放音乐 (., 真)
            .如果结束
            子程序2 (假, .)
            赋值 (是否已播放, 真)
        .否则
            .如果 (等于 (正在队列播放, 真))
                停止播放CD ()
                .计次循环首 (取项目数 (), 容器1)
                    加入成员 (待播放, 相减 (容器1, 1).取项目文本 ())
                .计次循环尾 ()
                .如果 (大于 (取数组成员数 (待播放), 0))
                    播放MP3 (-1, 待播放)
                    .如果 (不等于 (窗口1.取项目文本 (., 窗口1..), “”))
                        子程序2 (假, 相加 (“播放列表―”, 窗口1.取项目文本 (., 窗口1..)))
                    .否则
                        子程序2 (假, “位命名的MP3播放列表”)
                    .如果结束
                    赋值 (是否已播放, 真)
                .否则
                    子程序1 (“请先在列表中加入歌曲...”)
                .如果结束
                
            .否则
                子程序1 (“请先选择音乐...”)
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果真结束


.子程序 _关闭_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 120)
销毁 ()

.子程序 _CD播放_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (., #眼2))
    赋值 (., 72)
    停止播放 ()
    停止播放CD ()
    关闭CD ()
    打开CD ()
    .如果 (小于 (到数值 (总轨道 ()), 2))
        子程序1 (“无法打开CD设备,请检查CDROM是否已放入CD...”)
        关闭CD ()
        打开CDROM ()
    .否则
        播放CD ()
        赋值 (是否已播放, 真)
        赋值 (正在播放CD, 真)
        赋值 (正在播放音乐, 假)
        赋值 (正在队列播放, 假)
        子程序2 (真, )
    .如果结束
    
.如果真结束


.子程序 _打开_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (., #眼2))
    赋值 (., 72)
    .如果真 (打开 ())
        停止播放CD ()
        关闭CD ()
        停止播放 ()
        .如果 (等于 (取文本右边 (., 1), 到文本 (3)))
            播放MP3 (-1, .)
        .否则
            播放音乐 (., 真)
        .如果结束
        赋值 (是否已播放, 真)
        赋值 (正在播放CD, 假)
        赋值 (正在队列播放, 假)
        赋值 (正在播放音乐, 真)
        子程序2 (假, .)
    .如果真结束
    
.如果真结束


.子程序 _最小_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 152)
赋值 (., 2)

.子程序 _帮助_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 152)
子程序1 (相加 (“请先把鼠标移到需要帮助的地方上...”, #左引号, “ESC”, #右引号, “键可以关闭帮助...”))
赋值 (帮助, 真)

.子程序 _出现_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 容器, 短整数型, , , 
.局部变量 列表, 文本型, 静态, , 

赋值 (., 120)
.如果 (等于 (是否已创建 (窗口1), 假))
    载入 (窗口1, _启动窗口, 假)
    载入列表 (“C:\soundsgood.mls”, 窗口1., 窗口1.)
    赋值 (窗口1.., 0)
    赋值 (窗口1.., 0)
    载入列表 (窗口1.取项目文本 (., 窗口1..), _启动窗口., 窗口1.)
    .判断循环首 (小于 (窗口1., 相加 (., .)))
        赋值 (窗口1., 相加 (窗口1., 20))
    .判断循环尾 ()
    赋值 (正在队列播放, 真)
.否则
    .判断循环首 (小于 (窗口1., 取屏幕宽度 ()))
        赋值 (窗口1., 相加 (窗口1., 20))
    .判断循环尾 ()
    窗口1.销毁 ()
    赋值 (正在队列播放, 假)
.如果结束


.窗口程序集 窗口程序集2, , , 

.程序集变量 内容, 文本型, , , 
.子程序 _窗口1_创建完毕, 空白型, , 
赋值 (., _启动窗口.)
赋值 (., _启动窗口.)

.子程序 _列表框_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (窗口3, _启动窗口, 假)
赋值 (窗口3., 取鼠标水平位置 ())
赋值 (窗口3., 取鼠标垂直位置 ())
.如果 (等于 (., -1))
    赋值 (窗口3.., “还没有选择音乐。”)
    赋值 (窗口3.., 真)
    赋值 (窗口3.., 真)
    赋值 (窗口3.., 真)
.否则
    赋值 (窗口3.., .取项目文本 (.))
    赋值 (窗口3.., 假)
    .如果 (不等于 (., 0))
        赋值 (窗口3.., 假)
    .否则
        赋值 (窗口3.., 真)
    .如果结束
    .如果 (不等于 (., 相减 (取项目数 (), 1)))
        赋值 (窗口3.., 假)
    .否则
        赋值 (窗口3.., 真)
    .如果结束
    
.如果结束
赋值 (窗口3., 真)

.子程序 _列表框_列表项被选择, 空白型, , 
赋值 (_启动窗口.., .)

.子程序 _列表框_双击选择, 空白型, , 
.局部变量 文本, 文本型, , , 

停止播放 ()
停止播放CD ()
播放MP3 (-1, _启动窗口.取项目文本 (., _启动窗口..))
赋值 (文本, 窗口3.除去多余 (_启动窗口.取项目文本 (., _启动窗口..)))
_启动窗口.子程序2 (假, 文本)
赋值 (是否已播放, 真)

.子程序 _窗口1_被激活, 空白型, , 
赋值 (正在队列播放, 真)
赋值 (正在播放CD, 假)
赋值 (正在播放音乐, 假)

.子程序 _音乐列表_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 72)
赋值 (., 15)
赋值 (., 162)
.如果真 (不等于 (., “音乐列表”))
    赋值 (., “音乐列表”)
.如果真结束
.如果真 (等于 (帮助, 真))
    赋值 (窗口4.., “显示播放列表的名称,双击加入列表、右键单击可删除列表...”)
    赋值 (窗口4., 相减 (取鼠标水平位置 (), 窗口4., 5))
    赋值 (窗口4., 相减 (取鼠标垂直位置 (), 相除 (窗口4., 2)))
    赋值 (窗口4., 真)
.如果真结束


.子程序 _列表框_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 15)
赋值 (., 104)
赋值 (., 72)
.如果真 (不等于 (., “列表中的MP3文件”))
    赋值 (., “列表中的MP3文件”)
.如果真结束
.置顶端可见项目 (.)
.如果真 (等于 (帮助, 真))
    赋值 (窗口4.., “这里显示播放列表中的音乐,按下右键可以对其进行操作...”)
    赋值 (窗口4., 相减 (取鼠标水平位置 (), 窗口4., 5))
    赋值 (窗口4., 相减 (取鼠标垂直位置 (), 相除 (窗口4., 2)))
    赋值 (窗口4., 真)
.如果真结束


.子程序 _音乐列表_列表项被选择, 空白型, , 
赋值 (., .)
载入列表 (.取项目文本 (.), _启动窗口., )

.子程序 _窗口1_将被销毁, 空白型, , 
.局部变量 列表, 文本型, 静态, , 
.局部变量 容器, 整数型, , , 

.如果真 (不等于 (窗口1.取项目数 (.), 0))
    .计次循环首 (窗口1.取项目数 (.), 容器)
        赋值 (列表, 相加 (列表, 窗口1.取项目文本 (., 相减 (容器, 1)), #换行符))
    .计次循环尾 ()
    写到文件 (“C:\soundsgood.mls”, 到字节集 (列表))
    置文件属性 (“C:\soundsgood.mls”, #隐藏文件)
.如果真结束


.子程序 _音乐列表_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, 46))
    .删除项目 (.)
    .删除项目 (.)
    清空 ()
    _启动窗口.清空 (.)
.如果真结束


.子程序 _列表框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 容器1, 整数型, , , 
.局部变量 文本, 文本型, 静态, , 

.如果真 (等于 (键代码, 46))
    .删除项目 (.)
    _启动窗口.删除项目 (., _启动窗口..)
    .计次循环首 (_启动窗口.取项目数 (.), 容器1)
        赋值 (文本, 相加 (文本, _启动窗口.取项目文本 (., 相减 (容器1, 1)), #换行符))
    .计次循环尾 ()
    写到文件 (.取项目文本 (.), 到字节集 (文本))
    赋值 (文本, “”)
.如果真结束


.子程序 _音乐列表_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 列表, 文本型, 静态, , 
.局部变量 容器, 整数型, , , 
.局部变量 a, 字节集, , , 
.局部变量 b, 整数型, 静态, , 

.如果真 (等于 (求余数 (b, 2), 1))
    .如果真 (打开 ())
        .计次循环首 (取项目数 (), 容器)
            赋值 (列表, 相加 (列表, 相减 (容器, 1).取项目文本 ()))
        .计次循环尾 ()
        .如果真 (等于 (寻找文本 (列表, ., , 假), -1))
            窗口3.除去多余 (.).加入项目 ().选择项目 (真)
            .加入项目 (., ).选择项目 ()
        .如果真结束
        写到文件 (., a)
        _启动窗口.清空 (.)
        清空 ()
    .如果真结束
    
.如果真结束
赋值 (b, 相加 (b, 1))

.子程序 _音乐列表_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.删除项目 (.)
.删除项目 (.)
清空 ()
_启动窗口.清空 (.)

.窗口程序集 窗口程序集3, , , 

.程序集变量 结果, 整数型, , , 
.程序集变量 b, 整数型, , , 
.子程序 _窗口2_创建完毕, 空白型, , 
赋值 (., _启动窗口.)
赋值 (., 相减 (相加 (_启动窗口., _启动窗口.), .))
赋值 (., #下一首1)
赋值 (., #上一首1)
赋值 (., #暂停1)
赋值 (., #弹出1)
.如果 (正在播放音乐)
    .如果 (等于 (取文本右边 (_启动窗口.., 3), “mid”))
        获得音量m (0, b)
        赋值 (., 整除 (b, 500))
    .否则
        获得音量w (0, b)
        赋值 (., 整除 (b, 500))
    .如果结束
    
.否则
    获得音量w (0, b)
    赋值 (., 整除 (b, 500))
.如果结束


.子程序 _上一首_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #下一首1)
赋值 (., #上一首2)
赋值 (., #暂停1)
赋值 (., #弹出1)
赋值 (., 56)
赋值 (., 28)
赋值 (., 28)
.如果真 (等于 (帮助, 真))
    赋值 (窗口4.., “选择上一首音乐,只有播放CD时有效...”)
    赋值 (窗口4., 相减 (取鼠标水平位置 (), 窗口4., 5))
    赋值 (窗口4., 相减 (取鼠标垂直位置 (), 相除 (窗口4., 2)))
    赋值 (窗口4., 真)
.如果真结束


.子程序 _下一首_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #下一首2)
赋值 (., #上一首1)
赋值 (., #暂停1)
赋值 (., #弹出1)
赋值 (., 16)
赋值 (., 28)
赋值 (., 28)
.如果真 (等于 (帮助, 真))
    赋值 (窗口4.., “选择下一首音乐,只有播放CD时有效...”)
    赋值 (窗口4., 相减 (取鼠标水平位置 (), 窗口4., 5))
    赋值 (窗口4., 相减 (取鼠标垂直位置 (), 相除 (窗口4., 2)))
    赋值 (窗口4., 真)
.如果真结束


.子程序 _暂停_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #下一首1)
赋值 (., #上一首1)
赋值 (., #暂停2)
赋值 (., #弹出1)
赋值 (., 56)
赋值 (., 16)
赋值 (., 28)
.如果真 (等于 (帮助, 真))
    赋值 (窗口4.., “暂停CD播放...”)
    赋值 (窗口4., 相减 (取鼠标水平位置 (), 窗口4., 5))
    赋值 (窗口4., 相减 (取鼠标垂直位置 (), 相除 (窗口4., 2)))
    赋值 (窗口4., 真)
.如果真结束


.子程序 _弹出_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #下一首1)
赋值 (., #上一首1)
赋值 (., #暂停1)
赋值 (., #弹出2)
赋值 (., 56)
赋值 (., 16)
赋值 (., 28)
.如果真 (等于 (帮助, 真))
    赋值 (窗口4.., “打开CDROM...”)
    赋值 (窗口4., 相减 (取鼠标水平位置 (), 窗口4., 5))
    赋值 (窗口4., 相减 (取鼠标垂直位置 (), 相除 (窗口4., 2)))
    赋值 (窗口4., 真)
.如果真结束


.子程序 _标签1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #下一首1)
赋值 (., #上一首1)
赋值 (., #暂停1)
赋值 (., #弹出1)
赋值 (., 56)
赋值 (., 16)
赋值 (., 28)
赋值 (., 28)

.子程序 _标签2_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #下一首1)
赋值 (., #上一首1)
赋值 (., #暂停1)
赋值 (., #弹出1)
赋值 (., 56)
赋值 (., 16)
赋值 (., 28)
赋值 (., 28)
赋值 (., 56)
赋值 (., 16)
赋值 (., 28)
赋值 (., 28)

.子程序 _标签3_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #下一首1)
赋值 (., #上一首1)
赋值 (., #暂停1)
赋值 (., #弹出1)
赋值 (., 56)
赋值 (., 16)
赋值 (., 28)
赋值 (., 28)

.子程序 _标签4_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #下一首1)
赋值 (., #上一首1)
赋值 (., #暂停1)
赋值 (., #弹出1)
赋值 (., 56)
赋值 (., 16)
赋值 (., 28)
赋值 (., 28)

.子程序 _窗口2_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #下一首1)
赋值 (., #上一首1)
赋值 (., #暂停1)
赋值 (., #弹出1)
赋值 (., 56)
赋值 (., 16)
赋值 (., 28)
赋值 (., 28)

.子程序 _时钟1_周期事件, 空白型, , 
赋值 (., 相加 (“   正在播放：CD音乐”, 当前轨道 (), “/”, 总轨道 (), “          ”, 已播放时间 (), “/”, 轨道时间 ()))
.如果 (等于 (当前轨道 (), “1”))
    赋值 (., 真)
.否则
    赋值 (., 假)
.如果结束
.如果 (等于 (当前轨道 (), 总轨道 ()))
    赋值 (., 真)
.否则
    赋值 (., 假)
.如果结束


.子程序 _上一首_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 14)

.子程序 _下一首_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 58)

.子程序 _暂停_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 30)

.子程序 _弹出_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 30)

.子程序 _滑块条1_位置被改变, 空白型, , 
.如果 (正在播放音乐)
    设置音量w (0, 相乘 (., 500))
    .如果 (等于 (取文本右边 (_启动窗口.., 3), “mid”))
        设置音量m (0, 相乘 (., 500))
    .否则
        设置音量w (0, 相乘 (., 500))
    .如果结束
    
.否则
    设置音量w (0, 相乘 (., 500))
.如果结束


.子程序 _上一首_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 a, 整数型, 静态, , 

赋值 (., 16)
.如果真 (等于 (求余数 (a, 2), 1))
    停止播放CD ()
    赋值 (结果, 播放轨道 (到文本 (相减 (到数值 (当前轨道 ()), 1))))
    .如果真 (不等于 (结果, 0))
        子程序1 (“选择上一首音乐出错...”)
    .如果真结束
    
.如果真结束
赋值 (a, 相加 (a, 1))

.子程序 _下一首_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 a, 整数型, 静态, , 

赋值 (., 56)
.如果真 (等于 (求余数 (a, 2), 1))
    停止播放CD ()
    赋值 (结果, 播放轨道 (到文本 (相加 (到数值 (当前轨道 ()), 1))))
    .如果真 (不等于 (结果, 0))
        子程序1 (“选择下一首音乐出错...”)
    .如果真结束
    
.如果真结束
赋值 (a, 相加 (a, 1))


.子程序 _暂停_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 28)
赋值 (结果, 暂停播放 ())
.如果真 (不等于 (结果, 0))
    子程序1 (“暂停播放出错...”)
.如果真结束


.子程序 _弹出_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 28)
赋值 (., 0)
赋值 (., “   正在播放：”)
赋值 (结果, 停止播放CD ())
赋值 (结果, 关闭所有 ())
赋值 (结果, 打开CDROM ())
.如果真 (不等于 (结果, 0))
    子程序1 (“弹出CDROM出错...”)
.如果真结束


.子程序 _滑块条1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (帮助, 真))
    赋值 (窗口4.., “音量控制,播放CD时无效...”)
    赋值 (窗口4., 相减 (取鼠标水平位置 (), 窗口4., 5))
    赋值 (窗口4., 相减 (取鼠标垂直位置 (), 相除 (窗口4., 2)))
    赋值 (窗口4., 真)
.如果真结束


.子程序 _超级链接框1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (帮助, 真))
    赋值 (窗口4.., “详细的音量控制...”)
    赋值 (窗口4., 相减 (取鼠标水平位置 (), 窗口4., 5))
    赋值 (窗口4., 相减 (取鼠标垂直位置 (), 相除 (窗口4., 2)))
    赋值 (窗口4., 真)
.如果真结束


.窗口程序集 窗口程序集4, , , 

.子程序 _窗口3_创建完毕, 空白型, , 
赋值 (., #加入1)
赋值 (., #关闭1)
赋值 (., #上移1)
赋值 (., #下移1)
赋值 (., #搜索1)
赋值 (., #打开1)
赋值 (., #保存1)

.子程序 _加入_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #加入2)
赋值 (., #关闭1)
赋值 (., #上移1)
赋值 (., #下移1)
赋值 (., #搜索1)
赋值 (., #打开1)
赋值 (., #保存1)

.子程序 _删除_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #加入1)
赋值 (., #关闭2)
赋值 (., #上移1)
赋值 (., #下移1)
赋值 (., #搜索1)
赋值 (., #打开1)
赋值 (., #保存1)

.子程序 _下移_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #加入1)
赋值 (., #关闭1)
赋值 (., #上移1)
赋值 (., #下移2)
赋值 (., #搜索1)
赋值 (., #打开1)
赋值 (., #保存1)

.子程序 _上移_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #加入1)
赋值 (., #关闭1)
赋值 (., #上移2)
赋值 (., #下移1)
赋值 (., #搜索1)
赋值 (., #打开1)
赋值 (., #保存1)

.子程序 _搜索_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #加入1)
赋值 (., #关闭1)
赋值 (., #上移1)
赋值 (., #下移1)
赋值 (., #搜索2)
赋值 (., #打开1)
赋值 (., #保存1)

.子程序 _标签1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #加入1)
赋值 (., #关闭1)
赋值 (., #上移1)
赋值 (., #下移1)
赋值 (., #搜索1)
赋值 (., #打开1)
赋值 (., #保存1)


.子程序 _窗口3_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #加入1)
赋值 (., #关闭1)
赋值 (., #上移1)
赋值 (., #下移1)
赋值 (., #搜索1)
赋值 (., #打开1)
赋值 (., #保存1)


.子程序 _窗口3_被取消激活, 空白型, , 
销毁 ()

.子程序 _搜索_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 28)

.子程序 _下移_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 28)

.子程序 _上移_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 28)

.子程序 _删除_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 28)

.子程序 _加入_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 28)

.子程序 _打开_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #加入1)
赋值 (., #关闭1)
赋值 (., #上移1)
赋值 (., #下移1)
赋值 (., #搜索1)
赋值 (., #打开2)
赋值 (., #保存1)

.子程序 _保存_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., #加入1)
赋值 (., #关闭1)
赋值 (., #上移1)
赋值 (., #下移1)
赋值 (., #搜索1)
赋值 (., #打开1)
赋值 (., #保存2)

.子程序 _打开_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 28)

.子程序 除去多余, 文本型, , 
.参数 参数, 文本型, , 

.判断循环首 (不等于 (寻找文本 (参数, “\”, , 真), -1))
    赋值 (参数, 取文本右边 (参数, 相减 (取文本长度 (参数), 寻找文本 (参数, “\”, , 真))))
.判断循环尾 ()
赋值 (参数, 取文本左边 (参数, 相减 (取文本长度 (参数), 4)))
返回 (参数)

.子程序 _保存_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 28)

.子程序 _加入_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 文本, 文本型, , , 
.局部变量 容器1, 整数型, , , 
.局部变量 文本1, 文本型, 静态, , 

赋值 (., 26)
销毁 ()
.如果真 (窗口1.打开 (.))
    _启动窗口.加入项目 (., 窗口1.., )
    赋值 (文本, 取文本右边 (窗口1.., 相减 (取文本长度 (窗口1..), 倒找文本 (窗口1.., “\”, , 假))))
    窗口1.加入项目 (., 取文本左边 (文本, 相减 (取文本长度 (文本), 4)), )
.如果真结束
.计次循环首 (_启动窗口.取项目数 (.), 容器1)
    赋值 (文本1, 相加 (文本1, _启动窗口.取项目文本 (., 相减 (容器1, 1)), #换行符))
.计次循环尾 ()
写到文件 (窗口1.取项目文本 (., 窗口1..), 到字节集 (文本1))
赋值 (文本1, “”)

.子程序 _删除_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 容器1, 整数型, , , 
.局部变量 文本, 文本型, 静态, , 

赋值 (., 26)
窗口1.删除项目 (., 窗口1..)
_启动窗口.删除项目 (., _启动窗口..)
.计次循环首 (_启动窗口.取项目数 (.), 容器1)
    赋值 (文本, 相加 (文本, _启动窗口.取项目文本 (., 相减 (容器1, 1)), #换行符))
.计次循环尾 ()
写到文件 (窗口1.取项目文本 (., 窗口1..), 到字节集 (文本))
赋值 (文本, “”)
赋值 (., 真)
赋值 (., 真)
赋值 (., 真)
赋值 (., “还没有选择音乐。”)

.子程序 _下移_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 容器1, 文本型, , , 
.局部变量 容器2, 文本型, , , 
.局部变量 a, 短整数型, 静态, , 

赋值 (., 26)
赋值 (a, 相加 (a, 1))
.如果真 (等于 (求余数 (a, 2), 1))
    赋值 (容器1, 窗口1.取项目文本 (., 窗口1..))
    窗口1.置项目文本 (., 窗口1.., 窗口1.取项目文本 (., 相加 (窗口1.., 1)))
    窗口1.置项目文本 (., 相加 (窗口1.., 1), 容器1)
    赋值 (窗口1.., 相加 (窗口1.., 1))
    赋值 (容器2, _启动窗口.取项目文本 (., _启动窗口..))
    _启动窗口.置项目文本 (., _启动窗口.., _启动窗口.取项目文本 (., 相加 (_启动窗口.., 1)))
    _启动窗口.置项目文本 (., 相加 (_启动窗口.., 1), 容器2)
    赋值 (_启动窗口.., 相加 (_启动窗口.., 1))
    .如果真 (等于 (窗口1.., 相减 (窗口1.取项目数 (.), 1)))
        赋值 (., 真)
    .如果真结束
    赋值 (., 假)
.如果真结束


.子程序 _上移_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 容器1, 文本型, , , 
.局部变量 容器2, 文本型, , , 
.局部变量 a, 短整数型, 静态, , 

赋值 (., 26)
赋值 (a, 相加 (a, 1))
.如果真 (等于 (求余数 (a, 2), 1))
    赋值 (容器1, 窗口1.取项目文本 (., 窗口1..))
    窗口1.置项目文本 (., 窗口1.., 窗口1.取项目文本 (., 相减 (窗口1.., 1)))
    窗口1.置项目文本 (., 相减 (窗口1.., 1), 容器1)
    赋值 (窗口1.., 相减 (窗口1.., 1))
    赋值 (容器2, _启动窗口.取项目文本 (., _启动窗口..))
    _启动窗口.置项目文本 (., _启动窗口.., _启动窗口.取项目文本 (., 相减 (_启动窗口.., 1)))
    _启动窗口.置项目文本 (., 相减 (_启动窗口.., 1), 容器2)
    赋值 (_启动窗口.., 相减 (_启动窗口.., 1))
    .如果真 (等于 (窗口1.., 0))
        赋值 (., 真)
    .如果真结束
    赋值 (., 假)
.如果真结束


.子程序 _搜索_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 26)
载入 (窗口6, , 真)

.子程序 _打开_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 容器, 整数型, , , 
.局部变量 列表, 文本型, 静态, , 

赋值 (., 26)
销毁 ()
.如果真 (等于 (窗口1.打开 (.), 真))
    载入列表 (窗口1.., _启动窗口., 窗口1.)
    .计次循环首 (窗口1.取项目数 (.), 容器)
        赋值 (列表, 相加 (列表, 窗口1.取项目文本 (., 相减 (容器, 1))))
    .计次循环尾 ()
    .如果真 (等于 (寻找文本 (列表, 窗口1.., , 假), -1))
        窗口1.选择项目 (., 窗口1.加入项目 (., 窗口3.除去多余 (窗口1..), ), 真)
        窗口1.选择项目 (., 窗口1.加入项目 (., 窗口1.., ), )
    .如果真结束
    
.如果真结束


.子程序 _保存_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 容器1, 整数型, , , 
.局部变量 文本, 文本型, 静态, , 
.局部变量 容器, 整数型, , , 
.局部变量 列表, 文本型, 静态, , 

赋值 (., 26)
销毁 ()
.如果 (等于 (窗口1.., -1))
    .如果真 (等于 (窗口1.打开 (.), 真))
        .计次循环首 (_启动窗口.取项目数 (.), 容器1)
            赋值 (文本, 相加 (文本, _启动窗口.取项目文本 (., 相减 (容器1, 1)), #换行符))
        .计次循环尾 ()
        .如果 (等于 (写到文件 (窗口1.., 到字节集 (文本)), 假))
            信息框 (“保存播放列表失败...”, 0, )
        .否则
            .计次循环首 (窗口1.取项目数 (.), 容器)
                赋值 (列表, 相加 (列表, 窗口1.取项目文本 (., 相减 (容器, 1))))
            .计次循环尾 ()
            .如果真 (等于 (寻找文本 (列表, 窗口1.., , 假), -1))
                窗口1.选择项目 (., 窗口1.加入项目 (., 窗口3.除去多余 (窗口1..), ), 真)
                窗口1.选择项目 (., 窗口1.加入项目 (., 窗口1.., ), )
            .如果真结束
            
        .如果结束
        
    .如果真结束
    
.否则
    .计次循环首 (_启动窗口.取项目数 (.), 容器1)
        赋值 (文本, 相加 (文本, _启动窗口.取项目文本 (., 相减 (容器1, 1)), #换行符))
    .计次循环尾 ()
    写到文件 (窗口1.取项目文本 (., 窗口1..), 到字节集 (文本))
.如果结束
赋值 (文本, “”)

.子程序 _标签1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 26)
赋值 (., 26)
赋值 (., 26)
赋值 (., 26)
赋值 (., 26)
赋值 (., 26)
赋值 (., 26)

.窗口程序集 窗口程序集5, , , 

.子程序 _窗口4_创建完毕, 空白型, , 
赋值 (., 0)
赋值 (., 相加 (_启动窗口., 相除 (相减 (_启动窗口., .), 2)))

.子程序 _窗口4_被取消激活, 空白型, , 
.如果 (等于 (帮助, 真))
    赋值 (., 假)
.否则
    销毁 ()
.如果结束


.子程序 _窗口4_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.子程序 _窗口4_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 假)

.子程序 _窗口4_将被销毁, 空白型, , 
赋值 (帮助, 假)

.窗口程序集 窗口程序集6, , , 

.程序集变量 列表, 文本型, , , 
.子程序 _窗口5_创建完毕, 空白型, , 
.局部变量 容器, 整数型, , , 

赋值 (., 相减 (_启动窗口., .))
赋值 (., 相加 (_启动窗口., 相除 (相减 (相加 (_启动窗口., 窗口1.), .), 2)))
.如果真 (不等于 (_启动窗口.取项目数 (.), 0))
    .计次循环首 (_启动窗口.取项目数 (.), 容器)
        赋值 (列表, 相加 (列表, _启动窗口.取项目文本 (., 相减 (容器, 1))))
    .计次循环尾 ()
.如果真结束


.子程序 _窗口5_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.子程序 _窗口5_首次激活, 空白型, , 
搜寻 (相加 (窗口6.., “:\”))
.如果真 (是否已创建 (窗口5))
    销毁 ()
.如果真结束


.子程序 搜寻, 空白型, , 
.参数 目录, 文本型, , 

.局部变量 文件名, 文本型, , , 

处理事件 ()
.如果真 (等于 (是否已创建 (窗口5), 假))
    返回 ()
.如果真结束
.如果真 (不等于 (取文本右边 (目录, 1), “\”))
    赋值 (目录, 相加 (目录, “\”))
.如果真结束
赋值 (文件名, 寻找文件 (相加 (目录, “*.mp3”), ))
.判断循环首 (不等于 (文件名, “”))
    赋值 (., 相加 (目录, 文件名))
    刷新显示 ()
    .如果真 (等于 (寻找文本 (列表, 相加 (目录, 文件名), , 假), -1))
        _启动窗口.加入项目 (., 相加 (目录, 文件名), )
        窗口1.加入项目 (., 取文本左边 (文件名, 相减 (取文本长度 (文件名), 4)), )
    .如果真结束
    赋值 (文件名, 寻找文件 ())
.判断循环尾 ()
赋值 (文件名, 寻找文件 (相加 (目录, “*.*”), #子目录))
.判断循环首 (不等于 (文件名, “”))
    .如果真 (不等于 (取文本左边 (文件名, 1), “.”))
        搜寻 (相加 (目录, 文件名))
    .如果真结束
    赋值 (文件名, 寻找文件 (#子目录))
.判断循环尾 ()

.子程序 _窗口5_将被销毁, 空白型, , 
赋值 (列表, “”)

.程序集 播放CD, , , 

.程序集变量 a, 整数型, , , 
.程序集变量 b, 文本型, , , 
.子程序 当前轨道, 文本型, , 
赋值 (当前轨道, 取空白文本 (255))
赋值 (a, 播放命令 (“status CDAudio current track”, 当前轨道, 255, 0))
返回 (当前轨道)

.子程序 总轨道, 文本型, , 
赋值 (总轨道, 取空白文本 (255))
赋值 (a, 播放命令 (“status CDAudio number of tracks”, 总轨道, 255, 0))
返回 (总轨道)

.子程序 轨道时间, 文本型, , 
.局部变量 ntra, 文本型, , , 

赋值 (ntra, 当前轨道 ())
赋值 (time, 取空白文本 (255))
赋值 (a, 播放命令 (相加 (“status CDAudio length track ”, ntra), time, 255, 0))
赋值 (time, 取文本左边 (time, 5))
返回 (time)

.子程序 已播放时间, 文本型, , 
.局部变量 信息, 文本型, , , 

赋值 (信息, 取空白文本 (255))
赋值 (a, 播放命令 (“status CDAudio position”, 信息, 255, 0))
赋值 (分, 取文本中间 (信息, 4, 2))
赋值 (秒, 取文本中间 (信息, 7, 2))
返回 (相加 (分, “:”, 秒))

.子程序 打开CDROM, 整数型, , 
赋值 (a, 播放命令 (“set CDAudio door open”, b, 255, 0))
返回 (a)

.子程序 停止播放CD, 整数型, , 
赋值 (a, 播放命令 (“stop CDAudio wait”, b, 255, 0))
返回 (a)

.子程序 关闭CD, 整数型, , 
赋值 (a, 播放命令 (“close CDAudio”, b, 255, 0))
返回 (a)

.子程序 暂停播放, 整数型, , 
赋值 (a, 播放命令 (“pause CDAudio”, b, 255, 0))
返回 (a)

.子程序 播放CD, 整数型, , 
赋值 (a, 播放命令 (“play CDAudio”, b, 255, 0))
返回 (a)

.子程序 关闭所有, 整数型, , 
赋值 (a, 播放命令 (“close all”, b, 255, 0))
返回 (a)

.子程序 打开CD, 整数型, , 
赋值 (a, 播放命令 (“open CDAudio shareable”, b, 255, 0))
赋值 (a, 播放命令 (“set CDAudio time format tmsf wait”, b, 255, 0))
返回 (a)

.子程序 播放轨道, 整数型, , 
.参数 轨道, 文本型, , 

赋值 (a, 播放命令 (相加 (“play CDAudio from ”, 轨道), b, 255, 0))
返回 (a)

.窗口程序集 窗口程序集7, , , 

.子程序 _窗口6_创建完毕, 空白型, , 
赋值 (., 相加 (_启动窗口., 相除 (相减 (相加 (_启动窗口., 窗口1.), .), 2)))
赋值 (., 0)

.子程序 _时钟1_周期事件, 空白型, , 
.判断循环首 (小于 (窗口6., 相加 (_启动窗口., 相除 (相减 (_启动窗口., 窗口6.), 2))))
    赋值 (窗口6., 相加 (窗口6., 10))
.判断循环尾 ()
赋值 (., 0)

.子程序 _关闭_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (不等于 (., #黄色))
    赋值 (., #黄色)
.如果真结束
.如果真 (不等于 (., #白色))
    赋值 (., #白色)
.如果真结束
.如果真 (等于 (帮助, 真))
    赋值 (窗口4.., “关闭搜索窗口...”)
    赋值 (窗口4., 相减 (取鼠标水平位置 (), 窗口4., 5))
    赋值 (窗口4., 相减 (取鼠标垂直位置 (), 相除 (窗口4., 2)))
    赋值 (窗口4., 真)
.如果真结束


.子程序 _搜索_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (不等于 (., #黄色))
    赋值 (., #黄色)
.如果真结束
.如果真 (不等于 (., #白色))
    赋值 (., #白色)
.如果真结束
.如果真 (等于 (帮助, 真))
    赋值 (窗口4.., “按下就开始搜索了...”)
    赋值 (窗口4., 相减 (取鼠标水平位置 (), 窗口4., 5))
    赋值 (窗口4., 相减 (取鼠标垂直位置 (), 相除 (窗口4., 2)))
    赋值 (窗口4., 真)
.如果真结束


.子程序 _窗口6_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (不等于 (., #白色))
    赋值 (., #白色)
.如果真结束
.如果真 (不等于 (., #白色))
    赋值 (., #白色)
.如果真结束
赋值 (., 68)
赋值 (., 68)

.子程序 _搜索_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 70)

.子程序 _关闭_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 70)

.子程序 _关闭_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.子程序 _搜索_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (窗口5, , 真)

.程序集 列表操作, , , 

.子程序 保存列表, 空白型, , 
.参数 路径, 文本型, , 
.参数 列表框, 列表框, , 

.局部变量 列表, 文本型, 静态, , 
.局部变量 容器, 短整数型, , , 

.计次循环首 (列表框.取项目数 (), 容器)
    赋值 (列表, 相加 (列表, 列表框.取项目文本 (相减 (容器, 1)), #换行符))
.计次循环尾 ()
写到文件 (路径, 到字节集 (列表))
置文件属性 (路径, #隐藏文件)

.子程序 载入列表, 空白型, , 
.参数 路径, 文本型, , 
.参数 列表框1, 列表框, , 
.参数 列表框2, 列表框, , 

.局部变量 列表, 文本型, 静态, , 
.局部变量 项目, 文本型, , , 

列表框1.清空 ()
列表框2.清空 ()
赋值 (列表, 取字节集数据 (读入文件 (路径), 10))
.判断循环首 (不等于 (寻找文本 (列表, #换行符, , 假), -1))
    赋值 (项目, 取文本左边 (列表, 相减 (寻找文本 (列表, #换行符, , 假), 1)))
    列表框1.加入项目 (项目, )
    列表框2.加入项目 (除去多余 (项目), )
    赋值 (列表, 取文本右边 (列表, 相减 (取文本长度 (列表), 寻找文本 (列表, #换行符, , 假), 1)))
.判断循环尾 ()


 ' 不属于任何一个程序集、类模块的函数：
