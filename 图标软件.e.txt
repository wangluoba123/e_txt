 ' 文件类型：Windows窗口程序

 ' 程序名称：个性图标生成工具
 ' 程序描述：
 ' 程序作者：胡朝斌
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.1
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 340
    高度 = 253
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “易用个性图标生成器 - 胡朝斌”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 409
    高度 = 300
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “图标编辑”
    帮助文件名 = “”



.图片 图标模板, " ' 已保存到：D:\易语言学习\Data\图标软件.e\图标模板", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 7 系统核心支持库




.全局变量 颜色数组1, 整数型, , "0", 
.全局变量 颜色数组2, 整数型, , "0", 
.全局变量 输出图标, 字节集, , , 
.全局变量 图像数据1, 字节集, , , 
.全局变量 图像数据2, 字节集, , , 

.窗口程序集 窗口程序集1, , , 

.子程序 _选择图片_被单击, 空白型, , 
.局部变量 位图文件名, 文本型, , , 

赋值 (., “图像文件|*.bmp;*.jpg;*.gif;*.tif;*.pcx;*.ico;*.cur;*.png|所有文件(*.*)|*.*”)
赋值 (., 0)
赋值 (., “”)
.如果 (或者 (., ., .))
    .如果 (.)
        信息框 (“即将打开欲转换为16x16格式的图像文件。”, 64, “打开文件”)
        .如果真 (打开 ())
            赋值 (.)
            赋值 (., 读入文件 (位图文件名))
        .如果真结束
        信息框 (“即将打开欲转换为32x32格式的图像文件。”, 64, “打开文件”)
        .如果真 (打开 ())
            赋值 (.)
            赋值 (., 读入文件 (位图文件名))
        .如果真结束
        
    .否则
        .如果真 (打开 ())
            赋值 (.)
            赋值 (., 读入文件 (位图文件名))
        .如果真结束
        
    .如果结束
    
.否则
    信息框 (“请先设置图标格式!”, 48, “警告”)
.如果结束


.子程序 _转换_被单击, 空白型, , 
.如果 (等于 (., {  }))
    信息框 (“你还未载入图像文件！”, 48, “警告”)
.否则
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    .判断开始 (.)
        转换为单16位 ()
        赋值 (., 真)
        赋值 (., 真)
        
    .判断 (.)
        转换为单32位 ()
        赋值 (., 真)
        赋值 (., 真)
        
    .判断 (.)
        转换为双图标 ()
        赋值 (., 真)
        赋值 (., 真)
        赋值 (., 真)
        赋值 (., 真)
        
    .默认
        
    .判断结束
    
.如果结束


.子程序 转换为单16位, 空白型, , 
.局部变量 h, 整数型, , , 

赋值 (输出图标, 取字节集左边 (#图标模板, 894))

赋值 (载入图片 (.))
.画图片 (0, 0, 16, 16, )
赋值 (图像数据1, 取字节集右边 (.取图片 (), 768))

赋值 (输出图标, 字节集替换 (输出图标, 63, 768, 图像数据1))


.子程序 转换为单32位, 空白型, , 
.局部变量 h, 整数型, , , 

赋值 (取字节集中间 (#图标模板, 895, 3262))

赋值 (h, 载入图片 (.))
h.画图片 (0, 0, 32, 32, )
赋值 (取字节集右边 (.取图片 (), 3072))

赋值 (字节集替换 (63, 3072, ))

.子程序 转换为双图标, 空白型, , 
.局部变量 h, 整数型, , , 

赋值 (取字节集右边 (#图标模板, 4150))

赋值 (载入图片 (.))
.画图片 (0, 0, 16, 16, )
赋值 (取字节集右边 (.取图片 (), 768))
赋值 (输出图标, 字节集替换 (输出图标, 79, 768, 图像数据1))

赋值 (h, 载入图片 (.))
.画图片 (0, 0, 32, 32, )
赋值 (取字节集右边 (.取图片 (), 3072))
赋值 (字节集替换 (951, 3072, ))


.子程序 _退出_被单击, 空白型, , 
结束 ()

.子程序 _保存_被单击, 空白型, , 
.局部变量 文件名, 文本型, , , 

.如果真 (等于 (输出图标, {  }))
    信息框 (“输出图标为空，不能被保存！”, 48, “警告”)
    返回 ()
.如果真结束

赋值 (., 1)
赋值 (., “图标文件|*.ico”)
赋值 (., “”)
赋值 (., “ico”)
.如果真 (打开 ())
    赋值 (文件名, .)
    赋值 (., {  })
    赋值 (., {  })
    .清除 ()
    .清除 ()
    赋值 ({  })
    赋值 ({  })
    赋值 (., 假)
    赋值 (., 假)
    
    .如果 (不等于 (文件名, “”))
        写到文件 (文件名, )
    .否则
        信息框 (“文件名称不能为空！”, 48, “警告”)
    .如果结束
    
.如果真结束
赋值 ({  })


.子程序 _清除_被单击, 空白型, , 
赋值 (., {  })
赋值 (., {  })
赋值 (., {  })
.清除 ()
赋值 (., {  })
.清除 ()
赋值 ({  })
赋值 ({  })
赋值 ({  })
赋值 (., 假)
赋值 (., 假)


.子程序 _编辑_被单击, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 j, 整数型, , , 

.如果真 (等于 ({  }))
    信息框 (“还未进行转换！”, 48, “警告”)
    返回 ()
.如果真结束

.如果真 (或者 (., .))
    重定义数组 (颜色数组1, 假, 16, 16)
    赋值 (i, 0)
    .判断循环首 (小于 (i, 16))
        赋值 (j, 0)
        .判断循环首 (小于 (j, 16))
            赋值 (颜色数组1 [相加 (i, 1)] [相加 (j, 1)], 取颜色值 ( [相加 (相乘 (i, 48), 相乘 (j, 3), 1, 2)],  [相加 (相乘 (i, 48), 相乘 (j, 3), 1, 1)],  [相加 (相乘 (i, 48), 相乘 (j, 3), 1)]))
            赋值 (j, 相加 (j, 1))
        .判断循环尾 ()
        赋值 (i, 相加 (i, 1))
    .判断循环尾 ()
    
.如果真结束

.如果真 (或者 (., .))
    重定义数组 (颜色数组2, 假, 32, 32)
    赋值 (i, 0)
    .判断循环首 (小于 (i, 32))
        赋值 (j, 0)
        .判断循环首 (小于 (j, 32))
            赋值 (颜色数组2 [相加 (i, 1)] [相加 (j, 1)], 取颜色值 ( [相加 (相乘 (i, 96), 相乘 (j, 3), 1, 2)],  [相加 (相乘 (i, 96), 相乘 (j, 3), 1, 1)],  [相加 (相乘 (i, 96), 相乘 (j, 3), 1)]))
            赋值 (j, 相加 (j, 1))
        .判断循环尾 ()
        赋值 (i, 相加 (i, 1))
    .判断循环尾 ()
.如果真结束

载入 (窗口1, , 真)

.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 ({  })

.窗口程序集 窗口程序集2, , , 

.程序集变量 当前图标, 整数型, , , 
.程序集变量 默认颜色, 整数型, , , 
.程序集变量 透明颜色, 整数型, , , 
.程序集变量 编辑, 逻辑型, , , 
.程序集变量 预览图标1, 字节集, , , 
.程序集变量 预览图标2, 字节集, , , 
.程序集变量 画点颜色, 整数型, , , 
.子程序 _窗口1_创建完毕, 空白型, , 
赋值 (默认颜色, .)
赋值 (透明颜色, .)
.如果 (_启动窗口..)
    填充 (2)
    赋值 (., 取颜色值 (0, 0, 255))
    赋值 (., 取颜色值 (255, 255, 255))
    赋值 (当前图标, 2)
.否则
    填充 (1)
    赋值 (., 取颜色值 (0, 0, 255))
    赋值 (., 取颜色值 (255, 255, 255))
    赋值 (当前图标, 1)
.如果结束

.判断开始 (_启动窗口..)
    赋值 (., 假)
    赋值 (., 假)
.判断 (_启动窗口..)
    赋值 (., 假)
    赋值 (., 假)
.默认
    
.判断结束
图标预览 ()

.子程序 填充, 空白型, , 
.参数 填充类型, 整数型, , 

.局部变量 i, 整数型, , , 
.局部变量 j, 整数型, , , 

.判断开始 (等于 (填充类型, 1))
    赋值 (i, 0)
    .判断循环首 (小于 (i, 16))
        赋值 (j, 0)
        .判断循环首 (小于 (j, 16))
            赋值 (., 颜色数组1 [相减 (16, i)] [相加 (j, 1)])
            相乘 (j, 16).画矩形 (相乘 (i, 16), 相加 (相乘 (j, 16), 17), 相加 (相乘 (i, 16), 17))
            赋值 (j, 相加 (j, 1))
        .判断循环尾 ()
        赋值 (i, 相加 (i, 1))
    .判断循环尾 ()
.判断 (等于 (填充类型, 2))
    赋值 (i, 0)
    .判断循环首 (小于 (i, 32))
        赋值 (j, 0)
        .判断循环首 (小于 (j, 32))
            赋值 (., 颜色数组2 [相减 (32, i)] [相加 (j, 1)])
            相乘 (j, 8).画矩形 (相乘 (i, 8), 相加 (相乘 (j, 8), 9), 相加 (相乘 (i, 8), 9))
            赋值 (j, 相加 (j, 1))
        .判断循环尾 ()
        赋值 (i, 相加 (i, 1))
    .判断循环尾 ()
.默认
    
.判断结束


.子程序 图标预览, 空白型, , 
.局部变量 预览图标, 字节集, , , 
.局部变量 h, 整数型, , , 

.如果真 (或者 (_启动窗口.., _启动窗口..))
    赋值 (预览图标1, 取字节集左边 (#图标模板, 894))
    赋值 (预览图标1, 字节集替换 (预览图标1, 63, 768, 图像数据1))
    赋值 (h, 载入图片 (预览图标1))
    h.画图片 (0, 0, , , )
.如果真结束

.如果真 (或者 (_启动窗口.., _启动窗口..))
    赋值 (预览图标2, 取字节集中间 (#图标模板, 895, 3262))
    赋值 (预览图标2, 字节集替换 (预览图标2, 63, 3072, 图像数据2))
    赋值 (., 预览图标2)
.如果真结束


.子程序 _标签1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 取颜色值 (0, 0, 255))
赋值 (., 取颜色值 (255, 255, 255))
赋值 (., 默认颜色)
赋值 (., 取颜色值 (0, 0, 0))
.如果真 (_启动窗口..)
    .清除 ()
.如果真结束

填充 (1)
赋值 (当前图标, 1)

.子程序 _标签2_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 取颜色值 (0, 0, 255))
赋值 (., 取颜色值 (255, 255, 255))
赋值 (., 默认颜色)
赋值 (., 取颜色值 (0, 0, 0))
.如果真 (_启动窗口..)
    .清除 ()
.如果真结束

填充 (2)
赋值 (当前图标, 2)

.子程序 _画板1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 位置横, 整数型, , , 
.局部变量 位置纵, 整数型, , , 

赋值 (编辑, 真)
.如果 (.)
    赋值 (., 透明颜色)
    赋值 (画点颜色, 位取反 (默认颜色))
    
.否则
    赋值 (., .)
    赋值 (.)
.如果结束

绘画 (横向位置, 纵向位置)


.子程序 _画板1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (编辑)
    绘画 (横向位置, 纵向位置)
.如果真结束


.子程序 绘画, 空白型, , 
.参数 横坐标, 整数型, , 
.参数 纵坐标, 整数型, , 

.局部变量 i, 整数型, , , 
.局部变量 j, 整数型, , , 

.如果 (等于 (当前图标, 1))
    赋值 (整除 (横坐标, 16))
    赋值 (横坐标, 相乘 (16, ))
    赋值 (整除 (纵坐标, 16))
    赋值 (纵坐标, 相乘 (16, ))
    横坐标.画矩形 (纵坐标, 相加 (横坐标, 17), 相加 (纵坐标, 17))
    赋值 (颜色数组1 [相减 (16, i)] [相加 (j, 1)], .)
    j.画点 (i, )
    映射到图标 (当前图标, 相加 (j, 1), 相加 (i, 1))
    
    
.否则
    赋值 (整除 (横坐标, 8))
    赋值 (横坐标, 相乘 (8, ))
    赋值 (整除 (纵坐标, 8))
    赋值 (纵坐标, 相乘 (8, ))
    横坐标.画矩形 (纵坐标, 相加 (横坐标, 9), 相加 (纵坐标, 9))
    赋值 (颜色数组2 [相减 (32, i)] [相加 (j, 1)], .)
    j.画点 (i, )
    映射到图标 (当前图标, 相加 (j, 1), 相加 (i, 1))
    
.如果结束


.子程序 映射到图标, 空白型, , 
.参数 哪个图标, 整数型, , 
.参数 横位置, 整数型, , 
.参数 纵位置, 整数型, , 

.局部变量 行首点, 整数型, , , 
.局部变量 当前列, 整数型, , , 
.局部变量 当前点, 整数型, , , 
.局部变量 x, 短整数型, , , 
.局部变量 y, 整数型, , , 
.局部变量 临时颜色, 字节集, , , 

.如果 (等于 (哪个图标, 1))
    赋值 (行首点, 相加 (相乘 (相减 (16, 纵位置), 48), 1, 62))
    赋值 (当前列, 相减 (相乘 (横位置, 3), 3))
    赋值 (当前点, 相加 (行首点, 当前列))
    .如果 (.)
        赋值 (预览图标1, 字节集替换 (预览图标1, 当前点, 3, { 0, 0, 0 }))
        
        赋值 (当前点, 相加 (相乘 (相减 (16, 纵位置), 4), 1, 830))
        赋值 (x, 取字节集数据 (取字节集中间 (预览图标1, 当前点, 2), #短整数型))
        .如果 (小于 (横位置, 9))
            赋值 (x, 位或 (x, 求次方 (2, 相减 (8, 横位置))))
        .否则
            赋值 (x, 位或 (x, 求次方 (2, 相减 (24, 横位置))))
        .如果结束
        赋值 (预览图标1, 字节集替换 (预览图标1, 当前点, 2, 到字节集 (x)))
        
    .否则
        赋值 (临时颜色, 相加 (临时颜色, 取字节集中间 (到字节集 (画点颜色), 3, 1)))
        赋值 (临时颜色, 相加 (临时颜色, 取字节集中间 (到字节集 (画点颜色), 2, 1)))
        赋值 (临时颜色, 相加 (临时颜色, 取字节集左边 (到字节集 (画点颜色), 1)))
        赋值 (预览图标1, 字节集替换 (预览图标1, 当前点, 3, 临时颜色))
    .如果结束
    
.否则
    赋值 (行首点, 相加 (相乘 (相减 (32, 纵位置), 96), 1, 62))
    赋值 (当前列, 相减 (相乘 (横位置, 3), 3))
    赋值 (当前点, 相加 (行首点, 当前列))
    .如果 (.)
        赋值 (预览图标2, 字节集替换 (预览图标2, 当前点, 3, { 0, 0, 0 }))
        
        赋值 (当前点, 相加 (相乘 (相减 (32, 纵位置), 4), 1, 3134))
        赋值 (y, 取字节集数据 (取字节集中间 (预览图标2, 当前点, 4), #整数型))
        .判断开始 (小于或等于 (横位置, 8))
            赋值 (y, 位或 (y, 求次方 (2, 相减 (8, 横位置))))
            
        .判断 (并且 (大于 (横位置, 8), 小于或等于 (横位置, 16)))
            赋值 (y, 位或 (y, 求次方 (2, 相减 (24, 横位置))))
            
        .判断 (并且 (大于 (横位置, 16), 小于或等于 (横位置, 24)))
            赋值 (y, 位或 (y, 求次方 (2, 相减 (40, 横位置))))
            
        .判断 (并且 (大于 (横位置, 24), 小于或等于 (横位置, 32)))
            赋值 (y, 位或 (y, 求次方 (2, 相减 (56, 横位置))))
        .默认
            
        .判断结束
        赋值 (预览图标2, 字节集替换 (预览图标2, 当前点, 4, 到字节集 (y)))
        
    .否则
        赋值 (临时颜色, 相加 (临时颜色, 取字节集中间 (到字节集 (画点颜色), 3, 1)))
        赋值 (临时颜色, 相加 (临时颜色, 取字节集中间 (到字节集 (画点颜色), 2, 1)))
        赋值 (临时颜色, 相加 (临时颜色, 取字节集左边 (到字节集 (画点颜色), 1)))
        赋值 (预览图标2, 字节集替换 (预览图标2, 当前点, 3, 临时颜色))
        
    .如果结束
    
.如果结束


.子程序 _画板1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (编辑, 假)

.子程序 _单选框2_被单击, 空白型, , 
.如果真 (.)
    赋值 (., 真)
.如果真结束


.子程序 _窗口1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_画板1_鼠标左键被放开 (横向位置, 纵向位置, 功能键状态)

.子程序 _按钮1_被单击, 空白型, , 
.判断开始 (_启动窗口..)
    赋值 (_启动窗口.., 预览图标1)
    赋值 (输出图标, 预览图标1)
    
.判断 (_启动窗口..)
    赋值 (_启动窗口.., 预览图标2)
    赋值 (输出图标, 预览图标2)
    
.判断 (_启动窗口..)
    赋值 (_启动窗口.., 预览图标1)
    赋值 (_启动窗口.., 预览图标2)
    赋值 (输出图标, 字节集替换 (输出图标, 39, 872, 取字节集右边 (预览图标1, 872)))
    赋值 (输出图标, 字节集替换 (输出图标, 911, 3240, 取字节集右边 (预览图标2, 3240)))
.默认
    
.判断结束
销毁 ()

.子程序 _按钮2_被单击, 空白型, , 
.局部变量 xx, 整数型, , , 

赋值 (信息框 (“真的放弃编辑成果？”, 68, “信息”))
.如果 (等于 (5))
    销毁 ()
.否则
    返回 ()
.如果结束




 ' 不属于任何一个程序集、类模块的函数：
