 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 270
    高度 = 236
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 _程序窗口
    左边 = 50
    顶边 = 50
    宽度 = 900
    高度 = 486
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “超级用户后台管理”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' spec A512548E76954B6E92C21055517615B0 3 0 特殊功能支持库



 ' 所需要的模块
 ' PHP_MYSQL操作模块 C:\Documents and Settings\Administrator\桌面\PHP垃圾收费系统\PHP_MYSQL操作模块.ec


.全局变量 网络时间戳, 长整数型, , , 
.全局变量 服务器时间, 日期时间型, , , 
.全局变量 网络日期, 文本型, , , 
.全局变量 每页显示条数, 整数型, , , 
.全局变量 当前页码, 整数型, , , 
.全局变量 总条数, 整数型, , , 

.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
_启动窗口.获取焦点 (.)
.如果 (等于 (PHP_MYSQL初始化 (“http://127.0.0.1/”, “php.php”, “0”), 真))
    
.否则
    信息框 (“数据库初始化失败，请检查网络配置！”, #错误图标, )
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
.如果 (等于 (PHP_MYSQL查询是否存在 (“admin”, “user,pass”, 相加 (“user='”, .内容, “' and pass='”, .内容, “' and qx=1”)), 真))
    载入 (_程序窗口, , 假)
    _启动窗口.销毁 ()
.否则
    信息框 (“管理帐号密码错误！”, #错误图标, )
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集2, , , 

.子程序 _按钮_列出用户_被单击, 空白型, , 
.局部变量 记录集, 文本型, , , 
.局部变量 记录集分割, 文本型, , "0", 
.局部变量 记录集二分割, 文本型, , "0", 
.局部变量 i, 整数型, , , 
.局部变量 A, 整数型, , , 
.局部变量 B, 文本型, , , 
.局部变量 i2, 整数型, , , 
.局部变量 条件, 文本型, , , 
.局部变量 c, 文本型, , , 
.局部变量 在线, 整数型, , , 

全部删除 ()
赋值 (记录集, PHP_MYSQL查询 (“`user`”, “u_id,u_qq,u_pass,u_time,u_time,u_zx”))
调试输出 (记录集)
赋值 (总条数, PHP_MYSQL取记录数 (“user”))
赋值 (记录集分割, 分割文本 (记录集, “§”, ))
.判断开始 (大于或等于 (取数组成员数 (记录集分割), 1))
    .计次循环首 (取数组成员数 (记录集分割), i)
        赋值 (记录集二分割, 分割文本 (记录集分割 [i], “|”, ))
        .如果真 (大于或等于 (i, 1))
            赋值 (A, .插入表项 ())
            .计次循环首 (取数组成员数 (记录集二分割), i2)
                赋值 (B, 记录集二分割 [i2])
                .如果真 (等于 (i2, 4))
                    赋值 (B, 到文本 (到时间 (B)))
                    A.置标题 (相减 (i2, 1), B)
                .如果真结束
                
                .如果真 (等于 (i2, 5))
                    .如果 (大于 (取时间间隔 (到时间 (B), 到时间 (PHP_MYSQL取服务器时间 ()), 7), 0))
                        赋值 (B, 相加 (到文本 (四舍五入 (相除 (取时间间隔 (到时间 (B), 到时间 (PHP_MYSQL取服务器时间 ()), 7), 60), 1)), “/小时”))
                    .否则
                        赋值 (B, “0/小时”)
                    .如果结束
                    A.置标题 (相减 (i2, 1), B)
                .如果真结束
                .如果真 (等于 (i2, 6))
                    .如果 (等于 (B, “0”))
                        赋值 (B, “否”)
                    .否则
                        赋值 (B, “是”)
                    .如果结束
                    A.置标题 (相减 (i2, 1), B)
                .如果真结束
                A.置标题 (相减 (i2, 1), B)
            .计次循环尾 ()
        .如果真结束
        
    .计次循环尾 ()
    赋值 (在线, PHP_MYSQL取记录数 (“`user`”, “u_zx=1”))
    .如果 (不等于 (求余数 (总条数, 100), 0))
        赋值 (.标题, 相加 (“数据总条数：”, 到文本 (总条数), “     ”, “每页显示条数：”, 到文本 (100), “     ”, “当前页：”, 到文本 (相加 (相除 (当前页码, 100), 1)), “/”, 到文本 (相加 (取整 (相除 (总条数, 100)), 1)), “    在线人数：”, 到文本 (在线)))
    .否则
        赋值 (.标题, 相加 (“数据总条数：”, 到文本 (总条数), “     ”, “每页显示条数：”, 到文本 (100), “     ”, “当前页：”, 到文本 (相加 (相除 (当前页码, 100), 1)), “/”, 到文本 (取整 (相除 (总条数, 100))), “在线人数：”, 到文本 (在线)))
    .如果结束
    
     ' 标签10.标题 ＝ “数据总条数：” ＋ 到文本 (总条数) ＋ “  ” ＋ “每页显示条数：” ＋ 到文本 (100) ＋ “  ” ＋ “当前页：” ＋ 到文本 (当前页码 ÷ 100 ＋ 1)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
.默认
    
.判断结束


.子程序 __程序窗口_创建完毕, 空白型, , 
赋值 (每页显示条数, 100)
赋值 (当前页码, 0)
列出管理 ()

.子程序 _超级列表框1_当前表项被改变, 空白型, , 
.如果真 (不等于 (., -1))
    赋值 (.内容, .取标题 (., 1))
    赋值 (.内容, .取标题 (., 2))
    赋值 (.内容, .取标题 (., 3))
    .判断开始 (等于 (.取标题 (., 5), “是”))
        赋值 (.选中, 真)
    .默认
        赋值 (.选中, 假)
    .判断结束
    
.如果真结束


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 在线, 文本型, , , 

.如果真 (等于 (信息框 (“是否要修改当前用户数据？”, 相加 (#信息图标, #是否钮), ), #是钮))
    .判断开始 (等于 (.选中, 真))
        赋值 (在线, “1”)
    .默认
        赋值 (在线, “0”)
    .判断结束
    .如果真 (等于 (.内容, “”))
        信息框 (“修改时间格式错误！”, #错误图标, )
        返回 ()
    .如果真结束
    .如果真 (不等于 (., -1))
        .如果 (PHP_MYSQL修改 (“`user`”, 相加 (“u_qq='”, .内容, “',u_pass='”, .内容, “',u_time='”, PHP_MYSQL时间处理 (到时间 (.内容)), “',u_zx=”, 在线), 相加 (“u_id=”, .取标题 (., 0))))
            信息框 (“修改成功”, 0, )
        .否则
            信息框 (“修改失败”, 0, )
        .如果结束
        
    .如果真结束
    
.如果真结束
_按钮_列出用户_被单击 ()

.子程序 _用户_首页_被单击, 空白型, , 
赋值 (总条数, PHP_MYSQL取记录数 (“`user`”))
.如果真 (等于 (每页显示条数, 100))
    信息框 (“已经是最前一页”, 0, )
    返回 ()
.如果真结束
赋值 (每页显示条数, 100)
赋值 (当前页码, 0)
_按钮_列出用户_被单击 ()

.子程序 _用户_上一页_被单击, 空白型, , 
赋值 (总条数, PHP_MYSQL取记录数 (“`user`”))
.如果真 (等于 (每页显示条数, 100))
    信息框 (“已经是最前一页”, 0, )
    赋值 (每页显示条数, 100)
    赋值 (当前页码, 0)
    返回 ()
.如果真结束
赋值 (每页显示条数, 相减 (每页显示条数, 100))
赋值 (当前页码, 相减 (每页显示条数, 100))
_按钮_列出用户_被单击 ()

.子程序 _用户_下一页_被单击, 空白型, , 
赋值 (总条数, PHP_MYSQL取记录数 (“`user`”))
.如果真 (大于或等于 (每页显示条数, 总条数))
    信息框 (“已经是最后一页”, 0, )
    返回 ()
.如果真结束
赋值 (每页显示条数, 相加 (每页显示条数, 100))
赋值 (当前页码, 相减 (每页显示条数, 100))
_按钮_列出用户_被单击 ()

.子程序 _用户_跳到_被单击, 空白型, , 
赋值 (总条数, PHP_MYSQL取记录数 (“`user`”))
.如果真 (小于或等于 (到数值 (.内容), 0))
    信息框 (“不能跳到小于0的页数！”, 0, )
    返回 ()
.如果真结束
.如果 (不等于 (求余数 (总条数, 100), 0))
    .如果 (大于 (到数值 (.内容), 取整 (相加 (相除 (总条数, 100), 1))))
        信息框 (“不能跳到超出总页数范围”, 0, )
        返回 ()
    .否则
        赋值 (当前页码, 相乘 (相减 (到数值 (.内容), 1), 100))
        赋值 (每页显示条数, 相加 (当前页码, 100))
        _按钮_列出用户_被单击 ()
    .如果结束
    
.否则
    .如果 (大于 (相减 (到数值 (.内容), 1), 取整 (相加 (相除 (总条数, 100), 1))))
        信息框 (“不能跳到超出总页数范围”, 0, )
        返回 ()
    .否则
        赋值 (当前页码, 相乘 (相减 (到数值 (.内容), 1), 100))
        赋值 (每页显示条数, 相加 (当前页码, 100))
        _按钮_列出用户_被单击 ()
    .如果结束
    
.如果结束

 ' 如果真 (每页显示条数 ≥ 总条数)
 ' 信息框 (“已经是最后一页”, 0, )
 ' 返回 ()
 ' 当前页码 ＝ 到数值 (编辑框12.内容) × 100
 ' 每页显示条数 ＝ 当前页码 ＋ 100
 ' _按钮_列出用户_被单击 ()

.子程序 _按钮3_被单击, 空白型, , 
.如果真 (等于 (信息框 (“是否要删除当前用户数据？”, 相加 (#信息图标, #是否钮), ), #是钮))
    .如果真 (不等于 (., -1))
        .如果 (PHP_MYSQL删除 (“`user`”, 相加 (“u_id=”, .取标题 (., 0))))
            信息框 (“删除成功”, 0, )
        .否则
            信息框 (“删除失败”, 0, )
        .如果结束
        
    .如果真结束
    
.如果真结束
_按钮_列出用户_被单击 ()

.子程序 _按钮15_被单击, 空白型, , 
.如果真 (等于 (信息框 (“是否要清空所有数据？”, 相加 (#信息图标, #是否钮), ), #是钮))
    .如果 (PHP_MYSQL删除 (“`user`”))
        信息框 (“清空成功”, 0, )
    .否则
        信息框 (“清空失败”, 0, )
    .如果结束
    
.如果真结束
_按钮_列出用户_被单击 ()

.子程序 _按钮13_被单击, 空白型, , 
.局部变量 记录集, 文本型, , , 
.局部变量 记录集分割, 文本型, , "0", 
.局部变量 记录集二分割, 文本型, , "0", 
.局部变量 i, 整数型, , , 
.局部变量 A, 整数型, , , 
.局部变量 B, 文本型, , , 
.局部变量 i2, 整数型, , , 
.局部变量 条件, 文本型, , , 

赋值 (条件, 相加 (“u_qq=”, .内容))
全部删除 ()
赋值 (记录集, PHP_MYSQL查询 (“`user`”, “u_id,u_qq,u_pass,u_time,u_time,u_zx”, 条件))
调试输出 (记录集)
赋值 (总条数, PHP_MYSQL取记录数 (“`user`”))
赋值 (记录集分割, 分割文本 (记录集, “§”, ))
.判断开始 (大于或等于 (取数组成员数 (记录集分割), 1))
    .计次循环首 (取数组成员数 (记录集分割), i)
        .如果真 (大于或等于 (i, 1))
            赋值 (记录集二分割, 分割文本 (记录集分割 [i], “|”, ))
            赋值 (A, .插入表项 ())
            .计次循环首 (取数组成员数 (记录集二分割), i2)
                赋值 (B, 记录集二分割 [i2])
                .如果真 (等于 (i2, 4))
                    赋值 (B, 到文本 (到时间 (B)))
                    A.置标题 (相减 (i2, 1), B)
                .如果真结束
                .如果真 (等于 (i2, 5))
                    .如果 (大于 (取时间间隔 (到时间 (B), 到时间 (PHP_MYSQL取服务器时间 ()), 6), 0))
                        赋值 (B, 相加 (到文本 (取时间间隔 (到时间 (B), 到时间 (PHP_MYSQL取服务器时间 ()), 6)), “/小时”))
                    .否则
                        赋值 (B, “0/小时”)
                    .如果结束
                    A.置标题 (相减 (i2, 1), B)
                .如果真结束
                .如果真 (等于 (i2, 6))
                    .如果 (等于 (B, “0”))
                        赋值 (B, “否”)
                    .否则
                        赋值 (B, “是”)
                    .如果结束
                    A.置标题 (相减 (i2, 1), B)
                .如果真结束
                A.置标题 (相减 (i2, 1), B)
            .计次循环尾 ()
            
        .如果真结束
        
    .计次循环尾 ()
.默认
    信息框 (“无此用户！”, #错误图标, “错误”)
    返回 ()
.判断结束
.如果 (大于 (取时间间隔 (到时间 (记录集二分割 [5]), 到时间 (PHP_MYSQL取服务器时间 ()), 6), 0))
    信息框 (相加 (.内容, “ 剩余时间：”, 到文本 (取时间间隔 (到时间 (记录集二分割 [5]), 到时间 (PHP_MYSQL取服务器时间 ()), 6)), “小时”, #换行符, #换行符, “到期时间：”, 到文本 (到时间 (记录集二分割 [5]))), 0, )
.否则
    信息框 (相加 (.内容, “ 剩余时间：”, 到文本 (0), “小时”, #换行符, #换行符, “到期时间：”, 到文本 (记录集二分割 [5])), 0, )
.如果结束


.子程序 _按钮5_被单击, 空白型, , 
.局部变量 czlx, 整数型, , , 
.局部变量 次, 整数型, , , 
.局部变量 冲值卡号, 文本型, , , 
.局部变量 密码, 文本型, , , 
.局部变量 成功, 整数型, , , 
.局部变量 失败, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 代理人, 文本型, , , 
.局部变量 生成文本, 文本型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请选择代理商！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (.禁止, 真)
赋值 (czlx, 相加 (.现行选中项, 1))
赋值 (代理人, .内容)

置随机数种子 ()
赋值 (次, 到数值 (.内容))
.计次循环首 (次, i)
    1.置文本 (相加 (“正在生成 ”, .内容, “ 第 ”, 到文本 (i), “ 张”))
    处理事件 ()
    赋值 (冲值卡号, 相加 (到文本 (到大写 (字符 (取随机数 (97, 122)))), 到文本 (到大写 (字符 (取随机数 (97, 122)))), 到文本 (取随机数 (10, 99)), “-”, 到文本 (取随机数 (10, 99)), 到文本 (到大写 (字符 (取随机数 (97, 122)))), 到文本 (到大写 (字符 (取随机数 (97, 122)))), “-”, 到文本 (到大写 (字符 (取随机数 (97, 122)))), 到文本 (取随机数 (10, 99)), 到文本 (到大写 (字符 (取随机数 (97, 122)))), “-”, 到文本 (取随机数 (100, 999)), 到文本 (到大写 (字符 (取随机数 (97, 122))))))
    赋值 (密码, 冲值卡号)
    .如果 (PHP_MYSQL添加 (“`czk`”, “k_czkh,k_czmm,k_czlx,k_dlyh,k_sfcz”, 相加 (“'”, 冲值卡号, “','”, 密码, “',”, 到文本 (czlx), “,'”, .内容, “','0'”)))
        1.置文本 (相加 (“正在生成 ”, .内容, “ 第 ”, 到文本 (i), “ 张 --- 成功”))
        赋值 (成功, 相加 (成功, 1))
        处理事件 ()
    .否则
        1.置文本 (相加 (“正在生成 ”, .内容, “ 第 ”, 到文本 (i), “ 张 --- 失败”))
        赋值 (失败, 相加 (失败, 1))
        处理事件 ()
    .如果结束
    赋值 (生成文本, 相加 (生成文本, 冲值卡号, 字符 (9), #换行符))
.计次循环尾 ()
1.置文本 (相加 (“生成 ”, .内容, “ 成功:”, 到文本 (成功), “ 失败:”, 到文本 (失败)))
.如果 (等于 (信息框 (相加 (“操作完成”, #换行符, #换行符, “本次成功生成”, 到文本 (成功), “张充值卡!”, #换行符, #换行符, “失败”, 到文本 (失败), “次!”, #换行符, #换行符, “是否保存到文本？”), #是否钮, “提示：”), #是钮))
    赋值 (.禁止, 假)
    赋值 (.类型, 1)
    赋值 (.过滤器, “文本文件(*.txt)|*.txt|所有文件(*.*)|*.*”)
    赋值 (.默认文件后缀, “.txt”)
    赋值 (.文件名, 相加 (到文本 (代理人), “新的”, 到文本 (次), “张”, .内容, “（”, 到文本 (取现行时间 ()), “)”))
    .如果真 (等于 (打开 (), 假))
        返回 ()
    .如果真结束
    .如果 (写到文件 (.文件名, 到字节集 (相加 (“代理商：”, 代理人, #换行符, “生成时间：”, 到文本 (取现行时间 ()), #换行符, 生成文本))))
        信息框 (“写出成功”, 0, )
    .否则
        信息框 (“写出失败”, 0, )
    .如果结束
    
.否则
    赋值 (.禁止, 假)
.如果结束


.子程序 列出管理, 空白型, , 
.局部变量 记录集, 文本型, , , 
.局部变量 记录集分割, 文本型, , "0", 
.局部变量 记录集二分割, 文本型, , "0", 
.局部变量 i, 整数型, , , 
.局部变量 A, 整数型, , , 
.局部变量 B, 文本型, , , 
.局部变量 i2, 整数型, , , 
.局部变量 条件, 文本型, , , 

清空 ()
清空 ()
全部删除 ()
赋值 (记录集, PHP_MYSQL查询 (“admin”))
调试输出 (记录集)
赋值 (总条数, PHP_MYSQL取记录数 (“admin”))

赋值 (记录集分割, 分割文本 (记录集, “§”, ))
.判断开始 (大于或等于 (取数组成员数 (记录集分割), 1))
    .计次循环首 (取数组成员数 (记录集分割), i)
        赋值 (记录集二分割, 分割文本 (记录集分割 [i], “|”, ))
        .如果真 (大于或等于 (i, 1))
            赋值 (A, .插入表项 ())
            记录集二分割.加入项目 ( [2], )
            记录集二分割.加入项目 ( [2], )
            .计次循环首 (取数组成员数 (记录集二分割), i2)
                赋值 (B, 记录集二分割 [i2])
                .如果真 (等于 (i2, 4))
                    .如果 (等于 (B, “1”))
                        赋值 (B, “管理员”)
                    .否则
                        赋值 (B, “代理商”)
                    .如果结束
                    A.置标题 (相减 (i2, 1), B)
                .如果真结束
                A.置标题 (相减 (i2, 1), B)
            .计次循环尾 ()
        .如果真结束
        
    .计次循环尾 ()
.默认
    
.判断结束


.子程序 _按钮6_被单击, 空白型, , 
.局部变量 记录集, 文本型, , , 
.局部变量 记录集分割, 文本型, , "0", 
.局部变量 记录集二分割, 文本型, , "0", 
.局部变量 i, 整数型, , , 
.局部变量 A, 整数型, , , 
.局部变量 B, 文本型, , , 
.局部变量 i2, 整数型, , , 
.局部变量 条件, 文本型, , , 

.如果真 (等于 (.选中, 真))
    .如果 (等于 (.现行选中项, 0))
        赋值 (条件, “”)
    .否则
        赋值 (条件, 相加 (“k_czlx=”, 到文本 (.现行选中项)))
    .如果结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果 (等于 (.现行选中项, 0))
        赋值 (条件, “k_sfcz=1”)
    .否则
        赋值 (条件, 相加 (“k_czlx=”, 到文本 (.现行选中项), “ and k_sfcz=1”))
    .如果结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果 (等于 (.现行选中项, 0))
        赋值 (条件, “k_sfcz=0”)
    .否则
        赋值 (条件, 相加 (“k_czlx=”, 到文本 (.现行选中项), “ and k_sfcz=0”))
    .如果结束
    
.如果真结束
全部删除 ()
赋值 (记录集, PHP_MYSQL查询 (“`czk`”, “k_id,k_czkh,k_czmm,k_czlx,k_sfcz,k_czzh,k_dlyh,k_bz”, 条件))
调试输出 (记录集)
.如果 (等于 (.现行选中项, 0))
    赋值 (总条数, PHP_MYSQL取记录数 (“`czk`”))
.否则
    赋值 (总条数, PHP_MYSQL取记录数 (“`czk`”, 相加 (“k_czlx=”, 到文本 (.现行选中项))))
.如果结束
赋值 (记录集分割, 分割文本 (记录集, “§”, ))
.判断开始 (大于或等于 (取数组成员数 (记录集分割), 1))
    .计次循环首 (取数组成员数 (记录集分割), i)
        赋值 (记录集二分割, 分割文本 (记录集分割 [i], “|”, ))
        .如果真 (大于或等于 (i, 1))
            赋值 (A, .插入表项 ())
            .计次循环首 (取数组成员数 (记录集二分割), i2)
                赋值 (B, 记录集二分割 [i2])
                .如果真 (等于 (i2, 4))
                    .判断开始 (等于 (B, “1”))
                        赋值 (B, “计日卡”)
                    .判断 (等于 (B, “2”))
                        赋值 (B, “计周卡”)
                    .判断 (等于 (B, “3”))
                        赋值 (B, “计月卡”)
                    .判断 (等于 (B, “4”))
                        赋值 (B, “计季卡”)
                    .默认
                        赋值 (B, “未知卡类”)
                    .判断结束
                    A.置标题 (相减 (i2, 1), B)
                .如果真结束
                .如果真 (等于 (i2, 5))
                    .判断开始 (等于 (B, “0”))
                        赋值 (B, “未充值”)
                    .默认
                        赋值 (B, “已充值”)
                    .判断结束
                    A.置标题 (相减 (i2, 1), B)
                .如果真结束
                A.置标题 (相减 (i2, 1), B)
            .计次循环尾 ()
        .如果真结束
        
    .计次循环尾 ()
    .如果 (不等于 (求余数 (总条数, 100), 0))
        赋值 (.标题, 相加 (“数据总条数：”, 到文本 (总条数), “     ”, “每页显示条数：”, 到文本 (100), “     ”, “当前页：”, 到文本 (相加 (相除 (当前页码, 100), 1)), “/”, 到文本 (相加 (取整 (相除 (总条数, 100)), 1))))
    .否则
        赋值 (.标题, 相加 (“数据总条数：”, 到文本 (总条数), “     ”, “每页显示条数：”, 到文本 (100), “     ”, “当前页：”, 到文本 (相加 (相除 (当前页码, 100), 1)), “/”, 到文本 (取整 (相除 (总条数, 100)))))
    .如果结束
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
.默认
    
.判断结束


.子程序 _选择夹1_子夹被改变, 空白型, , 
赋值 (每页显示条数, 100)
赋值 (当前页码, 0)

.子程序 _单选框1_被单击, 空白型, , 
赋值 (每页显示条数, 100)
赋值 (当前页码, 0)

.子程序 _单选框2_被单击, 空白型, , 
赋值 (每页显示条数, 100)
赋值 (当前页码, 0)

.子程序 _单选框3_被单击, 空白型, , 
赋值 (每页显示条数, 100)
赋值 (当前页码, 0)

.子程序 _超级列表框2_当前表项被改变, 空白型, , 
.如果真 (不等于 (., -1))
    赋值 (.内容, .取标题 (., 1))
    赋值 (.内容, .取标题 (., 2))
    .判断开始 (等于 (.取标题 (., 3), “计日卡”))
        赋值 (.现行选中项, 0)
    .判断 (等于 (.取标题 (., 3), “计周卡”))
        赋值 (.现行选中项, 1)
    .判断 (等于 (.取标题 (., 3), “计月卡”))
        赋值 (.现行选中项, 2)
    .判断 (等于 (.取标题 (., 3), “计季卡”))
        赋值 (.现行选中项, 3)
    .默认
        
    .判断结束
    .判断开始 (等于 (.取标题 (., 4), “未充值”))
        赋值 (.现行选中项, 0)
    .默认
        赋值 (.现行选中项, 1)
    .判断结束
    赋值 (.内容, .取标题 (., 7))
.如果真结束


.子程序 _卡_首页_被单击, 空白型, , 
.如果 (等于 (.内容, “”))
    赋值 (总条数, PHP_MYSQL取记录数 (“`czk`”))
.否则
    赋值 (总条数, PHP_MYSQL取记录数 (“`czk`”, 相加 (“k_dlyh='”, .内容, “'”)))
.如果结束
.如果真 (等于 (每页显示条数, 100))
    信息框 (“已经是最前一页”, 0, )
    返回 ()
.如果真结束
赋值 (每页显示条数, 100)
赋值 (当前页码, 0)
.如果 (等于 (.内容, “”))
    _按钮6_被单击 ()
.否则
    _按钮18_被单击 ()
.如果结束


.子程序 _卡_上一页_被单击, 空白型, , 
.如果 (等于 (.内容, “”))
    赋值 (总条数, PHP_MYSQL取记录数 (“`czk`”))
.否则
    赋值 (总条数, PHP_MYSQL取记录数 (“`czk`”, 相加 (“k_dlyh='”, .内容, “'”)))
.如果结束
.如果真 (等于 (每页显示条数, 100))
    信息框 (“已经是最前一页”, 0, )
    赋值 (每页显示条数, 100)
    赋值 (当前页码, 0)
    返回 ()
.如果真结束
赋值 (每页显示条数, 相减 (每页显示条数, 100))
赋值 (当前页码, 相减 (每页显示条数, 100))
.如果 (等于 (.内容, “”))
    _按钮6_被单击 ()
.否则
    _按钮18_被单击 ()
.如果结束


.子程序 _卡_下一页_被单击, 空白型, , 
.如果 (等于 (.内容, “”))
    赋值 (总条数, PHP_MYSQL取记录数 (“`czk`”))
.否则
    赋值 (总条数, PHP_MYSQL取记录数 (“`czk`”, 相加 (“k_dlyh='”, .内容, “'”)))
.如果结束
.如果真 (大于或等于 (每页显示条数, 总条数))
    信息框 (“已经是最后一页”, 0, )
    返回 ()
.如果真结束
赋值 (每页显示条数, 相加 (每页显示条数, 100))
赋值 (当前页码, 相减 (每页显示条数, 100))
.如果 (等于 (.内容, “”))
    _按钮6_被单击 ()
.否则
    _按钮18_被单击 ()
.如果结束


.子程序 _卡_跳到_被单击, 空白型, , 
.如果 (等于 (.内容, “”))
    赋值 (总条数, PHP_MYSQL取记录数 (“`czk`”))
.否则
    赋值 (总条数, PHP_MYSQL取记录数 (“`czk`”, 相加 (“k_dlyh='”, .内容, “'”)))
.如果结束
.如果真 (小于或等于 (到数值 (.内容), 0))
    信息框 (“不能跳到小于0的页数！”, 0, )
    返回 ()
.如果真结束
.如果 (不等于 (求余数 (总条数, 100), 0))
    .如果 (大于 (到数值 (.内容), 取整 (相加 (相除 (总条数, 100), 1))))
        信息框 (“不能跳到超出总页数范围”, 0, )
        返回 ()
    .否则
        赋值 (当前页码, 相乘 (相减 (到数值 (.内容), 1), 100))
        赋值 (每页显示条数, 相加 (当前页码, 100))
        .如果 (等于 (.内容, “”))
            _按钮6_被单击 ()
        .否则
            _按钮18_被单击 ()
        .如果结束
        
    .如果结束
    
.否则
    .如果 (大于 (相减 (到数值 (.内容), 1), 取整 (相加 (相除 (总条数, 100), 1))))
        信息框 (“不能跳到超出总页数范围”, 0, )
        返回 ()
    .否则
        赋值 (当前页码, 相乘 (相减 (到数值 (.内容), 1), 100))
        赋值 (每页显示条数, 相加 (当前页码, 100))
        .如果 (等于 (.内容, “”))
            _按钮6_被单击 ()
        .否则
            _按钮18_被单击 ()
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 _按钮7_被单击, 空白型, , 
赋值 (每页显示条数, 100)
赋值 (当前页码, 0)
.如果 (PHP_MYSQL修改 (“`czk`”, 相加 (“`k_czkh`='”, .内容, “',`k_czmm`='”, .内容, “',`k_czlx`='”, 到文本 (相加 (.现行选中项, 1)), “',`k_sfcz`='”, 到文本 (.现行选中项), “',`k_bz`='”, .内容, “'”), 相加 (“k_id=”, .取标题 (., 0))))
    信息框 (“修改成功！”, 0, )
    .如果 (等于 (.内容, “”))
        _按钮6_被单击 ()
    .否则
        _按钮18_被单击 ()
    .如果结束
    
.否则
    信息框 (“修改失败！”, 0, )
.如果结束


.子程序 _按钮18_被单击, 空白型, , 
.局部变量 记录集, 文本型, , , 
.局部变量 记录集分割, 文本型, , "0", 
.局部变量 记录集二分割, 文本型, , "0", 
.局部变量 i, 整数型, , , 
.局部变量 A, 整数型, , , 
.局部变量 B, 文本型, , , 
.局部变量 i2, 整数型, , , 
.局部变量 条件, 文本型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请选择代理！”, 0, )
    返回 ()
.如果真结束
赋值 (条件, 相加 (“k_dlyh='”, .内容, “'”))
全部删除 ()
 ' 记录集 ＝ PHP_MYSQL取中间数据 (“`czk`”, “k_id,k_czkh,k_czmm,k_czlx,k_sfcz,k_czzh,k_dlyh,k_bz”, 条件, 每页显示条数, 当前页码)
调试输出 (记录集)
赋值 (总条数, PHP_MYSQL取记录数 (“`czk`”, 条件))
赋值 (记录集分割, 分割文本 (记录集, “§”, ))
.判断开始 (大于或等于 (取数组成员数 (记录集分割), 2))
    .计次循环首 (取数组成员数 (记录集分割), i)
        赋值 (记录集二分割, 分割文本 (记录集分割 [i], “|”, ))
        .如果真 (大于或等于 (i, 2))
            赋值 (A, .插入表项 ())
            .计次循环首 (取数组成员数 (记录集二分割), i2)
                赋值 (B, 记录集二分割 [i2])
                .如果真 (等于 (i2, 4))
                    .判断开始 (等于 (B, “1”))
                        赋值 (B, “计日卡”)
                    .判断 (等于 (B, “2”))
                        赋值 (B, “计周卡”)
                    .判断 (等于 (B, “3”))
                        赋值 (B, “计月卡”)
                    .判断 (等于 (B, “4”))
                        赋值 (B, “计季卡”)
                    .默认
                        赋值 (B, “未知卡类”)
                    .判断结束
                    A.置标题 (相减 (i2, 1), B)
                .如果真结束
                .如果真 (等于 (i2, 5))
                    .判断开始 (等于 (B, “0”))
                        赋值 (B, “未充值”)
                    .默认
                        赋值 (B, “已充值”)
                    .判断结束
                    A.置标题 (相减 (i2, 1), B)
                .如果真结束
                A.置标题 (相减 (i2, 1), B)
            .计次循环尾 ()
        .如果真结束
        
    .计次循环尾 ()
    赋值 (.标题, 相加 (“数据总条数：”, 到文本 (总条数), “     ”, “每页显示条数：”, 到文本 (100), “     ”, “当前页：”, 到文本 (相加 (相除 (当前页码, 100), 1))))
    赋值 (.禁止, 假)
     ' 卡_尾页.禁止 ＝ 假
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
.默认
    
.判断结束


.子程序 _组合框6_列表项被选择, 空白型, , 
赋值 (每页显示条数, 100)
赋值 (当前页码, 0)

.子程序 _组合框1_列表项被选择, 空白型, , 
赋值 (每页显示条数, 100)
赋值 (当前页码, 0)

.子程序 _按钮8_被单击, 空白型, , 
.如果真 (等于 (信息框 (“是否要删除当前数据？”, 相加 (#信息图标, #是否钮), ), #是钮))
    .如果 (PHP_MYSQL删除 (“`czk`”, 相加 (“k_id=”, .取标题 (., 0))))
        信息框 (“删除成功”, 0, )
    .否则
        信息框 (“删除失败”, 0, )
    .如果结束
    .如果 (等于 (.内容, “”))
        _按钮6_被单击 ()
    .否则
        _按钮18_被单击 ()
    .如果结束
    
.如果真结束


.子程序 _按钮9_被单击, 空白型, , 
.局部变量 文件号, 整数型, , , 
.局部变量 计数器, 整数型, , , 

.如果真 (或者 (等于 (取表项数 (), 0), 等于 (取表项数 (), 1)))
    信息框 (“没有数据”, 0, )
    返回 ()
.如果真结束
赋值 (.类型, 1)
赋值 (.过滤器, “文本文件(*.txt)|*.txt|所有文件(*.*)|*.*”)
赋值 (.默认文件后缀, “.txt”)
赋值 (.文件名, 相加 (到文本 (取现行时间 ()), “卡号数据”))
.如果真 (等于 (打开 (), 假))
    返回 ()
.如果真结束
赋值 (文件号, 打开文件 (.文件名, #重写, ))
移到文件首 (文件号)
.计次循环首 (取表项数 (), 计数器)
    写出文本 (文件号, 相加 (相减 (计数器, 1).取标题 (1), #换行符))
    处理事件 ()
.计次循环尾 ()
关闭文件 (文件号)
信息框 (“导出数据库完毕！”, 0, )


.子程序 _按钮4_被单击, 空白型, , 
.局部变量 文件号, 整数型, , , 
.局部变量 计数器, 整数型, , , 

.如果真 (或者 (等于 (取表项数 (), 0), 等于 (取表项数 (), 1)))
    信息框 (“没有数据”, 0, )
    返回 ()
.如果真结束
赋值 (.类型, 1)
赋值 (.过滤器, “文本文件(*.txt)|*.txt|所有文件(*.*)|*.*”)
赋值 (.默认文件后缀, “.txt”)
赋值 (.文件名, 相加 (到文本 (取现行时间 ()), “用户数据”))
.如果真 (等于 (打开 (), 假))
    返回 ()
.如果真结束
赋值 (文件号, 打开文件 (.文件名, #重写, ))
移到文件首 (文件号)
.计次循环首 (取表项数 (), 计数器)
    写出文本 (文件号, 相加 (相减 (计数器, 1).取标题 (0), “，”))
    写出文本 (文件号, 相加 (相减 (计数器, 1).取标题 (1), “，”))
    写出文本 (文件号, 相加 (相减 (计数器, 1).取标题 (2), “，”))
    写出文本 (文件号, 相加 (相减 (计数器, 1).取标题 (3), “，”))
    写出文本 (文件号, 相加 (相减 (计数器, 1).取标题 (4), “，”))
    写出文本 (文件号, 相加 (相减 (计数器, 1).取标题 (5), “，”))
    处理事件 ()
.计次循环尾 ()
关闭文件 (文件号)
信息框 (“导出数据库完毕！”, 0, )

.子程序 _按钮12_被单击, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 a, 整数型, , "0", 

.如果真 (等于 (信息框 (“是否要删除选中所有数据？”, 相加 (#信息图标, #是否钮), ), #是钮))
    赋值 (.禁止, 真)
    赋值 (a, 取被选择表项 ())
    .计次循环首 (取已选择表项数 (), i)
        PHP_MYSQL删除 (“czk”, 相加 (“k_id=”, a.取标题 ( [i], 0)))
    .计次循环尾 ()
    信息框 (“删除完毕！”, 0, )
    赋值 (.禁止, 假)
    .如果 (等于 (.内容, “”))
        _按钮6_被单击 ()
    .否则
        _按钮18_被单击 ()
    .如果结束
    
.如果真结束


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 用户权限, 文本型, , , 

.如果真 (并且 (等于 (.选中, 假), 等于 (.选中, 假)))
    信息框 (“请选择用户权限！”, 0, )
    返回 ()
.如果真结束
.判断开始 (等于 (.选中, 真))
    赋值 (用户权限, “1”)
.默认
    赋值 (用户权限, “0”)
.判断结束
.如果真 (等于 (PHP_MYSQL查询是否存在 (“admin”, “user”, 相加 (“user='”, .内容, “'”)), 真))
    信息框 (“代理已存在！”, 0, )
    返回 ()
.如果真结束
.如果 (PHP_MYSQL添加 (“admin”, “`user`,`pass`,`qx`,`data`”, 相加 (“'”, .内容, “','”, .内容, “','”, 用户权限, “','”, .内容, “'”)))
    信息框 (“添加成功！”, 0, )
.否则
    信息框 (“添加失败！”, 0, )
.如果结束
列出管理 ()

.子程序 _超级列表框3_当前表项被改变, 空白型, , 
.如果真 (等于 (., -1))
    返回 ()
.如果真结束
赋值 (.内容, .取标题 (., 1))
赋值 (.内容, .取标题 (., 2))
.判断开始 (等于 (.取标题 (., 3), “管理员”))
    赋值 (.选中, 真)
    赋值 (.选中, 假)
.默认
    赋值 (.选中, 真)
    赋值 (.选中, 假)
.判断结束
赋值 (.内容, .取标题 (., 4))

.子程序 _按钮10_被单击, 空白型, , 
.局部变量 用户权限, 文本型, , , 

.如果真 (不等于 (., -1))
    .判断开始 (等于 (.选中, 真))
        赋值 (用户权限, “1”)
    .默认
        赋值 (用户权限, “0”)
    .判断结束
    .如果 (PHP_MYSQL修改 (“admin”, 相加 (“`user`='”, .内容, “',`pass`='”, .内容, “',`qx`='”, 用户权限, “',`data`='”, .内容, “'”), 相加 (“id=”, .取标题 (., 0))))
        信息框 (“修改成功”, 0, )
    .否则
        信息框 (“修改失败”, 0, )
    .如果结束
    列出管理 ()
.如果真结束


.子程序 _按钮11_被单击, 空白型, , 
.如果真 (不等于 (., -1))
    .如果真 (等于 (信息框 (“是否要删除当前数据？”, 相加 (#信息图标, #是否钮), ), #是钮))
        .如果 (PHP_MYSQL删除 (“admin”, 相加 (“id=”, .取标题 (., 0))))
            信息框 (“删除成功”, 0, )
        .否则
            信息框 (“删除失败”, 0, )
        .如果结束
        列出管理 ()
    .如果真结束
    
.如果真结束


.子程序 _按钮16_被单击, 空白型, , 
.如果真 (不等于 (., -1))
    .如果真 (等于 (信息框 (“是否要执行当前批量删除操作？”, 相加 (#信息图标, #是否钮), ), #是钮))
        .如果 (PHP_MYSQL删除 (“czk”, 相加 (“k_dlyh='”, .取标题 (., 1), “'”)))
            信息框 (“删除操作成功”, 0, )
        .否则
            信息框 (“删除操作失败”, 0, )
        .如果结束
        
    .如果真结束
    
.如果真结束


.子程序 _按钮17_被单击, 空白型, , 
.如果真 (不等于 (., -1))
    .如果真 (等于 (信息框 (“是否要执行当前批量作废操作？”, 相加 (#信息图标, #是否钮), ), #是钮))
        .如果 (PHP_MYSQL修改 (“czk”, “k_sfcz=1”, 相加 (“k_dlyh='”, .取标题 (., 1), “'”)))
            信息框 (“作废操作成功”, 0, )
        .否则
            信息框 (“作废操作失败”, 0, )
        .如果结束
        
    .如果真结束
    
.如果真结束


.子程序 _按钮19_被单击, 空白型, , 
.如果真 (不等于 (., -1))
    .如果真 (等于 (信息框 (相加 (“是否要执行当前恢复操作？”, #换行符, “（注意：此操作将把所有作废的卡全部变成可用！）”), 相加 (#信息图标, #是否钮), ), #是钮))
        .如果 (PHP_MYSQL修改 (“czk”, “k_sfcz=0”, 相加 (“k_dlyh='”, .取标题 (., 1), “'”)))
            信息框 (“恢复操作成功”, 0, )
        .否则
            信息框 (“恢复操作失败”, 0, )
        .如果结束
        
    .如果真结束
    
.如果真结束


.子程序 _按钮14_被单击, 空白型, , 
.局部变量 记录集, 文本型, , , 
.局部变量 记录集分割, 文本型, , "0", 
.局部变量 记录集二分割, 文本型, , "0", 
.局部变量 充值, 文本型, , , 
.局部变量 卡类, 文本型, , , 

赋值 (记录集, PHP_MYSQL查询 (“czk”, “k_sfcz,k_czlx,k_dlyh,k_czzh”, 相加 (“k_czkh='”, .内容, “'”)))
赋值 (记录集分割, 分割文本 (记录集, “§”, ))
.如果 (大于或等于 (取数组成员数 (记录集分割), 1))
    赋值 (记录集二分割, 分割文本 (记录集分割 [1], “|”, ))
    .如果 (等于 (记录集二分割 [1], “0”))
        赋值 (充值, “未充值”)
    .否则
        赋值 (充值, “已充值”)
    .如果结束
    .如果 (等于 (记录集二分割 [2], “1”))
        赋值 (卡类, “计日卡”)
    .否则
        .如果 (等于 (记录集二分割 [2], “2”))
            赋值 (卡类, “计周卡”)
        .否则
            .如果 (等于 (记录集二分割 [2], “3”))
                赋值 (卡类, “计月卡”)
            .否则
                .如果 (等于 (记录集二分割 [2], “4”))
                    赋值 (卡类, “计季卡”)
                .否则
                    赋值 (卡类, “未知卡”)
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .如果结束
    信息框 (相加 (“卡号信息：”, .内容, #换行符, #换行符, “是否充值：”, 充值, #换行符, #换行符, “卡号类型：”, 卡类, #换行符, #换行符, “充值用户：”, 记录集二分割 [4], #换行符, #换行符, “代理用户：”, 记录集二分割 [3], #换行符, #换行符), 0, )
.否则
    信息框 (“查无此卡！”, 0, )
    
.如果结束


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 PHP_MYSQL初始化, 逻辑型, , 
.参数 服务器地址, 文本型, , 
.参数 PHP文件名, 文本型, , 
.参数 数据库名, 文本型, , 



.子程序 PHP_MYSQL查询, 文本型, , 
.参数 表名, 文本型, , 
.参数 字段名, 文本型, 可空, 
.参数 条件, 文本型, 可空, 



.子程序 PHP_MYSQL取记录数, 整数型, , 
.参数 表名, 文本型, , 
.参数 条件, 文本型, 可空, 



.子程序 PHP_MYSQL删除, 逻辑型, , 
.参数 表名, 文本型, , 
.参数 条件, 文本型, 可空, 



.子程序 PHP_MYSQL添加, 逻辑型, , 
.参数 表名, 文本型, , 
.参数 字段名, 文本型, , 
.参数 字段值, 文本型, , 



.子程序 PHP_MYSQL修改, 逻辑型, , 
.参数 表名, 文本型, , 
.参数 修改内容, 文本型, , 
.参数 条件, 文本型, , 



.子程序 PHP_MYSQL取服务器时间, 文本型, , 


.子程序 PHP_MYSQL查询是否存在, 逻辑型, , 
.参数 表名, 文本型, , 
.参数 字段名, 文本型, , 
.参数 条件, 文本型, , 



.子程序 PHP_MYSQL时间处理, 文本型, , 
.参数 处理时间, 日期时间型, , 



.子程序 PHP_MYSQL文本加密, 文本型, , 
.参数 加密文本, 文本型, , 
.参数 密码, 文本型, 可空, 



.子程序 PHP_MYSQL文本解密, 文本型, , 
.参数 解密文本, 文本型, , 
.参数 密码, 文本型, 可空, 




 ' 不属于任何一个程序集、类模块的函数：
