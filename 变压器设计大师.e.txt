 ' 文件类型：Windows窗口程序

 ' 程序名称：变压器设计大师
 ' 程序描述：
 ' 程序作者：赵庆涛
 ' 邮政编码：262718
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：ta0821@163.com
 ' 主页地址：
 ' 版权声明：
 ' 版本号：2.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 799
    高度 = 579
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\变压器设计大师.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “变压器设计大师  V2.0”
    帮助文件名 = “”

窗口 注册窗口
    左边 = 50
    顶边 = 50
    宽度 = 432
    高度 = 296
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\变压器设计大师.e\注册窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “软件注册”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 427
    高度 = 313
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 2
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\变压器设计大师.e\关于窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于  变压器设计大师  V2.0”
    帮助文件名 = “”

窗口 信息窗口
    左边 = 50
    顶边 = 50
    宽度 = 424
    高度 = 285
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 2
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 说明窗口
    左边 = 50
    顶边 = 50
    宽度 = 225
    高度 = 154
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 65535 '  0xFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 2
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “说明”
    帮助文件名 = “”



.图片 降压, " ' 已保存到：D:\易语言学习\Data\变压器设计大师.e\降压", , 
.图片 升压, " ' 已保存到：D:\易语言学习\Data\变压器设计大师.e\升压", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 2 系统核心支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' internet 707ca37322474f6ca841f0e224f4b620 1 0 互联网支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 1 7 扩展界面支持库三




.全局变量 匿名全局变量_899, 空白型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 次, 整数型, , , 
.程序集变量 绕组数, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
载入 (信息窗口, _启动窗口, 真)
赋值 (.内容, 相加 (“    不同的硅钢片，所允许的磁通量不同。通常，”, #换行符, “    冷轧硅钢片 D310 可取12000~14000高斯”, #换行符, “    热轧硅钢片 D41、D42取10000~12000高斯”, #换行符, “              D43 取11000~12000高斯”, #换行符, “    一般电机用热轧硅钢片D21~D22磁通量取5000~7000高斯”, #换行符, “    如果不知道硅钢片的牌号，按经验可以将硅钢片扭一扭，如果硅钢片薄而脆的则磁性能较好（俗称高硅），磁通量可取大些；若硅钢片厚而软的，则次性能较差（俗称低硅），磁通量可取小些。一般磁通量可取在7000~10000高斯之间。”))
赋值 (.内容, 相加 (“    上表列出目前通用的小型硅钢片规格，其中个尺寸之间关系大致如下(如左图)：”, #换行符, “         c=0.5a,h=1.5a(当a>64时h=2.5a)”, #换行符, “             A=3a,H=2.5a,迭厚≤2a ”, #换行符, “    如果所需要的尺寸不符合上表，推荐采用条式拚片。拚片尺寸共有四种，如左图所示。”, #换行符, “    在设计时，经常遇到绕组厚度>c的情况。这时有两种办法，一是加大铁心迭厚，使绕组匝数降低，但是一般迭厚=(1-2)a比较合适，不能任意加厚。另一种办法就是重选硅钢片的尺寸，按原法计算和核算直到合适位置。”))
.如果真 (等于 (注册否 (), 假))
    赋值 (_启动窗口., 相加 (_启动窗口., “    [未注册]”))
    试用操作 ()
.如果真结束
.如果真 (等于 (相加 (取运行目录 (), “\次级.grd”).从文件读 (), 假))
    信息框 (“打开模版失败”, 0, )
.如果真结束
.如果真 (等于 (相加 (取运行目录 (), “\小型变压器通用硅钢片尺寸.grd”).从文件读 (), 假))
    信息框 (“打开模版失败”, 0, )
.如果真结束
.如果真 (等于 (相加 (取运行目录 (), “\设计数据.grd”).从文件读 (), 假))
    信息框 (“打开模版失败”, 0, )
.如果真结束


.子程序 试用操作, 空白型, , 
.局部变量 次数, 整数型, , , 

赋值 (次数, 取数值注册项 (#本地机器, “Software\byqsj\cishu”, 20))
.如果 (等于 (次数, 20))
    写注册项 (#本地机器, “Software\byqsj\cishu”, 0)
.否则
    
.如果结束
赋值 (次数, 取数值注册项 (#本地机器, “Software\byqsj\cishu”, 20))
.如果 (小于 (相减 (10, 次数), 0))
    信息框 (相加 (“已经超过试用次数！”, #换行符, “请注册本软件！”), 相加 (0, 48), )
    载入 (注册窗口, , 真)
    赋值 (.时钟周期, 1000) ' <!!!>
.否则
    信息框 (相加 (“您使用的软件为限次版！”, #换行符, “您还可以继续使用本软件”, 到文本 (相减 (10, 次数)), “次！”), 相加 (0, 64), )
    写注册项 (#本地机器, “Software\byqsj\cishu”, 相加 (次数, 1))
.如果结束


.子程序 计算输出总功率, 空白型, , 
.局部变量 s, 小数型, , , 
.局部变量 功率, 整数型, , , 
.局部变量 k, 小数型, , , 
.局部变量 d, 小数型, , , 

赋值 (s, 到数值 (.内容))
赋值 (s, 相除 (s, 100))
赋值 (功率, 相乘 (s, s))
.计次循环首 (10, )
    .判断开始 (小于 (功率, 10))
        赋值 (k, 2)
    .判断 (并且 (小于 (10, 功率), 小于或等于 (功率, 50)))
        赋值 (k, 1.75)
    .判断 (并且 (小于 (50, 功率), 小于或等于 (功率, 500)))
        赋值 (k, 1.4)
    .判断 (并且 (小于 (500, 功率), 小于或等于 (功率, 1000)))
        赋值 (k, 1.2)
    .判断 (小于 (1000, 功率))
        赋值 (k, 1)
    .默认
        
    .判断结束
    赋值 (d, 相除 (s, k))
    赋值 (功率, 相乘 (d, d))
.计次循环尾 ()
赋值 (.内容, 到文本 (功率))

.子程序 _铁心面积框_内容被改变, 空白型, , 
计算单相伏匝数 ()
计算输出总功率 ()
.判断开始 (等于 (对比功率 (), 假))
    赋值 (.背景颜色, #红色)
    赋值 (.背景颜色, #红色)
.判断 (等于 (对比功率 (), 真))
    赋值 (.背景颜色, #绿色)
    赋值 (.背景颜色, #绿色)
.默认
    
.判断结束


.子程序 _单项磁通量编辑框_内容被改变, 空白型, , 
计算单相伏匝数 ()

.子程序 计算单相伏匝数, 空白型, , 
.局部变量 单项磁通量, 整数型, , , 
.局部变量 铁心面积, 小数型, , , 
.局部变量 结果, 小数型, , , 

赋值 (铁心面积, 相除 (到数值 (.内容), 100))
赋值 (单项磁通量, 到数值 (.内容))
赋值 (结果, 相乘 (4.44, 50, 单项磁通量, 铁心面积, 1e-008))
赋值 (.内容, 到文本 (结果))

.子程序 _编辑框1_内容被改变, 空白型, , 
.如果 (不等于 (.内容, “”))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    _铁心面积框_内容被改变 ()
.否则
    
.如果结束


.子程序 _编辑框2_内容被改变, 空白型, , 
.如果 (不等于 (.内容, “”))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    _铁心面积框_内容被改变 ()
.否则
    
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
.加入项目 (.内容, )

.子程序 _按钮2_被单击, 空白型, , 
.删除项目 (.现行选中项)

.子程序 _按钮4_被单击, 空白型, , 
清空 ()

.子程序 _增加按钮_被单击, 空白型, , 
.局部变量 行号, 整数型, , , 
.局部变量 数值, 整数型, , , 
.局部变量 合并首, 整数型, , , 
.局部变量 合并尾, 整数型, , , 

赋值 (行号, 取行数 ())
赋值 (数值, 1)
.判断循环首 (小于或等于 (数值, 行号))
    .如果 (等于 (.内容, 数值.取文本 (1)))
        赋值 (合并首, 数值)
        .判断循环首 (小于或等于 (数值, 行号))
            .如果 (不等于 (.内容, 数值.取文本 (1)))
                数值.插入行 ()
                赋值 (合并尾, 数值)
                赋值 (数值, 行号)
            .否则
                .如果 (等于 (数值, 行号))
                    .添加行 ()
                    赋值 (合并尾, 相加 (数值, 1))
                .否则
                    
                .如果结束
                
            .如果结束
            赋值 (数值, 相加 (数值, 1))
        .判断循环尾 ()
        合并尾.置文本 (2, .内容)
        合并尾.置文本 (3, .内容)
        合并尾.置文本 (4, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
        合并首.合并 (1, 相加 (相减 (合并尾, 合并首), 1), )
        合并尾.置文本 (1, .内容)
        合并首.置对齐方式 (1, , , #中中)
        行号.置光标 (3)
        跳出循环 ()
    .否则
        .如果 (等于 (数值, 行号))
            .添加行 ()
            相加 (数值, 1).置文本 (1, .内容)
            相加 (数值, 1).置文本 (2, .内容)
            相加 (数值, 1).置文本 (3, .内容)
            相加 (数值, 1).置文本 (4, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
            相加 (数值, 1).置对齐方式 (1, , , #中中)
            相加 (数值, 1).置光标 (3)
            计算绕组数 ()
            赋值 (.内容, 到文本 (绕组数))
        .否则
            
        .如果结束
        
    .如果结束
    赋值 (数值, 相加 (数值, 1))
.判断循环尾 ()
计算所需输出功率 ()
.判断开始 (等于 (对比功率 (), 假))
    赋值 (.背景颜色, #红色)
    赋值 (.背景颜色, #红色)
.判断 (等于 (对比功率 (), 真))
    赋值 (.背景颜色, #绿色)
    赋值 (.背景颜色, #绿色)
.默认
    
.判断结束


.子程序 计算绕组数, 空白型, , 
.局部变量 行数, 整数型, , , 
.局部变量 数值, 整数型, , , 

赋值 (绕组数, 0)
赋值 (行数, 取行数 ())
赋值 (数值, 2)
.如果真 (大于 (数值, 行数))
    返回 ()
.如果真结束
.判断循环首 (小于或等于 (数值, 行数))
    .如果 (数值.是否被合并 (1, 4))
        .判断循环首 (小于 (数值, 行数))
            .如果 (数值.是否被合并 (1, 4))
                
            .否则
                赋值 (绕组数, 相加 (绕组数, 1))
            .如果结束
            赋值 (数值, 相加 (数值, 1))
        .判断循环尾 ()
    .否则
        赋值 (绕组数, 相加 (绕组数, 1))
        赋值 (数值, 相加 (数值, 1))
    .如果结束
    
.判断循环尾 ()



.子程序 _按钮6_被单击, 空白型, , 
.如果 (不等于 (取光标行号 (), 1))
    取光标行号 ().删除行 ()
    取光标行号 ().置对齐方式 (1, , , #中中)
.否则
    
.如果结束
计算所需输出功率 ()
计算绕组数 ()
赋值 (.内容, 到文本 (绕组数))

.子程序 _按钮7_被单击, 空白型, , 
相加 (取运行目录 (), “\次级.grd”).从文件读 ()
计算绕组数 ()
赋值 (.内容, 到文本 (绕组数))

.子程序 计算所需输出功率, 空白型, , 
.局部变量 所需输出功率, 小数型, , , 
.局部变量 行号, 整数型, , , 

赋值 (所需输出功率, 0)
赋值 (行号, 1)
.如果 (等于 (.选中, 真))
    .判断循环首 (小于或等于 (行号, 取行数 ()))
        .如果 (小于 (所需输出功率, 到数值 (行号.取文本 (4))))
            赋值 (所需输出功率, 到数值 (行号.取文本 (4)))
        .否则
            
        .如果结束
        赋值 (行号, 相加 (行号, 1))
    .判断循环尾 ()
.否则
    
.如果结束
.如果 (等于 (.选中, 真))
    .判断循环首 (小于或等于 (行号, 取行数 ()))
        赋值 (所需输出功率, 相加 (所需输出功率, 到数值 (行号.取文本 (4))))
        赋值 (行号, 相加 (行号, 1))
    .判断循环尾 ()
.否则
    
.如果结束
赋值 (.内容, 到文本 (所需输出功率))


.子程序 对比功率, 逻辑型, , 
.如果真 (小于 (到数值 (.内容), 到数值 (.内容)))
    返回 (假)
.如果真结束
返回 (真)


.子程序 _分时工作单选框_被单击, 空白型, , 
计算所需输出功率 ()
.判断开始 (等于 (对比功率 (), 假))
    赋值 (.背景颜色, #红色)
    赋值 (.背景颜色, #红色)
.判断 (等于 (对比功率 (), 真))
    赋值 (.背景颜色, #绿色)
    赋值 (.背景颜色, #绿色)
.默认
    
.判断结束


.子程序 _同时工作单选框_被单击, 空白型, , 
计算所需输出功率 ()
.判断开始 (等于 (对比功率 (), 假))
    赋值 (.背景颜色, #红色)
    赋值 (.背景颜色, #红色)
.判断 (等于 (对比功率 (), 真))
    赋值 (.背景颜色, #绿色)
    赋值 (.背景颜色, #绿色)
.默认
    
.判断结束


.子程序 _图片框2_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.图片, .图片)
赋值 (.可视, 真)

.子程序 _图片框8_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.可视, 假)

.子程序 _图片框5_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.图片, .图片)
赋值 (.可视, 真)

.子程序 _图片框6_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.图片, .图片)
赋值 (.可视, 真)

.子程序 _图片框7_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.图片, .图片)
赋值 (.可视, 真)

.子程序 _时钟1_周期事件, 空白型, , 
.如果 (等于 (.背景颜色, #红色))
    赋值 (.背景颜色, #默认色)
.否则
    赋值 (.背景颜色, #红色)
.如果结束
赋值 (次, 相加 (次, 1))
.如果 (等于 (次, 8))
    赋值 (.时钟周期, 0)
.否则
    
.如果结束


.子程序 _选择夹1_子夹被改变, 空白型, , 
.判断开始 (等于 (.现行子夹, 1))
    赋值 (次, 0)
    赋值 (.时钟周期, 500)
.判断 (等于 (.现行子夹, 3))
    .如果真 (等于 (“常用变压器数据.grd”.从文件读 (), 假))
        信息框 (相加 (“打开”, “‘”, “常用变压器数据”, “’”, “失败”), 0, )
    .如果真结束
    
.判断 (等于 (.现行子夹, 4))
    .如果真 (等于 (“常用圆铝铜线规格.grd”.从文件读 (), 假))
        信息框 (相加 (“打开”, “‘”, “常用圆铝铜线规格”, “’”, “失败”), 0, )
    .如果真结束
    
.判断 (等于 (.现行子夹, 5))
    .如果真 (等于 (“漆包圆线规格.grd”.从文件读 (), 假))
        信息框 (相加 (“打开”, “‘”, “漆包圆线规格”, “’”, “失败”), 0, )
    .如果真结束
    
.默认
    
.判断结束


.子程序 _滑块条1_位置被改变, 空白型, , 
赋值 (.缩放比, .位置)


.子程序 _计算按钮_被单击, 空白型, , 
.判断开始 (等于 (.可视, 真))
    计算单项变压器 ()
.判断 (等于 (.可视, 真))
    计算自藕变压器 ()
.默认
    
.判断结束


.子程序 计算自藕变压器, 空白型, , 
.局部变量 入压, 小数型, , , 
.局部变量 入流, 小数型, , , 
.局部变量 入功, 小数型, , , 
.局部变量 出功, 小数型, , , 
.局部变量 出压, 小数型, , , 
.局部变量 出流, 小数型, , , 
.局部变量 磁通量, 整数型, , , 
.局部变量 面积, 小数型, , , 
.局部变量 导线截面积w1, 小数型, , , 
.局部变量 导线截面积1, 文本型, , , 
.局部变量 导线截面积w2, 小数型, , , 
.局部变量 导线截面积2, 文本型, , , 
.局部变量 电流密度, 小数型, , , 
.局部变量 伏匝数, 小数型, , , 
.局部变量 入匝数, 小数型, , , 
.局部变量 入匝数1, 文本型, , , 
.局部变量 出匝数, 小数型, , , 
.局部变量 出匝数1, 文本型, , , 

.如果 (小于或等于 (到数值 (.内容), 0))
    信息框 (“请输入正确的铁芯面积！”, 相加 (0, 48), “错误！”)
    返回 ()
.否则
    
.如果结束
.如果 (小于或等于 (到数值 (.内容), 0))
    信息框 (“请输入正确的磁通量！”, 相加 (0, 48), “错误！”)
    返回 ()
.否则
    
.如果结束
.如果 (小于或等于 (到数值 (.内容), 0))
    信息框 (“请输入正确的输入电压！”, 相加 (0, 48), “错误！”)
    返回 ()
.否则
    
.如果结束
.如果 (小于或等于 (到数值 (.内容), 0))
    信息框 (“请输入正确的输出电压！”, 相加 (0, 48), “错误！”)
    返回 ()
.否则
    
.如果结束
.如果 (小于或等于 (到数值 (.内容), 0))
    信息框 (“请输入正确的输出电流！”, 相加 (0, 48), “错误！”)
    返回 ()
.否则
    
.如果结束
.如果 (等于 (到数值 (.内容), 到数值 (.内容)))
    信息框 (“输入电压与输出电压相等，就不用做变压器了吧！”, 相加 (0, 48), “错误！”)
    返回 ()
.否则
    
.如果结束
.如果 (大于 (到数值 (.内容), 到数值 (.内容)))
    信息框 (“铁芯最大输出功率小于所需铁芯输出功率不能计算！”, 相加 (0, 48), “错误！”)
    返回 ()
.否则
    
.如果结束
.如果 (等于 (相加 (取运行目录 (), “\设计数据.grd”).从文件读 (), 假))
    信息框 (“打开模版失败”, 0, )
    返回 ()
.否则
    
.如果结束
赋值 (.现行子夹, 2)
赋值 (.位置, 3)
赋值 (入压, 到数值 (.内容))
赋值 (出压, 到数值 (.内容))
赋值 (出流, 到数值 (.内容))
赋值 (出功, 相乘 (出压, 出流))
赋值 (入功, 相除 (出功, 到数值 (.内容)))
赋值 (入流, 相除 (入功, 入压))
赋值 (磁通量, 到数值 (.内容))
赋值 (面积, 相除 (到数值 (.内容), 100))
赋值 (电流密度, 到数值 (.内容))
赋值 (伏匝数, 相乘 (4.44, 50, 磁通量, 面积, 1e-008))
赋值 (入匝数, 相除 (入压, 伏匝数))
赋值 (出匝数, 相除 (出压, 伏匝数))
.判断开始 (小于 (入压, 出压))
    赋值 (导线截面积w1, 相除 (相减 (入流, 出流), 电流密度))
    赋值 (导线截面积w2, 相除 (出流, 电流密度))
.判断 (大于 (入压, 出压))
    赋值 (导线截面积w1, 相除 (相减 (出流, 入流), 电流密度))
    赋值 (导线截面积w2, 相除 (入流, 电流密度))
.默认
    
.判断结束
##################加入设计表############################################
赋值 (导线截面积1, 到文本 (导线截面积w1))
赋值 (导线截面积2, 到文本 (导线截面积w2))
赋值 (入匝数1, 到文本 (入匝数))
赋值 (出匝数1, 到文本 (出匝数))
赋值 (.位置, 6)
.添加行 ()
2.合并 (1, , 2)
2.置文本 (1, “输入”)
2.置文本 (3, 到文本 (入压))
2.置文本 (4, 到文本 (入流))
2.置文本 (5, 入匝数1)
.添加行 ()
3.合并 (1, , 2)
3.置文本 (1, “输出”)
3.置文本 (3, 到文本 (出压))
3.置文本 (4, 到文本 (出流))
3.置文本 (5, 出匝数1)
2.置行高 (2, 80)
2.合并 (6, 2, )
2.置文本 (6, 相加 (“如图所示：”, #换行符, “W1为：”, 导线截面积1, #换行符, “W2为：”, 导线截面积2))
2.置文本 (7, 到文本 (入功))
3.置文本 (7, 到文本 (出功))
2.合并 (9, 2, )
2.合并 (10, 2, )
2.置文本 (9, .内容)
2.置文本 (10, .内容)
2.置对齐方式 (9, , , #中中)
2.置对齐方式 (10, , , #中中)
2.置对齐方式 (1, , , #中中)
3.置对齐方式 (1, , , #中中)
13.添加行 ()
4.合并 (1, 13, 10)
4.置类型 (1, , , 3)
.如果 (小于 (入压, 出压))
    4.置数据 (1, #升压)
.否则
    4.置数据 (1, #降压)
.如果结束
4.置对齐方式 (1, , , #中中)
赋值 (.位置, 10)


.子程序 计算单项变压器, 空白型, , 
.局部变量 入压, 小数型, , "0", 
.局部变量 入流, 小数型, , "0", 
.局部变量 入功, 小数型, , , 
.局部变量 出压, 小数型, , , 
.局部变量 出流, 小数型, , , 
.局部变量 出功, 小数型, , , 
.局部变量 磁通量, 整数型, , , 
.局部变量 面积, 小数型, , , 
.局部变量 入匝数, 整数型, , "0", 
.局部变量 出匝数, 文本型, , , 
.局部变量 出匝, 小数型, , , 
.局部变量 入线径, 小数型, , "0", 
.局部变量 出线径, 小数型, , , 
.局部变量 初级电流密度, 小数型, , , 
.局部变量 次级电流密度, 小数型, , , 
.局部变量 数值1, 整数型, , , 
.局部变量 数值2, 整数型, , , 
.局部变量 合并数, 整数型, , , 
.局部变量 内容, 文本型, , , 
.局部变量 伏匝数, 小数型, , , 
.局部变量 行号, 整数型, , , 
.局部变量 合并首, 整数型, , , 
.局部变量 合并尾, 整数型, , , 
.局部变量 总合并首, 整数型, , , 
.局部变量 总合并尾, 整数型, , , 

.如果真 (不等于 (对比功率 (), 真))
    信息框 (“铁心输出功率小于所需输出功率不能计算。”, 相加 (0, 16), “错误！”)
    返回 ()
.如果真结束
.如果真 (等于 (取项目数 (), 0))
    信息框 (“没有输入初级电压不能计算”, 相加 (0, 16), “错误！”)
    返回 ()
.如果真结束
.如果真 (等于 (取行数 (), 1))
    信息框 (“ 没有输入输出参数不能计算”, 相加 (0, 16), “错误！”)
    返回 ()
.如果真结束

.如果 (等于 (相加 (取运行目录 (), “\设计数据.grd”).从文件读 (), 假))
    信息框 (“打开模版失败”, 0, )
    返回 ()
.否则
    
.如果结束
赋值 (初级电流密度, 到数值 (.内容))
赋值 (次级电流密度, 到数值 (.内容))
初级计算……………………………………………………………………………………………………………………
赋值 (.位置, 1)
计算每匝伏数*********************************************************************************
赋值 (磁通量, 到数值 (.内容))
赋值 (面积, 相除 (到数值 (.内容), 100))
赋值 (伏匝数, 相乘 (4.44, 50, 磁通量, 面积, 1e-008))
获得输入电压电流**********************************************************************************
赋值 (.位置, 2)
赋值 (出功, 到数值 (.内容))
赋值 (入功, 相除 (出功, 到数值 (.内容)))
赋值 (数值1, 0)
.判断循环首 (小于 (数值1, 取项目数 ()))
    加入成员 (入压, 到数值 (数值1.取项目文本 ()))
    赋值 (数值1, 相加 (数值1, 1))
.判断循环尾 ()
赋值 (.位置, 3)
赋值 (数值1, 1)
.判断循环首 (小于或等于 (数值1, 取数组成员数 (入压)))
    加入成员 (入流, 相除 (入功, 入压 [数值1]))
    赋值 (数值1, 相加 (数值1, 1))
.判断循环尾 ()
计算初级绕组匝数********************************************************************************************
赋值 (.位置, 4)
赋值 (数值1, 1)
.判断循环首 (小于或等于 (数值1, 取数组成员数 (入压)))
    加入成员 (入匝数, 相除 (入压 [数值1], 伏匝数))
    赋值 (数值1, 相加 (数值1, 1))
.判断循环尾 ()
计算初级绕组线径*********************************************************************************************
赋值 (.位置, 5)
赋值 (数值1, 1)
.判断循环首 (小于或等于 (数值1, 取数组成员数 (入流)))
    加入成员 (入线径, 求平方根 (相除 (入流 [数值1], 初级电流密度)))
    赋值 (数值1, 相加 (数值1, 1))
.判断循环尾 ()
加入设计表***************************************************************************************
赋值 (.位置, 6)
赋值 (行号, 取行数 ())
赋值 (行号, 相加 (行号, 1))
赋值 (合并首, 行号)
赋值 (数值1, 1)
.判断循环首 (小于或等于 (数值1, 取数组成员数 (入压)))
    .添加行 ()
    行号.置文本 (3, 到文本 (入压 [数值1]))
    行号.置文本 (4, 到文本 (入流 [数值1]))
    行号.置文本 (5, 到文本 (入匝数 [数值1]))
    行号.置文本 (6, 到文本 (入线径 [数值1]))
    赋值 (行号, 相加 (行号, 1))
    赋值 (数值1, 相加 (数值1, 1))
.判断循环尾 ()
赋值 (.位置, 7)
赋值 (合并尾, 相减 (行号, 1))
合并首.合并 (1, 相加 (相减 (合并尾, 合并首), 1), 2)
合并首.合并 (7, 相加 (相减 (合并尾, 合并首), 1), 1)
合并首.合并 (8, 相加 (相减 (合并尾, 合并首), 1), 1)
合并首.置文本 (1, “初级绕组”)
合并首.置文本 (7, 到文本 (入功))
合并首.置对齐方式 (1, , , #中中)
合并首.置对齐方式 (7, , , #中中)
加入次级**************************************************************************************************
赋值 (.位置, 8)
赋值 (行号, 取行数 ())

赋值 (总合并首, 相加 (行号, 1))
赋值 (数值1, 2)
赋值 (数值2, 1)
赋值 (内容, 数值1.取文本 (1))
赋值 (合并首, 相加 (行号, 1))
赋值 (出流, 0)
.判断循环首 (小于或等于 (数值1, 取行数 ()))
    赋值 (出压, 到数值 (数值1.取文本 (2)))
    .如果 (等于 (.选中, 真))
        .如果 (不等于 (内容, 数值1.取文本 (1)))
            .如果 (等于 (数值1, 取行数 ()))
                赋值 (出流, 到数值 (数值1.取文本 (3)))
            .否则
                
            .如果结束
            
            
        .否则
            .如果 (等于 (数值1, 取行数 ()))
                赋值 (出流, 相加 (出流, 到数值 (数值1.取文本 (3))))
            .否则
                赋值 (出流, 相加 (出流, 到数值 (数值1.取文本 (3))))
            .如果结束
            
        .如果结束
        
    .否则
        赋值 (出流, 到数值 (数值1.取文本 (3)))
        
    .如果结束
    ****************************************************************************
    .判断开始 (等于 (.现行选中项, 0))
        
        赋值 (出匝, 四舍五入 (相除 (出压, 伏匝数), 0))
        赋值 (出匝数, 相加 (到文本 (相加 (出匝, 相乘 (出匝, 0.05))), “(”, 到文本 (出匝), “+”, 到文本 (相乘 (出匝, 0.05)), “)”))
    .判断 (等于 (.现行选中项, 1))
        赋值 (出压, 相加 (相乘 (出压, 2), 到数值 (.内容)))
        赋值 (出匝, 四舍五入 (相除 (出压, 伏匝数), 0))
        赋值 (出匝数, 相加 (到文本 (相加 (出匝, 相乘 (出匝, 0.05))), “(”, 到文本 (出匝), “+”, 到文本 (相乘 (出匝, 0.05)), “)”))
    .判断 (等于 (.现行选中项, 2))
        赋值 (出压, 相加 (出压, 到数值 (.内容)))
        赋值 (出匝, 四舍五入 (相除 (出压, 伏匝数), 0))
        赋值 (出匝数, 相加 (到文本 (相乘 (相加 (出匝, 相乘 (出匝, 0.05)), 2)), “(”, “(”, 到文本 (出匝), “+”, 到文本 (相乘 (出匝, 0.05)), “)”, “X2”, “)”))
    .判断 (等于 (.现行选中项, 3))
        赋值 (出压, 相加 (出压, 相乘 (到数值 (.内容), 2)))
        赋值 (出匝, 四舍五入 (相除 (出压, 伏匝数), 0))
        赋值 (出匝数, 相加 (到文本 (相加 (出匝, 相乘 (出匝, 0.05))), “(”, 到文本 (出匝), “+”, 到文本 (相乘 (出匝, 0.05)), “)”))
    .默认
        
    .判断结束
    赋值 (出线径, 相除 (出流, 次级电流密度))
    .添加行 ()
    赋值 (行号, 相加 (行号, 1))
    行号.置文本 (3, 到文本 (出压))
    行号.置文本 (4, 数值1.取文本 (3))
    行号.置文本 (5, 到文本 (出匝数))
    行号.置文本 (6, 到文本 (出线径))
    .如果 (不等于 (内容, 数值1.取文本 (1)))
        .如果 (等于 (数值1, 取行数 ()))
            赋值 (合并尾, 相减 (行号, 1))
            合并首.合并 (2, 相加 (相减 (合并尾, 合并首), 1), )
            合并首.置文本 (2, 相加 (“绕组”, 到文本 (数值2)))
            合并首.置对齐方式 (2, , , #中中)
            .如果 (等于 (.选中, 真))
                合并首.合并 (6, 相加 (相减 (合并尾, 合并首), 1), )
                合并首.置文本 (6, 到文本 (出线径))
                行号.置对齐方式 (6, , , #中中)
                合并首.置对齐方式 (6, , , #中中)
            .否则
                
            .如果结束
            赋值 (内容, 数值1.取文本 (1))
            行号.置文本 (2, 相加 (“绕组”, 到文本 (相加 (数值2, 1))))
            行号.置对齐方式 (2, , , #中中)
            
        .否则
            赋值 (出流, 到数值 (数值1.取文本 (3)))
            赋值 (合并尾, 相减 (行号, 1))
            合并首.合并 (2, 相加 (相减 (合并尾, 合并首), 1), )
            合并首.置文本 (2, 相加 (“绕组”, 到文本 (数值2)))
            合并首.置对齐方式 (2, , , #中中)
            .如果 (等于 (.选中, 真))
                合并首.合并 (6, 相加 (相减 (合并尾, 合并首), 1), )
                合并首.置文本 (6, 到文本 (出线径))
                合并首.置对齐方式 (6, , , #中中)
            .否则
                
            .如果结束
            赋值 (内容, 数值1.取文本 (1))
            赋值 (合并首, 行号)
            赋值 (数值2, 相加 (数值2, 1))
        .如果结束
        
        
    .否则
        .如果 (等于 (数值1, 取行数 ()))
            赋值 (合并尾, 行号)
            合并首.合并 (2, 相加 (相减 (合并尾, 合并首), 1), )
            合并首.置文本 (2, 相加 (“绕组”, 到文本 (数值2)))
            合并首.置对齐方式 (2, , , #中中)
            .如果 (等于 (.选中, 真))
                合并首.合并 (6, 相加 (相减 (合并尾, 合并首), 1), )
                合并首.置文本 (6, 到文本 (出线径))
                合并首.置对齐方式 (6, , , #中中)
            .否则
                
            .如果结束
            
        .否则
            
        .如果结束
        
    .如果结束
    赋值 (数值1, 相加 (数值1, 1))
.判断循环尾 ()
赋值 (.位置, 9)
赋值 (总合并尾, 行号)
计算绕组数 ()
.如果 (等于 (绕组数, 1))
    总合并首.合并 (1, 相加 (相减 (总合并尾, 总合并首), 1), 2)
    总合并首.置文本 (1, “次级绕组”)
    总合并首.置对齐方式 (1, , , #中中)
.否则
    总合并首.合并 (1, 相加 (相减 (总合并尾, 总合并首), 1), )
    总合并首.置文本 (1, “次级绕组”)
    总合并首.置对齐方式 (1, , , #中中)
    
.如果结束
总合并首.合并 (7, 相加 (相减 (总合并尾, 总合并首), 1), )
总合并首.置文本 (7, .内容)
总合并首.置对齐方式 (7, , , #中中)
.如果 (等于 (.选中, 真))
    赋值 (内容, “分时工作”)
.否则
    赋值 (内容, “同时工作”)
.如果结束
.如果 (等于 (.现行选中项, 0))
    赋值 (内容, 相加 (内容, #换行符, “无整流”))
.否则
    赋值 (内容, 相加 (内容, #换行符, .取项目文本 (.现行选中项)))
.如果结束

总合并首.合并 (8, 相加 (相减 (总合并尾, 总合并首), 1), )
总合并首.置对齐方式 (8, , , #中中)
总合并首.置文本 (8, 内容)
2.合并 (9, 相减 (总合并尾, 1), )
2.合并 (10, 相减 (总合并尾, 1), )
2.置文本 (9, .内容)
2.置文本 (10, .内容)
2.置对齐方式 (9, , , #中中)
2.置对齐方式 (10, , , #中中)


赋值 (.现行子夹, 2)
赋值 (.位置, 10)


.子程序 _整流方式组合框_列表项被选择, 空白型, , 
.如果 (等于 (.现行选中项, 0))
    赋值 (.边框, 0)
    赋值 (.背景颜色, #默认色)
    赋值 (.输入方式, 1)
    赋值 (.内容, “0”)
.否则
    赋值 (.输入方式, 9)
    赋值 (.边框, 5)
    赋值 (.背景颜色, #白色)
.如果结束


.子程序 _按钮8_被单击, 空白型, , 
打印设置 ()

.子程序 _按钮9_被单击, 空白型, , 
打印预览 ()

.子程序 _按钮10_被单击, 空白型, , 
.打印 ()

.子程序 注册否, 逻辑型, 公开, 
.局部变量 注册码, 文本型, , , 
.局部变量 特征码, 文本型, , , 
.局部变量 硬盘字, 整数型, , , 

赋值 (注册码, 读配置项 (相加 (取运行目录 (), “\peizhi.ini”), “zhuce”, “注册”, ))
赋值 (硬盘字, 相乘 (取硬盘特征字 (), 0.123456789))
赋值 (特征码, 相加 (取十六进制文本 (位与 (位取反 (硬盘字), 13953640821)), “-”, 取十六进制文本 (位异或 (硬盘字, 13953640821)), “-”, 取十六进制文本 (位或 (硬盘字, 13953640821))))

.如果真 (等于 (特征码, 注册码))
    返回 (真)
.如果真结束
返回 (假)

.子程序 _单相变压器_被选择, 空白型, , 
赋值 (., 0)
赋值 (., 0)
_卷帘式菜单1_项目被选择 (0, 0)

.子程序 _退出_被选择, 空白型, , 
销毁 ()

.子程序 _铁心规格图_被选择, 空白型, , 
赋值 (.现行子夹, 0)

.子程序 _绕组原理图_被选择, 空白型, , 
赋值 (.现行子夹, 1)

.子程序 _变压器设计数据_被选择, 空白型, , 
赋值 (.现行子夹, 2)

.子程序 _常用变压器数据_被选择, 空白型, , 
赋值 (.现行子夹, 3)
_选择夹1_子夹被改变 ()

.子程序 _常用圆铝铜线规格_被选择, 空白型, , 
赋值 (.现行子夹, 4)
_选择夹1_子夹被改变 ()

.子程序 _常用漆包线规格_被选择, 空白型, , 
赋值 (.现行子夹, 5)
_选择夹1_子夹被改变 ()

.子程序 _注册_被选择, 空白型, , 
载入 (注册窗口, _启动窗口, 真)

.子程序 _关于_被选择, 空白型, , 
载入 (关于窗口, _启动窗口, 真)

.子程序 _帮助主题_被选择, 空白型, , 
.如果真 (等于 (运行 (相加 (“hh ”, 字符 (34), 取运行目录 (), “\Help.chm”, 字符 (34)), 假, ), 假))
    信息框 (“没有找到帮助文件！”, 0, )
.如果真结束


.子程序 _滑块条2_位置被改变, 空白型, , 
赋值 (.缩放比, .位置)

.子程序 _滑块条3_位置被改变, 空白型, , 
赋值 (.缩放比, .位置)

.子程序 _滑块条4_位置被改变, 空白型, , 
赋值 (.缩放比, .位置)

.子程序 _滑块条5_位置被改变, 空白型, , 
赋值 (.缩放比, .位置)

.子程序 _分隔条1_被拖动, 空白型, , 
.参数 原位置, 整数型, , 
.参数 目的位置, 整数型, , 

.如果 (小于 (目的位置, 80))
    赋值 (目的位置, 80)
.否则
    
.如果结束
赋值 (., 目的位置)
赋值 (., 相减 (目的位置, 6))
赋值 (., 5)
赋值 (.左边, 相加 (目的位置, 4))
赋值 (.宽度, 相减 (.左边, 4, .左边))
赋值 (.左边, 相除 (相减 (.宽度, .宽度), 2))
赋值 (.左边, 相除 (相减 (.宽度, .宽度), 2))
赋值 (.左边, 相除 (相减 (.宽度, .宽度), 2))

.子程序 __启动窗口_尺寸被改变, 空白型, , 
.如果 (小于 (_启动窗口., 790))
    赋值 (_启动窗口., 790)
.否则
    
.如果结束
.如果 (小于 (_启动窗口., 550))
    赋值 (_启动窗口., 550)
.否则
    
.如果结束
赋值 (.左边, 相减 (_启动窗口., 154))
赋值 (.宽度, 相减 (.左边, 4, .左边))
赋值 (., _启动窗口.)
_分隔条2_被拖动 (., .)
_分隔条1_被拖动 (., .)

.子程序 _分隔条2_被拖动, 空白型, , 
.参数 原位置, 整数型, , 
.参数 目的位置, 整数型, , 

.如果 (小于 (目的位置, 272))
    赋值 (目的位置, 272)
.否则
    
.如果结束
赋值 (., 目的位置)
赋值 (., 相减 (目的位置, .))
赋值 (., 相减 (目的位置, .))
赋值 (.高度, 相减 (目的位置, .顶边))
赋值 (.高度, 相减 (目的位置, .顶边))
赋值 (.顶边, 相加 (目的位置, 4))
赋值 (.高度, 相减 (., .顶边))
赋值 (.宽度, 相减 (_启动窗口., 15))
赋值 (.左边, 3)
赋值 (.左边, 相减 (_启动窗口., 180))
赋值 (.顶边, 相加 (目的位置, 6))
赋值 (.左边, 相减 (.左边, 60))
赋值 (.顶边, .顶边)
##################################################
赋值 (.顶边, 相减 (.高度, 101))
赋值 (.顶边, 相减 (.高度, 88))
赋值 (.顶边, 相减 (.高度, 64))
赋值 (.顶边, 相减 (.高度, 48))
赋值 (.顶边, .顶边)
赋值 (.顶边, 相减 (.高度, 32))
赋值 (.顶边, 相除 (相减 (.高度, .高度), 2))
赋值 (.顶边, 相除 (相减 (.高度, .高度), 2))
赋值 (.顶边, 相除 (相减 (.高度, .高度), 2))
调整选择夹 ()

.子程序 调整选择夹, 空白型, , 
赋值 (.宽度, 相减 (相除 (.宽度, 2), 11))
赋值 (.左边, 相加 (相除 (.宽度, 2), 2))
赋值 (.宽度, 相减 (相除 (.宽度, 2), 14))
赋值 (.左边, .左边)
赋值 (.左边, .左边)
赋值 (.宽度, .宽度)
赋值 (.左边, .左边)
赋值 (.宽度, 相减 (相除 (.宽度, 2), 2))
赋值 (.左边, 相加 (.宽度, 9, 4))
赋值 (.宽度, 相减 (相除 (.宽度, 2), 2))
赋值 (.左边, .左边)
赋值 (.左边, .左边)
赋值 (.顶边, 40)
赋值 (.高度, 相减 (相除 (相减 (.高度, 46), 2), 9))
赋值 (.顶边, 相加 (.顶边, .高度, 18))
赋值 (.高度, .高度)
赋值 (.顶边, .顶边)
赋值 (.高度, .高度)
赋值 (.顶边, 相减 (.顶边, 17))
赋值 (.顶边, .顶边)
赋值 (.顶边, 40)
赋值 (.高度, 相减 (.高度, 52, 73))
赋值 (.顶边, 相加 (.高度, 6, 40))
赋值 (.左边, 相减 (.宽度, 100))
赋值 (.左边, 相减 (.左边, 60))
#######################绕组原理页调整################################################
赋值 (.顶边, 19)
赋值 (.左边, 1)
赋值 (.宽度, 相减 (.宽度, 4))
赋值 (.高度, 相减 (.高度, 20))
赋值 (.顶边, 18)
赋值 (.高度, 相减 (.高度, 26))
赋值 (.顶边, 18)
赋值 (.顶边, 18)
赋值 (.顶边, 18)
连续赋值 (.高度, .高度, .高度, .高度)
赋值 (.左边, 26)
赋值 (.宽度, 相乘 (相除 (相减 (.宽度, 56), 735), 270))
赋值 (.宽度, 相乘 (相除 (相减 (.宽度, 56), 735), 145))
赋值 (.宽度, .宽度)
赋值 (.宽度, 相乘 (相除 (相减 (.宽度, 56), 735), 175))
赋值 (.左边, 相加 (.左边, .宽度, 8))
赋值 (.左边, 相加 (.左边, .宽度, 8))
赋值 (.左边, 相加 (.左边, .宽度, 8))
赋值 (.左边, .左边)
赋值 (.左边, .左边)
赋值 (.左边, .左边)
赋值 (.左边, .左边)
赋值 (.左边, 相减 (相加 (.左边, .宽度), 90))
赋值 (.左边, .左边)
赋值 (.顶边, 0)
赋值 (.高度, .高度)
赋值 (.宽度, 相减 (.宽度, 26))
赋值 (.左边, 31)
赋值 (.顶边, 21)
赋值 (.宽度, 相除 (相减 (.宽度, 55), 2))
赋值 (.宽度, .宽度)
赋值 (.左边, 相加 (.左边, .宽度, 8))
赋值 (.顶边, .顶边)
赋值 (.高度, 相减 (.高度, 29))
赋值 (.高度, .高度)
赋值 (.左边, .左边)



############################################################################################################
赋值 (.左边, 8)
赋值 (.顶边, 24)
赋值 (.高度, 相减 (.高度, 32))
赋值 (.宽度, 相减 (.宽度, 144))
赋值 (.左边, 相减 (.宽度, 125))
连续赋值 (.左边, .左边, .左边, .左边)
#############################################################################
赋值 (.左边, 8)
赋值 (.顶边, 24)
赋值 (.高度, 相减 (.高度, 32))
赋值 (.宽度, 相减 (.宽度, 144))
赋值 (.左边, 相减 (.宽度, 125))
############################################################################
赋值 (.左边, 8)
赋值 (.顶边, 24)
赋值 (.高度, 相减 (.高度, 32))
赋值 (.宽度, 相减 (.宽度, 144))
赋值 (.左边, 相减 (.宽度, 125))
######################################################################################
赋值 (.左边, 8)
赋值 (.顶边, 24)
赋值 (.高度, 相减 (.高度, 32))
赋值 (.宽度, 相减 (.宽度, 144))
赋值 (.左边, 相减 (.宽度, 125))



.子程序 _卷帘式菜单1_项目被选择, 空白型, , 
.参数 菜单索引, 整数型, , 
.参数 项目索引, 整数型, , 

.如果 (等于 (菜单索引, 0))
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
.如果结束
.如果 (并且 (等于 (菜单索引, 0), 等于 (项目索引, 0)))
    1.置文本 (“单相变压器”)
    赋值 (.标题, “单相变压器设计参数输入”)
    赋值 (.内容, “0.9”)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.可视, 真)
.否则
    赋值 (.可视, 假)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.如果结束
.如果 (并且 (等于 (菜单索引, 0), 等于 (项目索引, 1)))
    1.置文本 (“自藕变压器”)
    赋值 (.标题, “自藕变压器设计参数输入”)
    赋值 (.内容, “0.99”)
    赋值 (.可视, 真)
    赋值 (.内容, “”)
    赋值 (.禁止, 真)
.否则
    赋值 (.可视, 假)
    赋值 (.内容, “2.5”)
    赋值 (.禁止, 假)
.如果结束




.如果 (并且 (等于 (菜单索引, 1), 等于 (项目索引, 0)))
    1.置文本 (“绕组铜重计算”)
    赋值 (.标题, “绕组铜重计算”)
    赋值 (.可视, 真)
.否则
    赋值 (.可视, 假)
.如果结束


.子程序 _自面积编辑框_内容被改变, 空白型, , 
计算自藕最大输出功率 ()
计算自藕伏匝数 ()

.子程序 计算自藕伏匝数, 空白型, , 
.局部变量 自磁通量, 整数型, , , 
.局部变量 自面积, 小数型, , , 
.局部变量 结果, 小数型, , , 

赋值 (自面积, 相除 (到数值 (.内容), 100))
赋值 (自磁通量, 到数值 (.内容))
赋值 (结果, 相乘 (4.44, 50, 自磁通量, 自面积, 1e-008))
赋值 (.内容, 到文本 (结果))

.子程序 计算自藕最大输出功率, 空白型, , 
.局部变量 自面积, 小数型, , , 
.局部变量 功率, 整数型, , , 
.局部变量 小数值1, 小数型, , , 
.局部变量 小数值2, 小数型, , , 

赋值 (自面积, 到数值 (.内容))
赋值 (自面积, 相除 (自面积, 100))
赋值 (功率, 相乘 (自面积, 自面积))
.计次循环首 (10, )
    .判断开始 (小于 (功率, 10))
        赋值 (小数值2, 2)
    .判断 (并且 (小于 (10, 功率), 小于或等于 (功率, 50)))
        赋值 (小数值2, 1.75)
    .判断 (并且 (小于 (50, 功率), 小于或等于 (功率, 500)))
        赋值 (小数值2, 1.4)
    .判断 (并且 (小于 (500, 功率), 小于或等于 (功率, 1000)))
        赋值 (小数值2, 1.2)
    .判断 (小于 (1000, 功率))
        赋值 (小数值2, 1)
    .默认
        
    .判断结束
    赋值 (小数值1, 相除 (自面积, 小数值2))
    赋值 (功率, 相乘 (小数值1, 小数值1))
.计次循环尾 ()
赋值 (.内容, 到文本 (功率))
对比自藕功率 ()

.子程序 计算自藕所需输出功率, 空白型, , 
.局部变量 自输入电压, 小数型, , , 
.局部变量 自输出电压, 小数型, , , 
.局部变量 数值1, 小数型, , , 
.局部变量 数值2, 小数型, , , 
.局部变量 数值3, 小数型, , , 

赋值 (自输入电压, 到数值 (.内容))
赋值 (自输出电压, 到数值 (.内容))
赋值 (数值2, 到数值 (.内容))
.判断开始 (大于 (自输入电压, 自输出电压))
    赋值 (数值1, 相除 (相减 (自输入电压, 自输出电压), 自输入电压))
.判断 (大于 (自输出电压, 自输入电压))
    赋值 (数值1, 相除 (相减 (自输出电压, 自输入电压), 自输出电压))
.默认
    
.判断结束
赋值 (数值3, 相乘 (自输出电压, 数值2))
赋值 (.内容, 到文本 (相乘 (数值3, 数值1)))
对比自藕功率 ()

.子程序 对比自藕功率, 空白型, , 
.如果 (小于 (到数值 (.内容), 到数值 (.内容)))
    赋值 (.背景颜色, #红色)
    赋值 (.背景颜色, #红色)
.否则
    赋值 (.背景颜色, #绿色)
    赋值 (.背景颜色, #绿色)
.如果结束


.子程序 _自输入电压编辑框_内容被改变, 空白型, , 
计算自藕所需输出功率 ()

.子程序 _自输出电压编辑框_内容被改变, 空白型, , 
计算自藕所需输出功率 ()


.子程序 _自输出电流编辑框_内容被改变, 空白型, , 
计算自藕所需输出功率 ()


.子程序 _自磁通量编辑框_内容被改变, 空白型, , 
计算自藕伏匝数 ()

.子程序 _超级按钮2_被单击, 空白型, , 
载入 (说明窗口, _启动窗口, 假)
赋值 (说明窗口., 相减 (取鼠标水平位置 (), 说明窗口.))
赋值 (说明窗口., 取鼠标垂直位置 ())
赋值 (说明窗口..内容, “  变压器持续工作时电流密度一般选用2至3安/平方毫米，短时工作时可以取4至5安/平方毫米。”)

.子程序 _超级按钮1_被单击, 空白型, , 
载入 (说明窗口, _启动窗口, 假)
赋值 (说明窗口., 相减 (取鼠标水平位置 (), 说明窗口.))
赋值 (说明窗口., 取鼠标垂直位置 ())
赋值 (说明窗口..内容, 相加 (“   变压器负载时，由于绕组发热损耗和铁芯损耗，输入功率中有一部分被损耗掉，因此有一个损耗系数。”, #换行符, “   对于功率为1千瓦以下的单相变压器损耗系数为0.8至0.9。自藕变压器可以选的大一些。”, #换行符, “注意：计算自藕变压器尤其在变压比接近于1时如选的过小，计算的导线截面积可能为负数。”))


.子程序 _超级按钮3_被单击, 空白型, , 
载入 (说明窗口, _启动窗口, 假)
赋值 (说明窗口., 相减 (取鼠标水平位置 (), 说明窗口.))
赋值 (说明窗口., 取鼠标垂直位置 ())
赋值 (说明窗口..内容, “   由于未考虑引出线及导线绝缘层的重量，所以在实际使用时一般还要增加5%至10%的重量。”)


.子程序 _直径编辑框_内容被改变, 空白型, , 
赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))

.子程序 _按钮3_被单击, 空白型, , 
.局部变量 导线面积, 小数型, , , 
.局部变量 匝长, 小数型, , , 
.局部变量 匝数, 小数型, , , 
.局部变量 增加, 小数型, , , 
.局部变量 数值, 小数型, , , 

赋值 (导线面积, 相除 (到数值 (.内容), 100))
赋值 (匝长, 相除 (到数值 (.内容), 10))
赋值 (匝数, 到数值 (.内容))
赋值 (增加, 相除 (到数值 (.内容), 100))
赋值 (数值, 相乘 (8.9, 匝长, 导线面积, 匝数, 0.001))
赋值 (.内容, 到文本 (相加 (数值, 相乘 (数值, 增加))))

.子程序 _自耦变压器_被选择, 空白型, , 
赋值 (., 0)
赋值 (., 1)
_卷帘式菜单1_项目被选择 (0, 1)

.子程序 _绕组铜重计算_被选择, 空白型, , 
赋值 (., 1)
赋值 (., 0)
_卷帘式菜单1_项目被选择 (1, 0)


.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.判断开始 (等于 (按钮索引, 0))
    _单相变压器_被选择 ()
.判断 (等于 (按钮索引, 1))
    _自耦变压器_被选择 ()
.判断 (等于 (按钮索引, 3))
    _绕组铜重计算_被选择 ()
.判断 (等于 (按钮索引, 5))
    _帮助主题_被选择 ()
.判断 (等于 (按钮索引, 6))
    _退出_被选择 ()
.默认
    
.判断结束


.子程序 _分隔条3_被拖动, 空白型, , 
.参数 原位置, 整数型, , 
.参数 目的位置, 整数型, , 

.如果 (小于 (目的位置, 1))
    赋值 (目的位置, 2)
.否则
    
.如果结束
赋值 (., 相加 (目的位置, 4))
赋值 (., 目的位置)

.子程序 _关闭时钟_周期事件, 空白型, , 
销毁 ()


.窗口程序集 窗口程序集2, , , 

.子程序 _时钟1_周期事件, 空白型, , 
赋值 (.位置, 相加 (.位置, 1))
.如果 (等于 (.位置, 100))
    销毁 ()
.否则
    
.如果结束


.子程序 _信息窗口_创建完毕, 空白型, , 
.如果 (等于 (注册否 (), 真))
    赋值 (.内容, 相加 (“软件注册给  ”, 读配置项 (相加 (取运行目录 (), “\peizhi.ini”), “zhuce”, “姓名”, )))
.否则
    赋值 (.内容, “软件未注册”)
.如果结束


.子程序 _标签2_反馈事件, 整数型, , 
.参数 参数一, 整数型, , 
.参数 参数二, 整数型, , 



.窗口程序集 窗口程序集3, , , 

.子程序 _确定超级按钮_被单击, 空白型, , 
销毁 ()

.子程序 _关于窗口_创建完毕, 空白型, , 
.如果 (等于 (注册否 (), 真))
    赋值 (.内容, 相加 (“软件注册给  ”, 读配置项 (相加 (取运行目录 (), “\peizhi.ini”), “zhuce”, “姓名”, )))
.否则
    赋值 (.内容, “软件未注册”)
.如果结束


.窗口程序集 窗口程序集4, , , 

.程序集变量 注册信息, 文本型, , "7", 
.子程序 _注册窗口_创建完毕, 空白型, , 
.如果 (等于 (注册否 (), 假))
    赋值 (.内容, 到文本 (相乘 (取硬盘特征字 (), 0.123456789)))
    赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\peizhi.ini”), “zhuce”, “姓名”, ))
    赋值 (.现行选中项, 到数值 (读配置项 (相加 (取运行目录 (), “\peizhi.ini”), “zhuce”, “类型”, )))
    赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\peizhi.ini”), “zhuce”, “邮件”, ))
    赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\peizhi.ini”), “zhuce”, “邮编”, ))
    赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\peizhi.ini”), “zhuce”, “电话”, ))
    赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\peizhi.ini”), “zhuce”, “传真”, ))
    赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\peizhi.ini”), “zhuce”, “地址”, ))
    赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\peizhi.ini”), “zhuce”, “注册”, ))
    
.否则
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.标题, “确定”)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    
    
.如果结束


.子程序 _注册窗口_将被销毁, 空白型, , 
.如果 (等于 (注册否 (), 假))
    写配置项 (相加 (取运行目录 (), “\peizhi.ini”), “zhuce”, “姓名”, .内容)
    写配置项 (相加 (取运行目录 (), “\peizhi.ini”), “zhuce”, “类型”, 到文本 (.现行选中项))
    写配置项 (相加 (取运行目录 (), “\peizhi.ini”), “zhuce”, “邮件”, .内容)
    
    写配置项 (相加 (取运行目录 (), “\peizhi.ini”), “zhuce”, “邮编”, .内容)
    写配置项 (相加 (取运行目录 (), “\peizhi.ini”), “zhuce”, “电话”, .内容)
    写配置项 (相加 (取运行目录 (), “\peizhi.ini”), “zhuce”, “传真”, .内容)
    写配置项 (相加 (取运行目录 (), “\peizhi.ini”), “zhuce”, “地址”, .内容)
    写配置项 (相加 (取运行目录 (), “\peizhi.ini”), “zhuce”, “注册”, .内容)
.否则
    
.如果结束


.子程序 _注册按钮_被单击, 空白型, , 
.如果真 (等于 (.标题, “注册”))
    写配置项 (相加 (取运行目录 (), “\peizhi.ini”), “zhuce”, “注册”, .内容)
    信息框 (“请重新启动本软件，谢谢您的使用！”, 0, “注册”)
.如果真结束
注册窗口.销毁 ()

.子程序 _复制按钮_被单击, 空白型, , 
置剪辑板文本 (相加 (“注册软件：变压器设计大师2.0版”, #换行符, “硬件代码:”, .内容, #换行符, “注册类型:”, .取项目文本 (.现行选中项), #换行符, “姓名:”, .内容, #换行符, “电子邮件:”, .内容, #换行符, “邮编:”, .内容, #换行符, “电话:”, .内容, #换行符, “传真:”, .内容, #换行符, “地址:”, .内容, #换行符, “备注:”, .内容))

.子程序 _发送邮件按钮_被单击, 空白型, , 
.如果真 (等于 (未知支持库函数_0 (“smtp.163.com”, , “yunxiaolangzi”, “5436856”, ), 假))
    信息框 (“连接发信服务器失败，请检查网络。”, 0, )
    返回 ()
.如果真结束
未知支持库函数_5 (“变压器设计大师 V2.0版注册”, 相加 (“注册软件：变压器设计大师2.0版”, #换行符, “硬件代码:”, .内容, #换行符, “注册类型:”, .取项目文本 (.现行选中项), #换行符, “姓名:”, .内容, #换行符, “电子邮件:”, .内容, #换行符, “邮编:”, .内容, #换行符, “电话:”, .内容, #换行符, “传真:”, .内容, #换行符, “地址:”, .内容, #换行符, “备注:”, .内容), “ta0821@163.com”, , , 相加 (.内容, “<yunxiaolangzi@163.com>”), .内容)
未知支持库函数_1 ()
信息框 (“邮件已发送，我们将尽快恢复您，谢谢您注册！”, 0, )

.窗口程序集 窗口程序集5, , , 

.子程序 _确定按钮_被单击, 空白型, , 
销毁 ()

.子程序 _编辑框1_内容被改变, 空白型, , 



 ' 不属于任何一个程序集、类模块的函数：
