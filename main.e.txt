 ' 文件类型：Windows窗口程序

 ' 程序名称：通达小型物流公司信息系统
 ' 程序描述：    本软件由炎之翼设计制作，版权所有，任何个人或团体对本软件进行反编译、破解活动，作者将保留对其进行法律追究的权力。
    本程序将参加大连大有吴涛易语言公司举办的2005年易程序大赛，赛后将向互联网发布测试版收集行业建议，修改完善后推出商用版.
 ' 程序作者：姚文平
 ' 邮政编码：431700
 ' 联系地址：湖北省天门市城关镇西湖堤居委会市白酒厂门市部
 ' 联系电话：07285229115
 ' 传真号码：
 ' 电子信箱：firefoxywp@163.com
 ' 主页地址：
 ' 版权声明：QQ号:17244755
 ' 版本号：1.0
 ' 创建号：0.0

窗口 主窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\main.e\主窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “通达小型物流公司信息系统  测试版”
    帮助文件名 = “”

窗口 _启动窗口
    左边 = 50
    顶边 = 50
    宽度 = 320
    高度 = 170
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “用户登陆”
    帮助文件名 = “”

窗口 系统菜单窗口
    左边 = 50
    顶边 = 50
    宽度 = 512
    高度 = 396
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 受理菜单窗口
    左边 = 50
    顶边 = 50
    宽度 = 620
    高度 = 453
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假

窗口 查询菜单窗口
    左边 = 50
    顶边 = 50
    宽度 = 798
    高度 = 590
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 检货处菜单窗口
    左边 = 50
    顶边 = 50
    宽度 = 513
    高度 = 394
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假

窗口 仓库菜单窗口
    左边 = 50
    顶边 = 50
    宽度 = 572
    高度 = 442
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “外地入埠货物管理”
    帮助文件名 = “”

窗口 调度菜单窗口
    左边 = 50
    顶边 = 50
    宽度 = 614
    高度 = 490
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假

窗口 市场部菜单窗口
    左边 = 50
    顶边 = 50
    宽度 = 521
    高度 = 389
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假

窗口 经理信箱窗口
    左边 = 50
    顶边 = 50
    宽度 = 609
    高度 = 418
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “帮助--程序功能使用动态演示”
    帮助文件名 = “”

窗口 人资后勤菜单窗口
    左边 = 50
    顶边 = 50
    宽度 = 451
    高度 = 215
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “电器设备管理”
    帮助文件名 = “”



.图片 登陆窗口外形, " ' 已保存到：D:\易语言学习\Data\main.e\登陆窗口外形", , 
.图片 背景图片_朴素, " ' 已保存到：D:\易语言学习\Data\main.e\背景图片_朴素", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 3 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 1 XP风格界面库
 ' ExtMenu 9909FBB013704cfa8FE7E739DB7172DE 1 5 超级菜单支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 1 1 高级表格支持库
 ' eDB 46E94341933A462383A4DE26B146322C 1 3 数据库操作支持库
 ' eCompress 7B68736E818E41c5A28B0AE4D43C128C 1 0 压缩解压支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 0 应用接口支持库
 ' eExcel2000 F86EC5989E044d42BC98C692C0B54727 1 0 EXCEL2000支持库
 ' eWord2000 F30A56A231354a4a81AB13B54EF21665 1 0 WORD2000支持库
 ' eOALib 05B2708EF81049a78EED8531D4A8DFB9 3 6 办公组件支持库
 ' HtmlView 5014D8FA6DCA40b68FA626D8183666EB 1 1 超文本浏览框支持库




.全局变量 操作员, 文本型, , , 存放当前登陆的操作员姓名
.全局变量 操作员级别, 文本型, , , 操作员级别
.全局变量 岗位权限, 文本型, , , 操作员的岗位权限
.全局变量 部门, 文本型, , , 操作员所属的部门
.全局变量 业务单号, 文本型, , , 累加单号值表中业务单号的值
.全局变量 检货号, 文本型, , , 累加单号值表中检货号的值
.全局变量 发货清单号, 文本型, , , 累加单号值表中发货清单号的值
.全局变量 调度单号, 文本型, , , 累加单号值表中调度单号的值
.全局变量 开业务单数, 整数型, , , 开单次数表中开业务单的次数
.全局变量 开检货单数, 整数型, , , 开单次数表中开检货单的次数
.全局变量 开发货清单数, 整数型, , , 开单次数表中开发货清单单的次数
.全局变量 开调度单数, 整数型, , , 开单次数表中开调度单的次数
.全局变量 回信人, 文本型, , , 
.全局变量 收信人, 文本型, , , 在菜单被选择中,会给此变量赋值,用以判断是给哪个经理发信件

.窗口程序集 窗口程序集1, , , 

.程序集变量 登陆计次, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 防止二次运行, 防止二次运行, , , 

.如果真 (防止二次运行.开始检查 ())
    信息框 (“程序已经运行!”, 0, )
    结束 ()
.如果真结束
未知支持库函数_0 (1)
置外形图片 (#登陆窗口外形, #红色)
赋值 (., #登陆窗口外形)
赋值 (登陆计次, 0)
获取焦点 ()
取各类单号值 ()

.子程序 _按钮_登陆_登陆确定_被单击, 空白型, , 
.局部变量 查询文本, 文本型, , , 
.局部变量 登陆次数, 整数型, , , 

.未知支持库函数_12 ()
.如果 (等于 (文件是否存在 (相加 (取运行目录 (), “\data\system.mdb”)), 假))
    信息框 (相加 (取运行目录 (), “\data\system.mdb失踪!”, #换行符, “请检查系统的完整性!本次运行将取消.”), 0, )
    结束 ()
    
.否则
    .如果 (等于 (相加 (取运行目录 (), “\data\system.mdb”).未知支持库函数_1 (“”), 假))
        信息框 (相加 (取运行目录 (), “\data\system.mdb打开失败!”, #换行符, “请系统管理员检查原因.本次运行将取消.”), 0, )
        结束 ()
    .否则
        赋值 (查询文本, 相加 (“select * from 操作员 where 登陆帐号='”, .内容, “' and 密码='”, .内容, “'”))
        查询文本.未知支持库函数_14 (1)
        .如果 (大于 (., 0))
            未知支持库函数_34 ()
            1.未知支持库函数_26 (操作员)
            3.未知支持库函数_26 (操作员级别)
            4.未知支持库函数_26 (岗位权限)
            5.未知支持库函数_26 (部门)
            6.未知支持库函数_25 (取现行时间 ())
            7.未知支持库函数_29 (登陆次数)
            7.未知支持库函数_23 (相加 (登陆次数, 1))
            未知支持库函数_18 ()
            载入 (主窗口, , 假)
            未知支持库函数_16 ()
            未知支持库函数_3 ()
            销毁 ()
        .否则
            赋值 (登陆计次, 相加 (登陆计次, 1))
            .如果 (不等于 (登陆计次, 3))
                信息框 (“用户名或密码错误!请仔细检查后再次登陆.”, 0, 相加 (“第”, 到文本 (登陆计次), “次错误”))
            .否则
                结束 ()
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 _按钮_登陆_取消_被单击, 空白型, , 
结束 ()

.子程序 _编辑框_登陆_用户名_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, #回车键))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框_登陆_密码_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, #回车键))
    _按钮_登陆_登陆确定_被单击 ()
.否则
    
.如果结束


.子程序 取各类单号值, 空白型, , 把全局变量里的四种单号的当前值和开单次数值从数据库里读出来
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 

.如果 (相加 (取当前目录 (), “\data\system.mdb”).未知支持库函数_1 (“”))
    .未知支持库函数_12 ()
    .如果 (“累加单号值”.未知支持库函数_14 (2))
        未知支持库函数_34 ()
        “业务单号”.未知支持库函数_26 (临时_文本)
        赋值 (业务单号, 临时_文本)
        “检货号”.未知支持库函数_26 (临时_文本)
        赋值 (检货号, 临时_文本)
        “发货清单号”.未知支持库函数_26 (临时_文本)
        赋值 (发货清单号, 临时_文本)
        “调度单号”.未知支持库函数_26 (临时_文本)
        赋值 (调度单号, 临时_文本)
    .否则
        信息框 (“打开累加单号值表失败!在录入各类单据的时候你得手动输入单号值了.”, 0, )
        返回 ()
    .如果结束
    
.否则
    信息框 (“系统数据库连接失败!在录入各类单据的时候你得手动输入单号值了.”, 0, )
    返回 ()
.如果结束
未知支持库函数_16 ()
.如果 (“开单次数”.未知支持库函数_14 (2))
    未知支持库函数_34 ()
    “业务单号”.未知支持库函数_29 (临时_整数)
    赋值 (开业务单数, 临时_整数)
    “检货号”.未知支持库函数_29 (临时_整数)
    赋值 (开检货单数, 临时_整数)
    “发货清单号”.未知支持库函数_29 (临时_整数)
    赋值 (开发货清单数, 临时_整数)
    “调度单号”.未知支持库函数_29 (临时_整数)
    赋值 (开调度单数, 临时_整数)
.否则
    
.如果结束
未知支持库函数_16 ()
未知支持库函数_3 ()

.窗口程序集 窗口程序集2, , , 

.程序集变量 发货清单_行, 整数型, , , 用于在发货清单表格里添加空行时存放当前行的行数
.程序集变量 自动添加行数, 整数型, , , 在发货清单录入里点击自动添加按钮后添加的行数
.程序集变量 手动添加行数, 整数型, , , 在发货清单录入里按回车增加空行后手动添加的记录行数
.程序集变量 许可证号, 整数型, , , 用于总经理查询时创建多线程的许可证号
.程序集变量 数据库, 数据库, , , 主窗口里面选择夹里用的数据库连接,是个类模块,程序中多次使用,因此做成类模块方便调用
.程序集变量 从日期, 文本型, , , 总经理查询的从日期
.程序集变量 到日期, 文本型, , , 总经理查询的到日期
.程序集变量 光标所在行号, 整数型, , , 发货清单录入里表格中光标当前所在的行号
.程序集变量 过滤条件, 文本型, , , 存放发货清单查询过滤条件
.程序集变量 职员信息_图片文件存放路径, 文本型, , , 存放职员信息录入时照片文件的路径
.程序集变量 当前员工照片路径, 文本型, , , 当前察看的员工详细信息的照片路径,在打印员工信息表的时候要用到的
.程序集变量 职员查询_记录号, 整数型, , "0", 存入职员查询时符合查询条件的记录号,以便于修改信息时快速定位到该记录
.程序集变量 职员信息当前修改项_记录号, 整数型, , , 
.程序集变量 工资固定项目修改_记录号, 整数型, , , 存放设置工资固定项目时,修改记录用的记录号
.子程序 _主窗口_创建完毕, 空白型, , 
赋值 (., #背景图片_朴素)
 ' 发货清单表格里,表格模板表头有三行,空行一行,共四行,所以操作行时从第四行开始
赋值 (发货清单_行, 3)
 ' 置状态栏相关信息
1.置文本 (操作员)
3.置文本 (操作员级别)
5.置文本 (部门)
7.置文本 (“等待操作!”)
赋值 (主窗口., 读配置项 (相加 (取当前目录 (), “\program.ini”), “主窗口标题”, “主窗口标题设置”, ))
 ' 运行权限判断子程序,来关掉登陆的操作员权限不足以操作的功能
权限判断 ()

.子程序 _主窗口_位置被改变, 空白型, , 
赋值 (.左边, 0)
赋值 (.顶边, 0)
赋值 (.宽度, 取用户区宽度 ())
赋值 (.高度, 取用户区高度 ())

.子程序 _按钮_主界面_退出系统_被单击, 空白型, , 
相加 (取当前目录 (), “\data\system.mdb”).未知支持库函数_1 (“”)
.未知支持库函数_12 ()
“累加单号值”.未知支持库函数_14 (2)
未知支持库函数_34 ()
“业务单号”.未知支持库函数_20 (业务单号)
“检货号”.未知支持库函数_20 (检货号)
“发货清单号”.未知支持库函数_20 (发货清单号)
“调度单号”.未知支持库函数_20 (调度单号)
未知支持库函数_18 ()
未知支持库函数_16 ()
“开单次数”.未知支持库函数_14 (2)
未知支持库函数_34 ()
“业务单号”.未知支持库函数_23 (开业务单数)
“检货号”.未知支持库函数_23 (开检货单数)
“发货清单号”.未知支持库函数_23 (开发货清单数)
“调度单号”.未知支持库函数_23 (开调度单数)
未知支持库函数_18 ()
未知支持库函数_16 ()
未知支持库函数_3 ()
结束 ()

.子程序 _操作员_被选择, 空白型, , 操作员菜单被选择后执行的子程序
 ' 载入窗口时,参数3用假,可以对被载入的窗口预先进行一些操作,改变标题/切换子夹,改变窗口的大小等等,窗口在载入后再改变大小/切换子夹等操作时,容易屏幕闪动,因此用了选择夹的窗口,可视属性都设为假,载入后把所有改变都设置好,然后再把可视设为真,这样看起来就不闪了
载入 (系统菜单窗口, , 假)
赋值 (系统菜单窗口., “操作员设置”)
赋值 (系统菜单窗口..现行子夹, 1)
赋值 (系统菜单窗口..高度, 372)
7.置文本 (“正在进行操作员设置”)
 ' 载入了新窗口后,必须要把主窗口的禁止属性设为真,否则就可以在操作新窗口的同时,也能操作主窗口,这样可能导致数据库打开冲突
赋值 (主窗口., 真)

.子程序 _总经理专用查询_被选择, 空白型, , 总经理专用查询菜单被选择后运行的子程序
赋值 (.现行子夹, 1)
赋值 (.高度, 492)
7.置文本 (“总经理查询”)
 ' 开关菜单工具条子程序,在主界面的选择夹里有多个页,都是一些主要的功能,如果切换到某个子夹时不关掉菜单和工具条上数据库操作相关的功能,也有可能导致打开数据冲突.
开关菜单工具条 (0)
获取焦点 ()
 ' 给总经理查询界面里查询时间范围的从日期取比当前日期提前一个月的日期,到日期自动取当前的日期,这样默认是查询统计上一个月的信息,通常需求就是这样
赋值 (.内容, 到文本 (增减时间 (取现行时间 (), #月份, -1)))
赋值 (.内容, 到文本 (取现行时间 ()))
 ' 看看查询效率怎么样,如果速度嫌慢,就加入多线程功能,已经把所有总经理查询统计的项目归成5类,分别是在5个数据库里,做成了5个子程序,这样在需要做多线程处理的时候,复制窗口组件来复制数据库连接和记录,共五个,然后启动五个线程分别调用这五个子程序同时完成查询统计工作.
许可证号 ＝ 创建进入许可证 ()

.子程序 _图形按钮_总经理_返回_被单击, 空白型, , 
赋值 (.现行子夹, 0)
7.置文本 (“等待操作...”)
 ' 退出了主窗口的总经理查询功能子夹,当然要调用开关菜单工具条()子程序,并加参数1来打开所有应开的菜单和工具条了
开关菜单工具条 (1)

.子程序 _业务单录入_被选择, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 临时, 文本型, , , 临时存放从记录集里取出的客户单位名称

赋值 (.现行子夹, 2)
赋值 (.高度, 492)
赋值 (.内容, 到文本 (取日期 (取现行时间 ())))
赋值 (.内容, 业务单号)
7.置文本 (“正在进行业务单录入...”)
.如果 (相加 (取当前目录 (), “\data\ywzhxx.mdb”).未知支持库函数_1 (“”))
    .未知支持库函数_12 ()
    .如果 (“客户信息”.未知支持库函数_14 (2))
        未知支持库函数_34 ()
        .计次循环首 (., 计次)
            “单位名称”.未知支持库函数_26 (临时)
            临时.加入项目 ()
            未知支持库函数_36 ()
        .计次循环尾 ()
    .否则
        信息框 (“打开客户信息表失败!”, 0, )
    .如果结束
    
.否则
    信息框 (“数据库连接失败!”, 0, )
.如果结束
未知支持库函数_16 ()
未知支持库函数_3 ()
开关菜单工具条 (0)
_时钟_待处理检货信息刷新_周期事件 ()

.子程序 _按钮_受理_返回主界面_被单击, 空白型, , 
赋值 (.现行子夹, 0)
7.置文本 (“等待操作...”)
开关菜单工具条 (1)

.子程序 _发货清单录入_被选择, 空白型, , 
赋值 (.现行子夹, 3)
赋值 (.高度, 492)
相加 (取当前目录 (), “\grd\null.grd”).从文件读 ()
赋值 (.内容, 发货清单号)
赋值 (.内容, 相加 (到文本 (取日期 (取现行时间 ())), 到文本 (取小时 (取现行时间 ())), “点”))
7.置文本 (“发货清单录入...”)
开关菜单工具条 (0)

.子程序 发货清单_添加空行, 空白型, , 易表格里不能做异形的表格,因为在添加行时,所有被合并过的列都会出来,表格就乱了,因此才有了这个添加空行子程序,来将乱了该合并的单元格在添加空行后自动合并
1.添加行 ()
赋值 (发货清单_行, 相加 (发货清单_行, 1))
发货清单_行.跳到 ()
发货清单_行.置行高 (100)
发货清单_行.加线条 (1, 1, 27, 相加 (#左边框, #上边框, #右边框, #下边框, #垂直线))
发货清单_行.合并 (4, 1, 3)
发货清单_行.合并 (7, 1, 2)
发货清单_行.合并 (10, 1, 2)
发货清单_行.合并 (12, 1, 3)
发货清单_行.合并 (15, 1, 5)
发货清单_行.合并 (20, 1, 5)
发货清单_行.合并 (25, 1, 2)

.子程序 _表格_发货清单录入_按下某键, 逻辑型, , 在发货清单窗口里的表格获取焦点后可以按回车添加一个空行
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

 ' 新手须知:在控件的"按下某键"事件里,键代码就是按了哪个键后返回的键代码,是可以用来做判断用的,判断你现在按下的是哪个键.:)这个功能非常好用来做测试按键的软件啊
.如果 (等于 (键代码, #回车键))
    发货清单_添加空行 ()
    赋值 (手动添加行数, 相加 (手动添加行数, 1))
.否则
    
.如果结束


.子程序 _按钮_发货清单_返回主界面_被单击, 空白型, , 
赋值 (.现行子夹, 0)
赋值 (发货清单_行, 4)
7.置文本 (“等待操作...”)
开关菜单工具条 (1)

.子程序 _按钮_发货清单_打印预览_被单击, 空白型, , 
打印预览 ()

.子程序 _发货清单_被选择, 空白型, , 
.局部变量 现行时间, 文本型, , , 

赋值 (.现行子夹, 4)
赋值 (.高度, 492)
相加 (取当前目录 (), “\grd\null.grd”).从文件读 ()
赋值 (现行时间, 相加 (到文本 (取日期 (取现行时间 ())), 到文本 (取小时 (取现行时间 ())), “时”))
赋值 (.内容, 到文本 (增减时间 (到时间 (现行时间), #日, -1)))
赋值 (.内容, 现行时间)
7.置文本 (“发货清单查询中...”)
开关菜单工具条 (0)

.子程序 _按钮_发货清单查询_返回_被单击, 空白型, , 
赋值 (.现行子夹, 0)
7.置文本 (“等待操作...”)
开关菜单工具条 (1)

.子程序 _职员信息_被选择, 空白型, , 
赋值 (.现行子夹, 5)
赋值 (.高度, 492)
7.置文本 (“正在录入职员信息”)
开关菜单工具条 (0)
清空职员录入界面 ()

.子程序 _时钟_状态条时间_周期事件, 空白型, , 
8.置文本 (到文本 (取现行时间 ()))


.子程序 _退出_被选择, 空白型, , 
7.置文本 (“正在退出...”)
结束 ()

.子程序 _图片框_职员信息_照片_被双击, 逻辑型, , 给职员信息录入界面里的职员照片加入数字照片
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 照片文件号, 整数型, , , 

.如果真 (打开 ())
    赋值 (照片文件号, 打开文件 (.文件名, , ))
    赋值 (.图片, 读入字节集 (照片文件号, 取文件长度 (照片文件号)))
    关闭文件 (照片文件号)
    赋值 (职员信息_图片文件存放路径, .文件名)
.如果真结束


.子程序 _图形按钮_职员信息_返回主界面_被单击, 空白型, , 
赋值 (.现行子夹, 0)
7.置文本 (“等待操作...”)
开关菜单工具条 (1)

.子程序 _工资表_被选择, 空白型, , 
.局部变量 文件号, 整数型, , , 

赋值 (.现行子夹, 6)
赋值 (.高度, 492)
赋值 (文件号, 打开文件 (相加 (取当前目录 (), “\data\四金.txt”), , ))
赋值 (.内容, 读入文本 (文件号, ))
赋值 (.内容, 到文本 (取日期 (取现行时间 ())))
7.置文本 (“正在进行工资表操作”)
开关菜单工具条 (0)
清空工资表 ()

.子程序 _按钮_工资表_固定工资信息设置_被单击, 空白型, , 
赋值 (.左边, 相减 (相除 (取用户区宽度 (), 2), 相除 (.宽度, 2)))
赋值 (.顶边, 相减 (相除 (取用户区高度 (), 2), 相除 (.高度, 2), 75))
赋值 (.可视, 真)
7.置文本 (“工资固定信息设置”)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)

赋值 (.禁止, 真)

.子程序 _按钮_工资表_固定信息退出_被单击, 空白型, , 
赋值 (.可视, 假)
7.置文本 (“正在进行工资表操作”)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)


.子程序 _后勤支出_被选择, 空白型, , 
赋值 (.现行子夹, 7)
赋值 (.高度, 492)
7.置文本 (“后勤支出管理...”)
开关菜单工具条 (0)

.子程序 _按钮_后勤支出_退出_被单击, 空白型, , 
赋值 (.现行子夹, 0)
7.置文本 (“等待操作...”)
开关菜单工具条 (1)

.子程序 _程序设置_被选择, 空白型, , 程序设置菜单被选择,载入系统菜单窗口,并做标题,大小,状态栏设置
载入 (系统菜单窗口, , 假)
赋值 (系统菜单窗口., “系统设置”)
赋值 (系统菜单窗口..高度, 372)
赋值 (系统菜单窗口..现行子夹, 2)
赋值 (系统菜单窗口..高度, 367)
赋值 (系统菜单窗口..高度, 367)
赋值 (系统菜单窗口..高度, 370)
7.置文本 (“正在进行程序设置”)
赋值 (主窗口., 真)


.子程序 _数据库备份_被选择, 空白型, , 数据库备份菜单被选择后运行的子程序
载入 (系统菜单窗口, , 假)
赋值 (系统菜单窗口., 相加 (“数据库备份”, “    最后备份日期为：”))
赋值 (系统菜单窗口..高度, 372)
赋值 (系统菜单窗口..现行子夹, 3)
7.置文本 (“数据库备份”)
赋值 (主窗口., 真)


.子程序 _签收信息录入_被选择, 空白型, , 
载入 (受理菜单窗口, , 假)
赋值 (受理菜单窗口., “签收信息录入”)
赋值 (受理菜单窗口..现行子夹, 1)
赋值 (受理菜单窗口., 378)
赋值 (受理菜单窗口., 242)
赋值 (受理菜单窗口., 1)
赋值 (受理菜单窗口., 真)
7.置文本 (“签收信息录入”)
赋值 (主窗口., 真)


.子程序 _客户信息预设_被选择, 空白型, , 
载入 (受理菜单窗口, , 假)
赋值 (受理菜单窗口., “客户信息预设”)
赋值 (受理菜单窗口..现行子夹, 2)
赋值 (受理菜单窗口., 382)
赋值 (受理菜单窗口., 278)
赋值 (受理菜单窗口., 1)
赋值 (受理菜单窗口., 真)
7.置文本 (“客户信息预设”)
赋值 (主窗口., 真)


.子程序 _外部合作公司录入_被选择, 空白型, , 
载入 (受理菜单窗口, , 假)
赋值 (受理菜单窗口., “外部合作公司”)
赋值 (受理菜单窗口..现行子夹, 3)
赋值 (受理菜单窗口., 452)
赋值 (受理菜单窗口., 271)
赋值 (受理菜单窗口., 1)
赋值 (受理菜单窗口., 真)
7.置文本 (“外部合作公司录入”)
赋值 (主窗口., 真)


.子程序 _客户投诉记录_被选择, 空白型, , 
载入 (受理菜单窗口, , 假)
赋值 (受理菜单窗口., “客户投诉记录”)
赋值 (受理菜单窗口..现行子夹, 4)
赋值 (受理菜单窗口., 422)
赋值 (受理菜单窗口., 385)
赋值 (受理菜单窗口., 1)
赋值 (受理菜单窗口., 真)
7.置文本 (“客户投诉记录”)
赋值 (主窗口., 真)


.子程序 _代理机构_被选择, 空白型, , 
载入 (受理菜单窗口, , 假)
赋值 (受理菜单窗口., “代理机构记录”)
赋值 (受理菜单窗口..现行子夹, 5)
赋值 (受理菜单窗口., 421)
赋值 (受理菜单窗口., 292)
赋值 (受理菜单窗口., 1)
赋值 (受理菜单窗口., 真)
7.置文本 (“代理机构录入”)
赋值 (主窗口., 真)


.子程序 _业务单_被选择, 空白型, , 
载入 (查询菜单窗口, , 假)
赋值 (查询菜单窗口., “业务单查询  (允许多条件查询)”)
赋值 (查询菜单窗口..现行子夹, 1)
赋值 (查询菜单窗口., 734)
赋值 (查询菜单窗口., 526)
赋值 (查询菜单窗口., 1)
赋值 (查询菜单窗口., 真)
7.置文本 (“正在进行业务单查询”)
赋值 (主窗口., 真)


.子程序 _客户信息_被选择, 空白型, , 
载入 (查询菜单窗口, , 假)
赋值 (查询菜单窗口., “客户信息查询”)
赋值 (查询菜单窗口..现行子夹, 2)
赋值 (查询菜单窗口., 389)
赋值 (查询菜单窗口., 276)
赋值 (查询菜单窗口., 1)
赋值 (查询菜单窗口., 真)
7.置文本 (“客户信息查询中...”)
赋值 (主窗口., 真)


.子程序 _业务状态_被选择, 空白型, , 
载入 (查询菜单窗口, , 假)
赋值 (查询菜单窗口., “业务状态查询”)
赋值 (查询菜单窗口..现行子夹, 3)
赋值 (查询菜单窗口., 171)
赋值 (查询菜单窗口., 304)
赋值 (查询菜单窗口., 1)
赋值 (查询菜单窗口., 真)
7.置文本 (“业务状态查询中...”)
赋值 (主窗口., 真)


.子程序 _货物基本信息录入_被选择, 空白型, , 
载入 (检货处菜单窗口, , 假)
赋值 (检货处菜单窗口., “检货信息录入”)
赋值 (检货处菜单窗口..现行子夹, 1)
赋值 (检货处菜单窗口., 320)
赋值 (检货处菜单窗口., 221)
赋值 (检货处菜单窗口..内容, 操作员)
赋值 (检货处菜单窗口..内容, 到文本 (取现行时间 ()))

赋值 (检货处菜单窗口., 1)
赋值 (检货处菜单窗口., 真)
7.置文本 (“正在录入检货基本信息”)
赋值 (主窗口., 真)


.子程序 _检货查询_被选择, 空白型, , 
载入 (检货处菜单窗口, , 假)
赋值 (检货处菜单窗口., “检货信息查询”)
赋值 (检货处菜单窗口..现行子夹, 2)
赋值 (检货处菜单窗口., 296)
赋值 (检货处菜单窗口., 207)
赋值 (检货处菜单窗口., 1)
赋值 (检货处菜单窗口., 真)
7.置文本 (“正在进行检货查询”)
赋值 (主窗口., 真)


.子程序 _检货异常情况处理_被选择, 空白型, , 
载入 (检货处菜单窗口, , 假)
赋值 (检货处菜单窗口., “检货异常信息录入”)
赋值 (检货处菜单窗口..现行子夹, 3)
赋值 (检货处菜单窗口., 366)
赋值 (检货处菜单窗口., 258)
赋值 (检货处菜单窗口., 1)
赋值 (检货处菜单窗口., 真)
7.置文本 (“货物异常处理中...”)
赋值 (主窗口., 真)


.子程序 _入库管理_被选择, 空白型, , 开始时用核心支持库里的表格,后来用了新表格觉得不错,就改用了新表格,只是没好的易表来编辑新表格,老表新表格式不兼容的
载入 (仓库菜单窗口, , 假)
 ' 下面这行语句用来在高级表格控件里加载一个已经编辑好并存到硬盘上的高级表格文件.
仓库菜单窗口.未知支持库函数_56 (., 相加 (取当前目录 (), “\grd\ruku_adv.grd”))
仓库菜单窗口.未知支持库函数_25 (., 0, 0, 0, 8, #.)
赋值 (仓库菜单窗口., “入库信息”)
赋值 (仓库菜单窗口..现行子夹, 1)
赋值 (仓库菜单窗口., 482)
赋值 (仓库菜单窗口., 340)
赋值 (仓库菜单窗口., 1)
赋值 (仓库菜单窗口., 真)
仓库菜单窗口.重画 (.)
7.置文本 (“正在进行入库管理”)
赋值 (主窗口., 真)


.子程序 _出库管理_被选择, 空白型, , 
载入 (仓库菜单窗口, , 假)
仓库菜单窗口.未知支持库函数_56 (., 相加 (取当前目录 (), “\grd\chuku_adv.grd”))
仓库菜单窗口.未知支持库函数_25 (., 0, 0, 0, 8, #.)
赋值 (仓库菜单窗口., “出库信息”)
赋值 (仓库菜单窗口..现行子夹, 2)
赋值 (仓库菜单窗口., 385)
赋值 (仓库菜单窗口., 288)
赋值 (仓库菜单窗口., 1)
赋值 (仓库菜单窗口., 真)
仓库菜单窗口.重画 (.)
7.置文本 (“正在进行出库管理”)
赋值 (主窗口., 真)


.子程序 _外地入埠货物管理_被选择, 空白型, , 
载入 (仓库菜单窗口, , 假)
赋值 (仓库菜单窗口., “外地入埠货物管理”)
赋值 (仓库菜单窗口..现行子夹, 3)
赋值 (仓库菜单窗口., 572)
赋值 (仓库菜单窗口., 344)
赋值 (仓库菜单窗口., 1)
赋值 (仓库菜单窗口..内容, 到文本 (取现行时间 ()))
赋值 (仓库菜单窗口..内容, 操作员)
赋值 (仓库菜单窗口..内容, 到文本 (取现行时间 ()))

赋值 (仓库菜单窗口., 真)
7.置文本 (“外地入埠货物管理...”)
赋值 (主窗口., 真)


.子程序 _车辆管理_被选择, 空白型, , 
载入 (调度菜单窗口, , 假)
赋值 (调度菜单窗口., “车辆管理”)
赋值 (调度菜单窗口..现行子夹, 1)
赋值 (调度菜单窗口., 611)
赋值 (调度菜单窗口., 349)
赋值 (调度菜单窗口., 1)
赋值 (调度菜单窗口., 真)
7.置文本 (“车辆信息管理”)
赋值 (主窗口., 真)

.子程序 _按钮_工资表_退出_被单击, 空白型, , 
赋值 (.现行子夹, 0)
7.置文本 (“等待操作...”)
开关菜单工具条 (1)

.子程序 _司机管理_被选择, 空白型, , 
载入 (调度菜单窗口, , 假)
赋值 (调度菜单窗口., “司机管理”)
赋值 (调度菜单窗口..现行子夹, 2)
赋值 (调度菜单窗口., 450)
赋值 (调度菜单窗口., 290)
赋值 (调度菜单窗口., 1)
赋值 (调度菜单窗口., 真)
7.置文本 (“司机信息管理”)
赋值 (主窗口., 真)


.子程序 _车辆调度记录_被选择, 空白型, , 
载入 (调度菜单窗口, , 假)
赋值 (调度菜单窗口., “车辆调度管理”)
赋值 (调度菜单窗口..现行子夹, 3)
赋值 (调度菜单窗口..内容, 调度单号)
赋值 (调度菜单窗口..内容, 到文本 (取现行时间 ()))
赋值 (调度菜单窗口..内容, 到文本 (取现行时间 ()))
赋值 (调度菜单窗口..内容, 到文本 (取现行时间 ()))
赋值 (调度菜单窗口., 502)
赋值 (调度菜单窗口., 344)
赋值 (调度菜单窗口., 1)
赋值 (调度菜单窗口., 真)
7.置文本 (“车辆调度信息录入”)
赋值 (主窗口., 真)


.子程序 _车辆维修保养管理_被选择, 空白型, , 
载入 (调度菜单窗口, , 假)
赋值 (调度菜单窗口., “车辆维修保养管理”)
赋值 (调度菜单窗口..现行子夹, 4)
赋值 (调度菜单窗口., 482)
赋值 (调度菜单窗口., 257)
赋值 (调度菜单窗口., 1)
赋值 (调度菜单窗口., 真)
7.置文本 (“车辆维修保养管理”)
赋值 (主窗口., 真)


.子程序 _加油管理_被选择, 空白型, , 
载入 (调度菜单窗口, , 假)
赋值 (调度菜单窗口., “车辆加油管理”)
赋值 (调度菜单窗口..现行子夹, 5)
赋值 (调度菜单窗口., 464)
赋值 (调度菜单窗口., 324)
赋值 (调度菜单窗口., 1)
赋值 (调度菜单窗口..内容, 到文本 (取现行时间 ()))
赋值 (调度菜单窗口..内容, 到文本 (取现行时间 ()))
赋值 (调度菜单窗口..内容, 到文本 (取现行时间 ()))
赋值 (调度菜单窗口., 真)
7.置文本 (“车辆加油管理...”)
赋值 (主窗口., 真)


.子程序 _电器设备登记_被选择, 空白型, , 
载入 (人资后勤菜单窗口, , 真)
7.置文本 (“正在进行电器设备登记”)


.子程序 _市场人员管理_被选择, 空白型, , 
载入 (市场部菜单窗口, , 假)
赋值 (市场部菜单窗口., “市场人员录入”)
赋值 (市场部菜单窗口..现行子夹, 1)
赋值 (市场部菜单窗口., 475)
赋值 (市场部菜单窗口., 218)
赋值 (市场部菜单窗口., 1)
赋值 (市场部菜单窗口., 真)
7.置文本 (“市场人员管理...”)
赋值 (主窗口., 真)


.子程序 _客户拜访记录_被选择, 空白型, , 
载入 (市场部菜单窗口, , 假)
赋值 (市场部菜单窗口., “客户拜访记录”)
赋值 (市场部菜单窗口..现行子夹, 2)
赋值 (市场部菜单窗口., 492)
赋值 (市场部菜单窗口., 257)
赋值 (市场部菜单窗口., 1)
赋值 (市场部菜单窗口..内容, 到文本 (取现行时间 ()))
赋值 (市场部菜单窗口..内容, 到文本 (取现行时间 ()))
赋值 (市场部菜单窗口..内容, 到文本 (取现行时间 ()))
赋值 (市场部菜单窗口., 真)
7.置文本 (“客户拜访信息管理...”)
赋值 (主窗口., 真)


.子程序 _市场人员业绩提成_被选择, 空白型, , 
载入 (市场部菜单窗口, , 假)
赋值 (市场部菜单窗口., “市场人员提成管理”)
赋值 (市场部菜单窗口..现行子夹, 3)
赋值 (市场部菜单窗口., 493)
赋值 (市场部菜单窗口., 279)
赋值 (市场部菜单窗口., 1)
赋值 (市场部菜单窗口., 真)
7.置文本 (“市场人员业绩提成管理”)
赋值 (主窗口., 真)


.子程序 _客户投诉查询_被选择, 空白型, , 
载入 (市场部菜单窗口, , 假)
市场部菜单窗口.未知支持库函数_56 (., 相加 (取当前目录 (), “\grd\sc_khts_adv.efs”))
市场部菜单窗口.未知支持库函数_25 (., 0, 0, 0, 6, #.)
赋值 (市场部菜单窗口., “客户投诉查询”)
赋值 (市场部菜单窗口..现行子夹, 4)
赋值 (市场部菜单窗口., 438)
赋值 (市场部菜单窗口., 270)
赋值 (市场部菜单窗口., 1)
赋值 (市场部菜单窗口., 真)
市场部菜单窗口.重画 (.)
7.置文本 (“客户投诉查询...”)
赋值 (主窗口., 真)


.子程序 _总经理信箱_被选择, 空白型, , 
赋值 (回信人, “总经理”)
赋值 (收信人, “总经理”)
.判断开始 (等于 (操作员级别, “岗位操作员”))
    载入 (经理信箱窗口, , 假)
    赋值 (经理信箱窗口., “给总经理写信&查看总经理回信”)
    赋值 (经理信箱窗口..现行子夹, 1)
    赋值 (经理信箱窗口., 609)
    赋值 (经理信箱窗口., 355)
    赋值 (经理信箱窗口., 1)
    赋值 (经理信箱窗口..内容, 操作员)
    赋值 (经理信箱窗口..内容, 到文本 (取现行时间 ()))
    赋值 (经理信箱窗口..内容, “总经理”)
    赋值 (经理信箱窗口., 真)
    7.置文本 (“给总经理写信”)
    赋值 (主窗口., 真)
    
.判断 (等于 (操作员级别, “管理员”))
    载入 (经理信箱窗口, , 假)
    赋值 (经理信箱窗口., “查看员工来信&给员工回信”)
    赋值 (经理信箱窗口..现行子夹, 2)
    赋值 (经理信箱窗口., 609)
    赋值 (经理信箱窗口., 355)
    赋值 (经理信箱窗口., 1)
    赋值 (经理信箱窗口..内容, “总经理”)
    赋值 (经理信箱窗口..内容, 到文本 (取现行时间 ()))
    赋值 (经理信箱窗口., 真)
    7.置文本 (“查看&回复员工来信”)
    赋值 (主窗口., 真)
    
.默认
    
.判断结束



.子程序 _业务主管信箱_被选择, 空白型, , 
赋值 (回信人, “业务主管”)
赋值 (收信人, “业务主管”)
.判断开始 (等于 (操作员级别, “岗位操作员”))
    载入 (经理信箱窗口, , 假)
    赋值 (经理信箱窗口., “给业务主管写信&查看业务主管回信”)
    赋值 (经理信箱窗口..现行子夹, 1)
    赋值 (经理信箱窗口., 609)
    赋值 (经理信箱窗口., 355)
    赋值 (经理信箱窗口., 1)
    赋值 (经理信箱窗口..内容, 操作员)
    赋值 (经理信箱窗口..内容, “业务主管”)
    赋值 (经理信箱窗口..内容, 到文本 (取现行时间 ()))
    赋值 (经理信箱窗口., 真)
    7.置文本 (“给业务主管写信”)
    赋值 (主窗口., 真)
    
.判断 (等于 (操作员级别, “业务主管”))
    载入 (经理信箱窗口, , 假)
    赋值 (经理信箱窗口., “查看员工来信&给员工回信”)
    赋值 (经理信箱窗口..现行子夹, 2)
    赋值 (经理信箱窗口., 609)
    赋值 (经理信箱窗口., 355)
    赋值 (经理信箱窗口., 1)
    赋值 (经理信箱窗口..内容, “业务主管”)
    赋值 (经理信箱窗口..内容, 到文本 (取现行时间 ()))
    赋值 (经理信箱窗口., 真)
    7.置文本 (“查看&回复员工来信”)
    赋值 (主窗口., 真)
    
.默认
    
.判断结束



.子程序 _市场主管信箱_被选择, 空白型, , 
赋值 (回信人, “市场主管”)
赋值 (收信人, “市场主管”)
.判断开始 (等于 (操作员级别, “岗位操作员”))
    载入 (经理信箱窗口, , 假)
    赋值 (经理信箱窗口., “给市场主管写信&查看市场主管回信”)
    赋值 (经理信箱窗口..现行子夹, 1)
    赋值 (经理信箱窗口., 609)
    赋值 (经理信箱窗口., 355)
    赋值 (经理信箱窗口., 1)
    赋值 (经理信箱窗口..内容, 操作员)
    赋值 (经理信箱窗口..内容, “市场主管”)
    赋值 (经理信箱窗口..内容, 到文本 (取现行时间 ()))
    赋值 (经理信箱窗口., 真)
    7.置文本 (“给市场主管写信”)
    赋值 (主窗口., 真)
    
.判断 (等于 (操作员级别, “市场主管”))
    载入 (经理信箱窗口, , 假)
    赋值 (经理信箱窗口., “查看员工来信&给员工回信”)
    赋值 (经理信箱窗口..现行子夹, 2)
    赋值 (经理信箱窗口., 609)
    赋值 (经理信箱窗口., 355)
    赋值 (经理信箱窗口., 1)
    赋值 (经理信箱窗口..内容, “市场主管”)
    赋值 (经理信箱窗口..内容, 到文本 (取现行时间 ()))
    赋值 (经理信箱窗口., 真)
    7.置文本 (“查看&回复员工来信”)
    赋值 (主窗口., 真)
    
.默认
    
.判断结束



.子程序 权限判断, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 岗位权限分割文本, 文本型, , "0", 

 ' 这个子程序的功能可是很重要的哦,不同岗位的工作人员的权限不一样,不能越权的,否则信息可能会很不安全.该子程序里让不同权限的操作员登陆后关闭掉权限所不允许的功能,以免破坏其它部门的信息
 ' 岗位权限文本里如果存放有多个权限,各个权限间是用&隔开的,要分割文本后才能使用
赋值 (岗位权限分割文本, 分割文本 (岗位权限, “&”, ))
赋值 (计次, 1)
 ' 先判断操作级别,管理员或主管级别的操作员,其岗位权限是固定的,当级别是岗位操作员时,才需要要判断其拥有的岗位操作权限
.判断开始 (等于 (操作员级别, “管理员”))
    
.判断 (等于 (操作员级别, “业务主管”))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    0.加入状态 (#禁止)
.判断 (等于 (操作员级别, “市场主管”))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    0.加入状态 (#禁止)
    2.加入状态 (#禁止)
    3.加入状态 (#禁止)
    5.加入状态 (#禁止)
    6.加入状态 (#禁止)
    7.加入状态 (#禁止)
    9.加入状态 (#禁止)
    10.加入状态 (#禁止)
    12.加入状态 (#禁止)
    13.加入状态 (#禁止)
    15.加入状态 (#禁止)
    16.加入状态 (#禁止)
.判断 (等于 (操作员级别, “人事主管”))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    0.加入状态 (#禁止)
    2.加入状态 (#禁止)
    3.加入状态 (#禁止)
    5.加入状态 (#禁止)
    6.加入状态 (#禁止)
    7.加入状态 (#禁止)
    9.加入状态 (#禁止)
    10.加入状态 (#禁止)
    12.加入状态 (#禁止)
    13.加入状态 (#禁止)
    15.加入状态 (#禁止)
    16.加入状态 (#禁止)
    
.判断 (等于 (操作员级别, “内务主管”))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    0.加入状态 (#禁止)
    2.加入状态 (#禁止)
    3.加入状态 (#禁止)
    5.加入状态 (#禁止)
    6.加入状态 (#禁止)
    7.加入状态 (#禁止)
    9.加入状态 (#禁止)
    10.加入状态 (#禁止)
    12.加入状态 (#禁止)
    13.加入状态 (#禁止)
    15.加入状态 (#禁止)
    16.加入状态 (#禁止)
    
.判断 (等于 (操作员级别, “岗位操作员”))
     ' 下面是岗位操作员的岗位权限判断了,先把所有的菜单和工具条功能禁止,然后判断出有哪个权限就打开哪个功能
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    0.加入状态 (#禁止)
    2.加入状态 (#禁止)
    3.加入状态 (#禁止)
    5.加入状态 (#禁止)
    6.加入状态 (#禁止)
    7.加入状态 (#禁止)
    9.加入状态 (#禁止)
    10.加入状态 (#禁止)
    12.加入状态 (#禁止)
    13.加入状态 (#禁止)
    15.加入状态 (#禁止)
    16.加入状态 (#禁止)
    .计次循环首 (取数组成员数 (岗位权限分割文本), 计次)
        .如果 (等于 (岗位权限分割文本 [计次], “受理”))
            赋值 (.禁止, 假)
            2.去除状态 (#禁止)
            3.去除状态 (#禁止)
        .否则
            .如果 (等于 (岗位权限分割文本 [计次], “查询”))
                赋值 (.禁止, 假)
                5.去除状态 (#禁止)
                6.去除状态 (#禁止)
                7.去除状态 (#禁止)
            .否则
                .如果 (等于 (岗位权限分割文本 [计次], “检货”))
                    赋值 (.禁止, 假)
                    9.去除状态 (#禁止)
                    10.去除状态 (#禁止)
                .否则
                    .如果 (等于 (岗位权限分割文本 [计次], “仓库”))
                        赋值 (.禁止, 假)
                        12.去除状态 (#禁止)
                        13.去除状态 (#禁止)
                    .否则
                        .如果 (等于 (岗位权限分割文本 [计次], “调度”))
                            赋值 (.禁止, 假)
                            15.去除状态 (#禁止)
                            16.去除状态 (#禁止)
                        .否则
                            .如果 (等于 (岗位权限分割文本 [计次], “人资”))
                                赋值 (.禁止, 假)
                                赋值 (.禁止, 假)
                                赋值 (.禁止, 假)
                            .否则
                                .如果 (等于 (岗位权限分割文本 [计次], “后勤”))
                                    赋值 (.禁止, 假)
                                    赋值 (.禁止, 假)
                                    赋值 (.禁止, 假)
                                .否则
                                    .如果 (等于 (岗位权限分割文本 [计次], “市场”))
                                        赋值 (.禁止, 假)
                                    .否则
                                        
                                    .如果结束
                                    
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                        
                        
                        
                        
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .计次循环尾 ()
    
.默认
    
.判断结束


.子程序 _工具条_主界面_常用功能_被单击, 空白型, , 工具条按钮执行功能的判断
.参数 按钮索引, 整数型, , 

 ' 工具条的使用,是在其被单击事件里判断按钮索引的值来确定点击了工具条上的哪个按钮,然后根据按钮索引值来调用相应的子程序
.判断开始 (等于 (按钮索引, 0))
     ' 为什么按钮索引值没有1呢?因为按钮索引值1所代表的按钮是个分隔线,不是通常的按钮属性
    _总经理专用查询_被选择 ()
.判断 (等于 (按钮索引, 2))
    _业务单录入_被选择 ()
.判断 (等于 (按钮索引, 3))
    _发货清单录入_被选择 ()
.判断 (等于 (按钮索引, 5))
    _业务单_被选择 ()
.判断 (等于 (按钮索引, 6))
    _发货清单_被选择 ()
.判断 (等于 (按钮索引, 7))
    _业务状态_被选择 ()
.判断 (等于 (按钮索引, 9))
    _货物基本信息录入_被选择 ()
.判断 (等于 (按钮索引, 10))
    _检货异常情况处理_被选择 ()
.判断 (等于 (按钮索引, 12))
    _入库管理_被选择 ()
.判断 (等于 (按钮索引, 13))
    _出库管理_被选择 ()
.判断 (等于 (按钮索引, 15))
    _车辆维修保养管理_被选择 ()
.判断 (等于 (按钮索引, 16))
    _车辆调度记录_被选择 ()
.判断 (等于 (按钮索引, 18))
    信息框 (“动态教程”, 0, )
.判断 (等于 (按钮索引, 19))
    信息框 (“如何注册”, 0, )
.默认
    
.判断结束


.子程序 _按钮_总经理_开始查询_被单击, 空白型, , 总经理查询,内容包含了五个数据库中十数个表的数据查询统计
.局部变量 间隔时间, 双精度小数型, , , 总经理查询的从日期和到日期的间隔时间

.如果 (并且 (不等于 (.内容, “”), 不等于 (.内容, “”)))
    赋值 (从日期, .内容)
    赋值 (到日期, .内容)
    赋值 (间隔时间, 取绝对值 (取时间间隔 (到时间 (从日期), 到时间 (到日期), #日)))
     ' 过去的时间减现在的时间,得到的时间间隔是负数,所以要取绝对值
    .如果 (小于 (间隔时间, 1))
        信息框 (“两个日期是一样的,没有间隔天数,请修改从日期到提早一些的日期,以便能汇总统计一段时间的数据!”, 0, )
        获取焦点 ()
    .否则
        
    .如果结束
    
.否则
    信息框 (“从日期和到日期输入框都不能为空!”, 0, )
    返回 ()
.如果结束


 ' 由于总经理查询里所查询的信息分布在除系统库和经理信箱库以外的五个数据库里,因此分成五个子程序来完成,方便改成多线程来优化查询速度.下面五个子程序调用就是
总经理业务单情况 ()
总经理市场部信息 ()
总经理人资后勤 ()
总经理发货情况 ()
总经理车辆信息 ()

.子程序 开关菜单工具条, 空白型, , 在主窗口中切换选择夹页时,得调用这个子程序来关闭所有的菜单和工具条,避免重复打开数据库时造成错误
.参数 开关, 整数型, , 参数为1时打开菜单和工具条,参数为0时关闭所有菜单和工具条

.判断开始 (等于 (开关, 0))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (., 真)
.判断 (等于 (开关, 1))
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (., 假)
    
.默认
    
.判断结束


.子程序 总经理查询_业务单情况, 空白型, , 本子程序暂时放弃使用
.局部变量 总单数, 整数型, , , 这些变量全是总经理查询里业务单情况要统计的项目
.局部变量 总件数, 整数型, , , 
.局部变量 总重量, 整数型, , , 
.局部变量 总体积, 整数型, , , 
.局部变量 总计合作公司费用, 整数型, , , 
.局部变量 总计中转费, 整数型, , , 
.局部变量 总计派送费, 整数型, , , 
.局部变量 总计业务单收入, 整数型, , , 
.局部变量 计次, 整数型, , , 循环计次用的变量
.局部变量 临时, 整数型, , , 用于记录集读整数时临时存储的变量

 ' 不知道为什么下面这行数据库查询的sql语句不成功,去掉后面的WHERE子句的时间比较就可以成功.用记录.查找命令却又可以做日期型数据比较,头疼
.如果 (数据库.开始查询 (“main.mdb”, , 相加 (“select 实际件数,实际重量,实际体积,合作公司费用,中转费,派送费,实收费用 from 业务单 where 开票时间 > '”, 从日期, “' and 开票时间 < '”, 到日期, “'”)))
    赋值 (总单数, .)
    未知支持库函数_34 ()
    .计次循环首 (总单数, 计次)
        0.未知支持库函数_29 (临时)
        赋值 (总件数, 相加 (总件数, 临时))
        1.未知支持库函数_29 (临时)
        赋值 (总重量, 相加 (总重量, 临时))
        2.未知支持库函数_29 (临时)
        赋值 (总体积, 相加 (总体积, 临时))
        3.未知支持库函数_29 (临时)
        赋值 (总计合作公司费用, 相加 (总计合作公司费用, 临时))
        4.未知支持库函数_29 (临时)
        赋值 (总计中转费, 相加 (总计中转费, 临时))
        5.未知支持库函数_29 (临时)
        赋值 (总计派送费, 相加 (总计派送费, 临时))
        6.未知支持库函数_29 (临时)
        赋值 (总计业务单收入, 相加 (总计业务单收入, 临时))
        未知支持库函数_36 ()
    .计次循环尾 ()
    赋值 (.内容, 到文本 (总单数))
    赋值 (.内容, 到文本 (总件数))
    赋值 (.内容, 到文本 (总重量))
    赋值 (.内容, 到文本 (总体积))
    赋值 (.内容, 到文本 (总计合作公司费用))
    赋值 (.内容, 到文本 (总计中转费))
    赋值 (.内容, 到文本 (总计派送费))
    赋值 (.内容, 到文本 (总计业务单收入))
    数据库.断开 ()
.否则
    返回 ()
.如果结束


.子程序 总经理业务单情况, 空白型, , 总经理查询里关于业务单情况的查询统计
.局部变量 总单数, 整数型, , , 这些变量全是总经理查询里业务单情况要统计的项目
.局部变量 总件数, 整数型, , , 
.局部变量 总重量, 整数型, , , 
.局部变量 总体积, 整数型, , , 
.局部变量 总计合作公司费用, 整数型, , , 
.局部变量 总计中转费, 整数型, , , 
.局部变量 总计派送费, 整数型, , , 
.局部变量 总计业务单收入, 整数型, , , 
.局部变量 计次, 整数型, , , 循环计次用的变量
.局部变量 临时, 整数型, , , 用于记录集读整数时临时存储的变量

相加 (取当前目录 (), “\data\main.mdb”).未知支持库函数_1 (“”)
.未知支持库函数_12 ()
 ' 如果需要用到日期时间型的字段作为条件过滤记录,最好是用下面这种方法,用SQL语句查询失败了,原因等以后用上了正版再查明!
“业务单”.未知支持库函数_14 (2)
 ' 用下面这条语句以日期时间型字段来过滤记录,结果成功了!下面的类似子程序都是用这种方法.除此外没有别的方法成功过,当时试各种方法,都快抓狂了!从日期和到日期是文本型变量
相加 (“开票时间 > '”, 从日期, “' and 开票时间 < '”, 到日期, “'”).未知支持库函数_47 ()
赋值 (总单数, .)
未知支持库函数_34 ()
.计次循环首 (总单数, 计次)
    8.未知支持库函数_29 (临时)
    赋值 (总件数, 相加 (总件数, 临时))
    10.未知支持库函数_29 (临时)
    赋值 (总重量, 相加 (总重量, 临时))
    12.未知支持库函数_29 (临时)
    赋值 (总体积, 相加 (总体积, 临时))
    34.未知支持库函数_29 (临时)
    赋值 (总计合作公司费用, 相加 (总计合作公司费用, 临时))
    37.未知支持库函数_29 (临时)
    赋值 (总计中转费, 相加 (总计中转费, 临时))
    40.未知支持库函数_29 (临时)
    赋值 (总计派送费, 相加 (总计派送费, 临时))
    42.未知支持库函数_29 (临时)
    赋值 (总计业务单收入, 相加 (总计业务单收入, 临时))
    未知支持库函数_36 ()
.计次循环尾 ()
“”.未知支持库函数_47 ()
赋值 (.内容, 到文本 (总单数))
赋值 (.内容, 到文本 (总件数))
赋值 (.内容, 到文本 (总重量))
赋值 (.内容, 到文本 (总体积))
赋值 (.内容, 到文本 (总计合作公司费用))
赋值 (.内容, 到文本 (总计中转费))
赋值 (.内容, 到文本 (总计派送费))
赋值 (.内容, 到文本 (总计业务单收入))
未知支持库函数_16 ()
未知支持库函数_3 ()

.子程序 总经理市场部信息, 空白型, , 总经理查询里关于市场部相关信息查询统计
.局部变量 市场人员人数, 整数型, , , 
.局部变量 具备本行业经验, 整数型, , , 
.局部变量 客户拜访次数, 整数型, , , 
.局部变量 客户拜访开支总计, 整数型, , , 
.局部变量 第一名, 文本型, , , 
.局部变量 销售业绩1, 整数型, , , 
.局部变量 第二名, 文本型, , , 
.局部变量 销售业绩2, 整数型, , , 
.局部变量 第三名, 文本型, , , 
.局部变量 销售业绩3, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 临时, 文本型, , , 
.局部变量 临时1, 整数型, , , 

相加 (取当前目录 (), “\data\sc.mdb”).未知支持库函数_1 (“”)
.未知支持库函数_12 ()
“select * from 市场人员”.未知支持库函数_14 (1)
赋值 (市场人员人数, .)
.计次循环首 (., 计次)
    “物流行业经验”.未知支持库函数_26 (临时)
    .如果真 (不等于 (临时, “”))
        赋值 (具备本行业经验, 相加 (具备本行业经验, 1))
    .如果真结束
    未知支持库函数_36 ()
.计次循环尾 ()
未知支持库函数_16 ()
“客户拜访记录”.未知支持库函数_14 (2)
相加 (“到访时间 > '”, 从日期, “' and 到访时间 < '”, 到日期, “'”).未知支持库函数_47 ()
未知支持库函数_34 ()
赋值 (计次, 1)
.计次循环首 (., 计次)
    14.未知支持库函数_29 (临时1)
    赋值 (客户拜访次数, 相加 (客户拜访次数, 临时1))
    11.未知支持库函数_29 (临时1)
    赋值 (客户拜访开支总计, 相加 (客户拜访开支总计, 临时1))
    12.未知支持库函数_29 (临时1)
    赋值 (客户拜访开支总计, 相加 (客户拜访开支总计, 临时1))
    13.未知支持库函数_29 (临时1)
    赋值 (客户拜访开支总计, 相加 (客户拜访开支总计, 临时1))
    未知支持库函数_36 ()
.计次循环尾 ()
“”.未知支持库函数_47 ()
未知支持库函数_16 ()
“业绩提成”.未知支持库函数_15 (“运费金额 desc”)
相加 (“发货日期 > '”, 从日期, “' and 发货日期 < '”, 到日期, “'”).未知支持库函数_47 ()
未知支持库函数_34 ()
1.未知支持库函数_26 (第一名)
5.未知支持库函数_29 (销售业绩1)
未知支持库函数_36 ()
1.未知支持库函数_26 (第二名)
5.未知支持库函数_29 (销售业绩2)
未知支持库函数_36 ()
1.未知支持库函数_26 (第三名)
5.未知支持库函数_29 (销售业绩3)
“”.未知支持库函数_47 ()
未知支持库函数_16 ()
未知支持库函数_3 ()
赋值 (.内容, 到文本 (市场人员人数))
赋值 (.内容, 到文本 (具备本行业经验))
赋值 (.内容, 到文本 (客户拜访次数))
赋值 (.内容, 到文本 (客户拜访开支总计))
赋值 (.内容, 第一名)
赋值 (.内容, 到文本 (销售业绩1))
赋值 (.内容, 第二名)
赋值 (.内容, 到文本 (销售业绩2))
赋值 (.内容, 第三名)
赋值 (.内容, 到文本 (销售业绩3))



.子程序 总经理人资后勤, 空白型, , 总经理查询里的关于人资后勤信息查询统计
.局部变量 购置数量, 整数型, , , 
.局部变量 购置金额, 整数型, , , 
.局部变量 房租费, 整数型, , , 
.局部变量 水费, 整数型, , , 
.局部变量 电费, 整数型, , , 
.局部变量 物业费, 整数型, , , 
.局部变量 座机费, 整数型, , , 
.局部变量 手机费, 整数型, , , 
.局部变量 米量, 整数型, , , 
.局部变量 菜量, 整数型, , , 
.局部变量 伙食消耗费用, 整数型, , , 
.局部变量 饮用水数量, 整数型, , , 
.局部变量 饮用水费用, 整数型, , , 
.局部变量 总计人数, 整数型, , , 
.局部变量 男, 整数型, , , 
.局部变量 女, 整数型, , , 
.局部变量 大学, 整数型, , , 
.局部变量 高中, 整数型, , , 
.局部变量 初中, 整数型, , , 
.局部变量 在岗, 整数型, , , 
.局部变量 辞职, 整数型, , , 
.局部变量 辞退, 整数型, , , 
.局部变量 工资, 整数型, , , 
.局部变量 奖金, 整数型, , , 
.局部变量 补贴, 整数型, , , 
.局部变量 罚扣款, 整数型, , , 
.局部变量 个人所得税, 整数型, , , 
.局部变量 四金, 整数型, , , 
.局部变量 发出工资总额, 整数型, , , 
.局部变量 岗位压金, 整数型, , , 
.局部变量 工作服压金, 整数型, , , 以上都是需要查询统计并填入总经理查询中的内容
.局部变量 计次, 整数型, , , 循环变量
.局部变量 临时, 整数型, , , 临时存放数据的变量
.局部变量 临时1, 文本型, , , 临时存放文本型数据的变量

相加 (取当前目录 (), “\data\rzhq.mdb”).未知支持库函数_1 (“”)
.未知支持库函数_12 ()
“办公用品采购”.未知支持库函数_14 (2)
相加 (“购入日期 > '”, 从日期, “' and 购入日期 < '”, 到日期, “'”).未知支持库函数_47 ()
未知支持库函数_34 ()
赋值 (计次, 1)
.计次循环首 (., 计次)
    “数量”.未知支持库函数_29 (临时)
    赋值 (购置数量, 相加 (购置数量, 临时))
    “金额”.未知支持库函数_29 (临时)
    赋值 (购置金额, 相加 (购置金额, 临时))
    未知支持库函数_36 ()
.计次循环尾 ()
“”.未知支持库函数_47 ()
未知支持库函数_16 ()
“房租水电通讯费”.未知支持库函数_14 (2)
相加 (“缴费时间 > '”, 从日期, “' and 缴费时间 < '”, 到日期, “'”).未知支持库函数_47 ()
未知支持库函数_34 ()
赋值 (计次, 1)
.计次循环首 (., 计次)
    “费用名称”.未知支持库函数_26 (临时1)
    .判断开始 (等于 (临时1, “房租费”))
        “缴费金额”.未知支持库函数_29 (临时)
        赋值 (房租费, 相加 (房租费, 临时))
    .判断 (等于 (临时1, “水费”))
        “缴费金额”.未知支持库函数_29 (临时)
        赋值 (水费, 相加 (水费, 临时))
    .判断 (等于 (临时1, “电费”))
        “缴费金额”.未知支持库函数_29 (临时)
        赋值 (电费, 相加 (电费, 临时))
    .判断 (等于 (临时1, “物业费”))
        “缴费金额”.未知支持库函数_29 (临时)
        赋值 (物业费, 相加 (物业费, 临时))
    .判断 (等于 (临时1, “座机费”))
        “缴费金额”.未知支持库函数_29 (临时)
        赋值 (座机费, 相加 (座机费, 临时))
    .判断 (等于 (临时1, “手机费”))
        “缴费金额”.未知支持库函数_29 (临时)
        赋值 (手机费, 相加 (手机费, 临时))
    .默认
        
    .判断结束
    未知支持库函数_36 ()
.计次循环尾 ()
“”.未知支持库函数_47 ()
未知支持库函数_16 ()
“餐饮”.未知支持库函数_14 (2)
相加 (“购入日期 > '”, 从日期, “' and 购入日期 < '”, 到日期, “'”).未知支持库函数_47 ()
未知支持库函数_34 ()
赋值 (计次, 1)
.计次循环首 (., 计次)
    “物品名称”.未知支持库函数_26 (临时1)
    .判断开始 (等于 (临时1, “米”))
        “数量”.未知支持库函数_29 (临时)
        赋值 (米量, 相加 (米量, 临时))
        “金额”.未知支持库函数_29 (临时)
        赋值 (伙食消耗费用, 相加 (伙食消耗费用, 临时))
    .判断 (等于 (临时1, “菜”))
        “数量”.未知支持库函数_29 (临时)
        赋值 (菜量, 相加 (菜量, 临时))
        “金额”.未知支持库函数_29 (临时)
        赋值 (伙食消耗费用, 相加 (伙食消耗费用, 临时))
    .判断 (等于 (临时1, “饮用水”))
        “数量”.未知支持库函数_29 (临时)
        赋值 (饮用水数量, 相加 (饮用水数量, 临时))
        “金额”.未知支持库函数_29 (临时)
        赋值 (饮用水费用, 相加 (饮用水费用, 临时))
    .默认
        
    .判断结束
    
.计次循环尾 ()
“”.未知支持库函数_47 ()
未知支持库函数_16 ()
“职员表”.未知支持库函数_14 (2)
未知支持库函数_34 ()
赋值 (计次, 1)
.计次循环首 (总计人数, 计次)
    “性别”.未知支持库函数_26 (临时1)
    .判断开始 (等于 (临时1, “男”))
        赋值 (男, 相加 (男, 1))
    .判断 (等于 (临时1, “女”))
        赋值 (女, 相加 (女, 1))
    .默认
        
    .判断结束
    “学历”.未知支持库函数_26 (临时1)
    .判断开始 (等于 (临时1, “大学”))
        赋值 (大学, 相加 (大学, 1))
    .判断 (等于 (临时1, “高中”))
        赋值 (高中, 相加 (高中, 1))
    .判断 (等于 (临时1, “初中”))
        赋值 (初中, 相加 (初中, 1))
    .默认
        
    .判断结束
    “在职状态”.未知支持库函数_26 (临时1)
    .判断开始 (等于 (临时1, “在岗”))
        赋值 (在岗, 相加 (在岗, 1))
    .判断 (等于 (临时1, “辞职”))
        赋值 (辞职, 相加 (辞职, 1))
    .判断 (等于 (临时1, “辞退”))
        赋值 (辞退, 相加 (辞退, 1))
    .默认
        
    .判断结束
    未知支持库函数_36 ()
.计次循环尾 ()
赋值 (总计人数, 相减 (., 辞职, 辞退))
未知支持库函数_16 ()
“工资表”.未知支持库函数_14 (2)
相加 (“发放日期 > '”, 从日期, “' and 发放日期 < '”, 到日期, “'”).未知支持库函数_47 ()
未知支持库函数_34 ()
赋值 (计次, 1)
.计次循环首 (., 计次)
    “标准工资”.未知支持库函数_29 (临时)
    赋值 (工资, 相加 (工资, 临时))
    “浮动工资”.未知支持库函数_29 (临时)
    赋值 (工资, 相加 (工资, 临时))
    “奖金”.未知支持库函数_29 (临时)
    赋值 (奖金, 相加 (奖金, 临时))
    “职务补贴”.未知支持库函数_29 (临时)
    赋值 (补贴, 相加 (补贴, 临时))
    “交通补贴”.未知支持库函数_29 (临时)
    赋值 (补贴, 相加 (补贴, 临时))
    “住房补贴”.未知支持库函数_29 (临时)
    赋值 (补贴, 相加 (补贴, 临时))
    “误餐补贴”.未知支持库函数_29 (临时)
    赋值 (补贴, 相加 (补贴, 临时))
    “请假扣款”.未知支持库函数_29 (临时)
    赋值 (罚扣款, 相加 (罚扣款, 临时))
    “迟到罚款”.未知支持库函数_29 (临时)
    赋值 (罚扣款, 相加 (罚扣款, 临时))
    “早退罚款”.未知支持库函数_29 (临时)
    赋值 (罚扣款, 相加 (罚扣款, 临时))
    “违规操作罚款”.未知支持库函数_29 (临时)
    赋值 (罚扣款, 相加 (罚扣款, 临时))
    “个人所得税”.未知支持库函数_29 (临时)
    赋值 (个人所得税, 相加 (个人所得税, 临时))
    “养老保险金”.未知支持库函数_29 (临时)
    赋值 (四金, 相加 (四金, 临时))
    “住房公积金”.未知支持库函数_29 (临时)
    赋值 (四金, 相加 (四金, 临时))
    “失业保险金”.未知支持库函数_29 (临时)
    赋值 (四金, 相加 (四金, 临时))
    “医疗保险金”.未知支持库函数_29 (临时)
    赋值 (四金, 相加 (四金, 临时))
    “实发工资”.未知支持库函数_29 (临时)
    赋值 (发出工资总额, 相加 (发出工资总额, 临时))
    未知支持库函数_36 ()
.计次循环尾 ()
“”.未知支持库函数_47 ()
未知支持库函数_16 ()
“工资固定信息”.未知支持库函数_14 (2)
.计次循环首 (., )
    “岗位压金”.未知支持库函数_29 (临时)
    赋值 (岗位压金, 相加 (岗位压金, 临时))
    “工作服压金”.未知支持库函数_29 (临时)
    赋值 (工作服压金, 相加 (工作服压金, 临时))
    未知支持库函数_36 ()
.计次循环尾 ()
未知支持库函数_16 ()
未知支持库函数_3 ()

赋值 (.内容, 到文本 (购置数量))
赋值 (.内容, 到文本 (购置金额))
赋值 (.内容, 到文本 (房租费))
赋值 (.内容, 到文本 (水费))
赋值 (.内容, 到文本 (电费))
赋值 (.内容, 到文本 (物业费))
赋值 (.内容, 到文本 (座机费))
赋值 (.内容, 到文本 (手机费))
赋值 (.内容, 到文本 (米量))
赋值 (.内容, 到文本 (菜量))
赋值 (.内容, 到文本 (伙食消耗费用))
赋值 (.内容, 到文本 (饮用水数量))
赋值 (.内容, 到文本 (饮用水费用))
赋值 (.内容, 到文本 (总计人数))
赋值 (.内容, 到文本 (男))
赋值 (.内容, 到文本 (女))
赋值 (.内容, 到文本 (大学))
赋值 (.内容, 到文本 (高中))
赋值 (.内容, 到文本 (初中))
赋值 (.内容, 到文本 (在岗))
赋值 (.内容, 到文本 (辞职))
赋值 (.内容, 到文本 (辞退))
赋值 (.内容, 到文本 (工资))
赋值 (.内容, 到文本 (奖金))
赋值 (.内容, 到文本 (补贴))
赋值 (.内容, 到文本 (罚扣款))
赋值 (.内容, 到文本 (个人所得税))
赋值 (.内容, 到文本 (四金))
赋值 (.内容, 到文本 (发出工资总额))
赋值 (.内容, 到文本 (岗位压金))
赋值 (.内容, 到文本 (工作服压金))



.子程序 总经理发货情况, 空白型, , 总经理查询功能里关于发货清单情况查询统计
.局部变量 发货单数, 整数型, , , 
.局部变量 发货件数, 整数型, , , 
.局部变量 截留件数, 整数型, , , 
.局部变量 发货体积, 整数型, , , 
.局部变量 发货重量, 整数型, , , 
.局部变量 司机运费, 整数型, , , 
.局部变量 临时, 整数型, , , 
.局部变量 计次, 整数型, , , 

相加 (取当前目录 (), “\data\ywzhxx.mdb”).未知支持库函数_1 (“”)
.未知支持库函数_12 ()
“发货清单”.未知支持库函数_14 (2)
相加 (“制单日期 > '”, 从日期, “' and 制单日期 < '”, 到日期, “'”).未知支持库函数_47 ()
未知支持库函数_34 ()
赋值 (计次, 1)
赋值 (发货单数, .)
.计次循环首 (., 计次)
    “实发件数”.未知支持库函数_29 (临时)
    赋值 (发货件数, 相加 (发货件数, 临时))
    “截留件数”.未知支持库函数_29 (临时)
    赋值 (截留件数, 相加 (截留件数, 临时))
    “体积”.未知支持库函数_29 (临时)
    赋值 (发货体积, 相加 (发货体积, 临时))
    “重量”.未知支持库函数_29 (临时)
    赋值 (发货重量, 相加 (发货重量, 临时))
    “司机运费”.未知支持库函数_29 (临时)
    赋值 (司机运费, 相加 (司机运费, 临时))
    未知支持库函数_36 ()
.计次循环尾 ()
“”.未知支持库函数_47 ()
未知支持库函数_16 ()
未知支持库函数_3 ()
赋值 (.内容, 到文本 (发货单数))
赋值 (.内容, 到文本 (发货件数))
赋值 (.内容, 到文本 (截留件数))
赋值 (.内容, 到文本 (发货体积))
赋值 (.内容, 到文本 (发货重量))
赋值 (.内容, 到文本 (司机运费))

.子程序 总经理车辆信息, 空白型, , 总经理查询里的调度车辆相关信息查询统计
.局部变量 发货车, 整数型, , , 
.局部变量 提货车, 整数型, , , 
.局部变量 公事车, 整数型, , , 
.局部变量 公司车辆, 整数型, , , 
.局部变量 外部车辆, 整数型, , , 
.局部变量 司机, 整数型, , , 
.局部变量 a照, 整数型, , , 
.局部变量 b照, 整数型, , , 
.局部变量 c照, 整数型, , , 
.局部变量 调度次数, 整数型, , , 
.局部变量 提货票数, 整数型, , , 
.局部变量 维修次数, 整数型, , , 
.局部变量 大修次数, 整数型, , , 
.局部变量 保养次数, 整数型, , , 
.局部变量 总计费用, 整数型, , , 
.局部变量 加油次数, 整数型, , , 
.局部变量 加油量, 整数型, , , 
.局部变量 加油费, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 记录集读文本时临时存放数据
.局部变量 临时_拆分文本, 文本型, , "0", 统计提货票数时,需要拆分调度信息中的以备注字段记录的业务单号来达到
.局部变量 临时_整数, 整数型, , , 记录集读整数时临时存放数据
.局部变量 计次, 整数型, , , 循环计次

相加 (取当前目录 (), “\data\ddxx.mdb”).未知支持库函数_1 (“”)
.未知支持库函数_12 ()
“车辆信息”.未知支持库函数_14 (2)
未知支持库函数_34 ()
赋值 (计次, 1)
.计次循环首 (., 计次)
    “用途”.未知支持库函数_26 (临时_文本)
    .判断开始 (等于 (临时_文本, “发货车”))
        赋值 (发货车, 相加 (发货车, 1))
    .判断 (等于 (临时_文本, “提货车”))
        赋值 (提货车, 相加 (提货车, 1))
    .判断 (等于 (临时_文本, “公事车”))
        赋值 (公事车, 相加 (公事车, 1))
    .默认
        
    .判断结束
    “产权”.未知支持库函数_26 (临时_文本)
    .判断开始 (等于 (临时_文本, “外部车辆”))
        赋值 (外部车辆, 相加 (外部车辆, 1))
    .判断 (不等于 (临时_文本, “外部车辆”))
        赋值 (公司车辆, 相加 (公司车辆, 1))
    .默认
        
    .判断结束
    未知支持库函数_36 ()
.计次循环尾 ()
未知支持库函数_16 ()
“司机信息”.未知支持库函数_14 (2)
未知支持库函数_34 ()
赋值 (计次, 1)
赋值 (司机, .)
.计次循环首 (., 计次)
    “驾照类型”.未知支持库函数_26 (临时_文本)
    .判断开始 (等于 (临时_文本, “A照”))
        赋值 (a照, 相加 (a照, 1))
    .判断 (等于 (临时_文本, “B照”))
        赋值 (b照, 相加 (b照, 1))
    .判断 (等于 (临时_文本, “C照”))
        赋值 (c照, 相加 (c照, 1))
    .默认
        
    .判断结束
    未知支持库函数_36 ()
.计次循环尾 ()
未知支持库函数_16 ()
“调度记录”.未知支持库函数_14 (2)
相加 (“提货时间 > '”, 从日期, “' and 提货时间 < '”, 到日期, “'”).未知支持库函数_47 ()
未知支持库函数_34 ()
赋值 (计次, 1)
赋值 (调度次数, .)
.计次循环首 (., 计次)
    “业务单号”.未知支持库函数_26 (临时_文本)
    赋值 (临时_拆分文本, 分割文本 (临时_文本, “&”, ))
    赋值 (提货票数, 相加 (提货票数, 取数组成员数 (临时_拆分文本)))
    未知支持库函数_36 ()
.计次循环尾 ()
“”.未知支持库函数_47 ()
未知支持库函数_16 ()
“维修保养记录”.未知支持库函数_14 (2)
相加 (“日期 > '”, 从日期, “' and 日期 < '”, 到日期, “'”).未知支持库函数_47 ()
未知支持库函数_34 ()
赋值 (计次, 1)
.计次循环首 (., 计次)
    “事件”.未知支持库函数_26 (临时_文本)
    .判断开始 (等于 (临时_文本, “维修”))
        赋值 (维修次数, 相加 (维修次数, 1))
    .判断 (等于 (临时_文本, “大修”))
        赋值 (大修次数, 相加 (大修次数, 1))
    .判断 (等于 (临时_文本, “保养”))
        赋值 (保养次数, 相加 (保养次数, 1))
    .默认
        
    .判断结束
    “费用”.未知支持库函数_29 (临时_整数)
    赋值 (总计费用, 相加 (总计费用, 临时_整数))
    未知支持库函数_36 ()
.计次循环尾 ()
“”.未知支持库函数_47 ()
未知支持库函数_16 ()
“加油记录”.未知支持库函数_14 (2)
相加 (“日期 > '”, 从日期, “' and 日期 < '”, 到日期, “'”).未知支持库函数_47 ()
未知支持库函数_34 ()
赋值 (计次, 1)
赋值 (加油次数, .)
.计次循环首 (., 计次)
    “加油量”.未知支持库函数_29 (临时_整数)
    赋值 (加油量, 相加 (加油量, 临时_整数))
    “合计费用”.未知支持库函数_29 (临时_整数)
    赋值 (加油费, 相加 (加油费, 临时_整数))
    未知支持库函数_36 ()
.计次循环尾 ()
“”.未知支持库函数_47 ()
未知支持库函数_16 ()
未知支持库函数_3 ()
赋值 (.内容, 到文本 (发货车))
赋值 (.内容, 到文本 (提货车))
赋值 (.内容, 到文本 (公事车))
赋值 (.内容, 到文本 (公司车辆))
赋值 (.内容, 到文本 (外部车辆))
赋值 (.内容, 到文本 (司机))
赋值 (.内容, 到文本 (a照))
赋值 (.内容, 到文本 (b照))
赋值 (.内容, 到文本 (c照))
赋值 (.内容, 到文本 (调度次数))
赋值 (.内容, 到文本 (提货票数))
赋值 (.内容, 到文本 (维修次数))
赋值 (.内容, 到文本 (大修次数))
赋值 (.内容, 到文本 (保养次数))
赋值 (.内容, 到文本 (总计费用))
赋值 (.内容, 到文本 (加油次数))
赋值 (.内容, 到文本 (加油量))
赋值 (.内容, 到文本 (加油费))


.子程序 _选择框_受理_回单否_被单击, 空白型, , 
.判断开始 (等于 (.选中, 假))
    赋值 (.禁止, 真)
.判断 (等于 (.选中, 真))
    赋值 (.禁止, 假)
.默认
    
.判断结束


.子程序 _选择框_受理_计泡否_被单击, 空白型, , 
.判断开始 (等于 (.选中, 假))
    赋值 (.禁止, 真)
.判断 (等于 (.选中, 真))
    赋值 (.禁止, 假)
.默认
    
.判断结束


.子程序 _选择框_受理_代收货款否_被单击, 空白型, , 
.判断开始 (等于 (.选中, 假))
    赋值 (.禁止, 真)
.判断 (等于 (.选中, 真))
    赋值 (.禁止, 假)
.默认
    
.判断结束


.子程序 _选择框_受理_中转否_被单击, 空白型, , 
.判断开始 (等于 (.选中, 假))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.判断 (等于 (.选中, 真))
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
.默认
    
.判断结束


.子程序 _选择框_受理_派送否_被单击, 空白型, , 
.判断开始 (等于 (.选中, 假))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.判断 (等于 (.选中, 真))
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
.默认
    
.判断结束


.子程序 _选择框_受理_保险否_被单击, 空白型, , 
.判断开始 (等于 (.选中, 真))
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
.判断 (等于 (.选中, 假))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    
.默认
    
.判断结束


.子程序 _时钟_待处理检货信息刷新_周期事件, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 检货号, 文本型, , , 
.局部变量 检货时间, 日期时间型, , , 
.局部变量 货物名称, 文本型, , , 
.局部变量 实际件数, 整数型, , , 
.局部变量 实际重量, 整数型, , , 
.局部变量 实际体积, 整数型, , , 
.局部变量 计抛否, 文本型, , , 
.局部变量 计抛重量, 整数型, , , 

相加 (取当前目录 (), “\data\main.mdb”).未知支持库函数_1 (“”)
.未知支持库函数_12 ()
“检货临时库”.未知支持库函数_14 (2)
未知支持库函数_34 ()
赋值 (计次, 1)
全部删除 ()
.计次循环首 (., 计次)
    “检货号”.未知支持库函数_26 (检货号)
    “检货时间”.未知支持库函数_31 (检货时间)
    “货物名称”.未知支持库函数_26 (货物名称)
    “实际件数”.未知支持库函数_29 (实际件数)
    “实际重量”.未知支持库函数_29 (实际重量)
    “实际体积”.未知支持库函数_29 (实际体积)
    “计抛否”.未知支持库函数_26 (计抛否)
    “计抛重量”.未知支持库函数_29 (计抛重量)
     ' 超级列表框要添加一行数据得用下面这种方法,先插入表项,这个表项等于就是这一行的第一个格子的内容,从这一行的第二个格子起都用置标题来放入数据,注意:超级列表框里的首行首列都是0,不是从1开始的
    .插入表项 (“检货号”, , , , )
    相减 (计次, 1).置标题 (1, 到文本 (检货时间))
    相减 (计次, 1).置标题 (2, 货物名称)
    相减 (计次, 1).置标题 (3, 到文本 (实际件数))
    相减 (计次, 1).置标题 (4, 到文本 (实际重量))
    相减 (计次, 1).置标题 (5, 到文本 (实际体积))
    相减 (计次, 1).置标题 (6, 计抛否)
    相减 (计次, 1).置标题 (7, 到文本 (计抛重量))
    未知支持库函数_36 ()
.计次循环尾 ()
未知支持库函数_16 ()
未知支持库函数_3 ()

.子程序 _超级列表框_受理_待处理的检货信息_被双击, 逻辑型, , 双击超级列表框中的某个表项时的处理子程序
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 表项索引, 整数型, , "0", 用以返回超级列表框里当前被选择表项的索引
.局部变量 数据库连接_删除检货临时库信息, 未知类型0x70001, , , 用复制窗口组件的方法来创建一个新的数据库连接
.局部变量 记录集_删除检货临时库信息, 未知类型0x70002, , , 用复制窗口组件的方法来创建一个新的记录集,这样做是为了不使数据打开发生冲突,而且复制的组件应该会对程序速度有些好处
.局部变量 数据库连接_更新检货库, 未知类型0x70001, , , 复制窗口组件创建更新检货库用的数据库连接
.局部变量 记录集_更新检货库, 未知类型0x70002, , , 
.局部变量 检货号_临时, 文本型, , , 在双击超级列表框项目时取得的检货号,用来查询检货库中相应的记录
.局部变量 计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 查询检货中的检货号时临时存放检货号的变量

 ' 将被选择的超级列表框表项的索引值放入表项索引这个变量,方便后面用其它语句来识别双击了哪个表项及对应的数据库记录行.注意:为什么始终只用到了表项索引数组里的第一个变量呢?因为双击不可能双击到多行表项,只可能是一项
赋值 (表项索引, 取被选择表项 ())
赋值 (检货号_临时, 表项索引.取标题 ( [1], 0))
 ' 下面这个如果语句里做的工作是将被双击表项里的相关信息添加到受理录入里相应的编辑框中
.如果 (不等于 (取数组成员数 (表项索引), 0))
    赋值 (.内容, 表项索引.取标题 ( [1], 2))
    赋值 (.内容, 表项索引.取标题 ( [1], 3))
    赋值 (.内容, 表项索引.取标题 ( [1], 4))
    赋值 (.内容, 表项索引.取标题 ( [1], 5))
    .判断开始 (等于 (表项索引.取标题 ( [1], 6), “是”))
        赋值 (.选中, 真)
        赋值 (.禁止, 假)
        赋值 (.内容, 表项索引.取标题 ( [1], 7))
    .判断 (等于 (表项索引.取标题 ( [1], 6), “否”))
        赋值 (.选中, 假)
        赋值 (.禁止, 真)
    .默认
        
    .判断结束
    
.否则
    信息框 (“该表项为空!请选择有内容的表项!”, 0, )
    刷新显示 ()
    返回 ()
    
.如果结束
 ' 下面要以本次操作表项的检货号来查询更新检货库中与之对应的业务单号
复制窗口组件 (数据库连接_更新检货库)
复制窗口组件 (记录集_更新检货库)
数据库.开始查询 (数据库连接_更新检货库, 记录集_更新检货库, “main.mdb”, , “检货及仓库”, 2)
.计次循环首 (记录集_更新检货库., 计次)
    记录集_更新检货库.未知支持库函数_26 (“检货号”, 临时_文本)
    .如果真 (等于 (临时_文本, 检货号_临时))
        记录集_更新检货库.未知支持库函数_20 (“业务单号”, .内容)
    .如果真结束
    记录集_更新检货库.未知支持库函数_36 ()
.计次循环尾 ()
数据库.断开 (数据库连接_更新检货库, 记录集_更新检货库)
 ' 上面用完了超级列表框中的信息,下面就该把其对应的检货临时库里的记录删掉了
复制窗口组件 (数据库连接_删除检货临时库信息)
复制窗口组件 (记录集_删除检货临时库信息)
数据库连接_删除检货临时库信息.未知支持库函数_1 (相加 (取当前目录 (), “\data\main.mdb”), “”)
记录集_删除检货临时库信息.未知支持库函数_12 (数据库连接_删除检货临时库信息)
记录集_删除检货临时库信息.未知支持库函数_14 (“检货临时库”, 2)
记录集_删除检货临时库信息.未知支持库函数_38 (表项索引 [1])
记录集_删除检货临时库信息.未知支持库函数_19 (1)
.如果 (记录集_删除检货临时库信息.未知支持库函数_18 ())
    记录集_删除检货临时库信息.未知支持库函数_16 ()
    数据库连接_删除检货临时库信息.未知支持库函数_3 ()
    _时钟_待处理检货信息刷新_周期事件 ()
.否则
    信息框 (“删除检货临时库中与被双击列表行相关的记录失败!”, 0, )
    返回 ()
.如果结束


.子程序 _按钮_受理_委托人_被单击, 空白型, , 业务单录入里,点击委托人按钮的功能子程序
.局部变量 委托人, 文本型, , , 存放输入的委托人姓名
.局部变量 临时, 文本型, , , 临时存放数据里取出的字段值

赋值 (委托人, .内容)
.如果真 (等于 (委托人, “”))
    信息框 (“请先输入委托人的姓名.”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果 (相加 (取当前目录 (), “\data\ywzhxx.mdb”).未知支持库函数_1 (“”))
    .未知支持库函数_12 ()
    .如果 (“客户信息”.未知支持库函数_14 (2))
        未知支持库函数_34 ()
        .如果真 (相加 (“联系人='”, 委托人, “'”).未知支持库函数_45 (1))
            “单位名称”.未知支持库函数_26 (临时)
            赋值 (.内容, 临时)
            “地址”.未知支持库函数_26 (临时)
            赋值 (.内容, 临时)
            “座机号”.未知支持库函数_26 (临时)
            赋值 (.内容, 临时)
            “手机号”.未知支持库函数_26 (临时)
            赋值 (.内容, 临时)
        .如果真结束
        
    .否则
        信息框 (“打开客户信息表失败!”, 0, )
    .如果结束
    
.否则
    信息框 (“数据库连接失败!”, 0, )
.如果结束
未知支持库函数_16 ()
未知支持库函数_3 ()

.子程序 _按钮_受理_委托单位_被单击, 空白型, , 业务单录入里,点击委托单位按钮的功能子程序
.局部变量 委托单位, 文本型, , , 存放输入的委托单位姓名
.局部变量 临时, 文本型, , , 临时存放数据里取出的字段值

赋值 (委托单位, .内容)
.如果真 (等于 (委托单位, “”))
    信息框 (“请先输入委托单位的名称.”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果 (相加 (取当前目录 (), “\data\ywzhxx.mdb”).未知支持库函数_1 (“”))
    .未知支持库函数_12 ()
    .如果 (“客户信息”.未知支持库函数_14 (2))
        未知支持库函数_34 ()
        .如果真 (相加 (“单位名称='”, 委托单位, “'”).未知支持库函数_45 (1))
            “联系人”.未知支持库函数_26 (临时)
            赋值 (.内容, 临时)
            “地址”.未知支持库函数_26 (临时)
            赋值 (.内容, 临时)
            “座机号”.未知支持库函数_26 (临时)
            赋值 (.内容, 临时)
            “手机号”.未知支持库函数_26 (临时)
            赋值 (.内容, 临时)
        .如果真结束
        
    .否则
        信息框 (“打开客户信息表失败!”, 0, )
    .如果结束
    
.否则
    信息框 (“数据库连接失败!”, 0, )
.如果结束
未知支持库函数_16 ()
未知支持库函数_3 ()


.子程序 _组合框_受理_委托单位_编辑内容被改变, 空白型, , 
.局部变量 项目个数, 整数型, , , 存放委托单位组合框里的项目个数
.局部变量 计次, 整数型, , , 
.局部变量 输入值, 文本型, , , 存放当前输入的项目值
.局部变量 项目值, 文本型, , , 存放项目值

赋值 (项目个数, 取项目数 ())
赋值 (输入值, .内容)
.计次循环首 (项目个数, 计次)
    赋值 (项目值, 相减 (计次, 1).取项目文本 ())
    .如果真 (不等于 (寻找文本 (项目值, 输入值, , 假), -1))
        赋值 (.现行选中项, 相减 (计次, 1))
    .如果真结束
    
.计次循环尾 ()

.子程序 _按钮_受理_保存_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 用于子程序最后段修改客户的发货次数和最后发货日期时做循环查询用的
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 临时_日期, 日期时间型, , , 这四个变量全是用于写本次保存的业务单中委托客户信息改写用的

.如果 (相加 (取当前目录 (), “\data\main.mdb”).未知支持库函数_1 (“”))
    .未知支持库函数_12 ()
    .如果 (“业务单”.未知支持库函数_14 (2))
        未知支持库函数_17 ()
        未知支持库函数_35 ()
        .如果 (并且 (“业务单号”.未知支持库函数_20 (.内容), “发货方式”.未知支持库函数_20 (.内容), “发货类型”.未知支持库函数_20 (.内容), “实际发货单位”.未知支持库函数_20 (.内容), “结算方式”.未知支持库函数_20 (.内容), “希望到达时间”.未知支持库函数_25 (到时间 (.内容)), “到达地”.未知支持库函数_20 (.内容), “回单数”.未知支持库函数_20 (.内容), “委托人姓名”.未知支持库函数_20 (.内容), “委托单位”.未知支持库函数_20 (.内容), “委托地址”.未知支持库函数_20 (.内容), “委托电话”.未知支持库函数_20 (.内容), “委托手机”.未知支持库函数_20 (.内容), “收货人姓名”.未知支持库函数_20 (.内容), “收货单位”.未知支持库函数_20 (.内容), “收货地址”.未知支持库函数_20 (.内容), “收货电话”.未知支持库函数_20 (.内容), “收货手机”.未知支持库函数_20 (.内容), “重要提示”.未知支持库函数_20 (.), “货物名称”.未知支持库函数_20 (.内容), “原包装”.未知支持库函数_20 (.内容), “预计件数”.未知支持库函数_23 (到数值 (.内容)), “实际件数”.未知支持库函数_23 (到数值 (.内容)), “预计重量”.未知支持库函数_23 (到数值 (.内容)), “实际重量”.未知支持库函数_23 (到数值 (.内容)), “预计体积”.未知支持库函数_23 (到数值 (.内容)), “实际体积”.未知支持库函数_23 (到数值 (.内容)), “计泡重量”.未知支持库函数_23 (到数值 (.内容)), “代收货款金额”.未知支持库函数_20 (.内容), “中转单位”.未知支持库函数_20 (.内容), “中转费”.未知支持库函数_23 (到数值 (.内容)), “派送单位”.未知支持库函数_20 (.内容), “派送费”.未知支持库函数_23 (到数值 (.内容)), “保险率”.未知支持库函数_23 (到数值 (.内容)), “保险费”.未知支持库函数_23 (到数值 (.内容)), “货物声明价值”.未知支持库函数_20 (.内容), “合作公司费用”.未知支持库函数_23 (到数值 (.内容)), “实收费用”.未知支持库函数_23 (到数值 (.内容)), “运费”.未知支持库函数_23 (到数值 (.内容)), “开票人”.未知支持库函数_20 (操作员), “开票时间”.未知支持库函数_25 (取现行时间 ()))) ' 将录入的业务单信息写入数据库,好痛苦的一段代码!出了三次错,眼睛都看麻木了才改好.后来想想,根本没必要写这么长的一段来判断...一行一行写到记录集了,最后还是要更新的,更新时再作判断不就行了?整天的码代码,确实有时是想不开,脑筋累了的时候得起来走走,不然想不出好的代码
            .判断开始 (.选中) ' 下边这一串判断是写选择框的值的,最初认为在易语言里用文本代替逻辑值会更好,结果是更麻烦一些...下次一定要改
                “回单否”.未知支持库函数_20 (“是”)
            .默认
                “回单否”.未知支持库函数_20 (“否”)
            .判断结束
            
            .判断开始 (.选中)
                “计泡否”.未知支持库函数_20 (“是”)
            .默认
                “记泡否”.未知支持库函数_20 (“否”)
            .判断结束
            
            .判断开始 (.选中)
                “代收货款否”.未知支持库函数_20 (“是”)
            .默认
                “代收货款否”.未知支持库函数_20 (“否”)
            .判断结束
            
            .判断开始 (.选中)
                “中转否”.未知支持库函数_20 (“是”)
            .默认
                “中转否”.未知支持库函数_20 (“否”)
            .判断结束
            
            .判断开始 (.选中)
                “派送否”.未知支持库函数_20 (“是”)
            .默认
                “派送否”.未知支持库函数_20 (“否”)
            .判断结束
            
            .判断开始 (.选中)
                “保险否”.未知支持库函数_20 (“是”)
            .默认
                “保险否”.未知支持库函数_20 (“否”)
            .判断结束
            
            未知支持库函数_18 () ' 业务单信息更新到数据库了,就是保存好了
            信息框 (“业务单保存成功!”, 0, )
            赋值 (开业务单数, 相加 (开业务单数, 1)) ' 业务单号自动累加
            赋值 (业务单号, 文本替换 (业务单号, 相加 (相减 (9, 取文本长度 (到文本 (开业务单数))), 1), 取文本长度 (到文本 (开业务单数)), 到文本 (开业务单数)))
            未知支持库函数_16 ()
            未知支持库函数_3 ()
            数据库.开始查询 (“ywzhxx.mdb”, , “客户信息”, 2) ' 查询这次开的业务单号的委托方信息在客户库里有没有,如果有,就把它的合作次数加1,最后合作日期也改成现在,以便将来对客户信息分析统计
            .计次循环首 (., 计次)
                “单位名称”.未知支持库函数_26 (临时_文本)
                .如果 (等于 (临时_文本, .内容))
                    “累计发货次数”.未知支持库函数_29 (临时_整数)
                    赋值 (临时_整数, 相加 (临时_整数, 1))
                    “累计发货次数”.未知支持库函数_23 (临时_整数)
                    “最后发货日期”.未知支持库函数_25 (取日期 (取现行时间 ()))
                .否则
                    未知支持库函数_36 ()
                .如果结束
                
            .计次循环尾 ()
            数据库.断开 ()
            数据库.开始查询 (“main.mdb”, , “业务状态”, 2) ' 业务单保存后,本单的业务状态就是已受理,下面就要更新一下业务状态库,把业务单号加上去,并把已受理写上"是",便于查询业务单的状态
            未知支持库函数_17 ()
            未知支持库函数_35 ()
            “业务单号”.未知支持库函数_20 (.内容)
            “已受理”.未知支持库函数_20 (“是”)
            未知支持库函数_18 ()
            数据库.断开 ()
            
            清空业务单录入界面 ()
            
        .否则
            信息框 (“保存失败!”, 0, )
            未知支持库函数_16 ()
            未知支持库函数_3 ()
            返回 ()
        .如果结束
        
    .否则
        信息框 (“打开业务单表失败!”, 0, )
        未知支持库函数_16 ()
        未知支持库函数_3 ()
        返回 ()
    .如果结束
    
.否则
    信息框 (“打开数据库失败!”, 0, )
    未知支持库函数_16 ()
    未知支持库函数_3 ()
    返回 ()
.如果结束


.子程序 _主窗口_将被销毁, 空白型, , 


.子程序 清空业务单录入界面, 空白型, , 
赋值 (.内容, 业务单号)
赋值 (.现行选中项, 0)
赋值 (.现行选中项, 0)
赋值 (.内容, “”)
赋值 (.现行选中项, 0)
赋值 (.内容, 到文本 (取现行时间 ()))
赋值 (.内容, “”)
赋值 (.选中, 假)
赋值 (.内容, “”)
赋值 (.禁止, 真)
赋值 (.内容, “”)
赋值 (.现行选中项, 0)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.选中, 假)
赋值 (.内容, “”)
赋值 (.禁止, 真)
赋值 (.选中, 假)
赋值 (.内容, “”)
赋值 (.禁止, 真)
赋值 (.选中, 假)
赋值 (.内容, “”)
赋值 (.禁止, 真)
赋值 (.内容, “”)
赋值 (.禁止, 真)
赋值 (.选中, 假)
赋值 (.内容, “”)
赋值 (.禁止, 真)
赋值 (.内容, “”)
赋值 (.禁止, 真)
赋值 (.选中, 假)
赋值 (.内容, “”)
赋值 (.禁止, 真)
赋值 (.内容, “”)
赋值 (.禁止, 真)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)



.子程序 _按钮_发货清单_保存_被单击, 空白型, , 发货清单的保存分为三部分,保存文本和数值字段的值,保存表格中所有单号的值到一个字段中,保存表格文件到默认路径
.局部变量 计次, 整数型, , , 循环变量
.局部变量 计次1, 整数型, , , 写业务状态时用到,因为是二次循环嵌套,只得用两个计次
.局部变量 保存业务单号, 文本型, , , 业务单号字符相加并用&隔开
.局部变量 表格路径, 文本型, , , 
.局部变量 默认表格路径, 文本型, , , 
.局部变量 业务单号数组, 文本型, , "0", 全部的业务单号分开一个一个存在数组变量里,用于写业务状态时
.局部变量 临时_文本, 文本型, , , 取业务状态库里单号时用

赋值 (默认表格路径, 相加 (取当前目录 (), “\grd_fhqd\”))
赋值 (表格路径, 读配置项 (相加 (取当前目录 (), “\program.ini”), “发货清单项目”, “表格路径”, 默认表格路径))
相加 (取当前目录 (), “\data\ywzhxx.mdb”).未知支持库函数_1 (“”)
.未知支持库函数_12 ()
“发货清单”.未知支持库函数_14 (2)
未知支持库函数_17 ()
未知支持库函数_35 ()
“发货清单号”.未知支持库函数_20 (.内容)
“司机姓名”.未知支持库函数_20 (.内容)
“司机运费”.未知支持库函数_23 (到数值 (.内容))
“车牌号”.未知支持库函数_20 (.内容)
“制单日期”.未知支持库函数_25 (到时间 (.内容))
“实发件数”.未知支持库函数_23 (到数值 (.内容))
“截留件数”.未知支持库函数_23 (到数值 (.内容))
“重量”.未知支持库函数_23 (到数值 (.内容))
“体积”.未知支持库函数_23 (到数值 (.内容))
“表格文件路径”.未知支持库函数_20 (相加 (表格路径, .内容, “.grd”))
相加 (表格路径, .内容, “.grd”).存到文件 () ' 保存表格文件
.计次循环首 (相减 (发货清单_行, 3), 计次) ' 循环取出表格中所有的业务单号并写入到变量中,以&隔开
    赋值 (保存业务单号, 相加 (保存业务单号, 相加 (计次, 3).取文本 (1), “&”))
    加入成员 (业务单号数组, 相加 (计次, 3).取文本 (1))
.计次循环尾 ()
赋值 (保存业务单号, 取文本左边 (保存业务单号, 相减 (取文本长度 (保存业务单号), 1))) ' 还得把最后多的一个&删除
“业务单号”.未知支持库函数_20 (保存业务单号) ' 保存所有的业务单号到数据库中
.如果 (未知支持库函数_18 ())
    信息框 (“保存成功!”, 0, )
    未知支持库函数_16 ()
    未知支持库函数_3 ()
     ' 最后不能忘了把全局变量开发货清单数和发货清单号的数字加1,下次用的时候,单号就自动加了1
    赋值 (开发货清单数, 相加 (开发货清单数, 1))
    赋值 (发货清单号, 文本替换 (发货清单号, 相加 (相减 (9, 取文本长度 (到文本 (开发货清单数))), 1), 取文本长度 (到文本 (开发货清单数)), 到文本 (开发货清单数)))
    
    
    数据库.开始查询 (“main.mdb”, , “业务状态”, 2) ' 开具发货清单后,业务状态应该是已物流了,现在把已物流做上记号
    .计次循环首 (取数组成员数 (业务单号数组), 计次) ' 一票发货清单里会有多个业务单号的,有多少个业务单号就得进行多少次循环,得全部把它们的状态写进去
        .计次循环首 (., 计次1) ' 业务状态库里有多少条记录,每个单号就得查找多少次,这个循环就是做这个的,如果是人脑,已经抓狂了,幸好是电脑做
            “业务单号”.未知支持库函数_26 (临时_文本)
            .如果真 (等于 (临时_文本, 业务单号数组 [计次]))
                “已物流”.未知支持库函数_20 (“是”)
                跳出循环 ()
            .如果真结束
            未知支持库函数_36 ()
        .计次循环尾 ()
    .计次循环尾 ()
    未知支持库函数_18 () ' 全部写完了就更新保存
    数据库.断开 ()
    
    
    清空发货清单录入界面 ()
    
.否则
    信息框 (“保存失败!”, 0, )
    数据库.断开 ()
    返回 ()
.如果结束
 ' 最后不能忘了把出库临时表中的记录清空
数据库.开始查询 (“main.mdb”, , “出库临时表”, 2)
3.未知支持库函数_19 ()
未知支持库函数_18 ()
数据库.断开 ()


.子程序 清空发货清单录入界面, 空白型, , 
赋值 (.内容, 发货清单号)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, 相加 (到文本 (取日期 (取现行时间 ())), 到文本 (取小时 (取现行时间 ())), “点”))
4.删除行 (相减 (发货清单_行, 3))



.子程序 _编辑框_受理_业务单号_失去焦点, 空白型, , 
.如果 (等于 (.内容, “”))
    信息框 (“业务单号不能为空!请务必填写!”, 0, )
    获取焦点 ()
    返回 ()
    
.否则
    
.如果结束


.子程序 _编辑框_受理_收货地址_失去焦点, 空白型, , 
.如果 (等于 (.内容, “”))
    信息框 (“收货地址不能为空!请务必填写!”, 0, )
    获取焦点 ()
    返回 ()
.否则
    
.如果结束


.子程序 _编辑框_受理_实收费用_内容被改变, 空白型, , 
赋值 (.内容, 数值到金额 (到数值 (.内容), 假))

.子程序 _按钮_受理_清空重写_被单击, 空白型, , 
清空业务单录入界面 ()

.子程序 _按钮_受理_打印_被单击, 空白型, , 
相加 (取当前目录 (), “\grd\ywd_dy.grd”).从文件读 ()
3.置文本 (3, .内容)
3.置文本 (5, .内容)
3.置文本 (7, .内容)
3.置文本 (9, .内容)
3.置文本 (11, .内容)
4.置文本 (3, .内容)
4.置文本 (5, .内容)
4.置文本 (7, .内容)
4.置文本 (9, .内容)
4.置文本 (11, .内容)
6.置文本 (3, .内容)
7.置文本 (3, .内容)
8.置文本 (3, .内容)
9.置文本 (3, .内容)
10.置文本 (3, .内容)
6.置文本 (8, .内容)
7.置文本 (8, .内容)
8.置文本 (8, .内容)
9.置文本 (8, .内容)
10.置文本 (8, .内容)
12.置文本 (3, .内容)
12.置文本 (6, .内容)
12.置文本 (9, .内容)
12.置文本 (11, .内容)
13.置文本 (3, .内容)
13.置文本 (7, .内容)
13.置文本 (10, .内容)
15.置文本 (3, .)
17.置文本 (4, 操作员)
17.置文本 (10, 到文本 (取现行时间 ()))
打印预览 ()

.子程序 _按钮_发货清单_获取当日出货清单_被单击, 空白型, , 获取出库临时表中的当日出库货物信息到发货清单中
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_文本1, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 计次1, 整数型, , , 
.局部变量 计次2, 整数型, , , 
.局部变量 记录数量, 整数型, , , 
.局部变量 过滤条件, 文本型, , , 
.局部变量 临时_业务单号, 文本型, , , 

.如果 (大于 (发货清单_行, 3))
    4.跳到 ()
    4.删除行 (相减 (发货清单_行, 3))
    赋值 (发货清单_行, 3)
.否则
    
.如果结束
相加 (取当前目录 (), “\data\main.mdb”).未知支持库函数_1 (“”)
.未知支持库函数_12 ()
“出库临时表”.未知支持库函数_14 (2)
未知支持库函数_34 ()
赋值 (记录数量, .)
赋值 (自动添加行数, .)
赋值 (.数据源, “”)
.计次循环首 (., 计次1)
    1.添加行 ()
    赋值 (发货清单_行, 相加 (发货清单_行, 1))
    发货清单_行.跳到 ()
    发货清单_行.置行高 (100)
    发货清单_行.加线条 (1, 1, 27, 相加 (#左边框, #上边框, #右边框, #下边框, #垂直线))
    发货清单_行.合并 (4, 1, 3)
    发货清单_行.合并 (7, 1, 2)
    发货清单_行.合并 (10, 1, 2)
    发货清单_行.合并 (12, 1, 3)
    发货清单_行.合并 (15, 1, 5)
    发货清单_行.合并 (20, 1, 5)
    发货清单_行.合并 (25, 1, 2)
    “业务单号”.未知支持库函数_26 (临时_文本)
    相加 (计次1, 3).置文本 (1, 临时_文本)
    “货物名称”.未知支持库函数_26 (临时_文本)
    相加 (计次1, 3).置文本 (2, 临时_文本)
    “件数”.未知支持库函数_29 (临时_整数)
    相加 (计次1, 3).置文本 (3, 到文本 (临时_整数))
    “截留件数”.未知支持库函数_29 (临时_整数)
    相加 (计次1, 3).置文本 (4, 到文本 (临时_整数))
    “重量”.未知支持库函数_29 (临时_整数)
    相加 (计次1, 3).置文本 (7, 到文本 (临时_整数))
    “体积”.未知支持库函数_29 (临时_整数)
    相加 (计次1, 3).置文本 (9, 到文本 (临时_整数))
    未知支持库函数_36 ()
.计次循环尾 ()

未知支持库函数_16 ()

“业务单”.未知支持库函数_14 (2)
.计次循环首 (记录数量, 计次1)
    未知支持库函数_34 ()
    赋值 (临时_业务单号, 相加 (计次1, 3).取文本 (1))
    .计次循环首 (., 计次2)
        “业务单号”.未知支持库函数_26 (临时_文本)
        .如果 (等于 (临时_业务单号, 临时_文本))
            “收货人姓名”.未知支持库函数_26 (临时_文本)
            相加 (计次1, 3).置文本 (10, 临时_文本)
            “收货单位”.未知支持库函数_26 (临时_文本)
            相加 (计次1, 3).置文本 (12, 临时_文本)
            “收货地址”.未知支持库函数_26 (临时_文本)
            相加 (计次1, 3).置文本 (15, 临时_文本)
            “收货电话”.未知支持库函数_26 (临时_文本)
            “收货手机”.未知支持库函数_26 (临时_文本1)
            相加 (计次1, 3).置文本 (20, 相加 (临时_文本, #换行符, 临时_文本1))
            “代收货款”.未知支持库函数_26 (临时_文本)
            相加 (计次1, 3).置文本 (25, 临时_文本)
            “结算方式”.未知支持库函数_26 (临时_文本)
            相加 (计次1, 3).置文本 (27, 临时_文本)
            未知支持库函数_36 ()
        .否则
            未知支持库函数_36 ()
        .如果结束
        
    .计次循环尾 ()
.计次循环尾 ()
未知支持库函数_16 ()
未知支持库函数_3 ()
2.置文本 (2, .内容)
2.置文本 (5, .内容)
2.置文本 (11, .内容)
2.置文本 (14, .内容)
2.置文本 (19, .内容)
赋值 (.数据源, “数据源_发货清单录入”)


.子程序 _按钮_发货清单_手动添加行_被单击, 空白型, , 
.局部变量 过滤条件, 文本型, , , 
.局部变量 计次1, 整数型, , , 
.局部变量 计次2, 整数型, , , 
.局部变量 临时_业务单号, 文本型, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_文本1, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 

相加 (取当前目录 (), “\data\main.mdb”).未知支持库函数_1 (“”)
.未知支持库函数_12 ()
“业务单”.未知支持库函数_14 (2)
赋值 (过滤条件, 相加 (“开票时间 > '”, 到文本 (增减时间 (取日期 (取现行时间 ()), #日, -3)), “'”))
过滤条件.未知支持库函数_47 ()
.计次循环首 (手动添加行数, 计次1)
    未知支持库函数_34 ()
    赋值 (临时_业务单号, 相加 (相减 (发货清单_行, 手动添加行数), 计次1).取文本 (1))
    .计次循环首 (., 计次2)
        “业务单号”.未知支持库函数_26 (临时_文本)
        .如果 (等于 (到大写 (临时_业务单号), 临时_文本))
            “货物名称”.未知支持库函数_26 (临时_文本)
            相加 (相减 (发货清单_行, 手动添加行数), 计次1).置文本 (2, 临时_文本)
            “实际件数”.未知支持库函数_29 (临时_整数)
            相加 (相减 (发货清单_行, 手动添加行数), 计次1).置文本 (3, 到文本 (临时_整数))
            “截留件数”.未知支持库函数_29 (临时_整数)
            相加 (相减 (发货清单_行, 手动添加行数), 计次1).置文本 (4, 到文本 (临时_整数))
            “实际重量”.未知支持库函数_29 (临时_整数)
            相加 (相减 (发货清单_行, 手动添加行数), 计次1).置文本 (7, 到文本 (临时_整数))
            “实际体积”.未知支持库函数_29 (临时_整数)
            相加 (相减 (发货清单_行, 手动添加行数), 计次1).置文本 (9, 到文本 (临时_整数))
            “收货人姓名”.未知支持库函数_26 (临时_文本)
            相加 (相减 (发货清单_行, 手动添加行数), 计次1).置文本 (10, 临时_文本)
            “收货单位”.未知支持库函数_26 (临时_文本)
            相加 (相减 (发货清单_行, 手动添加行数), 计次1).置文本 (12, 临时_文本)
            “收货地址”.未知支持库函数_26 (临时_文本)
            相加 (相减 (发货清单_行, 手动添加行数), 计次1).置文本 (15, 临时_文本)
            “收货电话”.未知支持库函数_26 (临时_文本)
            “收货手机”.未知支持库函数_26 (临时_文本1)
            相加 (相减 (发货清单_行, 手动添加行数), 计次1).置文本 (20, 相加 (临时_文本, #换行符, 临时_文本1))
            “代收货款”.未知支持库函数_26 (临时_文本)
            相加 (相减 (发货清单_行, 手动添加行数), 计次1).置文本 (25, 临时_文本)
            “结算方式”.未知支持库函数_26 (临时_文本)
            相加 (相减 (发货清单_行, 手动添加行数), 计次1).置文本 (27, 临时_文本)
            未知支持库函数_36 ()
        .否则
            未知支持库函数_36 ()
        .如果结束
        
    .计次循环尾 ()
.计次循环尾 ()
“”.未知支持库函数_47 ()
未知支持库函数_16 ()
未知支持库函数_3 ()


.子程序 _按钮_发货清单_添加行_被单击, 空白型, , 
发货清单_添加空行 ()

.子程序 _按钮_发货清单_统计_被单击, 空白型, , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 计次, 整数型, , , 

.计次循环首 (相减 (发货清单_行, 3), 计次)
    赋值 (临时_整数, 相加 (临时_整数, 到数值 (相加 (计次, 3).取文本 (3))))
.计次循环尾 ()
赋值 (.内容, 到文本 (临时_整数))
.计次循环首 (相减 (发货清单_行, 3), 计次)
    赋值 (临时_整数, 相加 (临时_整数, 到数值 (相加 (计次, 3).取文本 (4))))
.计次循环尾 ()
赋值 (.内容, 到文本 (临时_整数))
.计次循环首 (相减 (发货清单_行, 3), 计次)
    赋值 (临时_整数, 相加 (临时_整数, 到数值 (相加 (计次, 3).取文本 (7))))
.计次循环尾 ()
赋值 (.内容, 到文本 (临时_整数))
.计次循环首 (相减 (发货清单_行, 3), 计次)
    赋值 (临时_整数, 相加 (临时_整数, 到数值 (相加 (计次, 3).取文本 (9))))
.计次循环尾 ()
赋值 (.内容, 到文本 (临时_整数))


.子程序 _按钮_发货清单_打印_被单击, 空白型, , 
真.打印 (“发货清单打印”)

.子程序 _按钮_发货清单_删除行_被单击, 空白型, , 
取光标行号 ().删除行 (1)
赋值 (发货清单_行, 相减 (发货清单_行, 1))

.子程序 _按钮_发货清单查询_查询_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 

清空 ()
数据库.开始查询 (“ywzhxx.mdb”, , “发货清单”, 2)
.判断开始 (等于 (.选中, 真))
    .如果 (等于 (.内容, “”))
        信息框 (“请输入要查找的业务单号.”, 0, )
        返回 ()
    .否则
        
        未知支持库函数_34 ()
        .计次循环首 (., 计次)
            “业务单号”.未知支持库函数_26 (临时_文本)
            .如果 (不等于 (寻找文本 (临时_文本, .内容, , 真), -1))
                “发货清单号”.未知支持库函数_26 (临时_文本)
                临时_文本.加入项目 ()
                未知支持库函数_36 ()
            .否则
                未知支持库函数_36 ()
            .如果结束
            
        .计次循环尾 ()
        
    .如果结束
    
.判断 (等于 (.选中, 真))
    .如果 (等于 (.内容, “”))
        信息框 (“请输入要查找的发货清单号.”, 0, )
        返回 ()
    .否则
        赋值 (过滤条件, 相加 (“发货清单号 = '”, .内容, “'”))
    .如果结束
    
.判断 (等于 (.选中, 真))
    .如果 (并且 (等于 (.内容, “”), 等于 (.内容, “”)))
        信息框 (“请输入要查找的制单日期范围.”, 0, )
        返回 ()
    .否则
        赋值 (过滤条件, 相加 (“制单日期 > '”, .内容, “' and  制单日期 < '”, .内容, “'”))
    .如果结束
    
.默认
    
.判断结束
过滤条件.未知支持库函数_47 ()
未知支持库函数_34 ()
.如果真 (小于 (., 1))
    信息框 (“您要查询的记录不存在!请重新定义查询条件后再次查询.”, 0, )
    数据库.断开 ()
    返回 ()
.如果真结束
.计次循环首 (., 计次)
    “发货清单号”.未知支持库函数_26 (临时_文本)
    临时_文本.加入项目 ()
    未知支持库函数_36 ()
.计次循环尾 ()
赋值 (.可视, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)


.子程序 _列表框_发货清单查询_结果_双击选择, 空白型, , 
.局部变量 列表项索引值, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 临时_日期, 日期时间型, , , 

赋值 (列表项索引值, .现行选中项)
列表项索引值.未知支持库函数_38 ()
“发货清单号”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“司机姓名”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“司机运费”.未知支持库函数_29 (临时_整数)
赋值 (.内容, 到文本 (临时_整数))
“车牌号”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“制单日期”.未知支持库函数_31 (临时_日期)
赋值 (.内容, 到文本 (临时_日期))
“实发件数”.未知支持库函数_29 (临时_整数)
赋值 (.内容, 到文本 (临时_整数))
“截留件数”.未知支持库函数_29 (临时_整数)
赋值 (.内容, 到文本 (临时_整数))
“重量”.未知支持库函数_29 (临时_整数)
赋值 (.内容, 到文本 (临时_整数))
“体积”.未知支持库函数_29 (临时_整数)
赋值 (.内容, 到文本 (临时_整数))
“表格文件路径”.未知支持库函数_26 (临时_文本)
临时_文本.从文件读 ()
刷新显示 ()

.子程序 _按钮_查询清单结果关闭_被单击, 空白型, , 
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.可视, 假)
数据库.断开 ()

.子程序 _按钮_职员信息_保存_被单击, 空白型, , 
.局部变量 数据库连接_职员保存, 未知类型0x70001, , , 
.局部变量 记录集_职员保存, 未知类型0x70002, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请输入该职员的姓名!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束

复制窗口组件 (数据库连接_职员保存)
复制窗口组件 (记录集_职员保存)
.如果真 (取反 (数据库连接_职员保存.未知支持库函数_1 (相加 (取当前目录 (), “\data\rzhq.mdb”), “”)))
    信息框 (“打开数据库失败!”, 0, )
    返回 ()
.如果真结束
记录集_职员保存.未知支持库函数_12 (数据库连接_职员保存)
.如果真 (取反 (记录集_职员保存.未知支持库函数_14 (“职员表”, 2)))
    信息框 (“打开数据表失败!”, 0, )
    数据库连接_职员保存.未知支持库函数_3 ()
    返回 ()
.如果真结束
记录集_职员保存.未知支持库函数_47 (相加 (“姓名 = '”, .内容, “'”))
.如果真 (大于或等于 (记录集_职员保存., 1))
    信息框 (“该职员信息已经存在!不能重复录入.”, 0, )
    记录集_职员保存.未知支持库函数_47 (“”)
    记录集_职员保存.未知支持库函数_16 ()
    数据库连接_职员保存.未知支持库函数_3 ()
    获取焦点 ()
    返回 ()
.如果真结束
记录集_职员保存.未知支持库函数_47 (“”)
记录集_职员保存.未知支持库函数_17 ()
记录集_职员保存.未知支持库函数_20 (“姓名”, .内容)
记录集_职员保存.未知支持库函数_20 (“性别”, .内容)
记录集_职员保存.未知支持库函数_25 (“出生日期”, 到时间 (.内容))
记录集_职员保存.未知支持库函数_20 (“专业”, .内容)
记录集_职员保存.未知支持库函数_20 (“学历”, .内容)
记录集_职员保存.未知支持库函数_20 (“婚姻状况”, .内容)
记录集_职员保存.未知支持库函数_20 (“身份证号”, .内容)
记录集_职员保存.未知支持库函数_20 (“籍贯”, .内容)
记录集_职员保存.未知支持库函数_20 (“毕业院校”, .内容)
记录集_职员保存.未知支持库函数_20 (“兴趣爱好”, .内容)
记录集_职员保存.未知支持库函数_20 (“电话”, .内容)
记录集_职员保存.未知支持库函数_20 (“照片”, 职员信息_图片文件存放路径)
记录集_职员保存.未知支持库函数_20 (“家庭成员”, .内容)
记录集_职员保存.未知支持库函数_20 (“工作经历”, .内容)
记录集_职员保存.未知支持库函数_20 (“物流行业经验”, .内容)
记录集_职员保存.未知支持库函数_20 (“离职原因”, .内容)
记录集_职员保存.未知支持库函数_20 (“所属部门”, .内容)
记录集_职员保存.未知支持库函数_20 (“当前职务”, .内容)
记录集_职员保存.未知支持库函数_20 (“升迁记录”, .内容)
记录集_职员保存.未知支持库函数_20 (“调岗记录”, .内容)
记录集_职员保存.未知支持库函数_20 (“特殊贡献”, .内容)
记录集_职员保存.未知支持库函数_20 (“奖励记录”, .内容)
记录集_职员保存.未知支持库函数_20 (“处罚记录”, .内容)
记录集_职员保存.未知支持库函数_20 (“同事关系”, .内容)
记录集_职员保存.未知支持库函数_20 (“企业忠诚度”, .内容)
记录集_职员保存.未知支持库函数_25 (“入司日期”, 到时间 (.内容))
记录集_职员保存.未知支持库函数_20 (“在职状态”, .内容)
记录集_职员保存.未知支持库函数_20 (“上级评语”, .内容)
.如果 (记录集_职员保存.未知支持库函数_18 ())
    信息框 (“保存成功!”, 0, )
.否则
    信息框 (“保存失败!”, 0, )
.如果结束
记录集_职员保存.未知支持库函数_16 ()
数据库连接_职员保存.未知支持库函数_3 ()
赋值 (.内容, “”)
赋值 (.内容, “男”)
赋值 (.内容, 到文本 (增减时间 (取日期 (取现行时间 ()), #年份, -25)))
赋值 (.内容, “”)
赋值 (.现行选中项, 0)
赋值 (.现行选中项, 1)
清空职员录入界面 ()


.子程序 清空职员录入界面, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.现行选中项, 0)
赋值 (.现行选中项, 0)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.现行选中项, 0)
赋值 (.现行选中项, 0)
赋值 (.内容, 到文本 (取日期 (取现行时间 ())))
赋值 (.现行选中项, 0)
赋值 (.内容, “”)


.子程序 _编辑框_职员信息_性别_内容被改变, 空白型, , 
.局部变量 打开文件号, 整数型, , , 

.判断开始 (等于 (.内容, “男”))
    赋值 (打开文件号, 打开文件 (相加 (取当前目录 (), “\pic\空头像\男.jpg”), , ))
    赋值 (.图片, 读入字节集 (打开文件号, 3123))
    关闭文件 (打开文件号)
    赋值 (职员信息_图片文件存放路径, 相加 (取当前目录 (), “\pic\空头像\男.jpg”))
.判断 (等于 (.内容, “女”))
    赋值 (打开文件号, 打开文件 (相加 (取当前目录 (), “\pic\空头像\女.jpg”), , ))
    赋值 (.图片, 读入字节集 (打开文件号, 3071))
    关闭文件 (打开文件号)
    赋值 (职员信息_图片文件存放路径, 相加 (取当前目录 (), “\pic\空头像\女.jpg”))
    
.默认
    
.判断结束


.子程序 _按钮_职员信息_开始查询_被单击, 空白型, , 
.局部变量 查询条件, 文本型, , , 
.局部变量 数据库连接_职员查询, 未知类型0x70001, , , 
.局部变量 记录集_职员查询, 未知类型0x70002, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_日期, 日期时间型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 数据库连接_职员修改, 未知类型0x70001, , , 
.局部变量 记录集_职员修改, 未知类型0x70002, , , 

.判断开始 (等于 (.标题, “开始查询”)) ' 开始查询这个按钮是两用的,用按钮的标题来判断是查询还是修改功能,如果是查询功能,就执行下面的程序行,直到下一个判断语句为止.
    清除数组 (职员查询_记录号) ' 每次点击查询按钮,都先把职员查询_记录号这个数组变量的值全部清空,以名查询多次的时候记录号出错.
    全部删除 () ' 超级列表框里的信息也要全部清空,不然的话,多查询几次也会使列表框中的信息重复.
    .如果真 (并且 (等于 (.选中, 真), 等于 (.内容, “”))) ' 如果选中了姓名作为查询条件,那么输入待查询姓名的编辑框也必须要输入内容,不然查询会出错误的.
        信息框 (“请输入要查找的职员姓名!”, 0, )
        获取焦点 ()
        返回 ()
    .如果真结束
    .如果真 (并且 (等于 (.选中, 真), 等于 (.内容, “”)))
        信息框 (“请输入要查找的部门名称!”, 0, )
        获取焦点 ()
        返回 ()
    .如果真结束
    .如果真 (并且 (等于 (.选中, 真), 等于 (.内容, “”)))
        信息框 (“请输入要查找的职务!”, 0, )
        获取焦点 ()
        返回 ()
    .如果真结束
    .判断开始 (等于 (.选中, 真))
        赋值 (查询条件, 相加 (“姓名 = '”, .内容, “'”))
    .判断 (等于 (.选中, 真))
        赋值 (查询条件, 相加 (“所属部门 = '”, .内容, “'”))
    .判断 (等于 (.选中, 真))
        赋值 (查询条件, 相加 (“当前职务 = '”, .内容, “'”))
    .默认
        
    .判断结束
    复制窗口组件 (数据库连接_职员查询)
    复制窗口组件 (记录集_职员查询)
    .如果真 (取反 (数据库连接_职员查询.未知支持库函数_1 (相加 (取当前目录 (), “\data\rzhq.mdb”), “”)))
        信息框 (“连接数据库失败!”, 0, )
        返回 ()
    .如果真结束
    记录集_职员查询.未知支持库函数_12 (数据库连接_职员查询)
    .如果真 (取反 (记录集_职员查询.未知支持库函数_14 (“职员表”, 2)))
        信息框 (“打开数据表失败!”, 0, )
        数据库连接_职员查询.未知支持库函数_3 ()
        返回 ()
    .如果真结束
    记录集_职员查询.未知支持库函数_47 (查询条件)
    .如果真 (小于 (记录集_职员查询., 1))
        信息框 (“没有找到您要的信息!”, 0, )
        记录集_职员查询.未知支持库函数_47 (“”)
        记录集_职员查询.未知支持库函数_16 ()
        数据库连接_职员查询.未知支持库函数_3 ()
        赋值 (.标题, “开始查询”)
    .如果真结束
    记录集_职员查询.未知支持库函数_34 ()
    .计次循环首 (记录集_职员查询., 计次)
        记录集_职员查询.未知支持库函数_26 (“姓名”, 临时_文本)
        .插入表项 (临时_文本, , , , )
        记录集_职员查询.未知支持库函数_26 (“性别”, 临时_文本)
        相减 (计次, 1).置标题 (1, 临时_文本)
        记录集_职员查询.未知支持库函数_31 (“出生日期”, 临时_日期)
        相减 (计次, 1).置标题 (2, 到文本 (取时间间隔 (取现行时间 (), 临时_日期, #年份)))
        记录集_职员查询.未知支持库函数_26 (“当前职务”, 临时_文本)
        相减 (计次, 1).置标题 (3, 临时_文本)
        记录集_职员查询.未知支持库函数_26 (“所属部门”, 临时_文本)
        相减 (计次, 1).置标题 (4, 临时_文本)
        记录集_职员查询.未知支持库函数_31 (“入司日期”, 临时_日期)
        相减 (计次, 1).置标题 (5, 到文本 (临时_日期))
        记录集_职员查询.未知支持库函数_26 (“学历”, 临时_文本)
        相减 (计次, 1).置标题 (6, 临时_文本)
        记录集_职员查询.未知支持库函数_26 (“专业”, 临时_文本)
        相减 (计次, 1).置标题 (7, 临时_文本)
        记录集_职员查询.未知支持库函数_26 (“物流行业经验”, 临时_文本)
        相减 (计次, 1).置标题 (8, 临时_文本)
        加入成员 (职员查询_记录号, 记录集_职员查询.)
        记录集_职员查询.未知支持库函数_36 ()
    .计次循环尾 ()
    记录集_职员查询.未知支持库函数_47 (“”)
    记录集_职员查询.未知支持库函数_16 ()
    数据库连接_职员查询.未知支持库函数_3 ()
    
    赋值 (.标题, “修  改”)
    赋值 (.禁止, 真)
    
.判断 (等于 (.标题, “修  改”))
    复制窗口组件 (数据库连接_职员修改)
    复制窗口组件 (记录集_职员修改)
    数据库.开始查询 (数据库连接_职员修改, 记录集_职员修改, “rzhq.mdb”, , “职员表”, 2)
    赋值 (职员信息当前修改项_记录号, 相加 (职员信息当前修改项_记录号, 1))
    记录集_职员修改.未知支持库函数_38 (职员查询_记录号 [职员信息当前修改项_记录号])
    记录集_职员修改.未知支持库函数_20 (“姓名”, .内容)
    记录集_职员修改.未知支持库函数_20 (“性别”, .内容)
    记录集_职员修改.未知支持库函数_25 (“出生日期”, 到时间 (.内容))
    记录集_职员修改.未知支持库函数_20 (“专业”, .内容)
    记录集_职员修改.未知支持库函数_20 (“学历”, .内容)
    记录集_职员修改.未知支持库函数_20 (“婚姻状况”, .内容)
    记录集_职员修改.未知支持库函数_20 (“身份证号”, .内容)
    记录集_职员修改.未知支持库函数_20 (“籍贯”, .内容)
    记录集_职员修改.未知支持库函数_20 (“毕业院校”, .内容)
    记录集_职员修改.未知支持库函数_20 (“兴趣爱好”, .内容)
    记录集_职员修改.未知支持库函数_20 (“电话”, .内容)
    记录集_职员修改.未知支持库函数_20 (“照片”, 职员信息_图片文件存放路径)
    记录集_职员修改.未知支持库函数_20 (“家庭成员”, .内容)
    记录集_职员修改.未知支持库函数_20 (“工作经历”, .内容)
    记录集_职员修改.未知支持库函数_20 (“物流行业经验”, .内容)
    记录集_职员修改.未知支持库函数_20 (“离职原因”, .内容)
    记录集_职员修改.未知支持库函数_20 (“所属部门”, .内容)
    记录集_职员修改.未知支持库函数_20 (“当前职务”, .内容)
    记录集_职员修改.未知支持库函数_20 (“升迁记录”, .内容)
    记录集_职员修改.未知支持库函数_20 (“调岗记录”, .内容)
    记录集_职员修改.未知支持库函数_20 (“特殊贡献”, .内容)
    记录集_职员修改.未知支持库函数_20 (“奖励记录”, .内容)
    记录集_职员修改.未知支持库函数_20 (“处罚记录”, .内容)
    记录集_职员修改.未知支持库函数_20 (“同事关系”, .内容)
    记录集_职员修改.未知支持库函数_20 (“企业忠诚度”, .内容)
    记录集_职员修改.未知支持库函数_25 (“入司日期”, 到时间 (.内容))
    记录集_职员修改.未知支持库函数_20 (“在职状态”, .内容)
    记录集_职员修改.未知支持库函数_20 (“上级评语”, .内容)
    .如果 (记录集_职员修改.未知支持库函数_18 ())
        信息框 (“修改成功!”, 0, )
    .否则
        信息框 (“修改失败!”, 0, )
    .如果结束
    数据库.断开 (数据库连接_职员修改, 记录集_职员修改)
    赋值 (.标题, “开始查询”)
    赋值 (.禁止, 假)
.默认
    
.判断结束


.子程序 _超级列表框_职员信息_职员查询列表_左键单击表项, 空白型, , 
.局部变量 数据库连接_职员查询_详细信息, 未知类型0x70001, , , 
.局部变量 记录集_职员查询_详细信息, 未知类型0x70002, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_日期, 日期时间型, , , 
.局部变量 当前记录号, 整数型, , , 
.局部变量 照片, 字节集, , , 
.局部变量 照片_文件号, 整数型, , , 

.如果真 (等于 (., -1))
    返回 ()
.如果真结束
复制窗口组件 (数据库连接_职员查询_详细信息)
复制窗口组件 (记录集_职员查询_详细信息)
数据库连接_职员查询_详细信息.未知支持库函数_1 (相加 (取当前目录 (), “\data\rzhq.mdb”), “”)
记录集_职员查询_详细信息.未知支持库函数_12 (数据库连接_职员查询_详细信息)
记录集_职员查询_详细信息.未知支持库函数_14 (“职员表”, 2)
赋值 (当前记录号, 相加 (., 1))
记录集_职员查询_详细信息.未知支持库函数_38 (职员查询_记录号 [当前记录号])
记录集_职员查询_详细信息.未知支持库函数_26 (“姓名”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_职员查询_详细信息.未知支持库函数_26 (“性别”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_职员查询_详细信息.未知支持库函数_31 (“出生日期”, 临时_日期)
赋值 (.内容, 到文本 (临时_日期))
记录集_职员查询_详细信息.未知支持库函数_26 (“专业”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_职员查询_详细信息.未知支持库函数_26 (“学历”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_职员查询_详细信息.未知支持库函数_26 (“婚姻状况”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_职员查询_详细信息.未知支持库函数_26 (“身份证号”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_职员查询_详细信息.未知支持库函数_26 (“籍贯”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_职员查询_详细信息.未知支持库函数_26 (“毕业院校”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_职员查询_详细信息.未知支持库函数_26 (“兴趣爱好”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_职员查询_详细信息.未知支持库函数_26 (“电话”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_职员查询_详细信息.未知支持库函数_26 (“照片”, 临时_文本)
赋值 (当前员工照片路径, 临时_文本)
赋值 (照片_文件号, 打开文件 (临时_文本, , ))
赋值 (照片, 读入字节集 (照片_文件号, 取文件长度 (照片_文件号)))
赋值 (.图片, 照片)
记录集_职员查询_详细信息.未知支持库函数_26 (“家庭成员”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_职员查询_详细信息.未知支持库函数_26 (“工作经历”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_职员查询_详细信息.未知支持库函数_26 (“物流行业经验”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_职员查询_详细信息.未知支持库函数_26 (“离职原因”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_职员查询_详细信息.未知支持库函数_26 (“所属部门”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_职员查询_详细信息.未知支持库函数_26 (“当前职务”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_职员查询_详细信息.未知支持库函数_26 (“升迁记录”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_职员查询_详细信息.未知支持库函数_26 (“调岗记录”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_职员查询_详细信息.未知支持库函数_26 (“特殊贡献”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_职员查询_详细信息.未知支持库函数_26 (“奖励记录”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_职员查询_详细信息.未知支持库函数_26 (“处罚记录”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_职员查询_详细信息.未知支持库函数_26 (“同事关系”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_职员查询_详细信息.未知支持库函数_26 (“企业忠诚度”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_职员查询_详细信息.未知支持库函数_31 (“入司日期”, 临时_日期)
赋值 (.内容, 到文本 (临时_日期))
记录集_职员查询_详细信息.未知支持库函数_26 (“在职状态”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_职员查询_详细信息.未知支持库函数_26 (“上级评语”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_职员查询_详细信息.未知支持库函数_16 ()
数据库连接_职员查询_详细信息.未知支持库函数_3 ()
赋值 (职员信息当前修改项_记录号, .)

.子程序 _按钮_职员信息_打印空白应聘表_被单击, 空白型, , 
.局部变量 打印份数, 整数型, , , 

输入框 (“请输入要打印的份数:”, “打印空白应聘表”, “1”, 打印份数, 2)
未知支持库函数_0 ()
.未知支持库函数_5 (假)
相加 (取当前目录 (), “\doc\应聘表模板.doc”).未知支持库函数_12 ()
假.未知支持库函数_16 (假, 2, “”, “1”, “1”, 0, 打印份数, “”, 0, 假, 假, 1, 1, 0, 0)
未知支持库函数_6 ()
未知支持库函数_1 ()

.子程序 _按钮_职员信息_打印员工信息_被单击, 空白型, , 
.局部变量 表格接口, 未知类型0xC0005, , , 

相加 (取当前目录 (), “\grd\职员信息表_模板.ewd”).未知支持库函数_0 ()
赋值 (表格接口, 未知支持库函数_138 ())

表格接口.未知支持库函数_192 (“姓名”, .内容)
表格接口.未知支持库函数_192 (“性别”, “男”)
表格接口.未知支持库函数_192 (“出生日期”, “1974年02月10日”)
表格接口.未知支持库函数_195 (“照片”, 当前员工照片路径)
表格接口.未知支持库函数_192 (“婚姻状况”, .内容)
表格接口.未知支持库函数_192 (“籍贯”, .内容)
表格接口.未知支持库函数_192 (“身份证号”, .内容)
表格接口.未知支持库函数_192 (“电话”, .内容)
表格接口.未知支持库函数_192 (“兴趣爱好”, .内容)
表格接口.未知支持库函数_192 (“家庭成员”, .内容)
表格接口.未知支持库函数_192 (“毕业院校”, .内容)
表格接口.未知支持库函数_192 (“学历”, .内容)
表格接口.未知支持库函数_192 (“专业”, .内容)
表格接口.未知支持库函数_192 (“工作经历”, .内容)
表格接口.未知支持库函数_192 (“物流行业经验”, .内容)
表格接口.未知支持库函数_192 (“离职原因”, .内容)
表格接口.未知支持库函数_192 (“职务”, .内容)
表格接口.未知支持库函数_192 (“部门”, .内容)
表格接口.未知支持库函数_192 (“入司日期”, .内容)
表格接口.未知支持库函数_192 (“在职状态”, .内容)
表格接口.未知支持库函数_192 (“企业忠诚度”, .内容)
表格接口.未知支持库函数_192 (“同事关系”, .内容)
表格接口.未知支持库函数_192 (“升迁记录”, .内容)
表格接口.未知支持库函数_192 (“调岗记录”, .内容)
表格接口.未知支持库函数_192 (“特殊贡献”, .内容)
表格接口.未知支持库函数_192 (“奖励记录”, .内容)
表格接口.未知支持库函数_192 (“处罚记录”, .内容)
表格接口.未知支持库函数_192 (“上级评语”, .内容)
.未知支持库函数_273 ()



.子程序 _按钮_工资表_固定信息保存_被单击, 空白型, , 
.局部变量 数据库连接_工资固定信息, 未知类型0x70001, , , 
.局部变量 记录集_工资固定信息, 未知类型0x70002, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“姓名不能为空!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
复制窗口组件 (数据库连接_工资固定信息)
复制窗口组件 (记录集_工资固定信息)
.如果真 (取反 (数据库连接_工资固定信息.未知支持库函数_1 (相加 (取当前目录 (), “\data\rzhq.mdb”), “”)))
    信息框 (“连接数据库失败!”, 0, )
    返回 ()
.如果真结束
记录集_工资固定信息.未知支持库函数_12 (数据库连接_工资固定信息)
.如果真 (取反 (记录集_工资固定信息.未知支持库函数_14 (“工资固定信息”, 2)))
    信息框 (“打开数据表失败!”, 0, )
    数据库连接_工资固定信息.未知支持库函数_3 ()
    返回 ()
.如果真结束
记录集_工资固定信息.未知支持库函数_17 ()
记录集_工资固定信息.未知支持库函数_35 ()
记录集_工资固定信息.未知支持库函数_20 (“姓名”, .内容)
记录集_工资固定信息.未知支持库函数_20 (“部门”, .内容)
记录集_工资固定信息.未知支持库函数_20 (“职务”, .内容)
记录集_工资固定信息.未知支持库函数_23 (“标准工资”, 到数值 (.内容))
记录集_工资固定信息.未知支持库函数_23 (“浮动工资”, 到数值 (.内容))
记录集_工资固定信息.未知支持库函数_23 (“奖金”, 到数值 (.内容))
记录集_工资固定信息.未知支持库函数_23 (“职务补贴”, 到数值 (.内容))
记录集_工资固定信息.未知支持库函数_23 (“标准工资”, 到数值 (.内容))
记录集_工资固定信息.未知支持库函数_23 (“交通补贴”, 到数值 (.内容))
记录集_工资固定信息.未知支持库函数_23 (“住房补贴”, 到数值 (.内容))
记录集_工资固定信息.未知支持库函数_23 (“误餐补贴”, 到数值 (.内容))
记录集_工资固定信息.未知支持库函数_23 (“岗位压金”, 到数值 (.内容))
记录集_工资固定信息.未知支持库函数_23 (“工作服压金”, 到数值 (.内容))
.如果 (记录集_工资固定信息.未知支持库函数_18 ())
    信息框 (“保存成功!”, 0, )
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    
.否则
    信息框 (“保存失败!”, 0, )
.如果结束
记录集_工资固定信息.未知支持库函数_16 ()
数据库连接_工资固定信息.未知支持库函数_3 ()

.子程序 _按钮_工资表_固定信息姓名_被单击, 空白型, , 
.局部变量 数据库连接_工资固定信息_按姓名查询, 未知类型0x70001, , , 
.局部变量 记录集_工资固定信息_按姓名查询, 未知类型0x70002, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请先输入要查找的职员姓名!”, 0, )
    返回 ()
.如果真结束

复制窗口组件 (数据库连接_工资固定信息_按姓名查询)
复制窗口组件 (记录集_工资固定信息_按姓名查询)
.如果真 (取反 (数据库连接_工资固定信息_按姓名查询.未知支持库函数_1 (相加 (取当前目录 (), “\data\rzhq.mdb”), “”)))
    信息框 (“打开数据库失败!”, 0, )
    返回 ()
.如果真结束
记录集_工资固定信息_按姓名查询.未知支持库函数_12 (数据库连接_工资固定信息_按姓名查询)
.如果真 (取反 (记录集_工资固定信息_按姓名查询.未知支持库函数_14 (“工资固定信息”, 2)))
    信息框 (“打开数据表失败!”, 0, )
    数据库连接_工资固定信息_按姓名查询.未知支持库函数_3 ()
    返回 ()
.如果真结束
记录集_工资固定信息_按姓名查询.未知支持库函数_47 (相加 (“姓名 = '”, .内容, “'”))
记录集_工资固定信息_按姓名查询.未知支持库函数_34 ()
赋值 (工资固定项目修改_记录号, 记录集_工资固定信息_按姓名查询.)
记录集_工资固定信息_按姓名查询.未知支持库函数_26 (“姓名”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_工资固定信息_按姓名查询.未知支持库函数_26 (“部门”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_工资固定信息_按姓名查询.未知支持库函数_26 (“职务”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_工资固定信息_按姓名查询.未知支持库函数_29 (“标准工资”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_工资固定信息_按姓名查询.未知支持库函数_29 (“浮动工资”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_工资固定信息_按姓名查询.未知支持库函数_29 (“奖金”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_工资固定信息_按姓名查询.未知支持库函数_29 (“职务补贴”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_工资固定信息_按姓名查询.未知支持库函数_29 (“交通补贴”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_工资固定信息_按姓名查询.未知支持库函数_29 (“住房补贴”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_工资固定信息_按姓名查询.未知支持库函数_29 (“误餐补贴”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_工资固定信息_按姓名查询.未知支持库函数_29 (“岗位压金”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_工资固定信息_按姓名查询.未知支持库函数_29 (“工作服压金”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))

记录集_工资固定信息_按姓名查询.未知支持库函数_47 (“”)
记录集_工资固定信息_按姓名查询.未知支持库函数_16 ()
数据库连接_工资固定信息_按姓名查询.未知支持库函数_3 ()
赋值 (.可视, 真)

.子程序 _按钮_工资表_固定信息修改_被单击, 空白型, , 
.局部变量 数据库连接_工资固定信息修改, 未知类型0x70001, , , 
.局部变量 记录集_工资固定信息修改, 未知类型0x70002, , , 

复制窗口组件 (数据库连接_工资固定信息修改)
复制窗口组件 (记录集_工资固定信息修改)
数据库连接_工资固定信息修改.未知支持库函数_1 (相加 (取当前目录 (), “\data\rzhq.mdb”), “”)
记录集_工资固定信息修改.未知支持库函数_12 (数据库连接_工资固定信息修改)
记录集_工资固定信息修改.未知支持库函数_14 (“工资固定信息”, 2)
记录集_工资固定信息修改.未知支持库函数_38 (工资固定项目修改_记录号)
记录集_工资固定信息修改.未知支持库函数_20 (“姓名”, .内容)
记录集_工资固定信息修改.未知支持库函数_20 (“部门”, .内容)
记录集_工资固定信息修改.未知支持库函数_20 (“职务”, .内容)
记录集_工资固定信息修改.未知支持库函数_23 (“标准工资”, 到数值 (.内容))
记录集_工资固定信息修改.未知支持库函数_23 (“浮动工资”, 到数值 (.内容))
记录集_工资固定信息修改.未知支持库函数_23 (“奖金”, 到数值 (.内容))
记录集_工资固定信息修改.未知支持库函数_23 (“职务补贴”, 到数值 (.内容))
记录集_工资固定信息修改.未知支持库函数_23 (“标准工资”, 到数值 (.内容))
记录集_工资固定信息修改.未知支持库函数_23 (“交通补贴”, 到数值 (.内容))
记录集_工资固定信息修改.未知支持库函数_23 (“住房补贴”, 到数值 (.内容))
记录集_工资固定信息修改.未知支持库函数_23 (“误餐补贴”, 到数值 (.内容))
记录集_工资固定信息修改.未知支持库函数_23 (“岗位压金”, 到数值 (.内容))
记录集_工资固定信息修改.未知支持库函数_23 (“工作服压金”, 到数值 (.内容))
.如果 (记录集_工资固定信息修改.未知支持库函数_18 ())
    信息框 (“修改成功!”, 0, )
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    
.否则
    信息框 (“修改失败!”, 0, )
.如果结束
记录集_工资固定信息修改.未知支持库函数_16 ()
数据库连接_工资固定信息修改.未知支持库函数_3 ()
赋值 (.可视, 假)

.子程序 _按钮_工资表_保存_被单击, 空白型, , 
.局部变量 数据库连接_工资保存, 未知类型0x70001, , , 
.局部变量 记录集_工资保存, 未知类型0x70002, , , 
.局部变量 匿名局部变量_3937, 空白型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请输入该员工姓名!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
复制窗口组件 (数据库连接_工资保存)
复制窗口组件 (记录集_工资保存)
数据库连接_工资保存.未知支持库函数_1 (相加 (取当前目录 (), “\data\rzhq.mdb”), “”)
记录集_工资保存.未知支持库函数_12 (数据库连接_工资保存)
记录集_工资保存.未知支持库函数_14 (“工资表”, 2)
记录集_工资保存.未知支持库函数_17 ()
记录集_工资保存.未知支持库函数_20 (“姓名”, .内容)
记录集_工资保存.未知支持库函数_20 (“部门”, .内容)
记录集_工资保存.未知支持库函数_20 (“职务”, .内容)
记录集_工资保存.未知支持库函数_23 (“标准工资”, 到数值 (.内容))
记录集_工资保存.未知支持库函数_23 (“浮动工资”, 到数值 (.内容))
记录集_工资保存.未知支持库函数_23 (“奖金”, 到数值 (.内容))
记录集_工资保存.未知支持库函数_23 (“职务补贴”, 到数值 (.内容))
记录集_工资保存.未知支持库函数_23 (“交通补贴”, 到数值 (.内容))
记录集_工资保存.未知支持库函数_23 (“住房补贴”, 到数值 (.内容))
记录集_工资保存.未知支持库函数_23 (“误餐补贴”, 到数值 (.内容))
记录集_工资保存.未知支持库函数_23 (“请假扣款”, 到数值 (.内容))
记录集_工资保存.未知支持库函数_23 (“迟到罚款”, 到数值 (.内容))
记录集_工资保存.未知支持库函数_23 (“早退罚款”, 到数值 (.内容))
记录集_工资保存.未知支持库函数_23 (“违规操作罚款”, 到数值 (.内容))
记录集_工资保存.未知支持库函数_23 (“个人所得税”, 到数值 (.内容))
记录集_工资保存.未知支持库函数_23 (“养老保险金”, 到数值 (.内容))
记录集_工资保存.未知支持库函数_23 (“住房公积金”, 到数值 (.内容))
记录集_工资保存.未知支持库函数_23 (“失业保险金”, 到数值 (.内容))
记录集_工资保存.未知支持库函数_23 (“医疗保险金”, 到数值 (.内容))
记录集_工资保存.未知支持库函数_23 (“应发工资”, 到数值 (.内容))
记录集_工资保存.未知支持库函数_23 (“实发工资”, 到数值 (.内容))
记录集_工资保存.未知支持库函数_25 (“发放日期”, 到时间 (.内容))
记录集_工资保存.未知支持库函数_23 (“岗位压金”, 到数值 (.内容))
记录集_工资保存.未知支持库函数_23 (“工作服压金”, 到数值 (.内容))
.如果 (记录集_工资保存.未知支持库函数_18 ())
    信息框 (“保存成功!”, 0, )
.否则
    信息框 (“保存失败!”, 0, )
.如果结束
记录集_工资保存.未知支持库函数_16 ()
数据库连接_工资保存.未知支持库函数_3 ()
清空工资表 ()

.子程序 清空工资表, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.数据源, “”)

.子程序 _按钮_工资表_姓名_被单击, 空白型, , 
.局部变量 数据库连接_工资表按姓名查询, 未知类型0x70001, , , 
.局部变量 记录集_工资表按姓名查询, 未知类型0x70002, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请先输入姓名!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
复制窗口组件 (数据库连接_工资表按姓名查询)
复制窗口组件 (记录集_工资表按姓名查询)
数据库连接_工资表按姓名查询.未知支持库函数_1 (相加 (取当前目录 (), “\data\rzhq.mdb”), “”)
记录集_工资表按姓名查询.未知支持库函数_12 (数据库连接_工资表按姓名查询)
记录集_工资表按姓名查询.未知支持库函数_14 (“工资固定信息”, 2)
记录集_工资表按姓名查询.未知支持库函数_47 (相加 (“姓名 = '”, .内容, “'”))
记录集_工资表按姓名查询.未知支持库函数_34 ()
记录集_工资表按姓名查询.未知支持库函数_26 (“姓名”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_工资表按姓名查询.未知支持库函数_26 (“部门”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_工资表按姓名查询.未知支持库函数_26 (“职务”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_工资表按姓名查询.未知支持库函数_29 (“标准工资”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_工资表按姓名查询.未知支持库函数_29 (“浮动工资”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_工资表按姓名查询.未知支持库函数_29 (“奖金”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_工资表按姓名查询.未知支持库函数_29 (“职务补贴”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_工资表按姓名查询.未知支持库函数_29 (“交通补贴”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_工资表按姓名查询.未知支持库函数_29 (“住房补贴”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_工资表按姓名查询.未知支持库函数_29 (“误餐补贴”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_工资表按姓名查询.未知支持库函数_29 (“岗位压金”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_工资表按姓名查询.未知支持库函数_29 (“工作服压金”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))

记录集_工资表按姓名查询.未知支持库函数_47 (“”)
记录集_工资表按姓名查询.未知支持库函数_16 ()
数据库连接_工资表按姓名查询.未知支持库函数_3 ()


.子程序 _按钮_工资表_取消_被单击, 空白型, , 
清空工资表 ()

.子程序 _编辑框_工资表_应发工资_获得焦点, 空白型, , 
.局部变量 应发工资, 整数型, , , 

赋值 (应发工资, 相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容)))
赋值 (.内容, 到文本 (应发工资))

.子程序 _编辑框_工资表_实发工资_获得焦点, 空白型, , 
.局部变量 实发工资, 整数型, , , 

赋值 (实发工资, 相减 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容)))
赋值 (.内容, 到文本 (实发工资))

.子程序 _按钮_工资表_开始查询_被单击, 空白型, , 
.局部变量 数据库连接_工资表按时间查询, 未知类型0x70001, , , 
.局部变量 记录集_工资表按时间查询, 未知类型0x70002, , , 
.局部变量 计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请先输入要查询的工资发放日期!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
复制窗口组件 (数据库连接_工资表按时间查询)
复制窗口组件 (记录集_工资表按时间查询)
.如果真 (取反 (数据库连接_工资表按时间查询.未知支持库函数_1 (相加 (取当前目录 (), “\data\rzhq.mdb”), “”)))
    信息框 (“数据库连接失败!”, 0, )
    返回 ()
.如果真结束
记录集_工资表按时间查询.未知支持库函数_12 (数据库连接_工资表按时间查询)
.如果真 (取反 (记录集_工资表按时间查询.未知支持库函数_14 (“工资表”, 2)))
    信息框 (“打开数据表失败!”, 0, )
    数据库连接_工资表按时间查询.未知支持库函数_3 ()
    返回 ()
.如果真结束
记录集_工资表按时间查询.未知支持库函数_47 (相加 (“发放日期 = '”, .内容, “'”))
相加 (取当前目录 (), “\grd\gzffb_moban.grd”).从文件读 ()
赋值 (.数据源, “”)
.如果真 (小于 (记录集_工资表按时间查询., 1))
    信息框 (“没有查询到信息!请确认输入的日期无误后再次查询.”, 0, )
    记录集_工资表按时间查询.未知支持库函数_47 (“”)
    记录集_工资表按时间查询.未知支持库函数_16 ()
    数据库连接_工资表按时间查询.未知支持库函数_3 ()
.如果真结束
记录集_工资表按时间查询.添加行 (.)
4.置对齐方式 (1, 记录集_工资表按时间查询., 14, 5)
4.加线条 (1, 记录集_工资表按时间查询., 14, 相加 (#左边框, #上边框, #右边框, #下边框, #垂直线))
2.置文本 (12, .内容)
2.置文本 (3, 操作员)
.计次循环首 (记录集_工资表按时间查询., 计次)
    记录集_工资表按时间查询.未知支持库函数_26 (“姓名”, 临时_文本)
    相加 (计次, 3).置文本 (1, 临时_文本)
    记录集_工资表按时间查询.未知支持库函数_29 (“标准工资”, 临时_整数)
    相加 (计次, 3).置文本 (2, 到文本 (临时_整数))
    记录集_工资表按时间查询.未知支持库函数_29 (“浮动工资”, 临时_整数)
    相加 (计次, 3).置文本 (3, 到文本 (临时_整数))
    记录集_工资表按时间查询.未知支持库函数_29 (“奖金”, 临时_整数)
    相加 (计次, 3).置文本 (4, 到文本 (临时_整数))
    记录集_工资表按时间查询.未知支持库函数_29 (“职务补贴”, 临时_整数)
    相加 (计次, 3).置文本 (5, 到文本 (临时_整数))
    记录集_工资表按时间查询.未知支持库函数_29 (“交通补贴”, 临时_整数)
    相加 (计次, 3).置文本 (6, 到文本 (临时_整数))
    记录集_工资表按时间查询.未知支持库函数_29 (“住房补贴”, 临时_整数)
    相加 (计次, 3).置文本 (7, 到文本 (临时_整数))
    记录集_工资表按时间查询.未知支持库函数_29 (“误餐补贴”, 临时_整数)
    相加 (计次, 3).置文本 (8, 到文本 (临时_整数))
    记录集_工资表按时间查询.未知支持库函数_29 (“请假扣款”, 临时_整数)
    相加 (计次, 3).置文本 (9, 到文本 (临时_整数))
    记录集_工资表按时间查询.未知支持库函数_29 (“迟到罚款”, 临时_整数)
    相加 (计次, 3).置文本 (10, 到文本 (临时_整数))
    记录集_工资表按时间查询.未知支持库函数_29 (“违规操作罚款”, 临时_整数)
    相加 (计次, 3).置文本 (11, 到文本 (临时_整数))
    记录集_工资表按时间查询.未知支持库函数_29 (“应发工资”, 临时_整数)
    相加 (计次, 3).置文本 (12, 到文本 (临时_整数))
    记录集_工资表按时间查询.未知支持库函数_29 (“实发工资”, 临时_整数)
    相加 (计次, 3).置文本 (13, 到文本 (临时_整数))
    
    记录集_工资表按时间查询.未知支持库函数_36 ()
.计次循环尾 ()
赋值 (.数据源, “数据源_工资签发表”)
记录集_工资表按时间查询.未知支持库函数_47 (“”)
记录集_工资表按时间查询.未知支持库函数_16 ()
数据库连接_工资表按时间查询.未知支持库函数_3 ()

.子程序 _按钮_工资表_打印工资签发表_被单击, 空白型, , 
打印预览 ()

.子程序 _按钮_办公用品采购_保存_被单击, 空白型, , 
.局部变量 数据库连接_办公用品采购, 未知类型0x70001, , , 
.局部变量 记录集_办公用品采购, 未知类型0x70002, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请输入物品名称!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
复制窗口组件 (数据库连接_办公用品采购)
复制窗口组件 (记录集_办公用品采购)
数据库连接_办公用品采购.未知支持库函数_1 (相加 (取当前目录 (), “\data\rzhq.mdb”), “”)
记录集_办公用品采购.未知支持库函数_12 (数据库连接_办公用品采购)
记录集_办公用品采购.未知支持库函数_14 (“办公用品采购”, 2)
记录集_办公用品采购.未知支持库函数_17 ()
记录集_办公用品采购.未知支持库函数_35 ()
记录集_办公用品采购.未知支持库函数_20 (“物品名称”, .内容)
记录集_办公用品采购.未知支持库函数_20 (“型号”, .内容)
记录集_办公用品采购.未知支持库函数_23 (“单价”, 到数值 (.内容))
记录集_办公用品采购.未知支持库函数_23 (“数量”, 到数值 (.内容))
记录集_办公用品采购.未知支持库函数_23 (“金额”, 到数值 (.内容))
记录集_办公用品采购.未知支持库函数_20 (“采购地”, .内容)
记录集_办公用品采购.未知支持库函数_25 (“购入日期”, 到时间 (.内容))
记录集_办公用品采购.未知支持库函数_20 (“经办人”, .内容)
.如果 (记录集_办公用品采购.未知支持库函数_18 ())
    信息框 (“保存成功!”, 0, )
.否则
    信息框 (“保存失败!”, 0, )
.如果结束
记录集_办公用品采购.未知支持库函数_16 ()
数据库连接_办公用品采购.未知支持库函数_3 ()

.子程序 _按钮_办公用品领取_保存_被单击, 空白型, , 
.局部变量 数据库连接_办公用品领取, 未知类型0x70001, , , 
.局部变量 记录集_办公用品领取, 未知类型0x70002, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请输入物品名称!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
复制窗口组件 (数据库连接_办公用品领取)
复制窗口组件 (记录集_办公用品领取)
数据库连接_办公用品领取.未知支持库函数_1 (相加 (取当前目录 (), “\data\rzhq.mdb”), “”)
记录集_办公用品领取.未知支持库函数_12 (数据库连接_办公用品领取)
记录集_办公用品领取.未知支持库函数_14 (“办公用品分发”, 2)
记录集_办公用品领取.未知支持库函数_17 ()
记录集_办公用品领取.未知支持库函数_35 ()
记录集_办公用品领取.未知支持库函数_20 (“物品名称”, .内容)
记录集_办公用品领取.未知支持库函数_20 (“型号”, .内容)
记录集_办公用品领取.未知支持库函数_23 (“数量”, 到数值 (.内容))
记录集_办公用品领取.未知支持库函数_20 (“使用部门”, .内容)
记录集_办公用品领取.未知支持库函数_25 (“领取日期”, 到时间 (.内容))
记录集_办公用品领取.未知支持库函数_20 (“领取人”, .内容)
.如果 (记录集_办公用品领取.未知支持库函数_18 ())
    信息框 (“保存成功!”, 0, )
.否则
    信息框 (“保存失败!”, 0, )
.如果结束
记录集_办公用品领取.未知支持库函数_16 ()
数据库连接_办公用品领取.未知支持库函数_3 ()


.子程序 _按钮_房租水电通讯费_保存_被单击, 空白型, , 
.局部变量 数据库连接_房租水电通讯费, 未知类型0x70001, , , 
.局部变量 记录集_房租水电通讯费, 未知类型0x70002, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请输入费用名称!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
复制窗口组件 (数据库连接_房租水电通讯费)
复制窗口组件 (记录集_房租水电通讯费)
数据库连接_房租水电通讯费.未知支持库函数_1 (相加 (取当前目录 (), “\data\rzhq.mdb”), “”)
记录集_房租水电通讯费.未知支持库函数_12 (数据库连接_房租水电通讯费)
记录集_房租水电通讯费.未知支持库函数_14 (“房租水电通讯费”, 2)
记录集_房租水电通讯费.未知支持库函数_17 ()
记录集_房租水电通讯费.未知支持库函数_35 ()
记录集_房租水电通讯费.未知支持库函数_20 (“费用名称”, .内容)
记录集_房租水电通讯费.未知支持库函数_25 (“缴费时间”, 到时间 (.内容))
记录集_房租水电通讯费.未知支持库函数_20 (“办理单位”, .内容)
记录集_房租水电通讯费.未知支持库函数_20 (“费用产生人”, .内容)
记录集_房租水电通讯费.未知支持库函数_20 (“费用承担方”, .内容)
记录集_房租水电通讯费.未知支持库函数_23 (“缴费金额”, 到数值 (.内容))
记录集_房租水电通讯费.未知支持库函数_20 (“审批人”, .内容)
记录集_房租水电通讯费.未知支持库函数_20 (“备注”, .内容)

.如果 (记录集_房租水电通讯费.未知支持库函数_18 ())
    信息框 (“保存成功!”, 0, )
.否则
    信息框 (“保存失败!”, 0, )
.如果结束
记录集_房租水电通讯费.未知支持库函数_16 ()
数据库连接_房租水电通讯费.未知支持库函数_3 ()


.子程序 _按钮_应酬费用_保存_被单击, 空白型, , 
.局部变量 数据库连接_应酬招待费用, 未知类型0x70001, , , 
.局部变量 记录集_应酬招待费用, 未知类型0x70002, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请输入招待对象所属单位名称!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
复制窗口组件 (数据库连接_应酬招待费用)
复制窗口组件 (记录集_应酬招待费用)
数据库连接_应酬招待费用.未知支持库函数_1 (相加 (取当前目录 (), “\data\rzhq.mdb”), “”)
记录集_应酬招待费用.未知支持库函数_12 (数据库连接_应酬招待费用)
记录集_应酬招待费用.未知支持库函数_14 (“招待费”, 2)
记录集_应酬招待费用.未知支持库函数_17 ()
记录集_应酬招待费用.未知支持库函数_35 ()
记录集_应酬招待费用.未知支持库函数_20 (“招待对象”, .内容)
记录集_应酬招待费用.未知支持库函数_25 (“招待日期”, 到时间 (.内容))
记录集_应酬招待费用.未知支持库函数_20 (“所属单位”, .内容)
记录集_应酬招待费用.未知支持库函数_20 (“原因”, .内容)
记录集_应酬招待费用.未知支持库函数_20 (“招待项目”, .内容)
记录集_应酬招待费用.未知支持库函数_23 (“招待费用”, 到数值 (.内容))
记录集_应酬招待费用.未知支持库函数_20 (“陪同人”, .内容)
记录集_应酬招待费用.未知支持库函数_20 (“达到效果”, .内容)
记录集_应酬招待费用.未知支持库函数_20 (“审批人”, .内容)
记录集_应酬招待费用.未知支持库函数_20 (“备注”, .内容)

.如果 (记录集_应酬招待费用.未知支持库函数_18 ())
    信息框 (“保存成功!”, 0, )
.否则
    信息框 (“保存失败!”, 0, )
.如果结束
记录集_应酬招待费用.未知支持库函数_16 ()
数据库连接_应酬招待费用.未知支持库函数_3 ()


.子程序 _按钮_餐饮开支_保存_被单击, 空白型, , 
.局部变量 数据库连接_餐饮开支, 未知类型0x70001, , , 
.局部变量 记录集_餐饮开支, 未知类型0x70002, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请输入物品名称!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
复制窗口组件 (数据库连接_餐饮开支)
复制窗口组件 (记录集_餐饮开支)
数据库连接_餐饮开支.未知支持库函数_1 (相加 (取当前目录 (), “\data\rzhq.mdb”), “”)
记录集_餐饮开支.未知支持库函数_12 (数据库连接_餐饮开支)
记录集_餐饮开支.未知支持库函数_14 (“餐饮”, 2)
记录集_餐饮开支.未知支持库函数_17 ()
记录集_餐饮开支.未知支持库函数_35 ()
记录集_餐饮开支.未知支持库函数_20 (“物品名称”, .内容)
记录集_餐饮开支.未知支持库函数_25 (“购入日期”, 到时间 (.内容))
记录集_餐饮开支.未知支持库函数_23 (“单价”, 到数值 (.内容))
记录集_餐饮开支.未知支持库函数_23 (“数量”, 到数值 (.内容))
记录集_餐饮开支.未知支持库函数_23 (“金额”, 到数值 (.内容))
记录集_餐饮开支.未知支持库函数_23 (“消耗周期”, 到数值 (.内容))
记录集_餐饮开支.未知支持库函数_20 (“经办人”, .内容)
记录集_餐饮开支.未知支持库函数_20 (“审批人”, .内容)

.如果 (记录集_餐饮开支.未知支持库函数_18 ())
    信息框 (“保存成功!”, 0, )
.否则
    信息框 (“保存失败!”, 0, )
.如果结束
记录集_餐饮开支.未知支持库函数_16 ()
数据库连接_餐饮开支.未知支持库函数_3 ()


.子程序 _时钟_后勤导出_周期事件, 空白型, , 
赋值 (.最小位置, 0)
赋值 (.最大位置, 20)
赋值 (.位置, 相加 (.位置, 2))
赋值 (.标题, “正在进行导出前的准备...”)


.子程序 _按钮_餐饮导出_被单击, 空白型, , 
.局部变量 数据库连接_后勤导出, 未知类型0x70001, , , 
.局部变量 记录集_后勤导出, 未知类型0x70002, , , 
.局部变量 字母, 文本型, , "0", 
.局部变量 行, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 行计次, 整数型, , , 
.局部变量 列计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 临时_日期, 日期时间型, , , 

赋值 (.类型, 1)
赋值 (.标题, “请选择保存EXCEL文件的位置”)
赋值 (.文件名, 相加 (取当前目录 (), “\导出电子表格\后勤开支\”, 到文本 (取日期 (取现行时间 ()))))
赋值 (.过滤器, “EXCEL电子表格文件|*.xls”)
赋值 (.初始目录, 相加 (取当前目录 (), “\导出电子表格\后勤开支\”))
赋值 (.默认文件后缀, “.xls”)

复制窗口组件 (数据库连接_后勤导出)
复制窗口组件 (记录集_后勤导出)
.如果真 (等于 (数据库连接_后勤导出.未知支持库函数_1 (相加 (取当前目录 (), “\data\rzhq.mdb”), “”), 假))
    信息框 (“数据库连接失败!”, 0, )
    赋值 (.可视, 假)
    返回 ()
.如果真结束
记录集_后勤导出.未知支持库函数_12 (数据库连接_后勤导出)
.如果 (打开 ())
    赋值 (.可视, 真)
    赋值 (.时钟周期, 1000)
    未知支持库函数_0 ()
    .未知支持库函数_6 ()
    赋值 (., 1)
    未知支持库函数_21 ()
    未知支持库函数_21 ()
    赋值 (., 1)
    赋值 (., “办公用品采购”)
    赋值 (., 2)
    赋值 (., “办公用品分发”)
    赋值 (., 3)
    赋值 (., “餐饮”)
    赋值 (., 4)
    赋值 (., “房租水电通讯费”)
    赋值 (., 5)
    赋值 (., “招待费”)
    赋值 (.时钟周期, 0)
    .如果真 (等于 (.选中, 真))
        .如果真 (取反 (记录集_后勤导出.未知支持库函数_14 (“办公用品采购”, 2)))
            信息框 (“打开用品采购表失败!”, 0, )
            赋值 (.可视, 假)
            数据库连接_后勤导出.未知支持库函数_3 ()
            未知支持库函数_15 ()
            未知支持库函数_3 ()
            返回 ()
        .如果真结束
        记录集_后勤导出.未知支持库函数_47 (相加 (“购入日期 >= '”, .内容, “' and 购入日期 <= '”, .内容, “'”))
        赋值 (., 1)
        赋值 (行, 记录集_后勤导出.)
        赋值 (列, 8)
        赋值 (.最小位置, 1)
        赋值 (.最大位置, 列)
        赋值 (.标题, “将要导出办公用品采购信息...”)
        清除数组 (字母)
        加入成员 (字母, “A”)
        加入成员 (字母, “B”)
        加入成员 (字母, “C”)
        加入成员 (字母, “D”)
        加入成员 (字母, “E”)
        加入成员 (字母, “F”)
        加入成员 (字母, “G”)
        加入成员 (字母, “H”)
        .计次循环首 (列, 列计次)
            赋值 (., 相加 (字母 [列计次], “1”))
            赋值 (., 相加 (字母 [列计次], “1”))
            赋值 (., 记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1)))
            赋值 (.标题, 相加 (“正在向EXCEL写出字段名:”, 记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1))))
            赋值 (.位置, 列计次)
        .计次循环尾 ()
        .计次循环首 (列, 列计次)
            记录集_后勤导出.未知支持库函数_34 ()
            .计次循环首 (行, 行计次)
                赋值 (., 相加 (字母 [列计次], 到文本 (相加 (行计次, 1))))
                赋值 (., 相加 (字母 [列计次], 到文本 (相加 (行计次, 1))))
                .判断开始 (等于 (记录集_后勤导出.未知支持库函数_43 (相减 (列计次, 1)), 202)) ' 判断字段是不是文本型
                    记录集_后勤导出.未知支持库函数_26 (记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1)), 临时_文本)
                    赋值 (., 临时_文本)
                .判断 (等于 (记录集_后勤导出.未知支持库函数_43 (相减 (列计次, 1)), 203)) ' 判断字段是不是备注型
                    记录集_后勤导出.未知支持库函数_26 (记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1)), 临时_文本)
                    赋值 (., 临时_文本)
                .判断 (等于 (记录集_后勤导出.未知支持库函数_43 (相减 (列计次, 1)), 3)) ' 判断字段是不是整型数值
                    记录集_后勤导出.未知支持库函数_29 (记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1)), 临时_整数)
                    赋值 (., 到文本 (临时_整数))
                .判断 (等于 (记录集_后勤导出.未知支持库函数_43 (相减 (列计次, 1)), 7)) ' 判断字段是不是日期型
                    记录集_后勤导出.未知支持库函数_31 (记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1)), 临时_日期)
                    赋值 (., 到文本 (临时_日期))
                .默认
                    
                .判断结束
                赋值 (.标题, 相加 (“正在向EXCEL写出字段值,总计8列,当前是第”, 到文本 (列计次), “列”))
                赋值 (.位置, 列计次)
                记录集_后勤导出.未知支持库函数_36 ()
            .计次循环尾 ()
        .计次循环尾 ()
        记录集_后勤导出.未知支持库函数_47 (“”)
        记录集_后勤导出.未知支持库函数_16 ()
        
    .如果真结束
    
    .如果真 (等于 (.选中, 真))
        .如果 (等于 (记录集_后勤导出.未知支持库函数_14 (“办公用品分发”, 2), 假))
            信息框 (“打开办公用品分发表失败!”, 0, )
            数据库连接_后勤导出.未知支持库函数_3 ()
            赋值 (.可视, 假)
            未知支持库函数_15 ()
            未知支持库函数_3 ()
            返回 ()
        .否则
            
        .如果结束
        记录集_后勤导出.未知支持库函数_47 (相加 (“领取日期 >= '”, .内容, “' and 领取日期 <= '”, .内容, “'”))
        赋值 (., 2)
        赋值 (行, 记录集_后勤导出.)
        赋值 (列, 6)
        赋值 (.最小位置, 1)
        赋值 (.最大位置, 列)
        赋值 (.标题, “将要导出办公用品分发信息...”)
        清除数组 (字母)
        加入成员 (字母, “A”)
        加入成员 (字母, “B”)
        加入成员 (字母, “C”)
        加入成员 (字母, “D”)
        加入成员 (字母, “E”)
        加入成员 (字母, “F”)
        .计次循环首 (列, 列计次)
            赋值 (., 相加 (字母 [列计次], “1”))
            赋值 (., 相加 (字母 [列计次], “1”))
            赋值 (., 记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1)))
            赋值 (.标题, 相加 (“正在向EXCEL写出字段名:”, 记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1))))
            赋值 (.位置, 列计次)
        .计次循环尾 ()
        .计次循环首 (列, 列计次)
            记录集_后勤导出.未知支持库函数_34 ()
            .计次循环首 (行, 行计次)
                赋值 (., 相加 (字母 [列计次], 到文本 (相加 (行计次, 1))))
                赋值 (., 相加 (字母 [列计次], 到文本 (相加 (行计次, 1))))
                .判断开始 (等于 (记录集_后勤导出.未知支持库函数_43 (相减 (列计次, 1)), 202)) ' 判断字段是不是文本型
                    记录集_后勤导出.未知支持库函数_26 (记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1)), 临时_文本)
                    赋值 (., 临时_文本)
                .判断 (等于 (记录集_后勤导出.未知支持库函数_43 (相减 (列计次, 1)), 203)) ' 判断字段是不是备注型
                    记录集_后勤导出.未知支持库函数_26 (记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1)), 临时_文本)
                    赋值 (., 临时_文本)
                .判断 (等于 (记录集_后勤导出.未知支持库函数_43 (相减 (列计次, 1)), 3)) ' 判断字段是不是整型数值
                    记录集_后勤导出.未知支持库函数_29 (记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1)), 临时_整数)
                    赋值 (., 到文本 (临时_整数))
                .判断 (等于 (记录集_后勤导出.未知支持库函数_43 (相减 (列计次, 1)), 7)) ' 判断字段是不是日期型
                    记录集_后勤导出.未知支持库函数_31 (记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1)), 临时_日期)
                    赋值 (., 到文本 (临时_日期))
                .默认
                    
                .判断结束
                赋值 (.标题, 相加 (“正在向EXCEL写出字段值,总计6列,当前是第”, 到文本 (列计次), “列”))
                赋值 (.位置, 列计次)
                记录集_后勤导出.未知支持库函数_36 ()
            .计次循环尾 ()
        .计次循环尾 ()
        记录集_后勤导出.未知支持库函数_47 (“”)
        记录集_后勤导出.未知支持库函数_16 ()
        
    .如果真结束
    
    .如果真 (等于 (.选中, 真))
        .如果 (等于 (记录集_后勤导出.未知支持库函数_14 (“房租水电通讯费”, 2), 假))
            信息框 (“打开房租水电通讯费表失败!”, 0, )
            数据库连接_后勤导出.未知支持库函数_3 ()
            赋值 (.可视, 假)
            未知支持库函数_15 ()
            未知支持库函数_3 ()
            返回 ()
        .否则
            
        .如果结束
        记录集_后勤导出.未知支持库函数_47 (相加 (“缴费时间 >= '”, .内容, “' and 缴费时间 <= '”, .内容, “'”))
        赋值 (., 3)
        赋值 (行, 记录集_后勤导出.)
        赋值 (列, 8)
        赋值 (.最小位置, 1)
        赋值 (.最大位置, 列)
        赋值 (.标题, “将要导出房租水电通讯费信息...”)
        清除数组 (字母)
        加入成员 (字母, “A”)
        加入成员 (字母, “B”)
        加入成员 (字母, “C”)
        加入成员 (字母, “D”)
        加入成员 (字母, “E”)
        加入成员 (字母, “F”)
        加入成员 (字母, “G”)
        加入成员 (字母, “H”)
        .计次循环首 (列, 列计次)
            赋值 (., 相加 (字母 [列计次], “1”))
            赋值 (., 相加 (字母 [列计次], “1”))
            赋值 (., 记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1)))
            赋值 (.标题, 相加 (“正在向EXCEL写出字段名:”, 记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1))))
            赋值 (.位置, 列计次)
        .计次循环尾 ()
        .计次循环首 (列, 列计次)
            记录集_后勤导出.未知支持库函数_34 ()
            .计次循环首 (行, 行计次)
                赋值 (., 相加 (字母 [列计次], 到文本 (相加 (行计次, 1))))
                赋值 (., 相加 (字母 [列计次], 到文本 (相加 (行计次, 1))))
                .判断开始 (等于 (记录集_后勤导出.未知支持库函数_43 (相减 (列计次, 1)), 202)) ' 判断字段是不是文本型
                    记录集_后勤导出.未知支持库函数_26 (记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1)), 临时_文本)
                    赋值 (., 临时_文本)
                .判断 (等于 (记录集_后勤导出.未知支持库函数_43 (相减 (列计次, 1)), 203)) ' 判断字段是不是备注型
                    记录集_后勤导出.未知支持库函数_26 (记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1)), 临时_文本)
                    赋值 (., 临时_文本)
                .判断 (等于 (记录集_后勤导出.未知支持库函数_43 (相减 (列计次, 1)), 3)) ' 判断字段是不是整型数值
                    记录集_后勤导出.未知支持库函数_29 (记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1)), 临时_整数)
                    赋值 (., 到文本 (临时_整数))
                .判断 (等于 (记录集_后勤导出.未知支持库函数_43 (相减 (列计次, 1)), 7)) ' 判断字段是不是日期型
                    记录集_后勤导出.未知支持库函数_31 (记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1)), 临时_日期)
                    赋值 (., 到文本 (临时_日期))
                .默认
                    
                .判断结束
                赋值 (.标题, 相加 (“正在向EXCEL写出字段值,总计8列,当前是第”, 到文本 (列计次), “列”))
                赋值 (.位置, 列计次)
                记录集_后勤导出.未知支持库函数_36 ()
            .计次循环尾 ()
        .计次循环尾 ()
        记录集_后勤导出.未知支持库函数_47 (“”)
        记录集_后勤导出.未知支持库函数_16 ()
        
    .如果真结束
    
    .如果真 (等于 (.选中, 真))
        .如果 (等于 (记录集_后勤导出.未知支持库函数_14 (“招待费”, 2), 假))
            信息框 (“打开招待费表失败!”, 0, )
            数据库连接_后勤导出.未知支持库函数_3 ()
            赋值 (.可视, 假)
            未知支持库函数_15 ()
            未知支持库函数_3 ()
            返回 ()
        .否则
            
        .如果结束
        记录集_后勤导出.未知支持库函数_47 (相加 (“招待日期 >= '”, .内容, “' and 招待日期 <= '”, .内容, “'”))
        赋值 (., 4)
        赋值 (行, 记录集_后勤导出.)
        赋值 (列, 10)
        赋值 (.最小位置, 1)
        赋值 (.最大位置, 列)
        赋值 (.标题, “将要导出应酬招待费用信息...”)
        清除数组 (字母)
        加入成员 (字母, “A”)
        加入成员 (字母, “B”)
        加入成员 (字母, “C”)
        加入成员 (字母, “D”)
        加入成员 (字母, “E”)
        加入成员 (字母, “F”)
        加入成员 (字母, “G”)
        加入成员 (字母, “H”)
        加入成员 (字母, “I”)
        加入成员 (字母, “J”)
        .计次循环首 (列, 列计次)
            赋值 (., 相加 (字母 [列计次], “1”))
            赋值 (., 相加 (字母 [列计次], “1”))
            赋值 (., 记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1)))
            赋值 (.标题, 相加 (“正在向EXCEL写出字段名:”, 记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1))))
            赋值 (.位置, 列计次)
        .计次循环尾 ()
        .计次循环首 (列, 列计次)
            记录集_后勤导出.未知支持库函数_34 ()
            .计次循环首 (行, 行计次)
                赋值 (., 相加 (字母 [列计次], 到文本 (相加 (行计次, 1))))
                赋值 (., 相加 (字母 [列计次], 到文本 (相加 (行计次, 1))))
                .判断开始 (等于 (记录集_后勤导出.未知支持库函数_43 (相减 (列计次, 1)), 202)) ' 判断字段是不是文本型
                    记录集_后勤导出.未知支持库函数_26 (记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1)), 临时_文本)
                    赋值 (., 临时_文本)
                .判断 (等于 (记录集_后勤导出.未知支持库函数_43 (相减 (列计次, 1)), 203)) ' 判断字段是不是备注型
                    记录集_后勤导出.未知支持库函数_26 (记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1)), 临时_文本)
                    赋值 (., 临时_文本)
                .判断 (等于 (记录集_后勤导出.未知支持库函数_43 (相减 (列计次, 1)), 3)) ' 判断字段是不是整型数值
                    记录集_后勤导出.未知支持库函数_29 (记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1)), 临时_整数)
                    赋值 (., 到文本 (临时_整数))
                .判断 (等于 (记录集_后勤导出.未知支持库函数_43 (相减 (列计次, 1)), 7)) ' 判断字段是不是日期型
                    记录集_后勤导出.未知支持库函数_31 (记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1)), 临时_日期)
                    赋值 (., 到文本 (临时_日期))
                .默认
                    
                .判断结束
                赋值 (.标题, 相加 (“正在向EXCEL写出字段值,总计10列,当前是第”, 到文本 (列计次), “列”))
                赋值 (.位置, 列计次)
                记录集_后勤导出.未知支持库函数_36 ()
            .计次循环尾 ()
        .计次循环尾 ()
        记录集_后勤导出.未知支持库函数_47 (“”)
        记录集_后勤导出.未知支持库函数_16 ()
    .如果真结束
    
    .如果真 (等于 (.选中, 真))
        .如果 (等于 (记录集_后勤导出.未知支持库函数_14 (“餐饮”, 2), 假))
            信息框 (“打开餐饮表失败!”, 0, )
            数据库连接_后勤导出.未知支持库函数_3 ()
            赋值 (.可视, 假)
            未知支持库函数_15 ()
            未知支持库函数_3 ()
            返回 ()
        .否则
            
        .如果结束
        记录集_后勤导出.未知支持库函数_47 (相加 (“购入日期 >= '”, .内容, “' and 购入日期 <= '”, .内容, “'”))
        赋值 (., 5)
        赋值 (行, 记录集_后勤导出.)
        赋值 (列, 8)
        赋值 (.最小位置, 1)
        赋值 (.最大位置, 列)
        赋值 (.标题, “将要导出餐饮支出信息...”)
        清除数组 (字母)
        加入成员 (字母, “A”)
        加入成员 (字母, “B”)
        加入成员 (字母, “C”)
        加入成员 (字母, “D”)
        加入成员 (字母, “E”)
        加入成员 (字母, “F”)
        加入成员 (字母, “G”)
        加入成员 (字母, “H”)
        .计次循环首 (列, 列计次)
            赋值 (., 相加 (字母 [列计次], “1”))
            赋值 (., 相加 (字母 [列计次], “1”))
            赋值 (., 记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1)))
            赋值 (.标题, 相加 (“正在向EXCEL写出字段名:”, 记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1))))
            赋值 (.位置, 列计次)
        .计次循环尾 ()
        .计次循环首 (列, 列计次)
            记录集_后勤导出.未知支持库函数_34 ()
            .计次循环首 (行, 行计次)
                赋值 (., 相加 (字母 [列计次], 到文本 (相加 (行计次, 1))))
                赋值 (., 相加 (字母 [列计次], 到文本 (相加 (行计次, 1))))
                .判断开始 (等于 (记录集_后勤导出.未知支持库函数_43 (相减 (列计次, 1)), 202)) ' 判断字段是不是文本型
                    记录集_后勤导出.未知支持库函数_26 (记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1)), 临时_文本)
                    赋值 (., 临时_文本)
                .判断 (等于 (记录集_后勤导出.未知支持库函数_43 (相减 (列计次, 1)), 203)) ' 判断字段是不是备注型
                    记录集_后勤导出.未知支持库函数_26 (记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1)), 临时_文本)
                    赋值 (., 临时_文本)
                .判断 (等于 (记录集_后勤导出.未知支持库函数_43 (相减 (列计次, 1)), 3)) ' 判断字段是不是整型数值
                    记录集_后勤导出.未知支持库函数_29 (记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1)), 临时_整数)
                    赋值 (., 到文本 (临时_整数))
                .判断 (等于 (记录集_后勤导出.未知支持库函数_43 (相减 (列计次, 1)), 7)) ' 判断字段是不是日期型
                    记录集_后勤导出.未知支持库函数_31 (记录集_后勤导出.未知支持库函数_39 (相减 (列计次, 1)), 临时_日期)
                    赋值 (., 到文本 (临时_日期))
                .默认
                    
                .判断结束
                赋值 (.标题, 相加 (“正在向EXCEL写出字段值,总计8列,当前是第”, 到文本 (列计次), “列”))
                赋值 (.位置, 列计次)
                记录集_后勤导出.未知支持库函数_36 ()
            .计次循环尾 ()
        .计次循环尾 ()
        记录集_后勤导出.未知支持库函数_47 (“”)
        记录集_后勤导出.未知支持库函数_16 ()
    .如果真结束
    
    数据库连接_后勤导出.未知支持库函数_3 ()
    .未知支持库函数_16 (.文件名)
    赋值 (.标题, “导出完毕!”)
    信息框 (“导出成功!”, 0, )
    未知支持库函数_15 ()
    未知支持库函数_3 ()
    赋值 (.可视, 假)
    
.否则
    信息框 (“用户取消!”, 0, )
    返回 ()
.如果结束


.子程序 _帮助_被选择, 空白型, , 
载入 (关于窗口, , 真)


.窗口程序集 窗口程序集3, , , 

.子程序 _系统菜单窗口_位置被改变, 空白型, , 窗口位置被改变时改变选择夹的大小以适应窗口
赋值 (.左边, 0)
赋值 (.顶边, 0)
赋值 (.宽度, 取用户区宽度 ())
赋值 (.高度, 取用户区高度 ())

.子程序 _按钮_操作员_退出_被单击, 空白型, , 
赋值 (主窗口., 假)
销毁 ()

.子程序 _系统菜单窗口_将被销毁, 空白型, , 载入此窗口后将主窗口禁止操作了,如果退出时不取消的话,主窗口将无法操作
赋值 (主窗口., 假)
主窗口.获取焦点 ()

.子程序 _树型框_程序设置_设置列表_项目被选择, 空白型, , 选择夹程序设置里的界面切换判断
.参数 选择方式, 整数型, , 

 ' 树型框通过其项目被选择的事件来判断现行选中项的索引值,根据这个索引值可以运行相应的代码.
.判断开始 (或者 (等于 (.最大化按钮, 0), 等于 (.最大化按钮, 1)))
    赋值 (.现行子夹, 0)
.判断 (等于 (.最大化按钮, 2))
    赋值 (.现行子夹, 1)
.判断 (等于 (.最大化按钮, 3))
    赋值 (.现行子夹, 2)
.判断 (等于 (.最大化按钮, 4))
    赋值 (.现行子夹, 3)
.判断 (等于 (.最大化按钮, 5))
    赋值 (.现行子夹, 4)
.默认
    
.判断结束



.子程序 _按钮_操作员_列出用户_被单击, 空白型, , 将操作员表中的所有用户列在超级列表框里
.局部变量 列用户连接, 数据库, , , 
.局部变量 记录集操作员, 文本型, , "8", 
.局部变量 计次1, 整数型, , , 
.局部变量 总记录数, 整数型, , , 

赋值 (计次1, 1)
 ' 每次点击此按钮,将清空超级列表框里的内容,然后重新填入
全部删除 ()
 ' 调用"数据库"类模块进行数据库连接
.如果 (列用户连接.开始查询 (“system.mdb”, , “select * from 操作员”, 1))
    赋值 (总记录数, .)
    未知支持库函数_34 ()
     ' 循环加入数据库记录到超级列表框
    .计次循环首 (总记录数, 计次1)
         ' 读入当前记录的第一个字段值到数组变量"记录集操作员"的第一个位置
        0.未知支持库函数_26 (记录集操作员 [1])
         ' 在超级列表框的每一行的第一列填入相应的数据库字段值,超级列表框的插入表项就是做这个用的.注意:最后一个参数用了"计次1"这个变量,这个参数是给每一个插入的表项加一个表项数值,而"计次1"的值正好是与表项相对应的数据库记录号一样,方便其它的按钮功能里调用这个值来直接修改数据库对应记录的值
        .插入表项 (记录集操作员 [1], , , , 计次1)
        1.未知支持库函数_26 (记录集操作员 [2])
         ' 下面这一行是在超级列表框的某的行的第二列写入数据库相应的字段值,超级列表框的行列起始值都是索引值0,这是给第二列写数据,下面的就都是一样的原理了.
        相减 (计次1, 1).置标题 (1, 记录集操作员 [2])
        2.未知支持库函数_26 (记录集操作员 [3])
        相减 (计次1, 1).置标题 (2, 记录集操作员 [3])
        3.未知支持库函数_26 (记录集操作员 [4])
        相减 (计次1, 1).置标题 (3, 记录集操作员 [4])
        4.未知支持库函数_26 (记录集操作员 [5])
        相减 (计次1, 1).置标题 (4, 记录集操作员 [5])
        5.未知支持库函数_26 (记录集操作员 [6])
        相减 (计次1, 1).置标题 (5, 记录集操作员 [6])
        6.未知支持库函数_26 (记录集操作员 [7])
        相减 (计次1, 1).置标题 (6, 记录集操作员 [7])
        7.未知支持库函数_26 (记录集操作员 [8])
        相减 (计次1, 1).置标题 (7, 记录集操作员 [8])
         ' 一行写完后,跳到下一条记录开始写第二行,如果没有第二行,循环也就结束了
        未知支持库函数_36 ()
    .计次循环尾 ()
.否则
    
.如果结束
 ' 写完数据后一定要记得关闭记录集和数据库连接,下面就是调用了"数据库"类模块里的断开来完成这个工作的
列用户连接.断开 ()

.子程序 _超级列表框_操作员_帐号列表_左键单击表项, 空白型, , 显示操作员的超级列表框被左键单击后要做到的功能
.局部变量 数据库, 数据库, , , 引用类模块对象
.局部变量 表项索引, 整数型, , "0", 用以返回超级列表框里当前被选择表项的索引
.局部变量 计次, 整数型, , , 循环计次
.局部变量 权限分割文本, 文本型, , "0", 将当前被选择表项的权限分割方便进行判断,因为权限可能有多个
.局部变量 级别, 文本型, , , 存放当前被选择表项里的级别文本

 ' 下面的程序代码要做到的事情很多,当超级列表框里的某行被单击后,将该行的信息在列表框下面的编辑框/选择框/单选框上反映出来
赋值 (计次, 1)
 ' 由于单击只会选择一行表项,因此只会用到表项索引数组中的[1],就是它的第一个变量,也是唯一的一个变量.下面的判断过程在主窗口的权限判断里都有用到,也有详细的备注说明
赋值 (表项索引, 取被选择表项 ())
.如果 (不等于 (取数组成员数 (表项索引), 0))
     ' 上面的如果语句里是判断表项索引数组里有没有变量,如果不等于0就是有变量,也就是说取被选择表项成功了,在最后的如果反之里提示了失败后的处理方法
    赋值 (.内容, 表项索引.取标题 ( [1], 0))
    赋值 (.内容, 表项索引.取标题 ( [1], 1))
    赋值 (.内容, 表项索引.取标题 ( [1], 2))
    赋值 (.内容, 表项索引.取标题 ( [1], 5))
    赋值 (权限分割文本, 分割文本 (表项索引.取标题 ( [1], 4), “&”, ))
    赋值 (级别, 表项索引.取标题 ( [1], 3))
    .判断开始 (等于 (级别, “管理员”))
        清空级别 ()
        赋值 (.选中, 真)
        _单选框_操作员_管理员_被单击 ()
    .判断 (等于 (级别, “业务主管”))
        清空级别 ()
        赋值 (.选中, 真)
        _单选框_操作员_业务主管_被单击 ()
    .判断 (等于 (级别, “市场主管”))
        清空级别 ()
        赋值 (.选中, 真)
        _单选框_操作员_市场主管_被单击 ()
    .判断 (等于 (级别, “人事主管”))
        清空级别 ()
        赋值 (.选中, 真)
        _单选框_操作员_人事主管_被单击 ()
    .判断 (等于 (级别, “内务主管”))
        清空级别 ()
        赋值 (.选中, 真)
        _单选框_操作员_内务主管_被单击 ()
    .判断 (等于 (级别, “岗位操作员”))
        清空级别 ()
        赋值 (.选中, 真)
        清空权限 ()
        .计次循环首 (取数组成员数 (权限分割文本), 计次)
            .如果 (等于 (权限分割文本 [计次], “受理”))
                赋值 (.选中, 真)
            .否则
                .如果 (等于 (权限分割文本 [计次], “查询”))
                    赋值 (.选中, 真)
                .否则
                    .如果 (等于 (权限分割文本 [计次], “检货”))
                        赋值 (.选中, 真)
                    .否则
                        .如果 (等于 (权限分割文本 [计次], “仓库”))
                            赋值 (.选中, 真)
                        .否则
                            .如果 (等于 (权限分割文本 [计次], “调度”))
                                赋值 (.选中, 真)
                            .否则
                                .如果 (等于 (权限分割文本 [计次], “人资”))
                                    赋值 (.选中, 真)
                                .否则
                                    .如果 (等于 (权限分割文本 [计次], “后勤”))
                                        赋值 (.选中, 真)
                                    .否则
                                        .如果 (等于 (权限分割文本 [计次], “市场”))
                                            赋值 (.选中, 真)
                                        .否则
                                            
                                        .如果结束
                                        
                                    .如果结束
                                    
                                .如果结束
                                
                            .如果结束
                            
                            
                            
                            
                            
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .计次循环尾 ()
    .默认
        
    .判断结束
    
.否则
    信息框 (“该表项为空!请选择有内容的表项!”, 0, )
    刷新显示 ()
    返回 ()
.如果结束


.子程序 _系统菜单窗口_创建完毕, 空白型, , 
.判断开始 (等于 (读配置项 (相加 (取当前目录 (), “\program.ini”), “数据库备份路径”, “路径”, ), “”))
    写配置项 (相加 (取当前目录 (), “\program.ini”), “数据库备份路径”, “路径”, 相加 (取当前目录 (), “\dbbak\”))
.判断 (等于 (读配置项 (相加 (取当前目录 (), “\program.ini”), “发货清单”, “表格路径”, ), “”))
    写配置项 (相加 (取当前目录 (), “\program.ini”), “发货清单项目”, “表格路径”, 相加 (取当前目录 (), “\grd_fhqd\”))
.默认
    
.判断结束

读程序配置文件 ()
读单号初始值 ()

.子程序 _单选框_操作员_管理员_被单击, 空白型, , 
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)

.子程序 _单选框_操作员_业务主管_被单击, 空白型, , 
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)


.子程序 _单选框_操作员_市场主管_被单击, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 真)


.子程序 _单选框_操作员_人事主管_被单击, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)


.子程序 _单选框_操作员_内务主管_被单击, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 真)
赋值 (.选中, 假)


.子程序 _单选框_操作员_岗位操作员_被单击, 空白型, , 
赋值 (.禁止, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)


.子程序 清空权限, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)


.子程序 清空级别, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)

.子程序 _按钮_操作员_修改_被单击, 空白型, , 
.局部变量 表项索引, 整数型, , "0", 用以返回超级列表框里当前被选择表项的索引
.局部变量 数据库, 数据库, , , 
.局部变量 权限, 文本型, , , 存放当前被选中的权限,多个权限以&隔开
.局部变量 计次, 整数型, , , 循环计次变量

赋值 (表项索引, 取被选择表项 ())
.如果 (等于 (.标题, “修  改”))
    .如果 (大于 (取数组成员数 (表项索引), 0))
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
    .否则
        信息框 (相加 (“请先点击列出用户按钮”, #换行符, “然后在列表框里选择要修改的项目”, #换行符, “再点击修改按钮”), 0, )
        返回 ()
    .如果结束
    赋值 (.标题, “保  存”)
.否则
    .如果 (等于 (.标题, “保  存”))
        数据库.开始查询 (“system.mdb”, , “select * from 操作员”, 1)
        表项索引.未知支持库函数_38 ( [1])
        0.未知支持库函数_20 (.内容)
        1.未知支持库函数_20 (.内容)
        2.未知支持库函数_20 (.内容)
        5.未知支持库函数_20 (.内容)
        
        .判断开始 (.选中)
            3.未知支持库函数_20 (.标题)
        .判断 (.选中)
            3.未知支持库函数_20 (.标题)
        .判断 (.选中)
            3.未知支持库函数_20 (.标题)
        .判断 (.选中)
            3.未知支持库函数_20 (.标题)
        .判断 (.选中)
            3.未知支持库函数_20 (.标题)
        .判断 (.选中)
            3.未知支持库函数_20 (.标题)
            .如果真 (等于 (.选中, 真))
                赋值 (权限, 相加 (权限, “受理&”))
            .如果真结束
            .如果真 (等于 (.选中, 真))
                赋值 (权限, 相加 (权限, “查询&”))
            .如果真结束
            .如果真 (等于 (.选中, 真))
                赋值 (权限, 相加 (权限, “检货&”))
            .如果真结束
            .如果真 (等于 (.选中, 真))
                赋值 (权限, 相加 (权限, “仓库&”))
            .如果真结束
            .如果真 (等于 (.选中, 真))
                赋值 (权限, 相加 (权限, “调度&”))
            .如果真结束
            .如果真 (等于 (.选中, 真))
                赋值 (权限, 相加 (权限, “人资&”))
            .如果真结束
            .如果真 (等于 (.选中, 真))
                赋值 (权限, 相加 (权限, “后勤&”))
            .如果真结束
            .如果真 (等于 (.选中, 真))
                赋值 (权限, 相加 (权限, “市场&”))
            .如果真结束
            
        .默认
            
        .判断结束
        赋值 (权限, 取文本左边 (权限, 相减 (取文本长度 (权限), 1)))
        4.未知支持库函数_20 (权限)
        .如果 (未知支持库函数_18 ())
            赋值 (.禁止, 真)
            赋值 (.禁止, 真)
            赋值 (.禁止, 真)
            赋值 (.禁止, 真)
            赋值 (.禁止, 真)
            赋值 (.禁止, 真)
            信息框 (“数据修改成功!”, 0, )
        .否则
            信息框 (相加 (“数据修改失败!”, 取错误信息 ()), 0, )
            赋值 (.禁止, 真)
            赋值 (.禁止, 真)
            赋值 (.禁止, 真)
            赋值 (.禁止, 真)
            赋值 (.禁止, 真)
            赋值 (.禁止, 真)
            
        .如果结束
        赋值 (.标题, “修  改”)
        数据库.断开 ()
    .否则
        
    .如果结束
    
.如果结束


.子程序 _按钮_操作员_删除_被单击, 空白型, , 
.局部变量 表项索引, 整数型, , "0", 用以返回超级列表框里当前被选择表项的索引
.局部变量 数据库, 数据库, , , 

赋值 (表项索引, 取被选择表项 ())
.如果 (数据库.开始查询 (“system.mdb”, , “select * from 操作员”, 1))
    表项索引.未知支持库函数_38 ( [1])
    1.未知支持库函数_19 ()
    .如果 (未知支持库函数_18 ())
        信息框 (“删除成功!”, 0, )
    .否则
        信息框 (相加 (“删除失败!”, 取错误信息 ()), 0, )
    .如果结束
    
.否则
    
.如果结束


.子程序 _按钮_操作员_添加_被单击, 空白型, , 
.局部变量 数据库, 数据库, , , 
.局部变量 权限, 文本型, , , 
.局部变量 计次, 整数型, , , 

.如果 (等于 (.标题, “添  加”))
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    
    赋值 (.标题, “保  存”)
    
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.选中, 真)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
.否则
    .如果 (等于 (.标题, “保  存”))
        .如果 (数据库.开始查询 (“system.mdb”, , “select * from 操作员”, 1))
            .如果 (未知支持库函数_17 ())
                0.未知支持库函数_20 (.内容)
                1.未知支持库函数_20 (.内容)
                2.未知支持库函数_20 (.内容)
                5.未知支持库函数_20 (.内容)
                
                .判断开始 (.选中)
                    3.未知支持库函数_20 (.标题)
                .判断 (.选中)
                    3.未知支持库函数_20 (.标题)
                .判断 (.选中)
                    3.未知支持库函数_20 (.标题)
                .判断 (.选中)
                    3.未知支持库函数_20 (.标题)
                .判断 (.选中)
                    3.未知支持库函数_20 (.标题)
                .判断 (.选中)
                    3.未知支持库函数_20 (.标题)
                    .如果真 (等于 (.选中, 真))
                        赋值 (权限, 相加 (权限, “受理&”))
                    .如果真结束
                    .如果真 (等于 (.选中, 真))
                        赋值 (权限, 相加 (权限, “查询&”))
                    .如果真结束
                    .如果真 (等于 (.选中, 真))
                        赋值 (权限, 相加 (权限, “检货&”))
                    .如果真结束
                    .如果真 (等于 (.选中, 真))
                        赋值 (权限, 相加 (权限, “仓库&”))
                    .如果真结束
                    .如果真 (等于 (.选中, 真))
                        赋值 (权限, 相加 (权限, “调度&”))
                    .如果真结束
                    .如果真 (等于 (.选中, 真))
                        赋值 (权限, 相加 (权限, “人资&”))
                    .如果真结束
                    .如果真 (等于 (.选中, 真))
                        赋值 (权限, 相加 (权限, “后勤&”))
                    .如果真结束
                    .如果真 (等于 (.选中, 真))
                        赋值 (权限, 相加 (权限, “市场&”))
                    .如果真结束
                    
                .默认
                    
                .判断结束
                赋值 (权限, 取文本左边 (权限, 相减 (取文本长度 (权限), 1)))
                4.未知支持库函数_20 (权限)
                .如果 (未知支持库函数_18 ())
                    赋值 (.禁止, 真)
                    赋值 (.禁止, 真)
                    赋值 (.禁止, 真)
                    赋值 (.禁止, 真)
                    赋值 (.禁止, 真)
                    赋值 (.禁止, 真)
                    信息框 (“添加操作员成功!”, 0, )
                .否则
                    信息框 (相加 (“添加操作员失败!”, 取错误信息 ()), 0, )
                    赋值 (.禁止, 真)
                    赋值 (.禁止, 真)
                    赋值 (.禁止, 真)
                    赋值 (.禁止, 真)
                    赋值 (.禁止, 真)
                    赋值 (.禁止, 真)
                    
                .如果结束
                赋值 (.标题, “添  加”)
                数据库.断开 ()
                
            .否则
                
            .如果结束
            
        .否则
            信息框 (相加 (“打开数据库失败!”, 取错误信息 ()), 0, )
        .如果结束
        
    .否则
        
    .如果结束
    
.如果结束


.子程序 _按钮_主窗口设置_保存_被单击, 空白型, , 
.如果 (并且 (写配置项 (相加 (取当前目录 (), “\program.ini”), “主窗口标题”, “主窗口标题设置”, .内容), 写配置项 (相加 (取当前目录 (), “\program.ini”), “数据库备份路径”, “路径”, .内容)))
    信息框 (“主窗口标题写入配置文件成功!”, 0, )
.否则
    信息框 (相加 (“主窗口标题写入配置文件失败!”, #换行符, 取错误信息 ()), 0, )
    返回 ()
.如果结束


.子程序 _按钮_业务_保存_被单击, 空白型, , 
写配置项 (相加 (取当前目录 (), “\program.ini”), “业务单项目”, “发货方式”, .内容)
写配置项 (相加 (取当前目录 (), “\program.ini”), “业务单项目”, “发货类型”, .内容)
写配置项 (相加 (取当前目录 (), “\program.ini”), “业务单项目”, “结算方式”, .内容)
写配置项 (相加 (取当前目录 (), “\program.ini”), “业务单项目”, “重要提示”, .内容)
写配置项 (相加 (取当前目录 (), “\program.ini”), “发货清单项目”, “司机姓名”, .内容)
写配置项 (相加 (取当前目录 (), “\program.ini”), “发货清单项目”, “表格路径”, .内容)
写配置项 (相加 (取当前目录 (), “\program.ini”), “客户投诉项目”, “投诉类别”, .内容)
写配置项 (相加 (取当前目录 (), “\program.ini”), “代理机构项目”, “机构类型”, .内容)
写配置项 (相加 (取当前目录 (), “\program.ini”), “检货异常情况项目”, “异常情况类型”, .内容)


.子程序 _按钮_调度_保存_被单击, 空白型, , 
写配置项 (相加 (取当前目录 (), “\program.ini”), “车辆信息项目”, “车型”, .内容)
写配置项 (相加 (取当前目录 (), “\program.ini”), “车辆信息项目”, “产权”, .内容)
写配置项 (相加 (取当前目录 (), “\program.ini”), “维修保养项目”, “事件”, .内容)
写配置项 (相加 (取当前目录 (), “\program.ini”), “维修保养项目”, “更换配件名称”, .内容)
写配置项 (相加 (取当前目录 (), “\program.ini”), “维修保养项目”, “维修厂名称”, .内容)
写配置项 (相加 (取当前目录 (), “\program.ini”), “加油项目”, “加油类型”, .内容)
写配置项 (相加 (取当前目录 (), “\program.ini”), “加油项目”, “结款方式”, .内容)


.子程序 _按钮_后勤_保存_被单击, 空白型, , 
写配置项 (相加 (取当前目录 (), “\program.ini”), “办公用品”, “物品名称”, .内容)
写配置项 (相加 (取当前目录 (), “\program.ini”), “房租水电通讯费”, “费用名称”, .内容)
写配置项 (相加 (取当前目录 (), “\program.ini”), “食堂用料及饮用水”, “餐饮物品名称”, .内容)
写配置项 (相加 (取当前目录 (), “\program.ini”), “电器设备”, “设备名称”, .内容)
写配置项 (相加 (取当前目录 (), “\program.ini”), “应酬招待”, “招待项目”, .内容)


.子程序 读程序配置文件, 空白型, , 
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\program.ini”), “主窗口标题”, “主窗口标题设置”, ))
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\program.ini”), “数据库备份路径”, “路径”, ))
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\program.ini”), “数据库备份路径”, “路径”, ))
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\program.ini”), “业务单项目”, “发货方式”, ))
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\program.ini”), “业务单项目”, “发货类型”, ))
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\program.ini”), “业务单项目”, “结算方式”, ))
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\program.ini”), “业务单项目”, “重要提示”, ))
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\program.ini”), “发货清单项目”, “司机姓名”, ))
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\program.ini”), “发货清单项目”, “表格路径”, ))
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\program.ini”), “客户投诉项目”, “投诉类别”, ))
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\program.ini”), “代理机构项目”, “机构类型”, ))
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\program.ini”), “检货异常情况项目”, “异常情况类型”, ))
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\program.ini”), “车辆信息项目”, “车型”, ))
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\program.ini”), “车辆信息项目”, “产权”, ))
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\program.ini”), “维修保养项目”, “事件”, ))
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\program.ini”), “维修保养项目”, “更换配件名称”, ))
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\program.ini”), “维修保养项目”, “维修厂名称”, ))
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\program.ini”), “加油项目”, “加油类型”, ))
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\program.ini”), “加油项目”, “结款方式”, ))
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\program.ini”), “办公用品”, “物品名称”, ))
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\program.ini”), “房租水电通讯费”, “费用名称”, ))
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\program.ini”), “食堂用料及饮用水”, “餐饮物品名称”, ))
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\program.ini”), “电器设备”, “设备名称”, ))
赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\program.ini”), “应酬招待”, “招待项目”, ))


.子程序 读单号初始值, 空白型, , 
.局部变量 数据库, 数据库, , , 
.局部变量 业务单号, 文本型, , , 
.局部变量 检货号, 文本型, , , 
.局部变量 发货清单号, 文本型, , , 
.局部变量 调度单号, 文本型, , , 

.如果 (数据库.开始查询 (“system.mdb”, , “select * from 单号起始值”, 1))
    .如果 (大于 (., 0))
        未知支持库函数_34 ()
        1.未知支持库函数_26 (业务单号)
        2.未知支持库函数_26 (检货号)
        3.未知支持库函数_26 (发货清单号)
        4.未知支持库函数_26 (调度单号)
        赋值 (.内容, 业务单号)
        赋值 (.内容, 检货号)
        赋值 (.内容, 发货清单号)
        赋值 (.内容, 调度单号)
        数据库.断开 ()
    .否则
        
    .如果结束
    
.否则
    
.如果结束


.子程序 _按钮_单号起始值_保存_被单击, 空白型, , 
.局部变量 数据库, 数据库, , , 

相加 (取当前目录 (), “\data\system.mdb”).未知支持库函数_1 (“”)
.未知支持库函数_12 ()
“单号起始值”.未知支持库函数_14 (2)
.如果 (大于 (., 0))
    未知支持库函数_34 ()
    1.未知支持库函数_20 (.内容)
    2.未知支持库函数_20 (.内容)
    3.未知支持库函数_20 (.内容)
    4.未知支持库函数_20 (.内容)
    未知支持库函数_18 ()
    信息框 (“保存成功.”, 0, )
    未知支持库函数_16 ()
    
.否则
    未知支持库函数_17 ()
    未知支持库函数_34 ()
    1.未知支持库函数_20 (.内容)
    2.未知支持库函数_20 (.内容)
    3.未知支持库函数_20 (.内容)
    4.未知支持库函数_20 (.内容)
    未知支持库函数_18 ()
    未知支持库函数_16 ()
    信息框 (“保存成功.”, 0, )
    
.如果结束

.如果 (“累加单号值”.未知支持库函数_14 (2))
    未知支持库函数_34 ()
    0.未知支持库函数_20 (.内容)
    1.未知支持库函数_20 (.内容)
    2.未知支持库函数_20 (.内容)
    3.未知支持库函数_20 (.内容)
    未知支持库函数_18 ()
    未知支持库函数_16 ()
    
.否则
    信息框 (“在打开累加单号值表时出现意外错误!请联系管理员解决此问题!”, 0, )
.如果结束

未知支持库函数_3 ()



.子程序 _按钮_数据库备份_备份_被单击, 空白型, , 
.局部变量 压缩返回值, 整数型, , , 压缩后的返回值,用以判断压缩成功否
.局部变量 默认备份路径, 文本型, , , 

赋值 (默认备份路径, 相加 (取当前目录 (), “\dbbak\”))
创建目录 (相加 (取当前目录 (), “\dbbak_temp”))
.如果真 (等于 (.选中, 真))
    复制文件 (相加 (取当前目录 (), “\data\system.mdb”), 相加 (取当前目录 (), “\dbbak_temp\system.mdb”))
.如果真结束
.如果真 (等于 (.选中, 真))
    复制文件 (相加 (取当前目录 (), “\data\main.mdb”), 相加 (取当前目录 (), “\dbbak_temp\main.mdb”))
.如果真结束
.如果真 (等于 (.选中, 真))
    复制文件 (相加 (取当前目录 (), “\data\ywzhxx.mdb”), 相加 (取当前目录 (), “\dbbak_temp\ywzhxx.mdb”))
.如果真结束
.如果真 (等于 (.选中, 真))
    复制文件 (相加 (取当前目录 (), “\data\ddxx.mdb”), 相加 (取当前目录 (), “\dbbak_temp\ddxx.mdb”))
.如果真结束
.如果真 (等于 (.选中, 真))
    复制文件 (相加 (取当前目录 (), “\data\rzhq.mdb”), 相加 (取当前目录 (), “\dbbak_temp\rzhq.mdb”))
.如果真结束
.如果真 (等于 (.选中, 真))
    复制文件 (相加 (取当前目录 (), “\data\sc.mdb”), 相加 (取当前目录 (), “\dbbak_temp\sc.mdb”))
.如果真结束
.如果真 (等于 (.选中, 真))
    复制文件 (相加 (取当前目录 (), “\data\jlxx.mdb”), 相加 (取当前目录 (), “\dbbak_temp\jlxx.mdb”))
.如果真结束

.如果真 (不等于 (.内容, 默认备份路径))
    创建目录 (.内容)
    
.如果真结束
赋值 (压缩返回值, 相加 (取当前目录 (), “\dbbak_temp”).未知支持库函数_0 (相加 (.内容, 到文本 (取日期 (取现行时间 ())), “.bak”)))
.判断开始 (等于 (压缩返回值, 1))
    信息框 (相加 (“数据库已成功备份到”, .内容), 0, )
    删除目录 (相加 (取当前目录 (), “\dbbak_temp”))
    写配置项 (相加 (取当前目录 (), “\dbbak.ini”), “数据库备份”, “默认备份路径”, 默认备份路径)
    写配置项 (相加 (取当前目录 (), “\dbbak.ini”), “数据库备份”, “实际备份路径”, .内容)
    写配置项 (相加 (取当前目录 (), “\dbbak.ini”), “数据库备份”, “备份文件名”, 相加 (到文本 (取日期 (取现行时间 ())), “.bak”))
    写配置项 (相加 (取当前目录 (), “\dbbak.ini”), “数据库备份”, “备份时间”, 到文本 (取时间 (取现行时间 ())))
    
.判断 (等于 (压缩返回值, 0))
    信息框 (相加 (“数据库备份失败!”, 取错误信息 ()), 0, )
    删除目录 (相加 (取当前目录 (), “\dbbak_temp”))
    
.判断 (等于 (压缩返回值, -1))
    信息框 (相加 (“数据库备份失败!原因是参数错误,”, #换行符, “请检查备份路径输入框中的路径是”, #换行符, “否真实有效,后然再次备份!”), 0, )
    删除目录 (相加 (取当前目录 (), “\dbbak_temp”))
    
.默认
    
.判断结束


.子程序 _按钮_数据库备份_恢复_被单击, 空白型, , 
.局部变量 实际备份路径, 文本型, , , 
.局部变量 备份时间, 文本型, , , 
.局部变量 备份文件名, 文本型, , , 
.局部变量 解压返回值, 整数型, , , 
.局部变量 信息框返回值, 整数型, , , 

赋值 (实际备份路径, 读配置项 (相加 (取当前目录 (), “\dbbak.ini”), “数据库备份”, “实际备份路径”, ))
赋值 (备份时间, 读配置项 (相加 (取当前目录 (), “\dbbak.ini”), “数据库备份”, “备份时间”, ))
赋值 (备份文件名, 读配置项 (相加 (取当前目录 (), “\dbbak.ini”), “数据库备份”, “备份文件名”, ))
.如果 (并且 (不等于 (实际备份路径, “”), 不等于 (备份时间, “”), 不等于 (备份文件名, “”)))
    赋值 (信息框返回值, 信息框 (相加 (“上次备份时间为”, 备份时间, #换行符, “如果恢复备份,将改变当前的数据库信息.真的要进行吗?”), 相加 (#是否钮, #警告图标), “请确认是否要进行数据恢复”))
    .判断开始 (等于 (信息框返回值, 5))
        赋值 (解压返回值, 相加 (实际备份路径, 备份文件名).未知支持库函数_2 (相加 (取当前目录 (), “\data\”)))
        .判断开始 (等于 (解压返回值, 1))
            信息框 (“备份已成功恢复!”, 0, )
            返回 ()
        .判断 (等于 (解压返回值, 0))
            信息框 (相加 (“备份恢复失败!”, 取错误信息 ()), 0, )
            返回 ()
        .判断 (等于 (解压返回值, -1))
            信息框 (“备份在恢复时发生参数错误,请联系网管解决.”, 0, )
            返回 ()
        .默认
            
        .判断结束
        
    .判断 (等于 (信息框返回值, 6))
        信息框 (“用户取消了当前的恢复操作!”, 0, )
        返回 ()
    .默认
        
    .判断结束
    
.否则
    信息框 (相加 (“你还没有进行过备份,或是手工删除了程序运行目录下的备份配置文件,”, #换行符, “恢复程序得不到足够的信息,操作将取消.”), 0, )
.如果结束




.窗口程序集 窗口程序集4, , , 

.程序集变量 数据库, 数据库, , , 引用类模块
.程序集变量 匿名程序集变量_3294, 空白型, , , 
.子程序 _受理菜单窗口_将被销毁, 空白型, , 
赋值 (受理菜单窗口., 假)
赋值 (主窗口., 假)
主窗口.获取焦点 ()

.子程序 _受理菜单窗口_创建完毕, 空白型, , 
.局部变量 分割投诉类别, 文本型, , "0", 
.局部变量 分割机构类型, 文本型, , "0", 
.局部变量 计次, 整数型, , , 

赋值 (.内容, 操作员)
赋值 (.内容, 到文本 (取现行时间 ()))
赋值 (分割投诉类别, 分割文本 (读配置项 (相加 (取当前目录 (), “\program.ini”), “客户投诉项目”, “投诉类别”, “破损&晚点&丢失&回单&代收款&其它”), “&”, ))
.计次循环首 (取数组成员数 (分割投诉类别), 计次)
    分割投诉类别.加入项目 ( [计次], )
.计次循环尾 ()
赋值 (分割投诉类别, 分割文本 (读配置项 (相加 (取当前目录 (), “\program.ini”), “代理机构项目”, “机构类型”, “航空&铁路”), “&”, ))
.计次循环首 (取数组成员数 (分割机构类型), 计次)
    分割机构类型.加入项目 ( [计次], )
.计次循环尾 ()
赋值 (.内容, 到文本 (取日期 (取现行时间 ())))


.子程序 _按钮_签收信息录入_业务单号_被单击, 空白型, , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 临时_日期, 日期时间型, , , 
.局部变量 计次, 整数型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请先输入业务单号!”, 0, )
    返回 ()
.如果真结束
数据库.开始查询 (“main.mdb”, , “业务单”, 2)
相加 (“开票时间 > '”, 到文本 (增减时间 (取日期 (取现行时间 ()), #日, -15)), “'”).未知支持库函数_47 () ' 把记录过滤到半个月以内的,因为超过半个月还没签收的情况,基本上是不会有的.
未知支持库函数_34 ()
.计次循环首 (., 计次)
    “业务单号”.未知支持库函数_26 (临时_文本)
    .如果 (等于 (临时_文本, .内容))
        “签收录入时间”.未知支持库函数_31 (临时_日期)
        赋值 (.内容, 到文本 (临时_日期))
        “签收人”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “签收时间”.未知支持库函数_31 (临时_日期)
        赋值 (.内容, 到文本 (临时_日期))
        “结款否”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “结款金额”.未知支持库函数_29 (临时_整数)
        赋值 (.内容, 到文本 (临时_整数))
        “结款时间”.未知支持库函数_31 (临时_日期)
        赋值 (.内容, 到文本 (临时_日期))
        跳出循环 ()
    .否则
        未知支持库函数_36 ()
    .如果结束
    
.计次循环尾 ()
“”.未知支持库函数_47 ()
数据库.断开 ()

.子程序 _按钮_签收录入_保存_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 

数据库.开始查询 (“main.mdb”, , “业务单”, 2)
相加 (“开票时间 > '”, 到文本 (增减时间 (取日期 (取现行时间 ()), #日, -15)), “'”).未知支持库函数_47 () ' 把记录过滤到半个月以内的,因为超过半个月还没签收的情况,基本上是不会有的.
未知支持库函数_34 ()
.计次循环首 (., 计次)
    “业务单号”.未知支持库函数_26 (临时_文本)
    .如果 (等于 (临时_文本, .内容))
        “签收录入人”.未知支持库函数_20 (.内容)
        “签收录入时间”.未知支持库函数_25 (到时间 (.内容))
        “签收时间”.未知支持库函数_25 (到时间 (.内容))
        “签收人”.未知支持库函数_20 (.内容)
        “结款否”.未知支持库函数_20 (.内容)
        “结款金额”.未知支持库函数_23 (到数值 (.内容))
        “结款时间”.未知支持库函数_25 (到时间 (.内容))
        .如果 (未知支持库函数_18 ())
            信息框 (“保存成功!”, 0, )
            清空签收录入界面 ()
            跳出循环 ()
        .否则
            信息框 (“保存失败!”, 0, )
            返回 ()
        .如果结束
        
    .否则
        未知支持库函数_36 ()
    .如果结束
    
.计次循环尾 ()
“”.未知支持库函数_47 ()
数据库.断开 ()

.子程序 清空签收录入界面, 空白型, , 
赋值 (.内容, 操作员)
赋值 (.内容, 到文本 (取现行时间 ()))
赋值 (.内容, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 到文本 (取月份 (取现行时间 ())), “月”))
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 到文本 (取月份 (取现行时间 ())), “月”))


.子程序 _按钮_客户信息_保存_被单击, 空白型, , 
数据库.开始查询 (“ywzhxx.mdb”, , “客户信息”, 2)
未知支持库函数_17 ()
未知支持库函数_35 ()
“单位名称”.未知支持库函数_20 (.内容)
“联系人”.未知支持库函数_20 (.内容)
“地址”.未知支持库函数_20 (.内容)
“座机号”.未知支持库函数_20 (.内容)
“手机号”.未知支持库函数_20 (.内容)
“主要货物种类”.未知支持库函数_20 (.内容)
“发货目的地”.未知支持库函数_20 (.内容)
“货物特点”.未知支持库函数_20 (.内容)
“小灵通号”.未知支持库函数_20 (.内容)
“累计发货次数”.未知支持库函数_23 (到数值 (.内容))
“最后发货日期”.未知支持库函数_25 (到时间 (.内容))
.如果 (未知支持库函数_18 ())
    信息框 (“保存成功!”, 0, )
    清空客户录入界面 ()
.否则
    信息框 (“保存失败!”, 0, )
.如果结束
数据库.断开 ()

.子程序 清空客户录入界面, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, 到文本 (取日期 (取现行时间 ())))


.子程序 _按钮_客户信息_单位名称_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 临时_日期, 日期时间型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请先输入单位名称!”, 0, )
    返回 ()
.如果真结束
数据库.开始查询 (“ywzhxx.mdb”, , “客户信息”, 2)
未知支持库函数_34 ()
.计次循环首 (., 计次)
    “单位名称”.未知支持库函数_26 (临时_文本)
    .如果 (取反 (等于 (寻找文本 (临时_文本, .内容, 1, 真), -1)))
        “单位名称”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “联系人”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “地址”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “座机号”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “手机号”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “小灵通号”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “主要货物种类”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “发货目的地”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “货物特点”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “累计发货次数”.未知支持库函数_29 (临时_整数)
        赋值 (.内容, 到文本 (临时_整数))
        “最后发货日期”.未知支持库函数_31 (临时_日期)
        赋值 (.内容, 到文本 (临时_日期))
        跳出循环 ()
    .否则
        未知支持库函数_36 ()
    .如果结束
    
.计次循环尾 ()
数据库.断开 ()

.子程序 _按钮_客户信息_联系人_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 临时_日期, 日期时间型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请先输入联系人姓名!”, 0, )
    返回 ()
.如果真结束

数据库.开始查询 (“ywzhxx.mdb”, , “客户信息”, 2)
未知支持库函数_34 ()
.计次循环首 (., 计次)
    “联系人”.未知支持库函数_26 (临时_文本)
    .如果 (等于 (临时_文本, .内容))
        “单位名称”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “地址”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “座机号”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “手机号”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “小灵通号”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “主要货物种类”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “发货目的地”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “货物特点”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “累计发货次数”.未知支持库函数_29 (临时_整数)
        赋值 (.内容, 到文本 (临时_整数))
        “最后发货日期”.未知支持库函数_31 (临时_日期)
        赋值 (.内容, 到文本 (临时_日期))
        跳出循环 ()
    .否则
        未知支持库函数_36 ()
    .如果结束
    
.计次循环尾 ()
数据库.断开 ()


.子程序 _按钮_外部合作公司_保存_被单击, 空白型, , 
数据库.开始查询 (“ywzhxx.mdb”, , “外部合作公司”, 2)
未知支持库函数_17 ()
未知支持库函数_35 ()
“公司名称”.未知支持库函数_20 (.内容)
“公司地址”.未知支持库函数_20 (.内容)
“优势线路”.未知支持库函数_20 (.内容)
“优势价格”.未知支持库函数_20 (.内容)
“受理联系人”.未知支持库函数_20 (.内容)
“受理电话”.未知支持库函数_20 (.内容)
“业务主管”.未知支持库函数_20 (.内容)
“业务主管手机”.未知支持库函数_20 (.内容)
“总经理”.未知支持库函数_20 (.内容)
“总经理电话”.未知支持库函数_20 (.内容)
“总经理手机”.未知支持库函数_20 (.内容)
“结款方式”.未知支持库函数_20 (.内容)
“累计合作次数”.未知支持库函数_23 (到数值 (.内容))
“最后合作日期”.未知支持库函数_25 (到时间 (.内容))
.如果 (未知支持库函数_18 ())
    信息框 (“保存成功!”, 0, )
    清空外部合作公司界面 ()
.否则
    信息框 (“保存失败!”, 0, )
.如果结束
数据库.断开 ()


.子程序 清空外部合作公司界面, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, 到文本 (取日期 (取现行时间 ())))


.子程序 _按钮_外部合作公司_公司名称_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 临时_日期, 日期时间型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请先输入公司名称!”, 0, )
    返回 ()
.如果真结束

数据库.开始查询 (“ywzhxx.mdb”, , “外部合作公司”, 2)
未知支持库函数_34 ()
.计次循环首 (., 计次)
    “公司名称”.未知支持库函数_26 (临时_文本)
    .如果 (取反 (等于 (寻找文本 (临时_文本, .内容, 1, 真), -1)))
        “公司名称”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “公司地址”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “优势线路”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “优势价格”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “受理联系人”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “受理电话”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “业务主管”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “业务主管手机”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “总经理”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “总经理电话”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “总经理手机”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “结款方式”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “累计合作次数”.未知支持库函数_29 (临时_整数)
        赋值 (.内容, 到文本 (临时_整数))
        “最后合作日期”.未知支持库函数_31 (临时_日期)
        赋值 (.内容, 到文本 (临时_日期))
        跳出循环 ()
    .否则
        未知支持库函数_36 ()
    .如果结束
    
.计次循环尾 ()
数据库.断开 ()


.子程序 _按钮_客户投诉_保存_被单击, 空白型, , 
数据库.开始查询 (“ywzhxx.mdb”, , “客户投诉”, 2)
未知支持库函数_17 ()
未知支持库函数_35 ()
“客户名称”.未知支持库函数_20 (.内容)
“投诉人”.未知支持库函数_20 (.内容)
“投诉时间”.未知支持库函数_25 (到时间 (.内容))
“联系电话”.未知支持库函数_20 (.内容)
“投诉类别”.未知支持库函数_20 (.内容)
“投诉态度”.未知支持库函数_20 (.内容)
“投诉内容”.未知支持库函数_20 (.内容)
“紧急程序”.未知支持库函数_20 (.内容)
“接待人”.未知支持库函数_20 (.内容)
“我方处理意见”.未知支持库函数_20 (.内容)
“对方处理意见”.未知支持库函数_20 (.内容)
“处理结果”.未知支持库函数_20 (.内容)
“客户满意程度”.未知支持库函数_20 (.内容)
“投诉次数”.未知支持库函数_23 (到数值 (.内容))
“最后投诉日期”.未知支持库函数_25 (到时间 (.内容))
.如果 (未知支持库函数_18 ())
    信息框 (“保存成功!”, 0, )
    清空客户投诉界面 ()
.否则
    信息框 (“保存失败!”, 0, )
.如果结束
数据库.断开 ()


.子程序 清空客户投诉界面, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.现行选中项, 0)
赋值 (.现行选中项, 0)
赋值 (.内容, “”)
赋值 (.现行选中项, 0)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.现行选中项, 0)
赋值 (.内容, “”)
赋值 (.内容, 到文本 (取日期 (取现行时间 ())))


.子程序 _按钮_客户投诉_客户名称_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 临时_日期, 日期时间型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请先输入客户名称!”, 0, )
    返回 ()
.如果真结束

数据库.开始查询 (“ywzhxx.mdb”, , “客户投诉”, 2)
未知支持库函数_34 ()
.计次循环首 (., 计次)
    “客户名称”.未知支持库函数_26 (临时_文本)
    .如果 (取反 (等于 (寻找文本 (临时_文本, .内容, 1, 真), -1)))
        “客户名称”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “投诉人”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “投诉时间”.未知支持库函数_31 (临时_日期)
        赋值 (.内容, 到文本 (临时_日期))
        “联系电话”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “投诉类别”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “投诉内容”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “投诉态度”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “紧急程度”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “接待人”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “我方处理意见”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “对方处理意见”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “处理结果”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “客户满意程度”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “投诉次数”.未知支持库函数_29 (临时_整数)
        赋值 (.内容, 到文本 (临时_整数))
        “最后投诉日期”.未知支持库函数_31 (临时_日期)
        赋值 (.内容, 到文本 (临时_日期))
        跳出循环 ()
    .否则
        未知支持库函数_36 ()
    .如果结束
    
.计次循环尾 ()
数据库.断开 ()


.子程序 _按钮_代理机构_保存_被单击, 空白型, , 
数据库.开始查询 (“ywzhxx.mdb”, , “代理机构记录”, 2)
未知支持库函数_17 ()
未知支持库函数_35 ()
“机构类型”.未知支持库函数_20 (.内容)
“机构名称”.未知支持库函数_20 (.内容)
“联系人”.未知支持库函数_20 (.内容)
“联系电话”.未知支持库函数_20 (.内容)
“到达地”.未知支持库函数_20 (.内容)
“代理价格”.未知支持库函数_20 (.内容)
.如果 (未知支持库函数_18 ())
    信息框 (“保存成功!”, 0, )
    清空代理机构界面 ()
.否则
    信息框 (“保存失败!”, 0, )
.如果结束
数据库.断开 ()


.子程序 清空代理机构界面, 空白型, , 
赋值 (.现行选中项, 0)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)


.子程序 _按钮_代理机构_机构名称_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请先输入代理机构名称!”, 0, )
    返回 ()
.如果真结束
数据库.开始查询 (“ywzhxx.mdb”, , “代理机构记录”, 2)
未知支持库函数_34 ()
.计次循环首 (., 计次)
    “机构名称”.未知支持库函数_26 (临时_文本)
    .如果 (取反 (等于 (寻找文本 (临时_文本, .内容, 1, 真), -1)))
        “机构类型”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “机构名称”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “联系人”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “联系电话”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “到达地”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “代理价格”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        跳出循环 ()
    .否则
        未知支持库函数_36 ()
    .如果结束
    
.计次循环尾 ()
数据库.断开 ()


.子程序 _按钮_代理机构_联系人_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请先输入联系人姓名!”, 0, )
    返回 ()
.如果真结束
数据库.开始查询 (“ywzhxx.mdb”, , “代理机构记录”, 2)
未知支持库函数_34 ()
.计次循环首 (., 计次)
    “联系人”.未知支持库函数_26 (临时_文本)
    .如果 (等于 (临时_文本, .内容))
        “机构类型”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “机构名称”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “联系人”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “联系电话”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “到达地”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “代理价格”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        跳出循环 ()
    .否则
        未知支持库函数_36 ()
    .如果结束
    
.计次循环尾 ()
数据库.断开 ()


.窗口程序集 窗口程序集5, , , 

.程序集变量 过滤条件, 文本型, , , 存放判断后的过滤条件,因为是多条件查询,所以得判断用户选择了多少个条件,并需要把选择的条件组合起来
.程序集变量 数据库, 数据库, , , 
.子程序 _查询菜单窗口_将被销毁, 空白型, , 
赋值 (主窗口., 假)
主窗口.获取焦点 ()

.子程序 _查询菜单窗口_创建完毕, 空白型, , 


.子程序 _按钮_业务状态_业务单号_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请先输入要查询的业务单号!”, 0, )
    返回 ()
.如果真结束
数据库.开始查询 (“main.mdb”, , “业务状态”, 2)
.计次循环首 (., 计次)
    “业务单号”.未知支持库函数_26 (临时_文本)
    .如果 (等于 (临时_文本, .内容))
        “已受理”.未知支持库函数_26 (临时_文本)
        .如果真 (等于 (临时_文本, “是”))
            赋值 (.选中, 真)
        .如果真结束
        “已入库”.未知支持库函数_26 (临时_文本)
        .如果真 (等于 (临时_文本, “是”))
            赋值 (.选中, 真)
        .如果真结束
        “已出库”.未知支持库函数_26 (临时_文本)
        .如果真 (等于 (临时_文本, “是”))
            赋值 (.选中, 真)
        .如果真结束
        “已物流”.未知支持库函数_26 (临时_文本)
        .如果真 (等于 (临时_文本, “是”))
            赋值 (.选中, 真)
        .如果真结束
        “已中转”.未知支持库函数_26 (临时_文本)
        .如果真 (等于 (临时_文本, “是”))
            赋值 (.选中, 真)
        .如果真结束
        “已到港”.未知支持库函数_26 (临时_文本)
        .如果真 (等于 (临时_文本, “是”))
            赋值 (.选中, 真)
        .如果真结束
        “已派送”.未知支持库函数_26 (临时_文本)
        .如果真 (等于 (临时_文本, “是”))
            赋值 (.选中, 真)
        .如果真结束
        “已签收”.未知支持库函数_26 (临时_文本)
        .如果真 (等于 (临时_文本, “是”))
            赋值 (.选中, 真)
        .如果真结束
        “已结款”.未知支持库函数_26 (临时_文本)
        .如果真 (等于 (临时_文本, “是”))
            赋值 (.选中, 真)
        .如果真结束
        
    .否则
        未知支持库函数_36 ()
    .如果结束
    
.计次循环尾 ()
数据库.断开 ()

.子程序 _超级按钮_业务单查询_开始查询_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 临时_日期, 日期时间型, , , 

赋值 (过滤条件, “”) ' 将过滤条件初始为空
全部删除 ()
 ' 以下如果真语句系统把过滤条件拼接起来了
.如果真 (并且 (等于 (.选中, 真), 不等于 (.内容, “”)))
    赋值 (过滤条件, 相加 (过滤条件, “ and 业务单号= '”, .内容, “'”))
.如果真结束
.如果真 (并且 (等于 (.选中, 真), 不等于 (.内容, “”)))
    赋值 (过滤条件, 相加 (过滤条件, “ and 发货方式= '”, .内容, “'”))
.如果真结束
.如果真 (并且 (等于 (.选中, 真), 不等于 (.内容, “”)))
    赋值 (过滤条件, 相加 (过滤条件, “ and 发货类型= '”, .内容, “'”))
.如果真结束
.如果真 (并且 (等于 (.选中, 真), 不等于 (.内容, “”)))
    赋值 (过滤条件, 相加 (过滤条件, “ and 实际发货单位= '”, .内容, “'”))
.如果真结束
.如果真 (并且 (等于 (.选中, 真), 不等于 (.内容, “”)))
    赋值 (过滤条件, 相加 (过滤条件, “ and 结算方式= '”, .内容, “'”))
.如果真结束
.如果真 (并且 (等于 (.选中, 真), 不等于 (.内容, “”)))
    赋值 (过滤条件, 相加 (过滤条件, “ and 货物名称= '”, .内容, “'”))
.如果真结束
.如果真 (并且 (等于 (.选中, 真), 不等于 (.内容, “”)))
    赋值 (过滤条件, 相加 (过滤条件, “ and 到达地= '”, .内容, “'”))
.如果真结束
.如果真 (并且 (等于 (.选中, 真), 不等于 (.内容, “”))) ' 看来又是盗版的原因,如果真条件判断里面,多个表达式用"且"连接起来,我想用二个且连接三个表达式,可是失败了,只能用一个且连接两个表达式,但在新开的一个程序里,我用了两个且连接了三个表达式,没问题.谁要我没钱买正版呢?唉,只好拿这个程序的代码去搏这次大奖赛的正版易语言了...
    赋值 (过滤条件, 相加 (过滤条件, “ and 签收时间 > '”, .内容, “'”, “ and 签收时间< '”, .内容, “'”))
.如果真结束
.如果真 (并且 (等于 (.选中, 真), 不等于 (.内容, “”)))
    赋值 (过滤条件, 相加 (过滤条件, “ and 委托人姓名= '”, .内容, “'”))
.如果真结束
.如果真 (并且 (等于 (.选中, 真), 不等于 (.内容, “”)))
    赋值 (过滤条件, 相加 (过滤条件, “ and 委托单位='”, .内容, “'”))
.如果真结束
.如果真 (并且 (等于 (.选中, 真), 不等于 (.内容, “”)))
    赋值 (过滤条件, 相加 (过滤条件, “ and 委托电话='”, .内容, “'”))
.如果真结束
.如果真 (并且 (等于 (.选中, 真), 不等于 (.内容, “”)))
    赋值 (过滤条件, 相加 (过滤条件, “ and 委托手机='”, .内容, “'”))
.如果真结束
.如果真 (并且 (等于 (.选中, 真), 不等于 (.内容, “”)))
    赋值 (过滤条件, 相加 (过滤条件, “ and 实际件数 ”, .内容, “ '”, .内容, “'”))
.如果真结束
.如果真 (并且 (等于 (.选中, 真), 不等于 (.内容, “”)))
    赋值 (过滤条件, 相加 (过滤条件, “ and 实际重量 ”, .内容, “ '”, .内容, “'”))
.如果真结束
.如果真 (并且 (等于 (.选中, 真), 不等于 (.内容, “”)))
    赋值 (过滤条件, 相加 (过滤条件, “ and 实际体积 ”, .内容, “ '”, .内容, “'”))
.如果真结束
.如果真 (并且 (等于 (.选中, 真), 不等于 (.内容, “”)))
    赋值 (过滤条件, 相加 (过滤条件, “ and 开票人姓名= '”, .内容, “'”))
.如果真结束
.如果真 (并且 (等于 (.选中, 真), 不等于 (.内容, “”)))
    赋值 (过滤条件, 相加 (过滤条件, “ and 开票时间 > '”, .内容, “'”, “ and 开票时间< '”, .内容, “'”))
.如果真结束

赋值 (过滤条件, 取文本右边 (过滤条件, 相减 (取文本长度 (过滤条件), 5))) ' 把拼接起来的过滤条件字符串前面多出来的 and 共五个字符删掉,不然这个过滤条件的语法就是错的
.如果真 (等于 (过滤条件, “”))
    信息框 (“您并没有选择任何查询条件并输入其它内容!查询取消.”, 0, )
    返回 ()
.如果真结束
数据库.开始查询 (“main.mdb”, , “业务单”, 2)
过滤条件.未知支持库函数_47 ()
未知支持库函数_34 ()
.计次循环首 (., 计次)
    “业务单号”.未知支持库函数_26 (临时_文本)
    .插入表项 (临时_文本, , , , ) ' 不必要指定表项值,就是最后一个参数,因为你可以取"现行选中项"的值,这个值是当前选中项的索引,把它+1,就是与之对应的数据库里那条记录的记录号
    “发货方式”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (1, 临时_文本) ' 超级列表框表项的行列索引值都是从0开始的,现在是写入第一行第二列的数据,所以,行索引是0(计次-1),列索引是1
    “实际发货单位”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (2, 临时_文本)
    “发货类型”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (3, 临时_文本)
    “结算方式”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (4, 临时_文本)
    “货物名称”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (5, 临时_文本)
    “原包装”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (6, 临时_文本)
    “预计件数”.未知支持库函数_29 (临时_整数)
    相减 (计次, 1).置标题 (7, 到文本 (临时_整数))
    “实际件数”.未知支持库函数_29 (临时_整数)
    相减 (计次, 1).置标题 (8, 到文本 (临时_整数))
    “预计重量”.未知支持库函数_29 (临时_整数)
    相减 (计次, 1).置标题 (9, 到文本 (临时_整数))
    “实际重量”.未知支持库函数_29 (临时_整数)
    相减 (计次, 1).置标题 (10, 到文本 (临时_整数))
    “预计体积”.未知支持库函数_29 (临时_整数)
    相减 (计次, 1).置标题 (11, 到文本 (临时_整数))
    “实际体积”.未知支持库函数_29 (临时_整数)
    相减 (计次, 1).置标题 (12, 到文本 (临时_整数))
    “计泡否”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (13, 临时_文本)
    “计泡重量”.未知支持库函数_29 (临时_整数)
    相减 (计次, 1).置标题 (14, 到文本 (临时_整数))
    “希望到达时间”.未知支持库函数_31 (临时_日期)
    相减 (计次, 1).置标题 (15, 到文本 (临时_日期))
    “重要提示”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (16, 临时_文本)
    “到达地”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (17, 临时_文本)
    “委托人姓名”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (18, 临时_文本)
    “委托单位”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (19, 临时_文本)
    “委托地址”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (20, 临时_文本)
    “委托电话”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (21, 临时_文本)
    “委托手机”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (22, 临时_文本)
    “收货人姓名”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (23, 临时_文本)
    “收货单位”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (24, 临时_文本)
    “收货地址”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (25, 临时_文本)
    “收货电话”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (26, 临时_文本)
    “收货手机”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (27, 临时_文本)
    “代收货款否”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (28, 临时_文本)
    “代收货款金额”.未知支持库函数_29 (临时_整数)
    相减 (计次, 1).置标题 (29, 到文本 (临时_整数))
    “保险否”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (30, 临时_文本)
    “保险率”.未知支持库函数_29 (临时_整数)
    相减 (计次, 1).置标题 (31, 到文本 (临时_整数))
    “保险费”.未知支持库函数_29 (临时_整数)
    相减 (计次, 1).置标题 (32, 到文本 (临时_整数))
    “货物声明价值”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (33, 临时_文本)
    “合作公司费用”.未知支持库函数_29 (临时_整数)
    相减 (计次, 1).置标题 (34, 到文本 (临时_整数))
    “中转否”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (35, 临时_文本)
    “中转单位”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (36, 临时_文本)
    “中转费”.未知支持库函数_29 (临时_整数)
    相减 (计次, 1).置标题 (37, 到文本 (临时_整数))
    “派送否”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (38, 临时_文本)
    “派送单位”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (39, 临时_文本)
    “派送费”.未知支持库函数_29 (临时_整数)
    相减 (计次, 1).置标题 (40, 到文本 (临时_整数))
    “运费”.未知支持库函数_29 (临时_整数)
    相减 (计次, 1).置标题 (41, 到文本 (临时_整数))
    “实收费用”.未知支持库函数_29 (临时_整数)
    相减 (计次, 1).置标题 (42, 到文本 (临时_整数))
    “开票人姓名”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (43, 临时_文本)
    “开票时间”.未知支持库函数_31 (临时_日期)
    相减 (计次, 1).置标题 (44, 到文本 (临时_日期))
    “货物到达时间”.未知支持库函数_31 (临时_日期)
    相减 (计次, 1).置标题 (45, 到文本 (临时_日期))
    “回单否”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (46, 临时_文本)
    “回单数”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (47, 临时_文本)
    “签收人”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (48, 临时_文本)
    “签收时间”.未知支持库函数_31 (临时_日期)
    相减 (计次, 1).置标题 (49, 到文本 (临时_日期))
    “结款否”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (50, 临时_文本)
    “结款时间”.未知支持库函数_31 (临时_日期)
    相减 (计次, 1).置标题 (51, 到文本 (临时_日期))
    “结款金额”.未知支持库函数_29 (临时_整数)
    相减 (计次, 1).置标题 (52, 到文本 (临时_整数))
    “签收录入人”.未知支持库函数_26 (临时_文本)
    相减 (计次, 1).置标题 (53, 临时_文本)
    “签收录入时间”.未知支持库函数_31 (临时_日期)
    相减 (计次, 1).置标题 (54, 到文本 (临时_日期))
    
    未知支持库函数_36 ()
.计次循环尾 ()
数据库.断开 ()


.子程序 _超级列表框_业务单查询_查询结果_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 临时_日期, 日期时间型, , , 

.如果 (等于 (., -1))
    信息框 (“所选表行为空!”, 0, )
    返回 ()
    获取焦点 ()
.否则
    
.如果结束
赋值 (查询菜单窗口., 假)
赋值 (.现行子夹, 4)
赋值 (查询菜单窗口., 798)
赋值 (查询菜单窗口., 496)
赋值 (查询菜单窗口., 1)
赋值 (查询菜单窗口., “”)
赋值 (查询菜单窗口., 假)
赋值 (主窗口., 真)
赋值 (查询菜单窗口., 真)
数据库.开始查询 (“main.mdb”, , “业务单”, 2)
“业务单号”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“发货方式”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“实际发货单位”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“发货类型”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“结算方式”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“货物名称”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“原包装”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“预计件数”.未知支持库函数_29 (临时_整数)
赋值 (.内容, 到文本 (临时_整数))
“实际件数”.未知支持库函数_29 (临时_整数)
赋值 (.内容, 到文本 (临时_整数))
“预计重量”.未知支持库函数_29 (临时_整数)
赋值 (.内容, 到文本 (临时_整数))
“实际重量”.未知支持库函数_29 (临时_整数)
赋值 (.内容, 到文本 (临时_整数))
“预计体积”.未知支持库函数_29 (临时_整数)
赋值 (.内容, 到文本 (临时_整数))
“实际体积”.未知支持库函数_29 (临时_整数)
赋值 (.内容, 到文本 (临时_整数))
“计泡否”.未知支持库函数_26 (临时_文本)
.如果真 (等于 (临时_文本, “是”))
    赋值 (.选中, 真)
.如果真结束
“计泡重量”.未知支持库函数_29 (临时_整数)
赋值 (.内容, 到文本 (临时_整数))
“希望到达时间”.未知支持库函数_31 (临时_日期)
赋值 (.内容, 到文本 (临时_日期))
“重要提示”.未知支持库函数_26 (临时_文本)
赋值 (., 临时_文本)
“到达地”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“委托人姓名”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“委托单位”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“委托地址”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“委托电话”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“委托手机”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“收货人姓名”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“收货单位”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“收货地址”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“收货电话”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“收货手机”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“代收货款否”.未知支持库函数_26 (临时_文本)
.如果真 (等于 (临时_文本, “是”))
    赋值 (.选中, 真)
.如果真结束
“代收货款金额”.未知支持库函数_29 (临时_整数)
赋值 (.内容, 到文本 (临时_整数))
“保险否”.未知支持库函数_26 (临时_文本)
.如果真 (等于 (临时_文本, “是”))
    赋值 (.选中, 真)
.如果真结束
“保险率”.未知支持库函数_29 (临时_整数)
赋值 (.内容, 到文本 (临时_整数))
“保险费”.未知支持库函数_29 (临时_整数)
赋值 (.内容, 到文本 (临时_整数))
“货物声明价值”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“合作公司费用”.未知支持库函数_29 (临时_整数)
赋值 (.内容, 到文本 (临时_整数))
“中转否”.未知支持库函数_26 (临时_文本)
.如果真 (等于 (临时_文本, “是”))
    赋值 (.选中, 真)
.如果真结束
“中转单位”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“中转费”.未知支持库函数_29 (临时_整数)
赋值 (.内容, 到文本 (临时_整数))
“派送否”.未知支持库函数_26 (临时_文本)
.如果真 (等于 (临时_文本, “是”))
    赋值 (.选中, 真)
.如果真结束
“派送单位”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“派送费”.未知支持库函数_29 (临时_整数)
赋值 (.内容, 到文本 (临时_整数))
“运费”.未知支持库函数_29 (临时_整数)
赋值 (.内容, 到文本 (临时_整数))
“实收费用”.未知支持库函数_29 (临时_整数)
赋值 (.内容, 到文本 (临时_整数))
赋值 (.内容, 数值到金额 (临时_整数, 假))
“开票人姓名”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“开票时间”.未知支持库函数_31 (临时_日期)
赋值 (.内容, 到文本 (临时_日期))
“货物到达时间”.未知支持库函数_31 (临时_日期)
赋值 (.内容, 到文本 (临时_日期))
“回单否”.未知支持库函数_26 (临时_文本)
.如果真 (等于 (临时_文本, “是”))
    赋值 (.选中, 真)
.如果真结束
“回单数”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“签收人”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“签收时间”.未知支持库函数_31 (临时_日期)
赋值 (.内容, 到文本 (临时_日期))
“结款否”.未知支持库函数_26 (临时_文本)
.如果真 (等于 (临时_文本, “是”))
    赋值 (.选中, 真)
.如果真结束
“结款时间”.未知支持库函数_31 (临时_日期)
赋值 (.内容, 到文本 (临时_日期))
“结款金额”.未知支持库函数_29 (临时_整数)
赋值 (.内容, 到文本 (临时_整数))
“签收录入人”.未知支持库函数_26 (临时_文本)
赋值 (.内容, 临时_文本)
“签收录入时间”.未知支持库函数_31 (临时_日期)
赋值 (.内容, 到文本 (临时_日期))
数据库.断开 ()


.子程序 _按钮_受理查询_返回_被单击, 空白型, , 
赋值 (查询菜单窗口., 假)
赋值 (.现行子夹, 1)
赋值 (查询菜单窗口., 734)
赋值 (查询菜单窗口., 526)
赋值 (查询菜单窗口., 1)
赋值 (查询菜单窗口., 真)
赋值 (查询菜单窗口., “业务单查询 (允许多条件查询)”)
赋值 (查询菜单窗口., 真)


.子程序 _超级按钮_业务单查询_导出_被单击, 空白型, , 
.局部变量 行, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 行计次, 整数型, , , 
.局部变量 列计次, 整数型, , , 
.局部变量 字母, 文本型, , "1", 

赋值 (.标题, “保存Excel文件”)
赋值 (.默认文件后缀, “.xls”)
赋值 (.过滤器, “Excel文件|*.xls”)
赋值 (.初始目录, 相加 (取当前目录 (), “\导出电子表格\业务单查询\”))
赋值 (.文件名, 相加 (“业务单查询结果”, 到文本 (取现行时间 ()), “.xls”))
.如果 (等于 (打开 (), 真)) ' 先判断用户是否真的执行了导出命令,如果出现保存提示框后,用户选择了取消,那么,下面的代码将不会执行,就可以避免取消时已经打开的EXCEL程序提示要不要保存的问题
     ' 由于EXCEL表格的列标号是字母A到Z而不是数字,所以得把字母放入一个变量,用变量[数字]来得到相应的列标号字母
    赋值 (字母 [1], “A”)
    加入成员 (字母, “B”)
    加入成员 (字母, “C”)
    加入成员 (字母, “D”)
    加入成员 (字母, “E”)
    加入成员 (字母, “F”)
    加入成员 (字母, “G”)
    加入成员 (字母, “H”)
    加入成员 (字母, “I”)
    加入成员 (字母, “J”)
    加入成员 (字母, “K”)
    加入成员 (字母, “L”)
    加入成员 (字母, “M”)
    加入成员 (字母, “N”)
    加入成员 (字母, “O”)
    加入成员 (字母, “P”)
    加入成员 (字母, “Q”)
    加入成员 (字母, “R”)
    加入成员 (字母, “S”)
    加入成员 (字母, “T”)
    加入成员 (字母, “U”)
    加入成员 (字母, “V”)
    加入成员 (字母, “W”)
    加入成员 (字母, “X”)
    加入成员 (字母, “Y”)
    加入成员 (字母, “Z”)
    加入成员 (字母, “AA”)
    加入成员 (字母, “AB”)
    加入成员 (字母, “AC”)
    加入成员 (字母, “AD”)
    加入成员 (字母, “AE”)
    加入成员 (字母, “AF”)
    加入成员 (字母, “AG”)
    加入成员 (字母, “AH”)
    加入成员 (字母, “AI”)
    加入成员 (字母, “AJ”)
    加入成员 (字母, “AK”)
    加入成员 (字母, “AL”)
    加入成员 (字母, “AM”)
    加入成员 (字母, “AN”)
    加入成员 (字母, “AO”)
    加入成员 (字母, “AP”)
    加入成员 (字母, “AQ”)
    加入成员 (字母, “AR”)
    加入成员 (字母, “AS”)
    加入成员 (字母, “AT”)
    加入成员 (字母, “AU”)
    加入成员 (字母, “AV”)
    加入成员 (字母, “AW”)
    加入成员 (字母, “AX”)
    加入成员 (字母, “AY”)
    加入成员 (字母, “AZ”)
    加入成员 (字母, “BA”)
    加入成员 (字母, “BB”)
    加入成员 (字母, “BC”)
    
    赋值 (行, 取表项数 ()) ' 这个行数将来用作循环导出时记录的行数,也就是记录数,导出电子表格需要行循环和列循环,是嵌套的
    赋值 (列, 取列数 ())
    .如果真 (取反 (大于 (取表项数 (), 0))) ' 判断超级列表框中有没表项,如果没有,就是说没有查询出记录,也就不必要导出了
        信息框 (“查询结果列表中没有信息!请先定义条件查询出结果再进行导出.”, 0, )
        返回 ()
        
    .如果真结束
    
    
    .如果 (查询菜单窗口.未知支持库函数_0 (.)) ' 如果创建失败,证明客户的电脑上没有安装EXCEL,导出是不能成功的,所以判断一下,没有就取消
        
    .否则
        信息框 (“您的计算机没有安装EXCEL2000电子表格软件,请安装EXCEL后再使用此功能!”, 0, )
        返回 ()
    .如果结束
    
    赋值 (查询菜单窗口.., 真) ' 通常导出数据时不要显示EXCEL程序,但在编程调试的时候,还是打开为好,看看实际效果,编译时再关掉.要是能不打开EXCEL程序而实现导出就好了,很慢的,
    查询菜单窗口.未知支持库函数_6 (., )
    赋值 (查询菜单窗口.., 1)
    赋值 (查询菜单窗口.., “业务单查询结果”)
    .计次循环首 (列, 列计次) ' 这个循环把数据库里的所有字段名读出并写入到EXCEL程序的第二行里面,当作表格的列标题
        赋值 (., 相加 (字母 [列计次], “1”))
        赋值 (., 相加 (字母 [列计次], “1”)) ' 当循环第一次时,字母[列计次]就是字母[1],它的值是A,加字符2后是A2,A2就是EXCEL表格中的第二行第一列,第一行合并了,写入了一个标题
        赋值 (., 相减 (列计次, 1).取列标题 ())
    .计次循环尾 ()
    
    .计次循环首 (行, 行计次)
        .计次循环首 (列, 列计次)
            赋值 (., 相加 (字母 [列计次], 到文本 (相加 (行计次, 1))))
            赋值 (., 相加 (字母 [列计次], 到文本 (相加 (行计次, 1))))
            赋值 (., 相减 (行计次, 1).取标题 (相减 (列计次, 1)))
        .计次循环尾 ()
    .计次循环尾 ()
    未知支持库函数_29 ()
    .未知支持库函数_16 (.文件名)
    信息框 (相加 (“导出文件成功!”, #换行符, “该文件保存在”, 取当前目录 (), “下,”, “文件名为:”, .文件名), 0, )
    未知支持库函数_15 ()
    未知支持库函数_3 ()
    
.否则
    信息框 (“由于用户取消,本次导出没有成功!”, 0, )
    未知支持库函数_15 ()
    未知支持库函数_3 ()
    返回 ()
.如果结束


.子程序 客户查询, 空白型, , 通过输入单位名称来查询数据库中有相同单位名称的记录
.参数 客户查询_字段名, 文本型, , 客户查询中有四个按钮,分别按输入的四个字段值来查询,它们有共同点,程序结构都一样,只有两个不同点,用变量代替这两个不同点,可以以一段子程序来完成这四个按钮的查询功能.
.参数 客户查询_编辑框内容, 文本型, , 

.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 临时_日期, 日期时间型, , , 
.局部变量 计次, 整数型, , , 

数据库.开始查询 (“ywzhxx.mdb”, , “客户信息”, 2)
.计次循环首 (., 计次)
    客户查询_字段名.未知支持库函数_26 (临时_文本)
    .如果真 (取反 (等于 (寻找文本 (临时_文本, 客户查询_编辑框内容, 1, 真), -1)))
        “单位名称”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “联系人”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “地址”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “座机号”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “手机号”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “小灵通号”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “主要货物种类”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “发货目的地”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “货物特点”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “累计发货次数”.未知支持库函数_29 (临时_整数)
        赋值 (.内容, 到文本 (临时_整数))
        “最后发货日期”.未知支持库函数_31 (临时_日期)
        赋值 (.内容, 到文本 (临时_日期))
    .如果真结束
    未知支持库函数_36 ()
.计次循环尾 ()
数据库.断开 ()

.子程序 _按钮_客户信息查询_单位名称_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (相加 (“请先输入单位名称中的关键词,”, #换行符, “例如:客户信息中有上海宅急送快运有限公司,你可以只输入宅急送.”), 0, )
    返回 ()
.如果真结束
客户查询 (“单位名称”, .内容)

.子程序 _按钮_客户信息查询_联系人_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (“请先输入联系人姓名”, 0, )
    返回 ()
.如果真结束

客户查询 (“联系人”, .内容)


.子程序 _按钮_客户信息查询_座机号_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (“请先输入客户座机号码”, 0, )
    返回 ()
.如果真结束
客户查询 (“座机号”, .内容)


.子程序 _按钮_客户信息查询_手机号_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (“请先输入客户手机号码”, 0, )
    返回 ()
.如果真结束
客户查询 (“手机号”, .内容)


.子程序 _按钮_客户信息查询_导出_被单击, 空白型, , 客户信息导出实际上就是MDB数据库记录导出到电子表格
.局部变量 行, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 行计次, 整数型, , , 
.局部变量 列计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 临时_日期, 日期时间型, , , 
.局部变量 字母, 文本型, , "1", 

赋值 (.标题, “保存Excel文件”)
赋值 (.初始目录, 相加 (取当前目录 (), “\导出电子表格\客户查询”))
数据库.开始查询 (“ywzhxx.mdb”, , “客户信息”, 2)
.如果 (等于 (打开 (), 真))
    赋值 (字母 [1], “A”)
    加入成员 (字母, “B”)
    加入成员 (字母, “C”)
    加入成员 (字母, “D”)
    加入成员 (字母, “E”)
    加入成员 (字母, “F”)
    加入成员 (字母, “G”)
    加入成员 (字母, “H”)
    加入成员 (字母, “I”)
    加入成员 (字母, “J”)
    加入成员 (字母, “K”)
    .如果真 (小于 (., 1))
        信息框 (相加 (“客户信息库中现在还没有客户记录!导出取消.”, #换行符, “请先在受理菜单中选择客户信息项进行客户信息录入.”), 0, )
        返回 ()
        
    .如果真结束
    赋值 (行, .)
    赋值 (列, 11)
    未知支持库函数_0 ()
    赋值 (., 假)
    .未知支持库函数_6 ()
    赋值 (., 1)
    赋值 (., “客户信息”)
    .计次循环首 (列, 列计次)
        赋值 (., 相加 (字母 [列计次], “1”))
        赋值 (., 相加 (字母 [列计次], “1”))
        赋值 (., 相减 (列计次, 1).未知支持库函数_39 ())
    .计次循环尾 ()
    .计次循环首 (列, 列计次)
        .计次循环首 (行, 行计次)
            赋值 (., 相加 (字母 [列计次], 到文本 (相加 (行计次, 1))))
            赋值 (., 相加 (字母 [列计次], 到文本 (相加 (行计次, 1))))
            .判断开始 (等于 (相减 (列计次, 1).未知支持库函数_43 (), 202)) ' 判断字段是不是文本型
                相减 (列计次, 1).未知支持库函数_39 ().未知支持库函数_26 (临时_文本)
                赋值 (., 临时_文本)
            .判断 (等于 (相减 (列计次, 1).未知支持库函数_43 (), 203)) ' 判断字段是不是备注型
                相减 (列计次, 1).未知支持库函数_39 ().未知支持库函数_26 (临时_文本)
                赋值 (., 临时_文本)
            .判断 (等于 (相减 (列计次, 1).未知支持库函数_43 (), 2)) ' 判断字段是不是整型数值
                相减 (列计次, 1).未知支持库函数_39 ().未知支持库函数_29 (临时_整数)
                赋值 (., 到文本 (临时_整数))
            .判断 (等于 (相减 (列计次, 1).未知支持库函数_43 (), 7)) ' 判断字段是不是日期型
                相减 (列计次, 1).未知支持库函数_39 ().未知支持库函数_31 (临时_日期)
                赋值 (., 到文本 (临时_日期))
            .默认
                
            .判断结束
            
        .计次循环尾 ()
    .计次循环尾 ()
    .未知支持库函数_16 (.文件名)
    信息框 (相加 (“导出文件成功!”, #换行符, “该文件保存在”, 取当前目录 (), “下”, “文件名为”, .文件名), 0, )
    未知支持库函数_15 ()
    未知支持库函数_3 ()
    
.否则
    信息框 (“由于用户取消,本次导出没有成功!”, 0, )
    未知支持库函数_15 ()
    未知支持库函数_3 ()
    数据库.断开 ()
    返回 ()
    
.如果结束
数据库.断开 ()


.窗口程序集 窗口程序集6, , , 

.程序集变量 数据库, 数据库, , , 
.子程序 _检货处菜单窗口_将被销毁, 空白型, , 
赋值 (检货处菜单窗口., 假)
赋值 (主窗口., 假)
主窗口.获取焦点 ()

.子程序 _选择框_检货信息_计泡否_被单击, 空白型, , 
.判断开始 (等于 (.选中, 真))
    赋值 (.禁止, 假)
.判断 (等于 (.选中, 假))
    赋值 (.禁止, 真)
.默认
    
.判断结束


.子程序 _检货处菜单窗口_创建完毕, 空白型, , 
赋值 (.内容, 检货号)

.子程序 _按钮_检货信息_保存_被单击, 空白型, , 
.如果 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“检货号或实际件数不能为空”, 0, )
    返回 ()
.否则
    
.如果结束
.如果 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“实际重量或实际体积不能为空”, 0, )
    返回 ()
.否则
    
.如果结束

数据库.开始查询 (“main.mdb”, , “检货及仓库”, 2)
未知支持库函数_17 ()
未知支持库函数_35 ()
“检货号”.未知支持库函数_20 (.内容)
“检货员”.未知支持库函数_20 (.内容)
“检货时间”.未知支持库函数_25 (到时间 (.内容))
“货物名称”.未知支持库函数_20 (.内容)
“实际件数”.未知支持库函数_23 (到数值 (.内容))
“实际重量”.未知支持库函数_23 (到数值 (.内容))
“实际体积”.未知支持库函数_23 (到数值 (.内容))
.如果 (等于 (.选中, 真))
    “记抛否”.未知支持库函数_20 (“是”)
.否则
    “记抛否”.未知支持库函数_20 (“否”)
.如果结束
“计抛重量”.未知支持库函数_23 (到数值 (.内容))

.如果 (未知支持库函数_18 ()) ' 更新记录集数据就检货库
    信息框 (“保存成功!”, 0, )
.否则
    信息框 (“保存失败!”, 0, )
    返回 ()
.如果结束

未知支持库函数_16 ()
“检货临时库”.未知支持库函数_14 (2) ' 更新刚才保存的那条记录到检货临时库,以供受理员快速录入货物信息
未知支持库函数_17 ()
未知支持库函数_35 ()
“检货号”.未知支持库函数_20 (.内容)
“检货员”.未知支持库函数_20 (.内容)
“检货时间”.未知支持库函数_25 (到时间 (.内容))
“货物名称”.未知支持库函数_20 (.内容)
“实际件数”.未知支持库函数_23 (到数值 (.内容))
“实际重量”.未知支持库函数_23 (到数值 (.内容))
“实际体积”.未知支持库函数_23 (到数值 (.内容))
.如果 (等于 (.选中, 真))
    “记抛否”.未知支持库函数_20 (“是”)
.否则
    “记抛否”.未知支持库函数_20 (“否”)
.如果结束
“计抛重量”.未知支持库函数_23 (到数值 (.内容))
未知支持库函数_18 ()

数据库.断开 ()

赋值 (开检货单数, 相加 (开检货单数, 1)) ' 将检货号累加1,便于下次直接用累加后的检货号
赋值 (检货号, 文本替换 (检货号, 相加 (相减 (9, 取文本长度 (到文本 (开检货单数))), 1), 取文本长度 (到文本 (开检货单数)), 到文本 (开检货单数)))
清空检货录入界面 ()

.子程序 清空检货录入界面, 空白型, , 
赋值 (.内容, 检货号)
赋值 (.内容, 到文本 (取现行时间 ()))
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.选中, 假)
赋值 (.内容, “”)
赋值 (.禁止, 真)



.子程序 _按钮_检货查询_检货号_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 临时_日期, 日期时间型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请先输入检货号,再进行查询.”, 0, )
    返回 ()
.如果真结束
数据库.开始查询 (“main.mdb”, , “检货及仓库”, 2)
.计次循环首 (., 计次)
    “检货号”.未知支持库函数_26 (临时_文本)
    .如果真 (等于 (临时_文本, .内容))
        “检货员”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “检货时间”.未知支持库函数_31 (临时_日期)
        赋值 (.内容, 到文本 (临时_日期))
        “货物名称”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “实际件数”.未知支持库函数_29 (临时_整数)
        赋值 (.内容, 到文本 (临时_整数))
        “实际重量”.未知支持库函数_29 (临时_整数)
        赋值 (.内容, 到文本 (临时_整数))
        “实际体积”.未知支持库函数_29 (临时_整数)
        赋值 (.内容, 到文本 (临时_整数))
        “计抛否”.未知支持库函数_26 (临时_文本)
        .如果真 (等于 (临时_文本, “是”))
            赋值 (.选中, 真)
            “计抛重量”.未知支持库函数_29 (临时_整数)
            赋值 (.内容, 到文本 (临时_整数))
        .如果真结束
        “业务单号”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
    .如果真结束
    未知支持库函数_36 ()
.计次循环尾 ()
数据库.断开 ()

.子程序 _按钮_检货查询_业务单号_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 临时_日期, 日期时间型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请先输入业务单号,再进行查询.”, 0, )
    返回 ()
.如果真结束
数据库.开始查询 (“main.mdb”, , “检货及仓库”, 2)
.计次循环首 (., 计次)
    “业务单号”.未知支持库函数_26 (临时_文本)
    .如果真 (等于 (临时_文本, .内容))
        “检货号”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “检货员”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “检货时间”.未知支持库函数_31 (临时_日期)
        赋值 (.内容, 到文本 (临时_日期))
        “货物名称”.未知支持库函数_26 (临时_文本)
        赋值 (.内容, 临时_文本)
        “实际件数”.未知支持库函数_29 (临时_整数)
        赋值 (.内容, 到文本 (临时_整数))
        “实际重量”.未知支持库函数_29 (临时_整数)
        赋值 (.内容, 到文本 (临时_整数))
        “实际体积”.未知支持库函数_29 (临时_整数)
        赋值 (.内容, 到文本 (临时_整数))
        “计抛否”.未知支持库函数_26 (临时_文本)
        .如果真 (等于 (临时_文本, “是”))
            赋值 (.选中, 真)
            “计抛重量”.未知支持库函数_29 (临时_整数)
            赋值 (.内容, 到文本 (临时_整数))
        .如果真结束
        
    .如果真结束
    未知支持库函数_36 ()
.计次循环尾 ()
数据库.断开 ()


.子程序 _按钮_检货查询_报告临时库_被单击, 空白型, , 
.局部变量 未处理的检货单号, 文本型, , , 
.局部变量 临时_文本, 文本型, , , 

数据库.开始查询 (“main.mdb”, , “检货临时库”, 2)
.如果真 (小于 (., 1))
    信息框 (“受理部门已经将检货信息全部处理完毕!”, 0, )
    数据库.断开 ()
    返回 ()
.如果真结束

.计次循环首 (., )
    “检货号”.未知支持库函数_26 (临时_文本)
    赋值 (未处理的检货单号, 相加 (未处理的检货单号, 临时_文本, “，”))
    未知支持库函数_36 ()
.计次循环尾 ()
数据库.断开 ()
信息框 (相加 (“有检货信息尚未处理,检货号是:”, #换行符, 未处理的检货单号, #换行符, #换行符, “请通知受理人员尽快处理.”), 0, )

.子程序 _按钮_检货异常_保存_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (“检货号必须填写!”, 0, )
    返回 ()
.如果真结束
数据库.开始查询 (“ywzhxx.mdb”, , “检货异常情况”, 2)
未知支持库函数_17 ()
“检货号”.未知支持库函数_20 (.内容)
“操作员”.未知支持库函数_20 (.内容)
“记录时间”.未知支持库函数_25 (到时间 (.内容))
“异常情况类型”.未知支持库函数_20 (.内容)
“异常情况描述”.未知支持库函数_20 (.内容)
“处理结果”.未知支持库函数_20 (.内容)
.如果 (未知支持库函数_18 ())
    信息框 (“保存成功!”, 0, )
    数据库.断开 ()
    赋值 (.内容, “”)
    赋值 (.内容, 到文本 (取现行时间 ()))
    赋值 (.现行选中项, 0)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
.否则
    信息框 (“保存失败!”, 0, )
    数据库.断开 ()
    
.如果结束


.子程序 _按钮_检货异常_导出_被单击, 空白型, , 
.局部变量 导出条件, 文本型, , , 
.局部变量 行, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 行计次, 整数型, , , 
.局部变量 列计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_日期, 日期时间型, , , 
.局部变量 字母, 文本型, , "1", 

.如果真 (并且 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“必须先输入两个日期!”, 0, )
    返回 ()
.如果真结束
.如果真 (小于 (取时间间隔 (到时间 (.内容), 到时间 (.内容), #日), 1))
    信息框 (“两个日期间至少要有一天的间隔.”, 0, )
    返回 ()
.如果真结束
赋值 (导出条件, 相加 (“记录时间 > '”, .内容, “'”, “ and 记录时间 < '”, .内容, “'”))
数据库.开始查询 (“ywzhxx.mdb”, , “检货异常情况”, 2)
.如果真 (小于 (., 1))
    信息框 (“所选的时间范围内没有任何检货异常信息记录,导出取消.”, 0, )
    数据库.断开 ()
    返回 ()
.如果真结束
导出条件.未知支持库函数_47 ()
赋值 (.标题, “保存Excel文件”)
赋值 (.类型, 1)
赋值 (.文件名, 相加 (“检货异常信息”, 到文本 (取现行时间 ()), “.xls”))
赋值 (.过滤器, “EXCEL电子表格文件(*.xls)|*.xls”)
赋值 (.初始目录, 相加 (取当前目录 (), “\导出电子表格\检货异常情况\”))
.如果 (等于 (打开 (), 真))
    赋值 (字母 [1], “A”)
    加入成员 (字母, “B”)
    加入成员 (字母, “C”)
    加入成员 (字母, “D”)
    加入成员 (字母, “E”)
    加入成员 (字母, “F”)
    赋值 (行, .)
    赋值 (列, 6)
    未知支持库函数_0 ()
    赋值 (., 假)
    .未知支持库函数_6 ()
    赋值 (., 1)
    赋值 (., “检货异常信息”)
    .计次循环首 (列, 列计次)
        赋值 (., 相加 (字母 [列计次], “1”))
        赋值 (., 相加 (字母 [列计次], “1”))
        赋值 (., 相减 (列计次, 1).未知支持库函数_39 ())
    .计次循环尾 ()
    .计次循环首 (列, 列计次)
        .计次循环首 (行, 行计次)
            赋值 (., 相加 (字母 [列计次], 到文本 (相加 (行计次, 1))))
            赋值 (., 相加 (字母 [列计次], 到文本 (相加 (行计次, 1))))
            .判断开始 (等于 (相减 (列计次, 1).未知支持库函数_43 (), 202)) ' 判断字段是不是文本型
                相减 (列计次, 1).未知支持库函数_39 ().未知支持库函数_26 (临时_文本)
                赋值 (., 临时_文本)
            .判断 (等于 (相减 (列计次, 1).未知支持库函数_43 (), 203)) ' 判断字段是不是备注型
                相减 (列计次, 1).未知支持库函数_39 ().未知支持库函数_26 (临时_文本)
                赋值 (., 临时_文本)
            .判断 (等于 (相减 (列计次, 1).未知支持库函数_43 (), 7)) ' 判断字段是不是日期型
                相减 (列计次, 1).未知支持库函数_39 ().未知支持库函数_31 (临时_日期)
                赋值 (., 到文本 (临时_日期))
            .默认
                
            .判断结束
            
        .计次循环尾 ()
    .计次循环尾 ()
    .未知支持库函数_16 (.文件名)
    信息框 (相加 (“导出文件成功!”, #换行符, “该文件保存在”, 取当前目录 (), “下”, “文件名为”, .文件名), 0, )
    未知支持库函数_15 ()
    未知支持库函数_3 ()
    
.否则
    信息框 (“由于用户取消,本次导出没有成功!”, 0, )
    未知支持库函数_15 ()
    未知支持库函数_3 ()
    数据库.断开 ()
    返回 ()
    
.如果结束
数据库.断开 ()


.窗口程序集 窗口程序集7, , , 

.程序集变量 数据库, 数据库, , , 类引用
.程序集变量 入库_记录号, 整数型, , "0", 存放查找出来的未入库的记录号
.程序集变量 外地入埠_过滤条件, 文本型, , , 存放外地入埠查询时的过滤条件
.程序集变量 出库_记录号, 整数型, , "0", 存放查找出来的未出库的记录号
.子程序 _仓库菜单窗口_创建完毕, 空白型, , 


.子程序 _仓库菜单窗口_将被销毁, 空白型, , 
赋值 (仓库菜单窗口., 假)
赋值 (主窗口., 假)
主窗口.获取焦点 ()

.子程序 _按钮_入库_查询未入库业务单_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 临时_日期, 日期时间型, , , 

清除数组 (入库_记录号)
赋值 (., 0)
相加 (取当前目录 (), “\grd\ruku_adv.grd”).未知支持库函数_56 ()
数据库.开始查询 (“main.mdb”, , “检货及仓库”, 2)
.如果真 (小于 (., 1))
    信息框 (“数据库中还没有任何检货信息!请先录入检货信息后再进行进库操作!”, 0, )
    数据库.断开 ()
    赋值 (.禁止, 假)
    返回 ()
.如果真结束
“已入库 = '否'”.未知支持库函数_47 ()
.如果真 (小于 (., 1))
    信息框 (“当前没有要入库的货物!”, 0, )
    数据库.断开 ()
    赋值 (.禁止, 假)
    返回 ()
.如果真结束
未知支持库函数_34 ()
.计次循环首 (., 计次) ' 将数据库里过滤出来的已入库等于否的全部记录填入高级表格
    .未知支持库函数_38 ()
    加入成员 (入库_记录号, .) ' 每一次加入表格行的时候,都把当前记录的记录号存放到数组里,这样在保存的时候可以直接跳到相应的记录去操作,而不用循环判断了.
    “检货号”.未知支持库函数_26 (临时_文本)
    计次.未知支持库函数_9 (0, 1, 临时_文本)
    “检货员”.未知支持库函数_26 (临时_文本)
    计次.未知支持库函数_9 (1, 1, 临时_文本)
    “检货时间”.未知支持库函数_31 (临时_日期)
    计次.未知支持库函数_9 (2, 1, 到文本 (临时_日期))
    “实际件数”.未知支持库函数_29 (临时_整数)
    计次.未知支持库函数_9 (3, 1, 到文本 (临时_整数))
    “实际重量”.未知支持库函数_29 (临时_整数)
    计次.未知支持库函数_9 (4, 1, 到文本 (临时_整数))
    “实际体积”.未知支持库函数_29 (临时_整数)
    计次.未知支持库函数_9 (5, 1, 到文本 (临时_整数))
    “业务单号”.未知支持库函数_26 (临时_文本)
    计次.未知支持库函数_9 (6, 1, 临时_文本)
    未知支持库函数_36 ()
.计次循环尾 ()
赋值 (.禁止, 假) ' 打开保存按钮,准备保存修改后的结果
“”.未知支持库函数_47 () ' 过滤记录很好用,但要记得不用了的时候就关,否则写入数据库的时候会出错误.
数据库.断开 ()

.子程序 _按钮_入库_保存入库信息_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 计次1, 整数型, , , 
.局部变量 临时_逻辑, 逻辑型, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 更改业务状态_业务单号, 文本型, , "0", 存放要更改入库状态的业务单号
.局部变量 数据库连接_入库保存, 未知类型0x70001, , , 
.局部变量 记录集_入库保存, 未知类型0x70002, , , 
.局部变量 数据库连接_修改业务状态, 未知类型0x70001, , , 
.局部变量 记录集_修改业务状态, 未知类型0x70002, , , 

复制窗口组件 (数据库连接_入库保存)
复制窗口组件 (记录集_入库保存)
数据库连接_入库保存.未知支持库函数_1 (相加 (取当前目录 (), “\data\main.mdb”), “”)
记录集_入库保存.未知支持库函数_12 (数据库连接_入库保存)
记录集_入库保存.未知支持库函数_14 (“检货及仓库”, 2)
.计次循环首 (取数组成员数 (入库_记录号), 计次) ' 看看,马上就用到了填充高级表格时预先存放起来的记录号,当然,存放的数据中变量的个数,就是当时找出来的未入库的记录的个数,而各个变量的值,就是各条记录的记录号,现在可以直接对它们进行操作了.
    记录集_入库保存.未知支持库函数_38 (入库_记录号 [计次]) ' 直接跳到先前保存下来的记录号
    赋值 (临时_逻辑, 计次.未知支持库函数_10 (7)) ' 取出表格中入库否列的值
    .如果 (等于 (临时_逻辑, 真)) ' 比较这个值如果是真,就写已入库的值为"是"
        记录集_入库保存.未知支持库函数_20 (“已入库”, “是”)
    .否则
        记录集_入库保存.未知支持库函数_20 (“已入库”, “否”) ' 反之写"否"
    .如果结束
    
.计次循环尾 ()
.如果 (记录集_入库保存.未知支持库函数_18 ()) ' 更新数据库的数据,判断写入有没有错误.
    信息框 (“成功写入入库信息!”, 0, )
    赋值 (.禁止, 真) ' 写完后再次禁止保存按钮,免得表格里是空数据库时还要再进行判断
.否则
    信息框 (“写入入库信息失败!”, 0, )
    赋值 (.禁止, 真)
.如果结束
记录集_入库保存.未知支持库函数_16 ()
数据库连接_入库保存.未知支持库函数_3 ()


复制窗口组件 (数据库连接_修改业务状态)
复制窗口组件 (记录集_修改业务状态)
数据库.开始查询 (数据库连接_修改业务状态, 记录集_修改业务状态, “main.mdb”, , “业务状态”, 2)
清除数组 (更改业务状态_业务单号)
.计次循环首 (取数组成员数 (入库_记录号), 计次)
    记录集_修改业务状态.未知支持库函数_38 (入库_记录号 [计次])
    记录集_修改业务状态.未知支持库函数_26 (“业务单号”, 临时_文本)
    加入成员 (更改业务状态_业务单号, 临时_文本)
.计次循环尾 ()
数据库.断开 (数据库连接_修改业务状态, 记录集_修改业务状态)

数据库连接_修改业务状态.未知支持库函数_1 (相加 (取当前目录 (), “\data\main.mdb”), “”)
记录集_修改业务状态.未知支持库函数_12 (数据库连接_修改业务状态)
记录集_修改业务状态.未知支持库函数_14 (“业务状态”, 2)
记录集_修改业务状态.未知支持库函数_34 ()
.计次循环首 (取数组成员数 (更改业务状态_业务单号), 计次)
    .计次循环首 (记录集_修改业务状态., 计次1)
        记录集_修改业务状态.未知支持库函数_26 (“业务单号”, 临时_文本)
        .如果真 (等于 (临时_文本, 更改业务状态_业务单号 [计次]))
            记录集_修改业务状态.未知支持库函数_20 (“已入库”, “是”)
        .如果真结束
        记录集_修改业务状态.未知支持库函数_36 ()
    .计次循环尾 ()
.计次循环尾 ()
记录集_修改业务状态.未知支持库函数_18 ()
记录集_修改业务状态.未知支持库函数_16 ()
数据库连接_修改业务状态.未知支持库函数_3 ()

.子程序 _按钮_出库_自动出库_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 

清除数组 (出库_记录号)
赋值 (., 0)
相加 (取当前目录 (), “\grd\chuku_adv.grd”).未知支持库函数_56 ()
数据库.开始查询 (“main.mdb”, , “检货及仓库”, 2)
.如果真 (小于 (., 1))
    信息框 (“数据库中还没有任何检货信息!请先录入检货信息后再进行进库操作!”, 0, )
    数据库.断开 ()
    赋值 (.禁止, 假)
    返回 ()
.如果真结束
“已出库 = '否'”.未知支持库函数_47 ()
.如果真 (小于 (., 1))
    信息框 (“当前没有要出库的货物!”, 0, )
    数据库.断开 ()
    赋值 (.禁止, 假)
    返回 ()
.如果真结束
未知支持库函数_34 ()
.计次循环首 (., 计次)
    .未知支持库函数_38 ()
    加入成员 (出库_记录号, .)
    “业务单号”.未知支持库函数_26 (临时_文本)
    计次.未知支持库函数_9 (0, 1, 临时_文本)
    “货物名称”.未知支持库函数_26 (临时_文本)
    计次.未知支持库函数_9 (1, 1, 临时_文本)
    “实际件数”.未知支持库函数_29 (临时_整数)
    计次.未知支持库函数_9 (2, 1, 到文本 (临时_整数))
    “实际重量”.未知支持库函数_29 (临时_整数)
    计次.未知支持库函数_9 (4, 1, 到文本 (临时_整数))
    “实际体积”.未知支持库函数_29 (临时_整数)
    计次.未知支持库函数_9 (5, 1, 到文本 (临时_整数))
    未知支持库函数_36 ()
.计次循环尾 ()
赋值 (.禁止, 假)
“”.未知支持库函数_47 ()
数据库.断开 ()


.子程序 _按钮_出库_保存出库信息_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 计次1, 整数型, , , 
.局部变量 临时_逻辑, 逻辑型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 更改业务状态_业务单号, 文本型, , "0", 
.局部变量 临时_文本, 文本型, , , 
.局部变量 数据库连接_更新出库临时表, 未知类型0x70001, , , 
.局部变量 记录集_更新出库临时表, 未知类型0x70002, , , 

相加 (取当前目录 (), “\data\main.mdb”).未知支持库函数_1 (“”)
.未知支持库函数_12 ()
“检货及仓库”.未知支持库函数_14 (2)
.计次循环首 (取数组成员数 (出库_记录号), 计次)
    出库_记录号.未知支持库函数_38 ( [计次])
    赋值 (临时_逻辑, 计次.未知支持库函数_10 (6))
    .如果 (等于 (临时_逻辑, 真))
        “已出库”.未知支持库函数_20 (“是”)
    .否则
        “已出库”.未知支持库函数_20 (“否”)
    .如果结束
    “实发件数”.未知支持库函数_23 (到数值 (计次.未知支持库函数_10 (2)))
    “截留件数”.未知支持库函数_23 (到数值 (计次.未知支持库函数_10 (3)))
.计次循环尾 ()
.如果 (未知支持库函数_18 ())
    信息框 (“成功写入入库信息!”, 0, )
    赋值 (.禁止, 真)
    未知支持库函数_16 ()
    未知支持库函数_3 ()
.否则
    信息框 (“写入入库信息失败!”, 0, )
    赋值 (.禁止, 真)
    未知支持库函数_16 ()
    未知支持库函数_3 ()
.如果结束

数据库.开始查询 (“main.mdb”, , “业务单”, 2)
.计次循环首 (取数组成员数 (出库_记录号), 计次)
    出库_记录号.未知支持库函数_38 ( [计次])
    “业务单号”.未知支持库函数_26 (临时_文本)
    加入成员 (更改业务状态_业务单号, 临时_文本)
.计次循环尾 ()
数据库.断开 ()

相加 (取当前目录 (), “\data\main.mdb”).未知支持库函数_1 (“”)
.未知支持库函数_12 ()
“业务状态”.未知支持库函数_14 (2)
.计次循环首 (取数组成员数 (更改业务状态_业务单号), 计次)
    .计次循环首 (., 计次1)
        “业务单号”.未知支持库函数_26 (临时_文本)
        .如果真 (等于 (临时_文本, 更改业务状态_业务单号 [计次]))
            “已出库”.未知支持库函数_20 (“是”)
        .如果真结束
        未知支持库函数_36 ()
    .计次循环尾 ()
.计次循环尾 ()
未知支持库函数_18 ()
未知支持库函数_16 ()
未知支持库函数_3 ()
复制窗口组件 (数据库连接_更新出库临时表)
复制窗口组件 (记录集_更新出库临时表)
数据库连接_更新出库临时表.未知支持库函数_1 (相加 (取当前目录 (), “\data\main.mdb”), “”)
记录集_更新出库临时表.未知支持库函数_12 (数据库连接_更新出库临时表)
记录集_更新出库临时表.未知支持库函数_14 (“出库临时表”, 2)
.计次循环首 (相减 (., 1), 计次)
    记录集_更新出库临时表.未知支持库函数_17 ()
    记录集_更新出库临时表.未知支持库函数_20 (“业务单号”, 到文本 (计次.未知支持库函数_10 (0)))
    记录集_更新出库临时表.未知支持库函数_20 (“货物名称”, 到文本 (计次.未知支持库函数_10 (1)))
    记录集_更新出库临时表.未知支持库函数_23 (“件数”, 到数值 (计次.未知支持库函数_10 (2)))
    记录集_更新出库临时表.未知支持库函数_23 (“截留件数”, 到数值 (计次.未知支持库函数_10 (3)))
    记录集_更新出库临时表.未知支持库函数_23 (“重量”, 到数值 (计次.未知支持库函数_10 (4)))
    记录集_更新出库临时表.未知支持库函数_23 (“体积”, 到数值 (计次.未知支持库函数_10 (5)))
.计次循环尾 ()
记录集_更新出库临时表.未知支持库函数_18 ()
记录集_更新出库临时表.未知支持库函数_16 ()
数据库连接_更新出库临时表.未知支持库函数_3 ()


.子程序 _按钮_外地入埠_保存_被单击, 空白型, , 
.局部变量 数据库连接_外地入埠, 未知类型0x70001, , , 
.局部变量 记录集_外地入埠, 未知类型0x70002, , , 

复制窗口组件 (数据库连接_外地入埠)
复制窗口组件 (记录集_外地入埠)
数据库连接_外地入埠.未知支持库函数_1 (相加 (取当前目录 (), “\data\ywzhxx.mdb”), “”)
记录集_外地入埠.未知支持库函数_12 (数据库连接_外地入埠)
记录集_外地入埠.未知支持库函数_14 (“外地入埠货物”, 2)
记录集_外地入埠.未知支持库函数_17 ()
记录集_外地入埠.未知支持库函数_20 (“品名”, .内容)
记录集_外地入埠.未知支持库函数_20 (“始发地”, .内容)
记录集_外地入埠.未知支持库函数_25 (“到达日期”, 到时间 (.内容))
记录集_外地入埠.未知支持库函数_20 (“入库人”, .内容)
记录集_外地入埠.未知支持库函数_20 (“提货方式”, .内容)
记录集_外地入埠.未知支持库函数_20 (“原包装”, .内容)
记录集_外地入埠.未知支持库函数_23 (“件数”, 到数值 (.内容))
记录集_外地入埠.未知支持库函数_23 (“重量”, 到数值 (.内容))
记录集_外地入埠.未知支持库函数_23 (“体积”, 到数值 (.内容))
记录集_外地入埠.未知支持库函数_20 (“提货人姓名”, .内容)
记录集_外地入埠.未知支持库函数_20 (“提货人电话”, .内容)
记录集_外地入埠.未知支持库函数_20 (“提货人单位”, .内容)
记录集_外地入埠.未知支持库函数_20 (“提货人地址”, .内容)
记录集_外地入埠.未知支持库函数_25 (“提货日期”, 到时间 (.内容))
记录集_外地入埠.未知支持库函数_20 (“出库人”, .内容)
.如果 (记录集_外地入埠.未知支持库函数_18 ())
    信息框 (“保存成功!”, 0, )
.否则
    信息框 (“保存失败!”, 0, )
    
.如果结束
记录集_外地入埠.未知支持库函数_16 ()
数据库连接_外地入埠.未知支持库函数_3 ()

.子程序 _按钮_外地入埠_查询_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 记录索引, 整数型, , "0", 
.局部变量 现行选中表项, 整数型, , , 
.局部变量 数据库连接_外地入埠查询, 未知类型0x70001, , , 
.局部变量 记录集_外地入埠查询, 未知类型0x70002, , , 

.判断开始 (等于 (.标题, “查 询”))
    .如果真 (并且 (等于 (.内容, “”), 等于 (.内容, “”)))
        信息框 (“请先输入要查询的时间范围!”, 0, )
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (外地入埠_过滤条件, “”)
    赋值 (外地入埠_过滤条件, 相加 (外地入埠_过滤条件, “到达日期 > '”, .内容, “' and 到达日期 < '”, .内容, “'”))
    .如果 (等于 (.选中, 真))
        赋值 (外地入埠_过滤条件, 相加 (外地入埠_过滤条件, “ and 已提货 = '否'”))
    .否则
        赋值 (外地入埠_过滤条件, 相加 (外地入埠_过滤条件, “ and 已提货 = '是'”))
    .如果结束
    全部删除 ()
    复制窗口组件 (数据库连接_外地入埠查询)
    复制窗口组件 (记录集_外地入埠查询)
    数据库连接_外地入埠查询.未知支持库函数_1 (相加 (取当前目录 (), “\data\ywzhxx.mdb”), “”)
    记录集_外地入埠查询.未知支持库函数_12 (数据库连接_外地入埠查询)
    记录集_外地入埠查询.未知支持库函数_14 (“外地入埠货物”, 2)
    记录集_外地入埠查询.未知支持库函数_47 (外地入埠_过滤条件)
    .如果 (小于 (记录集_外地入埠查询., 1))
        信息框 (“没有记录!”, 0, )
        赋值 (.禁止, 假)
        记录集_外地入埠查询.未知支持库函数_47 (“”)
        记录集_外地入埠查询.未知支持库函数_16 ()
        数据库连接_外地入埠查询.未知支持库函数_3 ()
        返回 ()
    .否则
        赋值 (.禁止, 真)
        
    .如果结束
    
    .计次循环首 (记录集_外地入埠查询., 计次)
        记录集_外地入埠查询.未知支持库函数_26 (“品名”, 临时_文本)
        .插入表项 (临时_文本, , , , )
        记录集_外地入埠查询.未知支持库函数_26 (“始发地”, 临时_文本)
        相减 (计次, 1).置标题 (1, 临时_文本)
        记录集_外地入埠查询.未知支持库函数_26 (“原包装”, 临时_文本)
        相减 (计次, 1).置标题 (2, 临时_文本)
        记录集_外地入埠查询.未知支持库函数_29 (“件数”, 临时_整数)
        相减 (计次, 1).置标题 (3, 到文本 (临时_整数))
        记录集_外地入埠查询.未知支持库函数_26 (“提货人姓名”, 临时_文本)
        相减 (计次, 1).置标题 (4, 临时_文本)
        记录集_外地入埠查询.未知支持库函数_26 (“提货人电话”, 临时_文本)
        相减 (计次, 1).置标题 (5, 临时_文本)
        记录集_外地入埠查询.未知支持库函数_26 (“提货人单位”, 临时_文本)
        相减 (计次, 1).置标题 (6, 临时_文本)
        加入成员 (记录索引, 记录集_外地入埠查询.)
        记录集_外地入埠查询.未知支持库函数_36 ()
    .计次循环尾 ()
    赋值 (.标题, “修 改”)
    记录集_外地入埠查询.未知支持库函数_47 (“”)
    记录集_外地入埠查询.未知支持库函数_16 ()
    数据库连接_外地入埠查询.未知支持库函数_3 ()
.判断 (等于 (.标题, “修 改”))
    复制窗口组件 (数据库连接_外地入埠查询)
    复制窗口组件 (记录集_外地入埠查询)
    数据库连接_外地入埠查询.未知支持库函数_1 (相加 (取当前目录 (), “\data\ywzhxx.mdb”), “”)
    记录集_外地入埠查询.未知支持库函数_12 (数据库连接_外地入埠查询)
    记录集_外地入埠查询.未知支持库函数_14 (“外地入埠货物”, 2)
    记录集_外地入埠查询.未知支持库函数_47 (外地入埠_过滤条件)
    记录集_外地入埠查询.未知支持库函数_38 (.)
    .如果 (等于 (.选中, 真))
        记录集_外地入埠查询.未知支持库函数_20 (“已提货”, “是”)
    .否则
        记录集_外地入埠查询.未知支持库函数_20 (“已提货”, “否”)
    .如果结束
    
    .如果 (记录集_外地入埠查询.未知支持库函数_18 ())
        信息框 (“修改'已提货'标志成功!”, 0, )
    .否则
        信息框 (“修改'已提货'标志失败!”, 0, )
    .如果结束
    记录集_外地入埠查询.未知支持库函数_47 (“”)
    记录集_外地入埠查询.未知支持库函数_16 ()
    数据库连接_外地入埠查询.未知支持库函数_3 ()
    赋值 (.标题, “查 询”)
    _按钮_外地入埠_查询_被单击 ()
    
    
.默认
    
.判断结束


.子程序 _超级列表框_外地入埠_查询列表_左键单击表项, 空白型, , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 临时_日期, 日期时间型, , , 
.局部变量 数据库连接_列表框单击, 未知类型0x70001, , , 
.局部变量 记录集_列表框单击, 未知类型0x70002, , , 

复制窗口组件 (数据库连接_列表框单击)
复制窗口组件 (记录集_列表框单击)
数据库连接_列表框单击.未知支持库函数_1 (相加 (取当前目录 (), “\data\ywzhxx.mdb”), “”)
记录集_列表框单击.未知支持库函数_12 (数据库连接_列表框单击)
记录集_列表框单击.未知支持库函数_14 (“外地入埠货物”, 2)
记录集_列表框单击.未知支持库函数_47 (外地入埠_过滤条件)
记录集_列表框单击.未知支持库函数_38 (.)
记录集_列表框单击.未知支持库函数_26 (“品名”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_列表框单击.未知支持库函数_26 (“始发地”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_列表框单击.未知支持库函数_31 (“到达日期”, 临时_日期)
赋值 (.内容, 到文本 (临时_日期))
记录集_列表框单击.未知支持库函数_26 (“入库人”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_列表框单击.未知支持库函数_26 (“提货方式”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_列表框单击.未知支持库函数_26 (“原包装”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_列表框单击.未知支持库函数_29 (“件数”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_列表框单击.未知支持库函数_29 (“重量”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_列表框单击.未知支持库函数_29 (“体积”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_列表框单击.未知支持库函数_26 (“提货人姓名”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_列表框单击.未知支持库函数_26 (“提货人电话”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_列表框单击.未知支持库函数_26 (“提货人单位”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_列表框单击.未知支持库函数_26 (“提货人地址”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_列表框单击.未知支持库函数_26 (“已提货”, 临时_文本)
.如果 (等于 (临时_文本, “是”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束
记录集_列表框单击.未知支持库函数_31 (“提货日期”, 临时_日期)
赋值 (.内容, 到文本 (临时_日期))
记录集_列表框单击.未知支持库函数_26 (“出库人”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_列表框单击.未知支持库函数_47 (“”)
记录集_列表框单击.未知支持库函数_16 ()
数据库连接_列表框单击.未知支持库函数_3 ()

.窗口程序集 窗口程序集8, , , 

.程序集变量 数据库, 数据库, , , 
.程序集变量 车辆信息修改_记录号, 整数型, , , 车辆查询时,过滤出来的记录的记录号,便于随后的修改操作
.程序集变量 加油查询_记录号, 整数型, , "0", 同上
.子程序 _调度菜单窗口_创建完毕, 空白型, , 
赋值 (.内容, 调度单号)

.子程序 _调度菜单窗口_将被销毁, 空白型, , 
赋值 (调度菜单窗口., 假)
赋值 (主窗口., 假)
主窗口.获取焦点 ()


.子程序 _按钮_车辆调度_保存_被单击, 空白型, , 
.局部变量 数据库连接_调度单保存, 未知类型0x70001, , , 
.局部变量 记录集_调度单保存, 未知类型0x70002, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请输入调度单号!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
复制窗口组件 (数据库连接_调度单保存)
复制窗口组件 (记录集_调度单保存)
.如果真 (取反 (数据库连接_调度单保存.未知支持库函数_1 (相加 (取当前目录 (), “\data\ddxx.mdb”), “”)))
    信息框 (“连接数据库失败!”, 0, )
    返回 ()
.如果真结束
记录集_调度单保存.未知支持库函数_12 (数据库连接_调度单保存)
.如果真 (取反 (记录集_调度单保存.未知支持库函数_14 (“调度记录”, 2)))
    信息框 (“打开数据表失败!”, 0, )
    返回 ()
.如果真结束
记录集_调度单保存.未知支持库函数_17 ()
记录集_调度单保存.未知支持库函数_20 (“调度单号”, .内容)
记录集_调度单保存.未知支持库函数_20 (“车牌号”, .内容)
记录集_调度单保存.未知支持库函数_25 (“提货时间”, 到时间 (.内容))
记录集_调度单保存.未知支持库函数_20 (“提货地址”, .内容)
记录集_调度单保存.未知支持库函数_20 (“司机姓名”, .内容)
记录集_调度单保存.未知支持库函数_20 (“司机电话”, .内容)
记录集_调度单保存.未知支持库函数_20 (“业务单号”, .内容)
记录集_调度单保存.未知支持库函数_20 (“行车路线”, .内容)
记录集_调度单保存.未知支持库函数_25 (“预计返回时间”, 到时间 (.内容))
记录集_调度单保存.未知支持库函数_25 (“实际返回时间”, 到时间 (.内容))
.如果 (记录集_调度单保存.未知支持库函数_18 ())
    信息框 (“保存成功!”, 0, )
.否则
    信息框 (“保存失败!”, 0, )
.如果结束
记录集_调度单保存.未知支持库函数_16 ()
数据库连接_调度单保存.未知支持库函数_3 ()

赋值 (开调度单数, 相加 (开调度单数, 1))
赋值 (调度单号, 文本替换 (调度单号, 相加 (相减 (9, 取文本长度 (到文本 (开调度单数))), 1), 取文本长度 (到文本 (开调度单数)), 到文本 (开调度单数)))
清空调度单录入界面 ()


.子程序 清空调度单录入界面, 空白型, , 
赋值 (.内容, 调度单号)
赋值 (.内容, “”)
赋值 (.内容, 到文本 (取现行时间 ()))
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, 到文本 (取现行时间 ()))
赋值 (.内容, 到文本 (取现行时间 ()))


.子程序 _按钮_车辆管理_录入保存_被单击, 空白型, , 
.局部变量 数据库连接_车辆录入保存, 未知类型0x70001, , , 
.局部变量 记录集_车辆录入保存, 未知类型0x70002, , , 
.局部变量 保险种类, 文本型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 继续否, 逻辑型, , , 

复制窗口组件 (数据库连接_车辆录入保存)
复制窗口组件 (记录集_车辆录入保存)
赋值 (保险种类, “”)
赋值 (继续否, 真)
.如果真 (等于 (.内容, “”))
    信息框 (“请输入车牌号!”, 0, )
    返回 ()
.如果真结束
数据库连接_车辆录入保存.未知支持库函数_1 (相加 (取当前目录 (), “\data\ddxx.mdb”), “”)
记录集_车辆录入保存.未知支持库函数_12 (数据库连接_车辆录入保存)
记录集_车辆录入保存.未知支持库函数_14 (“车辆信息”, 2)
.计次循环首 (记录集_车辆录入保存., 计次)
    记录集_车辆录入保存.未知支持库函数_26 (“车牌号”, 临时_文本)
    .如果真 (等于 (临时_文本, .内容))
        信息框 (“已经添加了这个车牌号的车辆信息!”, 0, )
        赋值 (继续否, 假)
        跳出循环 ()
    .如果真结束
    记录集_车辆录入保存.未知支持库函数_36 ()
.计次循环尾 ()
.如果真 (等于 (继续否, 假))
    记录集_车辆录入保存.未知支持库函数_16 ()
    数据库连接_车辆录入保存.未知支持库函数_3 ()
    获取焦点 ()
    返回 ()
    
.如果真结束
记录集_车辆录入保存.未知支持库函数_17 ()
记录集_车辆录入保存.未知支持库函数_20 (“车型”, .内容)
记录集_车辆录入保存.未知支持库函数_20 (“车牌号”, .内容)
记录集_车辆录入保存.未知支持库函数_20 (“车型”, .内容)
记录集_车辆录入保存.未知支持库函数_20 (“车型”, .内容)
记录集_车辆录入保存.未知支持库函数_20 (“行驶证”, .内容)
记录集_车辆录入保存.未知支持库函数_20 (“营运证”, .内容)
记录集_车辆录入保存.未知支持库函数_20 (“座位数”, .内容)
记录集_车辆录入保存.未知支持库函数_20 (“车重”, .内容)
记录集_车辆录入保存.未知支持库函数_20 (“载重量”, .内容)
记录集_车辆录入保存.未知支持库函数_20 (“用途”, .内容)
记录集_车辆录入保存.未知支持库函数_20 (“产权”, .内容)
记录集_车辆录入保存.未知支持库函数_25 (“购入日期”, 到时间 (.内容))
记录集_车辆录入保存.未知支持库函数_20 (“新旧程度”, .内容)
记录集_车辆录入保存.未知支持库函数_20 (“外部车辆联系人”, .内容)
记录集_车辆录入保存.未知支持库函数_20 (“年检记录”, .内容)
.判断开始 (等于 (.选中, 真))
    赋值 (保险种类, 相加 (保险种类, “车辆损失险”, “&”))
.判断 (等于 (.选中, 真))
    赋值 (保险种类, 相加 (保险种类, “第三者责任险”, “&”))
.判断 (等于 (.选中, 真))
    赋值 (保险种类, 相加 (保险种类, “车载货物掉落责任险”, “&”))
.判断 (等于 (.选中, 真))
    赋值 (保险种类, 相加 (保险种类, “无过失责任险”, “&”))
.判断 (等于 (.选中, 真))
    赋值 (保险种类, 相加 (保险种类, “车上责任险”, “&”))
.默认
    
.判断结束
记录集_车辆录入保存.未知支持库函数_20 (“保险种类”, 保险种类)
记录集_车辆录入保存.未知支持库函数_23 (“行驶公里数”, 到数值 (.内容))
记录集_车辆录入保存.未知支持库函数_23 (“月耗油量”, 到数值 (.内容))
记录集_车辆录入保存.未知支持库函数_23 (“事故次数”, 到数值 (.内容))
记录集_车辆录入保存.未知支持库函数_23 (“大修次数”, 到数值 (.内容))
记录集_车辆录入保存.未知支持库函数_20 (“备注”, .内容)
.如果 (记录集_车辆录入保存.未知支持库函数_18 ())
    信息框 (“保存成功!”, 0, )
.否则
    信息框 (相加 (“保存失败!”, 取错误信息 ()), 0, )
.如果结束
记录集_车辆录入保存.未知支持库函数_16 ()
数据库连接_车辆录入保存.未知支持库函数_3 ()

.子程序 _组合框_车辆管理_产权_列表项被选择, 空白型, , 
.如果 (等于 (.现行选中项, 1))
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
    
.如果结束


.子程序 _按钮_车辆管理_查询_被单击, 空白型, , 
.局部变量 查询条件, 文本型, , , 
.局部变量 数据库连接_车辆查询, 未知类型0x70001, , , 
.局部变量 记录集_车辆查询, 未知类型0x70002, , , 
.局部变量 保险种类, 文本型, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 临时_日期, 日期时间型, , , 

赋值 (查询条件, “”)
.判断开始 (等于 (.选中, 真))
    赋值 (查询条件, 相加 (“车牌号 = '”, .内容, “'”))
    .如果真 (等于 (.内容, “”))
        信息框 (“请输入要查找的车牌号!”, 0, )
        获取焦点 ()
        返回 ()
    .如果真结束
    
.判断 (等于 (.选中, 真))
    赋值 (查询条件, 相加 (“外部车辆联系人 = '”, .内容, “'”))
    .如果真 (等于 (.内容, “”))
        信息框 (“请输入要查找的外部车辆联系人姓名!”, 0, )
        获取焦点 ()
        返回 ()
    .如果真结束
    
.判断 (并且 (等于 (.选中, 假), 等于 (.选中, 假)))
    信息框 (“车牌号或外部车辆联系人,两者你必须选择其中一个才能继续查询.”, 0, )
    赋值 (.选中, 真)
    获取焦点 ()
.默认
    
.判断结束

.判断开始 (等于 (.标题, “查  询”))
    复制窗口组件 (数据库连接_车辆查询)
    复制窗口组件 (记录集_车辆查询)
    数据库.开始查询 (数据库连接_车辆查询, 记录集_车辆查询, “ddxx.mdb”, , “车辆信息”, 2)
    记录集_车辆查询.未知支持库函数_47 (查询条件)
    记录集_车辆查询.未知支持库函数_34 ()
    记录集_车辆查询.未知支持库函数_26 (“车型”, 临时_文本)
    赋值 (.内容, 临时_文本)
    记录集_车辆查询.未知支持库函数_26 (“车牌号”, 临时_文本)
    赋值 (.内容, 临时_文本)
    记录集_车辆查询.未知支持库函数_26 (“发动机号”, 临时_文本)
    赋值 (.内容, 临时_文本)
    记录集_车辆查询.未知支持库函数_26 (“底盘号”, 临时_文本)
    赋值 (.内容, 临时_文本)
    记录集_车辆查询.未知支持库函数_26 (“行驶证”, 临时_文本)
    赋值 (.内容, 临时_文本)
    记录集_车辆查询.未知支持库函数_26 (“营运证”, 临时_文本)
    赋值 (.内容, 临时_文本)
    记录集_车辆查询.未知支持库函数_26 (“座位数”, 临时_文本)
    赋值 (.内容, 临时_文本)
    记录集_车辆查询.未知支持库函数_26 (“车重”, 临时_文本)
    赋值 (.内容, 临时_文本)
    记录集_车辆查询.未知支持库函数_26 (“载重量”, 临时_文本)
    赋值 (.内容, 临时_文本)
    记录集_车辆查询.未知支持库函数_26 (“用途”, 临时_文本)
    赋值 (.内容, 临时_文本)
    记录集_车辆查询.未知支持库函数_26 (“产权”, 临时_文本)
    赋值 (.内容, 临时_文本)
    记录集_车辆查询.未知支持库函数_31 (“购入日期”, 临时_日期)
    赋值 (.内容, 到文本 (临时_日期))
    记录集_车辆查询.未知支持库函数_26 (“新旧程度”, 临时_文本)
    赋值 (.内容, 临时_文本)
    记录集_车辆查询.未知支持库函数_26 (“外部车辆联系人”, 临时_文本)
    赋值 (.内容, 临时_文本)
    记录集_车辆查询.未知支持库函数_26 (“年检记录”, 临时_文本)
    赋值 (.内容, 临时_文本)
    记录集_车辆查询.未知支持库函数_26 (“保险种类”, 临时_文本)
    .判断开始 (不等于 (寻找文本 (临时_文本, “车辆损失险”, , 假), -1))
        赋值 (.选中, 真)
    .判断 (不等于 (寻找文本 (临时_文本, “第三者责任险”, , 假), -1))
        赋值 (.选中, 真)
    .判断 (不等于 (寻找文本 (临时_文本, “车载货物掉落责任险”, , 假), -1))
        赋值 (.选中, 真)
    .判断 (不等于 (寻找文本 (临时_文本, “无过失责任险”, , 假), -1))
        赋值 (.选中, 真)
    .判断 (不等于 (寻找文本 (临时_文本, “车上责任险”, , 假), -1))
        赋值 (.选中, 真)
    .默认
        
    .判断结束
    记录集_车辆查询.未知支持库函数_29 (“行驶公里数”, 临时_整数)
    赋值 (.内容, 到文本 (临时_整数))
    记录集_车辆查询.未知支持库函数_29 (“月耗油量”, 临时_整数)
    赋值 (.内容, 到文本 (临时_整数))
    记录集_车辆查询.未知支持库函数_29 (“事故次数”, 临时_整数)
    赋值 (.内容, 到文本 (临时_整数))
    记录集_车辆查询.未知支持库函数_29 (“大修次数”, 临时_整数)
    赋值 (.内容, 到文本 (临时_整数))
    记录集_车辆查询.未知支持库函数_26 (“备注”, 临时_文本)
    赋值 (.内容, 临时_文本)
    赋值 (车辆信息修改_记录号, 记录集_车辆查询.)
    赋值 (.禁止, 真)
    赋值 (.标题, “修  改”)
    记录集_车辆查询.未知支持库函数_47 (“”)
    数据库.断开 (数据库连接_车辆查询, 记录集_车辆查询)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    
    
.判断 (等于 (.标题, “修  改”))
    复制窗口组件 (数据库连接_车辆查询)
    复制窗口组件 (记录集_车辆查询)
    数据库.开始查询 (数据库连接_车辆查询, 记录集_车辆查询, “ddxx.mdb”, , “车辆信息”, 2)
    记录集_车辆查询.未知支持库函数_38 (车辆信息修改_记录号)
    记录集_车辆查询.未知支持库函数_20 (“车牌号”, .内容)
    记录集_车辆查询.未知支持库函数_20 (“行驶证”, .内容)
    记录集_车辆查询.未知支持库函数_20 (“营运证”, .内容)
    记录集_车辆查询.未知支持库函数_20 (“座位数”, .内容)
    记录集_车辆查询.未知支持库函数_20 (“车重”, .内容)
    记录集_车辆查询.未知支持库函数_20 (“载重量”, .内容)
    记录集_车辆查询.未知支持库函数_20 (“用途”, .内容)
    记录集_车辆查询.未知支持库函数_20 (“产权”, .内容)
    记录集_车辆查询.未知支持库函数_20 (“新旧程度”, .内容)
    记录集_车辆查询.未知支持库函数_20 (“外部车辆联系人”, .内容)
    记录集_车辆查询.未知支持库函数_20 (“年检记录”, .内容)
    .判断开始 (等于 (.选中, 真))
        赋值 (保险种类, 相加 (保险种类, “车辆损失险”, “&”))
    .判断 (等于 (.选中, 真))
        赋值 (保险种类, 相加 (保险种类, “第三者责任险”, “&”))
    .判断 (等于 (.选中, 真))
        赋值 (保险种类, 相加 (保险种类, “车载货物掉落责任险”, “&”))
    .判断 (等于 (.选中, 真))
        赋值 (保险种类, 相加 (保险种类, “无过失责任险”, “&”))
    .判断 (等于 (.选中, 真))
        赋值 (保险种类, 相加 (保险种类, “车上责任险”, “&”))
    .默认
        
    .判断结束
    记录集_车辆查询.未知支持库函数_20 (“保险种类”, 保险种类)
    记录集_车辆查询.未知支持库函数_23 (“行驶公里数”, 到数值 (.内容))
    记录集_车辆查询.未知支持库函数_23 (“月耗油量”, 到数值 (.内容))
    记录集_车辆查询.未知支持库函数_23 (“事故次数”, 到数值 (.内容))
    记录集_车辆查询.未知支持库函数_23 (“大修次数”, 到数值 (.内容))
    记录集_车辆查询.未知支持库函数_20 (“备注”, .内容)
    .如果 (记录集_车辆查询.未知支持库函数_18 ())
        信息框 (“修改成功!”, 0, )
    .否则
        信息框 (“修改失败!”, 0, )
    .如果结束
    赋值 (.禁止, 假)
    赋值 (.标题, “查  询”)
    记录集_车辆查询.未知支持库函数_47 (“”)
    数据库.断开 (数据库连接_车辆查询, 记录集_车辆查询)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    
.默认
    
.判断结束




.子程序 _按钮_司机管理_保存_被单击, 空白型, , 
.局部变量 数据库连接_司机管理_保存, 未知类型0x70001, , , 
.局部变量 记录集_司机管理_保存, 未知类型0x70002, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_日期, 日期时间型, , , 
.局部变量 进行否, 逻辑型, , , 判断正在录入的司机信息在数据库里有没有重复,如果有就不再进行
.局部变量 计次, 整数型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请输入司机姓名!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (进行否, 真)
复制窗口组件 (数据库连接_司机管理_保存)
复制窗口组件 (记录集_司机管理_保存)
数据库连接_司机管理_保存.未知支持库函数_1 (相加 (取当前目录 (), “\data\ddxx.mdb”), “”)
记录集_司机管理_保存.未知支持库函数_12 (数据库连接_司机管理_保存)
记录集_司机管理_保存.未知支持库函数_14 (“司机信息”, 2)
.计次循环首 (记录集_司机管理_保存., 计次)
    记录集_司机管理_保存.未知支持库函数_26 (“姓名”, 临时_文本)
    .如果真 (等于 (临时_文本, .内容))
        信息框 (“该司机信息已存在.”, 0, )
        赋值 (进行否, 假)
        跳出循环 ()
    .如果真结束
    记录集_司机管理_保存.未知支持库函数_36 ()
.计次循环尾 ()
.如果真 (等于 (进行否, 假))
    记录集_司机管理_保存.未知支持库函数_16 ()
    数据库连接_司机管理_保存.未知支持库函数_3 ()
    返回 ()
.如果真结束
记录集_司机管理_保存.未知支持库函数_17 ()
记录集_司机管理_保存.未知支持库函数_20 (“编号”, .内容)
记录集_司机管理_保存.未知支持库函数_20 (“姓名”, .内容)
记录集_司机管理_保存.未知支持库函数_25 (“出生日期”, 到时间 (.内容))
记录集_司机管理_保存.未知支持库函数_20 (“籍贯”, .内容)
记录集_司机管理_保存.未知支持库函数_20 (“学历”, .内容)
记录集_司机管理_保存.未知支持库函数_20 (“身份证号”, .内容)
记录集_司机管理_保存.未知支持库函数_20 (“联系电话”, .内容)
记录集_司机管理_保存.未知支持库函数_20 (“驾照类型”, .内容)
.如果 (等于 (.选中, 真))
    记录集_司机管理_保存.未知支持库函数_20 (“从业资格证”, “有”)
.否则
    记录集_司机管理_保存.未知支持库函数_20 (“从业资格证”, “无”)
.如果结束

记录集_司机管理_保存.未知支持库函数_20 (“驾龄”, .内容)
记录集_司机管理_保存.未知支持库函数_25 (“上次年审日期”, 到时间 (.内容))
记录集_司机管理_保存.未知支持库函数_20 (“工作经历”, .内容)
记录集_司机管理_保存.未知支持库函数_20 (“婚姻状况”, .内容)
记录集_司机管理_保存.未知支持库函数_20 (“备注”, .内容)
.如果 (记录集_司机管理_保存.未知支持库函数_18 ())
    信息框 (“保存成功!”, 0, )
.否则
    信息框 (“保存失败!”, 0, )
.如果结束
记录集_司机管理_保存.未知支持库函数_16 ()
数据库连接_司机管理_保存.未知支持库函数_3 ()

.子程序 _按钮_司机管理_姓名_被单击, 空白型, , 
.局部变量 数据库连接_司机姓名查询, 未知类型0x70001, , , 
.局部变量 记录集_司机姓名查询, 未知类型0x70002, , , 
.局部变量 计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_日期, 日期时间型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请先输入要查询的司机姓名!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
复制窗口组件 (数据库连接_司机姓名查询)
复制窗口组件 (记录集_司机姓名查询)
数据库.开始查询 (数据库连接_司机姓名查询, 记录集_司机姓名查询, “ddxx.mdb”, , “司机信息”, 2)
记录集_司机姓名查询.未知支持库函数_47 (相加 (“姓名 = '”, .内容, “'”))
.如果真 (小于 (记录集_司机姓名查询., 1))
    信息框 (“数据库中没有您要查找的司机信息!请检查您有没有输错该司机的姓名.”, 0, )
    数据库.断开 (数据库连接_司机姓名查询, 记录集_司机姓名查询)
    返回 ()
.如果真结束
记录集_司机姓名查询.未知支持库函数_34 ()
记录集_司机姓名查询.未知支持库函数_26 (“编号”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_司机姓名查询.未知支持库函数_31 (“出生日期”, 临时_日期)
赋值 (.内容, 到文本 (临时_日期))
记录集_司机姓名查询.未知支持库函数_26 (“籍贯”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_司机姓名查询.未知支持库函数_26 (“学历”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_司机姓名查询.未知支持库函数_26 (“身份证号”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_司机姓名查询.未知支持库函数_26 (“联系电话”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_司机姓名查询.未知支持库函数_26 (“驾照类型”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_司机姓名查询.未知支持库函数_26 (“从业资格证”, 临时_文本)
.如果 (等于 (临时_文本, “有”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束
记录集_司机姓名查询.未知支持库函数_26 (“驾龄”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_司机姓名查询.未知支持库函数_31 (“上次年审日期”, 临时_日期)
赋值 (.内容, 到文本 (临时_日期))
记录集_司机姓名查询.未知支持库函数_26 (“工作经历”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_司机姓名查询.未知支持库函数_26 (“婚姻状况”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_司机姓名查询.未知支持库函数_26 (“备注”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_司机姓名查询.未知支持库函数_47 (“”)
数据库.断开 (数据库连接_司机姓名查询, 记录集_司机姓名查询)

.子程序 _按钮_车辆调度_调度单号_被单击, 空白型, , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_时间, 日期时间型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 数据库连接_按调度号查询, 未知类型0x70001, , , 
.局部变量 记录集_按调度号查询, 未知类型0x70002, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请先输入要查询的调度单号!”, 0, )
    返回 ()
.如果真结束
复制窗口组件 (数据库连接_按调度号查询)
复制窗口组件 (记录集_按调度号查询)
数据库连接_按调度号查询.未知支持库函数_1 (相加 (取当前目录 (), “\data\ddxx.mdb”), “”)
记录集_按调度号查询.未知支持库函数_12 (数据库连接_按调度号查询)
记录集_按调度号查询.未知支持库函数_14 (“调度记录”, 2)
记录集_按调度号查询.未知支持库函数_47 (相加 (“调度单号 = '”, .内容, “'”))
.如果真 (小于 (记录集_按调度号查询., 1))
    信息框 (“该调度信息不存在!”, 0, )
    记录集_按调度号查询.未知支持库函数_47 (“”)
    记录集_按调度号查询.未知支持库函数_16 ()
    数据库连接_按调度号查询.未知支持库函数_3 ()
.如果真结束
记录集_按调度号查询.未知支持库函数_26 (“车牌号”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_按调度号查询.未知支持库函数_31 (“提货时间”, 临时_时间)
赋值 (.内容, 到文本 (临时_时间))
记录集_按调度号查询.未知支持库函数_26 (“提货地址”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_按调度号查询.未知支持库函数_26 (“司机姓名”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_按调度号查询.未知支持库函数_26 (“司机电话”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_按调度号查询.未知支持库函数_26 (“业务单号”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_按调度号查询.未知支持库函数_26 (“行车路线”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_按调度号查询.未知支持库函数_31 (“预计返回时间”, 临时_时间)
赋值 (.内容, 到文本 (临时_时间))
记录集_按调度号查询.未知支持库函数_31 (“实际返回时间”, 临时_时间)
赋值 (.内容, 到文本 (临时_时间))
记录集_按调度号查询.未知支持库函数_47 (“”)
记录集_按调度号查询.未知支持库函数_16 ()
数据库连接_按调度号查询.未知支持库函数_3 ()

.子程序 _按钮_维修保养_保存_被单击, 空白型, , 
.局部变量 数据库连接_维修保养保存, 未知类型0x70001, , , 
.局部变量 记录集_维修保养保存, 未知类型0x70002, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“车牌号是必须输入的信息!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
复制窗口组件 (数据库连接_维修保养保存)
复制窗口组件 (记录集_维修保养保存)
.如果真 (取反 (数据库连接_维修保养保存.未知支持库函数_1 (相加 (取当前目录 (), “\data\ddxx.mdb”), “”)))
    信息框 (“数据库连接失败!”, 0, )
    返回 ()
.如果真结束
记录集_维修保养保存.未知支持库函数_12 (数据库连接_维修保养保存)
.如果真 (取反 (记录集_维修保养保存.未知支持库函数_14 (“维修保养记录”, 2)))
    信息框 (“打开数据表失败!”, 0, )
    数据库连接_维修保养保存.未知支持库函数_3 ()
    返回 ()
.如果真结束
.如果真 (取反 (记录集_维修保养保存.未知支持库函数_17 ()))
    信息框 (“添加新记录失败!”, 0, )
    返回 ()
.如果真结束
记录集_维修保养保存.未知支持库函数_20 (“车牌号”, .内容)
记录集_维修保养保存.未知支持库函数_20 (“事件”, .内容)
记录集_维修保养保存.未知支持库函数_20 (“原因”, .内容)
记录集_维修保养保存.未知支持库函数_20 (“更换配件”, .内容)
记录集_维修保养保存.未知支持库函数_20 (“补充说明”, .内容)
记录集_维修保养保存.未知支持库函数_20 (“维修厂名称”, .内容)
记录集_维修保养保存.未知支持库函数_20 (“维修厂地址”, .内容)
记录集_维修保养保存.未知支持库函数_20 (“维修厂电话”, .内容)
记录集_维修保养保存.未知支持库函数_20 (“应急修理电话”, .内容)
记录集_维修保养保存.未知支持库函数_23 (“费用”, 到数值 (.内容))
记录集_维修保养保存.未知支持库函数_20 (“结款方式”, .内容)
记录集_维修保养保存.未知支持库函数_20 (“经手人”, .内容)
记录集_维修保养保存.未知支持库函数_20 (“审核人”, .内容)
记录集_维修保养保存.未知支持库函数_25 (“日期”, 到时间 (.内容))
.如果 (记录集_维修保养保存.未知支持库函数_18 ())
    信息框 (“保存成功!”, 0, )
.否则
    信息框 (“保存失败!”, 0, )
.如果结束
记录集_维修保养保存.未知支持库函数_16 ()
数据库连接_维修保养保存.未知支持库函数_3 ()
清空维修保养界面 ()

.子程序 清空维修保养界面, 空白型, , 
赋值 (.内容, “”)
赋值 (.现行选中项, 0)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.现行选中项, 1)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, 到文本 (取现行时间 ()))


.子程序 _按钮_维修保养_车牌号_被单击, 空白型, , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 临时_日期, 日期时间型, , , 
.局部变量 数据库连接_维修保养_按车牌号查询, 未知类型0x70001, , , 
.局部变量 记录集_维修保养_按车牌号查询, 未知类型0x70002, , , 
.局部变量 计次, 整数型, , , 

赋值 (.可视, 真)
清空 ()

.如果真 (等于 (.内容, “”))
    信息框 (“请输入你要查询维修保养信息的车牌号!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
复制窗口组件 (数据库连接_维修保养_按车牌号查询)
复制窗口组件 (记录集_维修保养_按车牌号查询)
.如果真 (取反 (数据库连接_维修保养_按车牌号查询.未知支持库函数_1 (相加 (取当前目录 (), “\data\ddxx.mdb”), “”)))
    信息框 (“数据库连接失败!”, 0, )
    返回 ()
.如果真结束
记录集_维修保养_按车牌号查询.未知支持库函数_12 (数据库连接_维修保养_按车牌号查询)
.如果真 (取反 (记录集_维修保养_按车牌号查询.未知支持库函数_14 (“维修保养记录”, 2)))
    信息框 (“数据表打开失败!”, 0, )
    数据库连接_维修保养_按车牌号查询.未知支持库函数_3 ()
    返回 ()
.如果真结束
记录集_维修保养_按车牌号查询.未知支持库函数_47 (相加 (“车牌号 = '”, .内容, “'”))
.如果真 (小于 (记录集_维修保养_按车牌号查询., 1))
    信息框 (“没有找到您要找的信息!”, 0, )
    记录集_维修保养_按车牌号查询.未知支持库函数_47 (“”)
    记录集_维修保养_按车牌号查询.未知支持库函数_16 ()
    数据库连接_维修保养_按车牌号查询.未知支持库函数_3 ()
.如果真结束
记录集_维修保养_按车牌号查询.未知支持库函数_34 ()
.计次循环首 (记录集_维修保养_按车牌号查询., 计次)
    记录集_维修保养_按车牌号查询.未知支持库函数_31 (“日期”, 临时_日期)
    到文本 (临时_日期).加入项目 ()
    记录集_维修保养_按车牌号查询.未知支持库函数_36 ()
.计次循环尾 ()
记录集_维修保养_按车牌号查询.未知支持库函数_47 (“”)
记录集_维修保养_按车牌号查询.未知支持库函数_16 ()
数据库连接_维修保养_按车牌号查询.未知支持库函数_3 ()
赋值 (.禁止, 真)
赋值 (.禁止, 真)


.子程序 _按钮_加油_保存_被单击, 空白型, , 
.局部变量 数据库连接_加油保存, 未知类型0x70001, , , 
.局部变量 记录集_加油保存, 未知类型0x70002, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请输入车牌号,这是必须的信息.”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
复制窗口组件 (数据库连接_加油保存)
复制窗口组件 (记录集_加油保存)
.如果真 (取反 (数据库连接_加油保存.未知支持库函数_1 (相加 (取当前目录 (), “\data\ddxx.mdb”), “”)))
    信息框 (“连接数据库失败!”, 0, )
    返回 ()
.如果真结束
记录集_加油保存.未知支持库函数_12 (数据库连接_加油保存)
.如果真 (取反 (记录集_加油保存.未知支持库函数_14 (“加油记录”, 2)))
    信息框 (“打开数据表失败!”, 0, )
    数据库连接_加油保存.未知支持库函数_3 ()
    返回 ()
.如果真结束
.如果真 (取反 (记录集_加油保存.未知支持库函数_17 ()))
    信息框 (“添加新记录失败!”, 0, )
    记录集_加油保存.未知支持库函数_16 ()
    数据库连接_加油保存.未知支持库函数_3 ()
.如果真结束
记录集_加油保存.未知支持库函数_20 (“车牌号”, .内容)
记录集_加油保存.未知支持库函数_20 (“司机”, .内容)
记录集_加油保存.未知支持库函数_25 (“日期”, 到时间 (.内容))
记录集_加油保存.未知支持库函数_20 (“加油站”, .内容)
记录集_加油保存.未知支持库函数_20 (“加油类型”, .内容)
记录集_加油保存.未知支持库函数_21 (“加油量”, 到数值 (.内容))
记录集_加油保存.未知支持库函数_21 (“单价”, 到数值 (.内容))
记录集_加油保存.未知支持库函数_21 (“合计费用”, 到数值 (.内容))
记录集_加油保存.未知支持库函数_20 (“结款方式”, .内容)
记录集_加油保存.未知支持库函数_20 (“核批人”, .内容)

.如果 (记录集_加油保存.未知支持库函数_18 ())
    信息框 (“保存成功!”, 0, )
.否则
    信息框 (“保存失败!”, 0, )
.如果结束
记录集_加油保存.未知支持库函数_16 ()
数据库连接_加油保存.未知支持库函数_3 ()

.子程序 _按钮_加油_查询_被单击, 空白型, , 
.局部变量 数据库连接_加油查询, 未知类型0x70001, , , 
.局部变量 记录集_加油查询, 未知类型0x70002, , , 
.局部变量 计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 双精度小数型, , , 
.局部变量 临时_日期, 日期时间型, , , 
.局部变量 过滤条件, 文本型, , , 

赋值 (过滤条件, “”)
.判断开始 (等于 (.标题, “查  询”))
    .如果 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
        信息框 (“请先输入需要查询的日期范围,从某某日期到某某日期!”, 0, )
        获取焦点 ()
        返回 ()
    .否则
        赋值 (过滤条件, 相加 (“日期 > '”, .内容, “' and 日期 < '”, .内容, “'”))
    .如果结束
    复制窗口组件 (数据库连接_加油查询)
    复制窗口组件 (记录集_加油查询)
    .如果真 (取反 (数据库连接_加油查询.未知支持库函数_1 (相加 (取当前目录 (), “\data\ddxx.mdb”), “”)))
        信息框 (“数据库连接失败!”, 0, )
        返回 ()
    .如果真结束
    记录集_加油查询.未知支持库函数_12 (数据库连接_加油查询)
    .如果真 (取反 (记录集_加油查询.未知支持库函数_14 (“加油记录”, 2)))
        信息框 (“打开数据表失败!”, 0, )
        数据库连接_加油查询.未知支持库函数_3 ()
        返回 ()
    .如果真结束
    记录集_加油查询.未知支持库函数_47 (过滤条件)
    .如果真 (小于 (记录集_加油查询., 1))
        信息框 (“没有找到您要查询的信息!”, 0, )
        记录集_加油查询.未知支持库函数_47 (“”)
        记录集_加油查询.未知支持库函数_16 ()
        数据库连接_加油查询.未知支持库函数_3 ()
    .如果真结束
    记录集_加油查询.未知支持库函数_34 ()
    全部删除 ()
    .计次循环首 (记录集_加油查询., 计次)
        记录集_加油查询.未知支持库函数_26 (“车牌号”, 临时_文本)
        .插入表项 (临时_文本, , , , )
        记录集_加油查询.未知支持库函数_26 (“司机”, 临时_文本)
        相减 (计次, 1).置标题 (1, 临时_文本)
        记录集_加油查询.未知支持库函数_26 (“加油类型”, 临时_文本)
        相减 (计次, 1).置标题 (2, 临时_文本)
        记录集_加油查询.未知支持库函数_27 (“加油量”, 临时_整数)
        相减 (计次, 1).置标题 (3, 到文本 (临时_整数))
        记录集_加油查询.未知支持库函数_27 (“单价”, 临时_整数)
        相减 (计次, 1).置标题 (4, 到文本 (临时_整数))
        记录集_加油查询.未知支持库函数_27 (“合计费用”, 临时_整数)
        相减 (计次, 1).置标题 (5, 到文本 (临时_整数))
        记录集_加油查询.未知支持库函数_26 (“结款方式”, 临时_文本)
        相减 (计次, 1).置标题 (6, 临时_文本)
        记录集_加油查询.未知支持库函数_26 (“核批人”, 临时_文本)
        相减 (计次, 1).置标题 (7, 临时_文本)
        加入成员 (加油查询_记录号, 记录集_加油查询.)
        记录集_加油查询.未知支持库函数_36 ()
    .计次循环尾 ()
    记录集_加油查询.未知支持库函数_47 (“”)
    记录集_加油查询.未知支持库函数_16 ()
    数据库连接_加油查询.未知支持库函数_3 ()
    赋值 (.标题, “关闭查询”)
    赋值 (.禁止, 真)
.判断 (等于 (.标题, “关闭查询”))
    赋值 (.标题, “查  询”)
    赋值 (.禁止, 假)
    全部删除 ()
.默认
    
.判断结束



.子程序 _超级列表框_加油_查询结果_左键单击表项, 空白型, , 
.局部变量 被选择表项索引, 整数型, , , 
.局部变量 数据库连接_表项内容显示, 未知类型0x70001, , , 
.局部变量 记录集_表项内容显示, 未知类型0x70002, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 双精度小数型, , , 

.如果真 (等于 (., -1))
    信息框 (“您选中的是空表项,请选择有信息的表项!”, 0, )
    返回 ()
.如果真结束
复制窗口组件 (数据库连接_表项内容显示)
复制窗口组件 (记录集_表项内容显示)
.如果真 (取反 (数据库连接_表项内容显示.未知支持库函数_1 (相加 (取当前目录 (), “\data\ddxx.mdb”), “”)))
    信息框 (“数据库连接失败!”, 0, )
    返回 ()
.如果真结束
记录集_表项内容显示.未知支持库函数_12 (数据库连接_表项内容显示)
.如果真 (取反 (记录集_表项内容显示.未知支持库函数_14 (“加油记录”, 2)))
    信息框 (“打开数据表失败!”, 0, )
    数据库连接_表项内容显示.未知支持库函数_3 ()
    返回 ()
.如果真结束

赋值 (被选择表项索引, .)
记录集_表项内容显示.未知支持库函数_38 (加油查询_记录号 [相加 (被选择表项索引, 1)])
记录集_表项内容显示.未知支持库函数_26 (“车牌号”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_表项内容显示.未知支持库函数_26 (“司机”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_表项内容显示.未知支持库函数_26 (“加油类型”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_表项内容显示.未知支持库函数_27 (“加油量”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_表项内容显示.未知支持库函数_27 (“单价”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_表项内容显示.未知支持库函数_27 (“合计费用”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_表项内容显示.未知支持库函数_26 (“结款方式”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_表项内容显示.未知支持库函数_26 (“核批人”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_表项内容显示.未知支持库函数_16 ()
数据库连接_表项内容显示.未知支持库函数_3 ()


.子程序 _列表框_维修保养_查询结果_列表项被选择, 空白型, , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 临时_日期, 日期时间型, , , 
.局部变量 数据库连接_维修保养_显示, 未知类型0x70001, , , 
.局部变量 记录集_维修保养_显示, 未知类型0x70002, , , 


.如果真 (等于 (.内容, “”))
    信息框 (“请输入你要查询维修保养信息的车牌号!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
复制窗口组件 (数据库连接_维修保养_显示)
复制窗口组件 (记录集_维修保养_显示)
.如果真 (取反 (数据库连接_维修保养_显示.未知支持库函数_1 (相加 (取当前目录 (), “\data\ddxx.mdb”), “”)))
    信息框 (“数据库连接失败!”, 0, )
    返回 ()
.如果真结束
记录集_维修保养_显示.未知支持库函数_12 (数据库连接_维修保养_显示)
.如果真 (取反 (记录集_维修保养_显示.未知支持库函数_14 (“维修保养记录”, 2)))
    信息框 (“数据表打开失败!”, 0, )
    数据库连接_维修保养_显示.未知支持库函数_3 ()
    返回 ()
.如果真结束
记录集_维修保养_显示.未知支持库函数_47 (相加 (“车牌号 = '”, .内容, “'”))
.如果真 (小于 (记录集_维修保养_显示., 1))
    信息框 (“没有找到您要找的信息!”, 0, )
    记录集_维修保养_显示.未知支持库函数_47 (“”)
    记录集_维修保养_显示.未知支持库函数_16 ()
    数据库连接_维修保养_显示.未知支持库函数_3 ()
.如果真结束
记录集_维修保养_显示.未知支持库函数_34 ()
记录集_维修保养_显示.未知支持库函数_26 (“事件”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_维修保养_显示.未知支持库函数_26 (“原因”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_维修保养_显示.未知支持库函数_26 (“更换配件”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_维修保养_显示.未知支持库函数_26 (“补充说明”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_维修保养_显示.未知支持库函数_26 (“维修厂名称”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_维修保养_显示.未知支持库函数_26 (“维修厂地址”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_维修保养_显示.未知支持库函数_26 (“维修厂电话”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_维修保养_显示.未知支持库函数_26 (“应急修理电话”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_维修保养_显示.未知支持库函数_29 (“费用”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_维修保养_显示.未知支持库函数_26 (“结款方式”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_维修保养_显示.未知支持库函数_26 (“经手人”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_维修保养_显示.未知支持库函数_26 (“审核人”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_维修保养_显示.未知支持库函数_31 (“日期”, 临时_日期)
赋值 (.内容, 到文本 (临时_日期))
记录集_维修保养_显示.未知支持库函数_47 (“”)
记录集_维修保养_显示.未知支持库函数_16 ()
数据库连接_维修保养_显示.未知支持库函数_3 ()
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.可视, 假)


.子程序 _按钮_维修保养_清空_被单击, 空白型, , 
清空维修保养界面 ()


.子程序 _编辑框_加油_合计费用_获得焦点, 空白型, , 
赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))


.子程序 _编辑框_车辆调度_行车路线_获得焦点, 空白型, , 
.局部变量 分割提货地址, 文本型, , "0", 
.局部变量 计次, 整数型, , , 

赋值 (.内容, “”)
清除数组 (分割提货地址)
赋值 (分割提货地址, 分割文本 (.内容, “&”, ))
.计次循环首 (取数组成员数 (分割提货地址), 计次)
    赋值 (.内容, 相加 (.内容, 分割提货地址 [计次], “===>”))
.计次循环尾 ()
赋值 (.内容, 相加 (.内容, “回公司”))


.窗口程序集 窗口程序集9, , , 

.程序集变量 数据库, 数据库, , , 
.程序集变量 匿名程序集变量_4145, 空白型, , , 
.子程序 _市场部菜单窗口_创建完毕, 空白型, , 


.子程序 _市场部菜单窗口_将被销毁, 空白型, , 
赋值 (市场部菜单窗口., 假)
赋值 (主窗口., 假)
主窗口.获取焦点 ()



.子程序 _按钮_市场人员_录入保存_被单击, 空白型, , 
.局部变量 数据库连接_市场人员保存, 未知类型0x70001, , , 
.局部变量 记录集_市场人员保存, 未知类型0x70002, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请输入市场人员姓名!”, 0, )
    获取焦点 ()
    
.如果真结束
复制窗口组件 (数据库连接_市场人员保存)
复制窗口组件 (记录集_市场人员保存)
数据库.开始查询 (数据库连接_市场人员保存, 记录集_市场人员保存, “sc.mdb”, , “市场人员”, 2)
记录集_市场人员保存.未知支持库函数_47 (相加 (“姓名 = '”, .内容, “'”))
.如果真 (大于或等于 (记录集_市场人员保存., 1))
    信息框 (“此人信息已存在!不能重复添加.”, 0, )
    记录集_市场人员保存.未知支持库函数_47 (“”)
    数据库.断开 (数据库连接_市场人员保存, 记录集_市场人员保存)
    返回 ()
    
.如果真结束
记录集_市场人员保存.未知支持库函数_47 (“”)
记录集_市场人员保存.未知支持库函数_17 ()
记录集_市场人员保存.未知支持库函数_20 (“姓名”, .内容)
记录集_市场人员保存.未知支持库函数_20 (“性别”, .内容)
记录集_市场人员保存.未知支持库函数_25 (“出生日期”, 到时间 (.内容))
记录集_市场人员保存.未知支持库函数_20 (“学历”, .内容)
记录集_市场人员保存.未知支持库函数_20 (“营销经历”, .内容)
记录集_市场人员保存.未知支持库函数_20 (“物流行业经验”, .内容)
.如果 (记录集_市场人员保存.未知支持库函数_18 ())
    信息框 (“保存成功!”, 0, )
.否则
    信息框 (“保存失败!”, 0, )
.如果结束
记录集_市场人员保存.未知支持库函数_47 (“”)
数据库.断开 (数据库连接_市场人员保存, 记录集_市场人员保存)
赋值 (.内容, “”)
赋值 (.现行选中项, 0)
赋值 (.内容, “”)
赋值 (.现行选中项, 2)
赋值 (.内容, “”)
赋值 (.内容, “”)


.子程序 _按钮_市场人员_姓名_被单击, 空白型, , 
.局部变量 数据库连接_市场人员查询, 未知类型0x70001, , , 
.局部变量 记录集_市场人员查询, 未知类型0x70002, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_日期, 日期时间型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请输入市场人员姓名!”, 0, )
    获取焦点 ()
    
.如果真结束
复制窗口组件 (数据库连接_市场人员查询)
复制窗口组件 (记录集_市场人员查询)
数据库.开始查询 (数据库连接_市场人员查询, 记录集_市场人员查询, “sc.mdb”, , “市场人员”, 2)
记录集_市场人员查询.未知支持库函数_47 (相加 (“姓名 = '”, .内容, “'”))
.如果真 (小于 (记录集_市场人员查询., 1))
    信息框 (“没有找到您要查询的信息!”, 0, )
    记录集_市场人员查询.未知支持库函数_47 (“”)
    数据库.断开 (数据库连接_市场人员查询, 记录集_市场人员查询)
    返回 ()
.如果真结束
记录集_市场人员查询.未知支持库函数_26 (“性别”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_市场人员查询.未知支持库函数_31 (“出生日期”, 临时_日期)
赋值 (.内容, 到文本 (临时_日期))
记录集_市场人员查询.未知支持库函数_26 (“学历”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_市场人员查询.未知支持库函数_26 (“营销经历”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_市场人员查询.未知支持库函数_26 (“物流行业经验”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_市场人员查询.未知支持库函数_47 (“”)
数据库.断开 (数据库连接_市场人员查询, 记录集_市场人员查询)


.子程序 _按钮_客户拜访_录入保存_被单击, 空白型, , 
.局部变量 数据库连接_客户拜访保存, 未知类型0x70001, , , 
.局部变量 记录集_客户拜访保存, 未知类型0x70002, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请输入客户名称!”, 0, )
    获取焦点 ()
    
.如果真结束
复制窗口组件 (数据库连接_客户拜访保存)
复制窗口组件 (记录集_客户拜访保存)
数据库.开始查询 (数据库连接_客户拜访保存, 记录集_客户拜访保存, “sc.mdb”, , “客户拜访记录”, 2)
记录集_客户拜访保存.未知支持库函数_17 ()
记录集_客户拜访保存.未知支持库函数_20 (“客户名称”, .内容)
记录集_客户拜访保存.未知支持库函数_20 (“客户地址”, .内容)
记录集_客户拜访保存.未知支持库函数_20 (“联系人”, .内容)
记录集_客户拜访保存.未知支持库函数_20 (“联系电话”, .内容)
记录集_客户拜访保存.未知支持库函数_20 (“货物名称”, .内容)
记录集_客户拜访保存.未知支持库函数_20 (“货物价值类别”, .内容)
记录集_客户拜访保存.未知支持库函数_20 (“拜访人员”, .内容)
记录集_客户拜访保存.未知支持库函数_24 (“预约否”, .选中)
记录集_客户拜访保存.未知支持库函数_25 (“预约时间”, 到时间 (.内容))
记录集_客户拜访保存.未知支持库函数_25 (“到访时间”, 到时间 (.内容))
记录集_客户拜访保存.未知支持库函数_25 (“结束时间”, 到时间 (.内容))
记录集_客户拜访保存.未知支持库函数_23 (“车费开支”, 到数值 (.内容))
记录集_客户拜访保存.未知支持库函数_23 (“礼品开支”, 到数值 (.内容))
记录集_客户拜访保存.未知支持库函数_23 (“宴请开支”, 到数值 (.内容))
记录集_客户拜访保存.未知支持库函数_20 (“拜访效果”, .内容)
.如果 (记录集_客户拜访保存.未知支持库函数_18 ())
    信息框 (“保存成功!”, 0, )
.否则
    信息框 (“保存失败!”, 0, )
.如果结束
数据库.断开 (数据库连接_客户拜访保存, 记录集_客户拜访保存)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.现行选中项, 0)
赋值 (.内容, “”)
赋值 (.选中, 假)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)


.子程序 _按钮_客户拜访_客户名称_被单击, 空白型, , 
.局部变量 数据库连接_客户查询, 未知类型0x70001, , , 
.局部变量 记录集_客户查询, 未知类型0x70002, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 临时_日期, 日期时间型, , , 
.局部变量 临时_逻辑, 逻辑型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请输入要查询的客户名称!”, 0, )
    获取焦点 ()
    返回 ()
    
.如果真结束
复制窗口组件 (数据库连接_客户查询)
复制窗口组件 (记录集_客户查询)
数据库.开始查询 (数据库连接_客户查询, 记录集_客户查询, “sc.mdb”, , “客户拜访记录”, 2)
记录集_客户查询.未知支持库函数_47 (相加 (“客户名称 = '”, .内容, “'”))
.如果真 (小于 (记录集_客户查询., 1))
    信息框 (“没有找到任何信息,请检查您输入的客户名称是不是正确!”, 0, )
    数据库.断开 (数据库连接_客户查询, 记录集_客户查询)
    返回 ()
    
.如果真结束
记录集_客户查询.未知支持库函数_26 (“客户名称”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_客户查询.未知支持库函数_26 (“客户地址”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_客户查询.未知支持库函数_26 (“联系人”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_客户查询.未知支持库函数_26 (“联系电话”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_客户查询.未知支持库函数_26 (“货物名称”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_客户查询.未知支持库函数_26 (“货物价值类别”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_客户查询.未知支持库函数_26 (“拜访人员”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_客户查询.未知支持库函数_30 (“预约否”, 临时_逻辑)
赋值 (.选中, 临时_逻辑)
记录集_客户查询.未知支持库函数_31 (“预约时间”, 临时_日期)
赋值 (.内容, 到文本 (临时_日期))
记录集_客户查询.未知支持库函数_31 (“到访时间”, 临时_日期)
赋值 (.内容, 到文本 (临时_日期))
记录集_客户查询.未知支持库函数_31 (“结束时间”, 临时_日期)
赋值 (.内容, 到文本 (临时_日期))
记录集_客户查询.未知支持库函数_29 (“车费开支”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_客户查询.未知支持库函数_29 (“礼品开支”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_客户查询.未知支持库函数_29 (“宴请开支”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_客户查询.未知支持库函数_26 (“拜访效果”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_客户查询.未知支持库函数_47 (“”)
数据库.断开 (数据库连接_客户查询, 记录集_客户查询)


.子程序 _按钮_业绩提成_录入保存_被单击, 空白型, , 
.局部变量 数据库连接_业绩提成保存, 未知类型0x70001, , , 
.局部变量 记录集_业绩提成保存, 未知类型0x70002, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请输入姓名!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
复制窗口组件 (数据库连接_业绩提成保存)
复制窗口组件 (记录集_业绩提成保存)
数据库.开始查询 (数据库连接_业绩提成保存, 记录集_业绩提成保存, “sc.mdb”, , “业绩提成”, 2)
记录集_业绩提成保存.未知支持库函数_17 ()
记录集_业绩提成保存.未知支持库函数_20 (“姓名”, .内容)
记录集_业绩提成保存.未知支持库函数_20 (“客户名称”, .内容)
记录集_业绩提成保存.未知支持库函数_25 (“发货日期”, 到时间 (.内容))
记录集_业绩提成保存.未知支持库函数_20 (“业务单号”, .内容)
记录集_业绩提成保存.未知支持库函数_23 (“运费金额”, 到数值 (.内容))
记录集_业绩提成保存.未知支持库函数_23 (“已提成月数”, 到数值 (.内容))
记录集_业绩提成保存.未知支持库函数_23 (“提成比例”, 到数值 (.内容))
记录集_业绩提成保存.未知支持库函数_23 (“提成金额”, 到数值 (.内容))
记录集_业绩提成保存.未知支持库函数_25 (“提成截止日期”, 到时间 (.内容))
.如果 (记录集_业绩提成保存.未知支持库函数_18 ())
    信息框 (“保存成功!”, 0, )
.否则
    信息框 (“保存失败!”, 0, )
    
.如果结束
数据库.断开 (数据库连接_业绩提成保存, 记录集_业绩提成保存)


.子程序 _按钮_业绩提成_查询_被单击, 空白型, , 
.局部变量 数据库连接_业绩提成查询, 未知类型0x70001, , , 
.局部变量 记录集_业绩提成查询, 未知类型0x70002, , , 
.局部变量 过滤条件, 文本型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 总计票数, 整数型, , , 
.局部变量 总计运费金额, 整数型, , , 
.局部变量 总计应提金额, 整数型, , , 

.如果真 (并且 (等于 (.选中, 真), 等于 (.内容, “”)))
    信息框 (“请输入姓名!”, 0, )
    返回 ()
.如果真结束
.如果真 (并且 (等于 (.选中, 真), 等于 (.内容, “”)))
    信息框 (“请输入客户名称!”, 0, )
    返回 ()
.如果真结束
.如果真 (并且 (等于 (.选中, 真), 等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“请输入从日期和到日期这两个日期”, 0, )
    返回 ()
.如果真结束
 ' 如果真 (编辑框_业绩提成_提成比例计算.内容 ＝ “”)
 ' 信息框 (“请输入提成比例,此比例应是一位数到两位数的整数,单位为百分之.”, 0, )
 ' 返回 ()

赋值 (过滤条件, “”) ' 必须要先把过滤条件置为空串,否则多查询几次,过滤条件会出错误的.
.如果真 (等于 (.选中, 真)) ' 共有三个查询条件,是可以多选的,多选的时候用如果真很好.
    赋值 (过滤条件, 相加 (过滤条件, “姓名 = '”, .内容, “'”))
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果 (等于 (过滤条件, “”)) ' 如果过滤条件等于空的话,就表明没有选择按姓名,反之表明选择了按姓名
        赋值 (过滤条件, 相加 (过滤条件, “客户名称 = '”, .内容)) ' 因此这一行就不用加"and"
    .否则
        赋值 (过滤条件, 相加 (过滤条件, “ and ”, “客户名称 = '”, .内容, “'”)) ' 反之就要加"and"
    .如果结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果 (等于 (过滤条件, “”))
        赋值 (过滤条件, 相加 (过滤条件, “发货日期 > '”, .内容, “' and 发货日期 < '”, .内容, “'”))
    .否则
        赋值 (过滤条件, 相加 (过滤条件, “ and ”, “发货日期 > '”, .内容, “' and 发货日期 < '”, .内容, “'”))
    .如果结束
    
.如果真结束

复制窗口组件 (数据库连接_业绩提成查询)
复制窗口组件 (记录集_业绩提成查询)
数据库.开始查询 (数据库连接_业绩提成查询, 记录集_业绩提成查询, “sc.mdb”, , “业绩提成”, 2)
记录集_业绩提成查询.未知支持库函数_47 (过滤条件) ' 一般情况下用过滤记录命令,感觉比SQL语句还要简单方便.只是用完记得关闭过滤.
.如果真 (小于 (记录集_业绩提成查询., 1))
    信息框 (“没有查到任何信息!请检查你输入的查询条件确保无误后再次查询.”, 0, )
    数据库.断开 (数据库连接_业绩提成查询, 记录集_业绩提成查询)
    返回 ()
.如果真结束
赋值 (总计票数, 记录集_业绩提成查询.)
记录集_业绩提成查询.未知支持库函数_34 ()
.计次循环首 (总计票数, 计次)
    记录集_业绩提成查询.未知支持库函数_29 (“运费金额”, 临时_整数)
    赋值 (总计运费金额, 相加 (总计运费金额, 临时_整数))
    记录集_业绩提成查询.未知支持库函数_36 ()
.计次循环尾 ()
记录集_业绩提成查询.未知支持库函数_34 ()
.计次循环首 (总计票数, 计次)
    记录集_业绩提成查询.未知支持库函数_29 (“提成金额”, 临时_整数)
    赋值 (总计应提金额, 相加 (总计应提金额, 临时_整数))
    记录集_业绩提成查询.未知支持库函数_36 ()
.计次循环尾 ()
赋值 (.内容, 到文本 (总计票数))
赋值 (.内容, 到文本 (总计运费金额))
赋值 (.内容, 到文本 (总计应提金额))
记录集_业绩提成查询.未知支持库函数_47 (“”)
数据库.断开 (数据库连接_业绩提成查询, 记录集_业绩提成查询)


.子程序 _编辑框_业绩提成_提成金额_获得焦点, 空白型, , 
赋值 (.内容, 到文本 (相除 (相乘 (到数值 (.内容), 到数值 (.内容)), 100)))


.子程序 _按钮_客户投诉查询_查询_被单击, 空白型, , 
.局部变量 数据库连接_客户查询, 未知类型0x70001, , , 
.局部变量 记录集_客户查询, 未知类型0x70002, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_日期, 日期时间型, , , 
.局部变量 计次, 整数型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请输入客户名称!”, 0, )
    返回 ()
.如果真结束
复制窗口组件 (数据库连接_客户查询)
复制窗口组件 (记录集_客户查询)
数据库.开始查询 (数据库连接_客户查询, 记录集_客户查询, “ywzhxx.mdb”, , 相加 (“select * from 客户投诉 where 客户名称 like '%”, .内容, “%'”), 1)
.如果真 (小于 (记录集_客户查询., 1))
    信息框 (“没有查到任何信息!请检查输入的客户名称是否有效.”, 0, )
    数据库.断开 (数据库连接_客户查询, 记录集_客户查询)
    返回 ()
.如果真结束
记录集_客户查询.未知支持库函数_34 ()
赋值 (., 相加 (记录集_客户查询., 1))
.计次循环首 (记录集_客户查询., 计次)
    记录集_客户查询.未知支持库函数_26 (“客户名称”, 临时_文本)
    计次.未知支持库函数_9 (0, 1, 临时_文本)
    记录集_客户查询.未知支持库函数_26 (“投诉人”, 临时_文本)
    计次.未知支持库函数_9 (1, 1, 临时_文本)
    记录集_客户查询.未知支持库函数_31 (“投诉时间”, 临时_日期)
    计次.未知支持库函数_9 (2, 1, 到文本 (临时_日期))
    记录集_客户查询.未知支持库函数_26 (“联系电话”, 临时_文本)
    计次.未知支持库函数_9 (3, 1, 临时_文本)
    记录集_客户查询.未知支持库函数_26 (“投诉类别”, 临时_文本)
    计次.未知支持库函数_9 (4, 1, 临时_文本)
    记录集_客户查询.未知支持库函数_26 (“投诉内容”, 临时_文本)
    计次.未知支持库函数_9 (5, 1, 临时_文本)
    记录集_客户查询.未知支持库函数_26 (“投诉态度”, 临时_文本)
    计次.未知支持库函数_9 (6, 1, 临时_文本)
    记录集_客户查询.未知支持库函数_26 (“处理结果”, 临时_文本)
    计次.未知支持库函数_9 (7, 1, 临时_文本)
    记录集_客户查询.未知支持库函数_26 (“客户满意程度”, 临时_文本)
    计次.未知支持库函数_9 (8, 1, 临时_文本)
    记录集_客户查询.未知支持库函数_31 (“最后投诉日期”, 临时_日期)
    计次.未知支持库函数_9 (9, 1, 到文本 (临时_日期))
    记录集_客户查询.未知支持库函数_36 ()
    
.计次循环尾 ()
数据库.断开 (数据库连接_客户查询, 记录集_客户查询)


.子程序 _按钮_客户投诉查询_打印_被单击, 空白型, , 
未知支持库函数_27 ()


.窗口程序集 窗口程序集10, , , 

.程序集变量 查看回信_记录号, 整数型, , "0", 
.程序集变量 查看来信_记录号, 整数型, , "0", 
.程序集变量 数据库, 数据库, , , 
.子程序 _经理信箱窗口_创建完毕, 空白型, , 


.子程序 _经理信箱窗口_将被销毁, 空白型, , 
赋值 (经理信箱窗口., 假)
赋值 (主窗口., 假)
主窗口.获取焦点 ()

.子程序 _按钮_写信_发送信件_被单击, 空白型, , 
.局部变量 数据库连接_写信, 未知类型0x70001, , , 
.局部变量 记录集_写信, 未知类型0x70002, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“信件标题不能为空!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“发信时间不能为空!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“信件类别不能为空!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“信件内容不能为空!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束

复制窗口组件 (数据库连接_写信)
复制窗口组件 (记录集_写信)
数据库.开始查询 (数据库连接_写信, 记录集_写信, “jlxx.mdb”, , “发信记录”, 2)
记录集_写信.未知支持库函数_17 ()
记录集_写信.未知支持库函数_20 (“发信人”, .内容)
记录集_写信.未知支持库函数_20 (“收信人”, .内容)
记录集_写信.未知支持库函数_20 (“信件类别”, .内容)
记录集_写信.未知支持库函数_25 (“发信时间”, 到时间 (.内容))
记录集_写信.未知支持库函数_20 (“信件标题”, .内容)
记录集_写信.未知支持库函数_20 (“信件内容”, .内容)
记录集_写信.未知支持库函数_24 (“是否新信件”, 真)
.如果 (记录集_写信.未知支持库函数_18 ())
    信息框 (“信件已发出!请关注总经理回信.”, 0, )
.否则
    信息框 (“信件发送失败!”, 0, )
    
.如果结束
数据库.断开 (数据库连接_写信, 记录集_写信)


.子程序 _按钮_写信_查看回复_被单击, 空白型, , 
.局部变量 数据库连接_查看回信, 未知类型0x70001, , , 
.局部变量 记录集_查看回信, 未知类型0x70002, , , 
.局部变量 计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_日期, 日期时间型, , , 
.局部变量 临时_逻辑, 逻辑型, , , 


复制窗口组件 (数据库连接_查看回信)
复制窗口组件 (记录集_查看回信)
数据库.开始查询 (数据库连接_查看回信, 记录集_查看回信, “jlxx.mdb”, , “回信记录”, 2)
记录集_查看回信.未知支持库函数_47 (相加 (“收信人 = '”, 操作员, “' and 回信人 = '”, 回信人, “'”))
.如果真 (小于 (记录集_查看回信., 1))
    信息框 (“暂时没有回信!”, 0, )
    数据库.断开 (数据库连接_查看回信, 记录集_查看回信)
    返回 ()
.如果真结束

全部删除 ()
清除数组 (查看回信_记录号)
.计次循环首 (记录集_查看回信., 计次)
    记录集_查看回信.未知支持库函数_26 (“回信人”, 临时_文本)
    .插入表项 (临时_文本, , , , )
    记录集_查看回信.未知支持库函数_31 (“回信时间”, 临时_日期)
    相减 (计次, 1).置标题 (1, 到文本 (临时_日期))
    记录集_查看回信.未知支持库函数_26 (“信件标题”, 临时_文本)
    相减 (计次, 1).置标题 (2, 临时_文本)
    记录集_查看回信.未知支持库函数_30 (“是否新回信”, 临时_逻辑)
    相减 (计次, 1).置标题 (3, 到文本 (临时_逻辑))
    加入成员 (查看回信_记录号, 记录集_查看回信.)
    记录集_查看回信.未知支持库函数_36 ()
.计次循环尾 ()

数据库.断开 (数据库连接_查看回信, 记录集_查看回信)


.子程序 _按钮_写信_回信内容关闭_被单击, 空白型, , 
赋值 (.内容, “”)
赋值 (.可视, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
_按钮_写信_查看回复_被单击 ()

.子程序 _按钮_写信_删除回信_被单击, 空白型, , 
.局部变量 数据库连接_删除回信, 未知类型0x70001, , , 
.局部变量 记录集_删除回信, 未知类型0x70002, , , 
.局部变量 被选择记录号, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 

复制窗口组件 (数据库连接_删除回信)
复制窗口组件 (记录集_删除回信)
数据库.开始查询 (数据库连接_删除回信, 记录集_删除回信, “jlxx.mdb”, , “回信记录”, 2)
赋值 (被选择记录号, 查看回信_记录号 [相加 (., 1)])
记录集_删除回信.未知支持库函数_38 (被选择记录号)
记录集_删除回信.未知支持库函数_19 (1)
.如果 (记录集_删除回信.未知支持库函数_18 ())
    信息框 (“已成功删除该项回信!”, 0, )
.否则
    信息框 (“删除失败!”, 0, )
.如果结束
数据库.断开 (数据库连接_删除回信, 记录集_删除回信)
全部删除 ()
_按钮_写信_查看回复_被单击 ()

.子程序 _超级列表框_写信_回信列表_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 数据库连接_回信详细内容, 未知类型0x70001, , , 
.局部变量 记录集_回信详细内容, 未知类型0x70002, , , 
.局部变量 被选择记录号, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 

赋值 (.内容, “”)
赋值 (.可视, 真)
复制窗口组件 (数据库连接_回信详细内容)
复制窗口组件 (记录集_回信详细内容)
数据库.开始查询 (数据库连接_回信详细内容, 记录集_回信详细内容, “jlxx.mdb”, , “回信记录”, 2)
赋值 (被选择记录号, 查看回信_记录号 [相加 (., 1)])
记录集_回信详细内容.未知支持库函数_38 (被选择记录号)
记录集_回信详细内容.未知支持库函数_26 (“回信内容”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_回信详细内容.未知支持库函数_24 (“是否新回信”, 假)
记录集_回信详细内容.未知支持库函数_18 ()
数据库.断开 (数据库连接_回信详细内容, 记录集_回信详细内容)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)


.子程序 _按钮_回信_发送回信_被单击, 空白型, , 
.局部变量 数据库连接_回信, 未知类型0x70001, , , 
.局部变量 记录集_回信, 未知类型0x70002, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“信件标题不能为空!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“信件内容不能为空!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束


复制窗口组件 (数据库连接_回信)
复制窗口组件 (记录集_回信)
数据库.开始查询 (数据库连接_回信, 记录集_回信, “jlxx.mdb”, , “回信记录”, 2)
记录集_回信.未知支持库函数_17 ()
记录集_回信.未知支持库函数_20 (“收信人”, .内容)
记录集_回信.未知支持库函数_20 (“回信人”, .内容)
记录集_回信.未知支持库函数_25 (“回信时间”, 到时间 (.内容))
记录集_回信.未知支持库函数_20 (“信件标题”, .内容)
记录集_回信.未知支持库函数_20 (“回信内容”, .内容)
记录集_回信.未知支持库函数_24 (“是否新回信”, 真)
.如果 (记录集_回信.未知支持库函数_18 ())
    信息框 (“回信已发出!”, 0, )
.否则
    信息框 (“回信发送失败!”, 0, )
    
.如果结束
数据库.断开 (数据库连接_回信, 记录集_回信)


.子程序 _按钮_回信_查看来信_被单击, 空白型, , 
.局部变量 数据库连接_查看来信, 未知类型0x70001, , , 
.局部变量 记录集_查看来信, 未知类型0x70002, , , 
.局部变量 计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_日期, 日期时间型, , , 
.局部变量 临时_逻辑, 逻辑型, , , 

复制窗口组件 (数据库连接_查看来信)
复制窗口组件 (记录集_查看来信)
数据库.开始查询 (数据库连接_查看来信, 记录集_查看来信, “jlxx.mdb”, , “发信记录”, 2)
记录集_查看来信.未知支持库函数_47 (相加 (“收信人 = '”, 收信人, “'”))
.如果真 (小于 (记录集_查看来信., 1))
    信息框 (“暂时没有员工来信!”, 0, )
    数据库.断开 (数据库连接_查看来信, 记录集_查看来信)
    返回 ()
.如果真结束

全部删除 ()
清除数组 (查看来信_记录号)
.计次循环首 (记录集_查看来信., 计次)
    记录集_查看来信.未知支持库函数_26 (“发信人”, 临时_文本)
    .插入表项 (临时_文本, , , , )
    记录集_查看来信.未知支持库函数_31 (“发信时间”, 临时_日期)
    相减 (计次, 1).置标题 (1, 到文本 (临时_日期))
    记录集_查看来信.未知支持库函数_26 (“信件标题”, 临时_文本)
    相减 (计次, 1).置标题 (2, 临时_文本)
    记录集_查看来信.未知支持库函数_30 (“是否新信件”, 临时_逻辑)
    相减 (计次, 1).置标题 (3, 到文本 (临时_逻辑))
    加入成员 (查看来信_记录号, 记录集_查看来信.)
    记录集_查看来信.未知支持库函数_36 ()
.计次循环尾 ()

数据库.断开 (数据库连接_查看来信, 记录集_查看来信)


.子程序 _超级列表框_回信_来信列表_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 数据库连接_来信详细内容, 未知类型0x70001, , , 
.局部变量 记录集_来信详细内容, 未知类型0x70002, , , 
.局部变量 被选择记录号, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 

赋值 (.内容, “”)
赋值 (.可视, 真)
复制窗口组件 (数据库连接_来信详细内容)
复制窗口组件 (记录集_来信详细内容)
数据库.开始查询 (数据库连接_来信详细内容, 记录集_来信详细内容, “jlxx.mdb”, , “发信记录”, 2)
赋值 (被选择记录号, 查看来信_记录号 [相加 (., 1)])
记录集_来信详细内容.未知支持库函数_38 (被选择记录号)
记录集_来信详细内容.未知支持库函数_26 (“信件内容”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_来信详细内容.未知支持库函数_24 (“是否新信件”, 假)
记录集_来信详细内容.未知支持库函数_18 ()
数据库.断开 (数据库连接_来信详细内容, 记录集_来信详细内容)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)


.子程序 _按钮_回信_来信内容关闭_被单击, 空白型, , 
赋值 (.内容, “”)
赋值 (.可视, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
_按钮_回信_查看来信_被单击 ()

.子程序 _超级列表框_回信_来信列表_左键单击表项, 空白型, , 
赋值 (.内容, .取标题 (., 0))


.子程序 _按钮_回信_删除来信_被单击, 空白型, , 
.局部变量 数据库连接_删除来信, 未知类型0x70001, , , 
.局部变量 记录集_删除来信, 未知类型0x70002, , , 
.局部变量 被选择记录号, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 

复制窗口组件 (数据库连接_删除来信)
复制窗口组件 (记录集_删除来信)
数据库.开始查询 (数据库连接_删除来信, 记录集_删除来信, “jlxx.mdb”, , “发信记录”, 2)
赋值 (被选择记录号, 查看回信_记录号 [相加 (., 1)])
记录集_删除来信.未知支持库函数_38 (被选择记录号)
记录集_删除来信.未知支持库函数_19 (1)
.如果 (记录集_删除来信.未知支持库函数_18 ())
    信息框 (“已成功删除该项来信!”, 0, )
.否则
    信息框 (“删除失败!”, 0, )
.如果结束
数据库.断开 (数据库连接_删除来信, 记录集_删除来信)
全部删除 ()
_按钮_回信_查看来信_被单击 ()


.类模块 数据库, , , 

.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 开始查询, 逻辑型, 公开, 
.参数 数据库连接, 未知类型0x70001, 参考, 
.参数 记录集, 未知类型0x70002, 参考, 
.参数 数据库名, 文本型, , 
.参数 密码, 文本型, 可空, 
.参数 查询方式, 文本型, , 记录集的查询方式,SQL语句或表名
.参数 查询参数, 整数型, , 查询方式的参数,1为SQL语句,2为表名

记录集.未知支持库函数_12 (数据库连接)
.如果 (数据库连接.未知支持库函数_1 (相加 (取当前目录 (), “\data\”, 数据库名), “”))
    .如果 (记录集.未知支持库函数_14 (查询方式, 查询参数))
        到首记录 ()
        返回 (真)
    .否则
        信息框 (相加 (“查询失败!”, 取错误信息 ()), 0, )
        返回 (假)
    .如果结束
    
.否则
    信息框 (相加 (“数据库连接失败!”, 取错误信息 ()), 0, )
    返回 (假)
.如果结束


.子程序 断开, 空白型, 公开, 
.参数 数据库连接, 未知类型0x70001, , 
.参数 记录集, 未知类型0x70002, , 

记录集.未知支持库函数_16 ()
数据库连接.未知支持库函数_3 ()

.类模块 防止二次运行, , , 

.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 开始检查, 逻辑型, 公开, 
.局部变量 进程数组, 未知类型0x90009, , "0", 取进进程信息列表
.局部变量 计次, 整数型, , , 
.局部变量 运行次数, 整数型, , , 

赋值 (进程数组, 未知支持库函数_10 ())
.计次循环首 (取数组成员数 (进程数组), 计次)
    .如果真 (等于 (进程数组 [计次], , 取执行文件名 ())) ' 判断进程中有没有本程序在执行
        赋值 (运行次数, 相加 (运行次数, 1))
    .如果真结束
    
.计次循环尾 ()
.如果 (大于 (运行次数, 1))
    返回 (真)
.否则
    返回 (假)
.如果结束


.窗口程序集 窗口程序集11, , , 

.程序集变量 数据库, 数据库, , , 
.子程序 _按钮_电器设备_录入保存_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (“请输入设备名称!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
数据库.开始查询 (“rzhq.mdb”, , “电器设备”, 2)
相加 (“物品编号 = '”, .内容, “'”).未知支持库函数_47 ()
.如果真 (大于或等于 (., 1))
    信息框 (“该编号已经存在!不能重复使用.”, 0, )
    “”.未知支持库函数_47 ()
    数据库.断开 ()
    返回 ()
.如果真结束
“”.未知支持库函数_47 ()
未知支持库函数_17 ()
“物品编号”.未知支持库函数_20 (.内容)
“设备名称”.未知支持库函数_20 (.内容)
“型号”.未知支持库函数_20 (.内容)
“购置日期”.未知支持库函数_25 (到时间 (.内容))
“购置费用”.未知支持库函数_23 (到数值 (.内容))
“使用部门”.未知支持库函数_20 (.内容)
“责任人”.未知支持库函数_20 (.内容)
“备注”.未知支持库函数_20 (.内容)
.如果 (未知支持库函数_18 ())
    信息框 (“保存成功!”, 0, )
.否则
    信息框 (“保存失败!”, 0, )
.如果结束
“”.未知支持库函数_47 ()
数据库.断开 ()
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, 到文本 (取现行时间 ()))
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)


.子程序 _按钮_电器设备_物品编号_被单击, 空白型, , 
.局部变量 数据库连接_电器设备查询, 未知类型0x70001, , , 
.局部变量 记录集_电器设备查询, 未知类型0x70002, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 临时_日期, 日期时间型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请输入要查询的编号!”, 0, )
    获取焦点 ()
    返回 ()
.如果真结束
复制窗口组件 (数据库连接_电器设备查询)
复制窗口组件 (记录集_电器设备查询)
.如果真 (取反 (数据库连接_电器设备查询.未知支持库函数_1 (相加 (取当前目录 (), “\data\rzhq.mdb”), “”)))
    信息框 (“连接数据库失败!”, 0, )
    返回 ()
.如果真结束
记录集_电器设备查询.未知支持库函数_12 (数据库连接_电器设备查询)
.如果真 (取反 (记录集_电器设备查询.未知支持库函数_14 (“电器设备”, 2)))
    信息框 (“打开电器设备表失败!”, 0, )
    数据库连接_电器设备查询.未知支持库函数_3 ()
    返回 ()
.如果真结束
记录集_电器设备查询.未知支持库函数_47 (相加 (“物品编号 = '”, .内容, “'”))
.如果真 (小于 (记录集_电器设备查询., 1))
    信息框 (“没有找到指定的电器设备信息!”, 0, )
    记录集_电器设备查询.未知支持库函数_47 (“”)
    记录集_电器设备查询.未知支持库函数_16 ()
    数据库连接_电器设备查询.未知支持库函数_3 ()
    返回 ()
.如果真结束
记录集_电器设备查询.未知支持库函数_26 (“物品编号”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_电器设备查询.未知支持库函数_26 (“设备名称”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_电器设备查询.未知支持库函数_26 (“型号”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_电器设备查询.未知支持库函数_31 (“购置日期”, 临时_日期)
赋值 (.内容, 到文本 (临时_日期))
记录集_电器设备查询.未知支持库函数_29 (“购置费用”, 临时_整数)
赋值 (.内容, 到文本 (临时_整数))
记录集_电器设备查询.未知支持库函数_26 (“使用部门”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_电器设备查询.未知支持库函数_26 (“责任人”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_电器设备查询.未知支持库函数_26 (“备注”, 临时_文本)
赋值 (.内容, 临时_文本)
记录集_电器设备查询.未知支持库函数_47 (“”)
记录集_电器设备查询.未知支持库函数_16 ()
数据库连接_电器设备查询.未知支持库函数_3 ()


.子程序 _按钮_电器设备_被单击, 空白型, , 
.局部变量 数据库连接_电器设备导出, 未知类型0x70001, , , 
.局部变量 记录集_电器设备导出, 未知类型0x70002, , , 
.局部变量 字母, 文本型, , "0", 
.局部变量 行, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 行计次, 整数型, , , 
.局部变量 列计次, 整数型, , , 
.局部变量 临时_文本, 文本型, , , 
.局部变量 临时_整数, 整数型, , , 
.局部变量 临时_日期, 日期时间型, , , 

赋值 (.类型, 1)
赋值 (.标题, “请选择保存EXCEL文件的位置”)
赋值 (.文件名, 相加 (取当前目录 (), “\导出电子表格\后勤开支\”, “电器设备”, 到文本 (取现行时间 ())))
赋值 (.过滤器, “EXCEL电子表格文件|*.xls|所有文件|*.*”)
赋值 (.初始目录, 相加 (取当前目录 (), “\导出电子表格\后勤开支\”))
赋值 (.默认文件后缀, “.xls”)
复制窗口组件 (数据库连接_电器设备导出)
复制窗口组件 (记录集_电器设备导出)
.如果真 (取反 (数据库连接_电器设备导出.未知支持库函数_1 (相加 (取当前目录 (), “\data\rzhq.mdb”), “”)))
    信息框 (“数据库连接失败!”, 0, )
    未知支持库函数_15 ()
    未知支持库函数_3 ()
    返回 ()
    
.如果真结束
记录集_电器设备导出.未知支持库函数_12 (数据库连接_电器设备导出)

.如果 (打开 ())
    未知支持库函数_0 ()
    .未知支持库函数_6 ()
    赋值 (., 1)
    赋值 (., “电器设备”)
    .如果真 (取反 (记录集_电器设备导出.未知支持库函数_14 (“电器设备”, 2)))
        信息框 (“打开电器设备表失败!”, 0, )
        数据库连接_电器设备导出.未知支持库函数_3 ()
        未知支持库函数_15 ()
        未知支持库函数_3 ()
        返回 ()
    .如果真结束
    赋值 (., 1)
    赋值 (行, 记录集_电器设备导出.)
    赋值 (列, 8)
    清除数组 (字母)
    加入成员 (字母, “A”)
    加入成员 (字母, “B”)
    加入成员 (字母, “C”)
    加入成员 (字母, “D”)
    加入成员 (字母, “E”)
    加入成员 (字母, “F”)
    加入成员 (字母, “G”)
    加入成员 (字母, “H”)
    .计次循环首 (列, 列计次)
        赋值 (., 相加 (字母 [列计次], “1”))
        赋值 (., 相加 (字母 [列计次], “1”))
        赋值 (., 记录集_电器设备导出.未知支持库函数_39 (相减 (列计次, 1)))
    .计次循环尾 ()
    .计次循环首 (列, 列计次)
        记录集_电器设备导出.未知支持库函数_34 ()
        .计次循环首 (行, 行计次)
            赋值 (., 相加 (字母 [列计次], 到文本 (相加 (行计次, 1))))
            赋值 (., 相加 (字母 [列计次], 到文本 (相加 (行计次, 1))))
            .判断开始 (等于 (记录集_电器设备导出.未知支持库函数_43 (相减 (列计次, 1)), 202)) ' 判断字段是不是文本型
                记录集_电器设备导出.未知支持库函数_26 (记录集_电器设备导出.未知支持库函数_39 (相减 (列计次, 1)), 临时_文本)
                赋值 (., 临时_文本)
            .判断 (等于 (记录集_电器设备导出.未知支持库函数_43 (相减 (列计次, 1)), 203)) ' 判断字段是不是备注型
                记录集_电器设备导出.未知支持库函数_26 (记录集_电器设备导出.未知支持库函数_39 (相减 (列计次, 1)), 临时_文本)
                赋值 (., 临时_文本)
            .判断 (等于 (记录集_电器设备导出.未知支持库函数_43 (相减 (列计次, 1)), 3)) ' 判断字段是不是整型数值
                记录集_电器设备导出.未知支持库函数_29 (记录集_电器设备导出.未知支持库函数_39 (相减 (列计次, 1)), 临时_整数)
                赋值 (., 到文本 (临时_整数))
            .判断 (等于 (记录集_电器设备导出.未知支持库函数_43 (相减 (列计次, 1)), 7)) ' 判断字段是不是日期型
                记录集_电器设备导出.未知支持库函数_31 (记录集_电器设备导出.未知支持库函数_39 (相减 (列计次, 1)), 临时_日期)
                赋值 (., 到文本 (临时_日期))
            .默认
                
            .判断结束
            记录集_电器设备导出.未知支持库函数_36 ()
        .计次循环尾 ()
    .计次循环尾 ()
    记录集_电器设备导出.未知支持库函数_16 ()
    数据库连接_电器设备导出.未知支持库函数_3 ()
    .未知支持库函数_16 (.文件名)
    信息框 (“导出成功!”, 0, )
    未知支持库函数_15 ()
    未知支持库函数_3 ()
    
.否则
    信息框 (“用户取消!”, 0, )
    返回 ()
    
.如果结束


.窗口程序集 窗口程序集12, , , 

.子程序 _关于窗口_尺寸被改变, 空白型, , 
赋值 (.高度, 取用户区高度 ())
赋值 (.宽度, 取用户区宽度 ())
赋值 (.高度, 取用户区高度 ())
赋值 (.高度, 取用户区高度 ())
赋值 (.宽度, 相减 (取用户区宽度 (), .宽度, 3))
赋值 (., 相减 (.宽度, 5))
赋值 (., 相减 (.高度, 5))
赋值 (., 相加 (取当前目录 (), “\help\登陆说明.htm”))
相加 (取当前目录 (), “\help\登陆说明.htm”).未知支持库函数_1 ()


.子程序 _树型框_关于_菜单项_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 



.子程序 _树型框_关于_菜单项_双击项目, 空白型, , 
.判断开始 (等于 (.最大化按钮, 1))
    赋值 (., 相加 (取当前目录 (), “\help\操作员设置.htm”))
    相加 (取当前目录 (), “\help\操作员设置.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 2))
    赋值 (., 相加 (取当前目录 (), “\help\系统设置.htm”))
    相加 (取当前目录 (), “\help\系统设置.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 3))
    赋值 (., 相加 (取当前目录 (), “\help\数据库备份.htm”))
    相加 (取当前目录 (), “\help\数据库备份.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 4))
    赋值 (., 相加 (取当前目录 (), “\help\总经理查询.htm”))
    相加 (取当前目录 (), “\help\总经理查询.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 6))
    赋值 (., 相加 (取当前目录 (), “\help\业务单录入.htm”))
    相加 (取当前目录 (), “\help\业务单录入.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 7))
    赋值 (., 相加 (取当前目录 (), “\help\发货清单录入.htm”))
    相加 (取当前目录 (), “\help\发货清单录入.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 8))
    赋值 (., 相加 (取当前目录 (), “\help\签收录入.htm”))
    相加 (取当前目录 (), “\help\签收录入.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 9))
    赋值 (., 相加 (取当前目录 (), “\help\客户信息预设.htm”))
    相加 (取当前目录 (), “\help\客户信息预设.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 10))
    赋值 (., 相加 (取当前目录 (), “\help\外部合作公司.htm”))
    相加 (取当前目录 (), “\help\外部合作公司.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 11))
    赋值 (., 相加 (取当前目录 (), “\help\客户投诉.htm”))
    相加 (取当前目录 (), “\help\客户投诉.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 13))
    赋值 (., 相加 (取当前目录 (), “\help\业务单查询.htm”))
    相加 (取当前目录 (), “\help\业务单查询.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 14))
    赋值 (., 相加 (取当前目录 (), “\help\发货清单查询.htm”))
    相加 (取当前目录 (), “\help\发货清单查询.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 15))
    赋值 (., 相加 (取当前目录 (), “\help\客户信息查询.htm”))
    相加 (取当前目录 (), “\help\客户信息查询.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 17))
    赋值 (., 相加 (取当前目录 (), “\help\检货查询.htm”))
    相加 (取当前目录 (), “\help\检货查询.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 18))
    赋值 (., 相加 (取当前目录 (), “\help\检货异常信息录入.htm”))
    相加 (取当前目录 (), “\help\检货异常信息录入.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 20))
    赋值 (., 相加 (取当前目录 (), “\help\入库信息.htm”))
    相加 (取当前目录 (), “\help\入库信息.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 21))
    赋值 (., 相加 (取当前目录 (), “\help\出库信息.htm”))
    相加 (取当前目录 (), “\help\出库信息.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 22))
    赋值 (., 相加 (取当前目录 (), “\help\外地入埠货物管理.htm”))
    相加 (取当前目录 (), “\help\外地入埠货物管理.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 24))
    赋值 (., 相加 (取当前目录 (), “\help\车辆管理.htm”))
    相加 (取当前目录 (), “\help\车辆管理.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 25))
    赋值 (., 相加 (取当前目录 (), “\help\司机管理.htm”))
    相加 (取当前目录 (), “\help\司机管理.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 26))
    赋值 (., 相加 (取当前目录 (), “\help\车辆维修保养管理.htm”))
    相加 (取当前目录 (), “\help\车辆维修保养管理.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 27))
    赋值 (., 相加 (取当前目录 (), “\help\车辆加油管理.htm”))
    相加 (取当前目录 (), “\help\车辆加油管理.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 28))
    赋值 (., 相加 (取当前目录 (), “\help\车辆调度管理.htm”))
    相加 (取当前目录 (), “\help\车辆调度管理.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 30))
    赋值 (., 相加 (取当前目录 (), “\help\职员信息.htm”))
    相加 (取当前目录 (), “\help\职员信息.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 31))
    赋值 (., 相加 (取当前目录 (), “\help\工资表.htm”))
    相加 (取当前目录 (), “\help\工资表.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 32))
    赋值 (., 相加 (取当前目录 (), “\help\后勤支出.htm”))
    相加 (取当前目录 (), “\help\后勤支出.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 33))
    赋值 (., 相加 (取当前目录 (), “\help\电器设备.htm”))
    相加 (取当前目录 (), “\help\电器设备.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 35))
    赋值 (., 相加 (取当前目录 (), “\help\市场人员.htm”))
    相加 (取当前目录 (), “\help\市场人员.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 36))
    赋值 (., 相加 (取当前目录 (), “\help\客户拜访.htm”))
    相加 (取当前目录 (), “\help\客户拜访.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 37))
    赋值 (., 相加 (取当前目录 (), “\help\市场人员提成.htm”))
    相加 (取当前目录 (), “\help\市场人员提成.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 38))
    赋值 (., 相加 (取当前目录 (), “\help\客户投诉查询.htm”))
    相加 (取当前目录 (), “\help\客户投诉查询.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 40))
    赋值 (., 相加 (取当前目录 (), “\help\给总经理写信.htm”))
    相加 (取当前目录 (), “\help\给总经理写信.htm”).未知支持库函数_1 ()
.判断 (等于 (.最大化按钮, 41))
    赋值 (., 相加 (取当前目录 (), “\help\登陆说明.htm”))
    相加 (取当前目录 (), “\help\登陆说明.htm”).未知支持库函数_1 ()
.默认
    
.判断结束


.子程序 _关于窗口_创建完毕, 空白型, , 



 ' 不属于任何一个程序集、类模块的函数：
