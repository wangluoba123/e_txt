 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 322
    高度 = 235
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16746496 '  0xFF8800
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “易友网络校时专家 ver2.0客户端”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 344
    高度 = 218
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16746496 '  0xFF8800
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于”
    帮助文件名 = “”



.图片 托盘图标, " ' 已保存到：D:\易语言学习\Data\client101.e\托盘图标", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 2 系统核心支持库
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 1 0 数据操作支持库一





.窗口程序集 窗口程序集1, , , 

.子程序 _客户1_数据到达, 空白型, , 
.局部变量 时间, 日期时间型, , , 

赋值 (时间, 取字节集数据 (取回数据 (), #日期时间型))
置现行时间 (时间)

.子程序 __启动窗口_创建完毕, 空白型, , 
.如果真 (等于 (注册项是否存在 (1, “易友校时\client\pass”), 假))
    写注册项 (1, “易友校时\client\pass”, 未知支持库函数_3 (到字节集 (“123”), “liheng”, ))
.如果真结束
.如果真 (等于 (注册项是否存在 (1, “易友校时\client\ip”), 假))
    写注册项 (1, “易友校时\client\ip”, “192.168.0.1”)
.如果真结束
.如果真 (等于 (注册项是否存在 (1, “易友校时\client\port”), 假))
    写注册项 (1, “易友校时\client\port”, “19730”)
.如果真结束
.如果真 (等于 (注册项是否存在 (4, “SOFTWARE\Microsoft\Windows\CurrentVersion\Run\time_c”), 真))
    赋值 (.选中, 真)
.如果真结束
赋值 (.内容, 取文本注册项 (1, “易友校时\client\ip”, ))
赋值 (.内容, 取文本注册项 (1, “易友校时\client\port”, ))
_连接按钮_被单击 ()

.子程序 _连接按钮_被单击, 空白型, , 
赋值 (.内容, 删全部空 (.内容))
.如果 (等于 (.连接 (.内容, 到数值 (.内容)), 假))
    赋值 (.标题, “重试(&L)”)
    赋值 (_启动窗口.可视, 真)
    获取焦点 ()
    信息框 (“连接失败。请确认服务端正常运行、网络连接正常、防火墙配置正确、服务器IP和端口设置正确。”, 32, “提示...”)
.否则
    赋值 (.禁止, 真)
    写注册项 (1, “易友校时\client\ip”, .内容)
    写注册项 (1, “易友校时\client\port”, .内容)
    赋值 (_启动窗口.可视, 假)
    _启动窗口.置托盘图标 (#托盘图标, “易友网络校时client1.0”)
.如果结束


.子程序 __启动窗口_托盘事件, 空白型, , 
.参数 操作类型, 整数型, , 

.如果 (或者 (等于 (操作类型, 1), 等于 (操作类型, 3)))
    _启动窗口.弹出托盘菜单 ()
.否则
    .如果真 (等于 (操作类型, 2))
        _设置_被选择 ()
    .如果真结束
    
.如果结束


.子程序 _设置_被选择, 空白型, , 
.局部变量 输入密码, 文本型, , , 
.局部变量 密码, 文本型, , , 

.如果真 (等于 (输入框 (“请输入设置密码：”, “提示”, , 输入密码, 4), 真))
    赋值 (密码, 取字节集数据 (未知支持库函数_4 (取字节集注册项 (1, “易友校时\client\pass”, ), “liheng”, ), 10))
    .如果真 (不等于 (输入密码, 密码))
        信息框 (“密码错误。”, 32, “提示...”)
        返回 ()
    .如果真结束
    赋值 (_启动窗口.可视, 真)
    _启动窗口.置托盘图标 ()
    断开连接 ()
    赋值 (.禁止, 假)
.如果真结束


.子程序 _退出_被选择, 空白型, , 
.局部变量 输入密码, 文本型, , , 
.局部变量 密码, 文本型, , , 

.如果真 (等于 (输入框 (“请输退出密码：”, “提示”, , 输入密码, 4), 真))
    赋值 (密码, 取字节集数据 (未知支持库函数_4 (取字节集注册项 (1, “易友校时\client\pass”, ), “liheng”, ), 10))
    .如果真 (不等于 (输入密码, 密码))
        信息框 (“密码错误。”, 32, “提示...”)
        返回 ()
    .如果真结束
    结束 ()
.如果真结束


.子程序 _修改按钮_被单击, 空白型, , 
.局部变量 新密码, 字节集, , , 

.如果真 (不等于 (取字节集数据 (未知支持库函数_4 (取字节集注册项 (1, “易友校时\client\pass”, ), “liheng”, ), 10), .内容))
    信息框 (“当前密码不正确。”, 32, “提示...”)
    赋值 (.内容, “”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (不等于 (.内容, .内容))
    信息框 (“新密码与效验密码不一致，请重新输入。”, 32, “提示...”)
    赋值 (.内容, “”)
    获取焦点 ()
    赋值 (.内容, “”)
    返回 ()
.如果真结束
写注册项 (1, “易友校时\client\pass”, 未知支持库函数_3 (到字节集 (删全部空 (.内容)), “liheng”, ))
信息框 (“密码修改成功！”, 64, “提示...”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)

.子程序 _IP编辑框_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)

.子程序 _端口编辑框_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)

.子程序 _当前密码编辑框_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)

.子程序 _新密码编辑框_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)

.子程序 _效验密码编辑框_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)

.子程序 _关于_被选择, 空白型, , 
载入 (关于窗口, , 真)

.子程序 _启动选择框_被单击, 空白型, , 
 ' 这里使用选择框，而server使用的是菜单。实际目的一样，但方法不一样，方便初学者学习。
.如果 (等于 (.选中, 真))
    写注册项 (4, “SOFTWARE\Microsoft\Windows\CurrentVersion\Run\time_c”, 相加 (取当前目录 (), “\client.exe”))
.否则
    删除注册项 (4, “SOFTWARE\Microsoft\Windows\CurrentVersion\Run\time_c”)
.如果结束


.窗口程序集 窗口程序集2, , , 

.子程序 _确认按钮_被单击, 空白型, , 
销毁 ()

.子程序 _确定图形按钮_被单击, 空白型, , 
_确认按钮_被单击 ()


 ' 不属于任何一个程序集、类模块的函数：
