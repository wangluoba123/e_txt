 ' 文件类型：Windows窗口程序

 ' 程序名称：文件时间操作模块1.0
 ' 程序描述：可以取出或设置文件时间，包括创建时间、修改时间和访问时间。
作者：西风
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 316
    高度 = 405
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “星语 文件属性修改查看加密器 ”
    帮助文件名 = “”



.常量 读文件, "1073741824", , GENERIC_WRITE
.常量 共亨读, "1", , FILE_SHARE_READ
.常量 共亨写, "2", , FILE_SHARE_WRITE
.常量 打开已有文件, "3", , OPEN_EXISTING
.常量 , , , 
.常量 MD5常量_链接常量A, "1732584193", , 0x67452301
.常量 MD5常量_链接常量B, "4023233417", , 0xEFCDAB89
.常量 MD5常量_链接常量C, "2562383102", , 0x98BADCFE
.常量 MD5常量_链接常量D, "271733878", , 0x10325476
.常量 , , , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库




数据类型 文件时间, , 
    .成员 Low, 整数型, , , 
    .成员 Hight, 整数型, , , 

数据类型 系统时间, , 
    .成员 年, 短整数型, , , 
    .成员 月, 短整数型, , , 
    .成员 星期, 短整数型, , , 
    .成员 日, 短整数型, , , 
    .成员 小时, 短整数型, , , 
    .成员 分钟, 短整数型, , , 
    .成员 秒, 短整数型, , , 
    .成员 毫秒, 短整数型, , , 

数据类型 MD5循环左移参数, , 
    .成员 左移位数, 整数型, , , 
    .成员 右移位数, 整数型, , , 
    .成员 位与值, 整数型, , , 


.DLL命令 取出指定文件时间, 整数型, "kernel32", "GetFileTime", , 非0表示成功
    .参数 文件号, 整数型, , 
    .参数 创建时间, 文件时间, , UTC格式的文件时间，下同
    .参数 访问时间, 文件时间, , 
    .参数 修改时间, 文件时间, , 

.DLL命令 打开或创建文件, 整数型, "kernel32", "CreateFileA", , 返回文件号，非0表示成功
    .参数 文件名, 文本型, , 
    .参数 打开方式, 整数型, , 
    .参数 共亨方式, 整数型, , 
    .参数 安全特性, 整数型, , 0
    .参数 创建还是打开, 整数型, , 
    .参数 文件属性, 整数型, , 0
    .参数 指定句柄, 整数型, , 0

.DLL命令 关闭文件对象, 整数型, "", "CloseHandle", , 非0表示成功
    .参数 文件名柄, 整数型, , 

.DLL命令 本地时间转换为系统时间, 整数型, "kernel32", "FileTimeToSystemTime", , 把本地格式的文件时间转换为系统时间，非0表示成功
    .参数 文件时间, 文件时间, , 本地格式的文件时间
    .参数 系统时间, 系统时间, , 

.DLL命令 文件时间转换为本地时间, 整数型, "kernel32", "FileTimeToLocalFileTime", , 把UTC格式的文件时间转换为本地格式的文件时间，非0表示成功
    .参数 文件时间, 文件时间, , UTC格式的文件时间
    .参数 本地时间, 文件时间, , 本地格式的文件时间

.DLL命令 系统时间转换为本地时间, 整数型, "kernel32", "SystemTimeToFileTime", , 把系统时间转换为本地格式的文件时间，非0表示成功
    .参数 系统时间, 系统时间, , 
    .参数 文件时间, 文件时间, , 本地格式的文件时间

.DLL命令 设置指定文件时间, 整数型, "kernel32", "SetFileTime", , 非0表示成功。
    .参数 文件号, 整数型, , 
    .参数 创建时间, 文件时间, , 本地格式的文件时间，下同
    .参数 访问时间, 文件时间, , 
    .参数 修改时间, 文件时间, , 

.DLL命令 本地时间转换为文件时间, 整数型, "kernel32", "LocalFileTimeToFileTime", , 把本地格式的文件时间转换为UTC格式的文件时间，非0表示成功
    .参数 本地时间, 文件时间, , 本地格式的文件时间
    .参数 文件时间, 文件时间, , UTC格式的文件时间

.窗口程序集 窗口程序集1, , , 

.程序集变量 文件号, 整数型, , , 
.子程序 __启动窗口_将被销毁, 空白型, , 
未知函数_67174526 (文件号)

.子程序 _浏览_被单击, 空白型, , 
.如果真 (打开 ())
    赋值 (., .)
    判断文件大小 (.)
.如果真结束
.如果真 (不等于 (文件号, 0))
    未知函数_67174526 (文件号)
.如果真结束
赋值 (文件号, 未知函数_67174519 (.))
.如果真 (等于 (文件号, 0))
    信息框 (相加 (“打开文件”, ., “失败，请确定文件存在且未被使用。”), #信息图标, “错误”)
    返回 ()
.如果真结束
_取出时间_被单击 ()
_查看MD5_被单击 ()

.子程序 _取出时间_被单击, 空白型, , 
.局部变量 创建时间, 日期时间型, , , 
.局部变量 访问时间, 日期时间型, , , 
.局部变量 修改时间, 日期时间型, , , 

.如果 (不等于 (未知函数_67174441 (文件号, 创建时间, 修改时间, 访问时间), 0))
    赋值 (., 到文本 (创建时间))
    赋值 (., 到文本 (访问时间))
    赋值 (., 到文本 (修改时间))
.否则
    信息框 (“读取文件信息失败！”, #错误图标, “错误”)
.如果结束
文件属性判断 ()

.子程序 _设置时间_被单击, 空白型, , 
.局部变量 创建时间, 日期时间型, , , 
.局部变量 访问时间, 日期时间型, , , 
.局部变量 修改时间, 日期时间型, , , 

赋值 (创建时间, 到时间 (.))
赋值 (修改时间, 到时间 (.))
赋值 (访问时间, 到时间 (.))
.如果真 (等于 (未知函数_67174555 (文件号, 创建时间, 修改时间, 访问时间), 0))
    信息框 (“设置文件时间失败！”, #错误图标, “错误”)
.如果真结束


.子程序 _系统时间_被单击, 空白型, , 
赋值 (., 到文本 (取现行时间 ()))
赋值 (., 到文本 (取现行时间 ()))
赋值 (., 到文本 (取现行时间 ()))

.子程序 _修改属性_被单击, 空白型, , 
.局部变量 a, 整数型, , , 
.局部变量 d, 整数型, , , 
.局部变量 c, 整数型, , , 
.局部变量 b, 整数型, , , 
.局部变量 e, 整数型, , , 

.如果真 (等于 (., 真))
    赋值 (a, 到整数 (.))
.如果真结束
.如果真 (等于 (., 真))
    赋值 (b, 到整数 (.))
.如果真结束
.如果真 (等于 (., 真))
    赋值 (c, 到整数 (.))
.如果真结束
.如果真 (等于 (., 真))
    赋值 (d, 到整数 (.))
.如果真结束
赋值 (e, 相加 (a, b, c, d))
置文件属性 (., e)
 ' 1、#只读文件； 2、#隐藏文件； 4、#系统文件； 32、#存档文件
文件属性判断 ()

.子程序 文件属性判断, 空白型, , 
.局部变量 属性, 整数型, , , 

赋值 (属性, 取文件属性 (.))
赋值 (., 假)
赋值 (., 假)
赋值 (., 假)
赋值 (., 假)
.如果真 (等于 (属性, 1))
    赋值 (., 真)
.如果真结束
.如果真 (等于 (属性, 2))
    赋值 (., 真)
.如果真结束
.如果真 (等于 (属性, 4))
    赋值 (., 真)
.如果真结束
.如果真 (等于 (属性, 32))
    赋值 (., 真)
.如果真结束
.如果真 (等于 (属性, 3))
    赋值 (., 真)
    赋值 (., 真)
.如果真结束
.如果真 (等于 (属性, 5))
    赋值 (., 真)
    赋值 (., 真)
.如果真结束
.如果真 (等于 (属性, 6))
    赋值 (., 真)
    赋值 (., 真)
.如果真结束
.如果真 (等于 (属性, 7))
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., 真)
.如果真结束
.如果真 (等于 (属性, 33))
    赋值 (., 真)
    赋值 (., 真)
.如果真结束
.如果真 (等于 (属性, 34))
    赋值 (., 真)
    赋值 (., 真)
.如果真结束
.如果真 (等于 (属性, 35))
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., 真)
.如果真结束
.如果真 (等于 (属性, 36))
    赋值 (., 真)
    赋值 (., 真)
.如果真结束
.如果真 (等于 (属性, 37))
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., 真)
.如果真结束
.如果真 (等于 (属性, 38))
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., 真)
.如果真结束
.如果真 (等于 (属性, 39))
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., 真)
.如果真结束
输出调试文本 (属性)


.子程序 _未加密到密文_被单击, 空白型, , 
赋值 (., 读入密文数据 (.))

.子程序 _已加密到文本_被单击, 空白型, , 
赋值 (., 读出密文数据 (.))

.子程序 十六进制至字节集, 字节集, , 
.参数 原文, 字节集, , 

.局部变量 长度, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 结果, 字节集, , , 
.局部变量 j, 空白型, , , 
.局部变量 新码表, 字节型, , "70,70", 
.局部变量 码表, 字节集, , , 

赋值 (长度, 取字节集长度 (原文))
.如果真 (小于 (长度, 1))
    返回 ({  })
.如果真结束
赋值 (码表, 到字节集 (“0123456789ABCDEF”))
.变量循环首 (0, 15, 1, i)
    .变量循环首 (0, 15, 1, j)
        赋值 (新码表 [码表] [相加 (i, 1)] [码表] [相加 (j, 1)], 相加 (左移 (i, 4), j))
    .变量循环尾 ()
.变量循环尾 ()
赋值 (结果, 取空白字节集 (相除 (长度, 2)))
赋值 (j, 1)
.变量循环首 (1, 相减 (长度, 1), 2, i)
    赋值 (结果 [j], 新码表 [原文] [i] [原文] [相加 (i, 1)])
    赋值 (j, 相加 (j, 1))
.变量循环尾 ()
返回 (结果)


.子程序 读入密文数据, 文本型, , 
.参数 instr, 文本型, , 

.局部变量 key, 文本型, , , 
.局部变量 临时, 字节集, , , 
.局部变量 s, 字节型, , "256", 
.局部变量 k, 字节型, , "256", 
.局部变量 i, 空白型, , , 
.局部变量 j, 空白型, , , 
.局部变量 y, 空白型, , , 
.局部变量 outstr, 文本型, , , 
.局部变量 temp, 字节型, , , 
.局部变量 x, 整数型, , , 
.局部变量 t, 整数型, , , 
.局部变量 aaa, 文本型, , , 

赋值 (key, .)
赋值 (临时, 到字节集 (instr))
.计次循环首 (256, i)
    赋值 (s [i], 相减 (i, 1))
.计次循环尾 ()
赋值 (j, 1)
.计次循环首 (256, i)
    .如果真 (大于 (j, 取文本长度 (key)))
        赋值 (j, 1)
    .如果真结束
    赋值 (k [i], 取代码 (取文本中间 (key, j, 1), ))
    赋值 (j, 相加 (j, 1))
.计次循环尾 ()
赋值 (j, 0)
.计次循环首 (256, i)
    赋值 (j, 求余数 (相加 (j, s [i], k [i]), 256))
    赋值 (temp, s [i])
    赋值 (s [i], s [相加 (j, 1)])
    赋值 (s [相加 (j, 1)], temp)
.计次循环尾 ()
赋值 (i, 0)
赋值 (j, 0)
.计次循环首 (取字节集长度 (临时), x)
    赋值 (i, 求余数 (相加 (i, 1), 256))
    赋值 (j, 求余数 (相加 (j, s [相加 (i, 1)]), 256))
    赋值 (temp, s [相加 (i, 1)])
    赋值 (s [相加 (i, 1)], s [相加 (j, 1)])
    赋值 (s [相加 (j, 1)], temp)
    赋值 (t, 相加 (求余数 (相加 (s [相加 (i, 1)], s [相加 (j, 1)]), 256), 1))
    赋值 (y, s [t])
    赋值 (aaa, 取文本右边 (相加 (“00”, 取十六进制文本 (位异或 (临时 [x], y))), 2))
    赋值 (outstr, 相加 (outstr, aaa))
.计次循环尾 ()
返回 (outstr)

.子程序 读出密文数据, 文本型, , 
.参数 instr, 文本型, , 

.局部变量 key, 文本型, , , 
.局部变量 临时, 字节集, , , 
.局部变量 s, 字节型, , "256", 
.局部变量 k, 字节型, , "256", 
.局部变量 i, 空白型, , , 
.局部变量 j, 空白型, , , 
.局部变量 y, 空白型, , , 
.局部变量 outstr, 字节型, , "0", 
.局部变量 temp, 字节型, , , 
.局部变量 x, 整数型, , , 
.局部变量 t, 整数型, , , 

赋值 (key, .)
赋值 (临时, 十六进制至字节集 (到字节集 (instr)))
.计次循环首 (256, i)
    赋值 (s [i], 相减 (i, 1))
.计次循环尾 ()
赋值 (j, 1)
.计次循环首 (256, i)
    赋值 (k [i], 取代码 (取文本中间 (key, j, 1), ))
    赋值 (j, 相加 (j, 1))
    .如果真 (大于 (j, 取文本长度 (key)))
        赋值 (j, 1)
    .如果真结束
    
.计次循环尾 ()
赋值 (j, 0)
.计次循环首 (256, i)
    赋值 (j, 求余数 (相加 (j, s [i], k [i]), 256))
    赋值 (temp, s [i])
    赋值 (s [i], s [相加 (j, 1)])
    赋值 (s [相加 (j, 1)], temp)
.计次循环尾 ()
赋值 (i, 0)
赋值 (j, 0)
.计次循环首 (取字节集长度 (临时), x)
    赋值 (i, 求余数 (相加 (i, 1), 256))
    赋值 (j, 求余数 (相加 (j, s [相加 (i, 1)]), 256))
    赋值 (temp, s [相加 (i, 1)])
    赋值 (s [相加 (i, 1)], s [相加 (j, 1)])
    赋值 (s [相加 (j, 1)], temp)
    赋值 (t, 相加 (求余数 (相加 (s [相加 (i, 1)], s [相加 (j, 1)]), 256), 1))
    赋值 (y, s [t])
    加入成员 (outstr, 位异或 (临时 [x], y))
.计次循环尾 ()
返回 (到文本 (到字节集 (outstr)))

.子程序 _未加密复制_被单击, 空白型, , 
置剪辑板文本 (.)

.子程序 _已加密复制_被单击, 空白型, , 
置剪辑板文本 (.)

.子程序 _未加密粘贴_被单击, 空白型, , 
赋值 (., 取剪辑板文本 ())

.子程序 _已加密粘贴_被单击, 空白型, , 
赋值 (., 取剪辑板文本 ())

.子程序 判断文件大小, 空白型, , 
.参数 文件名, 文本型, , 

赋值 (., 到文本 (取字节集长度 (读入文件 (文件名))))

.子程序 _文件大小检查按钮2_被单击, 空白型, , 
置剪辑板文本 (.)

.子程序 _查看MD5_被单击, 空白型, , 
赋值 (., 未知函数_67174866 (读入文件 (.)))
置剪辑板文本 (未知函数_67174866 (读入文件 (.)))

.子程序 __启动窗口_创建完毕, 空白型, , 


.子程序 打开指定文件, 整数型, , 返回文件句柄，非0表示成功
.参数 文件名, 文本型, , 

返回 ()

.子程序 关闭指定文件, 整数型, , 非0表示成功
.参数 文件句柄, 整数型, , “打开指定文件”所返回的文件句柄

返回 (未知函数_167838280 (文件句柄))

.子程序 取出文件时间, 整数型, , 非0表示成功
.参数 文件句柄, 整数型, , “打开指定文件”所返回的文件句柄
.参数 创建时间, 日期时间型, 参考 可空, 参数为空，则不取出该时间，下同。
.参数 修改时间, 日期时间型, 参考 可空, 
.参数 访问时间, 日期时间型, 参考 可空, 

.局部变量 文件创建, 未知类型0x41010249, , , 
.局部变量 文件访问, 未知类型0x41010249, , , 
.局部变量 文件修改, 未知类型0x41010249, , , 
.局部变量 本地创建, 未知类型0x41010249, , , 
.局部变量 本地访问, 未知类型0x41010249, , , 
.局部变量 本地修改, 未知类型0x41010249, , , 
.局部变量 系统创建, 未知类型0x4101024A, , , 
.局部变量 系统访问, 未知类型0x4101024A, , , 
.局部变量 系统修改, 未知类型0x4101024A, , , 
.局部变量 返回值, 整数型, , , 

赋值 (返回值, 未知函数_167838285 (文件句柄, 文件创建, 文件访问, 文件修改))
.如果 (不等于 (返回值, 0))
    .如果真 (等于 (是否为空 (创建时间), 假))
        .如果真 (等于 (未知函数_167838283 (文件创建, 本地创建), 0))
            返回 (0)
        .如果真结束
        .如果真 (等于 (未知函数_167838284 (本地创建, 系统创建), 0))
            返回 (0)
        .如果真结束
        赋值 (创建时间, 指定时间 (系统创建., 系统创建., 系统创建., 系统创建., 系统创建., 系统创建.))
    .如果真结束
    .如果真 (等于 (是否为空 (访问时间), 假))
        .如果真 (等于 (未知函数_167838283 (文件访问, 本地访问), 0))
            返回 (0)
        .如果真结束
        .如果真 (等于 (未知函数_167838284 (本地访问, 系统访问), 0))
            返回 (0)
        .如果真结束
        赋值 (访问时间, 指定时间 (系统访问., 系统访问., 系统访问., 系统访问., 系统访问., 系统访问.))
    .如果真结束
    .如果真 (等于 (是否为空 (修改时间), 假))
        .如果真 (等于 (未知函数_167838283 (文件修改, 本地修改), 0))
            返回 (0)
        .如果真结束
        .如果真 (等于 (未知函数_167838284 (本地修改, 系统修改), 0))
            返回 (0)
        .如果真结束
        赋值 (修改时间, 指定时间 (系统修改., 系统修改., 系统修改., 系统修改., 系统修改., 系统修改.))
    .如果真结束
    返回 (返回值)
.否则
    返回 (0)
.如果结束


.子程序 设置文件时间, 整数型, , 非0表示成功
.参数 文件句柄, 整数型, , “打开指定文件”所返回的文件句柄
.参数 创建时间, 日期时间型, 可空, 参数为空，则不改变该时间，下同。
.参数 修改时间, 日期时间型, 可空, 
.参数 访问时间, 日期时间型, 可空, 

.局部变量 文件创建, 未知类型0x41010249, , , 
.局部变量 文件访问, 未知类型0x41010249, , , 
.局部变量 文件修改, 未知类型0x41010249, , , 
.局部变量 本地创建, 未知类型0x41010249, , , 
.局部变量 本地访问, 未知类型0x41010249, , , 
.局部变量 本地修改, 未知类型0x41010249, , , 
.局部变量 系统创建, 未知类型0x4101024A, , , 
.局部变量 系统访问, 未知类型0x4101024A, , , 
.局部变量 系统修改, 未知类型0x4101024A, , , 

.如果真 (等于 (是否为空 (创建时间), 假))
    赋值 (系统创建., 取时间部分 (创建时间, #年份))
    赋值 (系统创建., 取时间部分 (创建时间, #月份))
    赋值 (系统创建., 取时间部分 (创建时间, #日))
    赋值 (系统创建., 取时间部分 (创建时间, #小时))
    赋值 (系统创建., 取时间部分 (创建时间, #分钟))
    赋值 (系统创建., 取时间部分 (创建时间, #秒))
    未知函数_167838292 (系统创建, 本地创建)
    未知函数_167838293 (本地创建, 文件创建)
.如果真结束
.如果真 (等于 (是否为空 (修改时间), 假))
    赋值 (系统修改., 取时间部分 (修改时间, #年份))
    赋值 (系统修改., 取时间部分 (修改时间, #月份))
    赋值 (系统修改., 取时间部分 (修改时间, #日))
    赋值 (系统修改., 取时间部分 (修改时间, #小时))
    赋值 (系统修改., 取时间部分 (修改时间, #分钟))
    赋值 (系统修改., 取时间部分 (修改时间, #秒))
    未知函数_167838292 (系统修改, 本地修改)
    未知函数_167838293 (本地修改, 文件修改)
.如果真结束
.如果真 (等于 (是否为空 (访问时间), 假))
    赋值 (系统访问., 取时间部分 (访问时间, #年份))
    赋值 (系统访问., 取时间部分 (访问时间, #月份))
    赋值 (系统访问., 取时间部分 (访问时间, #日))
    赋值 (系统访问., 取时间部分 (访问时间, #小时))
    赋值 (系统访问., 取时间部分 (访问时间, #分钟))
    赋值 (系统访问., 取时间部分 (访问时间, #秒))
    未知函数_167838292 (系统访问, 本地访问)
    未知函数_167838293 (本地访问, 文件访问)
.如果真结束
返回 (未知函数_167838294 (文件句柄, 文件创建, 文件访问, 文件修改))

.子程序 MD5演示函数_取高16位, 整数型, , 
.参数 参数, 整数型, , 

返回 (右移 (参数, 16))

.子程序 MD5演示函数_取低16位, 整数型, , 
.参数 参数, 整数型, , 

返回 (位与 (参数, 65535))

.子程序 MD5演示函数_正整数加法, 整数型, , 
.参数 参数X, 整数型, , 
.参数 参数Y, 整数型, , 

.局部变量 返回值, 整数型, , , 
.局部变量 低位值, 整数型, , , 
.局部变量 高位值, 整数型, , , 

 ' 易语言中没有正整数型，所以加法只能用这种形式代替
赋值 (高位值, 相加 (位与 (MD5演示函数_取高16位 (参数X), 65535), 位与 (MD5演示函数_取高16位 (参数Y), 65535)))
赋值 (低位值, 相加 (位与 (MD5演示函数_取低16位 (参数X), 65535), 位与 (MD5演示函数_取低16位 (参数Y), 65535)))
赋值 (返回值, 合并整数 (低位值, 相加 (高位值, 右移 (低位值, 16))))
返回 (返回值)

.子程序 MD5演示函数_循环左移, 整数型, , 
.参数 欲移位数, 整数型, , 
.参数 位数, 整数型, , 

 ' MD5中的左移是循环左移
返回 (位或 (左移 (欲移位数, 位数), 位与 (右移 (欲移位数, 相减 (32, 位数)), 相减 (求次方 (2, 位数), 1))))

.子程序 MD5演示函数_取输出文本, 文本型, , 
.参数 数值, 整数型, , 

 ' 因为易语言中整数的位形式与C中有所不同,整数在输出为文本前需要进行调整
返回 (相加 (MD5演示函数_取十六进制文本 (位与 (数值, 255)), MD5演示函数_取十六进制文本 (位与 (右移 (位与 (数值, 65280), 8), 255)), MD5演示函数_取十六进制文本 (位与 (右移 (位与 (数值, 16711680), 16), 255)), MD5演示函数_取十六进制文本 (位与 (右移 (位与 (数值, 4278190080), 24), 255))))

.子程序 MD5演示函数_取十六进制文本, 文本型, , 
.参数 数值, 整数型, , 

 ' 取出十六进制文本，用易语言的函数会丢掉0，所以重新做了一个
 ' 论坛上monktiger少0的原因可能类似，只有亲自做过才知道啊
返回 (相加 (多项选择 (相加 (右移 (数值, 4), 1), “0”, “1”, “2”, “3”, “4”, “5”, “6”, “7”, “8”, “9”, “A”, “B”, “C”, “D”, “E”, “F”), 多项选择 (相加 (位与 (数值, 15), 1), “0”, “1”, “2”, “3”, “4”, “5”, “6”, “7”, “8”, “9”, “A”, “B”, “C”, “D”, “E”, “F”)))

.子程序 MD5演示函数_F, 整数型, , 
.参数 参数X, 整数型, , 
.参数 参数Y, 整数型, , 
.参数 参数Z, 整数型, , 

返回 (位或 (位与 (参数X, 参数Y), 位与 (位取反 (参数X), 参数Z))) ' (X&Y)|((~X)&Z)

.子程序 MD5演示函数_G, 整数型, , 
.参数 参数X, 整数型, , 
.参数 参数Y, 整数型, , 
.参数 参数Z, 整数型, , 

返回 (位或 (位与 (参数X, 参数Z), 位与 (参数Y, 位取反 (参数Z)))) ' (X&Z)|(Y&(~Z))

.子程序 MD5演示函数_H, 整数型, , 
.参数 参数X, 整数型, , 
.参数 参数Y, 整数型, , 
.参数 参数Z, 整数型, , 

返回 (位异或 (参数X, 参数Y, 参数Z)) ' X^Y^Z

.子程序 MD5演示函数_I, 整数型, , 
.参数 参数X, 整数型, , 
.参数 参数Y, 整数型, , 
.参数 参数Z, 整数型, , 

返回 (位异或 (参数Y, 位或 (参数X, 位取反 (参数Z)))) ' Y^(X|(~Z))

.子程序 MD5演示函数_FF, 空白型, , 
.参数 参数A, 整数型, 参考, 
.参数 参数B, 整数型, , 
.参数 参数C, 整数型, , 
.参数 参数D, 整数型, , 
.参数 信息, 整数型, , 
.参数 移位数, 整数型, , 
.参数 轮参数, 整数型, , 

赋值 (参数A, MD5演示函数_正整数加法 (参数A, MD5演示函数_正整数加法 (MD5演示函数_正整数加法 (MD5演示函数_F (参数B, 参数C, 参数D), 信息), 轮参数)))
赋值 (参数A, MD5演示函数_循环左移 (参数A, 移位数))
赋值 (参数A, MD5演示函数_正整数加法 (参数A, 参数B))

.子程序 MD5演示函数_GG, 空白型, , 
.参数 参数A, 整数型, 参考, 
.参数 参数B, 整数型, , 
.参数 参数C, 整数型, , 
.参数 参数D, 整数型, , 
.参数 信息, 整数型, , 
.参数 移位数, 整数型, , 
.参数 轮参数, 整数型, , 

赋值 (参数A, MD5演示函数_正整数加法 (参数A, MD5演示函数_正整数加法 (MD5演示函数_正整数加法 (MD5演示函数_G (参数B, 参数C, 参数D), 信息), 轮参数)))
赋值 (参数A, MD5演示函数_循环左移 (参数A, 移位数))
赋值 (参数A, MD5演示函数_正整数加法 (参数A, 参数B))

.子程序 MD5演示函数_HH, 空白型, , 
.参数 参数A, 整数型, 参考, 
.参数 参数B, 整数型, , 
.参数 参数C, 整数型, , 
.参数 参数D, 整数型, , 
.参数 信息, 整数型, , 
.参数 移位数, 整数型, , 
.参数 轮参数, 整数型, , 

赋值 (参数A, MD5演示函数_正整数加法 (参数A, MD5演示函数_正整数加法 (MD5演示函数_正整数加法 (MD5演示函数_H (参数B, 参数C, 参数D), 信息), 轮参数)))
赋值 (参数A, MD5演示函数_循环左移 (参数A, 移位数))
赋值 (参数A, MD5演示函数_正整数加法 (参数A, 参数B))

.子程序 MD5演示函数_II, 空白型, , 
.参数 参数A, 整数型, 参考, 
.参数 参数B, 整数型, , 
.参数 参数C, 整数型, , 
.参数 参数D, 整数型, , 
.参数 信息, 整数型, , 
.参数 移位数, 整数型, , 
.参数 轮参数, 整数型, , 

赋值 (参数A, MD5演示函数_正整数加法 (参数A, MD5演示函数_正整数加法 (MD5演示函数_正整数加法 (MD5演示函数_I (参数B, 参数C, 参数D), 信息), 轮参数)))
赋值 (参数A, MD5演示函数_循环左移 (参数A, 移位数))
赋值 (参数A, MD5演示函数_正整数加法 (参数A, 参数B))

.子程序 MD5演示函数_轮函数, 空白型, , 
.参数 参数A, 整数型, 参考, 
.参数 参数B, 整数型, 参考, 
.参数 参数C, 整数型, 参考, 
.参数 参数D, 整数型, 参考, 
.参数 信息, 整数型, 数组, 

 ' 轮参数为 4294967296 × 取绝对值 (求正弦 (轮次))的整数部分 轮次为1->64
 ' Round F
MD5演示函数_FF (参数A, 参数B, 参数C, 参数D, 信息 [1], 7, 3614090360) ' 0xd76aa478
MD5演示函数_FF (参数D, 参数A, 参数B, 参数C, 信息 [2], 12, 3905402710) ' 0xe8c7b756
MD5演示函数_FF (参数C, 参数D, 参数A, 参数B, 信息 [3], 17, 606105819) ' 0x242070db
MD5演示函数_FF (参数B, 参数C, 参数D, 参数A, 信息 [4], 22, 3250441966) ' 0xc1bdceee

MD5演示函数_FF (参数A, 参数B, 参数C, 参数D, 信息 [5], 7, 4118548399) ' 0xf57c0faf
MD5演示函数_FF (参数D, 参数A, 参数B, 参数C, 信息 [6], 12, 1200080426) ' 0x4787c62a
MD5演示函数_FF (参数C, 参数D, 参数A, 参数B, 信息 [7], 17, 2821735955) ' 0xa8304613
MD5演示函数_FF (参数B, 参数C, 参数D, 参数A, 信息 [8], 22, 4249261313) ' 0xfd469501

MD5演示函数_FF (参数A, 参数B, 参数C, 参数D, 信息 [9], 7, 1770035416) ' 0x698098d8
MD5演示函数_FF (参数D, 参数A, 参数B, 参数C, 信息 [10], 12, 2336552879) ' 0x8b44f7af
MD5演示函数_FF (参数C, 参数D, 参数A, 参数B, 信息 [11], 17, 4294925233) ' 0xffff5bb1
MD5演示函数_FF (参数B, 参数C, 参数D, 参数A, 信息 [12], 22, 2304563134) ' 0x895cd7be

MD5演示函数_FF (参数A, 参数B, 参数C, 参数D, 信息 [13], 7, 1804603682) ' 0x6b901122
MD5演示函数_FF (参数D, 参数A, 参数B, 参数C, 信息 [14], 12, 4254626195) ' 0xfd987193
MD5演示函数_FF (参数C, 参数D, 参数A, 参数B, 信息 [15], 17, 2792965006) ' 0xa679438e
MD5演示函数_FF (参数B, 参数C, 参数D, 参数A, 信息 [16], 22, 1236535329) ' 0x49b40821

 ' Round G
MD5演示函数_GG (参数A, 参数B, 参数C, 参数D, 信息 [2], 5, 4129170786) ' 0xF61E2562
MD5演示函数_GG (参数D, 参数A, 参数B, 参数C, 信息 [7], 9, 3225465664) ' 0xC040B340
MD5演示函数_GG (参数C, 参数D, 参数A, 参数B, 信息 [12], 14, 643717713) ' 0x265E5A51
MD5演示函数_GG (参数B, 参数C, 参数D, 参数A, 信息 [1], 20, 3921069994) ' 0xE9B6C7AA

MD5演示函数_GG (参数A, 参数B, 参数C, 参数D, 信息 [6], 5, 3593408605) ' 0xD62F105D
MD5演示函数_GG (参数D, 参数A, 参数B, 参数C, 信息 [11], 9, 38016083) ' 0x2441453
MD5演示函数_GG (参数C, 参数D, 参数A, 参数B, 信息 [16], 14, 3634488961) ' 0xD8A1E681
MD5演示函数_GG (参数B, 参数C, 参数D, 参数A, 信息 [5], 20, 3889429448) ' 0xE7D3FBC8

MD5演示函数_GG (参数A, 参数B, 参数C, 参数D, 信息 [10], 5, 568446438) ' 0x21E1CDE6
MD5演示函数_GG (参数D, 参数A, 参数B, 参数C, 信息 [15], 9, 3275163606) ' 0xC33707D6
MD5演示函数_GG (参数C, 参数D, 参数A, 参数B, 信息 [4], 14, 4107603335) ' 0xF4D50D87
MD5演示函数_GG (参数B, 参数C, 参数D, 参数A, 信息 [9], 20, 1163531501) ' 0x455A14ED

MD5演示函数_GG (参数A, 参数B, 参数C, 参数D, 信息 [14], 5, 2850285829) ' 0xA9E3E905
MD5演示函数_GG (参数D, 参数A, 参数B, 参数C, 信息 [3], 9, 4243563512) ' 0xFCEFA3F8
MD5演示函数_GG (参数C, 参数D, 参数A, 参数B, 信息 [8], 14, 1735328473) ' 0x676F02D9
MD5演示函数_GG (参数B, 参数C, 参数D, 参数A, 信息 [13], 20, 2368359562) ' 0x8D2A4C8A

 ' Round H
MD5演示函数_HH (参数A, 参数B, 参数C, 参数D, 信息 [6], 4, 4294588738) ' 0xFFFA3942
MD5演示函数_HH (参数D, 参数A, 参数B, 参数C, 信息 [9], 11, 2272392833) ' 0x8771F681
MD5演示函数_HH (参数C, 参数D, 参数A, 参数B, 信息 [12], 16, 1839030562) ' 0x6D9D6122
MD5演示函数_HH (参数B, 参数C, 参数D, 参数A, 信息 [15], 23, 4259657740) ' 0xFDE5380C

MD5演示函数_HH (参数A, 参数B, 参数C, 参数D, 信息 [2], 4, 2763975236) ' 0xA4BEEA44
MD5演示函数_HH (参数D, 参数A, 参数B, 参数C, 信息 [5], 11, 1272893353) ' 0x4BDECFA9
MD5演示函数_HH (参数C, 参数D, 参数A, 参数B, 信息 [8], 16, 4139469664) ' 0xF6BB4B60
MD5演示函数_HH (参数B, 参数C, 参数D, 参数A, 信息 [11], 23, 3200236656) ' 0xBEBFBC70

MD5演示函数_HH (参数A, 参数B, 参数C, 参数D, 信息 [14], 4, 681279174) ' 0x289B7EC6
MD5演示函数_HH (参数D, 参数A, 参数B, 参数C, 信息 [1], 11, 3936430074) ' 0xEAA127FA
MD5演示函数_HH (参数C, 参数D, 参数A, 参数B, 信息 [4], 16, 3572445317) ' 0xD4EF3085
MD5演示函数_HH (参数B, 参数C, 参数D, 参数A, 信息 [7], 23, 76029189) ' 0x4881D05

MD5演示函数_HH (参数A, 参数B, 参数C, 参数D, 信息 [10], 4, 3654602809) ' 0xD9D4D039
MD5演示函数_HH (参数D, 参数A, 参数B, 参数C, 信息 [13], 11, 3873151461) ' 0xE6DB99E5
MD5演示函数_HH (参数C, 参数D, 参数A, 参数B, 信息 [16], 16, 530742520) ' 0x1FA27CF8
MD5演示函数_HH (参数B, 参数C, 参数D, 参数A, 信息 [3], 23, 3299628645) ' 0xC4AC5665

 ' Round I
MD5演示函数_II (参数A, 参数B, 参数C, 参数D, 信息 [1], 6, 4096336452) ' 0xF4292244
MD5演示函数_II (参数D, 参数A, 参数B, 参数C, 信息 [8], 10, 1126891415) ' 0x432AFF97
MD5演示函数_II (参数C, 参数D, 参数A, 参数B, 信息 [15], 15, 2878612391) ' 0xAB9423A7
MD5演示函数_II (参数B, 参数C, 参数D, 参数A, 信息 [6], 21, 4237533241) ' 0xFC93A039

MD5演示函数_II (参数A, 参数B, 参数C, 参数D, 信息 [13], 6, 1700485571) ' 0x655B59C3
MD5演示函数_II (参数D, 参数A, 参数B, 参数C, 信息 [4], 10, 2399980690) ' 0x8F0CCC92
MD5演示函数_II (参数C, 参数D, 参数A, 参数B, 信息 [11], 15, 4293915773) ' 0xFFEFF47D
MD5演示函数_II (参数B, 参数C, 参数D, 参数A, 信息 [2], 21, 2240044497) ' 0x85845DD1

MD5演示函数_II (参数A, 参数B, 参数C, 参数D, 信息 [9], 6, 1873313359) ' 0x6FA87E4F
MD5演示函数_II (参数D, 参数A, 参数B, 参数C, 信息 [16], 10, 4264355552) ' 0xFE2CE6E0
MD5演示函数_II (参数C, 参数D, 参数A, 参数B, 信息 [7], 15, 2734768916) ' 0xA3014314
MD5演示函数_II (参数B, 参数C, 参数D, 参数A, 信息 [14], 21, 1309151649) ' 0x4E0811A1

MD5演示函数_II (参数A, 参数B, 参数C, 参数D, 信息 [5], 6, 4149444226) ' 0xF7537E82
MD5演示函数_II (参数D, 参数A, 参数B, 参数C, 信息 [12], 10, 3174756917) ' 0xBD3AF235
MD5演示函数_II (参数C, 参数D, 参数A, 参数B, 信息 [3], 15, 718787259) ' 0x2AD7D2BB
MD5演示函数_II (参数B, 参数C, 参数D, 参数A, 信息 [10], 21, 3951481745) ' 0xEB86D391

.子程序 MD5, 文本型, , 
.参数 字节集, 字节集, , 

.局部变量 信息, 整数型, , "16", 
.局部变量 长度, 整数型, , , 
.局部变量 位置, 整数型, , , 
.局部变量 补充, 整数型, , , 
.局部变量 变量, 整数型, , , 
.局部变量 参数A, 整数型, , , 
.局部变量 参数B, 整数型, , , 
.局部变量 参数C, 整数型, , , 
.局部变量 参数D, 整数型, , , 
.局部变量 a, 整数型, , , 
.局部变量 b, 整数型, , , 
.局部变量 c, 整数型, , , 
.局部变量 d, 整数型, , , 

 ' 因为易语言中整数的位形式与C中有所不同,故链接常量值也需要进行改变
 ' 也可能是搞错了,易语言中整数的位形式还不了解,参考了一些VBScript之后才将顺序颠倒
赋值 (参数A)


 ' 不属于任何一个程序集、类模块的函数：
