 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 700
    高度 = 500
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16383484 '  0xF9FDFC
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “双狮彩票选号――广东36选7泛珠三角体彩”
    帮助文件名 = “”

窗口 随机设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 300
    高度 = 156
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “幸运尽在“随机选号”设置”
    帮助文件名 = “”

窗口 添加开奖号码窗口
    左边 = 50
    顶边 = 50
    宽度 = 403
    高度 = 103
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “ 添加开奖号码”
    帮助文件名 = “”

窗口 编辑开奖记录窗口
    左边 = 50
    顶边 = 50
    宽度 = 395
    高度 = 147
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “ 编辑开奖记录”
    帮助文件名 = “”

窗口 查找开奖记录窗口
    左边 = 50
    顶边 = 50
    宽度 = 395
    高度 = 147
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “ 查找开奖记录”
    帮助文件名 = “”



.图片 备用数据库, " ' 已保存到：D:\易语言学习\Data\广东36选7泛珠三角体彩.e\备用数据库", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 2 0 扩展界面支持库三
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' MyLib 17EEFFB6-E0CA-4e6b-9E5B-48C6052EBE08 1 0 袁松的支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库




.全局变量 图片组, 字节集, , "2", 
.全局变量 随机选号注数, 整数型, , , 
.全局变量 奇偶, 整数型, , , 
.全局变量 大小, 整数型, , , 
.全局变量 段位, 整数型, , "2", 
.全局变量 选号, 整数型, , , 
.全局变量 数据库文件名, 文本型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 临时号码, 整数型, , "36", 
.程序集变量 号码, 文本型, , , 
.程序集变量 序号, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
未知支持库函数_0 (1)

赋值 (.现行子夹, 0)
赋值 (.宽度, .宽度)
赋值 (.高度, .高度)
赋值 (选号, -1)
赋值 (数据库文件名, “双狮彩票选号数据库.edb”)
打开数据库 ()

.子程序 打开数据库, 逻辑型, , 
.如果真 (打开 (数据库文件名, , , , , , ))
    返回 (真)
.如果真结束
信息框 (相加 (“打开”, #左引号, 数据库文件名, #右引号, “失败！”), 0, )
.如果真 (等于 (信息框 (“是否还原数据库文件，系统将还原到最初状态！”, #是否钮, “系统提示”), #是钮))
    写到文件 (相加 (取运行目录 (), “\”, 数据库文件名), #备用数据库)
    打开数据库 ()
    返回 (真)
.如果真结束
返回 (假)

.子程序 _卷帘式菜单1_菜单被改变, 空白型, , 
.参数 菜单索引, 整数型, , 

.如果真 (等于 (菜单索引, 0))
    赋值 (.现行子夹, 0)
    赋值 (.可视, 假)
.如果真结束
.如果真 (等于 (菜单索引, 1))
    赋值 (.可视, 真)
    赋值 (.现行子夹, 1)
.如果真结束
.如果真 (等于 (菜单索引, 2))
    赋值 (.可视, 真)
    赋值 (.现行子夹, 2)
.如果真结束


.子程序 _卷帘式菜单1_项目被选择, 空白型, , 
.参数 菜单索引, 整数型, , 
.参数 项目索引, 整数型, , 

.局部变量 a, 整数型, , , 
.局部变量 b, 整数型, , , 

.如果真 (等于 (菜单索引, 0))
    赋值 (a, 寻找文本 (.内容, 项目索引.未知支持库函数_8 (), 0, 假))
    赋值 (.内容, 取文本左边 (.内容, a))
    赋值 (b, 相减 (未知支持库函数_159 (取窗口句柄 ()), 1))
    赋值 (.起始选择位置, 1)
    获取焦点 ()
    未知支持库函数_160 (取窗口句柄 (), b)
.如果真结束
.如果真 (等于 (菜单索引, 1))
    .如果真 (等于 (项目索引, 0))
        载入 (随机设置窗口, , 真)
    .如果真结束
    
.如果真结束
.如果真 (等于 (菜单索引, 2))
    .如果真 (等于 (项目索引, 0))
        赋值 (.现行子夹, 2)
    .如果真结束
    .如果真 (等于 (项目索引, 1))
        
    .如果真结束
    
.如果真结束
.如果真 (等于 (菜单索引, 3))
    .如果真 (等于 (项目索引, 1))
        信息框 (相加 (“这是我首次写的彩票软件，这是其中一小部分与易友们学习！为易爱易！”, #换行符, “双狮软件工作室  作者：林劲国  （易论坛名：TLSWR）”, #换行符, #换行符, “                                         2005年11月2日”), 64, )
    .如果真结束
    
.如果真结束



.子程序 _编辑框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

返回 (假)

.子程序 _编辑框1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

返回 (假)

.子程序 _开始选号_被单击, 空白型, , 
.如果真 (等于 (选号, 0))
    .如果真 (小于或等于 (随机选号注数, 0))
        载入 (随机设置窗口, , 真)
    .如果真结束
    赋值 (.禁止, 真)
    赋值 (.时钟周期, 88)
.如果真结束


.子程序 _选号码清空_被单击, 空白型, , 
全部删除 ()

.子程序 _时钟1_周期事件, 空白型, , 
赋值 (序号, 相加 (序号, 1))
.如果真 (等于 (选号, 0))
    随机选号码 ()
    .如果真 (等于 (随机选号注数, 序号))
        赋值 (序号, 0)
        赋值 (.禁止, 假)
        赋值 (.时钟周期, 0)
    .如果真结束
    
.如果真结束


.子程序 随机选号码, 空白型, , 
.局部变量 a, 整数型, , "0", 
.局部变量 计次变量, 整数型, , , 
.局部变量 b, 整数型, , , 
.局部变量 n, 整数型, , , 
.局部变量 显号码框, 画板, , , 
.局部变量 插入项值, 整数型, , , 

赋值 (号码, “”)
.计次循环首 (36, 计次变量)
    加入成员 (a, 计次变量)
.计次循环尾 ()
赋值 (插入项值, .插入表项 (到文本 (相加 (取表项数 (), 1)), , , , ))
.计次循环首 (7, n)
    赋值 (显号码框, 取标记组件 (n))
    赋值 (b, 取随机数 (1, 取数组成员数 (a)))
    赋值 (显号码框.底图, 未知支持库函数_31 (., 相减 (a [b], 1), ))
    插入项值.置图片 (n, 相减 (a [b], 1))
    赋值 (号码, 相加 (号码, 到文本 (a [b]), “|”))
    删除成员 (a, b, 1)
.计次循环尾 ()

.子程序 __启动窗口_将被销毁, 空白型, , 
关闭 (相加 (取运行目录 (), “\”, 数据库文件名))
结束 ()

.子程序 _更新历史表_被单击, 空白型, , 
置等待鼠标 ()
全部删除 ()
读数据库 ()
恢复鼠标 ()

.子程序 读数据库, 空白型, , 
.局部变量 变量, 整数型, , , 
.局部变量 循环变量, 整数型, , , 
.局部变量 记录容器, 文本型, , "10", 
.局部变量 记录数, 整数型, , , 
.局部变量 插入项值, 整数型, , , 
.局部变量 n, 整数型, , , 

赋值 (记录数, 取记录数 ())
到首记录 ()
赋值 (.可视, 真)
赋值 (.内容, “正在添加数据库数据到列表... ...”)
.变量循环首 (1, 记录数, 1, 变量)
    处理事件 ()
    .变量循环首 (1, 8, 1, 循环变量)
        赋值 (记录容器 [循环变量], 读 (循环变量))
    .变量循环尾 ()
    赋值 (插入项值, .插入表项 (记录容器 [1], , , , ))
    .变量循环首 (2, 8, 1, n)
        插入项值.置图片 (相减 (n, 1), 相减 (到数值 (记录容器 [n]), 1))
    .变量循环尾 ()
    跳到 (相加 (变量, 1))
.变量循环尾 ()
赋值 (.内容, “数据库所有记录已经添加完毕！”)
延时 (200)
赋值 (.可视, 假)

.子程序 _添加历史表_被单击, 空白型, , 
载入 (添加开奖号码窗口, , 真)

.子程序 _编辑历史表_被单击, 空白型, , 
载入 (编辑开奖记录窗口, , 真)

.子程序 _杳找历史表_被单击, 空白型, , 
载入 (查找开奖记录窗口, , 真)

.子程序 _删除历史表_被单击, 空白型, , 
.局部变量 被选择的文件个数, 整数型, , , 
.局部变量 记录, 逻辑型, , , 
.局部变量 条件记录, 文本型, , , 
.局部变量 n, 整数型, , , 
.局部变量 索引数组, 整数型, , "0", 

到首记录 ()
赋值 (索引数组, 取被选择表项 ())
.变量循环首 (1, 取数组成员数 (索引数组), 1, n)
    赋值 (条件记录, 索引数组.取标题 ( [n], 0))
    赋值 (记录, 查找 (等于 (等于 (读 (1), 条件记录), 真)))
    .如果真 (等于 (记录, 真))
        跳到 (取记录号 ())
        删除 ()
        彻底删除 ()
    .如果真结束
    
.变量循环尾 ()
赋值 (被选择的文件个数, 取已选择表项数 ())
.判断循环首 (大于 (被选择的文件个数, 0))
    .删除表项 (.)
    赋值 (被选择的文件个数, 相减 (被选择的文件个数, 1))
.判断循环尾 ()

.子程序 _退出_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集2, , , 

.子程序 _确定_被单击, 空白型, , 
赋值 (随机选号注数, 到数值 (.内容))
.如果真 (小于或等于 (随机选号注数, 0))
    赋值 (随机选号注数, 1)
.如果真结束
赋值 (选号, 0)
销毁 ()

.子程序 _随机设置窗口_创建完毕, 空白型, , 
赋值 (.内容, 到文本 (随机选号注数))
.如果真 (小于或等于 (随机选号注数, 0))
    赋值 (.内容, “1”)
.如果真结束


.窗口程序集 窗口程序集3, , , 

.子程序 _确定_被单击, 空白型, , 
.如果真 (或者 (等于 (.内容, “”), 小于 (到数值 (.内容), 1)))
    信息框 (“请正确输入开奖期数！”, 0, )
     ' 返回 ()
 ' .如果真结束
.如果真 (或者 (等于 (.内容, “”), 小于 (到数值 (.内容), 1), 大于 (到数值 (.内容), 36)))
    信息框 (“请正确输入1号号码!”, 0, )
    返回 ()
.如果真结束
.如果真 (或者 (等于 (.内容, “”), 小于 (到数值 (.内容), 1), 大于 (到数值 (.内容), 36)))
    信息框 (“请正确输入2号号码!”, 0, )
    返回 ()
.如果真结束
.如果真 (或者 (等于 (.内容, “”), 小于 (到数值 (.内容), 1), 大于 (到数值 (.内容), 36)))
    信息框 (“请正确输入3号号码！”, 0, )
    返回 ()
.如果真结束
.如果真 (或者 (等于 (.内容, “”), 小于 (到数值 (.内容), 1), 大于 (到数值 (.内容), 36)))
    信息框 (“请正确输入4号号码！”, 0, )
    返回 ()
.如果真结束
.如果真 (或者 (等于 (.内容, “”), 小于 (到数值 (.内容), 1), 大于 (到数值 (.内容), 36)))
    信息框 (“请正确输入5号号码！”, 0, )
    返回 ()
.如果真结束
.如果真 (或者 (等于 (.内容, “”), 小于 (到数值 (.内容), 1), 大于 (到数值 (.内容), 36)))
    信息框 (“请正确输入6号号码！”, 0, )
    返回 ()
.如果真结束
.如果真 (或者 (等于 (.内容, “”), 小于 (到数值 (.内容), 1), 大于 (到数值 (.内容), 36)))
    信息框 (“请正确输入7号号码！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (添加开奖记录 (), 假))
    信息框 (“添加开奖号码记录到数库失败！”, 32, )
    返回 ()
.如果真结束
销毁 ()

.子程序 添加开奖记录, 逻辑型, , 
.局部变量 记录容器, 文本型, , "8", 

赋值 (记录容器 [1], 到文本 (.内容))
赋值 (记录容器 [2], 到文本 (.内容))
赋值 (记录容器 [3], 到文本 (.内容))
赋值 (记录容器 [4], 到文本 (.内容))
赋值 (记录容器 [5], 到文本 (.内容))
赋值 (记录容器 [6], 到文本 (.内容))
赋值 (记录容器 [7], 到文本 (.内容))
赋值 (记录容器 [8], 到文本 (.内容))
到尾记录 ()
.如果 (加记录 (记录容器 [1], 记录容器 [2], 记录容器 [3], 记录容器 [4], 记录容器 [5], 记录容器 [6], 记录容器 [7], 记录容器 [8]))
    返回 (真)
.否则
    返回 (假)
.如果结束


.子程序 _取消_被单击, 空白型, , 
销毁 ()


.窗口程序集 窗口程序集4, , , 

.程序集变量 记录数, 整数型, , , 
.子程序 _上一条_被单击, 空白型, , 
赋值 (记录数, 取记录数 ())
.如果真 (大于 (取记录号 (), 1))
    跳过 (-1)
.如果真结束
赋值 (.内容, 到文本 (取记录号 ()))
显示数据库记录 ()

.子程序 _下一条_被单击, 空白型, , 
赋值 (记录数, 取记录数 ())
.如果真 (小于 (取记录号 (), 记录数))
    跳过 (1)
.如果真结束
赋值 (.内容, 到文本 (取记录号 ()))
显示数据库记录 ()

.子程序 _修改_被单击, 空白型, , 
修改 (.内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)

.子程序 _取消_被单击, 空白型, , 
销毁 ()

.子程序 显示数据库记录, 空白型, , 
.局部变量 N, 整数型, , , 
.局部变量 记录, 文本型, , "10", 

.变量循环首 (1, 8, 1, N)
    赋值 (记录 [N], 读 (N))
.变量循环尾 ()
赋值 (.内容, 记录 [1])
赋值 (.内容, 记录 [2])
赋值 (.内容, 记录 [3])
赋值 (.内容, 记录 [4])
赋值 (.内容, 记录 [5])
赋值 (.内容, 记录 [6])
赋值 (.内容, 记录 [7])
赋值 (.内容, 记录 [8])

.子程序 _调节器1_调节钮被按下, 空白型, , 
.参数 按钮值, 整数型, , 

赋值 (记录数, 取记录数 ())
.如果 (等于 (按钮值, 1))
    .如果真 (小于 (取记录号 (), 记录数))
        跳过 (1)
    .如果真结束
    
.否则
    .如果 (等于 (按钮值, -1))
        .如果真 (大于 (取记录号 (), 0))
            跳过 (-1)
        .如果真结束
        
    .否则
        
    .如果结束
    
.如果结束
赋值 (.内容, 到文本 (取记录号 ()))
.如果真 (小于 (.内容, 到文本 (1)))
    赋值 (.内容, “1”)
.如果真结束
显示数据库记录 ()

.子程序 _编辑框1_内容被改变, 空白型, , 
跳到 (到数值 (.内容))
显示数据库记录 ()

.窗口程序集 窗口程序集5, , , 

.程序集变量 条件记录, 文本型, , , 
.程序集变量 ID, 整数型, , , 
.程序集变量 记录数, 整数型, , , 
.程序集变量 记录, 逻辑型, , , 
.程序集变量 找到否, 逻辑型, , , 
.子程序 _调节器1_调节钮被按下, 空白型, , 
.参数 按钮值, 整数型, , 

赋值 (记录数, 取记录数 ())
.如果 (等于 (按钮值, 1))
    .如果真 (小于 (取记录号 (), 记录数))
        跳过 (1)
    .如果真结束
    
.否则
    .如果 (等于 (按钮值, -1))
        .如果真 (大于 (取记录号 (), 0))
            跳过 (-1)
        .如果真结束
        
    .否则
        
    .如果结束
    
.如果结束
赋值 (.内容, 到文本 (取记录号 ()))
.如果真 (小于 (.内容, 到文本 (1)))
    赋值 (.内容, “1”)
.如果真结束
显示数据库记录 ()


.子程序 _编辑框1_内容被改变, 空白型, , 
跳到 (到数值 (.内容))
显示数据库记录 ()

.子程序 显示数据库记录, 空白型, , 
.局部变量 N, 整数型, , , 
.局部变量 记录, 文本型, , "10", 

.变量循环首 (1, 8, 1, N)
    赋值 (记录 [N], 读 (N))
.变量循环尾 ()
赋值 (.内容, 记录 [1])
赋值 (.内容, 记录 [2])
赋值 (.内容, 记录 [3])
赋值 (.内容, 记录 [4])
赋值 (.内容, 记录 [5])
赋值 (.内容, 记录 [6])
赋值 (.内容, 记录 [7])
赋值 (.内容, 记录 [8])

.子程序 _查找_被单击, 空白型, , 
.如果真 (.选中)
    赋值 (条件记录, .内容)
    赋值 (ID, 1)
.如果真结束
.如果真 (.选中)
    赋值 (条件记录, .内容)
    赋值 (ID, 2)
.如果真结束
.如果真 (.选中)
    赋值 (条件记录, .内容)
    赋值 (ID, 3)
.如果真结束
.如果真 (.选中)
    赋值 (条件记录, .内容)
    赋值 (ID, 4)
.如果真结束
.如果真 (.选中)
    赋值 (条件记录, .内容)
    赋值 (ID, 5)
.如果真结束
.如果真 (.选中)
    赋值 (条件记录, .内容)
    赋值 (ID, 6)
.如果真结束
.如果真 (.选中)
    赋值 (条件记录, .内容)
    赋值 (ID, 7)
.如果真结束
.如果真 (.选中)
    赋值 (条件记录, .内容)
    赋值 (ID, 8)
.如果真结束

查找记录 ()

.子程序 查找记录, 逻辑型, , 
赋值 (记录, 查找 (等于 (等于 (读 (ID), 条件记录), 真)))
.如果 (等于 (记录, 真))
    赋值 (找到否, 真)
    赋值 (.内容, 到文本 (取记录号 ()))
    显示数据库记录 ()
.否则
    赋值 (找到否, 假)
    信息框 (“没有找到指定记录！”, 0, )
    到首记录 ()
.如果结束
返回 (找到否)

.子程序 _继续_被单击, 空白型, , 
.如果 (等于 (找到否, 真))
    跳到 (相加 (取记录号 (), 1))
    查找记录 ()
.否则
    信息框 (“没有找到！”, 0, )
.如果结束


.子程序 _取消_被单击, 空白型, , 
销毁 ()


 ' 不属于任何一个程序集、类模块的函数：
