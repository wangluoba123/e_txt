 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 73
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 3 0 应用接口支持库



 ' 所需要的模块
 ' QQ大厅多开模块 d:\我的文档\桌面\QQ大厅多开模块.ec


数据类型 进程结构, , 
    .成员 进程句柄, 整数型, , , hProcess
    .成员 线程句柄, 整数型, , , hThread
    .成员 进程标识符, 整数型, , , dwProcessId
    .成员 线程标识符, 整数型, , , dwThreadId

数据类型 sby5ryt, , 
    .成员 cbSize, 整数型, , , 
    .成员 lpReserved, 整数型, , , 
    .成员 lpDesktop, 整数型, , , 
    .成员 lpTitle, 整数型, , , 
    .成员 dwX, 整数型, , , 
    .成员 dwY, 整数型, , , 
    .成员 dwXSize, 整数型, , , 
    .成员 dwYSize, 整数型, , , 
    .成员 dwXCountChars, 整数型, , , 
    .成员 dwYCountChars, 整数型, , , 
    .成员 dwFillAttribute, 整数型, , , 
    .成员 dwFlags, 整数型, , , 
    .成员 wShowWindow, 长整数型, , , 
    .成员 cbReserved2, 长整数型, , , 
    .成员 lpReserved2, 整数型, , , 
    .成员 hStdInput, 整数型, , , 
    .成员 hStdOutput, 整数型, , , 
    .成员 hStdError, 整数型, , , 


.DLL命令 _创建新进程2, 整数型, "", "CreateProcessA", , 
    .参数 lpApplicationName, 文本型, , 
    .参数 lpCommandLine, 文本型, , 
    .参数 lpProcessAttributes, 整数型, , 
    .参数 lpThreadAttributes, 整数型, , 
    .参数 bInheritHandles, 整数型, , 
    .参数 dwCreationFlags, 整数型, , 
    .参数 lpEnvironment, 整数型, , 
    .参数 lpCurrentDriectory, 文本型, , 
    .参数 lpStartupInfo, sby5ryt, , 
    .参数 lpProcessInformation, 进程结构, , 

.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 本子程序在程序启动后最先执行
载入 (窗口1, , 真)
返回 (0) ' 可以根据您的需要返回任意数值

.窗口程序集 窗口程序集1, , , 

.程序集变量 大厅进程ID, 整数型, , "0", 
.程序集变量 大厅进程ID数量, 整数型, , , 
.程序集变量 进程ID, 整数型, , , 
.子程序 _窗口1_创建完毕, 空白型, , 
.局部变量 局部_路径, 文本型, , , 

赋值 (局部_路径, 取文本注册项 (#根类, “QQGameProtocol\DefaultIcon\”, ))
赋值 (局部_路径, 取文本左边 (局部_路径, 倒找文本 (局部_路径, “\”, , 假)))
赋值 (.内容, 局部_路径)


.子程序 _按钮1_被单击, 空白型, , 
赋值 (进程ID, 创建进程 (相加 (.内容, “QQGame.exe”), ))
大厅进程检测 ()

.子程序 创建进程, 整数型, , 创建一个程序进程(成功返回进程ID,失败返回0)
.参数 程序路径, 文本型, , 欲创建进程的执行路径
.参数 命令行, 文本型, 可空, 附加上程序路径后的命令行参数
.参数 运行目录, 文本型, 可空, 通常留空,特殊情况下使用
.参数 进程结构, 进程结构, 参考 可空, 接收进程结构信息的变量

.局部变量 窗口结构, sby5ryt, , , 

.如果真 (等于 (运行目录, “”))
    赋值 (运行目录, 取文本左边 (程序路径, 倒找文本 (程序路径, “\”, , 假)))
.如果真结束
_创建新进程2 (程序路径, 命令行, 0, 0, 0, 0, 0, 运行目录, 窗口结构, 进程结构)
返回 (进程结构.进程标识符)

.子程序 我要解除大厅多开限制, 空白型, , 
.局部变量 计次, 整数型, , , 

.计次循环首 (大厅进程ID数量, 计次)
    解除QQ大厅多开限制 (大厅进程ID [计次])
.计次循环尾 ()

.子程序 大厅进程检测, 空白型, , 
.局部变量 系统进程, 未知类型0x20009, , "0", 
.局部变量 计次变量, 整数型, , , 

处理事件 ()
清除数组 (大厅进程ID)
赋值 (大厅进程ID数量, 0)
赋值 (系统进程, 未知支持库函数_10 ())
.计次循环首 (取数组成员数 (系统进程), 计次变量)
    .如果真 (等于 (系统进程 [计次变量], , “QQGame.exe”))
        加入成员 (大厅进程ID, 系统进程 [计次变量], )
        赋值 (大厅进程ID数量, 相加 (大厅进程ID数量, 1))
        
    .如果真结束
    
.计次循环尾 ()
我要解除大厅多开限制 ()

.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 解除QQ大厅多开限制, 空白型, , 
.参数 进程PID, 整数型, , 提供一个进程id




 ' 不属于任何一个程序集、类模块的函数：
