 ' 文件类型：Windows窗口程序

 ' 程序名称：统计表模块
 ' 程序描述：可以用画板画出类似于Offic里面的柱形统计表图。
改进：
此版增大了柱状线的最大数据上限，可支持到1000000000。
新增：
圆饼统计图表(用圆饼可以画12个数据的统计图了)

作者：寞客软件（李东明）网名：小石头
2004年3月19日19时30分
 ' 程序作者：寞客软件工作室（李东明）
 ' 邮政编码：135200
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：ldm1979719@21cn.com
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.2
 ' 创建号：0.0

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 441
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 3 系统核心支持库




.全局变量 DATA, 整数型, , "0", 
.全局变量 文本, 文本型, , "0", 
.全局变量 位置, 整数型, , , 
.全局变量 合格, 逻辑型, , , 
.全局变量 x, 整数型, , , 
.全局变量 y, 整数型, , , 
.全局变量 y1, 整数型, , , 
.全局变量 x1, 整数型, , , 
.全局变量 i, 整数型, , , 
.全局变量 画板1, 画板, , , 
.全局变量 个数1, 整数型, , , 
.全局变量 深度1, 整数型, , , 
.全局变量 单位1, 文本型, , , 
.全局变量 单位2, 文本型, , , 
.全局变量 匿名全局变量_301, 空白型, , , 
.全局变量 画板2, 画板, , , 
.全局变量 厚度1, 整数型, , , 
.全局变量 长半径1, 双精度小数型, , , 
.全局变量 短半径1, 双精度小数型, , , 
.全局变量 DATA1, 整数型, , "0", 
.全局变量 上点位X, 双精度小数型, , , 
.全局变量 上点位Y, 双精度小数型, , , 
.全局变量 上下位置1, 整数型, , , 
.全局变量 单位3, 文本型, , , 
.全局变量 百分比, 整数型, , "0", 

.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在模块初始化代码执行完毕后调用模块测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的参数及返回值类型。
载入 (窗口1, , 真)

.程序集 _接口程序集, , , 在本程序集中定义的子程序可被模块外部程序访问，注意如果不存在本程序集就不能作为易模块编译。

.子程序 初始化表, 空白型, , 必须首先使用这条使命，再使用“画柱”和“曲线”命令。(此版本已将最大数，扩大到10亿)
.参数 画板, 画板, , 在程序中，指定要显示图表的画板名
.参数 x点, 整数型, , 在画板上原点x
.参数 y点, 整数型, , 在画板上原点y
.参数 长, 整数型, , 图表长度，请自行调整到适合自己的大小
.参数 宽, 整数型, , 图表宽度，请自行调整到适合自己的大小
.参数 个数, 整数型, , 图表要显示的项目个数，要与“数据”所指定的数组维数相同
.参数 深度, 整数型, , 在柱形表中，柱形的立体深度值。请自行调整到适合自己的大小
.参数 数据, 整数型, 数组, 用于记录每个项目的数值。必须为数组。维数要与“个数”值相同
.参数 每项文本, 文本型, 可空 数组, 用于记录每个项目在X轴的文本名。必须为数组。维数要与“个数”值相同。可以为空，为空时，X轴标注为数值序列
.参数 文本位置, 整数型, 可空, 如果你输入了项目文本，可用这个数值来调整表中文本的位置。为负数时，向左调整。可空
.参数 X轴单位, 文本型, 可空, 在X轴尾部显示的数量单位。可以为空
.参数 Y轴单位, 文本型, 可空, 在Y轴尾部显示的数量单位。可以为空

.局部变量 a, 整数型, , , 

赋值 (画板., {  })
赋值 (x, x点)
赋值 (y, y点)
赋值 (x1, 宽)
赋值 (y1, 长)
赋值 (个数1, 个数)
赋值 (深度1, 深度)
赋值 (位置, 文本位置)
赋值 (单位1, X轴单位)
赋值 (单位2, Y轴单位)
重定义数组 (DATA, 假, 取数组成员数 (数据))
.计次循环首 (取数组成员数 (数据), a)
    赋值 (DATA [a], 数据 [a])
.计次循环尾 ()
重定义数组 (文本, 假, 取数组成员数 (每项文本))
.计次循环首 (取数组成员数 (每项文本), a)
    赋值 (文本 [a], 每项文本 [a])
.计次循环尾 ()
赋值 (画板., 真)
赋值 (画板1, 画板)
画坐标 (个数, 深度)
赋值 (画板., 画板.取图片 ())

.子程序 画柱形, 空白型, , 画柱形表图
.参数 柱宽, 整数型, , 每个图表柱的横向宽度

.局部变量 a, 整数型, , "8", 
.局部变量 b, 整数型, , , 
.局部变量 c, 整数型, , , 
.局部变量 d, 整数型, , , 

画板1.清除 ()
赋值 (b, 检查 (个数1))
赋值 (c, 1)
赋值 (d, 1)
.计次循环首 (个数1, i)
    .判断开始 (等于 (相加 (1, 相乘 (3, 相减 (c, 1))), i))
        赋值 (画板1., #红色)
    .判断 (等于 (相加 (2, 相乘 (3, 相减 (d, 1))), i))
        赋值 (画板1., #蓝色)
    .默认
        赋值 (画板1., #黄色)
    .判断结束
    画板1.画矩形 (相减 (相加 (x, 相除 (相乘 (x1, i), 相加 (个数1, 1))), 相除 (柱宽, 2)), 相减 (y, 相除 (相乘 (y1, DATA [i]), b)), 相加 (x, 相除 (相乘 (x1, i), 相加 (个数1, 1)), 相除 (柱宽, 2)), y)
    .判断开始 (等于 (相加 (1, 相乘 (3, 相减 (c, 1))), i))
        赋值 (画板1., #红褐)
        赋值 (画板1., #红褐)
    .判断 (等于 (相加 (2, 相乘 (3, 相减 (d, 1))), i))
        赋值 (画板1., #藏青)
        赋值 (画板1., #藏青)
    .默认
        赋值 (画板1., #黄褐)
        赋值 (画板1., #黄褐)
    .判断结束
    赋值 (a [1], 相加 (x, 相除 (相乘 (x1, i), 相加 (个数1, 1)), 相除 (柱宽, 2)))
    赋值 (a [2], y)
    赋值 (a [3], 相加 (x, 相除 (相乘 (x1, i), 相加 (个数1, 1)), 相除 (柱宽, 2), 深度1))
    赋值 (a [4], 相减 (y, 相除 (深度1, 2)))
    赋值 (a [5], 相加 (x, 相除 (相乘 (x1, i), 相加 (个数1, 1)), 相除 (柱宽, 2), 深度1))
    赋值 (a [6], 相减 (y, 相除 (相乘 (y1, DATA [i]), b), 相除 (深度1, 2)))
    赋值 (a [7], 相加 (x, 相除 (相乘 (x1, i), 相加 (个数1, 1)), 相除 (柱宽, 2)))
    赋值 (a [8], 相减 (y, 相除 (相乘 (y1, DATA [i]), b)))
    画板1.画多边形 (a, 4)
    .判断开始 (等于 (相加 (1, 相乘 (3, 相减 (c, 1))), i))
        赋值 (画板1., 6447871)
        赋值 (画板1., 6447871)
    .判断 (等于 (相加 (2, 相乘 (3, 相减 (d, 1))), i))
        赋值 (画板1., #青蓝)
        赋值 (画板1., #青蓝)
    .默认
        赋值 (画板1., #嫩黄)
        赋值 (画板1., #嫩黄)
    .判断结束
    赋值 (a [1], 相减 (相加 (x, 相除 (相乘 (x1, i), 相加 (个数1, 1))), 相除 (柱宽, 2)))
    赋值 (a [2], 相减 (y, 相除 (相乘 (y1, DATA [i]), b)))
    赋值 (a [3], 相加 (x, 相除 (相乘 (x1, i), 相加 (个数1, 1)), 相除 (柱宽, 2)))
    赋值 (a [4], 相减 (y, 相除 (相乘 (y1, DATA [i]), b), 1))
    赋值 (a [5], 相加 (x, 相除 (相乘 (x1, i), 相加 (个数1, 1)), 相除 (柱宽, 2), 深度1))
    赋值 (a [6], 相减 (y, 相除 (相乘 (y1, DATA [i]), b), 相除 (深度1, 2)))
    赋值 (a [7], 相加 (相减 (相加 (x, 相除 (相乘 (x1, i), 相加 (个数1, 1))), 相除 (柱宽, 2)), 深度1))
    赋值 (a [8], 相减 (y, 相除 (相乘 (y1, DATA [i]), b), 相除 (深度1, 2)))
    画板1.画多边形 (a, 4)
    .判断开始 (等于 (相加 (1, 相乘 (3, 相减 (c, 1))), i))
        赋值 (画板1., #红色)
        赋值 (画板1., #红色)
        赋值 (c, 相加 (c, 1))
    .判断 (等于 (相加 (2, 相乘 (3, 相减 (d, 1))), i))
        赋值 (画板1., #蓝色)
        赋值 (画板1., #蓝色)
        赋值 (d, 相加 (d, 1))
    .默认
        赋值 (画板1., #黄色)
        赋值 (画板1., #黄色)
        
    .判断结束
    画板1.填充矩形 (相减 (相加 (x, 相除 (相乘 (x1, i), 相加 (个数1, 1))), 相除 (柱宽, 2)), 相减 (y, 相除 (相乘 (y1, DATA [i]), b)), 相加 (x, 相除 (相乘 (x1, i), 相加 (个数1, 1)), 相除 (柱宽, 2)), y)
    赋值 (画板1., #黑色)
    .如果 (不等于 (DATA [i], 0))
        画板1.定位写出 (相加 (x, 相除 (相乘 (x1, i), 相加 (个数1, 1))), 相减 (y, 相除 (相乘 (y1, DATA [i]), b), 相除 (深度1, 2), 10), 到文本 (DATA [i]))
    .否则
        
    .如果结束
    
.计次循环尾 ()

.子程序 画曲线, 空白型, , 画曲线图表
.局部变量 b, 整数型, , , 

画板1.清除 ()
赋值 (b, 检查 (个数1))
.计次循环首 (相减 (个数1, 1), i)
    赋值 (画板1., #蓝色)
    画板1.画直线 (相加 (x, 相除 (相乘 (x1, i), 相加 (个数1, 1))), 相减 (y, 相除 (相乘 (y1, DATA [i]), b)), 相加 (x, 相除 (相乘 (x1, 相加 (i, 1)), 相加 (个数1, 1))), 相减 (y, 相除 (相乘 (y1, DATA [相加 (i, 1)]), b)))
.计次循环尾 ()
.计次循环首 (个数1, i)
    赋值 (画板1., #红色)
    画板1.画矩形 (相减 (相加 (x, 相除 (相乘 (x1, i), 相加 (个数1, 1))), 2), 相减 (y, 相除 (相乘 (y1, DATA [i]), b), 2), 相加 (x, 相除 (相乘 (x1, i), 相加 (个数1, 1)), 2), 相加 (相减 (y, 相除 (相乘 (y1, DATA [i]), b)), 2))
    赋值 (画板1., #红色)
    画板1.填充矩形 (相减 (相加 (x, 相除 (相乘 (x1, i), 相加 (个数1, 1))), 2), 相减 (y, 相除 (相乘 (y1, DATA [i]), b), 2), 相加 (x, 相除 (相乘 (x1, i), 相加 (个数1, 1)), 2), 相加 (相减 (y, 相除 (相乘 (y1, DATA [i]), b)), 2))
    赋值 (画板1., #黑色)
    .如果 (不等于 (DATA [i], 0))
        画板1.定位写出 (相减 (相加 (x, 相除 (相乘 (x1, i), 相加 (个数1, 1))), 15), 相减 (y, 相除 (相乘 (y1, DATA [i]), b), 13), 到文本 (DATA [i]))
    .否则
        
    .如果结束
    
.计次循环尾 ()


.子程序 画圆饼, 空白型, , 画出圆饼统计图，要先使用“椭圆初始化”命令，才能使用本命令
.参数 数据, 整数型, 数组, 用于记录每个项目的数值。必须为数组。本版本最多支持12种颜色来标注圆饼，大于12时，重复以前的颜色。
.参数 注释, 文本型, 可空 数组, 用于在画版上注释每种颜色所代表的意义。(可以为空)
.参数 起始横坐标, 整数型, 可空, 注释在画版上的起始横坐标。可以为空。
.参数 起始纵坐标, 整数型, 可空, 注释在画版上的起始纵坐标。可以为空。

.局部变量 a, 整数型, , , 
.局部变量 和, 整数型, , , 
.局部变量 最大值, 整数型, , , 
.局部变量 名, 文本型, , , 
.局部变量 名1, 文本型, , , 

重定义数组 (DATA1, 假, 取数组成员数 (数据))
重定义数组 (假, 取数组成员数 (数据))
.计次循环首 (取数组成员数 (数据), a)
    赋值 (和, 相加 (和, 数据 [a]))
    赋值 (DATA1 [a], 数据 [a])
    .如果真 (小于 (最大值, DATA1 [a]))
        赋值 (最大值, DATA1 [a])
    .如果真结束
    
.计次循环尾 ()
.计次循环首 (厚度1, a)
    画饼 (和, a)
.计次循环尾 ()
.如果真 (等于 (取数组成员数 (注释), 取数组成员数 (DATA1)))
    画板2.定位写出 (起始横坐标, 起始纵坐标, 相加 (“单位：”, 单位1))
    .计次循环首 (取数组成员数 (DATA1), a)
        赋值 (名, “”)
        赋值 (名1, “”)
        赋值 ( [a], 相乘 (相除 (DATA1 [a], 和), 100))
        颜色 (a)
        画板2.画矩形 (起始横坐标, 相加 (起始纵坐标, 相乘 (20, a)), 相加 (起始横坐标, 10), 相加 (起始纵坐标, 相乘 (20, a), 10))
        .计次循环首 (相减 (取文本长度 (到文本 (最大值)), 取文本长度 (到文本 (DATA1 [a]))), i)
            赋值 (名, 相加 (名, “ ”))
        .计次循环尾 ()
        .判断开始 (等于 (取文本长度 (到文本 ( [a])), 1))
            赋值 (名1, “  ”)
        .判断 (等于 (取文本长度 (到文本 ( [a])), 2))
            赋值 (名1, “ ”)
        .默认
            赋值 (名1, “”)
        .判断结束
        画板2.定位写出 (相加 (起始横坐标, 12), 相加 (起始纵坐标, 相乘 (20, a)), 相加 (注释 [a], “：”, 名, 到文本 (DATA1 [a]), “　（”, 名1, 到文本 ( [a]), “%）”))
    .计次循环尾 ()
.如果真结束


.子程序 椭圆初始化, 空白型, , 必须首先使用这条使命，再使用“画圆饼”命令。
.参数 画板, 画板, , 在程序中，指定要显示图表的画板名
.参数 厚度, 整数型, , 要画圆饼的厚度，根据视觉自行设置
.参数 长半径, 整数型, , 椭圆的长半径长，根据视觉自行设置
.参数 短半径, 整数型, , 椭圆的短半径长，根据视觉自行设置
.参数 单位, 文本型, , 要显示数据的计量单位，如：吨、人等
.参数 上下位置, 整数型, 可空, 用于调节圆饼的上下位置，默认时在画版的中心点(可空)

赋值 (画板2, 画板)
赋值 (画板2., {  })
赋值 (厚度1, 厚度)
赋值 (画板2., 真)
赋值 (长半径1, 长半径)
赋值 (短半径1, 短半径)
赋值 (上下位置1, 上下位置)
赋值 (单位1, 单位)
赋值 (画板2.., 9)

.窗口程序集 程序集2, , , 

.子程序 检查, 整数型, , 
.参数 个数, 整数型, , 

.局部变量 a, 整数型, , , 

.计次循环首 (个数, i)
    .如果真 (小于 (a, DATA [i]))
        赋值 (a, DATA [i])
    .如果真结束
    
.计次循环尾 ()
.判断开始 (小于或等于 (a, 50))
    返回 (50)
.判断 (小于或等于 (a, 100))
    返回 (100)
.判断 (小于或等于 (a, 500))
    返回 (500)
.判断 (小于或等于 (a, 1000))
    返回 (1000)
.判断 (小于或等于 (a, 5000))
    返回 (5000)
.判断 (小于或等于 (a, 10000))
    返回 (10000)
.判断 (小于或等于 (a, 50000))
    返回 (50000)
.判断 (小于或等于 (a, 100000))
    返回 (100000)
.判断 (小于或等于 (a, 500000))
    返回 (500000)
.判断 (小于或等于 (a, 1000000))
    返回 (1000000)
.判断 (小于或等于 (a, 5000000))
    返回 (5000000)
.判断 (小于或等于 (a, 10000000))
    返回 (10000000)
.判断 (小于或等于 (a, 100000000))
    返回 (100000000)
.判断 (小于或等于 (a, 500000000))
    返回 (500000000)
.判断 (小于或等于 (a, 1000000000))
    返回 (1000000000)
.默认
    
.判断结束
返回 (0)

.子程序 画坐标, 空白型, , 
.参数 横坐标数, 整数型, , 
.参数 深度, 整数型, , 

.局部变量 a, 整数型, , "8", 
.局部变量 b, 整数型, , , 

画板1.清除 ()
画板1.画直线 (x, y, 相加 (x, 相除 (相乘 (x1, 13), 13)), y)
画板1.画直线 (x, y, x, 相减 (y, 相除 (相乘 (y1, 11), 10)))
画板1.画直线 (相加 (x, 深度), 相减 (y, 相除 (相乘 (y1, 11), 10), 相除 (深度, 2)), 相加 (x, 相除 (相乘 (x1, 13), 13), 深度, 1), 相减 (y, 相除 (相乘 (y1, 11), 10), 相除 (深度, 2)))
画板1.画直线 (相加 (x, 相除 (相乘 (x1, 13), 13), 深度), 相减 (y, 相除 (深度, 2)), 相加 (x, 相除 (相乘 (x1, 13), 13), 深度), 相减 (y, 相除 (相乘 (y1, 11), 10), 相除 (深度, 2)))
赋值 (画板1., #白色)
赋值 (a [1], x)
赋值 (a [2], y)
赋值 (a [3], 相加 (x, 相除 (相乘 (x1, 13), 13)))
赋值 (a [4], y)
赋值 (a [5], 相加 (x, 相除 (相乘 (x1, 13), 13), 深度))
赋值 (a [6], 相减 (y, 相除 (深度, 2)))
赋值 (a [7], 相加 (x, 深度))
赋值 (a [8], 相减 (y, 相除 (深度, 2)))
画板1.画多边形 (a, 4)
赋值 (画板1., #粉红)
赋值 (a [1], x)
赋值 (a [2], y)
赋值 (a [3], 相加 (x, 深度))
赋值 (a [4], 相减 (y, 相除 (深度, 2)))
赋值 (a [5], 相加 (x, 深度))
赋值 (a [6], 相减 (y, 相除 (相乘 (y1, 11), 10), 相除 (深度, 2)))
赋值 (a [7], x)
赋值 (a [8], 相减 (y, 相除 (相乘 (y1, 11), 10)))
画板1.画多边形 (a, 4)
赋值 (b, 相除 (检查 (横坐标数), 10))
.计次循环首 (10, i)
    赋值 (画板1., #黑色)
    画板1.画直线 (相减 (x, 5), 相减 (y, 相除 (相乘 (y1, i), 10)), x, 相减 (y, 相除 (相乘 (y1, i), 10)))
    画板1.定位写出 (相减 (x, 30), 相减 (y, 相除 (相乘 (y1, i), 10), 5), 到文本 (相乘 (b, i)))
    赋值 (画板1., #灰色)
    画板1.画直线 (x, 相减 (y, 相除 (相乘 (y1, i), 10)), 相加 (x, 深度), 相减 (y, 相除 (相乘 (y1, i), 10), 相除 (深度, 2)))
    画虚线 (相加 (x, 深度), 相减 (y, 相除 (相乘 (y1, i), 10), 相除 (深度, 2)), 相加 (x, 相除 (相乘 (x1, 13), 13), 深度))
.计次循环尾 ()
画板1.定位写出 (相减 (x, 30), 相减 (y, 相除 (相乘 (y1, 11), 10), 5), 单位2)
.计次循环首 (横坐标数, i)
    赋值 (画板1., #黑色)
    画板1.画直线 (相加 (x, 相除 (相乘 (x1, i), 相加 (横坐标数, 1))), 相减 (y, 3), 相加 (x, 相除 (相乘 (x1, i), 相加 (横坐标数, 1))), 相加 (y, 5))
    .判断开始 (不等于 (取数组成员数 (文本), 0))
        画板1.定位写出 (相加 (相减 (相加 (x, 相除 (相乘 (x1, i), 相加 (横坐标数, 1))), 8), 位置), 相加 (y, 8), 文本 [i])
    .默认
        画板1.定位写出 (相减 (相加 (x, 相除 (相乘 (x1, i), 相加 (横坐标数, 1))), 8), 相加 (y, 8), 到文本 (i))
    .判断结束
    
.计次循环尾 ()
画板1.定位写出 (相减 (相加 (x, 相除 (相乘 (x1, i), 相加 (横坐标数, 1))), 8), 相加 (y, 8), 单位1)

.子程序 画虚线, 空白型, , 
.参数 x, 整数型, , 
.参数 y, 整数型, , 
.参数 x1, 整数型, , 

.局部变量 a, 整数型, , , 
.局部变量 b, 整数型, , , 
.局部变量 c, 整数型, , , 


赋值 (b, x)
赋值 (c, 相加 (x, 3))
.计次循环首 (相除 (取绝对值 (相减 (x, x1)), 3), a)
    .判断开始 (小于或等于 (c, x1))
        画板1.画直线 (b, y, c, y)
        赋值 (b, 相加 (c, 2))
        赋值 (c, 相加 (c, 5))
    .默认
        画板1.画直线 (b, y, x1, y)
    .判断结束
    
.计次循环尾 ()

.程序集 程序集3, , , 

.程序集变量 边1, 双精度小数型, , , 
.子程序 画饼, 空白型, , 
.参数 和, 整数型, , 
.参数 厚变, 整数型, , 

.局部变量 中点x, 双精度小数型, , , 
.局部变量 中点y, 双精度小数型, , , 
.局部变量 a, 整数型, , , 

赋值 (中点x, 相除 (画板2., 2))
赋值 (中点y, 相加 (相除 (画板2., 2), 上下位置1))
赋值 (上点位X, 相减 (中点x, 长半径1))
赋值 (上点位Y, 中点y)
.计次循环首 (取数组成员数 (DATA1), a)
    算角 (a, 和)
    颜色 (a)
    赋值 (百分比 [a], 相乘 (相除 (DATA1 [a], 和), 100))
    .判断开始 (不等于 ( [a], 0))
        画板2.画饼 (相减 (中点x, 长半径1), 相减 (中点y, 短半径1, 厚变), 相加 (中点x, 长半径1), 相减 (相加 (中点y, 短半径1), 厚变), 四舍五入 (相减 (中点x, 相乘 (长半径1, 求余弦 (相除 (相乘 (边1, #pi), 180)))), 0), 相减 (四舍五入 (相减 (中点y, 相乘 (短半径1, 求正弦 (相除 (相乘 (边1, #pi), 180)))), 0), 厚变), 上点位X, 相减 (上点位Y, 厚变))
        赋值 (上点位X, 四舍五入 (相减 (中点x, 相乘 (长半径1, 求余弦 (相除 (相乘 (边1, #pi), 180)))), 0))
        赋值 (上点位Y, 四舍五入 (相减 (中点y, 相乘 (短半径1, 求正弦 (相除 (相乘 (边1, #pi), 180)))), 0))
    .默认
        .如果真 (不等于 (上点位Y, 四舍五入 (相减 (中点y, 相乘 (短半径1, 求正弦 (相除 (相乘 (边1, #pi), 180)))), 0)))
            画板2.画饼 (相减 (中点x, 长半径1), 相减 (中点y, 短半径1, 厚变), 相加 (中点x, 长半径1), 相减 (相加 (中点y, 短半径1), 厚变), 四舍五入 (相减 (中点x, 相乘 (长半径1, 求余弦 (相除 (相乘 (边1, #pi), 180)))), 0), 相减 (四舍五入 (相减 (中点y, 相乘 (短半径1, 求正弦 (相除 (相乘 (边1, #pi), 180)))), 0), 厚变), 上点位X, 相减 (上点位Y, 厚变))
            赋值 (上点位X, 四舍五入 (相减 (中点x, 相乘 (长半径1, 求余弦 (相除 (相乘 (边1, #pi), 180)))), 0))
            赋值 (上点位Y, 四舍五入 (相减 (中点y, 相乘 (短半径1, 求正弦 (相除 (相乘 (边1, #pi), 180)))), 0))
        .如果真结束
        
    .判断结束
    
.计次循环尾 ()

.子程序 算角, 空白型, , 
.参数 第几个, 整数型, , 
.参数 和, 整数型, , 

.局部变量 中点y, 整数型, , , 
.局部变量 a, 整数型, , , 
.局部变量 b, 整数型, , , 

赋值 (中点y, 相除 (画板2., 2))
.计次循环首 (第几个, a)
    赋值 (b, 相加 (b, DATA1 [a]))
.计次循环尾 ()
赋值 (边1, 相除 (相乘 (360, b), 和))

.子程序 颜色, 空白型, , 
.参数 第几个, 整数型, , 

.局部变量 c, 整数型, , , 
.局部变量 d, 整数型, , , 
.局部变量 e, 整数型, , , 
.局部变量 f, 整数型, , , 
.局部变量 g, 整数型, , , 
.局部变量 h, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 j, 整数型, , , 
.局部变量 k, 整数型, , , 
.局部变量 l, 整数型, , , 
.局部变量 m, 整数型, , , 
.局部变量 n, 整数型, , , 

赋值 (c, 1)
赋值 (d, 1)
赋值 (e, 1)
赋值 (f, 1)
赋值 (g, 1)
赋值 (h, 1)
赋值 (i, 1)
赋值 (j, 1)
赋值 (k, 1)
赋值 (l, 1)
赋值 (m, 1)
赋值 (n, 1)
.判断开始 (等于 (相加 (1, 相乘 (12, 相减 (c, 1))), 第几个))
    赋值 (画板2., #藏青)
    赋值 (画板2., #蓝色)
    赋值 (c, 相加 (c, 1))
.判断 (等于 (相加 (2, 相乘 (12, 相减 (d, 1))), 第几个))
    赋值 (画板2., #红褐)
    赋值 (画板2., #红色)
    赋值 (d, 相加 (d, 1))
.判断 (等于 (相加 (3, 相乘 (12, 相减 (e, 1))), 第几个))
    赋值 (画板2., 158583)
    赋值 (画板2., #黄色)
    赋值 (e, 相加 (e, 1))
.判断 (等于 (相加 (4, 相乘 (12, 相减 (f, 1))), 第几个))
    赋值 (画板2., 16384)
    赋值 (画板2., 35840)
    赋值 (f, 相加 (f, 1))
.判断 (等于 (相加 (5, 相乘 (12, 相减 (g, 1))), 第几个))
    赋值 (画板2., 19351)
    赋值 (画板2., #橙黄)
    赋值 (g, 相加 (g, 1))
.判断 (等于 (相加 (6, 相乘 (12, 相减 (h, 1))), 第几个))
    赋值 (画板2., 6684774)
    赋值 (画板2., #品红)
    赋值 (h, 相加 (h, 1))
.判断 (等于 (相加 (7, 相乘 (12, 相减 (i, 1))), 第几个))
    赋值 (画板2., 2903296)
    赋值 (画板2., #青绿)
    赋值 (i, 相加 (i, 1))
.判断 (等于 (相加 (8, 相乘 (12, 相减 (j, 1))), 第几个))
    赋值 (画板2., 4587590)
    赋值 (画板2., #紫红)
    赋值 (j, 相加 (j, 1))
.判断 (等于 (相加 (9, 相乘 (12, 相减 (k, 1))), 第几个))
    赋值 (画板2., 11184810)
    赋值 (画板2., 12961221)
    赋值 (k, 相加 (k, 1))
.判断 (等于 (相加 (10, 相乘 (12, 相减 (l, 1))), 第几个))
    赋值 (画板2., 4210688)
    赋值 (画板2., #深青)
    赋值 (l, 相加 (l, 1))
.判断 (等于 (相加 (11, 相乘 (12, 相减 (m, 1))), 第几个))
    赋值 (画板2., 6776679)
    赋值 (画板2., 8421504)
    赋值 (m, 相加 (m, 1))
.判断 (等于 (相加 (12, 相乘 (12, 相减 (n, 1))), 第几个))
    赋值 (画板2., 5929050)
    赋值 (画板2., #灰绿)
    赋值 (n, 相加 (n, 1))
.默认
    
.判断结束


.窗口程序集 窗口程序集1, , , 

.子程序 _窗口1_创建完毕, 空白型, , 


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 a, 整数型, , "3", 
.局部变量 b, 文本型, , "3", 

椭圆初始化 (10, 100, 100, “吨”, 50)
赋值 (a [1], 500)
赋值 (a [2], 500)
赋值 (a [3], 5)
赋值 (b [1], “上海”)
赋值 (b [2], “北京”)
赋值 (b [3], “天津”)
暂停 ()
画圆饼 (a, b)



 ' 不属于任何一个程序集、类模块的函数：
