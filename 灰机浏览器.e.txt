 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 1269
    高度 = 925
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\灰机浏览器.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “灰机浏览器V3.0”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 226
    高度 = 182
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于”
    帮助文件名 = “”

窗口 窗口2
    左边 = 50
    顶边 = 50
    宽度 = 496
    高度 = 297
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 窗口3
    左边 = 50
    顶边 = 50
    宽度 = 173
    高度 = 92
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 窗口4
    左边 = 50
    顶边 = 50
    宽度 = 160
    高度 = 106
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “警告”
    帮助文件名 = “”



.图片 文件夹, " ' 已保存到：D:\易语言学习\Data\灰机浏览器.e\文件夹", , 
.图片 文件, " ' 已保存到：D:\易语言学习\Data\灰机浏览器.e\文件", , 
.图片 谢, " ' 已保存到：D:\易语言学习\Data\灰机浏览器.e\谢", , 
.图片 默认图标, " ' 已保存到：D:\易语言学习\Data\灰机浏览器.e\默认图标", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' HtmlView 5014D8FA6DCA40b68FA626D8183666EB 2 0 超文本浏览框支持库
 ' shell 52F260023059454187AF826A3C07AF2A 3 0 操作系统界面功能支持库
 ' spec A512548E76954B6E92C21055517615B0 3 0 特殊功能支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 3 0 应用接口支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 2 0 扩展界面支持库二
 ' internet 707ca37322474f6ca841f0e224f4b620 2 0 互联网支持库




数据类型 网址, , 
    .成员 菜单编号, 空白型, , , 
    .成员 URL, 文本型, , , 

数据类型 IconDir, , 
    .成员 idReserved, 短整数型, , , 保留
    .成员 idType, 短整数型, , , 图标类型：1、图标；2、光标
    .成员 idCount, 短整数型, , , 图标数量
    .成员 idEntries, IconDirEntry, , "1", idEntries 的内存分配总量=tagIconDir.idCount * SizeOf(tagIconDirEntry)

数据类型 IconDirEntry, , 16
    .成员 bWidth, 字节型, , , 图标图片的显示宽度
    .成员 bHeight, 字节型, , , 图标图片的显示高度
    .成员 bColorCount, 字节型, , , 图标图片的颜色数
    .成员 bReserved, 字节型, , , 保留域总是 0
    .成员 wPlanes, 短整数型, , , 图标图片的位面数
    .成员 wBitCount, 短整数型, , , 图标图片的颜色深度
    .成员 dwBytesInRes, 整数型, , , 图标图片占用的数据量
    .成员 dwImageOffset, 整数型, , , 图标图片的开始位置

数据类型 IconImage, , 
    .成员 icHeader, BITMAPINFOHEADER, , , 
    .成员 bmiColors, RGBQUAD, , , 4字节
    .成员 icXOR, 空白型, , , 
    .成员 icAND, 空白型, , , 

数据类型 RGBQUAD, , 
    .成员 rgbBlue, 空白型, , , 
    .成员 rgbGreen, 空白型, , , 
    .成员 rgbRed, 空白型, , , 
    .成员 rgbReserved, 空白型, , , 

数据类型 BITMAPINFOHEADER, , 40
    .成员 biSize, 空白型, , , 
    .成员 biWidth, 空白型, , , 
    .成员 biHeight, 空白型, , , 
    .成员 biPlanes, 短整数型, , , 
    .成员 biBitCount, 短整数型, , , 
    .成员 biCompression, 空白型, , , 
    .成员 biSizeImage, 空白型, , , 
    .成员 biXPelsPerMeter, 空白型, , , 
    .成员 biYPelsPerMeter, 空白型, , , 
    .成员 biClrUsed, 空白型, , , 
    .成员 biClrImportant, 空白型, , , 


.DLL命令 取子菜单句柄API, 整数型, "", "GetSubMenu", , 
    .参数 菜单句柄, 整数型, , 
    .参数 位置, 整数型, , 

.DLL命令 插入菜单项API, 逻辑型, "", "InsertMenuA", , 
    .参数 菜单句柄, 整数型, , 
    .参数 位置, 整数型, , 
    .参数 标志, 整数型, , 
    .参数 ID, 整数型, , 
    .参数 标题, 文本型, , 

.DLL命令 创建弹出菜单API, 整数型, "", "CreatePopupMenu", , 

.DLL命令 取菜单句柄API, 整数型, "", "GetMenu", , 取指定窗口的菜单条句柄
    .参数 窗口句柄, 整数型, , 

.DLL命令 GetWindowLong, 子程序指针, "", "GetWindowLongA", , 
    .参数 窗口句柄, 整数型, , 
    .参数 要取的特征, 整数型, , 

.DLL命令 SetWindowLong, 子程序指针, "", "SetWindowLongA", , 
    .参数 窗口句柄, 整数型, , 
    .参数 要置的特征, 整数型, , 
    .参数 新特征, 子程序指针, , 仅易语言3.0支持

.DLL命令 CallWindowProc, 整数型, "", "CallWindowProcA", , 
    .参数 程序指针, 子程序指针, , 
    .参数 窗口句柄, 整数型, , 
    .参数 消息, 整数型, , 
    .参数 参数1, 整数型, , 
    .参数 参数2, 整数型, , 

.DLL命令 添加菜单图标API, 逻辑型, "", "SetMenuItemBitmaps", , 
    .参数 菜单句柄, 整数型, , 
    .参数 位置, 整数型, , 
    .参数 标志, 整数型, , 
    .参数 未选图标句柄, 整数型, , 
    .参数 已选图标句柄, 空白型, , 

.DLL命令 整理收藏夹API, 整数型, "shdocvw.dll", "DoOrganizeFavDlg", , 
    .参数 hwnd, 整数型, , 
    .参数 root, 文本型, , 

.DLL命令 添加到收藏夹API, 整数型, "shdocvw.dll", "DoAddToFavDlg", , 
    .参数 hwnd, 整数型, , 
    .参数 网址, 文本型, , 
    .参数 缓存大小, 整数型, , 
    .参数 标题, 文本型, , 
    .参数 缓存, 整数型, , 
    .参数 pid, 整数型, , 

.DLL命令 取收藏夹PID, 整数型, "shell32.dll", "SHGetSpecialFolderLocation", , 
    .参数 hwnd, 整数型, , 
    .参数 type, 整数型, , 
    .参数 pid, 整数型, 传址, 

.DLL命令 IE6DoOrganizeFavDlg, 整数型, "shdocvw.dll", "DoOrganizeFavDlg", , 
    .参数 hwnd, 整数型, , 
    .参数 root, 文本型, , 

.DLL命令 IE8DoOrganizeFavDlg, 整数型, "ieframe.dll", "DoOrganizeFavDlg", , 
    .参数 hwnd, 整数型, , 
    .参数 root, 文本型, , 

.DLL命令 清除PID, 整数型, "ole32.dll", "CoTaskMemFree", , 
    .参数 pid, 整数型, , 

.DLL命令 DrawIcon, 逻辑型, "", "DrawIcon", , 
    .参数 hDC, 空白型, , 
    .参数 x, 空白型, , 
    .参数 y, 空白型, , 
    .参数 hIcon, 空白型, , 

.DLL命令 GetDC, 整数型, "", "GetDC", , 
    .参数 hWnd, 空白型, , 

.DLL命令 ReleaseDC, 整数型, "", "ReleaseDC", , 
    .参数 hWnd, 整数型, , 
    .参数 hDC, 整数型, , 

.DLL命令 DeleteObject, 逻辑型, "", "", , 
    .参数 hObject, 整数型, , 

.DLL命令 DrawIconEx, 整数型, "", "DrawIconEx", , 
    .参数 hdc, 空白型, , 
    .参数 xLeft, 空白型, , 
    .参数 yTop, 空白型, , 
    .参数 hIcon, 空白型, , 
    .参数 cxWidth, 空白型, , 
    .参数 cyWidth, 空白型, , 
    .参数 istepIfAniCur, 空白型, , 
    .参数 hbrFlickerFreeDraw, 空白型, , 
    .参数 diFlags, 空白型, , 

.DLL命令 CopyMemory, 空白型, "", "RtlMoveMemory", , 
    .参数 Destination, IconDirEntry, , 
    .参数 Source, 字节集, , 
    .参数 cbCopy, 整数型, , 

.DLL命令 CreateIconFromResource, 整数型, "", "CreateIconFromResource", , 
    .参数 presbits, 字节集, , 
    .参数 dwResSize, 空白型, , 
    .参数 fIcon, 逻辑型, , 
    .参数 dwVer, 空白型, , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 窗口句柄, 空白型, , , 
.程序集变量 菜单条, 空白型, , , 
.程序集变量 收藏菜单, 空白型, , , 
.程序集变量 收藏夹路径, 文本型, , , 
.程序集变量 网址数组, 网址, , "0", 
.程序集变量 回调指针, 子程序指针, , , 
.程序集变量 图标句柄2, 空白型, , , 
.程序集变量 图片对象2, 对象, , , 
.程序集变量 图片对象, 对象, , , 
.程序集变量 xmlHTTP, 对象, , , 
.程序集变量 缓存地址, 文本型, , , 
.程序集变量 图标句柄, 整数型, , , 
.程序集变量 菜单编号, 整数型, , , 
.子程序 __启动窗口_将被销毁, 空白型, , 
SetWindowLong (窗口句柄, -4, 回调指针) ' 窗口销毁前置回原来的消息处理程序
结束 ()
删除文件 (“C:\浏览器文件.txt”)
.如果真 (不等于 (图标句柄, 0))
    DeleteObject (图标句柄)
.如果真结束



.子程序 __启动窗口_首次激活, 空白型, , 

.如果真 (图片对象.创建图片对象 (#文件夹))
    赋值 (图标句柄, 图片对象.读数值属性 (“handle”, ))
.如果真结束
.如果真 (图片对象2.创建图片对象 (#文件))
    赋值 (图标句柄2, 图片对象2.读数值属性 (“handle”, ))
.如果真结束
赋值 (菜单编号, 8000) ' 不能与易菜单编号有冲突
赋值 (窗口句柄, _启动窗口.取窗口句柄 ())
赋值 (收藏夹路径, 未知支持库函数_7 (#))
收藏夹加入菜单 ()
赋值 (回调指针, SetWindowLong (窗口句柄, -4, &拦截消息))


.子程序 收藏夹加入菜单, 空白型, , 
赋值 (菜单条, 取菜单句柄API (窗口句柄))
赋值 (收藏菜单, 取子菜单句柄API (菜单条, 2))
搜索网址 (收藏夹路径, 收藏菜单, 3)

.子程序 搜索网址, 整数型, , 递归程序
.参数 路径, 文本型, , 
.参数 父菜单, 空白型, , 
.参数 序号, 空白型, , 开始插入菜单项的位置

.局部变量 文件名, 文本型, , , 
.局部变量 子菜单, 空白型, , , 
.局部变量 弹出菜单句柄, 空白型, , , 
.局部变量 当前网址, 网址, , , 

处理事件 ()

.如果真 (不等于 (取文本右边 (路径, 1), “\”))
    赋值 (路径, 相加 (路径, “\”))
.如果真结束
赋值 (文件名, 寻找文件 (相加 (路径, “*.*”), #子目录))
.判断循环首 (不等于 (文件名, “”))
    处理事件 ()
    .如果真 (不等于 (取文本左边 (文件名, 1), “.”))
        赋值 (弹出菜单句柄, 创建弹出菜单API ())
        赋值 (子菜单, 搜索网址 (相加 (路径, 文件名), 弹出菜单句柄, 0)) ' 递归调用
        插入菜单项API (父菜单, 序号, 相加 (1024, 16), 子菜单, 文件名) ' 加16表示插入的是一个弹出菜单
        添加菜单图标API (父菜单, 序号, 1024, 图标句柄, 图标句柄)
        赋值 (序号, 相加 (序号, 1))
    .如果真结束
    赋值 (文件名, 寻找文件 (#子目录))
.判断循环尾 ()
赋值 (文件名, 寻找文件 (相加 (路径, “*.url”), ))
.判断循环首 (不等于 (文件名, “”))
    处理事件 ()
    赋值 (当前网址.URL, 读配置项 (相加 (路径, 文件名), “InternetShortcut”, “URL”, ))
    赋值 (当前网址.菜单编号, 菜单编号)
    加入成员 (网址数组, 当前网址)
    赋值 (文件名, 子文本替换 (文件名, “.url”, , , , 假))
    插入菜单项API (父菜单, 序号, 1024, 菜单编号, 截短菜单名 (文件名))
    添加菜单图标API (父菜单, 序号, 1024, 图标句柄2, 图标句柄2)
    赋值 (序号, 相加 (序号, 1))
    赋值 (菜单编号, 相加 (菜单编号, 1))
    赋值 (文件名, 寻找文件 ())
.判断循环尾 ()
返回 (父菜单)


.子程序 截短菜单名, 文本型, , 截为50~51的字节长度
.参数 菜单名, 文本型, , 

.局部变量 长度, 整数型, , , 
.局部变量 i, 整数型, , , 

赋值 (长度, 取文本长度 (菜单名))
.如果真 (小于或等于 (长度, 50))
    返回 (菜单名)
.如果真结束
赋值 (i, 1)
.判断循环首 (小于或等于 (i, 长度))
    .如果 (小于 (取代码 (菜单名, i), 0)) ' 为汉字
        赋值 (i, 相加 (i, 2))
    .否则
        赋值 (i, 相加 (i, 1))
    .如果结束
    .如果真 (大于 (i, 50))
        跳出循环 ()
    .如果真结束
    
.判断循环尾 ()
返回 (相加 (取文本左边 (菜单名, 相减 (i, 1)), “...”))

.子程序 拦截消息, 整数型, , 不要修改该子程序的返回值及参数的类型！
.参数 句柄, 整数型, , 
.参数 消息, 整数型, , 
.参数 参数1, 整数型, , 
.参数 参数2, 整数型, , 

.局部变量 H, 空白型, , , 
.局部变量 L, 空白型, , , 
.局部变量 n, 空白型, , , 
.局部变量 url, 文本型, , , 



.判断开始 (等于 (消息, 279)) ' WM_INITMENUPOPUP
     ' 输出调试文本 (参数1, 参数2, “-”)
    .如果真 (不等于 (菜单条, 取菜单句柄API (窗口句柄))) ' 易的菜单属性一改变,就会销毁原菜单,所以一检测与原来的不同,就要重新添加收藏夹
        收藏夹加入菜单 ()
    .如果真结束
    
.判断 (等于 (消息, 273)) ' WM_COMMAND
    .计次循环首 (取数组成员数 (网址数组), n)
        .如果真 (等于 (网址数组 [n], 菜单编号, 参数1))
            网址数组.未知支持库函数_1 ( [n], URL, , )
            跳出循环 ()
            
        .如果真结束
        处理事件 ()
    .计次循环尾 ()
    
.判断 (等于 (消息, 287)) ' WM_MENUSELECT 用户选择一条菜单项
    赋值 (L, 取16低位 (参数1))
    
    .计次循环首 (取数组成员数 (网址数组), n)
        .如果 (等于 (网址数组 [n], 菜单编号, L))
            赋值 (url, 网址数组 [n], URL)
            跳出循环 ()
        .否则
            赋值 (url, “”)
        .如果结束
        处理事件 ()
    .计次循环尾 ()
.默认
    
.判断结束
返回 (CallWindowProc (回调指针, 窗口句柄, 消息, 参数1, 参数2)) ' 把不需要处理的消息传递给默认窗口处理程序，使窗口能正常响应消息


.子程序 取16低位, 整数型, , 
.参数 被拆分的整数, 整数型, , 要被拆分的整数。

返回 (位与 (被拆分的整数, 65535))

.子程序 _菜单项_被选择, 空白型, , 
赋值 (.禁止, 真) ' 测试菜单属性改变,重新加入收藏夹

.子程序 _添加到收藏夹_被选择, 空白型, , 
.局部变量 pid, 整数型, , , 
.局部变量 写入路径, 文本型, , , 
.局部变量 网站名称, 文本型, , , 

赋值 (写入路径, 取空白文本 (256))
赋值 (网站名称, .)
.如果真 (或者 (等于 (网站名称, “”), 等于 (., “about:blank”)))
    返回 ()
.如果真结束
取收藏夹PID (取窗口句柄 (), 6, pid)
.如果真 (等于 (添加到收藏夹API (取窗口句柄 (), 写入路径, 256, 网站名称, 256, pid), 1))
    .如果真 (写配置项 (写入路径, “InternetShortcut”, “URL”, .))
        赋值 (.禁止, 取反 (.禁止)) ' 让易重建菜单
        信息框 (“已经添加到收藏夹”, #信息图标, )
    .如果真结束
    
.如果真结束
清除PID (pid)


.子程序 _整理收藏夹_被选择, 空白型, , 
.局部变量 IE版本号, 文本型, , , 

赋值 (IE版本号, 未知支持库函数_34 ())
.如果 (等于 (取文本左边 (IE版本号, 1), “8”))
    IE8DoOrganizeFavDlg (取窗口句柄 (), 未知支持库函数_7 (#))
.否则
    IE6DoOrganizeFavDlg (取窗口句柄 (), 未知支持库函数_7 (#))
.如果结束



.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (_启动窗口., 0)
赋值 (_启动窗口., 10)
赋值 (_启动窗口., 800)
赋值 (_启动窗口., 900)
.如果 (文件是否存在 (“D:\浏览器文件.txt”))
    正式跳转 ()
.否则
    #.未知支持库函数_0 ()
.如果结束
__启动窗口_尺寸被改变 ()
.如果真 (等于 (xmlHTTP.创建 (“MSXML2.XMLHTTP”, ), 假))
    .如果真 (等于 (xmlHTTP.创建 (“Microsoft.XMLHTTP”, ), 假))
        信息框 (“创建对象失败”, 0, )
    .如果真结束
    
.如果真结束
赋值 (图标句柄, 取图标句柄 (#默认图标))
取网站图标 (删首尾空 (.内容))

.子程序 正式跳转, 空白型, , 
赋值 (., 到文本 (读入文件 (“D:\浏览器文件.txt”)))
延迟 (200)
删除文件 (“C:\浏览器文件.txt”)


.子程序 _按钮1_被单击, 空白型, , 
写到文件 (“D:\浏览器文件.txt”, 到字节集 (.内容))
运行 (相加 (取运行目录 (), “\”, 取执行文件名 ()), 假, )


.子程序 _按钮2_被单击, 空白型, , 
写到文件 (“D:\浏览器文件.txt”, 到字节集 (相加 (“http://www.baidu.com/s?wd=”, .内容)))
运行 (相加 (取运行目录 (), “\”, 取执行文件名 ()), 假, )

.子程序 _超文本浏览框1_跳转完毕, 空白型, , 
赋值 (_启动窗口., .)
赋值 (.时钟周期, 100)
取网站图标 (删首尾空 (.内容))


.子程序 _超文本浏览框1_即将打开新窗口, 逻辑型, , 
写到文件 (“D:\浏览器文件.txt”, 到字节集 (.))
运行 (相加 (取运行目录 (), “\”, 取执行文件名 ()), 假, )
返回 (假)

.子程序 _按钮5_被单击, 空白型, , 
#.未知支持库函数_0 ()

.子程序 _按钮6_被单击, 空白型, , 
#.未知支持库函数_0 ()

.子程序 _按钮9_被单击, 空白型, , 
#.未知支持库函数_0 ()

.子程序 _打印本页_被选择, 空白型, , 
#.未知支持库函数_0 ()

.子程序 _网页另存为_被选择, 空白型, , 
#.未知支持库函数_0 ()

.子程序 _编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (等于 (键代码, #回车键))
    赋值 (., .内容)
.默认
    
.判断结束


.子程序 _编辑框2_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (等于 (键代码, #回车键))
    赋值 (., 相加 (“http://www.baidu.com/s?wd=”, .内容))
.默认
    
.判断结束


.子程序 __启动窗口_可否被关闭, 逻辑型, , 
删除文件 (“D:\浏览器文件.txt”)

.子程序 系统_设置为默认浏览器, 空白型, , 如：自己做了个易语言浏览器，可以用这句设置成默认的；
.参数 文件名绝对路径, 文本型, 可空, 可空:如果留空将设置本程序为默认浏览器;浏览器的可执行文件路径；
.参数 类型, 整数型, 可空, 可空:默认为0,0=设置指定或本程序为默认浏览器,1=设置IE为默认浏览器;

.如果 (等于 (类型, 0))
    .如果 (等于 (是否为空 (文件名绝对路径), 真))
        写注册项 (1, “htmlfile\shell\”, “e”)
        写注册项 (1, “htmlfile\shell\e\command\”, 相加 (取运行目录 (), “\”, 取执行文件名 (), “ ”, “%1”))
        写注册项 (1, “HTTP\shell\”, “e”)
        写注册项 (1, “HTTP\shell\e\command\”, 相加 (取运行目录 (), “\”, 取执行文件名 (), “ ”, “%1”))
        写注册项 (1, “https\shell\”, “e”)
        写注册项 (1, “https\shell\e\command\”, 相加 (取运行目录 (), “\”, 取执行文件名 (), “ ”, “%1”))
        写注册项 (1, “InternetShortcut\shell\”, “e”)
        写注册项 (1, “InternetShortcut\shell\e\command\”, 相加 (取运行目录 (), “\”, 取执行文件名 (), “ ”, “%1”))
        写注册项 (1, “mhtmlfile\shell\”, “e”)
        写注册项 (1, “mhtmlfile\shell\e\command\”, 相加 (取运行目录 (), “\”, 取执行文件名 (), “ ”, “%1”))
        
    .否则
        写注册项 (1, “htmlfile\shell\”, “e”)
        写注册项 (1, “htmlfile\shell\e\command\”, 相加 (文件名绝对路径, “ ”, “%1”))
        写注册项 (1, “HTTP\shell\”, “e”)
        写注册项 (1, “HTTP\shell\e\command\”, 相加 (文件名绝对路径, “ ”, “%1”))
        写注册项 (1, “https\shell\”, “e”)
        写注册项 (1, “https\shell\e\command\”, 相加 (文件名绝对路径, “ ”, “%1”))
        写注册项 (1, “InternetShortcut\shell\”, “e”)
        写注册项 (1, “InternetShortcut\shell\e\command\”, 相加 (文件名绝对路径, “ ”, “%1”))
        写注册项 (1, “mhtmlfile\shell\”, “e”)
        写注册项 (1, “mhtmlfile\shell\e\command\”, 相加 (文件名绝对路径, “ ”, “%1”))
    .如果结束
    
.否则
    写注册项 (1, “htmlfile\shell\”, “open”)
    写注册项 (1, “HTTP\shell\”, “open”)
    写注册项 (1, “https\shell\”, “open”)
    写注册项 (1, “InternetShortcut\shell\”, “open”)
    写注册项 (1, “mhtmlfile\shell\”, “open”)
.如果结束


.子程序 _设为默认浏览器_被选择, 整数型, , 
系统_设置为默认浏览器 ()

.子程序 _清除临时文件_被选择, 空白型, , 
未知支持库函数_26 ()

.子程序 _删除历史记录_被选择, 空白型, , 
未知支持库函数_27 ()

.子程序 _标准按钮工具条_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.判断开始 (等于 (按钮索引, 1))
    #.未知支持库函数_0 ()
.判断 (等于 (按钮索引, 2))
    #.未知支持库函数_0 ()
.判断 (等于 (按钮索引, 3))
    #.未知支持库函数_0 ()
.判断 (等于 (按钮索引, 4))
    #.未知支持库函数_0 ()
.判断 (等于 (按钮索引, 5))
    #.未知支持库函数_0 ()
.判断 (等于 (按钮索引, 7))
    #.未知支持库函数_0 ()
.默认
    
.判断结束


.子程序 _Internet选项_被选择, 空白型, , 
运行 (相加 (未知支持库函数_7 (#), “control.exe inetcpl.cpl”), 真, )

.子程序 _关于_被选择, 空白型, , 
载入 (窗口1, , 真)

.子程序 _时钟2_周期事件, 空白型, , 
赋值 (.内容, .)

.子程序 _超文本浏览框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.内容, .)

.子程序 _超级编辑框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (不等于 (.时钟周期, 0))
    赋值 (.时钟周期, 0)
.否则
    
.如果结束


.子程序 _新建空白窗口_被选择, 空白型, , 
写到文件 (“D:\浏览器文件.txt”, 到字节集 (“about:blank”))
运行 (相加 (取运行目录 (), “\”, 取执行文件名 ()), 假, )

.子程序 _新建窗口_被选择, 空白型, , 
运行 (相加 (取运行目录 (), “\”, 取执行文件名 ()), 假, )

.子程序 _一键修复IE_被选择, 空白型, , 
载入 (窗口4, , 真)

.子程序 __启动窗口_尺寸被改变, 空白型, , 
赋值 (.宽度, 相减 (_启动窗口., .宽度, 2, .宽度, .宽度, 60))
赋值 (.左边, 相加 (.宽度, .宽度))
赋值 (.左边, .宽度)
赋值 (.左边, 相加 (.宽度, .宽度, .宽度))
赋值 (.顶边, .顶边)
赋值 (.高度, .高度)
赋值 (.左边, 相加 (.左边, .宽度, 2))
赋值 (.左边, 相减 (_启动窗口., 80))
赋值 (., 相减 (取用户区高度 (), 100))
赋值 (., 相减 (_启动窗口., 15))
赋值 (., 0)
赋值 (.顶边, 相加 (., 78))
赋值 (.左边, 0)
赋值 (.宽度, _启动窗口.)
赋值 (.左边, 相减 (.宽度, 115))
赋值 (.顶边, 相加 (.顶边, 2))
赋值 (.左边, 相减 (.左边, 56))
赋值 (.顶边, .顶边)
赋值 (.顶边, .顶边)
赋值 (.顶边, .顶边)
取网站图标 (删首尾空 (.内容))

.子程序 _时钟1_周期事件, 空白型, , 
.如果 (小于 (_启动窗口., 900))
    赋值 (_启动窗口., 900)
.否则
    
.如果结束
.如果 (小于 (_启动窗口., 800))
    赋值 (_启动窗口., 800)
.否则
    
.如果结束


.子程序 _超文本浏览框1_载入进度改变, 空白型, , 
.参数 进度百分比, 整数型, , 

赋值 (.位置, 进度百分比)

.子程序 _编辑框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (等于 (键代码, #回车键))
    赋值 (., .内容)
.默认
    
.判断结束


.子程序 _编辑框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (.时钟周期, 0))
    
.否则
    赋值 (.时钟周期, 0)
.如果结束


.子程序 _离线浏览_被选择, 空白型, , 
赋值 (., 真)

.子程序 _关闭离线浏览_被选择, 空白型, , 
赋值 (., 假)

.子程序 _超文本浏览框1_状态文本被改变, 空白型, , 
赋值 (.标题, .)

.子程序 取网站图标, 空白型, , By:(彬)泪闯天涯
.参数 Url, 文本型, , 

.局部变量 IcoUrl, 文本型, , , 
.局部变量 z, 整数型, , , 
.局部变量 ico, 字节集, , , 
.局部变量 bstrBody, 变体型, , , 
.局部变量 Content_Type, 文本型, , , 

.如果真 (等于 (删首尾空 (Url), “”))
    返回 ()
.如果真结束
赋值 (IcoUrl, 子文本替换 (Url, “http://”, “”, , 1, 假))
赋值 (z, 寻找文本 (IcoUrl, “/”, , 假))
.如果真 (不等于 (z, -1))
    赋值 (IcoUrl, 取文本左边 (IcoUrl, z))
.如果真结束
.如果 (等于 (缓存地址, IcoUrl))
    返回 ()
.否则
    赋值 (缓存地址, IcoUrl)
.如果结束
赋值 (IcoUrl, 相加 (“http://”, IcoUrl, “/favicon.ico”))
xmlHTTP.方法 (“open”, “GET”, IcoUrl, 假)
xmlHTTP.方法 (“send”, )
赋值 (Content_Type, xmlHTTP.文本方法 (“getResponseHeader”, “Content-Type”))
.如果 (或者 (等于 (Content_Type, “image/x-icon”), 等于 (Content_Type, “application/octet-stream”)))
    赋值 (bstrBody, xmlHTTP.读属性 (“responseBody”, ))
    赋值 (ico, bstrBody.取字节集 ())
.否则
    赋值 (ico, #默认图标)
.如果结束
 ' ------------------------------------
.如果真 (不等于 (图标句柄, 0))
    DeleteObject (图标句柄)
.如果真结束
赋值 (图标句柄, 取图标句柄 (ico))
重画 ()

.子程序 取图标句柄, 整数型, , By:凌晨孤星
.参数 图标数据, 字节集, , 

.局部变量 IconDirEntry, IconDirEntry, , , 
.局部变量 hIcon, 整数型, , , 
.局部变量 nNum, 整数型, , , 
.局部变量 i, 整数型, , , 

赋值 (nNum, 取字节集数据 (图标数据, #短整数型, 5))
.计次循环首 (nNum, i)
    CopyMemory (IconDirEntry, 取字节集中间 (图标数据, 相加 (6, 相乘 (相减 (i, 1), 16), 1), 16), 16)
    .如果真 (等于 (IconDirEntry.bWidth, 16))
        赋值 (hIcon, CreateIconFromResource (取字节集中间 (图标数据, 相加 (IconDirEntry.dwImageOffset, 1), IconDirEntry.dwBytesInRes), IconDirEntry.dwBytesInRes, 真, 196608))
        返回 (hIcon)
    .如果真结束
    
.计次循环尾 ()
CopyMemory (IconDirEntry, 取字节集中间 (图标数据, 相加 (6, 1), 16), 16)
赋值 (hIcon, CreateIconFromResource (取字节集中间 (图标数据, 相加 (IconDirEntry.dwImageOffset, 1), IconDirEntry.dwBytesInRes), IconDirEntry.dwBytesInRes, 真, 196608))
返回 (hIcon)

.子程序 _画板1_绘画, 空白型, , By:(彬)泪闯天涯
.参数 重画区左边, 整数型, , 
.参数 重画区上边, 整数型, , 
.参数 重画区右边, 整数型, , 
.参数 重画区下边, 整数型, , 

.清除 ()
DrawIconEx (取设备句柄 (), 0, 0, 图标句柄, 16, 16, 0, 0, 位或 (0, 3))

.子程序 _超文本浏览框1_即将跳转, 逻辑型, , 
取网站图标 (删首尾空 (.内容))

.子程序 _退出_被选择, 空白型, , 
_启动窗口.销毁 ()


.窗口程序集 窗口程序集2, , , 

.子程序 _按钮1_被单击, 空白型, , 
载入 (窗口2, , 真)
窗口1.销毁 ()


.窗口程序集 窗口程序集3, , , 

.子程序 _按钮1_被单击, 空白型, , 
.如果 (未知支持库函数_0 (.内容, 25, .内容, .内容, 10000))
    发送 ()
.否则
    信息框 (“出错啦！”, #错误图标, “错误”)
.如果结束


.子程序 发送, 空白型, , 
未知支持库函数_5 (相加 (“帐号:”, .内容, “,提建议啦！”), .内容, “1000363@163.com”, , , .内容, .内容)
载入 (窗口3, , 真)

.子程序 _窗口2_创建完毕, 空白型, , 
窗口1.销毁 ()

.窗口程序集 窗口程序集4, , , 

.子程序 _窗口3_创建完毕, 空白型, , 
赋值 (.图片, #谢)
窗口2.销毁 ()


.窗口程序集 窗口程序集5, , , 

.子程序 _按钮2_被单击, 空白型, , 
窗口4.销毁 ()


.子程序 _按钮1_被单击, 空白型, , 
 ' 写注册项 (#本地机器, “SOFTWARE\Microsoft\InternetExplorer\Main\StartPage”, “about:blank”)
 ' 写注册项 (#本地机器, “Software\Microsoft\InternetExplorer\Main\StartPage”, “about:blank”)

 ' 删除注册项 (#本地机器, “Software\Microsoft\Windows\CurrentVersion\Run\egistry.exe”)

写注册项 (#本地机器, “Software\Microsoft\InternetExplorer\Main\Default_Page_URL\Default_Page_URL”, “0”)
 ' 写注册项 (#本地机器, “Software\Policies\Microsoft\InternetExplorer\ControlPanel\Settings”, “0”)
 ' 写注册项 (#本地机器, “Software\Policies\Microsoft\InternetExplorer\ControlPanel\Links”, “0”)
写注册项 (#本地机器, “Software\Policies\Microsoft\InternetExplorer\ControlPanel\SecAddSites”, “0”)
 ' 写注册项 (#本地机器, “DEFAULT\Software\Policies\Microsoft\InternetExplorer\ControlPanel\homepage”, “0”)

 ' 删除注册项 (#本地机器, “SOFTWARE\Microsoft\InternetExplorer\Main\WindowTitle”)

 ' 删除注册项 (#本地机器, “Software\Microsoft\InternetExplorer\Main\WindowTitle”)

 ' 写注册项 (#本地机器, “Software\Microsoft\Windows\CurrentVersion\Policies\System\DisableRegistryTools”, “0”)

窗口4.销毁 ()



 ' 不属于任何一个程序集、类模块的函数：
