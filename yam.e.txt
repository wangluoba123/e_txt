 ' 文件类型：Windows模块源码

 ' 程序名称：统计
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 统计窗口
    左边 = 50
    顶边 = 50
    宽度 = 769
    高度 = 536
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\yam.e\统计窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “服务统计窗口”
    帮助文件名 = “”



.常量 自定义提示, "“襄樊阔天科技提示：”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' eDB 46E94341933A462383A4DE26B146322C 2 3 数据库操作支持库
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 2 6 高级表格支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一





.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。


.子程序 统计服务程序, 空白型, 公开, 
载入 (统计窗口, , 真)

.窗口程序集 窗口程序集1, , , 

.程序集变量 载入组合框列表, 逻辑型, , , 
.子程序 _统计窗口_创建完毕, 空白型, , 
.局部变量 房间名列表, 文本型, , "0", 
.局部变量 a, 整数型, , , 

.如果真 (等于 (相加 (取当前目录 (), “\data.yam”).未知支持库函数_1 (“yamwfn@@@@@@@@.com”), 真))
    .未知支持库函数_12 ()
    .判断开始 (等于 (“xfqdb”.未知支持库函数_14 (#), 假))
        信息框 (“技师资料数据无法打开！请确认数据库的正确存在？”, #信息图标, #自定义提示)
    .默认
        相加 (“载入房间服务数据，根据”, #左引号, “房间号”, #右引号, “进行查询统计，打印功能！”).加入栏目 (., , , )
        清空 ()
        “全部”.加入项目 ()
        赋值 (.现行选中项, 0)
        赋值 (房间名列表, 取配置节名 (相加 (取当前目录 (), “\data\房间.ini”)))
        .计次循环首 (取数组成员数 (房间名列表), a)
            .如果真 (不等于 (房间名列表 [a], “”))
                房间名列表.加入项目 ( [a], )
            .如果真结束
             ' 本源码来自易语言资源网(www.wodesoft.com)
        .计次循环尾 ()
        载入开房资料 (“全部”)
    .判断结束
    
.如果真结束


.子程序 _统计窗口_位置被改变, 空白型, , 
赋值 (., 相减 (取用户区宽度 (), 3))
赋值 (., 相减 (取用户区高度 (), .高度, ., 8))

.子程序 载入开房资料, 空白型, , 
.参数 开房房间, 文本型, , 

.局部变量 局部_记次, 整数型, , , 
.局部变量 房间名列表, 文本型, , "0", 
.局部变量 房间号, 文本型, , , 
.局部变量 服务开始时间, 日期时间型, , , 
.局部变量 服务结束时间, 日期时间型, , , 
.局部变量 应收价格, 双精度小数型, , , 
.局部变量 实收价格, 双精度小数型, , , 
.局部变量 备注, 文本型, , , 
.局部变量 操作员, 文本型, , , 
.局部变量 a, 整数型, , , 
.局部变量 结果, 双精度小数型, , , 
.局部变量 结果1, 双精度小数型, , , 

未知支持库函数_57 ()
赋值 (., 1)
赋值 (., 相加 (., 1))
0.未知支持库函数_32 (35)
.计次循环首 (相加 (., 1), 局部_记次)
    0.未知支持库函数_9 (局部_记次, #., 相减 (局部_记次, 1).未知支持库函数_39 ())
.计次循环尾 ()
1.未知支持库函数_32 (60)
1.未知支持库函数_30 (#.)
2.未知支持库函数_30 (#.)
3.未知支持库函数_30 (#.)
4.未知支持库函数_30 (#.)
5.未知支持库函数_30 (#.)
6.未知支持库函数_30 (#.)
7.未知支持库函数_30 (#.)
4.未知支持库函数_41 (2)
5.未知支持库函数_41 (2)
未知支持库函数_34 ()
.计次循环首 (., 局部_记次)
    “房间号”.未知支持库函数_26 (房间号)
    “服务开始时间”.未知支持库函数_31 (服务开始时间)
    “服务结束时间”.未知支持库函数_31 (服务结束时间)
    “应收价格”.未知支持库函数_27 (应收价格)
    “实收价格”.未知支持库函数_27 (实收价格)
    “备注”.未知支持库函数_26 (备注)
    “操作员”.未知支持库函数_26 (操作员)
    .判断开始 (等于 (开房房间, “全部”))
        赋值 (a, 相加 (a, 1))
        到文本 (a).未知支持库函数_38 ()
        相减 (., 1).未知支持库函数_9 (1, #., 房间号)
        相减 (., 1).未知支持库函数_9 (2, #., 到文本 (服务开始时间))
        相减 (., 1).未知支持库函数_9 (3, #., 到文本 (服务结束时间))
        相减 (., 1).未知支持库函数_9 (4, #., 应收价格)
        相减 (., 1).未知支持库函数_9 (5, #., 实收价格)
        相减 (., 1).未知支持库函数_9 (6, #., 备注)
        相减 (., 1).未知支持库函数_9 (7, #., 操作员)
    .默认
        .如果真 (等于 (开房房间, 房间号))
            赋值 (a, 相加 (a, 1))
            到文本 (a).未知支持库函数_38 ()
            相减 (., 1).未知支持库函数_9 (1, #., 房间号)
            相减 (., 1).未知支持库函数_9 (2, #., 到文本 (服务开始时间))
            相减 (., 1).未知支持库函数_9 (3, #., 到文本 (服务结束时间))
            相减 (., 1).未知支持库函数_9 (4, #., 应收价格)
            相减 (., 1).未知支持库函数_9 (5, #., 实收价格)
            相减 (., 1).未知支持库函数_9 (6, #., 备注)
            相减 (., 1).未知支持库函数_9 (7, #., 操作员)
        .如果真结束
        ' 本源码来自易语言资源网(www.wodesoft.com)
    .判断结束
    未知支持库函数_36 ()
.计次循环尾 ()
“合计”.未知支持库函数_38 (.)
相减 (., 1).未知支持库函数_58 (1, 相减 (., 1), 7)
相减 (., 1).未知支持库函数_24 (1, 相减 (., 1), 7, 取颜色值 (236, 233, 216))
相减 (., 1).未知支持库函数_22 (1, 相减 (., 1), 7, #红色)
.计次循环首 (相减 (., 1), a)
    赋值 (结果, 相加 (结果, 到数值 (a.未知支持库函数_10 (4))))
    赋值 (结果1, 相加 (结果1, 到数值 (a.未知支持库函数_10 (5))))
.计次循环尾 ()
相减 (., 1).未知支持库函数_25 (1, 相减 (., 1), 7, #.)
相减 (., 1).未知支持库函数_9 (1, #., 相加 (“应收：”, 到文本 (结果), “  元    实收：”, 到文本 (结果1), “  元        ”))

.子程序 _技师统计按钮_被单击, 空白型, , 
载入开房资料 (.内容)


.子程序 _技师打印按钮_被单击, 空白型, , 
.如果真 (等于 (信息框 (“是否要在打印时添加打印表格的标题？”, 相加 (#询问图标, #是否钮), #自定义提示), #是钮))
    .判断开始 (等于 (.现行选中项, 0))
        “全部服务报表：”.未知支持库函数_46 (“宋体”, 20, 假, #.)
    .默认
        相加 (“房间名为：”, .内容, “ 的服务报表：”).未知支持库函数_46 (“宋体”, 20, 假, #.)
    .判断结束
    ' 本源码来自易语言资源网(www.wodesoft.com)
.如果真结束
未知支持库函数_27 ()



 ' 不属于任何一个程序集、类模块的函数：
