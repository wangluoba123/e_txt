 ' 文件类型：Windows窗口程序

 ' 程序名称：EEditPlus
 ' 程序描述：本程序为代码编辑框支持库的例程
 ' 程序作者：大有吴涛易语言软件公司
 ' 邮政编码：116001
 ' 联系地址：辽宁省大连市中山区人民路55号亚太国际金融中心
 ' 联系电话：+86(0411)88995831
 ' 传真号码：+86(0411)88995834
 ' 电子信箱：service@dywt.com.cn
 ' 主页地址：http://dywt.com.cn
 ' 版权声明：祝您一帆风顺，心想事成！
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 457
    高度 = 344
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = 8421504 '  0x808080
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\EEditplus.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “EEditPlus”
    帮助文件名 = “”

窗口 参数设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 472
    高度 = 341
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “配置窗口”
    帮助文件名 = “”

窗口 查找窗口
    左边 = 50
    顶边 = 50
    宽度 = 427
    高度 = 147
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “查找...”
    帮助文件名 = “”

窗口 替换窗口
    左边 = 50
    顶边 = 50
    宽度 = 413
    高度 = 187
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “替换...”
    帮助文件名 = “”

窗口 定位窗口
    左边 = 50
    顶边 = 50
    宽度 = 267
    高度 = 95
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “定位到...”
    帮助文件名 = “”



.常量 书签旁注, "1", , 
.常量 行号旁注, "0", , 
.常量 折叠旁注, "2", , 
.常量 , , , 
.常量 最小化, "2", , 
.常量 最大化, "3", , 
.常量 , , , 
.常量 打开类型_新文件, "1", , 
.常量 打开类型_旧文件, "2", , 
.常量 , , , 
.常量 默认字体大小, "8", , 
.常量 , , , 
.常量 更改, "1", , 
.常量 未更改, "2", , 
.常量 , , , 
.常量 书签标志号, "1", , 
.常量 行指示器标志号, "3", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' CodeStyleEdit {E5E6A8E356A843bd94609DDD678BD6D8} 1 0 代码编辑框支持库
 ' EXMLParser BE2297B7415349c8A55BC9DFEB6DD11A 1 5 XML解析支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库
 ' edroptarget {9DA96BF9CEBD45c5BFCF94CBE61671F5} 1 0 拖放支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二




数据类型 属性结构, 公开, 
    .成员 状态, 整数型, , , 
    .成员 节点序号, 整数型, , , 
    .成员 风格名称, 文本型, , , 
    .成员 风格ID, 整数型, , , 
    .成员 前景颜色, 整数型, , , 
    .成员 背景颜色, 整数型, , , 
    .成员 字体名称, 文本型, , , 
    .成员 字体风格, 整数型, , , 
    .成员 字体大小, 整数型, , , 

数据类型 语言风格结构, 公开, 
    .成员 状态, 整数型, , , 
    .成员 语言名称, 文本型, , , 
    .成员 节点序号, 整数型, , , 
    .成员 描述, 文本型, , , 
    .成员 扩展名, 文本型, , , 
    .成员 属性数组, 属性结构, , "1", 
    .成员 关键字数组, 文本型, , "1", 
    .成员 关键字, 文本型, , , 排序后的关键字列表，供自动完成使用
    .成员 分界符, 文本型, , , 自动完成时使用

数据类型 打开文件名结构, 公开, 
    .成员 结构尺寸, 整数型, , , win2k以上为88，以下为76
    .成员 拥有者窗口句柄, 整数型, , , 
    .成员 实例句柄, 整数型, , , 
    .成员 过滤器, 字节集, , , 
    .成员 自定义过滤器, 文本型, , , 
    .成员 自定义过滤器长度, 整数型, , , 
    .成员 过滤器索引, 整数型, , , 
    .成员 全路径名, 字节集, , , 
    .成员 全路径名长度, 整数型, , , 
    .成员 文件名, 文本型, , , 
    .成员 文件名长度, 整数型, , , 
    .成员 初始目录, 文本型, , , 
    .成员 标题, 文本型, , , 
    .成员 标志, 整数型, , , 
    .成员 文件部分索引, 短整数型, , , 
    .成员 扩展名部分索引, 短整数型, , , 
    .成员 默认扩展名, 整数型, , , 
    .成员 自定义数据指针, 整数型, , , 
    .成员 钩子函数指针, 整数型, , , 
    .成员 模板名称, 整数型, , , 
    .成员 pvReserved, 整数型, , , 
    .成员 dwReserved, 整数型, , , 
    .成员 FlagsEx, 整数型, , , 

数据类型 文档结构, 公开, 
    .成员 文档指针, 整数型, , , 
    .成员 文档标题, 文本型, , , 即：文件路径
    .成员 文档类型, 文本型, , , 
    .成员 打开类型, 整数型, , , 
    .成员 文档状态, 整数型, , , 1没被改变 2被改变

数据类型 常规配置信息, 公开, 
    .成员 缩进大小, 整数型, , , 
    .成员 是否使用缩进, 文本型, , , 
    .成员 行号前景色, 整数型, , , 
    .成员 行号背景色, 整数型, , , 

.全局变量 当前模式菜单, 菜单, , , 
.全局变量 常规配置信息, 常规配置信息, , , 
.全局变量 界面代理, 界面代理类, , , 
.全局变量 匿名全局变量_230, 空白型, , , 
.全局变量 查找记录数组, 文本型, , "0", 
.全局变量 最后查找文本, 文本型, , , 
.全局变量 最后查找标志, 整数型, , , 
.全局变量 匿名全局变量_1054, 空白型, , , 
.全局变量 替换记录数组, 文本型, , "0", 
.全局变量 匿名全局变量_1521, 空白型, , , 
.全局变量 风格操作对象, 风格操作类, , , 
.全局变量 匿名全局变量_2388, 空白型, , , 
.全局变量 编辑框容器, 编辑框容器类, , , 
.全局变量 文档选择控件, 文档选择控件类, , , 
.全局变量 快捷框, 快捷框类, , , 
.全局变量 状态条, 状态条, , , 
.全局变量 匿名全局变量_2389, 空白型, , , 
.全局变量 新建文件数, 整数型, , , 
.全局变量 打开文件数, 整数型, , , 
.全局变量 新文档序号, 整数型, , , 
.全局变量 默认文档指针, 整数型, , , 

.DLL命令 打开文件对话框, 逻辑型, "Comdlg32", "GetOpenFileNameA", 公开, 
    .参数 结构, 打开文件名结构, 传址, 

.DLL命令 另存文件对话框, 逻辑型, "Comdlg32", "GetSaveFileNameA", 公开, 
    .参数 结构, 打开文件名结构, 传址, 

.窗口程序集 窗口程序集1, , , 

.程序集变量 文档选择框被右键选择序号, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
界面代理.加载 ()
初始化系统配置 ()

连续赋值 (真, .可视, .可视, ., .可视, ., .可视, .可视)
赋值 (_启动窗口., #默认色)


.子程序 __启动窗口_尺寸被改变, 空白型, , 
界面代理.调整界面 (1, 相加 (_启动窗口..可视, 1), 相减 (_启动窗口., 5), 相减 (_启动窗口.取用户区高度 (), _启动窗口..可视, _启动窗口.., _启动窗口..高度, _启动窗口..高度, 2))


.子程序 _参数设置_被选择, 空白型, , 
载入 (参数设置窗口, , 真)


.子程序 _代码编辑框_更新界面, 空白型, , 
界面代理.更新状态条 ()
界面代理.更新旁注 ()
界面代理.括号加亮 ()



.子程序 _撤消_被选择, 空白型, , 
未知支持库函数_28 ()



.子程序 _重复_被选择, 空白型, , 
未知支持库函数_29 ()


.子程序 _剪切_被选择, 空白型, , 
未知支持库函数_21 ()


.子程序 _拷贝_被选择, 空白型, , 
未知支持库函数_22 ()


.子程序 _粘贴_被选择, 空白型, , 
未知支持库函数_23 ()


.子程序 _删除_被选择, 空白型, , 
未知支持库函数_24 ()



.子程序 _全选_被选择, 空白型, , 
未知支持库函数_45 ()


.子程序 _选择_被选择, 空白型, , 


.子程序 _插入_被选择, 空白型, , 


.子程序 _行号旁注_被选择, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
    界面代理.置行号旁注 (假)
.否则
    
    赋值 (.选中, 真)
    界面代理.置行号旁注 (真)
.如果结束


.子程序 _书签旁注_被选择, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
    界面代理.置书签旁注 (0)
.否则
    
    赋值 (.选中, 真)
    界面代理.置书签旁注 (5)
.如果结束


.子程序 _折叠旁注_被选择, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
    界面代理.置折叠旁注 (0)
.否则
    
    赋值 (.选中, 真)
    界面代理.置折叠旁注 (13)
.如果结束



.子程序 _显示空格和制表符号_被选择, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
    界面代理.显示空格和制表符号 (假)
.否则
    
    赋值 (.选中, 真)
    界面代理.显示空格和制表符号 (真)
.如果结束


.子程序 _显示行尾符_被选择, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
    界面代理.显示行尾符 (假)
    
.否则
    
    赋值 (.选中, 真)
    界面代理.显示行尾符 (真)
    
.如果结束


.子程序 _显示缩进向导_被选择, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
    界面代理.显示缩进向导 (假)
    
.否则
    
    赋值 (.选中, 真)
    界面代理.显示缩进向导 (真)
.如果结束




.子程序 _高亮当前行_被选择, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
    界面代理.加亮当前行 (假)
    
.否则
    
    赋值 (.选中, 真)
    界面代理.加亮当前行 (真)
.如果结束



.子程序 _自动换行_被选择, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
    界面代理.自动换行 (假)
    
.否则
    
    赋值 (.选中, 真)
    界面代理.自动换行 (真)
.如果结束



.子程序 _转换为Windows格式_被选择, 空白型, , 
界面代理.转换格式 (0)
赋值 (.禁止, 真)
赋值 (.禁止, 假)
赋值 (.禁止, 假)


.子程序 _转换为UNIX格式_被选择, 空白型, , 
界面代理.转换格式 (2)
赋值 (.禁止, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 假)


.子程序 _转换为MAC格式_被选择, 空白型, , 
界面代理.转换格式 (1)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 真)


.子程序 _ANSI_被选择, 空白型, , 
界面代理.置编码模式 (0)
赋值 (.禁止, 真)
赋值 (.禁止, 假)


.子程序 _UNICODE_被选择, 空白型, , 
界面代理.置编码模式 (1)
赋值 (.禁止, 假)
赋值 (.禁止, 真)


.子程序 _查找_被选择, 空白型, , 
载入 (查找窗口, , 假)


.子程序 _查找下一处_被选择, 空白型, , 
查找下一个 ()


.子程序 _查找上一处_被选择, 空白型, , 
查找上一个 ()


.子程序 _替换_被选择, 空白型, , 
载入 (替换窗口, , 假)


.子程序 _定位_被选择, 空白型, , 
载入 (定位窗口, , 假)


.子程序 _只读模式_被选择, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (., 假)
    赋值 (.选中, 假)
.否则
    
    赋值 (., 真)
    赋值 (.选中, 真)
.如果结束



.子程序 _代码编辑框_旁注栏被单击, 空白型, , 
.参数 功能键状态, 整数型, , 
.参数 单击位置, 整数型, , 
.参数 旁注号, 整数型, , 

.局部变量 单击行, 整数型, , , 
.局部变量 单击行层次, 整数型, , , 

赋值 (单击行, 单击位置.未知支持库函数_46 ())

.判断开始 (等于 (旁注号, #折叠旁注))
    赋值 (单击行层次, 单击行.未知支持库函数_168 ())
    
    .如果真 (大于 (位与 (单击行层次, #.), 0))
        单击行.未知支持库函数_178 ()
    .如果真结束
    
.判断 (等于 (旁注号, #书签旁注))
    界面代理.切换书签 (单击行)
.默认
    
.判断结束



.子程序 _单选框1_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (文档选择框被右键选择序号, 文档选择控件.对外_组件到序号 (取事件组件 ()))
文档选择控件.对外_选择指定项 (取事件组件 ())
编辑框容器.显示文档 (文档选择框被右键选择序号)
弹出菜单 ()


.子程序 _纵向滚动条1_位置被改变, 空白型, , 
文档选择控件.对外_翻页 ()


.子程序 _普通文本_被选择, 空白型, , 
新建文件 (“txt”)


.子程序 _关闭_被选择, 空白型, , 
关闭指定文件 (-1)


.子程序 _单选框1_被单击, 空白型, , 
文档选择控件.对外_选择指定项 (取事件组件 ())
文档被选择 (文档选择控件.对外_组件到序号 (取事件组件 ()))


.子程序 _关闭当前文档_被选择, 空白型, , 
关闭指定文件 (1)


.子程序 _打开_被选择, 空白型, , 
.局部变量 文件名, 文本型, , , 

赋值 (文件名, 打开指定文件对话框 ())
.如果真 (等于 (文件名, “”))
    返回 ()
.如果真结束

打开指定文件 (文件名)


.子程序 打开指定文件对话框, 文本型, 公开, 
.局部变量 结构, 打开文件名结构, , , 

赋值 (结构.结构尺寸, 76)
赋值 (结构.拥有者窗口句柄, _启动窗口.取窗口句柄 ())
赋值 (结构.实例句柄, 0)
赋值 (结构.过滤器, 相加 (到字节集 (“文本文件(*.txt)”), { 0 }, 到字节集 (“*.txt”), { 0 }, 到字节集 (“C语言源文件(*.c)”), { 0 }, 到字节集 (“*.c”), { 0 }, 到字节集 (“C++语言源文件(*.cpp)”), { 0 }, 到字节集 (“*.cpp”), { 0 }, 到字节集 (“Perl语言源文件(*.pl)”), { 0 }, 到字节集 (“*.pl;*.pm”), { 0, 0 }))
赋值 (结构.自定义过滤器, 字符 (0))
赋值 (结构.自定义过滤器长度, 0)
赋值 (结构.过滤器索引, 1)
赋值 (结构.全路径名, 相加 ({ 0 }, 取空白字节集 (1024)))
赋值 (结构.全路径名长度, 1024)
赋值 (结构.文件名, 取空白文本 (1024))
赋值 (结构.文件名长度, 1024)
赋值 (结构.初始目录, “c:\”)
赋值 (结构.标题, “打开文件”)
赋值 (结构.标志, 0)
赋值 (结构.扩展名部分索引, 0)

.如果 (打开文件对话框 (结构))
    返回 (到文本 (结构.全路径名))
.否则
    
    返回 (“”)
.如果结束


.子程序 另存指定文件对话框, 文本型, 公开, 
.参数 过滤器类型, 文本型, , 
.参数 过滤器, 文本型, 参考, 

.局部变量 过滤器索引, 整数型, , , 
.局部变量 结构, 打开文件名结构, , , 

.判断开始 (等于 (过滤器类型, “txt”))
    赋值 (过滤器索引, 1)
.判断 (等于 (过滤器类型, “c”))
    赋值 (过滤器索引, 2)
.判断 (等于 (过滤器类型, “cpp”))
    赋值 (过滤器索引, 3)
.判断 (等于 (过滤器类型, “pl”))
    赋值 (过滤器索引, 4)
.默认
    赋值 (过滤器索引, 1)
.判断结束

赋值 (结构.结构尺寸, 76)
赋值 (结构.拥有者窗口句柄, _启动窗口.取窗口句柄 ())
赋值 (结构.实例句柄, 0)
赋值 (结构.过滤器, 相加 (到字节集 (“文本文件(*.txt)”), { 0 }, 到字节集 (“*.txt”), { 0 }, 到字节集 (“C语言源文件(*.c)”), { 0 }, 到字节集 (“*.c”), { 0 }, 到字节集 (“C++语言源文件(*.cpp)”), { 0 }, 到字节集 (“*.cpp”), { 0 }, 到字节集 (“Perl语言源文件(*.pl)”), { 0 }, 到字节集 (“*.pl;*.pm”), { 0, 0 }))
赋值 (结构.自定义过滤器, 字符 (0))
赋值 (结构.自定义过滤器长度, 0)
赋值 (结构.过滤器索引, 过滤器索引)
赋值 (结构.全路径名, 相加 ({ 0 }, 取空白字节集 (1024)))
赋值 (结构.全路径名长度, 1024)
赋值 (结构.文件名, 取空白文本 (1024))
赋值 (结构.文件名长度, 1024)
赋值 (结构.初始目录, “c:\”)
赋值 (结构.标题, “打开文件”)
赋值 (结构.标志, 0)
赋值 (结构.扩展名部分索引, 0)


.如果 (另存文件对话框 (结构))
    .判断开始 (等于 (结构.过滤器索引, 1))
        赋值 (过滤器, “txt”)
    .判断 (等于 (结构.过滤器索引, 2))
        赋值 (过滤器, “c”)
    .判断 (等于 (结构.过滤器索引, 3))
        赋值 (过滤器, “cpp”)
    .判断 (等于 (结构.过滤器索引, 4))
        赋值 (过滤器, “pl”)
    .默认
        
        赋值 (过滤器, “txt”)
    .判断结束
    返回 (到文本 (结构.全路径名))
.否则
    
    返回 (“”)
.如果结束



.子程序 _拖放对象1_得到文件, 空白型, , 
.参数 接收到的文件路径, 文本型, , 

.局部变量 文件路径数组, 文本型, , "0", 
.局部变量 位置, 整数型, , , 
.局部变量 文件个数, 整数型, , , 

赋值 (文件路径数组, 分割文本 (接收到的文件路径, 到文本 (#换行符), ))
赋值 (文件个数, 取数组成员数 (文件路径数组))
.变量循环首 (1, 文件个数, 1, 位置)
    打开指定文件 (文件路径数组 [位置])
.变量循环尾 ()


.子程序 _保存_被选择, 空白型, , 
保存指定文件 (-1)


.子程序 _保存当前文档_被选择, 空白型, , 
保存指定文件 (1)


.子程序 _c文件_被选择, 空白型, , 
新建文件 (“c”)
_启动窗口.未知支持库函数_10 (., 0, 相加 (“#include <stdio.h>”, #换行符, #换行符, “int main(int argc, char *argv[])”, #换行符, “{”, #换行符, “ printf(”, #引号, “Hello, world\n”, #引号, “);”, #换行符, #换行符, “ return 0;”, #换行符, “}”, #换行符))
_启动窗口.未知支持库函数_42 (., 5)


.子程序 _cpp文件_被选择, 空白型, , 
新建文件 (“cpp”)
_启动窗口.未知支持库函数_10 (., 0, 相加 (“#include <stdio.h>”, #换行符, #换行符, “int main(int argc, char *argv[])”, #换行符, “{”, #换行符, “ printf(”, #引号, “Hello, world\n”, #引号, “);”, #换行符, #换行符, “ return 0;”, #换行符, “}”, #换行符))
_启动窗口.未知支持库函数_42 (., 5)


.子程序 _perl文件_被选择, 空白型, , 
新建文件 (“perl”)
_启动窗口.未知支持库函数_10 (., 0, 相加 (“#!/usr/bin/perl”, #换行符, #换行符, “print ”, #引号, “Hello, World...\n”, #引号, “;”, #换行符, #换行符))
_启动窗口.未知支持库函数_42 (., 3)


.子程序 _全部关闭_被选择, 空白型, , 
全部关闭 ()

.子程序 _全部保存_被选择, 空白型, , 
全部保存 ()

.子程序 _另存_被选择, 空白型, , 
转换已打开文件 (另存文件 ())

.子程序 _退出_被选择, 空白型, , 
全部保存 ()
结束 ()


.子程序 _代码编辑框_处理新字符, 空白型, , 
.参数 接收到的字符, 文本型, , 

.如果真 (等于 (文件是否更改 (文档选择控件.对外_取当前选种项 ()), 假))
    更改文件 (文档选择控件.对外_取当前选种项 ())
.如果真结束

.如果真 (等于 (常规配置信息.是否使用缩进, “1”))
    界面代理.自动缩进 (接收到的字符)
.如果真结束

编辑框容器.自动补全 (接收到的字符)


.子程序 __启动窗口_将被销毁, 空白型, , 
全部关闭 ()


.子程序 _html文件_被选择, 空白型, , 
.局部变量 HTML模板, 文本型, , , 

新建文件 (“html”)
赋值 (HTML模板, 相加 (“<!DOCTYPE HTML PUBLIC ”, #引号, “-//W3C//DTD HTML 4.0 Transitional//EN”, #引号, “>”, #换行符))
赋值 (HTML模板, 相加 (HTML模板, “<HTML>”, #换行符))
赋值 (HTML模板, 相加 (HTML模板, “<HEAD>”, #换行符))
赋值 (HTML模板, 相加 (HTML模板, “<TITLE> New Document </TITLE>”, #换行符))
赋值 (HTML模板, 相加 (HTML模板, “<META NAME=”, #引号, “Generator”, #引号, “ CONTENT=”, #引号, “EEditPlus”, #引号, “>”, #换行符))
赋值 (HTML模板, 相加 (HTML模板, “<META NAME=”, #引号, “Author”, #引号, “ CONTENT=”, #引号, #引号, “>”, #换行符))
赋值 (HTML模板, 相加 (HTML模板, “<META NAME=”, #引号, “Keywords”, #引号, “CONTENT=”, #引号, #引号, “>”, #换行符))
赋值 (HTML模板, 相加 (HTML模板, “<META NAME=”, #引号, “Description”, #引号, “ CONTENT=”, #引号, #引号, “>”, #换行符))
赋值 (HTML模板, 相加 (HTML模板, “</HEAD>”, #换行符))
赋值 (HTML模板, 相加 (HTML模板, #换行符))
赋值 (HTML模板, 相加 (HTML模板, “<BODY>”, #换行符))
赋值 (HTML模板, 相加 (HTML模板, #换行符))
赋值 (HTML模板, 相加 (HTML模板, “</BODY>”, #换行符))
赋值 (HTML模板, 相加 (HTML模板, “</HTML>”, #换行符))
赋值 (HTML模板, 相加 (HTML模板, #换行符))

_启动窗口.未知支持库函数_10 (., 0, HTML模板)
_启动窗口.未知支持库函数_42 (., 11)


.子程序 _切换书签_被选择, 空白型, , 
界面代理.切换书签 (-1)


.子程序 _清除全部书签_被选择, 空白型, , 
界面代理.清除所有书签 ()


.子程序 _下一个书签_被选择, 空白型, , 
界面代理.到下一个书签 ()


.子程序 _上一个书签_被选择, 空白型, , 
界面代理.到上一个书签 ()


.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.判断开始 (等于 (按钮索引, 0))
    弹出菜单 ()
    
.判断 (等于 (按钮索引, 1))
    _打开_被选择 ()
    
.判断 (等于 (按钮索引, 2))
    _保存_被选择 ()
    
.判断 (等于 (按钮索引, 3))
    _全部保存_被选择 ()
    
.判断 (等于 (按钮索引, 5))
    _剪切_被选择 ()
    
.判断 (等于 (按钮索引, 6))
    _拷贝_被选择 ()
    
.判断 (等于 (按钮索引, 7))
    _粘贴_被选择 ()
    
.判断 (等于 (按钮索引, 8))
    _删除_被选择 ()
    
.判断 (等于 (按钮索引, 10))
    _撤消_被选择 ()
    
.判断 (等于 (按钮索引, 11))
    _重复_被选择 ()
    
.判断 (等于 (按钮索引, 13))
    _查找_被选择 ()
    
.判断 (等于 (按钮索引, 14))
    _替换_被选择 ()
    
.判断 (等于 (按钮索引, 15))
    _定位_被选择 ()
    
.判断 (等于 (按钮索引, 17))
    _自动换行_被选择 ()
    
.判断 (等于 (按钮索引, 18))
    _行号旁注_被选择 ()
    
.判断 (等于 (按钮索引, 19))
    _参数设置_被选择 ()
    
.判断 (等于 (按钮索引, 21))
    
.判断 (等于 (按钮索引, 22))
    _退出_被选择 ()
.默认
    
.判断结束


.子程序 _普通文件_被选择, 空白型, , 
_普通文本_被选择 ()


.子程序 _C语言文件_被选择, 空白型, , 
_c文件_被选择 ()


.子程序 _Cpp语言文件_被选择, 空白型, , 
_cpp文件_被选择 ()


.子程序 _Perl语言文件_被选择, 空白型, , 
_perl文件_被选择 ()


.子程序 _Html语言文件_被选择, 空白型, , 
_html文件_被选择 ()


.子程序 _分隔条1_被拖动, 空白型, , 
.参数 原位置, 整数型, , 
.参数 目的位置, 整数型, , 

快捷框.改变宽度 (目的位置)
__启动窗口_尺寸被改变 ()


.子程序 _驱动器选择_列表项被选择, 空白型, , 
快捷框.驱动器被改变 ()


.子程序 _文件类型选择_列表项被选择, 空白型, , 
快捷框.文件类型改变 ()


.子程序 _目录选择_目录被改变, 空白型, , 
快捷框.目录被改变 ()


.子程序 _文件选择_双击选择, 空白型, , 
快捷框.文件被选择 ()


.子程序 _单选框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (文档选择框被右键选择序号, 文档选择控件.对外_组件到序号 (取事件组件 ()))
文档选择控件.对外_选择指定项 (取事件组件 ())
编辑框容器.显示文档 (文档选择框被右键选择序号)
关闭指定文件 (1)

.程序集 系统常规程序集, , , 

.程序集变量 配置文件, 未知类型0x40001, , , 
.程序集变量 匿名程序集变量_5, 空白型, , , 
.子程序 初始化系统配置, 空白型, , 
.参数 匿名参数_7, 空白型, 参考, 

赋值 (_启动窗口., #最大化)
读常规配置 ()
快捷框.初始化数据 ()

界面代理.初始化旁注 ()
界面代理.置书签旁注 (15)
赋值 (_启动窗口..选中, 真)
界面代理.置行号旁注 (真)
赋值 (_启动窗口..选中, 真)
界面代理.置折叠旁注 (0)

风格操作对象.置行号栏风格 ()

_启动窗口.未知支持库函数_73 (., #., #黑色)
_启动窗口.未知支持库函数_74 (., #., #白色)
_启动窗口.未知支持库函数_68 (., #., “Fixedsys”)
_启动窗口.未知支持库函数_69 (., #., 8)

风格操作对象.使用文本 ()

_转换为Windows格式_被选择 ()
_UNICODE_被选择 ()
界面代理.初始化书签 ()

风格操作对象.加载XML树 (“stylers.xml”, “langs.xml”)

 ' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
_启动窗口.未知支持库函数_176 (., “fold”, “1”)
_启动窗口.未知支持库函数_176 (., “fold.compact”, “0”)
_启动窗口.未知支持库函数_176 (., “fold.html”, “1”)
_启动窗口.未知支持库函数_176 (., “fold.comment”, “1”)
_启动窗口.未知支持库函数_176 (., “fold.preprocessor”, “1”)
_启动窗口.未知支持库函数_169 (., 16)

_启动窗口.未知支持库函数_56 (., #折叠旁注, #.)
_启动窗口.未知支持库函数_64 (., 真, #白色)
_启动窗口.未知支持库函数_65 (., 真, #白色)
_启动窗口.未知支持库函数_58 (., #折叠旁注, 真)
_启动窗口.未知支持库函数_58 (., #书签旁注, 真)

 ' --
 ' 折叠器的常量:

 ' 折叠器
 ' 状态\样式       箭头式       加减式       圆形树         方形树
 ' 折叠状态_展开状态   标志样式_下箭头 标志样式_减号  标志样式_减号圈   标志样式_减号框
 ' 折叠状态_折叠状态   标志样式_箭头  标志样式_加号  标志样式_加号圈   标志样式_加号框
 ' 折叠状态_子语句   标志样式_空  标志样式_空  标志样式_竖线    标志样式_竖线
 ' 折叠状态_结束位置   标志样式_空  标志样式_空  标志样式_左折角线   标志样式_左拐角线
 ' 折叠状态_中间折叠   标志样式_空  标志样式_空  标志样式_连接式加号圈  标志样式_连接式加号框
 ' 折叠状态_中间展开   标志样式_空  标志样式_空  标志样式_连接型减号圈  标志样式_连接式减号框
 ' 折叠状态_中间结束位置  标志样式_空  标志样式_空  标志样式_T型折角线   标志样式_T型线
 ' --

定义标志 (#., #., #白色, #灰色)
定义标志 (#., #., #白色, #灰色)
定义标志 (#., #., #白色, #灰色)
定义标志 (#., #., #白色, #灰色)
定义标志 (#., #., #白色, #灰色)
定义标志 (#., #., #白色, #灰色)
定义标志 (#., #., #白色, #灰色)

 ' '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

置空文档 ()
置空文档编辑框标题 ()
初始化拖放 ()


.子程序 初始化拖放, 空白型, , 
_启动窗口.未知支持库函数_0 (., _启动窗口.取窗口句柄 ())



.子程序 定义标志, 空白型, , 
.参数 标志号, 整数型, , 
.参数 标志类型, 整数型, , 
.参数 前景颜色, 整数型, , 
.参数 背景颜色, 整数型, , 

_启动窗口.未知支持库函数_108 (., 标志号, 标志类型)
_启动窗口.未知支持库函数_110 (., 标志号, 前景颜色)
_启动窗口.未知支持库函数_111 (., 标志号, 背景颜色)



.子程序 初始化文档, 空白型, 公开, 使用在文档程序启动时
赋值 (默认文档指针, 编辑框容器.取文档指针 ())
编辑框容器.增加文档引用 (默认文档指针)



.子程序 置空文档, 空白型, 公开, 
置默认文档 ()
编辑框容器.置空页 ()


.子程序 取消空文档, 空白型, 公开, 
编辑框容器.取消空页 ()


.子程序 置默认文档, 空白型, 公开, 使用在文档全部关闭时
编辑框容器.置文档指针 (默认文档指针)


.子程序 新建文件, 空白型, 公开, 
.参数 文档类型, 文本型, , 

.局部变量 应选种项, 整数型, , , 

赋值 (新建文件数, 相加 (新建文件数, 1))
赋值 (新文档序号, 相加 (新文档序号, 1))
赋值 (打开文件数, 相加 (打开文件数, 1))

编辑框容器.增加文档 (相加 (“新文档”, 到文本 (新文档序号)), #打开类型_新文件, 文档类型)
赋值 (应选种项, 文档选择控件.对外_增加文档 (相加 (“新文档”, 到文本 (新文档序号))))
文档选择控件.对外_选择指定项 (文档选择控件.对外_序号到组件 (应选种项))
编辑框容器.置文档状态 (应选种项, #未更改)
文档被选择 (应选种项)
取消空文档 ()
_UNICODE_被选择 ()
_启动窗口.获取焦点 (.)
处理文档类型 (文档类型)
应用常规配置 ()


.子程序 处理文档类型, 空白型, 公开, 
.参数 文档类型, 文本型, , 


.判断开始 (等于 (文档类型, “txt”))
    风格操作对象.使用文本 ()
    
.判断 (等于 (文档类型, “c”))
    风格操作对象.使用C (_启动窗口.)
    
.判断 (等于 (文档类型, “cpp”))
    风格操作对象.使用Cpp (_启动窗口.)
    
.判断 (或者 (等于 (文档类型, “perl”), 等于 (文档类型, “pl”), 等于 (文档类型, “pm”)))
    风格操作对象.使用Perl (_启动窗口.)
    
.判断 (等于 (文档类型, “html”))
    风格操作对象.使用Html (_启动窗口.)
.默认
    
.判断结束

_启动窗口.未知支持库函数_73 (., #., #红色)
_启动窗口.未知支持库函数_74 (., #., #白色)
_启动窗口.未知支持库函数_68 (., #., “Fixedsys”)
_启动窗口.未知支持库函数_69 (., #., 8)
_启动窗口.未知支持库函数_70 (., #., 真)

_启动窗口.未知支持库函数_73 (., #., #红色)
_启动窗口.未知支持库函数_74 (., #., #黑色)
_启动窗口.未知支持库函数_68 (., #., “Fixedsys”)
_启动窗口.未知支持库函数_69 (., #., 8)
_启动窗口.未知支持库函数_70 (., #., 真)



.子程序 取文件名, 文本型, , 
.参数 文件路径, 文本型, , 

.局部变量 斜线位置, 整数型, , , 
.局部变量 文件名, 文本型, , , 

赋值 (斜线位置, 倒找文本 (文件路径, “\”, 取文本长度 (文件路径), 假))
.如果真 (等于 (斜线位置, -1))
    返回 (“”)
.如果真结束
赋值 (文件名, 取文本右边 (文件路径, 相减 (取文本长度 (文件路径), 斜线位置)))
返回 (文件名)




.子程序 取文件扩展名, 文本型, , 
.参数 文件名, 文本型, , 

.局部变量 点位置, 整数型, , , 
.局部变量 扩展名, 文本型, , , 

赋值 (点位置, 寻找文本 (文件名, “.”, 0, 假))
.如果真 (等于 (点位置, -1))
    返回 (“”)
.如果真结束
赋值 (扩展名, 取文本右边 (文件名, 相减 (取文本长度 (文件名), 点位置)))
返回 (扩展名)



.子程序 置有文档编辑框标题, 空白型, 公开, 
.参数 标题, 文本型, , 

.判断开始 (等于 (文件是否更改 (文档选择控件.对外_取当前选种项 ()), 真))
    赋值 (_启动窗口., 相加 (“EEditPlus - [”, 取文本左边 (标题, 150), “ *]”))
.默认
    赋值 (_启动窗口., 相加 (“EEditPlus - [”, 取文本左边 (标题, 150), “]”))
.判断结束


.子程序 置空文档编辑框标题, 空白型, 公开, 
赋值 (_启动窗口., “EEditPlus”)




.子程序 查找加载文件序号, 整数型, 公开, 
.参数 文件路径, 文本型, , 

返回 (编辑框容器.查找指定文件序号 (文件路径))



.子程序 打开指定文件, 空白型, 公开, 
.参数 文件路径, 文本型, , 

.局部变量 文件名, 文本型, , , 
.局部变量 扩展名, 文本型, , , 
.局部变量 文件内容, 文本型, , , 
.局部变量 应选种项, 整数型, , , 

赋值 (文件名, 取文件名 (文件路径))
赋值 (扩展名, 取文件扩展名 (文件名))
赋值 (文件内容, 到文本 (读入文件 (文件路径)))
赋值 (应选种项, 查找加载文件序号 (文件路径))
.如果真 (不等于 (应选种项, -1))
    文档选择控件.对外_选择指定项 (文档选择控件.对外_序号到组件 (应选种项))
    文档被选择 (应选种项)
    返回 ()
.如果真结束

赋值 (打开文件数, 相加 (打开文件数, 1))
 ' 直接把扩展名当作文档类型处理
编辑框容器.增加文档 (文件路径, #打开类型_旧文件, 扩展名)
赋值 (应选种项, 文档选择控件.对外_增加文档 (取文本左边 (文件名, 10)))
文档选择控件.对外_选择指定项 (文档选择控件.对外_序号到组件 (应选种项))
文档被选择 (应选种项)
取消空文档 ()
置有文档编辑框标题 (文件路径)
编辑框容器.置文档状态 (应选种项, #未更改)
_启动窗口.获取焦点 (.)
处理文档类型 (扩展名)
应用常规配置 ()
_UNICODE_被选择 ()
置剪辑板文本 (文件内容)
编辑框容器.粘贴 () ' 使用操作系统内设的方式转换编码格式
_启动窗口.未知支持库函数_41 (., 0)


.子程序 关闭指定文件, 逻辑型, 公开, 返回是否全部关闭
.参数 序号类型, 整数型, , 

.局部变量 应选种项, 整数型, , , 
.局部变量 是否删第一项, 逻辑型, , , 
.局部变量 序号, 整数型, , , 


.如果真 (等于 (打开文件数, 0))
    返回 (真)
.如果真结束

赋值 (是否删第一项, 假)

.如果 (等于 (序号类型, -1))
    赋值 (序号, 文档选择控件.对外_取当前选种项 ())
    赋值 (应选种项, 文档选择控件.对外_删除文档 (-1))
    
.否则
    
    赋值 (序号, _启动窗口.)
    赋值 (应选种项, 文档选择控件.对外_删除文档 (_启动窗口.))
.如果结束

.如果真 (等于 (应选种项, 0))
    赋值 (是否删第一项, 真)
    .如果 (大于 (文档选择控件.对外_取文档数 (), 0))
        赋值 (应选种项, 1)
    .否则
        
         ' 在删除最后一个文档之前把默认文档置到编辑框中，这样做即可以减少最后一个文档' 的引用记数，有可以为编辑器设置一个文档，从而避免显示时没有可用的数据
        .如果真 (等于 (文件是否更改 (1), 真))
            .如果真 (等于 (信息框 (“是否保存本文件”, 4, “退出时询问”), 5))
                保存指定文件 (序号类型)
            .如果真结束
            
        .如果真结束
        
        置空文档 ()
        置空文档编辑框标题 ()
        编辑框容器.删除文档 (1)
        赋值 (新建文件数, 相减 (新建文件数, 1))
        赋值 (打开文件数, 相减 (打开文件数, 1))
        返回 (真)
    .如果结束
    
.如果真结束

.如果真 (等于 (文件是否更改 (序号), 真))
    .如果真 (等于 (信息框 (“是否保存本文件”, 4, “退出时询问”), 5))
        保存指定文件 (序号类型)
    .如果真结束
    
.如果真结束


文档选择控件.对外_选择指定项 (文档选择控件.对外_序号到组件 (应选种项))
.如果真 (并且 (等于 (应选种项, 1), 等于 (是否删第一项, 真)))
    赋值 (应选种项, 2)
.如果真结束
 ' 首先把将被删除的文档选出，则其引用记数-1，总数为1
编辑框容器.显示文档 (应选种项)
 ' 删除所选文档，引用记数-1，总数为0，文档被销毁
.如果 (等于 (序号类型, -1))
    编辑框容器.删除文档 (-1)
.否则
    编辑框容器.删除文档 (_启动窗口.)
.如果结束

赋值 (新建文件数, 相减 (新建文件数, 1))
赋值 (打开文件数, 相减 (打开文件数, 1))
返回 (假)



.子程序 保存指定文件, 空白型, 公开, 
.参数 序号类型, 整数型, , 

.局部变量 序号, 整数型, , , 
.局部变量 文本, 文本型, , , 
.局部变量 文件路径, 文本型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 打开类型, 整数型, , , 
.局部变量 文档类型, 文本型, , , 


.如果真 (等于 (打开文件数, 0))
    返回 ()
.如果真结束


.如果 (等于 (序号类型, -1))
    赋值 (序号, 文档选择控件.对外_取当前选种项 ())
    
.否则
    
    赋值 (序号, _启动窗口.)
.如果结束

.如果真 (等于 (文件是否更改 (序号), 假))
    返回 ()
.如果真结束

赋值 (打开类型, 编辑框容器.取打开类型 (序号))
赋值 (文档类型, 编辑框容器.取文档类型 (序号))
.判断开始 (等于 (打开类型, #打开类型_新文件))
    赋值 (文件路径, 保存新文件 (文档类型))
    .如果真 (等于 (文件路径, “”))
        返回 ()
    .如果真结束
    编辑框容器.置文档标题 (序号, 文件路径)
    编辑框容器.置打开类型 (序号, #打开类型_旧文件)
    
.判断 (等于 (打开类型, #打开类型_旧文件))
    赋值 (文件路径, 编辑框容器.取文件路径 (序号))
    
.默认
    
    信息框 (“打开文件类型无法确定，直接保存到本程序所在目录”, 0, “保存文件错误！！”)
    赋值 (文件路径, 编辑框容器.取文件路径 (序号))
    
.判断结束

.如果真 (等于 (文件路径, “”))
    信息框 (“文件路径为空！”, 0, “保存文件错误！！”)
    返回 ()
.如果真结束
编辑框容器.取全部文本 (文本)
赋值 (文件号, 打开文件 (文件路径, #重写, ))
.如果真 (等于 (文件号, 0))
    信息框 (“打开文件！”, 0, “保存文件错误！！”)
    返回 ()
.如果真结束
.如果真 (等于 (写出文本 (文件号, 文本), 假))
    信息框 (“写出文件错误”, 0, “保存文件错误！！”)
.如果真结束

关闭文件 (文件号)

文档选择控件.对外_置文档名 (序号, 取文本左边 (取文件名 (文件路径), 10))
置有文档编辑框标题 (文件路径)
未更改文件 (序号)


.子程序 另存文件, 文本型, , 返回文件路径
.局部变量 序号, 整数型, , , 
.局部变量 文本, 文本型, , , 
.局部变量 文件路径, 文本型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 打开类型, 整数型, , , 
.局部变量 文档类型, 文本型, , , 


.如果真 (等于 (打开文件数, 0))
    返回 (“”)
.如果真结束

赋值 (序号, 文档选择控件.对外_取当前选种项 ())

赋值 (文件路径, 保存新文件 (文档类型))
.如果真 (等于 (文件路径, “”))
    返回 (“”)
.如果真结束

.如果真 (等于 (文件路径, “”))
    信息框 (“文件路径为空！”, 0, “另存文件错误！！”)
    返回 (“”)
.如果真结束
编辑框容器.取全部文本 (文本)
赋值 (文件号, 打开文件 (文件路径, #重写, ))
.如果真 (等于 (文件号, 0))
    信息框 (“打开文件！”, 0, “另存文件错误！！”)
    返回 (“”)
.如果真结束
.如果真 (等于 (写出文本 (文件号, 文本), 假))
    信息框 (“写出文件错误”, 0, “另存文件错误！！”)
.如果真结束

关闭文件 (文件号)

未更改文件 (序号)

返回 (文件路径)


.子程序 转换已打开文件, 空白型, 公开, 
.参数 文件路径, 文本型, , 

.局部变量 序号, 整数型, , , 
.局部变量 文件名, 文本型, , , 

赋值 (序号, 文档选择控件.对外_取当前选种项 ())
赋值 (文件名, 取文件名 (文件路径))
编辑框容器.置文档标题 (序号, 文件路径)
编辑框容器.置文档类型 (序号, 取文件扩展名 (文件路径))
编辑框容器.置打开类型 (序号, #打开类型_旧文件)
文档选择控件.对外_置文档名 (序号, 取文本左边 (文件名, 10))
置有文档编辑框标题 (文件路径)


.子程序 文档被选择, 空白型, 公开, 
.参数 序号, 整数型, , 

编辑框容器.显示文档 (序号)
编辑框容器.重设文档属性 ()
置有文档编辑框标题 (编辑框容器.取指定文档标题 (序号))
.如果 (等于 (编辑框容器.取编码模式 (), 0))
    _ANSI_被选择 ()
    
.否则
    
    _UNICODE_被选择 ()
.如果结束

处理文档类型 (编辑框容器.取文档类型 (序号))
应用常规配置 ()



.子程序 取当前文档类型, 文本型, 公开, 
.局部变量 序号, 整数型, , , 

赋值 (序号, 文档选择控件.对外_取当前选种项 ())
返回 (编辑框容器.取文档类型 (序号))


.子程序 保存新文件, 文本型, , 
.参数 过滤器索引, 文本型, , 

.局部变量 文件路径, 文本型, , , 
.局部变量 文件名, 文本型, , , 
.局部变量 过滤器, 文本型, , , 

赋值 (文件路径, 另存指定文件对话框 (过滤器索引, 过滤器))
.如果真 (等于 (文件路径, “”))
    返回 (“”)
.如果真结束

赋值 (文件名, 取文件名 (文件路径))
.如果真 (等于 (文件名, “”))
    信息框 (“出现不可预料的错误”, 0, “保存新文件错误”)
    返回 (“”)
.如果真结束

.如果真 (等于 (取文件扩展名 (文件名), “”))
    .如果真 (等于 (信息框 (相加 (“是否自动增加.”, 过滤器, “扩展名”), 4, ), 5))
        赋值 (文件路径, 相加 (文件路径, “.”, 过滤器))
    .如果真结束
    
.如果真结束

返回 (文件路径)



.子程序 全部关闭, 空白型, 公开, 
.局部变量 文档数, 整数型, , , 

赋值 (文档数, 文档选择控件.对外_取文档数 ())
.变量循环首 (1, 文档数, 1, )
    关闭指定文件 (-1)
.变量循环尾 ()



.子程序 全部保存, 空白型, 公开, 
.局部变量 临时1, 整数型, , , 
.局部变量 临时2, 整数型, , , 
.局部变量 文档数, 整数型, , , 
.局部变量 位置, 整数型, , , 


.如果真 (等于 (打开文件数, 0))
    返回 ()
.如果真结束


赋值 (临时1, _启动窗口.)
赋值 (临时2, 编辑框容器.取当前文档 ())

赋值 (文档数, 文档选择控件.对外_取文档数 ())
.变量循环首 (1, 文档数, 1, 位置)
    编辑框容器.置当前文档 (位置)
    赋值 (_启动窗口., 位置)
    保存指定文件 (1)
.变量循环尾 ()

编辑框容器.置当前文档 (临时2)
赋值 (_启动窗口., 临时1)


.子程序 更改文件, 空白型, 公开, 
.参数 序号, 整数型, , 

.局部变量 文档标题, 文本型, , , 

编辑框容器.置文档状态 (序号, #更改)
赋值 (文档标题, 编辑框容器.取文档标题 (序号))
置有文档编辑框标题 (文档标题)
赋值 (文档标题, 文档选择控件.对外_取文档名 (序号))
赋值 (文档标题, 相加 (“(*)”, 文档标题))
文档选择控件.对外_置文档名 (序号, 文档标题)


.子程序 未更改文件, 空白型, 公开, 
.参数 序号, 整数型, , 

.局部变量 文档标题, 文本型, , , 


编辑框容器.置文档状态 (序号, #未更改)
赋值 (文档标题, 编辑框容器.取文档标题 (序号))
编辑框容器.置文档标题 (序号, 文档标题)
置有文档编辑框标题 (文档标题)
赋值 (文档标题, 文档选择控件.对外_取文档名 (序号))
.如果真 (等于 (取文本右边 (文档标题, 相减 (取文本长度 (文档标题), 3)), “(*)”))
    赋值 (文档标题, 取文本右边 (文档标题, 相减 (取文本长度 (文档标题), 3)))
    文档选择控件.对外_置文档名 (序号, 文档标题)
.如果真结束



.子程序 文件是否更改, 逻辑型, 公开, 
.参数 序号, 整数型, , 

.局部变量 状态, 整数型, , , 

赋值 (状态, 编辑框容器.取文档状态 (序号))
.如果 (等于 (状态, #更改))
    返回 (真)
.否则
    返回 (假)
.如果结束



.子程序 读常规配置, 空白型, 公开, 
.局部变量 执行结果, 逻辑型, , , 

.如果真 (等于 (配置文件.未知支持库函数_1 (“config.xml”), 假))
    信息框 (“载入配置文件失败”, 0, )
.如果真结束

赋值 (常规配置信息.缩进大小, 到数值 (配置文件.未知支持库函数_33 (“EEditPlus/IndentsSize”, 执行结果)))
.如果真 (等于 (执行结果, 假))
    信息框 (“读配置文件失败 ”, 0, )
.如果真结束

赋值 (常规配置信息.是否使用缩进, 配置文件.未知支持库函数_33 (“EEditPlus/UseIndentsSize”, 执行结果))
.如果真 (等于 (执行结果, 假))
    信息框 (“读配置文件失败 ”, 0, )
.如果真结束

赋值 (常规配置信息.行号背景色, 到数值 (配置文件.未知支持库函数_33 (“EEditPlus/LineBColor”, 执行结果)))
.如果真 (等于 (执行结果, 假))
    信息框 (“读配置文件失败 ”, 0, )
.如果真结束

赋值 (常规配置信息.行号前景色, 到数值 (配置文件.未知支持库函数_33 (“EEditPlus/LineFColor”, 执行结果)))
.如果真 (等于 (执行结果, 假))
    信息框 (“读配置文件失败 ”, 0, )
.如果真结束



.子程序 应用常规配置, 空白型, 公开, 
_启动窗口.未知支持库函数_73 (., #., 常规配置信息.行号前景色)
_启动窗口.未知支持库函数_74 (., #., 常规配置信息.行号背景色)
_启动窗口.未知支持库函数_90 (., 常规配置信息.缩进大小)


.子程序 保存常规配置, 空白型, 公开, 
.如果真 (等于 (配置文件.未知支持库函数_16 (“EEditPlus/IndentsSize”, 到文本 (常规配置信息.缩进大小)), 假))
    信息框 (“修改配置文件错误”, 0, )
.如果真结束

.如果真 (等于 (配置文件.未知支持库函数_16 (“EEditPlus/UseIndentsSize”, 常规配置信息.是否使用缩进), 假))
    信息框 (“修改配置文件错误”, 0, )
.如果真结束

.如果真 (等于 (配置文件.未知支持库函数_16 (“EEditPlus/LineBColor”, 到文本 (常规配置信息.行号背景色)), 假))
    信息框 (“修改配置文件错误”, 0, )
.如果真结束

.如果真 (等于 (配置文件.未知支持库函数_16 (“EEditPlus/LineFColor”, 到文本 (常规配置信息.行号前景色)), 假))
    信息框 (“修改配置文件错误”, 0, )
.如果真结束


.如果真 (等于 (配置文件.未知支持库函数_2 (“config.xml”, ), 假))
    信息框 (“导出配置文件失败”, 0, )
.如果真结束


.窗口程序集 参数设置窗口, , , 

.程序集变量 语言风格数组, 语言风格结构, , "0", 
.子程序 _参数设置窗口_创建完毕, 空白型, , 

加载常规配置页 ()
加载语言格式页 ()
禁止应用 ()




.子程序 加载常规配置页, 空白型, , 
赋值 (.内容, 到文本 (常规配置信息.缩进大小))
.如果 (等于 (常规配置信息.是否使用缩进, “1”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束

赋值 (.颜色, 常规配置信息.行号前景色)
赋值 (.颜色, 常规配置信息.行号背景色)


.子程序 加载语言格式页, 空白型, , 
.如果真 (等于 (风格操作对象.取语言信息 (语言风格数组), 假))
    信息框 (“取语言信息出错”, 0, )
    返回 ()
.如果真结束

加载语言 ()
加载字体 ()
加载大小 ()

置语言索引 (1)
加载风格 (取语言索引 ())
置属性索引 (1)
加载属性 (取语言索引 (), 取属性索引 ())


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()


.子程序 可以应用, 空白型, , 
赋值 (.禁止, 假)


.子程序 禁止应用, 空白型, , 
赋值 (.禁止, 真)


.子程序 检查应用, 逻辑型, , 
返回 (.禁止)


.子程序 取语言索引, 整数型, , 
返回 (相加 (.最大化按钮, 1))


.子程序 取属性索引, 整数型, , 
返回 (相加 (.最大化按钮, 1))


.子程序 置语言索引, 空白型, , 
.参数 索引, 整数型, , 

赋值 (.最大化按钮, 相减 (索引, 1))


.子程序 置属性索引, 空白型, , 
.参数 索引, 整数型, , 

赋值 (.最大化按钮, 相减 (索引, 1))


.子程序 _树型框1_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

加载风格 (取语言索引 ())
置属性索引 (1)
加载属性 (取语言索引 (), 取属性索引 ())


.子程序 _树型框2_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

加载属性 (取语言索引 (), 取属性索引 ())


.子程序 加载语言, 空白型, , 
.局部变量 语言个数, 整数型, , , 
.局部变量 下标, 整数型, , , 

赋值 (语言个数, 取数组成员数 (语言风格数组))
.变量循环首 (1, 语言个数, 1, 下标)
    .加入项目 (语言风格数组 [下标], 语言名称, , , )
.变量循环尾 ()




.子程序 加载风格, 空白型, , 
.参数 语言索引, 空白型, , 

.局部变量 风格个数, 整数型, , , 
.局部变量 下标, 整数型, , , 

清空 ()
赋值 (风格个数, 取数组成员数 (语言风格数组 [语言索引], 属性数组))
.变量循环首 (1, 风格个数, 1, 下标)
    .加入项目 (语言风格数组 [语言索引], 属性数组 [下标], 风格名称, , , )
.变量循环尾 ()



.子程序 加载属性, 空白型, , 
.参数 语言索引, 整数型, , 
.参数 属性索引, 整数型, , 


连续赋值 (假, .选中, .选中, .选中)

赋值 (.颜色, 到数值 (语言风格数组 [语言索引], 属性数组 [属性索引], 前景颜色))
赋值 (.颜色, 到数值 (语言风格数组 [语言索引], 属性数组 [属性索引], 背景颜色))

赋值 (.内容, 语言风格数组 [语言索引], 属性数组 [属性索引], 字体名称)
赋值 (.内容, 到文本 (语言风格数组 [语言索引], 属性数组 [属性索引], 字体大小))

.如果真 (等于 (位与 (语言风格数组 [语言索引], 属性数组 [属性索引], 字体风格, 1), 1))
    赋值 (.选中, 真)
.如果真结束

.如果真 (等于 (位与 (语言风格数组 [语言索引], 属性数组 [属性索引], 字体风格, 2), 2))
    赋值 (.选中, 真)
.如果真结束

.如果真 (等于 (位与 (语言风格数组 [语言索引], 属性数组 [属性索引], 字体风格, 4), 4))
    赋值 (.选中, 真)
.如果真结束



.子程序 加载字体, 空白型, , 
.局部变量 字体列表, 文本型, , "0", 
.局部变量 字体个数, 整数型, , , 
.局部变量 下标, 整数型, , , 

赋值 (字体列表, 未知支持库函数_28 ())
赋值 (字体个数, 取数组成员数 (字体列表))
.变量循环首 (1, 字体个数, 1, 下标)
    字体列表.加入项目 ( [下标], )
.变量循环尾 ()


.子程序 加载大小, 空白型, , 
到文本 (8).加入项目 (8)
到文本 (9).加入项目 (9)
到文本 (10).加入项目 (10)
到文本 (11).加入项目 (11)
到文本 (12).加入项目 (12)
到文本 (14).加入项目 (14)
到文本 (16).加入项目 (16)
到文本 (18).加入项目 (18)
到文本 (20).加入项目 (20)
到文本 (22).加入项目 (22)
到文本 (24).加入项目 (24)
到文本 (26).加入项目 (26)
到文本 (28).加入项目 (28)


.子程序 _选择夹1_被单击, 空白型, , 



.子程序 配置状态被改变, 空白型, , 
.参数 语言索引, 整数型, , 
.参数 属性索引, 整数型, , 

赋值 (语言风格数组 [语言索引], 状态, 1)
赋值 (语言风格数组 [语言索引], 属性数组 [属性索引], 状态, 1)


.子程序 _颜色选择器1_颜色被改变, 空白型, , 
赋值 (语言风格数组 [取语言索引 ()].属性数组 [取属性索引 ()].前景颜色, .颜色)
配置状态被改变 (取语言索引 (), 取属性索引 ())
可以应用 ()


.子程序 _颜色选择器2_颜色被改变, 空白型, , 
赋值 (语言风格数组 [取语言索引 ()].属性数组 [取属性索引 ()].背景颜色, .颜色)
配置状态被改变 (取语言索引 (), 取属性索引 ())
可以应用 ()


.子程序 _组合框1_编辑内容被改变, 空白型, , 
赋值 (语言风格数组 [取语言索引 ()].属性数组 [取属性索引 ()].字体名称, .内容)
配置状态被改变 (取语言索引 (), 取属性索引 ())
可以应用 ()


.子程序 _组合框1_列表项被选择, 空白型, , 
赋值 (语言风格数组 [取语言索引 ()].属性数组 [取属性索引 ()].字体名称, .内容)
配置状态被改变 (取语言索引 (), 取属性索引 ())
可以应用 ()


.子程序 _组合框2_编辑内容被改变, 空白型, , 
赋值 (语言风格数组 [取语言索引 ()].属性数组 [取属性索引 ()].字体大小, 到数值 (.内容))
配置状态被改变 (取语言索引 (), 取属性索引 ())
可以应用 ()



.子程序 _组合框2_列表项被选择, 空白型, , 
赋值 (语言风格数组 [取语言索引 ()].属性数组 [取属性索引 ()].字体大小, 到数值 (.内容))
配置状态被改变 (取语言索引 (), 取属性索引 ())
可以应用 ()


.子程序 _选择框1_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (语言风格数组 [取语言索引 ()].属性数组 [取属性索引 ()].字体风格, 位或 (语言风格数组 [取语言索引 ()].属性数组 [取属性索引 ()].字体风格, 1))
    
.否则
    赋值 (语言风格数组 [取语言索引 ()].属性数组 [取属性索引 ()].字体风格, 位异或 (语言风格数组 [取语言索引 ()].属性数组 [取属性索引 ()].字体风格, 1))
    
.如果结束
配置状态被改变 (取语言索引 (), 取属性索引 ())
可以应用 ()


.子程序 _选择框2_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (语言风格数组 [取语言索引 ()].属性数组 [取属性索引 ()].字体风格, 位或 (语言风格数组 [取语言索引 ()].属性数组 [取属性索引 ()].字体风格, 2))
    
.否则
    赋值 (语言风格数组 [取语言索引 ()].属性数组 [取属性索引 ()].字体风格, 位异或 (语言风格数组 [取语言索引 ()].属性数组 [取属性索引 ()].字体风格, 2))
    
.如果结束
配置状态被改变 (取语言索引 (), 取属性索引 ())
可以应用 ()



.子程序 _选择框3_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (语言风格数组 [取语言索引 ()].属性数组 [取属性索引 ()].字体风格, 位或 (语言风格数组 [取语言索引 ()].属性数组 [取属性索引 ()].字体风格, 4))
    
.否则
    赋值 (语言风格数组 [取语言索引 ()].属性数组 [取属性索引 ()].字体风格, 位异或 (语言风格数组 [取语言索引 ()].属性数组 [取属性索引 ()].字体风格, 4))
    
.如果结束
配置状态被改变 (取语言索引 (), 取属性索引 ())
可以应用 ()


.子程序 更新语言格式配置, 空白型, , 
.参数 是否保存, 逻辑型, , 

.局部变量 语言个数, 整数型, , , 
.局部变量 属性个数, 整数型, , , 
.局部变量 语言下标, 整数型, , , 
.局部变量 属性下标, 整数型, , , 
.局部变量 文档类型, 文本型, , , 
.局部变量 当前文档, 整数型, , , 

赋值 (语言个数, 取数组成员数 (语言风格数组))
.变量循环首 (1, 语言个数, 1, 语言下标)
    .如果真 (等于 (语言风格数组 [语言下标], 状态, 1))
        赋值 (属性个数, 取数组成员数 (语言风格数组 [语言下标], 属性数组))
        .变量循环首 (1, 属性个数, 1, 属性下标)
            .如果真 (等于 (语言风格数组 [语言下标], 属性数组 [属性下标], 状态, 1))
                风格操作对象.修改语言信息 (语言风格数组 [语言下标], 语言下标, 属性下标, 是否保存)
                 ' 增加新语言时，需要在此处增加应用
                风格操作对象.使用C (_启动窗口.)
                风格操作对象.使用Cpp (_启动窗口.)
                风格操作对象.使用Perl (_启动窗口.)
                赋值 (当前文档, 文档选择控件.对外_取当前选种项 ())
                赋值 (文档类型, 编辑框容器.取文档类型 (当前文档))
                处理文档类型 (文档类型)
            .如果真结束
            
        .变量循环尾 ()
    .如果真结束
    
.变量循环尾 ()



.子程序 更新常规配置, 空白型, , 
.参数 是否保存, 逻辑型, , 

赋值 (常规配置信息.缩进大小, 到数值 (.内容))
.如果 (.选中)
    赋值 (常规配置信息.是否使用缩进, “1”)
.否则
    赋值 (常规配置信息.是否使用缩进, “0”)
.如果结束

赋值 (常规配置信息.行号前景色, .颜色)
赋值 (常规配置信息.行号背景色, .颜色)

应用常规配置 ()

.如果真 (等于 (是否保存, 真))
    保存常规配置 ()
.如果真结束


.子程序 _按钮3_被单击, 空白型, , 
更新常规配置 (假)
更新语言格式配置 (假)
禁止应用 ()


.子程序 _按钮1_被单击, 空白型, , 

.如果真 (等于 (检查应用 (), 假))
    更新常规配置 (真)
    更新语言格式配置 (真)
.如果真结束
销毁 ()

.子程序 _编辑框1_内容被改变, 空白型, , 
可以应用 ()

.子程序 _选择框4_被单击, 空白型, , 
可以应用 ()

.子程序 _颜色选择器4_颜色被改变, 空白型, , 
可以应用 ()

.子程序 _颜色选择器3_颜色被改变, 空白型, , 
可以应用 ()

.类模块 界面代理类, , , 

.程序集变量 旧行号, 整数型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 加载, 空白型, 公开, 
.参数 _容器画板, 画板, , 
.参数 _代码编辑框, 未知类型0x30001, , 
.参数 _文档选择容器, 画板, , 
.参数 _快速选择键, 图形按钮, , 
.参数 _文档选择框, 单选框, , 
.参数 _底线, 标签, , 
.参数 _状态条, 状态条, , 
.参数 _滚动条, 纵向滚动条, , 
.参数 _选择夹, 选择夹, , 
.参数 _驱动器选择, 组合框, , 
.参数 _目录选择, 目录框, , 
.参数 _文件选择, 文件框, , 
.参数 _文件类型选择, 组合框, , 
.参数 _快捷提示类型选择, 组合框, , 
.参数 _快捷文本列表, 列表框, , 
.参数 _分隔条, 未知类型0x70003, , 

编辑框容器.加载 (_容器画板, _代码编辑框)
文档选择控件.对外_加载 (_文档选择容器, _快速选择键, _文档选择框, _底线, _滚动条)
快捷框.加载 (_选择夹, _驱动器选择, _目录选择, _文件选择, _文件类型选择, _快捷提示类型选择, _快捷文本列表, _分隔条)
赋值 (状态条, _状态条)


.子程序 调整界面, 空白型, 公开, 
.参数 左边, 整数型, , 
.参数 顶边, 整数型, , 
.参数 宽度, 整数型, , 
.参数 高度, 整数型, , 

快捷框.定位 (左边, 顶边, 高度)

编辑框容器.定位 (相减 (相加 (快捷框.左边 (), 快捷框.宽度 ()), 2), 顶边, 相减 (宽度, 快捷框.宽度 ()), 高度)
更新刻度 ()

文档选择控件.对外_文档选择容器定位 (0, 编辑框容器.顶边 (), 宽度, 编辑框容器.高度 ())

调整状态条 ()


.子程序 调整状态条, 空白型, 公开, 
状态条.置宽度 (0, 相减 (_启动窗口., 145))



.子程序 更新状态条, 空白型, 公开, 
更新状态条行列 ()



.子程序 更新旁注, 空白型, 公开, 
编辑框容器.置行号旁注 (_启动窗口..选中, 假)


.子程序 更新状态条行列, 空白型, , 
更新状态条_行 ()
更新状态条_列 ()


.子程序 更新状态条_行, 空白型, , 
状态条.置文本 (1, 相加 (“行：”, 到文本 (编辑框容器.取光标所在行 ())))


.子程序 更新状态条_列, 空白型, , 
状态条.置文本 (2, 相加 (“列：”, 到文本 (编辑框容器.取光标所在列 ())))


.子程序 更新刻度, 空白型, 公开, 
编辑框容器.画横向刻度 (编辑框容器.取光标所在列 (), 假)


.子程序 初始化旁注, 空白型, 公开, 
编辑框容器.初始化旁注 ()


.子程序 置书签旁注, 空白型, 公开, 
.参数 宽度, 整数型, , 

编辑框容器.置书签旁注 (宽度)


.子程序 置行号旁注, 空白型, 公开, 
.参数 显示, 逻辑型, , 

编辑框容器.置行号旁注 (显示, 真)


.子程序 置折叠旁注, 空白型, 公开, 
.参数 宽度, 整数型, , 

编辑框容器.置折叠旁注 (宽度)


.子程序 显示空格和制表符号, 空白型, 公开, 
.参数 是否显示, 逻辑型, , 

编辑框容器.空白区域填充模式 (到数值 (是否显示))



.子程序 显示行尾符, 空白型, 公开, 
.参数 显示, 逻辑型, , 

编辑框容器.行结束标志 (显示)


.子程序 显示缩进向导, 空白型, 公开, 
.参数 显示, 逻辑型, , 

编辑框容器.显示缩进向导 (显示)


.子程序 加亮当前行, 空白型, 公开, 
.参数 高亮, 逻辑型, , 

编辑框容器.加亮当前行 (高亮)


.子程序 自动换行, 空白型, 公开, 
.参数 _自动换行, 逻辑型, , 

编辑框容器.自动换行 (_自动换行)


.子程序 转换格式, 空白型, 公开, 
.参数 格式类型, 整数型, , 

编辑框容器.设置行结束标志 (格式类型)
编辑框容器.转换行结束模式 (格式类型)



.子程序 置编码模式, 空白型, 公开, 
.参数 模式, 整数型, , 

编辑框容器.置编码模式 (模式)


.子程序 取编码模式, 整数型, 公开, 
返回 (编辑框容器.取编码模式 ())


.子程序 初始化书签, 空白型, 公开, 
定义标志 (#书签标志号, #., #黑色, #绿色)


.子程序 切换书签, 空白型, 公开, 
.参数 行号, 整数型, , 

.局部变量 行状态, 整数型, , , 

.如果真 (等于 (行号, -1))
    赋值 (行号, 相减 (编辑框容器.取光标所在行 (), 1))
.如果真结束

赋值 (行状态, _启动窗口.未知支持库函数_115 (., 行号))
.如果 (大于 (行状态, 0))
    _启动窗口.未知支持库函数_113 (., 行号, #书签标志号)
.否则
    _启动窗口.未知支持库函数_112 (., 行号, #书签标志号)
.如果结束



.子程序 到下一个书签, 空白型, 公开, 
.局部变量 行号, 整数型, , , 

赋值 (行号, 编辑框容器.取光标所在行 ())
赋值 (行号, _启动窗口.未知支持库函数_116 (., 行号, 2))
.如果真 (等于 (行号, -1))
    赋值 (行号, _启动窗口.未知支持库函数_116 (., 0, 2))
    .如果真 (等于 (行号, -1))
        返回 ()
    .如果真结束
    
.如果真结束
_启动窗口.未知支持库函数_42 (., 行号)


.子程序 到上一个书签, 空白型, 公开, 
.局部变量 行号, 整数型, , , 

赋值 (行号, 相减 (编辑框容器.取光标所在行 (), 2))
.如果真 (小于或等于 (行号, 0))
    赋值 (行号, _启动窗口.未知支持库函数_36 (.))
.如果真结束
赋值 (行号, _启动窗口.未知支持库函数_117 (., 行号, 2))
.如果真 (等于 (行号, -1))
    赋值 (行号, _启动窗口.未知支持库函数_36 (.))
    赋值 (行号, _启动窗口.未知支持库函数_117 (., 行号, 2))
    .如果真 (等于 (行号, -1))
        返回 ()
    .如果真结束
    
.如果真结束
_启动窗口.未知支持库函数_42 (., 行号)


.子程序 清除所有书签, 空白型, 公开, 
_启动窗口.未知支持库函数_114 (., #书签标志号)



.子程序 置行缩进, 空白型, , 
.参数 行号, 整数型, , 
.参数 缩进, 整数型, , 

.局部变量 开始位置, 整数型, , , 
.局部变量 结束位置, 整数型, , , 
.局部变量 位置1, 整数型, , , 
.局部变量 位置2, 整数型, , , 
.局部变量 偏移, 整数型, , , 

_启动窗口.未知支持库函数_44 (., 开始位置, 结束位置)
赋值 (位置1, _启动窗口.未知支持库函数_102 (., 行号))
_启动窗口.未知支持库函数_100 (., 行号, 缩进)
赋值 (位置2, _启动窗口.未知支持库函数_102 (., 行号))
赋值 (偏移, 相减 (位置2, 位置1))
.判断开始 (大于 (位置2, 位置1))
    .如果真 (大于或等于 (开始位置, 位置1))
        赋值 (开始位置, 相加 (开始位置, 偏移))
    .如果真结束
    
    .如果真 (大于或等于 (结束位置, 位置1))
        赋值 (结束位置, 相加 (结束位置, 偏移))
    .如果真结束
    
.判断 (小于 (位置2, 位置1))
    .如果真 (大于或等于 (开始位置, 位置2))
        .如果 (大于或等于 (开始位置, 位置1))
            赋值 (开始位置, 相加 (开始位置, 偏移))
        .否则
            赋值 (开始位置, 位置2)
        .如果结束
        
    .如果真结束
    
    .如果真 (大于或等于 (结束位置, 位置2))
        .如果 (大于或等于 (结束位置, 位置1))
            赋值 (结束位置, 相加 (结束位置, 偏移))
        .否则
            赋值 (结束位置, 位置2)
        .如果结束
        
    .如果真结束
    
.默认
    
.判断结束

_启动窗口.未知支持库函数_40 (., 开始位置, 结束位置)


.子程序 自动缩进, 空白型, 公开, 
.参数 字符, 文本型, , 

.局部变量 换行模式, 整数型, , , 
.局部变量 当前行, 整数型, , , 
.局部变量 上一行, 整数型, , , 
.局部变量 缩进大小, 整数型, , , 
.局部变量 a, 字节集, , , 

赋值 (换行模式, _启动窗口..)
赋值 (当前行, 相减 (编辑框容器.取光标所在行 (), 1))
赋值 (上一行, 相减 (当前行, 1))
赋值 (缩进大小, 0)
.如果真 (或者 (并且 (或者 (等于 (换行模式, 0), 等于 (换行模式, 2)), 等于 (到字节集 (字符), { 13 })), 并且 (等于 (换行模式, 1), 等于 (到字节集 (字符), { 13 }))))
    
    .判断循环首 (并且 (大于或等于 (上一行, 0), 等于 (_启动窗口.未知支持库函数_49 (., 上一行), 0)))
        赋值 (上一行, 相减 (上一行, 1))
    .判断循环尾 ()
    
    .如果真 (大于或等于 (上一行, 0))
        赋值 (缩进大小, _启动窗口.未知支持库函数_101 (., 上一行))
    .如果真结束
    
    .如果真 (大于 (缩进大小, 0))
        置行缩进 (当前行, 缩进大小)
        
    .如果真结束
    
.如果真结束



.子程序 括号加亮, 空白型, 公开, 
.局部变量 括号开始位置, 整数型, , , 
.局部变量 括号结束位置, 整数型, , , 
.局部变量 开始列, 整数型, , , 
.局部变量 结束列, 整数型, , , 

.如果真 (等于 (取当前文档类型 (), “txt”))
    返回 ()
.如果真结束

查找括号匹配位置 (括号开始位置, 括号结束位置)
.判断开始 (并且 (不等于 (括号开始位置, -1), 等于 (括号结束位置, -1)))
    _启动窗口.未知支持库函数_104 (., 括号开始位置)
    _启动窗口.未知支持库函数_106 (., 0)
    
.默认
    
    _启动窗口.未知支持库函数_103 (., 括号开始位置, 括号结束位置)
    .如果真 (等于 (_启动窗口.., 真))
        赋值 (开始列, _启动窗口.未知支持库函数_77 (., 括号开始位置))
        赋值 (结束列, _启动窗口.未知支持库函数_77 (., 括号结束位置))
        .如果 (小于 (开始列, 结束列))
            _启动窗口.未知支持库函数_106 (., 开始列)
            
        .否则
            
            _启动窗口.未知支持库函数_106 (., 结束列)
            
        .如果结束
        
    .如果真结束
    
.判断结束


.子程序 查找括号匹配位置, 空白型, , 
.参数 括号开始位置, 整数型, 参考, 
.参数 括号结束位置, 整数型, 参考, 

.局部变量 当前位置, 整数型, , , 
.局部变量 字符, 文本型, , , 
.局部变量 文档长, 整数型, , , 

赋值 (当前位置, _启动窗口.未知支持库函数_43 (.))
赋值 (括号开始位置, -1)
赋值 (括号结束位置, -1)
赋值 (文档长, _启动窗口.未知支持库函数_35 (.))
.如果真 (并且 (大于 (文档长, 0), 大于 (当前位置, 0)))
    赋值 (字符, 到文本 (_启动窗口.未知支持库函数_13 (., 相减 (当前位置, 1))))
.如果真结束

.如果真 (或者 (等于 (字符, “[”), 等于 (字符, “]”), 等于 (字符, “(”), 等于 (字符, “)”), 等于 (字符, “{”), 等于 (字符, “}”)))
    赋值 (括号开始位置, 相减 (当前位置, 1))
.如果真结束

.如果真 (并且 (大于 (文档长, 0), 小于 (括号开始位置, 0)))
    赋值 (字符, 到文本 (_启动窗口.未知支持库函数_13 (., 当前位置)))
    .如果真 (或者 (等于 (字符, “[”), 等于 (字符, “]”), 等于 (字符, “(”), 等于 (字符, “)”), 等于 (字符, “{”), 等于 (字符, “}”)))
        赋值 (括号开始位置, 当前位置)
    .如果真结束
    
.如果真结束

.如果真 (大于或等于 (括号开始位置, 0))
    赋值 (括号结束位置, _启动窗口.未知支持库函数_105 (., 括号开始位置))
.如果真结束


.类模块 编辑框容器类, , , 

.程序集变量 容器画板, 画板, , , 
.程序集变量 代码编辑框, 未知类型0x30001, , , 
.程序集变量 文档, 文档类, , , 
.程序集变量 刻度底边, 整数型, , , 
.程序集变量 刻度纵因子, 整数型, , , 
.程序集变量 字体, 字体, , , 
.程序集变量 字宽, 整数型, , , 
.程序集变量 字高, 整数型, , , 
.程序集变量 原始字宽, 整数型, , , 
.程序集变量 左边宽度长, 整数型, , , 
.程序集变量 是否空页, 逻辑型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
赋值 (是否空页, 真)

赋值 (字体.字体大小, #默认字体大小)
赋值 (字体.字体名称, “Fixedsys”)
 ' 字体.字体名称 ＝ “Franklin Gothic Medium”


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 加载, 空白型, 公开, 
.参数 _容器画板, 画板, , 
.参数 _代码编辑框, 未知类型0x30001, , 

赋值 (容器画板, _容器画板)
赋值 (代码编辑框, _代码编辑框)
文档.加载 (代码编辑框)


.子程序 定位, 空白型, 公开, 
.参数 左边, 整数型, , 
.参数 顶边, 整数型, , 
.参数 宽度, 整数型, , 
.参数 高度, 整数型, , 


赋值 (字宽, 代码编辑框.未知支持库函数_78 (#., “e”))
赋值 (字高, 代码编辑框.未知支持库函数_79 (0))

.如果真 (不等于 (字宽, 原始字宽))
    赋值 (原始字宽, 字宽)
    置行号旁注 (真, 真)
.如果真结束

赋值 (刻度纵因子, 相除 (字高, 10))
.如果真 (等于 (刻度纵因子, 0))
    赋值 (刻度纵因子, 1)
.如果真结束

赋值 (刻度底边, 相加 (刻度纵因子, 字高, 1))
容器画板.移动 (左边, 顶边, 宽度, 高度)
代码编辑框.移动 (0, 刻度底边, 相减 (容器画板.宽度, 5), 相减 (容器画板.高度, 刻度底边, 3))



.子程序 左边, 整数型, 公开, 
返回 (容器画板.左边)


.子程序 顶边, 整数型, 公开, 
返回 (容器画板.顶边)


.子程序 宽度, 整数型, 公开, 
返回 (容器画板.宽度)


.子程序 高度, 整数型, 公开, 
返回 (容器画板.高度)


.子程序 取光标所在行, 整数型, 公开, 
.局部变量 光标位置, 整数型, , , 
.局部变量 光标所在行, 整数型, , , 

赋值 (光标位置, 代码编辑框.未知支持库函数_43 ())
赋值 (光标所在行, 代码编辑框.未知支持库函数_46 (光标位置))
返回 (相加 (光标所在行, 1))


.子程序 取光标所在列, 整数型, 公开, 
.局部变量 光标位置, 整数型, , , 
.局部变量 光标所在列, 整数型, , , 

赋值 (光标位置, 代码编辑框.未知支持库函数_43 ())
赋值 (光标所在列, 代码编辑框.未知支持库函数_77 (光标位置))
返回 (相加 (光标所在列, 1))


.子程序 光标到开始刻度, 整数型, , 
.参数 光标位置, 整数型, , 

.局部变量 一屏个数, 整数型, , , 

赋值 (一屏个数, 相除 (容器画板.宽度, 字宽))
.如果 (小于 (光标位置, 一屏个数))
    
.否则
    
.如果结束
返回 (0)


.子程序 画横向刻度, 空白型, 公开, 
.参数 光标位置, 整数型, , 
.参数 清除, 逻辑型, , 

.局部变量 中线个数, 整数型, , , 
.局部变量 当前中线, 整数型, , , 
.局部变量 显示点, 整数型, , , 
.局部变量 起点, 整数型, , , 
.局部变量 左边宽度, 整数型, , , 
.局部变量 刻度数字, 整数型, , , 
.局部变量 数字文本, 文本型, , , 

.如果真 (等于 (是否空页, 真))
    返回 ()
.如果真结束

赋值 (容器画板.画笔颜色, #藏青)
赋值 (容器画板.文本颜色, #藏青)
赋值 (容器画板.字体, 字体)

赋值 (字宽, 代码编辑框.未知支持库函数_78 (#., “e”))
赋值 (字高, 代码编辑框.未知支持库函数_79 (0))

赋值 (左边宽度, 代码编辑框.未知支持库函数_55 (#书签旁注))
赋值 (左边宽度, 相加 (左边宽度, 代码编辑框.未知支持库函数_55 (#行号旁注)))
赋值 (左边宽度, 相加 (左边宽度, 代码编辑框.未知支持库函数_55 (#折叠旁注)))
 ' 旁注与正文的间隔
代码编辑框.未知支持库函数_60 (5)
赋值 (左边宽度, 相加 (左边宽度, 5))

.如果真 (等于 (清除, 真))
    容器画板.清除 (0, 0, 相加 (容器画板.左边, 容器画板.宽度), 刻度底边)
.如果真结束

 ' 刻度低线
容器画板.画直线 (0, 相减 (刻度底边, 1), 相加 (容器画板.左边, 容器画板.宽度), 相减 (刻度底边, 1))
 ' 刻度开始线
容器画板.画直线 (左边宽度, 0, 左边宽度, 刻度底边)
赋值 (中线个数, 相加 (光标位置, 相除 (容器画板.宽度, 字宽)))
赋值 (显示点, 1)
.变量循环首 (1, 中线个数, 1, 当前中线)
    赋值 (起点, 相加 (左边宽度, 相乘 (相减 (当前中线, 1), 字宽)))
    .判断开始 (等于 (求余数 (显示点, 5), 0))
        .判断开始 (等于 (求余数 (显示点, 10), 0))
             ' 刻度数字
            赋值 (数字文本, 到文本 (当前中线))
            赋值 (数字文本, 取文本右边 (数字文本, 2))
            赋值 (刻度数字, 到数值 (数字文本))
            容器画板.定位写出 (起点, 刻度纵因子, 相除 (刻度数字, 10))
             ' 整刻度横线
        .默认
            容器画板.画直线 (起点, 相除 (刻度底边, 2), 相减 (相加 (起点, 字宽), 2), 相除 (刻度底边, 2))
             ' 整刻度纵线
            容器画板.画直线 (相减 (相加 (起点, 相除 (字宽, 2)), 1), 相乘 (刻度纵因子, 3), 相减 (相加 (起点, 相除 (字宽, 2)), 1), 相减 (刻度底边, 相乘 (刻度纵因子, 3)))
        .判断结束
        
    .默认
        
        容器画板.画直线 (起点, 相除 (刻度底边, 2), 相减 (相加 (起点, 字宽), 2), 相除 (刻度底边, 2))
    .判断结束
    赋值 (显示点, 相加 (显示点, 1))
.变量循环尾 ()


.子程序 撤消, 空白型, 公开, 
代码编辑框.未知支持库函数_28 ()


.子程序 重复, 空白型, 公开, 
代码编辑框.未知支持库函数_29 ()


.子程序 剪切, 空白型, 公开, 
代码编辑框.未知支持库函数_21 ()


.子程序 拷贝, 空白型, 公开, 
代码编辑框.未知支持库函数_22 ()


.子程序 粘贴, 空白型, 公开, 
代码编辑框.未知支持库函数_23 ()


.子程序 删除, 空白型, 公开, 
代码编辑框.未知支持库函数_24 ()


.子程序 选择, 空白型, 公开, 
.参数 开始位置, 整数型, , 
.参数 结束位置, 整数型, , 

代码编辑框.未知支持库函数_40 (开始位置, 结束位置)


.子程序 插入, 空白型, 公开, 
.参数 插入位置, 整数型, , 
.参数 文本, 文本型, , 

代码编辑框.未知支持库函数_10 (插入位置, 文本)




.子程序 初始化旁注, 空白型, 公开, 
代码编辑框.未知支持库函数_52 (#书签旁注, 0)
代码编辑框.未知支持库函数_52 (#行号旁注, 1)
代码编辑框.未知支持库函数_52 (#折叠旁注, 0)


.子程序 置书签旁注, 空白型, 公开, 
.参数 宽度, 空白型, , 

代码编辑框.未知支持库函数_54 (#书签旁注, 宽度)
画横向刻度 (取光标所在列 (), 真)


.子程序 置行号旁注, 空白型, 公开, 
.参数 显示, 逻辑型, , 
.参数 画刻度, 逻辑型, , 

.局部变量 当前行号, 整数型, , , 
.局部变量 数字宽度, 整数型, , , 
.局部变量 宽度, 整数型, , , 


.如果 (等于 (显示, 真))
    赋值 (当前行号, 代码编辑框.未知支持库函数_36 ())
    赋值 (数字宽度, 相加 (相乘 (字宽, 取文本长度 (到文本 (当前行号))), 字宽))
    代码编辑框.未知支持库函数_54 (#行号旁注, 相加 (数字宽度, 5))
    赋值 (宽度, 取文本长度 (到文本 (当前行号)))
    .如果真 (不等于 (左边宽度长, 宽度))
        赋值 (左边宽度长, 宽度)
        画横向刻度 (取光标所在列 (), 真)
    .如果真结束
    
    .如果真 (等于 (画刻度, 真))
        画横向刻度 (取光标所在列 (), 真)
    .如果真结束
    
.否则
    代码编辑框.未知支持库函数_54 (#行号旁注, 0)
    画横向刻度 (取光标所在列 (), 真)
.如果结束


.子程序 置折叠旁注, 空白型, 公开, 
.参数 宽度, 空白型, , 

代码编辑框.未知支持库函数_54 (#折叠旁注, 宽度)
画横向刻度 (取光标所在列 (), 真)


.子程序 空白区域填充模式, 空白型, 公开, 
.参数 模式, 整数型, , 

赋值 (代码编辑框., 模式)


.子程序 行结束标志, 空白型, 公开, 
.参数 显示, 逻辑型, , 

赋值 (代码编辑框., 显示)



.子程序 显示缩进向导, 空白型, 公开, 
.参数 显示, 逻辑型, , 

赋值 (代码编辑框., 显示)


.子程序 加亮当前行, 空白型, 公开, 
.参数 高亮, 逻辑型, , 

赋值 (代码编辑框., 高亮)


.子程序 自动换行, 空白型, 公开, 
.参数 _自动换行, 逻辑型, , 

赋值 (代码编辑框., _自动换行)


.子程序 设置行结束标志, 空白型, 公开, 
.参数 模式, 整数型, , 

赋值 (代码编辑框., 模式)


.子程序 转换行结束模式, 空白型, 公开, 
.参数 模式, 整数型, , 

代码编辑框.未知支持库函数_51 (模式)


.子程序 置编码模式, 空白型, 公开, 
.参数 模式, 整数型, , 

赋值 (代码编辑框., 模式)


.子程序 取编码模式, 整数型, 公开, 
返回 (代码编辑框.)



.子程序 增加文档, 空白型, 公开, 
.参数 文档标题, 文本型, , 
.参数 打开类型, 整数型, , 
.参数 文档类型, 文本型, , 

文档.对外_增加文档 (文档标题, 打开类型, 文档类型)


.子程序 删除文档, 空白型, 公开, 
.参数 序号, 整数型, , 

文档.对外_删除文档 (序号)


.子程序 显示文档, 空白型, 公开, 
.参数 序号, 整数型, , 

文档.对外_置当前文档 (序号, 真)


.子程序 取文档指针, 整数型, 公开, 
返回 (代码编辑框.未知支持库函数_125 ())


.子程序 置文档指针, 空白型, 公开, 
.参数 文档指针, 整数型, , 

代码编辑框.未知支持库函数_126 (文档指针)


.子程序 增加文档引用, 整数型, 公开, 
.参数 文档指针, 整数型, , 

返回 (代码编辑框.未知支持库函数_128 (文档指针))



.子程序 释放文档引用, 整数型, 公开, 
.参数 文档指针, 整数型, , 

返回 (代码编辑框.未知支持库函数_129 (文档指针))



.子程序 画空页背景, 空白型, , 
赋值 (容器画板.画板背景色, #灰色)



.子程序 画有文档背景色, 空白型, , 
赋值 (容器画板.画板背景色, #默认色)


.子程序 置空页, 空白型, 公开, 
赋值 (代码编辑框., 假)
赋值 (是否空页, 真)
画空页背景 ()


.子程序 取消空页, 空白型, 公开, 
赋值 (代码编辑框., 真)
赋值 (是否空页, 假)

画有文档背景色 ()
画横向刻度 (取光标所在列 (), 真)


.子程序 加入文本, 空白型, 公开, 
.参数 文本, 文本型, , 

代码编辑框.未知支持库函数_7 (文本, -1)



.子程序 取全部文本, 空白型, 公开, 
.参数 文本, 文本型, 参考, 

赋值 (文本, 代码编辑框.未知支持库函数_0 (代码编辑框.未知支持库函数_35 ()))


.子程序 取指定文档标题, 文本型, 公开, 
.参数 序号, 整数型, , 

返回 (文档.对外_取文档标题 (序号))


.子程序 查找指定文件序号, 整数型, 公开, 
.参数 文件路径, 文本型, , 

返回 (文档.对外_查找指定文件序号 (文件路径))


.子程序 取文件路径, 文本型, 公开, 
.参数 序号, 整数型, , 

返回 (文档.对外_取文件路径 (序号))


.子程序 取打开类型, 整数型, 公开, 
.参数 序号, 整数型, , 

返回 (文档.对外_取打开类型 (序号))


.子程序 置打开类型, 空白型, 公开, 
.参数 序号, 整数型, , 
.参数 类型, 整数型, , 

文档.对外_置打开类型 (序号, 类型)


.子程序 置文档标题, 空白型, 公开, 
.参数 序号, 整数型, , 
.参数 标题, 文本型, , 

文档.对外_置文档标题 (序号, 标题)



.子程序 取文档标题, 文本型, 公开, 
.参数 序号, 整数型, , 

返回 (文档.对外_取文档标题 (序号))


.子程序 取文档类型, 文本型, 公开, 
.参数 序号, 整数型, , 

返回 (文档.对外_取文档类型 (序号))


.子程序 置文档类型, 空白型, 公开, 
.参数 序号, 整数型, , 
.参数 类型, 文本型, , 

文档.对外_置文档类型 (序号, 类型)




.子程序 取当前文档, 整数型, 公开, 
返回 (文档.对外_取当前文档 ())


.子程序 置当前文档, 空白型, 公开, 
.参数 序号, 整数型, , 

文档.对外_置当前文档 (序号, 假)


.子程序 重设文档属性, 空白型, 公开, 
.如果真 (等于 (_启动窗口..禁止, 真))
    赋值 (代码编辑框., 1)
.如果真结束




.子程序 置文档状态, 空白型, 公开, 
.参数 序号, 整数型, , 
.参数 状态, 整数型, , 

文档.对外_置文档状态 (序号, 状态)


.子程序 取文档状态, 整数型, 公开, 
.参数 序号, 整数型, , 

返回 (文档.对外_取文档状态 (序号))



.子程序 自动补全, 空白型, 公开, 
.参数 待补文本, 文本型, , 

.局部变量 文档类型, 文本型, , , 
.局部变量 位置, 整数型, , , 
.局部变量 语言风格, 语言风格结构, , , 
.局部变量 当前位置, 整数型, , , 
.局部变量 字符, 文本型, , , 
.局部变量 分界符, 文本型, , , 
.局部变量 引号记数, 整数型, , , 

赋值 (文档类型, 取当前文档类型 ())
.如果真 (等于 (文档类型, “txt”))
    返回 ()
.如果真结束

.如果真 (或者 (等于 (文档类型, “pl”), 等于 (文档类型, “pm”)))
    赋值 (文档类型, “perl”)
.如果真结束

.如果真 (等于 (风格操作对象.查找语言 (文档类型, 语言风格), 假))
    返回 ()
.如果真结束

代码编辑框.未知支持库函数_136 (“ ”)

赋值 (当前位置, 相减 (代码编辑框.未知支持库函数_43 (), 1))

赋值 (引号记数, 0)

 ' 不同语言处理
.判断开始 (等于 (文档类型, “html”))
    .变量循环首 (当前位置, 0, -1, 位置)
        赋值 (字符, 代码编辑框.未知支持库函数_13 (位置))
        .如果真 (等于 (字符, “>”))
            返回 ()
        .如果真结束
        
        .如果真 (等于 (字符, “<”))
            跳出循环 ()
        .如果真结束
        
        .如果真 (等于 (字符, #引号))
            赋值 (引号记数, 相加 (引号记数, 1))
        .如果真结束
        
    .变量循环尾 ()
    
.默认
    
.判断结束

.如果真 (大于 (求余数 (引号记数, 2), 0))
    返回 ()
.如果真结束

 ' 取以输入字符位置
.变量循环首 (当前位置, 0, -1, 位置)
    赋值 (字符, 代码编辑框.未知支持库函数_13 (位置))
    .判断开始 (不等于 (文档类型, “html”))
        
        .如果真 (或者 (等于 (是否为空格 (字符), 真), 等于 (是否为回车换行 (字符), 真), 等于 (查找包含关键字 (语言风格.分界符, 字符), 真)))
            跳出循环 ()
        .如果真结束
        
    .默认
        
        
        .如果真 (或者 (等于 (是否为空格 (字符), 真), 等于 (查找包含关键字 (语言风格.分界符, 字符), 真)))
            跳出循环 ()
        .如果真结束
        
    .判断结束
    
.变量循环尾 ()
赋值 (位置, 相减 (当前位置, 位置))

.如果真 (等于 (位置, 0))
    返回 ()
.如果真结束

代码编辑框.未知支持库函数_130 (位置, 语言风格.关键字)




.子程序 查找包含关键字, 逻辑型, , 
.参数 关键字集合, 文本型, , 关键字之间以“ ”分割
.参数 关键字, 文本型, , 

.局部变量 关键字数组, 文本型, , "0", 
.局部变量 个数, 整数型, , , 
.局部变量 位置, 整数型, , , 

赋值 (关键字数组, 分割文本 (关键字集合, “ ”, ))
赋值 (个数, 取数组成员数 (关键字数组))
.变量循环首 (1, 个数, 1, 位置)
    .如果真 (等于 (关键字数组 [位置], 关键字))
        返回 (真)
    .如果真结束
    
.变量循环尾 ()
返回 (假)


.子程序 是否为回车换行, 逻辑型, , 
.参数 字符, 文本型, , 

.如果真 (或者 (等于 (到字节集 (字符), { 13 }), 等于 (到字节集 (字符), { 10 }), 等于 (到字节集 (字符), { 9 })))
    返回 (真)
.如果真结束
返回 (假)



.子程序 是否为空格, 逻辑型, , 
.参数 字符, 文本型, , 

.如果真 (等于 (字符, “ ”))
    返回 (真)
.如果真结束
返回 (假)



.类模块 文档选择控件类, , , 

.程序集变量 文档选择容器, 画板, , , 
.程序集变量 快速选择键, 图形按钮, , , 
.程序集变量 文档选择框, 单选框, , , 
.程序集变量 底线, 标签, , , 
.程序集变量 滚动条, 纵向滚动条, , , 
.程序集变量 匿名程序集变量_2336, 空白型, , , 
.程序集变量 文档数, 整数型, , , 
.程序集变量 文档选择框数组, 单选框, , "0", 
.程序集变量 当前页数, 整数型, , , 
.程序集变量 文档选择框最小宽度, 整数型, , , 
.程序集变量 匿名程序集变量_2497, 空白型, , , 
.程序集变量 显示文档开始, 整数型, , , 
.程序集变量 显示文档结束, 整数型, , , 
.程序集变量 当前选择项, 整数型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
赋值 (文档数, 0)
赋值 (文档选择框最小宽度, 100)
赋值 (显示文档开始, 1)
赋值 (显示文档结束, 1)
赋值 (当前页数, 1)


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用



.子程序 对外_置文档名, 空白型, 公开, 
.参数 文档序号, 整数型, , 
.参数 文档名, 文本型, , 

.如果真 (小于 (取数组成员数 (文档选择框数组), 文档序号))
    返回 ()
.如果真结束
赋值 (文档选择框数组 [文档序号], 标题, 文档名)


.子程序 对外_取文档名, 文本型, 公开, 
.参数 文档序号, 整数型, , 

.如果真 (小于 (取数组成员数 (文档选择框数组), 文档序号))
    返回 (“”)
.如果真结束
返回 (文档选择框数组 [文档序号], 标题)


.子程序 对外_增加文档, 整数型, 公开, 
.参数 文档名, 文本型, , 

赋值 (文档数, 相加 (文档数, 1))
重定义数组 (文档选择框数组, 真, 文档数)
复制窗口组件 (文档选择框, 文档选择框数组 [文档数])
对外_置文档名 (文档数, 文档名)
文档选择框定位 ()
返回 (文档数)


.子程序 对外_删除文档, 整数型, 公开, 返回被删元素的上一个元素
.参数 序号, 整数型, , 


赋值 (文档数, 相减 (文档数, 1))
.如果真 (等于 (序号, -1))
    赋值 (序号, 当前选择项)
.如果真结束
文档选择框数组.销毁 ( [序号])
删除成员 (文档选择框数组, 序号, 1)
文档选择框定位 ()
返回 (相减 (序号, 1))


.子程序 对外_取文档数, 整数型, 公开, 
返回 (文档数)



.子程序 对外_取当前选种项, 整数型, 公开, 
返回 (当前选择项)


.子程序 对外_加载, 空白型, 公开, 
.参数 _文档选择容器, 画板, , 
.参数 _快速选择键, 图形按钮, , 
.参数 _文档选择框, 单选框, , 
.参数 _底线, 标签, , 
.参数 _滚动条, 纵向滚动条, , 

赋值 (文档选择容器, _文档选择容器)
赋值 (快速选择键, _快速选择键)
赋值 (文档选择框, _文档选择框)
赋值 (底线, _底线)
赋值 (滚动条, _滚动条)


赋值 (文档选择框.可视, 假)
赋值 (滚动条.可视, 假)
赋值 (滚动条.位置, 当前页数)



.子程序 对外_翻页, 空白型, 公开, 
赋值 (当前页数, 滚动条.位置)
文档选择框定位 ()


.子程序 对外_文档选择容器定位, 空白型, 公开, 
.参数 左边, 整数型, , 
.参数 顶边, 整数型, , 
.参数 宽度, 整数型, , 
.参数 高度, 整数型, , 

赋值 (文档选择容器.高度, 17)
赋值 (底线.高度, 2)

赋值 (文档选择容器.左边, 左边)
赋值 (文档选择容器.顶边, 相加 (顶边, 高度))
赋值 (文档选择容器.宽度, 宽度)

赋值 (底线.左边, 相减 (左边, 3))
赋值 (底线.顶边, 相加 (文档选择容器.顶边, 文档选择容器.高度, 1))
赋值 (底线.宽度, 相加 (宽度, 3))

赋值 (快速选择键.左边, 5)
赋值 (快速选择键.顶边, 文档选择容器.顶边)
赋值 (快速选择键.宽度, 25)
赋值 (快速选择键.高度, 相加 (文档选择容器.高度, 2))

赋值 (滚动条.左边, 相减 (相加 (文档选择容器.左边, 文档选择容器.宽度), 20))
赋值 (滚动条.顶边, 相减 (文档选择容器.顶边, 1))
赋值 (滚动条.宽度, 20)
赋值 (滚动条.高度, 相加 (文档选择容器.高度, 3))

文档选择框定位 ()


.子程序 对外_选择指定项, 空白型, 公开, 
.参数 组件, 单选框, , 

.局部变量 临时序号, 整数型, , , 
.局部变量 位置, 整数型, , , 
.局部变量 页数, 整数型, , , 

赋值 (临时序号, 对外_组件到序号 (组件))
.如果真 (等于 (临时序号, -1))
    信息框 (“您所选择的文档选择框不存在!”, 0, “错误”)
    返回 ()
.如果真结束

赋值 (当前选择项, 临时序号)
.如果真 (不等于 (文档选择框数组 [当前选择项], 选中, 真))
    赋值 (文档选择框数组 [当前选择项], 选中, 真)
.如果真结束

.变量循环首 (1, 文档数, 1, 位置)
    .如果真 (并且 (不等于 (位置, 当前选择项), 等于 (文档选择框数组 [位置], 选中, 真)))
        赋值 (文档选择框数组 [位置], 选中, 假)
    .如果真结束
    
.变量循环尾 ()

 ' 显示指定项所在页
赋值 (页数, 取序号所在页数 (当前选择项))
.如果真 (或者 (不等于 (页数, -1), 不等于 (页数, 当前页数)))
    赋值 (滚动条.位置, 页数)
    对外_翻页 ()
.如果真结束


.子程序 对外_组件到序号, 整数型, 公开, 返回-1表示转换失败
.参数 组件, 单选框, , 

.局部变量 位置, 整数型, , , 

.变量循环首 (1, 文档数, 1, 位置)
    .如果真 (等于 (文档选择框数组 [位置], 组件))
        返回 (位置)
    .如果真结束
    
.变量循环尾 ()
返回 (-1)


.子程序 对外_序号到组件, 单选框, 公开, 
.参数 序号, 整数型, , 

返回 (文档选择框数组 [序号])


.子程序 取容器可用宽度, 整数型, , 

返回 (相减 (文档选择容器.宽度, 快速选择键.宽度, 滚动条.宽度, 10))




.子程序 清空文档选择框, 空白型, , 
.局部变量 位置, 整数型, , , 

.变量循环首 (显示文档开始, 显示文档结束, 1, 位置)
    .如果真 (大于 (位置, 文档数))
        返回 ()
    .如果真结束
    
    赋值 (文档选择框数组 [位置], 可视, 假)
.变量循环尾 ()




.子程序 取序号所在页数, 整数型, , 
.参数 序号, 整数型, , 

.局部变量 容器宽度, 整数型, , , 
.局部变量 可显示文档数, 整数型, , , 
.局部变量 页数, 整数型, , , 

赋值 (容器宽度, 取容器可用宽度 ())
赋值 (可显示文档数, 相除 (容器宽度, 文档选择框最小宽度))
.如果真 (等于 (可显示文档数, 0))
    返回 (-1)
.如果真结束
赋值 (页数, 相除 (序号, 可显示文档数))
.如果真 (大于 (求余数 (序号, 可显示文档数), 0))
    赋值 (页数, 相加 (页数, 1))
.如果真结束

返回 (页数)


.子程序 文档选择框定位, 空白型, , 
.局部变量 记次变量, 整数型, , , 
.局部变量 文档开始左边, 整数型, , , 
.局部变量 文档宽度, 整数型, , , 
.局部变量 文档间隔, 整数型, , , 
.局部变量 容器宽度, 整数型, , , 
.局部变量 文档平均宽度, 整数型, , , 
.局部变量 可显示文档数, 整数型, , , 
.局部变量 页数, 整数型, , , 
.局部变量 开始文档号, 整数型, , , 


赋值 (文档间隔, -1)
清空文档选择框 ()

赋值 (容器宽度, 取容器可用宽度 ())
赋值 (文档平均宽度, 相除 (容器宽度, 文档数))

.如果 (小于 (文档平均宽度, 文档选择框最小宽度))
     ' 超过显示区
    赋值 (可显示文档数, 相除 (容器宽度, 文档选择框最小宽度))
    .如果真 (等于 (可显示文档数, 0))
        返回 ()
    .如果真结束
    赋值 (文档平均宽度, 相除 (容器宽度, 可显示文档数))
    赋值 (文档宽度, 文档平均宽度)
    赋值 (页数, 相除 (文档数, 可显示文档数))
    .如果真 (大于 (求余数 (文档数, 可显示文档数), 0))
        赋值 (页数, 相加 (页数, 1))
    .如果真结束
    
    .如果真 (大于 (当前页数, 页数))
        返回 ()
    .如果真结束
    
    赋值 (滚动条.最小位置, 1)
    赋值 (滚动条.最大位置, 页数)
    
    赋值 (开始文档号, 相加 (相乘 (相减 (当前页数, 1), 可显示文档数), 1))
    赋值 (滚动条.可视, 真)
    
.否则
    
    
    赋值 (可显示文档数, 文档数)
    赋值 (文档宽度, 文档选择框最小宽度)
    
    赋值 (开始文档号, 1)
    赋值 (滚动条.可视, 假)
.如果结束


赋值 (文档开始左边, 相加 (快速选择键.左边, 快速选择键.宽度))
.变量循环首 (开始文档号, 相减 (相加 (开始文档号, 可显示文档数), 1), 1, 记次变量)
    .如果真 (大于 (记次变量, 文档数))
        跳出循环 ()
    .如果真结束
    赋值 (文档选择框数组 [记次变量], 左边, 文档开始左边)
    赋值 (文档选择框数组 [记次变量], 顶边, 文档选择容器.顶边)
    赋值 (文档选择框数组 [记次变量], 高度, 相加 (文档选择容器.高度, 2))
    赋值 (文档选择框数组 [记次变量], 宽度, 文档宽度)
    赋值 (文档选择框数组 [记次变量], 可视, 真)
    赋值 (文档开始左边, 相加 (文档选择框数组 [记次变量], 左边, 文档宽度, 文档间隔))
.变量循环尾 ()

赋值 (显示文档开始, 开始文档号)
赋值 (显示文档结束, 相减 (相加 (开始文档号, 可显示文档数), 1))


.类模块 辅助操作选择夹, , , 

.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.窗口程序集 查找窗口程序集, , , 

.子程序 _查找窗口_创建完毕, 空白型, , 
.局部变量 查找记录数, 整数型, , , 
.局部变量 当前记录号, 整数型, , , 
.局部变量 临时文本, 文本型, , , 

赋值 (查找记录数, 取数组成员数 (查找记录数组))
.如果真 (大于 (查找记录数, 0))
    .变量循环首 (1, 查找记录数, 1, 当前记录号)
        查找记录数组.加入项目 ( [当前记录号], 当前记录号)
    .变量循环尾 ()
    
.如果真结束

赋值 (临时文本, 取剪辑板文本 ())
赋值 (临时文本, 取文本左边 (临时文本, 100))
赋值 (.内容, 临时文本)
赋值 (.选中, 真)


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 查找标志, 整数型, , , 
.局部变量 查找开始位置, 整数型, , , 
.局部变量 查找结束位置, 整数型, , , 
.局部变量 当前选择开始位置, 整数型, , , 
.局部变量 当前选择结束位置, 整数型, , , 
.局部变量 找到文本开始位置, 整数型, , , 
.局部变量 找到文本结束位置, 整数型, , , 

.如果真 (大于 (取文本长度 (.内容), 0))
    .如果真 (等于 (查找重复文本 (查找记录数组, .内容), 假))
        加入成员 (查找记录数组, .内容)
        .加入项目 (.内容, 0)
    .如果真结束
    
.如果真结束

赋值 (最后查找文本, .内容)

.如果真 (等于 (.选中, 真))
    赋值 (查找标志, 相加 (查找标志, #.))
.如果真结束

.如果真 (等于 (.选中, 真))
    赋值 (查找标志, 相加 (查找标志, #.))
.如果真结束

.如果真 (等于 (.选中, 真))
    赋值 (查找标志, 相加 (查找标志, #.))
.如果真结束

赋值 (最后查找标志, 查找标志)

_启动窗口.未知支持库函数_44 (., 当前选择开始位置, 当前选择结束位置)

.如果 (等于 (.选中, 真))
    赋值 (查找开始位置, 当前选择结束位置)
    赋值 (查找结束位置, _启动窗口.未知支持库函数_35 (.))
.否则
    
    赋值 (查找开始位置, 当前选择开始位置)
    赋值 (查找结束位置, 0)
.如果结束

_启动窗口.未知支持库函数_17 (., 查找标志, 查找开始位置, 查找结束位置, .内容, 找到文本开始位置, 找到文本结束位置)

.如果真 (并且 (小于或等于 (找到文本开始位置, 0), 小于或等于 (找到文本结束位置, 0)))
    赋值 (查找窗口., 假)
    信息框 (相加 (“没有找到与”, #左引号, .内容, #右引号, “匹配的文本”), 0, “查找”)
    赋值 (查找窗口., 真)
    返回 ()
.如果真结束

_启动窗口.未知支持库函数_40 (., 找到文本开始位置, 找到文本结束位置)


.子程序 查找重复文本, 逻辑型, , 
.参数 待查找数组, 文本型, 数组, 
.参数 查找文本, 文本型, , 

.局部变量 数组大小, 整数型, , , 
.局部变量 下标, 整数型, , , 

赋值 (数组大小, 取数组成员数 (待查找数组))
.变量循环首 (1, 数组大小, 1, 下标)
    .如果真 (等于 (待查找数组 [下标], 查找文本))
        返回 (真)
    .如果真结束
    
.变量循环尾 ()

返回 (假)


.子程序 _按钮3_被单击, 空白型, , 
销毁 ()

.子程序 _选择框3_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.禁止, 真)
.否则
    
    赋值 (.禁止, 假)
.如果结束



.子程序 查找上一个, 空白型, , 
.局部变量 查找开始位置, 整数型, , , 
.局部变量 查找结束位置, 整数型, , , 
.局部变量 当前选择开始位置, 整数型, , , 
.局部变量 当前选择结束位置, 整数型, , , 
.局部变量 找到文本开始位置, 整数型, , , 
.局部变量 找到文本结束位置, 整数型, , , 


.如果真 (等于 (最后查找文本, “”))
    返回 ()
.如果真结束

_启动窗口.未知支持库函数_44 (., 当前选择开始位置, 当前选择结束位置)

赋值 (查找开始位置, 当前选择开始位置)
赋值 (查找结束位置, 0)

_启动窗口.未知支持库函数_17 (., 最后查找标志, 查找开始位置, 查找结束位置, 最后查找文本, 找到文本开始位置, 找到文本结束位置)

.如果真 (并且 (小于或等于 (找到文本开始位置, 0), 小于或等于 (找到文本结束位置, 0)))
    信息框 (相加 (“没有找到与”, #左引号, 最后查找文本, #右引号, “匹配的文本”), 0, “查找”)
    返回 ()
.如果真结束

_启动窗口.未知支持库函数_40 (., 找到文本开始位置, 找到文本结束位置)



.子程序 查找下一个, 空白型, , 
.局部变量 查找开始位置, 整数型, , , 
.局部变量 查找结束位置, 整数型, , , 
.局部变量 当前选择开始位置, 整数型, , , 
.局部变量 当前选择结束位置, 整数型, , , 
.局部变量 找到文本开始位置, 整数型, , , 
.局部变量 找到文本结束位置, 整数型, , , 
.局部变量 查找重复文本, 整数型, , , 


.如果真 (等于 (最后查找文本, “”))
    返回 ()
.如果真结束

_启动窗口.未知支持库函数_44 (., 当前选择开始位置, 当前选择结束位置)

赋值 (查找开始位置, 当前选择结束位置)
赋值 (查找结束位置, _启动窗口.未知支持库函数_35 (.))

_启动窗口.未知支持库函数_17 (., 最后查找标志, 查找开始位置, 查找结束位置, 最后查找文本, 找到文本开始位置, 找到文本结束位置)

.如果真 (并且 (小于或等于 (找到文本开始位置, 0), 小于或等于 (找到文本结束位置, 0)))
    信息框 (相加 (“没有找到与”, #左引号, 最后查找文本, #右引号, “匹配的文本”), 0, “查找”)
    返回 ()
.如果真结束

_启动窗口.未知支持库函数_40 (., 找到文本开始位置, 找到文本结束位置)


.子程序 _按钮2_被单击, 空白型, , 
界面代理.切换书签 (-1)

.窗口程序集 替换窗口程序集, , , 

.程序集变量 找到文本开始位置, 整数型, , , 
.程序集变量 找到文本结束位置, 整数型, , , 
.子程序 _替换窗口_创建完毕, 空白型, , 
.局部变量 查找记录数, 整数型, , , 
.局部变量 当前记录号, 整数型, , , 
.局部变量 替换记录数, 整数型, , , 
.局部变量 临时文本, 文本型, , , 

赋值 (查找记录数, 取数组成员数 (查找记录数组))
.如果真 (大于 (查找记录数, 0))
    .变量循环首 (1, 查找记录数, 1, 当前记录号)
        查找记录数组.加入项目 ( [当前记录号], 当前记录号)
    .变量循环尾 ()
    
.如果真结束

赋值 (替换记录数, 取数组成员数 (替换记录数组))
.如果真 (大于 (替换记录数, 0))
    .变量循环首 (1, 替换记录数, 1, 当前记录号)
        替换记录数组.加入项目 ( [当前记录号], 当前记录号)
    .变量循环尾 ()
.如果真结束

赋值 (临时文本, 取剪辑板文本 ())
赋值 (临时文本, 取文本左边 (临时文本, 100))
赋值 (.内容, 临时文本)
赋值 (.选中, 真)

.如果真 (等于 (_启动窗口.., 真))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.如果真结束


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 查找标志, 整数型, , , 
.局部变量 查找开始位置, 整数型, , , 
.局部变量 查找结束位置, 整数型, , , 
.局部变量 当前选择开始位置, 整数型, , , 
.局部变量 当前选择结束位置, 整数型, , , 

.如果真 (大于 (取文本长度 (.内容), 0))
    .如果真 (等于 (查找重复文本 (查找记录数组, .内容), 假))
        加入成员 (查找记录数组, .内容)
        .加入项目 (.内容, 0)
    .如果真结束
    
.如果真结束

赋值 (最后查找文本, .内容)

.如果真 (等于 (.选中, 真))
    赋值 (查找标志, 相加 (查找标志, #.))
.如果真结束

.如果真 (等于 (.选中, 真))
    赋值 (查找标志, 相加 (查找标志, #.))
.如果真结束

.如果真 (等于 (.选中, 真))
    赋值 (查找标志, 相加 (查找标志, #.))
.如果真结束

赋值 (最后查找标志, 查找标志)

_启动窗口.未知支持库函数_44 (., 当前选择开始位置, 当前选择结束位置)

.如果 (等于 (.选中, 真))
    赋值 (查找开始位置, 当前选择结束位置)
    赋值 (查找结束位置, _启动窗口.未知支持库函数_35 (.))
.否则
    
    赋值 (查找开始位置, 当前选择开始位置)
    赋值 (查找结束位置, 0)
.如果结束

_启动窗口.未知支持库函数_17 (., 查找标志, 查找开始位置, 查找结束位置, .内容, 找到文本开始位置, 找到文本结束位置)

.如果真 (并且 (小于或等于 (找到文本开始位置, 0), 小于或等于 (找到文本结束位置, 0)))
    赋值 (替换窗口., 假)
    信息框 (相加 (“没有找到与”, #左引号, .内容, #右引号, “匹配的文本”), 0, “查找”)
    赋值 (替换窗口., 真)
    返回 ()
.如果真结束

_启动窗口.未知支持库函数_40 (., 找到文本开始位置, 找到文本结束位置)



.子程序 _按钮2_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    查找下一个替换 ()
.否则
    查找上一个替换 ()
.如果结束


.如果真 (并且 (小于或等于 (找到文本开始位置, 0), 小于或等于 (找到文本结束位置, 0)))
    赋值 (替换窗口., 假)
    信息框 (相加 (“没有找到与”, #左引号, .内容, #右引号, “匹配的文本”), 0, “查找”)
    赋值 (替换窗口., 真)
    返回 ()
.如果真结束


_启动窗口.未知支持库函数_3 (., .内容)
赋值 (找到文本开始位置, 0)
赋值 (找到文本结束位置, 0)

.如果 (等于 (.选中, 真))
    查找下一个替换 ()
.否则
    查找上一个替换 ()
.如果结束



.子程序 查找上一个替换, 空白型, , 
.局部变量 查找开始位置, 整数型, , , 
.局部变量 查找结束位置, 整数型, , , 
.局部变量 当前选择开始位置, 整数型, , , 
.局部变量 当前选择结束位置, 整数型, , , 
.局部变量 查找标志, 整数型, , , 


.如果真 (等于 (.内容, “”))
    返回 ()
.如果真结束

_启动窗口.未知支持库函数_44 (., 当前选择开始位置, 当前选择结束位置)

赋值 (查找开始位置, 相加 (当前选择结束位置, 1))
赋值 (查找结束位置, 0)

.如果真 (等于 (.选中, 真))
    赋值 (查找标志, 相加 (查找标志, #.))
.如果真结束

.如果真 (等于 (.选中, 真))
    赋值 (查找标志, 相加 (查找标志, #.))
.如果真结束

.如果真 (等于 (.选中, 真))
    赋值 (查找标志, 相加 (查找标志, #.))
.如果真结束


_启动窗口.未知支持库函数_17 (., 查找标志, 查找开始位置, 查找结束位置, .内容, 找到文本开始位置, 找到文本结束位置)

.如果真 (并且 (小于或等于 (找到文本开始位置, 0), 小于或等于 (找到文本结束位置, 0)))
    返回 ()
.如果真结束

_启动窗口.未知支持库函数_40 (., 找到文本开始位置, 找到文本结束位置)



.子程序 查找下一个替换, 空白型, , 
.局部变量 查找开始位置, 整数型, , , 
.局部变量 查找结束位置, 整数型, , , 
.局部变量 当前选择开始位置, 整数型, , , 
.局部变量 当前选择结束位置, 整数型, , , 
.局部变量 查找重复文本, 整数型, , , 
.局部变量 查找标志, 整数型, , , 


.如果真 (等于 (.内容, “”))
    返回 ()
.如果真结束

_启动窗口.未知支持库函数_44 (., 当前选择开始位置, 当前选择结束位置)

赋值 (查找开始位置, 相减 (当前选择结束位置, 1))
赋值 (查找结束位置, _启动窗口.未知支持库函数_35 (.))

.如果真 (等于 (.选中, 真))
    赋值 (查找标志, 相加 (查找标志, #.))
.如果真结束

.如果真 (等于 (.选中, 真))
    赋值 (查找标志, 相加 (查找标志, #.))
.如果真结束

.如果真 (等于 (.选中, 真))
    赋值 (查找标志, 相加 (查找标志, #.))
.如果真结束



_启动窗口.未知支持库函数_17 (., 查找标志, 查找开始位置, 查找结束位置, .内容, 找到文本开始位置, 找到文本结束位置)

.如果真 (并且 (小于或等于 (找到文本开始位置, 0), 小于或等于 (找到文本结束位置, 0)))
    返回 ()
.如果真结束

_启动窗口.未知支持库函数_40 (., 找到文本开始位置, 找到文本结束位置)


.子程序 _按钮3_被单击, 空白型, , 
.局部变量 替换个数, 整数型, , , 
.局部变量 状态, 逻辑型, , , 

赋值 (状态, 真)
_启动窗口.未知支持库函数_41 (., 0)
.判断循环首 (等于 (状态, 真))
    查找下一个替换 ()
    
    .如果 (并且 (小于或等于 (找到文本开始位置, 0), 小于或等于 (找到文本结束位置, 0)))
        赋值 (替换窗口., 假)
        信息框 (相加 (“替换”, 到文本 (替换个数), “次..”), 0, )
        赋值 (替换窗口., 真)
        赋值 (状态, 假)
        
    .否则
        _启动窗口.未知支持库函数_3 (., .内容)
        赋值 (找到文本开始位置, 0)
        赋值 (找到文本结束位置, 0)
        赋值 (替换个数, 相加 (替换个数, 1))
        
    .如果结束
    
.判断循环尾 ()


.子程序 _按钮4_被单击, 空白型, , 
销毁 ()


.窗口程序集 定位窗口程序集, , , 

.子程序 _定位窗口_创建完毕, 空白型, , 
.局部变量 开始行数, 整数型, , , 
.局部变量 结束行数, 整数型, , , 

赋值 (开始行数, 1)
赋值 (结束行数, _启动窗口.未知支持库函数_36 (.))
赋值 (.标题, 相加 (“输入行数(”, 到文本 (开始行数), “ - ”, 到文本 (结束行数), “)：”))


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 指定行, 整数型, , , 

赋值 (指定行, 相减 (到数值 (.内容), 1))
.如果 (小于 (指定行, 0))
    信息框 (“你输入的行数错误”, 0, )
.否则
    _启动窗口.未知支持库函数_42 (., 指定行)
    销毁 ()
    
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()


.类模块 风格操作类, , , 

.程序集变量 风格XML树, 未知类型0x40001, , , 
.程序集变量 关键字XML树, 未知类型0x40001, , , 
.程序集变量 根节点名, 文本型, , , 
.程序集变量 风格_语言节点位置, 文本型, , , 
.程序集变量 风格XML文件路径, 文本型, , , 
.程序集变量 关键字_语言节点位置, 文本型, , , 
.程序集变量 关键字XML文件路径, 文本型, , , 
.程序集变量 语言风格数组, 语言风格结构, , "0", 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
赋值 (风格_语言节点位置, “EEditPlus/LexerStyles”)
赋值 (关键字_语言节点位置, “EEditPlus/Languages”)


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 置行号栏风格, 空白型, 公开, 
_启动窗口.未知支持库函数_68 (., #., “Fixedsys”)
_启动窗口.未知支持库函数_69 (., #., 8)



.子程序 加载XML树, 空白型, 公开, 
.参数 风格XML树名, 文本型, , 
.参数 关键字XML树名, 文本型, , 

.如果真 (等于 (风格XML树.未知支持库函数_1 (风格XML树名), 假))
    信息框 (相加 (“载入”, 风格XML树名, “失败！”), 0, )
.如果真结束
赋值 (风格XML文件路径, 风格XML树名)

.如果真 (等于 (关键字XML树.未知支持库函数_1 (关键字XML树名), 假))
    信息框 (相加 (“载入”, 关键字XML树名, “失败！”), 0, )
.如果真结束
赋值 (关键字XML文件路径, 关键字XML树名)

初始化语言信息 ()


.子程序 取语言个数, 整数型, 公开, 
.局部变量 语言个数, 整数型, , , 

.如果真 (等于 (风格XML树.未知支持库函数_5 (风格_语言节点位置, 语言个数), 假))
    返回 (-1)
.如果真结束

返回 (语言个数)


.子程序 取语言信息, 逻辑型, 公开, 
.参数 _语言风格数组, 语言风格结构, 参考 数组, 

赋值 (_语言风格数组, 语言风格数组)
返回 (真)


.子程序 初始化语言信息, 逻辑型, 公开, 
.局部变量 语言节点名称, 文本型, , "0", 
.局部变量 语言节点数, 整数型, , , 
.局部变量 语言节点下标, 整数型, , , 
.局部变量 属性节点个数, 整数型, , , 
.局部变量 属性节点下标, 整数型, , , 
.局部变量 属性值, 文本型, , , 
.局部变量 匿名局部变量_2011, 空白型, , , 
.局部变量 关键字节点个数, 整数型, , , 
.局部变量 关键字, 文本型, , , 
.局部变量 关键字节点下标, 整数型, , , 

.如果真 (等于 (风格XML树.未知支持库函数_6 (风格_语言节点位置, 语言节点名称), 假))
    返回 (假)
.如果真结束

赋值 (语言节点数, 取语言个数 ())
.如果真 (等于 (语言节点数, -1))
    返回 (假)
    
.如果真结束

.如果真 (等于 (取数组成员数 (语言风格数组), 0))
    重定义数组 (语言风格数组, 假, 语言节点数)
.如果真结束

.变量循环首 (1, 语言节点数, 1, 语言节点下标)
     ' 设置常规信息
    风格XML树.未知支持库函数_10 (相加 (风格_语言节点位置, “/@”, 到文本 (语言节点下标)), “name”, 属性值)
    赋值 (语言风格数组 [语言节点下标], 语言名称, 属性值)
    赋值 (语言风格数组 [语言节点下标], 节点序号, 语言节点下标)
    .如果真 (等于 (风格XML树.未知支持库函数_5 (相加 (风格_语言节点位置, “/@”, 到文本 (语言节点下标)), 属性节点个数), 假))
        返回 (假)
    .如果真结束
    
    
     ' 设置属性
    .变量循环首 (1, 属性节点个数, 1, 属性节点下标)
        .如果真 (等于 (取数组成员数 (语言风格数组 [语言节点下标], 属性数组), 1))
            重定义数组 (语言风格数组 [语言节点下标], 属性数组, 假, 属性节点个数)
        .如果真结束
        
        赋值 (语言风格数组 [语言节点下标], 属性数组 [属性节点下标], 节点序号, 属性节点下标)
         ' Name
        风格XML树.未知支持库函数_10 (相加 (风格_语言节点位置, “/@”, 到文本 (语言节点下标), “/@”, 到文本 (属性节点下标)), “name”, 属性值)
        赋值 (语言风格数组 [语言节点下标], 属性数组 [属性节点下标], 风格名称, 属性值)
        
         ' StyleID
        风格XML树.未知支持库函数_10 (相加 (风格_语言节点位置, “/@”, 到文本 (语言节点下标), “/@”, 到文本 (属性节点下标)), “styleID”, 属性值)
        赋值 (语言风格数组 [语言节点下标], 属性数组 [属性节点下标], 风格ID, 到数值 (属性值))
        
         ' fgColor
        风格XML树.未知支持库函数_10 (相加 (风格_语言节点位置, “/@”, 到文本 (语言节点下标), “/@”, 到文本 (属性节点下标)), “fgColor”, 属性值)
        赋值 (语言风格数组 [语言节点下标], 属性数组 [属性节点下标], 前景颜色, 到数值 (属性值))
        
         ' bgColor
        风格XML树.未知支持库函数_10 (相加 (风格_语言节点位置, “/@”, 到文本 (语言节点下标), “/@”, 到文本 (属性节点下标)), “bgColor”, 属性值)
        赋值 (语言风格数组 [语言节点下标], 属性数组 [属性节点下标], 背景颜色, 到数值 (属性值))
        
         ' fontName
        风格XML树.未知支持库函数_10 (相加 (风格_语言节点位置, “/@”, 到文本 (语言节点下标), “/@”, 到文本 (属性节点下标)), “fontName”, 属性值)
        赋值 (语言风格数组 [语言节点下标], 属性数组 [属性节点下标], 字体名称, 属性值)
        
         ' fontStyle
        风格XML树.未知支持库函数_10 (相加 (风格_语言节点位置, “/@”, 到文本 (语言节点下标), “/@”, 到文本 (属性节点下标)), “fontStyle”, 属性值)
        赋值 (语言风格数组 [语言节点下标], 属性数组 [属性节点下标], 字体风格, 到数值 (属性值))
        
         ' fontSize
        风格XML树.未知支持库函数_10 (相加 (风格_语言节点位置, “/@”, 到文本 (语言节点下标), “/@”, 到文本 (属性节点下标)), “fontSize”, 属性值)
        赋值 (语言风格数组 [语言节点下标], 属性数组 [属性节点下标], 字体大小, 到数值 (属性值))
        
    .变量循环尾 ()
    
     ' 设置关键字
    .如果真 (等于 (关键字XML树.未知支持库函数_5 (相加 (关键字_语言节点位置, “/@”, 到文本 (语言节点下标)), 关键字节点个数), 假))
        信息框 (“取关键字节点个数错误!”, 0, )
    .如果真结束
    
    .如果真 (等于 (取数组成员数 (语言风格数组 [语言节点下标], 关键字数组), 1))
        重定义数组 (语言风格数组 [语言节点下标], 关键字数组, 假, 关键字节点个数)
    .如果真结束
    
    .变量循环首 (1, 关键字节点个数, 1, 关键字节点下标)
        赋值 (语言风格数组 [语言节点下标], 关键字数组 [关键字节点下标], 关键字XML树.未知支持库函数_33 (相加 (关键字_语言节点位置, “/@”, 到文本 (语言节点下标), “/@”, 到文本 (关键字节点下标)), ))
        赋值 (语言风格数组 [语言节点下标], 关键字, 相加 (语言风格数组 [语言节点下标], 关键字, 语言风格数组 [语言节点下标], 关键字数组 [关键字节点下标]))
    .变量循环尾 ()
    
    关键字由小到大排序 (语言风格数组 [语言节点下标], 关键字)
    .判断开始 (不等于 (语言风格数组 [语言节点下标], 语言名称, “html”))
        
        赋值 (语言风格数组 [语言节点下标], 分界符, “; ( ) [ ] { } = == > < !”)
    .默认
        
        赋值 (语言风格数组 [语言节点下标], 分界符, 相加 (“< / ”, #引号))
    .判断结束
    
.变量循环尾 ()

返回 (真)


.子程序 修改语言信息, 空白型, 公开, 
.参数 语言风格, 语言风格结构, , 
.参数 语言下标, 整数型, , 
.参数 风格号, 整数型, , 
.参数 是否保存, 逻辑型, , 

.局部变量 节点位置, 文本型, , , 

赋值 (语言风格数组 [语言下标], 语言风格)
赋值 (节点位置, 相加 (风格_语言节点位置, “/@”, 到文本 (语言风格.节点序号), “/@”, 到文本 (语言风格.属性数组 [风格号], 节点序号)))
.如果真 (等于 (风格XML树.未知支持库函数_19 (节点位置, “fgColor”, 到文本 (语言风格.属性数组 [风格号], 前景颜色)), 假))
    信息框 (“保存属性设置错误”, 0, )
    返回 ()
    
.如果真结束

.如果真 (等于 (风格XML树.未知支持库函数_19 (节点位置, “bgColor”, 到文本 (语言风格.属性数组 [风格号], 背景颜色)), 假))
    信息框 (“保存属性设置错误”, 0, )
    返回 ()
    
.如果真结束

.如果真 (等于 (风格XML树.未知支持库函数_19 (节点位置, “fontName”, 到文本 (语言风格.属性数组 [风格号], 字体名称)), 假))
    信息框 (“保存属性设置错误”, 0, )
    返回 ()
    
.如果真结束

.如果真 (等于 (风格XML树.未知支持库函数_19 (节点位置, “fontStyle”, 到文本 (语言风格.属性数组 [风格号], 字体风格)), 假))
    信息框 (“保存属性设置错误”, 0, )
    返回 ()
    
.如果真结束

.如果真 (等于 (风格XML树.未知支持库函数_19 (节点位置, “fontSize”, 到文本 (语言风格.属性数组 [风格号], 字体大小)), 假))
    信息框 (“保存属性设置错误”, 0, )
    返回 ()
    
.如果真结束


.如果真 (是否保存)
    .如果真 (等于 (风格XML树.未知支持库函数_2 (风格XML文件路径, ), 假))
        信息框 (“保存到XML文件时出错!”, 0, )
    .如果真结束
    
.如果真结束


.子程序 查找语言, 逻辑型, 公开, 
.参数 语言名称, 文本型, , 
.参数 语言风格, 语言风格结构, 参考, 

.局部变量 语言个数, 整数型, , , 
.局部变量 语言下标, 整数型, , , 

赋值 (语言个数, 取数组成员数 (语言风格数组))
.变量循环首 (1, 语言个数, 1, 语言下标)
    .如果真 (等于 (语言名称, 语言风格数组 [语言下标], 语言名称))
        赋值 (语言风格, 语言风格数组 [语言下标])
        返回 (真)
    .如果真结束
    
.变量循环尾 ()

返回 (假)




.子程序 设置属性及关键字, 空白型, 公开, 
.参数 代码编辑框, 未知类型0x30001, , 
.参数 语言结构, 语言风格结构, , 

.局部变量 属性数, 整数型, , , 
.局部变量 属性下标, 整数型, , , 
.局部变量 关键字数, 整数型, , , 
.局部变量 关键字下标, 整数型, , , 

赋值 (属性数, 取数组成员数 (语言结构.属性数组))
.变量循环首 (1, 属性数, 1, 属性下标)
     ' 前景色
    代码编辑框.未知支持库函数_73 (语言结构.属性数组 [属性下标], 风格ID, 语言结构.属性数组 [属性下标], 前景颜色)
     ' 背景色
    代码编辑框.未知支持库函数_74 (语言结构.属性数组 [属性下标], 风格ID, 语言结构.属性数组 [属性下标], 背景颜色)
     ' 字体
    代码编辑框.未知支持库函数_68 (语言结构.属性数组 [属性下标], 风格ID, 语言结构.属性数组 [属性下标], 字体名称)
     ' 大小
    代码编辑框.未知支持库函数_69 (语言结构.属性数组 [属性下标], 风格ID, 语言结构.属性数组 [属性下标], 字体大小)
    
     ' 粗体
    .如果真 (等于 (位与 (语言结构.属性数组 [属性下标], 字体风格, 1), 1))
        代码编辑框.未知支持库函数_70 (语言结构.属性数组 [属性下标], 风格ID, 真)
        
    .如果真结束
    
     ' 斜体
    .如果真 (等于 (位与 (语言结构.属性数组 [属性下标], 字体风格, 2), 2))
        代码编辑框.未知支持库函数_71 (语言结构.属性数组 [属性下标], 风格ID, 真)
        
    .如果真结束
    
     ' 下划线
    .如果真 (等于 (位与 (语言结构.属性数组 [属性下标], 字体风格, 4), 4))
        代码编辑框.未知支持库函数_72 (语言结构.属性数组 [属性下标], 风格ID, 真)
        
    .如果真结束
    
.变量循环尾 ()

.判断开始 (等于 (语言结构.语言名称, “javascript”))
    代码编辑框.未知支持库函数_82 (1, 语言结构.关键字数组 [1])
.默认
    
    赋值 (关键字数, 取数组成员数 (语言结构.关键字数组))
    .变量循环首 (1, 关键字数, 1, 关键字下标)
        代码编辑框.未知支持库函数_82 (相减 (关键字下标, 1), 语言结构.关键字数组 [关键字下标])
    .变量循环尾 ()
    
.判断结束




.子程序 重设常规风格, 空白型, , 
_启动窗口.未知支持库函数_67 (.)
置行号栏风格 ()
.如果真 (等于 (_启动窗口..禁止, 真))
    赋值 (_启动窗口.., 1)
.如果真结束





.子程序 使用文本, 空白型, 公开, 
重设常规风格 ()
_启动窗口.未知支持库函数_15 (., 5)
_启动窗口.未知支持库函数_73 (., #., #黑色)
_启动窗口.未知支持库函数_74 (., #., #白色)
_启动窗口.未知支持库函数_68 (., #., “Fixedsys”)
_启动窗口.未知支持库函数_69 (., #., 8)

_启动窗口.未知支持库函数_80 (., #.)


.子程序 使用C, 逻辑型, 公开, 
.参数 代码编辑框, 未知类型0x30001, , 

.局部变量 C语言结构, 语言风格结构, , , 

.如果真 (等于 (查找语言 (“c”, C语言结构), 假))
    返回 (假)
.如果真结束

重设常规风格 ()
代码编辑框.未知支持库函数_15 (5)
代码编辑框.未知支持库函数_80 (#.)

设置属性及关键字 (代码编辑框, C语言结构)

返回 (真)


.子程序 使用Cpp, 逻辑型, 公开, 
.参数 代码编辑框, 未知类型0x30001, , 

.局部变量 Cpp语言结构, 语言风格结构, , , 


.如果真 (等于 (查找语言 (“cpp”, Cpp语言结构), 假))
    返回 (假)
.如果真结束

重设常规风格 ()
代码编辑框.未知支持库函数_15 (5)
代码编辑框.未知支持库函数_80 (#.)

设置属性及关键字 (代码编辑框, Cpp语言结构)

返回 (真)



.子程序 使用Perl, 逻辑型, 公开, 
.参数 代码编辑框, 未知类型0x30001, , 

.局部变量 Perl语言结构, 语言风格结构, , , 

.如果真 (等于 (查找语言 (“perl”, Perl语言结构), 假))
    返回 (假)
.如果真结束

重设常规风格 ()
代码编辑框.未知支持库函数_15 (5)
代码编辑框.未知支持库函数_80 (#.)

设置属性及关键字 (代码编辑框, Perl语言结构)

返回 (真)


.子程序 使用Html, 逻辑型, 公开, 
.参数 代码编辑框, 未知类型0x30001, , 

.局部变量 Html语言结构, 语言风格结构, , , 
.局部变量 JavaScript语言结构, 语言风格结构, , , 

.如果真 (等于 (查找语言 (“html”, Html语言结构), 假))
    返回 (假)
.如果真结束

重设常规风格 ()
代码编辑框.未知支持库函数_15 (7)
代码编辑框.未知支持库函数_80 (#.)

设置属性及关键字 (代码编辑框, Html语言结构)

查找语言 (“javascript”, JavaScript语言结构)
设置属性及关键字 (代码编辑框, JavaScript语言结构)

返回 (真)



.子程序 关键字由小到大排序, 空白型, , 
.参数 关键字, 文本型, 参考, 

.局部变量 关键字数组, 文本型, , "0", 
.局部变量 关键字个数, 整数型, , , 
.局部变量 关键字位置, 整数型, , , 
.局部变量 查找位置, 整数型, , , 
.局部变量 最小关键字, 文本型, , , 
.局部变量 最小位置, 整数型, , , 
.局部变量 中间文本, 文本型, , , 

赋值 (关键字数组, 分割文本 (关键字, “ ”, ))
赋值 (关键字个数, 取数组成员数 (关键字数组))
.变量循环首 (1, 关键字个数, 1, 关键字位置)
    赋值 (最小关键字, 关键字数组 [关键字位置])
    赋值 (最小位置, 关键字位置)
    .变量循环首 (相加 (关键字位置, 1), 关键字个数, 1, 查找位置)
        .如果真 (大于 (最小关键字, 关键字数组 [查找位置]))
            赋值 (最小关键字, 关键字数组 [查找位置])
            赋值 (最小位置, 查找位置)
        .如果真结束
        
    .变量循环尾 ()
    .如果真 (不等于 (关键字位置, 最小位置))
        赋值 (中间文本, 关键字数组 [关键字位置])
        赋值 (关键字数组 [关键字位置], 最小关键字)
        赋值 (关键字数组 [最小位置], 中间文本)
    .如果真结束
    
.变量循环尾 ()
赋值 (关键字, “”)
.变量循环首 (1, 关键字个数, 1, 关键字位置)
    赋值 (关键字, 相加 (关键字, 关键字数组 [关键字位置]))
    .如果真 (不等于 (关键字位置, 关键字个数))
        赋值 (关键字, 相加 (关键字, “ ”))
    .如果真结束
    
.变量循环尾 ()


.类模块 文档类, , , 

.程序集变量 编辑框, 未知类型0x30001, , , 
.程序集变量 文档, 文档结构, , "0", 
.程序集变量 文档数, 整数型, , , 
.程序集变量 当前文档, 整数型, , , 
.程序集变量 默认删除文档, 整数型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 加载, 空白型, 公开, 
.参数 _编辑框, 未知类型0x30001, , 

赋值 (编辑框, _编辑框)


.子程序 对外_增加文档, 空白型, 公开, 
.参数 文档标题, 文本型, , 
.参数 打开类型, 整数型, , 
.参数 文档类型, 文本型, , 

.局部变量 临时文档, 文档结构, , , 


赋值 (文档数, 相加 (文档数, 1))
赋值 (临时文档.文档标题, 文档标题)
赋值 (临时文档.打开类型, 打开类型)
赋值 (临时文档.文档类型, 文档类型)
 ' 创建时文档引用记数+1,总数为1
赋值 (临时文档.文档指针, 编辑框.未知支持库函数_127 ())
加入成员 (文档, 临时文档)


.子程序 对外_删除文档, 空白型, 公开, 
.参数 序号, 整数型, , 

.局部变量 退出, 逻辑型, , , 
.局部变量 引用记数, 整数型, , , 

赋值 (退出, 假)
赋值 (文档数, 相减 (文档数, 1))
.如果真 (等于 (序号, -1))
    赋值 (序号, 默认删除文档)
     ' 防止删除当前正在显示的文档
    .如果真 (等于 (默认删除文档, 当前文档))
        赋值 (序号, 相减 (序号, 1))
    .如果真结束
    
.如果真结束
 ' 释放时-1，总数为0，被销毁
.判断循环首 (等于 (退出, 假))
    赋值 (引用记数, 编辑框.未知支持库函数_129 (文档 [序号], 文档指针))
    .如果真 (等于 (引用记数, 0))
        赋值 (退出, 真)
    .如果真结束
    
.判断循环尾 ()
删除成员 (文档, 序号, 1)


.子程序 对外_置当前文档, 空白型, 公开, 
.参数 文档号, 整数型, , 
.参数 处理删除, 逻辑型, , 

.如果真 (等于 (处理删除, 真))
    赋值 (默认删除文档, 当前文档)
.如果真结束

赋值 (当前文档, 文档号)
 ' 置入时上一个-1，上一个总数为1，当前的+1，总数为2
 ' 初始化时创建的-1后为0，被销毁
编辑框.未知支持库函数_126 (文档 [当前文档], 文档指针)


.子程序 对外_取当前文档, 整数型, 公开, 
返回 (当前文档)



.子程序 对外_取文档标题, 文本型, 公开, 
.参数 序号, 整数型, , 

返回 (文档 [序号], 文档标题)


.子程序 对外_置文档标题, 空白型, 公开, 
.参数 序号, 整数型, , 
.参数 标题, 文本型, , 

.如果真 (大于 (序号, 取数组成员数 (文档)))
    返回 ()
.如果真结束

赋值 (文档 [序号], 文档标题, 标题)


.子程序 对外_查找指定文件序号, 整数型, 公开, 
.参数 文件路径, 文本型, , 

.局部变量 路径个数, 整数型, , , 
.局部变量 位置, 整数型, , , 

赋值 (路径个数, 取数组成员数 (文档))
.变量循环首 (1, 路径个数, 1, 位置)
    .如果真 (等于 (文档 [位置], 文档标题, 文件路径))
        返回 (位置)
    .如果真结束
    
.变量循环尾 ()
返回 (-1)


.子程序 对外_取文件路径, 文本型, 公开, 
.参数 序号, 整数型, , 

.如果真 (大于 (序号, 取数组成员数 (文档)))
    返回 (“”)
.如果真结束

返回 (文档 [序号], 文档标题)



.子程序 对外_取打开类型, 整数型, 公开, 
.参数 序号, 整数型, , 

.如果真 (大于 (序号, 取数组成员数 (文档)))
    返回 (-1)
.如果真结束

返回 (文档 [序号], 打开类型)


.子程序 对外_置打开类型, 空白型, 公开, 
.参数 序号, 整数型, , 
.参数 类型, 整数型, , 

.如果真 (大于 (序号, 取数组成员数 (文档)))
    返回 ()
.如果真结束

赋值 (文档 [序号], 打开类型, 类型)


.子程序 对外_取文档类型, 文本型, 公开, 
.参数 序号, 整数型, , 

.如果真 (或者 (等于 (序号, 0), 大于 (序号, 取数组成员数 (文档))))
    返回 (“”)
.如果真结束

返回 (文档 [序号], 文档类型)


.子程序 对外_置文档类型, 空白型, 公开, 
.参数 序号, 整数型, , 
.参数 类型, 文本型, , 

.如果真 (大于 (序号, 取数组成员数 (文档)))
    返回 ()
.如果真结束

赋值 (文档 [序号], 文档类型, 类型)


.子程序 对外_置文档状态, 空白型, 公开, 
.参数 序号, 整数型, , 
.参数 状态, 整数型, , 

.如果真 (大于 (序号, 取数组成员数 (文档)))
    返回 ()
.如果真结束

赋值 (文档 [序号], 文档状态, 状态)


.子程序 对外_取文档状态, 整数型, 公开, 
.参数 序号, 整数型, , 

.如果真 (或者 (大于 (序号, 取数组成员数 (文档)), 等于 (序号, 0)))
    返回 (0)
.如果真结束

返回 (文档 [序号], 文档状态)


.类模块 快捷框类, , , 

.程序集变量 选择夹, 选择夹, , , 
.程序集变量 驱动器选择, 组合框, , , 
.程序集变量 目录选择, 目录框, , , 
.程序集变量 文件选择, 文件框, , , 
.程序集变量 文件类型选择, 组合框, , , 
.程序集变量 快捷提示类型选择, 组合框, , , 
.程序集变量 快捷文本列表, 列表框, , , 
.程序集变量 分隔条, 未知类型0x70003, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 加载, 空白型, 公开, 
.参数 _选择夹, 选择夹, , 
.参数 _驱动器选择, 组合框, , 
.参数 _目录选择, 目录框, , 
.参数 _文件选择, 文件框, , 
.参数 _文件类型选择, 组合框, , 
.参数 _快捷提示类型选择, 组合框, , 
.参数 _快捷文本列表, 列表框, , 
.参数 _分隔条, 未知类型0x70003, , 

赋值 (选择夹, _选择夹)
赋值 (驱动器选择, _驱动器选择)
赋值 (目录选择, _目录选择)
赋值 (文件选择, _文件选择)
赋值 (文件类型选择, _文件类型选择)
赋值 (快捷提示类型选择, _快捷提示类型选择)
赋值 (快捷文本列表, _快捷文本列表)
赋值 (分隔条, _分隔条)



.子程序 初始化数据, 空白型, 公开, 
.局部变量 驱动器列表, 文本型, , "0", 
.局部变量 个数, 整数型, , , 
.局部变量 位置, 整数型, , , 
.局部变量 当前驱动器位置, 整数型, , , 
.局部变量 当前驱动器, 文本型, , , 
.局部变量 当前目录, 文本型, , , 

赋值 (当前目录, 目录选择.目录)
赋值 (当前驱动器位置, 寻找文本 (当前目录, “:”, 0, 假))
赋值 (当前驱动器, 取文本左边 (当前目录, 当前驱动器位置))

赋值 (驱动器列表, 未知支持库函数_5 (0))
赋值 (个数, 取数组成员数 (驱动器列表))
.变量循环首 (1, 个数, 1, 位置)
    驱动器选择.加入项目 (相加 (“[”, 驱动器列表 [位置], “]”), )
    .如果真 (等于 (当前驱动器, 驱动器列表 [位置]))
        赋值 (驱动器选择.现行选中项, 相减 (位置, 1))
    .如果真结束
    
.变量循环尾 ()

文件类型选择.加入项目 (“*.txt”, )
文件类型选择.加入项目 (“*.c;*.h”, )
文件类型选择.加入项目 (“*.cpp”, )
文件类型选择.加入项目 (“*.pl;*.pm”, )
文件类型选择.加入项目 (“*.html”, )
赋值 (文件类型选择.现行选中项, 0)

赋值 (文件选择.通配符, 文件类型选择.取项目文本 (文件类型选择.现行选中项))


.子程序 改变宽度, 空白型, 公开, 
.参数 宽度, 整数型, , 

赋值 (选择夹.宽度, 宽度)


.子程序 定位, 空白型, 公开, 
.参数 左边, 整数型, , 
.参数 顶边, 整数型, , 
.参数 高度, 整数型, , 

赋值 (选择夹.左边, 左边)
赋值 (选择夹.顶边, 顶边)
赋值 (选择夹.高度, 相减 (高度, 2))

赋值 (分隔条., 顶边)
赋值 (分隔条., 相减 (选择夹.宽度, 3))
赋值 (分隔条., 5)
赋值 (分隔条., 相减 (高度, 1))

 ' ----------------------------------------  第1页 ------------------------

赋值 (驱动器选择.左边, 左边)
赋值 (驱动器选择.顶边, 22)
赋值 (驱动器选择.宽度, 相减 (分隔条., 4))
赋值 (驱动器选择.高度, 20)

赋值 (目录选择.左边, 左边)
赋值 (目录选择.顶边, 相加 (驱动器选择.顶边, 驱动器选择.高度, 2))
赋值 (目录选择.宽度, 驱动器选择.宽度)
赋值 (目录选择.高度, 相除 (相减 (高度, 70), 2))

赋值 (文件选择.左边, 左边)
赋值 (文件选择.顶边, 相加 (目录选择.顶边, 目录选择.高度, 2))
赋值 (文件选择.宽度, 驱动器选择.宽度)
赋值 (文件选择.高度, 目录选择.高度)

赋值 (文件类型选择.左边, 左边)
赋值 (文件类型选择.顶边, 相加 (文件选择.顶边, 文件选择.高度, 2))
赋值 (文件类型选择.宽度, 驱动器选择.宽度)
赋值 (文件类型选择.高度, 20)


 ' ----------------------------------------  第2页 ------------------------
赋值 (快捷提示类型选择.左边, 左边)
赋值 (快捷提示类型选择.顶边, 22)
赋值 (快捷提示类型选择.宽度, 相减 (分隔条., 4))
赋值 (快捷提示类型选择.高度, 20)

赋值 (快捷文本列表.左边, 左边)
赋值 (快捷文本列表.顶边, 相加 (快捷提示类型选择.顶边, 快捷提示类型选择.高度, 2))
赋值 (快捷文本列表.宽度, 快捷提示类型选择.宽度)
赋值 (快捷文本列表.高度, 相减 (高度, 46))



.子程序 左边, 整数型, 公开, 
返回 (选择夹.左边)


.子程序 顶边, 整数型, 公开, 
返回 (选择夹.顶边)


.子程序 宽度, 整数型, 公开, 
返回 (相加 (分隔条., 分隔条.))


.子程序 高度, 整数型, 公开, 
返回 (选择夹.高度)




.子程序 驱动器被改变, 空白型, 公开, 
.局部变量 驱动器序号, 整数型, , , 
.局部变量 驱动器, 文本型, , , 

赋值 (驱动器序号, 驱动器选择.现行选中项)
赋值 (驱动器, 驱动器选择.取项目文本 (驱动器序号))
赋值 (驱动器, 取文本中间 (驱动器, 2, 相减 (取文本长度 (驱动器), 2)))
赋值 (目录选择.目录, 驱动器)
目录被改变 ()


.子程序 文件类型改变, 空白型, 公开, 
赋值 (文件选择.通配符, 文件类型选择.取项目文本 (文件类型选择.现行选中项))


.子程序 目录被改变, 空白型, 公开, 
.局部变量 目录, 文本型, , , 

赋值 (目录, 目录选择.目录)
赋值 (文件选择.目录, 目录)


.子程序 文件被选择, 空白型, 公开, 
.局部变量 文件目录, 文本型, , , 
.局部变量 文件名, 文本型, , , 

赋值 (文件目录, 文件选择.目录)
赋值 (文件名, 文件选择.被选择文件)
打开指定文件 (相加 (文件目录, “\”, 文件名))



 ' 不属于任何一个程序集、类模块的函数：
