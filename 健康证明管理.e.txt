 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 782
    高度 = 562
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “健康证明管理系统 2005特别版”
    帮助文件名 = “”

窗口 登录窗口
    左边 = 50
    顶边 = 50
    宽度 = 324
    高度 = 202
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “用户登录”
    帮助文件名 = “”

窗口 删除用户窗口
    左边 = 50
    顶边 = 50
    宽度 = 324
    高度 = 195
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “删除用户”
    帮助文件名 = “”

窗口 添加用户窗口
    左边 = 50
    顶边 = 50
    宽度 = 324
    高度 = 168
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “添加新用户”
    帮助文件名 = “”

窗口 修改口令窗口
    左边 = 50
    顶边 = 50
    宽度 = 324
    高度 = 203
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “修改用户口令”
    帮助文件名 = “”

窗口 统计窗口
    左边 = 50
    顶边 = 50
    宽度 = 415
    高度 = 376
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “统计”
    帮助文件名 = “”

窗口 背景音乐窗口
    左边 = 50
    顶边 = 50
    宽度 = 426
    高度 = 304
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “背景音乐设置”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 402
    高度 = 270
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于...”
    帮助文件名 = “”

窗口 照片窗口
    左边 = 50
    顶边 = 50
    宽度 = 450
    高度 = 320
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “获取照片”
    帮助文件名 = “”

窗口 欢迎窗口
    左边 = 50
    顶边 = 50
    宽度 = 348
    高度 = 234
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 2
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 批量打印窗口
    左边 = 50
    顶边 = 50
    宽度 = 324
    高度 = 202
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “批量打印健康证”
    帮助文件名 = “”

窗口 预览窗口
    左边 = 50
    顶边 = 50
    宽度 = 757
    高度 = 448
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “打印预览”
    帮助文件名 = “”



.常量 DSTINVERT, "5570569", , 
.常量 密匙, "“FindWindowExA”", , 
.图片 男, " ' 已保存到：D:\易语言学习\Data\健康证明管理.e\男", , 
.图片 女, " ' 已保存到：D:\易语言学习\Data\健康证明管理.e\女", , 
.图片 打印, " ' 已保存到：D:\易语言学习\Data\健康证明管理.e\打印", , 
.图片 删除, " ' 已保存到：D:\易语言学习\Data\健康证明管理.e\删除", , 
.图片 保存, " ' 已保存到：D:\易语言学习\Data\健康证明管理.e\保存", , 
.图片 查找, " ' 已保存到：D:\易语言学习\Data\健康证明管理.e\查找", , 
.图片 默认配置, " ' 已保存到：D:\易语言学习\Data\健康证明管理.e\默认配置", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 3 系统核心支持库
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 1 7 扩展界面支持库三
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' ExtMenu 9909FBB013704cfa8FE7E739DB7172DE 1 4 超级菜单支持库
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 1 0 数据操作支持库一
 ' twain 730FA7B73AAB409a8554F9553CF2DD87 1 5 数码设备支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 0 应用接口支持库




数据类型 文件对话框, , 
    .成员 lStructSize, 整数型, , , 
    .成员 hwndOwner, 整数型, , , 
    .成员 hInstance, 整数型, , , 
    .成员 lpstrFilter, 字节集, , , 
    .成员 lpstrCustomFilter, 文本型, , , 
    .成员 nMaxCustFilter, 整数型, , , 
    .成员 nFilterIndex, 整数型, , , 
    .成员 lpstrFile, 字节集, , , 
    .成员 nMaxFile, 整数型, , , 
    .成员 lpstrFileTitle, 文本型, , , 
    .成员 nMaxFileTitle, 整数型, , , 
    .成员 lpstrInitialDir, 文本型, , , 
    .成员 lpstrTitle, 文本型, , , 
    .成员 flags, 整数型, , , 
    .成员 nFileOffset, 短整数型, , , 
    .成员 nFileEtesion, 短整数型, , , 
    .成员 lpstrDefExt, 文本型, , , 
    .成员 lCustData, 整数型, , , 
    .成员 lpfnHook, 整数型, , , 
    .成员 lpTemplateName, 文本型, , , 

数据类型 矩形区域, , 
    .成员 左, 整数型, , , 
    .成员 上, 整数型, , , 
    .成员 右, 整数型, , , 
    .成员 下, 整数型, , , 

.全局变量 初始化, 字节型, , , 0，第一次，1，初始化，2，界面设置
.全局变量 当前用户, 文本型, , , 
.全局变量 查找内容, 文本型, , , 
.全局变量 找到, 逻辑型, , , 
.全局变量 查找值, 文本型, , , 
.全局变量 模糊查找, 逻辑型, , , 
.全局变量 批量打印, 逻辑型, , , 
.全局变量 证号一, 文本型, , , 
.全局变量 证号二, 文本型, , , 
.全局变量 用户, 文本型, , "0", 
.全局变量 口令, 文本型, , "0", 
.全局变量 配置文件, 文本型, , , 
.全局变量 数据目录, 文本型, , , 指定当前所读取的数据所在的目录
.全局变量 预览后打印, 逻辑型, , , 

.DLL命令 取窗口范围, 整数型, "", "GetWindowRect", , 
    .参数 hwnd, 整数型, , 
    .参数 lpRect, 矩形区域, , 

.DLL命令 删除场景, 整数型, "", "DeleteDC", , 
    .参数 hdc, 整数型, , 

.DLL命令 填充设备场景, 空白型, "", "PatBlt", , 
    .参数 hdc, 整数型, , 
    .参数 x, 整数型, , 
    .参数 y, 整数型, , 
    .参数 nWidth, 整数型, , 
    .参数 nHeight, 整数型, , 
    .参数 dwRop, 整数型, , 

.DLL命令 矩形是否为空, 整数型, "", "IsRectEmpty", , 
    .参数 lpRect, 矩形区域, , 

.DLL命令 创建场景, 整数型, "", "CreateDCA", , 
    .参数 lpDriverName, 文本型, , 
    .参数 lpDeviceName, 文本型, , 
    .参数 lpOutput, 文本型, , 
    .参数 lpInitData, 整数型, , 

.DLL命令 打开对话框, 整数型, "comdlg32.dll", "GetOpenFileNameA", , 
    .参数 OpenFile, 文件对话框, , 

.DLL命令 发送媒体指令, 整数型, "winmm.dll", "mciSendStringA", , 
    .参数 命令, 文本型, , 
    .参数 操作, 文本型, , 
    .参数 参数1, 整数型, , 
    .参数 参数2, 整数型, , 

.DLL命令 取短文件名, 整数型, "kernel32.dll", "GetShortPathNameA", , 
    .参数 长文件名, 文本型, , 
    .参数 短文件名, 文本型, , 
    .参数 缓冲区长度, 整数型, , 

.DLL命令 置父窗口, 整数型, "user32.dll", "SetParent", , 返回前一个父窗口的句柄
    .参数 子窗口句柄, 整数型, , 
    .参数 父窗口句柄, 整数型, , 欲设置的新父窗口

.DLL命令 释放鼠标, 整数型, "user32", "ReleaseCapture", , 

.DLL命令 俘获鼠标, 整数型, "user32", "SetCapture", , 
    .参数 窗口句柄, 整数型, , 

.窗口程序集 启动窗口程序集, , , 

.程序集变量 改变, 逻辑型, , , 
.程序集变量 当前操作, 字节型, , , 1添加;2修改;3查找;4卡片设置;5打印设置;6单位名称;7工种设置;8区域设置;9备份目录;10编号规则;11照片来源;12卡片布局;13查看往年数据;14重设字段
.程序集变量 匿名程序集变量_778, 空白型, , , 
.程序集变量 音乐数组, 文本型, , "0", 以下为播放背景音乐使用。
.程序集变量 当前音乐索引, 整数型, , , 
.程序集变量 当前音乐文件名, 文本型, , , 
.程序集变量 文本长度, 整数型, , , 
.程序集变量 匿名程序集变量_1584, 空白型, , , 
.程序集变量 项目, 文本型, , "0", 以下为打印设置中用
.程序集变量 项目选择框, 选择框, , "0", 
.程序集变量 横向标签, 标签, , "0", 
.程序集变量 纵向标签, 标签, , "0", 
.程序集变量 横向编辑框, 编辑框, , "0", 
.程序集变量 纵向编辑框, 编辑框, , "0", 
.程序集变量 匿名程序集变量_1585, 空白型, , , 
.程序集变量 修改, 逻辑型, , , 工种设置及区域设置中使用。
.程序集变量 匿名程序集变量_2206, 空白型, , , 
.程序集变量 原句柄, 整数型, , , 以下为卡片布局设置中用
.程序集变量 组件类型, 字节型, , , 1标签2组合框3编辑框4照片框
.程序集变量 当前标签, 标签, , , 
.程序集变量 当前组合框, 组合框, , , 
.程序集变量 当前编辑框, 编辑框, , , 
.程序集变量 匿名程序集变量_3618, 空白型, , , 
.程序集变量 是否在查找中, 逻辑型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 背景音乐文件, 文本型, , , 
.局部变量 年结目录, 文本型, , , 

.如果真 (小于 (取屏幕高度 (), 600))
    信息框 (“《健康证明管理系统》必须在800×600以上分辨率下运行！”, #信息图标, )
    结束 ()
.如果真结束
赋值 (_启动窗口., 相减 (相加 (_启动窗口., 508), _启动窗口.取用户区高度 ())) ' 为了自适应XP及98系统，加上此行代码。其它窗口程序集同。
赋值 (_启动窗口., 2)
赋值 (_启动窗口., 真) ' 以上两行代码，目的是为了让程序在任务栏中显示。
.如果真 (等于 (寻找文件 (“data”, #子目录), “”)) ' 自动创建数据目录。
    .如果真 (等于 (创建目录 (“data”), 假))
        信息框 (相加 (“系统不能创建数据目录”, 取运行目录 (), “\data，请手工创建它。”), 0, )
        结束 ()
    .如果真结束
    
.如果真结束
.如果真 (等于 (寻找文件 (“autobak”, #子目录), “”)) ' 自动创建自动备份目录。
    .如果真 (等于 (创建目录 (“autobak”), 假))
        信息框 (相加 (“系统不能创建自动备份目录”, 取运行目录 (), “\autobak，请手工创建它。”), 0, )
        结束 ()
    .如果真结束
    
.如果真结束
赋值 (数据目录, 相加 (取运行目录 (), “\data”))
载入 (欢迎窗口, , 真)
载入 (登录窗口, , 真)
0.置文本 (当前用户)
.如果 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “初始化”, “初始化”, “0”), “1”)) ' 1:初始化未结束；0:初始化已结束。
    .如果 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “初始化”, “初始化进度”, “0”), “0”))
        .如果真 (等于 (文件是否存在 (“data\jkzlib.dat”), 假))
            复制文件 (“autobak\jkzlib.dat”, “data\jkzlib.dat”) ' 用自动备份的数据库恢复。
            复制文件 (“autobak\jkzlib.edt”, “data\jkzlib.edt”)
            复制文件 (“autobak\jkzlib.enx”, “data\jkzlib.enx”)
            .如果真 (等于 (打开 (“data\jkzlib.dat”, “jkz”, , , , , “jkzlib.enx”), 假))
                信息框 (相加 (“无法打开健康证明数据库”, “！”, 取错误信息 (), “。”, #换行符, “请用数据恢复功能恢复上次保存的数据库！”), #错误图标, “错误”)
            .如果真结束
            
        .如果真结束
        全部关闭 ()
        复制文件 (相加 (未知支持库函数_7 (10), “jkzmbak.sys”), 相加 (数据目录, “\set.ini”)) ' 恢复原来的配置
        调整卡片布局 ()
        填充初始数据 ()
        写配置项 (相加 (取运行目录 (), “\rich32.dll”), “run”, “mode”, “0”)
        检查数据库完整 ()
        复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
        记录摘要 (2)
        赋值 (., “保 存(&S)”)
        赋值 (., “取 消(&X)”)
        赋值 (., “打 印(&P)”)
        读记录 ()
        赋值 (.现行子夹, 0)
        _选择夹1_子夹被改变 ()
        赋值 (., 1)
        赋值 (当前操作, 0) ' 0：无操作。
        赋值 (., 1)
        赋值 (.现行子夹, 0)
        _选择夹1_子夹被改变 ()
    .否则
        信息框 (“系统上一次运行时进行初始化设置未完成，将继续进行初始化设置！”, #信息图标, )
        全部关闭 ()
        .判断开始 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “初始化”, “初始化进度”, “0”), “1”))
            赋值 (.现行子夹, 1)
            .如果 (并且 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “一级区域”, “假”), “假”), 等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, “假”), “假”))) ' 如果选择了区域字段，则进入区域设置，否则，进入编号规则设置。
                _编号规则_被选择 ()
            .否则
                _区域设置_被选择 ()
            .如果结束
            
        .判断 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “初始化”, “初始化进度”, “0”), “3”))
            赋值 (.现行子夹, 3)
            _编号规则_被选择 ()
        .判断 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “初始化”, “初始化进度”, “0”), “6”))
            赋值 (.现行子夹, 6)
            _卡片布局_被选择 ()
        .默认
            
        .判断结束
        
    .如果结束
    赋值 (_启动窗口., 0) ' 恢复启动窗口位置使之显示。
    .如果真 (等于 (取屏幕高度 (), 600))
        赋值 (_启动窗口., 5)
    .如果真结束
    
.否则
    设置字段相关菜单 ()
    赋值 (., 1)
    .如果 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “新号方式”, “填充空号”), “填充空号”)) ' 判断上次选择的新号码产生方法。并在菜单上标记。
        赋值 (.选中, 真)
        赋值 (.选中, 假)
    .否则
        赋值 (.选中, 假)
        赋值 (.选中, 真)
    .如果结束
     ' 添加按钮.获取焦点 ()
    .如果真 (等于 (文件是否存在 (“data\jkzlib.dat”), 假)) ' 判断数据库是否存在。
        .如果真 (等于 (创建数据库 (), 假))
            信息框 (“创建健康证数据库失败！”, #错误图标, “错误”)
            结束 ()
        .如果真结束
        
    .如果真结束
    检查数据库完整 ()
    赋值 (背景音乐文件, 到文本 (读入文件 (相加 (取运行目录 (), “\music.dat”))))
    赋值 (音乐数组, 分割文本 (背景音乐文件, “?”, ))
    赋值 (_启动窗口., 0) ' 恢复启动窗口位置使之显示。
    .如果真 (等于 (取屏幕高度 (), 600))
        赋值 (_启动窗口., 5)
    .如果真结束
    赋值 (年结目录, 相加 (取运行目录 (), “\”, 到文本 (相减 (取年份 (取现行时间 ()), 1)), “data”))
    .如果真 (并且 (等于 (取月份 (取现行时间 ()), 1), 小于或等于 (取日 (取现行时间 ()), 4), 等于 (寻找文件 (年结目录, #子目录), “”))) ' 日期小于1月4日，且年结数据目录不存在，则提醒进行数据年结。
        .如果真 (等于 (信息框 (相加 (“    今天是”, 到文本 (取年份 (取现行时间 ())), “的第一个工作日，建议你将上一年度的健康证明数据进行”, #换行符, “年结，以重新开始今年的数据操作。”, #换行符, “    如果不及时进行数据年结，以后年结时，将会把今年的健康证明数据”, #换行符, “同时冻结。”, #换行符, “    要开始数据年结吗？”), 相加 (#信息图标, #是否钮), ), #是钮))
            .如果真 (不等于 (当前用户, “超级管理员”)) ' 只有管理员才能进行初始化。
                信息框 (“请以超级用户身份重新登录，并进行数据年结操作！”, #信息图标, )
                返回 ()
            .如果真结束
            .如果 (等于 (寻找文件 (年结目录, #子目录), “”))
                创建目录 (年结目录)
            .否则
                .如果真 (等于 (信息框 (相加 (到文本 (相减 (取年份 (取现行时间 ()), 1)), “年年结数据目录已经存在，你确定要再次进行数据年结操作吗？”), 相加 (#询问图标, #确认取消钮, #默认按钮二), ), #取消钮))
                    返回 ()
                .如果真结束
                
            .如果结束
            全部关闭 ()
            复制文件 (相加 (取运行目录 (), “\data\jkzlib.dat”), 相加 (年结目录, “\jkzlib.dat”))
            复制文件 (相加 (取运行目录 (), “\data\jkzlib.edt”), 相加 (年结目录, “\jkzlib.edt”))
            复制文件 (相加 (取运行目录 (), “\data\jkzlib.enx”), 相加 (年结目录, “\jkzlib.enx”))
            复制文件 (相加 (取运行目录 (), “\data\set.ini”), 相加 (年结目录, “\set.ini”))
            信息框 (“年结完成。你以后可以通过查看往年数据菜单，来查看已经年结的数据。”, #信息图标, )
            赋值 (.禁止, 假)
            .如果 (等于 (信息框 (相加 (“你准备继续使用目前的系统配置信息，还是重新进行系统初始化？”, #换行符, “如果当前的设置使用正确的话，建议你继续使用而不要轻易改变设置。”, #换行符, “点击是钮，继续使用当前配置，点击否钮，进行系统初始化。”), 相加 (#询问图标, #是否钮), ), #是钮))
                打开 (“autobak\jkzlib.dat”, “jkz”, , , , , “jkzlib.enx”) ' 打开数据库，同时打开索引文件。
                清空 ()
                关闭 ()
                打开 (“data\jkzlib.dat”, “jkz”, , , , , “jkzlib.enx”) ' 打开数据库，同时打开索引文件。
                清空 ()
                读记录 ()
            .否则
                删除文件 (“data\jkzlib.dat”) ' 删除现有数据，以便初始化以后重新创建数据库。但自动备份目录（autobak）中仍保留有现有的数据，所以实际上不会丢失。
                删除文件 (“data\jkzlib.edt”)
                删除文件 (“data\jkzlib.enx”)
                打开 (“autobak\jkzlib.dat”, “jkz”, , , , , “jkzlib.enx”) ' 打开数据库，同时打开索引文件。
                清空 ()
                全部关闭 ()
                赋值 (初始化, 1) ' 1：已经有数据后，再次进行初始化。
                 ' 载入 (初始设置窗口, , 真)
                检查配置文件 () ' 关闭初始设置窗口后，进行一系列检查，确保数据安全。
                调整卡片布局 ()
                填充初始数据 ()
                写配置项 (相加 (取运行目录 (), “\rich32.dll”), “run”, “mode”, “0”)
                检查数据库完整 ()
                复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
                记录摘要 (2)
            .如果结束
            
        .如果真结束
        
    .如果真结束
    赋值 (., 1)
    赋值 (.现行子夹, 0)
    _选择夹1_子夹被改变 ()
.如果结束
赋值 (.最大日期, 指定时间 (取年份 (取现行时间 ()), 取月份 (取现行时间 ()), 取日 (取现行时间 ()), 23, 59, 59))
.如果 (不等于 (“超级管理员”))
    赋值 (.禁止, 真)
    3.未知支持库函数_24 (真)
    4.未知支持库函数_24 (真)
.否则
    赋值 (.禁止, 假)
    3.未知支持库函数_24 (假)
    4.未知支持库函数_24 (假)
.如果结束


.子程序 _打印按钮_被单击, 空白型, , 
.局部变量 行业文本, 文本型, , , 

.判断开始 (等于 (当前操作, 0)) ' 工种设置
    集合_主界面 (“打印”)
.判断 (等于 (当前操作, 7)) ' 工种设置
    集合_工种设置 (“删除”)
.判断 (等于 (当前操作, 8)) ' 区域设置
    集合_区域设置 (“删除”)
.默认
    
.判断结束


.子程序 程序结束, 逻辑型, , 
.局部变量 目录, 文本型, , , 

.如果 (不等于 (.现行子夹, 0))
    .如果真 (等于 (信息框 (“当前设置未完成，确定要立即退出《健康证明管理系统》吗？”, 相加 (#信息图标, #是否钮), ), #否钮))
        返回 (假)
    .如果真结束
    
.否则
    .如果真 (并且 (等于 (., 假), 等于 (改变, 真)))
        信息框 (“当前记录内容被修改，尚未保存，请先保存或取消当前内容。”, #信息图标, )
        返回 (假)
    .如果真结束
    
.如果结束
全部关闭 ()
赋值 (目录, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “备份目录”, “”))
.如果真 (等于 (目录, “”)) ' 如果备份目录未设置，提示设置备份目录。
    赋值 (目录, 未知支持库函数_2 (相加 (“当前尚未设置数据备份目录。”, #换行符, “请选择你的备份数据存放的目录：”), ))
    .如果 (等于 (目录, “”))
        信息框 (“数据备份未完成！”, #信息图标, )
        写配置项 (相加 (取运行目录 (), “\rich32.dll”), “run”, “mode”, “0”)
        返回 (真)
    .否则
        写配置项 (相加 (数据目录, “\set.ini”), “杂项”, “备份目录”, 目录)
        复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
        记录摘要 (2)
    .如果结束
    
.如果真结束
赋值 (目录, 选择 (等于 (取文本右边 (目录, 1), “\”), 目录, 相加 (目录, “\”)))
.如果真 (等于 (寻找文件 (取文本左边 (目录, 相减 (取文本长度 (目录), 1)), #子目录), “”))
    信息框 (相加 (“你设置的备份目录”, #左引号, 目录, #右引号, “不存在,请重新设置备份目录！”), #信息图标, )
    赋值 (目录, 未知支持库函数_2 (相加 (“当前尚未设置数据备份目录。”, #换行符, “请选择你的备份数据存放的目录：”), ))
    .如果真 (等于 (目录, “”))
        信息框 (“数据备份未完成！”, #信息图标, )
        返回 (真)
    .如果真结束
    写配置项 (相加 (数据目录, “\set.ini”), “杂项”, “备份目录”, 目录)
    复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
    记录摘要 (2)
    赋值 (目录, 选择 (等于 (取文本右边 (目录, 1), “\”), 目录, 相加 (目录, “\”)))
.如果真结束
.如果 (并且 (复制文件 (“data\jkzlib.dat”, 相加 (目录, “jkzlib.dat”)), 复制文件 (“data\jkzlib.edt”, 相加 (目录, “jkzlib.edt”)), 复制文件 (“data\jkzlib.enx”, 相加 (目录, “jkzlib.enx”)), 复制文件 (相加 (未知支持库函数_7 (10), “jkzm.sys”), 相加 (目录, “jkzmlib.dat”))))
    信息框 (“数据备份完成！”, #信息图标, ) ' 备份成功,不再弹出信息框提示,以简化用户操作.
.否则
    信息框 (“数据备份失败！请检查你的备份目录是否可写。”, #错误图标, )
.如果结束
写配置项 (相加 (取运行目录 (), “\rich32.dll”), “run”, “mode”, “0”)
返回 (真)

.子程序 创建数据库, 逻辑型, , 
.局部变量 字段, 字段信息, , "13", 如果用户全选所有字段，则最多是13个，所以这里设定13。
.局部变量 字段序号, 整数型, , , 

赋值 (字段序号, 1)
赋值 (字段 [字段序号], 名称, “健康证号”)
赋值 (字段 [字段序号], 类型, #文本型)
赋值 (字段 [字段序号], 最大文本长度, 12)
赋值 (字段序号, 相加 (字段序号, 1))
赋值 (字段 [字段序号], 名称, “姓名”)
赋值 (字段 [字段序号], 类型, #文本型)
赋值 (字段 [字段序号], 最大文本长度, 10)
赋值 (字段序号, 相加 (字段序号, 1))
赋值 (字段 [字段序号], 名称, “性别”)
赋值 (字段 [字段序号], 类型, #文本型)
赋值 (字段 [字段序号], 最大文本长度, 2)
赋值 (字段序号, 相加 (字段序号, 1))
赋值 (字段 [字段序号], 名称, “年龄”)
赋值 (字段 [字段序号], 类型, #整数型)
赋值 (字段序号, 相加 (字段序号, 1))
赋值 (字段 [字段序号], 名称, “工种”)
赋值 (字段 [字段序号], 类型, #文本型)
赋值 (字段 [字段序号], 最大文本长度, 20) ' 以上为必须存在的字段。
赋值 (字段序号, 相加 (字段序号, 1)) ' 以下根据用户选择，增加数据库相应字段。
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “所在单位”, “假”), “真”))
    赋值 (字段 [字段序号], 名称, “所在单位”)
    赋值 (字段 [字段序号], 类型, #文本型)
    赋值 (字段 [字段序号], 最大文本长度, 40)
    赋值 (字段序号, 相加 (字段序号, 1))
.如果真结束
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “体检结果”, “假”), “真”))
    赋值 (字段 [字段序号], 名称, “体检结果”)
    赋值 (字段 [字段序号], 类型, #逻辑型)
    赋值 (字段序号, 相加 (字段序号, 1))
.如果真结束
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “培训结果”, “假”), “真”))
    赋值 (字段 [字段序号], 名称, “培训结果”)
    赋值 (字段 [字段序号], 类型, #逻辑型)
    赋值 (字段序号, 相加 (字段序号, 1))
.如果真结束
赋值 (字段 [字段序号], 名称, “发证日期”) ' 发证日期字段也必须存在，之所以放在这里，是考虑到数据库字段的顺序。
赋值 (字段 [字段序号], 类型, #日期时间型)
赋值 (字段序号, 相加 (字段序号, 1))
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “一级区域”, “假”), “真”))
    赋值 (字段 [字段序号], 名称, “一级区域”)
    赋值 (字段 [字段序号], 类型, #文本型)
    赋值 (字段 [字段序号], 最大文本长度, 8)
    赋值 (字段序号, 相加 (字段序号, 1))
.如果真结束
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, “假”), “真”))
    赋值 (字段 [字段序号], 名称, “二级区域”)
    赋值 (字段 [字段序号], 类型, #文本型)
    赋值 (字段 [字段序号], 最大文本长度, 8)
    赋值 (字段序号, 相加 (字段序号, 1))
.如果真结束
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “照片”, “假”), “真”))
    赋值 (字段 [字段序号], 名称, “照片”)
    赋值 (字段 [字段序号], 类型, #字节集型)
    赋值 (字段序号, 相加 (字段序号, 1))
.如果真结束
赋值 (字段 [字段序号], 名称, “录入者”) ' 录入者是系统自己记录的字段，不在用户选择范围。
赋值 (字段 [字段序号], 类型, #文本型)
赋值 (字段 [字段序号], 最大文本长度, 10)
重定义数组 (字段, 真, 字段序号) ' 删除末尾空数组成员。
返回 (创建 (“data\jkzlib.dat”, 字段))

.子程序 复制打印设置组件, 空白型, , 只有当数据库字段被改变时，才需要重新复制组件。
.局部变量 循环变量1, 整数型, , , 
.局部变量 位置记录, 文本型, , , 
.局部变量 位置数组, 文本型, , "3", 

.如果真 (大于 (取数组成员数 (项目), 0))
    .计次循环首 (取数组成员数 (项目), 循环变量1)
        项目选择框.销毁 ( [循环变量1])
        横向标签.销毁 ( [循环变量1])
        横向编辑框.销毁 ( [循环变量1])
        纵向标签.销毁 ( [循环变量1])
        纵向编辑框.销毁 ( [循环变量1])
    .计次循环尾 ()
.如果真结束
赋值 (.内容, 读配置项 (相加 (数据目录, “\set.ini”), “打印”, “日期间隔”, “10”))
赋值 (项目, { “标题”, “证号”, “姓名”, “性别”, “年龄”, “工种”, “发证日期” }) ' 加入需要设置打印的项目
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “所在单位”, “假”), “真”))
    加入成员 (项目, “所在单位”)
.如果真结束
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “照片”, “假”), “真”))
    加入成员 (项目, “照片”)
.如果真结束
加入成员 (项目, “体检结果”) ' 因为体检结果及培训结果，即使字段不存在，也可以打印，所以不加判断，直接加入。
加入成员 (项目, “培训结果”)
加入成员 (项目, “发证单位”)
重定义数组 (项目选择框, 假, 取数组成员数 (项目))
重定义数组 (横向标签, 假, 取数组成员数 (项目))
重定义数组 (横向编辑框, 假, 取数组成员数 (项目))
重定义数组 (纵向标签, 假, 取数组成员数 (项目))
重定义数组 (纵向编辑框, 假, 取数组成员数 (项目))
.计次循环首 (取数组成员数 (项目), 循环变量1) ' 通过复制窗口组件，显示所有项目的组件。
    复制窗口组件 (项目选择框 [循环变量1])
    赋值 (项目选择框 [循环变量1], 顶边, 相加 (30, 相乘 (相减 (循环变量1, 1), 22)))
    赋值 (项目选择框 [循环变量1], 标题, 项目 [循环变量1])
    赋值 (项目选择框 [循环变量1], 标记, 到文本 (循环变量1))
    赋值 (项目选择框 [循环变量1], 可视, 真)
    复制窗口组件 (横向标签 [循环变量1])
    赋值 (横向标签 [循环变量1], 顶边, 相加 (30, 相乘 (相减 (循环变量1, 1), 22)))
    赋值 (横向标签 [循环变量1], 可视, 真)
    复制窗口组件 (纵向标签 [循环变量1])
    赋值 (纵向标签 [循环变量1], 顶边, 相加 (30, 相乘 (相减 (循环变量1, 1), 22)))
    赋值 (纵向标签 [循环变量1], 可视, 真)
    复制窗口组件 (横向编辑框 [循环变量1])
    赋值 (横向编辑框 [循环变量1], 顶边, 相加 (30, 相乘 (相减 (循环变量1, 1), 22)))
    赋值 (横向编辑框 [循环变量1], 标记, 到文本 (循环变量1))
    赋值 (横向编辑框 [循环变量1], 可视, 真)
    复制窗口组件 (纵向编辑框 [循环变量1])
    赋值 (纵向编辑框 [循环变量1], 顶边, 相加 (30, 相乘 (相减 (循环变量1, 1), 22)))
    赋值 (纵向编辑框 [循环变量1], 标记, 到文本 (循环变量1))
    赋值 (纵向编辑框 [循环变量1], 可视, 真)
    赋值 (位置记录, 读配置项 (相加 (数据目录, “\set.ini”), “打印”, 项目 [循环变量1], 相加 (“0,0,”, 选择 (小于或等于 (循环变量1, 7), “0”, “-1”)))) ' 前6项，默认为选中，后面的，默认为不选中。
    赋值 (位置数组, 分割文本 (位置记录, “,”, ))
    赋值 (项目选择框 [循环变量1], 选中, 选择 (等于 (位置数组 [3], “0”), 真, 假))
    连续赋值 (取反 (项目选择框 [循环变量1], 选中), 横向编辑框 [循环变量1], 禁止, 纵向编辑框 [循环变量1], 禁止)
    赋值 (横向编辑框 [循环变量1], 内容, 位置数组 [1])
    赋值 (纵向编辑框 [循环变量1], 内容, 位置数组 [2])
    .如果真 (等于 (项目 [循环变量1], “照片”))
        赋值 (.顶边, 项目选择框 [循环变量1], 顶边)
        赋值 (.顶边, 项目选择框 [循环变量1], 顶边)
        赋值 (.禁止, 横向编辑框 [循环变量1], 禁止)
    .如果真结束
    刷新显示 ()
.计次循环尾 ()
.如果 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “打印”, “套打”, “真”), “假”))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
连续赋值 (.选中, 项目选择框 [1].禁止, 横向编辑框 [1].禁止, 纵向编辑框 [1].禁止, .可视, .可视, 项目选择框 [取数组成员数 (项目)].禁止, 横向编辑框 [取数组成员数 (项目)].禁止, 纵向编辑框 [取数组成员数 (项目)].禁止)
赋值 (项目选择框 [1].选中, 取反 (.选中))

.子程序 调整卡片布局, 空白型, , 录入界面中读取卡片布局
.局部变量 组件属性, 文本型, , "0", 
.局部变量 编码形式, 文本型, , , 
.局部变量 编码长度, 整数型, , , 

连续赋值 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “一级区域”, “假”), “真”), .可视, .可视) ' 根据所选字段，设置窗口组件的可视属性。
连续赋值 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, “假”), “真”), .可视, .可视)
赋值 (.标题, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “固定编码”, “0”))
赋值 (.可视, 不等于 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “固定编码”, “0”), “0”))
连续赋值 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “所在单位”, “假”), “真”), .可视, .可视)
连续赋值 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “体检结果”, “假”), “真”), .可视, .可视)
连续赋值 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “培训结果”, “假”), “真”), .可视, .可视)
连续赋值 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “照片”, “假”), “真”), .可视)
赋值 (.标题, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “一级区域名称”, “所在地区”)) ' 由于用户选择的字段可能不同，为了程序设置方便，不管该组件是否可视，都进行相关初始设置。这里是根据区域设置设定相关标签的标题。
赋值 (.标题, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “二级区域名称”, “所在乡镇”))
赋值 (.标题, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “单位名称”, “启东市卫生监督所”)) ' 设定发证单位标签标题。
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “标题”, “”), “,”, )) ' 读取每个组件的位置值（不管其是否可视），值为用“，”分隔的三个数字，左边，顶边，宽度。
.如果真 (等于 (取数组成员数 (组件属性), 3))
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
.如果真结束
清除数组 (组件属性) ' 以下重复读取各个组件的位置值，并设置位置。位置包括标签及相应的可输入的组件（组合框、编辑框等），所以有6个数字。标签左边，标签顶边，标签宽度，组件左边，组件顶边，组件宽度。
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “一级区域”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 6))
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
    到数值 (组件属性 [4]).移动 (到数值 (组件属性 [5]), 到数值 (组件属性 [6]), )
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “二级区域”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 6))
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
    到数值 (组件属性 [4]).移动 (到数值 (组件属性 [5]), 到数值 (组件属性 [6]), )
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “编号”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 9))
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
    到数值 (组件属性 [4]).移动 (到数值 (组件属性 [5]), 到数值 (组件属性 [6]), )
    到数值 (组件属性 [7]).移动 (到数值 (组件属性 [8]), 到数值 (组件属性 [9]), )
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “姓名”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 6))
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
    到数值 (组件属性 [4]).移动 (到数值 (组件属性 [5]), 到数值 (组件属性 [6]), )
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “性别”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 6))
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
    到数值 (组件属性 [4]).移动 (到数值 (组件属性 [5]), 到数值 (组件属性 [6]), )
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “工种”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 6))
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
    到数值 (组件属性 [4]).移动 (到数值 (组件属性 [5]), 到数值 (组件属性 [6]), )
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “年龄”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 6))
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
    到数值 (组件属性 [4]).移动 (到数值 (组件属性 [5]), 到数值 (组件属性 [6]), )
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “所在单位”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 6))
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
    到数值 (组件属性 [4]).移动 (到数值 (组件属性 [5]), 到数值 (组件属性 [6]), )
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “体检结果”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 6))
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
    到数值 (组件属性 [4]).移动 (到数值 (组件属性 [5]), 到数值 (组件属性 [6]), )
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “培训结果”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 6))
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
    到数值 (组件属性 [4]).移动 (到数值 (组件属性 [5]), 到数值 (组件属性 [6]), )
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “发证日期”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 6))
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
    到数值 (组件属性 [4]).移动 (到数值 (组件属性 [5]), 到数值 (组件属性 [6]), )
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “照片”, “”), “,”, )) ' 照片框有4个值：左边，顶边，宽度，高度。
.如果真 (等于 (取数组成员数 (组件属性), 4))
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), 到数值 (组件属性 [4]))
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “使用单位”, “”), “,”, )) ' 使用单位只有3个值，没有相关可输入组件，只有标签自身的左边，顶边，宽度。
.如果真 (等于 (取数组成员数 (组件属性), 3))
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “分隔条”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 3))
    .如果 (等于 (组件属性 [1], “-1”)) ' 分隔条在界面设置时保留在寄存区，说明不需要。设置其可视属性为假。
        赋值 (.可视, 假)
    .否则
        到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
    .如果结束
    
.如果真结束
赋值 (编码长度, 0)
赋值 (编码形式, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “编号规则”, “”))
.如果真 (不等于 (寻找文本 (编码形式, “区域代码”, , 假), -1))
    赋值 (编码长度, 相加 (编码长度, 到数值 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “一级区域长度”, “1”)), 到数值 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “二级区域长度”, “1”))))
.如果真结束
.如果真 (不等于 (寻找文本 (编码形式, “年份”, , 假), -1))
    赋值 (编码长度, 相加 (编码长度, 4))
.如果真结束
.如果真 (不等于 (寻找文本 (编码形式, “从业人员流水号”, , 假), -1))
    赋值 (编码长度, 相加 (编码长度, 到数值 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “流水号长度”, “4”))))
.如果真结束
赋值 (.最大允许长度, 编码长度) ' 根据设定的编码方式，设置证号编辑框的最大允许长度。

.子程序 读记录, 空白型, , 
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 真)
赋值 (., 262)
赋值 (., 361)
赋值 (., 64)
赋值 (., 163)
赋值 (., 460)
.如果 (等于 (数据目录, 相加 (取运行目录 (), “\data”)))
    赋值 (., 559)
    .如果 (等于 (取记录数 (), 0))
        连续赋值 (“”, .内容, .内容, .内容)
        连续赋值 (0, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项)
        _一级组合框1_列表项被选择 () ' 在此事件中，对二级组合框内容进行设置。
        _性别组合框1_列表项被选择 () ' 在此事件中，对照片框进行设置。
        赋值 (.现行选中项, 0)
        连续赋值 (真, .禁止, .禁止, .禁止, .禁止, .禁止, ., ., ., ., ., ., ., ., .)
        2.未知支持库函数_26 (0, 真)
        2.未知支持库函数_26 (1, 真)
        连续赋值 (假, ., .)
        1.置文本 (“记录: 0/0 ”)
        赋值 (.可视, 假)
    .否则
        赋值 (.内容, 读 (“健康证号”))
        赋值 (.内容, 读 (“姓名”))
        赋值 (.现行选中项, 读 (“性别”).选择 ())
        赋值 (.内容, 到文本 (读 (“年龄”)))
        赋值 (.现行选中项, 读 (“工种”).选择 ())
        赋值 (.今天, 读 (“发证日期”)) ' 以上为肯定存在的字段，直接读取。
        .如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “所在单位”, “假”), “真”)) ' 以下根据用户选择，读取存在的字段。对不存在的则跳过。
            赋值 (.内容, 读 (“所在单位”))
        .如果真结束
        .如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “体检结果”, “假”), “真”))
            赋值 (.现行选中项, 选择 (等于 (读 (“体检结果”), 真), 0, 1))
        .如果真结束
        .如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “培训结果”, “假”), “真”))
            赋值 (.现行选中项, 选择 (等于 (读 (“培训结果”), 真), 0, 1))
        .如果真结束
        .如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “一级区域”, “假”), “真”))
            读 (“一级区域”).选择 ()
            _一级组合框1_列表项被选择 () ' 通过此事件，设置二级区域组合框的项目，以便下面读取。
        .如果真结束
        .如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, “假”), “真”))
            读 (“二级区域”).选择 ()
        .如果真结束
        .如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “照片”, “假”), “真”))
            赋值 (.图片, 读 (“照片”))
        .如果真结束
        _性别组合框1_列表项被选择 ()
        连续赋值 (假, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, ., ., ., .)
        2.未知支持库函数_26 (0, 假)
        2.未知支持库函数_26 (1, 假)
        连续赋值 (真, ., ., ., ., ., ., .)
        .如果 (大于 (取记录数 (), 1))
            赋值 (.可视, 真)
        .否则
            赋值 (.可视, 假)
        .如果结束
        .判断开始 (等于 (取记录号 (), 1))
            0.加入状态 (#禁止)
            1.加入状态 (#禁止)
            2.去除状态 (#禁止)
            3.去除状态 (#禁止)
        .判断 (等于 (取记录号 (), 取记录数 ()))
            0.去除状态 (#禁止)
            1.去除状态 (#禁止)
            2.加入状态 (#禁止)
            3.加入状态 (#禁止)
        .默认
            0.去除状态 (#禁止)
            1.去除状态 (#禁止)
            2.去除状态 (#禁止)
            3.去除状态 (#禁止)
        .判断结束
        1.置文本 (相加 (“记录: ”, 到文本 (取记录号 ()), “/”, 到文本 (取记录数 ())))
    .如果结束
    赋值 (当前操作, 0) ' 0：无操作。
.否则
     ' 查看往年数据状态，只读取，不对菜单和按钮设置。
    赋值 (.内容, 读 (“健康证号”))
    赋值 (.内容, 读 (“姓名”))
    赋值 (.现行选中项, 读 (“性别”).选择 ())
    赋值 (.内容, 到文本 (读 (“年龄”)))
    赋值 (.现行选中项, 读 (“工种”).选择 ())
    赋值 (.今天, 读 (“发证日期”)) ' 以上为肯定存在的字段，直接读取。
    .如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “所在单位”, “假”), “真”)) ' 以下根据用户选择，读取存在的字段。对不存在的则跳过。
        赋值 (.内容, 读 (“所在单位”))
    .如果真结束
    .如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “体检结果”, “假”), “真”))
        赋值 (.现行选中项, 选择 (等于 (读 (“体检结果”), 真), 0, 1))
    .如果真结束
    .如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “培训结果”, “假”), “真”))
        赋值 (.现行选中项, 选择 (等于 (读 (“培训结果”), 真), 0, 1))
    .如果真结束
    .如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “一级区域”, “假”), “真”))
        读 (“一级区域”).选择 ()
        _一级组合框1_列表项被选择 () ' 通过此事件，设置二级区域组合框的项目，以便下面读取。
    .如果真结束
    .如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, “假”), “真”))
        读 (“二级区域”).选择 ()
    .如果真结束
    .如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “照片”, “假”), “真”))
        赋值 (.图片, 读 (“照片”))
    .如果真结束
    _性别组合框1_列表项被选择 ()
    .如果 (大于 (取记录数 (), 1))
        赋值 (.可视, 真)
    .否则
        赋值 (.可视, 假)
    .如果结束
    .判断开始 (等于 (取记录号 (), 1))
        0.加入状态 (#禁止)
        1.加入状态 (#禁止)
        2.去除状态 (#禁止)
        3.去除状态 (#禁止)
    .判断 (等于 (取记录号 (), 取记录数 ()))
        0.去除状态 (#禁止)
        1.去除状态 (#禁止)
        2.加入状态 (#禁止)
        3.加入状态 (#禁止)
    .默认
        0.去除状态 (#禁止)
        1.去除状态 (#禁止)
        2.去除状态 (#禁止)
        3.去除状态 (#禁止)
    .判断结束
    1.置文本 (相加 (“记录: ”, 到文本 (取记录号 ()), “/”, 到文本 (取记录数 ())))
    赋值 (当前操作, 13)
.如果结束


.子程序 记录摘要, 空白型, , 
.参数 对象, 字节型, , １：用户配置文件。２：系统配置文件

.局部变量 文件名, 文本型, , , 
.局部变量 配置项, 文本型, , , 
.局部变量 摘要, 文本型, , , 

.判断开始 (等于 (对象, 1))
    赋值 (文件名, 相加 (取运行目录 (), “\sysdat.ini”))
    赋值 (配置项, “user”)
.默认
    赋值 (文件名, 相加 (数据目录, “\set.ini”))
    赋值 (配置项, “sysset”)
.判断结束
赋值 (摘要, 未知支持库函数_2 (读入文件 (文件名)))
.计次循环首 (5, ) ' 判断是否成功取出了数据摘要。
    .如果 (不等于 (取文本长度 (摘要), 32))
        延时 (300)
        赋值 (摘要, 未知支持库函数_2 (读入文件 (文件名)))
    .否则
        跳出循环 ()
    .如果结束
    
.计次循环尾 ()
.如果真 (等于 (取文本长度 (摘要), 32)) ' 如果成功取出，则记录。
    写加密配置项 (相加 (未知支持库函数_7 (10), “jkzm.dat”), #密匙, “md5”, 配置项, 摘要)
.如果真结束


.子程序 检查配置文件, 空白型, , 
.局部变量 摘要, 文本型, , , 

.如果 (等于 (文件是否存在 (相加 (数据目录, “\set.ini”)), 假))
    .如果 (文件是否存在 (相加 (数据目录, “\jkzlib.dat”))) ' 如果已经创建了数据库，却没找到配置文件，说明被人非法删除了。
        .如果 (等于 (文件是否存在 (相加 (未知支持库函数_7 (10), “jkzm.sys”)), 假)) ' 如果在系统目录下找到备份文件，则自动恢复。否则，弹出信息框，警告用户，并要求其手工恢复或进行初始化。
            .如果 (等于 (信息框 (相加 (“    程序配置信息被非法删除或修改，如果你的设置文件”, #左引号, “set.ini”, #右引号, “曾经作过备份，请将备份文件复制到程序运行目录下，并更名为”, #左引号, “set.ini”, #右引号, “后重新启动本程序。”, #换行符, “    否则，请备份好程序数据目录”, #左引号, “data”, #右引号, “，并重新进行初始化设置。”, #换行符, #换行符, “    点击确认钮，进行初始化设置。点击取消钮，退出程序，并手工恢复配置信息。”), 相加 (#警告图标, #确认取消钮, #默认按钮二), “警告”), #取消钮))
                结束 ()
            .否则
                .如果真 (等于 (信息框 (“进行初始化设置可能导致数据丢失。你真的要进行初始化设置吗？”, 相加 (#询问图标, #确认取消钮, #默认按钮二), “提示”), #取消钮)) ' 因为进行系统初始化比较危险，所以这里设置了多个信息框，重复提醒。
                    结束 ()
                .如果真结束
                .如果真 (等于 (信息框 (“点击确定按钮，将开始初始化设置。点击取消按钮，退出程序。”, 相加 (#询问图标, #确认取消钮, #默认按钮二), “提示”), #取消钮))
                    结束 ()
                .如果真结束
                 ' 载入 (初始设置窗口, , 真)
            .如果结束
            
        .否则
            复制文件 (相加 (未知支持库函数_7 (10), “jkzm.sys”), 相加 (数据目录, “\set.ini”)) ' 如果系统目录下存在备份文件，则自动恢复。
            赋值 (摘要, 读加密配置项 (相加 (未知支持库函数_7 (10), “jkzm.dat”), #密匙, “md5”, “sysset”, “”))
            .如果真 (等于 (取文本长度 (摘要), 32))
                .如果真 (不等于 (未知支持库函数_2 (读入文件 (相加 (数据目录, “\set.ini”))), 摘要)) ' 文件被非法修改。
                    信息框 (相加 (“系统配置文件”, #左引号, “set.ini”, #右引号, “被非法修改！请检查《健康证明发放证明管理系统》运行有无异常！”), #信息图标, )
                .如果真结束
                
            .如果真结束
            
        .如果结束
        
    .否则
        写到文件 (相加 (数据目录, “\set.ini”), #默认配置)
        复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
        记录摘要 (2)
    .如果结束
    
.否则
    赋值 (摘要, 读加密配置项 (相加 (未知支持库函数_7 (10), “jkzm.dat”), #密匙, “md5”, “sysset”, “”))
    .如果真 (等于 (取文本长度 (摘要), 32))
        .如果真 (不等于 (未知支持库函数_2 (读入文件 (相加 (数据目录, “\set.ini”))), 摘要)) ' 文件被非法修改。
            .如果 (文件是否存在 (相加 (未知支持库函数_7 (10), “jkzm.sys”)))
                复制文件 (相加 (未知支持库函数_7 (10), “jkzm.sys”), 相加 (数据目录, “\set.ini”))
                .如果真 (不等于 (未知支持库函数_2 (读入文件 (相加 (数据目录, “\set.ini”))), 摘要)) ' 文件被非法修改。
                    信息框 (相加 (“系统文件”, #左引号, “sysdat.ini”, #右引号, “被非法修改！请检查《健康证明发放证明管理系统》运行有无异常！”), #信息图标, )
                .如果真结束
                
            .否则
                信息框 (相加 (“系统文件”, #左引号, “sysdat.ini”, #右引号, “被非法修改！请检查《健康证明发放证明管理系统》运行有无异常！”), #信息图标, )
            .如果结束
            
        .如果真结束
        
    .如果真结束
    
.如果结束


.子程序 检查数据库完整, 空白型, , 
.如果真 (等于 (读配置项 (相加 (取运行目录 (), “rich32.dll”), “run”, “mode”, “0”), “1”)) ' 如果为1，则说明上次非法退出，复制自动备份的数据库覆盖可能因为非法退出而出错的数据库。如果为0，则说明上次正常退出。
    复制文件 (“\autobak\jkzlib.dbt”, “data\jkzlib.dat”)
    复制文件 (“\autobak\jkzlib.enx”, “data\jkzlib.enx”)
.如果真结束
.如果 (等于 (打开 (“data\jkzlib.dat”, “jkz”, , , , , ), 假)) ' 如果进行了上一步判断操作后，数据为仍无法打开，则需要用通过菜单备份的数据库来恢复。这里打开（）命令没有同时打开索引文件，是防止索引文件不存在而打开失败。对索引文件的判断在下面的代码中。
    信息框 (相加 (“无法打开健康证明数据库”, “！”, 取错误信息 (), “。”, #换行符, “请用数据恢复功能恢复上次保存的数据库！”), #错误图标, “错误”)
    连续赋值 (真, .禁止, .禁止, .)
    0.加入状态 (#禁止)
    1.加入状态 (#禁止)
    2.加入状态 (#禁止)
    3.加入状态 (#禁止)
.否则
    .如果真 (等于 (文件是否存在 (“data\jkzlib.enx”), 假)) ' 打开数据库成功，则判断有无索引文件。
        .如果真 (等于 (新建索引 (“data\jkzlib.enx”, , , , “健康证号”), 假))
            信息框 (“建立数据库索引失败，请稍候重新启动程序！”, #信息图标, )
            结束 ()
        .如果真结束
        
    .如果真结束
    关闭 () ' 因为打开数据库时，没有同时打开索引文件。如果索引文件不存在，则通过上述代码新建索引，已经打开。但如果索引文件其实存在，则目前仍然未找开索引文件，需要关闭数据库，重新打开。如果数据库有单独的：打开索引文件（）命令就不用这么麻烦了，呵呵。
    .如果真 (等于 (打开 (“data\jkzlib.dat”, “jkz”, , , , , “jkzlib.enx”), 假)) ' 打开数据库，同时打开索引文件。
        信息框 (相加 (“无法打开健康证明数据库”, “！”, 取错误信息 (), “。”, #换行符, “请用数据恢复功能恢复上次保存的数据库！”), #错误图标, “错误”) ' 这里的判断其实是以防万一，一般不会发生。
        连续赋值 (真, .禁止, .禁止, .)
        0.加入状态 (#禁止)
        1.加入状态 (#禁止)
        2.加入状态 (#禁止)
        3.加入状态 (#禁止)
    .如果真结束
    到尾记录 ()
    读记录 ()
    写配置项 (相加 (取运行目录 (), “\rich32.dll”), “run”, “mode”, “1”) ' 设置数据库状态为1，在程序正常退出时，再改为0。
.如果结束


.子程序 判断编码, 逻辑型, , 
.局部变量 编码形式, 文本型, , , 
.局部变量 区域编码, 文本型, , , 
.局部变量 区域长度, 整数型, , , 
.局部变量 流水号长度, 整数型, , , 
.局部变量 记录, 短整数型, , , 

赋值 (记录, 取记录号 ())
到首记录 ()
.如果真 (等于 (索引查找 (.内容), 真)) ' 检查是否添加了重复记录。
    .如果真 (或者 (等于 (当前操作, 1), 并且 (等于 (当前操作, 2), 不等于 (取记录号 (), 记录)))) ' 剔除当前记录外，如果存在同样的证号，则说明重复了。
        信息框 (相加 (“健康证明号码”, .内容, “非法，该证号已存在。”), #错误图标, )
        获取焦点 ()
        跳到 (记录)
        返回 (假)
    .如果真结束
    
.如果真结束
跳到 (记录)
赋值 (编码形式, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “编号规则”, “”))
.如果真 (等于 (编码形式, “”))
    信息框 (“编码规则设置读取错误，请确保你的配置文件未被修改！”, #错误图标, )
    返回 (假)
.如果真结束
赋值 (流水号长度, 到数值 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “流水号长度”, “4”))) ' 以下根据设定的编码方式对证号合法性进行判断。
.判断开始 (等于 (编码形式, “固定编码 + 区域代码 + 从业人员流水号”))
    赋值 (区域编码, 读配置项 (相加 (数据目录, “\set.ini”), “一级区域”, .取项目文本 (.现行选中项), “0”))
    .如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, “假”), “真”))
        赋值 (区域编码, 相加 (区域编码, 读配置项 (相加 (数据目录, “\set.ini”), 相加 (“一级区域之”, .取项目文本 (.现行选中项)), .取项目文本 (.现行选中项), “0”)))
    .如果真结束
    赋值 (区域长度, 相加 (到数值 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “一级区域长度”, “0”)), 到数值 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “二级区域长度”, “0”))))
    .如果真 (不等于 (区域编码, 取文本左边 (.内容, 区域长度)))
        信息框 (相加 (“你所选择的区域与所输入的健康证号前”, 到文本 (区域长度), “位(区域编码)不匹配，请重新输入！”), #信息图标, )
        返回 (假)
    .如果真结束
    .如果真 (不等于 (相加 (区域长度, 流水号长度), 取文本长度 (.内容)))
        信息框 (“你所输入的健康证号流水号长度与设定的长度不同，请检查并重新输入！”, #信息图标, )
        返回 (假)
    .如果真结束
    
.判断 (等于 (编码形式, “固定编码 + 从业人员流水号”))
    .如果真 (不等于 (流水号长度, 取文本长度 (.内容)))
        信息框 (“你所输入的健康证号流水号长度与设定的长度不同，请检查并重新输入！”, #信息图标, )
        返回 (假)
    .如果真结束
    
.判断 (等于 (编码形式, “固定编码 + 年份 + 区域代码 + 从业人员流水号”))
    .如果真 (不等于 (取年份 (取现行时间 ()), 到数值 (取文本左边 (.内容, 4))))
        信息框 (“你在健康证号中所输入的年份（前4位）与当前年份不符，请重新输入！”, #信息图标, )
        返回 (假)
    .如果真结束
    赋值 (区域编码, 读配置项 (相加 (数据目录, “\set.ini”), “一级区域”, .取项目文本 (.现行选中项), “0”))
    .如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, “假”), “真”))
        赋值 (区域编码, 相加 (区域编码, 读配置项 (相加 (数据目录, “\set.ini”), 相加 (“一级区域之”, .取项目文本 (.现行选中项)), .取项目文本 (.现行选中项), “0”)))
    .如果真结束
    赋值 (区域长度, 相加 (到数值 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “一级区域长度”, “0”)), 到数值 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “二级区域长度”, “0”))))
    .如果真 (不等于 (区域编码, 取文本中间 (.内容, 5, 区域长度)))
        信息框 (相加 (“你所选择的区域与所输入的健康证号中第5位开始的”, 到文本 (区域长度), “位数字(区域编码)不匹配，请重新输入！”), #信息图标, )
        返回 (假)
    .如果真结束
    .如果真 (不等于 (相加 (区域长度, 流水号长度), 取文本长度 (.内容)))
        信息框 (“你所输入的健康证号流水号长度与设定的长度不同，请检查并重新输入！”, #信息图标, )
        返回 (假)
    .如果真结束
    
.判断 (等于 (编码形式, “固定编码 + 年份 + 从业人员流水号”))
    .如果真 (不等于 (取年份 (取现行时间 ()), 到数值 (取文本左边 (.内容, 4))))
        信息框 (“你在健康证号中所输入的年份（前4位）与当前年份不符，请重新输入！”, #信息图标, )
        返回 (假)
    .如果真结束
    .如果真 (不等于 (相加 (4, 流水号长度), 取文本长度 (.内容)))
        信息框 (“你所输入的健康证号流水号长度与设定的长度不同，请检查并重新输入！”, #信息图标, )
        返回 (假)
    .如果真结束
    
.判断 (等于 (编码形式, “年份 + 区域代码 + 从业人员流水号”))
    .如果真 (不等于 (取年份 (取现行时间 ()), 到数值 (取文本左边 (.内容, 4))))
        信息框 (“你在健康证号中所输入的年份（前4位）与当前年份不符，请重新输入！”, #信息图标, )
        返回 (假)
    .如果真结束
    赋值 (区域编码, 读配置项 (相加 (数据目录, “\set.ini”), “一级区域”, .取项目文本 (.现行选中项), “0”))
    .如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, “假”), “真”))
        赋值 (区域编码, 相加 (区域编码, 读配置项 (相加 (数据目录, “\set.ini”), 相加 (“一级区域之”, .取项目文本 (.现行选中项)), .取项目文本 (.现行选中项), “0”)))
    .如果真结束
    赋值 (区域长度, 相加 (到数值 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “一级区域长度”, “0”)), 到数值 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “二级区域长度”, “0”))))
    .如果真 (不等于 (区域编码, 取文本中间 (.内容, 5, 区域长度)))
        信息框 (相加 (“你所选择的区域与所输入的健康证号中第5位开始的”, 到文本 (区域长度), “位数字(区域编码)不匹配，请重新输入！”), #信息图标, )
        返回 (假)
    .如果真结束
    .如果真 (不等于 (相加 (4, 区域长度, 流水号长度), 取文本长度 (.内容)))
        信息框 (“你所输入的健康证号流水号长度与设定的长度不同，请检查并重新输入！”, #信息图标, )
        返回 (假)
    .如果真结束
    
.判断 (等于 (编码形式, “年份 + 从业人员流水号”))
    .如果真 (不等于 (取年份 (取现行时间 ()), 到数值 (取文本左边 (.内容, 4))))
        信息框 (“你在健康证号中所输入的年份（前4位）与当前年份不符，请重新输入！”, #信息图标, )
        返回 (假)
    .如果真结束
    .如果真 (不等于 (相加 (4, 流水号长度), 取文本长度 (.内容)))
        信息框 (“你所输入的健康证号流水号长度与设定的长度不同，请检查并重新输入！”, #信息图标, )
        返回 (假)
    .如果真结束
    
.判断 (等于 (编码形式, “区域代码 + 从业人员流水号”))
    赋值 (区域编码, 读配置项 (相加 (数据目录, “\set.ini”), “一级区域”, .取项目文本 (.现行选中项), “0”))
    .如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, “假”), “真”))
        赋值 (区域编码, 相加 (区域编码, 读配置项 (相加 (数据目录, “\set.ini”), 相加 (“一级区域之”, .取项目文本 (.现行选中项)), .取项目文本 (.现行选中项), “0”)))
    .如果真结束
    赋值 (区域长度, 相加 (到数值 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “一级区域长度”, “0”)), 到数值 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “二级区域长度”, “0”))))
    .如果真 (不等于 (区域编码, 取文本左边 (.内容, 区域长度)))
        信息框 (相加 (“你所选择的区域与所输入的健康证号前”, 到文本 (区域长度), “位(区域编码)不匹配，请重新输入！”), #信息图标, )
        返回 (假)
    .如果真结束
    .如果真 (不等于 (相加 (区域长度, 流水号长度), 取文本长度 (.内容)))
        信息框 (“你所输入的健康证号流水号长度与设定的长度不同，请检查并重新输入！”, #信息图标, )
        返回 (假)
    .如果真结束
    
.判断 (等于 (编码形式, “从业人员流水号”))
    .如果真 (不等于 (流水号长度, 取文本长度 (.内容)))
        信息框 (“你所输入的健康证号流水号长度与设定的长度不同，请检查并重新输入！”, #信息图标, )
        返回 (假)
    .如果真结束
    
.默认
    
.判断结束
返回 (真)


.子程序 判断输入, 逻辑型, , 
.如果真 (.可视) ' 对可视组件进行输入合法性判断。
    .如果真 (等于 (.现行选中项, -1))
        信息框 (相加 (“请先选择”, .标题, “！”), #信息图标, )
        获取焦点 ()
        返回 (假)
    .如果真结束
    
.如果真结束
.如果真 (.可视)
    .如果真 (等于 (.现行选中项, -1))
        信息框 (相加 (“请先选择”, .标题, “！”), #信息图标, )
        获取焦点 ()
        返回 (假)
    .如果真结束
    
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入健康证明卡片编号！”, #信息图标, )
    获取焦点 ()
    返回 (假)
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入经营者姓名！”, #信息图标, )
    获取焦点 ()
    返回 (假)
.如果真结束
.如果真 (等于 (.现行选中项, -1))
    信息框 (“请先选择经营者性别！”, #信息图标, )
    获取焦点 ()
    返回 (假)
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入经营者年龄！”, #信息图标, )
    获取焦点 ()
    返回 (假)
.如果真结束
.如果真 (等于 (.现行选中项, -1))
    信息框 (“请先选择经营者所从事的工种！”, #信息图标, )
    获取焦点 ()
    返回 (假)
.如果真结束
.如果真 (.可视)
    .如果真 (等于 (.内容, “”))
        信息框 (“请输入经营者所在单位！”, #信息图标, )
        获取焦点 ()
        返回 (假)
    .如果真结束
    
.如果真结束
.如果真 (.可视)
    .如果真 (等于 (.现行选中项, -1))
        信息框 (“请先选择经营者健康体检结果！”, #信息图标, )
        获取焦点 ()
        返回 (假)
    .如果真结束
    
.如果真结束
.如果真 (.可视)
    .如果真 (等于 (.现行选中项, -1))
        信息框 (“请先选择经营者卫生知识培训结果！”, #信息图标, )
        获取焦点 ()
        返回 (假)
    .如果真结束
    
.如果真结束
.如果真 (大于 (到时间 (时间到文本 (.今天, #日期部分)), 到时间 (时间到文本 (取现行时间 (), #日期部分))))
    信息框 (“发证日期不能大于当前日期！”, #信息图标, )
    获取焦点 ()
    返回 (假)
.如果真结束
.如果真 (.可视)
     ' 如果真 (仅显示.选中 ＝ 假 且 (照片框.图片 ＝ {  } 或 照片框.图片 ＝ #男 或 照片框.图片 ＝ #女))  ' 如果照片框不是仅仅显示，而是实际应用的，则提醒录入照片。实际使用中，请酌情修改此行代码。
     ' 如果真 (信息框 (“尚未选择经营者照片，确实要不添加照片就保存吗？”, #询问图标 ＋ #是否钮, ) ＝ #否钮)
     ' 返回 (假)
    
    
.如果真结束
返回 (真)


.子程序 填充初始数据, 空白型, , 
.局部变量 一级区域, 文本型, , "0", 
.局部变量 二级区域, 文本型, , "0", 
.局部变量 工种, 文本型, , "0", 
.局部变量 循环变量1, 整数型, , , 
.局部变量 内容, 文本型, , , 

清空 ()
清空 ()
清空 ()
取配置项名 (相加 (数据目录, “\set.ini”), “一级区域”, 一级区域)
.如果真 (大于 (取数组成员数 (一级区域), 0))
    .计次循环首 (取数组成员数 (一级区域), 循环变量1) ' 填充一级区域组合框。不管其是否可视。
        一级区域.加入项目 ( [循环变量1], )
    .计次循环尾 ()
    赋值 (.现行选中项, 0)
    取配置项名 (相加 (数据目录, “\set.ini”), 相加 (“一级区域之”, 一级区域 [1]), 二级区域)
    .如果真 (大于 (取数组成员数 (二级区域), 0))
        .计次循环首 (取数组成员数 (二级区域), 循环变量1) ' 因为一级区域组合框当前选中项是第一项，所以在二级区域组合框中填充一级区域中第一个区域下的二级区域。不管其是否可视。
            二级区域.加入项目 ( [循环变量1], )
        .计次循环尾 ()
        赋值 (.现行选中项, 0)
    .如果真结束
    
.如果真结束
赋值 (内容, 读配置项 (相加 (数据目录, “\set.ini”), “工种设置”, “工种”, “”))
赋值 (工种, 分割文本 (内容, “,”, ))
.如果真 (大于 (取数组成员数 (工种), 0))
    .计次循环首 (取数组成员数 (工种), 循环变量1) ' 填充工种组合框。
        工种.加入项目 ( [循环变量1], )
    .计次循环尾 ()
    赋值 (.现行选中项, 0)
.如果真结束


.子程序 写记录, 逻辑型, , 
.局部变量 当前记录, 整数型, , , 
.局部变量 结果, 逻辑型, , , 

 ' 由于字段的不确定性，所以不能简单地用加记录（）或修改（）来实现记录的修改和添加。必须逐个字段判断。
赋值 (当前记录, 取记录号 ())
赋值 (结果, 替换 (等于 (取记录号 (), 当前记录), “健康证号”, .内容, “姓名”, .内容, “性别”, .取项目文本 (.现行选中项), “年龄”, 到数值 (.内容), “工种”, .取项目文本 (.现行选中项), “发证日期”, .今天)) ' 先替换肯定存在的字段。
.如果真 (等于 (结果, 假))
    返回 (假)
.如果真结束
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “所在单位”, “假”), “真”)) ' 以下根据配置字段是否存在，进行记录修改。
    赋值 (结果, 写 (“所在单位”, .内容))
    .如果真 (等于 (结果, 假))
        返回 (假)
    .如果真结束
    
.如果真结束
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “体检结果”, “假”), “真”))
    赋值 (结果, 写 (“体检结果”, 选择 (等于 (.现行选中项, 0), 真, 假)))
    .如果真 (等于 (结果, 假))
        返回 (假)
    .如果真结束
    
.如果真结束
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “培训结果”, “假”), “真”))
    赋值 (结果, 写 (“培训结果”, 选择 (等于 (.现行选中项, 0), 真, 假)))
    .如果真 (等于 (结果, 假))
        返回 (假)
    .如果真结束
    
.如果真结束
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “一级区域”, “假”), “真”))
    赋值 (结果, 写 (“一级区域”, .取项目文本 (.现行选中项)))
    .如果真 (等于 (结果, 假))
        返回 (假)
    .如果真结束
    
.如果真结束
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, “假”), “真”))
    赋值 (结果, 写 (“二级区域”, .取项目文本 (.现行选中项)))
    .如果真 (等于 (结果, 假))
        返回 (假)
    .如果真结束
    
.如果真结束
.如果真 (并且 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “照片”, “假”), “真”), 不等于 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “照片来源”, “显示”), “显示”)))
    赋值 (结果, 写 (“照片”, .图片))
    .如果真 (等于 (结果, 假))
        返回 (假)
    .如果真结束
    
.如果真结束
赋值 (结果, 写 (“录入者”, 当前用户))
.如果真 (等于 (结果, 假))
    返回 (假)
.如果真结束
返回 (真)

.子程序 自动计算编码, 文本型, , 
.局部变量 编码形式, 文本型, , , 
.局部变量 区域编码, 文本型, , , 
.局部变量 流水号, 文本型, , , 
.局部变量 流水号长度, 整数型, , , 
.局部变量 记录, 短整数型, , , 
.局部变量 新证号, 文本型, , , 

赋值 (编码形式, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “编号规则”, “”))
.如果真 (等于 (编码形式, “”))
    信息框 (“编码规则设置读取错误，请确保你的配置文件未被修改！”, #错误图标, )
    结束 ()
.如果真结束
赋值 (流水号长度, 到数值 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “流水号长度”, “4”)))
.判断开始 (或者 (等于 (编码形式, “固定编码 + 区域代码 + 从业人员流水号”), 等于 (编码形式, “区域代码 + 从业人员流水号”)))
    .如果 (等于 (.选中, 真))
        赋值 (区域编码, 读配置项 (相加 (数据目录, “\set.ini”), “一级区域”, .取项目文本 (.现行选中项), “0”))
        .如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, “假”), “真”))
            赋值 (区域编码, 相加 (区域编码, 读配置项 (相加 (数据目录, “\set.ini”), 相加 (“一级区域之”, .取项目文本 (.现行选中项)), .取项目文本 (.现行选中项), “0”)))
        .如果真结束
        .如果真 (等于 (到数值 (区域编码), 0))
            赋值 (区域编码, “”)
        .如果真结束
        赋值 (流水号, 取文本右边 (“000000000000000000000001”, 流水号长度))
        到首记录 ()
        赋值 (新证号, 相加 (区域编码, 流水号))
        .判断循环首 (等于 (索引查找 (新证号), 真)) ' 索引查找新证号，如果不存在，则填充该号码。以下同
            赋值 (流水号, 取文本右边 (相加 (取重复文本 (流水号长度, “0”), 到文本 (相加 (到数值 (流水号), 1))), 流水号长度)) ' 将区域编码与流水号分开，只对流水号进行增减，防止出于大数溢出。以下同。
            赋值 (新证号, 相加 (区域编码, 流水号))
            到首记录 ()
        .判断循环尾 ()
    .否则
        赋值 (新证号, 到文本 (取最大值 (到数值 (读 (“健康证号”)), 并且 (等于 (读 (“一级区域”), .取项目文本 (.现行选中项)), 等于 (读 (“二级区域”), .取项目文本 (.现行选中项))))))
        赋值 (新证号, 相加 (取文本左边 (新证号, 相减 (取文本长度 (新证号), 流水号长度)), 取文本右边 (相加 (取重复文本 (流水号长度, “0”), 到文本 (相加 (到数值 (取文本右边 (新证号, 流水号长度)), 1))), 流水号长度)))
    .如果结束
    
.判断 (或者 (等于 (编码形式, “固定编码 + 从业人员流水号”), 等于 (编码形式, “从业人员流水号”)))
    .如果 (等于 (.选中, 真))
        赋值 (流水号, 取文本右边 (“000000000000000000000001”, 流水号长度))
        到首记录 ()
        赋值 (新证号, 流水号)
        .判断循环首 (等于 (索引查找 (新证号), 真))
            赋值 (流水号, 取文本右边 (相加 (取重复文本 (流水号长度, “0”), 到文本 (相加 (到数值 (流水号), 1))), 流水号长度))
            赋值 (新证号, 流水号)
            到首记录 ()
        .判断循环尾 ()
    .否则
        赋值 (新证号, 到文本 (取最大值 (到数值 (读 (“健康证号”)), )))
        赋值 (新证号, 取文本右边 (相加 (取重复文本 (流水号长度, “0”), 到文本 (相加 (到数值 (新证号), 1))), 流水号长度))
    .如果结束
    
.判断 (或者 (等于 (编码形式, “固定编码 + 年份 + 区域代码 + 从业人员流水号”), 等于 (编码形式, “年份 + 区域代码 + 从业人员流水号”)))
    .如果 (等于 (.选中, 真))
        赋值 (区域编码, 相加 (读配置项 (相加 (数据目录, “\set.ini”), “一级区域”, .取项目文本 (.现行选中项), “0”), 读配置项 (相加 (数据目录, “\set.ini”), 相加 (“一级区域之”, .取项目文本 (.现行选中项)), .取项目文本 (.现行选中项), “0”)))
        .如果真 (等于 (到数值 (区域编码), 0))
            赋值 (区域编码, “”)
        .如果真结束
        赋值 (流水号, 取文本右边 (“000000000000000000000001”, 流水号长度))
        到首记录 ()
        赋值 (新证号, 相加 (到文本 (取年份 (取现行时间 ())), 区域编码, 流水号))
        .判断循环首 (等于 (索引查找 (新证号), 真))
            赋值 (流水号, 取文本右边 (相加 (取重复文本 (流水号长度, “0”), 到文本 (相加 (到数值 (流水号), 1))), 流水号长度))
            赋值 (新证号, 相加 (到文本 (取年份 (取现行时间 ())), 区域编码, 流水号))
            到首记录 ()
        .判断循环尾 ()
    .否则
        赋值 (新证号, 到文本 (取最大值 (到数值 (读 (“健康证号”)), 并且 (等于 (读 (“一级区域”), .取项目文本 (.现行选中项)), 等于 (读 (“二级区域”), .取项目文本 (.现行选中项)), 等于 (取文本左边 (读 (“健康证号”), 4), 到文本 (取年份 (取现行时间 ())))))))
        赋值 (新证号, 相加 (取文本左边 (新证号, 相减 (取文本长度 (新证号), 流水号长度)), 取文本右边 (相加 (取重复文本 (流水号长度, “0”), 到文本 (相加 (到数值 (取文本右边 (新证号, 流水号长度)), 1))), 流水号长度)))
    .如果结束
    
.判断 (或者 (等于 (编码形式, “固定编码 + 年份 + 从业人员流水号”), 等于 (编码形式, “年份 + 从业人员流水号”)))
    .如果 (等于 (.选中, 真))
        赋值 (流水号, 取文本右边 (“000000000000000000000001”, 流水号长度))
        到首记录 ()
        赋值 (新证号, 相加 (到文本 (取年份 (取现行时间 ())), 流水号))
        .判断循环首 (等于 (索引查找 (新证号), 真))
            赋值 (流水号, 取文本右边 (相加 (取重复文本 (流水号长度, “0”), 到文本 (相加 (到数值 (流水号), 1))), 流水号长度))
            赋值 (新证号, 相加 (到文本 (取年份 (取现行时间 ())), 流水号))
            到首记录 ()
        .判断循环尾 ()
    .否则
        赋值 (新证号, 到文本 (取最大值 (到数值 (读 (“健康证号”)), 等于 (取文本左边 (读 (“健康证号”), 4), 到文本 (取年份 (取现行时间 ()))))))
        赋值 (新证号, 相加 (取文本左边 (新证号, 相减 (取文本长度 (新证号), 流水号长度)), 取文本右边 (相加 (取重复文本 (流水号长度, “0”), 到文本 (相加 (到数值 (取文本右边 (新证号, 流水号长度)), 1))), 流水号长度)))
    .如果结束
    
.默认
    
.判断结束
返回 (新证号)

.子程序 _数据备份_被选择, 空白型, , 
.局部变量 目录, 文本型, , , 
.局部变量 文本, 文本型, , , 

赋值 (., 0)
赋值 (., 1)
赋值 (目录, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “备份目录”, “”))
.如果真 (等于 (目录, “”))
    赋值 (目录, 未知支持库函数_2 (相加 (“当前尚未设置数据备份目录。”, #换行符, “请选择你的备份数据存放的目录：”), ))
    .如果真 (等于 (目录, “”))
        信息框 (“数据备份未完成！”, #信息图标, )
        返回 ()
    .如果真结束
    写配置项 (相加 (数据目录, “\set.ini”), “杂项”, “备份目录”, 目录)
    复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
    记录摘要 (2)
.如果真结束
赋值 (目录, 选择 (等于 (取文本右边 (目录, 1), “\”), 目录, 相加 (目录, “\”)))
.如果真 (等于 (寻找文件 (取文本左边 (目录, 相减 (取文本长度 (目录), 1)), #子目录), “”))
    信息框 (相加 (“你设置的备份目录”, #左引号, 目录, #右引号, “不存在,请重新设置备份目录！”), #信息图标, )
    赋值 (目录, 未知支持库函数_2 (相加 (“当前尚未设置数据备份目录。”, #换行符, “请选择你的备份数据存放的目录：”), ))
    .如果真 (等于 (目录, “”))
        信息框 (“数据备份未完成！”, #信息图标, )
        返回 ()
    .如果真结束
    写配置项 (相加 (数据目录, “\set.ini”), “杂项”, “备份目录”, 目录)
    复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
    记录摘要 (2)
    赋值 (目录, 选择 (等于 (取文本右边 (目录, 1), “\”), 目录, 相加 (目录, “\”)))
.如果真结束
.如果 (并且 (复制文件 (“data\jkzlib.dat”, 相加 (目录, “jkzlib.dat”)), 复制文件 (“data\jkzlib.edt”, 相加 (目录, “jkzlib.edt”)), 复制文件 (“data\jkzlib.enx”, 相加 (目录, “jkzlib.enx”)), 复制文件 (相加 (未知支持库函数_7 (10), “jkzm.sys”), 相加 (目录, “jkzmlib.dat”))))
    信息框 (“数据备份完成！”, #信息图标, )
.否则
    信息框 (“数据备份失败！”, #错误图标, )
.如果结束


.子程序 _数据恢复_被选择, 空白型, , 
.局部变量 目录, 文本型, , , 
.局部变量 返回文本, 文本型, , , 
.局部变量 当前号, 整数型, , , 

.如果真 (不等于 (当前用户, “超级管理员”))
    信息框 (“对不起，你不是超级用户，无权执行数据恢复操作！”, #信息图标, )
    返回 ()
.如果真结束
赋值 (当前号, 取记录号 ())
赋值 (目录, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “备份目录”, “”))
.如果真 (或者 (等于 (目录, “”), 等于 (寻找文件 (目录, #子目录), “”)))
    信息框 (“你尚未设置数据备份目录或设置的数据备份目录不正确，无法恢复数据！”, #信息图标, )
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“你确定要用备份的数据恢复并覆盖现有数据吗？”, 相加 (#询问图标, #是否钮), ), #否钮))
    返回 ()
.如果真结束
赋值 (., 0)
赋值 (., 2)
全部关闭 ()
赋值 (目录, 选择 (等于 (取文本右边 (目录, 1), “\”), 目录, 相加 (目录, “\”)))
.如果 (并且 (文件是否存在 (相加 (目录, “jkzlib.dat”)), 文件是否存在 (相加 (目录, “jkzmlib.dat”)), 文件是否存在 (相加 (目录, “jkzlib.edt”)), 文件是否存在 (相加 (目录, “jkzlib.enx”))))
    .如果 (并且 (复制文件 (相加 (目录, “jkzlib.dat”), “data\jkzlib.dat”), 复制文件 (相加 (目录, “jkzmlib.dat”), 相加 (数据目录, “\set.ini”)), 复制文件 (相加 (目录, “jkzlib.enx”), “data\jkzlib.enx”), 复制文件 (相加 (目录, “jkzlib.edt”), “data\jkzlib.edt”)))
        复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
        记录摘要 (2)
        信息框 (“数据恢复完成！”, #信息图标, )
        连续赋值 (假, .禁止, .禁止, .)
    .否则
        信息框 (“数据恢复失败！”, #错误图标, )
    .如果结束
    
.否则
    信息框 (“数据备份文件缺失！恢复未完成。”, #信息图标, )
.如果结束
打开 (“data\jkzlib.dat”, “jkz”, , , , , “data\jkzlib.enx”)
到尾记录 ()
读记录 ()

.子程序 _添加新记录_被选择, 空白型, , 
赋值 (., 1)
赋值 (., 0)
禁止卷帘菜单 (真)
禁止菜单 (真)
连续赋值 (“”, .内容, .内容, .内容)
赋值 (.今天, 取现行时间 ())
赋值 (当前操作, 1) ' 1：添加操作。
连续赋值 (真, .禁止, .禁止, .禁止, ., ., ., .禁止, .禁止, .禁止)
连续赋值 (0, .现行选中项, .现行选中项)
赋值 (.图片, {  })
_性别组合框1_列表项被选择 ()
连续赋值 (假, ., ., .可视)
1.置文本 (相加 (“记录:”, 到文本 (相加 (取记录数 (), 1)), “/”, 到文本 (相加 (取记录数 (), 1))))
赋值 (.禁止, 假)
获取焦点 ()

.子程序 _修改记录_被选择, 空白型, , 
赋值 (., 1)
赋值 (., 1)
禁止卷帘菜单 (真)
禁止菜单 (真)
赋值 (.禁止, 假)
赋值 (当前操作, 2) ' 2：修改操作。
连续赋值 (真, .禁止, .禁止, .禁止, ., .禁止, .禁止, .禁止, ., .)
连续赋值 (假, ., ., .可视)
获取焦点 ()

.子程序 _删除记录_被选择, 空白型, , 
.局部变量 当前记录, 整数型, , , 

.如果真 (不等于 (当前用户, “超级管理员”))
    信息框 (“对不起，你不是超级用户，无权删除健康证记录！”, #信息图标, )
    返回 ()
.如果真结束
赋值 (., 1)
赋值 (., 2)
赋值 (当前记录, 取记录号 ())
.如果真 (等于 (信息框 (相加 (“记录删除后将不可恢复，确认要删除”, 读 (“健康证号”), “号吗？”), 相加 (#警告图标, #是否钮, #默认按钮二), “警告”), #是钮))
    删除 ()
    彻底删除 ()
    赋值 (当前操作, 0) ' 无操作
    .如果真 (大于 (当前记录, 取记录数 ())) ' 删除一条记录后，顺序显示下一条记录。如果删除了尾记录，则继续显示删除记录后的数据库尾记录。
        赋值 (当前记录, 取记录数 ())
    .如果真结束
    跳到 (当前记录)
    1.置文本 (相加 (“记录:”, 到文本 (取记录号 ()), “/”, 到文本 (取记录数 ())))
    复制文件 (“data\jkzlib.dat”, “\autobak\jkzlib.dbt”) ' 删除数据后，及时自动备份。
    复制文件 (“data\jkzlib.enx”, “\autobak\jkzlib.enx”)
    复制文件 (“data\xzlib.dat”, “\autobak\xzlib.dbt”)
    读记录 ()
.如果真结束


.子程序 _查找记录_被选择, 空白型, , 
.如果 (等于 (当前操作, 13))
    赋值 (是否在查找中, 真)
.否则
    赋值 (是否在查找中, 假)
.如果结束
赋值 (., 1)
赋值 (., 3)
禁止卷帘菜单 (真)
禁止菜单 (真)
赋值 (当前操作, 3) ' 查找记录
赋值 (.现行子夹, 11)
_选择夹1_子夹被改变 ()
赋值 (.内容, “”)
赋值 (., “开始查找(&F)”)
赋值 (., #查找)
赋值 (., 146)
赋值 (., 392)
连续赋值 (真, ., .)
连续赋值 (假, ., ., .可视, ., ., ., .)
_查找姓名单选框_被单击 ()

.子程序 _用编辑器查看_被选择, 空白型, , 
.局部变量 当前记录, 整数型, , , 

.如果真 (不等于 (当前用户, “超级管理员”))
    信息框 (“对不起，你不是超级用户，无权用编辑器方式查看健康证明记录！”, #信息图标, )
    返回 ()
.如果真结束
赋值 (., 1)
赋值 (., 4)
赋值 (当前记录, 取记录号 ()) ' 此功能可以以编辑器形式查看数据库，包括查看录入者姓名。
编辑 (“查看健康证明数据库”, 相加 (#禁止修改, #禁止添加, #禁止删除), )
跳到 (当前记录)

.子程序 _数据统计_被选择, 空白型, , 
赋值 (., 1)
赋值 (., 5)
载入 (统计窗口, , 真)

.子程序 _关于_被选择, 空白型, , 
赋值 (., 7)
赋值 (., 2)
载入 (关于窗口, , 真)
 ' 卷帘式菜单1.现行选中菜单 ＝ 1

.子程序 _一级组合框1_列表项被选择, 空白型, , 
.局部变量 二级区域, 文本型, , "0", 
.局部变量 循环变量1, 整数型, , , 
.局部变量 二级区域1, 文本型, , "0", 
.局部变量 变量2, 整数型, , , 

清空 () ' 根据一级组合框选择的一级区域，重新设置二级组合框中的二级区域项目。
取配置项名 (相加 (数据目录, “\set.ini”), 相加 (“一级区域之”, .取项目文本 (.现行选中项)), 二级区域)
.如果真 (大于 (取数组成员数 (二级区域), 0))
    .计次循环首 (取数组成员数 (二级区域), 循环变量1)
        二级区域.加入项目 ( [循环变量1], )
    .计次循环尾 ()
    赋值 (.现行选中项, 0)
.如果真结束
赋值 (.现行选中项, 0)
赋值 (改变, 真)

.子程序 _二级组合框1_列表项被选择, 空白型, , 
赋值 (改变, 真)

.子程序 _性别组合框1_列表项被选择, 空白型, , 
赋值 (改变, 真)
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “照片来源”, “显示”), “显示”))
    赋值 (.图片, 选择 (等于 (.现行选中项, 0), #男, #女))
.如果真结束


.子程序 _工种组合框1_列表项被选择, 空白型, , 
赋值 (改变, 真)

.子程序 _工具条画板_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

161.发送信息 (2, 0)

.子程序 _打印当前健康证_被选择, 空白型, , 
.局部变量 是否套打, 逻辑型, , , 
.局部变量 打印项目, 文本型, , "0", 
.局部变量 纵向位置, 整数型, , , 
.局部变量 位置文本, 文本型, , , 
.局部变量 位置数组, 文本型, , "3", 
.局部变量 照片宽度, 整数型, , , 
.局部变量 循环变量1, 整数型, , , 
.局部变量 打印内容, 文本型, , , 
.局部变量 图片句柄, 整数型, , , 

赋值 (., 2)
赋值 (., 0)
赋值 (打印项目, { “标题”, “证号”, “姓名”, “性别”, “年龄”, “工种”, “发证日期” }) ' 先添加固定打印项目。
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “一级区域”, “假”), “真”)) ' 以下根据设置添加其它打印项目。
    加入成员 (打印项目, “一级区域”)
.如果真结束
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, “假”), “真”))
    加入成员 (打印项目, “二级区域”)
.如果真结束
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “所在单位”, “假”), “真”))
    加入成员 (打印项目, “所在单位”)
.如果真结束
.如果真 (并且 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “照片”, “假”), “真”), 不等于 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “照片来源”, “显示”), “显示”)))
    加入成员 (打印项目, “照片”)
.如果真结束
加入成员 (打印项目, “体检结果”) ' 体检结果与培训结果，无论是否存在该字段，均可以打印，所以这里不加判断，直接加上。
加入成员 (打印项目, “培训结果”)
加入成员 (打印项目, “发证单位”)
赋值 (是否套打, 等于 (读配置项 (相加 (数据目录, “\set.ini”), “打印”, “套打”, “真”), “真”))
赋值 (.打印作业名, 相加 (“打印健康证第”, #左引号, 读 (“健康证号”), #右引号, “号”))
赋值 (.字体.字体大小, 12)
假.开始打印 ()
.如果 (是否套打)
    .计次循环首 (取数组成员数 (打印项目), 循环变量1) ' 套打，忽略“标题”和“发证单位”两个项目不进行判断和打印。
        .判断开始 (等于 (打印项目 [循环变量1], “证号”)) ' 根据打印项目，设置打印内容。
            赋值 (打印内容, .内容)
        .判断 (等于 (打印项目 [循环变量1], “姓名”))
            赋值 (打印内容, .内容)
        .判断 (等于 (打印项目 [循环变量1], “性别”))
            赋值 (打印内容, .取项目文本 (.现行选中项))
        .判断 (等于 (打印项目 [循环变量1], “年龄”))
            赋值 (打印内容, .内容)
        .判断 (等于 (打印项目 [循环变量1], “工种”))
            赋值 (打印内容, .取项目文本 (.现行选中项))
        .判断 (等于 (打印项目 [循环变量1], “一级区域”))
            赋值 (打印内容, .取项目文本 (.现行选中项))
        .判断 (等于 (打印项目 [循环变量1], “二级区域”))
            赋值 (打印内容, .取项目文本 (.现行选中项))
        .判断 (等于 (打印项目 [循环变量1], “所在单位”))
            赋值 (打印内容, .标题)
        .判断 (等于 (打印项目 [循环变量1], “体检结果”))
            赋值 (打印内容, .取项目文本 (.现行选中项)) ' 组合框默认选择文本为：合格。
        .判断 (等于 (打印项目 [循环变量1], “培训结果”))
            赋值 (打印内容, .取项目文本 (.现行选中项)) ' 组合框默认选择文本为：合格。
        .默认
            
        .判断结束
        赋值 (位置文本, 读配置项 (相加 (数据目录, “\set.ini”), “打印”, 打印项目 [循环变量1], 相加 (“0,0,”, 选择 (并且 (大于或等于 (循环变量1, 1), 小于或等于 (循环变量1, 7)), “0”, “-1”)))) ' 前7个项目，默认为打印（0），后面的项目，默认为不打印（-1）。
        赋值 (位置数组, 分割文本 (位置文本, “,”, )) ' 位置有3个数值：左边，顶边，是否打印。
        .如果真 (等于 (位置数组 [3], “0”))
            赋值 (.绘画单位, 1)
            赋值 (.字体.字体名称, “宋体”)
            赋值 (.字体.字体大小, 12) ' 恢复字体。
            .判断开始 (等于 (打印项目 [循环变量1], “照片”))
                赋值 (照片宽度, 相乘 (到数值 (读配置项 (相加 (数据目录, “\set.ini”), “打印”, “照片宽度”, “24”)), 10))
                赋值 (图片句柄, 载入图片 (.图片))
                图片句柄.画图片 (相乘 (到数值 (位置数组 [1]), 10), 相乘 (到数值 (位置数组 [2]), 10), 照片宽度, 相乘 (相除 (照片宽度, 4), 5), ) ' 照片打印的宽高比固定为4：5，所以只要读取宽度，就可以知道高度。
                卸载图片 (图片句柄)
            .判断 (等于 (打印项目 [循环变量1], “发证日期”))
                赋值 (.字体.字体名称, “宋体”)
                赋值 (.字体.字体大小, 12) ' 恢复字体。
                相减 (相乘 (到数值 (位置数组 [1]), 10), 20).定位写出 (相乘 (到数值 (位置数组 [2]), 10), 取年份 (.今天)) ' 套打时，年月日要分开打印。所以加上间隔距离。
                相加 (相乘 (到数值 (位置数组 [1]), 10), 相乘 (到数值 (读配置项 (相加 (数据目录, “\set.ini”), “打印”, “日期间隔”, “10”)), 10), 10).定位写出 (相乘 (到数值 (位置数组 [2]), 10), 取月份 (.今天)) ' 因为年份有4位数，所以后面的间隔多加1毫米。（10）
                相加 (相乘 (到数值 (位置数组 [1]), 10), 相乘 (到数值 (读配置项 (相加 (数据目录, “\set.ini”), “打印”, “日期间隔”, “10”)), 20), 10).定位写出 (相乘 (到数值 (位置数组 [2]), 10), 取日 (.今天))
            .默认
                相乘 (到数值 (位置数组 [1]), 10).定位写出 (相乘 (到数值 (位置数组 [2]), 10), 打印内容) ' 其它项目直接打印。
            .判断结束
            
        .如果真结束
        
    .计次循环尾 ()
.否则
     ' 不是套打，则打印内容包括标题和实际内容。
    .计次循环首 (取数组成员数 (打印项目), 循环变量1)
        .判断开始 (等于 (打印项目 [循环变量1], “标题”))
            赋值 (打印内容, “健 康 证 明”)
        .判断 (等于 (打印项目 [循环变量1], “证号”))
            .如果 (.可视)
                赋值 (打印内容, 相加 (“证号：”, .标题, “ ”, .内容))
            .否则
                赋值 (打印内容, 相加 (“证号：”, .内容))
            .如果结束
            
        .判断 (等于 (打印项目 [循环变量1], “姓名”))
            赋值 (打印内容, 相加 (“姓名：”, .内容))
        .判断 (等于 (打印项目 [循环变量1], “性别”))
            赋值 (打印内容, 相加 (“性别：”, .取项目文本 (.现行选中项)))
        .判断 (等于 (打印项目 [循环变量1], “年龄”))
            赋值 (打印内容, 相加 (“年龄：”, .内容))
        .判断 (等于 (打印项目 [循环变量1], “工种”))
            赋值 (打印内容, 相加 (“工种：”, .取项目文本 (.现行选中项)))
        .判断 (等于 (打印项目 [循环变量1], “发证日期”))
            赋值 (打印内容, 相加 (“发证日期：”, 时间到文本 (.今天, #日期部分)))
        .判断 (等于 (打印项目 [循环变量1], “一级区域”))
            赋值 (打印内容, 相加 (.标题, “：”, .取项目文本 (.现行选中项)))
        .判断 (等于 (打印项目 [循环变量1], “二级区域”))
            赋值 (打印内容, 相加 (.标题, “：”, .取项目文本 (.现行选中项)))
        .判断 (等于 (打印项目 [循环变量1], “所在单位”))
            赋值 (打印内容, 相加 (“单位：”, .标题))
        .判断 (等于 (打印项目 [循环变量1], “体检结果”))
            赋值 (打印内容, 相加 (“体检：”, .取项目文本 (.现行选中项)))
        .判断 (等于 (打印项目 [循环变量1], “培训结果”))
            赋值 (打印内容, 相加 (“培训：”, .取项目文本 (.现行选中项)))
        .判断 (等于 (打印项目 [循环变量1], “发证单位”))
            赋值 (打印内容, .标题)
        .默认
            
        .判断结束
        赋值 (位置文本, 读配置项 (相加 (数据目录, “\set.ini”), “打印”, 打印项目 [循环变量1], 相加 (“0,0,”, 选择 (并且 (大于或等于 (循环变量1, 1), 小于或等于 (循环变量1, 7)), “0”, “-1”)))) ' 同套打。
        赋值 (位置数组, 分割文本 (位置文本, “,”, ))
        .如果真 (等于 (位置数组 [3], “0”))
            赋值 (.绘画单位, 1)
            赋值 (.字体.字体名称, “宋体”)
            赋值 (.字体.字体大小, 12) ' 恢复字体。
            .判断开始 (等于 (打印项目 [循环变量1], “标题”)) ' 标题字体相应增大。
                赋值 (.字体.字体名称, “黑体”)
                赋值 (.字体.字体大小, 16)
                相乘 (到数值 (位置数组 [1]), 10).定位写出 (相乘 (到数值 (位置数组 [2]), 10), 打印内容)
            .判断 (等于 (打印项目 [循环变量1], “照片”))
                赋值 (照片宽度, 相乘 (到数值 (读配置项 (相加 (数据目录, “\set.ini”), “打印”, “照片宽度”, “24”)), 10))
                赋值 (图片句柄, 载入图片 (.图片))
                图片句柄.画图片 (相乘 (到数值 (位置数组 [1]), 10), 相乘 (到数值 (位置数组 [2]), 10), 照片宽度, 相乘 (相除 (照片宽度, 4), 5), )
                卸载图片 (图片句柄)
                0.置写出位置 (0)
            .默认
                相乘 (到数值 (位置数组 [1]), 10).定位写出 (相乘 (到数值 (位置数组 [2]), 10), 打印内容) ' 因为不是套打，日期可以连续打印而不必要分年月日，所以这里不需要进行单独判断，而与其它项目一样，直接打印。
            .判断结束
            
        .如果真结束
        
    .计次循环尾 ()
.如果结束
结束打印 ()

.子程序 _批量打印健康证_被选择, 空白型, , 
.局部变量 打印证号, 整数型, , , 
.局部变量 证号长度, 整数型, , , 
.局部变量 索引号, 整数型, , , 
.局部变量 卡片设置, 文本型, , , 
.局部变量 卡片数值组, 文本型, , "3", 
.局部变量 位置文本, 文本型, , , 
.局部变量 位置数组, 文本型, , "3", 
.局部变量 循环变量1, 整数型, , , 
.局部变量 打印内容, 文本型, , , 
.局部变量 打印项目, 文本型, , "0", 
.局部变量 是否套打, 逻辑型, , , 
.局部变量 照片宽度, 整数型, , , 
.局部变量 图片句柄, 整数型, , , 

赋值 (., 2)
赋值 (., 1)
赋值 (打印项目, { “标题”, “证号”, “姓名”, “性别”, “年龄”, “工种”, “发证日期” }) ' 同单独打印。因为涉及到健康证明连纸张数判断，所以没有和单独打印代码合并。
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “一级区域”, “假”), “真”))
    加入成员 (打印项目, “一级区域”)
.如果真结束
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, “假”), “真”))
    加入成员 (打印项目, “二级区域”)
.如果真结束
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “所在单位”, “假”), “真”))
    加入成员 (打印项目, “所在单位”)
.如果真结束
.如果真 (并且 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “照片”, “假”), “真”), 不等于 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “照片来源”, “显示”), “显示”)))
    加入成员 (打印项目, “照片”)
.如果真结束
加入成员 (打印项目, “体检结果”)
加入成员 (打印项目, “培训结果”)
加入成员 (打印项目, “发证单位”)
赋值 (是否套打, 等于 (读配置项 (相加 (数据目录, “\set.ini”), “打印”, “套打”, “真”), “真”))
载入 (批量打印窗口, , 真)
赋值 (卡片设置, 读配置项 (相加 (数据目录, “\set.ini”), “打印”, “卡片”, “95，65，4”))
赋值 (卡片数值组, 分割文本 (卡片设置, “,”, ))
赋值 (索引号, 1) ' 用以和卡片连续张数进行比较。
.如果真 (批量打印)
    赋值 (.打印作业名, 相加 (“打印健康证第”, 证号一, “到”, 证号二, “号”))
    假.开始打印 ()
    .变量循环首 (到数值 (证号一), 到数值 (证号二), 1, 打印证号)
        到首记录 ()
        赋值 (证号长度, 取文本长度 (证号一))
        .如果 (查找 (并且 (等于 (读 (“健康证号”), 取文本右边 (相加 (取重复文本 (证号长度, “0”), 到文本 (打印证号)), 证号长度)), 等于 (取年份 (读 (“发证日期”)), 取年份 (取现行时间 ())))))
            读记录 () ' 将记录内容读到界面中，以方便打印时读取。
            .如果 (是否套打)
                .计次循环首 (取数组成员数 (打印项目), 循环变量1)
                    .判断开始 (等于 (打印项目 [循环变量1], “证号”))
                        赋值 (打印内容, .内容)
                    .判断 (等于 (打印项目 [循环变量1], “姓名”))
                        赋值 (打印内容, .内容)
                    .判断 (等于 (打印项目 [循环变量1], “性别”))
                        赋值 (打印内容, .取项目文本 (.现行选中项))
                    .判断 (等于 (打印项目 [循环变量1], “年龄”))
                        赋值 (打印内容, .内容)
                    .判断 (等于 (打印项目 [循环变量1], “工种”))
                        赋值 (打印内容, .取项目文本 (.现行选中项))
                    .判断 (等于 (打印项目 [循环变量1], “一级区域”))
                        赋值 (打印内容, .取项目文本 (.现行选中项))
                    .判断 (等于 (打印项目 [循环变量1], “二级区域”))
                        赋值 (打印内容, .取项目文本 (.现行选中项))
                    .判断 (等于 (打印项目 [循环变量1], “所在单位”))
                        赋值 (打印内容, .标题)
                    .判断 (等于 (打印项目 [循环变量1], “体检结果”))
                        赋值 (打印内容, .取项目文本 (.现行选中项))
                    .判断 (等于 (打印项目 [循环变量1], “培训结果”))
                        赋值 (打印内容, .取项目文本 (.现行选中项))
                    .默认
                        
                    .判断结束
                    赋值 (位置文本, 读配置项 (相加 (数据目录, “\set.ini”), “打印”, 打印项目 [循环变量1], 相加 (“0,0,”, 选择 (并且 (大于或等于 (循环变量1, 1), 小于或等于 (循环变量1, 7)), “0”, “-1”))))
                    赋值 (位置数组, 分割文本 (位置文本, “,”, ))
                    .如果真 (等于 (位置数组 [3], “0”))
                        赋值 (.绘画单位, 1)
                        赋值 (.字体.字体名称, “宋体”)
                        赋值 (.字体.字体大小, 12)
                        .判断开始 (等于 (打印项目 [循环变量1], “照片”))
                            赋值 (照片宽度, 相乘 (到数值 (读配置项 (相加 (数据目录, “\set.ini”), “打印”, “照片宽度”, “24”)), 10))
                            赋值 (图片句柄, 载入图片 (.图片))
                            图片句柄.画图片 (相乘 (到数值 (位置数组 [1]), 10), 相加 (相乘 (相减 (索引号, 1), 到数值 (卡片数值组 [2]), 10), 相乘 (到数值 (位置数组 [2]), 10)), 照片宽度, 相乘 (相除 (照片宽度, 4), 5), ) ' 这里的（索引号 － 1) × 到数值 (卡片数值组 [2]) × 10 用于控制连纸打印的位置。下同。
                            卸载图片 (图片句柄)
                            0.置写出位置 (0)
                        .判断 (等于 (打印项目 [循环变量1], “发证日期”))
                            相减 (相乘 (到数值 (位置数组 [1]), 10), 20).定位写出 (相加 (相乘 (相减 (索引号, 1), 到数值 (卡片数值组 [2]), 10), 相乘 (到数值 (位置数组 [2]), 10)), 取年份 (.今天)) ' 这里的（索引号 － 1) × 到数值 (卡片数值组 [2]) × 10 用于控制连纸打印的位置。下同。
                            相加 (相乘 (到数值 (位置数组 [1]), 10), 相乘 (到数值 (读配置项 (相加 (数据目录, “\set.ini”), “打印”, “日期间隔”, “10”)), 10), 10).定位写出 (相加 (相乘 (相减 (索引号, 1), 到数值 (卡片数值组 [2]), 10), 相乘 (到数值 (位置数组 [2]), 10)), 取月份 (.今天))
                            相加 (相乘 (到数值 (位置数组 [1]), 10), 相乘 (到数值 (读配置项 (相加 (数据目录, “\set.ini”), “打印”, “日期间隔”, “10”)), 20), 10).定位写出 (相加 (相乘 (相减 (索引号, 1), 到数值 (卡片数值组 [2]), 10), 相乘 (到数值 (位置数组 [2]), 10)), 取日 (.今天))
                        .默认
                            相乘 (到数值 (位置数组 [1]), 10).定位写出 (相加 (相乘 (相减 (索引号, 1), 到数值 (卡片数值组 [2]), 10), 相乘 (到数值 (位置数组 [2]), 10)), 打印内容)
                        .判断结束
                        
                    .如果真结束
                    
                .计次循环尾 ()
            .否则
                .计次循环首 (取数组成员数 (打印项目), 循环变量1)
                    .判断开始 (等于 (打印项目 [循环变量1], “标题”))
                        赋值 (打印内容, “健 康 证 明”)
                    .判断 (等于 (打印项目 [循环变量1], “证号”))
                        .如果 (.可视)
                            赋值 (打印内容, 相加 (“证号：”, .标题, “ ”, .内容))
                        .否则
                            赋值 (打印内容, 相加 (“证号：”, .内容))
                        .如果结束
                        
                    .判断 (等于 (打印项目 [循环变量1], “姓名”))
                        赋值 (打印内容, 相加 (“姓名：”, .内容))
                    .判断 (等于 (打印项目 [循环变量1], “性别”))
                        赋值 (打印内容, 相加 (“性别：”, .取项目文本 (.现行选中项)))
                    .判断 (等于 (打印项目 [循环变量1], “年龄”))
                        赋值 (打印内容, 相加 (“年龄：”, .内容))
                    .判断 (等于 (打印项目 [循环变量1], “工种”))
                        赋值 (打印内容, 相加 (“工种：”, .取项目文本 (.现行选中项)))
                    .判断 (等于 (打印项目 [循环变量1], “发证日期”))
                        赋值 (打印内容, 相加 (“发证日期：”, 时间到文本 (.今天, #日期部分)))
                    .判断 (等于 (打印项目 [循环变量1], “一级区域”))
                        赋值 (打印内容, 相加 (.标题, “：”, .取项目文本 (.现行选中项)))
                    .判断 (等于 (打印项目 [循环变量1], “二级区域”))
                        赋值 (打印内容, 相加 (.标题, “：”, .取项目文本 (.现行选中项)))
                    .判断 (等于 (打印项目 [循环变量1], “所在单位”))
                        赋值 (打印内容, 相加 (“单位：”, .标题))
                    .判断 (等于 (打印项目 [循环变量1], “体检结果”))
                        赋值 (打印内容, 相加 (“体检：”, .取项目文本 (.现行选中项)))
                    .判断 (等于 (打印项目 [循环变量1], “培训结果”))
                        赋值 (打印内容, 相加 (“培训：”, .取项目文本 (.现行选中项)))
                    .判断 (等于 (打印项目 [循环变量1], “发证单位”))
                        赋值 (打印内容, .标题)
                    .默认
                        
                    .判断结束
                    赋值 (位置文本, 读配置项 (相加 (数据目录, “\set.ini”), “打印”, 打印项目 [循环变量1], 相加 (“0,0,”, 选择 (并且 (大于 (循环变量1, 1), 小于或等于 (循环变量1, 7)), “0”, “-1”))))
                    赋值 (位置数组, 分割文本 (位置文本, “,”, ))
                    .如果真 (等于 (位置数组 [3], “0”))
                        赋值 (.绘画单位, 1)
                        赋值 (.字体.字体名称, “宋体”)
                        赋值 (.字体.字体大小, 12)
                        .判断开始 (等于 (打印项目 [循环变量1], “标题”))
                            赋值 (.字体.字体名称, “黑体”)
                            赋值 (.字体.字体大小, 16)
                            相乘 (到数值 (位置数组 [1]), 10).定位写出 (相加 (相乘 (相减 (索引号, 1), 到数值 (卡片数值组 [2]), 10), 相乘 (到数值 (位置数组 [2]), 10)), 打印内容)
                        .判断 (等于 (打印项目 [循环变量1], “照片”))
                            赋值 (照片宽度, 相乘 (到数值 (读配置项 (相加 (数据目录, “\set.ini”), “打印”, “照片宽度”, “24”)), 10))
                            赋值 (图片句柄, 载入图片 (.图片))
                            图片句柄.画图片 (相乘 (到数值 (位置数组 [1]), 10), 相加 (相乘 (相减 (索引号, 1), 到数值 (卡片数值组 [2]), 10), 相乘 (到数值 (位置数组 [2]), 10)), 照片宽度, 相乘 (相除 (照片宽度, 4), 5), )
                            卸载图片 (图片句柄)
                            0.置写出位置 (0)
                        .默认
                            相乘 (到数值 (位置数组 [1]), 10).定位写出 (相加 (相乘 (相减 (索引号, 1), 到数值 (卡片数值组 [2]), 10), 相乘 (到数值 (位置数组 [2]), 10)), 打印内容)
                        .判断结束
                        
                    .如果真结束
                    
                .计次循环尾 ()
            .如果结束
            
        .否则
            .如果 (等于 (信息框 (相加 (“健康证”, 取文本右边 (相加 (取重复文本 (证号长度, “0”), 到文本 (打印证号)), 证号长度), “号未找到，继续打印下一份吗？”), 相加 (#错误图标, #确认取消钮), ), #确认钮))
                到循环尾 ()
            .否则
                跳出循环 ()
            .如果结束
            
        .如果结束
        赋值 (索引号, 相加 (索引号, 1))
        .如果真 (大于 (索引号, 到数值 (卡片数值组 [3]))) ' 如果打印的索引号超过卡片连续张数，则换页。
            赋值 (索引号, 1)
            换页 ()
        .如果真结束
        
    .变量循环尾 ()
    结束打印 ()
    到尾记录 ()
    读记录 ()
.如果真结束


.子程序 _单位名称_被选择, 空白型, , 
赋值 (., 3)
赋值 (., 0)
禁止卷帘菜单 (真)
禁止菜单 (真)
赋值 (当前操作, 6) ' 单位名称设置
赋值 (.现行子夹, 4)
_选择夹1_子夹被改变 ()
赋值 (., 146)
赋值 (., 392)
赋值 (., “确 定(&Y)”)
连续赋值 (假, ., ., .可视, ., ., ., .)

.子程序 _工种设置_被选择, 空白型, , 
.局部变量 内容, 文本型, , , 
.局部变量 行业, 文本型, , "0", 
.局部变量 循环变量1, 整数型, , , 

赋值 (., 3)
赋值 (., 2)
禁止卷帘菜单 (真)
禁止菜单 (真)
赋值 (当前操作, 7) ' 工种设置
赋值 (.现行子夹, 2)
_选择夹1_子夹被改变 ()
清空 ()
赋值 (内容, 读配置项 (相加 (数据目录, “\set.ini”), “工种设置”, “工种”, “”))
赋值 (行业, 分割文本 (内容, “,”, ))
.如果 (大于 (取数组成员数 (行业), 0)) ' 读取现有工种
    .计次循环首 (取数组成员数 (行业), 循环变量1)
        行业.加入项目 ( [循环变量1], )
    .计次循环尾 ()
    赋值 (.现行选中项, 0)
    赋值 (.内容, .取项目文本 (.现行选中项))
    连续赋值 (假, ., ., ., .)
.否则
    连续赋值 (假, ., ., .)
    赋值 (., 假)
.如果结束
连续赋值 (真, ., ., ., ., .)
赋值 (., 18)
赋值 (., 117)
赋值 (., 216)
赋值 (., 315)
赋值 (., 414)
赋值 (., 513)
赋值 (., “删 除(&D)”)
赋值 (., #删除)
赋值 (.可视, 假)

.子程序 _区域设置_被选择, 空白型, , 
.局部变量 循环变量1, 整数型, , , 
.局部变量 一级区域, 文本型, , "0", 

.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “初始化”, “初始化”, “0”), “1”)) ' 1:初始化未结束；0:初始化已结束。
    .如果真 (不等于 (当前用户, “超级管理员”))
        信息框 (“对不起，你不是超级用户，无权进行系统初始化！程序将终止，请以超级用户身份登录并完成系统初始化！”, #信息图标, )
        结束 ()
    .如果真结束
    .如果真 (不等于 (.现行子夹, 1))
        返回 ()
    .如果真结束
    
.如果真结束
赋值 (., 3)
赋值 (., 3)
禁止卷帘菜单 (真)
禁止菜单 (真)
赋值 (当前操作, 8) ' 区域设置
赋值 (.现行子夹, 3)
_选择夹1_子夹被改变 ()
赋值 (.内容, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “一级区域名称”, “所在区域”))
赋值 (.标题, .内容)
赋值 (.内容, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “二级区域名称”, “所在乡镇”))
赋值 (.标题, .内容)
赋值 (.现行选中项, 0)
.如果 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, “假”), “假”))
    连续赋值 (真, .禁止, .禁止, .禁止)
.否则
    连续赋值 (假, .禁止, .禁止)
.如果结束
清空 ()
取配置项名 (相加 (数据目录, “\set.ini”), “一级区域”, 一级区域)
.如果 (大于 (取数组成员数 (一级区域), 0))
    .计次循环首 (取数组成员数 (一级区域), 循环变量1)
        一级区域.加入项目 ( [循环变量1], )
    .计次循环尾 ()
    赋值 (.现行选中项, 0)
    _一级列表框_列表项被选择 () ' 通过此事件，设置二级列表框
    连续赋值 (假, ., ., ., .)
.否则
    连续赋值 (真, ., ., .)
    赋值 (., 假)
.如果结束
连续赋值 (真, ., ., ., ., ., .)
赋值 (., 18)
赋值 (., 117)
赋值 (., 216)
赋值 (., 315)
赋值 (., 414)
赋值 (., 513)
赋值 (., “删 除(&D)”)
赋值 (., #删除)
赋值 (.可视, 假)

.子程序 _备份目录_被选择, 空白型, , 
赋值 (., 3)
赋值 (., 1)
禁止卷帘菜单 (真)
禁止菜单 (真)
赋值 (当前操作, 9) ' 备份目录设置
赋值 (.现行子夹, 5)
_选择夹1_子夹被改变 ()
赋值 (., 146)
赋值 (., 392)
赋值 (., “确 定(&Y)”)
连续赋值 (假, ., ., .可视, ., ., ., .)
赋值 (.内容, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “备份目录”, “”))

.子程序 _编号规则_被选择, 空白型, , 
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “初始化”, “初始化”, “0”), “1”)) ' 1:初始化未结束；0:初始化已结束。
    .如果 (等于 (.选中, 真))
        .如果真 (不等于 (.现行子夹, 3))
            返回 ()
        .如果真结束
        
    .否则
        .如果真 (不等于 (.现行子夹, 1))
            返回 ()
        .如果真结束
        
    .如果结束
    
.如果真结束
.如果真 (不等于 (当前用户, “超级管理员”))
    .如果 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “初始化”, “初始化”, “0”), “1”)) ' 1:初始化未结束；0:初始化已结束。
        信息框 (“对不起，你不是超级用户，无权修改编号规则！程序将终止，请以超级用户身份登录并完成系统初始化！”, #信息图标, )
        结束 ()
    .否则
        信息框 (“对不起，你不是超级用户，无权修改编号规则！”, #信息图标, )
        返回 ()
    .如果结束
    
.如果真结束
赋值 (., 4)
赋值 (., 0)
禁止卷帘菜单 (真)
禁止菜单 (真)
赋值 (当前操作, 10) ' 编号规则设置
赋值 (.现行子夹, 6)
_选择夹1_子夹被改变 ()
赋值 (., 146)
赋值 (., 392)
赋值 (., “确 定(&Y)”)
连续赋值 (假, ., ., .可视, ., ., ., .)
清空 ()
.如果 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “一级区域”, “假”), “真”)) ' 根据是否选择了区域，来设置编号组合框的项目。
    “固定编码 + 区域代码 + 从业人员流水号”.加入项目 ()
    “固定编码 + 从业人员流水号”.加入项目 ()
    “固定编码 + 年份 + 区域代码 + 从业人员流水号”.加入项目 ()
    “固定编码 + 年份 + 从业人员流水号”.加入项目 ()
    “区域代码 + 从业人员流水号”.加入项目 ()
    “从业人员流水号”.加入项目 ()
    “年份 + 区域代码 + 从业人员流水号”.加入项目 ()
    “年份 + 从业人员流水号”.加入项目 ()
    赋值 (.现行选中项, 0)
.否则
    “固定编码 + 年份 + 从业人员流水号”.加入项目 ()
    “固定编码 + 从业人员流水号”.加入项目 ()
    “年份 + 从业人员流水号”.加入项目 ()
    “从业人员流水号”.加入项目 ()
    赋值 (.现行选中项, 1)
.如果结束
.如果真 (不等于 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “编号规则”, “”), “”))
    读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “编号规则”, “”).选择 ()
.如果真结束
_编号规则组合框_列表项被选择 ()
赋值 (.内容, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “固定编码”, “32068110103”)) ' 江苏省启东市的默认固定编码。
赋值 (.内容, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “一级区域长度”, “1”))
赋值 (.内容, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “二级区域长度”, “1”))
赋值 (.内容, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “流水号长度”, “4”))

.子程序 _照片来源_被选择, 空白型, , 
.局部变量 来源, 文本型, , , 

赋值 (., 4)
赋值 (., 4)
禁止卷帘菜单 (真)
禁止菜单 (真)
赋值 (当前操作, 11) ' 备份目录设置
赋值 (.现行子夹, 7)
_选择夹1_子夹被改变 ()
赋值 (., 146)
赋值 (., 392)
赋值 (., “确 定(&Y)”)
连续赋值 (假, ., ., .可视, ., ., ., .)
赋值 (来源, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “照片来源”, “显示”))
.判断开始 (等于 (来源, “显示”))
    赋值 (.选中, 真)
    连续赋值 (假, .选中, .选中)
.判断 (等于 (来源, “文件”))
    赋值 (.选中, 真)
    连续赋值 (假, .选中, .选中)
.判断 (等于 (来源, “设备”))
    赋值 (.选中, 真)
    连续赋值 (假, .选中, .选中)
.默认
    
.判断结束


.子程序 _卡片布局_被选择, 空白型, , 
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “初始化”, “初始化”, “0”), “1”)) ' 1:初始化未结束；0:初始化已结束。
    .如果真 (不等于 (.现行子夹, 6))
        返回 ()
    .如果真结束
    
.如果真结束
赋值 (., 4)
赋值 (., 2)
禁止卷帘菜单 (真)
禁止菜单 (真)
赋值 (当前操作, 12) ' 备份目录设置
赋值 (.现行子夹, 8)
_选择夹1_子夹被改变 ()
连续赋值 (假, ., ., .可视, ., ., ., .)
赋值 (., 146)
赋值 (., 392)
赋值 (., “确 定(&Y)”)
刷新显示 ()
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “初始化”, “初始化”, “0”), “1”)) ' 1:初始化未结束；0:初始化已结束。
    读取卡片布局 () ' 界面设置。读取现有界面布局。
.如果真结束
刷新显示 ()

.子程序 _证件设置_被选择, 空白型, , 
.局部变量 位置记录, 文本型, , , 
.局部变量 位置数组, 文本型, , "3", 

赋值 (., 4)
赋值 (., 1)
禁止卷帘菜单 (真)
禁止菜单 (真)
赋值 (.现行子夹, 9)
_选择夹1_子夹被改变 ()
赋值 (位置记录, 读配置项 (相加 (数据目录, “\set.ini”), “打印”, “卡片”, “95,65,4”)) ' 默认卡片信息
赋值 (位置数组, 分割文本 (位置记录, “,”, ))
赋值 (.内容, 位置数组 [1])
赋值 (.内容, 位置数组 [2])
赋值 (.内容, 位置数组 [3])
赋值 (., 146)
赋值 (., 392)
连续赋值 (假, ., ., .可视, ., ., ., .)
赋值 (当前操作, 4) ' 证件设置

.子程序 _打印设置_被选择, 空白型, , 
赋值 (., 4)
赋值 (., 3)
禁止卷帘菜单 (真)
禁止菜单 (真)
赋值 (., 146)
赋值 (., 392)
连续赋值 (假, ., ., .可视, ., ., ., .)
赋值 (当前操作, 5) ' 打印设置
赋值 (.现行子夹, 10)
_选择夹1_子夹被改变 ()
刷新显示 ()
重画 ()
重画 ()

.子程序 _重新登录_被选择, 空白型, , 
赋值 (., 5)
赋值 (., 0)
载入 (登录窗口, , 真)
0.置文本 (当前用户)
 ' 卷帘式菜单1.现行选中菜单 ＝ 1
.如果 (不等于 (“超级管理员”))
    赋值 (.禁止, 真)
    3.未知支持库函数_24 (真)
    4.未知支持库函数_24 (真)
.否则
    赋值 (.禁止, 假)
    3.未知支持库函数_24 (假)
    4.未知支持库函数_24 (假)
.如果结束


.子程序 _添加用户_被选择, 空白型, , 
.局部变量 循环变量1, 整数型, , , 

.计次循环首 (取数组成员数 (用户), 循环变量1) ' 通过循环定位用户所处位置索引，保存在“循环变量1”中。
    .如果真 (等于 (用户 [循环变量1], 当前用户))
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
.如果 (不等于 (循环变量1, 1)) ' 默认管理员索引为1。
    信息框 (“你不是默认管理员，不能执行此操作，请用默认管理员的身份重新登录！”, #信息图标, )
.否则
    赋值 (., 5)
    赋值 (., 1)
    载入 (添加用户窗口, , 真)
    复制文件 (相加 (取运行目录 (), “\sysdat.ini”), 相加 (未知支持库函数_7 (10), “jkzm.usr”))
    记录摘要 (1)
.如果结束
 ' 卷帘式菜单1.现行选中菜单 ＝ 1

.子程序 _删除用户_被选择, 空白型, , 
.局部变量 循环变量1, 整数型, , , 

.计次循环首 (取数组成员数 (用户), 循环变量1) ' 通过循环定位用户所处位置索引，保存在“循环变量1”中。
    .如果真 (等于 (用户 [循环变量1], 当前用户))
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
.如果 (不等于 (循环变量1, 1))
    信息框 (“你不是默认管理员，不能执行此操作，请用默认管理员的身份重新登录！”, #信息图标, )
.否则
    赋值 (., 5)
    赋值 (., 2)
    载入 (删除用户窗口, , 真)
    复制文件 (相加 (取运行目录 (), “\sysdat.ini”), 相加 (未知支持库函数_7 (10), “jkzm.usr”))
    记录摘要 (1)
.如果结束
 ' 卷帘式菜单1.现行选中菜单 ＝ 1

.子程序 _修改口令_被选择, 空白型, , 
赋值 (., 5)
赋值 (., 3)
载入 (修改口令窗口, , 真)
复制文件 (相加 (取运行目录 (), “\sysdat.ini”), 相加 (未知支持库函数_7 (10), “jkzm.usr”))
记录摘要 (1)
 ' 卷帘式菜单1.现行选中菜单 ＝ 1

.子程序 _计算器_被选择, 空白型, , 
赋值 (., 6)
赋值 (., 0)
未知支持库函数_6 (相加 (未知支持库函数_7 (10), “calc.exe”), , )

.子程序 _记事本_被选择, 空白型, , 
赋值 (., 6)
赋值 (., 1)
未知支持库函数_6 (相加 (未知支持库函数_7 (10), “notepad.exe”), , )

.子程序 _背景音乐_被选择, 空白型, , 
.局部变量 背景音乐文件, 文本型, , , 

赋值 (., 6)
赋值 (., 2)
载入 (背景音乐窗口, , 真)
.如果真 (不等于 (当前音乐索引, 0))
    赋值 (.时钟周期, 0)
    关闭媒体 (音乐数组 [当前音乐索引])
    赋值 (当前音乐索引, 0)
.如果真结束
赋值 (背景音乐文件, 到文本 (读入文件 (相加 (取运行目录 (), “\music.dat”))))
赋值 (音乐数组, 分割文本 (背景音乐文件, “?”, )) ' 参考背景音乐设置窗口代码。
赋值 (.时钟周期, 1000)
 ' 卷帘式菜单1.现行选中菜单 ＝ 1

.子程序 _帮助主题_被选择, 空白型, , 
赋值 (., 7)
赋值 (., 0)
未知支持库函数_6 (“jkzm.chm”, , )
 ' 卷帘式菜单1.现行选中菜单 ＝ 1

.子程序 _时钟1_周期事件, 空白型, , 
.如果 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “背景音乐”, “播放”, “假”), “假”))
    赋值 (.时钟周期, 1000)
    2.置文本 (相加 (“大连大有吴涛易语言有限公司  ”, 到文本 (取年份 (取现行时间 ())), “-”, 取文本右边 (相加 (“0”, 到文本 (取月份 (取现行时间 ()))), 2), “-”, 取文本右边 (相加 (“0”, 到文本 (取日 (取现行时间 ()))), 2), “  ”, 取文本右边 (相加 (“0”, 到文本 (取小时 (取现行时间 ()))), 2), “:”, 取文本右边 (相加 (“0”, 到文本 (取分钟 (取现行时间 ()))), 2), “:”, 取文本右边 (相加 (“0”, 到文本 (取秒 (取现行时间 ()))), 2))) ' 显示时间
.否则
    .如果 (大于 (取数组成员数 (音乐数组), 0))
        .如果 (等于 (当前音乐索引, 0))
            .如果 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “背景音乐”, “播放方式”, “顺序”), “顺序”))
                赋值 (当前音乐索引, 1)
                .判断循环首 (等于 (文件是否存在 (音乐数组 [当前音乐索引]), 假)) ' 如果音乐文件不存在，则从数组中删除。
                    删除成员 (音乐数组, 当前音乐索引, )
                    赋值 (当前音乐索引, 选择 (小于 (取数组成员数 (音乐数组), 当前音乐索引), 取数组成员数 (音乐数组), 当前音乐索引)) ' 如果当前音乐索引已经大于音乐数组中保留的音乐数，则修改索引为最大音乐数。
                    .如果真 (等于 (取数组成员数 (音乐数组), 0)) ' 如果所有音乐文件都不存在，则返回。
                        赋值 (当前音乐索引, 0)
                        返回 ()
                    .如果真结束
                    
                .判断循环尾 ()
            .否则
                置随机数种子 ()
                赋值 (当前音乐索引, 取随机数 (1, 取数组成员数 (音乐数组)))
                .判断循环首 (等于 (文件是否存在 (音乐数组 [当前音乐索引]), 假))
                    删除成员 (音乐数组, 当前音乐索引, ) ' 如果音乐文件不存在，则从数组中删除。
                    .如果真 (等于 (取数组成员数 (音乐数组), 0)) ' 如果所有音乐文件都不存在，则返回。
                        返回 ()
                    .如果真结束
                    赋值 (当前音乐索引, 取随机数 (1, 取数组成员数 (音乐数组)))
                .判断循环尾 ()
            .如果结束
            赋值 (当前音乐文件名, 相加 (取空白文本 (46), 取文本右边 (音乐数组 [当前音乐索引], 相减 (取文本长度 (音乐数组 [当前音乐索引]), 倒找文本 (音乐数组 [当前音乐索引], “\”, , 假))))) ' 将音乐文件名前面加上20个空格（正好是任务栏第三栏的宽度），以便进行滚动显示。下同。
            赋值 (文本长度, 取文本长度 (当前音乐文件名))
            播放媒体 (音乐数组 [当前音乐索引])
            2.置文本 (当前音乐文件名)
        .否则
            .如果 (等于 (取媒体状态 (音乐数组 [当前音乐索引]), “stopped”))
                关闭媒体 (音乐数组 [当前音乐索引])
                .如果 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “背景音乐”, “播放方式”, “顺序”), “顺序”))
                    赋值 (当前音乐索引, 相加 (当前音乐索引, 1))
                    .如果真 (大于 (当前音乐索引, 取数组成员数 (音乐数组)))
                        赋值 (当前音乐索引, 1)
                    .如果真结束
                    .判断循环首 (等于 (文件是否存在 (音乐数组 [当前音乐索引]), 假)) ' 如果音乐文件不存在，则从数组中删除。
                        删除成员 (音乐数组, 当前音乐索引, )
                        赋值 (当前音乐索引, 选择 (小于 (取数组成员数 (音乐数组), 当前音乐索引), 取数组成员数 (音乐数组), 当前音乐索引)) ' 如果当前音乐索引已经大于音乐数组中保留的音乐数，则修改索引为最大音乐数。
                        .如果真 (等于 (取数组成员数 (音乐数组), 0)) ' 如果所有音乐文件都不存在，则返回。
                            返回 ()
                        .如果真结束
                        
                    .判断循环尾 ()
                .否则
                    置随机数种子 ()
                    赋值 (当前音乐索引, 取随机数 (1, 取数组成员数 (音乐数组)))
                    .判断循环首 (等于 (文件是否存在 (音乐数组 [当前音乐索引]), 假))
                        删除成员 (音乐数组, 当前音乐索引, ) ' 如果音乐文件不存在，则从数组中删除。
                        .如果真 (等于 (取数组成员数 (音乐数组), 0)) ' 如果所有音乐文件都不存在，则返回。
                            返回 ()
                        .如果真结束
                        赋值 (当前音乐索引, 取随机数 (1, 取数组成员数 (音乐数组)))
                    .判断循环尾 ()
                .如果结束
                赋值 (当前音乐文件名, 相加 (取空白文本 (46), 取文本右边 (音乐数组 [当前音乐索引], 相减 (取文本长度 (音乐数组 [当前音乐索引]), 倒找文本 (音乐数组 [当前音乐索引], “\”, , 假)))))
                赋值 (文本长度, 取文本长度 (当前音乐文件名))
                播放媒体 (音乐数组 [当前音乐索引])
                2.置文本 (当前音乐文件名)
            .否则
                赋值 (文本长度, 相减 (文本长度, 2)) ' 循环滚动音乐文件名。
                .如果真 (小于 (文本长度, 0))
                    赋值 (文本长度, 取文本长度 (当前音乐文件名))
                .如果真结束
                2.置文本 (取文本右边 (当前音乐文件名, 文本长度))
            .如果结束
            
        .如果结束
        
    .否则
        赋值 (.时钟周期, 1000)
        赋值 (当前音乐索引, 0)
        2.置文本 (相加 (到文本 (取年份 (取现行时间 ())), “-”, 取文本右边 (相加 (“0”, 到文本 (取月份 (取现行时间 ()))), 2), “-”, 取文本右边 (相加 (“0”, 到文本 (取日 (取现行时间 ()))), 2), “  ”, 取文本右边 (相加 (“0”, 到文本 (取小时 (取现行时间 ()))), 2), “:”, 取文本右边 (相加 (“0”, 到文本 (取分钟 (取现行时间 ()))), 2), “:”, 取文本右边 (相加 (“0”, 到文本 (取秒 (取现行时间 ()))), 2))) ' 如果设置了播放背景音乐，但音乐文件数组为0，则显示时间。
    .如果结束
    
.如果结束


.子程序 _一级组合框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _二级组合框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _证号编辑框1_获得焦点, 空白型, , 
.局部变量 新证号码, 文本型, , , 

.如果 (等于 (当前操作, 1)) ' 添加记录
    赋值 (新证号码, 自动计算编码 ())
    赋值 (.内容, 新证号码)
.否则
    .如果真 (等于 (.内容, “”))
        赋值 (新证号码, 自动计算编码 ())
        赋值 (.内容, 新证号码)
    .如果真结束
    
.如果结束


.子程序 _证号编辑框1_内容被改变, 空白型, , 
赋值 (改变, 真)

.子程序 _姓名编辑框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _姓名编辑框1_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)

.子程序 _姓名编辑框1_内容被改变, 空白型, , 
赋值 (改变, 真)

.子程序 _性别组合框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _工种组合框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _年龄编辑框1_内容被改变, 空白型, , 
赋值 (改变, 真)

.子程序 _年龄编辑框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键)) ' 经过多年使用，用户提出的建议，方便切换。以下同。
    获取焦点 ()
.如果真结束


.子程序 _年龄编辑框1_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)

.子程序 _单位编辑框1_内容被改变, 空白型, , 
赋值 (改变, 真)

.子程序 _单位编辑框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _单位编辑框1_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)

.子程序 _体检结果组合框1_列表项被选择, 空白型, , 
赋值 (改变, 真)

.子程序 _体检结果组合框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _培训结果组合框1_列表项被选择, 空白型, , 
赋值 (改变, 真)

.子程序 _培训结果组合框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _发证日期框1_选择日期被改变, 空白型, , 
赋值 (改变, 真)

.子程序 _发证日期框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _照片框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “照片来源”, “显示”), “显示”))
    返回 (假)
.否则
    载入 (照片窗口, , 真)
.如果结束


.子程序 _保存按钮_被单击, 空白型, , 
.判断开始 (或者 (等于 (当前操作, 1), 等于 (当前操作, 2))) ' 添加或修改记录
    集合_主界面 (“保存”)
.判断 (等于 (当前操作, 3)) ' 查找记录
    集合_查找记录 (“开始查找”)
.判断 (等于 (当前操作, 4)) ' 证件设置
    集合_证件设置 (“确定”)
.判断 (等于 (当前操作, 5)) ' 打印设置
    集合_打印设置 (“确定”)
.判断 (等于 (当前操作, 6)) ' 单位名称设置
    集合_单位名称 (“确定”)
.判断 (等于 (当前操作, 7)) ' 工种设置
    集合_工种设置 (“保存”)
.判断 (等于 (当前操作, 8)) ' 区域设置
    集合_区域设置 (“保存”)
.判断 (等于 (当前操作, 9)) ' 备份目录设置
    集合_备份目录 (“确定”)
.判断 (等于 (当前操作, 10)) ' 编码规则设置
    集合_编号规则 (“确定”)
.判断 (等于 (当前操作, 11)) ' 照片来源设置
    集合_照片来源 (“确定”)
.判断 (等于 (当前操作, 12)) ' 卡片布局设置
    集合_卡片布局 (“确定”)
.判断 (等于 (当前操作, 14)) ' 重设字段
    集合_重设字段 (“确定”)
.默认
    
.判断结束


.子程序 _取消按钮_被单击, 空白型, , 
.判断开始 (或者 (等于 (当前操作, 1), 等于 (当前操作, 2))) ' 添加或修改记录
    集合_主界面 (“取消”)
.判断 (等于 (当前操作, 3)) ' 查找
    集合_查找记录 (“取消”)
.判断 (等于 (当前操作, 4)) ' 卡片设置
    集合_证件设置 (“取消”)
.判断 (等于 (当前操作, 5)) ' 打印设置
    集合_打印设置 (“取消”)
.判断 (等于 (当前操作, 6)) ' 单位名称
    集合_单位名称 (“取消”)
.判断 (等于 (当前操作, 11)) ' 照片来源
    集合_照片来源 (“取消”)
.判断 (等于 (当前操作, 7)) ' 工种设置
    集合_工种设置 (“取消”)
.判断 (等于 (当前操作, 8)) ' 区域设置
    集合_区域设置 (“取消”)
.判断 (等于 (当前操作, 9)) ' 备份目录
    集合_备份目录 (“取消”)
.判断 (等于 (当前操作, 10)) ' 编号规则设置
    集合_编号规则 (“取消”)
.判断 (等于 (当前操作, 14)) ' 重设字段，初始化数据
    集合_重设字段 (“取消”)
.判断 (等于 (当前操作, 12)) ' 卡片布局
    集合_卡片布局 (“取消”)
.默认
    
.判断结束


.子程序 _工具条2_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.判断开始 (等于 (按钮索引, 0))
    到首记录 ()
    读记录 ()
.判断 (等于 (按钮索引, 1))
    跳过 (-1)
    读记录 ()
.判断 (等于 (按钮索引, 2))
    跳过 (1)
    读记录 ()
.判断 (等于 (按钮索引, 3))
    到尾记录 ()
    读记录 ()
.默认
    
.判断结束


.子程序 _查找姓名单选框_被单击, 空白型, , 
赋值 (.可视, 真)

.子程序 _查找编号单选框_被单击, 空白型, , 
赋值 (.可视, 假)
重画 ()

.子程序 _查找下一个_被选择, 空白型, , 
.如果 (不等于 (.现行子夹, 0))
    返回 ()
.否则
    .如果真 (等于 (., 假))
        返回 ()
    .如果真结束
    
.如果结束
跳过 (1)
.如果 (.选中)
    .如果 (等于 (模糊查找, 真))
        .如果 (查找 (发音比较 (.内容, 读 (“姓名”), 真, )))
            读记录 ()
        .否则
            信息框 (“未找到指定从业人员记录！”, #信息图标, “未找到”)
            赋值 (.可视, 假)
            跳过 (-1)
        .如果结束
        
    .否则
        .如果 (查找 (等于 (.内容, 读 (“姓名”))))
            读记录 ()
        .否则
            信息框 (“未找到指定从业人员记录！”, #信息图标, “未找到”)
            赋值 (.可视, 假)
            跳过 (-1)
        .如果结束
        
    .如果结束
    
.否则
    .如果 (查找 (等于 (.内容, 读 (“健康证号”))))
        读记录 ()
    .否则
        信息框 (“未找到指定从业人员记录！”, #信息图标, “未找到”)
        赋值 (.可视, 假)
        跳过 (-1)
    .如果结束
    
.如果结束
返回 ()

.子程序 _项目选择框1_被单击, 空白型, , 
.局部变量 事件选择框, 选择框, , , 
.局部变量 索引, 整数型, , , 

赋值 (事件选择框, 取事件组件 ())
赋值 (索引, 到数值 (事件选择框.标记))
连续赋值 (取反 (事件选择框.选中), 横向编辑框 [索引], 禁止, 纵向编辑框 [索引], 禁止)
.如果真 (等于 (项目 [索引], “照片”))
    赋值 (.禁止, 横向编辑框 [索引], 禁止)
.如果真结束


.子程序 _套打选择框_被单击, 空白型, , 
连续赋值 (.选中, 项目选择框 [1].禁止, 横向编辑框 [1].禁止, 纵向编辑框 [1].禁止, .可视, .可视, 项目选择框 [取数组成员数 (项目)].禁止, 横向编辑框 [取数组成员数 (项目)].禁止, 纵向编辑框 [取数组成员数 (项目)].禁止) ' 套打，则标题和发证单位不打印，否则可选。
赋值 (项目选择框 [1].选中, 取反 (.选中))
赋值 (项目选择框 [取数组成员数 (项目)].选中, 取反 (.选中))

.子程序 _宽度编辑框_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)

.子程序 _高度编辑框_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)

.子程序 _张数编辑框_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)

.子程序 _照片宽度编辑框_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)

.子程序 _行业编辑框_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)

.子程序 _行业列表框_列表项被选择, 空白型, , 
赋值 (.内容, .取项目文本 (.现行选中项))

.子程序 _一级列表框_列表项被选择, 空白型, , 
.局部变量 二级区域, 文本型, , "0", 
.局部变量 循环变量1, 整数型, , , 

赋值 (.内容, .取项目文本 (.现行选中项))
赋值 (.内容, 读配置项 (相加 (数据目录, “\set.ini”), “一级区域”, .内容, “”))
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, “假”), “真”))
    赋值 (.现行选中项, 0)
    清空 ()
    取配置项名 (相加 (数据目录, “\set.ini”), 相加 (“一级区域之”, .内容), 二级区域)
    .计次循环首 (取数组成员数 (二级区域), 循环变量1)
        二级区域.加入项目 ( [循环变量1], )
    .计次循环尾 ()
.如果真结束


.子程序 _二级列表框_列表项被选择, 空白型, , 
赋值 (.现行选中项, 1)
赋值 (.内容, .取项目文本 (.现行选中项))
赋值 (.内容, 读配置项 (相加 (数据目录, “\set.ini”), 相加 (“一级区域之”, .取项目文本 (.现行选中项)), .内容, “”))
赋值 (.禁止, 假)

.子程序 _一级名称编辑框_内容被改变, 空白型, , 
赋值 (.标题, .内容)
0.置项目文本 (.内容)

.子程序 _二级名称编辑框_内容被改变, 空白型, , 
赋值 (.标题, .内容)
1.置项目文本 (.内容)

.子程序 _名称编辑框_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)

.子程序 _编码编辑框_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)

.子程序 _修改按钮_被单击, 空白型, , 
.判断开始 (等于 (当前操作, 0)) ' 录入界面,修改当前记录
    集合_主界面 (“修改”)
.判断 (等于 (当前操作, 7)) ' 工种设置
    集合_工种设置 (“修改”)
.判断 (等于 (当前操作, 8)) ' 区域设置
    集合_区域设置 (“修改”)
.默认
    
.判断结束


.子程序 _增加按钮_被单击, 空白型, , 
.判断开始 (等于 (当前操作, 0)) ' 录入界面,添加新记录
    集合_主界面 (“添加”)
.判断 (等于 (当前操作, 7)) ' 工种设置
    集合_工种设置 (“添加”)
.判断 (等于 (当前操作, 8)) ' 区域设置
    集合_区域设置 (“添加”)
.默认
    
.判断结束


.子程序 _返回按钮_被单击, 空白型, , 
.局部变量 二级区域, 文本型, , "0", 

.判断开始 (等于 (当前操作, 7)) ' 工种设置
    集合_工种设置 (“返回”)
.判断 (等于 (当前操作, 8)) ' 区域设置
    集合_区域设置 (“返回”)
.判断 (等于 (当前操作, 13)) ' 查看往年数据
    关闭 ()
    赋值 (数据目录, 相加 (取运行目录 (), “\data”))
    打开 (相加 (数据目录, “\jkzlib.dat”), “jkz”, , , , , “jkzlib.enx”) ' 打开数据库，同时打开索引文件。
    调整卡片布局 ()
    填充初始数据 ()
    到尾记录 ()
    赋值 (., 假)
    赋值 (.禁止, 假)
    连续赋值 (真, ., ., ., ., .)
    读记录 ()
    禁止卷帘菜单 (假)
    禁止菜单 (假)
     ' 卷帘式菜单1.现行选中菜单 ＝ 1
    赋值 (.现行子夹, 0)
    _选择夹1_子夹被改变 ()
    赋值 (当前操作, 0)
    赋值 (., “打 印(&P)”)
    赋值 (., #打印)
    _选择夹1_子夹被改变 ()
.默认
    
.判断结束


.子程序 _区域组合框_列表项被选择, 空白型, , 
.如果 (等于 (.现行选中项, 0))
    赋值 (.内容, 到文本 (相加 (取项目数 (), 1)))
.否则
    赋值 (.内容, 到文本 (相加 (取项目数 (), 1)))
.如果结束


.子程序 判断项目是否存在, 逻辑型, , 
.参数 列表框, 列表框, , 
.参数 项目文本, 文本型, , 
.参数 忽略项目索引, 整数型, 可空, 被忽略的项目将不参与项目文本的比较。

.局部变量 循环变量1, 整数型, , , 

.计次循环首 (列表框.取项目数 (), 循环变量1)
    .如果真 (等于 (是否为空 (忽略项目索引), 假))
        .如果真 (等于 (忽略项目索引, 相减 (循环变量1, 1)))
            到循环尾 ()
        .如果真结束
        
    .如果真结束
    .如果真 (等于 (列表框.取项目文本 (相减 (循环变量1, 1)), 项目文本))
        返回 (真)
    .如果真结束
    
.计次循环尾 ()
返回 (假)

.子程序 _目录按钮_被单击, 空白型, , 
.局部变量 目录, 文本型, , , 

赋值 (目录, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “备份目录”, “”))
.如果 (等于 (目录, “”))
    赋值 (目录, 相加 (“当前尚未设置数据备份目录。”, #换行符, “请选择你的备份数据存放的目录：”))
.否则
    赋值 (目录, 相加 (“当前数据备份目录为：”, 目录, “。”, #换行符, “请重新选择你的备份数据存放的目录：”))
.如果结束
赋值 (目录, 未知支持库函数_2 (目录, ))
.如果真 (不等于 (目录, “”))
    赋值 (.内容, 目录)
.如果真结束


.子程序 _编号规则组合框_列表项被选择, 空白型, , 
.判断开始 (等于 (.取项目文本 (.现行选中项), “固定编码 + 区域代码 + 从业人员流水号”)) ' 根据选择的编号规则，调整以下组件的属性。
    连续赋值 (假, .禁止, .禁止, .禁止)
    .如果真 (.选中)
        赋值 (.禁止, 假)
    .如果真结束
    
.判断 (等于 (.取项目文本 (.现行选中项), “固定编码 + 年份 + 从业人员流水号”))
    连续赋值 (假, .禁止, .禁止)
    连续赋值 (真, .禁止, .禁止)
.判断 (等于 (.取项目文本 (.现行选中项), “固定编码 + 年份 + 区域代码 + 从业人员流水号”))
    连续赋值 (假, .禁止, .禁止, .禁止)
    .如果真 (.选中)
        赋值 (.禁止, 假)
    .如果真结束
    
.判断 (等于 (.取项目文本 (.现行选中项), “固定编码 + 从业人员流水号”))
    连续赋值 (假, .禁止, .禁止)
    连续赋值 (真, .禁止, .禁止)
.判断 (等于 (.取项目文本 (.现行选中项), “区域代码 + 从业人员流水号”))
    连续赋值 (假, .禁止, .禁止)
    .如果真 (.选中)
        赋值 (.禁止, 假)
    .如果真结束
    赋值 (.禁止, 真)
.判断 (等于 (.取项目文本 (.现行选中项), “年份 + 从业人员流水号”))
    连续赋值 (真, .禁止, .禁止, .禁止)
    赋值 (.禁止, 假)
.判断 (等于 (.取项目文本 (.现行选中项), “年份 + 区域代码 + 从业人员流水号”))
    连续赋值 (假, .禁止, .禁止)
    .如果真 (.选中)
        赋值 (.禁止, 假)
    .如果真结束
    赋值 (.禁止, 真)
.判断 (等于 (.取项目文本 (.现行选中项), “从业人员流水号”))
    连续赋值 (真, .禁止, .禁止, .禁止)
    赋值 (.禁止, 假)
.默认
    
.判断结束


.子程序 画控件外观, 空白型, , 
.参数 控件句柄, 整数型, , 

.局部变量 外观, 矩形区域, , , 
.局部变量 场景, 整数型, , , 

赋值 (场景, 创建场景 (“DISPLAY”, “”, “”, 0))
.判断开始 (等于 (控件句柄, 0)) ' 取消上次画的外框。
    取窗口范围 (原句柄, 外观)
    画边框 (场景, 外观)
    删除场景 (场景)
    赋值 (原句柄, 0)
.默认
    .如果真 (不等于 (原句柄, 控件句柄)) ' 为新控件画外框，以显示焦点。
        取窗口范围 (原句柄, 外观)
        画边框 (场景, 外观)
        取窗口范围 (控件句柄, 外观)
        画边框 (场景, 外观)
        删除场景 (场景)
        赋值 (原句柄, 控件句柄)
    .如果真结束
    
.判断结束
返回 ()

.子程序 画边框, 空白型, , 
.参数 场景, 整数型, , 
.参数 边框, 矩形区域, , 

.如果真 (等于 (矩形是否为空 (边框), 0))
    填充设备场景 (场景, 边框.左, 边框.上, 相减 (边框.右, 边框.左), 2, #DSTINVERT)
    填充设备场景 (场景, 边框.左, 相加 (边框.上, 3), 2, 相减 (边框.下, 边框.上, 4), #DSTINVERT)
    填充设备场景 (场景, 边框.右, 相加 (边框.上, 3), -2, 相减 (边框.下, 边框.上, 4), #DSTINVERT)
    填充设备场景 (场景, 边框.左, 边框.下, 相减 (边框.右, 边框.左), -2, #DSTINVERT)
.如果真结束


.子程序 初始化卡片布局, 空白型, , 
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 () ' 以上是界面设置中的组件，通过事件转移，简化代码。
读取卡片布局 () ' 界面设置。读取现有界面布局。

.子程序 读取卡片布局, 空白型, , 卡片设置界面中读取布局
.局部变量 组件属性, 文本型, , "0", 
.局部变量 编码形式, 文本型, , , 
.局部变量 编码长度, 整数型, , , 

连续赋值 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “一级区域”, “假”), “真”), .可视, .可视) ' 设置组件的可视属性。
连续赋值 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, “假”), “真”), .可视, .可视)
赋值 (.标题, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “固定编码”, “0”))
赋值 (.可视, 不等于 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “固定编码”, “0”), “0”))
连续赋值 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “所在单位”, “假”), “真”), .可视, .可视)
连续赋值 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “体检结果”, “假”), “真”), .可视, .可视)
连续赋值 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “培训结果”, “假”), “真”), .可视, .可视)
连续赋值 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “照片”, “假”), “真”), .可视)
赋值 (.标题, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “一级区域名称”, “所在地区”)) ' 设置组件标题。
赋值 (.标题, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “二级区域名称”, “所在乡镇”))
赋值 (.标题, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “单位名称”, “启东市卫生监督所”))
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “标题”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 3)) ' 3个数值：左边，顶边，宽度。
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “一级区域”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 6)) ' 6个数值，包括标签及相应的输入组件。依次为：左边，顶边，宽度，左边，顶边，宽度。下同。
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
    到数值 (组件属性 [4]).移动 (到数值 (组件属性 [5]), 到数值 (组件属性 [6]), )
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “二级区域”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 6))
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
    到数值 (组件属性 [4]).移动 (到数值 (组件属性 [5]), 到数值 (组件属性 [6]), )
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “编号”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 9))
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
    到数值 (组件属性 [4]).移动 (到数值 (组件属性 [5]), 到数值 (组件属性 [6]), )
    到数值 (组件属性 [7]).移动 (到数值 (组件属性 [8]), 到数值 (组件属性 [9]), )
.如果真结束
赋值 (.宽度, .取宽度 (.标题))
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “姓名”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 6))
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
    到数值 (组件属性 [4]).移动 (到数值 (组件属性 [5]), 到数值 (组件属性 [6]), )
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “性别”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 6))
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
    到数值 (组件属性 [4]).移动 (到数值 (组件属性 [5]), 到数值 (组件属性 [6]), )
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “工种”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 6))
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
    到数值 (组件属性 [4]).移动 (到数值 (组件属性 [5]), 到数值 (组件属性 [6]), )
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “年龄”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 6))
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
    到数值 (组件属性 [4]).移动 (到数值 (组件属性 [5]), 到数值 (组件属性 [6]), )
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “所在单位”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 6))
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
    到数值 (组件属性 [4]).移动 (到数值 (组件属性 [5]), 到数值 (组件属性 [6]), )
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “体检结果”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 6))
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
    到数值 (组件属性 [4]).移动 (到数值 (组件属性 [5]), 到数值 (组件属性 [6]), )
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “培训结果”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 6))
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
    到数值 (组件属性 [4]).移动 (到数值 (组件属性 [5]), 到数值 (组件属性 [6]), )
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “发证日期”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 6))
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
    到数值 (组件属性 [4]).移动 (到数值 (组件属性 [5]), 到数值 (组件属性 [6]), )
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “照片”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 4)) ' 照片记录了4个值，左边，顶边，宽度，高度。由于一开始设计时没有固定宽度和高度的比例，所以要全部记录。后来，将宽高比固定为4：5，其实可以只记录宽度了。但不改也没有影响，所以没改。
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), 到数值 (组件属性 [4]))
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “使用单位”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 3))
    到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
.如果真结束
清除数组 (组件属性)
赋值 (组件属性, 分割文本 (读配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “分隔条”, “”), “,”, ))
.如果真 (等于 (取数组成员数 (组件属性), 3))
    .如果 (等于 (组件属性 [1], “-1”)) ' 如果第3位数值为-1，说明保存时，该组件在寄放画板中。
        置父窗口 (取窗口句柄 (), 取窗口句柄 ()) ' 设置分隔条标签的位置。
        赋值 (.标记, “26-2”)
        赋值 (组件类型, 0)
        寄放组件重排 () ' 通过此子程序，调整组件位置。
    .否则
        到数值 (组件属性 [1]).移动 (到数值 (组件属性 [2]), 到数值 (组件属性 [3]), )
    .如果结束
    
.如果真结束


.子程序 记录卡片布局, 空白型, , 卡片布局设置界面中保存布局
.如果真 (检查组件 ()) ' 除了分隔条可以被抛弃外，其余可视组件必须被保存在卡片中。
    信息框 (“寄存区中尚有组件未被移回卡片区，请将所有组件均合理设置位置（分隔条除外）。”, #信息图标, )
    返回 ()
.如果真结束
写配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “标题”, 相加 (到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度))) ' 按左边，顶边，宽度的顺序，记录位置信息，下同。
写配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “一级区域”, 相加 (到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度), “,”, 到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度)))
写配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “二级区域”, 相加 (到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度), “,”, 到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度)))
写配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “编号”, 相加 (到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度), “,”, 到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度), “,”, 到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度)))
写配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “姓名”, 相加 (到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度), “,”, 到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度)))
写配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “性别”, 相加 (到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度), “,”, 到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度)))
写配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “工种”, 相加 (到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度), “,”, 到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度)))
写配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “年龄”, 相加 (到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度), “,”, 到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度)))
写配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “所在单位”, 相加 (到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度), “,”, 到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度)))
写配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “体检结果”, 相加 (到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度), “,”, 到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度)))
写配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “培训结果”, 相加 (到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度), “,”, 到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度)))
写配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “发证日期”, 相加 (到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度), “,”, 到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度)))
写配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “照片”, 相加 (到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度), “,”, 到文本 (.高度)))
写配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “使用单位”, 相加 (到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度)))
.如果 (等于 (取文本右边 (.标记, 2), “-1”)) ' -1，表示在卡片中。
    写配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “分隔条”, 相加 (到文本 (.左边), “,”, 到文本 (.顶边), “,”, 到文本 (.宽度)))
.否则
    写配置项 (相加 (数据目录, “\set.ini”), “卡片设置”, “分隔条”, “-1,-1,-1”) ' 在寄存区中。
.如果结束


.子程序 寄放组件重排, 空白型, , 
.局部变量 循环变量1, 整数型, , , 
.局部变量 标签组件, 标签, , , 
.局部变量 编辑框组件, 编辑框, , , 
.局部变量 组合框组件, 组合框, , , 
.局部变量 标记文本, 文本型, , "2", 
.局部变量 组件数, 整数型, , , 

.计次循环首 (26, 循环变量1) ' 按顺序放置寄放区中组件。
    .判断开始 (不等于 (寻找文本 (“,1,2,4,6,7,9,11,13,15,17,19,21,23,24,26,”, 相加 (“,”, 到文本 (循环变量1), “,”), , 假), -1)) ' 标签
        赋值 (标签组件, 取标记组件 (循环变量1))
        赋值 (标记文本, 分割文本 (标签组件.标记, “-”, ))
        .如果真 (等于 (标记文本 [2], “2”))
            标签组件.移动 (0, 相乘 (组件数, 20), , ) ' 每个组件高20，依次排放。下同。
            赋值 (组件数, 相加 (组件数, 1))
        .如果真结束
        
    .判断 (不等于 (寻找文本 (“,3,5,12,14,20,22,25,”, 相加 (“,”, 到文本 (循环变量1), “,”), , 假), -1)) ' 组合框
        赋值 (组合框组件, 取标记组件 (循环变量1))
        赋值 (标记文本, 分割文本 (组合框组件.标记, “-”, ))
        .如果真 (等于 (标记文本 [2], “2”))
            组合框组件.移动 (0, 相乘 (组件数, 20), , )
            赋值 (组件数, 相加 (组件数, 1))
        .如果真结束
        
    .判断 (不等于 (寻找文本 (“,8,10,16,18,”, 相加 (“,”, 到文本 (循环变量1), “,”), , 假), -1)) ' 编辑框
        赋值 (编辑框组件, 取标记组件 (循环变量1))
        赋值 (标记文本, 分割文本 (编辑框组件.标记, “-”, ))
        .如果真 (等于 (标记文本 [2], “2”))
            编辑框组件.移动 (0, 相乘 (组件数, 20), , )
            赋值 (组件数, 相加 (组件数, 1))
        .如果真结束
        
    .默认
        
    .判断结束
    
.计次循环尾 ()
刷新显示 ()

.子程序 检查组件, 逻辑型, , 
.局部变量 循环变量1, 整数型, , , 
.局部变量 标签组件, 标签, , , 
.局部变量 编辑框组件, 编辑框, , , 
.局部变量 组合框组件, 组合框, , , 
.局部变量 标记文本, 文本型, , "2", 

.计次循环首 (23, 循环变量1)
    .判断开始 (不等于 (寻找文本 (“,1,2,4,6,7,9,11,13,15,17,19,21,23”, 相加 (“,”, 到文本 (循环变量1), “,”), , 假), -1)) ' 标签
        赋值 (标签组件, 取标记组件 (循环变量1))
        赋值 (标记文本, 分割文本 (标签组件.标记, “-”, ))
        .如果真 (等于 (标记文本 [2], “2”)) ' 如果标记尾数是2，说明该标签在寄存区中，返回真。下同。
            返回 (真)
        .如果真结束
        
    .判断 (不等于 (寻找文本 (“,3,5,12,14,20,22,”, 相加 (“,”, 到文本 (循环变量1), “,”), , 假), -1))
        赋值 (组合框组件, 取标记组件 (循环变量1))
        赋值 (标记文本, 分割文本 (组合框组件.标记, “-”, ))
        .如果真 (等于 (标记文本 [2], “2”))
            返回 (真)
        .如果真结束
        
    .判断 (不等于 (寻找文本 (“,8,10,16,18,”, 相加 (“,”, 到文本 (循环变量1), “,”), , 假), -1))
        赋值 (编辑框组件, 取标记组件 (循环变量1))
        赋值 (标记文本, 分割文本 (编辑框组件.标记, “-”, ))
        .如果真 (等于 (标记文本 [2], “2”))
            返回 (真)
        .如果真结束
        
    .默认
        
    .判断结束
    
.计次循环尾 ()
返回 (假) ' 返回假，表示没有组件在寄存区中。

.子程序 _标题标签_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 事件标签, 标签, , , 
.局部变量 标记文本, 文本型, , "2", 

画控件外观 (0)
赋值 (事件标签, 取事件组件 ())
赋值 (标记文本, 分割文本 (事件标签.标记, “-”, ))
.如果 (等于 (标记文本 [2], “2”)) ' 同上。
    赋值 (当前标签, 事件标签)
    赋值 (组件类型, 1)
    置父窗口 (事件标签.取窗口句柄 (), 取窗口句柄 ())
    赋值 (事件标签.标记, 相加 (标记文本 [1], “-1”))
    事件标签.移动 (10, 10, , )
    事件标签.调整层次 (#顶层)
    刷新显示 ()
    画控件外观 (事件标签.取窗口句柄 ())
.否则
    置父窗口 (事件标签.取窗口句柄 (), 取窗口句柄 ())
    赋值 (事件标签.标记, 相加 (标记文本 [1], “-2”))
    赋值 (组件类型, 0)
.如果结束
寄放组件重排 ()
返回 (假)

.子程序 _证号编辑框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 事件编辑框, 编辑框, , , 
.局部变量 标记文本, 文本型, , "2", 

画控件外观 (0)
赋值 (事件编辑框, 取事件组件 ())
赋值 (标记文本, 分割文本 (事件编辑框.标记, “-”, ))
.如果 (等于 (标记文本 [2], “2”)) ' 同上。
    赋值 (当前编辑框, 事件编辑框)
    赋值 (组件类型, 3)
    置父窗口 (事件编辑框.取窗口句柄 (), 取窗口句柄 ())
    赋值 (事件编辑框.标记, 相加 (标记文本 [1], “-1”))
    事件编辑框.移动 (10, 10, , )
    事件编辑框.调整层次 (#顶层)
    刷新显示 ()
    画控件外观 (事件编辑框.取窗口句柄 ())
.否则
    置父窗口 (事件编辑框.取窗口句柄 (), 取窗口句柄 ())
    赋值 (事件编辑框.标记, 相加 (标记文本 [1], “-2”))
    赋值 (组件类型, 0)
.如果结束
寄放组件重排 ()
返回 (假)

.子程序 _标题标签_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 事件标签, 标签, , , 
.局部变量 标记文本, 文本型, , "2", 

赋值 (事件标签, 取事件组件 ())
赋值 (标记文本, 分割文本 (事件标签.标记, “-”, ))
.如果 (等于 (标记文本 [2], “1”)) ' 同上
    赋值 (事件标签.鼠标指针, 到字节集 (8))
.否则
    赋值 (事件标签.鼠标指针, 到字节集 (13))
.如果结束


.子程序 _标题标签_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 事件标签, 标签, , , 
.局部变量 标记文本, 文本型, , "2", 

赋值 (事件标签, 取事件组件 ())
赋值 (标记文本, 分割文本 (事件标签.标记, “-”, ))
.如果真 (等于 (标记文本 [2], “1”))
    赋值 (当前标签, 事件标签)
    赋值 (组件类型, 1)
    画控件外观 (0) ' 取消上次画的外框。
    事件标签.调整层次 (#顶层)
    刷新显示 ()
    延时 (200)
    画控件外观 (事件标签.取窗口句柄 ()) ' 为事件组件画外框。
    事件标签.发送信息 (161, 2, 0) ' 移动
    刷新显示 ()
.如果真结束


.子程序 _一级区域组合框_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 事件组合框, 组合框, , , 
.局部变量 标记文本, 文本型, , "2", 

赋值 (事件组合框, 取事件组件 ())
赋值 (标记文本, 分割文本 (事件组合框.标记, “-”, ))
.如果 (等于 (标记文本 [2], “1”)) ' 在卡片中。
    .如果 (大于 (横向位置, 相减 (事件组合框.宽度, 5)))
        赋值 (事件组合框.鼠标指针, 到字节集 (12)) ' 显示左右移动指针。下同。
    .否则
        赋值 (事件组合框.鼠标指针, 到字节集 (8)) ' 显示移动十字指针，下同。
    .如果结束
    
.否则
    赋值 (事件组合框.鼠标指针, 到字节集 (13)) ' 在寄存区中，显示上箭头指针。下同。
.如果结束


.子程序 _证号编辑框_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 事件编辑框, 编辑框, , , 
.局部变量 标记文本, 文本型, , "2", 

赋值 (事件编辑框, 取事件组件 ())
赋值 (标记文本, 分割文本 (事件编辑框.标记, “-”, ))
.如果 (等于 (标记文本 [2], “1”))
    .如果 (大于 (横向位置, 相减 (事件编辑框.宽度, 8)))
        赋值 (事件编辑框.鼠标指针, 到字节集 (12))
    .否则
        赋值 (事件编辑框.鼠标指针, 到字节集 (8))
    .如果结束
    
.否则
    赋值 (事件编辑框.鼠标指针, 到字节集 (13))
.如果结束


.子程序 _照片标签_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (大于 (横向位置, 相减 (.宽度, 10))) ' 照片标签太大了，这里设计了不允许被移到寄存区中去。所以就不用判断是否在寄存区中了。
    赋值 (.鼠标指针, 到字节集 (12))
.否则
    赋值 (.鼠标指针, 到字节集 (8))
.如果结束


.子程序 _卡片画板_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (组件类型, 0) ' 记录下来，用于执行工具条中的上下左右移动按钮事件。0：为无组件被选中。
画控件外观 (0)

.子程序 _一级区域组合框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 事件组合框, 组合框, , , 
.局部变量 标记文本, 文本型, , "2", 

赋值 (事件组合框, 取事件组件 ())
赋值 (标记文本, 分割文本 (事件组合框.标记, “-”, ))
.如果真 (等于 (标记文本 [2], “1”)) ' 同标签事件。
    赋值 (当前组合框, 事件组合框)
    赋值 (组件类型, 2)
    画控件外观 (0)
    事件组合框.调整层次 (#顶层)
    刷新显示 ()
    延时 (200)
    .如果 (大于 (横向位置, 相减 (事件组合框.宽度, 5)))
        画控件外观 (0)
        事件组合框.发送信息 (274, 61442, 0)
    .否则
        画控件外观 (事件组合框.取窗口句柄 ())
        事件组合框.发送信息 (161, 2, 0)
    .如果结束
    刷新显示 ()
.如果真结束
返回 (假)

.子程序 _证号编辑框_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 事件编辑框, 编辑框, , , 
.局部变量 标记文本, 文本型, , "2", 

赋值 (事件编辑框, 取事件组件 ())
赋值 (标记文本, 分割文本 (事件编辑框.标记, “-”, ))
.如果真 (等于 (标记文本 [2], “1”)) ' 同标签事件。
    赋值 (当前编辑框, 事件编辑框)
    赋值 (组件类型, 3)
    画控件外观 (0)
    事件编辑框.调整层次 (#顶层)
    刷新显示 ()
    延时 (200)
    .如果 (大于 (横向位置, 相减 (事件编辑框.宽度, 8)))
        画控件外观 (0)
        事件编辑框.发送信息 (274, 61442, 0)
    .否则
        画控件外观 (事件编辑框.取窗口句柄 ())
        事件编辑框.发送信息 (161, 2, 0)
    .如果结束
    刷新显示 ()
.如果真结束
返回 (假)

.子程序 _照片标签_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (组件类型, 4)
画控件外观 (0)
#顶层.调整层次 ()
刷新显示 ()
延时 (200)
.如果 (大于 (横向位置, 相减 (.宽度, 10)))
    画控件外观 (0)
    274.发送信息 (61442, 0) ' 左右调整大小
    赋值 (.高度, 相乘 (相除 (.宽度, 4), 5)) ' 实进改变高度，以确保4：5
.否则
    画控件外观 (取窗口句柄 ())
    161.发送信息 (2, 0)
.如果结束
刷新显示 ()
返回 (假)

.子程序 _一级区域组合框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 事件组合框, 组合框, , , 
.局部变量 标记文本, 文本型, , "2", 

画控件外观 (0)
赋值 (事件组合框, 取事件组件 ())
赋值 (标记文本, 分割文本 (事件组合框.标记, “-”, ))
.如果 (等于 (标记文本 [2], “2”)) ' 2：在寄存区中。1：在卡片中。鼠标双击为组件置新父。
    赋值 (当前组合框, 事件组合框)
    赋值 (组件类型, 2)
    置父窗口 (事件组合框.取窗口句柄 (), 取窗口句柄 ())
    赋值 (事件组合框.标记, 相加 (标记文本 [1], “-1”))
    事件组合框.移动 (10, 10, , ) ' 默认移动到位置10，10
    事件组合框.调整层次 (#顶层) ' 并置顶层。
    刷新显示 ()
    画控件外观 (事件组合框.取窗口句柄 ())
.否则
    置父窗口 (事件组合框.取窗口句柄 (), 取窗口句柄 ())
    赋值 (事件组合框.标记, 相加 (标记文本 [1], “-2”))
    赋值 (组件类型, 0)
.如果结束
寄放组件重排 ()
返回 (假)

.子程序 _纵向滚动条1_位置被改变, 空白型, , 
赋值 (.顶边, 相减 (1, .位置))

.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.如果真 (等于 (组件类型, 0))
    返回 ()
.如果真结束
.判断开始 (等于 (按钮索引, 0)) ' 居中
    .判断开始 (等于 (组件类型, 1)) ' 标签
        当前标签.移动 (相除 (相减 (.宽度, 当前标签.宽度), 2), , , )
    .判断 (等于 (组件类型, 2)) ' 组合框
        当前组合框.移动 (相除 (相减 (.宽度, 当前组合框.宽度), 2), , , )
    .判断 (等于 (组件类型, 3)) ' 编辑框
        当前编辑框.移动 (相除 (相减 (.宽度, 当前编辑框.宽度), 2), , , )
    .判断 (等于 (组件类型, 4)) ' 照片标签
        相除 (相减 (.宽度, .宽度), 2).移动 ()
    .默认
        
    .判断结束
    
.判断 (等于 (按钮索引, 1)) ' 左移
    .判断开始 (等于 (组件类型, 1))
        当前标签.移动 (相减 (当前标签.左边, 1), , , )
    .判断 (等于 (组件类型, 2))
        当前组合框.移动 (相减 (当前组合框.左边, 1), , , )
    .判断 (等于 (组件类型, 3))
        当前编辑框.移动 (相减 (当前编辑框.左边, 1), , , )
    .判断 (等于 (组件类型, 4))
        相减 (.左边, 1).移动 ()
    .默认
        
    .判断结束
    
.判断 (等于 (按钮索引, 2)) ' 右移
    .判断开始 (等于 (组件类型, 1))
        当前标签.移动 (相加 (当前标签.左边, 1), , , )
    .判断 (等于 (组件类型, 2))
        当前组合框.移动 (相加 (当前组合框.左边, 1), , , )
    .判断 (等于 (组件类型, 3))
        当前编辑框.移动 (相加 (当前编辑框.左边, 1), , , )
    .判断 (等于 (组件类型, 4))
        相加 (.左边, 1).移动 ()
    .默认
        
    .判断结束
    
.判断 (等于 (按钮索引, 3)) ' 上移
    .判断开始 (等于 (组件类型, 1))
        当前标签.移动 (相减 (当前标签.顶边, 1), , )
    .判断 (等于 (组件类型, 2))
        当前组合框.移动 (相减 (当前组合框.顶边, 1), , )
    .判断 (等于 (组件类型, 3))
        当前编辑框.移动 (相减 (当前编辑框.顶边, 1), , )
    .判断 (等于 (组件类型, 4))
        .移动 (相减 (.顶边, 1), , )
    .默认
        
    .判断结束
    
.判断 (等于 (按钮索引, 4)) ' 下移
    .判断开始 (等于 (组件类型, 1))
        当前标签.移动 (相加 (当前标签.顶边, 1), , )
    .判断 (等于 (组件类型, 2))
        当前组合框.移动 (相加 (当前组合框.顶边, 1), , )
    .判断 (等于 (组件类型, 3))
        当前编辑框.移动 (相加 (当前编辑框.顶边, 1), , )
    .判断 (等于 (组件类型, 4))
        .移动 (相加 (.顶边, 1), , )
    .默认
        
    .判断结束
    
.默认
    
.判断结束


.子程序 _数据年结_被选择, 空白型, , 
.局部变量 年结目录, 文本型, , , 
.局部变量 权限口令, 文本型, , , 

.如果真 (不等于 (当前用户, “超级管理员”)) ' 只有管理员才能进行初始化。
    信息框 (“你不是超级用户，没有数据年结的权限，请以超级用户身份重新登录！”, #信息图标, )
    返回 ()
.如果真结束
赋值 (., 0)
赋值 (., 3)
.如果真 (或者 (并且 (不等于 (取月份 (取现行时间 ()), 1), 大于 (取日 (取现行时间 ()), 4)), 并且 (不等于 (取月份 (取现行时间 ()), 12), 不等于 (取日 (取现行时间 ()), 31))))
    .如果真 (等于 (信息框 (相加 (“    数据年结将会将现有数据库内容冻结并移至指定目录。建议此项操作应该在上一年的12月31日或本年度的1月4日（第一个工作日）前进行。”, #换行符, “    你确定要现在进行数据年结操作吗？”), 相加 (#信息图标, #确认取消钮, #默认按钮二), ), #取消钮))
        返回 ()
    .如果真结束
    
.如果真结束
.如果 (输入框 (“请输入数据年结权限口令：”, “权限确认”, “”, 权限口令, #输入密码)) ' 为防止误操作，进行数据年结及初始化时均需要输入口令。口令在帮助文件中提供。
    .如果真 (不等于 (未知支持库函数_2 (到字节集 (权限口令)), “d5059c191f8744ce384c54ae32c583df”))
        信息框 (“权限确认口令错误，请查阅帮助文档，获取正确的权限确认口令。”, #信息图标, )
        返回 ()
    .如果真结束
    
.否则
    返回 ()
.如果结束
.如果 (等于 (取月份 (取现行时间 ()), 12)) ' 12月份，默认年结当年的数据。否则，默认年结上年数据。
    赋值 (年结目录, 相加 (取运行目录 (), “\”, 到文本 (取年份 (取现行时间 ())), “data”))
.否则
    赋值 (年结目录, 相加 (取运行目录 (), “\”, 到文本 (相减 (取年份 (取现行时间 ()), 1)), “data”))
.如果结束
输出调试文本 (年结目录)
.如果 (等于 (寻找文件 (年结目录, #子目录), “”))
    创建目录 (年结目录)
.否则
    .如果真 (等于 (信息框 (相加 (取文本左边 (取文本右边 (年结目录, 相减 (取文本长度 (年结目录), 倒找文本 (年结目录, “\”, , 假))), 4), “年年结数据目录已经存在，你确定要再次进行数据年结操作吗？”), 相加 (#询问图标, #确认取消钮, #默认按钮二), ), #取消钮))
        返回 ()
    .如果真结束
    
.如果结束
全部关闭 ()
复制文件 (相加 (取运行目录 (), “\data\jkzlib.dat”), 相加 (年结目录, “\jkzlib.dat”))
复制文件 (相加 (取运行目录 (), “\data\jkzlib.edt”), 相加 (年结目录, “\jkzlib.edt”))
复制文件 (相加 (取运行目录 (), “\data\jkzlib.enx”), 相加 (年结目录, “\jkzlib.enx”))
复制文件 (相加 (取运行目录 (), “\data\set.ini”), 相加 (年结目录, “\set.ini”))
信息框 (“年结完成。你以后可以通过查看往年数据菜单，来查看已经年结的数据。”, #信息图标, )
赋值 (.禁止, 假)
.如果 (等于 (信息框 (相加 (“你准备继续使用目前的系统配置信息，还是重新进行系统初始化？”, #换行符, “如果当前的设置使用正确的话，建议你继续使用而不要轻易改变设置。”, #换行符, “点击是钮，继续使用当前配置，点击否钮，进行系统初始化。”), 相加 (#询问图标, #是否钮), ), #是钮))
    打开 (“autobak\jkzlib.dat”, “jkz”, , , , , “jkzlib.enx”) ' 打开数据库，同时打开索引文件。
    清空 () ' 清空原有数据
    关闭 ()
    打开 (“data\jkzlib.dat”, “jkz”, , , , , “jkzlib.enx”) ' 打开数据库，同时打开索引文件。
    清空 ()
    读记录 ()
.否则
    .如果 (等于 (信息框 (“    系统初始化将导致现有的健康证明配置丢失，你确定要进行初始化设置吗？”, 相加 (#询问图标, #是否钮, #默认按钮二), ), #否钮))
        打开 (“autobak\jkzlib.dat”, “jkz”, , , , , “jkzlib.enx”) ' 打开数据库，同时打开索引文件。
        清空 () ' 清空原有数据
        关闭 ()
        打开 (“data\jkzlib.dat”, “jkz”, , , , , “jkzlib.enx”) ' 打开数据库，同时打开索引文件。
        清空 ()
        读记录 ()
    .否则
        删除文件 (“data\jkzlib.dat”) ' 删除现有数据，以便初始化以后重新创建数据库。
        删除文件 (“data\jkzlib.edt”)
        删除文件 (“data\jkzlib.enx”)
        打开 (“autobak\jkzlib.dat”, “jkz”, , , , , “jkzlib.enx”) ' 打开数据库，同时打开索引文件。
        清空 () ' 清空原有数据
        全部关闭 ()
        复制文件 (相加 (未知支持库函数_7 (10), “jkzm.sys”), 相加 (未知支持库函数_7 (10), “jkzmbak.sys”))
        赋值 (当前操作, 14)
        禁止卷帘菜单 (真)
        禁止菜单 (真)
        赋值 (.现行子夹, 1)
        _选择夹1_子夹被改变 ()
        赋值 (.选中, 等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “一级区域”, “假”), “真”)) ' 读取现有值，如果现有值不存在，则设置默认值。下同。
        赋值 (.选中, 等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, “假”), “真”))
        _一级区域_被单击 ()
        赋值 (.选中, 等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “所在单位”, “假”), “真”))
        赋值 (.选中, 等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “照片”, “假”), “真”))
        赋值 (.选中, 等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “体检结果”, “假”), “真”))
        赋值 (.选中, 等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “培训结果”, “假”), “真”))
        赋值 (., 146)
        赋值 (., 392)
        赋值 (., “确 定(&Y)”)
        连续赋值 (假, ., ., .可视, ., ., ., .)
        写配置项 (相加 (数据目录, “\set.ini”), “初始化”, “初始化”, “1”) ' 1:初始化未结束；0:初始化已结束。
        复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
        记录摘要 (2)
    .如果结束
    
.如果结束


.子程序 _查看往年数据_被选择, 空白型, , 
.局部变量 年份, 文本型, , , 

赋值 (., 0)
赋值 (., 4)
.如果真 (等于 (输入框 (“请输入要查看数据的年份”, “查看往年数据”, 到文本 (相减 (取年份 (取现行时间 ()), 1)), 年份, #输入整数), 假))
    返回 ()
.如果真结束
.如果真 (等于 (寻找文件 (相加 (取运行目录 (), “\”, 年份, “data”), #子目录), “”))
    信息框 (“指定的年份的数据目录未找到！”, #信息图标, )
    返回 ()
.如果真结束
赋值 (.禁止, 真)
赋值 (数据目录, 相加 (取运行目录 (), “\”, 年份, “data”))
.如果真 (等于 (文件是否存在 (相加 (数据目录, “\set.ini”)), 假))
    信息框 (“指定年份数据中配置文件丢失，无法查看该年数据。”, #信息图标, )
    返回 ()
.如果真结束
全部关闭 ()
.如果真 (等于 (打开 (相加 (数据目录, “\jkzlib.dat”), “jkz”, , , , , “jkzlib.enx”), 假)) ' 打开数据库，同时打开索引文件。
    信息框 (相加 (“打开指定年份数据库失败，”, 取错误信息 (), “。无法查看该年数据！”), #信息图标, )
    关闭 ()
    赋值 (数据目录, 相加 (取运行目录 (), “\data”))
    打开 (相加 (数据目录, “\jkzlib.dat”), “jkz”, , , , , “jkzlib.enx”) ' 打开数据库，同时打开索引文件。
    到尾记录 ()
    读记录 ()
    返回 ()
.如果真结束
调整卡片布局 ()
填充初始数据 ()
到首记录 ()
读记录 ()
连续赋值 (假, ., ., ., ., ., .)
赋值 (., 真)
赋值 (., 265)
赋值 (当前操作, 13) ' 查看往年数据
禁止卷帘菜单 (真)
禁止菜单 (真)
连续赋值 (假, .禁止, .禁止, .禁止, .禁止, .禁止)
1.未知支持库函数_26 (3, 假)
1.未知支持库函数_26 (5, 假)
2.未知支持库函数_26 (0, 假)
2.未知支持库函数_26 (1, 假)
_选择夹1_子夹被改变 ()

.子程序 _初始化_被选择, 空白型, , 
.局部变量 权限口令, 文本型, , , 

.如果真 (不等于 (当前用户, “超级管理员”)) ' 只有管理员才能进行初始化。
    信息框 (“初始化操作将可能影响现有数据。你不是超级用户，没有初始化系统的权限，请以超级用户身份重新登录！”, #信息图标, )
    返回 ()
.如果真结束
.如果 (输入框 (“请输入初始化数据权限口令：”, “权限确认”, “”, 权限口令, #输入密码)) ' 为防止误操作，进行初始化需要输入口令。口令在帮助文件中提供。
    .如果真 (不等于 (未知支持库函数_2 (到字节集 (权限口令)), “d5059c191f8744ce384c54ae32c583df”))
        信息框 (“权限确认口令错误，请查阅帮助文档，获取正确的权限确认口令。”, #信息图标, )
        返回 ()
    .如果真结束
    
.否则
    返回 ()
.如果结束
.如果真 (等于 (信息框 (相加 (“    初始化设置将可能导致现有的健康证明数据丢失，请在初始化设置前妥善保存现有的所有设置及健康证明数据（数据目录为DATA）。”, #换行符, “    你确定要进行初始化设置吗？”), 相加 (#询问图标, #是否钮, #默认按钮二), ), #否钮)) ' 弹出多个信息框，由用户反复确认，进一步防止误操作而进行初始化。
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“点击确认按钮将开始初始化设置，点击取消按钮退出。”, 相加 (#信息图标, #确认取消钮, #默认按钮二), ), #取消钮))
    返回 ()
.如果真结束
全部关闭 ()
复制文件 (“data\jkzlib.dat”, “autobak\jkzlib.dat”) ' 记录修改成功，则及时备份数据库到自动备份目录。
复制文件 (“data\jkzlib.edt”, “autobak\jkzlib.edt”)
复制文件 (“data\jkzlib.enx”, “autobak\jkzlib.enx”)
删除文件 (“data\jkzlib.dat”) ' 删除现有数据，以便初始化以后重新创建数据库。但自动备份目录（autobak）中仍保留有现有的数据，所以实际上不会丢失。
删除文件 (“data\jkzlib.edt”)
删除文件 (“data\jkzlib.enx”)
复制文件 (相加 (未知支持库函数_7 (10), “jkzm.sys”), 相加 (未知支持库函数_7 (10), “jkzmbak.sys”))
赋值 (当前操作, 14)
赋值 (.现行子夹, 1)
_选择夹1_子夹被改变 ()
赋值 (.选中, 等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “一级区域”, “假”), “真”)) ' 读取现有值，如果现有值不存在，则设置默认值。下同。
赋值 (.选中, 等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, “假”), “真”))
_一级区域_被单击 ()
赋值 (.选中, 等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “所在单位”, “假”), “真”))
赋值 (.选中, 等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “照片”, “假”), “真”))
赋值 (.选中, 等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “体检结果”, “假”), “真”))
赋值 (.选中, 等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “培训结果”, “假”), “真”))
赋值 (., 146)
赋值 (., 392)
赋值 (., “确 定(&Y)”)
连续赋值 (假, ., ., .可视, ., ., ., .)
写配置项 (相加 (数据目录, “\set.ini”), “初始化”, “初始化”, “1”) ' 1:初始化未结束；0:初始化已结束。
复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
记录摘要 (2)
赋值 (., 0)
赋值 (., 0)
禁止卷帘菜单 (真)
禁止菜单 (真)

.子程序 _退出_被选择, 空白型, , 
.如果真 (程序结束 ())
    结束 ()
.如果真结束


.子程序 __启动窗口_可否被关闭, 逻辑型, , 
返回 (程序结束 ())

.子程序 _证号编辑框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _保存按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _保存按钮_被单击 ()
.如果真结束


.子程序 _打印按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _打印按钮_被单击 ()
.如果真结束


.子程序 _增加按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _增加按钮_被单击 ()
.如果真结束


.子程序 _修改按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _修改按钮_被单击 ()
.如果真结束


.子程序 _取消按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _取消按钮_被单击 ()
.如果真结束


.子程序 _卷帘式菜单1_项目被选择, 空白型, , 
.参数 菜单索引, 整数型, , 
.参数 项目索引, 整数型, , 

.如果真 (等于 (菜单索引.未知支持库函数_25 (项目索引), 真))
    返回 ()
.如果真结束
.判断开始 (等于 (菜单索引, 0))
    .判断开始 (等于 (项目索引, 0))
        _初始化_被选择 ()
    .判断 (等于 (项目索引, 1))
        _数据备份_被选择 ()
    .判断 (等于 (项目索引, 2))
        _数据恢复_被选择 ()
    .判断 (等于 (项目索引, 3))
        _数据年结_被选择 ()
    .判断 (等于 (项目索引, 4))
        .如果真 (等于 (.禁止, 假))
            _查看往年数据_被选择 ()
        .如果真结束
        
    .默认
        
    .判断结束
    
.判断 (等于 (菜单索引, 1))
    .判断开始 (等于 (项目索引, 0))
        _添加新记录_被选择 ()
    .判断 (等于 (项目索引, 1))
        _修改记录_被选择 ()
    .判断 (等于 (项目索引, 2))
        _删除记录_被选择 ()
    .判断 (等于 (项目索引, 3))
        _查找记录_被选择 ()
    .判断 (等于 (项目索引, 4))
        _用编辑器查看_被选择 ()
    .判断 (等于 (项目索引, 5))
        _数据统计_被选择 ()
    .默认
        
    .判断结束
    
.判断 (等于 (菜单索引, 2))
    .判断开始 (等于 (项目索引, 0))
        _打印当前健康证_被选择 ()
    .判断 (等于 (项目索引, 1))
        _批量打印健康证_被选择 ()
    .默认
        
    .判断结束
    
.判断 (等于 (菜单索引, 3))
    .判断开始 (等于 (项目索引, 0))
        _单位名称_被选择 ()
    .判断 (等于 (项目索引, 1))
        _备份目录_被选择 ()
    .判断 (等于 (项目索引, 2))
        _工种设置_被选择 ()
    .判断 (等于 (项目索引, 3))
        _区域设置_被选择 ()
    .默认
        
    .判断结束
    
.判断 (等于 (菜单索引, 4))
    .判断开始 (等于 (项目索引, 0))
        _编号规则_被选择 ()
    .判断 (等于 (项目索引, 1))
        _证件设置_被选择 ()
    .判断 (等于 (项目索引, 2))
        _卡片布局_被选择 ()
    .判断 (等于 (项目索引, 3))
        _打印设置_被选择 ()
    .判断 (等于 (项目索引, 4))
        _照片来源_被选择 ()
    .默认
        
    .判断结束
    
.判断 (等于 (菜单索引, 5))
    .判断开始 (等于 (项目索引, 0))
        _重新登录_被选择 ()
    .判断 (等于 (项目索引, 1))
        _添加用户_被选择 ()
    .判断 (等于 (项目索引, 2))
        _删除用户_被选择 ()
    .判断 (等于 (项目索引, 3))
        _修改口令_被选择 ()
    .默认
        
    .判断结束
    
.判断 (等于 (菜单索引, 6))
    .判断开始 (等于 (项目索引, 0))
        _计算器_被选择 ()
    .判断 (等于 (项目索引, 1))
        _记事本_被选择 ()
    .判断 (等于 (项目索引, 2))
        _背景音乐_被选择 ()
    .默认
        
    .判断结束
    
.判断 (等于 (菜单索引, 7))
    .判断开始 (等于 (项目索引, 0))
        _帮助主题_被选择 ()
    .判断 (等于 (项目索引, 1))
        _关于_被选择 ()
    .默认
        
    .判断结束
    
.默认
    
.判断结束


.子程序 _填充空号_被选择, 空白型, , 
赋值 (.选中, 真)
赋值 (.选中, 假)
写配置项 (相加 (数据目录, “\set.ini”), “杂项”, “新号方式”, “填充空号”)
复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”)) ' 配置文件被修改后，及时复制到系统目录。下同。
记录摘要 (2)

.子程序 _最大号码_被选择, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 真)
写配置项 (相加 (数据目录, “\set.ini”), “杂项”, “新号方式”, “最大号码”)
复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
记录摘要 (2)

.子程序 _打印预览_被选择, 空白型, , 
载入 (预览窗口, , 真)
.如果真 (预览后打印)
    _打印当前健康证_被选择 ()
.如果真结束


.子程序 _选择夹1_子夹被改变, 空白型, , 本子程序用以设置即时帮助
.判断开始 (等于 (.现行子夹, 0))
    .如果 (等于 (当前操作, 13))
        赋值 (.标题, 相加 (“・健康证明数据界面，你可以在这里添加、修改健康证明数据。管理员还可以删除当前健康证明数据。”, #换行符, “・当现有记录数超过1时，点击浮动工具条按钮，可以翻动查看现有健康证明数据。”, #换行符, #换行符, “★当前为查看往年数据状态，不允许进行系统配置设置及记录修改。”))
    .否则
        .如果 (等于 (未知支持库函数_2 (读入文件 (相加 (数据目录, “\set.ini”))), 未知支持库函数_2 (#默认配置)))
            赋值 (.标题, 相加 (“・健康证明数据界面，你可以在这里添加、修改健康证明数据。管理员还可以删除当前健康证明数据。”, #换行符, “・当现有记录数超过1时，点击浮动工具条按钮，可以翻动查看现有健康证明数据。”, #换行符, “★你目前使用的是系统默认配置，如果需要，你可以点击[数据库->初始化]菜单，重新定义数据库字段及其他配置！”))
        .否则
            赋值 (.标题, 相加 (“・健康证明数据界面，你可以在这里添加、修改健康证明数据。管理员还可以删除当前健康证明数据。”, #换行符, “・当现有记录数超过1时，点击浮动工具条按钮，可以翻动查看现有健康证明数据。”))
        .如果结束
        
    .如果结束
    
.判断 (等于 (.现行子夹, 1))
    赋值 (.标题, 相加 (“・重新设置健康证明数据库字段，打造适合用户自己的管理环境。”, #换行符, “・被灰化的项目是必须存在的字段。其它项目请根据你当地的实际需要勾选。”, #换行符, “・[区域设置]相关项目用于对当地的健康证明数据进行分区域管理，在健康证明打印时不会被选择；”, #换行符, “  [证件相关]相关项目为健康证明的关键项目，将显示并可以打印至健康证明卡片。”))
.判断 (等于 (.现行子夹, 2))
    赋值 (.标题, 相加 (“・设置从业人员所从事的工种，可以根据你当地的实际情况进行设置，每个工种长度不得超过5个汉字（建议在4个汉字以内）。”, #换行符, “・如果当前已有健康证明数据，如果其所属工种被修改或删除，系统不会自动进行关联修改，你必须在需要时手工操作。”))
.判断 (等于 (.现行子夹, 3))
    赋值 (.标题, 相加 (“・设置健康证明数据所需要的区域分类，以方便对健康证明数据进行分区域管理。”, #换行符, “・如果你设置了二级区域，则每个一级区域下必须设置具体的二级区域！”, #换行符, “・修改区域设置，将会造成现有的健康证明数据分类紊乱，请谨慎使用。”))
.判断 (等于 (.现行子夹, 4))
    赋值 (.标题, 相加 (“・设置健康证明发证单位或健康检查单位名称，该名称将显示或打印在健康证明卡片指定位置。”, #换行符, “・请保留单位名称前的”, #左引号, “发证单位”, #右引号, “或”, #左引号, “健康检查单位”, #右引号, “字样。”))
.判断 (等于 (.现行子夹, 5))
    赋值 (.标题, 相加 (“・设置健康证明数据默认的备份目录，以便你利用菜单[数据库->数据备份]或[数据库->数据恢复]来备份或恢复健康证明数据。”, #换行符, “・请确保你所设置的备份目录不会被删除。建议设置在与《健康证明管理系统》安装目录所在分区不同的分区中。”))
.判断 (等于 (.现行子夹, 6))
    赋值 (.标题, 相加 (“・设置健康证明号码的编号规则。在添加新记录时，系统会根据你所设定的规则自动计算新的健康证明号码。”, #换行符, “・请同时通过菜单[系统设置->添加证号方式]来设置新号码产生方式。”, #换行符, “・如果你在使用过程中重新设置了编号规则，将有可能使原有健康证明数据与现有规则不兼容。你将无法对原有健康证明数据进行修改、批量打印等操作。请谨慎使用本功能。”))
.判断 (等于 (.现行子夹, 7))
    赋值 (.标题, 相加 (“・设置健康证明卡片中照片来源。”, #换行符, “    仅显示：仅在系统界面中显示照片框，而不导入实际照片。”, #换行符, “    来自文件：从图像文件中导入从业人员照片，可以实际保存到数据库并打印。”, #换行符, “    来自数码设备：从系统安装的数码设备中获取从业人员照片。可以实际保存到数据库并打印。”))
.判断 (等于 (.现行子夹, 8))
    赋值 (.标题, 相加 (“・设置《健康证明管理系统》主界面中健康证明卡片的布局。在用户设置数据库字段时未包含的内容将不会显示在界面中。”, #换行符, “・界面设置仅改变健康证明卡片显示效果，不会影响健康证明数据及健康证明打印格式。”, #换行符, “・请拖动相应组件到合适的位置，然后通过工具条进行位置微调。”))
.判断 (等于 (.现行子夹, 9))
    赋值 (.标题, 相加 (“・设置实际打印的健康证明卡片大小及连续张数。单位：毫米。”, #换行符, “・连续张数适用于某些以几份健康证明卡片连为一页的情况。仅在批量打印时使用。（如果批量打印的健康证明数小于卡片连续张数，系统会自动换页以避免出错。）”))
.判断 (等于 (.现行子夹, 10))
    赋值 (.标题, 相加 (“・设置健康证明各字段内容打印位置。可以用直尺精确丈量。单位：毫米。”, #换行符, “・勾选所有需要打印的字段，并正确设置打印位置。设置完毕，你可以通过菜单[打印->打印预览]来察看效果。”, #换行符, “★注意，系统并不会自动对你设置的健康证明卡片大小与相关字段打印位置进行判断。在设置时请不要超出打印范围。”))
.判断 (等于 (.现行子夹, 11))
    赋值 (.标题, 相加 (“・查找已有的健康证明数据。”, #换行符, “・可以根据从业人员姓名或健康证明号码进行查找。”, #换行符, “★找到一个记录后，系统会自动切换至主界面并显示该记录内容。你可以通过菜单[记录操作->查找下一个]或按下F3键，继续查找下一个满足条件的记录。”))
.默认
    
.判断结束


.子程序 _一级区域_被单击, 空白型, , 
.如果 (等于 (.选中, 假)) ' 如果未选择一级区域，则不允许选择二级区域
    赋值 (.选中, 假)
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
.如果结束


.子程序 集合_主界面, 空白型, , 主界面所有按钮操作
.参数 按钮操作, 文本型, , 添加，修改，保存，取消，打印

.判断开始 (等于 (按钮操作, “添加”))
    _添加新记录_被选择 ()
.判断 (等于 (按钮操作, “修改”))
    _修改记录_被选择 ()
.判断 (等于 (按钮操作, “保存”))
    .如果真 (等于 (判断输入 (), 假))
        返回 ()
    .如果真结束
    .如果真 (等于 (判断编码 (), 假))
        获取焦点 ()
        返回 ()
    .如果真结束
    .如果 (等于 (当前操作, 1)) ' 添加记录。
        加空记录 ()
        .如果真 (等于 (写记录 (), 假))
            信息框 (相加 (“记录保存失败！”, 取错误信息 (), “。”), #错误图标, “错误”)
            删除 ()
            彻底删除 ()
            返回 ()
        .如果真结束
        
    .否则
        .如果真 (等于 (写记录 (), 假)) ' 修改记录
            信息框 (相加 (“记录保存失败！”, 取错误信息 (), “。”), #错误图标, “错误”)
            返回 ()
        .如果真结束
        
    .如果结束
    复制文件 (“data\jkzlib.dat”, “autobak\jkzlib.dat”) ' 记录修改成功，则及时备份数据库到自动备份目录。
    复制文件 (“data\jkzlib.edt”, “autobak\jkzlib.edt”)
    复制文件 (“data\jkzlib.enx”, “autobak\jkzlib.enx”)
    赋值 (当前操作, 0) ' 0：无操作。
    连续赋值 (假, .禁止, .禁止, .禁止, ., .禁止, .禁止, .禁止)
    连续赋值 (真, ., ., .可视)
    读记录 ()
    未知函数_67178137 (假)
    未知函数_67178138 (假)
    获取焦点 ()
.判断 (等于 (按钮操作, “取消”))
    .如果真 (等于 (当前操作, 1)) ' 添加记录
        到尾记录 ()
    .如果真结束
    连续赋值 (假, .禁止, .禁止, .禁止, ., .禁止, .禁止, .禁止)
    连续赋值 (真, ., ., .可视)
    读记录 ()
    禁止卷帘菜单 (假)
    禁止菜单 (假)
    赋值 (当前操作, 0) ' 0：无操作。
    获取焦点 ()
.判断 (等于 (按钮操作, “打印”))
    _打印当前健康证_被选择 ()
    获取焦点 ()
.默认
    
.判断结束


.子程序 集合_重设字段, 空白型, , 
.参数 按钮操作, 文本型, , 确定，取消

.判断开始 (等于 (按钮操作, “确定”))
    写配置项 (相加 (数据目录, “\set.ini”), “字段”, “一级区域”, 到文本 (.选中)) ' 记录字段选择。
    写配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, 到文本 (.选中))
    写配置项 (相加 (数据目录, “\set.ini”), “字段”, “所在单位”, 到文本 (.选中))
    写配置项 (相加 (数据目录, “\set.ini”), “字段”, “照片”, 到文本 (.选中))
    写配置项 (相加 (数据目录, “\set.ini”), “字段”, “体检结果”, 到文本 (.选中))
    写配置项 (相加 (数据目录, “\set.ini”), “字段”, “培训结果”, 到文本 (.选中))
    写配置项 (相加 (数据目录, “\set.ini”), “初始化”, “初始化进度”, “1”) ' 初始化需要对选择夹下列子夹进行重新设置：1，3，6，8。这里记录完成的子夹。
    信息框 (“    你重新设置了数据库字段，需要接着进行一系列初始化设置，期间如果按取消键退出设置，那么，所做的一切改变都将被忽略，系统将自动恢复你重设字段前的配置！”, #信息图标, “系统初始化”)
    复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
    记录摘要 (2)
    赋值 (., 真)
    .如果 (并且 (等于 (.选中, 假), 等于 (.选中, 假))) ' 如果选择了区域字段，则进入区域设置，否则，进入编号规则设置。
        _编号规则_被选择 ()
    .否则
        _区域设置_被选择 ()
    .如果结束
    
.判断 (等于 (按钮操作, “取消”))
    .如果真 (等于 (文件是否存在 (“data\jkzlib.dat”), 假))
        复制文件 (“autobak\jkzlib.dat”, “data\jkzlib.dat”) ' 用自动备份的数据库恢复。
        复制文件 (“autobak\jkzlib.edt”, “data\jkzlib.edt”)
        复制文件 (“autobak\jkzlib.enx”, “data\jkzlib.enx”)
        .如果真 (等于 (打开 (“data\jkzlib.dat”, “jkz”, , , , , “jkzlib.enx”), 假))
            信息框 (相加 (“无法打开健康证明数据库”, “！”, 取错误信息 (), “。”, #换行符, “请用数据恢复功能恢复上次保存的数据库！”), #错误图标, “错误”)
        .如果真结束
        
    .如果真结束
    全部关闭 ()
    复制文件 (相加 (未知支持库函数_7 (10), “jkzmbak.sys”), 相加 (数据目录, “\set.ini”)) ' 恢复原来的配置
    调整卡片布局 ()
    填充初始数据 ()
    写配置项 (相加 (取运行目录 (), “\rich32.dll”), “run”, “mode”, “0”)
    检查数据库完整 ()
    复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
    记录摘要 (2)
    赋值 (., “保 存(&S)”)
    赋值 (., “取 消(&X)”)
    赋值 (., “打 印(&P)”)
    读记录 ()
    禁止卷帘菜单 (假)
    禁止菜单 (假)
     ' 卷帘式菜单1.现行选中菜单 ＝ 1
    赋值 (.现行子夹, 0)
    _选择夹1_子夹被改变 ()
    赋值 (当前操作, 0) ' 0：无操作。
.默认
    
.判断结束


.子程序 集合_工种设置, 空白型, , 
.参数 按钮操作, 文本型, , 添加，修改，保存，取消，删除，返回

.局部变量 循环变量1, 整数型, , , 
.局部变量 行业文本, 文本型, , , 

.判断开始 (等于 (按钮操作, “添加”))
    连续赋值 (真, ., ., ., .)
    连续赋值 (假, ., ., .禁止)
    获取焦点 ()
    赋值 (修改, 假)
.判断 (等于 (按钮操作, “修改”))
    连续赋值 (真, ., ., ., .)
    连续赋值 (假, ., ., .禁止)
    获取焦点 ()
    赋值 (修改, 真)
.判断 (等于 (按钮操作, “保存”))
    .如果真 (等于 (.内容, “”))
        信息框 (“请输入完整的工种名称!”, #信息图标, )
        获取焦点 ()
        返回 ()
    .如果真结束
    .如果 (等于 (修改, 真))
        .如果 (判断项目是否存在 (.内容, .现行选中项))
            信息框 (相加 (“重名工种”, #左引号, .内容, #右引号, “已经存在！”), #信息图标, )
            获取焦点 ()
            返回 ()
        .否则
            .置项目文本 (.现行选中项, .内容)
        .如果结束
        
    .否则
        .如果 (判断项目是否存在 (.内容))
            信息框 (相加 (“重名工种”, #左引号, .内容, #右引号, “已经存在！”), #信息图标, )
            获取焦点 ()
            返回 ()
        .否则
            .加入项目 (.内容, )
            赋值 (.现行选中项, 相减 (取项目数 (), 1))
        .如果结束
        
    .如果结束
    .计次循环首 (取项目数 (), 循环变量1) ' 每次添加后，都重新连接行业文本，并写入配置文件。
        赋值 (行业文本, 相加 (行业文本, 相减 (循环变量1, 1).取项目文本 (), “,”))
    .计次循环尾 ()
    赋值 (行业文本, 取文本左边 (行业文本, 相减 (取文本长度 (行业文本), 1)))
    写配置项 (相加 (数据目录, “\set.ini”), “工种设置”, “工种”, 行业文本)
    复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
    记录摘要 (2)
    赋值 (修改, 假)
    连续赋值 (假, ., ., ., .)
    连续赋值 (真, ., ., .禁止)
.判断 (等于 (按钮操作, “取消”))
    .如果 (大于 (取项目数 (), 0))
        连续赋值 (假, ., .)
        赋值 (.内容, .取项目文本 (.现行选中项))
    .否则
        连续赋值 (真, ., .)
        赋值 (.内容, “”)
    .如果结束
    连续赋值 (假, ., .)
    连续赋值 (真, ., ., .禁止)
    赋值 (修改, 假)
.判断 (等于 (按钮操作, “删除”))
    .如果真 (等于 (信息框 (“你确定要删除该工种吗？”, 相加 (#询问图标, #是否钮, #默认按钮二), ), #是钮))
        .删除项目 (.现行选中项)
        赋值 (.现行选中项, 0)
        _行业列表框_列表项被选择 ()
        .如果真 (等于 (取项目数 (), 0))
            赋值 (., 真)
            赋值 (., 真)
        .如果真结束
        .计次循环首 (取项目数 (), 循环变量1) ' 每次删除后，都重新连接行业文本，并写入配置文件。
            赋值 (行业文本, 相加 (行业文本, 相减 (循环变量1, 1).取项目文本 (), “,”))
        .计次循环尾 ()
        赋值 (行业文本, 取文本左边 (行业文本, 相减 (取文本长度 (行业文本), 1)))
        写配置项 (相加 (数据目录, “\set.ini”), “工种设置”, “工种”, 行业文本)
        复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
        记录摘要 (2)
    .如果真结束
    
.判断 (等于 (按钮操作, “返回”))
    .如果真 (等于 (取项目数 (), 0)) ' 工种不允许为空。
        信息框 (“请先设置工种。”, #信息图标, )
        返回 ()
    .如果真结束
     ' 卷帘式菜单1.现行选中菜单 ＝ 1
    禁止卷帘菜单 (假)
    禁止菜单 (假)
    赋值 (.现行子夹, 0)
    _选择夹1_子夹被改变 ()
    赋值 (当前操作, 0)
    赋值 (., “打 印(&P)”)
    赋值 (., #打印)
    读记录 ()
.默认
    
.判断结束


.子程序 集合_区域设置, 空白型, , 
.参数 按钮操作, 文本型, , 添加，修改，保存，取消，删除，返回

.局部变量 内容, 文本型, , , 
.局部变量 循环变量1, 整数型, , , 
.局部变量 二级区域, 文本型, , "0", 

.判断开始 (等于 (按钮操作, “添加”))
    连续赋值 (真, ., ., ., .)
    连续赋值 (假, ., ., .禁止, .禁止, .禁止)
    .如果 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, “假”), “真”))
        .如果真 (等于 (取项目数 (), 0)) ' 没添加一级区域前，不允许添加二级区域。
            赋值 (.现行选中项, 0)
            赋值 (.禁止, 真)
        .如果真结束
        .如果 (等于 (.现行选中项, 0))
            赋值 (.内容, 到文本 (相加 (取项目数 (), 1)))
        .否则
            赋值 (.内容, 到文本 (相加 (取项目数 (), 1)))
        .如果结束
        
    .否则
        赋值 (.禁止, 真)
        赋值 (.内容, 到文本 (相加 (取项目数 (), 1)))
    .如果结束
    获取焦点 ()
    赋值 (修改, 假)
.判断 (等于 (按钮操作, “修改”))
    连续赋值 (真, ., ., ., .)
    连续赋值 (假, ., ., .禁止, .禁止)
    赋值 (修改, 真)
.判断 (等于 (按钮操作, “保存”))
    .如果真 (等于 (.内容, “”))
        信息框 (相加 (“请输入完整的”, #左引号, .取项目文本 (.现行选中项), #右引号, “名称！”), #信息图标, )
        获取焦点 ()
        返回 ()
    .如果真结束
    .如果真 (等于 (.内容, “”))
        信息框 (“请输入编码!”, #信息图标, )
        获取焦点 ()
        返回 ()
    .如果真结束
    .如果 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, “假”), “真”))
        .如果 (等于 (.现行选中项, 0)) ' 修改一级区域
            .如果 (等于 (修改, 真))
                .如果 (判断项目是否存在 (.内容, .现行选中项))
                    信息框 (相加 (“重名区域”, #左引号, .内容, #右引号, “已经存在！”), #信息图标, )
                    获取焦点 ()
                    返回 ()
                .否则
                    赋值 (内容, 到文本 (读入文件 (相加 (数据目录, “\set.ini”))))
                    赋值 (内容, 子文本替换 (内容, 相加 (“[一级区域之”, .取项目文本 (.现行选中项), “]”), 相加 (“[一级区域之”, .内容, “]”), , , 真)) ' 通过替换，修改小节名称。
                    写到文件 (相加 (数据目录, “\set.ini”), 到字节集 (内容))
                    写配置项 (相加 (数据目录, “\set.ini”), “一级区域”, .取项目文本 (.现行选中项), ) ' 删除原有区域
                    写配置项 (相加 (数据目录, “\set.ini”), “一级区域”, .内容, .内容) ' 添加新区域
                    .置项目文本 (.现行选中项, .内容)
                .如果结束
                
            .否则
                .如果 (判断项目是否存在 (.内容))
                    信息框 (相加 (“重名区域”, #左引号, .内容, #右引号, “已经存在！”), #信息图标, )
                    获取焦点 ()
                    返回 ()
                .否则
                    写配置项 (相加 (数据目录, “\set.ini”), “一级区域”, .内容, .内容) ' 直接添加新区域
                    .加入项目 (.内容, )
                    赋值 (.现行选中项, 相减 (取项目数 (), 1))
                    _一级列表框_列表项被选择 ()
                .如果结束
                
            .如果结束
            赋值 (修改, 假)
            复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
            记录摘要 (2)
        .否则
             ' 修改二级区域
            .如果 (等于 (修改, 真))
                .如果 (判断项目是否存在 (.内容, .现行选中项))
                    信息框 (相加 (“重名区域”, #左引号, .内容, #右引号, “已经存在！”), #信息图标, )
                    获取焦点 ()
                    返回 ()
                .否则
                    写配置项 (相加 (数据目录, “\set.ini”), 相加 (“一级区域之”, .取项目文本 (.现行选中项)), .取项目文本 (.现行选中项), ) ' 删除原有区域
                    写配置项 (相加 (数据目录, “\set.ini”), 相加 (“一级区域之”, .取项目文本 (.现行选中项)), .内容, .内容) ' 添加新区域
                    .置项目文本 (.现行选中项, .内容)
                .如果结束
                
            .否则
                .如果 (判断项目是否存在 (.内容))
                    信息框 (相加 (“重名区域”, #左引号, .内容, #右引号, “已经存在！”), #信息图标, )
                    获取焦点 ()
                    返回 ()
                .否则
                    写配置项 (相加 (数据目录, “\set.ini”), 相加 (“一级区域之”, .取项目文本 (.现行选中项)), .内容, .内容) ' 直接添加新区域
                    .加入项目 (.内容, )
                    赋值 (.现行选中项, 相减 (取项目数 (), 1))
                .如果结束
                
            .如果结束
            赋值 (修改, 假)
            复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
            记录摘要 (2)
        .如果结束
        连续赋值 (假, ., ., ., .)
        连续赋值 (真, ., ., .禁止, .禁止, .禁止)
    .否则
        .如果 (等于 (修改, 真))
            写配置项 (相加 (数据目录, “\set.ini”), “一级区域”, .取项目文本 (.现行选中项), ) ' 删除原有区域
            写配置项 (相加 (数据目录, “\set.ini”), “一级区域”, .内容, .内容) ' 添加新区域
            .置项目文本 (.现行选中项, .内容)
        .否则
            写配置项 (相加 (数据目录, “\set.ini”), “一级区域”, .内容, .内容) ' 直接添加新区域
            .加入项目 (.内容, )
            赋值 (.现行选中项, 相减 (取项目数 (), 1))
            _一级列表框_列表项被选择 ()
        .如果结束
        复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
        记录摘要 (2)
        赋值 (修改, 假)
        连续赋值 (假, ., ., ., .)
        连续赋值 (真, ., ., .禁止, .禁止)
    .如果结束
    
.判断 (等于 (按钮操作, “取消”))
    .如果 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, “假”), “真”))
        .如果 (等于 (.现行选中项, 0)) ' 修改的是一级区域
            .如果 (大于 (取项目数 (), 0))
                连续赋值 (假, ., .)
                赋值 (.内容, .取项目文本 (.现行选中项))
                赋值 (.内容, 读配置项 (相加 (数据目录, “\set.ini”), “一级区域”, .内容, “”))
            .否则
                连续赋值 (真, ., .)
                赋值 (.内容, “”)
            .如果结束
            
        .否则
             ' 修改的是二级区域
            .如果 (大于 (取项目数 (), 0))
                连续赋值 (假, ., .)
                赋值 (.内容, .取项目文本 (.现行选中项))
                赋值 (.内容, 读配置项 (相加 (数据目录, “\set.ini”), 相加 (“一级区域之”, .取项目文本 (.现行选中项)), .内容, “”))
            .否则
                连续赋值 (真, ., .)
                赋值 (.内容, “”)
                赋值 (.内容, “”)
            .如果结束
            
        .如果结束
        连续赋值 (假, ., .)
        连续赋值 (真, ., ., .禁止, .禁止, .禁止)
    .否则
        .如果 (大于 (取项目数 (), 0))
            连续赋值 (假, ., .)
            赋值 (.内容, .取项目文本 (.现行选中项))
            赋值 (.内容, 读配置项 (相加 (数据目录, “\set.ini”), “一级区域”, .内容, “”))
        .否则
            连续赋值 (真, ., .)
            赋值 (.内容, “”)
        .如果结束
        连续赋值 (假, ., .)
        连续赋值 (真, ., ., .禁止, .禁止)
    .如果结束
    赋值 (修改, 假)
.判断 (等于 (按钮操作, “删除”))
    .如果 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, “假”), “真”))
        .如果 (等于 (.现行选中项, 0))
            .如果真 (等于 (信息框 (相加 (“删除”, #左引号, .内容, #右引号, “将同时删除该项下所有”, #左引号, .内容, #右引号, “，你确定要删除吗？”), 相加 (#询问图标, #是否钮, #默认按钮二), ), #是钮))
                写配置项 (相加 (数据目录, “\set.ini”), “一级区域”, .取项目文本 (.现行选中项), ) ' 删除配置小节
                写配置项 (相加 (数据目录, “\set.ini”), 相加 (“一级区域之”, .取项目文本 (.现行选中项)), , ) ' 删除配置小节
                .删除项目 (.现行选中项)
                赋值 (.现行选中项, 0)
                _一级列表框_列表项被选择 ()
                .如果真 (等于 (取项目数 (), 0))
                    赋值 (., 真)
                    赋值 (., 真)
                .如果真结束
                复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
                记录摘要 (2)
            .如果真结束
            
        .否则
            .如果真 (等于 (信息框 (相加 (“你确定要删除该”, #左引号, .内容, #右引号, “吗？”), 相加 (#询问图标, #是否钮, #默认按钮二), ), #是钮))
                写配置项 (“data\xzlib.dat”, 相加 (“一级区域之”, .取项目文本 (.现行选中项)), .取项目文本 (.现行选中项), ) ' 删除配置小节
                .删除项目 (.现行选中项)
                赋值 (.现行选中项, 0)
                _二级列表框_列表项被选择 ()
                .如果真 (等于 (取项目数 (), 0))
                    赋值 (., 真)
                    赋值 (., 真)
                .如果真结束
                复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
                记录摘要 (2)
            .如果真结束
            
        .如果结束
        
    .否则
        .如果真 (等于 (信息框 (相加 (“你确定要删除当前”, #左引号, .内容, #右引号, “吗？”), 相加 (#询问图标, #是否钮, #默认按钮二), ), #是钮))
            写配置项 (相加 (数据目录, “\set.ini”), “一级区域”, .取项目文本 (.现行选中项), ) ' 删除配置小节
            .删除项目 (.现行选中项)
            .如果 (等于 (取项目数 (), 0))
                赋值 (., 真)
                赋值 (., 真)
            .否则
                赋值 (.现行选中项, 0)
                _一级列表框_列表项被选择 ()
            .如果结束
            复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
            记录摘要 (2)
        .如果真结束
        
    .如果结束
    
.判断 (等于 (按钮操作, “返回”))
    .如果真 (等于 (取项目数 (), 0)) ' 如果选择了一级区域，则一级区域不允许为空。
        信息框 (相加 (“请先添加”, #左引号, .内容, #右引号, “。”), #信息图标, )
        返回 ()
    .如果真结束
    .如果真 (等于 (.禁止, 假))
        .计次循环首 (取项目数 (), 循环变量1) ' 如果选择了二级区域字段，则每个一级区域下必须设置二级区域
            清除数组 (二级区域)
            取配置项名 (相加 (数据目录, “\set.ini”), 相加 (“一级区域之”, 相减 (循环变量1, 1).取项目文本 ()), 二级区域)
            .如果真 (等于 (取数组成员数 (二级区域), 0))
                信息框 (相加 (“请先添加”, #左引号, 相减 (循环变量1, 1).取项目文本 (), #右引号, “的下辖”, #左引号, .内容, #右引号, “。”), #信息图标, )
                返回 ()
            .如果真结束
            
        .计次循环尾 ()
        写配置项 (相加 (数据目录, “\set.ini”), “杂项”, “一级区域名称”, .内容) ' 记录名称的修改。
        写配置项 (相加 (数据目录, “\set.ini”), “杂项”, “二级区域名称”, .内容)
        复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
        记录摘要 (2)
    .如果真结束
    .如果 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “初始化”, “初始化”, “0”), “1”)) ' 1:初始化未结束；0:初始化已结束。
        写配置项 (相加 (数据目录, “\set.ini”), “初始化”, “初始化进度”, “3”) ' 初始化需要对选择夹下列子夹进行重新设置：1，3，6，8。这里记录完成的子夹。
        复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
        记录摘要 (2)
        信息框 (“    将继续进行下一步初始化操作，期间如果按取消键退出设置，那么，所做的一切改变都将被忽略，系统将自动恢复你重设字段前的配置！”, #信息图标, “系统初始化”)
        赋值 (., “打 印(&P)”)
        _编号规则_被选择 ()
    .否则
         ' 卷帘式菜单1.现行选中菜单 ＝ 1
        赋值 (.现行子夹, 0)
        _选择夹1_子夹被改变 ()
        赋值 (当前操作, 0)
        赋值 (., “打 印(&P)”)
        赋值 (., #打印)
        读记录 ()
        禁止卷帘菜单 (假)
        禁止菜单 (假)
    .如果结束
    
.默认
    
.判断结束


.子程序 集合_单位名称, 空白型, , 
.参数 按钮操作, 文本型, , 确定，取消

.判断开始 (等于 (按钮操作, “确定”))
    写配置项 (相加 (数据目录, “\set.ini”), “杂项”, “单位名称”, .内容)
    赋值 (.标题, .内容)
    复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
    记录摘要 (2)
     ' 卷帘式菜单1.现行选中菜单 ＝ 1
    赋值 (.现行子夹, 0)
    _选择夹1_子夹被改变 ()
    赋值 (., “保 存(&S)”)
    连续赋值 (真, ., ., .可视)
    赋值 (., 假)
    赋值 (当前操作, 0) ' 0：无操作。
    读记录 ()
.判断 (等于 (按钮操作, “取消”))
     ' 卷帘式菜单1.现行选中菜单 ＝ 1
    赋值 (.现行子夹, 0)
    _选择夹1_子夹被改变 ()
    赋值 (., “保 存(&S)”)
    连续赋值 (真, ., ., .可视)
    赋值 (., 假)
    读记录 ()
    赋值 (当前操作, 0) ' 0：无操作。
.默认
    
.判断结束
禁止卷帘菜单 (假)
禁止菜单 (假)

.子程序 集合_备份目录, 空白型, , 
.参数 按钮操作, 文本型, , 确定，取消

.判断开始 (等于 (按钮操作, “确定”))
    .如果真 (等于 (.内容, “”))
        信息框 (“请设置数据备份目录！”, #信息图标, )
        返回 ()
    .如果真结束
    .如果真 (等于 (取文本右边 (.内容, 2), “:\”))
        信息框 (“为确保数据安全，请不要设置磁盘根目录为备份目录！”, #信息图标, )
        返回 ()
    .如果真结束
    写配置项 (相加 (数据目录, “\set.ini”), “杂项”, “备份目录”, .内容)
    复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
    记录摘要 (2)
     ' 卷帘式菜单1.现行选中菜单 ＝ 1
    赋值 (.现行子夹, 0)
    _选择夹1_子夹被改变 ()
    赋值 (., “保 存(&S)”)
    连续赋值 (真, ., ., .可视)
    赋值 (., 假)
    赋值 (当前操作, 0) ' 0：无操作。
    读记录 ()
.判断 (等于 (按钮操作, “取消”))
    .如果真 (等于 (.内容, “”))
        信息框 (相加 (“及时备份数据是保证你的数据安全的重要步骤！”, #换行符, “请及时设置数据备份目录并定时备份你的程序数据。”), #信息图标, )
    .如果真结束
     ' 卷帘式菜单1.现行选中菜单 ＝ 1
    赋值 (.现行子夹, 0)
    _选择夹1_子夹被改变 ()
    赋值 (., “保 存(&S)”)
    连续赋值 (真, ., ., .可视)
    读记录 ()
    赋值 (当前操作, 0) ' 0：无操作。
.默认
    
.判断结束
禁止卷帘菜单 (假)
禁止菜单 (假)

.子程序 集合_编号规则, 空白型, , 
.参数 按钮操作, 文本型, , 确定，取消

.局部变量 编码长度, 整数型, , , 
.局部变量 编码形式, 文本型, , , 

.判断开始 (等于 (按钮操作, “确定”))
    .如果真 (并且 (等于 (到数值 (.内容), 0), 等于 (.禁止, 假))) ' 如果设置了包含固定编码，则固定编码不允许为0或空。
        信息框 (“请输入地区固定编码。”, #信息图标, )
        获取焦点 ()
        返回 ()
    .如果真结束
    .如果真 (等于 (.禁止, 假))
        .如果真 (等于 (到数值 (.内容), 0)) ' 区域长度不允许为空或为0
            信息框 (“请输入一级区域代码长度。”, #信息图标, )
            获取焦点 ()
            返回 ()
        .如果真结束
        .如果真 (大于 (到数值 (.内容), 2)) ' 每个级别的区域长度不允许超过2。
            信息框 (“一级区域代码长度不能大于2。”, #信息图标, )
            获取焦点 ()
            返回 ()
        .如果真结束
        
    .如果真结束
    .如果真 (等于 (.禁止, 假))
        .如果真 (等于 (到数值 (.内容), 0)) ' 同上。
            信息框 (“请输入二级区域代码长度。”, #信息图标, )
            获取焦点 ()
            返回 ()
        .如果真结束
        .如果真 (大于 (到数值 (.内容), 2)) ' 同上。
            信息框 (“二级区域代码长度不能大于2。”, #信息图标, )
            获取焦点 ()
            返回 ()
        .如果真结束
        
    .如果真结束
    .如果真 (等于 (到数值 (.内容), 0)) ' 流水号长度不允许为空或为0
        信息框 (“请输入流水号长度。”, #信息图标, )
        获取焦点 ()
        返回 ()
    .如果真结束
    .如果真 (大于 (到数值 (.内容), 5)) ' 流水号长度不允许大于5。
        信息框 (“流水号长度不能大于5。”, #信息图标, )
        获取焦点 ()
        返回 ()
    .如果真结束
    写配置项 (相加 (数据目录, “\set.ini”), “杂项”, “单位名称”, .内容) ' 记录本子夹内容，下同。
    写配置项 (相加 (数据目录, “\set.ini”), “杂项”, “编号规则”, .取项目文本 (.现行选中项))
    .如果 (.禁止)
        写配置项 (相加 (数据目录, “\set.ini”), “杂项”, “固定编码”, “0”)
    .否则
        写配置项 (相加 (数据目录, “\set.ini”), “杂项”, “固定编码”, .内容)
    .如果结束
    .如果 (.禁止)
        写配置项 (相加 (数据目录, “\set.ini”), “杂项”, “一级区域长度”, “0”)
    .否则
        写配置项 (相加 (数据目录, “\set.ini”), “杂项”, “一级区域长度”, .内容)
    .如果结束
    .如果 (.禁止)
        写配置项 (相加 (数据目录, “\set.ini”), “杂项”, “二级区域长度”, “0”)
    .否则
        写配置项 (相加 (数据目录, “\set.ini”), “杂项”, “二级区域长度”, .内容)
    .如果结束
    .如果 (.禁止)
        写配置项 (相加 (数据目录, “\set.ini”), “杂项”, “流水号长度”, “0”)
    .否则
        写配置项 (相加 (数据目录, “\set.ini”), “杂项”, “流水号长度”, .内容)
    .如果结束
    .如果 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “初始化”, “初始化”, “0”), “0”)) ' 1:初始化未结束；0:初始化已结束。
        复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
        记录摘要 (2)
         ' 卷帘式菜单1.现行选中菜单 ＝ 1
        赋值 (.现行子夹, 0)
        _选择夹1_子夹被改变 ()
        赋值 (., “保 存(&S)”)
        连续赋值 (真, ., ., .可视)
        赋值 (., 假)
        赋值 (当前操作, 0) ' 0：无操作。
        赋值 (编码长度, 0)
        赋值 (编码形式, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “编号规则”, “”)) ' 根据编号规则，重新定义证号编辑框的最大允许长度。
        .如果真 (不等于 (寻找文本 (编码形式, “区域代码”, , 假), -1))
            赋值 (编码长度, 相加 (编码长度, 到数值 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “一级区域长度”, “1”)), 到数值 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “二级区域长度”, “1”))))
        .如果真结束
        .如果真 (不等于 (寻找文本 (编码形式, “年份”, , 假), -1))
            赋值 (编码长度, 相加 (编码长度, 4))
        .如果真结束
        .如果真 (不等于 (寻找文本 (编码形式, “从业人员流水号”, , 假), -1))
            赋值 (编码长度, 相加 (编码长度, 到数值 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “流水号长度”, “4”))))
        .如果真结束
        赋值 (.最大允许长度, 编码长度) ' 根据设定的编码方式，设置证号编辑框的最大允许长度。
        赋值 (.标题, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “固定编码”, “0”))
        赋值 (.宽度, .取宽度 (.标题))
        赋值 (.可视, 不等于 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “固定编码”, “0”), “0”))
        赋值 (.标题, 读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “固定编码”, “0”))
        赋值 (.宽度, .取宽度 (.标题))
        赋值 (.可视, 不等于 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “固定编码”, “0”), “0”))
        读记录 ()
        禁止卷帘菜单 (假)
        禁止菜单 (假)
    .否则
        写配置项 (相加 (数据目录, “\set.ini”), “初始化”, “初始化进度”, “6”) ' 初始化需要对选择夹下列子夹进行重新设置：1，3，6，8。这里记录完成的子夹。
        复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
        记录摘要 (2)
        赋值 (., “保 存(&S)”)
        连续赋值 (真, ., .)
        赋值 (., 假)
        信息框 (“    将继续进行下一步初始化操作，期间如果按取消键退出设置，那么，所做的一切改变都将被忽略，系统将自动恢复你重设字段前的配置！”, #信息图标, “系统初始化”)
        _卡片布局_被选择 ()
    .如果结束
    
.判断 (等于 (按钮操作, “取消”))
    .如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “初始化”, “初始化”, “0”), “1”)) ' 1:初始化未结束；0:初始化已结束。
        .如果 (等于 (信息框 (“你真的要放弃当前所做的一切改变，并恢复到重设字段前的系统配置吗？”, 相加 (#询问图标, #是否钮), ), #否钮))
            返回 ()
        .否则
            .如果真 (等于 (文件是否存在 (“data\jkzlib.dat”), 假))
                复制文件 (“autobak\jkzlib.dat”, “data\jkzlib.dat”) ' 用自动备份的数据库恢复。
                复制文件 (“autobak\jkzlib.edt”, “data\jkzlib.edt”)
                复制文件 (“autobak\jkzlib.enx”, “data\jkzlib.enx”)
                .如果真 (等于 (打开 (“data\jkzlib.dat”, “jkz”, , , , , “jkzlib.enx”), 假))
                    信息框 (相加 (“无法打开健康证明数据库”, “！”, 取错误信息 (), “。”, #换行符, “请用数据恢复功能恢复上次保存的数据库！”), #错误图标, “错误”)
                .如果真结束
                
            .如果真结束
            全部关闭 ()
            复制文件 (相加 (未知支持库函数_7 (10), “jkzmbak.sys”), 相加 (数据目录, “\set.ini”))
            调整卡片布局 ()
            填充初始数据 ()
            写配置项 (相加 (取运行目录 (), “\rich32.dll”), “run”, “mode”, “0”)
            检查数据库完整 ()
            复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
            记录摘要 (2)
            设置字段相关菜单 ()
        .如果结束
        
    .如果真结束
    禁止卷帘菜单 (假)
    禁止菜单 (假)
     ' 卷帘式菜单1.现行选中菜单 ＝ 1
    赋值 (.现行子夹, 0)
    _选择夹1_子夹被改变 ()
    赋值 (., “保 存(&S)”)
    连续赋值 (真, ., ., .可视)
    赋值 (., 假)
    读记录 ()
    赋值 (当前操作, 0) ' 0：无操作。
.默认
    
.判断结束


.子程序 集合_照片来源, 空白型, , 
.参数 按钮操作, 文本型, , 确定，取消

.判断开始 (等于 (按钮操作, “确定”))
    .判断开始 (.选中)
        写配置项 (相加 (数据目录, “\set.ini”), “杂项”, “照片来源”, “显示”)
    .判断 (.选中)
        写配置项 (相加 (数据目录, “\set.ini”), “杂项”, “照片来源”, “文件”)
    .判断 (.选中)
        写配置项 (相加 (数据目录, “\set.ini”), “杂项”, “照片来源”, “设备”)
    .默认
        
    .判断结束
    复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
    记录摘要 (2)
     ' 卷帘式菜单1.现行选中菜单 ＝ 1
    赋值 (.现行子夹, 0)
    _选择夹1_子夹被改变 ()
    赋值 (., “保 存(&S)”)
    连续赋值 (真, ., ., .可视)
    赋值 (., 假)
    赋值 (当前操作, 0) ' 0：无操作。
    读记录 ()
.判断 (等于 (按钮操作, “取消”))
     ' 卷帘式菜单1.现行选中菜单 ＝ 1
    赋值 (.现行子夹, 0)
    _选择夹1_子夹被改变 ()
    赋值 (., “保 存(&S)”)
    连续赋值 (真, ., ., .可视)
    赋值 (., 假)
    读记录 ()
    赋值 (当前操作, 0) ' 0：无操作。
.默认
    
.判断结束
禁止卷帘菜单 (假)
禁止菜单 (假)

.子程序 集合_卡片布局, 空白型, , 
.参数 按钮操作, 文本型, , 确定，取消

.判断开始 (等于 (按钮操作, “确定”))
    记录卡片布局 () ' 保存卡片布局。
    .如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “初始化”, “初始化”, “0”), “1”)) ' 初始化需要对选择夹下列子夹进行重新设置：1，3，6，8。这里记录完成的子夹。
        写配置项 (相加 (数据目录, “\set.ini”), “初始化”, “初始化”, “0”) ' 1:初始化未结束；0:初始化已结束。
        写配置项 (相加 (数据目录, “\set.ini”), “初始化”, “初始化进度”, “8”) ' 初始化需要对选择夹下列子夹进行重新设置：1，3，6，8。这里记录完成的子夹。
        复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
        记录摘要 (2)
        .如果真 (等于 (创建数据库 (), 假))
            信息框 (“创建数据库失败！请检查你的系统。程序将尝试恢复初始化设置前的数据！”, #信息图标, )
            复制文件 (“autobak\jkzlib.dat”, “data\jkzlib.dat”) ' 用自动备份的文件恢复数据。
            复制文件 (“autobak\jkzlib.edt”, “data\jkzlib.edt”)
            复制文件 (“autobak\jkzlib.enx”, “data\jkzlib.enx”)
        .如果真结束
        .如果 (等于 (打开 (“data\jkzlib.dat”, “jkz”, , , , , ), 假))
            信息框 (相加 (“无法打开健康证明数据库”, “！”, 取错误信息 (), “。”, #换行符, “请用数据恢复功能恢复上次保存的数据库！”), #错误图标, “错误”)
        .否则
            打开 (“autobak\jkzlib.dat”, “jkzbak”, , , , , ) ' 如果创建数据库成功。则从自动备份的数据库中获取原有的健康证明记录。所有匹配字段都将被复制，但不匹配字段的数据则被丢失。
            .如果 (大于 (取记录数 (), 0))
                置当前库 (“jkz”)
                .如果 (添加 (“jkzbak”, , ))
                    信息框 (“原有健康证明数据已成功复制到新数据库中，但其中不匹配字段数据则被删除！”, #信息图标, )
                    关闭 (“jkzbak”)
                    .如果 (等于 (新建索引 (“data\jkzlib.enx”, , , , “健康证号”), 假))
                        信息框 (“建立数据库索引失败，请重新启动程序！”, #信息图标, )
                        全部关闭 ()
                        复制文件 (“data\jkzlib.dat”, “autobak\jkzlib.dat”) ' 自动备份。
                        复制文件 (“data\jkzlib.edt”, “autobak\jkzlib.edt”)
                        删除文件 (“autobak\jkzlib.enx”) ' 删除自动备份中的索引文件，因为数据库字段已经变化，原有索引文件可能失效。
                    .否则
                        全部关闭 ()
                        复制文件 (“data\jkzlib.dat”, “autobak\jkzlib.dat”)
                        复制文件 (“data\jkzlib.edt”, “autobak\jkzlib.edt”)
                        复制文件 (“data\jkzlib.enx”, “autobak\jkzlib.enx”)
                    .如果结束
                    
                .否则
                    .如果真 (等于 (信息框 (“转换原有健康证明数据失败，需要恢复到原有配置以保留健康证明数据吗？”, 相加 (#询问图标, #是否钮, #默认按钮一), ), #是钮))
                        全部关闭 () ' 转换失败，也从自动备份的数据库恢复。
                        复制文件 (“autobak\jkzlib.dat”, “data\jkzlib.dat”)
                        复制文件 (“autobak\jkzlib.edt”, “data\jkzlib.edt”)
                        复制文件 (“autobak\jkzlib.enx”, “data\jkzlib.enx”)
                        删除文件 (相加 (数据目录, “\set.ini”)) ' 这里仅删除配置文件，而不恢复，是因为，在以下代码中，会调用检查配置文件（）子程序，如果未找到配置文件，会从系统目录中进行恢复，这里不重复操作。
                        信息框 (“请重新启动程序！”, #信息图标, )
                        结束 ()
                    .如果真结束
                    
                .如果结束
                全部关闭 ()
                检查配置文件 () ' 关闭初始设置窗口后，进行一系列检查，确保数据安全。
                复制打印设置组件 ()
                调整卡片布局 ()
                填充初始数据 ()
                写配置项 (相加 (取运行目录 (), “\rich32.dll”), “run”, “mode”, “0”)
                检查数据库完整 ()
                复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
                记录摘要 (2)
                .如果 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “一级区域”, “假”), “真”)) ' 调节区域设置菜单的可视属性。如果用户所选择的字段中不包括区域，则不显示此菜单。
                    赋值 (.可视, 真)
                    赋值 (., 3)
                    .如果真 (等于 (未知支持库函数_6 (), 3))
                        “区域设置”.未知支持库函数_2 (3, 3, 15, )
                    .如果真结束
                    
                .否则
                    赋值 (.可视, 假)
                    赋值 (., 3)
                    .如果真 (等于 (未知支持库函数_6 (), 4))
                        3.未知支持库函数_4 ()
                    .如果真结束
                    
                .如果结束
                .如果 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “照片”, “假”), “真”)) ' 如果用户所选择的字段中不包括照片字段，则不显示照片设置菜单。否则。。。。
                    赋值 (.可视, 真)
                    赋值 (., 4)
                    .如果真 (等于 (未知支持库函数_6 (), 4))
                        “区域设置”.未知支持库函数_2 (4, 4, 19, )
                    .如果真结束
                    
                .否则
                    赋值 (.可视, 假)
                    赋值 (., 4)
                    .如果真 (等于 (未知支持库函数_6 (), 5))
                        5.未知支持库函数_4 ()
                    .如果真结束
                    
                .如果结束
                
            .否则
                置当前库 (“jkz”)
                关闭 (“jkzbak”)
            .如果结束
            
        .如果结束
        
    .如果真结束
    复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
    记录摘要 (2)
    调整卡片布局 ()
    填充初始数据 ()
    赋值 (., 4) ' 卷帘式菜单1.现行选中菜单 ＝ 1  '如果要恢复菜单=1,请删除菜单=4语句。
    赋值 (.现行子夹, 0)
    _选择夹1_子夹被改变 ()
    赋值 (., “保 存(&S)”)
    连续赋值 (真, ., ., .可视)
    赋值 (., 假)
    刷新显示 ()
    重画 ()
    赋值 (当前操作, 0) ' 0：无操作。
    读记录 ()
.判断 (等于 (按钮操作, “取消”))
    .如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “初始化”, “初始化”, “0”), “1”)) ' 1:初始化未结束；0:初始化已结束。
        .如果 (等于 (信息框 (“你真的要放弃当前所做的一切改变，并恢复到重设字段前的系统配置吗？”, 相加 (#询问图标, #是否钮), ), #否钮))
            返回 ()
        .否则
            .如果真 (等于 (文件是否存在 (“data\jkzlib.dat”), 假))
                复制文件 (“autobak\jkzlib.dat”, “data\jkzlib.dat”) ' 用自动备份的数据库恢复。
                复制文件 (“autobak\jkzlib.edt”, “data\jkzlib.edt”)
                复制文件 (“autobak\jkzlib.enx”, “data\jkzlib.enx”)
                .如果真 (等于 (打开 (“data\jkzlib.dat”, “jkz”, , , , , “jkzlib.enx”), 假))
                    信息框 (相加 (“无法打开健康证明数据库”, “！”, 取错误信息 (), “。”, #换行符, “请用数据恢复功能恢复上次保存的数据库！”), #错误图标, “错误”)
                .如果真结束
                
            .如果真结束
            全部关闭 ()
            复制文件 (相加 (未知支持库函数_7 (10), “jkzmbak.sys”), 相加 (数据目录, “\set.ini”))
            调整卡片布局 ()
            填充初始数据 ()
            写配置项 (相加 (取运行目录 (), “\rich32.dll”), “run”, “mode”, “0”)
            检查数据库完整 ()
            复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
            记录摘要 (2)
            设置字段相关菜单 ()
        .如果结束
        
    .如果真结束
     ' 卷帘式菜单1.现行选中菜单 ＝ 1
    赋值 (.现行子夹, 0)
    _选择夹1_子夹被改变 ()
    赋值 (., “保 存(&S)”)
    连续赋值 (真, ., ., .可视, .)
    赋值 (., 假)
    读记录 ()
    赋值 (当前操作, 0) ' 0：无操作。
.默认
    
.判断结束
禁止卷帘菜单 (假)
禁止菜单 (假)

.子程序 集合_证件设置, 空白型, , 
.参数 按钮操作, 文本型, , 确定，取消

.判断开始 (等于 (按钮操作, “确定”))
    写配置项 (相加 (数据目录, “\set.ini”), “打印”, “卡片”, 相加 (.内容, “,”, .内容, “,”, .内容)) ' 记录设置内容
    复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
    记录摘要 (2)
     ' 卷帘式菜单1.现行选中菜单 ＝ 1
    赋值 (.现行子夹, 0)
    _选择夹1_子夹被改变 ()
    赋值 (., “保 存(&S)”)
    连续赋值 (真, ., ., .可视)
    赋值 (., 假)
    赋值 (当前操作, 0) ' 0：无操作。
    读记录 ()
.判断 (等于 (按钮操作, “取消”))
     ' 卷帘式菜单1.现行选中菜单 ＝ 1
    赋值 (.现行子夹, 0)
    _选择夹1_子夹被改变 ()
    赋值 (., “保 存(&S)”)
    连续赋值 (真, ., ., .可视)
    赋值 (., 假)
    读记录 ()
    赋值 (当前操作, 0) ' 0：无操作。
.默认
    
.判断结束
禁止卷帘菜单 (假)
禁止菜单 (假)

.子程序 集合_查找记录, 空白型, , 
.参数 按钮操作, 文本型, , 开始查找，取消

.判断开始 (等于 (按钮操作, “开始查找”))
    .如果真 (等于 (.选中, 真))
        到首记录 ()
    .如果真结束
    .如果 (.选中)
        .如果 (等于 (.选中, 真))
            赋值 (模糊查找, 真) ' 全局变量,以便再次查找时调用.
            .如果 (查找 (发音比较 (.内容, 读 (“姓名”), 真, )))
                 ' 卷帘式菜单1.现行选中菜单 ＝ 1
                赋值 (.现行子夹, 0)
                赋值 (., “保 存(&S)”)
                .如果 (是否在查找中)
                    连续赋值 (假, ., ., ., ., .)
                    连续赋值 (真, .可视, ., ., ., .可视)
                    赋值 (当前操作, 13)
                .否则
                    连续赋值 (真, ., ., .可视, .可视)
                    赋值 (., 假)
                    赋值 (当前操作, 0) ' 0：无操作。
                .如果结束
                读记录 ()
                赋值 (., #保存)
                _选择夹1_子夹被改变 ()
                .如果 (等于 (是否在查找中, 假))
                    禁止卷帘菜单 (假)
                    禁止菜单 (假)
                .否则
                    连续赋值 (假, .禁止, .禁止, .禁止, .禁止, .禁止)
                    1.未知支持库函数_26 (3, 假)
                    1.未知支持库函数_26 (5, 假)
                    2.未知支持库函数_26 (0, 假)
                    2.未知支持库函数_26 (1, 假)
                    
                .如果结束
                
            .否则
                信息框 (“未找到指定从业人员记录！”, #信息图标, “未找到”)
            .如果结束
            
        .否则
            赋值 (模糊查找, 假)
            .如果 (查找 (等于 (.内容, 读 (“姓名”))))
                 ' 卷帘式菜单1.现行选中菜单 ＝ 1
                赋值 (.现行子夹, 0)
                赋值 (., “保 存(&S)”)
                .如果 (是否在查找中)
                    连续赋值 (假, ., ., ., ., .)
                    连续赋值 (真, .可视, ., ., ., .可视)
                    赋值 (当前操作, 13)
                .否则
                    连续赋值 (真, ., ., .可视, .可视)
                    赋值 (., 假)
                    赋值 (当前操作, 0) ' 0：无操作。
                .如果结束
                读记录 ()
                赋值 (., #保存)
                _选择夹1_子夹被改变 ()
                .如果 (等于 (是否在查找中, 假))
                    禁止卷帘菜单 (假)
                    禁止菜单 (假)
                .否则
                    连续赋值 (假, .禁止, .禁止, .禁止, .禁止, .禁止)
                    1.未知支持库函数_26 (3, 假)
                    1.未知支持库函数_26 (5, 假)
                    2.未知支持库函数_26 (0, 假)
                    2.未知支持库函数_26 (1, 假)
                .如果结束
                
            .否则
                信息框 (“未找到指定从业人员记录！”, #信息图标, “未找到”)
            .如果结束
            
        .如果结束
        
    .否则
        .如果 (查找 (等于 (.内容, 读 (“健康证号”))))
            赋值 (., “查找下一个”)
             ' 卷帘式菜单1.现行选中菜单 ＝ 1
            赋值 (.现行子夹, 0)
            赋值 (., “保 存(&S)”)
            .如果 (是否在查找中)
                连续赋值 (假, ., ., ., ., .)
                连续赋值 (真, .可视, ., ., ., .可视)
                赋值 (当前操作, 13)
            .否则
                连续赋值 (真, ., ., .可视, .可视)
                赋值 (., 假)
                赋值 (当前操作, 0) ' 0：无操作。
            .如果结束
            读记录 ()
            赋值 (., #保存)
            _选择夹1_子夹被改变 ()
            .如果 (等于 (是否在查找中, 假))
                禁止卷帘菜单 (假)
                禁止菜单 (假)
            .否则
                连续赋值 (假, .禁止, .禁止, .禁止, .禁止, .禁止)
                1.未知支持库函数_26 (3, 假)
                1.未知支持库函数_26 (5, 假)
                2.未知支持库函数_26 (0, 假)
                2.未知支持库函数_26 (1, 假)
            .如果结束
            
        .否则
            信息框 (“未找到指定从业人员记录！”, #信息图标, “未找到”)
        .如果结束
        
    .如果结束
    
.判断 (等于 (按钮操作, “取消”))
     ' 卷帘式菜单1.现行选中菜单 ＝ 1
    赋值 (.现行子夹, 0)
    赋值 (., “保 存(&S)”)
    .如果 (是否在查找中)
        连续赋值 (假, ., ., ., ., ., .可视)
        连续赋值 (真, .可视, ., ., .)
        赋值 (当前操作, 13)
    .否则
        连续赋值 (真, ., ., .可视)
        连续赋值 (假, ., .可视)
        赋值 (当前操作, 0) ' 0：无操作。
    .如果结束
    读记录 ()
    赋值 (., #保存)
    _选择夹1_子夹被改变 ()
    .如果 (等于 (是否在查找中, 假))
        禁止卷帘菜单 (假)
        禁止菜单 (假)
    .否则
        连续赋值 (假, .禁止, .禁止, .禁止, .禁止, .禁止)
        1.未知支持库函数_26 (3, 假)
        1.未知支持库函数_26 (5, 假)
        2.未知支持库函数_26 (0, 假)
        2.未知支持库函数_26 (1, 假)
    .如果结束
    
.默认
    
.判断结束


.子程序 集合_打印设置, 空白型, , 
.参数 按钮操作, 文本型, , 确定，取消

.局部变量 循环变量1, 整数型, , , 

.判断开始 (等于 (按钮操作, “确定”))
    写配置项 (相加 (数据目录, “\set.ini”), “打印”, “套打”, 到文本 (.选中))
    写配置项 (相加 (数据目录, “\set.ini”), “打印”, “套打”, 到文本 (.选中))
    写配置项 (相加 (数据目录, “\set.ini”), “打印”, “日期间隔”, .内容)
    写配置项 (相加 (数据目录, “\set.ini”), “打印”, “照片宽度”, .内容)
    .计次循环首 (取数组成员数 (项目), 循环变量1)
        写配置项 (相加 (数据目录, “\set.ini”), “打印”, 项目 [循环变量1], 相加 (横向编辑框 [循环变量1], 内容, “,”, 纵向编辑框 [循环变量1], 内容, “,”, 选择 (项目选择框 [循环变量1], 选中, “0”, “-1”))) ' 选中为0，未选中为-1
    .计次循环尾 ()
    复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
    记录摘要 (2)
     ' 卷帘式菜单1.现行选中菜单 ＝ 1
    赋值 (.现行子夹, 0)
    _选择夹1_子夹被改变 ()
    赋值 (., “保 存(&S)”)
    连续赋值 (真, ., ., .可视)
    赋值 (., 假)
    赋值 (当前操作, 0) ' 0：无操作。
    读记录 ()
    重画 ()
.默认
     ' 卷帘式菜单1.现行选中菜单 ＝ 1
    赋值 (.现行子夹, 0)
    _选择夹1_子夹被改变 ()
    赋值 (., “保 存(&S)”)
    连续赋值 (真, ., ., .可视)
    赋值 (., 假)
    读记录 ()
    赋值 (当前操作, 0) ' 0：无操作。
.判断结束
禁止卷帘菜单 (假)
禁止菜单 (假)

.子程序 设置字段相关菜单, 空白型, , 
.如果 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “一级区域”, “假”), “真”)) ' 调节区域设置菜单的可视属性。如果用户所选择的字段中不包括区域，则不显示此菜单。
    赋值 (.可视, 真)
    赋值 (., 3)
    .如果真 (等于 (未知支持库函数_6 (), 3))
        “区域设置”.未知支持库函数_2 (3, 3, 15, )
    .如果真结束
    
.否则
    赋值 (.可视, 假)
    赋值 (., 3)
    .如果真 (等于 (未知支持库函数_6 (), 4))
        3.未知支持库函数_4 ()
    .如果真结束
    
.如果结束
.如果 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “照片”, “假”), “真”)) ' 如果用户所选择的字段中不包括照片字段，则不显示照片设置菜单。否则。。。。
    赋值 (.可视, 真)
    赋值 (., 4)
    .如果真 (等于 (未知支持库函数_6 (), 4))
        “区域设置”.未知支持库函数_2 (4, 4, 19, )
    .如果真结束
    
.否则
    赋值 (.可视, 假)
    赋值 (., 4)
    .如果真 (等于 (未知支持库函数_6 (), 5))
        5.未知支持库函数_4 ()
    .如果真结束
    
.如果结束


.子程序 禁止卷帘菜单, 空白型, , 
.参数 是否禁止, 逻辑型, , 

0.未知支持库函数_26 (0, 是否禁止)
0.未知支持库函数_26 (1, 是否禁止)
0.未知支持库函数_26 (2, 是否禁止)
0.未知支持库函数_26 (3, 是否禁止)
0.未知支持库函数_26 (4, 是否禁止)
1.未知支持库函数_26 (0, 是否禁止)
1.未知支持库函数_26 (1, 是否禁止)
1.未知支持库函数_26 (2, 是否禁止)
1.未知支持库函数_26 (3, 是否禁止)
1.未知支持库函数_26 (4, 是否禁止)
1.未知支持库函数_26 (5, 是否禁止)
2.未知支持库函数_26 (0, 是否禁止)
2.未知支持库函数_26 (1, 是否禁止)
3.未知支持库函数_26 (0, 是否禁止)
3.未知支持库函数_26 (1, 是否禁止)
3.未知支持库函数_26 (2, 是否禁止)
3.未知支持库函数_26 (3, 是否禁止)
4.未知支持库函数_26 (0, 是否禁止)
4.未知支持库函数_26 (1, 是否禁止)
4.未知支持库函数_26 (2, 是否禁止)
4.未知支持库函数_26 (3, 是否禁止)
4.未知支持库函数_26 (4, 是否禁止)
5.未知支持库函数_26 (0, 是否禁止)

.子程序 禁止菜单, 空白型, , 
.参数 是否禁止, 逻辑型, , 

 ' 连续赋值 (是否禁止, 初始化.禁止, 数据备份.禁止, 数据恢复.禁止, 数据年结.禁止, 查看往年数据.禁止, 添加新记录.禁止, 修改记录.禁止, 删除记录.禁止, 查找记录.禁止, 用编辑器查看.禁止, 数据统计.禁止, 打印预览.禁止, 打印当前健康证.禁止, 批量打印健康证.禁止, 单位名称.禁止, 工种设置.禁止, 区域设置.禁止, 备份目录.禁止, 编号规则.禁止, 照片来源.禁止, 卡片布局.禁止, 证件设置.禁止, 打印设置.禁止, 重新登录.禁止)
连续赋值 (是否禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
.如果真 (等于 (是否禁止, 假))
    .如果 (不等于 (“超级管理员”))
        赋值 (.禁止, 真)
        3.未知支持库函数_24 (真)
        4.未知支持库函数_24 (真)
    .否则
        赋值 (.禁止, 假)
        3.未知支持库函数_24 (假)
        4.未知支持库函数_24 (假)
    .如果结束
    
.如果真结束


.子程序 _横向编辑框1_获得焦点, 空白型, , 
.局部变量 事件组件, 编辑框, , , 

赋值 (事件组件, 取事件组件 ())
赋值 (事件组件.被选择字符数, -1)


.子程序 _纵向编辑框1_获得焦点, 空白型, , 
.局部变量 事件组件, 编辑框, , , 

赋值 (事件组件, 取事件组件 ())
赋值 (事件组件.被选择字符数, -1)


.子程序 _间隔编辑框_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)


.子程序 _查找编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _保存按钮_被单击 ()
.如果真结束


.程序集 多媒体操作程序集, , , 

.子程序 播放媒体, 空白型, , 
.参数 媒体文件名, 文本型, , 

.局部变量 媒体短文件名, 文本型, , , 

.如果真 (等于 (媒体文件名, “”))
    返回 ()
.如果真结束
赋值 (媒体短文件名, 取空白文本 (255)) ' 媒体指令不支持长文件名，需要先转换一下。下同
取短文件名 (媒体文件名, 媒体短文件名, 255)
发送媒体指令 (相加 (“open ”, 媒体短文件名), “”, 0, 0)
发送媒体指令 (相加 (“play ”, 媒体短文件名), “”, 0, 0)

.子程序 停止媒体播放, 空白型, , 
.参数 媒体文件名, 文本型, , 

.局部变量 媒体短文件名, 文本型, , , 

.如果真 (等于 (媒体文件名, “”))
    返回 ()
.如果真结束
赋值 (媒体短文件名, 取空白文本 (255))
取短文件名 (媒体文件名, 媒体短文件名, 255)
发送媒体指令 (相加 (“stop ”, 媒体短文件名), “”, 0, 0)
发送媒体指令 (相加 (“close ”, 媒体短文件名), “”, 0, 0)
赋值 (媒体短文件名, “”)

.子程序 取媒体状态, 文本型, , 
.参数 媒体文件名, 文本型, , 

.局部变量 状态, 文本型, , , 
.局部变量 媒体短文件名, 文本型, , , 

.如果真 (等于 (媒体文件名, “”))
    返回 (“”)
.如果真结束
赋值 (媒体短文件名, 取空白文本 (255))
取短文件名 (媒体文件名, 媒体短文件名, 255)
赋值 (状态, 取空白文本 (255))
发送媒体指令 (相加 (“status ”, 媒体短文件名, “ mode”), 状态, 255, 0)
返回 (状态)

.子程序 关闭媒体, 空白型, , 
.参数 媒体文件名, 文本型, , 

.局部变量 媒体短文件名, 文本型, , , 

赋值 (媒体短文件名, 取空白文本 (255))
取短文件名 (媒体文件名, 媒体短文件名, 255)
发送媒体指令 (相加 (“close ”, 媒体短文件名), “”, 0, 0)

.程序集 公用程序集, , , 

.子程序 取配置项名, 逻辑型, , 取出指定配置文件某小节下的所有项目名称。
.参数 配置文件名, 文本型, , 欲取其项目的配置文件名，如果省略路径，默认为操作系统安装目录下的配置文件。
.参数 小节名称, 文本型, , 欲取其项目的小节名称。
.参数 配置项目名称, 文本型, 数组, 返回取出的所有项目名称

.局部变量 操作系统目录, 文本型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 读取内容, 文本型, , , 

赋值 (操作系统目录, 未知支持库函数_7 (9))
.如果真 (等于 (寻找文本 (配置文件名, “\”, , 假), -1)) ' 配置文件名不带路径，则默认为系统安装目录下。
    赋值 (配置文件名, 相加 (操作系统目录, 配置文件名))
.如果真结束
赋值 (文件号, 打开文件 (配置文件名, #读入, ))
.如果真 (等于 (文件号, 0))
    返回 (假)
.如果真结束
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假))
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (等于 (到大写 (读取内容), 到大写 (相加 (“[”, 小节名称, “]”)))) ' 读取到小节名所在行
        跳出循环 ()
    .如果真结束
    
.判断循环尾 ()
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假))
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (并且 (等于 (取文本左边 (删首尾空 (读取内容), 1), “[”), 等于 (取文本右边 (删首尾空 (读取内容), 1), “]”))) ' 如果读取到下一小节，则跳出
        跳出循环 ()
    .如果真结束
    .如果真 (不等于 (寻找文本 (读取内容, “=”, , 假), -1))
        加入成员 (配置项目名称, 删首尾空 (取文本左边 (读取内容, 相减 (寻找文本 (读取内容, “=”, , 假), 1)))) ' 加入=左边的内容，即项目名称
    .如果真结束
    
.判断循环尾 ()
关闭文件 (文件号)
返回 (真)

.子程序 打开多选对话框, 文本型, , 如果多选文件，返回文件路径以“?”(半角问号)分隔。失败或取消返回空文本。
.参数 窗口句柄, 整数型, 可空, 调用处窗口句柄
.参数 窗口标题, 文本型, 可空, 对话框窗口标题
.参数 过滤器, 文本型, 可空, 格式：“MP3文件(*.mp3)|*.mp3|媒体文件(*.mpg)|*.mpg”
.参数 初始路径, 文本型, 可空, 可以被省略。如果本参数被省略，默认从“我的文档”开始。

.局部变量 文件列表, 文件对话框, , , 
.局部变量 文件名, 字节集, , , 
.局部变量 文件名数组, 文本型, , "0", 
.局部变量 循环次数, 整数型, , , 记录循环的次数
.局部变量 多选文件, 文本型, , , 
.局部变量 文件缓冲数, 整数型, , , 决定可以打开文件的个数，原为8192，可打开80个文件
.局部变量 窗口风格3, 整数型, , , 将524800－524863改成为0－20风格参数，方便用户选择

赋值 (文件缓冲数, 98192) ' 大小决定打开文件的数量，此可以打开200个文件
赋值 (文件列表.lStructSize, 76)
赋值 (文件列表.hwndOwner, 窗口句柄)
赋值 (文件列表.lpstrFilter, 相加 (子字节集替换 (到字节集 (过滤器), { 124 }, { 0 }, , ), { 0 }, { 0 }))
赋值 (文件列表.lpstrFile, 取空白字节集 (文件缓冲数)) ' 文件名缓冲区，决定能选择文件的多少，如果平均一个文件名100个字符，一次也可以选80多个文件了
赋值 (文件列表.nMaxFile, 文件缓冲数)
赋值 (文件列表.lpstrFileTitle, 取空白文本 (文件缓冲数))
赋值 (文件列表.nMaxFileTitle, 文件缓冲数)
赋值 (文件列表.lpstrInitialDir, 初始路径)
赋值 (文件列表.lpstrTitle, 窗口标题)
赋值 (文件列表.flags, 524804) ' 有工具栏的多选文件对话框
.如果 (不等于 (打开对话框 (文件列表), 0)) ' 打开文件成功
    赋值 (文件名, 文件列表.lpstrFile)
    赋值 (文件名, 取字节集左边 (文件名, 相减 (寻找字节集 (文件名, { 0, 0 }), 1)))
    .如果 (不等于 (寻找字节集 (文件名, { 0 }), -1)) ' 是否选择多个文件
        赋值 (文件名数组, 分割文本 (到文本 (子字节集替换 (文件名, { 0 }, { 124 }, , )), “|”, ))
        .如果真 (不等于 (取文本右边 (文件名数组 [1], 1), “\”)) ' 选择多个文件时，第一个数组为路径名，后面为不包括路径的文件名
            赋值 (文件名数组 [1], 相加 (文件名数组 [1], “\”))
        .如果真结束
        .计次循环首 (相减 (取数组成员数 (文件名数组), 1), 循环次数)
            .如果 (不等于 (相减 (取数组成员数 (文件名数组), 1), 循环次数)) ' 最后一个文件名不用加分隔字符“?”
                赋值 (多选文件, 相加 (多选文件, 文件名数组 [1], 文件名数组 [相加 (循环次数, 1)], “?”))
            .否则
                赋值 (多选文件, 相加 (多选文件, 文件名数组 [1], 文件名数组 [相加 (循环次数, 1)]))
            .如果结束
            
        .计次循环尾 ()
        返回 (多选文件) ' 返回多个文件名全路径用“;”分隔
    .否则
        返回 (到文本 (文件名)) ' 返回单个文件名全路径
    .如果结束
    
.否则
    返回 (“”) ' 取消返回空文本
.如果结束


.子程序 创建多级目录, 逻辑型, , 创建成功返回真，失败返回假。
.参数 目录名, 文本型, , 

.局部变量 创建目录, 文本型, , , 
.局部变量 找到位置, 短整数型, , , 

.如果真 (等于 (寻找文件 (目录名, #子目录), “”))
    赋值 (找到位置, 寻找文本 (目录名, “\”, , 真)) ' 如果目录中包含“\”，那就可能是一个多级目录，否则，直接创建目录（）就可以了。
    .如果真 (不等于 (找到位置, -1))
        .如果真 (等于 (取文本中间 (删首尾空 (目录名), 2, 1), “:”))
            赋值 (找到位置, 寻找文本 (目录名, “\”, 相加 (找到位置, 1), 真)) ' 剔除盘符后，如果还有“\"，就进入循环，逐级目录创建。
        .如果真结束
        .判断循环首 (不等于 (找到位置, -1))
            赋值 (创建目录, 取文本左边 (目录名, 相减 (找到位置, 1)))
            .如果真 (等于 (寻找文件 (创建目录, #子目录), “”))
                .如果真 (等于 (创建目录 (创建目录), 假))
                    返回 (假)
                .如果真结束
                
            .如果真结束
            赋值 (找到位置, 寻找文本 (目录名, “\”, 相加 (找到位置, 1), 真))
        .判断循环尾 ()
    .如果真结束
    .如果真 (等于 (创建目录 (目录名), 假))
        返回 (假)
    .如果真结束
    
.如果真结束
返回 (真)

.程序集 加密配置文件操作程序集, , , 

.子程序 读加密配置项, 文本型, , 读取失败，返回空文本
.参数 配置文件名, 文本型, , 省略路径,默认为保存在windows系统目录下
.参数 文件密码, 文本型, 可空, 
.参数 配置节名, 文本型, , 
.参数 配置项名, 文本型, , 
.参数 默认文本, 文本型, 可空, 

.局部变量 读取内容, 文本型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 取出内容, 文本型, , "0", 

.如果真 (是否为空 (文件密码))
    赋值 (文件密码, “”)
.如果真结束
.如果真 (是否为空 (默认文本))
    赋值 (默认文本, “”)
.如果真结束
.如果真 (等于 (寻找文本 (配置文件名, “\”, , 假), -1))
    赋值 (配置文件名, 相加 (未知支持库函数_7 (9), “\”, 配置文件名))
.如果真结束
赋值 (配置文件名, 子文本替换 (配置文件名, “\\”, “\”, , , 真))
赋值 (文件号, 打开加密文件 (配置文件名, #读入, , 文件密码, )) ' 用读文本行的方式来操作配置文件。配置文件小节一般用[]括起来。配置文件项目均以：项目= 项目值 的形式保存。读取小节，然后读取小节后面几行文本，以“=”分隔，即可取得项目名称及项目值。下同。
.如果真 (等于 (文件号, 0)) ' 打开失败
    返回 (默认文本)
.如果真结束
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假))
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (等于 (到大写 (读取内容), 到大写 (相加 (“[”, 配置节名, “]”)))) ' 判断是否小节名
        跳出循环 ()
    .如果真结束
    
.判断循环尾 ()
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假)) ' 循环读取，直到所读文本行中，包含指定项目名称。
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (并且 (等于 (取文本左边 (删首尾空 (读取内容), 1), “[”), 等于 (取文本右边 (删首尾空 (读取内容), 1), “]”))) ' 如果读到下一个小节，则跳出循环。
        跳出循环 ()
    .如果真结束
    .如果真 (不等于 (寻找文本 (读取内容, “=”, , 假), -1))
        赋值 (取出内容, 分割文本 (读取内容, “=”, )) ' 分割项目名称与项目值。
        .如果真 (大于或等于 (取数组成员数 (取出内容), 2))
            .如果真 (等于 (删首尾空 (取出内容 [1]), 配置项名))
                关闭文件 (文件号)
                .如果真 (等于 (删首尾空 (取文本右边 (读取内容, 相减 (取文本长度 (读取内容), 寻找文本 (读取内容, “=”, , 假)))), “”))
                    返回 (默认文本)
                .如果真结束
                返回 (取文本右边 (读取内容, 相减 (取文本长度 (读取内容), 寻找文本 (读取内容, “=”, , 假))))
            .如果真结束
            
        .如果真结束
        
    .如果真结束
    
.判断循环尾 ()
关闭文件 (文件号)
返回 (默认文本)

.子程序 写加密配置项, 逻辑型, , 
.参数 配置文件名, 文本型, , 省略路径,默认为保存在windows系统目录下
.参数 文件密码, 文本型, 可空, 
.参数 配置节名, 文本型, , 
.参数 配置项名, 文本型, , 
.参数 欲写入值, 文本型, , 不允许写入空值。

.局部变量 读取内容, 文本型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 取出内容, 文本型, , "0", 
.局部变量 上次位置, 整数型, , , 
.局部变量 节存在, 逻辑型, , , 
.局部变量 项存在, 逻辑型, , , 

.如果真 (是否为空 (文件密码))
    赋值 (文件密码, “”)
.如果真结束
.如果真 (或者 (等于 (删首尾空 (配置文件名), “”), 等于 (删首尾空 (配置节名), “”), 等于 (删首尾空 (配置项名), “”), 等于 (删首尾空 (欲写入值), “”)))
    返回 (假)
.如果真结束
.如果真 (等于 (寻找文本 (配置文件名, “\”, , 假), -1))
    赋值 (配置文件名, 相加 (未知支持库函数_7 (9), “\”, 配置文件名))
.如果真结束
赋值 (配置文件名, 子文本替换 (配置文件名, “\\”, “\”, , , 真))
赋值 (文件号, 打开加密文件 (配置文件名, #改读, , 文件密码, ))
.如果真 (等于 (文件号, 0))
    返回 (假)
.如果真结束
赋值 (节存在, 假)
赋值 (项存在, 假)
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假)) ' 循环读取文本行，判断是否存在指定小节。
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (等于 (到大写 (读取内容), 到大写 (相加 (“[”, 配置节名, “]”))))
        赋值 (节存在, 真)
        跳出循环 ()
    .如果真结束
    
.判断循环尾 ()
.如果 (节存在)
    赋值 (上次位置, 取读写位置 (文件号))
    .判断循环首 (等于 (是否在文件尾 (文件号, 真), 假))
        赋值 (上次位置, 取读写位置 (文件号))
        赋值 (读取内容, 读入一行 (文件号))
        .如果真 (并且 (等于 (取文本左边 (删首尾空 (读取内容), 1), “[”), 等于 (取文本右边 (删首尾空 (读取内容), 1), “]”)))
            跳出循环 ()
        .如果真结束
        .如果真 (不等于 (寻找文本 (读取内容, “=”, , 假), -1)) ' 循环读取文本行，判断是否已经存在指定项目。如果存在，则修改。
            赋值 (取出内容, 分割文本 (读取内容, “=”, ))
            .如果真 (大于或等于 (取数组成员数 (取出内容), 2))
                .如果真 (等于 (删首尾空 (取出内容 [1]), 配置项名))
                    赋值 (项存在, 真)
                    移动读写位置 (文件号, , 上次位置)
                    删除数据 (文件号, 相加 (取文本长度 (读取内容), 2))
                    移动读写位置 (文件号, , 上次位置)
                    插入文本行 (文件号, 相加 (取出内容 [1], “=”, 欲写入值))
                    关闭文件 (文件号)
                    返回 (真)
                .如果真结束
                
            .如果真结束
            
        .如果真结束
        
    .判断循环尾 ()
    .如果真 (等于 (项存在, 假)) ' 如果项目不存在，则插入文本行。
        移动读写位置 (文件号, , 上次位置)
        插入文本行 (文件号, 相加 (配置项名, “=”, 欲写入值))
        关闭文件 (文件号)
        返回 (真)
    .如果真结束
    
.否则
    移到文件尾 (文件号) ' 如果小节不存在，则在文件最后插入小节。在小节下一行，插入项目。
    插入文本行 (文件号, 相加 (“[”, 配置节名, “]”))
    插入文本行 (文件号, 相加 (配置项名, “=”, 欲写入值))
    关闭文件 (文件号)
    返回 (真)
.如果结束
关闭文件 (文件号)
返回 (假)

.子程序 取加密配置节名, 逻辑型, , 
.参数 配置文件名, 文本型, , 省略路径,默认为保存在windows系统目录下
.参数 文件密码, 文本型, 可空, 
.参数 配置节名称数组, 文本型, 数组, 保存取出的配置文件节名称数组

.局部变量 文件号, 整数型, , , 
.局部变量 读取内容, 文本型, , , 

.如果真 (是否为空 (文件密码))
    赋值 (文件密码, “”)
.如果真结束
.如果真 (等于 (寻找文本 (配置文件名, “\”, , 假), -1))
    赋值 (配置文件名, 相加 (未知支持库函数_7 (9), “\”, 配置文件名))
.如果真结束
赋值 (配置文件名, 子文本替换 (配置文件名, “\\”, “\”, , , 真))
赋值 (文件号, 打开加密文件 (配置文件名, #读入, , 文件密码, ))
.如果真 (等于 (文件号, 0))
    返回 (假)
.如果真结束
清除数组 (配置节名称数组)
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假)) ' 循环读取文本行，取出所有小节，加入到数组。
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (并且 (等于 (取文本左边 (删首尾空 (读取内容), 1), “[”), 等于 (取文本右边 (删首尾空 (读取内容), 1), “]”)))
        赋值 (读取内容, 子文本替换 (读取内容, “[”, “”, , , 真))
        赋值 (读取内容, 子文本替换 (读取内容, “]”, “”, , , 真))
        加入成员 (配置节名称数组, 删首尾空 (读取内容))
    .如果真结束
    
.判断循环尾 ()
关闭文件 (文件号)
返回 (真)

.子程序 取加密配置项名, 逻辑型, , 
.参数 配置文件名, 文本型, , 省略路径,默认为保存在windows系统目录下
.参数 文件密码, 文本型, 可空, 
.参数 配置节名, 文本型, , 欲取出项目数组的小节名称
.参数 配置项名称数组, 文本型, 数组, 保存取出的配置项名称数组

.局部变量 文件号, 整数型, , , 
.局部变量 读取内容, 文本型, , , 

.如果真 (是否为空 (文件密码))
    赋值 (文件密码, “”)
.如果真结束
.如果真 (等于 (寻找文本 (配置文件名, “\”, , 假), -1))
    赋值 (配置文件名, 相加 (未知支持库函数_7 (9), “\”, 配置文件名))
.如果真结束
赋值 (配置文件名, 子文本替换 (配置文件名, “\\”, “\”, , , 真))
赋值 (文件号, 打开加密文件 (配置文件名, #读入, , 文件密码, ))
.如果真 (等于 (文件号, 0))
    返回 (假)
.如果真结束
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假)) ' 循环读取文本行，定位到指定小节。
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (等于 (到大写 (读取内容), 到大写 (相加 (“[”, 配置节名, “]”))))
        跳出循环 ()
    .如果真结束
    
.判断循环尾 ()
清除数组 (配置项名称数组)
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假)) ' 循环读取文本行，取出所有项目，保存至数组。读取到下一小节时，跳出循环。
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (并且 (等于 (取文本左边 (删首尾空 (读取内容), 1), “[”), 等于 (取文本右边 (删首尾空 (读取内容), 1), “]”)))
        跳出循环 ()
    .如果真结束
    .如果真 (不等于 (寻找文本 (读取内容, “=”, , 假), -1))
        加入成员 (配置项名称数组, 删首尾空 (取文本左边 (读取内容, 相减 (寻找文本 (读取内容, “=”, , 假), 1))))
    .如果真结束
    
.判断循环尾 ()
关闭文件 (文件号)
返回 (真)

.子程序 删除加密配置小节, 逻辑型, , 
.参数 配置文件名, 文本型, , 
.参数 文件密码, 文本型, 可空, 
.参数 配置节名, 文本型, , 

.局部变量 读取内容, 文本型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 上次位置, 整数型, , , 
.局部变量 节存在, 逻辑型, , , 

.如果真 (是否为空 (文件密码))
    赋值 (文件密码, “”)
.如果真结束
.如果真 (等于 (寻找文本 (配置文件名, “\”, , 假), -1))
    赋值 (配置文件名, 相加 (未知支持库函数_7 (9), “\”, 配置文件名))
.如果真结束
赋值 (配置文件名, 子文本替换 (配置文件名, “\\”, “\”, , , 真))
赋值 (文件号, 打开加密文件 (配置文件名, #改读, , 文件密码, ))
.如果真 (等于 (文件号, 0))
    返回 (假)
.如果真结束
赋值 (节存在, 假)
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假)) ' 循环读取文本行，判断是否存在指定小节，如果存在，则删除小节所在一行文本。
    赋值 (上次位置, 取读写位置 (文件号))
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (等于 (到大写 (读取内容), 到大写 (相加 (“[”, 配置节名, “]”))))
        赋值 (节存在, 真)
        移动读写位置 (文件号, , 上次位置)
        删除数据 (文件号, 相加 (取文本长度 (读取内容), 2))
        移动读写位置 (文件号, , 上次位置)
        跳出循环 ()
    .如果真结束
    
.判断循环尾 ()
.如果真 (等于 (节存在, 假)) ' 如果不存在指定小节，则删除失败。
    关闭文件 (文件号)
    返回 (节存在)
.如果真结束
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假)) ' 删除指定小节（已经在上述代码中被删除）下的所有文本行，直到读取到下一小节。
    赋值 (上次位置, 取读写位置 (文件号))
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (并且 (等于 (取文本左边 (删首尾空 (读取内容), 1), “[”), 等于 (取文本右边 (删首尾空 (读取内容), 1), “]”)))
        跳出循环 ()
    .如果真结束
    移动读写位置 (文件号, , 上次位置)
    删除数据 (文件号, 相加 (取文本长度 (读取内容), 2))
    移动读写位置 (文件号, , 上次位置)
.判断循环尾 ()
关闭文件 (文件号)
返回 (真)

.程序集 用户配置文件管理程序集, , , 

.子程序 配置文件_写用户信息, 空白型, , 
.参数 用户数组, 文本型, 数组, 
.参数 口令数组, 文本型, 数组, 

.局部变量 循环变量1, 整数型, , , 

.计次循环首 (取数组成员数 (用户数组), 循环变量1)
    写加密配置项 (配置文件, #密匙, 用户数组 [循环变量1], “口令”, 口令数组 [循环变量1]) ' 每个用户信息保存为一个小节。
.计次循环尾 ()

.子程序 配置文件_删除用户, 逻辑型, , 
.参数 用户名, 文本型, , 

返回 (删除加密配置小节 (配置文件, #密匙, 用户名))

.子程序 配置文件_取用户, 整数型, , 返回用户数
.局部变量 循环变量1, 整数型, , , 

清除数组 (用户)
取加密配置节名 (配置文件, #密匙, 用户)
.如果真 (大于 (取数组成员数 (用户), 0))
    .计次循环首 (取数组成员数 (用户), 循环变量1)
        .如果真 (等于 (用户 [循环变量1], “分类信息”)) ' 由于每个用户信息保存为一个小节，分类信息也保存为一个小节，所以在取出用户时，要剔除小节“分类信息”。
            删除成员 (用户, 循环变量1, 1)
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
.如果真结束
返回 (取数组成员数 (用户))

.子程序 配置文件_取口令, 文本型, , 
.参数 用户名, 文本型, , 

返回 (读加密配置项 (配置文件, #密匙, 用户名, “口令”, “”))

.子程序 配置文件_修改口令, 逻辑型, , 
.参数 用户名, 文本型, , 
.参数 口令文本, 文本型, , 

返回 (写加密配置项 (配置文件, #密匙, 用户名, “口令”, 口令文本))

.子程序 配置文件_取是否保存密码, 逻辑型, , 
.参数 用户名, 文本型, , 

返回 (等于 (读加密配置项 (配置文件, #密匙, 用户名, “保存口令”, “假”), “真”))

.子程序 配置文件_写是否保存密码, 逻辑型, , 
.参数 用户名, 文本型, , 
.参数 是否保存密码, 逻辑型, , 

返回 (写加密配置项 (配置文件, #密匙, 用户名, “保存口令”, 到文本 (是否保存密码)))

.子程序 配置文件_添加用户, 空白型, , 
.参数 用户名, 文本型, , 
.参数 口令文本, 文本型, , 

写加密配置项 (配置文件, #密匙, 用户名, “口令”, 口令文本)

.窗口程序集 登录窗口程序集, , , 

.程序集变量 错误次数, 字节型, , , 
.程序集变量 保存的口令, 文本型, , , 
.子程序 _登录窗口_创建完毕, 空白型, , 
.局部变量 循环变量1, 整数型, , , 
.局部变量 路径, 文本型, , , 
.局部变量 摘要, 文本型, , , 

赋值 (配置文件, 相加 (取运行目录 (), “\sysdat.ini”))
.如果 (等于 (文件是否存在 (配置文件), 假))
    .如果真 (文件是否存在 (相加 (未知支持库函数_7 (10), “jkzm.usr”)))
        复制文件 (相加 (未知支持库函数_7 (10), “jkzm.usr”), 配置文件)
        赋值 (摘要, 读加密配置项 (相加 (未知支持库函数_7 (10), “jkzm.dat”), #密匙, “md5”, “user”, “”))
        .如果真 (等于 (取文本长度 (摘要), 32))
            .如果真 (不等于 (未知支持库函数_2 (读入文件 (配置文件)), 摘要)) ' 文件被非法修改。
                信息框 (相加 (“系统文件”, #左引号, “sysdat.ini”, #右引号, “被非法修改！请检查《健康证明发放证明管理系统》运行及用户配置信息有无异常！”), #信息图标, )
            .如果真结束
            
        .如果真结束
        
    .如果真结束
    
.否则
    赋值 (摘要, 读加密配置项 (相加 (未知支持库函数_7 (10), “jkzm.dat”), #密匙, “md5”, “user”, “”))
    .如果真 (等于 (取文本长度 (摘要), 32))
        .如果真 (不等于 (未知支持库函数_2 (读入文件 (配置文件)), 摘要)) ' 文件被非法修改。
            .如果 (文件是否存在 (相加 (未知支持库函数_7 (10), “jkzm.usr”)))
                复制文件 (相加 (未知支持库函数_7 (10), “jkzm.usr”), 配置文件)
                .如果真 (不等于 (未知支持库函数_2 (读入文件 (配置文件)), 摘要)) ' 文件被非法修改。
                    信息框 (相加 (“系统文件”, #左引号, “sysdat.ini”, #右引号, “被非法修改！请检查《健康证明发放证明管理系统》运行有无异常！”), #信息图标, )
                .如果真结束
                
            .否则
                信息框 (相加 (“系统文件”, #左引号, “sysdat.ini”, #右引号, “被非法修改！请检查《健康证明发放证明管理系统》运行有无异常！”), #信息图标, )
            .如果结束
            
        .如果真结束
        
    .如果真结束
    
.如果结束
.如果真 (等于 (配置文件_取用户 (), 0)) ' 如果取用户失败，说明是第一次运行，用户信息还未保存至文件，就写出默认用户信息。
     ' 将用户各种信息分割，并保存为文本数组。以写入配置文件。
    加入成员 (用户, “超级管理员”)
    加入成员 (口令, “cf79ae6addba60ad018347359bd144d2”)
    配置文件_写用户信息 (用户, 口令)
    复制文件 (配置文件, 相加 (未知支持库函数_7 (10), “jkzm.usr”))
    赋值 (摘要, 未知支持库函数_2 (读入文件 (配置文件)))
    .计次循环首 (5, ) ' 判断是否成功取出了数据摘要。
        .如果 (不等于 (取文本长度 (摘要), 32))
            延时 (300)
            赋值 (摘要, 未知支持库函数_2 (读入文件 (配置文件)))
        .否则
            跳出循环 ()
        .如果结束
        
    .计次循环尾 ()
    .如果真 (等于 (取文本长度 (摘要), 32)) ' 如果成功取出，则记录。
        写加密配置项 (相加 (未知支持库函数_7 (10), “jkzm.dat”), #密匙, “md5”, “user”, 摘要)
    .如果真结束
    
.如果真结束
.计次循环首 (取数组成员数 (用户), 循环变量1) ' 将所有用户加入用户组合框。
    用户.加入项目 ( [循环变量1], )
.计次循环尾 ()
.如果 (等于 (取项目数 (), 1))
    赋值 (.现行选中项, 0)
.否则
    赋值 (.现行选中项, 1) ' 不让超级管理员成为默认显示的用户。
.如果结束
_用户组合框_列表项被选择 ()
获取焦点 ()
赋值 (错误次数, 0)
赋值 (登录窗口., 真)

.子程序 _登录按钮_被单击, 空白型, , 
.局部变量 当前密码, 文本型, , , 
.局部变量 输入密码, 文本型, , , 

赋值 (当前密码, 配置文件_取口令 (.取项目文本 (.现行选中项)))
.如果 (并且 (等于 (.内容, 取重复文本 (18, “*”)), 不等于 (保存的口令, “”)))
    赋值 (输入密码, 保存的口令)
.否则
    赋值 (输入密码, 未知支持库函数_2 (到字节集 (.内容)))
.如果结束
.如果 (等于 (输入密码, 当前密码))
    赋值 (当前用户, .取项目文本 (.现行选中项))
    .如果真 (不等于 (当前用户, “超级管理员”)) ' 管理员不允许保存密码
        记录保存密码信息 () ' 记录是否保存密码的设置。
        复制文件 (相加 (取运行目录 (), “\sysdat.ini”), 相加 (未知支持库函数_7 (10), “jkzm.usr”))
        记录摘要 (1)
    .如果真结束
    销毁 ()
.否则
    赋值 (错误次数, 相加 (错误次数, 1)) ' 累计口令输入错误次数，达3次，则认为是非法登录，程序强行退出。
    .如果 (小于 (错误次数, 3))
        信息框 (“用户口令不正确，请重新输入！”, #信息图标, “错误”)
        返回 ()
        获取焦点 ()
    .否则
        信息框 (“用户口令不正确，请勿非法登录！”, #警告图标, “错误”)
        销毁 ()
        .如果真 (等于 (当前用户, “”))
            结束 ()
        .如果真结束
        
    .如果结束
    
.如果结束


.子程序 记录保存密码信息, 空白型, , 
配置文件_写是否保存密码 (当前用户, .选中)

.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()
.如果真 (等于 (当前用户, “”)) ' 如果不是重登录，则结束程序。否则，返回主窗口。
    结束 ()
.如果真结束


.子程序 _登录按钮_获得焦点, 空白型, , 
赋值 (.类型, 1)
赋值 (.类型, 0)

.子程序 _取消按钮_获得焦点, 空白型, , 
赋值 (.类型, 0)
赋值 (.类型, 1)

.子程序 _用户组合框_获得焦点, 空白型, , 
赋值 (.类型, 1)
赋值 (.类型, 0)

.子程序 _口令编辑框_获得焦点, 空白型, , 
赋值 (.类型, 1)
赋值 (.类型, 0)
赋值 (.被选择字符数, -1)

.子程序 _登录窗口_可否被关闭, 逻辑型, , 
.如果真 (等于 (当前用户, “”))
    结束 ()
.如果真结束
返回 (真)

.子程序 _用户组合框_列表项被选择, 空白型, , 
赋值 (.内容, “”)
.如果 (等于 (.取项目文本 (.现行选中项), “超级管理员”))
    赋值 (.选中, 假)
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
    取出保存密码信息 ()
.如果结束


.子程序 取出保存密码信息, 空白型, , 
赋值 (.选中, 配置文件_取是否保存密码 (.取项目文本 (.现行选中项))) ' 如果设置为记住密码，则选中，且口令编辑框中自动填入密码。否则，不选。
.如果 (.选中)
    赋值 (保存的口令, 配置文件_取口令 (.取项目文本 (.现行选中项)))
    赋值 (.内容, 取重复文本 (18, “*”))
.否则
    赋值 (.内容, “”)
.如果结束


.窗口程序集 删除用户程序集, , , 

.子程序 _删除用户窗口_创建完毕, 空白型, , 
.局部变量 循环变量1, 整数型, , , 

.如果 (大于 (取数组成员数 (用户), 1)) ' 保留第一个用户（一般为默认用户）不允许被删除，其余用户均加入到组合框中，供用户选择删除。
    .计次循环首 (取数组成员数 (用户), 循环变量1)
        .如果真 (大于 (循环变量1, 1))
            用户.加入项目 ( [循环变量1], )
        .如果真结束
        
    .计次循环尾 ()
    赋值 (.现行选中项, 0)
    获取焦点 ()
.否则
    信息框 (“没有可以删除的用户！”, #信息图标, “错误”)
    销毁 ()
.如果结束



.子程序 _删除按钮_获得焦点, 空白型, , 
赋值 (.类型, 1)
赋值 (.类型, 0)

.子程序 _取消按钮_获得焦点, 空白型, , 
赋值 (.类型, 0)
赋值 (.类型, 1)

.子程序 _用户组合框_获得焦点, 空白型, , 
赋值 (.类型, 0)
赋值 (.类型, 1)

.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()

.子程序 _删除按钮_被单击, 空白型, , 
.局部变量 删除用户, 文本型, , , 

赋值 (删除用户, .取项目文本 (.现行选中项))
.如果真 (等于 (信息框 (相加 (“真的要删除用户”, 删除用户, “吗？”), 相加 (#询问图标, #确认取消钮), “删除用户”), #确认钮))
    删除成员 (用户, 相加 (.现行选中项, 2), )
    配置文件_删除用户 (删除用户)
    .删除项目 (.现行选中项)
    赋值 (.现行选中项, 0)
.如果真结束
.如果真 (等于 (删除用户, 当前用户))
    信息框 (“当前登录用户被删除，程序将被关闭。请重新运行本程序并以其他用户身份登录。”, #信息图标, )
    结束 ()
.如果真结束
.如果真 (等于 (取项目数 (), 0))
    销毁 ()
.如果真结束


.窗口程序集 添加用户程序集, , , 

.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()

.子程序 _确定按钮_被单击, 空白型, , 
.局部变量 循环变量1, 整数型, , , 

.如果真 (等于 (删首尾空 (.内容), “”))
    信息框 (“用户名不能为空，请输入用户名！”, #信息图标, “错误”)
    获取焦点 ()
    赋值 (.被选择字符数, -1)
    返回 ()
.如果真结束
.计次循环首 (取数组成员数 (用户), 循环变量1) ' 判断是否已经存在该用户名
    .如果真 (等于 (用户 [循环变量1], 删首尾空 (.内容)))
        信息框 (相加 (“用户名”, #左引号, .内容, #右引号, “已经存在，请勿重复添加！”), #信息图标, “错误”)
        返回 ()
    .如果真结束
    
.计次循环尾 ()
.如果 (等于 (.内容, .内容))
    .如果真 (等于 (.内容, “”))
        信息框 (“用户口令不能为空，请重新输入用户口令！”, #信息图标, “错误”)
        获取焦点 ()
        赋值 (.被选择字符数, -1)
        返回 ()
    .如果真结束
    加入成员 (用户, 删首尾空 (.内容))
    配置文件_添加用户 (删首尾空 (.内容), 未知支持库函数_2 (到字节集 (.内容)))
    连续赋值 (“”, .内容, .内容, .内容)
    信息框 (“添加用户成功，你可以继续添加新的用户！”, #信息图标, )
    获取焦点 ()
.否则
    信息框 (“密码复核错误，请重新设置密码！”, #错误图标, )
    获取焦点 ()
    返回 ()
.如果结束


.子程序 _添加用户窗口_创建完毕, 空白型, , 
赋值 (添加用户窗口., 真)

.子程序 _确定按钮_获得焦点, 空白型, , 
赋值 (.类型, 1)
赋值 (.类型, 0)

.子程序 _取消按钮_获得焦点, 空白型, , 
赋值 (.类型, 0)
赋值 (.类型, 1)

.子程序 _用户编辑框_获得焦点, 空白型, , 
赋值 (.类型, 1)
赋值 (.类型, 0)
赋值 (.被选择字符数, -1)

.子程序 _口令编辑框_获得焦点, 空白型, , 
赋值 (.类型, 1)
赋值 (.类型, 0)
赋值 (.被选择字符数, -1)

.子程序 _复核口令编辑框_获得焦点, 空白型, , 
赋值 (.类型, 1)
赋值 (.类型, 0)
赋值 (.被选择字符数, -1)

.窗口程序集 修改口令程序集, , , 

.程序集变量 原来口令, 文本型, , , 
.子程序 _修改口令窗口_创建完毕, 空白型, , 
赋值 (.内容, 当前用户)
连续赋值 (真, .禁止, .禁止)
赋值 (原来口令, 配置文件_取口令 (当前用户))
赋值 (修改口令窗口., 真)

.子程序 _原口令编辑框_内容被改变, 空白型, , 
.如果 (等于 (未知支持库函数_2 (到字节集 (.内容)), 原来口令))
    连续赋值 (假, .禁止, .禁止)
.否则
    连续赋值 (真, .禁止, .禁止)
.如果结束


.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()

.子程序 _确定按钮_被单击, 空白型, , 
.如果真 (不等于 (未知支持库函数_2 (到字节集 (.内容)), 原来口令))
    信息框 (“原始口令错误，请重新输入。如果你不知道原始口令，你将无权修改。”, #信息图标, “警告”)
    获取焦点 ()
    赋值 (.被选择字符数, -1)
    返回 ()
.如果真结束
.如果 (等于 (.内容, .内容))
    .如果真 (等于 (.内容, “”))
        信息框 (“用户口令不能为空，请重新输入用户新口令！”, #信息图标, “错误”)
        获取焦点 ()
        赋值 (.被选择字符数, -1)
        返回 ()
    .如果真结束
    配置文件_修改口令 (当前用户, 未知支持库函数_2 (到字节集 (.内容)))
    销毁 ()
.否则
    信息框 (“新密码复核错误，请重新设置密码！”, #错误图标, )
    获取焦点 ()
    返回 ()
.如果结束


.子程序 _原口令编辑框_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)
赋值 (.类型, 1)
赋值 (.类型, 0)

.子程序 _新口令编辑框_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)
赋值 (.类型, 1)
赋值 (.类型, 0)

.子程序 _复核口令编辑框_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)
赋值 (.类型, 1)
赋值 (.类型, 0)

.子程序 _确定按钮_获得焦点, 空白型, , 
赋值 (.类型, 1)
赋值 (.类型, 0)

.子程序 _取消按钮_获得焦点, 空白型, , 
赋值 (.类型, 0)
赋值 (.类型, 1)

.窗口程序集 背景音乐窗口程序集, , , 

.子程序 _添加按钮_被单击, 空白型, , 
.局部变量 文件名, 文本型, , "0", 
.局部变量 多选文件名, 文本型, , , 
.局部变量 文件数, 整数型, , , 

赋值 (多选文件名, 打开多选对话框 (背景音乐窗口.取窗口句柄 (), “选择音乐文件：”, “音乐文件(*.mp3;*.wma;*.mid;*.wav)|*.mp3;*.wma;*.mid;*.wav|MP3文件(*.mp3)|*.mp3|WMA文件(*.wma)|*.wma|MID文件(*.mid)|*.mid|WAV文件(*.wav)|*.wav”, ))
.如果真 (不等于 (多选文件名, “”))
    赋值 (文件名, 分割文本 (多选文件名, “?”, ))
    .计次循环首 (取数组成员数 (文件名), 文件数)
        -1.插入表项 (文件名 [文件数], , , , )
    .计次循环尾 ()
.如果真结束


.子程序 _删除按钮_被单击, 空白型, , 
.局部变量 选择文件, 整数型, , "0", 
.局部变量 索引, 整数型, , , 

清除数组 (选择文件)
赋值 (选择文件, 取被选择表项 ())
.如果真 (等于 (取数组成员数 (选择文件), 0))
    信息框 (“请选择要删除的音乐文件（可多选）！”, #信息图标, )
    返回 ()
.如果真结束
.变量循环首 (取数组成员数 (选择文件), 1, -1, 索引)
    选择文件.删除表项 ( [索引])
.变量循环尾 ()

.子程序 _确定按钮_被单击, 空白型, , 
.局部变量 循环循环变量1, 整数型, , , 
.局部变量 音乐文件, 文本型, , , 

写配置项 (相加 (数据目录, “\set.ini”), “背景音乐”, “播放”, 到文本 (.选中))
写配置项 (相加 (数据目录, “\set.ini”), “背景音乐”, “播放方式”, 选择 (.选中, “顺序”, “随机”))
.计次循环首 (相减 (取表项数 (), 1), 循环循环变量1)
    .如果 (等于 (文件是否存在 (相减 (循环循环变量1, 1).取标题 (0)), 假))
        信息框 (相加 (“音乐文件”, #左引号, 相减 (循环循环变量1, 1).取标题 (0), #右引号, “不存在，将自动删除！”), #信息图标, )
    .否则
        赋值 (音乐文件, 相加 (音乐文件, 相减 (循环循环变量1, 1).取标题 (0), “?”)) ' 把所有文件以“?”连接，因为文件名中不允许有“?”存在，所以可以避免文件名对数组分割的干扰。
    .如果结束
    
.计次循环尾 ()
赋值 (音乐文件, 取文本左边 (音乐文件, 相减 (取文本长度 (音乐文件), 1))) ' 删除最后一个“?”
写到文件 (相加 (取运行目录 (), “\music.dat”), 到字节集 (音乐文件)) ' 因为考虑到配置文件的长度有限制，所以将音乐文件名单独写到一个文件保存，而没有放到配置文件中。
复制文件 (相加 (数据目录, “\set.ini”), 相加 (未知支持库函数_7 (10), “jkzm.sys”))
记录摘要 (2)
销毁 ()

.子程序 _背景音乐窗口_创建完毕, 空白型, , 
.局部变量 背景音乐文件, 文本型, , , 
.局部变量 背景音乐数组, 文本型, , "0", 
.局部变量 循环循环变量1, 整数型, , , 

赋值 (背景音乐窗口., 相减 (相加 (背景音乐窗口., 272), 背景音乐窗口.取用户区高度 ()))
赋值 (背景音乐文件, 到文本 (读入文件 (相加 (取运行目录 (), “\music.dat”)))) ' 读取已经添加的音乐文件
赋值 (背景音乐数组, 分割文本 (背景音乐文件, “?”, ))
.计次循环首 (取数组成员数 (背景音乐数组), 循环循环变量1)
    -1.插入表项 (背景音乐数组 [循环循环变量1], , , , )
.计次循环尾 ()
赋值 (.选中, 等于 (读配置项 (相加 (数据目录, “\set.ini”), “背景音乐”, “播放”, “假”), “真”)) ' 读取现有设置
.如果 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “背景音乐”, “播放方式”, “顺序”), “顺序”))
    赋值 (.选中, 真)
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 假)
    赋值 (.选中, 真)
.如果结束


.窗口程序集 关于窗口程序集, , , 

.子程序 _确定按钮_被单击, 空白型, , 
销毁 ()

.子程序 _关于窗口_创建完毕, 空白型, , 
赋值 (关于窗口., 相减 (相加 (关于窗口., 248), 关于窗口.取用户区高度 ()))
赋值 (关于窗口., 真) ' 加上这一句,可以避免窗口显示时的延滞感.

.窗口程序集 照片窗口程序集, , , 

.程序集变量 左上角横, 整数型, , , 
.程序集变量 左上角纵, 整数型, , , 
.程序集变量 右下角横, 整数型, , , 
.程序集变量 右下角纵, 整数型, , , 
.程序集变量 点击, 逻辑型, , , 
.程序集变量 已选取, 逻辑型, , , 
.子程序 _照片窗口_创建完毕, 空白型, , 
.局部变量 来源数, 整数型, , , 
.局部变量 循环次数, 整数型, , , 

.判断开始 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “照片来源”, “显示”), “文件”))
    赋值 (.可视, 真)
    赋值 (.可视, 假)
    赋值 (.禁止, 假)
    赋值 (.标题, “选择文件”)
    赋值 (.标题, “请选择从业人员照片文件：”)
.判断 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “照片来源”, “显示”), “设备”))
    连续赋值 (假, .可视, .禁止)
    赋值 (.可视, 真)
    赋值 (.标题, “选择数码设备：”)
    赋值 (.标题, “获取图像”)
    清空 ()
    未知支持库函数_3 ()
    赋值 (来源数, .)
    .如果 (大于 (来源数, 0)) ' 初始化数码设备列表
        .计次循环首 (来源数, 循环次数)
            赋值 (., 相减 (循环次数, 1))
            .加入项目 (., 相减 (循环次数, 1))
        .计次循环尾 ()
        赋值 (.现行选中项, 0)
        赋值 (., 0)
        赋值 (.禁止, 假)
    .否则
        赋值 (.禁止, 真)
    .如果结束
    
.默认
    
.判断结束


.子程序 _设备组合框_列表项被选择, 空白型, , 
赋值 (., .取项目数值 (.现行选中项))
赋值 (.禁止, 假)

.子程序 _截取按钮_被单击, 空白型, , 
.局部变量 图片宽度, 整数型, , , 
.局部变量 图片高度, 整数型, , , 
.局部变量 图片号, 整数型, , , 

.判断开始 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “照片来源”, “显示”), “文件”))
    .如果真 (打开 ())
        赋值 (.内容, .文件名)
        赋值 (已选取, 假)
        赋值 (图片号, 载入图片 (.文件名))
        赋值 (图片宽度, 图片号.取图片宽度 ())
        赋值 (图片高度, 图片号.取图片高度 ())
        卸载图片 (图片号)
        赋值 (.宽度, 取整 (相乘 (相除 (.高度, 图片高度), 图片宽度)))
        赋值 (.宽度, .宽度) ' 因为画板不支持图片缩放，而图片框又不好实现画框，所以需要用图片框过渡一下，然后快照到画板上。以便下一步截取。
        赋值 (.可视, 假)
        赋值 (.图片, 读入文件 (.文件名))
        刷新显示 ()
        赋值 (.底图, 快照 (取窗口句柄 (), , ))
        延时 (400)
        赋值 (.可视, 真)
        #顶层.调整层次 ()
        赋值 (.禁止, 假)
        赋值 (.鼠标指针, 到字节集 (2))
    .如果真结束
    
.判断 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “照片来源”, “显示”), “设备”))
    真.未知支持库函数_1 ()
.默认
    
.判断结束


.子程序 _数码设备1_图片传送完毕, 空白型, , 
.参数 图片, 字节集, , 
.参数 图片宽度, 整数型, , 
.参数 图片高度, 整数型, , 

赋值 (已选取, 假)
赋值 (.宽度, 取整 (相乘 (相除 (.高度, 图片高度), 图片宽度)))
赋值 (.宽度, .宽度) ' 因为画板不支持图片缩放，而图片框又不好实现画框，所以需要用图片框过渡一下，然后快照到画板上。以便下一步截取。
赋值 (.可视, 假)
赋值 (.图片, 图片)
刷新显示 ()
赋值 (.底图, 快照 (取窗口句柄 (), , ))
延时 (400)
赋值 (.可视, 真)
#顶层.调整层次 ()
赋值 (.禁止, 假)
赋值 (.鼠标指针, 到字节集 (2))

.子程序 _画板1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (点击, 真)
俘获鼠标 (取窗口句柄 ())
赋值 (已选取, 假)
.清除 ()
赋值 (左上角横, 横向位置)
赋值 (左上角纵, 纵向位置)
连续赋值 (0, 右下角横, 右下角纵)

.子程序 _画板1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (横向位置, 相加 (左上角横, 取整 (相乘 (相除 (相减 (纵向位置, 左上角纵), 5), 4)))) ' 自动调整比例为4：5，并画框
.如果真 (等于 (点击, 真))
    .清除 ()
    左上角横.画矩形 (左上角纵, 横向位置, 纵向位置)
.如果真结束


.子程序 _保存按钮_被单击, 空白型, , 
.如果真 (等于 (已选取, 假))
    信息框 (“请先在图像上点击鼠标左键并拖动，截取需要保存为照片的图像区域，然后再保存照片。”, #信息图标, )
    返回 ()
.如果真结束
.移动 (相减 (右下角横, 左上角横), 相减 (右下角纵, 左上角纵))
相加 (左上角横, 1).复制 (相加 (左上角纵, 1), 相减 (右下角横, 左上角横, 2), 相减 (右下角纵, 左上角纵, 2), , 0, 0, ) ' 将所画框内的图片复制到画板2中，并保存至照片框。
赋值 (_启动窗口..图片, .取图片 ())

.子程序 _画板1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (点击, 真)) ' 画框
    .清除 ()
    赋值 (横向位置, 相加 (左上角横, 取整 (相乘 (相除 (相减 (纵向位置, 左上角纵), 5), 4))))
    左上角横.画矩形 (左上角纵, 横向位置, 纵向位置)
    赋值 (右下角横, 横向位置)
    赋值 (右下角纵, 纵向位置)
    赋值 (点击, 假)
    赋值 (已选取, 真)
    释放鼠标 ()
.如果真结束


.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()

.窗口程序集 统计窗口程序集, , , 

.程序集变量 一级, 文本型, , "0", 
.程序集变量 二级, 文本型, , "0", 
.程序集变量 行业, 文本型, , "0", 
.子程序 _统计按钮_被单击, 空白型, , 
.局部变量 容器1, 整数型, , , 
.局部变量 容器2, 整数型, , , 
.局部变量 容器3, 整数型, , , 
.局部变量 计算结果, 整数型, , , 
.局部变量 已加入一级区域, 逻辑型, , , 
.局部变量 已加入二级区域, 逻辑型, , , 

赋值 (.内容, “”)
相加 (“         健康证发证情况统计”, #换行符, #换行符, “统计日期：从 ”, 时间到文本 (.今天, #日期部分), “ 到 ”, 时间到文本 (.今天, #日期部分), #换行符, #换行符).加入文本 () ' 加入头部
.如果 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “一级区域”, “假”), “真”)) ' 分区域统计，每个一级区域又分二级区域统计，每个二级区域，又分工种统计。通过循环实现。
    .计次循环首 (取数组成员数 (一级), 容器1)
        赋值 (已加入一级区域, 假)
        .如果 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, “假”), “真”))
            重定义数组 (二级, 假, 0)
            取配置项名 (相加 (数据目录, “\set.ini”), 相加 (“一级区域之”, 一级 [容器1]), 二级)
            .计次循环首 (取数组成员数 (二级), 容器2)
                赋值 (已加入二级区域, 假)
                
                .计次循环首 (取数组成员数 (行业), 容器3)
                    赋值 (计算结果, 计算数目 (并且 (等于 (读 (“二级区域”), 二级 [容器2]), 等于 (读 (“工种”), 行业 [容器3]), 大于或等于 (取时间部分 (读 (“发证日期”), #日期部分), 取时间部分 (.今天, #日期部分)), 小于或等于 (取时间部分 (读 (“发证日期”), #日期部分), 取时间部分 (.今天, #日期部分)))))
                    .如果真 (不等于 (计算结果, 0))
                        .如果真 (等于 (已加入一级区域, 假))
                            相加 (一级 [容器1], #换行符).加入文本 ()
                            赋值 (已加入一级区域, 真)
                        .如果真结束
                        .如果真 (等于 (已加入二级区域, 假))
                            相加 (“    ”, 二级 [容器2], “： ”, #换行符).加入文本 ()
                            赋值 (已加入二级区域, 真)
                        .如果真结束
                        相加 (“        ”, 行业 [容器3], “： ”, 取文本右边 (相加 (“    ”, 到文本 (计算结果)), 6), #换行符).加入文本 ()
                    .如果真结束
                    
                .计次循环尾 ()
            .计次循环尾 ()
        .否则
            .计次循环首 (取数组成员数 (行业), 容器3)
                赋值 (计算结果, 计算数目 (并且 (等于 (读 (“一级区域”), 一级 [容器1]), 等于 (读 (“工种”), 行业 [容器3]), 大于或等于 (取时间部分 (读 (“发证日期”), #日期部分), 取时间部分 (.今天, #日期部分)), 小于或等于 (取时间部分 (读 (“发证日期”), #日期部分), 取时间部分 (.今天, #日期部分)))))
                .如果真 (不等于 (计算结果, 0))
                    .如果真 (等于 (已加入一级区域, 假))
                        相加 (一级 [容器1], #换行符).加入文本 ()
                        赋值 (已加入一级区域, 真)
                    .如果真结束
                    相加 (“        ”, 行业 [容器3], “： ”, 取文本右边 (相加 (“    ”, 到文本 (计算结果)), 6), #换行符).加入文本 ()
                .如果真结束
                
            .计次循环尾 ()
        .如果结束
        
    .计次循环尾 ()
.否则
    .计次循环首 (取数组成员数 (行业), 容器3)
        赋值 (计算结果, 计算数目 (并且 (等于 (读 (“工种”), 行业 [容器3]), 大于或等于 (取时间部分 (读 (“发证日期”), #日期部分), 取时间部分 (.今天, #日期部分)), 小于或等于 (取时间部分 (读 (“发证日期”), #日期部分), 取时间部分 (.今天, #日期部分)))))
        .如果真 (不等于 (计算结果, 0))
            相加 (行业 [容器3], “： ”, 取文本右边 (相加 (“    ”, 到文本 (计算结果)), 6), #换行符).加入文本 ()
        .如果真结束
        
    .计次循环尾 ()
.如果结束
相加 (#换行符, “合计：  健康证数： ”, 取文本右边 (相加 (“    ”, 到文本 (计算数目 (并且 (大于或等于 (取时间部分 (读 (“发证日期”), #日期部分), 取时间部分 (.今天, #日期部分)), 小于或等于 (取时间部分 (读 (“发证日期”), #日期部分), 取时间部分 (.今天, #日期部分)))))), 6)).加入文本 () ' 加入合计。

.子程序 _统计窗口_创建完毕, 空白型, , 
.局部变量 内容, 文本型, , , 

赋值 (统计窗口., 相减 (相加 (统计窗口., 346), 统计窗口.取用户区高度 ()))
赋值 (.今天, 指定时间 (取年份 (取现行时间 ()), 1, 1, , , )) ' 自动显示当年的1月1日.
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “一级区域”, “假”), “真”))
    清除数组 (一级)
    取配置项名 (相加 (数据目录, “\set.ini”), “一级区域”, 一级)
.如果真结束
清除数组 (二级)
赋值 (内容, 读配置项 (相加 (数据目录, “\set.ini”), “工种设置”, “工种”, “”))
赋值 (行业, 分割文本 (内容, “,”, ))

.子程序 _保存按钮_被单击, 空白型, , 
.如果真 (打开 ())
    .如果 (写到文件 (.文件名, 到字节集 (.内容)))
        .如果真 (等于 (信息框 (相加 (“保存健康证统计信息至”, .文件名, “成功!要打开并编辑它吗？”), 相加 (#信息图标, #是否钮), ), #是钮))
            未知支持库函数_6 (#, .文件名, , )
        .如果真结束
        
    .否则
        信息框 (相加 (“保存健康证统计信息至”, .文件名, “失败!”), #错误图标, )
    .如果结束
    
.如果真结束


.窗口程序集 欢迎窗口程序集, , , 

.程序集变量 序号, 字节型, , , 
.程序集变量 进度点, 画板, , "6", 
.程序集变量 完成, 逻辑型, , , 
.程序集变量 时间, 整数型, , , 
.子程序 _图片框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (并且 (等于 (完成, 真), 大于 (时间, 6)))
    销毁 ()
.如果真结束


.子程序 _时钟1_周期事件, 空白型, , 
.局部变量 容器1, 空白型, , , 

赋值 (时间, 相加 (时间, 1))
赋值 (序号, 相加 (序号, 1))
.如果真 (等于 (序号, 7))
    赋值 (序号, 1)
.如果真结束
赋值 (进度点 [序号], 画板背景色, #蓝色)
.如果真 (等于 (序号, 1))
    .变量循环首 (2, 6, 1, 容器1)
        赋值 (进度点 [容器1], 画板背景色, #褐绿)
    .变量循环尾 ()
.如果真结束
.如果真 (并且 (等于 (完成, 真), 大于 (时间, 18)))
    销毁 ()
.如果真结束


.子程序 _欢迎窗口_创建完毕, 空白型, , 
赋值 (., 真)
赋值 (进度点 [1], )
赋值 (进度点 [2], )
赋值 (进度点 [3], )
赋值 (进度点 [4], )
赋值 (进度点 [5], )
赋值 (进度点 [6], )
处理事件 () ' 因为以下事件比较占时间，所以放在欢迎窗口中来完成。原来的程序中是没有这个窗口的。
检查配置文件 () ' 检查配置文件是否被修改或删除。
复制打印设置组件 ()
调整卡片布局 () ' 根据用户设置，调整卡片布局
初始化卡片布局 () ' 根据用户设置,调整卡片布局设置界面中的布局.
填充初始数据 () ' 填充区域、工种、性别、体检结果、培训结果等预先设置好的内容至相应组合框。
赋值 (完成, 真)


.窗口程序集 批量打印窗口程序集, , , 

.子程序 _批量打印窗口_创建完毕, 空白型, , 
赋值 (批量打印窗口., 相减 (相加 (批量打印窗口., 170), 批量打印窗口.取用户区高度 ()))
赋值 (.最大允许长度, _启动窗口..最大允许长度) ' 设置编辑框最大允许长度
赋值 (.最大允许长度, _启动窗口..最大允许长度)
获取焦点 ()

.子程序 _取消按钮_被单击, 空白型, , 
赋值 (批量打印, 假)
销毁 ()

.子程序 _初始编辑框_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)

.子程序 _结束编辑框_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)

.子程序 _确定按钮_被单击, 空白型, , 
.局部变量 流水号长度, 空白型, , , 

赋值 (流水号长度, 到数值 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “流水号长度”, “4”)))
.如果真 (不等于 (取文本长度 (.内容), .最大允许长度))
    信息框 (“输入的初始健康证明号码错误，请重新输入。”, #信息图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (不等于 (取文本长度 (.内容), .最大允许长度))
    信息框 (“输入的结束健康证明号码错误，请重新输入。”, #信息图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (不等于 (取文本左边 (.内容, 相减 (取文本长度 (.内容), 流水号长度)), 取文本左边 (.内容, 相减 (取文本长度 (.内容), 流水号长度)))) ' 比较是否属于同一区域同一年份.
    信息框 (“只能对同一年份同一区域的健康证明实现批量打印操作，请确保健康证明编号首部年份及区域编码输入相同。”, #信息图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (小于 (到数值 (取文本右边 (.内容, 流水号长度)), 到数值 (取文本右边 (.内容, 流水号长度)))) ' 比较是否从小到大.
    信息框 (“健康证明编号必须从小到大！”, #信息图标, )
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (证号一, .内容)
赋值 (证号二, .内容)
赋值 (批量打印, 真)
销毁 ()

.子程序 _预览按钮_被单击, 空白型, , 
.局部变量 流水号长度, 空白型, , , 

赋值 (流水号长度, 到数值 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “流水号长度”, “4”)))
.如果真 (不等于 (取文本长度 (.内容), .最大允许长度))
    信息框 (“输入的初始健康证明号码错误，请重新输入。”, #信息图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (不等于 (取文本长度 (.内容), .最大允许长度))
    信息框 (“输入的结束健康证明号码错误，请重新输入。”, #信息图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (不等于 (取文本左边 (.内容, 相减 (取文本长度 (.内容), 流水号长度)), 取文本左边 (.内容, 相减 (取文本长度 (.内容), 流水号长度)))) ' 比较是否属于同一区域同一年份.
    信息框 (“只能对同一年份同一区域的健康证明实现批量打印操作，请确保健康证明编号首部年份及区域编码输入相同。”, #信息图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (小于 (到数值 (取文本右边 (.内容, 流水号长度)), 到数值 (取文本右边 (.内容, 流水号长度)))) ' 比较是否从小到大.
    信息框 (“健康证明编号必须从小到大！”, #信息图标, )
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (证号一, .内容)
赋值 (证号二, .内容)
赋值 (批量打印, 假)
载入 (预览窗口, , 真)
.如果真 (批量打印) ' 如果在预览窗口中点击“打印”按钮返回至此，则直接销毁，进行打印。
    销毁 ()
.如果真结束


.窗口程序集 预览窗口程序集, , , 

.程序集变量 标题字号, 空白型, , , 
.程序集变量 正文字号, 空白型, , , 
.程序集变量 倍数, 小数型, , , 
.程序集变量 批量打印数组, 整数型, , "0", 
.程序集变量 预览索引, 整数型, , , 
.子程序 _预览窗口_创建完毕, 空白型, , 
.局部变量 证件数据, 文本型, , , 
.局部变量 证件数据数组, 文本型, , "0", 
.局部变量 宽, 整数型, , , 
.局部变量 高, 整数型, , , 

赋值 (标题字号, 14)
赋值 (正文字号, 10)
赋值 (倍数, 1)
赋值 (预览窗口., 3)
0.移动 (42, 预览窗口., 相减 (预览窗口.取用户区高度 (), 42))
赋值 (.宽度, 相减 (.宽度, 24))
相减 (.宽度, 23).移动 (0, 20, .高度)
赋值 (证件数据, 读配置项 (相加 (数据目录, “\set.ini”), “打印”, “卡片”, “95,65,4”)) ' 记录设置内容
赋值 (证件数据数组, 分割文本 (证件数据, “,”, ))
.如果真 (不等于 (取数组成员数 (证件数据数组), 3))
    赋值 (证件数据, “95,65,4”)
    赋值 (证件数据数组, 分割文本 (证件数据, “,”, ))
.如果真结束
赋值 (宽, 毫米到像素 (到数值 (证件数据数组 [1]))) ' 将设置的毫米，转换成像素单位，以便统一显示。
赋值 (高, 毫米到像素 (到数值 (证件数据数组 [2])))
.如果 (等于 (是否已创建 (批量打印窗口), 假)) ' 是否批量打印
    相除 (相减 (.宽度, 宽), 2).移动 (20, 宽, 高)
    赋值 (.可视, 假)
    赋值 (., 真)
    预览窗口.刷新显示 ()
    单份预览 ()
    重画 ()
.否则
    相除 (相减 (.宽度, 宽), 2).移动 (20, 宽, 相乘 (高, 4))
    赋值 (.可视, 真)
    赋值 (.最大位置, 相加 (相减 (.高度, .高度), 20))
    赋值 (., 真)
    预览窗口.刷新显示 ()
    计算份数 ()
    赋值 (预览索引, 1)
    批量预览 ()
.如果结束


.子程序 毫米到像素, 整数型, , 
.参数 毫米值, 空白型, , 

返回 (未知支持库函数_70 (毫米值, #, #))

.子程序 _关闭按钮_被单击, 空白型, , 
赋值 (批量打印, 假)
赋值 (预览后打印, 假)
销毁 ()

.子程序 _打印按钮_被单击, 空白型, , 
赋值 (批量打印, 真)
赋值 (预览后打印, 真)
销毁 ()

.子程序 _放大按钮_被单击, 空白型, , 
.局部变量 宽, 整数型, , , 
.局部变量 高, 整数型, , , 

赋值 (宽, 相乘 (.宽度, 2)) ' 以2倍扩大
赋值 (高, 相乘 (.高度, 2))
赋值 (标题字号, 相乘 (标题字号, 2))
赋值 (正文字号, 相乘 (正文字号, 2))
赋值 (倍数, 相乘 (倍数, 2))
.清除 ()
相除 (相减 (.宽度, 宽), 2).移动 (20, 宽, 高)
刷新显示 ()
.如果 (是否已创建 (批量打印窗口))
    批量预览 ()
.否则
    单份预览 ()
.如果结束
刷新显示 ()
赋值 (.禁止, 真)
赋值 (.禁止, 假)
.如果 (大于 (.高度, 相减 (.高度, 20))) ' 重新设置滚动条
    赋值 (.可视, 真)
    赋值 (.最大位置, 相加 (相减 (.高度, .高度), 20))
    赋值 (.位置, 1)
.否则
    赋值 (.可视, 假)
.如果结束


.子程序 _缩小按钮_被单击, 空白型, , 
.局部变量 宽, 整数型, , , 
.局部变量 高, 整数型, , , 

赋值 (宽, 相除 (.宽度, 2)) ' 以2倍缩小
赋值 (高, 相除 (.高度, 2))
赋值 (标题字号, 相除 (标题字号, 2))
赋值 (正文字号, 相除 (正文字号, 2))
赋值 (倍数, 相除 (倍数, 2))
.清除 ()
相除 (相减 (.宽度, 宽), 2).移动 (20, 宽, 高)
刷新显示 ()
.如果 (是否已创建 (批量打印窗口))
    批量预览 ()
.否则
    单份预览 ()
.如果结束
刷新显示 ()
赋值 (.禁止, 假)
赋值 (.禁止, 真)
.如果 (大于 (.高度, 相减 (.高度, 20))) ' 重新设置滚动条
    赋值 (.可视, 真)
    赋值 (.最大位置, 相加 (相减 (.高度, .高度), 20))
    赋值 (.位置, 1)
.否则
    赋值 (.可视, 假)
.如果结束


.子程序 _预览窗口_可否被关闭, 逻辑型, , 
赋值 (批量打印, 假)
销毁 ()

.子程序 单份预览, 空白型, , 
.局部变量 是否套打, 逻辑型, , , 
.局部变量 打印项目, 文本型, , "0", 
.局部变量 纵向位置, 整数型, , , 
.局部变量 位置文本, 文本型, , , 
.局部变量 位置数组, 文本型, , "3", 
.局部变量 照片宽度, 整数型, , , 
.局部变量 循环变量1, 整数型, , , 
.局部变量 打印内容, 文本型, , , 
.局部变量 图片句柄, 整数型, , , 

赋值 (打印项目, { “标题”, “证号”, “姓名”, “性别”, “年龄”, “工种”, “发证日期” }) ' 先添加固定打印项目。
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “一级区域”, “假”), “真”)) ' 以下根据设置添加其它打印项目。
    加入成员 (打印项目, “一级区域”)
.如果真结束
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, “假”), “真”))
    加入成员 (打印项目, “二级区域”)
.如果真结束
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “所在单位”, “假”), “真”))
    加入成员 (打印项目, “所在单位”)
.如果真结束
.如果真 (并且 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “照片”, “假”), “真”), 不等于 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “照片来源”, “显示”), “显示”)))
    加入成员 (打印项目, “照片”)
.如果真结束
加入成员 (打印项目, “体检结果”) ' 体检结果与培训结果，无论是否存在该字段，均可以打印，所以这里不加判断，直接加上。
加入成员 (打印项目, “培训结果”)
加入成员 (打印项目, “发证单位”)
赋值 (是否套打, 等于 (读配置项 (相加 (数据目录, “\set.ini”), “打印”, “套打”, “真”), “真”))
赋值 (.字体.字体大小, 正文字号)
.如果 (是否套打)
    .计次循环首 (取数组成员数 (打印项目), 循环变量1) ' 套打，忽略“标题”和“发证单位”两个项目不进行判断和打印。
        .判断开始 (等于 (打印项目 [循环变量1], “证号”)) ' 根据打印项目，设置打印内容。
            赋值 (打印内容, _启动窗口..内容)
        .判断 (等于 (打印项目 [循环变量1], “姓名”))
            赋值 (打印内容, _启动窗口..内容)
        .判断 (等于 (打印项目 [循环变量1], “性别”))
            赋值 (打印内容, _启动窗口.取项目文本 (., _启动窗口..现行选中项))
        .判断 (等于 (打印项目 [循环变量1], “年龄”))
            赋值 (打印内容, _启动窗口..内容)
        .判断 (等于 (打印项目 [循环变量1], “工种”))
            赋值 (打印内容, _启动窗口.取项目文本 (., _启动窗口..现行选中项))
        .判断 (等于 (打印项目 [循环变量1], “一级区域”))
            赋值 (打印内容, _启动窗口.取项目文本 (., _启动窗口..现行选中项))
        .判断 (等于 (打印项目 [循环变量1], “二级区域”))
            赋值 (打印内容, _启动窗口.取项目文本 (., _启动窗口..现行选中项))
        .判断 (等于 (打印项目 [循环变量1], “所在单位”))
            赋值 (打印内容, _启动窗口..标题)
        .判断 (等于 (打印项目 [循环变量1], “体检结果”))
            赋值 (打印内容, _启动窗口.取项目文本 (., _启动窗口..现行选中项)) ' 组合框默认选择文本为：合格。
        .判断 (等于 (打印项目 [循环变量1], “培训结果”))
            赋值 (打印内容, _启动窗口.取项目文本 (., _启动窗口..现行选中项)) ' 组合框默认选择文本为：合格。
        .默认
            
        .判断结束
        赋值 (位置文本, 读配置项 (相加 (数据目录, “\set.ini”), “打印”, 打印项目 [循环变量1], 相加 (“0,0,”, 选择 (并且 (大于 (循环变量1, 1), 小于或等于 (循环变量1, 7)), “0”, “-1”)))) ' 前7个项目，默认为打印（0），后面的项目，默认为不打印（-1）。
        赋值 (位置数组, 分割文本 (位置文本, “,”, )) ' 位置有3个数值：左边，顶边，是否打印。
        .如果真 (等于 (位置数组 [3], “0”))
            .判断开始 (等于 (打印项目 [循环变量1], “照片”))
                赋值 (照片宽度, 毫米到像素 (到数值 (读配置项 (相加 (数据目录, “\set.ini”), “打印”, “照片宽度”, “24”))))
                赋值 (图片句柄, 载入图片 (_启动窗口..图片))
                图片句柄.画图片 (相乘 (毫米到像素 (到数值 (位置数组 [1])), 倍数), 相乘 (毫米到像素 (到数值 (位置数组 [2])), 倍数), 照片宽度, 相乘 (相除 (照片宽度, 4), 5, 倍数), ) ' 照片打印的宽高比固定为4：5，所以只要读取宽度，就可以知道高度。
                卸载图片 (图片句柄)
            .判断 (等于 (打印项目 [循环变量1], “发证日期”))
                相乘 (毫米到像素 (相减 (到数值 (位置数组 [1]), 2)), 倍数).定位写出 (相乘 (毫米到像素 (到数值 (位置数组 [2])), 倍数), 取年份 (_启动窗口..今天)) ' 套打时，年月日要分开打印。所以加上间隔距离。
                相乘 (毫米到像素 (相加 (相乘 (到数值 (位置数组 [1]), 倍数), 到数值 (读配置项 (相加 (数据目录, “\set.ini”), “打印”, “日期间隔”, “10”)), 1)), 倍数).定位写出 (相乘 (毫米到像素 (到数值 (位置数组 [2])), 倍数), 取月份 (_启动窗口..今天)) ' 因为年份有4位数，所以后面的间隔多加1毫米。（10）
                相乘 (毫米到像素 (相加 (相乘 (到数值 (位置数组 [1]), 倍数), 相乘 (到数值 (读配置项 (相加 (数据目录, “\set.ini”), “打印”, “日期间隔”, “10”)), 20), 1)), 倍数).定位写出 (相乘 (毫米到像素 (到数值 (位置数组 [2])), 倍数), 取日 (_启动窗口..今天))
            .默认
                相乘 (毫米到像素 (到数值 (位置数组 [1])), 倍数).定位写出 (相乘 (毫米到像素 (到数值 (位置数组 [2])), 倍数), 打印内容) ' 其它项目直接打印。
            .判断结束
            
        .如果真结束
        
    .计次循环尾 ()
.否则
     ' 不是套打，则打印内容包括标题和实际内容。
    .计次循环首 (取数组成员数 (打印项目), 循环变量1)
        .判断开始 (等于 (打印项目 [循环变量1], “标题”))
            赋值 (打印内容, “健 康 证 明”)
        .判断 (等于 (打印项目 [循环变量1], “证号”))
            .如果 (_启动窗口..可视)
                赋值 (打印内容, 相加 (“证号：”, _启动窗口..标题, “ ”, _启动窗口..内容))
            .否则
                赋值 (打印内容, 相加 (“证号：”, _启动窗口..内容))
            .如果结束
            
        .判断 (等于 (打印项目 [循环变量1], “姓名”))
            赋值 (打印内容, 相加 (“姓名：”, _启动窗口..内容))
        .判断 (等于 (打印项目 [循环变量1], “性别”))
            赋值 (打印内容, 相加 (“性别：”, _启动窗口.取项目文本 (., _启动窗口..现行选中项)))
        .判断 (等于 (打印项目 [循环变量1], “年龄”))
            赋值 (打印内容, 相加 (“年龄：”, _启动窗口..内容))
        .判断 (等于 (打印项目 [循环变量1], “工种”))
            赋值 (打印内容, 相加 (“工种：”, _启动窗口.取项目文本 (., _启动窗口..现行选中项)))
        .判断 (等于 (打印项目 [循环变量1], “发证日期”))
            赋值 (打印内容, 相加 (“发证日期：”, 时间到文本 (_启动窗口..今天, #日期部分)))
        .判断 (等于 (打印项目 [循环变量1], “一级区域”))
            赋值 (打印内容, 相加 (_启动窗口..标题, “：”, _启动窗口.取项目文本 (., _启动窗口..现行选中项)))
        .判断 (等于 (打印项目 [循环变量1], “二级区域”))
            赋值 (打印内容, 相加 (_启动窗口..标题, “：”, _启动窗口.取项目文本 (., _启动窗口..现行选中项)))
        .判断 (等于 (打印项目 [循环变量1], “所在单位”))
            赋值 (打印内容, 相加 (“单位：”, _启动窗口..标题))
        .判断 (等于 (打印项目 [循环变量1], “体检结果”))
            赋值 (打印内容, 相加 (“体检：”, _启动窗口.取项目文本 (., _启动窗口..现行选中项)))
        .判断 (等于 (打印项目 [循环变量1], “培训结果”))
            赋值 (打印内容, 相加 (“培训：”, _启动窗口.取项目文本 (., _启动窗口..现行选中项)))
        .判断 (等于 (打印项目 [循环变量1], “发证单位”))
            赋值 (打印内容, _启动窗口..标题)
        .默认
            
        .判断结束
        赋值 (位置文本, 读配置项 (相加 (数据目录, “\set.ini”), “打印”, 打印项目 [循环变量1], 相加 (“0,0,”, 选择 (并且 (大于 (循环变量1, 1), 小于或等于 (循环变量1, 7)), “0”, “-1”)))) ' 同套打。
        赋值 (位置数组, 分割文本 (位置文本, “,”, ))
        .如果真 (等于 (位置数组 [3], “0”))
            .判断开始 (等于 (打印项目 [循环变量1], “标题”)) ' 标题字体相应增大。
                赋值 (.字体.字体名称, “黑体”)
                赋值 (.字体.字体大小, 标题字号)
                相乘 (毫米到像素 (到数值 (位置数组 [1])), 倍数).定位写出 (相乘 (毫米到像素 (到数值 (位置数组 [2])), 倍数), 打印内容)
                赋值 (.字体.字体名称, “宋体”)
                赋值 (.字体.字体大小, 正文字号) ' 恢复字体。
            .判断 (等于 (打印项目 [循环变量1], “照片”))
                赋值 (照片宽度, 毫米到像素 (到数值 (读配置项 (相加 (数据目录, “\set.ini”), “打印”, “照片宽度”, “24”))))
                赋值 (图片句柄, 载入图片 (_启动窗口..图片))
                图片句柄.画图片 (相乘 (毫米到像素 (到数值 (位置数组 [1])), 倍数), 相乘 (毫米到像素 (到数值 (位置数组 [2])), 倍数), 相乘 (照片宽度, 倍数), 相乘 (相除 (照片宽度, 4), 5, 倍数), )
                卸载图片 (图片句柄)
            .默认
                相乘 (毫米到像素 (到数值 (位置数组 [1])), 倍数).定位写出 (相乘 (毫米到像素 (到数值 (位置数组 [2])), 倍数), 打印内容) ' 因为不是套打，日期可以连续打印而不必要分年月日，所以这里不需要进行单独判断，而与其它项目一样，直接打印。
            .判断结束
            
        .如果真结束
        
    .计次循环尾 ()
.如果结束


.子程序 批量预览, 空白型, , 
.局部变量 打印证号, 整数型, , , 
.局部变量 证号长度, 整数型, , , 
.局部变量 索引号, 整数型, , , 
.局部变量 卡片设置, 文本型, , , 
.局部变量 卡片数值组, 文本型, , "3", 
.局部变量 位置文本, 文本型, , , 
.局部变量 位置数组, 文本型, , "3", 
.局部变量 循环变量1, 整数型, , , 
.局部变量 打印内容, 文本型, , , 
.局部变量 打印项目, 文本型, , "0", 
.局部变量 是否套打, 逻辑型, , , 
.局部变量 照片宽度, 整数型, , , 
.局部变量 图片句柄, 整数型, , , 
.局部变量 原来记录, 整数型, , , 
.局部变量 开始证号, 整数型, , , 

赋值 (打印项目, { “标题”, “证号”, “姓名”, “性别”, “年龄”, “工种”, “发证日期” }) ' 先添加固定打印项目。
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “一级区域”, “假”), “真”)) ' 以下根据设置添加其它打印项目。
    加入成员 (打印项目, “一级区域”)
.如果真结束
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “二级区域”, “假”), “真”))
    加入成员 (打印项目, “二级区域”)
.如果真结束
.如果真 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “所在单位”, “假”), “真”))
    加入成员 (打印项目, “所在单位”)
.如果真结束
.如果真 (并且 (等于 (读配置项 (相加 (数据目录, “\set.ini”), “字段”, “照片”, “假”), “真”), 不等于 (读配置项 (相加 (数据目录, “\set.ini”), “杂项”, “照片来源”, “显示”), “显示”)))
    加入成员 (打印项目, “照片”)
.如果真结束
加入成员 (打印项目, “体检结果”) ' 体检结果与培训结果，无论是否存在该字段，均可以打印，所以这里不加判断，直接加上。
加入成员 (打印项目, “培训结果”)
加入成员 (打印项目, “发证单位”)
赋值 (是否套打, 等于 (读配置项 (相加 (数据目录, “\set.ini”), “打印”, “套打”, “真”), “真”))
赋值 (.字体.字体大小, 正文字号)
赋值 (卡片设置, 读配置项 (相加 (数据目录, “\set.ini”), “打印”, “卡片”, “95，65，4”))
赋值 (卡片数值组, 分割文本 (卡片设置, “,”, ))
赋值 (索引号, 1) ' 用以和卡片连续张数进行比较。
赋值 (开始证号, 批量打印数组 [预览索引])
.变量循环首 (到数值 (开始证号), 到数值 (证号二), 1, 打印证号)
    到首记录 ()
    赋值 (证号长度, 取文本长度 (证号一))
    .如果真 (查找 (并且 (等于 (读 (“健康证号”), 取文本右边 (相加 (取重复文本 (证号长度, “0”), 到文本 (打印证号)), 证号长度)), 等于 (取年份 (读 (“发证日期”)), 取年份 (取现行时间 ())))))
        读记录 () ' 将记录内容读到界面中，以方便打印时读取。
        .如果 (是否套打)
            .计次循环首 (取数组成员数 (打印项目), 循环变量1)
                .判断开始 (等于 (打印项目 [循环变量1], “证号”)) ' 根据打印项目，设置打印内容。
                    赋值 (打印内容, _启动窗口..内容)
                .判断 (等于 (打印项目 [循环变量1], “姓名”))
                    赋值 (打印内容, _启动窗口..内容)
                .判断 (等于 (打印项目 [循环变量1], “性别”))
                    赋值 (打印内容, _启动窗口.取项目文本 (., _启动窗口..现行选中项))
                .判断 (等于 (打印项目 [循环变量1], “年龄”))
                    赋值 (打印内容, _启动窗口..内容)
                .判断 (等于 (打印项目 [循环变量1], “工种”))
                    赋值 (打印内容, _启动窗口.取项目文本 (., _启动窗口..现行选中项))
                .判断 (等于 (打印项目 [循环变量1], “一级区域”))
                    赋值 (打印内容, _启动窗口.取项目文本 (., _启动窗口..现行选中项))
                .判断 (等于 (打印项目 [循环变量1], “二级区域”))
                    赋值 (打印内容, _启动窗口.取项目文本 (., _启动窗口..现行选中项))
                .判断 (等于 (打印项目 [循环变量1], “所在单位”))
                    赋值 (打印内容, _启动窗口..标题)
                .判断 (等于 (打印项目 [循环变量1], “体检结果”))
                    赋值 (打印内容, _启动窗口.取项目文本 (., _启动窗口..现行选中项)) ' 组合框默认选择文本为：合格。
                .判断 (等于 (打印项目 [循环变量1], “培训结果”))
                    赋值 (打印内容, _启动窗口.取项目文本 (., _启动窗口..现行选中项)) ' 组合框默认选择文本为：合格。
                .默认
                    
                .判断结束
                赋值 (位置文本, 读配置项 (相加 (数据目录, “\set.ini”), “打印”, 打印项目 [循环变量1], 相加 (“0,0,”, 选择 (并且 (大于 (循环变量1, 1), 小于或等于 (循环变量1, 7)), “0”, “-1”))))
                赋值 (位置数组, 分割文本 (位置文本, “,”, ))
                .如果真 (等于 (位置数组 [3], “0”))
                    .判断开始 (等于 (打印项目 [循环变量1], “照片”))
                        赋值 (照片宽度, 毫米到像素 (到数值 (读配置项 (相加 (数据目录, “\set.ini”), “打印”, “照片宽度”, “24”))))
                        赋值 (图片句柄, 载入图片 (_启动窗口..图片))
                        图片句柄.画图片 (相乘 (毫米到像素 (到数值 (位置数组 [1])), 倍数), 相加 (相乘 (毫米到像素 (相乘 (相减 (索引号, 1), 到数值 (卡片数值组 [2]))), 倍数), 相乘 (毫米到像素 (到数值 (位置数组 [2])), 倍数)), 照片宽度, 相乘 (相除 (照片宽度, 4), 5, 倍数), ) ' 照片打印的宽高比固定为4：5，所以只要读取宽度，就可以知道高度。
                        卸载图片 (图片句柄)
                    .判断 (等于 (打印项目 [循环变量1], “发证日期”))
                        相乘 (毫米到像素 (相减 (到数值 (位置数组 [1]), 2)), 倍数).定位写出 (相加 (相乘 (毫米到像素 (相乘 (相减 (索引号, 1), 到数值 (卡片数值组 [2]))), 倍数), 相乘 (毫米到像素 (到数值 (位置数组 [2])), 倍数)), 取年份 (_启动窗口..今天)) ' 套打时，年月日要分开打印。所以加上间隔距离。
                        相乘 (毫米到像素 (相加 (相乘 (到数值 (位置数组 [1]), 倍数), 到数值 (读配置项 (相加 (数据目录, “\set.ini”), “打印”, “日期间隔”, “10”)), 1)), 倍数).定位写出 (相加 (相乘 (毫米到像素 (相乘 (相减 (索引号, 1), 到数值 (卡片数值组 [2]))), 倍数), 相乘 (毫米到像素 (到数值 (位置数组 [2])), 倍数)), 取月份 (_启动窗口..今天)) ' 因为年份有4位数，所以后面的间隔多加1毫米。（10）
                        相乘 (毫米到像素 (相加 (相乘 (到数值 (位置数组 [1]), 倍数), 相乘 (到数值 (读配置项 (相加 (数据目录, “\set.ini”), “打印”, “日期间隔”, “10”)), 20), 1)), 倍数).定位写出 (相加 (相乘 (毫米到像素 (相乘 (相减 (索引号, 1), 到数值 (卡片数值组 [2]))), 倍数), 相乘 (毫米到像素 (到数值 (位置数组 [2])), 倍数)), 取日 (_启动窗口..今天))
                    .默认
                        相乘 (毫米到像素 (到数值 (位置数组 [1])), 倍数).定位写出 (相加 (相乘 (毫米到像素 (相乘 (相减 (索引号, 1), 到数值 (卡片数值组 [2]))), 倍数), 相乘 (毫米到像素 (到数值 (位置数组 [2])), 倍数)), 打印内容) ' 其它项目直接打印。
                    .判断结束
                    
                .如果真结束
                
            .计次循环尾 ()
        .否则
            .计次循环首 (取数组成员数 (打印项目), 循环变量1)
                .判断开始 (等于 (打印项目 [循环变量1], “标题”))
                    赋值 (打印内容, “健 康 证 明”)
                .判断 (等于 (打印项目 [循环变量1], “证号”))
                    .如果 (_启动窗口..可视)
                        赋值 (打印内容, 相加 (“证号：”, _启动窗口..标题, “ ”, _启动窗口..内容))
                    .否则
                        赋值 (打印内容, 相加 (“证号：”, _启动窗口..内容))
                    .如果结束
                    
                .判断 (等于 (打印项目 [循环变量1], “姓名”))
                    赋值 (打印内容, 相加 (“姓名：”, _启动窗口..内容))
                .判断 (等于 (打印项目 [循环变量1], “性别”))
                    赋值 (打印内容, 相加 (“性别：”, _启动窗口.取项目文本 (., _启动窗口..现行选中项)))
                .判断 (等于 (打印项目 [循环变量1], “年龄”))
                    赋值 (打印内容, 相加 (“年龄：”, _启动窗口..内容))
                .判断 (等于 (打印项目 [循环变量1], “工种”))
                    赋值 (打印内容, 相加 (“工种：”, _启动窗口.取项目文本 (., _启动窗口..现行选中项)))
                .判断 (等于 (打印项目 [循环变量1], “发证日期”))
                    赋值 (打印内容, 相加 (“发证日期：”, 时间到文本 (_启动窗口..今天, #日期部分)))
                .判断 (等于 (打印项目 [循环变量1], “一级区域”))
                    赋值 (打印内容, 相加 (_启动窗口..标题, “：”, _启动窗口.取项目文本 (., _启动窗口..现行选中项)))
                .判断 (等于 (打印项目 [循环变量1], “二级区域”))
                    赋值 (打印内容, 相加 (_启动窗口..标题, “：”, _启动窗口.取项目文本 (., _启动窗口..现行选中项)))
                .判断 (等于 (打印项目 [循环变量1], “所在单位”))
                    赋值 (打印内容, 相加 (“单位：”, _启动窗口..标题))
                .判断 (等于 (打印项目 [循环变量1], “体检结果”))
                    赋值 (打印内容, 相加 (“体检：”, _启动窗口.取项目文本 (., _启动窗口..现行选中项)))
                .判断 (等于 (打印项目 [循环变量1], “培训结果”))
                    赋值 (打印内容, 相加 (“培训：”, _启动窗口.取项目文本 (., _启动窗口..现行选中项)))
                .判断 (等于 (打印项目 [循环变量1], “发证单位”))
                    赋值 (打印内容, _启动窗口..标题)
                .默认
                    
                .判断结束
                赋值 (位置文本, 读配置项 (相加 (数据目录, “\set.ini”), “打印”, 打印项目 [循环变量1], 相加 (“0,0,”, 选择 (并且 (大于 (循环变量1, 1), 小于或等于 (循环变量1, 7)), “0”, “-1”))))
                赋值 (位置数组, 分割文本 (位置文本, “,”, ))
                .如果真 (等于 (位置数组 [3], “0”))
                    .判断开始 (等于 (打印项目 [循环变量1], “标题”)) ' 标题字体相应增大。
                        赋值 (.字体.字体名称, “黑体”)
                        赋值 (.字体.字体大小, 标题字号)
                        相乘 (毫米到像素 (到数值 (位置数组 [1])), 倍数).定位写出 (相加 (相乘 (毫米到像素 (相乘 (相减 (索引号, 1), 到数值 (卡片数值组 [2]))), 倍数), 相乘 (毫米到像素 (到数值 (位置数组 [2])), 倍数)), 打印内容)
                        赋值 (.字体.字体名称, “宋体”)
                        赋值 (.字体.字体大小, 正文字号) ' 恢复字体。
                    .判断 (等于 (打印项目 [循环变量1], “照片”))
                        赋值 (照片宽度, 毫米到像素 (到数值 (读配置项 (相加 (数据目录, “\set.ini”), “打印”, “照片宽度”, “24”))))
                        赋值 (图片句柄, 载入图片 (_启动窗口..图片))
                        图片句柄.画图片 (相乘 (毫米到像素 (到数值 (位置数组 [1])), 倍数), 相加 (相乘 (毫米到像素 (相乘 (相减 (索引号, 1), 到数值 (卡片数值组 [2]))), 倍数), 相乘 (毫米到像素 (到数值 (位置数组 [2])), 倍数)), 相乘 (照片宽度, 倍数), 相乘 (相除 (照片宽度, 4), 5, 倍数), )
                        卸载图片 (图片句柄)
                    .默认
                        相乘 (毫米到像素 (到数值 (位置数组 [1])), 倍数).定位写出 (相加 (相乘 (毫米到像素 (相乘 (相减 (索引号, 1), 到数值 (卡片数值组 [2]))), 倍数), 相乘 (毫米到像素 (到数值 (位置数组 [2])), 倍数)), 打印内容) ' 因为不是套打，日期可以连续打印而不必要分年月日，所以这里不需要进行单独判断，而与其它项目一样，直接打印。
                    .判断结束
                    
                .如果真结束
                
            .计次循环尾 ()
        .如果结束
        赋值 (索引号, 相加 (索引号, 1))
        .如果真 (大于 (索引号, 到数值 (卡片数值组 [3]))) ' 如果打印的索引号超过卡片连续张数，则换页。
            赋值 (索引号, 1)
            跳出循环 ()
        .如果真结束
        
    .如果真结束
    
.变量循环尾 ()
.如果 (等于 (取数组成员数 (批量打印数组), 1))
    连续赋值 (真, .禁止, .禁止)
.否则
    .判断开始 (等于 (预览索引, 1))
        赋值 (.禁止, 真)
        赋值 (.禁止, 假)
    .判断 (等于 (预览索引, 取数组成员数 (批量打印数组)))
        赋值 (.禁止, 假)
        赋值 (.禁止, 真)
    .默认
        连续赋值 (假, .禁止, .禁止)
    .判断结束
    
.如果结束



.子程序 _纵向滚动条1_位置被改变, 空白型, , 
赋值 (.顶边, 相减 (21, .位置))

.子程序 计算份数, 空白型, , 
.局部变量 打印证号, 整数型, , , 
.局部变量 份数, 整数型, , , 
.局部变量 证号长度, 整数型, , , 

清除数组 (批量打印数组)
.变量循环首 (到数值 (证号一), 到数值 (证号二), 1, 打印证号)
    到首记录 ()
    赋值 (证号长度, 取文本长度 (证号一))
    .如果真 (查找 (并且 (等于 (读 (“健康证号”), 取文本右边 (相加 (取重复文本 (证号长度, “0”), 到文本 (打印证号)), 证号长度)), 等于 (取年份 (读 (“发证日期”)), 取年份 (取现行时间 ())))))
        赋值 (份数, 相加 (份数, 1))
        .如果真 (等于 (份数, 1))
            加入成员 (批量打印数组, 打印证号) ' 以健康证明卡片的连续张数进行计算，共有多少页，以便执行上一页、下一页操作。
        .如果真结束
        
    .如果真结束
    .如果真 (等于 (份数, 4))
        赋值 (份数, 0)
    .如果真结束
    
.变量循环尾 ()

.子程序 _上一按钮_被单击, 空白型, , 
.清除 ()
赋值 (.位置, 1)
_纵向滚动条1_位置被改变 ()
赋值 (预览索引, 相减 (预览索引, 1))
批量预览 ()

.子程序 _下一按钮_被单击, 空白型, , 
.清除 ()
赋值 (.位置, 1)
_纵向滚动条1_位置被改变 ()
赋值 (预览索引, 相加 (预览索引, 1))
批量预览 ()


 ' 不属于任何一个程序集、类模块的函数：
