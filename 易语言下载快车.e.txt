 ' 文件类型：Windows窗口程序

 ' 程序名称：易语言下载快车
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.1
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 747
    高度 = 461
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “易语言下载快车”
    帮助文件名 = “”

窗口 增加新任务
    左边 = 50
    顶边 = 50
    宽度 = 415
    高度 = 464
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “增加新的下载任务”
    帮助文件名 = “”

窗口 创建新类别
    左边 = 50
    顶边 = 50
    宽度 = 281
    高度 = 170
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “创建新类别”
    帮助文件名 = “”

窗口 删除类别
    左边 = 50
    顶边 = 50
    宽度 = 262
    高度 = 101
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “删除类别”
    帮助文件名 = “”

窗口 选项窗口
    左边 = 50
    顶边 = 50
    宽度 = 373
    高度 = 332
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “选项”
    帮助文件名 = “”

窗口 设置速度
    左边 = 50
    顶边 = 50
    宽度 = 201
    高度 = 98
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “设置速度”
    帮助文件名 = “”

窗口 关于
    左边 = 50
    顶边 = 50
    宽度 = 416
    高度 = 300
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于易语言下载快车”
    帮助文件名 = “”

窗口 类别属性
    左边 = 50
    顶边 = 50
    宽度 = 282
    高度 = 176
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “类别属性”
    帮助文件名 = “”

窗口 悬浮窗口
    左边 = 50
    顶边 = 50
    宽度 = 467
    高度 = 350
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 2
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\易语言下载快车.e\悬浮窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 程序备注
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “程序备注”
    帮助文件名 = “”



.常量 易语言下载快车当前版本, "“1.12.6”", , 
.常量 互斥体名称, "“易语言下载快车”", , 
.常量 窗口标题, "“易语言下载快车”", , 
.常量 右键对象标示, "“{A1687AD1-A34A-4A77-AF65-3D8D063ADA0A}”", , 
.常量 , , , 
.常量 默认界面布局, "1", , 
.常量 当前布局, "2", , 
.常量 分隔条宽度, "4", , 分隔条自身宽度
.常量 分隔条底案宽度, "4", , 因为如果直接用分隔条连接两个控件，在视觉上有中柱面效果。通过设置这个底案值可以使它变为平面效果
.常量 广告图片框宽度, "200", , 
.常量 未下载点, "1", , 
.常量 已下载点, "2", , 
.常量 正下载点, "3", , 
.常量 内部选择, "-1", , 
.常量 进度框点间距, "1", , 
.常量 任务状态_删除状态, "1", , 
.常量 任务状态_停止状态, "2", , 
.常量 任务状态_开始状态, "3", , 
.常量 任务状态_初始化状态, "4", , 
.常量 系统日志图标, "0", , 
.常量 错误日志图标, "2", , 
.常量 发送日志图标, "1", , 
.常量 接收日志图标, "3", , 
.常量 正运行, "1", , 
.常量 已停止, "2", , 
.常量 已删除, "3", , 
.常量 文件状态图标_未知状态, "1", , 
.常量 文件状态图标_正在下载状态, "5", , 
.常量 文件状态图标_错误状态, "7", , 
.常量 文件状态图标_未下完状态, "8", , 
.常量 文件状态图标_完成状态, "6", , 
.常量 , , , 
.常量 默认日志背景颜色, "15987688", , 
.常量 默认下载数据自动保存时间, "2", , 
.常量 默认写入磁盘大小, "40960", , 
.常量 默认接收大小, "20480", , 
.常量 默认连接超时, "90000", , 
.常量 默认发送超时, "90000", , 
.常量 默认接收超时, "90000", , 
.常量 默认线程超时, "10000", , 
.常量 默认最大任务数, "5", , 
.常量 默认最大重试数, "99", , 
.常量 默认速度, "0", , 
.常量 默认重试时间, "5000", , 
.常量 , , , 
.常量 新建, "1", , 
.常量 属性, "2", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 5 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 3 扩展界面支持库一
 ' ExtMenu 9909FBB013704cfa8FE7E739DB7172DE 1 6 超级菜单支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 1 1 多线程支持库
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库
 ' downlib 80CF4A6B3E09425bA57935A3A0E4C473 2 0 网络传送支持库
 ' edroptarget {9DA96BF9CEBD45c5BFCF94CBE61671F5} 1 0 拖放支持库




数据类型 任务长度信息数组, , 点型进度框类使用
    .成员 任务状态, 整数型, , , 
    .成员 总长度, 整数型, , , 
    .成员 单点长度, 整数型, , , 
    .成员 图片总个数, 整数型, , , 
    .成员 显示图片矩阵, 矩阵坐标, , , 
    .成员 点状态数组, 字节型, , "1", 

数据类型 矩阵坐标, , 
    .成员 横坐标, 整数型, , , 做为显示图片矩阵使用时 表示一行图片个数
    .成员 纵坐标, 整数型, , , 做为显示图片矩阵使用时 表示图片行数

数据类型 系统配置, , 
    .成员 日志背景颜色, 整数型, , , 
    .成员 下载数据自动保存时间, 整数型, , , 
    .成员 写入磁盘大小, 整数型, , , 
    .成员 接收大小, 整数型, , , 
    .成员 连接超时, 整数型, , , 
    .成员 发送超时, 整数型, , , 
    .成员 接收超时, 整数型, , , 
    .成员 线程超时, 整数型, , , 
    .成员 最大任务数, 整数型, , , 
    .成员 最大重试数, 整数型, , , 
    .成员 速度, 整数型, , , 
    .成员 重试时间, 整数型, , , 

数据类型 日志结构, , 
    .成员 消息类型, 整数型, , , 
    .成员 时间文本, 文本型, , , 
    .成员 内容文本, 文本型, , , 

数据类型 线程相关信息, , 
    .成员 线程信息, 整数型, , , 线程信息等于0表示本成员为无效线程成员，可以存放新线程信息
    .成员 开始位置, 整数型, , , 
    .成员 已下载大小, 整数型, , , 
    .成员 线程树节点索引, 整数型, , , 
    .成员 日志数组, 日志结构, , "1", 

数据类型 任务常规信息, , 
    .成员 文件名, 文本型, , , 
    .成员 网址, 文本型, , , 
    .成员 创建时间, 日期时间型, , , 
    .成员 注释, 文本型, , , 
    .成员 文件路径, 文本型, , , 
    .成员 完成时间, 日期时间型, , , 
    .成员 默认线程数, 整数型, , , 
    .成员 用户名, 文本型, , , FTP用
    .成员 密码, 文本型, , , FTP用
    .成员 完成数, 整数型, , , 
    .成员 总长度, 整数型, , , 
    .成员 总块数, 整数型, , , 
    .成员 活动块数, 整数型, , , 
    .成员 文件状态, 整数型, , , 
    .成员 保存目录, 文本型, , , 
    .成员 同名文件处理, 整数型, , , 

数据类型 任务核心数据, , 
    .成员 对象信息, 整数型, , , 
    .成员 线程信息数组, 线程相关信息, , "1", 

数据类型 树型框项目信息, , 
    .成员 横向位置, 整数型, , , 
    .成员 纵向位置, 整数型, , , 
    .成员 标志号, 整数型, , , 
    .成员 句柄号, 整数型, , , 

数据类型 下载对象结构, , 
    .成员 下载对象, 未知类型0x70001, , , 
    .成员 对象状态, 整数型, , , 
    .成员 进度框任务索引, 整数型, , , 
    .成员 任务统计框表项索引, 整数型, , , 
    .成员 任务数据, 字节集, , , 
    .成员 任务核心数据, 任务核心数据, , , 
    .成员 任务常规信息, 任务常规信息, , , 

数据类型 安全性结构_, , SECURITY_ATTRIBUTES
    .成员 nLength, 整数型, , , 
    .成员 lpSecurityDescriptor, 整数型, , , 
    .成员 bInheritHandle, 整数型, , , 

.全局变量 下载对象, 下载对象结构, , "0", 当前活动下载对象
.全局变量 界面基础控件, 界面控件基础类, , , 
.全局变量 进度框, 点型进度框类, , , 
.全局变量 系统配置信息, 系统配置, , , 
.全局变量 当前任务信息, 任务常规信息, , , 
.全局变量 当前显示对象序号, 整数型, , , 
.全局变量 当前显示线程序号, 整数型, , , 
.全局变量 下载数据自动保存时间, 整数型, , , 
.全局变量 当前运行任务数, 整数型, , , 
.全局变量 新建或属性, 整数型, , , 1为新建 -1为属性
.全局变量 启动窗口回调函数, 子程序指针, , , 
.全局变量 匿名全局变量_2824, 空白型, , , 

.DLL命令 系统接口_发送消息, 整数型, "", "SendMessageA", , 
    .参数 窗口句柄, 整数型, , 
    .参数 消息, 整数型, , 
    .参数 附加消息1, 整数型, , 
    .参数 附加消息2, 树型框项目信息, , 

.DLL命令 创建一个互斥体_, 整数型, "kernel32.dll", "CreateMutexA", , 
    .参数 互斥体结构, 整数型, , 
    .参数 拥有互斥体, 整数型, , 
    .参数 互斥体对象的名字, 文本型, , 

.DLL命令 获得窗口信息, 子程序指针, "user32.dll", "GetWindowLongA", , 
    .参数 句柄, 整数型, , 
    .参数 索引, 整数型, , 

.DLL命令 设置窗口信息, 整数型, "user32.dll", "SetWindowLongA", , 
    .参数 句柄, 整数型, , 
    .参数 索引, 整数型, , 
    .参数 新值, 子程序指针, , 

.DLL命令 调用旧窗口回调函数, 整数型, "user32.dll", "CallWindowProcA", , 
    .参数 子程序指针, 子程序指针, , 
    .参数 句柄, 整数型, , 
    .参数 消息类型, 整数型, , 
    .参数 参数1, 整数型, , 
    .参数 参数2, 整数型, , 

.DLL命令 注册IE右键, 整数型, "edown.dll", "DllRegisterServer", , 

.DLL命令 设置前景窗口, 逻辑型, "user32.dll", "SetActiveWindow", , SetActiveWindow
    .参数 hWnd, 整数型, , 

.DLL命令 取前景窗口, 整数型, "user32.dll", "GetForegroundWindow", , SetActiveWindow

.DLL命令 设置窗口位置, 空白型, "user32.dll", "SetWindowPos", , 
    .参数 hWnd, 整数型, , 
    .参数 hWndInsertAfter, 整数型, , 
    .参数 X, 整数型, , 
    .参数 Y, 整数型, , 
    .参数 cx, 整数型, , 
    .参数 cy, 整数型, , 
    .参数 uFlags, 整数型, , 

.DLL命令 取窗口线程句柄, 整数型, "user32.dll", "GetWindowThreadProcessId", , 
    .参数 hWnd, 整数型, , 
    .参数 lpdwProcessId, 整数型, , 

.DLL命令 绑定线程输入, 逻辑型, "user32.dll", "AttachThreadInput", , 
    .参数 idAttach, 整数型, , 
    .参数 idAttachTo, 整数型, , 
    .参数 fAttach, 逻辑型, , 

.窗口程序集 启动窗口程序集, , , 

.子程序 _新建数据库_被选择, 空白型, , 


.子程序 __启动窗口_创建完毕, 空白型, , 

加入右键菜单 ()

加入IE工具栏 ()

载入 (悬浮窗口, , 假)

.如果真 (等于 (打开目录管理数据库 (), 假))
    .如果真 (等于 (创建默认目录管理数据库 (), 假))
        信息框 (“创建目录管理数据库失败”, 0, “启动失败”)
        结束 ()
    .如果真结束
    
    
.如果真结束

.判断开始 (等于 (进度框.初始化点型进度框 (0, 0, 0, 0, 9, 10, 1, 1), 假))
    信息框 (“无法载入资源!!”, 0, )
    结束 ()
.默认
    
.判断结束

 ' 打开调试日志文件 ()
初始化函数 ()

赋值 (.左边, 0)
赋值 (.顶边, 0)
赋值 (.高度, 0)
赋值 (.宽度, 0)


界面基础控件.填充界面控件基础类 (_启动窗口, , , , , , , , , , , , 进度框, , , )

界面基础控件.界面控件布局 (#默认界面布局)

界面基础控件.开启任务下载进度框 ()
界面基础控件.开启日志 ()

.子程序 检查命令行参数, 空白型, , 
.局部变量 命令行参数, 文本型, , "0", 

取命令行 (命令行参数)
.如果真 (大于 (取数组成员数 (命令行参数), 0))
    置剪辑板文本 (命令行参数 [1])
    _新建任务_被选择 ()
.如果真结束


.子程序 __启动窗口_尺寸被改变, 空白型, , 
界面基础控件.界面控件布局 (#当前布局)


.子程序 __树型控制框_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 



.子程序 __树型分隔条_被拖动, 空白型, , 
.参数 原位置, 整数型, , 
.参数 目的位置, 整数型, , 

界面基础控件.树型分隔条被拖动 (原位置, 目的位置)

.子程序 _分隔条2_被拖动, 空白型, , 
.参数 原位置, 整数型, , 
.参数 目的位置, 整数型, , 

界面基础控件.任务控制分割条_左右被拖动 (原位置, 目的位置)

.子程序 _分隔条1_被拖动, 空白型, , 
.参数 原位置, 整数型, , 
.参数 目的位置, 整数型, , 

界面基础控件.任务控制分割条_上下被拖动 (原位置, 目的位置)

.子程序 __工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 


界面基础控件.顶部工具条被单击 (按钮索引)

.子程序 _纵向滚动条1_位置被改变, 空白型, , 
输出调试文本 (到文本 (纵向滚动条1.位置))
界面基础控件.进度条滚动条被改变 (.位置)

.子程序 _退出_被选择, 空白型, , 
结束 ()

.子程序 _新建任务_被选择, 空白型, , 
载入新建或属性窗口 (#新建)
.如果真 (等于 (当前任务信息.网址, “”))
    返回 ()
.如果真结束

处理创建任务 (0)


.子程序 _树型框1_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

.如果真 (大于 (.最大化按钮, 0))
    界面基础控件.设目录相关 ()
.如果真结束


.子程序 _树型框1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 句柄, 整数型, , , 
.局部变量 找到位置, 树型框项目信息, , , 

赋值 (找到位置.横向位置, 横向位置)
赋值 (找到位置.纵向位置, 纵向位置)
赋值 (句柄, 系统接口_发送消息 (取窗口句柄 (), 4369, 0, 找到位置)) ' <!!!> 判断是不是在项上。在TVM类消息中有一个TVM_HITTEST消息，发送该消息可以检测控件表面上的某一点，如果该点位于一个项目上，则返回该项目的句柄。
4363.发送信息 (9, 句柄) ' 选择项目。TVM_SELECTITEM的值为9，代表选中；为8代表高亮显示。
.如果真 (大于 (.最大化按钮, 0))
    弹出菜单 ()
.如果真结束

返回 (假)

.子程序 _新建类别_被选择, 空白型, , 
载入 (创建新类别, , 真)

.子程序 _删除类别_被选择, 空白型, , 
载入 (删除类别, , 真)

.子程序 _选项_被选择, 空白型, , 
载入 (选项窗口, , 真)

.子程序 _树型框2_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

.判断开始 (等于 (0.取项目文本 (), “图表/日志”))
    .判断开始 (不等于 (.最大化按钮, 0))
        界面基础控件.线程树节点被选择 ()
    .默认
         ' 图表/日志被选择
        界面基础控件.开启任务下载进度框 ()
    .判断结束
    
.默认
     ' 详细信息相关被选择
.判断结束


.子程序 _超级列表框1_当前表项被改变, 空白型, , 
界面基础控件.任务被选择 ()

.子程序 _时钟1_周期事件, 空白型, , 
.如果真 (是否已创建 (_启动窗口))
    
    时钟处理程序 ()
    
.如果真结束


.子程序 _树型框2_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (0.取项目文本 (), “图表/日志”))
    弹出菜单 ()
.如果真结束


.子程序 _增加线程_被选择, 空白型, , 
增加线程 (当前显示对象序号)

.子程序 _减少线程_被选择, 空白型, , 
删除线程 (当前显示对象序号)

.子程序 _速度限制_被选择, 空白型, , 
载入 (设置速度, , 真)

.子程序 _删除任务_被选择, 空白型, , 
界面基础控件.顶部工具条被单击 (3)

.子程序 _开始_被选择, 空白型, , 
界面基础控件.顶部工具条被单击 (0)

.子程序 _停止_被选择, 空白型, , 
界面基础控件.顶部工具条被单击 (1)

.子程序 _关于_被选择, 空白型, , 
载入 (关于, , 真)

.子程序 __启动窗口_将被销毁, 空白型, , 
保存所有运行任务下载数据 ()
悬浮窗口.销毁 ()

.子程序 _图片框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

跳转 ()

.子程序 _超级列表框1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

界面基础控件.状态框弹出菜单 ()
弹出菜单 ()


.子程序 _开始下载_被选择, 空白型, , 
界面基础控件.顶部工具条被单击 (0)

.子程序 _将网址复制到剪贴板_被选择, 空白型, , 
.局部变量 当前表项, 整数型, , , 
.局部变量 网址, 文本型, , , 

赋值 (当前表项, 界面基础控件.取统计框当前表项 ())
.如果真 (小于 (当前表项, 0))
    返回 ()
.如果真结束

赋值 (网址, 界面基础控件.取指定统计框指定标题 (当前表项, 10))
置剪辑板文本 (网址)

.子程序 _结束下载_被选择, 空白型, , 
界面基础控件.顶部工具条被单击 (1)

.子程序 _全部暂停_被选择, 空白型, , 
.局部变量 任务序号, 整数型, , , 
.局部变量 计次变量, 整数型, , , 

.计次循环首 (取表项数 (), 计次变量)
    赋值 (任务序号, .取表项数值 (.))
    .如果真 (小于 (任务序号, 1))
        返回 ()
    .如果真结束
    停止任务 (任务序号)
.计次循环尾 ()

.子程序 _属性_被选择, 空白型, , 
载入新建或属性窗口 (#属性)

.子程序 _超级列表框2_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _复制_被选择, 空白型, , 
.局部变量 行计次变量, 整数型, , , 
.局部变量 列计次变量, 整数型, , , 
.局部变量 临时文本, 文本型, , , 
.局部变量 列临时文本, 文本型, , , 

.计次循环首 (取表项数 (), 行计次变量)
    .计次循环首 (取列数 (), 列计次变量)
        赋值 (列临时文本, 相加 (列临时文本, “  ”, 相减 (行计次变量, 1).取标题 (相减 (列计次变量, 1))))
    .计次循环尾 ()
    赋值 (临时文本, 相加 (临时文本, 列临时文本, #换行符))
.计次循环尾 ()
置剪辑板文本 (临时文本)

.子程序 _清空_被选择, 空白型, , 
全部删除 ()

.子程序 _类别属性_被选择, 空白型, , 
载入 (类别属性, , 真)


.子程序 __启动窗口_首次激活, 空白型, , 

检查命令行参数 ()
赋值 (启动窗口回调函数, 获得窗口信息 (_启动窗口.取窗口句柄 (), -4))
设置窗口信息 (_启动窗口.取窗口句柄 (), -4, &新窗口回调函数)

.子程序 新窗口回调函数, 整数型, , 
.参数 句柄, 整数型, , 
.参数 消息类型, 整数型, , 
.参数 参数1, 整数型, , 
.参数 参数2, 整数型, , 

.判断开始 (等于 (消息类型, 1107))
     ' 启动线程 (&等待新建函数, )
    等待新建函数 ()
    返回 (0)
.默认
    返回 (调用旧窗口回调函数 (启动窗口回调函数, 句柄, 消息类型, 参数1, 参数2))
.判断结束


.子程序 等待新建函数, 空白型, , 
_新建任务_被选择 ()
返回 ()

.子程序 __启动窗口_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 



.子程序 _程序备注_被选择, 空白型, , 
载入 (程序备注, , 真)

.类模块 界面控件基础类, , , 本源码无版权，但引用决不能去掉易语言的广告条

.程序集变量 启动窗口, 窗口, , , 
.程序集变量 菜单, 未知类型0x30001, , , 
.程序集变量 顶部工具条, 工具条, , , 
.程序集变量 底部状态条, 状态条, , , 
.程序集变量 树型控制框, 树型框, , , 
.程序集变量 树型分隔条, 未知类型0x40003, , , 
.程序集变量 任务控制分割条_上下, 未知类型0x40003, , , 
.程序集变量 任务控制分割条_左右, 未知类型0x40003, , , 
.程序集变量 单个任务信息框, 树型框, , , 
.程序集变量 任务下载统计框, 超级列表框, , , 
.程序集变量 任务详细信息框, 超级列表框, , , 
.程序集变量 日志, 超级列表框, , , 
.程序集变量 任务下载进度框, 点型进度框类, , , 
.程序集变量 广告图片框, 图片框, , , 
.程序集变量 菜单与广告条分隔标签, 标签, , , 
.程序集变量 工具条左端按钮, 按钮, , , 
.程序集变量 当前目录, 文本型, , , 
.程序集变量 当前任务, 整数型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 填充界面控件基础类, 空白型, 公开, 
.参数 外部窗口控件_启动窗口, 窗口, , 
.参数 外部菜单控件_菜单, 未知类型0x30001, , 
.参数 外部工具条控件_顶部工具条, 工具条, , 
.参数 外部状态条控件_底部状态条, 状态条, , 
.参数 外部树型框控件_树型控制框, 树型框, , 
.参数 外部分隔条控件_树型分隔条, 未知类型0x40003, , 
.参数 外部分隔条控件_任务控制分隔条_上下, 未知类型0x40003, , 
.参数 外部分隔条控件_任务控制分隔条_左右, 未知类型0x40003, , 
.参数 外部超级列表框控件_单个任务信息框, 树型框, , 
.参数 外部超级列表框控件_任务下载统计框, 超级列表框, , 
.参数 外部超级列表框控件_任务详细信息框, 超级列表框, , 
.参数 外部超级列表框控件_日志, 超级列表框, , 
.参数 点型进度框对象, 点型进度框类, , 
.参数 外部图片框控件_广告图片框, 图片框, , 
.参数 外部标签控件_菜单与广告条分隔标签, 标签, , 
.参数 外部按钮控件_工具条左端标签, 按钮, , 

赋值 (启动窗口, 外部窗口控件_启动窗口)
赋值 (菜单, 外部菜单控件_菜单)
赋值 (顶部工具条, 外部工具条控件_顶部工具条)
赋值 (底部状态条, 外部状态条控件_底部状态条)
赋值 (树型控制框, 外部树型框控件_树型控制框)
赋值 (树型分隔条, 外部分隔条控件_树型分隔条)
赋值 (任务控制分割条_上下, 外部分隔条控件_任务控制分隔条_上下)
赋值 (任务控制分割条_左右, 外部分隔条控件_任务控制分隔条_左右)
赋值 (单个任务信息框, 外部超级列表框控件_单个任务信息框)
赋值 (任务下载统计框, 外部超级列表框控件_任务下载统计框)
赋值 (任务详细信息框, 外部超级列表框控件_任务详细信息框)
赋值 (日志, 外部超级列表框控件_日志)
赋值 (任务下载进度框, 点型进度框对象)
赋值 (广告图片框, 外部图片框控件_广告图片框)
赋值 (菜单与广告条分隔标签, 外部标签控件_菜单与广告条分隔标签)
赋值 (工具条左端按钮, 外部按钮控件_工具条左端标签)

设置树型控制框 ()
清空对象 ()
初始化创建活动任务数组 ()
设置正在下载任务框 ()
设置单个任务信息框 ()

.子程序 界面控件布局, 空白型, 公开, 
.参数 界面布局方案, 整数型, , 

.判断开始 (等于 (界面布局方案, #默认界面布局))
    设置界面布局 (200, 200, 100)
.判断 (等于 (界面布局方案, #当前布局))
    设置界面布局 (树型控制框.宽度, 任务下载统计框.删除线, 单个任务信息框.宽度)
.默认
    
.判断结束


.子程序 设置界面布局, 空白型, , 
.参数 宽度基础, 整数型, , 以树形控制框宽度作为宽度基础
.参数 高度基础, 整数型, , 以任务下载统计框作为高度基础
.参数 单个任务信息框宽度, 整数型, , 单个任务信息框宽度也是一个需要定位的值


 ' 设置菜单与广告条分隔标签位置
 ' 因为菜单不属于客户区所以菜单与广告条分隔标签的顶边属性直接设置为0
赋值 (菜单与广告条分隔标签.边框, 3)
赋值 (菜单与广告条分隔标签.顶边, 0)
赋值 (菜单与广告条分隔标签.高度, 2)
赋值 (菜单与广告条分隔标签.左边, 0)
赋值 (菜单与广告条分隔标签.宽度, 启动窗口.宽度)

 ' 设置广告图片框位置及顶部工具框位置
赋值 (广告图片框.顶边, 相加 (菜单与广告条分隔标签.顶边, 菜单与广告条分隔标签.高度))
赋值 (广告图片框.高度, 58)
赋值 (广告图片框.左边, 0)
赋值 (广告图片框.宽度, 启动窗口.宽度)


赋值 (顶部工具条.选中, 相加 (广告图片框.顶边, 广告图片框.高度))
赋值 (顶部工具条.可视, 28)
赋值 (顶部工具条.标题, 0)
赋值 (顶部工具条.禁止, 启动窗口.宽度)

 ' 设置工具条左端标签
赋值 (工具条左端按钮.禁止, 真)
赋值 (工具条左端按钮.顶边, 相加 (顶部工具条.选中, 3))
赋值 (工具条左端按钮.高度, 相减 (顶部工具条.可视, 6))
赋值 (工具条左端按钮.左边, 相加 (顶部工具条.标题, 1))
赋值 (工具条左端按钮.宽度, 3)

 ' 设置树型控制框位置
 ' 树型控制框的宽度为30%
赋值 (树型控制框.顶边, 相加 (顶部工具条.选中, 顶部工具条.可视))
赋值 (树型控制框.高度, 相减 (启动窗口.取用户区高度 (), 广告图片框.高度, 顶部工具条.可视, 底部状态条.))
赋值 (树型控制框.左边, 0)
赋值 (树型控制框.宽度, 宽度基础)

 ' 设置树型分隔条位置
赋值 (树型分隔条., 树型控制框.顶边)
赋值 (树型分隔条., 树型控制框.高度)
赋值 (树型分隔条., 树型控制框.宽度)
赋值 (树型分隔条., #分隔条宽度)

 ' 设置任务下载统计框位置
赋值 (任务下载统计框.加粗, 树型控制框.顶边)
赋值 (任务下载统计框.删除线, 高度基础)
赋值 (任务下载统计框.角度, 相加 (树型分隔条., #分隔条底案宽度))
赋值 (任务下载统计框.倾斜, 相减 (启动窗口.宽度, 树型控制框.宽度, #分隔条底案宽度, 5))

 ' 设置任务分割条_上下位置
赋值 (任务控制分割条_上下., 相加 (任务下载统计框.加粗, 任务下载统计框.删除线))
赋值 (任务控制分割条_上下., #分隔条宽度)
赋值 (任务控制分割条_上下., 相加 (树型分隔条., #分隔条底案宽度))
赋值 (任务控制分割条_上下., 任务下载统计框.倾斜)

 ' 设置单个任务信息框位置
赋值 (单个任务信息框.顶边, 相加 (任务控制分割条_上下., #分隔条底案宽度))
赋值 (单个任务信息框.高度, 相减 (树型控制框.高度, 任务下载统计框.删除线, #分隔条底案宽度, 2))
赋值 (单个任务信息框.左边, 任务下载统计框.角度)
赋值 (单个任务信息框.宽度, 单个任务信息框宽度)

 ' 设置任务控制分割条_左右位置
赋值 (任务控制分割条_左右., 单个任务信息框.顶边)
赋值 (任务控制分割条_左右., 单个任务信息框.高度)
赋值 (任务控制分割条_左右., 相加 (单个任务信息框.左边, 单个任务信息框.宽度))
赋值 (任务控制分割条_左右., #分隔条宽度)


底部状态条.置宽度 (0, 相减 (启动窗口.宽度, 180))
底部状态条.置宽度 (1, 90)
底部状态条.置宽度 (2, 90)

 ' 设置任务下载信息画板位置
.判断开始 (等于 (任务下载进度框.取禁止属性 (), 假))
    任务下载进度框.设顶边 (单个任务信息框.顶边)
    任务下载进度框.设左边 (相加 (任务控制分割条_左右., #分隔条底案宽度))
    任务下载进度框.设宽度 (相减 (启动窗口.宽度, 树型控制框.宽度, 单个任务信息框.宽度, 相乘 (#分隔条底案宽度, 2)))
     ' 因为进度框的滚动条的位置变化是因为调用了进度框的设高度方法后才会改变，所以这里最后调用本命令，以防止有写进度条的属性还没有改变就调用设置滚动条的位置
    任务下载进度框.设高度 (单个任务信息框.高度)
    任务下载进度框.重画 ()
    
.判断 (等于 (任务详细信息框.字体名称, 假))
     ' 设置任务详细信息框位置
    赋值 (任务详细信息框.加粗, 单个任务信息框.顶边)
    赋值 (任务详细信息框.删除线, 单个任务信息框.高度)
    赋值 (任务详细信息框.角度, 相加 (任务控制分割条_左右., #分隔条底案宽度))
    赋值 (任务详细信息框.倾斜, 相减 (启动窗口.宽度, 树型控制框.宽度, 单个任务信息框.宽度, 相乘 (#分隔条底案宽度, 2)))
    
.默认
     ' 日志
    赋值 (日志.加粗, 单个任务信息框.顶边)
    赋值 (日志.删除线, 单个任务信息框.高度)
    赋值 (日志.角度, 相加 (任务控制分割条_左右., #分隔条底案宽度))
    赋值 (日志.倾斜, 相减 (启动窗口.宽度, 树型控制框.宽度, 单个任务信息框.宽度, 相乘 (#分隔条底案宽度, 2)))
    
.判断结束


.子程序 开启任务下载进度框, 空白型, 公开, 开启画板后任务详细信息自动关闭
任务下载进度框.禁止为假 ()
任务下载进度框.可视为真 ()
赋值 (任务详细信息框.字体名称, 真)
赋值 (任务详细信息框.字体大小, 假)
赋值 (日志.字体名称, 真)
赋值 (日志.字体大小, 假)
设置界面布局 (树型控制框.宽度, 任务下载统计框.删除线, 单个任务信息框.宽度)
任务下载进度框.重画 ()


.子程序 开启任务详细信息框, 空白型, 公开, 关闭画板后任务详细信息自动打开
赋值 (任务详细信息框.字体名称, 假)
赋值 (任务详细信息框.字体大小, 真)
任务下载进度框.禁止为真 ()
任务下载进度框.可视为假 ()
赋值 (日志.字体名称, 真)
赋值 (日志.字体大小, 假)
设置界面布局 (树型控制框.宽度, 任务下载统计框.删除线, 单个任务信息框.宽度)

任务详细信息框.置标题 (0, 1, “”)
任务详细信息框.置标题 (1, 1, “”)
任务详细信息框.置标题 (2, 1, “”)
任务详细信息框.置标题 (3, 1, “”)
任务详细信息框.置标题 (4, 1, “”)
任务详细信息框.置标题 (5, 1, “”)
任务详细信息框.置标题 (6, 1, “”)
任务详细信息框.置标题 (7, 1, “”)
任务详细信息框.置标题 (8, 1, “”)


.子程序 开启日志, 空白型, 公开, 
赋值 (日志.字体名称, 假)
赋值 (日志.字体大小, 真)
任务下载进度框.禁止为真 ()
任务下载进度框.可视为假 ()
赋值 (任务详细信息框.字体名称, 真)
赋值 (任务详细信息框.字体大小, 假)
设置界面布局 (树型控制框.宽度, 任务下载统计框.删除线, 单个任务信息框.宽度)


.子程序 日志框是否可视, 逻辑型, 公开, 可视为真 不可视为假
返回 (日志.字体大小)

.子程序 树型分隔条被拖动, 空白型, 公开, 
.参数 原位置, 整数型, , 
.参数 目的位置, 整数型, , 

.局部变量 移动偏移, 整数型, , , 

.如果真 (小于 (目的位置, 8))
    赋值 (目的位置, 8)
.如果真结束
.如果真 (大于 (目的位置, 相减 (_启动窗口., 20)))
    赋值 (目的位置, 相减 (启动窗口.宽度, 20))
.如果真结束

赋值 (移动偏移, 相减 (目的位置, 原位置))


赋值 (树型分隔条., 目的位置)
赋值 (树型控制框.宽度, 相加 (树型控制框.宽度, 移动偏移))


赋值 (任务下载统计框.角度, 相加 (树型分隔条., #分隔条底案宽度))
赋值 (任务下载统计框.倾斜, 相减 (相加 (任务下载统计框.倾斜, 原位置), 目的位置))

赋值 (任务控制分割条_上下., 任务下载统计框.角度)
赋值 (任务控制分割条_上下., 任务下载统计框.倾斜)

赋值 (单个任务信息框.左边, 任务下载统计框.角度)

赋值 (任务控制分割条_左右., 相加 (单个任务信息框.左边, 单个任务信息框.宽度))

 ' 因为某些控件设置位置后会出现位置混乱，所以需要重画一下，下同
单个任务信息框.重画 ()

.判断开始 (等于 (任务下载进度框.取禁止属性 (), 假))
    任务下载进度框.设左边 (相加 (任务控制分割条_左右., #分隔条底案宽度))
    任务下载进度框.设宽度 (相减 (启动窗口.宽度, 树型控制框.宽度, 单个任务信息框.宽度, 相乘 (#分隔条底案宽度, 2)))
    任务下载进度框.重画滚动条 ()
    任务下载进度框.重画 ()
    
.判断 (等于 (任务详细信息框.字体名称, 假))
    赋值 (任务详细信息框.角度, 相加 (任务控制分割条_左右., #分隔条底案宽度))
    赋值 (任务详细信息框.倾斜, 相减 (启动窗口.宽度, 树型控制框.宽度, 单个任务信息框.宽度, 相乘 (#分隔条底案宽度, 2)))
    任务详细信息框.重画 ()
.默认
    赋值 (日志.角度, 相加 (任务控制分割条_左右., #分隔条底案宽度))
    赋值 (日志.倾斜, 相减 (启动窗口.宽度, 树型控制框.宽度, 单个任务信息框.宽度, 相乘 (#分隔条底案宽度, 2)))
    日志.重画 ()
    
.判断结束


.子程序 任务控制分割条_左右被拖动, 空白型, 公开, 
.参数 原位置, 整数型, , 
.参数 目的位置, 整数型, , 

.局部变量 移动偏移, 整数型, , , 

.如果真 (小于 (目的位置, 相加 (单个任务信息框.左边, 8)))
    赋值 (目的位置, 相加 (单个任务信息框.左边, 8))
.如果真结束
.如果真 (大于 (目的位置, 相减 (_启动窗口., 20)))
    赋值 (目的位置, 相减 (启动窗口.宽度, 20))
.如果真结束

赋值 (移动偏移, 相减 (目的位置, 原位置))

赋值 (任务控制分割条_左右., 目的位置)
赋值 (单个任务信息框.宽度, 相减 (任务控制分割条_左右., 单个任务信息框.左边))

.判断开始 (等于 (任务下载进度框.取禁止属性 (), 假))
    任务下载进度框.设左边 (相加 (任务控制分割条_左右., #分隔条底案宽度))
    任务下载进度框.设宽度 (相减 (启动窗口.宽度, 树型控制框.宽度, 单个任务信息框.宽度, 相乘 (#分隔条底案宽度, 2)))
    
    任务下载进度框.重画滚动条 ()
    任务下载进度框.重画 ()
    
.判断 (等于 (任务详细信息框.字体名称, 假))
    赋值 (任务详细信息框.角度, 相加 (任务控制分割条_左右., #分隔条底案宽度))
    赋值 (任务详细信息框.倾斜, 相减 (启动窗口.宽度, 树型控制框.宽度, 单个任务信息框.宽度, 相乘 (#分隔条底案宽度, 2)))
    任务详细信息框.重画 ()
.默认
    赋值 (日志.角度, 相加 (任务控制分割条_左右., #分隔条底案宽度))
    赋值 (日志.倾斜, 相减 (启动窗口.宽度, 树型控制框.宽度, 单个任务信息框.宽度, 相乘 (#分隔条底案宽度, 2)))
    日志.重画 ()
.判断结束


.子程序 任务控制分割条_上下被拖动, 空白型, 公开, 
.参数 原位置, 空白型, , 
.参数 目的位置, 空白型, , 

.局部变量 移动偏移, 整数型, , , 

.如果真 (小于 (目的位置, 相加 (顶部工具条.选中, 顶部工具条.可视, 8)))
    赋值 (目的位置, 相加 (顶部工具条.选中, 顶部工具条.可视, 8))
.如果真结束
.如果真 (大于 (目的位置, 相减 (启动窗口.取用户区高度 (), 12)))
    赋值 (目的位置, 相减 (启动窗口.取用户区高度 (), 12))
.如果真结束

赋值 (移动偏移, 相加 (原位置, 目的位置))

赋值 (任务控制分割条_上下., 目的位置)
赋值 (任务下载统计框.删除线, 相减 (任务控制分割条_上下., 任务下载统计框.加粗))

赋值 (单个任务信息框.顶边, 相加 (任务控制分割条_上下., #分隔条底案宽度))
赋值 (单个任务信息框.高度, 相减 (相加 (树型控制框.顶边, 树型控制框.高度), 单个任务信息框.顶边, 1))

单个任务信息框.重画 ()

赋值 (任务控制分割条_左右., 单个任务信息框.顶边)
赋值 (任务控制分割条_左右., 单个任务信息框.高度)

.判断开始 (等于 (任务下载进度框.取禁止属性 (), 假))
    任务下载进度框.设顶边 (单个任务信息框.顶边)
    任务下载进度框.设高度 (单个任务信息框.高度)
    任务下载进度框.重画 ()
    
.判断 (等于 (任务详细信息框.字体名称, 假))
    赋值 (任务详细信息框.加粗, 单个任务信息框.顶边)
    赋值 (任务详细信息框.删除线, 单个任务信息框.高度)
    任务详细信息框.重画 ()
.默认
    赋值 (日志.加粗, 单个任务信息框.顶边)
    赋值 (日志.删除线, 单个任务信息框.高度)
    日志.重画 ()
.判断结束


.子程序 设置树型控制框, 空白型, 公开, 
.局部变量 目录个数, 整数型, , , 
.局部变量 记次变量, 整数型, , , 
.局部变量 目录名, 文本型, , , 
.局部变量 项目数值, 整数型, , , 
.局部变量 默认目录, 文本型, , , 

树型控制框.清空 ()
置目录数据库 ()
树型控制框.加入项目 (“易语言下载快车 v1.0”, 11, 11, 0)
到首记录 ()
置目录数据库 ()

赋值 (目录个数, 取目录个数 ())
.计次循环首 (目录个数, 记次变量)
    赋值 (项目数值, 相加 (项目数值, 1))
    赋值 (目录名, 读 (“目录名称”))
    .判断开始 (等于 (目录名, “正在下载”))
        树型控制框.加入项目 (0, 目录名, 1, 1, 项目数值)
    .判断 (等于 (目录名, “已删除”))
        树型控制框.加入项目 (0, 目录名, 5, 5, 项目数值)
    .默认
        树型控制框.加入项目 (0, 目录名, 2, 2, 项目数值)
    .判断结束
    .如果真 (等于 (打开下载信息数据库 (目录名), 假))
        赋值 (默认目录, 相加 (取运行目录 (), “\下载文件”))
        创建目录 (默认目录)
        创建目录记录 (目录名, 默认目录, 假)
        .如果真 (等于 (打开下载信息数据库 (目录名), 假))
            信息框 (“打开失败，程序无法继续运行”, 0, )
            结束 ()
        .如果真结束
        
    .如果真结束
    置目录数据库 ()
    跳过 ()
.计次循环尾 ()

树型控制框.扩展 (0)
赋值 (树型控制框.最大化按钮, 1)


.子程序 设置普通任务下载统计框, 空白型, 公开, 
.局部变量 文件个数, 整数型, , , 
.局部变量 记次变量, 整数型, , , 
.局部变量 表项位置, 整数型, , , 
.局部变量 图标, 整数型, , , 
.局部变量 大小, 整数型, , , 
.局部变量 完成数, 整数型, , , 

任务下载统计框.全部删除 ()
.如果真 (等于 (置下载信息数据库 (当前目录), 假))
    信息框 (相加 (“操作(”, 到文本 (当前目录), “.edb)失败 错误原因:”, 取错误信息 ()), 0, “错误”)
    结束 ()
.如果真结束
到首记录 ()
赋值 (文件个数, 取文件个数 ())
.计次循环首 (文件个数, 记次变量)
    设置下载统计框标题 (-1, 读 (“文件名”), 读 (“大小”), 读 (“完成数”), 读 (“块数”), 0, 读 (“URL”), 读 (“创建时间”), 读 (“完成时间”), 读 (“注释”), 读 (“文件状态”))
    跳过 ()
.计次循环尾 ()

.子程序 初始化创建活动任务数组, 空白型, 公开, 
.局部变量 文件个数, 整数型, , , 
.局部变量 记次变量, 整数型, , , 
.局部变量 表项位置, 整数型, , , 
.局部变量 图标, 整数型, , , 
.局部变量 匿名局部变量_1735, 空白型, , , 
.局部变量 文件名, 文本型, , , 
.局部变量 文件路径, 文本型, , , 
.局部变量 大小, 整数型, , , 
.局部变量 完成数, 整数型, , , 
.局部变量 块数, 整数型, , , 
.局部变量 网址, 文本型, , , 
.局部变量 创建时间, 日期时间型, , , 
.局部变量 完成时间, 日期时间型, , , 
.局部变量 注释, 文本型, , , 
.局部变量 文件状态, 整数型, , , 
.局部变量 任务数据, 字节集, , , 
.局部变量 块记次变量, 整数型, , , 
.局部变量 块开始位置, 整数型, , , 
.局部变量 块结束位置, 整数型, , , 
.局部变量 保存目录, 文本型, , , 
.局部变量 下载对象结构, 下载对象结构, , , 

任务下载统计框.全部删除 ()
.如果真 (等于 (置下载信息数据库 (当前目录), 假))
    信息框 (相加 (“操作(”, 到文本 (当前目录), “.edb)失败 错误原因:”, 取错误信息 ()), 0, “错误”)
    结束 ()
.如果真结束
到首记录 ()
赋值 (文件个数, 取文件个数 ())
.计次循环首 (文件个数, 记次变量)
    赋值 (文件名, 读 (“文件名”))
    赋值 (文件路径, 读 (“文件路径”))
    赋值 (大小, 读 (“大小”))
    赋值 (完成数, 读 (“完成数”))
    赋值 (块数, 读 (“块数”))
    赋值 (网址, 读 (“URL”))
    赋值 (创建时间, 读 (“创建时间”))
    赋值 (完成时间, 读 (“完成时间”))
    赋值 (注释, 读 (“注释”))
    赋值 (任务数据, 读 (“任务信息”))
    赋值 (保存目录, 读 (“保存目录”))
    赋值 (文件状态, #文件状态图标_未下完状态)
    
    赋值 (下载对象结构.对象状态, #已停止)
    赋值 (下载对象结构.任务数据, 任务数据)
    赋值 (下载对象结构.任务核心数据.对象信息, 0)
    赋值 (下载对象结构.任务常规信息.文件名, 文件名)
    赋值 (下载对象结构.任务常规信息.文件路径, 文件路径)
    赋值 (下载对象结构.任务常规信息.总长度, 大小)
    赋值 (下载对象结构.任务常规信息.完成数, 完成数)
    赋值 (下载对象结构.任务常规信息.总块数, 块数)
    赋值 (下载对象结构.任务常规信息.网址, 网址)
    赋值 (下载对象结构.任务常规信息.创建时间, 创建时间)
    赋值 (下载对象结构.任务常规信息.完成时间, 完成时间)
    赋值 (下载对象结构.任务常规信息.注释, 注释)
    赋值 (下载对象结构.任务常规信息.文件状态, 文件状态)
    赋值 (下载对象结构.任务常规信息.保存目录, 保存目录)
    赋值 (下载对象结构.进度框任务索引, 0)
    赋值 (下载对象结构.任务统计框表项索引, 0)
    
    清除数组 (下载对象结构.任务核心数据.线程信息数组)
    
    赋值 (下载对象结构.进度框任务索引, 任务下载进度框.增加任务 (大小, 相减 (系统配置信息.接收大小, 1)))
    赋值 (块数, 下载对象结构.未知支持库函数_31 (.下载对象, 任务数据, 3, 0))
    .变量循环首 (1, 块数, 1, 块记次变量)
        赋值 (块开始位置, 下载对象结构.未知支持库函数_31 (.下载对象, 任务数据, 4, 块记次变量))
        赋值 (块结束位置, 相加 (块开始位置, 下载对象结构.未知支持库函数_31 (.下载对象, 任务数据, 6, 块记次变量)))
        任务下载进度框.改变进度 (下载对象结构.进度框任务索引, 块开始位置, 块结束位置, #已下载点, #正下载点)
    .变量循环尾 ()
    
    
    加入成员 (下载对象, 下载对象结构)
    
    跳过 ()
.计次循环尾 ()


.子程序 设置正在下载任务框, 空白型, 公开, 
.局部变量 记次变量, 整数型, , , 
.局部变量 正在下载对象个数, 整数型, , , 

任务下载统计框.全部删除 ()
赋值 (正在下载对象个数, 取数组成员数 (下载对象))
.变量循环首 (1, 正在下载对象个数, 1, 记次变量)
    .如果真 (不等于 (下载对象 [记次变量], 对象状态, #已删除))
        赋值 (下载对象 [记次变量], 任务统计框表项索引, 设置下载统计框标题 (记次变量, 下载对象 [记次变量], 任务常规信息.文件名, 下载对象 [记次变量], 任务常规信息.总长度, 下载对象 [记次变量], 任务常规信息.完成数, 下载对象 [记次变量], 任务常规信息.总块数, 0, 下载对象 [记次变量], 任务常规信息.网址, 下载对象 [记次变量], 任务常规信息.创建时间, 下载对象 [记次变量], 任务常规信息.完成时间, 下载对象 [记次变量], 任务常规信息.注释, 下载对象 [记次变量], 任务常规信息.文件状态))
    .如果真结束
    
.变量循环尾 ()


.子程序 设置单个任务信息框, 空白型, , 
单个任务信息框.清空 ()
.判断开始 (等于 (当前目录, “正在下载”))
    单个任务信息框.加入项目 (“图表/日志”, 7, , )
.默认
    单个任务信息框.加入项目 (“详细信息”, 9, , )
.判断结束


.子程序 刷新方式增加线程树节点, 空白型, 公开, 如果线程号为空则在最后增加一个新的，如果不为空则使用线程号，线程树包含在单个任务信息框中
.参数 对象序号, 整数型, , 
.参数 线程序号, 整数型, , 

单个任务信息框.加入项目 (0, 相加 (“线程”, 到文本 (线程序号)), 8, 8, 线程序号)

单个任务信息框.扩展 (0)

.子程序 删除线程树节点, 空白型, , 
.参数 对象序号, 整数型, , 
.参数 线程序号, 整数型, , 

.局部变量 有效线程数, 整数型, , , 
.局部变量 记次变量, 整数型, , , 
.局部变量 线程号, 整数型, , , 

赋值 (有效线程数, 取有效线程数 (对象序号))
.变量循环首 (1, 有效线程数, 1, 记次变量)
    赋值 (线程号, 单个任务信息框.取项目数值 (记次变量))
    .如果真 (等于 (线程号, 线程序号))
        单个任务信息框.删除项目 (记次变量)
    .如果真结束
    
.变量循环尾 ()

.子程序 设置下载统计框标题, 整数型, 公开, 
.参数 对象序号, 整数型, , 
.参数 文件名, 文本型, , 
.参数 大小, 整数型, , 
.参数 完成数, 整数型, , 
.参数 总块数, 整数型, , 
.参数 当前完成块数, 整数型, , 
.参数 网址, 文本型, , 
.参数 创建时间, 日期时间型, , 
.参数 完成时间, 日期时间型, , 
.参数 注释, 文本型, , 
.参数 文件状态, 整数型, , 

.局部变量 表项索引, 整数型, , , 

赋值 (表项索引, 任务下载统计框.插入表项 (文件状态, , , 对象序号))

任务下载统计框.置标题 (表项索引, 1, 文件名)
任务下载统计框.置标题 (表项索引, 2, 到文本 (大小))
任务下载统计框.置标题 (表项索引, 3, 到文本 (完成数))
任务下载统计框.置标题 (表项索引, 8, 相加 (到文本 (当前完成块数), “/”, 到文本 (总块数)))
任务下载统计框.置标题 (表项索引, 10, 网址)
任务下载统计框.置标题 (表项索引, 11, 到文本 (创建时间))
任务下载统计框.置标题 (表项索引, 12, 到文本 (完成时间))
任务下载统计框.置标题 (表项索引, 13, 注释)
返回 (表项索引)

.子程序 置任务下载统计框_文件状态图标, 空白型, 公开, 
.参数 表项索引, 整数型, , 
.参数 文件状态, 整数型, , 

.如果真 (等于 (当前目录, “正在下载”))
    任务下载统计框.置图片 (表项索引, 0, 文件状态)
    
.如果真结束


.子程序 置任务下载统计框_文件名, 空白型, 公开, 
.参数 表项索引, 整数型, , 
.参数 文件名, 文本型, , 

.如果真 (等于 (当前目录, “正在下载”))
    任务下载统计框.置标题 (表项索引, 1, 文件名)
.如果真结束


.子程序 置任务下载统计框_大小, 空白型, 公开, 
.参数 表项索引, 整数型, , 
.参数 大小, 整数型, , 

.如果真 (等于 (当前目录, “正在下载”))
    任务下载统计框.置标题 (表项索引, 2, 到文本 (大小))
    
.如果真结束


.子程序 置任务下载统计框_完成数, 空白型, 公开, 
.参数 表项索引, 整数型, , 
.参数 完成数, 整数型, , 

 ' .如果真 (等于 (当前目录, “正在下载”))
    任务下载统计框.置标题 (表项索引, 3, 到文本 (完成数))
    
.如果真结束


.子程序 置任务下载统计框_百分比, 空白型, 公开, 
.参数 表项索引, 整数型, , 
.参数 百分比, 整数型, , 

.如果真 (等于 (当前目录, “正在下载”))
    任务下载统计框.置标题 (表项索引, 4, 相加 (到文本 (百分比), “%”))
    
.如果真结束


.子程序 置任务下载统计框_用时, 空白型, 公开, 
.参数 表项索引, 整数型, , 
.参数 用时, 整数型, , 

.局部变量 小时, 整数型, , , 
.局部变量 分, 整数型, , , 
.局部变量 秒, 整数型, , , 
.局部变量 时间, 文本型, , , 

.如果真 (等于 (当前目录, “正在下载”))
    赋值 (小时, 整除 (用时, 3600))
    赋值 (分, 整除 (求余数 (用时, 3600), 60))
    赋值 (秒, 求余数 (用时, 3600, 60))
    .判断开始 (大于 (小时, 9))
        赋值 (时间, 相加 (到文本 (小时), “:”))
    .默认
        赋值 (时间, 相加 (“0”, 到文本 (小时), “:”))
    .判断结束
    .判断开始 (大于 (分, 9))
        赋值 (时间, 相加 (时间, 到文本 (分), “:”))
    .默认
        赋值 (时间, 相加 (时间, “0”, 到文本 (分), “:”))
    .判断结束
    .判断开始 (大于 (秒, 9))
        赋值 (时间, 相加 (时间, 到文本 (秒)))
    .默认
        赋值 (时间, 相加 (时间, “0”, 到文本 (秒)))
    .判断结束
    任务下载统计框.置标题 (表项索引, 5, 时间)
    
.如果真结束



.子程序 置任务下载统计框_剩余时间, 空白型, 公开, 
.参数 表项索引, 整数型, , 
.参数 剩余时间, 整数型, , 

.局部变量 小时, 整数型, , , 
.局部变量 分, 整数型, , , 
.局部变量 秒, 整数型, , , 
.局部变量 时间, 文本型, , , 

.如果真 (等于 (当前目录, “正在下载”))
    赋值 (小时, 整除 (剩余时间, 3600))
    赋值 (分, 整除 (求余数 (剩余时间, 3600), 60))
    赋值 (秒, 求余数 (剩余时间, 3600, 60))
    .判断开始 (大于 (小时, 9))
        赋值 (时间, 相加 (到文本 (小时), “:”))
    .默认
        赋值 (时间, 相加 (“0”, 到文本 (小时), “:”))
    .判断结束
    .判断开始 (大于 (分, 9))
        赋值 (时间, 相加 (时间, 到文本 (分), “:”))
    .默认
        赋值 (时间, 相加 (时间, “0”, 到文本 (分), “:”))
    .判断结束
    .判断开始 (大于 (秒, 9))
        赋值 (时间, 相加 (时间, 到文本 (秒)))
    .默认
        赋值 (时间, 相加 (时间, “0”, 到文本 (秒)))
    .判断结束
    
    任务下载统计框.置标题 (表项索引, 6, 时间)
    
.如果真结束



.子程序 置任务下载统计框_速度, 空白型, 公开, 
.参数 表项索引, 整数型, , 
.参数 速度, 整数型, , 

.如果真 (等于 (当前目录, “正在下载”))
    任务下载统计框.置标题 (表项索引, 7, 到文本 (速度))
    
.如果真结束


.子程序 置任务下载统计框_块数, 空白型, 公开, 
.参数 表项索引, 整数型, , 
.参数 总块数, 整数型, , 
.参数 活动块数, 整数型, , 

.如果真 (等于 (当前目录, “正在下载”))
    任务下载统计框.置标题 (表项索引, 8, 相加 (到文本 (活动块数), “/”, 到文本 (总块数)))
    
.如果真结束



.子程序 置任务下载统计框_重试, 空白型, 公开, 
.参数 表项索引, 整数型, , 
.参数 重试, 整数型, , 

.如果真 (等于 (当前目录, “正在下载”))
    任务下载统计框.置标题 (表项索引, 9, 到文本 (重试))
    
.如果真结束


.子程序 置任务下载统计框_网址, 空白型, 公开, 
.参数 表项索引, 整数型, , 
.参数 网址, 文本型, , 

.如果真 (等于 (当前目录, “正在下载”))
    任务下载统计框.置标题 (表项索引, 10, 网址)
    
.如果真结束


.子程序 置任务下载统计框_创建时间, 空白型, 公开, 
.参数 表项索引, 整数型, , 
.参数 创建时间, 日期时间型, , 

.如果真 (等于 (当前目录, “正在下载”))
    任务下载统计框.置标题 (表项索引, 11, 到文本 (创建时间))
    
.如果真结束


.子程序 置任务下载统计框_完成时间, 空白型, 公开, 
.参数 表项索引, 整数型, , 
.参数 完成时间, 日期时间型, , 

.如果真 (等于 (当前目录, “正在下载”))
    任务下载统计框.置标题 (表项索引, 12, 到文本 (完成时间))
    
.如果真结束


.子程序 置任务下载统计框_注释, 空白型, 公开, 
.参数 表项索引, 整数型, , 
.参数 注释, 文本型, , 

.如果真 (等于 (当前目录, “正在下载”))
    任务下载统计框.置标题 (表项索引, 13, 注释)
    
.如果真结束


.子程序 进度条滚动条被改变, 空白型, 公开, 
.参数 位置, 整数型, , 

任务下载进度框.滚动条被位置改变 (位置)

.子程序 顶部工具条被单击, 空白型, 公开, 
.参数 按钮索引, 整数型, , 

.局部变量 表项索引, 整数型, , "0", 
.局部变量 文件名, 文本型, , , 
.局部变量 任务序号, 整数型, , , 
.局部变量 任务参数, 未知类型0x70004, , , 
.局部变量 数据, 字节集, , , 

.判断开始 (等于 (按钮索引, 0))
     ' 非常相似与创建新任务
    .如果真 (等于 (任务下载统计框., -1))
        返回 ()
    .如果真结束
    
    赋值 (文件名, 任务下载统计框.取标题 (任务下载统计框., 1))
    处理创建任务 (3, 文件名)
    
.判断 (等于 (按钮索引, 1))
    
    赋值 (任务序号, 任务下载统计框.取表项数值 (任务下载统计框.))
    .如果真 (小于 (任务序号, 1))
        返回 ()
    .如果真结束
    
    停止任务 (任务序号)
.判断 (等于 (按钮索引, 2))
    _新建任务_被选择 ()
.判断 (等于 (按钮索引, 3))
    .如果真 (等于 (任务下载统计框., -1))
        返回 ()
    .如果真结束
    
    赋值 (文件名, 任务下载统计框.取标题 (任务下载统计框., 1))
    赋值 (任务序号, 任务下载统计框.取表项数值 (任务下载统计框.))
    
    .判断开始 (等于 (当前目录, “正在下载”))
        
        .如果真 (等于 (任务序号, -1))
            返回 ()
            
        .如果真结束
        
        .如果真 (等于 (下载对象 [任务序号], 对象状态, #正运行))
            .如果真 (等于 (信息框 (“任务正在下载，是否删除?”, #是否钮, “提示”), #否钮))
                返回 ()
            .如果真结束
            下载对象.未知支持库函数_20 ( [任务序号], 下载对象, 数据, 1)
        .如果真结束
        移动任务记录 (当前目录, 文件名, “已删除”, 任务序号)
        删除任务 (任务序号)
        设置正在下载任务框 ()
        刷新日志树 ()
        界面基础控件.清空进度框 ()
        界面基础控件.清空日志框 ()
        
    .判断 (等于 (当前目录, “已删除”))
        删除任务记录 (当前目录, 文件名)
        设目录相关 ()
    .默认
        移动任务记录 (当前目录, 文件名, “已删除”, 任务序号)
        设目录相关 ()
    .判断结束
    
.判断 (等于 (按钮索引, 4))
    载入新建或属性窗口 (-1)
.判断 (等于 (按钮索引, 5))
    载入 (选项窗口, , 真)
    
.判断 (等于 (按钮索引, 6))
    载入 (设置速度, , 真)
    
.判断 (等于 (按钮索引, 7))
    
    界面控件布局 (#默认界面布局)
    
.判断 (等于 (按钮索引, 8))
    载入 (关于, , 真)
.判断 (等于 (按钮索引, 9))
    结束 ()
.默认
    
.判断结束


.子程序 设目录相关, 空白型, 公开, 
.如果真 (等于 (树型控制框.最大化按钮, 0))
    返回 ()
.如果真结束
赋值 (当前目录, 树型控制框.取项目文本 (树型控制框.最大化按钮))
.如果 (等于 (当前目录, “正在下载”))
    设置正在下载任务框 ()
.否则
    设置普通任务下载统计框 ()
.如果结束

设置单个任务信息框 ()

 ' 设置下载详细信息或进度
.如果 (等于 (树型控制框.最大化按钮, 1))
    开启任务下载进度框 ()
    刷新日志树 ()
.否则
    开启任务详细信息框 ()
.如果结束


.子程序 增加日志项, 空白型, 公开, 
.参数 类型, 整数型, , 
.参数 时间, 文本型, , 
.参数 内容, 文本型, , 

.局部变量 图标, 整数型, , , 
.局部变量 背景色, 整数型, , , 
.局部变量 文本色, 整数型, , , 
.局部变量 表项索引, 整数型, , , 

赋值 (表项索引, 日志.插入表项 (时间, 图标, , , ))
日志.置标题 (表项索引, 1, 内容)
日志.保证显示 (表项索引)
赋值 (日志., 取颜色值 (232, 243, 243))


.子程序 任务被选择, 空白型, 公开, 
.局部变量 被选种项, 整数型, , , 
.局部变量 对象序号, 整数型, , , 

赋值 (被选种项, 任务下载统计框.)
赋值 (对象序号, 任务下载统计框.取表项数值 (被选种项))
.判断开始 (等于 (当前目录, “正在下载”))
    
    .如果真 (等于 (对象序号, -1))
        设置单个任务信息框 ()
        返回 ()
    .如果真结束
    
    赋值 (当前显示对象序号, 对象序号)
    界面基础控件.设置进度框活动任务 (下载对象 [对象序号], 进度框任务索引)
    设置单个任务信息框 ()
    刷新日志树 ()
     ' 开启任务下载进度框 ()
     ' 当任务被选择且当前目录为“正在下载”则开启任务下载进度框，并设置当前对象序号，显示线程树
    
.默认
     ' 当前目录为其它保存类型的目录的相关操作
    
    显示详细统计信息 (当前目录, 任务下载统计框.取标题 (被选种项, 1))
    
.判断结束


.子程序 清空日志框, 空白型, 公开, 
赋值 (日志., {  })

.子程序 线程树节点被选择, 空白型, 公开, 
.局部变量 选种项, 整数型, , , 
.局部变量 线程序号, 整数型, , , 

赋值 (选种项, 单个任务信息框.最大化按钮)
赋值 (线程序号, 单个任务信息框.取项目数值 (选种项))
赋值 (当前显示线程序号, 线程序号)
 ' 开启日志 ()
填充日志 ()

.子程序 填充日志, 空白型, 公开, 
.局部变量 日志数组成员数, 整数型, , , 
.局部变量 记次变量, 整数型, , , 

清空日志框 ()
.如果真 (等于 (当前显示对象序号, 0))
    输出调试文本 (到文本 (任务下载统计框.))
    赋值 (当前显示对象序号, 任务下载统计框.)
    .如果真 (等于 (当前显示对象序号, 0))
        返回 ()
    .如果真结束
    
.如果真结束


赋值 (日志数组成员数, 取数组成员数 (下载对象 [当前显示对象序号], 任务核心数据.线程信息数组 [当前显示线程序号], 日志数组))
赋值 (日志.字体名称, 真)
.变量循环首 (1, 日志数组成员数, 1, 记次变量)
    增加日志项 (下载对象 [当前显示对象序号], 任务核心数据.线程信息数组 [当前显示线程序号], 日志数组 [记次变量], 消息类型, 下载对象 [当前显示对象序号], 任务核心数据.线程信息数组 [当前显示线程序号], 日志数组 [记次变量], 时间文本, 下载对象 [当前显示对象序号], 任务核心数据.线程信息数组 [当前显示线程序号], 日志数组 [记次变量], 内容文本)
.变量循环尾 ()
赋值 (日志.字体名称, 假)

.子程序 刷新日志树, 空白型, 公开, 
.局部变量 线程个数, 整数型, , , 
.局部变量 记次变量, 整数型, , , 

设置单个任务信息框 ()
.如果真 (或者 (等于 (当前显示对象序号, 0), 不等于 (当前目录, “正在下载”)))
    返回 ()
.如果真结束

.如果真 (等于 (下载对象 [当前显示对象序号], 对象状态, #已删除))
    返回 ()
.如果真结束
赋值 (线程个数, 取数组成员数 (下载对象 [当前显示对象序号], 任务核心数据.线程信息数组))
.变量循环首 (1, 线程个数, 1, 记次变量)
    刷新方式增加线程树节点 (当前显示对象序号, 记次变量)
    
.变量循环尾 ()

.子程序 增加进度框任务, 整数型, 公开, 
.参数 任务总长度, 整数型, , 
.参数 单点长度, 整数型, , 

返回 (任务下载进度框.增加任务 (任务总长度, 单点长度))

.子程序 设置进度框活动任务, 空白型, 公开, 
.参数 任务索引, 整数型, , 

任务下载进度框.设置活动任务 (任务索引)

.子程序 改变进度框进度, 空白型, 公开, 
.参数 任务索引, 整数型, , 
.参数 开始位置, 整数型, , 
.参数 结束位置, 整数型, , 

任务下载进度框.改变进度 (任务索引, 开始位置, 结束位置, #已下载点, #正下载点)

.子程序 重画进度框, 空白型, 公开, 
任务下载进度框.重画 ()

.子程序 清空进度框, 空白型, 公开, 
任务下载进度框.清空绘画区 ()

.子程序 设置实时信息, 空白型, 公开, 
.局部变量 已经下载长, 整数型, , , 
.局部变量 记次变量, 整数型, , , 
.局部变量 时间间隔, 整数型, , , 
.局部变量 下载对象个数, 整数型, , , 

.如果真 (等于 (是否已创建 (底部状态条), 假))
    返回 ()
.如果真结束

底部状态条.置文本 (2, 相加 (到文本 (未知支持库函数_2 ()), “ 字节/秒”))

.如果 (不等于 (当前显示对象序号, 0))
    底部状态条.置文本 (1, 相加 (到文本 (下载对象.未知支持库函数_25 ( [当前显示对象序号], 下载对象)), “ 字节/秒”))
.否则
    底部状态条.置文本 (1, “0 字节/秒”)
.如果结束


赋值 (下载对象个数, 取数组成员数 (下载对象))

.变量循环首 (1, 下载对象个数, 1, 记次变量)
    
    .如果真 (并且 (不等于 (记次变量, 当前显示对象序号), 不等于 (当前显示对象序号, 0)))
        下载对象.未知支持库函数_25 ( [当前显示对象序号], 下载对象)
    .如果真结束
    
    .如果真 (等于 (下载对象 [记次变量], 对象状态, #正运行))
        .如果真 (等于 (下载对象 [记次变量], 任务常规信息.总长度, 0))
            返回 ()
        .如果真结束
        赋值 (已经下载长, 下载对象.未知支持库函数_26 ( [记次变量], 下载对象))
        .如果 (大于 (已经下载长, 0))
            赋值 (下载对象 [记次变量], 任务常规信息.完成数, 已经下载长)
        .否则
            赋值 (已经下载长, 下载对象 [记次变量], 任务常规信息.完成数)
            .如果真 (等于 (已经下载长, 0))
                赋值 (已经下载长, 1)
            .如果真结束
            
        .如果结束
        
        置任务下载统计框_完成数 (下载对象 [记次变量], 任务统计框表项索引, 已经下载长)
        置任务下载统计框_百分比 (下载对象 [记次变量], 任务统计框表项索引, 相乘 (相除 (已经下载长, 下载对象 [记次变量], 任务常规信息.总长度), 100))
        
        置任务下载统计框_重试 (下载对象 [记次变量], 任务统计框表项索引, 下载对象.未知支持库函数_28 ( [记次变量], 下载对象))
        
        .如果 (大于 (下载对象 [记次变量], 任务常规信息.总长度, 已经下载长))
            赋值 (时间间隔, 取时间间隔 (取现行时间 (), 下载对象 [记次变量], 任务常规信息.创建时间, #秒))
            置任务下载统计框_速度 (下载对象 [记次变量], 任务统计框表项索引, 相除 (已经下载长, 时间间隔))
            置任务下载统计框_用时 (下载对象 [记次变量], 任务统计框表项索引, 时间间隔)
            置任务下载统计框_剩余时间 (下载对象 [记次变量], 任务统计框表项索引, 整除 (相减 (下载对象 [记次变量], 任务常规信息.总长度, 已经下载长), 相除 (已经下载长, 时间间隔)))
            
        .否则
            置任务下载统计框_剩余时间 (下载对象 [记次变量], 任务统计框表项索引, 0)
        .如果结束
        
        修改任务信息记录 (“正在下载”, 记次变量, 下载对象 [记次变量], 任务常规信息.文件名, , 已经下载长, , 下载对象 [记次变量], 任务常规信息.网址, , , , , , , , , )
    .如果真结束
    
.变量循环尾 ()


.子程序 取指定统计框标题的表项索引, 整数型, 公开, -1表示指定标题不存在
.参数 文件名, 文本型, , 

.局部变量 表项数, 整数型, , , 
.局部变量 记次变量, 整数型, , , 

赋值 (表项数, 任务下载统计框.取表项数 ())
.变量循环首 (0, 相减 (表项数, 1), 1, 记次变量)
    .如果真 (等于 (任务下载统计框.取标题 (记次变量, 1), 文件名))
        返回 (记次变量)
    .如果真结束
    
.变量循环尾 ()
返回 (-1)


.子程序 取指定统计框标题的表项值, 整数型, 公开, 
.参数 表项索引, 整数型, , 

返回 (任务下载统计框.取表项数值 (表项索引))


.子程序 取指定统计框指定标题, 文本型, 公开, 
.参数 表项索引, 整数型, , 
.参数 标题索引, 整数型, , 

返回 (任务下载统计框.取标题 (表项索引, 标题索引))

.子程序 取统计框当前表项, 整数型, 公开, 
返回 (任务下载统计框.)

.子程序 取统计框当前表项数值, 整数型, 公开, 
.局部变量 表项索引, 整数型, , , 

赋值 (表项索引, 取统计框当前表项 ())
返回 (任务下载统计框.取表项数值 (表项索引))

.子程序 显示详细统计信息, 空白型, , 
.参数 目录名, 文本型, , 
.参数 文件名, 文本型, , 

.局部变量 大小, 整数型, , , 
.局部变量 完成数, 整数型, , , 
.局部变量 块数, 整数型, , , 
.局部变量 网址, 文本型, , , 
.局部变量 创建时间, 日期时间型, , , 
.局部变量 完成时间, 日期时间型, , , 
.局部变量 注释, 文本型, , , 
.局部变量 点型进度, 字节集, , , 
.局部变量 任务信息, 字节集, , , 
.局部变量 文件路径, 文本型, , , 
.局部变量 文件状态, 整数型, , , 
.局部变量 用户名, 文本型, , , 
.局部变量 密码, 文本型, , , 
.局部变量 用时, 整数型, , , 
.局部变量 小时, 整数型, , , 
.局部变量 分, 整数型, , , 
.局部变量 秒, 整数型, , , 
.局部变量 时间, 文本型, , , 
.局部变量 平均速度, 整数型, , , 


置下载信息数据库 (目录名)
到首记录 ()
.如果 (等于 (查找 (等于 (读 (“文件名”), 文件名)), 真))
    赋值 (大小, 读 (“大小”))
    赋值 (完成数, 读 (“完成数”))
    赋值 (块数, 读 (“块数”))
    赋值 (网址, 读 (“URL”))
    赋值 (创建时间, 读 (“创建时间”))
    赋值 (完成时间, 读 (“完成时间”))
    赋值 (注释, 读 (“注释”))
    赋值 (点型进度, 读 (“点型进度”))
    赋值 (任务信息, 读 (“任务信息”))
    赋值 (文件路径, 读 (“文件路径”))
    赋值 (文件状态, 读 (“文件状态”))
    赋值 (用户名, 读 (“用户名”))
    赋值 (密码, 读 (“密码”))
    任务详细信息框.置标题 (0, 1, 网址)
    任务详细信息框.置标题 (1, 1, 注释)
    任务详细信息框.置标题 (2, 1, 文件路径)
    任务详细信息框.置标题 (3, 1, 到文本 (大小))
    任务详细信息框.置标题 (4, 1, 到文本 (完成数))
    
    赋值 (用时, 取时间间隔 (完成时间, 创建时间, #秒))
    赋值 (小时, 整除 (用时, 3600))
    赋值 (分, 整除 (求余数 (用时, 3600), 60))
    赋值 (秒, 求余数 (用时, 3600, 60))
    .判断开始 (大于 (小时, 9))
        赋值 (时间, 相加 (到文本 (小时), “:”))
    .默认
        赋值 (时间, 相加 (“0”, 到文本 (小时), “:”))
    .判断结束
    .判断开始 (大于 (分, 9))
        赋值 (时间, 相加 (时间, 到文本 (分), “:”))
    .默认
        赋值 (时间, 相加 (时间, “0”, 到文本 (分), “:”))
    .判断结束
    .判断开始 (大于 (秒, 9))
        赋值 (时间, 相加 (时间, 到文本 (秒)))
    .默认
        赋值 (时间, 相加 (时间, “0”, 到文本 (秒)))
    .判断结束
    
    赋值 (平均速度, 相除 (大小, 用时))
    
    任务详细信息框.置标题 (5, 1, 时间)
    任务详细信息框.置标题 (6, 1, 相加 (到文本 (平均速度), “字节/秒”))
    任务详细信息框.置标题 (7, 1, 到文本 (创建时间))
    任务详细信息框.置标题 (8, 1, 到文本 (完成时间))
    
.否则
    
.如果结束


.子程序 状态框弹出菜单, 空白型, 公开, 
.判断开始 (等于 (当前目录, “正在下载”))
    赋值 (_启动窗口..可视, 真)
    赋值 (_启动窗口..可视, 真)
    
.默认
    赋值 (_启动窗口..可视, 假)
    赋值 (_启动窗口..可视, 假)
    
.判断结束


.子程序 取当前目录, 文本型, 公开, 
返回 (当前目录)

.子程序 删除进度条任务, 空白型, 公开, 
.参数 任务序号, 整数型, , 

任务下载进度框.删除任务 (任务序号)

.类模块 点型进度框类, , , 本源码无版权，但引用决不能去掉易语言的广告条

.程序集变量 匿名程序集变量_2192, 空白型, , , 
.程序集变量 背景画板, 画板, , , 
.程序集变量 缓冲画板_未下载, 画板, , , 
.程序集变量 缓冲画板_已下载, 画板, , , 
.程序集变量 缓冲画板_正下载, 画板, , , 
.程序集变量 滚动条, 纵向滚动条, , , 
.程序集变量 图片高度, 整数型, , , 
.程序集变量 图片宽度, 整数型, , , 
.程序集变量 图片左右间距, 整数型, , , 
.程序集变量 图片上下间距, 整数型, , , 
.程序集变量 滚动条位置, 整数型, , , 新版中可以被去掉?
.程序集变量 绘画区矩阵相对坐标, 矩阵坐标, , , 绘画区矩阵相对与显示图片矩阵的坐标
.程序集变量 绘画区矩阵, 矩阵坐标, , , 
.程序集变量 任务信息数组, 任务长度信息数组, , "0", 
.程序集变量 当前活动任务, 整数型, , , 
.程序集变量 任务锁, 整数型, , , 
.程序集变量 程序错误变量, 文本型, , , 记录当前已知但还没有修正的错误
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用
未知支持库函数_2 (任务锁)

.子程序 初始化点型进度框, 逻辑型, 公开, 
.参数 外部画板控件_背景画板, 画板, , 
.参数 外部画板控件_未下载, 画板, , 
.参数 外部画板控件_已下载, 画板, , 
.参数 外部画板控件_正下载, 画板, , 
.参数 外部纵向滚动条, 纵向滚动条, , 
.参数 画板初始顶边, 整数型, , 
.参数 画板初始高度, 整数型, , 
.参数 画板初始左边, 整数型, , 
.参数 画板初始宽度, 整数型, , 
.参数 外部_点图片宽度, 整数型, , 
.参数 外部_点图片高度, 整数型, , 
.参数 左右间距, 整数型, , 
.参数 上下间距, 整数型, , 

赋值 (任务锁, 未知支持库函数_1 ())
赋值 (背景画板, 外部画板控件_背景画板)
赋值 (缓冲画板_未下载, 外部画板控件_未下载)
赋值 (缓冲画板_已下载, 外部画板控件_已下载)
赋值 (缓冲画板_正下载, 外部画板控件_正下载)

赋值 (滚动条, 外部纵向滚动条)
赋值 (滚动条.禁止, 真)
赋值 (图片高度, 外部_点图片高度)
赋值 (图片宽度, 外部_点图片宽度)

赋值 (图片左右间距, 左右间距)
赋值 (图片上下间距, 上下间距)

赋值 (绘画区矩阵相对坐标.横坐标, 1)
赋值 (绘画区矩阵相对坐标.纵坐标, 1)

设置背景画板位置 (画板初始顶边, 画板初始高度, 画板初始左边, 画板初始宽度)

赋值 (绘画区矩阵, 定义绘画区矩阵 ())

返回 (真)

.子程序 设置背景画板位置, 空白型, 公开, 
.参数 画板顶边, 整数型, 可空, 
.参数 画板高度, 整数型, 可空, 
.参数 画板左边, 整数型, 可空, 
.参数 画板宽度, 整数型, 可空, 


.如果真 (等于 (是否为空 (画板顶边), 假))
    赋值 (背景画板.顶边, 画板顶边)
    
.如果真结束

.如果真 (等于 (是否为空 (画板高度), 假))
    赋值 (背景画板.高度, 画板高度)
    
.如果真结束

.如果真 (等于 (是否为空 (画板左边), 假))
    赋值 (背景画板.左边, 画板左边)
    
.如果真结束

.如果真 (等于 (是否为空 (画板宽度), 假))
    赋值 (背景画板.宽度, 相减 (画板宽度, 25))
    
.如果真结束


.子程序 设顶边, 空白型, 公开, 
.参数 顶边, 整数型, , 

赋值 (背景画板.顶边, 顶边)


.子程序 设高度, 空白型, 公开, 
.参数 高度, 整数型, , 

赋值 (背景画板.高度, 高度)
赋值 (滚动条.顶边, 背景画板.顶边)
赋值 (滚动条.高度, 背景画板.高度)
赋值 (滚动条.左边, 相加 (背景画板.左边, 背景画板.宽度))
赋值 (绘画区矩阵, 定义绘画区矩阵 ())


.子程序 设左边, 空白型, 公开, 
.参数 左边, 整数型, , 

赋值 (背景画板.左边, 左边)

.子程序 设宽度, 空白型, 公开, 
.参数 宽度, 整数型, , 

赋值 (背景画板.宽度, 相减 (宽度, 25))
赋值 (滚动条.宽度, 16)
赋值 (绘画区矩阵, 定义绘画区矩阵 ())

.子程序 禁止为真, 空白型, 公开, 
赋值 (背景画板.禁止, 真)
赋值 (滚动条.禁止, 真)

.子程序 禁止为假, 空白型, 公开, 
赋值 (背景画板.禁止, 假)
赋值 (滚动条.禁止, 假)

.子程序 取禁止属性, 逻辑型, 公开, 
返回 (背景画板.禁止)

.子程序 可视为真, 空白型, 公开, 
赋值 (背景画板.可视, 真)
赋值 (滚动条.可视, 真)
赋值 (滚动条.禁止, 真)

.子程序 可视为假, 空白型, 公开, 
赋值 (背景画板.可视, 假)
赋值 (滚动条.可视, 假)

.子程序 取可视属性, 逻辑型, 公开, 
返回 (背景画板.可视)


.子程序 重画滚动条, 空白型, 公开, 
赋值 (滚动条.顶边, 背景画板.顶边)
赋值 (滚动条.高度, 背景画板.高度)
赋值 (滚动条.左边, 相加 (背景画板.左边, 背景画板.宽度))
赋值 (滚动条.宽度, 16)


.子程序 增加任务, 整数型, 公开, 返回任务数组索引
.参数 任务总长度, 整数型, , 
.参数 单点长度, 整数型, , 

.局部变量 任务索引, 整数型, , , 
.局部变量 任务信息, 任务长度信息数组, , , 
.局部变量 点数, 整数型, , , 
.局部变量 记次变量, 整数型, , , 

赋值 (任务信息.总长度, 任务总长度)
赋值 (任务信息.单点长度, 单点长度)
赋值 (点数, 相除 (任务总长度, 单点长度))
.如果真 (大于 (求余数 (任务总长度, 单点长度), 0))
    赋值 (点数, 相加 (点数, 1))
.如果真结束

写调试文本 (相加 (“任务总长度=”, 到文本 (任务总长度), “单点长度=”, 到文本 (单点长度), “总点数=”, 到文本 (点数)))

重定义数组 (任务信息.点状态数组, 假, 点数)
.变量循环首 (1, 点数, 1, 记次变量)
    赋值 (任务信息.点状态数组 [记次变量], #未下载点)
.变量循环尾 ()


赋值 (任务信息.任务状态, #任务状态_开始状态)
赋值 (任务索引, 加入任务数组 (任务信息))
赋值 (任务信息数组 [任务索引], 显示图片矩阵, 定义显示图片矩阵 (任务索引))
赋值 (任务信息数组 [任务索引], 图片总个数, 获得图片总个数 (任务索引))
画绘画矩阵 (任务索引)
返回 (任务索引)

.子程序 停止任务, 空白型, 公开, 
.参数 任务索引, 整数型, , 

未知支持库函数_3 (任务锁)
赋值 (任务信息数组 [任务索引], 任务状态, #任务状态_停止状态)
未知支持库函数_4 (任务锁)

.子程序 删除任务, 空白型, 公开, 
.参数 任务索引, 整数型, , 

.如果真 (等于 (任务索引, 0))
    返回 ()
.如果真结束
未知支持库函数_3 (任务锁)
赋值 (任务信息数组 [任务索引], 任务状态, #任务状态_删除状态)
清除数组 (任务信息数组 [任务索引], 点状态数组)
赋值 (当前活动任务, 0)
未知支持库函数_4 (任务锁)

.子程序 转存点位置信息, 字节集, 公开, 
.参数 任务索引, 整数型, , 

.局部变量 状态字节集, 字节集, , , 

未知支持库函数_3 (任务锁)
赋值 (状态字节集, 到字节集 (任务信息数组 [任务索引], 点状态数组))
未知支持库函数_4 (任务锁)
返回 (状态字节集)

.子程序 恢复点位置信息, 空白型, 公开, @n没写
.参数 任务索引, 整数型, , 
.参数 点状态字节集, 字节集, , 

未知支持库函数_3 (任务锁)

未知支持库函数_4 (任务锁)

.子程序 设置活动任务, 空白型, 公开, 
.参数 任务索引, 整数型, , 

背景画板.清除 ()
赋值 (当前活动任务, 任务索引)
画绘画矩阵 (任务索引)

.子程序 获得图片总个数, 整数型, 公开, 
.参数 任务索引, 整数型, , 

.局部变量 图片个数, 整数型, , , 

赋值 (图片个数, 相除 (任务信息数组 [任务索引], 总长度, 任务信息数组 [任务索引], 单点长度))
.如果真 (大于 (求余数 (任务信息数组 [任务索引], 总长度, 任务信息数组 [任务索引], 单点长度), 0))
    赋值 (图片个数, 相加 (图片个数, 1))
.如果真结束
返回 (图片个数)

.子程序 获得指定逻辑长度图片个数, 整数型, 公开, 
.参数 逻辑总长度, 整数型, , 
.参数 逻辑单位长度, 整数型, , 

.局部变量 图片个数, 整数型, , , 

赋值 (图片个数, 相除 (逻辑总长度, 逻辑单位长度))
.如果真 (大于 (求余数 (逻辑总长度, 逻辑单位长度), 0))
    赋值 (图片个数, 相加 (图片个数, 1))
.如果真结束
返回 (图片个数)


.子程序 定义显示图片矩阵, 矩阵坐标, 公开, 
.参数 任务索引, 整数型, , 

.局部变量 图片总个数, 整数型, , , 
.局部变量 矩阵坐标, 矩阵坐标, , , 

赋值 (矩阵坐标.横坐标, 相除 (背景画板.宽度, 相加 (图片宽度, 图片左右间距)))
.如果真 (等于 (矩阵坐标.横坐标, 0))
    返回 (矩阵坐标)
.如果真结束
赋值 (图片总个数, 获得图片总个数 (任务索引))
.如果 (小于 (矩阵坐标.横坐标, 图片总个数))
    赋值 (矩阵坐标.纵坐标, 相除 (图片总个数, 矩阵坐标.横坐标))
    .如果真 (大于 (求余数 (图片总个数, 矩阵坐标.横坐标), 0))
        赋值 (矩阵坐标.纵坐标, 相加 (矩阵坐标.纵坐标, 1))
    .如果真结束
    
.否则
    赋值 (矩阵坐标.横坐标, 图片总个数)
    赋值 (矩阵坐标.纵坐标, 1)
.如果结束

返回 (矩阵坐标)

.子程序 定义绘画区矩阵, 矩阵坐标, 公开, 
.局部变量 矩阵坐标, 矩阵坐标, , , 

赋值 (矩阵坐标.横坐标, 相除 (背景画板.宽度, 相加 (图片宽度, 图片左右间距)))
赋值 (矩阵坐标.纵坐标, 相除 (背景画板.高度, 相加 (图片高度, 图片上下间距)))
返回 (矩阵坐标)


.子程序 由逻辑长度取矩阵坐标, 矩阵坐标, 公开, 
.参数 逻辑长度, 整数型, , 
.参数 逻辑单位长度, 整数型, , 

.局部变量 图片个数, 整数型, , , 
.局部变量 矩阵坐标, 矩阵坐标, , , 

赋值 (矩阵坐标.横坐标, 相除 (背景画板.宽度, 相加 (图片宽度, 图片左右间距)))
赋值 (图片个数, 获得指定逻辑长度图片个数 (逻辑长度, 逻辑单位长度))
.如果 (小于 (矩阵坐标.横坐标, 图片个数))
    赋值 (矩阵坐标.纵坐标, 相除 (图片个数, 矩阵坐标.横坐标))
    .如果真 (大于 (求余数 (图片个数, 矩阵坐标.横坐标), 0))
        赋值 (矩阵坐标.纵坐标, 相加 (矩阵坐标.纵坐标, 1))
    .如果真结束
    
.否则
    赋值 (矩阵坐标.横坐标, 图片个数)
    赋值 (矩阵坐标.纵坐标, 1)
.如果结束

返回 (矩阵坐标)

.子程序 设置矩阵图片属性, 空白型, 公开, 
.参数 任务索引, 整数型, , 
.参数 矩阵坐标, 矩阵坐标, , 
.参数 属性, 整数型, , 

.局部变量 显示图片矩阵, 矩阵坐标, , , 

赋值 (显示图片矩阵, 任务信息数组 [任务索引], 显示图片矩阵)
赋值 (任务信息数组 [任务索引], 点状态数组 [相加 (相乘 (相减 (矩阵坐标.纵坐标, 1), 显示图片矩阵.横坐标), 矩阵坐标.横坐标)], 属性)

.子程序 显示图片坐标转点状态数组索引, 整数型, 公开, 
.参数 任务索引, 整数型, , 
.参数 矩阵坐标, 矩阵坐标, , 

.局部变量 显示图片矩阵, 矩阵坐标, , , 

赋值 (显示图片矩阵, 任务信息数组 [任务索引], 显示图片矩阵)
返回 (相加 (相乘 (相减 (矩阵坐标.纵坐标, 1), 显示图片矩阵.横坐标), 矩阵坐标.横坐标))



.子程序 点状态数组索引转显示图片坐标, 矩阵坐标, , 
.参数 任务索引, 整数型, , 
.参数 数组索引, 整数型, , 

.局部变量 矩阵坐标, 矩阵坐标, , , 
.局部变量 显示图片矩阵, 矩阵坐标, , , 


赋值 (显示图片矩阵, 任务信息数组 [任务索引], 显示图片矩阵)
赋值 (矩阵坐标.纵坐标, 相除 (数组索引, 显示图片矩阵.横坐标))
.如果真 (或者 (等于 (数组索引, 0), 等于 (显示图片矩阵.横坐标, 0)))
    返回 (矩阵坐标)
.如果真结束
.如果真 (大于 (求余数 (数组索引, 显示图片矩阵.横坐标), 0))
    赋值 (矩阵坐标.纵坐标, 相加 (矩阵坐标.纵坐标, 1))
.如果真结束

赋值 (矩阵坐标.横坐标, 求余数 (数组索引, 显示图片矩阵.横坐标))
.如果真 (等于 (矩阵坐标.横坐标, 0))
    赋值 (矩阵坐标.横坐标, 显示图片矩阵.横坐标)
.如果真结束
返回 (矩阵坐标)

.子程序 画矩阵指定点, 空白型, 公开, 
.参数 任务索引, 整数型, , 
.参数 矩阵坐标, 矩阵坐标, , 

.局部变量 绘画区坐标, 矩阵坐标, , , 
.局部变量 数组索引, 整数型, , , 
.局部变量 当前状态, 整数型, , , 

.如果真 (或者 (等于 (任务索引, 0), 不等于 (任务索引, 当前活动任务)))
    返回 ()
.如果真结束

显示图片矩阵坐标到绘画区矩阵坐标 (矩阵坐标, 绘画区坐标)
赋值 (数组索引, 显示图片坐标转点状态数组索引 (任务索引, 矩阵坐标))
.如果真 (等于 (数组索引, 0))
    返回 ()
.如果真结束
赋值 (当前状态, 任务信息数组 [任务索引], 点状态数组 [数组索引])

写调试文本 (相加 (“绘画区横坐标:”, 到文本 (绘画区坐标.横坐标), “  绘画区纵坐标:”, 到文本 (绘画区坐标.纵坐标), 相加 (“  点类型:”, 到文本 (当前状态))))

.判断开始 (等于 (当前状态, #未下载点))
    缓冲画板_未下载.复制 (0, 0, 图片宽度, 图片高度, 背景画板, 相加 (相乘 (相减 (绘画区坐标.横坐标, 1), 相加 (图片宽度, 图片左右间距)), 图片左右间距), 相加 (相乘 (相减 (绘画区坐标.纵坐标, 1), 相加 (图片高度, 图片上下间距)), 图片上下间距), )
.判断 (等于 (当前状态, #已下载点))
    缓冲画板_已下载.复制 (0, 0, 图片宽度, 图片高度, 背景画板, 相加 (相乘 (相减 (绘画区坐标.横坐标, 1), 相加 (图片宽度, 图片左右间距)), 图片左右间距), 相加 (相乘 (相减 (绘画区坐标.纵坐标, 1), 相加 (图片高度, 图片上下间距)), 图片上下间距), )
.判断 (等于 (当前状态, #正下载点))
    缓冲画板_正下载.复制 (0, 0, 图片宽度, 图片高度, 背景画板, 相加 (相乘 (相减 (绘画区坐标.横坐标, 1), 相加 (图片宽度, 图片左右间距)), 图片左右间距), 相加 (相乘 (相减 (绘画区坐标.纵坐标, 1), 相加 (图片高度, 图片上下间距)), 图片上下间距), )
.默认
    
.判断结束


.子程序 画矩阵指定横行, 空白型, 公开, 
.参数 任务索引, 整数型, , 
.参数 纵行数, 整数型, , 

.局部变量 矩阵坐标, 矩阵坐标, , , 
.局部变量 绘画区坐标, 矩阵坐标, , , 
.局部变量 数组索引, 整数型, , , 
.局部变量 当前状态, 整数型, , , 
.局部变量 记次变量, 整数型, , , 

赋值 (矩阵坐标.横坐标, 1)
赋值 (矩阵坐标.纵坐标, 纵行数)
显示图片矩阵坐标到绘画区矩阵坐标 (矩阵坐标, 绘画区坐标)
赋值 (数组索引, 显示图片坐标转点状态数组索引 (任务索引, 矩阵坐标))
.变量循环首 (0, 相减 (绘画区矩阵.横坐标, 1), 1, 记次变量)
    .如果真 (大于 (数组索引, 任务信息数组 [任务索引], 图片总个数))
        返回 ()
    .如果真结束
    赋值 (当前状态, 任务信息数组 [任务索引], 点状态数组 [数组索引])
    .判断开始 (等于 (当前状态, #未下载点))
        缓冲画板_未下载.复制 (0, 0, 图片宽度, 图片高度, 背景画板, 相加 (相乘 (记次变量, 相加 (图片宽度, 图片左右间距)), 图片左右间距), 相加 (相乘 (相减 (绘画区坐标.纵坐标, 1), 相加 (图片高度, 图片上下间距)), 图片上下间距), )
    .判断 (等于 (当前状态, #已下载点))
        缓冲画板_已下载.复制 (0, 0, 图片宽度, 图片高度, 背景画板, 相加 (相乘 (记次变量, 相加 (图片宽度, 图片左右间距)), 图片左右间距), 相加 (相乘 (相减 (绘画区坐标.纵坐标, 1), 相加 (图片高度, 图片上下间距)), 图片上下间距), )
    .判断 (等于 (当前状态, #正下载点))
        缓冲画板_正下载.复制 (0, 0, 图片宽度, 图片高度, 背景画板, 相加 (相乘 (记次变量, 相加 (图片宽度, 图片左右间距)), 图片左右间距), 相加 (相乘 (相减 (绘画区坐标.纵坐标, 1), 相加 (图片高度, 图片上下间距)), 图片上下间距), )
    .默认
        
    .判断结束
    赋值 (数组索引, 相加 (数组索引, 1))
.变量循环尾 ()


.子程序 行复制, 空白型, , 
.参数 被复制开始行位置, 整数型, , 相对与绘画矩阵坐标，下同
.参数 被复制行长度, 整数型, , 
.参数 复制到行位置, 整数型, , 

.局部变量 源顶边, 整数型, , , 
.局部变量 源宽度, 整数型, , , 
.局部变量 源高度, 整数型, , , 
.局部变量 目的顶边, 整数型, , , 

赋值 (源顶边, 相乘 (相减 (被复制开始行位置, 1), 相加 (图片高度, 图片上下间距)))
赋值 (源宽度, 相乘 (相加 (绘画区矩阵.横坐标, 1), 相加 (图片宽度, 图片左右间距)))
赋值 (源高度, 相乘 (被复制行长度, 相加 (图片高度, 图片上下间距)))

赋值 (目的顶边, 相乘 (相减 (复制到行位置, 1), 相加 (图片高度, 图片上下间距)))
背景画板.复制 (0, 源顶边, 源宽度, 源高度, 背景画板, 0, 目的顶边, )

.子程序 显示图片矩阵坐标到绘画区矩阵坐标, 空白型, , 
.参数 显示图片矩阵, 矩阵坐标, , 
.参数 绘画区坐标, 矩阵坐标, 参考, 

赋值 (绘画区坐标.横坐标, 显示图片矩阵.横坐标)
赋值 (绘画区坐标.纵坐标, 相加 (相减 (显示图片矩阵.纵坐标, 绘画区矩阵相对坐标.纵坐标), 1))


.子程序 画绘画矩阵, 空白型, , 
.参数 任务索引, 整数型, , 

.局部变量 开始行, 整数型, , , 
.局部变量 记次变量, 整数型, , , 

.如果真 (或者 (等于 (任务索引, 0), 不等于 (任务索引, 当前活动任务)))
    返回 ()
.如果真结束
.变量循环首 (绘画区矩阵相对坐标.纵坐标, 相减 (相加 (绘画区矩阵相对坐标.纵坐标, 绘画区矩阵.纵坐标), 1), 1, 记次变量)
    .如果真 (大于 (记次变量, 任务信息数组 [任务索引], 显示图片矩阵.纵坐标))
        返回 ()
    .如果真结束
    画矩阵指定横行 (任务索引, 记次变量)
.变量循环尾 ()

.子程序 画绘画矩阵改变点, 空白型, , 
.参数 任务索引, 整数型, , 
.参数 改变矩阵, 矩阵坐标, , 

.局部变量 旧显示图片矩阵, 矩阵坐标, , , 
.局部变量 旧类型, 整数型, , , 
.局部变量 新类型, 整数型, , , 
.局部变量 绘画区横坐标, 整数型, , , 
.局部变量 绘画区纵坐标, 整数型, , , 
.局部变量 点坐标, 矩阵坐标, , , 

赋值 (旧显示图片矩阵, 任务信息数组 [任务索引], 显示图片矩阵)

.变量循环首 (1, 绘画区矩阵.纵坐标, 1, 绘画区纵坐标)
    
    .如果真 (大于 (绘画区纵坐标, 改变矩阵.纵坐标))
        返回 ()
    .如果真结束
    
    .变量循环首 (1, 改变矩阵.横坐标, 1, 绘画区横坐标)
        
        .如果真 (大于 (绘画区横坐标, 旧显示图片矩阵.横坐标))
             ' 画点
        .如果真结束
        
        赋值 (旧类型, 任务信息数组 [任务索引], 点状态数组 [相加 (相乘 (相减 (绘画区纵坐标, 1), 旧显示图片矩阵.横坐标), 绘画区横坐标)])
        赋值 (新类型, 任务信息数组 [任务索引], 点状态数组 [相加 (相乘 (相减 (绘画区纵坐标, 1), 改变矩阵.横坐标), 绘画区横坐标)])
        .如果真 (不等于 (旧类型, 新类型))
            赋值 (点坐标.横坐标, 绘画区横坐标)
            赋值 (点坐标.纵坐标, 绘画区纵坐标)
            画矩阵指定点 (任务索引, 点坐标)
            
        .如果真结束
        
    .变量循环尾 ()
.变量循环尾 ()



.子程序 重画, 空白型, 公开, 重画类型: 0全部重画 1尺寸被改变 2加入点 3滚动条被拖动
.如果真 (等于 (当前活动任务, 0))
    返回 ()
.如果真结束

赋值 (绘画区矩阵, 定义绘画区矩阵 ())
赋值 (任务信息数组 [当前活动任务], 显示图片矩阵, 定义显示图片矩阵 (当前活动任务))

.如果真 (等于 (任务信息数组 [当前活动任务], 显示图片矩阵.横坐标, 0))
    返回 ()
.如果真结束

.判断开始 (大于或等于 (绘画区矩阵.纵坐标, 任务信息数组 [当前活动任务], 显示图片矩阵.纵坐标))
    赋值 (滚动条.禁止, 真)
    赋值 (绘画区矩阵相对坐标.横坐标, 1)
    赋值 (绘画区矩阵相对坐标.纵坐标, 1)
.默认
    赋值 (滚动条.禁止, 假)
    赋值 (滚动条.最小位置, 1)
    赋值 (滚动条.最大位置, 相加 (相减 (任务信息数组 [当前活动任务], 显示图片矩阵.纵坐标, 绘画区矩阵.纵坐标), 1))
    输出调试文本 (到文本 (滚动条.最大位置))
    赋值 (滚动条.页改变值, 1)
    赋值 (滚动条.行改变值, 滚动条.页改变值)
    赋值 (滚动条.位置, 1)
    赋值 (绘画区矩阵相对坐标.横坐标, 1)
    赋值 (绘画区矩阵相对坐标.纵坐标, 1)
    
.判断结束

画绘画矩阵 (当前活动任务)


.子程序 改变进度, 空白型, 公开, 
.参数 任务索引, 整数型, , 
.参数 开始位置, 整数型, , 
.参数 结束位置, 整数型, , 
.参数 开始点类型, 整数型, , 
.参数 最后点类型, 整数型, , 

.局部变量 开始点数, 整数型, , , 
.局部变量 结束点数, 整数型, , , 
.局部变量 记次变量, 整数型, , , 
.局部变量 点坐标, 矩阵坐标, , , 


.如果真 (等于 (任务索引, 0))
    返回 ()
.如果真结束

赋值 (开始点数, 获得指定逻辑长度图片个数 (开始位置, 任务信息数组 [任务索引], 单点长度))
赋值 (结束点数, 获得指定逻辑长度图片个数 (结束位置, 任务信息数组 [任务索引], 单点长度))

.如果真 (等于 (开始点数, 0))
    赋值 (开始点数, 1)
.如果真结束

写调试文本 (相加 (“应画点个数:”, 到文本 (相减 (结束点数, 开始点数))))

.变量循环首 (开始点数, 结束点数, 1, 记次变量)
    .如果真 (小于 (记次变量, 1))
        返回 ()
    .如果真结束
    
    .如果真 (大于 (记次变量, 任务信息数组 [任务索引], 图片总个数))
        返回 ()
    .如果真结束
    .判断开始 (等于 (记次变量, 结束点数))
        .如果真 (等于 (任务信息数组 [任务索引], 点状态数组 [记次变量], #已下载点))
            返回 ()
        .如果真结束
        
        .判断开始 (大于 (求余数 (结束位置, 任务信息数组 [任务索引], 单点长度), 0))
            赋值 (任务信息数组 [任务索引], 点状态数组 [记次变量], #正下载点)
        .默认
            赋值 (任务信息数组 [任务索引], 点状态数组 [记次变量], #已下载点)
        .判断结束
        
    .默认
        赋值 (任务信息数组 [任务索引], 点状态数组 [记次变量], #已下载点)
    .判断结束
    
    赋值 (点坐标, 点状态数组索引转显示图片坐标 (任务索引, 记次变量))
    
    .如果真 (并且 (大于或等于 (点坐标.纵坐标, 绘画区矩阵相对坐标.纵坐标), 小于 (点坐标.纵坐标, 相加 (绘画区矩阵相对坐标.纵坐标, 绘画区矩阵.纵坐标)), 小于或等于 (点坐标.横坐标, 绘画区矩阵.横坐标)))
        画矩阵指定点 (任务索引, 点坐标)
    .如果真结束
    
.变量循环尾 ()


.子程序 加入任务数组, 整数型, , 返回数组索引
.参数 任务信息, 任务长度信息数组, , 

.局部变量 数组大小, 整数型, , , 
.局部变量 当前数组下标, 整数型, , , 

赋值 (数组大小, 取数组成员数 (任务信息数组))
未知支持库函数_3 (任务锁)
.变量循环首 (1, 数组大小, 1, 当前数组下标)
    .如果真 (等于 (任务信息数组 [当前数组下标], 任务状态, #任务状态_删除状态))
        赋值 (任务信息数组 [当前数组下标], 任务信息)
        未知支持库函数_4 (任务锁)
        返回 (当前数组下标)
    .如果真结束
    
.变量循环尾 ()
 ' 没有找到被删除的任务
加入成员 (任务信息数组, 任务信息)
赋值 (数组大小, 取数组下标 (任务信息数组, ))
未知支持库函数_4 (任务锁)
返回 (数组大小)

.子程序 滚动条被位置改变, 空白型, 公开, 
.参数 位置, 整数型, , 

输出调试文本 (到文本 (位置))

赋值 (绘画区矩阵相对坐标.纵坐标, 位置)

背景画板.清除 (0, 相减 (背景画板.高度, 相乘 (相减 (图片高度, 图片上下间距), 3)), 背景画板.宽度, 相乘 (相减 (图片高度, 图片上下间距), 3))

画绘画矩阵 (当前活动任务)


.子程序 取任务点个数, 整数型, , 任务的总点数
.参数 任务索引, 整数型, , 

返回 (取数组成员数 (任务信息数组 [任务索引], 点状态数组))

.子程序 取任务行数, 整数型, , 任务的总行数 *必须保证背景画板.宽度不为0*
.参数 点个数, 整数型, , 

.局部变量 点行数, 空白型, , , 

.如果真 (等于 (背景画板.宽度, 0))
    返回 (-1)
.如果真结束

赋值 (点行数, 相除 (点个数, 相除 (背景画板.宽度, 相加 (图片宽度, #进度框点间距))))

.如果真 (大于 (求余数 (点个数, 相除 (背景画板.宽度, 相加 (图片宽度, #进度框点间距))), 0))
    赋值 (点行数, 相加 (点行数, 1))
.如果真结束

返回 (点行数)


.子程序 取可视区行数, 整数型, , 可视区的可以显示的行总数
.局部变量 可视行数, 整数型, , , 

赋值 (可视行数, 相除 (背景画板.高度, 相加 (图片高度, #进度框点间距)))
.如果真 (大于 (相加 (相乘 (可视行数, 相加 (图片高度, #进度框点间距)), #进度框点间距), 背景画板.高度))
    赋值 (可视行数, 相减 (可视行数, 1))
.如果真结束
返回 (可视行数)

.子程序 取可视区一行点数, 整数型, , 可视区一行可以显示的点个数
.局部变量 一行点数, 整数型, , , 

赋值 (一行点数, 相除 (背景画板.宽度, 相加 (图片宽度, #进度框点间距)))
.如果真 (大于 (相加 (相乘 (一行点数, 相加 (图片宽度, #进度框点间距)), #进度框点间距), 背景画板.宽度))
    赋值 (一行点数, 相减 (一行点数, 1))
.如果真结束
返回 (一行点数)

.子程序 取可视区首行行号, 整数型, , 
返回 (滚动条位置)

.子程序 取可视区尾行行号, 整数型, , 
.局部变量 可视区首行行号, 整数型, , , 
.局部变量 可视区行数, 整数型, , , 

赋值 (可视区行数, 取可视区行数 ())
赋值 (可视区首行行号, 取可视区首行行号 ())
返回 (相加 (可视区首行行号, 可视区行数))

.子程序 取可视区开始点号, 整数型, , 
.局部变量 可视区一行点个数, 整数型, , , 
.局部变量 可视区首行行号, 整数型, , , 

赋值 (可视区首行行号, 取可视区首行行号 ())
赋值 (可视区一行点个数, 取可视区一行点数 ())
返回 (相加 (相乘 (相减 (可视区首行行号, 1), 可视区一行点个数), 1))

.子程序 取可视区结束点号, 整数型, , 
.局部变量 可视区尾行行数, 整数型, , , 
.局部变量 可视区一行点个数, 整数型, , , 

赋值 (可视区尾行行数, 取可视区尾行行号 ())
赋值 (可视区一行点个数, 取可视区一行点数 ())
返回 (相乘 (可视区尾行行数, 可视区一行点个数))

.子程序 取可视区结束行首点点号, 整数型, , 
.局部变量 可视区一行点个数, 整数型, , , 
.局部变量 可视区结束点号, 整数型, , , 

赋值 (可视区结束点号, 取可视区结束点号 ())
赋值 (可视区一行点个数, 取可视区一行点数 ())
返回 (相加 (相减 (可视区结束点号, 可视区一行点个数), 1))

.子程序 隐藏滚动条, 空白型, 公开, 
赋值 (滚动条.禁止, 真)
赋值 (滚动条位置, 0)


.子程序 清空绘画区, 空白型, 公开, 
背景画板.清除 ()

.子程序 test, 空白型, 公开, 
.局部变量 任务索引, 整数型, , , 
.局部变量 测试长度, 空白型, 静态, , 
.局部变量 矩阵坐标, 矩阵坐标, , , 
.局部变量 匿名局部变量_2328, 空白型, , , 
.局部变量 记次变量, 整数型, , , 

.如果真 (等于 (测试长度, 0))
    赋值 (任务索引, 增加任务 (相乘 (40960, 10), 4096))
    设置活动任务 (任务索引)
.如果真结束

未知函数_610 () '  *** 被屏蔽的程序块 ***
赋值 (矩阵坐标.横坐标, 10)
赋值 (矩阵坐标.纵坐标, 13)
画矩阵指定点 (任务索引, 矩阵坐标)

赋值 (矩阵坐标.横坐标, 11)
赋值 (矩阵坐标.纵坐标, 14)
画矩阵指定点 (任务索引, 矩阵坐标)


赋值 (矩阵坐标.横坐标, 12)
赋值 (矩阵坐标.纵坐标, 15)
画矩阵指定点 (任务索引, 矩阵坐标)

.变量循环首 (1, 5, 1, 记次变量)
    画矩阵指定横行 (任务索引, 记次变量)
.变量循环尾 ()

行复制 (1, 5, 7)


重画 ()
改变进度 (任务索引, 1, 相加 (相乘 (4096, 5), 10), #已下载点, #正下载点)


改变进度 (任务索引, 相乘 (4096, 10), 相加 (相乘 (4096, 15), 10), #已下载点, #正下载点)



.窗口程序集 增加新任务窗口程序集, , , 

.子程序 _取消按钮_被单击, 空白型, , 
赋值 (当前任务信息.文件名, “”)
赋值 (当前任务信息.网址, “”)

销毁 ()

.子程序 _增加新任务_创建完毕, 空白型, , 
.局部变量 任务序号, 整数型, , , 
.局部变量 匿名局部变量_2809, 空白型, , , 


.判断开始 (等于 (新建或属性, 1))
    
    .如果真 (等于 (.选中, 假))
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
        赋值 (.背景颜色, #默认色)
        赋值 (.背景颜色, #默认色)
    .如果真结束
    
    赋值 (.内容, 取剪辑板文本 ())
    填充类别 ()
    设置另存路径 ()
    赋值 (.内容, 取网址引用 (.内容))
    赋值 (.内容, 取文件名 (.内容))
    
.默认
    
    赋值 (增加新任务., “任务属性”)
    .如果真 (等于 (.选中, 假))
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
        赋值 (.背景颜色, #默认色)
        赋值 (.背景颜色, #默认色)
    .如果真结束
    
    赋值 (任务序号, 界面基础控件.取统计框当前表项数值 ())
    .如果真 (小于 (任务序号, 1))
        增加新任务.总在最前 ＝ 假
        设置窗口位置 (增加新任务.取窗口句柄 (), 0, 0, 0, 0, 0, 3)
        
        返回 ()
    .如果真结束
    
    赋值 (.内容, 下载对象 [任务序号], 任务常规信息.网址)
    填充类别 ()
    设置另存路径 ()
    赋值 (.内容, 取网址引用 (.内容))
    赋值 (.内容, 取文件名 (.内容))
    
.判断结束

赋值 (.选中, 真)
_使用服务器提供文件名_选择框_被单击 ()

设置窗口位置 (增加新任务.取窗口句柄 (), 0, 0, 0, 0, 0, 3)

增加新任务.总在最前 ＝ 假

.子程序 填充类别, 空白型, , 
.局部变量 目录个数, 整数型, , , 
.局部变量 记次变量, 整数型, , , 
.局部变量 目录名, 文本型, , , 

清空 ()
置当前库 (“dir”)
到首记录 ()
赋值 (目录个数, 取目录个数 ())
.计次循环首 (目录个数, 记次变量)
    赋值 (目录名, 读 (“目录名称”))
    目录名.加入项目 ()
    .如果真 (等于 (记次变量, 2))
        赋值 (.内容, 目录名)
    .如果真结束
    跳过 ()
.计次循环尾 ()


.子程序 设置另存路径, 空白型, , 
.局部变量 路径, 文本型, , , 

赋值 (路径, 获得目录对应路径 (.内容))
.如果真 (等于 (路径, “”))
    结束 ()
.如果真结束

赋值 (.内容, 路径)


.子程序 获得目录对应路径, 文本型, , 
.参数 目录名, 文本型, , 

.局部变量 错误信息, 文本型, , , 

置当前库 (“dir”)
到首记录 ()
.如果 (等于 (查找 (等于 (读 (“目录名称”), 目录名)), 假))
    赋值 (错误信息, 取错误信息 ())
    信息框 (错误信息, 0, “访问数据库错误”)
    返回 (“”)
.否则
    返回 (读 (“对应目录路径”))
.如果结束



.子程序 _登陆到_选择框_被单击, 空白型, , 
 ' .判断开始 (等于 (.选中, 真))
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.背景颜色, #白色)
    赋值 (.背景颜色, #白色)
.默认
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.背景颜色, #默认色)
    赋值 (.背景颜色, #默认色)
.判断结束


.子程序 _保存到浏览按钮_被单击, 空白型, , 
赋值 (.内容, 未知支持库函数_2 (“请选择需要另存的目录”, 假))

.子程序 _确定按钮_被单击, 空白型, , 
.判断开始 (等于 (新建或属性, 1))
    .如果 (不等于 (.内容, “”))
        赋值 (当前任务信息.文件名, .内容)
        赋值 (当前任务信息.网址, .内容)
        赋值 (当前任务信息.创建时间, 取现行时间 ())
        赋值 (当前任务信息.注释, .内容)
        赋值 (当前任务信息.默认线程数, 到数值 (.内容))
        赋值 (当前任务信息.用户名, .内容)
        赋值 (当前任务信息.密码, .内容)
        赋值 (当前任务信息.保存目录, .内容)
        
        .判断开始 (等于 (.选中, 真))
            赋值 (当前任务信息.同名文件处理, #.)
        .判断 (等于 (.选中, 真))
            赋值 (当前任务信息.同名文件处理, #.)
        .判断 (等于 (.选中, 真))
            赋值 (当前任务信息.同名文件处理, #.)
        .默认
            
        .判断结束
        
        .如果 (不等于 (取文本右边 (.内容, 1), “\”))
            赋值 (当前任务信息.文件路径, 相加 (.内容, “\”, .内容))
        .否则
            赋值 (当前任务信息.文件路径, 相加 (.内容, .内容))
        .如果结束
        销毁 ()
    .否则
        信息框 (“输入错误”, 0, “错误 ”)
        返回 ()
    .如果结束
    
    
.默认
    销毁 ()
.判断结束


.子程序 _类别_组合框_列表项被选择, 空白型, , 
设置另存路径 ()

.子程序 _使用服务器提供文件名_选择框_被单击, 空白型, , 
.判断开始 (等于 (.选中, 真))
    赋值 (.内容, “”)
    赋值 (.禁止, 真)
    赋值 (.背景颜色, #默认色)
.默认
    赋值 (.内容, 取文件名 (.内容))
    赋值 (.禁止, 假)
    赋值 (.背景颜色, #白色)
.判断结束


.窗口程序集 创建新类别窗口程序集, , , 

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _按钮3_被单击, 空白型, , 
赋值 (.内容, 未知支持库函数_2 (“请查找目录”, 假))

.子程序 _按钮1_被单击, 空白型, , 
.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“填写不完整”, 0, “信息”)
.如果真结束
.如果 (等于 (创建目录记录 (.内容, .内容, 真), 假))
    信息框 (相加 (“创建错误:”, 取错误信息 ()), 0, “消息”)
.否则
    界面基础控件.设置树型控制框 ()
    销毁 ()
.如果结束


.子程序 _创建新类别_创建完毕, 空白型, , 


.程序集 目录数据库操作, , , 本源码无版权，但引用决不能去掉易语言的广告条

.子程序 创建默认目录管理数据库, 逻辑型, , 
.局部变量 字段信息表, 字段信息, , "0", 
.局部变量 字段信息, 字段信息, , , 
.局部变量 默认目录, 文本型, , , 

赋值 (字段信息.名称, “对应目录路径”)
赋值 (字段信息.类型, #文本型)
赋值 (字段信息.最大文本长度, 256)
加入成员 (字段信息表, 字段信息)

赋值 (字段信息.名称, “目录名称”)
赋值 (字段信息.类型, #文本型)
赋值 (字段信息.最大文本长度, 256)
加入成员 (字段信息表, 字段信息)

.如果真 (等于 (创建 (相加 (取当前目录 (), “\dir.edb”), 字段信息表), 假))
    返回 (假)
.如果真结束

.如果真 (等于 (打开目录管理数据库 (), 假))
    信息框 (“仍然无法打开目录管理数据库，程序无法运行”, 0, “错误”)
    结束 ()
.如果真结束
赋值 (默认目录, 相加 (取运行目录 (), “\下载文件”))
创建目录 (默认目录)
加记录 (默认目录, “正在下载”)
加记录 (默认目录, “已下载”)
加记录 (默认目录, “已删除”)
返回 (真)

.子程序 打开目录管理数据库, 逻辑型, , 
.如果 (等于 (打开 (“dir.edb”, , , , , , ), 真))
    .如果 (等于 (置当前库 (“dir”), 真))
        返回 (真)
    .否则
        返回 (假)
    .如果结束
    
.否则
    返回 (假)
.如果结束


.子程序 创建目录记录, 逻辑型, , 
.参数 目录名称, 文本型, , 
.参数 对应目录路径, 文本型, , 
.参数 是否创建相应数据库记录, 逻辑型, , 

.局部变量 字段信息表, 字段信息, , "0", 
.局部变量 字段信息, 字段信息, , , 
.局部变量 最后记录_目录名称, 文本型, , , 
.局部变量 最后记录_对应目录路径, 文本型, , , 

.如果真 (等于 (是否创建相应数据库记录, 真))
    置当前库 (“dir”)
    到首记录 ()
    .如果真 (等于 (查找 (等于 (读 (“目录名称”), 目录名称)), 真))
        信息框 (“目录名重名”, 0, “错误”)
        返回 (真)
    .如果真结束
    到尾记录 ()
    赋值 (最后记录_目录名称, 读 (“目录名称”))
    赋值 (最后记录_对应目录路径, 读 (“对应目录路径”))
    删除 ()
    彻底删除 ()
    加记录 (对应目录路径, 目录名称)
    加记录 (最后记录_对应目录路径, 最后记录_目录名称)
    
.如果真结束

赋值 (字段信息.名称, “文件名”)
赋值 (字段信息.类型, #文本型)
赋值 (字段信息.最大文本长度, 256)
加入成员 (字段信息表, 字段信息)

赋值 (字段信息.名称, “大小”)
赋值 (字段信息.类型, #整数型)
加入成员 (字段信息表, 字段信息)

赋值 (字段信息.名称, “完成数”)
赋值 (字段信息.类型, #整数型)
加入成员 (字段信息表, 字段信息)

赋值 (字段信息.名称, “块数”)
赋值 (字段信息.类型, #整数型)
加入成员 (字段信息表, 字段信息)

赋值 (字段信息.名称, “URL”)
赋值 (字段信息.类型, #文本型)
赋值 (字段信息.最大文本长度, 256)
加入成员 (字段信息表, 字段信息)

赋值 (字段信息.名称, “创建时间”)
赋值 (字段信息.类型, #日期时间型)
加入成员 (字段信息表, 字段信息)

赋值 (字段信息.名称, “完成时间”)
赋值 (字段信息.类型, #日期时间型)
加入成员 (字段信息表, 字段信息)

赋值 (字段信息.名称, “注释”)
赋值 (字段信息.类型, #文本型)
赋值 (字段信息.最大文本长度, 256)
加入成员 (字段信息表, 字段信息)

赋值 (字段信息.名称, “点型进度”)
赋值 (字段信息.类型, #字节集型)
加入成员 (字段信息表, 字段信息)

赋值 (字段信息.名称, “任务信息”)
赋值 (字段信息.类型, #字节集型)
加入成员 (字段信息表, 字段信息)

赋值 (字段信息.名称, “文件路径”)
赋值 (字段信息.类型, #文本型)
赋值 (字段信息.最大文本长度, 256)
加入成员 (字段信息表, 字段信息)

赋值 (字段信息.名称, “文件状态”)
赋值 (字段信息.类型, #整数型)
加入成员 (字段信息表, 字段信息)

赋值 (字段信息.名称, “用户名”)
赋值 (字段信息.类型, #文本型)
赋值 (字段信息.最大文本长度, 256)
加入成员 (字段信息表, 字段信息)

赋值 (字段信息.名称, “密码”)
赋值 (字段信息.类型, #文本型)
赋值 (字段信息.最大文本长度, 256)
加入成员 (字段信息表, 字段信息)

赋值 (字段信息.名称, “对象序号”)
赋值 (字段信息.类型, #整数型)
加入成员 (字段信息表, 字段信息)


赋值 (字段信息.名称, “保存目录”)
赋值 (字段信息.类型, #文本型)
赋值 (字段信息.最大文本长度, 256)
加入成员 (字段信息表, 字段信息)

返回 (创建 (相加 (目录名称, “.edb”), 字段信息表))


.子程序 删除目录记录, 逻辑型, , 
.参数 目录名称, 文本型, , 

 ' 置目录数据库 ()
到首记录 ()
.如果真 (等于 (删除 (等于 (读 (“目录名称”), 目录名称)), 假))
    返回 (假)
.如果真结束
彻底删除 ()
关闭 (目录名称)
.如果真 (或者 (等于 (删除文件 (相加 (目录名称, “.edb”)), 假), 等于 (删除文件 (相加 (目录名称, “.edt”)), 假)))
    返回 (假)
.如果真结束
返回 (真)

.子程序 修改目录, 逻辑型, , 
.参数 目录名称, 文本型, , 
.参数 新目录路径, 文本型, , 

 ' 置目录数据库 ()
到首记录 ()
.如果真 (等于 (查找 (等于 (读 (“目录名称”), 目录名称)), 假))
    返回 (假)
.如果真结束

写 (“对应目录路径”, 新目录路径)
返回 (真)


.子程序 取目录个数, 整数型, , 
返回 (取记录数 ())

.子程序 取指定目录名所对应的目录路径, 文本型, , 
.参数 目录名, 文本型, , 

.如果真 (等于 (查找 (等于 (“目录名称”, 目录名)), 假))
    返回 (“”)
.如果真结束

返回 (读 (取记录号 ()))

.子程序 置目录数据库, 空白型, , 
置当前库 (“dir”)

.窗口程序集 删除类别窗口程序集, , , 

.子程序 _按钮1_被单击, 空白型, , 
.如果 (等于 (删除目录记录 (.内容), 假))
    信息框 (相加 (“删除错误:”, 取错误信息 ()), 0, “消息”)
.否则
    填充类别_5 ()
    界面基础控件.设置树型控制框 ()
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _删除类别_创建完毕, 空白型, , 
填充类别_5 ()

.子程序 填充类别_5, 空白型, , 
.局部变量 目录个数, 整数型, , , 
.局部变量 记次变量, 整数型, , , 
.局部变量 目录名, 文本型, , , 

清空 ()
置当前库 (“dir”)
到首记录 ()
赋值 (目录个数, 取目录个数 ())
.计次循环首 (目录个数, 记次变量)
    赋值 (目录名, 读 (“目录名称”))
    目录名.加入项目 ()
    .如果真 (等于 (记次变量, 1))
        赋值 (.内容, 目录名)
    .如果真结束
    跳过 ()
.计次循环尾 ()

.窗口程序集 选项窗口窗口程序集, , , 

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _日志_颜色选择器_颜色被改变, 空白型, , 
赋值 (.背景颜色, .颜色)


.子程序 _按钮1_被单击, 空白型, , 
赋值 (系统配置信息.日志背景颜色, .背景颜色)
赋值 (系统配置信息.下载数据自动保存时间, 到数值 (.内容))
赋值 (系统配置信息.写入磁盘大小, 到数值 (.内容))
赋值 (系统配置信息.接收大小, 到数值 (.内容))
赋值 (系统配置信息.速度, 到数值 (.内容))
赋值 (系统配置信息.连接超时, 到数值 (.内容))
赋值 (系统配置信息.发送超时, 到数值 (.内容))
赋值 (系统配置信息.接收超时, 到数值 (.内容))
赋值 (系统配置信息.线程超时, 到数值 (.内容))
赋值 (系统配置信息.最大任务数, 到数值 (.内容))
赋值 (系统配置信息.最大重试数, 到数值 (.内容))
赋值 (系统配置信息.重试时间, 到数值 (.内容))
写系统变量到配置信息 ()
赋值 (下载数据自动保存时间, 系统配置信息.下载数据自动保存时间)
销毁 ()

.子程序 _选项窗口_创建完毕, 空白型, , 
读配置信息到系统变量 ()

赋值 (.背景颜色, 系统配置信息.日志背景颜色)
赋值 (.内容, 到文本 (系统配置信息.下载数据自动保存时间))
赋值 (.内容, 到文本 (系统配置信息.写入磁盘大小))
赋值 (.内容, 到文本 (系统配置信息.接收大小))
赋值 (.内容, 到文本 (系统配置信息.速度))
赋值 (.内容, 到文本 (系统配置信息.连接超时))
赋值 (.内容, 到文本 (系统配置信息.发送超时))
赋值 (.内容, 到文本 (系统配置信息.接收超时))
赋值 (.内容, 到文本 (系统配置信息.线程超时))
赋值 (.内容, 到文本 (系统配置信息.最大任务数))
赋值 (.内容, 到文本 (系统配置信息.最大重试数))
赋值 (.内容, 到文本 (系统配置信息.重试时间))


.程序集 下载信息数据库操作, , , 本源码无版权，但引用决不能去掉易语言的广告条

.子程序 打开下载信息数据库, 逻辑型, , 
.参数 目录名, 文本型, , 

.如果 (等于 (打开 (相加 (目录名, “.edb”), , , , , , ), 假))
    .判断开始 (等于 (取错误码 (), -38))
        返回 (真)
    .默认
        返回 (假)
    .判断结束
    
.否则
    
.如果结束
返回 (真)

.子程序 置下载信息数据库, 逻辑型, , 
.参数 目录名, 文本型, , 

返回 (置当前库 (目录名))

.子程序 取文件个数, 整数型, , 
返回 (取记录数 ())


.子程序 加入任务记录, 空白型, , 
.参数 目录名, 文本型, , 
.参数 对象序号, 整数型, , 
.参数 文件名, 文本型, , 
.参数 大小, 整数型, , 
.参数 完成数, 整数型, , 
.参数 块数, 整数型, , 
.参数 网址, 文本型, , 
.参数 创建时间, 日期时间型, , 
.参数 完成时间, 日期时间型, , 
.参数 注释, 文本型, , 
.参数 点型进度, 字节集, , 
.参数 任务信息, 字节集, , 
.参数 文件路径, 文本型, , 
.参数 文件状态, 整数型, , 
.参数 用户名, 文本型, , 
.参数 密码, 文本型, , 
.参数 保存目录, 文本型, , 

置下载信息数据库 (目录名)
加记录 (文件名, 大小, 完成数, 块数, 网址, 创建时间, 完成时间, 注释, 点型进度, 任务信息, 文件路径, 文件状态, 用户名, 密码, 对象序号, 保存目录)


.子程序 删除任务记录, 逻辑型, , 
.参数 目录名, 文本型, , 
.参数 文件名, 文本型, , 

.局部变量 文件路径, 文本型, , , 

置下载信息数据库 (目录名)
到首记录 ()
.如果 (等于 (查找 (等于 (读 (“文件名”), 文件名)), 真))
    赋值 (文件路径, 读 (“文件路径”))
    删除文件 (文件路径)
    删除 ()
    彻底删除 ()
    返回 (真)
.否则
    返回 (假)
.如果结束


.子程序 移动任务记录, 逻辑型, , 
.参数 目录名, 文本型, , 
.参数 文件名, 文本型, , 
.参数 移动到目录名, 文本型, , 
.参数 任务序号, 整数型, , 

.局部变量 大小, 整数型, , , 
.局部变量 完成数, 整数型, , , 
.局部变量 块数, 整数型, , , 
.局部变量 网址, 文本型, , , 
.局部变量 创建时间, 日期时间型, , , 
.局部变量 完成时间, 日期时间型, , , 
.局部变量 注释, 文本型, , , 
.局部变量 点型进度, 字节集, , , 
.局部变量 任务信息, 字节集, , , 
.局部变量 文件路径, 文本型, , , 
.局部变量 文件状态, 整数型, , , 
.局部变量 用户名, 文本型, , , 
.局部变量 密码, 文本型, , , 
.局部变量 保存目录, 文本型, , , 

置下载信息数据库 (目录名)
到首记录 ()
.如果 (等于 (查找 (等于 (读 (“文件名”), 文件名)), 真))
    赋值 (大小, 读 (“大小”))
    赋值 (完成数, 读 (“完成数”))
    赋值 (块数, 读 (“块数”))
    赋值 (网址, 读 (“URL”))
    赋值 (创建时间, 读 (“创建时间”))
    赋值 (完成时间, 读 (“完成时间”))
    赋值 (注释, 读 (“注释”))
    赋值 (点型进度, 读 (“点型进度”))
    赋值 (任务信息, 读 (“任务信息”))
    赋值 (文件路径, 读 (“文件路径”))
    赋值 (文件状态, 读 (“文件状态”))
    赋值 (用户名, 读 (“用户名”))
    赋值 (密码, 读 (“密码”))
    赋值 (保存目录, 读 (“保存目录”))
    
    置下载信息数据库 (移动到目录名)
    加入任务记录 (移动到目录名, 任务序号, 文件名, 大小, 完成数, 块数, 网址, 创建时间, 完成时间, 注释, 点型进度, 任务信息, 文件路径, 文件状态, 用户名, 密码, 保存目录)
    置下载信息数据库 (目录名)
    查找 (等于 (读 (“文件名”), 文件名))
    删除 ()
    彻底删除 ()
    
    返回 (真)
.否则
    信息框 (相加 (“删除记录错误:”, 取错误信息 ()), 0, )
    返回 (假)
.如果结束


.子程序 修改任务信息记录, 空白型, , 
.参数 目录名, 文本型, , 
.参数 对象序号, 整数型, , 
.参数 文件名, 文本型, 可空, 
.参数 大小, 整数型, 可空, 
.参数 完成数, 整数型, 可空, 
.参数 块数, 整数型, 可空, 
.参数 网址, 文本型, 可空, 
.参数 创建时间, 日期时间型, 可空, 
.参数 完成时间, 日期时间型, 可空, 
.参数 注释, 文本型, 可空, 
.参数 点型进度, 字节集, 可空, 
.参数 任务信息, 字节集, 可空, 
.参数 文件路径, 文本型, 可空, 
.参数 文件状态, 整数型, 可空, 
.参数 用户名, 文本型, 可空, 
.参数 密码, 文本型, 可空, 
.参数 保存目录, 文本型, 可空, 

置下载信息数据库 (目录名)
到首记录 ()
.如果真 (查找 (等于 (读 (“URL”), 网址)))
    .判断开始 (等于 (是否为空 (文件名), 假))
        写 (“文件名”, 文件名)
    .默认
        
    .判断结束
    
    .判断开始 (等于 (是否为空 (大小), 假))
        写 (“大小”, 大小)
    .默认
        
    .判断结束
    
    
    .判断开始 (等于 (是否为空 (完成数), 假))
        写 (“完成数”, 完成数)
    .默认
        
    .判断结束
    
    .判断开始 (等于 (是否为空 (块数), 假))
        写 (“块数”, 块数)
    .默认
        
    .判断结束
    
    .判断开始 (等于 (是否为空 (网址), 假))
        写 (“网址”, 网址)
    .默认
        
    .判断结束
    
    .判断开始 (等于 (是否为空 (创建时间), 假))
        写 (“创建时间”, 创建时间)
    .默认
        
    .判断结束
    
    .判断开始 (等于 (是否为空 (完成时间), 假))
        写 (“完成时间”, 完成时间)
    .默认
        
    .判断结束
    
    .判断开始 (等于 (是否为空 (注释), 假))
        写 (“注释”, 注释)
    .默认
        
    .判断结束
    
    .判断开始 (等于 (是否为空 (点型进度), 假))
        写 (“点型进度”, 点型进度)
    .默认
        
    .判断结束
    
    .判断开始 (等于 (是否为空 (任务信息), 假))
        写 (“任务信息”, 任务信息)
    .默认
        
    .判断结束
    
    .判断开始 (等于 (是否为空 (文件路径), 假))
        写 (“文件路径”, 文件路径)
    .默认
        
    .判断结束
    
    .判断开始 (等于 (是否为空 (文件状态), 假))
        写 (“文件状态”, 文件状态)
    .默认
        
    .判断结束
    
    .判断开始 (等于 (是否为空 (用户名), 假))
        写 (“用户名”, 用户名)
    .默认
        
    .判断结束
    
    .判断开始 (等于 (是否为空 (密码), 假))
        写 (“密码”, 密码)
    .默认
        
    .判断结束
    
    .判断开始 (等于 (是否为空 (保存目录), 假))
        写 (“保存目录”, 保存目录)
    .默认
        
    .判断结束
    
.如果真结束


.程序集 辅助函数集, , , 本源码无版权，但引用决不能去掉易语言的广告条

.子程序 取网址引用, 文本型, , 
.参数 网址, 文本型, , 

.局部变量 分隔块, 文本型, , "0", 
.局部变量 块数, 整数型, , , 
.局部变量 记次变量, 整数型, , , 
.局部变量 引用, 文本型, , , 

赋值 (分隔块, 分割文本 (网址, “/”, ))
赋值 (块数, 取数组成员数 (分隔块))
.如果真 (或者 (等于 (块数, 0), 并且 (等于 (寻找文本 (分隔块 [1], “http:”, 1, 假), -1), 等于 (寻找文本 (分隔块 [1], “ftp:”, 1, 假), -1))))
    返回 (“”)
.如果真结束
.变量循环首 (1, 相减 (块数, 1), 1, 记次变量)
    .判断开始 (等于 (记次变量, 1))
        赋值 (引用, 相加 (引用, 分隔块 [记次变量]))
    .默认
        赋值 (引用, 相加 (引用, “/”, 分隔块 [记次变量]))
    .判断结束
    
.变量循环尾 ()
赋值 (引用, 相加 (引用, “/”))
返回 (引用)

.子程序 取文件名, 文本型, , 
.参数 网址, 文本型, , 

.局部变量 分隔块, 文本型, , "0", 
.局部变量 块数, 整数型, , , 
.局部变量 文件名, 文本型, , , 

赋值 (分隔块, 分割文本 (网址, “/”, ))
赋值 (块数, 取数组成员数 (分隔块))
.如果真 (或者 (等于 (块数, 0), 等于 (寻找文本 (分隔块 [块数], “.”, 1, 假), -1)))
    返回 (“”)
.如果真结束
返回 (分隔块 [块数])

.子程序 分割协议头多行文本, 空白型, , 
.参数 多行文本, 文本型, , 
.参数 返回单行数组, 文本型, 参考 数组, 

.如果真 (等于 (多行文本, “”))
    返回 ()
.如果真结束
赋值 (返回单行数组, 分割文本 (多行文本, #换行符, ))
.如果真 (等于 (返回单行数组 [取数组成员数 (返回单行数组)], “”))
    删除成员 (返回单行数组, 取数组成员数 (返回单行数组), )
    .如果真 (等于 (返回单行数组 [取数组成员数 (返回单行数组)], “”))
        删除成员 (返回单行数组, 取数组成员数 (返回单行数组), )
    .如果真结束
    
.如果真结束


.子程序 字节集到字节集数组, 空白型, , 
.参数 字节集, 字节集, , 
.参数 字节集数组, 字节集, 参考 数组, 

.局部变量 字节集长度, 整数型, , , 
.局部变量 记次变量, 整数型, , , 
.局部变量 中间字节集, 字节集, , , 

赋值 (字节集长度, 取字节集长度 (字节集))
重定义数组 (字节集数组, 假, 字节集长度)
.变量循环首 (1, 字节集长度, 1, 记次变量)
    赋值 (中间字节集, 取字节集中间 (字节集, 记次变量, 1))
    赋值 (字节集数组 [记次变量], 中间字节集)
.变量循环尾 ()

.子程序 读配置信息到系统变量, 空白型, , 
.局部变量 当前目录, 文本型, , , 

赋值 (当前目录, 相加 (取当前目录 (), “\”))
赋值 (系统配置信息.下载数据自动保存时间, 到数值 (读配置项 (相加 (当前目录, “eget.ini”), “config”, “列表保存时间”, 到文本 (#默认下载数据自动保存时间))))
赋值 (系统配置信息.写入磁盘大小, 到数值 (读配置项 (相加 (当前目录, “eget.ini”), “config”, “写入磁盘时间”, 到文本 (#默认写入磁盘大小))))
赋值 (系统配置信息.接收大小, 到数值 (读配置项 (相加 (当前目录, “eget.ini”), “config”, “接收大小”, 到文本 (#默认接收大小))))
赋值 (系统配置信息.连接超时, 到数值 (读配置项 (相加 (当前目录, “eget.ini”), “config”, “连接超时”, 到文本 (#默认连接超时))))
赋值 (系统配置信息.发送超时, 到数值 (读配置项 (相加 (当前目录, “eget.ini”), “config”, “发送超时 ”, 到文本 (#默认发送超时))))
赋值 (系统配置信息.接收超时, 到数值 (读配置项 (相加 (当前目录, “eget.ini”), “config”, “接收超时”, 到文本 (#默认接收超时))))
赋值 (系统配置信息.线程超时, 到数值 (读配置项 (相加 (当前目录, “eget.ini”), “config”, “线程超时”, 到文本 (#默认线程超时))))
赋值 (系统配置信息.最大任务数, 到数值 (读配置项 (相加 (当前目录, “eget.ini”), “config”, “最大任务数”, 到文本 (#默认最大任务数))))
赋值 (系统配置信息.最大重试数, 到数值 (读配置项 (相加 (当前目录, “eget.ini”), “config”, “重试”, 到文本 (#默认最大重试数))))
赋值 (系统配置信息.速度, 到数值 (读配置项 (相加 (当前目录, “eget.ini”), “config”, “速度”, 到文本 (#默认速度))))
赋值 (系统配置信息.重试时间, 到数值 (读配置项 (相加 (当前目录, “eget.ini”), “config”, “重试时间”, 到文本 (#默认重试时间))))

赋值 (系统配置信息.日志背景颜色, 到数值 (读配置项 (相加 (当前目录, “eget.ini”), “config”, “日志背景色”, 到文本 (#默认日志背景颜色))))

.子程序 写系统变量到配置信息, 空白型, , 
.局部变量 当前目录, 文本型, , , 

赋值 (当前目录, 相加 (取当前目录 (), “\”))
写配置项 (相加 (当前目录, “eget.ini”), “config”, “列表保存时间”, 到文本 (系统配置信息.下载数据自动保存时间))
写配置项 (相加 (当前目录, “eget.ini”), “config”, “写入磁盘时间”, 到文本 (系统配置信息.写入磁盘大小))
写配置项 (相加 (当前目录, “eget.ini”), “config”, “接收大小”, 到文本 (系统配置信息.接收大小))
写配置项 (相加 (当前目录, “eget.ini”), “config”, “连接超时”, 到文本 (系统配置信息.连接超时))
写配置项 (相加 (当前目录, “eget.ini”), “config”, “发送超时 ”, 到文本 (系统配置信息.发送超时))
写配置项 (相加 (当前目录, “eget.ini”), “config”, “接收超时”, 到文本 (系统配置信息.接收超时))
写配置项 (相加 (当前目录, “eget.ini”), “config”, “线程超时”, 到文本 (系统配置信息.线程超时))
写配置项 (相加 (当前目录, “eget.ini”), “config”, “最大任务数”, 到文本 (系统配置信息.最大任务数))
写配置项 (相加 (当前目录, “eget.ini”), “config”, “重试”, 到文本 (系统配置信息.最大重试数))
写配置项 (相加 (当前目录, “eget.ini”), “config”, “速度”, 到文本 (系统配置信息.速度))
写配置项 (相加 (当前目录, “eget.ini”), “config”, “重试时间”, 到文本 (系统配置信息.重试时间))
写配置项 (相加 (当前目录, “eget.ini”), “config”, “日志背景色”, 到文本 (系统配置信息.日志背景颜色))


.子程序 初始化函数, 空白型, , 
.局部变量 记次变量, 整数型, , , 
.局部变量 当前目录, 文本型, , , 
.局部变量 句柄, 整数型, , , 

赋值 (句柄, 创建一个互斥体_ (0, 1, “易语言下载快车”))

赋值 (当前目录, 相加 (取当前目录 (), “\”))
.如果 (等于 (文件是否存在 (相加 (当前目录, “eget.ini”)), 真))
    读配置信息到系统变量 ()
.否则
    
     ' 系统默认
    赋值 (系统配置信息.下载数据自动保存时间, #默认下载数据自动保存时间)
    赋值 (系统配置信息.写入磁盘大小, #默认写入磁盘大小)
    赋值 (系统配置信息.接收大小, #默认接收大小)
    赋值 (系统配置信息.连接超时, #默认连接超时)
    赋值 (系统配置信息.发送超时, #默认发送超时)
    赋值 (系统配置信息.接收超时, #默认接收超时)
    赋值 (系统配置信息.线程超时, #默认线程超时)
    赋值 (系统配置信息.最大任务数, #默认最大任务数)
    赋值 (系统配置信息.最大重试数, #默认最大重试数)
    赋值 (系统配置信息.速度, #默认速度)
    赋值 (系统配置信息.重试时间, #默认重试时间)
    赋值 (系统配置信息.日志背景颜色, #默认日志背景颜色)
    写系统变量到配置信息 ()
.如果结束

未知支持库函数_0 (系统配置信息.写入磁盘大小, 系统配置信息.重试时间, 系统配置信息.最大重试数)
赋值 (下载数据自动保存时间, 系统配置信息.下载数据自动保存时间)

.子程序 载入新建或属性窗口, 空白型, , 
.参数 载入类型, 整数型, , 


赋值 (新建或属性, 载入类型)

载入 (增加新任务, _启动窗口, 真)

.子程序 加入右键菜单, 逻辑型, , 
.局部变量 操作是否成功, 逻辑型, , , 


注册IE右键 ()

赋值 (操作是否成功, 写注册项 (#现行用户, “Software\Microsoft\Internet Explorer\MenuExt\使用易语言下载快车下载\”, 相加 (取当前目录 (), “\edown_link.htm”)))
.如果真 (等于 (操作是否成功, 假))
    返回 (假)
.如果真结束

赋值 (操作是否成功, 写注册项 (#现行用户, “Software\Microsoft\Internet Explorer\MenuExt\使用易语言下载快车下载\contexts”, 34))
.如果真 (等于 (操作是否成功, 假))
    返回 (假)
.如果真结束

赋值 (操作是否成功, 写注册项 (#现行用户, “Software\Microsoft\Internet Explorer\MenuExt\使用易语言下载快车下载\FilePath”, 相加 (取运行目录 (), “\”, 取执行文件名 ())))
.如果真 (等于 (操作是否成功, 假))
    返回 (假)
.如果真结束

赋值 (操作是否成功, 写注册项 (#现行用户, “Software\Microsoft\Internet Explorer\MenuExt\使用易语言下载快车下载\MutexName”, #互斥体名称))
.如果真 (等于 (操作是否成功, 假))
    返回 (假)
.如果真结束

赋值 (操作是否成功, 写注册项 (#现行用户, “Software\Microsoft\Internet Explorer\MenuExt\使用易语言下载快车下载\WinTitle”, #窗口标题))

赋值 (操作是否成功, 写注册项 (#现行用户, “Software\Microsoft\Internet Explorer\MenuExt\使用易语言下载快车下载\MainWindowHandle”, 到文本 (_启动窗口.取窗口句柄 ())))
返回 (真)


.子程序 加入IE工具栏, 空白型, , 
.局部变量 操作是否成功, 逻辑型, , , 
.局部变量 下个序号, 整数型, , , 


赋值 (操作是否成功, 注册项是否存在 (#现行用户, 相加 (“software\Microsoft\Internet Explorer\Extensions\CmdMapping\”, #右键对象标示)))
.如果真 (不等于 (操作是否成功, 真))
    赋值 (下个序号, 取数值注册项 (#现行用户, “software\Microsoft\Internet Explorer\Extensions\CmdMapping\NextId”, ))
    赋值 (操作是否成功, 写注册项 (#现行用户, 相加 (“SOFTWARE\Microsoft\Internet Explorer\Extensions\CmdMapping\”, #右键对象标示), 下个序号))
    赋值 (下个序号, 相加 (下个序号, 1))
    赋值 (操作是否成功, 写注册项 (#现行用户, “SOFTWARE\Microsoft\Internet Explorer\Extensions\CmdMapping\NextId”, 下个序号))
    .如果真 (等于 (操作是否成功, 假))
        返回 ()
    .如果真结束
    
.如果真结束

赋值 (操作是否成功, 注册项是否存在 (#本地机器, 相加 (“SOFTWARE\Microsoft\Internet Explorer\Extensions\”, #右键对象标示)))
.如果真 (等于 (操作是否成功, 真))
    返回 ()
.如果真结束

赋值 (操作是否成功, 写注册项 (#本地机器, 相加 (“SOFTWARE\Microsoft\Internet Explorer\Extensions\”, #右键对象标示, “\”), “”))
.如果真 (等于 (操作是否成功, 假))
    返回 ()
.如果真结束

赋值 (操作是否成功, 写注册项 (#本地机器, 相加 (“SOFTWARE\Microsoft\Internet Explorer\Extensions\”, #右键对象标示, “\”, “ButtonText”), #窗口标题))
.如果真 (等于 (操作是否成功, 假))
    返回 ()
.如果真结束

赋值 (操作是否成功, 写注册项 (#本地机器, 相加 (“SOFTWARE\Microsoft\Internet Explorer\Extensions\”, #右键对象标示, “\”, “CLSID”), “{1FBA04EE-3024-11d2-8F1F-0000F87ABD16}”))
.如果真 (等于 (操作是否成功, 假))
    返回 ()
.如果真结束


赋值 (操作是否成功, 写注册项 (#本地机器, 相加 (“SOFTWARE\Microsoft\Internet Explorer\Extensions\”, #右键对象标示, “\”, “Default Visible”), “Yes”))
.如果真 (等于 (操作是否成功, 假))
    返回 ()
.如果真结束

赋值 (操作是否成功, 写注册项 (#本地机器, 相加 (“SOFTWARE\Microsoft\Internet Explorer\Extensions\”, #右键对象标示, “\”, “Exec”), 相加 (取运行目录 (), “\”, 取执行文件名 ())))
.如果真 (等于 (操作是否成功, 假))
    返回 ()
.如果真结束

赋值 (操作是否成功, 写注册项 (#本地机器, 相加 (“SOFTWARE\Microsoft\Internet Explorer\Extensions\”, #右键对象标示, “\”, “HotIcon”), 相加 (取运行目录 (), “\”, 取执行文件名 (), “,129”)))
.如果真 (等于 (操作是否成功, 假))
    返回 ()
.如果真结束

赋值 (操作是否成功, 写注册项 (#本地机器, 相加 (“SOFTWARE\Microsoft\Internet Explorer\Extensions\”, #右键对象标示, “\”, “Icon”), 相加 (取运行目录 (), “\”, 取执行文件名 (), “,129”)))
.如果真 (等于 (操作是否成功, 假))
    返回 ()
.如果真结束

赋值 (操作是否成功, 写注册项 (#本地机器, 相加 (“SOFTWARE\Microsoft\Internet Explorer\Extensions\”, #右键对象标示, “\”, “MenuText”), #窗口标题))
.如果真 (等于 (操作是否成功, 假))
    返回 ()
.如果真结束



.子程序 设置上层窗口, 逻辑型, , 
.参数 窗口句柄, 整数型, , 

.局部变量 线程1, 整数型, , , 
.局部变量 线程2, 整数型, , , 
.局部变量 顶层窗口, 整数型, , , 
.局部变量 返回值, 逻辑型, , , 
.局部变量 绑定返回, 逻辑型, , , 


赋值 (顶层窗口, 取前景窗口 ())
写调试文本 (相加 (“待设置窗口句柄=”, 到文本 (窗口句柄), “ 顶层窗口句柄=”, 到文本 (顶层窗口)))

.如果真 (等于 (窗口句柄, 顶层窗口))
    写调试文本 (“窗口句柄相同”)
    返回 (真)
    
.如果真结束


赋值 (线程1, 取窗口线程句柄 (顶层窗口, 0))
赋值 (线程2, 取窗口线程句柄 (窗口句柄, 0))


写调试文本 (相加 (“顶层窗口线程句柄=”, 到文本 (线程1), “ 待设置窗口句柄=”, 到文本 (线程2)))

.判断开始 (等于 (线程1, 线程2))
    写调试文本 (“线程相等”)
    赋值 (返回值, 设置前景窗口 (窗口句柄))
    写调试文本 (相加 (“设置前景窗口返回”, 到文本 (返回值)))
.默认
    
    赋值 (绑定返回, 绑定线程输入 (线程1, 线程2, 真))
    写调试文本 (相加 (“绑定返回”, 到文本 (绑定返回)))
    赋值 (返回值, 设置前景窗口 (窗口句柄))
    写调试文本 (相加 (“设置前景窗口返回”, 到文本 (返回值)))
    赋值 (绑定返回, 绑定线程输入 (线程1, 线程2, 假))
    写调试文本 (相加 (“解绑定返回”, 到文本 (绑定返回)))
.判断结束

返回 (返回值)

.程序集 核心函数集, , , (本源码无版权，但引用决不能去掉易语言的广告条)核心部分{创建,删除,回调函数等} 此处不通过类组织的原因是尽量多的演示支持库对象的方法

.子程序 处理创建任务, 空白型, , 
.参数 开启模式初始值, 整数型, , 
.参数 文件名, 文本型, 可空, 

.局部变量 任务参数, 未知类型0x70004, , , 
.局部变量 任务序号, 整数型, , , 
.局部变量 开启模式, 整数型, , , 1为新建 2为重建 3为继续
.局部变量 表项序号, 整数型, , , 
.局部变量 开启任务返回值, 整数型, , , 

.如果 (不等于 (开启模式初始值, 3))
    .如果 (等于 (文件是否存在 (当前任务信息.文件路径), 真))
        .如果真 (等于 (信息框 (“发现重复文件,是否删除已存在文件?”, #是否钮, “提示”), #否钮))
            返回 ()
        .如果真结束
         ' 重建模式
        删除文件 (当前任务信息.文件路径)
        删除任务记录 (“正在下载”, 当前任务信息.文件名)
        赋值 (开启模式, 2)
    .否则
        赋值 (开启模式, 1)
    .如果结束
    
.否则
    赋值 (开启模式, 3)
    赋值 (任务序号, 界面基础控件.取统计框当前表项数值 ())
    .如果真 (等于 (任务序号, -1))
        返回 ()
    .如果真结束
    赋值 (当前任务信息, 下载对象 [任务序号], 任务常规信息)
.如果结束

赋值 (任务参数., #.)
赋值 (任务参数., 当前任务信息.网址)
赋值 (任务参数., 系统配置信息.速度)
赋值 (任务参数., 系统配置信息.线程超时)
赋值 (任务参数., 当前任务信息.默认线程数)
赋值 (任务参数., 当前任务信息.文件路径)
赋值 (任务参数., 系统配置信息.连接超时)
赋值 (任务参数., 系统配置信息.发送超时)
赋值 (任务参数., 系统配置信息.接收超时)
赋值 (任务参数., 系统配置信息.接收大小)

赋值 (任务参数., &日志回调函数)
赋值 (任务参数., &下载_交互回调函数)
.如果真 (不等于 (取文本长度 (当前任务信息.用户名), 0))
    赋值 (任务参数., 当前任务信息.用户名)
.如果真结束

.如果真 (不等于 (取文本长度 (当前任务信息.密码), 0))
    赋值 (任务参数., 当前任务信息.密码)
.如果真结束

.判断开始 (等于 (开启模式, 1))
    赋值 (任务序号, 创建任务 (任务参数))
.判断 (等于 (开启模式, 2))
    赋值 (表项序号, 界面基础控件.取指定统计框标题的表项索引 (当前任务信息.文件名))
    .判断开始 (等于 (表项序号, -1))
         ' 不存在表项 模式转变为新建
        赋值 (任务序号, 创建任务 (任务参数))
        赋值 (开启模式, 1)
    .默认
        
        赋值 (任务序号, 界面基础控件.取指定统计框标题的表项值 (表项序号))
        赋值 (开启任务返回值, 重下载任务 (任务序号, 任务参数))
        
    .判断结束
    
.判断 (等于 (开启模式, 3))
    赋值 (任务序号, 继续下载任务 (文件名, 任务参数))
.默认
    
.判断结束


.如果真 (并且 (等于 (开启模式, 1), 等于 (任务序号, -1)))
    .如果真 (等于 (界面基础控件.取当前目录 (), “正在下载”))
        界面基础控件.设置下载统计框标题 (任务序号, 当前任务信息.文件名, 0, 0, 0, 0, 当前任务信息.网址, 当前任务信息.创建时间, 当前任务信息.完成时间, 当前任务信息.注释, #文件状态图标_错误状态)
    .如果真结束
    
    修改任务信息记录 (“正在下载”, 任务序号, 当前任务信息.文件名, , , , 当前任务信息.网址, , , , , , , #文件状态图标_错误状态, , , )
    
    返回 ()
.如果真结束

.如果真 (并且 (等于 (开启模式, 2), 等于 (开启任务返回值, -1)))
    .如果真 (等于 (界面基础控件.取当前目录 (), “正在下载”))
        界面基础控件.置任务下载统计框_文件状态图标 (下载对象 [任务序号], 任务统计框表项索引, #文件状态图标_错误状态)
    .如果真结束
    
    修改任务信息记录 (“正在下载”, 任务序号, 当前任务信息.文件名, , , , 当前任务信息.网址, , , , , , , #文件状态图标_错误状态, , , )
    
    赋值 (下载对象 [任务序号], 任务常规信息.文件状态, #文件状态图标_错误状态)
    
    返回 ()
.如果真结束

.如果真 (并且 (等于 (开启模式, 3), 等于 (任务序号, -1)))
    .如果真 (等于 (界面基础控件.取当前目录 (), “正在下载”))
        界面基础控件.置任务下载统计框_文件状态图标 (下载对象 [界面基础控件.取统计框当前表项数值 ()].任务统计框表项索引, #文件状态图标_错误状态)
    .如果真结束
    
    修改任务信息记录 (“正在下载”, 任务序号, 当前任务信息.文件名, , , , 当前任务信息.网址, , , , , , , #文件状态图标_错误状态, , , )
    
    下载对象 [任务序号].任务常规信息.文件状态 ＝ #文件状态图标_错误状态
    
    返回 ()
.如果真结束

.判断开始 (等于 (开启模式, 1))
    赋值 (下载对象 [任务序号], 任务常规信息.文件状态, #文件状态图标_未下完状态)
    .如果真 (等于 (界面基础控件.取当前目录 (), “正在下载”))
        赋值 (下载对象 [任务序号], 任务统计框表项索引, 界面基础控件.设置下载统计框标题 (任务序号, 当前任务信息.文件名, 0, 0, 0, 0, 当前任务信息.网址, 当前任务信息.创建时间, 当前任务信息.完成时间, 当前任务信息.注释, #文件状态图标_未下完状态))
        
    .如果真结束
    
    加入任务记录 (“正在下载”, 任务序号, 当前任务信息.文件名, 0, 0, 0, 当前任务信息.网址, 当前任务信息.创建时间, 当前任务信息.完成时间, 当前任务信息.注释, 到字节集 (0), 到字节集 (0), 当前任务信息.文件路径, #文件状态图标_未下完状态, 当前任务信息.用户名, 当前任务信息.密码, 当前任务信息.保存目录)
    
    
.判断 (等于 (开启模式, 2))
    赋值 (下载对象 [任务序号], 任务常规信息.文件状态, #文件状态图标_未下完状态)
    .如果真 (等于 (界面基础控件.取当前目录 (), “正在下载”))
        界面基础控件.置任务下载统计框_大小 (下载对象 [任务序号], 任务统计框表项索引, 0)
        界面基础控件.置任务下载统计框_完成数 (下载对象 [任务序号], 任务统计框表项索引, 0)
        界面基础控件.置任务下载统计框_块数 (下载对象 [任务序号], 任务统计框表项索引, 0, 0)
        界面基础控件.置任务下载统计框_网址 (下载对象 [任务序号], 任务统计框表项索引, 当前任务信息.网址)
        界面基础控件.置任务下载统计框_创建时间 (下载对象 [任务序号], 任务统计框表项索引, 当前任务信息.创建时间)
        界面基础控件.置任务下载统计框_完成时间 (下载对象 [任务序号], 任务统计框表项索引, 当前任务信息.完成时间)
        界面基础控件.置任务下载统计框_注释 (下载对象 [任务序号], 任务统计框表项索引, 当前任务信息.注释)
        界面基础控件.置任务下载统计框_文件状态图标 (下载对象 [任务序号], 任务统计框表项索引, 当前任务信息.文件状态)
        
    .如果真结束
    
    修改任务信息记录 (“正在下载”, 任务序号, 当前任务信息.文件名, 0, 0, 0, 当前任务信息.网址, 当前任务信息.创建时间, 当前任务信息.完成时间, 当前任务信息.注释, 到字节集 (0), 到字节集 (0), 当前任务信息.文件路径, #文件状态图标_未下完状态, 当前任务信息.用户名, 当前任务信息.密码)
    
    
    
.判断 (等于 (开启模式, 3))
    赋值 (下载对象 [任务序号], 任务常规信息.文件状态, #文件状态图标_未下完状态)
    .如果真 (等于 (界面基础控件.取当前目录 (), “正在下载”))
        界面基础控件.置任务下载统计框_大小 (下载对象 [任务序号], 任务统计框表项索引, 下载对象 [任务序号], 任务常规信息.总长度)
        界面基础控件.置任务下载统计框_完成数 (下载对象 [任务序号], 任务统计框表项索引, 下载对象 [任务序号], 任务常规信息.完成数)
        界面基础控件.置任务下载统计框_块数 (下载对象 [任务序号], 任务统计框表项索引, 下载对象 [任务序号], 任务常规信息.总块数, 0)
        
    .如果真结束
    
    
    修改任务信息记录 (“正在下载”, 任务序号, 当前任务信息.文件名, 0, 0, 0, 当前任务信息.网址, 当前任务信息.创建时间, 当前任务信息.完成时间, 当前任务信息.注释, 到字节集 (0), 到字节集 (0), 当前任务信息.文件路径, #文件状态图标_未下完状态, 当前任务信息.用户名, 当前任务信息.密码)
    
    
.默认
    
.判断结束

 ' 为了以后扩展模式所以分别判断
.判断开始 (等于 (开启模式, 1))
    赋值 (下载对象 [任务序号], 进度框任务索引, 0)
.判断 (等于 (开启模式, 2))
    赋值 (下载对象 [任务序号], 进度框任务索引, 0)
.默认
    
.判断结束

赋值 (下载对象 [任务序号], 任务常规信息, 当前任务信息)
赋值 (当前显示对象序号, 任务序号)


.子程序 创建任务, 整数型, , 
.参数 任务参数, 未知类型0x70004, , 

.局部变量 任务序号, 整数型, , , 

赋值 (任务序号, 获得可用对象 ())
.如果真 (等于 (任务序号, -1))
    返回 (-1)
.如果真结束

.如果真 (等于 (下载对象.未知支持库函数_19 ( [任务序号], 下载对象, 任务参数), 假))
    返回 (-1)
.如果真结束

设置对象状态 (任务序号, #正运行)
赋值 (下载对象 [任务序号], 任务核心数据.对象信息, 下载对象.未知支持库函数_29 ( [任务序号], 下载对象))
清除数组 (下载对象 [任务序号], 任务核心数据.线程信息数组)
赋值 (下载对象 [任务序号], 任务常规信息.网址, “”)
赋值 (下载对象 [任务序号], 任务常规信息.注释, “”)
赋值 (下载对象 [任务序号], 任务常规信息.文件名, “”)
赋值 (下载对象 [任务序号], 任务常规信息.创建时间, 到时间 (0))
赋值 (下载对象 [任务序号], 任务常规信息.完成时间, 到时间 (0))
赋值 (下载对象 [任务序号], 任务常规信息.文件路径, “”)
赋值 (下载对象 [任务序号], 进度框任务索引, 0)
赋值 (下载对象 [任务序号], 任务统计框表项索引, 0)
返回 (任务序号)

.子程序 重下载任务, 整数型, , 
.参数 任务序号, 整数型, , 
.参数 任务参数, 未知类型0x70004, , 

.如果真 (等于 (下载对象.未知支持库函数_19 ( [任务序号], 下载对象, 任务参数), 假))
    返回 (-1)
.如果真结束

设置对象状态 (任务序号, #正运行)
赋值 (下载对象 [任务序号], 任务核心数据.对象信息, 下载对象.未知支持库函数_29 ( [任务序号], 下载对象))
清除数组 (下载对象 [任务序号], 任务核心数据.线程信息数组)
赋值 (下载对象 [任务序号], 任务常规信息.网址, “”)
赋值 (下载对象 [任务序号], 任务常规信息.注释, “”)
赋值 (下载对象 [任务序号], 任务常规信息.文件名, “”)
赋值 (下载对象 [任务序号], 任务常规信息.创建时间, 到时间 (0))
赋值 (下载对象 [任务序号], 任务常规信息.完成时间, 到时间 (0))
赋值 (下载对象 [任务序号], 任务常规信息.文件路径, “”)
赋值 (下载对象 [任务序号], 进度框任务索引, 0)
赋值 (下载对象 [任务序号], 任务统计框表项索引, 0)
返回 (1)

.子程序 停止任务, 字节集, , 
.参数 任务序号, 整数型, , 

.局部变量 任务数据, 字节集, , , 
.局部变量 待下载文件总长度, 整数型, , , 1
.局部变量 已下载总长度, 整数型, , , 2
.局部变量 块个数, 整数型, , , 3


 ' 不清楚任务数组内的信息，只要设置停止标志就足够了
设置对象状态 (任务序号, #已停止)

.如果真 (等于 (下载对象.未知支持库函数_20 ( [任务序号], 下载对象, 任务数据, 2), 假))
    返回 (取空白字节集 (0))
.如果真结束

赋值 (待下载文件总长度, 下载对象.未知支持库函数_31 ( [任务序号], 下载对象, 任务数据, 1, 0))
赋值 (已下载总长度, 下载对象.未知支持库函数_31 ( [任务序号], 下载对象, 任务数据, 2, 0))
赋值 (块个数, 下载对象.未知支持库函数_31 ( [任务序号], 下载对象, 任务数据, 3, 0))

修改任务信息记录 (“正在下载”, 任务序号, 下载对象 [任务序号], 任务常规信息.文件名, 待下载文件总长度, 已下载总长度, 块个数, 下载对象 [任务序号], 任务常规信息.网址, , , , , 任务数据, , , , )


界面基础控件.置任务下载统计框_完成数 (下载对象 [任务序号], 任务统计框表项索引, 已下载总长度)

返回 (任务数据)

.子程序 继续下载任务, 整数型, , 
.参数 文件名, 文本型, , 
.参数 任务参数, 未知类型0x70004, , 

.局部变量 任务序号, 整数型, , , 
.局部变量 创建时间, 日期时间型, , , 
.局部变量 任务数据, 字节集, , , 
.局部变量 文件总长度, 整数型, , , 1
.局部变量 已下载总长度, 整数型, , , 2
.局部变量 块个数, 整数型, , , 3
.局部变量 表项索引, 整数型, , , 

.如果真 (等于 (置下载信息数据库 (“正在下载”), 假))
    信息框 (相加 (“操作( 正在下载.edb)失败 错误原因:”, 取错误信息 ()), 0, “错误”)
    返回 (-1)
.如果真结束
到首记录 ()

.如果真 (等于 (查找 (等于 (读 (“文件名”), 文件名)), 假))
    返回 (-1)
.如果真结束

赋值 (创建时间, 读 (“创建时间”))
赋值 (任务数据, 读 (“任务信息”))

赋值 (表项索引, 界面基础控件.取指定统计框标题的表项索引 (文件名))
赋值 (任务序号, 界面基础控件.取指定统计框标题的表项值 (表项索引))

赋值 (文件总长度, 下载对象.未知支持库函数_31 ( [任务序号], 下载对象, 任务数据, 1, 0))
赋值 (已下载总长度, 下载对象.未知支持库函数_31 ( [任务序号], 下载对象, 任务数据, 2, 0))
赋值 (块个数, 下载对象.未知支持库函数_31 ( [任务序号], 下载对象, 任务数据, 3, 0))


.如果真 (等于 (任务序号, -1))
    返回 (-1)
.如果真结束
.如果真 (等于 (下载对象.未知支持库函数_21 ( [任务序号], 下载对象, 任务参数, 任务数据), 假))
    返回 (-1)
.如果真结束
设置对象状态 (任务序号, #正运行)
赋值 (下载对象 [任务序号], 任务核心数据.对象信息, 下载对象.未知支持库函数_29 ( [任务序号], 下载对象))
清除数组 (下载对象 [任务序号], 任务核心数据.线程信息数组)
赋值 (下载对象 [任务序号], 任务常规信息.创建时间, 创建时间)
赋值 (下载对象 [任务序号], 任务常规信息.总长度, 文件总长度)
赋值 (下载对象 [任务序号], 任务常规信息.完成数, 已下载总长度)
赋值 (下载对象 [任务序号], 任务常规信息.总块数, 块个数)
赋值 (下载对象 [任务序号], 任务常规信息.活动块数, 0)
返回 (任务序号)

.子程序 删除任务, 空白型, , 
.参数 任务序号, 整数型, , 

设置对象状态 (任务序号, #已删除)
界面基础控件.删除进度条任务 (下载对象 [任务序号], 进度框任务索引)
赋值 (下载对象 [任务序号], 进度框任务索引, 0)


.子程序 增加线程, 空白型, , 
.参数 对象序号, 整数型, , 

.如果真 (等于 (对象序号, 0))
    返回 ()
.如果真结束

下载对象.未知支持库函数_22 ( [对象序号], 下载对象)

.子程序 删除线程, 空白型, , 
.参数 对象序号, 整数型, , 

.如果真 (等于 (对象序号, 0))
    返回 ()
.如果真结束

下载对象.未知支持库函数_23 ( [对象序号], 下载对象)


.子程序 日志回调函数, 空白型, , 
.参数 线程信息, 整数型, , 
.参数 时间, 文本型, , 
.参数 内容, 文本型, , 
.参数 消息类型, 整数型, , 
.参数 对象信息, 整数型, , 

.局部变量 对象序号, 整数型, , , 
.局部变量 线程序号, 整数型, , , 
.局部变量 内容数组, 文本型, , "0", 
.局部变量 内容行数, 整数型, , , 
.局部变量 记次变量, 整数型, , , 
.局部变量 日志成员, 日志结构, , , 


赋值 (对象序号, 获得指定对象序号 (对象信息))

.如果真 (等于 (对象序号, -1))
    返回 ()
.如果真结束


赋值 (线程序号, 获得指定线程序号 (对象序号, 线程信息))

.如果真 (等于 (线程序号, -1))
    返回 ()
.如果真结束

分割协议头多行文本 (内容, 内容数组)
赋值 (内容行数, 取数组成员数 (内容数组))
.变量循环首 (1, 内容行数, 1, 记次变量)
    赋值 (日志成员.消息类型, 消息类型)
    赋值 (日志成员.时间文本, 时间)
    赋值 (日志成员.内容文本, 内容数组 [记次变量])
    加入成员 (下载对象 [对象序号], 任务核心数据.线程信息数组 [线程序号], 日志数组, 日志成员)
     ' 如果为当前显示的对象及线程。则在日志框中显示
    .如果真 (并且 (等于 (界面基础控件.日志框是否可视 (), 真), 等于 (当前显示对象序号, 对象序号), 等于 (当前显示线程序号, 线程序号)))
        界面基础控件.增加日志项 (消息类型, 时间, 内容数组 [记次变量])
    .如果真结束
    
.变量循环尾 ()


.子程序 下载_交互回调函数, 整数型, , 
.参数 消息类型, 整数型, , 
.参数 线程信息, 整数型, , 
.参数 参数3, 整数型, , 
.参数 参数4, 整数型, , 
.参数 对象信息, 整数型, , 

.局部变量 对象序号, 整数型, , , 
.局部变量 线程序号, 整数型, , , 
.局部变量 线程数组, 整数型, , "0", 
.局部变量 本地文件路径, 文本型, , , 
.局部变量 路径数组, 文本型, , "0", 
.局部变量 新文件名, 文本型, , , 


赋值 (对象序号, 获得指定对象序号 (对象信息))
.如果真 (等于 (对象序号, -1))
    返回 (0)
.如果真结束

.判断开始 (等于 (消息类型, #.))
     ' 一个下载任务的首个下载线程开始下载时收到本消息，可以做与统计整个任务想关的操作
    
    赋值 (下载对象 [对象序号], 任务常规信息.总长度, 参数3)
    
    .如果真 (等于 (下载对象 [对象序号], 进度框任务索引, 0))
        赋值 (下载对象 [对象序号], 进度框任务索引, 界面基础控件.增加进度框任务 (参数3, 相减 (系统配置信息.接收大小, 1)))
    .如果真结束
    
    赋值 (本地文件路径, 下载对象.未知支持库函数_32 ( [对象序号], 下载对象))
    .如果真 (等于 (本地文件路径, “”))
        返回 (0)
    .如果真结束
    赋值 (下载对象 [对象序号], 任务常规信息.文件路径, 本地文件路径)
    赋值 (路径数组, 分割文本 (本地文件路径, “\”, ))
    赋值 (下载对象 [对象序号], 任务常规信息.文件名, 路径数组 [取数组成员数 (路径数组)])
    界面基础控件.设置进度框活动任务 (下载对象 [对象序号], 进度框任务索引)
    界面基础控件.置任务下载统计框_文件状态图标 (下载对象 [对象序号], 任务统计框表项索引, #文件状态图标_正在下载状态)
    界面基础控件.置任务下载统计框_文件名 (下载对象 [对象序号], 任务统计框表项索引, 下载对象 [对象序号], 任务常规信息.文件名)
    界面基础控件.置任务下载统计框_大小 (下载对象 [对象序号], 任务统计框表项索引, 参数3)
    赋值 (下载对象 [对象序号], 任务常规信息.创建时间, 取现行时间 ())
    界面基础控件.置任务下载统计框_创建时间 (下载对象 [对象序号], 任务统计框表项索引, 下载对象 [对象序号], 任务常规信息.创建时间)
    
    修改任务信息记录 (“正在下载”, 对象序号, 下载对象 [对象序号], 任务常规信息.文件名, 参数3, , , 下载对象 [对象序号], 任务常规信息.网址, 下载对象 [对象序号], 任务常规信息.创建时间, , , , , 本地文件路径, #文件状态图标_正在下载状态, )
    
    赋值 (下载对象 [对象序号], 任务常规信息.文件状态, #文件状态图标_正在下载状态)
    
    
.判断 (等于 (消息类型, #.))
     ' 一个下载任务所有下载线程都结束时收到本消息，可以做与统计整个任务想关的操作
    
    
    输出调试文本 (相加 (“任务=”, 到文本 (对象序号), “结束”))
    
    赋值 (下载对象 [对象序号], 任务常规信息.完成时间, 取现行时间 ())
    界面基础控件.置任务下载统计框_完成时间 (下载对象 [对象序号], 任务统计框表项索引, 下载对象 [对象序号], 任务常规信息.完成时间)
    
    赋值 (下载对象 [对象序号], 任务常规信息.完成数, 参数3)
    
    界面基础控件.置任务下载统计框_完成数 (下载对象 [对象序号], 任务统计框表项索引, 参数3)
    界面基础控件.置任务下载统计框_百分比 (下载对象 [对象序号], 任务统计框表项索引, 相乘 (相除 (参数3, 下载对象 [对象序号], 任务常规信息.总长度), 100))
    
    .判断开始 (大于 (下载对象 [对象序号], 任务常规信息.总长度, 参数3))
        界面基础控件.置任务下载统计框_文件状态图标 (下载对象 [对象序号], 任务统计框表项索引, #文件状态图标_未下完状态)
        修改任务信息记录 (“正在下载”, 对象序号, 下载对象 [对象序号], 任务常规信息.文件名, , 参数3, , 下载对象 [对象序号], 任务常规信息.网址, , 下载对象 [对象序号], 任务常规信息.完成时间, , , , , , , , )
        .如果真 (不等于 (下载对象 [对象序号], 对象状态, #已删除))
            赋值 (下载对象 [对象序号], 对象状态, #已停止)
        .如果真结束
        
    .默认
        界面基础控件.置任务下载统计框_文件状态图标 (下载对象 [对象序号], 任务统计框表项索引, #文件状态图标_完成状态)
        界面基础控件.改变进度框进度 (下载对象 [对象序号], 进度框任务索引, 相减 (参数3, 系统配置信息.接收大小), 相加 (参数3, 求余数 (参数3, 相减 (系统配置信息.接收大小, 1))))
        
        修改任务信息记录 (“正在下载”, 对象序号, 下载对象 [对象序号], 任务常规信息.文件名, , 参数3, , 下载对象 [对象序号], 任务常规信息.网址, , 下载对象 [对象序号], 任务常规信息.完成时间, , , , , #文件状态图标_完成状态, , , )
        
        移动任务记录 (“正在下载”, 下载对象 [对象序号], 任务常规信息.文件名, 下载对象 [对象序号], 任务常规信息.保存目录, 对象序号)
        赋值 (当前显示对象序号, 0)
         ' 界面基础控件.刷新日志树 ()
        删除任务 (对象序号)
        界面基础控件.设置正在下载任务框 ()
        界面基础控件.清空进度框 ()
    .判断结束
    
    
.判断 (等于 (消息类型, #.))
     ' 一个任务开启一个新线程时收到本消息
     ' 创建新线程
     ' 在线程树上增加一个节点
    
    赋值 (线程序号, 增加线程信息 (对象序号, 线程信息))
    增加线程树节点 (对象序号, 线程序号)
    界面基础控件.刷新日志树 ()
    下载对象.未知支持库函数_30 ( [对象序号], 下载对象, 线程数组)
    赋值 (下载对象 [对象序号], 任务常规信息.总块数, 取数组下标 (线程数组, ))
    赋值 (下载对象 [对象序号], 任务常规信息.活动块数, 相加 (下载对象 [对象序号], 任务常规信息.活动块数, 1))
    
    界面基础控件.置任务下载统计框_块数 (下载对象 [对象序号], 任务统计框表项索引, 下载对象 [对象序号], 任务常规信息.总块数, 下载对象 [对象序号], 任务常规信息.活动块数)
    
.判断 (等于 (消息类型, #.))
     ' 一个线程正式下载数据时收到本消息，与继续下载消息互斥
     ' 可以用来通知用户线程正式开始下载以及确定范围等操作
    
    赋值 (线程序号, 获得指定线程序号 (对象序号, 线程信息))
    .如果真 (等于 (线程序号, -1))
        返回 (0)
    .如果真结束
    
    赋值 (下载对象 [对象序号], 任务核心数据.线程信息数组 [线程序号], 开始位置, 参数3)
    赋值 (下载对象 [对象序号], 任务核心数据.线程信息数组 [线程序号], 已下载大小, 参数3)
    
    输出调试文本 (相加 (“线程”, 到文本 (线程序号), “从”, 到文本 (参数3), “开始下载”))
    
    日志回调函数 (线程信息, 到文本 (取现行时间 ()), 相加 (“开始接收数据(从”, 到文本 (参数3), “字节到”, 到文本 (参数4), “字节)”), #., 对象信息)
    
.判断 (等于 (消息类型, #.))
     ' 当一个线程正常结束后会搜索是否存在继续下载的断点块，如果找到则发送本消息。与下载数据范围消息互斥
    
    赋值 (线程序号, 获得指定线程序号 (对象序号, 线程信息))
    .如果真 (等于 (线程序号, -1))
        返回 (0)
    .如果真结束
    
    
    赋值 (下载对象 [对象序号], 任务核心数据.线程信息数组 [线程序号], 开始位置, 参数3)
    赋值 (下载对象 [对象序号], 任务核心数据.线程信息数组 [线程序号], 已下载大小, 参数3)
    
    日志回调函数 (线程信息, 到文本 (取现行时间 ()), 相加 (“线程从”, 到文本 (参数3), “字节继续下载到”, 到文本 (参数4), “字节为止”), #., 对象信息)
    
    
.判断 (等于 (消息类型, #.))
     ' 下载线程完成任务后，正常结束时发送本消息
    
    输出调试文本 (“收到线程正常结束消息”)
    
    赋值 (线程序号, 获得指定线程序号 (对象序号, 线程信息))
    .如果真 (等于 (线程序号, -1))
        返回 (0)
    .如果真结束
    
    输出调试文本 (相加 (“线程=”, 到文本 (线程序号), “正常结束”))
    
    日志回调函数 (线程信息, 到文本 (取现行时间 ()), 相加 (“线程正常结束在”, 到文本 (参数3)), #., 对象信息)
    
    赋值 (下载对象 [对象序号], 任务常规信息.活动块数, 相减 (下载对象 [对象序号], 任务常规信息.活动块数, 1))
    
    界面基础控件.置任务下载统计框_块数 (下载对象 [对象序号], 任务统计框表项索引, 下载对象 [对象序号], 任务常规信息.总块数, 下载对象 [对象序号], 任务常规信息.活动块数)
    删除线程信息 (对象序号, 线程序号)
    
.判断 (等于 (消息类型, #.))
     ' 下载线程没有完成下载任务就结束时发送本消息
    
    输出调试文本 (“收到线程异常结束消息”)
    
    赋值 (线程序号, 获得指定线程序号 (对象序号, 线程信息))
    .如果真 (等于 (线程序号, -1))
        返回 (0)
    .如果真结束
    
    输出调试文本 (相加 (“线程=”, 到文本 (线程序号), “异常结束”))
    
    日志回调函数 (线程信息, 到文本 (取现行时间 ()), 相加 (“线程异常结束在”, 到文本 (参数3)), #., 对象信息)
    
    赋值 (下载对象 [对象序号], 任务常规信息.活动块数, 相减 (下载对象 [对象序号], 任务常规信息.活动块数, 1))
    
    界面基础控件.置任务下载统计框_块数 (下载对象 [对象序号], 任务统计框表项索引, 下载对象 [对象序号], 任务常规信息.总块数, 下载对象 [对象序号], 任务常规信息.活动块数)
    删除线程信息 (对象序号, 线程序号)
    
.判断 (等于 (消息类型, #.))
     ' 系统下载指定大小的数据后发送本消息通知用户
    
    赋值 (线程序号, 获得指定线程序号 (对象序号, 线程信息))
    
    .如果真 (等于 (线程序号, -1))
        返回 (0)
    .如果真结束
    
    写调试文本 (“”)
    写调试文本 (相加 (“线程序号=”, 到文本 (线程序号), “ ”, “开始位置=”, 到文本 (下载对象 [对象序号], 任务核心数据.线程信息数组 [线程序号], 已下载大小), “  ”, “结束位置=”, 到文本 (相加 (下载对象 [对象序号], 任务核心数据.线程信息数组 [线程序号], 已下载大小, 参数3)), “  ”, “本次长度=”, 到文本 (参数3)))
    
    界面基础控件.改变进度框进度 (下载对象 [对象序号], 进度框任务索引, 下载对象 [对象序号], 任务核心数据.线程信息数组 [线程序号], 已下载大小, 相加 (下载对象 [对象序号], 任务核心数据.线程信息数组 [线程序号], 已下载大小, 参数3))
    赋值 (下载对象 [对象序号], 任务核心数据.线程信息数组 [线程序号], 已下载大小, 相加 (下载对象 [对象序号], 任务核心数据.线程信息数组 [线程序号], 已下载大小, 参数3))
    
.判断 (等于 (消息类型, #.))
     ' 下载文件时，发现本地磁盘存在与待下载文件同名的文件时发送本消息通知用户
    
    .判断开始 (等于 (下载对象 [对象序号], 任务常规信息.同名文件处理, #.))
        返回 (#.)
    .判断 (等于 (下载对象 [对象序号], 任务常规信息.同名文件处理, #.))
        
        .如果 (等于 (输入框 (“请输入新文件名,如果取消或为空则有系统自动处理”, 相加 (“发现同名文件:”, 下载对象.未知支持库函数_32 ( [对象序号], 下载对象)), , 新文件名, #输入文本), 真))
            
            下载对象.未知支持库函数_33 ( [对象序号], 下载对象, 新文件名)
            返回 (#.)
        .否则
            返回 (#.)
        .如果结束
        
    .判断 (等于 (下载对象 [对象序号], 任务常规信息.同名文件处理, #.))
        返回 (#.)
    .默认
        
    .判断结束
    
    返回 (#.)
.默认
    
.判断结束
返回 (0)

.子程序 设置对象状态, 空白型, , 
.参数 对象序号, 整数型, , 
.参数 对象状态, 整数型, , 

赋值 (下载对象 [对象序号], 对象状态, 对象状态)

.子程序 获得指定对象序号, 整数型, , 没找到返回-1
.参数 对象信息, 整数型, , 

.局部变量 下载对象个数, 整数型, , , 
.局部变量 记次变量, 整数型, , , 

赋值 (下载对象个数, 取数组成员数 (下载对象))
.变量循环首 (1, 下载对象个数, 1, 记次变量)
    .如果真 (等于 (对象信息, 下载对象 [记次变量], 任务核心数据.对象信息))
        返回 (记次变量)
    .如果真结束
    
.变量循环尾 ()
返回 (-1)

.子程序 获得可用对象, 整数型, , 没有可用对象返回-1
.局部变量 下载对象个数, 整数型, , , 
.局部变量 记次变量, 整数型, , , 
.局部变量 已用记数, 整数型, , , 
.局部变量 下载对象结构, 下载对象结构, , , 

.如果真 (大于 (已用记数, 系统配置信息.最大任务数))
    返回 (-1)
.如果真结束

赋值 (下载对象个数, 取数组成员数 (下载对象))
.变量循环首 (1, 下载对象个数, 1, 记次变量)
    .如果真 (等于 (下载对象 [记次变量], 对象状态, #已删除))
        返回 (记次变量)
    .如果真结束
    
.变量循环尾 ()
赋值 (下载对象结构.对象状态, #已停止)
加入成员 (下载对象, 下载对象结构)
返回 (取数组成员数 (下载对象))


.子程序 增加线程信息, 整数型, , 返回线程序号
.参数 对象序号, 整数型, , 
.参数 线程信息, 整数型, , 

.局部变量 线程序号, 整数型, , , 
.局部变量 新线程信息, 线程相关信息, , , 

赋值 (新线程信息.线程信息, 线程信息)
赋值 (线程序号, 查找可用线程信息 (对象序号))
.如果 (等于 (线程序号, -1))
    加入成员 (下载对象 [对象序号], 任务核心数据.线程信息数组, 新线程信息)
    赋值 (线程序号, 取数组成员数 (下载对象 [对象序号], 任务核心数据.线程信息数组))
    清除数组 (下载对象 [对象序号], 任务核心数据.线程信息数组 [线程序号], 日志数组)
.否则
    赋值 (下载对象 [对象序号], 任务核心数据.线程信息数组 [线程序号], 新线程信息)
.如果结束
返回 (线程序号)

.子程序 删除线程信息, 空白型, , 
.参数 对象序号, 整数型, , 
.参数 线程序号, 整数型, , 

赋值 (下载对象 [对象序号], 任务核心数据.线程信息数组 [线程序号], 线程信息, 0)
赋值 (下载对象 [对象序号], 任务核心数据.线程信息数组 [线程序号], 开始位置, 0)
赋值 (下载对象 [对象序号], 任务核心数据.线程信息数组 [线程序号], 已下载大小, 0)


.子程序 查找可用线程信息, 整数型, , 没找到返回-1
.参数 对象序号, 整数型, , 

.局部变量 线程数, 整数型, , , 
.局部变量 记次变量, 整数型, , , 

赋值 (线程数, 取数组成员数 (下载对象 [对象序号], 任务核心数据.线程信息数组))
.变量循环首 (1, 线程数, 1, 记次变量)
    .如果真 (等于 (下载对象 [对象序号], 任务核心数据.线程信息数组 [记次变量], 线程信息, 0))
        返回 (记次变量)
    .如果真结束
    
.变量循环尾 ()
返回 (-1)


.子程序 获得指定线程序号, 整数型, , 没找到返回-1
.参数 对象序号, 整数型, , 
.参数 线程信息, 整数型, , 

.局部变量 线程数, 整数型, , , 
.局部变量 记次变量, 整数型, , , 

赋值 (线程数, 取数组成员数 (下载对象 [对象序号], 任务核心数据.线程信息数组))
.变量循环首 (1, 线程数, 1, 记次变量)
    .如果真 (等于 (线程信息, 下载对象 [对象序号], 任务核心数据.线程信息数组 [记次变量], 线程信息))
        返回 (记次变量)
    .如果真结束
    
.变量循环尾 ()
返回 (-1)


.子程序 取有效线程数, 整数型, , 
.参数 对象序号, 整数型, , 

.局部变量 线程数组成员数, 整数型, , , 
.局部变量 记次变量, 整数型, , , 
.局部变量 有效线程计数, 整数型, , , 

赋值 (线程数组成员数, 取数组成员数 (下载对象 [对象序号], 任务核心数据.线程信息数组))
.变量循环首 (1, 线程数组成员数, 1, 记次变量)
    .如果真 (不等于 (下载对象 [对象序号], 任务核心数据.线程信息数组 [记次变量], 线程信息, 0))
        赋值 (有效线程计数, 相加 (有效线程计数, 1))
    .如果真结束
    
.变量循环尾 ()
返回 (有效线程计数)

.子程序 清空对象, 空白型, , 
.局部变量 对象个数, 整数型, , , 
.局部变量 记次变量, 整数型, , , 

置下载信息数据库 (“正在下载”)
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    写 (“对象序号”, -1)
    跳过 ()
.判断循环尾 ()

.子程序 根据表项索引取任务对象序号, 整数型, , 返回-1表示没有符合要求的对象
.参数 表项索引, 整数型, , 

.局部变量 下载对象个数, 整数型, , , 
.局部变量 记次变量, 整数型, , , 

赋值 (下载对象个数, 取数组成员数 (下载对象))
.变量循环首 (1, 下载对象个数, 1, 记次变量)
    .如果真 (等于 (下载对象 [记次变量], 任务统计框表项索引, 表项索引))
        返回 (记次变量)
    .如果真结束
    
.变量循环尾 ()
返回 (-1)

.子程序 保存下载数据, 空白型, , 
.参数 对象序号, 整数型, , 

.局部变量 任务数据, 字节集, , , 

.如果真 (等于 (下载对象.未知支持库函数_27 ( [对象序号], 下载对象, 任务数据), 假))
    返回 ()
.如果真结束

赋值 (下载对象 [对象序号], 任务数据, 任务数据)
修改任务信息记录 (“正在下载”, 对象序号, 下载对象 [对象序号], 任务常规信息.文件名, , , , 下载对象 [对象序号], 任务常规信息.网址, , , , , 任务数据, , , , )

.子程序 保存所有运行任务下载数据, 空白型, , 
.局部变量 下载对象个数, 整数型, , , 
.局部变量 记次变量, 整数型, , , 

赋值 (下载对象个数, 取数组成员数 (下载对象))
.变量循环首 (1, 下载对象个数, 1, 记次变量)
    .如果真 (等于 (下载对象 [记次变量], 对象状态, #正运行))
        保存下载数据 (记次变量)
    .如果真结束
    
.变量循环尾 ()

.子程序 时钟处理程序, 空白型, , 本程序用来处理需要时间控制的各项功能 *默认为1秒激活一次*
界面基础控件.设置实时信息 ()
赋值 (下载数据自动保存时间, 相减 (下载数据自动保存时间, 1))
.判断开始 (小于或等于 (下载数据自动保存时间, 0))
    赋值 (下载数据自动保存时间, 相乘 (系统配置信息.下载数据自动保存时间, 60))
    保存所有运行任务下载数据 ()
.默认
    
.判断结束


.子程序 增加线程树节点, 空白型, 公开, 如果线程号为空则在最后增加一个新的，如果不为空则使用线程号，线程树包含在单个任务信息框中
.参数 对象序号, 整数型, , 
.参数 线程序号, 整数型, , 

.如果真 (等于 (下载对象 [对象序号], 任务核心数据.线程信息数组 [线程序号], 线程树节点索引, 0))
    赋值 (下载对象 [对象序号], 任务核心数据.线程信息数组 [线程序号], 线程树节点索引, 取数组成员数 (下载对象 [对象序号], 任务核心数据.线程信息数组))
.如果真结束


.程序集 调试程序集, , , 本源码无版权，但引用决不能去掉易语言的广告条

.程序集变量 调试文件号, 整数型, , , 
.子程序 打开调试日志文件, 逻辑型, , 
赋值 (调试文件号, 打开文件 (相加 (取当前目录 (), “\”, “log.txt”), #重写, ))
.如果 (等于 (调试文件号, 0))
    返回 (假)
.否则
    返回 (真)
.如果结束


.子程序 写调试文本, 空白型, , 
.参数 调试文本, 文本型, , 

写文本行 (调试文件号, 调试文本)

.窗口程序集 速度设置, , , 

.子程序 _设置速度_创建完毕, 空白型, , 
赋值 (.内容, 到文本 (系统配置信息.速度))

.子程序 _按钮1_被单击, 空白型, , 
.如果 (等于 (当前显示对象序号, 0))
    销毁 ()
.否则
    下载对象.未知支持库函数_24 ( [当前显示对象序号], 下载对象, 到数值 (.内容))
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.窗口程序集 关于, , , 本源码无版权，但引用决不能去掉易语言的广告条

.子程序 _图形按钮2_被单击, 空白型, , 
销毁 ()


.窗口程序集 类别属性程序集, , , 

.子程序 _类别属性_创建完毕, 空白型, , 
填充类别_6 ()

.子程序 填充类别_6, 空白型, , 
.局部变量 目录个数, 整数型, , , 
.局部变量 记次变量, 整数型, , , 
.局部变量 目录名, 文本型, , , 

清空 ()
置当前库 (“dir”)
到首记录 ()
赋值 (目录个数, 取目录个数 ())
.计次循环首 (目录个数, 记次变量)
    赋值 (目录名, 读 (“目录名称”))
    目录名.加入项目 ()
    .如果真 (等于 (记次变量, 1))
        赋值 (.内容, 目录名)
    .如果真结束
    跳过 ()
.计次循环尾 ()

.子程序 _按钮1_被单击, 空白型, , 
.如果 (等于 (修改目录 (.内容, .内容), 假))
    信息框 (相加 (“修改属性错误:”, 取错误信息 ()), 0, “消息”)
.否则
    填充类别_6 ()
    界面基础控件.设置树型控制框 ()
.如果结束


.子程序 _按钮3_被单击, 空白型, , 
赋值 (.内容, 未知支持库函数_2 (“请查找目录”, 假))


.窗口程序集 悬浮窗口程序集, , , 

.子程序 _悬浮窗口_创建完毕, 空白型, , 
赋值 (悬浮窗口., 相减 (取屏幕宽度 (), 100))
赋值 (悬浮窗口., 10)

赋值 (悬浮窗口., 40)
赋值 (悬浮窗口., 40)

悬浮窗口.取窗口句柄 ().未知支持库函数_0 ()

.子程序 _时钟1_周期事件, 空白型, , 


.子程序 _悬浮窗口_将被销毁, 空白型, , 
悬浮窗口.取窗口句柄 ().未知支持库函数_1 ()

.子程序 _拖放对象1_得到URL, 空白型, , 
.参数 接收到的URL, 文本型, , 

置剪辑板文本 (接收到的URL)
 ' 此处使用线程的原因是：如果直接调用函数"_新建任务_被选择()"那么本处将阻塞到这个函数里，知道用户完成下载配置。那么被拖动的窗口将假死，所以这里启动线程
未知支持库函数_0 (&新任务子线程, )

.子程序 _悬浮窗口_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (_启动窗口., 2))
    赋值 (_启动窗口., 0)
    
.如果真结束

_启动窗口.获取焦点 ()

.子程序 新任务子线程, 空白型, , 
_新建任务_被选择 ()


.窗口程序集 备注窗口程序集, , , 

.子程序 _退出_被单击, 空白型, , 
销毁 ()

.子程序 _程序备注_创建完毕, 空白型, , 
.局部变量 备注文本, 文本型, , , 
.局部变量 文件号, 整数型, , , 

赋值 (文件号, 打开文件 (相加 (取当前目录 (), “\”, “info.txt”), #读入, ))
赋值 (备注文本, 读入文本 (文件号, 取文件长度 (文件号)))
备注文本.加入文本 ()



 ' 不属于任何一个程序集、类模块的函数：
