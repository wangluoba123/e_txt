 ' 文件类型：Windows窗口程序

 ' 程序名称：高中数学自动化测试系统
 ' 程序描述：
 ' 程序作者：苏永潮
 ' 邮政编码：
 ' 联系地址：大连大有吴涛易语言软件开发有限公司
 ' 联系电话：0411-88995831
 ' 传真号码：88995834
 ' 电子信箱：service@dywt.com.cn
 ' 主页地址：http://www.dywt.com.cn
 ' 版权声明：
 ' 版本号：5.3
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 2
    底色 = 6910578 '  0x697272
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 3
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\math900.e\_启动窗口_底图
    图标 =  ' 已保存到：D:\易语言学习\Data\math900.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “math900---高中数学自动化测试系统----广东省级电教课题”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 278
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于《高中数学自动化测试系统》 5.4”
    帮助文件名 = “”

窗口 爬行窗口
    左边 = 50
    顶边 = 50
    宽度 = 522
    高度 = 400
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 6
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\math900.e\爬行窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.常量 单元1, "“集合”", , 
.常量 单元2, "“函数”", , 
.常量 单元3, "“指对数”", , 
.常量 单元4, "“立体几何”", , 
.常量 单元5, "“解析几何”", , 
.常量 单元6, "“算法”", , 
.常量 单元7, "“统计”", , 
.常量 单元8, "“排列组合”", , 
.常量 单元9, "“三角函数”", , 
.常量 单元10, "“向量”", , 
.常量 单元11, "“三角变换”", , 
.常量 单元12, "“解三角形”", , 
.常量 单元13, "“数列”", , 
.常量 单元14, "“不等式”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' internet 707ca37322474f6ca841f0e224f4b620 1 0 互联网支持库
 ' HtmlView 5014D8FA6DCA40b68FA626D8183666EB 1 1 超文本浏览框支持库



 ' 所需要的模块
 ' HTTP访问模块 E:\wqs\12月\12.11\王秋实\3math900\http_ec.ec


.全局变量 最大题量, 整数型, , , 
.全局变量 题目列表, 整数型, , "20", 20道选择题的题干
.全局变量 选项列表, 文本型, , "20", 每一题的ABCD选项、用户选项、
.全局变量 匿名全局变量_80, 空白型, , , 正确答案选项，每个文本长度均为6
.全局变量 复查标记, 逻辑型, , , 真为复查状态，假为考试状态
.全局变量 开始时间, 日期时间型, , , 纪录考试开始时间
.全局变量 进行时间, 长整数型, , , 纪录考试当前时间
.全局变量 结束标记, 逻辑型, , , 真为结束，假为未结束
.全局变量 当前单元, 文本型, , , 当前进行练习的单元，集合……
.全局变量 姓名, 文本型, , , 用户姓名

.窗口程序集 窗口程序集_启动窗口, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 输入考生姓名、配置窗口各组件位置
 ' 这里采用cookie文件的方法会不会更好些？否，因为如果用户不需要输入姓名，则很容易张冠李戴
.如果真 (等于 (输入框 (“请填写姓名，本信息用于网上提交，参加成绩爬行榜。注意：姓名信息不能为空，否则无法参加爬行”, “请先登录”, “测试”, 姓名, ), 假))
    结束 ()
.如果真结束
.判断循环首 (等于 (姓名, “”))
    .如果真 (等于 (输入框 (“请填写姓名，本信息用于网上提交，参加成绩爬行榜。注意：姓名信息不能为空，否则无法参加爬行”, “请先登录”, “测试”, 姓名, ), 假))
        结束 ()
    .如果真结束
    
.判断循环尾 ()
 ' 启动线程 (&自动升级, )
 ' 让系统可以利用用户答题的空闲时间悄悄完成升级题库工作
 ' 由于大赛不允许使用没有源代码的模块，只好暂时去掉这个功能
 ' 因为很多网友都提出：原来的升级没有提示、没有进度
 ' 而要加入进度，最简单直接的方法就是使用“弹出下载窗口.ec”这个模块
赋值 (当前单元, #单元1)
打开 (相加 (“data\”, 当前单元), , , , , , )
读入配置 ()
赋值 (.左边, 相减 (取用户区宽度 (), .宽度)) ' 设置右下角提问按钮位置的代码
赋值 (.顶边, 相减 (取用户区高度 (), .高度, .高度))
赋值 (.左边, .左边)
赋值 (.顶边, 相加 (.顶边, .高度))

.子程序 读入配置, 空白型, , 读入math900.ini并改变窗口标题等
.局部变量 文件号, 整数型, , , 
.局部变量 题号, 整数型, , , 

赋值 (最大题量, 取记录数 ()) ' 单元最大题量，就是题库数
赋值 (_启动窗口., 相加 (“高中数学自动化测试系统----广东省级电教课题   你好:”, 姓名))
赋值 (.内容, 相加 (“高中数学自动化测试系统――”, 当前单元))
赋值 (.宽度, 相乘 (取文本长度 (.内容), 12))
连续赋值 (假, .可视, .可视, .可视, .可视)
连续赋值 (真, .禁止, .禁止, .禁止, .禁止)
连续赋值 (假, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .禁止)
恢复按钮 ()
赋值 (.禁止, 真)

.子程序 _开始考试_被选择, 空白型, , 开始考试，并显示各组件
初始化 ()
连续赋值 (真, .可视, .可视, .可视, .可视, .禁止, .禁止, .可视, .可视, .可视, .可视, .可视)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
恢复按钮 ()
连续赋值 (真, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视, .可视)
显示题目 (1)
赋值 (.禁止, 真)

.子程序 初始化, 空白型, , 随机组题，采用随机算法
.局部变量 题号, 空白型, , , 
.局部变量 i, 空白型, , , 

置随机数种子 () ' 初始化题目列表
.计次循环首 (20, 题号)
    赋值 (题目列表 [题号], 取随机数 (1, 最大题量))
    赋值 (i, 取随机数 (1, 24))
    .判断开始 (等于 (i, 1))
        赋值 (选项列表 [题号], “ABCD A”)
    .判断 (等于 (i, 2))
        赋值 (选项列表 [题号], “ABDC A”)
    .判断 (等于 (i, 1))
        赋值 (选项列表 [题号], “ABCD A”)
    .判断 (等于 (i, 2))
        赋值 (选项列表 [题号], “ABDC A”)
    .判断 (等于 (i, 3))
        赋值 (选项列表 [题号], “ACBD A”)
    .判断 (等于 (i, 4))
        赋值 (选项列表 [题号], “ACDB A”)
    .判断 (等于 (i, 5))
        赋值 (选项列表 [题号], “ADBC A”)
    .判断 (等于 (i, 6))
        赋值 (选项列表 [题号], “ADCB A”)
    .判断 (等于 (i, 7))
        赋值 (选项列表 [题号], “BACD B”)
    .判断 (等于 (i, 8))
        赋值 (选项列表 [题号], “BADC B”)
    .判断 (等于 (i, 9))
        赋值 (选项列表 [题号], “BCAD C”)
    .判断 (等于 (i, 10))
        赋值 (选项列表 [题号], “BCDA D”)
    .判断 (等于 (i, 11))
        赋值 (选项列表 [题号], “BDAC C”)
    .判断 (等于 (i, 12))
        赋值 (选项列表 [题号], “BDCA D”)
    .判断 (等于 (i, 13))
        赋值 (选项列表 [题号], “CABD B”)
    .判断 (等于 (i, 14))
        赋值 (选项列表 [题号], “CADB B”)
    .判断 (等于 (i, 15))
        赋值 (选项列表 [题号], “CBAD C”)
    .判断 (等于 (i, 16))
        赋值 (选项列表 [题号], “CBDA D”)
    .判断 (等于 (i, 17))
        赋值 (选项列表 [题号], “CDAB C”)
    .判断 (等于 (i, 18))
        赋值 (选项列表 [题号], “CDBA D”)
    .判断 (等于 (i, 19))
        赋值 (选项列表 [题号], “DABC B”)
    .判断 (等于 (i, 20))
        赋值 (选项列表 [题号], “DACB B”)
    .判断 (等于 (i, 21))
        赋值 (选项列表 [题号], “DBAC C”)
    .判断 (等于 (i, 22))
        赋值 (选项列表 [题号], “DBCA D”)
    .判断 (等于 (i, 23))
        赋值 (选项列表 [题号], “DCAB C”)
    .判断 (等于 (i, 24))
        赋值 (选项列表 [题号], “DCBA D”)
    .默认
        信息框 (“程序可能有错：选择支未排序”, 0, )
    .判断结束
    
.计次循环尾 ()
连续赋值 (假, 复查标记, 结束标记, .禁止)
赋值 (开始时间, 取现行时间 ())
赋值 (.时钟周期, 1000)

.子程序 显示题目, 空白型, , 显示一个题目及相关内容
.参数 题号, 整数型, , 

.局部变量 图片号, 整数型, , , 

跳到 (题目列表 [题号]) ' 当前题号

赋值 (图片号, 载入图片 (读 (1))) ' 画出题目，在数据库中是第一个字段内容
赋值 (.高度, 图片号.取图片高度 ())
图片号.画图片 (0, 0, , , )
卸载图片 (图片号)

赋值 (.顶边, 相加 (.顶边, .高度, 3)) ' 画出选择支A
赋值 (图片号, 载入图片 (读 (相加 (相减 (取代码 (选项列表 [题号], 1), 取代码 (“A”, 1)), 2)))) ' 在选项列表中第一个字符，就是A选择支内容，如果是“A",则为字段2，"B"为字段3，"C"为字段4，"D"为字段5
赋值 (.顶边, .顶边)
赋值 (.高度, 相加 (图片号.取图片高度 (), 2))
.清除 ()
.如果 (等于 (取文本中间 (选项列表 [题号], 5, 1), “A”)) ' 如果该题作答是“A”，把画板设成粉红色
    赋值 (.刷子颜色, #粉红)
    0.画矩形 (0, .宽度, .高度)
    图片号.画图片 (0, 0, , , 负 (取颜色值 (255, 255, 255)))
.否则
    图片号.画图片 (0, 0, , , )
.如果结束
赋值 (.高度, .高度)
卸载图片 (图片号)

赋值 (.顶边, 相加 (.顶边, .高度))
赋值 (图片号, 载入图片 (读 (相加 (相减 (取代码 (选项列表 [题号], 2), 取代码 (“A”, 1)), 2)))) ' 在选项列表中第一个字符，就是A选择支内容，如果是“A",则为字段2，"B"为字段3，"C"为字段4，"D"为字段5
赋值 (.顶边, .顶边)
赋值 (.高度, 相加 (图片号.取图片高度 (), 2))
.清除 ()
.如果 (等于 (取文本中间 (选项列表 [题号], 5, 1), “B”))
    赋值 (.刷子颜色, #粉红)
    0.画矩形 (0, .宽度, .高度)
    图片号.画图片 (0, 0, , , 负 (取颜色值 (255, 255, 255)))
.否则
    图片号.画图片 (0, 0, , , )
.如果结束
赋值 (.高度, .高度)
卸载图片 (图片号)

赋值 (.顶边, 相加 (.顶边, .高度))
赋值 (图片号, 载入图片 (读 (相加 (相减 (取代码 (选项列表 [题号], 3), 取代码 (“A”, 1)), 2)))) ' 在选项列表中第一个字符，就是A选择支内容，如果是“A",则为字段2，"B"为字段3，"C"为字段4，"D"为字段5
赋值 (.顶边, .顶边)
赋值 (.高度, 相加 (图片号.取图片高度 (), 2))
.清除 ()
.如果 (等于 (取文本中间 (选项列表 [题号], 5, 1), “C”))
    赋值 (.刷子颜色, #粉红)
    0.画矩形 (0, .宽度, .高度)
    图片号.画图片 (0, 0, , , 负 (取颜色值 (255, 255, 255)))
.否则
    图片号.画图片 (0, 0, , , )
.如果结束
赋值 (.高度, .高度)
卸载图片 (图片号)

赋值 (.顶边, 相加 (.顶边, .高度))
赋值 (图片号, 载入图片 (读 (相加 (相减 (取代码 (选项列表 [题号], 4), 取代码 (“A”, 1)), 2)))) ' 在选项列表中第一个字符，就是A选择支内容，如果是“A",则为字段2，"B"为字段3，"C"为字段4，"D"为字段5
赋值 (.顶边, .顶边)
赋值 (.高度, 相加 (图片号.取图片高度 (), 2))
.清除 ()
.如果 (等于 (取文本中间 (选项列表 [题号], 5, 1), “D”))
    赋值 (.刷子颜色, #粉红)
    0.画矩形 (0, .宽度, .高度)
    图片号.画图片 (0, 0, , , 负 (取颜色值 (255, 255, 255)))
.否则
    图片号.画图片 (0, 0, , , )
.如果结束
赋值 (.高度, .高度)
卸载图片 (图片号)

赋值 (.标题, 到文本 (题号))
.如果 (等于 (取文本中间 (选项列表 [题号], 5, 1), “ ”))
    赋值 (.标题, “你还没选择”)
.否则
    赋值 (.标题, 相加 (“您的选择是”, 取文本中间 (选项列表 [题号], 5, 1)))
.如果结束

.如果 (等于 (复查标记, 真))
    赋值 (.标题, 相加 (“正确答案是”, 取文本中间 (选项列表 [题号], 6, 1)))
.否则
    赋值 (.标题, “正确答案不可知”)
.如果结束


.子程序 _时钟1_周期事件, 空白型, , 改变考试时间，倒计时
赋值 (进行时间, 取时间间隔 (取现行时间 (), 开始时间, #秒))
.如果真 (大于 (进行时间, 相乘 (60, 60)))
    结束考试 ()
.如果真结束
赋值 (.标题, 相加 (“剩余时间：”, 到文本 (到整数 (相减 (60, 相除 (进行时间, 60)))), “分钟”))


.子程序 结束考试, 空白型, , 结束考试，记分
.局部变量 成绩, 整数型, , , 
.局部变量 题号, 整数型, , , 

.如果真 (等于 (结束标记, 真))
    返回 ()
.如果真结束
赋值 (结束标记, 真)
赋值 (.时钟周期, 0)
赋值 (成绩, 0)
.计次循环首 (20, 题号)
    .如果真 (等于 (取文本中间 (选项列表 [题号], 5, 1), 取文本中间 (选项列表 [题号], 6, 1)))
        赋值 (成绩, 相加 (成绩, 5))
    .如果真结束
    
.计次循环尾 ()
连续赋值 (假, .禁止, .禁止, .禁止)
赋值 (.可视, 真)
赋值 (.标题, 相加 (“考试成绩：”, 到文本 (成绩)))
鼓励 (成绩)
提交成绩 (成绩)

.子程序 _选择A_被单击, 空白型, , 选择A，调用作答(A)
作答 (“A”)

.子程序 _选择B_被单击, 空白型, , 
作答 (“B”)


.子程序 _选择C_被单击, 空白型, , 
作答 (“C”)

.子程序 _选择D_被单击, 空白型, , 
作答 (“D”)

.子程序 _结束考试_被选择, 空白型, , 
结束考试 ()
连续赋值 (真, .禁止, .禁止)

.子程序 作答, 空白型, , 把答案写到选项列表[5]位置
.参数 答案, 文本型, , 

.局部变量 题号, 整数型, , , 
.局部变量 题目按钮, 按钮, , , 

赋值 (题号, 到整数 (.标题))
.如果 (小于 (题号, 20))
    显示题目 (相加 (题号, 1))
.否则
    显示题目 (1)
.如果结束
.如果真 (等于 (复查标记, 假))
    赋值 (选项列表 [题号], 文本替换 (选项列表 [题号], 5, 1, 答案))
.如果真结束
赋值 (题目按钮, 取标记组件 (题号)) ' 用组件标记改进了显示选择
赋值 (题目按钮.标题, 相加 (“第”, 到文本 (题号), “题 ”, 答案))

.子程序 鼓励, 空白型, , 
.参数 成绩, 整数型, , 

.判断开始 (等于 (成绩, 100))
    信息框 (“哇塞，你好厉害啊！”, 0, )
.判断 (大于 (成绩, 90))
    信息框 (“成绩优良”, 0, )
.判断 (大于 (成绩, 80))
    信息框 (“成绩合格”, 0, )
.默认
    信息框 (“成绩不合格，强烈建议复查”, 0, )
.判断结束


.子程序 _试卷复查_被选择, 空白型, , 考试结束后，考生可以进行复查，这对提高成绩很有帮助
连续赋值 (真, 复查标记, .可视, .禁止, .禁止, .禁止, .禁止)
显示题目 (1)

.子程序 _上一题_被选择, 空白型, , 显示上一题内容，如果是第1题，则显示第20题
.局部变量 题号, 整数型, , , 

.如果真 (并且 (等于 (复查标记, 假), 等于 (结束标记, 真)))
    返回 ()
.如果真结束
赋值 (题号, 到数值 (.标题))
.如果 (等于 (题号, 1))
    显示题目 (20)
.否则
    显示题目 (相减 (题号, 1))
.如果结束


.子程序 _下一题_被选择, 空白型, , 显示下一题内容，如果是第20题，则显示第1题
.局部变量 题号, 整数型, , , 

.如果真 (并且 (等于 (复查标记, 假), 等于 (结束标记, 真)))
    返回 ()
.如果真结束
赋值 (题号, 到数值 (.标题))
.如果 (等于 (题号, 20))
    显示题目 (1)
.否则
    显示题目 (相加 (题号, 1))
.如果结束


.子程序 _题目1_被单击, 空白型, , 显示第一题，这里有办法简化吗？寻找中
显示题目 (1)

.子程序 _题目2_被单击, 空白型, , 
显示题目 (2)

.子程序 _题目4_被单击, 空白型, , 
显示题目 (4)

.子程序 _题目3_被单击, 空白型, , 
显示题目 (3)

.子程序 _题目5_被单击, 空白型, , 
显示题目 (5)

.子程序 _题目6_被单击, 空白型, , 
显示题目 (6)

.子程序 _题目7_被单击, 空白型, , 
显示题目 (7)

.子程序 _题目8_被单击, 空白型, , 
显示题目 (8)

.子程序 _题目9_被单击, 空白型, , 
显示题目 (9)

.子程序 _题目10_被单击, 空白型, , 
显示题目 (10)

.子程序 _题目11_被单击, 空白型, , 
显示题目 (11)

.子程序 _题目12_被单击, 空白型, , 
显示题目 (12)

.子程序 _题目13_被单击, 空白型, , 
显示题目 (13)

.子程序 _题目14_被单击, 空白型, , 
显示题目 (14)

.子程序 _题目15_被单击, 空白型, , 
显示题目 (15)

.子程序 _题目16_被单击, 空白型, , 
显示题目 (16)

.子程序 _题目17_被单击, 空白型, , 
显示题目 (17)

.子程序 _题目18_被单击, 空白型, , 
显示题目 (18)

.子程序 _题目19_被单击, 空白型, , 
显示题目 (19)

.子程序 _题目20_被单击, 空白型, , 
显示题目 (20)


.子程序 _关于_被选择, 空白型, , 显示“关于”窗口
载入 (关于窗口, , 真)

.子程序 _开始按钮_被单击, 空白型, , 开始考试，模拟菜单（开始考试）被单击
_开始考试_被选择 ()

.子程序 _结束按钮_被单击, 空白型, , 结束考试，模拟菜单（结束考试）被单击
_结束考试_被选择 ()

.子程序 _复查按钮_被单击, 空白型, , 试卷复查，模拟菜单（试卷复查）被单击
_试卷复查_被选择 ()

.子程序 _调试按钮_被单击, 空白型, , 报错，以备查。如果题目出错，将从题库中去掉。目前这个功能太简单，目标：自动化报错
.局部变量 信息, 文本型, , , 
.局部变量 系统编号, 文本型, , , 

赋值 (系统编号, 相加 (当前单元, 到文本 (题目列表 [到数值 (.标题)])))
赋值 (信息, 相加 (“请记住本题系统编号：”, 系统编号, #换行符, “并将这个数字（”, 系统编号, “）发送到”, #换行符, “liusuyc@tom.com”, #换行符, “我必将在第一时间给您参考解答过程”))
信息框 (信息, 0, )

.子程序 _计算器按钮_被单击, 空白型, , 辅助工具
运行 (“calc.exe”, 假, )


.子程序 选择单元, 空白型, , 
.参数 被选单元, 文本型, , 

关闭 ()
赋值 (当前单元, 被选单元)
打开 (相加 (“data\”, 当前单元), , , , , , )
读入配置 ()


.子程序 _集合_被选择, 空白型, , 选择了“集合”单元
选择单元 (#单元1)

.子程序 _函数的概念和图像_被选择, 空白型, , 选择了“函数”单元
选择单元 (#单元2)

.子程序 _指数与对数函数_被选择, 空白型, , 选择了“指、对数”单元
选择单元 (#单元3)

.子程序 _立体几何_被选择, 空白型, , 
选择单元 (#单元4)

.子程序 _解析几何_被选择, 空白型, , 
选择单元 (#单元5)

.子程序 _算法设计_被选择, 空白型, , 
选择单元 (#单元6)

.子程序 _统计初步_被选择, 空白型, , 
选择单元 (#单元7)

.子程序 _概率与排列组合_被选择, 空白型, , 
选择单元 (#单元8)

.子程序 _三角函数_被选择, 空白型, , 
选择单元 (#单元9)

.子程序 _平面向量_被选择, 空白型, , 
选择单元 (#单元10)

.子程序 _三角恒等变形_被选择, 空白型, , 
选择单元 (#单元11)

.子程序 _解三角形_被选择, 空白型, , 
选择单元 (#单元12)

.子程序 _数列_被选择, 空白型, , 
选择单元 (#单元13)

.子程序 _不等式_被选择, 空白型, , 
选择单元 (#单元14)

.子程序 自动升级, 空白型, , 从网站上检测是否有新题库，并升级
.局部变量 升级地址, 文本型, , , 
.局部变量 循环变量, 整数型, , , 
.局部变量 原配置文件, 文本型, , , 
.局部变量 新配置文件, 文本型, , , 
.局部变量 题库名称, 文本型, , , 

赋值 (原配置文件, 相加 (取运行目录 (), “/data/math900.ini”)) ' 本机上题库信息
赋值 (新配置文件, 相加 (取运行目录 (), “/data/temp.ini”)) ' 服务器上题库信息
赋值 (升级地址, 读配置项 (原配置文件, “升级信息”, “升级地址”, ))
写到文件 (新配置文件, 未知支持库函数_7 (相加 (升级地址, “math900.ini”))) ' 从服务器上获得题库信息
.如果真 (等于 (读配置项 (新配置文件, “升级信息”, “单元数量”, “0”), “0”))
    信息框 (“无法连接服务器，放弃升级”, 0, ) ' 升级失败
    返回 ()
.如果真结束
.如果真 (不等于 (读配置项 (原配置文件, “升级信息”, “单元数量”, ), 读配置项 (新配置文件, “升级信息”, “单元数量”, )))
     ' 单元数量不同，意味着系统已经进行了大的升级（如增加了模块内容，程序重写等），用户可以下载最新的系统，而不仅仅是题库。当然，用户仍然可以继续使用旧系统，只升级题库
     ' 对于系统构建而言，打包给用户的math900.ini，升级地址是http://math900.meibu.com/data/之类的路径；在服务器上的math900.ini，升级地址是http://math900.meibu.com/setup.exe这样的下载文件。切记！切记！不能弄错，否则用户无法升级
    .如果真 (等于 (信息框 (“更新程序发现：题库增加了新的单元，强烈建议下载最新系统，下载后请自行解压缩覆盖原文件即可。下载吗？”, #确认取消钮, “注意啦，系统已经全面升级！”), #确认钮))
        写到文件 (相加 (取运行目录 (), “setup.exe”), 未知支持库函数_7 (读配置项 (新配置文件, “升级信息”, “升级地址”, )))
         ' 弹出下载窗口 (读配置项 (新配置文件, “升级信息”, “升级地址”, ), , )
        返回 ()
    .如果真结束
    
.如果真结束
.计次循环首 (到整数 (读配置项 (原配置文件, “升级信息”, “单元数量”, )), 循环变量)
     ' 升级方法：一个单元一个单元比对本机题量与服务器题量，如果不同则升级
     ' 升级时同时下载两个文件：单元.edb、单元.edt
     ' 升级结束后，将本机题库信息与服务器题库信息同步
    .如果真 (不等于 (读配置项 (原配置文件, 相加 (“单元”, 到文本 (循环变量)), “题库数量”, ), 读配置项 (新配置文件, 相加 (“单元”, 到文本 (循环变量)), “题库数量”, ))) ' 比对题量
        赋值 (题库名称, 读配置项 (新配置文件, 相加 (“单元”, 到文本 (循环变量)), “题库名称”, ))
        写到文件 (相加 (取运行目录 (), “/data/”, 题库名称, “.edb”), 未知支持库函数_7 (相加 (升级地址, 题库名称, “.edb”))) ' 下载edb文件
        写到文件 (相加 (取运行目录 (), “/data/”, 题库名称, “.edt”), 未知支持库函数_7 (相加 (升级地址, 题库名称, “.edt”))) ' 下载edt文件
         ' 更新配置项
        写配置项 (原配置文件, 相加 (“单元”, 到文本 (循环变量)), “题库数量”, 读配置项 (新配置文件, 相加 (“单元”, 到文本 (循环变量)), “题库数量”, ))
        写配置项 (原配置文件, 相加 (“单元”, 到文本 (循环变量)), “题库名称”, 题库名称)
    .如果真结束
    
.计次循环尾 ()
返回 ()

.子程序 恢复按钮, 空白型, , 恢复窗口各按钮组件标题
.局部变量 题目数组, 按钮, , , 
.局部变量 题号, 整数型, , , 

.计次循环首 (20, 题号)
    赋值 (题目数组, 取标记组件 (题号))
    赋值 (题目数组.可视, 假)
    赋值 (题目数组.标题, 相加 (“第”, 到文本 (题号), “题”))
.计次循环尾 ()

.子程序 提交成绩, 空白型, , 网上提交成绩，参加排行。如果用户名是“测试”则不参加
.参数 成绩, 整数型, , 

.局部变量 提交数据, 文本型, , , 
.局部变量 返回数据, 字节集, , , 

.如果真 (等于 (姓名, “测试”))
    返回 ()
.如果真结束
 ' 提交数据中，由于含有中文姓名，因此，有时候服务器端会出现一些问题，不知为何，困惑。
赋值 (提交数据, 相加 (“paid=”, 姓名, “&company=”, 到文本 (成绩), “&post=”, 求兼容单元名 (当前单元)))
赋值 (返回数据, 访问网页 (“http://math900.meibu.com/cgi-bin/cgifrm.exe?”, “POST”, , , 提交数据, 5))
 ' 由于服务器为避免一些作弊行为，设置了提交数据必须以"POST"方式提交，但好像支持库中这个"HTTP读文件"子程序不能以POST方式读取网页，因此，不得不使用了一个模块。如果不使用模块，就无法实现提交试卷。
.如果真 (等于 (寻找字节集 (返回数据, 到字节集 (“恭喜”), ), -1))
     ' 成功提交成绩，会返回含有“恭喜你，成功提交成绩数据”内容的HTML文本
    返回 ()
.如果真结束
 ' 爬行窗口的规则：第一次提交成绩是不能参与爬行的，在第二次提交成绩时，才进行爬行
 ' 每次提交成绩。
 ' 将“成绩-20”分作为积分入库，其原因是：
 ' 由于有些人不会做题，或根本就不想做题，胡乱选一些答案，然后参加爬行
 ' 而选择题胡乱选得分概率为四分之一，也就是25分，因此减20分就很人道了
载入 (爬行窗口, , 真)

.子程序 _重新登录_被选择, 空白型, , 重新登录
.循环判断首 ()
    
.循环判断尾 (取反 (输入框 (“请填写姓名，本信息用于网上提交，参加成绩爬行榜。注意：姓名信息不能为空”, “重新登录”, “测试”, 姓名, )))
读入配置 ()


.子程序 _退出_被选择, 空白型, , 
销毁 ()


.子程序 _帮助主题_被选择, 空白型, , 
运行 (相加 (“HH ”, 取运行目录 (), “\帮助文件.chm”), 假, )


.子程序 _排行榜_被选择, 空白型, , 
载入 (爬行窗口, , 真)

.窗口程序集 窗口程序集_关于窗口, , , 

.子程序 _按钮1_被单击, 空白型, , 
关于窗口.销毁 ()

.窗口程序集 窗口程序集_爬行窗口, , , 

.子程序 _爬行窗口_创建完毕, 空白型, , 
赋值 (., 相加 (“http://math900.meibu.com/”, 求兼容单元名 (当前单元), “.html”))


.子程序 _爬行窗口_尺寸被改变, 空白型, , 
连续赋值 (0, ., ., .)
赋值 (., 取用户区高度 ())
赋值 (., 相除 (取用户区宽度 (), 2))
赋值 (., .)
赋值 (., 取用户区高度 ())
赋值 (., 相减 (取用户区宽度 (), .))

.程序集 程序集1, , , 

.子程序 求兼容单元名, 文本型, , 由于Web系统不能支持汉字文件名，不得已采用了30、31、32之类的单元名称。因此，将数据返回给服务器时，也必须将“集合”换成“30”、“函数”换成“31”等
.参数 新文本, 文本型, , 

.判断开始 (等于 (新文本, #单元1))
    返回 (“30”)
.判断 (等于 (新文本, #单元2))
    返回 (“31”)
.判断 (等于 (新文本, #单元3))
    返回 (“32”)
.判断 (等于 (新文本, #单元4))
    返回 (“40”)
.判断 (等于 (新文本, #单元5))
    返回 (“41”)
.判断 (等于 (新文本, #单元6))
    返回 (“41”)
.判断 (等于 (新文本, #单元7))
    返回 (“51”)
.判断 (等于 (新文本, #单元8))
    返回 (“52”)
.判断 (等于 (新文本, #单元9))
    返回 (“53”)
.判断 (等于 (新文本, #单元9))
    返回 (“61”)
.判断 (等于 (新文本, #单元10))
    返回 (“62”)
.判断 (等于 (新文本, #单元11))
    返回 (“63”)
.判断 (等于 (新文本, #单元12))
    返回 (“71”)
.判断 (等于 (新文本, #单元13))
    返回 (“72”)
.默认
    
.判断结束
返回 (“73”)

.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 访问网页, 字节集, , 有可能线程阻塞,请在外部加超时判断
.参数 完整网址, 文本型, , 
.参数 访问方式, 文本型, 可空, "GET" or "POST",为空默认"GET"
.参数 代理地址, 文本型, 可空, 
.参数 附加协议头, 文本型, 可空, 
.参数 提交信息, 文本型, 可空, "POST"专用
.参数 超时值, 整数型, 可空, 



.子程序 取域名, 文本型, , 
.参数 网址, 文本型, , 



.子程序 取端口, 整数型, , 
.参数 网址, 文本型, , 



.子程序 取页面地址, 文本型, , 
.参数 网址, 文本型, , 



.子程序 设COOKIE, 逻辑型, , 1.1
.参数 网址, 文本型, , 
.参数 COOKIE名称, 文本型, 可空, 为空清除所有
.参数 COOKIE内容, 文本型, 可空, 为空清除
.参数 有效期, 日期时间型, 可空, 为空不保存



.子程序 清除COOKIE, 逻辑型, , 
.参数 域名, 文本型, , 



.子程序 延时器, 空白型, , 
.参数 延时值, 整数型, , 



.子程序 转换为GMT格式, 文本型, , 将日期时间型数据转换为GMT格式
.参数 待转换时间, 日期时间型, , 



.子程序 取COOKIE, 文本型, , 
.参数 网址, 文本型, , 
.参数 COOKIE名称, 文本型, 可空, 为空返回全部COOKIE




 ' 不属于任何一个程序集、类模块的函数：
