 ' 文件类型：Windows模块源码

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 514
    高度 = 402
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\图标类.e\窗口1_图标.ico
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.图片 , , , 
.图片 图标1, " ' 已保存到：D:\易语言学习\Data\图标类.e\图标1", , 
.图片 图标, " ' 已保存到：D:\易语言学习\Data\图标类.e\图标", , 
.常量 WM_GETICON, "127", , 
.常量 ICON_SMALL, "0", , 
.常量 , , , 
.常量 位图是否压缩, "", , 
.常量 BI_RGB, "0", , 不压缩
.常量 , , , 
.常量 CreateDIBSection常量, "", , 
.常量 DIB_PAL_COLORS, "1", , BITMAPINFO包含了一个16位调色板索引的数组
.常量 DIB_RGB_COLORS, "0", , BITMAPINFO包含了一个颜色表，其中保存有32位颜色（RGBQUAD）
.常量 , , , 
.常量 Bitblt复制常量, "", , 
.常量 SRCCOPY, "13369376", , 直接复制，不做任何修改。


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' spec A512548E76954B6E92C21055517615B0 3 0 特殊功能支持库




数据类型 ICONDIRENTRY, , 
    .成员 bWidth, 字节型, , , 
    .成员 bHeight, 字节型, , , 
    .成员 bColorCount, 字节型, , , 
    .成员 bReserved, 字节型, , , 
    .成员 wPlanes, 短整数型, , , 
    .成员 wBitCount, 短整数型, , , 
    .成员 dwBytesInRes, 整数型, , , 
    .成员 dwImageOffset, 整数型, , , 

数据类型 ICONDIR, , 
    .成员 idReserved, 整数型, , , 
    .成员 idType, 整数型, , , 
    .成员 idCount, 整数型, , , 
    .成员 idEntries, ICONDIRENTRY, , "1", 

数据类型 SHFILEINFO, , 
    .成员 hIcon, 空白型, , , 
    .成员 iIcon, 空白型, , , 
    .成员 dwAttributes, 空白型, , , 
    .成员 szDisplayName, 字节型, , "256", 
    .成员 szTypeName, 字节型, , "80", 

数据类型 RECT, 公开, 区域
    .成员 Left, 整数型, , , 左
    .成员 Top, 整数型, , , 上
    .成员 Right, 整数型, , , 右
    .成员 Bottom, 整数型, , , 下

数据类型 BITMAPFILEHEADER, , 位图文件头
    .成员 bfType, 短整数型, , , 位图的类型 一般为BM 即 19778
    .成员 bfSize, 整数型, , , 文件大小
    .成员 bfReserved1, 短整数型, , , 保留，必须设置为0
    .成员 bfReserved2, 短整数型, , , 保留，必须设置为0
    .成员 bfOffBits, 整数型, , , 从文件开始到位图数据开始之间的数据(bitmap data)之间的偏移量,包括颜色表大小

数据类型 BITMAPINFOHEADER, , 位图信息头
    .成员 biSize, 整数型, , , 指出本数据结构所需要的字节数(一般为40长度)
    .成员 biWidth, 整数型, , , 以象素为单位，给出BMP图象的宽度
    .成员 biHeight, 整数型, , , 以象素为单位，给出BMP图象的高度
    .成员 biPlanes, 短整数型, , , 输出设备的位平面数，必须置为1
    .成员 biBitCount, 短整数型, , , 给出每个象素的位数
    .成员 biCompression, 整数型, , , 给出位图的压缩类型
    .成员 biSizeImage, 整数型, , , 给出图象字节数的多少
    .成员 biXPelsPerMeter, 整数型, , , 图像的水平分辨率
    .成员 biYPelsPerMeter, 整数型, , , 图象的垂直分辨率
    .成员 biClrUsed, 整数型, , , {色板中图象实际使用的颜色素数
    .成员 biClrImportant, 整数型, , , 给出重要颜色的索引值


.DLL命令 CreateIconFromResourceEx, 整数型, "user32", "CreateIconFromResourceEx", , 
    .参数 presbits, 字节集, 传址, 
    .参数 dwResSize, 整数型, , 
    .参数 fIcon, 整数型, , 
    .参数 dwVer, 整数型, , 
    .参数 cxDesired, 整数型, , 
    .参数 cyDesired, 整数型, , 
    .参数 uFlags, 整数型, , 

.DLL命令 DrawIconEx, 整数型, "user32.dll", "DrawIconEx", , 
    .参数 hdc, 整数型, , 
    .参数 xLeft, 整数型, , 
    .参数 yTop, 整数型, , 
    .参数 hIcon, 整数型, , 
    .参数 cxWidth, 整数型, , 
    .参数 cyWidth, 整数型, , 
    .参数 istepIfAniCur, 整数型, , 
    .参数 hbrFlickerFreeDraw, 整数型, , 
    .参数 diFlags, 整数型, , 

.DLL命令 DestroyIcon, 整数型, "user32", "DestroyIcon", , 
    .参数 hIcon, 整数型, , 

.DLL命令 CopyMemory, 空白型, "kernel32.dll", "RtlMoveMemory", , 
    .参数 Destination, 字节集, 传址, 
    .参数 Source, 整数型, 传址, 
    .参数 Length, 整数型, , 

.DLL命令 CopyMemory_图标数量, 空白型, "kernel32.dll", "RtlMoveMemory", , 
    .参数 Destination, 整数型, 传址, 
    .参数 Source, 整数型, 传址, 
    .参数 Length, 整数型, , 

.DLL命令 CopyMemory_图标结构, 空白型, "kernel32.dll", "RtlMoveMemory", , 
    .参数 Destination, ICONDIRENTRY, 传址, 
    .参数 Source, 字节集, 传址, 
    .参数 Length, 整数型, , 

.DLL命令 取设备场景_, 整数型, "user32", "GetDC", , 获取指定窗口的设备场景  指定窗口的设备场景句柄，出错则为0
    .参数 窗口的句柄, 整数型, , 将获取其设备场景的窗口的句柄。若为0，则要获取整个屏幕的DC;

.DLL命令 DeleteDC, 整数型, "gdi32.dll", "DeleteDC", , 
    .参数 设备场景句柄, 整数型, , hdc，将要删除的设备场景

.DLL命令 SHGetFileInfo, 整数型, "", "SHGetFileInfo", 公开, 
    .参数 pszPath, 文本型, , 
    .参数 dwFileAttributes, 整数型, , 
    .参数 psfi, SHFILEINFO, , 
    .参数 cbFileInfo, 整数型, , 
    .参数 uFlags, 整数型, , 

.DLL命令 CreateCompatibleDC, 整数型, "gdi32.dll", "CreateCompatibleDC", 公开, 新设备场景句柄，若出错则为零
    .参数 hdc, 整数型, , hdc，源设备场景句柄

.DLL命令 CreateCompatibleBitmap, 整数型, "gdi32.dll", "CreateCompatibleBitmap", 公开, 执行成功返回位图句柄，零表示失败
    .参数 hdc, 整数型, , 设备场景句柄
    .参数 nWidth, 整数型, , 位图宽度
    .参数 nHeight, 整数型, , 位图高度

.DLL命令 SelectObject, 整数型, "gdi32.dll", "SelectObject", 公开, 每个设备场景都可能有选入其中的图形对象。其中包括位图、刷子、字体、画笔以及区域等等。一次选入设备场景的只能有一个对象。选定的对象会在设备场景的绘图操作中使用。例如，当前选定的画笔决定了在设备场景中描绘的线段颜色及样式,与以前选入设备场景的相同hObject类型的一个对象的句柄，零表示出错。如选定的对象是一个区域（Region），结果就是下列常数之一：SIMPLEREGION， COMPLEXREGION 或 NULLREGION 对区域进行描述， GDI_ERROR 表示出错
    .参数 hdc, 整数型, , 一个设备场景的句柄
    .参数 hObject, 整数型, , 一个画笔、位图、刷子、字体或区域的句柄

.DLL命令 CreateSolidBrush, 整数型, "gdi32.dll", "CreateSolidBrush", 公开, 
    .参数 crColor, 整数型, , 

.DLL命令 FillRect, 整数型, "user32.dll", "FillRect", , 
    .参数 hdc, 整数型, , 
    .参数 lpRect, RECT, 传址, 
    .参数 hBrush, 整数型, , 

.DLL命令 ReleaseDC, 逻辑型, "user32.dll", "ReleaseDC", , 
    .参数 hwnd, 整数型, , 
    .参数 hDC, 整数型, , 

.DLL命令 DeleteObject, 整数型, "gdi32.dll", "DeleteObject", , 用这个函数删除GDI对象，比如画笔、刷子、字体、位图、区域以及调色板等等。对象使用的所有系统资源都会被释放,非零表示成功，零表示失败
    .参数 hObject, 整数型, , 一个GDI对象的句柄

.DLL命令 CreateDIBSection, 整数型, "gdi32.dll", "CreateDIBSection", , 
    .参数 hDC, 整数型, , 
    .参数 pBitmapInfo, 字节集, 传址, 
    .参数 un, 整数型, , 
    .参数 lplpVoid, 整数型, 传址, 
    .参数 handle, 整数型, , 
    .参数 dw, 整数型, , 

.DLL命令 BitBlt, 整数型, "gdi32.dll", "BitBlt", , 
    .参数 hDestDC, 整数型, , 
    .参数 x, 整数型, , 
    .参数 y, 整数型, , 
    .参数 nWidth, 整数型, , 
    .参数 nHeight, 整数型, , 
    .参数 hSrcDC, 整数型, , 
    .参数 xSrc, 整数型, , 
    .参数 ySrc, 整数型, , 
    .参数 dwRop, 整数型, , 

.DLL命令 GdiFlush, 整数型, "gdi32.dll", "GdiFlush", , 执行任何未决的绘图操作,如所有未决的绘图操作都成功完成，就返回TRUE（非零）。如任何一个操作失败，就返回零值

.DLL命令 memcpy, 空白型, "Kernel32.dll", "RtlMoveMemory", , 复制内存(无返回值)
    .参数 Destination, 整数型, , 目的指针
    .参数 Source, 整数型, , 源指针
    .参数 Length, 整数型, , 复制长度

.DLL命令 lstrcpyn, 整数型, "kernel32.dll", "lstrcpyn", , 取变量地址,返回内存地址(此API还有其他作用)
    .参数 lpString1, 字节集, 传址, 欲取其指针的变量,一定要传址
    .参数 lpString2, 字节集, 传址, 欲取其指针的变量一定要传址.重复一次
    .参数 iMaxLength, 整数型, , 这里无用,给0

.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。
载入 (窗口1, , 假)

.类模块 图标类, , , 

.程序集变量 图标信息, SHFILEINFO, , , 
.程序集变量 集图标数据, 字节集, , , 
.程序集变量 集图标数量, 整数型, , , 
.程序集变量 集图标结构集合, ICONDIR, , , 
.程序集变量 集场景句柄, 整数型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 取文件的图标, 字节集, 公开, 
.参数 文件名, 文本型, , 
.参数 背景色, 整数型, 可空, 

.局部变量 图标句柄, 整数型, , , 

SHGetFileInfo (文件名, 128, 图标信息, 348, 256)
赋值 (图标句柄, 图标信息.hIcon)
.如果真 (是否为空 (背景色))
    赋值 (背景色, #粉红)
.如果真结束
返回 (通过句柄取图标 (图标句柄, 32, 32, 背景色))

 ' 本源码来自易语言资源网(www.5A5X.com)


.子程序 通过句柄取图标, 字节集, , 
.参数 图标句柄, 整数型, , 
.参数 图标宽度, 整数型, 可空, 
.参数 图标高度, 整数型, 可空, 
.参数 背景颜色, 整数型, 可空, 

.局部变量 sRect, RECT, , , 
.局部变量 sIco, 字节集, , , 
.局部变量 位图操作, 位图操作类, , , 
.局部变量 匿名局部变量_373, 空白型, , , 
.局部变量 SrchDC, 整数型, , , 
.局部变量 newDC, 整数型, , , 
.局部变量 hwnd, 整数型, , , 
.局部变量 hBmp, 整数型, , , 
.局部变量 hBmpPrev, 整数型, , , 
.局部变量 mBrush, 整数型, , , 
.局部变量 匿名局部变量_380, 空白型, , , 

.如果真 (是否为空 (图标宽度))
    赋值 (图标宽度, 32)
.如果真结束
.如果真 (是否为空 (图标高度))
    赋值 (图标高度, 32)
.如果真结束
.如果真 (是否为空 (背景颜色))
    赋值 (背景颜色, #白色)
.如果真结束
赋值 (sRect.Top, 0)
赋值 (sRect.Left, 0)
赋值 (sRect.Right, 图标宽度)
赋值 (sRect.Bottom, 图标高度)
赋值 (SrchDC, 取设备场景_ (0))
赋值 (newDC, CreateCompatibleDC (SrchDC))
 ' 验证 (newDC)
赋值 (hBmp, CreateCompatibleBitmap (SrchDC, 32, 32))
 ' 验证 (hBmp)
赋值 (hBmpPrev, SelectObject (newDC, hBmp))
 ' 验证 (hBmpPrev)
赋值 (mBrush, CreateSolidBrush (背景颜色))
FillRect (newDC, sRect, mBrush)
DrawIconEx (newDC, 0, 0, 图标句柄, 图标宽度, 图标高度, 0, 0, 3)
位图操作.CaptureDC (newDC, sRect, 32)
赋值 (sIco, 位图操作.Write ())
ReleaseDC (hwnd, SrchDC)
DeleteDC (newDC)
DeleteObject (hBmpPrev)
DeleteObject (hBmp)
DeleteObject (mBrush)
返回 (sIco)


.子程序 从资源载入图标, 逻辑型, 公开, 有图标的返回真，否则返回假。
.参数 图标, 字节集, , 

.局部变量 i, 空白型, , , 
.局部变量 临时字节集, 字节集, , , 


赋值 (集图标数据, 图标)
 ' 调试输出 (m_Data)
.如果真 (小于 (取字节集长度 (图标), 4))
    返回 (假)
.如果真结束
CopyMemory_图标数量 (集图标数量, 集图标数据 [5], 4) ' 取得图标个数
.如果真 (大于 (集图标数量, 0))
    重定义数组 (集图标结构集合.idEntries, 假, 集图标数量) ' 图标目录结构数据
    .计次循环首 (集图标数量, i)
        赋值 (临时字节集, 取字节集中间 (集图标数据, 相加 (7, 相乘 (16, 相减 (i, 1))), 16))
        CopyMemory_图标结构 (集图标结构集合.idEntries [i], 临时字节集, 取字节集长度 (临时字节集))
    .计次循环尾 ()
    返回 (真)
.如果真结束

返回 (假)

.子程序 取图标数量, 整数型, 公开, 
返回 (集图标数量)

.子程序 取高度, 整数型, 公开, 返回根据图标索引的高度值。注意！索引参数值不能大于“取图标数量（）”命令的返回值，否则返回零
.参数 图标索引, 整数型, 可空, 要取的高度的图标索引值，请不要大于图标的数量。默认是取第一个图标高度

.判断开始 (是否为空 (图标索引))
    返回 (集图标结构集合.idEntries [1].bHeight)
.默认
    .如果 (大于 (图标索引, 集图标数量))
        返回 (0)
    .否则
        返回 (集图标结构集合.idEntries [图标索引], bHeight)
    .如果结束
    
.判断结束


.子程序 取颜色数量, 整数型, 公开, 返回根据图标索引的颜色数量值。注意！索引参数值不能大于“取图标数量（）”命令的返回值，否则返回零
.参数 图标索引, 整数型, 可空, 要取的颜色数量的图标索引值，请不要大于图标的数量。默认是取第一个图标颜色数量值

.判断开始 (是否为空 (图标索引))
    返回 (集图标结构集合.idEntries [1].bColorCount)
.默认
    .如果 (大于 (图标索引, 集图标数量))
        返回 (0)
    .否则
        返回 (集图标结构集合.idEntries [图标索引], bColorCount)
    .如果结束
    
.判断结束


.子程序 取宽度, 整数型, , 返回根据图标索引的宽度值。注意！索引参数值不能大于“取图标数量（）”命令的返回值，否则返回零
.参数 图标索引, 整数型, 可空, 要取的宽度的图标索引值，请不要大于图标的数量。默认是取第一个图标宽度值

.判断开始 (是否为空 (图标索引))
    返回 (集图标结构集合.idEntries [1].bWidth)
.默认
    .如果 (大于 (图标索引, 集图标数量))
        返回 (0)
    .否则
        返回 (集图标结构集合.idEntries [图标索引], bWidth)
    .如果结束
    
.判断结束


.子程序 取尺寸, 整数型, , 返回根据图标索引的尺寸值。注意！索引参数值不能大于“取图标数量（）”命令的返回值，否则返回零
.参数 图标索引, 整数型, 可空, 要取的尺寸的图标索引值，请不要大于图标的数量。默认是取第一个图标尺寸值

.判断开始 (是否为空 (图标索引))
    返回 (集图标结构集合.idEntries [1].dwBytesInRes)
.默认
    .如果 (大于 (图标索引, 集图标数量))
        返回 (0)
    .否则
        返回 (集图标结构集合.idEntries [图标索引], dwBytesInRes)
    .如果结束
    
.判断结束



.子程序 取图标的图片, 字节集, 公开, 返回根据图标索引的图标字节集值。注意！索引参数值不能大于“取图标数量（）”命令的返回值，否则返回空字节集。
.参数 图标索引, 整数型, 可空, 要取的图标的图标索引值，请不要大于图标的数量。默认是取第一个图标字节集值

.局部变量 起始位置, 整数型, , , 
.局部变量 字节集长度, 整数型, , , 

.判断开始 (是否为空 (图标索引))
    赋值 (起始位置, 相加 (集图标结构集合.idEntries [1].dwImageOffset, 1))
    赋值 (字节集长度, 集图标结构集合.idEntries [1].dwBytesInRes)
.默认
    .如果 (大于 (图标索引, 集图标数量))
        返回 ({  })
    .否则
        赋值 (起始位置, 相加 (集图标结构集合.idEntries [图标索引], dwImageOffset, 1))
        赋值 (字节集长度, 集图标结构集合.idEntries [图标索引], dwBytesInRes)
        
    .如果结束
     ' 本源码来自易语言资源网(www.5A5X.com)
.判断结束

返回 (相加 ({ 0, 0, 1, 0, 1, 0 }, 取字节集中间 (集图标数据, 相加 (7, 相乘 (16, 相减 (图标索引, 1))), 12), { 22, 0, 0, 0 }, 取字节集中间 (集图标数据, 起始位置, 字节集长度)))

.子程序 从文件载入图标, 逻辑型, 公开, 有图标的返回真，否则返回假。
.参数 图标路径, 文本型, , 

返回 (从资源载入图标 (读入文件 (图标路径)))

.子程序 绘制图标, 逻辑型, 公开, 成功返回真。
.参数 场景句柄, 整数型, 可空, 
.参数 横向位置, 整数型, , 
.参数 竖向位置, 整数型, , 
.参数 图标索引, 整数型, 可空, 默认为第一个

.局部变量 局宽度, 空白型, , , 
.局部变量 局高度, 空白型, , , 
.局部变量 图标句柄, 空白型, , , 
.局部变量 执行状态, 逻辑型, , , 

.判断开始 (是否为空 (图标索引))
    赋值 (图标索引, 1)
.默认
    .如果真 (大于 (图标索引, 取图标数量 ()))
        返回 (假)
    .如果真结束
    
.判断结束

.如果真 (是否为空 (场景句柄))
    赋值 (场景句柄, 集场景句柄)
.如果真结束


赋值 (局宽度, 取宽度 (图标索引))
赋值 (局高度, 取高度 (图标索引))

赋值 (图标句柄, CreateIconFromResourceEx (取字节集中间 (集图标数据, 相加 (集图标结构集合.idEntries [图标索引], dwImageOffset, 1), 集图标结构集合.idEntries [图标索引], dwBytesInRes), 取尺寸 (图标索引), 1, 196608, 局宽度, 局高度, 0))
赋值 (执行状态, 不等于 (DrawIconEx (场景句柄, 横向位置, 竖向位置, 图标句柄, 局宽度, 局高度, 0, 0, 3), 0))
DestroyIcon (图标句柄)
返回 (执行状态)


.子程序 清除图标句柄, 逻辑型, 公开, 
.参数 图标句柄, 整数型, , 

返回 (不等于 (DestroyIcon (图标句柄), 0))

.子程序 取图标句柄, 整数型, 公开, 返回一个句柄
.参数 图标索引, 整数型, 可空, 默认为取第一个

.判断开始 (是否为空 (图标索引))
    赋值 (图标索引, 1)
.默认
    .如果真 (大于 (图标索引, 取图标数量 ()))
        返回 (0)
    .如果真结束
    
.判断结束


返回 (CreateIconFromResourceEx (取字节集中间 (集图标数据, 相加 (集图标结构集合.idEntries [图标索引], dwImageOffset, 1), 集图标结构集合.idEntries [图标索引], dwBytesInRes), 取尺寸 (图标索引), 1, 196608, 取宽度 (图标索引), 取高度 (图标索引), 0))
' 本源码来自易语言资源网(www.5A5X.com)




.子程序 取设备场景, 整数型, 公开, 
.参数 句柄, 整数型, 可空, 

.如果真 (是否为空 (句柄))
    赋值 (集场景句柄, 取设备场景_ (0))
.如果真结束
赋值 (集场景句柄, 取设备场景_ (句柄))
返回 (集场景句柄)

.子程序 删除设备场景, 空白型, 公开, 
.参数 场景句柄, 整数型, 可空, 

.如果真 (是否为空 (场景句柄))
    赋值 (场景句柄, 集场景句柄)
.如果真结束

DeleteDC (场景句柄)

.窗口程序集 窗口程序集1, , , 

.程序集变量 图标类, 图标类, , , 
.程序集变量 上次内容, 文本型, , , 
.子程序 _按钮1_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 画板, 图片框, , , 

 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

.如果真 (打开 ())
    图标类.从文件载入图标 (.文件名)
    赋值 (.可视, 假)
    调试输出 (图标类.取图标数量 ())
    .计次循环首 (图标类.取图标数量 (), 计次)
        赋值 (画板, 取标记组件 (计次))
        赋值 (画板.可视, 真)
        赋值 (画板.图片, 图标类.取图标的图片 (计次))
    .计次循环尾 ()
    .变量循环首 (计次, 48, 1, 计次)
        赋值 (画板, 取标记组件 (计次))
        赋值 (画板.可视, 假)
    .变量循环尾 ()
    赋值 (.内容, 到文本 (图标类.取图标数量 ()))
    赋值 (窗口1., 相加 (“共有图标数量：”, 到文本 (图标类.取图标数量 ())))
.如果真结束
 ' 本源码来自易语言资源网(www.5A5X.com)

 ' 调试输出 (图标类.取图标 (4), #换行符 ＋ “-----------------------”)
 ' 调试输出 (#图标1)
 ' 写到文件 (“C:\Documents and Settings\Administrator\桌面\Icon\Icon.ico”, 图标类.取图标 (4))
 ' 图片框1.图片 ＝ 图标类.取图标 (4)
 ' 调试输出 (取字节集中间 (#图标, 30900, 500))

.子程序 _窗口1_创建完毕, 空白型, , 
.局部变量 画板, 图片框, , , 
.局部变量 计次, 整数型, , , 

图标类.从资源载入图标 (#图标)
 ' 图标类.从文件载入图标 (“C:\Documents and Settings\Administrator\桌面\数据分析系统2.2.00\Picture\H8.ico”)
赋值 (.内容, 到文本 (图标类.取图标数量 ()))
.计次循环首 (图标类.取图标数量 (), 计次)
    赋值 (画板, 取标记组件 (计次))
    赋值 (画板.可视, 真)
    赋值 (画板.图片, 图标类.取图标的图片 (计次))
.计次循环尾 ()
.变量循环首 (计次, 48, 1, 计次)
    赋值 (画板, 取标记组件 (计次))
    赋值 (画板.可视, 假)
.变量循环尾 ()
赋值 (上次内容, .内容)
赋值 (窗口1., 相加 (“共有图标数量：”, 到文本 (图标类.取图标数量 ())))

.子程序 _按钮2_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 画板, 图片框, , , 
.局部变量 设备场景, 整数型, , , 
.局部变量 图标句柄, 整数型, , , 

 ' 延迟 (100)
赋值 (.可视, 真)
.计次循环首 (48, 计次)
    赋值 (画板, 取标记组件 (计次))
    赋值 (画板.可视, 假)
.计次循环尾 ()
窗口1.重画 ()
处理事件 ()

赋值 (设备场景, 图标类.取设备场景 (取窗口句柄 ()))

赋值 (.底图, 图标类.取图标的图片 (到整数 (.内容)))
调试输出 (图标类.绘制图标 (150, 100, 到整数 (.内容)))
图标类.删除设备场景 ()
赋值 (图标句柄, 图标类.取图标句柄 ())
赋值 (窗口1., 相加 (“所画的图标句柄为：”, 到文本 (图标句柄)))
图标类.清除图标句柄 (图标句柄)

.子程序 _编辑框1_内容被改变, 空白型, , 

.如果真 (或者 (大于 (到整数 (.内容), 图标类.取图标数量 ()), 小于 (到整数 (.内容), 1)))
    信息框 (“你输入的数值已经超过了，应有的图标数。”, 0, )
    赋值 (.内容, 上次内容)
    返回 ()
    ' 本源码来自易语言资源网(www.5A5X.com)
.如果真结束
赋值 (上次内容, .内容)

.子程序 _按钮3_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 画板, 图片框, , , 

窗口1.重画 ()
.判断开始 (小于 (图标类.取图标数量 (), 1))
    信息框 (“没有图标。请加载。”, 0, )
.默认
    赋值 (.可视, 假)
     ' 调试输出 (图标类.取图标数量 ())
    .计次循环首 (图标类.取图标数量 (), 计次)
        赋值 (画板, 取标记组件 (计次))
        赋值 (画板.可视, 真)
        赋值 (画板.图片, 图标类.取图标的图片 (计次))
    .计次循环尾 ()
    赋值 (窗口1., 相加 (“共有图标数量：”, 到文本 (图标类.取图标数量 ())))
.判断结束


.子程序 _按钮4_被单击, 空白型, , 

 ' .如果真 (打开 ())
     ' 图片框49.图片 ＝ 图标类.取文件的图标 (通用对话框1.文件名)
.如果真结束


.类模块 位图操作类, , , 

.程序集变量 颜色表_1位深, 字节集, , , 2色biBitCount=1
.程序集变量 颜色表_4位深, 字节集, , , 16色biBitCount=4
.程序集变量 颜色表_8位深, 字节集, , , 256色biBitCount=8
.程序集变量 m_pDIB, 字节集, , , 位图数据
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
初始化颜色表 ()

.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 初始化颜色表, 空白型, , 
赋值 (颜色表_1位深, {  })
赋值 (颜色表_1位深, 相加 (颜色表_1位深, { 0, 0, 0, 0 }))
赋值 (颜色表_1位深, 相加 (颜色表_1位深, { 255, 255, 255, 0 }))
赋值 (颜色表_4位深, {  })
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 0, 0, 0, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 0, 0, 128, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 0, 128, 0, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 0, 128, 128, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 128, 0, 0, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 128, 0, 128, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 128, 128, 0, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 128, 128, 128, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 192, 192, 192, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 0, 0, 255, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 0, 255, 0, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 0, 255, 255, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 255, 0, 0, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 255, 0, 255, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 255, 255, 0, 0 }))
赋值 (颜色表_4位深, 相加 (颜色表_4位深, { 255, 255, 255, 0 }))
赋值 (颜色表_8位深, {  })
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 0, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 0, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 128, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 128, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 0, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 0, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 128, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 192, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 220, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 240, 202, 166, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 32, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 32, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 32, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 32, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 32, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 32, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 64, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 64, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 64, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 64, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 64, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 64, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 64, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 64, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 96, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 96, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 96, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 96, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 96, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 96, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 96, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 96, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 128, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 128, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 128, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 128, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 128, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 128, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 128, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 128, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 160, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 160, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 160, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 160, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 160, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 160, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 160, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 160, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 192, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 192, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 192, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 192, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 192, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 192, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 192, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 192, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 224, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 224, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 224, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 224, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 224, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 224, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 224, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 224, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 0, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 0, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 0, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 0, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 0, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 0, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 0, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 0, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 32, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 32, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 32, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 32, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 32, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 32, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 32, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 32, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 64, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 64, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 64, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 64, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 64, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 64, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 64, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 64, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 96, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 96, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 96, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 96, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 96, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 96, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 96, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 96, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 128, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 128, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 128, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 128, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 128, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 128, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 128, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 128, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 160, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 160, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 160, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 160, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 160, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 160, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 160, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 160, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 192, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 192, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 192, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 192, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 192, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 192, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 192, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 192, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 224, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 224, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 224, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 224, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 224, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 224, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 224, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 64, 224, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 0, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 0, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 0, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 0, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 0, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 0, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 0, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 0, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 32, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 32, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 32, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 32, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 32, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 32, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 32, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 32, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 64, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 64, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 64, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 64, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 64, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 64, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 64, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 64, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 96, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 96, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 96, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 96, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 96, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 96, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 96, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 96, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 128, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 128, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 128, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 128, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 128, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 128, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 128, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 128, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 160, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 160, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 160, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 160, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 160, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 160, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 160, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 160, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 192, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 192, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 192, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 192, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 192, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 192, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 192, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 192, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 224, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 224, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 224, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 224, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 224, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 224, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 224, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 224, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 0, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 0, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 0, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 0, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 0, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 0, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 0, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 0, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 32, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 32, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 32, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 32, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 32, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 32, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 32, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 32, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 64, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 64, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 64, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 64, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 64, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 64, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 64, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 64, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 96, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 96, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 96, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 96, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 96, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 96, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 96, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 96, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 128, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 128, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 128, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 128, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 128, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 128, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 128, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 128, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 160, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 160, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 160, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 160, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 160, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 160, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 160, 192, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 160, 224, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 192, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 192, 32, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 192, 64, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 192, 96, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 192, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 192, 192, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 240, 251, 255, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 164, 160, 160, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 128, 128, 128, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 0, 255, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 255, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 0, 255, 255, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 255, 0, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 255, 0, 255, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 255, 255, 0, 0 }))
赋值 (颜色表_8位深, 相加 (颜色表_8位深, { 255, 255, 255, 0 }))


.子程序 CaptureDC, 逻辑型, 公开, 复制DC上的内容到DIB 即取得DC上的内容,比如抓屏
.参数 hSrcDC, 整数型, , DC
.参数 SrcRect, RECT, , 区域
.参数 nBitCount, 整数型, , 位深1、4、8、16、24、32

.局部变量 nSrcWidth, 整数型, , , 
.局部变量 nSrcHeithe, 整数型, , , 
.局部变量 hMemDC, 整数型, , , 
.局部变量 hDibSect, 整数型, , , 
.局部变量 hOldBitmap, 整数型, , , 
.局部变量 pSrcBits, 整数型, , , 
.局部变量 R, 整数型, , , 

 ' 判断位深是否符合要求
.如果真 (或者 (等于 (hSrcDC, 0), 并且 (不等于 (nBitCount, 1), 不等于 (nBitCount, 4), 不等于 (nBitCount, 8), 不等于 (nBitCount, 16), 不等于 (nBitCount, 24), 不等于 (nBitCount, 32))))
    返回 (假)
.如果真结束
赋值 (nSrcWidth, 相减 (SrcRect.Right, SrcRect.Left)) ' 算出位图宽度
赋值 (nSrcHeithe, 相减 (SrcRect.Bottom, SrcRect.Top)) ' 算出位图高度
 ' 确保该dib的大小,颜色位数符合要求
.如果真 (或者 (等于 (m_pDIB, {  }), 不等于 (GetBitCount (), nBitCount), 不等于 (GetWidth (), nSrcWidth), 不等于 (GetHeight (), nSrcHeithe)))
    赋值 (m_pDIB, {  })
    Create (nSrcWidth, nSrcHeithe, nBitCount, )
.如果真结束
 ' 创建DibSection并选进以MemDC
赋值 (hMemDC, CreateCompatibleDC (hSrcDC))
赋值 (pSrcBits, 0)
赋值 (hDibSect, CreateDIBSection (hSrcDC, m_pDIB, #DIB_RGB_COLORS, pSrcBits, 0, 0))
赋值 (hOldBitmap, SelectObject (hMemDC, hDibSect))
 ' 复制源dc内容到MemDC即到DibSection
BitBlt (hMemDC, 0, 0, nSrcWidth, nSrcHeithe, hSrcDC, SrcRect.Left, SrcRect.Top, #SRCCOPY)
GdiFlush ()
 ' 复制位图点阵数据到本DIB对象
memcpy (GetBitsAddress (), pSrcBits, GetBitsSize ())
 ' 删除相关句柄
赋值 (R, DeleteObject (SelectObject (hMemDC, hOldBitmap)))
 ' 本源码来自易语言资源网(www.5A5X.com)
赋值 (R, DeleteObject (hOldBitmap))
DeleteDC (hMemDC)
返回 (真)

.子程序 GetBitsAddress, 整数型, , 颜色点阵地址
.如果真 (等于 (m_pDIB, {  }))
    输出调试文本 (“颜色点阵地址失败”)
.如果真结束
返回 (相加 (lstrcpyn (m_pDIB, m_pDIB, 0), 40, GetColorTableSize ()))

.子程序 GetBitsSize, 整数型, , 颜色点阵大小
.局部变量 r, 空白型, , , 

.如果真 (等于 (m_pDIB, {  }))
    输出调试文本 (“取颜色点阵大小失败”)
.如果真结束
赋值 (r, BytesPerLine ())
返回 (相乘 (GetHeight (), BytesPerLine ()))


.子程序 BytesPerLine, 整数型, , 
.如果真 (等于 (m_pDIB, {  }))
    输出调试文本 (“BytesPerLine失败”)
.如果真结束
返回 (WIDTHBYTES (相乘 (取字节集数据 (取字节集中间 (m_pDIB, 5, 4), #整数型, ), 取字节集数据 (取字节集中间 (m_pDIB, 13, 2), #整数型, ), 取字节集数据 (取字节集中间 (m_pDIB, 15, 2), #整数型, ))))

.子程序 Create, 逻辑型, , 创建一幅指定大小的位图
.参数 iWidth, 整数型, , 宽度
.参数 iHeight, 整数型, , 高度
.参数 nBitCount, 整数型, , 位深
.参数 clrBk, 长整数型, 可空, 默认填充的颜色,4294967295

.局部变量 iColors, 整数型, , , 
.局部变量 iSize, 整数型, , , 
.局部变量 pBI, BITMAPINFOHEADER, , , 

.如果真 (等于 (是否为空 (clrBk), 真))
    赋值 (clrBk, 4294967295)
.如果真结束
.如果 (等于 (nBitCount, 1))
    赋值 (iColors, 2)
.否则
    .如果 (等于 (nBitCount, 4))
        赋值 (iColors, 16)
    .否则
        .如果 (等于 (nBitCount, 8))
            赋值 (iColors, 256)
        .否则
            .如果 (或者 (等于 (nBitCount, 16), 等于 (nBitCount, 24), 等于 (nBitCount, 32)))
                赋值 (iColors, 0)
            .否则
                输出调试文本 (“Bmp提供的位深有错误”)
                返回 (假)
            .如果结束
             ' 本源码来自易语言资源网(www.5A5X.com)
        .如果结束
        
    .如果结束
    
.如果结束
赋值 (iSize, 相加 (相乘 (iColors, 4), 相乘 (WIDTHBYTES (相乘 (iWidth, nBitCount)), iHeight)))
赋值 (m_pDIB, 取空白字节集 (iSize)) ' 分配空间
 ' 填写BMP文件头
赋值 (pBI.biSize, 40)
赋值 (pBI.biWidth, iWidth)
赋值 (pBI.biHeight, iHeight)
赋值 (pBI.biPlanes, 1)
赋值 (pBI.biBitCount, nBitCount)
赋值 (pBI.biCompression, #BI_RGB)
赋值 (pBI.biSizeImage, 0)
赋值 (pBI.biXPelsPerMeter, 0)
赋值 (pBI.biYPelsPerMeter, 0)
赋值 (pBI.biClrUsed, 0)
赋值 (pBI.biClrImportant, 0)
赋值 (m_pDIB, 相加 (BMP信息头转字节集 (pBI), m_pDIB))
 ' 初始化颜色表
.判断开始 (等于 (nBitCount, 1))
    memcpy (GetColorTableAddress (), lstrcpyn (颜色表_1位深, 颜色表_1位深, 0), GetColorTableSize ())
.判断 (等于 (nBitCount, 4))
    memcpy (GetColorTableAddress (), lstrcpyn (颜色表_4位深, 颜色表_4位深, 0), GetColorTableSize ())
.默认
    .如果真 (等于 (nBitCount, 8))
        memcpy (GetColorTableAddress (), lstrcpyn (颜色表_8位深, 颜色表_8位深, 0), GetColorTableSize ())
    .如果真结束
    
.判断结束
.如果真 (不等于 (clrBk, 4294967295))
    输出调试文本 (“自定义背景色”)
.如果真结束
返回 (真)

.子程序 SetPixelColor, 空白型, , 置某点颜色
.参数 x, 整数型, , 
.参数 y, 整数型, , 
.参数 clrNew, 整数型, , 



.子程序 GetBitmapInfoAddress, 整数型, , 取BITMAPINFO指针
返回 (lstrcpyn (m_pDIB, m_pDIB, 0))

.子程序 GetWidth, 整数型, , 取图片宽度
.如果真 (等于 (m_pDIB, {  }))
    输出调试文本 (“取宽时出错”)
.如果真结束
返回 (到整数 (取字节集中间 (m_pDIB, 5, 4)))

.子程序 GetHeight, 整数型, , 取图片高度
.如果真 (等于 (m_pDIB, {  }))
    输出调试文本 (“取高时出错”)
.如果真结束
返回 (取字节集数据 (取字节集中间 (m_pDIB, 9, 4), #整数型, ))


.子程序 WIDTHBYTES, 整数型, , 保图像的扫描行DWORD对齐
.参数 bits, 整数型, , 

赋值 (bits, 相加 (bits, 31))
返回 (左移 (右移 (bits, 5), 2))

.子程序 GetColorTableAddress, 整数型, , 取颜色表指针,成功返回内存指针,失败返回0
.如果真 (等于 (m_pDIB, {  }))
    输出调试文本 (“取颜色表地址时出错”)
.如果真结束
.如果真 (大于或等于 (GetBitCount (), 16)) ' 大于256色的位图不使用颜色表
    CNoColorTable ()
     ' 本源码来自易语言资源网(www.5A5X.com)
    返回 (0)
.如果真结束
返回 (相加 (lstrcpyn (m_pDIB, m_pDIB, 0), 40))

.子程序 GetBitCount, 整数型, , 取位图颜色位数
.如果真 (等于 (m_pDIB, {  }))
    输出调试文本 (“取位图颜色位数出错”)
.如果真结束
返回 (到整数 (到短整数 (取字节集中间 (m_pDIB, 15, 2))))

.子程序 BMP文件头转字节集, 字节集, , 
.参数 欲转成字节集的信息, BITMAPFILEHEADER, , 

.局部变量 返回值, 字节集, , , 

赋值 (返回值, 到字节集 (欲转成字节集的信息.bfType))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.bfSize)))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.bfReserved1)))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.bfReserved2)))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.bfOffBits)))
返回 (返回值)

.子程序 BMP信息头转字节集, 字节集, , 
.参数 欲转成字节集的信息, BITMAPINFOHEADER, , 

.局部变量 返回值, 字节集, , , 

赋值 (返回值, 到字节集 (欲转成字节集的信息.biSize))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.biWidth)))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.biHeight)))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.biPlanes)))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.biBitCount)))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.biCompression)))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.biSizeImage)))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.biXPelsPerMeter)))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.biYPelsPerMeter)))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.biClrUsed)))
赋值 (返回值, 相加 (返回值, 到字节集 (欲转成字节集的信息.biClrImportant)))
返回 (返回值)

.子程序 CNoColorTable, 空白型, , 当前位图格式不使用颜色表
输出调试文本 (“当前位图格式不使用颜色表”)

.子程序 GetColorTableSize, 整数型, , 取颜色表大小
.如果真 (等于 (m_pDIB, {  }))
    输出调试文本 (“取位图颜色位数出错”)
.如果真结束
返回 (相乘 (NumDIBColorEntries (取字节集左边 (m_pDIB, 40)), 4))

.子程序 NumDIBColorEntries, 整数型, , 取颜色表数组颜色个数
.参数 pBmpInfo, 字节集, , 

.局部变量 iBitCount, 短整数型, , , 

赋值 (iBitCount, 取字节集数据 (取字节集中间 (pBmpInfo, 15, 2), #短整数型, ))
.判断开始 (等于 (iBitCount, 1))
    返回 (2)
.判断 (等于 (iBitCount, 4))
    返回 (16)
.判断 (等于 (iBitCount, 8))
    返回 (256)
.默认
    .如果真 (或者 (等于 (iBitCount, 16), 等于 (iBitCount, 24), 等于 (iBitCount, 32)))
        返回 (0)
    .如果真结束
     ' 本源码来自易语言资源网(www.5A5X.com)
.判断结束
返回 (-1)

.子程序 Write, 字节集, 公开, 给位图数据加上位图文件头,返回位图文件数据(写到文件后就是.BMP图片)
返回 (相加 (到字节集 (到短整数 (19778)), 到字节集 (到整数 (相加 (取字节集长度 (m_pDIB), 54))), { 0, 0 }, { 0, 0 }, 到字节集 (到整数 (相加 (54, GetColorTableSize ()))), m_pDIB))



 ' 不属于任何一个程序集、类模块的函数：
