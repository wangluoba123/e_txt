 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 606
    高度 = 586
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' EXMLParser BE2297B7415349c8A55BC9DFEB6DD11A 1 5 XML解析支持库





.窗口程序集 窗口程序集1, , , 

.程序集变量 obj_xml, 未知类型0x20001, , , 
.子程序 _按钮_创建XML_被单击, 空白型, , 
.局部变量 文本数组, 文本型, , "0", 
.局部变量 循环变量, 整数型, , , 

.如果 (obj_xml.未知支持库函数_0 (“易XML文件”))
    赋值 (.内容, “”)
    obj_xml.未知支持库函数_2 (相加 (取运行目录 (), “\Eexc.xml”), )
    赋值 (文本数组, 分割文本 (读入文本 (打开文件 (相加 (取运行目录 (), “\Eexc.xml”), , ), ), “<”, ))
    .计次循环首 (取数组成员数 (文本数组), 循环变量)
        赋值 (.内容, 相加 (.内容, “< ”, 文本数组 [循环变量], #换行符))
    .计次循环尾 ()
    赋值 (.内容, 取文本右边 (.内容, 相减 (取文本长度 (.内容), 1)))
.否则
    信息框 (“XML文件创建失败”, 0, )
.如果结束


.子程序 _按钮_释放XML树_被单击, 空白型, , 
obj_xml.未知支持库函数_3 ()


.子程序 _按钮_导入_被单击, 空白型, , 
.局部变量 文本数组, 文本型, , "0", 
.局部变量 循环变量, 整数型, , , 

.如果真 (打开 ())
    赋值 (.内容, “”)
    obj_xml.未知支持库函数_1 (.文件名)
    赋值 (文本数组, 分割文本 (读入文本 (打开文件 (.文件名, , ), ), “<”, ))
    .计次循环首 (取数组成员数 (), )
        赋值 (.内容, 相加 (.内容, “< ”,  [#换行符]))
    .计次循环尾 ()
    赋值 (.内容, 取文本右边 (.内容, 相减 (取文本长度 (.内容), 1)))
    
.如果真结束


.子程序 _按钮_插入节点_被单击, 空白型, , 
.局部变量 文本数组, 文本型, , "0", 
.局部变量 循环变量, 整数型, , , 

.如果 (obj_xml.未知支持库函数_11 (“@1/”, “第一层子节点”, “考虑如何添加多层子节点”))
    赋值 (.内容, “”)
    obj_xml.未知支持库函数_2 (相加 (取运行目录 (), “\Eexc.xml”), )
    赋值 (文本数组, 分割文本 (读入文本 (打开文件 (相加 (取运行目录 (), “\Eexc.xml”), , ), ), “<”, ))
    .计次循环首 (取数组成员数 (), )
        赋值 (.内容, 相加 (.内容, “< ”,  [#换行符]))
    .计次循环尾 ()
    赋值 (.内容, 取文本右边 (.内容, 相减 (取文本长度 (.内容), 1)))
.否则
    信息框 (“增加子节点失败”, 0, )
.如果结束


.子程序 _按钮_插入属性_被单击, 空白型, , 
.局部变量 文本数组, 文本型, , "0", 
.局部变量 循环变量, 整数型, , , 

.如果 (obj_xml.未知支持库函数_12 (“@1/@1”, “备注”, “演示”))
    赋值 (.内容, “”)
    obj_xml.未知支持库函数_2 (相加 (取运行目录 (), “\Eexc.xml”), )
    赋值 (分割文本 (读入文本 (打开文件 (相加 (取运行目录 (), “\Eexc.xml”), , ), ), “<”, ))
    .计次循环首 (取数组成员数 (), )
        赋值 (.内容, 相加 (.内容, “< ”,  [#换行符]))
    .计次循环尾 ()
    赋值 (.内容, 取文本右边 (.内容, 相减 (取文本长度 (.内容), 1)))
.否则
    信息框 (“增加子节点属性失败”, 0, )
.如果结束


.子程序 _按钮_修改节点名_被单击, 空白型, , 
.局部变量 文本数组, 文本型, , "0", 
.局部变量 循环变量, 整数型, , , 

.如果 (obj_xml.未知支持库函数_15 (“@1/@1”, “节点一”))
    赋值 (.内容, “”)
    obj_xml.未知支持库函数_2 (相加 (取运行目录 (), “\Eexc.xml”), )
    赋值 (分割文本 (读入文本 (打开文件 (相加 (取运行目录 (), “\Eexc.xml”), , ), ), “<”, ))
    .计次循环首 (取数组成员数 (), )
        赋值 (.内容, 相加 (.内容, “< ”,  [#换行符]))
    .计次循环尾 ()
    赋值 (.内容, 取文本右边 (.内容, 相减 (取文本长度 (.内容), 1)))
.否则
    信息框 (“修改子节点名称失败”, 0, )
.如果结束


.子程序 _按钮_修改节点值_被单击, 空白型, , 
.局部变量 文本数组, 文本型, , "0", 
.局部变量 循环变量, 整数型, , , 

.如果 (obj_xml.未知支持库函数_16 (“@1/@1”, “姓名”))
    赋值 (.内容, “”)
    相加 (取运行目录 (), “\Eexc.xml”).未知支持库函数_2 ()
    赋值 (分割文本 (读入文本 (打开文件 (相加 (取运行目录 (), “\Eexc.xml”), , ), ), “<”, ))
    .计次循环首 (取数组成员数 (), )
        赋值 (.内容, 相加 (.内容, “< ”,  [#换行符]))
    .计次循环尾 ()
    赋值 (.内容, 取文本右边 (.内容, 相减 (取文本长度 (.内容), 1)))
.否则
    信息框 (“修改子节点值失败”, 0, )
.如果结束


.子程序 _按钮_删除属性_被单击, 空白型, , 
.局部变量 文本数组, 文本型, , "0", 
.局部变量 循环变量, 整数型, , , 

.如果 (obj_xml.未知支持库函数_14 (“@1/@1”, “用户属性”))
    赋值 (.内容, “”)
    obj_xml.未知支持库函数_2 (相加 (取运行目录 (), “\Eexc_delete.xml”), )
    赋值 (文本数组, 分割文本 (读入文本 (打开文件 (相加 (取运行目录 (), “\Eexc_delete.xml”), , ), ), “<”, ))
    .计次循环首 (取数组成员数 (), )
        赋值 (.内容, 相加 (.内容, “< ”,  [#换行符]))
    .计次循环尾 ()
    赋值 (.内容, 取文本右边 (.内容, 相减 (取文本长度 (.内容), 1)))
.否则
    信息框 (“删除属性失败”, 0, )
.如果结束


.子程序 _按钮_删除节点_被单击, 空白型, , 
.局部变量 文本数组, 文本型, , "0", 
.局部变量 循环变量, 整数型, , , 

.如果 (obj_xml.未知支持库函数_13 (“@1/@1”))
    赋值 (.内容, “”)
    obj_xml.未知支持库函数_2 (相加 (取运行目录 (), “\Eexc_delete.xml”), )
    赋值 (文本数组, 分割文本 (读入文本 (打开文件 (相加 (取运行目录 (), “\Eexc_delete.xml”), , ), ), “<”, ))
    .计次循环首 (取数组成员数 (), )
        赋值 (.内容, 相加 (.内容, “< ”,  [#换行符]))
    .计次循环尾 ()
    赋值 (.内容, 取文本右边 (.内容, 相减 (取文本长度 (.内容), 1)))
.否则
    信息框 (“删除节点失败”, 0, )
.如果结束



.子程序 _按钮_取根节点名_被单击, 空白型, , 
.局部变量 根节点名称, 文本型, , , 

.如果 (obj_xml.未知支持库函数_4 (根节点名称))
    根节点名称.加入项目 (1)
.否则
    信息框 (“没有指定的根节点”, 0, )
.如果结束


.子程序 _按钮_取所有子节点名_被单击, 空白型, , 
.局部变量 执行结果, 文本型, , "0", 
.局部变量 循环变量, 整数型, , , 

清空 ()
赋值 (执行结果, obj_xml.未知支持库函数_32 (“@1”, ))
.计次循环首 (取数组成员数 (执行结果), 循环变量)
    执行结果.加入项目 ( [循环变量], 循环变量)
.计次循环尾 ()

.子程序 _按钮_取子节点个数_被单击, 空白型, , 
信息框 (obj_xml.未知支持库函数_31 (“@1/”, ), 0, )


.子程序 _按钮_取子节点数_被单击, 空白型, , 
.局部变量 子节点数, 整数型, , , 

.如果 (obj_xml.未知支持库函数_5 (“@1”, 子节点数))
    信息框 (子节点数, 0, )
.否则
    信息框 (“取子节点数失败”, 0, )
.如果结束


.子程序 _按钮_取子节点名_被单击, 空白型, , 
.局部变量 执行结果, 文本型, , "0", 
.局部变量 循环变量, 整数型, , , 

.如果 (obj_xml.未知支持库函数_6 (“@1”, 执行结果))
    .计次循环首 (取数组成员数 (执行结果), 循环变量)
        执行结果.加入项目 ( [循环变量], 循环变量)
    .计次循环尾 ()
.否则
    信息框 (“没有找到指定节点名”, 0, “取子节点名”)
.如果结束


.子程序 _按钮_取节点值_被单击, 空白型, , 
.局部变量 节点值, 文本型, , , 

.如果 (obj_xml.未知支持库函数_7 (“@1/@1”, 节点值))
    信息框 (节点值, 0, “取节点值方法”)
.否则
    信息框 (“没有找到指定节点”, 0, “取节点值方法”)
.如果结束


.子程序 _按钮_取全部属性名_被单击, 空白型, , 
.局部变量 属性名集合, 文本型, , "0", 
.局部变量 循环变量, 整数型, , , 
.局部变量 信息框显示, 文本型, , , 

.如果 (obj_xml.未知支持库函数_9 (“@1/@1”, 属性名集合))
    .计次循环首 (取数组成员数 (属性名集合), 循环变量)
        赋值 (信息框显示, 相加 (属性名集合 [循环变量], “/”, 信息框显示))
    .计次循环尾 ()
    信息框 (信息框显示, 0, “取全部属性名”)
.否则
    信息框 (“没有指定的”, 0, “取全部属性名”)
.如果结束


.子程序 _按钮_取属性值_被单击, 空白型, , 
.局部变量 指定节点属性值, 文本型, , , 

.如果 (obj_xml.未知支持库函数_10 (“@1/@1”, “用户属性”, 指定节点属性值))
    信息框 (指定节点属性值, 0, “取属性值”)
.否则
    信息框 (“取属性值”, 0, “取属性值”)
.如果结束


.子程序 _按钮_批量删除节点_被单击, 空白型, , 
.局部变量 文本数组, 文本型, , "0", 
.局部变量 循环变量, 整数型, , , 

.如果 (obj_xml.未知支持库函数_20 (“@1/*”))
    赋值 (.内容, “”)
    obj_xml.未知支持库函数_2 (相加 (取运行目录 (), “\Eexc_delete_p.xml”), )
    赋值 (文本数组, 分割文本 (读入文本 (打开文件 (相加 (取运行目录 (), “\Eexc_delete_p.xml”), , ), ), “<”, ))
    .计次循环首 (取数组成员数 (), )
        赋值 (.内容, 相加 (.内容, “< ”,  [#换行符]))
    .计次循环尾 ()
    赋值 (.内容, 取文本右边 (.内容, 相减 (取文本长度 (.内容), 1)))
.否则
    信息框 (2, 0, )
.如果结束


.子程序 _按钮_批量取节点值_被单击, 空白型, , 
.局部变量 节点值集合, 文本型, , "0", 
.局部变量 循环变量, 整数型, , , 

.如果 (obj_xml.未知支持库函数_21 (“@1/*”, 节点值集合))
    .计次循环首 (取数组成员数 (节点值集合), 循环变量)
        节点值集合.加入项目 ( [循环变量], 循环变量)
    .计次循环尾 ()
.否则
    信息框 (“批量取节点值失败”, 0, “批量取节点值”)
.如果结束


.子程序 _按钮_批量修改节点值_被单击, 空白型, , 
.局部变量 文本数组, 文本型, , "0", 
.局部变量 循环变量, 整数型, , , 

.如果 (obj_xml.未知支持库函数_22 (“@1/*”, “批量修改节点值”))
    赋值 (.内容, “”)
    obj_xml.未知支持库函数_2 (相加 (取运行目录 (), “\Eexc_delete_p.xml”), )
    赋值 (文本数组, 分割文本 (读入文本 (打开文件 (相加 (取运行目录 (), “\Eexc_delete_p.xml”), , ), ), “<”, ))
    .计次循环首 (取数组成员数 (), )
        赋值 (.内容, 相加 (.内容, “< ”,  [#换行符]))
    .计次循环尾 ()
    赋值 (.内容, 取文本右边 (.内容, 相减 (取文本长度 (.内容), 1)))
.否则
    信息框 (“增加子节点失败”, 0, )
.如果结束



 ' 不属于任何一个程序集、类模块的函数：
