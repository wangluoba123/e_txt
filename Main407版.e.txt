 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 429
    高度 = 239
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15391439 '  0xEADACF
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 3
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “青岛啤酒(寿光)有限公司业务开票管理系统V1.0”
    帮助文件名 = “”

窗口 片区管理
    左边 = 50
    顶边 = 50
    宽度 = 766
    高度 = 544
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “片区、办事处、购货单位管理”
    帮助文件名 = “”

窗口 单位管理
    左边 = 50
    顶边 = 50
    宽度 = 766
    高度 = 604
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “购货单位详细资料管理”
    帮助文件名 = “”

窗口 单据录入
    左边 = 50
    顶边 = 50
    宽度 = 757
    高度 = 539
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “单据录入”
    帮助文件名 = “”

窗口 单位修改
    左边 = 50
    顶边 = 50
    宽度 = 483
    高度 = 196
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “修改单位信息”
    帮助文件名 = “”

窗口 数据备份
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 397
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “数据备份”
    帮助文件名 = “”

窗口 数据恢复
    左边 = 50
    顶边 = 50
    宽度 = 405
    高度 = 395
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “数据恢复”
    帮助文件名 = “”

窗口 促销品管理
    左边 = 50
    顶边 = 50
    宽度 = 455
    高度 = 418
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “促销品管理”
    帮助文件名 = “”

窗口 身份验证
    左边 = 50
    顶边 = 50
    宽度 = 381
    高度 = 477
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\Main407版.e\身份验证_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “身份验证”
    帮助文件名 = “”

窗口 系统日志
    左边 = 50
    顶边 = 50
    宽度 = 576
    高度 = 487
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “系统日志”
    帮助文件名 = “”

窗口 密码设定
    左边 = 50
    顶边 = 50
    宽度 = 285
    高度 = 263
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “用户密码”
    帮助文件名 = “”

窗口 自动备份
    左边 = 50
    顶边 = 50
    宽度 = 330
    高度 = 69
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “系统数据备份”
    帮助文件名 = “”

窗口 系统公告
    左边 = 50
    顶边 = 50
    宽度 = 201
    高度 = 502
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “公告”
    帮助文件名 = “”

窗口 销售日报表
    左边 = 50
    顶边 = 50
    宽度 = 466
    高度 = 514
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “销售日报表”
    帮助文件名 = “”

窗口 运输单位
    左边 = 50
    顶边 = 50
    宽度 = 509
    高度 = 392
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “运输单位管理”
    帮助文件名 = “”

窗口 购货品种
    左边 = 50
    顶边 = 50
    宽度 = 516
    高度 = 253
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “请选择产品”
    帮助文件名 = “”

窗口 业务员管理
    左边 = 50
    顶边 = 50
    宽度 = 529
    高度 = 408
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “业务员管理”
    帮助文件名 = “”

窗口 选择单位
    左边 = 50
    顶边 = 50
    宽度 = 575
    高度 = 326
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “请选择购货单位”
    帮助文件名 = “”

窗口 单据查询
    左边 = 50
    顶边 = 50
    宽度 = 897
    高度 = 579
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “单据查询”
    帮助文件名 = “”

窗口 产品管理
    左边 = 50
    顶边 = 50
    宽度 = 573
    高度 = 450
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “产品信息管理”
    帮助文件名 = “”

窗口 选择产品
    左边 = 50
    顶边 = 50
    宽度 = 447
    高度 = 399
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “选择产品”
    帮助文件名 = “”

窗口 生产处日报表
    左边 = 50
    顶边 = 50
    宽度 = 694
    高度 = 189
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “生产处日报表”
    帮助文件名 = “”

窗口 单客户品种销量统计表
    左边 = 50
    顶边 = 50
    宽度 = 419
    高度 = 459
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “单客户品种销量统计表”
    帮助文件名 = “”

窗口 办事处品种销量统计表
    左边 = 50
    顶边 = 50
    宽度 = 404
    高度 = 499
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “办事处品种销量统计表”
    帮助文件名 = “”

窗口 销售公司品种销量统计表
    左边 = 50
    顶边 = 50
    宽度 = 373
    高度 = 431
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “销售公司品种销量统计表”
    帮助文件名 = “”

窗口 选择客户
    左边 = 50
    顶边 = 50
    宽度 = 351
    高度 = 326
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “请选择客户”
    帮助文件名 = “”

窗口 业务员品种销量统计表
    左边 = 50
    顶边 = 50
    宽度 = 404
    高度 = 499
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “业务员品种销量统计表”
    帮助文件名 = “”

窗口 系统设置
    左边 = 50
    顶边 = 50
    宽度 = 388
    高度 = 176
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “系统设置”
    帮助文件名 = “”

窗口 关于
    左边 = 50
    顶边 = 50
    宽度 = 350
    高度 = 200
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “请用鼠标右键或ESC键关闭本窗口”
    帮助文件名 = “”

窗口 外挂配置
    左边 = 50
    顶边 = 50
    宽度 = 502
    高度 = 269
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “外挂配置”
    帮助文件名 = “”

窗口 分公司分类销量统计
    左边 = 50
    顶边 = 50
    宽度 = 431
    高度 = 381
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “分公司分类销量统计”
    帮助文件名 = “”

窗口 分公司品种销量统计表
    左边 = 50
    顶边 = 50
    宽度 = 404
    高度 = 499
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “分公司品种销量统计表”
    帮助文件名 = “”

窗口 月份配置
    左边 = 50
    顶边 = 50
    宽度 = 415
    高度 = 491
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “月份配置”
    帮助文件名 = “”

窗口 选择业务员
    左边 = 50
    顶边 = 50
    宽度 = 365
    高度 = 335
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “选择业务员”
    帮助文件名 = “”

窗口 单据清理1
    左边 = 50
    顶边 = 50
    宽度 = 541
    高度 = 408
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “业务编码清理”
    帮助文件名 = “”



.图片 单位资料库, " ' 已保存到：D:\易语言学习\Data\Main407版.e\单位资料库", , 
.图片 用户密码库, " ' 已保存到：D:\易语言学习\Data\Main407版.e\用户密码库", , 
.图片 皮肤文件, " ' 已保存到：D:\易语言学习\Data\Main407版.e\皮肤文件", , 
.图片 销售日报表, " ' 已保存到：D:\易语言学习\Data\Main407版.e\销售日报表", , 
.图片 pq_ldb, " ' 已保存到：D:\易语言学习\Data\Main407版.e\pq_ldb", , 
.图片 index_ldb, " ' 已保存到：D:\易语言学习\Data\Main407版.e\index_ldb", , 
.图片 cx_ldb, " ' 已保存到：D:\易语言学习\Data\Main407版.e\cx_ldb", , 
.图片 save_ldb, " ' 已保存到：D:\易语言学习\Data\Main407版.e\save_ldb", , 
.图片 bz_ldb, " ' 已保存到：D:\易语言学习\Data\Main407版.e\bz_ldb", , 
.图片 bz_edt, " ' 已保存到：D:\易语言学习\Data\Main407版.e\bz_edt", , 
.图片 品种销量, " ' 已保存到：D:\易语言学习\Data\Main407版.e\品种销量", , 
.图片 main, " ' 已保存到：D:\易语言学习\Data\Main407版.e\main", , 
.图片 编辑数据库, " ' 已保存到：D:\易语言学习\Data\Main407版.e\编辑数据库", , 
.图片 编辑数据库1, " ' 已保存到：D:\易语言学习\Data\Main407版.e\编辑数据库1", , 
.图片 水波纹图片, " ' 已保存到：D:\易语言学习\Data\Main407版.e\水波纹图片", , 
.图片 分公司销量, " ' 已保存到：D:\易语言学习\Data\Main407版.e\分公司销量", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' eCompress 7B68736E818E41c5A28B0AE4D43C128C 1 0 压缩解压支持库
 ' xwx CBF69520-5300-43C4-B6D6-C2CF3F2A169B 1 0 xwxyh无限扩展库
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' Tooltiplib DA19AC3ADD2F4121AAD84AC5FBCAFC71 1 1 提示工具支持库



 ' 所需要的模块
 ' 存在性检测 F:\易语言专题\模块\非DLL模块\检测程序是否重复运行\Exist.ec
 ' 转换数据源数据 F:\易语言专题\模块\非DLL模块\数据源数据转换.ec
 ' 水波纹 F:\易语言专题\模块\dll模块\水波纹(DLL)\水波纹.ec


.全局变量 当前目录, 文本型, , , 
.全局变量 当前用户, 文本型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 是否通过验证, 逻辑型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 qqq, 文本型, , , 

.如果 (等于 (存在性检测 (“业务开票管理系统”), 1))
    信息框 (相加 (“本系统已经运行，不能再同时运行第二次！”, #换行符, “请检查是否在系统托盘中，或被最小化！”), 0, )
    结束 ()
.否则
    
.如果结束
赋值 (当前目录, 取运行目录 ())
.如果 (不等于 (取文本右边 (当前目录, 1), “\”))
    赋值 (当前目录, 相加 (当前目录, “\”))
.否则
    
.如果结束
赋值 (.标题, 读配置项 (相加 (当前目录, “config.ini”), “外挂1”, “标题”, “”))
赋值 (.标题, 读配置项 (相加 (当前目录, “config.ini”), “外挂2”, “标题”, “”))
赋值 (.标题, 读配置项 (相加 (当前目录, “config.ini”), “外挂3”, “标题”, “”))
赋值 (.标题, 读配置项 (相加 (当前目录, “config.ini”), “外挂4”, “标题”, “”))
赋值 (.标题, 读配置项 (相加 (当前目录, “config.ini”), “外挂5”, “标题”, “”))
.如果 (等于 (.标题, “”))
    赋值 (.可视, 假)
.否则
    赋值 (.可视, 真)
.如果结束
.如果 (等于 (.标题, “”))
    赋值 (.可视, 假)
.否则
    赋值 (.可视, 真)
.如果结束
.如果 (等于 (.标题, “”))
    赋值 (.可视, 假)
.否则
    赋值 (.可视, 真)
.如果结束
.如果 (等于 (.标题, “”))
    赋值 (.可视, 假)
.否则
    赋值 (.可视, 真)
.如果结束
.如果 (等于 (.标题, “”))
    赋值 (.可视, 假)
.否则
    赋值 (.可视, 真)
.如果结束
写到文件 (相加 (未知支持库函数_7 (11), “0.skn”), #皮肤文件)
改变目录 (未知支持库函数_7 (11))
未知支持库函数_5 (0)
改变目录 (当前目录)
赋值 (是否通过验证, 假)
载入 (身份验证, , 真)
.如果 (等于 (是否通过验证, 假))
    结束 ()
.否则
    
.如果结束
.如果 (等于 (取文本注册项 (3, “光庆软件系列\青啤打账\启动保存”, “假”), “真”))
    载入 (自动备份, , 真)
.否则
    
.如果结束
.如果 (等于 (当前用户, “管理员”))
    赋值 (.可视, 真)
    赋值 (.可视, 真)
.否则
    赋值 (.可视, 假)
    赋值 (.可视, 假)
.如果结束
赋值 (qqq, 取文本注册项 (3, “dysz\sjk”, “真”))
.如果 (等于 (qqq, “真”))
    赋值 (.可视, 真)
    赋值 (.时钟周期, 1000)
.否则
    赋值 (.可视, 假)
    赋值 (.时钟周期, 0)
.如果结束
置托盘图标 (#main, “业务开票管理系统”)

.子程序 合并相同内容单元格, 空白型, , 
.参数 数据源名称, 数据源, , 
.参数 数据源行号, 整数型, , 
.参数 数据源列号, 整数型, , 

.局部变量 合并行数, 整数型, , , 

.如果 (等于 (数据源名称.取文本 (数据源行号, 数据源列号), 数据源名称.取文本 (相减 (数据源行号, 1), 数据源列号)))
    赋值 (合并行数, 1)
    .判断循环首 (等于 (数据源名称.是否被合并 (相减 (数据源行号, 合并行数), 数据源列号, 2), 真))
        赋值 (合并行数, 相加 (合并行数, 1))
    .判断循环尾 ()
    数据源名称.合并 (相减 (数据源行号, 合并行数), 数据源列号, 相加 (合并行数, 1), 1)
.否则
    
.如果结束


.子程序 _片区单位管理_被选择, 空白型, , 
载入 (片区管理, , 真)

.子程序 _单位信息管理_被选择, 空白型, , 
载入 (单位管理, , 真)

.子程序 _数据备份_被选择, 空白型, , 
载入 (数据备份, , 真)

.子程序 _数据恢复_被选择, 空白型, , 
载入 (数据恢复, , 真)

.子程序 _退出系统_被选择, 空白型, , 
.如果 (等于 (取文本注册项 (3, “光庆软件系列\青啤打账\关闭保存”, “假”), “真”))
    载入 (自动备份, , 真)
.否则
    
.如果结束
写日志 (相加 (到文本 (取现行时间 ()), “//关闭本系统!”))
置托盘图标 ()
结束 ()

.子程序 _促销品管理_被选择, 空白型, , 
载入 (促销品管理, , 真)

.子程序 _单据录入_被选择, 空白型, , 
载入 (单据录入, , 真)

.子程序 _系统日志_被选择, 空白型, , 
载入 (系统日志, , 真)

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
.如果 (等于 (_启动窗口., 真))
    赋值 (_启动窗口., 假)
    返回 (假)
.否则
    .如果 (等于 (取文本注册项 (3, “光庆软件系列\青啤打账\关闭保存”, “假”), “真”))
        载入 (自动备份, , 真)
    .否则
        
    .如果结束
    写日志 (相加 (到文本 (取现行时间 ()), “//关闭本系统!”))
.如果结束


.子程序 _用户密码_被选择, 空白型, , 
载入 (密码设定, , 真)

.子程序 _系统公告_被选择, 空白型, , 
载入 (系统公告, , 真)

.子程序 _销售日报表_被选择, 空白型, , 
载入 (销售日报表, , 真)

.子程序 __启动窗口_尺寸被改变, 空白型, , 
赋值 (.左边, -2)
赋值 (.宽度, 相加 (_启动窗口., 4))
赋值 (.高度, 相除 (相乘 (.宽度, 227), 800))
赋值 (.顶边, 相减 (相除 (相减 (_启动窗口., .高度), 2), 40))
相减 (_启动窗口., .宽度, 20).移动 (相加 (.顶边, .高度, 10), , )
相减 (_启动窗口., .宽度, 23).移动 (相加 (.顶边, .高度), , )
10.移动 (相减 (.顶边, .高度, 5), , )

.子程序 _运输单位管理_被选择, 空白型, , 
载入 (运输单位, , 真)

.子程序 _业务员管理_被选择, 空白型, , 
载入 (业务员管理, , 真)

.子程序 _单据查询_被选择, 空白型, , 
载入 (单据查询, , 真)

.子程序 _产品信息管理_被选择, 空白型, , 
载入 (产品管理, , 真)

.子程序 _打印左边距调节_被选择, 空白型, , 
.局部变量 qqq, 文本型, , , 
.局部变量 www, 文本型, , , 

赋值 (qqq, 取文本注册项 (3, “dysz\zbj”, “0”))
.如果 (等于 (输入框 (相加 (“系统当前的单据打印左边距数值为：”, qqq, “，请输入新的数值：”, #换行符, “（单位：0.1毫米）”), “输入新数值：”, qqq, www, 2), 真))
    .如果 (不等于 (www, “”))
        写注册项 (3, “dysz\zbj”, www)
    .否则
        
    .如果结束
    
.否则
    
.如果结束


.子程序 _打印上边距调节_被选择, 空白型, , 
.局部变量 qqq, 文本型, , , 
.局部变量 www, 文本型, , , 

赋值 (qqq, 取文本注册项 (3, “dysz\sbj”, “0”))
.如果 (等于 (输入框 (相加 (“系统当前的单据打印上边距数值为：”, qqq, “，请输入新的数值：”, #换行符, “（单位：0.1毫米）”), “输入新数值：”, qqq, www, 2), 真))
    .如果 (不等于 (www, “”))
        写注册项 (3, “dysz\sbj”, www)
    .否则
        
    .如果结束
    
.否则
    
.如果结束


.子程序 _生产处日报表_被选择, 空白型, , 
载入 (生产处日报表, , 真)

.子程序 __启动窗口_托盘事件, 空白型, , 
.参数 操作类型, 整数型, , 

.如果 (等于 (操作类型, 3))
    弹出托盘菜单 ()
.否则
    .如果 (等于 (操作类型, 1))
        弹出托盘菜单 ()
    .否则
        
    .如果结束
    
.如果结束


.子程序 _单客户品种销量统计表_被选择, 空白型, , 
载入 (单客户品种销量统计表, , 真)

.子程序 _单办事处品种销量统计表_被选择, 空白型, , 
载入 (办事处品种销量统计表, , 真)

.子程序 _销售公司品种销量统计表_被选择, 空白型, , 
载入 (销售公司品种销量统计表, , 真)

.子程序 _时钟1_周期事件, 空白型, , 
赋值 (.内容, 相加 (“当前时间：”, 到文本 (取现行时间 ())))

.子程序 _单业务员品种销量统计表_被选择, 空白型, , 
载入 (业务员品种销量统计表, , 真)

.子程序 _数据编辑_被选择, 空白型, , 
写到文件 (相加 (未知支持库函数_7 (11), “\edit.exe”), #编辑数据库)
写到文件 (相加 (未知支持库函数_7 (11), “\krnln.fnr”), #编辑数据库1)
运行 (相加 (未知支持库函数_7 (11), “\edit.exe”), 真, )

.子程序 _还原窗口_被选择, 空白型, , 
赋值 (_启动窗口., 真)

.子程序 _退出程序_被选择, 空白型, , 
置托盘图标 ()
.如果 (等于 (取文本注册项 (3, “光庆软件系列\青啤打账\关闭保存”, “假”), “真”))
    载入 (自动备份, , 真)
.否则
    
.如果结束
写日志 (相加 (到文本 (取现行时间 ()), “//关闭本系统!”))
结束 ()

.子程序 _单据录入1_被选择, 空白型, , 
载入 (单据录入, , 真)

.子程序 _辅助功能_被选择, 空白型, , 
载入 (系统设置, , 真)

.子程序 _关于_被选择, 空白型, , 
载入 (关于, , 真)

.子程序 _关于窗口_被选择, 空白型, , 
载入 (关于, , 真)

.子程序 _外挂配置_被选择, 空白型, , 
载入 (外挂配置, , 真)

.子程序 _外挂1_被选择, 空白型, , 
运行 (读配置项 (相加 (当前目录, “config.ini”), “外挂1”, “程序”, “”), 假, )

.子程序 _外挂2_被选择, 空白型, , 
运行 (读配置项 (相加 (当前目录, “config.ini”), “外挂2”, “程序”, “”), 假, )

.子程序 _外挂3_被选择, 空白型, , 
运行 (读配置项 (相加 (当前目录, “config.ini”), “外挂3”, “程序”, “”), 假, )

.子程序 _外挂4_被选择, 空白型, , 
运行 (读配置项 (相加 (当前目录, “config.ini”), “外挂4”, “程序”, “”), 假, )

.子程序 _外挂5_被选择, 空白型, , 
运行 (读配置项 (相加 (当前目录, “config.ini”), “外挂5”, “程序”, “”), 假, )

.子程序 _各分公司分类销量统计表_被选择, 空白型, , 
载入 (分公司分类销量统计, , 真)

.子程序 _重新登陆_被选择, 空白型, , 
运行 (相加 (取运行目录 (), “\”, 取执行文件名 ()), 假, )
结束 ()

.子程序 _单分公司品种销量统计表_被选择, 空白型, , 
载入 (分公司品种销量统计表, , 真)

.子程序 _月份配置_被选择, 空白型, , 
载入 (月份配置, , 真)

.子程序 _单据清理_被选择, 空白型, , 
载入 (单据清理1, , 真)


.窗口程序集 窗口程序集2, , , 

.子程序 片区刷新, 空白型, , 
.局部变量 临时变量, 整数型, , , 

赋值 (临时变量, 1)
清空 ()
.计次循环首 (到数值 (读配置项 (相加 (当前目录, “data\pq.ldb”), “片区”, “总数”, “0”)), )
    读配置项 (相加 (当前目录, “data\pq.ldb”), “片区”, 相加 (“vol”, 到文本 (临时变量)), ).加入项目 ()
    赋值 (临时变量, 相加 (临时变量, 1))
.计次循环尾 ()
赋值 (.现行选中项, 0)

.子程序 办事处刷新, 空白型, , 
.局部变量 临时变量, 整数型, , , 
.局部变量 当前片区, 文本型, , , 

赋值 (临时变量, 1)
清空 ()
.计次循环首 (到数值 (读配置项 (相加 (当前目录, “data\pq.ldb”), .取项目文本 (.现行选中项), “总数”, “0”)), )
    读配置项 (相加 (当前目录, “data\pq.ldb”), .取项目文本 (.现行选中项), 相加 (“vol”, 到文本 (临时变量)), ).加入项目 ()
    赋值 (临时变量, 相加 (临时变量, 1))
.计次循环尾 ()
赋值 (.现行选中项, 0)

.子程序 整体刷新, 空白型, , 
片区刷新 ()
办事处刷新 ()
单位刷新 ()

.子程序 单位刷新, 空白型, , 
全部删除 ()
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (并且 (等于 (读 (“所属片区”), .取项目文本 (.现行选中项)), 等于 (读 (“所属办事处”), .取项目文本 (.现行选中项))))
        -1.插入表项 (读 (“编号”), , , , )
        相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
        相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
        相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
        相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
        相减 (取表项数 (), 1).置标题 (5, 读 (“业务员”))
        相减 (取表项数 (), 1).置标题 (6, 读 (“联系电话”))
        相减 (取表项数 (), 1).置标题 (7, 读 (“业务编码”))
    .否则
        
    .如果结束
    跳过 ()
.判断循环尾 ()

.子程序 _片区_列表项被选择, 空白型, , 
办事处刷新 ()
单位刷新 ()

.子程序 _办事处_列表项被选择, 空白型, , 
单位刷新 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 临时变量, 文本型, , , 
.局部变量 临时数, 整数型, , , 
.局部变量 是否重名, 逻辑型, , , 

.如果 (等于 (输入框 (“请输入片区名称”, “新建片区”, , 临时变量, ), 真))
    .如果 (不等于 (临时变量, “”))
        赋值 (临时数, 0)
        赋值 (是否重名, 假)
        .计次循环首 (取项目数 (), )
            .如果 (等于 (临时数.取项目文本 (), 临时变量))
                赋值 (是否重名, 真)
                跳出循环 ()
            .否则
                赋值 (临时数, 相加 (临时数, 1))
            .如果结束
            
        .计次循环尾 ()
        .如果 (等于 (是否重名, 假))
            写配置项 (相加 (当前目录, “data\pq.ldb”), “片区”, “总数”, 到文本 (相加 (到数值 (读配置项 (相加 (当前目录, “data\pq.ldb”), “片区”, “总数”, “0”)), 1)))
            写配置项 (相加 (当前目录, “data\pq.ldb”), “片区”, 相加 (“vol”, 读配置项 (相加 (当前目录, “data\pq.ldb”), “片区”, “总数”, )), 临时变量)
            整体刷新 ()
        .否则
            信息框 (“已经有同名片区存在，不能重复添加！”, 0, )
        .如果结束
        
    .否则
        
    .如果结束
    
.否则
    
.如果结束


.子程序 _按钮3_被单击, 空白型, , 
.局部变量 临时变量, 整数型, , , 
.局部变量 删除区名, 文本型, , , 

赋值 (临时变量, 1)
赋值 (删除区名, .取项目文本 (.现行选中项))
.如果 (不等于 (.现行选中项, -1))
    写配置项 (相加 (当前目录, “data\pq.ldb”), 删除区名, , )
    写配置项 (相加 (当前目录, “data\pq.ldb”), “片区”, , )
    .删除项目 (.现行选中项)
    写配置项 (相加 (当前目录, “data\pq.ldb”), “片区”, “总数”, 到文本 (取项目数 ()))
    .计次循环首 (取项目数 (), )
        写配置项 (相加 (当前目录, “data\pq.ldb”), “片区”, 相加 (“vol”, 到文本 (临时变量)), 相减 (临时变量, 1).取项目文本 ())
        赋值 (临时变量, 相加 (临时变量, 1))
    .计次循环尾 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (等于 (读 (“所属片区”), 删除区名))
            删除文件 (相加 (当前目录, “data\data\”, 读 (“编号”), “.ldb”))
            删除 ()
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
    彻底删除 ()
    整体刷新 ()
.否则
    
.如果结束


.子程序 _片区管理_创建完毕, 空白型, , 
.如果 (等于 (打开 (相加 (当前目录, “data\ywy.ldb”), , , , , “lgq”, ), 真))
    清空 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        读 (“业务员名称”).加入项目 ()
        跳过 ()
    .判断循环尾 ()
.否则
    信息框 (相加 (“业务员数据库损坏，请恢复系统数据库！”, #换行符, “如果问题不能解决，建议初始化数据库或重新安装系统！”), 0, )
    单位管理.销毁 ()
.如果结束
全部关闭 ()
.如果 (等于 (打开 (相加 (当前目录, “data\index.ldb”), , , , , “lgq”, ), 真))
    整体刷新 ()
    单位自动编号 ()
.否则
    信息框 (相加 (“数据库损坏，请恢复系统数据库！”, #换行符, “如果问题不能解决，建议初始化数据库或重新安装系统！”), 0, )
    单位管理.销毁 ()
.如果结束


.子程序 单位自动编号, 空白型, , 
.局部变量 新编号, 整数型, , , 

到首记录 ()
赋值 (新编号, 1)
.判断循环首 (等于 (查找 (等于 (读 (“编号”), 到文本 (新编号))), 真))
    赋值 (新编号, 相加 (新编号, 1))
    到首记录 ()
.判断循环尾 ()
赋值 (.内容, 到文本 (新编号))

.子程序 _按钮7_被单击, 空白型, , 
.局部变量 临时变量, 整数型, , , 
.局部变量 删除办事处名, 文本型, , , 

赋值 (临时变量, 1)
赋值 (删除办事处名, .取项目文本 (.现行选中项))
.如果 (不等于 (.现行选中项, -1))
    写配置项 (相加 (当前目录, “data\pq.ldb”), .取项目文本 (.现行选中项), , )
    .删除项目 (.现行选中项)
    写配置项 (相加 (当前目录, “data\pq.ldb”), .取项目文本 (.现行选中项), “总数”, 到文本 (取项目数 ()))
    .计次循环首 (取项目数 (), )
        写配置项 (相加 (当前目录, “data\pq.ldb”), .取项目文本 (.现行选中项), 相加 (“vol”, 到文本 (临时变量)), 相减 (临时变量, 1).取项目文本 ())
        赋值 (临时变量, 相加 (临时变量, 1))
    .计次循环尾 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (并且 (等于 (读 (“所属片区”), .取项目文本 (.现行选中项)), 等于 (读 (“所属办事处”), 删除办事处名)))
            删除文件 (相加 (当前目录, “data\data\”, 读 (“编号”), “.ldb”))
            删除 ()
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
    彻底删除 ()
    办事处刷新 ()
    单位刷新 ()
.否则
    
.如果结束


.子程序 _片区管理_将被销毁, 空白型, , 
全部关闭 ()

.子程序 _按钮9_被单击, 空白型, , 
.局部变量 临时数, 整数型, , , 
.局部变量 是否重名, 逻辑型, , , 
.局部变量 临时变量, 文本型, , , 

.如果 (等于 (输入框 (“请输入办事处名称”, “新建办事处”, , 临时变量, ), 真))
    .如果 (不等于 (临时变量, “”))
        赋值 (临时数, 0)
        赋值 (是否重名, 假)
        .计次循环首 (取项目数 (), )
            .如果 (等于 (临时数.取项目文本 (), 临时变量))
                赋值 (是否重名, 真)
                跳出循环 ()
            .否则
                赋值 (临时数, 相加 (临时数, 1))
            .如果结束
            
        .计次循环尾 ()
        .如果 (等于 (是否重名, 假))
            写配置项 (相加 (当前目录, “data\pq.ldb”), .取项目文本 (.现行选中项), “总数”, 到文本 (相加 (到数值 (读配置项 (相加 (当前目录, “data\pq.ldb”), .取项目文本 (.现行选中项), “总数”, “0”)), 1)))
            写配置项 (相加 (当前目录, “data\pq.ldb”), .取项目文本 (.现行选中项), 相加 (“vol”, 读配置项 (相加 (当前目录, “data\pq.ldb”), .取项目文本 (.现行选中项), “总数”, )), 临时变量)
            办事处刷新 ()
            单位刷新 ()
        .否则
            信息框 (“已经有同名办事处存在，不能重复添加！”, 0, )
        .如果结束
        
    .否则
        
    .如果结束
    
.否则
    
.如果结束


.子程序 _按钮6_被单击, 空白型, , 
到首记录 ()
.如果 (等于 (查找 (等于 (读 (“编号”), .内容)), 假))
    .如果 (并且 (不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.现行选中项, -1), 不等于 (.现行选中项, -1), 不等于 (.内容, “”)))
        加记录 (.内容, .内容, .内容, .内容, .内容, .取项目文本 (.现行选中项), .取项目文本 (.现行选中项), .内容, .内容, .内容)
        写到文件 (相加 (当前目录, “data\data\”, .内容, “.ldb”), #单位资料库)
        单位刷新 ()
        单位自动编号 ()
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
    .否则
        信息框 (相加 (“提示：为了系统的正常运行及方便您以后使用，”, #换行符, “请将各项内容填写准确、完整！”), 0, )
    .如果结束
    
.否则
    信息框 (相加 (“提醒：单位编号为唯一的！”, #换行符, “已经存在编号为：”, .内容, “的单位，不能重复添加。”), 0, )
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
片区管理.销毁 ()

.子程序 _按钮10_被单击, 空白型, , 
.如果 (不等于 (., -1))
    载入 (单位修改, , 真)
.否则
    
.如果结束


.子程序 _单位_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_按钮10_被单击 ()

.子程序 _按钮11_被单击, 空白型, , 
.局部变量 当前库文件名, 文本型, , , 

.如果 (不等于 (., -1))
    到首记录 ()
    .如果 (等于 (查找 (等于 (读 (“编号”), .取标题 (., 0))), 真))
        删除文件 (相加 (当前目录, “data\data\”, 读 (“编号”), “.ldb”))
        删除 ()
        彻底删除 ()
        赋值 (当前库文件名, 取当前库 ())
        .如果 (等于 (打开 (相加 (当前目录, “data\bz.ldb”), , , , , “lgq”, ), 真))
            置当前库 (相加 (当前目录, “data\bz.ldb”))
            .如果 (等于 (查找 (等于 (读 (“单位编号”), .取标题 (., 0))), 真))
                删除 ()
                彻底删除 ()
            .否则
                
            .如果结束
            关闭 ()
            置当前库 (当前库文件名)
        .否则
            
        .如果结束
        单位刷新 ()
    .否则
        
    .如果结束
    
.否则
    
.如果结束


.子程序 _片区管理_可否被关闭, 逻辑型, , 
全部关闭 ()

.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    全部删除 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (等于 (读 (“编号”), .内容))
            -1.插入表项 (读 (“编号”), , , , )
            相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
            相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
            相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
            相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
            相减 (取表项数 (), 1).置标题 (5, 读 (“业务员”))
            相减 (取表项数 (), 1).置标题 (6, 读 (“联系电话”))
            相减 (取表项数 (), 1).置标题 (7, 读 (“业务编码”))
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束


.子程序 _编辑框2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    全部删除 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (不等于 (寻找文本 (读 (“名称”), .内容, , 真), -1))
            -1.插入表项 (读 (“编号”), , , , )
            相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
            相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
            相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
            相减 (取表项数 (), 1).置标题 (5, 读 (“业务员”))
            相减 (取表项数 (), 1).置标题 (6, 读 (“联系电话”))
            相减 (取表项数 (), 1).置标题 (7, 读 (“业务编码”))
            相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束


.子程序 _编辑框3_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    全部删除 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (不等于 (寻找文本 (读 (“缩写”), .内容, , 真), -1))
            -1.插入表项 (读 (“编号”), , , , )
            相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
            相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
            相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
            相减 (取表项数 (), 1).置标题 (5, 读 (“业务员”))
            相减 (取表项数 (), 1).置标题 (6, 读 (“联系电话”))
            相减 (取表项数 (), 1).置标题 (7, 读 (“业务编码”))
            相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束


.子程序 _编辑框4_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    全部删除 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (不等于 (寻找文本 (读 (“联系人”), .内容, , 真), -1))
            -1.插入表项 (读 (“编号”), , , , )
            相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
            相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
            相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
            相减 (取表项数 (), 1).置标题 (5, 读 (“业务员”))
            相减 (取表项数 (), 1).置标题 (6, 读 (“联系电话”))
            相减 (取表项数 (), 1).置标题 (7, 读 (“业务编码”))
            相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束


.子程序 _编辑框5_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    全部删除 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (不等于 (寻找文本 (读 (“电话”), .内容, , 真), -1))
            -1.插入表项 (读 (“编号”), , , , )
            相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
            相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
            相减 (取表项数 (), 1).置标题 (5, 读 (“业务员”))
            相减 (取表项数 (), 1).置标题 (6, 读 (“联系电话”))
            相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
            相减 (取表项数 (), 1).置标题 (7, 读 (“业务编码”))
            相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束


.子程序 _单位_当前表项被改变, 空白型, , 
.如果 (不等于 (., -1))
    到首记录 ()
    .如果 (等于 (查找 (等于 (读 (“编号”), .取标题 (., 0))), 真))
        赋值 (.内容, 读 (“所属片区”))
        赋值 (.内容, 读 (“所属办事处”))
    .否则
        
    .如果结束
    
.否则
    
.如果结束


.子程序 _按钮4_被单击, 空白型, , 
全部删除 ()
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (并且 (等于 (读 (“编号”), .内容), 等于 (读 (“名称”), .内容), 等于 (读 (“缩写”), .内容), 等于 (读 (“联系人”), .内容), 等于 (读 (“电话”), .内容), 等于 (读 (“业务员”), .内容), 等于 (读 (“联系电话”), .内容)))
        -1.插入表项 (读 (“编号”), , , , )
        相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
        相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
        相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
        相减 (取表项数 (), 1).置标题 (5, 读 (“业务员”))
        相减 (取表项数 (), 1).置标题 (6, 读 (“联系电话”))
        相减 (取表项数 (), 1).置标题 (7, 读 (“业务编码”))
        相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
        跳出循环 ()
    .否则
        跳过 ()
    .如果结束
    
.判断循环尾 ()

.子程序 _编辑框6_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    全部删除 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (不等于 (寻找文本 (读 (“业务员”), .内容, , 真), -1))
            -1.插入表项 (读 (“编号”), , , , )
            相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
            相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
            相减 (取表项数 (), 1).置标题 (5, 读 (“业务员”))
            相减 (取表项数 (), 1).置标题 (6, 读 (“联系电话”))
            相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
            相减 (取表项数 (), 1).置标题 (7, 读 (“业务编码”))
            相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束



.子程序 _编辑框7_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    全部删除 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (不等于 (寻找文本 (读 (“联系电话”), .内容, , 真), -1))
            -1.插入表项 (读 (“编号”), , , , )
            相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
            相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
            相减 (取表项数 (), 1).置标题 (5, 读 (“业务员”))
            相减 (取表项数 (), 1).置标题 (6, 读 (“联系电话”))
            相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
            相减 (取表项数 (), 1).置标题 (7, 读 (“业务编码”))
            相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束


.子程序 _编辑框8_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    全部删除 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (不等于 (寻找文本 (读 (“业务编码”), .内容, , 真), -1))
            -1.插入表项 (读 (“编号”), , , , )
            相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
            相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
            相减 (取表项数 (), 1).置标题 (5, 读 (“业务员”))
            相减 (取表项数 (), 1).置标题 (6, 读 (“联系电话”))
            相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
            相减 (取表项数 (), 1).置标题 (7, 读 (“业务编码”))
            相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束



.子程序 _业务员_列表项被选择, 空白型, , 
.局部变量 当前库文件, 文本型, , , 

赋值 (当前库文件, 取当前库 ())
.如果 (等于 (打开 (相加 (当前目录, “data\ywy.ldb”), , , , , “lgq”, ), 真))
    置当前库 (相加 (当前目录, “data\ywy.ldb”))
    到首记录 ()
    .如果 (等于 (查找 (等于 (读 (“业务员名称”), .取项目文本 (.现行选中项))), 真))
        赋值 (.内容, 读 (“业务员电话”))
        赋值 (.内容, 读 (“业务编码”))
    .否则
        
    .如果结束
    关闭 ()
    置当前库 (当前库文件)
.否则
    
.如果结束


.窗口程序集 窗口程序集3, , , 

.子程序 _资料_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (不等于 (.数据库文件名, “”))
    弹出托盘菜单 ()
.否则
    信息框 (“请先从上面列表中选择购货单位！”, 0, )
.如果结束


.子程序 _单位管理_创建完毕, 空白型, , 
.如果 (等于 (打开 (相加 (当前目录, “data\index.ldb”), “index”, , , , “lgq”, ), 真))
    
.否则
    信息框 (相加 (“数据库损坏，请恢复系统数据库！”, #换行符, “如果问题不能解决，建议初始化数据库或重新安装系统！”), 0, )
    单位管理.销毁 ()
.如果结束
片区刷新 ()
办事处刷新 ()
单位刷新 ()

.子程序 单位刷新, 空白型, , 
全部删除 ()
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (并且 (等于 (读 (“所属片区”), .取项目文本 (.现行选中项)), 等于 (读 (“所属办事处”), .取项目文本 (.现行选中项))))
        -1.插入表项 (读 (“编号”), , , , )
        相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
        相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
        相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
        相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
        相减 (取表项数 (), 1).置标题 (5, 读 (“业务员”))
        相减 (取表项数 (), 1).置标题 (6, 读 (“联系电话”))
        相减 (取表项数 (), 1).置标题 (7, 读 (“业务编码”))
    .否则
        
    .如果结束
    跳过 ()
.判断循环尾 ()
资料刷新 ()

.子程序 片区刷新, 空白型, , 
.局部变量 临时变量, 整数型, , , 

赋值 (临时变量, 1)
清空 ()
.计次循环首 (到数值 (读配置项 (相加 (当前目录, “data\pq.ldb”), “片区”, “总数”, “0”)), )
    读配置项 (相加 (当前目录, “data\pq.ldb”), “片区”, 相加 (“vol”, 到文本 (临时变量)), ).加入项目 ()
    赋值 (临时变量, 相加 (临时变量, 1))
.计次循环尾 ()
赋值 (.现行选中项, 0)

.子程序 办事处刷新, 空白型, , 
.局部变量 临时变量, 整数型, , , 
.局部变量 当前片区, 文本型, , , 

赋值 (临时变量, 1)
清空 ()
.计次循环首 (到数值 (读配置项 (相加 (当前目录, “data\pq.ldb”), .取项目文本 (.现行选中项), “总数”, “0”)), )
    读配置项 (相加 (当前目录, “data\pq.ldb”), .取项目文本 (.现行选中项), 相加 (“vol”, 到文本 (临时变量)), ).加入项目 ()
    赋值 (临时变量, 相加 (临时变量, 1))
.计次循环尾 ()
赋值 (.现行选中项, 0)

.子程序 _片区_列表项被选择, 空白型, , 
办事处刷新 ()
单位刷新 ()

.子程序 _办事处_列表项被选择, 空白型, , 
单位刷新 ()

.子程序 _单位管理_将被销毁, 空白型, , 
全部关闭 ()

.子程序 资料刷新, 空白型, , 
.局部变量 当前数据库名, 文本型, , , 

.如果 (不等于 (., -1))
    赋值 (.数据库文件名, 相加 (当前目录, “data\data\”, .取标题 (., 0), “.ldb”))
    赋值 (.内容, .取标题 (., 0))
    赋值 (.内容, .取标题 (., 1))
    赋值 (.内容, .取标题 (., 2))
    赋值 (.内容, .取标题 (., 3))
    赋值 (.内容, .取标题 (., 4))
    赋值 (.内容, .取标题 (., 5))
    赋值 (.内容, .取标题 (., 6))
    赋值 (.内容, .取标题 (., 7))
    到首记录 ()
    .如果 (等于 (查找 (等于 (读 (“编号”), .内容)), 真))
        赋值 (.内容, 读 (“所属片区”))
        赋值 (.内容, 读 (“所属办事处”))
    .否则
        
    .如果结束
    赋值 (当前数据库名, 取当前库 ())
    .如果 (等于 (打开 (相加 (当前目录, “data\bz.ldb”), , , , , “lgq”, ), 真))
        置当前库 (相加 (当前目录, “data\bz.ldb”))
        到首记录 ()
        .如果 (查找 (等于 (读 (“单位编号”), .内容)))
            赋值 (., 读 (“备注”))
        .否则
            加记录 (.内容, “”)
            赋值 (., “”)
        .如果结束
        关闭 ()
        置当前库 (当前数据库名)
    .否则
        .如果 (或者 (等于 (文件是否存在 (相加 (当前目录, “data\bz.ldb”)), 假), 等于 (文件是否存在 (相加 (当前目录, “data\bz.edt”)), 假)))
            写到文件 (相加 (当前目录, “data\bz.ldb”), #bz_ldb)
            写到文件 (相加 (当前目录, “data\bz.edt”), #bz_edt)
        .否则
            信息框 (“备注数据库打开错误，请检查备注数据库是否存在或完整！”, 0, )
        .如果结束
        
    .如果结束
    
.否则
    赋值 (.数据库文件名, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (., “”)
.如果结束


.子程序 _添加空记录_被选择, 空白型, , 
1.添加行 ()

.子程序 _删除本条记录_被选择, 空白型, , 
取光标行号 ().删除行 (1)

.子程序 _删除选中所有记录_被选择, 空白型, , 
取光标行号 ().删除行 (取选择行数 ())

.子程序 _资料_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (不等于 (.数据库文件名, “”))
    
.否则
    信息框 (“请先从上面列表中选择购货单位！”, 0, )
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
单位管理.销毁 ()

.子程序 _删除所有记录_被选择, 空白型, , 
1.删除行 (取行数 ())

.子程序 _资料_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 46))
    取光标行号 ().删除行 (取选择行数 ())
.否则
    .如果 (等于 (键代码, 45))
        1.添加行 ()
    .否则
        
    .如果结束
    
.如果结束


.子程序 _复制_被选择, 空白型, , 
取光标行号 ().复制 (取光标列号 (), 取选择行数 (), 取选择列数 ())

.子程序 _粘贴_被选择, 空白型, , 
粘贴到光标处 ()

.子程序 _清空选择区数据_被选择, 空白型, , 
取光标行号 ().清除 (取光标列号 (), 取选择行数 (), 取选择列数 ())

.子程序 _单位_当前表项被改变, 空白型, , 
资料刷新 ()

.子程序 _单位管理_可否被关闭, 逻辑型, , 
全部关闭 ()

.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    全部删除 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (等于 (读 (“编号”), .内容))
            -1.插入表项 (读 (“编号”), , , , )
            相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
            相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
            相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
            相减 (取表项数 (), 1).置标题 (5, 读 (“业务员”))
            相减 (取表项数 (), 1).置标题 (6, 读 (“联系电话”))
            相减 (取表项数 (), 1).置标题 (7, 读 (“业务编码”))
            相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束


.子程序 _编辑框2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    全部删除 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (不等于 (寻找文本 (读 (“名称”), .内容, , 真), -1))
            -1.插入表项 (读 (“编号”), , , , )
            相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
            相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
            相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
            相减 (取表项数 (), 1).置标题 (5, 读 (“业务员”))
            相减 (取表项数 (), 1).置标题 (6, 读 (“联系电话”))
            相减 (取表项数 (), 1).置标题 (7, 读 (“业务编码”))
            相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束


.子程序 _编辑框3_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    全部删除 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (不等于 (寻找文本 (读 (“缩写”), .内容, , 真), -1))
            -1.插入表项 (读 (“编号”), , , , )
            相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
            相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
            相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
            相减 (取表项数 (), 1).置标题 (5, 读 (“业务员”))
            相减 (取表项数 (), 1).置标题 (6, 读 (“联系电话”))
            相减 (取表项数 (), 1).置标题 (7, 读 (“业务编码”))
            相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束


.子程序 _编辑框4_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    全部删除 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (不等于 (寻找文本 (读 (“联系人”), .内容, , 真), -1))
            -1.插入表项 (读 (“编号”), , , , )
            相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
            相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
            相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
            相减 (取表项数 (), 1).置标题 (5, 读 (“业务员”))
            相减 (取表项数 (), 1).置标题 (6, 读 (“联系电话”))
            相减 (取表项数 (), 1).置标题 (7, 读 (“业务编码”))
            相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束


.子程序 _编辑框5_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    全部删除 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (不等于 (寻找文本 (读 (“电话”), .内容, , 真), -1))
            -1.插入表项 (读 (“编号”), , , , )
            相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
            相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
            相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
            相减 (取表项数 (), 1).置标题 (5, 读 (“业务员”))
            相减 (取表项数 (), 1).置标题 (6, 读 (“联系电话”))
            相减 (取表项数 (), 1).置标题 (7, 读 (“业务编码”))
            相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
全部删除 ()
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (并且 (等于 (读 (“编号”), .内容), 等于 (读 (“名称”), .内容), 等于 (读 (“缩写”), .内容), 等于 (读 (“联系人”), .内容), 等于 (读 (“电话”), .内容), 等于 (读 (“业务员”), .内容), 等于 (读 (“联系电话”), .内容), 等于 (读 (“业务编码”), .内容)))
        -1.插入表项 (读 (“编号”), , , , )
        相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
        相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
        相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
        相减 (取表项数 (), 1).置标题 (5, 读 (“业务员”))
        相减 (取表项数 (), 1).置标题 (6, 读 (“联系电话”))
        相减 (取表项数 (), 1).置标题 (7, 读 (“业务编码”))
        相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
        跳出循环 ()
    .否则
        跳过 ()
    .如果结束
    
.判断循环尾 ()

.子程序 _编辑框6_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    全部删除 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (不等于 (寻找文本 (读 (“业务员”), .内容, , 真), -1))
            -1.插入表项 (读 (“编号”), , , , )
            相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
            相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
            相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
            相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
            相减 (取表项数 (), 1).置标题 (5, 读 (“业务员”))
            相减 (取表项数 (), 1).置标题 (7, 读 (“业务编码”))
            相减 (取表项数 (), 1).置标题 (6, 读 (“联系电话”))
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束



.子程序 _编辑框7_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    全部删除 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (不等于 (寻找文本 (读 (“联系电话”), .内容, , 真), -1))
            -1.插入表项 (读 (“编号”), , , , )
            相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
            相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
            相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
            相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
            相减 (取表项数 (), 1).置标题 (5, 读 (“业务员”))
            相减 (取表项数 (), 1).置标题 (7, 读 (“业务编码”))
            相减 (取表项数 (), 1).置标题 (6, 读 (“联系电话”))
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束


.子程序 _编辑框8_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    全部删除 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (不等于 (寻找文本 (读 (“业务编码”), .内容, , 真), -1))
            -1.插入表项 (读 (“编号”), , , , )
            相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
            相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
            相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
            相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
            相减 (取表项数 (), 1).置标题 (5, 读 (“业务员”))
            相减 (取表项数 (), 1).置标题 (7, 读 (“业务编码”))
            相减 (取表项数 (), 1).置标题 (6, 读 (“联系电话”))
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束


.子程序 _资料_选择行列数改变, 空白型, , 
.如果 (或者 (等于 (取光标列号 (), 1), 等于 (取光标列号 (), 2), 等于 (取光标列号 (), 3)))
    载入 (选择产品, , 真)
.否则
    
.如果结束


.子程序 _按钮3_被单击, 空白型, , 
.局部变量 当前数据库名, 文本型, , , 

赋值 (当前数据库名, 取当前库 ())
.如果 (等于 (打开 (相加 (当前目录, “data\bz.ldb”), , , , , “lgq”, ), 真))
    置当前库 (相加 (当前目录, “data\bz.ldb”))
    到首记录 ()
    .如果 (查找 (等于 (读 (“单位编号”), .取标题 (., 0))))
        修改 (.)
    .否则
        加记录 (.取标题 (., 0), .)
    .如果结束
    关闭 ()
    置当前库 (当前数据库名)
.否则
    信息框 (“备注数据库打开错误，请检查备注数据库是否存在或完整！”, 0, )
.如果结束


.窗口程序集 窗口程序集4, , , 

.子程序 _单位修改_创建完毕, 空白型, , 
.局部变量 当前项目, 整数型, , , 

赋值 (.内容, 片区管理.取标题 (., 片区管理.., 0))
赋值 (.内容, 片区管理.取标题 (., 片区管理.., 1))
赋值 (.内容, 片区管理.取标题 (., 片区管理.., 2))
赋值 (.内容, 片区管理.取标题 (., 片区管理.., 3))
赋值 (.内容, 片区管理.取标题 (., 片区管理.., 4))
赋值 (当前项目, 0)
.计次循环首 (片区管理.取项目数 (.), )
    片区管理.取项目文本 (., 当前项目).加入项目 ()
    赋值 (当前项目, 相加 (当前项目, 1))
.计次循环尾 ()
片区管理.取标题 (., 片区管理.., 5).选择 ()
赋值 (.内容, 片区管理.取标题 (., 片区管理.., 6))
赋值 (.内容, 片区管理.取标题 (., 片区管理.., 7))

.子程序 _按钮6_被单击, 空白型, , 
到首记录 ()
.如果 (等于 (查找 (等于 (读 (“编号”), .内容)), 真))
    .如果 (并且 (不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”)))
        修改 (.内容, .内容, .内容, .内容, , , .内容, .内容, .内容)
        片区管理.置标题 (., 片区管理.., 1, .内容)
        片区管理.置标题 (., 片区管理.., 2, .内容)
        片区管理.置标题 (., 片区管理.., 3, .内容)
        片区管理.置标题 (., 片区管理.., 4, .内容)
        片区管理.置标题 (., 片区管理.., 5, .内容)
        片区管理.置标题 (., 片区管理.., 6, .内容)
        片区管理.置标题 (., 片区管理.., 7, .内容)
    .否则
        信息框 (相加 (“提示：为了系统的正常运行及方便您以后使用，”, #换行符, “请将各项内容填写准确、完整！”), 0, )
    .如果结束
    
.否则
    
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
销毁 ()

.子程序 _业务员_列表项被选择, 空白型, , 
.局部变量 当前库文件, 文本型, , , 

赋值 (当前库文件, 取当前库 ())
.如果 (等于 (打开 (相加 (当前目录, “data\ywy.ldb”), , , , , “lgq”, ), 真))
    置当前库 (相加 (当前目录, “data\ywy.ldb”))
    到首记录 ()
    .如果 (等于 (查找 (等于 (读 (“业务员名称”), .取项目文本 (.现行选中项))), 真))
        赋值 (.内容, 读 (“业务员电话”))
        赋值 (.内容, 读 (“业务编码”))
    .否则
        
    .如果结束
    关闭 ()
    置当前库 (当前库文件)
.否则
    
.如果结束


.窗口程序集 窗口程序集5, , , 

.子程序 _备份_创建完毕, 空白型, , 
赋值 (.标题, 取文本注册项 (3, “光庆软件系列\青啤打账\缺省目录”, 相加 (当前目录, “backup”)))

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 保存目录, 文本型, , , 

赋值 (.位置, 0)
赋值 (.内容, “0%”)
.如果 (等于 (.选中, 真))
    赋值 (保存目录, .标题)
.否则
    赋值 (保存目录, .目录)
.如果结束
.如果 (不等于 (取文本右边 (保存目录, 1), “\”))
    赋值 (保存目录, 相加 (保存目录, “\”))
.否则
    
.如果结束
赋值 (.内容, 相加 (“正在保存:”, 保存目录, 到文本 (取现行时间 ()), “.bak”))
.如果 (等于 (相加 (当前目录, “data”).未知支持库函数_0 (相加 (保存目录, 到文本 (取现行时间 ()), “.bak”)), 1))
    信息框 (“数据库备份完毕！”, 0, )
.否则
    信息框 (“数据库备份失败！”, 0, )
.如果结束
赋值 (.位置, 0)
赋值 (.内容, “0%”)
赋值 (.内容, “”)

.子程序 _按钮2_被单击, 空白型, , 
数据备份.销毁 ()

.子程序 _按钮3_被单击, 空白型, , 
写注册项 (3, “光庆软件系列\青啤打账\缺省目录”, .目录)
赋值 (.标题, 取文本注册项 (3, “光庆软件系列\青啤打账\缺省目录”, 相加 (当前目录, “backup”)))

.子程序 _驱动器框1_驱动器被改变, 空白型, , 
赋值 (.目录, 相加 (.驱动器, “:\”))

.子程序 _备份_压缩进度, 逻辑型, , 
.参数 已完成百分比, 整数型, , 

赋值 (.位置, 已完成百分比)
赋值 (.内容, 相加 (到文本 (已完成百分比), “%”))

.子程序 _数据备份_创建完毕, 空白型, , 
.局部变量 qqq, 文本型, , , 

赋值 (.标题, 取文本注册项 (3, “光庆软件系列\青啤打账\缺省目录”, 相加 (当前目录, “backup”)))
赋值 (qqq, 取文本注册项 (3, “dysz\tsk”, “真”))
.如果 (等于 (qqq, “真”))
    未知支持库函数_0 (取窗口句柄 (), 相加 (“如果选中本项，系统将把备份文件储存在当前缺省的目录中。”, #换行符, “否则，将存储于左边目录框中的目录中。”, #换行符, “您可以更改缺省目录，以更方便、安全的保存数据。”, #换行符, “注意：自动备份功能只会将数据储存在缺省目录中。”), 真, 假)
    未知支持库函数_0 (取窗口句柄 (), 相加 (“如果想把备份文件储存在本目录中，必须将：”, #换行符, #左引号, “备份文件到缺省目录”, #右引号, #换行符, “前的对号去掉（即不选中）！”), 真, 假)
    未知支持库函数_6 (1, “友情提示：”)
    未知支持库函数_4 (#红色)
.否则
    
.如果结束
.如果 (等于 (取文本注册项 (3, “光庆软件系列\青啤打账\启动保存”, “假”), “真”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束
.如果 (等于 (取文本注册项 (3, “光庆软件系列\青啤打账\关闭保存”, “假”), “真”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束


.子程序 _选择框1_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    写注册项 (3, “光庆软件系列\青啤打账\启动保存”, “真”)
.否则
    写注册项 (3, “光庆软件系列\青啤打账\启动保存”, “假”)
.如果结束


.子程序 _选择框2_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    写注册项 (3, “光庆软件系列\青啤打账\关闭保存”, “真”)
.否则
    写注册项 (3, “光庆软件系列\青啤打账\关闭保存”, “假”)
.如果结束


.窗口程序集 窗口程序集6, , , 

.子程序 _目录框1_目录被改变, 空白型, , 
.如果 (等于 (.选中, 假))
    赋值 (.目录, .目录)
.否则
    
.如果结束


.子程序 _使用缺省目录_被单击, 空白型, , 
.如果 (等于 (.选中, 假))
    赋值 (.目录, .目录)
.否则
    赋值 (.目录, .标题)
.如果结束


.子程序 _数据恢复_创建完毕, 空白型, , 
.局部变量 qqq, 文本型, , , 

赋值 (.标题, 取文本注册项 (3, “光庆软件系列\青啤打账\缺省目录”, 相加 (当前目录, “backup”)))
赋值 (qqq, 取文本注册项 (3, “dysz\tsk”, “真”))
.如果 (等于 (qqq, “真”))
    
    未知支持库函数_0 (取窗口句柄 (), 相加 (“如果选中本项，将从当前缺省的目录中选择备份文件进行还原：”, #换行符, “否则，将从左边目录框中的目录中选择文件。”), 真, 假)
    未知支持库函数_0 (取窗口句柄 (), 相加 (“如果想从本目录中还原文件，必须将：”, #换行符, #左引号, “选择缺省目录中的备份文件”, #右引号, #换行符, “前的对号去掉（即不选中）！”), 真, 假)
    未知支持库函数_0 (取窗口句柄 (), 相加 (“本操作将完全覆盖数据库中的原有数据，请谨慎使用！”, #换行符, “强烈建议恢复前先备份一遍数据！”), 真, 假)
    未知支持库函数_6 (1, “友情提示：”)
    未知支持库函数_4 (#红色)
.否则
    
.如果结束
.如果 (等于 (.选中, 假))
    赋值 (.目录, .目录)
.否则
    赋值 (.目录, .标题)
.如果结束


.子程序 _驱动器框1_驱动器被改变, 空白型, , 
赋值 (.目录, 相加 (.驱动器, “:\”))

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 文件目录, 文本型, , , 

赋值 (.位置, 0)
赋值 (.内容, “0%”)
赋值 (文件目录, .目录)
.如果 (不等于 (取文本右边 (文件目录, 1), “\”))
    赋值 (文件目录, 相加 (文件目录, “\”))
.否则
    
.如果结束
.如果 (不等于 (.被选择文件, “”))
    赋值 (文件目录, 相加 (文件目录, .被选择文件))
    赋值 (.内容, 相加 (“正在恢复：”, 文件目录))
    删除目录 (相加 (当前目录, “data”))
    .如果 (等于 (文件目录.未知支持库函数_2 (相加 (当前目录, “data”)), 1))
        信息框 (“数据已经成功恢复完毕！”, 0, )
    .否则
        信息框 (“数据恢复失败，请稍候再试！”, 0, )
    .如果结束
    赋值 (.位置, 0)
    赋值 (.内容, “0%”)
    赋值 (.内容, “”)
.否则
    信息框 (“请从备份文件列表中选择要恢复的备份文件！”, 0, )
.如果结束


.子程序 _恢复_解压缩进度, 逻辑型, , 
.参数 已完成百分比, 整数型, , 

赋值 (.位置, 已完成百分比)
赋值 (.内容, 相加 (到文本 (已完成百分比), “%”))

.子程序 _按钮2_被单击, 空白型, , 
数据恢复.销毁 ()

.子程序 _文件框1_双击选择, 空白型, , 
_按钮1_被单击 ()

.窗口程序集 窗口程序集7, , , 

.子程序 _促销品管理_创建完毕, 空白型, , 
赋值 (.数据库文件名, 相加 (当前目录, “data\cx.ldb”))
.如果 (等于 (取行数 (), 0))
    .添加行 ()
.否则
    
.如果结束


.子程序 _添加空记录_被选择, 空白型, , 
1.添加行 ()

.子程序 _删除本条记录_被选择, 空白型, , 
取光标行号 ().删除行 (1)

.子程序 _表格1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出托盘菜单 ()

.子程序 _删除选择记录_被选择, 空白型, , 
取光标行号 ().删除行 (取选择行数 ())

.子程序 _删除所有记录_被选择, 空白型, , 
1.删除行 (取行数 ())

.子程序 _表格1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 46))
    取光标行号 ().删除行 (取选择行数 ())
.否则
    .如果 (等于 (键代码, 45))
        1.添加行 ()
    .否则
        
    .如果结束
    
.如果结束


.子程序 _清空选择区数据_被选择, 空白型, , 
取光标行号 ().清除 (取光标列号 (), 取选择行数 (), 取选择列数 ())

.子程序 _复制CtrlC_被选择, 空白型, , 
取光标行号 ().复制 (取光标列号 (), 取选择行数 (), 取选择列数 ())

.子程序 _粘贴CtrlV_被选择, 空白型, , 
粘贴到光标处 ()

.子程序 _按钮1_被单击, 空白型, , 
促销品管理.销毁 ()

.窗口程序集 窗口程序集8, , , 

.子程序 _身份验证_创建完毕, 空白型, , 
.局部变量 公告句柄, 整数型, , , 

.如果 (等于 (打开 (相加 (当前目录, “pas.ldb”), , , , , “sdlgq”, ), 真))
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (不等于 (读 (“用户名”), “管理员”))
            读 (“用户名”).加入项目 ()
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
    赋值 (.现行选中项, 0)
.否则
    删除文件 (相加 (当前目录, “pas.ldb”))
    写到文件 (相加 (当前目录, “pas.ldb”), #用户密码库)
    信息框 (“用户密码库初始化完毕，您现在只能以管理员身份和初始密码登录！”, 0, )
    “管理员”.选择 ()
    获取焦点 ()
.如果结束
全部关闭 ()
赋值 (公告句柄, 打开文件 (相加 (当前目录, “gg.dat”), 6, ))
赋值 (., 相加 (读入文本 (公告句柄, ), #换行符, 读入文本 (公告句柄, )))
关闭文件 (公告句柄)
赋值 (., 相乘 (未知支持库函数_1 (), 16))
赋值 (., 0)
赋值 (.时钟周期, 50)
获取焦点 ()

.子程序 _按钮1_被单击, 空白型, , 
.如果 (等于 (打开 (相加 (当前目录, “pas.ldb”), , , , , “sdlgq”, ), 真))
    到首记录 ()
    .如果 (等于 (查找 (等于 (读 (“用户名”), .内容)), 真))
        .如果 (等于 (读 (“验证码”), .内容))
            赋值 (_启动窗口., 真)
            写日志 (相加 (到文本 (取现行时间 ()), “//”, .内容, “登录本系统!”))
            赋值 (当前用户, .内容)
            全部关闭 ()
            身份验证.销毁 ()
        .否则
            信息框 (“您输入的验证码不对，请检查后重新输入！”, 0, )
            赋值 (.内容, “”)
            获取焦点 ()
        .如果结束
        
    .否则
        .如果 (等于 (.内容, “管理员”))
            加记录 (“管理员”, “123456”)
            赋值 (.内容, “”)
            获取焦点 ()
            信息框 (“管理员身份被非法修改，系统已经进行修正，请用初始密码登录！”, 0, )
        .否则
            信息框 (“你选择的用户不存在，请检查后重新选择！”, 0, )
            赋值 (.内容, “”)
            赋值 (.现行选中项, 0)
        .如果结束
        
    .如果结束
    
.否则
    信息框 (相加 (“无法打开系统密码库，建议您重新启动本系统！”, #换行符, “如果仍然无法正常运行，建议重新安装本系统！”), 0, )
.如果结束
全部关闭 ()

.子程序 写日志, 空白型, , 
.参数 写出内容, 文本型, , 

.局部变量 日志文件, 整数型, , , 

赋值 (日志文件, 打开文件 (相加 (当前目录, “rec.dat”), 5, ))
移到文件尾 (日志文件)
写文本行 (日志文件, 写出内容)
关闭文件 (日志文件)

.子程序 _验证码_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    _按钮1_被单击 ()
.否则
    
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
结束 ()

.子程序 _时钟1_周期事件, 空白型, , 
.如果 (小于或等于 (., 相减 (0, 相除 (., 2))))
    赋值 (., -1)
.否则
    赋值 (., 相减 (., 1))
.如果结束
.如果 (小于 (.位置, .最大位置))
    赋值 (.位置, 相加 (.位置, 1))
.否则
    赋值 (.位置, 0)
.如果结束


.子程序 _用户名_列表被关闭, 空白型, , 
获取焦点 ()

.窗口程序集 窗口程序集9, , , 

.子程序 _系统日志_创建完毕, 空白型, , 
.局部变量 文件句柄, 整数型, , , 

赋值 (文件句柄, 打开文件 (相加 (当前目录, “rec.dat”), , ))
赋值 (., 读入文本 (文件句柄, ))
关闭文件 (文件句柄)

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 文件句柄, 整数型, , , 

赋值 (文件句柄, 打开文件 (相加 (当前目录, “rec.dat”), 4, ))
写文本行 (文件句柄, 相加 (到文本 (取现行时间 ()), “//”, 当前用户, “清空系统日志!”))
关闭文件 (文件句柄)
_系统日志_创建完毕 ()

.子程序 _按钮2_被单击, 空白型, , 
系统日志.销毁 ()

.窗口程序集 窗口程序集10, , , 

.子程序 _密码设定_创建完毕, 空白型, , 
.局部变量 qqq, 文本型, , , 

赋值 (qqq, 取文本注册项 (3, “dysz\tsk”, “真”))
.如果 (等于 (qqq, “真”))
    未知支持库函数_0 (取窗口句柄 (), 相加 (“要想更改用户密码，必须输入正确的原密码！”, #换行符, “在此输入用户的原密码，如果忘记原密码，可输入管理员密码！”), 真, 假)
    未知支持库函数_6 (1, “友情提示：”)
    未知支持库函数_4 (#红色)
.否则
    
.如果结束
.如果 (等于 (打开 (相加 (当前目录, “pas.ldb”), , , , , “sdlgq”, ), 真))
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        读 (“用户名”).加入项目 ()
        跳过 ()
    .判断循环尾 ()
.否则
    删除文件 (相加 (当前目录, “pas.ldb”))
    写到文件 (相加 (当前目录, “pas.ldb”), #用户密码库)
    .如果 (等于 (打开 (相加 (当前目录, “pas.ldb”), , , , , “sdlgq”, ), 真))
        
    .否则
        信息框 (“无法初始化用户密码库,请稍后再试!”, 0, )
        密码设定.销毁 ()
    .如果结束
    
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
.如果 (并且 (不等于 (.内容, “”), 不等于 (.内容, “”), 等于 (.内容, .内容), 不等于 (.内容, “管理员”)))
    到首记录 ()
    .如果 (等于 (查找 (等于 (读 (“用户名”), .内容)), 假))
        加记录 (.内容, .内容)
        信息框 (“用户已经添加成功,请勿忘记验证码!”, 0, )
        清空 ()
        到首记录 ()
        .判断循环首 (等于 (尾记录后 (), 假))
            读 (“用户名”).加入项目 ()
            跳过 ()
        .判断循环尾 ()
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        获取焦点 ()
    .否则
        信息框 (“该用户已经存在,请更换用户名!”, 0, )
    .如果结束
    
.否则
    信息框 (“输入有误,请检查各项是否填写正确!”, 0, )
.如果结束


.子程序 _按钮4_被单击, 空白型, , 
密码设定.销毁 ()

.子程序 _按钮2_被单击, 空白型, , 
.局部变量 管理员密码, 文本型, , , 

.如果 (并且 (不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”), 等于 (.内容, .内容)))
    到首记录 ()
    .如果 (等于 (查找 (等于 (读 (“用户名”), “管理员”)), 真))
        赋值 (管理员密码, 读 (“验证码”))
    .否则
        
    .如果结束
    到首记录 ()
    .如果 (等于 (查找 (等于 (读 (“用户名”), .内容)), 假))
        信息框 (“该用户不存在,请确定输入是否正确!”, 0, )
    .否则
        .如果 (或者 (等于 (读 (“验证码”), .内容), 等于 (.内容, 管理员密码)))
            修改 (.内容)
            信息框 (“用户信息修改成功,请勿忘记验证码!”, 0, )
            赋值 (.内容, “”)
            赋值 (.内容, “”)
            赋值 (.内容, “”)
            赋值 (.内容, “”)
            获取焦点 ()
        .否则
            信息框 (“原验证码输入不正确,您无权修改本用户信息!”, 0, )
        .如果结束
        
    .如果结束
    
.否则
    信息框 (“输入有误,请检查各项是否填写正确!”, 0, )
.如果结束


.子程序 _密码设定_可否被关闭, 逻辑型, , 
全部关闭 ()

.子程序 _按钮5_被单击, 空白型, , 
密码设定.销毁 ()

.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框3_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    _按钮1_被单击 ()
.否则
    
.如果结束


.子程序 _编辑框4_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框5_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框6_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    _按钮2_被单击 ()
.否则
    
.如果结束


.子程序 _组合框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _按钮3_被单击, 空白型, , 
.局部变量 管理员密码, 文本型, , , 

.如果 (并且 (不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “管理员”)))
    到首记录 ()
    .如果 (等于 (查找 (等于 (读 (“用户名”), “管理员”)), 真))
        赋值 (管理员密码, 读 (“验证码”))
    .否则
        
    .如果结束
    到首记录 ()
    .如果 (等于 (查找 (等于 (读 (“用户名”), .内容)), 假))
        信息框 (“该用户不存在,请确定输入是否正确!”, 0, )
    .否则
        .如果 (或者 (等于 (读 (“验证码”), .内容), 等于 (.内容, 管理员密码)))
            删除 ()
            彻底删除 ()
            清空 ()
            到首记录 ()
            .判断循环首 (等于 (尾记录后 (), 假))
                读 (“用户名”).加入项目 ()
                跳过 ()
            .判断循环尾 ()
            赋值 (.内容, “”)
            赋值 (.内容, “”)
            赋值 (.内容, “”)
            赋值 (.内容, “”)
            获取焦点 ()
        .否则
            信息框 (“原验证码输入不正确,您无权修改本用户信息!”, 0, )
        .如果结束
        
    .如果结束
    
.否则
    .如果 (等于 (.内容, “管理员”))
        信息框 (“管理员为系统级操作用户,任何人无权删除!”, 0, )
    .否则
        信息框 (“输入有误,请检查各项是否填写正确!”, 0, )
    .如果结束
    
.如果结束


.子程序 _密码设定_将被销毁, 空白型, , 
全部关闭 ()

.窗口程序集 窗口程序集11, , , 

.程序集变量 延时时间, 整数型, , , 
.子程序 自动执行, 空白型, , 
.局部变量 备份目录, 文本型, , , 

赋值 (.位置, 0)
赋值 (.内容, “0%”)
赋值 (备份目录, 取文本注册项 (3, “光庆软件系列\青啤打账\缺省目录”, 相加 (当前目录, “backup”)))
.如果 (不等于 (取文本右边 (备份目录, 1), “\”))
    赋值 (备份目录, 相加 (备份目录, “\”))
.否则
    
.如果结束
.如果 (等于 (相加 (当前目录, “data”).未知支持库函数_0 (相加 (备份目录, 到文本 (取现行时间 ()), “.bak”)), 1))
    
.否则
    信息框 (“数据库备份失败！”, 0, )
.如果结束


.子程序 _备份_压缩进度, 逻辑型, , 
.参数 已完成百分比, 整数型, , 

赋值 (.位置, 已完成百分比)
赋值 (.内容, 相加 (到文本 (已完成百分比), “%”))

.子程序 _时钟1_周期事件, 空白型, , 
赋值 (延时时间, 相加 (延时时间, 1))
.如果 (等于 (延时时间, 2))
    自动执行 ()
    赋值 (.时钟周期, 0)
    自动备份.销毁 ()
.否则
    
.如果结束


.子程序 _自动备份_创建完毕, 空白型, , 
赋值 (延时时间, 0)
赋值 (.时钟周期, 100)

.窗口程序集 窗口程序集12, , , 

.程序集变量 购货品种编号, 整数型, , , 
.程序集变量 当前单位, 文本型, , , 
.程序集变量 当前品种4, 文本型, , , 
.程序集变量 当前品种3, 文本型, , , 
.程序集变量 当前品种2, 文本型, , , 
.程序集变量 当前品种1, 文本型, , , 
.程序集变量 当前运率4, 文本型, , , 
.程序集变量 当前运率3, 文本型, , , 
.程序集变量 当前运率2, 文本型, , , 
.程序集变量 当前运率1, 文本型, , , 
.程序集变量 是否开始打印, 逻辑型, , , 
.子程序 _单据录入_创建完毕, 空白型, , 
.局部变量 临时变量, 整数型, , , 
.局部变量 qqq, 文本型, , , 

赋值 (qqq, 取文本注册项 (3, “dysz\tsk”, “真”))
.如果 (等于 (qqq, “真”))
    未知支持库函数_0 (取窗口句柄 (), 相加 (“1、直接输入购货单位的名称、缩写或单位编号，然后按回车键。”, #换行符, “2、双击本输入框，在弹出的窗口中选择购货单位。”), 真, 假)
    未知支持库函数_0 (取窗口句柄 (), 相加 (“1、点击年、月、日进行修改：”, #换行符, “     ①直接输入数字”, #换行符, “     ②按键盘的左右箭头选择修改项，上下箭头修改。”, #换行符, “2、鼠标点击右边的箭头，在弹出的窗口中选择日期。”), 真, 假)
    未知支持库函数_0 (取窗口句柄 (), 相加 (“1、请先确定购货单位已经正确输入，否则无法选择产品。”, #换行符, “2、鼠标单击本输入框，在弹出的窗口中选择产品或清除本行内容。”, #换行符, “注意：为防止用户录入错误，本项禁止键盘输入，只支持鼠标选择。”), 真, 假)
    未知支持库函数_0 (取窗口句柄 (), 相加 (“请确定下列内容正确无误，否则无法保存：”, #换行符, “1、单据编号（保证该单据未被保存过）”, #换行符, “2、购货单位（不能为空）”, #换行符, “3、购货品种（至少一种）及数量”, #换行符, “4、配送方式（必选一种）”), 真, 假)
    未知支持库函数_0 (取窗口句柄 (), 相加 (“1、在输入框中填写要反冲的单据编号（保证该单据存在）。”, #换行符, “2、点击单据反冲按钮，或按回车键结束。”, #换行符, “注意：系统在冲掉原单据的同时，会生成一张与原单据数据”, #换行符, “相同的新单据，且该单据的编号为系统当前最新的单据编号。”), 真, 假)
    未知支持库函数_0 (取窗口句柄 (), 相加 (“1、在输入框中填写要反冲的单据编号（保证该单据存在）。”, #换行符, “2、点击单据反冲按钮，或按回车键结束。”, #换行符, “注意：系统在冲掉原单据的同时，会生成一张与原单据数据”, #换行符, “相同的新单据，且该单据的编号为系统当前最新的单据编号。”), 真, 假)
    未知支持库函数_0 (取窗口句柄 (), 相加 (“进行连续打印之前，请检查打印机纸张设置是否正确无误。”, #换行符, “打印完后，请点击”, #左引号, “结束连续打印”, #右引号, “按钮，以恢复其它功能。”), 真, 假)
    未知支持库函数_6 (1, “友情提示：”)
    未知支持库函数_4 (#红色)
.否则
    
.如果结束
赋值 (是否开始打印, 假)
赋值 (.内容, 当前用户)
赋值 (临时变量, 1)
清空 ()
“”.加入项目 ()
.计次循环首 (到数值 (读配置项 (相加 (当前目录, “data\ysdw.ldb”), “单位”, “总数”, “0”)), )
    读配置项 (相加 (当前目录, “data\ysdw.ldb”), “单位”, 相加 (“vol”, 到文本 (临时变量)), ).加入项目 ()
    赋值 (临时变量, 相加 (临时变量, 1))
.计次循环尾 ()
初始化单据 ()

.子程序 初始化单据, 空白型, , 
赋值 (.今天, 取现行时间 ())
自动编号 ()
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.现行选中项, -1)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)

.子程序 自动编号, 空白型, , 
.局部变量 号码, 长整数型, , , 

.如果 (等于 (文件是否存在 (相加 (当前目录, “data\save\”, 到文本 (取年份 (.今天)), “.ldb”)), 假))
    写到文件 (相加 (当前目录, “data\save\”, 到文本 (取年份 (.今天)), “.ldb”), #save_ldb)
.否则
    
.如果结束
.如果 (等于 (打开 (相加 (当前目录, “data\save\”, 到文本 (取年份 (.今天)), “.ldb”), , , , , “lgq”, ), 真))
    赋值 (.内容, 相加 (取文本左边 (到文本 (相乘 (取年份 (.今天), 10000000)), 相减 (11, 取文本长度 (到文本 (相加 (取记录数 (), 1))))), 到文本 (相加 (取记录数 (), 1))))
.否则
    信息框 (“数据库载入失败，请恢复数据库，或重新安装本系统！”, 0, )
.如果结束
全部关闭 ()

.子程序 _购货单位_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.局部变量 判断文字, 文本型, , , 

.如果 (等于 (字符代码, 13))
    赋值 (判断文字, .内容)
    .如果 (等于 (打开 (相加 (当前目录, “data\index.ldb”), , , , , “lgq”, ), 真))
        .如果 (大于 (到数值 (判断文字), 0))
            到首记录 ()
            .如果 (等于 (查找 (等于 (读 (“编号”), 判断文字)), 真))
                赋值 (.内容, 读 (“名称”))
            .否则
                
            .如果结束
            
        .否则
            .如果 (并且 (小于或等于 (取文本长度 (判断文字), 6), 等于 (相乘 (取文本长度 (判断文字), 2), 取文本长度 (到全角 (判断文字)))))
                到首记录 ()
                .如果 (等于 (查找 (等于 (读 (“缩写”), 判断文字)), 真))
                    赋值 (.内容, 读 (“名称”))
                .否则
                    
                .如果结束
                
            .否则
                
            .如果结束
            
        .如果结束
        
    .否则
        
    .如果结束
    到首记录 ()
    .如果 (等于 (查找 (等于 (读 (“名称”), .内容)), 真))
        赋值 (.内容, 读 (“联系人”))
        赋值 (.内容, 读 (“电话”))
        赋值 (.内容, 读 (“业务编码”))
        赋值 (.内容, 读 (“编号”))
    .否则
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
    .如果结束
    
.否则
    
.如果结束
全部关闭 ()

.子程序 _单据录入_将被销毁, 空白型, , 
全部关闭 ()

.子程序 _购货单位_列表项被选择, 空白型, , 
.如果 (等于 (打开 (相加 (当前目录, “data\index.ldb”), , , , , “lgq”, ), 真))
    到首记录 ()
    .如果 (等于 (查找 (等于 (读 (“名称”), .内容)), 真))
        赋值 (.内容, 读 (“联系人”))
        赋值 (.内容, 读 (“电话”))
        赋值 (.内容, 读 (“业务编码”))
    .否则
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
    .如果结束
    
.否则
    
.如果结束
全部关闭 ()

.子程序 _运输单位_列表项被选择, 空白型, , 
.局部变量 车辆数, 整数型, , , 

清空 ()
.如果 (不等于 (.现行选中项, -1))
    赋值 (车辆数, 1)
    .计次循环首 (到数值 (读配置项 (相加 (当前目录, “data\ysdw.ldb”), .取项目文本 (.现行选中项), “总数”, “0”)), )
        读配置项 (相加 (当前目录, “data\ysdw.ldb”), .取项目文本 (.现行选中项), 相加 (“ch”, 到文本 (车辆数)), ).加入项目 ()
        赋值 (车辆数, 相加 (车辆数, 1))
    .计次循环尾 ()
.否则
    
.如果结束


.子程序 _购货品种1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (不等于 (.内容, “”))
    赋值 (购货品种编号, 1)
    载入 (购货品种, , 真)
.否则
    获取焦点 ()
    信息框 (“请先选择购货单位,否则系统无法处理当前数据!”, 0, )
    返回 (假)
.如果结束


.子程序 _购货品种2_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (不等于 (.内容, “”))
    赋值 (购货品种编号, 2)
    载入 (购货品种, , 真)
.否则
    获取焦点 ()
    信息框 (“请先选择购货单位,否则系统无法处理当前数据!”, 0, )
    返回 (假)
.如果结束


.子程序 _购货品种3_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (不等于 (.内容, “”))
    赋值 (购货品种编号, 3)
    载入 (购货品种, , 真)
.否则
    获取焦点 ()
    信息框 (“请先选择购货单位,否则系统无法处理当前数据!”, 0, )
    返回 (假)
.如果结束


.子程序 _购货品种4_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (不等于 (.内容, “”))
    赋值 (购货品种编号, 4)
    载入 (购货品种, , 真)
.否则
    获取焦点 ()
    信息框 (“请先选择购货单位,否则系统无法处理当前数据!”, 0, )
    返回 (假)
.如果结束


.子程序 _按钮4_被单击, 空白型, , 
单据录入.销毁 ()

.子程序 _购货单位_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (选择单位, , 真)

.子程序 _数量1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容))))
    金额合计 ()
.否则
    
.如果结束


.子程序 金额合计, 空白型, , 
.局部变量 标准金额, 文本型, , "2", 

赋值 (.内容, 到文本 (四舍五入 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容)), 2)))
.如果 (不等于 (.内容, “”))
    赋值 (标准金额, 分割文本 (.内容, “.”, ))
    .如果 (大于或等于 (取数组成员数 (标准金额), 1))
        .如果 (大于或等于 (取文本长度 (到文本 (标准金额 [1])), 1))
            赋值 (.内容, 数值到大写 (到数值 (取文本左边 (取文本右边 (标准金额 [1], 1), 1)), 假))
        .否则
            赋值 (.内容, “零”)
        .如果结束
        .如果 (大于或等于 (取文本长度 (到文本 (标准金额 [1])), 2))
            赋值 (.内容, 数值到大写 (到数值 (取文本左边 (取文本右边 (标准金额 [1], 2), 1)), 假))
        .否则
            赋值 (.内容, “零”)
        .如果结束
        .如果 (大于或等于 (取文本长度 (到文本 (标准金额 [1])), 3))
            赋值 (.内容, 数值到大写 (到数值 (取文本左边 (取文本右边 (标准金额 [1], 3), 1)), 假))
        .否则
            赋值 (.内容, “零”)
        .如果结束
        .如果 (大于或等于 (取文本长度 (到文本 (标准金额 [1])), 4))
            赋值 (.内容, 数值到大写 (到数值 (取文本左边 (取文本右边 (标准金额 [1], 4), 1)), 假))
        .否则
            赋值 (.内容, “零”)
        .如果结束
        .如果 (大于或等于 (取文本长度 (到文本 (标准金额 [1])), 5))
            赋值 (.内容, 数值到大写 (到数值 (取文本左边 (取文本右边 (标准金额 [1], 5), 1)), 假))
        .否则
            赋值 (.内容, “零”)
        .如果结束
        .如果 (大于或等于 (取文本长度 (到文本 (标准金额 [1])), 6))
            赋值 (.内容, 数值到大写 (到数值 (取文本左边 (取文本右边 (标准金额 [1], 6), 1)), 假))
        .否则
            赋值 (.内容, “零”)
        .如果结束
        .如果 (大于或等于 (取文本长度 (到文本 (标准金额 [1])), 7))
            信息框 (相加 (“合计金额不能超过”, #左引号, “拾万”, #右引号, “位，否则系统无法处理，请检查数据！”), 0, )
        .否则
            
        .如果结束
        
    .否则
        赋值 (.内容, “零”)
        赋值 (.内容, “零”)
        赋值 (.内容, “零”)
        赋值 (.内容, “零”)
        赋值 (.内容, “零”)
        赋值 (.内容, “零”)
    .如果结束
    .如果 (大于或等于 (取数组成员数 (标准金额), 2))
        .如果 (大于或等于 (取文本长度 (到文本 (标准金额 [2])), 1))
            赋值 (.内容, 数值到大写 (到数值 (取文本中间 (标准金额 [2], 1, 1)), 假))
        .否则
            赋值 (.内容, “零”)
        .如果结束
        .如果 (大于或等于 (取文本长度 (到文本 (标准金额 [2])), 2))
            赋值 (.内容, 数值到大写 (到数值 (取文本中间 (标准金额 [2], 2, 1)), 假))
        .否则
            赋值 (.内容, “零”)
        .如果结束
        
    .否则
        赋值 (.内容, “零”)
        赋值 (.内容, “零”)
    .如果结束
    
.否则
    
.如果结束


.子程序 _数量2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容))))
    金额合计 ()
.否则
    
.如果结束


.子程序 _数量3_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容))))
    金额合计 ()
.否则
    
.如果结束


.子程序 _数量4_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容))))
    金额合计 ()
.否则
    
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 qqq, 整数型, , , 

.如果 (并且 (不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”)))
    
.否则
    信息框 (“输入信息有误，请检查各项是否填写完整！”, 16, )
    返回 ()
.如果结束
.如果 (等于 (打开 (相加 (当前目录, “data\save\”, 到文本 (取年份 (.今天)), “.ldb”), , , , , “lgq”, ), 真))
    新建索引 (相加 (当前目录, “data\save\”, 到文本 (取年份 (.今天)), “.enx”), , , , “编号”)
    到首记录 ()
    .如果 (等于 (索引查找 (.内容), 真))
        信息框 (“注意：该编号的单据已经存在，不能保存。如果要录入新数据，请新建单据！”, 0, )
    .否则
        加记录 (.内容, 到文本 (取日期 (.今天)), .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, 假, 假, “”, 假, “”, .内容, .内容, .内容, .内容, .内容)
        信息框 (“本条单据已经处理完毕，请继续进行操作！”, 0, )
        写日志 (相加 (到文本 (取现行时间 ()), “//”, 当前用户, “建立单据”, .内容))
    .如果结束
    
.否则
    信息框 (“数据库打开错误，请检查数据库是否完整无损！”, 0, )
.如果结束
全部关闭 ()

.子程序 _日期框1_选择日期被改变, 空白型, , 
自动编号 ()

.子程序 _按钮3_被单击, 空白型, , 
初始化单据 ()

.子程序 _配送方式_列表项被选择, 空白型, , 
.局部变量 单位编号, 文本型, , , 

.如果 (等于 (.现行选中项, 1))
    赋值 (当前单位, .内容)
    赋值 (当前品种1, .内容)
    赋值 (当前运率1, .内容)
    赋值 (当前品种2, .内容)
    赋值 (当前运率2, .内容)
    赋值 (当前品种3, .内容)
    赋值 (当前运率3, .内容)
    赋值 (当前品种4, .内容)
    赋值 (当前运率4, .内容)
    .如果 (不等于 (.内容, “”))
        赋值 (.内容, “0”)
        赋值 (.内容, “0”)
        赋值 (.内容, 到文本 (相加 (到数值 (.内容), 到数值 (.内容))))
    .否则
        
    .如果结束
    .如果 (不等于 (.内容, “”))
        赋值 (.内容, “0”)
        赋值 (.内容, “0”)
        赋值 (.内容, 到文本 (相加 (到数值 (.内容), 到数值 (.内容))))
    .否则
        
    .如果结束
    .如果 (不等于 (.内容, “”))
        赋值 (.内容, “0”)
        赋值 (.内容, “0”)
        赋值 (.内容, 到文本 (相加 (到数值 (.内容), 到数值 (.内容))))
    .否则
        
    .如果结束
    .如果 (不等于 (.内容, “”))
        赋值 (.内容, “0”)
        赋值 (.内容, “0”)
        赋值 (.内容, 到文本 (相加 (到数值 (.内容), 到数值 (.内容))))
    .否则
        
    .如果结束
    金额合计 ()
.否则
    .如果 (等于 (打开 (相加 (当前目录, “data\index.ldb”), , , , , “lgq”, ), 真))
        到首记录 ()
        .如果 (查找 (等于 (读 (“名称”), .内容)))
            赋值 (单位编号, 读 (“编号”))
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    
    .如果 (等于 (打开 (相加 (当前目录, “data\data\”, 单位编号, “.ldb”), , , , , “lgq”, ), 真))
        .如果 (不等于 (.内容, “”))
            到首记录 ()
            .如果 (查找 (等于 (读 (“品种”), .内容)))
                赋值 (.内容, 到文本 (读 (“运率”)))
                赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
                赋值 (.内容, 到文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容))))
            .否则
                
            .如果结束
            
        .否则
            
        .如果结束
        .如果 (不等于 (.内容, “”))
            到首记录 ()
            .如果 (查找 (等于 (读 (“品种”), .内容)))
                赋值 (.内容, 到文本 (读 (“运率”)))
                赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
                赋值 (.内容, 到文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容))))
            .否则
                
            .如果结束
            
        .否则
            
        .如果结束
        .如果 (不等于 (.内容, “”))
            到首记录 ()
            .如果 (查找 (等于 (读 (“品种”), .内容)))
                赋值 (.内容, 到文本 (读 (“运率”)))
                赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
                赋值 (.内容, 到文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容))))
            .否则
                
            .如果结束
            
        .否则
            
        .如果结束
        .如果 (不等于 (.内容, “”))
            到首记录 ()
            .如果 (查找 (等于 (读 (“品种”), .内容)))
                赋值 (.内容, 到文本 (读 (“运率”)))
                赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
                赋值 (.内容, 到文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容))))
            .否则
                
            .如果结束
            
        .否则
            
        .如果结束
        金额合计 ()
    .否则
        
    .如果结束
    
.如果结束
全部关闭 ()

.子程序 _按钮5_被单击, 空白型, , 
初始化单据 ()
.如果 (不等于 (.内容, “”))
    .如果 (等于 (信息框 (相加 (“您确定要对单据”, .内容, “进行反冲么？”, #换行符, “本次反冲操作将生成单据：”, .内容), 1, ), 0))
        
    .否则
        返回 ()
    .如果结束
    
.否则
    信息框 (“提示：请输入您要反冲的单据号！”, 0, )
    返回 ()
.如果结束
.如果 (等于 (文件是否存在 (相加 (当前目录, “data\save\”, 取文本左边 (.内容, 4), “.ldb”)), 真))
    .如果 (等于 (打开 (相加 (当前目录, “data\save\”, 取文本左边 (.内容, 4), “.ldb”), , , , , “lgq”, ), 真))
        新建索引 (相加 (当前目录, “data\save\”, 取文本左边 (.内容, 4), “.enx”), , , , “编号”)
        到首记录 ()
        .如果 (等于 (索引查找 (.内容), 真))
            .如果 (等于 (读 (“作废”), 真))
                信息框 (“对不起,该单据已经作废,无法反冲!”, 0, )
            .否则
                .如果 (等于 (读 (“反冲”), 真))
                    信息框 (“对不起,该单据本身为反冲单据,无法对其进行反冲!”, 0, )
                .否则
                    .如果 (等于 (读 (“被反冲”), 真))
                        信息框 (“对不起,该单据已经被反冲,无法再次反冲!”, 0, )
                    .否则
                        修改 (真, .内容, , , , , )
                        赋值 (.内容, 读 (“购货单位”))
                        赋值 (.内容, 读 (“联系人”))
                        赋值 (.内容, 读 (“电话”))
                        赋值 (.内容, 读 (“业务编码”))
                        赋值 (.内容, 读 (“运输单位”))
                        赋值 (.内容, 读 (“车号”))
                        赋值 (.内容, 读 (“品种1”))
                        赋值 (.内容, 读 (“浓度1”))
                        赋值 (.内容, 读 (“规格1”))
                        赋值 (.内容, 读 (“单位1”))
                        赋值 (.内容, 读 (“数量1”))
                        赋值 (.内容, 读 (“净水价格1”))
                        赋值 (.内容, 读 (“净水总价1”))
                        赋值 (.内容, 读 (“瓶子押金1”))
                        赋值 (.内容, 读 (“押金总价1”))
                        赋值 (.内容, 读 (“运率1”))
                        赋值 (.内容, 读 (“运费总价1”))
                        赋值 (.内容, 读 (“合计1”))
                        赋值 (.内容, 读 (“品种2”))
                        赋值 (.内容, 读 (“浓度2”))
                        赋值 (.内容, 读 (“规格2”))
                        赋值 (.内容, 读 (“单位2”))
                        赋值 (.内容, 读 (“数量2”))
                        赋值 (.内容, 读 (“净水价格2”))
                        赋值 (.内容, 读 (“净水总价2”))
                        赋值 (.内容, 读 (“瓶子押金2”))
                        赋值 (.内容, 读 (“押金总价2”))
                        赋值 (.内容, 读 (“运率2”))
                        赋值 (.内容, 读 (“运费总价2”))
                        赋值 (.内容, 读 (“合计2”))
                        赋值 (.内容, 读 (“品种3”))
                        赋值 (.内容, 读 (“浓度3”))
                        赋值 (.内容, 读 (“规格3”))
                        赋值 (.内容, 读 (“单位3”))
                        赋值 (.内容, 读 (“数量3”))
                        赋值 (.内容, 读 (“净水价格3”))
                        赋值 (.内容, 读 (“净水总价3”))
                        赋值 (.内容, 读 (“瓶子押金3”))
                        赋值 (.内容, 读 (“押金总价3”))
                        赋值 (.内容, 读 (“运率3”))
                        赋值 (.内容, 读 (“运费总价3”))
                        赋值 (.内容, 读 (“合计3”))
                        赋值 (.内容, 读 (“品种4”))
                        赋值 (.内容, 读 (“浓度4”))
                        赋值 (.内容, 读 (“规格4”))
                        赋值 (.内容, 读 (“单位4”))
                        赋值 (.内容, 读 (“数量4”))
                        赋值 (.内容, 读 (“净水价格4”))
                        赋值 (.内容, 读 (“净水总价4”))
                        赋值 (.内容, 读 (“瓶子押金4”))
                        赋值 (.内容, 读 (“押金总价4”))
                        赋值 (.内容, 读 (“运率4”))
                        赋值 (.内容, 读 (“运费总价4”))
                        赋值 (.内容, 读 (“合计4”))
                        赋值 (.内容, 读 (“合计”))
                        赋值 (.内容, 读 (“十万”))
                        赋值 (.内容, 读 (“万”))
                        赋值 (.内容, 读 (“千”))
                        赋值 (.内容, 读 (“百”))
                        赋值 (.内容, 读 (“十”))
                        赋值 (.内容, 读 (“元”))
                        赋值 (.内容, 读 (“角”))
                        赋值 (.内容, 读 (“分”))
                        赋值 (.内容, 读 (“配送方式”))
                        赋值 (.内容, 读 (“单位编号”))
                        赋值 (.内容, 读 (“产品编号1”))
                        赋值 (.内容, 读 (“产品编号2”))
                        赋值 (.内容, 读 (“产品编号3”))
                        赋值 (.内容, 读 (“产品编号4”))
                        全部关闭 ()
                        写日志 (相加 (到文本 (取现行时间 ()), “//”, 当前用户, “反冲单据”, .内容, “同时建立新单据”, .内容))
                        .如果 (等于 (打开 (相加 (当前目录, “data\save\”, 到文本 (取年份 (.今天)), “.ldb”), , , , , “lgq”, ), 真))
                            新建索引 (相加 (当前目录, “data\save\”, 到文本 (取年份 (.今天)), “.enx”), , , , “编号”)
                            到首记录 ()
                            .如果 (等于 (索引查找 (.内容), 真))
                                信息框 (“添加新单据失败，系统数据将受到影响，请记住反冲单据号，并立即与管理员联系！”, 0, )
                            .否则
                                加记录 (.内容, 到文本 (取日期 (.今天)), .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, 假, 真, .内容, 假, “”, .内容, .内容, .内容, .内容, .内容)
                                信息框 (“操作完成,该单据已经成功反冲!”, 0, )
                            .如果结束
                            
                        .否则
                            信息框 (“添加新单据失败，系统数据将受到影响，请记住反冲单据号，并立即与管理员联系！”, 0, )
                        .如果结束
                        全部关闭 ()
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .否则
            信息框 (“对不起,该单据不存在,无法反冲!”, 0, )
        .如果结束
        
    .否则
        信息框 (“对不起,保存该单据的数据库打开错误,无法反冲!”, 0, )
    .如果结束
    
.否则
    信息框 (“对不起,该单据不存在,无法反冲!”, 0, )
.如果结束
全部关闭 ()

.子程序 _反冲单据号_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    _按钮5_被单击 ()
.否则
    
.如果结束


.子程序 _数量1_失去焦点, 空白型, , 
.如果 (不等于 (.内容, “”))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容))))
    金额合计 ()
.否则
    
.如果结束


.子程序 _数量2_失去焦点, 空白型, , 
.如果 (不等于 (.内容, “”))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容))))
    金额合计 ()
.否则
    
.如果结束


.子程序 _数量3_失去焦点, 空白型, , 
.如果 (不等于 (.内容, “”))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容))))
    金额合计 ()
.否则
    
.如果结束


.子程序 _数量4_失去焦点, 空白型, , 
.如果 (不等于 (.内容, “”))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容))))
    金额合计 ()
.否则
    
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
.如果 (并且 (不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”)))
    
.否则
    信息框 (“输入信息有误，请检查各项是否填写完整！”, 16, )
    返回 ()
.如果结束
.如果 (等于 (打开 (相加 (当前目录, “data\save\”, 到文本 (取年份 (.今天)), “.ldb”), , , , , “lgq”, ), 真))
    新建索引 (相加 (当前目录, “data\save\”, 到文本 (取年份 (.今天)), “.enx”), , , , “编号”)
    到首记录 ()
    .如果 (等于 (索引查找 (.内容), 真))
        信息框 (“注意：该编号的单据已经存在，不能保存。如果要录入新数据，请新建单据！”, 0, )
    .否则
        加记录 (.内容, 到文本 (取日期 (.今天)), .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, 假, 假, “”, 假, “”, .内容, .内容, .内容, .内容, .内容)
        写日志 (相加 (到文本 (取现行时间 ()), “//”, 当前用户, “建立单据”, .内容))
        .如果 (等于 (信息框 (“本条单据已经保存完毕，请按 '确定' 进行打印,或按 '取消' 取消打印！”, 33, ), 0))
            _按钮9_被单击 ()
        .否则
            
        .如果结束
        
    .如果结束
    
.否则
    信息框 (“数据库打开错误，请检查数据库是否完整无损！”, 0, )
.如果结束
全部关闭 ()

.子程序 _按钮9_被单击, 空白型, , 
.局部变量 左边据, 整数型, , , 
.局部变量 上边据, 整数型, , , 

置等待鼠标 ()
赋值 (左边据, 到数值 (取文本注册项 (3, “dysz\zbj”, “0”)))
赋值 (上边据, 到数值 (取文本注册项 (3, “dysz\sbj”, “0”)))
写日志 (相加 (到文本 (取现行时间 ()), “//”, 当前用户, “打印单据”, .内容))
真.开始打印 (真, 0, 0)
赋值 (.打印作业名, 相加 (“打印单据”, .内容))
赋值 (.绘画单位, 1)
赋值 (.字体.字体大小, 10)
相加 (左边据, 1700).定位写出 (相加 (上边据, 55), .内容)
相加 (左边据, 1660).定位写出 (相加 (上边据, 115), 取年份 (.今天))
相加 (左边据, 1810).定位写出 (相加 (上边据, 115), 取月份 (.今天))
相加 (左边据, 1910).定位写出 (相加 (上边据, 115), 取日 (.今天))
相加 (左边据, 200).定位写出 (相加 (上边据, 170), .内容)
相加 (左边据, 980).定位写出 (相加 (上边据, 170), .内容)
相加 (左边据, 1240).定位写出 (相加 (上边据, 170), .内容)
相加 (左边据, 1700).定位写出 (相加 (上边据, 170), .内容)
相加 (左边据, 200).定位写出 (相加 (上边据, 230), .内容)
相加 (左边据, 1240).定位写出 (相加 (上边据, 230), .内容)
相加 (左边据, 1700).定位写出 (相加 (上边据, 230), .内容)
相加 (左边据, 10).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 150).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 500).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 570).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 790).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 920).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1030).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1200).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1320).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1490).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1610).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1770).定位写出 (相加 (上边据, 400), .内容)

相加 (左边据, 10).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 150).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 500).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 570).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 790).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 920).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1030).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1200).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1320).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1490).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1610).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1770).定位写出 (相加 (上边据, 450), .内容)

相加 (左边据, 10).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 150).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 500).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 570).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 790).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 920).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1030).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1200).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1320).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1490).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1610).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1770).定位写出 (相加 (上边据, 510), .内容)

相加 (左边据, 10).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 150).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 500).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 570).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 790).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 920).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1030).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1200).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1320).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1490).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1610).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1770).定位写出 (相加 (上边据, 570), .内容)

相加 (左边据, 380).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 550).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 890).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1060).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1240).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1400).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1560).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1720).定位写出 (相加 (上边据, 620), 相加 (“￥”, .内容))
相加 (左边据, 1000).定位写出 (相加 (上边据, 680), .内容)
相加 (左边据, 1630).定位写出 (相加 (上边据, 740), .内容)

赋值 (上边据, 相加 (上边据, 820))
相加 (左边据, 1700).定位写出 (相加 (上边据, 55), .内容)
相加 (左边据, 1660).定位写出 (相加 (上边据, 115), 取年份 (.今天))
相加 (左边据, 1810).定位写出 (相加 (上边据, 115), 取月份 (.今天))
相加 (左边据, 1910).定位写出 (相加 (上边据, 115), 取日 (.今天))
相加 (左边据, 200).定位写出 (相加 (上边据, 170), .内容)
相加 (左边据, 980).定位写出 (相加 (上边据, 170), .内容)
相加 (左边据, 1240).定位写出 (相加 (上边据, 170), .内容)
相加 (左边据, 1700).定位写出 (相加 (上边据, 170), .内容)
相加 (左边据, 200).定位写出 (相加 (上边据, 230), .内容)
相加 (左边据, 1240).定位写出 (相加 (上边据, 230), .内容)
相加 (左边据, 1700).定位写出 (相加 (上边据, 230), .内容)
相加 (左边据, 10).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 150).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 500).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 570).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 790).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 920).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1030).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1200).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1320).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1490).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1610).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1770).定位写出 (相加 (上边据, 400), .内容)

相加 (左边据, 10).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 150).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 500).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 570).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 790).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 920).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1030).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1200).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1320).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1490).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1610).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1770).定位写出 (相加 (上边据, 450), .内容)

相加 (左边据, 10).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 150).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 500).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 570).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 790).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 920).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1030).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1200).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1320).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1490).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1610).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1770).定位写出 (相加 (上边据, 510), .内容)

相加 (左边据, 10).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 150).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 500).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 570).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 790).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 920).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1030).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1200).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1320).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1490).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1610).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1770).定位写出 (相加 (上边据, 570), .内容)

相加 (左边据, 380).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 550).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 890).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1060).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1240).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1400).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1560).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1720).定位写出 (相加 (上边据, 620), 相加 (“￥”, .内容))
相加 (左边据, 1000).定位写出 (相加 (上边据, 680), .内容)
相加 (左边据, 1630).定位写出 (相加 (上边据, 740), .内容)

结束打印 ()
恢复鼠标 ()

.子程序 _按钮6_被单击, 空白型, , 
.如果 (并且 (不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”)))
    
.否则
    信息框 (“输入信息有误，请检查各项是否填写完整！”, 16, )
    返回 ()
.如果结束
.如果 (等于 (打开 (相加 (当前目录, “data\save\”, 到文本 (取年份 (.今天)), “.ldb”), , , , , “lgq”, ), 真))
    新建索引 (相加 (当前目录, “data\save\”, 到文本 (取年份 (.今天)), “.enx”), , , , “编号”)
    到首记录 ()
    .如果 (等于 (索引查找 (.内容), 真))
        信息框 (“注意：该编号的单据已经存在，不能保存。如果要录入新数据，请新建单据！”, 0, )
    .否则
        加记录 (.内容, 到文本 (取日期 (.今天)), .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, 假, 假, “”, 假, “”, .内容, .内容, .内容, .内容, .内容)
        写日志 (相加 (到文本 (取现行时间 ()), “//”, 当前用户, “建立单据”, .内容))
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
        赋值 (.禁止, 假)
        连续打印 ()
    .如果结束
    
.否则
    信息框 (“数据库打开错误，请检查数据库是否完整无损！”, 0, )
.如果结束
全部关闭 ()

.子程序 _按钮8_被单击, 空白型, , 
自动编号 ()

.子程序 连续打印, 空白型, , 
.局部变量 左边据, 整数型, , , 
.局部变量 上边据, 整数型, , , 

赋值 (左边据, 到数值 (取文本注册项 (3, “dysz\zbj”, “0”)))
赋值 (上边据, 到数值 (取文本注册项 (3, “dysz\sbj”, “0”)))
写日志 (相加 (到文本 (取现行时间 ()), “//”, 当前用户, “打印单据”, .内容))
.如果 (等于 (是否开始打印, 假))
    真.开始打印 (假, 0, 0)
    赋值 (.打印作业名, “连续打印单据”)
    赋值 (.绘画单位, 1)
    赋值 (.字体.字体大小, 10)
    赋值 (是否开始打印, 真)
.否则
    
.如果结束
相加 (左边据, 1700).定位写出 (相加 (上边据, 55), .内容)
相加 (左边据, 1660).定位写出 (相加 (上边据, 115), 取年份 (.今天))
相加 (左边据, 1810).定位写出 (相加 (上边据, 115), 取月份 (.今天))
相加 (左边据, 1910).定位写出 (相加 (上边据, 115), 取日 (.今天))
相加 (左边据, 200).定位写出 (相加 (上边据, 170), .内容)
相加 (左边据, 980).定位写出 (相加 (上边据, 170), .内容)
相加 (左边据, 1240).定位写出 (相加 (上边据, 170), .内容)
相加 (左边据, 1700).定位写出 (相加 (上边据, 170), .内容)
相加 (左边据, 200).定位写出 (相加 (上边据, 230), .内容)
相加 (左边据, 1240).定位写出 (相加 (上边据, 230), .内容)
相加 (左边据, 1700).定位写出 (相加 (上边据, 230), .内容)
相加 (左边据, 10).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 150).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 500).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 570).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 790).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 920).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1030).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1200).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1320).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1490).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1610).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1770).定位写出 (相加 (上边据, 400), .内容)

相加 (左边据, 10).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 150).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 500).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 570).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 790).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 920).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1030).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1200).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1320).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1490).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1610).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1770).定位写出 (相加 (上边据, 450), .内容)

相加 (左边据, 10).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 150).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 500).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 570).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 790).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 920).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1030).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1200).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1320).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1490).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1610).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1770).定位写出 (相加 (上边据, 510), .内容)

相加 (左边据, 10).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 150).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 500).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 570).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 790).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 920).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1030).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1200).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1320).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1490).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1610).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1770).定位写出 (相加 (上边据, 570), .内容)

相加 (左边据, 380).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 550).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 890).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1060).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1240).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1400).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1560).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1720).定位写出 (相加 (上边据, 620), 相加 (“￥”, .内容))
相加 (左边据, 1000).定位写出 (相加 (上边据, 680), .内容)
相加 (左边据, 1630).定位写出 (相加 (上边据, 740), .内容)

赋值 (上边据, 相加 (上边据, 820))
相加 (左边据, 1700).定位写出 (相加 (上边据, 55), .内容)
相加 (左边据, 1660).定位写出 (相加 (上边据, 115), 取年份 (.今天))
相加 (左边据, 1810).定位写出 (相加 (上边据, 115), 取月份 (.今天))
相加 (左边据, 1910).定位写出 (相加 (上边据, 115), 取日 (.今天))
相加 (左边据, 200).定位写出 (相加 (上边据, 170), .内容)
相加 (左边据, 980).定位写出 (相加 (上边据, 170), .内容)
相加 (左边据, 1240).定位写出 (相加 (上边据, 170), .内容)
相加 (左边据, 1700).定位写出 (相加 (上边据, 170), .内容)
相加 (左边据, 200).定位写出 (相加 (上边据, 230), .内容)
相加 (左边据, 1240).定位写出 (相加 (上边据, 230), .内容)
相加 (左边据, 1700).定位写出 (相加 (上边据, 230), .内容)
相加 (左边据, 10).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 150).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 500).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 570).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 790).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 920).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1030).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1200).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1320).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1490).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1610).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1770).定位写出 (相加 (上边据, 400), .内容)

相加 (左边据, 10).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 150).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 500).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 570).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 790).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 920).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1030).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1200).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1320).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1490).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1610).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1770).定位写出 (相加 (上边据, 450), .内容)

相加 (左边据, 10).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 150).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 500).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 570).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 790).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 920).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1030).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1200).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1320).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1490).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1610).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1770).定位写出 (相加 (上边据, 510), .内容)

相加 (左边据, 10).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 150).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 500).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 570).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 790).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 920).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1030).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1200).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1320).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1490).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1610).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1770).定位写出 (相加 (上边据, 570), .内容)

相加 (左边据, 380).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 550).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 890).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1060).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1240).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1400).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1560).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1720).定位写出 (相加 (上边据, 620), 相加 (“￥”, .内容))
相加 (左边据, 1000).定位写出 (相加 (上边据, 680), .内容)
相加 (左边据, 1630).定位写出 (相加 (上边据, 740), .内容)

.加入项目 (.内容, )
换页 ()

.子程序 _按钮7_被单击, 空白型, , 
.如果 (等于 (是否开始打印, 真))
    置等待鼠标 ()
    结束打印 ()
    赋值 (是否开始打印, 假)
    清空 ()
    恢复鼠标 ()
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 真)
.否则
    信息框 (“打印列表中没有待打印单据,请添加后再打印!”, 0, )
.如果结束


.子程序 _单据录入_可否被关闭, 逻辑型, , 
.局部变量 qqqq, 整数型, , , 

.如果 (等于 (是否开始打印, 真))
    赋值 (qqqq, 信息框 (“打印列表中存在未打印的单据,是否进行打印?”, 3, “请选择是否打印列表”))
    .如果 (等于 (qqqq, 1))
        返回 (假)
    .否则
        .如果 (等于 (qqqq, 5))
            _按钮7_被单击 ()
            返回 (真)
        .否则
            _按钮8_被单击 ()
            返回 (真)
        .如果结束
        
    .如果结束
    
.否则
    
.如果结束


.窗口程序集 窗口程序集13, , , 

.子程序 _系统公告_创建完毕, 空白型, , 
.局部变量 文件句柄, 整数型, , , 

赋值 (文件句柄, 打开文件 (相加 (当前目录, “gg.dat”), , ))
赋值 (., 读入文本 (文件句柄, ))
关闭文件 (文件句柄)

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 文件句柄, 整数型, , , 

赋值 (文件句柄, 打开文件 (相加 (当前目录, “gg.dat”), 4, ))
写出文本 (文件句柄, .)
关闭文件 (文件句柄)
_系统公告_创建完毕 ()

.子程序 _按钮2_被单击, 空白型, , 
系统公告.销毁 ()

.子程序 _按钮3_被单击, 空白型, , 
赋值 (., “”)

.窗口程序集 窗口程序集14, , , 

.程序集变量 是否停止, 逻辑型, , , 
.子程序 _销售日报表_创建完毕, 空白型, , 
.局部变量 qqq, 文本型, , , 

赋值 (qqq, 取文本注册项 (3, “dysz\tsk”, “真”))
.如果 (等于 (qqq, “真”))
    未知支持库函数_0 (取窗口句柄 (), “本月份开始日期”, 真, 假)
    未知支持库函数_0 (取窗口句柄 (), “本月份截止日期”, 真, 假)
    未知支持库函数_0 (取窗口句柄 (), 相加 (“当前日期所属的月份。”, #换行符, “要想更改本月起止日期，请见”, #左引号, “月份配置”, #右引号, “功能！”), 真, 假)
    未知支持库函数_6 (1, “友情提示：”)
    未知支持库函数_4 (#红色)
.否则
    
.如果结束
初始化表格 ()

.子程序 初始化表格, 空白型, , 
.局部变量 临时变量, 整数型, , , 
.局部变量 起日期, 文本型, , , 
.局部变量 止日期, 文本型, , , 

写到文件 (相加 (未知支持库函数_7 (11), “xsrbb.grd”), #销售日报表)
相加 (未知支持库函数_7 (11), “xsrbb.grd”).从文件读 ()
.计次循环首 (12, 临时变量)
    赋值 (起日期, 读配置项 (相加 (当前目录, “data\yuefen.ini”), 相加 (到文本 (临时变量), “月份”), “起日期”, “”))
    赋值 (止日期, 读配置项 (相加 (当前目录, “data\yuefen.ini”), 相加 (到文本 (临时变量), “月份”), “止日期”, “”))
    .如果 (并且 (不等于 (起日期, “”), 不等于 (止日期, “”)))
        .如果 (并且 (大于或等于 (取日期 (.今天), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 起日期))), 小于或等于 (取日期 (.今天), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 止日期)))))
            赋值 (.内容, 到文本 (临时变量))
            赋值 (.内容, 起日期)
            赋值 (.内容, 止日期)
            跳出循环 ()
        .否则
            
        .如果结束
        
    .否则
        信息框 (“月份划分时间表未正确配置，请先正确配置月份，否则无法进行正确计算！”, 48, )
        跳出循环 ()
    .如果结束
    
.计次循环尾 ()

.子程序 _销售日报表_尺寸被改变, 空白型, , 
相减 (销售日报表., .宽度, 15).移动 (10, , )
0.移动 (10, 相减 (销售日报表., .宽度, 20), 相减 (销售日报表., 60))
.移动 (.左边, 相加 (.顶边, .高度, 5), , )

.子程序 _销售日报表_可否被关闭, 逻辑型, , 
赋值 (是否停止, 真)
返回 (假)

.子程序 _销售日报表_将被销毁, 空白型, , 
全部关闭 ()

.子程序 _超级按钮1_被单击, 空白型, , 
打印预览 ()

.子程序 _超级按钮4_被单击, 空白型, , 
.如果 (等于 (打开 (), 真))
    .从文件读 (.文件名)
    4.置表头行数 ()
    0.置表头列数 ()
.否则
    
.如果结束


.子程序 _超级按钮3_被单击, 空白型, , 
赋值 (.文件名, 1.取文本 (9))
.如果 (等于 (打开 (), 真))
    .存到文件 (.文件名)
.否则
    
.如果结束


.子程序 _超级按钮5_被单击, 空白型, , 
.如果 (等于 (., 假))
    销售日报表.销毁 ()
.否则
    信息框 (“请等待报表生成完毕，或取消生成后再关闭本窗口！”, 0, )
.如果结束


.子程序 _超级按钮2_被单击, 空白型, , 
.局部变量 片区数, 整数型, , , 
.局部变量 当前片区, 文本型, , , 
.局部变量 当前办事处, 文本型, , , 
.局部变量 当前片区数, 整数型, , , 
.局部变量 办事处数, 整数型, , , 
.局部变量 当前办事处数, 整数型, , , 
.局部变量 办事处单位数, 整数型, , , 
.局部变量 总单位数, 整数型, , , 
.局部变量 业务员, 文本型, , "0", 
.局部变量 业务员当前项, 整数型, , , 
.局部变量 是否重名, 逻辑型, , , 
.局部变量 当前库文件名, 文本型, , , 
.局部变量 业务编码, 文本型, , , 
.局部变量 月销量, 长整数型, , , 
.局部变量 年销量, 长整数型, , , 
.局部变量 日销量, 长整数型, , , 
.局部变量 单据销量, 长整数型, , , 
.局部变量 办事处小记2, 双精度小数型, , , 
.局部变量 办事处小记1, 双精度小数型, , , 
.局部变量 办事处小记, 双精度小数型, , , 
.局部变量 分公司合计2, 双精度小数型, , , 
.局部变量 分公司合计1, 双精度小数型, , , 
.局部变量 分公司合计, 双精度小数型, , , 
.局部变量 总合计2, 双精度小数型, , , 
.局部变量 总合计1, 双精度小数型, , , 
.局部变量 总合计, 双精度小数型, , , 
.局部变量 正负号, 整数型, , , 
.局部变量 临时变量, 整数型, , , 
.局部变量 临时文件, 文本型, , , 

赋值 (.数据源, “”)
初始化表格 ()
.如果 (并且 (等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.内容, “”)))
    信息框 (“请先正确配置月份，否则无法进行正确计算！”, 48, )
    返回 ()
.否则
    
.如果结束
0.置文本 (“正在收集报表信息，请稍等……”)
赋值 (., 真)
获取焦点 ()
置等待鼠标 ()
赋值 (是否停止, 假)
写到文件 (相加 (未知支持库函数_7 (11), “xsrbb.grd”), #销售日报表)
相加 (未知支持库函数_7 (11), “xsrbb.grd”).从文件读 ()
1.置文本 (9, 到文本 (取日期 (.今天)))
1.置字体尺寸 (9, , , 40)
1.置对齐方式 (9, , , 8)

赋值 (临时文件, 相加 (未知支持库函数_7 (11), “rbb.ini”))
赋值 (临时变量, 打开文件 (临时文件, 4, ))
.如果 (不等于 (临时变量, 0))
    关闭文件 (临时变量)
.否则
    恢复鼠标 ()
    信息框 (“建立临时文件失败，请稍候再试！”, 0, )
    赋值 (., 假)
    0.置文本 (“”)
    返回 ()
.如果结束
.如果 (等于 (打开 (相加 (当前目录, “data\save\”, 到文本 (取年份 (.今天)), “.ldb”), , , , , “lgq”, ), 真))
    到首记录 ()
    赋值 (日销量, 0)
    赋值 (月销量, 0)
    赋值 (年销量, 0)
    .判断循环首 (等于 (尾记录后 (), 假))
        0.置文本 (相加 (“正在生成统计数据,已经完成”, 到文本 (取整 (相乘 (相除 (取记录号 (), 取记录数 ()), 100))), “%”))
        处理事件 ()
        .如果 (等于 (是否停止, 真))
            全部关闭 ()
            初始化表格 ()
            赋值 (., 假)
            0.置文本 (“”)
            恢复鼠标 ()
            返回 ()
        .否则
            
        .如果结束
        置等待鼠标 ()
        .如果 (等于 (读 (“作废”), 假))
            赋值 (业务编码, 读 (“业务编码”))
            赋值 (单据销量, 0)
            .如果 (等于 (读 (“反冲”), 假))
                赋值 (正负号, 1)
            .否则
                赋值 (正负号, -1)
            .如果结束
            赋值 (临时变量, 1)
            .计次循环首 (4, 临时变量)
                .如果 (不等于 (读 (相加 (“数量”, 到文本 (临时变量))), “”))
                    .如果 (等于 (读 (相加 (“单位”, 到文本 (临时变量))), “箱”))
                        赋值 (单据销量, 相加 (单据销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 3)), 到数值 (取文本右边 (读 (相加 (“规格”, 到文本 (临时变量))), 2)), 到数值 (读 (相加 (“数量”, 到文本 (临时变量)))), 正负号)))
                    .否则
                        .如果 (等于 (读 (相加 (“单位”, 到文本 (临时变量))), “包”))
                            赋值 (单据销量, 相加 (单据销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 3)), 到数值 (取文本右边 (读 (相加 (“规格”, 到文本 (临时变量))), 1)), 到数值 (读 (相加 (“数量”, 到文本 (临时变量)))), 正负号)))
                        .否则
                            .如果 (等于 (读 (相加 (“单位”, 到文本 (临时变量))), “筐”))
                                赋值 (单据销量, 相加 (单据销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 3)), 到数值 (取文本右边 (读 (相加 (“规格”, 到文本 (临时变量))), 2)), 到数值 (读 (相加 (“数量”, 到文本 (临时变量)))), 正负号)))
                            .否则
                                .如果 (等于 (读 (相加 (“单位”, 到文本 (临时变量))), “桶”))
                                    赋值 (单据销量, 相加 (单据销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 2)), 到数值 (读 (相加 (“数量”, 到文本 (临时变量)))), 1000, 正负号)))
                                .否则
                                    .如果 (等于 (读 (相加 (“单位”, 到文本 (临时变量))), “罐”))
                                        赋值 (单据销量, 相加 (单据销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 相减 (取文本长度 (读 (相加 (“规格”, 到文本 (临时变量)))), 2))), 到数值 (读 (相加 (“数量”, 到文本 (临时变量)))), 1000000, 正负号)))
                                    .否则
                                        
                                    .如果结束
                                    
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    
                .否则
                    
                .如果结束
                
            .计次循环尾 ()
            .如果 (小于或等于 (取日期 (到时间 (读 (“日期”))), 取日期 (.今天)))
                写配置项 (临时文件, 业务编码, “年销量”, 到文本 (相加 (到数值 (读配置项 (临时文件, 业务编码, “年销量”, “0”)), 单据销量)))
            .否则
                跳出循环 ()
            .如果结束
            .如果 (等于 (读 (“日期”), 到文本 (取日期 (.今天))))
                写配置项 (临时文件, 业务编码, “日销量”, 到文本 (相加 (到数值 (读配置项 (临时文件, 业务编码, “日销量”, “0”)), 单据销量)))
            .否则
                
            .如果结束
            .如果 (并且 (小于或等于 (取日期 (到时间 (读 (“日期”))), 取日期 (.今天)), 小于或等于 (取日期 (到时间 (读 (“日期”))), 取日期 (到时间 (相加 (到文本 (取年份 (.今天)), “年”, .内容)))), 大于或等于 (取日期 (到时间 (读 (“日期”))), 取日期 (到时间 (相加 (到文本 (取年份 (.今天)), “年”, .内容))))))
                写配置项 (临时文件, 业务编码, “月销量”, 到文本 (相加 (到数值 (读配置项 (临时文件, 业务编码, “月销量”, “0”)), 单据销量)))
            .否则
                
            .如果结束
            
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
    全部关闭 ()
.否则
    恢复鼠标 ()
    信息框 (“打开单据数据库错误，请稍候再试！”, 0, )
    赋值 (., 假)
    0.置文本 (“”)
    全部关闭 ()
    返回 ()
.如果结束


0.置文本 (“正在生成表格数据，请稍等……”)
.如果 (等于 (打开 (相加 (当前目录, “data\index.ldb”), , , , , “lgq”, ), 真))
    赋值 (片区数, 到数值 (读配置项 (相加 (当前目录, “data\pq.ldb”), “片区”, “总数”, “0”)))
    赋值 (当前片区数, 1)
    赋值 (总合计, 0)
    赋值 (总合计1, 0)
    赋值 (总合计2, 0)
    .计次循环首 (片区数, )
        赋值 (当前片区, 读配置项 (相加 (当前目录, “data\pq.ldb”), “片区”, 相加 (“vol”, 到文本 (当前片区数)), ))
        赋值 (办事处数, 到数值 (读配置项 (相加 (当前目录, “data\pq.ldb”), 当前片区, “总数”, “0”)))
        赋值 (当前办事处数, 1)
        赋值 (总单位数, 0)
        .计次循环首 (办事处数, )
            赋值 (当前办事处, 读配置项 (相加 (当前目录, “data\pq.ldb”), 当前片区, 相加 (“vol”, 到文本 (当前办事处数)), ))
            赋值 (办事处单位数, 0)
            到首记录 ()
            清除数组 (业务员)
            .判断循环首 (等于 (尾记录后 (), 假))
                处理事件 ()
                .如果 (等于 (是否停止, 真))
                    全部关闭 ()
                    初始化表格 ()
                    赋值 (., 假)
                    0.置文本 (“”)
                    恢复鼠标 ()
                    返回 ()
                .否则
                    
                .如果结束
                置等待鼠标 ()
                .如果 (并且 (等于 (读 (“所属片区”), 当前片区), 等于 (读 (“所属办事处”), 当前办事处)))
                    赋值 (是否重名, 假)
                    赋值 (业务员当前项, 1)
                    .计次循环首 (取数组成员数 (业务员), )
                        .如果 (等于 (业务员 [业务员当前项], 读 (“业务员”)))
                            赋值 (是否重名, 真)
                            跳出循环 ()
                        .否则
                            
                        .如果结束
                        赋值 (业务员当前项, 相加 (业务员当前项, 1))
                    .计次循环尾 ()
                    .如果 (等于 (是否重名, 假))
                        加入成员 (业务员, 读 (“业务员”))
                    .否则
                        
                    .如果结束
                    
                .否则
                    
                .如果结束
                跳过 ()
            .判断循环尾 ()
            赋值 (业务员当前项, 1)
            赋值 (办事处小记, 0)
            .计次循环首 (取数组成员数 (业务员), )
                0.置文本 (相加 (“正在生成”, 当前片区, “/”, 当前办事处, “/”, 业务员 [业务员当前项], “ 数据……”))
                1.添加行 ()
                取行数 ().置文本 (1, 当前片区)
                取行数 ().置文本 (2, 当前办事处)
                取行数 ().置文本 (3, 业务员 [业务员当前项]) ' 这里添加每行具体的业务员名单，每行数据在此之后加入
                赋值 (当前库文件名, 取当前库 ())
                .如果 (等于 (打开 (相加 (当前目录, “data\ywy.ldb”), , , , , “lgq”, ), 真))
                    置当前库 (相加 (当前目录, “data\ywy.ldb”))
                    到首记录 ()
                    .如果 (查找 (等于 (读 (“业务员名称”), 业务员 [业务员当前项])))
                        赋值 (业务编码, 读 (“业务编码”))
                    .否则
                        信息框 (相加 (“没有发现业务员”, #左引号, 业务员 [业务员当前项], #右引号, “，为了数据的准确性，系统不再继续处理！”), 0, )
                        全部关闭 ()
                        赋值 (., 假)
                        初始化表格 ()
                        恢复鼠标 ()
                        0.置文本 (“”)
                        返回 ()
                    .如果结束
                    关闭 ()
                    置当前库 (当前库文件名)
                .否则
                    信息框 (“业务员数据库数据错误,报表生成失败!”, 0, )
                    全部关闭 ()
                    赋值 (., 假)
                    恢复鼠标 ()
                    0.置文本 (“”)
                    返回 ()
                .如果结束
                赋值 (年销量, 到数值 (读配置项 (临时文件, 业务编码, “年销量”, “0”)))
                赋值 (月销量, 到数值 (读配置项 (临时文件, 业务编码, “月销量”, “0”)))
                赋值 (日销量, 到数值 (读配置项 (临时文件, 业务编码, “日销量”, “0”)))
                
                 ' 下面为填充每行数据
                取行数 ().置文本 (4, 到文本 (四舍五入 (相除 (日销量, 1000000), 3))) ' 这里添加每行具体的业务员名单，每行数据在此之后加入
                取行数 ().置文本 (5, 到文本 (四舍五入 (相除 (月销量, 1000000), 3))) ' 这里添加每行具体的业务员名单，每行数据在此之后加入
                取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (年销量, 1000000), 3))) ' 这里添加每行具体的业务员名单，每行数据在此之后加入
                赋值 (办事处小记, 相加 (办事处小记, 四舍五入 (相除 (日销量, 1000000), 3)))
                赋值 (办事处小记1, 相加 (办事处小记1, 四舍五入 (相除 (月销量, 1000000), 3)))
                赋值 (办事处小记2, 相加 (办事处小记2, 四舍五入 (相除 (年销量, 1000000), 3)))
                赋值 (分公司合计, 相加 (分公司合计, 四舍五入 (相除 (日销量, 1000000), 3)))
                赋值 (分公司合计1, 相加 (分公司合计1, 四舍五入 (相除 (月销量, 1000000), 3)))
                赋值 (分公司合计2, 相加 (分公司合计2, 四舍五入 (相除 (年销量, 1000000), 3)))
                赋值 (业务员当前项, 相加 (业务员当前项, 1))
            .计次循环尾 ()
            .如果 (大于 (取数组成员数 (业务员), 1))
                1.添加行 ()
                取行数 ().置文本 (1, 当前片区)
                取行数 ().置文本 (2, 当前办事处)
                取行数 ().置文本 (3, 相加 (当前办事处, “小计”)) ' “办事处小计”数据在此之后加入
                取行数 ().置文本 (4, 到文本 (办事处小记)) ' “办事处小计”数据在此之后加入
                取行数 ().置文本 (5, 到文本 (办事处小记1)) ' “办事处小计”数据在此之后加入
                取行数 ().置文本 (8, 到文本 (办事处小记2)) ' “办事处小计”数据在此之后加入
                赋值 (办事处小记, 0)
                赋值 (办事处小记1, 0)
                赋值 (办事处小记2, 0)
                赋值 (办事处单位数, 相加 (办事处单位数, 取数组成员数 (业务员), 1))
                赋值 (总单位数, 相加 (总单位数, 取数组成员数 (业务员), 1))
            .否则
                赋值 (办事处小记, 0)
                赋值 (办事处小记1, 0)
                赋值 (办事处小记2, 0)
                赋值 (办事处单位数, 相加 (办事处单位数, 取数组成员数 (业务员)))
                赋值 (总单位数, 相加 (总单位数, 取数组成员数 (业务员)))
            .如果结束
            相加 (相减 (取行数 (), 办事处单位数), 1).合并 (2, 办事处单位数, 1) ' 合并办事处
            赋值 (当前办事处数, 相加 (当前办事处数, 1))
        .计次循环尾 ()
        1.添加行 ()
        取行数 ().合并 (2, 1, 2)
        取行数 ().置文本 (1, 当前片区)
        取行数 ().置文本 (2, 相加 (当前片区, “合计”)) ' 每个片区的“合计”数据在此之后加入
        取行数 ().置文本 (4, 到文本 (分公司合计))
        取行数 ().置文本 (5, 到文本 (分公司合计1))
        取行数 ().置文本 (8, 到文本 (分公司合计2))
        赋值 (总合计, 相加 (总合计, 分公司合计))
        赋值 (总合计1, 相加 (总合计1, 分公司合计1))
        赋值 (总合计2, 相加 (总合计2, 分公司合计2))
        赋值 (分公司合计, 0)
        赋值 (分公司合计2, 0)
        赋值 (分公司合计1, 0)
        赋值 (总单位数, 相加 (总单位数, 1))
        相加 (相减 (取行数 (), 总单位数), 1).合并 (1, 总单位数, 1) ' 合并片区
        赋值 (当前片区数, 相加 (当前片区数, 1))
    .计次循环尾 ()
    
    1.添加行 ()
    取行数 ().合并 (1, 1, 3)
    取行数 ().置文本 (1, “合计”) ' “合计”数据在此之后加入
    取行数 ().置文本 (4, 到文本 (总合计))
    取行数 ().置文本 (5, 到文本 (总合计1))
    取行数 ().置文本 (8, 到文本 (总合计2))
    
    取行数 ().置背景色 (1, 1, 取列数 (), #浅灰) ' 设置"合计"背景色
    
    1.添加行 ()
    取行数 ().合并 (1, 1, 取列数 ())
    取行数 ().置文本 (1, “负责人：                                   制表：”) ' 添加表尾
    4.加线条 (1, 相减 (取行数 (), 4), 取列数 (), 63)
    5.置对齐方式 (1, 相减 (取行数 (), 4), 取列数 (), 5)
    5.置字体尺寸 (1, 相减 (取行数 (), 4), 取列数 (), 40)
    5.置边距 (1, 相减 (取行数 (), 4), 取列数 (), 0)
    5.置行高 (相减 (取行数 (), 4), 相除 (2800, 相减 (取行数 (), 4)))
.否则
    
.如果结束
全部关闭 ()
恢复鼠标 ()
赋值 (., 假)
0.置文本 (“”)
赋值 (.数据源, “数据源1”)

.子程序 _表格1_内容被改变, 空白型, , 
.参数 行号, 整数型, , 
.参数 列号, 整数型, , 
.参数 行数, 整数型, , 
.参数 列数, 整数型, , 

.如果 (等于 (列号, 6))
    行号.置文本 (7, 到文本 (四舍五入 (相乘 (相除 (到数值 (行号.取文本 (5)), 到数值 (行号.取文本 (列号))), 100), 3)))
.否则
    
.如果结束
.如果 (等于 (列号, 9))
    行号.置文本 (10, 到文本 (四舍五入 (相乘 (相除 (到数值 (行号.取文本 (8)), 到数值 (行号.取文本 (列号))), 100), 3)))
.否则
    
.如果结束


.子程序 _超级按钮6_被单击, 空白型, , 
.局部变量 当前行号, 整数型, , , 

赋值 (当前行号, 1)
.计次循环首 (取行数 (), )
    .如果 (大于或等于 (当前行号, 5))
        .如果 (不等于 (到数值 (当前行号.取文本 (6)), 0))
            当前行号.置文本 (7, 到文本 (四舍五入 (相乘 (相除 (到数值 (当前行号.取文本 (5)), 到数值 (当前行号.取文本 (6))), 100), 3)))
        .否则
            当前行号.置文本 (7, “”)
        .如果结束
        .如果 (不等于 (到数值 (当前行号.取文本 (9)), 0))
            当前行号.置文本 (10, 到文本 (四舍五入 (相乘 (相除 (到数值 (当前行号.取文本 (8)), 到数值 (当前行号.取文本 (9))), 100), 3)))
        .否则
            当前行号.置文本 (10, “”)
        .如果结束
        
    .否则
        
    .如果结束
    赋值 (当前行号, 相加 (当前行号, 1))
.计次循环尾 ()

.子程序 _超级按钮7_被单击, 空白型, , 
.局部变量 当前行号, 整数型, , , 
.局部变量 月计划数据, 文本型, , , 
.局部变量 年计划数据, 文本型, , , 

赋值 (当前行号, 1)
.计次循环首 (取行数 (), )
    .如果 (等于 (当前行号, 1))
        赋值 (月计划数据, 到文本 (到数值 (当前行号.取文本 (6))))
        赋值 (年计划数据, 到文本 (到数值 (当前行号.取文本 (9))))
    .否则
        赋值 (月计划数据, 相加 (月计划数据, “,”, 到文本 (到数值 (当前行号.取文本 (6)))))
        赋值 (年计划数据, 相加 (年计划数据, “,”, 到文本 (到数值 (当前行号.取文本 (9)))))
    .如果结束
    赋值 (当前行号, 相加 (当前行号, 1))
.计次循环尾 ()
赋值 (.文件名, 1.取文本 (9))
.如果 (等于 (打开 (), 真))
    写配置项 (.文件名, “月计划”, “数值”, 月计划数据)
    写配置项 (.文件名, “年计划”, “数值”, 年计划数据)
.否则
    
.如果结束


.子程序 _超级按钮9_被单击, 空白型, , 
.局部变量 当前行号, 整数型, , , 
.局部变量 月计划数据, 文本型, , "0", 
.局部变量 年计划数据, 文本型, , "0", 
.局部变量 循环次数, 整数型, , , 

赋值 (当前行号, 1)
.如果 (等于 (打开 (), 真))
    .如果 (不等于 (.文件名, “”))
        赋值 (月计划数据, 分割文本 (读配置项 (.文件名, “月计划”, “数值”, ), “,”, ))
        赋值 (年计划数据, 分割文本 (读配置项 (.文件名, “年计划”, “数值”, ), “,”, ))
        .如果 (不等于 (取行数 (), 取数组成员数 (月计划数据)))
            .如果 (等于 (信息框 (“要导入的计划数据与当前日报表数据可能不符,要继续么?”, 4, ), 6))
                返回 ()
            .否则
                
            .如果结束
            
        .否则
            
        .如果结束
        .计次循环首 (取行数 (), )
            .如果 (大于或等于 (当前行号, 5))
                当前行号.置文本 (6, “”)
                当前行号.置文本 (7, “”)
                当前行号.置文本 (9, “”)
                当前行号.置文本 (10, “”)
            .否则
                
            .如果结束
            赋值 (当前行号, 相加 (当前行号, 1))
        .计次循环尾 ()
        赋值 (循环次数, 选择 (小于 (取数组成员数 (月计划数据), 取行数 ()), 取数组成员数 (月计划数据), 取行数 ()))
        赋值 (当前行号, 1)
        .计次循环首 (循环次数, )
            .如果 (大于或等于 (当前行号, 5))
                .如果 (不等于 (月计划数据 [当前行号], “0”))
                    当前行号.置文本 (6, 月计划数据 [当前行号])
                .否则
                    
                .如果结束
                .如果 (不等于 (年计划数据 [当前行号], “0”))
                    当前行号.置文本 (9, 年计划数据 [当前行号])
                .否则
                    
                .如果结束
                
            .否则
                
            .如果结束
            赋值 (当前行号, 相加 (当前行号, 1))
        .计次循环尾 ()
        _超级按钮6_被单击 ()
    .否则
        
    .如果结束
    
.否则
    
.如果结束


.子程序 _超级按钮8_被单击, 空白型, , 
.局部变量 临时文件名1, 文本型, , , 
.局部变量 临时文件名, 文本型, , , 

赋值 (.文件名, 相加 (1.取文本 (9), “销售日报表”))
.如果 (等于 (打开 (), 真))
    赋值 (临时文件名, 取临时文件名 ())
    .如果 (等于 (临时文件名.存到文件 (), 真))
        0.置表头行数 ()
        1.清除 (1, 3, 取列数 ())
        5.添加行 ()
        赋值 (临时文件名1, 取临时文件名 ())
        .如果 (等于 (临时文件名1.存到文件 (), 真))
            .如果 (等于 (转换数据 (临时文件名1, 1, .文件名), 真))
                信息框 (“该报表数据已经成功转换为EXCEL文件！”, 0, )
            .否则
                信息框 (“该报表数据暂时不能转换为EXCEL文件，请稍后再试！”, 16, )
            .如果结束
            删除文件 (临时文件名1)
        .否则
            信息框 (“该报表数据暂时不能转换为EXCEL文件，请稍后再试！”, 0, )
        .如果结束
        临时文件名.从文件读 ()
        删除文件 (临时文件名)
    .否则
        信息框 (“该报表数据暂时不能转换为EXCEL文件，请稍后再试！”, 0, )
    .如果结束
    
.否则
    
.如果结束


.子程序 _日期框1_选择日期被改变, 空白型, , 
.局部变量 起日期, 文本型, , , 
.局部变量 临时变量, 整数型, , , 
.局部变量 止日期, 文本型, , , 

.计次循环首 (12, 临时变量)
    赋值 (起日期, 读配置项 (相加 (当前目录, “data\yuefen.ini”), 相加 (到文本 (临时变量), “月份”), “起日期”, “”))
    赋值 (止日期, 读配置项 (相加 (当前目录, “data\yuefen.ini”), 相加 (到文本 (临时变量), “月份”), “止日期”, “”))
    .如果 (并且 (不等于 (起日期, “”), 不等于 (止日期, “”)))
        .如果 (并且 (大于或等于 (取日期 (.今天), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 起日期))), 小于或等于 (取日期 (.今天), 到时间 (相加 (到文本 (取年份 (.今天)), “年”, 止日期)))))
            赋值 (.内容, 到文本 (临时变量))
            赋值 (.内容, 起日期)
            赋值 (.内容, 止日期)
            跳出循环 ()
        .否则
            
        .如果结束
        
    .否则
        信息框 (“月份划分时间表未正确配置，请先正确配置月份，否则无法进行正确计算！”, 48, )
        跳出循环 ()
    .如果结束
    
.计次循环尾 ()

.窗口程序集 窗口程序集15, , , 

.子程序 _运输单位_创建完毕, 空白型, , 
运输单位刷新 ()
车辆刷新 ()

.子程序 运输单位刷新, 空白型, , 
.局部变量 临时变量, 整数型, , , 

赋值 (临时变量, 1)
清空 ()
.计次循环首 (到数值 (读配置项 (相加 (当前目录, “data\ysdw.ldb”), “单位”, “总数”, “0”)), )
    读配置项 (相加 (当前目录, “data\ysdw.ldb”), “单位”, 相加 (“vol”, 到文本 (临时变量)), ).加入项目 ()
    赋值 (临时变量, 相加 (临时变量, 1))
.计次循环尾 ()
赋值 (.现行选中项, 0)

.子程序 _按钮3_被单击, 空白型, , 
.局部变量 临时变量, 文本型, , , 
.局部变量 临时数, 整数型, , , 
.局部变量 是否重名, 逻辑型, , , 

.如果 (等于 (输入框 (“请输入单位名称”, “新建运输”, , 临时变量, ), 真))
    .如果 (不等于 (临时变量, “”))
        赋值 (临时数, 0)
        赋值 (是否重名, 假)
        .计次循环首 (取项目数 (), )
            .如果 (等于 (临时数.取项目文本 (), 临时变量))
                赋值 (是否重名, 真)
                跳出循环 ()
            .否则
                赋值 (临时数, 相加 (临时数, 1))
            .如果结束
            
        .计次循环尾 ()
        .如果 (等于 (是否重名, 假))
            写配置项 (相加 (当前目录, “data\ysdw.ldb”), “单位”, “总数”, 到文本 (相加 (到数值 (读配置项 (相加 (当前目录, “data\ysdw.ldb”), “单位”, “总数”, “0”)), 1)))
            写配置项 (相加 (当前目录, “data\ysdw.ldb”), “单位”, 相加 (“vol”, 读配置项 (相加 (当前目录, “data\ysdw.ldb”), “单位”, “总数”, )), 临时变量)
            运输单位刷新 ()
            车辆刷新 ()
        .否则
            信息框 (“已经有同名运输单位存在，不能重复添加！”, 0, )
        .如果结束
        
    .否则
        
    .如果结束
    
.否则
    
.如果结束



.子程序 _按钮1_被单击, 空白型, , 
.局部变量 临时变量, 整数型, , , 
.局部变量 删除单位, 文本型, , , 

赋值 (临时变量, 1)
赋值 (删除单位, .取项目文本 (.现行选中项))
.如果 (不等于 (.现行选中项, -1))
    写配置项 (相加 (当前目录, “data\ysdw.ldb”), 删除单位, , )
    写配置项 (相加 (当前目录, “data\ysdw.ldb”), “单位”, , )
    .删除项目 (.现行选中项)
    写配置项 (相加 (当前目录, “data\ysdw.ldb”), “单位”, “总数”, 到文本 (取项目数 ()))
    .计次循环首 (取项目数 (), )
        写配置项 (相加 (当前目录, “data\ysdw.ldb”), “单位”, 相加 (“vol”, 到文本 (临时变量)), 相减 (临时变量, 1).取项目文本 ())
        赋值 (临时变量, 相加 (临时变量, 1))
    .计次循环尾 ()
    运输单位刷新 ()
    车辆刷新 ()
.否则
    
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 临时变量, 整数型, , , 
.局部变量 是否重名, 逻辑型, , , 

.如果 (并且 (不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (.现行选中项, -1)))
    赋值 (临时变量, 1)
    赋值 (是否重名, 假)
    .计次循环首 (取表项数 (), )
        .如果 (等于 (临时变量.取标题 (), .内容))
            赋值 (是否重名, 真)
            跳出循环 ()
        .否则
            
        .如果结束
        赋值 (临时变量, 相加 (临时变量, 1))
    .计次循环尾 ()
    .如果 (等于 (是否重名, 假))
        写配置项 (相加 (当前目录, “data\ysdw.ldb”), .取项目文本 (.现行选中项), “总数”, 到文本 (相加 (取表项数 (), 1)))
        写配置项 (相加 (当前目录, “data\ysdw.ldb”), .取项目文本 (.现行选中项), 相加 (“ch”, 到文本 (相加 (取表项数 (), 1))), .内容)
        写配置项 (相加 (当前目录, “data\ysdw.ldb”), .取项目文本 (.现行选中项), 相加 (“dh”, 到文本 (相加 (取表项数 (), 1))), .内容)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        获取焦点 ()
        车辆刷新 ()
    .否则
        信息框 (“该车号已经登记,请输入其他车辆信息!”, 0, )
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        获取焦点 ()
    .如果结束
    
.否则
    信息框 (“请输入完整的车辆信息,并选择正确的单位!”, 0, )
.如果结束


.子程序 车辆刷新, 空白型, , 
.局部变量 车辆数, 整数型, , , 

全部删除 ()
.如果 (不等于 (.现行选中项, -1))
    赋值 (车辆数, 1)
    .计次循环首 (到数值 (读配置项 (相加 (当前目录, “data\ysdw.ldb”), .取项目文本 (.现行选中项), “总数”, “0”)), )
        .插入表项 (读配置项 (相加 (当前目录, “data\ysdw.ldb”), .取项目文本 (.现行选中项), 相加 (“ch”, 到文本 (车辆数)), ), , , , )
        相减 (取表项数 (), 1).置标题 (1, 读配置项 (相加 (当前目录, “data\ysdw.ldb”), .取项目文本 (.现行选中项), 相加 (“dh”, 到文本 (车辆数)), ))
        赋值 (车辆数, 相加 (车辆数, 1))
    .计次循环尾 ()
    
.否则
    
.如果结束


.子程序 _列表框1_列表项被选择, 空白型, , 
车辆刷新 ()

.子程序 _按钮5_被单击, 空白型, , 
.局部变量 临时变量, 整数型, , , 
.局部变量 删除车辆, 文本型, , , 

.如果 (并且 (不等于 (.现行选中项, -1), 不等于 (., -1)))
    赋值 (临时变量, 1)
    赋值 (删除车辆, .取项目文本 (.现行选中项))
    .如果 (不等于 (.现行选中项, -1))
        写配置项 (相加 (当前目录, “data\ysdw.ldb”), .取项目文本 (.现行选中项), , )
        .删除表项 (.)
        写配置项 (相加 (当前目录, “data\ysdw.ldb”), .取项目文本 (.现行选中项), “总数”, 到文本 (取表项数 ()))
        .计次循环首 (取表项数 (), )
            写配置项 (相加 (当前目录, “data\ysdw.ldb”), .取项目文本 (.现行选中项), 相加 (“ch”, 到文本 (临时变量)), 相减 (临时变量, 1).取标题 (0))
            写配置项 (相加 (当前目录, “data\ysdw.ldb”), .取项目文本 (.现行选中项), 相加 (“dh”, 到文本 (临时变量)), 相减 (临时变量, 1).取标题 (1))
            赋值 (临时变量, 相加 (临时变量, 1))
        .计次循环尾 ()
        车辆刷新 ()
    .否则
        
    .如果结束
    
.否则
    
.如果结束


.子程序 _按钮6_被单击, 空白型, , 
运输单位.销毁 ()

.窗口程序集 窗口程序集16, , , 

.子程序 _购货品种_创建完毕, 空白型, , 
.局部变量 临时变量, 文本型, , , 

.如果 (等于 (打开 (相加 (当前目录, “data\index.ldb”), , , , , “lgq”, ), 真))
    到首记录 ()
    .如果 (等于 (查找 (等于 (读 (“名称”), 单据录入..内容)), 真))
        赋值 (临时变量, 到文本 (读 (“编号”)))
    .否则
        
    .如果结束
    
.否则
    
.如果结束
全部关闭 ()
.如果 (等于 (打开 (相加 (当前目录, “data\data\”, 临时变量, “.ldb”), , , , , “lgq”, ), 真))
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .插入表项 (读 (“编号”), , , , )
        相减 (取表项数 (), 1).置标题 (1, 读 (“品种”))
        相减 (取表项数 (), 1).置标题 (2, 读 (“浓度”))
        相减 (取表项数 (), 1).置标题 (3, 读 (“规格”))
        相减 (取表项数 (), 1).置标题 (4, 读 (“单位”))
        相减 (取表项数 (), 1).置标题 (5, 到文本 (读 (“净水价格”)))
        相减 (取表项数 (), 1).置标题 (6, 到文本 (读 (“瓶子押金”)))
        相减 (取表项数 (), 1).置标题 (7, 到文本 (读 (“运率”)))
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
.如果真 (等于 (., -1))
    返回 ()
.如果真结束
.如果真 (等于 (单据录入., 1))
    赋值 (单据录入..内容, .取标题 (., 0))
    赋值 (单据录入..内容, .取标题 (., 1))
    赋值 (单据录入..内容, .取标题 (., 3))
    赋值 (单据录入..内容, .取标题 (., 2))
    赋值 (单据录入..内容, .取标题 (., 4))
    赋值 (单据录入..内容, .取标题 (., 5))
    赋值 (单据录入..内容, .取标题 (., 6))
    赋值 (单据录入..内容, .取标题 (., 7))
    赋值 (单据录入..内容, 到文本 (相乘 (到数值 (单据录入..内容), 到数值 (单据录入..内容))))
    赋值 (单据录入..内容, 到文本 (相乘 (到数值 (单据录入..内容), 到数值 (单据录入..内容))))
    赋值 (单据录入..内容, 到文本 (相乘 (到数值 (单据录入..内容), 到数值 (单据录入..内容))))
    赋值 (单据录入..内容, 到文本 (相加 (到数值 (单据录入..内容), 到数值 (单据录入..内容), 到数值 (单据录入..内容))))
    单据录入.金额合计 ()
    单据录入._配送方式_列表项被选择 ()
    销毁 ()
.如果真结束
.如果真 (等于 (单据录入., 2))
    赋值 (单据录入..内容, .取标题 (., 0))
    赋值 (单据录入..内容, .取标题 (., 1))
    赋值 (单据录入..内容, .取标题 (., 3))
    赋值 (单据录入..内容, .取标题 (., 2))
    赋值 (单据录入..内容, .取标题 (., 4))
    赋值 (单据录入..内容, .取标题 (., 5))
    赋值 (单据录入..内容, .取标题 (., 6))
    赋值 (单据录入..内容, .取标题 (., 7))
    赋值 (单据录入..内容, 到文本 (相乘 (到数值 (单据录入..内容), 到数值 (单据录入..内容))))
    赋值 (单据录入..内容, 到文本 (相乘 (到数值 (单据录入..内容), 到数值 (单据录入..内容))))
    赋值 (单据录入..内容, 到文本 (相乘 (到数值 (单据录入..内容), 到数值 (单据录入..内容))))
    赋值 (单据录入..内容, 到文本 (相加 (到数值 (单据录入..内容), 到数值 (单据录入..内容), 到数值 (单据录入..内容))))
    单据录入.金额合计 ()
    单据录入._配送方式_列表项被选择 ()
    销毁 ()
.如果真结束
.如果真 (等于 (单据录入., 3))
    赋值 (单据录入..内容, .取标题 (., 0))
    赋值 (单据录入..内容, .取标题 (., 1))
    赋值 (单据录入..内容, .取标题 (., 3))
    赋值 (单据录入..内容, .取标题 (., 2))
    赋值 (单据录入..内容, .取标题 (., 4))
    赋值 (单据录入..内容, .取标题 (., 5))
    赋值 (单据录入..内容, .取标题 (., 6))
    赋值 (单据录入..内容, .取标题 (., 7))
    赋值 (单据录入..内容, 到文本 (相乘 (到数值 (单据录入..内容), 到数值 (单据录入..内容))))
    赋值 (单据录入..内容, 到文本 (相乘 (到数值 (单据录入..内容), 到数值 (单据录入..内容))))
    赋值 (单据录入..内容, 到文本 (相乘 (到数值 (单据录入..内容), 到数值 (单据录入..内容))))
    赋值 (单据录入..内容, 到文本 (相加 (到数值 (单据录入..内容), 到数值 (单据录入..内容), 到数值 (单据录入..内容))))
    单据录入.金额合计 ()
    单据录入._配送方式_列表项被选择 ()
    销毁 ()
.如果真结束
.如果真 (等于 (单据录入., 4))
    赋值 (单据录入..内容, .取标题 (., 0))
    赋值 (单据录入..内容, .取标题 (., 1))
    赋值 (单据录入..内容, .取标题 (., 3))
    赋值 (单据录入..内容, .取标题 (., 2))
    赋值 (单据录入..内容, .取标题 (., 4))
    赋值 (单据录入..内容, .取标题 (., 5))
    赋值 (单据录入..内容, .取标题 (., 6))
    赋值 (单据录入..内容, .取标题 (., 7))
    赋值 (单据录入..内容, 到文本 (相乘 (到数值 (单据录入..内容), 到数值 (单据录入..内容))))
    赋值 (单据录入..内容, 到文本 (相乘 (到数值 (单据录入..内容), 到数值 (单据录入..内容))))
    赋值 (单据录入..内容, 到文本 (相乘 (到数值 (单据录入..内容), 到数值 (单据录入..内容))))
    赋值 (单据录入..内容, 到文本 (相加 (到数值 (单据录入..内容), 到数值 (单据录入..内容), 到数值 (单据录入..内容))))
    单据录入.金额合计 ()
    单据录入._配送方式_列表项被选择 ()
    销毁 ()
.如果真结束


.子程序 _超级列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_按钮1_被单击 ()

.子程序 _按钮2_被单击, 空白型, , 
.如果真 (等于 (单据录入., 1))
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    单据录入.金额合计 ()
    销毁 ()
.如果真结束
.如果真 (等于 (单据录入., 2))
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    单据录入.金额合计 ()
    销毁 ()
.如果真结束
.如果真 (等于 (单据录入., 3))
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    单据录入.金额合计 ()
    销毁 ()
.如果真结束
.如果真 (等于 (单据录入., 4))
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    赋值 (单据录入..内容, “”)
    单据录入.金额合计 ()
    销毁 ()
.如果真结束


.窗口程序集 窗口程序集17, , , 

.子程序 _业务员管理_创建完毕, 空白型, , 
赋值 (.数据库文件名, 相加 (当前目录, “data\ywy.ldb”))
.如果 (等于 (取行数 (), 0))
    .添加行 ()
.否则
    
.如果结束


.子程序 _添加空记录_被选择, 空白型, , 
1.添加行 ()

.子程序 _删除本条记录_被选择, 空白型, , 
取光标行号 ().删除行 (1)

.子程序 _表格1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出托盘菜单 ()

.子程序 _删除选择记录_被选择, 空白型, , 
取光标行号 ().删除行 (取选择行数 ())

.子程序 _删除所有记录_被选择, 空白型, , 
1.删除行 (取行数 ())

.子程序 _表格1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 46))
    取光标行号 ().删除行 (取选择行数 ())
.否则
    .如果 (等于 (键代码, 45))
        1.添加行 ()
    .否则
        
    .如果结束
    
.如果结束


.子程序 _清空选择区数据_被选择, 空白型, , 
取光标行号 ().清除 (取光标列号 (), 取选择行数 (), 取选择列数 ())

.子程序 _复制_被选择, 空白型, , 
取光标行号 ().复制 (取光标列号 (), 取选择行数 (), 取选择列数 ())

.子程序 _粘贴_被选择, 空白型, , 
粘贴到光标处 ()

.子程序 _按钮1_被单击, 空白型, , 
业务员管理.销毁 ()

.窗口程序集 窗口程序集18, , , 

.子程序 _选择单位_创建完毕, 空白型, , 
.如果 (等于 (打开 (相加 (当前目录, “data\index.ldb”), , , , , “lgq”, ), 真))
    片区刷新 ()
    办事处刷新 ()
    单位刷新 ()
.否则
    信息框 (相加 (“数据库损坏，请恢复系统数据库！”, #换行符, “如果问题不能解决，建议初始化数据库或重新安装系统！”), 0, )
    选择单位.销毁 ()
.如果结束


.子程序 _片区_列表项被选择, 空白型, , 
办事处刷新 ()
单位刷新 ()

.子程序 _办事处_列表项被选择, 空白型, , 
单位刷新 ()

.子程序 单位刷新, 空白型, , 
全部删除 ()
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (并且 (等于 (读 (“所属片区”), .取项目文本 (.现行选中项)), 等于 (读 (“所属办事处”), .取项目文本 (.现行选中项))))
        -1.插入表项 (读 (“编号”), , , , )
        相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
        相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
        相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
        相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
        相减 (取表项数 (), 1).置标题 (5, 读 (“业务编码”))
    .否则
        
    .如果结束
    跳过 ()
.判断循环尾 ()

.子程序 _单位_当前表项被改变, 空白型, , 
.如果 (不等于 (., -1))
    到首记录 ()
    .如果 (等于 (查找 (等于 (读 (“编号”), .取标题 (., 0))), 真))
        赋值 (.内容, 读 (“所属片区”))
        赋值 (.内容, 读 (“所属办事处”))
    .否则
        
    .如果结束
    
.否则
    
.如果结束


.子程序 片区刷新, 空白型, , 
.局部变量 临时变量, 整数型, , , 

赋值 (临时变量, 1)
清空 ()
.计次循环首 (到数值 (读配置项 (相加 (当前目录, “data\pq.ldb”), “片区”, “总数”, “0”)), )
    读配置项 (相加 (当前目录, “data\pq.ldb”), “片区”, 相加 (“vol”, 到文本 (临时变量)), ).加入项目 ()
    赋值 (临时变量, 相加 (临时变量, 1))
.计次循环尾 ()
赋值 (.现行选中项, 0)

.子程序 办事处刷新, 空白型, , 
.局部变量 临时变量, 整数型, , , 
.局部变量 当前片区, 文本型, , , 

赋值 (临时变量, 1)
清空 ()
.计次循环首 (到数值 (读配置项 (相加 (当前目录, “data\pq.ldb”), .取项目文本 (.现行选中项), “总数”, “0”)), )
    读配置项 (相加 (当前目录, “data\pq.ldb”), .取项目文本 (.现行选中项), 相加 (“vol”, 到文本 (临时变量)), ).加入项目 ()
    赋值 (临时变量, 相加 (临时变量, 1))
.计次循环尾 ()
赋值 (.现行选中项, 0)

.子程序 _编辑框8_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    全部删除 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (不等于 (寻找文本 (读 (“业务编码”), .内容, , 真), -1))
            -1.插入表项 (读 (“编号”), , , , )
            相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
            相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
            相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
            相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
            相减 (取表项数 (), 1).置标题 (5, 读 (“业务编码”))
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束



.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    全部删除 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (等于 (读 (“编号”), .内容))
            -1.插入表项 (读 (“编号”), , , , )
            相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
            相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
            相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
            相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
            相减 (取表项数 (), 1).置标题 (5, 读 (“业务编码”))
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束


.子程序 _编辑框2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    全部删除 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (不等于 (寻找文本 (读 (“名称”), .内容, , 真), -1))
            -1.插入表项 (读 (“编号”), , , , )
            相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
            相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
            相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
            相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
            相减 (取表项数 (), 1).置标题 (5, 读 (“业务编码”))
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束


.子程序 _编辑框3_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    全部删除 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (不等于 (寻找文本 (读 (“缩写”), .内容, , 真), -1))
            -1.插入表项 (读 (“编号”), , , , )
            相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
            相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
            相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
            相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
            相减 (取表项数 (), 1).置标题 (5, 读 (“业务编码”))
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束


.子程序 _编辑框4_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    全部删除 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (不等于 (寻找文本 (读 (“联系人”), .内容, , 真), -1))
            -1.插入表项 (读 (“编号”), , , , )
            相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
            相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
            相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
            相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
            相减 (取表项数 (), 1).置标题 (5, 读 (“业务编码”))
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束


.子程序 _编辑框5_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    全部删除 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (不等于 (寻找文本 (读 (“电话”), .内容, , 真), -1))
            -1.插入表项 (读 (“编号”), , , , )
            相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
            相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
            相减 (取表项数 (), 1).置标题 (3, 读 (“联系人”))
            相减 (取表项数 (), 1).置标题 (4, 读 (“电话”))
            相减 (取表项数 (), 1).置标题 (5, 读 (“业务编码”))
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束


.子程序 _选择单位_将被销毁, 空白型, , 
全部关闭 ()

.子程序 _按钮11_被单击, 空白型, , 
.如果 (不等于 (., -1))
    赋值 (单据录入..内容, .取标题 (., 0))
    赋值 (单据录入..内容, .取标题 (., 1))
    赋值 (单据录入..内容, .取标题 (., 3))
    赋值 (单据录入..内容, .取标题 (., 4))
    赋值 (单据录入..内容, .取标题 (., 5))
    销毁 ()
.否则
    
.如果结束


.子程序 _单位_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_按钮11_被单击 ()

.子程序 _按钮2_被单击, 空白型, , 
选择单位.销毁 ()

.窗口程序集 窗口程序集19, , , 

.程序集变量 是否停止, 逻辑型, , , 
.子程序 _按钮2_被单击, 空白型, , 
赋值 (.今天, 取现行时间 ())
赋值 (.今天, 取现行时间 ())
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.内容, “”)
赋值 (.选中, 假)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 间隔日, 双精度小数型, , , 
.局部变量 间隔年, 双精度小数型, , , 
.局部变量 当前年, 整数型, , , 
.局部变量 满足条件, 逻辑型, , , 

赋值 (是否停止, 假)
置等待鼠标 ()
清空 ()
赋值 (间隔年, 取时间间隔 (.今天, .今天, 1))
赋值 (间隔日, 取时间间隔 (.今天, .今天, 5))
.如果 (大于或等于 (间隔日, 0))
    赋值 (当前年, 取年份 (.今天))
    .计次循环首 (相加 (取整 (间隔年), 1), )
        .如果 (等于 (打开 (相加 (当前目录, “data\save\”, 到文本 (当前年), “.ldb”), , , , , “lgq”, ), 真))
            到首记录 ()
            .如果 (等于 (查找 (大于或等于 (到时间 (读 (“日期”)), 取日期 (.今天))), 假))
                到循环尾 ()
            .否则
                
            .如果结束
            .判断循环首 (等于 (尾记录后 (), 假))
                处理事件 ()
                .如果 (等于 (是否停止, 真))
                    全部关闭 ()
                    0.置文本 (“处理被中断”)
                    返回 ()
                .否则
                    置等待鼠标 ()
                .如果结束
                赋值 (满足条件, 真)
                0.置文本 (相加 (“正在处理：”, 读 (“编号”)))
                .如果 (并且 (大于或等于 (到时间 (读 (“日期”)), 取日期 (.今天)), 小于或等于 (到时间 (读 (“日期”)), 取日期 (.今天))))
                    .如果 (等于 (.选中, 真))
                        .如果 (等于 (读 (“作废”), 真))
                            
                        .否则
                            赋值 (满足条件, 假)
                        .如果结束
                        
                    .否则
                        
                    .如果结束
                    .如果 (等于 (.选中, 真))
                        .如果 (等于 (读 (“反冲”), 真))
                            .如果 (不等于 (.内容, “”))
                                .如果 (等于 (读 (“反冲单据号”), .内容))
                                    
                                .否则
                                    赋值 (满足条件, 假)
                                .如果结束
                                
                            .否则
                                
                            .如果结束
                            
                        .否则
                            赋值 (满足条件, 假)
                        .如果结束
                        
                    .否则
                        
                    .如果结束
                    .如果 (等于 (.选中, 真))
                        .如果 (等于 (读 (“被反冲”), 真))
                            .如果 (不等于 (.内容, “”))
                                .如果 (等于 (读 (“被反冲单据号”), .内容))
                                    
                                .否则
                                    赋值 (满足条件, 假)
                                .如果结束
                                
                            .否则
                                
                            .如果结束
                            
                        .否则
                            赋值 (满足条件, 假)
                        .如果结束
                        
                    .否则
                        
                    .如果结束
                    .如果 (不等于 (.内容, “”))
                        .如果 (等于 (读 (“编号”), .内容))
                            
                        .否则
                            赋值 (满足条件, 假)
                        .如果结束
                        
                    .否则
                        
                    .如果结束
                    .如果 (不等于 (.内容, “”))
                        .如果 (等于 (读 (“单位编号”), .内容))
                            
                        .否则
                            赋值 (满足条件, 假)
                        .如果结束
                        
                    .否则
                        
                    .如果结束
                    .如果 (不等于 (.内容, “”))
                        .如果 (或者 (等于 (到小写 (读 (“产品编号1”)), 到小写 (.内容)), 等于 (到小写 (读 (“产品编号2”)), 到小写 (.内容)), 等于 (到小写 (读 (“产品编号3”)), 到小写 (.内容)), 等于 (到小写 (读 (“产品编号4”)), 到小写 (.内容))))
                            
                        .否则
                            赋值 (满足条件, 假)
                        .如果结束
                        
                    .否则
                        
                    .如果结束
                    .如果 (不等于 (.内容, “”))
                        .如果 (等于 (读 (“购货单位”), .内容))
                            
                        .否则
                            赋值 (满足条件, 假)
                        .如果结束
                        
                    .否则
                        
                    .如果结束
                    .如果 (不等于 (.内容, “”))
                        .如果 (等于 (读 (“业务编码”), .内容))
                            
                        .否则
                            赋值 (满足条件, 假)
                        .如果结束
                        
                    .否则
                        
                    .如果结束
                    .如果 (不等于 (.内容, “”))
                        .如果 (等于 (读 (“运输单位”), .内容))
                            
                        .否则
                            赋值 (满足条件, 假)
                        .如果结束
                        
                    .否则
                        
                    .如果结束
                    .如果 (不等于 (.内容, “”))
                        .如果 (等于 (读 (“配送方式”), .内容))
                            
                        .否则
                            赋值 (满足条件, 假)
                        .如果结束
                        
                    .否则
                        
                    .如果结束
                    .如果 (不等于 (.内容, “”))
                        .如果 (等于 (读 (“制单”), .内容))
                            
                        .否则
                            赋值 (满足条件, 假)
                        .如果结束
                        
                    .否则
                        
                    .如果结束
                    .如果 (等于 (满足条件, 真))
                        读 (“编号”).加入项目 ()
                    .否则
                        
                    .如果结束
                    
                .否则
                    
                .如果结束
                跳过 ()
            .判断循环尾 ()
        .否则
            
        .如果结束
        全部关闭 ()
        赋值 (当前年, 相加 (当前年, 1))
    .计次循环尾 ()
    信息框 (相加 (“查询完毕，共找到”, 到文本 (取项目数 ()), “条满足查询条件的记录！”), 0, )
    0.置文本 (相加 (“查询完毕，共找到”, 到文本 (取项目数 ()), “条满足查询条件的记录！”))
.否则
    信息框 (“日期设置错误,请确定截止日期晚于开始日期！”, 0, )
.如果结束
全部关闭 ()
赋值 (是否停止, 真)

.子程序 _查询结果_列表项被选择, 空白型, , 
.局部变量 数据库名, 文本型, , , 
.局部变量 记录编号, 文本型, , , 

.如果 (不等于 (.现行选中项, -1))
    置等待鼠标 ()
    赋值 (数据库名, 相加 (当前目录, “data\save\”, 取文本左边 (.取项目文本 (.现行选中项), 4), “.ldb”))
    赋值 (记录编号, .取项目文本 (.现行选中项))
    .如果 (等于 (打开 (数据库名, , , , , “lgq”, ), 真))
        新建索引 (相加 (当前目录, “data\save\”, 取文本左边 (.取项目文本 (.现行选中项), 4), “.enx”), , , , “编号”)
        到首记录 ()
        .如果 (等于 (索引查找 (记录编号), 真))
            赋值 (.内容, 读 (“产品编号4”))
            赋值 (.内容, 读 (“产品编号3”))
            赋值 (.内容, 读 (“产品编号2”))
            赋值 (.内容, 读 (“产品编号1”))
            赋值 (.内容, 读 (“单位编号”))
            赋值 (.内容, 读 (“编号”))
            赋值 (.内容, 读 (“日期”))
            赋值 (.内容, 读 (“购货单位”))
            赋值 (.内容, 读 (“联系人”))
            赋值 (.内容, 读 (“电话”))
            赋值 (.内容, 读 (“业务编码”))
            赋值 (.内容, 读 (“运输单位”))
            赋值 (.内容, 读 (“车号”))
            赋值 (.内容, 读 (“品种1”))
            赋值 (.内容, 读 (“浓度1”))
            赋值 (.内容, 读 (“规格1”))
            赋值 (.内容, 读 (“单位1”))
            赋值 (.内容, 读 (“数量1”))
            赋值 (.内容, 读 (“净水价格1”))
            赋值 (.内容, 读 (“净水总价1”))
            赋值 (.内容, 读 (“瓶子押金1”))
            赋值 (.内容, 读 (“押金总价1”))
            赋值 (.内容, 读 (“运率1”))
            赋值 (.内容, 读 (“运费总价1”))
            赋值 (.内容, 读 (“合计1”))
            赋值 (.内容, 读 (“品种2”))
            赋值 (.内容, 读 (“浓度2”))
            赋值 (.内容, 读 (“规格2”))
            赋值 (.内容, 读 (“单位2”))
            赋值 (.内容, 读 (“数量2”))
            赋值 (.内容, 读 (“净水价格2”))
            赋值 (.内容, 读 (“净水总价2”))
            赋值 (.内容, 读 (“瓶子押金2”))
            赋值 (.内容, 读 (“押金总价2”))
            赋值 (.内容, 读 (“运率2”))
            赋值 (.内容, 读 (“运费总价2”))
            赋值 (.内容, 读 (“合计2”))
            赋值 (.内容, 读 (“品种3”))
            赋值 (.内容, 读 (“浓度3”))
            赋值 (.内容, 读 (“规格3”))
            赋值 (.内容, 读 (“单位3”))
            赋值 (.内容, 读 (“数量3”))
            赋值 (.内容, 读 (“净水价格3”))
            赋值 (.内容, 读 (“净水总价3”))
            赋值 (.内容, 读 (“瓶子押金3”))
            赋值 (.内容, 读 (“押金总价3”))
            赋值 (.内容, 读 (“运率3”))
            赋值 (.内容, 读 (“运费总价3”))
            赋值 (.内容, 读 (“合计3”))
            赋值 (.内容, 读 (“品种4”))
            赋值 (.内容, 读 (“浓度4”))
            赋值 (.内容, 读 (“规格4”))
            赋值 (.内容, 读 (“单位4”))
            赋值 (.内容, 读 (“数量4”))
            赋值 (.内容, 读 (“净水价格4”))
            赋值 (.内容, 读 (“净水总价4”))
            赋值 (.内容, 读 (“瓶子押金4”))
            赋值 (.内容, 读 (“押金总价4”))
            赋值 (.内容, 读 (“运率4”))
            赋值 (.内容, 读 (“运费总价4”))
            赋值 (.内容, 读 (“合计4”))
            赋值 (.内容, 读 (“合计”))
            赋值 (.内容, 读 (“十万”))
            赋值 (.内容, 读 (“万”))
            赋值 (.内容, 读 (“千”))
            赋值 (.内容, 读 (“百”))
            赋值 (.内容, 读 (“十”))
            赋值 (.内容, 读 (“元”))
            赋值 (.内容, 读 (“角”))
            赋值 (.内容, 读 (“分”))
            赋值 (.内容, 读 (“配送方式”))
            赋值 (.内容, 读 (“制单”))
            赋值 (.选中, 读 (“作废”))
            赋值 (.选中, 读 (“反冲”))
            赋值 (.内容, 读 (“反冲单据号”))
            赋值 (.选中, 读 (“被反冲”))
            赋值 (.内容, 读 (“被反冲单据号”))
            赋值 (.内容, “”)
            .如果 (等于 (.选中, 真))
                赋值 (.内容, “作废”)
            .否则
                .如果 (等于 (.选中, 真))
                    赋值 (.内容, “反冲”)
                .否则
                    .如果 (等于 (.选中, 真))
                        赋值 (.内容, “被冲”)
                    .否则
                        
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    恢复鼠标 ()
.否则
    
.如果结束
全部关闭 ()

.子程序 _按钮3_被单击, 空白型, , 
.局部变量 数据库名, 文本型, , , 
.局部变量 记录编号, 文本型, , , 

.如果 (不等于 (.现行选中项, -1))
    赋值 (数据库名, 相加 (当前目录, “data\save\”, 取文本左边 (.取项目文本 (.现行选中项), 4), “.ldb”))
    赋值 (记录编号, .取项目文本 (.现行选中项))
    .如果 (等于 (打开 (数据库名, , , , , “lgq”, ), 真))
        到首记录 ()
        .如果 (等于 (查找 (等于 (读 (“编号”), 记录编号)), 真))
            .如果 (并且 (不等于 (读 (“反冲”), 真), 不等于 (读 (“被反冲”), 真), 不等于 (读 (“作废”), 真)))
                .如果 (不等于 (信息框 (相加 (“您确定要作废处理本张单据么？”, #换行符, “注意：作废处理后将不可恢复！”), 1, ), 0))
                    全部关闭 ()
                    返回 ()
                .否则
                    
                .如果结束
                修改 (真, , , , , , , , , )
                全部关闭 ()
                写日志 (相加 (到文本 (取现行时间 ()), “//”, 当前用户, “作废单据”, .内容))
                _查询结果_列表项被选择 ()
                信息框 (“操作成功,本张单据已经作废!”, 0, )
            .否则
                信息框 (相加 (“操作失败!下列单据不能作废处理:”, #换行符, “1、已经作废的单据”, #换行符, “2、反冲单据”, #换行符, “3、被反冲单据”), 0, )
            .如果结束
            
        .否则
            信息框 (“提示：该条单据不存在！”, 0, )
        .如果结束
        
    .否则
        信息框 (“数据库出现错误，请检查数据库是否完好无损！”, 0, )
    .如果结束
    
.否则
    
.如果结束
全部关闭 ()

.子程序 _按钮4_被单击, 空白型, , 
.如果 (等于 (是否停止, 假))
    信息框 (“请先停止其他操作，然后才能退出！”, 0, )
.否则
    单据查询.销毁 ()
.如果结束


.子程序 _单据查询_创建完毕, 空白型, , 
.局部变量 qqq, 文本型, , , 

赋值 (.内容, “”)
0.置宽度 (单据查询.)
赋值 (qqq, 取文本注册项 (3, “dysz\tsk”, “真”))
.如果 (等于 (qqq, “真”))
    未知支持库函数_0 (取窗口句柄 (), 相加 (“输入好查询条件后，点击本按钮将对数据库进行查询。”, #换行符, “并将满足查询条件的单据都显示在查询结果列表栏中。”, #换行符, “如果要查询其它单据，建议先单击重置查询条件按钮。”, #换行符, “快捷操作方式：按回车键。”), 真, 假)
    未知支持库函数_0 (取窗口句柄 (), 相加 (“点击本按钮将作废查询结果栏中当前选中的单据。”, #换行符, “本单据不能为反冲、被反冲或已经作废的单据。”, #换行符, “注意：单据作废后将不参与任何数据统计与计算，”, #换行符, “请慎重使用。如误操作，请与管理员联系。”), 真, 假)
    未知支持库函数_0 (取窗口句柄 (), “单击选择项目，右边会显示选择单据的内容。”, 真, 假)
    未知支持库函数_6 (1, “友情提示：”)
    未知支持库函数_4 (#红色)
.否则
    
.如果结束
赋值 (是否停止, 真)

.子程序 _按钮5_被单击, 空白型, , 
.局部变量 左边据, 整数型, , , 
.局部变量 上边据, 整数型, , , 
.局部变量 临时变量1, 整数型, , , 
.局部变量 临时变量, 整数型, , , 

置等待鼠标 ()
赋值 (左边据, 到数值 (取文本注册项 (3, “dysz\zbj”, “0”)))
赋值 (上边据, 到数值 (取文本注册项 (3, “dysz\sbj”, “0”)))
写日志 (相加 (到文本 (取现行时间 ()), “//”, 当前用户, “打印单据”, .内容))
真.开始打印 (真, 0, 0)
赋值 (.打印作业名, 相加 (“打印单据”, .内容))
赋值 (.绘画单位, 1)
赋值 (.字体.字体大小, 10)
相加 (左边据, 1700).定位写出 (相加 (上边据, 55), .内容)
相加 (左边据, 1660).定位写出 (相加 (上边据, 115), 取年份 (到时间 (.内容)))
相加 (左边据, 1810).定位写出 (相加 (上边据, 115), 取月份 (到时间 (.内容)))
相加 (左边据, 1910).定位写出 (相加 (上边据, 115), 取日 (到时间 (.内容)))
相加 (左边据, 200).定位写出 (相加 (上边据, 170), .内容)
相加 (左边据, 980).定位写出 (相加 (上边据, 170), .内容)
相加 (左边据, 1240).定位写出 (相加 (上边据, 170), .内容)
相加 (左边据, 1700).定位写出 (相加 (上边据, 170), .内容)
相加 (左边据, 200).定位写出 (相加 (上边据, 230), .内容)
相加 (左边据, 1240).定位写出 (相加 (上边据, 230), .内容)
相加 (左边据, 1700).定位写出 (相加 (上边据, 230), .内容)
相加 (左边据, 10).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 150).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 500).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 570).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 790).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 920).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1030).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1200).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1320).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1490).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1610).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1770).定位写出 (相加 (上边据, 400), .内容)

相加 (左边据, 10).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 150).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 500).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 570).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 790).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 920).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1030).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1200).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1320).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1490).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1610).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1770).定位写出 (相加 (上边据, 450), .内容)

相加 (左边据, 10).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 150).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 500).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 570).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 790).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 920).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1030).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1200).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1320).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1490).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1610).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1770).定位写出 (相加 (上边据, 510), .内容)

相加 (左边据, 10).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 150).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 500).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 570).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 790).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 920).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1030).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1200).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1320).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1490).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1610).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1770).定位写出 (相加 (上边据, 570), .内容)

相加 (左边据, 380).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 550).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 890).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1060).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1240).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1400).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1560).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1720).定位写出 (相加 (上边据, 620), 相加 (“￥”, .内容))
相加 (左边据, 1000).定位写出 (相加 (上边据, 680), .内容)
相加 (左边据, 1630).定位写出 (相加 (上边据, 740), .内容)

赋值 (上边据, 相加 (上边据, 820))
相加 (左边据, 1700).定位写出 (相加 (上边据, 55), .内容)
相加 (左边据, 1660).定位写出 (相加 (上边据, 115), 取年份 (到时间 (.内容)))
相加 (左边据, 1810).定位写出 (相加 (上边据, 115), 取月份 (到时间 (.内容)))
相加 (左边据, 1910).定位写出 (相加 (上边据, 115), 取日 (到时间 (.内容)))
相加 (左边据, 200).定位写出 (相加 (上边据, 170), .内容)
相加 (左边据, 980).定位写出 (相加 (上边据, 170), .内容)
相加 (左边据, 1240).定位写出 (相加 (上边据, 170), .内容)
相加 (左边据, 1700).定位写出 (相加 (上边据, 170), .内容)
相加 (左边据, 200).定位写出 (相加 (上边据, 230), .内容)
相加 (左边据, 1240).定位写出 (相加 (上边据, 230), .内容)
相加 (左边据, 1700).定位写出 (相加 (上边据, 230), .内容)
相加 (左边据, 10).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 150).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 500).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 570).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 790).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 920).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1030).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1200).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1320).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1490).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1610).定位写出 (相加 (上边据, 400), .内容)
相加 (左边据, 1770).定位写出 (相加 (上边据, 400), .内容)

相加 (左边据, 10).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 150).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 500).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 570).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 790).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 920).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1030).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1200).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1320).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1490).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1610).定位写出 (相加 (上边据, 450), .内容)
相加 (左边据, 1770).定位写出 (相加 (上边据, 450), .内容)

相加 (左边据, 10).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 150).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 500).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 570).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 790).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 920).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1030).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1200).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1320).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1490).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1610).定位写出 (相加 (上边据, 510), .内容)
相加 (左边据, 1770).定位写出 (相加 (上边据, 510), .内容)

相加 (左边据, 10).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 150).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 500).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 570).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 790).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 920).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1030).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1200).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1320).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1490).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1610).定位写出 (相加 (上边据, 570), .内容)
相加 (左边据, 1770).定位写出 (相加 (上边据, 570), .内容)

相加 (左边据, 380).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 550).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 730).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 890).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1060).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1240).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1400).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1560).定位写出 (相加 (上边据, 620), .内容)
相加 (左边据, 1720).定位写出 (相加 (上边据, 620), 相加 (“￥”, .内容))
相加 (左边据, 1000).定位写出 (相加 (上边据, 680), .内容)
相加 (左边据, 1630).定位写出 (相加 (上边据, 740), .内容)

结束打印 ()
恢复鼠标 ()


.子程序 _按钮7_被单击, 空白型, , 
打印预览 ()

.子程序 _按钮6_被单击, 空白型, , 
.局部变量 临时文件名, 文本型, , , 

赋值 (.文件名, “查询结果”)
.如果 (等于 (打开 (), 真))
    赋值 (临时文件名, 取临时文件名 ())
    5.添加行 ()
    .如果 (等于 (临时文件名.存到文件 (), 真))
        .如果 (等于 (转换数据 (临时文件名, 1, .文件名), 真))
            信息框 (“该报表数据已经成功转换为EXCEL文件！”, 0, )
        .否则
            信息框 (“该报表数据暂时不能转换为EXCEL文件，请稍后再试！”, 0, )
        .如果结束
        
    .否则
        信息框 (“该报表数据暂时不能转换为EXCEL文件，请稍后再试！”, 0, )
    .如果结束
    相减 (取行数 (), 4).删除行 (5)
    删除文件 (临时文件名)
.否则
    
.如果结束


.子程序 _按钮8_被单击, 空白型, , 
.局部变量 临时变量2, 整数型, , , 
.局部变量 临时变量1, 整数型, , , 
.局部变量 临时变量, 整数型, , , 
.局部变量 打印设置, 打印设置信息, , , 
.局部变量 总合计, 双精度小数型, , , 
.局部变量 当前库, 文本型, , , 

赋值 (是否停止, 假)
置等待鼠标 ()
1.置文本 (1, “开票日期”)
1.置文本 (2, “单据编号”)
1.置文本 (3, “购货单位”)
1.置文本 (4, “品种”)
1.置文本 (5, “浓度”)
1.置文本 (6, “规格”)
1.置文本 (7, “数量”)
1.置文本 (8, “净水价格”)
1.置文本 (9, “瓶子押金”)
1.置文本 (10, “运费”)
1.置文本 (11, “合计”)
1.置文本 (12, “备注”)
2.删除行 (相减 (取行数 (), 1))
赋值 (临时变量1, 1)
赋值 (当前库, 取文本左边 (相减 (临时变量1, 1).取项目文本 (), 4))
打开索引 (当前库)
赋值 (.数据源, “”)
.计次循环首 (取项目数 (), 临时变量1)
    0.置文本 (相加 (“正在处理：”, 相减 (临时变量1, 1).取项目文本 (), “  己完成：”, 到文本 (临时变量1), “/”, 到文本 (取项目数 ()), “(”, 到文本 (取整 (相除 (相乘 (临时变量1, 100), 取项目数 ()))), “%)”))
    .如果 (等于 (是否停止, 真))
        全部关闭 ()
        0.置文本 (“处理被中断”)
        返回 ()
    .否则
        置等待鼠标 ()
    .如果结束
    .如果 (不等于 (取文本左边 (相减 (临时变量1, 1).取项目文本 (), 4), 当前库))
        赋值 (当前库, 取文本左边 (相减 (临时变量1, 1).取项目文本 (), 4))
        打开索引 (当前库)
    .否则
        
    .如果结束
    .如果 (等于 (索引查找 (相减 (临时变量1, 1).取项目文本 ()), 真))
        赋值 (临时变量2, 0)
        .计次循环首 (4, 临时变量)
            .如果 (不等于 (读 (相加 (“产品编号”, 到文本 (临时变量))), “”))
                1.添加行 ()
                取行数 ().置文本 (1, 读 (“日期”))
                取行数 ().置文本 (2, 读 (“编号”))
                取行数 ().置文本 (3, 读 (“购货单位”))
                取行数 ().置文本 (4, 读 (相加 (“品种”, 到文本 (临时变量))))
                取行数 ().置文本 (5, 读 (相加 (“浓度”, 到文本 (临时变量))))
                取行数 ().置文本 (6, 读 (相加 (“规格”, 到文本 (临时变量))))
                取行数 ().置文本 (7, 读 (相加 (“数量”, 到文本 (临时变量))))
                取行数 ().置文本 (8, 读 (相加 (“净水总价”, 到文本 (临时变量))))
                取行数 ().置文本 (9, 读 (相加 (“押金总价”, 到文本 (临时变量))))
                取行数 ().置文本 (10, 读 (相加 (“运费总价”, 到文本 (临时变量))))
                取行数 ().置文本 (11, 读 (相加 (“合计”, 到文本 (临时变量))))
                .如果 (等于 (读 (“反冲”), 真))
                    取行数 ().置文本 (12, 相加 (“反冲”, 读 (“反冲单据号”)))
                    赋值 (总合计, 相减 (总合计, 到数值 (读 (相加 (“合计”, 到文本 (临时变量))))))
                .否则
                    .如果 (等于 (读 (“被反冲”), 真))
                        取行数 ().置文本 (12, 相加 (“被”, 读 (“被反冲单据号”), “反冲”))
                        赋值 (总合计, 相加 (总合计, 到数值 (读 (相加 (“合计”, 到文本 (临时变量))))))
                    .否则
                        .如果 (等于 (读 (“作废”), 真))
                            取行数 ().置文本 (12, “作废”)
                        .否则
                            取行数 ().置文本 (12, “”)
                            赋值 (总合计, 相加 (总合计, 到数值 (读 (相加 (“合计”, 到文本 (临时变量))))))
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                赋值 (临时变量2, 相加 (临时变量2, 1))
            .否则
                
            .如果结束
            
        .计次循环尾 ()
        .如果 (大于 (临时变量2, 1))
            相减 (相加 (取行数 (), 1), 临时变量2).合并 (1, 临时变量2, )
            相减 (相加 (取行数 (), 1), 临时变量2).合并 (2, 临时变量2, )
            相减 (相加 (取行数 (), 1), 临时变量2).合并 (3, 临时变量2, )
            相减 (相加 (取行数 (), 1), 临时变量2).合并 (12, 临时变量2, )
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    
.计次循环尾 ()
全部关闭 ()
0.置文本 (“正在处理表格”)
1.添加行 ()
取行数 ().置文本 (1, “总合计”)
取行数 ().置文本 (11, 到文本 (总合计))
1.置列宽 (200)
2.置列宽 (300)
3.置列宽 (300)
4.置列宽 (300)
5.置列宽 (150)
6.置列宽 (250)
7.置列宽 (150)
8.置列宽 (250)
9.置列宽 (250)
10.置列宽 (150)
11.置列宽 (200)
12.置列宽 (200)
1.加线条 (1, 取行数 (), 取列数 (), 63)
赋值 (打印设置.纸张方向, #横向)
赋值 (打印设置.左边距, 100)
赋值 (打印设置.右边距, 100)
赋值 (打印设置.上边距, 100)
赋值 (打印设置.下边距, 100)
赋值 (打印设置.打印缩放比, #缩放到纸宽)
1.置表头行数 ()
打印设置.置打印设置 ()
0.置文本 (“处理完毕”)
赋值 (.数据源, “数据源1”)
赋值 (是否停止, 真)


.子程序 打开索引, 逻辑型, , 
.参数 qq, 文本型, , 

全部关闭 ()
.如果 (等于 (打开 (相加 (当前目录, “data\save\”, qq, “.ldb”), , , , , “lgq”, ), 真))
    新建索引 (相加 (当前目录, “data\save\sycz.enx”), , , , “编号”)
    置当前索引 (相加 (当前目录, “data\save\sycz.enx”))
    到首记录 ()
    返回 (真)
.否则
    返回 (假)
.如果结束


.子程序 _单据查询_可否被关闭, 逻辑型, , 
赋值 (是否停止, 真)
返回 (假)

.子程序 _按钮9_被单击, 空白型, , 
.局部变量 临时变量1, 整数型, , , 
.局部变量 临时变量, 整数型, , , 
.局部变量 打印设置, 打印设置信息, , , 
.局部变量 单据合计, 双精度小数型, , , 
.局部变量 当前库, 文本型, , , 
.局部变量 单据销量, 双精度小数型, , , 
.局部变量 正负号, 短整数型, , , 
.局部变量 qqq, 文本型, , "0", 

.如果 (等于 (打开 (), 真))
    0.置文本 (“正在处理”)
    赋值 (是否停止, 假)
    置等待鼠标 ()
    赋值 (临时变量1, 1)
    赋值 (当前库, 取文本左边 (相减 (临时变量1, 1).取项目文本 (), 4))
    打开索引 (当前库)
    删除文件 (相加 (未知支持库函数_7 (11), “\lswj.ini”))
    删除文件 (.文件名)
    .计次循环首 (取项目数 (), 临时变量1)
        0.置文本 (相加 (“正在处理：”, 相减 (临时变量1, 1).取项目文本 (), “  己完成：”, 到文本 (临时变量1), “/”, 到文本 (取项目数 ()), “(”, 到文本 (取整 (相除 (相乘 (临时变量1, 100), 取项目数 ()))), “%)”))
        处理事件 ()
        .如果 (等于 (是否停止, 真))
            全部关闭 ()
            0.置文本 (“处理被中断”)
            返回 ()
        .否则
            置等待鼠标 ()
        .如果结束
        .如果 (不等于 (取文本左边 (相减 (临时变量1, 1).取项目文本 (), 4), 当前库))
            赋值 (当前库, 取文本左边 (相减 (临时变量1, 1).取项目文本 (), 4))
            打开索引 (当前库)
        .否则
            
        .如果结束
        .如果 (等于 (索引查找 (相减 (临时变量1, 1).取项目文本 ()), 真))
            .如果 (等于 (读 (“反冲”), 真))
                赋值 (正负号, -1)
            .否则
                .如果 (等于 (读 (“被反冲”), 真))
                    赋值 (正负号, 1)
                .否则
                    .如果 (等于 (读 (“作废”), 真))
                        取行数 ().置文本 (12, “作废”)
                        赋值 (正负号, 0)
                    .否则
                        取行数 ().置文本 (12, “”)
                        赋值 (正负号, 1)
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
            .如果 (不等于 (正负号, 0))
                .计次循环首 (4, 临时变量)
                    赋值 (单据销量, 0)
                    赋值 (单据合计, 0)
                    处理事件 ()
                    .如果 (等于 (是否停止, 真))
                        全部关闭 ()
                        0.置文本 (“处理被中断”)
                        返回 ()
                    .否则
                        置等待鼠标 ()
                    .如果结束
                    .如果 (并且 (不等于 (读 (相加 (“产品编号”, 到文本 (临时变量))), “”), 不等于 (读 (相加 (“数量”, 到文本 (临时变量))), “”)))
                        .如果 (等于 (读 (相加 (“单位”, 到文本 (临时变量))), “箱”))
                            赋值 (单据销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 3)), 到数值 (取文本右边 (读 (相加 (“规格”, 到文本 (临时变量))), 2)), 到数值 (读 (相加 (“数量”, 到文本 (临时变量)))), 正负号))
                        .否则
                            .如果 (等于 (读 (相加 (“单位”, 到文本 (临时变量))), “包”))
                                赋值 (单据销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 3)), 到数值 (取文本右边 (读 (相加 (“规格”, 到文本 (临时变量))), 1)), 到数值 (读 (相加 (“数量”, 到文本 (临时变量)))), 正负号))
                            .否则
                                .如果 (等于 (读 (相加 (“单位”, 到文本 (临时变量))), “筐”))
                                    赋值 (单据销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 3)), 到数值 (取文本右边 (读 (相加 (“规格”, 到文本 (临时变量))), 2)), 到数值 (读 (相加 (“数量”, 到文本 (临时变量)))), 正负号))
                                .否则
                                    .如果 (等于 (读 (相加 (“单位”, 到文本 (临时变量))), “桶”))
                                        赋值 (单据销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 2)), 到数值 (读 (相加 (“数量”, 到文本 (临时变量)))), 1000, 正负号))
                                    .否则
                                        .如果 (等于 (读 (相加 (“单位”, 到文本 (临时变量))), “罐”))
                                            赋值 (单据销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 相减 (取文本长度 (读 (相加 (“规格”, 到文本 (临时变量)))), 2))), 到数值 (读 (相加 (“数量”, 到文本 (临时变量)))), 1000000, 正负号))
                                        .否则
                                            
                                        .如果结束
                                        
                                    .如果结束
                                    
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        赋值 (单据合计, 相乘 (到数值 (读 (相加 (“合计”, 到文本 (临时变量)))), 正负号))
                        写配置项 (相加 (未知支持库函数_7 (11), “\lswj.ini”), 读 (“购货单位”), 相加 (读 (相加 (“产品编号”, 到文本 (临时变量))), “/产品名称”), 读 (相加 (“品种”, 到文本 (临时变量))))
                        写配置项 (相加 (未知支持库函数_7 (11), “\lswj.ini”), 读 (“购货单位”), 相加 (读 (相加 (“产品编号”, 到文本 (临时变量))), “/浓度”), 读 (相加 (“浓度”, 到文本 (临时变量))))
                        写配置项 (相加 (未知支持库函数_7 (11), “\lswj.ini”), 读 (“购货单位”), 相加 (读 (相加 (“产品编号”, 到文本 (临时变量))), “/规格”), 读 (相加 (“规格”, 到文本 (临时变量))))
                        写配置项 (相加 (未知支持库函数_7 (11), “\lswj.ini”), 读 (“购货单位”), 相加 (读 (相加 (“产品编号”, 到文本 (临时变量))), “/单位”), 读 (相加 (“单位”, 到文本 (临时变量))))
                        写配置项 (相加 (未知支持库函数_7 (11), “\lswj.ini”), 读 (“购货单位”), 相加 (读 (相加 (“产品编号”, 到文本 (临时变量))), “/销量”), 到文本 (相加 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\lswj.ini”), 读 (“购货单位”), 相加 (读 (相加 (“产品编号”, 到文本 (临时变量))), “/销量”), “0”)), 单据销量)))
                        写配置项 (相加 (未知支持库函数_7 (11), “\lswj.ini”), 读 (“购货单位”), 相加 (读 (相加 (“产品编号”, 到文本 (临时变量))), “/销售额”), 到文本 (相加 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\lswj.ini”), 读 (“购货单位”), 相加 (读 (相加 (“产品编号”, 到文本 (临时变量))), “/销售额”), “0”)), 单据合计)))
                    .否则
                        
                    .如果结束
                    
                .计次循环尾 ()
            .否则
                
            .如果结束
            
        .否则
            
        .如果结束
        
    .计次循环尾 ()
    复制文件 (相加 (未知支持库函数_7 (11), “\lswj.ini”), .文件名)
    删除文件 (相加 (未知支持库函数_7 (11), “\lswj.ini”))
    全部关闭 ()
    恢复鼠标 ()
    信息框 (“数据文件生成完毕！”, 0, )
    0.置文本 (“数据文件生成完毕！”)
.否则
    
.如果结束
赋值 (是否停止, 真)

.子程序 _按钮10_被单击, 空白型, , 
.局部变量 临时变量1, 整数型, , , 
.局部变量 临时变量, 整数型, , , 
.局部变量 打印设置, 打印设置信息, , , 
.局部变量 单据合计, 双精度小数型, , , 
.局部变量 当前库, 文本型, , , 
.局部变量 单据销量, 双精度小数型, , , 
.局部变量 正负号, 短整数型, , , 
.局部变量 qqq, 文本型, , "0", 

.如果 (等于 (打开 (), 真))
    0.置文本 (“正在处理”)
    赋值 (是否停止, 假)
    置等待鼠标 ()
    赋值 (临时变量1, 1)
    赋值 (当前库, 取文本左边 (相减 (临时变量1, 1).取项目文本 (), 4))
    打开索引 (当前库)
    删除文件 (相加 (未知支持库函数_7 (11), “\lswj1.ini”))
    删除文件 (.文件名)
    .计次循环首 (取项目数 (), 临时变量1)
        0.置文本 (相加 (“正在处理：”, 相减 (临时变量1, 1).取项目文本 (), “  己完成：”, 到文本 (临时变量1), “/”, 到文本 (取项目数 ()), “(”, 到文本 (取整 (相除 (相乘 (临时变量1, 100), 取项目数 ()))), “%)”))
        处理事件 ()
        .如果 (等于 (是否停止, 真))
            全部关闭 ()
            0.置文本 (“处理被中断”)
            返回 ()
        .否则
            置等待鼠标 ()
        .如果结束
        .如果 (不等于 (取文本左边 (相减 (临时变量1, 1).取项目文本 (), 4), 当前库))
            赋值 (当前库, 取文本左边 (相减 (临时变量1, 1).取项目文本 (), 4))
            打开索引 (当前库)
        .否则
            
        .如果结束
        .如果 (等于 (索引查找 (相减 (临时变量1, 1).取项目文本 ()), 真))
            .如果 (等于 (读 (“反冲”), 真))
                赋值 (正负号, -1)
            .否则
                .如果 (等于 (读 (“被反冲”), 真))
                    赋值 (正负号, 1)
                .否则
                    .如果 (等于 (读 (“作废”), 真))
                        取行数 ().置文本 (12, “作废”)
                        赋值 (正负号, 0)
                    .否则
                        取行数 ().置文本 (12, “”)
                        赋值 (正负号, 1)
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
            .如果 (不等于 (正负号, 0))
                .计次循环首 (4, 临时变量)
                    赋值 (单据销量, 0)
                    赋值 (单据合计, 0)
                    处理事件 ()
                    .如果 (等于 (是否停止, 真))
                        全部关闭 ()
                        0.置文本 (“处理被中断”)
                        返回 ()
                    .否则
                        置等待鼠标 ()
                    .如果结束
                    .如果 (并且 (不等于 (读 (相加 (“产品编号”, 到文本 (临时变量))), “”), 不等于 (读 (相加 (“数量”, 到文本 (临时变量))), “”)))
                        .如果 (等于 (读 (相加 (“单位”, 到文本 (临时变量))), “箱”))
                            赋值 (单据销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 3)), 到数值 (取文本右边 (读 (相加 (“规格”, 到文本 (临时变量))), 2)), 到数值 (读 (相加 (“数量”, 到文本 (临时变量)))), 正负号))
                        .否则
                            .如果 (等于 (读 (相加 (“单位”, 到文本 (临时变量))), “包”))
                                赋值 (单据销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 3)), 到数值 (取文本右边 (读 (相加 (“规格”, 到文本 (临时变量))), 1)), 到数值 (读 (相加 (“数量”, 到文本 (临时变量)))), 正负号))
                            .否则
                                .如果 (等于 (读 (相加 (“单位”, 到文本 (临时变量))), “筐”))
                                    赋值 (单据销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 3)), 到数值 (取文本右边 (读 (相加 (“规格”, 到文本 (临时变量))), 2)), 到数值 (读 (相加 (“数量”, 到文本 (临时变量)))), 正负号))
                                .否则
                                    .如果 (等于 (读 (相加 (“单位”, 到文本 (临时变量))), “桶”))
                                        赋值 (单据销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 2)), 到数值 (读 (相加 (“数量”, 到文本 (临时变量)))), 1000, 正负号))
                                    .否则
                                        .如果 (等于 (读 (相加 (“单位”, 到文本 (临时变量))), “罐”))
                                            赋值 (单据销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 相减 (取文本长度 (读 (相加 (“规格”, 到文本 (临时变量)))), 2))), 到数值 (读 (相加 (“数量”, 到文本 (临时变量)))), 1000000, 正负号))
                                        .否则
                                            
                                        .如果结束
                                        
                                    .如果结束
                                    
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        赋值 (单据合计, 相乘 (到数值 (读 (相加 (“合计”, 到文本 (临时变量)))), 正负号))
                        写配置项 (相加 (未知支持库函数_7 (11), “\lswj1.ini”), 读 (“业务编码”), 相加 (读 (相加 (“产品编号”, 到文本 (临时变量))), “/产品名称”), 读 (相加 (“品种”, 到文本 (临时变量))))
                        写配置项 (相加 (未知支持库函数_7 (11), “\lswj1.ini”), 读 (“业务编码”), 相加 (读 (相加 (“产品编号”, 到文本 (临时变量))), “/浓度”), 读 (相加 (“浓度”, 到文本 (临时变量))))
                        写配置项 (相加 (未知支持库函数_7 (11), “\lswj1.ini”), 读 (“业务编码”), 相加 (读 (相加 (“产品编号”, 到文本 (临时变量))), “/规格”), 读 (相加 (“规格”, 到文本 (临时变量))))
                        写配置项 (相加 (未知支持库函数_7 (11), “\lswj1.ini”), 读 (“业务编码”), 相加 (读 (相加 (“产品编号”, 到文本 (临时变量))), “/单位”), 读 (相加 (“单位”, 到文本 (临时变量))))
                        写配置项 (相加 (未知支持库函数_7 (11), “\lswj1.ini”), 读 (“业务编码”), 相加 (读 (相加 (“产品编号”, 到文本 (临时变量))), “/销量”), 到文本 (相加 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\lswj1.ini”), 读 (“业务编码”), 相加 (读 (相加 (“产品编号”, 到文本 (临时变量))), “/销量”), “0”)), 单据销量)))
                        写配置项 (相加 (未知支持库函数_7 (11), “\lswj1.ini”), 读 (“业务编码”), 相加 (读 (相加 (“产品编号”, 到文本 (临时变量))), “/销售额”), 到文本 (相加 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\lswj1.ini”), 读 (“业务编码”), 相加 (读 (相加 (“产品编号”, 到文本 (临时变量))), “/销售额”), “0”)), 单据合计)))
                    .否则
                        
                    .如果结束
                    
                .计次循环尾 ()
            .否则
                
            .如果结束
            
        .否则
            
        .如果结束
        
    .计次循环尾 ()
    复制文件 (相加 (未知支持库函数_7 (11), “\lswj1.ini”), .文件名)
    删除文件 (相加 (未知支持库函数_7 (11), “\lswj1.ini”))
    全部关闭 ()
    恢复鼠标 ()
    信息框 (“数据文件生成完毕！”, 0, )
    0.置文本 (“数据文件生成完毕！”)
.否则
    
.如果结束
赋值 (是否停止, 真)


.窗口程序集 窗口程序集21, , , 

.子程序 _产品管理_创建完毕, 空白型, , 
赋值 (.数据库文件名, 相加 (当前目录, “data\cpbh.ldb”))
.如果 (等于 (取行数 (), 0))
    .添加行 ()
.否则
    
.如果结束


.子程序 _添加空记录_被选择, 空白型, , 
1.添加行 ()

.子程序 _删除本条记录_被选择, 空白型, , 
取光标行号 ().删除行 (1)

.子程序 _表格1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出托盘菜单 ()

.子程序 _删除选择记录_被选择, 空白型, , 
取光标行号 ().删除行 (取选择行数 ())

.子程序 _删除所有记录_被选择, 空白型, , 
1.删除行 (取行数 ())

.子程序 _表格1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 46))
    取光标行号 ().删除行 (取选择行数 ())
.否则
    .如果 (等于 (键代码, 45))
        1.添加行 ()
    .否则
        
    .如果结束
    
.如果结束


.子程序 _清空选择区数据_被选择, 空白型, , 
取光标行号 ().清除 (取光标列号 (), 取选择行数 (), 取选择列数 ())

.子程序 _复制CtrlC_被选择, 空白型, , 
取光标行号 ().复制 (取光标列号 (), 取选择行数 (), 取选择列数 ())

.子程序 _粘贴CtrlV_被选择, 空白型, , 
粘贴到光标处 ()

.子程序 _按钮1_被单击, 空白型, , 
产品管理.销毁 ()

.子程序 _组合框2_列表项被选择, 空白型, , 
取光标行号 ().置文本 (取光标列号 (), .取项目文本 (.现行选中项))
赋值 (.现行选中项, -1)

.子程序 _组合框1_列表项被选择, 空白型, , 
取光标行号 ().置文本 (取光标列号 (), .取项目文本 (.现行选中项))
赋值 (.现行选中项, -1)

.子程序 _组合框3_列表项被选择, 空白型, , 
取光标行号 ().置文本 (取光标列号 (), .取项目文本 (.现行选中项))
赋值 (.现行选中项, -1)

.窗口程序集 窗口程序集20, , , 

.程序集变量 当前库文件, 文本型, , , 
.子程序 _选择产品_创建完毕, 空白型, , 
赋值 (当前库文件, 取当前库 ())
.如果 (等于 (打开 (相加 (当前目录, “data\cpbh.ldb”), , , , , “lgq”, ), 真))
    置当前库 (相加 (当前目录, “data\cpbh.ldb”))
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        -1.插入表项 (读 (“产品编号”), , , , )
        相减 (取表项数 (), 1).置标题 (1, 读 (“产品名称”))
        相减 (取表项数 (), 1).置标题 (2, 读 (“浓度”))
        相减 (取表项数 (), 1).置标题 (3, 读 (“规格”))
        相减 (取表项数 (), 1).置标题 (4, 读 (“单位”))
        相减 (取表项数 (), 1).置标题 (5, 读 (“档次”))
        跳过 ()
    .判断循环尾 ()
    关闭 (相加 (当前目录, “data\cpbh.ldb”))
    置当前库 (当前库文件)
.否则
    
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
.如果 (不等于 (., -1))
    单位管理.置文本 (., 单位管理.取光标行号 (.), 1, .取标题 (., 0))
    单位管理.置文本 (., 单位管理.取光标行号 (.), 2, .取标题 (., 1))
    单位管理.置文本 (., 单位管理.取光标行号 (.), 3, .取标题 (., 2))
    单位管理.置文本 (., 单位管理.取光标行号 (.), 4, .取标题 (., 3))
    单位管理.置文本 (., 单位管理.取光标行号 (.), 5, .取标题 (., 4))
    选择产品.销毁 ()
.否则
    
.如果结束


.子程序 _超级列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (不等于 (., -1))
    _按钮2_被单击 ()
.否则
    
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
选择产品.销毁 ()

.窗口程序集 窗口程序集22, , , 

.子程序 生成报表, 空白型, , 
.局部变量 周转相金额, 双精度小数型, , , 
.局部变量 现辟金额, 双精度小数型, , , 
.局部变量 现辟日销量, 双精度小数型, , , 
.局部变量 易拉罐金额, 双精度小数型, , , 
.局部变量 易拉罐日销量, 双精度小数型, , , 
.局部变量 纸箱金额, 双精度小数型, , , 
.局部变量 纸箱日销量, 双精度小数型, , , 
.局部变量 周转相日销量, 双精度小数型, , , 
.局部变量 塑包金额, 双精度小数型, , , 
.局部变量 塑包日销量, 双精度小数型, , , 
.局部变量 单位编码, 文本型, , , 
.局部变量 当前数据库名, 文本型, , , 
.局部变量 是否符合, 逻辑型, , , 
.局部变量 单位, 文本型, , , 
.局部变量 当前单据编号, 文本型, , , 

置等待鼠标 ()
.如果 (等于 (打开 (相加 (当前目录, “data\save\”, 到文本 (取年份 (.今天)), “.ldb”), , , , , “lgq”, ), 真))
    赋值 (塑包日销量, 0)
    赋值 (塑包金额, 0)
    赋值 (周转相金额, 0)
    赋值 (周转相日销量, 0)
    赋值 (纸箱日销量, 0)
    赋值 (纸箱金额, 0)
    赋值 (易拉罐金额, 0)
    赋值 (易拉罐日销量, 0)
    赋值 (现辟日销量, 0)
    赋值 (现辟金额, 0)
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (等于 (读 (“日期”), 到文本 (取日期 (.今天))))
            赋值 (单位编码, 读 (“单位编号”))
            赋值 (当前单据编号, 读 (“编号”))
            赋值 (当前数据库名, 取当前库 ())
            赋值 (是否符合, 假)
            .如果 (等于 (打开 (相加 (当前目录, “data\index.ldb”), , , , , “lgq”, ), 真))
                置当前库 (相加 (当前目录, “data\index.ldb”))
                到首记录 ()
                .如果 (查找 (等于 (读 (“编号”), 单位编码)))
                    .如果 (并且 (不等于 (读 (“所属片区”), “崂山啤酒加工”), 不等于 (读 (“所属片区”), “外来加工”)))
                        赋值 (是否符合, 真)
                    .否则
                        
                    .如果结束
                    
                .否则
                    信息框 (相加 (“找不到单据”, 当前单据编号, “中指定的单位编码为”, 单位编码, “的购货单位,本单据将不作处理!”, #换行符, “由于本原因,最终生成数据可能不准确!!请检查单据数据的准确性,必要时请加以修改!”), 0, )
                .如果结束
                关闭 ()
                置当前库 (当前数据库名)
            .否则
                信息框 (“读取单位索引数据库错误,请检查该数据库是否完整！”, 0, )
                全部关闭 ()
                恢复鼠标 ()
                返回 ()
            .如果结束
            .如果 (并且 (等于 (是否符合, 真), 等于 (读 (“作废”), 假)))
                .如果 (等于 (读 (“反冲”), 假))
                    .如果 (不等于 (读 (“数量1”), “”))
                        赋值 (单位, 读 (“单位1”))
                        .如果 (并且 (等于 (单位, “箱”), 不等于 (读 (“规格1”), “350ml*24”), 不等于 (读 (“规格1”), “350ml*12”)))
                            赋值 (纸箱日销量, 相加 (纸箱日销量, 相乘 (到数值 (取文本左边 (读 (“规格1”), 3)), 到数值 (取文本右边 (读 (“规格1”), 2)), 到数值 (读 (“数量1”)))))
                            赋值 (纸箱金额, 相加 (纸箱金额, 到数值 (读 (“净水总价1”))))
                        .否则
                            .如果 (等于 (单位, “箱”))
                                赋值 (易拉罐日销量, 相加 (易拉罐日销量, 相乘 (到数值 (取文本左边 (读 (“规格1”), 3)), 到数值 (取文本右边 (读 (“规格1”), 2)), 到数值 (读 (“数量1”)))))
                                赋值 (易拉罐金额, 相加 (易拉罐金额, 到数值 (读 (“净水总价1”))))
                            .否则
                                .如果 (等于 (单位, “包”))
                                    赋值 (塑包日销量, 相加 (塑包日销量, 相乘 (到数值 (取文本左边 (读 (“规格1”), 3)), 到数值 (取文本右边 (读 (“规格1”), 1)), 到数值 (读 (“数量1”)))))
                                    赋值 (塑包金额, 相加 (塑包金额, 到数值 (读 (“净水总价1”))))
                                .否则
                                    .如果 (等于 (单位, “筐”))
                                        赋值 (周转相日销量, 相加 (周转相日销量, 相乘 (到数值 (取文本左边 (读 (“规格1”), 3)), 到数值 (取文本右边 (读 (“规格1”), 2)), 到数值 (读 (“数量1”)))))
                                        赋值 (周转相金额, 相加 (周转相金额, 到数值 (读 (“净水总价1”))))
                                    .否则
                                        .如果 (等于 (单位, “桶”))
                                            赋值 (现辟日销量, 相加 (现辟日销量, 相乘 (到数值 (取文本左边 (读 (“规格1”), 2)), 到数值 (读 (“数量1”)), 1000)))
                                            赋值 (现辟金额, 相加 (现辟金额, 到数值 (读 (“净水总价1”))))
                                        .否则
                                            .如果 (等于 (单位, “罐”))
                                                赋值 (现辟日销量, 相加 (现辟日销量, 相乘 (到数值 (取文本左边 (读 (“规格1”), 相减 (取文本长度 (读 (“规格1”)), 2))), 到数值 (读 (“数量1”)), 1000000)))
                                                赋值 (现辟金额, 相加 (现辟金额, 到数值 (读 (“净水总价1”))))
                                            .否则
                                                
                                            .如果结束
                                            
                                        .如果结束
                                        
                                    .如果结束
                                    
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                    .否则
                        
                    .如果结束
                    .如果 (不等于 (读 (“数量2”), “”))
                        赋值 (单位, 读 (“单位2”))
                        .如果 (并且 (等于 (单位, “箱”), 不等于 (读 (“规格2”), “350ml*24”), 不等于 (读 (“规格2”), “350ml*12”)))
                            赋值 (纸箱日销量, 相加 (纸箱日销量, 相乘 (到数值 (取文本左边 (读 (“规格2”), 3)), 到数值 (取文本右边 (读 (“规格2”), 2)), 到数值 (读 (“数量2”)))))
                            赋值 (纸箱金额, 相加 (纸箱金额, 到数值 (读 (“净水总价2”))))
                        .否则
                            .如果 (等于 (单位, “箱”))
                                赋值 (易拉罐日销量, 相加 (易拉罐日销量, 相乘 (到数值 (取文本左边 (读 (“规格2”), 3)), 到数值 (取文本右边 (读 (“规格2”), 2)), 到数值 (读 (“数量2”)))))
                                赋值 (易拉罐金额, 相加 (易拉罐金额, 到数值 (读 (“净水总价2”))))
                            .否则
                                .如果 (等于 (单位, “包”))
                                    赋值 (塑包日销量, 相加 (塑包日销量, 相乘 (到数值 (取文本左边 (读 (“规格2”), 3)), 到数值 (取文本右边 (读 (“规格2”), 1)), 到数值 (读 (“数量2”)))))
                                    赋值 (塑包金额, 相加 (塑包金额, 到数值 (读 (“净水总价2”))))
                                .否则
                                    .如果 (等于 (单位, “筐”))
                                        赋值 (周转相日销量, 相加 (周转相日销量, 相乘 (到数值 (取文本左边 (读 (“规格2”), 3)), 到数值 (取文本右边 (读 (“规格2”), 2)), 到数值 (读 (“数量2”)))))
                                        赋值 (周转相金额, 相加 (周转相金额, 到数值 (读 (“净水总价2”))))
                                    .否则
                                        .如果 (等于 (单位, “桶”))
                                            赋值 (现辟日销量, 相加 (现辟日销量, 相乘 (到数值 (取文本左边 (读 (“规格2”), 2)), 到数值 (读 (“数量2”)), 1000)))
                                            赋值 (现辟金额, 相加 (现辟金额, 到数值 (读 (“净水总价2”))))
                                        .否则
                                            .如果 (等于 (单位, “罐”))
                                                赋值 (现辟日销量, 相加 (现辟日销量, 相乘 (到数值 (取文本左边 (读 (“规格2”), 相减 (取文本长度 (读 (“规格2”)), 2))), 到数值 (读 (“数量2”)), 1000000)))
                                                赋值 (现辟金额, 相加 (现辟金额, 到数值 (读 (“净水总价2”))))
                                            .否则
                                                
                                            .如果结束
                                            
                                        .如果结束
                                        
                                    .如果结束
                                    
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                    .否则
                        
                    .如果结束
                    .如果 (不等于 (读 (“数量3”), “”))
                        赋值 (单位, 读 (“单位3”))
                        .如果 (并且 (等于 (单位, “箱”), 不等于 (读 (“规格3”), “350ml*24”), 不等于 (读 (“规格3”), “350ml*12”)))
                            赋值 (纸箱日销量, 相加 (纸箱日销量, 相乘 (到数值 (取文本左边 (读 (“规格3”), 3)), 到数值 (取文本右边 (读 (“规格3”), 2)), 到数值 (读 (“数量3”)))))
                            赋值 (纸箱金额, 相加 (纸箱金额, 到数值 (读 (“净水总价3”))))
                        .否则
                            .如果 (等于 (单位, “箱”))
                                赋值 (易拉罐日销量, 相加 (易拉罐日销量, 相乘 (到数值 (取文本左边 (读 (“规格3”), 3)), 到数值 (取文本右边 (读 (“规格3”), 2)), 到数值 (读 (“数量3”)))))
                                赋值 (易拉罐金额, 相加 (易拉罐金额, 到数值 (读 (“净水总价3”))))
                            .否则
                                .如果 (等于 (单位, “包”))
                                    赋值 (塑包日销量, 相加 (塑包日销量, 相乘 (到数值 (取文本左边 (读 (“规格3”), 3)), 到数值 (取文本右边 (读 (“规格3”), 1)), 到数值 (读 (“数量3”)))))
                                    赋值 (塑包金额, 相加 (塑包金额, 到数值 (读 (“净水总价3”))))
                                .否则
                                    .如果 (等于 (单位, “筐”))
                                        赋值 (周转相日销量, 相加 (周转相日销量, 相乘 (到数值 (取文本左边 (读 (“规格3”), 3)), 到数值 (取文本右边 (读 (“规格3”), 2)), 到数值 (读 (“数量3”)))))
                                        赋值 (周转相金额, 相加 (周转相金额, 到数值 (读 (“净水总价3”))))
                                    .否则
                                        .如果 (等于 (单位, “桶”))
                                            赋值 (现辟日销量, 相加 (现辟日销量, 相乘 (到数值 (取文本左边 (读 (“规格3”), 2)), 到数值 (读 (“数量3”)), 1000)))
                                            赋值 (现辟金额, 相加 (现辟金额, 到数值 (读 (“净水总价3”))))
                                        .否则
                                            .如果 (等于 (单位, “罐”))
                                                赋值 (现辟日销量, 相加 (现辟日销量, 相乘 (到数值 (取文本左边 (读 (“规格3”), 相减 (取文本长度 (读 (“规格3”)), 2))), 到数值 (读 (“数量3”)), 1000000)))
                                                赋值 (现辟金额, 相加 (现辟金额, 到数值 (读 (“净水总价3”))))
                                            .否则
                                                
                                            .如果结束
                                            
                                        .如果结束
                                        
                                    .如果结束
                                    
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                    .否则
                        
                    .如果结束
                    .如果 (不等于 (读 (“数量4”), “”))
                        赋值 (单位, 读 (“单位4”))
                        .如果 (并且 (等于 (单位, “箱”), 不等于 (读 (“规格4”), “350ml*24”), 不等于 (读 (“规格4”), “350ml*12”)))
                            赋值 (纸箱日销量, 相加 (纸箱日销量, 相乘 (到数值 (取文本左边 (读 (“规格4”), 3)), 到数值 (取文本右边 (读 (“规格4”), 2)), 到数值 (读 (“数量4”)))))
                            赋值 (纸箱金额, 相加 (纸箱金额, 到数值 (读 (“净水总价4”))))
                        .否则
                            .如果 (等于 (单位, “箱”))
                                赋值 (易拉罐日销量, 相加 (易拉罐日销量, 相乘 (到数值 (取文本左边 (读 (“规格4”), 3)), 到数值 (取文本右边 (读 (“规格4”), 2)), 到数值 (读 (“数量4”)))))
                                赋值 (易拉罐金额, 相加 (易拉罐金额, 到数值 (读 (“净水总价4”))))
                            .否则
                                .如果 (等于 (单位, “包”))
                                    赋值 (塑包日销量, 相加 (塑包日销量, 相乘 (到数值 (取文本左边 (读 (“规格4”), 3)), 到数值 (取文本右边 (读 (“规格4”), 1)), 到数值 (读 (“数量4”)))))
                                    赋值 (塑包金额, 相加 (塑包金额, 到数值 (读 (“净水总价4”))))
                                .否则
                                    .如果 (等于 (单位, “筐”))
                                        赋值 (周转相日销量, 相加 (周转相日销量, 相乘 (到数值 (取文本左边 (读 (“规格4”), 3)), 到数值 (取文本右边 (读 (“规格4”), 2)), 到数值 (读 (“数量4”)))))
                                        赋值 (周转相金额, 相加 (周转相金额, 到数值 (读 (“净水总价4”))))
                                    .否则
                                        .如果 (等于 (单位, “桶”))
                                            赋值 (现辟日销量, 相加 (现辟日销量, 相乘 (到数值 (取文本左边 (读 (“规格4”), 2)), 到数值 (读 (“数量4”)), 1000)))
                                            赋值 (现辟金额, 相加 (现辟金额, 到数值 (读 (“净水总价4”))))
                                        .否则
                                            .如果 (等于 (单位, “罐”))
                                                赋值 (现辟日销量, 相加 (现辟日销量, 相乘 (到数值 (取文本左边 (读 (“规格4”), 相减 (取文本长度 (读 (“规格4”)), 2))), 到数值 (读 (“数量4”)), 1000000)))
                                                赋值 (现辟金额, 相加 (现辟金额, 到数值 (读 (“净水总价4”))))
                                            .否则
                                                
                                            .如果结束
                                            
                                        .如果结束
                                        
                                    .如果结束
                                    
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                    .否则
                        
                    .如果结束
                    
                .否则
                    .如果 (不等于 (读 (“数量1”), “”))
                        赋值 (单位, 读 (“单位1”))
                        .如果 (并且 (等于 (单位, “箱”), 不等于 (读 (“规格1”), “350ml*24”), 不等于 (读 (“规格1”), “350ml*12”)))
                            赋值 (纸箱日销量, 相减 (纸箱日销量, 相乘 (到数值 (取文本左边 (读 (“规格1”), 3)), 到数值 (取文本右边 (读 (“规格1”), 2)), 到数值 (读 (“数量1”)))))
                            赋值 (纸箱金额, 相减 (纸箱金额, 到数值 (读 (“净水总价1”))))
                        .否则
                            .如果 (等于 (单位, “箱”))
                                赋值 (易拉罐日销量, 相减 (易拉罐日销量, 相乘 (到数值 (取文本左边 (读 (“规格1”), 3)), 到数值 (取文本右边 (读 (“规格1”), 2)), 到数值 (读 (“数量1”)))))
                                赋值 (易拉罐金额, 相减 (易拉罐金额, 到数值 (读 (“净水总价1”))))
                            .否则
                                .如果 (等于 (单位, “包”))
                                    赋值 (塑包日销量, 相减 (塑包日销量, 相乘 (到数值 (取文本左边 (读 (“规格1”), 3)), 到数值 (取文本右边 (读 (“规格1”), 1)), 到数值 (读 (“数量1”)))))
                                    赋值 (塑包金额, 相减 (塑包金额, 到数值 (读 (“净水总价1”))))
                                .否则
                                    .如果 (等于 (单位, “筐”))
                                        赋值 (周转相日销量, 相减 (周转相日销量, 相乘 (到数值 (取文本左边 (读 (“规格1”), 3)), 到数值 (取文本右边 (读 (“规格1”), 2)), 到数值 (读 (“数量1”)))))
                                        赋值 (周转相金额, 相减 (周转相金额, 到数值 (读 (“净水总价1”))))
                                    .否则
                                        .如果 (等于 (单位, “桶”))
                                            赋值 (现辟日销量, 相减 (现辟日销量, 相乘 (到数值 (取文本左边 (读 (“规格1”), 2)), 到数值 (读 (“数量1”)), 1000)))
                                            赋值 (现辟金额, 相减 (现辟金额, 到数值 (读 (“净水总价1”))))
                                        .否则
                                            .如果 (等于 (单位, “罐”))
                                                赋值 (现辟日销量, 相减 (现辟日销量, 相乘 (到数值 (取文本左边 (读 (“规格1”), 相减 (取文本长度 (读 (“规格1”)), 2))), 到数值 (读 (“数量1”)), 1000000)))
                                                赋值 (现辟金额, 相减 (现辟金额, 到数值 (读 (“净水总价1”))))
                                            .否则
                                                
                                            .如果结束
                                            
                                        .如果结束
                                        
                                    .如果结束
                                    
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                    .否则
                        
                    .如果结束
                    .如果 (不等于 (读 (“数量2”), “”))
                        赋值 (单位, 读 (“单位2”))
                        .如果 (并且 (等于 (单位, “箱”), 不等于 (读 (“规格2”), “350ml*24”), 不等于 (读 (“规格2”), “350ml*12”)))
                            赋值 (纸箱日销量, 相减 (纸箱日销量, 相乘 (到数值 (取文本左边 (读 (“规格2”), 3)), 到数值 (取文本右边 (读 (“规格2”), 2)), 到数值 (读 (“数量2”)))))
                            赋值 (纸箱金额, 相减 (纸箱金额, 到数值 (读 (“净水总价2”))))
                        .否则
                            .如果 (等于 (单位, “箱”))
                                赋值 (易拉罐日销量, 相减 (易拉罐日销量, 相乘 (到数值 (取文本左边 (读 (“规格2”), 3)), 到数值 (取文本右边 (读 (“规格2”), 2)), 到数值 (读 (“数量2”)))))
                                赋值 (易拉罐金额, 相减 (易拉罐金额, 到数值 (读 (“净水总价2”))))
                            .否则
                                .如果 (等于 (单位, “包”))
                                    赋值 (塑包日销量, 相减 (塑包日销量, 相乘 (到数值 (取文本左边 (读 (“规格2”), 3)), 到数值 (取文本右边 (读 (“规格2”), 1)), 到数值 (读 (“数量2”)))))
                                    赋值 (塑包金额, 相减 (塑包金额, 到数值 (读 (“净水总价2”))))
                                .否则
                                    .如果 (等于 (单位, “筐”))
                                        赋值 (周转相日销量, 相减 (周转相日销量, 相乘 (到数值 (取文本左边 (读 (“规格2”), 3)), 到数值 (取文本右边 (读 (“规格2”), 2)), 到数值 (读 (“数量2”)))))
                                        赋值 (周转相金额, 相减 (周转相金额, 到数值 (读 (“净水总价2”))))
                                    .否则
                                        .如果 (等于 (单位, “桶”))
                                            赋值 (现辟日销量, 相减 (现辟日销量, 相乘 (到数值 (取文本左边 (读 (“规格2”), 2)), 到数值 (读 (“数量2”)), 1000)))
                                            赋值 (现辟金额, 相减 (现辟金额, 到数值 (读 (“净水总价2”))))
                                        .否则
                                            .如果 (等于 (单位, “罐”))
                                                赋值 (现辟日销量, 相减 (现辟日销量, 相乘 (到数值 (取文本左边 (读 (“规格2”), 相减 (取文本长度 (读 (“规格2”)), 2))), 到数值 (读 (“数量2”)), 1000000)))
                                                赋值 (现辟金额, 相减 (现辟金额, 到数值 (读 (“净水总价2”))))
                                            .否则
                                                
                                            .如果结束
                                            
                                        .如果结束
                                        
                                    .如果结束
                                    
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                    .否则
                        
                    .如果结束
                    .如果 (不等于 (读 (“数量3”), “”))
                        赋值 (单位, 读 (“单位3”))
                        .如果 (并且 (等于 (单位, “箱”), 不等于 (读 (“规格3”), “350ml*24”), 不等于 (读 (“规格3”), “350ml*12”)))
                            赋值 (纸箱日销量, 相减 (纸箱日销量, 相乘 (到数值 (取文本左边 (读 (“规格3”), 3)), 到数值 (取文本右边 (读 (“规格3”), 2)), 到数值 (读 (“数量3”)))))
                            赋值 (纸箱金额, 相减 (纸箱金额, 到数值 (读 (“净水总价3”))))
                        .否则
                            .如果 (等于 (单位, “箱”))
                                赋值 (易拉罐日销量, 相减 (易拉罐日销量, 相乘 (到数值 (取文本左边 (读 (“规格3”), 3)), 到数值 (取文本右边 (读 (“规格3”), 2)), 到数值 (读 (“数量3”)))))
                                赋值 (易拉罐金额, 相减 (易拉罐金额, 到数值 (读 (“净水总价3”))))
                            .否则
                                .如果 (等于 (单位, “包”))
                                    赋值 (塑包日销量, 相减 (塑包日销量, 相乘 (到数值 (取文本左边 (读 (“规格3”), 3)), 到数值 (取文本右边 (读 (“规格3”), 1)), 到数值 (读 (“数量3”)))))
                                    赋值 (塑包金额, 相减 (塑包金额, 到数值 (读 (“净水总价3”))))
                                .否则
                                    .如果 (等于 (单位, “筐”))
                                        赋值 (周转相日销量, 相减 (周转相日销量, 相乘 (到数值 (取文本左边 (读 (“规格3”), 3)), 到数值 (取文本右边 (读 (“规格3”), 2)), 到数值 (读 (“数量3”)))))
                                        赋值 (周转相金额, 相减 (周转相金额, 到数值 (读 (“净水总价3”))))
                                    .否则
                                        .如果 (等于 (单位, “桶”))
                                            赋值 (现辟日销量, 相减 (现辟日销量, 相乘 (到数值 (取文本左边 (读 (“规格3”), 2)), 到数值 (读 (“数量3”)), 1000)))
                                            赋值 (现辟金额, 相减 (现辟金额, 到数值 (读 (“净水总价3”))))
                                        .否则
                                            .如果 (等于 (单位, “罐”))
                                                赋值 (现辟日销量, 相减 (现辟日销量, 相乘 (到数值 (取文本左边 (读 (“规格3”), 相减 (取文本长度 (读 (“规格3”)), 2))), 到数值 (读 (“数量3”)), 1000000)))
                                                赋值 (现辟金额, 相减 (现辟金额, 到数值 (读 (“净水总价3”))))
                                            .否则
                                                
                                            .如果结束
                                            
                                        .如果结束
                                        
                                    .如果结束
                                    
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                    .否则
                        
                    .如果结束
                    .如果 (不等于 (读 (“数量4”), “”))
                        赋值 (单位, 读 (“单位4”))
                        .如果 (并且 (等于 (单位, “箱”), 不等于 (读 (“规格4”), “350ml*24”), 不等于 (读 (“规格4”), “350ml*12”)))
                            赋值 (纸箱日销量, 相减 (纸箱日销量, 相乘 (到数值 (取文本左边 (读 (“规格4”), 3)), 到数值 (取文本右边 (读 (“规格4”), 2)), 到数值 (读 (“数量4”)))))
                            赋值 (纸箱金额, 相减 (纸箱金额, 到数值 (读 (“净水总价4”))))
                        .否则
                            .如果 (等于 (单位, “箱”))
                                赋值 (易拉罐日销量, 相减 (易拉罐日销量, 相乘 (到数值 (取文本左边 (读 (“规格4”), 3)), 到数值 (取文本右边 (读 (“规格4”), 2)), 到数值 (读 (“数量4”)))))
                                赋值 (易拉罐金额, 相减 (易拉罐金额, 到数值 (读 (“净水总价4”))))
                            .否则
                                .如果 (等于 (单位, “包”))
                                    赋值 (塑包日销量, 相减 (塑包日销量, 相乘 (到数值 (取文本左边 (读 (“规格4”), 3)), 到数值 (取文本右边 (读 (“规格4”), 1)), 到数值 (读 (“数量4”)))))
                                    赋值 (塑包金额, 相减 (塑包金额, 到数值 (读 (“净水总价4”))))
                                .否则
                                    .如果 (等于 (单位, “筐”))
                                        赋值 (周转相日销量, 相减 (周转相日销量, 相乘 (到数值 (取文本左边 (读 (“规格4”), 3)), 到数值 (取文本右边 (读 (“规格4”), 2)), 到数值 (读 (“数量4”)))))
                                        赋值 (周转相金额, 相减 (周转相金额, 到数值 (读 (“净水总价4”))))
                                    .否则
                                        .如果 (等于 (单位, “桶”))
                                            赋值 (现辟日销量, 相减 (现辟日销量, 相乘 (到数值 (取文本左边 (读 (“规格4”), 2)), 到数值 (读 (“数量4”)), 1000)))
                                            赋值 (现辟金额, 相减 (现辟金额, 到数值 (读 (“净水总价4”))))
                                        .否则
                                            .如果 (等于 (单位, “罐”))
                                                赋值 (现辟日销量, 相减 (现辟日销量, 相乘 (到数值 (取文本左边 (读 (“规格4”), 相减 (取文本长度 (读 (“规格4”)), 2))), 到数值 (读 (“数量4”)), 1000000)))
                                                赋值 (现辟金额, 相减 (现辟金额, 到数值 (读 (“净水总价4”))))
                                            .否则
                                                
                                            .如果结束
                                            
                                        .如果结束
                                        
                                    .如果结束
                                    
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                    .否则
                        
                    .如果结束
                    
                .如果结束
                
                
                
            .否则
                
            .如果结束
            
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
    赋值 (.内容, 到文本 (四舍五入 (相除 (塑包日销量, 1000000), 3)))
    赋值 (.内容, 到文本 (四舍五入 (相除 (周转相日销量, 1000000), 3)))
    赋值 (.内容, 到文本 (四舍五入 (相除 (纸箱日销量, 1000000), 3)))
    赋值 (.内容, 到文本 (四舍五入 (相除 (易拉罐日销量, 1000000), 3)))
    赋值 (.内容, 到文本 (四舍五入 (相除 (现辟日销量, 1000000), 3)))
    赋值 (.内容, 到文本 (相加 (四舍五入 (相除 (塑包日销量, 1000000), 3), 四舍五入 (相除 (周转相日销量, 1000000), 3), 四舍五入 (相除 (纸箱日销量, 1000000), 3), 四舍五入 (相除 (易拉罐日销量, 1000000), 3), 四舍五入 (相除 (现辟日销量, 1000000), 3))))
    赋值 (.内容, 到文本 (四舍五入 (相除 (塑包金额, 10000), 4)))
    赋值 (.内容, 到文本 (四舍五入 (相除 (周转相金额, 10000), 4)))
    赋值 (.内容, 到文本 (四舍五入 (相除 (纸箱金额, 10000), 4)))
    赋值 (.内容, 到文本 (四舍五入 (相除 (易拉罐金额, 10000), 4)))
    赋值 (.内容, 到文本 (四舍五入 (相除 (现辟金额, 10000), 4)))
    赋值 (.内容, 到文本 (相加 (四舍五入 (相除 (塑包金额, 10000), 4), 四舍五入 (相除 (周转相金额, 10000), 4), 四舍五入 (相除 (纸箱金额, 10000), 4), 四舍五入 (相除 (易拉罐金额, 10000), 4), 四舍五入 (相除 (现辟金额, 10000), 4))))
    .如果 (等于 (取文本左边 (.内容, 1), “-”))
        赋值 (.文本颜色, #红色)
    .否则
        赋值 (.文本颜色, #黑色)
    .如果结束
    .如果 (等于 (取文本左边 (.内容, 1), “-”))
        赋值 (.文本颜色, #红色)
    .否则
        赋值 (.文本颜色, #黑色)
    .如果结束
    .如果 (等于 (取文本左边 (.内容, 1), “-”))
        赋值 (.文本颜色, #红色)
    .否则
        赋值 (.文本颜色, #黑色)
    .如果结束
    .如果 (等于 (取文本左边 (.内容, 1), “-”))
        赋值 (.文本颜色, #红色)
    .否则
        赋值 (.文本颜色, #黑色)
    .如果结束
    .如果 (等于 (取文本左边 (.内容, 1), “-”))
        赋值 (.文本颜色, #红色)
    .否则
        赋值 (.文本颜色, #黑色)
    .如果结束
    .如果 (等于 (取文本左边 (.内容, 1), “-”))
        赋值 (.文本颜色, #红色)
    .否则
        赋值 (.文本颜色, #黑色)
    .如果结束
    .如果 (等于 (取文本左边 (.内容, 1), “-”))
        赋值 (.文本颜色, #红色)
    .否则
        赋值 (.文本颜色, #黑色)
    .如果结束
    .如果 (等于 (取文本左边 (.内容, 1), “-”))
        赋值 (.文本颜色, #红色)
    .否则
        赋值 (.文本颜色, #黑色)
    .如果结束
    .如果 (等于 (取文本左边 (.内容, 1), “-”))
        赋值 (.文本颜色, #红色)
    .否则
        赋值 (.文本颜色, #黑色)
    .如果结束
    .如果 (等于 (取文本左边 (.内容, 1), “-”))
        赋值 (.文本颜色, #红色)
    .否则
        赋值 (.文本颜色, #黑色)
    .如果结束
    .如果 (等于 (取文本左边 (.内容, 1), “-”))
        赋值 (.文本颜色, #红色)
    .否则
        赋值 (.文本颜色, #黑色)
    .如果结束
    .如果 (等于 (取文本左边 (.内容, 1), “-”))
        赋值 (.文本颜色, #红色)
    .否则
        赋值 (.文本颜色, #黑色)
    .如果结束
    
.否则
    信息框 (相加 (“打开”, 到文本 (取年份 (.今天)), “单据数据库错误,请检查单据是否已经存在和完整!”), 0, )
.如果结束
恢复鼠标 ()
全部关闭 ()

.子程序 _按钮1_被单击, 空白型, , 
生成报表 ()

.子程序 _按钮2_被单击, 空白型, , 
生产处日报表.销毁 ()

.窗口程序集 窗口程序集23, , , 

.程序集变量 当前客户, 文本型, , , 
.程序集变量 是否停止, 逻辑型, , , 
.子程序 _单客户品种销量统计表_创建完毕, 空白型, , 
.局部变量 qqq, 文本型, , , 

赋值 (qqq, 取文本注册项 (3, “dysz\tsk”, “真”))
.如果 (等于 (qqq, “真”))
    未知支持库函数_0 (取窗口句柄 (), 相加 (“1、在输入框中输入单位名称、编号或缩写，然后按回车键。”, #换行符, “2、双击输入框，在弹出窗口中选择客户名称。”), 真, 假)
    未知支持库函数_6 (1, “友情提示：”)
    未知支持库函数_4 (#红色)
.否则
    
.如果结束
赋值 (.今天, 到时间 (相加 (到文本 (取年份 (.今天)), “年1月1日”)))
初始化表格 ()

.子程序 初始化表格, 空白型, , 
写到文件 (相加 (未知支持库函数_7 (11), “pzxl.grd”), #品种销量)
相加 (未知支持库函数_7 (11), “pzxl.grd”).从文件读 ()

.子程序 _超级按钮2_被单击, 空白型, , 
.局部变量 分类循环, 整数型, , , 
.局部变量 品种循环, 整数型, , , 
.局部变量 当前分类, 文本型, , , 
.局部变量 当前品种, 文本型, , , 
.局部变量 产品名称数组, 文本型, , "0", 
.局部变量 产品编号数组, 文本型, , "0", 
.局部变量 该条品种, 文本型, , , 
.局部变量 当前产品数量, 整数型, , , 
.局部变量 产品数量, 整数型, , , 
.局部变量 累计销量, 双精度小数型, , , 
.局部变量 累计销售额, 双精度小数型, , , 
.局部变量 千升酒收入, 双精度小数型, , , 
.局部变量 当前库文件名, 文本型, , , 
.局部变量 容量计算, 文本型, , "0", 
.局部变量 分类合并数量, 整数型, , , 
.局部变量 销量合计, 双精度小数型, , , 
.局部变量 销量总合计, 双精度小数型, , , 
.局部变量 销售额总合计, 双精度小数型, , , 
.局部变量 销售额合计, 双精度小数型, , , 
.局部变量 销售额合计含生啤, 双精度小数型, , , 
.局部变量 销量合计含生啤, 双精度小数型, , , 
.局部变量 生啤销量合计, 双精度小数型, , , 
.局部变量 生啤销售额合计, 双精度小数型, , , 
.局部变量 当前单位编号, 文本型, , , 
.局部变量 是否崂啤, 逻辑型, , , 
.局部变量 匿名局部变量_3358, 空白型, , , 
.局部变量 统计文件, 整数型, , , 
.局部变量 临时循环变量, 整数型, , , 
.局部变量 临时文本变量, 文本型, , , 

赋值 (.数据源, “”)
.如果 (等于 (.标题, “”))
    信息框 (“请选择要生成报表的单位，否则不能继续进行处理！”, 0, )
    返回 ()
.否则
    
.如果结束
赋值 (., 真)
获取焦点 ()
置等待鼠标 ()
赋值 (是否停止, 假)
.如果 (小于 (取日期 (.今天), 取日期 (.今天)))
    信息框 (“截止日期不能比开始日期还早，请重新设定！！！”, 0, )
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
.如果 (不等于 (取年份 (取日期 (.今天)), 取年份 (取日期 (.今天))))
    信息框 (“报表处理的数据要求在同一年度，请重新设定开始日期与截止日期！！！”, 0, )
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
写到文件 (相加 (未知支持库函数_7 (11), “pzxl.grd”), #品种销量)
相加 (未知支持库函数_7 (11), “pzxl.grd”).从文件读 ()
0.置表头行数 ()
.如果 (等于 (取日期 (.今天), 取日期 (.今天)))
    1.置文本 (1, 相加 (到文本 (取日期 (.今天)), “单客户品种销量统计表”))
.否则
    1.置文本 (1, 相加 (到文本 (取日期 (.今天)), “至”, 到文本 (取日期 (.今天)), “单客户品种销量统计表”))
.如果结束
3.置表头行数 ()
赋值 (分类循环, 1)
赋值 (品种循环, 1)
赋值 (销售额总合计, 0)
赋值 (销量总合计, 0)

赋值 (统计文件, 打开文件 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 4, ))
.如果 (等于 (统计文件, 0))
    信息框 (“统计数据临时交换文件创建失败，请稍后再试！”, 0, )
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    关闭文件 (统计文件)
.如果结束
.如果 (等于 (打开 (相加 (当前目录, “data\save\”, 到文本 (取年份 (.今天)), “.ldb”), , , , , “lgq”, ), 假))
    全部关闭 ()
    0.置文本 (“”)
    恢复鼠标 ()
    鸣叫 ()
    信息框 (“打开单据数据库错误，请确定该年度数据库确实存在且完整！”, 0, )
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    0.置文本 (相加 (“正在生成统计数据,已经完成”, 到文本 (取整 (相乘 (相除 (取记录号 (), 取记录数 ()), 100))), “%”))
    处理事件 ()
    .如果 (等于 (是否停止, 真))
        全部关闭 ()
        0.置文本 (“”)
        初始化表格 ()
        赋值 (., 假)
        返回 ()
    .否则
        
    .如果结束
    置等待鼠标 ()
    .如果 (并且 (大于或等于 (取日期 (到时间 (读 (“日期”))), 取日期 (.今天)), 小于或等于 (取日期 (到时间 (读 (“日期”))), 取日期 (.今天)), 等于 (读 (“单位编号”), .内容), 等于 (读 (“作废”), 假))) ' 查询条件设置
        .如果 (等于 (读 (“反冲”), 真))
            赋值 (临时循环变量, 1)
            .计次循环首 (4, 临时循环变量)
                赋值 (临时文本变量, 到文本 (临时循环变量))
                .如果 (或者 (等于 (读 (相加 (“单位”, 临时文本变量)), “箱”), 等于 (读 (相加 (“单位”, 临时文本变量)), “筐”), 等于 (读 (相加 (“单位”, 临时文本变量)), “包”)))
                    清除数组 (容量计算)
                    赋值 (容量计算, 分割文本 (读 (相加 (“规格”, 临时文本变量)), “ml*”, ))
                    .如果 (等于 (取数组成员数 (容量计算), 2))
                        赋值 (累计销量, 相乘 (到数值 (容量计算 [1]), 到数值 (容量计算 [2]), 到数值 (读 (相加 (“数量”, 临时文本变量)))))
                    .否则
                        鸣叫 ()
                        信息框 (相加 (“单据”, 读 (“编号”), “存在产品规格错误，不能进行计算”), 0, )
                        全部关闭 ()
                        0.置文本 (“”)
                        恢复鼠标 ()
                        赋值 (., 假)
                        返回 ()
                    .如果结束
                    赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                .否则
                    .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “桶”))
                        赋值 (累计销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 临时文本变量)), 相减 (取文本长度 (读 (相加 (“规格”, 临时文本变量))), 1))), 到数值 (读 (相加 (“数量”, 临时文本变量))), 1000))
                        赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                    .否则
                        .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “罐”))
                            赋值 (累计销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 临时文本变量)), 相减 (取文本长度 (读 (相加 (“规格”, 临时文本变量))), 2))), 到数值 (读 (相加 (“数量”, 临时文本变量))), 1000000))
                            赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                        .否则
                            .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “”))
                                赋值 (累计销量, 0)
                                赋值 (累计销售额, 0)
                            .否则
                                鸣叫 ()
                                信息框 (相加 (“单据”, 读 (“编号”), “存在产品单位错误，不能进行计算”), 0, )
                                全部关闭 ()
                                0.置文本 (“”)
                                恢复鼠标 ()
                                赋值 (., 假)
                                返回 ()
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                写配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销量”, 到文本 (相减 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销量”, “0”)), 累计销量)))
                写配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销售额”, 到文本 (相减 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销售额”, “0”)), 累计销售额)))
            .计次循环尾 ()
        .否则
            赋值 (临时循环变量, 1)
            .计次循环首 (4, 临时循环变量)
                赋值 (临时文本变量, 到文本 (临时循环变量))
                .如果 (或者 (等于 (读 (相加 (“单位”, 临时文本变量)), “箱”), 等于 (读 (相加 (“单位”, 临时文本变量)), “筐”), 等于 (读 (相加 (“单位”, 临时文本变量)), “包”)))
                    清除数组 (容量计算)
                    赋值 (容量计算, 分割文本 (读 (相加 (“规格”, 临时文本变量)), “ml*”, ))
                    .如果 (等于 (取数组成员数 (容量计算), 2))
                        赋值 (累计销量, 相乘 (到数值 (容量计算 [1]), 到数值 (容量计算 [2]), 到数值 (读 (相加 (“数量”, 临时文本变量)))))
                    .否则
                        鸣叫 ()
                        信息框 (相加 (“单据”, 读 (“编号”), “存在产品规格错误，不能进行计算”), 0, )
                        全部关闭 ()
                        0.置文本 (“”)
                        恢复鼠标 ()
                        赋值 (., 假)
                        返回 ()
                    .如果结束
                    赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                .否则
                    .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “桶”))
                        赋值 (累计销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 临时文本变量)), 相减 (取文本长度 (读 (相加 (“规格”, 临时文本变量))), 1))), 到数值 (读 (相加 (“数量”, 临时文本变量))), 1000))
                        赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                    .否则
                        .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “罐”))
                            赋值 (累计销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 临时文本变量)), 相减 (取文本长度 (读 (相加 (“规格”, 临时文本变量))), 2))), 到数值 (读 (相加 (“数量”, 临时文本变量))), 1000000))
                            赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                        .否则
                            .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “”))
                                赋值 (累计销量, 0)
                                赋值 (累计销售额, 0)
                            .否则
                                鸣叫 ()
                                信息框 (相加 (“单据”, 读 (“编号”), “存在产品单位错误，不能进行计算”), 0, )
                                全部关闭 ()
                                0.置文本 (“”)
                                恢复鼠标 ()
                                赋值 (., 假)
                                返回 ()
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                写配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销量”, 到文本 (相加 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销量”, “0”)), 累计销量)))
                写配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销售额”, 到文本 (相加 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销售额”, “0”)), 累计销售额)))
            .计次循环尾 ()
        .如果结束
        
    .否则
        
    .如果结束
    跳过 ()
.判断循环尾 ()
全部关闭 ()

.计次循环首 (3, )
    0.置文本 (“正在整理系统数据……”)
    鸣叫 ()
    赋值 (分类合并数量, 0)
    赋值 (销量合计, 0)
    赋值 (销售额合计, 0)
    .如果 (等于 (分类循环, 1))
        赋值 (当前分类, “高档”)
    .否则
        .如果 (等于 (分类循环, 2))
            赋值 (当前分类, “中档”)
        .否则
            .如果 (等于 (分类循环, 3))
                赋值 (当前分类, “低档”)
            .否则
                
            .如果结束
            
        .如果结束
        
    .如果结束
    赋值 (品种循环, 1)
    .计次循环首 (3, )
        .如果 (等于 (品种循环, 1))
            赋值 (当前品种, “周转箱”)
        .否则
            .如果 (等于 (品种循环, 2))
                赋值 (当前品种, “纸箱”)
            .否则
                .如果 (等于 (品种循环, 3))
                    赋值 (当前品种, “塑包”)
                .否则
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        清除数组 (产品名称数组)
        清除数组 (产品编号数组)
        .如果 (等于 (打开 (相加 (当前目录, “data\cpbh.ldb”), , , , , “lgq”, ), 真))
            到首记录 ()
            .判断循环首 (等于 (尾记录后 (), 假))
                .如果 (等于 (读 (“单位”), “筐”))
                    赋值 (该条品种, “周转箱”)
                .否则
                    .如果 (等于 (读 (“单位”), “箱”))
                        赋值 (该条品种, “纸箱”)
                    .否则
                        .如果 (等于 (读 (“单位”), “包”))
                            赋值 (该条品种, “塑包”)
                        .否则
                            赋值 (该条品种, “其他”)
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                .如果 (并且 (等于 (相加 (读 (“档次”), “档”), 当前分类), 等于 (该条品种, 当前品种)))
                    加入成员 (产品编号数组, 读 (“产品编号”))
                    加入成员 (产品名称数组, 读 (“产品名称”))
                .否则
                    
                .如果结束
                跳过 ()
            .判断循环尾 ()
            全部关闭 ()
            赋值 (产品数量, 取数组成员数 (产品编号数组))
            .如果 (大于 (产品数量, 0))
                赋值 (当前产品数量, 1)
                .计次循环首 (产品数量, )
                    0.置文本 (相加 (“正在处理”, 当前分类, “/”, 当前品种, “/”, 产品编号数组 [当前产品数量], “(”, 产品名称数组 [当前产品数量], “)”, “……”))
                    处理事件 ()
                    .如果 (等于 (是否停止, 真))
                        全部关闭 ()
                        0.置文本 (“”)
                        初始化表格 ()
                        赋值 (., 假)
                        返回 ()
                    .否则
                        
                    .如果结束
                    置等待鼠标 ()
                    赋值 (累计销量, 0)
                    赋值 (累计销售额, 0)
                    1.添加行 ()
                    取行数 ().置文本 (2, 当前分类)
                    取行数 ().置文本 (3, 当前品种)
                    取行数 ().置文本 (4, 产品编号数组 [当前产品数量])
                    取行数 ().置文本 (5, 产品名称数组 [当前产品数量])
                    赋值 (累计销量, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 产品编号数组 [当前产品数量], “销量”, “0”)))
                    赋值 (累计销售额, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 产品编号数组 [当前产品数量], “销售额”, “0”)))
                    取行数 ().置文本 (6, 到文本 (四舍五入 (相除 (累计销量, 1000000), 3)))
                    赋值 (销量合计, 相加 (销量合计, 四舍五入 (相除 (累计销量, 1000000), 3)))
                    取行数 ().置文本 (7, 到文本 (四舍五入 (累计销售额, 2)))
                    赋值 (销售额合计, 相加 (销售额合计, 四舍五入 (累计销售额, 2)))
                    .如果 (等于 (四舍五入 (相除 (累计销量, 1000000), 3), 0))
                        取行数 ().置文本 (8, “”)
                    .否则
                        取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (四舍五入 (累计销售额, 2), 四舍五入 (相除 (累计销量, 1000000), 3)), 2)))
                    .如果结束
                    赋值 (当前产品数量, 相加 (当前产品数量, 1))
                .计次循环尾 ()
                相加 (相减 (取行数 (), 产品数量), 1).合并 (3, 产品数量, 1)
                赋值 (分类合并数量, 相加 (分类合并数量, 产品数量))
            .否则
                
            .如果结束
            
        .否则
            信息框 (“读取产品信息库数据错误，请确认该数据库是否存在且完整！”, 0, )
        .如果结束
        赋值 (品种循环, 相加 (品种循环, 1))
    .计次循环尾 ()
    相加 (相减 (取行数 (), 分类合并数量), 1).合并 (2, 分类合并数量, 1)
    1.添加行 ()
    取行数 ().合并 (2, 1, 4)
    取行数 ().置文本 (2, 相加 (当前分类, “酒合计”))
    取行数 ().置文本 (6, 到文本 (四舍五入 (销量合计, 3)))
    取行数 ().置文本 (7, 到文本 (四舍五入 (销售额合计, 4)))
    .如果 (等于 (四舍五入 (销量合计, 3), 0))
        取行数 ().置文本 (8, “”)
    .否则
        取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (销售额合计, 销量合计), 2)))
    .如果结束
    赋值 (分类循环, 相加 (分类循环, 1))
    赋值 (销量总合计, 相加 (销量总合计, 销量合计))
    赋值 (销售额总合计, 相加 (销售额总合计, 销售额合计))
.计次循环尾 ()



0.置文本 (“正在处理生啤/桶装生啤数据……”)
鸣叫 ()
赋值 (累计销量, 0)
赋值 (累计销售额, 0)
.如果 (等于 (打开 (相加 (当前目录, “data\cpbh.ldb”), , , , , “lgq”, ), 假))
    信息框 (“打开单位索引数据库错误，请确定该数据库确实存在且完整！”, 0, )
    全部关闭 ()
    0.置文本 (“”)
    鸣叫 ()
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (等于 (读 (“单位”), “桶”))
        赋值 (累计销量, 相加 (累计销量, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (“产品编号”), “销量”, “0”))))
        赋值 (累计销售额, 相加 (累计销售额, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (“产品编号”), “销售额”, “0”))))
    .否则
        
    .如果结束
    跳过 ()
.判断循环尾 ()
全部关闭 ()
1.添加行 ()
取行数 ().置文本 (5, “桶装”)
取行数 ().置文本 (6, 到文本 (四舍五入 (相除 (累计销量, 1000000), 3)))
赋值 (销量合计含生啤, 相加 (销量总合计, 四舍五入 (相除 (累计销量, 1000000), 3)))
取行数 ().置文本 (7, 到文本 (四舍五入 (累计销售额, 2)))
赋值 (销售额合计含生啤, 相加 (销售额总合计, 四舍五入 (累计销售额, 2)))
.如果 (等于 (四舍五入 (相除 (累计销量, 1000000), 3), 0))
    取行数 ().置文本 (8, “”)
.否则
    取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (四舍五入 (累计销售额, 2), 四舍五入 (相除 (累计销量, 1000000), 3)), 2)))
.如果结束
赋值 (生啤销量合计, 四舍五入 (相除 (累计销量, 1000000), 3))
赋值 (生啤销售额合计, 四舍五入 (累计销售额, 2))


0.置文本 (“正在处理生啤/罐装生啤数据……”)
鸣叫 ()
赋值 (累计销量, 0)
赋值 (累计销售额, 0)
.如果 (等于 (打开 (相加 (当前目录, “data\cpbh.ldb”), , , , , “lgq”, ), 假))
    信息框 (“打开单位索引数据库错误，请确定该数据库确实存在且完整！”, 0, )
    全部关闭 ()
    0.置文本 (“”)
    鸣叫 ()
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (等于 (读 (“单位”), “罐”))
        赋值 (累计销量, 相加 (累计销量, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (“产品编号”), “销量”, “0”))))
        赋值 (累计销售额, 相加 (累计销售额, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (“产品编号”), “销售额”, “0”))))
    .否则
        
    .如果结束
    跳过 ()
.判断循环尾 ()
全部关闭 ()
1.添加行 ()
取行数 ().置文本 (5, “罐装”)
取行数 ().置文本 (6, 到文本 (四舍五入 (相除 (累计销量, 1000000), 3)))
赋值 (销量合计含生啤, 相加 (销量合计含生啤, 四舍五入 (相除 (累计销量, 1000000), 3)))
取行数 ().置文本 (7, 到文本 (四舍五入 (累计销售额, 2)))
赋值 (销售额合计含生啤, 相加 (销售额合计含生啤, 四舍五入 (累计销售额, 2)))
.如果 (等于 (四舍五入 (相除 (累计销量, 1000000), 3), 0))
    取行数 ().置文本 (8, “”)
.否则
    取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (四舍五入 (累计销售额, 2), 四舍五入 (相除 (累计销量, 1000000), 3)), 2)))
.如果结束
赋值 (生啤销量合计, 相加 (生啤销量合计, 四舍五入 (相除 (累计销量, 1000000), 3)))
赋值 (生啤销售额合计, 相加 (生啤销售额合计, 四舍五入 (累计销售额, 2)))

1.添加行 ()
取行数 ().置文本 (6, 到文本 (生啤销量合计))
取行数 ().置文本 (7, 到文本 (生啤销售额合计))
.如果 (等于 (生啤销量合计, 0))
    取行数 ().置文本 (8, “”)
.否则
    取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (生啤销售额合计, 生啤销量合计), 2)))
.如果结束


相减 (取行数 (), 2).合并 (2, 3, 2)
相减 (取行数 (), 2).置文本 (2, “生啤”)

取行数 ().合并 (4, 1, 2)
取行数 ().置文本 (4, “生啤合计”)

1.添加行 ()
取行数 ().合并 (2, 1, 4)
取行数 ().置文本 (2, “总合计(含生啤)”)
取行数 ().置文本 (6, 到文本 (销量合计含生啤))
取行数 ().置文本 (7, 到文本 (销售额合计含生啤))
.如果 (等于 (销量合计含生啤, 0))
    取行数 ().置文本 (8, “”)
.否则
    取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (销售额合计含生啤, 销量合计含生啤), 2)))
.如果结束

1.添加行 ()
取行数 ().合并 (2, 1, 4)
取行数 ().置文本 (2, “总合计(不含生啤)”)
取行数 ().置文本 (6, 到文本 (销量总合计))
取行数 ().置文本 (7, 到文本 (销售额总合计))
.如果 (等于 (销量总合计, 0))
    取行数 ().置文本 (8, “”)
.否则
    取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (销售额总合计, 销量总合计), 2)))
.如果结束

4.合并 (1, 相减 (取行数 (), 3), 1)
4.置文本 (1, 当前客户)
4.置对齐方式 (1, 相减 (取行数 (), 3), 8, 5)
4.加线条 (1, 相减 (取行数 (), 3), 8, 63)
4.加线条 (1, 相减 (取行数 (), 3), 1, )
全部关闭 ()
0.置文本 (“”)
鸣叫 ()
恢复鼠标 ()
赋值 (., 假)
赋值 (.数据源, “数据源1”)

.子程序 _单位编号_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.局部变量 判断文字, 文本型, , , 

赋值 (判断文字, .内容)
赋值 (当前客户, “”)
赋值 (.标题, “”)
.如果 (等于 (字符代码, 13))
    .如果 (等于 (打开 (相加 (当前目录, “data\index.ldb”), , , , , “lgq”, ), 真))
        .如果 (大于 (到数值 (判断文字), 0))
            到首记录 ()
            .如果 (等于 (查找 (等于 (读 (“编号”), 判断文字)), 真))
                赋值 (.内容, 读 (“编号”))
                赋值 (当前客户, 读 (“名称”))
                赋值 (.标题, 当前客户)
                获取焦点 ()
            .否则
                信息框 (相加 (“数据错误：没有编号为”, 判断文字, “的单位，请检查输入是否正确!”), 0, )
                赋值 (.内容, “”)
            .如果结束
            
        .否则
            .如果 (并且 (小于或等于 (取文本长度 (判断文字), 6), 等于 (相乘 (取文本长度 (判断文字), 2), 取文本长度 (到全角 (判断文字)))))
                到首记录 ()
                .如果 (等于 (查找 (等于 (读 (“缩写”), 判断文字)), 真))
                    赋值 (.内容, 读 (“编号”))
                    赋值 (当前客户, 读 (“名称”))
                    赋值 (.标题, 当前客户)
                    获取焦点 ()
                .否则
                    信息框 (相加 (“数据错误：没有缩写为”, 判断文字, “的单位，请检查输入是否正确!”), 0, )
                    赋值 (.内容, “”)
                .如果结束
                
            .否则
                .如果 (等于 (查找 (等于 (读 (“名称”), .内容)), 真))
                    赋值 (.内容, 读 (“编号”))
                    赋值 (当前客户, 读 (“名称”))
                    赋值 (.标题, 当前客户)
                    获取焦点 ()
                .否则
                    信息框 (相加 (“数据错误：没有名称为”, 判断文字, “的单位，请检查输入是否正确!”), 0, )
                    赋值 (.内容, “”)
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .否则
        信息框 (“打开索引数据库错误，请确定索引数据库存在且完整！”, 0, )
        赋值 (.内容, “”)
    .如果结束
    
.否则
    
.如果结束
全部关闭 ()

.子程序 _单客户品种销量统计表_尺寸被改变, 空白型, , 
相减 (单客户品种销量统计表., .宽度, 15).移动 (10, , )
0.移动 (10, 相减 (单客户品种销量统计表., .宽度, 20), 相减 (单客户品种销量统计表., ., 43))
.移动 (.左边, 相加 (.顶边, .高度, 5), , )

.子程序 _超级按钮1_被单击, 空白型, , 
打印预览 ()

.子程序 _超级按钮3_被单击, 空白型, , 
赋值 (.文件名, 相加 (4.取文本 (1), “_”, 1.取文本 (1)))
.如果 (等于 (打开 (), 真))
    .存到文件 (.文件名)
.否则
    
.如果结束


.子程序 _超级按钮5_被单击, 空白型, , 
.如果 (等于 (., 假))
    单客户品种销量统计表.销毁 ()
.否则
    信息框 (“请等待报表生成完毕，或取消生成后再关闭本窗口！”, 0, )
.如果结束


.子程序 _超级按钮2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    _超级按钮2_被单击 ()
.否则
    
.如果结束


.子程序 _超级按钮4_被单击, 空白型, , 
.如果 (等于 (打开 (), 真))
    .从文件读 (.文件名)
.否则
    
.如果结束


.子程序 _超级按钮6_被单击, 空白型, , 
.局部变量 临时文件名, 文本型, , , 

赋值 (.文件名, 相加 (4.取文本 (1), “_”, 1.取文本 (1)))
.如果 (等于 (打开 (), 真))
    赋值 (临时文件名, 取临时文件名 ())
    5.添加行 ()
    .如果 (等于 (临时文件名.存到文件 (), 真))
        .如果 (等于 (转换数据 (临时文件名, 1, .文件名), 真))
            信息框 (“该报表数据已经成功转换为EXCEL文件！”, 0, )
        .否则
            信息框 (“该报表数据暂时不能转换为EXCEL文件，请稍后再试！”, 0, )
        .如果结束
        
    .否则
        信息框 (“该报表数据暂时不能转换为EXCEL文件，请稍后再试！”, 0, )
    .如果结束
    相减 (取行数 (), 4).删除行 (5)
    删除文件 (临时文件名)
.否则
    
.如果结束


.子程序 _单位编号_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (选择客户, , 真)

.子程序 _单客户品种销量统计表_可否被关闭, 逻辑型, , 
赋值 (是否停止, 真)
返回 (假)

.窗口程序集 窗口程序集24, , , 

.程序集变量 当前办事处, 文本型, , , 
.程序集变量 是否停止, 逻辑型, , , 
.子程序 初始化表格, 空白型, , 
写到文件 (相加 (未知支持库函数_7 (11), “pzxl.grd”), #品种销量)
相加 (未知支持库函数_7 (11), “pzxl.grd”).从文件读 ()
0.置表头行数 ()
2.置文本 (1, “办事处”)
3.置表头行数 ()

.子程序 _超级按钮2_被单击, 空白型, , 
.局部变量 分类循环, 整数型, , , 
.局部变量 品种循环, 整数型, , , 
.局部变量 当前分类, 文本型, , , 
.局部变量 当前品种, 文本型, , , 
.局部变量 产品名称数组, 文本型, , "0", 
.局部变量 产品编号数组, 文本型, , "0", 
.局部变量 该条品种, 文本型, , , 
.局部变量 当前产品数量, 整数型, , , 
.局部变量 产品数量, 整数型, , , 
.局部变量 累计销量, 双精度小数型, , , 
.局部变量 累计销售额, 双精度小数型, , , 
.局部变量 千升酒收入, 双精度小数型, , , 
.局部变量 当前库文件名, 文本型, , , 
.局部变量 容量计算, 文本型, , "0", 
.局部变量 分类合并数量, 整数型, , , 
.局部变量 销量合计, 双精度小数型, , , 
.局部变量 销量总合计, 双精度小数型, , , 
.局部变量 销售额总合计, 双精度小数型, , , 
.局部变量 销售额合计, 双精度小数型, , , 
.局部变量 销售额合计含生啤, 双精度小数型, , , 
.局部变量 销量合计含生啤, 双精度小数型, , , 
.局部变量 生啤销量合计, 双精度小数型, , , 
.局部变量 生啤销售额合计, 双精度小数型, , , 
.局部变量 当前单位编号, 文本型, , , 
.局部变量 统计文件, 整数型, , , 
.局部变量 临时循环变量, 整数型, , , 
.局部变量 临时文本变量, 文本型, , , 
.局部变量 是否符合, 逻辑型, , , 
.局部变量 是否崂啤, 逻辑型, , , 

赋值 (.数据源, “”)
赋值 (., 真)
获取焦点 ()
置等待鼠标 ()
赋值 (是否停止, 假)
.如果 (等于 (.标题, “”))
    信息框 (“请选择要生成报表的办事处，否则不能继续进行处理！”, 0, )
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
.如果 (小于 (取日期 (.今天), 取日期 (.今天)))
    信息框 (“截止日期不能比开始日期还早，请重新设定！！！”, 0, )
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
.如果 (不等于 (取年份 (取日期 (.今天)), 取年份 (取日期 (.今天))))
    信息框 (“报表处理的数据要求在同一年度，请重新设定开始日期与截止日期！！！”, 0, )
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
写到文件 (相加 (未知支持库函数_7 (11), “pzxl.grd”), #品种销量)
相加 (未知支持库函数_7 (11), “pzxl.grd”).从文件读 ()
0.置表头行数 ()
.如果 (等于 (取日期 (.今天), 取日期 (.今天)))
    1.置文本 (1, 相加 (到文本 (取日期 (.今天)), “办事处品种销量统计表”))
.否则
    1.置文本 (1, 相加 (到文本 (取日期 (.今天)), “至”, 到文本 (取日期 (.今天)), “办事处品种销量统计表”))
.如果结束
2.置文本 (1, “办事处”)
3.置表头行数 ()
赋值 (分类循环, 1)
赋值 (品种循环, 1)
赋值 (销售额总合计, 0)
赋值 (销量总合计, 0)


赋值 (统计文件, 打开文件 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 4, ))
.如果 (等于 (统计文件, 0))
    信息框 (“统计数据临时交换文件创建失败，请稍后再试！”, 0, )
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    关闭文件 (统计文件)
.如果结束
.如果 (等于 (打开 (相加 (当前目录, “data\save\”, 到文本 (取年份 (.今天)), “.ldb”), , , , , “lgq”, ), 假))
    全部关闭 ()
    0.置文本 (“”)
    恢复鼠标 ()
    鸣叫 ()
    信息框 (“打开单据数据库错误，请确定该年度数据库确实存在且完整！”, 0, )
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    0.置文本 (相加 (“正在生成统计数据,已经完成”, 到文本 (取整 (相乘 (相除 (取记录号 (), 取记录数 ()), 100))), “%”))
    处理事件 ()
    .如果 (等于 (是否停止, 真))
        全部关闭 ()
        0.置文本 (“”)
        初始化表格 ()
        赋值 (., 假)
        返回 ()
    .否则
        
    .如果结束
    置等待鼠标 ()
    .如果 (并且 (大于或等于 (取日期 (到时间 (读 (“日期”))), 取日期 (.今天)), 小于或等于 (取日期 (到时间 (读 (“日期”))), 取日期 (.今天)), 等于 (读 (“作废”), 假))) ' 查询条件设置
        赋值 (当前单位编号, 读 (“单位编号”))
        赋值 (当前库文件名, 取当前库 ())
        .如果 (等于 (打开 (相加 (当前目录, “data\index.ldb”), , , , , “lgq”, ), 假))
            全部关闭 ()
            0.置文本 (“”)
            恢复鼠标 ()
            鸣叫 ()
            信息框 (“打开索引数据库错误，请确定该数据库确实存在且完整！”, 0, )
            赋值 (., 假)
            返回 ()
        .否则
            
        .如果结束
        置当前库 (相加 (当前目录, “data\index.ldb”))
        到首记录 ()
        .如果 (等于 (查找 (等于 (读 (“编号”), 当前单位编号)), 真))
            .如果 (等于 (读 (“所属办事处”), .标题))
                赋值 (是否符合, 真)
            .否则
                赋值 (是否符合, 假)
            .如果结束
            
        .否则
            全部关闭 ()
            0.置文本 (“”)
            恢复鼠标 ()
            鸣叫 ()
            信息框 (相加 (“编号为：”, 当前单位编号, “的单位不存在，请检查索引数据库！”), 0, )
            赋值 (., 假)
            返回 ()
            
        .如果结束
        关闭 ()
        置当前库 (当前库文件名)
        .如果 (等于 (是否符合, 真))
            .如果 (等于 (读 (“反冲”), 真))
                赋值 (临时循环变量, 1)
                .计次循环首 (4, 临时循环变量)
                    赋值 (临时文本变量, 到文本 (临时循环变量))
                    .如果 (或者 (等于 (读 (相加 (“单位”, 临时文本变量)), “箱”), 等于 (读 (相加 (“单位”, 临时文本变量)), “筐”), 等于 (读 (相加 (“单位”, 临时文本变量)), “包”)))
                        清除数组 (容量计算)
                        赋值 (容量计算, 分割文本 (读 (相加 (“规格”, 临时文本变量)), “ml*”, ))
                        .如果 (等于 (取数组成员数 (容量计算), 2))
                            赋值 (累计销量, 相乘 (到数值 (容量计算 [1]), 到数值 (容量计算 [2]), 到数值 (读 (相加 (“数量”, 临时文本变量)))))
                        .否则
                            鸣叫 ()
                            信息框 (相加 (“单据”, 读 (“编号”), “存在产品规格错误，不能进行计算”), 0, )
                            全部关闭 ()
                            0.置文本 (“”)
                            恢复鼠标 ()
                            赋值 (., 假)
                            返回 ()
                        .如果结束
                        赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                    .否则
                        .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “桶”))
                            赋值 (累计销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 临时文本变量)), 相减 (取文本长度 (读 (相加 (“规格”, 临时文本变量))), 1))), 到数值 (读 (相加 (“数量”, 临时文本变量))), 1000))
                            赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                        .否则
                            .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “罐”))
                                赋值 (累计销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 临时文本变量)), 相减 (取文本长度 (读 (相加 (“规格”, 临时文本变量))), 2))), 到数值 (读 (相加 (“数量”, 临时文本变量))), 1000000))
                                赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                            .否则
                                .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “”))
                                    赋值 (累计销量, 0)
                                    赋值 (累计销售额, 0)
                                .否则
                                    鸣叫 ()
                                    信息框 (相加 (“单据”, 读 (“编号”), “存在产品单位错误，不能进行计算”), 0, )
                                    全部关闭 ()
                                    0.置文本 (“”)
                                    恢复鼠标 ()
                                    赋值 (., 假)
                                    返回 ()
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    写配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销量”, 到文本 (相减 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销量”, “0”)), 累计销量)))
                    写配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销售额”, 到文本 (相减 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销售额”, “0”)), 累计销售额)))
                .计次循环尾 ()
            .否则
                赋值 (临时循环变量, 1)
                .计次循环首 (4, 临时循环变量)
                    赋值 (临时文本变量, 到文本 (临时循环变量))
                    .如果 (或者 (等于 (读 (相加 (“单位”, 临时文本变量)), “箱”), 等于 (读 (相加 (“单位”, 临时文本变量)), “筐”), 等于 (读 (相加 (“单位”, 临时文本变量)), “包”)))
                        清除数组 (容量计算)
                        赋值 (容量计算, 分割文本 (读 (相加 (“规格”, 临时文本变量)), “ml*”, ))
                        .如果 (等于 (取数组成员数 (容量计算), 2))
                            赋值 (累计销量, 相乘 (到数值 (容量计算 [1]), 到数值 (容量计算 [2]), 到数值 (读 (相加 (“数量”, 临时文本变量)))))
                        .否则
                            鸣叫 ()
                            信息框 (相加 (“单据”, 读 (“编号”), “存在产品规格错误，不能进行计算”), 0, )
                            全部关闭 ()
                            0.置文本 (“”)
                            恢复鼠标 ()
                            赋值 (., 假)
                            返回 ()
                        .如果结束
                        赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                    .否则
                        .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “桶”))
                            赋值 (累计销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 临时文本变量)), 相减 (取文本长度 (读 (相加 (“规格”, 临时文本变量))), 1))), 到数值 (读 (相加 (“数量”, 临时文本变量))), 1000))
                            赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                        .否则
                            .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “罐”))
                                赋值 (累计销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 临时文本变量)), 相减 (取文本长度 (读 (相加 (“规格”, 临时文本变量))), 2))), 到数值 (读 (相加 (“数量”, 临时文本变量))), 1000000))
                                赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                            .否则
                                .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “”))
                                    赋值 (累计销量, 0)
                                    赋值 (累计销售额, 0)
                                .否则
                                    鸣叫 ()
                                    信息框 (相加 (“单据”, 读 (“编号”), “存在产品单位错误，不能进行计算”), 0, )
                                    全部关闭 ()
                                    0.置文本 (“”)
                                    恢复鼠标 ()
                                    赋值 (., 假)
                                    返回 ()
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    写配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销量”, 到文本 (相加 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销量”, “0”)), 累计销量)))
                    写配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销售额”, 到文本 (相加 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销售额”, “0”)), 累计销售额)))
                .计次循环尾 ()
            .如果结束
            
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    跳过 ()
.判断循环尾 ()
全部关闭 ()

.计次循环首 (3, )
    0.置文本 (“正在整理系统数据……”)
    鸣叫 ()
    赋值 (分类合并数量, 0)
    赋值 (销量合计, 0)
    赋值 (销售额合计, 0)
    .如果 (等于 (分类循环, 1))
        赋值 (当前分类, “高档”)
    .否则
        .如果 (等于 (分类循环, 2))
            赋值 (当前分类, “中档”)
        .否则
            .如果 (等于 (分类循环, 3))
                赋值 (当前分类, “低档”)
            .否则
                
            .如果结束
            
        .如果结束
        
    .如果结束
    赋值 (品种循环, 1)
    .计次循环首 (3, )
        .如果 (等于 (品种循环, 1))
            赋值 (当前品种, “周转箱”)
        .否则
            .如果 (等于 (品种循环, 2))
                赋值 (当前品种, “纸箱”)
            .否则
                .如果 (等于 (品种循环, 3))
                    赋值 (当前品种, “塑包”)
                .否则
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        清除数组 (产品名称数组)
        清除数组 (产品编号数组)
        .如果 (等于 (打开 (相加 (当前目录, “data\cpbh.ldb”), , , , , “lgq”, ), 真))
            到首记录 ()
            .判断循环首 (等于 (尾记录后 (), 假))
                .如果 (等于 (读 (“单位”), “筐”))
                    赋值 (该条品种, “周转箱”)
                .否则
                    .如果 (等于 (读 (“单位”), “箱”))
                        赋值 (该条品种, “纸箱”)
                    .否则
                        .如果 (等于 (读 (“单位”), “包”))
                            赋值 (该条品种, “塑包”)
                        .否则
                            赋值 (该条品种, “其他”)
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                .如果 (并且 (等于 (相加 (读 (“档次”), “档”), 当前分类), 等于 (该条品种, 当前品种)))
                    加入成员 (产品编号数组, 读 (“产品编号”))
                    加入成员 (产品名称数组, 读 (“产品名称”))
                .否则
                    
                .如果结束
                跳过 ()
            .判断循环尾 ()
            全部关闭 ()
            赋值 (产品数量, 取数组成员数 (产品编号数组))
            .如果 (大于 (产品数量, 0))
                赋值 (当前产品数量, 1)
                .计次循环首 (产品数量, )
                    0.置文本 (相加 (“正在处理”, 当前分类, “/”, 当前品种, “/”, 产品编号数组 [当前产品数量], “(”, 产品名称数组 [当前产品数量], “)”, “……”))
                    处理事件 ()
                    .如果 (等于 (是否停止, 真))
                        全部关闭 ()
                        0.置文本 (“”)
                        初始化表格 ()
                        赋值 (., 假)
                        返回 ()
                    .否则
                        
                    .如果结束
                    置等待鼠标 ()
                    赋值 (累计销量, 0)
                    赋值 (累计销售额, 0)
                    1.添加行 ()
                    取行数 ().置文本 (2, 当前分类)
                    取行数 ().置文本 (3, 当前品种)
                    取行数 ().置文本 (4, 产品编号数组 [当前产品数量])
                    取行数 ().置文本 (5, 产品名称数组 [当前产品数量])
                    赋值 (累计销量, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 产品编号数组 [当前产品数量], “销量”, “0”)))
                    赋值 (累计销售额, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 产品编号数组 [当前产品数量], “销售额”, “0”)))
                    取行数 ().置文本 (6, 到文本 (四舍五入 (相除 (累计销量, 1000000), 3)))
                    赋值 (销量合计, 相加 (销量合计, 四舍五入 (相除 (累计销量, 1000000), 3)))
                    取行数 ().置文本 (7, 到文本 (四舍五入 (累计销售额, 2)))
                    赋值 (销售额合计, 相加 (销售额合计, 四舍五入 (累计销售额, 2)))
                    .如果 (等于 (四舍五入 (相除 (累计销量, 1000000), 3), 0))
                        取行数 ().置文本 (8, “”)
                    .否则
                        取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (四舍五入 (累计销售额, 2), 四舍五入 (相除 (累计销量, 1000000), 3)), 2)))
                    .如果结束
                    赋值 (当前产品数量, 相加 (当前产品数量, 1))
                .计次循环尾 ()
                相加 (相减 (取行数 (), 产品数量), 1).合并 (3, 产品数量, 1)
                赋值 (分类合并数量, 相加 (分类合并数量, 产品数量))
            .否则
                
            .如果结束
            
        .否则
            信息框 (“读取产品信息库数据错误，请确认该数据库是否存在且完整！”, 0, )
        .如果结束
        赋值 (品种循环, 相加 (品种循环, 1))
    .计次循环尾 ()
    相加 (相减 (取行数 (), 分类合并数量), 1).合并 (2, 分类合并数量, 1)
    1.添加行 ()
    取行数 ().合并 (2, 1, 4)
    取行数 ().置文本 (2, 相加 (当前分类, “酒合计”))
    取行数 ().置文本 (6, 到文本 (四舍五入 (销量合计, 3)))
    取行数 ().置文本 (7, 到文本 (四舍五入 (销售额合计, 4)))
    .如果 (等于 (四舍五入 (销量合计, 3), 0))
        取行数 ().置文本 (8, “”)
    .否则
        取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (销售额合计, 销量合计), 2)))
    .如果结束
    赋值 (分类循环, 相加 (分类循环, 1))
    赋值 (销量总合计, 相加 (销量总合计, 销量合计))
    赋值 (销售额总合计, 相加 (销售额总合计, 销售额合计))
.计次循环尾 ()



0.置文本 (“正在处理生啤/桶装生啤数据……”)
鸣叫 ()
赋值 (累计销量, 0)
赋值 (累计销售额, 0)
.如果 (等于 (打开 (相加 (当前目录, “data\cpbh.ldb”), , , , , “lgq”, ), 假))
    信息框 (“打开单位索引数据库错误，请确定该数据库确实存在且完整！”, 0, )
    全部关闭 ()
    0.置文本 (“”)
    鸣叫 ()
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (等于 (读 (“单位”), “桶”))
        赋值 (累计销量, 相加 (累计销量, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (“产品编号”), “销量”, “0”))))
        赋值 (累计销售额, 相加 (累计销售额, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (“产品编号”), “销售额”, “0”))))
    .否则
        
    .如果结束
    跳过 ()
.判断循环尾 ()
全部关闭 ()
1.添加行 ()
取行数 ().置文本 (5, “桶装”)
取行数 ().置文本 (6, 到文本 (四舍五入 (相除 (累计销量, 1000000), 3)))
赋值 (销量合计含生啤, 相加 (销量总合计, 四舍五入 (相除 (累计销量, 1000000), 3)))
取行数 ().置文本 (7, 到文本 (四舍五入 (累计销售额, 2)))
赋值 (销售额合计含生啤, 相加 (销售额总合计, 四舍五入 (累计销售额, 2)))
.如果 (等于 (四舍五入 (相除 (累计销量, 1000000), 3), 0))
    取行数 ().置文本 (8, “”)
.否则
    取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (四舍五入 (累计销售额, 2), 四舍五入 (相除 (累计销量, 1000000), 3)), 2)))
.如果结束
赋值 (生啤销量合计, 四舍五入 (相除 (累计销量, 1000000), 3))
赋值 (生啤销售额合计, 四舍五入 (累计销售额, 2))


0.置文本 (“正在处理生啤/罐装生啤数据……”)
鸣叫 ()
赋值 (累计销量, 0)
赋值 (累计销售额, 0)
.如果 (等于 (打开 (相加 (当前目录, “data\cpbh.ldb”), , , , , “lgq”, ), 假))
    信息框 (“打开单位索引数据库错误，请确定该数据库确实存在且完整！”, 0, )
    全部关闭 ()
    0.置文本 (“”)
    鸣叫 ()
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (等于 (读 (“单位”), “罐”))
        赋值 (累计销量, 相加 (累计销量, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (“产品编号”), “销量”, “0”))))
        赋值 (累计销售额, 相加 (累计销售额, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (“产品编号”), “销售额”, “0”))))
    .否则
        
    .如果结束
    跳过 ()
.判断循环尾 ()
全部关闭 ()
1.添加行 ()
取行数 ().置文本 (5, “罐装”)
取行数 ().置文本 (6, 到文本 (四舍五入 (相除 (累计销量, 1000000), 3)))
赋值 (销量合计含生啤, 相加 (销量合计含生啤, 四舍五入 (相除 (累计销量, 1000000), 3)))
取行数 ().置文本 (7, 到文本 (四舍五入 (累计销售额, 2)))
赋值 (销售额合计含生啤, 相加 (销售额合计含生啤, 四舍五入 (累计销售额, 2)))
.如果 (等于 (四舍五入 (相除 (累计销量, 1000000), 3), 0))
    取行数 ().置文本 (8, “”)
.否则
    取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (四舍五入 (累计销售额, 2), 四舍五入 (相除 (累计销量, 1000000), 3)), 2)))
.如果结束
赋值 (生啤销量合计, 相加 (生啤销量合计, 四舍五入 (相除 (累计销量, 1000000), 3)))
赋值 (生啤销售额合计, 相加 (生啤销售额合计, 四舍五入 (累计销售额, 2)))

1.添加行 ()
取行数 ().置文本 (6, 到文本 (生啤销量合计))
取行数 ().置文本 (7, 到文本 (生啤销售额合计))
.如果 (等于 (生啤销量合计, 0))
    取行数 ().置文本 (8, “”)
.否则
    取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (生啤销售额合计, 生啤销量合计), 2)))
.如果结束


相减 (取行数 (), 2).合并 (2, 3, 2)
相减 (取行数 (), 2).置文本 (2, “生啤”)

取行数 ().合并 (4, 1, 2)
取行数 ().置文本 (4, “生啤合计”)

1.添加行 ()
取行数 ().合并 (2, 1, 4)
取行数 ().置文本 (2, “总合计(含生啤)”)
取行数 ().置文本 (6, 到文本 (销量合计含生啤))
取行数 ().置文本 (7, 到文本 (销售额合计含生啤))
.如果 (等于 (销量合计含生啤, 0))
    取行数 ().置文本 (8, “”)
.否则
    取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (销售额合计含生啤, 销量合计含生啤), 2)))
.如果结束

1.添加行 ()
取行数 ().合并 (2, 1, 4)
取行数 ().置文本 (2, “总合计(不含生啤)”)
取行数 ().置文本 (6, 到文本 (销量总合计))
取行数 ().置文本 (7, 到文本 (销售额总合计))
.如果 (等于 (销量总合计, 0))
    取行数 ().置文本 (8, “”)
.否则
    取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (销售额总合计, 销量总合计), 2)))
.如果结束


4.合并 (1, 相减 (取行数 (), 3), 1)
4.置文本 (1, .标题)
4.置对齐方式 (1, 相减 (取行数 (), 3), 8, 5)
4.加线条 (1, 相减 (取行数 (), 3), 8, 63)
4.加线条 (1, 相减 (取行数 (), 3), 1, )
全部关闭 ()
0.置文本 (“”)
鸣叫 ()
恢复鼠标 ()
赋值 (., 假)
赋值 (.数据源, “数据源1”)

.子程序 _办事处品种销量统计表_尺寸被改变, 空白型, , 
相减 (办事处品种销量统计表., .宽度, 15).移动 (10, , )
0.移动 (10, 相减 (办事处品种销量统计表., .宽度, 20), 相减 (办事处品种销量统计表., ., 43))
.移动 (.左边, 相加 (.顶边, .高度, 5), , )

.子程序 _超级按钮1_被单击, 空白型, , 
打印预览 ()

.子程序 _超级按钮3_被单击, 空白型, , 
赋值 (.文件名, 相加 (4.取文本 (1), “_”, 1.取文本 (1)))
.如果 (等于 (打开 (), 真))
    .存到文件 (.文件名)
.否则
    
.如果结束


.子程序 _超级按钮5_被单击, 空白型, , 
.如果 (等于 (., 假))
    办事处品种销量统计表.销毁 ()
.否则
    信息框 (“请等待报表生成完毕，或取消生成后再关闭本窗口！”, 0, )
.如果结束


.子程序 _超级按钮2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    _超级按钮2_被单击 ()
.否则
    
.如果结束


.子程序 _超级按钮4_被单击, 空白型, , 
.如果 (等于 (打开 (), 真))
    .从文件读 (.文件名)
.否则
    
.如果结束


.子程序 _超级按钮6_被单击, 空白型, , 
.局部变量 临时文件名, 文本型, , , 

赋值 (.文件名, 相加 (4.取文本 (1), “_”, 1.取文本 (1)))
.如果 (等于 (打开 (), 真))
    赋值 (临时文件名, 取临时文件名 ())
    5.添加行 ()
    .如果 (等于 (临时文件名.存到文件 (), 真))
        .如果 (等于 (转换数据 (临时文件名, 1, .文件名), 真))
            信息框 (“该报表数据已经成功转换为EXCEL文件！”, 0, )
        .否则
            信息框 (“该报表数据暂时不能转换为EXCEL文件，请稍后再试！”, 0, )
        .如果结束
        
    .否则
        信息框 (“该报表数据暂时不能转换为EXCEL文件，请稍后再试！”, 0, )
    .如果结束
    相减 (取行数 (), 4).删除行 (5)
    删除文件 (临时文件名)
.否则
    
.如果结束


.子程序 _办事处品种销量统计表_创建完毕, 空白型, , 
赋值 (.今天, 到时间 (相加 (到文本 (取年份 (.今天)), “年1月1日”)))
初始化表格 ()
片区刷新 ()
办事处刷新 ()
_办事处_列表项被选择 ()

.子程序 片区刷新, 空白型, , 
.局部变量 临时变量, 整数型, , , 

赋值 (临时变量, 1)
清空 ()
.计次循环首 (到数值 (读配置项 (相加 (当前目录, “data\pq.ldb”), “片区”, “总数”, “0”)), )
    读配置项 (相加 (当前目录, “data\pq.ldb”), “片区”, 相加 (“vol”, 到文本 (临时变量)), ).加入项目 ()
    赋值 (临时变量, 相加 (临时变量, 1))
.计次循环尾 ()
赋值 (.现行选中项, 0)

.子程序 办事处刷新, 空白型, , 
.局部变量 临时变量, 整数型, , , 
.局部变量 当前片区, 文本型, , , 

赋值 (临时变量, 1)
清空 ()
.计次循环首 (到数值 (读配置项 (相加 (当前目录, “data\pq.ldb”), .取项目文本 (.现行选中项), “总数”, “0”)), )
    读配置项 (相加 (当前目录, “data\pq.ldb”), .取项目文本 (.现行选中项), 相加 (“vol”, 到文本 (临时变量)), ).加入项目 ()
    赋值 (临时变量, 相加 (临时变量, 1))
.计次循环尾 ()
赋值 (.现行选中项, 0)

.子程序 _片区_列表项被选择, 空白型, , 
办事处刷新 ()
_办事处_列表项被选择 ()

.子程序 _办事处_列表项被选择, 空白型, , 
赋值 (.标题, .取项目文本 (.现行选中项))

.子程序 _办事处品种销量统计表_可否被关闭, 逻辑型, , 
赋值 (是否停止, 真)
返回 (假)

.窗口程序集 窗口程序集25, , , 

.子程序 _选择客户_创建完毕, 空白型, , 
.如果 (等于 (打开 (相加 (当前目录, “data\index.ldb”), , , , , “lgq”, ), 真))
    片区刷新 ()
    办事处刷新 ()
    单位刷新 ()
.否则
    信息框 (相加 (“数据库损坏，请恢复系统数据库！”, #换行符, “如果问题不能解决，建议初始化数据库或重新安装系统！”), 0, )
    选择客户.销毁 ()
.如果结束


.子程序 _片区_列表项被选择, 空白型, , 
办事处刷新 ()
单位刷新 ()

.子程序 _办事处_列表项被选择, 空白型, , 
单位刷新 ()

.子程序 单位刷新, 空白型, , 
全部删除 ()
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (并且 (等于 (读 (“所属片区”), .取项目文本 (.现行选中项)), 等于 (读 (“所属办事处”), .取项目文本 (.现行选中项))))
        -1.插入表项 (读 (“编号”), , , , )
        相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
        相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
    .否则
        
    .如果结束
    跳过 ()
.判断循环尾 ()

.子程序 _单位_当前表项被改变, 空白型, , 
.如果 (不等于 (., -1))
    到首记录 ()
    .如果 (等于 (查找 (等于 (读 (“编号”), .取标题 (., 0))), 真))
        赋值 (.内容, 读 (“所属片区”))
        赋值 (.内容, 读 (“所属办事处”))
    .否则
        
    .如果结束
    
.否则
    
.如果结束


.子程序 片区刷新, 空白型, , 
.局部变量 临时变量, 整数型, , , 

赋值 (临时变量, 1)
清空 ()
.计次循环首 (到数值 (读配置项 (相加 (当前目录, “data\pq.ldb”), “片区”, “总数”, “0”)), )
    读配置项 (相加 (当前目录, “data\pq.ldb”), “片区”, 相加 (“vol”, 到文本 (临时变量)), ).加入项目 ()
    赋值 (临时变量, 相加 (临时变量, 1))
.计次循环尾 ()
赋值 (.现行选中项, 0)

.子程序 办事处刷新, 空白型, , 
.局部变量 临时变量, 整数型, , , 
.局部变量 当前片区, 文本型, , , 

赋值 (临时变量, 1)
清空 ()
.计次循环首 (到数值 (读配置项 (相加 (当前目录, “data\pq.ldb”), .取项目文本 (.现行选中项), “总数”, “0”)), )
    读配置项 (相加 (当前目录, “data\pq.ldb”), .取项目文本 (.现行选中项), 相加 (“vol”, 到文本 (临时变量)), ).加入项目 ()
    赋值 (临时变量, 相加 (临时变量, 1))
.计次循环尾 ()
赋值 (.现行选中项, 0)

.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    全部删除 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (等于 (读 (“编号”), .内容))
            -1.插入表项 (读 (“编号”), , , , )
            相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
            相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束


.子程序 _编辑框2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    全部删除 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (不等于 (寻找文本 (读 (“名称”), .内容, , 真), -1))
            -1.插入表项 (读 (“编号”), , , , )
            相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
            相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束


.子程序 _编辑框3_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    全部删除 ()
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (不等于 (寻找文本 (读 (“缩写”), .内容, , 真), -1))
            -1.插入表项 (读 (“编号”), , , , )
            相减 (取表项数 (), 1).置标题 (1, 读 (“名称”))
            相减 (取表项数 (), 1).置标题 (2, 读 (“缩写”))
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
.否则
    
.如果结束


.子程序 _按钮11_被单击, 空白型, , 
.如果 (不等于 (., -1))
    赋值 (单客户品种销量统计表..内容, .取标题 (., 0))
    赋值 (单客户品种销量统计表..标题, .取标题 (., 1))
    赋值 (单客户品种销量统计表., .取标题 (., 1))
    全部关闭 ()
    销毁 ()
.否则
    
.如果结束


.子程序 _单位_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_按钮11_被单击 ()

.子程序 _按钮2_被单击, 空白型, , 
全部关闭 ()
选择客户.销毁 ()

.子程序 _选择客户_可否被关闭, 逻辑型, , 
全部关闭 ()

.窗口程序集 窗口程序集26, , , 

.程序集变量 是否停止, 逻辑型, , , 
.子程序 初始化表格, 空白型, , 
写到文件 (相加 (未知支持库函数_7 (11), “pzxl.grd”), #品种销量)
相加 (未知支持库函数_7 (11), “pzxl.grd”).从文件读 ()
0.置表头行数 ()
2.置文本 (1, “”)
3.置表头行数 ()

.子程序 _超级按钮2_被单击, 空白型, , 
.局部变量 分类循环, 整数型, , , 
.局部变量 品种循环, 整数型, , , 
.局部变量 当前分类, 文本型, , , 
.局部变量 当前品种, 文本型, , , 
.局部变量 产品名称数组, 文本型, , "0", 
.局部变量 产品编号数组, 文本型, , "0", 
.局部变量 该条品种, 文本型, , , 
.局部变量 当前产品数量, 整数型, , , 
.局部变量 产品数量, 整数型, , , 
.局部变量 累计销量, 双精度小数型, , , 
.局部变量 累计销售额, 双精度小数型, , , 
.局部变量 千升酒收入, 双精度小数型, , , 
.局部变量 当前库文件名, 文本型, , , 
.局部变量 容量计算, 文本型, , "0", 
.局部变量 分类合并数量, 整数型, , , 
.局部变量 销量合计, 双精度小数型, , , 
.局部变量 销量总合计, 双精度小数型, , , 
.局部变量 销售额总合计, 双精度小数型, , , 
.局部变量 销售额合计, 双精度小数型, , , 
.局部变量 销售额合计含生啤, 双精度小数型, , , 
.局部变量 销量合计含生啤, 双精度小数型, , , 
.局部变量 生啤销量合计, 双精度小数型, , , 
.局部变量 生啤销售额合计, 双精度小数型, , , 
.局部变量 是否崂啤, 逻辑型, , , 
.局部变量 统计文件, 整数型, , , 
.局部变量 临时循环变量, 整数型, , , 
.局部变量 临时文本变量, 文本型, , , 
.局部变量 当前单位编号, 文本型, , , 

赋值 (.数据源, “”)
赋值 (., 真)
获取焦点 ()
置等待鼠标 ()
赋值 (是否停止, 假)
.如果 (小于 (取日期 (.今天), 取日期 (.今天)))
    信息框 (“截止日期不能比开始日期还早，请重新设定！！！”, 0, )
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
.如果 (不等于 (取年份 (取日期 (.今天)), 取年份 (取日期 (.今天))))
    信息框 (“报表处理的数据要求在同一年度，请重新设定开始日期与截止日期！！！”, 0, )
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
写到文件 (相加 (未知支持库函数_7 (11), “pzxl.grd”), #品种销量)
相加 (未知支持库函数_7 (11), “pzxl.grd”).从文件读 ()
0.置表头行数 ()
.如果 (等于 (取日期 (.今天), 取日期 (.今天)))
    1.置文本 (1, 相加 (到文本 (取日期 (.今天)), “销售公司品种销量统计表”))
.否则
    1.置文本 (1, 相加 (到文本 (取日期 (.今天)), “至”, 到文本 (取日期 (.今天)), “销售公司品种销量统计表”))
.如果结束
2.置文本 (1, “”)
3.置表头行数 ()
赋值 (分类循环, 1)
赋值 (品种循环, 1)
赋值 (销售额总合计, 0)
赋值 (销量总合计, 0)


赋值 (统计文件, 打开文件 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 4, ))
.如果 (等于 (统计文件, 0))
    信息框 (“统计数据临时交换文件创建失败，请稍后再试！”, 0, )
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    关闭文件 (统计文件)
.如果结束
.如果 (等于 (打开 (相加 (当前目录, “data\save\”, 到文本 (取年份 (.今天)), “.ldb”), , , , , “lgq”, ), 假))
    全部关闭 ()
    0.置文本 (“”)
    恢复鼠标 ()
    鸣叫 ()
    信息框 (“打开单据数据库错误，请确定该年度数据库确实存在且完整！”, 0, )
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    0.置文本 (相加 (“正在生成统计数据,已经完成”, 到文本 (取整 (相乘 (相除 (取记录号 (), 取记录数 ()), 100))), “%”))
    处理事件 ()
    .如果 (等于 (是否停止, 真))
        全部关闭 ()
        0.置文本 (“”)
        初始化表格 ()
        赋值 (., 假)
        返回 ()
    .否则
        
    .如果结束
    置等待鼠标 ()
    .如果 (并且 (大于或等于 (取日期 (到时间 (读 (“日期”))), 取日期 (.今天)), 小于或等于 (取日期 (到时间 (读 (“日期”))), 取日期 (.今天)), 等于 (读 (“作废”), 假))) ' 查询条件设置
        赋值 (当前单位编号, 读 (“单位编号”))
        赋值 (当前库文件名, 取当前库 ())
        .如果 (等于 (打开 (相加 (当前目录, “data\index.ldb”), , , , , “lgq”, ), 假))
            全部关闭 ()
            0.置文本 (“”)
            恢复鼠标 ()
            鸣叫 ()
            信息框 (“打开索引数据库错误，请确定该数据库确实存在且完整！”, 0, )
            赋值 (., 假)
            返回 ()
        .否则
            
        .如果结束
        置当前库 (相加 (当前目录, “data\index.ldb”))
        到首记录 ()
        .如果 (等于 (查找 (等于 (读 (“编号”), 当前单位编号)), 真))
            .如果 (或者 (等于 (读 (“所属片区”), “崂山啤酒加工”), 等于 (读 (“所属片区”), “外来加工”)))
                赋值 (是否崂啤, 真)
            .否则
                赋值 (是否崂啤, 假)
            .如果结束
            
        .否则
            全部关闭 ()
            0.置文本 (“”)
            恢复鼠标 ()
            鸣叫 ()
            信息框 (相加 (“编号为：”, 当前单位编号, “的单位不存在，请检查索引数据库！”), 0, )
            赋值 (., 假)
            返回 ()
            
        .如果结束
        关闭 ()
        置当前库 (当前库文件名)
        .如果 (等于 (是否崂啤, 假))
            .如果 (等于 (读 (“反冲”), 真))
                赋值 (临时循环变量, 1)
                .计次循环首 (4, 临时循环变量)
                    赋值 (临时文本变量, 到文本 (临时循环变量))
                    .如果 (或者 (等于 (读 (相加 (“单位”, 临时文本变量)), “箱”), 等于 (读 (相加 (“单位”, 临时文本变量)), “筐”), 等于 (读 (相加 (“单位”, 临时文本变量)), “包”)))
                        清除数组 (容量计算)
                        赋值 (容量计算, 分割文本 (读 (相加 (“规格”, 临时文本变量)), “ml*”, ))
                        .如果 (等于 (取数组成员数 (容量计算), 2))
                            赋值 (累计销量, 相乘 (到数值 (容量计算 [1]), 到数值 (容量计算 [2]), 到数值 (读 (相加 (“数量”, 临时文本变量)))))
                        .否则
                            鸣叫 ()
                            信息框 (相加 (“单据”, 读 (“编号”), “存在产品规格错误，不能进行计算”), 0, )
                            全部关闭 ()
                            0.置文本 (“”)
                            恢复鼠标 ()
                            赋值 (., 假)
                            返回 ()
                        .如果结束
                        赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                    .否则
                        .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “桶”))
                            赋值 (累计销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 临时文本变量)), 相减 (取文本长度 (读 (相加 (“规格”, 临时文本变量))), 1))), 到数值 (读 (相加 (“数量”, 临时文本变量))), 1000))
                            赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                        .否则
                            .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “罐”))
                                赋值 (累计销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 临时文本变量)), 相减 (取文本长度 (读 (相加 (“规格”, 临时文本变量))), 2))), 到数值 (读 (相加 (“数量”, 临时文本变量))), 1000000))
                                赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                            .否则
                                .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “”))
                                    赋值 (累计销量, 0)
                                    赋值 (累计销售额, 0)
                                .否则
                                    鸣叫 ()
                                    信息框 (相加 (“单据”, 读 (“编号”), “存在产品单位错误，不能进行计算”), 0, )
                                    全部关闭 ()
                                    0.置文本 (“”)
                                    恢复鼠标 ()
                                    赋值 (., 假)
                                    返回 ()
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    写配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销量”, 到文本 (相减 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销量”, “0”)), 累计销量)))
                    写配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销售额”, 到文本 (相减 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销售额”, “0”)), 累计销售额)))
                .计次循环尾 ()
            .否则
                赋值 (临时循环变量, 1)
                .计次循环首 (4, 临时循环变量)
                    赋值 (临时文本变量, 到文本 (临时循环变量))
                    .如果 (或者 (等于 (读 (相加 (“单位”, 临时文本变量)), “箱”), 等于 (读 (相加 (“单位”, 临时文本变量)), “筐”), 等于 (读 (相加 (“单位”, 临时文本变量)), “包”)))
                        清除数组 (容量计算)
                        赋值 (容量计算, 分割文本 (读 (相加 (“规格”, 临时文本变量)), “ml*”, ))
                        .如果 (等于 (取数组成员数 (容量计算), 2))
                            赋值 (累计销量, 相乘 (到数值 (容量计算 [1]), 到数值 (容量计算 [2]), 到数值 (读 (相加 (“数量”, 临时文本变量)))))
                        .否则
                            鸣叫 ()
                            信息框 (相加 (“单据”, 读 (“编号”), “存在产品规格错误，不能进行计算”), 0, )
                            全部关闭 ()
                            0.置文本 (“”)
                            恢复鼠标 ()
                            赋值 (., 假)
                            返回 ()
                        .如果结束
                        赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                    .否则
                        .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “桶”))
                            赋值 (累计销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 临时文本变量)), 相减 (取文本长度 (读 (相加 (“规格”, 临时文本变量))), 1))), 到数值 (读 (相加 (“数量”, 临时文本变量))), 1000))
                            赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                        .否则
                            .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “罐”))
                                赋值 (累计销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 临时文本变量)), 相减 (取文本长度 (读 (相加 (“规格”, 临时文本变量))), 2))), 到数值 (读 (相加 (“数量”, 临时文本变量))), 1000000))
                                赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                            .否则
                                .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “”))
                                    赋值 (累计销量, 0)
                                    赋值 (累计销售额, 0)
                                .否则
                                    鸣叫 ()
                                    信息框 (相加 (“单据”, 读 (“编号”), “存在产品单位错误，不能进行计算”), 0, )
                                    全部关闭 ()
                                    0.置文本 (“”)
                                    恢复鼠标 ()
                                    赋值 (., 假)
                                    返回 ()
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    写配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销量”, 到文本 (相加 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销量”, “0”)), 累计销量)))
                    写配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销售额”, 到文本 (相加 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销售额”, “0”)), 累计销售额)))
                .计次循环尾 ()
            .如果结束
            
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    跳过 ()
.判断循环尾 ()
全部关闭 ()
.计次循环首 (3, )
    0.置文本 (“正在整理系统数据……”)
    鸣叫 ()
    赋值 (分类合并数量, 0)
    赋值 (销量合计, 0)
    赋值 (销售额合计, 0)
    .如果 (等于 (分类循环, 1))
        赋值 (当前分类, “高档”)
    .否则
        .如果 (等于 (分类循环, 2))
            赋值 (当前分类, “中档”)
        .否则
            .如果 (等于 (分类循环, 3))
                赋值 (当前分类, “低档”)
            .否则
                
            .如果结束
            
        .如果结束
        
    .如果结束
    赋值 (品种循环, 1)
    .计次循环首 (3, )
        .如果 (等于 (品种循环, 1))
            赋值 (当前品种, “周转箱”)
        .否则
            .如果 (等于 (品种循环, 2))
                赋值 (当前品种, “纸箱”)
            .否则
                .如果 (等于 (品种循环, 3))
                    赋值 (当前品种, “塑包”)
                .否则
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        清除数组 (产品名称数组)
        清除数组 (产品编号数组)
        .如果 (等于 (打开 (相加 (当前目录, “data\cpbh.ldb”), , , , , “lgq”, ), 真))
            到首记录 ()
            .判断循环首 (等于 (尾记录后 (), 假))
                .如果 (等于 (读 (“单位”), “筐”))
                    赋值 (该条品种, “周转箱”)
                .否则
                    .如果 (等于 (读 (“单位”), “箱”))
                        赋值 (该条品种, “纸箱”)
                    .否则
                        .如果 (等于 (读 (“单位”), “包”))
                            赋值 (该条品种, “塑包”)
                        .否则
                            赋值 (该条品种, “其他”)
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                .如果 (并且 (等于 (相加 (读 (“档次”), “档”), 当前分类), 等于 (该条品种, 当前品种)))
                    加入成员 (产品编号数组, 读 (“产品编号”))
                    加入成员 (产品名称数组, 读 (“产品名称”))
                .否则
                    
                .如果结束
                跳过 ()
            .判断循环尾 ()
            全部关闭 ()
            赋值 (产品数量, 取数组成员数 (产品编号数组))
            .如果 (大于 (产品数量, 0))
                赋值 (当前产品数量, 1)
                .计次循环首 (产品数量, )
                    0.置文本 (相加 (“正在处理”, 当前分类, “/”, 当前品种, “/”, 产品编号数组 [当前产品数量], “(”, 产品名称数组 [当前产品数量], “)”, “……”))
                    处理事件 ()
                    .如果 (等于 (是否停止, 真))
                        全部关闭 ()
                        0.置文本 (“”)
                        初始化表格 ()
                        赋值 (., 假)
                        返回 ()
                    .否则
                        
                    .如果结束
                    置等待鼠标 ()
                    赋值 (累计销量, 0)
                    赋值 (累计销售额, 0)
                    1.添加行 ()
                    取行数 ().置文本 (2, 当前分类)
                    取行数 ().置文本 (3, 当前品种)
                    取行数 ().置文本 (4, 产品编号数组 [当前产品数量])
                    取行数 ().置文本 (5, 产品名称数组 [当前产品数量])
                    赋值 (累计销量, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 产品编号数组 [当前产品数量], “销量”, “0”)))
                    赋值 (累计销售额, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 产品编号数组 [当前产品数量], “销售额”, “0”)))
                    取行数 ().置文本 (6, 到文本 (四舍五入 (相除 (累计销量, 1000000), 3)))
                    赋值 (销量合计, 相加 (销量合计, 四舍五入 (相除 (累计销量, 1000000), 3)))
                    取行数 ().置文本 (7, 到文本 (四舍五入 (累计销售额, 2)))
                    赋值 (销售额合计, 相加 (销售额合计, 四舍五入 (累计销售额, 2)))
                    .如果 (等于 (四舍五入 (相除 (累计销量, 1000000), 3), 0))
                        取行数 ().置文本 (8, “”)
                    .否则
                        取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (四舍五入 (累计销售额, 2), 四舍五入 (相除 (累计销量, 1000000), 3)), 2)))
                    .如果结束
                    赋值 (当前产品数量, 相加 (当前产品数量, 1))
                .计次循环尾 ()
                相加 (相减 (取行数 (), 产品数量), 1).合并 (3, 产品数量, 1)
                赋值 (分类合并数量, 相加 (分类合并数量, 产品数量))
            .否则
                
            .如果结束
            
        .否则
            信息框 (“读取产品信息库数据错误，请确认该数据库是否存在且完整！”, 0, )
        .如果结束
        赋值 (品种循环, 相加 (品种循环, 1))
    .计次循环尾 ()
    相加 (相减 (取行数 (), 分类合并数量), 1).合并 (2, 分类合并数量, 1)
    1.添加行 ()
    取行数 ().合并 (2, 1, 4)
    取行数 ().置文本 (2, 相加 (当前分类, “酒合计”))
    取行数 ().置文本 (6, 到文本 (四舍五入 (销量合计, 3)))
    取行数 ().置文本 (7, 到文本 (四舍五入 (销售额合计, 4)))
    .如果 (等于 (四舍五入 (销量合计, 3), 0))
        取行数 ().置文本 (8, “”)
    .否则
        取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (销售额合计, 销量合计), 2)))
    .如果结束
    赋值 (分类循环, 相加 (分类循环, 1))
    赋值 (销量总合计, 相加 (销量总合计, 销量合计))
    赋值 (销售额总合计, 相加 (销售额总合计, 销售额合计))
.计次循环尾 ()


0.置文本 (“正在处理生啤/桶装生啤数据……”)
鸣叫 ()
赋值 (累计销量, 0)
赋值 (累计销售额, 0)
.如果 (等于 (打开 (相加 (当前目录, “data\cpbh.ldb”), , , , , “lgq”, ), 假))
    信息框 (“打开单位索引数据库错误，请确定该数据库确实存在且完整！”, 0, )
    全部关闭 ()
    0.置文本 (“”)
    鸣叫 ()
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (等于 (读 (“单位”), “桶”))
        赋值 (累计销量, 相加 (累计销量, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (“产品编号”), “销量”, “0”))))
        赋值 (累计销售额, 相加 (累计销售额, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (“产品编号”), “销售额”, “0”))))
    .否则
        
    .如果结束
    跳过 ()
.判断循环尾 ()
全部关闭 ()
1.添加行 ()
取行数 ().置文本 (5, “桶装”)
取行数 ().置文本 (6, 到文本 (四舍五入 (相除 (累计销量, 1000000), 3)))
赋值 (销量合计含生啤, 相加 (销量总合计, 四舍五入 (相除 (累计销量, 1000000), 3)))
取行数 ().置文本 (7, 到文本 (四舍五入 (累计销售额, 2)))
赋值 (销售额合计含生啤, 相加 (销售额总合计, 四舍五入 (累计销售额, 2)))
.如果 (等于 (四舍五入 (相除 (累计销量, 1000000), 3), 0))
    取行数 ().置文本 (8, “”)
.否则
    取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (四舍五入 (累计销售额, 2), 四舍五入 (相除 (累计销量, 1000000), 3)), 2)))
.如果结束
赋值 (生啤销量合计, 四舍五入 (相除 (累计销量, 1000000), 3))
赋值 (生啤销售额合计, 四舍五入 (累计销售额, 2))


0.置文本 (“正在处理生啤/罐装生啤数据……”)
鸣叫 ()
赋值 (累计销量, 0)
赋值 (累计销售额, 0)
.如果 (等于 (打开 (相加 (当前目录, “data\cpbh.ldb”), , , , , “lgq”, ), 假))
    信息框 (“打开单位索引数据库错误，请确定该数据库确实存在且完整！”, 0, )
    全部关闭 ()
    0.置文本 (“”)
    鸣叫 ()
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (等于 (读 (“单位”), “罐”))
        赋值 (累计销量, 相加 (累计销量, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (“产品编号”), “销量”, “0”))))
        赋值 (累计销售额, 相加 (累计销售额, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (“产品编号”), “销售额”, “0”))))
    .否则
        
    .如果结束
    跳过 ()
.判断循环尾 ()
全部关闭 ()
1.添加行 ()
取行数 ().置文本 (5, “罐装”)
取行数 ().置文本 (6, 到文本 (四舍五入 (相除 (累计销量, 1000000), 3)))
赋值 (销量合计含生啤, 相加 (销量合计含生啤, 四舍五入 (相除 (累计销量, 1000000), 3)))
取行数 ().置文本 (7, 到文本 (四舍五入 (累计销售额, 2)))
赋值 (销售额合计含生啤, 相加 (销售额合计含生啤, 四舍五入 (累计销售额, 2)))
.如果 (等于 (四舍五入 (相除 (累计销量, 1000000), 3), 0))
    取行数 ().置文本 (8, “”)
.否则
    取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (四舍五入 (累计销售额, 2), 四舍五入 (相除 (累计销量, 1000000), 3)), 2)))
.如果结束
赋值 (生啤销量合计, 相加 (生啤销量合计, 四舍五入 (相除 (累计销量, 1000000), 3)))
赋值 (生啤销售额合计, 相加 (生啤销售额合计, 四舍五入 (累计销售额, 2)))

1.添加行 ()
取行数 ().置文本 (6, 到文本 (生啤销量合计))
取行数 ().置文本 (7, 到文本 (生啤销售额合计))
.如果 (等于 (生啤销量合计, 0))
    取行数 ().置文本 (8, “”)
.否则
    取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (生啤销售额合计, 生啤销量合计), 2)))
.如果结束


相减 (取行数 (), 2).合并 (2, 3, 2)
相减 (取行数 (), 2).置文本 (2, “生啤”)

取行数 ().合并 (4, 1, 2)
取行数 ().置文本 (4, “生啤合计”)

1.添加行 ()
取行数 ().合并 (2, 1, 4)
取行数 ().置文本 (2, “总合计(含生啤)”)
取行数 ().置文本 (6, 到文本 (销量合计含生啤))
取行数 ().置文本 (7, 到文本 (销售额合计含生啤))
.如果 (等于 (销量合计含生啤, 0))
    取行数 ().置文本 (8, “”)
.否则
    取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (销售额合计含生啤, 销量合计含生啤), 2)))
.如果结束

1.添加行 ()
取行数 ().合并 (2, 1, 4)
取行数 ().置文本 (2, “总合计(不含生啤)”)
取行数 ().置文本 (6, 到文本 (销量总合计))
取行数 ().置文本 (7, 到文本 (销售额总合计))
.如果 (等于 (销量总合计, 0))
    取行数 ().置文本 (8, “”)
.否则
    取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (销售额总合计, 销量总合计), 2)))
.如果结束


4.合并 (1, 相减 (取行数 (), 3), 1)
4.置对齐方式 (1, 相减 (取行数 (), 3), 8, 5)
4.加线条 (1, 相减 (取行数 (), 3), 8, 63)
4.加线条 (1, 相减 (取行数 (), 3), 1, )
1.删除列 (1)

0.置表头行数 ()
1.置文本 (1, 相加 (到文本 (取日期 (.今天)), “至”, 到文本 (取日期 (.今天)), “销售公司品种销量统计表”))
3.置表头行数 ()

全部关闭 ()
0.置文本 (“”)
鸣叫 ()
恢复鼠标 ()
赋值 (., 假)
赋值 (.数据源, “数据源1”)

.子程序 _销售公司品种销量统计表_尺寸被改变, 空白型, , 
相减 (销售公司品种销量统计表., .宽度, 15).移动 (10, , )
0.移动 (10, 相减 (销售公司品种销量统计表., .宽度, 20), 相减 (销售公司品种销量统计表., ., 43))
.移动 (.左边, 相加 (.顶边, .高度, 5), , )

.子程序 _超级按钮1_被单击, 空白型, , 
打印预览 ()

.子程序 _超级按钮3_被单击, 空白型, , 
赋值 (.文件名, 1.取文本 (1))
.如果 (等于 (打开 (), 真))
    .存到文件 (.文件名)
.否则
    
.如果结束


.子程序 _超级按钮5_被单击, 空白型, , 
.如果 (等于 (., 假))
    销售公司品种销量统计表.销毁 ()
.否则
    信息框 (“请等待报表生成完毕，或取消生成后再关闭本窗口！”, 0, )
.如果结束


.子程序 _超级按钮2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    _超级按钮2_被单击 ()
.否则
    
.如果结束


.子程序 _超级按钮4_被单击, 空白型, , 
.如果 (等于 (打开 (), 真))
    .从文件读 (.文件名)
.否则
    
.如果结束


.子程序 _超级按钮6_被单击, 空白型, , 
.局部变量 临时文件名, 文本型, , , 

赋值 (.文件名, 1.取文本 (1))
.如果 (等于 (打开 (), 真))
    赋值 (临时文件名, 取临时文件名 ())
    5.添加行 ()
    .如果 (等于 (临时文件名.存到文件 (), 真))
        .如果 (等于 (转换数据 (临时文件名, 1, .文件名), 真))
            信息框 (“该报表数据已经成功转换为EXCEL文件！”, 0, )
        .否则
            信息框 (“该报表数据暂时不能转换为EXCEL文件，请稍后再试！”, 0, )
        .如果结束
        
    .否则
        信息框 (“该报表数据暂时不能转换为EXCEL文件，请稍后再试！”, 0, )
    .如果结束
    相减 (取行数 (), 4).删除行 (5)
    删除文件 (临时文件名)
.否则
    
.如果结束


.子程序 _单位编号_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (选择客户, , 真)

.子程序 _销售公司品种销量统计表_创建完毕, 空白型, , 
赋值 (.今天, 到时间 (相加 (到文本 (取年份 (.今天)), “年1月1日”)))
初始化表格 ()

.子程序 _销售公司品种销量统计表_可否被关闭, 逻辑型, , 
赋值 (是否停止, 真)
返回 (假)

.窗口程序集 窗口程序集27, , , 

.程序集变量 是否停止, 逻辑型, , , 
.子程序 初始化表格, 空白型, , 
写到文件 (相加 (未知支持库函数_7 (11), “pzxl.grd”), #品种销量)
相加 (未知支持库函数_7 (11), “pzxl.grd”).从文件读 ()
0.置表头行数 ()
2.置文本 (1, “业务编码”)
3.置表头行数 ()

.子程序 _超级按钮2_被单击, 空白型, , 
.局部变量 分类循环, 整数型, , , 
.局部变量 品种循环, 整数型, , , 
.局部变量 当前分类, 文本型, , , 
.局部变量 当前品种, 文本型, , , 
.局部变量 产品名称数组, 文本型, , "0", 
.局部变量 产品编号数组, 文本型, , "0", 
.局部变量 该条品种, 文本型, , , 
.局部变量 当前产品数量, 整数型, , , 
.局部变量 产品数量, 整数型, , , 
.局部变量 累计销量, 双精度小数型, , , 
.局部变量 累计销售额, 双精度小数型, , , 
.局部变量 千升酒收入, 双精度小数型, , , 
.局部变量 当前库文件名, 文本型, , , 
.局部变量 容量计算, 文本型, , "0", 
.局部变量 分类合并数量, 整数型, , , 
.局部变量 销量合计, 双精度小数型, , , 
.局部变量 销量总合计, 双精度小数型, , , 
.局部变量 销售额总合计, 双精度小数型, , , 
.局部变量 销售额合计, 双精度小数型, , , 
.局部变量 销售额合计含生啤, 双精度小数型, , , 
.局部变量 销量合计含生啤, 双精度小数型, , , 
.局部变量 生啤销量合计, 双精度小数型, , , 
.局部变量 生啤销售额合计, 双精度小数型, , , 
.局部变量 当前单位编号, 文本型, , , 
.局部变量 统计文件, 整数型, , , 
.局部变量 临时循环变量, 整数型, , , 
.局部变量 临时文本变量, 文本型, , , 
.局部变量 是否符合, 逻辑型, , , 
.局部变量 是否崂啤, 逻辑型, , , 

赋值 (.数据源, “”)
赋值 (., 真)
获取焦点 ()
置等待鼠标 ()
赋值 (是否停止, 假)
.如果 (等于 (.标题, “”))
    信息框 (“请输入要生成报表的业务员，否则不能继续进行处理！”, 0, )
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
.如果 (小于 (取日期 (.今天), 取日期 (.今天)))
    信息框 (“截止日期不能比开始日期还早，请重新设定！！！”, 0, )
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
.如果 (不等于 (取年份 (取日期 (.今天)), 取年份 (取日期 (.今天))))
    信息框 (“报表处理的数据要求在同一年度，请重新设定开始日期与截止日期！！！”, 0, )
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
写到文件 (相加 (未知支持库函数_7 (11), “pzxl.grd”), #品种销量)
相加 (未知支持库函数_7 (11), “pzxl.grd”).从文件读 ()
0.置表头行数 ()
.如果 (等于 (取日期 (.今天), 取日期 (.今天)))
    1.置文本 (1, 相加 (到文本 (取日期 (.今天)), “业务员品种销量统计表”))
.否则
    1.置文本 (1, 相加 (到文本 (取日期 (.今天)), “至”, 到文本 (取日期 (.今天)), “业务员品种销量统计表”))
.如果结束
2.置文本 (1, “业务编码”)
3.置表头行数 ()
赋值 (分类循环, 1)
赋值 (品种循环, 1)
赋值 (销售额总合计, 0)
赋值 (销量总合计, 0)


赋值 (统计文件, 打开文件 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 4, ))
.如果 (等于 (统计文件, 0))
    信息框 (“统计数据临时交换文件创建失败，请稍后再试！”, 0, )
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    关闭文件 (统计文件)
.如果结束
.如果 (等于 (打开 (相加 (当前目录, “data\save\”, 到文本 (取年份 (.今天)), “.ldb”), , , , , “lgq”, ), 假))
    全部关闭 ()
    0.置文本 (“”)
    恢复鼠标 ()
    鸣叫 ()
    信息框 (“打开单据数据库错误，请确定该年度数据库确实存在且完整！”, 0, )
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    0.置文本 (相加 (“正在生成统计数据,已经完成”, 到文本 (取整 (相乘 (相除 (取记录号 (), 取记录数 ()), 100))), “%”))
    处理事件 ()
    .如果 (等于 (是否停止, 真))
        全部关闭 ()
        0.置文本 (“”)
        初始化表格 ()
        赋值 (., 假)
        返回 ()
    .否则
        
    .如果结束
    置等待鼠标 ()
    .如果 (并且 (大于或等于 (取日期 (到时间 (读 (“日期”))), 取日期 (.今天)), 小于或等于 (取日期 (到时间 (读 (“日期”))), 取日期 (.今天)), 等于 (读 (“业务编码”), .内容), 等于 (读 (“作废”), 假))) ' 查询条件设置
        .如果 (等于 (读 (“反冲”), 真))
            赋值 (临时循环变量, 1)
            .计次循环首 (4, 临时循环变量)
                赋值 (临时文本变量, 到文本 (临时循环变量))
                .如果 (或者 (等于 (读 (相加 (“单位”, 临时文本变量)), “箱”), 等于 (读 (相加 (“单位”, 临时文本变量)), “筐”), 等于 (读 (相加 (“单位”, 临时文本变量)), “包”)))
                    清除数组 (容量计算)
                    赋值 (容量计算, 分割文本 (读 (相加 (“规格”, 临时文本变量)), “ml*”, ))
                    .如果 (等于 (取数组成员数 (容量计算), 2))
                        赋值 (累计销量, 相乘 (到数值 (容量计算 [1]), 到数值 (容量计算 [2]), 到数值 (读 (相加 (“数量”, 临时文本变量)))))
                    .否则
                        鸣叫 ()
                        信息框 (相加 (“单据”, 读 (“编号”), “存在产品规格错误，不能进行计算”), 0, )
                        全部关闭 ()
                        0.置文本 (“”)
                        恢复鼠标 ()
                        赋值 (., 假)
                        返回 ()
                    .如果结束
                    赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                .否则
                    .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “桶”))
                        赋值 (累计销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 临时文本变量)), 相减 (取文本长度 (读 (相加 (“规格”, 临时文本变量))), 1))), 到数值 (读 (相加 (“数量”, 临时文本变量))), 1000))
                        赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                    .否则
                        .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “罐”))
                            赋值 (累计销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 临时文本变量)), 相减 (取文本长度 (读 (相加 (“规格”, 临时文本变量))), 2))), 到数值 (读 (相加 (“数量”, 临时文本变量))), 1000000))
                            赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                        .否则
                            .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “”))
                                赋值 (累计销量, 0)
                                赋值 (累计销售额, 0)
                            .否则
                                鸣叫 ()
                                信息框 (相加 (“单据”, 读 (“编号”), “存在产品单位错误，不能进行计算”), 0, )
                                全部关闭 ()
                                0.置文本 (“”)
                                恢复鼠标 ()
                                赋值 (., 假)
                                返回 ()
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                写配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销量”, 到文本 (相减 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销量”, “0”)), 累计销量)))
                写配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销售额”, 到文本 (相减 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销售额”, “0”)), 累计销售额)))
            .计次循环尾 ()
        .否则
            赋值 (临时循环变量, 1)
            .计次循环首 (4, 临时循环变量)
                赋值 (临时文本变量, 到文本 (临时循环变量))
                .如果 (或者 (等于 (读 (相加 (“单位”, 临时文本变量)), “箱”), 等于 (读 (相加 (“单位”, 临时文本变量)), “筐”), 等于 (读 (相加 (“单位”, 临时文本变量)), “包”)))
                    清除数组 (容量计算)
                    赋值 (容量计算, 分割文本 (读 (相加 (“规格”, 临时文本变量)), “ml*”, ))
                    .如果 (等于 (取数组成员数 (容量计算), 2))
                        赋值 (累计销量, 相乘 (到数值 (容量计算 [1]), 到数值 (容量计算 [2]), 到数值 (读 (相加 (“数量”, 临时文本变量)))))
                    .否则
                        鸣叫 ()
                        信息框 (相加 (“单据”, 读 (“编号”), “存在产品规格错误，不能进行计算”), 0, )
                        全部关闭 ()
                        0.置文本 (“”)
                        恢复鼠标 ()
                        赋值 (., 假)
                        返回 ()
                    .如果结束
                    赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                .否则
                    .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “桶”))
                        赋值 (累计销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 临时文本变量)), 相减 (取文本长度 (读 (相加 (“规格”, 临时文本变量))), 1))), 到数值 (读 (相加 (“数量”, 临时文本变量))), 1000))
                        赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                    .否则
                        .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “罐”))
                            赋值 (累计销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 临时文本变量)), 相减 (取文本长度 (读 (相加 (“规格”, 临时文本变量))), 2))), 到数值 (读 (相加 (“数量”, 临时文本变量))), 1000000))
                            赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                        .否则
                            .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “”))
                                赋值 (累计销量, 0)
                                赋值 (累计销售额, 0)
                            .否则
                                鸣叫 ()
                                信息框 (相加 (“单据”, 读 (“编号”), “存在产品单位错误，不能进行计算”), 0, )
                                全部关闭 ()
                                0.置文本 (“”)
                                恢复鼠标 ()
                                赋值 (., 假)
                                返回 ()
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                写配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销量”, 到文本 (相加 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销量”, “0”)), 累计销量)))
                写配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销售额”, 到文本 (相加 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销售额”, “0”)), 累计销售额)))
            .计次循环尾 ()
        .如果结束
        
    .否则
        
    .如果结束
    跳过 ()
.判断循环尾 ()
全部关闭 ()

.计次循环首 (3, )
    0.置文本 (“正在整理系统数据……”)
    鸣叫 ()
    赋值 (分类合并数量, 0)
    赋值 (销量合计, 0)
    赋值 (销售额合计, 0)
    .如果 (等于 (分类循环, 1))
        赋值 (当前分类, “高档”)
    .否则
        .如果 (等于 (分类循环, 2))
            赋值 (当前分类, “中档”)
        .否则
            .如果 (等于 (分类循环, 3))
                赋值 (当前分类, “低档”)
            .否则
                
            .如果结束
            
        .如果结束
        
    .如果结束
    赋值 (品种循环, 1)
    .计次循环首 (3, )
        .如果 (等于 (品种循环, 1))
            赋值 (当前品种, “周转箱”)
        .否则
            .如果 (等于 (品种循环, 2))
                赋值 (当前品种, “纸箱”)
            .否则
                .如果 (等于 (品种循环, 3))
                    赋值 (当前品种, “塑包”)
                .否则
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        清除数组 (产品名称数组)
        清除数组 (产品编号数组)
        .如果 (等于 (打开 (相加 (当前目录, “data\cpbh.ldb”), , , , , “lgq”, ), 真))
            到首记录 ()
            .判断循环首 (等于 (尾记录后 (), 假))
                .如果 (等于 (读 (“单位”), “筐”))
                    赋值 (该条品种, “周转箱”)
                .否则
                    .如果 (等于 (读 (“单位”), “箱”))
                        赋值 (该条品种, “纸箱”)
                    .否则
                        .如果 (等于 (读 (“单位”), “包”))
                            赋值 (该条品种, “塑包”)
                        .否则
                            赋值 (该条品种, “其他”)
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                .如果 (并且 (等于 (相加 (读 (“档次”), “档”), 当前分类), 等于 (该条品种, 当前品种)))
                    加入成员 (产品编号数组, 读 (“产品编号”))
                    加入成员 (产品名称数组, 读 (“产品名称”))
                .否则
                    
                .如果结束
                跳过 ()
            .判断循环尾 ()
            全部关闭 ()
            赋值 (产品数量, 取数组成员数 (产品编号数组))
            .如果 (大于 (产品数量, 0))
                赋值 (当前产品数量, 1)
                .计次循环首 (产品数量, )
                    0.置文本 (相加 (“正在处理”, 当前分类, “/”, 当前品种, “/”, 产品编号数组 [当前产品数量], “(”, 产品名称数组 [当前产品数量], “)”, “……”))
                    处理事件 ()
                    .如果 (等于 (是否停止, 真))
                        全部关闭 ()
                        0.置文本 (“”)
                        初始化表格 ()
                        赋值 (., 假)
                        返回 ()
                    .否则
                        
                    .如果结束
                    置等待鼠标 ()
                    赋值 (累计销量, 0)
                    赋值 (累计销售额, 0)
                    1.添加行 ()
                    取行数 ().置文本 (2, 当前分类)
                    取行数 ().置文本 (3, 当前品种)
                    取行数 ().置文本 (4, 产品编号数组 [当前产品数量])
                    取行数 ().置文本 (5, 产品名称数组 [当前产品数量])
                    赋值 (累计销量, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 产品编号数组 [当前产品数量], “销量”, “0”)))
                    赋值 (累计销售额, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 产品编号数组 [当前产品数量], “销售额”, “0”)))
                    取行数 ().置文本 (6, 到文本 (四舍五入 (相除 (累计销量, 1000000), 3)))
                    赋值 (销量合计, 相加 (销量合计, 四舍五入 (相除 (累计销量, 1000000), 3)))
                    取行数 ().置文本 (7, 到文本 (四舍五入 (累计销售额, 2)))
                    赋值 (销售额合计, 相加 (销售额合计, 四舍五入 (累计销售额, 2)))
                    .如果 (等于 (四舍五入 (相除 (累计销量, 1000000), 3), 0))
                        取行数 ().置文本 (8, “”)
                    .否则
                        取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (四舍五入 (累计销售额, 2), 四舍五入 (相除 (累计销量, 1000000), 3)), 2)))
                    .如果结束
                    赋值 (当前产品数量, 相加 (当前产品数量, 1))
                .计次循环尾 ()
                相加 (相减 (取行数 (), 产品数量), 1).合并 (3, 产品数量, 1)
                赋值 (分类合并数量, 相加 (分类合并数量, 产品数量))
            .否则
                
            .如果结束
            
        .否则
            信息框 (“读取产品信息库数据错误，请确认该数据库是否存在且完整！”, 0, )
        .如果结束
        赋值 (品种循环, 相加 (品种循环, 1))
    .计次循环尾 ()
    相加 (相减 (取行数 (), 分类合并数量), 1).合并 (2, 分类合并数量, 1)
    1.添加行 ()
    取行数 ().合并 (2, 1, 4)
    取行数 ().置文本 (2, 相加 (当前分类, “酒合计”))
    取行数 ().置文本 (6, 到文本 (四舍五入 (销量合计, 3)))
    取行数 ().置文本 (7, 到文本 (四舍五入 (销售额合计, 4)))
    .如果 (等于 (四舍五入 (销量合计, 3), 0))
        取行数 ().置文本 (8, “”)
    .否则
        取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (销售额合计, 销量合计), 2)))
    .如果结束
    赋值 (分类循环, 相加 (分类循环, 1))
    赋值 (销量总合计, 相加 (销量总合计, 销量合计))
    赋值 (销售额总合计, 相加 (销售额总合计, 销售额合计))
.计次循环尾 ()



0.置文本 (“正在处理生啤/桶装生啤数据……”)
鸣叫 ()
赋值 (累计销量, 0)
赋值 (累计销售额, 0)
.如果 (等于 (打开 (相加 (当前目录, “data\cpbh.ldb”), , , , , “lgq”, ), 假))
    信息框 (“打开单位索引数据库错误，请确定该数据库确实存在且完整！”, 0, )
    全部关闭 ()
    0.置文本 (“”)
    鸣叫 ()
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (等于 (读 (“单位”), “桶”))
        赋值 (累计销量, 相加 (累计销量, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (“产品编号”), “销量”, “0”))))
        赋值 (累计销售额, 相加 (累计销售额, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (“产品编号”), “销售额”, “0”))))
    .否则
        
    .如果结束
    跳过 ()
.判断循环尾 ()
全部关闭 ()
1.添加行 ()
取行数 ().置文本 (5, “桶装”)
取行数 ().置文本 (6, 到文本 (四舍五入 (相除 (累计销量, 1000000), 3)))
赋值 (销量合计含生啤, 相加 (销量总合计, 四舍五入 (相除 (累计销量, 1000000), 3)))
取行数 ().置文本 (7, 到文本 (四舍五入 (累计销售额, 2)))
赋值 (销售额合计含生啤, 相加 (销售额总合计, 四舍五入 (累计销售额, 2)))
.如果 (等于 (四舍五入 (相除 (累计销量, 1000000), 3), 0))
    取行数 ().置文本 (8, “”)
.否则
    取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (四舍五入 (累计销售额, 2), 四舍五入 (相除 (累计销量, 1000000), 3)), 2)))
.如果结束
赋值 (生啤销量合计, 四舍五入 (相除 (累计销量, 1000000), 3))
赋值 (生啤销售额合计, 四舍五入 (累计销售额, 2))


0.置文本 (“正在处理生啤/罐装生啤数据……”)
鸣叫 ()
赋值 (累计销量, 0)
赋值 (累计销售额, 0)
.如果 (等于 (打开 (相加 (当前目录, “data\cpbh.ldb”), , , , , “lgq”, ), 假))
    信息框 (“打开单位索引数据库错误，请确定该数据库确实存在且完整！”, 0, )
    全部关闭 ()
    0.置文本 (“”)
    鸣叫 ()
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (等于 (读 (“单位”), “罐”))
        赋值 (累计销量, 相加 (累计销量, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (“产品编号”), “销量”, “0”))))
        赋值 (累计销售额, 相加 (累计销售额, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (“产品编号”), “销售额”, “0”))))
    .否则
        
    .如果结束
    跳过 ()
.判断循环尾 ()
全部关闭 ()
1.添加行 ()
取行数 ().置文本 (5, “罐装”)
取行数 ().置文本 (6, 到文本 (四舍五入 (相除 (累计销量, 1000000), 3)))
赋值 (销量合计含生啤, 相加 (销量合计含生啤, 四舍五入 (相除 (累计销量, 1000000), 3)))
取行数 ().置文本 (7, 到文本 (四舍五入 (累计销售额, 2)))
赋值 (销售额合计含生啤, 相加 (销售额合计含生啤, 四舍五入 (累计销售额, 2)))
.如果 (等于 (四舍五入 (相除 (累计销量, 1000000), 3), 0))
    取行数 ().置文本 (8, “”)
.否则
    取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (四舍五入 (累计销售额, 2), 四舍五入 (相除 (累计销量, 1000000), 3)), 2)))
.如果结束
赋值 (生啤销量合计, 相加 (生啤销量合计, 四舍五入 (相除 (累计销量, 1000000), 3)))
赋值 (生啤销售额合计, 相加 (生啤销售额合计, 四舍五入 (累计销售额, 2)))

1.添加行 ()
取行数 ().置文本 (6, 到文本 (生啤销量合计))
取行数 ().置文本 (7, 到文本 (生啤销售额合计))
.如果 (等于 (生啤销量合计, 0))
    取行数 ().置文本 (8, “”)
.否则
    取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (生啤销售额合计, 生啤销量合计), 2)))
.如果结束


相减 (取行数 (), 2).合并 (2, 3, 2)
相减 (取行数 (), 2).置文本 (2, “生啤”)

取行数 ().合并 (4, 1, 2)
取行数 ().置文本 (4, “生啤合计”)

1.添加行 ()
取行数 ().合并 (2, 1, 4)
取行数 ().置文本 (2, “总合计(含生啤)”)
取行数 ().置文本 (6, 到文本 (销量合计含生啤))
取行数 ().置文本 (7, 到文本 (销售额合计含生啤))
.如果 (等于 (销量合计含生啤, 0))
    取行数 ().置文本 (8, “”)
.否则
    取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (销售额合计含生啤, 销量合计含生啤), 2)))
.如果结束

1.添加行 ()
取行数 ().合并 (2, 1, 4)
取行数 ().置文本 (2, “总合计(不含生啤)”)
取行数 ().置文本 (6, 到文本 (销量总合计))
取行数 ().置文本 (7, 到文本 (销售额总合计))
.如果 (等于 (销量总合计, 0))
    取行数 ().置文本 (8, “”)
.否则
    取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (销售额总合计, 销量总合计), 2)))
.如果结束



4.合并 (1, 相减 (取行数 (), 3), 1)
4.置文本 (1, .内容)
4.置对齐方式 (1, 相减 (取行数 (), 3), 8, 5)
4.加线条 (1, 相减 (取行数 (), 3), 8, 63)
4.加线条 (1, 相减 (取行数 (), 3), 1, )
全部关闭 ()
0.置文本 (“”)
鸣叫 ()
恢复鼠标 ()
赋值 (., 假)
赋值 (.数据源, “数据源1”)

.子程序 _业务员品种销量统计表_尺寸被改变, 空白型, , 
相减 (业务员品种销量统计表., .宽度, 15).移动 (10, , )
0.移动 (10, 相减 (业务员品种销量统计表., .宽度, 20), 相减 (业务员品种销量统计表., ., 43))
.移动 (.左边, 相加 (.顶边, .高度, 5), , )

.子程序 _超级按钮1_被单击, 空白型, , 
打印预览 ()

.子程序 _超级按钮3_被单击, 空白型, , 
赋值 (.文件名, 相加 (4.取文本 (1), “_”, 1.取文本 (1)))
.如果 (等于 (打开 (), 真))
    .存到文件 (.文件名)
.否则
    
.如果结束


.子程序 _超级按钮5_被单击, 空白型, , 
.如果 (等于 (., 假))
    业务员品种销量统计表.销毁 ()
.否则
    信息框 (“请等待报表生成完毕，或取消生成后再关闭本窗口！”, 0, )
.如果结束


.子程序 _超级按钮2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    _超级按钮2_被单击 ()
.否则
    
.如果结束


.子程序 _超级按钮4_被单击, 空白型, , 
.如果 (等于 (打开 (), 真))
    .从文件读 (.文件名)
.否则
    
.如果结束


.子程序 _超级按钮6_被单击, 空白型, , 
.局部变量 临时文件名, 文本型, , , 

赋值 (.文件名, 相加 (4.取文本 (1), “_”, 1.取文本 (1)))
.如果 (等于 (打开 (), 真))
    赋值 (临时文件名, 取临时文件名 ())
    5.添加行 ()
    .如果 (等于 (临时文件名.存到文件 (), 真))
        .如果 (等于 (转换数据 (临时文件名, 1, .文件名), 真))
            信息框 (“该报表数据已经成功转换为EXCEL文件！”, 0, )
        .否则
            信息框 (“该报表数据暂时不能转换为EXCEL文件，请稍后再试！”, 0, )
        .如果结束
        
    .否则
        信息框 (“该报表数据暂时不能转换为EXCEL文件，请稍后再试！”, 0, )
    .如果结束
    相减 (取行数 (), 4).删除行 (5)
    删除文件 (临时文件名)
.否则
    
.如果结束


.子程序 _业务员品种销量统计表_创建完毕, 空白型, , 
.局部变量 qqq, 文本型, , , 

赋值 (.今天, 到时间 (相加 (到文本 (取年份 (.今天)), “年1月1日”)))
初始化表格 ()
赋值 (qqq, 取文本注册项 (3, “dysz\tsk”, “真”))
.如果 (等于 (qqq, “真”))
    未知支持库函数_0 (取窗口句柄 (), 相加 (“1、请在此输入业务编码，然后按回车键！”, #换行符, “2、双击本输入框，在弹出的窗口中选择！”), 真, 假)
    未知支持库函数_6 (1, “友情提示：”)
    未知支持库函数_4 (#红色)
.否则
    
.如果结束


.子程序 _业务编码_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

赋值 (.标题, “”)
.如果 (等于 (字符代码, 13))
    .如果 (等于 (打开 (相加 (当前目录, “data\ywy.ldb”), , , , , “lgq”, ), 假))
        全部关闭 ()
        0.置文本 (“”)
        恢复鼠标 ()
        鸣叫 ()
        信息框 (“打开业务员数据库错误，请确定该数据库确实存在且完整！”, 0, )
        赋值 (.内容, “”)
        返回 ()
    .否则
        
    .如果结束
    到首记录 ()
    .如果 (等于 (查找 (等于 (读 (“业务编码”), .内容)), 真))
        赋值 (.标题, 读 (“业务员名称”))
        获取焦点 ()
    .否则
        信息框 (相加 (“没有找到编码为：”, .内容, “的业务员，请确定该业务员确实存在！”), 0, )
        赋值 (.内容, “”)
    .如果结束
    全部关闭 ()
.否则
    
.如果结束


.子程序 _业务员品种销量统计表_可否被关闭, 逻辑型, , 
赋值 (是否停止, 真)
返回 (假)

.子程序 _业务编码_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (选择业务员, , 真)

.窗口程序集 窗口程序集28, , , 

.子程序 _是否提示_被单击, 空白型, , 
写注册项 (3, “dysz\tsk”, 到文本 (.选中))
.如果 (等于 (.选中, 真))
    赋值 (.标题, “当前状态：开启”)
.否则
    赋值 (.标题, “当前状态：未开启”)
.如果结束


.子程序 _系统设置_创建完毕, 空白型, , 
.局部变量 qqq, 文本型, , , 

赋值 (qqq, 取文本注册项 (3, “dysz\tsk”, “真”))
.如果 (等于 (qqq, “真”))
    赋值 (.选中, 真)
    赋值 (.标题, “当前状态：开启”)
.否则
    赋值 (.选中, 假)
    赋值 (.标题, “当前状态：未开启”)
.如果结束
赋值 (qqq, 取文本注册项 (3, “dysz\sjk”, “真”))
.如果 (等于 (qqq, “真”))
    赋值 (.选中, 真)
    赋值 (.标题, “当前状态：开启”)
.否则
    赋值 (.选中, 假)
    赋值 (.标题, “当前状态：未开启”)
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
系统设置.销毁 ()

.子程序 _是否提示1_被单击, 空白型, , 
写注册项 (3, “dysz\sjk”, 到文本 (.选中))
.如果 (等于 (.选中, 真))
    赋值 (.标题, “当前状态：开启”)
    赋值 (_启动窗口..可视, 真)
    赋值 (_启动窗口..时钟周期, 1000)
.否则
    赋值 (.标题, “当前状态：未开启”)
    赋值 (_启动窗口..可视, 假)
    赋值 (_启动窗口..时钟周期, 0)
.如果结束


.窗口程序集 窗口程序集29, , , 

.子程序 _关于_创建完毕, 空白型, , 
写到文件 (相加 (未知支持库函数_7 (11), “\shuibo.bmp”), #水波纹图片)
初始化水波纹 (相加 (未知支持库函数_7 (11), “\shuibo.bmp”), )

.子程序 _关于_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

水波纹移动 (关于, 横向位置, 纵向位置)

.子程序 _时钟1_周期事件, 空白型, , 
水波纹周期事件 (关于)

.子程序 _关于_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

水波纹涟漪 (关于, 横向位置, 纵向位置)

.子程序 _关于_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

关于.销毁 ()

.窗口程序集 窗口程序集30, , , 

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 www, 文本型, , "0", 
.局部变量 www1, 文本型, , "0", 

.如果 (等于 (打开 (), 真))
    赋值 (.内容, .文件名)
    赋值 (www, 分割文本 (.文件名, “\”, ))
    赋值 (www1, 分割文本 (www [取数组成员数 (www)], “.”, ))
    赋值 (.内容, www1 [1])
.否则
    
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 www, 文本型, , "0", 
.局部变量 www1, 文本型, , "0", 

.如果 (等于 (打开 (), 真))
    赋值 (.内容, .文件名)
    赋值 (www, 分割文本 (.文件名, “\”, ))
    赋值 (www1, 分割文本 (www [取数组成员数 (www)], “.”, ))
    赋值 (.内容, www1 [1])
.否则
    
.如果结束


.子程序 _按钮3_被单击, 空白型, , 
.局部变量 www, 文本型, , "0", 
.局部变量 www1, 文本型, , "0", 

.如果 (等于 (打开 (), 真))
    赋值 (.内容, .文件名)
    赋值 (www, 分割文本 (.文件名, “\”, ))
    赋值 (www1, 分割文本 (www [取数组成员数 (www)], “.”, ))
    赋值 (.内容, www1 [1])
.否则
    
.如果结束


.子程序 _按钮4_被单击, 空白型, , 
.局部变量 www, 文本型, , "0", 
.局部变量 www1, 文本型, , "0", 

.如果 (等于 (打开 (), 真))
    赋值 (.内容, .文件名)
    赋值 (www, 分割文本 (.文件名, “\”, ))
    赋值 (www1, 分割文本 (www [取数组成员数 (www)], “.”, ))
    赋值 (.内容, www1 [1])
.否则
    
.如果结束


.子程序 _按钮5_被单击, 空白型, , 
.局部变量 www, 文本型, , "0", 
.局部变量 www1, 文本型, , "0", 

.如果 (等于 (打开 (), 真))
    赋值 (.内容, .文件名)
    赋值 (www, 分割文本 (.文件名, “\”, ))
    赋值 (www1, 分割文本 (www [取数组成员数 (www)], “.”, ))
    赋值 (.内容, www1 [1])
.否则
    
.如果结束


.子程序 _按钮6_被单击, 空白型, , 
.如果 (并且 (不等于 (.内容, “”), 不等于 (.内容, “”)))
    写配置项 (相加 (当前目录, “config.ini”), “外挂1”, “标题”, .内容)
    写配置项 (相加 (当前目录, “config.ini”), “外挂1”, “程序”, .内容)
.否则
    写配置项 (相加 (当前目录, “config.ini”), “外挂1”, “标题”, “”)
    写配置项 (相加 (当前目录, “config.ini”), “外挂1”, “程序”, “”)
.如果结束
.如果 (并且 (不等于 (.内容, “”), 不等于 (.内容, “”)))
    写配置项 (相加 (当前目录, “config.ini”), “外挂2”, “标题”, .内容)
    写配置项 (相加 (当前目录, “config.ini”), “外挂2”, “程序”, .内容)
.否则
    写配置项 (相加 (当前目录, “config.ini”), “外挂2”, “标题”, “”)
    写配置项 (相加 (当前目录, “config.ini”), “外挂2”, “程序”, “”)
.如果结束
.如果 (并且 (不等于 (.内容, “”), 不等于 (.内容, “”)))
    写配置项 (相加 (当前目录, “config.ini”), “外挂3”, “标题”, .内容)
    写配置项 (相加 (当前目录, “config.ini”), “外挂3”, “程序”, .内容)
.否则
    写配置项 (相加 (当前目录, “config.ini”), “外挂3”, “标题”, “”)
    写配置项 (相加 (当前目录, “config.ini”), “外挂3”, “程序”, “”)
.如果结束
.如果 (并且 (不等于 (.内容, “”), 不等于 (.内容, “”)))
    写配置项 (相加 (当前目录, “config.ini”), “外挂4”, “标题”, .内容)
    写配置项 (相加 (当前目录, “config.ini”), “外挂4”, “程序”, .内容)
.否则
    写配置项 (相加 (当前目录, “config.ini”), “外挂4”, “标题”, “”)
    写配置项 (相加 (当前目录, “config.ini”), “外挂4”, “程序”, “”)
.如果结束
.如果 (并且 (不等于 (.内容, “”), 不等于 (.内容, “”)))
    写配置项 (相加 (当前目录, “config.ini”), “外挂5”, “标题”, .内容)
    写配置项 (相加 (当前目录, “config.ini”), “外挂5”, “程序”, .内容)
.否则
    写配置项 (相加 (当前目录, “config.ini”), “外挂5”, “标题”, “”)
    写配置项 (相加 (当前目录, “config.ini”), “外挂5”, “程序”, “”)
.如果结束
信息框 (“配置更改已经保存！该配置将在软件下一次启动后生效！”, 64, )
外挂配置.销毁 ()

.子程序 _按钮7_被单击, 空白型, , 
外挂配置.销毁 ()

.子程序 _外挂配置_创建完毕, 空白型, , 
赋值 (.内容, 读配置项 (相加 (当前目录, “config.ini”), “外挂1”, “标题”, “”))
赋值 (.内容, 读配置项 (相加 (当前目录, “config.ini”), “外挂1”, “程序”, “”))
赋值 (.内容, 读配置项 (相加 (当前目录, “config.ini”), “外挂2”, “标题”, “”))
赋值 (.内容, 读配置项 (相加 (当前目录, “config.ini”), “外挂2”, “程序”, “”))
赋值 (.内容, 读配置项 (相加 (当前目录, “config.ini”), “外挂3”, “标题”, “”))
赋值 (.内容, 读配置项 (相加 (当前目录, “config.ini”), “外挂3”, “程序”, “”))
赋值 (.内容, 读配置项 (相加 (当前目录, “config.ini”), “外挂4”, “标题”, “”))
赋值 (.内容, 读配置项 (相加 (当前目录, “config.ini”), “外挂4”, “程序”, “”))
赋值 (.内容, 读配置项 (相加 (当前目录, “config.ini”), “外挂5”, “标题”, “”))
赋值 (.内容, 读配置项 (相加 (当前目录, “config.ini”), “外挂5”, “程序”, “”))

.窗口程序集 窗口程序集31, , , 

.程序集变量 是否停止, 逻辑型, , , 
.子程序 _分公司分类销量统计_尺寸被改变, 空白型, , 
相减 (分公司分类销量统计., .宽度, 15).移动 (10, , )
0.移动 (10, 相减 (分公司分类销量统计., .宽度, 20), 相减 (分公司分类销量统计., ., 43))
.移动 (.左边, 相加 (.顶边, .高度, 5), , )

.子程序 _分公司分类销量统计_创建完毕, 空白型, , 
写到文件 (相加 (未知支持库函数_7 (11), “\fgsxl.grd”), #分公司销量)
相加 (未知支持库函数_7 (11), “\fgsxl.grd”).从文件读 ()

.子程序 _超级按钮2_被单击, 空白型, , 
.局部变量 周转相金额, 双精度小数型, , , 
.局部变量 现辟金额, 双精度小数型, , , 
.局部变量 现辟日销量, 双精度小数型, , , 
.局部变量 易拉罐金额, 双精度小数型, , , 
.局部变量 易拉罐日销量, 双精度小数型, , , 
.局部变量 纸箱金额, 双精度小数型, , , 
.局部变量 纸箱日销量, 双精度小数型, , , 
.局部变量 周转相日销量, 双精度小数型, , , 
.局部变量 塑包金额, 双精度小数型, , , 
.局部变量 塑包日销量, 双精度小数型, , , 
.局部变量 单位编码, 文本型, , , 
.局部变量 是否符合, 逻辑型, , , 
.局部变量 单位, 文本型, , , 
.局部变量 当前单据编号, 文本型, , , 
.局部变量 中转变量, 文本型, , , 
.局部变量 匿名局部变量_4206, 空白型, , , 
.局部变量 当前库文件名, 文本型, , , 
.局部变量 dddd, 整数型, , , 
.局部变量 当前单位编号, 文本型, , , 
.局部变量 当前片区, 文本型, , , 
.局部变量 临时变量, 整数型, , , 
.局部变量 匿名局部变量_4272, 空白型, , , 
.局部变量 塑包合计, 双精度小数型, , , 
.局部变量 纸箱合计, 双精度小数型, , , 
.局部变量 鲜啤合计, 双精度小数型, , , 
.局部变量 周转箱合计, 双精度小数型, , , 
.局部变量 易拉罐合计, 双精度小数型, , , 

赋值 (.数据源, “”)
置等待鼠标 ()
赋值 (., 真)
赋值 (是否停止, 假)
.如果 (小于 (取日期 (.今天), 取日期 (.今天)))
    信息框 (“截止日期不能比开始日期还早，请重新设定！！！”, 0, )
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
.如果 (不等于 (取年份 (取日期 (.今天)), 取年份 (取日期 (.今天))))
    信息框 (“报表处理的数据要求在同一年度，请重新设定开始日期与截止日期！！！”, 0, )
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
写到文件 (相加 (未知支持库函数_7 (11), “\fgsxl.grd”), #分公司销量)
相加 (未知支持库函数_7 (11), “\fgsxl.grd”).从文件读 ()
赋值 (dddd, 打开文件 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 4, ))
.如果 (不等于 (dddd, 0))
    关闭文件 (dddd)
.否则
    信息框 (“建立临时数据文件失败，请稍候再试！”, 16, )
    赋值 (., 假)
    恢复鼠标 ()
    返回 ()
.如果结束
.如果 (等于 (打开 (相加 (当前目录, “data\save\”, 到文本 (取年份 (.今天)), “.ldb”), , , , , “lgq”, ), 真))
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        0.置文本 (相加 (“正在生成统计数据,已经完成”, 到文本 (取整 (相乘 (相除 (取记录号 (), 取记录数 ()), 100))), “%”))
        处理事件 ()
        .如果 (等于 (是否停止, 真))
            全部关闭 ()
            0.置文本 (“”)
            写到文件 (相加 (未知支持库函数_7 (11), “\fgsxl.grd”), #分公司销量)
            相加 (未知支持库函数_7 (11), “\fgsxl.grd”).从文件读 ()
            赋值 (., 假)
            返回 ()
        .否则
            
        .如果结束
        置等待鼠标 ()
        .如果 (并且 (大于或等于 (取日期 (到时间 (读 (“日期”))), 取日期 (.今天)), 小于或等于 (取日期 (到时间 (读 (“日期”))), 取日期 (.今天)), 等于 (读 (“作废”), 假)))
            赋值 (当前单位编号, 读 (“单位编号”))
            .如果 (等于 (当前单位编号, “”))
                恢复鼠标 ()
                鸣叫 ()
                信息框 (相加 (“单据”, 读 (“编号”), “存在空的单位编号,系统数据可能会错误,系统将中止数据处理.”), 0, )
                全部关闭 ()
                赋值 (., 假)
                返回 ()
            .否则
                
            .如果结束
            赋值 (当前库文件名, 取当前库 ())
            .如果 (等于 (打开 (相加 (当前目录, “data\index.ldb”), , , , , “lgq”, ), 假))
                全部关闭 ()
                恢复鼠标 ()
                鸣叫 ()
                信息框 (“打开索引数据库错误，请确定该数据库确实存在且完整！”, 0, )
                赋值 (., 假)
                返回 ()
            .否则
                
            .如果结束
            置当前库 (相加 (当前目录, “data\index.ldb”))
            到首记录 ()
            .如果 (等于 (查找 (等于 (读 (“编号”), 当前单位编号)), 真))
                赋值 (当前片区, 读 (“所属片区”))
            .否则
                全部关闭 ()
                恢复鼠标 ()
                鸣叫 ()
                信息框 (相加 (“编号为：”, 当前单位编号, “的单位不存在，请检查索引数据库！”), 0, )
                赋值 (., 假)
                返回 ()
            .如果结束
            关闭 ()
            置当前库 (当前库文件名)
            .如果 (等于 (读 (“反冲”), 假))
                赋值 (临时变量, 1)
                .计次循环首 (4, 临时变量)
                    赋值 (单位, 读 (相加 (“单位”, 到文本 (临时变量))))
                    赋值 (纸箱日销量, 0)
                    赋值 (易拉罐日销量, 0)
                    赋值 (塑包日销量, 0)
                    赋值 (周转相日销量, 0)
                    赋值 (现辟日销量, 0)
                    赋值 (纸箱金额, 0)
                    赋值 (易拉罐金额, 0)
                    赋值 (塑包金额, 0)
                    赋值 (周转相金额, 0)
                    赋值 (现辟金额, 0)
                    .如果 (并且 (等于 (单位, “箱”), 不等于 (读 (相加 (“规格”, 到文本 (临时变量))), “350ml*24”), 不等于 (读 (相加 (“规格”, 到文本 (临时变量))), “350ml*12”)))
                        赋值 (纸箱日销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 3)), 到数值 (取文本右边 (读 (相加 (“规格”, 到文本 (临时变量))), 2)), 到数值 (读 (相加 (“数量”, 到文本 (临时变量))))))
                        赋值 (纸箱金额, 到数值 (读 (相加 (“净水总价”, 到文本 (临时变量)))))
                    .否则
                        .如果 (等于 (单位, “箱”))
                            赋值 (易拉罐日销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 3)), 到数值 (取文本右边 (读 (相加 (“规格”, 到文本 (临时变量))), 2)), 到数值 (读 (相加 (“数量”, 到文本 (临时变量))))))
                            赋值 (易拉罐金额, 到数值 (读 (相加 (“净水总价”, 到文本 (临时变量)))))
                        .否则
                            .如果 (等于 (单位, “包”))
                                赋值 (塑包日销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 3)), 到数值 (取文本右边 (读 (相加 (“规格”, 到文本 (临时变量))), 1)), 到数值 (读 (相加 (“数量”, 到文本 (临时变量))))))
                                赋值 (塑包金额, 到数值 (读 (相加 (“净水总价”, 到文本 (临时变量)))))
                            .否则
                                .如果 (等于 (单位, “筐”))
                                    赋值 (周转相日销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 3)), 到数值 (取文本右边 (读 (相加 (“规格”, 到文本 (临时变量))), 2)), 到数值 (读 (相加 (“数量”, 到文本 (临时变量))))))
                                    赋值 (周转相金额, 到数值 (读 (相加 (“净水总价”, 到文本 (临时变量)))))
                                .否则
                                    .如果 (等于 (单位, “桶”))
                                        赋值 (现辟日销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 2)), 到数值 (读 (相加 (“数量”, 到文本 (临时变量)))), 1000))
                                        赋值 (现辟金额, 到数值 (读 (相加 (“净水总价”, 到文本 (临时变量)))))
                                    .否则
                                        .如果 (等于 (单位, “罐”))
                                            赋值 (现辟日销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 相减 (取文本长度 (读 (相加 (“规格”, 到文本 (临时变量)))), 2))), 到数值 (读 (相加 (“数量”, 到文本 (临时变量)))), 1000000))
                                            赋值 (现辟金额, 到数值 (读 (相加 (“净水总价”, 到文本 (临时变量)))))
                                        .否则
                                            
                                        .如果结束
                                        
                                    .如果结束
                                    
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    写配置项 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 当前片区, “塑包销量”, 到文本 (相加 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 当前片区, “塑包销量”, “0”)), 塑包日销量)))
                    写配置项 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 当前片区, “易拉罐销量”, 到文本 (相加 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 当前片区, “易拉罐销量”, “0”)), 易拉罐日销量)))
                    写配置项 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 当前片区, “纸箱销量”, 到文本 (相加 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 当前片区, “纸箱销量”, “0”)), 纸箱日销量)))
                    写配置项 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 当前片区, “鲜啤销量”, 到文本 (相加 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 当前片区, “鲜啤销量”, “0”)), 现辟日销量)))
                    写配置项 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 当前片区, “周转箱销量”, 到文本 (相加 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 当前片区, “周转箱销量”, “0”)), 周转相日销量)))
                .计次循环尾 ()
            .否则
                赋值 (临时变量, 1)
                .计次循环首 (4, 临时变量)
                    赋值 (单位, 读 (相加 (“单位”, 到文本 (临时变量))))
                    赋值 (纸箱日销量, 0)
                    赋值 (易拉罐日销量, 0)
                    赋值 (塑包日销量, 0)
                    赋值 (周转相日销量, 0)
                    赋值 (现辟日销量, 0)
                    赋值 (纸箱金额, 0)
                    赋值 (易拉罐金额, 0)
                    赋值 (塑包金额, 0)
                    赋值 (周转相金额, 0)
                    赋值 (现辟金额, 0)
                    .如果 (并且 (等于 (单位, “箱”), 不等于 (读 (相加 (“规格”, 到文本 (临时变量))), “350ml*24”), 不等于 (读 (相加 (“规格”, 到文本 (临时变量))), “350ml*12”)))
                        赋值 (纸箱日销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 3)), 到数值 (取文本右边 (读 (相加 (“规格”, 到文本 (临时变量))), 2)), 到数值 (读 (相加 (“数量”, 到文本 (临时变量))))))
                        赋值 (纸箱金额, 到数值 (读 (相加 (“净水总价”, 到文本 (临时变量)))))
                    .否则
                        .如果 (等于 (单位, “箱”))
                            赋值 (易拉罐日销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 3)), 到数值 (取文本右边 (读 (相加 (“规格”, 到文本 (临时变量))), 2)), 到数值 (读 (相加 (“数量”, 到文本 (临时变量))))))
                            赋值 (易拉罐金额, 到数值 (读 (相加 (“净水总价”, 到文本 (临时变量)))))
                        .否则
                            .如果 (等于 (单位, “包”))
                                赋值 (塑包日销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 3)), 到数值 (取文本右边 (读 (相加 (“规格”, 到文本 (临时变量))), 1)), 到数值 (读 (相加 (“数量”, 到文本 (临时变量))))))
                                赋值 (塑包金额, 到数值 (读 (相加 (“净水总价”, 到文本 (临时变量)))))
                            .否则
                                .如果 (等于 (单位, “筐”))
                                    赋值 (周转相日销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 3)), 到数值 (取文本右边 (读 (相加 (“规格”, 到文本 (临时变量))), 2)), 到数值 (读 (相加 (“数量”, 到文本 (临时变量))))))
                                    赋值 (周转相金额, 到数值 (读 (相加 (“净水总价”, 到文本 (临时变量)))))
                                .否则
                                    .如果 (等于 (单位, “桶”))
                                        赋值 (现辟日销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 2)), 到数值 (读 (相加 (“数量”, 到文本 (临时变量)))), 1000))
                                        赋值 (现辟金额, 到数值 (读 (相加 (“净水总价”, 到文本 (临时变量)))))
                                    .否则
                                        .如果 (等于 (单位, “罐”))
                                            赋值 (现辟日销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 到文本 (临时变量))), 相减 (取文本长度 (读 (相加 (“规格”, 到文本 (临时变量)))), 2))), 到数值 (读 (相加 (“数量”, 到文本 (临时变量)))), 1000000))
                                            赋值 (现辟金额, 到数值 (读 (相加 (“净水总价”, 到文本 (临时变量)))))
                                        .否则
                                            
                                        .如果结束
                                        
                                    .如果结束
                                    
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    写配置项 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 当前片区, “塑包销量”, 到文本 (相减 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 当前片区, “塑包销量”, “0”)), 塑包日销量)))
                    写配置项 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 当前片区, “易拉罐销量”, 到文本 (相减 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 当前片区, “易拉罐销量”, “0”)), 易拉罐日销量)))
                    写配置项 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 当前片区, “纸箱销量”, 到文本 (相减 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 当前片区, “纸箱销量”, “0”)), 纸箱日销量)))
                    写配置项 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 当前片区, “鲜啤销量”, 到文本 (相减 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 当前片区, “鲜啤销量”, “0”)), 现辟日销量)))
                    写配置项 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 当前片区, “周转箱销量”, 到文本 (相减 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 当前片区, “周转箱销量”, “0”)), 周转相日销量)))
                .计次循环尾 ()
            .如果结束
            
        .否则
            
        .如果结束
        跳过 ()
    .判断循环尾 ()
    
    0.置文本 (“正在生成表格,请稍等……”)
    处理事件 ()
    .如果 (等于 (是否停止, 真))
        全部关闭 ()
        0.置文本 (“”)
        写到文件 (相加 (未知支持库函数_7 (11), “\fgsxl.grd”), #分公司销量)
        相加 (未知支持库函数_7 (11), “\fgsxl.grd”).从文件读 ()
        赋值 (., 假)
        返回 ()
    .否则
        
    .如果结束
    置等待鼠标 ()
    赋值 (临时变量, 1)
    赋值 (塑包合计, 0)
    赋值 (易拉罐合计, 0)
    赋值 (周转箱合计, 0)
    赋值 (鲜啤合计, 0)
    赋值 (纸箱合计, 0)
    .计次循环首 (到数值 (读配置项 (相加 (当前目录, “data\pq.ldb”), “片区”, “总数”, “0”)), 临时变量)
        赋值 (当前片区, 读配置项 (相加 (当前目录, “data\pq.ldb”), “片区”, 相加 (“vol”, 到文本 (临时变量)), ))
        1.添加行 ()
        取行数 ().置文本 (1, 当前片区)
        赋值 (中转变量, 到文本 (四舍五入 (相除 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 当前片区, “塑包销量”, “0”)), 1000000), 3)))
        取行数 ().置文本 (2, 中转变量)
        赋值 (塑包合计, 相加 (塑包合计, 到数值 (中转变量)))
        赋值 (中转变量, 到文本 (四舍五入 (相除 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 当前片区, “周转箱销量”, “0”)), 1000000), 3)))
        取行数 ().置文本 (3, 中转变量)
        赋值 (周转箱合计, 相加 (周转箱合计, 到数值 (中转变量)))
        赋值 (中转变量, 到文本 (四舍五入 (相除 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 当前片区, “纸箱销量”, “0”)), 1000000), 3)))
        取行数 ().置文本 (4, 中转变量)
        赋值 (纸箱合计, 相加 (纸箱合计, 到数值 (中转变量)))
        赋值 (中转变量, 到文本 (四舍五入 (相除 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 当前片区, “易拉罐销量”, “0”)), 1000000), 3)))
        取行数 ().置文本 (5, 中转变量)
        赋值 (易拉罐合计, 相加 (易拉罐合计, 到数值 (中转变量)))
        赋值 (中转变量, 到文本 (四舍五入 (相除 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\fgsxl.ini”), 当前片区, “鲜啤销量”, “0”)), 1000000), 3)))
        取行数 ().置文本 (6, 中转变量)
        赋值 (鲜啤合计, 相加 (鲜啤合计, 到数值 (中转变量)))
        取行数 ().置文本 (7, 到文本 (相加 (到数值 (取行数 ().取文本 (2)), 到数值 (取行数 ().取文本 (3)), 到数值 (取行数 ().取文本 (4)), 到数值 (取行数 ().取文本 (5)), 到数值 (取行数 ().取文本 (6)))))
    .计次循环尾 ()
    1.添加行 ()
    取行数 ().置文本 (1, “总合计”)
    取行数 ().置文本 (2, 到文本 (塑包合计))
    取行数 ().置文本 (3, 到文本 (周转箱合计))
    取行数 ().置文本 (4, 到文本 (纸箱合计))
    取行数 ().置文本 (5, 到文本 (易拉罐合计))
    取行数 ().置文本 (6, 到文本 (鲜啤合计))
    取行数 ().置文本 (7, 到文本 (相加 (到数值 (取行数 ().取文本 (2)), 到数值 (取行数 ().取文本 (3)), 到数值 (取行数 ().取文本 (4)), 到数值 (取行数 ().取文本 (5)), 到数值 (取行数 ().取文本 (6)))))
.否则
    信息框 (相加 (“打开”, 到文本 (取年份 (.今天)), “单据数据库错误,请检查单据是否已经存在和完整!”), 0, )
.如果结束
0.置表头行数 ()
.如果 (不等于 (取日期 (.今天), 取日期 (.今天)))
    1.置文本 (1, 相加 (到文本 (取日期 (.今天)), “至”, 到文本 (取日期 (.今天)), “各分公司产品分类统计表”))
.否则
    1.置文本 (1, 相加 (到文本 (取日期 (.今天)), “各分公司产品分类统计表”))
.如果结束
2.置表头行数 ()
赋值 (临时变量, 到数值 (读配置项 (相加 (当前目录, “data\pq.ldb”), “片区”, “总数”, “0”)))
1.加线条 (1, 取行数 (), 取列数 (), 63)
1.置行高 (取行数 (), 相除 (1450, 相加 (临时变量, 3)))
1.置对齐方式 (1, 取行数 (), 取列数 (), 5)
1.添加行 ()
取行数 ().合并 (1, 1, 取列数 ())
取行数 ().置文本 (1, 到全角 (“             制表：                      审核：”))
恢复鼠标 ()
全部关闭 ()
赋值 (., 假)
0.置文本 (“”)
赋值 (.数据源, “数据源1”)

.子程序 _超级按钮1_被单击, 空白型, , 
打印预览 ()

.子程序 _超级按钮3_被单击, 空白型, , 
赋值 (.文件名, 1.取文本 (1))
.如果 (等于 (打开 (), 真))
    .存到文件 (.文件名)
.否则
    
.如果结束


.子程序 _超级按钮5_被单击, 空白型, , 
.如果 (等于 (., 假))
    分公司分类销量统计.销毁 ()
.否则
    信息框 (“请等待报表生成完毕，或取消生成后再关闭本窗口！”, 0, )
.如果结束


.子程序 _超级按钮4_被单击, 空白型, , 
.如果 (等于 (打开 (), 真))
    .从文件读 (.文件名)
.否则
    
.如果结束


.子程序 _超级按钮6_被单击, 空白型, , 
.局部变量 临时文件名, 文本型, , , 

赋值 (.文件名, 1.取文本 (1))
.如果 (等于 (打开 (), 真))
    赋值 (临时文件名, 取临时文件名 ())
    5.添加行 ()
    .如果 (等于 (临时文件名.存到文件 (), 真))
        .如果 (等于 (转换数据 (临时文件名, 1, .文件名), 真))
            信息框 (“该报表数据已经成功转换为EXCEL文件！”, 0, )
        .否则
            信息框 (“该报表数据暂时不能转换为EXCEL文件，请稍后再试！”, 0, )
        .如果结束
        
    .否则
        信息框 (“该报表数据暂时不能转换为EXCEL文件，请稍后再试！”, 0, )
    .如果结束
    相减 (取行数 (), 4).删除行 (5)
    删除文件 (临时文件名)
.否则
    
.如果结束


.子程序 _分公司分类销量统计_可否被关闭, 逻辑型, , 
赋值 (是否停止, 真)
返回 (假)

.窗口程序集 窗口程序集32, , , 

.程序集变量 当前分公司, 文本型, , , 
.程序集变量 是否停止, 逻辑型, , , 
.子程序 初始化表格, 空白型, , 
写到文件 (相加 (未知支持库函数_7 (11), “pzxl.grd”), #品种销量)
相加 (未知支持库函数_7 (11), “pzxl.grd”).从文件读 ()
0.置表头行数 ()
2.置文本 (1, “分公司”)
3.置表头行数 ()

.子程序 _超级按钮2_被单击, 空白型, , 
.局部变量 分类循环, 整数型, , , 
.局部变量 品种循环, 整数型, , , 
.局部变量 当前分类, 文本型, , , 
.局部变量 当前品种, 文本型, , , 
.局部变量 产品名称数组, 文本型, , "0", 
.局部变量 产品编号数组, 文本型, , "0", 
.局部变量 该条品种, 文本型, , , 
.局部变量 当前产品数量, 整数型, , , 
.局部变量 产品数量, 整数型, , , 
.局部变量 累计销量, 双精度小数型, , , 
.局部变量 累计销售额, 双精度小数型, , , 
.局部变量 千升酒收入, 双精度小数型, , , 
.局部变量 当前库文件名, 文本型, , , 
.局部变量 容量计算, 文本型, , "0", 
.局部变量 分类合并数量, 整数型, , , 
.局部变量 销量合计, 双精度小数型, , , 
.局部变量 销量总合计, 双精度小数型, , , 
.局部变量 销售额总合计, 双精度小数型, , , 
.局部变量 销售额合计, 双精度小数型, , , 
.局部变量 销售额合计含生啤, 双精度小数型, , , 
.局部变量 销量合计含生啤, 双精度小数型, , , 
.局部变量 生啤销量合计, 双精度小数型, , , 
.局部变量 生啤销售额合计, 双精度小数型, , , 
.局部变量 当前单位编号, 文本型, , , 
.局部变量 统计文件, 整数型, , , 
.局部变量 临时循环变量, 整数型, , , 
.局部变量 临时文本变量, 文本型, , , 
.局部变量 是否符合, 逻辑型, , , 
.局部变量 是否崂啤, 逻辑型, , , 

赋值 (.数据源, “”)
赋值 (., 真)
获取焦点 ()
置等待鼠标 ()
赋值 (是否停止, 假)
.如果 (等于 (.内容, “”))
    信息框 (“请选择要生成报表的分公司，否则不能继续进行处理！”, 0, )
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
.如果 (小于 (取日期 (.今天), 取日期 (.今天)))
    信息框 (“截止日期不能比开始日期还早，请重新设定！！！”, 0, )
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
.如果 (不等于 (取年份 (取日期 (.今天)), 取年份 (取日期 (.今天))))
    信息框 (“报表处理的数据要求在同一年度，请重新设定开始日期与截止日期！！！”, 0, )
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
写到文件 (相加 (未知支持库函数_7 (11), “pzxl.grd”), #品种销量)
相加 (未知支持库函数_7 (11), “pzxl.grd”).从文件读 ()
0.置表头行数 ()
.如果 (不等于 (取日期 (.今天), 取日期 (.今天)))
    1.置文本 (1, 相加 (到文本 (取日期 (.今天)), “至”, 到文本 (取日期 (.今天)), “分公司品种销量统计表”))
.否则
    1.置文本 (1, 相加 (到文本 (取日期 (.今天)), “分公司品种销量统计表”))
.如果结束
2.置文本 (1, “分公司”)
3.置表头行数 ()
赋值 (分类循环, 1)
赋值 (品种循环, 1)
赋值 (销售额总合计, 0)
赋值 (销量总合计, 0)
赋值 (统计文件, 打开文件 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 4, ))
.如果 (等于 (统计文件, 0))
    信息框 (“统计数据临时交换文件创建失败，请稍后再试！”, 0, )
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    关闭文件 (统计文件)
.如果结束
.如果 (等于 (打开 (相加 (当前目录, “data\save\”, 到文本 (取年份 (.今天)), “.ldb”), , , , , “lgq”, ), 假))
    全部关闭 ()
    0.置文本 (“”)
    恢复鼠标 ()
    鸣叫 ()
    信息框 (“打开单据数据库错误，请确定该年度数据库确实存在且完整！”, 0, )
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    0.置文本 (相加 (“正在生成统计数据,已经完成”, 到文本 (取整 (相乘 (相除 (取记录号 (), 取记录数 ()), 100))), “%”))
    处理事件 ()
    .如果 (等于 (是否停止, 真))
        全部关闭 ()
        0.置文本 (“”)
        初始化表格 ()
        赋值 (., 假)
        返回 ()
    .否则
        
    .如果结束
    置等待鼠标 ()
    .如果 (并且 (大于或等于 (取日期 (到时间 (读 (“日期”))), 取日期 (.今天)), 小于或等于 (取日期 (到时间 (读 (“日期”))), 取日期 (.今天)), 等于 (读 (“作废”), 假))) ' 查询条件设置
        赋值 (当前单位编号, 读 (“单位编号”))
        赋值 (当前库文件名, 取当前库 ())
        .如果 (等于 (打开 (相加 (当前目录, “data\index.ldb”), , , , , “lgq”, ), 假))
            全部关闭 ()
            0.置文本 (“”)
            恢复鼠标 ()
            鸣叫 ()
            信息框 (“打开索引数据库错误，请确定该数据库确实存在且完整！”, 0, )
            赋值 (., 假)
            返回 ()
        .否则
            
        .如果结束
        置当前库 (相加 (当前目录, “data\index.ldb”))
        到首记录 ()
        .如果 (等于 (查找 (等于 (读 (“编号”), 当前单位编号)), 真))
            .如果 (等于 (读 (“所属片区”), .内容))
                赋值 (是否符合, 真)
            .否则
                赋值 (是否符合, 假)
            .如果结束
            
        .否则
            全部关闭 ()
            0.置文本 (“”)
            恢复鼠标 ()
            鸣叫 ()
            信息框 (相加 (“编号为：”, 当前单位编号, “的单位不存在，请检查索引数据库！”), 0, )
            赋值 (., 假)
            返回 ()
        .如果结束
        关闭 ()
        置当前库 (当前库文件名)
        .如果 (等于 (是否符合, 真))
            .如果 (等于 (读 (“反冲”), 真))
                赋值 (临时循环变量, 1)
                .计次循环首 (4, 临时循环变量)
                    赋值 (临时文本变量, 到文本 (临时循环变量))
                    .如果 (或者 (等于 (读 (相加 (“单位”, 临时文本变量)), “箱”), 等于 (读 (相加 (“单位”, 临时文本变量)), “筐”), 等于 (读 (相加 (“单位”, 临时文本变量)), “包”)))
                        清除数组 (容量计算)
                        赋值 (容量计算, 分割文本 (读 (相加 (“规格”, 临时文本变量)), “ml*”, ))
                        .如果 (等于 (取数组成员数 (容量计算), 2))
                            赋值 (累计销量, 相乘 (到数值 (容量计算 [1]), 到数值 (容量计算 [2]), 到数值 (读 (相加 (“数量”, 临时文本变量)))))
                        .否则
                            鸣叫 ()
                            信息框 (相加 (“单据”, 读 (“编号”), “存在产品规格错误，不能进行计算”), 0, )
                            全部关闭 ()
                            0.置文本 (“”)
                            恢复鼠标 ()
                            赋值 (., 假)
                            返回 ()
                        .如果结束
                        赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                    .否则
                        .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “桶”))
                            赋值 (累计销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 临时文本变量)), 相减 (取文本长度 (读 (相加 (“规格”, 临时文本变量))), 1))), 到数值 (读 (相加 (“数量”, 临时文本变量))), 1000))
                            赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                        .否则
                            .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “罐”))
                                赋值 (累计销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 临时文本变量)), 相减 (取文本长度 (读 (相加 (“规格”, 临时文本变量))), 2))), 到数值 (读 (相加 (“数量”, 临时文本变量))), 1000000))
                                赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                            .否则
                                .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “”))
                                    赋值 (累计销量, 0)
                                    赋值 (累计销售额, 0)
                                .否则
                                    鸣叫 ()
                                    信息框 (相加 (“单据”, 读 (“编号”), “存在产品单位错误，不能进行计算”), 0, )
                                    全部关闭 ()
                                    0.置文本 (“”)
                                    恢复鼠标 ()
                                    赋值 (., 假)
                                    返回 ()
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    写配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销量”, 到文本 (相减 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销量”, “0”)), 累计销量)))
                    写配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销售额”, 到文本 (相减 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销售额”, “0”)), 累计销售额)))
                .计次循环尾 ()
            .否则
                赋值 (临时循环变量, 1)
                .计次循环首 (4, 临时循环变量)
                    赋值 (临时文本变量, 到文本 (临时循环变量))
                    .如果 (或者 (等于 (读 (相加 (“单位”, 临时文本变量)), “箱”), 等于 (读 (相加 (“单位”, 临时文本变量)), “筐”), 等于 (读 (相加 (“单位”, 临时文本变量)), “包”)))
                        清除数组 (容量计算)
                        赋值 (容量计算, 分割文本 (读 (相加 (“规格”, 临时文本变量)), “ml*”, ))
                        .如果 (等于 (取数组成员数 (容量计算), 2))
                            赋值 (累计销量, 相乘 (到数值 (容量计算 [1]), 到数值 (容量计算 [2]), 到数值 (读 (相加 (“数量”, 临时文本变量)))))
                        .否则
                            鸣叫 ()
                            信息框 (相加 (“单据”, 读 (“编号”), “存在产品规格错误，不能进行计算”), 0, )
                            全部关闭 ()
                            0.置文本 (“”)
                            恢复鼠标 ()
                            赋值 (., 假)
                            返回 ()
                        .如果结束
                        赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                    .否则
                        .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “桶”))
                            赋值 (累计销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 临时文本变量)), 相减 (取文本长度 (读 (相加 (“规格”, 临时文本变量))), 1))), 到数值 (读 (相加 (“数量”, 临时文本变量))), 1000))
                            赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                        .否则
                            .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “罐”))
                                赋值 (累计销量, 相乘 (到数值 (取文本左边 (读 (相加 (“规格”, 临时文本变量)), 相减 (取文本长度 (读 (相加 (“规格”, 临时文本变量))), 2))), 到数值 (读 (相加 (“数量”, 临时文本变量))), 1000000))
                                赋值 (累计销售额, 到数值 (读 (相加 (“净水总价”, 临时文本变量))))
                            .否则
                                .如果 (等于 (读 (相加 (“单位”, 临时文本变量)), “”))
                                    赋值 (累计销量, 0)
                                    赋值 (累计销售额, 0)
                                .否则
                                    鸣叫 ()
                                    信息框 (相加 (“单据”, 读 (“编号”), “存在产品单位错误，不能进行计算”), 0, )
                                    全部关闭 ()
                                    0.置文本 (“”)
                                    恢复鼠标 ()
                                    赋值 (., 假)
                                    返回 ()
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    写配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销量”, 到文本 (相加 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销量”, “0”)), 累计销量)))
                    写配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销售额”, 到文本 (相加 (到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (相加 (“产品编号”, 临时文本变量)), “销售额”, “0”)), 累计销售额)))
                .计次循环尾 ()
            .如果结束
            
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    跳过 ()
.判断循环尾 ()
全部关闭 ()
.计次循环首 (3, )
    0.置文本 (“正在整理系统数据……”)
    鸣叫 ()
    赋值 (分类合并数量, 0)
    赋值 (销量合计, 0)
    赋值 (销售额合计, 0)
    .如果 (等于 (分类循环, 1))
        赋值 (当前分类, “高档”)
    .否则
        .如果 (等于 (分类循环, 2))
            赋值 (当前分类, “中档”)
        .否则
            .如果 (等于 (分类循环, 3))
                赋值 (当前分类, “低档”)
            .否则
                
            .如果结束
            
        .如果结束
        
    .如果结束
    赋值 (品种循环, 1)
    .计次循环首 (3, )
        .如果 (等于 (品种循环, 1))
            赋值 (当前品种, “周转箱”)
        .否则
            .如果 (等于 (品种循环, 2))
                赋值 (当前品种, “纸箱”)
            .否则
                .如果 (等于 (品种循环, 3))
                    赋值 (当前品种, “塑包”)
                .否则
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        清除数组 (产品名称数组)
        清除数组 (产品编号数组)
        .如果 (等于 (打开 (相加 (当前目录, “data\cpbh.ldb”), , , , , “lgq”, ), 真))
            到首记录 ()
            .判断循环首 (等于 (尾记录后 (), 假))
                .如果 (等于 (读 (“单位”), “筐”))
                    赋值 (该条品种, “周转箱”)
                .否则
                    .如果 (等于 (读 (“单位”), “箱”))
                        赋值 (该条品种, “纸箱”)
                    .否则
                        .如果 (等于 (读 (“单位”), “包”))
                            赋值 (该条品种, “塑包”)
                        .否则
                            赋值 (该条品种, “其他”)
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                .如果 (并且 (等于 (相加 (读 (“档次”), “档”), 当前分类), 等于 (该条品种, 当前品种)))
                    加入成员 (产品编号数组, 读 (“产品编号”))
                    加入成员 (产品名称数组, 读 (“产品名称”))
                .否则
                    
                .如果结束
                跳过 ()
            .判断循环尾 ()
            全部关闭 ()
            赋值 (产品数量, 取数组成员数 (产品编号数组))
            .如果 (大于 (产品数量, 0))
                赋值 (当前产品数量, 1)
                .计次循环首 (产品数量, )
                    0.置文本 (相加 (“正在处理”, 当前分类, “/”, 当前品种, “/”, 产品编号数组 [当前产品数量], “(”, 产品名称数组 [当前产品数量], “)”, “……”))
                    处理事件 ()
                    .如果 (等于 (是否停止, 真))
                        全部关闭 ()
                        0.置文本 (“”)
                        初始化表格 ()
                        赋值 (., 假)
                        返回 ()
                    .否则
                        
                    .如果结束
                    置等待鼠标 ()
                    赋值 (累计销量, 0)
                    赋值 (累计销售额, 0)
                    1.添加行 ()
                    取行数 ().置文本 (2, 当前分类)
                    取行数 ().置文本 (3, 当前品种)
                    取行数 ().置文本 (4, 产品编号数组 [当前产品数量])
                    取行数 ().置文本 (5, 产品名称数组 [当前产品数量])
                    赋值 (累计销量, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 产品编号数组 [当前产品数量], “销量”, “0”)))
                    赋值 (累计销售额, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 产品编号数组 [当前产品数量], “销售额”, “0”)))
                    取行数 ().置文本 (6, 到文本 (四舍五入 (相除 (累计销量, 1000000), 3)))
                    赋值 (销量合计, 相加 (销量合计, 四舍五入 (相除 (累计销量, 1000000), 3)))
                    取行数 ().置文本 (7, 到文本 (四舍五入 (累计销售额, 2)))
                    赋值 (销售额合计, 相加 (销售额合计, 四舍五入 (累计销售额, 2)))
                    .如果 (等于 (四舍五入 (相除 (累计销量, 1000000), 3), 0))
                        取行数 ().置文本 (8, “”)
                    .否则
                        取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (四舍五入 (累计销售额, 2), 四舍五入 (相除 (累计销量, 1000000), 3)), 2)))
                    .如果结束
                    赋值 (当前产品数量, 相加 (当前产品数量, 1))
                .计次循环尾 ()
                相加 (相减 (取行数 (), 产品数量), 1).合并 (3, 产品数量, 1)
                赋值 (分类合并数量, 相加 (分类合并数量, 产品数量))
            .否则
                
            .如果结束
            
        .否则
            信息框 (“读取产品信息库数据错误，请确认该数据库是否存在且完整！”, 0, )
        .如果结束
        赋值 (品种循环, 相加 (品种循环, 1))
    .计次循环尾 ()
    相加 (相减 (取行数 (), 分类合并数量), 1).合并 (2, 分类合并数量, 1)
    1.添加行 ()
    取行数 ().合并 (2, 1, 4)
    取行数 ().置文本 (2, 相加 (当前分类, “酒合计”))
    取行数 ().置文本 (6, 到文本 (四舍五入 (销量合计, 3)))
    取行数 ().置文本 (7, 到文本 (四舍五入 (销售额合计, 4)))
    .如果 (等于 (四舍五入 (销量合计, 3), 0))
        取行数 ().置文本 (8, “”)
    .否则
        取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (销售额合计, 销量合计), 2)))
    .如果结束
    赋值 (分类循环, 相加 (分类循环, 1))
    赋值 (销量总合计, 相加 (销量总合计, 销量合计))
    赋值 (销售额总合计, 相加 (销售额总合计, 销售额合计))
.计次循环尾 ()
0.置文本 (“正在处理生啤/桶装生啤数据……”)
鸣叫 ()
赋值 (累计销量, 0)
赋值 (累计销售额, 0)
.如果 (等于 (打开 (相加 (当前目录, “data\cpbh.ldb”), , , , , “lgq”, ), 假))
    信息框 (“打开单位索引数据库错误，请确定该数据库确实存在且完整！”, 0, )
    全部关闭 ()
    0.置文本 (“”)
    鸣叫 ()
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (等于 (读 (“单位”), “桶”))
        赋值 (累计销量, 相加 (累计销量, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (“产品编号”), “销量”, “0”))))
        赋值 (累计销售额, 相加 (累计销售额, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (“产品编号”), “销售额”, “0”))))
    .否则
        
    .如果结束
    跳过 ()
.判断循环尾 ()
全部关闭 ()
1.添加行 ()
取行数 ().置文本 (5, “桶装”)
取行数 ().置文本 (6, 到文本 (四舍五入 (相除 (累计销量, 1000000), 3)))
赋值 (销量合计含生啤, 相加 (销量总合计, 四舍五入 (相除 (累计销量, 1000000), 3)))
取行数 ().置文本 (7, 到文本 (四舍五入 (累计销售额, 2)))
赋值 (销售额合计含生啤, 相加 (销售额总合计, 四舍五入 (累计销售额, 2)))
.如果 (等于 (四舍五入 (相除 (累计销量, 1000000), 3), 0))
    取行数 ().置文本 (8, “”)
.否则
    取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (四舍五入 (累计销售额, 2), 四舍五入 (相除 (累计销量, 1000000), 3)), 2)))
.如果结束
赋值 (生啤销量合计, 四舍五入 (相除 (累计销量, 1000000), 3))
赋值 (生啤销售额合计, 四舍五入 (累计销售额, 2))


0.置文本 (“正在处理生啤/罐装生啤数据……”)
鸣叫 ()
赋值 (累计销量, 0)
赋值 (累计销售额, 0)
.如果 (等于 (打开 (相加 (当前目录, “data\cpbh.ldb”), , , , , “lgq”, ), 假))
    信息框 (“打开单位索引数据库错误，请确定该数据库确实存在且完整！”, 0, )
    全部关闭 ()
    0.置文本 (“”)
    鸣叫 ()
    恢复鼠标 ()
    赋值 (., 假)
    返回 ()
.否则
    
.如果结束
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (等于 (读 (“单位”), “罐”))
        赋值 (累计销量, 相加 (累计销量, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (“产品编号”), “销量”, “0”))))
        赋值 (累计销售额, 相加 (累计销售额, 到数值 (读配置项 (相加 (未知支持库函数_7 (11), “\tongji.ini”), 读 (“产品编号”), “销售额”, “0”))))
    .否则
        
    .如果结束
    跳过 ()
.判断循环尾 ()
全部关闭 ()
1.添加行 ()
取行数 ().置文本 (5, “罐装”)
取行数 ().置文本 (6, 到文本 (四舍五入 (相除 (累计销量, 1000000), 3)))
赋值 (销量合计含生啤, 相加 (销量合计含生啤, 四舍五入 (相除 (累计销量, 1000000), 3)))
取行数 ().置文本 (7, 到文本 (四舍五入 (累计销售额, 2)))
赋值 (销售额合计含生啤, 相加 (销售额合计含生啤, 四舍五入 (累计销售额, 2)))
.如果 (等于 (四舍五入 (相除 (累计销量, 1000000), 3), 0))
    取行数 ().置文本 (8, “”)
.否则
    取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (四舍五入 (累计销售额, 2), 四舍五入 (相除 (累计销量, 1000000), 3)), 2)))
.如果结束
赋值 (生啤销量合计, 相加 (生啤销量合计, 四舍五入 (相除 (累计销量, 1000000), 3)))
赋值 (生啤销售额合计, 相加 (生啤销售额合计, 四舍五入 (累计销售额, 2)))

1.添加行 ()
取行数 ().置文本 (6, 到文本 (生啤销量合计))
取行数 ().置文本 (7, 到文本 (生啤销售额合计))
.如果 (等于 (生啤销量合计, 0))
    取行数 ().置文本 (8, “”)
.否则
    取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (生啤销售额合计, 生啤销量合计), 2)))
.如果结束


相减 (取行数 (), 2).合并 (2, 3, 2)
相减 (取行数 (), 2).置文本 (2, “生啤”)

取行数 ().合并 (4, 1, 2)
取行数 ().置文本 (4, “生啤合计”)

1.添加行 ()
取行数 ().合并 (2, 1, 4)
取行数 ().置文本 (2, “总合计(含生啤)”)
取行数 ().置文本 (6, 到文本 (销量合计含生啤))
取行数 ().置文本 (7, 到文本 (销售额合计含生啤))
.如果 (等于 (销量合计含生啤, 0))
    取行数 ().置文本 (8, “”)
.否则
    取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (销售额合计含生啤, 销量合计含生啤), 2)))
.如果结束

1.添加行 ()
取行数 ().合并 (2, 1, 4)
取行数 ().置文本 (2, “总合计(不含生啤)”)
取行数 ().置文本 (6, 到文本 (销量总合计))
取行数 ().置文本 (7, 到文本 (销售额总合计))
.如果 (等于 (销量总合计, 0))
    取行数 ().置文本 (8, “”)
.否则
    取行数 ().置文本 (8, 到文本 (四舍五入 (相除 (销售额总合计, 销量总合计), 2)))
.如果结束


4.合并 (1, 相减 (取行数 (), 3), 1)
4.置文本 (1, .内容)
4.置对齐方式 (1, 相减 (取行数 (), 3), 8, 5)
4.加线条 (1, 相减 (取行数 (), 3), 8, 63)
4.加线条 (1, 相减 (取行数 (), 3), 1, )
全部关闭 ()
0.置文本 (“”)
鸣叫 ()
恢复鼠标 ()
赋值 (., 假)
赋值 (.数据源, “数据源1”)

.子程序 _分公司品种销量统计表_尺寸被改变, 空白型, , 
相减 (分公司品种销量统计表., .宽度, 15).移动 (10, , )
0.移动 (10, 相减 (分公司品种销量统计表., .宽度, 20), 相减 (分公司品种销量统计表., ., 43))
.移动 (.左边, 相加 (.顶边, .高度, 5), , )

.子程序 _超级按钮1_被单击, 空白型, , 
打印预览 ()

.子程序 _超级按钮3_被单击, 空白型, , 
赋值 (.文件名, 相加 (4.取文本 (1), “_”, 1.取文本 (1)))
.如果 (等于 (打开 (), 真))
    .存到文件 (.文件名)
.否则
    
.如果结束


.子程序 _超级按钮5_被单击, 空白型, , 
.如果 (等于 (., 假))
    分公司品种销量统计表.销毁 ()
.否则
    信息框 (“请等待报表生成完毕，或取消生成后再关闭本窗口！”, 0, )
.如果结束


.子程序 _超级按钮2_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果 (等于 (字符代码, 13))
    _超级按钮2_被单击 ()
.否则
    
.如果结束


.子程序 _超级按钮4_被单击, 空白型, , 
.如果 (等于 (打开 (), 真))
    .从文件读 (.文件名)
.否则
    
.如果结束


.子程序 _超级按钮6_被单击, 空白型, , 
.局部变量 临时文件名, 文本型, , , 

赋值 (.文件名, 相加 (4.取文本 (1), “_”, 1.取文本 (1)))
.如果 (等于 (打开 (), 真))
    赋值 (临时文件名, 取临时文件名 ())
    5.添加行 ()
    .如果 (等于 (临时文件名.存到文件 (), 真))
        .如果 (等于 (转换数据 (临时文件名, 1, .文件名), 真))
            信息框 (“该报表数据已经成功转换为EXCEL文件！”, 0, )
        .否则
            信息框 (“该报表数据暂时不能转换为EXCEL文件，请稍后再试！”, 0, )
        .如果结束
        
    .否则
        信息框 (“该报表数据暂时不能转换为EXCEL文件，请稍后再试！”, 0, )
    .如果结束
    相减 (取行数 (), 4).删除行 (5)
    删除文件 (临时文件名)
.否则
    
.如果结束


.子程序 _分公司品种销量统计表_创建完毕, 空白型, , 
赋值 (.今天, 到时间 (相加 (到文本 (取年份 (.今天)), “年1月1日”)))
初始化表格 ()
片区刷新 ()

.子程序 片区刷新, 空白型, , 
.局部变量 临时变量, 整数型, , , 

赋值 (临时变量, 1)
清空 ()
.计次循环首 (到数值 (读配置项 (相加 (当前目录, “data\pq.ldb”), “片区”, “总数”, “0”)), )
    读配置项 (相加 (当前目录, “data\pq.ldb”), “片区”, 相加 (“vol”, 到文本 (临时变量)), ).加入项目 ()
    赋值 (临时变量, 相加 (临时变量, 1))
.计次循环尾 ()
赋值 (.现行选中项, 0)

.子程序 _分公司品种销量统计表_可否被关闭, 逻辑型, , 
赋值 (是否停止, 真)
返回 (假)

.窗口程序集 窗口程序集33, , , 

.程序集变量 日期框变量, 日期框, , "24", 
.子程序 _月份配置_创建完毕, 空白型, , 
.局部变量 临时变量, 整数型, , , 

赋值 (日期框变量 [1], )
赋值 (日期框变量 [2], )
赋值 (日期框变量 [3], )
赋值 (日期框变量 [4], )
赋值 (日期框变量 [5], )
赋值 (日期框变量 [6], )
赋值 (日期框变量 [7], )
赋值 (日期框变量 [8], )
赋值 (日期框变量 [9], )
赋值 (日期框变量 [10], )
赋值 (日期框变量 [11], )
赋值 (日期框变量 [12], )
赋值 (日期框变量 [13], )
赋值 (日期框变量 [14], )
赋值 (日期框变量 [15], )
赋值 (日期框变量 [16], )
赋值 (日期框变量 [17], )
赋值 (日期框变量 [18], )
赋值 (日期框变量 [19], )
赋值 (日期框变量 [20], )
赋值 (日期框变量 [21], )
赋值 (日期框变量 [22], )
赋值 (日期框变量 [23], )
赋值 (日期框变量 [24], )
.计次循环首 (12, 临时变量)
    赋值 (日期框变量 [相减 (相乘 (临时变量, 2), 1)].今天, 到时间 (相加 (“2000年”, 读配置项 (相加 (当前目录, “data\yuefen.ini”), 相加 (到文本 (临时变量), “月份”), “止日期”, “”))))
    赋值 (日期框变量 [相乘 (临时变量, 2)].今天, 到时间 (相加 (“2000年”, 读配置项 (相加 (当前目录, “data\yuefen.ini”), 相加 (到文本 (临时变量), “月份”), “起日期”, “”))))
.计次循环尾 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 临时变量, 整数型, , , 

.计次循环首 (12, 临时变量)
    写配置项 (相加 (当前目录, “data\yuefen.ini”), 相加 (到文本 (临时变量), “月份”), “起日期”, 相加 (到文本 (取月份 (日期框变量 [相乘 (临时变量, 2)].今天)), “月”, 到文本 (取日 (日期框变量 [相乘 (临时变量, 2)].今天)), “日”))
    写配置项 (相加 (当前目录, “data\yuefen.ini”), 相加 (到文本 (临时变量), “月份”), “止日期”, 相加 (到文本 (取月份 (日期框变量 [相减 (相乘 (临时变量, 2), 1)].今天)), “月”, 到文本 (取日 (日期框变量 [相减 (相乘 (临时变量, 2), 1)].今天)), “日”))
.计次循环尾 ()
信息框 (“月份配置已经被成功保存！”, 0, )
月份配置.销毁 ()

.子程序 _按钮2_被单击, 空白型, , 
月份配置.销毁 ()

.窗口程序集 窗口程序集34, , , 

.子程序 _选择业务员_创建完毕, 空白型, , 
.局部变量 当前库文件, 文本型, , , 

赋值 (当前库文件, 取当前库 ())
.如果 (等于 (打开 (相加 (当前目录, “data\ywy.ldb”), , , , , “lgq”, ), 真))
    置当前库 (相加 (当前目录, “data\ywy.ldb”))
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        -1.插入表项 (读 (“业务编码”), , , , )
        相减 (取表项数 (), 1).置标题 (1, 读 (“业务员名称”))
        相减 (取表项数 (), 1).置标题 (2, 读 (“业务员电话”))
        跳过 ()
    .判断循环尾 ()
    关闭 ()
    置当前库 (当前库文件)
.否则
    
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
.如果 (不等于 (., -1))
    赋值 (业务员品种销量统计表..内容, .取标题 (., 0))
    赋值 (业务员品种销量统计表..标题, .取标题 (., 1))
    选择业务员.销毁 ()
.否则
    
.如果结束


.子程序 _超级列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (不等于 (., -1))
    _按钮2_被单击 ()
.否则
    
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
选择业务员.销毁 ()

.窗口程序集 窗口程序集35, , , 

.程序集变量 是否停止, 逻辑型, , , 
.程序集变量 结果, 文本型, , , 
.子程序 _按钮3_被单击, 空白型, , 
.如果 (打开 ())
    写到文件 (.文件名, 到字节集 (结果))
    信息框 (“数据文件保存完毕!!!!!!”, 0, )
.否则
    
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 间隔日, 双精度小数型, , , 
.局部变量 间隔年, 双精度小数型, , , 
.局部变量 当前年, 整数型, , , 
.局部变量 满足条件, 逻辑型, , , 
.局部变量 当前库, 文本型, , , 
.局部变量 当前名称, 文本型, , , 
.局部变量 当前编码, 文本型, , , 
.局部变量 当前单号, 文本型, , , 
.局部变量 临时文件, 文本型, , , 
.局部变量 当前表项, 整数型, , , 

赋值 (.标题, “正在生成业务编码数据！！”)
处理事件 ()
.如果 (等于 (打开 (相加 (当前目录, “data\index.ldb”), , , , , “lgq”, ), 真))
    到首记录 ()
    赋值 (临时文件, 取临时文件名 ())
    .判断循环首 (等于 (尾记录后 (), 假))
        写配置项 (临时文件, 读 (“名称”), “业务编码”, 读 (“业务编码”))
        跳过 ()
    .判断循环尾 ()
.否则
    全部关闭 ()
    信息框 (“打不开数据库,请检查index.ldb是否存在,或者被其他程序占用.”, 0, )
    返回 ()
.如果结束
全部关闭 ()
赋值 (是否停止, 假)
置等待鼠标 ()
赋值 (结果, “”)
全部删除 ()
赋值 (间隔年, 取时间间隔 (.今天, .今天, 1))
赋值 (间隔日, 取时间间隔 (.今天, .今天, 5))
.如果 (大于或等于 (间隔日, 0))
    赋值 (当前年, 取年份 (.今天))
    .计次循环首 (相加 (取整 (间隔年), 1), )
        .如果 (等于 (打开 (相加 (当前目录, “data\save\”, 到文本 (当前年), “.ldb”), , , , , “lgq”, ), 真))
            到首记录 ()
            赋值 (.标题, “正在查找第一笔业务数据！！”)
            处理事件 ()
            .如果 (等于 (查找 (大于或等于 (到时间 (读 (“日期”)), 取日期 (.今天))), 假))
                赋值 (当前年, 相加 (当前年, 1))
                到循环尾 ()
            .否则
                
            .如果结束
            .判断循环首 (等于 (尾记录后 (), 假))
                处理事件 ()
                .如果 (等于 (是否停止, 真))
                    全部关闭 ()
                    删除文件 (临时文件)
                    返回 ()
                .否则
                    置等待鼠标 ()
                .如果结束
                .如果 (并且 (大于或等于 (到时间 (读 (“日期”)), 取日期 (.今天)), 小于或等于 (到时间 (读 (“日期”)), 取日期 (.今天))))
                    赋值 (.标题, 读 (“日期”))
                    处理事件 ()
                    .如果 (不等于 (读配置项 (临时文件, 读 (“购货单位”), “业务编码”, ), 读 (“业务编码”)))
                        赋值 (当前表项, -1.插入表项 (读 (“编号”), , , , ))
                        当前表项.置标题 (1, 读 (“购货单位”))
                        当前表项.置标题 (2, 读配置项 (临时文件, 读 (“购货单位”), “业务编码”, ))
                        当前表项.置标题 (3, 读 (“业务编码”))
                        赋值 (结果, 相加 (结果, 读 (“编号”), “:编码不正确!”, 读 (“购货单位”), “应该为:”, 读配置项 (临时文件, 读 (“购货单位”), “业务编码”, ), “,实际为:”, 读 (“业务编码”), #换行符))
                    .否则
                        
                    .如果结束
                    
                .否则
                    跳出循环 ()
                .如果结束
                跳过 ()
            .判断循环尾 ()
        .否则
            
        .如果结束
        全部关闭 ()
        赋值 (当前年, 相加 (当前年, 1))
    .计次循环尾 ()
    信息框 (“查询完毕!!!!!!!!!!!!!!!!!!!!!!!!”, 0, )
.否则
    信息框 (“日期设置错误,请确定截止日期晚于开始日期！”, 0, )
.如果结束
全部关闭 ()
赋值 (是否停止, 真)
删除文件 (临时文件)

.子程序 _单据清理1_可否被关闭, 逻辑型, , 
赋值 (是否停止, 真)
返回 (假)


.子程序 _按钮4_被单击, 空白型, , 
销毁 ()


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 当前年, 文本型, , , 
.局部变量 应该编码, 文本型, , , 
.局部变量 实际编码, 文本型, , , 
.局部变量 当前单号, 文本型, , , 
.局部变量 当前表项, 整数型, , , 
.局部变量 i, 空白型, , , 

全部关闭 ()
赋值 (是否停止, 假)
置等待鼠标 ()
赋值 (结果, “”)
赋值 (当前单号, 0.取标题 (0))
赋值 (当前年, 取文本左边 (当前单号, 4))
打开 (相加 (当前目录, “data\save\”, 当前年, “.ldb”), , , , , “lgq”, )
.计次循环首 (取表项数 (), i)
    赋值 (当前单号, 相减 (i, 1).取标题 (0))
    赋值 (.标题, 相加 (“正在修改单据:”, 当前单号))
    处理事件 ()
    .如果 (不等于 (取文本左边 (当前单号, 4), 当前年))
        赋值 (当前年, 取文本左边 (当前单号, 4))
        全部关闭 ()
        .如果 (等于 (打开 (相加 (当前目录, “data\save\”, 当前年, “.ldb”), , , , , “lgq”, ), 真))
            
        .否则
            信息框 (相加 (“打开数据库错误：”, 当前年, “.ldb”), 0, )
            恢复鼠标 ()
            返回 ()
        .如果结束
        
    .否则
        
    .如果结束
    处理事件 ()
    赋值 (应该编码, 相减 (i, 1).取标题 (2))
    .如果 (不等于 (应该编码, “”))
         ' 到首记录 ()
        .如果 (查找 (等于 (读 (“编号”), 当前单号)))
            写字段 (“业务编码”, , 应该编码)
            相减 (i, 1).置标题 (3, “已修改”)
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    
.计次循环尾 ()
全部关闭 ()
信息框 (“查询完毕！ ”, 0, )

.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 存在性检测, 整数型, , 返回0表示不存在，1表示存在，-1表示检测失败
.参数 特征标记, 文本型, , 



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 转换数据, 逻辑型, , “转换方式”的参数值为1转换为数据库，否则为Excel格式，数据源的第一行如果有空表格会被替换为“无内容N”，如果长度超过16只截取最后10个字符，如果首字不是汉字会在前面加上“标题”
.参数 数据源数据文件名, 文本型, , 完整的文件路径
.参数 转换方式, 整数型, , 1为数据库，否则为Excel格式
.参数 输出文件名, 文本型, , 完整的路径



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 初始化水波纹, 空白型, , 要使水波纹生效，需加一个时钟，并置入水波纹周期事件，然后根据需要移动水波纹或添加涟漪
.参数 位图名称, 文本型, , 
.参数 时钟名称, 时钟, , 



.子程序 水波纹周期事件, 空白型, , 
.参数 窗口名称, 窗口, , 



.子程序 水波纹涟漪, 空白型, , 可用于“鼠标左键按下”事件中
.参数 窗口名称, 窗口, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 



.子程序 水波纹移动, 空白型, , 
.参数 窗口名称, 窗口, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 




 ' 不属于任何一个程序集、类模块的函数：
