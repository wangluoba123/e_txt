 ' 文件类型：Windows模块源码

 ' 程序名称：加入常用词汇(语音识别应用)
 ' 程序描述：模块接口子程序：载入加入常用词汇窗口
    载入一个可视化操作窗口，为语音识别提供常用词汇以供更加精确地识别语音。关闭窗口后，将返回一个文本型数组数据。
    参数<1>的名称为“数组变量”，类型为“文本型”，需要接收数组数据。注明：接受文本数组类型返回值的数组变量。

 ' 程序作者：袁天罡
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：voachina@qq.com
 ' 主页地址：http://30950.tttc8.com.cn
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 窗口之加入常用词汇
    左边 = 50
    顶边 = 50
    宽度 = 507
    高度 = 274
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “加入常用词汇”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 6 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 6 扩展界面支持库一
 ' Krnlnex {A00B8D30-A5AB-4dfe-9546-9E636E711B75} 1 5 辅助调试支持库




.全局变量 返回值, 文本型, , "0", 

.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码
_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。

.子程序 载入加入常用词汇窗口, 逻辑型, 公开, 载入一个可视化操作窗口，为语音识别提供常用词汇以供更加精确地识别语音。关闭窗口后，将返回一个文本型数组数据。窗口销毁后，返回真，以提示接受返回值。
.参数 数组变量, 文本型, 数组, 接受文本数组类型返回值的数组变量

载入 (窗口之加入常用词汇, , 假)
.判断循环首 (等于 (窗口之加入常用词汇., 假))
    未知支持库函数_5 (1000)
.判断循环尾 ()
重定义数组 (数组变量, 假, 取数组成员数 (返回值))
赋值 (数组变量, 返回值)
返回 (真)

.窗口程序集 窗口之加入常用词汇代码, , , '模块作者：袁天罡

.程序集变量 数组之常用词汇, 文本型, , "0", 
.程序集变量 程序集之当前数组位置, 空白型, , , 
.程序集变量 是否已销毁, 逻辑型, , , 
.子程序 词汇总数, 整数型, , 取得词汇表的总记录数
返回 (取数组成员数 (数组之常用词汇))

.子程序 后面状态, 空白型, , 
1.置文本 (相加 (“总数：”, 到文本 (词汇总数 ())))
.如果真 (等于 (词汇总数 (), 0))
    赋值 (程序集之当前数组位置, 0)
.如果真结束
2.置文本 (相加 (“位置：”, 到文本 (程序集之当前数组位置)))

.子程序 _按钮之加入_被单击, 空白型, , 
.局部变量 局部之数组上限, 空白型, , , 

赋值 (局部之数组上限, 相加 (词汇总数 (), 1))
重定义数组 (数组之常用词汇, 真, 局部之数组上限)
赋值 (数组之常用词汇 [局部之数组上限], .内容)
赋值 (程序集之当前数组位置, 局部之数组上限)
0.置文本 (相加 (“加入新常用词汇，位于词汇表的第”, 到文本 (局部之数组上限), “位”))
后面状态 ()

.子程序 _按钮之修改_被单击, 空白型, , 
.如果真 (等于 (词汇总数 (), 0))
    .如果真 (等于 (信息框 (“对不起，词汇表没有任何词汇记录，您必须先在词汇表里加入一些词汇才能对已存在的词汇记录执行修改操作。请问需要将当前内容加入词汇表吗？”, 相加 (#询问图标, #确认取消钮), ), #确认钮))
        _按钮之加入_被单击 ()
    .如果真结束
    返回 ()
.如果真结束
.如果真 (大于 (程序集之当前数组位置, 词汇总数 ()))
    信息框 (“当前标志的记录位置超出词汇表最大记录值，您必须点【向上】或【向下】按钮移动当前记录位置到合法位置才能执行修改操作”, #错误图标, )
    返回 ()
.如果真结束
赋值 (数组之常用词汇 [程序集之当前数组位置], .内容)
0.置文本 (相加 (“修改了词汇表的第”, 到文本 (程序集之当前数组位置), “条记录”))
后面状态 ()

.子程序 _按钮之删除_被单击, 空白型, , 
.如果真 (等于 (词汇总数 (), 0))
    0.置文本 (“当前词汇表的没有任何记录，不能删除”)
    返回 ()
.如果真结束
删除成员 (数组之常用词汇, 程序集之当前数组位置, )
0.置文本 (相加 (“删除了词汇表的第”, 到文本 (程序集之当前数组位置), “条记录”))
.如果 (小于或等于 (程序集之当前数组位置, 词汇总数 ())) ' 判断删除前的记录位置是否小于或等于当前记录总数,如果为真，则直接将删除前的记录位置等赋给删除后的记录位置，否则将当前记录位置移至删除前的记录位置的前一位置。这样做是为了不至于数组引用错误。
    .如果真 (不等于 (词汇总数 (), 0)) ' 如果词汇表的记录总数不为0，则可以直接将删除前的记录位置直接移植给删除后的记录位置
        赋值 (.内容, 数组之常用词汇 [程序集之当前数组位置])
    .如果真结束
    
.否则
    .如果真 (不等于 (词汇总数 (), 0)) ' 由于要取删除前的记录位置的前一位置给删除后的记录位置，因此必须保证词汇表记录总数不能小于1才能正确引用数组
        赋值 (程序集之当前数组位置, 词汇总数 ())
        赋值 (.内容, 数组之常用词汇 [程序集之当前数组位置])
    .如果真结束
    
.如果结束
后面状态 ()
赋值 (窗口之加入常用词汇., 到文本 (程序集之当前数组位置))

.子程序 _按钮之向上_被单击, 空白型, , 
.如果真 (等于 (词汇总数 (), 0))
    0.置文本 (“当前词汇表的没有任何记录，不能向上移动”)
    返回 ()
.如果真结束
.如果真 (等于 (程序集之当前数组位置, 1))
    0.置文本 (“当前已移至词汇表的最顶层记录，不能再继续向上移动”)
    返回 ()
.如果真结束
赋值 (程序集之当前数组位置, 相减 (程序集之当前数组位置, 1))
赋值 (.内容, 数组之常用词汇 [程序集之当前数组位置])
0.置文本 (相加 (“当前词汇表记录位置：”, 到文本 (程序集之当前数组位置)))
后面状态 ()

.子程序 _按钮之向下_被单击, 空白型, , 
.如果真 (等于 (词汇总数 (), 0))
    0.置文本 (“当前词汇表的没有任何记录，不能向下移动”)
    返回 ()
.如果真结束
.如果真 (等于 (程序集之当前数组位置, 词汇总数 ()))
    0.置文本 (“当前已移至词汇表的最底层记录，不能再继续向下移动”)
    返回 ()
.如果真结束
赋值 (程序集之当前数组位置, 相加 (程序集之当前数组位置, 1))
赋值 (.内容, 数组之常用词汇 [程序集之当前数组位置])
0.置文本 (相加 (“当前词汇表记录位置：”, 到文本 (程序集之当前数组位置)))
后面状态 ()


.子程序 _按钮之最上_被单击, 空白型, , 
.如果真 (等于 (词汇总数 (), 0))
    0.置文本 (“当前词汇表的没有任何记录，不能移至首记录”)
    返回 ()
.如果真结束
赋值 (程序集之当前数组位置, 1)
赋值 (.内容, 数组之常用词汇 [1])
0.置文本 (“已移至最顶层记录”)
后面状态 ()

.子程序 _按钮之最下_被单击, 空白型, , 
.如果真 (等于 (词汇总数 (), 0))
    0.置文本 (“当前词汇表的没有任何记录，不能移至尾记录”)
    返回 ()
.如果真结束
赋值 (程序集之当前数组位置, 词汇总数 ())
赋值 (.内容, 数组之常用词汇 [程序集之当前数组位置])
0.置文本 (“已移至最底层记录”)
后面状态 ()

.子程序 _窗口之加入常用词汇_将被销毁, 空白型, , 
重定义数组 (返回值, 假, 取数组成员数 (数组之常用词汇))
赋值 (返回值, 数组之常用词汇)
赋值 (是否已销毁, 真)


 ' 不属于任何一个程序集、类模块的函数：
