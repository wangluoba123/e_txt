 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “垫江县周嘉自来水厂开票系统_客户端”
    帮助文件名 = “”

窗口 窗口_用户开户
    左边 = 50
    顶边 = 50
    宽度 = 445
    高度 = 465
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “用户开户”
    帮助文件名 = “”

窗口 窗口_服务器
    左边 = 50
    顶边 = 50
    宽度 = 326
    高度 = 211
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “服务器信息设置”
    帮助文件名 = “”

窗口 窗口_用户登陆
    左边 = 50
    顶边 = 50
    宽度 = 322
    高度 = 179
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “用户登陆”
    帮助文件名 = “”

窗口 窗口_收款摘要
    左边 = 50
    顶边 = 50
    宽度 = 291
    高度 = 392
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “摘要信息”
    帮助文件名 = “”

窗口 窗口_收款查询
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 316
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “收款查询”
    帮助文件名 = “”

窗口 窗口_建档用户查询
    左边 = 50
    顶边 = 50
    宽度 = 454
    高度 = 324
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “建档用户查询”
    帮助文件名 = “”

窗口 窗口_打印材料出库表
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 163
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “打印用户材料出库表”
    帮助文件名 = “”

窗口 窗口_打印设置
    左边 = 50
    顶边 = 50
    宽度 = 550
    高度 = 389
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “打印设置”
    帮助文件名 = “”



.图片 高级表格, " ' 已保存到：D:\易语言学习\Data\客户.e\高级表格", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' Exmlrpc A36CFD538657479eBD7C0D287BBB3D95 2 0 远程服务支持库
 ' EDataStructure 0AFF5F28B2CB42ce906AA27D6E485457 2 0 数据结构支持库
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 2 1 高级表格支持库
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 2 0 多线程支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 3 0 扩展界面支持库三
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 2 0 扩展界面支持库二
 ' eDB 46E94341933A462383A4DE26B146322C 2 2 数据库操作支持库
 ' CnCalendar {18C0788E-59AE-4112-B452-6BF0C1B727FB} 2 0 农历日期支持库



 ' 所需要的模块
 ' 数值转大写 F:\小淞服务器测试\数值转大写.ec
 ' 快速导出超级列表框、高级表格的数据 E:\我开发的程序\小淞服务器测试\高级表格导出.ec


.全局变量 数据库连接, 未知类型0x20002, , , 
.全局变量 全局_结果文分组, 文本型, , "0", 
.全局变量 开户窗口状态, 文本型, , , 
.全局变量 全局_收款人员, 文本型, , , 
.全局变量 全局_登陆状态, 逻辑型, , , 
.全局变量 全局_服务器连接状态, 逻辑型, , , 
.全局变量 全局_当前列类型, 文本型, , , 
.全局变量 参数_编码前缀, 文本型, , , 
.全局变量 全局配置文件名, 文本型, , , 
.全局变量 全局_心跳包句柄, 整数型, , , 
.全局变量 全局_数据处理状态, 逻辑型, , , 

.DLL命令 SkinH_Attach, 空白型, "SkinH_EL.dll", "SkinH_Attach", , 

.DLL命令 SkinH_SetWindowAlpha, 空白型, "SkinH_EL.dll", "SkinH_SetWindowAlpha", , 
    .参数 窗口句柄, 整数型, , 
    .参数 透明度, 整数型, , 

.DLL命令 SkinH_AttachEx, 空白型, "SkinH_EL.dll", "SkinH_AttachEx", , 
    .参数 皮肤路径, 文本型, , 
    .参数 皮肤口令, 文本型, , 

.DLL命令 SkinH_AdjustHSV, 空白型, "SkinH_EL.dll", "SkinH_AdjustHSV", , 
    .参数 色调, 整数型, , 
    .参数 饱和度, 整数型, , 
    .参数 亮度, 整数型, , 

.DLL命令 SkinH_Detach, 空白型, "SkinH_EL.dll", "SkinH_Detach", , 

.DLL命令 SkinH_Map, 整数型, "SkinH_EL.dll", "SkinH_Map", , 
    .参数 句柄, 整数型, , 
    .参数 换肤类型, 整数型, , 

.DLL命令 SkinH_DetachEx, 空白型, "SkinH_EL.dll", "SkinH_DetachEx", , 
    .参数 句柄, 整数型, , 

.DLL命令 SkinH_SetMenuAlpha, 空白型, "SkinH_EL.dll", "SkinH_SetMenuAlpha", , 
    .参数 nAlpha, 整数型, , 

.DLL命令 SkinH_SetAero, 空白型, "SkinH_EL.dll", "SkinH_SetAero", , 
    .参数 hWnd, 整数型, , 

.DLL命令 SkinH_SetTitleMenuBar, 空白型, "SkinH_EL.dll", "SkinH_SetTitleMenuBar", , 
    .参数 hWnd, 整数型, , 窗口句柄
    .参数 bEnabled, 整数型, , 是否设置
    .参数 nHeight, 整数型, , 菜单栏高度
    .参数 nTopOffs, 整数型, , 上部偏移
    .参数 nRightOffs, 整数型, , 右部偏移

.DLL命令 SkinH_AdjustAero, 空白型, "SkinH_EL.dll", "SkinH_AdjustAero", , 
    .参数 透明度, 整数型, , 
    .参数 亮度, 整数型, , 
    .参数 锐度, 整数型, , 
    .参数 阴影大小, 整数型, , 
    .参数 水平偏移, 整数型, , 
    .参数 垂直偏移, 整数型, , 
    .参数 红色分量, 整数型, , 
    .参数 绿色分量, 整数型, , 
    .参数 蓝色分量, 整数型, , 

.DLL命令 gettext, 整数型, "", "GetWindowTextA", , 
    .参数 win, 整数型, , 
    .参数 wb, 文本型, , 
    .参数 cd, 整数型, , 

.DLL命令 查找窗口, 整数型, "", "FindWindowExA", , 
    .参数 hwnd1, 整数型, , 
    .参数 hwnd2, 整数型, , 
    .参数 lpsz1, 整数型, , 
    .参数 lpsz2, 整数型, , 

.DLL命令 getcd, 整数型, "", "GetWindowTextLengthA", , 
    .参数 jb, 整数型, , 

.窗口程序集 窗口程序集_主窗口, , , 

.程序集变量 本地数据, 未知类型0x30002, , , 
.程序集变量 局部_整数变量, 整数型, , , 
.子程序 预存打印打印线条和标题, 空白型, , 
.参数 数据文本, 文本型, , 

.局部变量 纵坐标, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 打印线条, 文本型, , , 
.局部变量 打印标题, 文本型, , , 
.局部变量 打印位置, 整数型, , , 
.局部变量 打印纸张宽度, 整数型, , , 
.局部变量 打印纸张高度, 整数型, , , 
.局部变量 配置变量, 文本型, , , 

置等待鼠标 ()
赋值 (配置变量, 读配置项 (相加 (取运行目录 (), “\pz.ini”), “打印设置”, “打印宽度”, ))
赋值 (打印纸张宽度, 到数值 (配置变量))
赋值 (配置变量, 读配置项 (相加 (取运行目录 (), “\pz.ini”), “打印设置”, “打印高度”, ))
赋值 (打印纸张高度, 到数值 (配置变量))
赋值 (配置变量, 读配置项 (相加 (取运行目录 (), “\pz.ini”), “打印设置”, “打印方向”, ))
.如果 (等于 (配置变量, “纵向”))
    .如果 (并且 (大于 (打印纸张宽度, 0), 大于 (打印纸张高度, 0)))
        假.开始打印 (假, -1, 0, 相乘 (打印纸张宽度, 10), 相乘 (打印纸张高度, 10))
         ' 信息框 (“打印方向:” ＋ “纵向” ＋ #换行符 ＋ “打印纸张宽度” ＋ 到文本 (打印纸张宽度) ＋ #换行符 ＋ “打印纸张高度” ＋ 到文本 (打印纸张高度), 0, )
    .否则
        假.开始打印 (假, , 0, , )
    .如果结束
    
.否则
    .如果 (并且 (大于 (打印纸张宽度, 0), 大于 (打印纸张高度, 0)))
        假.开始打印 (假, -1, 1, 相乘 (打印纸张宽度, 10), 相乘 (打印纸张高度, 10))
         ' 信息框 (“打印方向:” ＋ “纵向” ＋ #换行符 ＋ “打印纸张宽度” ＋ 到文本 (打印纸张宽度) ＋ #换行符 ＋ “打印纸张高度” ＋ 到文本 (打印纸张高度), 0, )
    .否则
        假.开始打印 (假, , 1, , )
    .如果结束
    
.如果结束
赋值 (打印线条, 读配置项 (相加 (取运行目录 (), “\pz.ini”), “打印设置”, “打印线条”, ))
.如果 (等于 (打印线条, “真”))
    赋值 (纵坐标, 200)
    赋值 (.画笔粗细, 5)
    200.画直线 (纵坐标, 1800, 纵坐标)
    赋值 (纵坐标, 相加 (纵坐标, 70))
    赋值 (.画笔粗细, 0)
    .计次循环首 (8, 计次)
        输出调试文本 (计次)
        .如果 (或者 (等于 (计次, 5), 等于 (计次, 4), 等于 (计次, 6)))
            
        .否则
            200.画直线 (纵坐标, 1800, 纵坐标)
        .如果结束
        赋值 (纵坐标, 相加 (纵坐标, 70))
    .计次循环尾 ()
    赋值 (.画笔粗细, 5)
    200.画直线 (纵坐标, 1800, 纵坐标)
    赋值 (纵坐标, 相加 (纵坐标, 70))
    200.画直线 (200, 200, 相减 (纵坐标, 70))
    1800.画直线 (200, 1800, 相减 (纵坐标, 70))
    赋值 (.画笔粗细, 0)
    400.画直线 (200, 400, 相减 (纵坐标, 560))
    750.画直线 (200, 750, 相减 (纵坐标, 560))
    950.画直线 (200, 950, 相减 (纵坐标, 560))
    1300.画直线 (200, 1300, 相减 (纵坐标, 560))
    1500.画直线 (200, 1500, 相减 (纵坐标, 140))
    500.画直线 (相减 (纵坐标, 210), 500, 相减 (纵坐标, 140))
    1620.画直线 (相减 (纵坐标, 210), 1620, 相减 (纵坐标, 140))
     ' 写标题收据号
    赋值 (.字体.字体大小, 14)
    赋值 (.字体.加粗, 真)
    赋值 (打印标题, 读配置项 (相加 (取运行目录 (), “\pz.ini”), “打印设置”, “打印标题”, ))
    赋值 (打印位置, 到数值 (读配置项 (相加 (取运行目录 (), “\pz.ini”), “打印设置”, “打印位置”, )))
    打印位置.置写出位置 (100)
    打印标题.写出 ()
    赋值 (.字体.字体大小, 7)
    赋值 (.字体.加粗, 假)
    赋值 (.字体.字体大小, 10)
    220.置写出位置 (220)
    “用户户号：”.写出 ()
    770.置写出位置 (220)
    “用户姓名：”.写出 ()
    1320.置写出位置 (220)
    “家庭人口：”.写出 ()
    220.置写出位置 (290)
    “缴费性质：”.写出 ()
    770.置写出位置 (290)
    “居住地址：”.写出 ()
    1320.置写出位置 (290)
    “工程类别：”.写出 ()
    220.置写出位置 (780)
    “收款人员：”.写出 ()
    1200.置写出位置 (780)
    “收款单位：垫江县周嘉自来水厂”.写出 ()
    220.置写出位置 (710)
    “收款金额(大写)：”.写出 ()
    1500.置写出位置 (710)
    “(小写)：”.写出 ()
.否则
    
.如果结束
打印预存数据 (数据文本)
结束打印 ()
恢复鼠标 ()

.子程序 打印预存数据, 空白型, , 
.参数 参数_文本, 文本型, , 

.局部变量 文本数组, 文本型, , "0", 
.局部变量 计次, 整数型, , , 
.局部变量 局部_纵坐标, 整数型, , , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_文本, 文本型, , , 

赋值 (文本数组, 分割文本 (参数_文本, “|”, ))
.计次循环首 (取数组成员数 (文本数组), 计次)
    输出调试文本 (文本数组 [计次])
.计次循环尾 ()
赋值 (.字体.字体大小, 10)
220.置写出位置 (160)
到文本 (到时间 (文本数组 [11])).写出 ()
赋值 (.字体.字体大小, 12)
1550.置写出位置 (162)
子文本替换 (文本数组 [1], “1”, “№”, 1, 1, 假).写出 ()
赋值 (.字体.字体大小, 10)
420.置写出位置 (220)
文本数组.写出 ( [2]) ' 户号
970.置写出位置 (220)
文本数组.写出 ( [6]) ' 姓名
1550.置写出位置 (220)
相加 (文本数组 [4], “人”).写出 () ' 人口
420.置写出位置 (290)
文本数组.写出 ( [3]) ' 开户性质
970.置写出位置 (290)
文本数组.写出 ( [7]) ' 居住街道
1520.置写出位置 (290)
文本数组.写出 ( [5]) ' 工程类别
620.置写出位置 (360)
“收        款        摘        要”.写出 ()
1580.置写出位置 (360)
“备    注”.写出 ()
1640.置写出位置 (710)
相加 (“￥”, 数值到格式文本 (到数值 (文本数组 [8]), 2, 假)).写出 () ' 金额
420.置写出位置 (430)
赋值 (.字体.字体大小, 12)
文本数组.写出 ( [9])
赋值 (.字体.字体大小, 10)
 ' 写备注信息
子程序_自动换行 (1510, 430, 文本数组 [10], 16, 50, 12, 真)
 ' 写收费人
420.置写出位置 (780)
文本数组.写出 ( [12])
 ' 写金额大写
530.置写出位置 (710)
数值转大写 (文本数组 [8], 真, 真).写出 ()

.子程序 _开户添加_被选择, 空白型, , 
.如果 (等于 (全局_登陆状态, 假))
    信息框 (“请用户先登陆！”, 64, )
    载入 (窗口_用户登陆, , 真)
.否则
    赋值 (开户窗口状态, “开户添加”)
    载入 (窗口_用户开户, , 真)
.如果结束


.子程序 _过户添加_被选择, 空白型, , 
.如果 (等于 (全局_登陆状态, 假))
    信息框 (“请用户先登陆！”, 64, )
    载入 (窗口_用户登陆, , 真)
.否则
    赋值 (开户窗口状态, “过户修改”)
    载入 (窗口_用户开户, , 真)
.如果结束


.子程序 _服务端设置_被选择, 空白型, , 
载入 (窗口_服务器, , 真)

.子程序 _用户登陆_被选择, 空白型, , 
.如果 (等于 (全局_登陆状态, 假))
    载入 (窗口_用户登陆, , 真)
.否则
    信息框 (“已成功登陆！”, 64, )
.如果结束


.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 皮肤位置, 文本型, , , 

赋值 (_启动窗口., 假)
赋值 (皮肤位置, 相加 (取运行目录 (), “\Skin\qq2009.she”))
SkinH_AttachEx (皮肤位置, “”)
发送信息 (274, 61488, 0)
赋值 (.左边, 0)
赋值 (.顶边, 0)
赋值 (.宽度, _启动窗口.)
赋值 (.高度, _启动窗口.)
赋值 (., _启动窗口.)
赋值 (., 相减 (_启动窗口., 63))
赋值 (., 0)
赋值 (., 0)
赋值 (., 0)
赋值 (., 3)
赋值 (., 2)
赋值 (., 相减 (., 10))
赋值 (., 相减 (., 2))
赋值 (_启动窗口., 真)

.子程序 子程序_发送心跳包, 空白型, , 
.局部变量 请求信息, 文本型, , , 
.局部变量 周步信息, 整数型, , , 
.局部变量 结果, 文本型, , , 
.局部变量 循环, 逻辑型, , , 
.局部变量 计次, 整数型, 静态, , 

.判断循环首 (等于 (循环, 假))
    .如果 (等于 (全局_数据处理状态, 假)) ' 程序在没有执行其他事件时处理，以免发生出错
        输出调试文本 (相加 (“我在心跳”, 到文本 (计次)))
        赋值 (请求信息, “心跳包|查询|”)
        赋值 (周步信息, 数据库连接.未知支持库函数_17 (请求信息, 结果, 10000)) ' 10秒发送一次
        .如果 (等于 (周步信息, -1))
            赋值 (全局_登陆状态, 假)
            赋值 (循环, 真)
            信息框 (“服务器连接失败！”, 64, )
            赋值 (全局_服务器连接状态, 假)
            返回 ()
        .否则
            
        .如果结束
        .如果 (不等于 (结果, “在线”))
            赋值 (全局_登陆状态, 假)
            赋值 (循环, 真)
            赋值 (全局_服务器连接状态, 假)
            信息框 (“已退出服务器,请重新登陆。”, 64, )
        .否则
            
        .如果结束
        赋值 (计次, 相加 (计次, 1))
        
    .否则
        
    .如果结束
    延时 (2000)
.判断循环尾 ()

.子程序 _摘要设置_被选择, 空白型, , 
.如果 (等于 (全局_登陆状态, 假))
    信息框 (“请用户先登陆！”, 64, )
    载入 (窗口_用户登陆, , 真)
.否则
    载入 (窗口_收款摘要, , 真)
.如果结束


.子程序 读信息, 空白型, 公开, 
.参数 请求信息, 文本型, , 
.参数 列表框, 组合框, , 
.参数 当前类别, 文本型, 可空, 

.局部变量 局部_计次, 整数型, , , 
.局部变量 结果, 文本型, , , 
.局部变量 周步信息, 整数型, , , 
.局部变量 结果数组, 文本型, , "0", 
.局部变量 现行选中, 整数型, , , 

赋值 (周步信息, 数据库连接.未知支持库函数_17 (请求信息, 结果, 5000))
.如果 (等于 (周步信息, -1))
    信息框 (“服务器连接失败！”, 64, )
    赋值 (全局_服务器连接状态, 假)
    返回 ()
.否则
    
.如果结束
赋值 (结果数组, 分割文本 (结果, “|”, ))
.计次循环首 (取数组成员数 (结果数组), 局部_计次)
    列表框.加入项目 (结果数组 [局部_计次], )
    .如果 (不等于 (当前类别, “”))
        .如果 (等于 (当前类别, 结果数组 [局部_计次]))
            赋值 (现行选中, 相减 (局部_计次, 1))
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    
.计次循环尾 ()
赋值 (列表框.现行选中项, 现行选中)

.子程序 _收款明细_被选择, 空白型, , 
.如果 (等于 (全局_登陆状态, 假))
    信息框 (“请用户先登陆！”, 64, )
    载入 (窗口_用户登陆, , 真)
.否则
    载入 (窗口_收款查询, , 真)
.如果结束


.子程序 子程序_高级表格显示数据, 空白型, , 
.参数 参数_结果, 文本型, , 
.参数 参数_标题数组, 文本型, 数组, 
.参数 参数_标题宽度, 整数型, 数组, 
.参数 参数_高级表格, 未知类型0x40001, , 

.局部变量 结果文分组, 文本型, , "0", 
.局部变量 字段数组, 文本型, , "0", 
.局部变量 局部_计次1, 整数型, , , 
.局部变量 局部_线程数值, 整数型, , , 
.局部变量 局部_计次, 整数型, , , 

置等待鼠标 ()
赋值 (., 1)
清除数组 (全局_结果文分组)
赋值 (全局_结果文分组, 分割文本 (参数_结果, “|”, ))
参数_高级表格.未知支持库函数_57 ()
赋值 (参数_高级表格., 1)
赋值 (参数_高级表格., 取数组成员数 (参数_标题数组))
 ' 置标题
.计次循环首 (取数组成员数 (参数_标题数组), 局部_计次)
    参数_高级表格.未知支持库函数_9 (0, 相减 (局部_计次, 1), 1, 参数_标题数组 [局部_计次])
.计次循环尾 ()
 ' 置列宽
.计次循环首 (取数组成员数 (参数_标题宽度), 局部_计次)
    参数_高级表格.未知支持库函数_32 (相减 (局部_计次, 1), 参数_标题宽度 [局部_计次])
.计次循环尾 ()
赋值 (参数_高级表格., 相加 (取数组成员数 (全局_结果文分组), 1))
 ' 多线程技术
赋值 (局部_整数变量, 0)
 ' 信息框 (到文本 (取数组成员数 (全局_结果文分组)), 0, )
赋值 (局部_线程数值, 取整 (相除 (取数组成员数 (全局_结果文分组), 10)))
输出调试文本 (局部_线程数值)
.如果 (大于 (局部_线程数值, 0)) ' 记录数>=10才开启10个线程
    .计次循环首 (10, ) ' 先加10个线程
        未知支持库函数_0 (&子程序_显示表格数据, 局部_线程数值, )
        延时 (10)
    .计次循环尾 ()
.否则
    
.如果结束
 ' 如果把所有数组成员除10结余值，再加一个线程
.如果 (大于 (求余数 (取数组成员数 (全局_结果文分组), 10), 0))
    赋值 (局部_线程数值, 求余数 (取数组成员数 (全局_结果文分组), 10))
    未知支持库函数_0 (&子程序_显示表格数据, 局部_线程数值, )
    延时 (10)
    输出调试文本 (局部_线程数值)
.否则
    
.如果结束
恢复鼠标 ()

.子程序 子程序_显示表格数据, 空白型, , 
.参数 参数_循环变量, 整数型, , 

.局部变量 字段数组, 文本型, , "0", 
.局部变量 局部_计次1, 整数型, , , 
.局部变量 局部_变量计次, 整数型, , , 

赋值 (局部_整数变量, 相加 (局部_整数变量, 参数_循环变量))
赋值 (局部_变量计次, 局部_整数变量)
.计次循环首 (参数_循环变量, )
    清除数组 (字段数组)
    赋值 (字段数组, 分割文本 (全局_结果文分组 [局部_变量计次], “,”, ))
    .计次循环首 (取数组成员数 (字段数组), 局部_计次1)
        局部_变量计次.未知支持库函数_9 (相减 (局部_计次1, 1), 1, 字段数组 [局部_计次1])
    .计次循环尾 ()
     ' 延时 (500)
    赋值 (局部_变量计次, 相减 (局部_变量计次, 1))
.计次循环尾 ()

.子程序 _高级表格_列宽被改变, 空白型, , 
.参数 列号, 整数型, , 

.局部变量 局部_计次, 整数型, , , 

.计次循环首 (., 局部_计次)
    写配置项 (相加 (取运行目录 (), “\pz.ini”), 全局_当前列类型, 到文本 (相减 (局部_计次, 1)), 到文本 (相减 (局部_计次, 1).未知支持库函数_44 ()))
     ' 输出调试文本 (高级表格.取列宽 (局部_计次 － 1))
.计次循环尾 ()

.子程序 _建档用户查询_被选择, 空白型, , 
.如果 (等于 (全局_登陆状态, 假))
    信息框 (“请用户先登陆！”, 64, )
    载入 (窗口_用户登陆, , 真)
.否则
    载入 (窗口_建档用户查询, , 真)
.如果结束


.子程序 子程序_打印材料出库表, 空白型, , 
.参数 参数_用户资料, 文本型, , 

.局部变量 纵坐标, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 横坐标, 整数型, , , 
.局部变量 局部_种类文本, 文本型, , , 
.局部变量 种类数组, 文本型, , "0", 
.局部变量 型号数组, 文本型, , "0", 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_计次1, 整数型, , , 
.局部变量 局部_横坐标, 整数型, , , 
.局部变量 局部_纵坐标, 整数型, , , 
.局部变量 局部_用户资料数组, 文本型, , "0", 
.局部变量 局部_临时文本, 文本型, , , 

假.开始打印 (假, , , , )
 ' 打印机1.画笔颜色 ＝ #天蓝
 ' 打印机1.文本颜色 ＝ #蓝色
赋值 (.画笔粗细, 10)
赋值 (纵坐标, 200)
100.画直线 (纵坐标, 1350, 纵坐标)
赋值 (.画笔粗细, 5)
60.画直线 (300, 1380, 300)
赋值 (纵坐标, 400)
赋值 (.画笔粗细, 2)
.计次循环首 (3, )
    60.画直线 (纵坐标, 1380, 纵坐标)
    赋值 (纵坐标, 相加 (纵坐标, 90))
.计次循环尾 ()
.计次循环首 (7, )
    280.画直线 (纵坐标, 1380, 纵坐标)
    赋值 (纵坐标, 相加 (纵坐标, 90))
.计次循环尾 ()
60.画直线 (纵坐标, 1380, 纵坐标)
赋值 (纵坐标, 相加 (纵坐标, 90))
.计次循环首 (4, )
    280.画直线 (纵坐标, 1380, 纵坐标)
    赋值 (纵坐标, 相加 (纵坐标, 90))
.计次循环尾 ()
.计次循环首 (2, )
    60.画直线 (纵坐标, 1380, 纵坐标)
    赋值 (纵坐标, 相加 (纵坐标, 90))
.计次循环尾 ()
赋值 (.画笔粗细, 5)
60.画直线 (纵坐标, 1380, 纵坐标)
60.画直线 (300, 60, 纵坐标)
1380.画直线 (300, 1380, 纵坐标)
 ' 画竖线
赋值 (.画笔粗细, 2)
280.画直线 (300, 280, 490)
500.画直线 (300, 500, 490)
720.画直线 (300, 720, 490)
940.画直线 (300, 940, 490)
1170.画直线 (300, 1170, 490)
 ' 用户材料出库表
280.画直线 (580, 280, 相减 (1930, 90))
500.画直线 (580, 500, 相减 (2020, 90))
720.画直线 (580, 720, 相减 (1930, 90))
940.画直线 (580, 940, 相减 (1930, 90))
1170.画直线 (580, 1170, 相减 (1930, 90))
 ' 写数据
赋值 (.字体.字体大小, 14)
赋值 (.字体.加粗, 真)
180.置写出位置 (140)
“垫江县周嘉镇2010年农村饮水安全工程受益用户卡”.写出 ()
赋值 (.字体.字体大小, 7)
赋值 (.字体.加粗, 假)
赋值 (.字体.字体大小, 12)
90.置写出位置 (330)
“用户姓名：”.写出 ()
520.置写出位置 (330)
“家庭人口：”.写出 ()
960.置写出位置 (330)
“用户户号：”.写出 ()
90.置写出位置 (420)
“水表编号：”.写出 ()
520.置写出位置 (420)
“建档日期：”.写出 ()
940.置写出位置 (420)
“工程负责人：”.写出 ()
赋值 (.字体.加粗, 真)
320.置写出位置 (515)
“用  户  材  料  出  库  表   监督电话：74542806”.写出 ()
110.置写出位置 (相减 (900, 45))
“用  户”.写出 ()
110.置写出位置 (相减 (990, 45))
“自  筹”.写出 ()
110.置写出位置 (相减 (1080, 45))
“材  料”.写出 ()
110.置写出位置 (相减 (1500, 90))
“国  家”.写出 ()
110.置写出位置 (相减 (1590, 90))
“补  助”.写出 ()
110.置写出位置 (相减 (1680, 90))
“材  料”.写出 ()
赋值 (.字体.加粗, 假)
90.置写出位置 (相减 (1870, 90))
“安装人员：”.写出 ()
520.置写出位置 (相减 (1870, 90))
“用户签字：”.写出 ()
960.置写出位置 (相减 (1870, 90))
“村社盖章：”.写出 ()
90.置写出位置 (相减 (1960, 90))
“用户意见及联系电话：”.写出 ()
 ' 写材料种类
 ' 打印机1.字体.加粗 ＝ 真
赋值 (局部_种类文本, “类  别|规  格|名  称|单  位|数  量,铁  类|Φ15|水  表|  块|  1,铁  类|Φ15|铜表前阀|  个|  1,铁  类|Φ15|铜闸阀|  个|  1,P P R|Φ20|外丝直接|  个|  2,P P R|Φ20|内丝直接|  个|  1,P V C|Φ15|龙  头|  个|  1,P V C|  |生胶带|  个|  1,P P R|Φ20|水  管|  米|,P P R|Φ20|直  接|  个|,P P R|Φ20|弯  头|  个|,P P R||三  通|  个|,P P R||||”)
赋值 (种类数组, 分割文本 (局部_种类文本, “,”, ))
赋值 (局部_纵坐标, 610)
.计次循环首 (取数组成员数 (种类数组), 局部_计次)
    赋值 (型号数组, 分割文本 (种类数组 [局部_计次], “|”, ))
    赋值 (局部_横坐标, 330)
    .计次循环首 (取数组成员数 (型号数组), 局部_计次1)
        局部_横坐标.置写出位置 (局部_纵坐标)
        型号数组.写出 ( [局部_计次1])
        赋值 (局部_横坐标, 相加 (局部_横坐标, 220))
    .计次循环尾 ()
    赋值 (局部_纵坐标, 相加 (局部_纵坐标, 90))
.计次循环尾 ()
赋值 (局部_用户资料数组, 分割文本 (参数_用户资料, “|”, ))
90.置写出位置 (230)
相加 (“居住地址：”, 局部_用户资料数组 [1], “ ”, 局部_用户资料数组 [2]).写出 ()
700.置写出位置 (230)
“安装日期：    年    月    日”.写出 ()
310.置写出位置 (330)
局部_用户资料数组.写出 ( [3])
780.置写出位置 (330)
局部_用户资料数组.写出 ( [4])
1180.置写出位置 (330)
局部_用户资料数组.写出 ( [5])
310.置写出位置 (420)
局部_用户资料数组.写出 ( [6])
730.置写出位置 (420)
赋值 (局部_临时文本, 未知支持库函数_12 (到时间 (局部_用户资料数组 [7]), “%y-%m-%d”))
局部_临时文本.写出 ()
1200.置写出位置 (420)
.如果 (或者 (等于 (局部_用户资料数组 [1], “雨山村”), 等于 (局部_用户资料数组 [1], “均田村”), 等于 (局部_用户资料数组 [1], “檀树村”), 等于 (局部_用户资料数组 [1], “勤劳村”), 等于 (局部_用户资料数组 [1], “群益村”), 等于 (局部_用户资料数组 [1], “骑龙村”), 等于 (局部_用户资料数组 [1], “响水村”), 等于 (局部_用户资料数组 [1], “飞龙村”)))
    “吴  政”.写出 ()
.否则
    “李能勇”.写出 ()
.如果结束
 ' 开始打印用户资料
结束打印 ()

.子程序 _打印材料卡_被选择, 空白型, , 
.如果 (等于 (全局_登陆状态, 假))
    信息框 (“请用户先登陆！”, 64, )
    载入 (窗口_用户登陆, , 真)
.否则
    载入 (窗口_打印材料出库表, , 真)
    
.如果结束


.子程序 __启动窗口_可否被关闭, 逻辑型, , 
.如果 (等于 (信息框 (“程序即将退出，确定关闭吗？”, 36, ), 5))
    未知支持库函数_6 (全局_心跳包句柄)
    结束 ()
.否则
    返回 (假)
.如果结束


.子程序 _打印报表_被选择, 空白型, , 
.局部变量 局部_标题, 文本型, , , 

载入 (窗口_打印设置, , 真)

.子程序 _打印用户收据_被选择, 空白型, , 
.局部变量 局部_收据号, 文本型, , , 
.局部变量 请求信息, 文本型, , , 
.局部变量 周步信息, 整数型, , , 
.局部变量 结果, 文本型, , , 
.局部变量 结果数组, 文本型, , "0", 
.局部变量 临时1, 文本型, , , 
.局部变量 临时2, 文本型, , , 
.局部变量 局部_计次, 整数型, , , 

输入框 (“请输入发票编号:”, , “№”, 局部_收据号, )
.如果 (等于 (局部_收据号, “”))
    信息框 (“发票编号不能为空!”, 64, )
    返回 ()
.否则
    
.如果结束
置等待鼠标 ()
赋值 (请求信息, 相加 (“开户发票重打|”, 局部_收据号, “|”))
赋值 (周步信息, 数据库连接.未知支持库函数_17 (请求信息, 结果, 50000))
恢复鼠标 ()
.如果 (等于 (周步信息, -1))
    信息框 (“服务器连接失败！”, 64, )
    赋值 (全局_服务器连接状态, 假)
    返回 ()
.否则
    
.如果结束
赋值 (结果数组, 分割文本 (结果, “|”, ))
.如果 (大于 (取数组成员数 (结果数组), 1))
    .如果 (等于 (结果数组 [5], “规划内-管网延伸”))
        .计次循环首 (取数组成员数 (结果数组), 局部_计次)
            .判断开始 (等于 (局部_计次, 9))
                赋值 (临时1, 相加 (临时1, “自筹资金”, “|”))
            .默认
                赋值 (临时1, 相加 (临时1, 结果数组 [局部_计次], “|”))
            .判断结束
            
        .计次循环尾 ()
        预存打印打印线条和标题 (临时1)
    .否则
        预存打印打印线条和标题 (结果)
    .如果结束
    
.否则
    信息框 (结果数组 [1], 64, )
.如果结束


.子程序 _退出_被选择, 空白型, , 
.如果 (等于 (信息框 (“程序即将退出，确定关闭吗？”, 36, ), 5))
    结束 ()
.否则
    
.如果结束


.子程序 _用户修改_被选择, 空白型, , 
.如果 (等于 (全局_登陆状态, 假))
    信息框 (“请用户先登陆！”, 64, )
    载入 (窗口_用户登陆, , 真)
.否则
    赋值 (开户窗口状态, “用户修改”)
    载入 (窗口_用户开户, , 真)
.如果结束



.子程序 _收据号删除_被选择, 空白型, , 
.局部变量 局部_收据号, 文本型, , , 
.局部变量 周步信息, 整数型, , , 
.局部变量 请求信息, 文本型, , , 
.局部变量 结果, 文本型, , , 

.如果 (等于 (全局_登陆状态, 假))
    信息框 (“请用户先登陆！”, 64, )
    载入 (窗口_用户登陆, , 真)
.否则
    输入框 (“请输入发票编号:”, , “№”, 局部_收据号, )
    .如果 (等于 (局部_收据号, “”))
        信息框 (“您没有输入发票编号！”, 64, )
        返回 ()
    .否则
        .如果 (等于 (信息框 (相加 (“是否删除收据号：”, 局部_收据号, “？”, #换行符, “错误删除户号将会引起系统出错，请慎重!”), 33, “警告”), 0))
            赋值 (请求信息, 相加 (“删除|收据号|Delete * from 用户_开户 where 收据号=”, 子文本替换 (局部_收据号, “№”, “1”, 1, 1, 真), “|”, 局部_收据号))
            赋值 (周步信息, 数据库连接.未知支持库函数_17 (请求信息, 结果, 50000))
            信息框 (结果, 64, )
        .否则
            
        .如果结束
        
        
    .如果结束
    
.如果结束


.子程序 _用户删除_被选择, 空白型, , 
.局部变量 局部_户号, 文本型, , , 
.局部变量 周步信息, 整数型, , , 
.局部变量 请求信息, 文本型, , , 
.局部变量 结果, 文本型, , , 

.如果 (等于 (全局_登陆状态, 假))
    信息框 (“请用户先登陆！”, 64, )
    载入 (窗口_用户登陆, , 真)
.否则
    输入框 (“请输入户号:”, , “2009”, 局部_户号, )
    .如果 (或者 (等于 (局部_户号, “”), 等于 (局部_户号, “2009”)))
        信息框 (“您没有输入户号！”, 64, )
        返回 ()
    .否则
        .如果 (等于 (信息框 (相加 (“是否删除户号：”, 局部_户号, “？”, #换行符, “错误删除户号将会引起系统出错，请慎重!”), 33, “警告”), 0))
            赋值 (请求信息, 相加 (“删除|用户|Delete * from 用户表 where 户号='”, 局部_户号, “'”, “|”, 局部_户号))
            赋值 (周步信息, 数据库连接.未知支持库函数_17 (请求信息, 结果, 50000))
            信息框 (结果, 64, )
        .否则
            
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 _收据号修改_被选择, 空白型, , 
.如果 (等于 (全局_登陆状态, 假))
    信息框 (“请用户先登陆！”, 64, )
    载入 (窗口_用户登陆, , 真)
.否则
    赋值 (开户窗口状态, “收据号修改”)
    载入 (窗口_用户开户, , 真)
.如果结束



.子程序 文本折行, 文本型, 公开, 把一段长文本按你指定的字数分行
.参数 要处理的文本, 文本型, , 
.参数 每行字数, 整数型, 可空, 半角字数，如果为空，将不进行分行操作，直接返回文本内容。
.参数 是否强行分行, 逻辑型, 可空, 为真则强行按设定长度分行。为假则保留连续半角数字或字母为一行。默认为假。
.参数 是否全角, 逻辑型, 可空, 是否将半角转换为全角,如果为空即不转换
.参数 首空字节数, 整数型, 可空, 在每行前面加入空格,如果为空,为0,即不加空格

.局部变量 操作文本, 文本型, , , 
.局部变量 开始位置, 整数型, , , 
.局部变量 读取长度, 整数型, , , 
.局部变量 开始计算半角, 逻辑型, , , 
.局部变量 半角位置, 整数型, , , 
.局部变量 结果文本, 文本型, , , 


.如果真 (是否为空 (每行字数))
    返回 (要处理的文本)
.如果真结束
.如果真 (是否为空 (是否强行分行))
    赋值 (是否强行分行, 假)
.如果真结束

.如果真 (等于 (是否全角, 真))
    赋值 (要处理的文本, 子文本替换 (要处理的文本, “...”, “…”, 1, , 真))
    赋值 (要处理的文本, 子文本替换 (要处理的文本, “->”, “→”, 1, , 真))
    赋值 (要处理的文本, 子文本替换 (要处理的文本, “<-”, “←”, 1, , 真))
    赋值 (要处理的文本, 子文本替换 (要处理的文本, “--”, “―”, 1, , 真))
    赋值 (要处理的文本, 到全角 (要处理的文本))
.如果真结束

.如果真 (大于或等于 (首空字节数, 1))
    赋值 (要处理的文本, 相加 (取空白文本 (首空字节数), 要处理的文本))
    赋值 (要处理的文本, 子文本替换 (要处理的文本, #换行符, 相加 (#换行符, 取空白文本 (首空字节数)), 1, , 真))
.如果真结束

赋值 (操作文本, 要处理的文本)
.判断循环首 (大于 (取文本长度 (操作文本), 每行字数))
    .判断循环首 (小于 (读取长度, 每行字数))
        .如果 (或者 (大于或等于 (取代码 (操作文本, 相加 (读取长度, 1)), 127), 小于 (取代码 (操作文本, 相加 (读取长度, 1)), 0)))
            赋值 (半角位置, 0)
            赋值 (开始计算半角, 假)
            .如果真 (等于 (读取长度, 相减 (每行字数, 1)))
                跳出循环 ()
            .如果真结束
            赋值 (读取长度, 相加 (读取长度, 2))
        .否则
            .判断开始 (等于 (取文本中间 (操作文本, 相加 (读取长度, 1), 1), “ ”))
                赋值 (读取长度, 相加 (读取长度, 1))
                赋值 (半角位置, 0)
                赋值 (开始计算半角, 假)
            .判断 (等于 (取文本中间 (操作文本, 相加 (读取长度, 1), 2), #换行符))
                赋值 (读取长度, 相加 (读取长度, 2))
                跳出循环 ()
            .默认
                .如果真 (等于 (开始计算半角, 假))
                    赋值 (半角位置, 读取长度)
                    赋值 (开始计算半角, 真)
                .如果真结束
                赋值 (读取长度, 相加 (读取长度, 1))
            .判断结束
            
        .如果结束
        
    .判断循环尾 ()
    .如果真 (大于或等于 (读取长度, 每行字数))
        .如果 (等于 (是否强行分行, 假))
            赋值 (读取长度, 选择 (等于 (半角位置, 0), 每行字数, 选择 (或者 (大于或等于 (取代码 (操作文本, 相加 (每行字数, 1)), 127), 小于 (取代码 (操作文本, 相加 (每行字数, 1)), 0)), 每行字数, 半角位置)))
            赋值 (开始计算半角, 假)
            赋值 (半角位置, 0)
        .否则
            赋值 (读取长度, 每行字数)
        .如果结束
        
    .如果真结束
    .如果真 (等于 (是否强行分行, 假))
        .如果 (或者 (等于 (取文本中间 (操作文本, 相减 (读取长度, 1), 2), “《”), 等于 (取文本中间 (操作文本, 相减 (读取长度, 1), 2), “（”), 等于 (取文本中间 (操作文本, 相减 (读取长度, 1), 2), #左引号), 等于 (取文本中间 (操作文本, 相减 (读取长度, 1), 2), “〈”), 等于 (取文本中间 (操作文本, 相减 (读取长度, 11), 2), “‘”)))
            赋值 (读取长度, 相减 (读取长度, 2))
        .否则
            .如果真 (或者 (等于 (取文本中间 (操作文本, 相加 (读取长度, 1), 2), “》”), 等于 (取文本中间 (操作文本, 相加 (读取长度, 1), 2), “）”), 等于 (取文本中间 (操作文本, 相加 (读取长度, 1), 2), #右引号), 等于 (取文本中间 (操作文本, 相加 (读取长度, 1), 2), “〉”), 等于 (取文本中间 (操作文本, 相加 (读取长度, 1), 2), “，”), 等于 (取文本中间 (操作文本, 相加 (读取长度, 1), 2), “。”), 等于 (取文本中间 (操作文本, 相加 (读取长度, 1), 2), “？”), 等于 (取文本中间 (操作文本, 相加 (读取长度, 1), 2), “：”), 等于 (取文本中间 (操作文本, 相加 (读取长度, 1), 2), “’”), 等于 (取文本中间 (操作文本, 相加 (读取长度, 1), 2), “；”), 等于 (取文本中间 (操作文本, 相加 (读取长度, 1), 2), “、”)))
                .如果 (或者 (大于或等于 (取代码 (操作文本, 读取长度), 127), 小于 (取代码 (操作文本, 读取长度), 0)))
                    赋值 (读取长度, 相减 (读取长度, 2))
                .否则
                    赋值 (读取长度, 相减 (读取长度, 1))
                .如果结束
                
            .如果真结束
            
        .如果结束
        
    .如果真结束
    .如果 (等于 (取文本中间 (操作文本, 相减 (读取长度, 1), 2), #换行符))
        赋值 (结果文本, 相加 (结果文本, 取文本左边 (操作文本, 读取长度)))
    .否则
        赋值 (结果文本, 相加 (结果文本, 取文本左边 (操作文本, 读取长度), #换行符))
    .如果结束
    赋值 (操作文本, 取文本右边 (操作文本, 相减 (取文本长度 (操作文本), 读取长度)))
    赋值 (读取长度, 0)
.判断循环尾 ()
赋值 (结果文本, 相加 (结果文本, 操作文本))
返回 (结果文本)

.子程序 子程序_自动换行, 空白型, , 
.参数 参数_左边距, 整数型, , 
.参数 参数_上边距, 整数型, , 
.参数 参数_标题, 文本型, , 
.参数 参数_换行字数, 整数型, , 
.参数 参数_行高, 整数型, , 
.参数 参数_字号大小, 整数型, , 
.参数 参数_加粗, 逻辑型, , 

.局部变量 局部_纵坐标, 整数型, , , 
.局部变量 局部_文本数组, 文本型, , "0", 
.局部变量 局部_计次, 整数型, , , 

赋值 (.字体.字体大小, 参数_字号大小)
.如果 (等于 (参数_加粗, 真))
    赋值 (.字体.加粗, 真)
.否则
    赋值 (.字体.加粗, 假)
.如果结束
赋值 (局部_文本数组, 分割文本 (文本折行 (参数_标题, 参数_换行字数), #换行符, ))
.计次循环首 (取数组成员数 (局部_文本数组), 局部_计次)
    参数_左边距.置写出位置 (相加 (局部_纵坐标, 参数_上边距))
    局部_文本数组.写出 ( [局部_计次])
    赋值 (局部_纵坐标, 相乘 (局部_计次, 参数_行高))
.计次循环尾 ()

.窗口程序集 窗口程序集_用户添加, , , 

.程序集变量 程序集_收据号, 整数型, , , 
.程序集变量 程序集_户号, 文本型, , , 
.程序集变量 程_收据号, 整数型, , , 
.子程序 _添加标题_被单击, 空白型, , 
.局部变量 查询文本, 文本型, , , 
.局部变量 性质变量, 整数型, , , 
.局部变量 服务器返回文本, 文本型, , , 
.局部变量 请求信息, 文本型, , , 
.局部变量 周步信息, 整数型, , , 
.局部变量 结果, 文本型, , , 
.局部变量 结果数组, 文本型, , "0", 
.局部变量 数据文本, 文本型, , , 
.局部变量 局部_缴费性质, 文本型, , , 

.如果 (等于 (.内容, “”))
    信息框 (“用户名称不能为空！”, 64, )
    获取焦点 ()
    返回 ()
.否则
    
.如果结束
置等待鼠标 ()
赋值 (全局_数据处理状态, 真)
.如果 (等于 (.现行选中项, 0))
    赋值 (性质变量, 0)
.否则
    赋值 (性质变量, 1)
.如果结束
.如果 (等于 (窗口_用户开户., “开户添加”))
     ' 增加到用户表
     ' 判断为零提示
    .如果 (并且 (等于 (到数值 (.内容), 0), 不等于 (.现行选中项, 0)))
        .如果 (不等于 (信息框 (“收款金额为零确定继续吗？”, 33, “警告”), 0))
            返回 ()
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    
    赋值 (查询文本, 相加 (“insert into 用户表(户号,用户名,水价类别,水表编号,居住街道,建档时间,联系电话,目前状态,备注,详细地址,身份证号,性质,父号,抄表人员,起方) values ('”, “|”, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天)), “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “',”, 到文本 (性质变量), “,'0','”, .内容, “',”, 到文本 (到数值 (.内容)), “ )”))
     ' 增加到开户金额表
    赋值 (局部_缴费性质, “开户”)
    .如果 (等于 (.现行选中项, 0)) ' 规划内管网延伸
        赋值 (查询文本, 相加 (查询文本, “|”, “insert into 用户_开户(户号,家庭人口,缴费性质,工程类别,收款金额,收款日期,收款人员,收据号,收款摘要) values ('”, “|”, “',”, .内容, “,'”, 局部_缴费性质, “','”, .内容, “',380,'”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天)), “','”, .内容, “',”, “替换收据号”, “,'自筹资金' )”))
    .否则
        赋值 (查询文本, 相加 (查询文本, “|”, “insert into 用户_开户(户号,家庭人口,缴费性质,工程类别,收款金额,收款日期,收款人员,收据号,收款摘要) values ('”, “|”, “',”, .内容, “,'”, 局部_缴费性质, “','”, .内容, “',”, 到文本 (到数值 (.内容)), “,'”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天)), “','”, .内容, “',”, “替换收据号”, “,'”, .内容, “' )”))
    .如果结束
    赋值 (请求信息, 相加 (“用户开户|”, 查询文本))
.否则
    .如果 (并且 (等于 (到数值 (.内容), 0), 等于 (窗口_用户开户., “过户添加”))) ' 判断为零提示
        .如果 (不等于 (信息框 (“收款金额为零确定继续吗？”, 33, “警告”), 0))
            返回 ()
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    .如果 (等于 (窗口_用户开户., “过户添加”)) ' 开户修改
        赋值 (查询文本, 相加 (“update 用户表 set  用户名='”, .内容, “',水价类别='”, .内容, “',水表编号='”, .内容, “',居住街道='”, .内容, “',建档时间='”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天)), “',联系电话='”, .内容, “',目前状态='”, .内容, “',备注='”, .内容, “',身份证号='”, .内容, “',详细地址='”, .内容, “',性质=”, 到文本 (性质变量), “,抄表人员='”, .内容, “',起方=”, .内容, “  where 户号='”, 程序集_户号, “'”)) ' 按户号修
         ' 增加到过户金额表
        赋值 (局部_缴费性质, “过户”)
        赋值 (查询文本, 相加 (查询文本, “|”, “insert into 用户_开户(户号,家庭人口,缴费性质,工程类别,收款金额,收款日期,收款人员,收据号,收款摘要) values ('”, 程序集_户号, “',”, .内容, “,'”, 局部_缴费性质, “','”, .内容, “',”, 到文本 (到数值 (.内容)), “,'”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天)), “','”, .内容, “',”, “替换收据号”, “,'”, .内容, “' )”))
        赋值 (请求信息, 相加 (“用户过户|”, 查询文本, “|”, 程序集_户号))
    .否则
        .如果 (等于 (窗口_用户开户., “用户修改”)) ' 用户修改
            赋值 (查询文本, 相加 (“update 用户表 set  用户名='”, .内容, “',水价类别='”, .内容, “',水表编号='”, .内容, “',居住街道='”, .内容, “',建档时间='”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天)), “',联系电话='”, .内容, “',目前状态='”, .内容, “',备注='”, .内容, “',身份证号='”, .内容, “',详细地址='”, .内容, “',性质=”, 到文本 (性质变量), “,抄表人员='”, .内容, “',起方=”, .内容, “  where 户号='”, 程序集_户号, “'”)) ' 按户号修
            赋值 (请求信息, 相加 (“用户修改|”, 查询文本, “|”, 程序集_户号, “|”, .内容, “|”))
        .否则
            .如果 (等于 (开户窗口状态, “收据号修改”)) ' 收据修改
                赋值 (查询文本, 相加 (“update 用户_开户 set 家庭人口=”, .内容, “,工程类别='”, .内容, “',收款金额=”, 到文本 (到数值 (.内容)), “,收款日期='”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天)), “',收款人员='”, .内容, “',收款摘要='”, .内容, “' where 收据号=”, 到文本 (程_收据号))) ' 按收据号修改
                赋值 (请求信息, 相加 (“收据修改|”, 查询文本, “|”, 到文本 (程_收据号), “|”))
            .否则
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束
赋值 (周步信息, 数据库连接.未知支持库函数_17 (请求信息, 结果, 50000))
恢复鼠标 ()
赋值 (全局_数据处理状态, 假)
.如果 (等于 (周步信息, -1))
    信息框 (“服务器连接失败！”, 64, )
    赋值 (全局_服务器连接状态, 假)
    返回 ()
.否则
    
.如果结束
赋值 (结果数组, 分割文本 (结果, “|”, ))
.如果 (大于 (取数组成员数 (结果数组), 1))
    .如果 (等于 (信息框 (相加 (结果数组 [1], #换行符, “是否打印发票？”), 36, ), 5)) ' 询问是否打印发票
        .如果 (等于 (.现行选中项, 0)) ' 工程打印,打印两张
            赋值 (数据文本, 相加 (结果数组 [3], “|”, 结果数组 [2], “|”, 局部_缴费性质, “|”, .内容, “|”, .内容, “|”, .内容, “|”, .内容, “  ”, .内容, “|”, 到文本 (到数值 (.内容)), “|自筹资金|”, .内容, “|”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天)), “|”, .内容, “|”))
            预存打印打印线条和标题 (数据文本)
        .否则
            赋值 (数据文本, 相加 (结果数组 [3], “|”, 结果数组 [2], “|”, 局部_缴费性质, “|”, .内容, “|”, .内容, “|”, .内容, “|”, .内容, “  ”, .内容, “|”, 到文本 (到数值 (.内容)), “|”, .内容, “|”, .内容, “|”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天)), “|”, .内容, “|”))
            预存打印打印线条和标题 (数据文本)
        .如果结束
        
    .否则
        
    .如果结束
    
.否则
    信息框 (结果数组 [1], 64, )
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    获取焦点 ()
.否则
    销毁 ()
.如果结束


.子程序 _窗口_用户开户_创建完毕, 空白型, , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 结果数组, 文本型, , "0", 
.局部变量 局部_水价类别, 文本型, , , 
.局部变量 局部_居住街道, 文本型, , , 
.局部变量 局部_目前状态, 文本型, , , 
.局部变量 局部_用户性质, 文本型, , , 
.局部变量 局部_抄表人员, 文本型, , , 
.局部变量 局部_家庭人员, 整数型, , , 
.局部变量 局部_工程类别, 文本型, , , 
.局部变量 局部_收款人员, 文本型, , , 
.局部变量 局部_收款摘要, 文本型, , , 
.局部变量 局部_返回文本, 文本型, , , 
.局部变量 局部_收据号, 文本型, , , 
.局部变量 周步信息, 整数型, , , 
.局部变量 请求信息, 文本型, , , 
.局部变量 结果, 文本型, , , 

.如果 (等于 (开户窗口状态, “过户修改”))
    赋值 (程序集_户号, “”)
    输入框 (“请输入户号信息：”, “户号输入”, “2009”, 程序集_户号, )
    赋值 (程序集_户号, 删首尾空 (程序集_户号))
    .如果 (或者 (等于 (程序集_户号, “”), 等于 (程序集_户号, “2009”)))
        信息框 (“请输入户号信息！”, 64, )
        销毁 ()
    .否则
        赋值 (局部_返回文本, 子程序_读用户信息 (程序集_户号))
        清除数组 (结果数组)
        赋值 (结果数组, 分割文本 (局部_返回文本, “|”, ))
        .如果 (大于 (取数组成员数 (结果数组), 1))
            赋值 (局部_水价类别, 结果数组 [1])
            赋值 (局部_居住街道, 结果数组 [2])
            赋值 (局部_抄表人员, 结果数组 [3])
            赋值 (窗口_用户开户., “过户添加”)
            赋值 (.标题, “保存”)
            赋值 (.可视, 假)
        .否则
            销毁 ()
        .如果结束
        
    .如果结束
    
.否则
    .如果 (等于 (开户窗口状态, “开户添加”))
         ' 加人口
        .计次循环首 (20, 局部_计次)
            到文本 (局部_计次).加入项目 ()
        .计次循环尾 ()
        赋值 (.现行选中项, 0)
        赋值 (窗口_用户开户., “开户添加”)
        赋值 (.现行选中项, 0)
        赋值 (.标题, “添加”)
        赋值 (局部_收款人员, 全局_收款人员)
    .否则
        .如果 (等于 (开户窗口状态, “用户修改”))
            赋值 (程序集_户号, “”)
            输入框 (“请输入户号信息：”, “户号输入”, “2009”, 程序集_户号, )
            赋值 (程序集_户号, 删首尾空 (程序集_户号))
            .如果 (或者 (等于 (程序集_户号, “”), 等于 (程序集_户号, “2009”)))
                信息框 (“请输入户号信息！”, 64, )
                销毁 ()
            .否则
                赋值 (局部_返回文本, 子程序_读用户信息 (程序集_户号))
                清除数组 (结果数组)
                赋值 (结果数组, 分割文本 (局部_返回文本, “|”, ))
                .如果 (大于 (取数组成员数 (结果数组), 1))
                    赋值 (局部_水价类别, 结果数组 [1])
                    赋值 (局部_居住街道, 结果数组 [2])
                    赋值 (局部_抄表人员, 结果数组 [3])
                    赋值 (窗口_用户开户., “用户修改”)
                    赋值 (.标题, “保存”)
                    赋值 (.可视, 假)
                .否则
                    销毁 ()
                .如果结束
                
            .如果结束
            
        .否则
            .如果 (等于 (开户窗口状态, “收据号修改”))
                输入框 (“请输入发票编号:”, , “№”, 局部_收据号, )
                赋值 (局部_收据号, 删首尾空 (局部_收据号))
                .如果 (等于 (局部_收据号, “”))
                    信息框 (“您没有输入发票编号！”, 64, )
                    销毁 ()
                .否则
                    置等待鼠标 ()
                    赋值 (请求信息, 相加 (“开户发票重打|”, 局部_收据号, “|”))
                    赋值 (周步信息, 数据库连接.未知支持库函数_17 (请求信息, 结果, 50000))
                    恢复鼠标 ()
                    .如果 (等于 (周步信息, -1))
                        信息框 (“服务器连接失败！”, 64, )
                        赋值 (全局_服务器连接状态, 假)
                        销毁 ()
                    .否则
                        
                    .如果结束
                    清除数组 (结果数组)
                     ' 信息框 (结果, 0, )
                    赋值 (结果数组, 分割文本 (结果, “|”, ))
                    .如果 (大于 (取数组成员数 (结果数组), 1))
                        赋值 (程序集_户号, 结果数组 [2])
                        赋值 (程序集_户号, 删首尾空 (程序集_户号))
                        .如果 (等于 (程序集_户号, “”))
                            信息框 (“读取收据号出错！”, 64, )
                            销毁 ()
                        .否则
                            
                        .如果结束
                        赋值 (局部_返回文本, 子程序_读用户信息 (程序集_户号))
                        赋值 (.内容, 数值到格式文本 (到数值 (结果数组 [8]), 2, 假))
                        赋值 (局部_收款摘要, 结果数组 [9])
                        赋值 (.今天, 到时间 (结果数组 [11]))
                        清除数组 (结果数组)
                        赋值 (结果数组, 分割文本 (局部_返回文本, “|”, ))
                        .如果 (大于 (取数组成员数 (结果数组), 1))
                            赋值 (局部_水价类别, 结果数组 [1])
                            赋值 (局部_居住街道, 结果数组 [2])
                            赋值 (局部_抄表人员, 结果数组 [3])
                            赋值 (窗口_用户开户., 相加 (“收据修改”, “--”, 局部_收据号))
                            赋值 (.标题, “保存”)
                            赋值 (.可视, 假)
                            赋值 (程_收据号, 到数值 (子文本替换 (局部_收据号, “№”, “1”, 1, 1, 真)))
                        .否则
                            销毁 ()
                        .如果结束
                        
                    .否则
                        信息框 (“没有找到相关的收据号信息！”, 64, )
                        销毁 ()
                    .如果结束
                    
                .如果结束
                
                
            .否则
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
    
.如果结束
 ' 读水价类别
读信息 (“列表|select 水价类别 from 水价类别”, , 局部_水价类别)
 ' 街道名称
读信息 (“列表|select 街道 from 街道”, , 局部_居住街道)
 ' 抄表人员
读信息 (“列表|select 抄表员 from 抄表员”, , 局部_抄表人员)
读信息 (“列表|select 收费人员 from 收费员 where 收费人员<>'管理员'”, , 全局_收款人员)
读信息 (“列表|select 摘要信息 from 收款摘要”, , 局部_收款摘要)
赋值 (.起始选择位置, -1)
获取焦点 ()

.子程序 子程序_读用户信息, 文本型, , 
.参数 参数_户号, 文本型, , 

.局部变量 请求信息, 文本型, , , 
.局部变量 周步信息, 整数型, , , 
.局部变量 结果, 文本型, , , 
.局部变量 结果数组, 文本型, , "0", 
.局部变量 局部_水价类别, 文本型, , , 
.局部变量 局部_居住街道, 文本型, , , 
.局部变量 局部_目前状态, 文本型, , , 
.局部变量 局部_用户性质, 文本型, , , 
.局部变量 局部_抄表人员, 文本型, , , 
.局部变量 局部_家庭人员, 整数型, , , 
.局部变量 局部_工程类别, 文本型, , , 
.局部变量 局部_收款人员, 文本型, , , 
.局部变量 局部_收款摘要, 文本型, , , 
.局部变量 局部_计次, 整数型, , , 

赋值 (请求信息, 相加 (“查询户号|”, “select * from 用户表 where 户号='”, 参数_户号, “' and 父号='0'”, “|”, 参数_户号, “|”))
赋值 (周步信息, 数据库连接.未知支持库函数_17 (请求信息, 结果, 5000))
.如果 (等于 (周步信息, -1))
    信息框 (“服务器连接失败！”, 64, )
    赋值 (全局_服务器连接状态, 假)
    返回 (“错误|”)
.否则
    
.如果结束
赋值 (结果数组, 分割文本 (结果, “|”, ))
.如果 (等于 (取数组成员数 (结果数组), 1))
    信息框 (结果数组 [1], 64, )
    返回 (“错误”)
.否则
    
.如果结束
赋值 (.内容, 结果数组 [1])
赋值 (局部_水价类别, 结果数组 [2])
赋值 (.内容, 结果数组 [3])
赋值 (局部_居住街道, 结果数组 [4])
赋值 (.内容, 结果数组 [5])
 ' 日期框2.今天 ＝ 到时间 (结果数组 [6])
赋值 (.今天, 到时间 (取现行时间 ()))
赋值 (.内容, 结果数组 [7])
赋值 (.内容, 结果数组 [8])
赋值 (局部_目前状态, 结果数组 [9])
赋值 (.内容, 结果数组 [10])
赋值 (局部_用户性质, 结果数组 [11])
赋值 (局部_抄表人员, 结果数组 [12])
赋值 (.内容, 结果数组 [13])
.如果 (等于 (局部_用户性质, “假”))
    赋值 (.现行选中项, 0)
.否则
    赋值 (.现行选中项, 1)
.如果结束
.判断开始 (等于 (局部_目前状态, “正常”))
    赋值 (.现行选中项, 0)
.默认
    赋值 (.现行选中项, 1)
.判断结束
 ' 加人口
.计次循环首 (20, 局部_计次)
    到文本 (局部_计次).加入项目 ()
.计次循环尾 ()
.如果 (大于 (取数组成员数 (结果数组), 13))
    赋值 (局部_家庭人员, 到数值 (结果数组 [14]))
    赋值 (局部_工程类别, 结果数组 [15])
    .判断开始 (等于 (局部_工程类别, “规划内-管网延伸”))
        赋值 (.现行选中项, 0)
    .判断 (等于 (局部_工程类别, “规划内-技改”))
        赋值 (.现行选中项, 1)
    .默认
        赋值 (.现行选中项, 2)
    .判断结束
    赋值 (.现行选中项, 相减 (局部_家庭人员, 1))
.否则
    赋值 (.现行选中项, 2)
    赋值 (.现行选中项, 0)
.如果结束
返回 (相加 (局部_水价类别, “|”, 局部_居住街道, “|”, 局部_抄表人员, “|”))



.子程序 _返回_被单击, 空白型, , 
销毁 ()

.子程序 _分组框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 数值转大写, 文本型, , 
.参数 数值1, 文本型, 参考, 
.参数 转数或额, 逻辑型, 参考, 
.参数 转一或壹, 逻辑型, 参考, 



.窗口程序集 窗口程序集_服务器设置, , , 

.子程序 _按钮_返回_被单击, 空白型, , 
销毁 ()

.子程序 _按钮_保存_被单击, 空白型, , 
.判断开始 (等于 (.内容, “”))
    信息框 (“请填写服务器IP地址！”, 64, )
    获取焦点 ()
.默认
    
.判断结束
.判断开始 (等于 (.内容, “”))
    信息框 (“请填写服务器端口信息！”, 64, )
    获取焦点 ()
.默认
    
.判断结束
写配置项 (相加 (取运行目录 (), “\pz.ini”), “服务器”, “IP”, .内容)
写配置项 (相加 (取运行目录 (), “\pz.ini”), “服务器”, “端口”, .内容)
信息框 (“保存成功！”, 64, )

.子程序 _窗口_服务器_创建完毕, 空白型, , 
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\pz.ini”), “服务器”, “IP”, ))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\pz.ini”), “服务器”, “端口”, ))
获取焦点 ()

.窗口程序集 窗口程序集_登陆, , , 

.子程序 _窗口_用户登陆_创建完毕, 空白型, , 
.局部变量 局部_端口, 文本型, , , 
.局部变量 局部_IP, 文本型, , , 
.局部变量 结果, 文本型, , , 
.局部变量 同步文本, 整数型, , , 
.局部变量 局部_结果数组, 文本型, , "0", 
.局部变量 局部_计次, 整数型, , , 

赋值 (局部_IP, 读配置项 (相加 (取运行目录 (), “\pz.ini”), “服务器”, “IP”, ))
赋值 (局部_端口, 读配置项 (相加 (取运行目录 (), “\pz.ini”), “服务器”, “端口”, ))
输出调试文本 (局部_IP)
输出调试文本 (局部_端口)
.如果 (等于 (全局_服务器连接状态, 假)) ' 是假才连接，否则不需要连接
    数据库连接.未知支持库函数_16 ()
    .如果 (等于 (数据库连接.未知支持库函数_15 (到数值 (局部_端口), 局部_IP, 真, ), 假))
        信息框 (“连接到服务器失败！”, 64, )
        赋值 (全局_服务器连接状态, 假)
        返回 ()
    .否则
         ' 信息框 (“连接到服务器成功！”, 64, )
        赋值 (全局_服务器连接状态, 真)
    .如果结束
     ' 开始认证
    赋值 (同步文本, 数据库连接.未知支持库函数_17 (“dywt”, 结果, 5000))
    .如果 (等于 (同步文本, 1))
         ' 信息框 (“服务认证成功！”, 64, )
    .否则
        
    .如果结束
    
.否则
    
.如果结束
发送登陆信息
赋值 (同步文本, 数据库连接.未知支持库函数_17 (“取用户名|”, 结果, 5000))
赋值 (局部_结果数组, 分割文本 (结果, “|”, ))
.计次循环首 (取数组成员数 (局部_结果数组), 局部_计次)
    局部_结果数组.加入项目 ( [局部_计次], )
.计次循环尾 ()
赋值 (.现行选中项, 0)
获取焦点 ()

.子程序 _按钮_确定_被单击, 空白型, , 
.局部变量 局部_消息文本, 文本型, , , 
.局部变量 同步文本, 整数型, , , 
.局部变量 结果, 文本型, , , 

赋值 (局部_消息文本, 相加 (“验证用户|”, .内容, “|”, .内容, “|”))
赋值 (同步文本, 数据库连接.未知支持库函数_17 (局部_消息文本, 结果, 5000))
.如果 (等于 (结果, “真”))
    信息框 (“登陆成功！”, 64, )
    赋值 (全局_收款人员, .内容)
    未知支持库函数_6 (全局_心跳包句柄)
    未知支持库函数_0 (&子程序_发送心跳包, , 全局_心跳包句柄)
    销毁 ()
    赋值 (全局_登陆状态, 真)
.否则
    信息框 (“登陆失败！”, 64, )
    赋值 (.内容, “”)
    获取焦点 ()
    赋值 (全局_登陆状态, 假)
.如果结束


.子程序 _按钮_取消_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集_收款摘要, , , 

.子程序 _窗口_收款摘要_创建完毕, 空白型, , 
读摘要信息 ()
获取焦点 ()

.子程序 读摘要信息, 空白型, , 
.局部变量 周步信息, 整数型, , , 
.局部变量 请求信息, 文本型, , , 
.局部变量 结果, 文本型, , , 
.局部变量 结果数组, 文本型, , "0", 
.局部变量 局部_计次, 整数型, , , 

赋值 (请求信息, “列表|select 摘要信息 from 收款摘要”)
赋值 (周步信息, 数据库连接.未知支持库函数_17 (请求信息, 结果, 5000))
.如果 (等于 (周步信息, -1))
    信息框 (“服务器连接失败！”, 64, )
    赋值 (全局_服务器连接状态, 假)
    返回 ()
.否则
    
.如果结束
赋值 (结果数组, 分割文本 (结果, “|”, ))
全部删除 ()
.计次循环首 (取数组成员数 (结果数组), 局部_计次)
    .插入表项 ()
    相减 (局部_计次, 1).置标题 (0, 结果数组 [局部_计次])
.计次循环尾 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 请求信息, 文本型, , , 

.如果 (等于 (.内容, “”))
    信息框 (“请输入待添加的摘要信息！”, 64, )
    获取焦点 ()
    返回 ()
.否则
    
.如果结束
赋值 (请求信息, 相加 (“摘要|insert into 收款摘要(摘要信息) values ('”, .内容, “')”, “|”))
子程序_摘要操作 (请求信息)
赋值 (.内容, “”)

.子程序 子程序_摘要操作, 空白型, , 
.参数 参数_请求信息, 文本型, , 

.局部变量 周步信息, 整数型, , , 
.局部变量 结果, 文本型, , , 
.局部变量 结果数组, 文本型, , "0", 
.局部变量 局部_计次, 整数型, , , 

赋值 (周步信息, 数据库连接.未知支持库函数_17 (参数_请求信息, 结果, 5000))
.如果 (等于 (周步信息, -1))
    信息框 (“服务器连接失败！”, 64, )
    赋值 (全局_服务器连接状态, 假)
    返回 ()
.否则
    
.如果结束
赋值 (结果数组, 分割文本 (结果, “|”, ))
.如果 (等于 (结果数组 [1], “真”))
    信息框 (“执行成功！”, 64, )
    读摘要信息 ()
.否则
    信息框 (“执行失败！”, 64, )
.如果结束


.子程序 _删除_被单击, 空白型, , 
.局部变量 请求信息, 文本型, , , 

.如果 (不等于 (.取标题 (., 0), “”))
    赋值 (请求信息, 相加 (“摘要|delete from 收款摘要 where 摘要信息='”, .取标题 (., 0), “'”, “|”))
    子程序_摘要操作 (请求信息)
.否则
    信息框 (“请选择待删除的摘要信息！”, 64, )
.如果结束


.子程序 _按钮3_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集_收款查询, , , 

.子程序 _窗口_收款查询_创建完毕, 空白型, , 
 ' 街道名称
读信息 (“列表|select 街道 from 街道”, , “”)
 ' 抄表人员
读信息 (“列表|select 抄表员 from 抄表员”, , “”)
读信息 (“列表|select 收费人员 from 收费员 where 收费人员<>'管理员'”, , “”)
获取焦点 ()

.子程序 _收费按钮_确定_被单击, 空白型, , 
.局部变量 开始, 文本型, , , 
.局部变量 结束, 文本型, , , 
.局部变量 查询参数, 文本型, , , 
.局部变量 局部_收款查询SQL, 文本型, , , 
.局部变量 排序, 文本型, , , 
.局部变量 请求信息, 文本型, , , 
.局部变量 周步信息, 整数型, , , 
.局部变量 结果, 文本型, , , 
.局部变量 结果数组, 文本型, , "0", 
.局部变量 局部_标题数组, 文本型, , "0", 
.局部变量 局部_宽度数组, 整数型, , "0", 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_宽度, 整数型, , , 

置等待鼠标 ()
赋值 (全局_数据处理状态, 真)
赋值 (开始, 相加 (“#”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天)), “#”))
赋值 (结束, 相加 (“#”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天)), “#”))
.判断开始 (等于 (.选中, 真))
    .如果 (等于 (.内容, “”))
        信息框 (“收款人员不能为空!”, 64, )
        获取焦点 ()
        返回 ()
    .否则
        
    .如果结束
    赋值 (查询参数, 相加 (查询参数, “ and 用户_开户.收款人员='”, .内容, “'”))
.默认
    
.判断结束
.判断开始 (等于 (.选中, 真))
    .如果 (等于 (.内容, “”))
        信息框 (“居住街道不能为空!”, 64, )
        获取焦点 ()
        返回 ()
    .否则
        
    .如果结束
    赋值 (查询参数, 相加 (查询参数, “ and 用户表.居住街道='”, .内容, “' ”))
.默认
    
.判断结束
.判断开始 (等于 (.选中, 真))
    .如果 (等于 (.内容, “”))
        信息框 (“抄表人员不能为空!”, 64, )
        获取焦点 ()
        返回 ()
    .否则
        
    .如果结束
    赋值 (查询参数, 相加 (查询参数, “ and 用户表.抄表人员='”, .内容, “' ”))
.默认
    
.判断结束
.判断开始 (等于 (.选中, 真))
    .如果 (等于 (.内容, “”))
        信息框 (“缴费性质不能为空!”, 64, )
        获取焦点 ()
        返回 ()
    .否则
        
    .如果结束
    赋值 (查询参数, 相加 (查询参数, “ and 用户_开户.缴费性质='”, .内容, “' ”))
.默认
    
.判断结束
.判断开始 (等于 (.选中, 真))
    .如果 (等于 (.内容, “”))
        信息框 (“出资方式不能为空!”, 64, )
        获取焦点 ()
        返回 ()
    .否则
        
    .如果结束
    赋值 (查询参数, 相加 (查询参数, “ and 用户_开户.工程类别='”, .内容, “' ”))
.默认
    
.判断结束
.判断开始 (等于 (.选中, 真))
    .如果 (等于 (.内容, “”))
        信息框 (“详细地址不能为空!”, 64, )
        获取焦点 ()
        返回 ()
    .否则
        
    .如果结束
    赋值 (查询参数, 相加 (查询参数, “ and 用户表.详细地址 LIKE '”, .内容, “%' ”))
.默认
    
.判断结束

.判断开始 (等于 (.现行选中项, 0))
    赋值 (排序, “ ORDER  BY 用户表.编号”)
.判断 (等于 (.现行选中项, 1))
    赋值 (排序, “ ORDER  BY 用户_开户.收款日期”)
.判断 (等于 (.现行选中项, 2))
    赋值 (排序, “ ORDER  BY 用户_开户.收款人员”)
.判断 (等于 (.现行选中项, 3))
    赋值 (排序, “ ORDER  BY 用户_开户.收据号”)
.判断 (等于 (.现行选中项, 4))
    赋值 (排序, “ ORDER  BY 用户表.抄表人员”)
.判断 (等于 (.现行选中项, 5))
    赋值 (排序, “ ORDER  BY 用户表.居住街道”)
.判断 (等于 (.现行选中项, 6))
    赋值 (排序, “ ORDER  BY  用户_开户.收款金额”)
.判断 (等于 (.现行选中项, 7))
    赋值 (排序, “ ORDER  BY  用户表.居住街道,用户表.详细地址,用户表.编号”)
.默认
    
.判断结束
 ' 取排序方式
.判断开始 (等于 (.现行选中项, 0))
    赋值 (排序, 相加 (排序, “ ASC”))
.默认
    赋值 (排序, 相加 (排序, “ DESC”))
.判断结束
赋值 (查询参数, 相加 (查询参数, 排序))
.判断开始 (等于 (.选中, 真))
    赋值 (局部_收款查询SQL, 相加 (“select 用户表.户号,用户表.用户名,用户表.水价类别,用户表.水表编号,用户表.居住街道,用户表.详细地址,用户_开户.家庭人口,用户_开户.缴费性质,用户_开户.工程类别,用户_开户.收款金额,用户_开户.收款日期,用户_开户.收款人员,用户_开户.收据号,用户_开户.收款摘要 from 用户表,用户_开户 where 用户表.户号=用户_开户.户号”, “ and 用户_开户.收款日期>=”, 开始, “ and 用户_开户.收款日期<=”, 结束, 查询参数))
.默认
    赋值 (局部_收款查询SQL, 相加 (“select 用户表.户号,用户表.用户名,用户表.水价类别,用户表.水表编号,用户表.居住街道,用户表.详细地址,用户_开户.家庭人口,用户_开户.缴费性质,用户_开户.工程类别,用户_开户.收款金额,用户_开户.收款日期,用户_开户.收款人员,用户_开户.收据号,用户_开户.收款摘要 from 用户表,用户_开户 where 用户表.户号=用户_开户.户号”, 查询参数))
.判断结束

赋值 (请求信息, 相加 (“开户查询|”, 局部_收款查询SQL, “|”))
赋值 (周步信息, 数据库连接.未知支持库函数_17 (请求信息, 结果, 50000))
.如果 (等于 (周步信息, -1))
    信息框 (“服务器连接失败！”, 64, )
    赋值 (全局_服务器连接状态, 假)
    返回 ()
.否则
    
.如果结束
恢复鼠标 ()
赋值 (全局_数据处理状态, 假)
.如果 (等于 (结果, “假”))
    信息框 (“没有查询到数据！”, 64, )
    返回 ()
.否则
    
.如果结束
 ' 结果数组 ＝ 分割文本 (结果, “|”, )
加入成员 (局部_标题数组, “户号”)
加入成员 (局部_标题数组, “用户名”)
加入成员 (局部_标题数组, “水价类别”)
加入成员 (局部_标题数组, “水表编号”)
加入成员 (局部_标题数组, “居住街道”)
加入成员 (局部_标题数组, “详细地址”)
加入成员 (局部_标题数组, “家庭人口”)
加入成员 (局部_标题数组, “缴费性质”)
加入成员 (局部_标题数组, “工程类别”)
加入成员 (局部_标题数组, “收款金额”)
加入成员 (局部_标题数组, “收费日期”)
加入成员 (局部_标题数组, “收款人员”)
加入成员 (局部_标题数组, “收据号”)
加入成员 (局部_标题数组, “收款摘要”)
赋值 (全局_当前列类型, “开户查询”)
.计次循环首 (取数组成员数 (局部_标题数组), 局部_计次)
    赋值 (局部_宽度, 到数值 (读配置项 (相加 (取运行目录 (), “\pz.ini”), 全局_当前列类型, 到文本 (相减 (局部_计次, 1)), )))
    .如果 (小于或等于 (局部_宽度, 0))
        加入成员 (局部_宽度数组, 80)
    .否则
        加入成员 (局部_宽度数组, 局部_宽度)
    .如果结束
    
.计次循环尾 ()
销毁 ()
子程序_高级表格显示数据 (结果, 局部_标题数组, 局部_宽度数组, _启动窗口.)

.子程序 _按钮_取消_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集1, , , 

.子程序 _按钮_确定_被单击, 空白型, , 
.局部变量 局部_户号, 文本型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 查询户号数组, 文本型, , "0", 
.局部变量 排序, 文本型, , , 
.局部变量 局部_起始户号, 整数型, , , 
.局部变量 局部_止户号, 整数型, , , 
.局部变量 请求信息, 文本型, , , 
.局部变量 周步信息, 整数型, , , 
.局部变量 结果, 文本型, , , 
.局部变量 局部_标题数组, 文本型, , "0", 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_宽度数组, 整数型, , "0", 
.局部变量 局部_宽度, 整数型, , , 

 ' 窗口_用户查询.可视 ＝ 假
置等待鼠标 ()
赋值 (全局_数据处理状态, 真)
赋值 (参数_编码前缀, “2009”)
.如果 (等于 (.选中, 真))
    信息框 (“请选择批量户号查询按钮！”, 64, )
    返回 ()
.否则
    
.如果结束

.判断开始 (等于 (.现行选中项, 0))
    赋值 (排序, “  and  父号='0' ORDER  BY 编号  ”)
.判断 (等于 (.现行选中项, 1))
    赋值 (排序, “    and  父号='0' ORDER  BY 编号  DESC ”)
.判断 (等于 (.现行选中项, 2))
    赋值 (排序, “    and  父号='0' ORDER  BY 居住街道,编号   ”)
.判断 (等于 (.现行选中项, 3))
    赋值 (排序, “    and  父号='0' ORDER  BY 居住街道,编号 DESC ”)
.默认
    
.判断结束

.如果 (等于 (.选中, 真))
    .如果 (等于 (.内容, “”))
        信息框 (“户号起不能为空！”, 64, )
        获取焦点 ()
        返回 ()
    .否则
        
    .如果结束
    .如果 (等于 (.内容, “”))
        信息框 (“户号止不能为空！”, 64, )
        获取焦点 ()
        返回 ()
    .否则
        
    .如果结束
    
    .如果 (小于 (到数值 (.内容), 到数值 (.内容)))
        信息框 (“待查询的尾户号不能小于起户号！”, 64, )
        获取焦点 ()
        赋值 (.被选择字符数, -1)
        返回 ()
    .否则
        
    .如果结束
    置等待鼠标 ()
    赋值 (局部_起始户号, 到数值 (子文本替换 (.内容, 参数_编码前缀, “1”, , , 真)))
    赋值 (局部_止户号, 到数值 (子文本替换 (.内容, 参数_编码前缀, “1”, , , 真)))
    .计次循环首 (相加 (相减 (局部_止户号, 局部_起始户号), 1), 计次)
        赋值 (局部_户号, 子文本替换 (到文本 (相减 (相加 (局部_起始户号, 计次), 1)), “1”, 参数_编码前缀, , 1, 真))
        加入成员 (查询户号数组, 局部_户号)
        输出调试文本 (局部_户号)
    .计次循环尾 ()
    .如果 (大于 (取数组成员数 (查询户号数组), 1))
        赋值 (局部_户号, 相加 (“select * from 用户表 where 户号='”, 查询户号数组 [1], “'”))
        .计次循环首 (相减 (取数组成员数 (查询户号数组), 1), 计次)
            赋值 (局部_户号, 相加 (局部_户号, “ or 户号='”, 查询户号数组 [相加 (计次, 1)], “'”))
        .计次循环尾 ()
        
    .否则
        赋值 (局部_户号, 相加 (“select * from 用户表 where 户号='”, 查询户号数组 [1], “'”))
    .如果结束
    恢复鼠标 ()
    .如果 (等于 (.选中, 真))
         ' 销毁 ()
         ' 按户号显示 (查询户号数组, _启动窗口.用户查询列表框, 真)
    .否则
         ' 销毁 ()
         ' 按户号显示 (查询户号数组, _启动窗口.用户查询列表框, 假)
    .如果结束
    
.否则
    
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (局部_户号, 相加 (“select * from 用户表 where 水价类别= '”, .内容, “'”, 排序))
    
.否则
    
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (局部_户号, 相加 (“select * from 用户表 where 抄表人员= '”, .内容, “'”, 排序))
    
.否则
    
.如果结束
.如果 (等于 (.选中, 真))
    .如果 (等于 (.内容, “”))
        信息框 (“水表编号不能为空！”, 64, )
        获取焦点 ()
        返回 ()
    .否则
        
    .如果结束
    赋值 (局部_户号, 相加 (“select * from 用户表 where 水表编号= '”, .内容, “'”, 排序))
    
.否则
    
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (局部_户号, 相加 (“select * from 用户表 where 目前状态= '”, .内容, “'”, 排序))
    
.否则
    
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (局部_户号, 相加 (“select * from 用户表 where 建档时间>=#”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天)), “# and 建档时间<=#”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天)), “#”, 排序))
     ' 信息框 (局部_户号, 0, )
    
.否则
    
.如果结束
.如果 (等于 (.选中, 真))
    .如果 (等于 (.内容, “”))
        信息框 (“用户名不能为空！”, 64, )
        获取焦点 ()
        返回 ()
    .否则
        
    .如果结束
    赋值 (局部_户号, 相加 (“select * from 用户表 where 用户名   LIKE '”, .内容, “%'”, 排序))
    
.否则
    
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (局部_户号, 相加 (“select * from 用户表 where 居住街道='”, .内容, “'”, 排序))
    
.否则
    
.如果结束
.如果 (等于 (.选中, 真))
    .如果 (等于 (.现行选中项, 0))
        赋值 (局部_户号, 相加 (“select * from 用户表 where 性质=0”, 排序))
    .否则
        赋值 (局部_户号, 相加 (“select * from 用户表 where 性质<>0”, 排序))
    .如果结束
    
.否则
    
.如果结束
 ' 窗口_用户查询.可视 ＝ 假
.如果 (不等于 (.选中, 真))
    .如果 (等于 (.选中, 真))
        赋值 (局部_户号, 相加 (局部_户号, “|”, “真”, “|”))
    .否则
        赋值 (局部_户号, 相加 (局部_户号, “|”, “假”, “|”))
    .如果结束
    
.否则
    
.如果结束
赋值 (请求信息, 相加 (“建档用户查询|”, 局部_户号))
赋值 (周步信息, 数据库连接.未知支持库函数_17 (请求信息, 结果, 50000))
.如果 (等于 (周步信息, -1))
    信息框 (“服务器连接失败！”, 64, )
    赋值 (全局_服务器连接状态, 假)
    返回 ()
.否则
    
.如果结束
恢复鼠标 ()
赋值 (全局_数据处理状态, 假)
.如果 (等于 (结果, “假”))
    信息框 (“没有查询到数据！”, 64, )
    返回 ()
.否则
    
.如果结束
加入成员 (局部_标题数组, “户号”)
加入成员 (局部_标题数组, “用户名”)
加入成员 (局部_标题数组, “用户性质”)
加入成员 (局部_标题数组, “水价类别”)
加入成员 (局部_标题数组, “水表编号”)
加入成员 (局部_标题数组, “居住街道”)
加入成员 (局部_标题数组, “详细地址”)
加入成员 (局部_标题数组, “建档时间”)
加入成员 (局部_标题数组, “身份证号”)
加入成员 (局部_标题数组, “联系电话”)
加入成员 (局部_标题数组, “目前状态”)
加入成员 (局部_标题数组, “抄表人员”)
加入成员 (局部_标题数组, “起方”)
加入成员 (局部_标题数组, “备注”)
赋值 (全局_当前列类型, “建档查询”)
.计次循环首 (取数组成员数 (局部_标题数组), 局部_计次)
    赋值 (局部_宽度, 到数值 (读配置项 (相加 (取运行目录 (), “\pz.ini”), 全局_当前列类型, 到文本 (相减 (局部_计次, 1)), )))
    .如果 (小于或等于 (局部_宽度, 0))
        加入成员 (局部_宽度数组, 80)
    .否则
        加入成员 (局部_宽度数组, 局部_宽度)
    .如果结束
    
.计次循环尾 ()
销毁 ()
子程序_高级表格显示数据 (结果, 局部_标题数组, 局部_宽度数组, _启动窗口.)

.子程序 _按钮_取消_被单击, 空白型, , 
销毁 ()

.子程序 _编辑框_户号起_内容被改变, 空白型, , 
赋值 (.内容, .内容)

.子程序 _窗口_建档用户查询_创建完毕, 空白型, , 
 ' 街道名称
读信息 (“列表|select 街道 from 街道”, , “”)
 ' 抄表人员
读信息 (“列表|select 抄表员 from 抄表员”, , “”)
 ' 读水价类别
读信息 (“列表|select 水价类别 from 水价类别”, , “”)
赋值 (.选中, 真)

.窗口程序集 窗口程序集_用户材料表打印, , , 

.子程序 _按钮_取消_被单击, 空白型, , 
销毁 ()

.子程序 _按钮_确定_被单击, 空白型, , 
.局部变量 局部_起始户号, 整数型, , , 
.局部变量 局部_止户号, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 查询户号数组, 文本型, , , 
.局部变量 局部_户号, 文本型, , , 
.局部变量 请求信息, 文本型, , , 
.局部变量 周步信息, 整数型, , , 
.局部变量 结果, 文本型, , , 
.局部变量 结果数组, 文本型, , "0", 
.局部变量 局部_计次, 整数型, , , 

赋值 (参数_编码前缀, “2009”)
赋值 (局部_起始户号, 到数值 (子文本替换 (.内容, 参数_编码前缀, “1”, , , 真)))
赋值 (局部_止户号, 到数值 (子文本替换 (.内容, 参数_编码前缀, “1”, , , 真)))
.计次循环首 (相加 (相减 (局部_止户号, 局部_起始户号), 1), 计次)
    赋值 (局部_户号, 子文本替换 (到文本 (相减 (相加 (局部_起始户号, 计次), 1)), “1”, 参数_编码前缀, , 1, 真))
    赋值 (查询户号数组, 相加 (查询户号数组, 局部_户号, “|”))
.计次循环尾 ()
赋值 (请求信息, 相加 (“材料用户查询|”, 查询户号数组))
赋值 (周步信息, 数据库连接.未知支持库函数_17 (请求信息, 结果, 50000))
.如果 (等于 (周步信息, -1))
    信息框 (“服务器连接失败！”, 64, )
    赋值 (全局_服务器连接状态, 假)
    返回 ()
.否则
    
.如果结束
恢复鼠标 ()
.如果 (等于 (结果, “假”))
    信息框 (“没有查询到数据！”, 64, )
    返回 ()
.否则
    
.如果结束
赋值 (结果数组, 分割文本 (结果, “,”, ))
.计次循环首 (取数组成员数 (结果数组), 局部_计次)
    子程序_打印材料出库表 (结果数组 [局部_计次])
    延时 (100)
.计次循环尾 ()

.子程序 _编辑框_户号起_内容被改变, 空白型, , 
赋值 (.内容, .内容)

.子程序 _窗口_打印材料出库表_创建完毕, 空白型, , 
获取焦点 ()
赋值 (.起始选择位置, -1)

.窗口程序集 窗口程序集2, , , 

.程序集变量 子窗口句柄, 整数型, , , 
.子程序 _按钮1_被单击, 空白型, , 
.局部变量 字段组, 文本型, , "0", 

赋值 (.类型, 2)
赋值 (字段组, 分割文本 (.内容, “,”, ))
赋值 (.字体名称, 字段组 [1])
赋值 (.字体大小, 到数值 (字段组 [2]))
.如果 (等于 (打开 (), 真))
    赋值 (.内容, .字体名称)
    赋值 (.内容, 相加 (.内容, “,”, 到文本 (.字体大小)))
    
.否则
    
.如果结束


.子程序 _窗口_打印设置_创建完毕, 空白型, , 
赋值 (全局配置文件名, “我的配备.ini”)
读打印配置项 ()
显示列 (_启动窗口.)
读打印字段 ()

.子程序 读打印配置项, 空白型, , 
.局部变量 线型, 文本型, , , 

赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “标题”, “高级表格自由打印”))
赋值 (.起始选择位置, -1)
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “字体”, “黑体,22”))
赋值 (.现行选中项, 到整数 (读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “纸型”, “ 1”)))
赋值 (.现行选中项, 到整数 (读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “打印方向”, “1”)))
赋值 (.现行选中项, 到整数 (读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “自动填充”, “1”)))
赋值 (.现行选中项, 到整数 (读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “标题对齐”, “1”)))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “行数”, “”))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “行高”, “8”))
赋值 (线型, 读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “线型”, “1”))
.判断开始 (等于 (线型, “1”))
    赋值 (.选中, 真)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
.判断 (等于 (线型, “2”))
    赋值 (.选中, 假)
    赋值 (.选中, 真)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
.判断 (等于 (线型, “3”))
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 真)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
.判断 (等于 (线型, “4”))
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 真)
    赋值 (.选中, 假)
.默认
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 真)
.判断结束
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “字体大小”, “”))
赋值 (.选中, 选择 (等于 (读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “是否序号”, “假”), “真”), 真, 假))
 ' 制表日期.选中 ＝ 选择 (读配置项 (取运行目录 () ＋ “\” ＋ 全局配置文件名, “高级表格打印”, “是否制表日期”, “假”) ＝ “真”, 真, 假)
赋值 (.选中, 选择 (等于 (读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “保存配置”, “假”), “真”), 真, 假))
赋值 (.选中, 选择 (等于 (读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “全选”, “假”), “真”), 真, 假))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “左边距”, “10”))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “右边距”, “10”))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “上边距”, “10”))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “下边距”, “10”))

.子程序 读打印字段, 空白型, , 
.局部变量 字段, 文本型, , , 
.局部变量 字段组, 文本型, , "0", 
.局部变量 计次, 空白型, , , 

赋值 (字段, 读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “打印字段”, “”))
.如果真 (等于 (字段, “”))
    返回 ()
.如果真结束
赋值 (字段组, 分割文本 (字段, “,”, ))
.如果真 (不等于 (取数组成员数 (字段组), 取项目数 ()))
    返回 ()
.如果真结束

.计次循环首 (取项目数 (), 计次)
    .如果 (等于 (字段组 [计次], “0”))
        相减 (计次, 1).选中项目 (假)
    .否则
        相减 (计次, 1).选中项目 (真)
    .如果结束
    
.计次循环尾 ()

.子程序 显示列, 空白型, , 
.参数 高级表格, 未知类型0x40001, , 

.局部变量 计次, 整数型, , , 
.局部变量 现有列, 文本型, , , 

 ' 将列加入选择框
.计次循环首 (高级表格., 计次)
    赋值 (现有列, 高级表格.未知支持库函数_10 (0, 相减 (计次, 1)))
    现有列.加入项目 ()
    相减 (计次, 1).选中项目 (真)
    输出调试文本 (现有列)
.计次循环尾 ()

.子程序 _按钮_打印预览_被单击, 空白型, , 
.局部变量 线型, 文本型, , , 

.判断开始 (等于 (.选中, 真))
    赋值 (线型, “ 1”)
.判断 (等于 (.选中, 真))
    赋值 (线型, “2”)
.判断 (等于 (.选中, 真))
    赋值 (线型, “3”)
.判断 (等于 (.选中, 真))
    赋值 (线型, “4”)
.默认
    赋值 (线型, “5”)
.判断结束
.如果 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “标题”, 删首尾空 (.内容))
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “标题对齐”, 删首尾空 (到文本 (.现行选中项)))
    保存打印字段信息 ()
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “字体”, 删首尾空 (.内容))
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “纸型”, 删首尾空 (到文本 (.现行选中项)))
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “打印方向”, 删首尾空 (到文本 (.现行选中项)))
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “自动填充”, 删首尾空 (到文本 (.现行选中项)))
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “行数”, 删首尾空 (.内容))
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “行高”, 删首尾空 (.内容))
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “线型”, 线型)
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “字体大小”, 删首尾空 (.内容))
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “是否序号”, 选择 (等于 (.选中, 真), “真”, “假”))
     ' 写配置项 (取运行目录 () ＋ “\” ＋ 全局配置文件名, “高级表格打印”, “是否制表日期”, 选择 (制表日期.选中 ＝ 真, “真”, “假”))
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “保存配置”, “真”)
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “全选”, 选择 (等于 (.选中, 真), “真”, “假”))
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “左边距”, 删首尾空 (.内容))
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “右边距”, 删首尾空 (.内容))
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “上边距”, 删首尾空 (.内容))
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “下边距”, 删首尾空 (.内容))
.否则
    
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “保存配置”, “假”)
.如果结束
打印高级表格 (_启动窗口.)

.子程序 _按钮3_被单击, 空白型, , 
销毁 ()

.子程序 保存打印字段信息, 空白型, , 
.局部变量 计次, 空白型, , , 
.局部变量 字段, 文本型, , , 0,表示未选中，1，表示选中

赋值 (字段, “”)
.计次循环首 (取项目数 (), 计次)
    .如果 (取反 (相减 (计次, 1).是否被选中 ()))
        赋值 (字段, 相加 (字段, “0,”))
    .否则
        赋值 (字段, 相加 (字段, “1,”))
    .如果结束
    
.计次循环尾 ()
赋值 (字段, 取文本左边 (字段, 相减 (取文本长度 (字段), 1))) ' 去掉右边一个逗号
写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “打印字段”, 字段)


.子程序 打印高级表格, 空白型, , 
.参数 高级表格, 未知类型0x40001, , 

.局部变量 打印列名称, 文本型, , "0", 
.局部变量 打印列索引, 整数型, , "0", 
.局部变量 打印标题, 文本型, , , 
.局部变量 列数, 空白型, , , 
.局部变量 行数, 空白型, , , 
.局部变量 计次, 空白型, , , 
.局部变量 计次一, 空白型, , , 
.局部变量 总列宽, 空白型, , , 
.局部变量 列宽, 空白型, , , 
.局部变量 单元格文本, 文本型, , , 
.局部变量 打印设置, 打印设置信息, , , 
.局部变量 标题字体, 文本型, , "0", 
.局部变量 i, 空白型, , , 
.局部变量 高级表格_列宽, 整数型, , , 
.局部变量 高级表格_列宽数组, 整数型, , "0", 
.局部变量 总宽度, 整数型, , , 
.局部变量 列比值, 双精度小数型, , , 

置等待鼠标 ()
赋值 (.标题, “正在生成打印预览请稍候...”)
赋值 (.可视, 真)
赋值 (子窗口句柄, 1)
赋值 (总宽度, 0)
处理事件 ()
 ' 将要打印的列名和列索引加入数组
.计次循环首 (取项目数 (), 计次)
    .如果真 (相减 (计次, 1).是否被选中 ())
        加入成员 (打印列名称, 相减 (计次, 1).取项目文本 ())
        加入成员 (打印列索引, 相减 (计次, 1))
        赋值 (高级表格_列宽, 高级表格.未知支持库函数_44 (相减 (计次, 1)))
        加入成员 (高级表格_列宽数组, 高级表格_列宽)
        赋值 (总宽度, 相加 (总宽度, 高级表格_列宽))
    .如果真结束
    
.计次循环尾 ()
.如果真 (等于 (取数组成员数 (打印列名称), 0))
    信息框 (“当前没有可打印的内容，请选择要打印的列。”, 64, “温馨提示”)
    返回 ()
.如果真结束
赋值 (., 删首尾空 (.内容))
.如果 (等于 (.内容, “”))
    赋值 (标题字体, { “黑体”, “22” })
.否则
    
    赋值 (标题字体, 分割文本 (.内容, “,”, ))
.如果结束

赋值 (.数据提供者, “通用提供者”)
.如果真 (取反 (#高级表格.从字节集读 ()))
    信息框 (“读取打印模板失败。”, 相加 (#错误图标, 0), “失败”)
    返回 ()
.如果真结束
赋值 (.数据源, “”)
赋值 (列数, 取数组成员数 (打印列名称))
.如果真 (等于 (.选中, 真))
    赋值 (列数, 相加 (列数, 1))
.如果真结束

1.插入列 (列数)
3.合并 (2, 1, 列数)
3.置文本 (2, .)
1.置文本 (2, 到文本 (取现行时间 ()))
3.置字体属性 (2, 1, 1, 1) ' 粗体字
 ' 将列标题置入数据源
.判断开始 (等于 (.现行选中项, 0))
    3.置对齐方式 (2, 1, 列数, 4)
.判断 (等于 (.现行选中项, 1))
    3.置对齐方式 (2, 1, 列数, 5)
.默认
    3.置对齐方式 (2, 1, 列数, 6)
    
.判断结束

.如果 (等于 (.选中, 真)) ' 加入序号
    赋值 (列比值, 相除 (相减 (取打印页宽 (), 总宽度, 80), 总宽度))
    .计次循环首 (列数, 计次)
        5.置字体属性 (相加 (计次, 1), 1, 1, 1) ' 粗体字
        .如果 (等于 (计次, 1))
            5.置文本 (相加 (计次, 1), “序号”)
            相加 (计次, 1).置列宽 (1, 80)
        .否则
            5.置文本 (相加 (计次, 1), 打印列名称 [相减 (计次, 1)])
            赋值 (列宽, 相加 (高级表格_列宽数组 [相减 (计次, 1)], 取整 (相乘 (列比值, 高级表格_列宽数组 [相减 (计次, 1)]))))
            相加 (计次, 1).置列宽 (1, 列宽)
        .如果结束
        赋值 (总列宽, 相加 (总列宽, 列宽))
    .计次循环尾 ()
    
.否则
    赋值 (列比值, 相除 (相减 (取打印页宽 (), 总宽度), 总宽度))
    .计次循环首 (列数, 计次) ' 不加入序号
        5.置字体属性 (相加 (计次, 1), 1, 1, 1) ' 粗体字
        5.置文本 (相加 (计次, 1), 打印列名称 [计次])
        赋值 (列宽, 相加 (高级表格_列宽数组 [计次], 取整 (相乘 (列比值, 高级表格_列宽数组 [计次]))))
        相加 (计次, 1).置列宽 (1, 列宽)
        赋值 (总列宽, 相加 (总列宽, 列宽))
    .计次循环尾 ()
    
.如果结束

.如果真 (等于 (.选中, 真))
    相加 (计次, 1).置列宽 (2, 50)
.如果真结束

赋值 (行数, 相减 (高级表格., 1))

5.置行高 (1, 相乘 (到数值 (.内容), 10))
赋值 (i, 1)
.计次循环首 (行数, 计次)
    .添加行 ()
    取行数 ().置行高 (1, 相乘 (到数值 (.内容), 10))
    .如果真 (并且 (等于 (.选中, 真), 不等于 (计次, 行数)))
        取行数 ().置文本 (2, 到文本 (i))
        赋值 (i, 相加 (i, 1))
    .如果真结束
    
    .判断开始 (等于 (.选中, 真))
        .计次循环首 (相减 (列数, 1), 计次一)
            赋值 (单元格文本, 到文本 (高级表格.未知支持库函数_10 (计次, 打印列索引 [计次一])))
            取行数 ().置文本 (相加 (计次一, 2), 单元格文本)
        .计次循环尾 ()
        
    .默认
        .计次循环首 (列数, 计次一)
            赋值 (单元格文本, 到文本 (高级表格.未知支持库函数_10 (计次, 打印列索引 [计次一])))
            取行数 ().置文本 (相加 (计次一, 1), 单元格文本)
        .计次循环尾 ()
        
    .判断结束
    
    
    
.计次循环尾 ()
1.置列宽 (1, 1)
赋值 (打印设置, 取打印设置 ())
赋值 (打印设置.纸张类型, .取项目数值 (.现行选中项))
赋值 (打印设置.纸张方向, .现行选中项)
赋值 (打印设置.上边距, 相乘 (到数值 (.内容), 10))
赋值 (打印设置.下边距, 相乘 (到数值 (.内容), 10))
赋值 (打印设置.左边距, 相乘 (到数值 (.内容), 10))
赋值 (打印设置.右边距, 相乘 (到数值 (.内容), 10))
.如果 (等于 (.现行选中项, 0))
    赋值 (打印设置.自动填充, 真)
.否则
    赋值 (打印设置.自动填充, 假)
.如果结束
赋值 (打印设置.页号位置, #下中页号)
赋值 (打印设置.奇偶页方式, 0)
.如果真 (不等于 (.内容, “”))
    赋值 (打印设置.每页打印行数, 到数值 (.内容))
.如果真结束
赋值 (打印设置.打印缩放比, -1) ' 自动压缩到纸张宽度
打印设置.置打印设置 ()
5.置表头行数 ()
.判断开始 (等于 (.选中, 真))
    5.加线条 (2, 相减 (取行数 (), 4), 取列数 (), 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))
.判断 (等于 (.选中, 真))
    5.加线条 (2, 1, 取列数 (), 相加 (#左边框, #上边框, #右边框, #下边框))
    5.加线条 (2, 相减 (取行数 (), 4), 取列数 (), 相加 (#左边框, #上边框, #右边框, #下边框))
.判断 (等于 (.选中, 真))
    5.加线条 (2, 相减 (取行数 (), 4), 取列数 (), 相加 (#左边框, #上边框, #右边框, #下边框, #水平线))
.判断 (等于 (.选中, 真))
    5.加线条 (2, 1, 取列数 (), 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))
    6.加线条 (2, 行数, 取列数 (), 相加 (#左边框, #上边框, #右边框, #下边框, #垂直线))
.默认
    
.判断结束

3.置字体名 (1, 1, 取列数 (), 标题字体 [1])
3.置字体尺寸 (1, 1, 取列数 (), 相乘 (到数值 (标题字体 [2]), 5))

.如果真 (不等于 (.内容, “”))
    5.置字体尺寸 (2, 相加 (行数, 1), 列数, 到数值 (.内容))
    
.如果真结束
5.置对齐方式 (2, 6, 列数, 5)

6.置对齐方式 (2, 相加 (行数, 1), 列数, 4)
赋值 (.可视, 假)
赋值 (., 假)
赋值 (.数据源, “数据源”)
打印预览 ()
恢复鼠标 ()
搜索子窗口 ()
赋值 (.时钟周期, 200)

.子程序 搜索子窗口, 空白型, , 
.局部变量 cd, 整数型, , , 
.局部变量 cd1, 整数型, , , 
.局部变量 wb, 文本型, , , 
.局部变量 win, 整数型, , , 
.局部变量 bx, 整数型, , , 
.局部变量 ff, 整数型, , , 
.局部变量 n, 逻辑型, , , 

赋值 (win, 查找窗口 (0, 0, 0, 0))
赋值 (子窗口句柄, 0)
.判断循环首 (不等于 (win, 0))
    赋值 (cd, getcd (win))
    处理事件 ()
    .如果真 (大于或等于 (cd, 1))
        赋值 (wb, 取空白文本 (相加 (cd, 1)))
        赋值 (cd1, gettext (win, wb, 取文本长度 (wb)))
        .如果 (等于 (wb, “打印预览”))
            赋值 (子窗口句柄, win)
            跳出循环 ()
        .否则
            
        .如果结束
        
    .如果真结束
    赋值 (win, 查找窗口 (0, win, 0, 0))
.判断循环尾 ()

.子程序 _时钟2_周期事件, 空白型, , 
.如果 (等于 (子窗口句柄, 0))
    赋值 (.时钟周期, 0)
    销毁 ()
.否则
    搜索子窗口 ()
.如果结束


.子程序 _全部选择框_被单击, 空白型, , 
.局部变量 计次, 空白型, , , 

.如果 (等于 (.选中, 真))
    .计次循环首 (取项目数 (), 计次)
        相减 (计次, 1).选中项目 (真)
    .计次循环尾 ()
.否则
    .计次循环首 (取项目数 (), 计次)
        相减 (计次, 1).选中项目 (假)
    .计次循环尾 ()
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 文件名, 文本型, , , 

赋值 (.类型, 1)
赋值 (.过滤器, “EXCEL文件|*.xls”)
赋值 (.默认文件后缀, “.xls”)
.如果真 (取反 (打开 ()))
    返回 ()
.如果真结束
赋值 (文件名, .文件名)
赋值 (.标题, “正在导出EXCEL文件请稍候...”)
赋值 (.可视, 真)
.如果 (等于 (导出高级表格数据_SUPERREN (_启动窗口., 文件名), 0))
    信息框 (“导出成功！”, 64, )
.否则
    信息框 (“导出失败！”, 64, )
.如果结束
赋值 (.可视, 假)

.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 导出高级表格数据_SUPERREN, 整数型, , 可将高级表格的数据导出来MDB及XLS文件
.参数 高级表格, 未知类型0x40001, , 
.参数 保存文件名, 文本型, , 根据欲保存的文件扩展名导出目标格式。



.子程序 导出超级列表框数据_SUPERREN, 空白型, , 可将超级列表框的数据导出来MDB及XLS文件
.参数 超级列表框, 超级列表框, , 
.参数 保存文件名, 文本型, , 根据欲保存的文件扩展名导出目标格式。




 ' 不属于任何一个程序集、类模块的函数：
