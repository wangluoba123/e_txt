 ' 文件类型：Windows窗口程序

 ' 程序名称：易算
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 749
    高度 = 510
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\易算.e\_启动窗口_底图
    图标 =  ' 已保存到：D:\易语言学习\Data\易算.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “易算 v1.0”
    帮助文件名 = “”

窗口 设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 500
    高度 = 288
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\易算.e\设置窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “设置”
    帮助文件名 = “”

窗口 计算窗口
    左边 = 50
    顶边 = 50
    宽度 = 500
    高度 = 288
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 9764826 '  0x94FFDA
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “无限时练习模式”
    帮助文件名 = “”

窗口 关于作者窗口
    左边 = 50
    顶边 = 50
    宽度 = 400
    高度 = 228
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\易算.e\关于作者窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于作者”
    帮助文件名 = “”

窗口 成绩窗口
    左边 = 50
    顶边 = 50
    宽度 = 289
    高度 = 419
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 9764826 '  0x94FFDA
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\易算.e\成绩窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “成绩如下：”
    帮助文件名 = “”

窗口 信息框窗口
    左边 = 50
    顶边 = 50
    宽度 = 265
    高度 = 183
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “输入”
    帮助文件名 = “”



.图片 成绩, " ' 已保存到：D:\易语言学习\Data\易算.e\成绩", , 
.图片 主界面, " ' 已保存到：D:\易语言学习\Data\易算.e\主界面", , 
.图片 数字图片, " ' 已保存到：D:\易语言学习\Data\易算.e\数字图片", , 
.图片 符号图片, " ' 已保存到：D:\易语言学习\Data\易算.e\符号图片", , 
.图片 下一题, " ' 已保存到：D:\易语言学习\Data\易算.e\下一题", , 
.图片 判断, " ' 已保存到：D:\易语言学习\Data\易算.e\判断", , 
.图片 成绩数据, " ' 已保存到：D:\易语言学习\Data\易算.e\成绩数据", , 
.图片 关于窗口, " ' 已保存到：D:\易语言学习\Data\易算.e\关于窗口", , 
.声音 声音1, " ' 已保存到：D:\易语言学习\Data\易算.e\声音1", , 
.声音 声音2, " ' 已保存到：D:\易语言学习\Data\易算.e\声音2", , 
.声音 声音3, " ' 已保存到：D:\易语言学习\Data\易算.e\声音3", , 
.声音 声音4, " ' 已保存到：D:\易语言学习\Data\易算.e\声音4", , 
.声音 声音5, " ' 已保存到：D:\易语言学习\Data\易算.e\声音5", , 
.声音 声音6, " ' 已保存到：D:\易语言学习\Data\易算.e\声音6", , 
.声音 声音7, " ' 已保存到：D:\易语言学习\Data\易算.e\声音7", , 
.声音 声音8, " ' 已保存到：D:\易语言学习\Data\易算.e\声音8", , 
.声音 声音9, " ' 已保存到：D:\易语言学习\Data\易算.e\声音9", , 
.声音 对声, " ' 已保存到：D:\易语言学习\Data\易算.e\对声", , 
.声音 错声, " ' 已保存到：D:\易语言学习\Data\易算.e\错声", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库
 ' ExtMenu 9909FBB013704cfa8FE7E739DB7172DE 1 6 超级菜单支持库
 ' iext6 {E60056EA-07A8-4bf5-B6F0-DF05DE6FAE1F} 1 1 扩展界面支持库六




.全局变量 前数, 整数型, , , 
.全局变量 符号, 整数型, , , 
.全局变量 后数, 整数型, , , 
.全局变量 图片号, 整数型, , , 
.全局变量 答案长度, 整数型, , , 
.全局变量 答案, 文本型, , , 
.全局变量 等级, 文本型, , , 
.全局变量 人数, 整数型, , , 
.全局变量 时间, 整数型, , , 
.全局变量 姓名, 文本型, , , 
.全局变量 记分, 逻辑型, , , 
.全局变量 错题, 逻辑型, , , 

.窗口程序集 启动窗口程序集, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 图形按钮, 图形按钮, , , 
.局部变量 标记, 整数型, , , 

.如果真 (等于 (文件是否存在 (相加 (取运行目录 (), “\成绩数据.dll”)), 假)) ' 连接成绩数据.dll这个数据库，如果没有就写到文件。
    写到文件 (相加 (取运行目录 (), “\成绩数据.dll”), #成绩数据) ' 如果找不到成绩数据这个数据库那就从资源表中写出到硬盘
.如果真结束
相加 (取运行目录 (), “\成绩数据.dll”).打开MDB数据库 () ' 连接数据库
_启动窗口.执行 (., “delete from 成绩表”, ) ' 删除成绩表里的所有数据,当程序运行关进程时可以用到
未知支持库函数_0 (2)
置外形图片 (#主界面, #白色)
赋值 (.可视, 假)
置随机数种子 ()
.如果 (等于 (读配置项 (相加 (取运行目录 (), “\sys.ini”), “音乐设置”, “选中项”, ), “”))
    音乐播放 (取随机数 (2, 10))
.否则
    音乐播放 (到数值 (读配置项 (相加 (取运行目录 (), “\sys.ini”), “音乐设置”, “选中项”, ))) ' 读上次播放过的音乐
.如果结束
载入 (假)
.变量循环首 (2, 4, 1, )
    赋值 (取标记组件 ()) ' 组件标记的使用
    事件转移 ()
.变量循环尾 ()

.子程序 __启动窗口_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _音乐关_被选择, 空白型, , 
音乐播放 (1)

.子程序 _音乐一_被选择, 空白型, , 
音乐播放 (2)

.子程序 _音乐二_被选择, 空白型, , 
音乐播放 (3)

.子程序 _音乐三_被选择, 空白型, , 
音乐播放 (4)

.子程序 _音乐四_被选择, 空白型, , 
音乐播放 (5)

.子程序 _音乐五_被选择, 空白型, , 
音乐播放 (6)

.子程序 _音乐六_被选择, 空白型, , 
音乐播放 (7)

.子程序 _音乐七_被选择, 空白型, , 
音乐播放 (8)

.子程序 _音乐八_被选择, 空白型, , 
音乐播放 (9)

.子程序 _音乐九_被选择, 空白型, , 
音乐播放 (10)

.子程序 音乐播放, 空白型, , 
.参数 音乐号, 整数型, , 

.局部变量 音乐名, 菜单, , , 

停止播放 () ' 不管在不在放音乐,先停止再说
播放音乐 (多项选择 (音乐号, {  }, #声音1, #声音2, #声音3, #声音4, #声音5, #声音6, #声音7, #声音8, #声音9), 真) ' 根据音乐号这个参数来选择放哪首音乐
连续赋值 (假, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中)
赋值 (音乐名, 多项选择 (音乐号, , , , , , , , , , ))
赋值 (音乐名.选中, 真)
写配置项 (相加 (取运行目录 (), “\sys.ini”), “音乐设置”, “选中项”, 到文本 (音乐号)) ' 把现在所播放的音项写入配置项以便下次运行时可以读取

.子程序 _系统帮助_被选择, 空白型, , 
未知支持库函数_6 (相加 (取运行目录 (), “\help.chm”), , ) ' 运行程序的帮助程序

.子程序 _关于作者_被选择, 空白型, , 
载入 (关于作者窗口, , 真) ' 将关于作者窗口载入

.子程序 _退出系统_被选择, 空白型, , 
退出系统 ()

.子程序 _无限图形按钮_被单击, 空白型, , 
.局部变量 按钮, 图形按钮, , , 
.局部变量 取出的标记, 整数型, , , 

赋值 (按钮, 取事件组件 ())
赋值 (取出的标记, 到数值 (按钮.标记))
.判断开始 (等于 (取出的标记, 1)) ' 点的是标记为1的那个按钮
    .如果真 (等于 (记分, 真))
        .如果真 (等于 (信息框 (“您现在正在进行多人计分模式，退出将消除以有的成绩”, 1, “提示”), #取消钮))
            返回 ()
        .如果真结束
        
    .如果真结束
    图形按钮单击 (“无限”)
    赋值 (.禁止, 假) ' 三个功能按钮用透明标签来进行用户对其可操作还是不可操作当透明标签禁止为真时按钮不可操作,相反就可操作
    连续赋值 (真, .禁止, .禁止)
    赋值 (记分, 假)
.判断 (等于 (取出的标记, 2))
    .如果真 (等于 (记分, 真))
        .如果真 (等于 (信息框 (“您现在正在进行多人计分模式，退出将消除以有的成绩”, 1, “提示”), #取消钮))
            返回 ()
        .如果真结束
        
    .如果真结束
    图形按钮单击 (“限时”)
    赋值 (.禁止, 假)
    连续赋值 (真, .禁止, .禁止)
    赋值 (记分, 假)
.判断 (等于 (取出的标记, 3))
    图形按钮单击 (“多人计时”)
    赋值 (.禁止, 假)
    连续赋值 (真, .禁止, .禁止)
.默认
    退出系统 ()
.判断结束


.子程序 _时钟1_周期事件, 空白型, , 
.局部变量 SQL, 文本型, , , 
.局部变量 成绩, 整数型, , , 

.如果真 (小于或等于 (_启动窗口., “0”)) ' 当人数小于等于0时就弹出出错信息框
    信息框 (“人数不能为0”, 16, “错误”)
    返回 ()
.如果真结束
赋值 (计算窗口.., 相加 (计算窗口.., 1)) ' 进度条的位置增加
.如果真 (等于 (计算窗口.., 计算窗口..))
    连续赋值 (0, 计算窗口.., .时钟周期)
    信息框 (相加 (“正确题数：”, 计算窗口..标题, #换行符, “错误题数：”, 计算窗口..标题, #换行符), 64, “测试完成！”)
    赋值 (成绩, 相减 (相乘 (到数值 (计算窗口..标题), 10), 相乘 (到数值 (计算窗口..标题), 10)))
    .如果真 (小于 (成绩, 0))
        赋值 (成绩, 0)
    .如果真结束
    
    .如果真 (等于 (_启动窗口..标记, “无限”))
        赋值 (_启动窗口..可视, 假)
        计算窗口.销毁 ()
        返回 ()
    .如果真结束
    .如果 (等于 (_启动窗口..标记, “多人计时”))
        赋值 (_启动窗口., 到文本 (相减 (到数值 (_启动窗口.), 1)))
        赋值 (SQL, 相加 (“INSERT INTO 成绩表([姓名],[成绩]) values('”, 姓名, “','”, 到文本 (成绩), “')”)) ' SQL语句，是加入信息，具体请查阅相关资料
        _启动窗口.执行 (., SQL, ) ' 运行非查询类的SQL语句，如要用查询如 select...这就得用到外部数据库.查询
        .如果 (小于或等于 (_启动窗口., “0”)) ' 判断接下去想测试的人还有没有，如果没有就载入成绩窗口
            载入 (成绩窗口, , 假)
            赋值 (记分, 假)
            赋值 (_启动窗口..可视, 假)
            计算窗口.销毁 ()
            连续赋值 (真, .禁止, .禁止, .禁止)
        .否则
            赋值 (设置窗口..内容, _启动窗口.)
            连续赋值 (真, 设置窗口..禁止, 设置窗口..禁止, 设置窗口..禁止, 设置窗口..禁止)
            计算窗口.销毁 ()
        .如果结束
        
    .否则
        赋值 (_启动窗口..可视, 假)
        计算窗口.销毁 ()
        连续赋值 (真, .禁止, .禁止, .禁止)
    .如果结束
    
.如果真结束


.子程序 __启动窗口_可否被关闭, 逻辑型, , 
.如果真 (等于 (信息框 (“真要退出吗？”, 33, “询问”), #取消钮))
    返回 (假)
.如果真结束
_启动窗口.执行 (., “delete from 成绩表”, ) ' 删除成绩表里的所有数据
返回 (真)

.窗口程序集 设置窗口程序集, , , 

.子程序 _开始按钮_被单击, 空白型, , 
.判断开始 (.选中)
    赋值 (等级, “初级”)
.判断 (.选中)
    赋值 (等级, “中级”)
.判断 (.选中)
    赋值 (等级, “高级”)
.默认
    信息框 (“请选择一种难度！”, 48, “系统提示”)
    返回 ()
.判断结束

.如果 (不等于 (_启动窗口..标记, “多人计时”))
    开始初始 ()
.否则
    赋值 (答案, “”)
    载入 (信息框窗口, , 真)
.如果结束


.子程序 _设置窗口_创建完毕, 空白型, , 
设置父窗口 (设置窗口)
事件转移 () ' 把时间编辑框中的事件转移动人数编辑框中

.子程序 _设置窗口_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

__启动窗口_鼠标右键被放开 (取鼠标水平位置 (), 取鼠标垂直位置 (), 0)

.子程序 _时间编辑框_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.局部变量 编辑框, 编辑框, , , 

赋值 (编辑框, 取事件组件 ()) ' 取出此事件发生的组件
.如果 (或者 (等于 (取文本长度 (编辑框.内容), 0), 等于 (编辑框.被选择字符数, 取文本长度 (编辑框.内容)), 等于 (编辑框.起始选择位置, 0)))
    .如果真 (取反 (或者 (并且 (大于 (字符代码, 48), 小于或等于 (字符代码, 57)), 等于 (字符代码, #退格键))))
        返回 (0)
    .如果真结束
    
.否则
    .如果真 (取反 (或者 (并且 (大于或等于 (字符代码, 48), 小于或等于 (字符代码, 57)), 等于 (字符代码, #退格键))))
        返回 (0)
    .如果真结束
    
.如果结束


.子程序 _设置窗口_可否被关闭, 逻辑型, , 
返回 (假)

.窗口程序集 计算窗口程序集, , , 

.子程序 _计算窗口_创建完毕, 空白型, , 
设置父窗口 (计算窗口)

.子程序 _计算窗口_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

字符写入 (字符代码)

.子程序 _下一题按钮_被单击, 空白型, , 判断等级和对错
赋值 (.图片, {  })
.如果真 (不等于 (答案, “”))
    .如果 (等于 (., #判断))
        .判断开始 (等于 (等级, “初级”))
            .如果 (等于 (符号, 0))
                .如果 (等于 (到数值 (答案), 相加 (前数, 后数)))
                    对 ()
                .否则
                    错 ()
                .如果结束
                
            .否则
                .如果 (并且 (等于 (到数值 (答案), 相减 (前数, 后数)), 不等于 (答案, “”)))
                    对 ()
                .否则
                    错 ()
                .如果结束
                
            .如果结束
            
        .判断 (等于 (等级, “中级”))
            .如果 (等于 (符号, 2))
                .如果 (等于 (到数值 (答案), 相乘 (前数, 后数)))
                    对 ()
                .否则
                    错 ()
                .如果结束
                
            .否则
                .如果 (等于 (到数值 (答案), 相除 (前数, 后数)))
                    对 ()
                .否则
                    错 ()
                .如果结束
                
            .如果结束
            
        .判断 (等于 (符号, 0))
            .如果 (等于 (到数值 (答案), 相加 (前数, 后数)))
                对 ()
            .否则
                错 ()
            .如果结束
            
        .判断 (等于 (符号, 1))
            .如果 (并且 (等于 (到数值 (答案), 相减 (前数, 后数)), 不等于 (答案, “”)))
                对 ()
            .否则
                错 ()
            .如果结束
            
        .判断 (等于 (符号, 2))
            .如果 (等于 (到数值 (答案), 相乘 (前数, 后数)))
                对 ()
            .否则
                错 ()
            .如果结束
            
        .默认
            .如果 (等于 (到数值 (答案), 相除 (前数, 后数)))
                对 ()
            .否则
                错 ()
            .如果结束
            
        .判断结束
        赋值 (., #下一题)
        .如果真 (并且 (等于 (., #下一题), 等于 (_启动窗口..标记, “多人计时”)))
            赋值 (.时钟周期, 1000)
        .如果真结束
        
    .否则
        赋值 (答案长度, 0) ' 把答案长度和答案赋为0和空串以便下次再用
        赋值 (答案, “”)
        .如果真 (等于 (错题, 真))
            赋值 (.标题, 到文本 (相加 (到数值 (.标题), 1)))
            赋值 (错题, 假)
        .如果真结束
        .判断开始 (等于 (等级, “初级”))
            初级 ()
        .判断 (等于 (等级, “中级”))
            中级 ()
        .默认
            高级 ()
        .判断结束
        赋值 (., #判断)
    .如果结束
    返回 ()
.如果真结束
信息框 (“答案不能为空请输入答案再判断！”, 64, “请输入答案”)
赋值 (_启动窗口..可视, 假)
赋值 (_启动窗口..可视, 真)

.子程序 _下一题按钮_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

字符写入 (字符代码)

.子程序 _画板1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

字符写入 (字符代码)


.子程序 _画板1_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

__启动窗口_鼠标右键被放开 (取鼠标水平位置 (), 取鼠标垂直位置 (), 0)

.子程序 _计算窗口_可否被关闭, 逻辑型, , 
返回 (假)

.子程序 _时钟1_周期事件, 空白型, , 
_下一题按钮_被单击 ()
赋值 (.时钟周期, 0)


.程序集 公用程序集, , , 

.程序集变量 数组, 整数型, , "0", 
.程序集变量 计次, 整数型, , , 
.子程序 初级, 空白型, , 
初始画板符号 ()
赋值 (前数, 取随机数 (0, 9)) ' 取前面的数
赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 前数, 9830363)))
计算窗口.画图片 (., 图片号, 45, 30, , , )
赋值 (符号, 取随机数 (0, 1)) ' 运算符号
赋值 (图片号, 载入图片 (未知支持库函数_31 (#符号图片, 符号, 9830363)))
计算窗口.画图片 (., 图片号, 121, 30, , , )
.如果 (等于 (符号, 1)) ' 当符号为减时,那后面的数就要取的比前面的小,因为这里不做负数题
    赋值 (后数, 取随机数 (0, 前数)) ' 后面的数
    赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 后数, 9830363)))
    计算窗口.画图片 (., 图片号, 190, 30, , , )
.否则
    赋值 (后数, 取随机数 (0, 9))
    赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 后数, 9830363)))
    计算窗口.画图片 (., 图片号, 190, 30, , , )
.如果结束


.子程序 图形按钮单击, 空白型, , 
.参数 文本, 文本型, , 

 ' _启动窗口.画板1.可视 ＝ 假
赋值 (错题, 假)
赋值 (_启动窗口..时钟周期, 0)
赋值 (_启动窗口..标记, 文本)
连续赋值 (假, 设置窗口..禁止, 设置窗口..禁止, 设置窗口..禁止, 设置窗口..禁止)
.判断开始 (等于 (_启动窗口..标记, “无限”))
    连续赋值 (真, 设置窗口..禁止, 设置窗口..禁止) ' 当是无限练习模式时时间编辑框和人数编辑框是不可操作的
.判断 (等于 (_启动窗口..标记, “限时”))
    赋值 (设置窗口..禁止, 真) ' 限时练习时人数编辑框可操作而时间编辑框不可操作
    赋值 (设置窗口..禁止, 假)
.默认
    连续赋值 (假, 设置窗口..禁止, 设置窗口..禁止) ' 这个是多人计分,两者都是可以操作的
.判断结束
赋值 (等级, “初级”)
赋值 (设置窗口..内容, “5”)
赋值 (设置窗口..内容, “10”) ' 时间和人数的初始值
设置窗口.调整层次 (1)
赋值 (_启动窗口..可视, 真)

.子程序 退出系统, 空白型, , 
.如果真 (等于 (信息框 (“真要退出吗？”, 33, “询问”), #取消钮))
    设置窗口.调整层次 (1)
    返回 ()
.如果真结束
_启动窗口.执行 (., “delete from 成绩表”, ) ' 删除成绩表里的所有数据
结束 ()

.子程序 中级, 空白型, , 
初始画板符号 ()
赋值 (前数, 取随机数 (0, 9))
赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 前数, 9830363)))
计算窗口.画图片 (., 图片号, 45, 30, , , )
赋值 (符号, 取随机数 (2, 3))
赋值 (图片号, 载入图片 (未知支持库函数_31 (#符号图片, 符号, 9830363)))
计算窗口.画图片 (., 图片号, 121, 30, , , )
.如果 (并且 (等于 (符号, 3), 不等于 (前数, 0)))
    清除数组 (数组)
    .变量循环首 (1, 前数, 1, 计次) ' 取出能整除前数的所有数,选其中的一个做为后数来整除
        .如果真 (等于 (求余数 (前数, 计次), 0))
            加入成员 (数组, 计次)
        .如果真结束
        
    .变量循环尾 ()
    赋值 (后数, 数组 [取随机数 (1, 取数组成员数 (数组))]) ' 在找出来的能整除的数中再随机抽出一个数来当后数
    赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 后数, 9830363)))
    计算窗口.画图片 (., 图片号, 190, 30, , , )
.否则
    赋值 (后数, 取随机数 (0, 9))
    赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 后数, 9830363)))
    计算窗口.画图片 (., 图片号, 190, 30, , , )
.如果结束


.子程序 高级, 空白型, , 
.局部变量 a, 整数型, , , 

初始画板符号 ()
赋值 (符号, 取随机数 (0, 3))
赋值 (图片号, 载入图片 (未知支持库函数_31 (#符号图片, 符号, 9830363)))
计算窗口.画图片 (., 图片号, 121, 30, , , )
赋值 (前数, 取随机数 (0, 99))
.如果 (等于 (取文本长度 (到文本 (前数)), 2)) ' 判断这个随机数是不是两位数
    赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 整除 (前数, 10), 9830363)))
    计算窗口.画图片 (., 图片号, 25, 30, , , )
    赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 相减 (前数, 相乘 (整除 (前数, 10), 10)), 9830363)))
    计算窗口.画图片 (., 图片号, 73, 30, , , )
    .判断开始 (等于 (符号, 0))
        赋值 (后数, 取随机数 (0, 99))
        .如果 (等于 (取文本长度 (到文本 (后数)), 2))
            赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 整除 (后数, 10), 9830363)))
            计算窗口.画图片 (., 图片号, 170, 30, , , )
            赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 相减 (后数, 相乘 (整除 (后数, 10), 10)), 9830363)))
            计算窗口.画图片 (., 图片号, 218, 30, , , )
        .否则
            赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 后数, 9830363)))
            计算窗口.画图片 (., 图片号, 190, 30, , , )
            
        .如果结束
        
    .判断 (等于 (符号, 1))
        赋值 (后数, 取随机数 (0, 前数))
        .如果 (等于 (取文本长度 (到文本 (后数)), 2))
            赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 整除 (后数, 10), 9830363)))
            计算窗口.画图片 (., 图片号, 170, 30, , , )
            赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 相减 (后数, 相乘 (整除 (后数, 10), 10)), 9830363)))
            计算窗口.画图片 (., 图片号, 218, 30, , , )
        .否则
            赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 后数, 9830363)))
            计算窗口.画图片 (., 图片号, 190, 30, , , )
        .如果结束
        
    .判断 (等于 (符号, 2))
        赋值 (后数, 取随机数 (0, 9))
        赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 后数, 9830363)))
        计算窗口.画图片 (., 图片号, 190, 30, , , )
    .判断 (并且 (等于 (符号, 3), 不等于 (前数, 0)))
        清除数组 (数组)
        .变量循环首 (1, 前数, 1, 计次)
            .如果真 (等于 (求余数 (前数, 计次), 0))
                加入成员 (数组, 计次)
            .如果真结束
            
        .变量循环尾 ()
        赋值 (后数, 数组 [取随机数 (1, 取数组成员数 (数组))])
        .如果 (等于 (取文本长度 (到文本 (后数)), 2))
            赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 整除 (后数, 10), 9830363)))
            计算窗口.画图片 (., 图片号, 170, 30, , , )
            赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 相减 (后数, 相乘 (整除 (后数, 10), 10)), 9830363)))
            计算窗口.画图片 (., 图片号, 218, 30, , , )
        .否则
            赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 后数, 9830363)))
            计算窗口.画图片 (., 图片号, 190, 30, , , )
        .如果结束
        
    .默认
        
    .判断结束
    
.否则
    赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 前数, 9830363)))
    计算窗口.画图片 (., 图片号, 45, 30, , , )
    .判断开始 (等于 (符号, 0))
        赋值 (后数, 取随机数 (1, 99))
        .如果 (等于 (取文本长度 (到文本 (后数)), 2))
            赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 整除 (后数, 10), 9830363)))
            计算窗口.画图片 (., 图片号, 170, 30, , , )
            赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 相减 (后数, 相乘 (整除 (后数, 10), 10)), 9830363)))
            计算窗口.画图片 (., 图片号, 218, 30, , , )
        .否则
            赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 后数, 9830363)))
            计算窗口.画图片 (., 图片号, 190, 30, , , )
            
        .如果结束
        
    .判断 (等于 (符号, 1))
        赋值 (后数, 取随机数 (0, 前数))
        赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 后数, 9830363)))
        计算窗口.画图片 (., 图片号, 190, 30, , , )
    .判断 (等于 (符号, 2))
        赋值 (后数, 取随机数 (1, 99))
        .如果 (等于 (取文本长度 (到文本 (后数)), 2))
            赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 整除 (后数, 10), 9830363)))
            计算窗口.画图片 (., 图片号, 170, 30, , , )
            赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 相减 (后数, 相乘 (整除 (后数, 10), 10)), 9830363)))
            计算窗口.画图片 (., 图片号, 218, 30, , , )
        .否则
            赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 后数, 9830363)))
            计算窗口.画图片 (., 图片号, 190, 30, , , )
        .如果结束
        
    .判断 (并且 (等于 (符号, 3), 不等于 (前数, 0))) ' 除数是不能为0的
        清除数组 (数组)
        .变量循环首 (1, 前数, 1, 计次)
            .如果真 (等于 (求余数 (前数, 计次), 0))
                加入成员 (数组, 计次)
            .如果真结束
            
        .变量循环尾 ()
        赋值 (后数, 数组 [取随机数 (1, 取数组成员数 (数组))])
        赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 后数, 9830363)))
        计算窗口.画图片 (., 图片号, 190, 30, , , )
    .默认
        赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 后数, 9830363)))
        计算窗口.画图片 (., 图片号, 190, 30, , , )
        
    .判断结束
    
.如果结束


.子程序 初始画板符号, 空白型, , 
计算窗口.清除 (., 0, 0, 496, 184)
赋值 (图片号, 载入图片 (未知支持库函数_31 (#符号图片, 4, 9830363)))
计算窗口.画图片 (., 图片号, 265, 30, , , )
赋值 (图片号, 载入图片 (未知支持库函数_31 (#符号图片, 5, 9830363)))
计算窗口.画图片 (., 图片号, 320, 30, , , )
置随机数种子 ()

.子程序 长度大于0, 空白型, , 
计算窗口.清除 (., 相加 (320, 相乘 (50, 相减 (答案长度, 1))), 30, 60, 100) ' 当按退格键时删除最后一幅图片
赋值 (答案长度, 相减 (答案长度, 1)) ' 答案长度自减
赋值 (答案, 取文本左边 (答案, 答案长度))

.子程序 开始初始, 空白型, , 
.如果真 (等于 (是否已创建 (计算窗口), 假))
    载入 (计算窗口, , 假)
.如果真结束
_启动窗口.清除 (., , , , )
赋值 (答案, “”)
连续赋值 (0, 计算窗口.., 答案长度)
连续赋值 (“0”, 计算窗口..标题, 计算窗口..标题)
赋值 (_启动窗口., 设置窗口..内容)
计算窗口.清除 (., , , , )
赋值 (计算窗口..图片, {  })
设置窗口.调整层次 (2)
.如果 (等于 (_启动窗口..标记, “无限”))
    连续赋值 (假, 计算窗口..可视, 计算窗口..)
.否则
    连续赋值 (真, 计算窗口..可视, 计算窗口..)
    赋值 (_启动窗口..时钟周期, 1000)
    赋值 (人数, 到数值 (设置窗口..内容))
    赋值 (时间, 相乘 (到数值 (设置窗口..内容), 60))
    赋值 (计算窗口.., 时间) ' 时间限制
.如果结束
.判断开始 (等于 (等级, “初级”))
    初级 ()
.判断 (等于 (等级, “中级”))
    中级 ()
.默认
    赋值 (等级, “高级”)
    高级 ()
.判断结束
计算窗口.获取焦点 (.)


.子程序 设置父窗口, 空白型, , 
.参数 窗口, 窗口, , 

窗口.置父窗口 (_启动窗口.)
窗口.移动 (0, 0, , )

.子程序 对, 空白型, , 判断对错图
赋值 (错题, 假)
赋值 (计算窗口..标题, 到文本 (相加 (到数值 (计算窗口..标题), 1))) ' 当用户答对时就显示对号并播放相应的声音
赋值 (计算窗口..图片, 未知支持库函数_31 (#符号图片, 7, 9830363))
播放音乐 (#对声, 假)

.子程序 错, 空白型, , 判断对错图
.如果 (等于 (_启动窗口..标记, “多人计时”))
    赋值 (计算窗口..标题, 到文本 (相加 (到数值 (计算窗口..标题), 1))) ' 当用户答对时就显示对号并播放相应的声音
    赋值 (计算窗口..图片, 未知支持库函数_31 (#符号图片, 6, 9830363))
    播放音乐 (#错声, 假)
.否则
    赋值 (错题, 真) ' 用来判断当前做的题是不是做错了如果做错了那再错的话就不会再加1
    赋值 (计算窗口..图片, 未知支持库函数_31 (#符号图片, 6, 9830363))
    播放音乐 (#错声, 假)
.如果结束


.子程序 字符写入, 空白型, , 
.参数 参数, 整数型, , 

.如果真 (等于 (参数, #回车键)) ' 使打回车也可以判断对错和继续下一题
    _下一题按钮_被单击 ()
.如果真结束
.如果 (并且 (小于或等于 (参数, 57), 大于或等于 (参数, 48), 不等于 (取文本左边 (答案, 1), “0”), 等于 (计算窗口..图片, {  }))) ' 只能输入0-9这几个数
    赋值 (计算窗口.., #判断)
    .如果真 (小于 (答案长度, 3))
        赋值 (图片号, 载入图片 (未知支持库函数_31 (#数字图片, 相减 (参数, 48), 9830363)))
        计算窗口.画图片 (., 图片号, 相加 (320, 相乘 (50, 答案长度)), 30, , , )
        赋值 (答案, 相加 (答案, 字符 (参数)))
        赋值 (答案长度, 相加 (答案长度, 1))
    .如果真结束
    
.否则
    .如果真 (或者 (并且 (等于 (参数, #退格键), 不等于 (计算窗口..图片, 未知支持库函数_31 (#符号图片, 7, 9830363)), 不等于 (_启动窗口..标记, “多人计时”)), 等于 (计算窗口..图片, {  }))) ' 按退格就删相应的图片
        
        赋值 (计算窗口.., #判断)
        赋值 (计算窗口..图片, {  })
        .如果真 (大于 (答案长度, 0))
            长度大于0 ()
        .如果真结束
        
        
    .如果真结束
    
.如果结束





.窗口程序集 关于程序集, , , 

.子程序 _关于作者窗口_创建完毕, 空白型, , 
置外形图片 (#关于窗口, #白色)

.子程序 _关于作者窗口_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

关于作者窗口.销毁 ()

.子程序 _透明标签1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

关于作者窗口.销毁 ()

.窗口程序集 成绩窗口程序集, , , 

.子程序 _成绩窗口_创建完毕, 空白型, , 
.局部变量 句柄, 整数型, , , 
.局部变量 NN, 整数型, , , 

置外形图片 (#成绩, #白色)
赋值 (句柄, _启动窗口.查询 (., “SELECT *  FROM 成绩表  ORDER BY  成绩  DESC”)) ' 此SQL语句为排序语句，为降序
全部删除 ()
_启动窗口.到首记录 (., 句柄)
赋值 (NN, 0)
.判断循环首 (等于 (_启动窗口.尾记录后 (., 句柄), 假)) ' 将数据库里的内容显示在超级列表框1中
    NN.插入表项 (_启动窗口.读 (., 句柄, “编号”))
    NN.置标题 (0, _启动窗口.读 (., 句柄, “姓名”))
    NN.置标题 (1, 到文本 (_启动窗口.读 (., 句柄, “成绩”)))
    _启动窗口.到后一记录 (., 句柄) ' 指向下一打记录
    赋值 (NN, 相加 (NN, 1))
.判断循环尾 ()
_启动窗口.关闭记录集 (., 句柄) ' 用完请记得关闭

.子程序 _超级列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

窗口销毁 ()

.子程序 _成绩窗口_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

窗口销毁 ()

.子程序 _图形按钮1_被单击, 空白型, , 
窗口销毁 ()

.子程序 窗口销毁, 空白型, , 
成绩窗口.销毁 ()

.窗口程序集 信息框程序集, , , 

.子程序 _按钮1_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (“姓名不能为空请重输！”, 16, )
    返回 ()
.如果真结束
赋值 (姓名, .内容)
赋值 (记分, 真)
销毁 ()
开始初始 ()

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()
赋值 (记分, 假)

.子程序 _信息框窗口_创建完毕, 空白型, , 
获取焦点 ()

.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (等于 (字符代码, #空格键))
    返回 (0)
.如果真结束


.子程序 _信息框窗口_可否被关闭, 逻辑型, , 
返回 (假)


 ' 不属于任何一个程序集、类模块的函数：
