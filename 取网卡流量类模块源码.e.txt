 ' 文件类型：Windows模块源码

 ' 程序名称：网卡流量监视类
 ' 程序描述：参考了
http://bbs.eyuyan.com/dispbbs.asp?boardid=124&Id=163727
jiazhida 开源的 GUI版S扫描器
版权归其所有
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 5 系统核心支持库





.DLL命令 取信息表, 整数型, "IPhlpAPI", "GetIfTable", , 网卡流量监视类
    .参数 pIfRowTable, 字节集, 传址, 
    .参数 pdwSize, 整数型, 传址, 
    .参数 bOrder, 整数型, , 

.DLL命令 取信息长, 整数型, "IPhlpAPI", "GetIfTable", , 网卡流量监视类
    .参数 pIfRowTable, 整数型, , 
    .参数 pdwSize, 整数型, 传址, 
    .参数 bOrder, 整数型, , 

.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码
输出调试文本 (“┌----------------------------------┐”)
输出调试文本 (“┊网卡流量监视类                    ┊”)
输出调试文本 (“┊版本V1.0                          ┊”)
输出调试文本 (“┊版权归 jiazhida 所有              ┊”)
输出调试文本 (“┊中国人学编程用什么? 当然是易语言! ┊”)
输出调试文本 (“┊QQ:313288817 整理:By WhiteHack    ┊”)
输出调试文本 (“└----------------------------------┘”)
_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。


.类模块 网卡流量监视类, , , 最好配合时钟使用``第一句 为 取流量信息数

.程序集变量 集_信息长度, 整数型, , , 
.程序集变量 集_缓冲, 字节集, , , 
.程序集变量 集_下载, 逻辑型, , , 
.程序集变量 集_临时缓存, 整数型, , , 
.程序集变量 集_上传, 逻辑型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 _取流量信息数据, 逻辑型, 公开, 取流量信息数据 成功读取返回真  读取失败返回假 写到 第一行  
赋值 (集_临时缓存, 未知函数_167837720 (0, 集_信息长度, 0))
.如果真 (等于 (集_临时缓存, 50))
    返回 (假)
.如果真结束
赋值 (集_缓冲, 取空白字节集 (集_信息长度))
赋值 (集_临时缓存, 未知函数_167837721 (集_缓冲, 集_信息长度, 0))
.如果真 (等于 (集_临时缓存, 0))
    返回 (真)
.如果真结束

返回 (假)


.子程序 取下载字节数, 整数型, 公开, 返回接收字节数```下载
.参数 参考_下载速度, 整数型, 参考 可空, 参考下载速度
.参数 参考_是否下载状态, 逻辑型, 参考 可空, 逻辑型是否下载

.局部变量 局部_接收字节数, 整数型, , , 
.局部变量 局部_下速, 整数型, 静态, , 

赋值 (局部_接收字节数, 取字节集数据 (取字节集中间 (集_缓冲, 1417, 4), 3, ))
赋值 (大于 ())
.如果真 (等于 (是否为空 (), 假))
    赋值 ()
.如果真结束

.如果真 (大于 (局部_下速, 0))
    赋值 (局部_下速, 相减 (局部_接收字节数, 局部_下速))
.如果真结束
.如果真 (等于 (是否为空 (参考_下载速度), 假))
    赋值 (参考_下载速度, 局部_下速)
.如果真结束
赋值 (局部_下速, 局部_接收字节数)
返回 (局部_接收字节数)

.子程序 取上传字节数, 整数型, 公开, 返回发送字节数``上传
.参数 参考_上传速度, 整数型, 参考 可空, 参考 上传速度
.参数 参考_是否上传状态, 逻辑型, 参考 可空, 参考 逻辑型 是否上传

.局部变量 局部_上速, 整数型, 静态, , 
.局部变量 局部_发送字节数, 整数型, , , 

赋值 (局部_发送字节数, 取字节集数据 (取字节集中间 (集_缓冲, 1441, 4), 3, ))
赋值 (大于 ())
.如果真 (等于 (是否为空 (), 假))
    赋值 ()
.如果真结束

.如果真 (大于 (局部_上速, 0))
    赋值 (局部_上速, 相减 (局部_发送字节数, 局部_上速))
.如果真结束

.如果真 (等于 (是否为空 (参考_上传速度), 假))
    赋值 (参考_上传速度, 局部_上速)
.如果真结束
赋值 (局部_上速, 局部_发送字节数)
返回 (局部_发送字节数)


 ' 不属于任何一个程序集、类模块的函数：
