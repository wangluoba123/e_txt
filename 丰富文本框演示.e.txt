 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 652
    高度 = 457
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “丰富文本框演示”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 286
    高度 = 303
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 真
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “QQ表情符”
    帮助文件名 = “”

窗口 窗口2
    左边 = 50
    顶边 = 50
    宽度 = 153
    高度 = 188
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' RichTextBox AB0C74A8CB37422e92FD43B99588EAEF 1 1 丰富文本框




数据类型 POINTAPI, , 
    .成员 x, 空白型, , , 
    .成员 y, 空白型, , , 


.DLL命令 客户区坐标到屏幕坐标_API, 整数型, "", "ClientToScreen", , 
    .参数 hwnd, 空白型, , 
    .参数 lpPoint, POINTAPI, , 

.DLL命令 执行_API, 空白型, "", "ShellExecuteA", , 
    .参数 hwnd, 空白型, , 
    .参数 lpOperation, 文本型, , 
    .参数 lpFile, 文本型, , 
    .参数 lpParameters, 文本型, , 
    .参数 lpDirectory, 文本型, , 
    .参数 nShowCmd, 空白型, , 

.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_尺寸被改变, 空白型, , 
.局部变量 用户区宽度, 整数型, , , 

赋值 (用户区宽度, 取用户区宽度 ())
赋值 (., 用户区宽度)
赋值 (.宽度, 用户区宽度)
赋值 (.顶边, .可视)
赋值 (., 相加 (.可视, .高度))
赋值 (., 相减 (取用户区高度 (), .可视, .高度, .))


.子程序 取字体大小, 文本型, , 
.局部变量 字体大小, 整数型, , , 

赋值 (字体大小, .)
.如果真 (小于 (字体大小, 0)) ' 混合选中
    返回 (“”)
.如果真结束
返回 (到文本 (字体大小))

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 字体大小, 文本型, , "0", 
.局部变量 N, 整数型, , , 
.局部变量 菜单条, 菜单, , , 

赋值 (字体大小, { “8”, “9”, “10”, “11”, “12”, “14”, “16”, “18”, “20”, “22”, “24”, “26”, “28”, “36”, “48”, “72” })
.计次循环首 (取数组成员数 (字体大小), N)
    字体大小.加入项目 ( [N], )
.计次循环尾 ()
赋值 (.内容, 取字体大小 ())
赋值 (., .)
统计文本 ()
置操作状态 ()
.计次循环首 (3, N)
    赋值 (菜单条, 多项选择 (N, , , ))
    事件转移 (菜单条, )
.计次循环尾 ()
赋值 (., 相加 (“丰富文本框演示 - ”, .))
赋值 (.选中, 取反 (.))

.子程序 保存文档, 空白型, , 
.参数 对话框, 逻辑型, , 

.局部变量 扩展名, 文本型, , , 
.局部变量 错误信息, 文本型, , , 


.如果真 (对话框)
    赋值 (.类型, 1)
    赋值 (.标题, “请输入或选择保存的文件名:”)
    .如果 (打开 ())
        赋值 (扩展名, 到大写 (取文本右边 (.文件名, 3)))
        .如果 (等于 (扩展名, “TXT”))
            赋值 (., #)
        .否则
            赋值 (., #)
        .如果结束
        赋值 (., .文件名)
    .否则
        返回 ()
    .如果结束
    
.如果真结束

赋值 (错误信息, .未知支持库函数_37 (.))
.如果 (等于 (错误信息, “”))
    信息框 (“文档已经保存”, #信息图标, )
    赋值 (., 假)
.否则
    信息框 (错误信息, #错误图标, )
.如果结束


.子程序 打开文档, 空白型, , 
.局部变量 扩展名, 文本型, , , 
.局部变量 错误信息, 文本型, , , 

赋值 (.类型, 0)
赋值 (.标题, “请选择要打开的文件:”)
.如果 (打开 ())
    赋值 (扩展名, 到大写 (取文本右边 (.文件名, 3)))
    .如果 (等于 (扩展名, “TXT”))
        赋值 (., #)
    .否则
        赋值 (., #)
    .如果结束
    
.否则
    返回 ()
.如果结束

赋值 (错误信息, .未知支持库函数_36 (.文件名))
.如果 (等于 (错误信息, “”))
    赋值 (., 假)
    统计文本 ()
    赋值 (., 相加 (“丰富文本框演示 - ”, .))
.否则
    信息框 (错误信息, #错误图标, )
.如果结束


.子程序 _保存文档_被选择, 空白型, , 
保存文档 (等于 (., “”))

.子程序 _另存为_被选择, 空白型, , 
保存文档 (真)

.子程序 _打印_被选择, 空白型, , 
未知支持库函数_28 ()

.子程序 _打印预览_被选择, 空白型, , 
未知支持库函数_29 ()

.子程序 _退出_被选择, 空白型, , 
.局部变量 用户选择, 整数型, , , 

.如果真 (.)
    
    赋值 (用户选择, 信息框 (相加 (“当前文档”, ., “文字已经改变”, #换行符, “想保存吗？”), 相加 (#警告图标, #取消是否钮), ))
    
    .判断开始 (等于 (用户选择, #是钮))
        _保存文档_被选择 ()
        返回 ()
    .判断 (等于 (用户选择, #取消钮))
        返回 ()
    .默认
        
    .判断结束
    
.如果真结束
销毁 ()

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
.局部变量 用户选择, 整数型, , , 

.如果真 (.)
    赋值 (用户选择, 信息框 (相加 (“当前文档”, ., “文字已经改变”, #换行符, “想保存吗？”), 相加 (#警告图标, #取消是否钮), ))
    .判断开始 (等于 (用户选择, #是钮))
        _保存文档_被选择 ()
    .判断 (等于 (用户选择, #取消钮))
        返回 (假)
    .默认
        
    .判断结束
    
.如果真结束


.子程序 _打开_被选择, 空白型, , 
.如果真 (.)
    .如果 (等于 (信息框 (“当前文档已经修改,是否保存?”, 相加 (#询问图标, #是否钮), ), #是钮))
        _保存文档_被选择 ()
    .否则
        返回 ()
    .如果结束
    
.如果真结束
打开文档 ()

.子程序 _新建_被选择, 空白型, , 
.如果真 (.)
    .如果真 (等于 (信息框 (“当前文档已经修改,是否保存?”, 相加 (#询问图标, #是否钮), ), #是钮))
        _保存文档_被选择 ()
    .如果真结束
    
.如果真结束
赋值 (., 假)
赋值 (., “”)
赋值 (., “”)
赋值 (., “丰富文本框演示 - 无标题”)

.子程序 _撤消_被选择, 空白型, , 
未知支持库函数_24 ()

.子程序 _重做_被选择, 空白型, , 
未知支持库函数_23 ()

.子程序 _剪切_被选择, 空白型, , 
未知支持库函数_22 ()

.子程序 _复制_被选择, 空白型, , 
未知支持库函数_21 ()

.子程序 _粘贴_被选择, 空白型, , 
未知支持库函数_20 ()

.子程序 _删除_被选择, 空白型, , 
未知支持库函数_26 ()

.子程序 _全选_被选择, 空白型, , 
未知支持库函数_25 ()

.子程序 _查找_被选择, 空白型, , 
#.未知支持库函数_33 ()

.子程序 _查找一下_被选择, 空白型, , 
未知支持库函数_32 ()

.子程序 _替换_被选择, 空白型, , 
#.未知支持库函数_33 ()

.子程序 _字体列表框1_字体列表项被选择, 空白型, , 
赋值 (., .)
获取焦点 ()

.子程序 _字体大小框_列表项被选择, 空白型, , 
.局部变量 字体大小, 整数型, , , 

赋值 (字体大小, 到数值 (.取项目文本 (.现行选中项)))
赋值 (., 字体大小)
获取焦点 ()

.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.局部变量 状态, 整数型, , , 
.局部变量 已加风格, 逻辑型, , , 
.局部变量 扩展名, 文本型, , , 
.局部变量 图片数据, 字节集, , , 

.判断开始 (等于 (按钮索引, 0))
    _新建_被选择 ()
.判断 (等于 (按钮索引, 1))
    _打开_被选择 ()
.判断 (等于 (按钮索引, 2))
    _保存文档_被选择 ()
.判断 (等于 (按钮索引, 3))
    _打印_被选择 ()
    
.判断 (等于 (按钮索引, 4))
    _打印预览_被选择 ()
    
.判断 (等于 (按钮索引, 5))
    _查找_被选择 ()
    
.判断 (并且 (大于 (按钮索引, 6), 小于 (按钮索引, 13))) ' 字体风格
    赋值 (状态, 按钮索引.取状态 ())
    赋值 (已加风格, 等于 (位与 (状态, #选中), #选中))
    .判断开始 (等于 (按钮索引, 7))
        赋值 (., 取反 (已加风格))
    .判断 (等于 (按钮索引, 8))
        赋值 (., 取反 (已加风格))
    .判断 (等于 (按钮索引, 9))
        赋值 (., 取反 (已加风格))
    .判断 (等于 (按钮索引, 10))
        赋值 (., 取反 (已加风格))
    .判断 (等于 (按钮索引, 11))
        赋值 (., 取反 (已加风格))
    .判断 (等于 (按钮索引, 12))
        赋值 (., 取反 (已加风格))
    .默认
        
    .判断结束
    
.判断 (等于 (按钮索引, 13))
    #.未知支持库函数_33 ()
.判断 (等于 (按钮索引, 17))
    _剪切_被选择 ()
.判断 (等于 (按钮索引, 18))
    _复制_被选择 ()
.判断 (等于 (按钮索引, 19))
    _粘贴_被选择 ()
.判断 (等于 (按钮索引, 20))
    _删除_被选择 ()
.判断 (等于 (按钮索引, 21))
    _撤消_被选择 ()
    .如果 (.)
        21.去除状态 (#禁止)
    .否则
        21.加入状态 (#禁止)
    .如果结束
    .如果 (.)
        22.去除状态 (#禁止)
    .否则
        22.加入状态 (#禁止)
    .如果结束
    
.判断 (等于 (按钮索引, 22))
    _重做_被选择 ()
    .如果 (.)
        21.去除状态 (#禁止)
    .否则
        21.加入状态 (#禁止)
    .如果结束
    .如果 (.)
        22.去除状态 (#禁止)
    .否则
        22.加入状态 (#禁止)
    .如果结束
    
.判断 (等于 (按钮索引, 24))
    #.未知支持库函数_1 ()
.判断 (等于 (按钮索引, 25))
    #.未知支持库函数_1 ()
.判断 (等于 (按钮索引, 26))
    #.未知支持库函数_1 ()
.判断 (等于 (按钮索引, 27))
    #.未知支持库函数_9 ()
.判断 (等于 (按钮索引, 28))
    #.未知支持库函数_9 ()
.判断 (等于 (按钮索引, 30))
    未知支持库函数_34 ()
.判断 (等于 (按钮索引, 31))
    .如果真 (打开 ())
        赋值 (扩展名, 到大写 (取文本右边 (.文件名, 3)))
        .如果 (等于 (扩展名, “BMP”)) ' 两种插入图片的方法
            .未知支持库函数_35 (.文件名)
        .否则
            赋值 (图片数据, 读入文件 (.文件名))
            图片数据.未知支持库函数_38 ()
        .如果结束
        
    .如果真结束
    
.判断 (等于 (按钮索引, 32))
    未知支持库函数_41 ()
.判断 (等于 (按钮索引, 33))
    未知支持库函数_42 ()
.默认
    
.判断结束


.子程序 _工具条1_被下拉, 空白型, , 
.参数 按钮索引, 整数型, , 
.参数 下拉横座标, 整数型, , 
.参数 下拉纵座标, 整数型, , 

.局部变量 屏幕坐标, POINTAPI, , , 
.局部变量 X偏移, 空白型, , , 
.局部变量 Y偏移, 整数型, , , 

 ' 修正弹出颜色选择器的位置
客户区坐标到屏幕坐标_API (取窗口句柄 (), 屏幕坐标)
赋值 (X偏移, 相减 (下拉横座标, 屏幕坐标.x))
赋值 (Y偏移, 相减 (下拉纵座标, 屏幕坐标.y))
赋值 (.左边, 相加 (.左边, X偏移))
赋值 (.顶边, 相减 (相加 (.顶边, Y偏移), 20))
.如果真 (等于 (按钮索引, 14))
    赋值 (.颜色, .)
    赋值 (.标记, “文本颜色”)
    514.发送信息 (0, 0)
.如果真结束
.如果真 (等于 (按钮索引, 15))
    赋值 (.颜色, .)
    赋值 (.标记, “背景颜色”)
    514.发送信息 (0, 0)
    
.如果真结束


.子程序 _颜色选择器1_颜色被改变, 空白型, , 
.如果 (等于 (.标记, “文本颜色”))
    赋值 (., .颜色)
.否则
    赋值 (., .颜色)
.如果结束


.子程序 统计文本, 空白型, , 
.局部变量 总数文本, 文本型, , , 

赋值 (总数文本, 相加 (“当前文本长度:”, 到文本 (未知支持库函数_13 ()), “字节  总行数:”, 到文本 (未知支持库函数_14 ()), “行”))
1.置文本 (总数文本)

.子程序 _丰富文本框1_内容被改变, 空白型, , 
统计文本 ()


.子程序 置操作状态, 空白型, , 
.局部变量 N, 整数型, , , 
.局部变量 按钮索引, 整数型, , , 
.局部变量 可操作, 逻辑型, , , 
.局部变量 操作菜单, 菜单, , , 

.计次循环首 (6, N)
    赋值 (按钮索引, 相加 (N, 16))
    .判断开始 (等于 (按钮索引, 17))
        赋值 (可操作, .)
    .判断 (等于 (按钮索引, 18))
        赋值 (可操作, .)
    .判断 (等于 (按钮索引, 19))
        赋值 (可操作, .)
    .判断 (等于 (按钮索引, 20))
        赋值 (可操作, .)
    .判断 (等于 (按钮索引, 21))
        赋值 (可操作, .)
    .判断 (等于 (按钮索引, 22))
        赋值 (可操作, .)
    .默认
        
    .判断结束
    .如果 (等于 (可操作, 假))
        按钮索引.加入状态 (#禁止)
    .否则
        按钮索引.去除状态 (#禁止)
    .如果结束
    赋值 (操作菜单, 多项选择 (N, , , , , , ))
    赋值 (操作菜单.禁止, 取反 (可操作))
.计次循环尾 ()

.子程序 _丰富文本框1_选择区被改变, 空白型, , 
.局部变量 N, 整数型, , , 
.局部变量 按钮索引, 整数型, , , 
.局部变量 已加风格, 逻辑型, , , 

2.置文本 (相加 (“当前行: 第”, 到文本 (.未知支持库函数_18 ()), “行”))
赋值 (.内容, 取字体大小 ())
赋值 (., .)

 ' 设置工具条状态
.计次循环首 (6, N)
    赋值 (按钮索引, 相加 (N, 6))
    
    .判断开始 (等于 (按钮索引, 7))
        赋值 (已加风格, .)
    .判断 (等于 (按钮索引, 8))
        赋值 (已加风格, .)
    .判断 (等于 (按钮索引, 9))
        赋值 (已加风格, .)
    .判断 (等于 (按钮索引, 10))
        赋值 (已加风格, .)
    .判断 (等于 (按钮索引, 11))
        赋值 (已加风格, .)
    .判断 (等于 (按钮索引, 12))
        赋值 (已加风格, .)
    .默认
        
    .判断结束
    .如果 (已加风格)
        按钮索引.加入状态 (#选中)
    .否则
        按钮索引.去除状态 (#选中)
    .如果结束
    
.计次循环尾 ()
置操作状态 ()

.计次循环首 (3, N)
    相加 (N, 23).去除状态 (#选中)
.计次循环尾 ()
赋值 (N, 未知支持库函数_2 ())

.如果 (等于 (N, 2))
    赋值 (N, 3)
.否则
    .如果真 (等于 (N, 3))
        赋值 (N, 2)
    .如果真结束
    
.如果结束
输出调试文本 (相加 (N, 23))
相加 (N, 23).加入状态 (#选中)
.如果 (等于 (未知支持库函数_10 (), #))
    27.加入状态 (#选中)
.否则
    27.去除状态 (#选中)
.如果结束

.如果 (等于 (未知支持库函数_10 (), #))
    28.加入状态 (#选中)
.否则
    28.去除状态 (#选中)
.如果结束


.子程序 _关于_被选择, 空白型, , 
#.未知支持库函数_33 ()

.子程序 _设置背景图片_被选择, 空白型, , 
.局部变量 图片数据, 字节集, , , 

.如果 (等于 (.标题, “设置背景图片”))
    .如果真 (打开 ())
        赋值 (图片数据, 读入文件 (.文件名))
        赋值 (., 图片数据)
        赋值 (.标题, “清除背景图片”)
    .如果真结束
    
.否则
    赋值 (., {  })
    赋值 (.标题, “设置背景图片”)
.如果结束


.子程序 _居上_被选择, 空白型, , 
.局部变量 N, 整数型, , , 
.局部变量 菜单条, 菜单, , , 
.局部变量 被选菜单, 菜单, , , 

 ' 所有图片显示方式的菜单的事件都转移到这里处理
赋值 (被选菜单, 取事件组件 ())
.计次循环首 (4, N)
    赋值 (菜单条, 多项选择 (N, , , , ))
    .如果 (等于 (菜单条, 被选菜单))
        赋值 (., 相减 (N, 1))
        赋值 (菜单条.选中, 真)
    .否则
        赋值 (菜单条.选中, 假)
    .如果结束
    
.计次循环尾 ()


.子程序 打开链接, 空白型, , 
.参数 URL, 文本型, , 

.如果真 (等于 (信息框 (相加 (“是否打开链接:”, URL), 相加 (#询问图标, #是否钮), ), #是钮))
    执行_API (取窗口句柄 (), “open”, URL, “”, “”, 5)
.如果真结束


.子程序 _丰富文本框1_链接被点击, 空白型, , 
.参数 链接文本, 整数型, , 

.局部变量 URL, 文本型, , , 

赋值 (URL, 指针到文本 (链接文本))
.如果 (等于 (到大写 (取文本左边 (URL, 7)), “HTTP://”))
    打开链接 (URL)
    返回 ()
.否则
    .如果 (等于 (到大写 (取文本左边 (URL, 6)), “FTP://”))
        打开链接 (URL)
        返回 ()
    .否则
        .如果真 (等于 (到大写 (取文本左边 (URL, 7)), “MAILTO:”))
            打开链接 (URL)
            返回 ()
        .如果真结束
        
        
    .如果结束
    
.如果结束
信息框 (相加 (“你点击了链接”, #左引号, URL, #右引号), #信息图标, )


.子程序 _插入QQ表情_被选择, 空白型, , 
.如果 (是否已创建 (窗口1))
    赋值 (窗口1., 真)
.否则
    载入 (窗口1, _启动窗口, 假)
.如果结束



.子程序 _插入小头像_被选择, 空白型, , 
.如果 (是否已创建 (窗口2))
    赋值 (窗口2., 真)
.否则
    载入 (窗口2, _启动窗口, 假)
.如果结束


.子程序 _丰富文本框1_试图修改保护区, 逻辑型, , 
.如果真 (等于 (信息框 (“你在修改受保护的区域，是否要修改吗？”, 相加 (#询问图标, #是否钮), ), #是钮))
    返回 (假)
.如果真结束


.子程序 _丰富文本框1_文本框被鼠标右键放开, 空白型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (.选中)
    弹出菜单 ()
.如果真结束


.子程序 _使用自定义菜单_被选择, 空白型, , 
赋值 (.选中, 取反 (.选中))
赋值 (., 取反 (.选中))

.窗口程序集 窗口程序集2, , , 

.程序集变量 QQ表情路径, 文本型, , , 
.程序集变量 上次移到的图片框, 图片框, , , 
.子程序 _窗口1_创建完毕, 空白型, , 
.局部变量 组件路径, 文本型, , , 
.局部变量 N, 整数型, , , 
.局部变量 X, 空白型, , , 

赋值 (组件路径, 取文本注册项 (#本地机器, “SOFTWARE\Classes\CLSID\{06ADA938-0FB0-4BC0-B19B-0A38AB17F182}\InprocServer32\”, ))
.如果真 (等于 (组件路径, “”))
    信息框 (“你没有安装QQ，所用到的动画播放组件ImageOle.GifAnimator不能使用”, 0, )
    销毁 ()
    返回 ()
.如果真结束
赋值 (N, 倒找文本 (组件路径, “\”, , 假))
 ' 寻找QQ表情路径
.判断循环首 (大于 (N, 0))
    赋值 (组件路径, 取文本左边 (组件路径, 相减 (N, 1)))
    赋值 (QQ表情路径, 相加 (组件路径, “\Face”))
    赋值 (X, 取文件属性 (QQ表情路径))
    .如果真 (并且 (不等于 (X, -1), 等于 (位与 (X, #子目录), #子目录)))
        跳出循环 ()
    .如果真结束
    赋值 (N, 倒找文本 (组件路径, “\”, , 假))
.判断循环尾 ()
.如果真 (小于 (N, 1))
    信息框 (“找不到QQ安装的路径！”, 0, )
    销毁 ()
    返回 ()
.如果真结束


.子程序 _窗口1_首次激活, 空白型, , 
.局部变量 Y, 整数型, , , 
.局部变量 图片框, 图片框, , , 
.局部变量 X, 整数型, , , 
.局部变量 N, 空白型, , , 


.计次循环首 (10, Y)
    .计次循环首 (10, X)
        
        .如果真 (等于 (N, 96))
            跳出循环 ()
        .如果真结束
        .如果真 (复制窗口组件 (图片框))
            赋值 (图片框.顶边, 相加 (相乘 (相减 (Y, 1), 26), 4))
            赋值 (图片框.左边, 相加 (相乘 (相减 (X, 1), 26), 4))
            赋值 (N, 相加 (N, 1))
            赋值 (图片框.标记, 相加 (QQ表情路径, “\”, 到文本 (N), “.gif”))
            赋值 (图片框.图片, 读入文件 (图片框.标记))
            赋值 (图片框.可视, 真)
        .如果真结束
        处理事件 ()
    .计次循环尾 ()
    .如果真 (等于 (N, 96))
        跳出循环 ()
    .如果真结束
    处理事件 ()
.计次循环尾 ()
赋值 (.标记, 相加 (QQ表情路径, “\0.gif”))
赋值 (.图片, 读入文件 (.标记))


.子程序 _图片框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 图片框, 图片框, , , 

赋值 (图片框, 取事件组件 ())
_启动窗口.未知支持库函数_40 (., 图片框.标记)

.子程序 _按钮1_被单击, 空白型, , 
赋值 (窗口1., 假)

.子程序 _图片框1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 图片框, 图片框, , , 

赋值 (图片框, 取事件组件 ())
.如果 (是否已创建 (上次移到的图片框))
    .如果真 (不等于 (上次移到的图片框, 图片框))
        赋值 (上次移到的图片框.背景颜色, #白色)
        赋值 (上次移到的图片框, 图片框)
        赋值 (图片框.背景颜色, #蓝色)
        
    .如果真结束
    
.否则
    赋值 (上次移到的图片框, 图片框)
.如果结束


.窗口程序集 窗口程序集3, , , 

.子程序 _窗口2_创建完毕, 空白型, , 
赋值 (_启动窗口.., .)

.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

_启动窗口.未知支持库函数_39 (., 按钮索引)

.子程序 _按钮1_被单击, 空白型, , 
赋值 (., 假)


 ' 不属于任何一个程序集、类模块的函数：
