 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 391
    高度 = 371
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 3 0 应用接口支持库
 ' spec A512548E76954B6E92C21055517615B0 3 0 特殊功能支持库





.窗口程序集 窗口程序集1, , , 

.程序集变量 适配器硬件ID, 文本型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
取网卡信息_ ()

.子程序 取网卡信息_, 空白型, , 
.局部变量 网卡信息REG, 文本型, , , 
.局部变量 变量, 整数型, , , 
.局部变量 匿名局部变量_61, 空白型, , , 
.局部变量 mac地址, 文本型, , , 
.局部变量 网卡信息, 未知类型0x20008, , "0", 
.局部变量 i, 整数型, , , 
.局部变量 物理地址, 文本型, , , 


赋值 (网卡信息REG, “SYSTEM\CurrentControlSet\Control\Class\{4D36E972-E325-11CE-BFC1-08002bE10318}\”)
.判断循环首 (注册项是否存在 (#本地机器, 相加 (网卡信息REG, 取重复文本 (相减 (4, 取文本长度 (到文本 (变量))), “0”), 到文本 (变量), “\Ndi\Interfaces\UpperRange”)))
    
    赋值 (变量, 相加 (变量, 1))
    .如果真 (等于 (取文本注册项 (#本地机器, 相加 (网卡信息REG, 取重复文本 (相减 (4, 取文本长度 (到文本 (变量))), “0”), 到文本 (变量), “\Ndi\Interfaces\LowerRange”), ), “ethernet”))
        赋值 (适配器硬件ID, 取文本注册项 (4, 相加 (网卡信息REG, 取重复文本 (相减 (4, 取文本长度 (到文本 (变量))), “0”), 到文本 (变量), “\MatchingDeviceId”), ))
        调试输出 (适配器硬件ID)
        赋值 (mac地址, 取文本注册项 (4, 相加 (网卡信息REG, 取重复文本 (相减 (4, 取文本长度 (到文本 (变量))), “0”), 到文本 (变量), “\NetworkAddress”), ))
        .判断开始 (不等于 (mac地址, “”))
            赋值 (.内容, mac地址)
        .默认
            赋值 (网卡信息, 未知支持库函数_42 ())
            
            .计次循环首 (取数组成员数 (网卡信息), i)
                 ' 调试输出 (网卡信息 [i].网卡名称, 网卡信息 [i].物理地址)
                .如果真 (不等于 (寻找文本 (网卡信息 [i], , “Ethernet”, , 真), -1))
                    赋值 (物理地址, 网卡信息 [i], )
                    赋值 (.内容, 子文本替换 (物理地址, “-”, , , , 真))
                     ' 调试输出 (网卡信息 [i].物理地址)
                .如果真结束
                
            .计次循环尾 ()
            
        .判断结束
        
    .如果真结束
    
.判断循环尾 ()


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 网卡信息REG, 文本型, , , 
.局部变量 变量, 整数型, , , 
.局部变量 匿名局部变量_32, 空白型, , , 

.如果真 (或者 (等于 (.内容, “”), 小于 (取文本长度 (.内容), 12)))
    信息框 (“输入不能为空且不能小于12位”, 0, )
    返回 ()
.如果真结束
赋值 (网卡信息REG, “SYSTEM\CurrentControlSet\Control\Class\{4D36E972-E325-11CE-BFC1-08002bE10318}\”)
.判断循环首 (注册项是否存在 (#本地机器, 相加 (网卡信息REG, 取重复文本 (相减 (4, 取文本长度 (到文本 (变量))), “0”), 到文本 (变量), “\Ndi\Interfaces\UpperRange”)))
    
    赋值 (变量, 相加 (变量, 1))
    .如果真 (等于 (取文本注册项 (#本地机器, 相加 (网卡信息REG, 取重复文本 (相减 (4, 取文本长度 (到文本 (变量))), “0”), 到文本 (变量), “\Ndi\Interfaces\LowerRange”), ), “ethernet”))
         ' 判断是不是以太网卡
        写注册项 (#本地机器, 相加 (网卡信息REG, 取重复文本 (相减 (4, 取文本长度 (到文本 (变量))), “0”), 到文本 (变量), “\NetworkAddress”), .内容)
        
    .如果真结束
    
.判断循环尾 ()
运行 (相加 (“cmd /c devcon disable ”, #引号, 适配器硬件ID, #引号), 真, 1)
 ' 网卡状态.标题 ＝ “正在启用网络适配器”
运行 (相加 (“cmd /c devcon enable ”, #引号, 适配器硬件ID, #引号), 真, 1)
信息框 (“恭喜您！MAC地址修改成功！”, 64, “成功！”)
取网卡信息_ ()

.子程序 _按钮2_被单击, 空白型, , 
.局部变量 网卡信息REG, 文本型, , , 
.局部变量 变量, 整数型, , , 


赋值 (网卡信息REG, “SYSTEM\CurrentControlSet\Control\Class\{4D36E972-E325-11CE-BFC1-08002bE10318}\”)
.判断循环首 (注册项是否存在 (#本地机器, 相加 (网卡信息REG, 取重复文本 (相减 (4, 取文本长度 (到文本 (变量))), “0”), 到文本 (变量), “\Ndi\Interfaces\UpperRange”)))
    
    赋值 (变量, 相加 (变量, 1))
    .如果真 (等于 (取文本注册项 (#本地机器, 相加 (网卡信息REG, 取重复文本 (相减 (4, 取文本长度 (到文本 (变量))), “0”), 到文本 (变量), “\Ndi\Interfaces\LowerRange”), ), “ethernet”))
         ' 判断是不是以太网卡
        写注册项 (#本地机器, 相加 (网卡信息REG, 取重复文本 (相减 (4, 取文本长度 (到文本 (变量))), “0”), 到文本 (变量), “\NetworkAddress”), “”)
        
    .如果真结束
    
.判断循环尾 ()
运行 (相加 (“cmd /c devcon disable ”, #引号, 适配器硬件ID, #引号), 真, 1)
 ' 网卡状态.标题 ＝ “正在启用网络适配器”
运行 (相加 (“cmd /c devcon enable ”, #引号, 适配器硬件ID, #引号), 真, 1)
信息框 (“恭喜您！MAC地址还原默认成功！”, 64, “成功！”)
取网卡信息_ ()


 ' 不属于任何一个程序集、类模块的函数：
