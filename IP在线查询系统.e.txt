 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 359
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “IP地址在线查询系统”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' internet 707ca37322474f6ca841f0e224f4b620 1 0 互联网支持库
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库





.窗口程序集 窗口程序集1, , , 

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 IP1, 文本型, , , 
.局部变量 IP2, 文本型, , , 
.局部变量 IP网段1, 文本型, , "0", 
.局部变量 IP网段2, 文本型, , "0", 
.局部变量 变量1, 整数型, , , 
.局部变量 变量2, 整数型, , , 
.局部变量 变量3, 整数型, , , 
.局部变量 变量4, 整数型, , , 

赋值 (.内容, “”)
清除数组 (IP网段1)
清除数组 (IP网段2)
.如果真 (等于 (.选中, 真))
    赋值 (IP1, 到文本 (.))
    输出调试文本 (IP1)
    .如果真 (等于 (IP1, “”))
        信息框 (“请输入查询IP！！”, 0, )
        获取焦点 ()
        返回 ()
    .如果真结束
    .如果真 (等于 (取IP地址 (IP1), 假))
        信息框 (“读取信息失败！！”, 0, )
    .如果真结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    赋值 (IP1, 到文本 (.))
    赋值 (IP2, 到文本 (.))
    输出调试文本 (IP1)
    输出调试文本 (IP2)
    .如果真 (并且 (等于 (IP1, “”), 等于 (IP2, “”)))
        信息框 (“输入查询的IP网段不能为空！！”, 0, )
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (IP网段1, 分割文本 (IP1, “.”, ))
    赋值 (IP网段2, 分割文本 (IP2, “.”, ))
    .计次循环首 (取数组成员数 (IP网段1), 变量1)
        .如果真 (并且 (不等于 (IP网段1 [变量1], “”), 不等于 (IP网段2 [变量1], “”)))
            .如果真 (小于 (IP网段2 [变量1], IP网段1 [变量1]))
                信息框 (“输入查询的IP网段不正确！！”, 0, )
                获取焦点 ()
                返回 ()
            .如果真结束
            
        .如果真结束
        
    .计次循环尾 ()
    .变量循环首 (到数值 (IP网段1 [1]), 到数值 (IP网段2 [1]), 1, 变量1)
        .变量循环首 (到数值 (IP网段1 [2]), 到数值 (IP网段2 [2]), 1, 变量2)
            .变量循环首 (到数值 (IP网段1 [3]), 到数值 (IP网段2 [3]), 1, 变量3)
                .变量循环首 (到数值 (IP网段1 [4]), 到数值 (IP网段2 [4]), 1, 变量4)
                    处理事件 ()
                    赋值 (IP1, 相加 (到文本 (变量1), “.”, 到文本 (变量2), “.”, 到文本 (变量3), “.”, 到文本 (变量4)))
                    输出调试文本 (IP1)
                    .如果真 (等于 (取IP地址 (IP1), 假))
                        信息框 (“读取信息失败！！”, 0, )
                        返回 ()
                    .如果真结束
                    
                .变量循环尾 ()
            .变量循环尾 ()
        .变量循环尾 ()
    .变量循环尾 ()
    
.如果真结束


.子程序 取IP地址, 逻辑型, , 
.参数 IP地址, 文本型, , 

.局部变量 i, 整数型, , , 
.局部变量 文本, 文本型, , "0", 
.局部变量 值, 整数型, , , 
.局部变量 值1, 整数型, , , 
.局部变量 返回信息, 文本型, , , 
.局部变量 查询地理位置, 文本型, , , 

清除数组 (文本)
赋值 (返回信息, 到文本 (未知支持库函数_7 (相加 (“http://www.ikaka.com/ip/index.asp?ip=”, IP地址, “&Submit=%B2%E9%D1%AF”))))
.如果真 (等于 (返回信息, “”))
    返回 (假)
.如果真结束
赋值 (文本, 分割文本 (返回信息, #换行符, ))
.计次循环首 (取数组成员数 (文本), i)
    赋值 (值, 寻找文本 (文本 [i], “                      地理位置”, , 假))
    .如果真 (不等于 (值, -1))
        赋值 (值, 相加 (寻找文本 (文本 [i], “：”, , 假), 2))
        赋值 (值1, 寻找文本 (文本 [i], “<”, , 假))
        赋值 (查询地理位置, 取文本中间 (文本 [i], 值, 相减 (值1, 值)))
        相加 (“官方数据查询结果：”, #换行符, “查  询IP：”, IP地址, #换行符, “地理位置：”, 查询地理位置, #换行符).加入文本 ()
    .如果真结束
    
.计次循环尾 ()
返回 (真)

.子程序 _按钮2_被单击, 空白型, , 
信息框 (相加 (“IP地址在线查询系统 0.1 免费版”, #换行符, “程序设计:双狮软件工作室 作者:林劲国 ”, #换行符, “个人主页:TLSWR.AnyP.cn”, #换行符, “电子邮箱:TLSWR@163.com”, #换行符, “易论坛名:TLSWR”, #换行符, “易语言网站:www.dywt.com.cn”, #换行符, “易语言论坛:www.dywt.com.cn/vbs/”, #换行符, “IP地址在线查询系统信息由ikaka.com提供,”, #换行符, “此信息归ikaka.com版权所有. ”), 64, “关于”)

.子程序 __启动窗口_创建完毕, 空白型, , 
未知支持库函数_0 (2)
_单选框1_被单击 ()

.子程序 _单选框1_被单击, 空白型, , 
赋值 (_启动窗口., 300)
获取焦点 ()
17.移动 (210, , )
76.移动 (238, , )
197.移动 (238, , )
连续赋值 (假, .可视, .可视, .可视, .可视, ., .)
连续赋值 (真, .可视, .可视, .)

.子程序 _单选框2_被单击, 空白型, , 
赋值 (_启动窗口., 360)
获取焦点 ()
17.移动 (155, , )
76.移动 (297, , )
197.移动 (297, , )
连续赋值 (真, .可视, .可视, .可视, .可视, ., .)
连续赋值 (假, .可视, .可视, .)

.子程序 __启动窗口_尺寸被改变, 空白型, , 
赋值 (_启动窗口., 1)



 ' 不属于任何一个程序集、类模块的函数：
