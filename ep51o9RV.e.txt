 ' 文件类型：Windows窗口程序

 ' 程序名称：局域网小帮手V1.0
 ' 程序描述：
 ' 程序作者：灵火
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：yjt258@21cn.com
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 441
    高度 = 500
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\ep51o9RV.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “局域网小帮手V1.0”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 226
    高度 = 173
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 窗口2
    左边 = 50
    顶边 = 50
    宽度 = 353
    高度 = 279
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 1 1 多线程支持库
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库



 ' 所需要的模块
 ' 进制转换 $模块_数制转换.ec


.全局变量 线程2完, 字节型, , , 
.全局变量 线程3完, 字节型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 已选择, 整数型, , "0", 
.程序集变量 d, 逻辑型, , , 
.程序集变量 存入字节, 字节集, , , 
.程序集变量 文件名, 文本型, , , 
.程序集变量 文件号, 整数型, , , 
.程序集变量 表数值, 整数型, , , 
.程序集变量 读入文件, 文本型, , , 
.程序集变量 列1, 文本型, , , 
.程序集变量 列2, 文本型, , "0", 
.程序集变量 列3, 文本型, , "0", 
.程序集变量 aa, 整数型, , , 
.程序集变量 bb, 整数型, , , 
.程序集变量 cc, 整数型, , , 
.程序集变量 i, 整数型, , , 
.程序集变量 字节集1, 字节集, , , 
.程序集变量 字节集2, 字节集, , , 
.程序集变量 MAC字节集, 字节集, , , 
.程序集变量 文本数组, 文本型, , "0", 
.程序集变量 开启目录, 整数型, , , 
.程序集变量 启动1, 文本型, , , 
.程序集变量 启动2, 文本型, , "0", 
.程序集变量 启动3, 文本型, , "0", 
.程序集变量 p, 整数型, , , 
.程序集变量 a, 整数型, , , 
.程序集变量 b, 整数型, , , 
.程序集变量 c, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
未知支持库函数_0 (1)
赋值 (.初始目录, 取运行目录 ())
赋值 (文件号, 打开文件 (相加 (取运行目录 (), “\”, “host.txt”), #读入, ))
赋值 (启动1, 读入文本 (文件号, ))
赋值 (启动2, 分割文本 (启动1, #换行符, ))
.计次循环首 (取数组成员数 (启动2), p)
    赋值 (启动3, 分割文本 (启动2 [p], “*”, ))
    .如果真 (等于 (取数组成员数 (启动3), 3))
        相减 (p, 1).插入表项 (启动3 [1], , , , )
        相减 (p, 1).置标题 (1, 启动3 [2])
        相减 (p, 1).置标题 (2, 启动3 [3])
    .如果真结束
    
.计次循环尾 ()
赋值 (p, 0)

.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.如果真 (等于 (按钮索引, 4))
    载入 (窗口1, , 真)
.如果真结束
.如果真 (等于 (按钮索引, 8))
    赋值 (d, 真)
    .判断循环首 (d)
        复制数组 (已选择, 取被选择表项 ())
        .如果 (小于 (取数组下标 (已选择, ), 1))
            赋值 (d, 假)
        .否则
            已选择.删除表项 ( [1])
        .如果结束
        
    .判断循环尾 ()
.如果真结束
.如果真 (等于 (按钮索引, 10))
    全部删除 ()
    
.如果真结束
.如果真 (等于 (按钮索引, 2))
    赋值 (表数值, 取表项数 ())
    赋值 (.类型, 1)
    打开 ()
    赋值 (文件名, .文件名)
    赋值 (文件号, 打开文件 (文件名, #重写, ))
    .计次循环首 (表数值, )
        写出文本 (文件号, 相加 (aa.取标题 (0), “*”, aa.取标题 (1), “*”, aa.取标题 (2), #换行符))
        赋值 (aa, 相加 (aa, 1))
    .计次循环尾 ()
    赋值 (aa, 0)
.如果真结束
.如果真 (等于 (按钮索引, 0))
    赋值 (.类型, 0)
    打开 ()
    赋值 (文件名, .文件名)
    赋值 (文件号, 打开文件 (文件名, #读入, ))
    赋值 (列1, 读入文本 (文件号, ))
    赋值 (列2, 分割文本 (列1, #换行符, ))
    .计次循环首 (取数组成员数 (列2), bb)
        赋值 (列3, 分割文本 (列2 [bb], “*”, ))
        .如果真 (等于 (取数组成员数 (列3), 3))
            相减 (bb, 1).插入表项 (列3 [1], , , , )
            相减 (bb, 1).置标题 (1, 列3 [2])
            相减 (bb, 1).置标题 (2, 列3 [3])
        .如果真结束
        
    .计次循环尾 ()
    赋值 (bb, 0)
.如果真结束
.如果真 (等于 (按钮索引, 6))
    未知支持库函数_0 (&子程序5, )
.如果真结束
.如果真 (等于 (按钮索引, 12))
    载入 (窗口2, , 真)
.如果真结束


.子程序 子程序5, 空白型, , 
赋值 (字节集1, { 255, 255, 255, 255, 255, 255 })
赋值 (字节集2, {  })
赋值 (MAC字节集, {  })
复制数组 (已选择, 取被选择表项 ())
赋值 (a, 1)
.判断循环首 (小于或等于 (a, 取数组成员数 (已选择)))
    加入成员 (列3, 已选择.取标题 ( [a], 2))
    赋值 (a, 相加 (a, 1))
.判断循环尾 ()
赋值 (b, 1)
赋值 (c, 1)
.判断循环首 (小于或等于 (b, 取数组成员数 (列3)))
    赋值 (文本数组, 分割文本 (列3 [b], “-”, ))
    .如果真 (等于 (取数组成员数 (文本数组), 6))
        .计次循环首 (6, )
            赋值 (文本数组 [c], 模块_进制转换 (文本数组 [c], 16, 10))
            赋值 (MAC字节集, 相加 (MAC字节集, 取字节集左边 (到字节集 (到短整数 (文本数组 [c])), 1)))
            赋值 (c, 相加 (c, 1))
        .计次循环尾 ()
        赋值 (c, 1)
        .计次循环首 (16, )
            赋值 (字节集2, 相加 (字节集2, MAC字节集))
        .计次循环尾 ()
        赋值 (字节集1, 相加 (字节集1, 字节集2))
        .发送数据 (12345, 字节集1)
        赋值 (字节集2, {  })
        赋值 (MAC字节集, {  })
    .如果真结束
    赋值 (b, 相加 (b, 1))
.判断循环尾 ()
信息框 (“已经发送完毕”, 0, )


.子程序 _超级列表框1_左键单击表项, 空白型, , 
赋值 (已选择, 取被选择表项 ())
.如果真 (大于或等于 (取数组成员数 (已选择), 1))
    复制数组 (已选择, 取被选择表项 ())
    赋值 (.内容, 已选择.取标题 ( [1], 0))
    赋值 (.内容, 已选择.取标题 ( [1], 1))
    赋值 (.内容, 已选择.取标题 ( [1], 2))
    
.如果真结束


.窗口程序集 窗口程序集2, , , 

.程序集变量 存放1, 文本型, , "4", 
.程序集变量 存放2, 文本型, , "4", 
.程序集变量 IP1段, 短整数型, , , 
.程序集变量 IP2段, 短整数型, , , 
.程序集变量 变量1, 短整数型, , , 
.程序集变量 变量2, 短整数型, , , 
.程序集变量 变量3, 短整数型, , , 
.程序集变量 IP, 文本型, , , 
.程序集变量 线程1, 短整数型, , , 
.程序集变量 线程2, 短整数型, , , 
.程序集变量 线程3, 短整数型, , , 
.程序集变量 线程1组1, 文本型, , "0", 
.程序集变量 线程1组2, 文本型, , "0", 
.程序集变量 线程1组3, 文本型, , "0", 
.程序集变量 线程1组4, 文本型, , "0", 
.程序集变量 线程1组5, 文本型, , "0", 
.程序集变量 线程1组6, 文本型, , "0", 
.程序集变量 a, 短整数型, , , 
.程序集变量 b, 短整数型, , , 
.子程序 _按钮1_被单击, 空白型, , 
未知支持库函数_0 (&子程序1, )
未知支持库函数_0 (&子程序2, )
未知支持库函数_0 (&子程序3, )

.子程序 _时钟1_周期事件, 空白型, , 
赋值 (IP, “0.0.0.0”)
.如果 (等于 (., “”))
    赋值 (., IP)
.否则
    
.如果结束
.如果 (等于 (., “”))
    赋值 (., IP)
.否则
    
.如果结束


.子程序 子程序1, 空白型, 公开, 
_启动窗口.全部删除 (.)
赋值 (存放1, 分割文本 (., “.”, ))
赋值 (存放2, 分割文本 (., “.”, ))
赋值 (IP1段, 到短整数 (存放1 [4]))
赋值 (IP2段, 到短整数 (存放2 [4]))
赋值 (线程1, 相除 (相减 (IP2段, IP1段), 3))
赋值 (线程2, 线程1)
赋值 (线程3, 相加 (线程2, 求余数 (IP2段, 3)))
赋值 (变量1, IP1段)
.如果真 (或者 (等于 (., .), 大于 (IP1段, IP2段)))
    .如果真 (不等于 (通信测试 (相加 (存放2 [1], “.”, 存放2 [2], “.”, 存放2 [3], “.”, 到文本 (IP1段)), 50), -1))
        _启动窗口.插入表项 (., 0, 转换为主机名 (相加 (存放1 [1], “.”, 存放1 [2], “.”, 存放1 [3], “.”, 到文本 (变量1))), , , , )
        _启动窗口.置标题 (., 0, 1, 相加 (存放1 [1], “.”, 存放1 [2], “.”, 存放1 [3], “.”, 到文本 (变量1)))
        _启动窗口.置标题 (., 0, 2, 未知支持库函数_45 (相加 (存放1 [1], “.”, 存放1 [2], “.”, 存放1 [3], “.”, 到文本 (变量1))))
    .如果真结束
    信息框 (“搜索完毕”, 0, )
    返回 ()
.如果真结束
.计次循环首 (线程1, )
    .如果真 (不等于 (通信测试 (相加 (存放2 [1], “.”, 存放2 [2], “.”, 存放2 [3], “.”, 到文本 (变量1)), 50), -1))
        _启动窗口.插入表项 (., 0, 转换为主机名 (相加 (存放2 [1], “.”, 存放2 [2], “.”, 存放2 [3], “.”, 到文本 (变量1))), , , , )
        _启动窗口.置标题 (., 0, 1, 相加 (存放2 [1], “.”, 存放2 [2], “.”, 存放2 [3], “.”, 到文本 (变量1)))
        _启动窗口.置标题 (., 0, 2, 未知支持库函数_45 (相加 (存放2 [1], “.”, 存放2 [2], “.”, 存放2 [3], “.”, 到文本 (变量1))))
    .如果真结束
    赋值 (变量1, 相加 (变量1, 1))
.计次循环尾 ()
.如果 (等于 (线程2完, 1))
    赋值 (b, 1)
    .判断循环首 (大于或等于 (取数组成员数 (线程1组2), b))
        _启动窗口.插入表项 (., 0, 线程1组1 [b], , , , )
        _启动窗口.置标题 (., 0, 1, 线程1组2 [b])
        _启动窗口.置标题 (., 0, 2, 线程1组3 [b])
        赋值 (b, 相加 (b, 1))
    .判断循环尾 ()
    清除数组 (线程1组1)
    清除数组 (线程1组2)
    清除数组 (线程1组3)
.否则
    延时 (1500)
    .如果 (等于 (线程2完, 1))
        赋值 (b, 1)
        .判断循环首 (大于或等于 (取数组成员数 (线程1组2), b))
            _启动窗口.插入表项 (., 0, 线程1组1 [b], , , , )
            _启动窗口.置标题 (., 0, 1, 线程1组2 [b])
            _启动窗口.置标题 (., 0, 2, 线程1组3 [b])
            赋值 (b, 相加 (b, 1))
        .判断循环尾 ()
        清除数组 (线程1组1)
        清除数组 (线程1组2)
        清除数组 (线程1组3)
    .否则
        延时 (1500)
        .如果 (等于 (线程2完, 1))
            赋值 (b, 1)
            .判断循环首 (大于或等于 (取数组成员数 (线程1组2), b))
                _启动窗口.插入表项 (., 0, 线程1组1 [b], , , , )
                _启动窗口.置标题 (., 0, 1, 线程1组2 [b])
                _启动窗口.置标题 (., 0, 2, 线程1组3 [b])
                赋值 (b, 相加 (b, 1))
            .判断循环尾 ()
            清除数组 (线程1组1)
            清除数组 (线程1组2)
            清除数组 (线程1组3)
        .否则
            延时 (1500)
            .如果 (等于 (线程2完, 1))
                赋值 (b, 1)
                .判断循环首 (大于或等于 (取数组成员数 (线程1组2), b))
                    _启动窗口.插入表项 (., 0, 线程1组1 [b], , , , )
                    _启动窗口.置标题 (., 0, 1, 线程1组2 [b])
                    _启动窗口.置标题 (., 0, 2, 线程1组3 [b])
                    赋值 (b, 相加 (b, 1))
                .判断循环尾 ()
                清除数组 (线程1组1)
                清除数组 (线程1组2)
                清除数组 (线程1组3)
            .否则
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束
.如果 (等于 (线程3完, 1))
    赋值 (a, 1)
    .判断循环首 (大于或等于 (取数组成员数 (线程1组6), a))
        _启动窗口.插入表项 (., 0, 线程1组4 [a], , , , )
        _启动窗口.置标题 (., 0, 1, 线程1组5 [a])
        _启动窗口.置标题 (., 0, 2, 线程1组6 [a])
        赋值 (a, 相加 (a, 1))
    .判断循环尾 ()
    清除数组 (线程1组4)
    清除数组 (线程1组5)
    清除数组 (线程1组6)
    信息框 (“搜索完毕”, 0, )
    返回 ()
.否则
    延时 (1500)
    .如果 (等于 (线程3完, 1))
        赋值 (a, 1)
        .判断循环首 (大于或等于 (取数组成员数 (线程1组6), a))
            _启动窗口.插入表项 (., 0, 线程1组4 [a], , , , )
            _启动窗口.置标题 (., 0, 1, 线程1组5 [a])
            _启动窗口.置标题 (., 0, 2, 线程1组6 [a])
            赋值 (a, 相加 (a, 1))
        .判断循环尾 ()
        清除数组 (线程1组4)
        清除数组 (线程1组5)
        清除数组 (线程1组6)
        信息框 (“搜索完毕”, 0, )
        返回 ()
    .否则
        延时 (1500)
        .如果 (等于 (线程3完, 1))
            赋值 (a, 1)
            .判断循环首 (大于或等于 (取数组成员数 (线程1组6), a))
                _启动窗口.插入表项 (., 0, 线程1组4 [a], , , , )
                _启动窗口.置标题 (., 0, 1, 线程1组5 [a])
                _启动窗口.置标题 (., 0, 2, 线程1组6 [a])
                赋值 (a, 相加 (a, 1))
            .判断循环尾 ()
            清除数组 (线程1组4)
            清除数组 (线程1组5)
            清除数组 (线程1组6)
            信息框 (“搜索完毕”, 0, )
            返回 ()
        .否则
            延时 (1500)
            .如果 (等于 (线程3完, 1))
                赋值 (a, 1)
                .判断循环首 (大于或等于 (取数组成员数 (线程1组5), a))
                    _启动窗口.插入表项 (., 0, 线程1组4 [a], , , , )
                    _启动窗口.置标题 (., 0, 1, 线程1组5 [a])
                    _启动窗口.置标题 (., 0, 2, 线程1组6 [a])
                    赋值 (a, 相加 (a, 1))
                .判断循环尾 ()
                清除数组 (线程1组4)
                清除数组 (线程1组5)
                清除数组 (线程1组6)
                信息框 (“搜索完毕”, 0, )
                返回 ()
            .否则
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束



.子程序 子程序2, 空白型, , 
赋值 (存放1, 分割文本 (., “.”, ))
赋值 (存放2, 分割文本 (., “.”, ))
赋值 (IP1段, 到短整数 (存放1 [4]))
赋值 (IP2段, 到短整数 (存放2 [4]))
赋值 (线程1, 相除 (相减 (IP2段, IP1段), 3))
赋值 (线程2, 线程1)
赋值 (线程3, 相加 (线程2, 求余数 (IP2段, 3)))
赋值 (变量2, 相加 (IP1段, 线程1))
.计次循环首 (线程2, )
    .如果真 (不等于 (通信测试 (相加 (存放2 [1], “.”, 存放2 [2], “.”, 存放2 [3], “.”, 到文本 (变量2)), 50), -1))
        加入成员 (线程1组1, 转换为主机名 (相加 (存放2 [1], “.”, 存放2 [2], “.”, 存放2 [3], “.”, 到文本 (变量2))))
        加入成员 (线程1组2, 相加 (存放2 [1], “.”, 存放2 [2], “.”, 存放2 [3], “.”, 到文本 (变量2)))
        加入成员 (线程1组3, 未知支持库函数_45 (相加 (存放2 [1], “.”, 存放2 [2], “.”, 存放2 [3], “.”, 到文本 (变量2))))
    .如果真结束
    赋值 (变量2, 相加 (变量2, 1))
.计次循环尾 ()
赋值 (线程2完, 1)

.子程序 子程序3, 空白型, , 
赋值 (存放1, 分割文本 (., “.”, ))
赋值 (存放2, 分割文本 (., “.”, ))
赋值 (IP1段, 到短整数 (存放1 [4]))
赋值 (IP2段, 到短整数 (存放2 [4]))
赋值 (线程1, 相除 (相减 (IP2段, IP1段), 3))
赋值 (线程2, 线程1)
赋值 (线程3, 相加 (线程2, 求余数 (IP2段, 3)))
赋值 (变量3, 相加 (IP1段, 线程1, 线程2))
.计次循环首 (线程3, )
    .如果真 (不等于 (通信测试 (相加 (存放2 [1], “.”, 存放2 [2], “.”, 存放2 [3], “.”, 到文本 (变量3)), 50), -1))
        加入成员 (线程1组4, 转换为主机名 (相加 (存放2 [1], “.”, 存放2 [2], “.”, 存放2 [3], “.”, 到文本 (变量3))))
        加入成员 (线程1组5, 相加 (存放2 [1], “.”, 存放2 [2], “.”, 存放2 [3], “.”, 到文本 (变量3)))
        加入成员 (线程1组6, 未知支持库函数_45 (相加 (存放2 [1], “.”, 存放2 [2], “.”, 存放2 [3], “.”, 到文本 (变量3))))
    .如果真结束
    赋值 (变量3, 相加 (变量3, 1))
.计次循环尾 ()
赋值 (线程3完, 1)


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 模块_进制转换, 文本型, , 可以将从二进制到三十六进制的数值随意进行转换，不可以转换负数以及小数。
.参数 被转换文本, 文本型, , 
.参数 被转换进制, 整数型, , 
.参数 转换的进制, 整数型, , 



.窗口程序集 窗口程序集3, , , 

.子程序 _按钮1_被单击, 空白型, , 
销毁 ()



 ' 不属于任何一个程序集、类模块的函数：
