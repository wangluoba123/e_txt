 ' 文件类型：Windows窗口程序

 ' 程序名称：Sqlite数据库管理器（易语言版）v1.0
 ' 程序描述：Window系统下图形用户界面(GUI)的Sqlite数据库管理器。
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 799
    高度 = 589
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “Sqlite数据库管理器 v1.0”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 382
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “（此窗口在本程序中暂时没有用到）”
    帮助文件名 = “”

窗口 窗口_执行SQL语句
    左边 = 50
    顶边 = 50
    宽度 = 551
    高度 = 408
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “执行SQL语句”
    帮助文件名 = “”

窗口 窗口_设计表
    左边 = 50
    顶边 = 50
    宽度 = 502
    高度 = 442
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “设计表”
    帮助文件名 = “”

窗口 窗口_插入记录
    左边 = 50
    顶边 = 50
    宽度 = 399
    高度 = 374
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “插入记录...”
    帮助文件名 = “”



.图片 SDB文件图标, " ' 已保存到：D:\易语言学习\Data\Sqlite管理器.e\SDB文件图标", , SqliteDB.ico图标文件，用于*.sdb文件
.图片 Sqlite管理器图标, " ' 已保存到：D:\易语言学习\Data\Sqlite管理器.e\Sqlite管理器图标", , SqliteManager.ico图标文件，程序中不用，供参考及修改
.常量 字段类型_空, "“”", , 以下文本常量在“设计表”窗口中使用
.常量 字段类型_整数, "“整数型”", , 
.常量 字段类型_小数, "“小数型”", , 
.常量 字段类型_文本, "“文本型”", , 
.常量 字段类型_字节集, "“字节集型”", , 
.常量 字段类型_通用型, "“（通用型）”", , 
.常量 字段类型_主键, "“主键（自增字段）”", , 
.常量 , , , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 2 5 扩展界面支持库三
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' SqliteDB {295DD8F2-3584-4780-818D-9569AC5BC9D8} 1 5 Sqlite数据库支持库
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 1 3 高级表格支持库
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库




数据类型 字段值类型, , 用于“插入记录”窗口，记录用户已绑定的值。
    .成员 类型, 整数型, , , 可为“#整数型”等常量
    .成员 文本值, 文本型, , , 
    .成员 字节集值, 字节集, , , 

数据类型 字段及附加信息, , 用于“设计表”窗口，记录用户对现有字段所作的修改。
    .成员 字段名称, 文本型, , , 
    .成员 字段类型文本, 文本型, , , 
    .成员 字段最大文本长度文本, 文本型, , , 
    .成员 已删除, 逻辑型, , , !
    .成员 新添加, 逻辑型, , , !

数据类型 系统参数类型, , 
    .成员 最大载入记录数, 整数型, , , 当选中表时，一次性读取的记录数。-1表示不限制。如果不限制此参数且表很大，将严重影响载入速度。

.全局变量 数据库, 未知类型0x50001, , , 
.全局变量 表, 未知类型0x50002, , , 
.全局变量 记录集, 未知类型0x50003, , , 
.全局变量 匿名全局变量_801, 空白型, , , 
.全局变量 表数组, 文本型, , "0", 
.全局变量 视图数组, 文本型, , "0", 
.全局变量 临时表数组, 文本型, , "0", 
.全局变量 临时视图数组, 文本型, , "0", 
.全局变量 匿名全局变量_806, 空白型, , , 
.全局变量 数据库文本名, 文本型, , , 
.全局变量 程序名称, 文本型, , , 
.全局变量 匿名全局变量_1285, 空白型, , , 
.全局变量 系统参数, 系统参数类型, , , 

.窗口程序集 启动窗口程序集, , , 

.程序集变量 原单元格文本, 文本型, , , 用于判断单元格被编辑前后是否内容被改变
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 命令行数组, 文本型, , "0", 

赋值 (程序名称, “Sqlite数据库管理器（易语言版） v1.0”)
赋值 (_启动窗口., 程序名称)
关闭数据库 ()
设置SDB文件关联 ()
初始化系统参数 ()

取命令行 (命令行数组)
.如果真 (大于 (取数组成员数 (命令行数组), 0))
    打开数据库文件 (命令行数组 [1], 假)
.如果真结束


.子程序 初始化系统参数, 空白型, , 
赋值 (系统参数.最大载入记录数, 1000)


.子程序 设置SDB文件关联, 空白型, , 
.局部变量 图标文件, 文本型, , , 

.如果真 (等于 (是否为调试版 (), 假)) ' 调式运行时,EXE文件为临时文件
    赋值 (图标文件, 相加 (取运行目录 (), “\SqliteDB.ico”))
    .如果真 (等于 (文件是否存在 (图标文件), 假))
        .如果真 (等于 (写到文件 (图标文件, #SDB文件图标), 假))
            返回 ()
        .如果真结束
        
    .如果真结束
    写注册项 (#根类, “.sdb\”, “SqliteDBFile”)
    写注册项 (#根类, “SqliteDBFile\”, “Sqlite数据库文件”)
     ' 写注册项 (#根类, “SqliteDBFile\DefaultIcon\”, 取运行目录 () ＋ “\” ＋ 取执行文件名 () ＋ “,0”)
    写注册项 (#根类, “SqliteDBFile\DefaultIcon\”, 图标文件)
    写注册项 (#根类, “SqliteDBFile\shell\open\command\”, 相加 (取运行目录 (), “\”, 取执行文件名 (), “ %1”))
.如果真结束


.子程序 打开或新建数据库, 空白型, , 
.参数 是否新建, 逻辑型, , 

.局部变量 文件名, 文本型, , , 

赋值 (.类型, 选择 (是否新建, 1, 0))
赋值 (.标题, 选择 (是否新建, “新建数据库”, “打开数据库”))
.如果真 (等于 (打开 (), 假))
    返回 ()
.如果真结束
赋值 (文件名, .文件名)

.如果真 (并且 (是否新建, 文件是否存在 (文件名)))
    删除文件 (文件名) ' !! 保存文本对话框对询问是否覆盖该文件
.如果真结束

关闭数据库 ()
打开数据库文件 (文件名, 是否新建)

.子程序 打开数据库文件, 空白型, , 
.参数 文件名, 文本型, , 
.参数 是否新建, 逻辑型, , 

.局部变量 结果, 逻辑型, , , 
.局部变量 打开或新建, 文本型, , , 

备份数据库文件 (文件名)
.如果 (是否新建)
    赋值 (结果, 数据库.未知支持库函数_30 (文件名, 真))
    赋值 (打开或新建, “新建”)
.否则
    赋值 (结果, 数据库.未知支持库函数_30 (文件名, 假))
    赋值 (打开或新建, “打开”)
.如果结束

.如果真 (等于 (结果, 假))
    信息框 (相加 (“不能”, 打开或新建, “数据库 [”, 文件名, “]！”), #错误图标, )
    写操作日志 (相加 (“[×]”, 打开或新建, “数据库失败！[”, 文件名, “]”))
    返回 ()
.如果真结束

赋值 (数据库文本名, 文件名)
赋值 (_启动窗口., 相加 (程序名称, “ - ”, 数据库文本名))
读取数据库信息 ()
显示表和视图 ()
批量禁止工具栏按钮 (假, “2,3,4,5,6,7,8,9,10,11,12”)
批量禁止菜单_数据库 (假)
赋值 (.禁止, 假)
 ' 菜单数组 = {关闭数据库,新建表,删除表,修改表,新建视图,删除视图,修改视图,}  '这种赋值不合法!
 ' 批量禁止菜单 (假, 菜单数组)

写操作日志 (相加 (打开或新建, “数据库：”, 文件名))
返回 ()


.子程序 备份数据库文件, 空白型, , 
.参数 文件名, 文本型, , 

.局部变量 新文件名, 文本型, , , 
.局部变量 子目录, 文本型, , , 

.如果真 (等于 (文件是否存在 (文件名), 假))
    返回 ()
.如果真结束

赋值 (子目录, 相加 (取运行目录 (), “\数据库备份”))
创建目录 (子目录)
赋值 (新文件名, 相加 (子目录, “\”, 取文本右边 (文件名, 相减 (取文本长度 (文件名), 倒找文本 (文件名, “\”, , 假))), “__”, 到文本 (取现行时间 ())))
.如果真 (复制文件 (文件名, 新文件名))
    写操作日志 (相加 (“已将数据库文件备份到：”, 新文件名))
.如果真结束


.子程序 批量禁止菜单_数据库, 空白型, , 在关闭数据库前后，设置各菜单的禁止与否
.参数 是否禁止, 逻辑型, , 

赋值 (.禁止, 是否禁止)
赋值 (.禁止, 是否禁止)
赋值 (.禁止, 是否禁止)
赋值 (.禁止, 是否禁止)


.子程序 关闭数据库, 空白型, , 
.如果真 (并且 (等于 (数据库.未知支持库函数_29 (), 真), 等于 (数据库.未知支持库函数_31 (), 假)))
    信息框_附错误文本 (“暂时无法关闭数据库！”)
    返回 ()
.如果真结束

赋值 (数据库文本名, “”)
赋值 (_启动窗口., 程序名称)

批量禁止工具栏按钮 (真, “2,3,4,5,6,7,8,9,10,11,12”)
批量禁止菜单_数据库 (真)
赋值 (.禁止, 真)

赋值 (.图标, {  })
赋值 (.最大化按钮, -1)
清除显示内容 ()

.子程序 读取数据库信息, 空白型, , 
赋值 (表数组, 数据库.未知支持库函数_51 (真, 假, 假))
赋值 (视图数组, 数据库.未知支持库函数_51 (假, 真, 假))
赋值 (临时表数组, 数据库.未知支持库函数_51 (真, 假, 真))
赋值 (临时视图数组, 数据库.未知支持库函数_51 (假, 真, 真))


.子程序 刷新数据库显示, 空白型, , 可在新增或删除了表或视图后调用本命令
读取数据库信息 ()
显示表和视图 ()


.子程序 刷新当前表显示, 空白型, , 可在更新了当前显示的表内容后调用本命令
_树型框1_项目被选择 (0)


.子程序 显示表和视图, 空白型, , 
.局部变量 项目索引, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 原选中项, 整数型, , , 

赋值 (原选中项, .最大化按钮)
清空 ()
.如果真 (或者 (等于 (.现行选中项, 0), 等于 (.现行选中项, 1))) ' 显示表
    赋值 (项目索引, .加入项目 (相加 (“表 (”, 到文本 (取数组成员数 (表数组)), “)”), 18, , 1))
    .计次循环首 (取数组成员数 (表数组), i)
        项目索引.加入项目 (表数组 [i], , , 100)
    .计次循环尾 ()
    项目索引.扩展 ()
.如果真结束
.如果真 (或者 (等于 (.现行选中项, 0), 等于 (.现行选中项, 2))) ' 显示视图
    赋值 (项目索引, .加入项目 (相加 (“视图 (”, 到文本 (取数组成员数 (视图数组)), “)”), 88, , 2))
    .计次循环首 (取数组成员数 (视图数组), i)
        项目索引.加入项目 (视图数组 [i], , , 200)
    .计次循环尾 ()
    项目索引.扩展 ()
.如果真结束
.如果真 (并且 (或者 (等于 (.现行选中项, 0), 等于 (.现行选中项, 3)), 大于 (取数组成员数 (临时表数组), 0))) ' 显示临时表
    赋值 (项目索引, .加入项目 (相加 (“临时表 (”, 到文本 (取数组成员数 (临时表数组)), “)”), 88, , 2))
    .计次循环首 (取数组成员数 (临时表数组), i)
        项目索引.加入项目 (临时表数组 [i], , , 100)
    .计次循环尾 ()
    项目索引.扩展 ()
.如果真结束
.如果真 (并且 (或者 (等于 (.现行选中项, 0), 等于 (.现行选中项, 4)), 大于 (取数组成员数 (临时视图数组), 0))) ' 显示临时视图
    赋值 (项目索引, .加入项目 (相加 (“临时视图 (”, 到文本 (取数组成员数 (临时视图数组)), “)”), 88, , 2))
    .计次循环首 (取数组成员数 (临时视图数组), i)
        项目索引.加入项目 (临时视图数组 [i], , , 200)
    .计次循环尾 ()
    项目索引.扩展 ()
.如果真结束

赋值 (.最大化按钮, 原选中项)

.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.判断开始 (等于 (按钮索引, 0)) ' 新建数据库
    _新建数据库_被选择 ()
.判断 (等于 (按钮索引, 1)) ' 打开数据库
    _打开数据库_被选择 ()
.判断 (等于 (按钮索引, 2)) ' 关闭数据库
    关闭数据库 ()
.判断 (等于 (按钮索引, 4)) ' 新建表
    _新建表_被选择 ()
.判断 (等于 (按钮索引, 5)) ' 修改表
    _修改表_被选择 ()
.判断 (等于 (按钮索引, 6)) ' 删除表
    _删除表_被选择 ()
.判断 (等于 (按钮索引, 8)) ' 新建视图
    _新建视图_被选择 ()
.判断 (等于 (按钮索引, 9)) ' 修改视图
    _修改视图_被选择 ()
.判断 (等于 (按钮索引, 10)) ' 删除视图
    _删除视图_被选择 ()
.判断 (等于 (按钮索引, 12)) ' 执行SQL语句
    _执行SQL语句_被选择 ()
.默认
    
.判断结束


.子程序 _组合框_显示内容_列表项被选择, 空白型, , 
显示表和视图 ()


.子程序 _树型框1_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

.局部变量 项目数值, 整数型, , , 

赋值 (项目数值, .取项目数值 (.最大化按钮))
.如果真 (或者 (等于 (.最大化按钮, -1), 小于 (项目数值, 100))) ' 非叶子节点无需处理
    清除显示内容 ()
    返回 ()
.如果真结束

读取并显示表或视图内容 (.取项目文本 (.最大化按钮), 项目数值)


.子程序 清除显示内容, 空白型, , 
赋值 (.可视, 假)
赋值 (., 1)
赋值 (., 1)
0.未知支持库函数_9 (0, #., “无数据”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.图片, {  })
清空 ()
清空 ()

.子程序 读取并显示表或视图内容, 空白型, , 
.参数 表或视图名称, 文本型, , 
.参数 附加数值, 整数型, , 用于判断是表还是视图

.局部变量 数组, 文本型, , "0", 
.局部变量 起始时间, 整数型, , , 
.局部变量 sql, 文本型, , , 
.局部变量 已显示记录, 文本型, , , 
.局部变量 表或视图, 文本型, , , 

.如果真 (等于 (表或视图名称, “”))
    返回 ()
.如果真结束

赋值 (起始时间, 取启动时间 ())
赋值 (.内容, 数据库.未知支持库函数_53 (表或视图名称))
赋值 (表或视图, 选择 (是表吗 (附加数值), “表”, “视图”))
.如果 (表.未知支持库函数_105 (表或视图名称, 数据库))
    赋值 (数组, 表.未知支持库函数_153 ())
    数组导入组合框 (数组, -1)
    数值填充组合框 (1, 选择 (并且 (大于或等于 (系统参数.最大载入记录数, 0), 小于或等于 (系统参数.最大载入记录数, 表.未知支持库函数_150 ())), 系统参数.最大载入记录数, 表.未知支持库函数_150 ()), -1) ' 如果列出全部记录序号，则本行可能成速度瓶颈――在记录数为数十万的情况下。
    
    赋值 (sql, 相加 (“select * from ”, 表或视图名称))
    .如果真 (大于或等于 (系统参数.最大载入记录数, 0))
        赋值 (sql, 相加 (sql, “ limit ”, 到文本 (系统参数.最大载入记录数))) ' 限制读取的记录数，避免因表太大导致程序长时间无反应。
    .如果真结束
    赋值 (记录集, 数据库.未知支持库函数_33 (sql))
    记录集.未知支持库函数_190 ()
    赋值 (数组, 记录集.未知支持库函数_209 (真))
    数组导入高级表格 (数组, 真, 真)
    
    赋值 (已显示记录, 选择 (并且 (大于或等于 (系统参数.最大载入记录数, 0), 小于或等于 (系统参数.最大载入记录数, 表.未知支持库函数_150 ())), 相加 (“显示前”, 到文本 (系统参数.最大载入记录数), “条，”), “已全部显示，”))
    赋值 (.内容, 相加 (“共”, 到文本 (表.未知支持库函数_150 ()), “条记录，”, 已显示记录, “耗时”, 到文本 (相减 (取启动时间 (), 起始时间)), “毫秒。”, 选择 (是表吗 (附加数值), “可直接修改文本字段。”, “”)))
    
    写操作日志 (相加 (“打开”, 表或视图, “：”, 表或视图名称))
    赋值 (.可视, 是表吗 (附加数值)) ' 仅"表"允许读写字段
    
.否则
    信息框 (相加 (“打开”, 表或视图, “失败：”, 表或视图名称), #错误图标, )
    写操作日志 (相加 (“[×]打开”, 表或视图, “失败！”, 表或视图名称))
.如果结束


.子程序 是表吗, 逻辑型, , 
.参数 附加数值, 整数型, , 树形框项目数值,约定100给表使用

返回 (等于 (附加数值, 100))


.子程序 是视图吗, 逻辑型, , 
.参数 附加数值, 整数型, , 树形框项目数值,约定200给视图使用

返回 (等于 (附加数值, 200))


.子程序 选中项目是表吗, 逻辑型, , 判断树型框当前选中项是"表"
返回 (是表吗 (.取项目数值 (.最大化按钮)))


.子程序 选中项目是视图吗, 逻辑型, , 判断树型框当前选中项是"表"
返回 (是视图吗 (.取项目数值 (.最大化按钮)))


.子程序 读指定字段值, 空白型, , 记录号和字段索引由两个组合框确定
.如果真 (等于 (选中项目是表吗 (), 假))
    返回 ()
.如果真结束

.如果真 (等于 (表.未知支持库函数_104 (), 假))
    返回 ()
.如果真结束

.判断开始 (等于 (., 0)) ' 文本型
     ' _按钮_读文本字段值_被单击 ()
    读指定类型字段值 (#文本型)
.判断 (等于 (., 1)) ' 整数型
     ' _按钮_读整数字段值_被单击 ()
    读指定类型字段值 (#整数型)
.判断 (等于 (., 2)) ' 小数型
     ' _按钮_读小数字段值_被单击 ()
    读指定类型字段值 (#小数型)
.判断 (等于 (., 3)) ' 字节集型
     ' 读字节集字段 ()
    读指定类型字段值 (#字节集型)
.默认
    
.判断结束


.子程序 写操作日志, 空白型, , 
.参数 操作日志, 文本型, , 

相加 (#换行符, 操作日志).加入文本 ()


.子程序 _超级按钮_写日志到文件_被单击, 空白型, , 
赋值 (.类型, 1) ' 保存
.如果真 (打开 ())
    .如果 (写到文件 (.文件名, 到字节集 (.内容)))
        信息框 (相加 (“已成功写入文件 ”, .文件名), 0, )
        未知支持库函数_6 (#, .文件名, , )
    .否则
        信息框 (“写文件失败！”, 0, )
    .如果结束
    
.如果真结束


.子程序 _超级按钮_清除日志_被单击, 空白型, , 
赋值 (.内容, “”)

.子程序 _按钮_从文件读入文本_被单击, 空白型, , 
赋值 (.类型, 0) ' 打开
.如果真 (打开 ())
    赋值 (.内容, 到文本 (读入文件 (.文件名)))
.如果真结束


.子程序 _按钮_写文本到文件_被单击, 空白型, , 
赋值 (.类型, 1) ' 保存
.如果真 (打开 ())
    .如果 (写到文件 (.文件名, 到字节集 (.内容)))
        信息框 (相加 (“已成功写入文件 ”, .文件名), 0, )
        未知支持库函数_6 (#, .文件名, , )
    .否则
        信息框 (“写文件失败！”, 0, )
    .如果结束
    
.如果真结束


.子程序 读字节集字段, 空白型, , 
.局部变量 字节集, 字节集, , , 

读指定类型字段值 (#字节集型)


.子程序 _按钮_写字节集字段值到文件_被单击, 空白型, , 
.局部变量 字节集, 字节集, , , 

读指定类型字段值 (#字节集型, 真)


.子程序 _按钮_从文件写到字节集字段_被单击, 空白型, , 
.局部变量 字节集, 字节集, , , 

写指定类型字段值 (#字节集型)


.子程序 _按钮_清除字节集字段_被单击, 空白型, , 
写指定类型字段值 (0)


.子程序 _按钮_读文本字段值_被单击, 空白型, , 
.局部变量 文本, 文本型, , , 

读指定类型字段值 (#文本型)


.子程序 _按钮_写文本字段值_被单击, 空白型, , 
写指定类型字段值 (#文本型)


.子程序 取当前字段索引, 整数型, , 
返回 (相加 (.现行选中项, 1))


.子程序 取当前记录号, 整数型, , 
返回 (相加 (.现行选中项, 1))


.子程序 _按钮_读整数字段值_被单击, 空白型, , 
.局部变量 整数, 整数型, , , 
.局部变量 文本, 文本型, , , 

读指定类型字段值 (#整数型)


.子程序 _按钮_写整数字段值_被单击, 空白型, , 
写指定类型字段值 (#整数型)


.子程序 _按钮_读小数字段值_被单击, 空白型, , 
.局部变量 文本, 文本型, , , 

读指定类型字段值 (#小数型)


.子程序 _按钮_写小数字段值_被单击, 空白型, , 
写指定类型字段值 (#小数型)


.子程序 _高级选择夹1_子夹被改变, 空白型, , 
读指定字段值 ()


.子程序 _高级表格1_光标位置改变, 空白型, , 
赋值 (.现行选中项, 相减 (未知支持库函数_3 (), 1))
赋值 (.现行选中项, 相减 (未知支持库函数_4 (), 1))
读指定字段值 ()


.子程序 检查记录号和字段索引, 逻辑型, , 
返回 (并且 (大于 (取当前记录号 (), 0), 大于 (取当前字段索引 (), 0)))


.子程序 读指定类型字段值, 空白型, , 
.参数 字段类型, 整数型, , 0表示清除字节集字段
.参数 是否写到文件, 逻辑型, 可空, 

.局部变量 结果, 逻辑型, , , 
.局部变量 文本, 文本型, , , 
.局部变量 字节集, 字节集, , , 

赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.图片, {  })
.如果真 (是否为空 (是否写到文件))
    赋值 (是否写到文件, 假)
.如果真结束

.如果真 (等于 (检查记录号和字段索引 (), 假))
    返回 ()
.如果真结束

.如果真 (等于 (表.未知支持库函数_104 (), 假))
    返回 ()
.如果真结束

 ' 读字段值
.如果真 (等于 (表.未知支持库函数_112 (取当前记录号 ()), 真))
    .判断开始 (等于 (字段类型, #文本型))
        赋值 (结果, 表.未知支持库函数_135 (取当前字段索引 (), 文本))
    .判断 (等于 (字段类型, #整数型))
        赋值 (结果, 表.未知支持库函数_135 (取当前字段索引 (), 文本))
    .判断 (等于 (字段类型, #小数型))
        赋值 (结果, 表.未知支持库函数_135 (取当前字段索引 (), 文本))
    .判断 (等于 (字段类型, #字节集型))
        赋值 (结果, 表.未知支持库函数_135 (取当前字段索引 (), 字节集))
    .默认
        
    .判断结束
    
.如果真结束

.如果真 (等于 (结果, 假))
    信息框 (“读字段值失败！”, 0, )
    返回 ()
.如果真结束

 ' 写出数据
.判断开始 (等于 (字段类型, #文本型))
    赋值 (.内容, 文本)
.判断 (等于 (字段类型, #整数型))
    赋值 (.内容, 文本)
.判断 (等于 (字段类型, #小数型))
    赋值 (.内容, 文本)
.判断 (等于 (字段类型, #字节集型))
    赋值 (.图片, 字节集)
    .如果真 (等于 (是否写到文件, 真))
        赋值 (.类型, 1) ' 保存
        .如果真 (打开 ())
            .如果 (写到文件 (.文件名, 字节集))
                信息框 (相加 (“已成功写入文件 ”, .文件名), 0, )
            .否则
                信息框 (“写文件失败！”, 0, )
            .如果结束
            
        .如果真结束
        
    .如果真结束
    
.默认
    
.判断结束



.子程序 写指定类型字段值, 空白型, , 
.参数 字段类型, 整数型, , 

.局部变量 结果, 逻辑型, , , 
.局部变量 文本, 文本型, , , 
.局部变量 字节集, 字节集, , , 

.如果真 (等于 (检查记录号和字段索引 (), 假))
    返回 ()
.如果真结束

.如果真 (等于 (表.未知支持库函数_104 (), 假))
    返回 ()
.如果真结束

.如果真 (等于 (字段类型, 0))
    .如果真 (不等于 (信息框 (相加 (“本操作将清除字段 [”, .内容, “] 中的现有数据，确认要继续吗？”), 相加 (#询问图标, #取消是否钮), ), #是钮))
        返回 ()
    .如果真结束
    
.如果真结束

 ' 写读字段值
.如果真 (等于 (表.未知支持库函数_112 (取当前记录号 ()), 真))
    表.未知支持库函数_120 ()
    .判断开始 (等于 (字段类型, #文本型))
        赋值 (结果, 表.未知支持库函数_136 (取当前字段索引 (), .内容))
    .判断 (等于 (字段类型, #整数型))
        赋值 (结果, 表.未知支持库函数_136 (取当前字段索引 (), 到数值 (.内容)))
    .判断 (等于 (字段类型, #小数型))
        赋值 (结果, 表.未知支持库函数_136 (取当前字段索引 (), 到数值 (.内容)))
    .判断 (等于 (字段类型, #字节集型))
        赋值 (.类型, 0) ' 打开
        .如果真 (打开 ())
            赋值 (字节集, 读入文件 (.文件名))
            赋值 (结果, 表.未知支持库函数_136 (取当前字段索引 (), 字节集))
        .如果真结束
        
    .判断 (等于 (字段类型, 0))
        赋值 (结果, 表.未知支持库函数_136 (取当前字段索引 (), {  }))
    .默认
        
    .判断结束
    
    .如果真 (等于 (结果, 假))
        信息框 (“写字段值失败！”, 0, )
        返回 ()
    .如果真结束
    赋值 (结果, 表.未知支持库函数_123 ())
.如果真结束

.如果 (等于 (结果, 真))
    信息框 (“已成功写入字段值！”, 0, )
.否则
    信息框 (“写字段值失败！”, #错误图标, )
.如果结束


.子程序 _组合框_记录序号_列表项被选择, 空白型, , 
读指定字段值 ()

.子程序 _组合框_字段名称_列表项被选择, 空白型, , 
读指定字段值 ()


.子程序 删除表或视图, 空白型, , 
.参数 表或视图名称, 文本型, , 
.参数 是表吗, 逻辑型, , 

.局部变量 表或视图, 文本型, , , 

赋值 (表或视图, 选择 (是表吗, “表”, “视图”))
.如果真 (并且 (等于 (选中项目是表吗 (), 假), 等于 (选中项目是视图吗 (), 假)))
    信息框 (相加 (“请先选中一个”, 表或视图, “，然后执行删除操作！”), 0, )
    返回 ()
.如果真结束

.如果真 (不等于 (信息框 (相加 (“您确认要删除”, 表或视图, “ ”, 表或视图名称, “ 吗？”), 相加 (#询问图标, #取消是否钮), ), #是钮))
    返回 ()
.如果真结束

赋值 (表或视图, 选择 (是表吗, “ table ”, “ view ”))
.如果 (数据库.未知支持库函数_32 (相加 (“drop”, 表或视图, 表或视图名称)))
    信息框 (“已删除。”, 0, )
    刷新数据库显示 ()
.否则
    信息框 (“删除失败！”, #错误图标, )
.如果结束


.子程序 _删除表_被选择, 空白型, , 
删除表或视图 (.取项目文本 (.最大化按钮), 真)

.子程序 _删除视图_被选择, 空白型, , 
删除表或视图 (.取项目文本 (.最大化按钮), 假)


.子程序 _新建视图_被选择, 空白型, , 
.局部变量 sql, 文本型, , , 

.如果真 (输入框 (“请输入创建视图的SQL语句”, “新建视图”, “CREATE VIEW <视图名称> AS <select语句>”, sql, #输入文本))
    .如果 (数据库.未知支持库函数_32 (sql))
        信息框 (“执行成功。”, 0, )
        刷新数据库显示 ()
    .否则
        信息框 (“执行失败！”, #错误图标, )
    .如果结束
    
.如果真结束


.子程序 _新建表_被选择, 空白型, , 
赋值 (窗口_设计表., 真)
赋值 (窗口_设计表., “”)
载入 (窗口_设计表, , 真)


.子程序 _修改表_被选择, 空白型, , 
.如果真 (等于 (选中项目是表吗 (), 假))
    信息框 (“请先选中一个表，然后执行修改操作！”, 0, )
    返回 ()
.如果真结束

赋值 (窗口_设计表., 假)
赋值 (窗口_设计表., .取项目文本 (.最大化按钮))
载入 (窗口_设计表, , 真)


.子程序 _修改视图_被选择, 空白型, , 
.局部变量 视图名称, 文本型, , , 
.局部变量 原视图定义, 文本型, , , 
.局部变量 select, 文本型, , , 
.局部变量 结果, 逻辑型, , , 

.如果真 (等于 (选中项目是视图吗 (), 假))
    信息框 (“请先选中一个视图，然后执行修改操作！”, 0, )
    返回 ()
.如果真结束

赋值 (视图名称, .取项目文本 (.最大化按钮))
赋值 (原视图定义, 数据库.未知支持库函数_53 (视图名称))
.如果真 (输入框 (“请输入新的视图定义SQL语句（只需输入select部分）”, “修改视图”, “SELECT * FROM <表名>”, select, #输入文本))
     ' 先删除原视图,然后重新创建之
    赋值 (结果, 数据库.未知支持库函数_32 (相加 (“DROP VIEW ”, 视图名称)))
    .如果真 (等于 (结果, 假))
        信息框 (“修改视图失败！”, 0, )
        返回 ()
    .如果真结束
    赋值 (结果, 数据库.未知支持库函数_32 (相加 (“CREATE VIEW ”, 视图名称, “ AS ”, select)))
    .如果真 (等于 (结果, 假))
        信息框_附错误文本 (“修改视图失败！”)
        数据库.未知支持库函数_32 (原视图定义) ' 恢复原视图!
        返回 ()
    .如果真结束
    信息框 (“视图修改成功。”, 0, )
    刷新当前表显示 ()
.如果真结束


.子程序 信息框_附错误文本, 空白型, , 
.参数 说明文本, 文本型, , 
.参数 按钮, 整数型, 可空, 
.参数 窗口标题, 文本型, 可空, 

.如果真 (是否为空 (按钮))
    赋值 (按钮, #错误图标)
.如果真结束
.如果真 (是否为空 (窗口标题))
    赋值 (窗口标题, “错误：”)
.如果真结束

信息框 (相加 (说明文本, “错误信息如下：”, #换行符, #换行符, 数据库.未知支持库函数_38 ()), 按钮, 窗口标题)


.子程序 _打开数据库_被选择, 空白型, , 
打开或新建数据库 (假)

.子程序 _新建数据库_被选择, 空白型, , 
打开或新建数据库 (真)

.子程序 _关闭数据库_被选择, 空白型, , 
关闭数据库 ()


.子程序 _执行SQL语句_被选择, 空白型, , 
载入 (窗口_执行SQL语句, , 真)

.子程序 _关于_被选择, 空白型, , 
信息框 (相加 (程序名称, #换行符, #换行符, “任何人都可以随意修改本程序代码并发布，但不得以谋取私利为目的。”), 0, )

.子程序 _取错误文本_被选择, 空白型, , 
信息框 (相加 (“最近一次操作的错误信息：”, 数据库.未知支持库函数_38 ()), 0, “取错误文本()：”)

.子程序 _取错误码_被选择, 空白型, , 
信息框 (相加 (“最近一次操作的错误码：”, 到文本 (数据库.未知支持库函数_37 ())), 0, “取错误码()：”)

.子程序 _取最新插入ID_被选择, 空白型, , 
信息框 (相加 (“最近一次插入记录时自动生成的记录ID：”, 到文本 (数据库.未知支持库函数_39 ())), 0, “取最新插入ID()：”)


.子程序 _退出_被选择, 空白型, , 
关闭数据库 ()
销毁 ()

.子程序 _高级表格1_将被编辑, 空白型, , 
 ' 因为高级表格 1.1#4 版之前的一个BUG，调用“取数据/行号/列号”后，编辑状态立刻被退出！请选择最新的表格支持库。
.如果真 (并且 (不等于 (未知支持库函数_3 (), -1), 不等于 (未知支持库函数_4 (), -1)))
    赋值 (原单元格文本, 未知支持库函数_3 ().未知支持库函数_10 (未知支持库函数_4 ()))
.如果真结束


.子程序 _高级表格1_结束编辑, 空白型, , 将用户修改的内容提交到数据库
.局部变量 单元格文本, 文本型, , , 
.局部变量 行, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 字段名称, 文本型, , , 

.如果真 (等于 (选中项目是表吗 (), 假))
    返回 ()
.如果真结束
.如果真 (等于 (表.未知支持库函数_104 (), 假))
    返回 ()
.如果真结束

赋值 (行, 未知支持库函数_3 ())
赋值 (列, 未知支持库函数_4 ())
.如果真 (或者 (等于 (行, -1), 等于 (列, -1)))
    返回 ()
.如果真结束
赋值 (单元格文本, 行.未知支持库函数_10 (列))

 ' 下面这个判断非常重要，尤其对于字节集字段！（字节集值通常不能在表格中完整的显示出来。）
.如果真 (等于 (单元格文本, 原单元格文本)) ' 没有被用户修改，不必更新数据库
    返回 ()
.如果真结束

表.未知支持库函数_112 (行)
表.未知支持库函数_120 ()
表.未知支持库函数_136 (列, 单元格文本)
.如果 (等于 (表.未知支持库函数_123 (), 假))
    信息框_附错误文本 (“修改字段值失败！”)
.否则
    赋值 (字段名称, 0.未知支持库函数_10 (列))
    写操作日志 (相加 (“已修改 ”, 字段名称, “ 字段值：”, 单元格文本))
.如果结束


.子程序 _高级表格1_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (选中项目是表吗 ())
    弹出菜单 ()
.如果真结束


.子程序 _插入空记录_被选择, 空白型, , 
.局部变量 sql, 文本型, , , 
.局部变量 i, 整数型, , , 

.如果真 (等于 (选中项目是表吗 (), 假))
    返回 ()
.如果真结束
.如果真 (等于 (表.未知支持库函数_104 (), 假))
    返回 ()
.如果真结束

 ' 生成如下SQL语句并执行
 ' insert into <表名> values(null,null,null,...)

.计次循环首 (表.未知支持库函数_152 (), i)
    赋值 (sql, 相加 (sql, “null,”))
.计次循环尾 ()
 ' 删除最后的“,”
.如果真 (大于 (取文本长度 (sql), 0))
    赋值 (sql, 取文本左边 (sql, 相减 (取文本长度 (sql), 1)))
.如果真结束

赋值 (sql, 相加 (“insert into ”, 表.未知支持库函数_148 (), “ values(”, sql, “)”))
.如果 (数据库.未知支持库函数_32 (sql))
    刷新当前表显示 ()
    信息框 (“已成功插入空记录。”, 0, )
.否则
    信息框 (相加 (“插入空记录失败！表 ”, 表.未知支持库函数_148 (), “ 不允许插入空记录，可能因为：存在主键；某字段不允许为null。”), 0, )
.如果结束



.子程序 _插入记录_被选择, 空白型, , 
载入 (窗口_插入记录, , 真)


.子程序 _删除当前记录_被选择, 空白型, , 
.如果真 (等于 (选中项目是表吗 (), 假))
    信息框 (“只有表才可以被删除记录！”, 0, )
    返回 ()
.如果真结束

.如果真 (等于 (表.未知支持库函数_104 (), 假))
    信息框 (“表尚未打开。”, #错误图标, )
    返回 ()
.如果真结束

.如果真 (不等于 (信息框 (“您确认要删除当前记录吗？”, 相加 (#询问图标, #取消是否钮), ), #是钮))
    返回 ()
.如果真结束

表.未知支持库函数_112 (取当前记录号 ())
.如果 (表.未知支持库函数_122 ())
    刷新当前表显示 ()
    信息框 (“已成功删除当前记录。”, 0, )
.否则
    信息框_附错误文本 (“删除当前记录失败！”)
.如果结束


.子程序 _开始事务_被选择, 空白型, , 
.如果 (数据库.未知支持库函数_44 ())
    信息框 (“已成功启动事务。”, 0, )
.否则
    信息框_附错误文本 (“启动事务失败！”)
.如果结束


.子程序 _提交事务_被选择, 空白型, , 
.如果 (数据库.未知支持库函数_45 ())
    信息框 (“已成功提交事务。”, 0, )
.否则
    信息框_附错误文本 (“提交事务失败！”)
.如果结束


.子程序 _回滚事务_被选择, 空白型, , 
.如果 (数据库.未知支持库函数_46 ())
    信息框 (“已成功回滚事务。”, 0, )
.否则
    信息框_附错误文本 (“回滚事务失败！”)
.如果结束


.子程序 _修改表名称_被选择, 空白型, , 
修改表或视图名称 (真)

.子程序 修改表或视图名称, 空白型, , 
.参数 是表吗, 逻辑型, , 

.局部变量 表或视图, 文本型, , , 
.局部变量 原名称, 文本型, , , 
.局部变量 新名称, 文本型, , , 
.局部变量 结果, 逻辑型, , , 

赋值 (表或视图, 选择 (是表吗, “表”, “视图”))
.如果真 (并且 (等于 (选中项目是表吗 (), 假), 等于 (选中项目是视图吗 (), 假)))
    信息框 (相加 (“请先选择要改名的”, 表或视图, “！”), 0, )
    返回 ()
.如果真结束

赋值 (原名称, .取项目文本 (.最大化按钮))
.如果真 (输入框 (相加 (“请输入新的”, 表或视图, “名称：”), , 原名称, 新名称, #输入文本))
    .如果真 (等于 (新名称, “”))
        信息框 (相加 (表或视图, “名称不能为空！”), 0, )
        返回 ()
    .如果真结束
    .如果真 (等于 (新名称, 原名称))
        信息框 (相加 (“您输入的”, 表或视图, “名称与原名称相同！无需修改。”), 0, )
        返回 ()
    .如果真结束
    
    .如果 (是表吗)
        赋值 (结果, 修改表名称 (原名称, 新名称))
    .否则
        赋值 (结果, 修改视图名称 (原名称, 新名称))
    .如果结束
    .如果 (结果)
        信息框 (相加 (“已成功修改”, 表或视图, “名称！”), 0, )
        刷新数据库显示 ()
        刷新当前表显示 ()
    .否则
        信息框_附错误文本 (相加 (“修改”, 表或视图, “名称时发生错误！”))
    .如果结束
    
.如果真结束


.子程序 修改表名称, 逻辑型, , 
.参数 原名称, 文本型, , 
.参数 新名称, 文本型, , 

返回 (数据库.未知支持库函数_32 (相加 (“ALTER TABLE ”, 原名称, “ RENAME TO ”, 新名称)))

.子程序 修改视图名称, 逻辑型, , 先删除原视图，然后使用新名称重新创建
.参数 原名称, 文本型, , 
.参数 新名称, 文本型, , 

.局部变量 原视图定义, 文本型, , , 
.局部变量 新视图定义, 文本型, , , 
.局部变量 n1, 整数型, , , 
.局部变量 n2, 整数型, , , 
.局部变量 n3, 整数型, , , 
.局部变量 结果1, 逻辑型, , , 
.局部变量 结果2, 逻辑型, , , 

赋值 (原视图定义, 数据库.未知支持库函数_53 (原名称))
.如果真 (等于 (原视图定义, “”))
    返回 (假)
.如果真结束

赋值 (n1, 寻找文本 (原视图定义, “ VIEW ”, , 真))
.如果真 (小于或等于 (n1, 1))
    返回 (假)
.如果真结束
赋值 (n1, 相加 (n1, 6))

赋值 (n2, 寻找文本 (原视图定义, 原名称, n1, 真))
.如果真 (小于或等于 (n2, 1))
    返回 (假)
.如果真结束
赋值 (n2, 相加 (n2, 取文本长度 (原名称)))

赋值 (n3, 寻找文本 (原视图定义, “ AS ”, n2, 真))
.如果真 (小于或等于 (n3, 1))
    返回 (假)
.如果真结束

赋值 (新视图定义, 相加 (取文本左边 (原视图定义, 相减 (n1, 1)), 新名称, 取文本右边 (原视图定义, 相加 (相减 (取文本长度 (原视图定义), n3), 1))))
输出调试文本 (新视图定义)

.如果真 (数据库.未知支持库函数_44 ())
    赋值 (结果1, 数据库.未知支持库函数_32 (相加 (“DROP VIEW ”, 原名称)))
    赋值 (结果2, 数据库.未知支持库函数_32 (新视图定义))
    .如果真 (并且 (结果1, 结果2, 数据库.未知支持库函数_45 ()))
        返回 (真)
    .如果真结束
    
.如果真结束

数据库.未知支持库函数_46 ()
返回 (假)

.子程序 _修改视图名称_被选择, 空白型, , 
修改表或视图名称 (假)


.子程序 _树型框1_右键单击项目, 空白型, , 
.如果真 (选中项目是表吗 ())
    弹出菜单 ()
.如果真结束
.如果真 (选中项目是视图吗 ())
    弹出菜单 ()
.如果真结束



.子程序 _备份数据库_被选择, 空白型, , 
备份数据库文件 (数据库文本名)


.程序集 实用程序文集, , , 

.程序集变量 匿名程序集变量_680, 空白型, , , 
.子程序 数组导入高级表格, 空白型, , 
.参数 表格, 未知类型0x60001, , 
.参数 数组, 文本型, 数组, 
.参数 含表头, 逻辑型, 可空, 
.参数 加序号, 逻辑型, 可空, 是否在表格最左边添加“序号”列(1,2,..)

.局部变量 行数, 整数型, , , 
.局部变量 列数, 整数型, , , 
.局部变量 行, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 序号, 文本型, , , 

.如果真 (是否为空 (含表头))
    赋值 (含表头, 假)
.如果真结束
.如果真 (是否为空 (加序号))
    赋值 (加序号, 真)
.如果真结束

赋值 (行数, 取数组下标 (数组, 1))
赋值 (列数, 取数组下标 (数组, 2))
检查 (等于 (取数组下标 (数组, 3), 0)) ' 只能为一维或二维数组
表格.未知支持库函数_57 ()
赋值 (表格., 0)
赋值 (表格., 0)
赋值 (列数, 选择 (大于 (列数, 0), 列数, 1))
赋值 (行数, 选择 (大于 (行数, 0), 行数, 1))
赋值 (表格., 行数)
赋值 (表格., 列数)

 ' 将数组内容写入表格
.计次循环首 (取数组成员数 (数组), i)
    赋值 (行, 相除 (相减 (i, 1), 列数))
    赋值 (列, 求余数 (相减 (i, 1), 列数))
    表格.未知支持库函数_9 (行, 列, #., 数组 [i])
.计次循环尾 ()

 ' 在表格最左边添加“序号”列
.如果真 (加序号)
    表格.未知支持库函数_39 (“序号”, 0)
    .计次循环首 (行数, i)
        .如果 (并且 (等于 (i, 1), 含表头))
            赋值 (序号, “序号”)
        .否则
            赋值 (序号, 到文本 (选择 (含表头, 相减 (i, 1), i)))
        .如果结束
        
        表格.未知支持库函数_9 (相减 (i, 1), 0, #., 序号)
    .计次循环尾 ()
.如果真结束

赋值 (表格., 选择 (含表头, 1, 0))
赋值 (表格., 选择 (加序号, 1, 0))


.子程序 数组导入组合框, 空白型, , 
.参数 组合框, 组合框, 参考, 
.参数 数组, 文本型, 数组, 
.参数 选中项, 整数型, 可空, 

.局部变量 i, 整数型, , , 

.如果真 (是否为空 (选中项))
    赋值 (选中项, 0)
.如果真结束

组合框.清空 ()
.计次循环首 (取数组成员数 (数组), i)
    组合框.加入项目 (数组 [i], )
.计次循环尾 ()
赋值 (组合框.现行选中项, 选中项)


.子程序 数值填充组合框, 空白型, , 指定一个数值范围，以填充组合框各项目
.参数 组合框, 组合框, 参考, 
.参数 最小值, 整数型, , 
.参数 最大值, 整数型, , 
.参数 选中项, 整数型, 可空, 

.局部变量 i, 整数型, , , 

.如果真 (是否为空 (选中项))
    赋值 (选中项, 0)
.如果真结束

组合框.清空 ()
.计次循环首 (相加 (相减 (最大值, 最小值), 1), i)
    组合框.加入项目 (到文本 (相减 (相加 (最小值, i), 1)), )
.计次循环尾 ()
赋值 (组合框.现行选中项, 选中项)


.子程序 批量禁止工具栏按钮, 空白型, , 批量设置工具栏按钮的禁止与否，漂亮！
.参数 工具条, 工具条, , 
.参数 是否禁止, 逻辑型, , 
.参数 按钮索引列表, 文本型, , 以逗号间隔，形如“0,1,2,3”

.局部变量 索引数组, 文本型, , "0", 
.局部变量 i, 整数型, , , 

赋值 (索引数组, 分割文本 (按钮索引列表, “,”, ))
.计次循环首 (取数组成员数 (索引数组), i)
    .如果 (是否禁止)
        工具条.加入状态 (到数值 (索引数组 [i]), #禁止)
    .否则
        工具条.去除状态 (到数值 (索引数组 [i]), #禁止)
    .如果结束
    
.计次循环尾 ()

.子程序 批量禁止菜单, 空白型, , 批量设置多个菜单对象的禁止与否
.参数 是否禁止, 逻辑型, , 
.参数 菜单数组, 菜单, 数组, 

.局部变量 i, 整数型, , , 

.计次循环首 (取数组成员数 (菜单数组), i)
    赋值 (菜单数组 [i], 禁止, 是否禁止)
.计次循环尾 ()


.窗口程序集 窗口程序集2, , , 

.子程序 _窗口1_创建完毕, 空白型, , 


.子程序 _窗口1_尺寸被改变, 空白型, , 
8.移动 (相加 (.顶边, .高度, 2), 相减 (窗口1.取用户区宽度 (), 相乘 (8, 2)), 相减 (窗口1.取用户区高度 (), 相乘 (8, 3), .高度, .高度))
相减 (窗口1.取用户区宽度 (), .宽度, 8).移动 (相减 (窗口1.取用户区高度 (), .高度, 8), , )

.子程序 _按钮1_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集3, , , 

.子程序 _窗口_执行SQL语句_创建完毕, 空白型, , 
.局部变量 SQL模板文本, 文本型, , , 
.局部变量 SQL模板数组, 文本型, , "0", 
.局部变量 i, 整数型, , , 

赋值 (.可否移动, _启动窗口..可否移动)
赋值 (.图标, _启动窗口..图标)

 ' 设置SQL模板
赋值 (., 假)
#顶层.调整层次 ()
0.移动 (0, .左边, 取用户区高度 ())
0.未知支持库函数_32 (32)
1.未知支持库函数_32 (相减 (., 50))
0.未知支持库函数_9 (0, #., “序号”)
0.未知支持库函数_9 (1, #., “SQL模板”)
赋值 (SQL模板文本, 到文本 (读入文件 (相加 (取运行目录 (), “\SQL模板.txt”))))
赋值 (SQL模板数组, 分割文本 (SQL模板文本, #换行符, ))
赋值 (., 相加 (取数组成员数 (SQL模板数组), 1))
.计次循环首 (取数组成员数 (SQL模板数组), i)
    i.未知支持库函数_9 (0, #., 到文本 (i))
    i.未知支持库函数_9 (1, #., SQL模板数组 [i])
.计次循环尾 ()

.子程序 _按钮_从模板导入_被单击, 空白型, , 
赋值 (., 取反 (.))


.子程序 _高级表格1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_应用选中行_被选择 ()


.子程序 _树型框1_双击项目, 空白型, , 
.局部变量 附加数值, 整数型, , , 
.局部变量 临时文本, 文本型, , , 

赋值 (附加数值, .取项目数值 (.最大化按钮))
.如果真 (或者 (是表吗 (附加数值), 是视图吗 (附加数值)))
    赋值 (临时文本, 取剪辑板文本 ())
    置剪辑板文本 (.取项目文本 (.最大化按钮))
    770.发送信息 (0, 0) ' 粘贴
    置剪辑板文本 (临时文本) ' 恢复剪辑板文本
.如果真结束


.子程序 _高级表格1_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()


.子程序 _应用选中行_被选择, 空白型, , 
.局部变量 行, 整数型, , , 
.局部变量 文本, 文本型, , , 

赋值 (行, 未知支持库函数_3 ())
.如果真 (等于 (行, -1))
    返回 ()
.如果真结束

赋值 (.内容, 行.未知支持库函数_10 (1))
 ' 因为易4.0之前的一个BUG，对“允许输入多行”属性为真的编辑框的“内容”属性赋值，不会触发“内容被改变”事件!
_编辑框_SQL语句_内容被改变 ()

赋值 (., 假)


.子程序 _关闭SQL模板_被选择, 空白型, , 
赋值 (., 假)


.子程序 _按钮_确定_被单击, 空白型, , 
.局部变量 结果, 逻辑型, , , 
.局部变量 数组, 文本型, , "0", 

.如果 (.选中)
    记录集.未知支持库函数_184 (.内容, 数据库)
    赋值 (结果, 记录集.未知支持库函数_190 ())
    .如果真 (等于 (结果, 真))
        赋值 (数组, 记录集.未知支持库函数_209 (真))
        赋值 (_启动窗口..最大化按钮, 0) ' 会清除原有显示内容
        数组导入高级表格 (_启动窗口., 数组, 真, 真)
        信息框 (“查询成功，查询结果已显示到主窗口表格中。”, 0, )
        返回 ()
    .如果真结束
    
.否则
    赋值 (结果, 数据库.未知支持库函数_32 (.内容))
    _启动窗口.刷新数据库显示 () ' 因为执行SQL语句有可以改变新建和删除了表和视图
    信息框 (“SQL语句执行成功！”, 0, )
    返回 ()
.如果结束

.如果真 (等于 (结果, 假))
    信息框_附错误文本 (“SQL语句执行失败！”)
.如果真结束


.子程序 _按钮_关闭_被单击, 空白型, , 
销毁 ()


.子程序 _编辑框_SQL语句_内容被改变, 空白型, , 
.局部变量 sql, 文本型, , , 
.局部变量 关键字数组, 文本型, , "0", 
.局部变量 i, 整数型, , , 

赋值 (sql, 删首尾空 (.内容))
.如果真 (等于 (寻找文本 (sql, “select”, , 真), 1))
    赋值 (.选中, 真)
    赋值 (.选中, 假)
    返回 ()
.如果真结束

赋值 (关键字数组, { “update”, “delete”, “insert”, “create”, “drop” })
.计次循环首 (取数组成员数 (关键字数组), i)
    .如果真 (等于 (寻找文本 (sql, 关键字数组 [i], , 真), 1))
        赋值 (.选中, 真)
        赋值 (.选中, 假)
        返回 ()
    .如果真结束
    
.计次循环尾 ()


.子程序 _按钮_从文件导入_被单击, 空白型, , 
.如果真 (打开 ())
    赋值 (.内容, 到文本 (读入文件 (.文件名)))
    
.如果真结束


.窗口程序集 窗口程序集4, , , 

.程序集变量 是否创建表, 逻辑型, , , 标识是创建表还是修改表。本标记由外界赋值。
.程序集变量 要修改的表名, 文本型, , , 由外界赋值
.程序集变量 匿名程序集变量_772, 空白型, , , 
.程序集变量 原字段名称数组, 文本型, , "0", 表修改前的字段
.程序集变量 后台字段信息数组, 字段及附加信息, , "0", 要与表格中的显示保持一至
.程序集变量 匿名程序集变量_1008, 空白型, , , 
.程序集变量 下光标键加行, 逻辑型, , , 
.程序集变量 已按下上光标键, 逻辑型, , , 
.子程序 _窗口_设计表_创建完毕, 空白型, , 
.局部变量 匿名局部变量_1264, 空白型, , , 

初始化表格 ()
赋值 (., 选择 (是否创建表, “创建表”, 相加 (“修改表 - ”, 要修改的表名)))
.如果真 (等于 (是否创建表, 假))
     ' 修改表时要做的工作
    .如果真 (等于 (数据库.未知支持库函数_50 (要修改的表名), 假))
        信息框 (相加 (“不存在表：”, 要修改的表名, “！”), #错误图标, )
        销毁 ()
        返回 ()
    .如果真结束
    初始化字段 ()
.如果真结束

初始化后台字段信息 ()
更新序号 ()
1.未知支持库函数_0 (1)

.子程序 初始化表格, 空白型, , 
赋值 (., 2)
赋值 (., 4)

0.未知支持库函数_32 (32)
0.未知支持库函数_9 (0, #., “序号”)

1.未知支持库函数_30 (#.)
1.未知支持库函数_32 (130)
0.未知支持库函数_9 (1, #., “字段名称”)

未知支持库函数_28 ()
#字段类型_空.未知支持库函数_29 ()
#字段类型_整数.未知支持库函数_29 ()
#字段类型_小数.未知支持库函数_29 ()
#字段类型_文本.未知支持库函数_29 ()
#字段类型_字节集.未知支持库函数_29 ()
#字段类型_通用型.未知支持库函数_29 ()
#字段类型_主键.未知支持库函数_29 ()
2.未知支持库函数_30 (#.)
2.未知支持库函数_32 (100)
0.未知支持库函数_9 (2, #., “字段类型”)

3.未知支持库函数_30 (#.)
3.未知支持库函数_32 (100)
0.未知支持库函数_9 (3, #., “最大文本长度”)


.子程序 初始化字段, 空白型, , 显示出要修改的表中现有的字段信息
.局部变量 表定义, 文本型, , , 
.局部变量 n1, 整数型, , , 
.局部变量 n2, 整数型, , , 
.局部变量 n, 整数型, , , 
.局部变量 字段定义, 文本型, , , 
.局部变量 数组, 文本型, , "0", 
.局部变量 文本, 文本型, , , 
.局部变量 字段名称, 文本型, , , 
.局部变量 字段类型名称, 文本型, , , 
.局部变量 最大文本长度, 整数型, , , 
.局部变量 i, 整数型, , , 

.如果真 (等于 (表.未知支持库函数_105 (要修改的表名, 数据库), 假))
    返回 ()
.如果真结束
赋值 (原字段名称数组, 表.未知支持库函数_153 ())
表.未知支持库函数_106 ()

 ' 下面要分析表定义，提取出各字段的属性（名称、类型、最大文本长度）
 ' 表定义一般如下：
 ' CREATE TABLE tablename (int INTEGER, double NUMERIC, text TEXT, blob BLOB, id INTEGER PRIMARY KEY, tongyong)
赋值 (表定义, 数据库.未知支持库函数_53 (要修改的表名))
检查 (大于 (取文本长度 (表定义), 0))
赋值 (n1, 寻找文本 (表定义, “(”, , 假))
赋值 (n2, 倒找文本 (表定义, “)”, , 假))
赋值 (字段定义, 取文本中间 (表定义, 相加 (n1, 1), 相减 (n2, n1, 1))) ' 取第一个“(”与最后一个“)”之间的文本
赋值 (数组, 分割文本 (字段定义, “,”, ))
赋值 (., 相加 (取数组成员数 (数组), 1))
.计次循环首 (取数组成员数 (数组), i)
    赋值 (字段类型名称, “”)
    赋值 (最大文本长度, 0)
    
    赋值 (文本, 删首尾空 (数组 [i]))
    赋值 (字段名称, 文本)
    赋值 (n, 寻找文本 (文本, “ ”, , 假))
     ' 也可能只有字段名称
    .如果真 (大于 (n, 0))
        赋值 (字段名称, 删首尾空 (取文本左边 (文本, 相减 (n, 1))))
        赋值 (字段类型名称, 删首尾空 (取文本右边 (文本, 相减 (取文本长度 (文本), n))))
        赋值 (n1, 寻找文本 (字段类型名称, “(”, , 假))
        赋值 (n2, 寻找文本 (字段类型名称, “)”, , 假))
        .如果真 (并且 (大于 (n1, 0), 大于 (n2, n1))) ' 从字段类型名称中分解出最大文本长度
            赋值 (文本, 字段类型名称)
            赋值 (字段类型名称, 删首尾空 (取文本左边 (文本, 相减 (n1, 1))))
            赋值 (最大文本长度, 到数值 (删首尾空 (取文本中间 (文本, 相加 (n1, 1), 相减 (n2, n1, 1)))))
        .如果真结束
        
    .如果真结束
    
    i.未知支持库函数_9 (1, #., 字段名称)
    i.未知支持库函数_9 (2, #., 取字段类型显示文本 (字段类型名称))
    i.未知支持库函数_9 (3, #., 到文本 (最大文本长度))
.计次循环尾 ()


.子程序 取字段类型显示文本, 文本型, , 
.参数 字段类型名称, 文本型, , 出现于表定义SQL语句中的类型文本，如integer,text等

.如果真 (或者 (等于 (字段类型名称, “”), 等于 (字段类型名称, “none”)))
    返回 (#字段类型_空)
.如果真结束

.如果真 (大于 (寻找文本 (“text,char,varchar,”, 相加 (字段类型名称, “,”), , 真), 0))
    返回 (#字段类型_文本)
.如果真结束
.如果真 (大于 (寻找文本 (“int,integer,int64,short,byte,”, 相加 (字段类型名称, “,”), , 真), 0))
    返回 (#字段类型_整数)
.如果真结束
.如果真 (大于 (寻找文本 (“numeric,double,float,”, 相加 (字段类型名称, “,”), , 真), 0))
    返回 (#字段类型_小数)
.如果真结束
.如果真 (大于 (寻找文本 (“blob,”, 相加 (字段类型名称, “,”), , 真), 0))
    返回 (#字段类型_字节集)
.如果真结束
.如果真 (大于 (寻找文本 (“integer primary key,”, 相加 (字段类型名称, “,”), , 真), 0))
    返回 (#字段类型_主键)
.如果真结束
返回 (#字段类型_空)


.子程序 _高级表格1_光标位置改变, 空白型, , 删除最后一个空行
.局部变量 行, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 行数, 整数型, , , 

赋值 (行, 未知支持库函数_3 ())
赋值 (列, 未知支持库函数_4 ())
赋值 (行数, .)
.如果真 (小于或等于 (., 2)) ' 至少保留表头和一个空行
    返回 ()
.如果真结束

.如果真 (或者 (等于 (行, -1), 等于 (列, -1)))
    返回 ()
.如果真结束

.如果真 (并且 (等于 (行, 相减 (行数, 1)), 等于 (已按下上光标键, 假))) ' 光标在最后一行，且不会立刻切换到上一行，不删除
    返回 ()
.如果真结束

.如果真 (并且 (等于 (行, 相减 (行数, 2)), 下光标键加行)) ' 光标在倒数第二行，但即将切换到最后一行，不删除
    返回 ()
.如果真结束

 ' 删除最后一个空行
.如果真 (等于 (删首尾空 (相减 (., 1).未知支持库函数_10 (1)), “”))
    赋值 (., 相减 (., 1))
    .如果真 (等于 (后台字段信息数组 [取数组成员数 (后台字段信息数组)].字段名称, “”))
        删除成员 (后台字段信息数组, 取数组成员数 (后台字段信息数组), 1)
    .如果真结束
    
    .如果真 (已按下上光标键)
        行.未知支持库函数_0 (列)
    .如果真结束
    
.如果真结束


.子程序 _高级表格1_按下某键, 逻辑型, , 在表格最后一行按下光标键，新增一行
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 行, 整数型, , , 
.局部变量 列, 整数型, , , 

赋值 (下光标键加行, 假)
赋值 (已按下上光标键, 假)
.如果真 (等于 (键代码, #下光标键))
    赋值 (行, 未知支持库函数_3 ())
    赋值 (列, 未知支持库函数_4 ())
    .如果真 (或者 (等于 (行, -1), 等于 (列, -1)))
        返回 ()
    .如果真结束
    
    .如果真 (不等于 (行, 相减 (., 1))) ' 或 列 ＝ 2
        返回 ()
    .如果真结束
    
     ' 在表格最后一行按下光标键，新增一行
    .如果真 (不等于 (行.未知支持库函数_10 (1), “”))
        插入表格行 (假)
        相加 (行, 1).未知支持库函数_0 (列)
         ' 高级表格1.行数 ＝ 高级表格1.行数 ＋ 1
         ' 更新序号 ()
         ' 下光标键加行 ＝ 真
    .如果真结束
    
.如果真结束
.如果真 (等于 (键代码, #上光标键))
    赋值 (已按下上光标键, 真)
.如果真结束


.子程序 插入表格行, 空白型, , 
.参数 向前插入, 逻辑型, , 向前? 向后?

.局部变量 行, 整数型, , , 
.局部变量 后台字段信息, 字段及附加信息, , , 

赋值 (行, 未知支持库函数_3 ())
.如果真 (小于 (行, 1))
    返回 ()
.如果真结束

赋值 (后台字段信息.新添加, 真) ' !
.如果 (向前插入)
    “”.未知支持库函数_38 (行)
    插入成员 (后台字段信息数组, 取表格行后台数组索引 (行), 后台字段信息)
.否则
    “”.未知支持库函数_38 (相加 (行, 1))
    插入成员 (后台字段信息数组, 取表格行后台数组索引 (相加 (行, 1)), 后台字段信息)
.如果结束

更新序号 ()


.子程序 _按钮_向前插入字段_被单击, 空白型, , 
插入表格行 (真)

.子程序 _按钮_向后插入字段_被单击, 空白型, , 
插入表格行 (假)

.子程序 删除表格行, 空白型, , 
.参数 行, 整数型, , 

行.未知支持库函数_36 ()
赋值 (后台字段信息数组 [取表格行后台数组索引 (行)].已删除, 真) ' !
更新序号 ()


.子程序 _按钮_删除字段_被单击, 空白型, , 
.局部变量 行, 整数型, , , 

赋值 (行, 未知支持库函数_3 ())
.如果真 (小于 (行, 1))
    返回 ()
.如果真结束

.如果真 (不等于 (信息框 (相加 (“您确认要删除字段 ”, 行.未知支持库函数_10 (1), “ 吗？”), 相加 (#询问图标, #取消是否钮), ), #是钮))
    返回 ()
.如果真结束

删除表格行 (行)

.子程序 初始化后台字段信息, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 j, 整数型, , , 

重定义数组 (后台字段信息数组, 假, 相减 (., 1))
.计次循环首 (相减 (., 1), i)
    写后台字段信息_指定行 (i, i)
    赋值 (后台字段信息数组 [i], 已删除, 假)
    赋值 (后台字段信息数组 [i], 新添加, 假)
.计次循环尾 ()


.子程序 写后台字段信息_指定行, 空白型, , 
.参数 前台索引, 整数型, , 表格行号,>=1
.参数 后台索引, 空白型, , >=1

赋值 (后台字段信息数组 [后台索引], 字段名称, 前台索引.未知支持库函数_10 (1))
赋值 (后台字段信息数组 [后台索引], 字段类型文本, 前台索引.未知支持库函数_10 (2))
赋值 (后台字段信息数组 [后台索引], 字段最大文本长度文本, 前台索引.未知支持库函数_10 (3))


.子程序 _按钮_确定_被单击, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 行, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 字段数组, 未知类型0x5000A, , "0", 
.局部变量 字段, 未知类型0x5000A, , , 
.局部变量 字段名称, 文本型, , , 
.局部变量 字段类型, 整数型, , , 
.局部变量 最大文本长度, 整数型, , , 
.局部变量 结果, 逻辑型, , , 

清除数组 (字段数组)
赋值 (行, 0)
.计次循环首 (取数组成员数 (后台字段信息数组), i)
    .如果真 (等于 (后台字段信息数组 [i], 已删除, 真))
        到循环尾 ()
    .如果真结束
    
    赋值 (行, 相加 (行, 1))
    赋值 (字段名称, 删首尾空 (后台字段信息数组 [i], 字段名称))
    .如果真 (等于 (字段名称, “”))
        行.未知支持库函数_0 (1)
        信息框 (“字段名称不能为空！”, 0, )
        返回 ()
    .如果真结束
    
    赋值 (字段类型, 取字段类型 (删首尾空 (后台字段信息数组 [i], 字段类型文本)))
    .如果真 (等于 (字段类型, -100))
        行.未知支持库函数_0 (2)
        信息框 (相加 (“字段 ”, 字段名称, “ 的类型设置错误！请从下拉列表中选取。”), 0, )
        返回 ()
    .如果真结束
    
    赋值 (最大文本长度, 到数值 (删首尾空 (后台字段信息数组 [i], 字段最大文本长度文本)))
    .如果真 (小于 (最大文本长度, 0))
        行.未知支持库函数_0 (3)
        信息框 (相加 (“字段 ”, 字段名称, “ 的最大文本长度不能为负数！”), 0, )
        返回 ()
    .如果真结束
    
    赋值 (字段., 字段名称)
    赋值 (字段., 字段类型)
    赋值 (字段., 最大文本长度)
    加入成员 (字段数组, 字段)
.计次循环尾 ()
.如果真 (等于 (取数组成员数 (字段数组), 0))
    信息框 (“尚未添加任何字段！”, #警告图标, )
    返回 ()
.如果真结束

.如果 (是否创建表)
    创建表 (字段数组)
.否则
    修改表 (字段数组)
.如果结束


.子程序 创建表, 空白型, , 
.参数 字段数组, 未知类型0x5000A, 数组, 

.局部变量 表名称, 文本型, , , 
.局部变量 结果, 逻辑型, , , 

.如果 (输入框 (“请输入要创建的表名称：”, , , 表名称, #输入文本))
    .如果真 (等于 (删首尾空 (表名称), “”))
        信息框 (“表名称不能为空！”, 0, )
        返回 ()
    .如果真结束
    .如果真 (等于 (数据库.未知支持库函数_50 (表名称), 真))
        信息框 (相加 (“表”, #左引号, 表名称, #右引号, “已经存在于数据库中！”), 0, )
        返回 ()
    .如果真结束
    
.否则
    返回 () ' 用户按了“取消”按钮
.如果结束

赋值 (结果, 数据库.未知支持库函数_61 (表名称, 字段数组))
.如果 (等于 (结果, 真))
    信息框 (相加 (“已成功创建表”, #左引号, 表名称, #右引号, “！”), 0, )
    _启动窗口.刷新数据库显示 ()
    销毁 ()
    返回 ()
.否则
    信息框 (相加 (“创建表失败，错误信息如下：”, #换行符, #换行符, 数据库.未知支持库函数_38 ()), 0, )
.如果结束


.子程序 修改表, 空白型, , 
.参数 字段数组, 未知类型0x5000A, 数组, 

.局部变量 旧表字段, 文本型, , , 
.局部变量 新表字段, 文本型, , , 
.局部变量 i, 整数型, , , 
.局部变量 n, 整数型, , , 
.局部变量 结果1, 逻辑型, , , 
.局部变量 结果2, 逻辑型, , , 
.局部变量 结果3, 逻辑型, , , 
.局部变量 结果4, 逻辑型, , , 
.局部变量 结果5, 逻辑型, , , 
.局部变量 结果6, 逻辑型, , , 
.局部变量 临时表名, 文本型, , , 

 ' 找出修改表前后相对应的字段，用于在两表之间导数据
赋值 (n, 0)
.计次循环首 (取数组成员数 (后台字段信息数组), i)
    .如果真 (等于 (后台字段信息数组 [i], 新添加, 假))
        赋值 (n, 相加 (n, 1))
    .如果真结束
    .如果真 (并且 (等于 (后台字段信息数组 [i], 已删除, 假), 等于 (后台字段信息数组 [i], 新添加, 假)))
        赋值 (旧表字段, 相加 (旧表字段, 原字段名称数组 [n], “,”))
        赋值 (新表字段, 相加 (新表字段, 后台字段信息数组 [i], 字段名称, “,”))
    .如果真结束
    
.计次循环尾 ()
.如果真 (不等于 (旧表字段, “”))
    赋值 (旧表字段, 取文本左边 (旧表字段, 相减 (取文本长度 (旧表字段), 1))) ' 删除最的“,”
.如果真结束
.如果真 (不等于 (新表字段, “”))
    赋值 (新表字段, 取文本左边 (新表字段, 相减 (取文本长度 (新表字段), 1))) ' 删除最的“,”
.如果真结束
.如果真 (或者 (等于 (旧表字段, “”), 等于 (新表字段, “”))) ' 无需导数据，直接删除旧表，创建新表即可。
    数据库.未知支持库函数_44 ()
    赋值 (结果1, 数据库.未知支持库函数_63 (要修改的表名))
    赋值 (结果2, 数据库.未知支持库函数_61 (要修改的表名, 字段数组))
    .如果真 (并且 (结果1, 结果2))
        .如果真 (数据库.未知支持库函数_45 ())
            刷新数据库显示 ()
            刷新当前表显示 ()
            信息框 (相加 (“修改表 ”, 要修改的表名, “ 成功！”), 0, )
            销毁 ()
            返回 ()
        .如果真结束
        
    .如果真结束
    数据库.未知支持库函数_46 ()
    信息框_附错误文本 (“修改表失败！”)
    返回 ()
.如果真结束

 ' 思路：创建临时表，将旧表数据导入临时表，删除旧表，创建新表，将临时表数据导入新表，删除临时表
数据库.未知支持库函数_44 ()
赋值 (临时表名, 相加 (“__temp_”, 要修改的表名, “_”, 到文本 (取启动时间 ()), “_temp”))
赋值 (结果1, 数据库.未知支持库函数_61 (临时表名, 字段数组))
赋值 (结果2, 数据库.未知支持库函数_32 (相加 (“insert into ”, 临时表名, “ (”, 新表字段, “) select ”, 旧表字段, “ from ”, 要修改的表名, “ order by _ROWID_”)))
赋值 (结果3, 数据库.未知支持库函数_63 (要修改的表名))
赋值 (结果4, 数据库.未知支持库函数_61 (要修改的表名, 字段数组))
赋值 (结果5, 数据库.未知支持库函数_32 (相加 (“insert into ”, 要修改的表名, “ select * from ”, 临时表名, “ order by _ROWID_”)))
赋值 (结果6, 数据库.未知支持库函数_63 (临时表名))
.如果真 (并且 (结果1, 结果2, 结果3, 结果4, 结果5, 结果6))
    .如果真 (数据库.未知支持库函数_45 ())
        刷新数据库显示 ()
        刷新当前表显示 ()
        信息框 (相加 (“修改表 ”, 要修改的表名, “ 成功！”), 0, )
        销毁 ()
        返回 ()
    .如果真结束
    
.如果真结束
数据库.未知支持库函数_46 ()
信息框_附错误文本 (“修改表失败！”)
返回 ()


.子程序 _按钮_取消_被单击, 空白型, , 
销毁 ()


.子程序 更新序号, 空白型, , 对表格首列重新从1开始编号
.局部变量 i, 整数型, , , 

.计次循环首 (相减 (., 1), i)
    i.未知支持库函数_9 (0, #., 到文本 (i))
.计次循环尾 ()

.子程序 取字段类型, 整数型, , 根据中文显示名称，返回供“字段类型.数据类型”使用的整数常量
.参数 显示文本, 文本型, , 

.判断开始 (等于 (显示文本, #字段类型_主键))
    返回 (-1)
.判断 (或者 (等于 (显示文本, #字段类型_空), 等于 (显示文本, #字段类型_通用型)))
    返回 (0)
.判断 (等于 (显示文本, #字段类型_整数))
    返回 (#整数型)
.判断 (等于 (显示文本, #字段类型_小数))
    返回 (#小数型)
.判断 (等于 (显示文本, #字段类型_文本))
    返回 (#文本型)
.判断 (等于 (显示文本, #字段类型_字节集))
    返回 (#字节集型)
.默认
    
.判断结束

返回 (-100) ' !


.子程序 取表格行后台数组索引, 整数型, , 根据当前表格行,得到其对应的"后台字段信息数组"索引
.参数 行, 整数型, , 

.局部变量 i, 整数型, , , 
.局部变量 n, 整数型, , , 
.局部变量 后台字段信息, 字段及附加信息, , , 

.如果真 (小于 (行, 1))
    检查 (假)
    返回 (0)
.如果真结束

 ' 把"已删除"过滤掉
赋值 (n, 0)
.计次循环首 (取数组成员数 (后台字段信息数组), i)
    .如果真 (等于 (后台字段信息数组 [i], 已删除, 假))
        赋值 (n, 相加 (n, 1))
        .如果真 (等于 (n, 行))
            返回 (i)
        .如果真结束
        
    .如果真结束
    
.计次循环尾 ()
返回 (相加 (取数组成员数 (后台字段信息数组), 1))

 ' 表格会自动添加删除最后一行，所以后台可能会少一个成员
赋值 (后台字段信息.新添加, 真)
加入成员 (后台字段信息数组, 后台字段信息)
返回 (取数组成员数 (后台字段信息数组))

.子程序 取前台表格行号, 整数型, , 根据后台数组索引，取与其对应的表格行号(>=1)
.参数 后台数组索引, 整数型, , 

.局部变量 i, 整数型, , , 
.局部变量 n, 整数型, , , 

.计次循环首 (取数组成员数 (后台字段信息数组), i)
    .如果真 (等于 (后台字段信息数组 [i], 已删除, 假))
        赋值 (n, 相加 (n, 1))
    .如果真结束
    
    .如果真 (等于 (i, 后台数组索引))
        返回 (n)
    .如果真结束
    
.计次循环尾 ()



.子程序 _高级表格1_结束编辑, 空白型, , 将表格中最新数据写入"后台字段信息数组",保持两者一致
.局部变量 行, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 i, 整数型, , , 

赋值 (行, 未知支持库函数_3 ())
.如果真 (小于 (行, 1))
    返回 ()
.如果真结束

写后台字段信息_指定行 (行, 取表格行后台数组索引 (行))


.子程序 调试_输出后台字段信息数组, 空白型, , 
.局部变量 i, 整数型, , , 

输出调试文本 (“-----------------------------”)
.计次循环首 (取数组成员数 (后台字段信息数组), i)
    输出调试文本 (相加 (后台字段信息数组 [i], 字段名称, “, ”, 后台字段信息数组 [i], 字段类型文本, “, ”, 后台字段信息数组 [i], 字段最大文本长度文本, “, ”, 到文本 (后台字段信息数组 [i], 已删除), “, ”, 到文本 (后台字段信息数组 [i], 新添加)))
.计次循环尾 ()
输出调试文本 (相加 (“------------------------------”, #换行符))

.子程序 _按钮1_被单击, 空白型, , 
调试_输出后台字段信息数组 ()


.窗口程序集 窗口程序集1, , , 

.程序集变量 表名, 文本型, , , 
.程序集变量 字段值数组, 字段值类型, , "0", 仅用于向用户反馈已绑定的值
.子程序 _窗口_插入记录_创建完毕, 空白型, , 
.局部变量 字段数组, 文本型, , "0", 
.局部变量 字段个数, 空白型, , , 
.局部变量 i, 整数型, , , 

.如果真 (等于 (表.未知支持库函数_104 (), 假))
    信息框 (“没有要操作的表！”, 0, )
    销毁 ()
    返回 ()
.如果真结束

赋值 (表名, 表.未知支持库函数_148 ())
赋值 (., 相加 (“向表 ”, 表名, “ 中插入新记录...”))

赋值 (字段数组, 表.未知支持库函数_153 ())
赋值 (字段个数, 取数组成员数 (字段数组))
.如果真 (等于 (字段个数, 0))
    信息框 (“表中没有字段，无法插入记录！”, 0, )
    销毁 ()
    返回 ()
.如果真结束
赋值 (., 字段个数)
.计次循环首 (字段个数, i)
    相减 (i, 1).未知支持库函数_9 (0, #., 字段数组 [i])
.计次循环尾 ()
0.未知支持库函数_0 (0)

重定义数组 (字段值数组, 假, 字段个数)

.如果真 (等于 (表.未知支持库函数_121 (), 假))
    信息框 (“插入失败！”, 0, )
    销毁 ()
    返回 ()
.如果真结束


.子程序 取字段索引, 整数型, , 
检查 (大于 (相加 (未知支持库函数_3 (), 1), 0))
返回 (相加 (未知支持库函数_3 (), 1))


.子程序 清空当前显示, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.图片, {  })


.子程序 显示已绑定值, 空白型, , 
.参数 字段值, 字段值类型, , 

赋值 (.内容, 字段值.文本值)
赋值 (.内容, 字段值.文本值)
赋值 (.内容, 字段值.文本值)
赋值 (.图片, 字段值.字节集值)
赋值 (.标题, 相加 (“长度(字节)：”, 到文本 (取字节集长度 (字段值.字节集值))))

.子程序 显示当前字段值, 空白型, , 
.局部变量 字段索引, 整数型, , , 

清空当前显示 ()
赋值 (字段索引, 取字段索引 ())
.如果真 (小于 (字段索引, 1))
    信息框 (“请选择要赋值的字段！”, 0, )
    返回 ()
.如果真结束

.如果真 (等于 (字段值数组 [字段索引], 类型, 0))
    返回 ()
.如果真结束
.如果真 (等于 (字段值数组 [字段索引], 类型, #文本型))
    赋值 (., 0)
.如果真结束
.如果真 (等于 (字段值数组 [字段索引], 类型, #整数型))
    赋值 (., 1)
.如果真结束
.如果真 (等于 (字段值数组 [字段索引], 类型, #小数型))
    赋值 (., 2)
.如果真结束
.如果真 (等于 (字段值数组 [字段索引], 类型, #字节集型))
    赋值 (., 3)
.如果真结束

显示已绑定值 (字段值数组 [字段索引])


.子程序 绑定字段值, 空白型, , 
.局部变量 字段索引, 整数型, , , 
.局部变量 结果, 逻辑型, , , 

赋值 (字段索引, 取字段索引 ())
.如果真 (小于 (字段索引, 1))
    信息框 (“请选择要赋值的字段！”, 0, )
    返回 ()
.如果真结束

.如果真 (等于 (., 0))
    赋值 (字段值数组 [字段索引], 类型, #文本型)
    赋值 (字段值数组 [字段索引], 文本值, .内容)
    赋值 (结果, 表.未知支持库函数_136 (字段索引, 字段值数组 [字段索引], 文本值))
.如果真结束
.如果真 (等于 (., 1))
    赋值 (字段值数组 [字段索引], 类型, #整数型)
    赋值 (字段值数组 [字段索引], 文本值, .内容)
    赋值 (结果, 表.未知支持库函数_136 (字段索引, 字段值数组 [字段索引], 文本值))
.如果真结束
.如果真 (等于 (., 2))
    赋值 (字段值数组 [字段索引], 类型, #小数型)
    赋值 (字段值数组 [字段索引], 文本值, .内容)
    赋值 (结果, 表.未知支持库函数_136 (字段索引, 字段值数组 [字段索引], 文本值))
.如果真结束
.如果真 (等于 (., 3))
    赋值 (字段值数组 [字段索引], 类型, #字节集型)
    赋值 (字段值数组 [字段索引], 字节集值, .图片)
    赋值 (结果, 表.未知支持库函数_136 (字段索引, 字段值数组 [字段索引], 字节集值))
.如果真结束

.如果 (结果)
    信息框 (“已成功写入字段值。”, 0, )
.否则
    信息框_附错误文本 (“为字段赋值失败！”)
.如果结束



.子程序 _按钮_取消_被单击, 空白型, , 
表.未知支持库函数_124 ()
销毁 ()

.子程序 _按钮_确定_被单击, 空白型, , 
.如果 (表.未知支持库函数_123 ())
    信息框 (“已成功插入记录！”, 0, )
    _启动窗口.刷新当前表显示 ()
    销毁 ()
.否则
    信息框_附错误文本 (“插入记录失败！”)
.如果结束


.子程序 _高级表格1_光标位置改变, 空白型, , 
显示当前字段值 ()


.子程序 _按钮_写文本字段值_被单击, 空白型, , 
绑定字段值 ()

.子程序 _按钮_写整数字段值_被单击, 空白型, , 
绑定字段值 ()

.子程序 _按钮_写小数字段值_被单击, 空白型, , 
绑定字段值 ()

.子程序 _按钮_清除字节集字段_被单击, 空白型, , 
赋值 (.图片, {  })
赋值 (.标题, “字节集长度(字节)：0”)
绑定字段值 ()


.子程序 _按钮_从文件写到字节集字段_被单击, 空白型, , 
.如果真 (打开 ())
    赋值 (.图片, 读入文件 (.文件名))
    赋值 (.标题, 相加 (“字节集长度(字节)：”, 到文本 (取字节集长度 (.图片))))
    绑定字段值 ()
.如果真结束


.子程序 _编辑框_文本字段值_内容被改变, 空白型, , 
赋值 (.标题, 相加 (“文本长度(字符数)：”, 到文本 (取文本长度 (.内容))))



 ' 不属于任何一个程序集、类模块的函数：
