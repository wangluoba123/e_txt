 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 500
    高度 = 456
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 12632256 '  0xC0C0C0
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    背景音乐 =  ' 空
    标题 = “易之中国象棋V1.0”
    帮助文件名 = “”

窗口 赢棋窗口
    左边 = 50
    顶边 = 50
    宽度 = 277
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16776960 '  0xFFFF00
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 16
    总在最前 = 假
    保持标题栏激活 = 假
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 390
    高度 = 400
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 12632256 '  0xC0C0C0
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    背景音乐 =  ' 空
    标题 = “关于易之中国象棋”
    帮助文件名 = “”

窗口 存盘窗口
    左边 = 50
    顶边 = 50
    宽度 = 211
    高度 = 205
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 12632256 '  0xC0C0C0
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    背景音乐 =  ' 空
    标题 = “请选择存档号：”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 7 系统核心支持库




.全局变量 赢棋方, 整数型, , , 
.全局变量 行棋记录, 文本型, , "1,6", 
.全局变量 存盘读盘, 文本型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 排局状态, 逻辑型, , , 
.程序集变量 横, 整数型, , , 
.程序集变量 纵, 整数型, , , 
.程序集变量 已走棋, 逻辑型, , , 
.程序集变量 按住, 逻辑型, , , 
.程序集变量 被选标签, 标签, , , 
.程序集变量 原选标签, 标签, , , 
.程序集变量 原选棋子, 外形框, , , 
.程序集变量 被选棋子, 外形框, , , 
.程序集变量 有棋子, 逻辑型, , "10,9", 
.程序集变量 棋子个数, 整数型, , , 
.程序集变量 标记横, 整数型, , , 
.程序集变量 标记纵, 整数型, , , 
.程序集变量 该走棋, 整数型, , , 
.程序集变量 复盘步数, 整数型, , , 
.程序集变量 字段, 字段信息, , "6", 
.程序集变量 行棋步数, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
未知函数_67175187 ()

.子程序 新局, 空白型, , 
.局部变量 纵线, 整数型, , , 
.局部变量 横线, 整数型, , , 

赋值 (., 假)
.变量循环首 (1, 10, 1, )
    .变量循环首 (1, 9, 1, )
        赋值 (有棋子 [ [假]])
    .变量循环尾 ()
.变量循环尾 ()
2.移动 (2, , )
赋值 (., “911”)
赋值 (., “11”)
赋值 (., 1)
42.移动 (2, , )
赋值 (., “912”)
赋值 (., “12”)
赋值 (., 1)
82.移动 (2, , )
赋值 (., “913”)
赋值 (., “13”)
赋值 (., 1)
122.移动 (2, , )
赋值 (., “914”)
赋值 (., “14”)
赋值 (., 1)
162.移动 (2, , )
赋值 (., “915”)
赋值 (., “15”)
赋值 (., 1)
202.移动 (2, , )
赋值 (., “916”)
赋值 (., “16”)
赋值 (., 1)
242.移动 (2, , )
赋值 (., “917”)
赋值 (., “17”)
赋值 (., 1)
282.移动 (2, , )
赋值 (., “918”)
赋值 (., “18”)
赋值 (., 1)
322.移动 (2, , )
赋值 (., “919”)
赋值 (., “19”)
赋值 (., 1)
42.移动 (82, , )
赋值 (., “932”)
赋值 (., “32”)
赋值 (., 1)
282.移动 (82, , )
赋值 (., “938”)
赋值 (., “38”)
赋值 (., 1)
2.移动 (122, , )
赋值 (., “941”)
赋值 (., “41”)
赋值 (., 1)
82.移动 (122, , )
赋值 (., “943”)
赋值 (., “43”)
赋值 (., 1)
162.移动 (122, , )
赋值 (., “945”)
赋值 (., “45”)
赋值 (., 1)
242.移动 (122, , )
赋值 (., “947”)
赋值 (., “47”)
赋值 (., 1)
322.移动 (122, , )
赋值 (., “949”)
赋值 (., “49”)
赋值 (., 1)
2.移动 (242, , )
赋值 (., “971”)
赋值 (., “71”)
赋值 (., 1)
82.移动 (242, , )
赋值 (., “973”)
赋值 (., “73”)
赋值 (., 1)
162.移动 (242, , )
赋值 (., “975”)
赋值 (., “75”)
赋值 (., 1)
242.移动 (242, , )
赋值 (., “977”)
赋值 (., “77”)
赋值 (., 1)
322.移动 (242, , )
赋值 (., “979”)
赋值 (., “79”)
赋值 (., 1)
42.移动 (282, , )
赋值 (., “982”)
赋值 (., “82”)
赋值 (., 1)
282.移动 (282, , )
赋值 (., “988”)
赋值 (., “88”)
赋值 (., 1)
2.移动 (362, , )
赋值 (., “9101”)
赋值 (., “101”)
赋值 (., 1)
42.移动 (362, , )
赋值 (., “9102”)
赋值 (., “102”)
赋值 (., 1)
82.移动 (362, , )
赋值 (., “9103”)
赋值 (., “103”)
赋值 (., 1)
122.移动 (362, , )
赋值 (., “9104”)
赋值 (., “104”)
赋值 (., 1)
162.移动 (362, , )
赋值 (., “9105”)
赋值 (., “105”)
赋值 (., 1)
202.移动 (362, , )
赋值 (., “9106”)
赋值 (., “106”)
赋值 (., 1)
242.移动 (362, , )
赋值 (., “9107”)
赋值 (., “107”)
赋值 (., 1)
282.移动 (362, , )
赋值 (., “9108”)
赋值 (., “108”)
赋值 (., 1)
322.移动 (362, , )
赋值 (., “9109”)
赋值 (., “109”)
赋值 (., 1)
连续赋值 (真, 有棋子 [1] [1], 有棋子 [1] [2], 有棋子 [1] [3], 有棋子 [1] [4], 有棋子 [1] [5], 有棋子 [1] [6], 有棋子 [1] [7], 有棋子 [1] [8], 有棋子 [1] [9], 有棋子 [3] [2], 有棋子 [3] [8], 有棋子 [4] [1], 有棋子 [4] [3], 有棋子 [4] [5], 有棋子 [4] [7], 有棋子 [4] [9], 有棋子 [7] [1], 有棋子 [7] [3], 有棋子 [7] [5], 有棋子 [7] [7], 有棋子 [7] [9], 有棋子 [8] [2], 有棋子 [8] [8], 有棋子 [10] [1], 有棋子 [10] [2], 有棋子 [10] [3], 有棋子 [10] [4], 有棋子 [10] [5], 有棋子 [10] [6], 有棋子 [10] [7], 有棋子 [10] [8], 有棋子 [10] [9])
清空 ()
加空记录 ()
替换 (取字段名 (1), ., 取字段名 (2), ., 取字段名 (3), ., 取字段名 (4), ., 取字段名 (5), ., 取字段名 (6), .)
加空记录 ()
替换 (取字段名 (1), ., 取字段名 (2), ., 取字段名 (3), ., 取字段名 (4), ., 取字段名 (5), ., 取字段名 (6), .)
加空记录 ()
替换 (取字段名 (1), ., 取字段名 (2), ., 取字段名 (3), ., 取字段名 (4), ., 取字段名 (5), ., 取字段名 (6), .)
加空记录 ()
替换 (取字段名 (1), ., 取字段名 (2), ., 取字段名 (3), ., 取字段名 (4), ., 取字段名 (5), ., 取字段名 (6), .)
加空记录 ()
替换 (取字段名 (1), ., 取字段名 (2), ., 取字段名 (3), ., 取字段名 (4), ., 取字段名 (5), ., 取字段名 (6), .)
加空记录 ()
替换 (取字段名 (1), ., 取字段名 (2), .)
清空 ()
赋值 (行棋步数, 0)
刷新显示 ()
赋值 (按住, 假)
赋值 (该走棋, 658108)
赋值 (., 该走棋)
赋值 (., “ 该红棋走！”)
连续赋值 (“00:00:00”, ., .)
赋值 (., 假)
赋值 (., “暂停”)
赋值 (., 假)
赋值 (., 假)
赋值 (已走棋, 假)
赋值 (., 0)
赋值 (., 真)
赋值 (., 假)
赋值 (., 真)
赋值 (., 假)

.子程序 _标签1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 容器1, 整数型, , , 
.局部变量 可移动, 逻辑型, , , 
.局部变量 点击标签, 标签, , , 

.如果 (等于 (排局状态, 真))
    .如果真 (等于 (按住, 真))
        赋值 (被选棋子., 1)
    .如果真结束
    赋值 (点击标签, 取事件组件 ())
    赋值 (被选标签, 点击标签)
    赋值 (被选棋子, 取标记组件 (到数值 (相加 (“9”, .))))
    赋值 (被选棋子., 2)
    赋值 (按住, 真)
.否则
    到尾记录 ()
    .如果 (等于 (按住, 假))
        .如果真 (等于 (已走棋, 假))
            赋值 (., 1000)
            赋值 (已走棋, 真)
        .如果真结束
        赋值 (点击标签, 取事件组件 ())
        .如果真 (等于 (点击标签., 该走棋))
            赋值 (被选标签, 点击标签)
            赋值 (被选棋子, 取标记组件 (到数值 (相加 (“9”, .))))
            赋值 (被选棋子., 2)
            赋值 (按住, 真)
            .如果 (等于 (该走棋, 0))
                替换 (取字段名 (4), 被选标签.)
            .否则
                加空记录 ()
                替换 (取字段名 (1), 被选标签.)
            .如果结束
            赋值 (., 假)
        .如果真结束
        
    .否则
        赋值 ()
        赋值 (被选棋子)
        赋值 (选择 (等于 (取文本长度 (原选标签.), 3), 到数值 (取文本左边 (原选标签., 2)), 到数值 (取文本左边 (原选标签., 1))))
        赋值 (到数值 (取文本右边 (原选标签., 1)))
        赋值 (取事件组件 ())
        .如果真 (不等于 (原选标签, 被选标签))
            赋值 (被选棋子, 取标记组件 (到数值 (相加 (“9”, .))))
            .如果 (等于 (., .))
                赋值 (原选棋子., 1)
                赋值 (被选棋子., 2)
                .如果 (等于 (原选标签., 0))
                    替换 (取字段名 (4), 被选标签.)
                .否则
                    替换 (取字段名 (1), 被选标签.)
                .如果结束
                
            .否则
                .如果 (等于 (原选标签., 0))
                    替换 (取字段名 (5), 被选标签.)
                .否则
                    替换 (取字段名 (2), 被选标签.)
                .如果结束
                赋值 (纵, 选择 (等于 (取文本长度 (被选标签.), 3), 到数值 (取文本左边 (被选标签., 2)), 到数值 (取文本左边 (被选标签., 1))))
                赋值 (横, 到数值 (取文本右边 (被选标签., 1)))
                .如果真 (等于 (原选标签., “车”))
                    赋值 (棋子个数, 0)
                    .如果真 (并且 (等于 (标记纵, 纵), 不等于 (标记横, 横)))
                        .如果 (大于 (标记横, 横))
                            .变量循环首 (相减 (标记横, 1), 横, -1, 容器1)
                                .如果真 (等于 (有棋子 [纵] [容器1], 真))
                                    赋值 (相加 (1))
                                .如果真结束
                                
                            .变量循环尾 ()
                        .否则
                            .变量循环首 (相加 (标记横, 1), 横, 1, 容器1)
                                .如果真 (等于 (有棋子 [纵] [容器1], 真))
                                    赋值 (相加 (1))
                                .如果真结束
                                
                            .变量循环尾 ()
                        .如果结束
                        
                    .如果真结束
                    .如果真 (并且 (不等于 (标记纵, 纵), 等于 (标记横, 横)))
                        .如果 (大于 (标记纵, 纵))
                            .变量循环首 (相减 (标记纵, 1), 纵, -1, 容器1)
                                .如果真 (等于 (有棋子 [容器1] [横], 真))
                                    赋值 (相加 (1))
                                .如果真结束
                                
                            .变量循环尾 ()
                        .否则
                            .变量循环首 (相加 (标记纵, 1), 纵, 1, 容器1)
                                .如果真 (等于 (有棋子 [容器1] [横], 真))
                                    赋值 (相加 (1))
                                .如果真结束
                                
                            .变量循环尾 ()
                        .如果结束
                        
                    .如果真结束
                    .如果 (等于 (棋子个数, 1))
                        赋值 (原选棋子., 1)
                        被选棋子.移动 (., 被选棋子., , )
                        被选棋子.移动 (400, , , )
                        .变量循环首 (11, 42, 1, 容器1)
                            到首记录 ()
                            .如果 (或者 (查找 (等于 (读 (3), 相加 (到文本 (容器1), 被选标签.))), 查找 (等于 (读 (6), 相加 (到文本 (容器1), 被选标签.)))))
                                
                            .否则
                                到尾记录 ()
                                跳出循环 ()
                            .如果结束
                            
                        .变量循环尾 ()
                        赋值 (被选标签., 相加 (到文本 (容器1), 被选标签.))
                        赋值 (被选棋子., 相加 (“9”, 被选标签.))
                        .如果 (等于 (原选标签., 0))
                            替换 (取字段名 (6), 被选标签.)
                        .否则
                            替换 (取字段名 (3), 被选标签.)
                        .如果结束
                        
                        赋值 (有棋子 [ [假]])
                        赋值 (被选棋子, )
                        赋值 ()
                        赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                        赋值 (被选棋子., 相加 (“9”, 被选标签.))
                        赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                        赋值 (., 该走棋)
                        赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                        赋值 (按住, 假)
                        赋值 (., 假)
                        赋值 (., 假)
                        行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                    .否则
                        赋值 (被选标签, 原选标签)
                        赋值 (被选棋子, 原选棋子)
                        .如果 (等于 (原选标签., 0))
                            替换 (取字段名 (5), “”)
                        .否则
                            替换 (取字段名 (2), “”)
                        .如果结束
                        
                    .如果结束
                    
                .如果真结束
                .如果真 (等于 (原选标签., “炮”))
                    赋值 (棋子个数, 0)
                    .如果真 (并且 (等于 (标记纵, 纵), 不等于 (标记横, 横)))
                        .如果 (大于 (标记横, 横))
                            .变量循环首 (相减 (标记横, 1), 横, -1, 容器1)
                                .如果真 (等于 (有棋子 [纵] [容器1], 真))
                                    赋值 (相加 (1))
                                .如果真结束
                                
                            .变量循环尾 ()
                        .否则
                            .变量循环首 (相加 (标记横, 1), 横, 1, 容器1)
                                .如果真 (等于 (有棋子 [纵] [容器1], 真))
                                    赋值 (相加 (1))
                                .如果真结束
                                
                            .变量循环尾 ()
                        .如果结束
                        
                    .如果真结束
                    .如果真 (并且 (不等于 (标记纵, 纵), 等于 (标记横, 横)))
                        .如果 (大于 (标记纵, 纵))
                            .变量循环首 (相减 (标记纵, 1), 纵, -1, 容器1)
                                .如果真 (等于 (有棋子 [容器1] [横], 真))
                                    赋值 (相加 (1))
                                .如果真结束
                                
                            .变量循环尾 ()
                        .否则
                            .变量循环首 (相加 (标记纵, 1), 纵, 1, )
                                .如果真 (等于 (有棋子 [ [横]], 真))
                                    赋值 (相加 (1))
                                .如果真结束
                                
                            .变量循环尾 ()
                        .如果结束
                        
                    .如果真结束
                    .如果 (等于 (棋子个数, 2))
                        赋值 (原选棋子., 1)
                        被选棋子.移动 (., 被选棋子., , )
                        被选棋子.移动 (400, , , )
                        .变量循环首 (11, 42, 1, 容器1)
                            到首记录 ()
                            .如果 (或者 (查找 (等于 (读 (3), 相加 (到文本 (容器1), 被选标签.))), 查找 (等于 (读 (6), 相加 (到文本 (容器1), 被选标签.)))))
                                
                            .否则
                                到尾记录 ()
                                跳出循环 ()
                            .如果结束
                            
                        .变量循环尾 ()
                        赋值 (被选标签., 相加 (到文本 (容器1), 被选标签.))
                        赋值 (被选棋子., 相加 (“9”, 被选标签.))
                        .如果 (等于 (原选标签., 0))
                            替换 (取字段名 (6), 被选标签.)
                        .否则
                            替换 (取字段名 (3), 被选标签.)
                        .如果结束
                        赋值 (有棋子 [ [假]])
                        赋值 (被选棋子, )
                        赋值 ()
                        赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                        赋值 (被选棋子., 相加 (“9”, 被选标签.))
                        赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                        赋值 (., 该走棋)
                        赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                        赋值 (按住, 假)
                        赋值 (., 假)
                        赋值 (., 假)
                        行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                    .否则
                        赋值 (被选标签, 原选标签)
                        赋值 (被选棋子, 原选棋子)
                        .如果 (等于 (原选标签., 0))
                            替换 (取字段名 (5), “”)
                        .否则
                            替换 (取字段名 (2), “”)
                        .如果结束
                        
                    .如果结束
                    
                .如果真结束
                .如果真 (等于 (原选标签., “马”))
                    .如果 (或者 (并且 (等于 (取绝对值 (相减 (标记纵, 纵)), 2), 等于 (取绝对值 (相减 (标记横, 横)), 1)), 并且 (等于 (取绝对值 (相减 (标记纵, 纵)), 1), 等于 (取绝对值 (相减 (标记横, 横)), 2))))
                        .如果真 (并且 (等于 (取绝对值 (相减 (标记纵, 纵)), 2), 等于 (取绝对值 (相减 (标记横, 横)), 1)))
                            .如果 (等于 (有棋子 [选择 (大于 (标记纵, 纵), 相减 (标记纵, 1), 相加 (标记纵, 1))] [标记横], 假))
                                赋值 (原选棋子., 1)
                                被选棋子.移动 (., 被选棋子., , )
                                被选棋子.移动 (400, , , )
                                .变量循环首 (11, 42, 1, 容器1)
                                    到首记录 ()
                                    .如果 (或者 (查找 (等于 (读 (3), 相加 (到文本 (容器1), 被选标签.))), 查找 (等于 (读 (6), 相加 (到文本 (容器1), 被选标签.)))))
                                        
                                    .否则
                                        到尾记录 ()
                                        跳出循环 ()
                                    .如果结束
                                    
                                .变量循环尾 ()
                                赋值 (被选标签., 相加 (到文本 (容器1), 被选标签.))
                                赋值 (被选棋子., 相加 (“9”, 被选标签.))
                                .如果 (等于 (原选标签., 0))
                                    替换 (取字段名 (6), 被选标签.)
                                .否则
                                    替换 (取字段名 (3), 被选标签.)
                                .如果结束
                                赋值 (有棋子 [ [假]])
                                赋值 (被选标签, 原选标签)
                                赋值 (被选棋子, 原选棋子)
                                赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                                赋值 (被选棋子., 相加 (“9”, 被选标签.))
                                赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                                赋值 (., 该走棋)
                                赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                                赋值 (按住, 假)
                                赋值 (., 假)
                                赋值 (., 假)
                                行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                            .否则
                                赋值 (被选标签, 原选标签)
                                赋值 (被选棋子, 原选棋子)
                                .如果 (等于 (原选标签., 0))
                                    替换 (取字段名 (5), “”)
                                .否则
                                    替换 (取字段名 (2), “”)
                                .如果结束
                                
                            .如果结束
                            
                        .如果真结束
                        .如果真 (并且 (等于 (取绝对值 (相减 (标记纵, 纵)), 1), 等于 (取绝对值 (相减 (标记横, 横)), 2)))
                            .如果 (等于 (有棋子 [标记纵] [选择 (大于 (标记横, 横), 相减 (标记横, 1), 相加 (标记横, 1))], 假))
                                赋值 (原选棋子., 1)
                                被选棋子.移动 (., 被选棋子., , )
                                被选棋子.移动 (400, , , )
                                .变量循环首 (11, 42, 1, 容器1)
                                    到首记录 ()
                                    .如果 (或者 (查找 (等于 (读 (3), 相加 (到文本 (容器1), 被选标签.))), 查找 (等于 (读 (6), 相加 (到文本 (容器1), 被选标签.)))))
                                        
                                    .否则
                                        到尾记录 ()
                                        跳出循环 ()
                                    .如果结束
                                    
                                .变量循环尾 ()
                                赋值 (被选标签., 相加 (到文本 (容器1), 被选标签.))
                                赋值 (被选棋子., 相加 (“9”, 被选标签.))
                                .如果 (等于 (原选标签., 0))
                                    替换 (取字段名 (6), 被选标签.)
                                .否则
                                    替换 (取字段名 (3), 被选标签.)
                                .如果结束
                                赋值 (有棋子 [ [假]])
                                赋值 (被选标签, 原选标签)
                                赋值 (被选棋子, 原选棋子)
                                赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                                赋值 (被选棋子., 相加 (“9”, 被选标签.))
                                赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                                赋值 (., 该走棋)
                                赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                                赋值 (按住, 假)
                                赋值 (., 假)
                                赋值 (., 假)
                                行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                            .否则
                                赋值 (被选标签, 原选标签)
                                赋值 (被选棋子, 原选棋子)
                                .如果 (等于 (原选标签., 0))
                                    替换 (取字段名 (5), “”)
                                .否则
                                    替换 (取字段名 (2), “”)
                                .如果结束
                                
                            .如果结束
                            
                        .如果真结束
                        
                    .否则
                        赋值 (被选标签, 原选标签)
                        赋值 (被选棋子, 原选棋子)
                        .如果 (等于 (原选标签., 0))
                            替换 (取字段名 (5), “”)
                        .否则
                            替换 (取字段名 (2), “”)
                        .如果结束
                        
                    .如果结束
                    
                .如果真结束
                .如果真 (等于 (原选标签., “仕”))
                    .如果真 (并且 (大于或等于 (纵, 1), 小于或等于 (纵, 3), 大于或等于 (横, 4), 小于或等于 (横, 6)))
                        .如果 (并且 (等于 (取绝对值 (相减 (标记纵, 纵)), 1), 等于 (取绝对值 (相减 (标记横, 横)), 1)))
                            赋值 (原选棋子., 1)
                            被选棋子.移动 (., 被选棋子., , )
                            被选棋子.移动 (400, , , )
                            .变量循环首 (11, 42, 1, 容器1)
                                到首记录 ()
                                .如果 (或者 (查找 (等于 (读 (3), 相加 (到文本 (容器1), 被选标签.))), 查找 (等于 (读 (6), 相加 (到文本 (容器1), 被选标签.)))))
                                    
                                .否则
                                    到尾记录 ()
                                    跳出循环 ()
                                .如果结束
                                
                            .变量循环尾 ()
                            赋值 (被选标签., 相加 (到文本 (容器1), 被选标签.))
                            赋值 (被选棋子., 相加 (“9”, 被选标签.))
                            .如果 (等于 (原选标签., 0))
                                替换 (取字段名 (6), 被选标签.)
                            .否则
                                替换 (取字段名 (3), 被选标签.)
                            .如果结束
                            赋值 (有棋子 [ [假]])
                            赋值 (被选标签, 原选标签)
                            赋值 (被选棋子, 原选棋子)
                            赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                            赋值 (被选棋子., 相加 (“9”, 被选标签.))
                            赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                            赋值 (., 该走棋)
                            赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                            赋值 (按住, 假)
                            赋值 (., 假)
                            赋值 (., 假)
                            行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                        .否则
                            赋值 (被选标签, 原选标签)
                            赋值 (被选棋子, 原选棋子)
                            .如果 (等于 (原选标签., 0))
                                替换 (取字段名 (5), “”)
                            .否则
                                替换 (取字段名 (2), “”)
                            .如果结束
                            
                        .如果结束
                        
                    .如果真结束
                    
                .如果真结束
                .如果真 (等于 (原选标签., “象”))
                    .如果 (并且 (小于或等于 (纵, 5), 等于 (取绝对值 (相减 (标记纵, 纵)), 2), 等于 (取绝对值 (相减 (标记横, 横)), 2), 等于 (有棋子 [选择 (大于 (标记纵, 纵), 相减 (标记纵, 1), 相加 (标记纵, 1))] [选择 (大于 (标记横, 横), 相减 (标记横, 1), 相加 (标记横, 1))], 假)))
                        赋值 (原选棋子., 1)
                        被选棋子.移动 (., 被选棋子., , )
                        被选棋子.移动 (400, , , )
                        .变量循环首 (11, 42, 1, 容器1)
                            到首记录 ()
                            .如果 (或者 (查找 (等于 (读 (3), 相加 (到文本 (容器1), 被选标签.))), 查找 (等于 (读 (6), 相加 (到文本 (容器1), 被选标签.)))))
                                
                            .否则
                                到尾记录 ()
                                跳出循环 ()
                            .如果结束
                            
                        .变量循环尾 ()
                        赋值 (被选标签., 相加 (到文本 (容器1), 被选标签.))
                        赋值 (被选棋子., 相加 (“9”, 被选标签.))
                        .如果 (等于 (原选标签., 0))
                            替换 (取字段名 (6), 被选标签.)
                        .否则
                            替换 (取字段名 (3), 被选标签.)
                        .如果结束
                        赋值 (有棋子 [ [假]])
                        赋值 (被选标签, 原选标签)
                        赋值 (被选棋子, 原选棋子)
                        赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                        赋值 (被选棋子., 相加 (“9”, 被选标签.))
                        赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                        赋值 (., 该走棋)
                        赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                        赋值 (按住, 假)
                        赋值 (., 假)
                        赋值 (., 假)
                        行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                    .否则
                        赋值 (被选标签, 原选标签)
                        赋值 (被选棋子, 原选棋子)
                        .如果 (等于 (原选标签., 0))
                            替换 (取字段名 (5), “”)
                        .否则
                            替换 (取字段名 (2), “”)
                        .如果结束
                        
                    .如果结束
                    
                .如果真结束
                .如果真 (等于 (原选标签., “将”))
                    .如果 (并且 (大于或等于 (纵, 1), 小于或等于 (纵, 3), 大于或等于 (横, 4), 小于或等于 (横, 6)))
                        .如果 (或者 (并且 (等于 (标记纵, 纵), 等于 (取绝对值 (相减 (标记横, 横)), 1)), 并且 (等于 (标记横, 横), 等于 (取绝对值 (相减 (标记纵, 纵)), 1))))
                            .如果真 (并且 (等于 (标记纵, 纵), 等于 (取绝对值 (相减 (标记横, 横)), 1)))
                                赋值 (原选棋子., 1)
                                被选棋子.移动 (., 被选棋子., , )
                                被选棋子.移动 (400, , , )
                                .变量循环首 (11, 42, 1, 容器1)
                                    到首记录 ()
                                    .如果 (或者 (查找 (等于 (读 (3), 相加 (到文本 (容器1), 被选标签.))), 查找 (等于 (读 (6), 相加 (到文本 (容器1), 被选标签.)))))
                                        
                                    .否则
                                        到尾记录 ()
                                        跳出循环 ()
                                    .如果结束
                                    
                                .变量循环尾 ()
                                赋值 (被选标签., 相加 (到文本 (容器1), 被选标签.))
                                赋值 (被选棋子., 相加 (“9”, 被选标签.))
                                .如果 (等于 (原选标签., 0))
                                    替换 (取字段名 (6), 被选标签.)
                                .否则
                                    替换 (取字段名 (3), 被选标签.)
                                .如果结束
                                赋值 (有棋子 [ [假]])
                                赋值 (被选标签, 原选标签)
                                赋值 (被选棋子, 原选棋子)
                                赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                                赋值 (被选棋子., 相加 (“9”, 被选标签.))
                                赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                                赋值 (., 该走棋)
                                赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                                赋值 (按住, 假)
                                赋值 (., 假)
                                赋值 (., 假)
                                行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                            .如果真结束
                            .如果真 (并且 (等于 (标记横, 横), 等于 (取绝对值 (相减 (标记纵, 纵)), 1)))
                                赋值 (原选棋子., 1)
                                被选棋子.移动 (., 被选棋子., , )
                                被选棋子.移动 (400, , , )
                                .变量循环首 (11, 42, 1, 容器1)
                                    到首记录 ()
                                    .如果 (或者 (查找 (等于 (读 (3), 相加 (到文本 (容器1), 被选标签.))), 查找 (等于 (读 (6), 相加 (到文本 (容器1), 被选标签.)))))
                                        
                                    .否则
                                        到尾记录 ()
                                        跳出循环 ()
                                    .如果结束
                                    
                                .变量循环尾 ()
                                赋值 (被选标签., 相加 (到文本 (容器1), 被选标签.))
                                赋值 (被选棋子., 相加 (“9”, 被选标签.))
                                .如果 (等于 (原选标签., 0))
                                    替换 (取字段名 (6), 被选标签.)
                                .否则
                                    替换 (取字段名 (3), 被选标签.)
                                .如果结束
                                赋值 (有棋子 [ [假]])
                                赋值 (被选标签, 原选标签)
                                赋值 (被选棋子, 原选棋子)
                                赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                                赋值 (被选棋子., 相加 (“9”, 被选标签.))
                                赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                                赋值 (., 该走棋)
                                赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                                赋值 (按住, 假)
                                赋值 (., 假)
                                赋值 (., 假)
                                行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                            .如果真结束
                            
                        .否则
                            赋值 (被选标签, 原选标签)
                            赋值 (被选棋子, 原选棋子)
                            .如果 (等于 (原选标签., 0))
                                替换 (取字段名 (5), “”)
                            .否则
                                替换 (取字段名 (2), “”)
                            .如果结束
                            
                        .如果结束
                        
                    .否则
                        赋值 (被选标签, 原选标签)
                        赋值 (被选棋子, 原选棋子)
                        .如果 (等于 (原选标签., 0))
                            替换 (取字段名 (5), “”)
                        .否则
                            替换 (取字段名 (2), “”)
                        .如果结束
                        
                    .如果结束
                    
                .如果真结束
                .如果真 (等于 (原选标签., “士”))
                    .如果真 (并且 (大于或等于 (纵, 8), 小于或等于 (纵, 10), 大于或等于 (横, 4), 小于或等于 (横, 6)))
                        .如果 (并且 (等于 (取绝对值 (相减 (标记纵, 纵)), 1), 等于 (取绝对值 (相减 (标记横, 横)), 1)))
                            赋值 (原选棋子., 1)
                            被选棋子.移动 (., 被选棋子., , )
                            被选棋子.移动 (400, , , )
                            .变量循环首 (11, 42, 1, 容器1)
                                到首记录 ()
                                .如果 (或者 (查找 (等于 (读 (3), 相加 (到文本 (容器1), 被选标签.))), 查找 (等于 (读 (6), 相加 (到文本 (容器1), 被选标签.)))))
                                    
                                .否则
                                    到尾记录 ()
                                    跳出循环 ()
                                .如果结束
                                
                            .变量循环尾 ()
                            赋值 (被选标签., 相加 (到文本 (容器1), 被选标签.))
                            赋值 (被选棋子., 相加 (“9”, 被选标签.))
                            .如果 (等于 (原选标签., 0))
                                替换 (取字段名 (6), 被选标签.)
                            .否则
                                替换 (取字段名 (3), 被选标签.)
                            .如果结束
                            赋值 (有棋子 [ [假]])
                            赋值 (被选标签, 原选标签)
                            赋值 (被选棋子, 原选棋子)
                            赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                            赋值 (被选棋子., 相加 (“9”, 被选标签.))
                            赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                            赋值 (., 该走棋)
                            赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                            赋值 (按住, 假)
                            赋值 (., 假)
                            赋值 (., 假)
                            行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                        .否则
                            赋值 (被选标签, 原选标签)
                            赋值 (被选棋子, 原选棋子)
                            .如果 (等于 (原选标签., 0))
                                替换 (取字段名 (5), “”)
                            .否则
                                替换 (取字段名 (2), “”)
                            .如果结束
                            
                        .如果结束
                        
                    .如果真结束
                    
                .如果真结束
                .如果真 (等于 (原选标签., “相”))
                    .如果 (并且 (大于或等于 (纵, 6), 等于 (取绝对值 (相减 (标记纵, 纵)), 2), 等于 (取绝对值 (相减 (标记横, 横)), 2), 等于 (有棋子 [选择 (大于 (标记纵, 纵), 相减 (标记纵, 1), 相加 (标记纵, 1))] [选择 (大于 (标记横, 横), 相减 (标记横, 1), 相加 (标记横, 1))], 假)))
                        赋值 (原选棋子., 1)
                        被选棋子.移动 (., 被选棋子., , )
                        被选棋子.移动 (400, , , )
                        .变量循环首 (11, 42, 1, 容器1)
                            到首记录 ()
                            .如果 (或者 (查找 (等于 (读 (3), 相加 (到文本 (容器1), 被选标签.))), 查找 (等于 (读 (6), 相加 (到文本 (容器1), 被选标签.)))))
                                
                            .否则
                                到尾记录 ()
                                跳出循环 ()
                            .如果结束
                            
                        .变量循环尾 ()
                        赋值 (被选标签., 相加 (到文本 (容器1), 被选标签.))
                        赋值 (被选棋子., 相加 (“9”, 被选标签.))
                        .如果 (等于 (原选标签., 0))
                            替换 (取字段名 (6), 被选标签.)
                        .否则
                            替换 (取字段名 (3), 被选标签.)
                        .如果结束
                        赋值 (有棋子 [ [假]])
                        赋值 (被选标签, 原选标签)
                        赋值 (被选棋子, 原选棋子)
                        赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                        赋值 (被选棋子., 相加 (“9”, 被选标签.))
                        赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                        赋值 (., 该走棋)
                        赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                        赋值 (按住, 假)
                        赋值 (., 假)
                        赋值 (., 假)
                        行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                    .否则
                        赋值 (被选标签, 原选标签)
                        赋值 (被选棋子, 原选棋子)
                        .如果 (等于 (原选标签., 0))
                            替换 (取字段名 (5), “”)
                        .否则
                            替换 (取字段名 (2), “”)
                        .如果结束
                        
                    .如果结束
                    
                .如果真结束
                .如果真 (等于 (原选标签., “帅”))
                    .如果 (并且 (大于或等于 (纵, 8), 小于或等于 (纵, 10), 大于或等于 (横, 4), 小于或等于 (横, 6)))
                        .如果 (或者 (并且 (等于 (标记纵, 纵), 等于 (取绝对值 (相减 (标记横, 横)), 1)), 并且 (等于 (标记横, 横), 等于 (取绝对值 (相减 (标记纵, 纵)), 1))))
                            .如果真 (并且 (等于 (标记纵, 纵), 等于 (取绝对值 (相减 (标记横, 横)), 1)))
                                赋值 (原选棋子., 1)
                                被选棋子.移动 (., 被选棋子., , )
                                被选棋子.移动 (400, , , )
                                .变量循环首 (11, 42, 1, 容器1)
                                    到首记录 ()
                                    .如果 (或者 (查找 (等于 (读 (3), 相加 (到文本 (容器1), 被选标签.))), 查找 (等于 (读 (6), 相加 (到文本 (容器1), 被选标签.)))))
                                        
                                    .否则
                                        到尾记录 ()
                                        跳出循环 ()
                                    .如果结束
                                    
                                .变量循环尾 ()
                                赋值 (被选标签., 相加 (到文本 (容器1), 被选标签.))
                                赋值 (被选棋子., 相加 (“9”, 被选标签.))
                                .如果 (等于 (原选标签., 0))
                                    替换 (取字段名 (6), 被选标签.)
                                .否则
                                    替换 (取字段名 (3), 被选标签.)
                                .如果结束
                                赋值 (有棋子 [ [假]])
                                赋值 (被选标签, 原选标签)
                                赋值 (被选棋子, 原选棋子)
                                赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                                赋值 (被选棋子., 相加 (“9”, 被选标签.))
                                赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                                赋值 (., 该走棋)
                                赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                                赋值 (按住, 假)
                                赋值 (., 假)
                                赋值 (., 假)
                                行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                            .如果真结束
                            .如果真 (并且 (等于 (标记横, 横), 等于 (取绝对值 (相减 (标记纵, 纵)), 1)))
                                赋值 (原选棋子., 1)
                                被选棋子.移动 (., 被选棋子., , )
                                被选棋子.移动 (400, , , )
                                .变量循环首 (11, 42, 1, 容器1)
                                    到首记录 ()
                                    .如果 (或者 (查找 (等于 (读 (3), 相加 (到文本 (容器1), 被选标签.))), 查找 (等于 (读 (6), 相加 (到文本 (容器1), 被选标签.)))))
                                        
                                    .否则
                                        到尾记录 ()
                                        跳出循环 ()
                                    .如果结束
                                    
                                .变量循环尾 ()
                                赋值 (被选标签., 相加 (到文本 (容器1), 被选标签.))
                                赋值 (被选棋子., 相加 (“9”, 被选标签.))
                                .如果 (等于 (原选标签., 0))
                                    替换 (取字段名 (6), 被选标签.)
                                .否则
                                    替换 (取字段名 (3), 被选标签.)
                                .如果结束
                                赋值 (有棋子 [ [假]])
                                赋值 (被选标签, 原选标签)
                                赋值 (被选棋子, 原选棋子)
                                赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                                赋值 (被选棋子., 相加 (“9”, 被选标签.))
                                赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                                赋值 (., 该走棋)
                                赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                                赋值 (按住, 假)
                                赋值 (., 假)
                                赋值 (., 假)
                                行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                            .如果真结束
                            
                        .否则
                            赋值 (被选标签, 原选标签)
                            赋值 (被选棋子, 原选棋子)
                            .如果 (等于 (原选标签., 0))
                                替换 (取字段名 (5), “”)
                            .否则
                                替换 (取字段名 (2), “”)
                            .如果结束
                            
                        .如果结束
                        
                    .否则
                        赋值 (被选标签, 原选标签)
                        赋值 (被选棋子, 原选棋子)
                        .如果 (等于 (原选标签., 0))
                            替换 (取字段名 (5), “”)
                        .否则
                            替换 (取字段名 (2), “”)
                        .如果结束
                        
                    .如果结束
                    
                .如果真结束
                .如果真 (等于 (原选标签., “卒”))
                    .如果 (并且 (大于或等于 (纵, 5), 小于或等于 (纵, 10)))
                        .如果真 (等于 (纵, 5))
                            .如果 (等于 (标记横, 横))
                                赋值 (原选棋子., 1)
                                被选棋子.移动 (., 被选棋子., , )
                                被选棋子.移动 (400, , , )
                                .变量循环首 (11, 42, 1, 容器1)
                                    到首记录 ()
                                    .如果 (或者 (查找 (等于 (读 (3), 相加 (到文本 (容器1), 被选标签.))), 查找 (等于 (读 (6), 相加 (到文本 (容器1), 被选标签.)))))
                                        
                                    .否则
                                        到尾记录 ()
                                        跳出循环 ()
                                    .如果结束
                                    
                                .变量循环尾 ()
                                赋值 (被选标签., 相加 (到文本 (容器1), 被选标签.))
                                赋值 (被选棋子., 相加 (“9”, 被选标签.))
                                .如果 (等于 (原选标签., 0))
                                    替换 (取字段名 (6), 被选标签.)
                                .否则
                                    替换 (取字段名 (3), 被选标签.)
                                .如果结束
                                赋值 (有棋子 [ [假]])
                                赋值 (被选标签, 原选标签)
                                赋值 (被选棋子, 原选棋子)
                                赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                                赋值 (被选棋子., 相加 (“9”, 被选标签.))
                                赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                                赋值 (., 该走棋)
                                赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                                赋值 (按住, 假)
                                赋值 (., 假)
                                赋值 (., 假)
                                行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                            .否则
                                赋值 (被选标签, 原选标签)
                                赋值 (被选棋子, 原选棋子)
                                .如果 (等于 (原选标签., 0))
                                    替换 (取字段名 (5), “”)
                                .否则
                                    替换 (取字段名 (2), “”)
                                .如果结束
                                
                            .如果结束
                            
                        .如果真结束
                        .如果真 (大于 (纵, 5))
                            .如果 (或者 (并且 (等于 (标记纵, 纵), 等于 (取绝对值 (相减 (标记横, 横)), 1)), 并且 (等于 (标记横, 横), 等于 (相减 (纵, 标记纵), 1))))
                                .如果真 (并且 (等于 (标记纵, 纵), 等于 (取绝对值 (相减 (标记横, 横)), 1)))
                                    赋值 (原选棋子., 1)
                                    被选棋子.移动 (., 被选棋子., , )
                                    被选棋子.移动 (400, , , )
                                    .变量循环首 (11, 42, 1, 容器1)
                                        到首记录 ()
                                        .如果 (或者 (查找 (等于 (读 (3), 相加 (到文本 (容器1), 被选标签.))), 查找 (等于 (读 (6), 相加 (到文本 (容器1), 被选标签.)))))
                                            
                                        .否则
                                            到尾记录 ()
                                            跳出循环 ()
                                        .如果结束
                                        
                                    .变量循环尾 ()
                                    赋值 (被选标签., 相加 (到文本 (容器1), 被选标签.))
                                    赋值 (被选棋子., 相加 (“9”, 被选标签.))
                                    .如果 (等于 (原选标签., 0))
                                        替换 (取字段名 (6), 被选标签.)
                                    .否则
                                        替换 (取字段名 (3), 被选标签.)
                                    .如果结束
                                    赋值 (有棋子 [ [假]])
                                    赋值 (被选标签, 原选标签)
                                    赋值 (被选棋子, 原选棋子)
                                    赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                                    赋值 (被选棋子., 相加 (“9”, 被选标签.))
                                    赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                                    赋值 (., 该走棋)
                                    赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                                    赋值 (按住, 假)
                                    赋值 (., 假)
                                    赋值 (., 假)
                                    行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                                .如果真结束
                                .如果真 (并且 (等于 (标记横, 横), 等于 (相减 (纵, 标记纵), 1)))
                                    赋值 (原选棋子., 1)
                                    被选棋子.移动 (., 被选棋子., , )
                                    被选棋子.移动 (400, , , )
                                    .变量循环首 (11, 42, 1, 容器1)
                                        到首记录 ()
                                        .如果 (或者 (查找 (等于 (读 (3), 相加 (到文本 (容器1), 被选标签.))), 查找 (等于 (读 (6), 相加 (到文本 (容器1), 被选标签.)))))
                                            
                                        .否则
                                            到尾记录 ()
                                            跳出循环 ()
                                        .如果结束
                                        
                                    .变量循环尾 ()
                                    赋值 (被选标签., 相加 (到文本 (容器1), 被选标签.))
                                    赋值 (被选棋子., 相加 (“9”, 被选标签.))
                                    .如果 (等于 (原选标签., 0))
                                        替换 (取字段名 (6), 被选标签.)
                                    .否则
                                        替换 (取字段名 (3), 被选标签.)
                                    .如果结束
                                    赋值 (有棋子 [ [假]])
                                    赋值 (被选标签, 原选标签)
                                    赋值 (被选棋子, 原选棋子)
                                    赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                                    赋值 (被选棋子., 相加 (“9”, 被选标签.))
                                    赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                                    赋值 (., 该走棋)
                                    赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                                    赋值 (按住, 假)
                                    赋值 (., 假)
                                    赋值 (., 假)
                                    行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                                .如果真结束
                                
                            .否则
                                赋值 (被选标签, 原选标签)
                                赋值 (被选棋子, 原选棋子)
                                .如果 (等于 (原选标签., 0))
                                    替换 (取字段名 (5), “”)
                                .否则
                                    替换 (取字段名 (2), “”)
                                .如果结束
                                
                            .如果结束
                            
                        .如果真结束
                        
                    .否则
                        赋值 (被选标签, 原选标签)
                        赋值 (被选棋子, 原选棋子)
                        .如果 (等于 (原选标签., 0))
                            替换 (取字段名 (5), “”)
                        .否则
                            替换 (取字段名 (2), “”)
                        .如果结束
                        
                    .如果结束
                    
                .如果真结束
                .如果真 (等于 (原选标签., “兵”))
                    .如果 (并且 (小于或等于 (纵, 6), 大于或等于 (纵, 1)))
                        .如果真 (等于 (纵, 6))
                            .如果 (等于 (标记横, 横))
                                赋值 (原选棋子., 1)
                                被选棋子.移动 (., 被选棋子., , )
                                被选棋子.移动 (400, , , )
                                .变量循环首 (11, 42, 1, 容器1)
                                    到首记录 ()
                                    .如果 (或者 (查找 (等于 (读 (3), 相加 (到文本 (容器1), 被选标签.))), 查找 (等于 (读 (6), 相加 (到文本 (容器1), 被选标签.)))))
                                        
                                    .否则
                                        到尾记录 ()
                                        跳出循环 ()
                                    .如果结束
                                    
                                .变量循环尾 ()
                                赋值 (被选标签., 相加 (到文本 (容器1), 被选标签.))
                                赋值 (被选棋子., 相加 (“9”, 被选标签.))
                                .如果 (等于 (原选标签., 0))
                                    替换 (取字段名 (6), 被选标签.)
                                .否则
                                    替换 (取字段名 (3), 被选标签.)
                                .如果结束
                                赋值 (有棋子 [ [假]])
                                赋值 (被选标签, 原选标签)
                                赋值 (被选棋子, 原选棋子)
                                赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                                赋值 (被选棋子., 相加 (“9”, 被选标签.))
                                赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                                赋值 (., 该走棋)
                                赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                                赋值 (按住, 假)
                                赋值 (., 假)
                                赋值 (., 假)
                                行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                            .否则
                                赋值 (被选标签, 原选标签)
                                赋值 (被选棋子, 原选棋子)
                                .如果 (等于 (原选标签., 0))
                                    替换 (取字段名 (5), “”)
                                .否则
                                    替换 (取字段名 (2), “”)
                                .如果结束
                                
                            .如果结束
                            
                        .如果真结束
                        .如果真 (小于 (纵, 6))
                            .如果 (或者 (并且 (等于 (标记纵, 纵), 等于 (取绝对值 (相减 (标记横, 横)), 1)), 并且 (等于 (标记横, 横), 等于 (相减 (标记纵, 纵), 1))))
                                .如果真 (并且 (等于 (标记纵, 纵), 等于 (取绝对值 (相减 (标记横, 横)), 1)))
                                    赋值 (原选棋子., 1)
                                    被选棋子.移动 (., 被选棋子., , )
                                    被选棋子.移动 (400, , , )
                                    .变量循环首 (11, 42, 1, 容器1)
                                        到首记录 ()
                                        .如果 (或者 (查找 (等于 (读 (3), 相加 (到文本 (容器1), 被选标签.))), 查找 (等于 (读 (6), 相加 (到文本 (容器1), 被选标签.)))))
                                            
                                        .否则
                                            到尾记录 ()
                                            跳出循环 ()
                                        .如果结束
                                        
                                    .变量循环尾 ()
                                    赋值 (被选标签., 相加 (到文本 (容器1), 被选标签.))
                                    赋值 (被选棋子., 相加 (“9”, 被选标签.))
                                    .如果 (等于 (原选标签., 0))
                                        替换 (取字段名 (6), 被选标签.)
                                    .否则
                                        替换 (取字段名 (3), 被选标签.)
                                    .如果结束
                                    赋值 (有棋子 [ [假]])
                                    赋值 (被选标签, 原选标签)
                                    赋值 (被选棋子, 原选棋子)
                                    赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                                    赋值 (被选棋子., 相加 (“9”, 被选标签.))
                                    赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                                    赋值 (., 该走棋)
                                    赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                                    赋值 (按住, 假)
                                    赋值 (., 假)
                                    赋值 (., 假)
                                    行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                                .如果真结束
                                .如果真 (并且 (等于 (标记横, 横), 等于 (相减 (标记纵, 纵), 1)))
                                    赋值 (原选棋子., 1)
                                    被选棋子.移动 (., 被选棋子., , )
                                    被选棋子.移动 (400, , , )
                                    .变量循环首 (11, 42, 1, 容器1)
                                        到尾记录 ()
                                        .如果 (或者 (查找 (等于 (读 (3), 相加 (到文本 (容器1), 被选标签.))), 查找 (等于 (读 (6), 相加 (到文本 (容器1), 被选标签.)))))
                                            
                                        .否则
                                            到尾记录 ()
                                            跳出循环 ()
                                        .如果结束
                                        
                                    .变量循环尾 ()
                                    赋值 (被选标签., 相加 (到文本 (容器1), 被选标签.))
                                    赋值 (被选棋子., 相加 (“9”, 被选标签.))
                                    .如果 (等于 (原选标签., 0))
                                        替换 (取字段名 (6), 被选标签.)
                                    .否则
                                        替换 (取字段名 (3), 被选标签.)
                                    .如果结束
                                    赋值 (有棋子 [ [假]])
                                    赋值 (被选标签, 原选标签)
                                    赋值 (被选棋子, 原选棋子)
                                    赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                                    赋值 (被选棋子., 相加 (“9”, 被选标签.))
                                    赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                                    赋值 (., 该走棋)
                                    赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                                    赋值 (按住, 假)
                                    赋值 (., 假)
                                    赋值 (., 假)
                                    行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                                .如果真结束
                                
                            .否则
                                赋值 (被选标签, 原选标签)
                                赋值 (被选棋子, 原选棋子)
                                .如果 (等于 (原选标签., 0))
                                    替换 (取字段名 (5), “”)
                                .否则
                                    替换 (取字段名 (2), “”)
                                .如果结束
                                
                            .如果结束
                            
                        .如果真结束
                        
                    .否则
                        赋值 (被选标签, 原选标签)
                        赋值 (被选棋子, 原选棋子)
                        .如果 (等于 (原选标签., 0))
                            替换 (取字段名 (5), “”)
                        .否则
                            替换 (取字段名 (2), “”)
                        .如果结束
                        
                    .如果结束
                    
                .如果真结束
                .如果真 (并且 (等于 (取文本右边 (., 1), 取文本右边 (., 1)), 不等于 (., 400), 不等于 (., 400)))
                    赋值 (棋子个数, 0)
                    赋值 (标记纵, 到数值 (选择 (等于 (取文本长度 (.), 2), 取文本左边 (., 1), 取文本左边 (., 2))))
                    赋值 (纵, 到数值 (选择 (等于 (取文本长度 (.), 2), 取文本左边 (., 1), 取文本左边 (., 2))))
                    赋值 (横, 到数值 (取文本右边 (., 1)))
                    .变量循环首 (相加 (标记纵, 1), 相减 (纵, 1), 1, 容器1)
                        .如果真 (等于 (有棋子 [ [横]], 真))
                            赋值 (相加 (1))
                        .如果真结束
                        
                    .变量循环尾 ()
                    .如果真 (等于 (棋子个数, 0))
                        .如果 (等于 (该走棋, 0))
                            赋值 (., 该走棋)
                            赋值 (., “ 将帅照面，黑棋赢！”)
                        .否则
                            赋值 (., 该走棋)
                            赋值 (., “ 将帅照面，红棋赢！”)
                        .如果结束
                        赋值 (., 0)
                        赋值 (赢棋方, 该走棋)
                        鸣叫 ()
                        载入 (赢棋窗口, , 真)
                        赋值 (., 真)
                        赋值 (., 真)
                        赋值 (., 真)
                        赋值 (., 真)
                        赋值 (., 真)
                    .如果真结束
                    
                .如果真结束
                
            .如果结束
            
        .如果真结束
        
    .如果结束
    .如果真 (等于 (., 400))
        赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
        赋值 (., 该走棋)
        赋值 (., “ 本局结束，红棋赢！”)
        赋值 (., 0)
        赋值 (赢棋方, 该走棋)
        鸣叫 ()
        载入 (赢棋窗口, , 真)
        赋值 (., 真)
        赋值 (., 真)
        赋值 (., 真)
        赋值 (., 真)
        赋值 (., 真)
    .如果真结束
    .如果真 (等于 (., 400))
        赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
        赋值 (., 该走棋)
        赋值 (., “ 本局结束，黑棋赢！”)
        赋值 (., 0)
        赋值 (赢棋方, 该走棋)
        鸣叫 ()
        载入 (赢棋窗口, , 真)
        赋值 (., 真)
        赋值 (., 真)
        赋值 (., 真)
        赋值 (., 真)
        赋值 (., 真)
    .如果真结束
    
    
.如果结束


.子程序 _画板1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 容器1, 整数型, , , 

.如果 (或者 (小于或等于 (求余数 (相加 (横向位置, 20), 40), 16), 大于或等于 (求余数 (相加 (横向位置, 20), 40), 24)))
    赋值 (横, 选择 (小于或等于 (求余数 (相加 (横向位置, 20), 40), 16), 取整 (相除 (相加 (横向位置, 20), 40)), 相加 (取整 (相除 (相加 (横向位置, 20), 40)), 1)))
.否则
    赋值 (横, 0)
.如果结束
.如果 (或者 (小于或等于 (求余数 (相加 (纵向位置, 20), 40), 16), 大于或等于 (求余数 (相加 (纵向位置, 20), 40), 24)))
    赋值 (纵, 选择 (小于或等于 (求余数 (相加 (纵向位置, 20), 40), 16), 取整 (相除 (相加 (纵向位置, 20), 40)), 相加 (取整 (相除 (相加 (纵向位置, 20), 40)), 1)))
.否则
    赋值 (纵, 0)
.如果结束
.如果真 (大于 (横, 9))
    赋值 (横, 0)
.如果真结束
.如果真 (大于 (纵, 10))
    赋值 (纵, 0)
.如果真结束
.如果 (等于 (排局状态, 真))
    .如果真 (等于 (按住, 真))
        赋值 (标记纵, 选择 (等于 (取文本长度 (被选标签.), 3), 到数值 (取文本左边 (被选标签., 2)), 到数值 (取文本左边 (被选标签., 1))))
        赋值 (标记横, 到数值 (取文本右边 (被选标签., 1)))
        .如果 (或者 (等于 (被选标签., “车”), 等于 (被选标签., “马”), 等于 (被选标签., “炮”)))
            被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
            赋值 (被选棋子., 1)
            赋值 (有棋子 [ [假]])
            赋值 (有棋子 [纵] [横], 真)
            赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
            赋值 (被选棋子., 相加 (“9”, 被选标签.))
            赋值 (按住, 假)
        .否则
            .如果真 (并且 (等于 (被选标签., “将”), 大于或等于 (纵, 1), 小于或等于 (纵, 3), 大于或等于 (横, 4), 小于或等于 (横, 6)))
                被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                赋值 (被选棋子., 1)
                赋值 (有棋子 [ [假]])
                赋值 (有棋子 [纵] [横], 真)
                赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                赋值 (被选棋子., 相加 (“9”, 被选标签.))
                赋值 (按住, 假)
            .如果真结束
            .如果真 (并且 (等于 (被选标签., “帅”), 大于或等于 (纵, 8), 小于或等于 (纵, 10), 大于或等于 (横, 4), 小于或等于 (横, 6)))
                被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                赋值 (被选棋子., 1)
                赋值 (有棋子 [ [假]])
                赋值 (有棋子 [纵] [横], 真)
                赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                赋值 (被选棋子., 相加 (“9”, 被选标签.))
                赋值 (按住, 假)
            .如果真结束
            .如果真 (并且 (等于 (被选标签., “仕”), 大于或等于 (纵, 1), 小于或等于 (纵, 3), 大于或等于 (横, 4), 小于或等于 (横, 6)))
                .如果真 (或者 (并且 (等于 (纵, 1), 等于 (横, 4)), 并且 (等于 (纵, 1), 等于 (横, 6)), 并且 (等于 (纵, 2), 等于 (横, 5)), 并且 (等于 (纵, 3), 等于 (横, 4)), 并且 (等于 (纵, 3), 等于 (横, 6))))
                    被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                    赋值 (被选棋子., 1)
                    赋值 (有棋子 [ [假]])
                    赋值 (有棋子 [纵] [横], 真)
                    赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                    赋值 (被选棋子., 相加 (“9”, 被选标签.))
                    赋值 (按住, 假)
                .如果真结束
                
            .如果真结束
            .如果真 (并且 (等于 (被选标签., “士”), 大于或等于 (纵, 8), 小于或等于 (纵, 10), 大于或等于 (横, 4), 小于或等于 (横, 6)))
                .如果真 (或者 (并且 (等于 (纵, 8), 等于 (横, 4)), 并且 (等于 (纵, 8), 等于 (横, 6)), 并且 (等于 (纵, 9), 等于 (横, 5)), 并且 (等于 (纵, 10), 等于 (横, 4)), 并且 (等于 (纵, 10), 等于 (横, 6))))
                    被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                    赋值 (被选棋子., 1)
                    赋值 (有棋子 [ [假]])
                    赋值 (有棋子 [纵] [横], 真)
                    赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                    赋值 (被选棋子., 相加 (“9”, 被选标签.))
                    赋值 (按住, 假)
                .如果真结束
                
            .如果真结束
            .如果真 (并且 (等于 (被选标签., “象”), 大于或等于 (纵, 1), 小于或等于 (纵, 5)))
                .如果真 (或者 (并且 (等于 (纵, 1), 等于 (横, 3)), 并且 (等于 (纵, 1), 等于 (横, 7)), 并且 (等于 (纵, 3), 等于 (横, 1)), 并且 (等于 (纵, 3), 等于 (横, 5)), 并且 (等于 (纵, 3), 等于 (横, 9)), 并且 (等于 (纵, 5), 等于 (横, 3)), 并且 (等于 (纵, 5), 等于 (横, 7))))
                    被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                    赋值 (被选棋子., 1)
                    赋值 (有棋子 [ [假]])
                    赋值 (有棋子 [纵] [横], 真)
                    赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                    赋值 (被选棋子., 相加 (“9”, 被选标签.))
                    赋值 (按住, 假)
                .如果真结束
                
            .如果真结束
            .如果真 (并且 (等于 (被选标签., “相”), 大于或等于 (纵, 6), 小于或等于 (纵, 10)))
                .如果真 (或者 (并且 (等于 (纵, 6), 等于 (横, 3)), 并且 (等于 (纵, 6), 等于 (横, 7)), 并且 (等于 (纵, 8), 等于 (横, 1)), 并且 (等于 (纵, 8), 等于 (横, 5)), 并且 (等于 (纵, 8), 等于 (横, 9)), 并且 (等于 (纵, 10), 等于 (横, 3)), 并且 (等于 (纵, 10), 等于 (横, 7))))
                    被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                    赋值 (被选棋子., 1)
                    赋值 (有棋子 [ [假]])
                    赋值 (有棋子 [纵] [横], 真)
                    赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                    赋值 (被选棋子., 相加 (“9”, 被选标签.))
                    赋值 (按住, 假)
                .如果真结束
                
            .如果真结束
            .如果真 (等于 (被选标签., “卒”))
                .如果真 (等于 (纵, 4))
                    .如果真 (或者 (等于 (横, 1), 等于 (横, 3), 等于 (横, 5), 等于 (横, 7), 等于 (横, 9)))
                        被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                        赋值 (被选棋子., 1)
                        赋值 (有棋子 [ [假]])
                        赋值 (有棋子 [纵] [横], 真)
                        赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                        赋值 (被选棋子., 相加 (“9”, 被选标签.))
                        赋值 (按住, 假)
                    .如果真结束
                    
                .如果真结束
                .如果真 (并且 (等于 (纵, 5), 等于 (标记横, 横)))
                    被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                    赋值 (被选棋子., 1)
                    赋值 (有棋子 [ [假]])
                    赋值 (有棋子 [纵] [横], 真)
                    赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                    赋值 (被选棋子., 相加 (“9”, 被选标签.))
                    赋值 (按住, 假)
                .如果真结束
                .如果真 (大于 (纵, 5))
                    被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                    赋值 (被选棋子., 1)
                    赋值 (有棋子 [ [假]])
                    赋值 (有棋子 [纵] [横], 真)
                    赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                    赋值 (被选棋子., 相加 (“9”, 被选标签.))
                    赋值 (按住, 假)
                .如果真结束
                
            .如果真结束
            .如果真 (等于 (被选标签., “兵”))
                .如果真 (等于 (纵, 7))
                    .如果真 (或者 (等于 (横, 1), 等于 (横, 3), 等于 (横, 5), 等于 (横, 7), 等于 (横, 9)))
                        被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                        赋值 (被选棋子., 1)
                        赋值 (有棋子 [ [假]])
                        赋值 (有棋子 [纵] [横], 真)
                        赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                        赋值 (被选棋子., 相加 (“9”, 被选标签.))
                        赋值 (按住, 假)
                    .如果真结束
                    
                .如果真结束
                .如果真 (并且 (等于 (纵, 6), 等于 (标记横, 横)))
                    被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                    赋值 (被选棋子., 1)
                    赋值 (有棋子 [ [假]])
                    赋值 (有棋子 [纵] [横], 真)
                    赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                    赋值 (被选棋子., 相加 (“9”, 被选标签.))
                    赋值 (按住, 假)
                .如果真结束
                .如果真 (小于 (纵, 6))
                    被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                    赋值 (被选棋子., 1)
                    赋值 (有棋子 [ [假]])
                    赋值 (有棋子 [纵] [横], 真)
                    赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                    赋值 (被选棋子., 相加 (“9”, 被选标签.))
                    赋值 (按住, 假)
                .如果真结束
                
            .如果真结束
            
        .如果结束
        
    .如果真结束
    
.否则
    .如果 (或者 (等于 (横, 0), 等于 (纵, 0)))
        
    .否则
        .如果真 (等于 (按住, 真))
            赋值 (标记纵, 选择 (等于 (取文本长度 (被选标签.), 3), 到数值 (取文本左边 (被选标签., 2)), 到数值 (取文本左边 (被选标签., 1))))
            赋值 (标记横, 到数值 (取文本右边 (被选标签., 1)))
            .如果真 (或者 (等于 (被选标签., “车”), 等于 (被选标签., “炮”)))
                赋值 (棋子个数, 0)
                .如果真 (并且 (等于 (标记纵, 纵), 不等于 (标记横, 横)))
                    .如果 (大于 (标记横, 横))
                        .变量循环首 (相减 (标记横, 1), 横, -1, 容器1)
                            .如果真 (等于 (有棋子 [纵] [容器1], 真))
                                赋值 (相加 (1))
                            .如果真结束
                            
                        .变量循环尾 ()
                    .否则
                        .变量循环首 (相加 (标记横, 1), 横, 1, 容器1)
                            .如果真 (等于 (有棋子 [纵] [容器1], 真))
                                赋值 (相加 (1))
                            .如果真结束
                            
                        .变量循环尾 ()
                    .如果结束
                    
                .如果真结束
                .如果真 (并且 (不等于 (标记纵, 纵), 等于 (标记横, 横)))
                    .如果 (大于 (标记纵, 纵))
                        .变量循环首 (相减 (标记纵, 1), 纵, -1, 容器1)
                            .如果真 (等于 (有棋子 [容器1] [横], 真))
                                赋值 (相加 (1))
                            .如果真结束
                            
                        .变量循环尾 ()
                    .否则
                        .变量循环首 (相加 (标记纵, 1), 纵, 1, 容器1)
                            .如果真 (等于 (有棋子 [容器1] [横], 真))
                                赋值 (相加 (1))
                            .如果真结束
                            
                        .变量循环尾 ()
                    .如果结束
                    
                .如果真结束
                .如果真 (并且 (不等于 (标记纵, 纵), 不等于 (标记横, 横)))
                    赋值 (10)
                .如果真结束
                .如果真 (等于 (0))
                    被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                    赋值 (被选棋子., 1)
                    赋值 (有棋子 [ [假]])
                    赋值 (有棋子 [纵] [横], 真)
                    赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                    赋值 (被选棋子., 相加 (“9”, 被选标签.))
                    .如果 (等于 (被选标签., 0))
                        替换 (取字段名 (5), 被选标签.)
                    .否则
                        替换 (取字段名 (2), 被选标签.)
                    .如果结束
                    赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                    赋值 (., 该走棋)
                    赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                    赋值 (按住, 假)
                    赋值 (., 假)
                    赋值 (., 假)
                    行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                .如果真结束
                
            .如果真结束
            .如果真 (等于 (被选标签., “马”))
                .如果真 (并且 (等于 (取绝对值 (相减 (标记纵, 纵)), 2), 等于 (取绝对值 (相减 (标记横, 横)), 1)))
                    .如果真 (等于 (有棋子 [选择 (大于 (标记纵, 纵), 相减 (标记纵, 1), 相加 (标记纵, 1))] [标记横], 假))
                        被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                        赋值 (被选棋子., 1)
                        赋值 (有棋子 [ [假]])
                        赋值 (有棋子 [纵] [横], 真)
                        赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                        赋值 (被选棋子., 相加 (“9”, 被选标签.))
                        .如果 (等于 (被选标签., 0))
                            替换 (取字段名 (5), 被选标签.)
                        .否则
                            替换 (取字段名 (2), 被选标签.)
                        .如果结束
                        赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                        赋值 (., 该走棋)
                        赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                        赋值 (按住, 假)
                        赋值 (., 假)
                        赋值 (., 假)
                        行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                    .如果真结束
                    
                .如果真结束
                .如果真 (并且 (等于 (取绝对值 (相减 (标记纵, 纵)), 1), 等于 (取绝对值 (相减 (标记横, 横)), 2)))
                    .如果真 (等于 (有棋子 [标记纵] [选择 (大于 (标记横, 横), 相减 (标记横, 1), 相加 (标记横, 1))], 假))
                        被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                        赋值 (被选棋子., 1)
                        赋值 (有棋子 [ [假]])
                        赋值 (有棋子 [纵] [横], 真)
                        赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                        赋值 (被选棋子., 相加 (“9”, 被选标签.))
                        .如果 (等于 (被选标签., 0))
                            替换 (取字段名 (5), 被选标签.)
                        .否则
                            替换 (取字段名 (2), 被选标签.)
                        .如果结束
                        赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                        赋值 (., 该走棋)
                        赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                        赋值 (按住, 假)
                        赋值 (., 假)
                        赋值 (., 假)
                        行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                    .如果真结束
                    
                .如果真结束
                
            .如果真结束
            .如果真 (等于 (被选标签., “仕”))
                .如果真 (并且 (大于或等于 (纵, 1), 小于或等于 (纵, 3), 大于或等于 (横, 4), 小于或等于 (横, 6)))
                    .如果真 (并且 (等于 (取绝对值 (相减 (标记纵, 纵)), 1), 等于 (取绝对值 (相减 (标记横, 横)), 1), 等于 (有棋子 [纵] [横], 假)))
                        被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                        赋值 (被选棋子., 1)
                        赋值 (有棋子 [ [假]])
                        赋值 (有棋子 [纵] [横], 真)
                        赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                        赋值 (被选棋子., 相加 (“9”, 被选标签.))
                        .如果 (等于 (被选标签., 0))
                            替换 (取字段名 (5), 被选标签.)
                        .否则
                            替换 (取字段名 (2), 被选标签.)
                        .如果结束
                        赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                        赋值 (., 该走棋)
                        赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                        赋值 (按住, 假)
                        赋值 (., 假)
                        赋值 (., 假)
                        行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                    .如果真结束
                    
                .如果真结束
                
            .如果真结束
            .如果真 (等于 (被选标签., “象”))
                .如果真 (并且 (小于或等于 (纵, 5), 等于 (取绝对值 (相减 (标记纵, 纵)), 2), 等于 (取绝对值 (相减 (标记横, 横)), 2), 等于 (有棋子 [纵] [横], 假), 等于 (有棋子 [选择 (大于 (标记纵, 纵), 相减 (标记纵, 1), 相加 (标记纵, 1))] [选择 (大于 (标记横, 横), 相减 (标记横, 1), 相加 (标记横, 1))], 假)))
                    被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                    赋值 (被选棋子., 1)
                    赋值 (有棋子 [ [假]])
                    赋值 (有棋子 [纵] [横], 真)
                    赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                    赋值 (被选棋子., 相加 (“9”, 被选标签.))
                    .如果 (等于 (被选标签., 0))
                        替换 (取字段名 (5), 被选标签.)
                    .否则
                        替换 (取字段名 (2), 被选标签.)
                    .如果结束
                    赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                    赋值 (., 该走棋)
                    赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                    赋值 (按住, 假)
                    赋值 (., 假)
                    赋值 (., 假)
                    行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                .如果真结束
                
            .如果真结束
            .如果真 (等于 (被选标签., “将”))
                .如果真 (并且 (大于或等于 (纵, 1), 小于或等于 (纵, 3), 大于或等于 (横, 4), 小于或等于 (横, 6)))
                    .如果真 (并且 (等于 (标记纵, 纵), 等于 (取绝对值 (相减 (标记横, 横)), 1), 等于 (有棋子 [纵] [横], 假)))
                        被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                        赋值 (被选棋子., 1)
                        赋值 (有棋子 [ [假]])
                        赋值 (有棋子 [纵] [横], 真)
                        赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                        赋值 (被选棋子., 相加 (“9”, 被选标签.))
                        .如果 (等于 (被选标签., 0))
                            替换 (取字段名 (5), 被选标签.)
                        .否则
                            替换 (取字段名 (2), 被选标签.)
                        .如果结束
                        赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                        赋值 (., 该走棋)
                        赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                        赋值 (按住, 假)
                        赋值 (., 假)
                        赋值 (., 假)
                        行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                    .如果真结束
                    .如果真 (并且 (等于 (标记横, 横), 等于 (取绝对值 (相减 (标记纵, 纵)), 1), 等于 (有棋子 [纵] [横], 假)))
                        被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                        赋值 (被选棋子., 1)
                        赋值 (有棋子 [ [假]])
                        赋值 (有棋子 [纵] [横], 真)
                        赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                        赋值 (被选棋子., 相加 (“9”, 被选标签.))
                        .如果 (等于 (被选标签., 0))
                            替换 (取字段名 (5), 被选标签.)
                        .否则
                            替换 (取字段名 (2), 被选标签.)
                        .如果结束
                        赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                        赋值 (., 该走棋)
                        赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                        赋值 (按住, 假)
                        赋值 (., 假)
                        赋值 (., 假)
                        行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                    .如果真结束
                    
                .如果真结束
                
            .如果真结束
            .如果真 (等于 (被选标签., “卒”))
                .如果真 (并且 (等于 (纵, 5), 等于 (标记横, 横)))
                    被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                    赋值 (被选棋子., 1)
                    赋值 (有棋子 [ [假]])
                    赋值 (有棋子 [纵] [横], 真)
                    赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                    赋值 (被选棋子., 相加 (“9”, 被选标签.))
                    .如果 (等于 (被选标签., 0))
                        替换 (取字段名 (5), 被选标签.)
                    .否则
                        替换 (取字段名 (2), 被选标签.)
                    .如果结束
                    赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                    赋值 (., 该走棋)
                    赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                    赋值 (按住, 假)
                    赋值 (., 假)
                    赋值 (., 假)
                    行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                .如果真结束
                .如果真 (并且 (大于 (纵, 5), 小于或等于 (纵, 10)))
                    .如果真 (并且 (等于 (标记纵, 纵), 等于 (取绝对值 (相减 (标记横, 横)), 1), 等于 (有棋子 [纵] [横], 假)))
                        被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                        赋值 (被选棋子., 1)
                        赋值 (有棋子 [ [假]])
                        赋值 (有棋子 [纵] [横], 真)
                        赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                        赋值 (被选棋子., 相加 (“9”, 被选标签.))
                        .如果 (等于 (被选标签., 0))
                            替换 (取字段名 (5), 被选标签.)
                        .否则
                            替换 (取字段名 (2), 被选标签.)
                        .如果结束
                        赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                        赋值 (., 该走棋)
                        赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                        赋值 (按住, 假)
                        赋值 (., 假)
                        赋值 (., 假)
                        行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                    .如果真结束
                    .如果真 (并且 (等于 (标记横, 横), 等于 (相减 (纵, 标记纵), 1), 等于 (有棋子 [纵] [横], 假)))
                        被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                        赋值 (被选棋子., 1)
                        赋值 (有棋子 [ [假]])
                        赋值 (有棋子 [纵] [横], 真)
                        赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                        赋值 (被选棋子., 相加 (“9”, 被选标签.))
                        .如果 (等于 (被选标签., 0))
                            替换 (取字段名 (5), 被选标签.)
                        .否则
                            替换 (取字段名 (2), 被选标签.)
                        .如果结束
                        赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                        赋值 (., 该走棋)
                        赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                        赋值 (按住, 假)
                        赋值 (., 假)
                        赋值 (., 假)
                        行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                    .如果真结束
                    
                .如果真结束
                
            .如果真结束
            .如果真 (等于 (被选标签., “兵”))
                .如果真 (并且 (等于 (纵, 6), 等于 (标记横, 横)))
                    被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                    赋值 (被选棋子., 1)
                    赋值 (有棋子 [ [假]])
                    赋值 (有棋子 [纵] [横], 真)
                    赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                    赋值 (被选棋子., 相加 (“9”, 被选标签.))
                    .如果 (等于 (被选标签., 0))
                        替换 (取字段名 (5), 被选标签.)
                    .否则
                        替换 (取字段名 (2), 被选标签.)
                    .如果结束
                    赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                    赋值 (., 该走棋)
                    赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                    赋值 (按住, 假)
                    赋值 (., 假)
                    赋值 (., 假)
                    行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                .如果真结束
                .如果真 (并且 (小于 (纵, 6), 大于或等于 (纵, 1)))
                    .如果真 (并且 (等于 (标记纵, 纵), 等于 (取绝对值 (相减 (标记横, 横)), 1), 等于 (有棋子 [纵] [横], 假)))
                        被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                        赋值 (被选棋子., 1)
                        赋值 (有棋子 [ [假]])
                        赋值 (有棋子 [纵] [横], 真)
                        赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                        赋值 (被选棋子., 相加 (“9”, 被选标签.))
                        .如果 (等于 (被选标签., 0))
                            替换 (取字段名 (5), 被选标签.)
                        .否则
                            替换 (取字段名 (2), 被选标签.)
                        .如果结束
                        赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                        赋值 (., 该走棋)
                        赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                        赋值 (按住, 假)
                        赋值 (., 假)
                        赋值 (., 假)
                        行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                    .如果真结束
                    .如果真 (并且 (等于 (标记横, 横), 等于 (相减 (标记纵, 纵), 1), 等于 (有棋子 [纵] [横], 假)))
                        被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                        赋值 (被选棋子., 1)
                        赋值 (有棋子 [ [假]])
                        赋值 (有棋子 [纵] [横], 真)
                        赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                        赋值 (被选棋子., 相加 (“9”, 被选标签.))
                        .如果 (等于 (被选标签., 0))
                            替换 (取字段名 (5), 被选标签.)
                        .否则
                            替换 (取字段名 (2), 被选标签.)
                        .如果结束
                        赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                        赋值 (., 该走棋)
                        赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                        赋值 (按住, 假)
                        赋值 (., 假)
                        赋值 (., 假)
                        行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                    .如果真结束
                    
                .如果真结束
                
            .如果真结束
            .如果真 (等于 (被选标签., “士”))
                .如果真 (并且 (大于或等于 (纵, 8), 小于或等于 (纵, 10), 大于或等于 (横, 4), 小于或等于 (横, 6)))
                    .如果真 (并且 (等于 (取绝对值 (相减 (标记纵, 纵)), 1), 等于 (取绝对值 (相减 (标记横, 横)), 1), 等于 (有棋子 [纵] [横], 假)))
                        被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                        赋值 (被选棋子., 1)
                        赋值 (有棋子 [ [假]])
                        赋值 (有棋子 [纵] [横], 真)
                        赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                        赋值 (被选棋子., 相加 (“9”, 被选标签.))
                        .如果 (等于 (被选标签., 0))
                            替换 (取字段名 (5), 被选标签.)
                        .否则
                            替换 (取字段名 (2), 被选标签.)
                        .如果结束
                        赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                        赋值 (., 该走棋)
                        赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                        赋值 (按住, 假)
                        赋值 (., 假)
                        赋值 (., 假)
                        行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                    .如果真结束
                    
                .如果真结束
                
            .如果真结束
            .如果真 (等于 (被选标签., “相”))
                .如果真 (并且 (大于或等于 (纵, 6), 等于 (取绝对值 (相减 (标记纵, 纵)), 2), 等于 (取绝对值 (相减 (标记横, 横)), 2), 等于 (有棋子 [纵] [横], 假), 等于 (有棋子 [选择 (大于 (标记纵, 纵), 相减 (标记纵, 1), 相加 (标记纵, 1))] [选择 (大于 (标记横, 横), 相减 (标记横, 1), 相加 (标记横, 1))], 假)))
                    被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                    赋值 (被选棋子., 1)
                    赋值 (有棋子 [ [假]])
                    赋值 (有棋子 [纵] [横], 真)
                    赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                    赋值 (被选棋子., 相加 (“9”, 被选标签.))
                    .如果 (等于 (被选标签., 0))
                        替换 (取字段名 (5), 被选标签.)
                    .否则
                        替换 (取字段名 (2), 被选标签.)
                    .如果结束
                    赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                    赋值 (., 该走棋)
                    赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                    赋值 (按住, 假)
                    赋值 (., 假)
                    赋值 (., 假)
                    行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                .如果真结束
                
            .如果真结束
            .如果真 (等于 (被选标签., “帅”))
                .如果真 (并且 (大于或等于 (纵, 8), 小于或等于 (纵, 10), 大于或等于 (横, 4), 小于或等于 (横, 6)))
                    .如果真 (并且 (等于 (标记纵, 纵), 等于 (取绝对值 (相减 (标记横, 横)), 1), 等于 (有棋子 [纵] [横], 假)))
                        被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                        赋值 (被选棋子., 1)
                        赋值 (有棋子 [ [假]])
                        赋值 (有棋子 [纵] [横], 真)
                        赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                        赋值 (被选棋子., 相加 (“9”, 被选标签.))
                        .如果 (等于 (被选标签., 0))
                            替换 (取字段名 (5), 被选标签.)
                        .否则
                            替换 (取字段名 (2), 被选标签.)
                        .如果结束
                        赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                        赋值 (., 该走棋)
                        赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                        赋值 (按住, 假)
                        赋值 (., 假)
                        赋值 (., 假)
                        行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                    .如果真结束
                    .如果真 (并且 (等于 (标记横, 横), 等于 (取绝对值 (相减 (标记纵, 纵)), 1), 等于 (有棋子 [纵] [横], 假)))
                        被选棋子.移动 (相减 (相乘 (横, 40), 20, 18), 相减 (相乘 (纵, 40), 20, 18), , )
                        赋值 (被选棋子., 1)
                        赋值 (有棋子 [ [假]])
                        赋值 (有棋子 [纵] [横], 真)
                        赋值 (被选标签., 相加 (到文本 (纵), 到文本 (横)))
                        赋值 (被选棋子., 相加 (“9”, 被选标签.))
                        .如果 (等于 (被选标签., 0))
                            替换 (取字段名 (5), 被选标签.)
                        .否则
                            替换 (取字段名 (2), 被选标签.)
                        .如果结束
                        赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
                        赋值 (., 该走棋)
                        赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
                        赋值 (按住, 假)
                        赋值 (., 假)
                        赋值 (., 假)
                        行棋步骤名 (被选标签., 标记纵, 标记横, 纵, 横)
                    .如果真结束
                    
                .如果真结束
                
            .如果真结束
            .如果真 (等于 (取文本右边 (., 1), 取文本右边 (., 1)))
                赋值 (棋子个数, 0)
                赋值 (标记纵, 到数值 (选择 (等于 (取文本长度 (.), 2), 取文本左边 (., 1), 取文本左边 (., 2))))
                赋值 (纵, 到数值 (选择 (等于 (取文本长度 (.), 2), 取文本左边 (., 1), 取文本左边 (., 2))))
                赋值 (横, 到数值 (取文本右边 (., 1)))
                .变量循环首 (相加 (标记纵, 1), 相减 (纵, 1), 1, )
                    .如果真 (等于 (有棋子 [ [横]], 真))
                        赋值 (相加 (1))
                    .如果真结束
                    
                .变量循环尾 ()
                .如果真 (等于 (棋子个数, 0))
                    .如果 (等于 (该走棋, 0))
                        赋值 (., 该走棋)
                        赋值 (., “ 将帅照面，黑棋赢！”)
                    .否则
                        赋值 (., 该走棋)
                        赋值 (., “ 将帅照面，红棋赢！”)
                    .如果结束
                    赋值 (., 0)
                    赋值 (赢棋方, 该走棋)
                    鸣叫 ()
                    载入 (赢棋窗口, , 真)
                    赋值 (., 真)
                    赋值 (., 真)
                    赋值 (., 真)
                    赋值 (., 真)
                    赋值 (., 真)
                .如果真结束
                
            .如果真结束
            
        .如果真结束
        
    .如果结束
    
.如果结束


.子程序 _新游戏_被选择, 空白型, , 
.如果真 (或者 (并且 (等于 (., 假), 等于 (信息框 (“本局棋尚未结束，真的要开始新一局吗？”, 相加 (#询问图标, #确认取消钮), “结束棋局：”), #确认钮)), 等于 (., 真)))
    未知函数_67175187 ()
.如果真结束


.子程序 _编辑框1_获得焦点, 空白型, , 
获取焦点 ()

.子程序 _编辑框2_获得焦点, 空白型, , 
获取焦点 ()

.子程序 _时钟1_周期事件, 空白型, , 
.局部变量 小时, 短整数型, , , 
.局部变量 分钟, 短整数型, , , 
.局部变量 秒数, 短整数型, , , 

.如果 (等于 (该走棋, 0))
    赋值 (小时, 到数值 (取文本左边 (., 2)))
    赋值 (分钟, 到数值 (取文本中间 (., 4, 2)))
    赋值 (秒数, 到数值 (取文本右边 (., 2)))
    赋值 (秒数, 相加 (秒数, 1))
    .如果真 (等于 (秒数, 60))
        赋值 (秒数, 0)
        赋值 (分钟, 相加 (分钟, 1))
    .如果真结束
    .如果真 (等于 (分钟, 60))
        赋值 (分钟, 0)
        赋值 (小时, 相加 (小时, 1))
    .如果真结束
    赋值 (., 相加 (选择 (等于 (取文本长度 (到文本 (小时)), 2), 到文本 (小时), 相加 (“0”, 到文本 (小时))), “:”, 选择 (等于 (取文本长度 (到文本 (分钟)), 2), 到文本 (分钟), 相加 (“0”, 到文本 (分钟))), “:”, 选择 (等于 (取文本长度 (到文本 (秒数)), 2), 到文本 (秒数), 相加 (“0”, 到文本 (秒数)))))
.否则
    赋值 (小时, 到数值 (取文本左边 (., 2)))
    赋值 (分钟, 到数值 (取文本中间 (., 4, 2)))
    赋值 (秒数, 到数值 (取文本右边 (., 2)))
    赋值 (秒数, 相加 (秒数, 1))
    .如果真 (等于 (秒数, 60))
        赋值 (秒数, 0)
        赋值 (分钟, 相加 (分钟, 1))
    .如果真结束
    .如果真 (等于 (分钟, 60))
        赋值 (分钟, 0)
        赋值 (小时, 相加 (小时, 1))
    .如果真结束
    赋值 (., 相加 (选择 (等于 (取文本长度 (到文本 (小时)), 2), 到文本 (小时), 相加 (“0”, 到文本 (小时))), “:”, 选择 (等于 (取文本长度 (到文本 (分钟)), 2), 到文本 (分钟), 相加 (“0”, 到文本 (分钟))), “:”, 选择 (等于 (取文本长度 (到文本 (秒数)), 2), 到文本 (秒数), 相加 (“0”, 到文本 (秒数)))))
.如果结束


.子程序 _暂停_被选择, 空白型, , 
.如果 (等于 (., “暂停”))
    赋值 (., 0)
    赋值 (., “继续”)
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., 真)
.否则
    赋值 (., 1000)
    赋值 (., “暂停”)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
.如果结束


.子程序 _结束_被选择, 空白型, , 
.如果真 (等于 (信息框 (“本局棋尚未分出胜负，真的要结束当前棋局吗？”, 相加 (#询问图标, #确认取消钮), “结束棋局：”), #确认钮))
    赋值 (., 0)
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., “棋局被终止！”)
    赋值 (., “暂停”)
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., 假)
.如果真结束


.子程序 _退出_被选择, 空白型, , 
全部关闭 ()
结束 ()

.子程序 _关于_被选择, 空白型, , 
载入 (关于窗口, , 真)

.子程序 _帮助_被选择, 空白型, , 
信息框 (相加 (“易语言之中国象棋：”, #换行符, #换行符, “    走棋方法：点击要走的棋子中央，该棋子四周将凸起，然后点击要走到的位置，即可移动棋子。”, #换行符, “    行棋规则：遵循中国象棋所有行棋规则。”, #换行符, “    排局方法：在棋子上点击鼠标右键可隐藏棋子；点击鼠标左键可选定要移动的棋子，再点击棋盘可移动所选棋子。排局时，棋子移动不遵循中国象棋行棋规则。按菜单项[排局完成]可结束排局并进入对战状态。”, #换行符, #换行符, “    下一版本将提供专门的帮助文件。谢谢使用！”, #换行符, 取空白文本 (62), “二○○一年四月”), 0, “使用帮助”)

.子程序 _悔棋_被选择, 空白型, , 
.局部变量 棋子, 外形框, , , 
.局部变量 标签, 标签, , , 
.局部变量 纵1, 整数型, , , 
.局部变量 横1, 整数型, , , 
.局部变量 纵2, 整数型, , , 
.局部变量 横2, 整数型, , , 

到尾记录 ()
.如果真 (等于 (按住, 真))
    赋值 (被选棋子., 1)
.如果真结束
.如果真 (不等于 (读 (5), “”))
    赋值 (标签, 取标记组件 (到数值 (读 (5))))
    赋值 (棋子, 取标记组件 (到数值 (相加 (“9”, 读 (5)))))
    赋值 (纵1, 到数值 (选择 (等于 (取文本长度 (标签.), 2), 取文本左边 (标签., 1), 取文本左边 (标签., 2))))
    赋值 (横1, 到数值 (取文本右边 (标签., 1)))
    赋值 (纵2, 到数值 (选择 (等于 (取文本长度 (读 (4)), 2), 取文本左边 (读 (4), 1), 取文本左边 (读 (4), 2))))
    赋值 (横2, 到数值 (取文本右边 (读 (4), 1)))
    棋子.移动 (相减 (相加 (相乘 (相减 (横2, 1), 40), 20), 18), 相减 (相加 (相乘 (相减 (纵2, 1), 40), 20), 18), , )
    赋值 (标签., 读 (4))
    赋值 (棋子., 相加 (“9”, 标签.))
    赋值 (有棋子 [纵1] [横1], 假)
    赋值 (有棋子 [纵2] [横2], 真)
    .如果真 (不等于 (读 (6), “”))
        赋值 (标签, 取标记组件 (到数值 (读 (6))))
        赋值 (棋子, 取标记组件 (到数值 (相加 (“9”, 读 (6)))))
        赋值 (纵1, 到数值 (选择 (等于 (取文本长度 (标签.), 2), 取文本左边 (标签., 1), 取文本左边 (标签., 2))))
        赋值 (横1, 到数值 (取文本右边 (标签., 1)))
        赋值 (纵2, 到数值 (选择 (等于 (取文本长度 (读 (5)), 2), 取文本左边 (读 (5), 1), 取文本左边 (读 (5), 2))))
        赋值 (横2, 到数值 (取文本右边 (读 (5), 1)))
        棋子.移动 (相减 (相加 (相乘 (相减 (横2, 1), 40), 20), 18), 相减 (相加 (相乘 (相减 (纵2, 1), 40), 20), 18), , )
        赋值 (标签., 读 (5))
        赋值 (棋子., 相加 (“9”, 标签.))
        赋值 (有棋子 [纵2] [横2], 真)
    .如果真结束
    相减 (取项目数 (), 1).删除项目 ()
.如果真结束
赋值 (标签, 取标记组件 (到数值 (读 (2))))
赋值 (棋子, 取标记组件 (到数值 (相加 (“9”, 读 (2)))))
赋值 (纵1, 到数值 (选择 (等于 (取文本长度 (标签.), 2), 取文本左边 (标签., 1), 取文本左边 (标签., 2))))
赋值 (横1, 到数值 (取文本右边 (标签., 1)))
赋值 (纵2, 到数值 (选择 (等于 (取文本长度 (读 (1)), 2), 取文本左边 (读 (1), 1), 取文本左边 (读 (1), 2))))
赋值 (横2, 到数值 (取文本右边 (读 (1), 1)))
棋子.移动 (相减 (相加 (相乘 (相减 (横2, 1), 40), 20), 18), 相减 (相加 (相乘 (相减 (纵2, 1), 40), 20), 18), , )
赋值 (标签., 读 (1))
赋值 (棋子., 相加 (“9”, 标签.))
赋值 (有棋子 [纵1] [横1], 假)
赋值 (有棋子 [纵2] [横2], 真)
.如果真 (不等于 (读 (3), “”))
    赋值 (标签, 取标记组件 (到数值 (读 (3))))
    赋值 (棋子, 取标记组件 (到数值 (相加 (“9”, 读 (3)))))
    赋值 (纵1, 到数值 (选择 (等于 (取文本长度 (标签.), 2), 取文本左边 (标签., 1), 取文本左边 (标签., 2))))
    赋值 (横1, 到数值 (取文本右边 (标签., 1)))
    赋值 (纵2, 到数值 (选择 (等于 (取文本长度 (读 (2)), 2), 取文本左边 (读 (2), 1), 取文本左边 (读 (2), 2))))
    赋值 (横2, 到数值 (取文本右边 (读 (2), 1)))
    棋子.移动 (相减 (相加 (相乘 (相减 (横2, 1), 40), 20), 18), 相减 (相加 (相乘 (相减 (纵2, 1), 40), 20), 18), , )
    赋值 (标签., 读 (2))
    赋值 (棋子., 相加 (“9”, 标签.))
    赋值 (有棋子 [纵2] [横2], 真)
.如果真结束
删除 ()
彻底删除 ()
相减 (取项目数 (), 1).删除项目 ()
赋值 (., 相减 (取项目数 (), 1))
.如果真 (等于 (取记录数 (), 6))
    赋值 (., 真)
.如果真结束
赋值 (按住, 假)
赋值 (该走棋, 658108)
赋值 (., 该走棋)
赋值 (., “ 该红棋走！”)

.子程序 _认输_被选择, 空白型, , 
.如果 (等于 (该走棋, 0))
    赋值 (., 该走棋)
    赋值 (., “ 黑棋认输，红棋赢！”)
.否则
    赋值 (., 该走棋)
    赋值 (., “ 红棋认输，黑棋赢！”)
.如果结束
赋值 (., 0)
赋值 (赢棋方, 选择 (等于 (该走棋, 0), 658108, 0))
鸣叫 ()
载入 (赢棋窗口, , 真)
赋值 (., 真)
赋值 (., 真)
赋值 (., 真)
赋值 (., 真)
赋值 (., 真)
赋值 (., 假)

.子程序 _复盘_被选择, 空白型, , 
.如果 (大于 (取记录数 (), 6))
    跳到 (7)
    .如果真 (不等于 (读 (2), “”))
        跳到 (1)
        清空 ()
        赋值 (行棋步数, 0)
        摆棋 ()
        赋值 (., 真)
        赋值 (., 真)
        赋值 (., 真)
        赋值 (., 真)
        赋值 (., “开始”)
        赋值 (复盘步数, 6)
        赋值 (., 真)
        赋值 (., 真)
        赋值 (., 真)
        赋值 (., 真)
    .如果真结束
    
.否则
    信息框 (“行棋记录已删除或尚未走棋！”, 0, )
.如果结束


.子程序 _单步按钮_被单击, 空白型, , 
赋值 (., 假)
赋值 (复盘步数, 相加 (复盘步数, 1))
跳到 (复盘步数)
未知函数_67175283 (600)
赋值 (., 真)
.如果真 (等于 (., 真))
    .如果真 (大于 (复盘步数, 0))
        赋值 (., “继续”)
    .如果真结束
    .如果真 (等于 (复盘步数, 取记录数 ()))
        赋值 (., 假)
        赋值 (., 假)
        赋值 (., 假)
        赋值 (., 假)
        赋值 (., 假)
        赋值 (., 假)
        赋值 (., 假)
    .如果真结束
    
.如果真结束


.子程序 _终止按钮_被单击, 空白型, , 
.如果真 (等于 (信息框 (“棋局复盘尚未完成，现在终止，将丢失本步以后的行棋步骤，确定要终止吗？”, #确认取消钮, “复盘结束：”), #确认钮))
    跳到 (相加 (复盘步数, 1))
    .判断循环首 (等于 (尾记录后 (), 假))
        删除 ()
        跳过 (1)
    .判断循环尾 ()
    彻底删除 ()
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
.如果真结束


.子程序 _最后按钮_被单击, 空白型, , 
赋值 (复盘步数, 相加 (复盘步数, 1))
跳到 (复盘步数)
.判断循环首 (等于 (尾记录后 (), 假))
    未知函数_67175283 (10)
    跳过 (1)
.判断循环尾 ()
跳过 (-1)
赋值 (., 假)
赋值 (., 假)
赋值 (., 假)
赋值 (., 假)
赋值 (., 假)
赋值 (., 假)
赋值 (., 假)

.子程序 复盘, 空白型, , 
.参数 时间, 整数型, , 

.局部变量 红标签, 标签, , , 
.局部变量 黑被吃标签, 标签, , , 
.局部变量 黑标签, 标签, , , 
.局部变量 红被吃标签, 标签, , , 
.局部变量 红棋, 外形框, , , 
.局部变量 黑被吃棋, 外形框, , , 
.局部变量 黑棋, 外形框, , , 
.局部变量 红被吃棋, 外形框, , , 
.局部变量 纵1, 整数型, , , 
.局部变量 纵2, 整数型, , , 
.局部变量 横1, 整数型, , , 
.局部变量 横2, 整数型, , , 

.如果真 (并且 (不等于 (读 (1), “”), 不等于 (读 (2), “”)))
    延时 (时间)
    赋值 (取标记组件 (到数值 (读 (1))))
    赋值 (取标记组件 (到数值 (相加 (“9”, 读 (1)))))
    .如果真 (不等于 (读 (3), “”))
        赋值 (取标记组件 (到数值 (读 (2))))
        赋值 (取标记组件 (到数值 (相加 (“9”, 读 (2)))))
    .如果真结束
    赋值 (到数值 (选择 (等于 (取文本长度 (读 (1)), 2), 取文本左边 (读 (1), 1), 取文本左边 (读 (1), 2))))
    赋值 (到数值 (取文本右边 (读 (1), 1)))
    赋值 (到数值 (选择 (等于 (取文本长度 (读 (2)), 2), 取文本左边 (读 (2), 1), 取文本左边 (读 (2), 2))))
    赋值 (到数值 (取文本右边 (读 (2), 1)))
    相减 (相加 (相乘 (相减 (1), 40), 20), 18).移动 (相减 (相加 (相乘 (相减 (1), 40), 20), 18), , )
    .如果真 (不等于 (读 (3), “”))
        500.移动 ()
        赋值 (., 读 (3))
        赋值 (., 相加 (“9”, 读 (3)))
    .如果真结束
    赋值 (., 读 (2))
    赋值 (., 相加 (“9”, 读 (2)))
    赋值 (有棋子 [ [假]])
    赋值 (有棋子 [ [真]])
    赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
    赋值 (., 该走棋)
    赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
    刷新显示 ()
    行棋步骤名 (红标签., 纵1, 横1, 纵2, 横2)
.如果真结束
.如果真 (并且 (不等于 (读 (4), “”), 不等于 (读 (5), “”)))
    延时 ()
    赋值 (取标记组件 (到数值 (读 (4))))
    赋值 (取标记组件 (到数值 (相加 (“9”, 读 (4)))))
    .如果真 (不等于 (读 (6), “”))
        赋值 (取标记组件 (到数值 (读 (5))))
        赋值 (取标记组件 (到数值 (相加 (“9”, 读 (5)))))
    .如果真结束
    赋值 (到数值 (选择 (等于 (取文本长度 (读 (4)), 2), 取文本左边 (读 (4), 1), 取文本左边 (读 (4), 2))))
    赋值 (到数值 (取文本右边 (读 (4), 1)))
    赋值 (到数值 (选择 (等于 (取文本长度 (读 (5)), 2), 取文本左边 (读 (5), 1), 取文本左边 (读 (5), 2))))
    赋值 (到数值 (取文本右边 (读 (5), 1)))
    相减 (相加 (相乘 (相减 (1), 40), 20), 18).移动 (相减 (相加 (相乘 (相减 (1), 40), 20), 18), , )
    .如果真 (不等于 (读 (6), “”))
        400.移动 ()
        赋值 (., 读 (6))
        赋值 (., 相加 (“9”, 读 (6)))
    .如果真结束
    赋值 (., 读 (5))
    赋值 (., 相加 (“9”, 读 (5)))
    赋值 (有棋子 [ [假]])
    赋值 (有棋子 [ [真]])
    赋值 (该走棋, 选择 (等于 (该走棋, 0), 658108, 0))
    赋值 (., 该走棋)
    赋值 (., 选择 (等于 (该走棋, 0), “ 该黑棋走！”, “ 该红棋走！”))
    刷新显示 ()
    行棋步骤名 (黑标签., 纵1, 横1, 纵2, 横2)
.如果真结束
赋值 (按住, 假)

.子程序 _人机大战_被选择, 空白型, , 
信息框 (“尚未加入算法，敬请高手指点！这里谢谢先。”, 0, “关于人机大战”)

.子程序 _双人对战_被选择, 空白型, , 
赋值 (., 真)

.子程序 _读取_被选择, 空白型, , 
赋值 (存盘读盘, “读盘”)
载入 (存盘窗口, , 真)
_复盘_被选择 ()
赋值 (., 假)
刷新显示 ()
_最后按钮_被单击 ()


.子程序 __启动窗口_将被销毁, 空白型, , 
全部关闭 ()

.子程序 _排局_被选择, 空白型, , 
清空 ()
赋值 (行棋步数, 0)
未知函数_67175187 ()
赋值 (., 真)
赋值 (., 真)
赋值 (., 真)
赋值 (., 真)
赋值 (., 真)
赋值 (., 真)
赋值 (., 真)
赋值 (., 真)
赋值 (., 真)
赋值 (排局状态, 真)

.子程序 _标签1_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (排局状态, 真))
    赋值 (被选标签, 取事件组件 ())
    赋值 (被选棋子, 取标记组件 (到数值 (相加 (“9”, .))))
    .如果真 (并且 (不等于 (被选标签., “将”), 不等于 (被选标签., “帅”)))
        被选棋子.移动 (400, , , )
        赋值 (标记纵, 选择 (等于 (取文本长度 (被选标签.), 3), 到数值 (取文本左边 (被选标签., 2)), 到数值 (取文本左边 (被选标签., 1))))
        赋值 (标记横, 到数值 (取文本右边 (被选标签., 1)))
        赋值 (有棋子 [标记纵] [标记横], 假)
        赋值 (被选标签., 相加 (“88”, 被选标签.))
        赋值 (被选棋子., 相加 (“9”, 被选标签.))
    .如果真结束
    
.如果真结束


.子程序 _排局完成_被选择, 空白型, , 
赋值 (排局状态, 假)
赋值 (., 假)
赋值 (., 假)
赋值 (., 假)
赋值 (., 假)
赋值 (., 假)
赋值 (., 假)
赋值 (., 假)
赋值 (., 假)
清空 ()
加空记录 ()
替换 (取字段名 (1), ., 取字段名 (2), ., 取字段名 (3), ., 取字段名 (4), ., 取字段名 (5), ., 取字段名 (6), .)
加空记录 ()
替换 (取字段名 (1), ., 取字段名 (2), ., 取字段名 (3), ., 取字段名 (4), ., 取字段名 (5), ., 取字段名 (6), .)
加空记录 ()
替换 (取字段名 (1), ., 取字段名 (2), ., 取字段名 (3), ., 取字段名 (4), ., 取字段名 (5), ., 取字段名 (6), .)
加空记录 ()
替换 (取字段名 (1), ., 取字段名 (2), ., 取字段名 (3), ., 取字段名 (4), ., 取字段名 (5), ., 取字段名 (6), .)
加空记录 ()
替换 (取字段名 (1), ., 取字段名 (2), ., 取字段名 (3), ., 取字段名 (4), ., 取字段名 (5), ., 取字段名 (6), .)
加空记录 ()
替换 (取字段名 (1), ., 取字段名 (2), .)

.子程序 行棋步骤名, 文本型, , 
.参数 棋子名, 文本型, , 
.参数 行棋前纵值, 整数型, , 
.参数 行棋前横值, 整数型, , 
.参数 行棋后纵值, 整数型, , 
.参数 行棋后横值, 整数型, , 

.局部变量 棋子横向位置, 文本型, , , 
.局部变量 棋子横向移动, 文本型, , , 
.局部变量 棋子纵向移动, 文本型, , , 
.局部变量 纵向值容器, 整数型, , , 
.局部变量 同列棋子, 标签, , , 
.局部变量 步骤名, 文本型, , , 

.如果 (等于 (该走棋, 0))
    赋值 (棋子横向位置, 相加 (棋子名, 数值到大写 (相减 (10, 行棋前横值), 真)))
    赋值 (棋子横向移动, 相加 (“平”, 数值到大写 (相减 (10, 行棋后横值), 真)))
    .如果 (或者 (等于 (棋子名, “车”), 等于 (棋子名, “炮”), 等于 (棋子名, “兵”), 等于 (棋子名, “卒”)))
        赋值 (棋子纵向移动, 相加 (选择 (大于 (行棋前纵值, 行棋后纵值), “进”, “退”), 数值到大写 (取绝对值 (相减 (行棋前纵值, 行棋后纵值)), 真)))
    .否则
        赋值 (棋子纵向移动, 相加 (选择 (大于 (行棋前纵值, 行棋后纵值), “进”, “退”), 数值到大写 (相减 (10, 行棋后横值), 真)))
    .如果结束
    
.否则
    赋值 (棋子横向位置, 相加 (棋子名, “ ”, 到文本 (行棋前横值)))
    赋值 (棋子横向移动, 相加 (“平 ”, 到文本 (行棋后横值)))
    .如果 (或者 (等于 (棋子名, “车”), 等于 (棋子名, “炮”), 等于 (棋子名, “兵”), 等于 (棋子名, “卒”)))
        赋值 (棋子纵向移动, 相加 (选择 (小于 (行棋前纵值, 行棋后纵值), “进 ”, “退 ”), 到文本 (取绝对值 (相减 (行棋前纵值, 行棋后纵值)))))
    .否则
        赋值 (棋子纵向移动, 相加 (选择 (小于 (行棋前纵值, 行棋后纵值), “进 ”, “退 ”), 到文本 (行棋后横值)))
    .如果结束
    
.如果结束
.如果真 (并且 (不等于 (棋子名, “士”), 不等于 (棋子名, “仕”)))
    .变量循环首 (1, 10, 1, 纵向值容器)
        .如果真 (并且 (不等于 (纵向值容器, 行棋前纵值), 不等于 (纵向值容器, 行棋后纵值)))
            .如果真 (等于 (有棋子 [纵向值容器] [行棋前横值], 真))
                赋值 (同列棋子, 取标记组件 (到数值 (相加 (到文本 (纵向值容器), 到文本 (行棋前横值)))))
                .如果真 (并且 (不等于 (同列棋子., 该走棋), 等于 (同列棋子., 棋子名)))
                    .如果 (等于 (该走棋, 0))
                        赋值 (棋子横向位置, 相加 (选择 (大于 (纵向值容器, 行棋前纵值), “前”, “后”), 棋子名))
                    .否则
                        赋值 (棋子横向位置, 相加 (选择 (小于 (纵向值容器, 行棋前纵值), “前”, “后”), 棋子名))
                    .如果结束
                    跳出循环 ()
                .如果真结束
                
            .如果真结束
            
        .如果真结束
        
    .变量循环尾 ()
.如果真结束
.如果 (等于 (行棋前纵值, 行棋后纵值))
    .如果 (等于 (该走棋, 0))
        赋值 (相加 (1))
        赋值 (步骤名, 相加 (到文本 (行棋步数), “. ”, 棋子横向位置, 棋子横向移动))
    .否则
        赋值 (步骤名, 相加 (取空白文本 (取文本长度 (相加 (到文本 (行棋步数), “. ”))), 棋子横向位置, 棋子横向移动))
    .如果结束
    
.否则
    .如果 (等于 (该走棋, 0))
        赋值 (行棋步数, 相加 (行棋步数, 1))
        赋值 (步骤名, 相加 (到文本 (), “. ”, 棋子横向位置, 棋子纵向移动))
    .否则
        赋值 (步骤名, 相加 (取空白文本 (取文本长度 (相加 (到文本 (行棋步数), “. ”))), 棋子横向位置, 棋子纵向移动))
    .如果结束
    
.如果结束
步骤名.加入项目 ()
.如果真 (大于 (取项目数 (), 15))
    记录列表框.置顶端可见项目 (记录列表框.取项目数 () － 15 )
.如果真结束
赋值 (., 相减 (取项目数 (), 1))
返回 (“”)

.子程序 摆棋, 空白型, , 
.变量循环首 (1, 10, 1, 纵)
    .变量循环首 (1, 9, 1, 横)
        赋值 (有棋子 [纵] [横], 假)
    .变量循环尾 ()
.变量循环尾 ()
跳到 (1)
赋值 (., 到文本 (读 (1)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (1)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (1)), 3), 到数值 (取文本左边 (读 (1), 2)), 到数值 (取文本左边 (读 (1), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (1), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (2)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (2)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (2)), 3), 到数值 (取文本左边 (读 (2), 2)), 到数值 (取文本左边 (读 (2), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (2), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (3)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (3)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (3)), 3), 到数值 (取文本左边 (读 (3), 2)), 到数值 (取文本左边 (读 (3), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (3), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (4)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (4)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (4)), 3), 到数值 (取文本左边 (读 (4), 2)), 到数值 (取文本左边 (读 (4), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (4), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (5)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (5)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (5)), 3), 到数值 (取文本左边 (读 (5), 2)), 到数值 (取文本左边 (读 (5), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (5), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (6)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (6)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (6)), 3), 到数值 (取文本左边 (读 (6), 2)), 到数值 (取文本左边 (读 (6), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (6), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
跳过 (1)
赋值 (., 到文本 (读 (1)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (1)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (1)), 3), 到数值 (取文本左边 (读 (1), 2)), 到数值 (取文本左边 (读 (1), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (1), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (2)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (2)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (2)), 3), 到数值 (取文本左边 (读 (2), 2)), 到数值 (取文本左边 (读 (2), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (2), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (3)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (3)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (3)), 3), 到数值 (取文本左边 (读 (3), 2)), 到数值 (取文本左边 (读 (3), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (3), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (4)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (4)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (4)), 3), 到数值 (取文本左边 (读 (4), 2)), 到数值 (取文本左边 (读 (4), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (4), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (5)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (5)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (5)), 3), 到数值 (取文本左边 (读 (5), 2)), 到数值 (取文本左边 (读 (5), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (5), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (6)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (6)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (6)), 3), 到数值 (取文本左边 (读 (6), 2)), 到数值 (取文本左边 (读 (6), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (6), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
跳过 (1)
赋值 (., 到文本 (读 (1)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (1)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (1)), 3), 到数值 (取文本左边 (读 (1), 2)), 到数值 (取文本左边 (读 (1), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (1), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (2)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (2)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (2)), 3), 到数值 (取文本左边 (读 (2), 2)), 到数值 (取文本左边 (读 (2), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (2), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (3)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (3)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (3)), 3), 到数值 (取文本左边 (读 (3), 2)), 到数值 (取文本左边 (读 (3), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (3), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (4)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (4)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (4)), 3), 到数值 (取文本左边 (读 (4), 2)), 到数值 (取文本左边 (读 (4), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (4), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (5)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (5)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (5)), 3), 到数值 (取文本左边 (读 (5), 2)), 到数值 (取文本左边 (读 (5), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (5), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (6)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (6)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (6)), 3), 到数值 (取文本左边 (读 (6), 2)), 到数值 (取文本左边 (读 (6), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (6), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
跳过 (1)
赋值 (., 到文本 (读 (1)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (1)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (1)), 3), 到数值 (取文本左边 (读 (1), 2)), 到数值 (取文本左边 (读 (1), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (1), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (2)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (2)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (2)), 3), 到数值 (取文本左边 (读 (2), 2)), 到数值 (取文本左边 (读 (2), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (2), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (3)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (3)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (3)), 3), 到数值 (取文本左边 (读 (3), 2)), 到数值 (取文本左边 (读 (3), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (3), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (4)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (4)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (4)), 3), 到数值 (取文本左边 (读 (4), 2)), 到数值 (取文本左边 (读 (4), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (4), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (5)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (5)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (5)), 3), 到数值 (取文本左边 (读 (5), 2)), 到数值 (取文本左边 (读 (5), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (5), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (6)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (6)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (6)), 3), 到数值 (取文本左边 (读 (6), 2)), 到数值 (取文本左边 (读 (6), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (6), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
跳过 (1)
赋值 (., 到文本 (读 (1)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (1)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (1)), 3), 到数值 (取文本左边 (读 (1), 2)), 到数值 (取文本左边 (读 (1), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (1), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (2)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (2)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (2)), 3), 到数值 (取文本左边 (读 (2), 2)), 到数值 (取文本左边 (读 (2), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (2), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (3)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (3)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (3)), 3), 到数值 (取文本左边 (读 (3), 2)), 到数值 (取文本左边 (读 (3), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (3), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (4)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (4)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (4)), 3), 到数值 (取文本左边 (读 (4), 2)), 到数值 (取文本左边 (读 (4), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (4), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (5)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (5)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (5)), 3), 到数值 (取文本左边 (读 (5), 2)), 到数值 (取文本左边 (读 (5), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (5), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (6)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (6)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (6)), 3), 到数值 (取文本左边 (读 (6), 2)), 到数值 (取文本左边 (读 (6), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (6), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
跳过 (1)
赋值 (., 到文本 (读 (1)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (1)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (1)), 3), 到数值 (取文本左边 (读 (1), 2)), 到数值 (取文本左边 (读 (1), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (1), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (., 到文本 (读 (2)))
赋值 (., 相加 (“9”, .))
400.移动 ()
.如果真 (小于或等于 (取文本长度 (读 (2)), 3))
    赋值 (纵, 选择 (等于 (取文本长度 (读 (2)), 3), 到数值 (取文本左边 (读 (2), 2)), 到数值 (取文本左边 (读 (2), 1))))
    赋值 (横, 到数值 (取文本右边 (读 (2), 1)))
    相减 (相乘 (横, 40), 20, 18).移动 (相减 (相乘 (纵, 40), 20, 18), , )
    赋值 (有棋子 [纵] [横], 真)
.如果真结束
赋值 (该走棋, 658108)
赋值 (., 该走棋)
赋值 (., “ 该红棋走！”)

.子程序 _保存棋局_被选择, 空白型, , 
.如果 (大于 (取项目数 (), 0))
    赋值 (存盘读盘, “存盘”)
    载入 (存盘窗口, , 真)
    信息框 (“棋局保存完毕！”, 0, )
.否则
    信息框 (“开玩笑，你还没走棋呢，保存什么呀？”, 0, )
.如果结束


.子程序 _保存文本_被选择, 空白型, , 
.局部变量 项目数, 整数型, , , 
.局部变量 文件号, 整数型, , , 

.如果 (大于 (取项目数 (), 0))
    .如果真 (打开 ())
        赋值 (文件号, 打开文件 (., #重写, ))
        移到文件尾 ()
        写文本行 (“”)
        写文本行 (文件号, “  棋局记录”)
        写文本行 (“”)
        .变量循环首 (1, 取项目数 (), 1, 项目数)
            写文本行 (文件号, 相减 (项目数, 1).取项目文本 ())
        .变量循环尾 ()
        写文本行 (“”)
        写文本行 (文件号, 相加 (“  ”, 时间到文本 (取现行时间 (), #日期部分)))
        关闭文件 (文件号)
        信息框 (“行棋记录已保存！”, 0, )
    .如果真结束
    
.否则
    信息框 (“开玩笑，你还没走棋呢，保存什么呀？”, 0, )
.如果结束


.窗口程序集 窗口程序集2, , , 

.子程序 _赢棋窗口_创建完毕, 空白型, , 
赋值 (., 赢棋方)
赋值 (., 选择 (等于 (赢棋方, 0), “黑棋赢了！”, “ 红棋赢了！”))

.子程序 _赢棋窗口_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.子程序 _标签1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.窗口程序集 窗口程序集3, , , 

.子程序 _关于窗口_创建完毕, 空白型, , 
获取焦点 ()
赋值 (., 相加 (“    易之中国象棋是本人用易语言编写的第四个软件，尽管功能还很简单，界面也很粗糙，但还是决定献给广大喜爱易语言的朋友，以博一笑，并请各位高手指正。”, #换行符, “    在编写本程序的时候，遇到了许多问题，现一一列出，以方便各位朋友理解本人的思路：”, #换行符, #换行符, “一、中国象棋棋子的制作问题。”, #换行符, #换行符, “    易语言未提供圆形的图形框或画板，也不支持图形框或画板的透明功能，所以在制作象棋棋子的时候，颇费了一番脑筋。”, #换行符, “    由于绘出精美的棋子实在太麻烦，所以，本人放弃了棋盘的背景纹理，也舍弃了图形框及画板，而改用外形框中加上标签的方法制作了现在的棋子，这样只要使外形框的背景颜色与棋盘的颜色一样，就可掩盖掉棋子的四个角，使其看上去是圆形的（不过，细心的朋友还是会发现，在[仕]、[士]所占的位置有一段斜线被挡住了，不好意思！）。”, #换行符, #换行符, “二、象棋棋子的定位问题。”, #换行符, #换行符, “    由于不是在画板上直接画出图形，行棋时，棋子的定位也颇伤脑筋。本人最后采用了一个笨办法：画一个每方格为40×40象素的棋盘，棋盘四周每边空为20象素。这样通过对鼠标点击位置或标签标记进行换算，即可得出棋子的位置如[1，1]、[3，2]、[10，9]等。”, #换行符, #换行符, “三、行棋规则问题。”, #换行符, #换行符, “    中国象棋中的车行直路、炮打隔子、象飞田字、马走半田等，同时象有象眼，马有马腿，在程序中都必须体现出来。”, #换行符, “    未动手之前，觉得很难，开始编程后，因为有了前面棋子定位的设定，最后化了不多时间就搞定了。即：移动棋子时，比较棋子原在位置（取标签标记进行换算）与欲到的位置的纵、横座标值，就可判定该棋子能否移动。至于象眼、马腿，则采用逻辑型的数组容器，对棋盘上的10×9个位置一一赋值，有棋子的赋为真，无棋子的赋为假，然后再判断象眼（马腿）位置上有无棋子即可。”, #换行符, #换行符, “四、计时问题。”, #换行符, #换行符, “    由于要分别对红、黑两方进行计时，简单地用系统时间或运行时间来表达，我觉得有点麻烦。所以最后，我放弃了时间，而采用时钟的周期事件（详见程序），但同时也带来一个小问题，就是每个时钟周期里，系统要进行一些简单的运算，可能导致计时的速度比系统时间略慢。求精的朋友请自己改进，简单一点，就是根据自已的系统速度把时钟的周期定为比1000毫秒略小如960毫秒。否则请用另外的思路，有好方法，还望不吝赐教！”, #换行符, #换行符, “五、棋局存盘、复盘、悔棋问题。”, #换行符, #换行符, “    怎样记录每一步棋子的移动及吃子情况？这涉及到能否实现棋局存盘、复盘及悔棋的功能。本人是用棋子标签的标记变化来记录，请运行本程序后用易语言打开数据库CHESS.EDB，观察记录变化情况。”, #换行符, #换行符, “六、系统的智能问题。”, #换行符, #换行符, “    这其实是最重要的，没有系统智能，不能人机对战，我的[易之中国象棋]也就相当于一个半残废。不过本人对这方面实在是十窍通了九窍――还剩一窍不通！只能期待高手对本程序动手术了。如有升级版本，还望各位高手给我一份源程序。”, #换行符, #换行符, “                                 作者：飞雪”, #换行符, “                                 Email：qdww@china.com”, #换行符, “                                 欢迎联系，并请指教。”, #换行符, #换行符, “    另：易语言是除FOX外，本人接触的第二种语言，对Windows的Dll命令、API函数不甚了解，哪位高手能告诉我如何在易程序里为一个外部可执行文件创建快捷方式吗？万分感谢！！！”))

.窗口程序集 窗口程序集4, , , 

.程序集变量 存档号, 文本型, , , 
.子程序 _存盘窗口_创建完毕, 空白型, , 
.如果真 (文件是否存在 (“data1.chs”))
    赋值 (., #蓝色)
.如果真结束
.如果真 (文件是否存在 (“data2.chs”))
    赋值 (., #蓝色)
.如果真结束
.如果真 (文件是否存在 (“data3.chs”))
    赋值 (., #蓝色)
.如果真结束
.如果真 (文件是否存在 (“data4.chs”))
    赋值 (., #蓝色)
.如果真结束
.如果真 (文件是否存在 (“data5.chs”))
    赋值 (., #蓝色)
.如果真结束
.如果真 (文件是否存在 (“data6.chs”))
    赋值 (., #蓝色)
.如果真结束
.如果真 (文件是否存在 (“data7.chs”))
    赋值 (., #蓝色)
.如果真结束
.如果真 (文件是否存在 (“data8.chs”))
    赋值 (., #蓝色)
.如果真结束
.如果真 (文件是否存在 (“data9.chs”))
    赋值 (., #蓝色)
.如果真结束
.如果真 (文件是否存在 (“data10.chs”))
    赋值 (., #蓝色)
.如果真结束
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()

.子程序 _单选框1_被单击, 空白型, , 
.局部变量 单选框, 单选框, , , 

赋值 (单选框, 取事件组件 ())
赋值 (存档号, 单选框.)

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 存盘文件, 文本型, , , 




 ' 不属于任何一个程序集、类模块的函数：
