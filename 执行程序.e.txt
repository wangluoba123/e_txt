 ' 文件类型：Windows窗口程序

 ' 程序名称：粮食收购转卖
 ' 程序描述：陈凯、席伟、叶伟
@备注:
陈凯、席伟、叶伟
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 415
    高度 = 232
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “粮食收购转卖 v1.0”
    帮助文件名 = “”

窗口 主窗口
    左边 = 50
    顶边 = 50
    宽度 = 797
    高度 = 524
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “粮食收购转卖 v1.0”
    帮助文件名 = “”

窗口 添加收购窗口
    左边 = 8
    顶边 = 8
    宽度 = 521
    高度 = 254
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “添加收购单”
    帮助文件名 = “”

窗口 修改收购窗口
    左边 = 8
    顶边 = 8
    宽度 = 652
    高度 = 226
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “收购清单”
    帮助文件名 = “”

窗口 统计收购窗口
    左边 = 8
    顶边 = 8
    宽度 = 285
    高度 = 441
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “统计收购报表”
    帮助文件名 = “”

窗口 种类窗口
    左边 = 50
    顶边 = 50
    宽度 = 249
    高度 = 385
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “种类配置”
    帮助文件名 = “”

窗口 价格曲线窗口
    左边 = 0
    顶边 = 0
    宽度 = 460
    高度 = 358
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 0 '  0x0
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “价格曲线”
    帮助文件名 = “”

窗口 添加转卖窗口
    左边 = 8
    顶边 = 8
    宽度 = 521
    高度 = 254
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “添加转卖单”
    帮助文件名 = “”

窗口 修改转卖窗口
    左边 = 8
    顶边 = 8
    宽度 = 652
    高度 = 226
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “转卖清单”
    帮助文件名 = “”

窗口 统计转卖窗口
    左边 = 8
    顶边 = 8
    宽度 = 285
    高度 = 441
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “统计收购报表”
    帮助文件名 = “”

窗口 系统设置窗口
    左边 = 0
    顶边 = 0
    宽度 = 455
    高度 = 388
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 12632256 '  0xC0C0C0
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “系统设置”
    帮助文件名 = “”

窗口 数据维护窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 205
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 6
    底图方式 = 1
    底色 = 12632256 '  0xC0C0C0
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 3 0 扩展界面支持库三
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 2 8 高级表格支持库
 ' eDB 46E94341933A462383A4DE26B146322C 2 7 数据库操作支持库
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 2 0 XP风格界面库
 ' CnCalendar {18C0788E-59AE-4112-B452-6BF0C1B727FB} 2 0 农历日期支持库
 ' EChartBar 9A3F84D7FDEB4a0486F2711D5104B7F7 2 0 数据图表支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 2 0 扩展界面支持库二
 ' eCompress 7B68736E818E41c5A28B0AE4D43C128C 2 0 压缩解压支持库



 ' 所需要的模块
 ' MDI模块 C:\Documents and Settings\Administrator\桌面\粮食收购转卖\MDI模块.ec


数据类型 _日期, , 
    .成员 _年, 文本型, , , 
    .成员 _月, 文本型, , , 
    .成员 _日, 文本型, , , 
    .成员 _星期, 文本型, , , 

.全局变量 全_用户名, 文本型, , , 

.窗口程序集 _启动窗口程序集, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 i, 整数型, , , 

赋值 (.图片, 读入文件 (相加 (取运行目录 (), “\back.gif”)))
.如果真 (等于 (打开 (相加 (取运行目录 (), “\登陆用户.dll”), “userdb”, , , , “yamwfnso”, ), 假))
    信息框 (“程序内部错误，无法打开数据库！请重新启动本软件。”, #错误图标, “失败：”)
    销毁 ()
    结束 ()
.如果真结束
到首记录 ()
' 本源码来自易语言资源网(www.5A5X.com)
.计次循环首 (取记录数 (), i)
    读 (“用户名”).加入项目 (i)
    跳过 ()
.计次循环尾 ()
赋值 (.现行选中项, 0)
关闭 (“userdb”)

.子程序 _组合框1_列表项被选择, 空白型, , 
获取焦点 ()

.子程序 _登陆_按钮_被单击, 空白型, , 
.判断开始 (等于 (.内容, “”))
    获取焦点 ()
.判断 (等于 (验证密码 (.内容), 假))
    信息框 (“您输入的密码不正确，请重新输入！”, #信息图标, “提示：”)
    获取焦点 ()
    赋值 (.被选择字符数, -1)
.默认
    .如果真 (等于 (载入 (主窗口, , 假), 真))
        _启动窗口.销毁 ()
    .如果真结束
     ' 本源码来自易语言资源网(www.5A5X.com)
.判断结束


.子程序 验证密码, 逻辑型, , 
.参数 输入密码, 文本型, , 

.局部变量 结果, 逻辑型, , , 

.如果真 (等于 (打开 (相加 (取运行目录 (), “\登陆用户.dll”), “userdb”, , , , “yamwfnso”, ), 假))
    信息框 (“程序内部错误，无法打开数据库！请重新启动本软件。”, #错误图标, “失败：”)
    销毁 ()
    结束 ()
.如果真结束
到首记录 ()
.如果真 (等于 (查找 (等于 (读 (“用户名”), .取项目文本 (.现行选中项))), 真))
    .判断开始 (等于 (读 (“密码”), 输入密码))
        赋值 (全_用户名, .取项目文本 (.现行选中项))
        赋值 (结果, 真)
    .默认
        赋值 (结果, 假)
    .判断结束
    
.如果真结束
关闭 (“userdb”)
返回 (结果)

.子程序 _编辑框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, 13))
    _登陆_按钮_被单击 ()
.如果真结束


.窗口程序集 主窗口_程序集, , , 

.程序集变量 配置文件, 文本型, , , 
.子程序 _主窗口_创建完毕, 空白型, , 
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

赋值 (., 读入文件 (相加 (取运行目录 (), “\图标库.dll”)))
赋值 (配置文件, 相加 (取运行目录 (), “\配置.ini”))
赋值 (.图片, 读入文件 (相加 (取运行目录 (), “\MDI_back.jpg”)))
初始化数据库 ()

.子程序 初始化数据库, 空白型, , 
.局部变量 皮肤, 整数型, , , 

赋值 (皮肤, 到数值 (读配置项 (配置文件, “config”, “skin”, )))
1.置文本 (全_用户名)
.如果真 (不等于 (皮肤, 0))
    未知支持库函数_0 (皮肤)
.如果真结束
.如果真 (等于 (相加 (取运行目录 (), “\数据库.mdb”).未知支持库函数_1 (“yamwfnmaster”), 假))
    信息框 (“程序错误，无法打开数据库。请联系管理员！”, #错误图标, “失败：”)
    销毁 ()
    结束 ()
.如果真结束
.未知支持库函数_12 ()

.子程序 _主窗口_尺寸被改变, 空白型, , 
赋值 (., 相减 (取用户区高度 (), ., ., 2))
赋值 (.高度, .)
赋值 (.宽度, 相减 (取用户区宽度 (), .左边, 3))

.子程序 _卷帘式菜单1_项目被选择, 空白型, , 
.参数 菜单索引, 整数型, , 
.参数 项目索引, 整数型, , 

.判断开始 (等于 (菜单索引, 0))
    .判断开始 (等于 (项目索引, 0))
        .如果真 (等于 (是否已创建 (添加收购窗口), 假))
            载入 (添加收购窗口, 主窗口, 假)
        .如果真结束
        MDI窗口调整 (添加收购窗口, , 假)
    .判断 (等于 (项目索引, 1))
        .如果真 (等于 (是否已创建 (修改收购窗口), 假))
            载入 (修改收购窗口, 主窗口, 假)
        .如果真结束
        MDI窗口调整 (修改收购窗口, , 假)
    .判断 (等于 (项目索引, 2))
        .如果真 (等于 (是否已创建 (统计收购窗口), 假))
            载入 (统计收购窗口, 主窗口, 假)
        .如果真结束
        MDI窗口调整 (统计收购窗口, , 假)
    .默认
         ' 本源码来自易语言资源网(www.5A5X.com)
    .判断结束
    
.判断 (等于 (菜单索引, 1))
    .判断开始 (等于 (项目索引, 0))
        .如果真 (等于 (是否已创建 (添加转卖窗口), 假))
            载入 (添加转卖窗口, 主窗口, 假)
        .如果真结束
        MDI窗口调整 (添加转卖窗口, , 假)
    .判断 (等于 (项目索引, 1))
        .如果真 (等于 (是否已创建 (修改转卖窗口), 假))
            载入 (修改转卖窗口, 主窗口, 假)
        .如果真结束
        MDI窗口调整 (修改转卖窗口, , 假)
    .判断 (等于 (项目索引, 2))
        .如果真 (等于 (是否已创建 (统计转卖窗口), 假))
            载入 (统计转卖窗口, 主窗口, 假)
        .如果真结束
        MDI窗口调整 (统计转卖窗口, , 假)
    .默认
        ' 本源码来自易语言资源网(www.5A5X.com)
    .判断结束
    
.判断 (等于 (菜单索引, 2))
    信息框 (“功能开发中……”, #信息图标, “提示：”)
.判断 (等于 (菜单索引, 3))
    .判断开始 (等于 (项目索引, 0))
        运行 (“calc.exe”, 假, )
    .判断 (等于 (项目索引, 1))
        运行 (“notepad.exe”, 假, )
    .判断 (等于 (项目索引, 2))
        .如果真 (等于 (是否已创建 (系统设置窗口), 假))
            载入 (系统设置窗口, 主窗口, 假)
        .如果真结束
        MDI窗口调整 (系统设置窗口, , 假)
        
    .判断 (等于 (项目索引, 3))
        .如果真 (等于 (是否已创建 (数据维护窗口), 假))
            载入 (数据维护窗口, 主窗口, 假)
        .如果真结束
        MDI窗口调整 (数据维护窗口, , 假)
    .判断 (等于 (项目索引, 4))
        信息框 (“功能开发中……”, #信息图标, “提示：”)
    .默认
        
    .判断结束
    
.默认
    
.判断结束


.窗口程序集 修改收购窗口_程序集, , , 

.子程序 _修改收购窗口_创建完毕, 空白型, , 
修改_初始化表格 ()


.子程序 修改_初始化表格, 空白型, , 
.局部变量 列表头名称, 文本型, , "0", 
.局部变量 I, 整数型, , , 

未知支持库函数_57 ()
赋值 (., 1)
赋值 (., 10)
清空 ()
赋值 (列表头名称, { “编号”, “收购地点”, “收购日期”, “种类”, “数量”, “收购价格”, “收购开支”, “应付金额”, “实付金额”, “备注” })
.计次循环首 (取数组成员数 (列表头名称), I)
    0.未知支持库函数_9 (相减 (I, 1), #., 列表头名称 [I])
    列表头名称.加入项目 ( [I], 相减 (I, 1))
.计次循环尾 ()
0.未知支持库函数_32 (35)
1.未知支持库函数_32 (135)
2.未知支持库函数_32 (80)
2.未知支持库函数_30 (#.)
3.未知支持库函数_32 (60)
3.未知支持库函数_30 (#.)
赋值 (列表头名称, 分割文本 (读配置项 (相加 (取运行目录 (), “\配置.ini”), “config”, “class”, ), “;”, ))
.计次循环首 (取数组成员数 (列表头名称), I)
    .如果真 (不等于 (列表头名称 [I], “”))
        3.未知支持库函数_45 (列表头名称 [I])
    .如果真结束
    ' 本源码来自易语言资源网(www.5A5X.com)
.计次循环尾 ()
4.未知支持库函数_32 (35)
5.未知支持库函数_30 (#.)
5.未知支持库函数_41 (2)
6.未知支持库函数_30 (#.)
6.未知支持库函数_41 (2)
7.未知支持库函数_30 (#.)
7.未知支持库函数_41 (2)
8.未知支持库函数_30 (#.)
8.未知支持库函数_41 (2)
9.未知支持库函数_32 (40)
赋值 (.现行选中项, 0)

.子程序 _组合框1_列表项被选择, 空白型, , 
.判断开始 (等于 (.现行选中项, 2))
    赋值 (.可视, 假)
    赋值 (.可视, 取反 (.可视))
.默认
    赋值 (.可视, 真)
    赋值 (.可视, 取反 (.可视))
.判断结束


.子程序 _修改收购窗口_尺寸被改变, 空白型, , 
赋值 (., 相减 (取用户区宽度 (), ., 8))
赋值 (., 相减 (取用户区高度 (), ., 8))

.子程序 _修改收购窗口_位置被改变, 空白型, , 
.如果真 (等于 (修改收购窗口., 3))
    修改收购窗口.移动 (-1, -1, , )
.如果真结束
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 列表头名称, 文本型, , "0", 
.局部变量 字段名, 文本型, , , 
.局部变量 i, 整数型, , , 
.局部变量 II, 整数型, , , 
.局部变量 SG_ID, 整数型, , , 
.局部变量 SG_AD, 文本型, , , 
.局部变量 SG_DETA, 日期时间型, , , 
.局部变量 SG_CLASS, 文本型, , , 
.局部变量 SG_NO, 小数型, , , 
.局部变量 SG_CY, 双精度小数型, , , 
.局部变量 SG_YY, 双精度小数型, , , 
.局部变量 SG_YFY, 双精度小数型, , , 
.局部变量 SG_SJY, 双精度小数型, , , 
.局部变量 SG_TEXT, 文本型, , , 

.如果真 (等于 (.现行选中项, -1))
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (列表头名称, { “SG_ID”, “SG_AD”, “SG_DETA”, “SG_CLASS”, “SG_NO”, “SG_CY”, “SG_YY”, “SG_YFY”, “SG_SJY”, “SG_TEXT” })
赋值 (字段名, 列表头名称 [相加 (.现行选中项, 1)])
.判断开始 (不等于 (.现行选中项, 2))
    .如果真 (等于 (主窗口.未知支持库函数_48 (., “sgdata”, 相加 (字段名, “ like'%”, .内容, “%'”)), 假))
        信息框 (“打开数据库失败！”, #信息图标, “提示：”)
        返回 ()
    .如果真结束
    
.默认
    .如果真 (等于 (主窗口.未知支持库函数_48 (., “sgdata”, 相加 (字段名, “=#”, 到文本 (未知支持库函数_12 (取日期 (.今天), “%y-%m-%d”)), “#”)), 假))
        信息框 (“打开数据库失败！”, #信息图标, “提示：”)
        返回 ()
    .如果真结束
    
.判断结束
修改_初始化表格 ()
赋值 (.内容, “”)
赋值 (.可视, 假)
赋值 (.可视, 真)
.如果真 (大于 (主窗口.., 0))
    .计次循环首 (主窗口.., i)
        .未知支持库函数_38 ()
        主窗口.未知支持库函数_29 (., 列表头名称 [1], SG_ID)
        主窗口.未知支持库函数_26 (., 列表头名称 [2], SG_AD)
        主窗口.未知支持库函数_31 (., 列表头名称 [3], SG_DETA)
        主窗口.未知支持库函数_26 (., 列表头名称 [4], SG_CLASS)
        主窗口.未知支持库函数_28 (., 列表头名称 [5], SG_NO)
        主窗口.未知支持库函数_27 (., 列表头名称 [6], SG_CY)
        主窗口.未知支持库函数_27 (., 列表头名称 [7], SG_YY)
        主窗口.未知支持库函数_27 (., 列表头名称 [8], SG_YFY)
        主窗口.未知支持库函数_27 (., 列表头名称 [9], SG_SJY)
        主窗口.未知支持库函数_26 (., 列表头名称 [10], SG_TEXT)
        相减 (., 1).未知支持库函数_9 (0, #., 到文本 (SG_ID))
        相减 (., 1).未知支持库函数_9 (1, #., 到文本 (SG_AD))
        相减 (., 1).未知支持库函数_9 (2, #., 到文本 (SG_DETA))
        相减 (., 1).未知支持库函数_9 (3, #., 到文本 (SG_CLASS))
        相减 (., 1).未知支持库函数_9 (4, #., 到文本 (SG_NO))
        相减 (., 1).未知支持库函数_9 (5, #., 到文本 (SG_CY))
        相减 (., 1).未知支持库函数_9 (6, #., 到文本 (SG_YY))
        相减 (., 1).未知支持库函数_9 (7, #., 到文本 (SG_YFY))
        相减 (., 1).未知支持库函数_9 (8, #., 到文本 (SG_SJY))
        相减 (., 1).未知支持库函数_9 (9, #., 到文本 (SG_TEXT))
        主窗口.未知支持库函数_36 (.)
    .计次循环尾 ()
.如果真结束
主窗口.未知支持库函数_16 (.)

.子程序 _按钮2_被单击, 空白型, , 
.局部变量 编号, 整数型, , , 

赋值 (编号, 到数值 (未知支持库函数_3 ().未知支持库函数_10 (0)))
 ' “编号”, “收购地点”, “收购日期”, “种类”, “数量”, “收购价格”, “收购开支”, “应付金额”, “实付金额”, “备注”
.如果真 (大于 (编号, 0))
    .如果真 (等于 (主窗口.未知支持库函数_48 (., “sgdata”, 相加 (“SG_ID=”, 到文本 (编号))), 真))
        主窗口.未知支持库函数_20 (., “SG_AD”, 到文本 (未知支持库函数_3 ().未知支持库函数_10 (1)))
        主窗口.未知支持库函数_25 (., “SG_DETA”, 到时间 (未知支持库函数_3 ().未知支持库函数_10 (2)), 1)
        主窗口.未知支持库函数_20 (., “SG_CLASS”, 到文本 (未知支持库函数_3 ().未知支持库函数_10 (3)))
        主窗口.未知支持库函数_22 (., “SG_NO”, 到数值 (未知支持库函数_3 ().未知支持库函数_10 (4)))
        主窗口.未知支持库函数_21 (., “ SG_CY”, 到小数 (未知支持库函数_3 ().未知支持库函数_10 (5)))
        主窗口.未知支持库函数_21 (., “SG_YY”, 到小数 (未知支持库函数_3 ().未知支持库函数_10 (6)))
        主窗口.未知支持库函数_21 (., “SG_YFY”, 到小数 (未知支持库函数_3 ().未知支持库函数_10 (7)))
        主窗口.未知支持库函数_21 (., “SG_SJY”, 到小数 (未知支持库函数_3 ().未知支持库函数_10 (8)))
        主窗口.未知支持库函数_20 (., “SG_TEXT”, 到文本 (未知支持库函数_3 ().未知支持库函数_10 (9)))
        主窗口.未知支持库函数_18 (.)
    .如果真结束
    主窗口.未知支持库函数_16 (.)
.如果真结束


.子程序 _按钮3_被单击, 空白型, , 
.局部变量 编号, 整数型, , , 

赋值 (编号, 到数值 (未知支持库函数_3 ().未知支持库函数_10 (0)))
 ' “编号”, “收购地点”, “收购日期”, “种类”, “数量”, “收购价格”, “收购开支”, “应付金额”, “实付金额”, “备注”
.如果真 (大于 (编号, 0))
    .如果真 (等于 (信息框 (“你确定要删除这单收购数据吗？”, 相加 (#询问图标, #是否钮), “提示：”), #是钮))
        .如果真 (等于 (主窗口.未知支持库函数_48 (., “sgdata”, 相加 (“SG_ID=”, 到文本 (编号))), 真))
            .如果真 (等于 (主窗口.未知支持库函数_19 (., 1), 假))
                信息框 (“此数据删除失败！”, #错误图标, “提示：”)
                主窗口.未知支持库函数_16 (.)
                返回 ()
            .如果真结束
            主窗口.未知支持库函数_18 (.)
            未知支持库函数_3 ().未知支持库函数_36 ()
        .如果真结束
        主窗口.未知支持库函数_16 (.)
    .如果真结束
    
.如果真结束


.窗口程序集 统计收购窗口_程序集, , , 

.程序集变量 价格, 整数型, , "0", 
.子程序 _统计收购窗口_创建完毕, 空白型, , 
统计_初始化表格 ()

.子程序 统计_初始化表格, 空白型, , 
.局部变量 列表头, 文本型, , "0", 
.局部变量 i, 整数型, , , 

赋值 (列表头, { “种类”, “收购数量”, “收购总额” })
未知支持库函数_57 ()
赋值 (., 3)
赋值 (., 1)
.计次循环首 (取数组成员数 (列表头), i)
    0.未知支持库函数_9 (相减 (i, 1), #., 列表头 [i])
.计次循环尾 ()
赋值 (列表头, 分割文本 (读配置项 (相加 (取运行目录 (), “\配置.ini”), “config”, “class”, ), “;”, ))
.计次循环首 (取数组成员数 (列表头), i)
    .如果真 (不等于 (列表头 [i], “”))
        列表头.未知支持库函数_38 ( [i], )
    .如果真结束
    
.计次循环尾 ()
1.未知支持库函数_32 (60)
“收购总开支：”.未知支持库函数_38 ()
相减 (., 1).未知支持库函数_58 (1, 相减 (., 1), 2)
“收购总金额：”.未知支持库函数_38 ()
相减 (., 1).未知支持库函数_58 (1, 相减 (., 1), 2)

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 _日期, 文本型, , , 
.局部变量 A, 文本型, , , 
.局部变量 i, 整数型, , , 
.局部变量 匿名局部变量_468, 空白型, , , 
.局部变量 SG_DETA, 日期时间型, , , 
.局部变量 SG_CLASS, 文本型, , , 
.局部变量 SG_NO, 小数型, , , 
.局部变量 SG_YY, 双精度小数型, , , 
.局部变量 SG_SJY, 双精度小数型, , , 
.局部变量 II, 整数型, , , 
.局部变量 总SG_SJY, 双精度小数型, , , 
.局部变量 总SG_YY, 双精度小数型, , , 

统计_初始化表格 ()
.如果真 (主窗口.未知支持库函数_14 (., “sgdata”, #, ))
    .如果真 (大于 (主窗口.., 0))
        主窗口.未知支持库函数_34 (.)
        .计次循环首 (主窗口.., i)
            主窗口.未知支持库函数_31 (., “SG_DETA”, SG_DETA)
            .判断开始 (等于 (.选中, 真))
                .如果真 (等于 (取年份 (SG_DETA), 取年份 (.今天)))
                    主窗口.未知支持库函数_26 (., “SG_CLASS”, SG_CLASS)
                    主窗口.未知支持库函数_28 (., “SG_NO”, SG_NO)
                    主窗口.未知支持库函数_27 (., “SG_YY”, SG_YY)
                    主窗口.未知支持库函数_27 (., “SG_SJY”, SG_SJY)
                    .计次循环首 (., II)
                        .如果真 (等于 (SG_CLASS, 到文本 (相减 (II, 1).未知支持库函数_10 (0))))
                            相减 (II, 1).未知支持库函数_9 (1, #., 到文本 (相加 (到数值 (相减 (II, 1).未知支持库函数_10 (1)), SG_NO)))
                            相减 (II, 1).未知支持库函数_9 (2, #., 到文本 (相加 (到数值 (相减 (II, 1).未知支持库函数_10 (2)), SG_SJY)))
                        .如果真结束
                        
                    .计次循环尾 ()
                    赋值 (总SG_YY, 相加 (SG_YY, 总SG_YY))
                    赋值 (总SG_SJY, 相加 (SG_SJY, 总SG_SJY))
                .如果真结束
                
            .判断 (等于 (.选中, 真))
                .如果真 (并且 (等于 (取月份 (SG_DETA), 取月份 (.今天)), 等于 (取年份 (SG_DETA), 取年份 (.今天))))
                    主窗口.未知支持库函数_26 (., “SG_CLASS”, SG_CLASS)
                    主窗口.未知支持库函数_28 (., “SG_NO”, SG_NO)
                    主窗口.未知支持库函数_27 (., “SG_YY”, SG_YY)
                    主窗口.未知支持库函数_27 (., “SG_SJY”, SG_SJY)
                    .计次循环首 (., II)
                        .如果真 (等于 (SG_CLASS, 到文本 (相减 (II, 1).未知支持库函数_10 (0))))
                            相减 (II, 1).未知支持库函数_9 (1, #., 到文本 (相加 (到数值 (相减 (II, 1).未知支持库函数_10 (1)), SG_NO)))
                            相减 (II, 1).未知支持库函数_9 (2, #., 到文本 (相加 (到数值 (相减 (II, 1).未知支持库函数_10 (2)), SG_SJY)))
                        .如果真结束
                        
                    .计次循环尾 ()
                    赋值 (总SG_YY, 相加 (SG_YY, 总SG_YY))
                    赋值 (总SG_SJY, 相加 (SG_SJY, 总SG_SJY))
                .如果真结束
                
            .判断 (等于 (.选中, 真))
                .如果真 (并且 (等于 (取月份 (SG_DETA), 取月份 (.今天)), 等于 (取年份 (SG_DETA), 取年份 (.今天)), 等于 (取日 (SG_DETA), 取日 (.今天))))
                    主窗口.未知支持库函数_26 (., “SG_CLASS”, SG_CLASS)
                    主窗口.未知支持库函数_28 (., “SG_NO”, SG_NO)
                    主窗口.未知支持库函数_27 (., “SG_YY”, SG_YY)
                    主窗口.未知支持库函数_27 (., “SG_SJY”, SG_SJY)
                    .计次循环首 (., II)
                        .如果真 (等于 (SG_CLASS, 到文本 (相减 (II, 1).未知支持库函数_10 (0))))
                            相减 (II, 1).未知支持库函数_9 (1, #., 到文本 (相加 (到数值 (相减 (II, 1).未知支持库函数_10 (1)), SG_NO)))
                            相减 (II, 1).未知支持库函数_9 (2, #., 到文本 (相加 (到数值 (相减 (II, 1).未知支持库函数_10 (2)), SG_SJY)))
                        .如果真结束
                        
                    .计次循环尾 ()
                    赋值 (总SG_YY, 相加 (SG_YY, 总SG_YY))
                    赋值 (总SG_SJY, 相加 (SG_SJY, 总SG_SJY))
                .如果真结束
                
            .默认
                
            .判断结束
            主窗口.未知支持库函数_36 (.)
        .计次循环尾 ()
        相减 (., 2).未知支持库函数_9 (1, #., 到文本 (总SG_YY))
        相减 (., 1).未知支持库函数_9 (1, #., 到文本 (总SG_SJY))
        赋值 (总SG_YY, 0)
        赋值 (总SG_SJY, 0)
        主窗口.未知支持库函数_16 (.)
    .如果真结束
    
.如果真结束


.子程序 _按钮2_被单击, 空白型, , 
载入 (价格曲线窗口, 统计收购窗口, 真)

.窗口程序集 添加收购窗口_程序集, , , 

.子程序 _添加收购窗口_创建完毕, 空白型, , 
.局部变量 临时, 文本型, , "0", 
.局部变量 i, 整数型, , , 

赋值 (临时, 分割文本 (读配置项 (相加 (取运行目录 (), “\配置.ini”), “config”, “class”, ), “;”, ))
.如果真 (不等于 (取数组成员数 (临时), 0))
    .计次循环首 (取数组成员数 (临时), i)
        .如果真 (不等于 (临时 [i], “”))
            临时.加入项目 ( [i], )
        .如果真结束
        
    .计次循环尾 ()
.如果真结束


.子程序 _按钮2_被单击, 空白型, , 
.判断开始 (等于 (.内容, “”))
    获取焦点 ()
.判断 (等于 (.内容, “”))
    获取焦点 ()
.判断 (等于 (.内容, “”))
    获取焦点 ()
.判断 (等于 (.内容, “”))
    获取焦点 ()
.判断 (等于 (.内容, “”))
    获取焦点 ()
.判断 (等于 (.内容, “”))
    获取焦点 ()
.判断 (等于 (写入收购数据 (), 假))
    信息框 (“写入收购数据失败，请重新添加一次或联系管理员！”, #错误图标, “失败：”)
    添加收购窗口.销毁 ()
.默认
    信息框 (“添加收购数据成功！”, #信息图标, “成功：”)
    添加收购窗口.销毁 ()
.判断结束


.子程序 写入收购数据, 逻辑型, , 
.局部变量 结果, 逻辑型, , , 

赋值 (结果, 主窗口.未知支持库函数_14 (., “sgdata”, #, ))
.如果真 (不等于 (结果, 假))
    .如果真 (等于 (主窗口.未知支持库函数_17 (.), 真))
        主窗口.未知支持库函数_20 (., “SG_AD”, .内容)
        主窗口.未知支持库函数_25 (., “SG_DETA”, .今天, 1)
        主窗口.未知支持库函数_20 (., “SG_CLASS”, .内容)
        主窗口.未知支持库函数_22 (., “SG_NO”, 到小数 (.内容))
        主窗口.未知支持库函数_21 (., “SG_CY”, 到小数 (.内容))
        主窗口.未知支持库函数_21 (., “SG_YY”, 到小数 (.内容))
        主窗口.未知支持库函数_21 (., “SG_YFY”, 到小数 (.内容))
        主窗口.未知支持库函数_21 (., “SG_SJY”, 到小数 (.内容))
        主窗口.未知支持库函数_20 (., “SG_TEXT”, .内容)
        赋值 (结果, 主窗口.未知支持库函数_18 (.))
    .如果真结束
    
.如果真结束
主窗口.未知支持库函数_16 (.)
返回 (结果)

.子程序 _编辑框2_内容被改变, 空白型, , 
赋值 (.内容, 到文本 (四舍五入 (相乘 (到小数 (.内容), 到小数 (.内容)), 2)))

.子程序 _编辑框3_内容被改变, 空白型, , 
_编辑框2_内容被改变 ()

.子程序 _编辑框5_获得焦点, 空白型, , 
_编辑框2_内容被改变 ()

.子程序 _编辑框5_失去焦点, 空白型, , 
_编辑框2_内容被改变 ()

.子程序 _编辑框4_内容被改变, 空白型, , 
赋值 (.内容, 到文本 (相加 (到数值 (.内容), 到数值 (.内容))))

.子程序 _编辑框6_内容被改变, 空白型, , 
_编辑框4_内容被改变 ()

.子程序 _编辑框6_获得焦点, 空白型, , 
_编辑框4_内容被改变 ()

.子程序 _编辑框6_失去焦点, 空白型, , 
_编辑框4_内容被改变 ()

.子程序 _编辑框4_获得焦点, 空白型, , 
_编辑框4_内容被改变 ()

.子程序 _编辑框4_失去焦点, 空白型, , 
_编辑框4_内容被改变 ()

.子程序 _按钮1_被单击, 空白型, , 
载入 (种类窗口, 添加收购窗口, 假)

.窗口程序集 种类窗口_程序集, , , 

.子程序 _种类窗口_创建完毕, 空白型, , 
.局部变量 临时, 文本型, , "0", 
.局部变量 i, 整数型, , , 

赋值 (临时, 分割文本 (读配置项 (相加 (取运行目录 (), “\配置.ini”), “config”, “class”, ), “;”, ))
.如果真 (不等于 (取数组成员数 (临时), 0))
    .计次循环首 (取数组成员数 (临时), i)
        .如果真 (不等于 (临时 [i], “”))
            临时.加入文本 ( [i], #换行符)
        .如果真结束
        
    .计次循环尾 ()
.如果真结束


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 临时, 文本型, , "0", 
.局部变量 结果, 文本型, , , 
.局部变量 I, 整数型, , , 

赋值 (临时, 分割文本 (子文本替换 (.内容, #换行符, “;”, , , 真), “;”, ))
.如果真 (不等于 (取数组成员数 (临时), 0))
    .计次循环首 (取数组成员数 (临时), I)
        .如果真 (不等于 (临时 [I], “”))
            赋值 (结果, 相加 (结果, 临时 [I], “;”))
        .如果真结束
        
    .计次循环尾 ()
.如果真结束
赋值 (结果, 取文本左边 (结果, 相减 (倒找文本 (结果, “;”, , 假), 1)))
.判断开始 (等于 (写配置项 (相加 (取运行目录 (), “\配置.ini”), “config”, “class”, 结果), 真))
    添加收购窗口.清空 (.)
    赋值 (临时, 分割文本 (结果, “;”, ))
    .计次循环首 (取数组成员数 (临时), I)
        .如果真 (不等于 (临时 [I], “”))
            添加收购窗口.加入项目 (., 临时 [I], )
        .如果真结束
        
    .计次循环尾 ()
    信息框 (“修改种类成功！”, #信息图标, “提示：”)
    销毁 ()
.默认
    信息框 (“操作失败！”, #警告图标, “失败：”)
    销毁 ()
.判断结束


.程序集 公共程序集, , , 

.子程序 _取日期, 文本型, 公开, 返回系统当前时间，默认为: %n-%y-%r-%x
.参数 要取的日期, 日期时间型, , 
.参数 输出格式, 文本型, 可空, 请给出输出时间的格式。默认为: %n-%y-%r-%x  如果只取其中部分请输入%n(年)，%y(月)，%r(日)，%x(星期)

.局部变量 临时调用, 日期时间型, , , 
.局部变量 临时, _日期, , , 
.局部变量 结果, 文本型, , , 

赋值 (临时调用, 要取的日期)
赋值 (临时._年, 到文本 (取年份 (临时调用)))
赋值 (临时._月, 到文本 (取月份 (临时调用)))
赋值 (临时._日, 到文本 (取日 (临时调用)))
赋值 (临时._星期, 选择 (等于 (取星期几 (临时调用), 1), “日”, 数值到大写 (相减 (取星期几 (临时调用), 1), 真)))
.如果真 (小于 (取文本长度 (临时._月), 2))
    赋值 (临时._月, 相加 (“0”, 临时._月))
.如果真结束
.如果真 (小于 (取文本长度 (临时._日), 2))
    赋值 (临时._日, 相加 (“0”, 临时._日))
.如果真结束
.判断开始 (不等于 (输出格式, “”))
    赋值 (输出格式, 子文本替换 (输出格式, “%n”, 临时._年, , , 真))
    赋值 (输出格式, 子文本替换 (输出格式, “%y”, 临时._月, , , 真))
    赋值 (输出格式, 子文本替换 (输出格式, “%r”, 临时._日, , , 真))
    赋值 (输出格式, 子文本替换 (输出格式, “%x”, 临时._星期, , , 真))
.默认
    赋值 (输出格式, 相加 (临时._年, “-”, 临时._月, “-”, 临时._日, “-”, 临时._星期))
.判断结束
赋值 (结果, 输出格式)
返回 (结果)


.窗口程序集 价格曲线窗口_程序集, , , 

.子程序 _价格曲线窗口_创建完毕, 空白型, , 
.局部变量 临时, 文本型, , "0", 
.局部变量 i, 整数型, , , 

赋值 (价格曲线窗口., 取屏幕宽度 ())
赋值 (价格曲线窗口., 取屏幕高度 ())
赋值 (., 相减 (取用户区宽度 (), 1))
赋值 (., 相减 (取用户区高度 (), .))
赋值 (., 相减 (取用户区宽度 (), 10, .))
赋值 (临时, 分割文本 (读配置项 (相加 (取运行目录 (), “\配置.ini”), “config”, “class”, ), “;”, ))
.如果真 (不等于 (取数组成员数 (临时), 0))
    .计次循环首 (取数组成员数 (临时), i)
        .如果真 (不等于 (临时 [i], “”))
            临时.加入项目 ( [i], )
        .如果真结束
        
    .计次循环尾 ()
    赋值 (.现行选中项, 0)
    .计次循环首 (12, i)
        到文本 (相加 (2010, i)).加入项目 ()
        到文本 (i).加入项目 ()
    .计次循环尾 ()
.如果真结束


.子程序 _超级按钮1_被单击, 空白型, , 
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 SG_DETA, 日期时间型, , , 
.局部变量 SG_CY, 双精度小数型, , , 
.局部变量 总天数, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 ii, 整数型, , , 
.局部变量 J, 整数型, , , 

.判断开始 (等于 (.内容, “”))
    获取焦点 ()
.判断 (等于 (.内容, “”))
    获取焦点 ()
.判断 (等于 (.内容, “”))
    获取焦点 ()
.默认
    .如果真 (等于 (主窗口.未知支持库函数_48 (., “sgdata”, 相加 (“SG_CLASS='”, .内容, “'”)), 真))
        赋值 (总天数, 取某月天数 (到数值 (.内容), 到数值 (.内容)))
        赋值 (., 总天数)
        .计次循环首 (总天数, ii)
            赋值 (., 相减 (ii, 1))
            赋值 (., 到文本 (ii))
        .计次循环尾 ()
        赋值 (., 相加 (.内容, “--”, .内容, “月份--【价格曲线图】”))
        .如果真 (大于 (主窗口.., 0))
            主窗口.未知支持库函数_34 (.)
            .计次循环首 (主窗口.., i)
                主窗口.未知支持库函数_31 (., “SG_DETA”, SG_DETA)
                .如果真 (并且 (等于 (取月份 (SG_DETA), 到数值 (.内容)), 等于 (取年份 (SG_DETA), 到数值 (.内容))))
                    主窗口.未知支持库函数_27 (., “SG_CY”, SG_CY)
                    赋值 (., 相减 (取日 (SG_DETA), 1))
                    赋值 (., SG_CY)
                .如果真结束
                主窗口.未知支持库函数_36 (.)
            .计次循环尾 ()
        .如果真结束
        
    .如果真结束
    赋值 (ii, 0)
    主窗口.未知支持库函数_16 (.)
.判断结束


.窗口程序集 添加转卖窗口_程序集, , , 

.子程序 _添加转卖窗口_创建完毕, 空白型, , 
.局部变量 临时, 文本型, , "0", 
.局部变量 i, 整数型, , , 

赋值 (临时, 分割文本 (读配置项 (相加 (取运行目录 (), “\配置.ini”), “config”, “class”, ), “;”, ))
.如果真 (不等于 (取数组成员数 (临时), 0))
    .计次循环首 (取数组成员数 (临时), i)
        .如果真 (不等于 (临时 [i], “”))
            临时.加入项目 ( [i], )
        .如果真结束
        
    .计次循环尾 ()
.如果真结束


.子程序 _按钮2_被单击, 空白型, , 
.判断开始 (等于 (.内容, “”))
    获取焦点 ()
.判断 (等于 (.内容, “”))
    获取焦点 ()
.判断 (等于 (.内容, “”))
    获取焦点 ()
.判断 (等于 (.内容, “”))
    获取焦点 ()
.判断 (等于 (.内容, “”))
    获取焦点 ()
.判断 (等于 (.内容, “”))
    获取焦点 ()
.判断 (等于 (写入转卖数据 (), 假))
    信息框 (“写入转卖数据失败，请重新添加一次或联系管理员！”, #错误图标, “失败：”)
    添加转卖窗口.销毁 ()
.默认
    信息框 (“添加转卖数据成功！”, #信息图标, “成功：”)
    添加转卖窗口.销毁 ()
.判断结束


.子程序 写入转卖数据, 逻辑型, , 
.局部变量 结果, 逻辑型, , , 

赋值 (结果, 主窗口.未知支持库函数_14 (., “zmdata”, #, ))
.如果真 (不等于 (结果, 假))
    .如果真 (等于 (主窗口.未知支持库函数_17 (.), 真))
        主窗口.未知支持库函数_20 (., “ZM_AD”, .内容)
        主窗口.未知支持库函数_25 (., “ZM_DETA”, .今天, 1)
        主窗口.未知支持库函数_20 (., “ZM_CLASS”, .内容)
        主窗口.未知支持库函数_22 (., “ZM_NO”, 到小数 (.内容))
        主窗口.未知支持库函数_21 (., “ZM_CY”, 到小数 (.内容))
        主窗口.未知支持库函数_21 (., “ZM_YY”, 到小数 (.内容))
        主窗口.未知支持库函数_21 (., “ZM_YFY”, 到小数 (.内容))
        主窗口.未知支持库函数_21 (., “ZM_SJY”, 到小数 (.内容))
        主窗口.未知支持库函数_20 (., “ZM_TEXT”, .内容)
        赋值 (结果, 主窗口.未知支持库函数_18 (.))
    .如果真结束
    
.如果真结束
主窗口.未知支持库函数_16 (.)
返回 (结果)

.子程序 _编辑框2_内容被改变, 空白型, , 
赋值 (.内容, 到文本 (四舍五入 (相乘 (到小数 (.内容), 到小数 (.内容)), 2)))

.子程序 _编辑框3_内容被改变, 空白型, , 
_编辑框2_内容被改变 ()

.子程序 _编辑框5_获得焦点, 空白型, , 
_编辑框2_内容被改变 ()

.子程序 _编辑框5_失去焦点, 空白型, , 
_编辑框2_内容被改变 ()

.子程序 _编辑框4_内容被改变, 空白型, , 
赋值 (.内容, 到文本 (相减 (到数值 (.内容), 到数值 (.内容))))

.子程序 _编辑框6_内容被改变, 空白型, , 
_编辑框4_内容被改变 ()

.子程序 _编辑框6_获得焦点, 空白型, , 
_编辑框4_内容被改变 ()

.子程序 _编辑框6_失去焦点, 空白型, , 
_编辑框4_内容被改变 ()

.子程序 _编辑框4_获得焦点, 空白型, , 
_编辑框4_内容被改变 ()

.子程序 _编辑框4_失去焦点, 空白型, , 
_编辑框4_内容被改变 ()

.子程序 _按钮1_被单击, 空白型, , 
载入 (种类窗口, 添加转卖窗口, 假)

.窗口程序集 修改转卖窗口_程序集, , , 

.子程序 _修改转卖窗口_创建完毕, 空白型, , 
修改_初始化表格 ()

.子程序 修改_初始化表格, 空白型, , 
.局部变量 列表头名称, 文本型, , "0", 
.局部变量 I, 整数型, , , 

未知支持库函数_57 ()
赋值 (., 1)
赋值 (., 10)
清空 ()
赋值 (列表头名称, { “编号”, “转卖地点”, “转卖日期”, “种类”, “数量”, “转卖价格”, “转卖开支”, “应得金额”, “实得金额”, “备注” })
.计次循环首 (取数组成员数 (列表头名称), I)
    0.未知支持库函数_9 (相减 (I, 1), #., 列表头名称 [I])
    列表头名称.加入项目 ( [I], 相减 (I, 1))
.计次循环尾 ()
0.未知支持库函数_32 (35)
1.未知支持库函数_32 (135)
2.未知支持库函数_32 (80)
2.未知支持库函数_30 (#.)
3.未知支持库函数_32 (60)
3.未知支持库函数_30 (#.)
赋值 (列表头名称, 分割文本 (读配置项 (相加 (取运行目录 (), “\配置.ini”), “config”, “class”, ), “;”, ))
.计次循环首 (取数组成员数 (列表头名称), I)
    .如果真 (不等于 (列表头名称 [I], “”))
        3.未知支持库函数_45 (列表头名称 [I])
    .如果真结束
    
.计次循环尾 ()
4.未知支持库函数_32 (35)
5.未知支持库函数_30 (#.)
5.未知支持库函数_41 (2)
6.未知支持库函数_30 (#.)
6.未知支持库函数_41 (2)
7.未知支持库函数_30 (#.)
7.未知支持库函数_41 (2)
8.未知支持库函数_30 (#.)
8.未知支持库函数_41 (2)
9.未知支持库函数_32 (40)
赋值 (.现行选中项, 0)

.子程序 _组合框1_列表项被选择, 空白型, , 
.判断开始 (等于 (.现行选中项, 2))
    赋值 (.可视, 假)
    赋值 (.可视, 取反 (.可视))
.默认
    赋值 (.可视, 真)
    赋值 (.可视, 取反 (.可视))
.判断结束


.子程序 _修改转卖窗口_尺寸被改变, 空白型, , 
赋值 (., 相减 (取用户区宽度 (), ., 8))
赋值 (., 相减 (取用户区高度 (), ., 8))

.子程序 _修改转卖窗口_位置被改变, 空白型, , 
.如果真 (等于 (修改转卖窗口., 3))
    修改转卖窗口.移动 (-1, -1, , )
.如果真结束
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 列表头名称, 文本型, , "0", 
.局部变量 字段名, 文本型, , , 
.局部变量 i, 整数型, , , 
.局部变量 II, 整数型, , , 
.局部变量 ZM_ID, 整数型, , , 
.局部变量 ZM_AD, 文本型, , , 
.局部变量 ZM_DETA, 日期时间型, , , 
.局部变量 ZM_CLASS, 文本型, , , 
.局部变量 ZM_NO, 小数型, , , 
.局部变量 ZM_CY, 双精度小数型, , , 
.局部变量 ZM_YY, 双精度小数型, , , 
.局部变量 ZM_YFY, 双精度小数型, , , 
.局部变量 ZM_SJY, 双精度小数型, , , 
.局部变量 ZM_TEXT, 文本型, , , 

.如果真 (等于 (.现行选中项, -1))
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (列表头名称, { “ZM_ID”, “ZM_AD”, “ZM_DETA”, “ZM_CLASS”, “ZM_NO”, “ZM_CY”, “ZM_YY”, “ZM_YFY”, “ZM_SJY”, “ZM_TEXT” })
赋值 (字段名, 列表头名称 [相加 (.现行选中项, 1)])
.判断开始 (不等于 (.现行选中项, 2))
    .如果真 (等于 (主窗口.未知支持库函数_48 (., “zmdata”, 相加 (字段名, “ like'%”, .内容, “%'”)), 假))
        信息框 (“打开数据库失败！”, #信息图标, “提示：”)
        返回 ()
    .如果真结束
    
.默认
    .如果真 (等于 (主窗口.未知支持库函数_48 (., “zmdata”, 相加 (字段名, “=#”, 到文本 (未知支持库函数_12 (取日期 (.今天), “%y-%m-%d”)), “#”)), 假))
        信息框 (“打开数据库失败！”, #信息图标, “提示：”)
        返回 ()
    .如果真结束
    
.判断结束
修改_初始化表格 ()
赋值 (.内容, “”)
赋值 (.可视, 假)
赋值 (.可视, 真)
.如果真 (大于 (主窗口.., 0))
    .计次循环首 (主窗口.., i)
        .未知支持库函数_38 ()
        主窗口.未知支持库函数_29 (., 列表头名称 [1], ZM_ID)
        主窗口.未知支持库函数_26 (., 列表头名称 [2], ZM_AD)
        主窗口.未知支持库函数_31 (., 列表头名称 [3], ZM_DETA)
        主窗口.未知支持库函数_26 (., 列表头名称 [4], ZM_CLASS)
        主窗口.未知支持库函数_28 (., 列表头名称 [5], ZM_NO)
        主窗口.未知支持库函数_27 (., 列表头名称 [6], ZM_CY)
        主窗口.未知支持库函数_27 (., 列表头名称 [7], ZM_YY)
        主窗口.未知支持库函数_27 (., 列表头名称 [8], ZM_YFY)
        主窗口.未知支持库函数_27 (., 列表头名称 [9], ZM_SJY)
        主窗口.未知支持库函数_26 (., 列表头名称 [10], ZM_TEXT)
        相减 (., 1).未知支持库函数_9 (0, #., 到文本 (ZM_ID))
        相减 (., 1).未知支持库函数_9 (1, #., 到文本 (ZM_AD))
        相减 (., 1).未知支持库函数_9 (2, #., 到文本 (ZM_DETA))
        相减 (., 1).未知支持库函数_9 (3, #., 到文本 (ZM_CLASS))
        相减 (., 1).未知支持库函数_9 (4, #., 到文本 (ZM_NO))
        相减 (., 1).未知支持库函数_9 (5, #., 到文本 (ZM_CY))
        相减 (., 1).未知支持库函数_9 (6, #., 到文本 (ZM_YY))
        相减 (., 1).未知支持库函数_9 (7, #., 到文本 (ZM_YFY))
        相减 (., 1).未知支持库函数_9 (8, #., 到文本 (ZM_SJY))
        相减 (., 1).未知支持库函数_9 (9, #., 到文本 (ZM_TEXT))
        主窗口.未知支持库函数_36 (.)
    .计次循环尾 ()
.如果真结束
主窗口.未知支持库函数_16 (.)

.子程序 _按钮2_被单击, 空白型, , 
.局部变量 编号, 整数型, , , 

赋值 (编号, 到数值 (未知支持库函数_3 ().未知支持库函数_10 (0)))
 ' “编号”, “收购地点”, “收购日期”, “种类”, “数量”, “收购价格”, “收购开支”, “应付金额”, “实付金额”, “备注”
.如果真 (大于 (编号, 0))
    .如果真 (等于 (主窗口.未知支持库函数_48 (., “zmdata”, 相加 (“ZM_ID=”, 到文本 (编号))), 真))
        主窗口.未知支持库函数_20 (., “ZM_AD”, 到文本 (未知支持库函数_3 ().未知支持库函数_10 (1)))
        主窗口.未知支持库函数_25 (., “ZM_DETA”, 到时间 (未知支持库函数_3 ().未知支持库函数_10 (2)), 1)
        主窗口.未知支持库函数_20 (., “ZM_CLASS”, 到文本 (未知支持库函数_3 ().未知支持库函数_10 (3)))
        主窗口.未知支持库函数_22 (., “ZM_NO”, 到数值 (未知支持库函数_3 ().未知支持库函数_10 (4)))
        主窗口.未知支持库函数_21 (., “ZM_CY”, 到小数 (未知支持库函数_3 ().未知支持库函数_10 (5)))
        主窗口.未知支持库函数_21 (., “ZM_YY”, 到小数 (未知支持库函数_3 ().未知支持库函数_10 (6)))
        主窗口.未知支持库函数_21 (., “ZM_YFY”, 到小数 (未知支持库函数_3 ().未知支持库函数_10 (7)))
        主窗口.未知支持库函数_21 (., “ZM_SJY”, 到小数 (未知支持库函数_3 ().未知支持库函数_10 (8)))
        主窗口.未知支持库函数_20 (., “ZM_TEXT”, 到文本 (未知支持库函数_3 ().未知支持库函数_10 (9)))
        主窗口.未知支持库函数_18 (.)
    .如果真结束
    主窗口.未知支持库函数_16 (.)
.如果真结束


.子程序 _按钮3_被单击, 空白型, , 
.局部变量 编号, 整数型, , , 

赋值 (编号, 到数值 (未知支持库函数_3 ().未知支持库函数_10 (0)))
 ' “编号”, “收购地点”, “收购日期”, “种类”, “数量”, “收购价格”, “收购开支”, “应付金额”, “实付金额”, “备注”
.如果真 (大于 (编号, 0))
    .如果真 (等于 (信息框 (“你确定要删除这单收购数据吗？”, 相加 (#询问图标, #是否钮), “提示：”), #是钮))
        .如果真 (等于 (主窗口.未知支持库函数_48 (., “zmdata”, 相加 (“ZM_ID=”, 到文本 (编号))), 真))
            .如果真 (等于 (主窗口.未知支持库函数_19 (., 1), 假))
                信息框 (“此数据删除失败！”, #错误图标, “提示：”)
                主窗口.未知支持库函数_16 (.)
                返回 ()
            .如果真结束
            主窗口.未知支持库函数_18 (.)
            未知支持库函数_3 ().未知支持库函数_36 ()
        .如果真结束
        主窗口.未知支持库函数_16 (.)
    .如果真结束
    
.如果真结束


.窗口程序集 统计转卖窗口_程序集, , , 

.子程序 _统计转卖窗口_创建完毕, 空白型, , 


.子程序 统计_初始化表格, 空白型, , 
.局部变量 列表头, 文本型, , "0", 
.局部变量 i, 整数型, , , 

赋值 (列表头, { “种类”, “转卖数量”, “转卖总额” })
未知支持库函数_57 ()
赋值 (., 3)
赋值 (., 1)
.计次循环首 (取数组成员数 (列表头), i)
    0.未知支持库函数_9 (相减 (i, 1), #., 列表头 [i])
.计次循环尾 ()
赋值 (列表头, 分割文本 (读配置项 (相加 (取运行目录 (), “\配置.ini”), “config”, “class”, ), “;”, ))
.计次循环首 (取数组成员数 (列表头), i)
    .如果真 (不等于 (列表头 [i], “”))
        列表头.未知支持库函数_38 ( [i], )
    .如果真结束
    ' 本源码来自易语言资源网(www.5A5X.com)
.计次循环尾 ()
1.未知支持库函数_32 (60)
“转卖总开支：”.未知支持库函数_38 ()
相减 (., 1).未知支持库函数_58 (1, 相减 (., 1), 2)
“转卖总金额：”.未知支持库函数_38 ()
相减 (., 1).未知支持库函数_58 (1, 相减 (., 1), 2)

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 _日期, 文本型, , , 
.局部变量 A, 文本型, , , 
.局部变量 i, 整数型, , , 
.局部变量 匿名局部变量_760, 空白型, , , 
.局部变量 ZM_DETA, 日期时间型, , , 
.局部变量 ZM_CLASS, 文本型, , , 
.局部变量 ZM_NO, 小数型, , , 
.局部变量 ZM_YY, 双精度小数型, , , 
.局部变量 ZM_SJY, 双精度小数型, , , 
.局部变量 II, 整数型, , , 
.局部变量 总ZM_SJY, 双精度小数型, , , 
.局部变量 总ZM_YY, 双精度小数型, , , 

统计_初始化表格 ()
.如果真 (主窗口.未知支持库函数_14 (., “zmdata”, #, ))
    .如果真 (大于 (主窗口.., 0))
        主窗口.未知支持库函数_34 (.)
        .计次循环首 (主窗口.., i)
            主窗口.未知支持库函数_31 (., “ZM_DETA”, ZM_DETA)
            .判断开始 (等于 (.选中, 真))
                .如果真 (等于 (取年份 (ZM_DETA), 取年份 (.今天)))
                    主窗口.未知支持库函数_26 (., “ZM_CLASS”, ZM_CLASS)
                    主窗口.未知支持库函数_28 (., “ZM_NO”, ZM_NO)
                    主窗口.未知支持库函数_27 (., “ZM_YY”, ZM_YY)
                    主窗口.未知支持库函数_27 (., “ZM_SJY”, ZM_SJY)
                    .计次循环首 (., II)
                        .如果真 (等于 (ZM_CLASS, 到文本 (相减 (II, 1).未知支持库函数_10 (0))))
                            相减 (II, 1).未知支持库函数_9 (1, #., 到文本 (相加 (到数值 (相减 (II, 1).未知支持库函数_10 (1)), ZM_NO)))
                            相减 (II, 1).未知支持库函数_9 (2, #., 到文本 (相加 (到数值 (相减 (II, 1).未知支持库函数_10 (2)), ZM_SJY)))
                        .如果真结束
                        
                    .计次循环尾 ()
                    赋值 (总ZM_YY, 相加 (ZM_YY, 总ZM_YY))
                    赋值 (总ZM_SJY, 相加 (ZM_SJY, 总ZM_SJY))
                .如果真结束
                
            .判断 (等于 (.选中, 真))
                .如果真 (并且 (等于 (取月份 (ZM_DETA), 取月份 (.今天)), 等于 (取年份 (ZM_DETA), 取年份 (.今天))))
                    主窗口.未知支持库函数_26 (., “ZM_CLASS”, ZM_CLASS)
                    主窗口.未知支持库函数_28 (., “ZM_NO”, ZM_NO)
                    主窗口.未知支持库函数_27 (., “ZM_YY”, ZM_YY)
                    主窗口.未知支持库函数_27 (., “ZM_SJY”, ZM_SJY)
                    .计次循环首 (., II)
                        .如果真 (等于 (ZM_CLASS, 到文本 (相减 (II, 1).未知支持库函数_10 (0))))
                            相减 (II, 1).未知支持库函数_9 (1, #., 到文本 (相加 (到数值 (相减 (II, 1).未知支持库函数_10 (1)), ZM_NO)))
                            相减 (II, 1).未知支持库函数_9 (2, #., 到文本 (相加 (到数值 (相减 (II, 1).未知支持库函数_10 (2)), ZM_SJY)))
                        .如果真结束
                        
                    .计次循环尾 ()
                    赋值 (总ZM_YY, 相加 (ZM_YY, 总ZM_YY))
                    赋值 (总ZM_SJY, 相加 (ZM_SJY, 总ZM_SJY))
                .如果真结束
                
            .判断 (等于 (.选中, 真))
                .如果真 (并且 (等于 (取月份 (ZM_DETA), 取月份 (.今天)), 等于 (取年份 (ZM_DETA), 取年份 (.今天)), 等于 (取日 (ZM_DETA), 取日 (.今天))))
                    主窗口.未知支持库函数_26 (., “ZM_CLASS”, ZM_CLASS)
                    主窗口.未知支持库函数_28 (., “ZM_NO”, ZM_NO)
                    主窗口.未知支持库函数_27 (., “ZM_YY”, ZM_YY)
                    主窗口.未知支持库函数_27 (., “ZM_SJY”, ZM_SJY)
                    .计次循环首 (., II)
                        .如果真 (等于 (ZM_CLASS, 到文本 (相减 (II, 1).未知支持库函数_10 (0))))
                            相减 (II, 1).未知支持库函数_9 (1, #., 到文本 (相加 (到数值 (相减 (II, 1).未知支持库函数_10 (1)), ZM_NO)))
                            相减 (II, 1).未知支持库函数_9 (2, #., 到文本 (相加 (到数值 (相减 (II, 1).未知支持库函数_10 (2)), ZM_SJY)))
                        .如果真结束
                        
                    .计次循环尾 ()
                    赋值 (总ZM_YY, 相加 (ZM_YY, 总ZM_YY))
                    赋值 (总ZM_SJY, 相加 (ZM_SJY, 总ZM_SJY))
                .如果真结束
                
            .默认
                
            .判断结束
            主窗口.未知支持库函数_36 (.)
        .计次循环尾 ()
        相减 (., 2).未知支持库函数_9 (1, #., 到文本 (总ZM_YY))
        相减 (., 1).未知支持库函数_9 (1, #., 到文本 (总ZM_SJY))
        赋值 (总ZM_YY, 0)
        赋值 (总ZM_SJY, 0)
        主窗口.未知支持库函数_16 (.)
    .如果真结束
    
.如果真结束


.子程序 _按钮2_被单击, 空白型, , 
载入 (价格曲线窗口, 统计收购窗口, 真)

.窗口程序集 系统设置窗口_程序集, , , 

.程序集变量 配置文件, 文本型, , , 
.子程序 _系统设置窗口_创建完毕, 空白型, , 
.局部变量 皮肤, 整数型, , , 
.局部变量 临时, 文本型, , "0", 
.局部变量 i, 整数型, , , 

赋值 (配置文件, 相加 (取运行目录 (), “\配置.ini”))
赋值 (.内容, 全_用户名)
赋值 (皮肤, 到数值 (读配置项 (配置文件, “config”, “skin”, )))
.判断开始 (等于 (皮肤, 0))
    赋值 (.选中, 真)
.判断 (等于 (皮肤, 1))
    赋值 (.选中, 真)
.判断 (等于 (皮肤, 2))
    赋值 (.选中, 真)
.判断 (等于 (皮肤, 3))
    赋值 (.选中, 真)
.默认
    
.判断结束
赋值 (临时, 分割文本 (读配置项 (配置文件, “config”, “class”, ), “;”, ))
.如果真 (不等于 (取数组成员数 (临时), 0))
    .计次循环首 (取数组成员数 (临时), i)
        .如果真 (不等于 (临时 [i], “”))
            临时.加入文本 ( [i], #换行符)
        .如果真结束
        ' 本源码来自易语言资源网(www.5A5X.com)
    .计次循环尾 ()
.如果真结束


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 临时, 文本型, , "0", 
.局部变量 结果, 文本型, , , 
.局部变量 I, 整数型, , , 

赋值 (临时, 分割文本 (子文本替换 (.内容, #换行符, “;”, , , 真), “;”, ))
.如果真 (不等于 (取数组成员数 (临时), 0))
    .计次循环首 (取数组成员数 (临时), I)
        .如果真 (不等于 (临时 [I], “”))
            赋值 (结果, 相加 (结果, 临时 [I], “;”))
        .如果真结束
        
    .计次循环尾 ()
.如果真结束
赋值 (结果, 取文本左边 (结果, 相减 (倒找文本 (结果, “;”, , 假), 1)))
.判断开始 (等于 (写配置项 (相加 (取运行目录 (), “\配置.ini”), “config”, “class”, 结果), 真))
    信息框 (“修改种类成功！”, #信息图标, “提示：”)
.默认
    信息框 (“操作失败！”, #警告图标, “失败：”)
.判断结束


.子程序 _按钮2_被单击, 空白型, , 
.判断开始 (等于 (.内容, “”))
    获取焦点 ()
.默认
    .如果真 (等于 (打开 (相加 (取运行目录 (), “\登陆用户.dll”), “userdb”, , , , “yamwfnso”, ), 假))
        信息框 (“程序内部错误，无法打开数据库！请重新启动本软件。”, #错误图标, “失败：”)
        销毁 ()
        结束 ()
    .如果真结束
    到首记录 ()
    .如果真 (等于 (写 (“用户名”, .内容), 真))
        信息框 (“修改用户名成功，重新启动本软件生效！”, #信息图标, “成功：”)
        赋值 (.内容, .内容)
    .如果真结束
    关闭 (“userdb”)
.判断结束


.子程序 _单选框1_被单击, 空白型, , 
未知支持库函数_0 (0)


.子程序 _单选框2_被单击, 空白型, , 
未知支持库函数_0 (1)

.子程序 _单选框3_被单击, 空白型, , 
未知支持库函数_0 (2)

.子程序 _单选框4_被单击, 空白型, , 
未知支持库函数_0 (3)

.子程序 _按钮4_被单击, 空白型, , 
.局部变量 皮肤, 整数型, , , 

.判断开始 (等于 (.选中, 真))
    赋值 (皮肤, 0)
.判断 (等于 (.选中, 真))
    赋值 (皮肤, 1)
.判断 (等于 (.选中, 真))
    赋值 (皮肤, 2)
.判断 (等于 (.选中, 真))
    赋值 (皮肤, 3)
.默认
    
.判断结束

.如果真 (等于 (写配置项 (配置文件, “config”, “skin”, 到文本 (皮肤)), 真))
    信息框 (“皮肤保存成功！”, #信息图标, “成功：”)
.如果真结束


.子程序 _按钮3_被单击, 空白型, , 
.判断开始 (等于 (.内容, “”))
    获取焦点 ()
.判断 (不等于 (.内容, .内容))
    信息框 (“两次输入的密码不一致，请重新输入！”, #信息图标, “提示：”)
    获取焦点 ()
.判断 (等于 (_验证密码 (.内容), 假))
    信息框 (“您输入的原密码不正确，请重新输入！”, #信息图标, “提示：”)
    获取焦点 ()
    赋值 (.被选择字符数, -1)
.默认
    .如果真 (等于 (打开 (相加 (取运行目录 (), “\登陆用户.dll”), “userdb”, , , , “yamwfnso”, ), 假))
        信息框 (“程序内部错误，无法打开数据库！请重新启动本软件。”, #错误图标, “失败：”)
        销毁 ()
        结束 ()
    .如果真结束
    到首记录 ()
    .如果真 (等于 (写 (“密码”, .内容), 真))
        信息框 (“密码修改成功，重启后生效！”, #信息图标, “成功：”)
    .如果真结束
    关闭 (“userdb”)
    
.判断结束


.子程序 _验证密码, 逻辑型, , 
.参数 输入密码, 文本型, , 

.局部变量 结果, 逻辑型, , , 

.如果真 (等于 (打开 (相加 (取运行目录 (), “\登陆用户.dll”), “userdb”, , , , “yamwfnso”, ), 假))
    信息框 (“程序内部错误，无法打开数据库！请重新启动本软件。”, #错误图标, “失败：”)
    销毁 ()
    结束 ()
.如果真结束
到首记录 ()
.判断开始 (等于 (读 (“密码”), 输入密码))
    赋值 (结果, 真)
.默认
    赋值 (结果, 假)
.判断结束
关闭 (“userdb”)
返回 (结果)

.窗口程序集 数据维护窗口_程序集, , , 

.子程序 _数据维护窗口_创建完毕, 空白型, , 
.如果真 (不等于 (寻找文件 (相加 (取运行目录 (), “\bak.yam”), ), “”))
    赋值 (.内容, “发现已有备份”)
    赋值 (.禁止, 假)
.如果真结束
赋值 (数据维护窗口., 相减 (相除 (主窗口..宽度, 2), 相除 (数据维护窗口., 2)))
赋值 (数据维护窗口., 相减 (相除 (主窗口..高度, 2), 相除 (数据维护窗口., 2)))

.子程序 _按钮1_被单击, 空白型, , 
主窗口.未知支持库函数_3 (.)
主窗口.未知支持库函数_16 (.)
.判断开始 (等于 (相加 (取运行目录 (), “\数据库.mdb”).未知支持库函数_0 (相加 (取运行目录 (), “\bak.yam”)), 1))
    .如果真 (等于 (主窗口.未知支持库函数_1 (., 相加 (取运行目录 (), “\数据库.mdb”), “yamwfnmaster”), 假))
        信息框 (“程序错误，无法打开数据库。请联系管理员！”, #错误图标, “失败：”)
        销毁 ()
        结束 ()
    .如果真结束
    主窗口.未知支持库函数_12 (., 主窗口.)
    信息框 (“数据库备份成功！”, #信息图标, “成功：”)
    赋值 (.内容, “发现已有备份”)
    赋值 (.禁止, 假)
.默认
    信息框 (“无法备份数据库，请关闭其它窗口再次备份！”, #错误图标, “失败：”)
.判断结束
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _ZIP压缩1_解压缩进度, 逻辑型, , 
.参数 已完成百分比, 整数型, , 

赋值 (.位置, 已完成百分比)

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _ZIP压缩1_压缩进度, 逻辑型, , 
.参数 已完成百分比, 整数型, , 

赋值 (.位置, 已完成百分比)

.子程序 _按钮3_被单击, 空白型, , 
.如果真 (等于 (信息框 (相加 (“提示：”, #换行符, “  您将对数据库进行恢复，此操作将影响你的数据库数据！如果你不了解些操作的用意，请不要恢复！”, #换行符, “您确定要这么做吗？”), 相加 (#警告图标, #是否钮), “警告：”), #是钮))
    .如果真 (等于 (寻找文件 (相加 (取运行目录 (), “\bak.yam”), ), “”))
        信息框 (相加 (“未发现有备份数据库！或备份不完善，无法恢复！”, #换行符, “请联系管理员！”), #信息图标, “提示：”)
        赋值 (.内容, “未发现有备份数据库，请备份…… ”)
        返回 ()
    .如果真结束
    .如果真 (等于 (主窗口.未知支持库函数_3 (.), 真))
        主窗口.未知支持库函数_16 (.)
        .如果真 (等于 (删除文件 (相加 (取运行目录 (), “\数据库.mdb”)), 真))
            .判断开始 (等于 (相加 (取运行目录 (), “\bak.yam”).未知支持库函数_2 (取运行目录 ()), 1))
                .如果真 (等于 (主窗口.未知支持库函数_1 (., 相加 (取运行目录 (), “\数据库.mdb”), “yamwfnmaster”), 假))
                    信息框 (“程序错误，无法打开数据库。请联系管理员！”, #错误图标, “失败：”)
                    销毁 ()
                    结束 ()
                .如果真结束
                主窗口.未知支持库函数_12 (., 主窗口.)
                信息框 (“数据库恢复完成！”, #信息图标, “成功：”)
            .默认
                信息框 (相加 (“无法恢复备份的数据库，此系统已崩溃！”, #换行符, “  请您联系管理员！”), #错误图标, “致命性错误：”)
                销毁 ()
                结束 ()
            .判断结束
            ' 本源码来自易语言资源网(www.5A5X.com)
        .如果真结束
        
    .如果真结束
    
.如果真结束


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 MDI窗口调整, 窗口, , 设置子窗口在父窗口中的位置  
.参数 MDI子窗口, 窗口, , 子窗口，名字。
.参数 窗口组件, 图片框, , 父窗口，中的组件，此版本只支持图片框。
.参数 是否最大化, 逻辑型, , 子窗口打开后是否为最大化。




 ' 不属于任何一个程序集、类模块的函数：
