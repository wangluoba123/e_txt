 ' 文件类型：Windows模块源码

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假



.常量 常量1, "“528
799
309
78
70
273
24
133
127
160
20
310
307
792
312
71
15
43
132
512
161
274
533
36
561
674
534
3
562
134
6
28
295”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库




数据类型 打开文件名_, , OPENFILENAME
    .成员 结构大小, 整数型, , , lStructSize
    .成员 窗口句柄, 整数型, , , hwndOwner
    .成员 实例句柄, 整数型, , , hInstance
    .成员 过滤器, 字节集, , , lpstrFilter
    .成员 自定义过滤器, 文本型, , , lpstrCustomFilter
    .成员 自定义过滤器最大长度, 整数型, , , nMaxCustFilter
    .成员 过滤器索引, 整数型, , , nFilterIndex
    .成员 文件名, 字节集, , , lpstrFile
    .成员 文件名最大长度, 整数型, , , nMaxFile
    .成员 文件标题, 文本型, , , lpstrFileTitle
    .成员 文件标题最大长度, 整数型, , , nMaxFileTitle
    .成员 初始目录, 文本型, , , lpstrInitialDir
    .成员 标题, 文本型, , , lpstrTitle
    .成员 标志, 整数型, , , flags
    .成员 文件偏移量, 整数型, , , nFileOffset
    .成员 文件扩展名, 文本型, , , nFileExtension
    .成员 默认扩展名, 文本型, , , lpstrDefExt
    .成员 回调函数地址, 子程序指针, , , lCustData
    .成员 自定义数据, 整数型, , , lpfnHook
    .成员 模板名, 文本型, , , lpTemplateName

数据类型 对话框数据, , 
    .成员 程序指针, 子程序指针, , , 
    .成员 窗口句柄, 整数型, , , 
    .成员 返回值, 文本型, , , 
    .成员 标志, 整数型, , , 

数据类型 表项数据, 公开, LVITEM
    .成员 掩码, 整数型, , , 掩码
    .成员 项目, 整数型, , , 项目
    .成员 子项目, 整数型, , , 子项目
    .成员 状态, 整数型, , , 状态
    .成员 状态掩码, 整数型, , , 状态掩码
    .成员 项目文本, 文本型, 传址, , 项目文本
    .成员 项目文本长度, 整数型, , , 项目文本长度
    .成员 图片索引, 整数型, , , 图片索引
    .成员 项目数值, 整数型, , , 项目数值
    .成员 缩进, 整数型, , , 缩进


.DLL命令 打开对话框_, 整数型, "comdlg32.dll", "GetOpenFileNameA", , 
    .参数 OpenFile, 打开文件名_, , 

.DLL命令 取打开文件名_, 整数型, "msvfw32.dll", "GetOpenFileNamePreview", , 
    .参数 格式, 打开文件名_, , 

.DLL命令 改变窗口_, 整数型, "user32.dll", "MoveWindow", , 
    .参数 窗口句柄, 整数型, , hwnd，欲移动窗口的句柄
    .参数 左侧位置, 整数型, , x，窗口新的左侧位置
    .参数 顶部位置, 整数型, , y，窗口新的顶部位置
    .参数 新宽度, 整数型, , nWidth，窗口的新宽度
    .参数 高宽度, 整数型, , nHeight，窗口的高宽度
    .参数 是否重画, 整数型, , bRepaint，如窗口此时应重画，则设为TRUE（非零）

.DLL命令 发送消息_文本, 整数型, "user32", "SendMessageA", , 调用一个窗口的窗口函数，将一条消息发给那个窗口。除非消息处理完毕，否则该函数不会返回。SendMessageBynum， ;    SendMessageByString是该函数的“类型安全”声明形式  由具体的消息决定
    .参数 窗口句柄, 整数型, , 要接收消息的那个窗口的句柄
    .参数 信息值, 整数型, , 消息的标识符
    .参数 参数一, 整数型, , 具体取决于消息
    .参数 参数二, 文本型, , 具体取决于消息;

.DLL命令 获取特别文件夹位置_, 空白型, "", "SHGetSpecialFolderPathA", , 
    .参数 a, 空白型, , 
    .参数 b, 文本型, , 
    .参数 c, 空白型, , 
    .参数 d, 空白型, , 

.DLL命令 寻找子窗口_, 整数型, "user32", "FindWindowExA", , 在窗口列表中寻找与指定条件相符的第一个子窗口  找到的窗口的句柄。如未找到相符窗口，则返回零。会设置GetLastError
    .参数 窗口句柄1, 整数型, , 在其中查找子的父窗口。如设为零，表示使用桌面窗口（通常说的顶级窗口都被认为是桌面的子窗口，所以也会对它们进行查找）
    .参数 窗口句柄2, 整数型, , 从这个窗口后开始查找。这样便可利用对FindWindowEx的多次调用找到符合条件的所有子窗口。如设为零，表示从第一个子窗口开始搜索
    .参数 欲搜索的类名1, 文本型, , 欲搜索的类名。null 表示忽略
    .参数 欲搜索的类名2, 文本型, , 欲搜索的类名。null 表示忽略;

.DLL命令 设置窗口标题_, 整数型, "user32", "SetWindowTextA", , 
    .参数 窗口句柄, 整数型, , 
    .参数 窗口标题, 文本型, , 

.DLL命令 取窗口标题_, 整数型, "user32", "GetWindowTextA", , 取得一个窗体的标题（caption）文字，或者一个控件的内容（在vb里使用：使用vb窗体或控件的caption或text属性）  复制到lpString的字串长度；不包括空中止字符。会设置GetLastError
    .参数 窗口句柄, 整数型, , 欲获取文字的那个窗口的句柄
    .参数 缓冲区, 文本型, , 预定义的一个缓冲区，至少有cch+1个字符大小；随同窗口文字载入
    .参数 缓冲尺寸, 整数型, , lp缓冲区的长度;

.DLL命令 目录是否存在_, 整数型, "shlwapi.dll", "PathIsDirectoryA", , 存在返回真，不存在返回假
    .参数 路径文本, 文本型, , pszPath

.DLL命令 取文件扩展名_, 文本型, "shlwapi.dll", "PathFindExtensionA", , 无扩展名返回空
    .参数 文件路径, 文本型, , pszPath

.DLL命令 发送消息_整数, 整数型, "user32", "SendMessageA", , 调用一个窗口的窗口函数，将一条消息发给那个窗口。除非消息处理完毕，否则该函数不会返回。SendMessageBynum， ;    SendMessageByString是该函数的“类型安全”声明形式  由具体的消息决定
    .参数 窗口句柄, 整数型, , 要接收消息的那个窗口的句柄
    .参数 信息值, 整数型, , 消息的标识符
    .参数 参数一, 整数型, , 具体取决于消息
    .参数 参数二, 整数型, , 具体取决于消息;

.DLL命令 回调函数_指针, 整数型, "", "CallWindowProcA", , 
    .参数 程序指针, 子程序指针, , 
    .参数 窗口句柄, 整数型, , 
    .参数 消息, 整数型, , 
    .参数 参数1, 整数型, , 
    .参数 参数2, 整数型, , 

.DLL命令 取父窗口_, 整数型, "user32", "GetParent", , 判断指定窗口的父窗口  父窗口的句柄。如窗口没有父，或遇到错误，则返回零。会设置GetLastError
    .参数 窗口句柄, 整数型, , 欲测试的窗口的句柄;

.DLL命令 置窗口状态_, 整数型, "", "ShowWindow", , 控制窗口的状态（在vb里使用：针对vb窗体及控件，请使用对应的vb属性） 成功:返回TRUE（非零），失败:返回FALSE（零）
    .参数 hwnd, 整数型, , 窗口句柄，要向这个窗口应用由命令
    .参数 nCmdShow, 整数型, , 0 隐藏  1 还原激活 2 最小化激活 3 最大化激活 4 还原（可视） 5 还原激活 6 最小化 7 最小化 8还原非激活 9 还原激活

.DLL命令 设置窗口信息_指针, 子程序指针, "user32", "SetWindowLongA", , 在窗口结构中为指定的窗口设置信息  指定数据的前一个值
    .参数 窗口句柄, 整数型, , hwnd，欲为其取得信息的窗口的句柄
    .参数 要置的特征, 整数型, , nIndex，请参考GetWindowLong函数的nIndex参数的说明
    .参数 新特征, 子程序指针, , dwNewLong，由nIndex指定的窗口信息的新值

.DLL命令 取内存变量地址_表项数据, 整数型, "kernel32.dll", "lstrcpyn", , 
    .参数 目标, 表项数据, 传址, 
    .参数 源, 表项数据, 传址, 
    .参数 长度, 整数型, , 

.程序集 程序集1, , , 

.程序集变量 对话框返回函数, 子程序指针, , , 
.程序集变量 对话框返回值, 文本型, , , 
.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。
 ' 输出调试文本 (查看字节集_M (到字节集 (“文件夹”)))
载入 (窗口1, , 真)

.子程序 选择文件夹, 文本型, 公开, 取消或目录无效返回空文本,尾部带“\”
.参数 窗口句柄, 整数型, , 
.参数 窗口标题, 文本型, 可空, 对话框窗口标题
.参数 初始路径, 文本型, 可空, 默认从“我的文档”开始。

.局部变量 文件列表, 打开文件名_, , , 

赋值 (文件列表.结构大小, 76)
赋值 (文件列表.窗口句柄, 窗口句柄)
赋值 (文件列表.过滤器, { 206, 196, 188, 254, 188, 208, 0, 42, 46, 46, 0, 0, 0 })
赋值 (文件列表.文件名, 取空白字节集 (128)) ' 文件名缓冲区
赋值 (文件列表.文件名最大长度, 128)
赋值 (文件列表.文件标题最大长度, 128)
.如果真 (是否为空 (初始路径))
    赋值 (初始路径, 取文档位置 ())
.如果真结束
赋值 (文件列表.初始目录, 初始路径)
.如果真 (是否为空 (窗口标题))
    赋值 (文件列表.标题, “选择文件夹”)
.如果真结束
 ' 本源码来自易语言资源网(www.5A5X.com)
赋值 (文件列表.标志, 位或 (524288, 4, 32, 512, 8388608, 256))
赋值 (文件列表.回调函数地址, &对话框消息处理2)
打开对话框_ (文件列表)
.如果真 (不等于 (对话框返回值, “”))
    .如果真 (不等于 (取文本右边 (对话框返回值, 1), “\”))
        赋值 (对话框返回值, 相加 (对话框返回值, “\”))
    .如果真结束
    
.如果真结束
返回 (对话框返回值)

.子程序 对话框消息处理, 整数型, , 不要修改该子程序的返回值及参数的类型！
.参数 窗口句柄, 整数型, , 
.参数 消息, 整数型, , 
.参数 参数1, 整数型, , 热键号
.参数 参数2, 整数型, , 

.局部变量 文件名, 文本型, , , 
.局部变量 变量, 文本型, , , 
.局部变量 超级列表框, 超级列表框类, , , 
.局部变量 局_列表框句柄, 空白型, , , 
.局部变量 局_编辑框, 空白型, , , 
.局部变量 局_路径, 文本型, , , 
.局部变量 null, 文本型, , , 
.局部变量 位置1, 空白型, , , 
.局部变量 位置2, 空白型, , , 

.如果真 (等于 (消息, 1324))
    赋值 (局_列表框句柄, 寻找子窗口_ (窗口句柄, 0, “SHELLDLL_DefView”, null))
    赋值 (局_列表框句柄, 寻找子窗口_ (局_列表框句柄, 0, “SysListView32”, null))
    赋值 (局_编辑框, 寻找子窗口_ (窗口句柄, 0, “Edit”, null))
    .如果真 (不等于 (局_列表框句柄, 0))
        超级列表框.置句柄 (局_列表框句柄)
        赋值 (文件名, 超级列表框.取标题 (超级列表框.现行选中项 (), 0))
        设置窗口标题_ (局_编辑框, 文件名)
        赋值 (变量, 取空白文本 (256))
        发送消息_文本 (窗口句柄, 1126, 256, 变量)
    .如果真结束
    
.如果真结束

.如果真 (等于 (消息, 273))
    .判断开始 (等于 (参数1, 1))
        赋值 (局_编辑框, 寻找子窗口_ (窗口句柄, 0, “Edit”, null))
        赋值 (变量, 取空白文本 (256))
        发送消息_文本 (窗口句柄, 1126, 256, 变量)
        赋值 (变量, 删首尾空 (变量))
        
        .如果 (等于 (变量, “”))
            赋值 (文件名, 取窗口标题 (局_编辑框))
            .如果 (不等于 (目录是否存在_ (文件名), 0))
                赋值 (对话框返回值, 文件名)
            .否则
                .如果 (小于 (取文本长度 (文件名), 4))
                    赋值 (对话框返回值, “”)
                .否则
                    赋值 (位置1, 寻找文本 (文件名, “(”, , 假))
                     ' 本源码来自易语言资源网(www.5A5X.com)
                    .如果 (等于 (位置1, -1))
                        赋值 (对话框返回值, “”)
                    .否则
                        赋值 (位置2, 寻找文本 (文件名, “)”, , 假))
                        .如果 (等于 (位置2, -1))
                            赋值 (对话框返回值, “”)
                        .否则
                            赋值 (对话框返回值, 取文本中间 (文件名, 相加 (位置1, 1), 相减 (位置2, 位置1, 1)))
                            .如果 (并且 (不等于 (取文本右边 (对话框返回值, 1), “\”), 等于 (取文本长度 (对话框返回值), 2)))
                                赋值 (对话框返回值, 相加 (对话框返回值, “\”))
                            .否则
                                赋值 (对话框返回值, “”)
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .否则
            
            .如果 (等于 (取窗口标题 (局_编辑框), “”))
                .如果 (不等于 (目录是否存在_ (变量), 0))
                    赋值 (对话框返回值, 变量)
                .否则
                    赋值 (对话框返回值, “”)
                .如果结束
                
            .否则
                .如果真 (不等于 (取文本右边 (变量, 1), “\”))
                    赋值 (变量, 相加 (变量, “\”))
                .如果真结束
                
                .如果 (不等于 (目录是否存在_ (相加 (变量, 取窗口标题 (局_编辑框))), 0))
                    赋值 (对话框返回值, 相加 (变量, 取窗口标题 (局_编辑框)))
                .否则
                    .如果 (不等于 (取文件扩展名_ (相加 (变量, 取窗口标题 (局_编辑框))), “”))
                        信息框 (“请选择一个文件夹！”, #信息图标, )
                        返回 (0)
                    .否则
                        赋值 (对话框返回值, 变量)
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
        发送消息_整数 (窗口句柄, 273, 2, 2010)
    .判断 (等于 (参数1, 2))
        .如果真 (不等于 (参数2, 2010))
            赋值 (对话框返回值, “”)
        .如果真结束
        
    .默认
        
    .判断结束
    
.如果真结束
返回 (回调函数_指针 (对话框返回函数, 窗口句柄, 消息, 参数1, 参数2)) ' 手动修改 <返回函数> 变量名称,为注册热键时返回的程序指针

.子程序 对话框消息处理2, 空白型, , 不要修改该子程序的返回值及参数的类型！
.参数 窗口句柄, 整数型, , 
.参数 消息, 整数型, , 
.参数 参数1, 整数型, , 热键号
.参数 参数2, 整数型, , 

.局部变量 对话框句柄, 整数型, , , 
.局部变量 局_句柄, 整数型, , , 
.局部变量 局_句柄2, 整数型, , , 
.局部变量 null, 文本型, , , 
.局部变量 标签标题, 文本型, , , 

.如果真 (等于 (消息, 34))
    赋值 (对话框句柄, 取父窗口_ (窗口句柄))
    赋值 (局_句柄, 寻找子窗口_ (对话框句柄, 0, “Static”, null))
    .判断循环首 (不等于 (局_句柄, 0))
        赋值 (标签标题, 取窗口标题 (局_句柄))
        .如果真 (或者 (等于 (标签标题, “文件名(&N):”), 等于 (标签标题, “对象名称(&N):”)))
            设置窗口标题_ (局_句柄, “文件夹:”)
        .如果真结束
        .如果真 (或者 (等于 (标签标题, “文件类型(&T):”), 等于 (标签标题, “对象类型(&T):”)))
            置窗口状态_ (局_句柄, 0)
        .如果真结束
        
        赋值 (局_句柄, 寻找子窗口_ (对话框句柄, 局_句柄, “Static”, null))
    .判断循环尾 ()
    ' 本源码来自易语言资源网(www.5A5X.com)
    赋值 (局_句柄, 寻找子窗口_ (对话框句柄, 0, “ComboBox”, null))
    .判断循环首 (不等于 (局_句柄, 0))
        .如果真 (不等于 (发送消息_文本 (局_句柄, 344, 0, “文件夹”), -1))
            置窗口状态_ (局_句柄, 0)
            跳出循环 ()
        .如果真结束
        赋值 (局_句柄, 寻找子窗口_ (对话框句柄, 局_句柄, “ComboBox”, null))
    .判断循环尾 ()
    
    赋值 (局_句柄, 寻找子窗口_ (对话框句柄, 0, “Button”, null))
    .判断循环首 (不等于 (局_句柄, 0))
        .如果真 (等于 (取窗口标题 (局_句柄), “打开(&O)”))
            设置窗口标题_ (局_句柄, “选择文件夹”)
            跳出循环 ()
        .如果真结束
        赋值 (局_句柄, 寻找子窗口_ (对话框句柄, 局_句柄, “Button”, null))
    .判断循环尾 ()
    赋值 (对话框返回函数, 设置窗口信息_指针 (对话框句柄, -4, &对话框消息处理))
.如果真结束


.子程序 取文档位置, 文本型, , 
.局部变量 文档位置, 文本型, , , 

赋值 (文档位置, 取空白文本 (255))
获取特别文件夹位置_ (0, 文档位置, 5, 0)
返回 (文档位置)

.子程序 取窗口标题, 文本型, , 
.参数 句柄, 空白型, , 

.局部变量 局_缓冲区, 文本型, , , 

赋值 (局_缓冲区, 取空白文本 (255))
取窗口标题_ (句柄, 局_缓冲区, 254)
返回 (局_缓冲区)

.窗口程序集 窗口程序集1, , , 

.子程序 _按钮1_被单击, 空白型, , 
输出调试文本 (选择文件夹 (取窗口句柄 ()))

.类模块 超级列表框类, , , 

.程序集变量 集_列表句柄, 空白型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 取标题, 文本型, 公开, 取指定表项或子项的标题。
.参数 表项索引, 整数型, , 用于指定列表框中的某一项目，索引值从 0 开始。
.参数 列索引, 整数型, 可空, 可以被省略。用作指定报表型列表框中项目所处的列，索引值从 0 开始，如果当前列表框类型不是报表型列表框，提供 0 值即可。如果本参数被省略，默认值为 0 。

.局部变量 项目, 表项数据, , , 
.局部变量 项目地址, 空白型, , , 

赋值 (项目.项目, 表项索引)
赋值 (项目.子项目, 列索引)
赋值 (项目.掩码, 1)
赋值 (项目.项目文本, 取空白文本 (255))
赋值 (项目.项目文本长度, 255)
赋值 (项目地址, 取内存变量地址_表项数据 (项目, 项目, 0))
.判断开始 (不等于 (发送消息_整数 (集_列表句柄, 4101, 0, 项目地址), 0))
    返回 (项目.项目文本)
.默认
    返回 (“”)
.判断结束
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 现行选中项, 整数型, 公开, 
返回 (发送消息_整数 (集_列表句柄, 4108, -1, 2))

.子程序 置句柄, 空白型, 公开, 控制程序中超级列表框
.参数 窗口句柄, 空白型, , 

赋值 (集_列表句柄, 窗口句柄)
' 本源码来自易语言资源网(www.5A5X.com)


 ' 不属于任何一个程序集、类模块的函数：
