 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 631
    高度 = 157
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “主窗口”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “注意：“辅助”方法可以不需调用；“不推荐”方法为异步方法，调用稍复杂，推荐使用同步方法”
    帮助文件名 = “”

窗口 查看或修改用户信息窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 439
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “查看或修改用户信息”
    帮助文件名 = “”

窗口 输入充值信息窗口
    左边 = 50
    顶边 = 50
    宽度 = 330
    高度 = 218
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 输入打码信息窗口
    左边 = 50
    顶边 = 50
    宽度 = 652
    高度 = 399
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “输入打码信息”
    帮助文件名 = “”

窗口 输入窗口打码信息的窗口
    左边 = 50
    顶边 = 50
    宽度 = 505
    高度 = 424
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “输入窗口打码信息”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 2 0 多线程支持库




数据类型 用户信息类型, , 
    .成员 传递类型, 整数型, , , 0 注册用户;1显示用户信息;2修改用户信息
    .成员 数据有效, 逻辑型, , , 
    .成员 用户名, 文本型, , , 
    .成员 密码, 文本型, , , 
    .成员 新密码, 文本型, , , 
    .成员 QQ, 文本型, , , 
    .成员 邮箱, 文本型, , , 
    .成员 电话号码, 文本型, , , 
    .成员 发送模式, 整数型, , , 

数据类型 充值信息类型, , 
    .成员 数据有效, 逻辑型, , , 
    .成员 用户名, 文本型, , , 
    .成员 卡号, 文本型, , , 

数据类型 通过图片地址请求打码数据类型, , 
    .成员 数据有效, 逻辑型, , , 
    .成员 图片URL, 文本型, , , 
    .成员 COOKIE, 文本型, , , 
    .成员 Referer, 文本型, , , 
    .成员 验证码长度, 字节型, , , 0表示不知道长度
    .成员 验证码超时, 短整数型, , , 单位秒
    .成员 验证码类型ID, 整数型, , , 
    .成员 是否可本机下载图片, 整数型, , , 0不从本地下载,1从本机下载

数据类型 窗口区域, , 
    .成员 左, 整数型, , , 
    .成员 上, 整数型, , , 
    .成员 右, 整数型, , , 
    .成员 下, 整数型, , , 

数据类型 通过窗口请求打码数据类型, , 
    .成员 数据有效, 逻辑型, , , 
    .成员 窗口定义串, 文本型, , , 
    .成员 左, 整数型, , , 
    .成员 上, 整数型, , , 
    .成员 宽, 整数型, , , 
    .成员 高, 整数型, , , 
    .成员 验证码长度, 字节型, , , 0表示不知道长度
    .成员 验证码超时, 短整数型, , , 单位秒
    .成员 验证码类型ID, 整数型, , , 

.全局变量 用户信息, 用户信息类型, 公开, , 
.全局变量 充值信息, 充值信息类型, 公开, , 
.全局变量 通过图片地址请求打码信息, 通过图片地址请求打码数据类型, 公开, , 
.全局变量 通过窗口请求打码信息, 通过窗口请求打码数据类型, 公开, , 

.DLL命令 打码兔初始化, 整数型, "CrackCaptchaAPI.dll", "Init", 公开, 
    .参数 软件名, 文本型, , 
    .参数 软件ID, 文本型, , 

.DLL命令 打码兔反初始化, 空白型, "CrackCaptchaAPI.dll", "Uninit", 公开, 

.DLL命令 打码兔登陆, 整数型, "CrackCaptchaAPI.dll", "Login", 公开, 
    .参数 用户名, 文本型, , 
    .参数 密码, 文本型, , 
    .参数 动态验证码, 文本型, , 
    .参数 系统公告, 文本型, 传址, 
    .参数 应用公告, 文本型, 传址, 

.DLL命令 打码兔登出, 整数型, "CrackCaptchaAPI.dll", "Logoff", 公开, 

.DLL命令 打码兔注册, 整数型, "CrackCaptchaAPI.dll", "Register", , 
    .参数 用户名, 文本型, , 
    .参数 密码, 文本型, , 
    .参数 QQ, 文本型, , 
    .参数 电话号码, 文本型, , 
    .参数 邮箱, 文本型, , 
    .参数 动态码发送类型, 整数型, , 

.DLL命令 打码兔一键注册, 整数型, "CrackCaptchaAPI.dll", "D2Register", , 
    .参数 软件KEY, 文本型, , 
    .参数 用户名, 文本型, , 
    .参数 密码, 文本型, , 
    .参数 QQ, 文本型, , 
    .参数 电话号码, 文本型, , 
    .参数 邮箱, 文本型, , 
    .参数 动态码发送类型, 整数型, , 

.DLL命令 打码兔充值, 整数型, "CrackCaptchaAPI.dll", "Recharge", , 
    .参数 用户名, 文本型, , 
    .参数 卡号, 文本型, , 
    .参数 余额, 整数型, 传址, 

.DLL命令 打码兔一键充值, 整数型, "CrackCaptchaAPI.dll", "D2Recharge", , 
    .参数 软件KEY, 文本型, , 
    .参数 用户名, 文本型, , 
    .参数 卡号, 文本型, , 
    .参数 余额, 整数型, 传址, 

.DLL命令 打码兔查询余额, 整数型, "CrackCaptchaAPI.dll", "QueryBalance", , 
    .参数 余额, 整数型, 传址, 

.DLL命令 打码兔一键查询余额, 整数型, "CrackCaptchaAPI.dll", "D2Balance", , 
    .参数 软件KEY, 文本型, , 
    .参数 用户名, 文本型, , 
    .参数 密码, 文本型, , 
    .参数 余额, 整数型, 传址, 

.DLL命令 打码兔请求打码, 整数型, "CrackCaptchaAPI.dll", "Decode", , 
    .参数 图片URL, 文本型, , 
    .参数 COOKIE, 文本型, , 
    .参数 Referer, 文本型, , 
    .参数 验证码长度, 字节型, , 0表示不知道长度
    .参数 验证码超时, 短整数型, , 单位秒
    .参数 验证码类型ID, 整数型, , 
    .参数 是否可本机下载图片, 整数型, , 0不从本地下载,1从本机下载
    .参数 请求码ID, 整数型, 传址, 请求码ID用于调用"得到打码结果"

.DLL命令 打码兔得到打码结果, 整数型, "CrackCaptchaAPI.dll", "GetResult", , 
    .参数 请求ID, 整数型, , 
    .参数 等待超时, 整数型, , 单位毫秒,如果结果未从服务器及时返回,命令等待的时间
    .参数 验证码文本, 文本型, 传址, 
    .参数 验证码文本长度, 整数型, , 传入最大可以写入到验证码文本中的长度
    .参数 验证码ID, 整数型, 传址, 返回的验证码ID用于调用报告正确性
    .参数 返回的COOKIE, 文本型, 传址, 用于返回COOKIE
    .参数 返回COOKIE长度, 整数型, , 传入最大可以写入到返回的COOKIE中的长度

.DLL命令 打码兔报告正确性, 整数型, "CrackCaptchaAPI.dll", "ReportResult", , 
    .参数 验证码ID, 整数型, , 
    .参数 正确否, 整数型, , 

.DLL命令 打码兔通过窗口请求打码, 整数型, "CrackCaptchaAPI.dll", "DecodeWnd", , 
    .参数 窗口定义, 文本型, , 由"\n"分隔的多个子串组成,一个子串表示一级窗口查找的条件.第一级窗口须为顶级窗口
    .参数 窗口区域, 窗口区域, , 
    .参数 验证码长度, 字节型, , 0表示不知道长度
    .参数 验证码超时, 短整数型, , 单位秒
    .参数 验证码类型ID, 整数型, , 
    .参数 请求码ID, 整数型, 传址, 请求码ID用于调用"得到打码结果"

.DLL命令 打码兔通过图片数据请求打码, 整数型, "CrackCaptchaAPI.dll", "DecodeBuf", , 
    .参数 图片数据, 字节集, , 
    .参数 数据长度, 整数型, , 
    .参数 扩展名, 文本型, , 
    .参数 验证码长度, 字节型, , 0表示不知道长度
    .参数 验证码超时, 短整数型, , 单位秒
    .参数 验证码类型ID, 整数型, , 
    .参数 请求码ID, 整数型, 传址, 请求码ID用于调用"得到打码结果"

.DLL命令 打码兔修改信息, 整数型, "CrackCaptchaAPI.dll", "ChangeInfo", , 
    .参数 原密码, 文本型, , 
    .参数 新密码, 文本型, , 
    .参数 QQ, 文本型, , 
    .参数 电话号码, 文本型, , 
    .参数 邮箱, 文本型, , 
    .参数 动态验证码, 文本型, , 可选,无时传空字串
    .参数 动态码发送类型, 整数型, , 

.DLL命令 打码兔读信息, 整数型, "CrackCaptchaAPI.dll", "ReadInfo", , 
    .参数 用户名, 文本型, , 
    .参数 QQ, 文本型, , 
    .参数 电话号码, 文本型, , 
    .参数 邮箱, 文本型, , 
    .参数 动态码发送类型, 整数型, 传址, 

.DLL命令 打码兔请求打码_同步, 整数型, "CrackCaptchaAPI.dll", "DecodeSync", , >0返回验证码ID，用于调用报告结果，<0失败
    .参数 图片URL, 文本型, , 
    .参数 COOKIE, 文本型, , 
    .参数 Referer, 文本型, , 
    .参数 验证码超时, 短整数型, , 单位秒
    .参数 验证码类型ID, 整数型, , 
    .参数 返回的验证码文本, 文本型, 传址, 成功时返回验证码文本
    .参数 返回的Cookie, 文本型, 传址, 成功时返回Cookie，不需要可传NULL

.DLL命令 打码兔通过窗口请求打码_同步, 整数型, "CrackCaptchaAPI.dll", "DecodeWndSync", , >0返回验证码ID，用于调用报告结果，<0失败
    .参数 窗口定义, 文本型, , 由"\n"分隔的多个子串组成,一个子串表示一级窗口查找的条件.第一级窗口须为顶级窗口
    .参数 窗口区域, 窗口区域, , 
    .参数 验证码超时, 短整数型, , 单位秒
    .参数 验证码类型ID, 整数型, , 
    .参数 返回的验证码文本, 文本型, 传址, 成功时返回验证码文本

.DLL命令 打码兔通过图片数据请求打码_同步, 整数型, "CrackCaptchaAPI.dll", "DecodeBufSync", , >0返回验证码ID，用于调用报告结果，<0失败
    .参数 图片数据, 字节集, , 
    .参数 数据长度, 整数型, , 
    .参数 扩展名, 文本型, , 
    .参数 验证码超时, 短整数型, , 单位秒
    .参数 验证码类型ID, 整数型, , 
    .参数 返回的验证码文本, 文本型, 传址, 成功时返回验证码文本

.DLL命令 打码兔通过本地文件请求打码_同步, 整数型, "CrackCaptchaAPI.dll", "DecodeFileSync", , >0返回验证码ID，用于调用报告结果，<0失败
    .参数 本地文件路径, 文本型, , 
    .参数 验证码超时, 短整数型, , 单位秒
    .参数 验证码类型ID, 整数型, , 
    .参数 返回的验证码文本, 文本型, 传址, 成功时返回验证码文本

.DLL命令 打码兔得到原始错误码, 整数型, "CrackCaptchaAPI.dll", "GetOrigError", , 得到原始错误码，用于函数调用发生错误时调用以提供平台开发人员分析原因

.DLL命令 打码兔登陆_简化版, 整数型, "CrackCaptchaAPI.dll", "Login2", 公开, 简单版本登陆命令
    .参数 用户名, 文本型, , 
    .参数 密码, 文本型, , 

.DLL命令 打码兔一键通过本地图片文件名请求打码_同步, 整数型, "CrackCaptchaAPI.dll", "D2File", , >0返回验证码ID，用于调用报告结果，<0失败
    .参数 软件KEY, 文本型, , 
    .参数 用户名, 文本型, , 
    .参数 用户密码, 文本型, , 
    .参数 本地文件路径, 文本型, , 
    .参数 验证码超时, 短整数型, , 单位秒
    .参数 验证码类型ID, 整数型, , 
    .参数 返回的验证码文本, 文本型, 传址, 成功时返回验证码文本

.DLL命令 打码兔一键通过图片数据请求打码_同步, 整数型, "CrackCaptchaAPI.dll", "D2Buf", , >0返回验证码ID，用于调用报告结果，<0失败
    .参数 软件KEY, 文本型, , 
    .参数 用户名, 文本型, , 
    .参数 用户密码, 文本型, , 
    .参数 图片数据, 字节集, , 
    .参数 数据长度, 整数型, , 
    .参数 验证码超时, 短整数型, , 单位秒
    .参数 验证码类型ID, 整数型, , 
    .参数 返回的验证码文本, 文本型, 传址, 成功时返回验证码文本

.窗口程序集 测试主窗口程序集, , , 

.程序集变量 请求ID, 整数型, , , 
.程序集变量 验证码ID, 整数型, , , 
.程序集变量 是否打码完成, 整数型, , , 
.程序集变量 打码兔_答案, 文本型, , , 
.程序集变量 打码兔_错误码, 整数型, , , 
.程序集变量 打码兔_请求码ID, 整数型, , , 
.子程序 _初始化_被单击, 空白型, , 
.局部变量 返回码, 整数型, , , 

 ' 打码兔初始化方法，在所有打码兔方法之前调用，只需要初始化一次即可。
 ' TestSoftware 修改为您自己的软件名，9503ce045ad14d83ea876ab578bd3184 这一串软件KEY请修改为您的软件的KEY
 ' 请先到打码兔网站注册开发者账号（注意，非用户账号），然后登录开发者后台，添加软件，获得软件KEY，具体软件KEY获取方法详见：http://wiki.dama2.com/index.php?n=ApiDoc.GetSoftIDandKEY
 ' 返回码为0表示成功，否则失败，错误码参见：http://wiki.dama2.com/index.php?n=ApiDoc.ErrDef
赋值 (返回码, 打码兔初始化 (“TestSoftware”, “9503ce045ad14d83ea876ab578bd3184”)) ' 打码兔.Init ()
信息框 (相加 (“返回码为”, 数值到格式文本 (返回码, 0, 假)), 0, “初始化”)


.如果 (等于 (返回码, 0))
    赋值 (.可视, 真)
.否则
    
.如果结束



.子程序 _反初始化_被单击, 空白型, , 

 ' 释放资源，可以不需要调用，程序退出自动会释放。
打码兔反初始化 () ' 打码兔.Uninit ()
赋值 (.可视, 假)
赋值 (.可视, 假)


.子程序 _登陆按钮_被单击, 空白型, , 
.局部变量 返回码, 整数型, , , 
.局部变量 系统公告, 文本型, , , 
.局部变量 应用公告, 文本型, , , 

赋值 (系统公告, 取空白文本 (512))
赋值 (应用公告, 取空白文本 (512))

 ' 用户登录打码兔功能，只有登录后才可调用请求识别验证码等功能函数
 ' 参数1 ： 登录用户名
 ' 参数2 ： 登录密码
 ' 参数3 ： 动态验证码，保留字段，填空即可。
 ' 参数4 ： 返回打码兔公告URL地址，如http://www.dama2.com/xxxx，必须分配512空白文本传入
 ' 参数5 ： 软件公告（返回开发者在打码兔网站后台创建或修改软件时填写的公告信息），必须传入512空白文本
 ' 返回码： 0 表示成功 其它表示失败，详见错误码定义：http://wiki.dama2.com/index.php?n=ApiDoc.ErrDef
 ' 注意！！登录用户名和密码请开发者在界面上给出输入框让用户输入，test用户仅限测试，并且有余额限制！

赋值 (返回码, 打码兔登陆 (“test”, “test”, “”, 系统公告, 应用公告))
信息框 (相加 (“返回码为”, 数值到格式文本 (返回码, 0, 假), “; 系统公告=”, 系统公告, “ ;应用公告=”, 应用公告), 0, “登陆结果”)
.如果 (等于 (返回码, 0))
    赋值 (.可视, 真)
.否则
    
.如果结束


.子程序 _登出按钮_被单击, 空白型, , 
.局部变量 返回码, 整数型, , , 


 ' 当前登录用户注销操作
 ' 一般不需要调用该方法，除非有需要切换打码兔用户登录的情况才需要调用。
 ' 返回码为0表示成功，其它参见错误码表
赋值 (返回码, 打码兔登出 ())
信息框 (相加 (“返回码为”, 数值到格式文本 (返回码, 0, 假)), 0, “登出结果”)
赋值 (.可视, 假)



.子程序 _注册按钮_被单击, 空白型, , 
.局部变量 返回码, 整数型, , , 


 ' 赋值 (用户信息.传递类型, 0)
载入 (查看或修改用户信息窗口, _启动窗口, 真)
.如果 (等于 (用户信息.数据有效, 假))
    返回 ()
    
.否则
    
.如果结束

 ' 辅助函数 - 注册打码兔用户
 ' 可选参数： QQ
 ' 必填参数： 用户名、密码、发送模式、电话号码和邮箱中的任意一项
 ' 动态码发送模式参数说明：打码兔为保障用户账号安全，在修改用户任何资料之前，都会要校验动态验证码，动态验证码通过用户的邮箱或手机渠道发送，所以在注册打码兔用户时，邮箱和手机两项必填其一，否则用户将无法注册。
 ' 动态码发送模式分为：
 ' 1、手机接收  （动态码将发送到用户注册时填写的手机）
 ' 2、邮箱接收  （动态码将发到用户注册时填写的邮箱）
 ' 因此，如果参数6的发送模式用户选的是1，则必须保证用户输入了合法的手机号。同理，为2则必须保证用户输入了合法的邮箱。
 ' 返回码：0表示成功，其它表示出错，错误码参见：http://wiki.dama2.com/index.php?n=ApiDoc.ErrDef
赋值 (返回码, 打码兔注册 (用户信息.用户名, 用户信息.密码, 用户信息.QQ, 用户信息.电话号码, 用户信息.邮箱, 用户信息.发送模式))

信息框 (相加 (“返回码为”, 数值到格式文本 (返回码, 0, 假)), 0, “注册用户”)



.子程序 _读取信息按钮_被单击, 空白型, , 
.局部变量 返回码, 整数型, , , 


赋值 (用户信息.用户名, 取空白文本 (100))
赋值 (用户信息.QQ, 取空白文本 (100))
赋值 (用户信息.邮箱, 取空白文本 (100))
赋值 (用户信息.电话号码, 取空白文本 (100))

 ' 辅助函数 - 读取打码兔用户信息
 ' 用途：获取到当前登录的打码兔用户信息
 ' 返回码： 0表示成功 其它表示出错，错误码参见：http://wiki.dama2.com/index.php?n=ApiDoc.ErrDef
赋值 (返回码, 打码兔读信息 (用户信息.用户名, 用户信息.QQ, 用户信息.电话号码, 用户信息.邮箱, 用户信息.发送模式))
赋值 (用户信息.传递类型, 1)

.如果 (等于 (返回码, 0))
    载入 (查看或修改用户信息窗口, _启动窗口, 真)
    
.否则
    信息框 (相加 (“返回码为”, 数值到格式文本 (返回码, 0, 假)), 0, “读取用户信息”)
    
.如果结束




.子程序 _充值按钮_被单击, 空白型, , 
.局部变量 返回码, 整数型, , , 
.局部变量 余额, 整数型, , , 

载入 (输入充值信息窗口, _启动窗口, 真)

 ' 辅助函数：打码兔用户充值
 ' 参数1 ：打码兔用户名（由用户输入）
 ' 参数2 ：充值卡卡号（由用户输入)
 ' 参数3 ：返回用户充值后的余额题分
 ' 返回码： 0表示成功 其它表示出错，错误码参见：http://wiki.dama2.com/index.php?n=ApiDoc.ErrDef
 ' 用户充值来源有二种：1、登录打码兔用户后台，进行在线充值，支持财富通、网银支付等；2、充值卡
 ' 充值卡来源：开发者登录打码兔后台生成充值卡出售给用户。当然前题是开发者需要有足够的余额题分。
.如果真 (等于 (充值信息.数据有效, 假))
    返回 ()
    
.如果真结束
赋值 (返回码, 打码兔充值 (充值信息.用户名, 充值信息.卡号, 余额))
信息框 (相加 (“返回码为”, 数值到格式文本 (返回码, 0, 假), “;余额=”, 数值到格式文本 (余额, 0, 假)), 0, “充值”)





.子程序 _查询余额按钮_被单击, 空白型, , 
.局部变量 返回码, 整数型, , , 
.局部变量 余额, 整数型, , , 


 ' 辅助函数： 查询余额
 ' 参数1 ：返回当前登录用户的余额题分
 ' 返回码： 0表示成功 其它表示出错，错误码参见：http://wiki.dama2.com/index.php?n=ApiDoc.ErrDef

赋值 (返回码, 打码兔查询余额 (余额))
信息框 (相加 (“返回码为”, 数值到格式文本 (返回码, 0, 假), “;余额=”, 数值到格式文本 (余额, 0, 假)), 0, “查询余额”)


.子程序 _请求打码按钮_被单击, 空白型, , 
.局部变量 返回码, 整数型, , , 

载入 (输入打码信息窗口, _启动窗口, 真)

 ' 不推荐使用该类同步函数，推荐使用对应的同步函数
 ' 打码兔请求打码函数同步与异步的定义：同步表示只需要调用打码兔请求识别的同步函数，即可直接返回识别结果。异步表示需要先调用打码兔请求识别函数，成功后再调用取识别结果函数去轮循取识别结果。相对而言同步函数更方便简单

 ' 功能：        请求打码
 ' 函数名：      Decode
 ' 返回值：      0 成功, 其它失败，详见错误码定义 http://wiki.dama2.com/index.php?n=ApiDoc.ErrDef
 ' 参数：
 ' [in]pszFileURL - 验证码图片URL，最长511
 ' [in]pszCookie - 获取验证码所需Cookie，最长4095字节
 ' [in]pszReferer - 获取验证码所需Referer，最长511字节
 ' [in]ucVerificationCodeLen - 验证码长度，传入正确的验证码长度，将优先被识别。如果长度不定，可传0
 ' [in]usTimeout - 验证码超时时间，即过多久验证码将失效。单位秒。推荐120
 ' [in]ulVCodeTypeID - 验证码类型ID，开发者根据验证码类型在类型表中找到对应的ID： http://wiki.dama2.com/index.php?n=ApiDoc.GetSoftIDandKEY
 ' [in]bDownloadPictureByLocalMachine - 是否本机下载，因为有些验证码绑定IP，不允许远程获取，如果此标志为TRUE，则打码兔控件将在您机器上自动下载图片并上传。 对于没有此限制的验证码，将会由打码用户端下载，效率更高！建议填FALSE
 ' [out]pulRequestID - 返回请求ID，为后面的GetResult取打码结果所用。

.如果真 (等于 (通过图片地址请求打码信息.数据有效, 假))
    返回 ()
    
.如果真结束
赋值 (返回码, 打码兔请求打码 (通过图片地址请求打码信息.图片URL, 通过图片地址请求打码信息.COOKIE, 通过图片地址请求打码信息.Referer, 通过图片地址请求打码信息.验证码长度, 通过图片地址请求打码信息.验证码超时, 通过图片地址请求打码信息.验证码类型ID, 通过图片地址请求打码信息.是否可本机下载图片, 请求ID))
信息框 (相加 (“返回码为”, 数值到格式文本 (返回码, 0, 假), “ ;请求ID=”, 数值到格式文本 (请求ID, 0, 假)), 0, “请求打码”)




.子程序 _得到打码结果按钮_被单击, 空白型, , 
.局部变量 返回码, 整数型, , , 
.局部变量 验证码文本, 文本型, , , 
.局部变量 返回的COOKIE, 文本型, , , 

赋值 (验证码文本, 取空白文本 (40))
赋值 (返回的COOKIE, 取空白文本 (4096))

赋值 (验证码ID, 0)

 ' 异步请求识别验证码取结果
 ' 该函数在非同步请求识别验证码时使用，同步请求识别验证码时，不需要使用该函数
 ' 参数1 - 请求ID，是请求识别验证码时通过参数返回的。
 ' 参数2 - 超时时间，毫秒为单位
 ' 参数3 - 返回的验证码结果,使用长度为40的缓冲区
 ' 参数4 - 验证码长度，即字符长度，如果不能确定请填0
 ' 参数5 - 验证码ID，请保存该值，当验证码识别结果不符时，使用报告正确性方法报告错误
 ' 参数6 - 返回的COOKIE，像Q码，请求图片是会返回一串COOKIE的，通过这个参数接收
 ' 参数7 - 接收COOKIE的缓冲区大小，即返回的COOKIE的大小，推荐使用上面定义的是4096，
 ' 返回码： 0- 成功；  -205 暂时没有打码结果，请循环调用打码兔得到结果，直到您认为时间太长超时放弃；  其它错误请参见：http://wiki.dama2.com/index.php?n=ApiDoc.ErrDef
赋值 (返回码, 打码兔得到打码结果 (请求ID, 5000, 验证码文本, 40, 验证码ID, 返回的COOKIE, 4096))

信息框 (相加 (“返回码为”, 数值到格式文本 (返回码, 0, 假), “ ;验证码文本=”, 验证码文本, “ ;验证码ID=”, 数值到格式文本 (验证码ID, 0, 假)), 0, “得到打码结果”)


.子程序 _上报正确性按钮_被单击, 空白型, , 
.局部变量 验证码正确, 整数型, , , 
.局部变量 返回码, 整数型, , , 


赋值 (返回码, 信息框 (“验证码是否正确”, 4, “上报正确性”))

.如果 (等于 (返回码, 5))
    赋值 (验证码正确, 1)
.否则
    赋值 (验证码正确, 0)
.如果结束


 ' 当验证码识别结果与实际不符时，请调用本函数报错，平台将返还用户题分。切勿误报乱报，严重者将冻结开发者账号！
 ' 验证码ID参数： 填写打码兔得到打码结果时获取到的验证码ID
 ' 验证码正确参数：1 正确 0 错误
 ' 返回码：0 成功 其它错误参见：http://wiki.dama2.com/index.php?n=ApiDoc.ErrDef
 ' 注意：正确不需要调用该方法，验证码识别结果不符才调用。
赋值 (返回码, 打码兔报告正确性 (验证码ID, 验证码正确))

信息框 (相加 (“返回码为”, 数值到格式文本 (返回码, 0, 假), “ ;验证码ID=”, 数值到格式文本 (验证码ID, 0, 假)), 0, “上报正确性”)


.子程序 _通过窗口请求打码按钮_被单击, 空白型, , 
.局部变量 窗口区域1, 窗口区域, , , 
.局部变量 返回码, 整数型, , , 

载入 (输入窗口打码信息的窗口, _启动窗口, 真)
.如果真 (等于 (通过窗口请求打码信息.数据有效, 假))
    返回 ()
    
.如果真结束
赋值 (窗口区域1.左, 通过窗口请求打码信息.左)
赋值 (窗口区域1.上, 通过窗口请求打码信息.上)
赋值 (窗口区域1.右, 相加 (通过窗口请求打码信息.左, 通过窗口请求打码信息.宽))
赋值 (窗口区域1.下, 相加 (通过窗口请求打码信息.上, 通过窗口请求打码信息.高))


 ' 辅助函数 - 异步请求类 - 通过窗口截图请求识别验证码 不建议使用，推荐使用对应的同步函数
 ' 返回值：      0 成功, 其它失败，详见错误码定义
 ' 参数：
 ' 参数1 - 窗口定义字串，详见下面描述
 ' 参数2 - 要截取的窗口内容矩形(相对于窗口最左上角),NULL表示截取整个窗口内容
 ' 参数3- 验证码长度，传入正确的验证码长度，将优先被识别。如果长度不定，可传0
 ' 参数4 - 验证码超时时间，即过多久验证码将失效。单位秒。推荐120
 ' 参数5 - 验证码类型ID，开发者根据验证码类型在类型表中找到对应的ID： http://wiki.dama2.com/index.php?n=ApiDoc.GetSoftIDandKEY
 ' 参数6 - 返回请求ID，为后面的“打码兔得到打码结果”所用。
 ' 返回码 0 成功 其它表示出错，错误码详见：http://wiki.dama2.com/index.php?n=ApiDoc.ErrDef

 ' 窗口定义字串,格式如下:
 ' 由"\n"分隔的多个子串组成,一个子串表示一级窗口查找的条件.第一级窗口须为顶级窗口
 ' 每个子串由3个元素组成:窗口Class名,窗口名,窗口索引.元素之间以逗号(半角)分隔
 ' 窗口类名:如不想通过类名查找,填"ANY_CLASS"
 ' 窗口名:窗口的名字,如没有窗口名,填"ANY_NAME"
 ' 序号:以1开始数字,1表示第1个窗口名和窗口类名符合的窗口,
 ' 如序号不为1,则依次查找符合条件和序号的窗口
 ' 窗口级最大为50级
 ' 如要查找要查找第一个类名为"TopClass"窗口名不限的第二子窗口(类名和类名都不限),
 ' 字串如下:
 ' TopClass,ANY_NAME,1\nANY_CLASS,ANY_NAME,2

赋值 (返回码, 打码兔通过窗口请求打码 (通过窗口请求打码信息.窗口定义串, 窗口区域1, 通过窗口请求打码信息.验证码长度, 通过窗口请求打码信息.验证码超时, 通过窗口请求打码信息.验证码类型ID, 请求ID))
信息框 (相加 (“返回码为”, 数值到格式文本 (返回码, 0, 假), “ ;请求ID=”, 数值到格式文本 (请求ID, 0, 假)), 0, “通过窗口请求打码”)



.子程序 _通过图片数据请求打码按钮_被单击, 空白型, , 
.局部变量 返回码, 整数型, , , 


 ' /**
 ' 功能：        异步请求打码，不推荐使用，推荐使用同类型的同步打码函数
 ' 函数名：      打码兔通过图片数据请求打码
 ' 返回码：      0 成功, 其它失败，详见错误码定义 http://wiki.dama2.com/index.php?n=ApiDoc.ErrDef
 ' 参数：        [
 ' 参数1 - 验证码图片数据 （此处也可直接填写文本，如：3+8+3=？或 中国的首都是哪里？ 但注意pszExtName就得固定填写"TXT"。）
 ' 参数2 - 验证码图片数据或验证码文本数据长度，即l图片字节集大小，限制4M
 ' 参数3 - 图片扩展名，如JPG、BMP、PNG、GIF，不知道也可直接填写JPG （如果图片字节集不是图片数据而是文本，则填写"TXT"。）
 ' 参数4 - 验证码长度，传入正确的验证码长度，将优先被识别。如果长度不定，可传0
 ' 参数5 - 验证码超时时间，即过多久验证码将失效。单位秒。推荐120
 ' 参数6 - 验证码类型ID，开发者根据验证码类型在类型表中找到对应的ID： http://wiki.dama2.com/index.php?n=ApiDoc.GetSoftIDandKEY
 ' 参数7 - 返回请求ID，为后面的GetResult取打码结果所用。
 ' */

赋值 (返回码, 打码兔通过图片数据请求打码 (到字节集 (“1+1=?”), 5, “txt”, 4, 120, 327, 请求ID))
信息框 (相加 (“返回码为”, 数值到格式文本 (返回码, 0, 假), “ ;请求ID=”, 数值到格式文本 (请求ID, 0, 假)), 0, “通过图片数据请求打码”)


.子程序 _修改信息按钮_被单击, 空白型, , 
.局部变量 返回码, 整数型, , , 
.局部变量 动态验证码, 文本型, , , 

赋值 (用户信息.用户名, 取空白文本 (40))
赋值 (用户信息.QQ, 取空白文本 (40))
赋值 (用户信息.邮箱, 取空白文本 (100))
赋值 (用户信息.电话号码, 取空白文本 (100))




 ' 功能：        修改用户信息
 ' 流程：
 ' 1、先读取用户信息；
 ' 2、用户修改信息；
 ' 3、第一次提交时，动态验证码为空，函数将返回-112；
 ' 4、开发者应该提示让用户输入动态验证码；
 ' 5、输入完后再次附上动态验证码提交。

 ' 函数名：      打码兔修改信息
 ' 返回值：      0 成功, 其它失败，详见错误码定义 http://wiki.dama2.com/index.php?n=ApiDoc.ErrDef
 ' 参数：
 ' pUserOldPassword - 旧密码，最大16字节
 ' pUserNewPassword - 新密码，最大16字节
 ' pszQQ - QQ号码，可为空，最大16字节
 ' pszTelNo - 手机号码，最大16字节，如果动态码发送方式为1或3，手机号则必填
 ' pszEmail - 邮箱，最大48字节，如果动态码发送方式为2或3，则邮箱必填
 ' pszDyncVCode - 动态验证码，第一次调用可传NULL，当有动态验证码后，填入用户输入的动态码再次调用。
 ' nDyncSendMode - 动态码发送方式，1手机 2邮箱 3手机加邮箱
 ' 动态码发送模式参数说明：打码兔为保障用户账号安全，在修改用户任何资料之前，都会要校验动态验证码，动态验证码通过用户的邮箱或手机渠道发送，所以在注册打码兔用户时，邮箱和手机两项必填其一，否则用户将无法注册。
 ' 动态码发送模式分为：
 ' 1、手机接收  （动态码将发送到用户注册时填写的手机）
 ' 2、邮箱接收  （动态码将发到用户注册时填写的邮箱）
 ' 因此，如果参数6的发送模式用户选的是1，则必须保证用户输入了合法的手机号。同理，为2则必须保证用户输入了合法的邮箱。

赋值 (返回码, 打码兔读信息 (用户信息.用户名, 用户信息.QQ, 用户信息.电话号码, 用户信息.邮箱, 用户信息.发送模式))
赋值 (用户信息.传递类型, 3)
赋值 (用户信息.密码, “”)

 ' 如果信息读取错误直接返回
.如果真 (不等于 (返回码, 0))
    信息框 (相加 (“返回码为”, 数值到格式文本 (返回码, 0, 假)), 0, “读取用户信息”)
    返回 ()
    
.如果真结束

 ' 显示窗口让用户修改信息
载入 (查看或修改用户信息窗口, _启动窗口, 真)
.如果真 (等于 (用户信息.数据有效, 假))
    返回 ()
    
.如果真结束

赋值 (动态验证码, “”)
.判断循环首 (真)
    
     ' 提交信息修改请求
    
    赋值 (返回码, 打码兔修改信息 (用户信息.密码, 用户信息.新密码, 用户信息.QQ, 用户信息.电话号码, 用户信息.邮箱, 动态验证码, 用户信息.发送模式))
    .如果真 (不等于 (返回码, -112)) ' 需要动态验证码
        信息框 (相加 (“返回码为”, 数值到格式文本 (返回码, 0, 假)), 0, “修改用户信息”)
        返回 ()
        
    .如果真结束
     ' 输入动态验证码
    .如果真 (等于 (输入框 (“输入动态验证码(动态验证码已发送到你的手机或邮箱：)”, “修改用户信息”, “”, 动态验证码, 1), 假))
        返回 ()
    .如果真结束
    
    
.判断循环尾 ()



.子程序 _同步请求打码按钮_被单击, 空白型, , 
.局部变量 返回的Cookie, 文本型, , , 
.局部变量 返回的验证码文本, 文本型, , , 
.局部变量 返回码, 整数型, , , 

载入 (输入打码信息窗口, _启动窗口, 真)
.如果真 (等于 (通过图片地址请求打码信息.数据有效, 假))
    返回 ()
    
.如果真结束
赋值 (返回的Cookie, 取空白文本 (4096))
赋值 (返回的验证码文本, 取空白文本 (40))

 ' 功能：        同步通过传入图片URL地址请求打码，推荐使用
 ' 函数名：      DecodeSync
 ' 返回值：      > 0 成功，返回验证码ID（用于调用报告正确性）, 不会等于0。　< 0 失败，详见错误码定义 http://wiki.dama2.com/index.php?n=ApiDoc.ErrDef
 ' 参数：
 ' [in]pszFileURL - 验证码图片URL，最长511
 ' [in]pszCookie - 获取验证码所需Cookie，最长4095字节
 ' [in]pszReferer - 获取验证码所需Referer，最长511字节
 ' [in]usTimeout - 验证码超时时间，即过多久验证码将失效。单位秒。推荐60
 ' [in]ulVCodeTypeID - 验证码类型ID，开发者根据验证码类型在类型表中找到对应的ID： http://wiki.dama2.com/index.php?n=ApiDoc.GetSoftIDandKEY
 ' [out]pszVCodeText - 返回验证码结果字符，建议传入40字节缓冲区
 ' [out]pszRetCookie - 返回COOKIE，建议传入4096字节缓冲区。

赋值 (返回码, 打码兔请求打码_同步 (通过图片地址请求打码信息.图片URL, 通过图片地址请求打码信息.COOKIE, 通过图片地址请求打码信息.Referer, 通过图片地址请求打码信息.验证码超时, 通过图片地址请求打码信息.验证码类型ID, 返回的验证码文本, 返回的Cookie))

.如果 (大于或等于 (返回码, 0))
    赋值 (验证码ID, 返回码)
    信息框 (相加 (“请求打码成功：验证码ID=”, 数值到格式文本 (返回码, 0, 假), “ ;返回验证码文本=”, 返回的验证码文本), 0, “请求打码”)
    
.否则
    信息框 (相加 (“请求打码失败：返回码=”, 数值到格式文本 (返回码, 0, 假)), 0, “请求打码”)
.如果结束



.子程序 _同步通过窗口请求打码按钮_被单击, 空白型, , 
.局部变量 返回的验证码文本, 文本型, , , 
.局部变量 窗口区域1, 窗口区域, , , 
.局部变量 返回码, 整数型, , , 

载入 (输入窗口打码信息的窗口, _启动窗口, 真)
.如果真 (等于 (通过窗口请求打码信息.数据有效, 假))
    返回 ()
    
.如果真结束
赋值 (窗口区域1.左, 通过窗口请求打码信息.左)
赋值 (窗口区域1.上, 通过窗口请求打码信息.上)
赋值 (窗口区域1.右, 相加 (通过窗口请求打码信息.左, 通过窗口请求打码信息.宽))
赋值 (窗口区域1.下, 相加 (通过窗口请求打码信息.上, 通过窗口请求打码信息.高))

赋值 (返回的验证码文本, 取空白文本 (40))

 ' 功能：        通过窗口截图请求打码 ， 同步函数，推荐！
 ' 函数名：      DecodeWndSync
 ' 返回值：      > 0 成功，返回验证码ID（用于调用ReportResult）, < 0失败，详见错误码定义 http://wiki.dama2.com/index.php?n=ApiDoc.ErrDef   不会有等于0的情况
 ' 参数：
 ' [in]pszWndDef - 窗口定义字串，详见下面描述
 ' [in]lpRect - 要截取的窗口内容矩形(相对于窗口最左上角),NULL表示截取整个窗口内容
 ' [in]usTimeout - 验证码超时时间，即过多久验证码将失效。单位秒。推荐60
 ' [in]ulVCodeTypeID - 验证码类型ID，开发者根据验证码类型在类型表中找到对应的ID： http://wiki.dama2.com/index.php?n=ApiDoc.GetSoftIDandKEY
 ' [out]pszVCodeText - 返回验证码结果字符，建议传入30字节缓冲区

 ' 窗口定义字串,格式如下:
 ' 由"\n"分隔的多个子串组成,一个子串表示一级窗口查找的条件.第一级窗口须为顶级窗口
 ' 每个子串由3个元素组成:窗口Class名,窗口名,窗口索引.元素之间以逗号(半角)分隔
 ' 窗口类名:如不想通过类名查找,填"ANY_CLASS"
 ' 窗口名:窗口的名字,如没有窗口名,填"ANY_NAME"
 ' 序号:以1开始数字,1表示第1个窗口名和窗口类名符合的窗口,
 ' 如序号不为1,则依次查找符合条件和序号的窗口
 ' 窗口级最大为50级
 ' 如要查找要查找第一个类名为"TopClass"窗口名不限的第二子窗口(类名和类名都不限),
 ' 字串如下:
 ' TopClass,ANY_NAME,1\nANY_CLASS,ANY_NAME,2

赋值 (返回码, 打码兔通过窗口请求打码_同步 (通过窗口请求打码信息.窗口定义串, 窗口区域1, 通过窗口请求打码信息.验证码超时, 通过窗口请求打码信息.验证码类型ID, 返回的验证码文本))

.如果 (大于或等于 (返回码, 0))
    赋值 (验证码ID, 返回码)
    信息框 (相加 (“请求打码成功：验证码ID=”, 数值到格式文本 (返回码, 0, 假), “ ;返回验证码文本=”, 返回的验证码文本), 0, “通过窗口请求打码”)
    
.否则
    信息框 (相加 (“请求打码失败：返回码=”, 数值到格式文本 (返回码, 0, 假)), 0, “通过窗口请求打码”)
.如果结束


.子程序 _同步通过图片数据请求打码按钮_被单击, 空白型, , 
.局部变量 返回码, 整数型, , , 
.局部变量 返回的验证码文本, 文本型, , , 
.局部变量 图片数据, 字节集, , , 
.局部变量 图片长度, 整数型, , , 


赋值 (返回的验证码文本, 取空白文本 (40))

 ' 赋值 (图片数据, 读入文件 (“1.bmp”))
赋值 (图片长度, 取字节集长度 (图片数据))


 ' 功能：        通过传入图片字节集同步请求打码，推荐使用！
 ' 函数名：      打码兔通过图片数据请求打码_同步
 ' 返回值：      > 0  成功，返回验证码ID（用于调用ReportResult）, <0失败，详见错误码定义 http://wiki.dama2.com/index.php?n=ApiDoc.ErrDef  没有等于0的情况
 ' 参数：
 ' [in]pImageData - 验证码图片数据 （此处也可直接填写文本，如：3+8+3=？或 中国的首都是哪里？ 但注意pszExtName就得固定填写"TXT"。）
 ' [in]dwDataLen - 验证码图片数据或验证码文本数据长度，即pImageData大小，限制4M
 ' [in]pszExtName - 图片扩展名，如JPG、BMP、PNG、GIF，不知道图片类型，填JPG即可。（如果pImageData不是图片数据而是文本，则填写"TXT"。）
 ' [in]usTimeout - 验证码超时时间，即过多久验证码将失效。单位秒。推荐60
 ' [in]ulVCodeTypeID - 验证码类型ID，开发者根据验证码类型在类型表中找到对应的ID： http://wiki.dama2.com/index.php?n=ApiDoc.GetSoftIDandKEY
 ' [out]pszVCodeText - 返回验证码结果字符，建议传入40字节缓冲区

赋值 (返回码, 打码兔通过图片数据请求打码_同步 (图片数据, 图片长度, “bmp”, 60, 327, 返回的验证码文本))
.如果 (大于或等于 (返回码, 0))
    赋值 (验证码ID, 返回码)
    信息框 (相加 (“请求打码成功：验证码ID=”, 数值到格式文本 (返回码, 0, 假), “ ;返回验证码文本=”, 返回的验证码文本), 0, “通过图片数据请求打码”)
    
.否则
    信息框 (相加 (“请求打码失败：返回码=”, 数值到格式文本 (返回码, 0, 假)), 0, “通过图片数据请求打码”)
.如果结束


.子程序 _同步通过本地文件名请求打码按钮_被单击, 空白型, , 
.局部变量 返回码, 整数型, , , 
.局部变量 返回的验证码文本, 文本型, , , 

 ' 多文件对话框 (“选择图片文件”, “image file|*.jpg,*.jpeg,*.bmp,*.png||”, 0, , 真)
赋值 (返回的验证码文本, 取空白文本 (40))


 ' 功能：        请求打码
 ' 函数名：      DecodeFileSync
 ' 返回值：      >0 成功，返回验证码ID（用于调用ReportResult）, <0失败，详见错误码定义 http://wiki.dama2.com/index.php?n=ApiDoc.ErrDef
 ' 参数：
 ' [in]pszFilePath - 验证码文件全路径，如c:\1.jpg
 ' [in]usTimeout - 验证码超时时间，即过多久验证码将失效。单位秒。推荐60
 ' [in]ulVCodeTypeID - 验证码类型ID，开发者根据验证码类型在类型表中找到对应的ID： http://wiki.dama2.com/index.php?n=ApiDoc.GetSoftIDandKEY
 ' [out]pszVCodeText - 返回验证码结果字符，建议传入40字节缓冲区

赋值 (返回码, 打码兔通过本地文件请求打码_同步 (“1.bmp”, 20, 327, 返回的验证码文本))

.如果 (大于或等于 (返回码, 0))
    赋值 (验证码ID, 返回码)
    信息框 (相加 (“请求打码成功：验证码ID=”, 数值到格式文本 (返回码, 0, 假), “ ;返回验证码文本=”, 返回的验证码文本), 0, “通过图片数据请求打码”)
    
.否则
    信息框 (相加 (“请求打码失败：返回码=”, 数值到格式文本 (返回码, 0, 假)), 0, “通过图片数据请求打码”)
.如果结束



.子程序 _一键通过图片文件名请求打码按钮_被单击, 空白型, , 
.局部变量 返回码, 整数型, , , 
.局部变量 返回的验证码文本, 文本型, , , 
.局部变量 软件Key, 文本型, , , 
.局部变量 用户名, 文本型, , , 
.局部变量 用户密码, 文本型, , , 
.局部变量 超时时间, 整数型, , , 
.局部变量 验证码类型ID, 整数型, , , 
.局部变量 图片文件名, 文本型, , , 


赋值 (返回的验证码文本, 取空白文本 (60))


 ' 功能：        一键通过图片文件名同步请求打码，推荐使用！
 ' 函数名：      打码兔一键图片文件名请求打码_同步
 ' 返回值：      > 0  成功，返回验证码ID（用于调用ReportResult）, <0失败，详见错误码定义 http://wiki.dama2.com/index.php?n=ApiDoc.ErrDef  没有等于0的情况
 ' 应该停机处理的错误码包括：-1~-199（参数错误、用户错误）、-208（软件禁用）、-210（非法用户）、-301（配置错误、DLL找不到）
 ' 参数：
 ' [in]pszSoftwareKey - 软件KEY
 ' [in]pszUserName - 用户名
 ' [in]pszUserPassword - 用户密码
 ' [in]szFileName - 验证码图片文件名
 ' [in]usTimeout - 验证码超时时间，即过多久验证码将失效。单位秒。推荐60
 ' [in]ulVCodeTypeID - 验证码类型ID，开发者根据验证码类型在类型表中找到对应的ID： http://wiki.dama2.com/index.php?n=ApiDoc.GetSoftIDandKEY
 ' [out]pszVCodeText - 返回验证码结果字符，建议传入40字节缓冲区
赋值 (软件Key, “9503ce045ad14d83ea876ab578bd3184”)
赋值 (用户名, “test”)
赋值 (用户密码, “test”)
赋值 (图片文件名, “1.bmp”)
赋值 (超时时间, 30) ' 单位秒
赋值 (验证码类型ID, 4)

赋值 (返回码, 打码兔一键通过本地图片文件名请求打码_同步 (软件Key, 用户名, 用户密码, 图片文件名, 超时时间, 验证码类型ID, 返回的验证码文本))
.如果 (大于或等于 (返回码, 0))
    赋值 (验证码ID, 返回码)
    信息框 (相加 (“请求打码成功：验证码ID=”, 数值到格式文本 (返回码, 0, 假), “ ;返回验证码文本=”, 返回的验证码文本), 0, “一键通过图片数据请求打码”)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    
    
.否则
    信息框 (相加 (“请求打码失败：返回码=”, 数值到格式文本 (返回码, 0, 假)), 0, “一键通过图片数据请求打码”)
.如果结束






.子程序 _一键通过图片数据请求打码按钮_被单击, 空白型, , 
.局部变量 返回码, 整数型, , , 
.局部变量 返回的验证码文本, 文本型, , , 
.局部变量 图片数据, 字节集, , , 
.局部变量 图片长度, 整数型, , , 
.局部变量 软件Key, 文本型, , , 
.局部变量 用户名, 文本型, , , 
.局部变量 用户密码, 文本型, , , 
.局部变量 超时时间, 整数型, , , 
.局部变量 验证码类型ID, 整数型, , , 


赋值 (返回的验证码文本, 取空白文本 (60))

赋值 (图片数据, 读入文件 (“1.bmp”))
赋值 (图片长度, 取字节集长度 (图片数据))


 ' 功能：        一键通过传入图片字节集同步请求打码，推荐使用！
 ' 函数名：      打码兔一键通过图片数据请求打码_同步
 ' 返回值：      > 0  成功，返回验证码ID（用于调用ReportResult）, <0失败，详见错误码定义 http://wiki.dama2.com/index.php?n=ApiDoc.ErrDef  没有等于0的情况
 ' 应该停机处理的错误码包括：-1~-199（参数错误、用户错误）、-208（软件禁用）、-210（非法用户）、-301（配置错误、DLL找不到）
 ' 参数：
 ' [in]pszSoftwareKey - 软件KEY
 ' [in]pszUserName - 用户名
 ' [in]pszUserPassword - 用户密码
 ' [in]pImageData - 验证码图片数据 （此处也可直接填写文本，如：3+8+3=？或 中国的首都是哪里？ 但注意pszExtName就得固定填写"TXT"。）
 ' [in]dwDataLen - 验证码图片数据或验证码文本数据长度，即pImageData大小，限制4M
 ' [in]usTimeout - 验证码超时时间，即过多久验证码将失效。单位秒。推荐60
 ' [in]ulVCodeTypeID - 验证码类型ID，开发者根据验证码类型在类型表中找到对应的ID： http://wiki.dama2.com/index.php?n=ApiDoc.GetSoftIDandKEY
 ' [out]pszVCodeText - 返回验证码结果字符，建议传入40字节缓冲区
赋值 (软件Key, “9503ce045ad14d83ea876ab578bd3184”)
赋值 (用户名, “test”)
赋值 (用户密码, “test”)
赋值 (超时时间, 30) ' 单位秒
赋值 (验证码类型ID, 4)

赋值 (返回码, 打码兔一键通过图片数据请求打码_同步 (软件Key, 用户名, 用户密码, 图片数据, 图片长度, 超时时间, 验证码类型ID, 返回的验证码文本))
.如果 (大于或等于 (返回码, 0))
    赋值 (验证码ID, 返回码)
    信息框 (相加 (“请求打码成功：验证码ID=”, 数值到格式文本 (返回码, 0, 假), “ ;返回验证码文本=”, 返回的验证码文本), 0, “一键通过图片数据请求打码”)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    
    
.否则
    信息框 (相加 (“请求打码失败：返回码=”, 数值到格式文本 (返回码, 0, 假)), 0, “一键通过图片数据请求打码”)
.如果结束


.子程序 _按钮_D2Balance_被单击, 空白型, , 
.局部变量 返回码, 整数型, , , 
.局部变量 用户名, 文本型, , , 
.局部变量 余额, 整数型, , , 
.局部变量 软件Key, 文本型, , , 
.局部变量 密码, 文本型, , , 



赋值 (软件Key, “9503ce045ad14d83ea876ab578bd3184”)
赋值 (用户名, “test”)
赋值 (密码, “test”)

赋值 (余额, 0)
赋值 (返回码, 打码兔一键查询余额 (软件Key, 用户名, 密码, 余额))
.如果 (等于 (返回码, 0))
    信息框 (相加 (“查询余额成功，余额：”, 数值到格式文本 (余额, 0, 假)), 0, “一键查询余额”)
.否则
    信息框 (相加 (“查询余额失败，返回码=”, 数值到格式文本 (返回码, 0, 假)), 0, “一键查询余额”)
    
.如果结束


.子程序 _按钮_D2Recharge_被单击, 空白型, , 
.局部变量 软件Key, 文本型, , , 
.局部变量 用户名, 文本型, , , 
.局部变量 卡号, 文本型, , , 
.局部变量 余额, 整数型, , , 
.局部变量 返回码, 整数型, , , 

赋值 (软件Key, “9503ce045ad14d83ea876ab578bd3184”)
赋值 (用户名, “test”)
赋值 (卡号, “”)

.如果 (等于 (输入框 (“卡号”, “请输入充值信息”, “”, 卡号, 1), 真))
    赋值 (返回码, 打码兔一键充值 (软件Key, 用户名, 卡号, 余额))
    .如果 (等于 (返回码, 0))
        信息框 (相加 (“充值成功，余额为：”, 到文本 (余额)), 0, “成功”)
    .否则
        信息框 (相加 (“充值失败，错误码：”, 到文本 (返回码)), 0, “失败”)
    .如果结束
    
.否则
    
.如果结束


.子程序 _按钮_D2Register_被单击, 空白型, , 
.局部变量 软件Key, 文本型, , , 
.局部变量 返回码, 整数型, , , 

赋值 (软件Key, “9503ce045ad14d83ea876ab578bd3184”)

 ' 赋值 (用户信息.传递类型, 0)
载入 (查看或修改用户信息窗口, _启动窗口, 真)
.如果 (等于 (用户信息.数据有效, 假))
    返回 ()
    
.否则
    
.如果结束

 ' 辅助函数 - 注册打码兔用户
 ' 可选参数： QQ
 ' 必填参数： 用户名、密码、发送模式、电话号码和邮箱中的任意一项
 ' 动态码发送模式参数说明：打码兔为保障用户账号安全，在修改用户任何资料之前，都会要校验动态验证码，动态验证码通过用户的邮箱或手机渠道发送，所以在注册打码兔用户时，邮箱和手机两项必填其一，否则用户将无法注册。
 ' 动态码发送模式分为：
 ' 1、手机接收  （动态码将发送到用户注册时填写的手机）
 ' 2、邮箱接收  （动态码将发到用户注册时填写的邮箱）
 ' 因此，如果参数6的发送模式用户选的是1，则必须保证用户输入了合法的手机号。同理，为2则必须保证用户输入了合法的邮箱。
 ' 返回码：0表示成功，其它表示出错，错误码参见：http://wiki.dama2.com/index.php?n=ApiDoc.ErrDef
赋值 (返回码, 打码兔一键注册 (软件Key, 用户信息.用户名, 用户信息.密码, 用户信息.QQ, 用户信息.电话号码, 用户信息.邮箱, 用户信息.发送模式))

信息框 (相加 (“返回码为”, 数值到格式文本 (返回码, 0, 假)), 0, “注册用户”)


.子程序 _按钮_同步不卡_被单击, 空白型, , 
.局部变量 句柄, 整数型, , , 


未知支持库函数_0 (&线程一键通过图片数据打码, , 句柄)


.子程序 线程一键通过图片数据打码, 空白型, , 
.局部变量 返回码, 整数型, , , 
.局部变量 软件Key, 文本型, , , 
.局部变量 用户名, 文本型, , , 
.局部变量 用户密码, 文本型, , , 
.局部变量 图片数据, 字节集, , , 
.局部变量 图片长度, 整数型, , , 
.局部变量 超时时间, 整数型, , , 
.局部变量 验证码类型ID, 整数型, , , 
.局部变量 返回的验证码文本, 文本型, , , 


赋值 (是否打码完成, 0)
赋值 (返回的验证码文本, 取空白文本 (60))

赋值 (图片数据, 读入文件 (“1.bmp”))
赋值 (图片长度, 取字节集长度 (图片数据))

赋值 (软件Key, “9503ce045ad14d83ea876ab578bd3184”)
赋值 (用户名, “test”)
赋值 (用户密码, “test”)
赋值 (超时时间, 30) ' 单位秒
赋值 (验证码类型ID, 4)

赋值 (.时钟周期, 500)

赋值 (返回码, 打码兔一键通过图片数据请求打码_同步 (软件Key, 用户名, 用户密码, 图片数据, 图片长度, 超时时间, 验证码类型ID, 返回的验证码文本))
赋值 (打码兔_错误码, 返回码)

.如果 (大于或等于 (返回码, 0))
    赋值 (打码兔_答案, 返回的验证码文本)
    
.否则
    赋值 (打码兔_答案, “”)
.如果结束
赋值 (是否打码完成, 1)



.子程序 _时钟_同步不卡_周期事件, 空白型, , 
赋值 (.时钟周期, 0)
.如果 (等于 (是否打码完成, 1))
    信息框 (相加 (“打码完成，返回码：”, 到文本 (打码兔_错误码), “，答案：”, 打码兔_答案), 0, )
.否则
    赋值 (.时钟周期, 500)
.如果结束


.子程序 _按钮_异步不卡_被单击, 空白型, , 
.局部变量 句柄, 整数型, , , 

未知支持库函数_0 (&线程通过图片数据异步打码, , 句柄)


.子程序 线程通过图片数据异步打码, 空白型, , 
.局部变量 返回码, 整数型, , , 
.局部变量 软件Key, 文本型, , , 
.局部变量 用户名, 文本型, , , 
.局部变量 用户密码, 文本型, , , 
.局部变量 图片数据, 字节集, , , 
.局部变量 图片长度, 整数型, , , 
.局部变量 超时时间, 整数型, , , 
.局部变量 验证码类型ID, 整数型, , , 
.局部变量 系统公告, 文本型, , , 
.局部变量 应用公告, 文本型, , , 


赋值 (系统公告, 取空白文本 (512))
赋值 (应用公告, 取空白文本 (512))

赋值 (软件Key, “9503ce045ad14d83ea876ab578bd3184”)
赋值 (用户名, “test”)
赋值 (用户密码, “test”)
赋值 (超时时间, 30) ' 单位秒
赋值 (验证码类型ID, 4)

赋值 (打码兔_错误码, 0)
 ' 初始化
打码兔初始化 (“test”, 软件Key)
 ' 登录
赋值 (返回码, 打码兔登陆 (用户名, 用户密码, “”, 系统公告, 应用公告))
.如果 (不等于 (返回码, 0))
    赋值 (打码兔_错误码, 返回码)
    返回 ()
.否则
    
.如果结束


赋值 (图片数据, 读入文件 (“1.bmp”))
赋值 (图片长度, 取字节集长度 (图片数据))




赋值 (返回码, 打码兔通过图片数据请求打码 (图片数据, 图片长度, “jpg”, 0, 超时时间, 验证码类型ID, 打码兔_请求码ID))
赋值 (打码兔_错误码, 返回码)
赋值 (.时钟周期, 500)


.子程序 _时钟_异步打码_周期事件, 空白型, , 
.局部变量 返回码, 整数型, , , 
.局部变量 验证码答案, 文本型, , , 
.局部变量 COOKIE, 文本型, , , 

赋值 (.时钟周期, 0)
赋值 (验证码答案, 取空白文本 (60))
赋值 (COOKIE, 取空白文本 (2048))

.如果 (小于 (打码兔_错误码, 0))
    信息框 (相加 (“答题失败，错误码：”, 到文本 (打码兔_错误码)), 0, )
    返回 ()
.否则
    
.如果结束

 ' 赋值 (返回码, 打码兔得到打码结果 (打码兔_请求码ID, 10, 验证码答案, 60, 验证码ID, COOKIE, 2048))
.如果 (等于 (返回码, 0))
    信息框 (相加 (“答题成功，答案：”, 验证码答案), 0, )
.否则
    .如果 (等于 (返回码, -205))
         ' 没等到结果，继续等待。。。
        赋值 (.时钟周期, 500)
        返回 ()
    .否则
        信息框 (相加 (“答题失败，错误码：”, 到文本 (返回码)), 0, )
    .如果结束
    
.如果结束


.窗口程序集 输入注册信息窗口程序集, , , 

.子程序 _确定按钮_被单击, 空白型, , 
赋值 (用户信息.数据有效, 真)
赋值 (用户信息.用户名, .内容)
赋值 (用户信息.密码, .内容)
赋值 (用户信息.新密码, .内容)
赋值 (用户信息.QQ, .内容)
赋值 (用户信息.邮箱, .内容)
赋值 (用户信息.电话号码, .内容)
赋值 (用户信息.发送模式, 到数值 (.内容))
销毁 ()



.子程序 _查看或修改用户信息窗口_创建完毕, 空白型, , 
赋值 (用户信息.数据有效, 假)

.如果 (等于 (用户信息.传递类型, 0)) ' 注册用户
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    
    
.否则
    .如果 (等于 (用户信息.传递类型, 1)) ' 显示用户信息
        赋值 (.可视, 真)
        赋值 (.可视, 真)
        
        赋值 (.可视, 假)
        赋值 (.可视, 假)
        
        赋值 (.可视, 假)
        赋值 (.可视, 假)
        
        
    .否则
        赋值 (.可视, 假)
        赋值 (.可视, 假)
        
        赋值 (.可视, 真)
        赋值 (.可视, 真)
        
        赋值 (.可视, 真)
        赋值 (.可视, 真)
        
    .如果结束
    
.如果结束

赋值 (.内容, 用户信息.用户名)
赋值 (.内容, 用户信息.密码)
赋值 (.内容, 用户信息.新密码)
赋值 (.内容, 用户信息.QQ)
赋值 (.内容, 用户信息.邮箱)
赋值 (.内容, 用户信息.电话号码)
赋值 (.内容, 数值到格式文本 (用户信息.发送模式, 0, 假))



.窗口程序集 输入充值信息窗口程序集, , , 

.子程序 _确定按钮_被单击, 空白型, , 
赋值 (充值信息.数据有效, 真)
赋值 (充值信息.卡号, .内容)
赋值 (充值信息.用户名, .内容)
销毁 ()


.子程序 _输入充值信息窗口_创建完毕, 空白型, , 
赋值 (充值信息.数据有效, 假)


.窗口程序集 输入打码信息窗口程序集, , , 

.子程序 _确定按钮_被单击, 空白型, , 
赋值 (通过图片地址请求打码信息.数据有效, 真)
赋值 (通过图片地址请求打码信息.图片URL, .内容)
赋值 (通过图片地址请求打码信息.COOKIE, .内容)
赋值 (通过图片地址请求打码信息.Referer, .内容)
赋值 (通过图片地址请求打码信息.验证码长度, 到数值 (.内容))
赋值 (通过图片地址请求打码信息.验证码超时, 到数值 (.内容))
赋值 (通过图片地址请求打码信息.验证码类型ID, 到数值 (.内容))
赋值 (通过图片地址请求打码信息.是否可本机下载图片, 选择 (.选中, 1, 0))
销毁 ()


.子程序 _输入打码信息窗口_创建完毕, 空白型, , 
赋值 (通过图片地址请求打码信息.数据有效, 假)


.窗口程序集 输入窗口打码信息的窗口程序集, , , 

.子程序 _输入窗口打码信息的窗口_创建完毕, 空白型, , 
赋值 (通过窗口请求打码信息.数据有效, 假)


.子程序 _确定按钮_被单击, 空白型, , 
赋值 (通过窗口请求打码信息.数据有效, 真)
赋值 (通过窗口请求打码信息.窗口定义串, .内容)
赋值 (通过窗口请求打码信息.左, 到数值 (.内容))
赋值 (通过窗口请求打码信息.上, 到数值 (.内容))
赋值 (通过窗口请求打码信息.宽, 到数值 (.内容))
赋值 (通过窗口请求打码信息.高, 到数值 (.内容))
赋值 (通过窗口请求打码信息.验证码长度, 到数值 (.内容))
赋值 (通过窗口请求打码信息.验证码超时, 到数值 (.内容))
赋值 (通过窗口请求打码信息.验证码类型ID, 到数值 (.内容))

销毁 ()



 ' 不属于任何一个程序集、类模块的函数：
