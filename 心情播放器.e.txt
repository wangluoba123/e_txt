 ' 文件类型：Windows窗口程序

 ' 程序名称：心情播放器
 ' 程序描述：能播放Mp3\Wma格式音乐.
对于已经加入了歌词的程序,能够显示歌词.
 ' 程序作者：汤松山
 ' 邮政编码：651600
 ' 联系地址：武定县南街215号
 ' 联系电话：0878-8838865
 ' 传真号码：
 ' 电子信箱：wdrabbit@126.com
 ' 主页地址：wdxq.21city.net
 ' 版权声明：多多联系!
 ' 版本号：1.1
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 330
    顶边 = 176
    宽度 = 283
    高度 = 165
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “心情播放器”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 405
    高度 = 283
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “歌词编辑器”
    帮助文件名 = “”

窗口 窗口2
    左边 = 50
    顶边 = 50
    宽度 = 119
    高度 = 165
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “控制台”
    帮助文件名 = “”

窗口 窗口3
    左边 = 50
    顶边 = 50
    宽度 = 468
    高度 = 333
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.图片 帮助, " ' 已保存到：D:\易语言学习\Data\心情播放器.e\帮助", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 4 系统核心支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 1 扩展界面支持库一




数据类型 时间信息, , 
    .成员 最大位置, 整数型, , , 
    .成员 时间, 整数型, , , 

.全局变量 歌曲文件名, 文本型, , , 
.全局变量 播放位置, 文本型, , , 
.全局变量 状态, 文本型, , , 
.全局变量 单位, 整数型, , , 
.全局变量 窗口a, 逻辑型, , , 
.全局变量 歌曲字节集, 字节集, , , 
.全局变量 wjm, 文本型, , , 
.全局变量 窗口b, 逻辑型, , , 
.全局变量 分, 空白型, , , 
.全局变量 秒钟, 空白型, , , 
.全局变量 延时, 整数型, , "1000", 
.全局变量 歌词, 文本型, , "1000", 
.全局变量 文件号, 整数型, , , 
.全局变量 歌词段数, 空白型, , , 

.DLL命令 设音量, 整数型, "winmm.dll", "waveOutSetVolume", , 
    .参数 deviceid, 整数型, , 
    .参数 volume, 整数型, , 

.DLL命令 取短文件名, 空白型, "kernel32", "GetShortPathNameA", , 
    .参数 原文件名, 文本型, , 
    .参数 短文件名, 文本型, , 
    .参数 长度, 整数型, , 

.DLL命令 取音量, 整数型, "winmm.dll", "waveOutGetVolume", , 
    .参数 deviceid, 整数型, , 
    .参数 volume, 整数型, 传址, 

.DLL命令 媒体执行, 整数型, "winmm.dll", "mciSendStringA", , 
    .参数 动作, 文本型, , 
    .参数 参数1, 文本型, , 写("0")
    .参数 参数2, 整数型, , 写0
    .参数 参数3, 整数型, , 写0

.窗口程序集 窗口程序集1, , , 

.程序集变量 秒, 空白型, , , 
.程序集变量 当前歌词1, 文本型, , , 
.程序集变量 当前歌词, 文本型, , , 
.程序集变量 当前帧1, 空白型, , , 
.程序集变量 当前帧, 空白型, , , 
.程序集变量 i, 空白型, , , 
.程序集变量 秒钟1, 空白型, , , 
.程序集变量 K, 逻辑型, , , 
.程序集变量 l, 空白型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (.时钟周期, 0)
赋值 (状态, “启动”)
判断状态 ()
赋值 (.是否自动折行, 真)
设置音量 (相加 (.位置, .位置))
_启动窗口.移动 (300, 160, , )

.子程序 _滑块2_位置被改变, 空白型, , 
赋值 (.位置, 相乘 (.位置, 100))

.子程序 判断状态, 空白型, , 
.如果 (等于 (状态, “启动”))
    连续赋值 (真, ., ., ., .)
    赋值 (.时钟周期, 0)
    赋值 (., 假)
.否则
    连续赋值 (假, ., ., .)
    .判断开始 (等于 (状态, “播放”))
        赋值 (., 假)
        赋值 (., 真)
        赋值 (., 真)
        赋值 (.时钟周期, 100)
        赋值 (.时钟周期, 100)
        赋值 (.时钟周期, 100)
    .判断 (等于 (状态, “暂停”))
        赋值 (.时钟周期, 0)
        赋值 (.时钟周期, 0)
        赋值 (., 真)
        赋值 (., 真)
        赋值 (., 真)
        赋值 (.时钟周期, 0)
    .判断 (等于 (状态, “继续”))
        赋值 (.时钟周期, 100)
        赋值 (.时钟周期, 100)
        赋值 (.时钟周期, 100)
        赋值 (., 真)
        赋值 (., 假)
        赋值 (., 真)
        赋值 (., 真)
    .判断 (等于 (状态, “打开”))
        赋值 (.时钟周期, 100)
        赋值 (.时钟周期, 0)
        赋值 (., 真)
        赋值 (., 真)
        赋值 (., 真)
        赋值 (., 假)
    .判断 (等于 (状态, “停止”))
        赋值 (.时钟周期, 0)
        赋值 (.时钟周期, 0)
        赋值 (.时钟周期, 0)
        连续赋值 (真, ., ., .)
        赋值 (., 假)
    .默认
        
    .判断结束
    
.如果结束
输出调试文本 (状态)
赋值 (.标题, 相加 (“当前动作:”, 状态, “  |歌曲:”, 取短文件名 (), “  |格式:”, 取格式 ()))

.子程序 _打开按钮_被单击, 空白型, , 
.局部变量 a, 空白型, , , 

关闭所有媒体 ()
赋值 (.标题, “”)
赋值 (wjm, “”)
赋值 (歌曲字节集, {  })
赋值 (.初始目录, 取当前目录 ())

.如果 (打开 ())
    赋值 (.文件名)
    打开音乐 ()
.否则
    
.如果结束
判断状态 ()


.子程序 _播放按钮_被单击, 空白型, , 
播放媒体 ()
判断状态 ()

.子程序 _暂停按钮_被单击, 空白型, , 
暂停媒体 ()
判断状态 ()

.子程序 _继续按钮_被单击, 空白型, , 
继续媒体 ()
判断状态 ()

.子程序 _停止按钮_被单击, 空白型, , 
停止媒体 ()
赋值 (.位置, 0)
判断状态 ()

.子程序 __启动窗口_将被销毁, 空白型, , 
关闭所有媒体 ()
结束 ()

.子程序 _退出_被选择, 空白型, , 
结束 ()

.子程序 _滑块条2_位置被改变, 空白型, , 
设置音量 (相加 (.位置, .位置))

.子程序 _滑块条3_位置被改变, 空白型, , 
设置音量 (相加 (.位置, .位置))

.子程序 调整进度, 空白型, , 
.局部变量 总块, 空白型, , , 
.局部变量 当前块, 空白型, , , 

赋值 (总块, 取整 (相除 (总帧数 (), 1000)))
赋值 (.最大位置, 总块)
赋值 (当前块, 取整 (相除 (当前帧 (), 1000)))
赋值 (.位置, 当前块)
.如果真 (等于 (.位置, .最大位置))
    赋值 (.时钟周期, 0)
    _停止按钮_被单击 ()
.如果真结束


.子程序 _歌曲时间_周期事件, 空白型, , 
调整进度 ()

.子程序 _滑块1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

暂停媒体 ()
赋值 (状态, “暂停”)
赋值 (.时钟周期, 0)

.子程序 _滑块1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

指定播放位置 (到文本 (相乘 (.位置, 1000)))
赋值 (.时钟周期, 100)
赋值 (状态, “播放”)

.子程序 _普通歌词编辑器_被选择, 空白型, , 
.如果 (等于 (歌曲字节集, {  }))
    信息框 (“请打开要编辑歌词的音乐文件.”, 0, )
.否则
    载入 (窗口1, , 假)
    载入 (窗口2, , 假)
    赋值 (窗口a, 真)
    赋值 (窗口b, 真)
    窗口1.移动 (_启动窗口.左边, 相加 (_启动窗口.顶边, _启动窗口.高度), , )
    窗口2.移动 (相加 (_启动窗口.左边, _启动窗口.宽度), _启动窗口.顶边, , )
    赋值 (窗口1.总在最前, 真)
    赋值 (窗口2.总在最前, 真)
    _停止按钮_被单击 ()
.如果结束


.子程序 __启动窗口_位置被改变, 空白型, , 
.判断开始 (等于 (窗口a, 真))
    窗口1.移动 (_启动窗口.左边, 相加 (_启动窗口.顶边, _启动窗口.高度), , )
.默认
    
.判断结束
.判断开始 (等于 (窗口b, 真))
    窗口2.移动 (相加 (_启动窗口.左边, _启动窗口.宽度), _启动窗口.顶边, , )
.默认
    
.判断结束


.子程序 _时钟1_周期事件, 空白型, , 
赋值 (四舍五入 (相除 (当前帧 (wjm), 1000), ))
赋值 (相除 (秒, 60))
赋值 (秒钟1, 秒)
.判断开始 (大于或等于 (秒, 60))
    赋值 (相加 (1))
    赋值 (秒钟1, 0)
    赋值 (相减 (秒, 相乘 (60)))
.默认
    
.判断结束
赋值 (_启动窗口.标题, 相加 (“心情播放器(”, 到文本 (分), “分,共”, 到文本 (秒), “秒)”))


.子程序 打开音乐, 空白型, , 
打开媒体 ()
播放媒体 ()
调整进度 ()
读入歌曲 (wjm)
查找歌词脚本 ()
.判断开始 (等于 (是否存在歌词 (), 真))
    赋值 (.禁止, 真)
    提取歌词 (查找歌词脚本 ())
.默认
    赋值 (., 相加 (取短文件名 (wjm), 取格式 (wjm), “还没有加入歌词.”))
    赋值 (.禁止, 假)
.判断结束
赋值 (i, 1)
赋值 (当前帧, 延时 [1])

.子程序 _时钟2_周期事件, 空白型, , 
.如果真 (等于 (i, 歌词段数))
    赋值 (.时钟周期, 0)
    
.如果真结束
.如果真 (并且 (大于或等于 (当前帧 (wjm), 当前帧), 小于或等于 (当前帧 (wjm), 相加 (当前帧, 120))))
    赋值 (当前歌词, 歌词 [i])
    赋值 (i, 相加 (i, 1))
    显示歌词 ()
    赋值 (当前帧, 延时 [i])
.如果真结束


.子程序 _打开歌曲_被选择, 空白型, , 
_打开按钮_被单击 ()

.子程序 显示歌词, 空白型, , 
赋值 (.时钟周期, 100)

.子程序 _时钟3_周期事件, 空白型, , 
赋值 (l, 相加 (l, 1))
输出调试文本 (到文本 (l))
赋值 (., 相减 (., 1))
.如果真 (等于 (l, 10))
    赋值 (.时钟周期, 0)
    赋值 (., 74)
    赋值 (l, 0)
.如果真结束
赋值 (., 当前歌词)


.子程序 _帮助文件_被选择, 空白型, , 
载入 (窗口3, , 真)

.子程序 _高级歌词编辑器_被选择, 空白型, , 
运行 (相加 (取当前目录 (), “\edit.exe”), 假, )

.程序集 媒体控制, , , 

.子程序 取Dos文件名, 文本型, , 
.参数 原文件名, 文本型, , 

.局部变量 文件名, 文本型, , , 

赋值 (文件名, 取空白文本 (255))
取短文件名 (原文件名, 文件名, 255)
输出调试文本 (文件名)
返回 (文件名)

.子程序 播放媒体, 空白型, , 
.参数 文件名, 文本型, , 

赋值 (文件名, 取Dos文件名 (文件名))
媒体执行 (相加 (“play ”, 文件名), “0&”, 0, 0)
赋值 (状态, “播放”)

.子程序 设置音量, 空白型, , 
.参数 值, 整数型, , 

.局部变量 sz, 空白型, , , 

.如果 (小于或等于 (值, 128))
    赋值 (sz, 相加 (相乘 (值, 256, 256, 256), 相乘 (值, 256, 256), 相乘 (值, 256), 值))
.否则
    赋值 (sz, 相减 (1, 相减 (相加 (相乘 (相减 (相加 (129, 值), 128), 256, 256, 256), 相乘 (相减 (129, 值, 128), 256, 256), 相乘 (相减 (129, 值, 128), 256), 129), 值, 128)))
.如果结束

赋值 (sz, 相减 (1, 相减 (相加 (相乘 (相减 (相加 (129, 值), 128), 256, 256, 256), 相乘 (相减 (129, 值, 128), 256, 256), 相乘 (相减 (129, 值, 128), 256), 129), 值, 128)))
设音量 (0, sz)


.子程序 取短文件名, 文本型, , 
.参数 文件名, 文本型, , 

.局部变量 文本长度, 空白型, , , 
.局部变量 位置, 空白型, , , 
.局部变量 结果, 文本型, , , 
.局部变量 位置1, 空白型, , , 

赋值 (取文本长度 ())
赋值 (位置1, 倒找文本 (文件名, “\”, , 假))
赋值 (结果, 取文本右边 (文件名, 相减 (文本长度, 位置1)))
赋值 (位置, 寻找文本 (结果, “.”, 1, 假))
赋值 (位置, 相加 (相减 (取文本长度 (结果), 位置), 1))
赋值 (结果, 取文本左边 (结果, 相减 (取文本长度 (结果), 位置)))
返回 ()


.子程序 调整窗口, 空白型, , 
.如果 (并且 (等于 (窗口a, 真), 等于 (窗口b, 真)))
    赋值 (窗口1.总在最前, 假)
    赋值 (窗口2.总在最前, 假)
    赋值 (窗口a, 假)
    赋值 (窗口b, 假)
.否则
    赋值 (窗口a, 真)
    赋值 (窗口b, 真)
    赋值 (窗口1.总在最前, 真)
    赋值 (窗口2.总在最前, 真)
    
.如果结束


.子程序 取格式, 文本型, , 
.参数 文件名, 文本型, , 

.局部变量 文本长度, 空白型, , , 
.局部变量 位置, 空白型, , , 
.局部变量 结果, 文本型, , , 

赋值 (取Dos文件名 ())
赋值 (文本长度, 取文本长度 (文件名))
赋值 (位置, 寻找文本 (文件名, “.”, 1, 假))
赋值 (结果, 取文本中间 (文件名, 位置, 相加 (相减 (文本长度, 位置), 1)))
返回 (结果)

.子程序 当前帧, 整数型, , 
.参数 文件名, 文本型, , 

.局部变量 位置, 文本型, , , 

赋值 (取Dos文件名 ())
赋值 (位置, 取空白文本 (255))
媒体执行 (相加 (“status ”, 文件名, “ position”), 位置, 128, 0)
返回 (到数值 (位置))

.子程序 总帧数, 整数型, , 
.参数 文件名, 文本型, , 

.局部变量 lenth, 文本型, , , 
.局部变量 最大位置, 空白型, , , 
.局部变量 信息, 时间信息, , , 

赋值 (取Dos文件名 ())
赋值 (lenth, 取空白文本 (255))
媒体执行 (相加 (“open ”, 文件名), “0&”, 0, 0)
媒体执行 (相加 (“status ”, 文件名, “ length”), lenth, 128, 0)
返回 (到数值 (lenth))

.子程序 打开媒体, 空白型, , 
.参数 文件名, 文本型, , 

赋值 (取Dos文件名 ())
媒体执行 (相加 (“open ”, 文件名), “0&”, 0, 0)
赋值 (状态, “打开”)


.子程序 暂停媒体, 空白型, , 
.参数 文件名, 文本型, , 

赋值 (取Dos文件名 ())

媒体执行 (相加 (“Pause ”, 文件名), “0&”, 0, 0)
赋值 (状态, “暂停”)


.子程序 继续媒体, 空白型, , 
.参数 文件名, 文本型, , 

赋值 (取Dos文件名 ())

媒体执行 (相加 (“Resume ”, 文件名), “0&”, 0, 0)
赋值 (状态, “继续”)


.子程序 停止媒体, 空白型, , 
.参数 文件名, 文本型, , 

赋值 (取Dos文件名 ())

媒体执行 (相加 (“play ”, 文件名, “ from ”, “0”), “0&”, 0, 0)
媒体执行 (相加 (“stop ”, 文件名), “0&”, 0, 0)
赋值 (状态, “停止”)


.子程序 关闭所有媒体, 空白型, , 

媒体执行 (“close all”, “0&”, 0, 0)
赋值 (状态, “关闭所有”)
赋值 (歌曲字节集, {  })

.子程序 关闭当前媒体, 空白型, , 
.参数 文件名, 文本型, , 

赋值 (取Dos文件名 ())

媒体执行 (相加 (“close ”, 文件名), “0&”, 0, 0)
赋值 (状态, “关闭”)
赋值 (歌曲字节集, {  })

.子程序 指定播放位置, 空白型, , 
.参数 文件名, 文本型, , 
.参数 播放位置, 文本型, , 

赋值 (取Dos文件名 ())

媒体执行 (相加 (“play ”, 文件名, “ from ”, 播放位置), “0&”, 0, 0)
赋值 (状态, “定位播放”)


.程序集 歌词处理, , , 

.子程序 读入歌曲, 空白型, , 
.参数 文件名, 文本型, , 

赋值 (读入文件 (文件名))


.子程序 是否存在歌词, 逻辑型, , 
.局部变量 标记符, 空白型, , , 

赋值 (倒找字节集 (到字节集 (“{info}”)))
.如果 (小于或等于 (标记符, 0))
    返回 (假)
.否则
    返回 (真)
.如果结束


.子程序 查找歌词脚本, 文本型, , 
.局部变量 标记符, 空白型, , , 
.局部变量 字节集长度, 空白型, , , 
.局部变量 歌词, 字节集, , , 
.局部变量 文件名, 文本型, , , 
.局部变量 歌词脚本, 文本型, , , 

赋值 (标记符, 相加 (倒找字节集 (歌曲字节集, 到字节集 (“{info}”)), 5))
输出调试文本 (相加 (“标记符”, 到文本 (标记符)))
赋值 (字节集长度, 取字节集长度 ())
赋值 (歌词, 取字节集右边 (相减 (字节集长度, 标记符)))
返回 (取字节集数据 (歌词, #文本型))

.子程序 写入歌词脚本, 空白型, , 
.参数 歌词文本, 文本型, , 
.参数 文件名, 文本型, , 

.局部变量 歌曲, 字节集, , , 

赋值 (歌曲, 相加 (到字节集 (相加 (“{info}”, 歌词文本))))
赋值 (打开文件 (文件名, 4, ))
写出字节集 (歌曲)
关闭文件 ()
输出调试文本 (相加 (“gq”, 到文本 (取字节集长度 (歌曲))))

.子程序 提取歌词, 空白型, , 分析歌词脚本
.参数 歌词脚本, 文本型, , 

.局部变量 位置1, 空白型, , , 
.局部变量 位置3, 空白型, , , 
.局部变量 位置4, 空白型, , , 
.局部变量 位置5, 空白型, , , 
.局部变量 位置2, 空白型, , , 
.局部变量 i, 空白型, , , 
.局部变量 a, 空白型, , , 
.局部变量 n, 空白型, , , 

赋值 (i, 1)
.判断循环首 (不等于 (寻找文本 (歌词脚本, “}”, , 假), -1))
    .如果真 (大于或等于 (i, 999))
        跳出循环 ()
    .如果真结束
    赋值 (相加 (寻找文本 (“{timer:”, 1, 假), 6))
    赋值 (相减 (寻找文本 (“}”, , 假), 1))
    赋值 (寻找文本 (“}”, , 假))
    赋值 (寻找文本 (“{”, , 假))
    赋值 (相加 (寻找文本 (“}”, , 假), 1))
    赋值 ( [取文本中间 (相加 (1), 相减 (1))])
    赋值 ( [到数值 (取文本中间 (相加 (1), 相减 ()))])
    输出调试文本 (相加 (“i:”, 到文本 (i), “ ”, “gc:”, 歌词 [i], “  ”, “ys:”, 到文本 (延时 [i])))
    赋值 (i, 相加 (i, 1))
    赋值 (文本替换 (1, 相减 (1), “”))
    连续赋值 (0, , , , , )
    赋值 (a, 位置1)
    
.判断循环尾 ()
赋值 (歌词段数, i)

.子程序 清除歌词脚本, 空白型, , 
.参数 文件名1, 文本型, , 

.局部变量 标记符, 空白型, , , 
.局部变量 字节集长度, 空白型, , , 
.局部变量 歌词脚本, 文本型, , , 
.局部变量 歌曲, 字节集, , , 

赋值 (标记符, 倒找字节集 (到字节集 (“{info}”)))
输出调试文本 (相加 (“bjf”, 到文本 (标记符)))
赋值 (字节集长度, 取字节集长度 ())
赋值 (歌曲, 子字节集替换 (到字节集 (相加 (“{info}”, 未知函数_67175131 ())), 取空白字节集 (0), 标记符, 相减 (取字节集长度 (), 标记符)))
输出调试文本 (相加 (“歌曲”, 取字节集数据 (歌曲, #文本型)))
关闭文件 ()
赋值 (打开文件 (文件名1, 4, ))
写出字节集 (歌曲)
关闭文件 ()

.窗口程序集 窗口程序集2, , , 

.子程序 _时钟1_周期事件, 空白型, , 
赋值 (.标题, 到文本 (当前帧 (wjm)))
赋值 (.标题, 到文本 (总帧数 (wjm)))

.子程序 _按钮3_被单击, 空白型, , 
.如果 (大于 (窗口1.取项目数 (.), 0))
    调整窗口 ()
    .如果 (等于 (信息框 (“你还没有写入歌词,是否写入?”, #是否钮, ), #是钮))
        停止媒体 (wjm)
        _按钮1_被单击 ()
        窗口1.销毁 ()
        销毁 ()
        赋值 (窗口a, 假)
        赋值 (窗口b, 假)
        
    .否则
        窗口1.销毁 ()
        销毁 ()
        赋值 (窗口a, 假)
        赋值 (窗口b, 假)
        
    .如果结束
    
.否则
    窗口1.销毁 ()
    销毁 ()
    赋值 (窗口a, 假)
    赋值 (窗口b, 假)
    
.如果结束
_启动窗口._停止按钮_被单击 ()
打开音乐 ()
判断状态 ()


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 歌词脚本, 文本型, , , 

关闭所有媒体 ()
.如果 (等于 (是否存在歌词 (), 真))
    赋值 (窗口1.总在最前, 假)
    赋值 (窗口2.总在最前, 假)
    信息框 (相加 (#左引号, 取短文件名 (wjm), #右引号, “已经存在歌词了,请先清除旧歌词.”), #信息图标, )
    赋值 (窗口1.总在最前, 真)
    赋值 (窗口2.总在最前, 真)
    
.否则
    赋值 (歌词脚本, 生成歌词脚本 ())
    写入歌词脚本 (歌词脚本, wjm)
    窗口1.清空 (.)
    赋值 (窗口1.总在最前, 假)
    赋值 (窗口2.总在最前, 假)
    信息框 (“加入歌词成功!”, 0, )
    赋值 (窗口1.总在最前, 真)
    赋值 (窗口2.总在最前, 真)
    _启动窗口._停止按钮_被单击 ()
    打开音乐 ()
    判断状态 ()
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 a, 空白型, , , 

关闭所有媒体 ()
关闭文件 (文件号)

.如果 (等于 (是否存在歌词 (), 真))
    未知函数_67175063 (wjm)
    赋值 (窗口1.总在最前, 假)
    赋值 (窗口2.总在最前, 假)
    信息框 (“清除歌词成功!”, 0, )
    赋值 (窗口1.总在最前, 真)
    赋值 (窗口2.总在最前, 真)
    
.否则
    赋值 (窗口1.总在最前, 假)
    赋值 (窗口2.总在最前, 假)
    信息框 (相加 (#左引号, 取短文件名 (wjm), #右引号, “无任何歌词,所以不必清除歌词了.”), #信息图标, )
    赋值 (窗口1.总在最前, 真)
    赋值 (窗口2.总在最前, 真)
    
.如果结束
_启动窗口._停止按钮_被单击 ()
打开音乐 ()
判断状态 ()


.子程序 生成歌词脚本, 文本型, , 
.局部变量 歌词脚本, 文本型, , , 
.局部变量 i, 空白型, , , 

.计次循环首 (窗口1.取项目数 (.), i)
    赋值 (歌词脚本, 相加 (歌词脚本, “{timer:”, 到文本 (窗口1.取项目数值 (., 相减 (i, 1))), “}”))
    赋值 (歌词脚本, 相加 (歌词脚本, 窗口1.取项目文本 (., 相减 (i, 1))))
.计次循环尾 ()
赋值 (歌词脚本, 相加 (歌词脚本, “{”))
返回 (歌词脚本)
窗口1.清空 (.)
输出调试文本 (歌词脚本)

.窗口程序集 窗口程序集3, , , 

.程序集变量 逻辑, 整数型, , , 
.子程序 _编辑框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, #Ctrl键))
    .如果 (等于 (.内容, “”))
        赋值 (.内容, “ ”)
    .否则
        
    .如果结束
    .加入项目 (.内容, )
    赋值 (.内容, “”)
.否则
    
.如果结束


.子程序 _列表框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, #Del键))
    .删除项目 (.现行选中项)
.否则
    
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
.如果 (等于 (逻辑, 1))
    播放媒体 (wjm)
    赋值 (逻辑, 2)
    赋值 (.标题, “状态:播放”)
.否则
    暂停媒体 (wjm)
    赋值 (逻辑, 1)
    赋值 (.标题, “状态:暂停”)
.如果结束
获取焦点 ()
判断状态 ()

.子程序 _窗口1_创建完毕, 空白型, , 
赋值 (逻辑, 2)

.子程序 _选择框1_被单击, 空白型, , 
窗口1.获取焦点 ()

.子程序 _窗口1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (#空格键))
    .判断开始 (等于 (逻辑, 2))
        赋值 (逻辑, 1)
    .默认
        赋值 (逻辑, 2)
    .判断结束
    
.否则
    
.如果结束
.如果 (等于 (逻辑, 1))
    _启动窗口._播放按钮_被单击 ()
.否则
    _启动窗口._暂停按钮_被单击 ()
.如果结束


.子程序 _时钟1_周期事件, 空白型, , 
.如果 (不等于 (当前帧 (wjm), 总帧数 (wjm)))
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
0.选择项目 (真)
.取项目文本 (.现行选中项).加入项目 (到数值 (窗口2..标题))
赋值 (窗口1.标题, .取项目文本 (.现行选中项))
.删除项目 (.现行选中项)
取项目数 ().选择项目 (真)

.子程序 _列表框2_列表项被选择, 空白型, , 
输出调试文本 (到文本 (.取项目数值 (.现行选中项)))


.子程序 _列表框2_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.删除项目 (.现行选中项)

.子程序 _按钮3_被单击, 空白型, , 
.局部变量 文本, 文本型, , "1", 
.局部变量 i, 空白型, , , 
.局部变量 n, 空白型, , , 

.计次循环首 (取文本长度 (.内容), i)
    .如果 (不等于 (寻找文本 (.内容, “|”, i, 假), -1))
        赋值 (n, 相加 (n, 1))
    .否则
        
    .如果结束
    
.计次循环尾 ()
重定义数组 (文本, 假, n)
赋值 (文本, 分割文本 (.内容, “|”, ))
赋值 (n, 取数组成员数 (文本))
.计次循环首 (n, i)
    文本.加入项目 ( [i], )
.计次循环尾 ()
赋值 (.内容, “”)

.子程序 _按钮4_被单击, 空白型, , 
清空 ()

.子程序 _按钮5_被单击, 空白型, , 
清空 ()

.窗口程序集 窗口程序集4, , , 

.子程序 _窗口3_创建完毕, 空白型, , 
赋值 (.内容, 取字节集数据 (#帮助, #文本型))


 ' 不属于任何一个程序集、类模块的函数：
