 ' 文件类型：Windows窗口程序

 ' 程序名称：易用电子书库
 ' 程序描述：一款简单实用的文章收集软件
@备注:
为新手提供一个使用SQL操作ACCESS数据库的例子
 ' 程序作者：葛大强
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：大强工作室
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口

XTTTTTT[┏─┓┏──────────────────────────────┓┏─┓
U┌→例程源码U│大││代码写人生，行行彰显作者心性；网络看世相，处处演绎红尘烟云。││大│
U大XTTTTa│强│┣──────────────────────────────┫│强│
U强U　　　　　│学││⒈学习重基础，多看帮助，多看支持库说明　　　　　　　　　　　││源│
U学^TTT[　│易││⒉从基本的流程控制、变量操作入手，多写基础例程　　　　　　　││码│
U易→零基础U　│之││⒊脚踏实地，从自己能做的地方开始　　　　　　　　　　　　　　││特│
U程XTTTa　│基││⒋遇着问题，可以先放一放，把其他地方弄好，再回头解决问题　　││别│
U序U　　　　　│础││⒌没人能帮你学习，只有自己。学或不学，都在于自己。　　　　　││整│
U集^TTTT[│例││⒍邮箱：daqiangclub@163.com 　　　　　　　　　　　　　　　　││理│
U└→详细注释U│程││⒎留言：http://hi.baidu.com/%B4%F3%C7%BF%B9%A4%D7%F7%CA%D2　││版│
^TTTTTTa┗─┛┗──────────────────────────────┛┗─┛

    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “易用电子书库（作者：葛大强）”
    帮助文件名 = “”

窗口 窗口分类管理
    左边 = 50
    顶边 = 50
    宽度 = 400
    高度 = 400
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “易用电子书库　分类管理”
    帮助文件名 = “”

窗口 窗口作者管理
    左边 = 50
    顶边 = 50
    宽度 = 400
    高度 = 400
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “易用电子书库　作者管理”
    帮助文件名 = “”

窗口 窗口文章管理
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “易用电子书库　文章管理”
    帮助文件名 = “”

窗口 窗口帮助主题
    左边 = 50
    顶边 = 50
    宽度 = 400
    高度 = 400
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “易用电子书库　使用帮助”
    帮助文件名 = “”

窗口 窗口查看模式
    左边 = 50
    顶边 = 50
    宽度 = 200
    高度 = 300
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “查看模式设置”
    帮助文件名 = “”

窗口 窗口关于我们
    左边 = 50
    顶边 = 50
    宽度 = 400
    高度 = 300
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于　易用电子书库”
    帮助文件名 = “”



.常量 分类查询, "1", , 用这两个常量来判断要查询的是分类还是作者，以确定要查询的表
.常量 作者查询, "2", , 
.常量 帮助内容, "“易用电子书库帮助文档

　　本程序使用易语言4.13设计完成。
　　本程序为易语言初学者提供了一个完整的使用易语言操作ACCESS数据库的范例，让易语言初学者通过本例程，初步学会使用SQL命令对ACCESS数据库进行添加记录、删除记录、修改记录、查询记录，学会数据库各个表之间的关联。

【查看文章】

　　界面左侧为文章题目显示列表，用户通过位于列表上部的单选框来选择查看的方式：以分类查看还是以作者查看。选定之后，文章的分类或者作者会显示到组合框中，用户只需要通过下拉选择相应的项目，文章就会显示到列表中了。选择列表中的文章，内容将在右边显示，同时还会显示文章的题目、作者、分类、作者照片。

【系统操作】

　　用户通过左下角的按钮，可以进行如下操作：
　　分类管理：对文章的分类进行添加、删除、修改；
　　作者管理：对文章的作者进行添加、删除、修改；
　　添加文章：添加新的文章；
　　删除文章：删除选定的文章；
　　查看设置：设置查看的风格，包括字体、字号，前景与背景的颜色等。

【其他操作】

　　用户可以修改正在查看的文章及文章的作者，可以把文章复制到剪贴板或者导出到文本文件。

【其他说明】

　　本程序界面设计修理，所有的按钮标题都标明了功能，只要看标题就明白其功能了。



【作者信息】

　　作者：葛大强
　　联系：QQ391545711
　　邮箱：daqiangclub@foxmail.com
”", , 帮助内容文本
.图片 备用数据库, " ' 已保存到：D:\易语言学习\Data\易用电子书库(MDB多表).e\备用数据库", , 备用的空数据库，密码为391545711
.图片 备用照片, " ' 已保存到：D:\易语言学习\Data\易用电子书库(MDB多表).e\备用照片", , 文章作者没照片时，使用该图片


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库




.全局变量 代号分类, 整数型, , , 文章分类的ID，用于查询文章的具体分类
.全局变量 代号作者, 整数型, , , 文章作者的ID，用于查询文章的作者
.全局变量 添加作者, 逻辑型, , , 是否添加作者模式。添加为真，修改为假
.全局变量 添加文章, 逻辑型, , , 是否添加文章模式。添加为真，修改为假

.窗口程序集 _启动窗口程序集, , , 

.程序集变量 书库路径, 文本型, , , 存放文章的数据库文件的路径
.子程序 __启动窗口_创建完毕, 空白型, , 
 ' XTTTTTT[┏─┓┏──────────────────────────────┓┏─┓
 ' U┌→例程源码U│大││代码写人生，行行彰显作者心性；网络看世相，处处演绎红尘烟云。││大│
 ' U大XTTTTa│强│┣──────────────────────────────┫│强│
 ' U强U          │学││⒈学习重基础，多看帮助，多看支持库说明                      ││源│
 ' U学^TTT[  │易││⒉从基本的流程控制、变量操作入手，多写基础例程              ││码│
 ' U易→零基础U  │之││⒊脚踏实地，从自己能做的地方开始                            ││特│
 ' U程XTTTa  │基││⒋遇着问题，可以先放一放，把其他地方弄好，再回头解决问题    ││别│
 ' U序U          │础││⒌没人能帮你学习，只有自己。学或不学，都在于自己。          ││整│
 ' U集^TTTT[│例││⒍邮箱：daqiangclub@163.com                                 ││理│
 ' U└→详细注释U│程││⒎留言：http://hi.baidu.com/%B4%F3%C7%BF%B9%A4%D7%F7%CA%D2  ││版│
 ' ^TTTTTTa┗─┛┗──────────────────────────────┛┗─┛
 ' 作业要求：
 ' 1、本次要求设计一款文章收集的工具软件
 ' 2、点击单选框，根据单选框，在组合框中显示文章的作者或者分类，根据组合框的条件把符合条件的文章题目显示在列表框里，选中列表框的项目，文章的详情显示到右边，作者的照片显示到右上角的图片框里（照片尺寸要求宽与高之比为4：3）
 ' 3、界面已经设计好，请实现各按钮的功能
 ' 4、数据库使用ACCESS数据库，数据库的结构请自行设计
 ' 5、所需要的组件与窗口、变量、子程序等，请自行添加

 ' 数据库结构
 ' 数据库名：mybookdata.mdb
 ' 数据库密码：391545711

 ' 数据表名：BOOK
 ' 字段：ID，自动编号
 ' 字段：TIMU，文本，50
 ' 字段：FENLEIID，数字，长整型
 ' 字段：ZUOZHEID，数字，长整型
 ' 字段：NEIRONG，备注

 ' 数据表名：FENLEIBIAO
 ' 字段：ID，自动编号
 ' 字段：FENLEIMING，文本，20

 ' 数据表名：ZUOZHEBIAO
 ' 字段：ID，自动编号
 ' 字段：ZUOZHEMING，文本，20
 ' 字段：JIANJIE，文本，255
 ' 字段：ZHAOPIAN，OLE对象

_启动窗口.移动 (相加 (相减 (_启动窗口., _启动窗口.取用户区宽度 ()), 794), 相加 (相减 (_启动窗口., _启动窗口.取用户区高度 ()), 568)) ' 这句代码设置让启动窗口不管在什么样的风格下，都能保证用户界面正确显示
赋值 (书库路径, 取运行目录 ()) ' 取得数据库所在目录
.如果真 (不等于 (取文本右边 (书库路径, 1), “\”)) ' 判断目录最后是否有“\”，如果没有，则添加
    赋值 (书库路径, 相加 (书库路径, “\”))
.如果真结束
赋值 (书库路径, 相加 (书库路径, “mybookdata.mdb”)) ' 完整的数据库文件路径
.如果真 (取反 (文件是否存在 (书库路径))) ' 判断数据库文件是否存在
    写到文件 (书库路径, #备用数据库) ' 数据库文件不存在时，写出备用的空数据库，相当于重建数据库
.如果真结束
书库路径.打开MDB数据库 (“391545711”, , ) ' 打开数据库
_单选框分类_被单击 () ' 调用子程序，读取文章分类或作者


.子程序 __启动窗口_可否被关闭, 逻辑型, , 
信息框 (“请点击[退出系统]以退出软件。”, 64, “系统提示”)
返回 (假) ' 不允许点窗口的关闭按钮


.子程序 _单选框分类_被单击, 空白型, , 
连续赋值 (假, ., .)
连续赋值 (真, ., .)
读取分类或作者到组合框 (#分类查询)


.子程序 _单选框作者_被单击, 空白型, , 
连续赋值 (假, ., .)
连续赋值 (真, ., .)
读取分类或作者到组合框 (#作者查询)


.子程序 读取分类或作者到组合框, 空白型, , 
.参数 目标组合框, 组合框, , 
.参数 读取模式, 整数型, , 

.局部变量 查分类SQL, 文本型, , , 
.局部变量 查询结果, 整数型, , , 
.局部变量 目标表, 文本型, , , 

 ' 数据库结构
 ' 数据库名：mybookdata.mdb
 ' 数据库密码：391545711

 ' 数据表名：BOOK
 ' 字段：ID，自动编号
 ' 字段：TIMU，文本，50
 ' 字段：FENLEIID，数字，长整型
 ' 字段：ZUOZHEID，数字，长整型
 ' 字段：NEIRONG，备注

 ' 数据表名：FENLEIBIAO
 ' 字段：ID，自动编号
 ' 字段：FENLEIMING，文本，20

 ' 数据表名：ZUOZHEBIAO
 ' 字段：ID，自动编号
 ' 字段：ZUOZHEMING，文本，20
 ' 字段：JIANJIE，文本，255
 ' 字段：ZHAOPIAN，OLE对象
目标组合框.清空 ()
目标组合框.加入项目 (多项选择 (读取模式, “请选择分类”, “请选择作者”), 0)
赋值 (目标表, 多项选择 (读取模式, “FENLEIBIAO”, “ZUOZHEBIAO”)) ' 确定要查询的表
赋值 (查分类SQL, 相加 (“SELECT * FROM ”, 目标表)) ' 查询的SQL语句
赋值 (查询结果, 查分类SQL.查询 ())
查询结果.到首记录 () ' 将记录指针移到查询出的结果的第一条记录上
.判断循环首 (取反 (查询结果.尾记录后 ())) ' 读查询的结果到组合框
    目标组合框.加入项目 (查询结果.读 (2), 查询结果.读 (1))
    查询结果.到后一记录 () ' 将记录指针移到下一条记录
.判断循环尾 ()
查询结果.关闭记录集 () ' 读取完毕，关闭查询的记录集。
清空 ()
赋值 (., 0)
_组合框分类及作者_列表项被选择 ()


.子程序 _组合框分类及作者_列表项被选择, 空白型, , 
.局部变量 文章SQL, 文本型, , , 
.局部变量 文章句柄, 整数型, , , 

 ' 数据库结构
 ' 数据库名：mybookdata.mdb
 ' 数据库密码：391545711

 ' 数据表名：BOOK
 ' 字段：ID，自动编号
 ' 字段：TIMU，文本，50
 ' 字段：FENLEIID，数字，长整型
 ' 字段：ZUOZHEID，数字，长整型
 ' 字段：NEIRONG，备注

 ' 数据表名：FENLEIBIAO
 ' 字段：ID，自动编号
 ' 字段：FENLEIMING，文本，20

 ' 数据表名：ZUOZHEBIAO
 ' 字段：ID，自动编号
 ' 字段：ZUOZHEMING，文本，20
 ' 字段：JIANJIE，文本，255
 ' 字段：ZHAOPIAN，OLE对象
清空 ()
连续赋值 (“”, ., ., ., .)
赋值 (., #备用照片)
.如果真 (等于 (., 0))
    返回 ()
.如果真结束
赋值 (文章SQL, 相加 (“SELECT * FROM BOOK WHERE ”, 选择 (., “FENLEIID”, “ZUOZHEID”), “=”, 到文本 (.取项目数值 (.)))) ' 查询指定分类或作者的文章
赋值 (文章句柄, 文章SQL.查询 ())
文章句柄.到首记录 ()
.判断循环首 (取反 (文章句柄.尾记录后 ())) ' 把查询出的文章显示到列表框
    文章句柄.读 (2).加入项目 (文章句柄.读 (1))
    文章句柄.到后一记录 ()
.判断循环尾 ()
文章句柄.关闭记录集 ()
.如果真 (大于 (取项目数 (), 0)) ' 如果指定的分类或作者名下有文章，则选中第一项
    赋值 (., 0)
    _列表框文章_列表项被选择 () ' 调用子程序，显示文章
.如果真结束


.子程序 _组合框分类及作者_列表被关闭, 空白型, , 
获取焦点 ()


.子程序 _列表框文章_列表项被选择, 空白型, , 
.局部变量 SQL文本, 文本型, , , 
.局部变量 SQL句柄, 整数型, , , 

 ' 数据库结构
 ' 数据库名：mybookdata.mdb
 ' 数据库密码：391545711

 ' 数据表名：BOOK
 ' 字段：ID，自动编号
 ' 字段：TIMU，文本，50
 ' 字段：FENLEIID，数字，长整型
 ' 字段：ZUOZHEID，数字，长整型
 ' 字段：NEIRONG，备注

 ' 数据表名：FENLEIBIAO
 ' 字段：ID，自动编号
 ' 字段：FENLEIMING，文本，20

 ' 数据表名：ZUOZHEBIAO
 ' 字段：ID，自动编号
 ' 字段：ZUOZHEMING，文本，20
 ' 字段：JIANJIE，文本，255
 ' 字段：ZHAOPIAN，OLE对象
连续赋值 (“”, ., ., ., .)
赋值 (SQL文本, 相加 (“SELECT * FROM BOOK WHERE ID = ”, 到文本 (.取项目数值 (.)))) ' 查询指定的文章
赋值 (SQL句柄, SQL文本.查询 ())
SQL句柄.到首记录 ()
赋值 (代号分类, SQL句柄.读 (3)) ' 获取文章所属分类ID
赋值 (代号作者, SQL句柄.读 (4)) ' 获取文章的作者ID
赋值 (., SQL句柄.读 (2)) ' 显示文章题目
赋值 (., SQL句柄.读 (5)) ' 显示文章内容
SQL句柄.关闭记录集 ()

赋值 (SQL文本, 相加 (“SELECT * FROM ZUOZHEBIAO WHERE ID = ”, 到文本 (代号作者))) ' 查询文章的作者
赋值 (SQL句柄, SQL文本.查询 ())
SQL句柄.到首记录 ()
赋值 (., SQL句柄.读 (2)) ' 显示作者名
赋值 (., SQL句柄.读 (4)) ' 显示作者照片
SQL句柄.关闭记录集 ()

赋值 (SQL文本, 相加 (“SELECT * FROM FENLEIBIAO WHERE ID = ”, 到文本 (代号分类))) ' 查询文章分类
赋值 (SQL句柄, SQL文本.查询 ())
SQL句柄.到首记录 ()
赋值 (., SQL句柄.读 (2)) ' 显示文章分类名称
SQL句柄.关闭记录集 ()


.子程序 _按钮分类_被单击, 空白型, , 分类管理
载入 (窗口分类管理, , 真)
_单选框分类_被单击 ()


.子程序 _按钮作者_被单击, 空白型, , 作者管理
赋值 (添加作者, 真)
载入 (窗口作者管理, , 真)
_单选框作者_被单击 ()


.子程序 _按钮添文章_被单击, 空白型, , 添加文章
赋值 (添加文章, 真)
载入 (窗口文章管理, _启动窗口, 真)


.子程序 _按钮删文章_被单击, 空白型, , 删除文章
 ' 数据库结构
 ' 数据库名：mybookdata.mdb
 ' 数据库密码：391545711

 ' 数据表名：BOOK
 ' 字段：ID，自动编号
 ' 字段：TIMU，文本，50
 ' 字段：FENLEIID，数字，长整型
 ' 字段：ZUOZHEID，数字，长整型
 ' 字段：NEIRONG，备注

 ' 数据表名：FENLEIBIAO
 ' 字段：ID，自动编号
 ' 字段：FENLEIMING，文本，20

 ' 数据表名：ZUOZHEBIAO
 ' 字段：ID，自动编号
 ' 字段：ZUOZHEMING，文本，20
 ' 字段：JIANJIE，文本，255
 ' 字段：ZHAOPIAN，OLE对象

.如果真 (等于 (., -1))
    信息框 (“对不起，未选择文章！”, 48, “系统提示”)
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“删除文章将不可恢复！继续吗？　”, 36, “系统提示”), 5)) ' 询问是否删除
    相加 (“DELETE FROM BOOK WHERE ID=”, 到文本 (.取项目数值 (.))).执行 () ' 从数据库删除文章
    .删除项目 (.) ' 从列表框删除文章题目
    连续赋值 (“”, ., ., ., .)
    连续赋值 (0, 代号分类, 代号作者)
.如果真结束


.子程序 _按钮关于_被单击, 空白型, , 关于我们
载入 (窗口关于我们, , 真)


.子程序 _按钮退出程序_被单击, 空白型, , 退出软件
关闭 () ' 关闭数据库
压缩ACCESS数据库 (书库路径, “391545711”) ' 压缩数据库，使数据库文件最小
销毁 ()


.子程序 _按钮修改文章_被单击, 空白型, , 修改文章
.如果真 (等于 (., -1))
    返回 ()
.如果真结束
赋值 (添加文章, 假)
载入 (窗口文章管理, , 真)
_列表框文章_列表项被选择 ()


.子程序 _按钮修改作者_被单击, 空白型, , 修改作者
.如果真 (等于 (., -1))
    返回 ()
.如果真结束
赋值 (添加作者, 假)
载入 (窗口作者管理, , 真)
_列表框文章_列表项被选择 ()
.如果真 (.) ' 如果组合框里显示的是作者，使作者名与修改后的作者名相同
    .置项目文本 (., .)
.如果真结束


.子程序 _按钮到剪贴板_被单击, 空白型, , 复制文章内容到剪贴板
.如果真 (等于 (., -1))
    返回 ()
.如果真结束
置剪辑板文本 (相加 (., #换行符, #换行符, “作者：”, ., #换行符, #换行符, .)) ' 复制到剪贴板


.子程序 _按钮到文件_被单击, 空白型, , 把文章写出到文本文件
.如果真 (等于 (., -1))
    返回 ()
.如果真结束
赋值 (., 1)
赋值 (., “请选择要保存的位置”)
赋值 (., “文本文件|*.TXT”)
赋值 (., “TXT”)
赋值 (., 相加 (., “.TXT”))
.如果真 (打开 ())
    写到文件 (., 到字节集 (相加 (., #换行符, #换行符, “作者：”, ., #换行符, #换行符, .)))
.如果真结束


.子程序 _按钮帮助主题_被单击, 空白型, , 帮助
载入 (窗口帮助主题, , 真)


.子程序 _按钮查看_被单击, 空白型, , 查看模式
载入 (窗口查看模式, , 真)


.子程序 压缩ACCESS数据库, 整数型, , 压缩指定的ACCESS数据库。
.参数 路径, 文本型, , ACCESS数据库文件所在路径，必须是电脑中确实存在的文件
.参数 密码, 文本型, 可空, ACCESS数据库密码，如果没有密码，请留空，否则请给出ACCESS的密码

.局部变量 Engine, 对象, , , 
.局部变量 tmp, 文本型, , , 

 ' 请注意先关闭数据库。返回0成功，返回1则是创建系统对象失败，返回2是调用失败，返回3是数据库使用中
.如果真 (等于 (Engine.创建 (“JRO.JetEngine”, ), 假))
    返回 (1)
.如果真结束
赋值 (tmp, 取临时文件名 ())
Engine.方法 (“CompactDatabase”, 相加 (“Provider=Microsoft.Jet.OLEDB.4.0;Data Source=”, 路径, 选择 (是否为空 (密码), “”, 相加 (“;Jet OLEDB:Database Password=”, 密码))), 相加 (“Provider=Microsoft.Jet.OLEDB.4.0;Data Source=”, tmp, 选择 (等于 (密码, “”), “”, 相加 (“;Jet OLEDB:Database Password=”, 密码))))
.如果真 (不等于 (Engine.取错误 (), “”))
    返回 (2)
.如果真结束
Engine.清除 ()
.如果真 (等于 (删除文件 (路径), 假))
    删除文件 (tmp)
    返回 (3)
.如果真结束
.如果真 (等于 (复制文件 (tmp, 路径), 假))
    返回 (3)
.如果真结束
返回 (选择 (删除文件 (tmp), 0, 3))


.窗口程序集 窗口分类管理程序集, , , 

.子程序 _窗口分类管理_创建完毕, 空白型, , 
 ' XTTTTTT[┏─┓┏──────────────────────────────┓┏─┓
 ' U┌→例程源码U│大││代码写人生，行行彰显作者心性；网络看世相，处处演绎红尘烟云。││大│
 ' U大XTTTTa│强│┣──────────────────────────────┫│强│
 ' U强U          │学││⒈学习重基础，多看帮助，多看支持库说明                      ││源│
 ' U学^TTT[  │易││⒉从基本的流程控制、变量操作入手，多写基础例程              ││码│
 ' U易→零基础U  │之││⒊脚踏实地，从自己能做的地方开始                            ││特│
 ' U程XTTTa  │基││⒋遇着问题，可以先放一放，把其他地方弄好，再回头解决问题    ││别│
 ' U序U          │础││⒌没人能帮你学习，只有自己。学或不学，都在于自己。          ││整│
 ' U集^TTTT[│例││⒍邮箱：daqiangclub@163.com                                 ││理│
 ' U└→详细注释U│程││⒎留言：http://hi.baidu.com/%B4%F3%C7%BF%B9%A4%D7%F7%CA%D2  ││版│
 ' ^TTTTTTa┗─┛┗──────────────────────────────┛┗─┛
刷新类别 ()


.子程序 刷新类别, 空白型, , 读文章的分类到列表框
.局部变量 类别SQL, 文本型, , , 
.局部变量 类别句柄, 整数型, , , 

 ' 数据库结构
 ' 数据库名：mybookdata.mdb
 ' 数据库密码：391545711

 ' 数据表名：BOOK
 ' 字段：ID，自动编号
 ' 字段：TIMU，文本，50
 ' 字段：FENLEIID，数字，长整型
 ' 字段：ZUOZHEID，数字，长整型
 ' 字段：NEIRONG，备注

 ' 数据表名：FENLEIBIAO
 ' 字段：ID，自动编号
 ' 字段：FENLEIMING，文本，20

 ' 数据表名：ZUOZHEBIAO
 ' 字段：ID，自动编号
 ' 字段：ZUOZHEMING，文本，20
 ' 字段：JIANJIE，文本，255
 ' 字段：ZHAOPIAN，OLE对象
清空 ()
赋值 (类别SQL, “SELECT * FROM FENLEIBIAO”)
赋值 (类别句柄, _启动窗口.查询 (., 类别SQL))
_启动窗口.到首记录 (., 类别句柄)
.判断循环首 (取反 (_启动窗口.尾记录后 (., 类别句柄)))
    _启动窗口.读 (., 类别句柄, 2).加入项目 (_启动窗口.读 (., 类别句柄, 1))
    _启动窗口.到后一记录 (., 类别句柄)
.判断循环尾 ()
_启动窗口.关闭记录集 (., 类别句柄)


.子程序 _按钮1_被单击, 空白型, , 添加分类
.局部变量 LL, 整数型, , , 
.局部变量 分类SQL, 文本型, , , 

 ' XTTTTTT[┏─┓┏──────────────────────────────┓┏─┓
 ' U┌→例程源码U│大││代码写人生，行行彰显作者心性；网络看世相，处处演绎红尘烟云。││大│
 ' U大XTTTTa│强│┣──────────────────────────────┫│强│
 ' U强U          │学││⒈学习重基础，多看帮助，多看支持库说明                      ││源│
 ' U学^TTT[  │易││⒉从基本的流程控制、变量操作入手，多写基础例程              ││码│
 ' U易→零基础U  │之││⒊脚踏实地，从自己能做的地方开始                            ││特│
 ' U程XTTTa  │基││⒋遇着问题，可以先放一放，把其他地方弄好，再回头解决问题    ││别│
 ' U序U          │础││⒌没人能帮你学习，只有自己。学或不学，都在于自己。          ││整│
 ' U集^TTTT[│例││⒍邮箱：daqiangclub@163.com                                 ││理│
 ' U└→详细注释U│程││⒎留言：http://hi.baidu.com/%B4%F3%C7%BF%B9%A4%D7%F7%CA%D2  ││版│
 ' ^TTTTTTa┗─┛┗──────────────────────────────┛┗─┛
 ' 数据库结构
 ' 数据库名：mybookdata.mdb
 ' 数据库密码：391545711

 ' 数据表名：BOOK
 ' 字段：ID，自动编号
 ' 字段：TIMU，文本，50
 ' 字段：FENLEIID，数字，长整型
 ' 字段：ZUOZHEID，数字，长整型
 ' 字段：NEIRONG，备注

 ' 数据表名：FENLEIBIAO
 ' 字段：ID，自动编号
 ' 字段：FENLEIMING，文本，20

 ' 数据表名：ZUOZHEBIAO
 ' 字段：ID，自动编号
 ' 字段：ZUOZHEMING，文本，20
 ' 字段：JIANJIE，文本，255
 ' 字段：ZHAOPIAN，OLE对象
.如果 (等于 (., “添加”))
    赋值 (., “保存”)
    赋值 (., 0)
    获取焦点 ()
.否则
    .如果真 (等于 (删全部空 (.), “”))
        信息框 (“分类名称不可为空！”, 48, “系统提示”)
        获取焦点 ()
        赋值 (., -1)
        返回 ()
    .如果真结束
    .变量循环首 (0, 相减 (取项目数 (), 1), 1, LL)
        .如果真 (等于 (., LL.取项目文本 ()))
            信息框 (“分类名称不可重复！”, 48, “系统提示”)
            获取焦点 ()
            赋值 (., -1)
            返回 ()
        .如果真结束
        
    .变量循环尾 ()
    赋值 (分类SQL, 相加 (“INSERT INTO FENLEIBIAO(FENLEIMING) VALUES('”, ., “')”))
    _启动窗口.执行 (., 分类SQL, )
    赋值 (., 1)
    赋值 (., “”)
    赋值 (., “添加”)
    刷新类别 ()
.如果结束


.子程序 _按钮2_被单击, 空白型, , 修改分类
.局部变量 HH, 整数型, , , 
.局部变量 修改SQL, 文本型, , , 

 ' 数据库结构
 ' 数据库名：mybookdata.mdb
 ' 数据库密码：391545711

 ' 数据表名：BOOK
 ' 字段：ID，自动编号
 ' 字段：TIMU，文本，50
 ' 字段：FENLEIID，数字，长整型
 ' 字段：ZUOZHEID，数字，长整型
 ' 字段：NEIRONG，备注

 ' 数据表名：FENLEIBIAO
 ' 字段：ID，自动编号
 ' 字段：FENLEIMING，文本，20

 ' 数据表名：ZUOZHEBIAO
 ' 字段：ID，自动编号
 ' 字段：ZUOZHEMING，文本，20
 ' 字段：JIANJIE，文本，255
 ' 字段：ZHAOPIAN，OLE对象
.如果真 (小于 (., 0))
    信息框 (“请选择要修改的分类”, 48, “系统提示”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果 (等于 (., “修改”))
    赋值 (., “保存”)
    获取焦点 ()
    赋值 (., -1)
    赋值 (., 0)
.否则
    .如果真 (等于 (删全部空 (.), “”))
        信息框 (“分类名称不可为空！”, 48, “系统提示”)
        获取焦点 ()
        赋值 (., -1)
        返回 ()
    .如果真结束
    .变量循环首 (0, 相减 (取项目数 (), 1), 1, HH)
        .如果真 (并且 (等于 (., HH.取项目文本 ()), 不等于 (., HH)))
            信息框 (“分类名称不可重复！”, 48, “系统提示”)
            获取焦点 ()
            赋值 (., -1)
            返回 ()
        .如果真结束
        
    .变量循环尾 ()
    赋值 (修改SQL, 相加 (“UPDATE FENLEIBIAO SET FENLEIMING = '”, ., “' WHERE ID = ”, 到文本 (.取项目数值 (.))))
    _启动窗口.执行 (., 修改SQL, )
    赋值 (., “修改”)
    .置项目文本 (., .)
    赋值 (., 1)
    赋值 (., .)
.如果结束



.子程序 _按钮3_被单击, 空白型, , 删除分类
 ' 数据库结构
 ' 数据库名：mybookdata.mdb
 ' 数据库密码：391545711

 ' 数据表名：BOOK
 ' 字段：ID，自动编号
 ' 字段：TIMU，文本，50
 ' 字段：FENLEIID，数字，长整型
 ' 字段：ZUOZHEID，数字，长整型
 ' 字段：NEIRONG，备注

 ' 数据表名：FENLEIBIAO
 ' 字段：ID，自动编号
 ' 字段：FENLEIMING，文本，20

 ' 数据表名：ZUOZHEBIAO
 ' 字段：ID，自动编号
 ' 字段：ZUOZHEMING，文本，20
 ' 字段：JIANJIE，文本，255
 ' 字段：ZHAOPIAN，OLE对象
.如果真 (小于 (., 0))
    信息框 (“请选择要删除的分类！”, 48, “系统提示”)
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“该操作将删除分类及其下的文章，继续吗？”, 36, “系统提示”), 5))
    _启动窗口.执行 (., 相加 (“DELETE FROM BOOK WHERE FENLEIID = ”, 到文本 (.取项目数值 (.))), ) ' 删除分类下的文章
    _启动窗口.执行 (., 相加 (“DELETE FROM FENLEIBIAO WHERE ID = ”, 到文本 (.取项目数值 (.))), ) ' 删除分类
    .删除项目 (.)
    连续赋值 (“”, ., .)
    赋值 (., “修改”)
    赋值 (., 1)
.如果真结束


.子程序 _按钮4_被单击, 空白型, , 退出
销毁 ()


.子程序 _按钮5_被单击, 空白型, , 帮助
载入 (窗口帮助主题, , 真)


.子程序 _列表框分类_列表项被选择, 空白型, , 
 ' 数据库结构
 ' 数据库名：mybookdata.mdb
 ' 数据库密码：391545711

 ' 数据表名：BOOK
 ' 字段：ID，自动编号
 ' 字段：TIMU，文本，50
 ' 字段：FENLEIID，数字，长整型
 ' 字段：ZUOZHEID，数字，长整型
 ' 字段：NEIRONG，备注

 ' 数据表名：FENLEIBIAO
 ' 字段：ID，自动编号
 ' 字段：FENLEIMING，文本，20

 ' 数据表名：ZUOZHEBIAO
 ' 字段：ID，自动编号
 ' 字段：ZUOZHEMING，文本，20
 ' 字段：JIANJIE，文本，255
 ' 字段：ZHAOPIAN，OLE对象

连续赋值 (1, ., .)
赋值 (., “添加”)
赋值 (., “修改”)
赋值 (., “”)
连续赋值 (.取项目文本 (.), ., .)


.窗口程序集 窗口作者管理程序集, , , 

.子程序 _窗口作者管理_创建完毕, 空白型, , 
 ' XTTTTTT[┏─┓┏──────────────────────────────┓┏─┓
 ' U┌→例程源码U│大││代码写人生，行行彰显作者心性；网络看世相，处处演绎红尘烟云。││大│
 ' U大XTTTTa│强│┣──────────────────────────────┫│强│
 ' U强U          │学││⒈学习重基础，多看帮助，多看支持库说明                      ││源│
 ' U学^TTT[  │易││⒉从基本的流程控制、变量操作入手，多写基础例程              ││码│
 ' U易→零基础U  │之││⒊脚踏实地，从自己能做的地方开始                            ││特│
 ' U程XTTTa  │基││⒋遇着问题，可以先放一放，把其他地方弄好，再回头解决问题    ││别│
 ' U序U          │础││⒌没人能帮你学习，只有自己。学或不学，都在于自己。          ││整│
 ' U集^TTTT[│例││⒍邮箱：daqiangclub@163.com                                 ││理│
 ' U└→详细注释U│程││⒎留言：http://hi.baidu.com/%B4%F3%C7%BF%B9%A4%D7%F7%CA%D2  ││版│
 ' ^TTTTTTa┗─┛┗──────────────────────────────┛┗─┛
 ' 数据库结构
 ' 数据库名：mybookdata.mdb
 ' 数据库密码：391545711

 ' 数据表名：BOOK
 ' 字段：ID，自动编号
 ' 字段：TIMU，文本，50
 ' 字段：FENLEIID，数字，长整型
 ' 字段：ZUOZHEID，数字，长整型
 ' 字段：NEIRONG，备注

 ' 数据表名：FENLEIBIAO
 ' 字段：ID，自动编号
 ' 字段：FENLEIMING，文本，20

 ' 数据表名：ZUOZHEBIAO
 ' 字段：ID，自动编号
 ' 字段：ZUOZHEMING，文本，20
 ' 字段：JIANJIE，文本，255
 ' 字段：ZHAOPIAN，OLE对象
赋值 (., #备用照片)
读作者名到列表框 ()


.子程序 读作者名到列表框, 空白型, , 
.局部变量 作者SQL, 文本型, , , 
.局部变量 作者句柄, 整数型, , , 

 ' 数据库结构
 ' 数据库名：mybookdata.mdb
 ' 数据库密码：391545711

 ' 数据表名：BOOK
 ' 字段：ID，自动编号
 ' 字段：TIMU，文本，50
 ' 字段：FENLEIID，数字，长整型
 ' 字段：ZUOZHEID，数字，长整型
 ' 字段：NEIRONG，备注

 ' 数据表名：FENLEIBIAO
 ' 字段：ID，自动编号
 ' 字段：FENLEIMING，文本，20

 ' 数据表名：ZUOZHEBIAO
 ' 字段：ID，自动编号
 ' 字段：ZUOZHEMING，文本，20
 ' 字段：JIANJIE，文本，255
 ' 字段：ZHAOPIAN，OLE对象
清空 ()
赋值 (作者SQL, “SELECT * FROM ZUOZHEBIAO”)
赋值 (作者句柄, _启动窗口.查询 (., 作者SQL))
_启动窗口.到首记录 (., 作者句柄)
.判断循环首 (取反 (_启动窗口.尾记录后 (., 作者句柄)))
    _启动窗口.读 (., 作者句柄, 2).加入项目 (_启动窗口.读 (., 作者句柄, 1))
    _启动窗口.到后一记录 (., 作者句柄)
.判断循环尾 ()
_启动窗口.关闭记录集 (., 作者句柄)
.如果真 (取反 (添加作者))
    .变量循环首 (0, 相减 (取项目数 (), 1), 1, 作者句柄)
        .如果真 (等于 (作者句柄.取项目数值 (), 代号作者))
            赋值 (., 作者句柄)
            跳出循环 ()
        .如果真结束
        
    .变量循环尾 ()
    _作者管理列表框_列表项被选择 ()
    _作者修改_被单击 ()
.如果真结束


.子程序 _作者添加_被单击, 空白型, , 添加作者
 ' XTTTTTT[┏─┓┏──────────────────────────────┓┏─┓
 ' U┌→例程源码U│大││代码写人生，行行彰显作者心性；网络看世相，处处演绎红尘烟云。││大│
 ' U大XTTTTa│强│┣──────────────────────────────┫│强│
 ' U强U          │学││⒈学习重基础，多看帮助，多看支持库说明                      ││源│
 ' U学^TTT[  │易││⒉从基本的流程控制、变量操作入手，多写基础例程              ││码│
 ' U易→零基础U  │之││⒊脚踏实地，从自己能做的地方开始                            ││特│
 ' U程XTTTa  │基││⒋遇着问题，可以先放一放，把其他地方弄好，再回头解决问题    ││别│
 ' U序U          │础││⒌没人能帮你学习，只有自己。学或不学，都在于自己。          ││整│
 ' U集^TTTT[│例││⒍邮箱：daqiangclub@163.com                                 ││理│
 ' U└→详细注释U│程││⒎留言：http://hi.baidu.com/%B4%F3%C7%BF%B9%A4%D7%F7%CA%D2  ││版│
 ' ^TTTTTTa┗─┛┗──────────────────────────────┛┗─┛
 ' 数据库结构
 ' 数据库名：mybookdata.mdb
 ' 数据库密码：391545711

 ' 数据表名：BOOK
 ' 字段：ID，自动编号
 ' 字段：TIMU，文本，50
 ' 字段：FENLEIID，数字，长整型
 ' 字段：ZUOZHEID，数字，长整型
 ' 字段：NEIRONG，备注

 ' 数据表名：FENLEIBIAO
 ' 字段：ID，自动编号
 ' 字段：FENLEIMING，文本，20

 ' 数据表名：ZUOZHEBIAO
 ' 字段：ID，自动编号
 ' 字段：ZUOZHEMING，文本，20
 ' 字段：JIANJIE，文本，255
 ' 字段：ZHAOPIAN，OLE对象
.如果 (等于 (., “添加”))
    赋值 (., “保存”)
    连续赋值 (真, ., ., .)
    赋值 (., 假)
    连续赋值 (“”, ., .)
    赋值 (., #备用照片)
    连续赋值 (0, ., .)
    获取焦点 ()
.否则
    .判断开始 (等于 (删全部空 (.), “”))
        信息框 (“作者名不可为空！”, 48, “系统提示”)
        获取焦点 ()
    .判断 (等于 (删全部空 (.), “”))
        信息框 (“作者简介不可为空！”, 48, “系统提示”)
        获取焦点 ()
    .默认
        .如果 (_启动窗口.执行 (., 相加 (“INSERT INTO ZUOZHEBIAO( ZUOZHEMING,JIANJIE,ZHAOPIAN) VALUES('”, ., “','”, ., “',?)”), .)) ' 添加成功
            连续赋值 (假, ., ., .)
            赋值 (., 真)
            赋值 (., “添加”)
            连续赋值 (1, ., .)
            读作者名到列表框 ()
            赋值 (., 相减 (取项目数 (), 1))
        .否则
            信息框 (“对不起，添加作者失败，请稍后再试。”, 48, “系统提示”)
            销毁 ()
        .如果结束
        
    .判断结束
    
.如果结束


.子程序 _作者修改_被单击, 空白型, , 修改作者
 ' 数据库结构
 ' 数据库名：mybookdata.mdb
 ' 数据库密码：391545711

 ' 数据表名：BOOK
 ' 字段：ID，自动编号
 ' 字段：TIMU，文本，50
 ' 字段：FENLEIID，数字，长整型
 ' 字段：ZUOZHEID，数字，长整型
 ' 字段：NEIRONG，备注

 ' 数据表名：FENLEIBIAO
 ' 字段：ID，自动编号
 ' 字段：FENLEIMING，文本，20

 ' 数据表名：ZUOZHEBIAO
 ' 字段：ID，自动编号
 ' 字段：ZUOZHEMING，文本，20
 ' 字段：JIANJIE，文本，255
 ' 字段：ZHAOPIAN，OLE对象
.如果真 (小于 (., 0))
    信息框 (“请选择要修改的作者！”, 48, “系统提示”)
    返回 ()
.如果真结束
.如果 (等于 (., “修改”))
    赋值 (., “保存”)
    连续赋值 (真, ., ., .)
    赋值 (., 假)
    连续赋值 (0, ., .)
    赋值 (., -1)
    获取焦点 ()
.否则
    .判断开始 (等于 (删全部空 (.), “”))
        信息框 (“作者名不可为空！”, 48, “系统提示”)
        获取焦点 ()
    .判断 (等于 (删全部空 (.), “”))
        信息框 (“作者简介不可为空！”, 48, “系统提示”)
        获取焦点 ()
    .默认
        .如果 (_启动窗口.执行 (., 相加 (“UPDATE ZUOZHEBIAO SET ZUOZHEMING = '”, ., “' , JIANJIE = '”, ., “' , ZHAOPIAN = ? WHERE ID = ”, 到文本 (.取项目数值 (.))), .))
            连续赋值 (假, ., ., .)
            赋值 (., 真)
            连续赋值 (1, ., .)
            赋值 (., “修改”)
            .置项目文本 (., .)
            .如果真 (取反 (添加作者))
                销毁 ()
            .如果真结束
            
        .否则
            信息框 (“对不起，修改作者失败，请稍后再试。”, 48, “系统提示”)
            销毁 ()
        .如果结束
        
    .判断结束
    
.如果结束


.子程序 _作者删除_被单击, 空白型, , 删除作者
 ' 数据库结构
 ' 数据库名：mybookdata.mdb
 ' 数据库密码：391545711

 ' 数据表名：BOOK
 ' 字段：ID，自动编号
 ' 字段：TIMU，文本，50
 ' 字段：FENLEIID，数字，长整型
 ' 字段：ZUOZHEID，数字，长整型
 ' 字段：NEIRONG，备注

 ' 数据表名：FENLEIBIAO
 ' 字段：ID，自动编号
 ' 字段：FENLEIMING，文本，20

 ' 数据表名：ZUOZHEBIAO
 ' 字段：ID，自动编号
 ' 字段：ZUOZHEMING，文本，20
 ' 字段：JIANJIE，文本，255
 ' 字段：ZHAOPIAN，OLE对象
.如果真 (小于 (., 0))
    信息框 (“请选择要删除的作者！”, 48, “系统提示”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“删除作者将会连同作者的文章一起删除！继续吗？”, 36, “系统提示”), 5))
    _启动窗口.执行 (., 相加 (“DELETE FROM BOOK WHERE ZUOZHEID = ”, 到文本 (.取项目数值 (.))), ) ' 删除作者名下的文章
    _启动窗口.执行 (., 相加 (“DELETE FROM ZUOZHEBIAO WHERE ID = ”, 到文本 (.取项目数值 (.))), ) ' 删除作者
    .删除项目 (.) ' 从列表框中删除作者
    连续赋值 (“”, ., .)
    赋值 (., #备用照片)
.如果真结束


.子程序 _作者帮助_被单击, 空白型, , 帮助主题
载入 (窗口帮助主题, , 真)


.子程序 _作者返回_被单击, 空白型, , 退出返回
销毁 ()


.子程序 _图片框1_被双击, 逻辑型, , 更换照片
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (_启动窗口.., 0)
赋值 (_启动窗口.., “请选择照片文件”)
赋值 (_启动窗口.., “所有图片格式|*.JPG;*.JPEG;*.BMP;*.GIF”)
赋值 (_启动窗口.., “”)
.如果真 (_启动窗口.打开 (.))
    赋值 (., 读入文件 (_启动窗口..))
.如果真结束


.子程序 _作者管理列表框_列表项被选择, 空白型, , 
.局部变量 显示作者SQL, 文本型, , , 
.局部变量 显示作者句柄, 整数型, , , 

 ' 数据库结构
 ' 数据库名：mybookdata.mdb
 ' 数据库密码：391545711

 ' 数据表名：BOOK
 ' 字段：ID，自动编号
 ' 字段：TIMU，文本，50
 ' 字段：FENLEIID，数字，长整型
 ' 字段：ZUOZHEID，数字，长整型
 ' 字段：NEIRONG，备注

 ' 数据表名：FENLEIBIAO
 ' 字段：ID，自动编号
 ' 字段：FENLEIMING，文本，20

 ' 数据表名：ZUOZHEBIAO
 ' 字段：ID，自动编号
 ' 字段：ZUOZHEMING，文本，20
 ' 字段：JIANJIE，文本，255
 ' 字段：ZHAOPIAN，OLE对象

赋值 (显示作者SQL, 相加 (“SELECT * FROM ZUOZHEBIAO WHERE ID = ”, 到文本 (.取项目数值 (.))))
赋值 (显示作者句柄, _启动窗口.查询 (., 显示作者SQL))
_启动窗口.到首记录 (., 显示作者句柄)
赋值 (., _启动窗口.读 (., 显示作者句柄, 2))
赋值 (., _启动窗口.读 (., 显示作者句柄, 3))
赋值 (., _启动窗口.读 (., 显示作者句柄, 4))
_启动窗口.关闭记录集 (., 显示作者句柄)

赋值 (., 真)


.窗口程序集 窗口文章管理程序集, , , 

.子程序 _窗口文章管理_创建完毕, 空白型, , 
 ' XTTTTTT[┏─┓┏──────────────────────────────┓┏─┓
 ' U┌→例程源码U│大││代码写人生，行行彰显作者心性；网络看世相，处处演绎红尘烟云。││大│
 ' U大XTTTTa│强│┣──────────────────────────────┫│强│
 ' U强U          │学││⒈学习重基础，多看帮助，多看支持库说明                      ││源│
 ' U学^TTT[  │易││⒉从基本的流程控制、变量操作入手，多写基础例程              ││码│
 ' U易→零基础U  │之││⒊脚踏实地，从自己能做的地方开始                            ││特│
 ' U程XTTTa  │基││⒋遇着问题，可以先放一放，把其他地方弄好，再回头解决问题    ││别│
 ' U序U          │础││⒌没人能帮你学习，只有自己。学或不学，都在于自己。          ││整│
 ' U集^TTTT[│例││⒍邮箱：daqiangclub@163.com                                 ││理│
 ' U└→详细注释U│程││⒎留言：http://hi.baidu.com/%B4%F3%C7%BF%B9%A4%D7%F7%CA%D2  ││版│
 ' ^TTTTTTa┗─┛┗──────────────────────────────┛┗─┛
 ' 数据库结构
 ' 数据库名：mybookdata.mdb
 ' 数据库密码：391545711

 ' 数据表名：BOOK
 ' 字段：ID，自动编号
 ' 字段：TIMU，文本，50
 ' 字段：FENLEIID，数字，长整型
 ' 字段：ZUOZHEID，数字，长整型
 ' 字段：NEIRONG，备注

 ' 数据表名：FENLEIBIAO
 ' 字段：ID，自动编号
 ' 字段：FENLEIMING，文本，20

 ' 数据表名：ZUOZHEBIAO
 ' 字段：ID，自动编号
 ' 字段：ZUOZHEMING，文本，20
 ' 字段：JIANJIE，文本，255
 ' 字段：ZHAOPIAN，OLE对象
读取分类或作者到组合框 (#分类查询)
读取分类或作者到组合框 (#作者查询)
文章管理初始化 ()


.子程序 文章管理初始化, 空白型, , 
.局部变量 NN, 整数型, , , 

.如果 (添加文章) ' 添加文章时的选项
    连续赋值 (0, ., .)
    连续赋值 (“”, ., .)
    获取焦点 ()
.否则
     ' 修改文章时的选项
    赋值 (., _启动窗口..)
    赋值 (., _启动窗口..)
    .变量循环首 (1, 相减 (取项目数 (), 1), 1, NN)
        .如果真 (等于 (NN.取项目数值 (), 代号分类))
            赋值 (., NN)
            跳出循环 ()
        .如果真结束
        
    .变量循环尾 ()
    .变量循环首 (1, 相减 (取项目数 (), 1), 1, NN)
        .如果真 (等于 (NN.取项目数值 (), 代号作者))
            赋值 (., NN)
            跳出循环 ()
        .如果真结束
        
    .变量循环尾 ()
.如果结束


.子程序 _按钮退出_被单击, 空白型, , 
销毁 ()


.子程序 _按钮保存_被单击, 空白型, , 
.局部变量 文章管理SQL, 文本型, , , 

.判断开始 (等于 (., “”))
    信息框 (“请填写文章题目！　”, 48, “系统提示”)
    获取焦点 ()
.判断 (等于 (., “”))
    信息框 (“请填写文章内容！　”, 48, “系统提示”)
    获取焦点 ()
.判断 (小于或等于 (., 0))
    信息框 (“请选择文章类别！　”, 48, “系统提示”)
    获取焦点 ()
.判断 (小于或等于 (., 0))
    信息框 (“请选择文章作者！　”, 48, “系统提示”)
    获取焦点 ()
.默认
     ' 数据库结构
     ' 数据库名：mybookdata.mdb
     ' 数据库密码：391545711
    
     ' 数据表名：BOOK
     ' 字段：ID，自动编号
     ' 字段：TIMU，文本，50
     ' 字段：FENLEIID，数字，长整型
     ' 字段：ZUOZHEID，数字，长整型
     ' 字段：NEIRONG，备注
    未知函数_373 () ' *** 缩略程序块 ***
    
     ' 数据表名：FENLEIBIAO
     ' 字段：ID，自动编号
     ' 字段：FENLEIMING，文本，20
    
     ' 数据表名：ZUOZHEBIAO
     ' 字段：ID，自动编号
     ' 字段：ZUOZHEMING，文本，20
     ' 字段：JIANJIE，文本，255
     ' 字段：ZHAOPIAN，OLE对象
    .如果 (添加文章) ' 添加文章模式
        赋值 (文章管理SQL, 相加 (“INSERT INTO BOOK (TIMU,FENLEIID,ZUOZHEID,NEIRONG) VALUES('”, ., “',”, 到文本 (.取项目数值 (.)), “,”, 到文本 (.取项目数值 (.)), “,?)”))
    .否则
         ' 编辑原有文章模式
        赋值 (文章管理SQL, 相加 (“UPDATE BOOK SET TIMU = '”, ., “', FENLEIID = ”, 到文本 (.取项目数值 (.)), “ , ZUOZHEID = ”, 到文本 (.取项目数值 (.)), “, NEIRONG = ? WHERE ID =”, 到文本 (_启动窗口.取项目数值 (., _启动窗口..))))
    .如果结束
    .如果 (_启动窗口.执行 (., 文章管理SQL, .))
        .如果 (等于 (信息框 (“操作成功！继续添加新文章吗？”, 36, “系统提示”), 5)) ' 询问是否继续添加新的文章
            赋值 (添加文章, 真)
            文章管理初始化 ()
        .否则
            销毁 () ' 不添加，则销毁本窗口
        .如果结束
        
    .否则
        信息框 (“操作失败！请稍候再试。”, 48, “系统提示”) ' 操作失败时提示
        销毁 ()
    .如果结束
    
.判断结束


.子程序 _按钮导入文章_被单击, 空白型, , 
赋值 (_启动窗口.., 0)
赋值 (_启动窗口.., “请选择要导入的文件”)
赋值 (_启动窗口.., “文本文件|*.TXT”)
 ' _启动窗口.通用对话框1.默认文件后缀 ＝ “TXT”
赋值 (_启动窗口.., “”)
.如果真 (_启动窗口.打开 (.))
    到文本 (读入文件 (_启动窗口..)).加入文本 ()
.如果真结束


.子程序 _按钮类别管理_被单击, 空白型, , 
载入 (窗口分类管理, , 真)
读取分类或作者到组合框 (#分类查询)
赋值 (., 0)


.子程序 _按钮作者管理_被单击, 空白型, , 
赋值 (添加作者, 真)
载入 (窗口作者管理, , 真)
读取分类或作者到组合框 (#作者查询)
赋值 (., 0)


.子程序 _按钮帮助_被单击, 空白型, , 
载入 (窗口帮助主题, , 真)


.窗口程序集 窗口帮助主题程序集, , , 

.子程序 _窗口帮助主题_创建完毕, 空白型, , 
0.移动 (0, 窗口帮助主题.取用户区宽度 (), 窗口帮助主题.取用户区高度 ())
#帮助内容.加入文本 ()
 ' XTTTTTT[┏─┓┏──────────────────────────────┓┏─┓
 ' U┌→例程源码U│大││代码写人生，行行彰显作者心性；网络看世相，处处演绎红尘烟云。││大│
 ' U大XTTTTa│强│┣──────────────────────────────┫│强│
 ' U强U          │学││⒈学习重基础，多看帮助，多看支持库说明                      ││源│
 ' U学^TTT[  │易││⒉从基本的流程控制、变量操作入手，多写基础例程              ││码│
 ' U易→零基础U  │之││⒊脚踏实地，从自己能做的地方开始                            ││特│
 ' U程XTTTa  │基││⒋遇着问题，可以先放一放，把其他地方弄好，再回头解决问题    ││别│
 ' U序U          │础││⒌没人能帮你学习，只有自己。学或不学，都在于自己。          ││整│
 ' U集^TTTT[│例││⒍邮箱：daqiangclub@163.com                                 ││理│
 ' U└→详细注释U│程││⒎留言：http://hi.baidu.com/%B4%F3%C7%BF%B9%A4%D7%F7%CA%D2  ││版│
 ' ^TTTTTTa┗─┛┗──────────────────────────────┛┗─┛


.窗口程序集 窗口查看模式程序集, , , 

.子程序 _窗口查看模式_创建完毕, 空白型, , 
 ' XTTTTTT[┏─┓┏──────────────────────────────┓┏─┓
 ' U┌→例程源码U│大││代码写人生，行行彰显作者心性；网络看世相，处处演绎红尘烟云。││大│
 ' U大XTTTTa│强│┣──────────────────────────────┫│强│
 ' U强U          │学││⒈学习重基础，多看帮助，多看支持库说明                      ││源│
 ' U学^TTT[  │易││⒉从基本的流程控制、变量操作入手，多写基础例程              ││码│
 ' U易→零基础U  │之││⒊脚踏实地，从自己能做的地方开始                            ││特│
 ' U程XTTTa  │基││⒋遇着问题，可以先放一放，把其他地方弄好，再回头解决问题    ││别│
 ' U序U          │础││⒌没人能帮你学习，只有自己。学或不学，都在于自己。          ││整│
 ' U集^TTTT[│例││⒍邮箱：daqiangclub@163.com                                 ││理│
 ' U└→详细注释U│程││⒎留言：http://hi.baidu.com/%B4%F3%C7%BF%B9%A4%D7%F7%CA%D2  ││版│
 ' ^TTTTTTa┗─┛┗──────────────────────────────┛┗─┛
赋值 (., _启动窗口..)
连续赋值 (_启动窗口.., ., .)
连续赋值 (_启动窗口.., ., .)


.子程序 _按钮字体字号_被单击, 空白型, , 
.局部变量 新字体变量, 字体, , , 

赋值 (_启动窗口.., 2)
赋值 (新字体变量, .)
赋值 (_启动窗口.., 新字体变量.)
赋值 (_启动窗口.., 新字体变量.)
赋值 (_启动窗口.., 新字体变量.)
赋值 (_启动窗口.., 新字体变量.)
赋值 (_启动窗口.., 新字体变量.)
赋值 (_启动窗口.., 新字体变量.)
.如果真 (_启动窗口.打开 (.))
    赋值 (新字体变量., _启动窗口..)
    赋值 (新字体变量., _启动窗口..)
    赋值 (新字体变量., _启动窗口..)
    赋值 (新字体变量., _启动窗口..)
    赋值 (新字体变量., _启动窗口..)
    赋值 (新字体变量., _启动窗口..)
    赋值 (., 新字体变量)
.如果真结束


.子程序 _颜色文字_颜色被改变, 空白型, , 
赋值 (., .)


.子程序 _颜色背景_颜色被改变, 空白型, , 
赋值 (., .)


.子程序 _按钮确定_被单击, 空白型, , 
赋值 (_启动窗口.., .)
赋值 (_启动窗口.., .)
赋值 (_启动窗口.., .)
销毁 ()


.子程序 _按钮返回_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口关于我们程序集, , , 

.子程序 _窗口关于我们_创建完毕, 空白型, , 
 ' XTTTTTT[┏─┓┏──────────────────────────────┓┏─┓
 ' U┌→例程源码U│大││代码写人生，行行彰显作者心性；网络看世相，处处演绎红尘烟云。││大│
 ' U大XTTTTa│强│┣──────────────────────────────┫│强│
 ' U强U          │学││⒈学习重基础，多看帮助，多看支持库说明                      ││源│
 ' U学^TTT[  │易││⒉从基本的流程控制、变量操作入手，多写基础例程              ││码│
 ' U易→零基础U  │之││⒊脚踏实地，从自己能做的地方开始                            ││特│
 ' U程XTTTa  │基││⒋遇着问题，可以先放一放，把其他地方弄好，再回头解决问题    ││别│
 ' U序U          │础││⒌没人能帮你学习，只有自己。学或不学，都在于自己。          ││整│
 ' U集^TTTT[│例││⒍邮箱：daqiangclub@163.com                                 ││理│
 ' U└→详细注释U│程││⒎留言：http://hi.baidu.com/%B4%F3%C7%BF%B9%A4%D7%F7%CA%D2  ││版│
 ' ^TTTTTTa┗─┛┗──────────────────────────────┛┗─┛



 ' 不属于任何一个程序集、类模块的函数：
