 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 415
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 _修改窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 214
    高度 = 210
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 _添加窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 214
    高度 = 177
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 _统计窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 214
    高度 = 178
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 _查询窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 214
    高度 = 295
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 _排序窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 214
    高度 = 135
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假



.常量 浅灰色, "", , 
.常量 默认底色, "", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 9 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 1 扩展界面支持库一




.全局变量 名, 文本型, , , 
.全局变量 码, 文本型, , , 
.全局变量 号, 文本型, , , 
.全局变量 价, 文本型, , , 
.全局变量 加, 文本型, , , 
.全局变量 中, 整数型, , , 
.全局变量 字, 文本型, , , 
.全局变量 期, 文本型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 记录, 整数型, , , 
.子程序 _按钮1_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 

载入 (_查询窗口, , 真)
.如果 (小于 (中, 1))
    返回 ()
.否则
    
.如果结束
.计次循环首 (取列数 (), 计次)
    相减 (取列数 (), 1).删除列 ()
.计次循环尾 ()
.插入列 (“编  号”, 50, , , )
.插入列 (“货物名称”, 60, , , )
.插入列 (“型    号”, 80, , , )
.插入列 (“单    价”, 60, , , )
.插入列 (“日    期”, 100, , , )
全部删除 ()
.如果 (等于 (中, 1))
    赋值 (记录, 相加 (“select * from YHB where YHM like '%”, 字, “%'”).查询 ())
.否则
    
.如果结束
.如果 (等于 (中, 2))
    赋值 (记录, 相加 (“select * from YHB where JE> ”, 字).查询 ())
.否则
    
.如果结束
.如果 (等于 (中, 3))
    赋值 (记录, 相加 (“select * from YHB where JE< ”, 字).查询 ())
.否则
    
.如果结束
.如果 (等于 (中, 4))
    赋值 (记录, “select  top 1 ID,YHM,MM,JE,RQ from YHB order by JE desc”.查询 ())
.否则
    
.如果结束
.如果 (等于 (中, 5))
    赋值 (记录, “select  top 1 ID,YHM,MM,JE,RQ from YHB order by JE”.查询 ())
.否则
    
.如果结束
.如果 (等于 (中, 6))
    赋值 (记录, “select * from YHB”.查询 ())
.否则
    
.如果结束
.到首记录 ()
.判断循环首 (等于 (.尾记录后 (), 假))
    .插入表项 (数值到格式文本 (.读 (1), , 假), , , , )
    相减 (取表项数 (), 1).置标题 (1, .读 (2))
    相减 (取表项数 (), 1).置标题 (2, .读 (3))
    相减 (取表项数 (), 1).置标题 (3, 到文本 (记录.读 (4)))
    相减 (取表项数 (), 1).置标题 (4, 到文本 (记录.读 (5)))
    .到后一记录 ()
.判断循环尾 ()
.关闭记录集 ()

.子程序 _按钮2_被单击, 空白型, , 
赋值 (加, “”)
载入 (_添加窗口, , 真)
.如果真 (等于 (加, “添加”))
    赋值 (“select * from YHB ”.查询 ())
    记录.到尾记录 ()
    .插入表项 (数值到格式文本 (.读 (1), , 假), , , , )
    相减 (取表项数 (), 1).置标题 (1, .读 (2))
    相减 (取表项数 (), 1).置标题 (2, .读 (3))
    相减 (取表项数 (), 1).置标题 (3, 到文本 (记录.读 (4)))
    相减 (取表项数 (), 1).置标题 (4, 到文本 (记录.读 (5)))
    .关闭记录集 ()
    赋值 (., 相减 (取表项数 (), 1))
.如果真结束
获取焦点 ()

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 计次, 整数型, , , 

“xxgg.mdb”.打开MDB数据库 ()
.计次循环首 (取列数 (), 计次)
    相减 (取列数 (), 1).删除列 ()
.计次循环尾 ()
.插入列 (“编  号”, 50, , , )
.插入列 (“货物名称”, 60, , , )
.插入列 (“型    号”, 80, , , )
.插入列 (“单    价”, 60, , , )
.插入列 (“日    期”, 100, , , )
全部删除 ()
赋值 (“select * from YHB ”.查询 ())
.到首记录 ()
.判断循环首 (等于 (.尾记录后 (), 假))
    .插入表项 (数值到格式文本 (.读 (1), , 假), , , , )
    相减 (取表项数 (), 1).置标题 (1, .读 (2))
    相减 (取表项数 (), 1).置标题 (2, .读 (3))
    相减 (取表项数 (), 1).置标题 (3, 到文本 (.读 (4)))
    相减 (取表项数 (), 1).置标题 (4, 到文本 (记录.读 (5)))
    .到后一记录 ()
.判断循环尾 ()
.关闭记录集 ()

.子程序 _按钮3_被单击, 空白型, , 
.如果真 (等于 (., -1))
    信息框 (“您还没有选择要修改的数据呢！”, #信息图标, “友情提示”)
    返回 ()
.如果真结束
赋值 (号, .取标题 (., 0))
赋值 (名, .取标题 (., 1))
赋值 (码, .取标题 (., 2))
赋值 (价, .取标题 (., 3))
赋值 (期, .取标题 (., 4))
载入 (_修改窗口, , 真)
.置标题 (., 1, 名)
.置标题 (., 2, 码)
.置标题 (., 3, 价)
.置标题 (., 4, 期)
获取焦点 ()

.子程序 _按钮4_被单击, 空白型, , 
.局部变量 项, 整数型, , , 

.如果真 (等于 (., -1))
    信息框 (“您还没有选择要删除的数据呢！”, #信息图标, “友情提示”)
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“您真的要删除选中的数据吗？”, 相加 (#警告图标, #确认取消钮), “删除提示”), 1))
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (项, .)
.如果 (等于 (相加 (“DELETE * FROM YHB WHERE ID=”, .取标题 (., 0)).执行 (), 假))
    信息框 (“删除失败”, #信息图标, )
.否则
    信息框 (“删除成功”, #信息图标, )
    .删除表项 (.)
.如果结束
.如果 (等于 (取表项数 (), 项))
    赋值 (., 相减 (项, 1))
.否则
    赋值 (., 项)
.如果结束
获取焦点 ()

.子程序 _按钮5_被单击, 空白型, , 
载入 (_统计窗口, , 真)
获取焦点 ()

.子程序 _按钮6_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 

载入 (_排序窗口, , 真)
.如果 (小于 (中, 1))
    返回 ()
.否则
    
.如果结束
.计次循环首 (取列数 (), 计次)
    相减 (取列数 (), 1).删除列 ()
.计次循环尾 ()
.插入列 (“编  号”, 50, , , )
.插入列 (“货物名称”, 60, , , )
.插入列 (“型    号”, 80, , , )
.插入列 (“单    价”, 60, , , )
.插入列 (“日    期”, 100, , , )
全部删除 ()
.如果 (等于 (中, 1))
    赋值 (记录, “select * from YHB order by JE desc”.查询 ())
.否则
    
.如果结束
.如果 (等于 (中, 2))
    赋值 (记录, “select * from YHB order by JE”.查询 ())
.否则
    
.如果结束
.到首记录 ()
.判断循环首 (等于 (.尾记录后 (), 假))
    .插入表项 (数值到格式文本 (.读 (1), , 假), , , , )
    相减 (取表项数 (), 1).置标题 (1, .读 (2))
    相减 (取表项数 (), 1).置标题 (2, .读 (3))
    相减 (取表项数 (), 1).置标题 (3, 到文本 (记录.读 (4)))
    相减 (取表项数 (), 1).置标题 (4, 到文本 (记录.读 (5)))
    .到后一记录 ()
.判断循环尾 ()
.关闭记录集 ()

.子程序 _按钮7_被单击, 空白型, , 
.局部变量 计次, 整数型, , , 

.计次循环首 (取列数 (), )
    相减 (取列数 (), 1).删除列 ()
.计次循环尾 ()
.插入列 (“编  号”, 50, , , )
.插入列 (“货物名称”, 60, , , )
.插入列 (“型    号”, 80, , , )
.插入列 (“单    价”, 60, , , )
.插入列 (“日    期”, 100, , , )
.插入列 (“产    地”, 60, , , )
.插入列 (“类    别”, 60, , , )
全部删除 ()
赋值 (记录, “Select YHB.*,CDB.cd,LBB.lb From YHB,CDB,LBB where YHB.yhm=CDB.yhm and CDB.cd=LBB.cd”.查询 ()) ' 此为三表关联查询
记录 ＝ 外部数据库1.查询 (“Select YHB.*,CDB.cd From YHB,CDB where YHB.yhm=CDB.yhm”)/ ' 此为两表关联查询
.到首记录 ()
.判断循环首 (等于 (.尾记录后 (), 假))
    .插入表项 (数值到格式文本 (记录.读 (1), , 假), , , , )
    相减 (取表项数 (), 1).置标题 (1, 记录.读 (2))
    相减 (取表项数 (), 1).置标题 (2, 记录.读 (3))
    相减 (取表项数 (), 1).置标题 (3, 到文本 (记录.读 (4)))
    相减 (取表项数 (), 1).置标题 (4, 到文本 (记录.读 (5)))
    相减 (取表项数 (), 1).置标题 (5, 记录.读 (6))
    相减 (取表项数 (), 1).置标题 (6, 记录.读 (7))
    .到后一记录 ()
.判断循环尾 ()
.关闭记录集 ()

.窗口程序集 窗口程序集2, , , 

.子程序 __修改窗口_创建完毕, 空白型, , 
赋值 (.内容, 名)
赋值 (.内容, 码)
赋值 (.内容, 价)
赋值 (.内容, 期)
获取焦点 ()

.子程序 _按钮1_被单击, 空白型, , 
.如果 (等于 (_启动窗口.执行 (., 相加 (“UPDATE YHB SET YHM='”, .内容, “',MM='”, .内容, “',JE='”, .内容, “',RQ='”, .内容, “'WHERE ID=”, 号), ), 假))
    信息框 (“修改失败”, #信息图标, “失败”)
.否则
    信息框 (“修改成功”, #信息图标, “成功”)
.如果结束
赋值 (名, .内容)
赋值 (码, .内容)
赋值 (价, .内容)
赋值 (期, .内容)
_修改窗口.销毁 ()

.子程序 _按钮2_被单击, 空白型, , 
_修改窗口.销毁 ()

.窗口程序集 窗口程序集3, , , 

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 日期, 文本型, , , 

.如果 (等于 (_启动窗口.执行 (., 相加 (“INSERT INTO YHB  (YHM,MM,JE,RQ) values ('”, .内容, “','”, .内容, “','”, .内容, “','”, 到文本 (取日期 (取现行时间 ())), “')”), ), 假))
    信息框 (“添加失败”, #信息图标, “失败”)
    返回 ()
.否则
    信息框 (“添加成功”, #信息图标, “成功”)
    赋值 (加, “添加”)
.如果结束
_添加窗口.销毁 ()

.子程序 _按钮2_被单击, 空白型, , 
_添加窗口.销毁 ()

.子程序 __添加窗口_创建完毕, 空白型, , 
获取焦点 ()

.窗口程序集 窗口程序集4, , , 

.程序集变量 记录, 整数型, , , 
.子程序 __统计窗口_创建完毕, 空白型, , 
赋值 (记录, _启动窗口.查询 (., “select sum(JE) as H,avg(JE) as J,count(*) as S from YHB”))
赋值 (.标题, 到文本 (_启动窗口.读 (., 记录, “S”)))
赋值 (.标题, 到文本 (_启动窗口.读 (., 记录, “H”)))
赋值 (.标题, 到文本 (_启动窗口.读 (., 记录, “J”)))
_启动窗口.关闭记录集 (., 记录)

.子程序 _按钮1_被单击, 空白型, , 
_统计窗口.销毁 ()

.窗口程序集 窗口程序集5, , , 

.子程序 _单选框1_被单击, 空白型, , 
赋值 (.背景颜色, #白色)
赋值 (.禁止, 假)
获取焦点 ()
赋值 (.输入方式, 0)

.子程序 _单选框2_被单击, 空白型, , 
赋值 (.背景颜色, #白色)
赋值 (.禁止, 假)
获取焦点 ()
赋值 (.输入方式, 7)

.子程序 _单选框3_被单击, 空白型, , 
赋值 (.背景颜色, #白色)
赋值 (.禁止, 假)
获取焦点 ()
赋值 (.输入方式, 0)

.子程序 _单选框6_被单击, 空白型, , 
赋值 (.内容, “”)
赋值 (.背景颜色, #浅灰)
赋值 (.禁止, 真)

.子程序 _按钮1_被单击, 空白型, , 
.判断开始 (等于 (.选中, 真))
    .如果真 (等于 (.内容, “”))
        信息框 (“您还没有输入查询关键字呢！”, #信息图标, “友情提示”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (字, .内容)
    赋值 (中, 1)
.默认
    
.判断结束
.判断开始 (等于 (.选中, 真))
    .如果真 (等于 (.内容, “”))
        信息框 (“您还没有输入查询关键字呢！”, #信息图标, “友情提示”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (字, .内容)
    赋值 (中, 2)
.默认
    
.判断结束
.判断开始 (等于 (.选中, 真))
    .如果真 (等于 (.内容, “”))
        信息框 (“您还没有输入查询关键字呢！”, #信息图标, “友情提示”)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (字, .内容)
    赋值 (中, 3)
.默认
    
.判断结束
.如果 (等于 (.选中, 真))
    赋值 (中, 4)
.否则
    
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (中, 5)
.否则
    
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (中, 6)
.否则
    
.如果结束
_查询窗口.销毁 ()

.子程序 _按钮2_被单击, 空白型, , 
赋值 (中, 0)
_查询窗口.销毁 ()

.子程序 __查询窗口_创建完毕, 空白型, , 
获取焦点 ()

.子程序 _单选框4_被单击, 空白型, , 
赋值 (.内容, “”)
赋值 (.禁止, 真)
赋值 (.背景颜色, #浅灰)

.子程序 _单选框5_被单击, 空白型, , 
赋值 (.内容, “”)
赋值 (.禁止, 真)
赋值 (.背景颜色, #浅灰)

.窗口程序集 窗口程序集6, , , 

.子程序 _按钮1_被单击, 空白型, , 
.判断开始 (等于 (.选中, 真))
    赋值 (中, 1)
.默认
    
.判断结束
.判断开始 (等于 (.选中, 真))
    赋值 (中, 2)
.默认
    
.判断结束
_排序窗口.销毁 ()

.子程序 __排序窗口_创建完毕, 空白型, , 
赋值 (中, 0)

.子程序 _按钮2_被单击, 空白型, , 
_排序窗口.销毁 ()


 ' 不属于任何一个程序集、类模块的函数：
