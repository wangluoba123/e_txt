 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 372
    高度 = 251
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假



.常量 数据库2, "“frontgroud”", , 
.常量 前景序号1, "“前景序号”", , 
.常量 文件名1, "“文件名”", , 
.常量 类型1, "“类型”", , 
.常量 横向位置1, "“横向位置”", , 
.常量 纵向位置1, "“纵向位置”", , 
.常量 普通砖, "1", , 
.常量 金币砖, "2", , 
.常量 顶不碎砖, "3", , 
.常量 蘑菇砖, "4", , 
.常量 障碍物, "5", , 
.常量 金币, "6", , 
.常量 小敌人, "7", , 
.常量 沟, "8", , 
.常量 花砖块, "9", , 
.常量 蘑菇, "10", , 
.常量 主角, "12", , 
.常量 鸭子, "13", , 
.常量 花敌人, "14", , 
.常量 城堡, "15", , 
.常量 头, "1", , 主角身体部位
.常量 身体, "2", , 主角身体部位
.常量 脚, "3", , 主角身体部位
.常量 掉沟里了, "0", , 碰撞结果
.常量 挂了, "1", , 碰撞结果
.常量 通过, "2", , 碰撞结果
.常量 通不过, "3", , 碰撞结果
.常量 变小, "4", , 碰撞结果
.常量 变大, "5", , 碰撞结果
.常量 变子弹, "6", , 碰撞结果
.常量 出蘑菇, "7", , 碰撞结果
.常量 跳动速度, "10", , 
.常量 跳动计数, "20", , 
.常量 小主角顶边, "518", , 
.常量 大主角顶边, "484", , 
.常量 精灵宽度, "34", , 
.常量 主角初始底边, "", , 
.常量 花, "11", , 
.常量 效果画完, "-2", , 
.常量 屏幕移X位置, "5", , 
.常量 主角移X位置, "5", , 
.常量 蘑菇速度, "4", , 
.常量 地面位置, "560", , 
.常量 删除此精灵, "-100", , 
.常量 正常, "1", , 主角状态
.常量 上升, "2", , 主角状态
.常量 下降, "3", , 主角状态
.常量 蹲下, "4", , 主角状态
.常量 向左走, "1", , 
.常量 向右走, "2", , 
.常量 向上走, "3", , 
.常量 向下走, "4", , 
.常量 game_over, "-999", , 
.常量 过关, "-1000", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' EdirectX 81690053A86045bf9E362F5DE0BC4095 1 5 DirectX支持库




数据类型 碰撞结构, , 
    .成员 物体序号, 整数型, , , -1表示什么也没撞到
    .成员 主角身体部位, 整数型, , , 1头, 2身体, 3脚
    .成员 主角等级, 整数型, , , 1小，2大, 3子弹
    .成员 第几个精灵, 整数型, , , 是精灵列表中的第几个精灵
    .成员 主角状态, 整数型, , , 上升还是下降
    .成员 是否无敌, 逻辑型, , , 是否无敌

.全局变量 当前屏幕, 未知类型0x20007, , , 
.全局变量 数据路径, 文本型, , , 
.全局变量 精灵列表, 精灵列表类, , "20", 
.全局变量 缓冲页面X位置, 整数型, , , 
.全局变量 主角, 新主角, , , 
.全局变量 返回值, 逻辑型, , , 
.全局变量 后台页面, 未知类型0x2000B, , , 
.全局变量 前景, 前景类, , , 
.全局变量 缓冲页面, 未知类型0x2000B, , , 
.全局变量 缓冲页面2, 未知类型0x2000B, , , 
.全局变量 几次时钟, 整数型, , , 
.全局变量 是否重画, 逻辑型, , , 
.全局变量 将消失精灵列表, 精灵列表类, , "20", 
.全局变量 背景缓冲页面, 未知类型0x2000B, , , 
.全局变量 背景缓冲页面2, 未知类型0x2000B, , , 
.全局变量 当前前景序号, 整数型, , , 
.全局变量 老前景序号, 整数型, , , 
.全局变量 方向全局, 整数型, , , 0.无 1.左 2.右
.全局变量 声音句柄, 未知类型0x20008, , , 
.全局变量 波形声音, 未知类型0x20009, , , 
.全局变量 MIDI, 未知类型0x20005, , , 
.全局变量 键左, 整数型, , , 
.全局变量 键右, 整数型, , , 
.全局变量 键跳, 整数型, , , 
.全局变量 键下, 整数型, , , 
.全局变量 是否使用控制器, 逻辑型, , , 
.全局变量 全局是否过关, 逻辑型, , , 

.类模块 块堆, , , 

.程序集变量 块, 未知类型0x2000D, , "0", 
.程序集变量 图路径, 文本型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用



.子程序 填充块, 逻辑型, 公开, 
.参数 一块宽, 整数型, , 
.参数 一块高, 整数型, , 
.参数 块堆宽, 整数型, , 
.参数 块堆高, 整数型, , 
.参数 图片路径, 文本型, , 

.局部变量 次数, 整数型, , , 
.局部变量 几块, 整数型, , , 

赋值 (几块, 相除 (块堆宽, 一块宽))
重定义数组 (块, 假, 几块)
.计次循环首 (几块, 次数)
    赋值 (块 [次数], , 0)
    赋值 (块 [次数], , 一块宽)
    赋值 (块 [次数], , 0)
    赋值 (块 [次数], , 一块高)
.计次循环尾 ()
赋值 (图路径, 图片路径)
返回 (真)

.子程序 画所有块, 逻辑型, 公开, 
.参数 屏幕, 未知类型0x20007, , 
.参数 目标页面, 未知类型0x2000B, , 
.参数 开始X, 整数型, , 开始画的横向位置
.参数 开始Y, 整数型, , 开始画的纵向位置

.局部变量 小页面, 未知类型0x2000B, , , 
.局部变量 次数, 整数型, , , 

赋值 (返回值, 小页面.未知支持库函数_111 (屏幕, 图路径, ))
.如果真 (取反 (返回值))
    输出调试文本 (“块堆:画所有块，建位图页面失败！”)
    返回 (假)
.如果真结束

.计次循环首 (取数组成员数 (块), 次数)
    赋值 (返回值, 小页面.未知支持库函数_132 (目标页面, 开始X, 开始Y, ))
    .如果真 (取反 (返回值))
        输出调试文本 (相加 (“块堆:画所有块，小页面.块复制失败！次数”, 到文本 (次数)))
        返回 (假)
    .如果真结束
    赋值 (开始X, 相减 (相加 (开始X, 块 [次数], ), 块 [次数], ))
    
     ' 开始Y ＝ 开始Y ＋ 块 [次数].顶边 － 块 [次数].底边
.计次循环尾 ()
返回 (真)


.子程序 画几块, 逻辑型, 公开, 
.参数 屏幕, 未知类型0x20007, , 
.参数 目标页面, 未知类型0x2000B, , 
.参数 开始X, 整数型, , 开始画的横向位置
.参数 开始Y, 整数型, , 开始画的纵向位置
.参数 块数, 整数型, , 要画的块数

.局部变量 小页面, 未知类型0x2000B, , , 
.局部变量 次数, 整数型, , , 

赋值 (返回值, 小页面.未知支持库函数_111 (屏幕, 图路径, ))
.如果真 (取反 (返回值))
    输出调试文本 (“块堆:画一块，建位图页面失败！”)
    返回 (假)
.如果真结束

小页面.未知支持库函数_157 ()
.计次循环首 (块数, 次数)
    赋值 (返回值, 小页面.未知支持库函数_134 (目标页面, 开始X, 开始Y, ))
    .如果真 (取反 (返回值))
        输出调试文本 (相加 (“块堆:画一块，小页面.块复制失败！次数”, 到文本 (次数)))
        返回 (假)
    .如果真结束
    
    赋值 (开始X, 相减 (相加 (开始X, 块 [次数], ), 块 [次数], ))
.计次循环尾 ()

返回 (真)


.窗口程序集 窗口程序集1, , , 

.程序集变量 分数, 整数型, , , 
.程序集变量 第几关, 整数型, , , 
.程序集变量 共几关, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (全局是否过关, 假)
赋值 (第几关, 1)
赋值 (共几关, 8)
赋值 (.时钟周期, 0)
载入 (窗口1, _启动窗口, 真)
赋值 (.时钟周期, 20)
赋值 (返回值, 当前屏幕.未知支持库函数_63 (取窗口句柄 (), 800, 600, 32, 真))
 ' 返回值 ＝ 当前屏幕.创建窗口模式 (取窗口句柄 (), 800, 600)
.如果真 (取反 (返回值))
    输出调试文本 (“创建窗口模式:出错！”)
    返回 ()
.如果真结束


赋值 (数据路径, 取运行目录 ())
.如果真 (不等于 (取文本右边 (数据路径, 1), “\”))
    赋值 (数据路径, 相加 (数据路径, “\”))
.如果真结束

赋值 (数据路径, 相加 (数据路径, “data\”))

赋值 (返回值, 缓冲页面.未知支持库函数_110 (当前屏幕, 800, 600, ))
.如果真 (取反 (返回值))
    输出调试文本 (“缓冲页面.建空页面。出错！”)
    返回 ()
.如果真结束

赋值 (返回值, 缓冲页面2.未知支持库函数_110 (当前屏幕, 800, 600, ))
.如果真 (取反 (返回值))
    输出调试文本 (“缓冲页面2.建空页面。出错！”)
    返回 ()
.如果真结束

赋值 (返回值, 背景缓冲页面.未知支持库函数_110 (当前屏幕, 800, 600, ))
.如果真 (取反 (返回值))
    输出调试文本 (“背景缓冲页面.建空页面。出错！”)
    返回 ()
.如果真结束

赋值 (返回值, 背景缓冲页面2.未知支持库函数_110 (当前屏幕, 800, 600, ))
.如果真 (取反 (返回值))
    输出调试文本 (“背景缓冲页面.建空页面。出错！”)
    返回 ()
.如果真结束

前景.初始化 (数据路径, 相加 (“frontgroud”, 到文本 (第几关), “.edb”), “litterAni.edb”)
赋值 (后台页面, 当前屏幕.未知支持库函数_83 ())

初始化物体 ()
取窗口句柄 ().未知支持库函数_14 ()
30.未知支持库函数_38 ()

声音句柄.未知支持库函数_213 (取窗口句柄 (), )
声音句柄.未知支持库函数_222 (25, 25)
MIDI.未知支持库函数_195 (取窗口句柄 ())
MIDI.未知支持库函数_196 (相加 (数据路径, “sfx\music\groove5.mid”))

赋值 (当前前景序号, 1)
赋值 (老前景序号, 1)


.子程序 _时钟2_周期事件, 空白型, , 
.局部变量 填充距阵, 未知类型0x2000D, , , 
.局部变量 填充距阵2, 未知类型0x2000D, , , 
.局部变量 当前偶数屏是第几前景, 整数型, , , 
.局部变量 小页面, 未知类型0x2000B, , , 

.如果真 (是否重画)
    缓冲页面.未知支持库函数_124 (取颜色值 (147, 109, 23))
     ' 缓冲页面.写文字 (5, 0, #绿色, 到文本 (当前前景序号))
    前景.画前景 (当前前景序号, 当前屏幕, 缓冲页面)
    缓冲页面.未知支持库函数_132 (背景缓冲页面, 0, 0, )
    缓冲页面2.未知支持库函数_124 (取颜色值 (147, 109, 23))
     ' 缓冲页面2.写文字 (5, 0, #蓝色, 到文本 (当前前景序号 ＋ 1))
    前景.画前景 (相加 (当前前景序号, 1), 当前屏幕, 缓冲页面2)
    缓冲页面2.未知支持库函数_132 (背景缓冲页面2, 0, 0, )
    赋值 (是否重画, 假)
    赋值 (老前景序号, 当前前景序号)
.如果真结束

赋值 (几次时钟, 相加 (几次时钟, 1))
判断按键状态 ()
画精灵 ()

.如果真 (不等于 (当前前景序号, 老前景序号))
    
    缓冲页面.未知支持库函数_124 (取颜色值 (147, 109, 23))
     ' 缓冲页面.写文字 (5, 0, #绿色, 到文本 (当前前景序号))
    前景.画前景 (当前前景序号, 当前屏幕, 缓冲页面)
    缓冲页面.未知支持库函数_132 (背景缓冲页面, 0, 0, )
    缓冲页面2.未知支持库函数_124 (取颜色值 (147, 109, 23))
     ' 缓冲页面2.写文字 (5, 0, #蓝色, 到文本 (当前前景序号 ＋ 1))
    前景.画前景 (相加 (当前前景序号, 1), 当前屏幕, 缓冲页面2)
    缓冲页面2.未知支持库函数_132 (背景缓冲页面2, 0, 0, )
    赋值 (是否重画, 假)
    赋值 (老前景序号, 当前前景序号)
    画精灵 ()
.如果真结束


.如果 (大于 (主角.取X位置 (), 400))
    赋值 (填充距阵., 求余数 (缓冲页面X位置, 800))
    赋值 (填充距阵., 800)
    赋值 (填充距阵., 0)
    赋值 (填充距阵., 600)
    缓冲页面.未知支持库函数_132 (后台页面, 0, 0, 填充距阵)
    赋值 (填充距阵2., 0)
    赋值 (填充距阵2., 填充距阵.)
    赋值 (填充距阵2., 0)
    赋值 (填充距阵2., 600)
    缓冲页面2.未知支持库函数_132 (后台页面, 相减 (800, 填充距阵.), 0, 填充距阵2)
.否则
    
    缓冲页面.未知支持库函数_132 (后台页面, 0, 0, )
.如果结束


.如果真 (主角.取是否挂了 ())
    赋值 (.时钟周期, 0)
    小页面.未知支持库函数_111 (当前屏幕, 相加 (数据路径, “gfx\游戏结束.bmp”), )
    小页面.未知支持库函数_157 ()
    小页面.未知支持库函数_134 (后台页面, 250, 250, )
.如果真结束

.如果真 (全局是否过关)
     ' 时钟2.时钟周期 ＝ 0
    .如果 (等于 (第几关, 共几关))
        小页面.未知支持库函数_111 (当前屏幕, 相加 (数据路径, “gfx\恭喜1.bmp”), )
    .否则
        小页面.未知支持库函数_111 (当前屏幕, 相加 (数据路径, “gfx\恭喜.bmp”), )
    .如果结束
    
    小页面.未知支持库函数_157 ()
    小页面.未知支持库函数_134 (后台页面, 250, 250, )
.如果真结束

当前屏幕.未知支持库函数_69 (假, 假, 假)

.如果真 (主角.取是否挂了 ())
    延时 (2000)
    过关 (第几关)
    赋值 (.时钟周期, 20)
    
.如果真结束
背景缓冲页面.未知支持库函数_132 (缓冲页面, 0, 0, )
背景缓冲页面2.未知支持库函数_132 (缓冲页面2, 0, 0, )

.子程序 __启动窗口_被激活, 空白型, , 
赋值 (是否重画, 真)
假.未知支持库函数_35 (真, 真)
赋值 (.时钟周期, 20)


.子程序 __启动窗口_被取消激活, 空白型, , 
假.未知支持库函数_35 (假, 假)
赋值 (.时钟周期, 0)




.子程序 初始化物体, 逻辑型, , 
.局部变量 参文件名, 文本型, , "0", 
.局部变量 参位置, 未知类型0x2000D, , , 
.局部变量 参目录路径, 文本型, , , 
.局部变量 原精灵图, 文本型, , "2", 
.局部变量 数据库文件名, 文本型, , , 
.局部变量 计数, 整数型, , , 

赋值 (数据库文件名, 相加 (“frontgroud”, 到文本 (第几关), “.edb”))
重定义数组 (精灵列表, 假, 20)

.计次循环首 (20, 计数)
    精灵列表.从数据库中初化化 ( [计数], 计数, 数据库文件名)
.计次循环尾 ()

 ' 初始化主角
 ' 主角
赋值 (参位置., 0)
赋值 (参位置., #小主角顶边)
赋值 (参位置., #精灵宽度)
赋值 (参位置., #地面位置)
重定义数组 (参文件名, 假, 8)
赋值 (参文件名 [1], “gfx\characters\small\player1l.bmp”)
赋值 (参文件名 [2], “gfx\characters\small\player2l.bmp”)
赋值 (参文件名 [3], “gfx\characters\small\player3l.bmp”)
赋值 (参文件名 [4], “gfx\characters\small\player1r.bmp”)
赋值 (参文件名 [5], “gfx\characters\small\player2r.bmp”)
赋值 (参文件名 [6], “gfx\characters\small\player3r.bmp”)
赋值 (参文件名 [7], “gfx\characters\small\downl.bmp”)
赋值 (参文件名 [8], “gfx\characters\small\downr.bmp”)

主角.创建 (参文件名, 参位置, 数据路径, 0)
主角.置状态序号 (4)

.如果真 (等于 (主角.取等级 (), 2))
    主角.变大 ()
.如果真结束

返回 (真)


.子程序 出蘑菇, 整数型, , 
.参数 参X位置, 整数型, , 
.参数 参Y位置, 整数型, , 

.局部变量 变蘑茹, 蘑菇, , , 
.局部变量 变文件名, 文本型, , "1", 
.局部变量 变位置, 未知类型0x2000D, , , 
.局部变量 前景号, 整数型, , , 

重定义数组 (变文件名, 假, 1)
赋值 (变文件名 [1], “gfx\bonus\pilz.bmp”)
赋值 (变位置., 参X位置)
赋值 (变位置., 相减 (参Y位置, 40))
赋值 (变位置., 相加 (变位置., 40))
赋值 (变位置., 相加 (变位置., 40))
 ' 输出调试文本 (“变位置.底边=” ＋ 到文本 (变位置.底边))
赋值 (前景号, 相加 (相除 (参X位置, 800), 1))
变蘑茹.创建 (变文件名, 变位置, 数据路径, 相加 (精灵列表.取精灵数量 ( [前景号]), 1))
变蘑茹.置在哪个场景中 (前景号)
精灵列表.加入精灵 ( [前景号], 变蘑茹)
返回 (1)


.子程序 判断按键状态, 空白型, , 
判断按跳键状态 ()
判断按右键状态 ()
判断按左键状态 ()
判断按蹲键状态 ()
判断按回车状态 ()


.子程序 判断按回车状态, 空白型, , 
.局部变量 键状态, 整数型, , , 
.局部变量 次数, 整数型, , , 


.如果真 (并且 (全局是否过关, 小于 (第几关, 共几关)))
    .计次循环首 (#, 次数)
        赋值 (键状态, 次数.未知支持库函数_46 ()) ' 按下右方向键，向右移动精灵
        .如果真 (等于 (键状态, 3))
            赋值 (第几关, 相加 (第几关, 1))
            关初始化 ()
            初始化物体 ()
            赋值 (全局是否过关, 假)
            赋值 (是否重画, 真)
            跳出循环 ()
             ' 时钟2.时钟周期 ＝ 20
        .如果真结束
        
    .计次循环尾 ()
    
.如果真结束



.子程序 过关, 空白型, , 
.参数 几关, 空白型, , 


主角.置等级 (1)
赋值 (第几关, 几关)
关初始化 ()
初始化物体 ()
赋值 (全局是否过关, 假)
赋值 (是否重画, 真)




.子程序 判断按右键状态, 空白型, , 
.局部变量 键状态, 整数型, , , 
.局部变量 碰撞值, 整数型, , , 
.局部变量 碰撞, 碰撞结构, , , 
.局部变量 是否继续跳, 逻辑型, , , 
.局部变量 临时值, 整数型, , , 
.局部变量 XX, 整数型, , , 
.局部变量 YY, 整数型, , , 

.如果 (是否使用控制器)
    XX.未知支持库函数_32 (YY)
    .如果真 (大于或等于 (XX, 300))
        赋值 (键状态, 3)
    .如果真结束
    
.否则
    赋值 (键状态, 键右.未知支持库函数_46 ()) ' 按下右方向键，向右移动精灵
.如果结束

.如果真 (并且 (等于 (键状态, 3), 小于 (主角.取状态序号 (), 7), 等于 (全局是否过关, 假)))
    赋值 (方向全局, #向右走)
    主角.向右走 ()
     ' 主角.走 (精灵列表, 方向, 缓冲页面X位置)
.如果真结束

.如果真 (等于 (键状态, 1))
    主角.置状态序号 (4)
.如果真结束


.子程序 判断按左键状态, 空白型, , 
.局部变量 键状态, 整数型, , , 
.局部变量 碰撞值, 整数型, , , 
.局部变量 碰撞, 碰撞结构, , , 
.局部变量 是否继续跳, 逻辑型, , , 
.局部变量 临时值, 整数型, , , 
.局部变量 XX, 整数型, , , 
.局部变量 YY, 整数型, , , 

.如果 (是否使用控制器)
    XX.未知支持库函数_32 (YY)
    .如果真 (小于或等于 (XX, -300))
        赋值 (键状态, 3)
    .如果真结束
    
.否则
    赋值 (键状态, 键左.未知支持库函数_46 ()) ' 按下左方向键，向左移动精灵
.如果结束


.如果真 (并且 (等于 (键状态, 3), 小于 (主角.取状态序号 (), 7), 等于 (全局是否过关, 假)))
    赋值 (方向全局, #向左走)
    主角.向左走 ()
     ' 主角.走 (精灵列表, 方向, 缓冲页面X位置)
.如果真结束

.如果真 (等于 (键状态, 1))
    主角.置状态序号 (1)
.如果真结束


.子程序 判断按跳键状态, 空白型, , 
.局部变量 键状态, 整数型, , , 
.局部变量 碰撞值, 整数型, , , 
.局部变量 碰撞, 碰撞结构, , , 
.局部变量 临时值, 整数型, , , 

赋值 (键状态, 键跳.未知支持库函数_46 ())
.如果真 (并且 (等于 (键状态, 3), 主角.取一次跳结束 (), 等于 (主角.取是否蹲下 (), 假), 等于 (全局是否过关, 假))) ' 按下左CTRL键，跳动
    主角.向上走 ()
    
.如果真结束


.子程序 判断按蹲键状态, 空白型, , 
.局部变量 键状态, 整数型, , , 
.局部变量 XX, 整数型, , , 
.局部变量 YY, 整数型, , , 

.如果 (是否使用控制器)
    XX.未知支持库函数_32 (YY)
    .如果 (大于或等于 (YY, 300))
        赋值 (键状态, 3)
    .否则
        赋值 (键状态, 1)
    .如果结束
    
    
.否则
    赋值 (键状态, 键下.未知支持库函数_46 ()) ' 按下下方向键，蹲下精灵
.如果结束

.如果真 (并且 (等于 (键状态, 3), 等于 (主角.取是否蹲下 (), 假), 主角.取一次跳结束 (), 等于 (全局是否过关, 假)))
    主角.蹲下 (方向全局)
.如果真结束
 ' 
.如果真 (并且 (等于 (键状态, 1), 主角.取是否蹲下 ()))
    主角.站起 (方向全局)
.如果真结束
 ' 

.子程序 画精灵, 空白型, , 
.局部变量 位置222, 未知类型0x2000D, , , 
.局部变量 计次, 整数型, , , 
.局部变量 临时值, 整数型, , , 
.局部变量 临时值1, 整数型, , , 
.局部变量 临时精灵, 精灵基类, , , 


赋值 (当前前景序号, 相加 (相除 (缓冲页面X位置, 800), 1))
.如果 (等于 (求余数 (当前前景序号, 2), 0))
    .如果 (等于 (求余数 (绝对取整 (相加 (相除 (主角.取X位置 (), 800), 1)), 2), 0))
        主角.画碰撞效果 (当前屏幕, 缓冲页面, 2, 30)
    .否则
        主角.画碰撞效果 (当前屏幕, 缓冲页面2, 2, 30)
    .如果结束
    
.否则
    .如果 (等于 (求余数 (绝对取整 (相加 (相除 (主角.取X位置 (), 800), 1)), 2), 0))
        主角.画碰撞效果 (当前屏幕, 缓冲页面2, 2, 30)
    .否则
        主角.画碰撞效果 (当前屏幕, 缓冲页面, 2, 30)
    .如果结束
    
.如果结束

.如果真 (大于 (求余数 (主角.取X位置 (), 800), 760))
    赋值 (位置222, 主角.取位置 ())
    主角.置位置 (相减 (求余数 (主角.取X位置 (), 800), 800), 位置222.)
    主角.画碰撞效果 (当前屏幕, 缓冲页面2, 2, 30)
    主角.置位置 (位置222., 位置222.)
.如果真结束

赋值 (临时值1, 精灵列表.取精灵数量 ( [当前前景序号]))
.计次循环首 (精灵列表.取精灵数量 ( [当前前景序号]), 计次)
    赋值 (临时精灵, 精灵列表.取精灵 ( [当前前景序号], 计次))
    .如果真 (不等于 (临时精灵.取标记 (), -1))
        赋值 (临时值, 精灵列表.画碰撞效果 ( [当前前景序号], 当前屏幕, 缓冲页面, 1, 几次时钟, 计次))
        .如果真 (等于 (临时值, #效果画完))
             ' 精灵列表 [当前前景序号].删除精灵 (临时精灵)
            精灵列表.置标记 ( [当前前景序号], -1, 计次)
        .如果真结束
        
        .如果真 (等于 (临时值, #过关))
            赋值 (全局是否过关, 真)
            跳出循环 ()
        .如果真结束
        
        .如果真 (不等于 (临时值1, 精灵列表.取精灵数量 ( [当前前景序号])))
            跳出循环 ()
        .如果真结束
        
        
        
        .如果真 (大于 (求余数 (精灵列表.取X位置 ( [当前前景序号], 计次), 800), 760))
            赋值 (位置222, 精灵列表.取位置 ( [当前前景序号], 计次))
            精灵列表.置位置 ( [当前前景序号], 相减 (求余数 (精灵列表.取X位置 ( [当前前景序号], 计次), 800), 800), 位置222., 计次)
            精灵列表.置是否换场景 ( [当前前景序号], 假, 计次)
            精灵列表.画碰撞效果 ( [当前前景序号], 当前屏幕, 缓冲页面2, 1, 几次时钟, 计次)
            
            精灵列表.置是否换场景 ( [当前前景序号], 真, 计次)
            精灵列表.置位置 ( [当前前景序号], 位置222., 位置222., 计次)
            
            
        .如果真结束
        
        
    .如果真结束
    
    
.计次循环尾 ()

赋值 (临时值1, 精灵列表.取精灵数量 ( [相加 (当前前景序号, 1)]))
.计次循环首 (精灵列表.取精灵数量 ( [相加 (当前前景序号, 1)]), 计次)
    赋值 (临时精灵, 精灵列表.取精灵 ( [相加 (当前前景序号, 1)], 计次))
    .如果真 (不等于 (临时精灵.取标记 (), -1))
        赋值 (临时值, 精灵列表.画碰撞效果 ( [相加 (当前前景序号, 1)], 当前屏幕, 缓冲页面2, 1, 几次时钟, 计次))
        .如果真 (等于 (临时值, #效果画完))
             ' 精灵列表 [当前前景序号 ＋ 1].删除精灵 (临时精灵)
            精灵列表.置标记 ( [相加 (当前前景序号, 1)], -1, 计次)
        .如果真结束
        
        .如果真 (等于 (临时值, #过关))
            赋值 (全局是否过关, 真)
            跳出循环 ()
        .如果真结束
        
        .如果真 (不等于 (临时值1, 精灵列表.取精灵数量 ( [相加 (当前前景序号, 1)])))
            跳出循环 ()
        .如果真结束
        
        
        
    .如果真结束
    
.计次循环尾 ()

精灵列表.清空有删除标记的精灵 ( [当前前景序号])
精灵列表.清空有删除标记的精灵 ( [相加 (当前前景序号, 1)])
 ' 画分数
缓冲页面.未知支持库函数_126 (730, 20, #白色, 相加 (“分：”, 到文本 (分数)))
缓冲页面2.未知支持库函数_126 (730, 20, #白色, 相加 (“分：”, 到文本 (分数)))

.子程序 加分, 空白型, , 
.参数 参, 整数型, , 

赋值 (分数, 相加 (分数, 参))


.子程序 关初始化, 空白型, , 

前景.初始化 (数据路径, 相加 (“frontgroud”, 到文本 (第几关), “.edb”), “litterAni.edb”)

MIDI.未知支持库函数_196 (相加 (数据路径, “sfx\music\groove5.mid”))
赋值 (缓冲页面X位置, 0)
赋值 (当前前景序号, 1)
赋值 (老前景序号, 1)
赋值 (几次时钟, 0)
重定义数组 (将消失精灵列表, 假, 20)


.类模块 前景类, , , 

.程序集变量 路径, 文本型, , , 
.程序集变量 数据库名, 文本型, , , 
.程序集变量 动画数据库名, 文本型, , , 
.程序集变量 小块页面数组, 未知类型0x2000B, , "0", 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用



.子程序 初始化, 空白型, 公开, 
.参数 参路径, 文本型, , 
.参数 参数据库名, 文本型, , 
.参数 参动数据库名, 文本型, , 


赋值 (路径, 参路径)
赋值 (数据库名, 参数据库名)
赋值 (动画数据库名, 参动数据库名)



.子程序 画前景, 逻辑型, 公开, 
.参数 前景序号, 整数型, , 
.参数 参屏幕, 未知类型0x20007, , 
.参数 目标页面, 未知类型0x2000B, , 

.局部变量 序号, 整数型, , , 
.局部变量 图文件名, 文本型, , , 
.局部变量 数名, 文本型, , , 
.局部变量 图类型, 整数型, , , 
.局部变量 地面块, 块堆, , , 
.局部变量 临时页面, 未知类型0x2000B, , , 
.局部变量 物体序号, 整数型, , , 

赋值 (数名, 相加 (数据路径, “database\”, 数据库名))
赋值 (返回值, 打开 (数名, , , , , , ))
.如果真 (取反 (返回值))
    输出调试文本 (“前景类:画前景:打开数据库出错.”)
    返回 (假)
.如果真结束

到首记录 ()
.判断循环首 (取反 (尾记录后 ()))
    赋值 (序号, 读 (“前景序号”))
    .如果真 (等于 (序号, 前景序号))
        赋值 (物体序号, 读 (“物品序号”))
        .如果真 (不等于 (物体序号, 0))
            跳过 ()
            到循环尾 ()
        .如果真结束
        
        赋值 (图文件名, 相加 (路径, 读 (“文件名”)))
        赋值 (图类型, 读 (“类型”))
        .判断开始 (等于 (图类型, 1)) ' 类型1表示块
            地面块.填充块 (读 (“块宽”), 读 (“块长”), 目标页面.未知支持库函数_168 (), 目标页面.未知支持库函数_169 (), 图文件名)
            赋值 (返回值, 地面块.画所有块 (参屏幕, 目标页面, 读 (“横向位置”), 读 (“纵向位置”)))
            .如果真 (取反 (返回值))
                输出调试文本 (相加 (“前景类:地面块.画所有块,出错.”, 图文件名))
                关闭 ()
                返回 (假)
            .如果真结束
            
        .判断 (等于 (图类型, 2)) ' 类型2表示一次图
            赋值 (返回值, 临时页面.未知支持库函数_111 (参屏幕, 图文件名, ))
            .如果真 (取反 (返回值))
                输出调试文本 (相加 (“前景类:地面块.,临时页面.建位图页面.出错.”, 图文件名))
                关闭 ()
                返回 (假)
            .如果真结束
            
            临时页面.未知支持库函数_157 ()
            赋值 (返回值, 临时页面.未知支持库函数_134 (目标页面, 读 (“横向位置”), 读 (“纵向位置”), ))
            .如果真 (取反 (返回值))
                输出调试文本 (相加 (“前景类:地面块.,临时页面.透空块复制.出错.”, 图文件名))
                关闭 ()
                返回 (假)
            .如果真结束
            
        .判断 (等于 (图类型, 3)) ' 类型3表示画几块
            地面块.填充块 (读 (“块宽”), 读 (“块长”), 目标页面.未知支持库函数_168 (), 目标页面.未知支持库函数_169 (), 图文件名)
            赋值 (返回值, 地面块.画几块 (参屏幕, 目标页面, 读 (“横向位置”), 读 (“纵向位置”), 读 (“块数”)))
            .如果真 (取反 (返回值))
                输出调试文本 (相加 (“前景类:地面块.画几块,出错.”, 图文件名))
                关闭 ()
                返回 (假)
            .如果真结束
            
        .默认
            
        .判断结束
        
    .如果真结束
    跳过 ()
.判断循环尾 ()

关闭 ()
返回 (真)


.子程序 画固定小动画, 逻辑型, 公开, 
.参数 前景序号, 整数型, , 
.参数 参屏幕, 未知类型0x20007, , 
.参数 目标页面, 未知类型0x2000B, , 
.参数 参动画序号, 整数型, , 如果此参数为0说明要画所有的动画

.局部变量 序号, 整数型, , , 
.局部变量 图文件名, 文本型, , , 
.局部变量 数名, 文本型, , , 
.局部变量 地面块, 块堆, , , 
.局部变量 临时页面, 未知类型0x2000B, , , 
.局部变量 图序号, 整数型, , , 
.局部变量 动画序号, 整数型, , , 
.局部变量 当前画第几个, 整数型, , , 
.局部变量 一共几幅图, 整数型, , , 
.局部变量 x, 整数型, , , 
.局部变量 y, 整数型, , , 
.局部变量 块长, 整数型, , , 
.局部变量 块宽, 整数型, , , 
.局部变量 记录号, 整数型, , , 
.局部变量 临时记录号, 整数型, , , 
.局部变量 距形, 未知类型0x2000D, , , 
.局部变量 原数组个数, 整数型, , , 

赋值 (数名, 相加 (路径, “database\”, 动画数据库名))
赋值 (返回值, 打开 (数名, , , , , , ))
.如果真 (取反 (返回值))
    输出调试文本 (“前景类:画固定小动画:打开数据库出错.”)
    返回 (假)
.如果真结束

到首记录 ()
.判断循环首 (取反 (尾记录后 ()))
    赋值 (序号, 读 (“前景序号”))
    .如果真 (等于 (序号, 前景序号))
        .如果真 (取反 (读 (“是否主记录”)))
            跳过 ()
            到循环尾 ()
        .如果真结束
        
        赋值 (记录号, 取记录号 ())
        赋值 (动画序号, 读 (“动画序号”))
        .如果真 (并且 (不等于 (参动画序号, 0), 不等于 (参动画序号, 动画序号)))
            跳过 ()
            到循环尾 ()
        .如果真结束
        
        赋值 (原数组个数, 取数组成员数 (小块页面数组))
        .如果真 (大于 (动画序号, 原数组个数))
            重定义数组 (小块页面数组, 真, 动画序号)
        .如果真结束
        
        赋值 (一共几幅图, 读 (“图片个数”))
        赋值 (图序号, 读 (“图序号”))
        赋值 (当前画第几个, 读 (“当前画第几个”))
        赋值 (x, 读 (“横向位置”))
        赋值 (y, 读 (“纵向位置”))
        赋值 (块长, 读 (“块长”))
        赋值 (块宽, 读 (“块宽”))
        赋值 (距形., x)
        赋值 (距形., 相加 (x, 块宽))
        赋值 (距形., y)
        赋值 (距形., 相加 (y, 块长))
        
        .如果真 (大于 (动画序号, 原数组个数))
            小块页面数组.未知支持库函数_110 ( [动画序号], 参屏幕, 块宽, 块长, )
            赋值 (返回值, 目标页面.未知支持库函数_132 (小块页面数组 [动画序号], 0, 0, 距形))
            .如果真 (取反 (返回值))
                输出调试文本 (“前景类:目标页面.块复制 (小块页面数组 [动画序号], x, y, 距形.出错..”)
                关闭 ()
                返回 (假)
            .如果真结束
            
        .如果真结束
        
        
        .判断循环首 (不等于 (图序号, 当前画第几个))
            跳过 ()
            .如果真 (是否为调试版 ())
                .如果真 (大于 (图序号, 一共几幅图))
                    输出调试文本 (“前景类:画固定小动画!!!图序号计算失败。。。”)
                    关闭 ()
                    返回 (假)
                .如果真结束
                
            .如果真结束
            
            赋值 (图序号, 读 (“图序号”))
             ' 输出调试文本 (“图序号=” ＋ 到文本 (图序号) ＋ “,” ＋ “一共几副图=” ＋ 到文本 (一共几幅图))
        .判断循环尾 ()
        
        赋值 (图文件名, 相加 (路径, 读 (“文件名”)))
        赋值 (返回值, 临时页面.未知支持库函数_111 (参屏幕, 图文件名, ))
        .如果真 (取反 (返回值))
            输出调试文本 (相加 (“前景类:画固定小动画.,临时页面.建位图页面.出错.”, 图文件名))
            关闭 ()
            返回 (假)
        .如果真结束
        
        小块页面数组.未知支持库函数_132 ( [动画序号], 目标页面, x, y, )
        临时页面.未知支持库函数_157 ()
        赋值 (返回值, 临时页面.未知支持库函数_134 (目标页面, x, y, ))
        .如果真 (取反 (返回值))
            输出调试文本 (相加 (“前景类:画固定小动画.,临时页面.透空块复制.出错.”, 图文件名))
            关闭 ()
            返回 (假)
        .如果真结束
        
        赋值 (当前画第几个, 相加 (当前画第几个, 1))
        .如果真 (大于 (当前画第几个, 一共几幅图))
            赋值 (当前画第几个, 1)
        .如果真结束
        
        赋值 (临时记录号, 取记录号 ())
        跳到 (记录号)
        写 (“当前画第几个”, 当前画第几个)
        跳到 (临时记录号)
    .如果真结束
    跳过 ()
.判断循环尾 ()
关闭 ()
返回 (真)


.类模块 精灵基类, , , 

.程序集变量 位置, 未知类型0x2000D, , , 
.程序集变量 精灵原位置, 未知类型0x2000D, , , 
.程序集变量 状态序号, 整数型, , , 0.无状态   1.动画1帧   2.动画2帧....
.程序集变量 文件名, 文本型, , "1", //精灵动画文件名
.程序集变量 目录路径11, 文本型, , , 
.程序集变量 时钟周期, 整数型, , , 多少时钟周期才画一次
.程序集变量 标记, 整数型, , , 
.程序集变量 在哪个场景中, 整数型, , , 
.程序集变量 物体序号, 整数型, , , 
.程序集变量 记数, 整数型, , , 
.程序集变量 是否换场景, 逻辑型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
赋值 (时钟周期, 1)
赋值 (记数, 1)
赋值 (在哪个场景中, 0)
赋值 (是否换场景, 真)

.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用



.子程序 置是否换场景, 空白型, 公开, 
.参数 参, 逻辑型, , 

赋值 (是否换场景, 参)

.子程序 取是否换场景, 逻辑型, 公开, 
返回 (是否换场景)

.子程序 置在哪个场景中, 空白型, 公开, 
.参数 参, 整数型, , 

赋值 (在哪个场景中, 参)


.子程序 取在哪个场景中, 整数型, 公开, 
返回 (在哪个场景中)


.子程序 取位置, 未知类型0x2000D, 公开, 
返回 (位置)


.子程序 置文件名, 空白型, 公开, 
.参数 参文, 文本型, 数组, 

赋值 (文件名, 参文)

.子程序 取目录路径, 文本型, 公开, 
返回 (目录路径11)

.子程序 置时钟周期, 空白型, 公开, 
.参数 参期, 整数型, , 

赋值 (时钟周期, 参期)


.子程序 取时钟周期, 整数型, 公开, 
返回 (时钟周期)

.子程序 取文件名, 文本型, 公开, 
.参数 参状态序号, 整数型, , 

.如果真 (大于 (参状态序号, 取数组成员数 (文件名)))
    输出调试文本 (“文件名 [参状态序号] 越界”)
    返回 (“”)
.如果真结束
返回 (文件名 [参状态序号])

.子程序 置状态序号, 整数型, 公开, 返回-1表示超过了最大状态序号,其它表示成功
.参数 参状态序号, 整数型, , 

.如果真 (大于 (参状态序号, 取数组成员数 (文件名)))
    返回 (-1)
.如果真结束

赋值 (状态序号, 参状态序号)
返回 (0)

.子程序 取状态序号, 整数型, 公开, 
 ' 输出调试文本 (到文本 (状态序号))
返回 (状态序号)


.子程序 创建, 空白型, 公开, 
.参数 参文件名, 文本型, 数组, 
.参数 参位置, 未知类型0x2000D, , 
.参数 参目录路径, 文本型, , 
.参数 参标记, 整数型, , 

赋值 (位置, 参位置)
重定义数组 (文件名, 假, 取数组成员数 (参文件名))
赋值 (文件名, 参文件名)
赋值 (状态序号, 0)
赋值 (标记, 参标记)
赋值 (目录路径11, 参目录路径)

.子程序 计算碰撞效果, 整数型, 公开, 0.掉沟里 1.挂了 2.通过 3.通不过 4.变小 5.变大 6.出O菇
.参数 参碰撞结构, 碰撞结构, , 

返回 (1)


.子程序 画碰撞效果, 整数型, 公开, 0,成功, 1,不用画, -1失败, -2效果画完
.参数 参屏幕, 未知类型0x20007, , 
.参数 目标页面, 未知类型0x2000B, , 
.参数 复制方式, 整数型, , 1,块复制. 2,透空块复制
.参数 当前时钟周期, 整数型, , 

.局部变量 小页面, 未知类型0x2000B, , , 
.局部变量 图路径, 文本型, , , 

.如果真 (等于 (状态序号, 0))
    返回 (1)
.如果真结束

.如果真 (不等于 (求余数 (当前时钟周期, 时钟周期), 0))
    返回 (1)
.如果真结束

赋值 (图路径, 相加 (目录路径11, 文件名 [状态序号]))
赋值 (返回值, 小页面.未知支持库函数_111 (参屏幕, 图路径, ))
.如果真 (取反 (返回值))
    输出调试文本 (相加 (“精灵基类:画碰撞效果，建位图页面失败！”, 图路径))
    返回 (-1)
.如果真结束

.判断开始 (等于 (复制方式, 1))
    赋值 (返回值, 小页面.未知支持库函数_132 (目标页面, 位置., 位置., ))
    
.判断 (等于 (复制方式, 2))
    小页面.未知支持库函数_157 ()
    赋值 (返回值, 小页面.未知支持库函数_134 (目标页面, 位置., 位置., ))
.默认
    
.判断结束

.如果真 (取反 (返回值))
    输出调试文本 (相加 (“精灵基类:画碰撞效果，小页面.复制失败！”, 图路径))
    返回 (-1)
.如果真结束

返回 (0)



.子程序 取标记, 整数型, 公开, 
返回 (标记)


.子程序 置标记, 空白型, 公开, 
.参数 参标记, 整数型, , 

赋值 (标记, 参标记)


.子程序 置位置, 空白型, 公开, 
.参数 X位置, 整数型, , 
.参数 Y位置, 整数型, , 

赋值 (位置., 相加 (相减 (位置., 位置.), X位置))
赋值 (位置., 相加 (相减 (位置., 位置.), Y位置))
赋值 (位置., X位置)
赋值 (位置., Y位置)
 ' 原Y位置 ＝ Y位置



.子程序 置底边位置, 空白型, 公开, 
.参数 底边位置, 整数型, , 

赋值 (位置., 相减 (底边位置, 相减 (位置., 位置.)))
赋值 (位置., 底边位置)


.子程序 取底边位置, 整数型, 公开, 
返回 (位置.)

.子程序 取X位置, 整数型, 公开, 
返回 (位置.)


.子程序 取Y位置, 整数型, 公开, 
返回 (位置.)


.子程序 置物体序号, 空白型, 公开, 
.参数 序号, 整数型, , 

赋值 (物体序号, 序号)

.子程序 取物体序号, 整数型, 公开, 
返回 (物体序号)



.子程序 置目录路径, 空白型, 公开, 
.参数 参目录路径, 文本型, , 

赋值 (目录路径11, 参目录路径)


.子程序 置精灵大小, 空白型, 公开, 
.参数 宽度, 整数型, , 
.参数 高度, 整数型, , 

赋值 (位置., 相加 (位置., 宽度))
赋值 (位置., 相加 (位置., 高度))




.子程序 碰撞检测, 碰撞结构, 公开, 
.参数 参精灵列表, 精灵列表类, , 
.参数 方向, 整数型, , 1.左 2.右 3.上 4.下
.参数 参缓冲页面X位置, 整数型, , 

.局部变量 计数, 整数型, , , 
.局部变量 临时精灵, 精灵基类, , , 
.局部变量 碰撞, 碰撞结构, , , 
.局部变量 位置1, 未知类型0x2000D, , , 
.局部变量 位置2, 未知类型0x2000D, , , 

 ' 遍历精灵列表，检测精灵之间的碰撞
 ' 输出调试文本 (“精灵个数:” ＋ 到文本 (参精灵列表.取精灵数量 ()))

赋值 (位置1, 取位置 ())
 ' 输出调试文本 (“左1:” ＋ 到文本 (位置1.左边) ＋ “ 顶1:” ＋ 到文本 (位置1.顶边) ＋ “ 右1:” ＋ 到文本 (位置1.右边) ＋ “ 底1:” ＋ 到文本 (位置1.底边))
.计次循环首 (参精灵列表.取精灵数量 (), 计数)
    赋值 (临时精灵, 参精灵列表.取精灵 (计数))
    .如果真 (等于 (标记, 临时精灵.取标记 ())) ' 自己跳过
        到循环尾 ()
    .如果真结束
    
    赋值 (位置2, 临时精灵.取位置 ())
    赋值 (位置2., 位置2.) ' － 取绝对值 (参缓冲页面X位置)
    .如果真 (小于 (位置2., 0))
        到循环尾 ()
    .如果真结束
    
    .如果 (等于 (方向, 1)) ' 如果向左移动
        .如果真 (或者 (大于 (位置1., 位置2.), 小于 (位置1., 位置2.), 大于 (位置1., 位置2.), 小于 (位置1., 位置2.)))
            到循环尾 ()
        .如果真结束
        
    .否则
        .如果真 (或者 (大于 (位置1., 位置2.), 小于 (位置1., 位置2.), 大于 (位置1., 位置2.), 小于 (位置1., 位置2.)))
            到循环尾 ()
        .如果真结束
        
    .如果结束
    
     ' 输出调试文本 (“左2:” ＋ 到文本 (位置2.左边) ＋ “ 顶2:” ＋ 到文本 (位置2.顶边) ＋ “ 右2:” ＋ 到文本 (位置2.右边) ＋ “ 底2:” ＋ 到文本 (位置2.底边))
    赋值 (碰撞.物体序号, 临时精灵.取物体序号 ())
    赋值 (碰撞.主角等级, -1)
    赋值 (碰撞.主角身体部位, #身体)
    赋值 (碰撞.第几个精灵, 计数)
     ' 输出调试文本 (到文本 (位置1.底边) ＋ “,” ＋ 到文本 (位置2.顶边))
    .如果真 (小于或等于 (位置1., 位置2.))
         ' 输出调试文本 (“come here2”)
        赋值 (碰撞.主角身体部位, #脚) ' 主角脚与其它物体发生碰撞
    .如果真结束
    
    
    返回 (碰撞)
    
.计次循环尾 ()

赋值 (碰撞.物体序号, -1)
返回 (碰撞)


.子程序 置记数, 空白型, 公开, 
.参数 参记数, 整数型, , 

赋值 (记数, 参记数)


.子程序 取精灵高度, 整数型, 公开, 
返回 (相减 (位置., 位置.))



.子程序 取顶边位置, 整数型, 公开, 
返回 (位置.)



.子程序 两距形是否相交, 逻辑型, , 
.参数 距1, 未知类型0x2000D, , 
.参数 距2, 未知类型0x2000D, , 


.如果 (或者 (小于或等于 (距1., 距2.), 小于或等于 (距1., 距2.), 大于或等于 (距1., 距2.), 大于或等于 (距1., 距2.)))
    返回 (假)
.否则
    返回 (真)
.如果结束


.子程序 交换场景, 空白型, , 
.参数 精灵前景位置, 整数型, , 

.局部变量 临时精灵, 精灵基类, , , 
.局部变量 旧标记, 整数型, , , 


.如果真 (等于 (取绝对值 (相减 (精灵前景位置, 在哪个场景中)), 1))
    赋值 (临时精灵, 精灵列表.据标记取精灵 ( [在哪个场景中], 标记))
    赋值 (旧标记, 临时精灵.取标记 ())
    临时精灵.置标记 (相加 (精灵列表.取精灵数量 ( [精灵前景位置]), 1))
    临时精灵.置在哪个场景中 (精灵前景位置)
    
    精灵列表.加入精灵 ( [精灵前景位置], 临时精灵)
    
     ' 当前标记置为-1
    赋值 (标记, -1)
     ' 临时精灵.置标记 (旧标记)
     ' 精灵列表 [在哪个场景中].删除精灵 (临时精灵)
.如果真结束








.类模块 普通砖, 精灵基类, , 

.程序集变量 砖块位置, 未知类型0x2000D, , , 
.程序集变量 上飞1, 整数型, , , 
.程序集变量 上飞2, 整数型, , , 
.程序集变量 上飞顶, 整数型, , , 
.程序集变量 精灵原文件名, 文本型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
置时钟周期 (1)
置物体序号 (#普通砖)

.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 置精灵原文件名, 逻辑型, 公开, 
.参数 文, 文本型, , 

赋值 (精灵原文件名, 文)
返回 (真)

.子程序 计算碰撞效果, 整数型, 公开, 0.掉沟里 1.挂了 2.通过 3.通不过
.参数 参碰撞结构, 碰撞结构, , 

.局部变量 数组个数, 文本型, , "20", 

 ' 输出调试文本 (到文本 (参碰撞结构.主角等级) ＋ “,” ＋ 到文本 (参碰撞结构.主角身体部位) ＋ “,” ＋ 精灵原文件名)
.如果真 (等于 (精灵原文件名, “”))
    返回 (#通过)
.如果真结束

.判断开始 (并且 (大于 (参碰撞结构.主角等级, 1), 等于 (参碰撞结构.主角身体部位, #头), 不等于 (精灵原文件名, “”), 等于 (参碰撞结构.主角状态, #上升))) ' 大和头,砖碎了
    波形声音.未知支持库函数_230 (声音句柄, 相加 (数据路径, “sfx\crack.wav”), )
    波形声音.未知支持库函数_231 ()
    
    置状态序号 (1)
    赋值 (砖块位置, 取位置 ())
    赋值 (上飞1, 砖块位置.)
    赋值 (上飞2, 砖块位置.)
    赋值 (上飞顶, 砖块位置.)
    赋值 (数组个数 [1], 取文件名 (1))
    置文件名 (数组个数)
    赋值 (精灵原文件名, “”)
    返回 (#通过)
.判断 (等于 (参碰撞结构.主角身体部位, #脚))
    返回 (#通不过)
.默认
    
.判断结束
返回 (#通不过)

.子程序 画碰撞效果, 整数型, 公开, 0,成功, 1,不用画, -1失败
.参数 参屏幕, 未知类型0x20007, , 
.参数 目标页面, 未知类型0x2000B, , 
.参数 复制方式, 整数型, , 1,块复制. 2,透空块复制
.参数 当前时钟周期, 整数型, , 

.局部变量 小页面, 未知类型0x2000B, , , 
.局部变量 当前状态序号, 整数型, , , 
.局部变量 图路径, 文本型, , , 

 ' 输出调试文本 (“sdfsd”)
.如果真 (不等于 (精灵原文件名, “”))
    赋值 (图路径, 相加 (取目录路径 (), 精灵原文件名))
    小页面.未知支持库函数_111 (参屏幕, 图路径, )
    小页面.未知支持库函数_132 (目标页面, 求余数 (取X位置 (), 800), 取Y位置 (), )
.如果真结束

 ' 输出调试文本 (“精灵基类.取状态序号 ()111 = ” ＋ 到文本 (精灵基类.取状态序号 ()))
赋值 (当前状态序号, 取状态序号 ())
.如果真 (等于 (当前状态序号, 0))
    返回 (1)
.如果真结束

.如果真 (不等于 (求余数 (当前时钟周期, 取时钟周期 ()), 0))
    返回 (1)
.如果真结束


赋值 (图路径, 相加 (取目录路径 (), 取文件名 (1)))
赋值 (返回值, 小页面.未知支持库函数_111 (参屏幕, 图路径, ))
.如果真 (取反 (返回值))
    输出调试文本 (相加 (“精灵基类:画碰撞效果，建位图页面失败！”, 图路径))
    返回 (-1)
.如果真结束

赋值 (返回值, 小页面.未知支持库函数_132 (目标页面, 求余数 (砖块位置., 800), 砖块位置., ))
赋值 (返回值, 小页面.未知支持库函数_132 (目标页面, 求余数 (砖块位置., 800), 砖块位置., ))
赋值 (返回值, 小页面.未知支持库函数_132 (目标页面, 求余数 (上飞1, 800), 上飞顶, ))
赋值 (返回值, 小页面.未知支持库函数_132 (目标页面, 求余数 (上飞2, 800), 上飞顶, ))
赋值 (砖块位置., 相减 (砖块位置., 5))
赋值 (砖块位置., 相加 (砖块位置., 5))
赋值 (砖块位置., 相加 (砖块位置., 5))
赋值 (上飞1, 相减 (上飞1, 5))
赋值 (上飞2, 相加 (上飞2, 5))
赋值 (上飞顶, 相减 (上飞顶, 5))
.如果真 (取反 (返回值))
    输出调试文本 (相加 (“精灵基类:画碰撞效果，小页面.复制失败！”, 图路径))
    返回 (-1)
.如果真结束

 ' 输出调试文本 (“精灵基类.取状态序号 () ＋ 1 = ” ＋ 到文本 (精灵基类.取状态序号 () ＋ 1))
.如果真 (等于 (置状态序号 (相加 (取状态序号 (), 1)), -1))
    置状态序号 (0)
    返回 (#效果画完)
.如果真结束

 ' 输出调试文本 (“精灵基类.取状态序号 () = ” ＋ 到文本 (精灵基类.取状态序号 ()))
返回 (0)


.类模块 精灵列表类, , , 

.程序集变量 精灵列表成员, 精灵基类, , "0", 
.程序集变量 序号, 整数型, , , 
.程序集变量 当前标记, 整数型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
赋值 (序号, 1)
赋值 (当前标记, 0)

.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 加入精灵, 空白型, 公开, 
.参数 精灵, 精灵基类, , 

赋值 (当前标记, 相加 (当前标记, 1))
精灵.置标记 (当前标记)
加入成员 (精灵列表成员, 精灵)


.子程序 清空有删除标记的精灵, 空白型, 公开, 
.判断循环首 (真)
    .如果真 (等于 (删除精灵 (), 假))
        跳出循环 ()
    .如果真结束
    
.判断循环尾 ()

.子程序 删除精灵, 逻辑型, , 返回是否再删一次
.局部变量 是否继续, 逻辑型, , , 
.局部变量 计次, 整数型, , , 

赋值 (是否继续, 假)
.计次循环首 (取数组成员数 (精灵列表成员), 计次)
    .如果真 (等于 (精灵列表成员.取标记 ( [计次]), -1))
        删除成员 (精灵列表成员, 计次, )
        赋值 (是否继续, 真)
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
返回 (是否继续)


.子程序 取精灵数量, 整数型, 公开, 
返回 (取数组成员数 (精灵列表成员))


.子程序 清空列表, 空白型, 公开, 
清除数组 (精灵列表成员)


.子程序 取第一个精灵, 精灵基类, 公开, 
.局部变量 临时精灵, 精灵基类, , , 

.如果 (大于 (取数组成员数 (精灵列表成员), 0))
    返回 (精灵列表成员 [1])
    赋值 (序号, 1)
.否则
    临时精灵.置标记 (-1)
    返回 (临时精灵)
.如果结束


.子程序 取下一个精灵, 精灵基类, 公开, 
.局部变量 临时精灵, 精灵基类, , , 

.如果真 (大于 (相加 (序号, 1), 取数组成员数 (精灵列表成员)))
    临时精灵.置标记 (-1)
    返回 (临时精灵)
.如果真结束
赋值 (序号, 相加 (序号, 1))
返回 (精灵列表成员 [序号])


.子程序 取精灵, 精灵基类, 公开, 
.参数 参序号, 整数型, , 

.局部变量 临时精灵, 精灵基类, , , 

.如果真 (或者 (大于 (参序号, 取数组成员数 (精灵列表成员)), 小于或等于 (参序号, 0)))
    临时精灵.置物体序号 (-1)
    临时精灵.置标记 (-1)
    返回 (临时精灵)
.如果真结束
返回 (精灵列表成员 [参序号])



.子程序 据标记取精灵, 精灵基类, 公开, 
.参数 参标记, 整数型, , 

.局部变量 计次, 整数型, , , 
.局部变量 临时精灵, 精灵基类, , , 

.计次循环首 (取数组成员数 (精灵列表成员), 计次)
    .如果真 (等于 (精灵列表成员.取标记 ( [计次]), 参标记))
        返回 (精灵列表成员 [计次])
    .如果真结束
    
.计次循环尾 ()

临时精灵.置物体序号 (-1)
临时精灵.置标记 (-1)
返回 (临时精灵)



.子程序 从数据库中初化化, 逻辑型, 公开, 
.参数 参前景序号, 整数型, , 
.参数 目录路径, 文本型, , 

.局部变量 普通砖变, 普通砖, , , 
.局部变量 金币砖变, 金币砖, , , 
.局部变量 障碍物变, 障碍物, , , 
.局部变量 蘑菇砖变, 蘑菇砖, , , 
.局部变量 小敌人变, 敌人, , , 
.局部变量 金币变, 金币, , , 
.局部变量 沟变, 沟, , , 
.局部变量 鸭子变, 鸭子, , , 
.局部变量 城堡变, 城堡, , , 
.局部变量 数路名, 文本型, , , 
.局部变量 物品序号, 整数型, , , 
.局部变量 参文件名, 文本型, , "1", 
.局部变量 原文件名, 文本型, , , 
.局部变量 参位置, 未知类型0x2000D, , , 
.局部变量 连续块数, 整数型, , , 
.局部变量 循环次数, 整数型, , , 


赋值 (数路名, 相加 (数据路径, “database\”, 目录路径))

赋值 (返回值, 打开 (数路名, , , , , , ))
.如果真 (取反 (返回值))
    输出调试文本 (相加 (“从数据库中初化化,失败。”, 数路名))
    返回 (假)
.如果真结束


到首记录 ()
.判断循环首 (取反 (尾记录后 ()))
    .如果真 (不等于 (参前景序号, 读 (“前景序号”)))
        跳过 ()
        到循环尾 ()
    .如果真结束
    
    赋值 (物品序号, 读 (“物品序号”))
    赋值 (连续块数, 读 (“块数”))
    .如果真 (等于 (连续块数, 0))
        赋值 (连续块数, 1)
    .如果真结束
    
    .计次循环首 (连续块数, 循环次数)
        赋值 (参位置., 相加 (读 (“横向位置”), 相乘 (相减 (循环次数, 1), 读 (“块宽”)), 相乘 (相减 (参前景序号, 1), 800)))
        赋值 (参位置., 相加 (读 (“纵向位置”), 相乘 (相减 (循环次数, 1), 读 (“块长”))))
        赋值 (参位置., 相加 (参位置., 读 (“块宽”)))
        赋值 (参位置., 相加 (参位置., 读 (“块长”)))
        赋值 (原文件名, 读 (“文件名”))
        .判断开始 (等于 (物品序号, #普通砖))
            重定义数组 (参文件名, 假, 1)
            赋值 (参文件名 [1], “gfx\bonus\cracked.bmp”)
            普通砖变.创建 (参文件名, 参位置, 数据路径, 相加 (取精灵数量 (), 1))
            普通砖变.置精灵原文件名 (原文件名)
            普通砖变.置在哪个场景中 (参前景序号)
            加入精灵 (普通砖变)
        .判断 (等于 (物品序号, #金币砖))
            重定义数组 (参文件名, 假, 4)
            赋值 (参文件名 [1], “gfx\bonus\coin1.bmp”)
            赋值 (参文件名 [2], “gfx\bonus\coin2.bmp”)
            赋值 (参文件名 [3], “gfx\bonus\coin3.bmp”)
            赋值 (参文件名 [4], “gfx\bonus\coin4.bmp”)
            金币砖变.创建 (参文件名, 参位置, 数据路径, 相加 (取精灵数量 (), 1))
            重定义数组 (参文件名, 假, 2)
            赋值 (参文件名 [2], “gfx\bonus\box.bmp”)
            赋值 (参文件名 [1], “gfx\bonus\boxempty.bmp”)
            金币砖变.置金币砖文件名 (参文件名)
            金币砖变.置在哪个场景中 (参前景序号)
            加入精灵 (金币砖变)
        .判断 (或者 (等于 (物品序号, #障碍物), 等于 (物品序号, #顶不碎砖)))
             ' 输出调试文本 (“位置: 左=” ＋ 到文本 (参位置.左边) ＋ “ ” ＋ 到文本 (取精灵数量 () ＋ 1))
            重定义数组 (参文件名, 假, 1)
            赋值 (参文件名 [1], 原文件名)
            障碍物变.创建 (参文件名, 参位置, 数据路径, 相加 (取精灵数量 (), 1))
            障碍物变.置在哪个场景中 (参前景序号)
            加入精灵 (障碍物变)
        .判断 (等于 (物品序号, #金币))
            重定义数组 (参文件名, 假, 4)
            赋值 (参文件名 [1], “gfx\bonus\coin1.bmp”)
            赋值 (参文件名 [2], “gfx\bonus\coin2.bmp”)
            赋值 (参文件名 [3], “gfx\bonus\coin3.bmp”)
            赋值 (参文件名 [4], “gfx\bonus\coin4.bmp”)
            金币变.创建 (参文件名, 参位置, 数据路径, 相加 (取精灵数量 (), 1))
            金币变.置在哪个场景中 (参前景序号)
            加入精灵 (金币变)
        .判断 (等于 (物品序号, #沟))
            沟变.创建 (参文件名, 参位置, 数据路径, 相加 (取精灵数量 (), 1))
            沟变.置在哪个场景中 (参前景序号)
            加入精灵 (沟变)
        .判断 (等于 (物品序号, #小敌人))
            重定义数组 (参文件名, 假, 3)
            赋值 (参文件名 [1], “gfx\characters\goomba1.bmp”)
            赋值 (参文件名 [2], “gfx\characters\goomba2.bmp”)
            赋值 (参文件名 [3], “gfx\characters\goomba3.bmp”)
            小敌人变.创建 (参文件名, 参位置, 数据路径, 相加 (取精灵数量 (), 1))
            小敌人变.置在哪个场景中 (参前景序号)
            加入精灵 (小敌人变)
        .判断 (等于 (物品序号, #蘑菇砖))
            重定义数组 (参文件名, 假, 2)
            赋值 (参文件名 [1], 原文件名)
            赋值 (参文件名 [2], “gfx\bonus\boxempty.bmp”)
            蘑菇砖变.创建 (参文件名, 参位置, 数据路径, 相加 (取精灵数量 (), 1))
            蘑菇砖变.置在哪个场景中 (参前景序号)
            加入精灵 (蘑菇砖变)
        .判断 (等于 (物品序号, #鸭子))
            重定义数组 (参文件名, 假, 8)
            赋值 (参文件名 [1], “gfx\characters\turtle\turtlel1.bmp”)
            赋值 (参文件名 [2], “gfx\characters\turtle\turtlel2.bmp”)
            赋值 (参文件名 [3], “gfx\characters\turtle\turtler1.bmp”)
            赋值 (参文件名 [4], “gfx\characters\turtle\turtler2.bmp”)
            赋值 (参文件名 [5], “gfx\characters\turtle\shell1.bmp”)
            赋值 (参文件名 [6], “gfx\characters\turtle\shell2.bmp”)
            赋值 (参文件名 [7], “gfx\characters\turtle\shell3.bmp”)
            赋值 (参文件名 [8], “gfx\characters\turtle\shell4.bmp”)
            鸭子变.创建 (参文件名, 参位置, 数据路径, 相加 (取精灵数量 (), 1))
            鸭子变.置在哪个场景中 (参前景序号)
            加入精灵 (鸭子变)
        .判断 (等于 (物品序号, #城堡))
            重定义数组 (参文件名, 假, 1)
            赋值 (参文件名 [1], 原文件名)
            城堡变.创建 (参文件名, 参位置, 数据路径, 相加 (取精灵数量 (), 1))
            城堡变.置在哪个场景中 (参前景序号)
            加入精灵 (城堡变)
            
        .默认
            
        .判断结束
        
    .计次循环尾 ()
    跳过 ()
.判断循环尾 ()
关闭 ()
返回 (真)



.子程序 置精灵位置, 空白型, , 
.参数 参X位置, 整数型, , 
.参数 参Y位置, 整数型, , 
.参数 参标记, 整数型, , 

.局部变量 计次, 整数型, , , 

.计次循环首 (取数组成员数 (精灵列表成员), 计次)
    .如果真 (等于 (精灵列表成员.取标记 ( [计次]), 参标记))
        精灵列表成员.置位置 ( [计次], 参X位置, 参Y位置)
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()


.子程序 置状态序号, 空白型, , 
.参数 参序号, 整数型, , 
.参数 参标记, 整数型, , 

.局部变量 计次, 整数型, , , 

.计次循环首 (取数组成员数 (精灵列表成员), 计次)
    .如果真 (等于 (精灵列表成员.取标记 ( [计次]), 参标记))
        精灵列表成员.置状态序号 ( [计次], 序号)
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()


.子程序 画碰撞效果, 整数型, 公开, 
.参数 参屏幕, 未知类型0x20007, , 
.参数 目标页面, 未知类型0x2000B, , 
.参数 复制方式, 整数型, , 1,块复制. 2,透空块复制
.参数 当前时钟周期, 整数型, , 
.参数 第几个精灵, 整数型, , 


返回 (精灵列表成员.画碰撞效果 ( [第几个精灵], 参屏幕, 目标页面, 复制方式, 当前时钟周期))


.子程序 置精灵XY位置, 空白型, 公开, 
.参数 参x位置, 整数型, , 
.参数 参y位置, 整数型, , 
.参数 第几个精灵, 整数型, , 

 ' 输出调试文本 (“orix=” ＋ 到文本 (精灵列表 [第几个精灵].取X位置 ()))
 ' 输出调试文本 (“newx=” ＋ 到文本 (参x位置))
精灵列表成员.置位置 ( [第几个精灵], 参x位置, 参y位置)


.子程序 计算碰撞效果, 整数型, 公开, 0.掉沟里 1.挂了 2.通过 3.通不过
.参数 参碰撞结构, 碰撞结构, , 
.参数 第几个, 整数型, , 

返回 (精灵列表成员.计算碰撞效果 ( [第几个], 参碰撞结构))


.子程序 取底边位置, 整数型, 公开, 
.参数 第几个, 整数型, , 

返回 (精灵列表成员.取底边位置 ( [第几个]))



.子程序 取顶边位置, 整数型, 公开, 
.参数 第几个, 整数型, , 

返回 (精灵列表成员.取顶边位置 ( [第几个]))



.子程序 取X位置, 整数型, 公开, 
.参数 第几个, 整数型, , 

返回 (精灵列表成员.取X位置 ( [第几个]))


.子程序 置位置, 空白型, 公开, 
.参数 参X位置, 整数型, , 
.参数 参Y位置, 整数型, , 
.参数 第几个, 整数型, , 

精灵列表成员.置位置 ( [第几个], 参X位置, 参Y位置)


.子程序 取位置, 未知类型0x2000D, 公开, 
.参数 第几个, 整数型, , 


返回 (精灵列表成员.取位置 ( [第几个]))


.子程序 置是否换场景, 空白型, 公开, 
.参数 是否, 逻辑型, , 
.参数 第几个, 整数型, , 

精灵列表成员.置是否换场景 ( [第几个], 是否)


.子程序 置标记, 空白型, 公开, 
.参数 标记1, 整数型, , 
.参数 第几个, 整数型, , 

精灵列表成员.置标记 ( [第几个], 标记1)


.类模块 金币砖, 精灵基类, , 

.程序集变量 金币砖还是砖, 逻辑型, , , 
.程序集变量 金币砖文件名, 文本型, , "2", 第一个文件是撞完之后的图片
.程序集变量 金币Y位置, 整数型, , , 
.程序集变量 当前文件, 整数型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
置时钟周期 (5)
赋值 (金币砖还是砖, 真) ' 金币砖
赋值 (当前文件, 1)
置物体序号 (#金币砖)

.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用



.子程序 置金币砖文件名, 逻辑型, 公开, 
.参数 文, 文本型, 数组, 

赋值 (金币砖文件名, 文)
返回 (真)

.子程序 计算碰撞效果, 整数型, 公开, 0.掉沟里 1.挂了 2.通过 3.通不过 4.变小 5.变大
.参数 参碰撞结构, 碰撞结构, , 

.判断开始 (并且 (等于 (参碰撞结构.主角身体部位, 1), 金币砖还是砖, 等于 (参碰撞结构.主角状态, #上升)))
    赋值 (金币砖还是砖, 假)
    置状态序号 (1)
    赋值 (金币Y位置, 取Y位置 ())
    波形声音.未知支持库函数_230 (声音句柄, 相加 (数据路径, “sfx\coin.wav”), )
    波形声音.未知支持库函数_231 ()
    _启动窗口.加分 (100)
    返回 (#通不过)
.判断 (等于 (参碰撞结构.主角身体部位, #脚))
    返回 (#通不过)
.默认
    
.判断结束

返回 (#通不过)


.子程序 画碰撞效果, 整数型, 公开, 0,成功, 1,不用画, -1失败
.参数 参屏幕, 未知类型0x20007, , 
.参数 目标页面, 未知类型0x2000B, , 
.参数 复制方式, 整数型, , 1,块复制. 2,透空块复制
.参数 当前时钟周期, 整数型, , 

.局部变量 小页面, 未知类型0x2000B, , , 
.局部变量 图路径, 文本型, , , 

.如果 (金币砖还是砖)
    赋值 (图路径, 相加 (取目录路径 (), 金币砖文件名 [2]))
    小页面.未知支持库函数_111 (参屏幕, 图路径, )
    小页面.未知支持库函数_157 ()
    小页面.未知支持库函数_134 (目标页面, 求余数 (取X位置 (), 800), 取Y位置 (), )
    
.否则
    赋值 (图路径, 相加 (取目录路径 (), 金币砖文件名 [1]))
    小页面.未知支持库函数_111 (参屏幕, 图路径, )
    小页面.未知支持库函数_157 ()
    小页面.未知支持库函数_134 (目标页面, 求余数 (取X位置 (), 800), 取Y位置 (), )
    
.如果结束


.如果真 (等于 (取状态序号 (), 0))
    返回 (1)
.如果真结束

.如果真 (等于 (求余数 (当前时钟周期, 取时钟周期 ()), 0))
    .如果真 (等于 (置状态序号 (相加 (取状态序号 (), 1)), -1))
        置状态序号 (0)
        返回 (1)
    .如果真结束
    
.如果真结束

赋值 (图路径, 相加 (取目录路径 (), 取文件名 (取状态序号 ())))
赋值 (返回值, 小页面.未知支持库函数_111 (参屏幕, 图路径, ))
.如果真 (取反 (返回值))
    输出调试文本 (相加 (“精灵基类:画碰撞效果，建位图页面失败！”, 图路径))
    返回 (-1)
.如果真结束

小页面.未知支持库函数_157 ()
赋值 (金币Y位置, 相减 (金币Y位置, 20))
赋值 (返回值, 小页面.未知支持库函数_134 (目标页面, 求余数 (取X位置 (), 800), 金币Y位置, ))
.如果真 (取反 (返回值))
    输出调试文本 (相加 (“精灵基类:画碰撞效果，小页面.复制失败！”, 图路径))
    返回 (-1)
.如果真结束

返回 (0)


.类模块 障碍物, 精灵基类, , 

.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
置物体序号 (#障碍物)

.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用



.子程序 计算碰撞效果, 整数型, 公开, 0.掉沟里 1.挂了 2.通过 3.通不过 4.变小 5.变大
.参数 参碰撞结构, 碰撞结构, , 

.如果真 (或者 (并且 (等于 (参碰撞结构.主角身体部位, #身体), 等于 (参碰撞结构.主角状态, #上升)), 并且 (等于 (参碰撞结构.主角身体部位, #脚), 等于 (参碰撞结构.主角状态, #上升))))
    返回 (#通过)
.如果真结束

返回 (#通不过)



.子程序 画碰撞效果, 整数型, 公开, 0,成功, 1,不用画, -1失败
.参数 参屏幕, 未知类型0x20007, , 
.参数 目标页面, 未知类型0x2000B, , 
.参数 复制方式, 整数型, , 1,块复制. 2,透空块复制
.参数 当前时钟周期, 整数型, , 

.局部变量 小页面, 未知类型0x2000B, , , 
.局部变量 当前状态序号, 整数型, , , 
.局部变量 图路径, 文本型, , , 


赋值 (图路径, 取文件名 (1))
.如果真 (不等于 (图路径, “”))
    赋值 (图路径, 相加 (取目录路径 (), 图路径))
     ' 输出调试文本 (图路径)
    小页面.未知支持库函数_111 (参屏幕, 图路径, )
     ' 小页面.保存 (“e:\111.bmp”)
     ' 小页面.块复制 (目标页面, 取X位置 (), 取Y位置 (), )
    
    小页面.未知支持库函数_157 ()
    小页面.未知支持库函数_134 (目标页面, 求余数 (取X位置 (), 800), 取Y位置 (), )
    
    
.如果真结束

返回 (0)


.类模块 金币, 精灵基类, , 

.程序集变量 是否画, 逻辑型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
赋值 (是否画, 真)
置时钟周期 (5)
置物体序号 (#金币)

.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用



.子程序 计算碰撞效果, 整数型, 公开, 0.掉沟里 1.挂了 2.通过 3.通不过 4.变小 5.变大
.参数 参碰撞结构, 碰撞结构, , 

.如果真 (等于 (是否画, 假))
    返回 (2)
.如果真结束
赋值 (是否画, 假)
波形声音.未知支持库函数_230 (声音句柄, 相加 (数据路径, “sfx\coin.wav”), )
波形声音.未知支持库函数_231 ()
_启动窗口.加分 (100)
返回 (2)


.子程序 画碰撞效果, 整数型, 公开, 0,成功, 1,不用画, -1失败
.参数 参屏幕, 未知类型0x20007, , 
.参数 目标页面, 未知类型0x2000B, , 
.参数 复制方式, 整数型, , 1,块复制. 2,透空块复制
.参数 当前时钟周期, 整数型, , 

.局部变量 小页面, 未知类型0x2000B, , , 
.局部变量 图路径, 文本型, , , 


.如果真 (取反 (是否画))
    返回 (1)
.如果真结束

.如果真 (等于 (取状态序号 (), 0))
    置状态序号 (1)
.如果真结束

.如果真 (等于 (求余数 (当前时钟周期, 取时钟周期 ()), 0))
    .如果真 (等于 (置状态序号 (相加 (取状态序号 (), 1)), -1))
        置状态序号 (1)
    .如果真结束
    
.如果真结束

赋值 (图路径, 相加 (取目录路径 (), 取文件名 (取状态序号 ())))
赋值 (返回值, 小页面.未知支持库函数_111 (参屏幕, 图路径, ))
.如果真 (取反 (返回值))
    输出调试文本 (相加 (“精灵基类:画碰撞效果，建位图页面失败！”, 图路径))
    返回 (-1)
.如果真结束

小页面.未知支持库函数_157 ()
赋值 (返回值, 小页面.未知支持库函数_134 (目标页面, 求余数 (取X位置 (), 800), 取Y位置 (), ))
.如果真 (取反 (返回值))
    输出调试文本 (相加 (“精灵基类:画碰撞效果，小页面.复制失败！”, 图路径))
    返回 (-1)
.如果真结束

返回 (0)


.类模块 沟, 精灵基类, , 

.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
置物体序号 (#沟)

.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用



.子程序 计算碰撞效果, 整数型, 公开, 0.掉沟里 1.挂了 2.通过 3.通不过 4.变小 5.变大
.参数 参碰撞结构, 碰撞结构, , 

返回 (0)



.子程序 画碰撞效果, 整数型, 公开, 0,成功, 1,不用画, -1失败
.参数 参屏幕, 未知类型0x20007, , 
.参数 目标页面, 未知类型0x2000B, , 
.参数 复制方式, 整数型, , 1,块复制. 2,透空块复制
.参数 当前时钟周期, 整数型, , 

.局部变量 小页面, 未知类型0x2000B, , , 
.局部变量 物体位置, 未知类型0x2000D, , , 
.局部变量 当前状态序号, 整数型, , , 



赋值 (物体位置, 取位置 ())
小页面.未知支持库函数_110 (参屏幕, 相减 (物体位置., 物体位置.), 相减 (物体位置., 物体位置.), )
小页面.未知支持库函数_124 (0)
小页面.未知支持库函数_132 (目标页面, 求余数 (物体位置., 800), 物体位置., )
返回 (0)


.类模块 蘑菇砖, 精灵基类, , 

.程序集变量 用第几张图片, 整数型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
赋值 (用第几张图片, 1)


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 计算碰撞效果, 整数型, 公开, 0.掉沟里 1.挂了 2.通过 3.通不过 4.变小 5.变大 6.出O菇
.参数 参碰撞结构, 碰撞结构, , 

.如果真 (并且 (等于 (参碰撞结构.主角身体部位, 1), 等于 (用第几张图片, 1), 等于 (参碰撞结构.主角状态, #上升)))
    赋值 (用第几张图片, 2)
    返回 (#出蘑菇)
.如果真结束

.如果真 (等于 (参碰撞结构.主角身体部位, #脚))
    返回 (#通不过)
.如果真结束

返回 (#通不过)


.子程序 画碰撞效果, 整数型, 公开, 0,成功, 1,不用画, -1失败
.参数 参屏幕, 未知类型0x20007, , 
.参数 目标页面, 未知类型0x2000B, , 
.参数 复制方式, 整数型, , 1,块复制. 2,透空块复制
.参数 当前时钟周期, 整数型, , 

.局部变量 小页面, 未知类型0x2000B, , , 
.局部变量 当前状态序号, 整数型, , , 
.局部变量 图路径, 文本型, , , 

 ' 输出调试文本 (“用第几张图片=” ＋ 到文本 (用第几张图片))
赋值 (图路径, 取文件名 (用第几张图片))
.如果真 (不等于 (图路径, “”))
    赋值 (图路径, 相加 (取目录路径 (), 图路径))
    小页面.未知支持库函数_111 (参屏幕, 图路径, )
     ' 如果 (复制方式 ＝ 1)
     ' 小页面.块复制 (目标页面, 取X位置 (), 取Y位置 (), )
    小页面.未知支持库函数_157 ()
    小页面.未知支持库函数_134 (目标页面, 求余数 (取X位置 (), 800), 取Y位置 (), )
    
.如果真结束

返回 (0)


.类模块 花砖块, 精灵基类, , 

.程序集变量 原图片数组, 文本型, , "2", 
.程序集变量 用第几张图片, 整数型, , , 
.程序集变量 花Y位置, 整数型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
赋值 (用第几张图片, 1)
置时钟周期 (5)

.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用



.子程序 计算碰撞效果, 整数型, 公开, 0.掉沟里 1.挂了 2.通过 3.通不过 4.变小 5.变大 6.出O菇 
.参数 参碰撞结构, 碰撞结构, , 

.如果真 (并且 (等于 (参碰撞结构.主角等级, 1), 等于 (参碰撞结构.主角身体部位, 1)))
    置状态序号 (1)
    赋值 (用第几张图片, 2)
    返回 (3)
.如果真结束

.如果真 (等于 (参碰撞结构.主角身体部位, #脚))
    返回 (#通过)
.如果真结束


返回 (3)



.子程序 画碰撞效果, 整数型, 公开, 0,成功, 1,不用画, -1失败
.参数 参屏幕, 未知类型0x20007, , 
.参数 目标页面, 未知类型0x2000B, , 
.参数 复制方式, 整数型, , 1,块复制. 2,透空块复制
.参数 当前时钟周期, 整数型, , 

.局部变量 小页面, 未知类型0x2000B, , , 
.局部变量 当前状态序号, 整数型, , , 
.局部变量 图路径, 文本型, , , 


赋值 (图路径, 相加 (取目录路径 (), 原图片数组 [用第几张图片]))
小页面.未知支持库函数_111 (参屏幕, 图路径, )
.如果 (等于 (复制方式, 1))
    小页面.未知支持库函数_132 (目标页面, 求余数 (取X位置 (), 800), 取Y位置 (), )
.否则
    小页面.未知支持库函数_157 ()
    小页面.未知支持库函数_134 (目标页面, 求余数 (取X位置 (), 800), 取Y位置 (), )
.如果结束

.如果真 (等于 (取状态序号 (), 0))
    返回 (1)
.如果真结束

.如果真 (等于 (求余数 (当前时钟周期, 取时钟周期 ()), 0))
    置状态序号 (1)
.如果真结束

赋值 (图路径, 相加 (取目录路径 (), 取文件名 (取状态序号 ())))
赋值 (返回值, 小页面.未知支持库函数_111 (参屏幕, 图路径, ))
.如果真 (取反 (返回值))
    输出调试文本 (相加 (“精灵基类:画碰撞效果，建位图页面失败！”, 图路径))
    返回 (-1)
.如果真结束

小页面.未知支持库函数_157 ()
赋值 (花Y位置, 相减 (花Y位置, 20))
赋值 (返回值, 小页面.未知支持库函数_134 (目标页面, 求余数 (取X位置 (), 800), 花Y位置, ))
.如果真 (取反 (返回值))
    输出调试文本 (相加 (“精灵基类:画碰撞效果，小页面.复制失败！”, 图路径))
    返回 (-1)
.如果真结束

返回 (0)


.类模块 敌人, 精灵基类, , 

.程序集变量 左右, 整数型, , , 
.程序集变量 图片序号, 整数型, , , 
.程序集变量 图片消失周期, 整数型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
置物体序号 (#小敌人)
赋值 (图片序号, 1)
赋值 (左右, -1)
赋值 (图片消失周期, -1)

.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用



.子程序 计算碰撞效果, 整数型, 公开, 0.掉沟里 1.挂了 2.通过 3.通不过
.参数 参碰撞结构, 碰撞结构, , 

.如果真 (并且 (等于 (参碰撞结构.主角身体部位, #脚), 等于 (参碰撞结构.主角状态, #下降)))
    赋值 (图片序号, 3)
    赋值 (图片消失周期, 5)
    波形声音.未知支持库函数_230 (声音句柄, 相加 (数据路径, “sfx\kick.wav”), )
    波形声音.未知支持库函数_231 ()
    返回 (#通过)
.如果真结束

.如果真 (不等于 (图片消失周期, -1))
    返回 (#通过)
.如果真结束

.如果真 (参碰撞结构.是否无敌)
    返回 (#通过)
.如果真结束

返回 (#挂了)

.子程序 画碰撞效果, 整数型, 公开, 0,成功, 1,不用画, -1失败, 
.参数 参屏幕, 未知类型0x20007, , 
.参数 目标页面, 未知类型0x2000B, , 
.参数 复制方式, 整数型, , 1,块复制. 2,透空块复制
.参数 当前时钟周期, 整数型, , 

.局部变量 小页面, 未知类型0x2000B, , , 
.局部变量 图路径, 文本型, , , 
.局部变量 移Y位置, 整数型, , , 
.局部变量 移X位置, 整数型, , , 
.局部变量 碰撞, 碰撞结构, , , 
.局部变量 临时精灵, 精灵基类, , , 
.局部变量 精灵前景位置, 整数型, , , 


.如果真 (不等于 (图片消失周期, -1))
    赋值 (图片消失周期, 相减 (图片消失周期, 1))
.如果真结束


赋值 (图路径, 相加 (取目录路径 (), 取文件名 (图片序号)))
小页面.未知支持库函数_111 (参屏幕, 图路径, )
小页面.未知支持库函数_157 ()
小页面.未知支持库函数_134 (目标页面, 求余数 (取X位置 (), 800), 取Y位置 (), )


.如果真 (取反 (取是否换场景 ()))
    返回 (0)
.如果真结束


 ' 输出调试文本 (到文本 (左右))
赋值 (移X位置, 相加 (取X位置 (), 相乘 (#蘑菇速度, 左右)))
赋值 (移Y位置, 取Y位置 ())
.如果真 (小于或等于 (移X位置, 0))
    赋值 (移X位置, 0)
    赋值 (左右, 1)
.如果真结束

赋值 (精灵前景位置, 绝对取整 (相加 (相除 (移X位置, 800), 1)))

赋值 (碰撞, 碰撞检测 (精灵列表 [精灵前景位置], 2, 缓冲页面X位置))
赋值 (临时精灵, 精灵列表.取精灵 ( [精灵前景位置], 碰撞.第几个精灵))
 ' 输出调试文本 (“移Y位置=” ＋ 到文本 (移Y位置) ＋ “,物体序号=” ＋ 到文本 (碰撞.物体序号) ＋ “,身体部位=” ＋ 到文本 (碰撞.主角身体部位))
.如果 (并且 (或者 (等于 (碰撞.物体序号, -1), 等于 (临时精灵.取物体序号 (), #蘑菇), 等于 (临时精灵.取物体序号 (), #鸭子)), 不等于 (移Y位置, 相减 (#地面位置, 39))))
    赋值 (移Y位置, 相加 (取Y位置 (), #蘑菇速度))
    .如果真 (大于 (移Y位置, 相减 (#地面位置, 39)))
        赋值 (移Y位置, 相减 (#地面位置, 39))
    .如果真结束
    
.否则
    .如果 (并且 (不等于 (临时精灵.取物体序号 (), #蘑菇), 不等于 (临时精灵.取物体序号 (), #鸭子)))
        .如果真 (等于 (碰撞.主角身体部位, #身体))
            .如果 (等于 (左右, 1))
                赋值 (左右, -1)
                赋值 (移X位置, 相加 (取X位置 (), 相乘 (#蘑菇速度, 左右, 2)))
            .否则
                赋值 (左右, 1)
                赋值 (移X位置, 相加 (取X位置 (), 相乘 (#蘑菇速度, 左右, 2)))
            .如果结束
            
        .如果真结束
        
    .否则
        
    .如果结束
    
.如果结束

置位置 (移X位置, 移Y位置)
赋值 (精灵前景位置, 绝对取整 (相加 (相除 (移X位置, 800), 1)))

.如果真 (两距形是否相交 (主角.取位置 (), 取位置 ()))
    .如果 (等于 (方向全局, #向左走))
        主角.向右走 ()
        主角.向左走 ()
    .否则
        主角.向左走 ()
        主角.向右走 ()
    .如果结束
    
.如果真结束

.如果真 (等于 (图片消失周期, 0))
    返回 (#效果画完)
.如果真结束

.如果真 (大于 (精灵前景位置, 0))
    交换场景 (精灵前景位置)
.如果真结束

返回 (0)


.类模块 蘑菇, 精灵基类, , 

.程序集变量 左右, 整数型, , , 1为右，-1为左
.程序集变量 是否被吃了, 逻辑型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
置物体序号 (#蘑菇)
赋值 (左右, 1)
赋值 (是否被吃了, 假)

.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用



.子程序 计算碰撞效果, 整数型, 公开, 0.掉沟里 1.挂了 2.通过 3.通不过
.参数 参碰撞结构, 碰撞结构, , 

.如果真 (等于 (参碰撞结构.主角等级, 1))
    赋值 (是否被吃了, 真)
    返回 (#变大)
.如果真结束

.如果真 (等于 (参碰撞结构.主角等级, 2))
    赋值 (是否被吃了, 真)
    返回 (#变子弹)
.如果真结束


返回 (#通过)


.子程序 画碰撞效果, 整数型, 公开, 0,成功, 1,不用画, -1失败, 
.参数 参屏幕, 未知类型0x20007, , 
.参数 目标页面, 未知类型0x2000B, , 
.参数 复制方式, 整数型, , 1,块复制. 2,透空块复制
.参数 当前时钟周期, 整数型, , 

.局部变量 小页面, 未知类型0x2000B, , , 
.局部变量 图路径, 文本型, , , 
.局部变量 移Y位置, 整数型, , , 
.局部变量 移X位置, 整数型, , , 
.局部变量 碰撞, 碰撞结构, , , 
.局部变量 临时精灵, 精灵基类, , , 
.局部变量 精灵前景位置, 整数型, , , 

.如果真 (是否被吃了)
    返回 (#效果画完)
.如果真结束

赋值 (图路径, 相加 (取目录路径 (), 取文件名 (1)))
小页面.未知支持库函数_111 (参屏幕, 图路径, )
小页面.未知支持库函数_157 ()
小页面.未知支持库函数_134 (目标页面, 求余数 (取X位置 (), 800), 取Y位置 (), )

.如果真 (取反 (取是否换场景 ()))
    返回 (0)
.如果真结束

 ' 输出调试文本 (到文本 (左右))
赋值 (移X位置, 相加 (取X位置 (), 相乘 (#蘑菇速度, 左右)))
赋值 (移Y位置, 取Y位置 ())
.如果真 (小于或等于 (移X位置, 0))
    赋值 (移X位置, 0)
    赋值 (左右, 1)
    
.如果真结束


赋值 (精灵前景位置, 绝对取整 (相加 (相除 (移X位置, 800), 1)))

赋值 (碰撞, 碰撞检测 (精灵列表 [精灵前景位置], 2, 缓冲页面X位置))
赋值 (临时精灵, 精灵列表.取精灵 ( [精灵前景位置], 碰撞.第几个精灵))
.如果 (并且 (或者 (等于 (碰撞.物体序号, -1), 等于 (临时精灵.取物体序号 (), #小敌人), 等于 (临时精灵.取物体序号 (), #鸭子)), 不等于 (移Y位置, 相减 (#地面位置, 39))))
    赋值 (移Y位置, 相加 (取Y位置 (), #蘑菇速度))
    .如果真 (大于 (移Y位置, 相减 (#地面位置, 39)))
        赋值 (移Y位置, 相减 (#地面位置, 39))
    .如果真结束
    
.否则
    .如果 (并且 (不等于 (临时精灵.取物体序号 (), #小敌人), 不等于 (临时精灵.取物体序号 (), #鸭子)))
        .如果真 (等于 (碰撞.主角身体部位, #身体))
            .如果 (等于 (左右, 1))
                赋值 (左右, -1)
                赋值 (移X位置, 相加 (取X位置 (), 相乘 (#蘑菇速度, 左右, 2)))
            .否则
                赋值 (左右, 1)
                赋值 (移X位置, 相加 (取X位置 (), 相乘 (#蘑菇速度, 左右, 2)))
            .如果结束
            
        .如果真结束
        
    .否则
        
    .如果结束
    
.如果结束

置位置 (移X位置, 移Y位置)
赋值 (精灵前景位置, 绝对取整 (相加 (相除 (移X位置, 800), 1)))

.如果真 (两距形是否相交 (主角.取位置 (), 取位置 ()))
    .如果 (等于 (方向全局, #向左走))
        主角.向右走 ()
        主角.向左走 ()
    .否则
        主角.向左走 ()
        主角.向右走 ()
    .如果结束
    
    
.如果真结束

.如果真 (大于 (精灵前景位置, 0))
    交换场景 (精灵前景位置)
.如果真结束


返回 (0)


.类模块 新主角, 精灵基类, , 

.程序集变量 是否挂了, 逻辑型, , , 
.程序集变量 等级, 整数型, , , 1.小 2.大 3.子弹
.程序集变量 走时钟, 整数型, , , 
.程序集变量 状态, 整数型, , , 1.正常 2.上升 3.下降 4.蹲下
.程序集变量 一次跳结束, 逻辑型, , , 
.程序集变量 是否蹲下, 逻辑型, , , 
.程序集变量 跳动前Y位置, 整数型, , , 
.程序集变量 在第几屏, 整数型, , , 
.程序集变量 声音是否播放, 逻辑型, , , 
.程序集变量 无敌时间, 整数型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
赋值 (等级, 1)

.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用




.子程序 置等级, 空白型, 公开, 
.参数 级, 整数型, , 

赋值 (等级, 级)
 ' 输出调试文本 (等级)

.子程序 创建, 空白型, 公开, 
.参数 参文件名, 文本型, 数组, 
.参数 参位置, 未知类型0x2000D, , 
.参数 参目录路径, 文本型, , 
.参数 参标记, 整数型, , 

创建 (参文件名, 参位置, 参目录路径, 参标记)

赋值 (是否挂了, 假)
赋值 (状态, #正常)
赋值 (跳动前Y位置, 0)
赋值 (一次跳结束, 真)
赋值 (是否蹲下, 假)
赋值 (在第几屏, 1)
赋值 (声音是否播放, 假)
赋值 (无敌时间, 0)


.子程序 取是否挂了, 逻辑型, 公开, 
返回 (是否挂了)

.子程序 取一次跳结束, 逻辑型, 公开, 
返回 (一次跳结束)

.子程序 两距形是否相交, 逻辑型, , 
.参数 距1, 未知类型0x2000D, , 
.参数 距2, 未知类型0x2000D, , 

 ' .如果 (或者 (大于或等于 (相减 (距2., 距1.), #屏幕移X位置), 大于或等于 (相减 (距2., 距1.), #屏幕移X位置), 大于或等于 (相减 (距1., 距2.), #屏幕移X位置), 大于或等于 (相减 (距1., 距2.), #屏幕移X位置)))
     ' 返回 (假)
 ' .否则
     ' 返回 (真)
 ' .如果结束

.如果 (或者 (小于或等于 (距1., 距2.), 小于或等于 (距1., 距2.), 大于或等于 (距1., 距2.), 大于或等于 (距1., 距2.)))
    返回 (假)
.否则
    返回 (真)
.如果结束


.子程序 画碰撞效果, 整数型, 公开, 0,成功, 1,不用画, -1失败, -2效果画完 
.参数 参屏幕, 未知类型0x20007, , 
.参数 目标页面, 未知类型0x2000B, , 
.参数 复制方式, 整数型, , 1,块复制. 2,透空块复制
.参数 当前时钟周期, 整数型, , 

.局部变量 小页面, 未知类型0x2000B, , , 
.局部变量 图路径, 文本型, , , 

.如果真 (不等于 (无敌时间, 0))
    赋值 (无敌时间, 相减 (无敌时间, 1))
.如果真结束

.如果真 (是否挂了)
    返回 (#game_over)
.如果真结束


.如果真 (等于 (一次跳结束, 假))
    .判断开始 (等于 (状态, #上升))
        向上走 ()
    .判断 (等于 (状态, #下降))
        向下走 ()
    .默认
        
    .判断结束
    
.如果真结束


.如果真 (等于 (取状态序号 (), 0))
    返回 (1)
.如果真结束

.如果真 (不等于 (求余数 (当前时钟周期, 取时钟周期 ()), 0))
    返回 (1)
.如果真结束

赋值 (图路径, 相加 (取目录路径 (), 取文件名 (取状态序号 ())))
赋值 (返回值, 小页面.未知支持库函数_111 (参屏幕, 图路径, ))
.如果真 (取反 (返回值))
    输出调试文本 (相加 (“精灵基类:画碰撞效果，建位图页面失败！”, 图路径))
    返回 (-1)
.如果真结束

.判断开始 (等于 (复制方式, 1))
    赋值 (返回值, 小页面.未知支持库函数_132 (目标页面, 求余数 (取X位置 (), 800), 取Y位置 (), ))
    
.判断 (等于 (复制方式, 2))
    .如果 (大于 (无敌时间, 0))
        .如果真 (等于 (求余数 (无敌时间, 2), 0))
            小页面.未知支持库函数_157 ()
            赋值 (返回值, 小页面.未知支持库函数_134 (目标页面, 求余数 (取X位置 (), 800), 取Y位置 (), ))
        .如果真结束
        
    .否则
        小页面.未知支持库函数_157 ()
        赋值 (返回值, 小页面.未知支持库函数_134 (目标页面, 求余数 (取X位置 (), 800), 取Y位置 (), ))
        
    .如果结束
    
.默认
    
.判断结束

.如果真 (取反 (返回值))
    输出调试文本 (相加 (“精灵基类:画碰撞效果，小页面.复制失败！”, 图路径))
    返回 (-1)
.如果真结束

返回 (0)



.子程序 碰撞检测, 碰撞结构, 公开, 
.参数 参精灵列表, 精灵列表类, , 
.参数 方向, 整数型, , 1.左 2.右 3.上 4.下
.参数 参缓冲页面X位置, 整数型, , 

.局部变量 临时精灵, 精灵基类, , , 
.局部变量 碰撞, 碰撞结构, , , 
.局部变量 位置1, 未知类型0x2000D, , , 
.局部变量 位置2, 未知类型0x2000D, , , 
.局部变量 计数, 整数型, , , 


赋值 (位置1, 取位置 ())
.判断开始 (等于 (方向, #向右走))
    赋值 (位置1., 相加 (位置1., #屏幕移X位置))
    赋值 (位置1., 相加 (位置1., #屏幕移X位置))
.判断 (等于 (方向, #向左走))
    赋值 (位置1., 相减 (位置1., #屏幕移X位置))
    赋值 (位置1., 相减 (位置1., #屏幕移X位置))
.判断 (等于 (方向, #向上走))
    赋值 (位置1., 相加 (位置1., #跳动速度))
    赋值 (位置1., 相加 (位置1., #跳动速度))
.判断 (等于 (方向, #向下走))
    赋值 (位置1., 相减 (位置1., #跳动速度))
    赋值 (位置1., 相减 (位置1., #跳动速度))
.默认
    
.判断结束

.计次循环首 (精灵列表.取精灵数量 ( [在第几屏]), 计数)
    赋值 (临时精灵, 精灵列表.取精灵 ( [在第几屏], 计数))
    .如果真 (等于 (临时精灵.取标记 (), -1))
        到循环尾 ()
    .如果真结束
    
    赋值 (位置2, 临时精灵.取位置 ())
    
    .如果真 (取反 (两距形是否相交 (位置1, 位置2)))
        到循环尾 ()
    .如果真结束
    
    赋值 (碰撞.物体序号, 临时精灵.取物体序号 ())
    赋值 (碰撞.主角等级, 等级)
    
    .判断开始 (小于或等于 (相减 (位置1., 位置2.), 相加 (#跳动速度, 2)))
        赋值 (碰撞.主角身体部位, #脚) ' 主角脚与其它物体发生碰撞
    .判断 (小于或等于 (相减 (位置2., 位置1.), 相加 (#跳动速度, 2)))
        赋值 (碰撞.主角身体部位, #头) ' 主角头与其它物体发生碰撞
    .判断 (真)
        赋值 (碰撞.主角身体部位, #身体)
    .默认
        
    .判断结束
    
    
    赋值 (碰撞.第几个精灵, 计数)
    返回 (碰撞)
    
.计次循环尾 ()

赋值 (碰撞.物体序号, -1)
返回 (碰撞)



.子程序 碰撞后效果, 整数型, , 
.参数 碰撞值, 整数型, , 
.参数 碰撞, 碰撞结构, , 

.局部变量 临时精灵, 精灵基类, , , 

.判断开始 (等于 (碰撞值, #变大))
    变大 ()
.判断 (等于 (碰撞值, #变小))
    变小 ()
.判断 (等于 (碰撞值, #挂了))
    .如果真 (等于 (等级, 2))
        变小 ()
    .如果真结束
    
    .如果真 (等于 (无敌时间, 0))
        赋值 (是否挂了, 真)
        波形声音.未知支持库函数_230 (声音句柄, 相加 (数据路径, “sfx\die.wav”), )
        波形声音.未知支持库函数_231 ()
    .如果真结束
    
.判断 (等于 (碰撞值, #出蘑菇))
    赋值 (临时精灵, 精灵列表.取精灵 ( [在第几屏], 碰撞.第几个精灵))
    出蘑菇 (临时精灵.取X位置 (), 临时精灵.取Y位置 ())
    波形声音.未知支持库函数_230 (声音句柄, 相加 (数据路径, “sfx\output.wav”), )
    波形声音.未知支持库函数_231 ()
.默认
    
.判断结束
返回 (1)


.子程序 向右走, 空白型, 公开, 
.局部变量 碰撞, 碰撞结构, , , 
.局部变量 碰撞后值, 整数型, , , 


赋值 (走时钟, 相加 (走时钟, 1))
.如果真 (大于 (走时钟, 1))
    置状态序号 (相加 (取状态序号 (), 1))
    .如果真 (或者 (小于 (取状态序号 (), 4), 大于 (取状态序号 (), 6)))
        置状态序号 (4)
    .如果真结束
    赋值 (走时钟, 0)
.如果真结束

赋值 (碰撞, 碰撞检测 (精灵列表 [在第几屏], #向右走, 缓冲页面X位置))
.如果真 (不等于 (碰撞.物体序号, -1))
    赋值 (碰撞.主角状态, #正常)
    .如果 (大于 (无敌时间, 0))
        赋值 (碰撞.是否无敌, 真)
    .否则
        赋值 (碰撞.是否无敌, 假)
    .如果结束
    
    赋值 (碰撞后值, 精灵列表.计算碰撞效果 ( [在第几屏], 碰撞, 碰撞.第几个精灵))
.如果真结束

.如果真 (或者 (等于 (碰撞.物体序号, -1), 等于 (碰撞后值, #通过)))
    .如果 (并且 (小于 (取X位置 (), 400), 等于 (当前前景序号, 1)))
        置位置 (相加 (取X位置 (), #屏幕移X位置), 取Y位置 ())
    .否则
        赋值 (缓冲页面X位置, 相加 (缓冲页面X位置, #屏幕移X位置))
         ' 输出调试文本 (缓冲页面X位置)
        置位置 (相加 (取X位置 (), #屏幕移X位置), 取Y位置 ())
    .如果结束
    
    
    .如果真 (并且 (一次跳结束, 不等于 (取底边位置 (), #地面位置), 等于 (碰撞.物体序号, -1)))
        赋值 (一次跳结束, 假)
        赋值 (状态, #下降)
    .如果真结束
    
    返回 ()
.如果真结束

碰撞后效果 (碰撞后值, 碰撞)


.子程序 向左走, 空白型, 公开, 
.局部变量 碰撞, 碰撞结构, , , 
.局部变量 碰撞后值, 整数型, , , 

赋值 (走时钟, 相加 (走时钟, 1))
.如果真 (大于 (走时钟, 1))
    置状态序号 (相加 (取状态序号 (), 1))
    .如果真 (大于 (取状态序号 (), 3))
        置状态序号 (1)
    .如果真结束
    赋值 (走时钟, 0)
.如果真结束

赋值 (碰撞, 碰撞检测 (精灵列表 [在第几屏], #向左走, 缓冲页面X位置))
.如果真 (不等于 (碰撞.物体序号, -1))
    赋值 (碰撞.主角状态, #正常)
    .如果 (大于 (无敌时间, 0))
        赋值 (碰撞.是否无敌, 真)
    .否则
        赋值 (碰撞.是否无敌, 假)
    .如果结束
    赋值 (碰撞后值, 精灵列表.计算碰撞效果 ( [在第几屏], 碰撞, 碰撞.第几个精灵))
.如果真结束

 ' 没撞到东东或通过
.如果真 (或者 (等于 (碰撞.物体序号, -1), 等于 (碰撞后值, #通过)))
    赋值 (缓冲页面X位置, 相减 (缓冲页面X位置, #屏幕移X位置))
    .如果真 (小于 (缓冲页面X位置, 0))
        赋值 (缓冲页面X位置, 0)
    .如果真结束
    
    .如果真 (并且 (或者 (大于 (取X位置 (), 400), 小于或等于 (缓冲页面X位置, 0)), 不等于 (取X位置 (), 0)))
        置位置 (相减 (取X位置 (), #屏幕移X位置), 取Y位置 ())
    .如果真结束
    
    .如果真 (并且 (一次跳结束, 不等于 (取底边位置 (), #地面位置), 等于 (碰撞.物体序号, -1)))
        赋值 (状态, #下降)
        赋值 (一次跳结束, 假)
    .如果真结束
    
    返回 ()
.如果真结束

碰撞后效果 (碰撞后值, 碰撞)



.子程序 向上走, 空白型, 公开, 
.局部变量 碰撞, 碰撞结构, , , 
.局部变量 碰撞后值, 整数型, , , 

赋值 (状态, #上升)
赋值 (一次跳结束, 假)

.如果真 (等于 (声音是否播放, 假))
    波形声音.未知支持库函数_230 (声音句柄, 相加 (数据路径, “sfx\jump.wav”), )
    波形声音.未知支持库函数_231 ()
    赋值 (声音是否播放, 真)
.如果真结束

.如果真 (等于 (跳动前Y位置, 0)) ' 保存跳动前的Y位置
    赋值 (跳动前Y位置, 取Y位置 ())
.如果真结束


.如果 (大于 (相减 (取Y位置 (), #跳动速度), 相减 (跳动前Y位置, 相乘 (#跳动速度, #跳动计数))))
    赋值 (碰撞, 碰撞检测 (精灵列表 [在第几屏], #上升, 缓冲页面X位置)) ' 判断头是否碰撞其它物
     ' 输出调试文本 (碰撞.物体序号)
    .如果真 (不等于 (碰撞.物体序号, -1))
        赋值 (碰撞.主角状态, #上升)
        .如果 (大于 (无敌时间, 0))
            赋值 (碰撞.是否无敌, 真)
        .否则
            赋值 (碰撞.是否无敌, 假)
        .如果结束
        
        赋值 (碰撞后值, 精灵列表.计算碰撞效果 ( [在第几屏], 碰撞, 碰撞.第几个精灵))
    .如果真结束
    
     ' 没撞到东东或通过
    .如果真 (或者 (等于 (碰撞.物体序号, -1), 等于 (碰撞后值, #通过)))
        置位置 (取X位置 (), 相减 (取Y位置 (), #跳动速度))
        返回 ()
    .如果真结束
    
     ' 撞到东东
    碰撞后效果 (碰撞后值, 碰撞)
    .如果真 (等于 (碰撞后值, #通不过))
        赋值 (状态, #下降)
    .如果真结束
    
.否则
    赋值 (状态, #下降)
    
.如果结束


.子程序 向下走, 空白型, 公开, 
.局部变量 碰撞, 碰撞结构, , , 
.局部变量 碰撞后值, 整数型, , , 

赋值 (状态, #下降)
.如果 (大于 (相加 (取底边位置 (), #跳动速度), #地面位置))
    置底边位置 (#地面位置)
    赋值 (跳动前Y位置, 0)
    赋值 (一次跳结束, 真)
    赋值 (声音是否播放, 假)
.否则
    
    赋值 (碰撞, 碰撞检测 (精灵列表 [在第几屏], #下降, 缓冲页面X位置))
    .如果真 (不等于 (碰撞.物体序号, -1))
        赋值 (碰撞.主角状态, #下降)
        .如果 (大于 (无敌时间, 0))
            赋值 (碰撞.是否无敌, 真)
        .否则
            赋值 (碰撞.是否无敌, 假)
        .如果结束
        
        赋值 (碰撞后值, 精灵列表.计算碰撞效果 ( [在第几屏], 碰撞, 碰撞.第几个精灵))
    .如果真结束
    
     ' 没撞到东东或通过
    .如果真 (或者 (等于 (碰撞.物体序号, -1), 等于 (碰撞后值, #通过)))
        置位置 (取X位置 (), 相加 (取Y位置 (), #跳动速度))
        返回 ()
    .如果真结束
    
    碰撞后效果 (碰撞后值, 碰撞)
    .判断开始 (等于 (碰撞后值, #通不过))
        置底边位置 (精灵列表.取顶边位置 ( [在第几屏], 碰撞.第几个精灵))
        赋值 (一次跳结束, 真)
        赋值 (声音是否播放, 假)
        赋值 (跳动前Y位置, 取Y位置 ())
    .默认
        
    .判断结束
    
.如果结束




.子程序 变大, 空白型, 公开, 
.局部变量 参文件名, 文本型, , "1", 
.局部变量 位置, 未知类型0x2000D, , , 

 ' 如果真 (等级 ＝ 1)
重定义数组 (参文件名, 假, 8)
赋值 (参文件名 [1], “gfx\characters\big\player1l.bmp”)
赋值 (参文件名 [2], “gfx\characters\big\player2l.bmp”)
赋值 (参文件名 [3], “gfx\characters\big\player3l.bmp”)
赋值 (参文件名 [4], “gfx\characters\big\player1r.bmp”)
赋值 (参文件名 [5], “gfx\characters\big\player2r.bmp”)
赋值 (参文件名 [6], “gfx\characters\big\player3r.bmp”)
赋值 (参文件名 [7], “gfx\characters\big\downl.bmp”)
赋值 (参文件名 [8], “gfx\characters\big\downr.bmp”)
置文件名 (参文件名)
置位置 (取X位置 (), 相加 (相减 (取Y位置 (), 77), 取精灵高度 ()))
置精灵大小 (#精灵宽度, 77)

波形声音.未知支持库函数_230 (声音句柄, 相加 (数据路径, “sfx\grow.wav”), )
波形声音.未知支持库函数_231 ()

赋值 (等级, 2)



.子程序 变小, 空白型, 公开, 
.局部变量 参文件名, 文本型, , "1", 

.如果真 (等于 (等级, 2))
    重定义数组 (参文件名, 假, 8)
    赋值 (参文件名 [1], “gfx\characters\small\player1l.bmp”)
    赋值 (参文件名 [2], “gfx\characters\small\player2l.bmp”)
    赋值 (参文件名 [3], “gfx\characters\small\player3l.bmp”)
    赋值 (参文件名 [4], “gfx\characters\small\player1r.bmp”)
    赋值 (参文件名 [5], “gfx\characters\small\player2r.bmp”)
    赋值 (参文件名 [6], “gfx\characters\small\player3r.bmp”)
    赋值 (参文件名 [7], “gfx\characters\small\downl.bmp”)
    赋值 (参文件名 [8], “gfx\characters\small\downr.bmp”)
    置文件名 (参文件名)
    
    置位置 (取X位置 (), 相减 (相加 (取Y位置 (), 取精灵高度 ()), 42))
    置精灵大小 (#精灵宽度, 42)
    
    波形声音.未知支持库函数_230 (声音句柄, 相加 (数据路径, “sfx\shrink.wav”), )
    波形声音.未知支持库函数_231 ()
    
    赋值 (无敌时间, 200)
    赋值 (等级, 1)
    
.如果真结束


.子程序 取等级, 整数型, 公开, 
返回 (等级)


.子程序 蹲下, 空白型, 公开, 
.参数 参方向, 整数型, , 

.如果 (等于 (参方向, #向左走))
    置状态序号 (7)
.否则
    置状态序号 (8)
.如果结束

.如果 (等于 (等级, 1))
    置位置 (取X位置 (), 相加 (取Y位置 (), 6))
.否则
    置位置 (取X位置 (), 相加 (取Y位置 (), 42))
.如果结束

赋值 (是否蹲下, 真)


.子程序 取是否蹲下, 逻辑型, 公开, 
返回 (是否蹲下)

.子程序 站起, 空白型, 公开, 
.参数 参方向, 整数型, , 

.如果真 (等于 (是否蹲下, 真))
    .如果 (等于 (参方向, #向左走))
        置状态序号 (1)
    .否则
        置状态序号 (4)
    .如果结束
    
    .如果 (等于 (等级, 1))
        置位置 (取X位置 (), 相减 (取Y位置 (), 6))
    .否则
        置位置 (取X位置 (), 相减 (取Y位置 (), 42))
    .如果结束
    
    赋值 (是否蹲下, 假)
.如果真结束


.子程序 取状态, 整数型, 公开, 
返回 (状态)





.子程序 置位置, 空白型, 公开, 
.参数 X位置, 整数型, , 
.参数 Y位置, 整数型, , 

置位置 (X位置, Y位置)
赋值 (在第几屏, 相除 (取X位置 (), 800))
赋值 (在第几屏, 相加 (在第几屏, 1))



.窗口程序集 窗口程序集2, , , 

.子程序 _按钮4_被单击, 空白型, , 
销毁 ()


.子程序 _按钮1_被单击, 空白型, , 
赋值 (是否使用控制器, 假)
赋值 (键左, 到数值 (.标记))
赋值 (键右, 到数值 (.标记))
赋值 (键跳, 到数值 (.标记))
赋值 (键下, 到数值 (.标记))

赋值 (键左, #)
赋值 (键右, #)
赋值 (键跳, #)
赋值 (键下, #)


.子程序 _窗口1_创建完毕, 空白型, , 
.局部变量 名字, 文本型, , , 

取窗口句柄 ().未知支持库函数_14 ()
30.未知支持库函数_38 ()

赋值 (是否使用控制器, 假)
#.未知支持库函数_59 (名字)
赋值 (.内容, 名字)
赋值 (.标记, 到文本 (#))

#.未知支持库函数_59 (名字)
赋值 (.内容, 名字)
赋值 (.标记, 到文本 (#))

#.未知支持库函数_59 (名字)
赋值 (.内容, 名字)
赋值 (.标记, 到文本 (#))

#.未知支持库函数_59 (名字)
赋值 (.内容, 名字)
赋值 (.标记, 到文本 (#))

赋值 (.内容, “控制器第0键”)
赋值 (.标记, 到文本 (#))

_按钮1_被单击 ()

.子程序 _按钮3_被单击, 空白型, , 
信息框 (未知支持库函数_52 (), 0, )


.子程序 _按钮2_被单击, 空白型, , 
赋值 (是否使用控制器, 真)
赋值 (键跳, 到数值 (.标记))


.子程序 _窗口1_被激活, 空白型, , 
假.未知支持库函数_35 (真, 真)


.子程序 _窗口1_被取消激活, 空白型, , 
假.未知支持库函数_35 (假, 假)


.子程序 _输入设备1_键盘按键状态被改变, 空白型, , 
.参数 键值, 整数型, , 
.参数 键状态, 整数型, , 

.局部变量 名字, 文本型, , , 

.如果真 (等于 (键状态, 3))
    .判断开始 (可有焦点 ())
        键值.未知支持库函数_59 (名字)
        赋值 (.内容, 名字)
        赋值 (.标记, 到文本 (键值))
    .判断 (可有焦点 ())
        键值.未知支持库函数_59 (名字)
        赋值 (.内容, 名字)
        赋值 (.标记, 到文本 (键值))
    .判断 (可有焦点 ())
        键值.未知支持库函数_59 (名字)
        赋值 (.内容, 名字)
        赋值 (.标记, 到文本 (键值))
    .判断 (可有焦点 ())
        键值.未知支持库函数_59 (名字)
        赋值 (.内容, 名字)
        赋值 (.标记, 到文本 (键值))
    .默认
        
    .判断结束
    
.如果真结束


.子程序 _按钮5_被单击, 空白型, , 
30.未知支持库函数_38 ()
假.未知支持库函数_35 (真, 真)


.子程序 _输入设备1_控制器按钮改变, 空白型, , 
.参数 键值, 整数型, , 
.参数 键状态, 整数型, , 

.如果真 (等于 (键状态, 3))
    .判断开始 (可有焦点 ())
        赋值 (.内容, 相加 (“按键”, 到文本 (相减 (键值, #))))
        赋值 (.标记, 到文本 (键值))
    .默认
        
    .判断结束
    
    
.如果真结束


.类模块 鸭子, 精灵基类, , 

.程序集变量 左右, 整数型, , , 
.程序集变量 图片序号, 整数型, , , 
.程序集变量 状态, 整数型, , , 1.正常 2.壳
.程序集变量 走时钟, 整数型, , , 
.程序集变量 记时, 整数型, , , 
.程序集变量 是否移动, 逻辑型, , , 
.程序集变量 移动速度, 整数型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
置物体序号 (#鸭子)
赋值 (图片序号, 3)
赋值 (左右, 1)
赋值 (状态, 1)
赋值 (走时钟, 0)
赋值 (记时, 0)
赋值 (是否移动, 真)
赋值 (移动速度, 4)

.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 计算碰撞效果, 整数型, 公开, 0.掉沟里 1.挂了 2.通过 3.通不过
.参数 参碰撞结构, 碰撞结构, , 

.如果真 (等于 (参碰撞结构.主角身体部位, #脚))
    .如果 (等于 (状态, 1))
        变壳 ()
        赋值 (记时, 0)
        波形声音.未知支持库函数_230 (声音句柄, 相加 (数据路径, “sfx\kick.wav”), )
        波形声音.未知支持库函数_231 ()
    .否则
        .如果真 (大于 (记时, 20))
            赋值 (是否移动, 假)
            波形声音.未知支持库函数_230 (声音句柄, 相加 (数据路径, “sfx\kick.wav”), )
            波形声音.未知支持库函数_231 ()
        .如果真结束
        
        赋值 (记时, 0)
    .如果结束
    返回 (#通过)
.如果真结束

.如果真 (并且 (等于 (参碰撞结构.主角身体部位, #身体), 大于 (记时, 30)))
    .如果 (等于 (参碰撞结构.主角等级, 1))
        返回 (#挂了)
    .否则
        赋值 (记时, 0)
        返回 (#变小)
    .如果结束
    
.如果真结束

返回 (#通过)

 ' 返回 (#挂了)

.子程序 画碰撞效果, 整数型, 公开, 0,成功, 1,不用画, -1失败, 
.参数 参屏幕, 未知类型0x20007, , 
.参数 目标页面, 未知类型0x2000B, , 
.参数 复制方式, 整数型, , 1,块复制. 2,透空块复制
.参数 当前时钟周期, 整数型, , 

.局部变量 小页面, 未知类型0x2000B, , , 
.局部变量 图路径, 文本型, , , 
.局部变量 精灵前景位置, 整数型, , , 

.如果真 (或者 (等于 (是否移动, 真), 大于 (记时, 200)))
    .如果真 (等于 (是否移动, 假))
        变鸭子 ()
    .如果真结束
    赋值 (走时钟, 相加 (走时钟, 1))
    .如果真 (大于 (走时钟, 2))
        赋值 (图片序号, 相加 (图片序号, 1))
        .如果 (等于 (左右, 1)) ' 向右走
            .如果 (等于 (状态, 1))
                .如果真 (或者 (小于 (图片序号, 3), 大于 (图片序号, 4)))
                    赋值 (图片序号, 3)
                .如果真结束
                
            .否则
                .如果真 (或者 (小于 (图片序号, 5), 大于 (图片序号, 8)))
                    赋值 (图片序号, 5)
                .如果真结束
                
            .如果结束
            
        .否则
            .如果 (等于 (状态, 1)) ' 向左走
                .如果真 (或者 (小于 (图片序号, 1), 大于 (图片序号, 2)))
                    赋值 (图片序号, 1)
                .如果真结束
                
            .否则
                .如果真 (或者 (小于 (图片序号, 5), 大于 (图片序号, 8)))
                    赋值 (图片序号, 5)
                .如果真结束
                
            .如果结束
            
        .如果结束
        赋值 (走时钟, 0)
    .如果真结束
    
.如果真结束

.如果真 (大于或等于 (记时, 0))
    赋值 (记时, 相加 (记时, 1))
.如果真结束

赋值 (图路径, 相加 (取目录路径 (), 取文件名 (图片序号)))
小页面.未知支持库函数_111 (参屏幕, 图路径, )
小页面.未知支持库函数_157 ()
小页面.未知支持库函数_134 (目标页面, 求余数 (取X位置 (), 800), 取Y位置 (), )


.如果真 (取反 (取是否换场景 ()))
    返回 (0)
.如果真结束

 ' 输出调试文本 (到文本 (左右))
.如果真 (或者 (等于 (是否移动, 真), 大于 (记时, 200)))
    走 ()
.如果真结束

.如果真 (两距形是否相交 (主角.取位置 (), 取位置 ()))
    .如果 (等于 (方向全局, #向左走))
        主角.向右走 ()
        主角.向左走 ()
    .否则
        主角.向左走 ()
        主角.向右走 ()
    .如果结束
    
    
    
.如果真结束

赋值 (精灵前景位置, 绝对取整 (相加 (相除 (取X位置 (), 800), 1)))
.如果真 (大于 (精灵前景位置, 0))
    交换场景 (精灵前景位置)
.如果真结束


返回 (0)


.子程序 走, 空白型, 公开, 
.局部变量 移Y位置, 整数型, , , 
.局部变量 移X位置, 整数型, , , 
.局部变量 碰撞, 碰撞结构, , , 
.局部变量 临时精灵, 精灵基类, , , 
.局部变量 精灵前景位置, 整数型, , , 

赋值 (移X位置, 相加 (取X位置 (), 相乘 (移动速度, 左右)))
赋值 (移Y位置, 取Y位置 ())
.如果真 (小于或等于 (移X位置, 0))
    赋值 (移X位置, 0)
.如果真结束

赋值 (精灵前景位置, 绝对取整 (相加 (相除 (移X位置, 800), 1)))

赋值 (碰撞, 碰撞检测 (精灵列表 [精灵前景位置], 2, 缓冲页面X位置))
赋值 (临时精灵, 精灵列表.取精灵 ( [精灵前景位置], 碰撞.第几个精灵))
.如果 (并且 (不等于 (临时精灵.取物体序号 (), #蘑菇), 不等于 (临时精灵.取物体序号 (), #小敌人), 等于 (碰撞.主角身体部位, #身体)))
    .如果 (等于 (左右, 1))
        赋值 (左右, -1)
        赋值 (移X位置, 相加 (取X位置 (), 相乘 (移动速度, 左右, 2)))
    .否则
        赋值 (左右, 1)
        赋值 (移X位置, 相加 (取X位置 (), 相乘 (移动速度, 左右, 2)))
    .如果结束
    
.否则
    
.如果结束

置位置 (移X位置, 移Y位置)



.子程序 变壳, 空白型, 公开, 
赋值 (图片序号, 5)
置位置 (取X位置 (), 相加 (取Y位置 (), 20))
赋值 (状态, 2)
赋值 (移动速度, 8)
赋值 (是否移动, 真)

.子程序 变鸭子, 空白型, 公开, 
赋值 (图片序号, 3)
赋值 (左右, 1)
置位置 (取X位置 (), 相减 (取Y位置 (), 20))
赋值 (状态, 1)
赋值 (移动速度, 4)
赋值 (是否移动, 真)

.类模块 城堡, 精灵基类, , 

.程序集变量 是否过关, 逻辑型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
置物体序号 (#城堡)
赋值 (是否过关, 假)

.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用



.子程序 计算碰撞效果, 整数型, 公开, 0.掉沟里 1.挂了 2.通过 3.通不过 4.变小 5.变大
.参数 参碰撞结构, 碰撞结构, , 

赋值 (是否过关, 真)
返回 (#通过)


.子程序 画碰撞效果, 整数型, 公开, 0,成功, 1,不用画, -1失败
.参数 参屏幕, 未知类型0x20007, , 
.参数 目标页面, 未知类型0x2000B, , 
.参数 复制方式, 整数型, , 1,块复制. 2,透空块复制
.参数 当前时钟周期, 整数型, , 

.局部变量 小页面, 未知类型0x2000B, , , 
.局部变量 当前状态序号, 整数型, , , 
.局部变量 图路径, 文本型, , , 


赋值 (图路径, 取文件名 (1))
.如果真 (不等于 (图路径, “”))
    赋值 (图路径, 相加 (取目录路径 (), 图路径))
     ' 输出调试文本 (图路径)
    小页面.未知支持库函数_111 (参屏幕, 图路径, )
     ' 小页面.保存 (“e:\111.bmp”)
     ' 小页面.块复制 (目标页面, 取X位置 (), 取Y位置 (), )
    
    小页面.未知支持库函数_157 ()
    小页面.未知支持库函数_134 (目标页面, 求余数 (取X位置 (), 800), 取Y位置 (), )
    
    
.如果真结束

.如果真 (是否过关)
    返回 (#过关)
.如果真结束

返回 (0)



 ' 不属于任何一个程序集、类模块的函数：
