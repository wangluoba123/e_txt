 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口
    左边 = 50
    顶边 = 50
    宽度 = 816
    高度 = 616
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = 0 '  0x0
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “远程屏幕控制”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 2 0 数据操作支持库一
 ' Exmlrpc A36CFD538657479eBD7C0D287BBB3D95 2 0 远程服务支持库
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 2 0 多线程支持库




数据类型 SCROLLINFO, , 
    .成员 cbSize, 整数型, , , 
    .成员 fMask, 整数型, , , 
    .成员 nMin, 整数型, , , 
    .成员 nMax, 整数型, , , 
    .成员 nPage, 整数型, , , 
    .成员 nPos, 整数型, , , 
    .成员 nTrackPos, 整数型, , , 

.全局变量 客户句柄, 整数型, , , 

.DLL命令 SetScrollInfo, 整数型, "user32.dll", "SetScrollInfo", , 
    .参数 hwnd, 整数型, , 
    .参数 n, 整数型, , 
    .参数 lpcScrollInfo, SCROLLINFO, , 
    .参数 bool, 逻辑型, , 

.DLL命令 ShowScrollBar, 整数型, "user32.dll", "ShowScrollBar", , , ShowScrollBar
    .参数 窗口句柄, 整数型, , hwnd
    .参数 滚动条标志, 整数型, , wBar
    .参数 显示标志, 整数型, , bShow

.DLL命令 取得窗口信息_, 整数型, "user32.dll", "GetWindowLongA", , 从指定窗口的结构中取得信息  由nIndex决定。零表示出错。会设置GetLastError
    .参数 窗口句柄, 整数型, , 欲为其获取信息的窗口的句柄
    .参数 属性, 整数型, , 欲取回的信息，可以是下述任何一个常数：;GWL_EXSTYLE：扩展窗口样式;GWL_STYLE：窗口样式;GWL_WNDPROC：该窗口的窗口函数的地址;GWL_HINSTANCE：拥有窗口的实例的句柄;GWL_HWNDPARENT：该窗口之父的句柄。不要用SetWindowWord来改变这个值;GWL_ID：对话框中一个子窗口的标识符;GWL_USERDATA：含义由应用程序规定;DWL_DLGPROC：这个窗口的对话框函数地址;DWL_MSGRESULT：在对话框函数中处理的一条消息返回的值;DWL_USER：含义由应用程序规定;

.DLL命令 设置窗口信息_, 整数型, "user32.dll", "SetWindowLongA", , 在窗口结构中为指定的窗口设置信息  指定数据的前一个值
    .参数 窗口句柄, 整数型, , hwnd，欲为其取得信息的窗口的句柄
    .参数 窗口信息值, 整数型, , nIndex，请参考GetWindowLong函数的nIndex参数的说明
    .参数 窗口信息新值, 整数型, , dwNewLong，由nIndex指定的窗口信息的新值

.DLL命令 CallWindowProcA, 整数型, "user32.dll", "CallWindowProcA", , 
    .参数 lpPrevWndFunc, 整数型, , 
    .参数 hWnd, 整数型, , 
    .参数 Msg, 整数型, , 
    .参数 wParam, 整数型, , 
    .参数 lParam, 整数型, , 

.DLL命令 GetScrollInfo, 整数型, "user32", "GetScrollInfo", , 
    .参数 hwnd, 整数型, , 
    .参数 n, 整数型, , 
    .参数 lpcScrollInfo, SCROLLINFO, , 

.DLL命令 SetWindowLongA, 整数型, "user32.dll", "SetWindowLongA", , 
    .参数 hWnd, 整数型, , 
    .参数 nIndex, 整数型, , 
    .参数 dwNewLong, 整数型, , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 远程屏幕句柄, 整数型, , , 
.程序集变量 滚动条, SCROLLINFO, , , 
.程序集变量 OldProc, 整数型, , , 
.程序集变量 横移距离, 小数型, , , 
.程序集变量 纵移距离, 小数型, , , 
.程序集变量 屏幕控制启动, 逻辑型, , , 
.程序集变量 多线程许可证, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 osty, 整数型, , , 

赋值 (多线程许可证, 未知支持库函数_1 ())
赋值 (远程屏幕句柄, 取窗口句柄 ())
赋值 (滚动条.cbSize, 7)
赋值 (滚动条.fMask, 23)
赋值 (滚动条.nMax, 3000)
赋值 (滚动条.nMin, 0)
赋值 (滚动条.nPage, 1000)
赋值 (滚动条.nPos, 0)
SetScrollInfo (远程屏幕句柄, 0, 滚动条, 真)
SetScrollInfo (远程屏幕句柄, 1, 滚动条, 真)
ShowScrollBar (远程屏幕句柄, 3, 1)
赋值 (osty, 取得窗口信息_ (远程屏幕句柄, -16))
设置窗口信息_ (远程屏幕句柄, -16, 位或 (osty, 1048576, 2097152))

赋值 (.左边, 0)
赋值 (.顶边, 0)
赋值 (.底图, {  })
赋值 (.禁止, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (横移距离, 0)
赋值 (纵移距离, 0)
赋值 (滚动条.nPos, 0)
SetScrollInfo (远程屏幕句柄, 0, 滚动条, 真)
SetScrollInfo (远程屏幕句柄, 1, 滚动条, 真)
赋值 (OldProc, SetWindowLongA (远程屏幕句柄, -4, 到数值 (&NewProc)))

打开服务器 (888)

.子程序 NewProc, 整数型, , 
.参数 hWnd, 整数型, , 
.参数 Msg, 整数型, , 
.参数 wParam, 整数型, , 
.参数 lParam, 整数型, , 

.判断开始 (等于 (Msg, 15))
    赋值 (.左边, 横移距离)
    赋值 (.顶边, 纵移距离)
.判断 (等于 (Msg, 276))
    置横向滚动条 (wParam)
.判断 (等于 (Msg, 277))
    置纵向滚动条 (wParam)
.默认
    
.判断结束
返回 (CallWindowProcA (OldProc, hWnd, Msg, wParam, lParam))

.子程序 置横向滚动条, 空白型, , 
.参数 wParam, 整数型, , 

.局部变量 pos, 整数型, , , 
.局部变量 flag, 整数型, , , 
.局部变量 old, SCROLLINFO, , , 
.局部变量 qy, 整数型, , , 

GetScrollInfo (远程屏幕句柄, 0, old)
赋值 (pos, 整除 (wParam, 65536)) ' 拖拽时返回的滚动条值
赋值 (flag, 求余数 (wParam, 65536)) ' 判断滚动条的动作
.判断开始 (等于 (flag, 1))
    赋值 (滚动条.nPos, 相加 (滚动条.nPos, 1000))
    .如果真 (大于或等于 (滚动条.nPos, 滚动条.nMax))
        赋值 (滚动条.nPos, 3000)
    .如果真结束
    
.判断 (等于 (flag, 0))
    赋值 (滚动条.nPos, 相减 (滚动条.nPos, 1000))
    .如果真 (小于或等于 (滚动条.nPos, 滚动条.nMin))
        赋值 (滚动条.nPos, 0)
    .如果真结束
    
.判断 (等于 (flag, 2))
    赋值 (滚动条.nPos, 相减 (滚动条.nPos, 1000))
    .如果真 (小于或等于 (滚动条.nPos, 滚动条.nMin))
        赋值 (滚动条.nPos, 0)
    .如果真结束
    
.判断 (等于 (flag, 3))
    赋值 (滚动条.nPos, 相加 (滚动条.nPos, 1000))
    .如果真 (小于或等于 (滚动条.nPos, 滚动条.nMin))
        赋值 (滚动条.nPos, 3000)
    .如果真结束
    
.判断 (等于 (flag, 5))
    赋值 (滚动条.nPos, pos)
.判断 (等于 (flag, 7))
    赋值 (滚动条.nPos, 滚动条.nMax)
.判断 (等于 (flag, 6))
    赋值 (滚动条.nPos, 滚动条.nMin)
.默认
    
.判断结束
SetScrollInfo (远程屏幕句柄, 0, 滚动条, 真)
赋值 (横移距离, 相除 (相乘 (负 (相减 (old.nPos, 滚动条.nPos)), 相减 (_启动窗口., 32, .宽度)), 2000))
_启动窗口.发送信息 (15, 0, 0)


.子程序 置纵向滚动条, 空白型, , 
.参数 wParam, 整数型, , 

.局部变量 pos, 整数型, , , 
.局部变量 flag, 整数型, , , 
.局部变量 old, SCROLLINFO, , , 

GetScrollInfo (远程屏幕句柄, 1, old)
赋值 (pos, 整除 (wParam, 65536)) ' 拖拽时返回的滚动条值
赋值 (flag, 求余数 (wParam, 65536)) ' 判断滚动条的动作
.判断开始 (等于 (flag, 1))
    赋值 (滚动条.nPos, 相加 (滚动条.nPos, 1000))
    .如果真 (大于或等于 (滚动条.nPos, 滚动条.nMax))
        赋值 (滚动条.nPos, 3000)
    .如果真结束
    
.判断 (等于 (flag, 0))
    赋值 (滚动条.nPos, 相减 (滚动条.nPos, 1000))
    .如果真 (小于或等于 (滚动条.nPos, 滚动条.nMin))
        赋值 (滚动条.nPos, 0)
    .如果真结束
    
.判断 (等于 (flag, 2))
    赋值 (滚动条.nPos, 相减 (滚动条.nPos, 1000))
    .如果真 (小于或等于 (滚动条.nPos, 滚动条.nMin))
        赋值 (滚动条.nPos, 0)
    .如果真结束
    
.判断 (等于 (flag, 3))
    赋值 (滚动条.nPos, 相加 (滚动条.nPos, 1000))
    .如果真 (小于或等于 (滚动条.nPos, 滚动条.nMin))
        赋值 (滚动条.nPos, 3000)
    .如果真结束
    
.判断 (等于 (flag, 5))
    赋值 (滚动条.nPos, pos)
.判断 (等于 (flag, 7))
    赋值 (滚动条.nPos, 滚动条.nMax)
.判断 (等于 (flag, 6))
    赋值 (滚动条.nPos, 滚动条.nMin)
.默认
    
.判断结束
SetScrollInfo (远程屏幕句柄, 1, 滚动条, 真)
赋值 (纵移距离, 相除 (相乘 (负 (相减 (old.nPos, 滚动条.nPos)), 相减 (_启动窗口., 74, .高度)), 2000))
_启动窗口.发送信息 (15, 0, 0)


.子程序 __启动窗口_尺寸被改变, 空白型, , 
.如果真 (或者 (大于 (相减 (_启动窗口., 32), .宽度), 大于 (相减 (_启动窗口., 74), .高度)))
    赋值 (_启动窗口., 相加 (.宽度, 32))
    赋值 (_启动窗口., 相加 (.高度, 74))
    赋值 (横移距离, 0)
    赋值 (纵移距离, 0)
    赋值 (滚动条.nPos, 0)
    SetScrollInfo (远程屏幕句柄, 0, 滚动条, 真)
    SetScrollInfo (远程屏幕句柄, 1, 滚动条, 真)
.如果真结束
赋值 (横移距离, 0)
赋值 (纵移距离, 0)
赋值 (滚动条.nPos, 0)
SetScrollInfo (远程屏幕句柄, 0, 滚动条, 真)
SetScrollInfo (远程屏幕句柄, 1, 滚动条, 真)

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
未知支持库函数_2 (多线程许可证)
SetWindowLongA (远程屏幕句柄, -4, OldProc)
关闭服务器 ()
返回 (真)


.子程序 _发送CtrlShiftEsc_被选择, 空白型, , 
.局部变量 发送数据, 字节集, , , 

.如果真 (等于 (屏幕控制启动, 真))
    赋值 (发送数据, { 10, 0, 17, 16, 27 })
    发送数据 (客户句柄, 发送数据)
.如果真结束


.子程序 _发送CtrlShift_被选择, 空白型, , 
.局部变量 发送数据, 字节集, , , 

.如果真 (等于 (屏幕控制启动, 真))
    赋值 (发送数据, { 10, 1, 17, 16 })
    发送数据 (客户句柄, 发送数据)
.如果真结束


.子程序 _发送Ctrl空格_被选择, 空白型, , 
.局部变量 发送数据, 字节集, , , 

.如果真 (等于 (屏幕控制启动, 真))
    赋值 (发送数据, { 10, 2, 17, 32 })
    发送数据 (客户句柄, 发送数据)
.如果真结束


.子程序 _发送CtrlF12_被选择, 空白型, , 
.局部变量 发送数据, 字节集, , , 

.如果真 (等于 (屏幕控制启动, 真))
    赋值 (发送数据, { 10, 3, 17, 123 })
    发送数据 (客户句柄, 发送数据)
.如果真结束


.子程序 _发送CtrlEsc_被选择, 空白型, , 
.局部变量 发送数据, 字节集, , , 

.如果真 (等于 (屏幕控制启动, 真))
    赋值 (发送数据, { 10, 4, 17, 27 })
    发送数据 (客户句柄, 发送数据)
.如果真结束


.子程序 _发送AltF4_被选择, 空白型, , 
.局部变量 发送数据, 字节集, , , 

.如果真 (等于 (屏幕控制启动, 真))
    赋值 (发送数据, { 10, 5, 18, 115 })
    发送数据 (客户句柄, 发送数据)
.如果真结束


.子程序 _远程屏幕画板_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 发送数据, 字节集, , , 

.如果真 (等于 (屏幕控制启动, 真))
    赋值 (发送数据, 相加 ({ 20 }, 到字节集 (相加 (到文本 (相除 (横向位置, .宽度)), “|”, 到文本 (相除 (纵向位置, .高度))))))
    发送数据 (客户句柄, 发送数据)
.如果真结束


.子程序 _远程屏幕画板_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 发送数据, 字节集, , , 

.如果真 (等于 (屏幕控制启动, 真))
    赋值 (发送数据, 相加 ({ 21 }, 到字节集 (相加 (到文本 (相除 (横向位置, .宽度)), “|”, 到文本 (相除 (纵向位置, .高度))))))
    发送数据 (客户句柄, 发送数据)
.如果真结束


.子程序 _远程屏幕画板_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 发送数据, 字节集, , , 

.如果真 (等于 (屏幕控制启动, 真))
    赋值 (发送数据, 相加 ({ 22 }, 到字节集 (相加 (到文本 (相除 (横向位置, .宽度)), “|”, 到文本 (相除 (纵向位置, .高度))))))
    发送数据 (客户句柄, 发送数据)
.如果真结束


.子程序 _远程屏幕画板_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 发送数据, 字节集, , , 

.如果真 (等于 (屏幕控制启动, 真))
    赋值 (发送数据, 相加 ({ 23 }, 到字节集 (相加 (到文本 (相除 (横向位置, .宽度)), “|”, 到文本 (相除 (纵向位置, .高度))))))
    发送数据 (客户句柄, 发送数据)
.如果真结束


.子程序 _远程屏幕画板_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 发送数据, 字节集, , , 

.如果真 (等于 (屏幕控制启动, 真))
    赋值 (发送数据, 相加 ({ 24 }, 到字节集 (相加 (到文本 (相除 (横向位置, .宽度)), “|”, 到文本 (相除 (纵向位置, .高度))))))
    发送数据 (客户句柄, 发送数据)
.如果真结束


.子程序 _远程屏幕画板_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 发送数据, 字节集, , , 

.如果真 (等于 (屏幕控制启动, 真))
    赋值 (发送数据, 相加 ({ 25 }, 到字节集 (相加 (到文本 (相除 (横向位置, .宽度)), “|”, 到文本 (相除 (纵向位置, .高度))))))
    发送数据 (客户句柄, 发送数据)
.如果真结束


.子程序 屏幕, 空白型, , 
.参数 操作, 整数型, , 
.参数 数据, 字节集, , 

.局部变量 图片宽高, 字节集, , "0", 
.局部变量 图像, 字节集, , , 

.判断开始 (等于 (操作, 0))
    赋值 (图片宽高, 分割字节集 (数据, { 124 }, 2))
    赋值 (.宽度, 到整数 (到文本 (图片宽高 [1])))
    赋值 (.高度, 到整数 (到文本 (图片宽高 [2])))
    .如果真 (或者 (大于 (相减 (_启动窗口., 32), .宽度), 大于 (相减 (_启动窗口., 74), .高度)))
        赋值 (_启动窗口., 相加 (.宽度, 32))
        赋值 (_启动窗口., 相加 (.高度, 74))
        赋值 (横移距离, 0)
        赋值 (纵移距离, 0)
        赋值 (滚动条.nPos, 0)
        SetScrollInfo (远程屏幕句柄, 0, 滚动条, 真)
        SetScrollInfo (远程屏幕句柄, 1, 滚动条, 真)
    .如果真结束
    发送数据 (客户句柄, { 1 })
    
.判断 (等于 (操作, 1))
    发送数据 (客户句柄, { 1 })
    赋值 (图像, 未知支持库函数_1 (数据))
    未知支持库函数_3 (多线程许可证)
    赋值 (.底图, 图像)
    未知支持库函数_4 (多线程许可证)
    
.判断 (等于 (操作, 2))
    发送数据 (客户句柄, { 1 })
    未知支持库函数_3 (多线程许可证)
    赋值 (图像, 组合差异图片 (.底图, 未知支持库函数_1 (数据)))
    赋值 (.底图, 图像)
    未知支持库函数_4 (多线程许可证)
    
.判断 (等于 (操作, 3))
    发送数据 (客户句柄, { 1 })
.默认
    
.判断结束


.子程序 组合差异图片, 字节集, , 
.参数 原图, 字节集, , 
.参数 差异图, 字节集, , 

.局部变量 图像宽, 整数型, , , 
.局部变量 图像高, 整数型, , , 
.局部变量 数据, 字节集, , , 
.局部变量 偏移, 整数型, , , 

赋值 (图像宽, 相加 (原图 [19], 相乘 (原图 [20], 256)))
赋值 (图像高, 相加 (原图 [23], 相乘 (原图 [24], 256)))
赋值 (数据, 原图)
赋值 (偏移, 选择 (等于 (求余数 (相乘 (图像宽, 3), 4), 0), 0, 相减 (4, 求余数 (相乘 (图像宽, 3), 4))))
置入代码 ({ 51, 246, 190, 54, 4, 0, 0, 51, 219, 139, 93, 12, 139, 27, 51, 255, 139, 125, 244, 139, 69, 248, 51, 201, 65, 81, 80, 59, 200, 15, 143, 45, 0, 0, 0, 139, 69, 252, 51, 201, 65, 81, 80, 59, 200, 15, 143, 19, 0, 0, 0, 138, 68, 51, 8, 60, 12, 117, 2, 235, 4, 136, 68, 62, 8, 70, 88, 89, 235, 226, 131, 196, 8, 3, 117, 240, 88, 89, 235, 200, 131, 196, 8 })
返回 (数据)

.子程序 __启动窗口_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 发送数据, 字节集, , , 

.如果真 (等于 (屏幕控制启动, 真))
    赋值 (发送数据, 相加 ({ 26 }, 到字节集 (键代码)))
    发送数据 (客户句柄, 发送数据)
    返回 (假)
.如果真结束
返回 (真)

.子程序 _传送鼠标和键盘操作_被选择, 空白型, , 
赋值 (.禁止, 真)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (_启动窗口., “远程屏幕控制 - 传送鼠标和键盘操作已开始”)
赋值 (屏幕控制启动, 真)

.子程序 _停止鼠标和键盘操作_被选择, 空白型, , 
赋值 (.禁止, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (_启动窗口., “远程屏幕控制”)
赋值 (屏幕控制启动, 假)


.子程序 _保存当前画面_被选择, 空白型, , 
.如果真 (等于 (.底图, {  }))
    信息框 (“无图像数据！”, 16, “错误”)
    返回 ()
.如果真结束

.如果 (等于 (写到文件 (相加 (取运行目录 (), “\”, 到文本 (取现行时间 ()), “.BMP”), .底图), 真))
    信息框 (“图片已保存到程序目录...　　　”, 64, “导出图像：”)
.否则
    信息框 (“图片保存失败！”, 16, “错误”)
.如果结束


.程序集 程序集1, , , 

.程序集变量 服务器, 未知类型0x30001, , , 
.子程序 打开服务器, 逻辑型, , 
.参数 端口号, 整数型, 可空, 默认为888
.参数 最小线程数, 整数型, 可空, 不小于5的整数，默认为5
.参数 最大线程数, 整数型, 可空, 不小于10的整数，默认为25

.如果真 (或者 (是否为空 (端口号), 等于 (端口号, 0)))
    赋值 (端口号, 888)
.如果真结束
.如果真 (或者 (是否为空 (最小线程数), 小于 (最小线程数, 5)))
    赋值 (最小线程数, 5)
.如果真结束
.如果真 (或者 (是否为空 (最大线程数), 小于 (最大线程数, 10)))
    赋值 (最大线程数, 25)
.如果真结束

服务器.未知支持库函数_3 (最小线程数, 最大线程数)
返回 (服务器.未知支持库函数_1 (端口号, &数据处理, 假))


.子程序 关闭服务器, 空白型, , 
服务器.未知支持库函数_2 ()

.子程序 数据处理, 空白型, , 
.参数 消息地址, 整数型, , 

.局部变量 消息类型, 整数型, , , 
.局部变量 请求代码, 文本型, , , 
.局部变量 请求信息, 字节集, , , 

赋值 (消息类型, 服务器.未知支持库函数_27 (消息地址))
.如果真 (等于 (消息类型, 0))
    服务器.未知支持库函数_8 (消息地址, 客户句柄)
    发送数据 (客户句柄, { 0 })
    返回 ()
.如果真结束

.如果真 (等于 (消息类型, 1))
     ' 离开
    返回 ()
.如果真结束

.如果真 (等于 (消息类型, -1))
     ' 出错
    返回 ()
.如果真结束

服务器.未知支持库函数_5 (消息地址, 请求代码, 请求信息)
屏幕 (请求信息 [1], 取字节集中间 (请求信息, 2, 相减 (取字节集长度 (请求信息), 1)))


.子程序 发送数据, 逻辑型, , 
.参数 句柄, 整数型, , 
.参数 数据, 字节集, , 

返回 (服务器.未知支持库函数_7 (句柄, 数据))



 ' 不属于任何一个程序集、类模块的函数：
