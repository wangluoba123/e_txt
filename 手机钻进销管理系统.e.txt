 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 窗口主
    左边 = 50
    顶边 = 50
    宽度 = 745
    高度 = 536
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “手机钻进销管理系统-免费版（测试）”
    帮助文件名 = “”

窗口 窗口2
    左边 = 50
    顶边 = 50
    宽度 = 470
    高度 = 107
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假



.常量 数据库1, "“数据库”", , 
.常量 ID, "“ID”", , 
.常量 业务类型, "“业务类型”", , 
.常量 业务时间, "“业务时间”", , 
.常量 充值帐号, "“充值帐号”", , 
.常量 充值时间, "“充值时间”", , 
.常量 充值手机, "“充值手机”", , 
.常量 备注, "“备注”", , 
.常量 是否过期, "“是否过期”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 2 0 多线程支持库





.程序集 程序集1, , , 

.程序集变量 行, 整数型, , , 
.程序集变量 已到期数量, 整数型, , , 
.程序集变量 未到期数量, 整数型, , , 
.程序集变量 订单状态, 文本型, , , 
.子程序 _启动子程序, 整数型, , 本子程序在程序启动后最先执行
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

置随机数种子 ()
载入 (窗口主, , 假)
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 取日期格式, 日期时间型, , 
.参数 完整日期, 日期时间型, , 

.局部变量 位置1, 整数型, , , 
.局部变量 位置2, 整数型, , , 

赋值 (位置1, 1)
赋值 (位置2, 寻找文本 (到文本 (完整日期), “日”, , 假))
返回 (到时间 (相加 (取文本中间 (到文本 (完整日期), 位置1, 相减 (位置2, 位置1)), “日”)))

.子程序 读入订单数据, 空白型, , 
窗口主.插入表项 (., , , , , , )
窗口主.置标题 (., 行, 0, 到文本 (读 (#ID)))
窗口主.置标题 (., 行, 1, 读 (#业务类型))
窗口主.置标题 (., 行, 2, 读 (#业务时间))
窗口主.置标题 (., 行, 3, 读 (#充值帐号))
窗口主.置标题 (., 行, 4, 到文本 (读 (#充值时间)))
窗口主.置标题 (., 行, 5, 读 (#充值手机))
窗口主.置标题 (., 行, 6, 已到期业务 ())
窗口主.置标题 (., 行, 7, 读 (#备注))
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 查找数据, 空白型, , 
.参数 业务, 文本型, 可空, 
.参数 帐号, 文本型, 可空, 
.参数 最大日期, 日期时间型, 可空, 
.参数 最小日期, 日期时间型, 可空, 

窗口主.全部删除 (.)
打开 (#数据库1, , , , , , )
赋值 (窗口主..标题, 相加 (“总共”, 到文本 (取记录数 ()), “个”))
.计次循环首 (取记录数 (), )
    赋值 (行, 窗口主.取表项数 (.))
    .判断开始 (并且 (大于或等于 (最大日期, 读 (#充值时间)), 大于或等于 (读 (#充值时间), 最小日期)))
        .判断开始 (并且 (等于 (业务, “”), 等于 (帐号, “”)))
            赋值 (订单状态, 已到期业务 ())
            读入订单数据 ()
        .判断 (并且 (不等于 (帐号, “”), 等于 (业务, “”)))
            .判断开始 (等于 (帐号, 读 (#充值帐号)))
                赋值 (订单状态, 已到期业务 ())
                读入订单数据 ()
            .默认
                 ' 本源码来自易语言资源网(www.5A5X.com)
            .判断结束
            
        .判断 (并且 (不等于 (业务, “”), 等于 (帐号, “”)))
            .判断开始 (等于 (业务, 读 (#业务类型)))
                赋值 (订单状态, 已到期业务 ())
                读入订单数据 ()
            .默认
                
            .判断结束
            
        .判断 (并且 (不等于 (业务, “”), 不等于 (帐号, “”)))
            .判断开始 (并且 (等于 (业务, 读 (#业务类型)), 等于 (帐号, 读 (#充值帐号))))
                赋值 (订单状态, 已到期业务 ())
                读入订单数据 ()
            .默认
                
            .判断结束
            
        .默认
            
        .判断结束
        
        
    .默认
        
    .判断结束
    跳过 ()
.计次循环尾 ()
关闭 ()

.子程序 添加数据, 逻辑型, , 
.参数 业务类型, 文本型, , 
.参数 业务时间, 文本型, , 
.参数 充值帐号, 文本型, , 
.参数 充值时间, 日期时间型, , 
.参数 充值手机, 文本型, 可空, 
.参数 备注, 文本型, 可空, 

打开 (#数据库1, , , , , , )
.如果 (加记录 (相加 (取记录数 (), 1), 业务类型, 业务时间, 充值帐号, 充值时间, 充值手机, 备注))
    返回 (真)
.否则
    返回 (假)
.如果结束
关闭 ()


.子程序 已到期业务, 文本型, , 
.局部变量 n1, 整数型, , , 
.局部变量 充值时间, 日期时间型, , , 

.判断开始 (等于 (读 (#业务时间), “一个月”))
    赋值 (充值时间, 增减时间 (读 (#充值时间), #日, 30))
    .判断开始 (大于 (取日期 (取现行时间 ()), 充值时间))
        返回 (“已到期”)
    .默认
        返回 (“未到期”)
    .判断结束
     ' 本源码来自易语言资源网(www.5A5X.com)
.判断 (等于 (读 (#业务时间), “三个月”))
    赋值 (充值时间, 增减时间 (读 (#充值时间), #日, 90))
    .判断开始 (大于 (取日期 (取现行时间 ()), 充值时间))
        返回 (“已到期”)
    .默认
        返回 (“未到期”)
    .判断结束
    
.判断 (等于 (读 (#业务时间), “六个月”))
    赋值 (充值时间, 增减时间 (读 (#充值时间), #日, 180))
    .判断开始 (大于 (取日期 (取现行时间 ()), 充值时间))
        返回 (“已到期”)
    .默认
        返回 (“未到期”)
    .判断结束
    
.默认
    .判断开始 (等于 (读 (#业务时间), “12个月”))
        赋值 (充值时间, 增减时间 (读 (#充值时间), #日, 365))
        .判断开始 (大于 (取日期 (取现行时间 ()), 充值时间))
            返回 (“已到期”)
        .默认
            返回 (“未到期”)
        .判断结束
        
        
    .默认
        
    .判断结束
    
.判断结束
返回 (相加 (“错误：”, 到文本 (取随机数 (100, 999))))


.子程序 取出已到期数据, 空白型, , 
窗口主.全部删除 (.)
打开 (#数据库1, , , , , , )
赋值 (已到期数量, 0)
赋值 (未到期数量, 0)
.计次循环首 (取记录数 (), )
    赋值 (行, 窗口主.取表项数 (.))
    .如果 (等于 (已到期业务 (), “已到期”))
        
        读入订单数据 ()
        赋值 (已到期数量, 相加 (已到期数量, 1))
    .否则
        赋值 (未到期数量, 相加 (未到期数量, 1))
    .如果结束
    跳过 ()
.计次循环尾 ()
赋值 (窗口主..标题, 相加 (“已到期”, 到文本 (已到期数量), “个”))
赋值 (窗口主..标题, 相加 (“未到期”, 到文本 (未到期数量), “个”))
关闭 ()


.子程序 取出未到期数据, 空白型, , 
窗口主.全部删除 (.)
打开 (#数据库1, , , , , , )
赋值 (已到期数量, 0)
赋值 (未到期数量, 0)
.计次循环首 (取记录数 (), )
    赋值 (行, 窗口主.取表项数 (.))
    .如果 (等于 (已到期业务 (), “未到期”))
        读入订单数据 ()
        赋值 (未到期数量, 相加 (未到期数量, 1))
    .否则
        赋值 (已到期数量, 相加 (已到期数量, 1))
    .如果结束
    
    
    跳过 ()
.计次循环尾 ()
赋值 (窗口主..标题, 相加 (“已到期”, 到文本 (已到期数量), “个”))
赋值 (窗口主..标题, 相加 (“未到期”, 到文本 (未到期数量), “个”))
关闭 ()

.子程序 取全部数据, 空白型, , 
窗口主.全部删除 (.)
赋值 (已到期数量, 0)
赋值 (未到期数量, 0)
打开 (#数据库1, , , , , , )
赋值 (窗口主..标题, 相加 (“总共”, 到文本 (取记录数 ()), “个”))
.计次循环首 (取记录数 (), )
    赋值 (行, 窗口主.取表项数 (.))
    读入订单数据 ()
    .如果 (等于 (已到期业务 (), “已到期”))
        赋值 (已到期数量, 相加 (已到期数量, 1))
    .否则
        赋值 (未到期数量, 相加 (未到期数量, 1))
    .如果结束
    跳过 () ' 本源码来自易语言资源网(www.5A5X.com)
.计次循环尾 ()
赋值 (窗口主..标题, 相加 (“已到期”, 到文本 (已到期数量), “个”))
赋值 (窗口主..标题, 相加 (“未到期”, 到文本 (未到期数量), “个”))
关闭 ()

.子程序 修改数据, 空白型, , 
.局部变量 业务类型, 文本型, , , 
.局部变量 业务时间, 文本型, , , 
.局部变量 充值帐号, 文本型, , , 
.局部变量 充值时间, 日期时间型, , , 
.局部变量 充值手机, 文本型, 静态, , 
.局部变量 备注, 文本型, 静态, , 
.局部变量 ID, 整数型, , , 
.局部变量 行1, 整数型, , , 
.局部变量 临时数据, 逻辑型, , , 

打开 (#数据库1, , , , , , )
赋值 (业务类型, 窗口主..内容)
赋值 (业务时间, 窗口主..内容)
赋值 (充值帐号, 窗口主..内容)
赋值 (充值时间, 到时间 (窗口主..内容))
赋值 (充值手机, 窗口主..内容)
赋值 (备注, 窗口主..内容)
赋值 (ID, 到数值 (窗口主.取标题 (., 行1, 0)))
跳到 (ID)
修改 (业务类型, 业务时间, 充值帐号, 充值时间, 充值手机, 备注, )
关闭 ()
' 本源码来自易语言资源网(www.5A5X.com)




.子程序 删除数据, 空白型, , 
.参数 ID, 整数型, , 

打开 (#数据库1, , , , , , )
跳到 (ID)
删除 ()
彻底删除 ()
关闭 ()


.窗口程序集 窗口主程序集, , , 

.子程序 _窗口主_创建完毕, 空白型, , 
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

赋值 (.内容, 到文本 (取日期 (取现行时间 ())))
赋值 (.今天, 增减时间 (.今天, #日, -7))
未知支持库函数_0 (&取全部数据, , )

.子程序 _按钮查找_被单击, 空白型, , 
 ' 查找数据 (.内容, .内容, 取日期格式 (.今天), 取日期格式 (.今天))



.子程序 _按钮添加_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (“您还没有选择需要添加的业务类型”, 0, “错误信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“您还没有选择或写上业务时间”, 0, “错误信息”)
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“您还没有写上您需要添加的充值帐号”, 0, “错误信息”)
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“您还没有写上您需要添加的手机号码”, 0, “错误信息”)
    返回 ()
.如果真结束
.如果 (添加数据 (.内容, .内容, .内容, 到时间 (.内容), .内容, .内容))
    信息框 (“数据添加成功！！！”, 0, )
.否则
    信息框 (“数据添加失败！！！”, 0, )
.如果结束
未知支持库函数_0 (&取全部数据, , )

.子程序 _按钮修改_被单击, 空白型, , 
.如果真 (等于 (., -1))
    信息框 (“请您先选择需要修改的内容 ”, 0, “提示”)
    返回 () ' 本源码来自易语言资源网(www.5A5X.com)
.如果真结束
修改数据 ()
未知支持库函数_0 (&取全部数据, , )

.子程序 _超级列表框1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _标签订单状态_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

取出已到期数据 ()


.子程序 _标签未到期_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

取出未到期数据 ()

.子程序 _标签总数_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

取全部数据 ()

.子程序 _删除_被选择, 空白型, , 
' 本源码来自易语言资源网(www.5A5X.com)
.判断开始 (不等于 (., -1))
    .删除表项 (.)
    删除数据 (.)
.默认
    信息框 (“请先选择需要修改的订单！！！”, 0, “提示”)
.判断结束
未知支持库函数_0 (&取全部数据, , )

.子程序 _修改_被选择, 空白型, , 
.局部变量 行1, 整数型, , , 

赋值 (行1, 窗口主..)
赋值 (.内容, 窗口主.取标题 (., 行1, 1))
赋值 (.内容, 窗口主.取标题 (., 行1, 2))
赋值 (.内容, 窗口主.取标题 (., 行1, 3))
赋值 (.内容, 窗口主.取标题 (., 行1, 4))
赋值 (.内容, 窗口主.取标题 (., 行1, 5))
赋值 (.内容, 窗口主.取标题 (., 行1, 7))
未知支持库函数_0 (&取全部数据, , )


 ' 不属于任何一个程序集、类模块的函数：
