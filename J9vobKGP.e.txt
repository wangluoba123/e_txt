 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 362
    高度 = 237
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “信用卡管理器――用户登陆”
    帮助文件名 = “”

窗口 窗口_主界面
    左边 = 50
    顶边 = 50
    宽度 = 720
    高度 = 509
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “信用卡管理器――卡片休息”
    帮助文件名 = “”

窗口 窗口_信用卡管理
    左边 = 50
    顶边 = 50
    宽度 = 673
    高度 = 305
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “信用卡管理器――添加信用卡”
    帮助文件名 = “”

窗口 窗口_银行管理
    左边 = 50
    顶边 = 50
    宽度 = 475
    高度 = 240
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 窗口_提醒
    左边 = 50
    顶边 = 50
    宽度 = 382
    高度 = 292
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “信用卡管理器――信用卡提醒”
    帮助文件名 = “”



.图片 CCM, " ' 已保存到：D:\易语言学习\Data\J9vobKGP.e\CCM", , 
.图片 BankNoLogo, " ' 已保存到：D:\易语言学习\Data\J9vobKGP.e\BankNoLogo", , 
.图片 CardNoLogo, " ' 已保存到：D:\易语言学习\Data\J9vobKGP.e\CardNoLogo", , 
.图片 色值2, " ' 已保存到：D:\易语言学习\Data\J9vobKGP.e\色值2", , 
.常量 BI_银行名称, "“银行名称”", , 
.常量 BI_银行网站, "“银行网站”", , 
.常量 BI_服务电话, "“服务电话”", , 
.常量 BI_信用卡电话, "“信用卡电话”", , 
.常量 BI_银行标志, "“银行标志”", , 
.常量 , , , 
.常量 CI_信用卡号, "“信用卡号”", , 
.常量 CI_信用卡所属银行, "“信用卡所属银行”", , 
.常量 CI_信用卡外观, "“信用卡外观”", , 
.常量 , , , 
.常量 UI_用户姓名, "“用户姓名”", , 
.常量 UI_信用卡号, "“信用卡号”", , 
.常量 UI_交易金额, "“交易金额”", , 
.常量 UI_交易日期, "“交易日期”", , 
.常量 UI_账单日, "“账单日”", , 
.常量 UI_到期还款日, "“到期还款日”", , 
.常量 UI_已还金额, "“已还金额”", , 
.常量 UI_用户密码, "“用户密码”", , 
.常量 UI_密码问题, "“密码问题”", , 
.常量 , , , 
.常量 ZC_注册时间目录, "“Software\cardmanage\star time”", , 
.常量 ZC_注册码目录, "“Software\cardmanage\regcode”", , 
.常量 PZ_配置文件目录, "“C:\WINDOWS\system32\StarTime.ini”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 2 6 扩展界面支持库三
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' spec A512548E76954B6E92C21055517615B0 2 1 特殊功能支持库
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 1 0 数据操作支持库一
 ' iext5 {E5000198-4471-40e2-92BC-D0BA075BDBB2} 1 5 扩展界面支持库五
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 1 3 高级表格支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库




数据类型 数据类型_System_Info, , 
    .成员 dwOemID, 整数型, , , 
    .成员 dwPageSize, 整数型, , , 
    .成员 lpMinimumApplicationAddress, 整数型, , , 
    .成员 lpMaximumApplicationAddress, 整数型, , , 
    .成员 dwActiveProcessorMask, 整数型, , , 
    .成员 dwNumberOrfProcessors, 整数型, , , 
    .成员 dwProcessorType, 整数型, , , 
    .成员 dwAllocationGranularity, 整数型, , , 
    .成员 wProcessorLevel, 整数型, , , 
    .成员 wProcessorRevision, 整数型, , , 

.全局变量 全局_用户名, 文本型, , , 
.全局变量 全局_银行, 整数型, , , 
.全局变量 全局_信用卡, 整数型, , , 
.全局变量 全局_id, 文本型, , , 
.全局变量 全局_查询密码, 文本型, , , 
.全局变量 全局_取款密码, 文本型, , , 
.全局变量 全局_天数, 文本型, , , 
.全局变量 全局_透支, 文本型, , , 
.全局变量 全局_银行名称, 文本型, , , 
.全局变量 全局_卡号, 文本型, , , 
.全局变量 全局_卡名, 文本型, , , 
.全局变量 全局_计次, 整数型, , , 
.全局变量 全局_uid, 整数型, , , 
.全局变量 全局_用户版本, 文本型, , , 

.DLL命令 dll_取系统信息, 空白型, "kernel32.dll", "GetSystemInfo", , 
    .参数 参数_SYSTEM_INFO, 数据类型_System_Info, , lpSystemInfo As SYSTEM_INFO

.窗口程序集 启动_程序集, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 局部_记录集句柄, 整数型, , , 
.局部变量 局部_配置项, 文本型, , , 
.局部变量 局部_注册项, 文本型, , , 

子程序_初始化使用判断 () ' 为以后注册做准备:-)

.如果真 (等于 (相加 (取运行目录 (), “\CCM”).打开MDB数据库 (“sqsxl”, , ), 假))
    信息框 (“数据库打开失败！”, #错误图标, )
    结束 ()
.如果真结束
 ' 局部_配置项 ＝ 子程序_解密 (读配置项 (#PZ_配置文件目录, “注册”, “注册码”, ))  ' 为以后注册做准备:-)
 ' 局部_注册项 ＝ 取文本注册项 (#现行用户, #ZC_注册码目录, )  ' 为以后注册做准备:-)
 ' .如果 (不等于 (局部_配置项, 局部_注册项)) ' 为以后注册做准备:-)
     ' 局部_记录集句柄 ＝ 外部数据库1.查询 (“select count(*) from User_Info”)  ' 为以后注册做准备:-)
     ' .如果真 (等于 (局部_记录集句柄.读 (1), 1)) ' 为以后注册做准备:-)
         ' 信息框 (“试用版只能注册一位用户”, #警告图标, )  ' 为以后注册做准备:-)
         ' 高级选择夹1.现行子夹 ＝ 0  ' 为以后注册做准备:-)
         ' 高级选择夹1.隐藏子夹 (1, 真)  ' 为以后注册做准备:-)
         ' 高级选择夹1.隐藏子夹 (2, 真)  ' 为以后注册做准备:-)
         ' 高级选择夹1.隐藏子夹 (3, 真)  ' 为以后注册做准备:-)
         ' 全局_用户版本 ＝ “未注册”  ' 为以后注册做准备:-)
    .如果真结束
    
.否则
     ' 高级选择夹1.隐藏子夹 (4, 真)  ' 为以后注册做准备:-)
     ' 全局_用户版本 ＝ “已注册”  ' 为以后注册做准备:-)
    
.如果结束
赋值 (全局_用户版本, “已注册”) ' 为以后注册做准备:-)


.子程序 子程序_生成注册码, 文本型, , ' 为以后注册做准备:-)
.参数 参数_硬盘, 未知类型0x80007, , 
.参数 参数_SI, 数据类型_System_Info, , 
.参数 参数_cpu, 未知类型0x80003, , 

.局部变量 局部_硬盘特征, 文本型, , , 
.局部变量 局部_文本数组, 文本型, , "0", 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_字节集, 字节集, , , 
.局部变量 局部_结果, 文本型, , , 


赋值 (局部_硬盘特征, 相加 (参数_硬盘., “-”, 到文本 (整除 (参数_SI.lpMaximumApplicationAddress, 参数_SI.lpMinimumApplicationAddress)), “-”, 参数_cpu.))
赋值 (局部_硬盘特征, 子文本替换 (局部_硬盘特征, “0”, “”, 1, , 真))
赋值 (局部_文本数组, 分割文本 (局部_硬盘特征, “-”, ))
赋值 (局部_硬盘特征, 局部_文本数组 [1])
赋值 (局部_硬盘特征, 相加 (局部_硬盘特征, 局部_文本数组 [2]))
赋值 (局部_硬盘特征, 相加 (局部_硬盘特征, 局部_文本数组 [3]))
赋值 (局部_硬盘特征, 相加 (局部_硬盘特征, 局部_文本数组 [4]))
赋值 (局部_硬盘特征, 相加 (局部_硬盘特征, 局部_文本数组 [5]))
.如果真 (小于 (取文本长度 (局部_硬盘特征), 10))
    赋值 (局部_硬盘特征, 相加 (局部_硬盘特征, 取重复文本 (相减 (10, 取文本长度 (局部_硬盘特征)), “0”)))
.如果真结束

返回 (局部_硬盘特征)


.子程序 子程序_初始化使用判断, 空白型, , 软件使用判断
.局部变量 局部_硬盘, 未知类型0x80007, , , 
.局部变量 局部_cpu, 未知类型0x80003, , , 
.局部变量 局部_SI, 数据类型_System_Info, , , 

 ' ----------------------------->判断是否是第一次使用
 ' 取硬盘信息 (局部_硬盘, 0)
 ' 取CPU信息 (局部_cpu)
 ' dll_取系统信息 (局部_SI)

 ' .判断开始 (等于 (寻找文件 (相加 (取运行目录 (), “\CCM”), ), “”))
     ' .判断开始 (等于 (信息框 (“数据库丢失，是否导入备份数据库？”, 相加 (#询问图标, #是否钮), ), #否钮))
         ' .判断开始 (等于 (信息框 (“数据库丢失，是否创建新数据库？”, 相加 (#询问图标, #是否钮), ), #否钮))
             ' 结束 ()
        .默认
             ' .如果真 (等于 (写到文件 (相加 (取运行目录 (), “\CCM”), #CCM), 假))
                 ' 信息框 (“新数据库创建失败！”, #错误图标, )
                 ' 结束 ()
            .如果真结束
             ' 信息框 (“新数据库创建成功！”, 0, )
        .判断结束
         ' ' ----------------------------->用户导入备份数据库
    .默认
         ' 通用对话框1.过滤器 ＝ “CCM|CCM”
         ' .如果真 (等于 (打开 (), 假))
             ' 返回 ()
        .如果真结束
         ' .如果真 (等于 (复制文件 (.文件名, 相加 (取运行目录 (), “\CCM”)), 假))
             ' 信息框 (“备份数据库导入失败！”, #错误图标, )
             ' 返回 ()
        .如果真结束
         ' 信息框 (“备份数据库导入成功！”, 0, )
    .判断结束
     ' 返回 ()
    
.默认
    
.判断结束

.判断开始 (等于 (寻找文件 (相加 (取运行目录 (), “\CCM”), ), “”))
    .如果真 (等于 (写到文件 (相加 (取运行目录 (), “\CCM”), #CCM), 假))
        信息框 (“新数据库创建失败！”, #错误图标, )
        结束 ()
    .如果真结束
     ' 信息框 (“新数据库创建成功！”, 0, )
     ' ----------------------------->用户导入备份数据库
     ' 通用对话框1.过滤器 ＝ “CCM|CCM”
     ' .如果真 (等于 (打开 (), 假))
         ' 返回 ()
    .如果真结束
     ' .如果真 (等于 (复制文件 (.文件名, 相加 (取运行目录 (), “\CCM”)), 假))
         ' 信息框 (“备份数据库导入失败！”, #错误图标, )
         ' 返回 ()
    .如果真结束
     ' 信息框 (“备份数据库导入成功！”, 0, )
     ' 返回 ()
    
.默认
    
.判断结束




 ' .判断开始 (并且 (不等于 (取文本中间 (取文本注册项 (#现行用户, #ZC_注册时间目录, ), 5, 2), “年”), 不等于 (取文本中间 (读配置项 (#PZ_配置文件目录, “时间”, “使用时间”, ), 5, 2), “年”), 等于 (寻找文件 (相加 (取运行目录 (), “\CCM.mdb”), ), “”)))
     ' .如果真 (等于 (写到文件 (相加 (取运行目录 (), “\CCM.mdb”), #CCM), 假))
         ' 信息框 (“数据库导出失败！”, #错误图标, )
         ' 结束 ()
    .如果真结束
     ' 写配置项 (#PZ_配置文件目录, “时间”, “使用时间”, 到文本 (取日期 (取现行时间 ())))  ' 为以后注册做准备:-)
     ' 写配置项 (#PZ_配置文件目录, “注册”, “注册码”, 子程序_加密 (子程序_生成注册码 (局部_硬盘, 局部_SI, 局部_cpu)))  ' 为以后注册做准备:-)
     ' 写注册项 (#现行用户, #ZC_注册时间目录, 到文本 (取日期 (取现行时间 ())))  ' 为以后注册做准备:-)
     ' 写注册项 (#现行用户, #ZC_注册码目录, “”)  ' 为以后注册做准备:-)
     ' 返回 ()
.默认
     ' ----------------------------->判断是否是因注册表配置项问题
.判断结束
 ' .判断开始 (或者 (不等于 (取文本中间 (取文本注册项 (#现行用户, #ZC_注册时间目录, ), 5, 2), “年”), 并且 (不等于 (取文本中间 (读配置项 (#PZ_配置文件目录, “时间”, “使用时间”, ), 5, 2), “年”), 不等于 (寻找文件 (相加 (取运行目录 (), “\CCM.mdb”), ), “”)))) ' 为以后注册做准备:-)
     ' .如果真 (等于 (信息框 (“注册信息被破坏，是否继续使用本软件？”, 相加 (#询问图标, #是否钮), ), #否钮))
         ' 结束 ()
    .如果真结束
     ' 删除注册项 (#现行用户, #ZC_注册时间目录)  ' 为以后注册做准备:-)
     ' 删除注册项 (#现行用户, #ZC_注册码目录)  ' 为以后注册做准备:-)
     ' 写注册项 (#现行用户, #ZC_注册时间目录, 到文本 (取日期 (取现行时间 ())))  ' 为以后注册做准备:-)
     ' 删除文件 (#PZ_配置文件目录)  ' 为以后注册做准备:-)
     ' 写配置项 (#PZ_配置文件目录, “时间”, “使用时间”, 到文本 (取日期 (取现行时间 ())))  ' 为以后注册做准备:-)
     ' 写配置项 (#PZ_配置文件目录, “注册”, “注册码”, 子程序_加密 (子程序_生成注册码 (局部_硬盘, 局部_SI, 局部_cpu)))  ' 为以后注册做准备:-)
     ' 返回 ()
.默认
     ' ----------------------------->判断是否是因数据库问题
.判断结束
 ' .判断开始 (并且 (等于 (取文本中间 (取文本注册项 (#现行用户, #ZC_注册时间目录, ), 5, 2), “年”), 等于 (取文本中间 (读配置项 (#PZ_配置文件目录, “时间”, “使用时间”, ), 5, 2), “年”), 等于 (寻找文件 (相加 (取运行目录 (), “\CCM.mdb”), ), “”)))
     ' .判断开始 (等于 (信息框 (“数据库丢失，是否导入备份数据库？”, 相加 (#询问图标, #是否钮), ), #否钮))
         ' .判断开始 (等于 (信息框 (“数据库丢失，是否导入新数据库？”, 相加 (#询问图标, #是否钮), ), #否钮))
             ' 结束 ()
        .默认
             ' .如果真 (等于 (写到文件 (相加 (取运行目录 (), “\CCM.mdb”), #CCM), 假))
                 ' 信息框 (“新数据库导出失败！”, #错误图标, )
                 ' 结束 ()
            .如果真结束
             ' 信息框 (“新数据库导入成功！”, 0, )
        .判断结束
         ' ' ----------------------------->用户导入备份数据库
    .默认
         ' 通用对话框1.过滤器 ＝ “CCM.mdb|CCM.mdb”
         ' .如果真 (等于 (打开 (), 假))
             ' 返回 ()
        .如果真结束
         ' .如果真 (等于 (复制文件 (.文件名, 相加 (取运行目录 (), “\CCM.mdb”)), 假))
             ' 信息框 (“备份数据库导入失败！”, #错误图标, )
             ' 返回 ()
        .如果真结束
         ' 信息框 (“备份数据库导入成功！”, 0, )
    .判断结束
     ' 返回 ()
.默认
    
.判断结束


.子程序 _超级按钮_登陆_被单击, 空白型, , 
.局部变量 局部_记录集句柄, 整数型, , , 

.如果真 (等于 (删首尾空 (.内容), “”))
    信息框 (“请输入用户名！”, #警告图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (删首尾空 (.内容), “”))
    信息框 (“请输入登陆密码！”, #警告图标, )
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (局部_记录集句柄, 相加 (“select * from User_Info where 用户姓名='”, .内容, “' and 用户密码='”, 未知支持库函数_2 (到字节集 (.内容)), “'”).查询 ())
.如果真 (等于 (局部_记录集句柄.读 (#UI_用户姓名), “”))
    信息框 (“用户名错误！”, #警告图标, )
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    赋值 (.内容, “”)
    局部_记录集句柄.关闭记录集 ()
    返回 ()
.如果真结束
.如果真 (等于 (局部_记录集句柄.读 (#UI_用户密码), “”))
    信息框 (“密码错误！”, #警告图标, )
    获取焦点 ()
    赋值 (.内容, “”)
    局部_记录集句柄.关闭记录集 ()
    返回 ()
.如果真结束
局部_记录集句柄.关闭记录集 ()
赋值 (全局_用户名, .内容)
赋值 (.内容, “”)
赋值 (.内容, “”)
子程序_变量初始化 ()
 ' 返回 ()
载入 (窗口_主界面, , 真)

.子程序 _超级按钮_退出_被单击, 空白型, , 
关闭 ()
结束 ()

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
关闭 ()

.子程序 _超级按钮_注册_被单击, 空白型, , 
.局部变量 局部_记录集句柄, 整数型, , , 
.局部变量 局部_配置项, 文本型, , , 
.局部变量 局部_注册项, 文本型, , , 

.如果真 (等于 (子程序_编辑框判断 (), 假))
    信息框 (“请按照要求填写注册名！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (子程序_编辑框特殊字符判断 (删首尾空 (.内容)), 假))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    信息框 (“不可输入特殊字符！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (子程序_编辑框判断 (), 假))
    信息框 (“请按照要求填写注册密码！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (子程序_编辑框特殊字符判断 (删首尾空 (.内容)), 假))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    信息框 (“不可输入特殊字符！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (不等于 (.内容, .内容))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    信息框 (“两次输入的密码不相同，请按照要求填写确认密码！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (.现行选中项, 0))
    信息框 (“请按选择问题密码！”, #警告图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (子程序_注册 (.内容, .内容, .取项目文本 (.现行选中项)), 假))
    信息框 (“注册失败，用户名重复！”, #警告图标, )
    获取焦点 ()
    连续赋值 (“”, .内容, .内容, .内容)
    赋值 (.现行选中项, 0)
    返回 ()
.如果真结束
信息框 (“注册成功，欢迎使用！”, 0, )
赋值 (局部_配置项, 子程序_解密 (读配置项 (#PZ_配置文件目录, “注册”, “注册码”, )))
赋值 (局部_注册项, 取文本注册项 (#现行用户, #ZC_注册码目录, ))
.如果 (不等于 (局部_配置项, 局部_注册项))
    赋值 (.内容, 读配置项 (#PZ_配置文件目录, “注册”, “注册码”, ))
    赋值 (局部_记录集句柄, “select count(*) from User_Info”.查询 ())
    .如果真 (等于 (局部_记录集句柄.读 (1), 1))
        信息框 (“试用版只能注册一位用户”, #警告图标, )
        赋值 (., 0)
        1.未知支持库函数_69 (真)
        2.未知支持库函数_69 (真)
        3.未知支持库函数_69 (真)
    .如果真结束
    
.否则
    4.未知支持库函数_69 (真)
.如果结束


子程序_变量初始化 ()

.子程序 子程序_编辑框判断, 逻辑型, , 编辑框内容判断
.参数 参数_编辑框, 编辑框, , 

.局部变量 局部_判断内容, 文本型, , , 

赋值 (局部_判断内容, 删首尾空 (参数_编辑框.内容))
.判断开始 (等于 (局部_判断内容, “”))
    参数_编辑框.获取焦点 ()
    返回 (假)
.判断 (或者 (小于 (取文本长度 (局部_判断内容), 6), 大于或等于 (取文本长度 (局部_判断内容), 20)))
    参数_编辑框.获取焦点 ()
    赋值 (参数_编辑框.被选择字符数, 取文本长度 (参数_编辑框.内容))
    返回 (假)
.默认
    
.判断结束
返回 (真)


.子程序 _超级按钮_注册返回_被单击, 空白型, , 
子程序_变量初始化 ()

.子程序 子程序_变量初始化, 空白型, , 
赋值 (., 0)
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
赋值 (.现行选中项, 0)
赋值 (.现行选中项, 0)

.子程序 子程序_注册, 逻辑型, , 
.参数 参数_注册名, 文本型, , 
.参数 参数_注册密码, 文本型, , 
.参数 参数_密码问题, 文本型, , 

.局部变量 局部_记录集句柄, 整数型, , , 

赋值 (局部_记录集句柄, 相加 (“select count(*) from User_Info where 用户姓名='”, 参数_注册名, “'”).查询 ())
.如果真 (不等于 (局部_记录集句柄.读 (1), 0))
    返回 (假)
.如果真结束
.如果真 (等于 (相加 (“insert into User_Info(用户姓名,用户密码,密码问题) values('”, 参数_注册名, “','”, 未知支持库函数_2 (到字节集 (参数_注册密码)), “','”, 参数_密码问题, “')”).执行 (), 假))
    返回 (假)
.如果真结束
返回 (真)


.子程序 _超级按钮_修改返回_被单击, 空白型, , 
子程序_变量初始化 ()

.子程序 _超级按钮_修改_被单击, 空白型, , 
.局部变量 局部_记录集句柄, 整数型, , , 

.如果真 (等于 (删首尾空 (.内容), “”))
    信息框 (“请输入用户名！”, #警告图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (子程序_编辑框特殊字符判断 (删首尾空 (.内容)), 假))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    信息框 (“不可输入特殊字符！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (删首尾空 (.内容), “”))
    信息框 (“请输入登陆密码！”, #警告图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (子程序_编辑框特殊字符判断 (删首尾空 (.内容)), 假))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    信息框 (“不可输入特殊字符！”, #警告图标, )
    返回 ()
.如果真结束

赋值 (局部_记录集句柄, 相加 (“select count(*) from User_Info where 用户姓名='”, .内容, “' and 用户密码='”, 未知支持库函数_2 (到字节集 (.内容)), “'”).查询 ())
.如果真 (不等于 (局部_记录集句柄.读 (1), 1))
    获取焦点 ()
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    局部_记录集句柄.关闭记录集 ()
    信息框 (“用户名或密码错误，请重新输入！”, #警告图标, )
    返回 ()
.如果真结束
局部_记录集句柄.关闭记录集 ()

.如果真 (等于 (子程序_编辑框判断 (), 假))
    信息框 (“请按照要求填写修改密码！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (子程序_编辑框特殊字符判断 (删首尾空 (.内容)), 假))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    信息框 (“不可输入特殊字符！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (不等于 (.内容, .内容))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    信息框 (“两次输入的密码不相同，请按照要求填写确认密码！”, #警告图标, )
    返回 ()
.如果真结束
调试输出 (相加 (“update User_Info set 用户密码='”, 未知支持库函数_2 (到字节集 (.内容)), “' where 用户姓名='”, .内容, “' and 用户密码='”, 未知支持库函数_2 (到字节集 (.内容)), “'”))

.如果真 (等于 (相加 (“update User_Info set 用户密码='”, 未知支持库函数_2 (到字节集 (.内容)), “' where 用户姓名='”, .内容, “' and 用户密码='”, 未知支持库函数_2 (到字节集 (.内容)), “'”).执行 (), 假))
    信息框 (“密码修改失败，请重新启动软件再试！”, #警告图标, )
    子程序_变量初始化 ()
    返回 ()
.如果真结束
信息框 (“密码修改成功，请牢记！”, #信息图标, )
子程序_变量初始化 ()


.子程序 _超级按钮_找回_被单击, 空白型, , 
.局部变量 局部_记录集句柄, 整数型, , , 

.如果真 (等于 (删首尾空 (.内容), “”))
    信息框 (“请输入用户名！”, #警告图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (子程序_编辑框特殊字符判断 (删首尾空 (.内容)), 假))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    信息框 (“不可输入特殊字符！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (.现行选中项, 0))
    信息框 (“请按选择问题密码！”, #警告图标, )
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (局部_记录集句柄, 相加 (“select count(*) from User_Info where 用户姓名='”, .内容, “' and 密码问题='”, .取项目文本 (.现行选中项), “'”).查询 ())
.如果真 (不等于 (局部_记录集句柄.读 (1), 1))
    获取焦点 ()
    赋值 (.内容, “”)
    赋值 (.现行选中项, 0)
    局部_记录集句柄.关闭记录集 ()
    信息框 (“用户名或密码错误，请重新输入！”, #警告图标, )
    返回 ()
.如果真结束
局部_记录集句柄.关闭记录集 ()
.如果真 (等于 (子程序_编辑框判断 (), 假))
    信息框 (“请按照要求填写修改密码！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (子程序_编辑框特殊字符判断 (删首尾空 (.内容)), 假))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    信息框 (“不可输入特殊字符！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (不等于 (.内容, .内容))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    信息框 (“两次输入的密码不相同，请按照要求填写确认密码！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (相加 (“update User_Info set 用户密码='”, 未知支持库函数_2 (到字节集 (.内容)), “' where 用户姓名='”, .内容, “' and 密码问题='”, .取项目文本 (.现行选中项), “'”).执行 (), 假))
    信息框 (“密码找回失败，请重新启动软件再试！”, #警告图标, )
    子程序_变量初始化 ()
    返回 ()
.如果真结束
信息框 (“密码找回成功，请牢记！”, #信息图标, )
子程序_变量初始化 ()


.子程序 _超级按钮_找回返回_被单击, 空白型, , 
子程序_变量初始化 ()

.子程序 _高级选择夹1_子夹被改变, 空白型, , 
.判断开始 (等于 (., 0))
    赋值 (., 1)
    赋值 (., 0)
    赋值 (., 0)
    赋值 (., 0)
.判断 (等于 (., 1))
    赋值 (., 0)
    赋值 (., 1)
    赋值 (., 0)
    赋值 (., 0)
.判断 (等于 (., 2))
    赋值 (., 0)
    赋值 (., 0)
    赋值 (., 1)
    赋值 (., 0)
.判断 (等于 (., 3))
    赋值 (., 0)
    赋值 (., 0)
    赋值 (., 0)
    赋值 (., 1)
.默认
    
.判断结束


.子程序 _超级按钮_注册软件_被单击, 空白型, , 
 ' .如果真 (等于 (删首尾空 (.内容), “”))
     ' 编辑框_注册码.获取焦点 ()
     ' 编辑框_注册码.被选择字符数 ＝ 取文本长度 (编辑框_注册码.内容)
     ' 信息框 (“请输入注册码！”, #警告图标, )
     ' 返回 ()
.如果真结束
 ' 写注册项 (#现行用户, #ZC_注册码目录, 编辑框_注册码.内容)
 ' .如果真 (等于 (取文本注册项 (#现行用户, #ZC_注册时间目录, ), 子程序_解密 (读配置项 (#PZ_配置文件目录, “注册”, “注册码”, ))))
     ' 信息框 (“注册码错误！”, #警告图标, )
     ' 写注册项 (#现行用户, #ZC_注册码目录, “”)
     ' 返回 ()
.如果真结束
 ' 信息框 (“注册成功，感谢使用！”, 0, )
 ' 编辑框_注册码.内容 ＝ “”
子程序_变量初始化 ()


.子程序 _超级按钮_返回软件_被单击, 空白型, , 
结束 ()


.子程序 _高级选择夹1_子夹头被单击, 空白型, , 
.参数 子夹索引, 整数型, , 

.如果真 (等于 (子夹索引, 4))
    赋值 (.内容, 读配置项 (#PZ_配置文件目录, “注册”, “注册码”, ))
.如果真结束


.子程序 _编辑框_机器码_获得焦点, 空白型, , 
调试输出 (取文本长度 (.内容))
赋值 (.被选择字符数, 取文本长度 (.内容))


.窗口程序集 主界面_程序集, , , 

.子程序 _备份数据库_被选择, 空白型, , 
赋值 (.类型, 1)
赋值 (.过滤器, “CCM|CCM”)
打开 ()
.如果真 (等于 (写到文件 (.文件名, 读入文件 (相加 (取运行目录 (), “\CCM”))), 真))
    信息框 (“数据库导出成功！”, #信息图标, )
    返回 ()
.如果真结束


.子程序 _窗口_主界面_创建完毕, 空白型, , 
.局部变量 局部_记录集句柄, 整数型, , , 
.局部变量 局部_计次, 整数型, , , 

赋值 (_启动窗口., 假)



赋值 (窗口_主界面., 相加 (“信用卡管理器――”, 全局_用户名, “的片卡信息”))
载入图片 (#BankNoLogo).画图片 (0, 0, 160, 30, )
载入图片 (#CardNoLogo).画图片 (0, 0, 210, 105, )
赋值 (.列表项目, {  })
“---请选择---”.加入项目 ()
赋值 (.现行选中项, 0)
赋值 (局部_记录集句柄, _启动窗口.查询 (., 相加 (“select * from Card_Info where 用户名='”, 全局_用户名, “'”)))
_启动窗口.到首记录 (., 局部_记录集句柄)
.判断循环首 (等于 (_启动窗口.尾记录后 (., 局部_记录集句柄), 假))
    _启动窗口.读 (., 局部_记录集句柄, “信用卡名称”).加入项目 (_启动窗口.读 (., 局部_记录集句柄, “id”))
    _启动窗口.到后一记录 (., 局部_记录集句柄)
    
.判断循环尾 ()
_启动窗口.关闭记录集 (., 局部_记录集句柄)
赋值 (局部_记录集句柄, _启动窗口.查询 (., 相加 (“select count(*) from Card_Info where 用户名='”, 全局_用户名, “'”)))
_启动窗口.到首记录 (., 局部_记录集句柄)
.如果真 (等于 (全局_用户版本, “未注册”))
    .如果 (小于 (_启动窗口.读 (., 局部_记录集句柄, 1), 1))
        连续赋值 (假, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
    .否则
        连续赋值 (真, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
    .如果结束
    
.如果真结束



子程序_高级表格初始化 ()
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .)
载入图片 (#CardNoLogo).画图片 (0, 0, 210, 105, )


.子程序 子程序_高级表格初始化, 空白型, , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_记录集句柄, 整数型, , , 
.局部变量 局部_文本, 文本型, , , 
.局部变量 局部_月, 整数型, , , 
.局部变量 局部_日, 整数型, , , 

未知支持库函数_57 ()

.计次循环首 (., 局部_计次)
    相减 (局部_计次, 1).未知支持库函数_36 ()
.计次循环尾 ()
.计次循环首 (., 局部_计次)
    相减 (局部_计次, 1).未知支持库函数_37 ()
.计次循环尾 ()
赋值 (., 8)
赋值 (., 相减 (相除 (., 8), 1))
赋值 (., 1)
赋值 (., 1)
0.未知支持库函数_9 (0, 1, “UID”)
0.未知支持库函数_9 (1, 1, “信用卡”)
0.未知支持库函数_9 (2, 1, “信用卡卡号”)
0.未知支持库函数_9 (3, 1, “所属银行”)
0.未知支持库函数_9 (4, 1, “到期还款日”)
0.未知支持库函数_9 (5, 1, “已透支金额”)
0.未知支持库函数_9 (6, 1, “本月剩余还款日”)
0.未知支持库函数_9 (7, 1, “可使用额度”)
 ' 高级表格1.置数据 (0, 8, 1, “UID”)
0.未知支持库函数_25 (0, ., ., 2)

赋值 (局部_记录集句柄, _启动窗口.查询 (., 相加 (“select count(*) from Card_Info where 用户名='”, 全局_用户名, “'”)))

赋值 (., 相加 (_启动窗口.读 (., 局部_记录集句柄, 1), 1))
_启动窗口.关闭记录集 (., 局部_记录集句柄)
赋值 (局部_计次, 0)
赋值 (局部_记录集句柄, _启动窗口.查询 (., 相加 (“select * from Card_Info where 用户名='”, 全局_用户名, “'”)))
赋值 (全局_计次, 相加 (全局_计次, 1))
_启动窗口.到首记录 (., 局部_记录集句柄)
.判断循环首 (等于 (_启动窗口.尾记录后 (., 局部_记录集句柄), 假))
    赋值 (局部_计次, 相加 (局部_计次, 1))
     ' 高级表格1.插入行 (到文本 (_启动窗口.外部数据库1.读 (局部_记录集句柄, “id”)), )
    局部_计次.未知支持库函数_9 (0, 1, 到文本 (_启动窗口.读 (., 局部_记录集句柄, “id”)))
    局部_计次.未知支持库函数_9 (1, 1, _启动窗口.读 (., 局部_记录集句柄, “信用卡名称”))
    局部_计次.未知支持库函数_9 (2, 1, _启动窗口.读 (., 局部_记录集句柄, “信用卡号”))
    局部_计次.未知支持库函数_9 (3, 1, _启动窗口.读 (., 局部_记录集句柄, “信用卡所属银行”))
    
    赋值 (局部_文本, _启动窗口.读 (., 局部_记录集句柄, “到期还款日”))
    
    .判断开始 (不等于 (寻找文本 (局部_文本, “天”, , 假), -1))
        赋值 (局部_文本, _启动窗口.读 (., 局部_记录集句柄, “账单日”))
        赋值 (局部_文本, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 到文本 (取月份 (取现行时间 ())), “月”, 局部_文本))
        赋值 (局部_文本, 子文本替换 (局部_文本, “号”, “日”, , , 真))
        
        
        赋值 (局部_日, 到数值 (取文本左边 (_启动窗口.读 (., 局部_记录集句柄, “到期还款日”), 相减 (取文本长度 (_启动窗口.读 (., 局部_记录集句柄, “到期还款日”)), 2))))
        赋值 (局部_文本, 到文本 (增减时间 (到时间 (局部_文本), #日, 局部_日)))
        局部_计次.未知支持库函数_9 (4, 1, 局部_文本)
        赋值 (局部_文本, 到文本 (取时间间隔 (到时间 (局部_文本), 取日期 (取现行时间 ()), #日)))
        局部_计次.未知支持库函数_9 (6, 1, 相加 (局部_文本, “ 天”))
        
        
        
        
    .判断 (不等于 (寻找文本 (局部_文本, “号”, , 假), -1))
        赋值 (局部_日, 取日 (取现行时间 ()))
        
        .如果 (大于 (到数值 (取文本左边 (局部_文本, 相减 (取文本长度 (局部_文本), 2))), 局部_日))
            赋值 (局部_月, 取月份 (取现行时间 ()))
        .否则
            赋值 (局部_月, 相加 (取月份 (取现行时间 ()), 1))
        .如果结束
        
        .如果 (大于 (局部_月, 12))
            赋值 (局部_文本, 相加 (到文本 (相加 (取年份 (取现行时间 ()), 1)), “年1月”, 局部_文本))
        .否则
            赋值 (局部_文本, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 到文本 (局部_月), “月”, 局部_文本))
        .如果结束
        
        赋值 (局部_文本, 子文本替换 (局部_文本, “号”, “日”, , , 真))
        
        局部_计次.未知支持库函数_9 (4, 1, 局部_文本)
        
        .如果 (大于 (到时间 (局部_文本), 取日期 (取现行时间 ())))
            赋值 (局部_文本, 到文本 (取时间间隔 (到时间 (局部_文本), 取日期 (取现行时间 ()), #日)))
        .否则
            赋值 (局部_文本, 到文本 (取时间间隔 (取日期 (取现行时间 ()), 到时间 (局部_文本), #日)))
        .如果结束
        
        局部_计次.未知支持库函数_9 (6, 1, 相加 (局部_文本, “ 天”))
        
    .默认
        
    .判断结束
    
     ' .如果 (不等于 (_启动窗口.读 (., 局部_记录集句柄, “信用卡所属银行”), “中国民生银行”))
         ' 局部_文本 ＝ _启动窗口.外部数据库1.读 (局部_记录集句柄, “到期还款日”)
         ' 局部_日 ＝ 取日 (取现行时间 ())
        
         ' .如果 (大于 (到数值 (取文本左边 (局部_文本, 相减 (取文本长度 (局部_文本), 2))), 局部_日))
             ' 局部_月 ＝ 取月份 (取现行时间 ())
        .否则
             ' 局部_月 ＝ 取月份 (取现行时间 ()) ＋ 1
        .如果结束
        
         ' .如果 (大于 (局部_月, 12))
             ' 局部_文本 ＝ 到文本 (取年份 (取现行时间 ()) ＋ 1) ＋ “年1月” ＋ 局部_文本
        .否则
             ' 局部_文本 ＝ 到文本 (取年份 (取现行时间 ())) ＋ “年” ＋ 到文本 (局部_月) ＋ “月” ＋ 局部_文本
        .如果结束
        
         ' 局部_文本 ＝ 子文本替换 (局部_文本, “号”, “日”, , , 真)
        
         ' 高级表格1.置数据 (局部_计次, 4, 1, 局部_文本)
        
         ' .如果 (大于 (到时间 (局部_文本), 取日期 (取现行时间 ())))
             ' 局部_文本 ＝ 到文本 (取时间间隔 (到时间 (局部_文本), 取日期 (取现行时间 ()), #日))
        .否则
             ' 局部_文本 ＝ 到文本 (取时间间隔 (取日期 (取现行时间 ()), 到时间 (局部_文本), #日))
        .如果结束
        
         ' 高级表格1.置数据 (局部_计次, 6, 1, 局部_文本 ＋ “ 天”)
        
    .否则
         ' 局部_文本 ＝ _启动窗口.外部数据库1.读 (局部_记录集句柄, “账单日”)
         ' 局部_文本 ＝ 到文本 (取年份 (取现行时间 ())) ＋ “年” ＋ 到文本 (取月份 (取现行时间 ())) ＋ “月” ＋ 局部_文本
         ' 局部_文本 ＝ 子文本替换 (局部_文本, “号”, “日”, , , 真)
         ' 局部_文本 ＝ 到文本 (增减时间 (到时间 (局部_文本), #日, 21))
         ' 高级表格1.置数据 (局部_计次, 4, 1, 局部_文本)
         ' 局部_文本 ＝ 到文本 (取时间间隔 (到时间 (局部_文本), 取日期 (取现行时间 ()), #日))
         ' 高级表格1.置数据 (局部_计次, 6, 1, 局部_文本 ＋ “ 天”)
        
    .如果结束
    
    
    
    
    
    .如果真 (小于或等于 (到数值 (局部_文本), 3))
        赋值 (全局_天数, 局部_文本)
    .如果真结束
    .如果 (等于 (_启动窗口.读 (., 局部_记录集句柄, “交易金额”), “”))
        局部_计次.未知支持库函数_9 (5, 1, “0 元”)
        局部_计次.未知支持库函数_9 (7, 1, 相加 (_启动窗口.读 (., 局部_记录集句柄, “已还金额”), “ 元”))
    .否则
        局部_计次.未知支持库函数_9 (5, 1, 相加 (_启动窗口.读 (., 局部_记录集句柄, “交易金额”), “ 元”))
        赋值 (局部_文本, 到文本 (相减 (到数值 (_启动窗口.读 (., 局部_记录集句柄, “已还金额”)), 到数值 (_启动窗口.读 (., 局部_记录集句柄, “交易金额”)))))
        局部_计次.未知支持库函数_9 (7, 1, 相加 (局部_文本, “ 元”))
    .如果结束
    赋值 (局部_文本, 局部_计次.未知支持库函数_10 (7))
    局部_计次.未知支持库函数_9 (8, 1, 到文本 (_启动窗口.读 (., 局部_记录集句柄, “id”)))
    
    
    赋值 (全局_透支, 相加 (_启动窗口.读 (., 局部_记录集句柄, “交易金额”), “ 元”))
    
    .如果真 (并且 (不等于 (全局_天数, “”), 等于 (全局_计次, 1), 不等于 (全局_透支, “ 元”)))
        赋值 (全局_银行名称, _启动窗口.读 (., 局部_记录集句柄, “信用卡所属银行”))
        赋值 (全局_卡号, _启动窗口.读 (., 局部_记录集句柄, “信用卡号”))
        赋值 (全局_卡名, _启动窗口.读 (., 局部_记录集句柄, “信用卡名称”))
        载入 (窗口_提醒, , 真)
    .如果真结束
    连续赋值 (“”, 全局_天数, 全局_透支, 全局_卡号, 全局_卡名, 全局_银行名称)
    
    _启动窗口.到后一记录 (., 局部_记录集句柄)
    
.判断循环尾 ()

1.未知支持库函数_22 (5, ., 6, #红色)
1.未知支持库函数_22 (7, ., 7, #蓝色)
1.未知支持库函数_20 (5, ., 7, 1)
1.未知支持库函数_53 (1, ., 8, 真)
 ' 高级表格1.置只读方式 (1, 6, 高级表格1.行数, 8, 真)

_启动窗口.关闭记录集 (., 局部_记录集句柄)













.子程序 _退出_被选择, 空白型, , 
结束 ()


.子程序 _窗口_主界面_可否被关闭, 逻辑型, , 
结束 ()

.子程序 _添加信用卡_被选择, 空白型, , 
.局部变量 局部_记录集句柄, 整数型, , , 

赋值 (全局_信用卡, 0)
载入 (窗口_信用卡管理, , 真)
赋值 (全局_信用卡, 100)
_窗口_主界面_创建完毕 ()
_启动窗口.关闭记录集 (., 局部_记录集句柄)
赋值 (局部_记录集句柄, _启动窗口.查询 (., 相加 (“select count(*) from Card_Info where 用户名='”, 全局_用户名, “'”)))
_启动窗口.到首记录 (., 局部_记录集句柄)
.如果真 (等于 (全局_用户版本, “未注册”))
    .如果 (小于 (_启动窗口.读 (., 局部_记录集句柄, 1), 1))
        连续赋值 (假, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
    .否则
        连续赋值 (真, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
    .如果结束
    
.如果真结束


.子程序 _添加银行_被选择, 空白型, , 
赋值 (全局_银行, 0)
载入 (窗口_银行管理, , 真)
赋值 (全局_银行, 100)

.子程序 _修改银行_被选择, 空白型, , 
赋值 (全局_银行, 1)
载入 (窗口_银行管理, , 真)
赋值 (全局_银行, 100)



.子程序 _删除银行_被选择, 空白型, , 
赋值 (全局_银行, 2)
载入 (窗口_银行管理, , 真)
赋值 (全局_银行, 100)



.子程序 _修改信用卡_被选择, 空白型, , 
赋值 (全局_信用卡, 1)
载入 (窗口_信用卡管理, , 真)
赋值 (全局_信用卡, 100)
_窗口_主界面_创建完毕 ()


.子程序 _删除信用卡_被选择, 空白型, , 
赋值 (全局_信用卡, 2)
载入 (窗口_信用卡管理, , 真)
赋值 (全局_信用卡, 100)
_窗口_主界面_创建完毕 ()


.子程序 _组合框1_列表项被选择, 空白型, , 
.局部变量 局部_记录集句柄, 整数型, , , 
.局部变量 局部_文本, 文本型, , , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_文本2, 文本型, , , 

.如果真 (不等于 (.现行选中项, 0))
    赋值 (全局_id, 到文本 (.取项目数值 (.现行选中项)))
.如果真结束
赋值 (局部_记录集句柄, _启动窗口.查询 (., 相加 (“select * from Card_Info where id=”, 全局_id, “ and 用户名='”, 全局_用户名, “'”)))

_启动窗口.到首记录 (., 局部_记录集句柄)
赋值 (.内容, _启动窗口.读 (., 局部_记录集句柄, “信用卡号”))
赋值 (全局_查询密码, 子程序_加密 (_启动窗口.读 (., 局部_记录集句柄, “查询密码”)))
赋值 (全局_取款密码, 子程序_加密 (_启动窗口.读 (., 局部_记录集句柄, “取款密码”)))
赋值 (.内容, _启动窗口.读 (., 局部_记录集句柄, “已还金额”))
赋值 (.内容, 相加 (到文本 (取月份 (取现行时间 ())), “月”, _启动窗口.读 (., 局部_记录集句柄, “账单日”)))
赋值 (局部_文本, _启动窗口.读 (., 局部_记录集句柄, “到期还款日”))
.如果 (小于 (取月份 (取现行时间 ()), 12))
    
    .判断开始 (不等于 (寻找文本 (局部_文本, “天”, , 假), -1))
        赋值 (局部_文本2, .内容)
        赋值 (局部_文本2, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 局部_文本2))
        赋值 (局部_文本2, 子文本替换 (局部_文本2, “号”, “日”, , , 真))
        赋值 (局部_文本2, 到文本 (增减时间 (到时间 (局部_文本2), #月份, 1)))
        
        赋值 (局部_文本, 取文本左边 (局部_文本, 相减 (取文本长度 (局部_文本), 2)))
        赋值 (局部_文本, 到文本 (增减时间 (到时间 (局部_文本2), #日, 到数值 (局部_文本))))
        
        赋值 (.内容, 局部_文本)
        
        
    .判断 (不等于 (寻找文本 (局部_文本, “号”, , 假), -1))
        赋值 (.内容, 相加 (到文本 (相加 (取月份 (取现行时间 ()), 1)), “月”, _启动窗口.读 (., 局部_记录集句柄, “到期还款日”)))
    .默认
        
    .判断结束
    
    
    
.否则
    .判断开始 (不等于 (寻找文本 (局部_文本, “天”, , 假), -1))
        赋值 (局部_文本2, .内容)
        赋值 (局部_文本2, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 局部_文本2))
        赋值 (局部_文本2, 子文本替换 (局部_文本2, “号”, “日”, , , 真))
        赋值 (局部_文本2, 到文本 (增减时间 (到时间 (局部_文本2), #月份, 1)))
        
        赋值 (局部_文本, 取文本左边 (局部_文本, 相减 (取文本长度 (局部_文本), 2)))
        赋值 (局部_文本, 到文本 (增减时间 (到时间 (局部_文本2), #日, 到数值 (局部_文本))))
        赋值 (.内容, 局部_文本)
        
    .判断 (不等于 (寻找文本 (局部_文本, “号”, , 假), -1))
        赋值 (.内容, 相加 (“1月”, _启动窗口.读 (., 局部_记录集句柄, “到期还款日”), “--”, 到文本 (相加 (取年份 (取现行时间 ()), 1)), “年”))
    .默认
        
    .判断结束
    
    
    
.如果结束


赋值 (局部_文本, _启动窗口.读 (., 局部_记录集句柄, “类别”))

载入图片 (到字节集 (_启动窗口.读 (., 局部_记录集句柄, “信用卡外观”))).画图片 (0, 0, 210, 105, )
赋值 (.内容, _启动窗口.读 (., 局部_记录集句柄, “信用卡所属银行”))
_启动窗口.关闭记录集 (., 局部_记录集句柄)

赋值 (局部_记录集句柄, _启动窗口.查询 (., 相加 (“select * from Bank_Info where 银行名称='”, .内容, “'”)))
_启动窗口.到首记录 (., 局部_记录集句柄)
载入图片 (_启动窗口.读 (., 局部_记录集句柄, “银行标志”)).画图片 (0, 0, 160, 30, )
赋值 (., _启动窗口.读 (., 局部_记录集句柄, “银行网站”))
_启动窗口.关闭记录集 (., 局部_记录集句柄)


赋值 (局部_记录集句柄, _启动窗口.查询 (., 相加 (“select * from Sort_Info where 类别名称='”, 局部_文本, “'”)))
_启动窗口.到首记录 (., 局部_记录集句柄)
赋值 (.内容, 相加 (局部_文本, “(”, _启动窗口.读 (., 局部_记录集句柄, “别名”), “)”))
_启动窗口.关闭记录集 (., 局部_记录集句柄)
赋值 (.内容, “**********”)
赋值 (.内容, “**********”)

赋值 (局部_文本, 到文本 (.取项目数值 (.现行选中项)))
.计次循环首 (., 局部_计次)
    .如果真 (等于 (到文本 (局部_计次.未知支持库函数_10 (0)), 局部_文本))
        局部_计次.未知支持库函数_0 (1)
        局部_计次.未知支持库函数_1 (1, 局部_计次, 8)
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()


.子程序 _超级按钮_连接IE_被单击, 空白型, , 
.如果真 (不等于 (., “”))
    未知支持库函数_56 (.)
.如果真结束


.子程序 子程序_加密, 文本型, , 
.参数 参数_加密内容, 文本型, , 

.局部变量 局部_参数, 文本型, , , 
.局部变量 局部_字节集, 字节集, , , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_位置, 整数型, , , 
.局部变量 局部_形成字节集, 字节集, , , 

.计次循环首 (取文本长度 (参数_加密内容), 局部_计次)
    赋值 (局部_位置, 相加 (局部_位置, 1))
    .如果 (小于 (取代码 (参数_加密内容, 局部_位置), 0))
        赋值 (局部_参数, 相加 (局部_参数, 取文本中间 (参数_加密内容, 局部_位置, 2), “ ”))
        赋值 (局部_位置, 相加 (局部_位置, 1))
    .否则
        赋值 (局部_参数, 相加 (局部_参数, 取文本中间 (参数_加密内容, 局部_位置, 1), “ ”))
    .如果结束
    
.计次循环尾 ()
赋值 (局部_参数, 取文本左边 (局部_参数, 相减 (取文本长度 (局部_参数), 1)))
赋值 (局部_字节集, 到字节集 (局部_参数))
.计次循环首 (取字节集长度 (局部_字节集), 局部_计次)
     ' ----=> 汉字 加密
    赋值 (局部_位置, 局部_计次)
    .如果 (并且 (大于或等于 (取字节集数据 (局部_字节集, 1, 局部_位置), 161), 小于或等于 (取字节集数据 (局部_字节集, 1, 局部_位置), 255)))
        赋值 (局部_位置, 局部_计次)
        .如果真 (并且 (大于或等于 (取字节集数据 (局部_字节集, 1, 相加 (局部_位置, 1)), 161), 小于或等于 (取字节集数据 (局部_字节集, 1, 相加 (局部_位置, 1)), 255)))
            赋值 (局部_形成字节集, 相加 (局部_形成字节集, 到字节集 (到字节 (位异或 (局部_字节集 [局部_计次], 134))), 到字节集 (到字节 (位异或 (局部_字节集 [相加 (局部_计次, 1)], 134)))))
        .如果真结束
        
    .否则
         ' ----=> 字母 加密
        赋值 (局部_位置, 局部_计次)
        .如果真 (不等于 (取字节集中间 (局部_字节集, 局部_位置, 1), { 32 }))
            赋值 (局部_形成字节集, 相加 (局部_形成字节集, 到字节集 (到字节 (位异或 (局部_字节集 [局部_计次], 134))), 到字节集 (到字节 (位异或 (0, 134)))))
        .如果真结束
        
    .如果结束
    
.计次循环尾 ()
返回 (到文本 (局部_形成字节集))


.子程序 子程序_解密, 文本型, , 
.参数 参数_解密内容, 文本型, , 

.局部变量 局部_字节集, 字节集, , , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_还原, 字节集, , , 

赋值 (局部_字节集, 到字节集 (参数_解密内容))
.变量循环首 (1, 取字节集长度 (局部_字节集), 2, 局部_计次)
    赋值 (局部_还原, 相加 (局部_还原, 到字节集 (到字节 (位异或 (局部_字节集 [局部_计次], 134))), 到字节集 (到字节 (位异或 (局部_字节集 [相加 (局部_计次, 1)], 134)))))
.变量循环尾 ()
赋值 (局部_字节集, {  })
赋值 (局部_字节集, 子字节集替换 (局部_还原, { 0 }, {  }, , ))
返回 (到文本 (局部_字节集))


.子程序 _编辑框_查询密码_获得焦点, 空白型, , 

赋值 (.内容, 子程序_解密 (全局_查询密码))


.子程序 _编辑框_查询密码_失去焦点, 空白型, , 

赋值 (.内容, “**********”)


.子程序 _编辑框_取款密码_获得焦点, 空白型, , 
赋值 (.内容, 子程序_解密 (全局_取款密码))


.子程序 _编辑框_取款密码_失去焦点, 空白型, , 
赋值 (.内容, “**********”)


.子程序 _高级表格1_光标位置改变, 空白型, , 
.局部变量 局部_uid, 文本型, , , 
.局部变量 局部_计次, 整数型, , , 

赋值 (局部_uid, 未知支持库函数_3 ().未知支持库函数_10 (0))
.如果真 (不等于 (局部_uid, “”))
    .计次循环首 (取项目数 (), 局部_计次)
        .如果真 (等于 (相减 (局部_计次, 1).取项目数值 (), 到数值 (局部_uid)))
            赋值 (.现行选中项, 相减 (局部_计次, 1))
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
    
.如果真结束
_组合框1_列表项被选择 ()

.子程序 _高级表格1_将被编辑, 空白型, , 
赋值 (全局_uid, 到数值 (未知支持库函数_3 ().未知支持库函数_10 (0)))
.如果真 (等于 (全局_uid, 0))
    返回 ()
.如果真结束

_修改信用卡_被选择 ()


.子程序 _窗口_主界面_尺寸被改变, 空白型, , 
赋值 (.宽度, 窗口_主界面.)
赋值 (.宽度, 窗口_主界面.)
赋值 (., 相减 (窗口_主界面., 10))
赋值 (., 相减 (窗口_主界面., .))
赋值 (., 相减 (相除 (., 8), 1))

.子程序 _切换用户_被选择, 空白型, , 
窗口_主界面.销毁 ()
赋值 (_启动窗口., 真)
连续赋值 (“”, 全局_天数, 全局_透支, 全局_卡号, 全局_卡名, 全局_银行名称)
赋值 (全局_计次, 0)


.窗口程序集 信用卡_程序集, , , 

.程序集变量 程序集_信用卡, 文本型, , , 
.子程序 _窗口_信用卡管理_创建完毕, 空白型, , 
.局部变量 局部_计次, 整数型, , , 

赋值 (.现行子夹, 全局_信用卡)
.判断开始 (等于 (全局_信用卡, 0))
    子程序_添加信用卡 ()
    
.判断 (等于 (全局_信用卡, 1))
    子程序_修改信用卡 ()
    .如果真 (不等于 (全局_uid, 0))
        .计次循环首 (取项目数 (), 局部_计次)
            .如果真 (等于 (相减 (局部_计次, 1).取项目数值 (), 全局_uid))
                赋值 (.现行选中项, 相减 (局部_计次, 1))
                跳出循环 ()
            .如果真结束
            
        .计次循环尾 ()
        _组合框_信用卡_列表项被选择 ()
    .如果真结束
    
.判断 (等于 (全局_信用卡, 2))
    子程序_删除信用卡 ()
.默认
    
.判断结束


.子程序 子程序_删除信用卡, 空白型, , 
.局部变量 局部_记录集句柄, 整数型, , , 

赋值 (窗口_信用卡管理., “信用卡管理器――删除信用卡”)
赋值 (.列表项目, {  })
“---请选择---”.加入项目 ()
赋值 (.现行选中项, 0)
赋值 (局部_记录集句柄, _启动窗口.查询 (., 相加 (“select * from Card_Info where 用户名='”, 全局_用户名, “'”)))
_启动窗口.到首记录 (., 局部_记录集句柄)
.判断循环首 (等于 (_启动窗口.尾记录后 (., 局部_记录集句柄), 假))
    _启动窗口.读 (., 局部_记录集句柄, “信用卡名称”).加入项目 (_启动窗口.读 (., 局部_记录集句柄, “id”))
    _启动窗口.到后一记录 (., 局部_记录集句柄)
.判断循环尾 ()
_启动窗口.关闭记录集 (., 局部_记录集句柄)



.子程序 子程序_修改信用卡, 空白型, , 
.局部变量 局部_记录集句柄, 整数型, , , 
.局部变量 局部_类别名称, 文本型, , , 
.局部变量 局部_别名, 文本型, , , 

赋值 (窗口_信用卡管理., “信用卡管理器――修改信用卡”)
赋值 (.列表项目, {  })
赋值 (.现行选中项, 0)
赋值 (局部_记录集句柄, _启动窗口.查询 (., “select 银行名称 from Bank_Info”))
_启动窗口.到首记录 (., 局部_记录集句柄)
.判断循环首 (等于 (_启动窗口.尾记录后 (., 局部_记录集句柄), 假))
    _启动窗口.读 (., 局部_记录集句柄, “银行名称”).加入项目 ()
    _启动窗口.到后一记录 (., 局部_记录集句柄)
.判断循环尾 ()
_启动窗口.关闭记录集 (., 局部_记录集句柄)

赋值 (.列表项目, {  })
赋值 (.现行选中项, 0)
赋值 (.列表项目, {  })
赋值 (.现行选中项, 0)
.计次循环首 (30, 局部_记录集句柄)
    相加 (“每月：”, 到文本 (局部_记录集句柄), “号”).加入项目 ()
    相加 (“次月：”, 到文本 (局部_记录集句柄), “号”).加入项目 ()
.计次循环尾 ()

载入图片 (#BankNoLogo).画图片 (0, 0, 160, 30, )
载入图片 (#CardNoLogo).画图片 (0, 0, 210, 105, )
赋值 (.列表项目, {  })
“---请选择---”.加入项目 ()
赋值 (.现行选中项, 0)
赋值 (局部_记录集句柄, _启动窗口.查询 (., 相加 (“select * from Card_Info where 用户名='”, 全局_用户名, “'”)))
_启动窗口.到首记录 (., 局部_记录集句柄)
.判断循环首 (等于 (_启动窗口.尾记录后 (., 局部_记录集句柄), 假))
    _启动窗口.读 (., 局部_记录集句柄, “信用卡名称”).加入项目 (_启动窗口.读 (., 局部_记录集句柄, “id”))
    _启动窗口.到后一记录 (., 局部_记录集句柄)
.判断循环尾 ()
_启动窗口.关闭记录集 (., 局部_记录集句柄)

赋值 (.列表项目, {  })
赋值 (.现行选中项, 0)
赋值 (局部_记录集句柄, _启动窗口.查询 (., “select * from Sort_Info”))
_启动窗口.到首记录 (., 局部_记录集句柄)
.判断循环首 (等于 (_启动窗口.尾记录后 (., 局部_记录集句柄), 假))
    赋值 (局部_类别名称, _启动窗口.读 (., 局部_记录集句柄, “类别名称”))
    赋值 (局部_别名, _启动窗口.读 (., 局部_记录集句柄, “别名”))
    相加 (局部_类别名称, “(”, 局部_别名, “)”).加入项目 ()
    _启动窗口.到后一记录 (., 局部_记录集句柄)
.判断循环尾 ()




.子程序 子程序_添加信用卡, 空白型, , 
.局部变量 局部_记录集句柄, 整数型, , , 
.局部变量 局部_类别名称, 文本型, , , 
.局部变量 局部_别名, 文本型, , , 

赋值 (窗口_信用卡管理., “信用卡管理器――添加信用卡”)
赋值 (.列表项目, {  })
“---请选择---”.加入项目 ()
赋值 (.现行选中项, 0)
赋值 (局部_记录集句柄, _启动窗口.查询 (., “select 银行名称 from Bank_Info”))
_启动窗口.到首记录 (., 局部_记录集句柄)
.判断循环首 (等于 (_启动窗口.尾记录后 (., 局部_记录集句柄), 假))
    _启动窗口.读 (., 局部_记录集句柄, “银行名称”).加入项目 ()
    _启动窗口.到后一记录 (., 局部_记录集句柄)
.判断循环尾 ()
_启动窗口.关闭记录集 (., 局部_记录集句柄)
赋值 (.列表项目, {  })
“请选择”.加入项目 ()
赋值 (.现行选中项, 0)
赋值 (.列表项目, {  })
“请选择”.加入项目 ()
赋值 (.现行选中项, 0)
.计次循环首 (31, 局部_记录集句柄)
    相加 (“每月：”, 到文本 (局部_记录集句柄), “号”).加入项目 ()
    相加 (“次月：”, 到文本 (局部_记录集句柄), “号”).加入项目 ()
.计次循环尾 ()
载入图片 (#CardNoLogo).画图片 (0, 0, 210, 105, )
赋值 (.列表项目, {  })
“---请选择---”.加入项目 ()
赋值 (.现行选中项, 0)
赋值 (局部_记录集句柄, _启动窗口.查询 (., “select * from Sort_Info”))
_启动窗口.到首记录 (., 局部_记录集句柄)
.判断循环首 (等于 (_启动窗口.尾记录后 (., 局部_记录集句柄), 假))
    赋值 (局部_类别名称, _启动窗口.读 (., 局部_记录集句柄, “类别名称”))
    赋值 (局部_别名, _启动窗口.读 (., 局部_记录集句柄, “别名”))
    相加 (局部_类别名称, “(”, 局部_别名, “)”).加入项目 ()
    _启动窗口.到后一记录 (., 局部_记录集句柄)
.判断循环尾 ()



.子程序 _组合框1_列表项被选择, 空白型, , 
.局部变量 局部_银行名, 文本型, , , 
.局部变量 局部_标志, 字节集, , , 
.局部变量 局部_记录集句柄, 整数型, , , 

赋值 (局部_银行名, .取项目文本 (.现行选中项))
赋值 (局部_记录集句柄, _启动窗口.查询 (., 相加 (“select * from Bank_Info where 银行名称='”, 局部_银行名, “'”)))
_启动窗口.到首记录 (., 局部_记录集句柄)
赋值 (局部_标志, 到字节集 (_启动窗口.读 (., 局部_记录集句柄, “银行标志”)))
载入图片 (局部_标志).画图片 (0, 0, .宽度, .高度, )

赋值 (局部_标志, {  })
赋值 (局部_标志, 到字节集 (_启动窗口.读 (., 局部_记录集句柄, “信用卡标志”)))
载入图片 (局部_标志).画图片 (0, 0, .宽度, .高度, )
_启动窗口.关闭记录集 (., 局部_记录集句柄)

 ' .如果 (等于 (.取项目文本 (.现行选中项), “中国民生银行”))
     ' 组合框_到期日.禁止 ＝ 真
     ' 信息框 (“你将无法选择中国民生银行的到期还款日，” ＋ #换行符 ＋ “中国民生银行的到期还款日是账单日次日的后20天，” ＋ #换行符 ＋ “软件将自动给您换算！”, #警告图标, )
.否则
     ' 组合框_到期日.禁止 ＝ 假
.如果结束



.子程序 _超级按钮_添加_被单击, 空白型, , 
.局部变量 局部_记录集局部, 整数型, , , 
.局部变量 局部_类别, 文本型, , , 
.局部变量 局部_账单日, 文本型, , , 
.局部变量 局部_到期日, 文本型, , , 

.判断开始 (等于 (.现行选中项, 0))
    信息框 (“请选择信用卡所属银行！”, #警告图标, )
    获取焦点 ()
    返回 ()
.判断 (等于 (删首尾空 (.内容), “”))
    信息框 (“请输入信用卡名称！”, #警告图标, )
    获取焦点 ()
    返回 ()
.判断 (不等于 (取文本长度 (删首尾空 (.内容)), 4))
    信息框 (“请输入信用卡名后4位卡号！”, #警告图标, )
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    返回 ()
.判断 (不等于 (取文本长度 (删首尾空 (.内容)), 4))
    信息框 (“请输入信用卡名后4位卡号！”, #警告图标, )
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    返回 ()
.判断 (等于 (子程序_整数判断 (删首尾空 (.内容)), 假))
    信息框 (“请输入整数的银行卡号！”, #警告图标, )
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    返回 ()
.判断 (等于 (删首尾空 (.内容), “”))
    赋值 (.内容, “0”)
.判断 (等于 (子程序_数值判断 (删首尾空 (.内容)), 假))
    信息框 (“请输入数值型的透支金额，最大金额为9999999.99！”, #警告图标, )
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    返回 ()
.判断 (等于 (.现行选中项, 0))
    信息框 (“请选择信用卡的类型！”, #警告图标, )
    返回 ()
.默认
    
.判断结束
.判断开始 (等于 (删首尾空 (.内容), “”))
    赋值 (.内容, “ ”)
.判断 (等于 (删首尾空 (.内容), “”))
    赋值 (.内容, “ ”)
.默认
    
.判断结束
.如果真 (等于 (子程序_编辑框特殊字符判断 (删首尾空 (.内容)), 假))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    信息框 (“不可输入特殊字符！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (子程序_编辑框特殊字符判断 (删首尾空 (.内容)), 假))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    信息框 (“不可输入特殊字符！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (子程序_编辑框特殊字符判断 (删首尾空 (.内容)), 假))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    信息框 (“不可输入特殊字符！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (并且 (等于 (.选中, 假), 等于 (.选中, 假)))
    信息框 (“请选择你的到期还款日类型！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (.现行选中项, 0))
    信息框 (“请选择账单日！”, #警告图标, )
    返回 ()
.如果真结束

.判断开始 (并且 (大于 (.现行选中项, 0), 小于 (.现行选中项, 10)))
    赋值 (局部_账单日, 取文本右边 (.取项目文本 (.现行选中项), 3))
.默认
    赋值 (局部_账单日, 取文本右边 (.取项目文本 (.现行选中项), 4))
.判断结束


赋值 (局部_类别, .取项目文本 (.现行选中项))
赋值 (局部_类别, 取文本左边 (局部_类别, 相减 (寻找文本 (局部_类别, “(”, , 假), 1)))


.如果真 (等于 (.选中, 真))
    .如果真 (等于 (.现行选中项, 0))
        信息框 (“请选择到期还款日！”, #警告图标, )
        返回 ()
    .如果真结束
    
    .判断开始 (并且 (大于 (.现行选中项, 0), 小于 (.现行选中项, 10)))
        赋值 (局部_到期日, 取文本右边 (.取项目文本 (.现行选中项), 3))
    .默认
        赋值 (局部_到期日, 取文本右边 (.取项目文本 (.现行选中项), 4))
    .判断结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果真 (或者 (等于 (子程序_整数判断 (.内容), 假), 等于 (删首尾空 (.内容), “”)))
        获取焦点 ()
        赋值 (.被选择字符数, 取文本长度 (.内容))
        信息框 (“请输入整数的还款天数！”, #警告图标, )
        返回 ()
    .如果真结束
    赋值 (局部_到期日, 相加 (.内容, “天”))
.如果真结束





赋值 (局部_记录集局部, _启动窗口.查询 (., 相加 (“select count(*) from Card_Info where 用户名='”, 全局_用户名, “' and 信用卡号='”, 删首尾空 (.内容), “' and 信用卡所属银行='”, .取项目文本 (.现行选中项), “' and 信用卡名称='”, 删首尾空 (.内容), “'”)))

.如果真 (不等于 (_启动窗口.读 (., 局部_记录集局部, 1), 0))
    信息框 (相加 (“卡号为：”, 删首尾空 (.内容), #换行符, “信用卡名称为：”, 删首尾空 (.内容), #换行符, “的卡片信息已经存在！”), #警告图标, )
    返回 ()
.如果真结束

.如果真 (等于 (_启动窗口.执行 (., 相加 (“insert into Card_Info(信用卡号,信用卡名称,用户名,信用卡所属银行,类别,信用卡外观,账单日,到期还款日,查询密码,取款密码,已还金额) values('”, 删首尾空 (.内容), “','”, 删首尾空 (.内容), “','”, 全局_用户名, “','”, .取项目文本 (.现行选中项), “','”, 局部_类别, “', ?, '”, 局部_账单日, “','”, 局部_到期日, “','”, .内容, “','”, .内容, “','”, .内容, “')”), 210.取图片 (105)), 假))
    信息框 (“信用卡添加失败！”, #警告图标, )
    返回 ()
.如果真结束
信息框 (“信用卡添加成功！”, #信息图标, )
窗口_信用卡管理.销毁 ()



.子程序 子程序_整数判断, 逻辑型, , 
.参数 参数_判断数, 文本型, , 

.局部变量 局部_计次, 整数型, , , 

.计次循环首 (取文本长度 (参数_判断数), 局部_计次)
    .如果真 (或者 (小于 (取代码 (取文本中间 (参数_判断数, 局部_计次, 1), ), 48), 大于 (取代码 (取文本中间 (参数_判断数, 局部_计次, 1), ), 57)))
        返回 (假)
    .如果真结束
    
.计次循环尾 ()
返回 (真)

.子程序 子程序_数值判断, 逻辑型, , 
.参数 参数_判断数, 文本型, , 

.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_数组, 文本型, , "0", 

.如果真 (大于 (取文本长度 (参数_判断数), 10))
    返回 (假)
.如果真结束
赋值 (局部_数组, 分割文本 (参数_判断数, “.”, ))
.如果真 (等于 (取文本左边 (参数_判断数, 1), “.”))
    返回 (假)
.如果真结束
.如果真 (等于 (取文本右边 (参数_判断数, 1), “.”))
    返回 (假)
.如果真结束
.如果真 (大于 (取数组成员数 (局部_数组), 2))
    返回 (假)
.如果真结束
.判断开始 (等于 (取数组成员数 (局部_数组), 1))
    .计次循环首 (取文本长度 (局部_数组 [1]), 局部_计次)
        .如果真 (或者 (小于 (取代码 (取文本中间 (局部_数组 [1], 局部_计次, 1), ), 48), 大于 (取代码 (取文本中间 (局部_数组 [1], 局部_计次, 1), ), 57)))
            返回 (假)
        .如果真结束
        
    .计次循环尾 ()
    
.默认
    .计次循环首 (取文本长度 (局部_数组 [1]), 局部_计次)
        .如果真 (或者 (小于 (取代码 (取文本中间 (局部_数组 [1], 局部_计次, 1), ), 48), 大于 (取代码 (取文本中间 (局部_数组 [1], 局部_计次, 1), ), 57)))
            返回 (假)
        .如果真结束
        
    .计次循环尾 ()
    .如果真 (大于 (取文本长度 (局部_数组 [2]), 2))
        返回 (假)
    .如果真结束
    .计次循环首 (取文本长度 (局部_数组 [2]), 局部_计次)
        .如果真 (或者 (小于 (取代码 (取文本中间 (局部_数组 [2], 局部_计次, 1), ), 48), 大于 (取代码 (取文本中间 (局部_数组 [2], 局部_计次, 1), ), 57)))
            返回 (假)
        .如果真结束
        
    .计次循环尾 ()
    
.判断结束
返回 (真)

.子程序 _画板_信用卡_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.过滤器, “图片文件|*.jpg;*.bmp;*.gif”)
打开 ()
载入图片 (读入文件 (.文件名)).画图片 (0, 0, .宽度, .高度, )


.子程序 _画板_信用卡_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

相加 (窗口_信用卡管理., .左边, .左边, 相除 (.宽度, 2)).未知支持库函数_26 (相加 (窗口_信用卡管理., .顶边, .顶边, 相除 (.高度, 2)), “鼠标左键单击此处添加图片”, -1, )


.子程序 _超级按钮_注册返回_被单击, 空白型, , 
窗口_信用卡管理.销毁 ()


.子程序 _编辑框_卡号_获得焦点, 空白型, , 
相加 (窗口_信用卡管理., .左边, .左边, 20).未知支持库函数_26 (相加 (窗口_信用卡管理., .顶边, .顶边, 30), “请输入卡号的后四位”, -1, )


.子程序 _编辑框_修改卡号_获得焦点, 空白型, , 
相加 (窗口_信用卡管理., .左边, .左边, 20).未知支持库函数_26 (相加 (窗口_信用卡管理., .顶边, .顶边, 30), “请输入卡号的后四位”, -1, )

.子程序 _组合框_信用卡_列表项被选择, 空白型, , 
.局部变量 局部_记录集句柄, 整数型, , , 
.局部变量 局部_文本, 文本型, , , 
.局部变量 局部_计次, 整数型, , , 


.如果真 (不等于 (.现行选中项, 0))
    赋值 (全局_id, 到文本 (.取项目数值 (.现行选中项)))
.如果真结束
赋值 (程序集_信用卡, .取项目文本 (.现行选中项))
赋值 (局部_记录集句柄, _启动窗口.查询 (., 相加 (“select * from Card_Info where id=”, 全局_id, “ and 用户名='”, 全局_用户名, “'”)))

_启动窗口.到首记录 (., 局部_记录集句柄)
赋值 (.内容, _启动窗口.读 (., 局部_记录集句柄, “信用卡号”))
赋值 (.内容, _启动窗口.读 (., 局部_记录集句柄, “查询密码”))
赋值 (.内容, _启动窗口.读 (., 局部_记录集句柄, “取款密码”))
赋值 (.内容, _启动窗口.读 (., 局部_记录集句柄, “已还金额”))
赋值 (.内容, _启动窗口.读 (., 局部_记录集句柄, “交易金额”))

赋值 (局部_文本, _启动窗口.读 (., 局部_记录集句柄, “账单日”))
.判断开始 (等于 (取文本长度 (局部_文本), 3))
    赋值 (局部_文本, 取文本左边 (局部_文本, 1))
    赋值 (.现行选中项, 相减 (到数值 (局部_文本), 1))
.判断 (等于 (取文本长度 (局部_文本), 4))
    赋值 (局部_文本, 取文本左边 (局部_文本, 2))
    赋值 (.现行选中项, 相减 (到数值 (局部_文本), 1))
.默认
    信息框 (“账单日读取失败！”, #警告图标, )
    返回 ()
.判断结束

赋值 (局部_文本, _启动窗口.读 (., 局部_记录集句柄, “到期还款日”))

.判断开始 (不等于 (寻找文本 (局部_文本, “天”, , 假), -1))
    赋值 (.选中, 假)
    赋值 (.选中, 真)
    赋值 (.可视, 假)
    连续赋值 (真, .可视, .可视)
     ' 赋值 (局部_文本, 取文本左边 (局部_文本, 相减 (取文本长度 (局部_文本), 2)))
    赋值 (.内容, 局部_文本)
    
    
    
.判断 (不等于 (寻找文本 (局部_文本, “号”, , 假), -1))
    赋值 (.选中, 真)
    赋值 (.选中, 假)
    赋值 (.可视, 真)
    连续赋值 (假, .可视, .可视)
    
    .判断开始 (等于 (取文本长度 (局部_文本), 3))
        赋值 (局部_文本, 取文本左边 (局部_文本, 1))
        赋值 (.现行选中项, 相减 (到数值 (局部_文本), 1))
    .判断 (等于 (取文本长度 (局部_文本), 4))
        赋值 (局部_文本, 取文本左边 (局部_文本, 2))
        赋值 (.现行选中项, 相减 (到数值 (局部_文本), 1))
    .默认
        信息框 (“到期还款日读取失败！”, #警告图标, )
        返回 ()
    .判断结束
    
.默认
    
.判断结束



赋值 (局部_文本, _启动窗口.读 (., 局部_记录集句柄, “类别”))
.计次循环首 (取项目数 (), 局部_计次)
    .如果真 (近似等于 (相减 (局部_计次, 1).取项目文本 (), 局部_文本))
        赋值 (.现行选中项, 相减 (局部_计次, 1))
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()

载入图片 (到字节集 (_启动窗口.读 (., 局部_记录集句柄, “信用卡外观”))).画图片 (0, 0, 210, 105, )
赋值 (局部_文本, _启动窗口.读 (., 局部_记录集句柄, “信用卡所属银行”))
.计次循环首 (取项目数 (), 局部_计次)
    
    .如果真 (等于 (相减 (局部_计次, 1).取项目文本 (), 局部_文本))
        赋值 (.现行选中项, 相减 (局部_计次, 1))
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
_启动窗口.关闭记录集 (., 局部_记录集句柄)

赋值 (局部_记录集句柄, _启动窗口.查询 (., 相加 (“select * from Bank_Info where 银行名称='”, 局部_文本, “'”)))
_启动窗口.到首记录 (., 局部_记录集句柄)
载入图片 (_启动窗口.读 (., 局部_记录集句柄, “银行标志”)).画图片 (0, 0, 160, 30, )
_启动窗口.关闭记录集 (., 局部_记录集句柄)


.子程序 _超级按钮_修改返回_被单击, 空白型, , 
窗口_信用卡管理.销毁 ()


.子程序 _超级按钮_修改_被单击, 空白型, , 
.局部变量 局部_记录集局部, 整数型, , , 
.局部变量 局部_类别, 文本型, , , 
.局部变量 局部_账单日, 文本型, , , 
.局部变量 局部_到期日, 文本型, , , 

.如果真 (等于 (删首尾空 (程序集_信用卡), “”))
    信息框 (“请输入信用卡名称！”, #警告图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (不等于 (取文本长度 (删首尾空 (.内容)), 4))
    信息框 (“请输入信用卡名后4位卡号！”, #警告图标, )
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    返回 ()
.如果真结束
.如果真 (不等于 (取文本长度 (删首尾空 (.内容)), 4))
    信息框 (“请输入信用卡名后4位卡号！”, #警告图标, )
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    返回 ()
.如果真结束
.如果真 (等于 (子程序_整数判断 (删首尾空 (.内容)), 假))
    信息框 (“请输入整数的银行卡号！”, #警告图标, )
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    返回 ()
.如果真结束
.如果真 (等于 (删首尾空 (.内容), “”))
    赋值 (.内容, “0”)
.如果真结束
.如果真 (等于 (子程序_数值判断 (删首尾空 (.内容)), 假))
    信息框 (“请输入数值型的透支金额，最大金额为9999999.99！”, #警告图标, )
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    返回 ()
.如果真结束
.如果真 (等于 (全局_uid, 0))
    .如果真 (等于 (.现行选中项, 0))
        信息框 (“请选择账单日！”, #警告图标, )
        返回 ()
    .如果真结束
    
.如果真结束
.如果真 (等于 (删首尾空 (.内容), “”))
    赋值 (.内容, “ ”)
.如果真结束
.如果真 (等于 (删首尾空 (.内容), “”))
    赋值 (.内容, “ ”)
.如果真结束
.如果真 (等于 (删首尾空 (.内容), “”))
    赋值 (.内容, “0”)
.如果真结束
.如果真 (等于 (子程序_数值判断 (删首尾空 (.内容)), 假))
    信息框 (“请输入数值型的透支金额，最大金额为9999999.99！”, #警告图标, )
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    返回 ()
.如果真结束
.如果真 (大于 (到数值 (删首尾空 (.内容)), 到数值 (删首尾空 (.内容))))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    信息框 (“已透支金额不能大于可透支金额！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (子程序_编辑框特殊字符判断 (删首尾空 (.内容)), 假))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    信息框 (“不可输入特殊字符！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (子程序_编辑框特殊字符判断 (删首尾空 (.内容)), 假))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    信息框 (“不可输入特殊字符！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (子程序_编辑框特殊字符判断 (删首尾空 (程序集_信用卡)), 假))
    获取焦点 ()
    信息框 (“不可输入特殊字符！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (并且 (等于 (.选中, 假), 等于 (.选中, 假)))
    信息框 (“请选择你的到期还款日类型！”, #警告图标, )
    返回 ()
.如果真结束


赋值 (局部_类别, .取项目文本 (.现行选中项))
赋值 (局部_类别, 取文本左边 (局部_类别, 相减 (寻找文本 (局部_类别, “(”, , 假), 1)))
.判断开始 (并且 (大于或等于 (.现行选中项, 0), 小于 (.现行选中项, 10)))
    赋值 (局部_账单日, 取文本右边 (.取项目文本 (.现行选中项), 3))
.默认
    赋值 (局部_账单日, 取文本右边 (.取项目文本 (.现行选中项), 4))
.判断结束


.如果真 (等于 (.选中, 真))
    .如果真 (等于 (.现行选中项, 0))
        信息框 (“请选择到期还款日！”, #警告图标, )
        返回 ()
    .如果真结束
    
    .判断开始 (并且 (大于或等于 (.现行选中项, 0), 小于 (.现行选中项, 10)))
        赋值 (局部_到期日, 取文本右边 (.取项目文本 (.现行选中项), 3))
        
    .默认
        赋值 (局部_到期日, 取文本右边 (.取项目文本 (.现行选中项), 4))
    .判断结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果真 (或者 (等于 (子程序_整数判断 (.内容), 假), 等于 (删首尾空 (.内容), “”)))
        获取焦点 ()
        赋值 (.被选择字符数, 取文本长度 (.内容))
        信息框 (“请输入整数的还款天数！”, #警告图标, )
        返回 ()
    .如果真结束
    赋值 (局部_到期日, 相加 (.内容, “天”))
.如果真结束



赋值 (局部_记录集局部, _启动窗口.查询 (., 相加 (“select count(*) from Card_Info where 用户名='”, 全局_用户名, “' and 信用卡号='”, 删首尾空 (.内容), “' and 信用卡所属银行='”, .取项目文本 (.现行选中项), “' and 信用卡名称='”, 删首尾空 (程序集_信用卡), “' and id<>”, 全局_id)))


.如果真 (等于 (_启动窗口.读 (., 局部_记录集局部, 1), 1))
    信息框 (相加 (“卡号为：”, 删首尾空 (.内容), #换行符, “信用卡名称为：”, 删首尾空 (程序集_信用卡), #换行符, “的卡片信息已经存在！”), #警告图标, )
    返回 ()
.如果真结束


.如果真 (等于 (_启动窗口.执行 (., 相加 (“update Card_Info set 信用卡号='”, 删首尾空 (.内容), “',信用卡名称='”, 删首尾空 (程序集_信用卡), “',信用卡所属银行='”, .取项目文本 (.现行选中项), “',类别='”, 局部_类别, “',信用卡外观= ? ,账单日='”, 局部_账单日, “',到期还款日='”, 局部_到期日, “',查询密码='”, 删首尾空 (.内容), “',取款密码='”, 删首尾空 (.内容), “',已还金额='”, 删首尾空 (.内容), “', 交易金额='”, 删首尾空 (.内容), “' where id=”, 全局_id), 160.取图片 (30)), 假))
    
    信息框 (“信用卡修改失败！”, #警告图标, )
    返回 ()
.如果真结束
信息框 (“信用卡修改成功！”, #信息图标, )
窗口_信用卡管理.销毁 ()


.子程序 _画板_修改信用卡_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.过滤器, “图片文件|*.jpg;*.bmp;*.gif”)
打开 ()
载入图片 (读入文件 (.文件名)).画图片 (0, 0, .宽度, .高度, )


.子程序 _画板_修改信用卡_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

相加 (窗口_信用卡管理., .左边, .左边, 相除 (.宽度, 2)).未知支持库函数_26 (相加 (窗口_信用卡管理., .顶边, .顶边, 相除 (.高度, 2)), “鼠标左键单击此处添加图片”, -1, )


.子程序 _组合框_所属银行_列表项被选择, 空白型, , 
.局部变量 局部_银行名, 文本型, , , 
.局部变量 局部_银行标志, 字节集, , , 
.局部变量 局部_记录集句柄, 整数型, , , 

赋值 (局部_银行名, .取项目文本 (.现行选中项))
赋值 (局部_记录集句柄, _启动窗口.查询 (., 相加 (“select 银行标志 from Bank_Info where 银行名称='”, 局部_银行名, “'”)))
_启动窗口.到首记录 (., 局部_记录集句柄)
赋值 (局部_银行标志, _启动窗口.读 (., 局部_记录集句柄, “银行标志”))
载入图片 (局部_银行标志).画图片 (0, 0, .宽度, .高度, )

.如果 (等于 (.取项目文本 (.现行选中项), “中国民生银行”))
    赋值 (.禁止, 真)
    信息框 (相加 (“你将无法选择中国民生银行的到期还款日，”, #换行符, “中国民生银行的到期还款日是账单日次日的后20天，”, #换行符, “软件将自动给您换算！”), #警告图标, )
.否则
    赋值 (.禁止, 假)
.如果结束




.子程序 _组合框_信用卡_编辑内容被改变, 空白型, , 
赋值 (程序集_信用卡, .内容)


.子程序 _组合框_删除信用卡_列表项被选择, 空白型, , 
.局部变量 局部_记录集句柄, 整数型, , , 

.如果真 (不等于 (.现行选中项, 0))
    赋值 (全局_id, 到文本 (.取项目数值 (.现行选中项)))
.如果真结束
赋值 (局部_记录集句柄, _启动窗口.查询 (., 相加 (“select * from Card_Info where id=”, 全局_id, “ and 用户名='”, 全局_用户名, “'”)))
_启动窗口.到首记录 (., 局部_记录集句柄)
赋值 (.内容, _启动窗口.读 (., 局部_记录集句柄, “信用卡号”))
赋值 (.内容, _启动窗口.读 (., 局部_记录集句柄, “信用卡所属银行”))
_启动窗口.关闭记录集 (., 局部_记录集句柄)

赋值 (局部_记录集句柄, _启动窗口.查询 (., 相加 (“select * from Bank_Info where 银行名称='”, .内容, “'”)))
_启动窗口.到首记录 (., 局部_记录集句柄)
载入图片 (_启动窗口.读 (., 局部_记录集句柄, “银行标志”)).画图片 (0, 0, 160, 30, )
_启动窗口.关闭记录集 (., 局部_记录集句柄)

.子程序 _超级按钮_删除返回_被单击, 空白型, , 
窗口_信用卡管理.销毁 ()


.子程序 _超级按钮_删除_被单击, 空白型, , 
.如果真 (等于 (.现行选中项, 0))
    信息框 (“请选择你要删除信用卡！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (相加 (“确认删除”, .内容, #换行符, “卡号后四位是：”, .内容, “的”, .取项目文本 (.现行选中项), “吗？”), 相加 (#询问图标, #确认取消钮), ), #取消钮))
    返回 ()
.如果真结束
.如果真 (等于 (_启动窗口.执行 (., 相加 (“delete from Card_Info where id=”, 全局_id), ), 假))
    信息框 (“信用卡删除失败！”, #警告图标, )
    返回 ()
.如果真结束
信息框 (“信用卡删除成功！”, #警告图标, )
窗口_信用卡管理.销毁 ()


.子程序 _窗口_信用卡管理_将被销毁, 空白型, , 
子程序_高级表格初始化 ()



.子程序 _单选框_天数_被单击, 空白型, , 
.判断开始 (等于 (.选中, 真))
    连续赋值 (真, .可视, .可视)
    赋值 (.可视, 假)
.默认
    
.判断结束


.子程序 _单选框_日期_被单击, 空白型, , 
.判断开始 (等于 (.选中, 真))
    连续赋值 (假, .可视, .可视)
    赋值 (.可视, 真)
.默认
    
.判断结束


.子程序 _单选框_修改天数_被单击, 空白型, , 
.判断开始 (等于 (.选中, 真))
    连续赋值 (真, .可视, .可视)
    赋值 (.可视, 假)
.默认
    
.判断结束


.子程序 _单选框_修改日期_被单击, 空白型, , 
.判断开始 (等于 (.选中, 真))
    连续赋值 (假, .可视, .可视)
    赋值 (.可视, 真)
.默认
    
.判断结束


.窗口程序集 银行管理_程序集, , , 

.子程序 _窗口_银行管理_创建完毕, 空白型, , 
.局部变量 局部_记录集句柄, 整数型, , , 

赋值 (.现行子夹, 全局_银行)
载入图片 (#BankNoLogo).画图片 (0, 0, 160, 30, )
载入图片 (#BankNoLogo).画图片 (0, 0, 160, 30, )
.判断开始 (等于 (全局_银行, 0))
    赋值 (窗口_银行管理., “信用卡管理器――添加银行”)
.判断 (等于 (全局_银行, 1))
    赋值 (窗口_银行管理., “信用卡管理器――修改银行”)
     ' _启动窗口.外部数据库1
    赋值 (.列表项目, {  })
    “---请选择---”.加入项目 ()
    赋值 (.现行选中项, 0)
    赋值 (局部_记录集句柄, _启动窗口.查询 (., “select 银行名称 from Bank_Info”))
    _启动窗口.到首记录 (., 局部_记录集句柄)
    .判断循环首 (等于 (_启动窗口.尾记录后 (., 局部_记录集句柄), 假))
        _启动窗口.读 (., 局部_记录集句柄, “银行名称”).加入项目 ()
        _启动窗口.到后一记录 (., 局部_记录集句柄)
    .判断循环尾 ()
    _启动窗口.关闭记录集 (., 局部_记录集句柄)
    
.判断 (等于 (全局_银行, 2))
    赋值 (窗口_银行管理., “信用卡管理器――删除银行”)
    赋值 (.列表项目, {  })
    “---请选择---”.加入项目 ()
    赋值 (.现行选中项, 0)
    赋值 (局部_记录集句柄, _启动窗口.查询 (., “select 银行名称 from Bank_Info”))
    _启动窗口.到首记录 (., 局部_记录集句柄)
    .判断循环首 (等于 (_启动窗口.尾记录后 (., 局部_记录集句柄), 假))
        _启动窗口.读 (., 局部_记录集句柄, “银行名称”).加入项目 ()
        _启动窗口.到后一记录 (., 局部_记录集句柄)
    .判断循环尾 ()
    _启动窗口.关闭记录集 (., 局部_记录集句柄)
    
.默认
    
.判断结束


.子程序 _按钮_添加_被单击, 空白型, , 
.局部变量 局部_记录集句柄, 整数型, , , 

.如果真 (等于 (删首尾空 (.内容), “”))
    信息框 (“请输入你要添加的银行名称！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (子程序_编辑框特殊字符判断 (删首尾空 (.内容)), 假))
    信息框 (“不可输入特殊字符！”, #警告图标, )
    返回 ()
.如果真结束
.如果 (等于 (删首尾空 (.内容), “”))
    赋值 (.内容, “ ”)
.否则
    .如果真 (等于 (子程序_编辑框特殊字符判断 (删首尾空 (.内容)), 假))
         ' 编辑框_添加网址.获取焦点 ()
         ' 编辑框_添加网址.被选择字符数 ＝ 取文本长度 (编辑框_添加网址.内容)
         ' 信息框 (“不可输入特殊字符！”, #警告图标, )
         ' 返回 ()
    .如果真结束
    .判断开始 (或者 (等于 (寻找文本 (删首尾空 (.内容), “.com”, , 假), -1), 等于 (寻找文本 (删首尾空 (.内容), “.gov”, , 假), -1), 等于 (寻找文本 (删首尾空 (.内容), “.net”, , 假), -1), 等于 (寻找文本 (删首尾空 (.内容), “.cn”, , 假), -1)))
        信息框 (相加 (“网址输入错误！”, #换行符, “例如：”, #引号, “www.baidu.com.cn”, #引号), 0, )
        返回 ()
    .默认
        
    .判断结束
    
.如果结束
.如果真 (等于 (删首尾空 (.内容), “”))
    赋值 (.内容, “ ”)
.如果真结束
.如果真 (等于 (子程序_编辑框特殊字符判断 (删首尾空 (.内容)), 假))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    信息框 (“不可输入特殊字符！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (子程序_整数判断 (删首尾空 (.内容)), 假))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    信息框 (“电话只可是整数型字符！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (删首尾空 (.内容), “”))
    赋值 (.内容, “ ”)
.如果真结束
.如果真 (等于 (子程序_编辑框特殊字符判断 (删首尾空 (.内容)), 假))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    信息框 (“不可输入特殊字符！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (子程序_整数判断 (删首尾空 (.内容)), 假))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    信息框 (“电话只可是整数型字符！”, #警告图标, )
    返回 ()
.如果真结束

赋值 (局部_记录集句柄, _启动窗口.查询 (., 相加 (“select count(*) from Bank_Info where 银行名称='”, 删首尾空 (.内容), “'”)))
.如果真 (等于 (_启动窗口.读 (., 局部_记录集句柄, 1), 1))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    信息框 (“您要添加的银行已经存在！”, #警告图标, )
    返回 ()
.如果真结束

.如果真 (等于 (_启动窗口.执行 (., 相加 (“insert into Bank_Info(银行名称,银行网站,服务电话,信用卡电话,银行标志) values('”, 删首尾空 (.内容), “','http://”, .内容, “','”, .内容, “','”, .内容, “', ?)”), 160.取图片 (30)), 假))
    信息框 (“银行添加失败！”, #警告图标, )
    返回 ()
.如果真结束
信息框 (“银行添加成功！”, 0, )
窗口_银行管理.销毁 ()



.子程序 _按钮_取消_被单击, 空白型, , 
窗口_银行管理.销毁 ()

.子程序 _画板_添加图片_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

取鼠标水平位置 ().未知支持库函数_26 (取鼠标垂直位置 (), “鼠标左键单击此处添加图片”, -1, )


.子程序 _画板_添加图片_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.过滤器, “图片文件|*.jpg;*.bmp;*.gif”)
.如果真 (打开 ())
    载入图片 (.文件名).画图片 (0, 0, 160, 30, )
.如果真结束


.子程序 _组合框_修改银行名称_列表项被选择, 空白型, , 
.局部变量 局部_银行名, 文本型, , , 
.局部变量 局部_银行标志, 字节集, , , 
.局部变量 局部_记录集句柄, 整数型, , , 

赋值 (局部_银行名, .取项目文本 (.现行选中项))
赋值 (局部_记录集句柄, _启动窗口.查询 (., 相加 (“select * from Bank_Info where 银行名称='”, 局部_银行名, “'”)))
_启动窗口.到首记录 (., 局部_记录集句柄)
赋值 (局部_银行名, _启动窗口.读 (., 局部_记录集句柄, “银行网站”))
赋值 (局部_银行名, 取文本右边 (局部_银行名, 相减 (取文本长度 (局部_银行名), 7)))


赋值 (.内容, 局部_银行名)
调试输出 (_启动窗口.读 (., 局部_记录集句柄, “服务电话”))
赋值 (.内容, _启动窗口.读 (., 局部_记录集句柄, “服务电话”))
调试输出 (_启动窗口.读 (., 局部_记录集句柄, “信用卡电话”))
赋值 (.内容, _启动窗口.读 (., 局部_记录集句柄, “信用卡电话”))

赋值 (局部_银行标志, 到字节集 (_启动窗口.读 (., 局部_记录集句柄, “银行标志”)))
载入图片 (局部_银行标志).画图片 (0, 0, 160, 30, )
_启动窗口.关闭记录集 (., 局部_记录集句柄)

.子程序 _按钮_取消1_被单击, 空白型, , 
窗口_银行管理.销毁 ()


.子程序 _按钮_修改_被单击, 空白型, , 
.如果真 (等于 (.现行选中项, 0))
    信息框 (“请选择你要修改的银行！”, #警告图标, )
    返回 ()
.如果真结束
.如果 (等于 (删首尾空 (.内容), “”))
    赋值 (.内容, “ ”)
.否则
    
    .如果真 (等于 (子程序_编辑框特殊字符判断 (删首尾空 (.内容)), 假))
         ' 编辑框_修改网址.获取焦点 ()
         ' 编辑框_修改网址.被选择字符数 ＝ 取文本长度 (编辑框_修改网址.内容)
         ' 信息框 (“不可输入特殊字符！”, #警告图标, )
         ' 返回 ()
    .如果真结束
    .判断开始 (或者 (等于 (寻找文本 (删首尾空 (.内容), “.com”, , 假), -1), 等于 (寻找文本 (删首尾空 (.内容), “.gov”, , 假), -1), 等于 (寻找文本 (删首尾空 (.内容), “.net”, , 假), -1), 等于 (寻找文本 (删首尾空 (.内容), “.cn”, , 假), -1)))
        信息框 (相加 (“网址输入错误！”, #换行符, “例如：”, #引号, “www.baidu.com.cn”, #引号), 0, )
        返回 ()
    .默认
        
    .判断结束
    
.如果结束
.如果真 (等于 (删首尾空 (.内容), “”))
    赋值 (.内容, “ ”)
.如果真结束
.如果真 (等于 (子程序_编辑框特殊字符判断 (删首尾空 (.内容)), 假))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    信息框 (“不可输入特殊字符！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (子程序_整数判断 (删首尾空 (.内容)), 假))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    信息框 (“电话只可是整数型字符！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (删首尾空 (.内容), “”))
    赋值 (.内容, “ ”)
.如果真结束
.如果真 (等于 (子程序_编辑框特殊字符判断 (删首尾空 (.内容)), 假))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    信息框 (“不可输入特殊字符！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (子程序_整数判断 (删首尾空 (.内容)), 假))
    获取焦点 ()
    赋值 (.被选择字符数, 取文本长度 (.内容))
    信息框 (“电话只可是整数型字符！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (_启动窗口.执行 (., 相加 (“update Bank_Info set 银行网站='http://”, 删首尾空 (.内容), “',服务电话='”, 删首尾空 (.内容), “',信用卡电话='”, 删首尾空 (.内容), “',银行标志=? where 银行名称='”, .取项目文本 (.现行选中项), “'”), 160.取图片 (30)), 假))
    信息框 (“银行修改失败！”, #警告图标, )
    返回 ()
.如果真结束
信息框 (“银行修改成功！”, 0, )
窗口_银行管理.销毁 ()


.子程序 _画板_修改图片_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

取鼠标水平位置 ().未知支持库函数_26 (取鼠标垂直位置 (), “鼠标左键单击此处添加图片”, -1, )


.子程序 _画板_修改图片_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.过滤器, “图片文件|*.jpg;*.bmp;*.gif”)
.如果真 (打开 ())
    载入图片 (.文件名).画图片 (0, 0, 160, 30, )
.如果真结束


.子程序 _按钮_取消2_被单击, 空白型, , 
窗口_银行管理.销毁 ()


.子程序 _按钮_删除_被单击, 空白型, , 
.局部变量 局部_记录集句柄, 整数型, , , 
.局部变量 局部_文本, 文本型, 静态, , 
.局部变量 局部_相关数, 文本型, , , 
.局部变量 局部_id, 文本型, , "0", 
.局部变量 局部_计次, 整数型, , , 

.如果真 (等于 (.现行选中项, 0))
    信息框 (“请选择要删除的银行！”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (相加 (“确认删除：”, .取项目文本 (.现行选中项), “？”), 相加 (#询问图标, #确认取消钮), ), #取消钮))
    返回 ()
.如果真结束
赋值 (局部_记录集句柄, _启动窗口.查询 (., 相加 (“select count(*) from Card_Info where 信用卡所属银行='”, .取项目文本 (.现行选中项), “'”)))
_启动窗口.到首记录 (., 局部_记录集句柄)
赋值 (局部_相关数, 到文本 (_启动窗口.读 (., 局部_记录集句柄, 1)))
.如果真 (大于 (_启动窗口.读 (., 局部_记录集句柄, 1), 0))
    _启动窗口.关闭记录集 (., 局部_记录集句柄)
    
    赋值 (局部_记录集句柄, _启动窗口.查询 (., 相加 (“select * from Card_Info where 信用卡所属银行='”, .取项目文本 (.现行选中项), “'”)))
    _启动窗口.到首记录 (., 局部_记录集句柄)
    .判断循环首 (等于 (_启动窗口.尾记录后 (., 局部_记录集句柄), 假))
        赋值 (局部_文本, 相加 (局部_文本, _启动窗口.读 (., 局部_记录集句柄, “信用卡名称”)))
        赋值 (局部_文本, 相加 (局部_文本, “ 卡号：”, _启动窗口.读 (., 局部_记录集句柄, “信用卡号”), #换行符))
        加入成员 (局部_id, 到文本 (_启动窗口.读 (., 局部_记录集句柄, “id”)))
        _启动窗口.到后一记录 (., 局部_记录集句柄)
    .判断循环尾 ()
    _启动窗口.关闭记录集 (., 局部_记录集句柄)
    .如果真 (等于 (信息框 (相加 (“你有 ”, 局部_相关数, “ 张信用卡与 ”, .取项目文本 (.现行选中项), “相关联”, #换行符, 局部_文本, #换行符, “你确认删除该银行？”), 相加 (#询问图标, #确认取消钮), ), #取消钮))
        返回 ()
    .如果真结束
    
.如果真结束
.如果真 (等于 (_启动窗口.执行 (., 相加 (“delete from Bank_Info where 银行名称='”, .取项目文本 (.现行选中项), “'”), ), 假))
    信息框 (相加 (.取项目文本 (.现行选中项), “删除失败！”), #警告图标, )
    返回 ()
.如果真结束
信息框 (相加 (.取项目文本 (.现行选中项), “删除成功！”), #信息图标, )
.如果真 (等于 (信息框 (“是否删除相关信用卡？”, 相加 (#询问图标, #是否钮), ), #否钮))
    返回 ()
.如果真结束
.计次循环首 (取数组成员数 (局部_id), 局部_计次)
    .如果真 (等于 (_启动窗口.执行 (., 相加 (“delete from Card_Info where id=”, 局部_id [局部_计次]), ), 假))
        信息框 (“相关联信用卡删除失败，请手动删除！”, #警告图标, )
        返回 ()
    .如果真结束
    
.计次循环尾 ()
信息框 (“相关联信用卡删除成功！”, #信息图标, )
赋值 (局部_文本, “”)
窗口_银行管理.销毁 ()
清除数组 (局部_id)

.子程序 _编辑框_添加网址_内容被改变, 空白型, , 
相加 (窗口_银行管理., .左边, 150).未知支持库函数_26 (相加 (窗口_银行管理., .顶边, 40), 相加 (“例如：”, #引号, “www.cmbchina.com.cn”, #引号), -1, )


.子程序 _编辑框_修改网址_内容被改变, 空白型, , 
相加 (窗口_银行管理., .左边, 150).未知支持库函数_26 (相加 (窗口_银行管理., .顶边, 40), 相加 (“例如：”, #引号, “www.baidu.com.cn”, #引号), -1, )


.子程序 子程序_编辑框特殊字符判断, 逻辑型, , 
.参数 参数_文本, 文本型, , 

.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_单个字符, 文本型, , , 

.计次循环首 (取文本长度 (参数_文本), 局部_计次)
    赋值 (局部_单个字符, 取文本中间 (参数_文本, 局部_计次, 1))
    .如果真 (或者 (等于 (局部_单个字符, “~”), 等于 (局部_单个字符, “`”), 等于 (局部_单个字符, “@”), 等于 (局部_单个字符, “#”), 等于 (局部_单个字符, “$”), 等于 (局部_单个字符, “%”), 等于 (局部_单个字符, “^”), 等于 (局部_单个字符, “&”), 等于 (局部_单个字符, “*”), 等于 (局部_单个字符, “(”), 等于 (局部_单个字符, “)”), 等于 (局部_单个字符, “-”), 等于 (局部_单个字符, “=”), 等于 (局部_单个字符, “+”), 等于 (局部_单个字符, “|”), 等于 (局部_单个字符, “\”), 等于 (局部_单个字符, “[”), 等于 (局部_单个字符, “{”), 等于 (局部_单个字符, “]”), 等于 (局部_单个字符, “}”), 等于 (局部_单个字符, “;”), 等于 (局部_单个字符, “:”), 等于 (局部_单个字符, “'”), 等于 (局部_单个字符, #引号), 等于 (局部_单个字符, “,”), 等于 (局部_单个字符, “<”), 等于 (局部_单个字符, “.”), 等于 (局部_单个字符, “>”), 等于 (局部_单个字符, “/”), 等于 (局部_单个字符, “?”), 等于 (局部_单个字符, #左引号), 等于 (局部_单个字符, #引号)))
        返回 (假)
    .如果真结束
    
    
.计次循环尾 ()
返回 (真)


.子程序 _窗口_银行管理_将被销毁, 空白型, , 
子程序_高级表格初始化 ()

.窗口程序集 提醒_程序集, , , 

.子程序 _超级按钮_返回_被单击, 空白型, , 
窗口_提醒.销毁 ()


.子程序 _窗口_提醒_创建完毕, 空白型, , 
赋值 (.内容, 全局_卡名)
赋值 (.内容, 全局_卡号)
赋值 (.内容, 全局_银行名称)
赋值 (.标题, 相加 (#换行符, “本张银行卡的到期还款日还有：【”, 全局_天数, “ 天】”, #换行符, “透支金额为：【”, 全局_透支, “】”))



 ' 不属于任何一个程序集、类模块的函数：
