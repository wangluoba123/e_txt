 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 637
    高度 = 457
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 已保存到：D:\易语言学习\Data\ini手术室.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “Ini手术室1.0”
    帮助文件名 = “”

窗口 查找窗口
    左边 = 50
    顶边 = 50
    宽度 = 399
    高度 = 142
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 已保存到：D:\易语言学习\Data\ini手术室.e\查找窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “查找”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 295
    高度 = 180
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 已保存到：D:\易语言学习\Data\ini手术室.e\关于窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “关于”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 2 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 1 扩展界面支持库一




.全局变量 日志标记, 整数型, , , 
.全局变量 寻找记录, 文本型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 现行文件名, 文本型, , , 
.程序集变量 是否已修改, 逻辑型, , , 
.程序集变量 文本数组, 文本型, , "0", 
.程序集变量 编辑项目索引, 整数型, , , 
.子程序 _打开_被选择, 空白型, , 
.局部变量 文件号, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 读入文本, 文本型, , , 
.局部变量 父项目索引, 整数型, , , 
.局部变量 s, 整数型, , , 

询问保存 ()
赋值 (.类型, 0)
赋值 (.标题, “打开文件”)
赋值 (.初始目录, 取当前目录 ())
赋值 (i, 1)
.如果 (打开 ())
    赋值 (文件号, 打开文件 (.文件名, , ))
    赋值 (现行文件名, .文件名)
    清空 ()
    赋值 (.内容, “”)
    全部删除 ()
    赋值 (_启动窗口.标题, 相加 (“Ini手术室-”, 现行文件名))
    移到文件首 (文件号)
    .判断循环首 (等于 (是否在文件尾 (文件号, ), 假))
        赋值 (读入文本, 读入一行 (文件号)) ' 将文件内容读入容器
        重定义数组 (真, 相加 (i, 1)) ' 定义数组容器的上限
        赋值 ( [i], 读入文本)
        .如果 (等于 (取文本右边 ( [i], 1), “]”)) ' 以此判断是否为标准的ini文件
            -1.加入项目 (文本数组 [i], 1, , ) ' 将[]内容作为树型框的父项目
            赋值 (父项目索引, 相减 (i, 1))
        .否则
            父项目索引.加入项目 (文本数组 [i], 0, , ) ' 将其他内容作为子项目
        .如果结束
        赋值 (i, 相加 (i, 1))
        
    .判断循环尾 ()
    0.扩展 () ' 扩展首相
    .计次循环首 (取项目数 (), ) ' 将树型框内容读入超级列表框和编辑框中
        相减 (s, 1).插入表项 (相减 (s, 1).取项目文本 (), , , , )
        相减 (s, 1).置标题 (1, 相减 (s, 1).取项目文本 ())
        相加 (相减 (s, 1).取项目文本 (), #换行符).加入文本 ()
        赋值 (.起始选择位置, 1)
        .如果 (不等于 (相减 (s, 1).取项目文本 (), “”)) ' 确定超级列表框的检查框选中
            相减 (s, 1).置状态图片 (1)
        .否则
            相减 (s, 1).置状态图片 (0)
        .如果结束
        
    .计次循环尾 ()
    赋值 (日志标记, 相加 (日志标记, 1))
    相加 (到文本 (日志标记), “:打开文本”, 现行文件名, #换行符).加入项目 () ' 以上两句将操作内容加入日志
    连续赋值 (假, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
    3.去除状态 (4)
    5.去除状态 (4)
    6.去除状态 (4)
    7.去除状态 (4)
    9.去除状态 (4)
    1.置文本 (“打开文件”)
    
.否则
    信息框 (“打开文件失败！”, #信息图标, “失败”)
.如果结束


.子程序 _超级列表框1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 m, 整数型, , , 

.如果真 (等于 (是否已修改, 真)) ' 只要是添加项目或编辑等操作后,都将对编辑框中内容进行更新
    赋值 (.内容, “”)
    .计次循环首 (取表项数 (), m)
        相加 (相减 (m, 1).取标题 (0), #换行符).加入文本 ()
    .计次循环尾 ()
    赋值 (.起始选择位置, 相减 (寻找文本 (.内容, 编辑项目索引.取标题 (), , 假), 1))
    赋值 (.被选择字符数, 取文本长度 (编辑项目索引.取标题 ())) ' 以上两句保证编辑框显示修改后的内容
.如果真结束


.子程序 _新建_被选择, 空白型, , 
.如果真 (或者 (等于 (是否已修改, 假), 等于 (询问保存 (), 真)))
    清除数组 (文本数组)
    赋值 (_启动窗口.标题, “Ini手术室1.0 - 无标题”)
    赋值 (“无标题”)
    清空 ()
    全部删除 ()
    赋值 (.内容, “”)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (日志标记, 相加 (日志标记, 1))
    相加 (到文本 (日志标记), “:新建文本-无标题”, #换行符).加入项目 ()
    1.置文本 (“新建文件”)
    赋值 (是否已修改, 假)
    连续赋值 (真, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
    2.加入状态 (4)
    3.加入状态 (4)
    5.加入状态 (4)
    6.加入状态 (4)
    7.加入状态 (4)
    9.加入状态 (4)
    
.如果真结束


.子程序 询问保存, 逻辑型, , 
.局部变量 返回询问, 整数型, , , 

.如果 (等于 (是否已修改, 真))
    赋值 (返回询问, 信息框 (相加 (“文件”, 现行文件名, #换行符, “已被修改,是否保存更改?”), #取消是否钮, “询问”))
    .如果 (等于 (返回询问, #是钮))
        返回 (_保存_被选择 ())
    .否则
        .如果 (等于 (返回询问, #否钮))
            返回 (真)
        .否则
            返回 (假)
        .如果结束
        
    .如果结束
    
.否则
    返回 (真)
.如果结束


.子程序 _保存_被选择, 逻辑型, , 
.参数 另存文件名, 文本型, 可空, 

.局部变量 文件名, 文本型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 n, 整数型, , , 

.如果 (等于 (另存文件名, “”))
    赋值 (文件名, 现行文件名)
    .如果真 (等于 (文件名, “无标题”))
        赋值 (.标题, “保存”)
        赋值 (.类型, 1)
        赋值 (.文件名, 文件名)
        .如果 (等于 (打开 (), 真))
            赋值 (文件名, .文件名)
        .否则
            返回 (假)
        .如果结束
        
    .如果真结束
    
.否则
    赋值 (文件名, 另存文件名)
.如果结束
赋值 (文件号, 打开文件 (文件名, #重写, ))
.如果 (不等于 (0))
    写出文本 (文件号, .内容)
    关闭文件 ()
    赋值 ()
    赋值 (_启动窗口.标题, 相加 (“Ini手术室1.0-”, 现行文件名))
    赋值 (假)
    返回 (真)
.否则
    信息框 (“保存文件失败”, #信息图标, “失败”)
    返回 (假)
.如果结束
赋值 (日志标记, 相加 (日志标记, 1))
相加 (到文本 (日志标记), “:保存文本”, 现行文件名, #换行符).加入项目 ()
1.置文本 (“保存文件”)

.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (是否已修改, 假)
连续赋值 (真, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
2.加入状态 (4)
3.加入状态 (4)
5.加入状态 (4)
6.加入状态 (4)
7.加入状态 (4)
9.加入状态 (4)

.子程序 _退出_被选择, 空白型, , 
.如果真 (等于 (询问保存 (), 真))
    销毁 ()
.如果真结束


.子程序 __启动窗口_可否被关闭, 逻辑型, , 
返回 (询问保存 ())

.子程序 _超级列表框1_结束编辑, 逻辑型, , 
.参数 表项索引, 整数型, , 

赋值 (是否已修改, 真)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (日志标记, 相加 (日志标记, 1))
相加 (到文本 (日志标记), “:编辑选定项”, .取标题 (., ), #换行符).加入项目 ()
2.去除状态 (4)
赋值 (编辑项目索引, 表项索引) ' 将现行编辑的表项索引记录,以便_超级列表框1_鼠标左键被放开()子程序调用

.子程序 _另存为_被选择, 空白型, , 
赋值 (.标题, “另存为”)
赋值 (.类型, 1)
.如果真 (打开 ())
    _保存_被选择 (.文件名)
.如果真结束


.子程序 _向上插入项_被选择, 空白型, , 
.如果 (不等于 (., -1))
    .插入表项 (., “新项目”, , , , )
    相减 (., 1).置标题 (1, “新项目”)
    相减 (., 1).进入编辑 ()
    赋值 (日志标记, 相加 (日志标记, 1))
    相加 (到文本 (日志标记), “:在第”, 到文本 (.), “行上插入了新项目”, #换行符).加入项目 ()
    1.置文本 (“向上插入项”)
    赋值 (是否已修改, 真)
.否则
    信息框 (“请选则需要插入的位置”, 0, )
.如果结束


.子程序 _向下插入项_被选择, 空白型, , 
.如果 (或者 (等于 (取表项数 (), 0), 不等于 (., -1)))
    相加 (., 1).插入表项 (“新项目”, , , , )
    相加 (., 1).置标题 (1, “新项目”)
    相加 (., 1).进入编辑 ()
    赋值 (日志标记, 相加 (日志标记, 1))
    相加 (到文本 (日志标记), “:在第”, 到文本 (.), “行下插入了新项目”, #换行符).加入项目 ()
    1.置文本 (“向下插入项”)
    赋值 (是否已修改, 真)
    连续赋值 (假, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
    2.去除状态 (4)
    3.去除状态 (4)
    5.去除状态 (4)
    6.去除状态 (4)
    7.去除状态 (4)
    9.去除状态 (4)
.否则
    信息框 (“请选则需要插入的位置”, 0, )
.如果结束


.子程序 _编辑选定项_被选择, 空白型, , 
.如果 (或者 (等于 (取表项数 (), 0), 不等于 (., -1)))
    .进入编辑 (.)
    .如果真 (等于 (是否已修改, 真))
        赋值 (日志标记, 相加 (日志标记, 1))
        相加 (到文本 (日志标记), “:编辑选定项”, .取标题 (., 0), #换行符).加入项目 ()
        1.置文本 (“编辑选定项”)
    .如果真结束
    
.否则
    信息框 (“请选则需要插入的位置”, 0, )
    
.如果结束


.子程序 _超级列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.起始选择位置, 相减 (寻找文本 (.内容, .取标题 (., ), , 假), 1))
赋值 (.被选择字符数, 取文本长度 (.取标题 (., ))) ' 实现编辑框和列表框显示内容同步

.子程序 _超级列表框1_左键单击表项, 空白型, , 
.如果真 (不等于 (取表项数 (), 0))
    赋值 (.现行子夹, 0) ' 立刻显示文本内容
    .如果真 (不等于 (., -1))
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        _启动窗口.刷新显示 ()
        0.置文本 (相加 (“当前选定第”, 到文本 (相加 (., 1)), “行”))
        .如果真 (等于 (是否已修改, 真))
            赋值 (.禁止, 假)
        .如果真结束
        
    .如果真结束
    1.置文本 (“列表项;双击,编辑项目,文本定位到相应行”)
.如果真结束


.子程序 _恢复当前编辑项_被选择, 空白型, , 
.局部变量 恢复数据, 文本型, , , 

.如果 (不等于 (., -1))
    .如果 (不等于 (.取标题 (., 0), .取标题 (., 1)))
        赋值 (恢复数据, .取标题 (., 1))
        .置标题 (., 0, 恢复数据)
        赋值 (日志标记, 相加 (日志标记, 1))
        相加 (到文本 (日志标记), “:恢复当前编辑项”, .取标题 (., ), #换行符).加入项目 ()
        1.置文本 (“恢复当前编辑项”)
        赋值 (是否已修改, 真)
    .否则
        信息框 (“当前项目未经过编辑,请选择编辑过得项目”, 0, )
    .如果结束
    
.否则
    信息框 (“请选择需要恢复项目!”, 0, )
.如果结束


.子程序 _恢复所有编辑项_被选择, 空白型, , 
.局部变量 n, 整数型, , , 

.如果 (等于 (信息框 (“真的要恢复所有修改吗?”, 33, “询问”), 0))
    .计次循环首 (取表项数 (), n)
        相减 (n, 1).置标题 (0, 相减 (n, 1).取标题 (1))
    .计次循环尾 ()
.否则
    返回 ()
.如果结束
赋值 (日志标记, 相加 (日志标记, 1))
相加 (到文本 (日志标记), “:恢复所有编辑项”, #换行符).加入项目 ()
1.置文本 (“恢复所有编辑项”)
赋值 (是否已修改, 真)

.子程序 _删除选定项_被选择, 空白型, , 
.局部变量 m, 整数型, , , 

.如果 (不等于 (., -1))
    赋值 (日志标记, 相加 (日志标记, 1))
    相加 (到文本 (日志标记), “:删除选定项”, .取标题 (., ), #换行符).加入项目 ()
    .删除表项 (.)
    赋值 (是否已修改, 真)
    1.置文本 (“删除选定项”)
.否则
    信息框 (“请选则需要删除的项目”, 0, )
.如果结束


.子程序 _超级列表框1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _超级列表框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.选择表项 (.)
赋值 (.被选择字符数, 0)
.如果真 (等于 (., -1))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.如果真结束


.子程序 _恢复到最初_被选择, 空白型, , 
.局部变量 n, 整数型, , , 

全部删除 ()
赋值 (.内容, “”)
.计次循环首 (取数组成员数 (文本数组), n)
    相减 (n, 1).插入表项 (文本数组 [n], , , , )
    相减 (n, 1).置标题 (1, 文本数组 [n])
    .如果 (不等于 (相减 (n, 1).取项目文本 (), “”))
        相减 (n, 1).置状态图片 (1)
    .否则
        相减 (n, 1).置状态图片 (0)
    .如果结束
    
    相加 (相减 (n, 1).取项目文本 (), #换行符).加入文本 ()
    赋值 (.起始选择位置, 1)
.计次循环尾 ()
赋值 (日志标记, 相加 (日志标记, 1))
相加 (到文本 (日志标记), “:恢复到最初状态”, #换行符).加入项目 ()
1.置文本 (“恢复到最初”)

.子程序 _用记事本打开_被选择, 空白型, , 
运行 (相加 (“c:\windows\notepad.exe ”, 现行文件名), 假, )

.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.如果真 (等于 (按钮索引, 0))
    _新建_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 1))
    _打开_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 2))
    _保存_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 3))
    _另存为_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 5))
    _提取所有_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 6))
    _提取钩选项_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 7))
    _提取目录树_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 9))
    _查找_被选择 ()
.如果真结束


.子程序 _树型框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

1.置文本 (“目录树.单击,列表定位到相应项”)

.子程序 _树型框1_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

.保证显示 (.)
.选择表项 (.)
赋值 (.被选择字符数, 0)

.子程序 _树型框1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

1.置文本 (“目录树.单击,列表定位到相应项”)

.子程序 _超级列表框1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

1.置文本 (“列表项,双击,文本定位到相应行”)

.子程序 _选择夹1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (.现行子夹, 1))
    .如果 (不等于 (.内容, “”))
        1.置文本 (“当前文本内容于列表项同”)
    .否则
        1.置文本 (“目标文本”)
    .如果结束
    
.否则
    1.置文本 (“日志”)
.如果结束


.子程序 _列表框2_列表项被选择, 空白型, , 
1.置文本 (.取项目文本 (.现行选中项))

.子程序 __启动窗口_尺寸被改变, 空白型, , 
赋值 (., 相减 (相乘 (取用户区宽度 (), 0.3), 5))
赋值 (., 相减 (取用户区高度 (), .))
赋值 (., .)
赋值 (., 相减 (取用户区宽度 (), ., 5))
赋值 (., 相除 (相减 (取用户区高度 (), .), 2))
0.置列宽 (相除 (., 2))
1.置列宽 (相除 (., 2))
赋值 (.左边, .)
赋值 (.宽度, 相减 (取用户区宽度 (), ., 5))
赋值 (.高度, 相减 (取用户区高度 (), ., ., 35))
赋值 (.顶边, 相加 (., 35))
赋值 (.宽度, 相减 (.宽度, 8))
赋值 (.高度, 相减 (.高度, 30))
赋值 (.宽度, 相减 (.宽度, 8))
赋值 (.高度, 相减 (.高度, 30))
赋值 (., 取用户区宽度 ())
0.置宽度 (相乘 (取用户区宽度 (), 0.2))
1.置宽度 (相乘 (取用户区宽度 (), 0.8))

.子程序 _提取所有_被选择, 空白型, , 
.局部变量 i, 整数型, , , 

赋值 (.内容, “”)
.计次循环首 (取表项数 (), i)
    相加 (相减 (i, 1).取标题 (0), #换行符).加入文本 ()
.计次循环尾 ()
1.置文本 (“提取所有”)
赋值 (日志标记, 相加 (日志标记, 1))
相加 (到文本 (日志标记), “:提取所有项”, #换行符).加入项目 ()
赋值 (.起始选择位置, 1)

.子程序 _提取钩选项_被选择, 空白型, , 
.局部变量 i, 整数型, , , 

赋值 (.内容, “”)
.计次循环首 (取表项数 (), )
    .如果真 (等于 (相减 (i, 1).取当前状态图片 (), 1))
        相加 (相减 (1).取标题 (0), #换行符).加入文本 ()
    .如果真结束
    
.计次循环尾 ()
1.置文本 (“提取钩选项”)
赋值 (日志标记, 相加 (日志标记, 1))
相加 (到文本 (日志标记), “:提取钩选项”, #换行符).加入项目 ()
赋值 (.起始选择位置, 1)

.子程序 _提取目录树_被选择, 空白型, , 
.局部变量 i, 整数型, , , 

赋值 (.内容, “”)
.计次循环首 (取项目数 (), i)
    相加 (相减 (i, 1).取项目文本 (), #换行符).加入文本 ()
.计次循环尾 ()
1.置文本 (“提取目录树”)
赋值 (日志标记, 相加 (日志标记, 1))
相加 (到文本 (日志标记), “:提取目录树”, #换行符).加入项目 ()
赋值 (.起始选择位置, 1)

.子程序 _编辑框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

1.置文本 (“文本查看;为最终保存文本”)

.子程序 _编辑框1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (不等于 (.内容, “”))
    1.置文本 (“当前文本内容于列表项同”)
.否则
    1.置文本 (“”)
.如果结束


.子程序 _查找_被选择, 空白型, , 
载入 (查找窗口, _启动窗口, 真)

.子程序 _关于_被选择, 空白型, , 
载入 (关于窗口, , 真)

.窗口程序集 窗口程序集2, , , 

.子程序 _查找窗口_创建完毕, 空白型, , 
赋值 (.选中, 真)
赋值 (.内容, 寻找记录)
赋值 (.被选择字符数, -1)
赋值 (_启动窗口..起始选择位置, 0)

.子程序 _查找下一个_被单击, 空白型, , 
赋值 (寻找记录, .内容)
查找文本 (.内容)

.子程序 查找文本, 空白型, , 
.参数 查找内容, 文本型, , 

.局部变量 起始位置, 整数型, , , 
.局部变量 结束位置, 整数型, , , 
.局部变量 h, 整数型, , , 

.如果 (等于 (.内容, “”))
    返回 ()
.否则
    .如果 (等于 (.选中, 真))
        赋值 (起始位置, 相加 (起始位置, _启动窗口..起始选择位置, _启动窗口..被选择字符数, 1))
        赋值 (结束位置, 寻找文本 (_启动窗口..内容, .内容, 起始位置, 假))
    .否则
        赋值 (起始位置, 相减 (_启动窗口..起始选择位置, 起始位置, _启动窗口..被选择字符数, 1))
        赋值 (结束位置, 倒找文本 (_启动窗口..内容, .内容, 起始位置, 假))
    .如果结束
    .如果 (等于 (结束位置, -1))
        .如果 (等于 (信息框 (相加 (“文本:”, 查找内容, “未找到!是否从头找起?”), 68, “查找失败”), #是钮))
            赋值 (_启动窗口..起始选择位置, 0)
            查找文本 (.内容)
        .否则
            返回 ()
        .如果结束
        
    .否则
        赋值 (_启动窗口..起始选择位置, 相减 (结束位置, 1))
        赋值 (_启动窗口..被选择字符数, 取文本长度 (查找内容)) ' 显示找到的文本
        
    .如果结束
    
.如果结束


.子程序 _编辑框1_内容被改变, 空白型, , 
.如果 (不等于 (.内容, “”))
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
.如果结束


.子程序 _取消_被单击, 空白型, , 
查找窗口.销毁 ()

.子程序 _向上_被单击, 空白型, , 
.如果真 (等于 (.选中, 真))
    赋值 (_启动窗口..起始选择位置, -1)
.如果真结束


.窗口程序集 窗口程序集3, , , 

.子程序 _关于窗口_创建完毕, 空白型, , 
赋值 (.标题, 相加 (取空白文本 (16), “Ini手术室总述”, #换行符, #换行符, 取空白文本 (4), “Ini手术室是一个用于编辑ini格式的文件编辑器，它能够分析ini格式文件的内部结构，将文件里的各种信息归类、分组，显示出它的目录结构，从而可以方便的定位、查找您想要的信息。此外，它不仅可用于ini文件，而且支持任何结构与ini文件类似的文本文件。”))


 ' 不属于任何一个程序集、类模块的函数：
