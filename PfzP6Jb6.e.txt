 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.wodesoft.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.wodesoft.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.wodesoft.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 440
    高度 = 475
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “小路通讯录”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 244
    高度 = 287
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “管理”
    帮助文件名 = “”

窗口 窗口2
    左边 = 50
    顶边 = 50
    宽度 = 260
    高度 = 415
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “记录查找”
    帮助文件名 = “”



.常量 xiaolu, "“xiaolu”", , 
.常量 姓名, "“姓名”", , 
.常量 性别, "“性别”", , 
.常量 生日, "“生日”", , 
.常量 QQ号码, "“QQ号码”", , 
.常量 个人主页, "“个人主页”", , 
.常量 电话, "“电话”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 3 0 应用接口支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 2 0 扩展界面支持库二
 ' shellEx DA19AC3ADD2F4121AAD84AC5FBCAFC71 3 0 扩展功能支持库一




.全局变量 abc, 整数型, , , 

.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
 ' --========  易语言资源网  (www.wodesoft.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.wodesoft.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.wodesoft.com  ================--

 ' XP风格 (1)
.如果真 (等于 (文件是否存在 (相加 (取运行目录 (), “\xiaolu.edb”)), 假))
    新建易库 ()
.如果真结束
加入信息 ()

.子程序 加入信息, 空白型, , 
.局部变量 索引, 整数型, , , 

全部删除 ()
打开 (#xiaolu, , , , , , )
到首记录 ()
.计次循环首 (取记录数 (), )
    赋值 (索引, .插入表项 ())
    索引.置标题 (0, 读 (#姓名))
    索引.置标题 (1, 相加 (“ ”, 读 (#性别)))
    索引.置标题 (2, 读 (#电话))
    索引.置标题 (3, 读 (#生日))
    索引.置标题 (4, 读 (#QQ号码))
    索引.置标题 (5, 读 (#个人主页))
    跳过 () ' 本源码来自易语言资源网(www.wodesoft.com)
.计次循环尾 ()
赋值 (., “小路通讯录”)
赋值 (., 相加 (., “ - 当前共有”, 到文本 (取记录数 ()), “条通讯记录”))
关闭 ()

.子程序 _超级列表框1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()


.子程序 _删除记录_被选择, 空白型, , 
.如果真 (等于 (., -1))
    信息框 (“出错啦!请选择一个需要删除的通讯记录!”, #警告图标, )
    返回 ()
.如果真结束

.如果真 (等于 (信息框 (相加 (“你确认删除[”, .取标题 (., ), “]的通讯记录信息吗？”), 相加 (#警告图标, 1), ), #确认钮))
    打开 (#xiaolu, , , , , , )
    到首记录 ()
    跳到 (相加 (., 1))
     ' 本源码来自易语言资源网(www.wodesoft.com)
    删除 ()
    彻底删除 ()
    加入信息 ()
    关闭 ()
.如果真结束


.子程序 _添加记录_被选择, 空白型, , 
赋值 (abc, 1)
载入 (窗口1, , 假)


.子程序 _修改记录_被选择, 空白型, , 
.如果真 (等于 (., -1))
    信息框 (“出错啦!请选择一个需要修改的通讯记录!”, #警告图标, )
    返回 ()
.如果真结束
赋值 (abc, 2)
载入 (窗口1, , 假)
' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _超级列表框1_表项被激活, 空白型, , 
赋值 (abc, 4)
载入 (窗口1, , 真)

.子程序 新建易库, 空白型, , 
.局部变量 字段, 字段信息, , "6", 

赋值 (字段 [1].名称, #姓名)
赋值 (字段 [1].类型, #文本型)
赋值 (字段 [2].名称, #性别)
赋值 (字段 [2].类型, #文本型)
赋值 (字段 [3].名称, #电话)
赋值 (字段 [3].类型, #文本型)
赋值 (字段 [4].名称, #生日)
赋值 (字段 [4].类型, #文本型)
赋值 (字段 [5].名称, #QQ号码)
赋值 (字段 [5].类型, #文本型)
赋值 (字段 [6].名称, #个人主页)
赋值 (字段 [6].类型, #文本型)
.如果真 (等于 (创建 (相加 (取运行目录 (), “\xiaolu.edb”), 字段), 假))
    信息框 (“对不起!创建小路通讯录数据库失败!”, #警告图标, “出现错误”)
    结束 ()
.如果真结束


.子程序 __启动窗口_将被销毁, 空白型, , 
关闭 ()
结束 ()

.子程序 _即时聊天_被选择, 空白型, , 
.局部变量 号码, 文本型, , , 

.如果真 (等于 (., -1))
    信息框 (“出错啦!请选择一个好友的QQ号码!”, #警告图标, )
    返回 ()
.如果真结束
赋值 (号码, .取标题 (., 4))
.如果真 (等于 (号码, “”))
    .如果真 (等于 (信息框 (相加 (“对不起!该好友没有QQ号码记录,因此无法进行临时聊天!”, #换行符, #换行符, “你要现在添加[”, .取标题 (., 0), “]的QQ号码或修改其通讯信息吗?”), 相加 (#警告图标, 1), ), 0))
        _修改记录_被选择 ()
        赋值 (窗口1., 真)
        窗口1.获取焦点 (.)
    .如果真结束
    返回 ()
.如果真结束
未知支持库函数_56 (相加 (“tencent://message/?uin=”, 号码))

.子程序 _访问主页_被选择, 空白型, , 
.局部变量 主页, 文本型, , , 

.如果真 (等于 (., -1))
    信息框 (“出错啦!请选择一个好友的主页地址!”, #警告图标, )
    返回 ()
.如果真结束
赋值 (主页, .取标题 (., 5))
.如果真 (等于 (主页, “”))
    .如果真 (等于 (信息框 (相加 (“对不起!该好友没有个人主页记录,因此无法进行浏览!”, #换行符, #换行符, “你要现在添加[”, .取标题 (., 0), “]的主页地址或修改其通讯信息吗?”), 相加 (#警告图标, 1), ), 0))
        _修改记录_被选择 ()
        赋值 (窗口1., 真)
        窗口1.获取焦点 (.)
    .如果真结束
    返回 ()
.如果真结束
未知支持库函数_56 (主页)

.子程序 _搜索记录_被选择, 空白型, , 
载入 (窗口2, , 真)

.子程序 _超级列表框1_当前表项被改变, 空白型, , 
.局部变量 姓名, 文本型, , , 

赋值 (姓名, .取标题 (., 0))
未知支持库函数_0 (取窗口句柄 (), 相加 (“点击鼠标右键对[”, 姓名, “]的通讯记录进行相关操作”), 真, 假)

.子程序 _查看详细_被选择, 空白型, , 
.如果真 (等于 (., -1))
    信息框 (“出错啦!请选择一个需要查看的通讯记录!”, #警告图标, )
    返回 ()
.如果真结束
赋值 (abc, 4)
载入 (窗口1, , 假)


.窗口程序集 窗口程序集2, , , 

.子程序 _窗口1_创建完毕, 空白型, , 
.如果真 (等于 (abc, 1))
    赋值 (窗口1., “小路通讯录 - 添加信息”)
    赋值 (.现行选中项, 0)
.如果真结束

.如果真 (等于 (abc, 2))
    赋值 (窗口1., “小路通讯录 - 修改信息”)
    打开 (#xiaolu, , , , , , )
    到首记录 ()
    跳到 (相加 (_启动窗口.., 1))
    赋值 (.内容, 读 (#姓名))
    赋值 (.内容, 读 (#性别))
    赋值 (.内容, 读 (#生日))
    赋值 (.内容, 读 (#QQ号码))
    赋值 (.内容, 读 (#个人主页))
    赋值 (.内容, 读 (#电话))
    赋值 (.标题, “修改”)
.如果真结束
 ' 本源码来自易语言资源网(www.wodesoft.com)
.如果真 (等于 (abc, 3))
    打开 (#xiaolu, , , , , , )
    赋值 (窗口1., “小路通讯录 - 查看信息”)
    赋值 (.现行选中项, 0)
    跳到 (窗口2.取项目数值 (., 窗口2..现行选中项))
    赋值 (.内容, 读 (#姓名))
    赋值 (.内容, 读 (#性别))
    赋值 (.内容, 读 (#生日))
    赋值 (.内容, 读 (#QQ号码))
    赋值 (.内容, 读 (#个人主页))
    赋值 (.内容, 读 (#电话))
    赋值 (.标题, “确定”)
    赋值 (.标题, “退出”)
.如果真结束

.如果真 (等于 (abc, 4))
    打开 (#xiaolu, , , , , , )
    赋值 (窗口1., “小路通讯录 - 查看信息”)
    赋值 (.现行选中项, 0)
    跳到 (相加 (_启动窗口.., 1))
    赋值 (.内容, 读 (#姓名))
    赋值 (.内容, 读 (#性别))
    赋值 (.内容, 读 (#生日))
    赋值 (.内容, 读 (#QQ号码))
    赋值 (.内容, 读 (#个人主页))
    赋值 (.内容, 读 (#电话))
    赋值 (.标题, “确定”)
    赋值 (.标题, “退出”)
.如果真结束
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _按钮1_被单击, 空白型, , 
.如果 (等于 (.内容, “”))
    信息框 (“出错啦!你忘记写好友的名字了啦!”, #警告图标, )
    返回 ()
.否则
    
.如果结束

.如果真 (等于 (abc, 1))
    打开 (#xiaolu, , , , , , )
    到尾记录 ()
    .如果真 (等于 (加记录 (.内容, .内容, .内容, .内容, .内容, .内容), 假))
        信息框 (“对不起!添加通讯记录失败!”, #警告图标, “错误”)
    .如果真结束
     ' 本源码来自易语言资源网(www.wodesoft.com)
    .如果 (等于 (信息框 (“添加通讯记录成功，您还要继续添加吗？”, 相加 (#信息图标, 1, 256), ), #确认钮))
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        返回 ()
    .否则
        关闭 ()
        销毁 ()
    .如果结束
    
.如果真结束

.如果真 (等于 (abc, 2))
    .如果真 (等于 (修改 (.内容, .内容, .内容, .内容, .内容, .内容), 假))
        信息框 (“对不起!修改通讯记录失败!”, #错误图标, “错误”)
        返回 ()
    .如果真结束
    信息框 (“恭喜!修改通讯记录成功!”, 64, )
    销毁 ()
.如果真结束

.如果真 (或者 (等于 (abc, 3), 等于 (abc, 4)))
    销毁 ()
.如果真结束


.子程序 _窗口1_将被销毁, 空白型, , 
.如果真 (并且 (不等于 (abc, 3), 不等于 (abc, 4)))
    加入信息 ()
.如果真结束
' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _按钮2_被单击, 空白型, , 
赋值 (abc, 3)
销毁 ()

.窗口程序集 窗口程序集3, , , 

.程序集变量 i, 整数型, , , 
.子程序 _列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (abc, 3)
载入 (窗口1, , 真)

.子程序 _查看详细_被选择, 空白型, , 
赋值 (abc, 3)
载入 (窗口1, , 真)

.子程序 _退出搜索_被选择, 空白型, , 
销毁 ()

.子程序 _编辑框1_内容被改变, 空白型, , 
.局部变量 格式, 未知类型0x40004, , , 
.局部变量 a, 整数型, , , 
.局部变量 输入字符数, 整数型, , , 
.局部变量 索引, 整数型, , , 

打开 (#xiaolu, , , , , , )
清空 ()
到首记录 ()
.如果真 (等于 (.内容, “”))
    返回 ()
.如果真结束
 ' 本源码来自易语言资源网(www.wodesoft.com)


.计次循环首 (取记录数 (), i)
    .如果 (或者 (不等于 (寻找文本 (取首拼音 (读 (#姓名)), .内容, , 真), -1), 近似等于 (删全部空 (读 (#姓名)), .内容), 近似等于 (.内容, 读 (#姓名))))
        相加 (“姓名:”, 读 (#姓名)).加入项目 (i)
         ' 列表框1.加入项目 (“姓名:” ＋ 读 (#姓名) ＋ “  -  性别:” ＋ 读 (#性别) ＋ “  -  电话:” ＋ 读 (#电话) ＋ “  -  生日:” ＋ 读 (#生日) ＋ “  -  QQ:” ＋ 读 (#QQ号码) ＋ “  -  个人主页:” ＋ 读 (#性别), i)
    .否则
        
    .如果结束
    跳过 ()
.计次循环尾 ()
到首记录 ()
.如果 (等于 (取项目数 (), 0))
    赋值 (., “对不起!没有任何符合搜索要求的通讯记录!”)
.否则
    .如果 (等于 (取项目数 (), 1))
        赋值 (., “只有一条通讯记录符合搜索要求”)
    .否则
        赋值 (., 相加 (“有”, 到文本 (取项目数 ()), “条通讯记录符合搜索要求”))
    .如果结束
     ' 列表框1.现行选中项 ＝ 0
    跳到 (0.取项目数值 ())
.如果结束
关闭 ()


.子程序 取首拼音, 文本型, , 
.参数 文本, 文本型, , 

.局部变量 cd, 空白型, , , 
.局部变量 k, 空白型, , , 
.局部变量 py, 文本型, , , 
.局部变量 字符, 文本型, , , 

赋值 (cd, 取文本长度 (文本))
.判断循环首 (小于或等于 (k, cd))
    赋值 (k, 相加 (k, 1))
    .如果真 (小于 (取代码 (取文本中间 (文本, k, 1), ), 0))
        赋值 (字符, 取文本中间 (文本, k, 2))
        .如果 (等于 (取拼音 (字符, 1), “”))
            赋值 (py, 相加 (py, 字符))
        .否则
            赋值 (py, 相加 (py, 取文本左边 (取声母 (字符, 1), 1)))
        .如果结束
        赋值 (k, 相加 (k, 1))
        到循环尾 ()
    .如果真结束
    赋值 (py, 相加 (py, 取文本中间 (文本, k, 1)))
.判断循环尾 ()
返回 (py)

.子程序 _窗口2_创建完毕, 空白型, , 
' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _列表框1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _编辑框1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

未知支持库函数_0 (取窗口句柄 (), “说明:如果要搜索[小路]那么直接输入[小,小路,X,XL]均可”, 真, 假)

.子程序 _列表框1_列表项被选择, 空白型, , 
.局部变量 姓名, 文本型, , , 

赋值 (姓名, 子文本替换 (.取项目文本 (.现行选中项), “姓名:”, “”, , , 真))
未知支持库函数_0 (取窗口句柄 (), 相加 (“直接鼠标双击可查看[”, 姓名, “]的详细记录”), 真, 假)

.子程序 _标签1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

未知支持库函数_0 (取窗口句柄 (), “说明:如果要搜索[小路]那么直接输入[小,小路,X,XL]均可”, 真, 假)


 ' 不属于任何一个程序集、类模块的函数：
