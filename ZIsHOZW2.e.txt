 ' 文件类型：Windows窗口程序

 ' 程序名称：定时音乐播放器
 ' 程序描述：本程序主要功能是可以定时播放影音，省去人力资源。
@备注:
写于2009年8月1日
 ' 程序作者：飘渺
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.wodesoft.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.wodesoft.com  =============--
 ' 版本号：1.0
 ' 创建号：1.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 299
    高度 = 219
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 3
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 已保存到：D:\易语言学习\Data\ZIsHOZW2.e\_启动窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “定 时 音 乐 播 放 器 V1.0”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 2 0 扩展界面支持库二



 ' 所需要的模块
 ' 时间转换 C:\Documents and Settings\Administrator\桌面\时间转换模块.ec



.DLL命令 置窗口特征, 子程序指针, "user32.dll", "SetWindowLongA", , 
    .参数 窗口句柄, 整数型, , 
    .参数 特征索引, 整数型, , 
    .参数 新特征, 子程序指针, , 

.DLL命令 SendMessageCallback, 空白型, "user32.dll", "SendMessageCallbackA", , 
    .参数 hWnd, 空白型, , 
    .参数 Msg, 空白型, , 
    .参数 wParam, 空白型, , 
    .参数 IParam, 空白型, , 
    .参数 IpResultCallBack, 子程序指针, , 
    .参数 dwData, 空白型, , 

.DLL命令 RegisterHotKey, 整数型, "user32.dll", "RegisterHotKey", , 
    .参数 hWnd, 整数型, , 
    .参数 id, 整数型, , 
    .参数 fsModifoers, 整数型, , 
    .参数 vk, 整数型, , 

.DLL命令 执行窗口程序, 整数型, "user32.dll", "CallWindowProcA", , 
    .参数 窗口程序程序指针, 子程序指针, , 
    .参数 窗口句柄, 整数型, , 
    .参数 消息, 整数型, , 
    .参数 参数1, 整数型, , 
    .参数 参数2, 整数型, , 

.DLL命令 UnregisterHotKey, 整数型, "user32.dll", "UnregisterHotKey", , 
    .参数 hWnd, 整数型, , 
    .参数 id, 整数型, , 

.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
 ' --========  易语言资源网  (www.wodesoft.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.wodesoft.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.wodesoft.com  ================--

初始化设置 ()
加入启动 ()

.子程序 初始化设置, 空白型, , 
.局部变量 窗口可视信息, 文本型, , , 

_启动窗口.获取焦点 ()
赋值 (.时钟周期, 3000)
注册热键_ (_启动窗口.取窗口句柄 (), 2, #Q键, &窗口隐藏)
 ' 设置通用对话框
赋值 (.类型, 0)
赋值 (.标题, “请选择需要的文件：”)
赋值 (.过滤器, “音乐文件(*.MP3)|*.MP3|所有文件(*.*)|*.*”)
赋值 (.初始目录, 取运行目录 ())
 ' 本源码来自易语言资源网(www.wodesoft.com)
 ' 窗口属性设置
赋值 (窗口可视信息, 读配置项 (相加 (取运行目录 (), “\note.ini”), “显示控制”, “可视”, ))
.如果真 (等于 (窗口可视信息, “”))
    赋值 (_启动窗口., 真)
    写配置项 (相加 (取运行目录 (), “\note.ini”), “显示控制”, “可视”, “真”)
.如果真结束
.如果真 (等于 (窗口可视信息, “真”))
    赋值 (_启动窗口., 真)
.如果真结束
.如果真 (等于 (窗口可视信息, “假”))
     ' _启动窗口.可视 ＝ 假
.如果真结束
.如果真 (并且 (不等于 (窗口可视信息, “真”), 不等于 (窗口可视信息, “假”)))
    赋值 (_启动窗口., 真)
    写配置项 (相加 (取运行目录 (), “\note.ini”), “显示控制”, “可视”, “真”)
.如果真结束
 ' 本源码来自易语言资源网(www.wodesoft.com)
 ' 读取一些设置
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\note.ini”), “播放控制”, “音乐时间1”, ))
时间调节 (0)
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\note.ini”), “播放控制”, “音乐时间2”, ))
时间调节 (0)
赋值 (.标题, 读配置项 (相加 (取运行目录 (), “\note.ini”), “播放控制”, “音乐文件名1”, ))
赋值 (.标题, 读配置项 (相加 (取运行目录 (), “\note.ini”), “播放控制”, “音乐文件名2”, ))
赋值 (.标记, 读配置项 (相加 (取运行目录 (), “\note.ini”), “播放控制”, “音乐文件路径1”, ))
赋值 (.标记, 读配置项 (相加 (取运行目录 (), “\note.ini”), “播放控制”, “音乐文件路径2”, ))
.如果真 (等于 (文件是否存在 (.标记), 假))
    写配置项 (相加 (取运行目录 (), “\note.ini”), “播放控制”, “音乐文件名1”, “”)
    写配置项 (相加 (取运行目录 (), “\note.ini”), “播放控制”, “音乐文件路径1”, “”)
    赋值 (.标题, “”)
    赋值 (.标记, “”)
.如果真结束
.如果真 (等于 (文件是否存在 (.标记), 假))
    写配置项 (相加 (取运行目录 (), “\note.ini”), “播放控制”, “音乐文件名2”, “”)
    写配置项 (相加 (取运行目录 (), “\note.ini”), “播放控制”, “音乐文件路径2”, “”)
    赋值 (.标题, “”)
    赋值 (.标记, “”)
.如果真结束
 ' 本源码来自易语言资源网(www.wodesoft.com)


.子程序 加入启动, 空白型, , 
.局部变量 当前注册信息, 文本型, , , 

赋值 (当前注册信息, 取文本注册项 (#本地机器, “SOFTWARE\Microsoft\Windows\CurrentVersion\Run\自动播放音乐”, ))
.如果真 (等于 (当前注册信息, “”))
    写注册项 (#本地机器, “SOFTWARE\Microsoft\Windows\CurrentVersion\Run\自动播放音乐”, 相加 (取运行目录 (), “\”, 取执行文件名 ()))
.如果真结束
.如果真 (不等于 (当前注册信息, 相加 (取运行目录 (), “\”, 取执行文件名 ())))
    删除注册项 (#本地机器, “SOFTWARE\Microsoft\Windows\CurrentVersion\Run\自动播放音乐”)
    写注册项 (#本地机器, “SOFTWARE\Microsoft\Windows\CurrentVersion\Run\自动播放音乐”, 相加 (取运行目录 (), “\”, 取执行文件名 ()))
.如果真结束
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 窗口隐藏, 空白型, , 
.如果 (等于 (_启动窗口., 假))
    赋值 (_启动窗口., 真)
    写配置项 (相加 (取运行目录 (), “\note.ini”), “显示控制”, “可视”, “真”)
.否则
    赋值 (_启动窗口., 假)
    写配置项 (相加 (取运行目录 (), “\note.ini”), “显示控制”, “可视”, “假”)
.如果结束
_启动窗口.获取焦点 ()

.子程序 _编辑框1_调节钮被按下, 空白型, , 
.参数 按钮值, 整数型, , 

时间调节 (按钮值)
写配置项 (相加 (取运行目录 (), “\note.ini”), “播放控制”, “音乐时间1”, .内容)
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _编辑框2_调节钮被按下, 空白型, , 
.参数 按钮值, 整数型, , 

时间调节 (按钮值)
写配置项 (相加 (取运行目录 (), “\note.ini”), “播放控制”, “音乐时间2”, .内容)
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _时钟1_周期事件, 空白型, , 
赋值 (.时钟周期, 3000)
.如果真 (等于 (时间格式化 (取现行时间 (), 2), .内容))
    播放MP3 (1, .标记)
    赋值 (.时钟周期, 相乘 (3, 60, 1000))
.如果真结束
.如果真 (等于 (时间格式化 (取现行时间 (), 2), .内容))
    播放MP3 (1, .标记)
    赋值 (.时钟周期, 相乘 (3, 60, 1000))
.如果真结束
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 __启动窗口_将被销毁, 空白型, , 
取消热键_ (_启动窗口.取窗口句柄 ())


.子程序 _编辑框1_失去焦点, 空白型, , 
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\note.ini”), “播放控制”, “音乐时间1”, ))
时间调节 (0)


.子程序 _编辑框2_失去焦点, 空白型, , 
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\note.ini”), “播放控制”, “音乐时间2”, ))
时间调节 (0)

.子程序 _音乐按钮1_被单击, 空白型, , 
.如果真 (等于 (打开 (), 真))
    赋值 (.标题, 找文件名 (.文件名))
    赋值 (.标记, .文件名)
    写配置项 (相加 (取运行目录 (), “\note.ini”), “播放控制”, “音乐文件名1”, 找文件名 (.文件名))
    写配置项 (相加 (取运行目录 (), “\note.ini”), “播放控制”, “音乐文件路径1”, .文件名)
.如果真结束
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _音乐按钮2_被单击, 空白型, , 
.如果真 (等于 (打开 (), 真))
    赋值 (.标题, 找文件名 (.文件名))
    赋值 (.标记, .文件名)
    写配置项 (相加 (取运行目录 (), “\note.ini”), “播放控制”, “音乐文件名2”, 找文件名 (.文件名))
    写配置项 (相加 (取运行目录 (), “\note.ini”), “播放控制”, “音乐文件路径2”, .文件名)
.如果真结束


.子程序 _编辑框1_内容被改变, 空白型, , 
写配置项 (相加 (取运行目录 (), “\note.ini”), “播放控制”, “音乐时间1”, .内容)
' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _编辑框2_内容被改变, 空白型, , 
写配置项 (相加 (取运行目录 (), “\note.ini”), “播放控制”, “音乐时间2”, .内容)

.子程序 _帮助按钮_被单击, 空白型, , 
信息框 (“使用 Ctrl+Q 组合键，可显示\隐藏窗口！”, 64, “小提示”)

.子程序 _最小化按钮_被单击, 空白型, , 
赋值 (_启动窗口., 2)

.子程序 _关闭按钮_被单击, 空白型, , 
_启动窗口.销毁 (真)


.程序集 注册热键程序集, , , 

.程序集变量 原窗口句柄, 整数型, , , 
.程序集变量 默认窗口程序, 子程序指针, , , 
.程序集变量 热键处理子程序, 子程序指针, , , 
.程序集变量 新窗口程序指针, 子程序指针, , , 
.子程序 注册热键_, 整数型, 公开, 成功返回非零,失败返回零.
.参数 窗口句柄, 整数型, , 
.参数 功能键状态, 整数型, , 1、Alt；2、Ctrl；4、Shitf；8、Win。
.参数 一般键, 整数型, , 
.参数 热键处理子程序指针, 子程序指针, , 当按下热键时要处理的子程序

.局部变量 是否成功, 整数型, , , 

赋值 (是否成功, RegisterHotKey (窗口句柄, 786, 功能键状态, 一般键))
.如果 (不等于 (是否成功, 0))
     ' 本源码来自易语言资源网(www.wodesoft.com)
.否则
    返回 (0)
.如果结束
赋值 (默认窗口程序, 置窗口特征 (窗口句柄, -4, &新窗口程序))
赋值 (热键处理子程序, 热键处理子程序指针)
赋值 (新窗口程序指针, &新窗口程序)
赋值 (原窗口句柄, 窗口句柄)
返回 (1)

.子程序 新窗口程序, 整数型, , 
.参数 窗口句柄, 整数型, , 
.参数 消息, 整数型, , 
.参数 参数1, 整数型, , 
.参数 参数2, 整数型, , 

.如果 (等于 (消息, 786))
    SendMessageCallback (窗口句柄, 0, 0, 0, 热键处理子程序, 0)
    ' 本源码来自易语言资源网(www.wodesoft.com)
.否则
    
.如果结束
返回 (执行窗口程序 (默认窗口程序, 窗口句柄, 消息, 参数1, 参数2)) ' 把不需要处理的消息传递给默认窗口处理程序，使窗口能正常响应消息

.子程序 取消热键_, 整数型, 公开, 成功返回非零,失败返回零.
.参数 窗口句柄, 整数型, , 

置窗口特征 (原窗口句柄, -4, 默认窗口程序)
返回 (UnregisterHotKey (窗口句柄, 786))

.程序集 常用操作, , , 

.子程序 时间调节, 空白型, , 
.参数 编辑框, 编辑框, , 
.参数 增减时间, 整数型, , 正为时间递增，负为时间递减,零为不变。

.局部变量 未选择的文本, 文本型, , , 
.局部变量 调整后的时间, 文本型, , , 
.局部变量 数组, 文本型, , "0", 
.局部变量 时, 文本型, , , 
.局部变量 分, 文本型, , , 

 ' 初始编辑框设置
赋值 (编辑框.调节器方式, 2)
赋值 (编辑框.输入方式, 0)
赋值 (编辑框.最大允许长度, 5)
赋值 (编辑框.宽度, 40)
赋值 (数组, 分割文本 (编辑框.内容, “:”, ))
.如果真 (不等于 (取数组成员数 (数组), 2))
    赋值 (时, 到文本 (取小时 (取现行时间 ())))
    赋值 (分, 到文本 (取分钟 (取现行时间 ())))
    .如果真 (等于 (取文本长度 (时), 1))
        赋值 (时, 相加 (“0”, 时))
    .如果真结束
    .如果真 (等于 (取文本长度 (时), 0))
        赋值 (时, 相加 (“0”, “0”))
    .如果真结束
    .如果真 (等于 (取文本长度 (分), 1))
        赋值 (分, 相加 (“0”, 分))
    .如果真结束
    .如果真 (等于 (取文本长度 (分), 0))
        赋值 (分, 相加 (“0”, “0”))
    .如果真结束
    赋值 (编辑框.内容, 相加 (时, “:”, 分))
.如果真结束
.如果真 (或者 (等于 (编辑框.起始选择位置, 0), 等于 (编辑框.起始选择位置, 1), 等于 (编辑框.起始选择位置, 2)))
    赋值 (编辑框.起始选择位置, 0)
    赋值 (编辑框.被选择字符数, 2)
    赋值 (未选择的文本, 子文本替换 (编辑框.内容, 编辑框.被选择文本, “”, , 1, 假))
    赋值 (调整后的时间, 到文本 (相加 (到整数 (编辑框.被选择文本), 增减时间)))
    .如果真 (等于 (调整后的时间, “-1”))
        赋值 (调整后的时间, “24”)
    .如果真结束
    .如果真 (等于 (调整后的时间, “25”))
        赋值 (调整后的时间, “00”)
    .如果真结束
    .如果真 (等于 (取文本长度 (调整后的时间), 1))
        赋值 (调整后的时间, 相加 (“0”, 调整后的时间))
    .如果真结束
    赋值 (编辑框.内容, 相加 (调整后的时间, 未选择的文本))
    赋值 (编辑框.起始选择位置, 0)
    赋值 (编辑框.被选择字符数, 2)
.如果真结束
.如果真 (或者 (等于 (编辑框.起始选择位置, 3), 等于 (编辑框.起始选择位置, 4), 等于 (编辑框.起始选择位置, 5)))
    赋值 (编辑框.起始选择位置, 3)
    赋值 (编辑框.被选择字符数, 2)
    赋值 (未选择的文本, 文本替换 (编辑框.内容, 4, 2, “”))
    赋值 (调整后的时间, 到文本 (相加 (到整数 (编辑框.被选择文本), 增减时间)))
    .如果真 (等于 (调整后的时间, “-1”))
        赋值 (调整后的时间, “59”)
    .如果真结束
    .如果真 (等于 (调整后的时间, “60”))
        赋值 (调整后的时间, “00”)
    .如果真结束
    .如果真 (等于 (取文本长度 (调整后的时间), 1))
        赋值 (调整后的时间, 相加 (“0”, 调整后的时间))
    .如果真结束
    赋值 (编辑框.内容, 相加 (未选择的文本, 调整后的时间))
    赋值 (编辑框.起始选择位置, 3)
    赋值 (编辑框.被选择字符数, 2)
.如果真结束
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 找文件名, 文本型, , 找文件全路径的中的文件名
.参数 全路径, 文本型, , 

.局部变量 变量, 文本型, , "0", 

赋值 (变量, 分割文本 (全路径, “\”, ))
.如果真 (等于 (取数组成员数 (变量), 0))
    返回 (“”)
.如果真结束
返回 (变量 [取数组成员数 (变量)])
 ' 本源码来自易语言资源网(www.wodesoft.com)


.子程序 找路径, 文本型, , 查找文件路径
.参数 文件路径, 文本型, , 文件的位置

.局部变量 路径数组, 文本型, , "0", 
.局部变量 路径, 文本型, , , 
.局部变量 计次, 整数型, , , 

清除数组 (路径数组)
赋值 (路径数组, 分割文本 (文件路径, “\”, ))
.计次循环首 (相减 (取数组成员数 (路径数组), 1), 计次)
    .如果真 (等于 (计次, 1))
        赋值 (路径, 路径数组 [计次])
    .如果真结束
    .如果真 (大于 (计次, 1))
        赋值 (路径, 相加 (路径, “\”, 路径数组 [计次]))
    .如果真结束
    ' 本源码来自易语言资源网(www.wodesoft.com)
.计次循环尾 ()
返回 (路径)

.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 日期格式化, 文本型, , 把易语言的时间格式化成各种日期类型，如果返回类型不正确，将返回空文本。
.参数 日期, 日期时间型, , 所提供的时间
.参数 返回类型, 整数型, , 返回后的时间类型。1、yyyy-MM-dd；



.子程序 星期格式化, 文本型, , 把易语言的时间格式化成星期类型，如果返回类型不正确，将返回空文本。
.参数 日期, 日期时间型, , 所提供的时间
.参数 返回类型, 整数型, , 返回后的时间类型。1、星期几-简体；2、星期几-繁体



.子程序 时间格式化, 文本型, , 把易语言的时间格式化成各种时间类型，如果返回类型不正确，将返回空文本。
.参数 日期, 日期时间型, , 所提供的时间
.参数 返回类型, 整数型, , 返回后的时间类型。1、HH：mm：ss；2、HH：mm




 ' 不属于任何一个程序集、类模块的函数：
