 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 622
    高度 = 482
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “读取网页源码例程”
    帮助文件名 = “”



.常量 GET, "0", , 
.常量 POST, "1", , 
.常量 cp_gb2312, "936", , 
.常量 CP_UTF8, "65001", , 
.常量 CP_UTF7, "65000", , 
.常量 CP_ACP, "0", , 
.常量 CP_MACCP, "2", , 
.常量 CP_OEMCP, "1", , 
.常量 CP_THREAD_ACP, "3", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' RegEx 684944CB04624eb7BD5412A519421D34 1 2 正则表达式支持库




数据类型 数据合并类型, , 
    .成员 是否数据合并, 逻辑型, , , 
    .成员 数据合并网页内容数组, 字节集, , "1", 
    .成员 数据合并下载完成, 逻辑型, , , 

数据类型 位置计次, , 
    .成员 位置, 整数型, , , 
    .成员 次数, 整数型, , , 

数据类型 一级任务, , 
    .成员 配置文件, 文本型, , , 
    .成员 零级任务, 采集网页, , "1", 

数据类型 数据项, 公开, 
    .成员 附加数据项页面类型, 文本型, , , 
    .成员 直接导入数据库, 逻辑型, , , 
    .成员 附加数据站点源文件, 文本型, , , 
    .成员 附加数据网址数组, 文本型, , "1", 
    .成员 二级分类起始关键字编辑框, 文本型, , , 
    .成员 二级分类结束关键字编辑框, 文本型, , , 
    .成员 DIV结束关键字编辑框, 文本型, , , 
    .成员 DIV起始关键字编辑框, 文本型, , , 
    .成员 相对路径编辑框, 文本型, , , 
    .成员 内容起始编辑框, 文本型, , , 
    .成员 内容结束编辑框, 文本型, , , 
    .成员 过滤网址编辑框, 文本型, , , 
    .成员 结束重复编辑框, 文本型, , , 
    .成员 下载图片选择框, 逻辑型, , , 
    .成员 替换选择框1, 逻辑型, , , 
    .成员 替换开始标志编辑框, 文本型, , , 
    .成员 上面选择框, 逻辑型, , , 
    .成员 下面选择框, 逻辑型, , , 
    .成员 数据合并编辑框, 文本型, , , 
    .成员 数据合并编辑框2, 文本型, , , 
    .成员 被替换编辑框3, 文本型, , , 
    .成员 替换编辑框1, 文本型, , , 
    .成员 地址栏, 文本型, , , 
    .成员 div中采集网址标签框, 文本型, , , 
    .成员 数据项名编辑框, 文本型, , , 
    .成员 栏目编辑框, 文本型, , , 
    .成员 文件名编辑框, 文本型, , , 
    .成员 div网址单选框, 逻辑型, , , 
    .成员 div内容单选框, 逻辑型, , , 
    .成员 重复结束编辑框, 整数型, , , 
    .成员 重复开始编辑框, 整数型, , , 
    .成员 div网址起始关键字编辑框, 文本型, , , 
    .成员 div网址结束关键字编辑框, 文本型, , , 
    .成员 图片文件夹路径, 文本型, , , 
    .成员 下一页正则表达式, 文本型, , , 
    .成员 获得下一页次数, 文本型, , , 
    .成员 起始正则选择框, 逻辑型, , , 
    .成员 结束正则选择框, 逻辑型, , , 
    .成员 频道编辑框, 文本型, , , 
    .成员 匿名成员342, 空白型, , , 
    .成员 真实数据项名, 文本型, , , 
    .成员 自定义数据项名, 文本型, , , 
    .成员 自定义值, 文本型, , , 
    .成员 请求组, 网页请求, , , 

数据类型 程序结果变量, , 
    .成员 附加数据一个一个采集网址数组, 文本型, , "1", 跨一次采集过程，所以为程序结果变量
    .成员 附加数据一个一个采集源文件, 文本型, , , 
    .成员 一级网址数组, 文本型, , "1", 
    .成员 一级网址源文件, 文本型, , "1", 
    .成员 一级网址数组计次, 整数型, , , 
    .成员 post地址栏, 文本型, , , 

数据类型 采集网页, , 
    .成员 采集网址, 文本型, , , 程序自己定义,0级网址的数目
    .成员 POST内容, 文本型, , , 
    .成员 主采集内容, 文本型, , , 同上
    .成员 介绍, 文本型, , , 
    .成员 get内容, 文本型, , , 临时保存get内容
    .成员 采集站点源文件, 文本型, , , 
    .成员 是否数据合并, 逻辑型, , , 
    .成员 数据合并网址, 文本型, , "1", 
    .成员 数据合并源文件, 文本型, , "1", 
    .成员 数据合并内容, 文本型, , "1", 
    .成员 数据合并下载完成, 逻辑型, , , 
    .成员 附加内容, 文本型, , "1", 数据项有多个，所以要用数组
    .成员 数据合并准备状态, 文本型, , , 
    .成员 标题图片地址, 文本型, , , phpcms数据结构，
    .成员 副标题, 文本型, , , 
    .成员 备份标题, 文本型, , , 
    .成员 启动下载图片, 逻辑型, , , 
    .成员 主采集Internet句柄, 整数型, , , 
    .成员 主采集站点域名, 文本型, , , 
    .成员 主采集Internet连接句柄, 整数型, , , 
    .成员 保存设置数据项, 数据项, , "1", 
    .成员 备份下载图片数据合并网址数组, 文本型, , "1", 
    .成员 发布站点, 文本型, , , 
    .成员 文章id, 整数型, , , 
    .成员 发布时间, 文本型, , , 
    .成员 post地址栏, 文本型, , , 
    .成员 bPost登录句柄, 空白型, , , 
    .成员 post登录地址, 文本型, , , 
    .成员 登录关键字, 文本型, , , 
    .成员 post数据, 文本型, , , 
    .成员 数据项关键字组post, 文本型, 传址, "1", 字段,数据项
    .成员 相应发布内容组post, 文本型, 传址, "1", 
    .成员 MySql句柄, 整数型, , , 
    .成员 数据库名, 文本型, , , 
    .成员 站点名, 文本型, , , 
    .成员 配置文件路径, 文本型, , , 
    .成员 查找错误文件名, 文本型, , , 
    .成员 递归襄套控制, 整数型, , , 
    .成员 测试一级网址, 逻辑型, , , 
    .成员 测试模式, 逻辑型, , , 
    .成员 测试已测试记录数, 整数型, , , 
    .成员 测试襄套控制, 整数型, , , 
    .成员 当前操作项, 整数型, , , 
    .成员 操作数据框, 文本型, , , 
    .成员 已采集文件号, 空白型, , , 
    .成员 post失败网页文件号, 空白型, , , 
    .成员 post失败文件号, 空白型, , , 
    .成员 post成功文件号, 空白型, , , 
    .成员 程序运行日志文件号, 空白型, , , 
    .成员 级数, 空白型, , , 附加采集,级数＝2为采集网址
    .成员 目标级数, 空白型, , "1", 
    .成员 附加采集数据, 字节集, , "1", 
    .成员 程序结果, 程序结果变量, , , 
    .成员 附加数据一个一个采集网址数组, 文本型, , "1", 跨一次采集过程，所以为程序结果变量
    .成员 附加数据一个一个采集源文件, 文本型, , , 
    .成员 附加数据一个一个采集换页, 逻辑型, , , 
    .成员 重复开始, 空白型, , , 附加采集
    .成员 重复采集起始位置, 空白型, , , 
    .成员 全局数组位置, 整数型, , , 
    .成员 采集完成, 逻辑型, , , 
    .成员 数据组, 数据项组, , "1", 多个配置文件
    .成员 发布请求, 网页请求, , , 元素
    .成员 数据项组成员计次, 空白型, , , 当前对应的数据项文件,为0则原始采集.没到数据项组配置
    .成员 数据项组保存类型, 整数型, , , 1累加,2发送累加,3,清空,4.发送不累加,5其他
    .成员 真实数据项名, 文本型, , "1", 
    .成员 自定义数据项名, 文本型, , "1", 
    .成员 自定义值, 文本型, , "1", 
    .成员 数据项顺序位置数组, 整数型, , "1", 

数据类型 最终数据, , 
    .成员 页面内容, 字节集, , "1", 
    .成员 保存设置数据项, 数据项, , "1", 
    .成员 get内容, 文本型, , , 
    .成员 采集站点源文件, 文本型, , , 
    .成员 div采集网址数组, 文本型, , "1", 
    .成员 级数, 整数型, , , 
    .成员 重复开始, 整数型, , , 
    .成员 程序结果, 程序结果变量, , , 
    .成员 ping值, 整数型, , , 
    .成员 数据合并网址数组, 文本型, , "1", 
    .成员 线程数, 整数型, , , 
    .成员 许可证, 整数型, , , 
    .成员 每个线程分到网页数, 整数型, , , 线程
    .成员 余数, 整数型, , , 线程
    .成员 网页采集源文件网址, 采集网页, , "1", 
    .成员 线程完成标记, 逻辑型, , "1", 
    .成员 递归襄套控制, 整数型, , , 
    .成员 最后一个线程, 逻辑型, , , 
    .成员 全线程下载完成, 逻辑型, , "1", 
    .成员 重复采集起始位置, 整数型, , , 
    .成员 附加数据一个一个采集换页, 逻辑型, , , 
    .成员 登陆加post步骤, 整数型, , , 
    .成员 POST内容, 文本型, , , 
    .成员 备份下载图片数据合并网址数组, 文本型, , "1", 
    .成员 主采集站点域名, 文本型, , , 
    .成员 测试模式, 逻辑型, , , 
    .成员 测试文件号, 整数型, , , 
    .成员 测试, 文本型, , "1", 
    .成员 测试记录数据数, 整数型, , , 
    .成员 测试已测试记录数, 整数型, , , 
    .成员 操作数据框, 文本型, , , 
    .成员 当前操作项, 整数型, , , 
    .成员 测试襄套控制, 整数型, , , 
    .成员 可以采集文件号, 整数型, , , 
    .成员 程序路径, 文本型, , , 
    .成员 是否修改, 逻辑型, , , 
    .成员 是否修改框, 文本型, , , 
    .成员 测试网址, 逻辑型, , , 
    .成员 启动下载图片, 逻辑型, , , 
    .成员 当前数据项, 整数型, , , 
    .成员 当前网页, 整数型, , , 
    .成员 本地路径起始位置, 整数型, , , 
    .成员 临时图片文件夹路径, 文本型, , , 
    .成员 调试计次, 整数型, , , 
    .成员 文章id, 整数型, , , 

数据类型 搜索, 公开, 
    .成员 文本, 文本型, , , 搜索到的文本
    .成员 位置, 整数型, , , 搜索到的位置

数据类型 HTMLDocumentEvents2, 公开, 先不用，可以就删除
    .成员 OnHelp, 子程序指针, , , VARIANT_BOOL OnHelp(IHTMLEventObj *pEvtObj);
    .成员 OnClick, 子程序指针, , , VARIANT_BOOL OnClick(IHTMLEventObj *pEvtObj);
    .成员 OnDblClick, 子程序指针, , , VARIANT_BOOL OnDblClick(IHTMLEventObj *pEvtObj);
    .成员 OnKeyDown, 子程序指针, , , void OnKeyDown(IHTMLEventObj *pEvtObj);//No return value.
    .成员 OnKeyUp, 子程序指针, , , void OnKeyUp(IHTMLEventObj *pEvtObj);//No return value.
    .成员 OnKeyPress, 子程序指针, , , VARIANT_BOOL OnKeyPress(IHTMLEventObj *pEvtObj);
    .成员 OnMouseDown, 子程序指针, , , void OnMouseDown(IHTMLEventObj *pEvtObj);//No return value.
    .成员 OnMouseMove, 子程序指针, , , void OnMouseMove(IHTMLEventObj *pEvtObj);//No return value.
    .成员 OnMouseUp, 子程序指针, , , void OnMouseUp(IHTMLEventObj *pEvtObj);//No return value.
    .成员 OnMouseOut, 子程序指针, , , void OnMouseOut(IHTMLEventObj *pEvtObj);//No return value.
    .成员 OnMouseOver, 子程序指针, , , void OnMouseOver(IHTMLEventObj *pEvtObj);//No return value.
    .成员 OnReadyStateChange, 子程序指针, , , void OnReadyStateChange(IHTMLEventObj *pEvtObj);//No return value.
    .成员 OnBeforeUpdate, 子程序指针, , , VARIANT_BOOL OnBeforeUpdate(IHTMLEventObj *pEvtObj);
    .成员 OnAfterUpdate, 子程序指针, , , void OnAfterUpdate(IHTMLEventObj *pEvtObj);//No return value.
    .成员 OnRowExit, 子程序指针, , , VARIANT_BOOL OnRowExit(IHTMLEventObj *pEvtObj);
    .成员 OnRowEnter, 子程序指针, , , void OnRowEnter(IHTMLEventObj *pEvtObj);//No return value.
    .成员 OnDragStart, 子程序指针, , , VARIANT_BOOL OnDragStart(IHTMLEventObj *pEvtObj);
    .成员 OnSelectStart, 子程序指针, , , VARIANT_BOOL OnSelectStart(IHTMLEventObj *pEvtObj);
    .成员 OnErrorUpdate, 子程序指针, , , VARIANT_BOOL OnErrorUpdate(IHTMLEventObj *pEvtObj);
    .成员 OnContextMenu, 子程序指针, , , VARIANT_BOOL OnContextMenu(IHTMLEventObj *pEvtObj);
    .成员 OnStop, 子程序指针, , , VARIANT_BOOL OnStop(IHTMLEventObj *pEvtObj);
    .成员 OnRowsDelete, 子程序指针, , , void OnRowsDelete(IHTMLEventObj *pEvtObj);//No return value.
    .成员 OnRowsInserted, 子程序指针, , , void OnRowsInserted(IHTMLEventObj* pEvtObj);//No return value.
    .成员 OnCellChange, 子程序指针, , , void OnCellChange(IHTMLEventObj *pEvtObj);//No return value.
    .成员 OnPropertyChange, 子程序指针, , , void OnPropertyChange(IHTMLEventObj *pEvtObj);//No return value.
    .成员 OnDatasetChanged, 子程序指针, , , void OnDatasetChanged(IHTMLEventObj *pEvtObj);//No return value.
    .成员 OnDataAvailable, 子程序指针, , , void OnDataAvailable(IHTMLEventObj *pEvtObj);//No return value.
    .成员 OnDatasetComplete, 子程序指针, , , void OnDatasetComplete(IHTMLEventObj *pEvtObj);//No return value.
    .成员 OnBeforeEditFocus, 子程序指针, , , void OnBeforeEditFocus(IHTMLEventObj* pEvtObj);//No return value.
    .成员 OnSelectionChange, 子程序指针, , , void OnSelectionChange(IHTMLEventObj* pEvtObj);//No return value.
    .成员 OnControlSelect, 子程序指针, , , VARIANT_BOOL OnControlSelect(IHTMLEventObj* pEvtObj);
    .成员 OnMouseWheel, 子程序指针, , , VARIANT_BOOL OnMouseWheel(IHTMLEventObj* pEvtObj);
    .成员 OnFocusIn, 子程序指针, , , void OnFocusIn(IHTMLEventObj* pEvtObj);//No return value.
    .成员 OnFocusOut, 子程序指针, , , void OnFocusOut(IHTMLEventObj* pEvtObj);//No return value.
    .成员 OnActivate, 子程序指针, , , void OnActivate(IHTMLEventObj* pEvtObj);//No return value.
    .成员 OnDeActivate, 子程序指针, , , void OnDeActivate(IHTMLEventObj* pEvtObj);//No return value.
    .成员 OnBeforeActivate, 子程序指针, , , VARIANT_BOOL OnBeforeActivate(IHTMLEventObj* pEvtObj);
    .成员 OnBeforeDeActivate, 子程序指针, , , VARIANT_BOOL OnBeforeDeActivate(IHTMLEventObj* pEvtObj);

数据类型 动作标签操作, , 
    .成员 执行事件名, 文本型, , , 
    .成员 执行脚本函数名, 文本型, , , 
    .成员 先触发, 文本型, , , 
    .成员 延迟关键字, 文本型, , , 
    .成员 操作类型, 文本型, , , 点击
    .成员 写属性, 文本型, , , 
    .成员 属性值, 文本型, , , 
    .成员 延迟时间, 整数型, , , 

数据类型 标签对象指纹, , '唯一确定一个标签
    .成员 标签名, 文本型, , , 
    .成员 标签id, 文本型, , , 
    .成员 分组名, 文本型, , , 
    .成员 分组中的第几个, 文本型, , , 
    .成员 关键字, 文本型, , "1", 
    .成员 正则表达式, 文本型, , , 
    .成员 innertext, 文本型, , , 
    .成员 html, 文本型, , , 
    .成员 type, 文本型, , , 
    .成员 name, 文本型, , , 
    .成员 className, 文本型, , , 

数据类型 Point, , 
    .成员 x, 空白型, , , 
    .成员 y, 空白型, , , 

数据类型 标签, , 
    .成员 网址, 文本型, , , 
    .成员 匹配标签对象, 对象, , , 
    .成员 对象指纹, 标签对象指纹, , , 
    .成员 相邻上一个指纹, 标签对象指纹, , , 
    .成员 相邻下一个指纹, 标签对象指纹, , , 
    .成员 操作, 动作标签操作, , "1", 
    .成员 动作计次, 整数型, , , 

数据类型 事件记录, , 
    .成员 执行的脚本函数, 文本型, , , 
    .成员 事件名, 文本型, , , 
    .成员 对象, 对象, , , 
    .成员 html改变, 逻辑型, , , 
    .成员 html, 文本型, , , 

数据类型 对象模板, , 
    .成员 索引, 索引, , "1", 
    .成员 标签对象, 模板标签对象, , "1", 
    .成员 对象文本, 文本型, , "1", 对象的源文件或描述
    .成员 是否存在, 逻辑型, , "1", 

数据类型 索引, , 
    .成员 成员分组名, 文本型, , , 
    .成员 阵列中的位置, 小数型, , "1", 

数据类型 模板标签对象, , 
    .成员 对象, 对象, , , 
    .成员 事件名, 文本型, , "1", 
    .成员 脚本函数, 文本型, , "1", 
    .成员 标签源文件, 文本型, , , 
    .成员 classname, 文本型, , , 

数据类型 RECT, 公开, 区域
    .成员 Left, 整数型, , , 左
    .成员 Top, 整数型, , , 上
    .成员 Right, 整数型, , , 右
    .成员 Bottom, 整数型, , , 下

数据类型 物体原始数据, , 
    .成员 宽, 空白型, , , 
    .成员 高, 空白型, , , 
    .成员 物体标识值, 空白型, , , 
    .成员 图片, 字节集, , , 
    .成员 列表图片标识, 空白型, , , 
    .成员 列表标识, 空白型, , , 
    .成员 列表文本标识, 空白型, , , 

数据类型 动画列表框, , 
    .成员 物体标识值, 空白型, , , 
    .成员 关联计次, 空白型, , , 
    .成员 列表框文本, 空白型, , , 
    .成员 本计次, 空白型, , , 

数据类型 网页请求, , 
    .成员 lpszServerName, 文本型, , , 
    .成员 nServerPort, 整数型, , , 
    .成员 lpszUsername, 文本型, , , 
    .成员 lpszPassword, 文本型, , , 
    .成员 dwService, 整数型, , , 
    .成员 拦截_Internet激活句柄, 整数型, , , 
    .成员 新建连接句柄, 逻辑型, , , 
    .成员 新建激活句柄, 逻辑型, , , 
    .成员 新建请求句柄, 逻辑型, , , 
    .成员 lpszAgent, 文本型, , , 
    .成员 dwAccessType, 整数型, , , 
    .成员 lpszProxyName, 文本型, , , 
    .成员 lpszProxyBypass, 文本型, , , 
    .成员 dwFlags1, 整数型, , , 
    .成员 dwFlags2, 整数型, , , 
    .成员 dwContext1, 整数型, , , 0
    .成员 创建链接句柄, 整数型, , , 
    .成员 代理ip, 文本型, , , 
    .成员 匿名成员583, 空白型, , , 
    .成员 拦截_Internet连接句柄, 空白型, , , <以下是网页请求
    .成员 访问方式, 文本型, , , 
    .成员 页面路径, 文本型, , , 
    .成员 协议版本, 文本型, , , 
    .成员 引用页, 文本型, , , 
    .成员 识别类型, 文本型, , , 
    .成员 dwFlags3, 空白型, , , 
    .成员 dwContext2, 整数型, , , 
    .成员 拦截_Internet请求句柄, 空白型, , , 
    .成员 sHeaders, 文本型, , , 
    .成员 lHeadersLength, 空白型, , , ------网页请求>
    .成员 sOptional, 文本型, , , 
    .成员 lOptionalLength, 空白型, , , 

数据类型 句柄, , 
    .成员 激活句柄, 整数型, , , 
    .成员 链接句柄, 整数型, , , 
    .成员 请求句柄, 整数型, , , 

数据类型 页面地址句柄映射, , 
    .成员 页面地址, 文本型, , , 
    .成员 激活句柄, 整数型, , , 
    .成员 连接句柄, 空白型, , , 
    .成员 请求句柄, 空白型, , , 

数据类型 数据项组, , 
    .成员 保存设置数据项, 数据项, , "1", 
    .成员 配置文件完整路径, 文本型, , "1", '请求组路径
    .成员 数据项组采集类型, 整数型, , , 2新采集网页
    .成员 未启动, 逻辑型, , , 


.DLL命令 Internet激活, 整数型, "wininet.dll", "InternetOpenA", , 
    .参数 句柄名称, 文本型, 传址, 
    .参数 连接类型, 整数型, , 1直接连接;3代理连接
    .参数 代理地址, 文本型, 传址, 
    .参数 代理掩码, 文本型, 传址, 
    .参数 dwFlags, 整数型, , 0

.DLL命令 Internet建立连接, 整数型, "wininet.dll", "InternetConnectA", , 
    .参数 Internet句柄, 整数型, , 
    .参数 域名, 文本型, 传址, 
    .参数 服务器端口, 整数型, , 80HTTP;21FTP;
    .参数 用户名, 文本型, 传址, 空
    .参数 用户口令, 文本型, 传址, 空
    .参数 服务类型, 整数型, , 1FTP;3HTTP
    .参数 dwFlags, 整数型, , 0http;134217728被动FTP模式
    .参数 dwContext, 整数型, , 0

.DLL命令 Internet关闭句柄, 逻辑型, "wininet.dll", "InternetCloseHandle", , 
    .参数 句柄, 整数型, , 

.DLL命令 Internet读文件, 逻辑型, "wininet.dll", "InternetReadFile", , 
    .参数 HTTP请求句柄, 整数型, , 
    .参数 sBuffer, 字节集, 传址, 
    .参数 lNumBytesToRead, 整数型, , 
    .参数 lNumberOfBytesRead, 整数型, 传址, 

.DLL命令 Http创建请求, 整数型, "wininet.dll", "HttpOpenRequestA", , 
    .参数 Internet连接句柄, 整数型, , 由Internet建立连接返回
    .参数 访问方式, 文本型, 传址, "GET" or "POST"为空默认GET
    .参数 页面路径, 文本型, 传址, 简短路径,不带域名
    .参数 协议版本, 文本型, 传址, 为空默认HTTP/1.1
    .参数 引用页, 文本型, 传址, 可为空
    .参数 识别类型, 文本型, 传址, 可为空
    .参数 dwFlags, 整数型, , 2147483648更新下载
    .参数 dwContext, 整数型, , 0

.DLL命令 Http发送请求, 逻辑型, "wininet.dll", "HttpSendRequestA", , 
    .参数 HTTP请求句柄, 整数型, , 
    .参数 sHeaders, 文本型, 传址, 
    .参数 lHeadersLength, 整数型, , 
    .参数 sOptional, 文本型, 传址, 
    .参数 lOptionalLength, 整数型, , 

.DLL命令 读取COOKIE, 逻辑型, "wininet.dll", "InternetGetCookieA", , 
    .参数 域名, 文本型, 传址, 
    .参数 名称, 文本型, 传址, 
    .参数 内容, 文本型, 传址, 
    .参数 尺寸, 整数型, 传址, 

.DLL命令 设置COOKIE, 逻辑型, "wininet.dll", "InternetSetCookieA", , 
    .参数 域名, 文本型, 传址, 
    .参数 名称, 文本型, 传址, 
    .参数 内容, 文本型, 传址, 

.DLL命令 创建线程, 整数型, "", "CreateThread", , 
    .参数 lpThreadAttributes, 整数型, , 
    .参数 dwStackSize, 整数型, , 
    .参数 lpStartAddress, 子程序指针, , 
    .参数 lpParameter, 整数型, , 
    .参数 dwCreationFlags, 整数型, , 
    .参数 lpThreadId, 整数型, 传址, 

.DLL命令 销毁线程, 空白型, "", "TerminateThread", , 
    .参数 hThread, 整数型, , 
    .参数 dwExitCode, 整数型, , 

.DLL命令 HTTP查询信息, 逻辑型, "wininet.dll", "HttpQueryInfoA", , 
    .参数 Internet请求句柄, 整数型, , 
    .参数 待查信息, 整数型, , 22返回所有信息;43SET_COOKIE;+2147483648返回文本
    .参数 返回容器, 文本型, 传址, 
    .参数 返回容器长度, 整数型, 传址, 
    .参数 lpdwIndex, 整数型, , 

.DLL命令 API_HeapAlloc, 整数型, "", "HeapAlloc", , 从堆中分配内存
    .参数 hHeap, 整数型, , 
    .参数 dwFlags, 整数型, , 
    .参数 dwBytes, 整数型, , 

.DLL命令 API_GetProcessHeap, 整数型, "", "GetProcessHeap", , 获取调用过程堆句柄

.DLL命令 API_FillMemory, 空白型, "", "RtlFillMemory", , 填充内存字节
    .参数 Destination, 整数型, , 指针地址
    .参数 Length, 整数型, , 长度
    .参数 Fill, 字节型, , 字节数据

.DLL命令 API_拷贝内存, 空白型, "kernel32.dll", "RtlMoveMemory", , 
    .参数 pBlock, 整数型, , 
    .参数 缓冲区, 整数型, , 
    .参数 尺寸, 整数型, , 

.DLL命令 取文本指针, 整数型, "", "lstrcpyn", , 
    .参数 文本, 文本型, 传址, 
    .参数 保留, 整数型, , 0
    .参数 保留, 整数型, , 0

.DLL命令 取字节集指针, 整数型, "", "lstrcpyn", , 
    .参数 字节集, 字节集, 传址, 
    .参数 保留, 整数型, , 0
    .参数 保留, 整数型, , 0

.DLL命令 GetCursorPos, 整数型, "", "", , 获取鼠标指针的当前位置
    .参数 lpPoint, Point, , 

.DLL命令 WindowFromPoint, 整数型, "", "WindowFromPoint", , 
    .参数 x, 整数型, , 
    .参数 y, 整数型, , 

.DLL命令 GetWindowRect, 整数型, "", "GetWindowRect", 公开, 
    .参数 hwnd, 整数型, , 
    .参数 lpRect, RECT, , 

.DLL命令 API_InternetCombineUrl, 空白型, "wininet.dll", "InternetCombineUrlA", , 
    .参数 lpszBaseUrl, 文本型, , 
    .参数 lpszRelativeUrl, 文本型, , 
    .参数 lpszBuffer, 文本型, , 
    .参数 lpdwBufferLength, 整数型, 传址, 
    .参数 dwFlags, 整数型, , 

.DLL命令 API_WideCharToMultiByte, 整数型, "kernel32.dll", "WideCharToMultiByte", , 
    .参数 CodePage, 整数型, , 
    .参数 dwFlags, 整数型, , 0
    .参数 lpWideCharStr, 字节集, , 
    .参数 cchMultiByte, 整数型, , -1
    .参数 lpMultiByteStr, 文本型, 传址, 
    .参数 cchMultiByte, 整数型, , 
    .参数 默认文本, 整数型, , 0
    .参数 使用默认文本, 整数型, , 0

.DLL命令 API_MultiByteToWideChar, 整数型, "kernel32.dll", "MultiByteToWideChar", , 
    .参数 CodePage, 整数型, , 
    .参数 dwFlags, 整数型, , 0
    .参数 lpMultiByteStr, 文本型, , 
    .参数 cchMultiByte, 整数型, , -1
    .参数 lpWideCharStr, 字节集, 传址, 
    .参数 cchWideChar, 整数型, , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 目标的编码, 文本型, , , 
.子程序 _按钮1_被单击, 空白型, , 
.局部变量 文本, 文本型, , , 

检查 (等于 (1, 2))
b访问网页 (.内容, , 文本, , , , , , 目标的编码)

赋值 (.内容, 文本)
 ' 编辑框2.内容 ＝ xml取源码 (编辑框1.内容)
 ' 编辑框2.内容 ＝ xml取源码 (“http://news.china.com/”)

.子程序 取网页字节集, 变体型, , 
.参数 地址, 文本型, , 

.局部变量 对象, 对象, , , 
.局部变量 bp, 变体型, , , 

.如果真 (对象.创建 (“Microsoft.XMLHTTP”, ))
    对象.方法 (“open”, “GET”, 地址, 假)
    对象.方法 (“send”, )
    赋值 (bp, 对象.读属性 (“responseBody”, ))
    
.如果真结束
返回 (bp)


.子程序 取端口, 整数型, , 
.参数 网址, 文本型, , 

.局部变量 符号位置, 整数型, , , 
.局部变量 域名, 文本型, , , 

.如果 (不等于 (文本比较 (取文本左边 (网址, 7), “http://”, 假), 0))
    赋值 (符号位置, 寻找文本 (网址, “/”, , 真))
    .如果 (大于 (符号位置, 0))
        赋值 (域名, 取文本左边 (网址, 相减 (符号位置, 1)))
    .否则
        赋值 (域名, 网址)
    .如果结束
    
.否则
    赋值 (符号位置, 寻找文本 (网址, “/”, 8, 真))
    .如果 (大于 (符号位置, 0))
        赋值 (域名, 取文本中间 (网址, 8, 相减 (符号位置, 8)))
    .否则
        赋值 (域名, 文本替换 (网址, 1, 7, ))
    .如果结束
    
.如果结束
赋值 (符号位置, 寻找文本 (域名, “:”, 1, 真))
.如果 (大于 (符号位置, 0))
    赋值 (域名, 取文本右边 (域名, 相减 (取文本长度 (域名), 符号位置)))
.否则
    赋值 (域名, “80”)
.如果结束
返回 (到数值 (域名))


.子程序 取页面地址, 文本型, , 
.参数 网址, 文本型, , 

.局部变量 页面地址, 文本型, , , 
.局部变量 符号位置, 整数型, , , 
.局部变量 域名, 文本型, , , 

赋值 (域名, 取域名 (网址))
赋值 (符号位置, 寻找文本 (网址, “/”, 寻找文本 (网址, 域名, 1, 真), 真))
.如果 (大于 (符号位置, 0))
    赋值 (页面地址, 取文本右边 (网址, 相加 (相减 (取文本长度 (网址), 符号位置), 1)))
.否则
    赋值 (页面地址, “/”)
.如果结束
返回 (页面地址)

.子程序 取域名, 文本型, , 
.参数 网址, 文本型, , 

.局部变量 符号位置, 整数型, , , 
.局部变量 域名, 文本型, , , 

.如果 (不等于 (文本比较 (取文本左边 (网址, 7), “http://”, 假), 0))
    赋值 (符号位置, 寻找文本 (网址, “/”, , 真))
    .如果 (大于 (符号位置, 0))
        赋值 (域名, 取文本左边 (网址, 相减 (符号位置, 1)))
    .否则
        赋值 (域名, 网址)
    .如果结束
    
.否则
    赋值 (符号位置, 寻找文本 (网址, “/”, 8, 真))
    .如果 (大于 (符号位置, 0))
        赋值 (域名, 取文本中间 (网址, 8, 相减 (符号位置, 8)))
    .否则
        赋值 (域名, 文本替换 (网址, 1, 7, ))
    .如果结束
    
.如果结束
赋值 (符号位置, 寻找文本 (域名, “:”, 1, 真))
.如果真 (大于 (符号位置, 0))
    赋值 (域名, 取文本左边 (域名, 相减 (符号位置, 1)))
.如果真结束
返回 (到小写 (域名))


.子程序 b访问网页, 空白型, , 
.参数 完整网址, 文本型, , 
.参数 延时值, 整数型, 可空, 
.参数 要保存到的源文件, 文本型, 参考 可空, 
.参数 是否数据合并, 逻辑型, 可空, 
.参数 字节集源文件, 字节集, 参考 可空, 
.参数 主采集Internet句柄, 整数型, 参考 可空, 
.参数 主采集Internet连接句柄, 整数型, 参考 可空, 
.参数 主采集站点域名, 文本型, 参考 可空, 
.参数 目标编码, 文本型, 可空, 

.局部变量 Internet句柄, 整数型, , , 
.局部变量 Internet连接句柄, 整数型, , , 
.局部变量 HTTP请求句柄, 整数型, , , 
.局部变量 长度, 文本型, , , 
.局部变量 附加协议头2, 文本型, , , 
.局部变量 逻辑容器, 逻辑型, , , 
.局部变量 整数容器1, 整数型, , , 
.局部变量 字节集容器, 字节集, , , 
.局部变量 文本容器, 文本型, , , 
.局部变量 整数容器2, 整数型, , , 
.局部变量 域名, 文本型, , , 
.局部变量 页面地址, 文本型, , , 
.局部变量 起始时间, 整数型, , , 
.局部变量 长度起始, 整数型, , , 
.局部变量 长度结束, 整数型, , , 
.局部变量 递增计次, 整数型, 静态, , 
.局部变量 临时字节集源文件, 字节集, , , 
.局部变量 缓冲区大小, 整数型, , , 
.局部变量 空字节, 字节型, , , 
.局部变量 空操作字节集, 字节集, , , 
.局部变量 延迟判断, 整数型, , , 


赋值 (起始时间, 取启动时间 ())

赋值 (页面地址, 取页面地址 (完整网址))




赋值 (域名, 取域名 (完整网址))


.如果真 (等于 (主采集站点域名, “”))
    赋值 (主采集站点域名, 域名)
.如果真结束
.如果真 (等于 (延时值, 0))
    赋值 (延时值, 15000)
.如果真结束

 ' '输出调试文本 (主采集站点域名, 域名)


 ' '输出调试文本 (“Internet句柄 [无计次]”, Internet句柄 [无计次])
 ' Internet连接句柄 ＝ Internet建立连接 (Internet句柄, 域名, 取端口 (完整网址), “”, “”, 3, 0, 0)

.如果 (等于 (主采集Internet句柄, 0))
    赋值 (Internet句柄, Internet激活 (到文本 (“Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)”), 1, “”, “”, 0))
    
.否则
    赋值 (Internet句柄, 主采集Internet句柄)
.如果结束

.如果 (等于 (主采集Internet连接句柄, 0))
    赋值 (Internet连接句柄, Internet建立连接 (Internet句柄, 域名, 取端口 (完整网址), “”, “”, 3, 0, 0))
    
.否则
    赋值 (Internet连接句柄, 主采集Internet连接句柄)
.如果结束





 ' '输出调试文本 (“Internet连接句柄 [无计次]”, Internet句柄 [无计次])

赋值 (HTTP请求句柄, Http创建请求 (Internet连接句柄, “”, 页面地址, “HTTP/1.1”, 到文本 (“”), 到文本 (“”), 2147483648, 0))

 ' '输出调试文本 (“HTTP请求句柄 [无计次]”, HTTP请求句柄 [无计次], 页面地址)


 ' 写出文本 (HTTP查询信息文件号, 文本容器 ＋ “|”)
.如果真 (等于 (HTTP请求句柄, 0))
     ' 输出调试文本 (“HTTP请求句柄 [无计次]=0” ＋ 页面地址)
    返回 ()
.如果真结束

.如果真 (等于 (寻找文本 (附加协议头2, “Accept: ”, 1, 真), -1))
    赋值 (附加协议头2, 相加 (附加协议头2, “Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, */*”, #换行符))
.如果真结束
.如果真 (等于 (寻找文本 (附加协议头2, “Referer: ”, 1, 真), -1))
    赋值 (附加协议头2, 相加 (附加协议头2, “Referer: ”, 域名, #换行符))
.如果真结束
.如果真 (等于 (寻找文本 (附加协议头2, “Accept-Language: ”, 1, 真), -1))
    赋值 (附加协议头2, 相加 (附加协议头2, “Accept-Language: zh-cn”, #换行符))
.如果真结束
Http发送请求 (HTTP请求句柄, 附加协议头2, 取文本长度 (附加协议头2), “”, 0)
赋值 (文本容器, 取空白文本 (1024))

HTTP查询信息 (HTTP请求句柄, 22, 文本容器, 1024, 0)
输出调试文本 (文本容器)
 ' 检查 (1 ＝ 2)
.如果真 (大于 (寻找文本 (文本容器, “Not Found”, , 假), 0))
    返回 ()
.如果真结束

.判断开始 (大于 (到数值 (长度), 10000000))
    赋值 (缓冲区大小, 10240)
.判断 (大于 (到数值 (长度), 1000000))
    赋值 (缓冲区大小, 6120)
    
.默认
    赋值 (缓冲区大小, 2048)
.判断结束

赋值 (延迟判断, 取启动时间 ())
赋值 (逻辑容器, 真)
赋值 (整数容器1, 1)
.判断循环首 (大于 (整数容器1, 0))
    .如果真 (大于 (相减 (取启动时间 (), 延迟判断), 延时值))
        跳出循环 ()
    .如果真结束
    赋值 (字节集容器, 取空白字节集 (缓冲区大小))
    处理事件 ()
    Internet读文件 (HTTP请求句柄, 字节集容器, 取字节集长度 (字节集容器), 整数容器1)
    赋值 (字节集源文件, 相加 (字节集源文件, 取字节集左边 (字节集容器, 整数容器1)))
.判断循环尾 ()






 ' 如果真 (是否数据合并 ＝ 真 或 c.启动下载图片 ＝ 真)
赋值 (临时字节集源文件, 字节集源文件)
 ' c.页面内容 [网页计次] ＝ 临时字节集源文件


赋值 (要保存到的源文件, api编码转换 (字节集源文件, 到大写 (目标编码)))




Internet关闭句柄 (HTTP请求句柄)

Internet关闭句柄 (Internet连接句柄)

Internet关闭句柄 (Internet句柄)


返回 ()

.子程序 api编码转换, 文本型, , 必须判断网页原来的编码,从网页中或者使用查询http信息可以知道,本子程序从网页中但有的网站没有给
.参数 strBody, 字节集, , 
.参数 目标编码, 文本型, 可空, 
.参数 原始编码, 文本型, 可空, 

.局部变量 对象, 对象, , , 
.局部变量 返回, 文本型, , , 
.局部变量 正则, 未知类型0x20001, , , 
.局部变量 文本, 文本型, , , 
.局部变量 CodeBase, 文本型, , , 
.局部变量 变体, 变体型, , , 

正则.未知支持库函数_3 (相加 (“charset=([^/ ”, #引号, “'>]+)”), )



 ' 注意了,我把源文件截取,实际使用不要截取,这里目的是快点显示
.如果真 (大于 (取字节集长度 (strBody), 3000))
    赋值 (strBody, 取字节集左边 (strBody, 3000))
.如果真结束

赋值 (文本, 到文本 (strBody))

.如果真 (等于 (原始编码, “”))
    .如果真 (不等于 (文本, “”))
        赋值 (原始编码, 正则.未知支持库函数_7 (文本, 1, ).未知支持库函数_12 (文本, 1, ))
    .如果真结束
    
.如果真结束

.如果真 (等于 (原始编码, “”))
    赋值 (原始编码, 到大写 (“GB2312”))
.如果真结束

.如果真 (等于 (目标编码, “”))
    赋值 (目标编码, “GB2312”)
.如果真结束


输出调试文本 (相加 (“网页编码:”, 原始编码, “目标编码:”, 目标的编码, “ ”, 目标编码))
.如果 (等于 (目标编码, 原始编码)) ' 默认的目标编码为gb2312,如果原始编码同目标编码一样就返回
    赋值 (返回, 文本)
.否则
    .判断开始 (等于 (目标编码, “GB2312”))
        
        赋值 (返回, Unicode转Ansi (Ansi转Unicode (文本), #cp_gb2312)) ' 从utf8到gb2312
        
        
    .判断 (等于 (目标编码, “UTF-8”))
        
        
        赋值 (返回, Unicode转Ansi (Ansi转Unicode (文本, #cp_gb2312), #CP_UTF8)) ' 从gb2312到utf8
    .默认
        
    .判断结束
    
    
    
.如果结束
赋值 (返回, 相加 (“----------此编码已经被转换,还原请点另一个-----”, #换行符, 返回))


返回 (返回)

.子程序 xml取源码, 文本型, , 
.参数 地址, 文本型, , 

.局部变量 xmlhttp对象, 对象, , , 
.局部变量 strBody, 变体型, 静态, , 
.局部变量 CodeBase, 文本型, 静态, , 
.局部变量 对象, 对象, , , 
.局部变量 BytesToBstr, 文本型, , , 
.局部变量 正则, 未知类型0x20001, , , 
.局部变量 文本, 文本型, , , 
.局部变量 时间, 整数型, , , 



.如果真 (xmlhttp对象.创建 (“Microsoft.XMLHTTP”, ))
    xmlhttp对象.方法 (“open”, “GET”, 地址, 假)
    xmlhttp对象.方法 (“send”, )
    
    赋值 (strBody, xmlhttp对象.读属性 (“responseBody”, ))
     ' 检查 (1 ＝ 2)
    正则.未知支持库函数_3 (相加 (“charset=([^/ ”, #引号, “'>]+)”), )
    赋值 (文本, 到文本 (strBody.取字节集 ()))
    赋值 (时间, 取启动时间 ())
    .如果真 (等于 (CodeBase, “”))
        .如果真 (不等于 (文本, “”))
            赋值 (CodeBase, 正则.未知支持库函数_7 (文本, 1, ).未知支持库函数_12 (文本, 1, ))
        .如果真结束
        
        .如果 (等于 (CodeBase, “UTF-8”))
            赋值 (BytesToBstr, xmlhttp对象.读文本属性 (“responseText”, ))
        .否则
            输出调试文本 (CodeBase)
            .如果 (或者 (等于 (CodeBase, “”), 等于 (CodeBase, “GB2312”)))
                返回 (“”)
            .否则
                赋值 (CodeBase, “GB2312”)
            .如果结束
            对象.创建 (“Adodb.Stream”, )
             ' 对象.查看 ()
            对象.写属性 (“Type”, 1)
            对象.写属性 (“Mode”, 3)
            对象.方法 (“Open”, )
            
            对象.方法 (“Write”, strBody)
            
            对象.写属性 (“Position”, 0)
            对象.写属性 (“Type”, 2)
            
            对象.写属性 (“Charset”, CodeBase)
            赋值 (BytesToBstr, 对象.文本方法 (“ReadText”, -1))
            
        .如果结束
        
        
        
        
    .如果真结束
    
    输出调试文本 (相加 (“用时:”, 到文本 (相减 (取启动时间 (), 时间))), CodeBase)
    返回 (BytesToBstr)
    
     ' 返回 ()
    
    
.如果真结束
返回 (“”)

.子程序 __启动窗口_创建完毕, 空白型, , 
“http://www.china.com.cn/news/node_5704011.htm”.加入项目 ()
“http://www.people.com.cn/GB/wenyu/64/127/20030529/1003546.html”.加入项目 ()


.子程序 BytesToBstr, 文本型, , 使用Adodb.Stream转换编码
.参数 strBody, 变体型, 可空, 
.参数 目标编码, 文本型, 可空, 
.参数 原始编码, 文本型, 可空, 

.局部变量 对象, 对象, , , 
.局部变量 BytesToBstr, 文本型, , , 
.局部变量 正则, 未知类型0x20001, , , 
.局部变量 文本, 文本型, , , 
.局部变量 时间, 整数型, , , 

 ' 检查 (1 ＝ 2)
正则.未知支持库函数_3 (相加 (“charset=([^/ ”, #引号, “'>]+)”), )
.如果真 (等于 (目标编码, “”)) ' 默认目标编码为gb2312
    赋值 (目标编码, “GB2312”)
.如果真结束


赋值 (文本, 到文本 (strBody.取字节集 ()))
.如果真 (等于 (目标编码, “”))
    .如果真 (等于 (原始编码, “”))
        .如果真 (不等于 (文本, “”))
            赋值 (原始编码, 正则.未知支持库函数_7 (文本, 1, ).未知支持库函数_12 (文本, 1, ))
        .如果真结束
        
    .如果真结束
    
    
    对象.创建 (“Adodb.Stream”, )
     ' 对象.查看 ()
    对象.写属性 (“Type”, 1)
    对象.写属性 (“Mode”, 3)
    对象.方法 (“Open”, )
    
    对象.方法 (“Write”, strBody)
    
    对象.写属性 (“Position”, 0)
    对象.写属性 (“Type”, 2)
    
    对象.写属性 (“Charset”, 目标编码)
    赋值 (BytesToBstr, 对象.文本方法 (“ReadText”, -1))
    
    
    
.如果真结束


返回 (BytesToBstr)


.子程序 Ansi转Unicode, 字节集, , 
.参数 Ansi, 文本型, , 
.参数 原始编码, 整数型, 可空, 

.局部变量 Unicode, 字节集, , , 
.局部变量 长度, 整数型, , , 

.如果真 (是否为空 (原始编码))
    赋值 (原始编码, #CP_UTF8)
.如果真结束
赋值 (长度, API_MultiByteToWideChar (0, 0, Ansi, -1, {  }, 0))
赋值 (Unicode, 取空白字节集 (相乘 (长度, 2)))
API_MultiByteToWideChar (原始编码, 0, Ansi, -1, Unicode, 长度)
返回 (Unicode)

.子程序 Unicode转Ansi, 文本型, , 
.参数 Unicode, 字节集, , 
.参数 目标编码, 整数型, 可空, 

.局部变量 Ansi, 文本型, , , 
.局部变量 长度, 整数型, , , 

.如果真 (是否为空 (目标编码))
    赋值 (目标编码, 0)
.如果真结束
赋值 (长度, API_WideCharToMultiByte (0, 0, Unicode, -1, “”, 0, 0, 0))
赋值 (Ansi, 取空白文本 (相乘 (长度, 2)))
API_WideCharToMultiByte (目标编码, 0, Unicode, -1, Ansi, 相乘 (长度, 2), 0, 0)
返回 (Ansi)

.子程序 _组合框1_列表项被选择, 空白型, , 

.如果 (等于 (.现行选中项, 0))
    
    赋值 (目标的编码, “gb2312”) ' 目标编码
    赋值 (.内容, “你选择的是UTF-8到gb2312 转换”)
.否则
    赋值 (目标的编码, “UTF-8”) ' 目标编码
    赋值 (.内容, “你选择的是gb2312到UTF-8 转换”)
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 计次, 整数型, 静态, , 
.局部变量 返回, 文本型, , , 
.局部变量 文本, 文本型, , , 

赋值 (计次, 相加 (计次, 1))
赋值 (文本, .内容)

.如果 (等于 (目标的编码, “UTF-8”))
    .如果 (等于 (求余数 (2), 0))
        赋值 () ' 从gb2312到utf8


 ' 不属于任何一个程序集、类模块的函数：
