 ' 文件类型：Windows模块源码

 ' 程序名称：高级表格打印模块
 ' 程序描述：
 ' 程序作者：张乙尔
 ' 邮政编码：423600
 ' 联系地址：湖南省安仁县人大常委会办公室
 ' 联系电话：07355233046
 ' 传真号码：07355233045
 ' 电子信箱：zye7504@126.com
 ' 主页地址：
 ' 版权声明：高级表格自由打印
 ' 版本号：1.0
 ' 创建号：0.0

窗口 窗口一
    左边 = 50
    顶边 = 50
    宽度 = 414
    高度 = 283
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “自由打印”
    帮助文件名 = “”

窗口 窗口二
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “员工考勤年报”
    帮助文件名 = “”



.图片 高级表格, " ' 已保存到：D:\易语言学习\Data\高级表格打印模块.e\高级表格", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 1 3 高级表格支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' eExcel2000 F86EC5989E044d42BC98C692C0B54727 1 0 EXCEL2000支持库




.全局变量 全局高级表格, 未知类型0x20001, , , 
.全局变量 全局窗口标题, 文本型, , , 
.全局变量 全局默认表名, 文本型, , , 
.全局变量 全局配置文件名, 文本型, , , 
.全局变量 子窗口句柄, 空白型, , , 

.DLL命令 gettext, 整数型, "", "GetWindowTextA", , 
    .参数 win, 整数型, , 
    .参数 wb, 文本型, , 
    .参数 cd, 整数型, , 

.DLL命令 查找窗口, 整数型, "", "FindWindowExA", , 
    .参数 hwnd1, 整数型, , 
    .参数 hwnd2, 整数型, , 
    .参数 lpsz1, 整数型, , 
    .参数 lpsz2, 整数型, , 

.DLL命令 getcd, 整数型, "", "GetWindowTextLengthA", , 
    .参数 jb, 整数型, , 

.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。
载入 (窗口二, , 真)

.窗口程序集 窗口程序集1, , , 

.子程序 _窗口一_创建完毕, 空白型, , 
赋值 (窗口一., 全局窗口标题)
显示列 (全局高级表格)
读打印配置项 ()
.如果真 (不等于 (全局默认表名, “”))
    赋值 (.内容, 全局默认表名)
.如果真结束


.子程序 显示列, 空白型, , 
.参数 高级表格, 未知类型0x20001, , 

.局部变量 计次, 空白型, , , 
.局部变量 现有列, 文本型, , , 

 ' 将列加入选择框
.计次循环首 (高级表格., 计次)
    赋值 (现有列, 高级表格.未知支持库函数_10 (0, 相减 (计次, 1)))
    现有列.加入项目 ()
    相减 (计次, 1).选中项目 (真)
    输出调试文本 (现有列)
.计次循环尾 ()


.子程序 打印高级表格, 空白型, , 
.参数 高级表格, 未知类型0x20001, , 

.局部变量 打印列名称, 文本型, , "0", 
.局部变量 打印列索引, 空白型, , "0", 
.局部变量 打印标题, 文本型, , , 
.局部变量 列数, 空白型, , , 
.局部变量 行数, 空白型, , , 
.局部变量 计次, 空白型, , , 
.局部变量 计次一, 空白型, , , 
.局部变量 总列宽, 空白型, , , 
.局部变量 列宽, 空白型, , , 
.局部变量 单元格文本, 文本型, , , 
.局部变量 打印设置, 打印设置信息, , , 
.局部变量 标题字体, 文本型, , "0", 
.局部变量 i, 空白型, , , 

置等待鼠标 ()
赋值 (.可视, 真)
赋值 (子窗口句柄, 1)
处理事件 ()
赋值 (高级表格, 全局高级表格)
 ' 将要打印的列名和列索引加入数组
.计次循环首 (取项目数 (), 计次)
    .如果真 (相减 (计次, 1).是否被选中 ())
        加入成员 (打印列名称, 相减 (计次, 1).取项目文本 ())
        加入成员 (打印列索引, 相减 (计次, 1))
    .如果真结束
    
.计次循环尾 ()
.如果真 (等于 (取数组成员数 (打印列名称), 0))
    信息框 (“当前没有可打印的内容，请选择要打印的列。”, 0, “温馨提示”)
    返回 ()
.如果真结束
赋值 (., 删首尾空 (.内容))
.如果 (等于 (.内容, “”))
    赋值 (标题字体, { “黑体”, “22” })
.否则
    
    赋值 (标题字体, 分割文本 (.内容, “,”, ))
.如果结束

赋值 (.数据提供者, “通用提供者”)

.如果真 (取反 (#高级表格.从字节集读 ()))
    信息框 (“读取打印模板失败。”, 相加 (#错误图标, 0), “失败”)
    返回 ()
.如果真结束
赋值 (.数据源, “”)
赋值 (列数, 取数组成员数 (打印列名称))
.如果真 (等于 (.选中, 真))
    赋值 (列数, 相加 (列数, 1))
.如果真结束

1.插入列 (列数)
3.合并 (2, 1, 列数)
3.置文本 (2, .)
3.置字体属性 (2, 1, 1, 1) ' 粗体字
 ' 将列标题置入数据源
3.置对齐方式 (2, 1, 列数, #中中)
赋值 (总列宽, 0)

.如果 (等于 (.选中, 真))
    .计次循环首 (列数, 计次)
        .如果 (等于 (计次, 1))
            5.置文本 (相加 (计次, 1), “序号”)
            相加 (计次, 1).置列宽 (1, 120)
        .否则
            
            5.置文本 (相加 (计次, 1), 打印列名称 [相减 (计次, 1)])
            赋值 (列宽, 280)
            相加 (计次, 1).置列宽 (1, 列宽)
            
        .如果结束
        赋值 (总列宽, 相加 (总列宽, 列宽))
    .计次循环尾 ()
    
.否则
    
    .计次循环首 (列数, 计次)
        5.置文本 (相加 (计次, 1), 打印列名称 [计次])
        赋值 (列宽, 280)
        相加 (计次, 1).置列宽 (1, 列宽)
        
        赋值 (总列宽, 相加 (总列宽, 列宽))
    .计次循环尾 ()
    
.如果结束

.如果真 (等于 (.选中, 真))
    相加 (计次, 1).置列宽 (2, 50)
.如果真结束

赋值 (行数, 相减 (高级表格., 1))

5.置行高 (1, 80)
赋值 (i, 1)
.计次循环首 (行数, 计次)
    .添加行 ()
    取行数 ().置行高 (1, 80)
    .如果真 (并且 (等于 (.选中, 真), 不等于 (计次, 行数)))
        取行数 ().置文本 (2, 到文本 (i))
        赋值 (i, 相加 (i, 1))
    .如果真结束
    
    .判断开始 (等于 (.选中, 真))
        .计次循环首 (相减 (列数, 1), 计次一)
            赋值 (单元格文本, 到文本 (高级表格.未知支持库函数_10 (计次, 打印列索引 [计次一])))
            取行数 ().置文本 (相加 (计次一, 2), 单元格文本)
        .计次循环尾 ()
        
    .默认
        .计次循环首 (列数, 计次一)
            赋值 (单元格文本, 到文本 (高级表格.未知支持库函数_10 (计次, 打印列索引 [计次一])))
            取行数 ().置文本 (相加 (计次一, 1), 单元格文本)
        .计次循环尾 ()
        
    .判断结束
    
    
    
.计次循环尾 ()
1.置列宽 (1, 1)
赋值 (打印设置, 取打印设置 ())
赋值 (打印设置.纸张类型, .取项目数值 (.现行选中项))
赋值 (打印设置.纸张方向, .取项目数值 (.现行选中项))
赋值 (打印设置.上边距, 100)
赋值 (打印设置.下边距, 100)
赋值 (打印设置.左边距, 150)
赋值 (打印设置.右边距, 100)
 ' 打印设置.自动填充 ＝ 真
赋值 (打印设置.页号位置, #下中页号)
.如果真 (不等于 (.内容, “”))
    赋值 (打印设置.每页打印行数, 到数值 (.内容))
.如果真结束

.如果真 (大于 (总列宽, 取打印页宽 ()))
    赋值 (打印设置.打印缩放比, -1) ' 自动压缩到纸张宽度
.如果真结束

打印设置.置打印设置 ()
5.置表头行数 ()
.判断开始 (等于 (.选中, 真))
    5.加线条 (2, 相减 (取行数 (), 4), 取列数 (), 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))
.判断 (等于 (.选中, 真))
    5.加线条 (2, 1, 取列数 (), 相加 (#左边框, #上边框, #右边框, #下边框))
    5.加线条 (2, 相减 (取行数 (), 4), 取列数 (), 相加 (#左边框, #上边框, #右边框, #下边框))
.判断 (等于 (.选中, 真))
    5.加线条 (2, 相减 (取行数 (), 4), 取列数 (), 相加 (#左边框, #上边框, #右边框, #下边框, #水平线))
.判断 (等于 (.选中, 真))
    5.加线条 (2, 1, 取列数 (), 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))
    6.加线条 (2, 行数, 取列数 (), 相加 (#左边框, #上边框, #右边框, #下边框, #垂直线))
.默认
    
.判断结束

3.置字体名 (1, 1, 取列数 (), 标题字体 [1])
3.置字体尺寸 (1, 1, 取列数 (), 相乘 (到数值 (标题字体 [2]), 5))

.如果真 (不等于 (.内容, “”))
    5.置字体尺寸 (21, 行数, 列数, 到数值 (.内容))
.如果真结束

5.置对齐方式 (2, 相加 (行数, 1), 列数, #中中)
赋值 (.可视, 假)
赋值 (., 假)
赋值 (.数据源, “数据源”)
打印预览 ()
恢复鼠标 ()

搜索子窗口 ()
赋值 (.时钟周期, 200)

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 线型, 文本型, , , 

.判断开始 (等于 (.选中, 真))
    赋值 (线型, “ 1”)
.判断 (等于 (.选中, 真))
    赋值 (线型, “2”)
.判断 (等于 (.选中, 真))
    赋值 (线型, “3”)
.判断 (等于 (.选中, 真))
    赋值 (线型, “4”)
.默认
    赋值 (线型, “1”)
.判断结束

.如果 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “标题”, 删首尾空 (.内容))
    保存打印字段信息 ()
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “字体”, 删首尾空 (.内容))
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “纸型”, 删首尾空 (到文本 (.现行选中项)))
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “打印方向”, 删首尾空 (到文本 (.现行选中项)))
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “行数”, 删首尾空 (.内容))
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “线型”, 线型)
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “字体大小”, 删首尾空 (.内容))
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “是否序号”, 选择 (等于 (.选中, 真), “真”, “假”))
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “保存配置”, “真”)
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “全选”, 选择 (等于 (.选中, 真), “真”, “假”))
.否则
    
    写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “保存配置”, “假”)
.如果结束

打印高级表格 (全局高级表格)

.子程序 _按钮3_被单击, 空白型, , 
打开 ()
赋值 (.内容, .字体名称)
赋值 (.内容, 相加 (.内容, “,”, 到文本 (.字体大小)))


.子程序 读打印配置项, 空白型, , 
.局部变量 线型, 文本型, , , 

赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “标题”, “高级表格自由打印”))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “字体”, “黑体,22”))
赋值 (.现行选中项, 到整数 (读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “纸型”, “ 1”)))
赋值 (.现行选中项, 到整数 (读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “打印方向”, “1”)))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “行数”, “”))
赋值 (线型, 读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “线型”, “1”))
.判断开始 (等于 (线型, “ 1”))
    赋值 (.选中, 真)
.判断 (等于 (线型, “ 2”))
    赋值 (.选中, 真)
.判断 (等于 (线型, “ 3”))
    赋值 (.选中, 真)
.判断 (等于 (线型, “ 4”))
    赋值 (.选中, 真)
.默认
    赋值 (.选中, 真)
.判断结束

赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “字体大小”, “”))
赋值 (.选中, 选择 (等于 (读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “是否序号”, “假”), “真”), 真, 假))
赋值 (.选中, 选择 (等于 (读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “保存配置”, “假”), “真”), 真, 假))

赋值 (.选中, 选择 (等于 (读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “全选”, “假”), “真”), 真, 假))
读打印字段 ()


.子程序 保存打印字段信息, 空白型, , 
.局部变量 计次, 空白型, , , 
.局部变量 字段, 文本型, , , 0,表示未选中，1，表示选中

赋值 (字段, “”)
.计次循环首 (取项目数 (), 计次)
    .如果 (取反 (相减 (计次, 1).是否被选中 ()))
        赋值 (字段, 相加 (字段, “0,”))
    .否则
        赋值 (字段, 相加 (字段, “1,”))
    .如果结束
    
.计次循环尾 ()
赋值 (字段, 取文本左边 (字段, 相减 (取文本长度 (字段), 1))) ' 去掉右边一个逗号
写配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “打印字段”, 字段)


.子程序 读打印字段, 空白型, , 
.局部变量 字段, 文本型, , , 
.局部变量 字段组, 文本型, , "0", 
.局部变量 计次, 空白型, , , 


赋值 (字段, 读配置项 (相加 (取运行目录 (), “\”, 全局配置文件名), “高级表格打印”, “打印字段”, “”))
.如果真 (等于 (字段, “”))
    返回 ()
.如果真结束
赋值 (字段组, 分割文本 (字段, “,”, ))
.如果真 (不等于 (取数组成员数 (字段组), 取项目数 ()))
    返回 ()
.如果真结束

.计次循环首 (取项目数 (), 计次)
    .如果 (等于 (字段组 [计次], “0”))
        相减 (计次, 1).选中项目 (假)
    .否则
        相减 (计次, 1).选中项目 (真)
    .如果结束
    
.计次循环尾 ()

.子程序 _全部选择框_被单击, 空白型, , 
.局部变量 计次, 空白型, , , 

.如果 (等于 (.选中, 真))
    .计次循环首 (取项目数 (), 计次)
        相减 (计次, 1).选中项目 (真)
    .计次循环尾 ()
.否则
    .计次循环首 (取项目数 (), 计次)
        相减 (计次, 1).选中项目 (假)
    .计次循环尾 ()
    
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()


.子程序 搜索子窗口, 空白型, , 
.局部变量 cd, 整数型, , , 
.局部变量 cd1, 整数型, , , 
.局部变量 wb, 文本型, , , 
.局部变量 win, 整数型, , , 
.局部变量 bx, 整数型, , , 
.局部变量 ff, 整数型, , , 
.局部变量 n, 逻辑型, , , 

赋值 (win, 查找窗口 (0, 0, 0, 0))
赋值 (子窗口句柄, 0)
.判断循环首 (不等于 (win, 0))
    赋值 (cd, getcd (win))
    处理事件 ()
    .如果真 (大于或等于 (cd, 1))
        赋值 (wb, 取空白文本 (相加 (cd, 1)))
        赋值 (cd1, gettext (win, wb, 取文本长度 (wb)))
        .如果 (等于 (wb, “打印预览”))
            赋值 (子窗口句柄, win)
            跳出循环 ()
        .否则
            
        .如果结束
        
    .如果真结束
    赋值 (win, 查找窗口 (0, win, 0, 0))
.判断循环尾 ()

.子程序 _时钟2_周期事件, 空白型, , 
.如果 (等于 (子窗口句柄, 0))
    赋值 (.时钟周期, 0)
    销毁 ()
.否则
    搜索子窗口 ()
.如果结束


.窗口程序集 窗口程序集2, , , 

.子程序 _超级按钮3_被单击, 空白型, , 
高级表格打印 (“员工打印信息.ini”, “高级表格自由打印”, “高级表格标题”)


.子程序 _窗口二_创建完毕, 空白型, , 
0.未知支持库函数_9 (0, 1, “a”)
0.未知支持库函数_9 (1, 1, “b”)
0.未知支持库函数_9 (2, 1, “c”)
0.未知支持库函数_9 (3, 1, “d”)
0.未知支持库函数_9 (4, 1, “e”)
插入月份 ()

.子程序 插入月份, 空白型, , 
.局部变量 计次, 空白型, , , 

赋值 (., 1)
.计次循环首 (12, 计次)
    .未知支持库函数_38 ()
    相减 (., 1).未知支持库函数_9 (0, 1, 相加 (到文本 (取年份 (.今天)), “年”, 到文本 (计次), “月”))
    相减 (., 1).未知支持库函数_9 (1, 1, 相加 (到文本 (取年份 (.今天)), “年”, 到文本 (“b”)))
    相减 (., 1).未知支持库函数_9 (2, 1, 相加 (到文本 (取年份 (.今天)), “年”, 到文本 (“c”), “月”))
.计次循环尾 ()
.未知支持库函数_38 ()
相减 (., 1).未知支持库函数_9 (0, 1, “合计”)
.计次循环首 (15, 计次)
    计次.未知支持库函数_66 (0, 相减 (., 2), 相减 (., 1))
.计次循环尾 ()
相减 (., 1).未知支持库函数_24 (0, 相减 (., 1), 相减 (., 1), #黄色)
相减 (., 1).未知支持库函数_22 (0, 相减 (., 1), 相减 (., 1), #红色)

.子程序 _超级按钮4_被单击, 空白型, , 
销毁 ()

.子程序 _超级按钮2_被单击, 空白型, , 
高级表格导出EXCEL ()

.程序集 _接口程序集, , , 

.子程序 高级表格打印, 空白型, 公开, 
.参数 高级表格, 未知类型0x20001, , 
.参数 配置文件名, 文本型, , 保存打印信息的配置文件,用.ini作后缀
.参数 窗口标题, 文本型, 可空, 
.参数 默认表名, 文本型, 可空, 

赋值 (全局高级表格, 高级表格)
赋值 (全局窗口标题, 窗口标题)
赋值 (全局默认表名, 默认表名)
赋值 (全局配置文件名, 配置文件名)
载入 (窗口一, , 假)



.子程序 高级表格导出EXCEL, 空白型, 公开, 
.参数 Excel程序参数, 未知类型0x40001, , 
.参数 Excel工作簿参数, 未知类型0x40002, , 
.参数 通用对话框参数, 通用对话框, , 
.参数 高级表格, 未知类型0x20001, , 

.局部变量 计次1, 空白型, , , 
.局部变量 计次2, 空白型, , , 
.局部变量 文件名, 文本型, , , 

赋值 (通用对话框参数.类型, 1)
赋值 (通用对话框参数.过滤器, “EXCEL文件|*.xls”)
赋值 (通用对话框参数.默认文件后缀, “.xls”)
.如果真 (取反 (通用对话框参数.打开 ()))
    返回 ()
.如果真结束

赋值 (文件名, 通用对话框参数.文件名)

.如果真 (等于 (Excel程序参数.未知支持库函数_0 (), 假))
    信息框 (“创建EXCEL文件失败。”, 0, “失败”)
    返回 ()
.如果真结束
赋值 (Excel程序参数., 真)
Excel工作簿参数.未知支持库函数_6 (Excel程序参数)
Excel工作簿参数.未知支持库函数_14 (文件名)
赋值 (Excel工作簿参数., 2)
Excel工作簿参数.未知支持库函数_19 ()
Excel工作簿参数.未知支持库函数_22 ()
赋值 (Excel工作簿参数., 2) ' 连续两次删除表格
Excel工作簿参数.未知支持库函数_19 ()
Excel工作簿参数.未知支持库函数_22 ()
赋值 (Excel工作簿参数., 1)
Excel工作簿参数.未知支持库函数_19 ()
赋值 (Excel工作簿参数., “sheet1”)

.计次循环首 (高级表格., 计次1)
    .计次循环首 (高级表格., 计次2)
        .判断开始 (小于或等于 (计次2, 26))
            赋值 (Excel工作簿参数., 相加 (字符 (相加 (96, 计次2)), 到文本 (计次1))) ' {"a1,b1,c1,d1","a2,b2,c2,d2",……}
            赋值 (Excel工作簿参数., 相加 (字符 (相加 (96, 计次2)), 到文本 (计次1)))
        .判断 (并且 (大于 (计次2, 26), 小于或等于 (计次2, 52)))
            赋值 (Excel工作簿参数., 相加 (字符 (相加 (96, 1)), 字符 (相减 (相加 (96, 计次2), 26)), 到文本 (计次1)))
            赋值 (Excel工作簿参数., 相加 (字符 (相加 (96, 1)), 字符 (相减 (相加 (96, 计次2), 26)), 到文本 (计次1)))
            输出调试文本 (相加 (字符 (相加 (96, 1)), 字符 (相减 (相加 (96, 计次2), 26)), 到文本 (计次1)))
        .判断 (并且 (大于 (计次2, 52), 小于或等于 (计次2, 104)))
            赋值 (Excel工作簿参数., 相加 (字符 (相加 (96, 2)), 字符 (相减 (相加 (96, 计次2), 相乘 (26, 2))), 到文本 (计次1)))
            赋值 (Excel工作簿参数., 相加 (字符 (相加 (96, 2)), 字符 (相减 (相加 (96, 计次2), 相乘 (26, 2))), 到文本 (计次1)))
        .默认
            
        .判断结束
        
        赋值 (Excel工作簿参数., 高级表格.未知支持库函数_10 (相减 (计次1, 1), 相减 (计次2, 1)))
    .计次循环尾 ()
.计次循环尾 ()
Excel工作簿参数.未知支持库函数_16 (文件名)


 ' 不属于任何一个程序集、类模块的函数：
