 ' 文件类型：Windows模块源码

 ' 程序名称：取mdb表名
 ' 程序描述：取mdb数据库的表名
利用“对象”取得：）
 ' 程序作者：笨笨啊
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 1 扩展界面支持库一





.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。


.子程序 取mdb表名, 逻辑型, 公开, 取得mdb的所有表名。
.参数 mdb数据库, 文本型, , 要取表名的access数据库
.参数 表名, 文本型, 参考 数组, 文本数组，存储返回的表名

.局部变量 ADODB连接, 对象, , , 
.局部变量 连接文本, 文本型, , , 
.局部变量 表名列记录集, 对象, , , 
.局部变量 a, 整数型, , , 
.局部变量 对象型, 对象, , , 
.局部变量 变体型, 变体型, , , 
.局部变量 对象型1, 对象, , , 
.局部变量 数据库名, 文本型, , , 

清除数组 (表名)
赋值 (数据库名, 取文本右边 (mdb数据库, 相减 (取文本长度 (mdb数据库), 倒找文本 (mdb数据库, “\”, , 假))))
.如果真 (ADODB连接.创建 (“ADODB.Connection”, ))
    赋值 (连接文本, 相加 (“Provider=Microsoft.Jet.OLEDB.4.0;Data Source=”, mdb数据库)) ' 后面是数据库路径
    ADODB连接.写属性 (“connectionstring”, 连接文本)
    ADODB连接.方法 (“open”, )
     ' 连接错误信息
    赋值 (对象型1, ADODB连接.读对象型属性 (“Errors”, ))
    .如果真 (等于 (对象型1.是否为空 (), 假))
        变体型.赋值 (0, )
        赋值 (对象型, 对象型1.读对象型属性 (“Item”, 变体型))
        .如果真 (等于 (对象型.是否为空 (), 假))
            返回 (假)
        .如果真结束
        
    .如果真结束
    赋值 (表名列记录集, ADODB连接.对象型方法 (“OpenSchema”, 20))
    .判断循环首 (等于 (表名列记录集.读逻辑属性 (“eof”, ), 假)) ' 循环取表名列表
        赋值 (对象型1, 表名列记录集.读对象型属性 (“Fields”, ))
        变体型.赋值 (“TABLE_TYPE”, ) ' 取表类型
        赋值 (对象型, 对象型1.读对象型属性 (“Item”, 变体型))
        赋值 (变体型, 对象型.读属性 (“Value”, ))
        .如果真 (等于 (变体型.取文本 (), “TABLE”))
             ' 取表名
            变体型.赋值 (“TABLE_NAME”, )
            赋值 (对象型, 对象型1.读对象型属性 (“Item”, 变体型))
            赋值 (变体型, 对象型.读属性 (“Value”, ))
            
            加入成员 (表名, 变体型.取文本 ())
            
             ' 0.加入项目 (变体型.取文本 (), 1, , )
         ' .如果真结束
        表名列记录集.方法 (“MoveNext”, )
    .判断循环尾 ()
.如果真结束
表名列记录集.方法 (“Close”, )
ADODB连接.方法 (“Close”, )
返回 (真)


 ' 不属于任何一个程序集、类模块的函数：
