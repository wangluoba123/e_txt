 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 699
    高度 = 458
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “21点  关注易语言－－开局后按发牌处，发牌－－看牌双击庄家的扣牌”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于：”
    帮助文件名 = “”

窗口 玩家姓名窗口
    左边 = 50
    顶边 = 50
    宽度 = 200
    高度 = 124
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “请输入玩家姓名：”
    帮助文件名 = “”



.图片 图片1, " ' 已保存到：D:\易语言学习\Data\21p.e\图片1", , 
.图片 图片2, " ' 已保存到：D:\易语言学习\Data\21p.e\图片2", , 
.图片 图片3, " ' 已保存到：D:\易语言学习\Data\21p.e\图片3", , 
.图片 图片4, " ' 已保存到：D:\易语言学习\Data\21p.e\图片4", , 
.图片 图片5, " ' 已保存到：D:\易语言学习\Data\21p.e\图片5", , 
.图片 图片6, " ' 已保存到：D:\易语言学习\Data\21p.e\图片6", , 
.图片 图片7, " ' 已保存到：D:\易语言学习\Data\21p.e\图片7", , 
.图片 图片8, " ' 已保存到：D:\易语言学习\Data\21p.e\图片8", , 
.图片 图片9, " ' 已保存到：D:\易语言学习\Data\21p.e\图片9", , 
.图片 图片10, " ' 已保存到：D:\易语言学习\Data\21p.e\图片10", , 
.图片 图片11, " ' 已保存到：D:\易语言学习\Data\21p.e\图片11", , 
.图片 图片12, " ' 已保存到：D:\易语言学习\Data\21p.e\图片12", , 
.图片 图片13, " ' 已保存到：D:\易语言学习\Data\21p.e\图片13", , 
.图片 图片14, " ' 已保存到：D:\易语言学习\Data\21p.e\图片14", , 
.图片 图片15, " ' 已保存到：D:\易语言学习\Data\21p.e\图片15", , 
.图片 图片16, " ' 已保存到：D:\易语言学习\Data\21p.e\图片16", , 
.图片 图片17, " ' 已保存到：D:\易语言学习\Data\21p.e\图片17", , 
.图片 图片18, " ' 已保存到：D:\易语言学习\Data\21p.e\图片18", , 
.图片 图片19, " ' 已保存到：D:\易语言学习\Data\21p.e\图片19", , 
.图片 图片20, " ' 已保存到：D:\易语言学习\Data\21p.e\图片20", , 
.图片 图片21, " ' 已保存到：D:\易语言学习\Data\21p.e\图片21", , 
.图片 图片22, " ' 已保存到：D:\易语言学习\Data\21p.e\图片22", , 
.图片 图片23, " ' 已保存到：D:\易语言学习\Data\21p.e\图片23", , 
.图片 图片24, " ' 已保存到：D:\易语言学习\Data\21p.e\图片24", , 
.图片 图片25, " ' 已保存到：D:\易语言学习\Data\21p.e\图片25", , 
.图片 图片26, " ' 已保存到：D:\易语言学习\Data\21p.e\图片26", , 
.图片 图片27, " ' 已保存到：D:\易语言学习\Data\21p.e\图片27", , 
.图片 图片28, " ' 已保存到：D:\易语言学习\Data\21p.e\图片28", , 
.图片 图片29, " ' 已保存到：D:\易语言学习\Data\21p.e\图片29", , 
.图片 图片30, " ' 已保存到：D:\易语言学习\Data\21p.e\图片30", , 
.图片 图片31, " ' 已保存到：D:\易语言学习\Data\21p.e\图片31", , 
.图片 图片32, " ' 已保存到：D:\易语言学习\Data\21p.e\图片32", , 
.图片 图片33, " ' 已保存到：D:\易语言学习\Data\21p.e\图片33", , 
.图片 图片34, " ' 已保存到：D:\易语言学习\Data\21p.e\图片34", , 
.图片 图片35, " ' 已保存到：D:\易语言学习\Data\21p.e\图片35", , 
.图片 图片36, " ' 已保存到：D:\易语言学习\Data\21p.e\图片36", , 
.图片 图片37, " ' 已保存到：D:\易语言学习\Data\21p.e\图片37", , 
.图片 图片38, " ' 已保存到：D:\易语言学习\Data\21p.e\图片38", , 
.图片 图片39, " ' 已保存到：D:\易语言学习\Data\21p.e\图片39", , 
.图片 图片40, " ' 已保存到：D:\易语言学习\Data\21p.e\图片40", , 
.图片 图片41, " ' 已保存到：D:\易语言学习\Data\21p.e\图片41", , 
.图片 图片42, " ' 已保存到：D:\易语言学习\Data\21p.e\图片42", , 
.图片 图片43, " ' 已保存到：D:\易语言学习\Data\21p.e\图片43", , 
.图片 图片44, " ' 已保存到：D:\易语言学习\Data\21p.e\图片44", , 
.图片 图片45, " ' 已保存到：D:\易语言学习\Data\21p.e\图片45", , 
.图片 图片46, " ' 已保存到：D:\易语言学习\Data\21p.e\图片46", , 
.图片 图片47, " ' 已保存到：D:\易语言学习\Data\21p.e\图片47", , 
.图片 图片48, " ' 已保存到：D:\易语言学习\Data\21p.e\图片48", , 
.图片 图片49, " ' 已保存到：D:\易语言学习\Data\21p.e\图片49", , 
.图片 图片50, " ' 已保存到：D:\易语言学习\Data\21p.e\图片50", , 
.图片 图片51, " ' 已保存到：D:\易语言学习\Data\21p.e\图片51", , 
.图片 图片52, " ' 已保存到：D:\易语言学习\Data\21p.e\图片52", , 
.图片 图片53, "", , 
.图片 扑克背面, " ' 已保存到：D:\易语言学习\Data\21p.e\扑克背面", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库




.全局变量 玩家姓名, 文本型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 玩家总点数, 整数型, , , 
.程序集变量 庄家总点数, 整数型, , , 
.程序集变量 分组玩家总点数, 整数型, , , 
.程序集变量 玩家牌数, 整数型, , , 
.程序集变量 玩家扑克集, 整数型, , "6", 我估计一般一轮不会超过6张
.程序集变量 分组玩家牌数, 整数型, , , 超了的话 就 GAME OVER！
.程序集变量 分组玩家扑克集, 整数型, , "6", 
.程序集变量 庄家牌数, 整数型, , , 
.程序集变量 庄家扑克集, 整数型, , "6", 
.程序集变量 扑克牌集, 整数型, , "52", 从这里发已经初始化的牌
.程序集变量 发牌位置, 整数型, , , 
.程序集变量 盘数, 整数型, , , 当前玩家玩的盘数 
.程序集变量 玩家赌资, 整数型, , , 
.程序集变量 下注金额, 整数型, , , 
.程序集变量 发牌标志, 整数型, , , 1:初次开牌 2:玩家开牌 3:庄家开牌 4:分组玩家开牌
.程序集变量 是否分组, 逻辑型, , , 真：已分组  假：未分组
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 temp, 空白型, , , 

.如果 (等于 (取操作系统类别 (), 1))
    赋值 (_启动窗口., 458)
.否则
    赋值 (_启动窗口., 462)
.如果结束
赋值 (玩家赌资, 10000)

.子程序 _关于_被选择, 空白型, , 
载入 (关于窗口, , 真)

.子程序 _退出_被选择, 空白型, , 
销毁 ()

.子程序 _开局_被选择, 空白型, , 
.如果 (是否可以下注 ())
    开局是否下注 (假)
    检查玩家姓名 ()
    赋值 (盘数, 相加 (盘数, 1))
    赋值 (., 假)
    赋值 (发牌标志, 1)
    赋值 (是否分组, 假)
    赋值 (分组玩家牌数, 0)
    赋值 (玩家总点数, 0)
    赋值 (庄家总点数, 0)
    赋值 (分组玩家总点数, 0)
    赋值 (玩家牌数, 0)
    赋值 (分组玩家牌数, 0)
    赋值 (庄家牌数, 0)
    赋值 (发牌位置, 0)
    赋值 (., “双家开牌”)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    
    数组清零 (玩家扑克集)
    数组清零 (庄家扑克集)
    数组清零 (分组玩家扑克集)
    初始化扑克 ()
    更新信息 ()
    
.否则
    
.如果结束


.子程序 _发牌区_图形按钮_被单击, 空白型, , 

.如果 (等于 (发牌标志, 1))
    先手牌 ()
    .如果 (是否爆点 (2))
        下注处理 (2, 假)
        赋值 (., 真)
        开局是否下注 (真)
        信息框 (“你已经爆点！”, 0, )
    .否则
        .如果 (是否爆点 (3))
            下注处理 (2, 真)
            赋值 (., 真)
            信息框 (“庄家已经爆点！”, 0, )
            开局是否下注 (真)
        .否则
            赋值 (发牌标志, 2)
            赋值 (., 假)
            赋值 (., 假)
            赋值 (., “发给玩家”)
        .如果结束
        
    .如果结束
    
.否则
    .如果 (等于 (发牌标志, 2))
        .如果 (小于 (玩家牌数, 6))
            玩家要牌 (2)
            .如果 (是否爆点 (2))
                下注处理 (2, 假)
                赋值 (., 真)
                信息框 (“你已经爆点！”, 0, )
                开局是否下注 (真)
            .否则
                赋值 (发牌标志, 3)
                赋值 (., 真)
                赋值 (., 真)
                赋值 (., “发给庄家”)
            .如果结束
            
        .否则
            信息框 (“此盘已平，请重新开始下一盘！”, 0, )
            赋值 (., 真)
        .如果结束
        
    .否则
        .如果 (等于 (发牌标志, 4))
            玩家要牌 (4)
            .如果 (是否爆点 (4))
                下注处理 (4, 真)
                赋值 (., 真)
                信息框 (“你已经爆点！”, 0, )
                开局是否下注 (真)
            .否则
                赋值 (发牌标志, 2)
            .如果结束
            
        .否则
            .如果 (等于 (发牌标志, 3))
                .如果 (小于 (庄家牌数, 6))
                    .如果 (是否爆点 (3))
                        下注处理 (2, 真)
                        赋值 (., 真)
                        信息框 (“庄家已经爆点！”, 0, )
                        
                    .否则
                        庄家要牌 ()
                        .如果 (等于 (是否分组, 假))
                            赋值 (发牌标志, 2)
                        .否则
                            赋值 (发牌标志, 4)
                        .如果结束
                        赋值 (., “发给玩家”)
                    .如果结束
                    
                    
                .否则
                    信息框 (“此盘已平，请重新开始下一盘！”, 0, )
                .如果结束
                
            .否则
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 初始化扑克, 空白型, , 
.局部变量 temp, 整数型, , , 
.局部变量 temp1, 整数型, , , 
.局部变量 temp2, 整数型, , , 

赋值 (temp, 1)
.计次循环首 (52, )
    赋值 (扑克牌集 [temp], temp)
    赋值 (temp, 相加 (temp, 1))
.计次循环尾 ()
置随机数种子 ()

.计次循环首 (200, )
    赋值 (temp, 取随机数 (1, 52))
    赋值 (temp1, 取随机数 (1, 52))
    赋值 (temp2, 扑克牌集 [temp])
    赋值 (扑克牌集 [temp], 扑克牌集 [temp1])
    赋值 (扑克牌集 [temp1], temp)
.计次循环尾 ()

.子程序 检查玩家姓名, 空白型, , 
.如果 (等于 (玩家姓名, “”))
    载入 (玩家姓名窗口, , 真)
.否则
    返回 ()
    
.如果结束


.子程序 是否可以下注, 逻辑型, , 
.如果 (.)
    .如果 (大于 (玩家赌资, 50))
        赋值 (下注金额, 50)
        返回 (真)
    .否则
        信息框 (“你的金额不足以支付下注金额！”, 0, )
        返回 (假)
    .如果结束
    
.否则
    .如果 (.)
        .如果 (大于 (玩家赌资, 100))
            赋值 (下注金额, 100)
            返回 (真)
        .否则
            信息框 (“你的金额不足以支付下注金额！”, 0, )
            返回 (假)
        .如果结束
        
    .否则
        .如果 (.)
            .如果 (大于 (玩家赌资, 500))
                赋值 (下注金额, 500)
                返回 (真)
            .否则
                信息框 (“你的金额不足以支付下注金额！”, 0, )
                返回 (假)
            .如果结束
            
        .否则
            .如果 (.)
                .如果 (大于 (玩家赌资, 5000))
                    赋值 (下注金额, 5000)
                    返回 (真)
                .否则
                    信息框 (“你的金额不足以支付下注金额！”, 0, )
                    返回 (假)
                .如果结束
                
            .否则
                返回 (假)
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 更新信息, 空白型, , 
赋值 (., 玩家姓名)
赋值 (., 到文本 (盘数))
赋值 (., 到文本 (玩家赌资))
赋值 (., 到文本 (下注金额))

.子程序 先手牌, 空白型, , 
赋值 (玩家扑克集 [1], 换算点数 (扑克牌集 [1]))
赋值 (玩家扑克集 [2], 换算点数 (扑克牌集 [2]))
赋值 (庄家扑克集 [1], 换算点数 (扑克牌集 [3]))
赋值 (庄家扑克集 [1], 换算点数 (扑克牌集 [4]))
赋值 (玩家牌数, 2)
赋值 (庄家牌数, 2)
赋值 (发牌位置, 5) ' 下一次应该发第五张牌
赋值 (玩家总点数, 相加 (玩家扑克集 [1], 玩家扑克集 [2]))
赋值 (庄家总点数, 相加 (庄家扑克集 [1], 庄家扑克集 [2]))

赋值 (., 换算图片 (扑克牌集 [1]))
赋值 (., 换算图片 (扑克牌集 [2]))
赋值 (., 真)
赋值 (., 真)

赋值 (., #扑克背面)
赋值 (., 换算图片 (扑克牌集 [3]))
赋值 (., 真)
赋值 (., 真)


.子程序 换算点数, 整数型, , 
.参数 牌值, 整数型, , 

.如果 (或者 (等于 (牌值, 1), 等于 (牌值, 2), 等于 (牌值, 3), 等于 (牌值, 4)))
    .如果 (等于 (., 假))
        返回 (1)
    .否则
        返回 (11)
    .如果结束
    
.否则
    .如果 (或者 (等于 (牌值, 5), 等于 (牌值, 6), 等于 (牌值, 7), 等于 (牌值, 8)))
        返回 (2)
    .否则
        .如果 (或者 (等于 (牌值, 9), 等于 (牌值, 10), 等于 (牌值, 11), 等于 (牌值, 12)))
            返回 (3)
        .否则
            .如果 (或者 (等于 (牌值, 13), 等于 (牌值, 14), 等于 (牌值, 15), 等于 (牌值, 16)))
                返回 (4)
            .否则
                .如果 (或者 (等于 (牌值, 17), 等于 (牌值, 18), 等于 (牌值, 19), 等于 (牌值, 20)))
                    返回 (5)
                .否则
                    .如果 (或者 (等于 (牌值, 21), 等于 (牌值, 22), 等于 (牌值, 23), 等于 (牌值, 24)))
                        返回 (6)
                    .否则
                        .如果 (或者 (等于 (牌值, 25), 等于 (牌值, 26), 等于 (牌值, 27), 等于 (牌值, 28)))
                            返回 (7)
                        .否则
                            .如果 (或者 (等于 (牌值, 29), 等于 (牌值, 30), 等于 (牌值, 31), 等于 (牌值, 32)))
                                返回 (8)
                            .否则
                                .如果 (或者 (等于 (牌值, 33), 等于 (牌值, 34), 等于 (牌值, 35), 等于 (牌值, 36)))
                                    返回 (9)
                                .否则
                                    返回 (10)
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 _软硬牌_选择框_被单击, 空白型, , 
.如果 (.)
    赋值 (., “A 软牌”)
.否则
    赋值 (., “A 硬牌”)
.如果结束


.子程序 换算图片, 字节集, , 
.参数 牌值, 整数型, , 

.如果 (并且 (大于或等于 (牌值, 1), 小于或等于 (牌值, 10)))
    .如果 (等于 (牌值, 1))
        返回 (#图片1)
    .否则
        .如果 (等于 (牌值, 2))
            返回 (#图片2)
        .否则
            .如果 (等于 (牌值, 3))
                返回 (#图片3)
            .否则
                .如果 (等于 (牌值, 4))
                    返回 (#图片4)
                .否则
                    .如果 (等于 (牌值, 5))
                        返回 (#图片5)
                    .否则
                        .如果 (等于 (牌值, 6))
                            返回 (#图片6)
                        .否则
                            .如果 (等于 (牌值, 7))
                                返回 (#图片7)
                            .否则
                                .如果 (等于 (牌值, 8))
                                    返回 (#图片8)
                                .否则
                                    .如果 (等于 (牌值, 9))
                                        返回 (#图片9)
                                    .否则
                                        .如果 (等于 (牌值, 10))
                                            返回 (#图片10)
                                        .否则
                                            
                                        .如果结束
                                        
                                    .如果结束
                                    
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.否则
    .如果 (并且 (大于或等于 (牌值, 11), 小于或等于 (牌值, 20)))
        .如果 (等于 (牌值, 11))
            返回 (#图片11)
        .否则
            .如果 (等于 (牌值, 12))
                返回 (#图片12)
            .否则
                .如果 (等于 (牌值, 13))
                    返回 (#图片13)
                .否则
                    .如果 (等于 (牌值, 14))
                        返回 (#图片14)
                    .否则
                        .如果 (等于 (牌值, 15))
                            返回 (#图片15)
                        .否则
                            .如果 (等于 (牌值, 16))
                                返回 (#图片16)
                            .否则
                                .如果 (等于 (牌值, 17))
                                    返回 (#图片17)
                                .否则
                                    .如果 (等于 (牌值, 18))
                                        返回 (#图片18)
                                    .否则
                                        .如果 (等于 (牌值, 19))
                                            返回 (#图片19)
                                        .否则
                                            .如果 (等于 (牌值, 20))
                                                返回 (#图片20)
                                            .否则
                                                
                                            .如果结束
                                            
                                        .如果结束
                                        
                                    .如果结束
                                    
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .否则
        .如果 (并且 (大于或等于 (牌值, 21), 小于或等于 (牌值, 30)))
            .如果 (等于 (牌值, 21))
                返回 (#图片21)
            .否则
                .如果 (等于 (牌值, 22))
                    返回 (#图片22)
                .否则
                    .如果 (等于 (牌值, 23))
                        返回 (#图片23)
                    .否则
                        .如果 (等于 (牌值, 24))
                            返回 (#图片24)
                        .否则
                            .如果 (等于 (牌值, 25))
                                返回 (#图片25)
                            .否则
                                .如果 (等于 (牌值, 26))
                                    返回 (#图片26)
                                .否则
                                    .如果 (等于 (牌值, 27))
                                        返回 (#图片27)
                                    .否则
                                        .如果 (等于 (牌值, 28))
                                            返回 (#图片28)
                                        .否则
                                            .如果 (等于 (牌值, 29))
                                                返回 (#图片29)
                                            .否则
                                                .如果 (等于 (牌值, 30))
                                                    返回 (#图片30)
                                                .否则
                                                    
                                                .如果结束
                                                
                                            .如果结束
                                            
                                        .如果结束
                                        
                                    .如果结束
                                    
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .否则
            .如果 (并且 (大于或等于 (牌值, 31), 小于或等于 (牌值, 40)))
                .如果 (等于 (牌值, 31))
                    返回 (#图片31)
                .否则
                    .如果 (等于 (牌值, 32))
                        返回 (#图片32)
                    .否则
                        .如果 (等于 (牌值, 33))
                            返回 (#图片33)
                        .否则
                            .如果 (等于 (牌值, 34))
                                返回 (#图片34)
                            .否则
                                .如果 (等于 (牌值, 35))
                                    返回 (#图片35)
                                .否则
                                    .如果 (等于 (牌值, 36))
                                        返回 (#图片36)
                                    .否则
                                        .如果 (等于 (牌值, 37))
                                            返回 (#图片37)
                                        .否则
                                            .如果 (等于 (牌值, 38))
                                                返回 (#图片38)
                                            .否则
                                                .如果 (等于 (牌值, 39))
                                                    返回 (#图片39)
                                                .否则
                                                    .如果 (等于 (牌值, 40))
                                                        返回 (#图片40)
                                                    .否则
                                                        
                                                    .如果结束
                                                    
                                                .如果结束
                                                
                                            .如果结束
                                            
                                        .如果结束
                                        
                                    .如果结束
                                    
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                
            .否则
                .如果 (并且 (大于或等于 (牌值, 41), 小于或等于 (牌值, 51)))
                    .如果 (等于 (牌值, 41))
                        返回 (#图片41)
                    .否则
                        .如果 (等于 (牌值, 42))
                            返回 (#图片42)
                        .否则
                            .如果 (等于 (牌值, 43))
                                返回 (#图片43)
                            .否则
                                .如果 (等于 (牌值, 44))
                                    返回 (#图片44)
                                .否则
                                    .如果 (等于 (牌值, 45))
                                        返回 (#图片45)
                                    .否则
                                        .如果 (等于 (牌值, 46))
                                            返回 (#图片46)
                                        .否则
                                            .如果 (等于 (牌值, 47))
                                                返回 (#图片47)
                                            .否则
                                                .如果 (等于 (牌值, 48))
                                                    返回 (#图片48)
                                                .否则
                                                    .如果 (等于 (牌值, 49))
                                                        返回 (#图片49)
                                                    .否则
                                                        .如果 (等于 (牌值, 50))
                                                            返回 (#图片50)
                                                        .否则
                                                            .如果 (等于 (牌值, 51))
                                                                返回 (#图片51)
                                                            .否则
                                                                
                                                            .如果结束
                                                            
                                                        .如果结束
                                                        
                                                    .如果结束
                                                    
                                                .如果结束
                                                
                                            .如果结束
                                            
                                        .如果结束
                                        
                                    .如果结束
                                    
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    
                .否则
                    返回 (#图片52)
                    
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束
返回 (#图片53)


.子程序 换算图片框, 图片框, , 
.参数 玩家类别, 整数型, , 2:玩家 3:庄家 4:分组玩家
.参数 图片框序号, 整数型, , 

.如果 (等于 (玩家类别, 2))
    .如果 (等于 (图片框序号, 3))
        返回 ()
    .否则
        .如果 (等于 (图片框序号, 4))
            返回 ()
        .否则
            .如果 (等于 (图片框序号, 5))
                返回 ()
            .否则
                .如果 (等于 (图片框序号, 6))
                    返回 ()
                .否则
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.否则
    .如果 (等于 (玩家类别, 4))
        .如果 (等于 (图片框序号, 1))
            返回 ()
        .否则
            .如果 (等于 (图片框序号, 2))
                返回 ()
            .否则
                .如果 (等于 (图片框序号, 3))
                    返回 ()
                .否则
                    .如果 (等于 (图片框序号, 4))
                        返回 ()
                    .否则
                        .如果 (等于 (图片框序号, 5))
                            返回 ()
                        .否则
                            .如果 (等于 (图片框序号, 6))
                                返回 ()
                            .否则
                                
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .否则
        .如果 (等于 (玩家类别, 3))
            .如果 (等于 (图片框序号, 3))
                返回 ()
            .否则
                .如果 (等于 (图片框序号, 4))
                    返回 ()
                .否则
                    .如果 (等于 (图片框序号, 5))
                        返回 ()
                    .否则
                        .如果 (等于 (图片框序号, 6))
                            返回 ()
                        .否则
                            
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .否则
            
        .如果结束
        
    .如果结束
    
.如果结束
返回 ()


.子程序 玩家要牌, 空白型, , 
.参数 分组玩家, 整数型, , 2:玩家 4:分组玩家

.如果 (等于 (分组玩家, 2))
    赋值 (玩家扑克集 [相加 (玩家牌数, 1)], 换算点数 (扑克牌集 [发牌位置]))
    赋值 (玩家总点数, 相加 (玩家总点数, 玩家扑克集 [相加 (玩家牌数, 1)]))
    赋值 ( [换算图片框 (2, 相加 (玩家牌数, 1))]., 换算图片 (扑克牌集 [发牌位置]))
    赋值 ( [换算图片框 (2, 相加 (玩家牌数, 1))]., 真)
    赋值 (玩家牌数, 相加 (玩家牌数, 1))
    赋值 (发牌位置, 相加 (发牌位置, 1))
.否则
    .如果 (等于 (分组玩家, 4))
        赋值 (分组玩家扑克集 [相加 (分组玩家牌数, 1)], 换算点数 (扑克牌集 [发牌位置]))
        赋值 (分组玩家总点数, 相加 (分组玩家总点数, 分组玩家扑克集 [相加 (分组玩家牌数, 1)]))
        赋值 ( [换算图片框 (4, 相加 (分组玩家牌数, 1))]., 换算图片 (扑克牌集 [发牌位置]))
        赋值 ( [换算图片框 (4, 相加 (分组玩家牌数, 1))]., 真)
        赋值 (分组玩家牌数, 相加 (分组玩家牌数, 1))
        赋值 (发牌位置, 相加 (发牌位置, 1))
    .否则
        
    .如果结束
    
.如果结束


.子程序 庄家要牌, 空白型, , 
赋值 (庄家扑克集 [相加 (庄家牌数, 1)], 换算点数 (扑克牌集 [发牌位置]))
赋值 (庄家总点数, 相加 (庄家总点数, 庄家扑克集 [相加 (庄家牌数, 1)]))
赋值 ( [换算图片框 (3, 相加 (庄家牌数, 1))]., 换算图片 (扑克牌集 [发牌位置]))
赋值 ( [换算图片框 (3, 相加 (庄家牌数, 1))]., 真)
赋值 (庄家牌数, 相加 (庄家牌数, 1))
赋值 (发牌位置, 相加 (发牌位置, 1))

.子程序 是否爆点, 逻辑型, , 
.参数 玩家, 整数型, , 

.如果 (等于 (玩家, 2))
    .如果 (大于 (玩家总点数, 21))
        返回 (真)
    .否则
        返回 (假)
    .如果结束
    
.否则
    .如果 (等于 (玩家, 3))
        .如果 (大于 (庄家总点数, 21))
            返回 (真)
        .否则
            返回 (假)
        .如果结束
        
    .否则
        .如果 (等于 (玩家, 4))
            .如果 (大于 (分组玩家总点数, 21))
                返回 (真)
            .否则
                返回 (假)
            .如果结束
            
        .否则
            
        .如果结束
        
    .如果结束
    
.如果结束
返回 (假)

.子程序 下注处理, 空白型, , 
.参数 玩家, 整数型, , 2:玩家 4：分组玩家
.参数 输赢标志, 逻辑型, , 真：赢  假：输

.如果 (并且 (等于 (玩家, 2), 等于 (输赢标志, 真)))
    赋值 (玩家赌资, 相加 (玩家赌资, 下注金额))
.否则
    .如果 (并且 (等于 (玩家, 2), 等于 (输赢标志, 假)))
        赋值 (玩家赌资, 相减 (玩家赌资, 下注金额))
    .否则
        .如果 (并且 (等于 (玩家, 4), 等于 (输赢标志, 真)))
            赋值 (玩家赌资, 相加 (玩家赌资, 下注金额))
        .否则
            .如果 (并且 (等于 (玩家, 4), 等于 (输赢标志, 假)))
                赋值 (玩家赌资, 相减 (玩家赌资, 下注金额))
            .否则
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 _庄家_扑克1图片框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 真)
赋值 (., 换算图片 (庄家扑克集 [1]))
.如果 (大于 (玩家总点数, 庄家总点数))
    信息框 (“你赢了。”, 0, )
    下注处理 (2, 真)
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., 真)
    开局是否下注 (真)
.否则
    信息框 (“你输了，要再接再厉啊！”, 0, )
    下注处理 (2, 假)
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., 真)
    开局是否下注 (真)
.如果结束


.子程序 开局是否下注, 空白型, , 
.参数 下注标志, 逻辑型, , 真:可以下注 假:不能下注了

.如果 (等于 (下注标志, 真))
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    
.否则
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., 真)
    
.如果结束


.子程序 双倍处理, 空白型, , 


.子程序 是否为黑杰克, 逻辑型, , 真：是黑杰克  假：否
.参数 玩家, 整数型, , 2:玩家 3:庄家 4:分组玩家

.如果 (等于 (玩家, 2))
    .如果 (或者 (等于 (扑克牌集 [1], 1), 等于 (扑克牌集 [1], 2), 等于 (扑克牌集 [1], 3), 等于 (扑克牌集 [1], 4)))
        .如果 (或者 (等于 (扑克牌集 [2], 37), 等于 (扑克牌集 [2], 38), 等于 (扑克牌集 [2], 39), 等于 (扑克牌集 [2], 40)))
            返回 (真)
        .否则
            返回 (假)
        .如果结束
        
    .否则
        .如果 (或者 (等于 (扑克牌集 [1], 37), 等于 (扑克牌集 [1], 38), 等于 (扑克牌集 [1], 39), 等于 (扑克牌集 [1], 40)))
            .如果 (或者 (等于 (扑克牌集 [2], 1), 等于 (扑克牌集 [2], 2), 等于 (扑克牌集 [2], 3), 等于 (扑克牌集 [2], 4)))
                返回 (真)
            .否则
                返回 (假)
            .如果结束
            
        .否则
            
        .如果结束
        
    .如果结束
    
.否则
    .如果 (等于 (玩家, 3))
        .如果 (或者 (等于 (扑克牌集 [3], 1), 等于 (扑克牌集 [3], 2), 等于 (扑克牌集 [3], 3), 等于 (扑克牌集 [3], 4)))
            .如果 (或者 (等于 (扑克牌集 [4], 37), 等于 (扑克牌集 [4], 38), 等于 (扑克牌集 [4], 39), 等于 (扑克牌集 [4], 40)))
                返回 (真)
            .否则
                返回 (假)
            .如果结束
            
        .否则
            .如果 (或者 (等于 (扑克牌集 [3], 37), 等于 (扑克牌集 [3], 38), 等于 (扑克牌集 [3], 39), 等于 (扑克牌集 [3], 40)))
                .如果 (或者 (等于 (扑克牌集 [4], 1), 等于 (扑克牌集 [4], 2), 等于 (扑克牌集 [4], 3), 等于 (扑克牌集 [4], 4)))
                    返回 (真)
                .否则
                    返回 (假)
                .如果结束
                
            .否则
                
            .如果结束
            
        .如果结束
        
    .否则
        
    .如果结束
    
.如果结束
返回 (假)

.子程序 保险处理, 空白型, , 


.窗口程序集 窗口程序集2, , , 

.子程序 _按钮1_被单击, 空白型, , 
.如果 (不等于 (., “”))
    赋值 (玩家姓名, .)
    销毁 ()
    
.否则
    信息框 (“姓名不能为空！”, 0, )
    
.如果结束



 ' 不属于任何一个程序集、类模块的函数：
