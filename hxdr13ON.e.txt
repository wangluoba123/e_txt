 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 883
    高度 = 404
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 窗口_查找科目
    左边 = 50
    顶边 = 50
    宽度 = 420
    高度 = 377
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “查找科目”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 5 系统核心支持库
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 1 3 高级表格支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一




.全局变量 数据库, 外部数据库, , , 
.全局变量 科目组, 文本型, , "2", 

.窗口程序集 窗口程序集1, , , 

.程序集变量 插入凭证行, 逻辑型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 表格宽度, 整数型, , "0", 
.局部变量 x, 整数型, , , 
.局部变量 表头标题, 文本型, , "0", 
.局部变量 凭证类型, 文本型, , "0", 
.局部变量 连接文本, 文本型, , , 

赋值 (表格宽度, { 200, 100, 200, 150, 150 })
赋值 (表头标题, { “摘      要”, “科目代码”, “科  目  名  称”, “借     方”, “贷     方” })
.计次循环首 (5, x)
    相减 (x, 1).未知支持库函数_32 (表格宽度 [x])
    0.未知支持库函数_9 (相减 (x, 1), #., 表头标题 [x])
.计次循环尾 ()
置单元格方式 ()
赋值 (凭证类型, { “记”, “收”, “付”, “转” })
.计次循环首 (取数组成员数 (凭证类型), x)
    凭证类型.加入项目 ( [x], )
.计次循环尾 ()
赋值 (.现行选中项, 0)
赋值 (数据库, )
赋值 (连接文本, 相加 (“DBQ=”, 取运行目录 (), “\科目.mdb;Driver={Microsoft Access Driver (*.mdb)};PWD=gasfdeveloper;”))
数据库.打开 (连接文本, )

.子程序 置单元格方式, 空白型, , 
.局部变量 x, 整数型, , , 

#..未知支持库函数_14 (#白色, 15200231)
0.未知支持库函数_25 (0, 0, 5, #.)
1.未知支持库函数_25 (3, 相减 (., 2), 4, #.)
相减 (., 1).未知支持库函数_58 (1, 相减 (., 1), 2)
相减 (., 1).未知支持库函数_25 (0, 相减 (., 1), 0, #.)

1.未知支持库函数_30 (#.)
3.未知支持库函数_30 (#.)
4.未知支持库函数_30 (#.)
1.未知支持库函数_41 (0)
3.未知支持库函数_41 (2)
4.未知支持库函数_41 (2)
置合计栏 ()


.子程序 置合计栏, 空白型, , 
相减 (., 1).未知支持库函数_9 (0, #., “合        计”)
相减 (., 1).未知支持库函数_53 (0, 相减 (., 1), 4, 真)

.子程序 _表格_将被编辑, 空白型, , 
.如果真 (不等于 (未知支持库函数_4 (), 0)) ' 核验摘要
    .如果真 (等于 (删首尾空 (未知支持库函数_3 ().未知支持库函数_10 (0)), “”))
        信息框 (“摘要不能为空”, 0, )
        未知支持库函数_3 ().未知支持库函数_0 (0)
        返回 ()
    .如果真结束
    
.如果真结束
.如果真 (或者 (等于 (未知支持库函数_4 (), 3), 等于 (未知支持库函数_4 (), 4))) ' 核验科目
    .如果真 (等于 (删首尾空 (未知支持库函数_3 ().未知支持库函数_10 (1)), “”))
        信息框 (“科目不能为空”, 0, )
        未知支持库函数_3 ().未知支持库函数_0 (1)
        返回 ()
    .如果真结束
    
.如果真结束




.子程序 _表格_结束编辑, 空白型, , 
.局部变量 sql, 文本型, , , 
.局部变量 jb, 整数型, , , 

.判断开始 (等于 (未知支持库函数_4 (), 1))
    赋值 (sql, 相加 (“select acc_id,acc_comment from acc_chart where acc_id='”, 未知支持库函数_3 ().未知支持库函数_10 (1), “' and sub_id_flag=0”))
    赋值 (jb, 数据库.查询 (sql))
    数据库.到首记录 (jb)
    .判断开始 (数据库.尾记录后 (jb))
        _按钮_搜索_被单击 ()
    .默认
        赋值 (科目组 [1], 数据库.读 (jb, 1))
        赋值 (科目组 [2], 数据库.读 (jb, 2))
        填科目 ()
    .判断结束
    数据库.关闭记录集 (jb)
.默认
    
.判断结束
3.未知支持库函数_66 (1, 相减 (., 2), )
4.未知支持库函数_66 (1, 相减 (., 2), )
未知支持库函数_68 ()


.子程序 _表格_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 差, 双精度小数型, , , 

.如果真 (并且 (等于 (未知支持库函数_3 (), 相减 (., 2)), 等于 (未知支持库函数_4 (), 4), 等于 (键代码, #回车键))) ' 插入新行
    3.未知支持库函数_69 ()
    4.未知支持库函数_69 ()
    .未知支持库函数_38 (相减 (., 1))
     ' 表格.清空单元格数据 (表格.行数 － 2, 3, 表格.行数 － 2, 4)
    3.未知支持库函数_66 (1, 相减 (., 2), )
    4.未知支持库函数_66 (1, 相减 (., 2), )
    
    
.如果真结束
.如果真 (等于 (键代码, #空格键)) ' 在借方或贷方栏按空格，系统自动找平
    .判断开始 (等于 (未知支持库函数_4 (), 3))
        赋值 (差, 相减 (到数值 (相减 (., 1).未知支持库函数_10 (4)), 到数值 (相减 (., 1).未知支持库函数_10 (3))))
    .默认
        赋值 (差, 相减 (到数值 (相减 (., 1).未知支持库函数_10 (3)), 到数值 (相减 (., 1).未知支持库函数_10 (4))))
    .判断结束
    未知支持库函数_3 ().未知支持库函数_9 (未知支持库函数_4 (), #., 到文本 (差))
    获取焦点 ()
    
.如果真结束
置合计栏 ()
未知支持库函数_68 ()

.子程序 _表格_光标位置改变, 空白型, , 
.判断开始 (并且 (等于 (未知支持库函数_4 (), 0), 大于 (未知支持库函数_3 (), 1), 不等于 (未知支持库函数_3 (), 相减 (., 1)))) ' 复制摘要
    未知支持库函数_3 ().未知支持库函数_9 (0, 1, 相减 (未知支持库函数_3 (), 1).未知支持库函数_10 (0))
.判断 (或者 (等于 (未知支持库函数_4 (), 1), 等于 (未知支持库函数_4 (), 2))) ' 添加搜索按钮
    赋值 (.可视, 真)
    .判断开始 (等于 (未知支持库函数_4 (), 1))
        赋值 (.左边, 相减 (相加 (., 0.未知支持库函数_44 (), 1.未知支持库函数_44 ()), 24))
    .默认
        赋值 (.左边, 相减 (相加 (., 0.未知支持库函数_44 (), 1.未知支持库函数_44 (), 2.未知支持库函数_44 ()), 24))
    .判断结束
    赋值 (.顶边, 相加 (., 相乘 (1.未知支持库函数_43 (), 未知支持库函数_3 ()), 3))
.默认
    赋值 (.可视, 假)
.判断结束


.子程序 _按钮_搜索_被单击, 空白型, , 
载入 (窗口_查找科目, _启动窗口, 真)
填科目 ()

.子程序 填科目, 空白型, , 
未知支持库函数_3 ().未知支持库函数_9 (1, 1, 科目组 [1])
未知支持库函数_3 ().未知支持库函数_9 (2, 1, 科目组 [2])
数组清零 (科目组)


.窗口程序集 窗口程序集2, , , 

.程序集变量 sql, 文本型, , , 
.子程序 _单选框_代码_被单击, 空白型, , 
赋值 (.选中, 真)
赋值 (.标题, “请输入科目代码后按回车键”)
赋值 (sql, “”)
显示科目 ()

.子程序 _单选框_名称_被单击, 空白型, , 
赋值 (.选中, 真)
赋值 (.标题, “请输入科目名称后按回车键”)
赋值 (sql, “”)
显示科目 ()

.子程序 _窗口_查找科目_创建完毕, 空白型, , 
.如果 (不等于 (删首尾空 (_启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 1)), “”))
    赋值 (sql, 相加 (“select acc_id,acc_comment from acc_chart where acc_id like'”, 删首尾空 (_启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 1)), “%' and sub_id_flag =0 order by acc_id”))
.否则
    赋值 (sql, “select acc_id,acc_comment from acc_chart where sub_id_flag =0 order by acc_id”)
.如果结束
显示科目 ()


.子程序 显示科目, 空白型, , 
.局部变量 jb, 整数型, , , 
.局部变量 h, 整数型, , , 

全部删除 ()
赋值 (jb, 数据库.查询 (sql))
数据库.到首记录 (jb)
.判断循环首 (等于 (数据库.尾记录后 (jb), 假))
    赋值 (h, .插入表项 (数据库.读 (jb, 1), , , , ))
    h.置标题 (1, 数据库.读 (jb, 2))
    数据库.到后一记录 (jb)
.判断循环尾 ()
数据库.关闭记录集 (jb)


.子程序 _编辑框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    .判断开始 (.选中)
        赋值 (sql, 相加 (“select acc_id,acc_comment from acc_chart where acc_id like'%”, 删首尾空 (.内容), “%' order by acc_id”))
    .默认
        赋值 (sql, 相加 (“select acc_id,acc_comment from acc_chart where acc_comment like'%”, 删首尾空 (.内容), “%' order by acc_id”))
    .判断结束
    显示科目 ()
.如果真结束


.子程序 _超级列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

重定义数组 (科目组, 假, 2)
赋值 (科目组 [1], .取标题 (., 0))
赋值 (科目组 [2], .取标题 (., 1))
销毁 ()



 ' 不属于任何一个程序集、类模块的函数：
