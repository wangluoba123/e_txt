 ' 文件类型：Windows窗口程序

 ' 程序名称：用电统计分析小工具
 ' 程序描述：
 ' 程序作者：肖军辉
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：arvin8@163.com
 ' 主页地址：http://138.3126.com
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 739
    高度 = 474
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “用电统计分析小工具(作者：射手马 QQ：1881775686 网址：http://138.3126.com)”
    帮助文件名 = “”

窗口 基本信息设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 326
    高度 = 411
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “基本信息设置”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' EChartBar 9A3F84D7FDEB4a0486F2711D5104B7F7 1 6 数据图表支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库




.全局变量 方法, 空白型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 变量1, 空白型, , , 
.程序集变量 警戒线, 空白型, , , 
.程序集变量 当月天数, 空白型, , , 
.程序集变量 月份, 文本型, , , 
.程序集变量 上月月份, 文本型, , , 
.程序集变量 状态, 空白型, , , 
.程序集变量 数据目录, 文本型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 用户数, 空白型, , , 
.局部变量 字段信息表, 字段信息, , "13", 

未知支持库函数_0 (#)
创建目录 (到文本 (取年份 (取现行时间 ())))
赋值 (数据目录, 到文本 (取年份 (取现行时间 ())))
.如果 (等于 (文件是否存在 (相加 (取当前目录 (), “\list.edb”)), 假))
    赋值 (字段信息表 [1].名称, “总户号”)
    赋值 (字段信息表 [2].名称, “户名”)
    赋值 (字段信息表 [3].名称, “地址”)
    赋值 (字段信息表 [4].名称, “抄表日”)
    赋值 (字段信息表 [5].名称, “缴费日”)
    赋值 (字段信息表 [6].名称, “服务电话”)
    赋值 (字段信息表 [7].名称, “报修电话”)
    赋值 (字段信息表 [8].名称, “缴费点1”)
    赋值 (字段信息表 [9].名称, “缴费点2”)
    赋值 (字段信息表 [10].名称, “初始电度”)
    赋值 (字段信息表 [11].名称, “用电单价”)
    赋值 (字段信息表 [12].名称, “电表期限”)
    赋值 (字段信息表 [12].类型, #日期时间型)
    赋值 (字段信息表 [13].名称, “备注”)
    连续赋值 (#文本型, 字段信息表 [1].类型, 字段信息表 [2].类型, 字段信息表 [3].类型, 字段信息表 [4].类型, 字段信息表 [5].类型, 字段信息表 [6].类型, 字段信息表 [7].类型, 字段信息表 [8].类型, 字段信息表 [9].类型, 字段信息表 [13].类型)
    连续赋值 (50, 字段信息表 [1].最大文本长度, 字段信息表 [2].最大文本长度, 字段信息表 [3].最大文本长度, 字段信息表 [4].最大文本长度, 字段信息表 [5].最大文本长度, 字段信息表 [6].最大文本长度, 字段信息表 [7].最大文本长度, 字段信息表 [8].最大文本长度, 字段信息表 [9].最大文本长度, 字段信息表 [13].最大文本长度)
    连续赋值 (#双精度小数型, 字段信息表 [10].类型, 字段信息表 [11].类型)
    .如果 (等于 (创建 (相加 (取当前目录 (), “\list.edb”), 字段信息表), 假))
        信息框 (“无法创建总户号数据库文件，请关闭程序后重试!”, 0, “对不起!”)
        返回 ()
    .否则
        
    .如果结束
    
.否则
    
.如果结束
打开 (相加 (取当前目录 (), “\list.edb”), , , , , , )
到首记录 ()
赋值 (用户数, 取记录数 ())
.如果 (大于 (用户数, 1))
    .计次循环首 ()
        读 (1).加入项目 ()
        .如果 (小于或等于 (到整数 (相加 (到文本 (取年份 (读 (12))), 到文本 (取月份 (读 (12))))), 相减 (到整数 (相加 (到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ())))), 1)))
            信息框 (相加 (“总户号为：”, 到文本 (读 (1)), “的电表校验有效期小于1个月!”, #换行符, “请及时校验或更换,以避免损失!”), 0, )
        .否则
            
        .如果结束
        跳过 ()
    .计次循环尾 ()
    关闭 ()
    赋值 (.现行选中项, 0)
    .如果 (等于 (“2006”))
        赋值 (.现行选中项, 0)
    .否则
        .如果 (等于 (“2007”))
            赋值 (.现行选中项, 0)
        .否则
            .如果 (等于 (“2008”))
                赋值 (.现行选中项, 0)
            .否则
                .如果 (等于 (“2009”))
                    赋值 (.现行选中项, 0)
                .否则
                    .如果 (等于 (“2010”))
                        赋值 (.现行选中项, 0)
                    .否则
                        .如果 (等于 (“2011”))
                            赋值 (.现行选中项, 0)
                        .否则
                            .如果 (等于 (“2012”))
                                赋值 (.现行选中项, 0)
                            .否则
                                .如果 (等于 (“2013”))
                                    赋值 (.现行选中项, 0)
                                .否则
                                    .如果 (等于 (“2014”))
                                        赋值 (.现行选中项, 0)
                                    .否则
                                        .如果 (等于 (“2015”))
                                            赋值 (.现行选中项, 0)
                                        .否则
                                            
                                        .如果结束
                                        
                                    .如果结束
                                    
                                .如果结束
                                
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .如果结束
    赋值 (.现行选中项, 相减 (取月份 (取现行时间 ()), 1))
    未知函数_67175131 ()
    赋值 (状态, 1)
.否则
    信息框 (“第一次使用此程序，现在设置电表基本信息!”, 0, “第一次使用”)
    赋值 (方法, 3)
    载入 (基本信息设置窗口, , 真)
.如果结束


.子程序 _组合框1_列表项被选择, 空白型, , 
刷新月度 ()

.子程序 _加入按钮_被单击, 空白型, , 
.局部变量 j1, 日期时间型, , , 
.局部变量 j2, 双精度小数型, , , 
.局部变量 j3, 双精度小数型, , , 
.局部变量 j4, 文本型, , , 
.局部变量 返回值, 整数型, , , 
.局部变量 最后记录, 双精度小数型, , , 
.局部变量 上月末记录, 双精度小数型, , , 
.局部变量 记录数, 空白型, , , 

.如果 (不等于 (.内容, “”))
    打开 (相加 (取当前目录 (), “\”, 数据目录, “\”, .取项目文本 (.现行选中项), 月份, “.edb”), , , , , , )
    到尾记录 ()
    赋值 (最后记录, 读 (2))
    赋值 (记录数, 取记录数 ())
    关闭 ()
    赋值 (j1, 取日期 (.今天))
    赋值 (j2, 到数值 (.内容))
    .如果 (等于 (最后记录, 0))
        .如果 (小于或等于 (记录数, 1))
            .如果 (等于 (文件是否存在 (相加 (取当前目录 (), “\”, 数据目录, “\”, .取项目文本 (.现行选中项), 上月月份, “.edb”)), 假))
                赋值 (j3, 0)
            .否则
                打开 (相加 (取当前目录 (), “\”, 数据目录, “\”, .取项目文本 (.现行选中项), 上月月份, “.edb”), , , , , , )
                到尾记录 ()
                赋值 (上月末记录, 读 (2))
                关闭 ()
                赋值 (j3, 相减 (j2, 上月末记录))
            .如果结束
            
        .否则
            赋值 (j3, 0)
        .如果结束
        
    .否则
        赋值 (j3, 相减 (j2, 最后记录))
        赋值 (j4, .内容)
    .如果结束
    打开 (相加 (取当前目录 (), “\”, 数据目录, “\”, .取项目文本 (.现行选中项), 月份, “.edb”), , , , , , )
    到首记录 ()
    .如果 (等于 (查找 (等于 (读 (1), j1)), 真))
        赋值 (返回值, 信息框 (“此日期已有数据！是否要修改此日期的数据？”, 4, ))
        .如果 (等于 (返回值, #是钮))
            跳到 (相减 (取记录号 (), 1))
            赋值 (j3, 相减 (j2, 读 (2)))
            跳过 ()
            修改 (j2, j3, j4)
        .否则
            获取焦点 ()
            返回 ()
        .如果结束
        
    .否则
        .如果 (等于 (加记录 (j1, j2, j3, j4), 假))
            信息框 (“加记录失败!”, 0, )
        .否则
            连续赋值 (假, .可视, .可视, .可视, .可视, .可视, .可视, .可视)
        .如果结束
        
    .如果结束
    关闭 ()
    刷新月度 ()
.否则
    信息框 (“请输入数据!”, 0, )
    获取焦点 ()
.如果结束


.子程序 _新增数据按钮_被单击, 空白型, , 
.如果 (不等于 (.现行选中项, -1))
    .如果 (等于 (状态, 1))
        .如果 (不等于 (.现行选中项, -1))
            
        .否则
            信息框 (“请选择月份后进行操作!”, 0, )
        .如果结束
        
    .否则
        .如果 (等于 (状态, 2))
            .如果 (不等于 (.现行选中项, -1))
                
            .否则
                信息框 (“请选择年份后进行操作!”, 0, )
            .如果结束
            
        .否则
            
        .如果结束
        
    .如果结束
    连续赋值 (真, .可视, .可视, .可视, .可视, .可视, .可视, .可视)
.否则
    信息框 (“请选择总户号后进行操作!”, 0, )
.如果结束


.子程序 刷新月度, 空白型, , 
.局部变量 天数, 空白型, , , 
.局部变量 字段信息表, 字段信息, , "4", 
.局部变量 取记录数, 整数型, , , 
.局部变量 年, 文本型, , , 
.局部变量 日, 文本型, , , 
.局部变量 月, 文本型, , , 
.局部变量 x, 空白型, , , 
.局部变量 j, 空白型, , , 

连续赋值 (假, .可视, .可视, .可视, .可视, .可视, .可视, .可视)
赋值 (.数据库文件名, “”)
.计次循环首 (当月天数, 变量1)
    赋值 (., 相减 (变量1, 1))
    赋值 (., 0)
    赋值 (., “”)
.计次循环尾 ()
赋值 (., 相加 (到文本 (取绝对值 (到整数 (月份))), “月 日用电量曲线图”))
赋值 (., #蓝色)
赋值 (., “日期”)
.如果 (等于 (文件是否存在 (相加 (取当前目录 (), “\”, 数据目录, “\”, .取项目文本 (.现行选中项), 月份, “.edb”)), 假))
    .如果 (不等于 (取绝对值 (到整数 (月份)), 取月份 (取现行时间 ())))
        赋值 (.可视, 真)
        赋值 (., #红色)
        赋值 (., 相加 (到文本 (取绝对值 (到整数 (月份))), “月份用电量曲线图(无数据)”))
        返回 ()
    .否则
        赋值 (字段信息表 [1].名称, “Data”)
        赋值 (字段信息表 [1].类型, #日期时间型)
        赋值 (字段信息表 [2].名称, “电表读数”)
        赋值 (字段信息表 [2].类型, #双精度小数型)
        赋值 (字段信息表 [3].名称, “电度”)
        赋值 (字段信息表 [3].类型, #双精度小数型)
        赋值 (字段信息表 [4].名称, “备注”)
        赋值 (字段信息表 [4].类型, #文本型)
        赋值 (字段信息表 [4].最大文本长度, 50)
        .如果 (等于 (创建 (相加 (取当前目录 (), “\”, 数据目录, “\”, .取项目文本 (.现行选中项), 月份, “.edb”), 字段信息表), 假))
            信息框 (“无法创建本月数据库文件，请关闭程序后重试!”, 0, “对不起!”)
        .否则
             ' 如果 (文件是否存在 (取当前目录 () ＋ “\"+数据目录+"\” ＋ 组合框1.取项目文本 (组合框1.现行选中项) ＋ 上月月份 ＋ “.edb”) ＝ 假)
            赋值 (年, 到文本 (取年份 (取现行时间 ())))
            .如果 (小于 (取日 (取现行时间 ()), 10))
                赋值 (日, 到文本 (取日 (取现行时间 ())))
            .否则
                赋值 (日, 到文本 (取日 (取现行时间 ())))
            .如果结束
            .如果 (小于 (取月份 (取现行时间 ()), 10))
                赋值 (月, 到文本 (取月份 (取现行时间 ())))
            .否则
                赋值 (月, 到文本 (取月份 (取现行时间 ())))
            .如果结束
            打开 (相加 (取当前目录 (), “\”, 数据目录, “\”, .取项目文本 (.现行选中项), 月份, “.edb”), , , , , , )
            赋值 (x, 相减 (到整数 (日), 1))
            .计次循环首 (x, 变量1)
                加记录 (到时间 (相加 (年, 月份, 到文本 (变量1))))
            .计次循环尾 ()
            关闭 ()
            
            
        .如果结束
        
    .如果结束
    
.否则
    
.如果结束
赋值 (.数据库文件名, 相加 (取当前目录 (), “\”, 数据目录, “\”, .取项目文本 (.现行选中项), 月份, “.edb”))
1.置列宽 (300)
2.置列宽 (200)
3.置列宽 (120)
赋值 (.可视, 假)
打开 (相加 (取当前目录 (), “\”, 数据目录, “\”, .取项目文本 (.现行选中项), 月份, “.edb”), , , , , , )
.如果 (小于 (取记录数 (), 1))
    赋值 (.可视, 真)
    赋值 (., #红色)
    赋值 (., 相加 (到文本 (取绝对值 (到整数 (月份))), “月份用电量曲线图(无数据)”))
.否则
    
.如果结束
.如果 (小于 (取最大值 (读 (3), ), 1))
    赋值 (., 10)
.否则
    赋值 (., 相乘 (取最大值 (读 (3), ), 1.5))
.如果结束
赋值 (., 10)
到首记录 ()
赋值 (天数, 取记录数 ())
.计次循环首 (当月天数, 变量1)
    赋值 (., 相减 (变量1, 1))
    赋值 (., 0)
    赋值 (., 到文本 (变量1))
.计次循环尾 ()
.计次循环首 (天数, 变量1)
    赋值 (., 相减 (取日 (读 (1)), 1))
    赋值 (., 读 (3))
    赋值 (., 到文本 (取日 (读 (1))))
    跳过 ()
.计次循环尾 ()
关闭 ()

.子程序 _删除记录按钮_被单击, 空白型, , 
.局部变量 返回值, 空白型, , , 

赋值 (返回值, 信息框 (“是否删除当前记录？”, 4, ))
.如果 (等于 (返回值, #是钮))
    取光标行号 ().删除行 ()
    .如果 (等于 (状态, 1))
        刷新月度 ()
    .否则
        .如果 (等于 (状态, 2))
            刷新年度 ()
        .否则
            
        .如果结束
        
    .如果结束
    
.否则
    连续赋值 (假, .可视, .可视, .可视, .可视, .可视, .可视, .可视)
.如果结束


.子程序 _月度曲线按钮_被单击, 空白型, , 
_组合框2_列表项被选择 ()
赋值 (状态, 1)

.子程序 刷新年度, 空白型, , 
.局部变量 字段信息表, 字段信息, , "3", 
.局部变量 年份, 文本型, , , 
.局部变量 年, 文本型, , , 
.局部变量 月, 文本型, , , 
.局部变量 x, 空白型, , , 
.局部变量 yy, 双精度小数型, , "0", 
.局部变量 z, 双精度小数型, , , 
.局部变量 xx, 文本型, , , 

赋值 (年份, 相加 (“-”, 到文本 (取年份 (取现行时间 ()))))
赋值 (.数据库文件名, “”)
赋值 (., 12)
赋值 (., “月份”)
.计次循环首 (12, 变量1)
    赋值 (., 相减 (变量1, 1))
    赋值 (., 0)
    赋值 (., “”)
.计次循环尾 ()
赋值 (., 相加 (到文本 (取绝对值 (到整数 (年份))), “年月用电量曲线图”))
赋值 (., #蓝色)
.如果 (等于 (文件是否存在 (相加 (取当前目录 (), “\”, 数据目录, “\”, .取项目文本 (.现行选中项), 年份, “.edb”)), 假))
    赋值 (字段信息表 [1].名称, “月份”)
    赋值 (字段信息表 [1].类型, #文本型)
    赋值 (字段信息表 [1].最大文本长度, 10)
    赋值 (字段信息表 [2].名称, “月用电量”)
    赋值 (字段信息表 [2].类型, #双精度小数型)
    赋值 (字段信息表 [3].名称, “备注”)
    赋值 (字段信息表 [3].类型, #文本型)
    赋值 (字段信息表 [3].最大文本长度, 50)
    .如果 (等于 (创建 (相加 (取当前目录 (), “\”, 数据目录, “\”, .取项目文本 (.现行选中项), 年份, “.edb”), 字段信息表), 假))
        信息框 (“无法创建本月数据库文件，请关闭程序后重试!”, 0, “对不起!”)
    .否则
        
    .如果结束
    
.否则
    
.如果结束
赋值 (.数据库文件名, 相加 (取当前目录 (), “\”, 数据目录, “\”, .取项目文本 (.现行选中项), 年份, “.edb”))
1.置列宽 (300)
2.置列宽 (200)
3.置列宽 (120)
赋值 (.可视, 假)
赋值 (年, 到文本 (取年份 (取现行时间 ())))
.如果 (小于 (取月份 (取现行时间 ()), 10))
    赋值 (月, 到文本 (取月份 (取现行时间 ())))
.否则
    赋值 (月, 到文本 (取月份 (取现行时间 ())))
.如果结束
赋值 (x, 到整数 (月))
.计次循环首 (x, 变量1)
    .如果 (小于 (变量1, 10))
        赋值 (xx, 相加 (“-0”, 到文本 (变量1)))
    .否则
        赋值 (xx, 相加 (“-”, 到文本 (变量1)))
    .如果结束
    .如果 (等于 (文件是否存在 (相加 (取当前目录 (), “\”, 数据目录, “\”, .取项目文本 (.现行选中项), xx, “.edb”)), 真))
        打开 (相加 (取当前目录 (), “\”, 数据目录, “\”, .取项目文本 (.现行选中项), xx, “.edb”), , , , , , )
        赋值 (z, 求和 (读 (3), ))
        加入成员 (yy, z)
    .否则
        加入成员 (yy, 0)
    .如果结束
    关闭 ()
.计次循环尾 ()
打开 (相加 (取当前目录 (), “\”, 数据目录, “\”, .取项目文本 (.现行选中项), 年份, “.edb”), , , , , , )
.如果 (不等于 (取记录数 (), 到整数 (月)))
    删除 (真)
    彻底删除 ()
    .计次循环首 (x, 变量1)
        加记录 (相加 (年, “年”, 到文本 (变量1), “月”), yy [变量1])
    .计次循环尾 ()
.否则
    
.如果结束
.如果 (小于 (取最大值 (读 (2), ), 1))
    赋值 (., 100)
    赋值 (., 10)
.否则
    赋值 (., 相乘 (取最大值 (读 (2), ), 1.2))
    赋值 (., 整除 (相乘 (取最大值 (读 (2), ), 1.2), 20))
.如果结束
到首记录 ()
.计次循环首 (12, 变量1)
    赋值 (., 相减 (变量1, 1))
    赋值 (., 读 (2))
    赋值 (., 到文本 (读 (1)))
    跳过 ()
.计次循环尾 ()
关闭 ()
赋值 (状态, 2)

.子程序 _数据录入_被选择, 空白型, , 
_新增数据按钮_被单击 ()

.子程序 _退出_被选择, 空白型, , 
结束 ()

.子程序 _月度曲线_被选择, 空白型, , 
刷新月度 ()

.子程序 _年度曲线_被选择, 空白型, , 
刷新年度 ()

.子程序 _新建总户号_被选择, 空白型, , 
赋值 (方法, 2)
载入 (基本信息设置窗口, , 真)

.子程序 _修改资料_被选择, 空白型, , 
赋值 (方法, 1)
载入 (基本信息设置窗口, , 真)

.子程序 _关于_被选择, 空白型, , 
信息框 (相加 (“本工具只是将您每日从电表上读来的数据进行统计分析，”, #换行符, “帮助您分析某日或某月的用电量是否异常，以便即时发现问题！”), 0, “关于”)

.子程序 _设置_被选择, 空白型, , 
赋值 (方法, 1)
载入 (基本信息设置窗口, , 真)

.子程序 _组合框2_列表项被选择, 空白型, , 
连续赋值 (假, .可视, .可视, .可视, .可视, .可视, .可视, .可视)
.如果 (小于 (.取项目数值 (.现行选中项), 10))
    赋值 (月份, 相加 (“-0”, 到文本 (.取项目数值 (.现行选中项))))
    赋值 (上月月份, 相加 (“-0”, 到文本 (相减 (.取项目数值 (.现行选中项), 1))))
.否则
    赋值 (月份, 相加 (“-”, 到文本 (.取项目数值 (.现行选中项))))
    赋值 (上月月份, 相加 (“-”, 到文本 (相减 (.取项目数值 (.现行选中项), 1))))
.如果结束
赋值 (当月天数, 取某月天数 (取年份 (取现行时间 ()), 取绝对值 (到整数 (月份))))
赋值 (., 当月天数)
赋值 (.最小日期, 到时间 (相加 (到文本 (取年份 (取现行时间 ())), 取文本右边 (月份, 2), “01”)))
赋值 (.最大日期, 到时间 (相加 (到文本 (取年份 (取现行时间 ())), 取文本右边 (月份, 2), 到文本 (当月天数))))
刷新月度 ()

.子程序 _刷新显示按钮2_被单击, 空白型, , 
.局部变量 y, 双精度小数型, , "0", 
.局部变量 z, 双精度小数型, , , 
.局部变量 xx, 文本型, , , 

 ' 年 ＝ 到文本 (取年份 (取现行时间 ()))
 ' .如果 (小于 (取月份 (取现行时间 ()), 10))
     ' 月 ＝ 到文本 (取月份 (取现行时间 ()))
.否则
     ' 月 ＝ 到文本 (取月份 (取现行时间 ()))
.如果结束
 ' x ＝ 到整数 (月)
 ' .计次循环首 (变量1)
     ' .如果 (小于 (变量1, 10))
         ' xx ＝ “-0” ＋ 到文本 (变量1)
    .否则
         ' xx ＝ “-” ＋ 到文本 (变量1)
    .如果结束
     ' 如果 (文件是否存在 (取当前目录 () ＋ “\"+数据目录+"\” ＋ 组合框1.取项目文本 (组合框1.现行选中项) ＋ xx ＋ “.edb”) ＝ 真)
     ' 打开 (取当前目录 () ＋ “\"+数据目录+"\” ＋ 组合框1.取项目文本 (组合框1.现行选中项) ＋ xx ＋ “.edb”, , , , , , )
     ' z ＝ 求和 (读 (3), )
     ' 加入成员 (y, z)
     ' 加入成员 (y, 0)
     ' 关闭 ()
 ' .计次循环尾 ()
 ' .计次循环首 (变量1)
     ' 信息框 (y [变量1], 0, )
 ' .计次循环尾 ()
 ' 王权德13912651373

.子程序 _年度曲线按钮_被单击, 空白型, , 
刷新年度 ()

.子程序 _刷新显示按钮_被单击, 空白型, , 
.如果 (等于 (状态, 1))
    刷新月度 ()
.否则
    .如果 (等于 (状态, 2))
        刷新年度 ()
    .否则
        
    .如果结束
    
.如果结束


.窗口程序集 窗口程序集2, , , 

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 返回值, 空白型, , , 
.局部变量 日期, 日期时间型, , , 
.局部变量 电量, 双精度小数型, , , 
.局部变量 单价, 双精度小数型, , , 

 ' 打开 (取当前目录 () ＋ “\list.edb”, , , , , , )
到首记录 ()
.如果 (等于 (.选中, 真))
    赋值 (日期, 取日期 (.今天))
.否则
    赋值 (日期, 到时间 (0))
.如果结束
赋值 (电量, 到数值 (.内容))
赋值 (单价, 到数值 (.内容))
.如果 (查找 (等于 (读 (1), .内容)))
    .如果 (等于 (.内容, “”))
        信息框 (“户名不可为空!”, 0, )
        关闭 ()
        返回 ()
    .否则
        .如果 (等于 (.内容, “”))
            信息框 (“初始电度不可为空!”, 0, )
            关闭 ()
            返回 ()
        .否则
            .如果 (等于 (.内容, “”))
                信息框 (“用电单价不可为空!”, 0, )
                关闭 ()
                返回 ()
            .否则
                
            .如果结束
            
        .如果结束
        
    .如果结束
    赋值 (返回值, 信息框 (“当总户号已存在，是否修改？”, 4, “是否修改？”))
    .如果 (等于 (返回值, #是钮))
        .如果 (等于 (修改 (.内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, 电量, 单价, 日期, .内容), 假))
            信息框 (“修改总户失败!”, 0, )
        .否则
            信息框 (“修改总户成功!”, 0, )
        .如果结束
        
    .否则
        
    .如果结束
    
.否则
    .如果 (等于 (.内容, “”))
        信息框 (“户名不可为空!”, 0, )
        关闭 ()
        返回 ()
    .否则
        .如果 (等于 (.内容, “”))
            信息框 (“用电单价不可为空!”, 0, )
            关闭 ()
            返回 ()
        .否则
            .如果 (等于 (加记录 (.内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, 电量, 单价, 日期, .内容), 假))
                信息框 (“增加总户失败!”, 0, )
            .否则
                信息框 (“增加总户成功!”, 0, )
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束
赋值 (.可视, 假)
赋值 (.选中, 假)
.如果 (不等于 (方法, 1))
    加入项目 ()

.子程序 _编辑框1_内容被改变, 空白型, , 
 ' 打开 (取当前目录 () ＋ “\list.edb”, , , , , , )
到首记录 ()
.如果 (查找 (等于 (读 (1), .内容)))
    赋值 (.内容, 读 (2))
    赋值 (.内容, 读 (3))
    赋值 (.内容, 读 (4))
    赋值 (.内容, 读 (5))
    赋值 (.内容, 读 (6))
    赋值 (.内容, 读 (7))
    赋值 (.内容, 读 (8))
    赋值 (.内容, 读 (9))
    赋值 (.内容, 到文本 (读 (10)))
    赋值 (.内容, 到文本 (读 (11)))
    .如果 (小于 (读 (12), 到时间 (“2006年6月1日”)))
        赋值 (.可视, 假)
        赋值 (.选中, 假)
    .否则
        赋值 (.可视, 真)
        赋值 (.选中, 真)
        赋值 (.今天, 读 (12))
    .如果结束
    赋值 (.内容, 读 (13))
.否则
    
.如果结束
 ' 关闭 ()

.子程序 _编辑框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

 ' 打开 (取当前目录 () ＋ “\list.edb”, , , , , , )
.如果 (或者 (等于 (键代码, #PageUp键), 等于 (键代码, #上光标键), 等于 (键代码, #左光标键)))
    .如果 (并且 (等于 (取记录号 (), 1), 等于 (取记录数 (), 1)))
        到首记录 ()
    .否则
        跳到 (相减 (取记录号 (), 1))
    .如果结束
    赋值 (.内容, 读 (1))
    赋值 (.内容, 读 (2))
    赋值 (.内容, 读 (3))
    赋值 (.内容, 读 (4))
    赋值 (.内容, 读 (5))
    赋值 (.内容, 读 (6))
    赋值 (.内容, 读 (7))
    赋值 (.内容, 读 (8))
    赋值 (.内容, 读 (9))
    赋值 (.内容, 到文本 (读 (10)))
    赋值 (.内容, 到文本 (读 (11)))
    .如果 (小于 (读 (12), 到时间 (“2006年6月1日”)))
        赋值 (.可视, 假)
        赋值 (.选中, 假)
    .否则
        赋值 (.可视, 真)
        赋值 (.选中, 真)
        赋值 (.今天, 读 (12))
    .如果结束
    赋值 (.内容, 读 (13))
.否则
    .如果 (或者 (等于 (键代码, #PageDown键), 等于 (键代码, #下光标键), 等于 (键代码, #右光标键)))
        .如果 (并且 (等于 (取记录号 (), 取记录数 ()), 等于 (取记录数 (), 1)))
            到尾记录 ()
        .否则
            跳到 (相加 (取记录号 (), 1))
        .如果结束
        赋值 (.内容, 读 (1))
        赋值 (.内容, 读 (2))
        赋值 (.内容, 读 (3))
        赋值 (.内容, 读 (4))
        赋值 (.内容, 读 (5))
        赋值 (.内容, 读 (6))
        赋值 (.内容, 读 (7))
        赋值 (.内容, 读 (8))
        赋值 (.内容, 读 (9))
        赋值 (.内容, 到文本 (读 (10)))
        赋值 (.内容, 到文本 (读 (11)))
        .如果 (小于 (读 (12), 到时间 (“2006年6月1日”)))
            赋值 (.可视, 假)
            赋值 (.选中, 假)
        .否则
            赋值 (.可视, 真)
            赋值 (.选中, 真)
            赋值 (.今天, 读 (12))
        .如果结束
        赋值 (.内容, 读 (13))
    .否则
        
    .如果结束
    
.如果结束
 ' 关闭 ()

.子程序 _基本信息设置窗口_将被销毁, 空白型, , 
关闭 ()

.子程序 _基本信息设置窗口_创建完毕, 空白型, , 
赋值 (.最小日期, 取日期 (取现行时间 ()))
打开 (相加 (取当前目录 (), “\list.edb”), , , , , , )
.如果 (等于 (方法, 1))
    赋值 (.内容, _启动窗口.取项目文本 (., _启动窗口..现行选中项))
    _编辑框1_内容被改变 ()
.否则
    
.如果结束


.子程序 _选择框1_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.可视, 真)
    赋值 (.今天, 取日期 (取现行时间 ()))
.否则
    赋值 (.可视, 假)
.如果结束


.子程序 _按钮3_被单击, 空白型, , 
赋值 (方法, 2)
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
赋值 (.可视, 假)
赋值 (.选中, 假)

.子程序 _按钮2_被单击, 空白型, , 
基本信息设置窗口.销毁 ()


 ' 不属于任何一个程序集、类模块的函数：
