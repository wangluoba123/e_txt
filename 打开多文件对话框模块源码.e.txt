 ' 文件类型：Windows窗口程序

 ' 程序名称：打开多文件对话框
 ' 程序描述：打开多文件对话框（父窗口句柄，标题，过滤器，初始路径）
 ' 程序作者：云外归鸟
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 3 系统核心支持库




数据类型 文件对话框, , 
    .成员 lStructSize, 整数型, , , 
    .成员 hwndOwner, 整数型, , , 
    .成员 hInstance, 整数型, , , 
    .成员 lpstrFilter, 字节集, , , 
    .成员 lpstrCustomFilter, 文本型, , , 
    .成员 nMaxCustFilter, 整数型, , , 
    .成员 nFilterIndex, 整数型, , , 
    .成员 lpstrFile, 字节集, , , 
    .成员 nMaxFile, 整数型, , , 
    .成员 lpstrFileTitle, 文本型, , , 
    .成员 nMaxFileTitle, 整数型, , , 
    .成员 lpstrInitialDir, 文本型, , , 
    .成员 lpstrTitle, 文本型, , , 
    .成员 flags, 整数型, , , 
    .成员 nFileOffset, 短整数型, , , 
    .成员 nFileEtesion, 短整数型, , , 
    .成员 lpstrDefExt, 文本型, , , 
    .成员 lCustData, 整数型, , , 
    .成员 lpfnHook, 整数型, , , 
    .成员 lpTemplateName, 文本型, , , 


.DLL命令 打开对话框, 整数型, "comdlg32.dll", "GetOpenFileNameA", , 
    .参数 OpenFile, 文件对话框, , 

.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码
_临时子程序 () ' 在模块初始化代码执行完毕后调用模块测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
.局部变量 a, 文本型, , , 
.局部变量 b, 文本型, , , 

 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的参数及返回值类型。
赋值 (a, 打开多文件对话框 (“请选择要打开的文件”, “MP3文件|*.mp3|MID文件|*.mid|图片文件（bmp,jpg,gif）|*.bmp;*.jpg;*.gif”, ))
赋值 (b, a)

.程序集 _接口程序集, , , 在本程序集中定义的子程序可被模块外部程序访问，注意如果不存在本程序集就不能作为易模块编译。

.子程序 打开多文件对话框, 文本型, , 多选文件,返回文件路径以";"分隔。打开失败或取消返回空文本
.参数 父窗口句柄, 整数型, 可空, 被调用处
.参数 标题, 文本型, 可空, 对话框窗口标题
.参数 过滤器, 文本型, 可空, 形式：“MP3文件|*.mp3|mpg文件|*.mpg”
.参数 初始路径, 文本型, 可空, 空出为默认路径，一般是在“我的文档”开始

.局部变量 文件列表, 文件对话框, , , 
.局部变量 temp, 字节集, , , 
.局部变量 文件名数组, 文本型, , "0", 
.局部变量 N, 空白型, , , 
.局部变量 所选文件, 文本型, , , 

赋值 (文件列表.lStructSize, 76)
赋值 (文件列表.hwndOwner, 父窗口句柄)
赋值 (文件列表.lpstrFilter, 相加 (子字节集替换 (到字节集 (过滤器), { 124 }, { 0 }, , ), { 0 }, { 0 }))
赋值 (文件列表.lpstrFile, 取空白字节集 (8192)) ' 文件名缓冲区，决定能选择文件的多少
赋值 (文件列表.nMaxFile, 8192)
赋值 (文件列表.lpstrFileTitle, 取空白文本 (8192))
赋值 (文件列表.nMaxFileTitle, 8192)
赋值 (文件列表.lpstrInitialDir, 初始路径)
赋值 (文件列表.lpstrTitle, 标题)
赋值 (文件列表.flags, 524800)
.如果 (不等于 (打开对话框 (文件列表), 0)) ' 打开文件成功
    赋值 (temp, 文件列表.lpstrFile)
    赋值 (temp, 取字节集左边 (temp, 相减 (寻找字节集 (temp, { 0, 0 }), 1)))
    .如果 (不等于 (寻找字节集 (temp, { 0 }), -1)) ' 是否选择多个文件
        赋值 (文件名数组, 分割文本 (到文本 (子字节集替换 (temp, { 0 }, { 124 }, , )), “|”, ))
        .如果真 (不等于 (取文本右边 (文件名数组 [1], 1), “\”)) ' 选择多个文件时，第一个数组为路径名，后面为不包括路径的文件名
            赋值 (文件名数组 [1], 相加 (文件名数组 [1], “\”))
        .如果真结束
        .计次循环首 (相减 (取数组成员数 (文件名数组), 1), N)
            .如果 (不等于 (相减 (取数组成员数 (文件名数组), 1), N)) ' 最后一个文件名不用加分隔字符“；”
                赋值 (所选文件, 相加 (所选文件, 文件名数组 [1], 文件名数组 [相加 (N, 1)], “;”))
            .否则
                赋值 (所选文件, 相加 (所选文件, 文件名数组 [1], 文件名数组 [相加 (N, 1)]))
            .如果结束
            
        .计次循环尾 ()
        返回 (所选文件) ' 返回多个文件名全路径用“;”分隔
    .否则
        返回 (到文本 (temp)) ' 返回单个文件名全路径
    .如果结束
    
.否则
    
.如果结束
返回 (“”) ' 取消返回空文本


 ' 不属于任何一个程序集、类模块的函数：
