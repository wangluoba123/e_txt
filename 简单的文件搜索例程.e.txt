 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 589
    高度 = 396
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “读取指定目录中的所有文件名并赋值列表框 作者：RayMone”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 6 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 6 扩展界面支持库一



 ' 所需要的模块
 ' _仿真shell库 F:\资源网\系统工具\_仿真shell库.ec



.窗口程序集 窗口程序集1, , , 

.程序集变量 文件数, 整数型, , , 
.子程序 _按钮_浏览_被单击, 空白型, , 
.局部变量 路径文本, 文本型, , , 
.局部变量 文件属性, 整数型, , , 

赋值 (路径文本, 未知函数_67174455 (“请选择文件夹：”, 取窗口句柄 ()))
.如果真 (不等于 (路径文本, “”))
    赋值 (文件属性, 取文件属性 (路径文本))
    .如果真 (不等于 (位与 (文件属性, #子目录), 0))
        全部删除 ()
        赋值 (文件数, 0)
        搜寻 (路径文本)
        赋值 (.标题, 相加 (“共找到：”, 到文本 (文件数), “个文件”))
    .如果真结束
    
.如果真结束


.子程序 搜寻, 空白型, , 
.参数 目录名, 文本型, , 

.局部变量 文件名, 文本型, , , 

 ' ----------------------------以下这段代码是寻找当前文件夹的所有文件------------------------------------------

.如果真 (不等于 (取文本右边 (目录名, 1), “\”))
    赋值 (目录名, 相加 (目录名, “\”))
.如果真结束
赋值 (文件名, 寻找文件 (相加 (目录名, “*.*”), ))
.判断循环首 (不等于 (文件名, “”))
    .如果 (等于 (.现行选中项, 0))
        .插入表项 (到文本 (文件数), , , , )
        文件数.置标题 (0, 到文本 (相加 (文件数, 1)))
        文件数.置标题 (1, 文件名)
        文件数.置标题 (2, 目录名)
        赋值 (文件数, 相加 (文件数, 1))
    .否则
        .如果真 (等于 (取后缀名 (文件名), 取文本右边 (.内容, 相减 (取文本长度 (.内容), 2))))
            .插入表项 (到文本 (文件数), , , , )
            文件数.置标题 (0, 到文本 (相加 (文件数, 1)))
            文件数.置标题 (1, 文件名)
            文件数.置标题 (2, 目录名)
            赋值 (文件数, 相加 (文件数, 1))
            
        .如果真结束
        
    .如果结束
    赋值 (文件名, 寻找文件 ())
.判断循环尾 ()
 ' ----------------------------以下这段代码是寻找下一个文件夹------------------------------------------
赋值 (文件名, 寻找文件 (相加 (目录名, “*.*”), #子目录)) ' 寻找文件夹
.判断循环首 (不等于 (文件名, “”))
    .如果真 (不等于 (取文本左边 (文件名, 1), “.”)) ' “.”判断是文件夹就寻找这个文件夹的所有文件和文件夹。
        搜寻 (相加 (目录名, 文件名))
    .如果真结束
    赋值 (文件名, 寻找文件 (#子目录))
.判断循环尾 ()


.子程序 取后缀名, 文本型, , 返回小写格式的后缀名
.参数 欲取后缀的文件名, 文本型, , 写入文件完整地址，取得文件后缀名

返回 (到小写 (取文本右边 (欲取后缀的文件名, 相减 (取文本长度 (欲取后缀的文件名), 倒找文本 (欲取后缀的文件名, “.”, , 假)))))

.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (.现行选中项, 0)


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 自定义浏览文件夹, 文本型, ,  作者：Raymone   打开一个对话框，浏览系统中存在的所有文件夹，返回带"\"的被选定文件夹的路径名，如果未选中任何文件夹，则返回空文本。
.参数 提示标题, 文本型, 可空, 类型为“文本型（text）”。本参数提供显示在对话框上部的标题文本。
.参数 窗口句柄, 整数型, , 



.子程序 自定义查询快捷方式, 文本型, , 作者：Raymone   本命令从指定快捷方式文件中获取该快捷方式所指向的文件路径名，如果该文件不是快捷方式文件或执行失败则返回空文本。
.参数 快捷方式文件名, 文本型, , 类型为“文本型（text）”。



.子程序 自定义取特定目录, 文本型, , 作者：Raymone   本命令返回指定的Windows系统特定目录，所返回目录名以“\”符号结束，如失败返回空文本。
.参数 欲获取目录类型, 整数型, , 0:#网络邻居; 1: #我的文档;  2: #我的收藏夹;  3: #系统桌面;  4: #系统字体;  5: #开始菜单组;  6: #程序菜单组;  7: #启动菜单组;  8: #程序数据目录;  9: #Windows安装目录;  10: #Windows系统目录;  11: #临时文件目录;   12:#发送;  13:#ShellNew;  14:#PrintHood;  15:#Cookies目录;  16:#历史;  17:#网页临时文件;  18:#最近打开的文件。



.子程序 自定义执行, 逻辑型, , 作者：Raymone   功能类似于执行，比执行命令多一个等待运行结束功能。返回值为提示是否进行相应的操作。
.参数 欲执行文件名, 文本型, , 欲运行的命令行
.参数 运行方式, 逻辑型, 可空, 是否等待程序运行完毕，默认为真，则需等待运行结束。为假则不等待运行结束
.参数 显示方式, 整数型, 可空, 被运行程序窗口显示方式，可以被省略。参数值可以为以下常量之一：1、#隐藏窗口； 2、#普通激活； 3、#最小化激活； 4、#最大化激活； 5、#普通不激活； 6、#最小化不激活。如果省略本参数，默认为“普通激活”方式。



.子程序 自定义清空回收站, 空白型, , 作者：Raymone   自定义清空回收站
.参数 句柄, 整数型, , 



.子程序 自定义进度移动文件, 逻辑型, , 本命令可以将一个或一批文件移动到另一个目录中，并同时显示一个移动进度对话框，成功返回真，失败或被用户中止移动操作返回假。本命令为初级命令。命令参数表中最后一个参数可以被重复添加。
.参数 句柄, 整数型, , 
.参数 目的目录, 文本型, , 本参数提供目的目录路径，如果该目录不存在，系统将自动询问是否创建。
.参数 源文件, 文本型, , 提供参数数据时可以同时提供数组或非数组数据。可以以数组方式同时提供多个文件或文件夹名，注意必须是全路径，支持通配符“*”和“?”。
.参数 覆盖提示, 逻辑型, 可空, 是否出现覆盖提示窗口



.子程序 自定义删除到回收站, 逻辑型, , 本命令可以将一个或一批文件删除到Windows系统回收站中，成功返回真，失败或被用户中止删除操作返回假。本命令为初级命令。命令参数表中最后一个参数可以被重复添加。
.参数 句柄, 整数型, , 
.参数 欲删除文件, 文本型, , 提供参数数据时可以同时提供数组或非数组数据。可以以数组方式同时提供多个文件或文件夹名，注意必须是全路径，支持通配符“*”和“?”。
.参数 删除提示, 逻辑型, 可空, 是否出现删除提示窗口



.子程序 自定义进度复制文件, 逻辑型, , 本命令可以将一个或一批文件复制到另一个目录中，并同时显示一个复制进度对话框，成功返回真，失败或被用户中止复制操作返回假。本命令为初级命令。命令参数表中最后一个参数可以被重复添加。
.参数 句柄, 整数型, , 
.参数 目的目录, 文本型, , 本参数提供目的目录路径，如果该目录不存在，系统将自动询问是否创建。
.参数 源文件, 文本型, , 提供参数数据时可以同时提供数组或非数组数据。可以以数组方式同时提供多个文件或文件夹名，注意必须是全路径，支持通配符“*”和“?”。
.参数 覆盖提示, 逻辑型, 可空, 是否出现覆盖提示窗口




 ' 不属于任何一个程序集、类模块的函数：
