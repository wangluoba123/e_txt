 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 595
    高度 = 393
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假



.常量 标题, "“子涵工作室！”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' SqliteDB {295DD8F2-3584-4780-818D-9569AC5BC9D8} 1 5 Sqlite数据库支持库





.窗口程序集 窗口程序集1, , , 

.程序集变量 Sqlite数据库, 未知类型0x30001, , , 
.程序集变量 Sqlite表, 未知类型0x30002, , , 
.程序集变量 Sqlite记录集, 未知类型0x30003, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.如果真 (取反 (文件是否存在 (相加 (取运行目录 (), “\中文数据库.sdb”))))
    信息框 (“数据库文件不存在！”, 0, #标题)
    赋值 (.禁止, 真)
    返回 ()
.如果真结束
.如果真 (Sqlite数据库.未知支持库函数_30 (相加 (取运行目录 (), “\中文数据库.sdb”), 假))
    .如果真 (Sqlite表.未知支持库函数_105 (“河源市天气预报”, Sqlite数据库))
        返回 ()
    .如果真结束
    
.如果真结束
信息框 (“数据库初始化失败！”, 0, #标题)
赋值 (.禁止, 真)

.子程序 _查询钮_被单击, 空白型, , 
Sqlite记录集.未知支持库函数_184 (“select * from 河源市天气预报”, Sqlite数据库)
Sqlite记录集.未知支持库函数_190 ()
填充超级列表框 ()

.子程序 填充超级列表框, 空白型, , 
.局部变量 外计次, 整数型, , , 
.局部变量 内计次, 整数型, , , 
.局部变量 表项索引, 整数型, , , 
.局部变量 字段数组, 文本型, , "0", 
.局部变量 记录数组, 文本型, , "0", 

赋值 (., {  }) ' 一般是事先建立好列，以后不用删除表头
全部删除 () ' 这句可以删除除表头外的所有表项

赋值 (字段数组, Sqlite记录集.未知支持库函数_211 ())
赋值 (记录数组, Sqlite记录集.未知支持库函数_209 (假))

 ' 读出表中字段填充超级列表框的列。起始一般不填充列，将报表列事先建立好。除非是要根据不同表中字段来显示，就可以这样
.计次循环首 (Sqlite记录集.未知支持库函数_210 (), 外计次)
    .插入列 (字段数组 [外计次], 80, , , )
.计次循环尾 ()

 ' 读出数据填充到列表框中
.计次循环首 (Sqlite记录集.未知支持库函数_208 (), 外计次) ' 该循环控制列表框的行
    赋值 (表项索引, .插入表项 (记录数组 [外计次] [1], , , , ))
    .计次循环首 (相减 (Sqlite记录集.未知支持库函数_210 (), 1), 内计次) ' 该循环控制列表框的列。循环－1是因为前面已经插入了一列了
        表项索引.置标题 (内计次, 记录数组 [外计次] [相加 (内计次, 1)])
    .计次循环尾 ()
.计次循环尾 ()

赋值 (.标题, 相加 (“ 表中字段数量：”, 到文本 (Sqlite记录集.未知支持库函数_210 ()), “/个  记录总数：”, 到文本 (Sqlite记录集.未知支持库函数_208 ()), “/条”))


 ' 不属于任何一个程序集、类模块的函数：
