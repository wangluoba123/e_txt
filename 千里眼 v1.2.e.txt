 ' 文件类型：Windows窗口程序

 ' 程序名称：千里眼 v1.2
 ' 程序描述：这是一个远程监控软件，可以监视、控制局域网计算机的屏幕，还能发送文字信息。
 ' 程序作者：方舟
 ' 邮政编码：
 ' 联系地址：广西来宾市
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：langzhi888@sina.com
 ' 主页地址：http://main.fontz.ajiang.net
 ' 版权声明：QQ:52755652
 ' 版本号：1.2
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 470
    高度 = 375
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\千里眼 v1.2.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “千里眼 v1.2　　易语言基地：http://eyuyan.com　　　　　方舟出品　http://fontz.ajiang.net”
    帮助文件名 = “”

窗口 监视窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 488
    高度 = 368
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 0 '  0x0
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “监视窗口”
    帮助文件名 = “”

窗口 监视墙窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 456
    高度 = 352
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “监视墙”
    帮助文件名 = “”



.声音 有信息, " ' 已保存到：D:\易语言学习\Data\千里眼 v1.2.e\有信息", , 
.声音 上线, " ' 已保存到：D:\易语言学习\Data\千里眼 v1.2.e\上线", , 
.图片 鼠标图片, " ' 已保存到：D:\易语言学习\Data\千里眼 v1.2.e\鼠标图片", , 
.图片 未定, " ' 已保存到：D:\易语言学习\Data\千里眼 v1.2.e\未定", , 
.图片 已定, " ' 已保存到：D:\易语言学习\Data\千里眼 v1.2.e\已定", , 
.常量 为绝对位置, "32768", , dx和dy指定鼠标坐标系统中的一个绝对位置。在鼠标坐标系统中，屏幕在水平和垂直方向上均匀分割成65535×65535个单元
.常量 移动鼠标, "1", , MOUSEEVENTF_MOVE
.常量 左键按下, "2", , MOUSEEVENTF_LEFTDOWN
.常量 左键抬起, "4", , MOUSEEVENTF_LEFTUP
.常量 右键按下, "8", , MOUSEEVENTF_RIGHTDOWN
.常量 右键抬起, "16", , MOUSEEVENTF_RIGHTUP
.常量 中键按下, "32", , MOUSEEVENTF_MIDDLEDOWN
.常量 中键抬起, "64", , MOUSEEVENTF_MIDDLEUP
.常量 , , , 
.常量 为扩展键, "1", , KEYEVENTF_EXTENDEDKEY
.常量 键抬起, "2", , KEYEVENTF_KEYUP
.常量 扫描码, "8", , KEYEVENTF_SCANCODE


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 3 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 1 扩展界面支持库一
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 1 0 数据操作支持库一
 ' Tooltiplib DA19AC3ADD2F4121AAD84AC5FBCAFC71 1 1 提示工具支持库




数据类型 系统时间类型, , 
    .成员 年, 短整数型, , , 
    .成员 月, 短整数型, , , 
    .成员 星期, 短整数型, , , 
    .成员 日, 短整数型, , , 
    .成员 时, 短整数型, , , 
    .成员 分, 短整数型, , , 
    .成员 秒, 短整数型, , , 
    .成员 毫秒, 短整数型, , , 

.全局变量 待接收数据长度, 长整数型, , , 
.全局变量 鼠标水平位置, 双精度小数型, , , 
.全局变量 鼠标垂直位置, 双精度小数型, , , 
.全局变量 鼠标图片号, 整数型, , , 
.全局变量 计算机名, 文本型, , , 

.DLL命令 取计算机名, 整数型, "kernel32.dll", "GetComputerNameA", , 取得这台计算机的名称。（非零）表示成功，否则返回零。
    .参数 缓冲区, 文本型, , 随同计算机名载入的字串缓冲区
    .参数 缓冲区长度, 整数型, 传址, 缓冲区的长度。这个变量随同返回计算机名的实际长度载入。注意nSize参数并不是按值传递的。参考api32.txt，了解MAX_COMPUTER_NAME常数的值


.DLL命令 模拟键盘事件, 空白型, "user32.dll", "keybd_event", , 
    .参数 虚拟键码, 整数型, , bVk
    .参数 OEM扫描码, 整数型, , bScan
    .参数 按键标志, 整数型, , dwFlags，Long，零；或设为下述两个标志之一：KEYEVENTF_EXTENDEDKEY 指出是一个扩展键，而且在前面冠以0xE0代码 ；KEYEVENTF_KEYUP 模拟松开一个键 
    .参数 未使用, 整数型, , dwExtraInfo

.DLL命令 模拟鼠标事件, 空白型, "user32.dll", "mouse_event", , 
    .参数 鼠标状态, 整数型, , dwFlags
    .参数 坐标x, 整数型, , dx
    .参数 坐标y, 整数型, , dy
    .参数 未使用, 整数型, , cButtons
    .参数 未用, 整数型, , dwExtraInfo

.DLL命令 释放鼠标捕获, 整数型, "user32.dll", "ReleaseCapture", , 

.DLL命令 取系统时间, 空白型, "kernel32.dll", "GetLocalTime", , 
    .参数 系统时间, 未知类型0x41010176, 传址, 

.窗口程序集 窗口程序集1, , , 

.程序集变量 快照缓存, 字节集, , , 
.程序集变量 快照图片号, 整数型, , , 
.程序集变量 接收的数据, 字节集, , , 
.程序集变量 解压缩后数据, 字节集, , , 
.程序集变量 延迟时间, 整数型, , , 
.子程序 _监视窗口_创建完毕, 空白型, , 
0.移动 (0, 取用户区宽度 (), 取用户区高度 ()) ' 初始状态为：缩放选择框选中，全屏选择框选中

.子程序 _监视窗口_可否被关闭, 逻辑型, , 
发送数据 ()

.子程序 _监视窗口_尺寸被改变, 空白型, , 
.如果真 (.选中)
    0.移动 (0, 取用户区宽度 (), 取用户区高度 ())
.如果真结束
.画图片 (0, 0, .宽度, .高度, )

.子程序 _快照画板_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (.选中)
    发送数据 ()

.子程序 _快照画板_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (.选中)
    发送数据 ()

.子程序 _快照画板_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (.选中)
    .如果真 (等于 (可有焦点 (), 假))
        获取焦点 ()
    .如果真结束
    发送数据 ()

.子程序 _快照画板_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (.选中)
    发送数据 ()

.子程序 _快照画板_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (.选中)
    发送数据 ()

.子程序 _快照画板_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (.选中)
    发送数据 ()

.子程序 _快照画板_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (.选中)
    发送数据 ()

.子程序 _快照画板_放开某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (.选中)
    发送数据 ()

.子程序 _客户服务器_数据到达, 空白型, , 
赋值 (取回数据 ())
.如果 (等于 (取字节集长度 (快照缓存), 0))
    赋值 (延迟时间, 0)
    赋值 (取字节集数据 (取字节集左边 (接收的数据, 4), #整数型))
    赋值 (取字节集数据 (取字节集中间 (接收的数据, 5, 8), #双精度小数型))
    赋值 (取字节集数据 (取字节集中间 (接收的数据, 13, 8), #双精度小数型))
    赋值 (快照缓存, 相加 (快照缓存, 取字节集右边 (接收的数据, 相减 (取字节集长度 (接收的数据), 20))))
    
.否则
    赋值 (相加 ())
.如果结束

.如果真 (等于 (取字节集长度 (快照缓存), ))
    赋值 (解压缩后数据, 未知支持库函数_1 (快照缓存))
    卸载图片 ()
    赋值 (快照图片号, 载入图片 (解压缩后数据))
    .画图片 (0, 0, .宽度, .高度, )
    .画图片 (相乘 (..宽度, ), 相乘 (..高度, ), , , )
    赋值 (快照缓存, 到字节集 (“”))
    .如果真 (等于 (.选中, 假))
        处理事件 ()
        .如果真 (是否已创建 ()) ' 防止窗口关闭后出错
            “继续”.发送数据 ()
        .如果真结束
        
    .如果真结束
    
.如果真结束


.子程序 _延迟时钟_周期事件, 空白型, , 
赋值 (延迟时间, 相加 (延迟时间, 1))
.如果真 (大于或等于 (延迟时间, 5))
    赋值 (快照缓存, 到字节集 (“”))
    “超时，重新传送”.发送数据 ()
.如果真结束


.子程序 _全屏窗口选择框_被单击, 空白型, , 
.如果 (.选中)
    赋值 (.边框, 0)
    0.移动 (0, 取屏幕宽度 (), 取屏幕高度 ())
.否则
    赋值 (.边框, 1)
.如果结束


.子程序 _图片缩放选择框_被单击, 空白型, , 
.如果真 (等于 (.选中, 假))
    .移动 (快照图片号.取图片宽度 (), 快照图片号.取图片高度 ())
.如果真结束
未知函数_67174531 ()

.子程序 _保存图片按钮_被单击, 空白型, , 
.局部变量 暂停框状态, 逻辑型, , , 

赋值 (暂停框状态, .选中)
赋值 (.选中, 真)
_暂停选择框_被单击 ()
.如果真 (打开 ())
    写到文件 (.文件名, 解压缩后数据)
.如果真结束
赋值 (.选中, 暂停框状态)
_暂停选择框_被单击 ()

.子程序 _暂停选择框_被单击, 空白型, , 
.如果 (.选中)
    赋值 (.时钟周期, 0)
.否则
    赋值 (延迟时间, 5)
    赋值 (.时钟周期, 1000)
.如果结束


.子程序 _客户服务器_连接断开, 空白型, , 
信息框 (相加 (“［”, .标题, “］已经退出！”), 64, “监视结束”)
未知函数_67174535 ()
销毁 ()

.窗口程序集 窗口程序集2, , , 

.程序集变量 快照缓存, 字节集, , , 
.程序集变量 压缩后缓存, 字节集, , , 
.程序集变量 客户信息, 文本型, , , 
.程序集变量 缩图客户信息, 文本型, , , 
.程序集变量 正在压缩, 逻辑型, , , 
.程序集变量 已收到信号, 逻辑型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 返回长度, 整数型, , , 

赋值 (32)
赋值 (取空白文本 ())
未知函数_167837914 ()

赋值 ()

.子程序 __启动窗口_尺寸被改变, 空白型, , 
.如果 (等于 (.位置, 2))
    赋值 (.可视, 假)
    置托盘图标 (.图标, “千里眼 正在运行”)
.否则
    赋值 (.可视, 真)
    置托盘图标 ()
.如果结束


.子程序 __启动窗口_托盘事件, 空白型, , 
.参数 操作类型, 整数型, , 

赋值 (.可视, 真)
赋值 (.位置, 0)

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
.如果 (.选中)
    写注册项 (#本地机器, “SOFTWARE\千里眼密码”, .内容)
.否则
    删除注册项 (#本地机器, “SOFTWARE\千里眼密码”)
.如果结束

.如果真 (或者 (.选中, .选中))
    赋值 (.位置, 2)
    返回 (假)
.如果真结束

.如果真 (等于 (.选中, 假))
    .如果真 (不等于 (信息框 (“现在退出将切断与其他好友的联系，是否真的退出？”, 36, “退出程序”), #是钮))
        返回 (假)
    .如果真结束
    
.如果真结束

.发送数据 (2520, 相加 (“离开”, , “@”))
.断开客户 ()
卸载图片 ()

.子程序 添加聊天记录, 空白型, , 
.参数 颜色1, 整数型, , 
.参数 颜色2, 整数型, , 
.参数 发言人, 文本型, , 
.参数 说话内容, 文本型, , 

.局部变量 聊天字符格式, 未知类型0x30004, , , 

赋值 (., 0)
赋值 (., 颜色1)
.未知支持库函数_10 ()
赋值 (., 相加 (“　　”, 说话内容, 字符 (13), 字符 (10)))

赋值 (., 0)
赋值 (., 颜色2)
.未知支持库函数_10 ()
赋值 (., 相加 (取现行短时间 (), “　”, 发言人, 字符 (13), 字符 (10)))

.子程序 _窗口固定选择框_被单击, 空白型, , 
.如果 (.选中)
    赋值 (.图片)

.子程序 取现行短时间, 文本型, , 
.局部变量 当前系统时间, 未知类型0x410100F0, , , 

未知函数_167837937 ()
返回 (相加 (到文本 (当前系统时间.), “:”, 到文本 (当前系统时间.), “:”, 到文本 (当前系统时间.)))

.子程序 _快照服务器_客户进入, 空白型, , 
赋值 (取回客户 ())

.子程序 _快照服务器_客户离开, 空白型, , 
赋值 (“”)

.子程序 _快照服务器_数据到达, 空白型, , 
取回数据 ()
.如果 (正在压缩)
    赋值 (已收到信号, 真)
    返回 ()
.否则
    赋值 (已收到信号, 假)
.如果结束

.循环判断首 ()
    处理事件 ()
    客户信息.发送数据 (相加 (到字节集 (取字节集长度 (压缩后缓存)), 到字节集 (相除 (取鼠标水平位置 (), 取屏幕宽度 ())), 到字节集 (相除 (取鼠标垂直位置 (), 取屏幕高度 ())), 压缩后缓存), 0)
    赋值 (已收到信号, 假)
    赋值 (正在压缩, 真)
    处理事件 ()
    赋值 (快照缓存, 快照 ())
    赋值 (未知支持库函数_0 ())
    赋值 (正在压缩, 假)
.循环判断尾 (已收到信号)

.子程序 初始化快照, 空白型, , 
赋值 (快照缓存, 快照 ())
赋值 (未知支持库函数_0 ())

.子程序 _聊天服务器_数据到达, 空白型, , 
.局部变量 接收到的数据, 文本型, , , 
.局部变量 对方主机名, 文本型, , , 
.局部变量 分隔符位置, 整数型, , , 
.局部变量 命令字, 文本型, , , 
.局部变量 分隔符2位置, 整数型, , , 
.局部变量 监视密码, 文本型, , , 
.局部变量 鼠标横向位置, 双精度小数型, , , 
.局部变量 鼠标纵向位置, 双精度小数型, , , 

赋值 (接收到的数据, 到文本 (取回数据 ()))
赋值 (命令字, 取文本左边 (接收到的数据, 4))
赋值 (分隔符位置, 寻找文本 (接收到的数据, “@”, , 假))
赋值 (对方主机名, 取文本中间 (接收到的数据, 5, 相减 (分隔符位置, 5)))

.判断开始 (等于 (命令字, “聊天”))
    未知函数_67174658 (#蓝色, #墨绿, 对方主机名, 取文本中间 (接收到的数据, 相加 (分隔符位置, 1), 16000))
    播放音乐 ()

.子程序 _监视选择框_被单击, 空白型, , 
.局部变量 对方主机名, 文本型, , , 

.如果 (.选中)
    赋值 (.选中, 假)
    .取标题 (., ).发送数据 (2520, 相加 (“连接”, , “@”))
.否则
    销毁 ()
.如果结束


.子程序 _发送按钮_被单击, 空白型, , 
.局部变量 目标好友, 文本型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“不能发送空白消息！”, 64, “提示”)
    返回 ()
.如果真结束

赋值 (目标好友, .取标题 (., ))
目标好友.发送数据 (2520, 相加 (“聊天”, , “@”, .内容))
未知函数_67174658 (#蓝色, #红色, 相加 (“ => ”, 目标好友), .内容)
赋值 (.内容, “”)

.子程序 _广播按钮_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (“不能发送空白消息！”, 64, “提示”)
    返回 ()
.如果真结束

.发送数据 (2520, 相加 (“聊天”, , “@”, .内容))
未知函数_67174658 (#蓝色, #红色, 相加 (“ => 所有人”), .内容)
赋值 (.内容, “”)

.子程序 _好友列表标签_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (.渐变背景方式, 0))
    赋值 (.渐变背景方式, 1)
.如果真结束


.子程序 __启动窗口_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (不等于 (.渐变背景方式, 0))
    赋值 (.渐变背景方式, 0)
.如果真结束
.如果真 (不等于 (.渐变背景方式, 0))
    赋值 (.渐变背景方式, 0)
.如果真结束
.如果真 (不等于 (.渐变背景方式, 0))
    赋值 (.渐变背景方式, 0)
.如果真结束


.子程序 _好友列表框_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_好友列表标签_鼠标位置被移动 (1, 1, 1)

.子程序 _写消息标签_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (.渐变背景方式, 0))
    赋值 (.渐变背景方式, 1)
.如果真结束


.子程序 _聊天记录标签_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (.渐变背景方式, 0))
    赋值 (.渐变背景方式, 1)
.如果真结束


.子程序 _写消息编辑框_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_写消息标签_鼠标位置被移动 (1, 1, 1)

.子程序 _聊天记录框_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_聊天记录标签_鼠标位置被移动 (1, 1, 1)

.子程序 _扩展选择框_被单击, 空白型, , 
.如果 (.选中)
    赋值 (.左边, 相减 (.左边, 145))
    赋值 (_启动窗口.宽度, 760)
.否则
    赋值 (.宽度, 470)
    赋值 (.左边, 相加 (.左边, 145))
.如果结束


.子程序 _写消息编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (并且 (等于 (键代码, 13), 等于 (功能键状态, 1))) ' 发送消息快捷键：Ctrl　+　Enter。如选定了好友则发给这个好友，否则广播出去。
    .如果 (等于 (.禁止, 假))
        _发送按钮_被单击 ()
    .否则
        .如果真 (等于 (.禁止, 假))
            _广播按钮_被单击 ()
        .如果真结束
        
    .如果结束
    返回 (假)
.如果真结束


.子程序 _密码选择框_被单击, 空白型, , 
.局部变量 密码, 文本型, , , 

.如果 (.选中)
    赋值 (.输入方式, 2)
    赋值 (.背景颜色, #白色)
    获取焦点 ()
.否则
    赋值 (.输入方式, 1)
    赋值 (.背景颜色, #默认色)
    赋值 (.内容, “”)
.如果结束


.子程序 _好友列表框_失去焦点, 空白型, , 
.如果真 (等于 (., -1))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.如果真结束


.子程序 _好友列表框_表项被激活, 空白型, , 
赋值 (.禁止, 假)
赋值 (.禁止, 假)

.子程序 _密码编辑框_失去焦点, 空白型, , 
.如果真 (等于 (.内容, “”))
    赋值 (.选中, 假)
    _密码选择框_被单击 ()
.如果真结束


.子程序 _自动运行选择框_被单击, 空白型, , 
.如果 (.选中)
    写注册项 (#本地机器, “SOFTWARE\Microsoft\Windows\CurrentVersion\Run\千里眼”, 相加 (取运行目录 (), “\”, 取执行文件名 ()))
.否则
    删除注册项 (#本地机器, “SOFTWARE\Microsoft\Windows\CurrentVersion\Run\千里眼”)
.如果结束


.子程序 _电视墙选择框_被单击, 空白型, , 
.如果 (.选中)
    载入 (假)
    赋值 (.位置, 2)
.否则
    销毁 ()
.如果结束


.子程序 _缩图服务器_客户进入, 空白型, , 
赋值 (取回客户 ())

.子程序 _缩图服务器_数据到达, 空白型, , 
.局部变量 缩图宽, 整数型, , , 
.局部变量 缩图高, 整数型, , , 
.局部变量 缓存, 字节集, , , 
.局部变量 缩略图快照数据, 字节集, , , 
.局部变量 缩略图压缩数据, 字节集, , , 

赋值 (缓存, 取回数据 ())
赋值 (缩图宽, 取字节集数据 (取字节集左边 (缓存, 4), #整数型))
赋值 (缩图高, 取字节集数据 (取字节集右边 (缓存, 4), #整数型))
赋值 (缩略图快照数据, 快照 (缩图宽, 缩图高))
赋值 (未知支持库函数_0 ())
.发送数据 (缩略图压缩数据, 1)
.断开客户 ()

相加 (取现行短时间 (), “　　［”, 转换为计算机名 (缩图客户信息), “］缩略监视”).加入项目 (0)

.子程序 转换为计算机名, 文本型, , 我用系统命令“转换为主机名”时总是出错，只好自己做了一个
.参数 好友IP, 文本型, , 

.局部变量 好友索引, 整数型, , , 
.局部变量 好友主机名, 文本型, , , 

赋值 (好友IP, 取文本左边 (好友IP, 相减 (寻找文本 (好友IP, “:”, , 假), 1)))
.计次循环首 (取表项数 (), 好友索引)
    赋值 (相减 (好友索引, 1).取标题 ())
    .如果真 (等于 (转换为IP地址 (好友主机名), 好友IP))
        返回 ()
    .如果真结束
    
.计次循环尾 ()
返回 (好友IP)

.窗口程序集 窗口程序集3, , , 

.程序集变量 砖宽, 整数型, , , 
.程序集变量 砖高, 整数型, , , 
.程序集变量 砖板数组, 画板, , "9", 
.程序集变量 第一好友号, 整数型, , , 
.程序集变量 当前好友号, 整数型, , , 
.程序集变量 接收到的数据, 字节集, , , 
.程序集变量 解压后的数据, 字节集, , , 
.程序集变量 对方主机名, 文本型, , , 
.子程序 _退出按钮_被单击, 空白型, , 
赋值 (..选中, 假)
赋值 (.位置, 0)
销毁 ()

.子程序 _下一页按钮_被单击, 空白型, , 
.局部变量 砖板数, 整数型, , , 

赋值 (第一好友号, 相加 (第一好友号, 9))
赋值 (.禁止, 假)
赋值 (.禁止)

.子程序 _上一页按钮_被单击, 空白型, , 
.局部变量 砖板数, 整数型, , , 

赋值 (第一好友号, 相减 (第一好友号, 9))
赋值 (.禁止, 小于或等于 (第一好友号, 0))
赋值 (.禁止)

.子程序 _监视墙窗口_创建完毕, 空白型, , 
.局部变量 砖板数, 整数型, , , 

赋值 (.顶边, 相减 (取屏幕高度 (), .高度))
赋值 (.顶边, .顶边)
赋值 (.顶边, .顶边)
赋值 (.左边, 相除 (相减 (取屏幕宽度 (), .宽度), 2))
赋值 (.左边, 相减 (.左边, .宽度))
赋值 (.左边, 相加 (.左边, .宽度))

赋值 (砖宽, 整除 (相减 (取屏幕宽度 (), 6), 3))
赋值 (砖高, 整除 (相减 (取屏幕高度 (), 30), 3))
.计次循环首 (9, 砖板数)
    复制窗口组件 (砖板数组 [砖板数])
    赋值 (砖板数组 [砖板数], 宽度, 砖宽)
    赋值 (砖板数组 [砖板数], 高度, 砖高)
    赋值 (砖板数组 [砖板数], 左边, 相加 (相乘 (求余数 (相减 (砖板数, 1), 3), 相加 (砖宽, 2)), 1))
    赋值 (砖板数组 [砖板数], 顶边, 相加 (相乘 (整除 (相减 (砖板数, 1), 3), 相加 (砖高, 2)), 1))
    赋值 (砖板数组 [砖板数], 可视, 真)
.计次循环尾 ()

赋值 (第一好友号, 0)
赋值 (当前好友号, 相减 (1, 2))
赋值 (.禁止)

.子程序 _监视墙客户_连接断开, 空白型, , 
.局部变量 临时图片号, 整数型, , , 
.局部变量 连接成功, 逻辑型, , , 

.如果真 (大于 (当前好友号, 0)) ' 是否为窗口加载时调用
    .如果真 (等于 (是否已创建 (), 假)) ' 防止窗口卸载时出错
        返回 ()
    .如果真结束
    
    赋值 (解压后的数据, 未知支持库函数_1 (接收到的数据))
    赋值 (临时图片号, 载入图片 (解压后的数据))
    砖板数组.画图片 ( [当前好友号], 临时图片号, 0, 0, , , )
    砖板数组.定位写出 ( [当前好友号], 1, 1, 对方主机名)
    卸载图片 (临时图片号)
    处理事件 ()
.如果真结束

.循环判断首 ()
    赋值 (接收到的数据, 到字节集 (“”))
    赋值 (当前好友号, 相加 (当前好友号, 1))
    .如果真 ()

.子程序 _监视墙客户_数据到达, 空白型, , 
.局部变量 本次收到数据, 字节集, , , 

赋值 (本次收到数据, 取回数据 ())
赋值 (接收到的数据, 相加 (接收到的数据, 本次收到数据))

.子程序 _砖板_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (..选中) ' 正在监视另外的计算机，则结束监视
    销毁 ()
    赋值 (.位置, 2)
    处理事件 ()
    延时 (1000)
.如果真结束

赋值 (对方主机名)


 ' 不属于任何一个程序集、类模块的函数：
