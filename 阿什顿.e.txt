 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 390
    高度 = 477
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\阿什顿.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “潇潇专用MP3播放器”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' eMMedia 824F144B108A4bcbB966F45670D42A00 2 4 多媒体支持库
 ' iext6 {E60056EA-07A8-4bf5-B6F0-DF05DE6FAE1F} 1 1 扩展界面支持库六




数据类型 超级列表框背景图片, , 
    .成员 应用, 整数型, , , 0为清除
    .成员 hBmp, 整数型, , , 
    .成员 图片, 文本型, , , 图片路径
    .成员 cchImageMax, 整数型, , , 另外一个代码的这里是路径长度+1
    .成员 横向百分比, 整数型, , , 
    .成员 纵向百分比, 整数型, , , 


.DLL命令 发送消息, 整数型, "", "SendMessageA", , 
    .参数 窗口句柄, 整数型, , 
    .参数 信息值, 整数型, , 
    .参数 参数一, 整数型, , 
    .参数 参数二, 未知类型0x410100B4, , 

.窗口程序集 窗口程序集1, , , 

.子程序 _添加按钮_被单击, 空白型, , 
赋值 (.过滤器, “媒体文件（*.mp3）|*.mp3”)
.如果真 (等于 (打开 (), 真))
    .插入表项 (取文本右边 (.文件名, 相减 (取文本长度 (.文件名), 倒找文本 (.文件名, “\”, , 假))), , , , )
    相减 (取表项数 (), 1).置标题 (1, .文件名)
    获取焦点 ()
.如果真结束


.子程序 _播放按钮_被单击, 空白型, , 
.如果真 (等于 (取表项数 (), 0))
    信息框 (“播放列表里没有文件，请添加。”, 相加 (0, #警告图标), )
    返回 ()
.如果真结束
.如果真 (等于 (., -1))
    赋值 (., 0)
.如果真结束

.取标题 (., 1).未知支持库函数_56 ()
-1.未知支持库函数_66 ()
赋值 (., 未知支持库函数_64 ())
获取焦点 ()
赋值 (.时钟周期, 500) ' 时钟是用来自动播放下一首的


.子程序 _暂停按钮_被单击, 空白型, , 
.如果真 (等于 (未知支持库函数_61 (), 1))
    未知支持库函数_67 ()
.如果真结束
获取焦点 ()

.子程序 _继续按钮_被单击, 空白型, , 
.判断开始 (等于 (未知支持库函数_61 (), 2))
    -1.未知支持库函数_66 ()
.判断 (等于 (未知支持库函数_61 (), 3))
    相乘 (., 1000).未知支持库函数_66 ()
.默认
    
.判断结束
获取焦点 ()

.子程序 _停止按钮_被单击, 空白型, , 
赋值 (.时钟周期, 0)
赋值 (., 0)
未知支持库函数_68 ()
未知支持库函数_57 ()
获取焦点 ()

.子程序 _时钟1_周期事件, 空白型, , 
.判断开始 (等于 (未知支持库函数_61 (), 3))
    赋值 (.时钟周期, 0)
    返回 ()
.判断 (等于 (未知支持库函数_61 (), 2))
    赋值 (., 0)
    .判断开始 (等于 (.选中, 真))
        .如果 (等于 (., 相减 (取表项数 (), 1)))
            赋值 (.时钟周期, 0)
            返回 ()
        .否则
            赋值 (., 相加 (., 1))
            _播放按钮_被单击 ()
        .如果结束
        
    .判断 (等于 (.选中, 真))
        .如果 (等于 (., 相减 (取表项数 (), 1)))
            赋值 (., 0)
            _播放按钮_被单击 ()
        .否则
            赋值 (., 相加 (., 1))
            _播放按钮_被单击 ()
        .如果结束
        
    .默认
        
    .判断结束
    
.判断 (等于 (未知支持库函数_61 (), 1))
    赋值 (., 相除 (未知支持库函数_63 (), 1000))
.默认
    
.判断结束


.子程序 _超级按钮4_被单击, 空白型, , 
销毁 ()

.子程序 _批量按钮_被单击, 空白型, , 
.局部变量 文件夹, 文本型, , , 

赋值 (文件夹, 未知支持库函数_2 (“请选择文件夹,搜索MP3”, 假))
.如果真 (等于 (文件夹, “”))
    返回 ()
.如果真结束
添加MP3文件 (文件夹)
获取焦点 ()

.子程序 添加MP3文件, 空白型, , 
.参数 搜索目录, 文本型, , 

.局部变量 文件名, 文本型, , , 
.局部变量 子目录, 文本型, , , 


.如果真 (不等于 (取文本右边 (搜索目录, 1), “\”))
    赋值 (搜索目录, 相加 (搜索目录, “\”))
.如果真结束

赋值 (文件名, 寻找文件 (相加 (搜索目录, “*.mp3”), 39))
.判断循环首 (不等于 (文件名, “”))
    处理事件 ()
    .如果真 (并且 (不等于 (文件名, “.”), 不等于 (文件名, “..”)))
        .插入表项 (文件名, , , , )
        相减 (取表项数 (), 1).置标题 (1, 相加 (搜索目录, 文件名))
    .如果真结束
    赋值 (文件名, 寻找文件 ())
.判断循环尾 ()
赋值 (子目录, 寻找文件 (相加 (搜索目录, “*.*”), #子目录))
.判断循环首 (不等于 (子目录, “”))
    .如果真 (并且 (不等于 (子目录, “.”), 不等于 (子目录, “..”)))
        处理事件 ()
        添加MP3文件 (相加 (搜索目录, 子目录))
    .如果真结束
    赋值 (子目录, 寻找文件 (#子目录))
.判断循环尾 ()

.子程序 _上曲按钮_被单击, 空白型, , 
赋值 (., 相减 (., 1))
未知支持库函数_57 ()
.取标题 (., 1).未知支持库函数_56 ()
-1.未知支持库函数_66 ()
获取焦点 ()

.子程序 _下曲按钮_被单击, 空白型, , 
赋值 (., 相加 (., 1))
未知支持库函数_57 ()
.取标题 (., 1).未知支持库函数_56 ()
-1.未知支持库函数_66 ()
获取焦点 ()

.子程序 _删除按钮_被单击, 空白型, , 
未知支持库函数_68 ()
未知支持库函数_57 ()
赋值 (., 0)
.删除表项 (.)
获取焦点 ()

.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (.选中, 真)
未知支持库函数_0 (3)
设置背景 (相加 (取运行目录 (), “\背景.jpg”))

.子程序 _多功能条1_位置被改变, 空白型, , 
.如果真 (等于 (可有焦点 (), 真))
    相乘 (., 1000).未知支持库函数_66 ()
    获取焦点 ()
.如果真结束


.子程序 _多功能条1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

获取焦点 ()

.子程序 __启动窗口_将被销毁, 空白型, , 
未知支持库函数_68 ()
未知支持库函数_57 ()
设置背景 ()
清除背景 ()

.子程序 设置背景, 空白型, , 为超级列表框指定地址的图片
.参数 超级列表框, 超级列表框, , 要添加背景的超级列表框
.参数 图片, 文本型, 可空, 要添加的背景图片，为空时清除背景
.参数 平铺, 逻辑型, 可空, 是否平铺，为空则为真

.局部变量 背景图片, 未知类型0x410100A2, , , 

.如果真 (是否为空 (平铺))
    赋值 (平铺, 真)
.如果真结束
.如果 (或者 (是否为空 (图片), 小于或等于 (取文本长度 (图片), 0)))
    赋值 (背景图片., 0)
.否则
    超级列表框.发送信息 (4134, 0, -1) ' 让文本背景透明
    赋值 (背景图片., 位或 (2, 选择 (平铺, 16, 0)))
    赋值 (背景图片., 图片) ' 图片路径
    赋值 (背景图片., 0)
    赋值 (背景图片., 100) ' 左边与顶边偏移百分比，如果上面用平铺的话就没什么意义了
.如果结束
未知函数_167837859 (超级列表框.取窗口句柄 (), 4164, 0, 背景图片)

.子程序 清除背景, 空白型, 公开, 清除超级列表框的背景
.参数 超级列表框, 超级列表框, , 

.局部变量 背景图片, 未知类型0x410100B8, , , 

赋值 (背景图片., 0)
未知函数_167837881 (超级列表框.取窗口句柄 (), 4164, 0, 背景图片)


 ' 不属于任何一个程序集、类模块的函数：
