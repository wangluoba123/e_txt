 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 450
    高度 = 209
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “数据库转换”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' eDB 46E94341933A462383A4DE26B146322C 1 3 数据库操作支持库
 ' SqliteDB {295DD8F2-3584-4780-818D-9569AC5BC9D8} 1 5 Sqlite数据库支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一



 ' 所需要的模块
 ' 取mdb表名 $取mdb表名.ec



.窗口程序集 窗口程序集1, , , 

.程序集变量 Access数据库名, 文本型, , , 
.程序集变量 Sqlite数据库, 未知类型0x30001, , , 
.程序集变量 Sqlite数据库表, 未知类型0x30002, , , 
.程序集变量 Sqlite数据库名, 文本型, , , 
.程序集变量 Sqlite表字段信息, 未知类型0x3000A, , "0", 
.子程序 _按钮1_被单击, 空白型, , 
赋值 (.过滤器, “Access数据库(*.mdb)|*.mdb|所有文件(*.*)|*.*”)
赋值 (.初始目录, 取运行目录 ())
赋值 (.标题, “打开Access数据库文件”)
.如果 (打开 ())
    赋值 (Access数据库名, .文件名)
.否则
    信息框 (“打开Access数据库失败”, 0, )
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 数组Access表, 文本型, , "0", 存放Access数据库的表名
.局部变量 表的个数, 整数型, , , 共有几个表
.局部变量 字段个数, 整数型, , , 表中的字段个数
.局部变量 记录个数, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 字段定义长度, 整数型, , , 
.局部变量 字段类型, 整数型, , , Access字段类型
.局部变量 SQL字段, 未知类型0x3000A, , , 
.局部变量 数组读Access数据命令, 文本型, , "0", 用于判断该用什么命令读Access库的内容
.局部变量 读数组的下标, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 j, 整数型, , , 
.局部变量 内容1, 文本型, , , 
.局部变量 内容2, 整数型, , , 
.局部变量 内容3, 小数型, , , 
.局部变量 内容4, 双精度小数型, , , 
.局部变量 内容5, 逻辑型, , , 
.局部变量 内容6, 日期时间型, , , 

 ' 先取得Access库的所有表的表名，存放于数组Access表中

.如果真 (等于 (Access数据库名, “”))
    信息框 (“请先打开Access数据库文件”, 0, )
    返回 ()
.如果真结束

.如果真 (取反 (取mdb表名 (Access数据库名, 数组Access表)))
    信息框 (“取Access数据库表名失败”, 0, )
    返回 ()
.如果真结束

.如果真 (等于 (Access数据库名.未知支持库函数_1 (“”), 假))
    信息框 (“连接Access数据库失败，请重新打开Access数据库文件。”, 0, )
    返回 ()
.如果真结束

.如果真 (等于 (信息框 (相加 (“将在Access数据库文件目录下创建同名的Sqlite数据库，”, #换行符, “如果Sqlite数据库文件存在将被覆盖。”, “确认创建文件吗？”), #确认取消钮, “创建Sqlite数据库提示”), #取消钮))
    返回 ()
.如果真结束

赋值 (., 真)
赋值 (.可视, 假)
赋值 (表的个数, 取数组成员数 (数组Access表))
.未知支持库函数_12 ()

 ' 创建SQLite数据库结构
赋值 (Sqlite数据库名, 相加 (取文本左边 (Access数据库名, 相减 (取文本长度 (Access数据库名), 3)), “sdb”))
Sqlite数据库.未知支持库函数_30 (Sqlite数据库名, 真)
重定义数组 (数组读Access数据命令, 假, 表的个数, 1)

 ' 信息框 (“一维：” ＋ 到文本 (取数组下标 (数组读Access数据命令, 1)) ＋ “二维” ＋ 到文本 (取数组下标 (数组读Access数据命令, 2)), 0, )

赋值 (i, 0)
.计次循环首 (表的个数, i)
    数组Access表.未知支持库函数_14 ( [i], #)
    赋值 (字段个数, .)
     ' Access的取字段类型命令     通过序号或字段名取得字段类型，返回以下常量值之一： 20、#超长整数字段； 128、#二进制字段； 11、#逻辑型字段； 8、#宽文本字段； 129、#字符型字段； 6、#货币型字段； 7、#日期型字段； 133、#数据库日期型字段； 134、#时间型字段； 135、#时间戳字段； 14、#数值型字段； 5、#双精度字段； 0、#空白型字段； 10、#错误码字段； 72、#标识型字段； 9、#IDispatch字段； 3、#整数型字段； 13、#IUnknown字段； 205、#超变长二进制字段； 201、#超变长文本字段； 203、#超变长宽文本字段； 131、#数字型字段； 4、#单精度字段； 2、#短整数字段； 16、#有符号字节字段； 21、#无符号超长整数字段； 19、#无符号整数字段； 18、#无符号短整数字段； 17、#字节型字段； 132、#自定义型字段； 204、#变长二进制字段； 200、#变长文本字段； 12、#变体型字段； 202、#变长宽文本字段； 130、#宽文本字段。
    
     ' Sqlite的字段类型：可以为以下值或常量值之一：-1、(主键，整数型自增字段)； 0、(无类型)； 1、#字节型； 2、#短整数型； 3、#整数型； 4、#长整数型； 5、#小数型； 6、#双精度小数型； 7、#逻辑型； 8、#日期时间型； 10、#文本型； 11、#字节集型； 12、#备注型。
    
    清除数组 (Sqlite表字段信息)
    赋值 (读数组的下标, 取数组下标 (数组读Access数据命令, 2))
    .如果真 (大于 (字段个数, 读数组的下标))
        重定义数组 (数组读Access数据命令, 真, 表的个数, 字段个数)
    .如果真结束
    
    
    赋值 (j, 0)
    .计次循环首 (字段个数, j)
        赋值 (字段名, 相减 (j, 1).未知支持库函数_39 ()) ' 字段序号从0开始
        赋值 (字段类型, 相减 (j, 1).未知支持库函数_43 ())
        赋值 (字段定义长度, 相减 (j, 1).未知支持库函数_41 ())
        赋值 (SQL字段., 字段名)
        赋值 (SQL字段., 字段定义长度)
        .判断开始 (或者 (等于 (字段类型, 0), 等于 (字段类型, 10), 等于 (字段类型, 72), 等于 (字段类型, 132), 等于 (字段类型, 12)))
            赋值 (SQL字段., 0)
            赋值 (数组读Access数据命令 [i] [j], “读文本”)
        .判断 (或者 (等于 (字段类型, 16), 等于 (字段类型, 17)))
            赋值 (SQL字段., 1)
            赋值 (数组读Access数据命令 [i] [j], “读文本”)
        .判断 (等于 (字段类型, 2))
            赋值 (SQL字段., 2)
            赋值 (数组读Access数据命令 [i] [j], “读整数”)
        .判断 (或者 (等于 (字段类型, 3), 等于 (字段类型, 18), 等于 (字段类型, 19), 等于 (字段类型, 21)))
            赋值 (SQL字段., 3)
            赋值 (数组读Access数据命令 [i] [j], “读整数”)
        .判断 (等于 (字段类型, 20))
            赋值 (SQL字段., 4)
            赋值 (数组读Access数据命令 [i] [j], “读整数”)
        .判断 (或者 (等于 (字段类型, 4), 等于 (字段类型, 14), 等于 (字段类型, 131)))
            赋值 (SQL字段., 5)
            赋值 (数组读Access数据命令 [i] [j], “读单精度”)
        .判断 (或者 (等于 (字段类型, 5), 等于 (字段类型, 6)))
            赋值 (SQL字段., 6)
            赋值 (数组读Access数据命令 [i] [j], “读双精度”)
        .判断 (等于 (字段类型, 11))
            赋值 (SQL字段., 7)
            赋值 (数组读Access数据命令 [i] [j], “读逻辑值”)
        .判断 (或者 (等于 (字段类型, 7), 等于 (字段类型, 133), 等于 (字段类型, 134), 等于 (字段类型, 135)))
            赋值 (SQL字段., 8)
            赋值 (数组读Access数据命令 [i] [j], “读日期时间”)
        .判断 (或者 (等于 (字段类型, 8), 等于 (字段类型, 129), 等于 (字段类型, 200)))
            赋值 (SQL字段., 10)
            赋值 (数组读Access数据命令 [i] [j], “读文本”)
        .判断 (或者 (等于 (字段类型, 128), 等于 (字段类型, 205), 等于 (字段类型, 204), 等于 (字段类型, 9), 等于 (字段类型, 13)))
            赋值 (SQL字段., 11)
            赋值 (数组读Access数据命令 [i] [j], “读文本”)
        .判断 (或者 (等于 (字段类型, 201), 等于 (字段类型, 202), 等于 (字段类型, 203)))
            赋值 (SQL字段., 12)
            赋值 (数组读Access数据命令 [i] [j], “读文本”)
        .默认
            
        .判断结束
        加入成员 (Sqlite表字段信息, SQL字段)
         ' 信息框 (SQL字段.名称 ＋ “,” ＋ 到文本 (SQL字段.类型), 0, )
        
    .计次循环尾 ()
    Sqlite数据库.未知支持库函数_61 (数组Access表 [i], Sqlite表字段信息)
    未知支持库函数_16 ()
.计次循环尾 ()

 ' 上面部分已完成Sqlite数据库的创建，下面部分将Access数据库的内容读入Sqlite数据库
赋值 (i, 0)
.计次循环首 (表的个数, i)
    数组Access表.未知支持库函数_14 ( [i], #)
    赋值 (字段个数, .)
    未知支持库函数_34 ()
    .如果真 (取反 (Sqlite数据库表.未知支持库函数_104 ()))
        Sqlite数据库表.未知支持库函数_105 (数组Access表 [i], Sqlite数据库)
    .如果真结束
    赋值 (j, 0)
    .判断循环首 (取反 (.))
        Sqlite数据库表.未知支持库函数_121 ()
        .计次循环首 (字段个数, j)
            .判断开始 (等于 (数组读Access数据命令 [i] [j], “读文本”))
                相减 (j, 1).未知支持库函数_26 (内容1)
                Sqlite数据库表.未知支持库函数_136 (j, 内容1)
            .判断 (等于 (数组读Access数据命令 [i] [j], “读整数”))
                相减 (j, 1).未知支持库函数_29 (内容2)
                Sqlite数据库表.未知支持库函数_136 (j, 内容2)
            .判断 (等于 (数组读Access数据命令 [i] [j], “读单精度”))
                相减 (j, 1).未知支持库函数_28 (内容3)
                Sqlite数据库表.未知支持库函数_136 (j, 内容3)
            .判断 (等于 (数组读Access数据命令 [i] [j], “读双精度”))
                相减 (j, 1).未知支持库函数_27 (内容4)
                Sqlite数据库表.未知支持库函数_136 (j, 内容4)
            .判断 (等于 (数组读Access数据命令 [i] [j], “读逻辑值”))
                相减 (j, 1).未知支持库函数_30 (内容5)
                Sqlite数据库表.未知支持库函数_136 (j, 内容5)
            .判断 (等于 (数组读Access数据命令 [i] [j], “读日期时间”))
                相减 (j, 1).未知支持库函数_31 (内容6)
                Sqlite数据库表.未知支持库函数_136 (j, 到文本 (内容6))
            .默认
                
            .判断结束
            
        .计次循环尾 ()
        Sqlite数据库表.未知支持库函数_123 ()
        未知支持库函数_36 ()
    .判断循环尾 ()
    Sqlite数据库表.未知支持库函数_106 ()
.计次循环尾 ()
Sqlite数据库.未知支持库函数_31 ()
信息框 (“已完成转换。”, 0, )
赋值 (., 假)
赋值 (.可视, 真)


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 取mdb表名, 逻辑型, , 取得mdb的所有表名。
.参数 mdb数据库, 文本型, , 要取表名的access数据库
.参数 表名, 文本型, 参考 数组, 文本数组，存储返回的表名




 ' 不属于任何一个程序集、类模块的函数：
