 ' 文件类型：Windows窗口程序

 ' 程序名称：局域网操作支持库例程
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 471
    高度 = 301
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假



.常量 超时, "120000", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 2 系统核心支持库
 ' WNet 1F356293DD5846469639B8145EBEC9FE 1 0 局域网操作支持库
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 1 1 多线程支持库




.全局变量 共享文件夹, 文本型, , "0", 存放取得的所有共享文件夹名称
.全局变量 取共享文件夹结束, 逻辑型, , , 
.全局变量 共享打印机, 文本型, , "0", 存放取得的所有共享打印机名称
.全局变量 取共享打印机结束, 逻辑型, , , 
.全局变量 主机名, 文本型, , "0", 存放取得的所有主机名
.全局变量 取主机名结束, 逻辑型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 局域网2, 未知类型0x20001, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 已加入, 逻辑型, , "3", 是否已加入对应的列表框
.局部变量 索引, 整数型, , , 
.局部变量 时间, 整数型, , , 

赋值 (., 真)
 ' 使用多线程，防止窗口失去响应
未知支持库函数_0 (&取共享文件夹, )
未知支持库函数_0 (&取共享打印机, )
未知支持库函数_0 (&取所有主机名, )

赋值 (时间, 取启动时间 ())
.判断循环首 (取反 (并且 (已加入 [1], 已加入 [2], 已加入 [3]))) ' 只有三个列表框都填充完毕才结束循环
    处理事件 ()
    延时 (1)
    .如果真 (大于 (相减 (取启动时间 (), 时间), #超时))
        信息框 (“操作超时，本程序即将结束！请稍后重新运行本程序。”, #信息图标, )
        结束 ()
    .如果真结束
    
    .判断开始 (并且 (取共享文件夹结束, 等于 (已加入 [1], 假))) ' 如果取共享文件夹结束，且共享文件夹没有加入对应的列表框
        赋值 (.可视, 假) ' 显示出下面的编辑框
        .变量循环首 (1, 取数组成员数 (共享文件夹), 1, 索引)
            共享文件夹.加入项目 ( [索引], )
        .变量循环尾 ()
        赋值 (已加入 [1], 真) ' 置标志，防止重复加入
    .判断 (并且 (取共享打印机结束, 等于 (已加入 [2], 假)))
        赋值 (.可视, 假)
        .变量循环首 (1, 取数组成员数 (共享打印机), 1, 索引)
            共享打印机.加入项目 ( [索引], )
        .变量循环尾 ()
        赋值 (已加入 [2], 真)
    .判断 (并且 (取主机名结束, 等于 (已加入 [3], 假)))
        赋值 (.可视, 假)
        .变量循环首 (1, 取数组成员数 (主机名), 1, 索引)
            主机名.加入项目 ( [索引], )
        .变量循环尾 ()
        赋值 (已加入 [3], 真)
    .默认
        
    .判断结束
    
.判断循环尾 ()
信息框 (相加 (“共享文件夹：”, 到文本 (取数组成员数 (共享文件夹)), “个”, #换行符, “共享打印机：”, 到文本 (取数组成员数 (共享打印机)), “个”, #换行符, “主机名：”, 到文本 (取数组成员数 (主机名)), “个”, #换行符, “请在取得的项目上单击鼠标右键，进行相应的操作！”), #信息图标, 相加 (“用时：”, 到文本 (相减 (取启动时间 (), 时间))))

.子程序 _共享文件夹列表框_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (.现行选中项, -1))
    返回 ()
.如果真结束
弹出菜单 ()

.子程序 _共享打印机列表框_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (.现行选中项, -1))
    返回 ()
.如果真结束
弹出菜单 ()

.子程序 _映射网络驱动器_被选择, 空白型, , 
.局部变量 驱动器名称, 文本型, , , 
.局部变量 局域网, 未知类型0x20001, , , 

赋值 (驱动器名称, 局域网.未知支持库函数_5 (.取项目文本 (.现行选中项), , , , , 假))
.如果 (不等于 (驱动器名称, “”))
    信息框 (相加 (“映射网络驱动器成功！该文件夹被映射到 ”, 驱动器名称, “ 盘。”), #信息图标, )
.否则
    信息框 (相加 (“映射网络驱动器失败！”, #换行符, “错误信息为：”, 局域网.未知支持库函数_11 ()), #错误图标, )
.如果结束


.子程序 _打开映射对话框_被选择, 空白型, , 
.局部变量 驱动器名称, 文本型, , , 
.局部变量 局域网, 未知类型0x20001, , , 

赋值 (驱动器名称, 局域网.未知支持库函数_7 (.取项目文本 (.现行选中项), 真, 真, 假, _启动窗口.取窗口句柄 ()))
.如果 (不等于 (驱动器名称, “”))
    信息框 (相加 (“映射网络驱动器成功！该文件夹被映射到 ”, 驱动器名称, “ 盘。”), #信息图标, )
.否则
    
.如果结束


.子程序 _映射网络打印机_被选择, 空白型, , 
.局部变量 打印机名称, 文本型, , , 

赋值 (打印机名称, 局域网2.未知支持库函数_5 (.取项目文本 (.现行选中项), , , , , 假))
.如果 (不等于 (打印机名称, “”))
    信息框 (相加 (“映射网络打印机成功！该打印机的名称为： ”, 打印机名称), #信息图标, )
.否则
    信息框 (相加 (“映射网络打印机失败！”, #换行符, “错误信息为：”, 局域网2.未知支持库函数_11 ()), #错误图标, )
.如果结束


.子程序 _取连接速度_被选择, 空白型, , 
.局部变量 返回值, 整数型, , , 
.局部变量 速度, 小数型, , , 

赋值 (返回值, 局域网2.未知支持库函数_4 (.取项目文本 (.现行选中项)))
.判断开始 (等于 (返回值, -1))
    信息框 (相加 (“无法取出与该共享的连接速度！”, #换行符, “错误信息为：”, 局域网2.未知支持库函数_11 ()), #错误图标, )
.判断 (不等于 (返回值, 0))
    赋值 (速度, 返回值) ' 用小数型变量提高精度
    赋值 (速度, 相除 (速度, 1024))
    信息框 (相加 (“与该共享的连接速度大概为：”, 到文本 (速度), “KB/s”), #信息图标, )
.默认
    信息框 (“暂时无法取得与该共享的连接速度！”, #信息图标, )
.判断结束


.子程序 _主机名列表框_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _取IP地址_被选择, 空白型, , 
信息框 (转换为IP地址 (子文本替换 (.取项目文本 (.现行选中项), “\\”, “”, , , 真)), #信息图标, )

.程序集 线程程序集, , , 保存线程子程序

.程序集变量 局域网, 未知类型0x20001, , , 
.子程序 取共享打印机, 空白型, , 
局域网.未知支持库函数_2 (#., 共享打印机, )
赋值 (取共享打印机结束, 真)

.子程序 取共享文件夹, 空白型, , 
局域网.未知支持库函数_2 (#., 共享文件夹, )
赋值 (取共享文件夹结束, 真)

.子程序 取所有主机名, 空白型, , 
局域网.未知支持库函数_3 (主机名)
赋值 (取主机名结束, 真)


 ' 不属于任何一个程序集、类模块的函数：
