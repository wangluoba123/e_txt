 ' 文件类型：Windows模块源码

 ' 程序名称：取配置项名
 ' 程序描述：取配置项名
@备注:
取配置项名
 ' 程序作者：portio
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：portio
 ' 版本号：1.0
 ' 创建号：0.0





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库





.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。


.子程序 取配置项名, 整数型, 公开, 返回配置项名数组成员数。返回 0 表示节名称下没有配置项；返回 -1 表示节名称或配置文件不存在。
.参数 配置文件名, 文本型, , 指定配置文件的名称，通常以.ini作为文件名后缀。
.参数 节名称, 文本型, , 包含欲读入配置项所处节的名称。
.参数 配置项名数组, 文本型, 参考 数组, 参数作为返回值使用。返回指定节中的各配置项名称。

.局部变量 配置文件号, 整数型, , , 
.局部变量 配置节名, 文本型, , "0", 
.局部变量 临时文本, 文本型, , , 
.局部变量 下个节名, 文本型, , , 
.局部变量 数, 整数型, , , 
.局部变量 个数, 整数型, , , 
.局部变量 有, 逻辑型, , , 
.局部变量 位置, 整数型, , , 

.如果 (文件是否存在 (配置文件名))
    赋值 (个数, 0)
    赋值 (配置文件号, 打开文件 (配置文件名, , ))
    赋值 (配置节名, 取配置节名 (配置文件名))
    赋值 (有, 假)
    .计次循环首 (取数组成员数 (配置节名), 数)
        .如果真 (等于 (配置节名 [数], 节名称))
            .如果 (小于 (数, 取数组成员数 (配置节名)))
                赋值 (下个节名, 配置节名 [相加 (数, 1)])
                
            .否则
                赋值 (下个节名, “”)
                
            .如果结束
            赋值 (有, 真)
            跳出循环 ()
            
        .如果真结束
        
    .计次循环尾 ()
    .如果 (有)
        移到文件首 (配置文件号)
        .判断循环首 (取反 (是否在文件尾 (配置文件号, )))
            赋值 (临时文本, 读入一行 (配置文件号))
            .如果真 (等于 (临时文本, 相加 (“[”, 节名称, “]”)))
                跳出循环 ()
                
            .如果真结束
            
        .判断循环尾 ()
        赋值 (临时文本, 读入一行 (配置文件号))
        .判断循环首 (选择 (等于 (下个节名, “”), 取反 (是否在文件尾 (配置文件号, )), 不等于 (临时文本, 相加 (“[”, 下个节名, “]”))))
            赋值 (个数, 相加 (个数, 1))
            重定义数组 (配置项名数组, 真, 个数)
            赋值 (配置项名数组 [个数], 取文本左边 (临时文本, 相减 (寻找文本 (临时文本, “=”, , 假), 1)))
            赋值 (临时文本, 读入一行 (配置文件号))
        .判断循环尾 ()
        返回 (个数)
        
    .否则
        返回 (-1)
        
    .如果结束
    
    
.否则
    返回 (-1)
    
.如果结束



 ' 不属于任何一个程序集、类模块的函数：
