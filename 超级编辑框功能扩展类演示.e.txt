 ' 文件类型：Windows窗口程序

 ' 程序名称：E写字板
 ' 程序描述：云外归鸟制作
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 460
    高度 = 402
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “演示”
    帮助文件名 = “”

窗口 插入表格窗口
    左边 = 50
    顶边 = 50
    宽度 = 468
    高度 = 374
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 预览窗口
    左边 = 50
    顶边 = 50
    宽度 = 397
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 8421504 '  0x808080
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 3
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “预览（A4纸）”
    帮助文件名 = “”



.常量 QQ动画组件名, "“ImageOle.GifAnimator”", 隐藏, {06ADA938-0FB0-4BC0-B19B-0A38AB17F182}


 ' 所需要的支持库：
 ' KRNLN d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二



 ' 所需要的模块
 ' 超级编辑框功能扩展类 D:\My Music\PB控件类\超级编辑框功能扩展类.ec



.DLL命令 取场景句柄_API, 整数型, "", "GetDC", , 
    .参数 hwnd, 空白型, , 

.DLL命令 枚举字体_API, 空白型, "", "EnumFontFamiliesA", , 
    .参数 hdc, 空白型, , 
    .参数 lpszFamily, 空白型, , 
    .参数 lpEnumFontFamProc, 子程序指针, , 
    .参数 lparam, 空白型, , 

.DLL命令 删除场景_API, 空白型, "", "ReleaseDC", , 
    .参数 hwnd, 空白型, , 
    .参数 hdc, 空白型, , 

.DLL命令 取设备信息_API, 整数型, "", "GetDeviceCaps", , 
    .参数 hdc, 空白型, , 
    .参数 nIndex, 空白型, , LOGPIXELSY = 90

.DLL命令 注册QQ动画组件_API, 整数型, "ImageOle.dll", "DllRegisterServer", , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 超级编辑框扩展类, 未知类型0x490104F6, , , 一定要程序集变量,不能用局部变量
.子程序 __启动窗口_尺寸被改变, 空白型, , 
赋值 (., 取用户区宽度 ())
赋值 (., 相减 (取用户区高度 (), .))
赋值 (.高度, .)

.子程序 __启动窗口_创建完毕, 空白型, , 
取系统字体列表 ()
超级编辑框扩展类.未知函数_67175641 () ' 联接上了,一个类只能对应一个超级编辑框,不然会出现能以意料的后果
超级编辑框扩展类.未知函数_67175651 (100)
_超级编辑框1_选择区被改变 ()

.子程序 _组合框1_列表项被选择, 空白型, , 
超级编辑框扩展类.未知函数_67175649 (.内容)

.子程序 _组合框2_列表项被选择, 空白型, , 
超级编辑框扩展类.未知函数_67175647 (到数值 (.内容))

.子程序 _超级编辑框1_选择区被改变, 空白型, , 
.局部变量 N, 整数型, , , 
.局部变量 按钮索引, 整数型, , , 
.局部变量 已加风格, 逻辑型, , , 


赋值 (.内容, 超级编辑框扩展类.未知函数_67175659 ())
赋值 (.内容, 到文本 (超级编辑框扩展类.未知函数_67175657 ()))

.如果 (等于 (., 0))
    3.加入状态 (#禁止)
    4.加入状态 (#禁止)
.否则
    3.去除状态 (#禁止)
    4.去除状态 (#禁止)
.如果结束

.如果 (未知支持库函数_21 ())
    5.去除状态 (#禁止)
.否则
    5.加入状态 (#禁止)
.如果结束

.如果 (未知支持库函数_14 ())
    6.去除状态 (#禁止)
.否则
    6.加入状态 (#禁止)
.如果结束

.如果 (超级编辑框扩展类.未知函数_67175662 ())
    7.去除状态 (#禁止)
.否则
    7.加入状态 (#禁止)
.如果结束


.计次循环首 (4, N)
    赋值 (按钮索引, 相加 (N, 9))
    .判断开始 (等于 (按钮索引, 10))
        赋值 (已加风格, 超级编辑框扩展类.未知函数_67175652 ())
    .判断 (等于 (按钮索引, 11))
        赋值 (已加风格, 超级编辑框扩展类.未知函数_67175653 ())
    .判断 (等于 (按钮索引, 12))
        赋值 (已加风格, 超级编辑框扩展类.未知函数_67175654 ())
    .判断 (等于 (按钮索引, 13))
        赋值 (已加风格, 超级编辑框扩展类.未知函数_67175655 ())
    .默认
        
    .判断结束
    .如果 (已加风格)
        按钮索引.加入状态 (#选中)
    .否则
        按钮索引.去除状态 (#选中)
    .如果结束
    
.计次循环尾 ()



.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.局部变量 状态, 整数型, , , 
.局部变量 已加风格, 逻辑型, , , 

.判断开始 (等于 (按钮索引, 0))
    .如果真 (.开始打印 ())
        超级编辑框扩展类.未知函数_67175664 (1, 10000)
        结束打印 ()
    .如果真结束
    
.判断 (等于 (按钮索引, 1))
    载入 (预览窗口, , 真)
.判断 (等于 (按钮索引, 3))
    未知支持库函数_18 ()
.判断 (等于 (按钮索引, 4))
    未知支持库函数_17 ()
.判断 (等于 (按钮索引, 5))
    未知支持库函数_20 ()
.判断 (等于 (按钮索引, 6))
    未知支持库函数_13 ()
.判断 (等于 (按钮索引, 7))
    超级编辑框扩展类.未知函数_67175661 ()
.判断 (并且 (大于或等于 (按钮索引, 10), 小于或等于 (按钮索引, 13)))
    赋值 (状态, 按钮索引.取状态 ())
    赋值 (已加风格, 等于 (位与 (状态, #选中), #选中))
    赋值 (已加风格, 取反 (已加风格))
    .判断开始 (等于 (按钮索引, 10))
        超级编辑框扩展类.未知函数_67175642 (已加风格)
    .判断 (等于 (按钮索引, 11))
        超级编辑框扩展类.未知函数_67175643 (已加风格)
    .判断 (等于 (按钮索引, 12))
        超级编辑框扩展类.未知函数_67175644 (已加风格)
    .判断 (等于 (按钮索引, 13))
        超级编辑框扩展类.未知函数_67175645 (已加风格)
    .默认
        
    .判断结束
    
.判断 (等于 (按钮索引, 8))
    载入 (插入表格窗口, , 真)
.判断 (等于 (按钮索引, 14))
    赋值 (.标记, “字体”)
    514.发送信息 (0, 0)
.判断 (等于 (按钮索引, 15))
    赋值 (.标记, “底色”)
    514.发送信息 (0, 0)
.默认
    
.判断结束


.子程序 _颜色选择器1_颜色被改变, 空白型, , 
.如果 (等于 (.标记, “字体”))
    超级编辑框扩展类.未知函数_67175648 (.颜色)
.否则
    超级编辑框扩展类.未知函数_67175667 (.颜色)
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 OLE对象, 对象, , , 

超级编辑框扩展类.未知函数_67175666 (OLE对象)
OLE对象.查看 ()

.子程序 _按钮2_被单击, 空白型, , 
.局部变量 对象, 对象, , , 
.局部变量 QQ组件路径, 文本型, , , 

.如果真 (打开 ())
    .如果真 (等于 (对象.创建 (#QQ动画组件名, ), 假))
        
        输出调试文本 (“QQ安装时没有注册这个组件,要到QQ的安装目录下寻找”)
        
        赋值 (QQ组件路径, 取文本注册项 (#本地机器, “SOFTWARE\Tencent\QQ\Install”, )) ' QQ安装路径
        .如果 (等于 (QQ组件路径, “”))
            
            输出调试文本 (“没有安装QQ,测试本程序同目录下有没有ImageOle.dll”)
            
            赋值 (QQ组件路径, 相加 (取运行目录 (), “\ImageOle.dll”))
            .如果真 (等于 (文件是否存在 (QQ组件路径), 假))
                信息框 (“你没有安装QQ，请把ImageOle.dll复制到同目录才能插入图片”, #信息图标, )
                返回 ()
            .如果真结束
            
        .否则
            置DLL装载目录 (QQ组件路径) ' 让程序可以在QQ的安装目录下注ImageOle.dll
        .如果结束
         ' 已经取得组件的路径
        注册QQ动画组件_API ()
        .如果真 (等于 (对象.创建 (#QQ动画组件名, ), 假)) ' 注册之后再创建
            信息框 (“ImageOle.dll已经损坏”, #错误图标, )
            返回 ()
        .如果真结束
        
    .如果真结束
     ' 开始插入图片对象
    对象.方法 (“LoadFromFile”, .文件名) ' 载入图片
    超级编辑框扩展类.未知函数_67175669 (对象)
    对象.逻辑方法 (“TriggerFrameChange”, ) ' 帧改变了
.如果真结束


.程序集 取系统相关程序集, , , 

.子程序 取系统字体列表, 空白型, , 
.局部变量 hdc, 空白型, , , 

赋值 (hdc, 取场景句柄_API (0))
枚举字体_API (hdc, 0, &FontFamily, 0)
删除场景_API (0, hdc)

.子程序 FontFamily, 整数型, , 
.参数 ELGFont, 整数型, , 
.参数 ntm, 空白型, , 
.参数 fonttype, 空白型, , 
.参数 lparam, 空白型, , 

_启动窗口.加入项目 (., 指针到文本 (相加 (ELGFont, 28)), )
返回 (1)


.子程序 取每英寸像素, 空白型, , 
.参数 Xdip, 空白型, 参考, 
.参数 Ydip, 空白型, 参考, 

.局部变量 hdc, 空白型, , , 

赋值 (hdc, 取场景句柄_API (0))
赋值 (Xdip, 取设备信息_API (hdc, 88))
赋值 (Ydip, 取设备信息_API (hdc, 90))
删除场景_API (0, hdc)


.窗口程序集 窗口程序集2, , , 

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 行数, 整数型, , , 
.局部变量 列数, 空白型, , , 
.局部变量 N, 整数型, , , 
.局部变量 列宽, 整数型, , , 
.局部变量 列宽数组, 空白型, , "0", 

赋值 (行数, 到数值 (.内容))
.如果真 (小于 (行数, 1))
    赋值 (行数, 1)
.如果真结束
.如果真 (大于 (行数, 20))
    赋值 (行数, 20)
.如果真结束
赋值 (列数, 取列数 ())
.计次循环首 (列数, N)
    赋值 (列宽, 相减 (N, 1).取列宽 ())
    加入成员 (列宽数组, 列宽)
.计次循环尾 ()
_启动窗口.未知函数_67175663 (., 列宽数组, 行数)
销毁 ()

.子程序 _按钮3_被单击, 空白型, , 
.局部变量 N, 整数型, , , 

赋值 (N, 相加 (取列数 (), 1))
.插入列 (相加 (“第”, 到文本 (N), “列”), 100, , , )
赋值 (.禁止, 假)

.子程序 _按钮4_被单击, 空白型, , 
.局部变量 N, 整数型, , , 

赋值 (N, 相减 (取列数 (), 1))
.如果真 (小于或等于 (N, 1)) ' 两列不要删除
    赋值 (.禁止, 真)
    返回 ()
.如果真结束
N.删除列 ()


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集3, , , 

.子程序 _预览窗口_创建完毕, 空白型, , 
.局部变量 x, 整数型, , , 
.局部变量 y, 整数型, , , 

 ' A4纸张的尺寸(8.5*11英寸)
取每英寸像素 (x, y)
赋值 (.宽度, 相乘 (8.5, x))
赋值 (.高度, 相乘 (11, y))


.子程序 _画板1_绘画, 空白型, , 
.参数 重画区左边, 整数型, , 
.参数 重画区上边, 整数型, , 
.参数 重画区右边, 整数型, , 
.参数 重画区下边, 整数型, , 

_启动窗口.未知函数_67175665 (., , 15, 35, 1030, 820, 1, 10000)
 ' 用0.01英寸做单位的打印机参数,现在用固定值
 ' 左边空,顶边空,打印区高度,打印区宽度,实际应用还要从打印机中取得(对应A4纸)


.子程序 _预览窗口_尺寸被改变, 空白型, , 
.局部变量 画板_左边, 整数型, , , 
.局部变量 最大位置, 整数型, , , 

赋值 (画板_左边, 相除 (相减 (预览窗口.取用户区宽度 (), .宽度), 2))
.如果真 (小于 (画板_左边, 0))
    赋值 (画板_左边, 0)
.如果真结束
赋值 (.左边, 画板_左边)

赋值 (.高度, 取用户区高度 ())
赋值 (.左边, 相减 (取用户区宽度 (), .宽度))
赋值 (最大位置, 相减 (.高度, 取用户区高度 ()))

.如果 (小于或等于 (最大位置, 0))
    赋值 (.可视, 假)
.否则
    赋值 (.最大位置, 相加 (最大位置, 20))
.如果结束
重画 ()

.子程序 _纵向滚动条1_位置被改变, 空白型, , 
赋值 (.顶边, 相减 (11, .位置))


.类模块 超级编辑框扩展类, , , 因为要插入图片,所以本类型一定要定义为程序集或全局变量

.子程序 依附, 逻辑型, , 挂接到要扩展功能的超级编辑框上,并且只能依附一个,不能重复
.参数 目标编辑框, 未知类型0x30006, , 



.子程序 置粗体, 逻辑型, , 设置成功返回真
.参数 是否粗体, 逻辑型, , 真为粗体,假为去除粗体



.子程序 置斜体, 逻辑型, , 设置成功返回真
.参数 是否斜体, 逻辑型, , 真为斜体,假为去除斜体



.子程序 置下划线, 逻辑型, , 设置成功返回真
.参数 是否下划线, 逻辑型, , 真为下划线,假为去除下划线



.子程序 置删除线, 逻辑型, , 设置成功返回真
.参数 是否删除线, 逻辑型, , 真为删除线,假为去除删除线



.子程序 置禁止修改, 逻辑型, , 设置成功返回真
.参数 是否禁止修改, 逻辑型, , 真为禁止修改,假为去除禁止修改



.子程序 置字体大小, 逻辑型, , 设置成功返回真
.参数 字体大小, 整数型, , 字体大小,字号



.子程序 置字体颜色, 逻辑型, , 设置成功返回真
.参数 字体颜色值, 整数型, , 



.子程序 置字体名称, 逻辑型, , 设置成功返回真
.参数 字体名称, 文本型, , 



.子程序 置纵向偏移, 逻辑型, , 设置成功返回真
.参数 纵向偏移, 整数型, , 



.子程序 置消撤次数, 逻辑型, , 设置成功返回真
.参数 消撤次数, 整数型, , UNDO的次数



.子程序 取粗体, 逻辑型, , 真为粗体,假为无粗体


.子程序 取斜体, 逻辑型, , 真为斜体


.子程序 取下划线, 逻辑型, , 真为下划线


.子程序 取删除线, 逻辑型, , 真为删除线


.子程序 取禁止修改, 逻辑型, , 真为禁止修改


.子程序 取字体大小, 整数型, , 返回字体大小,字号


.子程序 取字体颜色, 整数型, , 返回字体颜色值


.子程序 取字体名称, 文本型, , 设置成功返回真


.子程序 取纵向偏移, 整数型, , 返回纵向偏移


.子程序 编辑框重做, 空白型, , 在设置多次撤消之后可用


.子程序 可否重做, 逻辑型, , 真为可以，在设置多次撤消之后可用


.子程序 插入表格, 空白型, , 在当前位置插入表格
.参数 表格列宽, 整数型, 参考 数组, 为整数数组,数组成员数为列数,成员1的数值对应第一列的宽度(单位:点像素),类推
.参数 表格行数, 整数型, , 



.子程序 打印文档, 整数型, , 打印开始成功后调用
.参数 打印机, 打印机, , 
.参数 开始字符位置, 整数型, , 
.参数 结束字符位置, 整数型, , 



.子程序 打印预览, 整数型, , 本命令放在画板的“绘画”事件里执行
.参数 画板, 画板, , 画板要设置和纸张一样大小
.参数 左边空, 整数型, , 打印机的(单位用0.01英寸)
.参数 顶边空, 整数型, , 打印机的(单位用0.01英寸)
.参数 打印区高度, 整数型, , 打印机的(单位用0.01英寸)
.参数 打印区宽度, 整数型, , 打印机的(单位用0.01英寸)
.参数 开始字符位置, 整数型, , 
.参数 结束字符位置, 整数型, , 



.子程序 取丰富文本OLE接口, 逻辑型, , 取得成功返回真,对过该对象可以设置其它功能.比如:隐藏字,上下标,切换大小写等
.参数 对象, 对象, , 



.子程序 置文本底色, 逻辑型, , 设置成功返回真
.参数 颜色值, 整数型, , 



.子程序 取文本底色, 整数型, , 返回文本底色值,如果字体混合选中,则取得-9999999。


.子程序 插入OLE对象, 整数型, , 返回0为成功,非0为OLE的错误码
.参数 OLE对象, 对象, 参考, 比如由QQ组件产生的GIF图像对象




 ' 不属于任何一个程序集、类模块的函数：
