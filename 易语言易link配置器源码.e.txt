 ' 文件类型：Windows窗口程序

 ' 程序名称：易link配置器
 ' 程序描述：2010-5-30 21:27:00 
由Chaoren开源,改进作者在程序备注中,每次改进版本号+0.1 每次发布打包请打包前面版本所有源码或前面版本所有源码的下载地址,其他开源公约请在此加入
@备注:
作者:Chaoren,Needdo
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.2
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 519
    高度 = 306
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\易语言易link配置器源码.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “link.ini配置器”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext5 {E5000198-4471-40e2-92BC-D0BA075BDBB2} 2 0 扩展界面支持库五
 ' shell 52F260023059454187AF826A3C07AF2A 3 0 操作系统界面功能支持库





.窗口程序集 窗口程序集_启动窗口, , , 

.程序集变量 集_易目录, 文本型, , , 
.程序集变量 配置文件名, 文本型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 节名数组, 文本型, , "0", 
.局部变量 i, 整数型, , , 

赋值 (配置文件名, 相加 (取运行目录 (), “\linkcfg.ini”))
赋值 (节名数组, 取配置节名 (配置文件名))
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

清空 ()
.计次循环首 (取数组成员数 (节名数组), i)
    节名数组.加入项目 ( [i], )
.计次循环尾 ()
读链接配置属性 (配置文件名, .内容, .内容, .内容, .内容, , , , , .内容)

.未知支持库函数_20 (“用于指定链接器的类型的，可支持vc6, gcc4, elink, alink 等。目前暂不能用。”, -1, , , , )
.未知支持库函数_20 (“用于指定静态链接时所用的链接地址。”, -1, , , , )
.未知支持库函数_20 (相加 (“用于设置是否把链接命令行和错误信息输出为日志记录。”, #换行符, “建议为空，空为输出到易语言IDE的输出面板。”), -1, , , , )
.未知支持库函数_20 (“用于指定附加给链接器的额外参数。默认为空。”, -1, , , , )
.未知支持库函数_20 (“用于指定是否在易语言IDE的输出面板中输出链接器的命令行。建议选择。”, -1, , , , )
.未知支持库函数_20 (相加 (“用于指定，如果静态链接过程中出现过多错误信息（大约 30 条）时，是否允许中止链接。”, #换行符, “即，如果链接错误过多，会弹出信息框询问用户是否中止链接。”), -1, , , , )
.未知支持库函数_20 (“用于设置是否保留链接期间生成的中间文件（比如obj,res,lib 等文件）。建议否上，会生成垃圾文件。”, -1, , , , )
.未知支持库函数_20 (“用于设置是否显示在静态链接过程中连接器输出的警告（warning）信息。建议选择。”, -1, , , , )

.未知支持库函数_20 (“重新载入配置。”, -1, , , , )
.未知支持库函数_20 (“保存并且退出。”, -1, , , , )
.未知支持库函数_20 (“仅保存不退出。”, -1, , , , )
.未知支持库函数_20 (“仅退出，不保存。”, -1, , , , )
.未知支持库函数_20 (相加 (“我爱易语言”, #换行符, “by:Chaoren”), -1, , , , )
赋值 (集_易目录, 取文本左边 (取文本注册项 (#根类, “Applications\e.exe\shell\open\command\”, ), 相减 (取文本长度 (取文本注册项 (#根类, “Applications\e.exe\shell\open\command\”, )), 取文本长度 (“\e.exe /dde”)))) ' 取易语言安装目录 有时可能出错
赋值 (.内容, 集_易目录)
_按钮_重置_被单击 ()

.子程序 读链接配置属性, 逻辑型, , 可将文本返回到相应控件 配置文件不存在返回假
.参数 参_配置文件名, 文本型, 可空, 默认为 取运行目录 () ＋ “\linkcfg.ini”
.参数 参_链接器类型, 文本型, , 即配置项小节名
.参数 参_链接器地址, 文本型, 参考, linker
.参数 参_写出命令行, 文本型, 参考 可空, output_file
.参数 参_额外参数, 文本型, 参考 可空, extra_args
.参数 参_显示命令行到易输出, 选择框, 参考 可空, show_command_line
.参数 参_错误自动终止链接, 选择框, 参考 可空, stop_if_too_many_errors
.参数 参_链接后保留原文件, 选择框, 参考 可空, retain_intermediate_files
.参数 参_输出错误信息到易, 选择框, 参考 可空, show_warning
.参数 参_链接后动作, 文本型, 参考 可空, post_link_actionX 此处可做多个动作 代码处理还不完善

赋值 (参_配置文件名, 选择 (是否为空 (参_配置文件名), 相加 (取运行目录 (), “\linkcfg.ini”), 参_配置文件名))
.如果真 (等于 (文件是否存在 (参_配置文件名), 假))
    返回 (假)
.如果真结束
赋值 (参_链接器地址, 读配置项 (参_配置文件名, 参_链接器类型, “linker”, ))
赋值 (参_写出命令行, 读配置项 (参_配置文件名, 参_链接器类型, “output_file”, ))
赋值 (参_额外参数, 读配置项 (参_配置文件名, 参_链接器类型, “extra_args”, ))

赋值 (参_显示命令行到易输出.选中, 选择 (等于 (到小写 (读配置项 (参_配置文件名, 参_链接器类型, “show_command_line”, )), “yes”), 真, 假))
赋值 (参_错误自动终止链接.选中, 选择 (等于 (到小写 (读配置项 (参_配置文件名, 参_链接器类型, “stop_if_too_many_errors”, )), “yes”), 真, 假))
赋值 (参_链接后保留原文件.选中, 选择 (等于 (到小写 (读配置项 (参_配置文件名, 参_链接器类型, “retain_intermediate_files”, )), “yes”), 真, 假))
赋值 (参_输出错误信息到易.选中, 选择 (等于 (到小写 (读配置项 (参_配置文件名, 参_链接器类型, “show_warning”, )), “yes”), 真, 假))

赋值 (参_链接后动作, 读配置项 (参_配置文件名, 参_链接器类型, “post_link_actionX”, ))
返回 (真)

.子程序 写链接配置属性, 逻辑型, , 可将相应控件文本写到配置文件 配置文件不存在返回假
.参数 参_配置文件名, 文本型, 可空, 默认为 取运行目录 () ＋ “\linkcfg.ini”
.参数 参_链接器类型, 文本型, , 即配置项小节名
.参数 参_链接器地址, 文本型, , linker
.参数 参_写出命令行, 文本型, 可空, output_file
.参数 参_额外参数, 文本型, 可空, extra_args
.参数 参_显示命令行到易输出, 选择框, 可空, show_command_line
.参数 参_错误自动终止链接, 选择框, 可空, stop_if_too_many_errors
.参数 参_链接后保留原文件, 选择框, 可空, retain_intermediate_files
.参数 参_输出错误信息到易, 选择框, 可空, show_warning
.参数 参_链接后动作, 文本型, 可空, post_link_actionX 此处可做多个动作 代码处理还不完善

赋值 (参_配置文件名, 选择 (是否为空 (参_配置文件名), 相加 (取运行目录 (), “\linkcfg.ini”), 参_配置文件名))
.如果真 (等于 (文件是否存在 (参_配置文件名), 假))
    返回 (假)
.如果真结束
写配置项 (参_配置文件名, 参_链接器类型, “linker”, 参_链接器地址)
写配置项 (参_配置文件名, 参_链接器类型, “output_file”, 参_写出命令行)
写配置项 (参_配置文件名, 参_链接器类型, “extra_args”, 参_额外参数)
 ' 本源码来自易语言资源网(www.5A5X.com)
写配置项 (参_配置文件名, 参_链接器类型, “show_command_line”, 选择 (参_显示命令行到易输出.选中, “yes”, “no”))
写配置项 (参_配置文件名, 参_链接器类型, “stop_if_too_many_errors”, 选择 (参_错误自动终止链接.选中, “yes”, “no”))
写配置项 (参_配置文件名, 参_链接器类型, “retain_intermediate_files”, 选择 (参_链接后保留原文件.选中, “yes”, “no”))
写配置项 (参_配置文件名, 参_链接器类型, “show_warning”, 选择 (参_输出错误信息到易.选中, “yes”, “no”))

写配置项 (参_配置文件名, 参_链接器类型, “post_link_actionX”, 参_链接后动作)
返回 (真)

.子程序 _按钮_链接器地址_被单击, 空白型, , 
赋值 (.标题, “请选择链接器：”)
赋值 (.类型, 0)
赋值 (.过滤器, “连接器（link.exe）|link.exe|应用程序（*.exe）|*.exe|所有文件（*.*）|*.*”)
打开 ()
.如果真 (不等于 (.文件名, “”))
    赋值 (.内容, .文件名)
.如果真结束


.子程序 _按钮_写出命令行_被单击, 空白型, , 
赋值 (.标题, “请选择保存目录：”)
赋值 (.类型, 1)
赋值 (.过滤器, “文本文件（*.txt）|*.txt|所有文件（*.*）|*.*”)
打开 ()
.如果真 (不等于 (.文件名, “”))
    赋值 (.内容, .文件名)
.如果真结束
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _按钮_应用_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (“IDE地址不能为空！”, #警告图标, “错误！”)
    返回 ()
.如果真结束
赋值 (集_易目录, .内容)
.如果真 (等于 (文件是否存在 (集_易目录), 假))
    信息框 (“IDE地址必须存在！”, #警告图标, “错误！”)
    返回 ()
.如果真结束
.如果真 (等于 (文件是否存在 (相加 (集_易目录, “\tools\”)), 假))
    信息框 (相加 (集_易目录, “\tools\ 目录必须存在！”), #警告图标, “错误！”)
    返回 ()
.如果真结束

.如果真 (等于 (.内容, “”))
    信息框 (“链接器地址不能为空！”, #警告图标, “错误！”)
    返回 ()
.如果真结束
.判断开始 (等于 (.内容, “”))
    .如果真 (等于 (信息框 (“最好填一个链接器类型,否则无法保存到本程序配置文件 确定不保存?”, 相加 (#警告图标, #是否钮), “错误！”), #否钮))
        信息框 (“已放弃保存,配置文件未写入”, 0, )
        返回 ()
    .如果真结束
    
.默认
    写链接配置属性 (配置文件名, .内容, .内容, .内容, .内容, , , , , .内容)
     ' 本源码来自易语言资源网(www.5A5X.com)
.判断结束

写配置项 (相加 (集_易目录, “\tools\link.ini”), “linker”, “linker_type”, .内容)

 ' 编辑框_连接器地址.内容 ＝ 读配置项 (集_易目录 ＋ “\tools\link.ini”, “linker”, “linker”, )
 ' 编辑框_写出命令行.内容 ＝ 读配置项 (集_易目录 ＋ “\tools\link.ini”, “linker”, “output_file”, )
 ' 编辑框_额外参数.内容 ＝ 读配置项 (集_易目录 ＋ “\tools\link.ini”, “linker”, “extra_args”, )
写配置项 (相加 (集_易目录, “\tools\link.ini”), “linker”, “linker”, .内容)
写配置项 (相加 (集_易目录, “\tools\link.ini”), “linker”, “output_file”, .内容)
写配置项 (相加 (集_易目录, “\tools\link.ini”), “linker”, “extra_args”, .内容)

 ' .判断开始 (等于 (到大写 (读配置项 (相加 (集_易目录, “\tools\link.ini”), “linker”, “show_command_line”, )), “YES”))
     ' 选择框_显示命令行到易输出.选中 ＝ 真
.默认
     ' 选择框_显示命令行到易输出.选中 ＝ 假
.判断结束
 ' .判断开始 (等于 (到大写 (读配置项 (相加 (集_易目录, “\tools\link.ini”), “linker”, “stop_if_too_many_errors”, )), “YES”))
     ' 选择框_错误自动终止链接.选中 ＝ 真
.默认
     ' 选择框_错误自动终止链接.选中 ＝ 假
.判断结束
 ' .判断开始 (等于 (到大写 (读配置项 (相加 (集_易目录, “\tools\link.ini”), “linker”, “retain_intermediate_files”, )), “YES”))
     ' 选择框_链接后保留原文件.选中 ＝ 真
.默认
     ' 选择框_链接后保留原文件.选中 ＝ 假
.判断结束
 ' .判断开始 (等于 (到大写 (读配置项 (相加 (集_易目录, “\tools\link.ini”), “linker”, “show_warning”, )), “YES”))
     ' 选择框_输出错误信息到易.选中 ＝ 真
.默认
     ' 选择框_输出错误信息到易.选中 ＝ 假
.判断结束

.判断开始 (.选中)
    写配置项 (相加 (集_易目录, “\tools\link.ini”), “linker”, “show_command_line”, “yes”)
.默认
    写配置项 (相加 (集_易目录, “\tools\link.ini”), “linker”, “show_command_line”, “no”)
.判断结束
.判断开始 (.选中)
    写配置项 (相加 (集_易目录, “\tools\link.ini”), “linker”, “stop_if_too_many_errors”, “yes”)
.默认
    写配置项 (相加 (集_易目录, “\tools\link.ini”), “linker”, “stop_if_too_many_errors”, “no”)
.判断结束
.判断开始 (.选中)
    写配置项 (相加 (集_易目录, “\tools\link.ini”), “linker”, “retain_intermediate_files”, “yes”)
.默认
    写配置项 (相加 (集_易目录, “\tools\link.ini”), “linker”, “retain_intermediate_files”, “no”)
.判断结束
.判断开始 (.选中)
    写配置项 (相加 (集_易目录, “\tools\link.ini”), “linker”, “show_warning”, “yes”)
.默认
    写配置项 (相加 (集_易目录, “\tools\link.ini”), “linker”, “show_warning”, “no”)
.判断结束


.子程序 _按钮_重置_被单击, 空白型, , 读link配置到工具上
.局部变量 局_链接器类型, 文本型, , , 

赋值 (集_易目录, .内容)
赋值 (局_链接器类型, 读配置项 (相加 (集_易目录, “\tools\link.ini”), “linker”, “linker_type”, ))
 ' 调试输出 (局_链接器类型)
赋值 (.内容, 局_链接器类型)
赋值 (.内容, 读配置项 (相加 (集_易目录, “\tools\link.ini”), “linker”, “linker”, ))
赋值 (.内容, 读配置项 (相加 (集_易目录, “\tools\link.ini”), “linker”, “output_file”, ))
赋值 (.内容, 读配置项 (相加 (集_易目录, “\tools\link.ini”), “linker”, “extra_args”, ))
.判断开始 (等于 (到大写 (读配置项 (相加 (集_易目录, “\tools\link.ini”), “linker”, “show_command_line”, )), “YES”))
    赋值 (.选中, 真)
.默认
    赋值 (.选中, 假)
.判断结束
.判断开始 (等于 (到大写 (读配置项 (相加 (集_易目录, “\tools\link.ini”), “linker”, “stop_if_too_many_errors”, )), “YES”))
    赋值 (.选中, 真)
.默认
    赋值 (.选中, 假)
.判断结束
.判断开始 (等于 (到大写 (读配置项 (相加 (集_易目录, “\tools\link.ini”), “linker”, “retain_intermediate_files”, )), “YES”))
    赋值 (.选中, 真)
.默认
    赋值 (.选中, 假)
.判断结束
.判断开始 (等于 (到大写 (读配置项 (相加 (集_易目录, “\tools\link.ini”), “linker”, “show_warning”, )), “YES”))
    赋值 (.选中, 真)
.默认
    赋值 (.选中, 假)
.判断结束
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _按钮_取消_被单击, 空白型, , 
销毁 ()
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _按钮_确定_被单击, 空白型, , 
_按钮_应用_被单击 ()
销毁 ()

.子程序 _按钮_IDE地址_被单击, 空白型, , 
赋值 (.内容, 未知支持库函数_2 (“选择易IDE所在目录”, 假))



 ' 不属于任何一个程序集、类模块的函数：
