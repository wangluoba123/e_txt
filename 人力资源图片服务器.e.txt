 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：小芳工作室
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 811
    高度 = 563
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\人力资源图片服务器.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.图片 托盘图标, " ' 已保存到：D:\易语言学习\Data\人力资源图片服务器.e\托盘图标", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 2 0 数据操作支持库一
 ' spec A512548E76954B6E92C21055517615B0 3 0 特殊功能支持库





.窗口程序集 窗口程序集1, , , 

.程序集变量 程序集图片文件名, 文本型, , , 
.程序集变量 发送图片文件名的IP, 文本型, , , 
.子程序 _服务器图片进入_数据到达, 空白型, , 
.局部变量 接收到的数据, 文本型, , , 
.局部变量 图片文件名, 文本型, , , 












.子程序 _服务器图片_数据到达, 空白型, , 
.局部变量 接收到的数据, 文本型, , , 
.局部变量 取出需要查询头像的ID, 文本型, , , 
.局部变量 图片文件名, 文本型, , , 

赋值 (接收到的数据, 到文本 (取回数据 ()))
调试输出 (取回数据 ())

.如果 (等于 (取文本左边 (14), “发送的图片名称”))
    赋值 (图片文件名, 取文本右边 (接收到的数据, 相减 (取文本长度 (接收到的数据), 14)))
    赋值 ()
    赋值 (发送图片文件名的IP, 取回客户 ())
.否则
    
.如果结束

.如果 (不等于 (取文本左边 (接收到的数据, 14), “发送的图片名称”))
    .如果 (不等于 (取文本左边 (接收到的数据, 12), “我要查询头像”))
        .如果 (等于 (取回客户 (), 发送图片文件名的IP))
            写到文件 (相加 (取运行目录 (), “\人员头像\”, 程序集图片文件名), 取回数据 ())
            相加 (到文本 (取时间 (取现行时间 ())), “进入：”, , #换行符).加入文本 ()
            赋值 (“”)
            赋值 (“”)
        .否则
            
            
            赋值 (“”)
            赋值 (“”)
        .如果结束
        
    .否则
        
    .如果结束
    
.否则
    
.如果结束

.如果 (等于 (取文本左边 (接收到的数据, 12), “我要查询头像”))
    赋值 (取出需要查询头像的ID, 取文本右边 (接收到的数据, 相减 (取文本长度 (接收到的数据), 12)))
    .如果 (文件是否存在 (相加 (取运行目录 (), “\人员头像\”, 取出需要查询头像的ID)))
        调试输出 (取回客户 ().发送数据 (相加 (取运行目录 (), “\人员头像\”, 取出需要查询头像的ID), ))
        
        调试输出 (相加 (取运行目录 (), “\人员头像\”, 取出需要查询头像的ID))
        
        相加 (到文本 (取时间 (取现行时间 ())), “已传送：”, 取出需要查询头像的ID, #换行符).加入文本 ()
    .否则
        取回客户 ().发送数据 (“服务器发送给来的数据为空”, )
    .如果结束
    
.否则
    
.如果结束



.子程序 __启动窗口_创建完毕, 空白型, , 
_按钮服务器启动图片_被单击 ()
_按钮服务器启动注册_被单击 ()
.如果真 (等于 (文件是否存在 (相加 (取运行目录 (), “\人员头像”)), 假))
    创建目录 (相加 (取运行目录 (), “\人员头像”))
.如果真结束


.子程序 _按钮服务器启动图片_被单击, 空白型, , 
.如果 (等于 (.标题, “启动”))
    赋值 (.标题, “停止”)
    赋值 (.端口, 19737)
    赋值 (.内容, “服务器状态：已启动”)
    赋值 (.背景颜色, #墨绿)
.否则
    赋值 (.标题, “启动”)
    赋值 (.端口, 0)
    赋值 (.内容, “服务器状态：已停止”)
    赋值 (.背景颜色, #红色)
.如果结束


.子程序 _按钮服务器启动注册_被单击, 空白型, , 
.如果 (等于 (.标题, “启动”))
    赋值 (.端口, 19738)
    赋值 (.标题, “停止”)
    赋值 (.内容, 相加 (“服务器状态：”, “已启动”))
    赋值 (.背景颜色, #墨绿)
    
.否则
    赋值 (.端口, 0)
    赋值 (.标题, “启动”)
    赋值 (.内容, 相加 (“服务器状态：”, “已停止”))
    赋值 (.背景颜色, #红色)
.如果结束


.子程序 _服务器软件注册_数据到达, 空白型, , 
.局部变量 接收到的数据, 文本型, , , 

赋值 (接收到的数据, 到文本 (取回数据 ()))
.如果 (等于 (取文本左边 (接收到的数据, 12), “我要申请注册”))
    赋值 (.内容, 取文本右边 (接收到的数据, 相减 (取文本长度 (接收到的数据), 12)))
    赋值 (.内容, 取回客户 ())
    .如果 (不等于 (.内容, “”))
        .判断开始 (等于 (.选中, 真))
            _按钮计算注册码_被单击 ()
            _按钮发送注册码_被单击 ()
            
        .默认
            
        .判断结束
        
    .否则
        
    .如果结束
    
.否则
    
.如果结束


.子程序 _服务器软件注册_客户进入, 空白型, , 
赋值 (.内容, 到文本 (相加 (到数值 (.内容), 1)))
取回客户 ().加入项目 ()

.子程序 _服务器软件注册_客户离开, 空白型, , 
.局部变量 已进入客户, 文本型, , , 
.局部变量 n1, 整数型, , , 

赋值 (已进入客户, 取回客户 ())
赋值 (.内容, 到文本 (相减 (到数值 (.内容), 1)))
.计次循环首 (取项目数 (), n1)
    .如果真 (等于 (相减 (n1, 1).取项目文本 (), 已进入客户))
        相减 (n1, 1).删除项目 ()
    .如果真结束
    
.计次循环尾 ()


.子程序 _按钮发送注册码_被单击, 空白型, , 
.如果 (.发送数据 (.内容, 相加 (“发送回来的注册码”, .内容), 10))
    信息框 (“发送注册码成功！”, 0, )
.否则
    信息框 (“发送注册码失败，可能已经离线！”, 0, )
.如果结束
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)



.子程序 _按钮计算注册码_被单击, 空白型, , 
赋值 (.内容, 到大写 (未知支持库函数_2 (未知支持库函数_3 (到字节集 (.内容), “liujinfang”, ))))


.子程序 __启动窗口_位置被改变, 空白型, , 
.判断开始 (等于 (_启动窗口., 2))
    赋值 (_启动窗口., 假)
    赋值 (_启动窗口., 假)
    置托盘图标 (#托盘图标, “图片服务器”)
.默认
    
.判断结束


.子程序 __启动窗口_托盘事件, 空白型, , 
.参数 操作类型, 整数型, , 

.判断开始 (等于 (操作类型, 2))
    _打开程序_被选择 ()
.默认
    
.判断结束
.判断开始 (等于 (操作类型, 3))
    _启动窗口.弹出托盘菜单 ()
.默认
    
.判断结束


.子程序 _打开程序_被选择, 空白型, , 
赋值 (_启动窗口., 真)
赋值 (_启动窗口., 1)
赋值 (_启动窗口., 真)



 ' 不属于任何一个程序集、类模块的函数：
