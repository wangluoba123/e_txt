 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 663
    高度 = 471
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 128 '  0x80
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “拼图”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 6 系统核心支持库





.DLL命令 获取特别文件夹位置_, 空白型, "shell32.dll", "SHGetSpecialFolderPathA", , 
    .参数 a, 空白型, , 
    .参数 b, 文本型, , 
    .参数 c, 空白型, , 
    .参数 d, 空白型, , 

.DLL命令 删除路径文件名_, 整数型, "shlwapi.dll", "PathRemoveFileSpecA", , 如："c:\windows\boot.ini"返回"c:\windows"
    .参数 路径文本, 文本型, , pszPath

.窗口程序集 窗口程序集1, , , 

.程序集变量 图片号, 空白型, , , 
.程序集变量 临时图片, 字节集, , , 
.程序集变量 拼图画板, 画板, , "0", 
.程序集变量 横坐标组, 空白型, , "0", 
.程序集变量 纵坐标组, 空白型, , "0", 
.程序集变量 排名, 空白型, , "0", 
.程序集变量 开始, 逻辑型, , , 
.子程序 _选择图片按钮_被单击, 空白型, , 
.局部变量 变量, 空白型, , , 
.局部变量 路径, 文本型, , , 

.如果真 (等于 (打开 (), 假))
    返回 ()
.如果真结束
.如果真 (不等于 (图片号, 0))
    卸载图片 (图片号)
.如果真结束
赋值 (., “”)
赋值 (., 0)
赋值 (图片号, 载入图片 (.))
.如果 (大于 (图片号.取图片宽度 (), 图片号.取图片高度 ()))
    赋值 (., 400)
    赋值 (., 相乘 (相除 (400, 图片号.取图片宽度 ()), 图片号.取图片高度 ()))
.否则
    赋值 (., 相乘 (相除 (400, 图片号.取图片高度 ()), 图片号.取图片宽度 ()))
    赋值 (., 400)
.如果结束
赋值 (., 相乘 (相除 (., .), 140))
赋值 (., 相加 (., ., 5))
.计次循环首 (取数组成员数 (拼图画板), 变量)
    .如果真 (是否已创建 (拼图画板 [变量]))
        赋值 (拼图画板 [变量], , 假)
    .如果真结束
    
.计次循环尾 ()
图片号.画图片 (0, 0, ., ., )
图片号.画图片 (0, 0, ., ., )
写配置项 (相加 (取运行目录 (), “\成绩.ini”), “图片”, “路径”, .)
赋值 (., 相加 (., 35))
赋值 (., 相加 (160, .))
赋值 (., 1)
赋值 (., 相减 (取用户区高度 (), ., 5))

.子程序 子画板初始, 空白型, , 
.参数 格数, 整数型, , 

.局部变量 变量, 整数型, , , 
.局部变量 变量1, 空白型, , , 
.局部变量 局部_横坐标, 整数型, , , 横坐标
.局部变量 局部_纵坐标, 整数型, , , 纵坐标
.局部变量 i, 空白型, , , 
.局部变量 子画板, 画板, , , 
.局部变量 末画板, 画板, , , 

赋值 (开始, 真)
图片号.画图片 (0, 0, ., ., )
赋值 (., 0)
赋值 (., 假)
图片号.画图片 (0, 0, ., ., )

赋值 (局部_横坐标, 格数)
赋值 (局部_纵坐标, 格数)
重定义数组 (拼图画板, 真, 81)
清除数组 (横坐标组)
清除数组 (纵坐标组)
.计次循环首 (取数组成员数 (拼图画板), 变量)
    .如果真 (是否已创建 (拼图画板 [变量]))
        赋值 (拼图画板 [变量], , 假)
    .如果真结束
    
.计次循环尾 ()
重定义数组 (拼图画板, 真, 相乘 (格数, 格数))
赋值 (., 相除 (., 格数))
赋值 (., 相除 (., 格数))
.计次循环首 (相乘 (格数, 格数), 变量)
    .如果真 (取反 (是否已创建 (拼图画板 [变量])))
        复制窗口组件 (拼图画板 [变量])
    .如果真结束
    赋值 (拼图画板 [变量], , .)
    赋值 (拼图画板 [变量], , .)
    赋值 (拼图画板 [变量], , 0)
    赋值 (拼图画板 [变量], , 到文本 (变量))
    赋值 (局部_横坐标, 相乘 (拼图画板 [变量], , 求余数 (相减 (变量, 1), 格数)))
    赋值 (局部_纵坐标, 相乘 (拼图画板 [变量], , 取整 (相除 (相减 (变量, 1), 格数))))
    加入成员 (横坐标组, 局部_横坐标)
    加入成员 (纵坐标组, 局部_纵坐标)
    局部_横坐标.复制 (局部_纵坐标, 拼图画板 [变量], , 拼图画板 [变量], , 拼图画板 [变量], , , )
    赋值 (拼图画板 [变量], , 局部_横坐标)
    赋值 (拼图画板 [变量], , 局部_纵坐标)
    赋值 (拼图画板 [变量], , 真)
.计次循环尾 ()
赋值 (., 1)
赋值 (., 真)
赋值 (., 相乘 (相除 (., .), 140))
赋值 (., 相加 (., ., 5))
图片号.画图片 (0, 0, ., ., )
赋值 (末画板, 拼图画板 [相乘 (格数, 格数)])
置随机数种子 ()
赋值 (临时图片, 末画板.取图片 ())
赋值 (末画板., 1)
赋值 (末画板., {  })
.计次循环首 (相乘 (格数, 格数, 100), i)
    赋值 (变量, 取随机数 (1, 4))
    .判断开始 (等于 (变量, 1))
        赋值 (变量1, 相减 (到数值 (末画板.), 格数))
        .如果真 (小于 (变量1, 1))
            赋值 (变量1, 相加 (到数值 (末画板.), 格数))
        .如果真结束
        赋值 (子画板, 取标记组件 (变量1))
        赋值 (子画板., 末画板.)
        赋值 (末画板., 到文本 (变量1))
        
    .判断 (等于 (变量, 2))
        赋值 (变量1, 相减 (到数值 (末画板.), 1))
        .如果真 (小于 (变量1, 1))
            赋值 (变量1, 相加 (到数值 (末画板.), 1))
        .如果真结束
        赋值 (子画板, 取标记组件 (变量1))
        赋值 (子画板., 末画板.)
        赋值 (末画板., 到文本 (变量1))
        
    .判断 (等于 (变量, 3))
        赋值 (变量1, 相加 (到数值 (末画板.), 格数))
        .如果真 (大于 (变量1, 相乘 (格数, 格数)))
            赋值 (变量1, 相减 (到数值 (末画板.), 格数))
        .如果真结束
        赋值 (子画板, 取标记组件 (变量1))
        赋值 (子画板., 末画板.)
        赋值 (末画板., 到文本 (变量1))
        
    .默认
        赋值 (变量1, 相加 (到数值 (末画板.), 1))
        .如果真 (大于 (变量1, 相乘 (格数, 格数)))
            赋值 (变量1, 相减 (到数值 (末画板.), 1))
        .如果真结束
        赋值 (子画板, 取标记组件 (变量1))
        赋值 (子画板., 末画板.)
        赋值 (末画板., 到文本 (变量1))
    .判断结束
    
.计次循环尾 ()
.计次循环首 (相乘 (格数, 格数), i)
    赋值 (子画板, 取标记组件 (i))
    赋值 (子画板., 横坐标组 [i])
    赋值 (子画板., 纵坐标组 [i])
.计次循环尾 ()
赋值 (., “”)
赋值 (., 1000)

.子程序 _画板_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 子画板, 画板, , , 当前画板
.局部变量 子画板左边, 整数型, , , 子画板左边
.局部变量 子画板顶边, 整数型, , , 子画板顶边
.局部变量 末画板, 画板, , , 

.如果真 (开始)
    赋值 (子画板, 取事件组件 ())
    赋值 (末画板, 拼图画板 [取数组成员数 (拼图画板)])
    .如果真 (或者 (并且 (等于 (子画板., 相加 (末画板., 末画板.)), 等于 (子画板., 末画板.)), 并且 (等于 (子画板., 相减 (末画板., 末画板.)), 等于 (子画板., 末画板.)), 并且 (等于 (子画板., 末画板.), 等于 (子画板., 相加 (末画板., 末画板.))), 并且 (等于 (子画板., 末画板.), 等于 (子画板., 相减 (末画板., 末画板.)))))
        赋值 (子画板左边, 子画板.)
        赋值 (子画板顶边, 子画板.)
        子画板.发送信息 (161, 2, 0)
        赋值 (子画板., 末画板.)
        赋值 (子画板., 末画板.)
        赋值 (末画板., 子画板左边)
        赋值 (末画板., 子画板顶边)
        计算结果 ()
    .如果真结束
    
.如果真结束



.子程序 计算结果, 空白型, , 
.局部变量 i, 空白型, , , 
.局部变量 ok, 逻辑型, , , 

.计次循环首 (取数组成员数 (拼图画板), i)
    .如果 (并且 (等于 (拼图画板 [i], , 横坐标组 [i]), 等于 (拼图画板 [i], , 纵坐标组 [i])))
        赋值 (ok, 真)
    .否则
        赋值 (ok, 假)
        跳出循环 ()
    .如果结束
    
.计次循环尾 ()
.如果真 (ok)
    赋值 (拼图画板 [取数组成员数 (拼图画板)]., 0)
    赋值 (拼图画板 [取数组成员数 (拼图画板)]., 临时图片)
    赋值 (开始, 假)
    赋值 (., 0)
    加入成员 (排名, 到数值 (.))
    数组排序 (排名, )
    .如果真 (大于 (取数组成员数 (排名), 10))
        重定义数组 (排名, 真, 10)
    .如果真结束
    
    清空 ()
    .计次循环首 (取数组成员数 (排名), i)
        相加 (“第”, 到文本 (i), “名. ”, 到文本 (排名 [i]), “ 秒”).加入项目 ()
        写配置项 (相加 (取运行目录 (), “\成绩.ini”), ., 到文本 (i), 到文本 (排名 [i]))
    .计次循环尾 ()
.如果真结束


.子程序 _开始按钮_被单击, 空白型, , 
赋值 (., 0)
赋值 (., “”)
子画板初始 (相加 (., 3))

.子程序 _时钟1_周期事件, 空白型, , 
赋值 (., 到文本 (相加 (到数值 (.), 1)))

.子程序 读排名, 空白型, , 
.局部变量 i, 空白型, , , 
.局部变量 时间, 文本型, , , 

清除数组 (排名)
清空 ()
.计次循环首 (10, i)
    赋值 (时间, 读配置项 (相加 (取运行目录 (), “\成绩.ini”), ., 到文本 (i), ))
    .如果真 (大于 (到数值 (时间), 0))
        加入成员 (排名, 到数值 (时间))
        相加 (“第”, 到文本 (i), “名. ”, 时间, “ 秒”).加入项目 ()
    .如果真结束
    
.计次循环尾 ()

.子程序 _组合框1_列表项被选择, 空白型, , 
读排名 ()

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 局_路径, 文本型, , , 


赋值 (局_路径, 读配置项 (相加 (取运行目录 (), “\成绩.ini”), “图片”, “路径”, ))
.如果 (文件是否存在 (局_路径))
    赋值 (图片号, 载入图片 (局_路径))
    .如果 (大于 (图片号.取图片宽度 (), 图片号.取图片高度 ()))
        赋值 (., 400)
        赋值 (., 相乘 (相除 (400, 图片号.取图片宽度 ()), 图片号.取图片高度 ()))
    .否则
        赋值 (., 相乘 (相除 (400, 图片号.取图片高度 ()), 图片号.取图片宽度 ()))
        赋值 (., 400)
    .如果结束
    赋值 (., 相乘 (相除 (., .), 140))
    赋值 (., 相加 (., ., 5))
    图片号.画图片 (0, 0, ., ., )
    图片号.画图片 (0, 0, ., ., )
    删除路径文件名_ (局_路径)
    赋值 (., 局_路径)
.否则
    赋值 (取空白文本 (255))
    获取特别文件夹位置_ (0, 局_路径, 39, 0)
    赋值 (., 局_路径)
.如果结束
赋值 (., 相加 (., 35))
赋值 (., 相加 (160, .))
赋值 (., 1)
赋值 (., 相减 (取用户区高度 (), ., 5))
读排名 ()


 ' 不属于任何一个程序集、类模块的函数：
