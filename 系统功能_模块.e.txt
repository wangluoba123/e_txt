 ' 文件类型：Windows模块源码

 ' 程序名称：系统功能
 ' 程序描述：模块_枚举字体
模块_文件关联管理
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 2 系统核心支持库




数据类型 逻辑字体_, , LOGFONT
    .成员 高度, 整数型, , , lfHeight
    .成员 宽度, 整数型, , , lfWidth
    .成员 控制摆, 整数型, , , lfEscapement
    .成员 定方位, 整数型, , , lfOrientation
    .成员 加粗, 整数型, , , lfWeight
    .成员 斜体, 字节型, , , lfItalic
    .成员 下划线, 字节型, , , lfUnderline
    .成员 袭击出, 字节型, , , lfStrikeOut
    .成员 零碎工作组合, 字节型, , , lfCharSet
    .成员 出自精确, 字节型, , , lfOutPrecision
    .成员 修剪精确, 字节型, , , lfClipPrecision
    .成员 性质, 字节型, , , lfQuality
    .成员 间距, 字节型, , , lfPitchAndFamily
    .成员 字体名称, 字节型, , "32", 用LF_FACESIZE,lfFaceName?


.DLL命令 Api_枚举字体, 整数型, "", "EnumFontsA", , 
    .参数 设备场景句柄, 整数型, , hdc,设备场景的句柄
    .参数 枚举的字体资源, 整数型, , lpszFamily,欲枚举的字体家族
    .参数 函数地址, 子程序指针, , lpEnumFontFamProc,欲调用的函数地址
    .参数 自定义值, 整数型, , lParam,指定希望传递给回调函数的一个用户自定义值

.DLL命令 Api_取设备场景句柄, 整数型, "", "GetDC", , 
    .参数 设备场景句柄, 整数型, , 

.DLL命令 Api_复制内存, 整数型, "", "RtlMoveMemory", , 
    .参数 目标区块, 逻辑字体_, , 
    .参数 源区块, 整数型, , 
    .参数 尺寸, 整数型, , 

.程序集 程序集1, , , 

.程序集变量 字体数组, 文本型, , "0", 
.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
.局部变量 i, 空白型, , , 

 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。

.子程序 模块_枚举字体, 空白型, , 
.参数 字体数组参数, 文本型, 参考 数组, 接收字体名称的数组

Api_枚举字体 (Api_取设备场景句柄 (0), 0, &枚举字体子程序, 0)
赋值 (字体数组参数, 字体数组)

.子程序 枚举字体子程序, 整数型, , 
.参数 lplf, 整数型, , 
.参数 lptm, 整数型, , 
.参数 dwType, 整数型, , 
.参数 lpData, 整数型, , 

.局部变量 逻辑字体, 逻辑字体_, , , 
.局部变量 FontName, 字节型, , "32", 
.局部变量 字体名称, 文本型, , , 
.局部变量 计次数量, 整数型, , , 

Api_复制内存 (逻辑字体, lplf, 60)
赋值 (字体名称, “”)
.计次循环首 (取数组成员数 (逻辑字体.字体名称), 计次数量)
    .如果 (不等于 (字符 (逻辑字体.字体名称 [计次数量]), 字符 (0)))
        赋值 (字体名称, 相加 (字体名称, 字符 (逻辑字体.字体名称 [计次数量])))
    .否则
        加入成员 (字体数组, 字体名称)
        跳出循环 ()
    .如果结束
    
.计次循环尾 ()
返回 (1)

.子程序 模块_文件关联, 逻辑型, 公开, 
.参数 关联应用程序, 文本型, 可空, 当双击对应的文件时就运行该应用程序打开
.参数 关联文件类型, 文本型, 可空, 欲关联的文件类型，如“ABC”
.参数 关联文件图标, 文本型, 可空, ICQ文件路径或EXE文件路径，注销后才有效

.如果真 (或者 (是否为空 (关联应用程序), 是否为空 (关联文件类型), 是否为空 (关联文件图标)))
    删除注册项 (#根类, 相加 (“.”, “关联文件类型”))
    删除注册项 (#根类, 相加 (关联文件类型, “file\DefaultIcon”))
    删除注册项 (#根类, 相加 (关联文件类型, “file\shell\open\command”))
    删除注册项 (#根类, 相加 (关联文件类型, “file\shell\open”))
    删除注册项 (#根类, 相加 (关联文件类型, “file\shell”))
    删除注册项 (#根类, 相加 (关联文件类型, “file”))
    返回 (假)
.如果真结束

.如果真 (并且 (等于 (写注册项 (#根类, 相加 (“.”, 关联文件类型, “\”), 相加 (关联文件类型, “file”)), 真), 等于 (写注册项 (#根类, 相加 (关联文件类型, “file\”), 关联文件类型), 真), 等于 (写注册项 (#根类, 相加 (关联文件类型, “file\DefaultIcon\”), 相加 (关联文件图标, “,0”)), 真), 等于 (写注册项 (#根类, 相加 (关联文件类型, “file\shell\open\command\”), 相加 (关联应用程序, “ %1”)), 真)))
    返回 (真)
.如果真结束
返回 (假)


 ' 不属于任何一个程序集、类模块的函数：
