 ' 文件类型：Windows窗口程序

 ' 程序名称：用户配置模块
 ' 程序描述：通用用户配置模块。包含：
1、初始设置
2、用户登录
3、添加用户
4、删除用户
5、修改口令
6、保存信息
7、还原信息
 ' 程序作者：汤海武
 ' 邮政编码：810007
 ' 联系地址：青海省西宁市城东区曹二路53号
 ' 联系电话：0971-7197739
 ' 传真号码：
 ' 电子信箱：thwsoft@qq.com
 ' 主页地址：thwsoft.ik8.com
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 添加用户窗口
    左边 = 50
    顶边 = 50
    宽度 = 324
    高度 = 216
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “添加新用户”
    帮助文件名 = “”

窗口 修改口令窗口
    左边 = 50
    顶边 = 50
    宽度 = 324
    高度 = 242
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\管理机.e\修改口令窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “修改用户口令”
    帮助文件名 = “”

窗口 _启动窗口
    左边 = 50
    顶边 = 50
    宽度 = 328
    高度 = 236
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\管理机.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “通用无纸化考试系统(网络版) 管理机”
    帮助文件名 = “”

窗口 删除用户窗口
    左边 = 50
    顶边 = 50
    宽度 = 324
    高度 = 212
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\管理机.e\删除用户窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “删除用户”
    帮助文件名 = “”

窗口 主窗口
    左边 = 50
    顶边 = 50
    宽度 = 750
    高度 = 550
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\管理机.e\主窗口_底图
    图标 =  ' 已保存到：D:\易语言学习\Data\管理机.e\主窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “通用无纸化考试系统(网络版) 管理机”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 393
    高度 = 285
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\管理机.e\关于窗口_底图
    图标 =  ' 已保存到：D:\易语言学习\Data\管理机.e\关于窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “关于...”
    帮助文件名 = “”

窗口 考试设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 355
    高度 = 315
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\管理机.e\考试设置窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “考试设置”
    帮助文件名 = “”

窗口 端口设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 146
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\管理机.e\端口设置窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “端口设置”
    帮助文件名 = “”

窗口 捕获图像窗口
    左边 = 50
    顶边 = 50
    宽度 = 309
    高度 = 110
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\管理机.e\捕获图像窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “捕获图像”
    帮助文件名 = “”

窗口 照片窗口
    左边 = 50
    顶边 = 50
    宽度 = 306
    高度 = 297
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\管理机.e\照片窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “考生照片”
    帮助文件名 = “”

窗口 广播信息窗口
    左边 = 50
    顶边 = 50
    宽度 = 365
    高度 = 219
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\管理机.e\广播信息窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “系统广播”
    帮助文件名 = “”

窗口 延长时间窗口
    左边 = 50
    顶边 = 50
    宽度 = 264
    高度 = 130
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\管理机.e\延长时间窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “请输入延长时间”
    帮助文件名 = “”

窗口 单延长时间窗口
    左边 = 50
    顶边 = 50
    宽度 = 272
    高度 = 122
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\管理机.e\单延长时间窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “请输入延长时间”
    帮助文件名 = “”

窗口 软件注册窗口
    左边 = 50
    顶边 = 50
    宽度 = 371
    高度 = 173
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\管理机.e\软件注册窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “软件注册”
    帮助文件名 = “”

窗口 接收信息窗口
    左边 = 50
    顶边 = 50
    宽度 = 382
    高度 = 258
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\管理机.e\接收信息窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “接收信息”
    帮助文件名 = “”



.常量 配置文件路径, "0", , 
.常量 配置文件名称, "“system.dat”", , 
.常量 密匙, "“TangHaiwu”", , 
.常量 数据库1, "“考生库”", , 
.常量 密码, "“TANGhaiWu19690425”", , 
.常量 准考证号, "“准考证号”", , 
.常量 考生姓名, "“考生姓名”", , 
.常量 性别, "“性别”", , 
.常量 考生照片, "“考生照片”", , 
.常量 身份证号, "“身份证号”", , 
.常量 考试科目, "“考试科目”", , 
.常量 成绩, "“成绩”", , 
.常量 考场, "“考场”", , 
.常量 机号, "“机号”", , 
.常量 IP地址, "“IP地址”", , 
.常量 端口号, "“端口号”", , 
.常量 考试机号, "“考试机号”", , 
.常量 连接状态, "“连接状态”", , 
.常量 考试状态, "“考试状态”", , 
.常量 考生机地址, "“考生机地址”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 1 0 数据操作支持库一
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库
 ' twain 730FA7B73AAB409a8554F9553CF2DD87 1 5 数码设备支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库




.全局变量 当前用户, 文本型, , , 
.全局变量 用户, 文本型, , "0", 
.全局变量 口令, 文本型, , "0", 
.全局变量 配置文件, 文本型, , , 
.全局变量 考试时间, 整数型, , , 
.全局变量 单选题数, 整数型, , , 
.全局变量 多选题数, 整数型, , , 
.全局变量 判断题数, 整数型, , , 
.全局变量 服务器端口, 整数型, , , 
.全局变量 考生照片, 字节集, , , 
.全局变量 考生库名, 文本型, , , 
.全局变量 客户地址, 文本型, , , 
.全局变量 命令头, 文本型, , , 
.全局变量 接收数据, 文本型, , , 
.全局变量 总长, 整数型, , , 
.全局变量 定位, 整数型, , , 
.全局变量 准考证号, 文本型, , , 
.全局变量 总分, 文本型, , , 
.全局变量 显示成绩, 文本型, , , 
.全局变量 题库名称, 文本型, , , 
.全局变量 考场库名, 文本型, , , 
.全局变量 IP地址0, 文本型, , , 
.全局变量 端口号0, 文本型, , , 
.全局变量 考试机号0, 文本型, , , 
.全局变量 计数1, 整数型, , , 
.全局变量 考场号0, 文本型, , , 
.全局变量 个数, 整数型, , , 
.全局变量 成绩表, 文本型, , , 
.全局变量 注册申请码, 文本型, , , 
.全局变量 是否注册, 逻辑型, , , 
.全局变量 注册码, 文本型, , , 
.全局变量 注册验证码, 文本型, , , 
.全局变量 离开客户地址, 文本型, , , 
.全局变量 运行目录, 文本型, , , 

.窗口程序集 添加用户程序集, , , 

.子程序 _取消按钮_被单击, 空白型, , 
主窗口.置文本 (., 5, “系统等待用户...”)

销毁 ()

.子程序 _确定按钮_被单击, 空白型, , 
.局部变量 变量1, 整数型, , , 

.如果真 (等于 (删首尾空 (.内容), “”))
    信息框 (“用户名不能为空，请输入用户名！”, #信息图标, “错误”)
    获取焦点 ()
    赋值 (.被选择字符数, -1)
    返回 ()
.如果真结束
.计次循环首 (取数组成员数 (用户), 变量1) ' 判断是否已经存在该用户名
    .如果真 (等于 (用户 [变量1], 删首尾空 (.内容)))
        信息框 (相加 (“用户名”, #左引号, .内容, #右引号, “已经存在，请勿重复添加！”), #信息图标, “错误”)
        返回 ()
    .如果真结束
    
.计次循环尾 ()
.如果 (等于 (.内容, .内容))
    .如果真 (等于 (.内容, “”))
        信息框 (“用户口令不能为空，请重新输入用户口令！”, #信息图标, “错误”)
        获取焦点 ()
        赋值 (.被选择字符数, -1)
        返回 ()
    .如果真结束
    加入成员 (用户, 删首尾空 (.内容))
    配置文件_添加用户 (删首尾空 (.内容), 未知支持库函数_2 (到字节集 (.内容)))
    连续赋值 (“”, .内容, .内容, .内容)
    获取焦点 ()
.否则
    信息框 (“密码复核错误，请重新设置密码！”, #错误图标, )
    获取焦点 ()
    返回 ()
.如果结束


.子程序 _添加用户窗口_创建完毕, 空白型, , 
.局部变量 变量1, 整数型, , , 

赋值 (., 真)

.子程序 _确定按钮_获得焦点, 空白型, , 
赋值 (.类型, 1)
赋值 (.类型, 0)

.子程序 _取消按钮_获得焦点, 空白型, , 
赋值 (.类型, 0)
赋值 (.类型, 1)

.子程序 _用户编辑框_获得焦点, 空白型, , 
赋值 (.类型, 1)
赋值 (.类型, 0)
赋值 (.被选择字符数, -1)

.子程序 _口令编辑框_获得焦点, 空白型, , 
赋值 (.类型, 1)
赋值 (.类型, 0)
赋值 (.被选择字符数, -1)

.子程序 _复核口令编辑框_获得焦点, 空白型, , 
赋值 (.类型, 1)
赋值 (.类型, 0)
赋值 (.被选择字符数, -1)

.子程序 _添加用户窗口_将被销毁, 空白型, , 
主窗口.置文本 (., 5, “系统等待用户...”)


.窗口程序集 修改口令程序集, , , 

.程序集变量 原来口令, 文本型, , , 
.子程序 _修改口令窗口_创建完毕, 空白型, , 
赋值 (.内容, 当前用户)
连续赋值 (真, .禁止, .禁止)
赋值 (原来口令, 配置文件_取口令 (当前用户))
赋值 (., 真)

.子程序 _原口令编辑框_内容被改变, 空白型, , 
.如果 (等于 (未知支持库函数_2 (到字节集 (.内容)), 原来口令))
    连续赋值 (假, .禁止, .禁止)
.否则
    连续赋值 (真, .禁止, .禁止)
.如果结束


.子程序 _取消按钮_被单击, 空白型, , 
主窗口.置文本 (., 5, “系统等待用户...”)

销毁 ()

.子程序 _确定按钮_被单击, 空白型, , 
.如果真 (不等于 (未知支持库函数_2 (到字节集 (.内容)), 原来口令))
    信息框 (“原始口令错误，请重新输入。如果你不知道原始口令，你将无权修改。”, #信息图标, “警告”)
    获取焦点 ()
    赋值 (.被选择字符数, -1)
    返回 ()
.如果真结束
.如果 (等于 (.内容, .内容))
    .如果真 (等于 (.内容, “”))
        信息框 (“用户口令不能为空，请重新输入用户新口令！”, #信息图标, “错误”)
        获取焦点 ()
        赋值 (.被选择字符数, -1)
        返回 ()
    .如果真结束
    配置文件_修改口令 (当前用户, 未知支持库函数_2 (到字节集 (.内容)))
    销毁 ()
.否则
    信息框 (“新密码复核错误，请重新设置密码！”, #错误图标, )
    获取焦点 ()
    返回 ()
.如果结束


.子程序 _原口令编辑框_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)
赋值 (.类型, 1)
赋值 (.类型, 0)

.子程序 _新口令编辑框_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)
赋值 (.类型, 1)
赋值 (.类型, 0)

.子程序 _复核口令编辑框_获得焦点, 空白型, , 
赋值 (.被选择字符数, -1)
赋值 (.类型, 1)
赋值 (.类型, 0)

.子程序 _确定按钮_获得焦点, 空白型, , 
赋值 (.类型, 1)
赋值 (.类型, 0)

.子程序 _取消按钮_获得焦点, 空白型, , 
赋值 (.类型, 0)
赋值 (.类型, 1)

.子程序 _修改口令窗口_将被销毁, 空白型, , 
主窗口.置文本 (., 5, “系统等待用户...”)


.窗口程序集 登录程序集, , , 

.程序集变量 错误次数, 字节型, , , 
.程序集变量 保存的口令, 文本型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 变量1, 整数型, , , 
.局部变量 路径, 文本型, , , 

未知支持库函数_0 (#)
.判断开始 (等于 (#配置文件路径, 0))
    赋值 (配置文件, 相加 (取运行目录 (), “\”, #配置文件名称))
.判断 (等于 (#配置文件路径, 1))
    赋值 (配置文件, 相加 (未知支持库函数_7 (9), “\”, #配置文件名称))
.判断 (等于 (#配置文件路径, 2))
    赋值 (配置文件, 相加 (未知支持库函数_7 (10), “\”, #配置文件名称))
.默认
    赋值 (配置文件, #配置文件名称)
.判断结束
赋值 (配置文件, 子文本替换 (配置文件, “\\”, “\”, , , 真))
赋值 (路径, 取文本左边 (配置文件, 相减 (倒找文本 (配置文件, “\”, , 假), 1))) ' 取出保存路径，如果目录不存在，则创建它。
.如果真 (不等于 (路径, “”))
    .如果真 (等于 (创建多级目录 (路径), 假))
        信息框 (“创建配置文件路径失败。”, #错误图标, )
        结束 ()
    .如果真结束
    
.如果真结束
.如果真 (等于 (配置文件_取用户 (), 0)) ' 如果取用户失败，说明是第一次运行，用户信息还未保存至文件，就写出默认用户信息。
     ' 将用户各种信息分割，并保存为文本数组。以写入配置文件。
    赋值 (用户, 分割文本 (“管理员★§☆”, “★§☆”, ))
    赋值 (口令, 分割文本 (“e10adc3949ba59abbe56e057f20f883e★§☆”, “★§☆”, ))
    配置文件_写用户信息 (用户, 口令)
.如果真结束
.计次循环首 (取数组成员数 (用户), 变量1) ' 将所有用户加入用户组合框。
    用户.加入项目 ( [变量1], )
.计次循环尾 ()
赋值 (.现行选中项, 0)
获取焦点 ()
赋值 (错误次数, 0)
取出保存密码信息 ()
赋值 (., 真)

.子程序 _登录按钮_被单击, 空白型, , 
.局部变量 当前密码, 文本型, , , 
.局部变量 输入密码, 文本型, , , 

赋值 (当前密码, 配置文件_取口令 (.取项目文本 (.现行选中项)))
.如果 (并且 (等于 (.内容, “************”), 不等于 (保存的口令, “”)))
    赋值 (输入密码, 保存的口令)
.否则
    赋值 (输入密码, 未知支持库函数_2 (到字节集 (.内容)))
.如果结束
.如果 (等于 (输入密码, 当前密码))
    赋值 (当前用户, .取项目文本 (.现行选中项))
    记录保存密码信息 () ' 记录是否保存密码的设置。
    .如果真 (等于 (是否已创建 (主窗口), 假))
        载入 (主窗口, , 假)
    .如果真结束
    销毁 ()
.否则
    赋值 (错误次数, 相加 (错误次数, 1)) ' 累计口令输入错误次数，达3次，则认为是非法登录，程序强行退出。
    .如果 (小于 (错误次数, 3))
        信息框 (“用户口令不正确，请重新输入！”, #信息图标, “错误”)
        返回 ()
        获取焦点 ()
    .否则
        信息框 (“用户口令不正确，请勿非法登录！”, #警告图标, “错误”)
        销毁 ()
        .如果真 (等于 (是否已创建 (主窗口), 假))
            结束 ()
        .如果真结束
        
    .如果结束
    
.如果结束


.子程序 记录保存密码信息, 空白型, , 
配置文件_写是否保存密码 (当前用户, .选中)

.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()
.如果真 (等于 (是否已创建 (主窗口), 假)) ' 如果不是重登录，则结束程序。否则，返回主窗口。
    结束 ()
.如果真结束


.子程序 _登录按钮_获得焦点, 空白型, , 
赋值 (.类型, 1)
赋值 (.类型, 0)

.子程序 _取消按钮_获得焦点, 空白型, , 
赋值 (.类型, 0)
赋值 (.类型, 1)

.子程序 _用户组合框_获得焦点, 空白型, , 
赋值 (.类型, 1)
赋值 (.类型, 0)

.子程序 _口令编辑框_获得焦点, 空白型, , 
赋值 (.类型, 1)
赋值 (.类型, 0)
赋值 (.被选择字符数, -1)

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
.如果真 (等于 (是否已创建 (主窗口), 假))
    结束 ()
.如果真结束
返回 (真)

.子程序 _用户组合框_列表项被选择, 空白型, , 
赋值 (.内容, “”)
取出保存密码信息 ()

.子程序 取出保存密码信息, 空白型, , 
赋值 (.选中, 配置文件_取是否保存密码 (.取项目文本 (.现行选中项))) ' 如果设置为记住密码，则选中，且口令编辑框中自动填入密码。否则，不选。
.如果 (.选中)
    赋值 (保存的口令, 配置文件_取口令 (.取项目文本 (.现行选中项)))
    赋值 (.内容, “************”)
.否则
    赋值 (.内容, “”)
.如果结束

.窗口程序集 删除用户程序集, , , 

.子程序 _删除用户窗口_创建完毕, 空白型, , 
.局部变量 变量1, 整数型, , , 

.如果 (大于 (取数组成员数 (用户), 1)) ' 保留第一个用户（一般为默认用户）不允许被删除，其余用户均加入到组合框中，供用户选择删除。
    .计次循环首 (取数组成员数 (用户), 变量1)
        .如果真 (大于 (变量1, 1))
            用户.加入项目 ( [变量1], )
        .如果真结束
        
    .计次循环尾 ()
    赋值 (.现行选中项, 0)
    获取焦点 ()
.否则
    信息框 (“没有可以删除的用户！”, #信息图标, “错误”)
    销毁 ()
.如果结束


.子程序 _删除按钮_获得焦点, 空白型, , 
赋值 (.类型, 1)
赋值 (.类型, 0)

.子程序 _取消按钮_获得焦点, 空白型, , 
赋值 (.类型, 0)
赋值 (.类型, 1)

.子程序 _用户组合框_获得焦点, 空白型, , 
赋值 (.类型, 0)
赋值 (.类型, 1)

.子程序 _取消按钮_被单击, 空白型, , 
主窗口.置文本 (., 5, “系统等待用户...”)

销毁 ()

.子程序 _删除按钮_被单击, 空白型, , 
.局部变量 删除用户, 文本型, , , 

赋值 (删除用户, .取项目文本 (.现行选中项))
.如果真 (等于 (信息框 (相加 (“真的要删除用户”, 删除用户, “吗？”), 相加 (#询问图标, #确认取消钮), “删除用户”), #确认钮))
    删除成员 (用户, 相加 (.现行选中项, 2), )
    配置文件_删除用户 (删除用户)
    .删除项目 (.现行选中项)
    赋值 (.现行选中项, 0)
.如果真结束
.如果真 (等于 (删除用户, 当前用户))
    信息框 (“当前登录用户被删除，程序将被关闭。请重新运行本程序并以其他用户身份登录。”, #信息图标, )
    结束 ()
.如果真结束
.如果真 (等于 (取项目数 (), 0))
    销毁 ()
.如果真结束


.子程序 _删除用户窗口_将被销毁, 空白型, , 
主窗口.置文本 (., 5, “系统等待用户...”)


.窗口程序集 主窗口程序集, , , 

.程序集变量 考场字段表, 字段信息, , "8", 
.程序集变量 总长度, 整数型, , , 
.程序集变量 定位置, 整数型, , , 
.程序集变量 计数, 整数型, , , 
.程序集变量 计数4, 整数型, , , 
.程序集变量 是否增加, 逻辑型, , , 
.程序集变量 准考证号0, 文本型, , , 
.程序集变量 考生姓名0, 文本型, , , 
.程序集变量 分数, 整数型, , , 
.程序集变量 秒数, 整数型, , , 
.程序集变量 成绩表, 文本型, , , 
.程序集变量 打开库, 逻辑型, , , 
.程序集变量 及格人数, 整数型, , , 
.程序集变量 打印设置信息, 未知类型0x7000B, , , 
.子程序 _重登录_被选择, 空白型, , 
载入 (_启动窗口, , 真)
主窗口.置文本 (., 1, 当前用户)


.子程序 _添加用户_被选择, 空白型, , 
.局部变量 变量1, 整数型, , , 

5.置文本 (“正在进行添加用户操作...”)

.计次循环首 (取数组成员数 (用户), 变量1) ' 通过循环定位用户所处位置索引，保存在“变量1”中。
    .如果真 (等于 (用户 [变量1], 当前用户))
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
.如果 (不等于 (变量1, 1))
    信息框 (“你不是默认管理员，不能执行此操作，请用默认管理员的身份重新登录！”, #信息图标, )
.否则
    载入 (添加用户窗口, , 真)
    
.如果结束

.子程序 _删除用户_被选择, 空白型, , 
.局部变量 变量1, 整数型, , , 

5.置文本 (“正在进行删除用户操作...”)

.计次循环首 (取数组成员数 (用户), 变量1) ' 通过循环定位用户所处位置索引，保存在“变量1”中。
    .如果真 (等于 (用户 [变量1], 当前用户))
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
.如果 (不等于 (变量1, 1))
    信息框 (“你不是默认管理员，不能执行此操作，请用默认管理员的身份重新登录！”, #信息图标, )
.否则
    载入 (删除用户窗口, , 真)
.如果结束

.子程序 _修改口令_被选择, 空白型, , 
5.置文本 (“正在进行修改口令操作...”)

载入 (修改口令窗口, , 真)

.子程序 _备份用户信息_被选择, 空白型, , 
.局部变量 备份文件名, 文本型, , , 


5.置文本 (“正在进行用户信息备份...”)
赋值 (.标题, “请选择要备份到的文件名：”)
赋值 (.类型, 1)
赋值 (.过滤器, “用户信息备份文件(*.usb)|*.usb|所有文件(*.*)|*.*”) ' 备份文件的扩展名可以为任意支持的文本，请自己修改过滤器。
赋值 (.默认文件后缀, “usb”)
赋值 (.不改变目录, 真)
.如果 (打开 ())
    赋值 (备份文件名, .文件名)
.否则
    返回 ()
.如果结束
.如果真 (并且 (等于 (文件是否存在 (备份文件名), 真), 等于 (删除文件 (备份文件名), 假))) ' 备份文件如果已经存在，则先删除之。如果删除失败，则备份也将失败。
    信息框 (“用户信息备份失败！请检查你设置的备份文件是否可写。”, #信息图标, “错误”)
    返回 ()
.如果真结束
.如果 (复制文件 (配置文件, 备份文件名)) ' 直接复制用户信息文件至指定文件，即完成备份。
    信息框 (“用户信息备份完成！你可以在以后使用其还原用户信息。”, #信息图标, “备份完成”)
    返回 ()
.否则
    信息框 (“用户信息备份失败！请检查你设置的备份文件是否可写。”, #信息图标, “备份失败”)
    返回 ()
.如果结束

.子程序 _还原用户信息_被选择, 空白型, , 
.局部变量 备份文件名, 文本型, , , 

5.置文本 (“正在进行用户信息还原...”)


.如果真 (等于 (信息框 (相加 (“    由于本程序不会对你所指定的用户信息备份文件格式进行校验，如果你指定的用户信息备份文件格式有误，将会导致现有用户信息丢失。”, #换行符, “    强烈建议你在还原用户信息之前，先备份现有用户信息。”, #换行符, “    你确定现在开始从备份文件还原用户信息吗？”), 相加 (#信息图标, #是否钮, #默认按钮二), ), #否钮))
    返回 ()
.如果真结束
赋值 (.标题, “请选择备份的用户信息文件名：”)
赋值 (.类型, 0)
赋值 (.过滤器, “用户信息备份文件(*.usb)|*.usb|所有文件(*.*)|*.*”) ' 备份文件的扩展名可以为任意支持的文本，请自己修改过滤器。但请确保备份时设置的扩展名与还原时设置的扩展名一致。
赋值 (.默认文件后缀, “usb”)
赋值 (.不改变目录, 真)
.如果 (打开 ())
    赋值 (备份文件名, .文件名)
.否则
    返回 ()
.如果结束
.如果 (复制文件 (备份文件名, 配置文件)) ' 将备份文件复制并覆盖现有用户信息文件，完成恢复。
    信息框 (“用户信息还原完成！请重新运行本程序。”, #信息图标, “备份完成”)
    结束 ()
.否则
    信息框 (“用户信息还原失败！请检查你的系统并稍后再试。”, #信息图标, “备份完成”)
    返回 ()
.如果结束

.子程序 _主窗口_创建完毕, 空白型, , 
赋值 (注册码, 到文本 (未知支持库函数_4 (读入文件 (相加 (取当前目录 (), “\regcode.cod”)), #密码, 1)))
赋值 (注册申请码, 取文本右边 (到文本 (位异或 (到数值 (到文本 (取硬盘特征字 ())), 9999999999)), 6))
赋值 (注册验证码, 相加 (到文本 (位与 (到数值 (注册申请码), 222222)), “-”, 到文本 (位与 (到数值 (注册申请码), 666666)), “-”, 到文本 (位与 (到数值 (注册申请码), 444444)), “-”, 到文本 (位与 (到数值 (注册申请码), 333333))))
.如果 (等于 (注册码, 注册验证码))
    赋值 (是否注册, 真)
.否则
    赋值 (是否注册, 假)
.如果结束


赋值 (服务器端口, 到数值 (读配置项 (相加 (取当前目录 (), “\”, “syspz.ini”), “system”, “port”, “19730”)))
赋值 (.端口, 服务器端口)





 ' 选择夹1.现行子夹 ＝ 2

“操作员”.加入栏目 (40, , , #凹入)
“当前操作员”.加入栏目 (60, , , #凹入)
“系统日期”.加入栏目 (40, , #凹入, )
“当前系统日期”.加入栏目 (90, , , #凹入)
“当前考生库”.加入栏目 (75, , #凹入, )
“当前考生库”.加入栏目 (200, , #凹入, )
“系统状态”.加入栏目 (65, , #凹入, )
“系统状态”.加入栏目 (200, , #凹入, )


0.置文本 (“用户：”)
1.置文本 (当前用户)
2.置文本 (“日期：”)
3.置文本 (到文本 (取日期 (取现行时间 ())))
4.置文本 (“当前考生库：”)
5.置文本 (考生库名)
6.置文本 (“系统状态：”)
7.置文本 (“系统等待用户...”)

 ' 考场字段表数组
赋值 (考场字段表 [1].名称, #IP地址)
赋值 (考场字段表 [1].最大文本长度, 16)
赋值 (考场字段表 [2].名称, #端口号)
赋值 (考场字段表 [2].最大文本长度, 6)
赋值 (考场字段表 [3].名称, #考试机号)
赋值 (考场字段表 [3].类型, #整数型)
赋值 (考场字段表 [4].名称, #连接状态)
赋值 (考场字段表 [5].名称, #考试状态)
赋值 (考场字段表 [6].名称, #准考证号)
赋值 (考场字段表 [7].名称, #考生姓名)
赋值 (考场字段表 [8].名称, #考生机地址)
赋值 (考场字段表 [8].最大文本长度, 24)
连续赋值 (#文本型, 考场字段表 [1].类型, 考场字段表 [2].类型, 考场字段表 [4].类型, 考场字段表 [5].类型, 考场字段表 [6].类型, 考场字段表 [7].类型, 考场字段表 [8].类型)
连续赋值 (8, 考场字段表 [4].最大文本长度, 考场字段表 [5].最大文本长度)
连续赋值 (20, 考场字段表 [6].最大文本长度, 考场字段表 [7].最大文本长度)
赋值 (运行目录, 取当前目录 ())

赋值 (考场库名, 相加 (取当前目录 (), “\考场信息.edb”))
.如果真 (等于 (创建 (考场库名, 考场字段表), 假))
    信息框 (“创建考场信息库失败！”, 相加 (0, 48), “创建失败”)
.如果真结束


.如果真 (等于 (打开 (考场库名, , , , , , ), 假))
    信息框 (“打开考场信息库失败！”, 相加 (0, 48), “打开失败”)
.如果真结束

置数据库密码 (#密码)
赋值 (.数据库文件名, 考场库名)
赋值 (.数据库密码, #密码)
赋值 (.数据提供者, “数据库提供者2”)
赋值 (.数据源, “数据源2”)
到首记录 ()




.子程序 _关于_被选择, 空白型, , 
7.置文本 (“正在打开关于...”)
载入 (关于窗口, , 真)


.子程序 _端口设置_被选择, 空白型, , 
7.置文本 (“正在进行端口设置...”)

载入 (端口设置窗口, , 真)


.子程序 _考试设置_被选择, 空白型, , 
7.置文本 (“正在进行考试设置...”)
载入 (考试设置窗口, , 真)


.子程序 _打开考生信息库_被选择, 空白型, , 
.如果真 (不等于 (取文本长度 (考生库名), 0))
    信息框 (“已有考生信息库打开，请先关闭后再打开！”, 相加 (0, 64), “系统提示”)
     ' 关闭考生信息库.禁止 ＝ 假
    返回 ()
    
.如果真结束



赋值 (.类型, 0)
赋值 (.标题, “请选择要打开的考生信息库”)
赋值 (.过滤器, “考生库文件*.edb|*.edb|所有文件*.*|*.*”)
赋值 (.初始目录, 取当前目录 ())
.如果 (等于 (打开 (), 假))
    信息框 (“打开考生信息库失败！”, 相加 (0, 48), “打开失败”)
    赋值 (考生库名, “”)
    返回 ()
.否则
    赋值 (考生库名, .文件名)
    赋值 (成绩表, 相加 (取当前目录 (), “\成绩表.grd”))
    
    .如果 (等于 (打开 (考生库名, , , , , #密码, ), 假))
        信息框 (“打开考生信息库失败！”, 相加 (0, 48), “打开失败”)
        赋值 (“”)
        返回 ()
    .否则
        置当前库 (考生库名)
        .如果 (等于 (取记录数 (), 0))
            信息框 (“考生信息库中无数据！”, 相加 (0, 48), “打开失败”)
            赋值 (“”)
            返回 ()
        .否则
            赋值 (.数据库文件名, 考生库名)
            赋值 (.数据库密码, #密码)
            赋值 (.数据提供者, “数据库提供者1”)
             ' 选择夹1.现行子夹 ＝ 1
            赋值 (.数据源, “数据源1”)
            到首记录 ()
            赋值 (.标题, 相加 (“当前 ”, 到文本 (取记录号 ()), “/共有 ”, 到文本 (取记录数 ())))
            5.置文本 (考生库名)
            赋值 (.禁止, 假)
            赋值 (.禁止, 假)
            赋值 (.禁止, 假)
            赋值 (.禁止, 假)
            赋值 (.可视, 真)
            赋值 (.禁止, 真)
            赋值 (.禁止, 假)
            赋值 (.禁止, 假)
            赋值 (.禁止, 假)
            赋值 (.禁止, 假)
            赋值 (.禁止, 假)
            赋值 (.标题, 相加 (“考生信息库：”, 考生库名))
            赋值 (.标题, 相加 (“共有考生：”, 到文本 (取记录数 ()), “ 人”))
            赋值 (.数据源, “报表数据源”)
            赋值 (.数据提供者, “通用提供者1”)
            信息框 (相加 (“考生信息库：”, 考生库名, “ 已成功打开！”), 相加 (0, 64), “打开成功”)
            .如果真 (等于 (成绩表.从文件读 (), 假))
                信息框 (“要打印的成绩报表模板损坏或不存在！”, 相加 (0, 32), “打开失败”)
                返回 ()
            .如果真结束
            
            
        .如果结束
        
    .如果结束
    
.如果结束



.子程序 _关闭考生信息库_被选择, 空白型, , 
赋值 (.数据库文件名, “”)
赋值 (.数据提供者, “”)
赋值 (.标题, “当前   /共有 ”)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.可视, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 真)
关闭 (考生库名)
赋值 (考生库名, “”)
5.置文本 (考生库名)


.子程序 _允许修改按钮_被单击, 空白型, , 
赋值 (.只读, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.可视, 真)
赋值 (.可视, 真)

.子程序 _保存修改按钮_被单击, 空白型, , 
赋值 (.只读, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.可视, 假)
赋值 (.可视, 假)


.子程序 _表格1_光标位置改变, 空白型, , 
赋值 (.标题, 相加 (“当前 ”, 到文本 (取光标行号 ()), “/共有 ”, 到文本 (取记录数 ())))
取光标行号 ().跳到 ()


.子程序 _添加按钮_被单击, 空白型, , 
.添加行 ()


.子程序 _删除按钮_被单击, 空白型, , 

取光标行号 ().删除行 (1)


.子程序 _表格1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()


.子程序 _从文件导入_被选择, 空白型, , 

赋值 (.过滤器, “所有文件*.*|*.*|bmp文件 *.bmp|*.bmp|jpg文件*.jpg|*.jpg|gif文件*.gif|*.gif”)
赋值 (.类型, 0)
赋值 (.初始目录, 取当前目录 ())

.如果真 (打开 ())
    取光标行号 ().置数据 (取光标列号 (), 读入文件 (.文件名))
    
.如果真结束


.子程序 _从数码设备获取_被选择, 空白型, , 
载入 (捕获图像窗口, , 真)


.子程序 _查看考生照片_被选择, 空白型, , 
跳到 (取光标行号 ())
赋值 (考生照片, 读 (#考生照片))
载入 (照片窗口, , 真)


.子程序 _广播信息_被选择, 空白型, , 
主窗口.置文本 (., 7, “正在向考生机广播信息...”)
载入 (广播信息窗口, , 真)


.子程序 _服务器1_客户进入, 空白型, , 
赋值 (是否增加, 真)
赋值 (客户地址, 取回客户 ())
赋值 (总长度, 取文本长度 (客户地址))
赋值 (定位置, 寻找文本 (客户地址, “:”, 1, 假))
赋值 (IP地址0, 取文本左边 (客户地址, 相减 (定位置, 1)))
赋值 (端口号0, 取文本右边 (客户地址, 相减 (总长度, 定位置)))

.如果真 (并且 (大于 (取行数 (), 4), 等于 (是否注册, 假)))
    信息框 (相加 (“您是未注册用户，连接的考生机数不能 5 台！”, #换行符, “请您注册后继续使用！”), 相加 (0, 64), “系统提示”)
    返回 ()
    
.如果真结束


.计次循环首 (取行数 (), 计数)
    .如果真 (等于 (计数.取文本 (1), IP地址0)) ' 防止同一IP地址以多个端口号多连接
        计数.置文本 (2, 端口号0)
        计数.置文本 (8, 客户地址)
        赋值 (是否增加, 假)
    .如果真结束
    
.计次循环尾 ()
.如果真 (等于 (是否增加, 真))
    .添加行 ()
    取行数 ().置文本 (1, IP地址0)
    取行数 ().置文本 (2, 端口号0)
    取行数 ().置文本 (8, 客户地址)
    
.如果真结束

赋值 (.内容, 相加 (“当前：”, 到文本 (取光标行号 ()), “/共有：”, 到文本 (取行数 ())))

刷新显示 ()



.子程序 _单发送确认按钮_被单击, 空白型, , 
 ' 跳到 (数据源1.取记录号 ())
 ' 数据源1.跳到 (表格1.取光标行号 ())
赋值 (考场号0, 取光标行号 ().取文本 (8))
赋值 (考试机号0, 删尾空 (取光标行号 ().取文本 (9)))

.计次循环首 (取行数 (), 计数)
    .如果真 (等于 (删尾空 (计数.取文本 (3)), 考试机号0))
        赋值 (客户地址, 计数.取文本 (8))
        跳到 (取记录号 ())
        
        .如果真 (等于 (客户地址.发送数据 (到字节集 (相加 (“确认信息]”, 读 (#准考证号), “|”, 读 (#考生姓名), “|”, 读 (#性别), “|”, 读 (#身份证号), “|”, 读 (#考试科目), “|”, 到文本 (读 (#机号)))), 15), 真))
             ' 服务器1.发送数据 (客户地址, 读 (#考生照片), )
            客户地址.发送数据 (取光标行号 ().取数据 (4), )
            
        .如果真结束
        
    .如果真结束
    
.计次循环尾 ()





.子程序 _单发送照片按钮_被单击, 空白型, , 
取光标行号 ().跳到 ()
赋值 (考场号0, 取光标行号 ().取文本 (8))
赋值 (考试机号0, 取光标行号 ().取文本 (9))

.计次循环首 (取行数 (), 计数)
    .如果真 (等于 (计数.取文本 (3), 考试机号0))
        赋值 (客户地址, 计数.取文本 (8))
         ' 服务器1.发送数据 (客户地址, 读 (#考生照片), )
        客户地址.发送数据 (取光标行号 ().取数据 (4), )
    .如果真结束
    
.计次循环尾 ()



.子程序 _向前按钮_被单击, 空白型, , 
-1.跳过 ()
.如果真 (等于 (首记录前 (), 真))
    到首记录 ()
    
.如果真结束

赋值 (.标题, 相加 (“当前 ”, 到文本 (取记录号 ()), “/共有 ”, 到文本 (取记录数 ())))


.子程序 _向后按钮_被单击, 空白型, , 
.跳过 ()
.如果真 (等于 (尾记录后 (), 真))
    到尾记录 ()
.如果真结束


赋值 (.标题, 相加 (“当前 ”, 到文本 (取记录号 ()), “/共有 ”, 到文本 (取记录数 ())))


.子程序 _清理考场_被选择, 空白型, , 
赋值 (.禁止, 假)
_清理考场按钮_被单击 ()


.子程序 _开始发题按钮_被单击, 空白型, , 
7.置文本 (“开始向考生机发放组卷信息...”)

赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (计数, 0)
.计次循环首 (取行数 (), 计数)
    赋值 (客户地址, 计数.取文本 (8))
    客户地址.发送数据 (相加 (“开始发卷]”, 到文本 (考试时间), “|”, 到文本 (单选题数), “|”, 到文本 (多选题数), “|”, 到文本 (判断题数), “|”, 显示成绩, “|”, 题库名称), )
.计次循环尾 ()
信息框 (相加 (到文本 (相减 (计数, 1)), “ 台考生机发卷成功！”), 相加 (0, 64), “发卷成功”)
赋值 (计数, 0)





.子程序 _服务器1_数据到达, 空白型, , 
 ' 选择夹1.现行子夹 ＝ 0

赋值 (接收数据, 到文本 (取回数据 ()))
赋值 (总长, 取文本长度 (接收数据))
赋值 (定位, 寻找文本 (接收数据, “]”, 1, 假))
赋值 (命令头, 到文本 (取文本左边 (接收数据, 相减 (定位, 1))))
赋值 (接收数据, 取文本右边 (接收数据, 相减 (总长, 定位)))

.判断开始 (等于 (命令头, “交卷”))
    赋值 (总长, 取文本长度 (接收数据))
    赋值 (定位, 寻找文本 (接收数据, “|”, 1, 假))
    赋值 (考试机号0, 取文本左边 (接收数据, 相减 (定位, 1)))
    赋值 (接收数据, 取文本右边 (接收数据, 相减 (总长, 定位)))
    
    赋值 (总长, 取文本长度 (接收数据))
    赋值 (定位, 寻找文本 (接收数据, “|”, 1, 假))
    赋值 (准考证号0, 取文本左边 (接收数据, 相减 (定位, 1)))
    赋值 (接收数据, 取文本右边 (接收数据, 相减 (总长, 定位)))
    赋值 (总长, 取文本长度 (接收数据))
    赋值 (定位, 寻找文本 (接收数据, “|”, 1, 假))
    赋值 (总分, 取文本左边 (接收数据, 相减 (定位, 1)))
    赋值 (接收数据, 取文本右边 (接收数据, 相减 (总长, 定位)))
    赋值 (IP地址0, 接收数据)
    
     ' 编辑框01.内容 ＝ 考试机号0 ＋ “|” ＋ 准考证号0 ＋ “|” ＋ 总分 ＋ “|” ＋ IP地址0
    
    .计次循环首 (取行数 (), 计数)
        .如果真 (等于 (计数.取文本 (1), 准考证号0))
            计数.置文本 (7, 总分)
            
        .如果真结束
        
    .计次循环尾 ()
    
    .计次循环首 (取行数 (), 计数)
        .如果真 (等于 (计数.取文本 (1), IP地址0))
            计数.置文本 (5, “成功交卷”)
            计数.置文本 (6, “”)
            计数.置文本 (7, “”)
            
            
        .如果真结束
        
    .计次循环尾 ()
    
    
.判断 (等于 (命令头, “确认”))
    赋值 (总长, 取文本长度 (接收数据))
    赋值 (定位, 寻找文本 (接收数据, “|”, 1, 假))
    赋值 (IP地址0, 取文本左边 (接收数据, 相减 (定位, 1)))
    赋值 (接收数据, 取文本右边 (接收数据, 相减 (总长, 定位)))
    
    赋值 (总长, 取文本长度 (接收数据))
    赋值 (定位, 寻找文本 (接收数据, “|”, 1, 假))
    赋值 (准考证号0, 取文本左边 (接收数据, 相减 (定位, 1)))
    赋值 (接收数据, 取文本右边 (接收数据, 相减 (总长, 定位)))
    赋值 (考生姓名0, 接收数据)
     ' 临时编辑框.内容 ＝ IP地址0 ＋ “|” ＋ 准考证号0 ＋ “|” ＋ 考生姓名0
    
    .计次循环首 (取行数 (), 计数)
        .如果真 (等于 (计数.取文本 (1), IP地址0))
            计数.置文本 (5, “开始答题”)
            计数.置文本 (6, 准考证号0)
            计数.置文本 (7, 考生姓名0)
            
        .如果真结束
        
    .计次循环尾 ()
    刷新显示 ()
    
    
.判断 (等于 (命令头, “连接”))
    赋值 (总长, 取文本长度 (接收数据))
    赋值 (定位, 寻找文本 (接收数据, “|”, 1, 假))
    赋值 (考试机号0, 取文本左边 (接收数据, 相减 (定位, 1)))
    赋值 (接收数据, 取文本右边 (接收数据, 相减 (总长, 定位)))
    赋值 (IP地址0, 接收数据)
    .计次循环首 (取行数 (), 计数)
        .如果真 (等于 (计数.取文本 (1), IP地址0))
            计数.置文本 (3, 考试机号0)
            计数.置文本 (4, “在线”)
            
        .如果真结束
        
    .计次循环尾 ()
    刷新显示 ()
    
.判断 (等于 (命令头, “退出”))
    赋值 (IP地址0, 接收数据)
    .计次循环首 (取行数 (), 计数)
        .如果真 (等于 (计数.取文本 (1), IP地址0))
            计数.置文本 (4, “退出”)
        .如果真结束
        
    .计次循环尾 ()
    刷新显示 ()
    
.判断 (等于 (命令头, “信息”))
    赋值 (总长, 取文本长度 (接收数据))
    赋值 (定位, 寻找文本 (接收数据, “|”, 1, 假))
    赋值 (IP地址0, 取文本左边 (接收数据, 相减 (定位, 1)))
    赋值 (接收数据, 取文本右边 (接收数据, 相减 (总长, 定位)))
    赋值 (.内容, 相加 (.内容, #换行符, IP地址0, “发来信息：”, #换行符, 接收数据, #换行符))
    
    
.默认
    
.判断结束


.子程序 _开始考试按钮_被单击, 空白型, , 
7.置文本 (“开始考试...”)

赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
.计次循环首 (取行数 (), 计数)
    赋值 (客户地址, 计数.取文本 (8))
    客户地址.发送数据 (“开始考试]”, )
.计次循环尾 ()

赋值 (.内容, 相加 (到文本 (取时间部分 (取现行时间 (), 6)), “时”, 到文本 (取时间部分 (取现行时间 (), 7)), “分”, 到文本 (取时间部分 (取现行时间 (), 8)), “秒”))
赋值 (考试时间, 相减 (考试时间, 1))
赋值 (.时钟周期, 1000)
信息框 (相加 (到文本 (相减 (计数, 1)), “ 台考生机开始考试！”), 相加 (0, 64), “开始成功”)





.子程序 _结束考试按钮_被单击, 空白型, , 
7.置文本 (“正在结束考试...”)

赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 假)
赋值 (.禁止, 假)

赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)

.计次循环首 (取行数 (), 计数)
    赋值 (客户地址, 计数.取文本 (8))
    客户地址.发送数据 (“结束考试]”, )
    
.计次循环尾 ()
赋值 (.时钟周期, 0)

信息框 (相加 (到文本 (相减 (计数, 1)), “ 台考生机结束考试！”), 相加 (0, 64), “结束成功”)







.子程序 _关闭考试机按钮_被单击, 空白型, , 
赋值 (.禁止, 真)
赋值 (.禁止, 真)


.计次循环首 (取行数 (), 计数)
    赋值 (客户地址, 计数.取文本 (8))
    客户地址.发送数据 (“关考试机]”, )
    
.计次循环尾 ()
信息框 (相加 (到文本 (相减 (计数, 1)), “ 台考生机已被关闭！”), 相加 (0, 64), “关闭成功”)




.子程序 _延长时间按钮_被单击, 空白型, , 
7.置文本 (“正在延长考试时间...”)
载入 (延长时间窗口, , 真)



.子程序 _缩放显示组合框_列表项被选择, 空白型, , 
赋值 (.缩放比, .取项目数值 (.现行选中项))



.子程序 _选择夹1_子夹被改变, 空白型, , 
.判断开始 (等于 (.现行子夹, 2))
    7.置文本 (“正在进行考场监控...”)
    到首记录 ()
    刷新显示 ()
    赋值 (.内容, 相加 (“当前：”, 到文本 (取记录号 ()), “/共有：”, 到文本 (取行数 ())))
    
.判断 (等于 (.现行子夹, 1))
    7.置文本 (“正在进行考生信息操作...”)
    
    到首记录 ()
    刷新显示 ()
    
    
.判断 (等于 (.现行子夹, 3))
    7.置文本 (“正在打印考生成绩报表...”)
    赋值 (.内容, 到文本 (取日期 (取现行时间 ())))
    
    
    
.判断 (等于 (.现行子夹, 0))
    7.置文本 (“正在打开操作向导...”)
    
    
    
    
.判断 (等于 (.现行子夹, 4))
    7.置文本 (“正在查看收到的信息...”)
    
    
.默认
    
    
.判断结束


.子程序 _缩放显示组合框2_列表项被选择, 空白型, , 
赋值 (.缩放比, .取项目数值 (.现行选中项))

.子程序 _清理考场按钮_被单击, 空白型, , 
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)


赋值 (考场号0, “”)
赋值 (考试时间, 0)
赋值 (.内容, “”)
赋值 (.内容, “”)
.计次循环首 (取行数 (), 计数)
    赋值 (客户地址, 计数.取文本 (8))
    客户地址.发送数据 (“清理考场]”, )
.计次循环尾 ()
信息框 (相加 (到文本 (相减 (计数, 1)), “ 台考生机已被清理完备！”), 相加 (0, 64), “清理完备”)
赋值 (计数, 0)

.子程序 _考试设置按钮_被单击, 空白型, , 
7.置文本 (“正在进行考试设置...”)
 ' 考试设置按钮.禁止 ＝ 真
.如果 (等于 (取文本长度 (考生库名), 0))
    赋值 (.禁止, 假)
    
.否则
    赋值 (.禁止, 假)
    
     ' 开始发卷.禁止 ＝ 假
     ' 开始发题按钮.禁止 ＝ 假
.如果结束



载入 (考试设置窗口, , 真)



.子程序 _打开考生库按钮_被单击, 空白型, , 
7.置文本 (“正在打开考生信息库...”)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
_打开考生信息库_被选择 ()


.子程序 _单开始发题按钮_被单击, 空白型, , 
赋值 (客户地址, 取光标行号 ().取文本 (8))
客户地址.发送数据 (相加 (“开始发卷]”, 到文本 (考试时间), “|”, 到文本 (单选题数), “|”, 到文本 (多选题数), “|”, 到文本 (判断题数), “|”, 显示成绩, “|”, 题库名称), )


.子程序 _单结束考试按钮_被单击, 空白型, , 
赋值 (客户地址, 取光标行号 ().取文本 (8))
客户地址.发送数据 (“结束考试]”, )



.子程序 _单退出考试机程序按钮_被单击, 空白型, , 
赋值 (客户地址, 取光标行号 ().取文本 (8))
客户地址.发送数据 (“退出考试]”, )


.子程序 _单关闭考试机按钮_被单击, 空白型, , 
赋值 (客户地址, 取光标行号 ().取文本 (8))
客户地址.发送数据 (“关考试机]”, )


.子程序 _单锁定键鼠按钮_被单击, 空白型, , 
 ' 客户地址 ＝ 数据源2.取文本 (表格2.取光标行号 (), 8)
 ' 服务器1.发送数据 (客户地址, “锁定键鼠]”, )


.子程序 _单释放键鼠按钮_被单击, 空白型, , 
 ' 客户地址 ＝ 数据源2.取文本 (表格2.取光标行号 (), 8)
 ' 服务器1.发送数据 (客户地址, “释放键鼠]”, )


.子程序 _单延长时间按钮_被单击, 空白型, , 
载入 (单延长时间窗口, , 真)


.子程序 _发送考生信息按钮_被单击, 空白型, , 
7.置文本 (“正在向考生机发送考生确认信息...”)
赋值 (个数, 0)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
.计次循环首 (取行数 (), 计数)
    .如果真 (等于 (删尾空 (计数.取文本 (8)), 考场号0))
        赋值 (考试机号0, 删尾空 (计数.取文本 (9)))
        
        .计次循环首 (取行数 (), 计数1)
            .如果真 (等于 (删尾空 (计数1.取文本 (3)), 考试机号0))
                赋值 (客户地址, 计数1.取文本 (8))
                跳到 (计数)
                .如果真 (等于 (客户地址.发送数据 (到字节集 (相加 (“确认信息]”, 读 (#准考证号), “|”, 读 (#考生姓名), “|”, 读 (#性别), “|”, 读 (#身份证号), “|”, 读 (#考试科目), “|”, 到文本 (读 (#机号)))), ), 真))
                    客户地址.发送数据 (读 (#考生照片), )
                     ' 服务器1.发送数据 (客户地址, 数据源1.取数据 (计数, 4), )
                    赋值 (个数, 相加 (个数, 1))
                .如果真结束
                
            .如果真结束
            
        .计次循环尾 ()
        
    .如果真结束
    
.计次循环尾 ()
信息框 (相加 (到文本 (个数), “ 位考生信息已成功发出！”), 相加 (0, 64), “发送成功”)





.子程序 _单开始考试按钮_被单击, 空白型, , 
赋值 (客户地址, 取光标行号 ().取文本 (8))
客户地址.发送数据 (“开始考试]”, )



.子程序 _时钟1_周期事件, 空白型, , 

赋值 (秒数, 相加 (秒数, 1))
.如果 (等于 (秒数, 60))
    赋值 (秒数, 0)
    赋值 (分数, 相加 (分数, 1))
    赋值 (.内容, 相加 (到文本 (相减 (考试时间, 分数)), “ 分”, 到文本 (相减 (60, 秒数)), “ 秒”))
    
.否则
    赋值 (.内容, 相加 (到文本 (相减 (考试时间, 分数)), “ 分”, 到文本 (相减 (60, 秒数)), “ 秒”))
    .判断开始 (并且 (等于 (相减 (考试时间, 分数), 5), 等于 (秒数, 59)))
        信息框 (“提醒考生离考试结束还有 5 分钟，请检查后准备交卷！”, 相加 (0, 64), “系统提醒”)
        
    .判断 (并且 (等于 (相减 (考试时间, 分数), 0), 等于 (秒数, 59)))
        赋值 (.时钟周期, 0)
        信息框 (相加 (“考试结束时间已到！ 请您执行结束考试操作！”, #换行符, “通知学生离开考场！！”), 相加 (0, 64), “系统提醒”)
        
        
    .默认
        
    .判断结束
    
.如果结束







.子程序 生成成绩报表, 空白型, , 
.参数 行号, 整数型, , 
.参数 开始行号, 整数型, , 
.参数 行数, 整数型, , 

.如果真 (等于 (成绩表.从文件读 (), 假))
    信息框 (“打开成绩报表模板失败!”, 相加 (0, 48), “打开失败”)
    返回 ()
.如果真结束

到首记录 ()
保存更改 ()
连续赋值 (相加 (取行数 (), 1), 开始行号, 行号)
到首记录 ()
1.置文本 (2, 相加 (“编号”, .内容))
2.置文本 (2, .内容)
3.置文本 (2, 相加 (“科目：”, 读 (#考试科目), “    ”, .内容, “    打印日期：”, .内容))

.判断循环首 (等于 (尾记录后 (), 假)) ' 遍历所有记录以将其加入到报表中
    .添加行 ()
    行号.置文本 (2, 到文本 (取记录号 ()))
    行号.置文本 (3, 读 (#准考证号))
    行号.置文本 (4, 读 (#考生姓名))
    行号.置文本 (5, 读 (#性别))
    行号.置文本 (6, 读 (#身份证号))
    行号.置文本 (7, 读 (#成绩))
    赋值 (行号, 相加 (行号, 1))
    跳过 ()
.判断循环尾 ()
.添加行 ()
行号.合并 (2, 1, 6)
行号.置文本 (2, 相加 (“考试人数：”, 到文本 (取记录数 ()), “     及格人数：”, 到文本 (及格人数), “     ”, .内容))
赋值 (行数, 相减 (行号, 开始行号))
开始行号.加线条 (2, 行数, 6, 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线)) ' 在所有表格单元周围添加线条
开始行号.置对齐方式 (2, 行数, 6, #中中)
赋值 (行号, 相加 (行号, 1))
行号.置对齐方式 (2, 1, 1, #中左)

.子程序 _预览按钮_被单击, 空白型, , 
到首记录 () ' 计算及格人数
.判断循环首 (等于 (尾记录后 (), 假))
    .如果真 (大于或等于 (到数值 (读 (#成绩)), 60))
        赋值 (及格人数, 相加 (及格人数, 1))
    .如果真结束
    跳过 ()
.判断循环尾 ()
到首记录 ()
生成成绩报表 (5, 5, 0)
打印预览 ()


.子程序 _打印按钮_被单击, 空白型, , 
生成成绩报表 (5, 5, 0)
.打印 (“打印考生成绩报表”)


.子程序 _关闭按钮_被单击, 空白型, , 
赋值 (.可视, 假)


.子程序 _打印成绩报表按钮_被单击, 空白型, , 

.如果 (等于 (取文本长度 (考生库名), 0))
    信息框 (“您还没有打开考生信息库文件！”, 相加 (0, 48), “操作失败”)
    返回 ()
    
.否则
    7.置文本 (“正在进行打印考生成绩报表...”)
    赋值 (.现行子夹, 3)
    
.如果结束







.子程序 _退出考生机程序_被选择, 空白型, , 

.计次循环首 (取行数 (), 计数)
    赋值 (客户地址, 计数.取文本 (8))
    客户地址.发送数据 (“退出考试]”, )
.计次循环尾 ()
信息框 (相加 (到文本 (相减 (计数, 1)), “ 台考生机程序已被退出！”), 相加 (0, 64), “退出成功”)





.子程序 _开始发卷_被选择, 空白型, , 
_开始发题按钮_被单击 ()
赋值 (.禁止, 假)



.子程序 _发送考生信息_被选择, 空白型, , 
赋值 (.禁止, 假)

_发送考生信息按钮_被单击 ()


.子程序 _开始考试_被选择, 空白型, , 
赋值 (.禁止, 假)
赋值 (.禁止, 假)
_开始考试按钮_被单击 ()


.子程序 _延长考试时间_被选择, 空白型, , 
主窗口.置文本 (., 7, “正在延长考试时间...”)

_延长时间按钮_被单击 ()


.子程序 _结束考试_被选择, 空白型, , 
赋值 (.禁止, 假)
_结束考试按钮_被单击 ()


.子程序 _退出_被选择, 空白型, , 
.如果 (等于 (取文本长度 (考生库名), 0))
    销毁 ()
    
.否则
    关闭 (考生库名)
    销毁 ()
    
.如果结束


.子程序 _取消考生机屏幕保护_被选择, 空白型, , 

.计次循环首 (取行数 (), 计数)
    赋值 (客户地址, 计数.取文本 (8))
    客户地址.发送数据 (“取消屏保]”, )
.计次循环尾 ()
信息框 (相加 (到文本 (相减 (计数, 1)), “ 台考生机成功取消屏幕保护！”), 相加 (0, 64), “取消屏保成功”)


.子程序 _开始考生机屏保_被选择, 空白型, , 

.计次循环首 (取行数 (), 计数)
    赋值 (客户地址, 计数.取文本 (8))
    客户地址.发送数据 (“开始屏保]”, )
.计次循环尾 ()
信息框 (相加 (到文本 (相减 (计数, 1)), “ 台考生机成功开始屏幕保护！”), 相加 (0, 64), “打开屏保成功”)



.子程序 _关闭考生计算机_被选择, 空白型, , 
_关闭考试机按钮_被单击 ()


.子程序 _发送信息按钮_被单击, 空白型, , 
赋值 (客户地址, 取光标行号 ().取文本 (8))
客户地址.发送数据 (相加 (“系统广播]”, .内容), )
赋值 (.内容, “”)
信息框 (“向考生机发送信息成功！”, 相加 (0, 64), “发送成功”)
获取焦点 ()


.子程序 _软件注册_被选择, 空白型, , 
7.置文本 (“正在进行软件注册...”)
载入 (软件注册窗口, , 真)


.子程序 _服务器1_客户离开, 空白型, , 
赋值 (离开客户地址, 取回客户 ())
.计次循环首 (取行数 (), 计数4)
    .如果真 (等于 (计数4.取文本 (8), 离开客户地址))
        计数4.置文本 (4, “离开”)
         ' 数据源2.置文本 (计数4, 5, “”)
        
    .如果真结束
    
.计次循环尾 ()

.子程序 _表格2_光标位置改变, 空白型, , 
赋值 (.内容, 相加 (“当前：”, 到文本 (取光标行号 ()), “/共有：”, 到文本 (取行数 ())))


.子程序 _返回按钮_被单击, 空白型, , 
7.置文本 (“系统等待用户...”)

赋值 (.可视, 假)


.子程序 _清空按钮_被单击, 空白型, , 
赋值 (.内容, “”)


.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.判断开始 (等于 (按钮索引, 0))
    7.置文本 (“正在进行操作向导...”)
    
    赋值 (.可视, 真)
    赋值 (.现行子夹, 0)
    
.判断 (等于 (按钮索引, 1))
    7.置文本 (“正在查看考生信息...”)
    赋值 (.可视, 真)
    赋值 (.现行子夹, 1)
    
    
.判断 (等于 (按钮索引, 2))
    7.置文本 (“正在进行考场监控...”)
    赋值 (.可视, 真)
    赋值 (.现行子夹, 2)
    
    
    
.判断 (等于 (按钮索引, 3))
    .如果 (等于 (取文本长度 (考生库名), 0))
        信息框 (“您还没有打开考生信息库文件！”, 相加 (0, 48), “操作失败”)
        返回 ()
        
    .否则
        7.置文本 (“正在进行打印考生成绩报表...”)
        赋值 (.可视, 真)
        赋值 (.现行子夹, 3)
        
    .如果结束
    
    
    
.判断 (等于 (按钮索引, 4))
    7.置文本 (“正在查看收到的信息...”)
    赋值 (.可视, 真)
    赋值 (.现行子夹, 4)
    
    
    
.判断 (等于 (按钮索引, 5))
    7.置文本 (“已刷新屏幕...”)
    赋值 (.可视, 假)
    
    
.判断 (等于 (按钮索引, 6))
    7.置文本 (“正在打开关于...”)
    _关于_被选择 ()
    
    
.默认
    
.判断结束


.子程序 _帮助_被选择, 空白型, , 
7.置文本 (“正在系统帮助...”)
运行 (相加 (“hh.exe ”, 运行目录, “\帮助.CHM”), 假, )



.子程序 _使用教程_被选择, 空白型, , 
7.置文本 (“正在打开使用教程...”)
运行 (相加 (运行目录, “\使用教程.exe”), 假, )


.子程序 _关闭考试计算机_被选择, 空白型, , 
_关闭考试机按钮_被单击 ()


.程序集 配置文件操作程序集, , , 

.子程序 读加密配置项, 文本型, , 读取失败，返回空文本
.参数 配置文件名, 文本型, , 省略路径,默认为保存在windows系统目录下
.参数 文件密码, 文本型, 可空, 
.参数 配置节名, 文本型, , 
.参数 配置项名, 文本型, , 
.参数 默认文本, 文本型, 可空, 

.局部变量 读取内容, 文本型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 取出内容, 文本型, , "0", 

.如果真 (是否为空 (文件密码))
    赋值 (文件密码, “”)
.如果真结束
.如果真 (是否为空 (默认文本))
    赋值 (默认文本, “”)
.如果真结束
.如果真 (等于 (寻找文本 (配置文件名, “\”, , 假), -1))
    赋值 (配置文件名, 相加 (未知支持库函数_7 (9), “\”, 配置文件名))
.如果真结束
赋值 (配置文件名, 子文本替换 (配置文件名, “\\”, “\”, , , 真))
赋值 (文件号, 打开加密文件 (配置文件名, #读入, , 文件密码, )) ' 用读文本行的方式来操作配置文件。配置文件小节一般用[]括起来。配置文件项目均以：项目= 项目值 的形式保存。读取小节，然后读取小节后面几行文本，以“=”分隔，即可取得项目名称及项目值。下同。
.如果真 (等于 (文件号, 0)) ' 打开失败
    返回 (默认文本)
.如果真结束
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假))
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (等于 (到大写 (读取内容), 到大写 (相加 (“[”, 配置节名, “]”)))) ' 判断是否小节名
        跳出循环 ()
    .如果真结束
    
.判断循环尾 ()
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假)) ' 循环读取，直到所读文本行中，包含指定项目名称。
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (并且 (等于 (取文本左边 (删首尾空 (读取内容), 1), “[”), 等于 (取文本右边 (删首尾空 (读取内容), 1), “]”))) ' 如果读到下一个小节，则跳出循环。
        跳出循环 ()
    .如果真结束
    .如果真 (不等于 (寻找文本 (读取内容, “=”, , 假), -1))
        赋值 (取出内容, 分割文本 (读取内容, “=”, )) ' 分割项目名称与项目值。
        .如果真 (大于或等于 (取数组成员数 (取出内容), 2))
            .如果真 (等于 (删首尾空 (取出内容 [1]), 配置项名))
                关闭文件 (文件号)
                .如果真 (等于 (删首尾空 (取文本右边 (读取内容, 相减 (取文本长度 (读取内容), 寻找文本 (读取内容, “=”, , 假)))), “”))
                    返回 (默认文本)
                .如果真结束
                返回 (取文本右边 (读取内容, 相减 (取文本长度 (读取内容), 寻找文本 (读取内容, “=”, , 假))))
            .如果真结束
            
        .如果真结束
        
    .如果真结束
    
.判断循环尾 ()
关闭文件 (文件号)
返回 (默认文本)

.子程序 写加密配置项, 逻辑型, , 
.参数 配置文件名, 文本型, , 省略路径,默认为保存在windows系统目录下
.参数 文件密码, 文本型, 可空, 
.参数 配置节名, 文本型, , 
.参数 配置项名, 文本型, , 
.参数 欲写入值, 文本型, , 不允许写入空值。

.局部变量 读取内容, 文本型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 取出内容, 文本型, , "0", 
.局部变量 上次位置, 整数型, , , 
.局部变量 节存在, 逻辑型, , , 
.局部变量 项存在, 逻辑型, , , 

.如果真 (是否为空 (文件密码))
    赋值 (文件密码, “”)
.如果真结束
.如果真 (或者 (等于 (删首尾空 (配置文件名), “”), 等于 (删首尾空 (配置节名), “”), 等于 (删首尾空 (配置项名), “”), 等于 (删首尾空 (欲写入值), “”)))
    返回 (假)
.如果真结束
.如果真 (等于 (寻找文本 (配置文件名, “\”, , 假), -1))
    赋值 (配置文件名, 相加 (未知支持库函数_7 (9), “\”, 配置文件名))
.如果真结束
赋值 (配置文件名, 子文本替换 (配置文件名, “\\”, “\”, , , 真))
赋值 (文件号, 打开加密文件 (配置文件名, #改读, , 文件密码, ))
.如果真 (等于 (文件号, 0))
    返回 (假)
.如果真结束
赋值 (节存在, 假)
赋值 (项存在, 假)
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假)) ' 循环读取文本行，判断是否存在指定小节。
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (等于 (到大写 (读取内容), 到大写 (相加 (“[”, 配置节名, “]”))))
        赋值 (节存在, 真)
        跳出循环 ()
    .如果真结束
    
.判断循环尾 ()
.如果 (节存在)
    赋值 (上次位置, 取读写位置 (文件号))
    .判断循环首 (等于 (是否在文件尾 (文件号, 真), 假))
        赋值 (上次位置, 取读写位置 (文件号))
        赋值 (读取内容, 读入一行 (文件号))
        .如果真 (并且 (等于 (取文本左边 (删首尾空 (读取内容), 1), “[”), 等于 (取文本右边 (删首尾空 (读取内容), 1), “]”)))
            跳出循环 ()
        .如果真结束
        .如果真 (不等于 (寻找文本 (读取内容, “=”, , 假), -1)) ' 循环读取文本行，判断是否已经存在指定项目。如果存在，则修改。
            赋值 (取出内容, 分割文本 (读取内容, “=”, ))
            .如果真 (大于或等于 (取数组成员数 (取出内容), 2))
                .如果真 (等于 (删首尾空 (取出内容 [1]), 配置项名))
                    赋值 (项存在, 真)
                    移动读写位置 (文件号, , 上次位置)
                    删除数据 (文件号, 相加 (取文本长度 (读取内容), 2))
                    移动读写位置 (文件号, , 上次位置)
                    插入文本行 (文件号, 相加 (取出内容 [1], “=”, 欲写入值))
                    关闭文件 (文件号)
                    返回 (真)
                .如果真结束
                
            .如果真结束
            
        .如果真结束
        
    .判断循环尾 ()
    .如果真 (等于 (项存在, 假)) ' 如果项目不存在，则插入文本行。
        移动读写位置 (文件号, , 上次位置)
        插入文本行 (文件号, 相加 (配置项名, “=”, 欲写入值))
        关闭文件 (文件号)
        返回 (真)
    .如果真结束
    
.否则
    移到文件尾 (文件号) ' 如果小节不存在，则在文件最后插入小节。在小节下一行，插入项目。
    插入文本行 (文件号, 相加 (“[”, 配置节名, “]”))
    插入文本行 (文件号, 相加 (配置项名, “=”, 欲写入值))
    关闭文件 (文件号)
    返回 (真)
.如果结束
关闭文件 (文件号)
返回 (假)

.子程序 取加密配置节名, 逻辑型, , 
.参数 配置文件名, 文本型, , 省略路径,默认为保存在windows系统目录下
.参数 文件密码, 文本型, 可空, 
.参数 配置节名称数组, 文本型, 数组, 保存取出的配置文件节名称数组

.局部变量 文件号, 整数型, , , 
.局部变量 读取内容, 文本型, , , 

.如果真 (是否为空 (文件密码))
    赋值 (文件密码, “”)
.如果真结束
.如果真 (等于 (寻找文本 (配置文件名, “\”, , 假), -1))
    赋值 (配置文件名, 相加 (未知支持库函数_7 (9), “\”, 配置文件名))
.如果真结束
赋值 (配置文件名, 子文本替换 (配置文件名, “\\”, “\”, , , 真))
赋值 (文件号, 打开加密文件 (配置文件名, #读入, , 文件密码, ))
.如果真 (等于 (文件号, 0))
    返回 (假)
.如果真结束
清除数组 (配置节名称数组)
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假)) ' 循环读取文本行，取出所有小节，加入到数组。
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (并且 (等于 (取文本左边 (删首尾空 (读取内容), 1), “[”), 等于 (取文本右边 (删首尾空 (读取内容), 1), “]”)))
        赋值 (读取内容, 子文本替换 (读取内容, “[”, “”, , , 真))
        赋值 (读取内容, 子文本替换 (读取内容, “]”, “”, , , 真))
        加入成员 (配置节名称数组, 删首尾空 (读取内容))
    .如果真结束
    
.判断循环尾 ()
关闭文件 (文件号)
返回 (真)

.子程序 取加密配置项名, 逻辑型, , 
.参数 配置文件名, 文本型, , 省略路径,默认为保存在windows系统目录下
.参数 文件密码, 文本型, 可空, 
.参数 配置节名, 文本型, , 欲取出项目数组的小节名称
.参数 配置项名称数组, 文本型, 数组, 保存取出的配置项名称数组

.局部变量 文件号, 整数型, , , 
.局部变量 读取内容, 文本型, , , 

.如果真 (是否为空 (文件密码))
    赋值 (文件密码, “”)
.如果真结束
.如果真 (等于 (寻找文本 (配置文件名, “\”, , 假), -1))
    赋值 (配置文件名, 相加 (未知支持库函数_7 (9), “\”, 配置文件名))
.如果真结束
赋值 (配置文件名, 子文本替换 (配置文件名, “\\”, “\”, , , 真))
赋值 (文件号, 打开加密文件 (配置文件名, #读入, , 文件密码, ))
.如果真 (等于 (文件号, 0))
    返回 (假)
.如果真结束
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假)) ' 循环读取文本行，定位到指定小节。
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (等于 (到大写 (读取内容), 到大写 (相加 (“[”, 配置节名, “]”))))
        跳出循环 ()
    .如果真结束
    
.判断循环尾 ()
清除数组 (配置项名称数组)
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假)) ' 循环读取文本行，取出所有项目，保存至数组。读取到下一小节时，跳出循环。
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (并且 (等于 (取文本左边 (删首尾空 (读取内容), 1), “[”), 等于 (取文本右边 (删首尾空 (读取内容), 1), “]”)))
        跳出循环 ()
    .如果真结束
    .如果真 (不等于 (寻找文本 (读取内容, “=”, , 假), -1))
        加入成员 (配置项名称数组, 删首尾空 (取文本左边 (读取内容, 相减 (寻找文本 (读取内容, “=”, , 假), 1))))
    .如果真结束
    
.判断循环尾 ()
关闭文件 (文件号)
返回 (真)

.子程序 删除加密配置小节, 逻辑型, , 
.参数 配置文件名, 文本型, , 
.参数 文件密码, 文本型, 可空, 
.参数 配置节名, 文本型, , 

.局部变量 读取内容, 文本型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 上次位置, 整数型, , , 
.局部变量 节存在, 逻辑型, , , 

.如果真 (是否为空 (文件密码))
    赋值 (文件密码, “”)
.如果真结束
.如果真 (等于 (寻找文本 (配置文件名, “\”, , 假), -1))
    赋值 (配置文件名, 相加 (未知支持库函数_7 (9), “\”, 配置文件名))
.如果真结束
赋值 (配置文件名, 子文本替换 (配置文件名, “\\”, “\”, , , 真))
赋值 (文件号, 打开加密文件 (配置文件名, #改读, , 文件密码, ))
.如果真 (等于 (文件号, 0))
    返回 (假)
.如果真结束
赋值 (节存在, 假)
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假)) ' 循环读取文本行，判断是否存在指定小节，如果存在，则删除小节所在一行文本。
    赋值 (上次位置, 取读写位置 (文件号))
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (等于 (到大写 (读取内容), 到大写 (相加 (“[”, 配置节名, “]”))))
        赋值 (节存在, 真)
        移动读写位置 (文件号, , 上次位置)
        删除数据 (文件号, 相加 (取文本长度 (读取内容), 2))
        移动读写位置 (文件号, , 上次位置)
        跳出循环 ()
    .如果真结束
    
.判断循环尾 ()
.如果真 (等于 (节存在, 假)) ' 如果不存在指定小节，则删除失败。
    关闭文件 (文件号)
    返回 (节存在)
.如果真结束
.判断循环首 (等于 (是否在文件尾 (文件号, 真), 假)) ' 删除指定小节（已经在上述代码中被删除）下的所有文本行，直到读取到下一小节。
    赋值 (上次位置, 取读写位置 (文件号))
    赋值 (读取内容, 读入一行 (文件号))
    .如果真 (并且 (等于 (取文本左边 (删首尾空 (读取内容), 1), “[”), 等于 (取文本右边 (删首尾空 (读取内容), 1), “]”)))
        跳出循环 ()
    .如果真结束
    移动读写位置 (文件号, , 上次位置)
    删除数据 (文件号, 相加 (取文本长度 (读取内容), 2))
    移动读写位置 (文件号, , 上次位置)
.判断循环尾 ()
关闭文件 (文件号)
返回 (真)

.程序集 配置文件管理程序集, , , 

.子程序 配置文件_写用户信息, 空白型, , 
.参数 用户数组, 文本型, 数组, 
.参数 口令数组, 文本型, 数组, 

.局部变量 变量1, 整数型, , , 

.计次循环首 (取数组成员数 (用户数组), 变量1)
    写加密配置项 (配置文件, #密匙, 用户数组 [变量1], “口令”, 口令数组 [变量1]) ' 每个用户信息保存为一个小节。
.计次循环尾 ()

.子程序 配置文件_删除用户, 逻辑型, , 
.参数 用户名, 文本型, , 

返回 (删除加密配置小节 (配置文件, #密匙, 用户名))

.子程序 配置文件_取用户, 整数型, , 返回用户数
.局部变量 变量1, 整数型, , , 

清除数组 (用户)
取加密配置节名 (配置文件, #密匙, 用户)
.如果真 (大于 (取数组成员数 (用户), 0))
    .计次循环首 (取数组成员数 (用户), 变量1)
        .如果真 (等于 (用户 [变量1], “分类信息”)) ' 由于每个用户信息保存为一个小节，分类信息也保存为一个小节，所以在取出用户时，要剔除小节“分类信息”。
            删除成员 (用户, 变量1, 1)
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
.如果真结束
返回 (取数组成员数 (用户))

.子程序 配置文件_取口令, 文本型, , 
.参数 用户名, 文本型, , 

返回 (读加密配置项 (配置文件, #密匙, 用户名, “口令”, “”))

.子程序 配置文件_修改口令, 逻辑型, , 
.参数 用户名, 文本型, , 
.参数 口令文本, 文本型, , 

返回 (写加密配置项 (配置文件, #密匙, 用户名, “口令”, 口令文本))

.子程序 配置文件_取是否保存密码, 逻辑型, , 
.参数 用户名, 文本型, , 

返回 (等于 (读加密配置项 (配置文件, #密匙, 用户名, “保存口令”, “假”), “真”))

.子程序 配置文件_写是否保存密码, 逻辑型, , 
.参数 用户名, 文本型, , 
.参数 是否保存密码, 逻辑型, , 

返回 (写加密配置项 (配置文件, #密匙, 用户名, “保存口令”, 到文本 (是否保存密码)))

.子程序 配置文件_添加用户, 空白型, , 
.参数 用户名, 文本型, , 
.参数 口令文本, 文本型, , 

写加密配置项 (配置文件, #密匙, 用户名, “口令”, 口令文本)

.程序集 公用程序集, , , 在本程序集中定义的子程序可被模块外部程序访问，注意如果不存在本程序集就不能作为易模块编译。

.子程序 创建多级目录, 逻辑型, , 创建成功返回真，失败返回假。
.参数 目录名, 文本型, , 

.局部变量 创建目录, 文本型, , , 
.局部变量 找到位置, 短整数型, , , 

.如果真 (等于 (寻找文件 (目录名, #子目录), “”))
    赋值 (找到位置, 寻找文本 (目录名, “\”, , 真)) ' 如果目录中包含“\”，那就可能是一个多级目录，否则，直接创建目录（）就可以了。
    .如果真 (不等于 (找到位置, -1))
        .如果真 (等于 (取文本中间 (删首尾空 (目录名), 2, 1), “:”))
            赋值 (找到位置, 寻找文本 (目录名, “\”, 相加 (找到位置, 1), 真)) ' 剔除盘符后，如果还有“\"，就进入循环，逐级目录创建。
        .如果真结束
        .判断循环首 (不等于 (找到位置, -1))
            赋值 (创建目录, 取文本左边 (目录名, 相减 (找到位置, 1)))
            .如果真 (等于 (寻找文件 (创建目录, #子目录), “”))
                .如果真 (等于 (创建目录 (创建目录), 假))
                    返回 (假)
                .如果真结束
                
            .如果真结束
            赋值 (找到位置, 寻找文本 (目录名, “\”, 相加 (找到位置, 1), 真))
        .判断循环尾 ()
    .如果真结束
    .如果真 (等于 (创建目录 (目录名), 假))
        返回 (假)
    .如果真结束
    
.如果真结束
返回 (真)

.窗口程序集 关于程序集, , , 

.子程序 _确定按钮_被单击, 空白型, , 
主窗口.置文本 (., 7, “系统等待用户...”)

销毁 ()


.子程序 _关于窗口_将被销毁, 空白型, , 
主窗口.置文本 (., 7, “系统等待用户...”)


.窗口程序集 考试设置程序集, , , 

.子程序 _确定按钮_被单击, 空白型, , 
赋值 (考试时间, 到数值 (.内容))
赋值 (单选题数, 到数值 (.内容))
赋值 (多选题数, 到数值 (.内容))
赋值 (判断题数, 到数值 (.内容))
赋值 (题库名称, .内容)
赋值 (考场号0, 删尾空 (.内容))
.如果 (等于 (.选中, 真))
    赋值 (显示成绩, “真”)
.否则
    赋值 (显示成绩, “假”)
.如果结束

信息框 (“考场和考试信息设置成功！”, 相加 (0, 64), “设置成功”)
赋值 (主窗口..禁止, 假)
赋值 (主窗口..禁止, 假)
考试设置窗口.销毁 ()


.子程序 _返回按钮_被单击, 空白型, , 
主窗口.置文本 (., 7, “系统等待用户...”)
销毁 ()


.子程序 _考试设置窗口_将被销毁, 空白型, , 
主窗口.置文本 (., 7, “系统等待用户...”)


.子程序 _打开考试设置按钮_被单击, 空白型, , 
赋值 (主窗口..标题, “请选择要打开考试设置信息文件名”)
赋值 (主窗口..初始目录, 取当前目录 ())
赋值 (主窗口..类型, 0)
赋值 (主窗口..过滤器, “考试设置信息文件(*.dat)|*.dat|所有文件(*.*)|*.*”)


.如果 (等于 (主窗口.打开 (.), 真))
    赋值 (.内容, 读配置项 (主窗口..文件名, “ksset”, “kstime”, ))
    赋值 (.内容, 读配置项 (主窗口..文件名, “ksset”, “dxts”, ))
    赋值 (.内容, 读配置项 (主窗口..文件名, “ksset”, “ddts”, ))
    赋值 (.内容, 读配置项 (主窗口..文件名, “ksset”, “pdts”, ))
    赋值 (.内容, 读配置项 (主窗口..文件名, “ksset”, “tkmc”, ))
    赋值 (显示成绩, 读配置项 (主窗口..文件名, “ksset”, “xscj”, ))
    .如果 (等于 (显示成绩, “真”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    
     ' 信息框 (“打开考试设置信息文件成功！”, 0 ＋ 64, “打开成功”)
    赋值 (.禁止, 假)
.否则
    信息框 (“打开考试设置信息文件失败！”, 相加 (0, 48), “打开失败”)
    
.如果结束


.窗口程序集 端口设置程序集, , , 

.子程序 _端口设置窗口_创建完毕, 空白型, , 
赋值 (.内容, 到文本 (主窗口..端口))


.子程序 _确定按钮_被单击, 空白型, , 
赋值 (主窗口..端口, 到数值 (.内容))
.如果 (写配置项 (相加 (取当前目录 (), “\”, “syspz.ini”), “system”, “port”, .内容))
    信息框 (“考试服务器端口修改成功！”, 相加 (0, 64), “修改成功”)
.否则
    信息框 (“考试服务器端口修改失败！”, 相加 (0, 64), “修改失败”)
    
.如果结束
销毁 ()



.子程序 _取消按钮_被单击, 空白型, , 
主窗口.置文本 (., 7, “系统等待用户...”)
销毁 ()


.子程序 _端口设置窗口_将被销毁, 空白型, , 
主窗口.置文本 (., 7, “系统等待用户...”)


.窗口程序集 捕获图像窗口程序集, , , 

.程序集变量 计数变量, 整数型, , , 
.子程序 _获取按钮_被单击, 空白型, , 
真.未知支持库函数_0 (.现行选中项)
假.未知支持库函数_1 ()


.子程序 _数码设备1_图片传送完毕, 空白型, , 
.参数 图片, 字节集, , 
.参数 图片宽度, 整数型, , 
.参数 图片高度, 整数型, , 

主窗口.置数据 (., 主窗口.取光标行号 (.), 主窗口.取光标列号 (.), 图片)



.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()


.子程序 _捕获图像窗口_创建完毕, 空白型, , 

.如果 (等于 (未知支持库函数_3 (), 真))
    赋值 (计数变量, 0)
    .计次循环首 (., 计数变量)
        赋值 (., 相减 (计数变量, 1))
        .加入项目 (., )
    .计次循环尾 ()
    赋值 (.现行选中项, 0)
.否则
    信息框 (“数码设备未知”, 0, “失败”)
    
.如果结束


.窗口程序集 照片窗口程序集, , , 

.子程序 _按钮1_被单击, 空白型, , 
销毁 ()


.子程序 _照片窗口_创建完毕, 空白型, , 
赋值 (.图片, 考生照片)


.窗口程序集 系统广播程序集, , , 

.程序集变量 计数3, 整数型, , , 
.子程序 _返回按钮_被单击, 空白型, , 
主窗口.置文本 (., 7, “系统等待用户...”)

销毁 ()


.子程序 _发送按钮_被单击, 空白型, , 

.计次循环首 (主窗口.取行数 (.), 计数3)
    赋值 (客户地址, 主窗口.取文本 (., 计数3, 8))
    主窗口.发送数据 (., 客户地址, 相加 (“系统广播]”, .内容), )
.计次循环尾 ()
信息框 (相加 (到文本 (相减 (计数3, 1)), “ 台考生机发送信息成功！”), 相加 (0, 64), “发送成功”)






.窗口程序集 延长时间窗口程序集, , , 

.程序集变量 计数2, 整数型, , , 
.子程序 _确定按钮_被单击, 空白型, , 
.计次循环首 (主窗口.取行数 (.), 计数2)
    赋值 (客户地址, 主窗口.取文本 (., 计数2, 8))
    主窗口.发送数据 (., 客户地址, 相加 (“延长时间]”, .内容), )
    
.计次循环尾 ()
赋值 (考试时间, 相加 (考试时间, 到数值 (.内容)))
信息框 (相加 (到文本 (相减 (计数2, 1)), “台考生机的考试时间被延长 ”, .内容, “ 分钟！”), 相加 (0, 64), “延长时间成功”)
主窗口.置文本 (., 7, “系统等待用户...”)
销毁 ()


.子程序 _取消按钮_被单击, 空白型, , 
主窗口.置文本 (., 7, “系统等待用户...”)
销毁 ()


.窗口程序集 单延长时间窗口程序集, , , 

.子程序 _确定按钮_被单击, 空白型, , 
赋值 (客户地址, 主窗口.取文本 (., 主窗口.取光标行号 (.), 8))
主窗口.发送数据 (., 客户地址, 相加 (“延长时间]”, .内容), )
信息框 (相加 (“准考证号为：”, 主窗口.取文本 (., 主窗口.取光标行号 (.), 6), “ 考试机延长时间 ”, .内容, “成功！”), 相加 (0, 64), “延长时间成功”)
销毁 ()


.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()


.窗口程序集 软件注册窗口程序集, , , 

.子程序 _取消按钮_被单击, 空白型, , 
主窗口.置文本 (., 7, “系统等待用户...”)
销毁 ()


.子程序 _软件注册窗口_将被销毁, 空白型, , 
主窗口.置文本 (., 7, “系统等待用户...”)


.子程序 _注册按钮_被单击, 空白型, , 
.如果 (等于 (.内容, 注册验证码))
    赋值 (是否注册, 真)
    写到文件 (相加 (取当前目录 (), “\regcode.cod”), 未知支持库函数_3 (到字节集 (.内容), #密码, 1))
    信息框 (“注册成功，感谢您的信赖和支持！”, 相加 (0, 64), “注册成功”)
    销毁 ()
    
.否则
    赋值 (是否注册, 假)
    信息框 (“您输入的注册码有误，请查证后输入！”, 相加 (0, 48), “注册失败”)
    返回 ()
    
.如果结束






.子程序 _软件注册窗口_创建完毕, 空白型, , 
赋值 (.内容, 到文本 (注册申请码))
.如果真 (等于 (是否注册, 真))
    赋值 (.内容, 注册码)
    赋值 (.输入方式, 1)
    赋值 (软件注册窗口., “已注册”)
    赋值 (.禁止, 真)
    赋值 (.标题, “您的注册认证码是：”)
    赋值 (.标题, “返回.&C”)
    
.如果真结束



.窗口程序集 接收信息窗口程序集, , , 

.子程序 _确定按钮_被单击, 空白型, , 
赋值 (.内容, “”)
销毁 ()


.子程序 _接收信息窗口_创建完毕, 空白型, , 
赋值 (.内容, 相加 (.内容, #换行符, IP地址0, “发来信息：”, #换行符, 接收数据, #换行符))



 ' 不属于任何一个程序集、类模块的函数：
