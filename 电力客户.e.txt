 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口
    左边 = 50
    顶边 = 50
    宽度 = 718
    高度 = 460
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “【计量管理】”
    帮助文件名 = “”

窗口 密码验证 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 325
    高度 = 188
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 14671839 '  0xDFDFDF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “计量管理系统 - 口令验证 ”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 3 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 1 扩展界面支持库一
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二





.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
载入 (密码验证, , 真)

.子程序 _单选框1_被单击, 空白型, , 制造厂家
赋值 (.标题, 相加 (“【当前项目】---”, .标题))
赋值 (.标题, 相加 (“【”, .标题, “】”))
全部删除 ()
“dianbiao.mdb”.打开MDB数据库 ()
赋值 (.内容, .取标题 (., 0))
计量显示模块 ()
赋值 (.内容, “”)


.子程序 _单选框2_被单击, 空白型, , 电表型号
计量显示模块 ()
赋值 (.标题, 相加 (“【当前项目】－－”, .标题))
赋值 (.标题, 相加 (“【”, .标题, “】”))
赋值 (.内容, “”)


.子程序 _单选框3_被单击, 空白型, , 电压
赋值 (.标题, 相加 (“【当前项目】－－”, .标题))
赋值 (.标题, “【电    压】”)
计量显示模块 ()
赋值 (.内容, “”)

.子程序 _单选框4_被单击, 空白型, , 相数
赋值 (.标题, 相加 (“【当前项目】－－”, .标题))
赋值 (.标题, “【相    数】”)
计量显示模块 ()
赋值 (.内容, “”)


.子程序 _单选框5_被单击, 空白型, , 额定电流
赋值 (.标题, 相加 (“【当前项目】－－”, .标题))
赋值 (.标题, 相加 (“【”, .标题, “】”))
计量显示模块 ()
赋值 (.内容, “”)


.子程序 _单选框6_被单击, 空白型, , 级别
赋值 (.标题, 相加 (“【当前项目】－－”, .标题))
赋值 (.标题, “【级    别】”)
计量显示模块 ()
赋值 (.内容, “”)


.子程序 _单选框7_被单击, 空白型, , 转数
赋值 (.标题, 相加 (“【当前项目】－－”, .标题))
赋值 (.标题, “【转    数】”)
计量显示模块 ()
赋值 (.内容, “”)


.子程序 _单选框10_被单击, 空白型, , 
赋值 (.标题, 相加 (“【当前项目】－－”, .标题))
赋值 (.标题, “【电表名称】”)
计量显示模块 ()
赋值 (.内容, “”)


.子程序 _按钮1_被单击, 空白型, , 新增
.局部变量 记录, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 数据库, 文本型, , , 
.局部变量 数据库字段, 文本型, , , 
.局部变量 判断, 整数型, , , 
.局部变量 信息1, 文本型, , , 
.局部变量 信息2, 文本型, , , 
.局部变量 数据库内容, 文本型, , , 
.局部变量 数据库条件, 文本型, , , 

.如果 (等于 (.选中, 真))
    赋值 (数据库, “db_made”)
    赋值 (数据库字段, “制造厂家”)
.否则
    .如果 (等于 (.选中, 真))
        赋值 (数据库, “db_xh”)
        赋值 (数据库字段, “电表型号”)
    .否则
        .如果 (等于 (.选中, 真))
            赋值 (数据库, “db_dy”)
            赋值 (数据库字段, “电    压”)
        .否则
            .如果 (等于 (.选中, 真))
                赋值 (数据库, “db_xs”)
                赋值 (数据库字段, “相    数”)
            .否则
                .如果 (等于 (.选中, 真))
                    赋值 (数据库, “db_dl”)
                    赋值 (数据库字段, “额定电流”)
                .否则
                    .如果 (等于 (.选中, 真))
                        赋值 (数据库, “db_jb”)
                        赋值 (数据库字段, “级    别”)
                    .否则
                        .如果 (等于 (.选中, 真))
                            赋值 (数据库, “db_zs”)
                            赋值 (数据库字段, “转    数”)
                        .否则
                            .如果 (等于 (.选中, 真))
                                赋值 (数据库, “db_mc”)
                                赋值 (数据库字段, “电表名称”)
                            .否则
                                
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束
赋值 (数据库条件, 相加 (删全部空 (数据库字段), “=”, “'”, .内容, “'”))
“dianbiao.mdb”.打开MDB数据库 ()
赋值 (记录, 相加 (“select * from ”, 数据库, “ where ”, 数据库条件).查询 ())
赋值 (数据库内容, 记录.读 (1))
.如果 (等于 (到大写 (删全部空 (数据库内容)), 到大写 (删全部空 (.内容))))
    信息框 (相加 (删全部空 (数据库字段), “已经存在”), 0, )
.否则
    .如果 (不等于 (取文本长度 (.内容), 0))
        .如果 (等于 (相加 (“INSERT INTO ”, 数据库, “ (”, 删全部空 (数据库字段), “)”, “ values ('”, 删全部空 (.内容), “' ) ”).执行 (), 假))
            信息框 (“添加失败”, #信息图标, “失败”)
            返回 ()
        .否则
            信息框 (“添加成功”, #信息图标, “成功”)
            计量显示模块 ()
        .如果结束
        
    .否则
        信息框 (相加 (数据库字段, “不能为空”), #信息图标, “失败”)
    .如果结束
    记录.关闭记录集 ()
.如果结束


.子程序 计量显示模块, 空白型, , 通用
.局部变量 记录, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 数据库字段, 文本型, , , 
.局部变量 数据库内容, 文本型, , , 

.如果 (等于 (.选中, 真))
    赋值 (数据库字段, “db_made”)
    赋值 (数据库内容, “制造厂家”)
.否则
    .如果 (等于 (.选中, 真))
        赋值 (数据库字段, “db_xh”)
        赋值 (数据库内容, “电表型号”)
    .否则
        .如果 (等于 (.选中, 真))
            赋值 (数据库字段, “db_dy”)
            赋值 (数据库内容, “电    压”)
        .否则
            .如果 (等于 (.选中, 真))
                赋值 (数据库字段, “db_xs”)
                赋值 (数据库内容, “相    数”)
            .否则
                .如果 (等于 (.选中, 真))
                    赋值 (数据库字段, “db_dl”)
                    赋值 (数据库内容, “额定电流”)
                .否则
                    .如果 (等于 (.选中, 真))
                        赋值 (数据库字段, “db_jb”)
                        赋值 (数据库内容, “级    别”)
                    .否则
                        .如果 (等于 (.选中, 真))
                            赋值 (数据库字段, “db_zs”)
                            赋值 (数据库内容, “转    数”)
                        .否则
                            .如果 (等于 (.选中, 真))
                                赋值 (数据库字段, “db_mc”)
                                赋值 (数据库内容, “电表名称”)
                            .否则
                                
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束
“dianbiao.mdb”.打开MDB数据库 ()
赋值 (记录, 相加 (“select * from ”, 数据库字段).查询 ())
.计次循环首 (取列数 (), 计次)
    相减 (取列数 (), 1).删除列 ()
.计次循环尾 ()
全部删除 ()
.插入列 (数据库内容, 160, , , )
记录.到首记录 ()
.判断循环首 (等于 (记录.尾记录后 (), 假))
    .插入表项 (记录.读 (1), , , , )
    记录.到后一记录 ()
.判断循环尾 ()
记录.关闭记录集 ()

.子程序 _代码列表框_左键单击表项, 空白型, , 
“dianbiao.mdb”.打开MDB数据库 ()
赋值 (.内容, .取标题 (., 0))


.子程序 _按钮4_被单击, 空白型, , 
_启动窗口.销毁 ()

.子程序 _按钮3_被单击, 空白型, , 
.局部变量 数据库内容, 文本型, , , 
.局部变量 数据库条件, 文本型, , , 
.局部变量 数据库字段, 文本型, , , 
.局部变量 数据库, 文本型, , , 

赋值 (.内容, .取标题 (., 0))
.如果 (等于 (.选中, 真))
    赋值 (数据库, “db_made”)
    赋值 (数据库字段, “制造厂家”)
.否则
    .如果 (等于 (.选中, 真))
        赋值 (“db_xh”)
        赋值 (“电表型号”)
    .否则
        .如果 (等于 (.选中, 真))
            赋值 (数据库, “db_dy”)
            赋值 (“电    压”)
        .否则
            .如果 (等于 (.选中, 真))
                赋值 (“db_xs”)
                赋值 (“相    数”)
            .否则
                .如果 (等于 (.选中, 真))
                    赋值 (“db_dl”)
                    赋值 (“额定电流”)
                .否则
                    .如果 (等于 (.选中, 真))
                        赋值 (“db_jb”)
                        赋值 (“级    别”)
                    .否则
                        .如果 (等于 (.选中, 真))
                            赋值 (“db_zs”)
                            赋值 (数据库字段, “转    数”)
                        .否则
                            
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束
“dianbiao.mdb”.打开MDB数据库 ()
赋值 (数据库条件, 删全部空 (相加 (数据库字段, “=”, “'”, .内容, “'”)))
.如果 (等于 (相加 (“delete from ”, 数据库, “ where ”, 数据库条件).执行 (), 假))
    信息框 (“删除失败”, #信息图标, “失败”)
    返回 ()
.否则
    信息框 (“删除成功”, #信息图标, “成功”)
    赋值 (.内容, “”)
.如果结束
计量显示模块 ()


.子程序 _组合框2_获得焦点, 空白型, , 制造厂家
.局部变量 记录, 整数型, , , 

清空 ()
“dianbiao.mdb”.打开MDB数据库 ()
赋值 (记录, “select * from db_made”.查询 ())
记录.到首记录 ()
.判断循环首 (等于 (记录.尾记录后 (), 假))
    记录.读 (1).加入项目 ()
    记录.到后一记录 ()
.判断循环尾 ()
记录.关闭记录集 ()


.子程序 _组合框1_获得焦点, 空白型, , 电表型号
.局部变量 记录, 整数型, , , 

清空 ()
“dianbiao.mdb”.打开MDB数据库 ()
赋值 (记录, “select * from db_xh”.查询 ())
记录.到首记录 ()
.判断循环首 (等于 (记录.尾记录后 (), 假))
    记录.读 (1).加入项目 ()
    记录.到后一记录 ()
.判断循环尾 ()
记录.关闭记录集 ()


.子程序 _组合框3_获得焦点, 空白型, , 
.局部变量 记录, 整数型, , , 

清空 ()
“dianbiao.mdb”.打开MDB数据库 ()
赋值 (记录, “select * from db_dy”.查询 ())
记录.到首记录 ()
.判断循环首 (等于 (记录.尾记录后 (), 假))
    记录.读 (1).加入项目 ()
    记录.到后一记录 ()
.判断循环尾 ()
记录.关闭记录集 ()

.子程序 _组合框4_获得焦点, 空白型, , 
.局部变量 记录, 整数型, , , 

清空 ()
“dianbiao.mdb”.打开MDB数据库 ()
赋值 (记录, “select * from db_xs”.查询 ())
记录.到首记录 ()
.判断循环首 (等于 (记录.尾记录后 (), 假))
    记录.读 (1).加入项目 ()
    记录.到后一记录 ()
.判断循环尾 ()
记录.关闭记录集 ()


.子程序 _组合框5_获得焦点, 空白型, , 
.局部变量 记录, 整数型, , , 

清空 ()
“dianbiao.mdb”.打开MDB数据库 ()
赋值 (记录, “select * from db_dl”.查询 ())
记录.到首记录 ()
.判断循环首 (等于 (记录.尾记录后 (), 假))
    记录.读 (1).加入项目 ()
    记录.到后一记录 ()
.判断循环尾 ()
记录.关闭记录集 ()


.子程序 _组合框6_获得焦点, 空白型, , 
.局部变量 记录, 整数型, , , 

清空 ()
“dianbiao.mdb”.打开MDB数据库 ()
赋值 (记录, “select * from db_jb”.查询 ())
记录.到首记录 ()
.判断循环首 (等于 (记录.尾记录后 (), 假))
    记录.读 (1).加入项目 ()
    记录.到后一记录 ()
.判断循环尾 ()
记录.关闭记录集 ()


.子程序 _组合框7_获得焦点, 空白型, , 
.局部变量 记录, 整数型, , , 

清空 ()
“dianbiao.mdb”.打开MDB数据库 ()
赋值 (记录, “select * from db_zs”.查询 ())
记录.到首记录 ()
.判断循环首 (等于 (记录.尾记录后 (), 假))
    记录.读 (1).加入项目 ()
    记录.到后一记录 ()
.判断循环尾 ()
记录.关闭记录集 ()


.子程序 _入库_被单击, 空白型, , 
.局部变量 计量记录, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 数据库字段, 文本型, , , 
.局部变量 数据库内容, 文本型, , , 
.局部变量 数据库条件, 文本型, , , 
.局部变量 内容, 文本型, , , 

“dianbiao.mdb”.打开MDB数据库 ()
赋值 (数据库字段, “出厂号码,电表型号,制造厂家,电压,相数,额定电流,级别,转数,检定日期,入库日期,备注,领用情况,存放地点,电表名称,作废情况”)
赋值 (数据库内容, 相加 (“'”, .内容, “',  '”, .内容, “',  '”, .内容, “',  '”, .内容, “',  '”, .内容, “',  '”, .内容, “',  '”, .内容, “',  '”, .内容, “',  '”, .内容, “',  '”, .内容, “',  '”, .内容, “',  '未领用”, “',  '”, .内容, “',  '”, .内容, “',  '完好'”))
赋值 (数据库条件, 相加 (“ 出厂号码=”, “'”, .内容, “'”))
赋值 (计量记录, 相加 (“select * from db_biao where ”, 数据库条件).查询 ())
.如果 (不等于 (.内容, “”))
    .如果 (等于 (删首尾空 (到大写 (.内容)), 删首尾空 (到大写 (计量记录.读 (1)))))
        信息框 (相加 (“计量库中已有该号码----”, .内容), #信息图标, “失败”)
    .否则
        .如果 (不等于 (.内容, “”))
            .如果 (不等于 (.内容, “”))
                .如果 (不等于 (.内容, “”))
                    .如果 (不等于 (.内容, “”))
                        .如果 (不等于 (.内容, “”))
                            .如果 (不等于 (.内容, “”))
                                .如果 (不等于 (.内容, “”))
                                    .如果 (不等于 (.内容, “”))
                                        .如果 (不等于 (.内容, “”))
                                            .如果 (不等于 (.内容, “”))
                                                .如果 (不等于 (.内容, “”))
                                                    .如果 (等于 (相加 (“INSERT INTO db_biao  (”, 数据库字段, “) values (”, 数据库内容, “) ”).执行 (), 假))
                                                        信息框 (“添加失败”, #信息图标, “失败”)
                                                        返回 ()
                                                    .否则
                                                        
                                                    .如果结束
                                                    信息框 (“添加成功”, #信息图标, “成功”)
                                                    计量记录.关闭记录集 ()
                                                    赋值 (.内容, “”)
                                                .否则
                                                    信息框 (相加 (.标题, “不能为空”), #信息图标, “失败”)
                                                    返回 ()
                                                .如果结束
                                                
                                            .否则
                                                信息框 (相加 (.标题, “不能为空”), #信息图标, “失败”)
                                                返回 ()
                                            .如果结束
                                            
                                        .否则
                                            信息框 (相加 (.标题, “不能为空”), #信息图标, “失败”)
                                            返回 ()
                                        .如果结束
                                        
                                    .否则
                                        信息框 (相加 (.标题, “不能为空”), #信息图标, “失败”)
                                        返回 ()
                                    .如果结束
                                    
                                .否则
                                    信息框 (相加 (.标题, “不能为空”), #信息图标, “失败”)
                                    返回 ()
                                .如果结束
                                
                            .否则
                                信息框 (相加 (.标题, “不能为空”), #信息图标, “失败”)
                                返回 ()
                            .如果结束
                            
                        .否则
                            信息框 (相加 (.标题, “不能为空”), #信息图标, “失败”)
                            返回 ()
                        .如果结束
                        
                    .否则
                        信息框 (相加 (.标题, “不能为空”), #信息图标, “失败”)
                        返回 ()
                    .如果结束
                    
                .否则
                    信息框 (相加 (.标题, “不能为空”), #信息图标, “失败”)
                    返回 ()
                .如果结束
                
            .否则
                信息框 (相加 (.标题, “不能为空”), #信息图标, “失败”)
                返回 ()
            .如果结束
            
        .否则
            信息框 (相加 (.标题, “不能为空”), #信息图标, “失败”)
            返回 ()
        .如果结束
        
    .如果结束
    
.否则
    信息框 (相加 (.标题, “不能为空”), #信息图标, “失败”)
    返回 ()
.如果结束


.子程序 _按钮7_被单击, 空白型, , 
_启动窗口.销毁 ()

.子程序 _选择夹1_子夹被改变, 空白型, , 
.局部变量 出库记录, 整数型, , , 
.局部变量 库存记录, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 用户, 空白型, , , 

.如果 (等于 (.现行子夹, 0))
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
    全部删除 ()
    全部删除 ()
.否则
    .如果 (等于 (.现行子夹, 1))
        连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
        .计次循环首 (取列数 (), )
            相减 (取列数 (), 1).删除列 ()
        .计次循环尾 ()
        全部删除 ()
    .否则
        .如果 (等于 (.现行子夹, 2))
            连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
            全部删除 ()
            全部删除 ()
        .否则
            .如果 (等于 (.现行子夹, 3))
                “dianbiao.mdb”.打开MDB数据库 ()
                赋值 (库存记录, “select * from db_biao where 领用情况='未领用'and 作废情况<>'作废' ”.查询 ())
                .计次循环首 (取列数 (), )
                    相减 (取列数 (), 1).删除列 ()
                .计次循环尾 ()
                全部删除 ()
                .插入列 (“出厂号码”, 120, , , )
                .插入列 (“电表型号”, 60, , , )
                .插入列 (“电表名称”, 120, , , )
                .插入列 (“制造厂家”, 120, , , )
                .插入列 (“电压”, 60, , , )
                .插入列 (“相数”, 60, , , )
                .插入列 (“额定电流”, 60, , , )
                .插入列 (“级别”, 60, , , )
                .插入列 (“转数”, 60, , , )
                .插入列 (“检定日期”, 100, , , )
                .插入列 (“入库日期”, 100, , , )
                .插入列 (“领用情况”, 60, , , )
                .插入列 (“作废情况”, 60, , , )
                .插入列 (“备注”, 120, , , )
                .到首记录 ()
                .判断循环首 (等于 (.尾记录后 (), 假))
                    .插入表项 (.读 (1), , , , )
                    相减 (取表项数 (), 1).置标题 (1, .读 (2))
                    相减 (取表项数 (), 1).置标题 (2, 库存记录.读 (19))
                    相减 (取表项数 (), 1).置标题 (3, .读 (3))
                    相减 (取表项数 (), 1).置标题 (4, .读 (4))
                    相减 (取表项数 (), 1).置标题 (5, .读 (5))
                    相减 (取表项数 (), 1).置标题 (6, .读 (6))
                    相减 (取表项数 (), 1).置标题 (7, .读 (7))
                    相减 (取表项数 (), 1).置标题 (8, .读 (8))
                    相减 (取表项数 (), 1).置标题 (9, .读 (9))
                    相减 (取表项数 (), 1).置标题 (10, 时间到文本 (库存记录.读 (10), ))
                    相减 (取表项数 (), 1).置标题 (11, 库存记录.读 (12))
                    相减 (取表项数 (), 1).置标题 (12, 库存记录.读 (20))
                    相减 (取表项数 (), 1).置标题 (13, 库存记录.读 (11))
                    .到后一记录 ()
                .判断循环尾 ()
                .关闭记录集 ()
                全部删除 ()
                全部删除 ()
            .否则
                .如果 (等于 (.现行子夹, 4))
                    全部删除 ()
                    全部删除 ()
                    赋值 (.数据源, “”)
                    清空 ()
                    .如果 (等于 (.选中, 真))
                        赋值 (.标题, 相加 (“【当前项目】”, .标题))
                    .否则
                        
                    .如果结束
                    
                .否则
                    .如果 (等于 (.现行子夹, 6))
                        “pwd.mdb”.打开MDB数据库 ()
                        赋值 (用户, “select * from pwd ”.查询 ())
                        .计次循环首 (取列数 (), 计次)
                            相减 (取列数 (), 1).删除列 ()
                        .计次循环尾 ()
                        全部删除 ()
                        .插入列 (“管理员姓名”, 160, , , )
                        .插入列 (“密码”, 160, , , )
                        用户.到首记录 ()
                        .判断循环首 (等于 (用户.尾记录后 (), 假))
                            .插入表项 (用户.读 (1), , , , )
                            相减 (取表项数 (), 1).置标题 (1, 取重复文本 (8, “*”))
                            用户.到后一记录 ()
                        .判断循环尾 ()
                        用户.关闭记录集 ()
                    .否则
                        .如果 (等于 (.现行子夹, 7))
                            “pwd.mdb”.打开MDB数据库 ()
                            赋值 (用户, “select * from pwd ”.查询 ())
                            .计次循环首 (取列数 (), 计次)
                                相减 (取列数 (), 1).删除列 ()
                            .计次循环尾 ()
                            全部删除 ()
                            .插入列 (“管理员姓名”, 160, , , )
                            .插入列 (“密码”, 160, , , )
                            .到首记录 ()
                            .判断循环首 (等于 (用户.尾记录后 (), 假))
                                .插入表项 (用户.读 (1), , , , )
                                相减 (取表项数 (), 1).置标题 (1, 取重复文本 (8, “*”))
                                用户.到后一记录 ()
                            .判断循环尾 ()
                            用户.关闭记录集 ()
                        .否则
                            .如果 (等于 (.现行子夹, 5))
                                _显示库存_被单击 ()
                            .否则
                                
                            .如果结束
                            
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 _按钮8_被单击, 空白型, , 
_启动窗口.销毁 ()

.子程序 _登记_被单击, 空白型, , 出库管理
.局部变量 出库记录1, 整数型, , , 
.局部变量 出库记录, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 数据库字段, 文本型, , , 
.局部变量 数据库内容, 文本型, , , 
.局部变量 数据库条件, 文本型, , , 
.局部变量 数据库字段5, 文本型, , , 
.局部变量 数据库字段4, 文本型, , , 
.局部变量 数据库字段3, 文本型, , , 
.局部变量 数据库字段2, 文本型, , , 
.局部变量 数据库字段1, 文本型, , , 
.局部变量 数据库字段6, 文本型, , , 
.局部变量 数据库字段7, 文本型, , , 

“dianbiao.mdb”.打开MDB数据库 ()
赋值 (数据库条件, 相加 (“ 出厂号码=”, “'”, .内容, “'”))
赋值 (数据库字段1, “ 领用情况='已领用',”)
赋值 (数据库字段2, 相加 (“ 工作单号=”, “'”, .内容, “',”))
赋值 (数据库字段3, 相加 (“ 安装地点=”, “'”, .内容, “',”))
赋值 (数据库字段4, 相加 (“ 领表时间=”, “'”, .内容, “',”))
赋值 (数据库字段5, 相加 (“ 领用单位=”, “'”, .内容, “',”))
赋值 (数据库字段6, 相加 (“ 领用备注=”, “'”, .内容, “',”))
赋值 (数据库字段7, 删首尾空 (相加 (数据库字段1, 数据库字段2, 数据库字段3, 数据库字段4, 数据库字段5, 数据库字段6)))
.如果 (等于 (取文本右边 (数据库字段7, 1), “,”))
    赋值 (数据库字段, 取文本左边 (数据库字段7, 相减 (取文本长度 (数据库字段7), 1)))
.否则
    赋值 (数据库字段, 数据库字段7)
.如果结束
赋值 (出库记录, 相加 (“select * from db_biao where ”, 数据库条件).查询 ())
.如果 (等于 (出库记录.读 (12), “已领用”))
    信息框 (相加 (.内容, “已被领用”), #信息图标, “失败”)
.否则
    .如果 (不等于 (.内容, “”))
        .如果 (不等于 (.内容, “”))
            .如果 (不等于 (.内容, “”))
                .如果 (不等于 (.内容, “”))
                    .如果 (不等于 (删首尾空 (到大写 (.内容)), 删首尾空 (到大写 (出库记录.读 (1)))))
                        信息框 (相加 (“计量库中没有该号码----”, .内容), #信息图标, “失败”)
                    .否则
                        .如果 (等于 (相加 (“update  db_biao  set ”, 数据库字段, “ where ”, 数据库条件).执行 (), 假))
                            信息框 (“添加失败”, #信息图标, “失败”)
                            返回 ()
                        .否则
                            .关闭记录集 ()
                            “dianbiao.mdb”.打开MDB数据库 ()
                            赋值 (出库记录1, “select * from db_biao where 领用情况='已领用'”.查询 ())
                            .计次循环首 (取列数 (), )
                                相减 (取列数 (), 1).删除列 ()
                            .计次循环尾 ()
                            全部删除 ()
                            .插入列 (“出厂号码”, 160, , , )
                            .插入列 (“电表型号”, 160, , , )
                            .插入列 (“领用情况”, 160, , , )
                            .插入列 (“工作单号”, 160, , , )
                            .插入列 (“安装地点”, 160, , , )
                            .插入列 (“领表时间”, 160, , , )
                            .插入列 (“领用单位”, 160, , , )
                            .插入列 (“领用备注”, 160, , , )
                            出库记录1.到首记录 ()
                            .判断循环首 (等于 (出库记录1.尾记录后 (), 假))
                                .插入表项 (出库记录1.读 (1), , , , )
                                相减 (取表项数 (), 1).置标题 (1, 出库记录1.读 (3))
                                相减 (取表项数 (), 1).置标题 (2, 出库记录1.读 (12))
                                相减 (取表项数 (), 1).置标题 (3, 出库记录1.读 (13))
                                相减 (取表项数 (), 1).置标题 (4, 出库记录1.读 (14))
                                相减 (取表项数 (), 1).置标题 (5, 时间到文本 (出库记录1.读 (15), ))
                                相减 (取表项数 (), 1).置标题 (6, 出库记录1.读 (16))
                                相减 (取表项数 (), 1).置标题 (7, 出库记录1.读 (17))
                                出库记录1.到后一记录 ()
                            .判断循环尾 ()
                            出库记录1.关闭记录集 ()
                            
                        .如果结束
                        
                    .如果结束
                    
                .否则
                    信息框 (“领用单位不能为空”, #信息图标, “失败”)
                    返回 ()
                .如果结束
                
            .否则
                信息框 (“领表时间不能为空”, #信息图标, “失败”)
                返回 ()
            .如果结束
            
        .否则
            信息框 (“安装地点不能为空”, #信息图标, “失败”)
            返回 ()
        .如果结束
        
    .否则
        信息框 (“工作单号不能为空”, #信息图标, “失败”)
        返回 ()
    .如果结束
    
.如果结束


.子程序 _单选框9_被单击, 空白型, , 
.局部变量 出库记录, 整数型, , , 
.局部变量 计次, 整数型, , , 

“dianbiao.mdb”.打开MDB数据库 ()
.如果 (等于 (.选中, 真))
    .计次循环首 (取列数 (), 计次)
        相减 (取列数 (), 1).删除列 ()
    .计次循环尾 ()
    全部删除 ()
    赋值 (出库记录, “select * from db_biao where 领用情况='已领用'”.查询 ())
    .插入列 (“出厂号码”, 80, , , )
    .插入列 (“电表型号”, 60, , , )
    .插入列 (“电表名称”, 110, , , )
    .插入列 (“领用情况”, 160, , , )
    .插入列 (“工作单号”, 160, , , )
    .插入列 (“安装地点”, 160, , , )
    .插入列 (“领表时间”, 160, , , )
    .插入列 (“领用单位”, 160, , , )
    .插入列 (“领用备注”, 160, , , )
    出库记录.到首记录 ()
    .判断循环首 (等于 (出库记录.尾记录后 (), 假))
        .插入表项 (出库记录.读 (1), , , , )
        相减 (取表项数 (), 1).置标题 (1, 出库记录.读 (3))
        相减 (取表项数 (), 1).置标题 (2, 出库记录.读 (19))
        相减 (取表项数 (), 1).置标题 (3, 出库记录.读 (12))
        相减 (取表项数 (), 1).置标题 (4, 出库记录.读 (13))
        相减 (取表项数 (), 1).置标题 (5, 出库记录.读 (14))
        相减 (取表项数 (), 1).置标题 (6, 时间到文本 (出库记录.读 (15), ))
        相减 (取表项数 (), 1).置标题 (7, 出库记录.读 (16))
        相减 (取表项数 (), 1).置标题 (8, 出库记录.读 (17))
        出库记录.到后一记录 ()
    .判断循环尾 ()
    出库记录.关闭记录集 ()
.否则
    
.如果结束


.子程序 _单选框8_被单击, 空白型, , 
.局部变量 出库记录, 整数型, , , 
.局部变量 计次, 整数型, , , 

“dianbiao.mdb”.打开MDB数据库 ()
.如果 (等于 (.选中, 真))
    .计次循环首 (取列数 (), 计次)
        相减 (取列数 (), 1).删除列 ()
    .计次循环尾 ()
    全部删除 ()
    赋值 (出库记录, “select * from db_biao where 领用情况='未领用' and  作废情况='完好' order by 入库日期”.查询 ())
    .插入列 (“出厂号码”, 80, , , )
    .插入列 (“电表型号”, 110, , , )
    .插入列 (“电表名称”, 110, , , )
    .插入列 (“领用情况”, 60, , , )
    .插入列 (“存放地点”, 120, , , )
    .插入列 (“作废情况”, 120, , , )
    出库记录.到首记录 ()
    .判断循环首 (等于 (出库记录.尾记录后 (), 假))
        .插入表项 (出库记录.读 (1), , , , )
        相减 (取表项数 (), 1).置标题 (1, 出库记录.读 (3))
        相减 (取表项数 (), 1).置标题 (2, 出库记录.读 (19))
        相减 (取表项数 (), 1).置标题 (3, 出库记录.读 (12))
        相减 (取表项数 (), 1).置标题 (4, 出库记录.读 (18))
        相减 (取表项数 (), 1).置标题 (5, 出库记录.读 (20))
        出库记录.到后一记录 ()
    .判断循环尾 ()
    出库记录.关闭记录集 ()
.否则
    
.如果结束


.子程序 _出库列表框_左键单击表项, 空白型, , 
“dianbiao.mdb”.打开MDB数据库 ()
.如果 (等于 (.选中, 真))
    赋值 (.内容, .取标题 (., 0))
.否则
    
.如果结束


.子程序 _名称框_获得焦点, 空白型, , 
.局部变量 记录, 整数型, , , 

清空 ()
“dianbiao.mdb”.打开MDB数据库 ()
赋值 (记录, “select * from db_mc”.查询 ())
记录.到首记录 ()
.判断循环首 (等于 (记录.尾记录后 (), 假))
    记录.读 (1).加入项目 ()
    记录.到后一记录 ()
.判断循环尾 ()
记录.关闭记录集 ()


.子程序 _按钮5_被单击, 空白型, , 
_启动窗口.销毁 ()

.子程序 _作废提交_被单击, 空白型, , 
.局部变量 作废号码, 文本型, , , 
.局部变量 库存记录, 整数型, , , 
.局部变量 计次, 整数型, , , 

“dianbiao.mdb”.打开MDB数据库 ()
赋值 (作废号码, 相加 (.内容, “废”))
.如果 (等于 (相加 (“update  db_biao set 作废情况='作废',出厂号码='”, 作废号码, “' where 出厂号码=”, “'”, .内容, “'”).执行 (), 假))
    信息框 (“修改失败”, #信息图标, “失败”)
    返回 ()
.否则
    信息框 (“修改成功”, #信息图标, “成功”)
    赋值 (库存记录, “select * from db_biao where 领用情况='未领用'and 作废情况<>'作废' ”.查询 ())
    
    .计次循环首 (取列数 (), 计次)
        相减 (取列数 (), 1).删除列 ()
    .计次循环尾 ()
    全部删除 ()
    .插入列 (“出厂号码”, 120, , , )
    .插入列 (“电表型号”, 60, , , )
    .插入列 (“电表名称”, 120, , , )
    .插入列 (“制造厂家”, 120, , , )
    .插入列 (“电压”, 60, , , )
    .插入列 (“相数”, 60, , , )
    .插入列 (“额定电流”, 60, , , )
    .插入列 (“级别”, 60, , , )
    .插入列 (“转数”, 60, , , )
    .插入列 (“检定日期”, 100, , , )
    .插入列 (“入库日期”, 100, , , )
    .插入列 (“领用情况”, 60, , , )
    .插入列 (“作废情况”, 60, , , )
    .插入列 (“备注”, 120, , , )
    .到首记录 ()
    .判断循环首 (等于 (.尾记录后 (), 假))
        .插入表项 (.读 (1), , , , )
        相减 (取表项数 (), 1).置标题 (1, .读 (2))
        相减 (取表项数 (), 1).置标题 (2, .读 (19))
        相减 (取表项数 (), 1).置标题 (3, .读 (3))
        相减 (取表项数 (), 1).置标题 (4, .读 (4))
        相减 (取表项数 (), 1).置标题 (5, .读 (5))
        相减 (取表项数 (), 1).置标题 (6, .读 (6))
        相减 (取表项数 (), 1).置标题 (7, .读 (7))
        相减 (取表项数 (), 1).置标题 (8, .读 (8))
        相减 (取表项数 (), 1).置标题 (9, .读 (9))
        相减 (取表项数 (), 1).置标题 (10, 时间到文本 (库存记录.读 (10), ))
        相减 (取表项数 (), 1).置标题 (11, .读 (12))
        相减 (取表项数 (), 1).置标题 (12, 库存记录.读 (20))
        相减 (取表项数 (), 1).置标题 (13, 库存记录.读 (11))
        .到后一记录 ()
    .判断循环尾 ()
    .关闭记录集 ()
    全部删除 ()
    全部删除 ()
    
.如果结束


.子程序 _库存_被单击, 空白型, , 
.局部变量 制造厂家, 整数型, , , 
.局部变量 型号, 整数型, , , 
.局部变量 型号代码, 文本型, , , 
.局部变量 位置, 整数型, , , 
.局部变量 制造厂家代码, 文本型, , , 
.局部变量 计次变量, 整数型, , , 
.局部变量 电表库, 整数型, , , 
.局部变量 电表库厂家, 文本型, , , 
.局部变量 电表型号, 整数型, , , 
.局部变量 领用代码, 文本型, , , 
.局部变量 电表型号代码, 文本型, , , 

“dianbiao.mdb”.打开MDB数据库 ()
赋值 (.数据源, “”)
赋值 (.选中, 假)
清空 ()
赋值 (制造厂家, “select * from db_made ”.查询 ())
制造厂家.到首记录 ()
.判断循环首 (等于 (制造厂家.尾记录后 (), 假))
    赋值 (制造厂家代码, 制造厂家.读 (1))
    赋值 (电表库, 相加 (“select * from db_biao where 制造厂家='”, 制造厂家代码, “'”).查询 ())
    赋值 (电表库厂家, 电表库.读 (3))
    .如果 (等于 (制造厂家代码, 电表库厂家))
        赋值 (位置, -1.加入项目 (电表库厂家, 0, , 计次变量))
        赋值 (型号, “select * from db_xh ”.查询 ())
        型号.到首记录 ()
        .判断循环首 (等于 (型号.尾记录后 (), 假))
            赋值 (型号代码, 型号.读 (1))
            赋值 (领用代码, 删全部空 (电表库.读 (20)))
            赋值 (电表型号, 相加 (“select * from db_biao where 电表型号='”, 型号代码, “' and 制造厂家='”, 电表库厂家, “'”).查询 ())
            赋值 (电表型号代码, 电表型号.读 (2))
            电表型号.到首记录 ()
            .如果 (等于 (型号代码, 电表型号代码))
                .如果 (不等于 (领用代码, “作废”))
                    .如果 (等于 (电表型号.读 (12), “未领用”))
                        .如果 (等于 (制造厂家代码, 电表库厂家))
                            位置.加入项目 (型号.读 (1), 1, , 计次变量)
                        .否则
                            
                        .如果结束
                        
                    .否则
                        
                    .如果结束
                    
                .否则
                    
                .如果结束
                
            .否则
                
            .如果结束
            型号.到后一记录 ()
        .判断循环尾 ()
    .否则
        
    .如果结束
    制造厂家.到后一记录 ()
.判断循环尾 ()
.如果 (等于 (.选中, 真))
    赋值 (.标题, 相加 (“【当前项目】---”, .标题))
.否则
    
.如果结束
制造厂家.关闭记录集 ()
电表型号.关闭记录集 ()
型号.关闭记录集 ()

.子程序 _查询树型框_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

.局部变量 行号, 整数型, , , 
.局部变量 开始行号, 整数型, , , 
.局部变量 行数, 整数型, , , 
.局部变量 列数, 整数型, , , 
.局部变量 容器, 整数型, , , 
.局部变量 记录容器, 整数型, , , 
.局部变量 库存记录, 整数型, , , 
.局部变量 父项目, 文本型, , , 
.局部变量 子项目, 文本型, , , 
.局部变量 数据库条件, 文本型, , , 
.局部变量 时间2, 文本型, , , 
.局部变量 时间1, 文本型, , , 
.局部变量 子项目1, 文本型, , , 
.局部变量 子项目3, 文本型, , , 
.局部变量 子项目2, 文本型, , , 
.局部变量 编号, 整数型, , , 

赋值 (.数据源, “”)
.如果 (等于 (.选中, 真))
    表格显示 ()
.否则
    .如果 (等于 (.选中, 真))
        表格显示 ()
    .否则
        
    .如果结束
    
.如果结束
.如果 (等于 (.选中, 真))
    .如果真 (等于 (“biao.grd”.从文件读 (), 假))
        信息框 (“打开领用报表模板失败!”, 相加 (#确认钮, #错误图标), “错误”)
        返回 ()
    .如果真结束
    “dianbiao.mdb”.打开MDB数据库 ()
    赋值 (子项目3, 删首尾空 (.取项目文本 (.最大化按钮)))
    赋值 (子项目1, 到文本 (.取项目数值 (.最大化按钮)))
    赋值 (子项目2, 到文本 (相加 (.取项目数值 (.最大化按钮), 1)))
    赋值 (时间1, 相加 (到文本 (取年份 (取现行时间 ())), “-”, 子项目1, “-1”))
    赋值 (时间2, 相加 (到文本 (取年份 (取现行时间 ())), “-”, 子项目2, “-1”))
    .如果 (等于 (.取项目数值 (.最大化按钮), 12))
        赋值 (库存记录, 相加 (“select * from db_biao where 作废情况<>'作废' and 领用情况='已领用' and  领表时间>=#”, 时间1, “# order by 领表时间”).查询 ())
    .否则
        赋值 (库存记录, 相加 (“select * from db_biao where 作废情况<>'作废' and 领用情况='已领用' and  领表时间>=#”, 时间1, “# and  领表时间<#”, 时间2, “#  order by  领表时间”).查询 ())
    .如果结束
    保存更改 ()
    连续赋值 (相加 (取行数 (), 1), 开始行号, 行号)
    赋值 (列数, 取列数 ())
    赋值 (编号, 1)
    相减 (2).置文本 (1, 相加 (取空白文本 (90), “打印时间:”, 时间到文本 (取现行时间 (), 2)))
    相减 (2).置对齐方式 (1, 1, 1, #中中)
    赋值 (.底图, 真)
    库存记录.到首记录 ()
    .判断循环首 (等于 (库存记录.尾记录后 (), 假))
        .添加行 ()
        行号.置文本 (1, 到文本 (编号))
        行号.置文本 (2, 库存记录.读 (19))
        行号.置文本 (3, 库存记录.读 (2))
        行号.置文本 (4, 库存记录.读 (1))
        行号.置文本 (5, 库存记录.读 (3))
        行号.置文本 (6, 库存记录.读 (14))
        行号.置文本 (7, 库存记录.读 (13))
        行号.置文本 (8, 库存记录.读 (16))
        行号.置文本 (9, 时间到文本 (库存记录.读 (15), ))
        行号.置文本 (10, 库存记录.读 (18))
        行号.置文本 (11, 时间到文本 (库存记录.读 (10), ))
        行号.置文本 (12, 库存记录.读 (9))
        赋值 (行号, 相加 (行号, 1))
        赋值 (编号, 相加 (编号, 1))
        库存记录.到后一记录 ()
    .判断循环尾 ()
    库存记录.关闭记录集 ()
    赋值 (行数, 相加 (相减 (行号, 开始行号), 1))
    赋值 (列数, 取列数 ())
    开始行号.加线条 (1, 行数, 列数, 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))
    开始行号.置行高 (行数, 80)
    2.置字体尺寸 (1, 行数, 列数, 54)
    3.置字体尺寸 (1, 行数, 列数, 54)
    6.置字体尺寸 (1, 行数, 列数, 48)
    开始行号.置字体名 (1, 行数, 1, “宋体”)
    开始行号.置对齐方式 (1, 行数, 列数, #中中)
    保存更改 ()
    赋值 (.数据源, “数据源1”)
.否则
    
.如果结束


.子程序 表格显示, 空白型, , 库存和入库通用
.局部变量 行号, 整数型, , , 
.局部变量 开始行号, 整数型, , , 
.局部变量 行数, 整数型, , , 
.局部变量 列数, 整数型, , , 
.局部变量 容器, 整数型, , , 
.局部变量 记录容器, 整数型, , , 
.局部变量 库存记录, 整数型, , , 
.局部变量 父项目, 文本型, , , 
.局部变量 子项目3, 文本型, , , 
.局部变量 子项目, 文本型, , , 
.局部变量 数据库条件, 文本型, , , 
.局部变量 时间2, 文本型, , , 
.局部变量 时间1, 文本型, , , 
.局部变量 子项目1, 文本型, , , 
.局部变量 子项目2, 文本型, , , 
.局部变量 编号, 整数型, , , 

赋值 (.数据源, “”)
赋值 (.底图, 真)
.如果 (等于 (.选中, 真))
    赋值 (删首尾空 (.取项目文本 (.最大化按钮)))
    赋值 (删全部空 (.取父项目 (.最大化按钮).取项目文本 ()))
    赋值 (子项目3, 相加 (“制造厂家及型号：”, 父项目, 子项目, 取空白文本 (20)))
    .如果 (大于 (.取缩进层次 (.最大化按钮), 1))
        .如果真 (等于 (“dianbiao.grd”.从文件读 (), 假))
            信息框 (“打开计量报表模板失败!”, 相加 (#确认钮, #错误图标), “错误”)
            返回 ()
        .如果真结束
        “dianbiao.mdb”.打开MDB数据库 ()
        赋值 (相加 (“select * from db_biao where 领用情况='未领用' and 作废情况<>'作废' and 制造厂家='”, , “' and 电表型号='”, , “'”).查询 ())
    .否则
        
    .如果结束
    
.否则
    .如果 (等于 (.选中, 真))
        .如果真 (等于 (“入库报表.grd”.从文件读 (), 假))
            信息框 (“打开入库报表模板失败!”, 相加 (#确认钮, #错误图标), “错误”)
            返回 ()
        .如果真结束
        “dianbiao.mdb”.打开MDB数据库 ()
        赋值 (子项目3, 删首尾空 (.取项目文本 (.最大化按钮)))
        赋值 (子项目1, 到文本 (.取项目数值 (.最大化按钮)))
        赋值 (到文本 (相加 (.取项目数值 (.最大化按钮), 1)))
        赋值 (相加 (到文本 (取年份 (取现行时间 ())), “-”, , “-1”))
        赋值 (相加 (到文本 (取年份 (取现行时间 ())), “-”, , “-1”))
        .如果 (等于 (.取项目数值 (.最大化按钮), 12))
            赋值 (相加 (“select * from db_biao where 作废情况<>'作废' and  入库日期>=#”, , “# order by 入库日期”).查询 ())
        .否则
            赋值 (相加 (“select * from db_biao where 作废情况<>'作废' and  入库日期>=#”, , “# and  入库日期<#”, , “#  order by  入库日期”).查询 ())
        .如果结束
        
    .否则
        
    .如果结束
    
.如果结束
保存更改 ()
连续赋值 (相加 (取行数 (), 1), 开始行号, 行号)
赋值 (编号, 1)
赋值 (列数, 取列数 ())
相减 (行号, 2).置文本 (1, 相加 (子项目3, 取空白文本 (50), “打印时间:”, 时间到文本 (取现行时间 (), 2)))
相减 (行号, 2).置对齐方式 (1, 1, 1, #中中)
赋值 (.底图, 真)
库存记录.到首记录 ()
.判断循环首 (等于 (库存记录.尾记录后 (), 假))
    .添加行 ()
    行号.置文本 (1, 到文本 (编号))
    行号.置文本 (2, 库存记录.读 (19))
    行号.置文本 (3, 库存记录.读 (2))
    行号.置文本 (4, 库存记录.读 (1))
    行号.置文本 (5, 库存记录.读 (3))
    行号.置文本 (6, 库存记录.读 (9))
    行号.置文本 (7, 时间到文本 (库存记录.读 (10), ))
    行号.置文本 (8, 库存记录.读 (18))
    行号.置文本 (9, 库存记录.读 (4))
    行号.置文本 (10, 库存记录.读 (5))
    行号.置文本 (11, 库存记录.读 (6))
    行号.置文本 (12, 库存记录.读 (7))
    行号.置文本 (13, 库存记录.读 (8))
    赋值 (编号, 相加 (编号, 1))
    赋值 (相加 (1))
    .到后一记录 ()
.判断循环尾 ()
.关闭记录集 ()
赋值 (相加 (相减 (), 1))
赋值 (取列数 ())
.加线条 (1, , , 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))
.置行高 (100)
2.置字体尺寸 (1, , , 54)
3.置字体尺寸 (1, , , 54)
4.置字体尺寸 (1, 行数, 列数, 54)
6.置字体尺寸 (1, , , 48)
开始行号.置字体尺寸 (列数, 行数, 1, 48)
.置字体名 (1, , 1, “宋体”)
.置对齐方式 (1, , , #中中)
保存更改 ()
赋值 (.数据源, “数据源1”)


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 打印设置, 打印设置信息, , , 

赋值 (打印设置, 取打印设置 ())
赋值 (打印设置.纸张方向, #横向)
赋值 (打印设置.纸张类型, 2)
赋值 (打印设置.打印缩放比, -1)
赋值 (打印设置.页号位置, #下中页号)
赋值 (打印设置.上边距, 100)
赋值 (打印设置.下边距, 80)
赋值 (打印设置.自动填充, 真)
打印设置.置打印设置 ()
打印预览 ()

.子程序 _按钮6_被单击, 空白型, , 
_启动窗口.销毁 ()

.子程序 _按钮9_被单击, 空白型, , 
.打印 ()

.子程序 _总帐_被单击, 空白型, , 入库
.局部变量 月份, 整数型, , , 
.局部变量 计次变量, 整数型, , , 

赋值 (.选中, 假)
清空 ()
“dianbiao.mdb”.打开MDB数据库 ()
赋值 (月份, “select * from db_yf ”.查询 ())
月份.到首记录 ()
赋值 (计次变量, 1)
赋值 (.数据源, “”)
.判断循环首 (等于 (月份.尾记录后 (), 假))
    -1.加入项目 (相加 (月份.读 (1), “份----入库报表”), 1, , 计次变量)
    赋值 (计次变量, 相加 (计次变量, 1))
    月份.到后一记录 ()
.判断循环尾 ()
.如果 (等于 (.选中, 真))
    赋值 (.标题, 相加 (“【当前项目】---”, .标题))
.否则
    
.如果结束

月份.关闭记录集 ()

.子程序 _领用_被单击, 空白型, , 
.局部变量 计次变量, 整数型, , , 
.局部变量 月份, 整数型, , , 

赋值 (.选中, 假)
清空 ()
“dianbiao.mdb”.打开MDB数据库 ()
赋值 (“select * from db_yf ”.查询 ())
.到首记录 ()
赋值 (计次变量, 1)
赋值 (.数据源, “”)
.判断循环首 (等于 (月份.尾记录后 (), 假))
    -1.加入项目 (相加 (月份.读 (1), “份---领用报表”), 1, , 计次变量)
    赋值 (相加 (1))
    月份.到后一记录 ()
.判断循环尾 ()
赋值 (.选中, 假)
.如果 (等于 (.选中, 真))
    赋值 (.标题, 相加 (“【当前项目】---”, .标题))
.否则
    
.如果结束
月份.关闭记录集 ()
赋值 (.数据源, “”)


.子程序 _添加_被单击, 空白型, , 
.局部变量 数据库字段, 文本型, , , 
.局部变量 数据库内容, 文本型, , , 
.局部变量 数据库, 整数型, , , 
.局部变量 用户, 整数型, , , 
.局部变量 计次, 整数型, , , 

“pwd.mdb”.打开MDB数据库 ()
赋值 (数据库字段, “用户名,密码”)
赋值 (数据库内容, 相加 (“'”, .内容, “',  '”, .内容, “'”))
数据库.到首记录 ()
赋值 (数据库, “select * from pwd”.查询 ())
.如果 (并且 (不等于 (数据库.读 (1), 删全部空 (.内容)), 等于 (.内容, .内容)))
    .如果 (不等于 (取文本长度 (.内容), 0))
        .如果 (不等于 (取文本长度 (.内容), 0))
            .如果 (等于 (相加 (“INSERT INTO pwd  (”, 数据库字段, “) values (”, 数据库内容, “ ) ”).执行 (), 假))
                信息框 (“添加失败”, #信息图标, “失败”)
                返回 ()
            .否则
                
            .如果结束
            信息框 (“添加成功”, #信息图标, “成功”)
        .否则
            信息框 (“密码不能为空”, #信息图标, “失败”)
        .如果结束
        
    .否则
        信息框 (“管理员名不能为空”, #信息图标, “失败”)
    .如果结束
    
.否则
    
.如果结束
“pwd.mdb”.打开MDB数据库 ()
赋值 (用户, “select * from pwd ”.查询 ())
.计次循环首 (取列数 (), 计次)
    相减 (取列数 (), 1).删除列 ()
.计次循环尾 ()
全部删除 ()
.插入列 (“管理员姓名”, 160, , , )
.插入列 (“密码”, 160, , , )
用户.到首记录 ()
.判断循环首 (等于 (用户.尾记录后 (), 假))
    .插入表项 (用户.读 (1), , , , )
    相减 (取表项数 (), 1).置标题 (1, 取重复文本 (8, “*”))
    用户.到后一记录 ()
.判断循环尾 ()
用户.关闭记录集 ()


.子程序 _密码修改_创建完毕, 空白型, , 
获取焦点 ()

.子程序 _取消_被单击, 空白型, , 
销毁 ()

.子程序 _修改_被单击, 空白型, , 
.局部变量 数据库内容, 文本型, , , 
.局部变量 数据库字段, 文本型, , , 
.局部变量 数据库, 整数型, , , 
.局部变量 用户, 整数型, , , 
.局部变量 计次, 整数型, , , 

“pwd.mdb”.打开MDB数据库 ()
赋值 (数据库字段, “用户名,密码”)
赋值 (数据库内容, 相加 (“'”, .内容, “',  '”, .内容, “'”))
数据库.到首记录 ()
赋值 (数据库, 相加 (“select * from pwd where 用户名='”, .内容, “'”).查询 ())
.如果 (等于 (数据库.读 (1), .内容))
    .如果 (等于 (数据库.读 (2), .内容))
        .如果 (等于 (.内容, .内容))
            .如果 (等于 (相加 (“update  pwd  set  密码=”, “'”, 删全部空 (.内容), “' where  用户名='”, 删全部空 (.内容), “'”).执行 (), 假))
                
                信息框 (“修改失败”, #信息图标, “失败”)
                返回 ()
            .否则
                信息框 (“修改成功”, #信息图标, “成功”)
            .如果结束
            
        .否则
            信息框 (“新口令和确认口令不一致，请重新输入”, #信息图标, “失败”)
        .如果结束
        
    .否则
        信息框 (“旧口令不对，请重新输入”, #信息图标, “失败”)
    .如果结束
    
.否则
    信息框 (“没有要修改的管理员，请重新输入”, #信息图标, “失败”)
.如果结束
“pwd.mdb”.打开MDB数据库 ()
赋值 (用户, “select * from pwd ”.查询 ())
.计次循环首 (取列数 (), 计次)
    相减 (取列数 (), 1).删除列 ()
.计次循环尾 ()
全部删除 ()
.插入列 (“管理员姓名”, 160, , , )
.插入列 (“密码”, 160, , , )
用户.到首记录 ()
.判断循环首 (等于 (用户.尾记录后 (), 假))
    .插入表项 (用户.读 (1), , , , )
    相减 (取表项数 (), 1).置标题 (1, 取重复文本 (8, “*”))
    用户.到后一记录 ()
.判断循环尾 ()
用户.关闭记录集 ()


.子程序 _修改_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.类型, 0)
赋值 (.类型, 1)

.子程序 _取消_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.类型, 0)
赋值 (.类型, 1)

.子程序 _密码修改_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.类型, 0)
赋值 (.类型, 0)

.子程序 _取消1_被单击, 空白型, , 
销毁 ()

.子程序 _按钮11_被单击, 空白型, , 
销毁 ()

.子程序 _结帐_被单击, 空白型, , 
.局部变量 用户, 整数型, , , 
.局部变量 数据库条件, 文本型, , , 
.局部变量 出库记录, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 库存记录, 整数型, , , 

复制文件 (“dianbiao.mdb”, “old_dianbiao.mdb”)
“dianbiao.mdb”.打开MDB数据库 ()
赋值 (用户, “select * from dianbiao ”.查询 ())
赋值 (数据库条件, 相加 (“领用情况”, “=”, “'已领用' or 作废情况”, “=”, “'作废'”))
.如果 (等于 (相加 (“delete from db_biao where ”, 数据库条件).执行 (), 假))
    信息框 (相加 (“delete from db_biao where ”, 数据库条件), 0, )
    信息框 (“删除失败”, #信息图标, “失败”)
    返回 ()
.否则
    信息框 (“删除成功”, #信息图标, “成功”)
.如果结束
_显示库存_被单击 ()

.子程序 _显示库存_被单击, 空白型, , 
.局部变量 出库记录, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 库存记录, 整数型, , , 

“dianbiao.mdb”.打开MDB数据库 ()
赋值 (库存记录, “select * from db_biao where 领用情况='未领用'and 作废情况<>'作废' ”.查询 ())
.计次循环首 (取列数 (), 计次)
    相减 (取列数 (), 1).删除列 ()
.计次循环尾 ()
全部删除 ()
.插入列 (“出厂号码”, 120, , , )
.插入列 (“电表型号”, 60, , , )
.插入列 (“电表名称”, 120, , , )
.插入列 (“制造厂家”, 120, , , )
.插入列 (“电压”, 60, , , )
.插入列 (“相数”, 60, , , )
.插入列 (“额定电流”, 60, , , )
.插入列 (“级别”, 60, , , )
.插入列 (“转数”, 60, , , )
.插入列 (“检定日期”, 100, , , )
.插入列 (“入库日期”, 100, , , )
.插入列 (“领用情况”, 60, , , )
.插入列 (“作废情况”, 60, , , )
.插入列 (“备注”, 120, , , )
库存记录.到首记录 ()
.判断循环首 (等于 (库存记录.尾记录后 (), 假))
    .插入表项 (库存记录.读 (1), , , , )
    相减 (取表项数 (), 1).置标题 (1, 库存记录.读 (2))
    相减 (取表项数 (), 1).置标题 (2, 库存记录.读 (19))
    相减 (取表项数 (), 1).置标题 (3, 库存记录.读 (3))
    相减 (取表项数 (), 1).置标题 (4, 库存记录.读 (4))
    相减 (取表项数 (), 1).置标题 (5, 库存记录.读 (5))
    相减 (取表项数 (), 1).置标题 (6, 库存记录.读 (6))
    相减 (取表项数 (), 1).置标题 (7, 库存记录.读 (7))
    相减 (取表项数 (), 1).置标题 (8, 库存记录.读 (8))
    相减 (取表项数 (), 1).置标题 (9, 库存记录.读 (9))
    相减 (取表项数 (), 1).置标题 (10, 时间到文本 (库存记录.读 (10), ))
    相减 (取表项数 (), 1).置标题 (11, 库存记录.读 (12))
    相减 (取表项数 (), 1).置标题 (12, 库存记录.读 (20))
    相减 (取表项数 (), 1).置标题 (13, 库存记录.读 (11))
    .到后一记录 ()
.判断循环尾 ()
库存记录.关闭记录集 ()


.窗口程序集 窗口程序集3, , , 

.子程序 _密码验证_可否被关闭, 逻辑型, , 
返回 (假)

.子程序 _密码验证_创建完毕, 空白型, , 
.局部变量 字段, 字段信息, , "10", 
.局部变量 通过, 整数型, , , 

获取焦点 ()
“pwd.mdb”.打开MDB数据库 ()
赋值 (通过, “select * from pwd”.查询 ())
通过.到首记录 ()
.判断循环首 (等于 (通过.尾记录后 (), 假))
    通过.读 (1).加入项目 ()
    通过.到后一记录 ()
.判断循环尾 ()
通过.关闭记录集 ()

.子程序 _口令验证框_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (不等于 (字符代码, #回车键))
    返回 (字符代码)
.如果真结束
密码验证 ()

.子程序 密码验证, 空白型, , 
.局部变量 验证密码, 整数型, , , 
.局部变量 用户名, 文本型, , , 
.局部变量 密码, 文本型, , , 
.局部变量 通过, 整数型, , , 

“pwd.mdb”.打开MDB数据库 ()
验证密码.到首记录 ()
赋值 (通过, 相加 (“select * from pwd where 用户名='”, .内容, “'”).查询 ())
.如果 (并且 (不等于 (.内容, “”), 不等于 (.内容, “”)))
    .如果 (等于 (删全部空 (.内容), 删全部空 (通过.读 (2))))
        载入 (_启动窗口, , 假)
        销毁 ()
    .否则
        赋值 (.标题, “对不起，口令错误，请重新输入！”)
        赋值 (.文本颜色, #红色)
    .如果结束
    
.否则
    赋值 (.标题, “对不起，用户名不能为空！”)
    赋值 (.文本颜色, #红色)
    
.如果结束


.子程序 _确定_被单击, 空白型, , 
密码验证 ()

.子程序 _取消_被单击, 空白型, , 
销毁 ()
_启动窗口.销毁 ()

.子程序 _确定_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.类型, 0)
赋值 (.类型, 1)

.子程序 _取消_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.类型, 0)
赋值 (.类型, 1)

.子程序 _密码验证_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.类型, 0)
赋值 (.类型, 0)

.子程序 _用户名验证框_获得焦点, 空白型, , 
赋值 (.文本颜色, #黑色)

.子程序 _口令验证框_获得焦点, 空白型, , 
赋值 (.文本颜色, #黑色)



 ' 不属于任何一个程序集、类模块的函数：
