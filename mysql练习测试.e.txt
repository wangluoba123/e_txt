 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 501
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 删除
    左边 = 50
    顶边 = 50
    宽度 = 540
    高度 = 416
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' mysql 7F54B9CE8887428dBA9CEEB94CEF4C72 3 0 MySQL支持库
 ' spec A512548E76954B6E92C21055517615B0 3 0 特殊功能支持库




.全局变量 数据库_句柄, 整数型, , , 

.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (数据库_句柄, 未知支持库函数_1 (“172.16.0.233”, “root”, “netbar”, “ces”, ))


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 局部_语句, 文本型, , , 
.局部变量 局部_测试记录集, 整数型, , , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 局部_文本, 文本型, , , 
.局部变量 字段名字, 文本型, , , 
.局部变量 ii, 整数型, , , 

赋值 (局部_语句, “select * from bg_01”)
未知支持库函数_3 (数据库_句柄, 局部_语句)
赋值 (记录集句柄, 未知支持库函数_4 (数据库_句柄))

.计次循环首 (未知支持库函数_7 (记录集句柄), )
    未知支持库函数_6 (记录集句柄, “bg_wj”, 局部_文本)
    调试输出 (局部_文本)
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (记录集句柄)



.子程序 _按钮2_被单击, 空白型, , 
.局部变量 取表名语句, 文本型, , , 
.局部变量 局部记录集_语句, 整数型, , , 
.局部变量 局部_文本, 文本型, , , 

赋值 (取表名语句, “show tables from ces”)
未知支持库函数_3 (数据库_句柄, 取表名语句)
赋值 (局部记录集_语句, 未知支持库函数_4 (数据库_句柄))

.计次循环首 (未知支持库函数_7 (局部记录集_语句), )
    未知支持库函数_6 (局部记录集_语句, “Tables_in_ces”, 局部_文本)
    调试输出 (局部_文本)
    未知支持库函数_10 (局部记录集_语句)
.计次循环尾 ()
未知支持库函数_5 (局部记录集_语句)


.子程序 _按钮3_被单击, 空白型, , 
.局部变量 取表头, 文本型, , , 
.局部变量 局部_语句, 整数型, , , 
.局部变量 局部_文本, 文本型, , , 

赋值 (取表头, “show full fields from ces.bg_01”)
未知支持库函数_3 (数据库_句柄, 取表头)
赋值 (局部_语句, 未知支持库函数_4 (数据库_句柄))

.计次循环首 (未知支持库函数_7 (局部_语句), )
    未知支持库函数_6 (局部_语句, “Field”, 局部_文本)
    调试输出 (局部_文本)
    未知支持库函数_10 (局部_语句)
.计次循环尾 ()
未知支持库函数_5 (局部_语句)


.子程序 _按钮4_被单击, 空白型, , 
.局部变量 添加记录, 文本型, , , 
.局部变量 局部_语句, 整数型, , , 

赋值 (添加记录, 相加 (“insert into ces.bg_01(bg_wj,bg_gl,bg_sm)values('”, .内容, “','”, .内容, “','”, .内容, “')”))
未知支持库函数_3 (数据库_句柄, 添加记录)


.子程序 _按钮5_被单击, 空白型, , 
.局部变量 局部_语句查询, 文本型, , , 
.局部变量 局部_测试记录集, 整数型, , , 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 i, 文本型, , , 
.局部变量 局部_文本, 文本型, , , 
.局部变量 字段名字, 文本型, , , 
.局部变量 ii, 整数型, , , 



赋值 (局部_语句查询, “SELECT 账号,超级管理员 FROM  ces.admin  WHERE 超级管理员='真'”)

未知支持库函数_3 (数据库_句柄, 局部_语句查询)
赋值 (记录集句柄, 未知支持库函数_4 (数据库_句柄))
.计次循环首 (未知支持库函数_7 (记录集句柄), )
    未知支持库函数_6 (记录集句柄, “超级管理员”, 局部_文本)
    赋值 (i, 局部_文本)
    未知支持库函数_10 (记录集句柄)
.计次循环尾 ()

.如果 (等于 (i, “真”))
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.标题, “超级管理员”)
    赋值 (.标题, “真”)
    
.否则
    
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.标题, “你不是超级管理员”)
    赋值 (.标题, “假”)
    
.如果结束

未知支持库函数_5 (记录集句柄)



.子程序 _按钮8_被单击, 空白型, , 
.局部变量 超级管理员, 文本型, , , 

.如果 (等于 (.选中, 真))
    赋值 (超级管理员, “UPDATE ces.admin SET 超级管理员 = '真'”)
    输出调试文本 (未知支持库函数_3 (数据库_句柄, 超级管理员))
    返回 ()
.否则
    赋值 (超级管理员, “UPDATE ces.admin SET 超级管理员 = '假'”)
    输出调试文本 (未知支持库函数_3 (数据库_句柄, 超级管理员))
    
.如果结束


.子程序 _按钮9_被单击, 空白型, , 
载入 (删除, , 真)


.窗口程序集 窗口程序集2, , , 

.子程序 _删除_创建完毕, 空白型, , 
刷新显示数据库 ()

.子程序 刷新显示数据库, 空白型, , 
.局部变量 记录集局部, 文本型, , , 
.局部变量 文件局部, 文本型, , , 
.局部变量 i, 整数型, , , 
.局部变量 取记录集句柄, 整数型, , , 

清空 ()
赋值 (记录集局部, “select * from bg_01”)
未知支持库函数_3 (数据库_句柄, 记录集局部)
赋值 (取记录集句柄, 未知支持库函数_4 (数据库_句柄))
.计次循环首 (未知支持库函数_7 (取记录集句柄), i)
    
    未知支持库函数_6 (取记录集句柄, “编号”, 文件局部)
    文件局部.加入项目 (i)
    输出调试文本 (文件局部)
    未知支持库函数_10 (取记录集句柄)
.计次循环尾 ()
未知支持库函数_5 (取记录集句柄)


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 取记录集句柄, 整数型, , , 
.局部变量 删除局部, 文本型, , , 

赋值 (删除局部, 相加 (“delete from ces.bg_01 where 编号 = '”, .取项目文本 (.现行选中项), “'”))
未知支持库函数_3 (数据库_句柄, 删除局部)
未知支持库函数_5 (取记录集句柄)
刷新显示数据库 ()


 ' 不属于任何一个程序集、类模块的函数：
