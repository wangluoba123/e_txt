 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 0
    顶边 = 0
    宽度 = 826
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 0
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 菜单项目设置 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 627
    高度 = 472
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “菜单项目设置”
    帮助文件名 = “”

窗口 用户权限设置 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 627
    高度 = 472
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “用户权限设置”
    帮助文件名 = “”

窗口 关于
    左边 = 50
    顶边 = 50
    宽度 = 436
    高度 = 316
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于...”
    帮助文件名 = “”

窗口 登录窗口
    左边 = 50
    顶边 = 50
    宽度 = 236
    高度 = 176
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “系统登陆”
    帮助文件名 = “”



.常量 程序名称, "“[世恒帮您学易]-用户权限设置”", , 
.常量 , , , 
.常量 管理员, "“管理员”", , 
.常量 密码, "“密码”", , 
.常量 密码提示, "“密码提示”", , 
.常量 密码提示答案, "“密码提示答案”", , 
.常量 注册时间, "“注册时间”", , 
.常量 管理员级别, "“管理员级别”", , 
.常量 登录次数, "“登录次数”", , 
.常量 上次登录时间, "“上次登录时间”", , 
.常量 系统设置, "“系统设置.edb”", , 
.图片 私钥, " ' 已保存到：D:\易语言学习\Data\[世恒帮您学易]-用户权限设置.e\私钥", , 
.常量 名称空, "“名称空”", , 
.常量 人数空, "“人数空”", , 
.常量 类别成功, "“类别成功”", , 
.常量 类别失败, "“类别失败”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' iext21 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' ExtMenu 9909FBB013704cfa8FE7E739DB7172DE 1 5 超级菜单支持库
 ' mysql 7F54B9CE8887428dBA9CEEB94CEF4C72 2 1 MySql支持库
 ' pop3 6639134E82344637A71AB1D6B70C2051 1 5 邮件接收支持库
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 1 1 高级表格支持库




数据类型 树, , 
    .成员 索引, 整数型, , , 
    .成员 名称, 文本型, , , 
    .成员 数值, 整数型, , , 
    .成员 编号, 文本型, , , 

.全局变量 查找表, 文本型, , , 
.全局变量 目标框, 超级列表框, , , 
.全局变量 库密码, 文本型, , , 
.全局变量 管理员组合框, 组合框, , , 
.全局变量 密码编辑框, 编辑框, , , 
.全局变量 注册, 空白型, , , 
.全局变量 第一次, 逻辑型, , , 
.全局变量 包含权限, 逻辑型, , , 
.全局变量 当前级别, 空白型, , , 
.全局变量 当前管理员, 文本型, , , 
.全局变量 显示的窗口, 窗口, , , 
.全局变量 记录集, 空白型, , , 
.全局变量 全局句柄, 空白型, , , 
.全局变量 配置名, 文本型, , , 
.全局变量 全局sql, 文本型, , , 
.全局变量 修改验证, 逻辑型, , , 
.全局变量 显示字段, 整数型, , "0", 
.全局变量 全局标记, 文本型, , , 
.全局变量 全局供应商, 文本型, , , 
.全局变量 显示字段1, 文本型, , "0", 
.全局变量 操作结束, 逻辑型, , , 
.全局变量 全局查找标记, 文本型, , , 
.全局变量 添加, 树, , "0", 
.全局变量 错误, 文本型, , , 
.全局变量 临时, 树, , , 
.全局变量 数值, 小数型, , , 
.全局变量 文本, 文本型, , , 
.全局变量 权限, 文本型, , "0", 
.全局变量 快捷, 文本型, , "0", 
.全局变量 当前管理员编号, 整数型, , , 
.全局变量 启动窗口左边, 空白型, , , 
.全局变量 启动窗口顶边, 空白型, , , 
.全局变量 启动窗口宽度, 空白型, , , 
.全局变量 启动窗口高度, 空白型, , , 
.全局变量 全局货品, 文本型, , , 
.全局变量 全局选择, 文本型, , , 
.全局变量 收到邮件, 未知类型0x70001, , , 
.全局变量 收到附件, 未知类型0x70002, , "0", 
.全局变量 POP, 文本型, , , 
.全局变量 时间, 日期时间型, , , 
.全局变量 smtp, 文本型, , , 
.全局变量 用户名, 文本型, , , 
.全局变量 密码, 文本型, , , 
.全局变量 地址, 文本型, , , 
.全局变量 全局编号, 文本型, , , 
.全局变量 全局组合, 文本型, , , 
.全局变量 全局类别表, 文本型, , , 
.全局变量 全局类别窗口, 窗口, , , 
.全局变量 全局类别树型框, 树型框, , , 
.全局变量 批号字段, 文本型, , , 
.全局变量 全局信息表, 文本型, , , 
.全局变量 目标框2, 超级列表框, , , 
.全局变量 目标框1, 超级列表框, , , 
.全局变量 根类名, 文本型, , , 
.全局变量 全局类别标记, 文本型, , , 
.全局变量 全局字段, 文本型, , "0", 

.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 标志, 逻辑型, , , 
.局部变量 空项, 整数型, , "0", 

 ' XP风格 (1)
未知函数_67179269 ()
载入 (真)

赋值 (.现行子夹, 0)
赋值 (包含权限, 真)
赋值 (.)

.子程序 __启动窗口_尺寸被改变, 空白型, , 
赋值 (.宽度, 取用户区宽度 ())
赋值 (.高度, 相减 (取用户区高度 (), .顶边, .))
赋值 (., .高度)
赋值 (., .顶边)
赋值 (., 相加 (.左边, .宽度))
赋值 (.左边, 相加 (., .))
赋值 (.宽度, 相减 (取用户区宽度 (), ., .))
赋值 (.高度, .高度)
赋值 (.左边, 相减 (., 2))
赋值 (.高度, .高度)
赋值 (.顶边, 相加 (相除 (相减 (., .高度), 2), ., 10))
赋值 (.左边, 相减 (.宽度, .宽度))
赋值 (.顶边, 0)
赋值 (.左边, 0)
连续赋值 (相减 (.高度, ., 2), ., ., .)
赋值 (.宽度, .宽度)
赋值 (.内容, 相加 (时间到文本 (取现行时间 (), #日期部分), “   星期”, 多项选择 (取星期几 (取现行时间 ()), “日”, “一”, “二”, “三”, “四”, “五”, “六”), “   ”))
赋值 (.高度, .高度)
赋值 (.宽度, .宽度)
赋值 (.左边, 1)
 ' 选择夹1.高度 ＝ 树型框11.高度
调整外形 (20, 20, 相减 (相除 (相乘 (.高度, 3), 8), 20), 相减 (相除 (相乘 (.宽度, 5), 8), 20))
调整外形 (20, 相加 (.顶边, .高度, 20), 相减 (相除 (相乘 (.高度, 2), 8), 20), 相减 (.宽度, 30))
调整外形 (相加 (.左边, .宽度, 20), 20, 相减 (相除 (相乘 (.高度, 3), 8), 20), 相减 (相除 (相乘 (.宽度, 3), 8), 30))
调整外形 (20, 相加 (.顶边, .高度, 10), 相减 (相除 (相乘 (.高度, 3), 8), 30), 相减 (.宽度, 30))
调整外形 (0, 0, .高度, 相减 (.宽度, 2))
赋值 (., 相减 (.高度, .高度, 5, .顶边))
赋值 (., 相减 (.宽度, 5))
赋值 (.宽度, .宽度)

.子程序 _分隔条1_被拖动, 空白型, , 
.参数 原位置, 整数型, , 
.参数 目的位置, 整数型, , 

.局部变量 wzc, 空白型, , , 

赋值 (wzc, 相减 (目的位置, 原位置))
赋值 (., 相加 (., wzc)) ' <!!!>
赋值 (.宽度, 相加 (.宽度, wzc))
__启动窗口_尺寸被改变 ()

.子程序 _工具条6_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 



.子程序 _树型框11_即将扩展, 逻辑型, , 
.参数 项目索引, 整数型, , 

清除数组 (添加)
读树型框数值 ()
.如果真 (项目索引.是否有子项目 ())
    .如果真 (等于 (相加 (项目索引, 1).取项目数值 (), -100))
        相加 (项目索引, 1).删除项目 ()
    .如果真结束
    
.如果真结束
类别树启动1 (全局句柄, “sale_sys_menu  ”, 项目索引, 项目索引.取项目数值 (), “名称”, “编号”, , “状态图片”, “状态图片”)


.子程序 _树型框11_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 



.子程序 _按钮3_被单击, 空白型, , 
.判断开始 (等于 (.标题, “<”))
    赋值 (.宽度, 4)
    赋值 (.标题, “>”)
.默认
    赋值 (.宽度, 200)
    赋值 (.标题, “<”)
.判断结束
__启动窗口_尺寸被改变 ()

.子程序 _树型框11_双击项目, 空白型, , 
 ' _树型框11_项目被选择 (0)
.判断开始 (未知支持库函数_3 (全局句柄, 相加 (“select * from sale_sys_menu   where `编号`=”, 到文本 (.取项目数值 (.最大化按钮)))))
    赋值 (记录集, 未知支持库函数_4 (全局句柄))
    未知支持库函数_12 (记录集)
    赋值 (文本, “”)
    .如果真 (未知支持库函数_6 (记录集, “工作路径”, 文本))
        .判断开始 (等于 (取文本左边 (文本, 1), “@”))
            赋值 (数值, 0)
            .如果真 (未知支持库函数_6 (记录集, “编号”, 数值))
                事件驱动 ()
            .如果真结束
            
        .默认
            未知支持库函数_6 (4, 文本, , 取运行目录 ())
        .判断结束
        
    .如果真结束
    
.默认
    
.判断结束


.子程序 _超级列表框1_表项被激活, 空白型, , 

.判断开始 (未知支持库函数_3 (全局句柄, 相加 (“select * from sys_menu where `编号`=”, 到文本 (.取表项数值 (.)))))
    赋值 (记录集, 未知支持库函数_4 (全局句柄))
    未知支持库函数_12 (记录集)
    赋值 (文本, “”)
     ' 信息框 (超级列表框1.取表项数值 (超级列表框1.现行选中项), 0, )
    .判断开始 (未知支持库函数_6 (记录集, “工作路径”, 文本))
        .判断开始 (等于 (取文本左边 (文本, 1), “@”))
            赋值 (数值, 0)
            .判断开始 (未知支持库函数_6 (记录集, “编号”, 数值))
                
            .默认
                
            .判断结束
            事件驱动 ()
            
        .默认
            未知支持库函数_6 (4, 文本, , 取运行目录 ())
            
        .判断结束
        
    .默认
        
    .判断结束
    
.默认
    
.判断结束


.子程序 _超级按钮2_被单击, 空白型, , 
 ' 载入 (登录窗口, , 真)


.子程序 _超级按钮3_被单击, 空白型, , 
__启动窗口_可否被关闭 ()

.子程序 _超级按钮1_被单击, 空白型, , 


.子程序 __启动窗口_可否被关闭, 逻辑型, , 
.判断开始 (等于 (信息框 (“是否确定要退出程序”, 相加 (1, #信息图标), ), #确认钮))
    保存设置 ()
    结束 ()
.默认
    返回 (假)
.判断结束


.子程序 _工具条_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.判断开始 (等于 (按钮索引.取标题 (), “退出”))
    销毁 ()
.判断 (等于 (按钮索引.取标题 (), “帮助”))
    信息框 (“制作中...”, 0, )
.判断 (等于 (按钮索引.取标题 (), “刷新”))
     ' _'组合管理树型框_双击项目1' ()
.判断 (等于 (按钮索引.取标题 (), “打印”))
    写注册项 (#现行用户, “software\打印设置\标题”, “供应商信息表”)
     ' 写注册项 (#现行用户, “software\打印设置\页眉”, “类别：” ＋ 组合管理树型框.取项目文本 (组合管理树型框.现行选中项))
     ' 打印超级列表框 (超级列表框1)
    .未知支持库函数_46 (.标题, “”, 24, 真, 2)
    未知支持库函数_27 ()
    重画 ()
     ' 高级表格1.可视 ＝ 假
     ' 高级表格1.可视 ＝ 真
.判断 (等于 (按钮索引.取标题 (), “导出”))
     ' 超级列表框TOExcel (超级列表框1)
.判断 (等于 (按钮索引.取标题 (), “设定”))
     ' 全局字段 ＝ { “销售编号”, “交易类别”, “楼号”, “交易日期”, “建筑类型”, “销售客户”, “建筑区域 ”, “成交单价”, “成交面积”, “应付金额 ”, “本次付款”, “按揭比例”, “合同编号”, “售楼人员”, “付款科目” }
    
    
     ' 通用查找 (供应商管理, “供应商”, “gys_xx”, 超级列表框1)
.判断 (等于 (按钮索引.取标题 (), “保存”))
    
.判断 (等于 (按钮索引.取标题 (), “编辑”))
    
.判断 (等于 (按钮索引.取标题 (), “设置”))
    
.判断 (等于 (按钮索引.取标题 (), “查看”))
    
.默认
    
.判断结束


.子程序 __启动窗口_被激活, 空白型, , 
重画 ()


.子程序 _日期框1_选择日期被改变, 空白型, , 
赋值 (全局字段, { “id”, “售楼人员”, “销售客户”, “楼号”, “成交单价”, “成交面积”, “成交总价”, “付款方式”, “按揭比例”, “本次付款”, “建筑区域 ”, “交易日期”, “备注信息 ” })
初始化表 (相加 (“select * from sale_info where `付款科目`='001' and `交易日期` between '”, 格式时间 (_启动窗口..今天), “' and '”, 格式时间 (_启动窗口..今天), “'”), 全局字段, _启动窗口.)


.子程序 _日期框2_选择日期被改变, 空白型, , 
赋值 (全局字段, { “id”, “售楼人员”, “销售客户”, “楼号”, “成交单价”, “成交面积”, “成交总价”, “付款方式”, “按揭比例”, “本次付款”, “建筑区域 ”, “交易日期”, “备注信息 ” })
初始化表 (相加 (“select * from sale_info where `付款科目`='001' and `交易日期` between '”, 格式时间 (_启动窗口..今天), “' and '”, 格式时间 (_启动窗口..今天), “'”), 全局字段, _启动窗口.)


.程序集 公共程序集, , , 

.子程序 关于, 空白型, 公开, 
.参数 软件名称, 文本型, , 
.参数 操作系统, 文本型, , 
.参数 版本号, 文本型, , 
.参数 作者, 文本型, , 
.参数 版权, 文本型, , 
.参数 使用单位, 文本型, , 
.参数 开发语言, 文本型, , 
.参数 数据库, 文本型, , 

载入 (关于, , 假)
赋值 (关于..标题, 软件名称)
赋值 (关于..标题, 操作系统)
赋值 (关于..标题, 版本号)
赋值 (关于..标题, 作者)
赋值 (关于..标题, 版权)
关于.加入文本 (., 相加 (取主机名 (), #换行符, 使用单位, #换行符, “Product ID: 04800221-100-”, 选择 (大于 (取硬盘特征字 (), 0), 到文本 (取硬盘特征字 ()), “1980221”)))
赋值 (关于..标题, 开发语言)
赋值 (关于..标题, 数据库)

.子程序 类别树启动1, 空白型, , 
.参数 局部句柄, 整数型, , 
.参数 表, 文本型, , 
.参数 当前索引, 整数型, , 
.参数 当前编号, 整数型, , 
.参数 当前字段, 文本型, , 
.参数 数值编号, 文本型, , 
.参数 树, 树型框, , 
.参数 图片, 文本型, 可空, 
.参数 选中图片, 文本型, 可空, 
.参数 类别, 整数型, 可空, 

.局部变量 记次, 空白型, , , 
.局部变量 次数, 空白型, , , 
.局部变量 标志, 逻辑型, , , 
.局部变量 记次1, 整数型, , , 
.局部变量 数值1, 整数型, , , 
.局部变量 数值2, 整数型, , , 
.局部变量 记录集11, 空白型, , , 
.局部变量 aa, 空白型, , , 
.局部变量 j, 空白型, , , 

处理事件 () ' 给出机会以接收停止按钮事件。
未知支持库函数_5 (记录集)
.判断循环首 (大于 (树.取缩进层次 (相加 (当前索引, 1)), 树.取缩进层次 (当前索引)))
    树.删除项目 (相加 (当前索引, 1))
    处理事件 ()
.判断循环尾 ()
.判断开始 (是否为空 (类别))
    未知支持库函数_3 (局部句柄, 相加 (“select * from ”, 表, “ where `上级`=”, 到文本 (当前编号), “ order by id”))
    
.默认
    未知支持库函数_3 (局部句柄, 相加 (“select * from ”, 表, “ where `上级`=”, 到文本 (当前编号), “ and `类别`=”, 到文本 (类别), “ order by id”))
    
.判断结束
赋值 (记录集, 未知支持库函数_4 (局部句柄))
未知支持库函数_12 (记录集)
.计次循环首 (未知支持库函数_7 (记录集), 记次)
    处理事件 ()
    赋值 (数值, 0)
    .判断开始 (未知支持库函数_6 (记录集, 数值编号, 数值))
        赋值 (文本, “”)
        .判断开始 (未知支持库函数_6 (记录集, 当前字段, 文本))
            赋值 (标志, 假)
            .判断开始 (等于 (是否为空 (图片), 假))
                .判断开始 (未知支持库函数_6 (记录集, 图片, 数值1))
                    
                .默认
                    
                .判断结束
                
            .默认
                
            .判断结束
            .判断开始 (等于 (是否为空 (选中图片), 假))
                .判断开始 (未知支持库函数_6 (记录集, 选中图片, 数值2))
                    
                .默认
                    
                .判断结束
                
            .默认
                
            .判断结束
             ' .计次循环首 (取数组成员数 (添加), 记次1)
                 ' .判断开始 (等于 (添加 [记次1], 数值, 数值))
                     ' 标志 ＝ 真
                     ' 跳出循环 ()
                .默认
                    
                .判断结束
                
             ' .计次循环尾 ()
            .判断开始 (等于 (标志, 假))
                .判断开始 (包含权限)
                    赋值 (标志, 假)
                     ' 信息框 (树型框11.取项目数值 (i － 1), 0, )
                    .计次循环首 (取数组成员数 (权限), j)
                         ' 信息框 (树型框11.取项目数值 (i － 1), 0, )
                        .判断开始 (等于 (数值, 到数值 (权限 [j])))
                            赋值 (标志, 真)
                            跳出循环 ()
                        .默认
                            
                        .判断结束
                        
                    .计次循环尾 ()
                    .判断开始 (等于 (标志, 假))
                         ' 信息框 (1, 0, )
                         ' 树型框11.置项目数值 (i － 1, -100)
                         ' 信息框 (i, 0, )
                        
                    .默认
                        赋值 (aa, 树.加入项目 (当前索引, 文本, 数值1, 数值2, 数值))
                        未知支持库函数_5 (记录集11)
                        .判断开始 (是否为空 (类别))
                            未知支持库函数_3 (局部句柄, 相加 (“select * from ”, 表, “ where `上级`=”, 到文本 (数值), “ order by id”))
                        .默认
                            未知支持库函数_3 (局部句柄, 相加 (“select * from ”, 表, “ where `上级`=”, 到文本 (数值), “ and `类别`=”, 到文本 (类别), “ order by id”))
                        .判断结束
                        
                        
                        赋值 (记录集11, 未知支持库函数_4 (局部句柄))
                        .判断开始 (大于 (未知支持库函数_7 (记录集11), 0))
                            树.加入项目 (aa, “正在读取列表...”, , , -100)
                             ' 当前索引 ＝ 当前索引 ＋ 1
                        .默认
                            
                        .判断结束
                        赋值 (临时.数值, 数值)
                        赋值 (临时.索引, 数值)
                        赋值 (临时.名称, 文本)
                        加入成员 (添加, 临时)
                        
                    .判断结束
                    
                .默认
                    赋值 (aa, 树.加入项目 (当前索引, 文本, 数值1, 数值2, 数值))
                    未知支持库函数_5 (记录集11)
                    .判断开始 (是否为空 (类别))
                        未知支持库函数_3 (局部句柄, 相加 (“select * from ”, 表, “ where `上级`=”, 到文本 (数值), “ order by id”))
                    .默认
                        未知支持库函数_3 (局部句柄, 相加 (“select * from ”, 表, “ where `上级`=”, 到文本 (数值), “ and `类别`=”, 到文本 (类别), “ order by id”))
                    .判断结束
                    
                    赋值 (记录集11, 未知支持库函数_4 (局部句柄))
                    .判断开始 (大于 (未知支持库函数_7 (记录集11), 0))
                        树.加入项目 (aa, “正在读取列表...”, , , -100)
                         ' 当前索引 ＝ 当前索引 ＋ 1
                    .默认
                        
                    .判断结束
                    赋值 (临时.数值, 数值)
                    赋值 (临时.索引, 数值)
                    赋值 (临时.名称, 文本)
                    加入成员 (添加, 临时)
                    
                .判断结束
                
                
                
            .默认
                
            .判断结束
            
        .默认
            
        .判断结束
        
    .默认
        
    .判断结束
    未知支持库函数_10 (记录集)
    
.计次循环尾 ()
未知支持库函数_5 (记录集)
 ' 输出调试文本 (“文本”)


.子程序 初始化表, 空白型, , 
.参数 条件, 文本型, , 
.参数 字段, 文本型, 数组, 
.参数 目标表格, 未知类型0x90001, , 

.局部变量 j1, 空白型, , , 
.局部变量 i, 空白型, , , 

 ' 名称 ＝ { “厨房门”, “客卫生间门1”, “客卫生间门2”, “主卫生间”, “主卧门”, “书房门”, “次卧门1”, “次卧门2”, “步入式衣柜门”, “”, “主卧窗套”, “书房窗套”, “次卧窗套”, “客厅窗套”, “”, “入户门套”, “阳台门套”, “” }
 ' 高 ＝ { 2185, 1960, 1970, 1960, 1965, 1965, 1965, 1965, 2185 }
 ' 重定义数组 (高, 真, 取数组成员数 (名称))
 ' 宽 ＝ { 0, 700, 700, 700, 870, 870, 870, 870, 0 }
 ' 重定义数组 (宽, 真, 取数组成员数 (名称))
备注 ＝ { “”, “外间门”, “内间门” }
 ' 重定义数组 (备注, 真, 取数组成员数 (名称))
未知支持库函数_5 (记录集)
.判断开始 (未知支持库函数_3 (全局句柄, 条件))
    赋值 (记录集, 未知支持库函数_4 (全局句柄))
    未知支持库函数_12 (记录集)
.默认
    
.判断结束
赋值 (目标表格., 相加 (未知支持库函数_7 (记录集), 1))
目标表格.未知支持库函数_31 (0, 24)
赋值 (目标表格., 1)
赋值 (目标表格., 取数组成员数 (字段))
.计次循环首 (取数组成员数 (字段), j1)
    目标表格.未知支持库函数_9 (0, 相减 (j1, 1), #, 字段 [j1])
    .判断开始 (大于 (j1, 1))
        目标表格.未知支持库函数_30 (相减 (j1, 1), #)
        目标表格.未知支持库函数_32 (相减 (j1, 1), 90)
    .默认
        目标表格.未知支持库函数_30 (相减 (j1, 1), #)
    .判断结束
    
.计次循环尾 ()
.计次循环首 (未知支持库函数_7 (记录集), j1)
    .计次循环首 (目标表格., i)
        .判断开始 (等于 (i, 1))
            赋值 (数值, 0)
            .判断开始 (未知支持库函数_6 (记录集, 字段 [i], 数值))
                目标表格.未知支持库函数_9 (j1, 相减 (i, 1), #, 到文本 (数值))
            .默认
                
            .判断结束
            
        .默认
            赋值 (文本, “”)
            .判断开始 (未知支持库函数_6 (记录集, 字段 [i], 文本))
                目标表格.未知支持库函数_9 (j1, 相减 (i, 1), #, 文本)
            .默认
                
            .判断结束
            
        .判断结束
        处理事件 ()
    .计次循环尾 ()
    未知支持库函数_10 (记录集)
.计次循环尾 ()
 ' 目标表格.置列宽 (0, 50)

.子程序 类别树文本编号, 空白型, , 
.参数 局部句柄, 整数型, , 
.参数 表, 文本型, , 
.参数 当前索引, 整数型, , 
.参数 当前编号, 文本型, , 
.参数 当前字段, 文本型, , 
.参数 数值编号, 文本型, , 
.参数 树, 树型框, , 
.参数 图片, 文本型, 可空, 
.参数 选中图片, 文本型, 可空, 
.参数 类别, 整数型, 可空, 

.局部变量 记次, 空白型, , , 
.局部变量 次数, 空白型, , , 
.局部变量 标志, 逻辑型, , , 
.局部变量 记次1, 整数型, , , 
.局部变量 数值1, 整数型, , , 
.局部变量 数值2, 整数型, , , 
.局部变量 记录集11, 空白型, , , 
.局部变量 aa, 空白型, , , 
.局部变量 j, 空白型, , , 
.局部变量 文本1, 文本型, , , 

处理事件 () ' 给出机会以接收停止按钮事件。
.判断循环首 (大于 (树.取缩进层次 (相加 (当前索引, 1)), 树.取缩进层次 (当前索引)))
    树.删除项目 (相加 (当前索引, 1))
    处理事件 ()
.判断循环尾 ()
未知支持库函数_5 (记录集)
.判断开始 (是否为空 (类别))
    未知支持库函数_3 (局部句柄, 相加 (“select * from ”, 表, “ where `上级编号`='”, 到文本 (当前编号), “' order by id”))
.默认
    未知支持库函数_3 (局部句柄, 相加 (“select * from ”, 表, “ where `上级编号`='”, 到文本 (当前编号), “' and `类别`=”, 到文本 (类别), “ order by id”))
    输出调试文本 (相加 (“select * from ”, 表, “ where `上级编号`='”, 到文本 (当前编号), “' and `类别`=”, 到文本 (类别), “ order by id”))
.判断结束
赋值 (记录集, 未知支持库函数_4 (局部句柄))
未知支持库函数_12 (记录集)
输出调试文本 (未知支持库函数_7 (记录集))
.计次循环首 (未知支持库函数_7 (记录集), 记次)
    处理事件 ()
    赋值 (数值, 0)
    .判断开始 (未知支持库函数_6 (记录集, 数值编号, 数值))
        赋值 (文本1, “”)
        .如果真 (未知支持库函数_6 (记录集, “类别编号”, 文本1))
        .如果真结束
        
        .判断开始 (未知支持库函数_6 (记录集, 当前字段, 文本))
            赋值 (标志, 假)
            .判断开始 (等于 (是否为空 (图片), 假))
                .判断开始 (未知支持库函数_6 (记录集, 图片, 数值1))
                    
                .默认
                    
                .判断结束
                
            .默认
                
            .判断结束
            .判断开始 (等于 (是否为空 (选中图片), 假))
                .判断开始 (未知支持库函数_6 (记录集, 选中图片, 数值2))
                    
                .默认
                    
                .判断结束
                
            .默认
                
            .判断结束
            赋值 (标志, 假)
             ' .计次循环首 (取数组成员数 (添加), 记次1)
                 ' 输出调试文本 (添加 [记次1].编号)
                 ' .判断开始 (等于 (添加 [记次1], 编号, 文本1))
                     ' 标志 ＝ 真
                     ' 跳出循环 ()
                .默认
                    
                .判断结束
                
             ' .计次循环尾 ()
            .判断开始 (等于 (标志, 假))
                赋值 (标志, 假)
                赋值 (aa, 树.加入项目 (当前索引, 相加 (文本1, “ ”, 文本), 数值1, 数值2, 数值))
                未知支持库函数_5 (记录集11)
                .判断开始 (是否为空 (类别))
                    未知支持库函数_3 (局部句柄, 相加 (“select * from ”, 表, “ where `上级编号`='”, 文本1, “' order by id”))
                .默认
                    未知支持库函数_3 (局部句柄, 相加 (“select * from ”, 表, “ where `上级编号`='”, 文本1, “' and `类别`=”, 到文本 (类别), “ order by id”))
                    输出调试文本 (相加 (“select * from ”, 表, “ where `上级编号`='”, 文本1, “' and `类别`=”, 到文本 (类别), “ order by id”))
                    
                .判断结束
                赋值 (记录集11, 未知支持库函数_4 (局部句柄))
                .判断开始 (大于 (未知支持库函数_7 (记录集11), 0))
                    树.加入项目 (aa, “正在读取列表...”, , , -100)
                     ' 当前索引 ＝ 当前索引 ＋ 1
                .默认
                    
                .判断结束
                赋值 (临时.数值, 数值)
                赋值 (临时.索引, 数值)
                赋值 (临时.名称, 文本)
                赋值 (临时.编号, 文本1)
                加入成员 (添加, 临时)
                
                
                
                
                
                
            .默认
                
            .判断结束
            
        .默认
            
        .判断结束
        
    .默认
        
    .判断结束
    未知支持库函数_10 (记录集)
    
.计次循环尾 ()
未知支持库函数_5 (记录集)

.子程序 读树型框数值, 空白型, , 
.参数 树型框, 树型框, , 

.局部变量 i, 空白型, , , 

清除数组 (添加)
.计次循环首 (树型框.取项目数 (), i)
    赋值 (临时.数值, 树型框.取项目数值 (相减 (i, 1)))
    赋值 (临时.索引, 树型框.取项目数值 (相减 (i, 1)))
    赋值 (临时.名称, 树型框.取项目文本 (相减 (i, 1)))
    加入成员 (添加, 临时)
.计次循环尾 ()

.子程序 事件驱动, 空白型, , 
.局部变量 j, 空白型, , , 

赋值 (根类名, _启动窗口.取项目文本 (., _启动窗口..最大化按钮))
.判断开始 (等于 (数值, 1004))
    信息框 (“别着急，正在做呢。。。”, #信息图标, )
.判断 (等于 (数值, 1005))
    信息框 (“别着急，正在做呢。。。”, #信息图标, )
.判断 (等于 (数值, 1006))
    信息框 (“别着急，正在做呢。。。”, #信息图标, )
.判断 (等于 (数值, 1007))
    信息框 (“别着急，正在做呢。。。”, #信息图标, )
.判断 (等于 (数值, 10061))
    载入 (菜单项目设置, , 真)
.判断 (等于 (数值, 10062))
    载入 (用户权限设置, , 真)
.判断 (等于 (数值, 10062))
    载入 (用户权限设置, , 真)
.判断 (并且 (大于或等于 (数值, 10011), 小于或等于 (数值, 10023)))
    赋值 (全局标记, “类别管理”)
    赋值 (全局类别标记, 到文本 (_启动窗口.取项目数值 (., _启动窗口..最大化按钮)))
.判断 (等于 (数值, 10066))
    
.判断 (等于 (数值, 10080))
    
.判断 (并且 (大于或等于 (数值, 10084), 小于或等于 (数值, 10096)))
    赋值 (_启动窗口..现行子夹, 1)
    赋值 (全局标记, “报表管理”)
    赋值 (_启动窗口..标题, 根类名)
    .判断开始 (等于 (数值, 10084))
        赋值 (全局字段, { “id”, “售楼人员”, “销售客户”, “楼号”, “成交单价”, “成交面积”, “成交总价”, “付款方式”, “按揭比例”, “本次付款”, “建筑区域 ”, “交易日期”, “备注信息 ” })
        初始化表 (相加 (“select * from sale_info where `付款科目`='001' and `交易日期` between '”, 格式时间 (_启动窗口..今天), “' and  '”, 格式时间 (_启动窗口..今天), “'”), 全局字段, _启动窗口.)
    .默认
        
    .判断结束
    
    
.默认
    
.判断结束


.子程序 列表1, 空白型, , 
.参数 条件, 文本型, , 
.参数 超级列表框, 超级列表框, , 
.参数 字段, 文本型, 数组, 

.局部变量 sql, 文本型, , , 
.局部变量 i, 空白型, , , 
.局部变量 j, 空白型, , , 
.局部变量 wb, 文本型, , , 
.局部变量 t, 空白型, , , 
.局部变量 id, 空白型, , , 

赋值 (操作结束, 假)
未知支持库函数_5 (记录集)
未知支持库函数_3 (全局句柄, 条件)
赋值 (记录集, 未知支持库函数_4 (全局句柄))

赋值 (超级列表框., {  })
赋值 (超级列表框., {  })
.计次循环首 (取数组成员数 (字段), j)
    赋值 (wb, 字段 [j])
     ' 序号到字段名 (记录集, 字段 [j] － 1, wb)
    超级列表框.插入列 (wb, 80, , , )
.计次循环尾 ()
未知支持库函数_12 (记录集)
.计次循环首 (未知支持库函数_7 (记录集), i)
    赋值 (id, 0)
    .判断开始 (未知支持库函数_6 (记录集, “id”, id))
        
    .默认
        
    .判断结束
    .计次循环首 (取数组成员数 (字段), j)
        .判断开始 (等于 (j, 1))
            赋值 (wb, “”)
            .判断开始 (未知支持库函数_6 (记录集, 字段 [j], wb))
                赋值 (t, 超级列表框.插入表项 (wb, , , , id))
            .默认
                
            .判断结束
            
        .默认
            赋值 (wb, “”)
            .判断开始 (未知支持库函数_6 (记录集, 字段 [j], wb))
                超级列表框.置标题 (t, 相减 (j, 1), wb)
            .默认
                
            .判断结束
            
        .判断结束
         ' 输出调试文本 (到文本 (字段 [j]))
    .计次循环尾 ()
    未知支持库函数_10 (记录集)
    处理事件 ()
    
.计次循环尾 ()
赋值 (操作结束, 真)


.子程序 格式时间, 文本型, , 
.参数 时间, 日期时间型, , 

.局部变量 年, 空白型, , , 
.局部变量 月, 空白型, , , 
.局部变量 日, 空白型, , , 

赋值 (年, 取时间部分 (时间, #年份))
赋值 (月, 取时间部分 (时间, #月份))
赋值 (日, 取时间部分 (时间, #日))
返回 (相加 (到文本 (年), “-”, 到文本 (月), “-”, 到文本 (日)))

.子程序 显示管理员, 空白型, , 
.参数 超级列表框, 超级列表框, , 
.参数 选择夹, 选择夹, 可空, 

.局部变量 i, 空白型, , , 
.局部变量 j, 空白型, , , 

.判断开始 (等于 (是否为空 (选择夹), 假))
    赋值 (选择夹.现行子夹, 0)
.默认
    
    
.判断结束
超级列表框.全部删除 ()
未知支持库函数_5 (记录集)
未知支持库函数_3 (全局句柄, “select * from gly”)
赋值 (记录集, 未知支持库函数_4 (全局句柄))
赋值 (j, 0)
库路径 ＝ “data\”
如果 (判断数据库 (#管理员, “管理员”))
管理员列表.置列标题 (0, 取字段名 (1))
.计次循环首 (未知支持库函数_7 (记录集), i)
    赋值 (文本, “”)
    
    赋值 (数值, 0)
    
    .判断开始 (未知支持库函数_6 (记录集, “id”, 数值))
        
        
    .默认
        
    .判断结束
    .判断开始 ()

.子程序 快捷方式, 空白型, , 
.参数 局部句柄, 整数型, , 
.参数 表, 文本型, , 
.参数 当前字段, 文本型, , 
.参数 数值编号, 文本型, , 
.参数 超级列表框, 超级列表框, , 
.参数 图片, 文本型, 可空, 
.参数 选中图片, 文本型, 可空, 

.局部变量 记次, 空白型, , , 
.局部变量 记次1, 整数型, , , 
.局部变量 数值1, 整数型, , , 
.局部变量 数值2, 整数型, , , 
.局部变量 i, 空白型, , , 

.计次循环首 (取数组成员数 (快捷), i)
    处理事件 () ' 给出机会以接收停止按钮事件。
    未知支持库函数_5 (记录集)
    未知支持库函数_3 (局部句柄, 相加 (“select * from ”, 表, “ where `编号`=”, 到文本 (快捷 [i]), “ order by id”))
    赋值 (记录集, 未知支持库函数_4 (局部句柄))
    未知支持库函数_12 (记录集)
    .计次循环首 (未知支持库函数_7 (记录集), 记次)
        处理事件 ()
        赋值 (数值, 0)
        .判断开始 (未知支持库函数_6 (记录集, 数值编号, 数值))
            赋值 (文本, “”)
            .判断开始 (未知支持库函数_6 (记录集, 当前字段, 文本))
                .判断开始 (等于 (是否为空 (图片), 假))
                    .判断开始 (未知支持库函数_6 (记录集, 图片, 数值1))
                        
                    .默认
                        
                    .判断结束
                    
                .默认
                    
                .判断结束
                .判断开始 (等于 (是否为空 (选中图片), 假))
                    .判断开始 (未知支持库函数_6 (记录集, 选中图片, 数值2))
                        
                    .默认
                        
                    .判断结束
                    
                .默认
                    
                .判断结束
                
                超级列表框.插入表项 (文本, 数值1, 数值2, , 数值)
                
            .默认
                
            .判断结束
            
        .默认
            
        .判断结束
        
    .计次循环尾 ()
    
.计次循环尾 ()


.子程序 读树型框, 空白型, , 
.参数 树型框, 树型框, , 

.局部变量 i, 空白型, , , 

清除数组 (添加)
.计次循环首 (树型框.取项目数 (), i)
    赋值 (临时.数值, 树型框.取项目数值 (相减 (i, 1)))
    赋值 (临时.索引, 树型框.取项目数值 (相减 (i, 1)))
    赋值 (临时.名称, 树型框.取项目文本 (相减 (i, 1)))
    加入成员 (添加, 临时)
.计次循环尾 ()


.子程序 调整外形, 空白型, , 
.参数 外型框, 外形框, , 
.参数 标签, 标签, , 
.参数 超级列表框, 超级列表框, 可空, 
.参数 月历, 月历, 可空, 
.参数 左边, 空白型, , 
.参数 顶边, 空白型, , 
.参数 高度, 空白型, , 
.参数 宽度, 空白型, , 

赋值 (外型框.宽度, 宽度)
赋值 (标签.宽度, 外型框.宽度)
赋值 (外型框.高度, 高度)
.判断开始 (等于 (是否为空 (超级列表框), 假))
    赋值 (超级列表框.倾斜, 外型框.宽度)
    赋值 (超级列表框.删除线, 相减 (外型框.高度, 标签.高度))
.默认
    
.判断结束
.判断开始 (等于 (是否为空 (月历), 假))
    赋值 (月历.宽度, 相减 (外型框.宽度, 2))
    赋值 (月历.高度, 相减 (外型框.高度, 标签.高度, 2))
.默认
    
.判断结束

赋值 (外型框.左边, 左边)
赋值 (外型框.顶边, 顶边)

.子程序 读权限, 空白型, , 
.参数 管理员, 文本型, , 

未知支持库函数_5 (记录集)
未知支持库函数_3 (相加 (“select * from gly where `管理员`='”, 到文本 (), “'”))
赋值 (未知支持库函数_4 ())
未知支持库函数_12 (记录集)
赋值 (文本, “”)
.判断开始 (未知支持库函数_6 (记录集, “权限”, 文本))
    赋值 (权限, 分割文本 (文本, “,”, ))
.默认
    
.判断结束
赋值 (文本, “”)
.判断开始 (未知支持库函数_6 (记录集, “快捷”, 文本))
    赋值 (快捷, 分割文本 (文本, “,”, ))
.默认
    
.判断结束


.子程序 连接数据库, 空白型, , 
.局部变量 database, 文本型, , , 
.局部变量 name, 文本型, , , 
.局部变量 password, 文本型, , , 
.局部变量 server, 文本型, , , 
.局部变量 port, 文本型, , , 

赋值 (配置名, 相加 (取运行目录 (), “\sys_gsgl.ini”))
赋值 (server, 读配置项 (配置名, “odbc”, “server”, ))
赋值 (database, 读配置项 (配置名, “odbc”, “database”, ))
赋值 (name, 读配置项 (配置名, “odbc”, “name”, ))
赋值 (password, 读配置项 (配置名, “odbc”, “password”, ))
赋值 (port, 读配置项 (配置名, “odbc”, “port”, ))
赋值 (全局句柄, 未知支持库函数_1 (server, name, password, database, 到数值 (port)))
.如果真 (或者 (小于或等于 (全局句柄, 0), 等于 (文件是否存在 (配置名), 假)))
    .判断开始 (等于 (信息框 (“连接数据库失败，是否现在设置数据库?”, 相加 (#错误图标, #是否钮), ), #是钮))
        结束 ()
    .默认
        结束 ()
    .判断结束
    
.如果真结束


.窗口程序集 窗口程序集6, , , 

.程序集变量 匿名程序集变量_636, 空白型, , , 
.子程序 _分隔条1_被拖动, 空白型, , 
.参数 原位置, 整数型, , 
.参数 目的位置, 整数型, , 

.局部变量 wzc, 空白型, , , 

赋值 (wzc, 相减 (目的位置, 原位置))
赋值 (., 相加 (., wzc)) ' <!!!>
赋值 (.左边, 相加 (.左边, wzc)) ' <!!!>
赋值 (.宽度, 相加 (.宽度, wzc))
赋值 (.宽度, 相减 (.宽度, wzc))

.子程序 _菜单项目设置_创建完毕, 空白型, , 
.局部变量 图片组, 字节集, , , 
.局部变量 i, 空白型, , , 

 ' 赋值 (., 真)
赋值 (操作结束, 假)
赋值 (.图标, {  })
清除数组 (添加)
类别树启动1 (全局句柄, “sale_sys_menu”, -1, 0, “名称”, “编号”, , “状态图片”, “选中图片”)
赋值 (操作结束, 真)
赋值 (图片组, 未知支持库函数_30 (32, 32))
赋值 (., 未知支持库函数_25 (.可否移动, 图片组))
.计次循环首 (未知支持库函数_29 (.), i)
    .插入表项 (到文本 (i), 相减 (i, 1), , , i)
.计次循环尾 ()

.子程序 _超级按钮2_被单击, 空白型, , 

.判断开始 (等于 (删全部空 (.内容), “”))
    信息框 (#名称空, #错误图标, )
    
    返回 ()
.判断 (等于 (删全部空 (.内容), “”))
    信息框 (#人数空, #错误图标, )
    
    返回 ()
.默认
    
.判断结束

.判断开始 (等于 (.标记, “1”))
    赋值 (.标记, “0”)
    .判断开始 (未知支持库函数_3 (全局句柄, 相加 (“insert into sale_sys_menu set `编号`='”, .内容, “',`名称`='”, .内容, “',`状态图片`=”, .标记, “,`选中图片`=”, .标记, “,`工作路径`='”, 子文本替换 (.内容, “\”, “\\”, , , 真), “',`备注`='”, .内容, “',`操作员`='”, 当前管理员, “',`上级`=”, .内容)))
        信息框 (#类别成功, #信息图标, )
        
        .加入项目 (.最大化按钮, .内容, 到数值 (.标记), 到数值 (.标记), 到数值 (.内容))
         ' 树型框11.项目 ＝ {  }
         ' 清除数组 (添加)
         ' 读树型框 (树型框11)
         ' 类别树 (全局句柄, “sale_sys_menu”, 0, 0, “名称”, 树型框11)
         ' 树型框11.加入项目 (树型框11.现行选中项, 编辑框2.内容, 到数值 (编辑框4.标记), , 到数值 (编辑框2.内容))
        连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .标记)
        赋值 (., 真)
        赋值 (.图片, {  })
    .默认
        信息框 (#类别失败, #信息图标, )
        
        未知支持库函数_41 (全局句柄, 错误)
        信息框 (错误, 0, )
        返回 ()
    .判断结束
    
.判断 (等于 (.标记, “2”))
    赋值 (.标记, “0”)
    .判断开始 (未知支持库函数_3 (全局句柄, 相加 (“update sale_sys_menu set `名称`='”, .内容, “',`状态图片`=”, .标记, “,`选中图片`=”, .标记, “,`工作路径`='”, 子文本替换 (.内容, “\”, “\\”, , , 真), “',`备注`='”, .内容, “',`操作员`='”, 当前管理员, “',`上级`=”, .内容, “ where `编号`=”, 到文本 (.取项目数值 (.最大化按钮)))))
        信息框 ()

.子程序 _超级按钮1_被单击, 空白型, , 
.局部变量 最大, 整数型, , , 

连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .标记)
赋值 (.图片, {  })
赋值 (.标记, “1”)
赋值 (., 假)
赋值 (.内容, “”)
赋值 (.内容, 到文本 (.取项目数值 (.最大化按钮)))
未知支持库函数_5 (记录集)
.判断开始 (未知支持库函数_3 (全局句柄, “select max(`编号`) from sale_sys_menu”))
    赋值 (记录集, 未知支持库函数_4 (全局句柄))
    未知支持库函数_6 (记录集, 0, 最大)
    赋值 (.内容, 到文本 (相加 (最大, 1)))
    赋值 (.内容, 相加 (“@”, .内容))
.默认
    
.判断结束


.子程序 _超级按钮3_被单击, 空白型, , 
删除树1 (“sale_sys_menu”)


.子程序 删除树, 空白型, , 
.参数 树型框, 树型框, , 
.参数 表, 文本型, , 

.局部变量 a, 文本型, , , 
.局部变量 i, 空白型, , , 
.局部变量 编号, 文本型, , "0", 

赋值 (a, 到文本 (树型框.取项目数值 (树型框.最大化按钮)))
赋值 (树型框.标记, a)
.判断开始 (不等于 (树型框.最大化按钮, 0))
    .判断开始 (等于 (信息框 (“您是否要删除选中类别，如果此类别被删除，此类别下的所有信息将被同时清除！”, 相加 (#询问图标, #是否钮), ), #是钮))
        清除数组 (编号)
        赋值 (a, 到文本 (树型框.取项目数值 (树型框.最大化按钮)))
        加入成员 (编号, a)
        .计次循环首 (相加 (相减 (树型框.取项目数 (), 树型框.最大化按钮), 1), i)
            输出调试文本 (到文本 (i))
            处理事件 ()
            .判断开始 (大于 (树型框.取缩进层次 (相加 (i, 树型框.最大化按钮)), 树型框.取缩进层次 (树型框.最大化按钮)))
                赋值 (a, 到文本 (树型框.取项目数值 (相加 (i, 树型框.最大化按钮))))
                加入成员 (编号, a)
                
            .默认
                跳出循环 ()
            .判断结束
            
        .计次循环尾 ()
        信息框 (取数组成员数 (编号), 0, )
        .计次循环首 (取数组成员数 (编号), i)
            .判断开始 (未知支持库函数_3 (全局句柄, 相加 (“delete from ”, 表, “ where `id`=”, 编号 [i])))
                
            .默认
                信息框 (“类别删除失败”, #错误图标, )
                返回 ()
            .判断结束
            
        .计次循环尾 ()
        信息框 (“类别删除成功”, #信息图标, )
        赋值 (树型框.标记, “”)
        树型框.删除项目 (树型框.最大化按钮)
         ' 写到文件 (取运行目录 () ＋ “\data\供应商类别.dat”, 供应商管理.树型框11.项目)
    .默认
        返回 ()
    .判断结束
    
.默认
    信息框 (“根类别不可以删除”, #错误图标, )
.判断结束


.子程序 删除树1, 空白型, , 
.参数 树型框, 树型框, , 
.参数 表, 文本型, , 

.局部变量 a, 文本型, , , 
.局部变量 i, 空白型, , , 
.局部变量 编号, 文本型, , "0", 

赋值 (a, 到文本 (树型框.取项目数值 (树型框.最大化按钮)))
赋值 (树型框.标记, a)
.判断开始 (不等于 (树型框.最大化按钮, 0))
    .判断开始 (等于 (信息框 (“您是否要删除选中类别，如果此类别被删除，此类别下的所有信息将被同时清除！”, 相加 (#询问图标, #是否钮), ), #是钮))
        清除数组 (编号)
        赋值 (a, 到文本 (树型框.取项目数值 (树型框.最大化按钮)))
        加入成员 (编号, a)
        .计次循环首 (相加 (相减 (树型框.取项目数 (), 树型框.最大化按钮), 1), i)
            输出调试文本 (到文本 (i))
            处理事件 ()
            .判断开始 (大于 (树型框.取缩进层次 (相加 (i, 树型框.最大化按钮)), 树型框.取缩进层次 (树型框.最大化按钮)))
                赋值 (a, 到文本 (树型框.取项目数值 (相加 (i, 树型框.最大化按钮))))
                加入成员 (编号, a)
                
            .默认
                跳出循环 ()
            .判断结束
            
        .计次循环尾 ()
         ' 信息框 (取数组成员数 (编号), 0, )
        
        .计次循环首 (取数组成员数 (编号), i)
            输出调试文本 (相加 (“delete from ”, 表, “ where `编号`=”, 编号 [i]))
            .判断开始 (未知支持库函数_3 (全局句柄, 相加 (“delete from ”, 表, “ where `编号`=”, 编号 [i])))
                
            .默认
                信息框 (“类别删除失败”, #错误图标, )
                返回 ()
            .判断结束
            
        .计次循环尾 ()
        信息框 (“类别删除成功”, #信息图标, )
        赋值 (树型框.标记, “”)
        树型框.删除项目 (树型框.最大化按钮)
         ' 写到文件 (取运行目录 () ＋ “\data\供应商类别.dat”, 供应商管理.树型框11.项目)
    .默认
        返回 ()
    .判断结束
    
.默认
    信息框 (“根类别不可以删除”, #错误图标, )
.判断结束


.子程序 _菜单项目设置_尺寸被改变, 空白型, , 
赋值 (.宽度, 相减 (菜单项目设置., .左边, 20))
赋值 (.高度, 相减 (菜单项目设置., .顶边, 60))
赋值 (.高度, 相减 (菜单项目设置., .顶边, 55))
赋值 (., .高度)


.子程序 _菜单项目设置_可否被关闭, 逻辑型, , 
.判断开始 (等于 (操作结束, 假))
    信息框 (“系统当前必要操作没有结束，不能关闭窗口，请稍等...”, #警告图标, )
    返回 (假)
.默认
    销毁 ()
    
.判断结束


.子程序 _树型框111_即将扩展, 逻辑型, , 
.参数 项目索引, 整数型, , 

清除数组 (添加)
读树型框数值 ()
.判断开始 (项目索引.是否有子项目 ())
    .判断开始 (等于 (相加 (项目索引, 1).取项目数值 (), -100))
        相加 (项目索引, 1).删除项目 ()
    .默认
        
    .判断结束
    
.默认
    
.判断结束
类别树启动1 (全局句柄, “sale_sys_menu”, 项目索引, 项目索引.取项目数值 (), “名称”, “编号”, , “状态图片”, “选中图片”)



.子程序 _树型框11_即将扩展, 逻辑型, , 
.参数 项目索引, 整数型, , 

清除数组 (添加)
读树型框数值 ()
.判断开始 (项目索引.是否有子项目 ())
    .判断开始 (等于 (相加 (项目索引, 1).取项目数值 (), -100))
        相加 (项目索引, 1).删除项目 ()
    .默认
        
    .判断结束
    
.默认
    
.判断结束
类别树启动1 (全局句柄, “sale_sys_menu”, 项目索引, 项目索引.取项目数值 (), “名称”, “编号”, , “状态图片”, “选中图片”)



.子程序 _超级按钮5_被单击, 空白型, , 
赋值 (.字体大小, 真)
赋值 (.倾斜, .宽度)
赋值 (.删除线, 200)


.子程序 _超级列表框1_表项被激活, 空白型, , 
赋值 (.内容, .取标题 (., ))
赋值 (.标记, 到文本 (.))
赋值 (.字体大小, 假)
赋值 (.图片, 未知支持库函数_31 (., ., ))

.子程序 _超级列表框1_当前表项被改变, 空白型, , 


.子程序 _树型框11_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

.判断开始 (未知支持库函数_3 (全局句柄, 相加 (“select * from sale_sys_menu where `编号`=”, 到文本 (.取项目数值 (.最大化按钮)))))
    赋值 (记录集, 未知支持库函数_4 (全局句柄))
    未知支持库函数_12 (记录集)
    赋值 (数值, 0)
    .判断开始 (未知支持库函数_6 (记录集, “上级”, 数值))
        赋值 (.内容, 到文本 (数值))
        
    .默认
        
    .判断结束
    赋值 (.内容, 到文本 (.取项目数值 (.最大化按钮)))
    赋值 (文本, “”)
    .判断开始 (未知支持库函数_6 (记录集, “名称”, 文本))
        赋值 (.内容, 文本)
        
    .默认
        
    .判断结束
    赋值 (数值, 0)
    .判断开始 (未知支持库函数_6 (记录集, “状态图片”, 数值))
        赋值 (.内容, 到文本 (数值))
        赋值 (.标记, 到文本 (数值))
    .默认
        
    .判断结束
    赋值 (.图片, 未知支持库函数_31 (., 数值, ))
    赋值 (文本, “”)
    .判断开始 (未知支持库函数_6 (记录集, “工作路径”, 文本))
        赋值 (.内容, 文本)
        
    .默认
        
    .判断结束
    
    赋值 (文本, “”)
    .判断开始 (未知支持库函数_6 (记录集, “备注”, 文本))
        赋值 (.内容, 文本)
        
    .默认
        
    .判断结束
    赋值 (.标记, “2”)
    赋值 (., 假)
    
.默认
    
.判断结束


.子程序 _超级按钮4_被单击, 空白型, , 
打开 ()
赋值 (.内容, .文件名)

.窗口程序集 窗口程序集7, , , 

.子程序 _用户权限设置_创建完毕, 空白型, , 
显示管理员 ()


.子程序 _分隔条1_被拖动, 空白型, , 
.参数 原位置, 整数型, , 
.参数 目的位置, 整数型, , 

.局部变量 wzc, 空白型, , , 

赋值 (wzc, 相减 (目的位置, 原位置))
赋值 (., 相加 (., wzc)) ' <!!!>
赋值 (.左边, 相加 (.左边, wzc)) ' <!!!>
赋值 (.宽度, 相减 (.宽度, wzc))
赋值 (.倾斜, 相加 (.倾斜, wzc))

.子程序 _用户权限设置_尺寸被改变, 空白型, , 
赋值 (.宽度, 相减 (用户权限设置., .左边, 20))
赋值 (.高度, 相减 (用户权限设置., .顶边, 55, ., .))
赋值 (., .高度)
赋值 (.删除线, .高度)
赋值 (., 相加 (.删除线, .加粗, 5))
赋值 (., 相加 (.删除线, .加粗, 5))
赋值 (.左边, 相减 (相加 (.左边, .宽度), 5))
赋值 (.顶边, 相除 (相减 (用户权限设置., .高度), 2))

.子程序 _树型框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 



.子程序 _树型框1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (不等于 (.最大化按钮, -1))
    弹出菜单 ()
    
.默认
    信息框 (“没有选中要授权的项目！”, #错误图标, )
    返回 ()
    
.判断结束


.子程序 _允许操作_被选择, 空白型, , 
.局部变量 a, 整数型, , , 
.局部变量 i, 空白型, , , 
.局部变量 编号, 整数型, , "0", 
.局部变量 j, 空白型, , , 

赋值 (a, .最大化按钮)
 ' 赋值 (.标记, 到文本 (a))
清除数组 (编号)
赋值 (a, .最大化按钮)
加入成员 (编号, a)
.计次循环首 (相加 (相减 (取项目数 (), .最大化按钮), 1), i)
    输出调试文本 (到文本 (i))
    处理事件 ()
    .判断开始 (大于 (相加 (i, .最大化按钮).取缩进层次 (), .取缩进层次 (.最大化按钮)))
        赋值 (a, 相加 (i, .最大化按钮))
        加入成员 (编号, a)
        
    .默认
        跳出循环 ()
    .判断结束
    
.计次循环尾 ()
.计次循环首 (取数组成员数 (编号), i)
    编号.置图片 ( [i], 40)
    编号.置选中图片 ( [i], 40)
     ' 编号.取父项目 ( [i]).置图片 (32)
     ' 树型框1.置选中图片 (树型框1.取父项目 (编号 [i]), 32)
     ' 13576221608
    赋值 (j, 编号 [i])
    .判断循环首 (不等于 (j, -1))
        赋值 (j, j.取父项目 ())
        j.置图片 (40)
        j.置选中图片 (40)
        
        处理事件 ()
        输出调试文本 (到文本 (j))
    .判断循环尾 ()
.计次循环尾 ()

赋值 (.标记, “”)





.子程序 _禁止操作_被选择, 空白型, , 
.局部变量 a, 整数型, , , 
.局部变量 i, 空白型, , , 
.局部变量 编号, 整数型, , "0", 

赋值 (a, .最大化按钮)
赋值 (.标记, 到文本 (a))
清除数组 (编号)
赋值 (a, .最大化按钮)
加入成员 (编号, a)
.计次循环首 (相加 (相减 (取项目数 (), .最大化按钮), 1), i)
    输出调试文本 (到文本 (i))
    处理事件 ()
    .判断开始 (大于 (相加 (i, .最大化按钮).取缩进层次 (), .取缩进层次 (.最大化按钮)))
        赋值 (a, 相加 (i, .最大化按钮))
        加入成员 (编号, a)
        
    .默认
        跳出循环 ()
    .判断结束
    
.计次循环尾 ()
.计次循环首 (取数组成员数 (编号), i)
    编号.置图片 ( [i], 50)
    编号.置选中图片 ( [i], 50)
     ' 编号.取父项目 ( [i]).置图片 (32)
     ' 编号.取父项目 ( [i]).置选中图片 (32)
    
.计次循环尾 ()
赋值 (.标记, “”)

.子程序 _树型框1_即将扩展, 逻辑型, , 
.参数 项目索引, 整数型, , 

清除数组 (添加)
读树型框数值 ()
.判断开始 (项目索引.是否有子项目 ())
    .判断开始 (等于 (相加 (项目索引, 1).取项目数值 (), -100))
        相加 (项目索引, 1).删除项目 ()
    .默认
        
    .判断结束
    
.默认
    
.判断结束
类别树启动2 (全局句柄, “sale_sys_menu”, 项目索引, 项目索引.取项目数值 (), “名称”, “编号”, , “状态图片”, “选中图片”)



.子程序 _树型框1_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 



.子程序 _时钟1_周期事件, 空白型, , 
赋值 (.可视, 取反 (.可视))
赋值 (.文本颜色, 选择 (取反 (.可视), #红色, #红色))

.子程序 _超级按钮1_被单击, 空白型, , 
销毁 ()


.子程序 _超级按钮2_被单击, 空白型, , 
.局部变量 i, 空白型, , , 
.局部变量 txt, 文本型, , , 

赋值 (txt, “”)
.计次循环首 (取项目数 (), i)
    .判断开始 (等于 (相减 (i, 1).取图片 (), 50))
        
    .默认
        赋值 (txt, 相加 (txt, 到文本 (相减 (i, 1).取项目数值 ()), “,”))
    .判断结束
    
.计次循环尾 ()
输出调试文本 (txt)
.判断开始 (未知支持库函数_3 (全局句柄, 相加 (“update gly set `操作员`='”, 当前管理员, “',`权限`='”, txt, “' where `id`=”, 到文本 (.取表项数值 (.)))))
    信息框 (“保存设置成功”, #信息图标, )
.默认
    信息框 (“保存设置失败”, #错误图标, )
    信息框 (未知支持库函数_41 (全局句柄, 错误), 0, )
    返回 ()
.判断结束


.子程序 _管理员列表_当前表项被改变, 空白型, , 


.子程序 _管理员列表_表项被激活, 空白型, , 
.局部变量 i, 空白型, , , 
.局部变量 j, 空白型, , , 

赋值 (用户权限设置., 真)
读权限 (.取表项数值 (.))
赋值 (操作结束, 假)
赋值 (.图标, {  })
清除数组 (添加)
类别树启动2 (全局句柄, “sale_sys_menu”, -1, 0, “名称”, “编号”, , “状态图片”, “选中图片”)
赋值 (操作结束, 真)
未知支持库函数_5 (记录集)
未知支持库函数_3 (全局句柄, “select count(*) from sale_sys_menu”)
赋值 (记录集, 未知支持库函数_4 (全局句柄))
未知支持库函数_6 (记录集, 0, j)
.计次循环首 (j, i)
    相减 (i, 1).扩展 ()
.计次循环尾 ()


.子程序 读权限, 空白型, , 
.参数 管理员, 整数型, , 

未知支持库函数_5 (记录集)
未知支持库函数_3 (全局句柄, 相加 (“select * from gly where `id`=”, 到文本 (管理员)))
赋值 (记录集, 未知支持库函数_4 (全局句柄))
未知支持库函数_12 (记录集)
赋值 (文本, “”)
.判断开始 (未知支持库函数_6 (记录集, “权限”, 文本))
    赋值 (权限, 分割文本 (文本, “,”, ))
.默认
    
.判断结束
赋值 (文本, “”)
.判断开始 (未知支持库函数_6 (记录集, “快捷”, 文本))
    赋值 (快捷, 分割文本 (文本, “,”, ))
.默认
    
.判断结束


.子程序 类别树启动2, 空白型, , 
.参数 局部句柄, 整数型, , 
.参数 表, 文本型, , 
.参数 当前索引, 整数型, , 
.参数 当前编号, 整数型, , 
.参数 当前字段, 文本型, , 
.参数 数值编号, 文本型, , 
.参数 树, 树型框, , 
.参数 图片, 文本型, 可空, 
.参数 选中图片, 文本型, 可空, 

.局部变量 记次, 空白型, , , 
.局部变量 次数, 空白型, , , 
.局部变量 标志, 逻辑型, , , 
.局部变量 记次1, 整数型, , , 
.局部变量 数值, 整数型, , , 
.局部变量 文本, 文本型, , , 
.局部变量 数值1, 整数型, , , 
.局部变量 数值2, 整数型, , , 
.局部变量 记录集11, 空白型, , , 
.局部变量 aa, 空白型, , , 
.局部变量 j, 空白型, , , 

处理事件 () ' 给出机会以接收停止按钮事件。
未知支持库函数_5 (记录集)
未知支持库函数_3 (局部句柄, 相加 (“select * from ”, 表, “ where `上级`=”, 到文本 (当前编号), “ order by id”))
赋值 (记录集, 未知支持库函数_4 (局部句柄))
未知支持库函数_12 (记录集)
.计次循环首 (未知支持库函数_7 (记录集), 记次)
    处理事件 ()
    赋值 (数值, 0)
    .判断开始 (未知支持库函数_6 (记录集, 数值编号, 数值))
        赋值 (文本, “”)
        .判断开始 (未知支持库函数_6 (记录集, 当前字段, 文本))
            赋值 (标志, 假)
            .判断开始 (等于 (是否为空 (图片), 假))
                .判断开始 (未知支持库函数_6 (记录集, 图片, 数值1))
                    
                .默认
                    
                .判断结束
                
            .默认
                
            .判断结束
            .判断开始 (等于 (是否为空 (选中图片), 假))
                .判断开始 (未知支持库函数_6 (记录集, 选中图片, 数值2))
                    
                .默认
                    
                .判断结束
                
            .默认
                
            .判断结束
            .计次循环首 (取数组成员数 (添加), 记次1)
                .判断开始 (等于 (添加 [记次1], 数值, 数值))
                    赋值 (标志, 真)
                    跳出循环 ()
                .默认
                    
                .判断结束
                
            .计次循环尾 ()
            .判断开始 (等于 (标志, 假))
                .计次循环首 (取数组成员数 (权限), j)
                    .判断开始 (等于 (到数值 (权限 [j]), 数值))
                        赋值 (标志, 真)
                        跳出循环 ()
                    .默认
                        
                    .判断结束
                    
                .计次循环尾 ()
                .判断开始 (等于 (标志, 假))
                    赋值 (aa, 树.加入项目 (当前索引, 文本, 50, 50, 数值))
                .默认
                    赋值 (aa, 树.加入项目 (当前索引, 文本, 40, 40, 数值))
                .判断结束
                未知支持库函数_5 (记录集11)
                未知支持库函数_3 (局部句柄, 相加 (“select * from ”, 表, “ where `上级`=”, 到文本 (数值), “ order by id”))
                赋值 (记录集11, 未知支持库函数_4 (局部句柄))
                .判断开始 (大于 (未知支持库函数_7 (记录集11), 0))
                    树.加入项目 (aa, “正在读取列表...”, , , -100)
                     ' 当前索引 ＝ 当前索引 ＋ 1
                .默认
                    
                .判断结束
                赋值 (临时.数值, 数值)
                赋值 (临时.索引, 数值)
                赋值 (临时.名称, 文本)
                加入成员 (添加, 临时)
                
            .默认
                
            .判断结束
            
        .默认
            
        .判断结束
        
    .默认
        
    .判断结束
    未知支持库函数_10 (记录集)
    
.计次循环尾 ()
未知支持库函数_5 (记录集)
 ' 输出调试文本 (“文本”)

.窗口程序集 窗口程序集10, , , 

.子程序 _关于_创建完毕, 空白型, , 


.子程序 _确定按钮_被单击, 空白型, , 
销毁 ()

.子程序 _系统信息按钮_被单击, 空白型, , 
.局部变量 系统信息路径, 文本型, , , 

赋值 (系统信息路径, 取文本注册项 (#本地机器, “SOFTWARE\Microsoft\Shared Tools\MSINFO\PATH”, “”))
.如果真 (等于 (系统信息路径, “”))
    赋值 (系统信息路径, 取文本注册项 (#本地机器, “SOFTWARE\Microsoft\Shared Tools Location\MSINFO”, “”))
    .判断开始 (不等于 (寻找文件 (相加 (系统信息路径, “\MSINFO32.EXE”), ), “”))
        赋值 (系统信息路径, 相加 (系统信息路径, “\MSINFO32.EXE”))
    .默认
        信息框 (“错误 - 文件找不到...”, #错误图标, “错误”)
    .判断结束
    
.如果真结束
.如果 (不等于 (系统信息路径, “”))
    运行 (系统信息路径, 假, )
.否则
    信息框 (“错误 - 注册表项找不到...”, #错误图标, “错误”)
.如果结束


.窗口程序集 窗口程序集2, , , 

.程序集变量 验证次数, 整数型, , , 
.程序集变量 注册, 整数型, , , 
.程序集变量 第一次, 逻辑型, , , 
.子程序 _确认_被单击, 空白型, , 
.如果 (不等于 (删首尾空 (..内容), “”))
    未知支持库函数_5 ()
    未知支持库函数_3 (全局句柄, 相加 (“select * from gly where `”, #管理员, “`='”, 删首尾空 (登录窗口..内容), “'”))
    
    赋值 (记录集, 未知支持库函数_4 (全局句柄))
    .判断开始 (并且 (大于 (0), 大于 (未知支持库函数_7 (), 0)))
        未知支持库函数_12 (记录集)
        读权限 (删首尾空 (登录窗口..内容))
        赋值 (“”)
        .判断开始 ()

.子程序 _登录窗口_创建完毕, 空白型, , 
如果 (文件是否存在 (库路径 ＋ #管理员) ＝ 假)
创建数据库 (库路径 ＋ #管理员, “管理员 文本型 20,密码 文本型 20,密码提示 文本型 40,密码提示答案 文本型 40,注册时间 日期时间型,管理员级别 整数型,登录次数 整数型,上次登录时间 日期时间型”)

信息框 (库路径 ＋ #管理员, 0, )
如果 (判断数据库 (#管理员, “管理员”))
.如果 (等于 (第一次, 真))
    判断注册 ()
.否则
    判断注册 ()
.如果结束




.子程序 _取消_被单击, 空白型, , 
结束 ()


.子程序 _找回密码_被单击, 空白型, , 
赋值 (注册, 2)

.子程序 判断注册, 空白型, , 
.局部变量 j, 整数型, 静态, , 
.局部变量 k, 整数型, 静态, , 
.局部变量 i, 整数型, , , 

赋值 (验证次数, 1)
未知支持库函数_5 ()
未知支持库函数_3 (全局句柄, “select * from gly”)
赋值 (记录集, 未知支持库函数_4 (全局句柄))
清空 ()

.子程序 _管理员名_列表项被选择, 空白型, , 


.子程序 _密码名_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    _确认_被单击 ()
.否则
    
.如果结束




.子程序 色彩主题, 空白型, , 



 ' 不属于任何一个程序集、类模块的函数：
