 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 502
    高度 = 411
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 7 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 1 扩展界面支持库一




.全局变量 查询方式, 空白型, , , 

.窗口程序集 窗口程序集1, , , 

.子程序 _查询_被单击, 空白型, , 
.局部变量 记录集, 整数型, , , 
.局部变量 c, 整数型, , , 列表框中的表项值
.局部变量 符合条件的记录数, 整数型, , , 

.如果真 (“db1.mdb”.打开MDB数据库 ())
    .判断开始 (等于 (查询方式, 1))
        赋值 (记录集, 相加 (“select count(*) from 表1,表2,表3 where 表2.产品名称=”, “'”, 删全部空 (.内容), “'”, “ and 表3.产品编号=表2.产品编号 and 表3.城市编号=表1.城市编号”).查询 ())
        赋值 (符合条件的记录数, 记录集.读 (1))
        关闭 ()
        “db1.mdb”.打开MDB数据库 ()
        赋值 (记录集, 相加 (“select 表2.产品编号,表2.产品名称,表2.产品价格,表1.城市名称 from 表1,表2,表3 where 表2.产品名称=”, “'”, 删全部空 (.内容), “'”, “ and 表3.产品编号=表2.产品编号 and 表3.城市编号=表1.城市编号”).查询 ())
    .判断 (等于 (查询方式, 2))
        赋值 (记录集, 相加 (“select count(*) from 表1,表2,表3 where 表2.产品价格>=”, .内容, “ and 表3.产品编号=表2.产品编号 and 表3.城市编号=表1.城市编号”).查询 ())
        赋值 (符合条件的记录数, 记录集.读 (1))
        关闭 ()
        “db1.mdb”.打开MDB数据库 ()
        赋值 (记录集, 相加 (“select 表2.产品编号,表2.产品名称,表2.产品价格,表1.城市名称 from 表1,表2,表3 where 表2.产品价格>=”, .内容, “ and 表3.产品编号=表2.产品编号 and 表3.城市编号=表1.城市编号”).查询 ())
    .判断 (等于 (查询方式, 3))
        赋值 (记录集, 相加 (“select count(*) from 表1,表2,表3 where 表1.城市名称=”, “'”, 删全部空 (.内容), “'”, “ and 表3.产品编号=表2.产品编号 and 表3.城市编号=表1.城市编号”).查询 ())
        赋值 (符合条件的记录数, 记录集.读 (1))
        关闭 ()
        “db1.mdb”.打开MDB数据库 ()
        赋值 (记录集, 相加 (“select 表2.产品编号,表2.产品名称,表2.产品价格,表1.城市名称 from 表1,表2,表3 where 表1.城市名称=”, “'”, 删全部空 (.内容), “'”, “ and 表3.产品编号=表2.产品编号 and 表3.城市编号=表1.城市编号”).查询 ())
    .默认
        
    .判断结束
    记录集.到首记录 ()
    赋值 (c, 1) ' 表示项目的位置
    全部删除 ()
    .计次循环首 (符合条件的记录数, c)
        相减 (c, 1).插入表项 (记录集.读 (1), , , , )
        相减 (c, 1).置标题 (1, 记录集.读 (2))
        相减 (c, 1).置标题 (2, 记录集.读 (3))
        相减 (c, 1).置标题 (3, 记录集.读 (4))
        记录集.到后一记录 ()
    .计次循环尾 ()
    返回 ()
    
.如果真结束
信息框 (“打开数据库失败”, 0, )
返回 ()

.子程序 __启动窗口_创建完毕, 空白型, , 


.子程序 _按产品名称_被单击, 空白型, , 
赋值 (查询方式, 1)
赋值 (.内容, “”)

.子程序 _按产品价格_被单击, 空白型, , 
赋值 (查询方式, 2)
赋值 (.内容, “”)


.子程序 _按产地_被单击, 空白型, , 
赋值 (查询方式, 3)
赋值 (.内容, “”)


 ' 不属于任何一个程序集、类模块的函数：
