 ' 文件类型：Windows窗口程序

 ' 程序名称：局网速贴
 ' 程序描述：用于局域网中资源的查找、复制等操作
 ' 程序作者：郑方伟(Vtree)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：oopacd@163.com
 ' 主页地址：http://ko9.126.com
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 2 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 1 扩展界面支持库一



窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 383
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 11169081 '  0xAA6D39
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “局网速贴――搜索”
    帮助文件名 = “”

窗口 属性窗口
    左边 = 50
    顶边 = 50
    宽度 = 254
    高度 = 267
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “置文件属性”
    帮助文件名 = “”

窗口 复制窗口
    左边 = 50
    顶边 = 50
    宽度 = 243
    高度 = 246
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “复制到...”
    帮助文件名 = “”

窗口 选项窗口
    左边 = 50
    顶边 = 50
    宽度 = 245
    高度 = 235
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “搜索选项”
    帮助文件名 = “”

窗口 说明窗口
    左边 = 50
    顶边 = 50
    宽度 = 404
    高度 = 343
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 11169081 '  0xAA6D39
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “帮助/关于”
    帮助文件名 = “”





.全局变量 目标, 文本型, , , 复制到的目标地址
.全局变量 设置属性, 字节型, , , 设置时输入的属性值
.全局变量 是否判断, 逻辑型, , , 是否进行大小及属性的判断
.全局变量 范围, 逻辑型, , , 只搜根目录时真
.全局变量 类型, 字节型, , , 文件或文件夹

.窗口程序集 启动程序集, , , 

.程序集变量 原有长度, 整数型, , , 要复制文件夹地址的长度
.程序集变量 当前目录, 文本型, , , 
.程序集变量 新文件名, 文本型, , , 更名时输入的文件名
.程序集变量 是否跳出, 逻辑型, , , 是否取消正在执行的任务
.程序集变量 免重名, 整数型, , , 更名时用
.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (是否判断, 假) ' 使用搜索选项时为真,不用时假
赋值 (范围, 真)
赋值 (类型, 55)

.子程序 _按钮1_被单击, 空白型, , 浏览按纽
赋值 (.初始目录, 取当前目录 ())
打开 ()
赋值 (.内容, .文件名)

.子程序 _单选框1_被单击, 空白型, , 数字
未知函数_67175125 (“单选”, 真)

.子程序 _单选框2_被单击, 空白型, , 字母
未知函数_67175125 (“单选”, 假)

.子程序 执行任务, 空白型, , 复制或搜索
.参数 是否复制, 逻辑型, , 

.局部变量 原文件, 文本型, , , 要复制或要搜索的文件
.局部变量 目标地址, 文本型, , , 带*号
.局部变量 当前地址, 文本型, , , 替换*号之后
.局部变量 文件名, 文本型, , , 
.局部变量 起位, 短整数型, , , 当前机号（数字）
.局部变量 止位, 短整数型, , , 
.局部变量 符长, 短整数型, , , 
.局部变量 字母起, 短整数型, , , 当前机号（字母）
.局部变量 字母止, 短整数型, , , 
.局部变量 未成功, 文本型, , , 

赋值 (是否跳出, 假)
赋值 (原文件, .内容)
赋值 (目标地址, .内容)
.如果真 (不等于 (取文本右边 (目标地址, 1), “\”))
    赋值 (目标地址, 相加 (目标地址, “\”))
.如果真结束
赋值 (文件名, 取文本右边 (原文件, 相减 (取文本长度 (原文件), 倒找文本 (原文件, “\”, , 假))))
赋值 (起位, 到数值 (.内容))
赋值 (止位, 到数值 (.内容))
赋值 (符长, 到数值 (.内容))
赋值 (字母起, 取代码 (.内容, ))
赋值 (字母止, 取代码 (.内容, ))
赋值 (.标题, “”)
未知函数_67175125 (“执行任务”, 真)
.如果真 (.选中)
    赋值 (.最大位置, 相加 (相减 (止位, 起位), 1))
    .判断循环首 (小于或等于 (起位, 止位))
        .判断开始 (等于 (符长, 1))
            赋值 (当前地址, 子文本替换 (目标地址, “*”, 到文本 (起位), , , 假)) ' 将范围地址（带*）换为实际地址
        .判断 (等于 (符长, 2))
            .如果 (大于 (起位, 9))
                赋值 (当前地址, 子文本替换 (目标地址, “*”, 到文本 (起位), , , 假))
            .否则
                赋值 (当前地址, 子文本替换 (目标地址, “*”, 相加 (“0”, 到文本 (起位)), , , 假)) ' 位数不足时在前补零
            .如果结束
            
        .判断 (等于 (符长, 3))
            .如果真 (小于 (起位, 10))
                赋值 (当前地址, 子文本替换 (目标地址, “*”, 相加 (“00”, 到文本 (起位)), , , 假))
            .如果真结束
            .如果真 (并且 (大于 (起位, 9), 小于 (起位, 100)))
                赋值 (当前地址, 子文本替换 (目标地址, “*”, 相加 (“0”, 到文本 (起位)), , , 假))
            .如果真结束
            .如果真 (大于 (起位, 99))
                赋值 (当前地址, 子文本替换 (目标地址, “*”, 到文本 (起位), , , 假))
            .如果真结束
            
        .默认
            
        .判断结束
        .如果 (是否复制)
            处理事件 ()
            .如果真 (是否跳出)
                跳出循环 ()
            .如果真结束
            .如果 (文件是否存在 (原文件))
                .如果 (等于 (取文件属性 (当前地址), -1))
                    .如果真 (等于 (目录创建 (当前地址), 假)) ' 如果操作不成功则把机号记录在“未成功”里
                        赋值 (相加 (“ ”, 到文本 ()))
                        赋值 (起位, 相加 (起位, 1))
                        赋值 (.位置, 相加 (.位置, 1))
                        到循环尾 ()
                    .如果真结束
                    
                .否则
                    .如果真 (等于 (位与 (取文件属性 (当前地址), 16), 0)) ' 已有与目录同名的文件存在，跳过
                        赋值 (相加 (“ ”, 到文本 ()))
                        赋值 (起位, 相加 (起位, 1))
                        赋值 (.位置, 相加 (.位置, 1))
                        到循环尾 ()
                    .如果真结束
                    
                .如果结束
                .如果真 (并且 (等于 (.选中, 假), 文件是否存在 (相加 (当前地址, 文件名)))) ' 如果文件存在且选择不覆盖
                    赋值 (.位置, 相加 (.位置, 1))
                    赋值 (相加 (1))
                    到循环尾 ()
                .如果真结束
                刷新显示 ()
                赋值 (.标题, 相加 (当前地址, 文件名))
                .如果真 (等于 (复制文件 (原文件, 相加 (当前地址, 文件名)), 假))
                    赋值 (相加 (“ ”, 到文本 ()))
                .如果真结束
                
            .否则
                .如果真 (并且 (不等于 (取文件属性 (原文件), -1), 不等于 (位与 (取文件属性 (原文件), 16), 0))) ' 文件夹复制
                    赋值 (当前地址)
                    .如果真 (等于 (文件夹复制 (原文件), 假))
                        赋值 (相加 (“ ”, 到文本 ()))
                    .如果真结束
                    
                .如果真结束
                
            .如果结束
            
        .否则
            搜索添加 (当前地址, 原文件)
        .如果结束
        处理事件 ()
        .如果真 (是否跳出)
            跳出循环 ()
        .如果真结束
        赋值 (.位置, 相加 (.位置, 1))
        赋值 (相加 (1))
    .判断循环尾 ()
.如果真结束
.如果真 (.选中)
    .如果 (并且 (小于 (字母起, 91), 大于 (字母止, 97)))
        赋值 (.最大位置, 相减 (字母止, 字母起, 5))
    .否则
        赋值 (.最大位置, 相加 (相减 (字母止, 字母起), 1))
    .如果结束
    .判断循环首 (小于或等于 (字母起, 字母止))
        赋值 (当前地址, 子文本替换 (目标地址, “*”, 到文本 (字符 (字母起)), , , 假))
        .如果 (是否复制)
            处理事件 ()
            .如果真 (是否跳出)
                跳出循环 ()
            .如果真结束
            .如果 (文件是否存在 (原文件))
                .如果 (等于 (取文件属性 (当前地址), -1))
                    .如果真 (等于 (目录创建 (当前地址), 假))
                        赋值 (未成功, 相加 (未成功, “ ”, 到文本 (字符 (字母起))))
                        .如果 (不等于 (字母起, 90)) ' 如果是“Z”则下步跳到“a”
                            赋值 (字母起, 相加 (字母起, 1))
                        .否则
                            赋值 (字母起, 97)
                        .如果结束
                        赋值 (.位置, 相加 (.位置, 1))
                        到循环尾 ()
                    .如果真结束
                    
                .否则
                    .如果真 (等于 (位与 (取文件属性 (当前地址), 16), 0)) ' 已有与目录同名的文件存在，跳过
                        赋值 (未成功, 相加 (未成功, “ ”, 到文本 (字母起)))
                        .如果 (不等于 (字母起, 90)) ' 如果是“Z”则下步跳到“a”
                            赋值 (字母起, 相加 (字母起, 1))
                        .否则
                            赋值 (字母起, 97)
                        .如果结束
                        赋值 (.位置, 相加 (.位置, 1))
                        到循环尾 ()
                    .如果真结束
                    
                .如果结束
                .如果真 (并且 (等于 (.选中, 假), 文件是否存在 (相加 (当前地址, 文件名))))
                    赋值 (.位置, 相加 (.位置, 1))
                    .如果 (不等于 (字母起, 90))
                        赋值 (字母起, 相加 (字母起, 1))
                    .否则
                        赋值 (字母起, 97)
                    .如果结束
                    到循环尾 ()
                .如果真结束
                刷新显示 ()
                赋值 (.标题, 相加 (当前地址, 文件名))
                .如果真 (等于 (复制文件 (原文件, 相加 (当前地址, 文件名)), 假))
                    赋值 (未成功, 相加 (未成功, “ ”, 到文本 (字符 (字母起))))
                .如果真结束
                
            .否则
                .如果真 (并且 (不等于 (取文件属性 (原文件), -1), 不等于 (位与 (取文件属性 (原文件), 16), 0))) ' 文件夹复制
                    赋值 (当前地址)
                    .如果真 (等于 (文件夹复制 (原文件), 假))
                        赋值 (未成功, 相加 (未成功, “ ”, 到文本 (字符 (字母起))))
                    .如果真结束
                    
                .如果真结束
                
            .如果结束
            
        .否则
            搜索添加 (当前地址, 原文件)
        .如果结束
        处理事件 ()
        .如果真 (是否跳出)
            跳出循环 ()
        .如果真结束
        赋值 (.位置, 相加 (.位置, 1))
        .如果 (不等于 (字母起, 90))
            赋值 (字母起, 相加 (字母起, 1))
        .否则
            赋值 (字母起, 97)
        .如果结束
        
    .判断循环尾 ()
.如果真结束
.如果真 (是否复制)
    .如果 (不等于 (未成功, “”))
        赋值 (.标题, 相加 (“失败的有：”, 未成功))
    .否则
        赋值 (.标题, “复制完成”)
    .如果结束
    
.如果真结束
未知函数_67175125 (“执行任务”, 假)

.子程序 _按钮2_被单击, 空白型, , 复制按纽
.如果真 (等于 (限制输入 (), 假))
    返回 ()
.如果真结束
.如果真 (并且 (等于 (文件是否存在 (.内容), 假), 等于 (取文件属性 (.内容), -1)))
    信息框 (“要复制的文件或文件夹不存在，请检查地址！”, 16, “错误”)
    返回 ()
.如果真结束
刷新显示 ()
赋值 (.标题, “正复制到”)
赋值 (.位置, 0)
未知函数_67175125 (“复制”, 真)
执行任务 (真)
未知函数_67175125 (“复制”, 假)

.子程序 _按钮3_被单击, 空白型, , 取消按纽
赋值 (是否跳出, 真)

.子程序 _按钮4_被单击, 空白型, , 搜索按纽
.如果真 (等于 (限制输入 (), 假))
    返回 ()
.如果真结束
.如果 (并且 (等于 (寻找文本 (.内容, “\”, , 假), -1), 等于 (寻找文本 (.内容, “/”, , 假), -1), 等于 (寻找文本 (.内容, #引号, , 假), -1), 等于 (寻找文本 (.内容, “:”, , 假), -1), 等于 (寻找文本 (.内容, “|”, , 假), -1), 等于 (寻找文本 (.内容, “<”, , 假), -1), 等于 (寻找文本 (.内容, “>”, , 假), -1)))
    全部删除 ()
    赋值 (.标题, “正在搜索”)
    未知函数_67175125 (“搜索”, 真)
    执行任务 (假)
    未知函数_67175125 (“搜索”, 假)
    处理禁止 ()
    .如果 (等于 (取表项数 (), 0))
        赋值 (.标题, “搜索完毕，无相关结果”)
    .否则
        赋值 (.标题, 相加 (“搜索结果(双击打开相应目录)： 共”, 到文本 (取表项数 ()), “个”))
    .如果结束
    
.否则
    信息框 (相加 (“文件名中不能含有以下字符：”, #换行符, “  /  \  :  |  <  >  ”, #引号, #换行符, #换行符, “只能使用通配符(*)和单配符(?)。”), 16, “错误”)
.如果结束


.子程序 处理选择, 空白型, , 起始设置及相关禁止处理
.参数 处理类型, 文本型, , 
.参数 条件, 逻辑型, , 

.判断开始 (等于 (处理类型, “单选”))
    赋值 (.禁止, 选择 (条件, 假, 真))
    赋值 (.禁止, .禁止)
    赋值 (.禁止, .禁止)
    赋值 (.禁止, 选择 (条件, 真, 假))
    赋值 (.禁止, .禁止)
.判断 (等于 (处理类型, “执行任务”))
    赋值 (.禁止, 选择 (条件, 真, 假))
    赋值 (.禁止, .禁止)
    赋值 (.禁止, 选择 (条件, 真, 假))
    赋值 (.禁止, 选择 (条件, 真, 假))
.判断 (等于 (处理类型, “复制”))
    赋值 (.禁止, 选择 (条件, 真, 假))
    赋值 (.禁止, 选择 (条件, 真, 假))
    赋值 (.禁止, 选择 (条件, 假, 真))
    赋值 (.可视, 选择 (条件, 真, 假))
    赋值 (.可视, 选择 (条件, 真, 假))
.判断 (等于 (处理类型, “搜索”))
    赋值 (.禁止, 选择 (条件, 真, 假))
    赋值 (.禁止, 选择 (条件, 真, 假))
    赋值 (.禁止, 选择 (条件, 假, 真))
    赋值 (.可视, 选择 (条件, 假, 真))
    赋值 (.可视, 选择 (条件, 假, 真))
    赋值 (.可视, 选择 (条件, 假, 真))
    赋值 (.可视, 选择 (条件, 假, 真))
    赋值 (.可视, 选择 (条件, 假, 真))
    赋值 (.可视, 选择 (条件, 真, 假)) ' 搜索时不能对结果进行操作
    赋值 (.可视, 选择 (条件, 真, 假))
.判断 (等于 (处理类型, “方式”))
    赋值 (_启动窗口.高度, 选择 (条件, 230, 383))
    赋值 (_启动窗口.标题, 选择 (条件, “局网速贴――复制”, “局网速贴――搜索”))
    赋值 (.选中, 选择 (条件, 真, 假))
    赋值 (.选中, 选择 (条件, 假, 真))
    赋值 (.可视, 选择 (条件, 真, 假))
    赋值 (.可视, 选择 (条件, 真, 假))
    赋值 (.可视, 选择 (条件, 假, 真))
    赋值 (.可视, 选择 (条件, 假, 真))
    赋值 (., 选择 (条件, 假, 真))
    赋值 (.可视, 选择 (条件, 假, 真))
    赋值 (.可视, 选择 (条件, 假, 真))
    赋值 (.标题, 选择 (条件, “ 复制内容：”, “ 搜索内容：”))
    赋值 (.标题, 选择 (条件, “ 复制目标：”, “ 搜索范围：”))
.判断 (等于 (处理类型, “操作”))
    赋值 (.禁止, 选择 (条件, 假, 真))
    赋值 (.禁止, 选择 (条件, 真, 假))
    赋值 (.可视, 选择 (条件, 真, 假))
    赋值 (.标题, “”)
    赋值 (.禁止, 选择 (条件, 真, 假))
    赋值 (.禁止, 选择 (条件, 真, 假))
.默认
    
.判断结束


.子程序 限制输入, 逻辑型, , 编辑框1-7的输入
.局部变量 字母起, 短整数型, , , 
.局部变量 字母止, 短整数型, , , 

.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“请将地址填写完整！”, 16, “错误”)
    返回 (假)
.如果真结束
.如果真 (等于 (倒找文本 (.内容, “*”, , 假), -1))
    信息框 (“请在目标地址中使用通配符！”, 16, “错误”)
    返回 (假)
.如果真结束
.如果真 (或者 (并且 (.选中, 大于 (到数值 (.内容), 到数值 (.内容))), 并且 (.选中, 大于 (取代码 (.内容, ), 取代码 (.内容, )))))
    信息框 (“请调整起止顺序！”, 16, “错误”)
    返回 (假)
.如果真结束
.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“起止数值不能为空！”, 16, “错误”)
    返回 (假)
.如果真结束
.如果真 (并且 (等于 (.选中, 真), 小于 (到数值 (.内容), 0)))
    信息框 (“起号不能小于零！”, 16, “错误”)
    返回 (假)
.如果真结束
.如果真 (.选中)
    赋值 (取代码 (.内容, ))
    赋值 (取代码 (.内容, ))
    .如果 (或者 (小于 (65), 大于 (122)))
        信息框 (“起止位只能输入字母！”, 16, “错误”)
        返回 (假)
    .否则
        .如果真 (并且 (大于 (90), 小于 (97)))
            信息框 (“起止位只能输入字母！”, 16, “错误”)
            返回 (假)
        .如果真结束
        
    .如果结束
    .如果 (或者 (小于 (65), 大于 (122)))
        信息框 (“起止位只能输入字母！”, 16, “错误”)
        返回 (假)
    .否则
        .如果真 (并且 (大于 (90), 小于 (97)))
            信息框 (“起止位只能输入字母！”, 16, “错误”)
            返回 (假)
        .如果真结束
        
    .如果结束
    
.如果真结束
返回 (真)

.子程序 _帮助关于_被选择, 空白型, , 
载入 (说明窗口, _启动窗口, 假)

.子程序 _退出_被选择, 空白型, , 
结束 ()

.子程序 _复制方式_被选择, 空白型, , 
未知函数_67175125 (“方式”, 真)
赋值 (.标题, “复制方式”)

.子程序 _搜索方式_被选择, 空白型, , 
未知函数_67175125 (“方式”, 假)
.如果 (等于 (取表项数 (), 0))
    赋值 (.标题, “搜索结果(双击打开相应目录)：”)
.否则
    赋值 (.标题, 相加 (“搜索结果(双击打开相应目录)： 共”, 到文本 (取表项数 ()), “个”))
.如果结束


.子程序 搜索添加, 空白型, , 添加到搜索结果
.参数 目录, 文本型, , 
.参数 文件名, 文本型, , 

.局部变量 搜索结果, 文本型, , , 
.局部变量 索引, 整数型, , , 

.如果真 (不等于 (取文本右边 (目录, 1), “\”))
    赋值 (目录, 相加 (目录, “\”))
.如果真结束
赋值 (搜索结果, 寻找文件 (相加 (目录, 文件名), 类型))
刷新显示 ()
赋值 (.标题, 目录)
.判断循环首 (不等于 (搜索结果, “”))
    处理事件 ()
    .如果真 (是否跳出)
        返回 ()
    .如果真结束
    .如果真 (不等于 (取文本右边 (搜索结果, 1), “.”))
        .如果 (是否判断)
            .如果真 (是否符合条件 (相加 (目录, 搜索结果))) ' 检查是否符合搜索选项中所设置条件
                赋值 (索引, .插入表项 (搜索结果, 取类型 (相加 (目录, 搜索结果)), , , ))
                .置标题 (1, )
                索引.置标题 (2, 取大小 (相加 (目录, 搜索结果)))
            .如果真结束
            
        .否则
            赋值 (索引, .插入表项 (搜索结果, 取类型 (相加 (目录, 搜索结果)), , , ))
            .置标题 (1, )
            索引.置标题 (2, 取大小 (相加 (目录, 搜索结果)))
        .如果结束
        
    .如果真结束
    赋值 (搜索结果, 寻找文件 (类型))
.判断循环尾 ()
处理事件 ()
.如果真 (是否跳出)
    返回 ()
.如果真结束
.如果真 (等于 (范围, 假)) ' 如果只搜索根目录则到此返回
    返回 ()
.如果真结束
赋值 (搜索结果, 寻找文件 (相加 (目录, “*”), #子目录))
.判断循环首 (不等于 (搜索结果, “”))
    处理事件 ()
    .如果真 (是否跳出)
        返回 ()
    .如果真结束
    .如果真 (不等于 (取文本右边 (搜索结果, 1), “.”)) ' 跳过本目录或上级目录
        搜索添加 (相加 (目录, 搜索结果), 文件名)
    .如果真结束
    赋值 (搜索结果, 寻找文件 (#子目录))
.判断循环尾 ()

.子程序 搜索复制, 空白型, , 文件夹复制的子程序
.参数 目录, 文本型, , 

.局部变量 搜索结果, 文本型, , , 

.如果真 (不等于 (取文本右边 (1), “\”))
    赋值 (相加 (“\”))
.如果真结束
赋值 (搜索结果, 寻找文件 (相加 (目录, “*”), ))
.判断循环首 (不等于 (“”))
    处理事件 ()
    .如果真 (是否跳出)
        跳出循环 ()
    .如果真结束
    .如果真 (文件是否存在 (相加 (当前目录, 搜索结果)))
        .如果真 (等于 (.选中, 假))
            赋值 (寻找文件 ())
            到循环尾 ()
        .如果真结束
        
    .如果真结束
    刷新显示 ()
    赋值 (.标题, 相加 (当前目录, 搜索结果))
    复制文件 (相加 (目录, 搜索结果), 相加 (当前目录, 搜索结果))
    赋值 (寻找文件 ())
.判断循环尾 ()
处理事件 ()
.如果真 (是否跳出)
    返回 ()
.如果真结束
赋值 (寻找文件 (相加 (“*”), #子目录))
.判断循环首 (不等于 (“”))
    处理事件 ()
    .如果真 (是否跳出)
        跳出循环 ()
    .如果真结束
    .如果真 (不等于 (取文本右边 (搜索结果, 1), “.”)) ' 跳过本目录或上级目录
        赋值 (相加 (取文本右边 (目录, 相减 (取文本长度 (目录), )), 搜索结果, “\”))
        .如果 (等于 (取文件属性 (), -1)) ' 当前目录不存在时创建
            .如果 (创建目录 ())
                置文件属性 (取文件属性 (相加 ()))
            .否则
                赋值 (寻找文件 (#子目录))
                到循环尾 ()
            .如果结束
            
        .否则
            .如果真 (等于 (位与 (取文件属性 (), 16), 0)) ' 存在与当前目录同名文件时到循环尾
                赋值 (寻找文件 (#子目录))
                到循环尾 ()
            .如果真结束
            
        .如果结束
        搜索复制 (相加 (目录, 搜索结果))
    .如果真结束
    赋值 (寻找文件 (#子目录))
.判断循环尾 ()

.子程序 处理禁止, 空白型, , “操作”菜单下的禁止处理
赋值 (.禁止, 选择 (大于 (取已选择表项数 (), 0), 假, 真))
赋值 (.禁止, .禁止)
赋值 (.禁止, .禁止)
赋值 (.禁止, .禁止)
.如果 (等于 (取已选择表项数 (), 取表项数 ()))
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
.如果结束


.子程序 _列表框_表项被激活, 空白型, , 
.局部变量 文件名, 文本型, , , 
.局部变量 目录, 文本型, , , 
.局部变量 索引, 整数型, , "2", 

.如果真 (等于 (取已选择表项数 (), 1))
    赋值 (索引, 取被选择表项 ())
    赋值 (文件名, 索引.取标题 ( [1], 1))
    .如果真 (不等于 (文件名, “”))
        赋值 (目录, 取文本左边 (文件名, 相减 (倒找文本 (文件名, “\”, , 假), 1)))
        .如果真 (不等于 (目录, “”))
            运行 (相加 (“explorer.exe ”, 目录), 假, )
        .如果真结束
        
    .如果真结束
    
.如果真结束


.子程序 _全选_被选择, 空白型, , 
.局部变量 索引, 整数型, , , 

.计次循环首 (取表项数 (), 索引)
    相减 (索引, 1).选择表项 ()
.计次循环尾 ()
处理禁止 ()

.子程序 _复制_被选择, 空白型, , 
载入 (复制窗口, , 真)

.子程序 _更名_被选择, 空白型, , 
.局部变量 索引, 整数型, , "2", 

.如果 (等于 (取已选择表项数 (), 1)) ' 如果多个文件时批量更名
    赋值 (索引, 取被选择表项 ())
    索引.进入编辑 ( [1])
.否则
    .如果真 (输入框 (相加 (“输入新的文件名（带扩展名）或文件夹名：”, #换行符, “（同名时将自动在文件名前加数字区分）”), “重命名”, 新文件名, 新文件名, 1))
        .如果 (取反 (并且 (等于 (寻找文本 (新文件名, “\”, , 假), -1), 等于 (寻找文本 (新文件名, “/”, , 假), -1), 等于 (寻找文本 (新文件名, #引号, , 假), -1), 等于 (寻找文本 (新文件名, “:”, , 假), -1), 等于 (寻找文本 (新文件名, “|”, , 假), -1), 等于 (寻找文本 (新文件名, “<”, , 假), -1), 等于 (寻找文本 (新文件名, “>”, , 假), -1), 等于 (寻找文本 (新文件名, “*”, , 假), -1), 等于 (寻找文本 (新文件名, “?”, , 假), -1)))) ' 新的文件名里不能有非法的文件字符，像“< > : | ? * \ /”及引号等是不能作为文件名的
            信息框 (相加 (“文件名中不能含有以下字符：”, #换行符, “  /  \  :  |  <  >  *  ?  ”, #引号, #换行符, “请重新输入！”), 16, “错误”)
            _更名_被选择 ()
        .否则
            赋值 (.标题, “正在更名”)
            列表框操作 (“更名”)
            赋值 (.标题, “更名完成”)
        .如果结束
        
    .如果真结束
    
.如果结束


.子程序 _属性_被选择, 空白型, , 
载入 (属性窗口, , 真)

.子程序 _删除_被选择, 空白型, , 
.如果真 (等于 (信息框 (“所选择文件将被彻底删除，不能恢复，是否继续？”, 33, “删除”), 0))
    赋值 (.标题, “正在删除”)
    列表框操作 (“删除”)
    .如果 (等于 (取表项数 (), 0))
        赋值 (.标题, “删除完毕，无相关结果”)
    .否则
        赋值 (.标题, 相加 (“搜索结果(双击打开相应目录)： 共”, 到文本 (取表项数 ()), “个”))
    .如果结束
    
.如果真结束


.子程序 目录创建, 逻辑型, , 分层创建目录
.参数 目录, 文本型, , 

.局部变量 上级, 文本型, , , 
.局部变量 下一级, 整数型, , , 

.如果真 (不等于 (取文本右边 (目录, 1), “\”))
    赋值 (目录, 相加 (目录, “\”))
.如果真结束
赋值 (下一级, 0)
.判断循环首 (不等于 (取文件属性 (目录), 16)) ' 局域网机子用\\开头，不易确认目录，所以用循环创建
    赋值 (下一级, 寻找文本 (目录, “\”, 相加 (下一级, 1), 假))
    赋值 (上级, 取文本左边 (目录, 下一级))
    .如果真 (并且 (不等于 (取文件属性 (上级), 16), 不等于 (上级, “”), 不等于 (取文本右边 (上级, 2), “\\”)))
        .如果真 (并且 (等于 (创建目录 (上级), 假), 等于 (下一级, 取文本长度 (目录))))
            返回 (假)
        .如果真结束
        
    .如果真结束
    
.判断循环尾 ()
返回 (真)

.子程序 列表框操作, 空白型, , 对搜索结果的所有操作
.参数 操作类型, 文本型, , 

.局部变量 文件名, 文本型, , , 全名，带目录
.局部变量 目录, 文本型, , , 
.局部变量 计容器, 整数型, , , 
.局部变量 新全径, 文本型, , , 复制文件时用
.局部变量 原属性, 整数型, , , 设置属性时用
.局部变量 索引, 整数型, , "0", 
.局部变量 修正, 整数型, , , 册除列表选项时用

赋值 (计容器, 1)
赋值 (免重名, 0)
赋值 (是否跳出, 假)
未知函数_67175125 (“操作”, 真)
重定义数组 (索引, 假, 取已选择表项数 ())
赋值 (索引, 取被选择表项 ())
.判断循环首 (小于或等于 (计容器, 取数组成员数 (索引)))
    处理事件 ()
    .如果真 (是否跳出)
        跳出循环 ()
    .如果真结束
    赋值 (文件名, 相加 (索引.取标题 ( [计容器], 1), 索引.取标题 ( [计容器], 0))) ' 标题1为文件所在位置，0为文件
    .如果真 (等于 (取文件属性 (文件名), -1)) ' 取文件属性失败，很可能文件已不存在，跳过
        索引.删除表项 ( [计容器])
        .如果真 (大于 (取数组成员数 (索引), 计容器))
            赋值 (修正, 计容器)
            .计次循环首 (相减 (取数组成员数 (索引), 计容器), )
                赋值 (修正, 相加 (修正, 1))
                赋值 (索引 [修正], 相减 (索引 [修正], 1))
            .计次循环尾 ()
        .如果真结束
        赋值 (计容器, 相加 (计容器, 1))
        到循环尾 ()
    .如果真结束
    .判断开始 (等于 (操作类型, “复制到”)) ' 将搜索结果里的文件复制到本机子
        .如果真 (不等于 (取文本右边 (1), “\”))
            赋值 (相加 (“\”))
        .如果真结束
        .如果 (等于 (位与 (取文件属性 (文件名), 16), 0)) ' 如果文件不是文件夹
            赋值 (新全径, 相加 (目标, 索引.取标题 ( [计容器], 0)))
            复制文件 (文件名, 新全径)
        .否则
            文件夹复制 (文件名)
        .如果结束
        刷新显示 ()
        赋值 (.标题, 文件名)
    .判断 (等于 (操作类型, “删除”))
        .如果真 (不等于 (位与 (取文件属性 (文件名), 1), 0)) ' 判断文件是否只读
            .如果真 (等于 (置文件属性 (0), 假))
                赋值 (计容器, 相加 (计容器, 1))
                到循环尾 ()
            .如果真结束
            
        .如果真结束
        .如果 (等于 (位与 (取文件属性 (文件名), 16), 0)) ' 是否是文件夹
            .如果真 (删除文件 (文件名))
                索引.删除表项 ( [计容器])
                .如果真 (大于 (取数组成员数 (索引), 计容器))
                    赋值 (修正, 计容器)
                    .计次循环首 (相减 (取数组成员数 (索引), 计容器), )
                        赋值 (修正, 相加 (修正, 1))
                        赋值 (索引 [修正], 相减 (索引 [修正], 1))
                    .计次循环尾 ()
                .如果真结束
                
            .如果真结束
            
        .否则
            .如果真 (删除目录 (文件名))
                索引.删除表项 ( [计容器])
                .如果真 (大于 (取数组成员数 (索引), 计容器))
                    赋值 (修正, 计容器)
                    .计次循环首 (相减 (取数组成员数 (索引), 计容器), )
                        赋值 (修正, 相加 (修正, 1))
                        赋值 (索引 [修正], 相减 (索引 [修正], 1))
                    .计次循环尾 ()
                .如果真结束
                
            .如果真结束
            
        .如果结束
        刷新显示 ()
        赋值 (.标题, 文件名)
    .判断 (等于 (操作类型, “更名”))
        赋值 (原属性, 取文件属性 (文件名))
        .如果真 (不等于 (位与 (原属性, 1), 0)) ' 防止属性为只读时不能进行操作
            .如果真 (等于 (置文件属性 (0), 假))
                赋值 (计容器, 相加 (计容器, 1))
                到循环尾 ()
            .如果真结束
            
        .如果真结束
        赋值 (新全径, 相加 (取文本左边 (文件名, 倒找文本 (文件名, “\”, 取文本长度 (文件名), 假)), 新文件名))
        .如果 (等于 (文件更名 (文件名, 新全径), 假)) ' 防止有重名时更名不成功
            赋值 (新全径, 相加 (取文本左边 (文件名, 倒找文本 (文件名, “\”, 取文本长度 (文件名), 假)), 到文本 (免重名), 新文件名))
            文件更名 (文件名, 新全径)
            索引.置标题 ( [计容器], , 相加 (到文本 (免重名), 新文件名))
            赋值 (免重名, 相加 (免重名, 1))
        .否则
            索引.置标题 ( [计容器], , 新文件名)
        .如果结束
        .如果真 (不等于 (取文件属性 (新全径), 原属性)) ' 还原文件的原来属性
            置文件属性 (新全径, 原属性)
        .如果真结束
        
    .判断 (等于 (操作类型, “置属性”))
        置文件属性 (文件名, )
    .默认
        
    .判断结束
    赋值 (计容器, 相加 (计容器, 1))
.判断循环尾 ()
未知函数_67175125 (“操作”, 假)
处理禁止 ()

.子程序 文件夹复制, 逻辑型, , 复制文件夹里的所有文件
.参数 目录, 文本型, , 

.如果真 (不等于 (取文本右边 (1), “\”))
    赋值 (相加 (“\”))
.如果真结束
.如果真 (等于 (取文本右边 (目录, 1), “\”))
    赋值 (目录, 取文本左边 (目录, 相减 (取文本长度 (目录), 1)))
.如果真结束
赋值 (当前目录, 相加 (取文本右边 (目录, 相减 (取文本长度 (目录), 倒找文本 (目录, “\”, , 假))), “\”))
赋值 (原有长度, 倒找文本 (目录, “\”, , 假))
赋值 (目录, 相加 (目录, “\”))
.如果 (等于 (取文件属性 (当前目录), -1)) ' 如果目录不存在 
    .如果真 (等于 (目录创建 (当前目录), 假))
        返回 (假)
    .如果真结束
    
.否则
    .如果真 (等于 (位与 (取文件属性 (当前目录), 16), 0)) ' 存在与目录同名文件时返回
        返回 (假)
    .如果真结束
    
.如果结束
置文件属性 (当前目录, 取文件属性 (目录))
搜索复制 (目录)
返回 (真)

.子程序 _选择框选项_被单击, 空白型, , 
.如果 (等于 (.选中, 假))
    未知函数_67175025 ()
.否则
    载入 (选项窗口, , 真)
.如果结束


.子程序 取类型, 整数型, , 返回对应类型的图片索引
.参数 文件名, 文本型, , 

.局部变量 ff, 整数型, , , 
.局部变量 扩展名, 文本型, , , 

.如果真 (不等于 (位与 (取文件属性 (文件名), 16), 0))
    返回 (0)
.如果真结束
赋值 (ff, 倒找文本 (文件名, “.”, , 假))
赋值 (扩展名, 到小写 (取文本右边 (文件名, 相减 (相加 (取文本长度 (文件名), 1), ff))))
.判断开始 (或者 (等于 (扩展名, “.txt”), 等于 (扩展名, “.ini”), 等于 (扩展名, “.js”)))
    返回 (1)
.判断 (等于 (扩展名, “.exe”))
    返回 (2)
.判断 (或者 (等于 (扩展名, “.jpg”), 等于 (扩展名, “.bmp”), 等于 (扩展名, “.gif”), 等于 (扩展名, “.jpeg”), 等于 (扩展名, “.ico”), 等于 (扩展名, “.tif”)))
    返回 (3)
.判断 (或者 (等于 (扩展名, “.htm”), 等于 (扩展名, “.html”), 等于 (扩展名, “.xml”), 等于 (扩展名, “.asp”)))
    返回 (4)
.判断 (或者 (等于 (扩展名, “.zip”), 等于 (扩展名, “.cab”), 等于 (扩展名, “.tar”)))
    返回 (5)
.判断 (或者 (等于 (扩展名, “.rar”), 等于 (扩展名, “.jar”), 等于 (扩展名, “.arj”), 等于 (扩展名, “.iso”), 等于 (扩展名, “.uue”)))
    返回 (6)
.判断 (或者 (等于 (扩展名, “.ra”), 等于 (扩展名, “.rm”), 等于 (扩展名, “.ram”)))
    返回 (7)
.判断 (或者 (等于 (扩展名, “.avi”), 等于 (扩展名, “.mpep”), 等于 (扩展名, “.mpga”), 等于 (扩展名, “.mov”), 等于 (扩展名, “.asf”)))
    返回 (8)
.判断 (或者 (等于 (扩展名, “.wav”), 等于 (扩展名, “.mp3”), 等于 (扩展名, “.mid”), 等于 (扩展名, “.midi”)))
    返回 (9)
.判断 (等于 (扩展名, “.doc”))
    返回 (10)
.判断 (等于 (扩展名, “.dll”))
    返回 (11)
.默认
    返回 (12) ' 12为未知文件类型
.判断结束


.子程序 取大小, 文本型, , 取文件大小
.参数 文件名, 文本型, , 

.局部变量 原始大小, 长整数型, , , 单位K
.局部变量 返回文本, 文本型, , , 

赋值 (原始大小, 四舍五入 (相除 (取文件尺寸 (文件名), 1024), 2))
.如果 (大于 (原始大小, 1024))
    赋值 (返回文本, 相加 (到文本 (四舍五入 (相除 (原始大小, 1024), 2)), “M”))
.否则
    赋值 (返回文本, 相加 (到文本 (原始大小), “K”))
.如果结束
返回 (返回文本)

.子程序 _列表框_右键单击表项, 空白型, , 
处理禁止 ()
弹出菜单 ()

.子程序 _列表框_左键单击表项, 空白型, , 
处理禁止 ()

.子程序 _列表框_结束编辑, 逻辑型, , 
.参数 表项索引, 整数型, , 

.局部变量 原属性, 短整数型, , , 
.局部变量 文件名, 文本型, , , 
.局部变量 新文件, 文本型, , , 

赋值 (文件名, 相加 (表项索引.取标题 (1), 表项索引.取标题 (0)))
赋值 (新文件, 相加 (表项索引.取标题 (1), .))
赋值 (原属性, 取文件属性 (文件名))
.如果 (文件是否存在 (文件名))
    .如果真 (文件是否存在 (新文件))
        信息框 (“已经存在同名文件，请使用其它文件名。”, 16, “错误”)
        赋值 (.标题, “更名失败”)
        返回 (假)
    .如果真结束
    .如果真 (不等于 (位与 (1), 0)) ' 防止属性为只读时不能进行操作
        .如果真 (等于 (置文件属性 (0), 假))
            信息框 (“更名失败，文件可能已经不存在。”, 16, “错误”)
            赋值 (.标题, “更名失败”)
            返回 (假)
        .如果真结束
        
    .如果真结束
    .如果 (文件更名 (文件名, 新文件))
        .如果真 (不等于 (取文件属性 (新文件), 原属性))
            置文件属性 (新文件, 原属性)
        .如果真结束
        赋值 (.标题, “更名成功”)
    .否则
        信息框 (“更名失败！”, 16, “错误”)
        赋值 (.标题, “更名失败”)
        返回 (假)
    .如果结束
    
.否则
    信息框 (“更名失败，文件可能已经不存在。”, 16, “错误”)
    赋值 (.标题, “更名失败”)
    返回 (假)
.如果结束


.窗口程序集 属性程序集, , , 

.程序集变量 原属性, 字节型, , , 
.子程序 _属性窗口_创建完毕, 空白型, , 依次读入文件各项属性
.局部变量 文件大小, 长整数型, , , 单位K
.局部变量 文件数, 整数型, , , 
.局部变量 文件夹数, 整数型, , , 
.局部变量 文件名, 文本型, , , 
.局部变量 索引, 整数型, , "0", 
.局部变量 计容器, 整数型, , , 

赋值 (计容器, 1)
赋值 (文件大小, 0)
重定义数组 (索引, 假, _启动窗口.取已选择表项数 (.))
赋值 (索引, _启动窗口.取被选择表项 (.))
.判断循环首 (小于或等于 (计容器, 取数组成员数 (索引)))
    赋值 (文件名, 相加 (_启动窗口.取标题 (., 索引 [计容器], 1), _启动窗口.取标题 (., 索引 [计容器], 0)))
    赋值 (文件大小, 相加 (文件大小, 四舍五入 (相除 (取文件尺寸 (文件名), 1024), 2)))
    .如果 (等于 (位与 (取文件属性 (文件名), 16), 0))
        赋值 (文件数, 相加 (文件数, 1))
    .否则
        赋值 (文件夹数, 相加 (文件夹数, 1))
    .如果结束
    .如果真 (等于 (位与 (取文件属性 (文件名), 1), 0))
        赋值 (.选中, 假)
    .如果真结束
    .如果真 (等于 (位与 (取文件属性 (文件名), 2), 0))
        赋值 (.选中, 假)
    .如果真结束
    .如果真 (等于 (位与 (取文件属性 (文件名), 32), 0))
        赋值 (.选中, 假)
    .如果真结束
    .如果真 (等于 (位与 (取文件属性 (文件名), 4), 0))
        赋值 (.选中, 假)
    .如果真结束
    赋值 (计容器, 相加 (计容器, 1))
.判断循环尾 ()
.如果 (等于 (取数组成员数 (索引), 1))
    赋值 (.标题, 文件名)
.否则
    赋值 (.标题, 相加 (“多文件(”, 到文本 (文件数), “个文件、”, 到文本 (文件夹数), “个文件夹)”))
.如果结束
.如果 (小于 (文件大小, 1000))
    赋值 (.标题, 相加 (到文本 (文件大小), “ KB”))
.否则
    赋值 (.标题, 相加 (到文本 (四舍五入 (相除 (文件大小, 1024), 2)), “ MB”))
.如果结束
赋值 (原属性, 0)
.如果真 (等于 (.选中, 真))
    赋值 (原属性, 相加 (原属性, 1))
.如果真结束
.如果真 (等于 (.选中, 真))
    赋值 (原属性, 相加 (原属性, 2))
.如果真结束
.如果真 (等于 (.选中, 真))
    赋值 (原属性, 相加 (原属性, 32))
.如果真结束
.如果真 (等于 (.选中, 真))
    赋值 (原属性, 相加 (原属性, 4))
.如果真结束


.子程序 _按钮1_被单击, 空白型, , 确定钮
赋值 (设置属性, 0)
.如果真 (等于 (.选中, 真))
    赋值 (设置属性, 相加 (设置属性, 1))
.如果真结束
.如果真 (等于 (.选中, 真))
    赋值 (设置属性, 相加 (设置属性, 2))
.如果真结束
.如果真 (等于 (.选中, 真))
    赋值 (设置属性, 相加 (设置属性, 32))
.如果真结束
.如果真 (等于 (.选中, 真))
    赋值 (设置属性, 相加 (设置属性, 4))
.如果真结束
.如果 (或者 (不等于 (设置属性, 原属性), 不等于 (_启动窗口.取已选择表项数 (.), 1)))
    销毁 ()
    _启动窗口.获取焦点 ()
    赋值 (_启动窗口..标题, “设置属性”)
    列表框操作 (“置属性”)
    处理禁止 ()
    赋值 (_启动窗口..标题, “设置完成”)
.否则
    销毁 ()
.如果结束


.子程序 _按钮2_被单击, 空白型, , 取消钮
销毁 ()

.窗口程序集 复制程序集, , , 

.子程序 _复制窗口_创建完毕, 空白型, , 
.如果 (等于 (目标, “”))
    赋值 (.内容, 相加 (.驱动器, “:\”))
.否则
    赋值 (.内容, 目标)
.如果结束


.子程序 _驱动器框_驱动器被改变, 空白型, , 
赋值 (.内容, 相加 (.驱动器, “:\”))
赋值 (.目录, 相加 (.驱动器, “:\”))

.子程序 _目录框_目录被改变, 空白型, , 
赋值 (.内容, .目录)

.子程序 _按钮1_被单击, 空白型, , 确定钮
赋值 (目标, .内容)
.如果 (等于 (取文件属性 (), -1)) ' 目录不存在时创建
    .如果真 (等于 (信息框 (“路径不存在，是否创建？”, 33, “询问”), #确认钮))
        .如果 (等于 (目录创建 (), 假))
            信息框 (“目录创建失败！检查是否含有非法字符后请重新输入！”, 16, “错误”)
        .否则
            销毁 ()
            _启动窗口.获取焦点 ()
            赋值 (_启动窗口..标题, “正在复制”)
            列表框操作 (“复制到”)
            赋值 (_启动窗口..标题, “复制完成”)
        .如果结束
        
    .如果真结束
    
.否则
    .如果 (等于 (位与 (取文件属性 (), 16), 0))
        信息框 (“目录与现有文件重名，请重新输入！”, 16, “错误”)
    .否则
        销毁 ()
        _启动窗口.获取焦点 ()
        赋值 (_启动窗口..标题, “正在复制”)
        列表框操作 (“复制到”)
        赋值 (_启动窗口..标题, “复制完成”)
    .如果结束
    
.如果结束


.子程序 _按钮2_被单击, 空白型, , 取消钮
销毁 ()

.子程序 _复制窗口_尺寸被改变, 空白型, , 
.如果真 (小于 (.宽度, 243))
    赋值 (.宽度, 243)
.如果真结束
.如果真 (小于 (.高度, 246))
    赋值 (.高度, 246)
.如果真结束
赋值 (.宽度, 相减 (.宽度, 16))
赋值 (.宽度, 相减 (.宽度, 16))
赋值 (.高度, 相减 (.高度, 134))
赋值 (.宽度, 相减 (.宽度, 72))
赋值 (.左边, 相减 (.宽度, 133))
赋值 (.左边, 相减 (.宽度, 68))
赋值 (.顶边, 相减 (.高度, 49))
赋值 (.顶边, 相减 (.高度, 49))

.窗口程序集 选项程序集, , , 

.程序集变量 大于, 短整数型, , , 
.程序集变量 小于, 短整数型, , , 
.程序集变量 无限制, 逻辑型, , , 
.程序集变量 只读属性, 逻辑型, , , 
.程序集变量 隐藏属性, 逻辑型, , , 
.程序集变量 存档属性, 逻辑型, , , 
.程序集变量 系统属性, 逻辑型, , , 
.程序集变量 包含, 逻辑型, , , 
.程序集变量 上次范围, 逻辑型, , , 
.程序集变量 上次类型, 字节型, , , 
.程序集变量 计次, 字节型, , , 
.程序集变量 使用选项, 逻辑型, , , 
.程序集变量 文件属性, 短整数型, , , 
.子程序 _选项窗口_创建完毕, 空白型, , 显示上次设置
赋值 (使用选项, 假)
.如果真 (等于 (计次, 0)) ' 第一次载入时初始化
    赋值 (上次范围, 真)
    赋值 (无限制, 真)
    赋值 (包含, 真)
    赋值 (计次, 1)
.如果真结束
.如果 (上次范围)
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 真)
.如果结束
.如果真 (或者 (等于 (上次类型, 55), 等于 (上次类型, 0)))
    赋值 (.选中, 真)
.如果真结束
.如果真 (等于 (上次类型, 20))
    赋值 (.选中, 真)
.如果真结束
.如果真 (等于 (上次类型, 39))
    赋值 (.选中, 真)
.如果真结束
.如果真 (大于 (大于, 0))
    赋值 (.选中, 真)
    赋值 (.内容, 到文本 (大于))
.如果真结束
.如果真 (大于 (小于, 0))
    赋值 (.选中, 真)
    赋值 (.内容, 到文本 (小于))
.如果真结束
.如果 (包含)
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 真)
.如果结束
.如果真 (只读属性)
    赋值 (.选中, 真)
.如果真结束
.如果真 (隐藏属性)
    赋值 (.选中, 真)
.如果真结束
.如果真 (存档属性)
    赋值 (.选中, 真)
.如果真结束
.如果真 (系统属性)
    赋值 (.选中, 真)
.如果真结束
.如果 (等于 (无限制, 真))
    赋值 (.选中, 真)
.否则
    _选择框3_被单击 ()
.如果结束


.子程序 _按钮1_被单击, 空白型, , 确定钮
赋值 (文件属性, 0)
.如果 (.选中)
    赋值 (范围, 真)
.否则
    赋值 (范围, 假)
.如果结束
赋值 (上次范围, 范围)
.如果真 (.选中)
    赋值 (类型, 55)
.如果真结束
.如果真 (.选中)
    赋值 (类型, 20)
.如果真结束
.如果真 (.选中)
    赋值 (类型, 39)
.如果真结束
赋值 (上次类型, 类型)
.如果 (并且 (等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 真))) ' 无大小及属性限制则不需要判断
    赋值 (是否判断, 假)
    赋值 (大于, -1) ' 消除上次大小设置
    赋值 (小于, -1)
.否则
    赋值 (是否判断, 真)
    .如果 (.选中)
        赋值 (大于, 到数值 (.内容))
        .如果真 (小于 (大于, 0))
            信息框 (“大小选项不能设置为负值！”, 16, “错误”)
            返回 ()
        .如果真结束
        
    .否则
        赋值 (大于, -1)
    .如果结束
    .如果 (.选中)
        赋值 (小于, 到数值 (.内容))
        .如果真 (小于 (小于, 0))
            信息框 (“大小选项不能设置为负值！”, 16, “错误”)
            返回 ()
        .如果真结束
        
    .否则
        赋值 (小于, -1)
    .如果结束
    .如果真 (或者 (并且 (.选中, 等于 (.内容, “”)), 并且 (.选中, 等于 (.内容, “”))))
        信息框 (“请输入所要设定的大小数值！”, 16, “错误”)
        返回 ()
    .如果真结束
    .如果真 (并且 (.选中, .选中, 大于 (大于, 小于)))
        信息框 (“大小数值错误，请调整顺序！”, 16, “错误”)
        返回 ()
    .如果真结束
    .如果 (.选中)
        赋值 (无限制, 真)
    .否则
        赋值 (无限制, 假)
    .如果结束
    .如果 (.选中)
        赋值 (只读属性, 真)
        赋值 (文件属性, 相加 (文件属性, 1))
    .否则
        赋值 (只读属性, 假)
    .如果结束
    .如果 (.选中)
        赋值 (隐藏属性, 真)
        赋值 (文件属性, 相加 (文件属性, 2))
    .否则
        赋值 (隐藏属性, 假)
    .如果结束
    .如果 (.选中)
        赋值 (存档属性, 真)
        赋值 (文件属性, 相加 (文件属性, 32))
    .否则
        赋值 (存档属性, 假)
    .如果结束
    .如果 (.选中)
        赋值 (系统属性, 真)
        赋值 (文件属性, 相加 (文件属性, 4))
    .否则
        赋值 (系统属性, 假)
    .如果结束
    .如果 (.选中)
        赋值 (包含, 真)
    .否则
        赋值 (包含, 假)
    .如果结束
    
.如果结束
赋值 (使用选项, 真)
销毁 ()

.子程序 _按钮2_被单击, 空白型, , 取消钮
赋值 (使用选项, 假)
销毁 ()

.子程序 _选择框3_被单击, 空白型, , 无限制 选择框
赋值 (.禁止, .选中)
赋值 (.禁止, .选中)
赋值 (.禁止, .选中)
赋值 (.禁止, .选中)
赋值 (.禁止, .选中)
赋值 (.禁止, .选中)

.子程序 是否符合条件, 逻辑型, , 
.参数 文件名, 文本型, , 

.如果真 (不等于 (大于, -1))
    .如果真 (大于 (大于, 四舍五入 (相除 (取文件尺寸 (文件名), 1024), 1))) ' 文件尺寸小
        返回 (假)
    .如果真结束
    
.如果真结束
.如果真 (不等于 (小于, -1))
    .如果真 (小于 (小于, 四舍五入 (相除 (取文件尺寸 (文件名), 1024), 1))) ' 文件尺寸大
        返回 (假)
    .如果真结束
    
.如果真结束
.如果真 (等于 (无限制, 假))
    .如果 (包含)
        .如果真 (并且 (只读属性, 等于 (位与 (取文件属性 (文件名), 1), 0)))
            返回 (假)
        .如果真结束
        .如果真 (并且 (隐藏属性, 等于 (位与 (取文件属性 (文件名), 2), 0)))
            返回 (假)
        .如果真结束
        .如果真 (并且 (存档属性, 等于 (位与 (取文件属性 (文件名), 32), 0)))
            返回 (假)
        .如果真结束
        .如果真 (并且 (系统属性, 等于 (位与 (取文件属性 (文件名), 4), 0)))
            返回 (假)
        .如果真结束
        
    .否则
        .如果真 (不等于 (取文件属性 (文件名), 文件属性))
            返回 (假)
        .如果真结束
        
    .如果结束
    
.如果真结束
返回 (真)

.子程序 _选项窗口_将被销毁, 空白型, , 
.如果真 (等于 (使用选项, 假))
    赋值 (_启动窗口..选中, 假)
.如果真结束


.窗口程序集 说明程序集, , , 

.子程序 _说明窗口_创建完毕, 空白型, , 
赋值 (.内容, 相加 (#换行符, “   局域网中机子的编号基本上都是很有规律的，要么是用数字，要么是用字母， 此程序利用自动更换地址进行共享目录的搜索，复制等。”, #换行符, #换行符, “    主要对几项设置说明一下：”, #换行符, #换行符, “    一 机子编号及起止位置的设置：”, #换行符, “       与FLASHGET(网际快车)的批文件下载相似，以*号代替机号。例如，你所处的局域网中，机子编号以数字组成：001、002…010…100等，你可以在搜索范围中填入：\\*\想要搜索的共享目录，选择起号为1，终止号为100，通配符(既*)长度为3，在编号不足三位时程序会自动在前补零；若编号为1、2、3…10……100，只需将通配符长度改为1既可。字母同样，但要注意大小写。如果既有'A'号机又有'a'号，应把大写放在前面。”, #换行符, #换行符, “    二 搜索选项”, #换行符, “       这是一个单选框，选中时使用所设置选项。每次设置时载入的是上次的搜索选项，若不需修改可直接点击确定。”, #换行符, “      在属性栏里有两个单选框 '包含' 和 '匹配'，选 '包含' 时，搜索到的文件只要有你所设置的属性就添加到结果，例如只设置了 '只读' 属性，若搜索到的文件是 '只读隐藏' 的，也加到结果，而选 '匹配' 时仅在文件只有 '只读' 属性时，才添加。 ”, #换行符, “      注意：由于没有读取文件夹的大小，所有文件夹都为零字节，所以在搜索文件夹时，不能设置大小选项，否则将搜索不到结果。”, #换行符, #换行符, “    三 复制方式”, #换行符, “       此方式是将本机上的文件或文件夹复制到其它机子上，只要点击浏览按纽选择文件既可。若要复制文件夹，自行输入文件夹地址。复制目标路径可存在也可不存在，程序会自动创建不存在目录。”, #换行符))

.子程序 _按钮1_被单击, 空白型, , 
销毁 ()


 ' 不属于任何一个程序集、类模块的函数：
