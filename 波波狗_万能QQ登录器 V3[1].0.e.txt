 ' 文件类型：Windows窗口程序

 ' 程序名称：波波狗_万能QQ登录器 V3.0
 ' 程序描述：QQ登录器 V3.0
@备注:
http://user.qzone.qq.com/370360177
 ' 程序作者：Dream sea QQ:370360177
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 591
    高度 = 392
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\波波狗_万能QQ登录器 V3[1].0.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “波波狗_万能QQ登录器 V3.0”
    帮助文件名 = “”

窗口 窗口1_添加_修改
    左边 = 50
    顶边 = 50
    宽度 = 247
    高度 = 286
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口1_软件_设置
    左边 = 50
    顶边 = 48
    宽度 = 624
    高度 = 353
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “软件设置”
    帮助文件名 = “”



.常量 BASE64集合, "“ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/”", , 
.常量 , , , 
.常量 PROCESS_QUERY_INFORMATION, "1024", , 
.常量 PROCESS_VM_READ, "16", , 
.常量 MEM_PRIVATE, "131072", , 
.常量 PAGE_READWRITE, "4", , 
.常量 TH32CS_SNAPALL, "15", , 
.常量 , , , 
.图片 QQ登陆器, " ' 已保存到：D:\易语言学习\Data\波波狗_万能QQ登录器 V3[1].0.e\QQ登陆器", , 
.图片 皮肤, " ' 已保存到：D:\易语言学习\Data\波波狗_万能QQ登录器 V3[1].0.e\皮肤", , skinh.she
.图片 皮肤2, " ' 已保存到：D:\易语言学习\Data\波波狗_万能QQ登录器 V3[1].0.e\皮肤2", , SkinH.she
.图片 皮肤3, " ' 已保存到：D:\易语言学习\Data\波波狗_万能QQ登录器 V3[1].0.e\皮肤3", , skinh.she
.图片 SkinH_EL, " ' 已保存到：D:\易语言学习\Data\波波狗_万能QQ登录器 V3[1].0.e\SkinH_EL", , SkinH_EL.dll


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' internet 707ca37322474f6ca841f0e224f4b620 2 0 互联网支持库
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 2 0 数据操作支持库一
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 3 0 应用接口支持库
 ' PBShell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库(PB版)




数据类型 好友信息, , 
    .成员 号码, 长整数型, , , 
    .成员 昵称, 文本型, , , 

数据类型 PROCESSENTRY32, , 
    .成员 dwSize, 整数型, , , 
    .成员 cntUsage, 整数型, , , 
    .成员 th32ProcessID, 整数型, , , 
    .成员 th32DefaultHeapID, 整数型, , , 
    .成员 th32ModuleID, 整数型, , , 
    .成员 cntThreads, 整数型, , , 
    .成员 th32ParentProcessID, 整数型, , , 
    .成员 pcPriClassBase, 整数型, , , 
    .成员 dwFlags, 整数型, , , 
    .成员 szExeFile, 字节型, , "256", 

数据类型 MEMORY_BASIC_INFORMATION, , 
    .成员 BaseAddress, 整数型, , , 
    .成员 AllocationBase, 整数型, , , 
    .成员 AllocattionProtect, 整数型, , , 
    .成员 RegionSize, 整数型, , , 
    .成员 State, 整数型, , , 
    .成员 Protect, 整数型, , , 
    .成员 Type, 整数型, , , 

.全局变量 记录位置, 整数型, , , 
.全局变量 标识, 文本型, , , 
.全局变量 匿名全局变量_1564, 空白型, , , 
.全局变量 关键字, 字节集, , , \MsgEx.db
.全局变量 路径分隔符, 字节集, , , \
.全局变量 匿名全局变量_1565, 空白型, , , 

.DLL命令 从资源加载皮肤, 整数型, "SkinH_EL.dll", "SkinH_AttachRes", 公开, 从资源添加皮肤，并指定皮肤的色调，饱和度，亮度，成功返回0
    .参数 资源皮肤, 字节集, , 皮肤数据
    .参数 资源大小, 整数型, , 皮肤数据大小
    .参数 皮肤密码, 文本型, , 皮肤密钥
    .参数 色调, 整数型, , 取值范围 -180 - 180
    .参数 饱和度, 整数型, , 取值范围 -100 - 100
    .参数 亮度, 整数型, , 取值范围 -100 - 100

.DLL命令 CreateToolhelp32Snapshot, 整数型, "", "", , 
    .参数 lFlags, 整数型, , 
    .参数 lProcessID, 整数型, , 

.DLL命令 Process32First, 整数型, "", "", , 
    .参数 hSnapShot, 整数型, , 
    .参数 uProcess, PROCESSENTRY32, , 

.DLL命令 Process32Next, 整数型, "", "", , 
    .参数 hSnapShot, 整数型, , 
    .参数 uProcess, PROCESSENTRY32, , 

.DLL命令 OpenProcess, 整数型, "", "", , 
    .参数 dwDesiredAccess, 整数型, , 
    .参数 bInheritHandle, 整数型, , 
    .参数 dwProcessId, 整数型, , 

.DLL命令 CloseHandle, 整数型, "", "", , 
    .参数 hObject, 整数型, , 

.DLL命令 ReadProcessMemory, 整数型, "", "", , 
    .参数 hProcess, 整数型, , 
    .参数 lpBaseAddress, 整数型, , 
    .参数 lpBuffer, 字节集, 传址, 
    .参数 nSize, 整数型, , 
    .参数 lpNumberOfBytesWritten, 整数型, , 

.DLL命令 VirtualQueryEx, 整数型, "", "", , 
    .参数 hProcess, 整数型, , 
    .参数 lpAddress, 整数型, , 
    .参数 info, MEMORY_BASIC_INFORMATION, 传址, 
    .参数 dwLength, 整数型, , 

.DLL命令 GetModuleFileName, 整数型, "kernel32", "GetModuleFileNameA", , 获取一个已装载模板的完整路径名称  如执行成功，返回复制到lpFileName的实际字符数量；零表示失败。会设置GetLastError
    .参数 hModule, 整数型, , 一个模块的句柄。可以是一个DLL模块，或者是一个应用程序的实例句柄
    .参数 lpFileName, 文本型, , 指定一个字串缓冲区，要在其中容纳文件的用NULL字符中止的路径名，hModule模块就是从这个文件装载进来的
    .参数 nSize, 整数型, , 装载到缓冲区lpFileName的最大字符数量;

.窗口程序集 窗口程序集1, , , 

.程序集变量 全选, 逻辑型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 


 ' CRC32核对 ()
创建数据库 ()
读取记录2 ()
 ' 读取记录 ()
赋值 (_启动窗口., 591)
赋值 (_启动窗口., 262)
.如果真 (等于 (取文本注册项 (#本地机器, “Software\QQLanded\Auto Login”, ), “1”)) ' 自动登陆设定的QQ
    自动登陆 ()
.如果真结束
.如果真 (等于 (取文本注册项 (#本地机器, “Software\QQLanded\Shortcuts”, ), “1”))
    创建快捷方式 (相加 (取运行目录 (), “\”, 取文本左边 (到文本 (取执行文件名 ()), 相减 (取文本长度 (到文本 (取执行文件名 ())), 4)), “.lnk”), 取运行目录 (), 相加 (取运行目录 (), “\”, 到文本 (取执行文件名 ())), , 1, “QQ登陆器V1.0”, “”, “Ctrl+Q”)
.如果真结束
.如果真 (等于 (取文本注册项 (#本地机器, “Software\QQLanded\Default Skin”, ), “1”))
    加载皮肤 ()
.如果真结束
.如果 (等于 (取文本注册项 (#本地机器, “Software\QQLanded\Procedures Password”, ), “1”))
    启动软件密码保护 ()
.否则
    赋值 (_启动窗口., 真)
.如果结束






.如果真 (等于 (取文本注册项 (#本地机器, “Software\QQLanded\Frequency”, ), “”))
    信息框 (“您是第一次便用软件，为了更好地为你服务，是否查看本软件更新和便用说明”, 0, “欢迎便用_波波狗_万能QQ登录器V3.0”)
    信息框 (“QQ安装目录查找完成，如果有错误或查找失败请手工查找！”, 0, )
    未知支持库函数_56 (“http://user.qzone.qq.com/370360177/blog/1280752902”)
    载入 (窗口1_软件_设置, , 真)
    写注册项 (#本地机器, “Software\QQLanded\Frequency”, “1”)
.如果真结束



.子程序 启动软件密码保护, 空白型, , 
.局部变量 输入框文本变量, 文本型, , , 
.局部变量 i, 整数型, , , 
.局部变量 密码提示, 文本型, , , 

到首记录 ()
.计次循环首 (取记录数 (), i)
    .如果真 (查找 (等于 (读 (“用户权限”), “高级管理员权限”)))
        赋值 (密码提示, 读 (“密码提示”))
    .如果真结束
    跳过 ()
.计次循环尾 ()

.如果 (输入框 (相加 (“密码提示: ”, 密码提示, “ ?”), “软件启动密码”, “”, 输入框文本变量, 1))
    到首记录 ()
    .计次循环首 (取记录数 (), i)
        .如果真 (查找 (等于 (读 (“用户权限”), “高级管理员权限”)))
            输出调试文本 (读 (“QQ密码”))
            输出调试文本 (读 (“密码提示”))
            输出调试文本 (读 (“密码答案”))
            .如果 (或者 (等于 (读 (“QQ密码”), 输入框文本变量), 等于 (读 (“密码答案”), 输入框文本变量)))
                赋值 (_启动窗口., 真)
            .否则
                信息框 (“您输入的密码不正确 ”, 0, )
                销毁 ()
            .如果结束
            
        .如果真结束
        跳过 ()
    .计次循环尾 ()
    
.否则
    销毁 ()
.如果结束


.子程序 自动登陆, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 隐身, 逻辑型, , , 
.局部变量 登陆次数, 整数型, , , 

到首记录 ()
.计次循环首 (取记录数 (), i)
    .如果真 (等于 (读 (“自动登陆”), “真”))
        .如果 (等于 (读 (“登陆QQ版本”), “QQ2008”))
            .如果真 (等于 (QQ是否已登录_ (读 (“QQ帐号”)), 假))
                .判断开始 (等于 (读 (“是否隐身”), “真”))
                    赋值 (隐身, 真)
                .默认
                    赋值 (隐身, 假)
                .判断结束
                赋值 (登陆次数, 相加 (到整数 (读 (“登陆次数”)), 1))
                修改 (时间格式化 (取现行时间 (), 5), , , 到文本 (登陆次数))
                登录 (读 (“QQ帐号”), 读 (“QQ密码”), 隐身)
            .如果真结束
            
        .否则
            延时 (5000)
            赋值 (登陆次数, 相加 (到整数 (读 (“登陆次数”)), 1))
            修改 (时间格式化 (取现行时间 (), 5), , , 到文本 (登陆次数))
            登陆2009或2010 (读 (“QQ帐号”), 读 (“QQ密码”), 读 (“登陆QQ版本”))
        .如果结束
        
    .如果真结束
    处理事件 ()
    跳过 ()
.计次循环尾 ()
读取记录2 ()





.子程序 读取记录, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 索引, 整数型, , , 

打开 (相加 (取运行目录 (), “\data\Online Music.MP3”), , , , , “qq370360177”, )
全部删除 ()
到首记录 ()
.计次循环首 (取记录数 (), i)
    赋值 (索引, .插入表项 ())
    索引.置标题 (1, 相加 (到文本 (i), “ ”, 读 (“QQ昵称”)))
    索引.置标题 (2, 读 (“QQ帐号”))
    .如果真 (等于 (读 (“是否隐身”), “真”))
        索引.置标题 (3, “√”)
    .如果真结束
    .如果真 (等于 (读 (“记住密码”), “真”))
        索引.置标题 (4, “√”)
    .如果真结束
    .如果真 (等于 (读 (“自动登陆”), “真”))
        索引.置标题 (5, “√”)
    .如果真结束
    索引.置标题 (6, 读 (“登陆日期”))
    索引.置标题 (7, 读 (“登陆次数”))
    索引.置标题 (8, 读 (“登陆QQ版本”))
    跳过 ()
.计次循环尾 ()





.子程序 读取记录2, 空白型, , 
.局部变量 i, 整数型, , , 


赋值 (., 取颜色值 (0, 0, 255))
全部删除 ()
打开 (相加 (取运行目录 (), “\data\Online Music.MP3”), , , , , “qq370360177”, )
到首记录 ()
.计次循环首 (取记录数 (), i)
    .如果真 (查找 (等于 (读 (“用户权限”), “”)))
        .插入表项 ()
        相减 (取表项数 (), 1).置标题 (1, 相加 (到文本 (i), “ ”, 读 (“QQ昵称”)))
        相减 (取表项数 (), 1).置标题 (2, 读 (“QQ帐号”))
        .如果 (等于 (读 (“登陆QQ版本”), “QQ2008”))
            .如果真 (等于 (读 (“是否隐身”), “真”))
                相减 (取表项数 (), 1).置标题 (3, “√”)
            .如果真结束
            
        .否则
            相减 (取表项数 (), 1).置标题 (3, “×”)
        .如果结束
        .如果真 (等于 (读 (“记住密码”), “真”))
            相减 (取表项数 (), 1).置标题 (4, “√”)
        .如果真结束
        .如果真 (等于 (读 (“自动登陆”), “真”))
            相减 (取表项数 (), 1).置标题 (5, “√”)
        .如果真结束
        相减 (取表项数 (), 1).置标题 (6, 读 (“登陆日期”))
        相减 (取表项数 (), 1).置标题 (7, 读 (“登陆次数”))
        相减 (取表项数 (), 1).置标题 (8, 读 (“登陆QQ版本”))
    .如果真结束
    跳过 ()
.计次循环尾 ()




.子程序 _超级列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 QQ号码, 文本型, , , 
.局部变量 QQ密码, 文本型, , , 
.局部变量 隐身, 逻辑型, , , 
.局部变量 输入框文本变量, 文本型, 静态, , 
.局部变量 匿名局部变量_681, 空白型, , , 
.局部变量 登陆次数, 整数型, , , 
.局部变量 QQ版本, 文本型, , , 

.如果真 (等于 (., -1))
    返回 ()
.如果真结束
赋值 (QQ号码, 到文本 (.取标题 (., 2)))
输出调试文本 (QQ号码)
到首记录 ()

.计次循环首 (取记录数 (), )
    .如果真 (等于 (读 (“QQ帐号”), 到文本 (.取标题 (., 2))))
        赋值 (记录位置, 取记录号 ())
        
    .如果真结束
    处理事件 ()
    跳过 ()
.计次循环尾 ()

跳到 (记录位置)
.如果 (等于 (读 (“记住密码”), “真”))
     ' 输出调试文本 (读 (“记住密码”))
    赋值 (QQ密码, 读 (“QQ密码”))
    .判断开始 (等于 (读 (“是否隐身”), “真”))
        赋值 (隐身, 真)
    .默认
        赋值 (隐身, 假)
    .判断结束
    赋值 (登陆次数, 相加 (到整数 (读 (“登陆次数”)), 1))
    修改 (时间格式化 (取现行时间 (), 5), , , 到文本 (登陆次数))
    赋值 (QQ版本, 读 (“登陆QQ版本”))
    .如果 (等于 (QQ版本, “QQ2008”))
        .如果真 (等于 (QQ是否已登录_ (读 (“QQ帐号”)), 假))
            登录 (读 (“QQ帐号”), 读 (“QQ密码”), 隐身)
        .如果真结束
        
    .否则
         ' 登陆QQ版本类型 (QQ号码, QQ密码, QQ2009路径)
        登陆2009或2010 (QQ号码, QQ密码, QQ版本)
    .如果结束
    读取记录2 ()
    
    
    
    
    
    
    
    .如果真 (等于 (取文本注册项 (#本地机器, “Software\QQLanded\Exit Close”, ), “1”)) ' 当登陆QQ后退出本程序
        结束 ()
    .如果真结束
    
.否则
    .如果真 (输入框 (相加 (“请输入您要登陆的号码 QQ：”, QQ号码, “ 的密码”), “登陆窗口”, “”, 输入框文本变量, 1))
        输出调试文本 (QQ密码)
        .判断开始 (等于 (读 (“是否隐身”), “真”))
            赋值 (隐身, 真)
        .默认
            赋值 (隐身, 假)
        .判断结束
        赋值 (登陆次数, 相加 (到整数 (读 (“登陆次数”)), 1))
        修改 (时间格式化 (取现行时间 (), 5), , , 到文本 (登陆次数))
        赋值 (QQ版本, 读 (“登陆QQ版本”))
        .如果 (等于 (QQ版本, “QQ2008”))
            .如果真 (等于 (QQ是否已登录_ (读 (“QQ帐号”)), 假))
                登录 (读 (“QQ帐号”), 读 (“QQ密码”), 隐身)
            .如果真结束
            
        .否则
             ' 登陆QQ版本类型 (QQ号码, 输入框文本变量, QQ2009路径)
            登陆2009或2010 (QQ号码, QQ密码, QQ版本)
        .如果结束
        读取记录2 ()
        .如果真 (等于 (取文本注册项 (#本地机器, “Software\QQLanded\Exit Close”, ), “1”)) ' 当登陆QQ后退出本程序
            结束 ()
        .如果真结束
        
    .如果真结束
    
.如果结束





.子程序 _按钮7_被单击, 空白型, , 
.局部变量 m, 整数型, , , 

.计次循环首 (取表项数 (), m)
    相减 (m, 1).置状态图片 (1)
.计次循环尾 ()


.子程序 _按钮8_被单击, 空白型, , 
.局部变量 m, 整数型, , , 

.计次循环首 (取表项数 (), m)
    相减 (m, 1).置状态图片 (0)
.计次循环尾 ()


.子程序 _超级列表框1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _导入QQ和密码_被选择, 空白型, , 
.局部变量 局部_一次分割, 文本型, , "0", 
.局部变量 局部_二次分割, 文本型, , "0", 
.局部变量 计次, 整数型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 匿名局部变量_1258, 空白型, , , 
.局部变量 导入个数, 整数型, , , 

赋值 (文件号, 打开文件 (相加 (取运行目录 (), “\QQnum.txt”), , ))
 ' 处理数据-------------------------------------
赋值 (局部_一次分割, 分割文本 (读入文本 (文件号, ), #换行符, ))
赋值 (导入个数, 到整数 (取数组成员数 (局部_一次分割)))
.计次循环首 (取数组成员数 (局部_一次分割), 计次)
    赋值 (局部_二次分割, 分割文本 (局部_一次分割 [计次], “---”, ))
    .如果真 (等于 (取数组成员数 (局部_二次分割), 2))
        输出调试文本 (局部_二次分割 [1])
        到首记录 ()
        .如果 (查找 (等于 (读 (“QQ帐号”), 局部_二次分割 [1])))
            赋值 (导入个数, 相减 (导入个数, 1))
        .否则
            加记录 (局部_二次分割 [1], 局部_二次分割 [2], , “真”, , 时间格式化 (取现行时间 (), 5), , , , “QQ2008”)
        .如果结束
        
    .如果真结束
    处理事件 ()
.计次循环尾 ()
读取记录2 ()
信息框 (相加 (“成功导入: ”, 到文本 (导入个数), “ 个QQ帐号”), #信息图标, )

.子程序 _导出好友列表_被选择, 空白型, , 
.局部变量 数量, 整数型, , , 
.局部变量 号码, 好友信息, , "0", 
.局部变量 计次, 整数型, , , 
.局部变量 路径, 文本型, , , 
.局部变量 匿名局部变量_626, 空白型, , , 
.局部变量 号码2, 文本型, , , 
.局部变量 昵称, 文本型, , , 

赋值 (路径, 取文本注册项 (4, “Software\Tencent\QQ\install”, “未检测到QQ”))
赋值 (路径, 相加 (路径, “\”, .取标题 (., 2), “\User.db”))
输出调试文本 (路径)
.如果 (文件是否存在 (路径))
    赋值 (数量, 分析好友名单 (路径, 号码))
    .计次循环首 (数量, 计次)
        赋值 (号码2, 删全部空 (到文本 (号码 [计次], 号码)))
        赋值 (昵称, 删全部空 (到文本 (号码 [计次], 昵称)))
        
        写到日志 (相加 (到文本 (计次), #换行符, “昵称： ”, 昵称, #换行符, “号码： ”, 号码2, #换行符), 相加 (取运行目录 (), “\”, 到文本 (.取标题 (., 2)), “.txt”))
        
        处理事件 ()
    .计次循环尾 ()
    
.否则
    信息框 (“路径不存在”, 0, )
.如果结束



.子程序 _导出帐号和密码_被选择, 空白型, , 
.局部变量 i, 整数型, , , 

到首记录 ()
.计次循环首 (取记录数 (), i)
    写到日志 (相加 (读 (“QQ帐号”), “---”, 读 (“QQ密码”)), 相加 (取运行目录 (), “\QQ号码_密码.txt”))
    跳过 ()
.计次循环尾 ()
信息框 (相加 (“成功导出: ”, 到文本 (取记录数 ()), “ 个QQ帐号”), #信息图标, )


.子程序 _全陪登陆_被选择, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 QQ号码, 文本型, , , 
.局部变量 QQ密码, 文本型, , , 
.局部变量 隐身, 逻辑型, , , 
.局部变量 匿名局部变量_1082, 空白型, , , 
.局部变量 匿名局部变量_1083, 空白型, , , 
.局部变量 m, 整数型, , , 

.计次循环首 (取表项数 (), m)
    相减 (m, 1).置状态图片 (1)
.计次循环尾 ()
.计次循环首 (取表项数 (), i)
    .如果真 (等于 (相减 (i, 1).取当前状态图片 (), 1))
        赋值 (QQ号码, 到文本 (相减 (i, 1).取标题 (2)))
        跳到 (i)
        赋值 (QQ密码, 读 (“QQ密码”))
        .判断开始 (等于 (读 (“是否隐身”), “真”))
            赋值 (隐身, 真)
        .默认
            赋值 (隐身, 假)
        .判断结束
        登录 (QQ号码, QQ密码, 隐身)
    .如果真结束
    
.计次循环尾 ()

.如果真 (等于 (取文本注册项 (#本地机器, “Software\QQLanded\Exit Close”, ), “1”)) ' 当登陆QQ后退出本程序
    结束 ()
.如果真结束


.子程序 _登陆所选_被选择, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 QQ号码, 文本型, , , 
.局部变量 QQ密码, 文本型, , , 
.局部变量 隐身, 逻辑型, , , 

.计次循环首 (取表项数 (), i)
    .如果真 (等于 (相减 (i, 1).取当前状态图片 (), 1))
        赋值 (QQ号码, 到文本 (相减 (i, 1).取标题 (2)))
        跳到 (i)
        赋值 (QQ密码, 读 (“QQ密码”))
        .判断开始 (等于 (读 (“是否隐身”), “真”))
            赋值 (隐身, 真)
        .默认
            赋值 (隐身, 假)
        .判断结束
        登录 (QQ号码, QQ密码, 隐身)
    .如果真结束
    
.计次循环尾 ()
.如果真 (等于 (取文本注册项 (#本地机器, “Software\QQLanded\Exit Close”, ), “1”)) ' 当登陆QQ后退出本程序
    结束 ()
.如果真结束


.子程序 _添加_被选择, 空白型, , 
.如果真 (是否已创建 (窗口1_添加_修改))
    返回 ()
.如果真结束
载入 (窗口1_添加_修改, , 假)
赋值 (标识, “添加”)


.子程序 _删除_被选择, 空白型, , 
.如果真 (等于 (., -1))
    信息框 (“出错啦!请选择一个需要修改的通讯记录!”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (相加 (“确定要删除: ”, .取标题 (., 2)), 相加 (#确认取消钮, #询问图标), “删除帐号”), 1))
    返回 ()
.如果真结束
跳到 (相加 (., 1))
删除 ()
彻底删除 ()
读取记录 ()


.子程序 _删除选中_被选择, 空白型, , 
.局部变量 i, 整数型, , , 

到首记录 ()
.计次循环首 (取记录数 (), i)
    输出调试文本 (取记录数 ())
    输出调试文本 (i)
    .如果真 (等于 (相减 (i, 1).取当前状态图片 (), 1))
        输出调试文本 (相减 (i, 1).取当前状态图片 ())
        跳到 (i)
        删除 ()
        彻底删除 ()
        
    .如果真结束
    跳过 ()
.计次循环尾 ()
读取记录2 ()



.子程序 _修改_被选择, 空白型, , 
.如果真 (等于 (., -1))
    信息框 (“出错啦!请选择一个需要修改的通讯记录!”, #警告图标, )
    返回 ()
.如果真结束
.如果真 (是否已创建 (窗口1_添加_修改))
    返回 ()
.如果真结束
赋值 (标识, “修改”)
载入 (窗口1_添加_修改, , 假)



.子程序 _生成QQ_被选择, 空白型, , 
.局部变量 ID, 整数型, , , 
.局部变量 账号, 文本型, , , 
.局部变量 密码, 文本型, , , 
.局部变量 QQ版本, 文本型, , , 
.局部变量 登陆器, 字节集, , , 
.局部变量 是否隐身, 文本型, , , 
.局部变量 目录路径, 文本型, , , 

赋值 (账号, 到文本 (.取标题 (., 2)))
到首记录 ()
跳到 (相加 (., 1))
赋值 (密码, 读 (“QQ密码”))
赋值 (QQ版本, 读 (“登陆QQ版本”))
赋值 (是否隐身, 读 (“是否隐身”))
.如果真 (等于 (QQ版本, “QQ2008”))
    赋值 (目录路径, 取QQ2008安装路径 ())
.如果真结束
.如果真 (等于 (QQ版本, “QQ2009”))
    赋值 (目录路径, 取QQ2009安装路径 ())
.如果真结束
.如果真 (等于 (QQ版本, “QQ2010”))
    赋值 (目录路径, 取QQ2010安装路径 ())
.如果真结束
赋值 (登陆器, #QQ登陆器)
赋值 (登陆器, 字节集替换 (登陆器, 寻找字节集 (登陆器, 到字节集 (“AAAAAAAAAA”), ), 相加 (取文本长度 (QQ版本), 1), 相加 (到字节集 (QQ版本), { 0 })))
赋值 (登陆器, 字节集替换 (登陆器, 寻找字节集 (登陆器, 到字节集 (“BBBBBBBBBBBBBBBB”), ), 相加 (取文本长度 (账号), 1), 相加 (到字节集 (账号), { 0 })))
赋值 (登陆器, 字节集替换 (登陆器, 寻找字节集 (登陆器, 到字节集 (“CCCCCCCCCCCCCCCCCCCCCCCCC”), ), 相加 (取文本长度 (密码), 1), 相加 (到字节集 (密码), { 0 })))
赋值 (登陆器, 字节集替换 (登陆器, 寻找字节集 (登陆器, 到字节集 (“DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD”), ), 相加 (取文本长度 (目录路径), 1), 相加 (到字节集 (目录路径), { 0 })))
赋值 (登陆器, 字节集替换 (登陆器, 寻找字节集 (登陆器, 到字节集 (“EEEE”), ), 相加 (取文本长度 (是否隐身), 1), 相加 (到字节集 (是否隐身), { 0 })))
.如果 (等于 (写到文件 (相加 (未知支持库函数_7 (#), 读 (“QQ昵称”), “ [”, QQ版本, “].exe”), 登陆器), 真))
    信息框 (相加 (“生成的EXE保存到： ”, 未知支持库函数_7 (#), 读 (“QQ昵称”), “ [”, QQ版本, “].exe”), 0, “操作成功”)
.否则
    信息框 (“生成失败”, 0, )
.如果结束


.子程序 _软件设置_被选择, 空白型, , 
载入 (窗口1_软件_设置, , 假)

.子程序 _更新升级_被选择, 空白型, , 
信息框 (“为了让大家放心使用本软件，没有加入自动更新软件，因为自动更新软件会访问网络，会有人怀疑盗号，所以软件不能自动更新，有新版本时，请访问我的的空间重新下载”, 0, )
未知支持库函数_56 (“http://user.qzone.qq.com/370360177/blog/1280752902”)


.子程序 _超级列表框1_表头被单击, 空白型, , 
.参数 被单击列索引, 整数型, , 

.局部变量 m, 整数型, , , 

.如果真 (等于 (被单击列索引.取列标题 (), “√”))
    .如果 (等于 (全选, 假))
        .计次循环首 (取表项数 (), m)
            相减 (m, 1).置状态图片 (1)
        .计次循环尾 ()
        赋值 (全选, 真)
    .否则
        .计次循环首 (取表项数 (), m)
            相减 (m, 1).置状态图片 (0)
        .计次循环尾 ()
        赋值 (全选, 假)
    .如果结束
    
.如果真结束


.程序集 程序集1, , , 

.程序集变量 文件名, 文本型, , , 
.子程序 取QQ2008安装路径, 文本型, 公开, 
.局部变量 路径, 文本型, , , 

赋值 (路径, 取文本注册项 (4, “SOFTWARE\Tencent\PlatForm_Type_List\1\TypePath”, “”))
.如果真 (等于 (路径, “”))
    返回 (“路径不存在”)
.如果真结束
.如果真 (等于 (文件是否存在 (路径), 假))
    返回 (“文件不存在”)
.如果真结束
返回 (路径)




.子程序 字符文本替换, 文本型, 公开, 
.参数 内容, 文本型, , 

 ' 内容 ＝ 到半角 (内容)
赋值 (内容, 子文本替换 (内容, #引号, , , , 真))
赋值 (内容, 子文本替换 (内容, #右引号, , , , 真))
赋值 (内容, 子文本替换 (内容, #左引号, , , , 真))
赋值 (内容, 子文本替换 (内容, “,”, , , , 真))
赋值 (内容, 子文本替换 (内容, “isDispAg”, , , , 真))
赋值 (内容, 删首尾空 (内容))
.如果真 (等于 (取文本长度 (内容), 1))
    赋值 (内容, “”)
.如果真结束
返回 (内容)

.子程序 搜寻, 空白型, 公开, 如提供搜索目录路径，将会搜索此目录所有在内的文件。搜寻 (“d:\”, “exe”)
.参数 目录, 文本型, , 目录，如“C:\”盘。
.参数 文件, 文本型, , 搜索文件“mp3”

.局部变量 文件名, 文本型, , , 

处理事件 () ' 给出机会以接收停止按钮事件，搜索时会占用程序的资源，使得延时处理其它事件，所要用：“处理事件（）”。
.如果真 (不等于 (取文本右边 (目录, 1), “\”)) ' 判断当前目录的格式是否正确。如“C:”,这格式是不正确的,改为"C:\"。
    赋值 (目录, 相加 (目录, “\”))
.如果真结束
赋值 (文件名, 寻找文件 (相加 (目录, “*.”, 文件), )) ' “*.mp3”搜索MP3文件，“*.*”搜索所有文件。
.判断循环首 (不等于 (文件名, “”)) ' 判断文件名是否有效，有效向下执行搜索。
    输出调试文本 (相加 (目录, 文件名)) ' 当前搜索到的文件路径
    赋值 (文件名, 寻找文件 ()) ' 继续搜寻文件
.判断循环尾 ()
赋值 (文件名, 寻找文件 (相加 (目录, “*.*”), #子目录)) ' 搜寻目录文件，包括子目录。
.判断循环首 (不等于 (文件名, “”)) ' 判断目录名是否有效，有效向下执行搜索。
    .如果真 (不等于 (取文本左边 (文件名, 1), “.”))
         ' 搜寻 (相加 (目录, 文件名), 文件) ' 如果寻找到目录路径就搜继续搜索文件。
     ' .如果真结束
    赋值 (文件名, 寻找文件 (#子目录))
.判断循环尾 ()

.子程序 取QQ2009安装路径, 文本型, 公开, 
.局部变量 路径, 文本型, , , 

赋值 (路径, 取文本注册项 (4, “SOFTWARE\TENCENT\QQ2009\Install”, ))
.如果真 (等于 (取QQ版本 (), “QQ2010”))
    返回 (“”)
.如果真结束
.如果真 (等于 (路径, “”))
    返回 (“路径不存在”)
.如果真结束
.如果真 (等于 (文件是否存在 (路径), 假))
    返回 (“文件不存在”)
.如果真结束
返回 (相加 (路径, “\Bin\QQ.exe”))

.子程序 取QQ2010安装路径, 文本型, 公开, 
.局部变量 路径, 文本型, , , 

赋值 (路径, 取文本注册项 (#本地机器, “SOFTWARE\Tencent\PlatForm_Type_List\3\TypePath”, “”))
.如果真 (等于 (取QQ版本 (), “QQ2009”))
    返回 (“”)
.如果真结束
.如果真 (等于 (路径, “”))
    返回 (“路径不存在”)
.如果真结束
.如果真 (等于 (文件是否存在 (路径), 假))
    返回 (“文件不存在”)
.如果真结束
返回 (路径)

.子程序 取QQ版本, 文本型, 公开, 例如您的QQ是2010的，支持返回 "QQ2010" ”QQ2009 ”
返回 (取文本注册项 (#本地机器, “SOFTWARE\Tencent\PlatForm_Type_List\3\TypeName”, “”))

.子程序 加载皮肤, 空白型, 公开, 
.如果真 (等于 (文件是否存在 (相加 (取运行目录 (), “\skinh.she”)), 假))
     ' 写到文件 (取运行目录 () ＋ “\skinh.she”, #皮肤)
.如果真结束
.如果真 (等于 (文件是否存在 (相加 (取运行目录 (), “\SkinH_EL.dll”)), 假))
    写到文件 (相加 (取运行目录 (), “\SkinH_EL.dll”), #SkinH_EL)
.如果真结束
置文件属性 (相加 (取运行目录 (), “\skinh.she”), #隐藏文件)
置文件属性 (相加 (取运行目录 (), “\SkinH_EL.dll”), #隐藏文件)
从资源加载皮肤 (#皮肤, 取字节集长度 (#皮肤), “”, 0, 0, 0)


.子程序 取数值目录到组合框, 空白型, , 
.参数 目录名, 文本型, , 
.参数 组合框, 组合框, , 

.局部变量 ee, 文本型, , , 

赋值 (ee, 寻找文件 (相加 (目录名, “*.*”), #子目录))
.判断循环首 (不等于 (ee, “”))
    .如果真 (不等于 (取文本左边 (ee, 1), “.”))
        .如果 (等于 (到文本 (到数值 (ee)), ee))
            .如果真 (不等于 (ee, “0”))
                组合框.加入项目 (ee, )
                
            .如果真结束
            输出调试文本 (ee)
        .否则
            
        .如果结束
        
    .如果真结束
    赋值 (ee, 寻找文件 (#子目录))
.判断循环尾 ()




.子程序 登陆2009或2010, 空白型, 公开, 
.参数 QQ账号, 文本型, , 
.参数 QQ密码, 文本型, , 
.参数 版本, 文本型, , 

.如果真 (等于 (版本, “QQ2009”))
    .如果 (等于 (取QQ2009安装路径 (), “”))
        信息框 (“QQ2009安装路径不正确，请重新设定”, 0, )
    .否则
        登陆QQ版本类型 (QQ账号, QQ密码, 取QQ2009安装路径 ())
    .如果结束
    
.如果真结束
.如果真 (等于 (版本, “QQ2010”))
    .如果 (等于 (取QQ2010安装路径 (), “”))
        信息框 (“QQ2010安装路径不正确，请重新设定”, 0, )
    .否则
        登陆QQ版本类型 (QQ账号, QQ密码, 取QQ2010安装路径 ())
    .如果结束
    
.如果真结束




.子程序 登陆QQ版本类型, 逻辑型, 公开, 支持 QQ2008 QQ2009 QQ2010
.参数 QQ账号, 文本型, , 
.参数 QQ密码, 文本型, , 
.参数 QQ路径, 文本型, , “C:\QQ\Bin\QQ.exe”

.局部变量 QQ, 对象, , , 


QQ.创建 (“WScript.Shell”, )
QQ.方法 (“Run”, QQ路径)
延时 (2000)
QQ.方法 (“AppActivate”, “xxxxxxxxx”)
QQ.方法 (“SendKeys”, “+{TAB}”)
QQ.方法 (“SendKeys”, QQ账号)
延时 (200)
QQ.方法 (“SendKeys”, “{TAB}”)
QQ.方法 (“SendKeys”, QQ密码)
延时 (200)
QQ.方法 (“SendKeys”, “{ENTER}”)
返回 (真)


.子程序 打开网址, 空白型, 公开, 
.参数 网址, 文本型, , 

运行 (相加 (“explorer ”, 网址), 假, )

.子程序 转换为昵称, 文本型, , 
.参数 数据, 字节集, , 

.局部变量 计次, 整数型, , , 
.局部变量 长度, 整数型, , , 
.局部变量 分段, 整数型, , , 
.局部变量 分段2, 整数型, , , 
.局部变量 对比1, 字节型, , , 
.局部变量 对比2, 字节型, , , 
.局部变量 位置1, 整数型, 静态, , 
.局部变量 文本, 文本型, , , 

赋值 (长度, 取字节集长度 (数据))
赋值 (位置1, 1)
.计次循环首 (长度, 计次)
    赋值 (分段, 取字节集数据 (取字节集中间 (数据, 位置1, 1), #整数型, ))
    赋值 (对比1, 位异或 (分段, 相减 (255, 长度)))
    .判断开始 (小于 (对比1, 160))
        赋值 (文本, 相加 (文本, 字符 (对比1)))
        赋值 (位置1, 相加 (位置1, 1))
        
    .判断 (大于 (对比1, 160))
        赋值 (对比1, 位异或 (取字节集数据 (取字节集中间 (数据, 位置1, 1), #整数型, ), 相减 (255, 长度)))
        赋值 (对比2, 位异或 (取字节集数据 (取字节集中间 (数据, 相加 (位置1, 1), 1), #整数型, ), 相减 (255, 长度)))
        
        赋值 (文本, 相加 (文本, 取字节集数据 (相加 (到字节集 (对比1), 到字节集 (对比2)), #文本型, )))
        赋值 (位置1, 相加 (位置1, 2))
        
    .默认
        
    .判断结束
    
    .如果真 (大于 (位置1, 取字节集长度 (数据)))
        跳出循环 ()
        处理事件 ()
    .如果真结束
    
.计次循环尾 ()
返回 (文本)

.子程序 十六进制到十进制, 长整数型, , 
.参数 十六进制文本, 文本型, , 

.局部变量 文本, 文本型, , , 
.局部变量 最终值, 长整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 临时数值, 文本型, , , 

赋值 (文本, 到小写 (十六进制文本))
.变量循环首 (1, 取文本长度 (文本), 1, i)
    赋值 (临时数值, 取文本中间 (文本, i, 1))
    .如果 (并且 (大于或等于 (取代码 (临时数值, ), 取代码 (“a”, )), 小于或等于 (取代码 (临时数值, ), 取代码 (“f”, ))))
        赋值 (最终值, 相加 (最终值, 相乘 (相加 (相减 (取代码 (临时数值, ), 取代码 (“a”, )), 10), 求次方 (16, 相减 (取文本长度 (文本), i)))))
    .否则
        赋值 (最终值, 相加 (最终值, 相乘 (到数值 (临时数值), 求次方 (16, 相减 (取文本长度 (文本), i)))))
    .如果结束
    
.变量循环尾 ()
返回 (最终值)

.子程序 分析好友名单, 整数型, 公开, 
.参数 文件路径, 文本型, , 
.参数 好友信息, 好友信息, 参考 数组, 

.局部变量 内容, 字节集, , "0", 
.局部变量 计次, 整数型, , , 
.局部变量 长度, 整数型, , , 
.局部变量 号码, 长整数型, , , 
.局部变量 昵称, 文本型, , , 

赋值 (内容, 分割字节集 (读入文件 (文件路径), { 169, 181, 178, 4 }, ))
.计次循环首 (取数组成员数 (内容), 计次)
    .如果真 (不等于 (寻找字节集 (内容 [计次], { 179, 183, 187, 189 }, ), -1))
        重定义数组 (好友信息, 真, 相加 (取数组成员数 (好友信息), 1))
        
        赋值 (号码, 转换为号码 (取字节集中间 (内容 [计次], 4, 4))) ' 4-7位为号码
        
        赋值 (长度, 取字节集数据 (取字节集中间 (内容 [计次], 15, 1), #整数型, )) ' 昵称数据段长度
        赋值 (昵称, 转换为昵称 (取字节集中间 (内容 [计次], 19, 长度))) ' 昵称数据
        
        赋值 (好友信息 [取数组成员数 (好友信息)].号码, 号码)
        赋值 (好友信息 [取数组成员数 (好友信息)].昵称, 昵称)
    .如果真结束
    
.计次循环尾 ()
返回 (取数组成员数 (好友信息))

.子程序 转换为号码, 长整数型, , 
.参数 号码, 字节集, , 

.局部变量 i, 整数型, , , 
.局部变量 返回值, 文本型, , , 
.局部变量 文本, 文本型, , , 

.计次循环首 (4, i)
    赋值 (文本, 取文本右边 (相加 (“00”, 取十六进制文本 (号码 [相加 (相减 (4, i), 1)])), 2))
    赋值 (返回值, 相加 (返回值, 文本))
.计次循环尾 ()
返回 (十六进制到十进制 (返回值))

.子程序 写到日志, 空白型, 公开, 
.参数 日志内容, 文本型, , 
.参数 保存路径, 文本型, 可空, 

.局部变量 文件号, 整数型, , , 

.如果真 (等于 (保存路径, “”))
    赋值 (保存路径, 相加 (取运行目录 (), “\log.txt”))
.如果真结束
赋值 (文件号, 打开文件 (保存路径, , ))
.如果 (等于 (文件号, 0))
    写到文件 (保存路径, 到字节集 (相加 (日志内容, #换行符)))
    写出文本 (文件号, 相加 (日志内容, #换行符))
    关闭文件 (文件号)
.否则
    移到文件尾 (文件号)
    写出文本 (文件号, 相加 (日志内容, #换行符))
    关闭文件 (文件号)
.如果结束


.子程序 创建快捷方式, 逻辑型, 公开, 
.参数 参数_lnk名称, 文本型, , 必须带.lnk 如果觉得不方便可自行修改
.参数 参数_工作目录, 文本型, , 
.参数 参数_指向目标, 文本型, , 
.参数 参数_图标文件, 文本型, 可空, 可空，为空时用目标的第一个图标
.参数 参数_运行方式, 整数型, 可空, 1,常规方式，3,最大化，7,最小化
.参数 参数_备注, 文本型, 可空, 
.参数 参数_参数文本, 文本型, 可空, 
.参数 参数_快捷键, 文本型, 可空, 如“Ctrl+Alt+Y”

.局部变量 局部_快捷方式对象, 对象, , , 

.判断开始 (局部_快捷方式对象.创建 (“WshShell”, “wshom.ocx”))
    赋值 (局部_快捷方式对象, 局部_快捷方式对象.对象型方法 (“CreateShortcut”, 参数_lnk名称))
    .如果真 (局部_快捷方式对象.是否为空 ())
        返回 (假)
    .如果真结束
    .判断开始 (局部_快捷方式对象.写属性 (“TargetPath”, 参数_指向目标))
        局部_快捷方式对象.写属性 (“WorkingDirectory”, 参数_工作目录)
        局部_快捷方式对象.写属性 (“IconLocation”, 选择 (是否为空 (参数_图标文件), 相加 (参数_指向目标, “,0”), 参数_图标文件))
        局部_快捷方式对象.写属性 (“WindowStyle”, 参数_运行方式)
        局部_快捷方式对象.写属性 (“Description”, 参数_备注)
        局部_快捷方式对象.写属性 (“Arguments”, 参数_参数文本)
        局部_快捷方式对象.写属性 (“Hotkey”, 参数_快捷键)
        赋值 (局部_快捷方式对象, 局部_快捷方式对象.对象型方法 (“Save”, ))
        返回 (真)
    .默认
        
    .判断结束
    
.默认
    
.判断结束
返回 (假)

.子程序 创建数据库, 空白型, 公开, 
.参数 密码, 文本型, 参考 可空, 

.局部变量 字段, 字段信息, , "12", 

.如果真 (等于 (密码, “”))
    赋值 (密码, “qq370360177”)
.如果真结束

.如果真 (等于 (文件是否存在 (相加 (取运行目录 (), “\data\Online Music.MP3”)), 假))
    
    赋值 (字段 [1].名称, “QQ昵称”)
    赋值 (字段 [1].类型, #文本型)
    赋值 (字段 [1].最大文本长度, 20)
    
    赋值 (字段 [2].名称, “QQ帐号”)
    赋值 (字段 [2].类型, #文本型)
    赋值 (字段 [2].最大文本长度, 20)
    
    赋值 (字段 [3].名称, “QQ密码”)
    赋值 (字段 [3].类型, #文本型)
    赋值 (字段 [3].最大文本长度, 20)
    
    赋值 (字段 [4].名称, “是否隐身”)
    赋值 (字段 [4].类型, #文本型)
    赋值 (字段 [4].最大文本长度, 20)
    
    赋值 (字段 [5].名称, “记住密码”)
    赋值 (字段 [5].类型, #文本型)
    赋值 (字段 [5].最大文本长度, 20)
    
    赋值 (字段 [6].名称, “自动登陆”)
    赋值 (字段 [6].类型, #文本型)
    赋值 (字段 [6].最大文本长度, 20)
    
    赋值 (字段 [7].名称, “登陆日期”)
    赋值 (字段 [7].类型, #文本型)
    赋值 (字段 [7].最大文本长度, 20)
    
    赋值 (字段 [8].名称, “密码提示”)
    赋值 (字段 [8].类型, #文本型)
    赋值 (字段 [8].最大文本长度, 20)
    
    赋值 (字段 [9].名称, “密码答案”)
    赋值 (字段 [9].类型, #文本型)
    赋值 (字段 [9].最大文本长度, 20)
    
    赋值 (字段 [10].名称, “登陆次数”)
    赋值 (字段 [10].类型, #文本型)
    赋值 (字段 [10].最大文本长度, 20)
    
    赋值 (字段 [11].名称, “登陆QQ版本”)
    赋值 (字段 [11].类型, #文本型)
    赋值 (字段 [11].最大文本长度, 20)
    
    赋值 (字段 [12].名称, “用户权限”)
    赋值 (字段 [12].类型, #文本型)
    赋值 (字段 [12].最大文本长度, 20)
    
    
    
    创建目录 (相加 (取运行目录 (), “\data”))
    .如果 (创建 (相加 (取运行目录 (), “\data\Online Music.MP3”), 字段))
        打开 (相加 (取运行目录 (), “\data\Online Music.MP3”), , , , , , )
        置数据库密码 (密码)
        输出调试文本 (相加 (“创建的数据库密码为：”, 密码))
        关闭 ()
    .否则
        信息框 (“对不起!创建数据库失败!”, 0, )
    .如果结束
    
.如果真结束


.子程序 BASE64编码, 文本型, , 
.参数 待编码数据, 字节集, , 

.局部变量 数据长度, 空白型, , , 
.局部变量 余数, 空白型, , , 
.局部变量 整数容器, 空白型, , , 
.局部变量 当前数据, 字节集, , , 
.局部变量 字符1, 文本型, , , 
.局部变量 字符2, 文本型, , , 
.局部变量 字符3, 文本型, , , 
.局部变量 字符4, 文本型, , , 
.局部变量 输出数据, 文本型, , , 

赋值 (数据长度, 取字节集长度 (待编码数据))
.如果真 (小于 (数据长度, 1))
    返回 (“”)
.如果真结束
赋值 (余数, 求余数 (数据长度, 3))
.如果真 (大于 (余数, 0))
    赋值 (待编码数据, 相加 (待编码数据, 取空白字节集 (相减 (3, 余数))))
.如果真结束
.变量循环首 (1, 取字节集长度 (待编码数据), 3, 整数容器)
    赋值 (当前数据, 取字节集中间 (待编码数据, 整数容器, 3))
    赋值 (字符1, 取文本中间 (#BASE64集合, 相加 (整除 (位与 (当前数据 [1], 252), 4), 1), 1))
    赋值 (字符2, 取文本中间 (#BASE64集合, 相加 (位与 (位或 (整除 (位与 (当前数据 [2], 240), 16), 相乘 (位与 (当前数据 [1], 3), 16)), 255), 1), 1))
    赋值 (字符3, 取文本中间 (#BASE64集合, 相加 (位与 (位或 (整除 (位与 (当前数据 [3], 192), 64), 相乘 (位与 (当前数据 [2], 15), 4)), 255), 1), 1))
    赋值 (字符4, 取文本中间 (#BASE64集合, 相加 (位与 (当前数据 [3], 63), 1), 1))
    赋值 (输出数据, 相加 (输出数据, 字符1, 字符2, 字符3, 字符4))
.变量循环尾 ()
赋值 (数据长度, 取文本长度 (输出数据))
.如果真 (大于 (余数, 0))
    .如果 (等于 (余数, 1))
        赋值 (输出数据, 文本替换 (输出数据, 相减 (数据长度, 1), 2, “==”))
    .否则
        赋值 (输出数据, 文本替换 (输出数据, 数据长度, 1, “=”))
    .如果结束
    
.如果真结束
返回 (输出数据)


.子程序 取QQ昵称, 文本型, , 取指定QQ的昵称，语句例子；标签1.标题=取QQ昵称(908218375)
.参数 QQ号码, 整数型, , 要提取昵称的QQ号码

.局部变量 网页文本, 文本型, , , 
.局部变量 位置1, 整数型, , , 
.局部变量 位置2, 整数型, , , 
.局部变量 文本容器, 文本型, , , 

赋值 (文本容器, 到文本 (未知支持库函数_7 (相加 (“http://users.qzone.qq.com/fcg-bin/cgi_personalcard.fcg?uin=”, 到文本 (QQ号码)))))
赋值 (位置1, 寻找文本 (文本容器, 相加 (“nick”, #引号, “:”, #引号), , 假))
赋值 (位置2, 寻找文本 (文本容器, 相加 (#引号, “,”, #引号, “isDispAge”), 位置1, 假))
赋值 (网页文本, 取文本中间 (文本容器, 相加 (位置1, 7), 12))
返回 (网页文本)

.子程序 时间格式化, 文本型, , 把易语言的时间格式化成各种时间类型，如果返回类型不正确，将返回空文本。
.参数 日期, 日期时间型, , 所提供的时间
.参数 返回类型, 整数型, 可空, 返回后的时间类型。1、HH：mm：ss   2、HH：mm；  3、yyyy-MM-dd HH：mm：ss   4、yyyy-MM-dd HH：mm   5、yyyy-MM-dd

.局部变量 年, 文本型, , , 
.局部变量 月, 文本型, , , 
.局部变量 日, 文本型, , , 
.局部变量 时, 文本型, , , 
.局部变量 分, 文本型, , , 
.局部变量 秒, 文本型, , , 
.局部变量 返回值, 文本型, , , 


.如果真 (等于 (返回类型, 0))
    赋值 (返回类型, 4)
.如果真结束


赋值 (时, 到文本 (取小时 (日期)))
赋值 (分, 到文本 (取分钟 (日期)))
赋值 (秒, 到文本 (取秒 (日期)))

.如果真 (等于 (取文本长度 (时), 1))
    赋值 (时, 相加 (“0”, 时))
.如果真结束
.如果真 (等于 (取文本长度 (分), 1))
    赋值 (分, 相加 (“0”, 分))
.如果真结束
.如果真 (等于 (取文本长度 (秒), 1))
    赋值 (秒, 相加 (“0”, 秒))
.如果真结束

.如果真 (等于 (返回类型, 1))
    赋值 (返回值, 相加 (时, “:”, 分, “:”, 秒))
.如果真结束
.如果真 (等于 (返回类型, 2))
    赋值 (返回值, 相加 (时, “:”, 分))
.如果真结束
.如果真 (等于 (返回类型, 3))
    赋值 (年, 到文本 (取年份 (日期)))
    赋值 (月, 到文本 (取月份 (日期)))
    赋值 (日, 到文本 (取日 (日期)))
    .如果真 (小于 (到整数 (月), 10))
        赋值 (月, 相加 (“0”, 月))
    .如果真结束
    .如果真 (小于 (到整数 (日), 10))
        赋值 (日, 相加 (“0”, 日))
    .如果真结束
    赋值 (返回值, 相加 (年, “-”, 月, “-”, 日, “ ”, 时, “:”, 分, “:”, 秒))
.如果真结束
.如果真 (等于 (返回类型, 4))
    赋值 (年, 到文本 (取年份 (日期)))
    赋值 (月, 到文本 (取月份 (日期)))
    赋值 (日, 到文本 (取日 (日期)))
    .如果真 (小于 (到整数 (月), 10))
        赋值 (月, 相加 (“0”, 月))
    .如果真结束
    .如果真 (小于 (到整数 (日), 10))
        赋值 (日, 相加 (“0”, 日))
    .如果真结束
    赋值 (返回值, 相加 (年, “-”, 月, “-”, 日, “ ”, 时, “:”, 分))
.如果真结束
.如果真 (等于 (返回类型, 5))
    赋值 (年, 到文本 (取年份 (日期)))
    赋值 (月, 到文本 (取月份 (日期)))
    赋值 (日, 到文本 (取日 (日期)))
    .如果真 (小于 (到整数 (月), 10))
        赋值 (月, 相加 (“0”, 月))
    .如果真结束
    .如果真 (小于 (到整数 (日), 10))
        赋值 (日, 相加 (“0”, 日))
    .如果真结束
    赋值 (返回值, 相加 (年, “-”, 月, “-”, 日))
.如果真结束
返回 (返回值)

.子程序 登录, 空白型, 公开, 
.参数 QQ号码, 文本型, , 
.参数 QQ密码, 文本型, , 
.参数 是否隐身, 逻辑型, , 

.局部变量 摘要文本, 文本型, , , 
.局部变量 摘要字节集, 字节集, , , 
.局部变量 加密的密码, 文本型, , , 
.局部变量 隐身, 文本型, , , 40:隐身；41:不隐身
.局部变量 变量1, 整数型, , , 
.局部变量 QQ路径, 文本型, , , 


.判断开始 (等于 (是否隐身, 真))
    赋值 (隐身, “40”)
.默认
    赋值 (隐身, “41”)
.判断结束
赋值 (摘要文本, 未知支持库函数_2 (到字节集 (QQ密码)))
赋值 (摘要字节集, 取空白字节集 (16))
.计次循环首 (16, 变量1)
    赋值 (摘要字节集 [变量1], 到字节 (十六进制到十进制 (取文本中间 (摘要文本, 相加 (相乘 (相减 (变量1, 1), 2), 1), 2))))
.计次循环尾 ()
赋值 (加密的密码, BASE64编码 (摘要字节集))
赋值 (QQ路径, 取QQ2008安装路径 ())

输出调试文本 (QQ路径)
运行 (相加 (QQ路径, “ /START QQUIN:”, QQ号码, “ PWDHASH:”, 加密的密码, “ /STAT:”, 隐身), 假, )


.子程序 CRC32核对, 空白型, , 
.局部变量 文件原始CRC32, 字节集, , , 
.局部变量 当前文件CRC32, 字节集, , , 
.局部变量 整体文件, 字节集, , , 
.局部变量 整体文件长度, 整数型, , , 
.局部变量 PE文件头位置, 整数型, , , 

赋值 (文件名, 取空白文本 (256))
GetModuleFileName (0, 文件名, 256)
输出调试文本 (文件名)
赋值 (整体文件, 读入文件 (文件名))
赋值 (整体文件长度, 取字节集长度 (整体文件))
赋值 (PE文件头位置, 寻找字节集 (整体文件, { 80, 69 }, ))
赋值 (文件原始CRC32, 取字节集中间 (整体文件, 相减 (PE文件头位置, 4), 4))
赋值 (当前文件CRC32, 到字节集 (crc32 (取字节集中间 (整体文件, PE文件头位置, 整体文件长度))))
.如果 (不等于 (文件原始CRC32, { 0, 0, 0, 0 }))
    .如果 (等于 (文件原始CRC32, 当前文件CRC32))
         ' 信息框 (“CRC32完整性通过”, 0, )
    .否则
         ' 信息框 (“CRC32完整性失败”, 0, )
        信息框 (“软件内核受到病毒感染或恶意修改！ 客服QQ：370360177”, 0, )
        未知支持库函数_56 (“http://user.qzone.qq.com/370360177/blog/1280224813”)
        结束 ()
    .如果结束
    
.否则
     ' 信息框 (“未检测到CRC32”, 0, )
    信息框 (“软件内核DPN安全机制认证检测验证失败！ 客服QQ：370360177”, 0, )
    未知支持库函数_56 (“http://user.qzone.qq.com/370360177/blog/1280224813”)
    结束 ()
.如果结束


.子程序 crc32, 整数型, 公开, 
.参数 原文, 字节集, , 要取CRC32数据字节集

.局部变量 crcval, 整数型, , , 
.局部变量 长度, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 结果, 整数型, , , 
.局部变量 位置, 整数型, , , 
.局部变量 crc, 整数型, , , 
.局部变量 table, 整数型, , "256", 

赋值 (长度, 取字节集长度 (原文))
.如果真 (小于 (长度, 1))
    返回 (0)
.如果真结束
.变量循环首 (0, 255, 1, i)
    赋值 (crc, i)
    .变量循环首 (1, 8, 1, )
        .如果 (不等于 (位与 (crc, 1), 0))
            赋值 (crc, 位异或 (位与 (右移 (crc, 1), 2147483647), 3988292384))
        .否则
            赋值 (crc, 位与 (右移 (crc, 1), 2147483647))
        .如果结束
        
    .变量循环尾 ()
    赋值 (table [相加 (i, 1)], crc)
.变量循环尾 ()
赋值 (crcval, 4294967295)
.计次循环首 (长度, i)
    赋值 (位置, 相加 (位异或 (原文 [i], 位与 (crcval, 255)), 1))
    赋值 (crcval, 位异或 (位与 (右移 (crcval, 8), 16777215), table [位置]))
.计次循环尾 ()
赋值 (结果, 位取反 (crcval))
返回 (结果)

.子程序 QQ是否已登录_, 逻辑型, 公开, 返回 (真)以登录 注:目前只支持QQ2008版本
.参数 QQ号码, 文本型, , "370360177"

.局部变量 程序进程名, 文本型, , , 
.局部变量 进程句柄, 整数型, , , 
.局部变量 进程快照, 整数型, , , 
.局部变量 是否运行, 文本型, , , 
.局部变量 QQTM号码, 文本型, , , 
.局部变量 进程信息, PROCESSENTRY32, , , 

赋值 (程序进程名, “QQ.exe”)
 ' 输出调试文本 (程序进程名)
赋值 (路径分隔符, 到字节集 (“\”))
赋值 (关键字, 到字节集 (“\MsgEx.db”))
赋值 (是否运行, “”)
赋值 (进程快照, CreateToolhelp32Snapshot (#TH32CS_SNAPALL, 0))
.如果真 (等于 (进程快照, 0))
    信息框 (“创建进程快照列表失败 .”, #信息图标, “提示”)
    返回 (假)
.如果真结束
赋值 (进程信息.dwSize, 296) ' = len (uProcess)
赋值 (进程句柄, Process32First (进程快照, 进程信息))
.判断循环首 (不等于 (进程句柄, 0))
    .如果真 (不等于 (寻找文本 (到文本 (进程信息.szExeFile), 程序进程名, , 真), -1))
        赋值 (是否运行, 相加 (“ID: ”, 到文本 (进程信息.th32ProcessID)))
        赋值 (QQTM号码, 查找QQ号码 (进程信息.th32ProcessID))
        输出调试文本 (QQTM号码)
         ' 标题 ＝ “  QQ或TM” ＋ “号码为: ” ＋ QQTM号码
        
        .如果真 (等于 (QQTM号码, QQ号码))
            返回 (真)
        .如果真结束
        
        
        
    .如果真结束
    赋值 (进程句柄, Process32Next (进程快照, 进程信息))
.判断循环尾 ()
CloseHandle (进程快照)
返回 (假)

.子程序 查找QQ号码, 文本型, , 
.参数 进程ID, 整数型, , 

.局部变量 操作句柄, 整数型, , , 
.局部变量 内存地址, 整数型, , , 
.局部变量 读取结果, 整数型, , , 
.局部变量 内存块长度, 整数型, , , 
.局部变量 开始地址, 整数型, , , 
.局部变量 结束地址, 整数型, , , 
.局部变量 数据缓冲区, 字节集, , , 
.局部变量 QQ号码, 文本型, , , 
.局部变量 内存块信息, MEMORY_BASIC_INFORMATION, , , 
.局部变量 匿名局部变量_1518, 空白型, , , 
.局部变量 地址偏移, 整数型, , , 
.局部变量 地址值, 字节型, , , 

赋值 (操作句柄, OpenProcess (相加 (#PROCESS_VM_READ, #PROCESS_QUERY_INFORMATION), 0, 进程ID))
.如果真 (等于 (操作句柄, 0))
    信息框 (“不能打开进程 .”, #信息图标, “提示”)
    返回 (“”)
.如果真结束

赋值 (内存块长度, 28)
.判断循环首 (真)
    .如果真 (等于 (VirtualQueryEx (操作句柄, 内存地址, 内存块信息, 内存块长度), 0))
        CloseHandle (操作句柄)
        返回 (“”)
    .如果真结束
    
    .如果真 (并且 (等于 (内存块信息.Type, #MEM_PRIVATE), 等于 (内存块信息.Protect, #PAGE_READWRITE)))
        赋值 (数据缓冲区, 取空白字节集 (内存块信息.RegionSize))
        赋值 (读取结果, ReadProcessMemory (操作句柄, 内存地址, 数据缓冲区, 内存块信息.RegionSize, 0))
        .如果 (不等于 (读取结果, 0))
            赋值 (结束地址, 寻找字节集 (数据缓冲区, 关键字, ))
            .判断循环首 (不等于 (结束地址, -1))
                赋值 (开始地址, 倒找字节集 (数据缓冲区, 路径分隔符, 相减 (结束地址, 1)))
                .如果真 (并且 (不等于 (开始地址, -1), 小于 (相减 (结束地址, 开始地址), 16), 大于 (相减 (结束地址, 开始地址), 4)))
                    .变量循环首 (相加 (开始地址, 1), 相减 (结束地址, 1), 1, 地址偏移) ' 判断是否为数字格式
                        赋值 (地址值, 取字节集数据 (取字节集中间 (数据缓冲区, 地址偏移, 1), #字节型))
                        .如果真 (或者 (小于 (地址值, 48), 大于 (地址值, 57)))
                            跳出循环 ()
                        .如果真结束
                        
                    .变量循环尾 ()
                    .如果真 (等于 (地址偏移, 结束地址))
                        赋值 (QQ号码, 取字节集数据 (取字节集中间 (数据缓冲区, 相加 (开始地址, 1), 相减 (结束地址, 开始地址, 1)), #文本型))
                        CloseHandle (操作句柄)
                        返回 (QQ号码)
                    .如果真结束
                    
                .如果真结束
                赋值 (结束地址, 寻找字节集 (数据缓冲区, 关键字, 相加 (结束地址, 1)))
            .判断循环尾 ()
        .否则
            输出调试文本 (相加 (“不能读取内存块: ”, 到文本 (内存地址)))
        .如果结束
        
    .如果真结束
    赋值 (内存地址, 相加 (内存地址, 内存块信息.RegionSize))
.判断循环尾 ()
CloseHandle (操作句柄)
返回 (“”)

.窗口程序集 窗口程序集2, , , 

.子程序 _窗口1_添加_修改_创建完毕, 空白型, , 
.如果 (等于 (标识, “修改”))
    赋值 (窗口1_添加_修改., “- 修改QQ帐号”)
    打开 (相加 (取运行目录 (), “\data\Online Music.MP3”), , , , , “qq370360177”, )
    到首记录 ()
    .计次循环首 (取记录数 (), )
        .如果真 (等于 (读 (“QQ帐号”), 到文本 (_启动窗口.取标题 (., _启动窗口.., 2))))
            赋值 (记录位置, 取记录号 ())
            
        .如果真结束
        处理事件 ()
        跳过 ()
    .计次循环尾 ()
    跳到 (记录位置)
    赋值 (.内容, 读 (“QQ帐号”))
    赋值 (.内容, 读 (“QQ密码”))
    .如果真 (等于 (读 (“是否隐身”), “真”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (读 (“记住密码”), “真”))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (读 (“自动登陆”), “真”))
        赋值 (.选中, 真)
    .如果真结束
    赋值 (.内容, 读 (“密码提示”))
    赋值 (.内容, 读 (“密码答案”))
    .如果 (等于 (读 (“登陆QQ版本”), “QQ2008”))
        赋值 (.现行选中项, 0)
        赋值 (.禁止, 假)
    .否则
        赋值 (.现行选中项, 1)
        赋值 (.禁止, 真)
    .如果结束
    赋值 (.标题, “修 改”)
.否则
    赋值 (窗口1_添加_修改., “- 添加QQ帐号”)
.如果结束


.如果 (等于 (.选中, 真))
    赋值 (窗口1_添加_修改., 280)
    赋值 (.顶边, 224)
    赋值 (.顶边, 236)
    赋值 (.顶边, 236)
    赋值 (.可视, 真)
.否则
    赋值 (窗口1_添加_修改., 211)
    赋值 (.顶边, 152)
    赋值 (.顶边, 162)
    赋值 (.顶边, 162)
    赋值 (.可视, 假)
.如果结束






.如果 (或者 (等于 (取QQ2008安装路径 (), “路径不存在”), 等于 (取QQ2008安装路径 (), “文件不存在”), 等于 (取QQ2008安装路径 (), “”)))
    
.否则
    “QQ2008”.加入项目 (取项目数 ())
.如果结束
.如果 (或者 (等于 (取QQ2009安装路径 (), “路径不存在”), 等于 (取QQ2008安装路径 (), “文件不存在”), 等于 (取QQ2009安装路径 (), “”)))
    
.否则
    “QQ2009”.加入项目 (取项目数 ())
.如果结束
.如果 (或者 (等于 (取QQ2010安装路径 (), “路径不存在”), 等于 (取QQ2008安装路径 (), “文件不存在”), 等于 (取QQ2010安装路径 (), “\Bin\QQ.exe”)))
    
.否则
    “QQ2010”.加入项目 (取项目数 ())
.如果结束
.如果真 (等于 (取项目数 (), 0))
    “检测不到已安装的QQ版本”.加入项目 (取项目数 ())
.如果真结束
赋值 (.现行选中项, 0)







.子程序 _按钮1_被单击, 空白型, , 
.局部变量 自动登陆, 文本型, , , 
.局部变量 记住密码, 文本型, , , 
.局部变量 是否隐身, 文本型, , , 

连续赋值 (“假”, 自动登陆, 记住密码, 是否隐身)
.如果真 (等于 (.选中, 真))
    赋值 (自动登陆, “真”)
.如果真结束
.如果真 (等于 (.选中, 真))
    赋值 (记住密码, “真”)
.如果真结束
.如果真 (等于 (.选中, 真))
    赋值 (是否隐身, “真”)
.如果真结束
.如果真 (或者 (等于 (.内容, “<请输入账号>”), 等于 (.内容, “<请输入密码>”)))
    信息框 (“对不起,你输入的帐号信息不完整!”, #警告图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果真 (或者 (等于 (.内容, “<请输入密码找回提示>”), 等于 (.内容, “<请输入提示答案>”)))
        信息框 (“对不起,你输入的密码找回提示信息不完整!”, #警告图标, )
        获取焦点 ()
        返回 ()
    .如果真结束
    
.如果真结束
.如果真 (等于 (.内容, “<请输入昵称>”))
    信息框 (“<请输入完整昵称>”, #警告图标, )
    获取焦点 ()
    返回 ()
    
.如果真结束


.如果真 (等于 (标识, “修改”))
    修改 (.内容, .内容, .内容, 是否隐身, 记住密码, 自动登陆, 时间格式化 (取现行时间 (), 5), .内容, .内容, , .内容)
    读取记录2 ()
    销毁 ()
    返回 ()
.如果真结束
到尾记录 ()
.如果真 (加记录 (.内容, .内容, .内容, 是否隐身, 记住密码, 自动登陆, 时间格式化 (取现行时间 (), 5), .内容, .内容, , .内容))
     ' 信息框 (“恭喜恭喜,添加号码成功!”, 64, )
    读取记录2 ()
    销毁 ()
    返回 ()
.如果真结束
信息框 (“非常抱歉,添加帐号失败!”, 64, )

 ' ' “QQ昵称”, “QQ帐号”, “QQ密码”, “是否隐身”, “记住密码”, “自动登陆”, “登陆日期”, “密码提示”, “密码答案”


.子程序 _选择框2_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (窗口1_添加_修改., 280)
    赋值 (.顶边, 224)
    赋值 (.顶边, 236)
    赋值 (.顶边, 236)
    赋值 (.可视, 真)
.否则
    赋值 (窗口1_添加_修改., 211)
    赋值 (.顶边, 152)
    赋值 (.顶边, 162)
    赋值 (.顶边, 162)
    赋值 (.可视, 假)
.如果结束


.子程序 _选择框1_被单击, 空白型, , 
.如果真 (等于 (.选中, 真))
    赋值 (.选中, 真)
    _选择框2_被单击 ()
.如果真结束


.子程序 _编辑框1_获得焦点, 空白型, , 
.如果真 (等于 (.内容, “<请输入账号>”))
    赋值 (.内容, “”)
    赋值 (.文本颜色, #灰色)
.如果真结束


.子程序 _编辑框1_失去焦点, 空白型, , 

.如果真 (等于 (.内容, “”))
    赋值 (.内容, “<请输入账号>”)
    赋值 (.文本颜色, #灰色)
    
.如果真结束
.如果真 (等于 (.内容, “<请输入账号>”))
    返回 ()
.如果真结束
赋值 (.内容, 字符文本替换 (取QQ昵称 (到整数 (.内容))))


.子程序 _编辑框2_获得焦点, 空白型, , 
.如果真 (等于 (.内容, “<请输入密码>”))
    赋值 (.内容, “”)
    赋值 (.文本颜色, #灰色)
.如果真结束


.子程序 _编辑框2_失去焦点, 空白型, , 
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “<请输入密码>”)
    赋值 (.文本颜色, #灰色)
.如果真结束


.子程序 _编辑框3_获得焦点, 空白型, , 
.如果真 (等于 (.内容, “<请输入密码找回提示>”))
    赋值 (.内容, “”)
    赋值 (.文本颜色, #灰色)
.如果真结束


.子程序 _编辑框3_失去焦点, 空白型, , 
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “<请输入密码找回提示>”)
    赋值 (.文本颜色, #灰色)
.如果真结束


.子程序 _编辑框4_获得焦点, 空白型, , 
.如果真 (等于 (.内容, “<请输入提示答案>”))
    赋值 (.内容, “”)
    赋值 (.文本颜色, #灰色)
.如果真结束


.子程序 _编辑框4_失去焦点, 空白型, , 
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “<请输入提示答案>”)
    赋值 (.文本颜色, #灰色)
.如果真结束


.子程序 _编辑框5_获得焦点, 空白型, , 
.如果真 (等于 (.内容, “<请输入昵称>”))
    赋值 (.内容, “”)
    赋值 (.文本颜色, #灰色)
.如果真结束


.子程序 _编辑框5_失去焦点, 空白型, , 
.如果真 (等于 (.内容, “”))
    赋值 (.内容, “<请输入昵称>”)
    赋值 (.文本颜色, #灰色)
.如果真结束


.子程序 _组合框1_列表项被选择, 空白型, , 
.如果 (等于 (.内容, “QQ2008”))
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
    赋值 (.选中, 假)
.如果结束


.子程序 _编辑框1_内容被改变, 空白型, , 
.局部变量 长度, 整数型, , , 

赋值 (长度, 相减 (15, 取文本长度 (.内容)))
.如果真 (等于 (长度, 0))
    信息框 (“目前只支持15位QQ数号输入”, 0, )
.如果真结束


.子程序 _标签5_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

未知支持库函数_56 (“http://freeqqm.qq.com/freereg/index-zh-hant.shtml”)

.子程序 _标签6_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

未知支持库函数_56 (“http://aq.qq.com/cn/findpsw/findpsw_index?source_id=1003&ptlang=2052&aquin=&ADUIN=0&ADSESSION=0&ADTAG=CLIENT.QQ.2839_ForgetPsw.0”)

.子程序 _标签3_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.输入方式, 0)

.窗口程序集 窗口程序集3, , , 

.子程序 _窗口1_软件_设置_创建完毕, 空白型, , 
 ' ===============================请路径=====================================
.如果 (等于 (取文本注册项 (#本地机器, “Software\QQLanded\QQ2008”, ), “”))
    赋值 (.内容, 取QQ2008安装路径 ())
.否则
    赋值 (.内容, 取文本注册项 (#本地机器, “Software\QQLanded\QQ2008”, ))
.如果结束
.如果 (等于 (取文本注册项 (#本地机器, “Software\QQLanded\QQ2009”, ), “”))
    赋值 (.内容, 取QQ2009安装路径 ())
.否则
    赋值 (.内容, 取文本注册项 (#本地机器, “Software\QQLanded\QQ2009”, ))
.如果结束
.如果 (等于 (取文本注册项 (#本地机器, “Software\QQLanded\QQ2010”, ), “”))
    赋值 (.内容, 取QQ2010安装路径 ())
.否则
    赋值 (.内容, 取文本注册项 (#本地机器, “Software\QQLanded\QQ2010”, ))
.如果结束
 ' ===============================系统设定=====================================
.如果 (等于 (取文本注册项 (#本地机器, “Software\QQLanded\Exit Close”, ), “”))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
.如果 (等于 (取文本注册项 (#本地机器, “Software\QQLanded\Auto Login”, ), “”))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
.如果 (等于 (取文本注册项 (#本地机器, “Software\QQLanded\Switched”, ), “”))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
.如果 (等于 (取文本注册项 (#本地机器, “Software\QQLanded\Shortcuts”, ), “”))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
.如果 (等于 (取文本注册项 (#本地机器, “Software\QQLanded\Procedures Password”, ), “”))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
.如果 (等于 (取文本注册项 (#本地机器, “Software\QQLanded\Default Skin”, ), “”))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
子程序1 ()

.子程序 子程序1, 空白型, , 
.局部变量 i, 整数型, , , 

到首记录 ()
.计次循环首 (取记录数 (), i)
    .如果真 (查找 (等于 (读 (“用户权限”), “高级管理员权限”)))
        赋值 (.内容, 读 (“QQ密码”))
        
    .如果真结束
    跳过 ()
.计次循环尾 ()


.子程序 _按钮2_被单击, 空白型, , 
.如果真 (等于 (打开 (), 真))
    赋值 (.内容, .文件名)
.如果真结束


.子程序 _按钮3_被单击, 空白型, , 
.如果真 (等于 (打开 (), 真))
    赋值 (.内容, .文件名)
.如果真结束


.子程序 _按钮1_被单击, 空白型, , 
.如果真 (等于 (打开 (), 真))
    赋值 (.内容, .文件名)
.如果真结束


.子程序 _按钮4_被单击, 空白型, , 
 ' ===============================系统设定=====================================
.如果 (等于 (.选中, 真))
    写注册项 (#本地机器, “Software\QQLanded\Exit Close”, “1”)
.否则
    写注册项 (#本地机器, “Software\QQLanded\Exit Close”, “”)
.如果结束
.如果 (等于 (.选中, 真))
    写注册项 (#本地机器, “Software\QQLanded\Auto Login”, “1”)
.否则
    写注册项 (#本地机器, “Software\QQLanded\Auto Login”, “”)
.如果结束
.如果 (等于 (.选中, 真))
    写注册项 (#本地机器, “Software\QQLanded\Switched”, “1”) ' 开机后自动运行
    写注册项 (4, “SOFTWARE\Microsoft\Windows\CurrentVersion\Run\QQLanded”, 相加 (取运行目录 (), “\”, 取执行文件名 ()))
.否则
    写注册项 (#本地机器, “Software\QQLanded\Switched”, “”)
    删除注册项 (4, “SOFTWARE\Microsoft\Windows\CurrentVersion\Run\QQLanded”)
.如果结束
.如果 (等于 (.选中, 真)) ' 创建桌机快捷方式
    写注册项 (#本地机器, “Software\QQLanded\Shortcuts”, “1”)
    创建快捷方式 (相加 (取运行目录 (), “\”, 取文本左边 (到文本 (取执行文件名 ()), 相减 (取文本长度 (到文本 (取执行文件名 ())), 4)), “.lnk”), 取运行目录 (), 相加 (取运行目录 (), “\”, 到文本 (取执行文件名 ())), , 1, “QQ登陆器V1.0”, “”, “Ctrl+Q”)
.否则
    写注册项 (#本地机器, “Software\QQLanded\Shortcuts”, “”)
.如果结束
.如果 (等于 (.选中, 真))
    写注册项 (#本地机器, “Software\QQLanded\Procedures Password”, “1”)
     ' 到尾记录 ()
     ' 加记录 (“1000”, , , , , , , , )
.否则
    写注册项 (#本地机器, “Software\QQLanded\Procedures Password”, “”)
.如果结束
.如果 (等于 (.选中, 真)) ' 加载软件默认皮肤
    写注册项 (#本地机器, “Software\QQLanded\Default Skin”, “1”)
    加载皮肤 ()
.否则
    写注册项 (#本地机器, “Software\QQLanded\Default Skin”, “”)
.如果结束
销毁 ()

.子程序 界面, 空白型, , 


.子程序 _按钮5_被单击, 空白型, , 
到首记录 ()
.如果真 (加记录 (“超级管理员”, , .内容, , , , 时间格式化 (取现行时间 (), 5), .内容, .内容, , , “高级管理员权限”))
    信息框 (“恭喜恭喜,添加号码成功!”, 64, )
    返回 ()
.如果真结束
信息框 (“非常抱歉,添加帐号失败!”, 64, )


.子程序 _按钮6_被单击, 空白型, , 
.如果真 (修改 (“超级管理员”, , .内容, , , , 时间格式化 (取现行时间 (), 5), .内容, .内容, , , “高级管理员权限”))
    信息框 (“恭喜恭喜,添加号码成功!”, 64, )
    子程序1 ()
    返回 ()
.如果真结束
到尾记录 ()


 ' 不属于任何一个程序集、类模块的函数：
