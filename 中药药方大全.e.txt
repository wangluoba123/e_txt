 ' 文件类型：Windows窗口程序

 ' 程序名称：中药和药方大全
 ' 程序描述：中药和药方大全
@备注:
中药和药方大全
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：shuanzeng@ls-ql.com.cn
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 650
    高度 = 443
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “【中药药方大全】”
    帮助文件名 = “”

窗口 查询窗口
    左边 = 50
    顶边 = 50
    宽度 = 476
    高度 = 240
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “查询”
    帮助文件名 = “”

窗口 编辑窗口
    左边 = 50
    顶边 = 50
    宽度 = 622
    高度 = 445
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 中药图片窗口
    左边 = 50
    顶边 = 50
    宽度 = 620
    高度 = 445
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “图片”
    帮助文件名 = “”



.常量 树形框插入项目_在根部插入, "1", 隐藏, 
.常量 树形框插入项目_在列表首部插入, "2", 隐藏, 
.常量 树形框插入项目_在列表尾部插入, "3", 隐藏, 
.常量 树形框插入项目_按字母顺序排列插入, "4", 隐藏, 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' sqlite3 {E5D631FE-E3C9-4eb3-A687-C89598FE6691} 2 1 Sqlite3数据库支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 2 0 扩展界面支持库二
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 2 0 数据操作支持库一
 ' shell 52F260023059454187AF826A3C07AF2A 3 0 操作系统界面功能支持库
 ' spec A512548E76954B6E92C21055517615B0 3 1 特殊功能支持库



 ' 所需要的模块
 ' sxk_czl C:\Documents and Settings\Administrator\桌面\sxk_czl.ec


数据类型 中药图片, , 
    .成员 id, 整数型, , , 
    .成员 类别, 文本型, , , 
    .成员 图片, 字节集, , , 

数据类型 树型框结构, 公开, 
    .成员 项目文本, 文本型, , , 
    .成员 图片索引, 整数型, , , 
    .成员 选中图片索引, 整数型, , , 
    .成员 项目数值, 整数型, , , 
    .成员 加粗扩展, 整数型, , , 0、普通，1、加粗，2、扩展，3、加粗+扩展
    .成员 缩进层次, 整数型, , , 

数据类型 项目数据, 公开, 
    .成员 项目文本, 文本型, , , 项目文本
    .成员 图片索引, 整数型, , , 图象
    .成员 选中图片索引, 整数型, , , 选择图象
    .成员 项目数值, 整数型, , , 项目数值


.窗口程序集 启动窗口程序集, , , 

.程序集变量 xz, 整数型, , , 
.程序集变量 sxk, 树型框操作类, , , 
.程序集变量 zfgs, 未知类型0x40004, , , 
.程序集变量 sdb, 未知类型0x20001, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 i, 空白型, , , 

 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

赋值 (xz, 1)
sdb.未知支持库函数_30 (相加 (取运行目录 (), “\zyyfdq.db”), 假)
sxk.未知函数_67174540 ()
赋值 (.图标, 树型框_填充数据 (“1”))
sxk.未知函数_67174541 ()
 ' sxksj ()
赋值 (zfgs., 10)
zfgs.未知支持库函数_8 ()
组合框数据填充 ()

.子程序 sxksj, 空白型, , 
.局部变量 i, 空白型, , , 
.局部变量 fxm, 整数型, , , 
.局部变量 jc, 逻辑型, , , 
.局部变量 sqlb, 未知类型0x20003, , , 

赋值 (.图标, {  })
赋值 (., “”)
.如果 (等于 (xz, 1))
    sqlb.未知支持库函数_184 (“select * from zylb ORDER BY xm”, sdb)
    sqlb.未知支持库函数_190 ()
    .判断循环首 (等于 (sqlb.未知支持库函数_201 (), 假))
        sqlb.未知支持库函数_198 ()
        .如果 (不等于 (sqlb.未知支持库函数_215 (“type”, ), “”))
            赋值 (fxm, sqlb.未知支持库函数_216 (“xm”, ))
            .如果 (等于 (fxm, 0))
                赋值 (i, -1)
                赋值 (jc, 真)
            .否则
                .计次循环首 (取项目数 (), i)
                    .如果真 (等于 (相减 (i, 1).取项目数值 (), fxm))
                        赋值 (i, 相减 (i, 1))
                        赋值 (jc, 假)
                        跳出循环 ()
                    .如果真结束
                     ' 本源码来自易语言资源网(www.5A5X.com)
                .计次循环尾 ()
            .如果结束
            
            i.加入项目 (sqlb.未知支持库函数_215 (“type”, ), 1, 0, sqlb.未知支持库函数_216 (“id”, ), jc, )
            i.置图片 (1)
        .否则
            
        .如果结束
        处理事件 ()
    .判断循环尾 ()
    sqlb.未知支持库函数_191 ()
    处理事件 ()
.否则
    
.如果结束
.如果 (等于 (xz, 2))
    sqlb.未知支持库函数_184 (“select * from yflb ORDER BY xm”, sdb)
    sqlb.未知支持库函数_190 ()
    .判断循环首 (等于 (sqlb.未知支持库函数_201 (), 假))
        sqlb.未知支持库函数_198 ()
        .如果 (不等于 (sqlb.未知支持库函数_215 (“type”, ), “”))
            赋值 (fxm, sqlb.未知支持库函数_216 (“xm”, ))
            .如果 (等于 (fxm, 0))
                赋值 (i, -1)
                赋值 (jc, 真)
            .否则
                .计次循环首 (取项目数 (), i)
                    .如果真 (等于 (相减 (i, 1).取项目数值 (), fxm))
                        赋值 (i, 相减 (i, 1))
                        赋值 (jc, 假)
                        跳出循环 ()
                    .如果真结束
                    
                .计次循环尾 ()
            .如果结束
            
            i.加入项目 (sqlb.未知支持库函数_215 (“type”, ), 1, 0, sqlb.未知支持库函数_216 (“id”, ), jc, )
            i.置图片 (1)
        .否则
            
        .如果结束
        处理事件 ()
    .判断循环尾 ()
    sqlb.未知支持库函数_191 ()
    处理事件 ()
.否则
     ' 本源码来自易语言资源网(www.5A5X.com)
.如果结束
.如果 (等于 (xz, 3))
    sqlb.未知支持库函数_184 (“select * from zllb ORDER BY xm”, sdb)
    sqlb.未知支持库函数_190 ()
    .判断循环首 (等于 (sqlb.未知支持库函数_201 (), 假))
        sqlb.未知支持库函数_198 ()
        .如果 (不等于 (sqlb.未知支持库函数_215 (“type”, ), “”))
            赋值 (fxm, sqlb.未知支持库函数_216 (“xm”, ))
            .如果 (等于 (fxm, 0))
                赋值 (i, -1)
                赋值 (jc, 真)
            .否则
                .计次循环首 (取项目数 (), i)
                    .如果真 (等于 (相减 (i, 1).取项目数值 (), fxm))
                        赋值 (i, 相减 (i, 1))
                        赋值 (jc, 假)
                        跳出循环 ()
                    .如果真结束
                    
                .计次循环尾 ()
            .如果结束
            
            i.加入项目 (sqlb.未知支持库函数_215 (“type”, ), 1, 0, sqlb.未知支持库函数_216 (“id”, ), jc, )
            i.置图片 (1)
        .否则
            
        .如果结束
        处理事件 ()
    .判断循环尾 ()
    sqlb.未知支持库函数_191 ()
    处理事件 ()
.否则
    
.如果结束


.子程序 组合框数据填充, 空白型, , 
.局部变量 zhkb, 未知类型0x20002, , , 
.局部变量 x, 空白型, , , 
.局部变量 zd, 文本型, , "0", 

清空 ()
.如果 (等于 (xz, 1))
    zhkb.未知支持库函数_105 (“zymm”, sdb)
    赋值 (zd, zhkb.未知支持库函数_153 ())
    .计次循环首 (取数组成员数 (zd), x)
        .如果 (或者 (等于 (zd [x], “id”), 等于 (zd [x], “TYPE”)))
            跳过 ()
        .否则
            zd.加入项目 ( [x], )
        .如果结束
        
    .计次循环尾 ()
    处理事件 ()
.否则
    ' 本源码来自易语言资源网(www.5A5X.com)
.如果结束
.如果 (等于 (xz, 2))
    zhkb.未知支持库函数_105 (“yfmm”, sdb)
    赋值 (zd, zhkb.未知支持库函数_153 ())
    .计次循环首 (取数组成员数 (zd), x)
        .如果 (或者 (等于 (zd [x], “id”), 等于 (到小写 (zd [x]), “type”)))
            跳过 ()
        .否则
            zd.加入项目 ( [x], )
        .如果结束
        
    .计次循环尾 ()
    处理事件 ()
.否则
    
.如果结束
.如果 (等于 (xz, 3))
    zhkb.未知支持库函数_105 (“zlnr”, sdb)
    赋值 (zd, zhkb.未知支持库函数_153 ())
    .计次循环首 (取数组成员数 (zd), x)
        .如果 (等于 (zd [x], “id”))
            跳过 ()
        .否则
            zd.加入项目 ( [x], )
        .如果结束
        
    .计次循环尾 ()
    处理事件 ()
.否则
    
.如果结束


.子程序 树型框_填充数据, 字节集, , 
.参数 id, 文本型, , 

.局部变量 jlj, 未知类型0x20002, , , 
.局部变量 sxksj, 字节集, , , 

jlj.未知支持库函数_105 (“lbsj”, sdb)
jlj.未知支持库函数_109 ()
.如果 (jlj.未知支持库函数_126 (相加 (“id=”, id)))
    赋值 (sxksj, 未知支持库函数_1 (jlj.未知支持库函数_141 (“sj”, )))
.否则
    
.如果结束
jlj.未知支持库函数_106 ()
返回 (sxksj)

.子程序 树型框_写数据, 逻辑型, , 
.参数 id, 文本型, , 编号
.参数 sj, 字节集, , 树型框数据（字节集）

.局部变量 xlj, 未知类型0x20002, , , 
.局部变量 jg, 逻辑型, , , 

赋值 (jg, 假)
xlj.未知支持库函数_105 (“lbsj”, sdb)
.如果 (xlj.未知支持库函数_126 (相加 (“id=”, id)))
    xlj.未知支持库函数_120 ()
    xlj.未知支持库函数_136 (“sj”, 未知支持库函数_0 (sj))
    xlj.未知支持库函数_123 ()
    赋值 (jg, 真)
.否则
    
.如果结束
xlj.未知支持库函数_106 ()
返回 (jg)


.子程序 _树型框1_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _更新_被选择, 空白型, , 
sxksj ()
sxk.未知函数_67174541 ()
树型框_写数据 (到文本 (xz), sxk.未知函数_67174543 ())
赋值 (.图标, 树型框_填充数据 (到文本 (xz)))
sxk.未知函数_67174541 ()

.子程序 __启动窗口_尺寸被改变, 空白型, , 
0.移动 (0, _启动窗口., 40)
0.移动 (40, 180, 相减 (_启动窗口., 80))
180.移动 (40, 3, .高度)
183.移动 (40, 相减 (_启动窗口., 190), .高度)
.如果 (等于 (_启动窗口., 3))
    赋值 (zfgs., 15)
    zfgs.未知支持库函数_8 ()
.否则
    赋值 (zfgs., 10)
    zfgs.未知支持库函数_8 ()
.如果结束


.子程序 _树型框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

xsjg (.取项目文本 (.最大化按钮))

.子程序 _分隔条1_被拖动, 空白型, , 
.参数 原位置, 整数型, , 
.参数 目的位置, 整数型, , 

0.移动 (.顶边, 目的位置, .高度)
.如果 (小于 (目的位置, 182))
    相加 (目的位置, 4).移动 (., 相加 (相减 (_启动窗口., 目的位置), 4), .)
.否则
    相加 (目的位置, 4).移动 (., 相加 (相减 (_启动窗口., 目的位置), 4), .)
.如果结束
赋值 (., 目的位置)

.子程序 xsjg, 空白型, , 
.参数 tj, 文本型, , 

.局部变量 zytpdb, 未知类型0x20003, , , 
.局部变量 mmb, 未知类型0x20002, , , 

.如果 (等于 (xz, 1))
    mmb.未知支持库函数_105 (“zymm”, sdb)
    .如果 (mmb.未知支持库函数_126 (相加 (“药物名称='”, tj, “'”)))
        赋值 (., 相加 (“【药物名称】：”, mmb.未知支持库函数_137 (“药物名称”, ), #换行符, “【类    别】：”, mmb.未知支持库函数_137 (“类别”, ), #换行符, “【英文名称】：”, mmb.未知支持库函数_137 (“英文名称”, ), #换行符, “【别    名】：”, mmb.未知支持库函数_137 (“别名”, ), #换行符, “【来    源】：”, mmb.未知支持库函数_137 (“来源”, ), #换行符, “【植物形态】：”, mmb.未知支持库函数_137 (“植物形态1”, ), mmb.未知支持库函数_137 (“植物形态2”, ), #换行符, “【生 长 地】：”, mmb.未知支持库函数_137 (“生长地”, ), #换行符, “【采    制】：”, mmb.未知支持库函数_137 (“采制”, ), #换行符, “【化学成分】：”, mmb.未知支持库函数_137 (“化学成分”, ), #换行符, “【性    味】：”, mmb.未知支持库函数_137 (“性味”, ), #换行符, “【功能主治】：”, mmb.未知支持库函数_137 (“功能主治”, ), #换行符, “【附    注】：”, mmb.未知支持库函数_137 (“附注”, )))
    .否则
        
    .如果结束
    mmb.未知支持库函数_106 ()
    zytpdb.未知支持库函数_184 (相加 (“select * from zytp where lb='”, tj, “'”), sdb)
    zytpdb.未知支持库函数_190 ()
    .如果 (大于 (zytpdb.未知支持库函数_208 (), 0))
        赋值 (.可视, 真)
    .否则
        赋值 (.可视, 假)
    .如果结束
    zytpdb.未知支持库函数_191 ()
.否则
    
.如果结束
.如果 (等于 (xz, 2))
    mmb.未知支持库函数_105 (“yfmm”, sdb)
    .如果 (mmb.未知支持库函数_126 (相加 (“药方名称='”, tj, “'”)))
        赋值 (., 相加 (“【药方名称】：”, mmb.未知支持库函数_137 (“药方名称”, ), #换行符, “【配    方】：”, mmb.未知支持库函数_137 (“配方”, ), #换行符, “【类    别】：”, mmb.未知支持库函数_137 (“类别”, ), #换行符, “【制    法】：”, mmb.未知支持库函数_137 (“制法”, ), #换行符, “【功    用】：”, mmb.未知支持库函数_137 (“功用”, ), #换行符, “【禁    忌】：”, mmb.未知支持库函数_137 (“禁忌”, ), #换行符, “【附    注】：”, mmb.未知支持库函数_137 (“备注”, )))
    .否则
        
    .如果结束
    mmb.未知支持库函数_106 ()
.否则
    
.如果结束
.如果 (等于 (xz, 3))
    mmb.未知支持库函数_105 (“zlnr”, sdb)
    .如果 (mmb.未知支持库函数_126 (相加 (“名称='”, tj, “'”)))
        赋值 (., 相加 (“【标   题】：”, mmb.未知支持库函数_137 (“名称”, ), #换行符, “【类   别】：”, mmb.未知支持库函数_137 (“类别”, ), #换行符, “【内   容】：”, mmb.未知支持库函数_137 (“内容”, )))
    .否则
        
    .如果结束
    mmb.未知支持库函数_106 ()
.否则
    
.如果结束



.子程序 _删除_被选择, 空白型, , 
.如果 (等于 (.最大化按钮, -1))
    信息框 (“请选择要删除的类别”, 0, )
    返回 ()
.否则
    
.如果结束
.如果 (.是否有子项目 (.最大化按钮))
    信息框 (“已经有子类不能删除”, 0, )
    返回 ()
.否则
    
.如果结束
.如果 (等于 (信息框 (相加 (“你确定要删除[”, .取项目文本 (.最大化按钮), “]吗？”), #是否钮, “提示”), #是钮))
    sdb.未知支持库函数_44 ()
    .如果 (等于 (xz, 1))
        .如果 (取反 (sdb.未知支持库函数_32 (相加 (“delete from zylb where type='”, .取项目文本 (.最大化按钮), “'”))))
            信息框 (相加 (“删除[”, .取项目文本 (.最大化按钮), “]错误”), 16, )
            sdb.未知支持库函数_46 ()
        .否则
            
        .如果结束
        .如果 (取反 (sdb.未知支持库函数_32 (相加 (“delete from zymm where type='”, .取项目文本 (.最大化按钮), “'”))))
            信息框 (相加 (“删除[”, .取项目文本 (.最大化按钮), “]错误”), 16, )
            sdb.未知支持库函数_46 ()
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    .如果 (等于 (xz, 2))
        .如果 (取反 (sdb.未知支持库函数_32 (相加 (“delete from yflb where type='”, .取项目文本 (.最大化按钮), “'”))))
            信息框 (相加 (“删除[”, .取项目文本 (.最大化按钮), “]错误”), 16, )
            sdb.未知支持库函数_46 ()
        .否则
            
        .如果结束
        .如果 (取反 (sdb.未知支持库函数_32 (相加 (“delete from yfmm where type='”, .取项目文本 (.最大化按钮), “'”))))
            信息框 (相加 (“删除[”, .取项目文本 (.最大化按钮), “]错误”), 16, )
            sdb.未知支持库函数_46 ()
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    sdb.未知支持库函数_45 ()
    置等待鼠标 ()
    sxksj ()
    _更新_被选择 ()
    恢复鼠标 ()
.否则
    
.如果结束


.子程序 _编辑类别_被选择, 空白型, , 
赋值 (.播放次数, 真)

.子程序 _树型框1_结束编辑, 逻辑型, , 
.参数 项目索引, 整数型, , 

.如果 (等于 (项目索引, -1))
    信息框 (“请选择修改的类别”, 0, )
    返回 ()
.否则
    
.如果结束
.如果 (等于 (信息框 (相加 (“你确定要修改[”, 项目索引.取项目文本 (), “]吗？”), #是否钮, “提示”), #是钮))
    sdb.未知支持库函数_44 ()
    .如果 (等于 (xz, 1))
        .如果 (取反 (sdb.未知支持库函数_32 (相加 (“update  zylb set type='”, .回车下移焦点, “' where type='”, 项目索引.取项目文本 (), “'”))))
            信息框 (相加 (“修改[”, 项目索引.取项目文本 (), “]错误”), 16, )
            sdb.未知支持库函数_46 ()
        .否则
            
        .如果结束
        .如果 (取反 (sdb.未知支持库函数_32 (相加 (“update zymm set type='”, .回车下移焦点, “',类别='”, .回车下移焦点, “' where type='”, .取项目文本 (.最大化按钮), “'”))))
            信息框 (相加 (“修改[”, 项目索引.取项目文本 (), “]错误”), 16, )
            sdb.未知支持库函数_46 ()
        .否则
            
        .如果结束
        .如果 (取反 (sdb.未知支持库函数_32 (相加 (“update zymm set 药物名称='”, .回车下移焦点, “'   where 药物名称='”, .取项目文本 (.最大化按钮), “'”))))
            信息框 (相加 (“修改[”, 项目索引.取项目文本 (), “]错误”), 16, )
            sdb.未知支持库函数_46 ()
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    .如果 (等于 (xz, 2))
        .如果 (取反 (sdb.未知支持库函数_32 (相加 (“update yflb set type='”, .回车下移焦点, “'  where type='”, 项目索引.取项目文本 (), “'”))))
            信息框 (相加 (“修改[”, 项目索引.取项目文本 (), “]错误”), 16, )
            sdb.未知支持库函数_46 ()
        .否则
            
        .如果结束
        .如果 (取反 (sdb.未知支持库函数_32 (相加 (“update yfmm set type='”, .回车下移焦点, “',类别='”, .回车下移焦点, “' where type='”, 项目索引.取项目文本 (), “'”))))
            信息框 (相加 (“修改[”, 项目索引.取项目文本 (), “]错误”), 16, )
            sdb.未知支持库函数_46 ()
        .否则
            
        .如果结束
        .如果 (取反 (sdb.未知支持库函数_32 (相加 (“update yfmm set 药方名称='”, .回车下移焦点, “' where 药方名称='”, 项目索引.取项目文本 (), “'”))))
            信息框 (相加 (“修改[”, 项目索引.取项目文本 (), “]错误”), 16, )
            sdb.未知支持库函数_46 ()
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    sdb.未知支持库函数_45 ()
    置等待鼠标 ()
    sxksj ()
    _更新_被选择 ()
    恢复鼠标 ()
    赋值 (.播放次数, 假)
.否则
    项目索引.置项目文本 (项目索引.取项目文本 ())
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
赋值 (xz, 1)
赋值 (., “”)
赋值 (.图标, 树型框_填充数据 (“1”))
sxk.未知函数_67174541 ()
组合框数据填充 ()

.子程序 _按钮2_被单击, 空白型, , 
赋值 (xz, 2)
赋值 (.可视, 假)
赋值 (., “”)
赋值 (.图标, 树型框_填充数据 (“2”))
sxk.未知函数_67174541 ()
组合框数据填充 ()
 ' sxksj ()

.子程序 _增加一类_被选择, 空白型, , 
.局部变量 sfcf, 未知类型0x20003, , , 
.局部变量 xmnr, 文本型, , , 

.如果 (等于 (xz, 1))
    .如果 (输入框 (“请输入一类名称”, “一类项目”, , xmnr, ))
        .如果 (不等于 (xmnr, “”))
            sfcf.未知支持库函数_184 (相加 (“select * from zylb where type='”, xmnr, “'”), sdb)
            sfcf.未知支持库函数_190 ()
            .如果 (大于 (sfcf.未知支持库函数_208 (), 0))
                信息框 (相加 (“[”, xmnr, “]已经存在,不能增加”), 0, )
                返回 ()
            .否则
                
            .如果结束
            sfcf.未知支持库函数_191 ()
            sdb.未知支持库函数_44 ()
            .如果 (取反 (sdb.未知支持库函数_32 (相加 (“insert into zylb(type,xm)values('”, xmnr, “',0)”))))
                信息框 (相加 (“增加一类项目[”, xmnr, “]失败”), 0, )
                sdb.未知支持库函数_46 ()
            .否则
                
            .如果结束
            sdb.未知支持库函数_45 ()
            置等待鼠标 ()
            sxksj ()
            _更新_被选择 ()
            恢复鼠标 ()
            
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    
.否则
    
.如果结束
.如果 (等于 (xz, 2))
    .如果 (输入框 (“请输入一类名称”, “一类项目”, , xmnr, ))
        .如果 (不等于 (xmnr, “”))
            sfcf.未知支持库函数_184 (相加 (“select * from yflb where type='”, xmnr, “'”), sdb)
            sfcf.未知支持库函数_190 ()
            .如果 (大于 (sfcf.未知支持库函数_208 (), 0))
                信息框 (相加 (“[”, xmnr, “]已经存在,不能增加”), 0, )
                返回 ()
            .否则
                
            .如果结束
            sfcf.未知支持库函数_191 ()
            sdb.未知支持库函数_44 ()
            .如果 (取反 (sdb.未知支持库函数_32 (相加 (“insert into yflb(type,xm)values('”, xmnr, “',0)”))))
                信息框 (相加 (“增加一类项目[”, xmnr, “]失败”), 0, )
                sdb.未知支持库函数_46 ()
            .否则
                
            .如果结束
            sdb.未知支持库函数_45 ()
            置等待鼠标 ()
            sxksj ()
            _更新_被选择 ()
            恢复鼠标 ()
            
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    
.否则
    
.如果结束
.如果 (等于 (xz, 3))
    .如果 (输入框 (“请输入一类名称”, “一类项目”, , xmnr, ))
        .如果 (不等于 (xmnr, “”))
            sfcf.未知支持库函数_184 (相加 (“select * from zllb where type='”, xmnr, “'”), sdb)
            sfcf.未知支持库函数_190 ()
            .如果 (大于 (sfcf.未知支持库函数_208 (), 0))
                信息框 (相加 (“[”, xmnr, “]已经存在,不能增加”), 0, )
                返回 ()
            .否则
                
            .如果结束
            sfcf.未知支持库函数_191 ()
            sdb.未知支持库函数_44 ()
            .如果 (取反 (sdb.未知支持库函数_32 (相加 (“insert into zllb(type,xm)values('”, xmnr, “',0)”))))
                信息框 (相加 (“增加一类项目[”, xmnr, “]失败”), 0, )
                sdb.未知支持库函数_46 ()
            .否则
                
            .如果结束
            sdb.未知支持库函数_45 ()
            置等待鼠标 ()
            sxksj ()
            _更新_被选择 ()
            恢复鼠标 ()
            
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    
.否则
    
.如果结束



.子程序 _按钮4_被单击, 空白型, , 
.如果 (等于 (.现行选中项, -1))
    信息框 (“请选择查询项目”, 0, )
    返回 ()
.否则
    
.如果结束
.如果 (等于 (.内容, “”))
    信息框 (“请查询内容”, 0, )
    返回 ()
.否则
    
.如果结束
赋值 (查询窗口., 相加 (.取项目文本 (.现行选中项), “ like '%”, .内容, “%'”))
载入 (查询窗口, , 真)

.子程序 _增加二类_被选择, 空白型, , 
.如果 (等于 (.最大化按钮, -1))
    返回 ()
.否则
    
.如果结束
.如果 (不等于 (.取父项目 (.最大化按钮), -1))
    信息框 (相加 (“此类[”, .取项目文本 (.最大化按钮), “]不能添加二类”), 0, )
    返回 ()
.否则
    
.如果结束
赋值 (编辑窗口., 1)
载入 (编辑窗口, _启动窗口, 真)

.子程序 _编辑内容_被选择, 空白型, , 
.如果 (等于 (.取父项目 (.最大化按钮), -1))
    信息框 (“这是一类没有内容”, 0, )
    返回 ()
.否则
    
.如果结束
赋值 (编辑窗口., 2)
载入 (编辑窗口, _启动窗口, 真)

.子程序 _编辑框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, #回车键))
    _按钮4_被单击 ()
.否则
    
.如果结束


.子程序 _收缩数据库_被选择, 空白型, , 
置等待鼠标 ()
sdb.未知支持库函数_80 ()
恢复鼠标 ()

.子程序 _备份数据_被选择, 空白型, , 
置等待鼠标 ()
sdb.未知支持库函数_80 ()
复制文件 (相加 (取运行目录 (), “\zyyfdq.db”), 相加 (取运行目录 (), “\bak\zyyfdq.db”))
恢复鼠标 ()

.子程序 _图片_被选择, 空白型, , 
载入 (中药图片窗口, _启动窗口, 真)

.子程序 _编辑框_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _图片按钮_被单击, 空白型, , 
_图片_被选择 ()

.子程序 _按钮3_被单击, 空白型, , 
赋值 (xz, 3)
赋值 (.可视, 假)
赋值 (., “”)
赋值 (.图标, 树型框_填充数据 (“3”))
sxk.未知函数_67175353 ()
组合框数据填充 ()


.窗口程序集 查询窗口程序集, , , 

.程序集变量 zyyf_tj, 文本型, , , 
.子程序 _查询窗口_创建完毕, 空白型, , 
.局部变量 cxsql, 未知类型0x20002, , , 

 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

置等待鼠标 ()
.如果 (等于 (_启动窗口., 1))
    赋值 (查询窗口., “【中  药】查询”)
    cxsql.未知支持库函数_105 (“zymm”, _启动窗口.)
    .判断循环首 (等于 (cxsql.未知支持库函数_114 (), 假))
        cxsql.未知支持库函数_109 ()
        .如果 (cxsql.未知支持库函数_126 (zyyf_tj))
            .如果 (不等于 (cxsql.未知支持库函数_137 (“药物名称”, ), “”))
                .插入表项 ()
                相减 (取表项数 (), 1).置标题 (0, cxsql.未知支持库函数_137 (“类别”, ))
                相减 (取表项数 (), 1).置标题 (1, cxsql.未知支持库函数_137 (“药物名称”, ))
                相减 (取表项数 (), 1).置标题 (2, 取文本左边 (cxsql.未知支持库函数_137 (“功能主治”, ), 100))
            .否则
                
            .如果结束
            
        .否则
            
        .如果结束
        
    .判断循环尾 ()
    cxsql.未知支持库函数_106 ()
.否则
    
.如果结束
.如果 (等于 (_启动窗口., 2))
    赋值 (查询窗口., “【药  方】查询”)
    cxsql.未知支持库函数_105 (“yfmm”, _启动窗口.)
    .判断循环首 (等于 (cxsql.未知支持库函数_114 (), 假))
        cxsql.未知支持库函数_109 ()
        .如果 (cxsql.未知支持库函数_126 (zyyf_tj))
            .如果 (不等于 (cxsql.未知支持库函数_137 (“药方名称”, ), “”))
                .插入表项 ()
                相减 (取表项数 (), 1).置标题 (0, cxsql.未知支持库函数_137 (“类别”, ))
                相减 (取表项数 (), 1).置标题 (1, cxsql.未知支持库函数_137 (“药方名称”, ))
                相减 (取表项数 (), 1).置标题 (2, cxsql.未知支持库函数_137 (“功用”, ))
            .否则
                
            .如果结束
             ' 本源码来自易语言资源网(www.5A5X.com)
        .否则
            
        .如果结束
        
    .判断循环尾 ()
    cxsql.未知支持库函数_106 ()
.否则
    
.如果结束
.如果 (等于 (_启动窗口., 3))
    赋值 (查询窗口., “【资  料】查询”)
    2.置列标题 (“内容”)
    cxsql.未知支持库函数_105 (“zlnr”, _启动窗口.)
    .判断循环首 (等于 (cxsql.未知支持库函数_114 (), 假))
        cxsql.未知支持库函数_109 ()
        .如果 (cxsql.未知支持库函数_126 (zyyf_tj))
            .如果 (不等于 (cxsql.未知支持库函数_137 (“名称”, ), “”))
                .插入表项 ()
                相减 (取表项数 (), 1).置标题 (0, cxsql.未知支持库函数_137 (“类别”, ))
                相减 (取表项数 (), 1).置标题 (1, cxsql.未知支持库函数_137 (“名称”, ))
                相减 (取表项数 (), 1).置标题 (2, cxsql.未知支持库函数_137 (“内容”, ))
            .否则
                
            .如果结束
             ' 本源码来自易语言资源网(www.5A5X.com)
        .否则
            
        .如果结束
        
    .判断循环尾 ()
    cxsql.未知支持库函数_106 ()
.否则
    
.如果结束

恢复鼠标 ()

.子程序 _超级列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 qxzwb, 整数型, , , 
.局部变量 xzqzf, 未知类型0x40004, , , 
.局部变量 i, 空白型, , , 

.如果 (等于 (.取标题 (., 0), “”))
    返回 ()
.否则
    
.如果结束
.计次循环首 (_启动窗口.取项目数 (.), i)
    .如果 (等于 (_启动窗口.取项目文本 (., 相减 (i, 1)), .取标题 (., 1)))
        赋值 (_启动窗口..最大化按钮, 相减 (i, 1))
    .否则
        ' 本源码来自易语言资源网(www.5A5X.com)
    .如果结束
    
.计次循环尾 ()
_启动窗口.xsjg (.取标题 (., 1))
赋值 (qxzwb, _启动窗口.未知支持库函数_16 (., 相加 (qxzwb, 1), 假, 真, _启动窗口..内容))
赋值 (_启动窗口.., qxzwb)
赋值 (_启动窗口.., 取文本长度 (_启动窗口..内容))
赋值 (xzqzf., #藏青)
赋值 (xzqzf., 1)
 ' _启动窗口.未知支持库函数_10 (., xzqzf)
_启动窗口.获取焦点 (.)

.窗口程序集 编辑窗口程序集, , , 

.程序集变量 zy_tp, 中药图片, , "0", 
.程序集变量 xgxz, 整数型, , , 
.子程序 _编辑窗口_创建完毕, 空白型, , 
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

编辑内容 ()
.如果 (并且 (等于 (_启动窗口., 1), 等于 (xgxz, 1)))
    赋值 (编辑窗口., “【中  药】添加”)
    赋值 (编辑窗口., 620)
    赋值 (.可视, 真)
    赋值 (.现行子夹, 0)
.否则
    
.如果结束
.如果 (并且 (等于 (_启动窗口., 1), 等于 (xgxz, 2)))
    赋值 (编辑窗口., “【中  药】编辑”)
    赋值 (编辑窗口., 620)
    赋值 (.现行子夹, 0)
.否则
    
.如果结束
.如果 (并且 (等于 (_启动窗口., 2), 等于 (xgxz, 2)))
    赋值 (编辑窗口., “【药  方】编辑”)
    赋值 (编辑窗口., 459)
    赋值 (.现行子夹, 1)
.否则
     ' 本源码来自易语言资源网(www.5A5X.com)
.如果结束
.如果 (并且 (等于 (_启动窗口., 2), 等于 (xgxz, 1)))
    赋值 (.可视, 真)
    赋值 (编辑窗口., “【药  方】添加”)
    赋值 (编辑窗口., 459)
    赋值 (.现行子夹, 1)
.否则
    
.如果结束
.如果 (并且 (等于 (_启动窗口., 3), 等于 (xgxz, 2)))
    赋值 (编辑窗口., “【资  料】编辑”)
    赋值 (编辑窗口., 459)
    赋值 (.现行子夹, 2)
.否则
    
.如果结束
.如果 (并且 (等于 (_启动窗口., 3), 等于 (xgxz, 1)))
    赋值 (.可视, 真)
    赋值 (编辑窗口., “【资  料】添加”)
    赋值 (编辑窗口., 459)
    赋值 (.现行子夹, 2)
.否则
    
.如果结束


.子程序 编辑内容, 空白型, , 
.局部变量 zytp, 中药图片, , , 
.局部变量 bjsql, 未知类型0x20002, , , 

.如果 (等于 (xgxz, 2))
    .如果 (等于 (_启动窗口., 1))
        bjsql.未知支持库函数_105 (“zymm”, _启动窗口.)
        .如果 (bjsql.未知支持库函数_126 (相加 (“药物名称='”, _启动窗口.取项目文本 (., _启动窗口..最大化按钮), “'”)))
            赋值 (.内容, bjsql.未知支持库函数_137 (“药物名称”, ))
            赋值 (.输入方式, 1)
            赋值 (.内容, bjsql.未知支持库函数_137 (“类别”, ))
            赋值 (.内容, bjsql.未知支持库函数_137 (“别名”, ))
            赋值 (.内容, bjsql.未知支持库函数_137 (“英文名称”, ))
            赋值 (.内容, bjsql.未知支持库函数_137 (“植物形态1”, ))
            赋值 (.内容, bjsql.未知支持库函数_137 (“植物形态2”, ))
            赋值 (.内容, bjsql.未知支持库函数_137 (“来源”, ))
            赋值 (.内容, bjsql.未知支持库函数_137 (“生长地”, ))
            赋值 (.内容, bjsql.未知支持库函数_137 (“采制”, ))
            赋值 (.内容, bjsql.未知支持库函数_137 (“化学成分”, ))
            赋值 (.内容, bjsql.未知支持库函数_137 (“性味”, ))
            赋值 (.内容, bjsql.未知支持库函数_137 (“功能主治”, ))
            赋值 (.内容, bjsql.未知支持库函数_137 (“附注”, ))
        .否则
            
        .如果结束
        bjsql.未知支持库函数_106 ()
        bjsql.未知支持库函数_105 (“zytp”, _启动窗口.)
        .判断循环首 (等于 (bjsql.未知支持库函数_114 (), 假))
            bjsql.未知支持库函数_109 ()
            .如果 (bjsql.未知支持库函数_126 (相加 (“lb='”, .内容, “'”)))
                .插入表项 ()
                相减 (取表项数 (), 1).置标题 (0, 到文本 (bjsql.未知支持库函数_138 (“id”, )))
                相减 (取表项数 (), 1).置标题 (1, bjsql.未知支持库函数_137 (“lb”, ))
                赋值 (zytp.id, bjsql.未知支持库函数_138 (“id”, ))
                赋值 (zytp.类别, bjsql.未知支持库函数_137 (“lb”, ))
                赋值 (zytp.图片, 未知支持库函数_1 (bjsql.未知支持库函数_141 (“tp”, )))
                加入成员 (zy_tp, zytp)
                赋值 (.图片, zytp.图片)
                赋值 (., 相减 (zytp.id, 1))
            .否则
                
            .如果结束
            
        .判断循环尾 ()
        bjsql.未知支持库函数_106 ()
    .否则
        
    .如果结束
    .如果 (等于 (_启动窗口., 2))
        bjsql.未知支持库函数_105 (“yfmm”, _启动窗口.)
        .如果 (bjsql.未知支持库函数_126 (相加 (“药方名称='”, _启动窗口.取项目文本 (., _启动窗口..最大化按钮), “'”)))
            赋值 (.内容, bjsql.未知支持库函数_137 (“药方名称”, ))
            赋值 (.输入方式, 1)
            赋值 (.内容, bjsql.未知支持库函数_137 (“类别”, ))
            赋值 (.内容, bjsql.未知支持库函数_137 (“配方”, ))
            赋值 (.内容, bjsql.未知支持库函数_137 (“制法”, ))
            赋值 (.内容, bjsql.未知支持库函数_137 (“功用”, ))
            赋值 (.内容, bjsql.未知支持库函数_137 (“禁忌”, ))
            赋值 (.内容, bjsql.未知支持库函数_137 (“备注”, ))
        .否则
            
        .如果结束
        bjsql.未知支持库函数_106 ()
    .否则
        
    .如果结束
    
.否则
    
.如果结束
.如果 (等于 (_启动窗口., 3))
    bjsql.未知支持库函数_105 (“zlnr”, _启动窗口.)
    .如果 (bjsql.未知支持库函数_126 (相加 (“名称='”, _启动窗口.取项目文本 (., _启动窗口..最大化按钮), “'”)))
        赋值 (.内容, bjsql.未知支持库函数_137 (“名称”, ))
        赋值 (.输入方式, 1)
        赋值 (.内容, bjsql.未知支持库函数_137 (“类别”, ))
        赋值 (.内容, bjsql.未知支持库函数_137 (“内容”, ))
    .否则
        
    .如果结束
    bjsql.未知支持库函数_106 ()
.否则
    
.如果结束
.如果 (等于 (xgxz, 1))
    .如果 (等于 (_启动窗口., 1))
        赋值 (.输入方式, 0)
        赋值 (.内容, _启动窗口.取项目文本 (., _启动窗口..最大化按钮))
    .否则
        
    .如果结束
    .如果 (等于 (_启动窗口., 2))
        赋值 (.输入方式, 0)
        赋值 (.内容, _启动窗口.取项目文本 (., _启动窗口..最大化按钮))
    .否则
        
    .如果结束
    .如果 (等于 (_启动窗口., 3))
        赋值 (.输入方式, 0)
        赋值 (.内容, _启动窗口.取项目文本 (., _启动窗口..最大化按钮))
    .否则
         ' 本源码来自易语言资源网(www.5A5X.com)
    .如果结束
    
.否则
    
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _按钮4_被单击, 空白型, , 
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 i, 空白型, , , 
.局部变量 tpsql, 未知类型0x20002, , , 

.如果 (等于 (.内容, “”))
    返回 ()
.否则
    
.如果结束
_启动窗口.未知支持库函数_44 (., )
.如果 (等于 (xgxz, 1))
    .如果 (取反 (_启动窗口.未知支持库函数_32 (., 相加 (“insert into zylb(type,xm)select '”, .内容, “',id from zylb where type='”, .内容, “'”))))
        信息框 (相加 (“添加[”, .内容, “]失败”), 0, )
        _启动窗口.未知支持库函数_46 (., )
    .否则
        
    .如果结束
    .如果 (取反 (_启动窗口.未知支持库函数_32 (., 相加 (“insert into zymm(type,药物名称,类别,英文名称,别名,来源,植物形态1,植物形态2,生长地,采制,化学成分,性味,功能主治,附注)values('”, .内容, “', '”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, 删全部空 (.内容), “','”, 删全部空 (.内容), “','”, 删全部空 (.内容), “','”, 删全部空 (.内容), “','”, 删全部空 (.内容), “','”, 删全部空 (.内容), “','”, 删全部空 (.内容), “','”, 删全部空 (.内容), “','”, 删全部空 (.内容), “')”))))
        信息框 (相加 (“添加[”, .内容, “]失败”), 0, )
        _启动窗口.未知支持库函数_46 (., )
    .否则
        
    .如果结束
    ' 本源码来自易语言资源网(www.5A5X.com)
    tpsql.未知支持库函数_105 (“zytp”, _启动窗口.)
    .计次循环首 (取数组成员数 (zy_tp), i)
        .如果 (不等于 (zy_tp [i], 类别, “”))
            tpsql.未知支持库函数_121 ()
            tpsql.未知支持库函数_136 (“id”, zy_tp [i], id)
            tpsql.未知支持库函数_136 (“lb”, zy_tp [i], 类别)
            tpsql.未知支持库函数_136 (“tp”, 未知支持库函数_0 (zy_tp [i], 图片))
            tpsql.未知支持库函数_123 ()
        .否则
            
        .如果结束
        
    .计次循环尾 ()
    tpsql.未知支持库函数_106 ()
    _启动窗口.sxksj ()
    _启动窗口._更新_被选择 ()
.否则
    
.如果结束
.如果 (等于 (xgxz, 2))
    .如果 (取反 (_启动窗口.未知支持库函数_32 (., 相加 (“update zymm set 英文名称='”, .内容, “',别名='”, .内容, “',来源='”, 删全部空 (.内容), “',植物形态1='”, 删全部空 (.内容), “',植物形态2='”, 删全部空 (.内容), “',生长地='”, 删全部空 (.内容), “',采制='”, 删全部空 (.内容), “',化学成分='”, 删全部空 (.内容), “',性味='”, 删全部空 (.内容), “',功能主治='”, 删全部空 (.内容), “',附注='”, 删全部空 (.内容), “' where 药物名称='”, .内容, “'”))))
        信息框 (相加 (“修改[”, .内容, “]失败”), 0, )
        _启动窗口.未知支持库函数_46 (., )
    .否则
        
    .如果结束
    .如果 (取反 (_启动窗口.未知支持库函数_32 (., 相加 (“delete from zytp where lb='”, .内容, “'”))))
        _启动窗口.未知支持库函数_46 (., )
    .否则
        tpsql.未知支持库函数_105 (“zytp”, _启动窗口.)
        .计次循环首 (取数组成员数 (zy_tp), i)
            tpsql.未知支持库函数_121 ()
            tpsql.未知支持库函数_136 (“id”, zy_tp [i], id)
            tpsql.未知支持库函数_136 (“lb”, zy_tp [i], 类别)
            tpsql.未知支持库函数_136 (“tp”, 未知支持库函数_0 (zy_tp [i], 图片))
            tpsql.未知支持库函数_123 ()
        .计次循环尾 ()
        tpsql.未知支持库函数_106 ()
    .如果结束
    
.否则
    
.如果结束
_启动窗口.未知支持库函数_45 (., )
_启动窗口.xsjg (.内容)
.如果 (.选中)
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
    赋值 (.图片, {  })
    全部删除 ()
.否则
    销毁 ()
.如果结束


.子程序 _按钮3_被单击, 空白型, , 
.如果 (等于 (.内容, “”))
    返回 ()
.否则
    
.如果结束
_启动窗口.未知支持库函数_44 (., )
.如果 (等于 (xgxz, 1))
    .如果 (取反 (_启动窗口.未知支持库函数_32 (., 相加 (“insert into yflb(type,xm)select '”, .内容, “',id from yflb where type='”, .内容, “'”))))
        信息框 (相加 (“添加[”, .内容, “]失败”), 0, )
        _启动窗口.未知支持库函数_46 (., )
    .否则
        
    .如果结束
    .如果 (取反 (_启动窗口.未知支持库函数_32 (., 相加 (“insert into yfmm(type,药方名称,类别,配方,制法,功用,禁忌,备注)values('”, .内容, “', '”, .内容, “','”, .内容, “','”, 删全部空 (.内容), “','”, 删全部空 (.内容), “','”, 删全部空 (.内容), “','”, 删全部空 (.内容), “','”, 删全部空 (.内容), “')”))))
        信息框 (相加 (“添加[”, .内容, “]失败”), 0, )
        _启动窗口.未知支持库函数_46 (., )
    .否则
        
    .如果结束
    _启动窗口.sxksj ()
    _启动窗口._更新_被选择 ()
.否则
    
.如果结束
.如果 (等于 (xgxz, 2))
    .如果 (取反 (_启动窗口.未知支持库函数_32 (., 相加 (“update yfmm set 配方='”, 删全部空 (.内容), “',制法='”, 删全部空 (.内容), “',功用='”, 删全部空 (.内容), “',禁忌='”, 删全部空 (.内容), “',备注='”, 删全部空 (.内容), “' where 药方名称='”, .内容, “'”))))
        信息框 (相加 (“修改[”, .内容, “]失败”), 0, )
        _启动窗口.未知支持库函数_46 (., )
    .否则
        
    .如果结束
    
.否则
    
.如果结束
_启动窗口.未知支持库函数_45 (., )
_启动窗口.xsjg (.内容)
.如果 (.选中)
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容)
.否则
    销毁 ()
.如果结束


.子程序 d_tp, 空白型, , 
.参数 id, 文本型, , 

.局部变量 i, 空白型, , , 

.计次循环首 (取数组成员数 (zy_tp), i)
    .如果 (等于 (zy_tp [i], id, 到数值 (id)))
        赋值 (.图片, zy_tp [i], 图片)
        跳出循环 ()
    .否则
        
    .如果结束
    
.计次循环尾 ()

.子程序 _删除按钮_被单击, 空白型, , 
.局部变量 a, 空白型, , , 

.如果 (等于 (., -1))
    返回 ()
.否则
    
.如果结束
赋值 (a, 1)
.计次循环首 (取数组成员数 (zy_tp), a)
    .如果 (等于 (zy_tp [a], id, 到数值 (.取标题 (., 0))))
        删除成员 (zy_tp, a, 1)
        跳出循环 ()
    .否则
        
    .如果结束
    
.计次循环尾 ()
.计次循环首 (取数组成员数 (zy_tp), a)
    赋值 (zy_tp [a], id, a)
    调试输出 (a, zy_tp [a], id)
.计次循环尾 ()
.删除表项 (.)
.计次循环首 (取表项数 (), a)
    相减 (a, 1).置标题 (0, 到文本 (a))
.计次循环尾 ()
赋值 (.图片, {  })
赋值 (.禁止, 真)

.子程序 _图片列表框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (., -1))
    返回 ()
.否则
    
.如果结束
d_tp (.取标题 (., 0))
赋值 (.禁止, 假)

.子程序 _按钮7_被单击, 空白型, , 
.局部变量 sctp, 中药图片, , , 
.局部变量 lj, 文本型, , , 

赋值 (lj, 未知支持库函数_2 (“选择图片”, 真))
.如果 (不等于 (lj, “”))
    赋值 (.图片, 读入文件 (lj))
    .插入表项 ()
    相减 (取表项数 (), 1).置标题 (0, 到文本 (取表项数 ()))
    相减 (取表项数 (), 1).置标题 (1, .内容)
    相减 (取表项数 (), 1).置标题 (2, lj)
    赋值 (sctp.id, 取表项数 ())
    赋值 (sctp.类别, .内容)
    赋值 (sctp.图片, 读入文件 (lj))
    加入成员 (zy_tp, sctp)
.否则
    
.如果结束


.子程序 _按钮6_被单击, 空白型, , 
销毁 ()


.子程序 _按钮5_被单击, 空白型, , 
.如果 (等于 (.内容, “”))
    返回 ()
.否则
    
.如果结束
_启动窗口.未知支持库函数_44 (., )
.如果 (等于 (xgxz, 1))
    .如果 (取反 (_启动窗口.未知支持库函数_32 (., 相加 (“insert into zllb(type,xm)select '”, .内容, “',id from zllb where type='”, .内容, “'”))))
        信息框 (相加 (“添加[”, .内容, “]失败”), 0, )
        _启动窗口.未知支持库函数_46 (., )
    .否则
        
    .如果结束
    .如果 (取反 (_启动窗口.未知支持库函数_32 (., 相加 (“insert into zlnr(名称,类别,内容)values('”, .内容, “', '”, .内容, “','”, 删全部空 (.内容), “')”))))
        信息框 (相加 (“添加[”, .内容, “]失败”), 0, )
        _启动窗口.未知支持库函数_46 (., )
    .否则
        
    .如果结束
    _启动窗口.sxksj ()
    _启动窗口._更新_被选择 ()
.否则
    
.如果结束
.如果 (等于 (xgxz, 2))
    .如果 (取反 (_启动窗口.未知支持库函数_32 (., 相加 (“update zlnr set 内容='”, 删全部空 (.内容), “' where 名称='”, .内容, “'”))))
        信息框 (相加 (“修改[”, .内容, “]失败”), 0, )
        _启动窗口.未知支持库函数_46 (., )
    .否则
        
    .如果结束
    
.否则
    
.如果结束
_启动窗口.未知支持库函数_45 (., )
_启动窗口.xsjg (.内容)
.如果 (.选中)
    连续赋值 (“”, .内容, .内容)
.否则
    销毁 ()
.如果结束


.窗口程序集 中药图片窗口程序集, , , 

.子程序 _中药图片窗口_创建完毕, 空白型, , 
.局部变量 tpdsql, 未知类型0x20002, , , 
.局部变量 i, 空白型, , , 

 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

tpdsql.未知支持库函数_105 (“zytp”, _启动窗口.)
.判断循环首 (等于 (tpdsql.未知支持库函数_114 (), 假))
    tpdsql.未知支持库函数_109 ()
    .如果 (tpdsql.未知支持库函数_126 (相加 (“lb='”, _启动窗口.取项目文本 (., _启动窗口..最大化按钮), “'”)))
        .如果 (不等于 (tpdsql.未知支持库函数_137 (“lb”, ), “”))
            .插入表项 ()
            相减 (取表项数 (), 1).置标题 (0, 到文本 (tpdsql.未知支持库函数_138 (“id”, )))
            相减 (取表项数 (), 1).置标题 (1, tpdsql.未知支持库函数_137 (“lb”, ))
            赋值 (.图片, 未知支持库函数_1 (tpdsql.未知支持库函数_141 (“tp”, )))
            赋值 (., 相减 (tpdsql.未知支持库函数_138 (“id”, ), 1))
        .否则
            
        .如果结束
        
    .否则
         ' 本源码来自易语言资源网(www.5A5X.com)
    .如果结束
    
.判断循环尾 ()

.子程序 _列表框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 dtp, 未知类型0x20002, , , 

.如果 (等于 (., -1))
    返回 ()
.否则
    
.如果结束
dtp.未知支持库函数_105 (“zytp”, _启动窗口.)
.如果 (dtp.未知支持库函数_126 (相加 (“id=”, .取标题 (., 0), “ and lb='”, .取标题 (., 1), “'”)))
    赋值 (.图片, 未知支持库函数_1 (dtp.未知支持库函数_141 (“tp”, )))
.否则
    ' 本源码来自易语言资源网(www.5A5X.com)
.如果结束
dtp.未知支持库函数_106 ()

.类模块 树型框操作类, , , 

.子程序 数据_取项目数, 整数型, , 返回树型框中所有项目的数目。


.子程序 数据_取缩进层次, 整数型, , 返回指定项目所处缩进层次，层次值从1开始。如果未找到指定项目，返回 0 。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_取项目文本, 文本型, , 返回指定项目的文本。如果该项目不存在，将返回空文本。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_取图片, 整数型, , 返回指定项目的图片索引。如果该项目不存在，将返回 -1 
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_取选中图片, 整数型, , 返回指定项目被选中后的图片索引。如果该项目不存在，将返回 -1 。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_取项目数值, 整数型, , 返回与指定项目相关联的数值。如果该项目不存在，将返回 0 。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_置图片, 逻辑型, , 设置在指定项目首部所显示图片的索引。成功返回真，失败返回假。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_图片索引, 整数型, , 图片索引用于指定图片组属性中的某张图片，从 0 开始。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_置选中图片, 逻辑型, , 设置指定项目被选中后所显示图片的索引。成功返回真，失败返回假。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_图片索引, 整数型, , 图片索引用于指定图片组属性中的某张图片，从 0 开始。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_置项目数值, 逻辑型, , 设置与指定项目相关联的数值。成功返回真，失败返回假。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_欲置入的项目数值, 整数型, 可空, 可以被省略。该数值与指定项目相关联。如果本参数被省略，默认值为 0 。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_置项目文本, 逻辑型, , 设置指定项目的文本。成功返回真，失败返回假。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_欲置入的项目文本, 文本型, , 
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 动作_保证显示, 空白型, , 
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 状态_扩展, 空白型, , 将指打开指定项目的下属分枝。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 状态_收缩, 空白型, , 缩回指定项目的下属分枝。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_加入项目_API方式加入, 整数型, , 将单个或一批项目加入到树型框中，如果仅加入一个项目，成功返回加入后该项目所处的位置，失败返回 -1 。如果成批加入项目，成功返回 0 ，失败返回 -1 。成批加入项目可以用作一次性快速加入大量项目到树型框中。
.参数 参数_父项目索引, 整数型, 可空, 可以被省略。指定欲加入项目所处的父项目，0 为项目一，1 为项目二，如此类推。如果没有父项目（即欲加入项目为顶层项目），请提供值 -1 。如果本参数被省略，默认值为 -1 。
.参数 参数_项目数据1, 项目数据, 可空, 用于只加入一个项目，如欲批量加入，请留空
.参数 参数_项目数据2, 项目数据, 可空 数组, 用于批量加入项目
.参数 参数_加入方式, 整数型, 可空, 可以被省略。默认为 #树形框插入项目_在列表尾部插入
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。
.参数 参数_是否使用高速插入, 逻辑型, 可空, 可以被省略。当使用高速插入时，最高可提速5倍。默认为真高速加入。



.子程序 数据_删除项目, 逻辑型, , 删除树型框中的指定项目。成功返回真，失败返回假。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_清空, 空白型, , 删除树型框中的所有项目。


.子程序 数据_取父项目, 整数型, , 返回指定项目的父项目索引。如果该项目为顶层项目，将返回 -1 。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 状态_是否有子项目, 逻辑型, , 如果指定项目存在子项目，返回真，否则返回假。如果本命令返回真，意味着指定项目的下一项即为此项目的第一个子项目。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 状态_是否已扩展, 逻辑型, , 如果树型框中的指定项目具有子项目并已扩展显示，返回真，否则返回假。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 样式_背景色_置, 空白型, , 
.参数 参数_背景颜色, 整数型, , 



.子程序 样式_背景色_取, 整数型, , 


.子程序 样式_项目间隔_置, 空白型, , 
.参数 参数_间隔距离, 整数型, 可空, 默认为16



.子程序 样式_项目间隔_取, 整数型, , 


.子程序 样式_文本颜色_置, 空白型, , 
.参数 参数_文本颜色, 整数型, , 



.子程序 样式_文本颜色_取, 整数型, , 


.子程序 样式_连线颜色_置, 空白型, , 
.参数 参数_连线颜色, 整数型, , 



.子程序 样式_连线颜色_取, 整数型, , 


.子程序 样式_使用复选框, 空白型, , 


.子程序 样式_使用热点跟踪, 空白型, , 


.子程序 样式_禁止滚动条, 逻辑型, , 返回禁止的状态
.参数 参数_禁止, 逻辑型, 可空, 真为禁止，假为解除禁止。默认为真



.子程序 样式_禁止水平滚动条, 逻辑型, , 返回禁止的状态
.参数 参数_禁止, 逻辑型, 可空, 真为禁止，假为解除禁止。默认为真



.子程序 样式_使用整行选择, 逻辑型, , 要使用本功能，就不能使用显示连线。
.参数 参数_是否使用, 逻辑型, 可空, 真为使用，假为不使用。默认为真。



.子程序 状态_是否选中, 逻辑型, , 
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 状态_选中项目, 逻辑型, , 操作成功返回真
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否选中, 逻辑型, 可空, 可以被省略。设置项目的选中状态，默认为真。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 状态_加粗, 空白型, , 
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 状态_取消加粗, 空白型, , 将指定项目的标题取消加粗显示。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_现行选中项_置, 空白型, , 
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_取可显示数量, 整数型, , 取当前在树形框的用户区中大约可以显示的项目数量
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_取第一项索引, 整数型, , 取在当前树形框中显示的第一条项目的索引。失败返回-1
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_现行选中项_取, 整数型, , 
.参数 局部_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_取全部选中项, 变体型, , 返回选中项索引数组
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 置自动更新状态, 空白型, , 本方法决定了各个其它方法中“是否自动更新数据”参数的默认值。默认状态下，如果不使用本方法进行操作，“是否自动更新数据”参数的默认值将自动设置为真。
.参数 局部_自动更新, 逻辑型, , 



.子程序 查询自动更新状态, 逻辑型, , 


.子程序 _初始化类, 空白型, , 
.参数 参数_树型框, 树型框, , 



.子程序 _更新数据, 空白型, , 当某些操作没有使用自动更新时，可在这里以手动方式进行数据更新


.子程序 数据_加入项目_字节集方式加入, 整数型, , 将单个或一批项目加入到树型框中，如果仅加入一个项目，成功返回加入后该项目所处的位置，失败返回 -1 。如果成批加入项目，成功返回 0 ，失败返回 -1 。成批加入项目可以用作一次性快速加入大量项目到树型框中。注意，加入数据后，树形框的句柄将会改变。
.参数 参数_父项目索引, 整数型, 可空, 可以被省略。指定欲加入项目所处的父项目，0 为项目一，1 为项目二，如此类推。如果没有父项目（即欲加入项目为顶层项目），请提供值 -1 。如果本参数被省略，默认值为 -1 。
.参数 参数_项目文本, 文本型, 数组, 如果欲只加入一个项目，请提供一个成员的数组数据。
.参数 参数_图片索引, 整数型, 可空 数组, 可以被省略。图片索引用于指定图片组属性中的某张图片，从 0 开始。如果本参数被省略，所有被加入项目的图片索引都默认为 0 。如果欲只加入一个项目，请提供一个成员的数组数据。
.参数 参数_选中图片索引, 整数型, 可空 数组, 可以被省略。选中图片索引用于指定项目被选中后所显示的图片，-1 表示与图片索引一致。如果本参数被省略，所有被加入项目的选中图片索引都默认为 -1 。如果欲只加入一个项目，请提供一个成员的数组数据。
.参数 参数_项目数值, 整数型, 可空 数组, 可以被省略。指定与本项目相关联的数值。如果本参数被省略，所有被加入项目的项目数值都默认为 0 。如果欲只加入一个项目，请提供一个成员的数组数据。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为真。



.子程序 生成数据, 字节集, , 


.子程序 数据_读树形框, 空白型, , 
.参数 参数_项目数据, 字节集, , 
.参数 参数_树型框结构数据, 树型框结构, 参考 数组, 



.类模块 树型框句柄操作类, , , 

.子程序 数据_取项目数, 整数型, , 返回树型框中所有项目的数目。


.子程序 数据_取缩进层次, 整数型, , 返回指定项目所处缩进层次，层次值从1开始。如果未找到指定项目，返回 0 。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_取项目文本, 文本型, , 返回指定项目的文本。如果该项目不存在，将返回空文本。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_取图片, 整数型, , 返回指定项目的图片索引。如果该项目不存在，将返回 -1 
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_取选中图片, 整数型, , 返回指定项目被选中后的图片索引。如果该项目不存在，将返回 -1 。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_取项目数值, 整数型, , 返回与指定项目相关联的数值。如果该项目不存在，将返回 0 。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_置图片, 逻辑型, , 设置在指定项目首部所显示图片的索引。成功返回真，失败返回假。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_图片索引, 整数型, , 图片索引用于指定图片组属性中的某张图片，从 0 开始。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_置选中图片, 逻辑型, , 设置指定项目被选中后所显示图片的索引。成功返回真，失败返回假。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_图片索引, 整数型, , 图片索引用于指定图片组属性中的某张图片，从 0 开始。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_置项目数值, 逻辑型, , 设置与指定项目相关联的数值。成功返回真，失败返回假。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_欲置入的项目数值, 整数型, 可空, 可以被省略。该数值与指定项目相关联。如果本参数被省略，默认值为 0 。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_置项目文本, 逻辑型, , 设置指定项目的文本。成功返回真，失败返回假。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_欲置入的项目文本, 文本型, , 
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 动作_保证显示, 空白型, , 
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 状态_扩展, 空白型, , 将指打开指定项目的下属分枝。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 状态_收缩, 空白型, , 缩回指定项目的下属分枝。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_加入项目_API方式加入, 整数型, , 将单个或一批项目加入到树型框中，如果仅加入一个项目，成功返回加入后该项目所处的位置，失败返回 -1 。如果成批加入项目，成功返回 0 ，失败返回 -1 。成批加入项目可以用作一次性快速加入大量项目到树型框中。
.参数 参数_父项目索引, 整数型, 可空, 可以被省略。指定欲加入项目所处的父项目，0 为项目一，1 为项目二，如此类推。如果没有父项目（即欲加入项目为顶层项目），请提供值 -1 。如果本参数被省略，默认值为 -1 。
.参数 参数_项目数据1, 项目数据, 可空, 用于只加入一个项目，如欲批量加入，请留空
.参数 参数_项目数据2, 项目数据, 可空 数组, 用于批量加入项目
.参数 参数_加入方式, 整数型, 可空, 可以被省略。默认为 #树形框插入项目_在列表尾部插入
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。
.参数 参数_是否使用高速插入, 逻辑型, 可空, 可以被省略。当使用高速插入时，最高可提速5倍。默认为真高速加入。



.子程序 数据_删除项目, 逻辑型, , 删除树型框中的指定项目。成功返回真，失败返回假。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_清空, 空白型, , 删除树型框中的所有项目。


.子程序 数据_取父项目, 整数型, , 返回指定项目的父项目索引。如果该项目为顶层项目，将返回 -1 。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 状态_是否有子项目, 逻辑型, , 如果指定项目存在子项目，返回真，否则返回假。如果本命令返回真，意味着指定项目的下一项即为此项目的第一个子项目。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 状态_是否已扩展, 逻辑型, , 如果树型框中的指定项目具有子项目并已扩展显示，返回真，否则返回假。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 样式_背景色_置, 空白型, , 
.参数 参数_背景颜色, 整数型, , 



.子程序 样式_背景色_取, 整数型, , 


.子程序 样式_项目间隔_置, 空白型, , 
.参数 参数_间隔距离, 整数型, 可空, 默认为16



.子程序 样式_项目间隔_取, 整数型, , 


.子程序 样式_文本颜色_置, 空白型, , 
.参数 参数_文本颜色, 整数型, , 



.子程序 样式_文本颜色_取, 整数型, , 


.子程序 样式_连线颜色_置, 空白型, , 
.参数 参数_连线颜色, 整数型, , 



.子程序 样式_连线颜色_取, 整数型, , 


.子程序 样式_使用复选框, 空白型, , 


.子程序 样式_使用热点跟踪, 空白型, , 


.子程序 样式_禁止滚动条, 逻辑型, , 返回禁止的状态
.参数 参数_禁止, 逻辑型, 可空, 真为禁止，假为解除禁止。默认为真



.子程序 样式_禁止水平滚动条, 逻辑型, , 返回禁止的状态
.参数 参数_禁止, 逻辑型, 可空, 真为禁止，假为解除禁止。默认为真



.子程序 样式_使用整行选择, 逻辑型, , 要使用本功能，就不能使用显示连线。
.参数 参数_是否使用, 逻辑型, 可空, 真为使用，假为不使用。默认为真。



.子程序 状态_是否选中, 逻辑型, , 
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 状态_选中项目, 逻辑型, , 操作成功返回真
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否选中, 逻辑型, 可空, 可以被省略。设置项目的选中状态，默认为真。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 状态_加粗, 空白型, , 
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 状态_取消加粗, 空白型, , 将指定项目的标题取消加粗显示。
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_现行选中项_置, 空白型, , 
.参数 参数_项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_取可显示数量, 整数型, , 取当前在树形框的用户区中大约可以显示的项目数量
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_取第一项索引, 整数型, , 取在当前树形框中显示的第一条项目的索引。失败返回-1
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_现行选中项_取, 整数型, , 
.参数 局部_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 数据_取全部选中项, 变体型, , 返回选中项索引数组
.参数 参数_是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。



.子程序 置自动更新状态, 空白型, , 本方法决定了各个其它方法中“是否自动更新数据”参数的默认值。默认状态下，如果不使用本方法进行操作，“是否自动更新数据”参数的默认值将自动设置为真。
.参数 局部_自动更新, 逻辑型, , 



.子程序 查询自动更新状态, 逻辑型, , 


.子程序 _初始化类, 逻辑型, , 成功返回真
.参数 树型框句柄, 整数型, , 
.参数 是否为外部进程的树形框, 逻辑型, 可空, 可以被省略。当为真时，可对这个外部进程一树形框进行操作。默认为假。



.子程序 _更新数据, 空白型, , 当某些操作没有使用自动更新时，可在这里以手动方式进行数据更新


.子程序 _取消外部操作, 空白型, , 当要取消对外部树形框的操作，而转向使用内部树形框时，可使用此方法。


.子程序 _使用外部操作, 空白型, , 当要取消对内部树形框的操作，而转向使用外部树形框时，可使用此方法。



 ' 不属于任何一个程序集、类模块的函数：
