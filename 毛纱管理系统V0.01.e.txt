 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.wodesoft.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.wodesoft.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.wodesoft.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 802
    高度 = 625
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “毛纱管理系统V0.01 Copy Right In 2009 By 阿立”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 372
    高度 = 340
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于”
    帮助文件名 = “”

窗口 登录窗口
    左边 = 50
    顶边 = 50
    宽度 = 437
    高度 = 249
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口_生成装箱单
    左边 = 50
    顶边 = 50
    宽度 = 233
    高度 = 169
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “生成装箱单”
    帮助文件名 = “”

窗口 注册窗口
    左边 = 50
    顶边 = 50
    宽度 = 344
    高度 = 194
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “毛纱管理系统注册窗口”
    帮助文件名 = “”

窗口 窗口_备份_进度条
    左边 = 50
    顶边 = 50
    宽度 = 224
    高度 = 48
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 登录窗口2
    左边 = 50
    顶边 = 50
    宽度 = 515
    高度 = 351
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “系统登录”
    帮助文件名 = “”



.图片 出库_表头模版, " ' 已保存到：D:\易语言学习\Data\毛纱管理系统V0.01.e\出库_表头模版", , 
.图片 出库_表中模板_竖向, " ' 已保存到：D:\易语言学习\Data\毛纱管理系统V0.01.e\出库_表中模板_竖向", , 
.图片 出库_表尾模板, " ' 已保存到：D:\易语言学习\Data\毛纱管理系统V0.01.e\出库_表尾模板", , 
.图片 图片组, " ' 已保存到：D:\易语言学习\Data\毛纱管理系统V0.01.e\图片组", , 
.常量 常量_入库表, "“入库表”", , 入库的数据表常量
.常量 常量_出库表, "“出库表”", , 出库的数据表常量
.常量 常量_快递公司表, "“快递公司表”", , 快递公司的数据表常量
.常量 常量_操作员表, "“操作员表”", , 操作员的数据表常量
.常量 常量_客户表, "“客户表”", , 客户的数据表常量
.常量 常量_供应商表, "“供应商表”", , 供应商的数据表常量
.常量 常量_列表项表, "“列表项表”", , 
.常量 , , , 
.常量 提示文字, "“■申广科技■提示：”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 2 0 扩展界面支持库二
 ' ExtMenu 9909FBB013704cfa8FE7E739DB7172DE 2 0 超级菜单支持库
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 2 6 高级表格支持库
 ' spec A512548E76954B6E92C21055517615B0 3 0 特殊功能支持库
 ' EChartBar 9A3F84D7FDEB4a0486F2711D5104B7F7 2 0 数据图表支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 3 0 应用接口支持库
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 2 0 XP风格界面库




数据类型 总量数据类型, , 
    .成员 币种, 文本型, , , 
    .成员 称量, 文本型, , , 
    .成员 总数量, 小数型, , , 
    .成员 总金额, 小数型, , , 

.全局变量 登录图路径, 文本型, , , 
.全局变量 互斥体句柄, 整数型, , , 
.全局变量 用户名称, 文本型, , , 
.全局变量 用户密码, 文本型, , , 
.全局变量 用户权限, 文本型, , , 
.全局变量 上次登录时间, 文本型, , , 
.全局变量 这次登录时间, 文本型, , , 
.全局变量 总登录次数, 整数型, , , 
.全局变量 系统目录, 文本型, , , 
.全局变量 数据库目录, 文本型, , , 
.全局变量 匿名全局变量_8322, 空白型, , , 
.全局变量 入库_编辑行号, 整数型, , , 
.全局变量 匿名全局变量_9182, 空白型, , , 
.全局变量 出库_编辑行号, 整数型, , , 
.全局变量 匿名全局变量_9188, 空白型, , , 
.全局变量 供应商_编辑行号, 整数型, , , 
.全局变量 匿名全局变量_9190, 空白型, , , 
.全局变量 客户_编辑行号, 整数型, , , 
.全局变量 匿名全局变量_9185, 空白型, , , 
.全局变量 快递公司_编辑行号, 整数型, , , 
.全局变量 匿名全局变量_9186, 空白型, , , 
.全局变量 操作员_编辑行号, 整数型, , , 
.全局变量 匿名全局变量_7486, 空白型, , , 
.全局变量 菜单_毛纱入库录入_禁止, 逻辑型, , , 菜单与登录用户的权限有关
.全局变量 菜单_毛纱出库录入_禁止, 逻辑型, , , 
.全局变量 匿名全局变量_8014, 空白型, , , 
.全局变量 菜单_毛纱入库查询_禁止, 逻辑型, , , 
.全局变量 菜单_毛纱出库查询_禁止, 逻辑型, , , 
.全局变量 匿名全局变量_8016, 空白型, , , 
.全局变量 菜单_毛纱入库统计_禁止, 逻辑型, , , 
.全局变量 菜单_毛纱出库统计_禁止, 逻辑型, , , 
.全局变量 匿名全局变量_8017, 空白型, , , 
.全局变量 菜单_系统配置_禁止, 逻辑型, , , 
.全局变量 匿名全局变量_8018, 空白型, , , 
.全局变量 菜单_操作员管理_禁止, 逻辑型, , , 
.全局变量 菜单_供应商的管理_禁止, 逻辑型, , , 
.全局变量 菜单_客户数据管理_禁止, 逻辑型, , , 
.全局变量 菜单_快递公司管理_禁止, 逻辑型, , , 
.全局变量 匿名全局变量_7513, 空白型, , , 
.全局变量 工具条_毛纱入库录入_禁止, 整数型, , , 
.全局变量 工具条_毛纱出库录入_禁止, 整数型, , , 
.全局变量 匿名全局变量_8012, 空白型, , , 
.全局变量 工具条_毛纱入库查询_禁止, 整数型, , , 
.全局变量 工具条_毛纱出库查询_禁止, 整数型, , , 
.全局变量 匿名全局变量_8013, 空白型, , , 
.全局变量 工具条_毛纱入库统计_禁止, 整数型, , , 
.全局变量 工具条_毛纱出库统计_禁止, 整数型, , , 
.全局变量 匿名全局变量_8019, 空白型, , , 
.全局变量 匿名全局变量_8002, 空白型, , , 
.全局变量 匿名全局变量_8001, 空白型, , , 
.全局变量 硬盘特征字, 整数型, , , 
.全局变量 重复取硬盘特征字次数, 整数型, , , 
.全局变量 注册用户, 文本型, , , 
.全局变量 注册码, 文本型, , , 
.全局变量 匿名全局变量_7992, 空白型, , , 
.全局变量 已登录, 文本型, , , 用来限制某用户不重复登录
.全局变量 未登录, 逻辑型, , , 于于登录和注销窗口的判断
.全局变量 超级列表框标题, 文本型, , , 
.全局变量 界面风格, 文本型, , , 
.全局变量 窗口动画有无, 文本型, , , 

.DLL命令 CreateEvent, 整数型, "", "CreateEventA", , 创建事件同步对象
    .参数 lpEventAttributes, 整数型, , 
    .参数 bManualReset, 逻辑型, , 
    .参数 bInitialState, 逻辑型, , 
    .参数 lpName, 文本型, , 

.DLL命令 CloseHandle, 整数型, "", "CloseHandle", , 关闭同步事件对象
    .参数 hObject, 整数型, , 

.DLL命令 OpenEvent, 整数型, "", "OpenEventA", , 打开事件同步对象
    .参数 dwDesiredAccess, 整数型, , 
    .参数 bInheritHandle, 逻辑型, , 
    .参数 lpName, 文本型, , 

.窗口程序集 启动窗口程序集, , , 

.程序集变量 临时字体名称, 文本型, , "10", 
.程序集变量 临时字体大小, 文本型, , "10", 
.子程序 _毛纱数据操作分类按钮1_被单击, 空白型, , 
 ' --========  易语言资源网  (www.wodesoft.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.wodesoft.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.wodesoft.com  ================--

赋值 (.现行子夹, 0)
 ' ***************************************
 ' 主菜单切换
 ' ***************************************

.子程序 _毛纱数据统计分类按钮1_被单击, 空白型, , 
赋值 (.现行子夹, 1)

.子程序 _毛纱系统管理分类按钮1_被单击, 空白型, , 
赋值 (.现行子夹, 2)

.子程序 _毛纱数据操作分类按钮2_被单击, 空白型, , 
赋值 (.现行子夹, 0)

.子程序 _毛纱数据统计分类按钮2_被单击, 空白型, , 
赋值 (.现行子夹, 1)

.子程序 _毛纱系统管理分类按钮2_被单击, 空白型, , 
赋值 (.现行子夹, 2)

.子程序 _毛纱数据操作分类按钮3_被单击, 空白型, , 
赋值 (.现行子夹, 0)

.子程序 _毛纱数据统计分类按钮3_被单击, 空白型, , 
赋值 (.现行子夹, 1)

.子程序 _毛纱系统管理分类按钮按钮3_被单击, 空白型, , 
赋值 (.现行子夹, 2)
 ' 本源码来自易语言资源网(www.wodesoft.com)
 ' ---------------------------------------------------------------------------------------------
 ' *****************************
 ' 关于模块
 ' *****************************

.子程序 _关于按钮_被单击, 空白型, , 
载入 (关于窗口, , 真) ' 显示关于窗口
 ' *****************************
 ' 退出系统模块
 ' *****************************
 ' ---------------------------------------------------------------------------------------------

.子程序 _退出按钮_被单击, 空白型, , 
.如果真 (等于 (信息框 (“你是否确定要退出本系统？”, 1, #提示文字), 0))
    .如果真 (等于 (窗口动画有无, “1”))
        动画显隐窗口 (_启动窗口, 假)
    .如果真结束
    
    更新登录情况 (用户名称)
    按日期自动备份 ()
    结束 ()
.如果真结束

 ' ---------------------------------------------------------------------------------------------


.子程序 __启动窗口_可否被关闭, 逻辑型, , 

.判断开始 (等于 (信息框 (“你是否确定要退出本系统？”, 1, #提示文字), 0))
    .如果真 (等于 (窗口动画有无, “1”))
        动画显隐窗口 (_启动窗口, 假)
    .如果真结束
    动画显隐窗口 (_启动窗口, 假)
    更新登录情况 (用户名称)
    按日期自动备份 ()
    返回 (真)
.默认
    返回 (假)
.判断结束
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _时钟1_周期事件, 空白型, , 
赋值 (硬盘特征字, 取自己的硬盘特征字 ())
.如果 (不等于 (硬盘特征字, 0))
    赋值 (.时钟周期, 0) ' 如果已经成功，停住时钟。
.否则
    赋值 (重复取硬盘特征字次数, 相减 (重复取硬盘特征字次数, 1))
    .如果真 (等于 (重复取硬盘特征字次数, 0)) ' 如果尝试次数已经已到，则表明失败。
        赋值 (.时钟周期, 0) ' 停住时钟
        赋值 (硬盘特征字, 19731115) ' 由于失败也是一种特征状态，所以可以给一个固定的特征值，用于代表此状态。
    .如果真结束
    
.如果结束


.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 要登录窗口, 文本型, , , 

禁止重复运行 ()
 ' XP风格 (2)
赋值 (系统目录, 取运行目录 ()) ' 得到毛纱管理系统软件的当前运行路径
 ' 检测硬盘特征字 ()
赋值 (未登录, 真)

.判断开始 (等于 (数据库正常与否 (), 真))
    赋值 (要登录窗口, 读配置项 (相加 (系统目录, “\系统配置.ini”), “界面”, “登录窗口”, “1”))
    
    .判断开始 (等于 (要登录窗口, “1”))
        载入 (登录窗口, , 真)
    .默认
        
        载入 (登录窗口2, , 真)
    .判断结束
    
    
    赋值 (未登录, 假)
     ' 窗口动画有无 ＝ 读配置项 (系统目录 ＋ “\系统配置.ini”, “界面”, “窗口动画”, “1”)
    .如果真 (等于 (窗口动画有无, “1”))
        动画显隐窗口 (_启动窗口, 真)
    .如果真结束
    
    
     ' ----------------------------------------------
    0.置文本 (多项选择 (到整数 (用户权限), “系统管理员”, “普通管理员”, “来宾管理员”))
    1.置文本 (用户名称) ' 状态条上的当前操作员：
    4.置文本 (取当前日期文本 (1, “”)) ' 状态条上的当前日期：
    7.置文本 (相加 (“上次登录时间：”, 上次登录时间))
    8.置文本 (相加 (“已登录”, 到文本 (相加 (总登录次数, 1)), “次”)) ' 状态条上的总登录次数
    
    赋值 (入库_编辑行号, 1) ' 设置高级表格_出库编辑行号初值
    赋值 (出库_编辑行号, 1) ' 设置高级表格_入库编辑行号初值
    赋值 (操作员_编辑行号, 1) ' 设置高级表格_操作员编辑行号初值
    
.默认
    结束 ()
.判断结束



.子程序 _毛纱入库录入_被选择, 空白型, , 
_毛纱入库录入按钮_被单击 ()

.子程序 _毛纱出库录入_被选择, 空白型, , 
_毛纱出库录入按钮_被单击 ()

.子程序 _毛纱入库查询_被选择, 空白型, , 
_毛纱入库查询按钮_被单击 ()

.子程序 _毛纱出库查询_被选择, 空白型, , 
_毛纱出库查询按钮_被单击 ()

.子程序 _毛纱入库统计_被选择, 空白型, , 
_毛纱入库统计按钮_被单击 ()

.子程序 _毛纱出库统计_被选择, 空白型, , 
_毛纱出库统计按钮_被单击 ()

.子程序 _系统配置_被选择, 空白型, , 
_系统配置按钮_被单击 ()

.子程序 _操作员管理_被选择, 空白型, , 
_操作员管理按钮_被单击 ()

.子程序 _供应商的管理_被选择, 空白型, , 
_供应商管理按钮_被单击 ()

.子程序 _客户数据管理_被选择, 空白型, , 
_客户数据管理按钮_被单击 ()

.子程序 _快递公司管理_被选择, 空白型, , 
_快递公司管理按钮_被单击 ()

.子程序 _帮助_被选择, 空白型, , 


.子程序 _关于_被选择, 空白型, , 
_关于按钮_被单击 ()

.子程序 _注销_被选择, 空白型, , 
_注销按钮_被单击 ()

.子程序 _退出_被选择, 空白型, , 
_退出按钮_被单击 ()

.子程序 _工具条_主界面_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 



.判断开始 (等于 (按钮索引.取标题 (), “退出”))
    _退出按钮_被单击 ()
.默认
    .判断开始 (等于 (按钮索引.取标题 (), “关于”))
        _关于按钮_被单击 ()
    .默认
        .判断开始 (等于 (按钮索引.取标题 (), “注销”))
            _注销按钮_被单击 ()
        .默认
            .判断开始 (等于 (按钮索引.取标题 (), “毛纱出库统计”))
                _毛纱出库统计按钮_被单击 ()
            .默认
                .判断开始 (等于 (按钮索引.取标题 (), “毛纱入库统计”))
                    _毛纱入库统计按钮_被单击 ()
                .默认
                    .判断开始 (等于 (按钮索引.取标题 (), “毛纱出库查询”))
                        _毛纱出库查询按钮_被单击 ()
                    .默认
                        .判断开始 (等于 (按钮索引.取标题 (), “毛纱入库查询”))
                            _毛纱入库查询按钮_被单击 ()
                        .默认
                            .判断开始 (等于 (按钮索引.取标题 (), “毛纱出库录入”))
                                _毛纱出库录入按钮_被单击 ()
                            .默认
                                .判断开始 (等于 (按钮索引.取标题 (), “毛纱入库录入”))
                                    _毛纱入库录入按钮_被单击 ()
                                .默认
                                    
                                .判断结束
                                
                            .判断结束
                            
                        .判断结束
                        
                    .判断结束
                    
                .判断结束
                
            .判断结束
            
        .判断结束
        
    .判断结束
    
.判断结束
 ' ********************************************************
 ' 入库操作模块
 ' ********************************************************


.子程序 _毛纱入库录入按钮_被单击, 空白型, , 
赋值 (.现行子夹, 1) ' 切换到毛纱入库录入界面


设置默认入库高级表格格式 ()
显示所有入库数据 (_启动窗口., “”)
高级表格字体初始化 (“高级表格_入库字体”, )

赋值 (出库_编辑行号, _启动窗口.未知支持库函数_3 (.))

赋值 (.内容, 取当前日期文本 (2, “.”))

赋值 (.左边, 174)
赋值 (.顶边, 30)

赋值 (.左边, 44)
赋值 (.顶边, 32)

清空 ()
得到供应商选择列表框项目 ()

 ' --------------------------------------------------------------------------

.子程序 _编辑框_日期_入库_获得焦点, 空白型, , 
赋值 (.可视, 真) ' 显示月历窗口

 ' 入库_编辑列号 ＝ 0
高级表格_日期_入库_内容被改变 ()

.子程序 _编辑框_入库供应商_获得焦点, 空白型, , 
赋值 (.可视, 真) ' 显示供应商的列表
 ' 入库_编辑列号 ＝ 1
高级表格_供应商_内容被改变 ()

.子程序 _编辑框_公司订单号_获得焦点, 空白型, , 
 ' 入库_编辑列号 ＝ 2
高级表格_公司订单号_内容被改变 ()

.子程序 _编辑框_纱号_入库_获得焦点, 空白型, , 
 ' 入库_编辑列号 ＝ 3
高级表格_纱号_入库_内容被改变 ()

.子程序 _编辑框_支数_入库_获得焦点, 空白型, , 
 ' 入库_编辑列号 ＝ 4
高级表格_支数_入库_内容被改变 ()

.子程序 _编辑框_成份_入库_获得焦点, 空白型, , 
 ' 入库_编辑列号 ＝ 5
高级表格_成份_入库_内容被改变 ()

.子程序 _编辑框_颜色_入库_获得焦点, 空白型, , 
 ' 入库_编辑列号 ＝ 6
高级表格_颜色_入库_内容被改变 ()

.子程序 _编辑框_入库单号_获得焦点, 空白型, , 
 ' 入库_编辑列号 ＝ 7
高级表格_入库单号_内容被改变 ()


.子程序 _编辑框_进价_获得焦点, 空白型, , 
 ' 入库_编辑列号 ＝ 8
高级表格_进价_内容被改变 ()


.子程序 _组合框_进价_币种_获得焦点, 空白型, , 
 ' 入库_编辑列号 ＝ 9
高级表格_进价币种_内容被改变 ()

.子程序 _编辑框_入库数量_获得焦点, 空白型, , 
 ' 入库_编辑列号 ＝ 10
高级表格_入库数量_内容被改变 ()

.子程序 _组合框_入库数量_单位_获得焦点, 空白型, , 
 ' 入库_编辑列号 ＝ 11
高级表格_入库称量_内容被改变 ()

.子程序 _编辑框_入库_备注_获得焦点, 空白型, , 
 ' 入库_编辑列号 ＝ 12
高级表格_备注_内容被改变 ()

 ' ------------------------------------------------------------------

.子程序 _编辑框_日期_入库_内容被改变, 空白型, , 
高级表格_日期_入库_内容被改变 ()

.子程序 _编辑框_入库供应商_内容被改变, 空白型, , 
高级表格_供应商_内容被改变 ()

.子程序 _编辑框_公司订单号_内容被改变, 空白型, , 
高级表格_公司订单号_内容被改变 ()

.子程序 _编辑框_纱号_入库_内容被改变, 空白型, , 
高级表格_纱号_入库_内容被改变 ()

.子程序 _编辑框_支数_入库_内容被改变, 空白型, , 
高级表格_支数_入库_内容被改变 ()

.子程序 _编辑框_成份_入库_内容被改变, 空白型, , 
高级表格_成份_入库_内容被改变 ()

.子程序 _编辑框_颜色_入库_内容被改变, 空白型, , 
高级表格_颜色_入库_内容被改变 ()

.子程序 _编辑框_入库单号_内容被改变, 空白型, , 
高级表格_入库单号_内容被改变 ()


.子程序 _编辑框_进价_内容被改变, 空白型, , 
高级表格_进价_内容被改变 ()

.子程序 _组合框_进价_币种_编辑内容被改变, 空白型, , 
.判断开始 (或者 (不等于 (.内容, “RMB”), 不等于 (.内容, “USD”)))
    信息框 (“货币单位必须为RMB或USD!”, 64, #提示文字)
    赋值 (.内容, “RMB”)
    赋值 (.内容, “KG”)
    获取焦点 ()
.默认
    
    高级表格_进价币种_内容被改变 ()
.判断结束



.子程序 _编辑框_入库数量_内容被改变, 空白型, , 
高级表格_入库数量_内容被改变 ()

.子程序 _组合框_入库数量_单位_编辑内容被改变, 空白型, , 
.判断开始 (或者 (不等于 (.内容, “KG”), 不等于 (.内容, “LB”)))
    
    信息框 (“数量单位必须为KG或LB!”, 64, #提示文字)
    
    赋值 (.内容, “KG”)
    赋值 (.内容, “RMB”)
    
    获取焦点 ()
    
    
.默认
    高级表格_入库称量_内容被改变 ()
.判断结束


.子程序 _组合框_进价_币种_列表项被选择, 空白型, , 
赋值 (.现行选中项, .现行选中项)
高级表格_进价币种_内容被改变 ()
高级表格_入库称量_内容被改变 ()

.子程序 _组合框_入库数量_单位_列表项被选择, 空白型, , 
赋值 (.现行选中项, .现行选中项)
高级表格_入库称量_内容被改变 ()
高级表格_进价币种_内容被改变 ()

.子程序 _编辑框_入库_备注_内容被改变, 空白型, , 
高级表格_备注_内容被改变 ()
 ' ----------------------------------------------------------------------

.子程序 _编辑框_日期_入库_失去焦点, 空白型, , 
赋值 (.可视, 假) ' 隐藏月历窗口
高级表格_日期_入库_内容被改变 ()

.子程序 _编辑框_入库供应商_失去焦点, 空白型, , 
赋值 (.可视, 假) ' 隐藏供应商的列表


.子程序 _月历_入库_选择日期被改变, 空白型, , 
赋值 (.内容, 取月历文本 (.首选择日))

.子程序 _选择列表框_供应商_列表项被选择, 空白型, , 
赋值 (.内容, .取项目文本 (.现行选中项))
 ' ------------------------------------------------------------------------------


.子程序 _编辑框_日期_入库_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_入库供应商_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_公司订单号_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_纱号_入库_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_支数_入库_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_成份_入库_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_颜色_入库_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_入库单号_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_进价_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _组合框_进价_币种_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_入库数量_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _组合框_入库数量_单位_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_入库_备注_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _超级按钮_保存入库数据_被单击 ()
.如果真结束

 ' ------------------------------------------------------------------------------


.子程序 _高级表格_入库_光标位置改变, 空白型, , 
.局部变量 临时编号, 文本型, , , 

 ' 调试输出 (“行：” ＋ 到文本 (高级表格_入库.取光标行号 ()) ＋ “，列：” ＋ 到文本 (高级表格_入库.取光标列号 ()))
赋值 (入库_编辑行号, 未知支持库函数_3 ())
 ' 入库_编辑列号 ＝ 高级表格_入库.取光标列号 ()
赋值 (临时编号, 删首尾空 (入库_编辑行号.未知支持库函数_10 (7))) ' 得到入库单号

通过入库单号得到当前其它数据 (_启动窗口., 临时编号)


 ' ------------------------------------------------------------------------------

.子程序 _高级表格_入库_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, 46)) ' DEL键
    _超级按钮_删除_入库输入_被单击 ()
.如果真结束


.子程序 _超级按钮_返回主界面_入库_被单击, 空白型, , 
赋值 (.现行子夹, 0) ' 切换到主界面


.子程序 _超级按钮_打印预览_入库_被单击, 空白型, , 
未知支持库函数_27 ()

.子程序 _超级按钮_打印_入库_被单击, 空白型, , 
未知支持库函数_26 ()

.子程序 _超级按钮_载入表单_被单击, 空白型, , 
赋值 (.类型, 0)
赋值 (.过滤器, “表单文件(*.egd)|*.egd”)
赋值 (.初始目录, 相加 (系统目录, “\表单\入库”))
.如果真 (打开 ())
    .如果真 (等于 (.未知支持库函数_56 (.文件名), 假))
        信息框 (“读取失败！”, 64, #提示文字)
    .如果真结束
    显示所有入库数据 (_启动窗口., “”)
.如果真结束


.子程序 _超级按钮_保存表单_被单击, 空白型, , 
赋值 (.类型, 1)
赋值 (.过滤器, “表单文件(*.egd)|*.egd”)
赋值 (.初始目录, 相加 (系统目录, “\表单\入库”))

.如果真 (打开 ())
    .如果 (等于 (相加 (.文件名, “.egd”).未知支持库函数_55 (), 真))
        信息框 (“表单文件保存成功!”, 64, #提示文字)
    .否则
        信息框 (“表单文件保存失败!”, 64, #提示文字)
    .如果结束
    
.如果真结束


.子程序 _超级按钮_恢复默认表单_被单击, 空白型, , 
设置默认入库高级表格格式 ()
显示所有入库数据 (_启动窗口., “”)
高级表格字体初始化 (“高级表格_入库字体”, )

.子程序 _超级按钮_保存入库数据_被单击, 空白型, , 

高级表格_入库_内容被改变 ()
获取焦点 ()
保存入库数据到数据库 ()
高级表格字体初始化 (“高级表格_入库字体”, )

.子程序 _超级按钮_删除_入库输入_被单击, 空白型, , 
删除当前记录_入库 ()

 ' ************************
 ' 毛纱出库录入模块
 ' ************************
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _毛纱出库录入按钮_被单击, 空白型, , 
赋值 (_启动窗口..现行子夹, 2) ' 切换到毛纱出库录入界面

设置默认出库高级表格格式 ()
显示所有出库数据 (_启动窗口.)
高级表格字体初始化 (“高级表格_出库字体”, )
赋值 (_启动窗口.., 真)

赋值 (入库_编辑行号, _启动窗口.未知支持库函数_3 (.))

赋值 (_启动窗口..内容, 取当前日期文本 (2, “.”))
赋值 (_启动窗口..内容, 生成装箱单编号 ())

赋值 (.左边, 524)
赋值 (.顶边, 155)

赋值 (.左边, 272)
赋值 (.顶边, 30)

赋值 (.左边, 51)
赋值 (.顶边, 74)

清空 ()
得到客户选择列表框项目 ()
清空 ()
得到快递公司选择列表框项目 ()
 ' ------------------------------------------------------------------------

.子程序 _超级按钮_返回主界面_出库_被单击, 空白型, , 
赋值 (_启动窗口..现行子夹, 0) ' 切换到封面界面


.子程序 _超级按钮_生成装箱单_被单击, 空白型, , 
载入 (窗口_生成装箱单, _启动窗口, 真)


.子程序 _编辑框_日期_出库_失去焦点, 空白型, , 
赋值 (.可视, 假) ' 隐藏月历窗口
生成出库金额 () ' 得到出库金额并显示在编辑框金额中


.子程序 _月历_出库_选择日期被改变, 空白型, , 
赋值 (.内容, 取月历文本 (.首选择日))


.子程序 _编辑框_公司客户_失去焦点, 空白型, , 
赋值 (.可视, 假) ' 隐藏客户列表
生成出库金额 ()

.子程序 _选择列表框_客户_列表项被选择, 空白型, , 
赋值 (.内容, .取项目文本 (.现行选中项))


.子程序 _编辑框_快递公司_失去焦点, 空白型, , 
赋值 (.可视, 假) ' 隐藏快递公司列表
生成出库金额 ()

.子程序 _选择列表框_快递公司_列表项被选择, 空白型, , 
赋值 (.内容, .取项目文本 (.现行选中项))


.子程序 _编辑框_出库数量_失去焦点, 空白型, , 
生成出库金额 ()


.子程序 _组合框_出库数量_称量_失去焦点, 空白型, , 
生成出库金额 ()


.子程序 _组合框_金额_币种_失去焦点, 空白型, , 
生成出库金额 ()

.子程序 _编辑框_日期_出库_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_编号_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_公司客户_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_经手人_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_客户订单号_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_纱号_出库_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_支数_出库_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_成份_出库_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_色号_出库_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_颜色_出库_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_缸号_出库_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_单价_出库_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _组合框_单价_币种_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_出库数量_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _组合框_出库数量_称量_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束



.子程序 _编辑框_金额_出库_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _组合框_金额_币种_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_快递公司_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_快递单号_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_件数_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_运费_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _组合框_运费_币种_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_出库单号_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _超级按钮_保存出库数据_被单击 ()
.如果真结束


.子程序 _编辑框_编号_失去焦点, 空白型, , 
生成出库金额 ()

.子程序 _编辑框_经手人_失去焦点, 空白型, , 
生成出库金额 ()

.子程序 _编辑框_客户订单号_失去焦点, 空白型, , 
生成出库金额 ()

.子程序 _编辑框_纱号_出库_失去焦点, 空白型, , 
生成出库金额 ()

.子程序 _编辑框_支数_出库_失去焦点, 空白型, , 
生成出库金额 ()

.子程序 _编辑框_成份_出库_失去焦点, 空白型, , 
生成出库金额 ()


.子程序 _编辑框_色号_出库_失去焦点, 空白型, , 
生成出库金额 ()


.子程序 _编辑框_颜色_出库_失去焦点, 空白型, , 
生成出库金额 ()


.子程序 _编辑框_单价_出库_失去焦点, 空白型, , 
生成出库金额 ()

.子程序 _组合框_单价_币种_失去焦点, 空白型, , 
生成出库金额 ()

.子程序 _编辑框_缸号_出库_失去焦点, 空白型, , 
生成出库金额 ()

.子程序 _编辑框_快递单号_失去焦点, 空白型, , 
生成出库金额 ()

.子程序 _编辑框_件数_失去焦点, 空白型, , 
生成出库金额 ()

.子程序 _编辑框_运费_失去焦点, 空白型, , 
生成出库金额 ()


.子程序 _组合框_运费_币种_失去焦点, 空白型, , 
生成出库金额 ()

.子程序 _编辑框_出库单号_失去焦点, 空白型, , 
生成出库金额 ()
 ' --------------------------------------------------------------------------------



.子程序 _编辑框_日期_出库_内容被改变, 空白型, , 
高级表格_日期_出库_内容被改变 ()

.子程序 _编辑框_编号_内容被改变, 空白型, , 
高级表格_编号_内容被改变 ()

.子程序 _编辑框_公司客户_内容被改变, 空白型, , 
高级表格_公司客户_内容被改变 ()

.子程序 _编辑框_经手人_内容被改变, 空白型, , 
高级表格_经手人_内容被改变 ()

.子程序 _编辑框_客户订单号_内容被改变, 空白型, , 
高级表格_客户订单号_内容被改变 ()

.子程序 _编辑框_纱号_出库_内容被改变, 空白型, , 
高级表格_纱号_出库_内容被改变 ()

.子程序 _编辑框_支数_出库_内容被改变, 空白型, , 
高级表格_支数_出库_内容被改变 ()

.子程序 _编辑框_成份_出库_内容被改变, 空白型, , 
高级表格_成份_出库_内容被改变 ()

.子程序 _编辑框_色号_出库_内容被改变, 空白型, , 
高级表格_色号_出库_内容被改变 ()

.子程序 _编辑框_颜色_出库_内容被改变, 空白型, , 
高级表格_颜色_出库_内容被改变 ()

.子程序 _编辑框_缸号_出库_内容被改变, 空白型, , 
高级表格_缸号_出库_内容被改变 ()

.子程序 _编辑框_单价_出库_内容被改变, 空白型, , 
高级表格_单价_出库_内容被改变 ()


.子程序 _组合框_单价_币种_编辑内容被改变, 空白型, , 
.判断开始 (或者 (不等于 (.内容, “RMB”), 不等于 (.内容, “USD”)))
    信息框 (“货币单位必须为RMB或USD!”, 64, #提示文字)
    赋值 (.内容, “RMB”)
    赋值 (.内容, “RMB”)
    赋值 (.内容, “KG”)
    赋值 (.内容, “RMB”)
    获取焦点 ()
.默认
    
    高级表格_单价_币种_内容被改变 ()
.判断结束


.子程序 _编辑框_出库数量_内容被改变, 空白型, , 
高级表格_出库数量_内容被改变 ()


.子程序 _组合框_出库数量_称量_编辑内容被改变, 空白型, , 
.判断开始 (或者 (不等于 (.内容, “KG”), 不等于 (.内容, “LB”)))
    信息框 (“数量单位必须为KG或LB!”, 64, #提示文字)
    赋值 (.内容, “RMB”)
    赋值 (.内容, “RMB”)
    赋值 (.内容, “KG”)
    赋值 (.内容, “RMB”)
    获取焦点 ()
.默认
    
    高级表格_出库数量_称量_内容被改变 ()
.判断结束


.子程序 _编辑框_金额_出库_内容被改变, 空白型, , 
高级表格_金额_出库_内容被改变 ()


.子程序 _组合框_金额_币种_编辑内容被改变, 空白型, , 
.判断开始 (或者 (不等于 (.内容, “RMB”), 不等于 (.内容, “USD”)))
    信息框 (“货币单位必须为RMB或USD!”, 64, #提示文字)
    赋值 (.内容, “RMB”)
    赋值 (.内容, “RMB”)
    赋值 (.内容, “KG”)
    赋值 (.内容, “RMB”)
    获取焦点 ()
.默认
    
    高级表格_金额_币种_内容被改变 ()
.判断结束


.子程序 _编辑框_快递公司_内容被改变, 空白型, , 
高级表格_快递公司_内容被改变 ()

.子程序 _编辑框_快递单号_内容被改变, 空白型, , 
高级表格_快递单号_内容被改变 ()

.子程序 _编辑框_件数_内容被改变, 空白型, , 
高级表格_件数_内容被改变 ()

.子程序 _编辑框_运费_内容被改变, 空白型, , 
高级表格_运费_内容被改变 ()


.子程序 _组合框_运费_币种_编辑内容被改变, 空白型, , 
.判断开始 (或者 (不等于 (.内容, “RMB”), 不等于 (.内容, “USD”)))
    信息框 (“货币单位必须为RMB或USD!”, 64, #提示文字)
    赋值 (.内容, “RMB”)
    赋值 (.内容, “RMB”)
    赋值 (.内容, “KG”)
    赋值 (.内容, “RMB”)
    获取焦点 ()
.默认
    
    高级表格_运费_币种_内容被改变 ()
.判断结束


.子程序 _编辑框_出库单号_内容被改变, 空白型, , 
高级表格_出库单号_内容被改变 ()




 ' --------------------------------------------------------------

.子程序 _组合框_单价_币种_列表项被选择, 空白型, , 
赋值 (.现行选中项, .现行选中项)
赋值 (.现行选中项, .现行选中项)
赋值 (.现行选中项, .现行选中项)
高级表格_单价_出库_内容被改变 ()
高级表格_出库数量_称量_内容被改变 ()
高级表格_金额_币种_内容被改变 ()
高级表格_运费_币种_内容被改变 ()

.子程序 _组合框_出库数量_称量_列表项被选择, 空白型, , 
赋值 (.现行选中项, .现行选中项)
赋值 (.现行选中项, .现行选中项)
赋值 (.现行选中项, .现行选中项)
高级表格_单价_出库_内容被改变 ()
高级表格_出库数量_称量_内容被改变 ()
高级表格_金额_币种_内容被改变 ()
高级表格_运费_币种_内容被改变 ()


.子程序 _组合框_金额_币种_列表项被选择, 空白型, , 
赋值 (.现行选中项, .现行选中项)
赋值 (.现行选中项, .现行选中项)
赋值 (.现行选中项, .现行选中项)
高级表格_单价_出库_内容被改变 ()
高级表格_出库数量_称量_内容被改变 ()
高级表格_金额_币种_内容被改变 ()
高级表格_运费_币种_内容被改变 ()


.子程序 _组合框_运费_币种_列表项被选择, 空白型, , 
赋值 (.现行选中项, .现行选中项)
赋值 (.现行选中项, .现行选中项)
赋值 (.现行选中项, .现行选中项)
高级表格_单价_出库_内容被改变 ()
高级表格_出库数量_称量_内容被改变 ()
高级表格_金额_币种_内容被改变 ()
高级表格_运费_币种_内容被改变 ()


 ' --------------------------------------------------------------


.子程序 _编辑框_日期_出库_获得焦点, 空白型, , 

赋值 (_启动窗口..内容, 取当前日期文本 (2, “.”))

赋值 (.可视, 真) ' 显示月历窗口
赋值 (., 真) ' 显示高级表格_出库


高级表格_日期_出库_内容被改变 () ' 在显示高级表格_出库中显示日期内容

.子程序 _编辑框_编号_获得焦点, 空白型, , 
赋值 (_启动窗口..内容, 生成装箱单编号 ())
赋值 (., 真)
高级表格_编号_内容被改变 ()


.子程序 _编辑框_公司客户_获得焦点, 空白型, , 

赋值 (.可视, 真) ' 显示客户列表
赋值 (., 真)

高级表格_编号_内容被改变 ()
高级表格_公司客户_内容被改变 ()

.子程序 _编辑框_经手人_获得焦点, 空白型, , 
赋值 (., 真)
高级表格_经手人_内容被改变 ()

.子程序 _编辑框_客户订单号_获得焦点, 空白型, , 
赋值 (., 真)

高级表格_客户订单号_内容被改变 ()

.子程序 _编辑框_纱号_出库_获得焦点, 空白型, , 
赋值 (., 真)

高级表格_纱号_出库_内容被改变 ()

.子程序 _编辑框_支数_出库_获得焦点, 空白型, , 
赋值 (., 真)

高级表格_支数_出库_内容被改变 ()

.子程序 _编辑框_成份_出库_获得焦点, 空白型, , 
赋值 (., 真)

高级表格_成份_出库_内容被改变 ()

.子程序 _编辑框_色号_出库_获得焦点, 空白型, , 
赋值 (., 真)

高级表格_色号_出库_内容被改变 ()


.子程序 _编辑框_颜色_出库_获得焦点, 空白型, , 
赋值 (., 真)

高级表格_颜色_出库_内容被改变 ()

.子程序 _编辑框_缸号_出库_获得焦点, 空白型, , 
赋值 (., 真)

高级表格_缸号_出库_内容被改变 ()

.子程序 _编辑框_单价_出库_获得焦点, 空白型, , 
赋值 (., 真)

高级表格_单价_出库_内容被改变 ()

.子程序 _组合框_单价_币种_获得焦点, 空白型, , 
赋值 (., 真)

高级表格_单价_币种_内容被改变 ()


.子程序 _编辑框_出库数量_获得焦点, 空白型, , 
赋值 (., 真)

高级表格_出库数量_内容被改变 ()

.子程序 _组合框_出库数量_称量_获得焦点, 空白型, , 
赋值 (., 真)

高级表格_出库数量_称量_内容被改变 ()


.子程序 _编辑框_金额_出库_获得焦点, 空白型, , 
赋值 (., 真)

高级表格_金额_出库_内容被改变 ()

.子程序 _组合框_金额_币种_获得焦点, 空白型, , 
赋值 (., 真)

高级表格_金额_币种_内容被改变 ()


.子程序 _编辑框_快递公司_获得焦点, 空白型, , 

赋值 (.可视, 真) ' 显示快递公司列表
赋值 (., 真)
高级表格_快递公司_内容被改变 ()

.子程序 _编辑框_快递单号_获得焦点, 空白型, , 
赋值 (., 真)

高级表格_快递单号_内容被改变 ()

.子程序 _编辑框_件数_获得焦点, 空白型, , 
赋值 (., 真)

高级表格_件数_内容被改变 ()


.子程序 _编辑框_运费_获得焦点, 空白型, , 
赋值 (., 真)

高级表格_运费_内容被改变 ()

.子程序 _组合框_运费_币种_获得焦点, 空白型, , 
赋值 (., 真)

高级表格_运费_币种_内容被改变 ()

.子程序 _编辑框_出库单号_获得焦点, 空白型, , 
赋值 (., 真)

高级表格_出库单号_内容被改变 ()
 ' -------------------------------------------------------


.子程序 _表格_出库_失去焦点, 空白型, , 
赋值 (., 真)
 ' -------------------------------------------------------

.子程序 _高级表格_出库_光标位置改变, 空白型, , 
.局部变量 临时编号, 文本型, , , 

 ' 调试输出 (“行：” ＋ 到文本 (高级表格_出库.取光标行号 ()) ＋ “，列：” ＋ 到文本 (高级表格_出库.取光标列号 ()))
赋值 (出库_编辑行号, 未知支持库函数_3 ())

赋值 (临时编号, 删首尾空 (出库_编辑行号.未知支持库函数_10 (1)))

通过装箱单编号得到当前其它数据 (_启动窗口., 临时编号)



.子程序 _高级表格_出库_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 当前编辑行号, 整数型, , , 
.局部变量 临时编号, 文本型, , , 


.如果真 (等于 (键代码, 46)) ' DEL键
    _超级按钮_删除_出库录入_被单击 ()
.如果真结束


.子程序 _超级按钮_打印装箱单_被单击, 空白型, , 
.局部变量 打印情况, 文本型, , , 

.如果真 (打印设置 ())
    赋值 (打印情况, .打印 ())
    .如果真 (不等于 (打印情况, “”))
        信息框 (打印情况, 0, #提示文字)
    .如果真结束
    
.如果真结束


.子程序 _超级按钮_保存出库数据_被单击, 空白型, , 
高级表格_出库_内容被改变 ()
获取焦点 ()
保存出库数据到数据库 ()
高级表格字体初始化 (“高级表格_出库字体”, )

.子程序 _超级按钮_删除_出库录入_被单击, 空白型, , 
.局部变量 当前编辑行号, 整数型, , , 
.局部变量 临时编号, 文本型, , , 

赋值 (当前编辑行号, 未知支持库函数_3 ())

赋值 (临时编号, 删首尾空 (入库_编辑行号.未知支持库函数_10 (1))) ' 得到装箱单号

.如果真 (小于 (当前编辑行号, 相减 (., 1)))
    .如果真 (删除当前记录 (相加 (“delete from ”, #常量_出库表, “ where 装箱单号='”, 临时编号, “'”), #常量_出库表))
        当前编辑行号.未知支持库函数_36 ()
    .如果真结束
     ' 本源码来自易语言资源网(www.wodesoft.com)
.如果真结束


.子程序 _超级按钮_打印预览装箱单_被单击, 空白型, , 
打印预览 ()

 ' ************************
 ' 入库查询模块
 ' ************************

.子程序 _毛纱入库查询按钮_被单击, 空白型, , 
赋值 (.现行子夹, 3) ' 显示入库查询界面

赋值 (.左边, 32)
赋值 (.顶边, 5)
赋值 (.左边, 109)
赋值 (.顶边, 113)
赋值 (.左边, 336)
赋值 (.顶边, 113)

赋值 (.左边, 32)
赋值 (.顶边, 5)
赋值 (.左边, 185)
赋值 (.顶边, 115)

赋值 (.左边, 32)
赋值 (.顶边, 5)

赋值 (.左边, 32)
赋值 (.顶边, 5)

赋值 (.左边, 6)
赋值 (.顶边, 1)

赋值 (.现行选中项, 0)

清空 ()
得到客户选择列表框项目 ()

按入库日期查询分组框组件可见 ()

设置默认入库高级表格格式 ()


.子程序 _超级按钮_返回主界面_入库_查询_被单击, 空白型, , 
赋值 (.现行子夹, 0) ' 切换到主界面

.子程序 _超级按钮_保存_入库查询结果_被单击, 空白型, , 
赋值 (.过滤器, “表单文件(*.in)|*.in”)
赋值 (.初始目录, 相加 (系统目录, “\表单\入库查询”))

.如果真 (打开 ())
    .如果 (等于 (相加 (.文件名, “.in”).未知支持库函数_55 (), 真))
        信息框 (“查询结果保存成功!”, 64, #提示文字)
    .否则
        信息框 (“查询结果保存失败!”, 64, #提示文字)
    .如果结束
    
.如果真结束


.子程序 _超级按钮_打开_入库查询结果_被单击, 空白型, , 
赋值 (.过滤器, “表单文件(*.in)|*.in”)
赋值 (.初始目录, 相加 (系统目录, “\表单\入库查询”))
.如果真 (打开 ())
    .如果真 (等于 (.未知支持库函数_56 (.文件名), 假))
        信息框 (“读取失败！”, 64, #提示文字)
    .如果真结束
     ' 显示所有入库数据 (外部数据库, _启动窗口.高级表格_入库查询, “”)
.如果真结束


.子程序 _超级按钮_打印预览_入库查询结果_被单击, 空白型, , 
未知支持库函数_27 ()

.子程序 _超级按钮_打印_入库查询结果_被单击, 空白型, , 
未知支持库函数_26 ()
 ' ------------------------------------------------------------------------------

.子程序 _组合框_入库查询方式_列表项被选择, 空白型, , 
.局部变量 临时变量, 整数型, , , 

赋值 (.可视, 假)

赋值 (临时变量, .现行选中项)
 ' 调试输出 (到文本 (临时变量))

.判断开始 (等于 (临时变量, 0))
    按入库日期查询分组框组件可见 ()
.默认
    .判断开始 (等于 (临时变量, 1))
        按供应商查询分组框组件可见 ()
    .默认
        .判断开始 (等于 (临时变量, 2))
            按公司定单号查询分组框组件可见 ()
        .默认
            .判断开始 (等于 (临时变量, 3))
                按入库单号查询分组框组件可见 ()
            .默认
                
                按入库综合查询分组框组件可见 ()
            .判断结束
            
        .判断结束
        
    .判断结束
    
.判断结束


.子程序 按入库日期查询分组框组件可见, 空白型, , 
赋值 (.可视, 真)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.内容, 取当前日期文本 (2, “.”))
赋值 (.内容, .内容)


.子程序 按供应商查询分组框组件可见, 空白型, , 

赋值 (.可视, 假)
得到供应商选择列表框项目 ()

赋值 (.可视, 真)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)



.子程序 按公司定单号查询分组框组件可见, 空白型, , 
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 真)
赋值 (.可视, 假)
赋值 (.可视, 假)



.子程序 按入库单号查询分组框组件可见, 空白型, , 
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 真)
赋值 (.可视, 假)


.子程序 按入库综合查询分组框组件可见, 空白型, , 
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 真)
 ' ------------------------------------------------------------------


.子程序 _月历_入库_查询_起始_选择日期被改变, 空白型, , 
赋值 (.内容, 取月历文本 (.首选择日))


.子程序 _月历_入库_查询_截止_选择日期被改变, 空白型, , 
赋值 (.内容, 取月历文本 (.首选择日))


.子程序 _编辑框_起始日期_入库_获得焦点, 空白型, , 
赋值 (.可视, 真)

.子程序 _编辑框_起始日期_入库_失去焦点, 空白型, , 
赋值 (.可视, 假)


.子程序 _编辑框_起始日期_入库_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_截止日期_入库_获得焦点, 空白型, , 
赋值 (.可视, 真)

.子程序 _编辑框_截止日期_入库_失去焦点, 空白型, , 
赋值 (.可视, 假)
 ' ------------------------------------------------------------------

.子程序 _编辑框_供应商查询_获得焦点, 空白型, , 
赋值 (.可视, 真)

.子程序 _编辑框_供应商查询_失去焦点, 空白型, , 
赋值 (.可视, 假)

.子程序 _选择列表框_供应商查询_列表项被选择, 空白型, , 
赋值 (.内容, .取项目文本 (.现行选中项))

 ' ------------------------------------------------------------------

.子程序 _编辑框_纱号入库查询_失去焦点, 空白型, , 


.如果真 (.选中)
    .如果真 (等于 (删首空 (.内容), “”))
        信息框 (“选中的查询条件纱号不能为空！如果不想要此查询条件，请把前面的勾去掉！”, 0, #提示文字)
        获取焦点 ()
    .如果真结束
    
.如果真结束


.子程序 _编辑框_支数入库查询_失去焦点, 空白型, , 
.如果真 (.选中)
    .如果真 (等于 (删首空 (.内容), “”))
        信息框 (“选中的查询条件支数不能为空！如果不想要此查询条件，请把前面的勾去掉！”, 0, #提示文字)
        获取焦点 ()
    .如果真结束
    
.如果真结束


.子程序 _编辑框_成份入库查询_失去焦点, 空白型, , 
.如果真 (.选中)
    .如果真 (等于 (删首空 (.内容), “”))
        信息框 (“选中的查询条件成份不能为空！如果不想要此查询条件，请把前面的勾去掉！”, 0, #提示文字)
        获取焦点 ()
    .如果真结束
    
.如果真结束


.子程序 _编辑框_颜色入库查询_失去焦点, 空白型, , 
.如果真 (.选中)
    .如果真 (等于 (删首空 (.内容), “”))
        信息框 (“选中的查询条件颜色不能为空！如果不想要此查询条件，请把前面的勾去掉！”, 0, #提示文字)
        获取焦点 ()
    .如果真结束
    
.如果真结束
 ' ------------------------------------------------------------------


.子程序 _高级表格_入库查询_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 (取鼠标水平位置 (), 取鼠标垂直位置 ()) ' 弹出高级表格的字体设置菜单
_字体设置_被选择 ()


.子程序 _超级按钮_开始查询_入库_被单击, 空白型, , 
.局部变量 SQL_查询语句, 文本型, , , 
.局部变量 临时变量, 整数型, , , 
.局部变量 句柄, 整数型, , , 
.局部变量 日期, 文本型, , , 
.局部变量 条件记录总数, 整数型, , , 
.局部变量 累计变量, 整数型, , , 
.局部变量 起始日期, 文本型, , , 
.局部变量 截止日期, 文本型, , , 
.局部变量 SQL_查询条件, 文本型, , , 
.局部变量 日期_日期, 日期时间型, , , 

赋值 (临时变量, .现行选中项)

.判断开始 (等于 (临时变量, 0))
     ' 按日期查询分组框组件可见 ()
    赋值 (起始日期, 子文本替换 (_启动窗口..内容, “.”, “-”, 1, 2, 真))
    赋值 (截止日期, 子文本替换 (_启动窗口..内容, “.”, “-”, 1, 2, 真))
    
    .判断开始 (大于或等于 (到时间 (截止日期), 到时间 (起始日期)))
        赋值 (SQL_查询条件, 相加 (“ where [日期]>=#”, 起始日期, “# and [日期]<=#”, 截止日期, “#”))
    .默认
        
        信息框 (“起始日期不能大于截止日期”, 0, #提示文字)
        获取焦点 ()
        返回 ()
    .判断结束
    
.默认
    .判断开始 (等于 (临时变量, 1))
        赋值 (SQL_查询条件, 相加 (“ where 供应商='”, .内容, “'”))
         ' 按供应商查询分组框组件可见 ()
    .默认
        .判断开始 (等于 (临时变量, 2))
            赋值 (SQL_查询条件, 相加 (“ where 公司定单号='”, .内容, “'”))
             ' 按公司定单号查询分组框组件可见 ()
        .默认
            .判断开始 (等于 (临时变量, 3))
                赋值 (SQL_查询条件, 相加 (“ where 入库单号='”, .内容, “'”))
                 ' 按入库单号查询分组框组件可见 ()
            .默认
                .判断开始 (或者 (.选中, .选中, .选中, .选中))
                    赋值 (SQL_查询条件, “ where”)
                    .如果真 (.选中)
                        赋值 (SQL_查询条件, 相加 (SQL_查询条件, “ 纱号='”, .内容, “'”))
                    .如果真结束
                    
                    .如果真 (.选中)
                        .判断开始 (等于 (.选中, 真))
                            赋值 (SQL_查询条件, 相加 (SQL_查询条件, “ and 支数='”, .内容, “'”))
                        .默认
                            
                            赋值 (SQL_查询条件, 相加 (SQL_查询条件, “ 支数='”, .内容, “'”))
                        .判断结束
                        
                    .如果真结束
                    
                    .如果真 (.选中)
                        .判断开始 (或者 (等于 (.选中, 真), 等于 (.选中, 真)))
                            赋值 (SQL_查询条件, 相加 (SQL_查询条件, “ and 成份='”, .内容, “'”))
                        .默认
                            
                            赋值 (SQL_查询条件, 相加 (SQL_查询条件, “ 成份='”, .内容, “'”))
                        .判断结束
                        
                    .如果真结束
                    
                    .如果真 (.选中)
                        .判断开始 (或者 (等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真)))
                            赋值 (SQL_查询条件, 相加 (SQL_查询条件, “ and 颜色='”, .内容, “'”))
                        .默认
                            
                            赋值 (SQL_查询条件, 相加 (SQL_查询条件, “ 颜色='”, .内容, “'”))
                        .判断结束
                        
                    .如果真结束
                    
                .默认
                    
                    赋值 (SQL_查询条件, “”)
                .判断结束
                
                
                
                 ' 按综合查询分组框组件可见 ()
            .判断结束
            
        .判断结束
        
    .判断结束
    
.判断结束

设置默认入库高级表格格式 ()
赋值 (.标题, 到文本 (查询所有入库数据 (_启动窗口., _启动窗口., SQL_查询条件)))
高级表格字体初始化 (“高级表格_入库查询字体”, )


 ' *********************************************
 ' 出库查询模块
 ' *********************************************

.子程序 _毛纱出库查询按钮_被单击, 空白型, , 
赋值 (.现行子夹, 4) ' 显示出库查询

赋值 (.左边, 32)
赋值 (.顶边, 5)
赋值 (.左边, 109)
赋值 (.顶边, 113)
赋值 (.左边, 336)
赋值 (.顶边, 113)

赋值 (.左边, 32)
赋值 (.顶边, 5)
赋值 (.左边, 185)
赋值 (.顶边, 115)

赋值 (.左边, 32)
赋值 (.顶边, 5)

赋值 (.左边, 32)
赋值 (.顶边, 5)

赋值 (.左边, 32)
赋值 (.顶边, 5)

赋值 (.左边, 32)
赋值 (.顶边, 5)

赋值 (.左边, 32)
赋值 (.顶边, 5)

赋值 (.左边, 6)
赋值 (.顶边, 1)

按出库日期查询分组框组件可见 ()

赋值 (.现行选中项, 0)
设置默认出库高级表格格式 ()
清空 ()
得到供应商选择列表框项目 ()


.子程序 _超级按钮_返回主界面_出库_查询_被单击, 空白型, , 
赋值 (.现行子夹, 0) ' 切换到主界面

.子程序 _超级按钮_保存_出库查询结果_被单击, 空白型, , 
赋值 (.过滤器, “表单文件(*.out)|*.out”)
赋值 (.初始目录, 相加 (系统目录, “\表单\出库查询”))

.如果真 (打开 ())
    .如果 (等于 (相加 (.文件名, “.out”).未知支持库函数_55 (), 真))
        信息框 (“查询结果保存成功!”, 64, #提示文字)
    .否则
        信息框 (“查询结果保存失败!”, 64, #提示文字)
    .如果结束
    
.如果真结束


.子程序 _超级按钮_打开_出库查询结果_被单击, 空白型, , 
赋值 (.过滤器, “表单文件(*.out)|*.out”)
赋值 (.初始目录, 相加 (系统目录, “\表单\出库查询”))
.如果真 (打开 ())
    .如果真 (等于 (.未知支持库函数_56 (.文件名), 假))
        信息框 (“读取失败！”, 64, #提示文字)
    .如果真结束
     ' 显示所有入库数据 (外部数据库, _启动窗口.高级表格_入库查询, “”)
.如果真结束


.子程序 _超级按钮_打印预览_出库查询结果_被单击, 空白型, , 
未知支持库函数_27 ()

.子程序 _超级按钮_打印_出库查询结果_被单击, 空白型, , 
未知支持库函数_26 ()
 ' ------------------------------------------------------------------------------

.子程序 _组合框_出库查询方式_列表项被选择, 空白型, , 
.局部变量 临时变量, 整数型, , , 

赋值 (.可视, 假)
赋值 (临时变量, .现行选中项)

 ' 调试输出 (到文本 (临时变量))

.判断开始 (等于 (临时变量, 0))
    按出库日期查询分组框组件可见 ()
.默认
    .判断开始 (等于 (临时变量, 1))
        按客户查询分组框组件可见 ()
    .默认
        .判断开始 (等于 (临时变量, 2))
            按客户定单号查询分组框组件可见 ()
        .默认
            .判断开始 (等于 (临时变量, 3))
                按出库单号查询分组框组件可见 ()
            .默认
                .判断开始 (等于 (临时变量, 4))
                    按装箱编号查询分组框组件可见 ()
                .默认
                    .判断开始 (等于 (临时变量, 5))
                        按快递单号查询分组框组件可见 ()
                        
                    .默认
                        按出库综合查询分组框组件可见 ()
                    .判断结束
                    
                .判断结束
                
            .判断结束
            
        .判断结束
        
    .判断结束
    
.判断结束


.子程序 按出库日期查询分组框组件可见, 空白型, , 
赋值 (.可视, 真)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)

赋值 (.内容, 取当前日期文本 (2, “.”))
赋值 (.内容, .内容)


.子程序 按客户查询分组框组件可见, 空白型, , 

赋值 (.可视, 假)
得到客户选择列表框项目 ()
赋值 (.可视, 真)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)



.子程序 按客户定单号查询分组框组件可见, 空白型, , 
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 真)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)



.子程序 按出库单号查询分组框组件可见, 空白型, , 
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 真)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)


.子程序 按装箱编号查询分组框组件可见, 空白型, , 
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 真)
赋值 (.可视, 假)
赋值 (.可视, 假)


.子程序 按快递单号查询分组框组件可见, 空白型, , 
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 真)
赋值 (.可视, 假)


.子程序 按出库综合查询分组框组件可见, 空白型, , 
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 真)


.子程序 _编辑框_起始日期_出库_获得焦点, 空白型, , 
赋值 (.可视, 真)

.子程序 _编辑框_起始日期_出库_失去焦点, 空白型, , 
赋值 (.可视, 假)

.子程序 _编辑框_起始日期_出库_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_截止日期_出库_获得焦点, 空白型, , 
赋值 (.可视, 真)

.子程序 _编辑框_截止日期_出库_失去焦点, 空白型, , 
赋值 (.可视, 假)

.子程序 _月历_出库_查询_起始_选择日期被改变, 空白型, , 
赋值 (.内容, 取月历文本 (.首选择日))


.子程序 _月历_出库_查询_截止_选择日期被改变, 空白型, , 
赋值 (.内容, 取月历文本 (.首选择日))

.子程序 _编辑框_客户查询_获得焦点, 空白型, , 
赋值 (.可视, 真)

.子程序 _编辑框_客户查询_失去焦点, 空白型, , 
赋值 (.可视, 假)

 ' ------------------------------------------------------------------------------------------------------


.子程序 _选择列表框_客户查询_列表项被选择, 空白型, , 
赋值 (.内容, .取项目文本 (.现行选中项))


.子程序 _编辑框_纱号出库查询_内容被改变, 空白型, , 

.如果真 (.选中)
    .如果真 (等于 (删首空 (.内容), “”))
        信息框 (“选中的查询条件纱号不能为空！如果不想要此查询条件，请把前面的勾去掉！”, 0, #提示文字)
        获取焦点 ()
    .如果真结束
    
.如果真结束


.子程序 _编辑框_支数出库查询_内容被改变, 空白型, , 

.如果真 (.选中)
    .如果真 (等于 (删首空 (.内容), “”))
        信息框 (“选中的查询条件支数不能为空！如果不想要此查询条件，请把前面的勾去掉！”, 0, #提示文字)
        获取焦点 ()
    .如果真结束
    
.如果真结束


.子程序 _编辑框_成份出库查询_内容被改变, 空白型, , 

.如果真 (.选中)
    .如果真 (等于 (删首空 (.内容), “”))
        信息框 (“选中的查询条件成份不能为空！如果不想要此查询条件，请把前面的勾去掉！”, 0, #提示文字)
        获取焦点 ()
    .如果真结束
    
.如果真结束


.子程序 _编辑框_色号出库查询_内容被改变, 空白型, , 

.如果真 (.选中)
    .如果真 (等于 (删首空 (.内容), “”))
        信息框 (“选中的查询条件色号不能为空！如果不想要此查询条件，请把前面的勾去掉！”, 0, #提示文字)
        获取焦点 ()
    .如果真结束
    
.如果真结束


.子程序 _编辑框_颜色出库查询_内容被改变, 空白型, , 

.如果真 (.选中)
    .如果真 (等于 (删首空 (.内容), “”))
        信息框 (“选中的查询条件颜色不能为空！如果不想要此查询条件，请把前面的勾去掉！”, 0, #提示文字)
        获取焦点 ()
    .如果真结束
    
.如果真结束


.子程序 _编辑框_缸号出库查询_内容被改变, 空白型, , 

.如果真 (.选中)
    .如果真 (等于 (删首空 (.内容), “”))
        信息框 (“选中的查询条件缸号不能为空！如果不想要此查询条件，请把前面的勾去掉！”, 0, #提示文字)
        获取焦点 ()
    .如果真结束
    
.如果真结束


.子程序 _超级按钮_开始查询_出库_被单击, 空白型, , 
.局部变量 起始日期, 文本型, , , 
.局部变量 截止日期, 文本型, , , 
.局部变量 临时变量, 整数型, , , 
.局部变量 SQL_查询条件, 文本型, , , 

赋值 (临时变量, .现行选中项)

.判断开始 (等于 (临时变量, 0))
     ' 按日期查询分组框组件可见 ()
    赋值 (起始日期, 子文本替换 (.内容, “.”, “-”, 1, 2, 真))
    赋值 (截止日期, 子文本替换 (.内容, “.”, “-”, 1, 2, 真))
    
    .判断开始 (大于或等于 (到时间 (截止日期), 到时间 (起始日期)))
        赋值 (SQL_查询条件, 相加 (“ where [日期]>=#”, 起始日期, “# and [日期]<=#”, 截止日期, “#”))
    .默认
        
        信息框 (“起始日期不能大于截止日期”, 0, #提示文字)
        获取焦点 ()
        返回 ()
    .判断结束
    
.默认
    .判断开始 (等于 (临时变量, 1))
        赋值 (SQL_查询条件, 相加 (“ where 客户='”, .内容, “'”))
    .默认
        .判断开始 (等于 (临时变量, 2))
            赋值 (SQL_查询条件, 相加 (“ where 客户订单号='”, 到文本 (.内容), “'”))
        .默认
            .判断开始 (等于 (临时变量, 3))
                赋值 (SQL_查询条件, 相加 (“ where 出库单号='”, .内容, “'”))
            .判断 (等于 (临时变量, 4))
                赋值 (SQL_查询条件, 相加 (“ where 编号='”, .内容, “'”))
            .默认
                .判断开始 (等于 (临时变量, 5))
                    赋值 (SQL_查询条件, 相加 (“ where 快递单号='”, .内容, “'”))
                .默认
                    
                    .判断开始 (或者 (.选中, .选中, .选中, .选中, .选中, .选中))
                        赋值 (SQL_查询条件, “ where”)
                        .如果真 (.选中)
                            赋值 (SQL_查询条件, 相加 (SQL_查询条件, “ 纱号='”, .内容, “'”))
                        .如果真结束
                        
                        .如果真 (.选中)
                            .判断开始 (等于 (.选中, 真))
                                赋值 (SQL_查询条件, 相加 (SQL_查询条件, “ and 支数='”, .内容, “'”))
                            .默认
                                
                                赋值 (SQL_查询条件, 相加 (SQL_查询条件, “ 支数='”, .内容, “'”))
                            .判断结束
                            
                        .如果真结束
                        
                        .如果真 (.选中)
                            .判断开始 (或者 (等于 (.选中, 真), 等于 (.选中, 真)))
                                赋值 (SQL_查询条件, 相加 (SQL_查询条件, “ and 成份='”, .内容, “'”))
                            .默认
                                
                                赋值 (SQL_查询条件, 相加 (SQL_查询条件, “ 成份='”, .内容, “'”))
                            .判断结束
                            
                        .如果真结束
                        
                        .如果真 (.选中)
                            .判断开始 (或者 (等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真)))
                                赋值 (SQL_查询条件, 相加 (SQL_查询条件, “ and 色号='”, .内容, “'”))
                            .默认
                                
                                赋值 (SQL_查询条件, 相加 (SQL_查询条件, “ 色号='”, .内容, “'”))
                            .判断结束
                            
                        .如果真结束
                        
                        .如果真 (.选中)
                            .判断开始 (或者 (等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真)))
                                赋值 (SQL_查询条件, 相加 (SQL_查询条件, “ and 颜色='”, .内容, “'”))
                            .默认
                                
                                赋值 (SQL_查询条件, 相加 (SQL_查询条件, “ 颜色='”, .内容, “'”))
                            .判断结束
                            
                        .如果真结束
                        
                        .如果真 (.选中)
                            .判断开始 (或者 (等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真), 等于 (.选中, 真)))
                                赋值 (SQL_查询条件, 相加 (SQL_查询条件, “ and 缸号='”, .内容, “'”))
                            .默认
                                
                                赋值 (SQL_查询条件, 相加 (SQL_查询条件, “ 缸号='”, .内容, “'”))
                            .判断结束
                            
                        .如果真结束
                        
                    .默认
                        赋值 (SQL_查询条件, “”)
                    .判断结束
                    
                    
                .判断结束
                
            .判断结束
            
        .判断结束
        
    .判断结束
    
.判断结束

设置默认出库高级表格格式 ()
赋值 (.标题, 到文本 (查询所有出库数据 (SQL_查询条件)))
高级表格字体初始化 (“高级表格_出库查询字体”, )

.子程序 _高级表格_出库查询_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 (取鼠标水平位置 (), 取鼠标垂直位置 ())
_字体设置_被选择 ()
 ' ***********************************************************
 ' 入库统计模块
 ' ***********************************************************


.子程序 _毛纱入库统计按钮_被单击, 空白型, , 
赋值 (.现行子夹, 5) ' 显示入库统计界面

赋值 (.左边, 250)
赋值 (.顶边, 66)

清空 ()
“所有供应商”.加入项目 ()
得到供应商选择列表框项目 ()

.子程序 _超级按钮_返回主界面_入库_统计_被单击, 空白型, , 
赋值 (.现行子夹, 0) ' 显示主界面


.子程序 _超级按钮_保存_入库统计结果_被单击, 空白型, , 
赋值 (.过滤器, “表单文件(*.rtj)|*.rtj”)
赋值 (.初始目录, 相加 (系统目录, “\表单\入库统计”))

.如果真 (打开 ())
    .如果 (等于 (相加 (.文件名, “.rtj”).未知支持库函数_55 (), 真))
        信息框 (“表单文件保存成功!”, 64, #提示文字)
    .否则
        信息框 (“表单文件保存失败!”, 64, #提示文字)
    .如果结束
    
.如果真结束


.子程序 _超级按钮_打开_入库统计结果_被单击, 空白型, , 
赋值 (.过滤器, “表单文件(*.rtj)|*.rtj”)
赋值 (.初始目录, 相加 (系统目录, “\表单\入库统计”))
.如果真 (打开 ())
    .如果真 (等于 (.未知支持库函数_56 (.文件名), 假))
        信息框 (“读取失败！”, 64, #提示文字)
    .如果真结束
    
.如果真结束


.子程序 _超级按钮_打印预览_入库统计结果_被单击, 空白型, , 
.局部变量 temp1, 字节集, , , 
.局部变量 temp, 整数型, , , 

 ' temp1 ＝ 快照 (柱状图控件_入库_统计.取窗口句柄 (), , )
 ' temp ＝ 载入图片 (temp1)
 ' 画板1.取图片高度 (temp)
 ' 高级表格_入库统计.置行高 (高级表格_入库统计.行数 － 1, 200)
 ' 高级表格_入库统计.置列宽 (高级表格_入库统计.行数 － 1, 画板1.取图片宽度 (temp))
 ' 高级表格_入库统计.置列类型 (4, #表格常量.图片型)
 ' 高级表格_入库统计.置数据 (高级表格_入库统计.行数 － 1, 4, #表格常量.图片型, temp1)
未知支持库函数_27 ()
 ' 卸载图片 (temp)

.子程序 _超级按钮_打印_入库统计结果_被单击, 空白型, , 
未知支持库函数_26 ()


.子程序 _高级表格_入库统计_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 (取鼠标水平位置 (), 取鼠标垂直位置 ())
_字体设置_被选择 ()

.子程序 _超级按钮_开始统计_入库_被单击, 空白型, , 
.局部变量 临时变量1, 整数型, , , 
.局部变量 临时变量2, 整数型, , , 
.局部变量 匿名局部变量_9533, 空白型, , , 
.局部变量 起始日期, 文本型, , , 
.局部变量 截止日期, 文本型, , , 
.局部变量 SQL查询条件, 文本型, , , 
.局部变量 总量数据, 总量数据类型, , , 
.局部变量 当前图例文字2, 文本型, , , 
.局部变量 当前图例文字1, 文本型, , , 
.局部变量 Y轴单位2, 文本型, , , 
.局部变量 Y轴单位1, 文本型, , , 
.局部变量 X轴单位, 文本型, , , 
.局部变量 当前X轴标注文字, 文本型, , , 
.局部变量 SQL查询条件1, 文本型, , , 
.局部变量 SQL查询条件2, 文本型, , , 
.局部变量 SQL查询条件3, 文本型, , , 

赋值 (临时变量1, .现行选中项)


赋值 (SQL查询条件1, 多项选择 (相加 (临时变量1, 1), 一年时间里所有的数据 (), 一月里所有的数据 (), 二月里所有的数据 (), 三月里所有的数据 (), 四月里所有的数据 (), 五月里所有的数据 (), 六月里所有的数据 (), 七月里所有的数据 (), 八月里所有的数据 (), 九月里所有的数据 (), 十月里所有的数据 (), 十一月里所有的数据 (), 十二月里所有的数据 ()))
赋值 (SQL查询条件2, 指定供应商所有的数据 ())
赋值 (SQL查询条件3, 进价币种 ())

赋值 (SQL查询条件, 相加 (SQL查询条件1, SQL查询条件2, SQL查询条件3))


设置默认入库高级表格格式 ()
赋值 (总量数据, 显示统计所有入库数据 (SQL查询条件))
高级表格字体初始化 (“高级表格_入库统计字体”, )

.判断开始 (等于 (总量数据.币种, “RMB”))
    .判断开始 (大于 (总量数据.总金额, 1000)) ' 如果总数量大于1000kg则用吨表示单位，否则用公斤表示单位
        赋值 (当前图例文字1, “总数量(吨)”) ' 如果总金额大于1000元则用千元表示单位，否则用元表示单位
        赋值 (Y轴单位1, “吨(千元)”)
    .默认
        
        赋值 (当前图例文字1, “总数量(公斤)”)
        赋值 (Y轴单位1, “公斤(元)”)
    .判断结束
    
    .判断开始 (大于 (总量数据.总数量, 1000))
        赋值 (当前图例文字2, “总金额(千元)”)
        赋值 (Y轴单位2, “吨(千元)”)
    .默认
        赋值 (当前图例文字2, “总金额(元)”)
        赋值 (Y轴单位2, “公斤(元)”)
    .判断结束
    
.默认
    
    .判断开始 (大于 (总量数据.总金额, 1000))
        赋值 (当前图例文字1, “总数量(千磅)”)
        赋值 (Y轴单位1, “千磅(千美元)”)
    .默认
        
        赋值 (当前图例文字1, “总数量(磅)”)
        赋值 (Y轴单位1, “磅(美元)”)
    .判断结束
    
    .判断开始 (大于 (总量数据.总数量, 1000))
        赋值 (当前图例文字2, “总金额(千美元)”)
        赋值 (Y轴单位2, “千磅(千美元)”)
    .默认
        赋值 (当前图例文字2, “总金额(美元)”)
        赋值 (Y轴单位2, “磅(美元)”)
    .判断结束
    
.判断结束


赋值 (当前X轴标注文字, 多项选择 (相加 (临时变量1, 1), 相加 (到文本 (取年份 (取现行时间 ())), “年”), 相加 (到文本 (取年份 (取现行时间 ())), “年”), “一月”, “二月”, “三月”, “四月”, “五月”, “六月”, “七月”, “八月”, “九月”, “十月”, “十一月”, “十二月”, “一月”, “二月”, “三月”, “四月”, “五月”, “六月”, “七月”, “八月”, “九月”, “十月”, “十一月”, “十二月”))

.判断开始 (或者 (等于 (临时变量1, 0), 等于 (临时变量1, 1)))
    赋值 (X轴单位, “年份”)
.默认
    赋值 (X轴单位, “月份”)
.判断结束

赋值 (., 1000)

赋值 (., 2)
赋值 (., X轴单位)
赋值 (., 当前X轴标注文字)

赋值 (., Y轴单位1)
赋值 (., 0)
赋值 (., 当前图例文字1)
赋值 (., #红色)
赋值 (., 总量数据.总数量)

赋值 (., Y轴单位2)
赋值 (., 1)
赋值 (., 当前图例文字2)
赋值 (., #天蓝)
赋值 (., 总量数据.总金额)

曲线图入库 () ' 显示每月总量数据曲线图




.子程序 _选择列表框_供应商_统计_列表项被选择, 空白型, , 
赋值 (.内容, .取项目文本 (.现行选中项))

.子程序 _编辑框_供应商_统计_获得焦点, 空白型, , 
赋值 (.可视, 真)

.子程序 _编辑框_供应商_统计_失去焦点, 空白型, , 
赋值 (.可视, 假)

.子程序 _横向滚动条_示意图_入库_位置被改变, 空白型, , 
负 (.位置).移动 ()
 ' 调试输出 (到文本 (横向滚动条_示意图_入库.位置))

 ' *********************************************
 ' 操作员管理模块
 ' *********************************************


.子程序 _操作员管理按钮_被单击, 空白型, , 
.局部变量 字体名称, 文本型, , , 
.局部变量 字体大小, 文本型, , , 

赋值 (.现行子夹, 11) ' 显示操作员管理界面
设置默认操作员高级表格格式 ()
显示所有操作员数据 (“”)
高级表格字体初始化 (“高级表格_操作员管理字体”, )

赋值 (操作员_编辑行号, 未知支持库函数_3 ())
获取焦点 ()
赋值 (., 0)

 ' 超级列表框_操作员图像.图片组＝ #图片组
显示 (#图片组)

.子程序 _高级表格_操作员管理_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 (取鼠标水平位置 (), 取鼠标垂直位置 ())
_字体设置_被选择 ()

.子程序 _超级按钮_返回主界面_操作员_被单击, 空白型, , 
赋值 (.现行子夹, 0) ' 切换到封面界面


.子程序 _超级列表框_操作员图像_当前表项被改变, 空白型, , 
赋值 (.正常图片, 未知支持库函数_31 (#图片组, ., ))

.子程序 _超级按钮_添加_操作员_被单击, 空白型, , 
高级表格_操作员__内容被改变 ()
获取焦点 ()
保存操作员数据到数据库 () ' 添加操作员到数据库


.子程序 _超级按钮_打印预览_操作员_被单击, 空白型, , 
未知支持库函数_27 ()

.子程序 _超级按钮_打印_操作员_被单击, 空白型, , 
未知支持库函数_26 ()

.子程序 _编辑框_用户名称_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_用户密码_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_用户权限_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _超级按钮_添加_操作员_被单击 ()
.如果真结束


.子程序 _编辑框_用户权限_获得焦点, 空白型, , 
赋值 (.可视, 真)


.子程序 _编辑框_用户权限_失去焦点, 空白型, , 
赋值 (.可视, 假)

.子程序 _选择列表框_权限_列表项被选择, 空白型, , 
赋值 (.内容, .取项目文本 (.现行选中项))

.子程序 _超级按钮_修改_操作员_被单击, 空白型, , 
保存操作员数据到数据库 ()

.子程序 _超级按钮_删除_操作员_被单击, 空白型, , 
删除当前记录_操作员 ()

.子程序 _超级按钮_查找_操作员_被单击, 空白型, , 
设置默认操作员高级表格格式 ()
显示所有操作员数据 (相加 (“ where 用户名称='”, .内容, “'”))


.子程序 _高级表格_操作员管理_光标位置改变, 空白型, , 
.局部变量 当前用户名, 文本型, , , 

赋值 (操作员_编辑行号, 未知支持库函数_3 ())
赋值 (当前用户名, 操作员_编辑行号.未知支持库函数_10 (0))
通过用户名称得到当前其它数据 (当前用户名)


.子程序 _编辑框_用户名称_内容被改变, 空白型, , 
高级表格_操作员_用户名称_内容被改变 ()

.子程序 _编辑框_用户密码_内容被改变, 空白型, , 
高级表格_操作员_用户密码_内容被改变 ()

.子程序 _编辑框_用户权限_内容被改变, 空白型, , 
高级表格_操作员_用户权限_内容被改变 ()

.子程序 _高级表格_操作员管理_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, 46)) ' DEL键
    _超级按钮_删除_操作员_被单击 ()
.如果真结束


 ' *********************************************
 ' 系统配置模块
 ' *********************************************

.子程序 _系统配置按钮_被单击, 空白型, , 
赋值 (.现行子夹, 7) ' 显示系统配置界面
赋值 (.内容, 读配置项 (相加 (系统目录, “\系统配置.ini”), “公司信息”, “公司中文名称”, “”))
赋值 (.内容, 读配置项 (相加 (系统目录, “\系统配置.ini”), “公司信息”, “公司英文名称”, “”))
赋值 (.内容, 读配置项 (相加 (系统目录, “\系统配置.ini”), “公司信息”, “公司中文地址”, “”))
赋值 (.内容, 读配置项 (相加 (系统目录, “\系统配置.ini”), “公司信息”, “公司英文地址”, “”))
赋值 (.内容, 读配置项 (相加 (系统目录, “\系统配置.ini”), “公司信息”, “公司电话”, “”))
赋值 (.内容, 读配置项 (相加 (系统目录, “\系统配置.ini”), “公司信息”, “公司传真”, “”))
赋值 (.内容, 读配置项 (相加 (系统目录, “\系统配置.ini”), “系统路径”, “数据库路径”, “”))
 ' -----------------------------------------------
 ' 公司详细信息配置，在生成装箱单时必须要用的
 ' -----------------------------------------------

.子程序 _编辑框_公司中文名称_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_公司英文名称_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_公司中文地址_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_公司英文地址_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_TEL_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_FAX_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _超级按钮_使用者信息_确定_被单击 ()
.如果真结束


.子程序 _超级按钮_使用者信息_确定_被单击, 空白型, , 
写配置项 (相加 (系统目录, “\系统配置.ini”), “公司信息”, “公司中文名称”, .内容)
写配置项 (相加 (系统目录, “\系统配置.ini”), “公司信息”, “公司英文名称”, .内容)
写配置项 (相加 (系统目录, “\系统配置.ini”), “公司信息”, “公司中文地址”, .内容)
写配置项 (相加 (系统目录, “\系统配置.ini”), “公司信息”, “公司英文地址”, .内容)
写配置项 (相加 (系统目录, “\系统配置.ini”), “公司信息”, “公司电话”, .内容)
写配置项 (相加 (系统目录, “\系统配置.ini”), “公司信息”, “公司传真”, .内容)


.子程序 _超级按钮_使用者信息_取消_被单击, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)

 ' -----------------------
 ' 数据库配置
 ' -----------------------

.子程序 _超级按钮_数据库_保存_被单击, 空白型, , 
.局部变量 成功, 逻辑型, , , 

赋值 (成功, 写配置项 (相加 (系统目录, “\系统配置.ini”), “系统路径”, “数据库路径”, .内容))
.判断开始 (等于 (成功, 真))
    信息框 (“配置成功！”, 0, #提示文字)
    
    .如果 (等于 (文件是否存在 (.内容), 假))
        信息框 (相加 (.内容, “失踪!”, #换行符, “请检查系统的完整性!本次运行将取消.”), #错误图标, #提示文字)
        结束 ()
    .否则
        
        .如果 (等于 (_启动窗口.打开MDB数据库 (., .内容, “admin”, , , ), 假))
            信息框 (相加 (.内容, “打开失败!”, #换行符, “请系统管理员检查原因.本次运行将取消.”), #错误图标, #提示文字)
            返回 ()
        .否则
            
            _启动窗口.打开MDB数据库 (., .内容, “admin”, , , )
        .如果结束
        
    .如果结束
    
.默认
    
    信息框 (“配置失败！”, 0, #提示文字)
.判断结束


.子程序 _超级按钮_清空数据库_被单击, 空白型, , 
.如果 (_启动窗口.执行 (., “DELETE FROM data”, ))
    信息框 (“清空数据库成功！　”, 64, #提示文字)
.否则
    信息框 (“清空数据库失败！　”, 64, #提示文字)
.如果结束


.子程序 _超级按钮_压缩数据库_被单击, 空白型, , 
用户压缩数据库 (假)



.子程序 _超级按钮_备份数据库_被单击, 空白型, , 
.局部变量 备份数据库文件名, 文本型, , , 

赋值 (.类型, 1) ' 保存对放框
赋值 (.过滤器, “表单文件(*.mdb)|*.mdb”)
赋值 (.初始目录, 相加 (数据库目录, “备份\”))

.如果真 (打开 ())
    
    .如果真 (不等于 (取文本左边 (备份数据库文件名, 4), “.mdb”))
        赋值 (备份数据库文件名, 相加 (.文件名, “.mdb”))
    .如果真结束
    
    .判断开始 (等于 (复制数据库文件 (真, 备份数据库文件名), 真))
        
        保存_列表_备份_表项 (.文件名, 备份数据库文件名, “1”)
        
        信息框 (“备份数据库成功！”, 64, #提示文字)
    .默认
        
        信息框 (“备份数据库失败！”, 64, #提示文字)
    .判断结束
    
.如果真结束


.子程序 _超级按钮_还原数据库_被单击, 空白型, , 
显示_列表_备份_表项 ()
赋值 (.可视, 真)

.子程序 _超级按钮_还原_确定_被单击, 空白型, , 
.局部变量 数据库文件名, 文本型, , , 

赋值 (数据库文件名, 得到超级列表框标题对应数据库文件名 ())
.判断开始 (等于 (文件是否存在 (数据库文件名), 真))
    复制数据库文件 (假, 数据库文件名)
    信息框 (“还原成功！”, 64, #提示文字)
.默认
    
    信息框 (“没有找到要还原的数据库文件！”, #错误图标, #提示文字)
.判断结束


赋值 (.可视, 假)

.子程序 _超级按钮_还原_取消_被单击, 空白型, , 
赋值 (.可视, 假)

.子程序 _画板_还原_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

161.发送信息 (2, 0)

.子程序 _超级列表框_备份数据库_表项被激活, 空白型, , 
赋值 (超级列表框标题, .取标题 (., ))


.子程序 _超级按钮_数据库_打开_被单击, 空白型, , 
赋值 (.初始目录, 系统目录)

.如果真 (打开 ())
    赋值 (.内容, .文件名)
.如果真结束

 ' ******************************************
 ' 快递公司管理模块
 ' ******************************************

.子程序 _快递公司管理按钮_被单击, 空白型, , 
赋值 (.现行子夹, 8) ' 显示快递公司管理界面
设置默认快递公司高级表格格式 (_启动窗口.)
显示所有快递公司数据 (_启动窗口., _启动窗口., “”)
高级表格字体初始化 (“高级表格_快递公司字体”, )
赋值 (快递公司_编辑行号, 未知支持库函数_3 ())
获取焦点 ()

.子程序 _超级按钮_返回主界面_快递公司_被单击, 空白型, , 
赋值 (.现行子夹, 0) ' 切换到封面界面


.子程序 _高级表格_快递公司_光标位置改变, 空白型, , 
.局部变量 当前快递公司简称, 文本型, , , 

赋值 (快递公司_编辑行号, 未知支持库函数_3 ())
赋值 (当前快递公司简称, 快递公司_编辑行号.未知支持库函数_10 (1))
通过快递公司简称得到当前其它数据 (当前快递公司简称)


.子程序 _高级表格_快递公司_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, 46)) ' DEL键
    _超级按钮_删除_快递公司_被单击 ()
.如果真结束
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _编辑框_快递公司全称_内容被改变, 空白型, , 
高级表格_快递公司_快递公司全称_内容被改变 ()

.子程序 _编辑框_快递公司简称_内容被改变, 空白型, , 
高级表格_快递公司_快递公司简称_内容被改变 ()

.子程序 _编辑框_快递公司业务员_内容被改变, 空白型, , 
高级表格_快递公司_快递公司业务员_内容被改变 ()

.子程序 _编辑框_快递公司地址_内容被改变, 空白型, , 
高级表格_快递公司_快递公司地址_内容被改变 ()

.子程序 _编辑框_快递公司网址_内容被改变, 空白型, , 
高级表格_快递公司_快递公司网址_内容被改变 ()

.子程序 _编辑框_快递公司电话_内容被改变, 空白型, , 
高级表格_快递公司_快递公司电话_内容被改变 ()

.子程序 _编辑框_快递公司传真_内容被改变, 空白型, , 
高级表格_快递公司_快递公司传真_内容被改变 ()
 ' --------------------------------------------------------------------------

.子程序 _编辑框_快递公司全称_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_快递公司简称_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_快递公司业务员_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_快递公司地址_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_快递公司网址_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_快递公司电话_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_快递公司传真_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _超级按钮_保存_快递公司_被单击 ()
.如果真结束


.子程序 _超级按钮_查找_快递公司简称_被单击, 空白型, , 
设置默认快递公司高级表格格式 ()
显示所有快递公司数据 (相加 (“ where 简称='”, .内容, “'”))


.子程序 _超级按钮_保存_快递公司_被单击, 空白型, , 
高级表格_快递公司_快递公司_内容被改变 ()
获取焦点 ()
保存快递公司数据到数据库 () ' 添加快递公司到数据库


.子程序 _高级表格_快递公司_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 (取鼠标水平位置 (), 取鼠标垂直位置 ())
_字体设置_被选择 ()

.子程序 _超级按钮_删除_快递公司_被单击, 空白型, , 
删除当前记录_快递公司 ()

.子程序 _超级按钮_打印预览_快递公司_被单击, 空白型, , 
未知支持库函数_27 ()

.子程序 _超级按钮_打印_快递公司_被单击, 空白型, , 
未知支持库函数_26 ()


 ' ******************************************
 ' 客户管理模块
 ' ******************************************


.子程序 _客户数据管理按钮_被单击, 空白型, , 
赋值 (.现行子夹, 9) ' 显示客户管理界面
设置默认客户高级表格格式 (_启动窗口.)
显示所有客户数据 (_启动窗口., _启动窗口., “”)
高级表格字体初始化 (“高级表格_客户字体”, )
赋值 (客户_编辑行号, 未知支持库函数_3 ())
获取焦点 ()

.子程序 _超级按钮_返回主界面_客户公司_被单击, 空白型, , 
赋值 (.现行子夹, 0) ' 切换到封面界面

.子程序 _高级表格_客户_光标位置改变, 空白型, , 
.局部变量 当前客户公司简称, 文本型, , , 

赋值 (客户_编辑行号, 未知支持库函数_3 ())
赋值 (当前客户公司简称, 客户_编辑行号.未知支持库函数_10 (1))
通过客户公司简称得到当前其它数据 (当前客户公司简称)


.子程序 _高级表格_客户_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, 46)) ' DEL键
    _超级按钮_删除_客户_被单击 ()
.如果真结束


.子程序 _超级按钮_保存_客户公司_被单击, 空白型, , 
高级表格_客户_内容被改变 ()
获取焦点 ()
保存客户公司数据到数据库 () ' 添加客户到数据库


.子程序 _高级表格_客户_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 (取鼠标水平位置 (), 取鼠标垂直位置 ())
_字体设置_被选择 ()

.子程序 _超级按钮_删除_客户_被单击, 空白型, , 
删除当前记录_客户公司 ()

.子程序 _编辑框_客户公司全称_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_客户公司简称_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_客户公司业务员_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_客户公司地址_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_客户公司网址_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_客户公司电话_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_客户公司传真_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _超级按钮_保存_客户公司_被单击 ()
.如果真结束


.子程序 _编辑框_客户公司全称_内容被改变, 空白型, , 
高级表格_客户_客户公司全称_内容被改变 ()

.子程序 _编辑框_客户公司简称_内容被改变, 空白型, , 
高级表格_客户_客户公司简称_内容被改变 ()

.子程序 _编辑框_客户公司业务员_内容被改变, 空白型, , 
高级表格_客户_客户公司业务员_内容被改变 ()

.子程序 _编辑框_客户公司地址_内容被改变, 空白型, , 
高级表格_客户_客户公司地址_内容被改变 ()

.子程序 _编辑框_客户公司网址_内容被改变, 空白型, , 
高级表格_客户_客户公司网址_内容被改变 ()

.子程序 _编辑框_客户公司电话_内容被改变, 空白型, , 
高级表格_客户_客户公司电话_内容被改变 ()

.子程序 _编辑框_客户公司传真_内容被改变, 空白型, , 
高级表格_客户_客户公司传真_内容被改变 ()

.子程序 _超级按钮_查找_客户公司简称_被单击, 空白型, , 
设置默认客户高级表格格式 ()
显示所有客户数据 (相加 (“ where 简称='”, .内容, “'”))

.子程序 _超级按钮_打印预览_客户公司_被单击, 空白型, , 
未知支持库函数_27 ()

.子程序 _超级按钮_打印_客户公司_被单击, 空白型, , 
未知支持库函数_26 ()




 ' ******************************************
 ' 供应商管理模块
 ' ******************************************


.子程序 _供应商管理按钮_被单击, 空白型, , 
赋值 (.现行子夹, 10) ' 显示供应商管理界面
设置默认供应商高级表格格式 (_启动窗口.)
显示所有供应商数据 (_启动窗口., _启动窗口., “”)
高级表格字体初始化 (“高级表格_供应商字体”, )

赋值 (供应商_编辑行号, 未知支持库函数_3 ())
获取焦点 ()


.子程序 _超级按钮_返回主界面_供应商_被单击, 空白型, , 
赋值 (.现行子夹, 0) ' 显示主界面

.子程序 _超级按钮_保存_供应商_被单击, 空白型, , 
高级表格_供应商_内容被改变 ()
获取焦点 ()
保存供应商数据到数据库 () ' 添加供应商到数据库


.子程序 _超级按钮_查找_供应商简称_被单击, 空白型, , 
设置默认供应商高级表格格式 ()
显示所有供应商数据 (相加 (“ where 简称='”, .内容, “'”))


.子程序 _超级按钮_删除_供应商_被单击, 空白型, , 
删除当前记录_供应商 ()

.子程序 _超级按钮_打印预览_供应商_被单击, 空白型, , 
未知支持库函数_27 ()

.子程序 _超级按钮_打印_供应商_被单击, 空白型, , 
未知支持库函数_26 ()

.子程序 _高级表格_供应商_光标位置改变, 空白型, , 
.局部变量 当前供应商简称, 文本型, , , 

赋值 (供应商_编辑行号, 未知支持库函数_3 ())
赋值 (当前供应商简称, 供应商_编辑行号.未知支持库函数_10 (1))
通过供应商简称得到当前其它数据 (当前供应商简称)


.子程序 _高级表格_供应商_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, 46)) ' DEL键
    _超级按钮_删除_供应商_被单击 ()
.如果真结束



.子程序 _编辑框_供应商全称_内容被改变, 空白型, , 
高级表格_供应商_供应商全称_内容被改变 ()

.子程序 _编辑框_供应商简称_内容被改变, 空白型, , 
高级表格_供应商_供应商简称_内容被改变 ()

.子程序 _编辑框_供应商业务员_内容被改变, 空白型, , 
高级表格_供应商_供应商业务员_内容被改变 ()

.子程序 _编辑框_供应商地址_内容被改变, 空白型, , 
高级表格_供应商_供应商地址_内容被改变 ()

.子程序 _编辑框_供应商网址_内容被改变, 空白型, , 
高级表格_供应商_供应商网址_内容被改变 ()

.子程序 _编辑框_供应商电话_内容被改变, 空白型, , 
高级表格_供应商_供应商电话_内容被改变 ()

.子程序 _编辑框_供应商传真_内容被改变, 空白型, , 
高级表格_供应商_供应商传真_内容被改变 ()

.子程序 _编辑框_供应商全称_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_供应商简称_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_供应商业务员_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_供应商地址_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_供应商网址_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_供应商电话_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_供应商传真_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _超级按钮_保存_供应商_被单击 ()
.如果真结束


.子程序 _高级表格_供应商_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 (取鼠标水平位置 (), 取鼠标垂直位置 ())
_字体设置_被选择 ()



 ' ****************************************
 ' *注销系统

.子程序 _注销按钮_被单击, 空白型, , 
.局部变量 要登录窗口, 文本型, , , 

.如果真 (等于 (信息框 (“你真的要注销么？”, #确认取消钮, #提示文字), 0))
    赋值 (要登录窗口, 读配置项 (相加 (系统目录, “\系统配置.ini”), “界面”, “登录窗口”, “1”))
    
    .判断开始 (等于 (要登录窗口, “1”))
        载入 (登录窗口, , 真)
    .默认
        
        载入 (登录窗口2, , 真)
    .判断结束
    
     ' ----------------------------------------------
    0.置文本 (多项选择 (到整数 (用户权限), “系统管理员”, “普通管理员”, “来宾管理员”))
    1.置文本 (用户名称) ' 状态条上的当前操作员：
    4.置文本 (取当前日期文本 (1, “”)) ' 状态条上的当前日期：
    7.置文本 (相加 (“上次登录时间：”, 上次登录时间))
    8.置文本 (相加 (“已登录”, 到文本 (相加 (总登录次数, 1)), “次”)) ' 状态条上的总登录次数
    
    赋值 (入库_编辑行号, 1) ' 设置高级表格_出库编辑行号初值
    赋值 (出库_编辑行号, 1) ' 设置高级表格_入库编辑行号初值
    赋值 (操作员_编辑行号, 1) ' 设置高级表格_操作员编辑行号初值
    赋值 (快递公司_编辑行号, 1) ' 设置高级表格_快递公司编辑行号初值
    赋值 (客户_编辑行号, 1) ' 设置高级表格_客户编辑行号初值
    赋值 (供应商_编辑行号, 1) ' 设置高级表格_供应商编辑行号初值
.如果真结束



 ' ******************************************
 ' 出库统计模块
 ' ******************************************

.子程序 _毛纱出库统计按钮_被单击, 空白型, , 
赋值 (.现行子夹, 6) ' 显示出库统计界面

赋值 (.左边, 250)
赋值 (.顶边, 66)

清空 ()
“所有客户”.加入项目 ()
得到客户选择列表框项目 ()


.子程序 _超级按钮_返回主界面_出库_统计_被单击, 空白型, , 
赋值 (.现行子夹, 0) ' 显示主界面

.子程序 _超级按钮_保存_出库统计结果_被单击, 空白型, , 
赋值 (.过滤器, “表单文件(*.ctj)|*.ctj”)
赋值 (.初始目录, 相加 (系统目录, “\表单\出库统计”))

.如果真 (打开 ())
    .如果 (等于 (相加 (.文件名, “.ctj”).未知支持库函数_55 (), 真))
        信息框 (“表单文件保存成功!”, 64, #提示文字)
    .否则
        信息框 (“表单文件保存失败!”, 64, #提示文字)
    .如果结束
    
.如果真结束


.子程序 _超级按钮_打开_出库统计结果_被单击, 空白型, , 
赋值 (.过滤器, “表单文件(*.ctj)|*.ctj”)
赋值 (.初始目录, 相加 (系统目录, “\表单\出库统计”))
.如果真 (打开 ())
    .如果真 (等于 (.未知支持库函数_56 (.文件名), 假))
        信息框 (“读取失败！”, 64, #提示文字)
    .如果真结束
    
.如果真结束
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _超级按钮_打印预览_出库统计结果_被单击, 空白型, , 
未知支持库函数_27 ()

.子程序 _超级按钮_打印_出库统计结果_被单击, 空白型, , 
未知支持库函数_26 ()

.子程序 _选择列表框_客户_统计_列表项被选择, 空白型, , 
赋值 (.内容, .取项目文本 (.现行选中项))

.子程序 _编辑框_客户_统计_获得焦点, 空白型, , 
赋值 (.可视, 真)

.子程序 _编辑框_客户_统计_失去焦点, 空白型, , 
赋值 (.可视, 假)

.子程序 _横向滚动条_示意图_出库_位置被改变, 空白型, , 
负 (.位置).移动 ()


.子程序 _高级表格_出库统计_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 (取鼠标水平位置 (), 取鼠标垂直位置 ())
_字体设置_被选择 ()


.子程序 _超级按钮_开始统计_出库_被单击, 空白型, , 
.局部变量 临时变量, 整数型, , , 
.局部变量 匿名局部变量_9743, 空白型, , , 
.局部变量 起始日期, 文本型, , , 
.局部变量 截止日期, 文本型, , , 
.局部变量 SQL查询条件1, 文本型, , , 
.局部变量 SQL查询条件2, 文本型, , , 
.局部变量 SQL查询条件3, 文本型, , , 
.局部变量 总量数据, 总量数据类型, , , 
.局部变量 当前图例文字2, 文本型, , , 
.局部变量 当前图例文字1, 文本型, , , 
.局部变量 Y轴单位2, 文本型, , , 
.局部变量 Y轴单位1, 文本型, , , 
.局部变量 X轴单位, 文本型, , , 
.局部变量 当前X轴标注文字, 文本型, , , 
.局部变量 SQL查询条件, 文本型, , , 

赋值 (临时变量, .现行选中项)


赋值 (SQL查询条件1, 多项选择 (相加 (临时变量, 1), 一年时间里所有的数据 (), 一月里所有的数据 (), 二月里所有的数据 (), 三月里所有的数据 (), 四月里所有的数据 (), 五月里所有的数据 (), 六月里所有的数据 (), 七月里所有的数据 (), 八月里所有的数据 (), 九月里所有的数据 (), 十月里所有的数据 (), 十一月里所有的数据 (), 十二月里所有的数据 ()))
赋值 (SQL查询条件2, 指定客户所有的数据 ())
赋值 (SQL查询条件3, 单价币种 ())

赋值 (SQL查询条件, 相加 (SQL查询条件1, SQL查询条件3, SQL查询条件2))


设置默认出库高级表格格式 ()
赋值 (总量数据, 显示统计所有出库数据 (SQL查询条件))
高级表格字体初始化 (“高级表格_出库统计字体”, )

.判断开始 (等于 (总量数据.币种, “RMB”))
    .判断开始 (大于 (总量数据.总金额, 1000)) ' 如果总数量大于1000kg则用吨表示单位，否则用公斤表示单位
        赋值 (当前图例文字1, “总数量(吨)”) ' 如果总金额大于1000元则用千元表示单位，否则用元表示单位
        赋值 (Y轴单位1, “吨(千元)”)
    .默认
        
        赋值 (当前图例文字1, “总数量(公斤)”)
        赋值 (Y轴单位1, “公斤(元)”)
    .判断结束
    
    .判断开始 (大于 (总量数据.总数量, 1000))
        赋值 (当前图例文字2, “总金额(千元)”)
        赋值 (Y轴单位2, “吨(千元)”)
    .默认
        赋值 (当前图例文字2, “总金额(元)”)
        赋值 (Y轴单位2, “公斤(元)”)
    .判断结束
    
.默认
    
    .判断开始 (大于 (总量数据.总金额, 1000))
        赋值 (当前图例文字1, “总数量(千磅)”)
        赋值 (Y轴单位1, “千磅(千美元)”)
    .默认
        
        赋值 (当前图例文字1, “总数量(磅)”)
        赋值 (Y轴单位1, “磅(美元)”)
    .判断结束
    
    .判断开始 (大于 (总量数据.总数量, 1000))
        赋值 (当前图例文字2, “总金额(千美元)”)
        赋值 (Y轴单位2, “千磅(千美元)”)
    .默认
        赋值 (当前图例文字2, “总金额(美元)”)
        赋值 (Y轴单位2, “磅(美元)”)
    .判断结束
    
.判断结束


赋值 (当前X轴标注文字, 多项选择 (相加 (临时变量, 1), 相加 (到文本 (取年份 (取现行时间 ())), “年”), 相加 (到文本 (取年份 (取现行时间 ())), “年”), “一月”, “二月”, “三月”, “四月”, “五月”, “六月”, “七月”, “八月”, “九月”, “十月”, “十一月”, “十二月”, “一月”, “二月”, “三月”, “四月”, “五月”, “六月”, “七月”, “八月”, “九月”, “十月”, “十一月”, “十二月”))

.判断开始 (或者 (等于 (临时变量, 0), 等于 (临时变量, 1)))
    赋值 (X轴单位, “年份”)
.默认
    赋值 (X轴单位, “月份”)
.判断结束

赋值 (., 1000)

赋值 (., 2)
赋值 (., X轴单位)
赋值 (., 当前X轴标注文字)

赋值 (., Y轴单位1)
赋值 (., 0)
赋值 (., 当前图例文字1)
赋值 (., #红色)
赋值 (., 总量数据.总数量)

赋值 (., Y轴单位2)
赋值 (., 1)
赋值 (., 当前图例文字2)
赋值 (., #天蓝)
赋值 (., 总量数据.总金额)

曲线图出库 () ' 显示每月总量数据曲线图


.子程序 _高级表格_入库_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 (取鼠标水平位置 (), 取鼠标垂直位置 ())
_字体设置_被选择 ()



.子程序 _字体设置_被选择, 空白型, , 
.参数 参数_高级表格, 未知类型0x50001, , 

赋值 (.类型, 2)
.如果真 (打开 ())
    参数_高级表格.未知支持库函数_16 (0, 0, 参数_高级表格., 参数_高级表格., .字体名称)
    参数_高级表格.未知支持库函数_18 (0, 0, 参数_高级表格., 参数_高级表格., .字体大小)
.如果真结束



 ' ******************************
 ' 用户喜欢设定模块

.子程序 _用户喜好设定按钮_被单击, 空白型, , 
.局部变量 计次变量, 整数型, , , 
.局部变量 要登录窗口, 文本型, , , 

赋值 (.现行子夹, 12) ' 显示用户喜好设定界面
赋值 (界面风格, 读配置项 (相加 (系统目录, “\系统配置.ini”), “界面”, “界面风格”, “0”))

.判断开始 (等于 (界面风格, “0”))
    赋值 (.选中, 真)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
    赋值 (.选中, 假)
.默认
    .判断开始 (等于 (界面风格, “1”))
        赋值 (.选中, 假)
        赋值 (.选中, 假)
        赋值 (.选中, 假)
        赋值 (.选中, 真)
    .默认
        .判断开始 (等于 (界面风格, “2”))
            赋值 (.选中, 假)
            赋值 (.选中, 假)
            赋值 (.选中, 真)
            赋值 (.选中, 假)
        .默认
            
            赋值 (.选中, 假)
            赋值 (.选中, 假)
            赋值 (.选中, 假)
            赋值 (.选中, 真)
            
        .判断结束
        
    .判断结束
    
.判断结束


赋值 (窗口动画有无, 读配置项 (相加 (系统目录, “\系统配置.ini”), “界面”, “窗口动画”, “1”))
.判断开始 (等于 (窗口动画有无, “1”))
    赋值 (.选中, 真)
    赋值 (.选中, 假)
.默认
    赋值 (.选中, 真)
    赋值 (.选中, 假)
.判断结束

.计次循环首 (10, 计次变量)
    赋值 (临时字体名称 [计次变量], “宋体”)
    赋值 (临时字体大小 [计次变量], “14”)
.计次循环尾 ()

赋值 (要登录窗口, 读配置项 (相加 (系统目录, “\系统配置.ini”), “界面”, “登录窗口”, “1”))
.判断开始 (等于 (要登录窗口, “1”))
    赋值 (.选中, 真)
    赋值 (.选中, 假)
.默认
    
    赋值 (.选中, 假)
    赋值 (.选中, 真)
    
.判断结束


.子程序 _超级按钮_用户喜好设定_确定_被单击, 空白型, , 
.如果真 (.选中)
    赋值 (界面风格, “0”)
.如果真结束

.如果真 (.选中)
    赋值 (界面风格, “1”)
.如果真结束

.如果真 (.选中)
    赋值 (界面风格, “2”)
.如果真结束

.如果真 (.选中)
    赋值 (界面风格, “3”)
.如果真结束

写配置项 (相加 (系统目录, “\系统配置.ini”), “界面”, “界面风格”, 界面风格)


未知支持库函数_0 (到整数 (界面风格))

.如果真 (.选中)
    赋值 (窗口动画有无, “1”)
.如果真结束

.如果真 (.选中)
    赋值 (窗口动画有无, “0”)
.如果真结束
写配置项 (相加 (系统目录, “\系统配置.ini”), “界面”, “窗口动画”, 窗口动画有无)


.子程序 _超级按钮_登录窗口类型_确定_被单击, 空白型, , 
.局部变量 要登录窗口, 文本型, , , 

.如果真 (.选中)
    赋值 (要登录窗口, “1”)
.如果真结束

.如果真 (.选中)
    赋值 (要登录窗口, “2”)
.如果真结束

写配置项 (相加 (系统目录, “\系统配置.ini”), “界面”, “登录窗口”, 要登录窗口)


.子程序 _超级按钮_用户喜好设定_取消_被单击, 空白型, , 
赋值 (.现行子夹, 0)

.子程序 _超级按钮_字体_取消_被单击, 空白型, , 
赋值 (.现行子夹, 0)


.子程序 _超级按钮_登录窗口类型_取消_被单击, 空白型, , 
赋值 (.现行子夹, 0)

.子程序 _组合框_高级表格字体设置_列表项被选择, 空白型, , 
.局部变量 字体名称, 文本型, , , 
.局部变量 字体大小, 文本型, , , 
.局部变量 现行选中项, 整数型, , , 

赋值 (现行选中项, .现行选中项)

.判断开始 (等于 (现行选中项, 0))
    赋值 (字体名称, 读配置项 (相加 (系统目录, “\系统配置.ini”), “字体名称”, “高级表格_入库录入字体”, “宋体”))
    赋值 (字体大小, 读配置项 (相加 (系统目录, “\系统配置.ini”), “字体大小”, “高级表格_入库录入字体”, “14”))
.默认
    .判断开始 (等于 (现行选中项, 1))
        赋值 (字体名称, 读配置项 (相加 (系统目录, “\系统配置.ini”), “字体名称”, “高级表格_出库录入字体”, “宋体”))
        赋值 (字体大小, 读配置项 (相加 (系统目录, “\系统配置.ini”), “字体大小”, “高级表格_出库录入字体”, “14”))
    .默认
        .判断开始 (等于 (现行选中项, 2))
            赋值 (字体名称, 读配置项 (相加 (系统目录, “\系统配置.ini”), “字体名称”, “高级表格_入库查询字体”, “宋体”))
            赋值 (字体大小, 读配置项 (相加 (系统目录, “\系统配置.ini”), “字体大小”, “高级表格_入库查询字体”, “14”))
        .默认
            .判断开始 (等于 (现行选中项, 3))
                赋值 (字体名称, 读配置项 (相加 (系统目录, “\系统配置.ini”), “字体名称”, “高级表格_出库查询字体”, “宋体”))
                赋值 (字体大小, 读配置项 (相加 (系统目录, “\系统配置.ini”), “字体大小”, “高级表格_出库查询字体”, “14”))
            .默认
                .判断开始 (等于 (现行选中项, 4))
                    赋值 (字体名称, 读配置项 (相加 (系统目录, “\系统配置.ini”), “字体名称”, “高级表格_入库统计字体”, “宋体”))
                    赋值 (字体大小, 读配置项 (相加 (系统目录, “\系统配置.ini”), “字体大小”, “高级表格_入库统计字体”, “14”))
                .默认
                    .判断开始 (等于 (现行选中项, 5))
                        赋值 (字体名称, 读配置项 (相加 (系统目录, “\系统配置.ini”), “字体名称”, “高级表格_出库统计字体”, “宋体”))
                        赋值 (字体大小, 读配置项 (相加 (系统目录, “\系统配置.ini”), “字体大小”, “高级表格_出库统计字体”, “14”))
                    .默认
                        .判断开始 (等于 (现行选中项, 6))
                            赋值 (字体名称, 读配置项 (相加 (系统目录, “\系统配置.ini”), “字体名称”, “高级表格_快递公司字体”, “宋体”))
                            赋值 (字体大小, 读配置项 (相加 (系统目录, “\系统配置.ini”), “字体大小”, “高级表格_快递公司字体”, “14”))
                        .默认
                            .判断开始 (等于 (现行选中项, 7))
                                赋值 (字体名称, 读配置项 (相加 (系统目录, “\系统配置.ini”), “字体名称”, “高级表格_客户字体”, “宋体”))
                                赋值 (字体大小, 读配置项 (相加 (系统目录, “\系统配置.ini”), “字体大小”, “高级表格_客户字体”, “14”))
                            .默认
                                .判断开始 (等于 (现行选中项, 8))
                                    赋值 (字体名称, 读配置项 (相加 (系统目录, “\系统配置.ini”), “字体名称”, “高级表格_供应商字体”, “宋体”))
                                    赋值 (字体大小, 读配置项 (相加 (系统目录, “\系统配置.ini”), “字体大小”, “高级表格_供应商字体”, “14”))
                                .默认
                                    .判断开始 (等于 (现行选中项, 9))
                                        赋值 (字体名称, 读配置项 (相加 (系统目录, “\系统配置.ini”), “字体名称”, “高级表格_操作员管理字体”, “宋体”))
                                        赋值 (字体大小, 读配置项 (相加 (系统目录, “\系统配置.ini”), “字体大小”, “高级表格_操作员管理字体”, “14”))
                                    .默认
                                         ' 本源码来自易语言资源网(www.wodesoft.com)
                                    .判断结束
                                    
                                .判断结束
                                
                            .判断结束
                            
                        .判断结束
                        
                    .判断结束
                    
                    
                    
                    
                    
                    
                .判断结束
                
            .判断结束
            
        .判断结束
        
    .判断结束
    
.判断结束

赋值 (.内容, 相加 (字体名称, “，”, 字体大小))

.子程序 _图形按钮_字体设置_被单击, 空白型, , 
.局部变量 字体名称, 文本型, , , 
.局部变量 字体大小, 整数型, , , 

.如果真 (打开 ())
    赋值 (字体名称, .字体名称)
    赋值 (字体大小, .字体大小)
    赋值 (.内容, 相加 (字体名称, “，”, 到文本 (字体大小)))
.如果真结束

赋值 (临时字体名称 [相加 (.现行选中项, 1)], 字体名称)
赋值 (临时字体大小 [相加 (.现行选中项, 1)], 到文本 (字体大小))


.子程序 _超级按钮_字体_确定_被单击, 空白型, , 
写配置项 (相加 (系统目录, “\系统配置.ini”), “字体名称”, “高级表格_入库录入字体”, 临时字体名称 [1])
写配置项 (相加 (系统目录, “\系统配置.ini”), “字体大小”, “高级表格_入库录入字体”, 临时字体大小 [1])

写配置项 (相加 (系统目录, “\系统配置.ini”), “字体名称”, “高级表格_出库录入字体”, 临时字体名称 [2])
写配置项 (相加 (系统目录, “\系统配置.ini”), “字体大小”, “高级表格_出库录入字体”, 临时字体大小 [2])


写配置项 (相加 (系统目录, “\系统配置.ini”), “字体名称”, “高级表格_入库查询字体”, 临时字体名称 [3])
写配置项 (相加 (系统目录, “\系统配置.ini”), “字体大小”, “高级表格_入库查询字体”, 临时字体大小 [3])


写配置项 (相加 (系统目录, “\系统配置.ini”), “字体名称”, “高级表格_出库查询字体”, 临时字体名称 [4])
写配置项 (相加 (系统目录, “\系统配置.ini”), “字体大小”, “高级表格_出库查询字体”, 临时字体大小 [4])

写配置项 (相加 (系统目录, “\系统配置.ini”), “字体名称”, “高级表格_入库统计字体”, 临时字体名称 [5])
写配置项 (相加 (系统目录, “\系统配置.ini”), “字体大小”, “高级表格_入库统计字体”, 临时字体大小 [5])

写配置项 (相加 (系统目录, “\系统配置.ini”), “字体名称”, “高级表格_出库统计字体”, 临时字体名称 [6])
写配置项 (相加 (系统目录, “\系统配置.ini”), “字体大小”, “高级表格_出库统计字体”, 临时字体大小 [6])


写配置项 (相加 (系统目录, “\系统配置.ini”), “字体名称”, “高级表格_快递公司字体”, 临时字体名称 [7])
写配置项 (相加 (系统目录, “\系统配置.ini”), “字体大小”, “高级表格_快递公司字体”, 临时字体大小 [7])


写配置项 (相加 (系统目录, “\系统配置.ini”), “字体名称”, “高级表格_客户字体”, 临时字体名称 [8])
写配置项 (相加 (系统目录, “\系统配置.ini”), “字体大小”, “高级表格_客户字体”, 临时字体大小 [8])
 ' 本源码来自易语言资源网(www.wodesoft.com)

写配置项 (相加 (系统目录, “\系统配置.ini”), “字体名称”, “高级表格_供应商字体”, 临时字体名称 [9])
写配置项 (相加 (系统目录, “\系统配置.ini”), “字体大小”, “高级表格_供应商字体”, 临时字体大小 [9])


写配置项 (相加 (系统目录, “\系统配置.ini”), “字体名称”, “高级表格_操作员管理字体”, 临时字体名称 [10])
写配置项 (相加 (系统目录, “\系统配置.ini”), “字体大小”, “高级表格_操作员管理字体”, 临时字体大小 [10])


.窗口程序集 关于窗口程序集, , , 

.子程序 _关于窗口_创建完毕, 空白型, , 
 ' ---------------------------------------------------------------------
 ' 本程序窗口通过读取启动窗口中的注册信息来确定注册的用户名和注册情况
 ' ---------------------------------------------------------------------
赋值 (.内容, 读配置项 (相加 (系统目录, “\注册信息.ini”), “注册信息”, “注册用户”, ))
赋值 (.内容, 选择 (检测硬盘特征字 (), “已注册”, “未注册”))

.子程序 _超级链接框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 


赋值 (.电子信箱地址, “zjgrd888@126.com?cc=ladysa@sohu.com.com&bcc=zjgrd888@hotmail.com&subject=关于毛纱管理系统的使用建议！&body=邮件正文内容：”) ' ＋ 编辑框1.内容 :注这里加上编辑框的话就可以转行了
跳转 ()

.窗口程序集 登录窗口程序集, , , 

.程序集变量 旧用户名, 文本型, , , 
.子程序 _取消钮_被单击, 空白型, , 
动画显隐窗口 (登录窗口, 假)
.判断开始 (等于 (未登录, 真))
    结束 ()
.默认
    登录窗口.销毁 ()
.判断结束



.子程序 _确定钮_被单击, 空白型, , 
赋值 (旧用户名, 用户名称)
.如果真 (等于 (.内容, “”))
    信息框 (“请输入登录系统的用户名和密码！”, 64, #提示文字)
    获取焦点 ()
    返回 ()
.如果真结束


.如果真 (是否有用户 (_启动窗口., 相加 (“select * from ”, #常量_操作员表, “ where 用户名称='”, 删全部空 (.内容), “'”)))
    .如果 (等于 (删全部空 (.内容), 用户名称))
        .如果 (等于 (操作员密码处理 (删全部空 (.内容)), 用户密码))
            赋值 (这次登录时间, 到文本 (取现行时间 ()))
            .如果 (等于 (更新登录用户信息 (_启动窗口., 相加 (“update ”, #常量_操作员表, “ set 这次登录时间='”, 这次登录时间, “',上次登录时间='”, 这次登录时间, “',总登录次数='”, 到文本 (相加 (总登录次数, 1)), “',已登录='”, “1”, “' where 用户名称='”, 删全部空 (.内容), “'”)), 真))
                .如果真 (等于 (未登录, 假))
                    更新登录情况 (旧用户名)
                     ' 按日期自动备份 ()
                .如果真结束
                
                销毁 () ' 密码也正确的话。销毁登录窗口，进入主界面窗口,既_启动窗口
            .否则
                信息框 (“出错”, 0, )
                结束 ()
            .如果结束
            
        .否则
            信息框 (“用户密码错误！”, 64, #提示文字)
            返回 ()
        .如果结束
        
    .否则
        信息框 (“用户名称错误！”, 64, #提示文字)
        返回 ()
    .如果结束
    
.如果真结束




.子程序 _登录窗口_创建完毕, 空白型, , 
赋值 (窗口动画有无, 读配置项 (相加 (系统目录, “\系统配置.ini”), “界面”, “窗口动画”, “1”))
.如果真 (等于 (窗口动画有无, “1”))
    动画显隐窗口 (登录窗口, 真)
.如果真结束
赋值 (界面风格, 读配置项 (相加 (系统目录, “\系统配置.ini”), “界面”, “界面风格”, “0”))
未知支持库函数_0 (到整数 (界面风格))
赋值 (., _启动窗口.)
赋值 (登录图路径, “”)
显示用户 (_启动窗口., , 相加 (“select * from ”, #常量_操作员表))
 ' 用户组框.现行选中项 ＝ 0

.子程序 显示用户, 逻辑型, , 
.参数 参数_外部数据库, 外部数据库, , 
.参数 参数_组合框, 组合框, , 
.参数 参数_SQL语句, 文本型, , 要查询的SQL语句

.局部变量 句柄, 整数型, , , 
.局部变量 临时用户名称, 文本型, , , 

赋值 (句柄, 参数_外部数据库.查询 (参数_SQL语句))
.如果真 (等于 (句柄, 0))
    返回 (假)
.如果真结束

 ' 参数_外部数据库.到首记录 (句柄)
.判断循环首 (等于 (参数_外部数据库.尾记录后 (句柄), 假))
    
    赋值 (临时用户名称, 参数_外部数据库.读 (句柄, “用户名称”))
    参数_组合框.加入项目 (临时用户名称, )
    赋值 (参数_组合框.内容, 临时用户名称)
    
    参数_外部数据库.到后一记录 (句柄)
.判断循环尾 ()

参数_外部数据库.关闭记录集 (句柄)

返回 (真)

.子程序 _用户组框_列表项被选择, 空白型, , 
 ' 旧用户名 ＝ 用户名称
获取焦点 ()

.子程序 _登录窗口_可否被关闭, 逻辑型, , 
 ' .如果真 (不等于 (用户名称, “”))
     ' 返回 (真)
.如果真结束
返回 (假)


.子程序 _用户组框_编辑内容被改变, 空白型, , 
 ' 旧用户名 ＝ 用户名称


.程序集 出库录入程序集, , , 

.子程序 生成装箱单编号, 文本型, , 
.局部变量 新编号, 文本型, , , 
.局部变量 年份, 文本型, , , 
.局部变量 要的数字部分, 文本型, , , 
.局部变量 SQL_查询, 文本型, , , 
.局部变量 数据库句柄, 整数型, , , 
.局部变量 旧编号, 文本型, , , 

 ' --------------------------------------
 ' 装箱单编号生成规则是：形如,LHS-09-00001
 ' --------------------------------------

赋值 (SQL_查询, 相加 (“select * from ”, #常量_出库表))

赋值 (数据库句柄, _启动窗口.查询 (., SQL_查询))

.如果 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_出库表, “查询失败!”), #错误图标, #提示文字)
    返回 (“”)
.否则
    _启动窗口.到尾记录 (., 数据库句柄)
    赋值 (旧编号, 删首空 (_启动窗口.读 (., 数据库句柄, “编号”)))
.如果结束

_启动窗口.关闭记录集 (., ) ' 关闭所有记录集


赋值 (新编号, “LHS-”)
赋值 (年份, 取文本右边 (到文本 (取年份 (取现行时间 ())), 2)) ' 得到形如 "09"字样
.如果 (等于 (取文本中间 (旧编号, 5, 2), 年份)) ' 如果最后一次装箱单的编号是当前年份，则取:形如LHS-09-00001中的001部分
    赋值 (要的数字部分, 取文本右边 (旧编号, 5))
    赋值 (新编号, 相加 (新编号, 年份, “-”, 编号长度保证 (要的数字部分))) ' +取出数据库中装箱单编号中本年最后一次编号，再加上1，得到本年这次装箱单新的编号.....编号为XXXXX的五位数字
.否则
    赋值 (新编号, 相加 (新编号, 年份, “-”, “00001”)) ' 否则的话就以当前年份重新编排编号
.如果结束

返回 (新编号)


.子程序 编号长度保证, 文本型, , 
.参数 参数_原文本, 文本型, , 

.局部变量 临时文本变量, 文本型, , , 
.局部变量 临时文本长度, 整数型, , , 
.局部变量 返回文本, 文本型, , , 

赋值 (临时文本变量, 到文本 (相加 (到数值 (参数_原文本), 1)))
赋值 (临时文本长度, 取文本长度 (临时文本变量))
赋值 (返回文本, 多项选择 (临时文本长度, 相加 (“0000”, 临时文本变量), 相加 (“000”, 临时文本变量), 相加 (“00”, 临时文本变量), 相加 (“0”, 临时文本变量), 临时文本变量))
返回 (返回文本)



.子程序 生成出库金额, 空白型, , 
赋值 (_启动窗口..内容, 到文本 (相乘 (到整数 (删首空 (_启动窗口..内容)), 到小数 (删首空 (_启动窗口..内容)))))


.子程序 设置默认出库表单格式, 空白型, , 
.局部变量 公司中文标题, 文本型, , , 
.局部变量 公司英文标题, 文本型, , , 
.局部变量 公司中文地址, 文本型, , , 
.局部变量 公司英文地址, 文本型, , , 
.局部变量 公司电话及传真, 文本型, , , 


赋值 (公司中文标题, 读配置项 (相加 (系统目录, “\系统配置.ini”), “公司信息”, “公司中文名称”, “”))
赋值 (公司英文标题, 读配置项 (相加 (系统目录, “\系统配置.ini”), “公司信息”, “公司英文名称”, “”))
赋值 (公司中文地址, 读配置项 (相加 (系统目录, “\系统配置.ini”), “公司信息”, “公司中文地址”, “”))
赋值 (公司英文地址, 读配置项 (相加 (系统目录, “\系统配置.ini”), “公司信息”, “公司英文地址”, “”))
赋值 (公司电话及传真, 相加 (“TEL：”, 读配置项 (相加 (系统目录, “\系统配置.ini”), “公司信息”, “公司电话”, “”), “ FAX：”, 读配置项 (相加 (系统目录, “\系统配置.ini”), “公司信息”, “公司传真”, “”)))

_启动窗口.从字节集读 (., #出库_表头模版)

添加表模版 (#出库_表中模板_竖向)
添加表模版 (#出库_表尾模板)


.子程序 添加表模版, 空白型, , 
.参数 表格模板, 字节集, , 

.如果 (等于 (_启动窗口.从字节集读 (., 表格模板), 假)) ' 数据源_出库_添加表格模版仅在此处使用
    信息框 (“打开欲添加模板失败！”, #错误图标, #提示文字)
.否则
    _启动窗口.添加 (., _启动窗口., , )
    _启动窗口.初始尺寸 (., 1, 1) ' 因为使用的是通用提供者_出库_添加表格模版,所以可以初始化尺寸.在此处清除通用提供者_出库_添加表格模版内的数据.
.如果结束


 ' ************************************
 ' 保存出库数据到数据库

.子程序 保存出库数据到数据库, 空白型, , 
.局部变量 SQL查询, 文本型, , , 
.局部变量 匿名局部变量_1006, 空白型, , , 
.局部变量 日期, 文本型, , , 
.局部变量 编号, 文本型, , , 
.局部变量 客户, 文本型, , , 
.局部变量 经手人, 文本型, , , 
.局部变量 匿名局部变量_1012, 空白型, , , 
.局部变量 客户订单号, 文本型, , , 
.局部变量 纱号, 文本型, , , 
.局部变量 支数, 文本型, , , 
.局部变量 成份, 文本型, , , 
.局部变量 色号, 文本型, , , 
.局部变量 颜色, 文本型, , , 
.局部变量 缸号, 文本型, , , 
.局部变量 单价, 文本型, , , 
.局部变量 数量, 文本型, , , 
.局部变量 金额, 文本型, , , 
.局部变量 快递公司, 文本型, , , 
.局部变量 快递单号, 文本型, , , 
.局部变量 件数, 文本型, , , 
.局部变量 运费, 文本型, , , 
.局部变量 出库单号, 文本型, , , 
.局部变量 匿名局部变量_2514, 空白型, , , 
.局部变量 成功, 逻辑型, , , 
.局部变量 要保存出库数据, 逻辑型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 数据库句柄, 整数型, , , 
.局部变量 累计变量, 整数型, , , 
.局部变量 运费币种, 文本型, , , 
.局部变量 金额币种, 文本型, , , 
.局部变量 数量称量, 文本型, , , 
.局部变量 单价币种, 文本型, , , 
.局部变量 库存记录总数, 整数型, , , 

赋值 (日期, 子文本替换 (_启动窗口..内容, “.”, “-”, 1, 2, 真))
赋值 (编号, 删首尾空 (_启动窗口..内容))

赋值 (客户, 删首空 (_启动窗口..内容))
.如果真 (等于 (客户, “”))
    信息框 (“客户不能为空！”, 0, #提示文字)
    _启动窗口.获取焦点 (.)
    返回 ()
.如果真结束

赋值 (经手人, 删首空 (_启动窗口..内容))
.如果真 (等于 (经手人, “”))
    信息框 (“经手人不能为空！”, 0, #提示文字)
    _启动窗口.获取焦点 (.)
    返回 ()
.如果真结束

赋值 (客户订单号, 删首空 (_启动窗口..内容))
.如果真 (等于 (客户订单号, “”))
    信息框 (“客户订单号不能为空！”, 0, #提示文字)
    _启动窗口.获取焦点 (.)
    返回 ()
.如果真结束

赋值 (纱号, 删首空 (_启动窗口..内容))
.如果真 (等于 (纱号, “”))
    信息框 (“纱号不能为空！”, 0, #提示文字)
    _启动窗口.获取焦点 (.)
    返回 ()
.如果真结束

赋值 (支数, 删首空 (_启动窗口..内容))
.如果真 (等于 (支数, “”))
    信息框 (“支数 不能为空！”, 0, #提示文字)
    _启动窗口.获取焦点 (.)
    返回 ()
.如果真结束

赋值 (成份, 删首空 (_启动窗口..内容))
.如果真 (等于 (成份, “”))
    信息框 (“成份不能为空！”, 0, #提示文字)
    _启动窗口.获取焦点 (.)
    返回 ()
.如果真结束

赋值 (色号, 删首空 (_启动窗口..内容))
 ' .如果真 (等于 (色号, “”))
     ' 信息框 (“色号不能为空！”, 0, #提示文字)
     ' _启动窗口.编辑框_色号_出库.获取焦点 ()
     ' 返回 ()
.如果真结束

赋值 (颜色, 删首空 (_启动窗口..内容))
.如果真 (等于 (颜色, “”))
    信息框 (“颜色不能为空！”, 0, #提示文字)
    _启动窗口.获取焦点 (.)
    返回 ()
.如果真结束

赋值 (缸号, 删首空 (_启动窗口..内容))
 ' .如果真 (等于 (缸号, “”))
     ' 信息框 (“缸号不能为空！”, 0, #提示文字)
     ' _启动窗口.编辑框_缸号.获取焦点 ()
     ' 返回 ()
.如果真结束

赋值 (单价, 删首空 (_启动窗口..内容))
赋值 (单价币种, 删首空 (_启动窗口..内容))

赋值 (数量, 删首空 (_启动窗口..内容))
赋值 (数量称量, 删首空 (_启动窗口..内容))

赋值 (金额, 删首空 (_启动窗口..内容))
赋值 (金额币种, 删首空 (_启动窗口..内容))

赋值 (快递公司, 删首尾空 (_启动窗口..内容))

赋值 (快递单号, 删首空 (_启动窗口..内容))
.如果真 (等于 (快递单号, “”))
    信息框 (“快递单号不能为空！”, 0, #提示文字)
    _启动窗口.获取焦点 (.)
    返回 ()
.如果真结束

赋值 (件数, 删首空 (_启动窗口..内容))

赋值 (运费, 删首空 (_启动窗口..内容))
赋值 (运费币种, 删首空 (_启动窗口..内容))

赋值 (出库单号, 删首空 (_启动窗口..内容))
.如果真 (等于 (出库单号, “”))
    信息框 (“出库单号不能为空！”, 0, #提示文字)
    _启动窗口.获取焦点 (.)
    返回 ()
.如果真结束



.如果真 (等于 (单价, “”))
    赋值 (单价, “0”)
.如果真结束

.如果真 (等于 (数量, “”))
    赋值 (数量, “0”)
.如果真结束

.如果真 (等于 (金额, “”))
    赋值 (金额, “0”)
.如果真结束

.如果真 (等于 (件数, “”))
    赋值 (件数, “0”)
.如果真结束

.如果真 (等于 (运费, “”))
    赋值 (运费, “0”)
.如果真结束


赋值 (SQL查询, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_入库表, “ where 纱号='”, 删首尾空 (_启动窗口..内容), “' and 支数='”, 删首尾空 (_启动窗口..内容), “' and 成份='”, 删首尾空 (_启动窗口..内容), “' and 颜色='”, 删首尾空 (_启动窗口..内容), “'”))

赋值 (数据库句柄, _启动窗口.查询 (., SQL查询))
调试输出 (到文本 (数据库句柄))
.如果 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_入库表, “查询失败!”), #错误图标, #提示文字)
    返回 ()
    
.否则
    赋值 (库存记录总数, _启动窗口.读 (., 数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得
    调试输出 (到文本 (库存记录总数))
    .判断开始 (等于 (库存记录总数, 0))
        
        信息框 (相加 (“仓库中没有找到纱号为：”, _启动窗口..内容, “支数为：”, _启动窗口..内容, “成份”, _启动窗口..内容, “颜色为：”, _启动窗口..内容, “的纱！”), 64, #提示文字)
        _启动窗口.获取焦点 (.)
        返回 ()
    .默认
        
         ' -------------------------------------------------------------对出库表的操作
        赋值 (SQL查询, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_出库表, “ where 编号='”, _启动窗口..内容, “'”)) ' 功能一、获得数据库句柄。功能二、生成一个临时的字段 记录总数
        
        赋值 (数据库句柄, _启动窗口.查询 (., SQL查询))
        
        .如果 (等于 (数据库句柄, 0))
            信息框 (相加 (“数据表:”, #常量_出库表, “查询失败!”), #错误图标, #提示文字)
            返回 ()
        .否则
            
            赋值 (记录总数, _启动窗口.读 (., 数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得
            .判断开始 (等于 (记录总数, 0))
                赋值 (要保存出库数据, 真)
                .如果真 (要保存出库数据)
                    赋值 (SQL查询, 相加 (“insert into ”, #常量_出库表, “ (日期,编号,客户,经手人,客户订单号,纱号,支数,成份,色号,颜色,缸号,单价,单价币种,数量,数量称量,金额,金额币种,快递公司,快递单号,件数,运费,运费币种,出库单号) values ('”, 日期, “','”, 编号, “','”, 客户, “','”, 经手人, “','”, 客户订单号, “','”, 纱号, “','”, 支数, “','”, 成份, “','”, 色号, “','”, 颜色, “','”, 缸号, “','”, 单价, “','”, 单价币种, “','”, 数量, “','”, 数量称量, “','”, 金额, “','”, 金额币种, “','”, 快递公司, “','”, 快递单号, “','”, 件数, “','”, 运费, “','”, 运费币种, “','”, 出库单号, “')”))
                    
                    赋值 (成功, _启动窗口.执行 (., SQL查询, ))
                    
                    .如果真 (等于 (成功, 假))
                        信息框 (相加 (“数据表:”, #常量_出库表, “添加失败!”), #错误图标, #提示文字)
                        返回 ()
                    .如果真结束
                    _启动窗口.未知支持库函数_38 (., , )
                    赋值 (入库_编辑行号, 相加 (入库_编辑行号, 1))
                    _启动窗口.未知支持库函数_0 (., 入库_编辑行号, 0)
                .如果真结束
                
            .默认
                
                赋值 (SQL查询, 相加 (“update ”, #常量_出库表, “ set 日期='”, 日期, “',编号='”, 编号, “',客户='”, 客户, “',经手人='”, 经手人, “',客户订单号='”, 客户订单号, “',纱号='”, 纱号, “',支数='”, 支数, “',成份='”, 成份, “',色号='”, 色号, “',颜色='”, 颜色, “',缸号='”, 缸号, “',单价='”, 单价, “',单价币种='”, 单价币种, “',数量='”, 数量, “',数量称量='”, 数量称量, “',金额='”, 金额, “',金额币种='”, 金额币种, “',快递公司='”, 快递公司, “',快递单号='”, 快递单号, “',件数='”, 件数, “',运费 ='”, 运费, “',运费币种='”, 运费币种, “',出库单号='”, 出库单号, “' where 编号='”, _启动窗口..内容, “'”))
                
                赋值 (成功, _启动窗口.执行 (., SQL查询, ))
                .如果真 (等于 (成功, 假))
                    信息框 (相加 (“数据表:”, #常量_出库表, “更新失败!”), #错误图标, #提示文字)
                    返回 ()
                .如果真结束
                
            .判断结束
            
        .如果结束
        
        
        
        
    .判断结束
    
.如果结束










 ' -------------------------------------------------------------------------------


.子程序 通过装箱单编号得到当前其它数据, 空白型, , 
.参数 参数_外部数据库, 外部数据库, , 
.参数 参数_编号, 文本型, , 

.局部变量 SQL查询, 文本型, , , 
.局部变量 数据库句柄, 整数型, , , 
.局部变量 日期, 文本型, , , 
.局部变量 编号, 文本型, , , 
.局部变量 客户, 文本型, , , 
.局部变量 经手人, 文本型, , , 
.局部变量 客户订单号, 文本型, , , 
.局部变量 纱号, 文本型, , , 
.局部变量 支数, 文本型, , , 
.局部变量 成份, 文本型, , , 
.局部变量 色号, 文本型, , , 
.局部变量 颜色, 文本型, , , 
.局部变量 缸号, 文本型, , , 
.局部变量 单价, 文本型, , , 
.局部变量 数量, 文本型, , , 
.局部变量 金额, 文本型, , , 
.局部变量 快递公司, 文本型, , , 
.局部变量 快递单号, 文本型, , , 
.局部变量 件数, 文本型, , , 
.局部变量 运费, 文本型, , , 
.局部变量 出库单号, 文本型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 日期_日期, 日期时间型, , , 
.局部变量 单价币种, 文本型, , , 
.局部变量 数量称量, 文本型, , , 
.局部变量 运费币种, 文本型, , , 
.局部变量 金额币种, 文本型, , , 

 ' --------------------------------------
 ' 装箱单编号规则是：形如,LHS-09-00001
 ' --------------------------------------

赋值 (SQL查询, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_出库表, “ where 编号='”, 参数_编号, “'”))
赋值 (数据库句柄, 参数_外部数据库.查询 (SQL查询)) ' 功能一、获得数据库句柄。功能二、生成一个临时的字段 记录总数

.如果真 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_出库表, “查询失败!”), #错误图标, #提示文字)
    返回 ()
.如果真结束

赋值 (记录总数, 参数_外部数据库.读 (数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得

.如果真 (大于 (记录总数, 0))
    赋值 (SQL查询, 相加 (“select * from ”, #常量_出库表, “ where 编号='”, 参数_编号, “'”))
    
    赋值 (数据库句柄, 参数_外部数据库.查询 (SQL查询))
    
    .如果 (等于 (数据库句柄, 0))
        信息框 (相加 (“数据表:”, #常量_出库表, “查询失败!”), #错误图标, #提示文字)
        返回 ()
    .否则
        
        赋值 (日期, 取日期文本 (参数_外部数据库.读 (数据库句柄, “日期”)))
        赋值 (编号, 删首空 (参数_外部数据库.读 (数据库句柄, “编号”)))
        赋值 (客户, 删首空 (参数_外部数据库.读 (数据库句柄, “客户”)))
        赋值 (经手人, 删首空 (参数_外部数据库.读 (数据库句柄, “经手人”)))
        赋值 (客户订单号, 删首空 (参数_外部数据库.读 (数据库句柄, “客户订单号”)))
        赋值 (纱号, 删首空 (参数_外部数据库.读 (数据库句柄, “纱号”)))
        赋值 (支数, 删首空 (参数_外部数据库.读 (数据库句柄, “支数”)))
        赋值 (成份, 删首空 (参数_外部数据库.读 (数据库句柄, “成份”)))
        赋值 (色号, 删首空 (参数_外部数据库.读 (数据库句柄, “色号”)))
        赋值 (颜色, 删首空 (参数_外部数据库.读 (数据库句柄, “颜色”)))
        赋值 (缸号, 删首空 (参数_外部数据库.读 (数据库句柄, “缸号”)))
        
        赋值 (单价, 删首空 (参数_外部数据库.读 (数据库句柄, “单价”)))
        赋值 (单价币种, 删首空 (参数_外部数据库.读 (数据库句柄, “单价币种”)))
        
        赋值 (数量, 删首空 (参数_外部数据库.读 (数据库句柄, “数量”)))
        赋值 (数量称量, 删首空 (参数_外部数据库.读 (数据库句柄, “数量称量”)))
        
        赋值 (金额, 删首空 (参数_外部数据库.读 (数据库句柄, “金额”)))
        赋值 (金额币种, 删首空 (参数_外部数据库.读 (数据库句柄, “金额币种”)))
        
        赋值 (快递公司, 删首空 (参数_外部数据库.读 (数据库句柄, “快递公司”)))
        赋值 (快递单号, 删首空 (参数_外部数据库.读 (数据库句柄, “快递单号”)))
        赋值 (件数, 删首空 (参数_外部数据库.读 (数据库句柄, “件数”)))
        
        赋值 (运费, 删首空 (参数_外部数据库.读 (数据库句柄, “运费”)))
        赋值 (运费币种, 删首空 (参数_外部数据库.读 (数据库句柄, “运费币种”)))
        
        赋值 (出库单号, 删首空 (参数_外部数据库.读 (数据库句柄, “出库单号”)))
        
        赋值 (_启动窗口..内容, 日期)
        赋值 (_启动窗口..内容, 编号)
        赋值 (_启动窗口..内容, 客户)
        赋值 (_启动窗口..内容, 经手人)
        赋值 (_启动窗口..内容, 客户订单号)
        赋值 (_启动窗口..内容, 纱号)
        赋值 (_启动窗口..内容, 支数)
        赋值 (_启动窗口..内容, 成份)
        赋值 (_启动窗口..内容, 色号)
        赋值 (_启动窗口..内容, 颜色)
        赋值 (_启动窗口..内容, 缸号)
        
        赋值 (_启动窗口..内容, 单价)
        赋值 (_启动窗口..内容, 单价币种)
        
        赋值 (_启动窗口..内容, 数量)
        赋值 (_启动窗口..内容, 数量称量)
        
        赋值 (_启动窗口..内容, 金额)
        赋值 (_启动窗口..内容, 金额币种)
        
        赋值 (_启动窗口..内容, 快递公司)
        赋值 (_启动窗口..内容, 快递单号)
        赋值 (_启动窗口..内容, 件数)
        
        赋值 (_启动窗口..内容, 运费)
        赋值 (_启动窗口..内容, 运费币种)
        
        赋值 (_启动窗口..内容, 出库单号)
    .如果结束
    
.如果真结束



_启动窗口.关闭记录集 (., ) ' 关闭所有记录集

 ' -------------------------------------------------------------------------------


.子程序 显示所有出库数据, 空白型, , 
.参数 参数_外部数据库, 外部数据库, , 
.参数 参数_高级表格, 未知类型0x50001, , 

.局部变量 数据库句柄, 整数型, , , 
.局部变量 SQL查询1, 文本型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 计次变量, 整数型, , , 
.局部变量 SQL_查询2, 文本型, , , 
.局部变量 日期, 文本型, , , 
.局部变量 编号, 文本型, , , 
.局部变量 客户, 文本型, , , 
.局部变量 经手人, 文本型, , , 
.局部变量 客户订单号, 文本型, , , 
.局部变量 纱号, 文本型, , , 
.局部变量 支数, 文本型, , , 
.局部变量 成份, 文本型, , , 
.局部变量 色号, 文本型, , , 
.局部变量 颜色, 文本型, , , 
.局部变量 缸号, 文本型, , , 
.局部变量 单价, 文本型, , , 
.局部变量 数量, 文本型, , , 
.局部变量 金额, 文本型, , , 
.局部变量 快递公司, 文本型, , , 
.局部变量 快递单号, 文本型, , , 
.局部变量 件数, 文本型, , , 
.局部变量 运费, 文本型, , , 
.局部变量 出库单号, 文本型, , , 
.局部变量 日期_日期, 日期时间型, , , 
.局部变量 单价币种, 文本型, , , 
.局部变量 数量称量, 文本型, , , 
.局部变量 金额币种, 文本型, , , 
.局部变量 运费币种, 文本型, , , 



赋值 (SQL查询1, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_出库表))
赋值 (数据库句柄, 参数_外部数据库.查询 (SQL查询1)) ' 功能一、获得数据库句柄。功能二、生成一个临时的字段 记录总数

.如果真 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_出库表, “查询失败!”), #错误图标, #提示文字)
    返回 ()
.如果真结束

赋值 (记录总数, 参数_外部数据库.读 (数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得
 ' 调试输出 (到文本 (记录总数))
 ' ---------------------------------------------------------------
赋值 (SQL_查询2, 相加 (“select * from ”, #常量_出库表))
赋值 (数据库句柄, 参数_外部数据库.查询 (SQL_查询2))

参数_外部数据库.到首记录 (数据库句柄)
.计次循环首 (记录总数, 计次变量)
    
    赋值 (日期, 取日期文本 (参数_外部数据库.读 (数据库句柄, “日期”)))
    
    赋值 (编号, 删首空 (参数_外部数据库.读 (数据库句柄, “编号”)))
    赋值 (客户, 删首空 (参数_外部数据库.读 (数据库句柄, “客户”)))
    赋值 (经手人, 删首空 (参数_外部数据库.读 (数据库句柄, “经手人”)))
    赋值 (客户订单号, 删首空 (参数_外部数据库.读 (数据库句柄, “客户订单号”)))
    赋值 (纱号, 删首空 (参数_外部数据库.读 (数据库句柄, “纱号”)))
    赋值 (支数, 删首空 (参数_外部数据库.读 (数据库句柄, “支数”)))
    赋值 (成份, 删首空 (参数_外部数据库.读 (数据库句柄, “成份”)))
    赋值 (色号, 删首空 (参数_外部数据库.读 (数据库句柄, “色号”)))
    赋值 (颜色, 删首空 (参数_外部数据库.读 (数据库句柄, “颜色”)))
    赋值 (缸号, 删首空 (参数_外部数据库.读 (数据库句柄, “缸号”)))
    
    赋值 (单价, 删首空 (参数_外部数据库.读 (数据库句柄, “单价”)))
    赋值 (单价币种, 删首空 (参数_外部数据库.读 (数据库句柄, “单价币种”)))
    
    赋值 (数量, 删首空 (参数_外部数据库.读 (数据库句柄, “数量”)))
    赋值 (数量称量, 删首空 (参数_外部数据库.读 (数据库句柄, “数量称量”)))
    
    赋值 (金额, 删首空 (参数_外部数据库.读 (数据库句柄, “金额”)))
    赋值 (金额币种, 删首空 (参数_外部数据库.读 (数据库句柄, “金额币种”)))
    
    赋值 (快递公司, 删首空 (参数_外部数据库.读 (数据库句柄, “快递公司”)))
    赋值 (快递单号, 删首空 (参数_外部数据库.读 (数据库句柄, “快递单号”)))
    赋值 (件数, 删首空 (参数_外部数据库.读 (数据库句柄, “件数”)))
    
    赋值 (运费, 删首空 (参数_外部数据库.读 (数据库句柄, “运费”)))
    赋值 (运费币种, 删首空 (参数_外部数据库.读 (数据库句柄, “运费币种”)))
    
    赋值 (出库单号, 删首空 (参数_外部数据库.读 (数据库句柄, “出库单号”)))
    
    参数_高级表格.未知支持库函数_38 ()
    
    参数_高级表格.未知支持库函数_9 (计次变量, 0, #., 日期)
    参数_高级表格.未知支持库函数_9 (计次变量, 1, #., 编号)
    参数_高级表格.未知支持库函数_9 (计次变量, 2, #., 客户)
    参数_高级表格.未知支持库函数_9 (计次变量, 3, #., 经手人)
    参数_高级表格.未知支持库函数_9 (计次变量, 4, #., 客户订单号)
    参数_高级表格.未知支持库函数_9 (计次变量, 5, #., 纱号)
    参数_高级表格.未知支持库函数_9 (计次变量, 6, #., 支数)
    参数_高级表格.未知支持库函数_9 (计次变量, 7, #., 成份)
    参数_高级表格.未知支持库函数_9 (计次变量, 8, #., 色号)
    参数_高级表格.未知支持库函数_9 (计次变量, 9, #., 颜色)
    参数_高级表格.未知支持库函数_9 (计次变量, 10, #., 缸号)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 11, #., 单价)
    参数_高级表格.未知支持库函数_9 (计次变量, 12, #., 单价币种)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 13, #., 数量)
    参数_高级表格.未知支持库函数_9 (计次变量, 14, #., 数量称量)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 15, #., 金额)
    参数_高级表格.未知支持库函数_9 (计次变量, 16, #., 金额币种)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 17, #., 快递公司)
    参数_高级表格.未知支持库函数_9 (计次变量, 18, #., 快递单号)
    参数_高级表格.未知支持库函数_9 (计次变量, 19, #., 件数)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 20, #., 运费)
    参数_高级表格.未知支持库函数_9 (计次变量, 21, #., 运费币种)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 22, #., 出库单号)
    
    参数_外部数据库.到后一记录 (数据库句柄)
.计次循环尾 ()
参数_高级表格.未知支持库函数_38 ()
参数_高级表格.未知支持库函数_0 (相减 (参数_高级表格., 1), 0)
参数_外部数据库.关闭记录集 (数据库句柄)


 ' -------------------------------------------------------------------------------


.子程序 高级表格_出库_内容被改变, 空白型, , 
高级表格_日期_出库_内容被改变 ()
高级表格_编号_内容被改变 ()
高级表格_公司客户_内容被改变 ()
高级表格_经手人_内容被改变 ()
高级表格_客户订单号_内容被改变 ()
高级表格_纱号_出库_内容被改变 ()
高级表格_支数_出库_内容被改变 ()
高级表格_成份_出库_内容被改变 ()
高级表格_色号_出库_内容被改变 ()
高级表格_颜色_出库_内容被改变 ()
高级表格_缸号_出库_内容被改变 ()

高级表格_单价_币种_内容被改变 ()
高级表格_单价_出库_内容被改变 ()

高级表格_出库数量_内容被改变 ()
高级表格_出库数量_称量_内容被改变 ()

高级表格_金额_出库_内容被改变 ()
高级表格_金额_币种_内容被改变 ()

高级表格_快递公司_内容被改变 ()
高级表格_快递单号_内容被改变 ()
高级表格_件数_内容被改变 ()

高级表格_运费_内容被改变 ()
高级表格_运费_币种_内容被改变 ()
高级表格_出库单号_内容被改变 ()


.子程序 高级表格_日期_出库_内容被改变, 空白型, , 

_启动窗口.未知支持库函数_9 (., 出库_编辑行号, 0, #., _启动窗口..内容)

.子程序 高级表格_编号_内容被改变, 空白型, , 

_启动窗口.未知支持库函数_9 (., 出库_编辑行号, 1, #., _启动窗口..内容)

.子程序 高级表格_公司客户_内容被改变, 空白型, , 

_启动窗口.未知支持库函数_9 (., 出库_编辑行号, 2, #., _启动窗口..内容)

.子程序 高级表格_经手人_内容被改变, 空白型, , 

_启动窗口.未知支持库函数_9 (., 出库_编辑行号, 3, #., _启动窗口..内容)

.子程序 高级表格_客户订单号_内容被改变, 空白型, , 

_启动窗口.未知支持库函数_9 (., 出库_编辑行号, 4, #., _启动窗口..内容)

.子程序 高级表格_纱号_出库_内容被改变, 空白型, , 

_启动窗口.未知支持库函数_9 (., 出库_编辑行号, 5, #., _启动窗口..内容)

.子程序 高级表格_支数_出库_内容被改变, 空白型, , 

_启动窗口.未知支持库函数_9 (., 出库_编辑行号, 6, #., _启动窗口..内容)

.子程序 高级表格_成份_出库_内容被改变, 空白型, , 

_启动窗口.未知支持库函数_9 (., 出库_编辑行号, 7, #., _启动窗口..内容)

.子程序 高级表格_色号_出库_内容被改变, 空白型, , 

_启动窗口.未知支持库函数_9 (., 出库_编辑行号, 8, #., _启动窗口..内容)

.子程序 高级表格_颜色_出库_内容被改变, 空白型, , 

_启动窗口.未知支持库函数_9 (., 出库_编辑行号, 9, #., _启动窗口..内容)

.子程序 高级表格_缸号_出库_内容被改变, 空白型, , 

_启动窗口.未知支持库函数_9 (., 出库_编辑行号, 10, #., _启动窗口..内容)


.子程序 高级表格_单价_出库_内容被改变, 空白型, , 

_启动窗口.未知支持库函数_9 (., 出库_编辑行号, 11, #., _启动窗口..内容)

.子程序 高级表格_单价_币种_内容被改变, 空白型, , 

_启动窗口.未知支持库函数_9 (., 出库_编辑行号, 12, #., _启动窗口..内容)


.子程序 高级表格_出库数量_内容被改变, 空白型, , 

_启动窗口.未知支持库函数_9 (., 出库_编辑行号, 13, #., _启动窗口..内容)

.子程序 高级表格_出库数量_称量_内容被改变, 空白型, , 

_启动窗口.未知支持库函数_9 (., 出库_编辑行号, 14, #., _启动窗口..内容)


.子程序 高级表格_金额_出库_内容被改变, 空白型, , 

_启动窗口.未知支持库函数_9 (., 出库_编辑行号, 15, #., _启动窗口..内容)

.子程序 高级表格_金额_币种_内容被改变, 空白型, , 

_启动窗口.未知支持库函数_9 (., 出库_编辑行号, 16, #., _启动窗口..内容)


.子程序 高级表格_快递公司_内容被改变, 空白型, , 
_启动窗口.未知支持库函数_9 (., 出库_编辑行号, 17, #., _启动窗口..内容)

.子程序 高级表格_快递单号_内容被改变, 空白型, , 

_启动窗口.未知支持库函数_9 (., 出库_编辑行号, 18, #., _启动窗口..内容)

.子程序 高级表格_件数_内容被改变, 空白型, , 

_启动窗口.未知支持库函数_9 (., 出库_编辑行号, 19, #., _启动窗口..内容)

.子程序 高级表格_运费_内容被改变, 空白型, , 

_启动窗口.未知支持库函数_9 (., 出库_编辑行号, 20, #., _启动窗口..内容)

.子程序 高级表格_运费_币种_内容被改变, 空白型, , 

_启动窗口.未知支持库函数_9 (., 出库_编辑行号, 21, #., _启动窗口..内容)

.子程序 高级表格_出库单号_内容被改变, 空白型, , 

_启动窗口.未知支持库函数_9 (., 出库_编辑行号, 22, #., _启动窗口..内容)

 ' -------------------------------------------------------------------------------

.窗口程序集 生成装箱单窗口程序集, , , 

.子程序 _超级按钮_生成装箱单_确定_被单击, 空白型, , 
生成装箱单 ()
销毁 ()

.子程序 _超级按钮_生成装箱单_取消_被单击, 空白型, , 
销毁 ()


.子程序 生成装箱单, 空白型, , 
.局部变量 公司中文标题, 文本型, , , 
.局部变量 公司英文标题, 文本型, , , 
.局部变量 公司中文地址, 文本型, , , 
.局部变量 公司英文地址, 文本型, , , 
.局部变量 公司电话及传真, 文本型, , , 
.局部变量 数据库句柄, 整数型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 日期, 文本型, , , 
.局部变量 编号, 文本型, , , 
.局部变量 客户订单号, 文本型, , , 
.局部变量 经手人, 文本型, , , 
.局部变量 客户, 文本型, , , 
.局部变量 纱号, 文本型, , , 
.局部变量 支数, 文本型, , , 
.局部变量 SQL_查询2, 文本型, , , 
.局部变量 成份, 文本型, , , 
.局部变量 色号, 文本型, , , 
.局部变量 颜色, 文本型, , , 
.局部变量 缸号, 文本型, , , 
.局部变量 单价, 文本型, , , 
.局部变量 数量, 文本型, , , 
.局部变量 金额, 文本型, , , 
.局部变量 表头行数, 整数型, , , 
.局部变量 SQL_查询1, 文本型, , , 
.局部变量 累计金额, 小数型, , , 
.局部变量 运费, 文本型, , , 
.局部变量 件数, 文本型, , , 
.局部变量 累计运费, 小数型, , , 
.局部变量 累计件数, 整数型, , , 
.局部变量 快递单号, 文本型, , , 
.局部变量 临时快递单号, 文本型, , , 
.局部变量 快递公司, 文本型, , , 
.局部变量 查询条件, 文本型, , , 
.局部变量 累计数量, 整数型, , , 
.局部变量 临时快递公司, 文本型, , , 
.局部变量 表格宽度, 整数型, , , 
.局部变量 左空格个数1, 整数型, , , 
.局部变量 右空格个数1, 整数型, , , 
.局部变量 空格个数, 整数型, , , 
.局部变量 数量称量, 文本型, , , 
.局部变量 单价币种, 文本型, , , 

赋值 (_启动窗口.., 假)
 ' ----------------------------
赋值 (公司中文标题, 读配置项 (相加 (系统目录, “\系统配置.ini”), “公司信息”, “公司中文名称”, “”))
赋值 (公司英文标题, 读配置项 (相加 (系统目录, “\系统配置.ini”), “公司信息”, “公司英文名称”, “”))
赋值 (公司中文地址, 读配置项 (相加 (系统目录, “\系统配置.ini”), “公司信息”, “公司中文地址”, “”))
赋值 (公司英文地址, 读配置项 (相加 (系统目录, “\系统配置.ini”), “公司信息”, “公司英文地址”, “”))
赋值 (公司电话及传真, 相加 (“TEL：”, 读配置项 (相加 (系统目录, “\系统配置.ini”), “公司信息”, “公司电话”, “”), “ FAX：”, 读配置项 (相加 (系统目录, “\系统配置.ini”), “公司信息”, “公司传真”, “”)))


_启动窗口.从字节集读 (., #出库_表头模版)
_启动窗口.置文本 (., 1, 1, 公司中文标题)
_启动窗口.置文本 (., 2, 1, 公司英文标题)
_启动窗口.置文本 (., 3, 1, 公司中文地址)
_启动窗口.置文本 (., 4, 1, 公司英文地址)
_启动窗口.置文本 (., 5, 1, 公司电话及传真)




赋值 (表头行数, _启动窗口.取行数 (.))

赋值 (查询条件, 相加 (“ where (编号='”, 窗口_生成装箱单..内容, “')”))

赋值 (SQL_查询1, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_出库表, 查询条件))
赋值 (数据库句柄, _启动窗口.查询 (., SQL_查询1)) ' 功能一、获得数据库句柄。功能二、生成一个临时的字段 记录总数

.如果 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_出库表, “查询失败!”), #错误图标, #提示文字)
    返回 ()
.否则
    赋值 (记录总数, _启动窗口.读 (., 数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得
    
    .如果 (等于 (记录总数, 0))
        信息框 (“没有找到你要的装箱单记录！”, 0, #提示文字)
        返回 ()
    .否则
         ' ---------------------------------------------------------------
        
        赋值 (SQL_查询2, 相加 (“select * from ”, #常量_出库表, 查询条件))
        
        赋值 (数据库句柄, _启动窗口.查询 (., SQL_查询2))
        
        _启动窗口.到首记录 (., 数据库句柄)
        
        
        赋值 (日期, 取日期文本 (_启动窗口.读 (., 数据库句柄, “日期”)))
        赋值 (编号, _启动窗口.读 (., 数据库句柄, “编号”))
        赋值 (客户, _启动窗口.读 (., 数据库句柄, “客户”))
        赋值 (经手人, _启动窗口.读 (., 数据库句柄, “经手人”))
        赋值 (客户订单号, _启动窗口.读 (., 数据库句柄, “客户订单号”))
        
        
        赋值 (表格宽度, 80)
        
        赋值 (左空格个数1, 相减 (相除 (相减 (表格宽度, 取文本长度 (相加 (“客户订单号：”, 客户订单号))), 2), 取文本长度 (相加 (“客户：”, 客户))))
        赋值 (右空格个数1, 相减 (相除 (相减 (表格宽度, 取文本长度 (相加 (“客户订单号：”, 客户订单号))), 2), 取文本长度 (相加 (“日期：”, 日期)), 2)) ' 使日期和编号对齐
        
        赋值 (空格个数, 相减 (表格宽度, 相加 (取文本长度 (相加 (“经手人：”, 经手人)), 取文本长度 (相加 (“编号：”, 编号)))))
         ' 调试输出 (“日期：” ＋ 日期)
         ' 调试输出 (到文本 (右空格个数1))
        
        _启动窗口.置文本 (., 6, 1, 相加 (“客户：”, 客户, 取空白文本 (左空格个数1), “客户订单号：”, 客户订单号, 取空白文本 (右空格个数1), “日期：”, 日期))
        _启动窗口.置文本 (., 7, 1, 相加 (“经手人：”, 经手人, 取空白文本 (空格个数), “编号：”, 编号))
        
        .计次循环首 (记录总数, 计次)
            添加表模版 (#出库_表中模板_竖向)
            赋值 (纱号, _启动窗口.读 (., 数据库句柄, “纱号”))
            赋值 (支数, _启动窗口.读 (., 数据库句柄, “支数”))
            赋值 (成份, _启动窗口.读 (., 数据库句柄, “成份”))
            
            赋值 (色号, _启动窗口.读 (., 数据库句柄, “色号”))
            赋值 (颜色, _启动窗口.读 (., 数据库句柄, “颜色”))
            赋值 (缸号, _启动窗口.读 (., 数据库句柄, “缸号”))
            
            赋值 (单价, _启动窗口.读 (., 数据库句柄, “单价”))
            赋值 (单价币种, _启动窗口.读 (., 数据库句柄, “单价币种”))
            赋值 (数量, _启动窗口.读 (., 数据库句柄, “数量”))
            赋值 (数量称量, _启动窗口.读 (., 数据库句柄, “数量称量”))
            赋值 (金额, _启动窗口.读 (., 数据库句柄, “金额”))
            
            
            赋值 (运费, _启动窗口.读 (., 数据库句柄, “运费”))
            赋值 (件数, _启动窗口.读 (., 数据库句柄, “件数”))
            
            赋值 (临时快递公司, _启动窗口.读 (., 数据库句柄, “快递公司”)) ' 取得一张装箱单中的快递公司和快递单号
            
            .如果真 (不等于 (临时快递公司, “”))
                赋值 (快递公司, 临时快递公司)
            .如果真结束
            
            赋值 (临时快递单号, _启动窗口.读 (., 数据库句柄, “快递单号”))
            .如果真 (不等于 (临时快递单号, “”))
                赋值 (快递单号, 临时快递单号)
            .如果真结束
            
            _启动窗口.置文本 (., 9, 10, 相加 (“数量/”, 数量称量))
            _启动窗口.置文本 (., 9, 11, 相加 (“金额/”, 单价币种))
            
            赋值 (累计数量, 相加 (累计数量, 到整数 (数量))) ' 得到一张装箱单中所有纱号的累计数量
            
            赋值 (累计运费, 相加 (累计运费, 到小数 (运费))) ' 得到一张装箱单中所有纱号的累计运费
            
            赋值 (累计件数, 相加 (累计件数, 到整数 (件数))) ' 得到一张装箱单中所有纱号的装箱累计件数
            
            赋值 (累计金额, 相加 (累计金额, 到小数 (金额))) ' 得到一张装箱单中所有纱号的累计金额（不包括运费），只是金额的累加
            
            _启动窗口.置文本 (., 相加 (表头行数, 计次), 1, 纱号)
            _启动窗口.置文本 (., 相加 (表头行数, 计次), 2, 支数)
            _启动窗口.置文本 (., 相加 (表头行数, 计次), 3, 成份)
            
            _启动窗口.置文本 (., 相加 (表头行数, 计次), 4, 色号)
            _启动窗口.置文本 (., 相加 (表头行数, 计次), 5, 颜色)
            _启动窗口.置文本 (., 相加 (表头行数, 计次), 6, 缸号)
            
            _启动窗口.置文本 (., 相加 (表头行数, 计次), 7, 单价)
            _启动窗口.置文本 (., 相加 (表头行数, 计次), 9, 件数)
            _启动窗口.置文本 (., 相加 (表头行数, 计次), 10, 数量)
            _启动窗口.置文本 (., 相加 (表头行数, 计次), 11, 金额)
            
            _启动窗口.到后一记录 (., 数据库句柄)
            
        .计次循环尾 ()
        _启动窗口.到尾记录 (., 数据库句柄)
        
        赋值 (表头行数, _启动窗口.取行数 (.))
        
        添加表模版 (#出库_表尾模板)
        
         ' 调试输出 (“累计运费:” ＋ 到文本 (累计运费))
         ' 调试输出 (“累计件数:” ＋ 到文本 (累计件数))
         ' 调试输出 (“累计数量:” ＋ 到文本 (累计数量))
         ' 调试输出 (“快递公司:” ＋ 到文本 (快递公司))
        
        
        _启动窗口.置文本 (., 相加 (表头行数, 1), 8, 到文本 (累计运费))
        _启动窗口.置文本 (., 相加 (表头行数, 1), 9, 到文本 (累计件数))
        _启动窗口.置文本 (., 相加 (表头行数, 1), 10, 到文本 (累计数量))
        _启动窗口.置文本 (., 相加 (表头行数, 1), 11, 到文本 (相加 (累计金额, 累计运费)))
        
        .判断开始 (不等于 (快递公司, “”))
            _启动窗口.置文本 (., 相加 (表头行数, 2), 1, 相加 (快递公司, “：”, 快递单号))
        .默认
            
            _启动窗口.置文本 (., 相加 (表头行数, 2), 1, 取空白文本 (20))
            
        .判断结束
        
        
        
        _启动窗口.关闭记录集 (., 数据库句柄)
        
        
        
    .如果结束
    
.如果结束


.子程序 _窗口_生成装箱单_创建完毕, 空白型, , 
赋值 (.内容, _启动窗口..内容)


.程序集 快递公司管理程序集, , , 

.子程序 保存快递公司数据到数据库, 空白型, , 
.局部变量 SQL_查询, 文本型, , , 
.局部变量 匿名局部变量_1823, 空白型, , , 
.局部变量 快递公司名称, 文本型, , , 
.局部变量 快递公司简称, 文本型, , , 
.局部变量 快递公司地址, 文本型, , , 
.局部变量 快递公司电话, 文本型, , , 
.局部变量 快递公司传真, 文本型, , , 
.局部变量 快递公司网址, 文本型, , , 
.局部变量 快递公司业务员, 文本型, , , 
.局部变量 匿名局部变量_1872, 空白型, , , 
.局部变量 成功, 逻辑型, , , 
.局部变量 要保存出库数据, 逻辑型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 数据库句柄, 整数型, , , 
.局部变量 快递公司全称, 文本型, , , 
.局部变量 要保存数据, 逻辑型, , , 

赋值 (SQL_查询, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_快递公司表, “ where 简称='”, _启动窗口..内容, “'”)) ' 功能一、获得数据库句柄。功能二、生成一个临时的字段 记录总数
赋值 (数据库句柄, _启动窗口.查询 (., SQL_查询))
.如果 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_快递公司表, “查询失败!”), #错误图标, #提示文字)
    返回 ()
.否则
    
.如果结束

赋值 (记录总数, _启动窗口.读 (., 数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得

 ' 调试输出 (到文本 (记录总数))

赋值 (快递公司全称, 删首尾空 (_启动窗口..内容))
赋值 (快递公司简称, 删首尾空 (_启动窗口..内容))
赋值 (快递公司业务员, 删首尾空 (_启动窗口..内容))
赋值 (快递公司地址, 删首尾空 (_启动窗口..内容))
赋值 (快递公司网址, 删首尾空 (_启动窗口..内容))
赋值 (快递公司电话, 删首尾空 (_启动窗口..内容))
赋值 (快递公司传真, 删首尾空 (_启动窗口..内容))

.如果真 (等于 (快递公司简称, “”))
    信息框 (“快递公司简称不能为空！”, 0, #提示文字)
    _启动窗口.获取焦点 (.)
    返回 ()
.如果真结束

.判断开始 (等于 (记录总数, 0))
    赋值 (要保存数据, 真)
    
    .如果真 (要保存数据)
        
        赋值 (SQL_查询, 相加 (“insert into ”, #常量_快递公司表, “ (全称,简称,地址,电话,传真,业务员,网址) values ('”, 快递公司全称, “','”, 快递公司简称, “','”, 快递公司地址, “','”, 快递公司电话, “','”, 快递公司传真, “','”, 快递公司业务员, “','”, 快递公司网址, “')”))
         ' SQL_查询 ＝ “insert into ” ＋ #常量_快递公司表 ＋ “ (全称,简称,地址) values ('” ＋ 快递公司全称 ＋ “','” ＋ 快递公司简称 ＋ “','” ＋ 快递公司地址 ＋ “  ' )”
        赋值 (成功, _启动窗口.执行 (., SQL_查询, ))
        .如果真 (等于 (成功, 假))
            信息框 (相加 (“数据表:”, #常量_快递公司表, “添加失败!”), #错误图标, #提示文字)
            返回 ()
        .如果真结束
        赋值 (快递公司_编辑行号, 相加 (快递公司_编辑行号, 1))
        _启动窗口.未知支持库函数_38 (., , )
        _启动窗口.未知支持库函数_0 (., 快递公司_编辑行号, 0)
        
    .如果真结束
    
.默认
    
    赋值 (SQL_查询, 相加 (“update ”, #常量_快递公司表, “ set 全称='”, 快递公司全称, “',简称='”, 快递公司简称, “',地址='”, 快递公司地址, “',电话='”, 快递公司电话, “',传真='”, 快递公司传真, “',业务员='”, 快递公司业务员, “',网址='”, 快递公司网址, “' where 简称='”, 快递公司简称, “'”))
    
    赋值 (成功, _启动窗口.执行 (., SQL_查询, ))
    
    .如果真 (等于 (成功, 假))
         ' 调试输出 (“是更新操作出错！”)
        信息框 (相加 (“数据表:”, #常量_快递公司表, “更新失败!”), #错误图标, #提示文字)
        返回 ()
    .如果真结束
    
.判断结束


.子程序 设置默认快递公司高级表格格式, 空白型, , 
.参数 参数_高级表格, 未知类型0x50001, , 


赋值 (参数_高级表格., 1)
赋值 (参数_高级表格., 0)
赋值 (参数_高级表格., 7)
赋值 (参数_高级表格., 1)
 ' 设置表头标题
参数_高级表格.未知支持库函数_9 (0, 0, #., “快递公司全称”)
参数_高级表格.未知支持库函数_9 (0, 1, #., “简称”)
参数_高级表格.未知支持库函数_9 (0, 2, #., “业务员”)
参数_高级表格.未知支持库函数_9 (0, 3, #., “快递公司地址”)
参数_高级表格.未知支持库函数_9 (0, 4, #., “快递公司网址”)
参数_高级表格.未知支持库函数_9 (0, 5, #., “快递公司电话”)
参数_高级表格.未知支持库函数_9 (0, 6, #., “快递公司传真”)
 ' 设置表头宽度
参数_高级表格.未知支持库函数_32 (0, 200)
参数_高级表格.未知支持库函数_32 (1, 80)
参数_高级表格.未知支持库函数_32 (2, 100)
参数_高级表格.未知支持库函数_32 (3, 200)
参数_高级表格.未知支持库函数_32 (4, 200)
参数_高级表格.未知支持库函数_32 (5, 80)
参数_高级表格.未知支持库函数_32 (6, 80)
 ' 设置表头对齐方式
参数_高级表格.未知支持库函数_25 (0, 0, 0, 11, #.) ' 设置表头居中对齐


.子程序 显示所有快递公司数据, 整数型, , 
.参数 参数_外部数据库, 外部数据库, , 
.参数 参数_高级表格, 未知类型0x50001, , 
.参数 参数_SQL条件, 文本型, , 

.局部变量 计次变量, 整数型, , , 
.局部变量 SQL查询1, 文本型, , , 
.局部变量 SQL_查询2, 文本型, , , 
.局部变量 数据库句柄, 整数型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 快递公司全称, 文本型, , , 
.局部变量 快递公司简称, 文本型, , , 
.局部变量 快递公司业务员, 文本型, , , 
.局部变量 快递公司地址, 文本型, , , 
.局部变量 快递公司网址, 文本型, , , 
.局部变量 快递公司电话, 文本型, , , 
.局部变量 快递公司传真, 文本型, , , 

赋值 (SQL查询1, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_快递公司表, 参数_SQL条件))

赋值 (数据库句柄, 参数_外部数据库.查询 (SQL查询1)) ' 功能一、获得数据库句柄。功能二、生成一个临时的字段 记录总数

.如果真 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_快递公司表, “查询失败!”), #错误图标, #提示文字)
    
    返回 (0)
.如果真结束

赋值 (记录总数, 参数_外部数据库.读 (数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得

调试输出 (到文本 (记录总数))
 ' ---------------------------------------------------------------
赋值 (SQL_查询2, 相加 (“select * from ”, #常量_快递公司表, 参数_SQL条件))

赋值 (数据库句柄, 参数_外部数据库.查询 (SQL_查询2))

参数_外部数据库.到首记录 (数据库句柄)
.计次循环首 (记录总数, 计次变量)
    
    赋值 (快递公司全称, 删首空 (参数_外部数据库.读 (数据库句柄, “全称”)))
    
    赋值 (快递公司简称, 删首空 (参数_外部数据库.读 (数据库句柄, “简称”)))
    
    赋值 (快递公司业务员, 参数_外部数据库.读 (数据库句柄, “业务员”))
    
    赋值 (快递公司地址, 删首空 (参数_外部数据库.读 (数据库句柄, “地址”)))
    
    赋值 (快递公司网址, 删首空 (参数_外部数据库.读 (数据库句柄, “网址”)))
    
    赋值 (快递公司电话, 删首空 (参数_外部数据库.读 (数据库句柄, “电话”)))
    
    赋值 (快递公司传真, 删首空 (参数_外部数据库.读 (数据库句柄, “传真”)))
    
    参数_高级表格.未知支持库函数_38 ()
    
    参数_高级表格.未知支持库函数_9 (计次变量, 0, #., 快递公司全称)
    参数_高级表格.未知支持库函数_9 (计次变量, 1, #., 快递公司简称)
    参数_高级表格.未知支持库函数_9 (计次变量, 2, #., 快递公司业务员)
    参数_高级表格.未知支持库函数_9 (计次变量, 3, #., 快递公司地址)
    参数_高级表格.未知支持库函数_9 (计次变量, 4, #., 快递公司网址)
    参数_高级表格.未知支持库函数_9 (计次变量, 5, #., 快递公司电话)
    参数_高级表格.未知支持库函数_9 (计次变量, 6, #., 快递公司传真)
    
    参数_外部数据库.到后一记录 (数据库句柄)
.计次循环尾 ()
参数_高级表格.未知支持库函数_38 ()

参数_高级表格.未知支持库函数_0 (相减 (参数_高级表格., 1), 0)
参数_外部数据库.关闭记录集 (数据库句柄)
返回 (记录总数)


.子程序 高级表格_快递公司_快递公司_内容被改变, 空白型, , 
高级表格_快递公司_快递公司全称_内容被改变 ()
高级表格_快递公司_快递公司简称_内容被改变 ()
高级表格_快递公司_快递公司业务员_内容被改变 ()
高级表格_快递公司_快递公司地址_内容被改变 ()
高级表格_快递公司_快递公司网址_内容被改变 ()
高级表格_快递公司_快递公司电话_内容被改变 ()
高级表格_快递公司_快递公司传真_内容被改变 ()

.子程序 高级表格_快递公司_快递公司全称_内容被改变, 空白型, , 
_启动窗口.未知支持库函数_9 (., 快递公司_编辑行号, 0, #., _启动窗口..内容)

.子程序 高级表格_快递公司_快递公司简称_内容被改变, 空白型, , 
_启动窗口.未知支持库函数_9 (., 快递公司_编辑行号, 1, #., _启动窗口..内容)

.子程序 高级表格_快递公司_快递公司业务员_内容被改变, 空白型, , 
_启动窗口.未知支持库函数_9 (., 快递公司_编辑行号, 2, #., _启动窗口..内容)

.子程序 高级表格_快递公司_快递公司地址_内容被改变, 空白型, , 
_启动窗口.未知支持库函数_9 (., 快递公司_编辑行号, 3, #., _启动窗口..内容)

.子程序 高级表格_快递公司_快递公司网址_内容被改变, 空白型, , 
_启动窗口.未知支持库函数_9 (., 快递公司_编辑行号, 4, #., _启动窗口..内容)

.子程序 高级表格_快递公司_快递公司电话_内容被改变, 空白型, , 
_启动窗口.未知支持库函数_9 (., 快递公司_编辑行号, 5, #., _启动窗口..内容)

.子程序 高级表格_快递公司_快递公司传真_内容被改变, 空白型, , 
_启动窗口.未知支持库函数_9 (., 快递公司_编辑行号, 6, #., _启动窗口..内容)


.子程序 通过快递公司简称得到当前其它数据, 空白型, , 
.参数 参数_外部数据库, 外部数据库, , 
.参数 参数_快递公司简称, 文本型, , 

.局部变量 数据库句柄, 整数型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 计次变量, 整数型, , , 
.局部变量 快递公司全称, 文本型, , , 
.局部变量 快递公司简称, 文本型, , , 
.局部变量 快递公司业务员, 文本型, , , 
.局部变量 快递公司地址, 文本型, , , 
.局部变量 快递公司网址, 文本型, , , 
.局部变量 快递公司电话, 文本型, , , 
.局部变量 快递公司传真, 文本型, , , 
.局部变量 SQL_查询, 文本型, , , 


赋值 (SQL_查询, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_快递公司表, “ where 简称='”, 参数_快递公司简称, “'”))

赋值 (数据库句柄, 参数_外部数据库.查询 (SQL_查询))
.如果 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_快递公司表, “查询失败!”), #错误图标, #提示文字)
    返回 ()
.否则
    
    赋值 (记录总数, 参数_外部数据库.读 (数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得
     ' 调试输出 (到文本 (记录总数))
    .如果真 (大于 (记录总数, 0))
        赋值 (SQL_查询, 相加 (“select * from ”, #常量_快递公司表, “ where 简称='”, 参数_快递公司简称, “'”))
        赋值 (数据库句柄, 参数_外部数据库.查询 (SQL_查询))
        .如果 (等于 (数据库句柄, 0))
            信息框 (相加 (“数据表:”, #常量_快递公司表, “查询失败!”), #错误图标, #提示文字)
            返回 ()
        .否则
            
            
            赋值 (快递公司全称, 删首空 (参数_外部数据库.读 (数据库句柄, “全称”)))
            赋值 (快递公司简称, 删首空 (参数_外部数据库.读 (数据库句柄, “简称”)))
            赋值 (快递公司业务员, 删首空 (参数_外部数据库.读 (数据库句柄, “业务员”)))
            赋值 (快递公司地址, 删首空 (参数_外部数据库.读 (数据库句柄, “地址”)))
            赋值 (快递公司网址, 删首空 (参数_外部数据库.读 (数据库句柄, “网址”)))
            赋值 (快递公司电话, 删首空 (参数_外部数据库.读 (数据库句柄, “电话”)))
            赋值 (快递公司传真, 删首空 (参数_外部数据库.读 (数据库句柄, “传真”)))
        .如果结束
        
    .如果真结束
    
.如果结束

参数_外部数据库.关闭记录集 (数据库句柄)

赋值 (_启动窗口..内容, 快递公司全称)
赋值 (_启动窗口..内容, 快递公司简称)
赋值 (_启动窗口..内容, 快递公司业务员)
赋值 (_启动窗口..内容, 快递公司地址)
赋值 (_启动窗口..内容, 快递公司网址)
赋值 (_启动窗口..内容, 快递公司电话)
赋值 (_启动窗口..内容, 快递公司传真)


.子程序 删除当前记录_快递公司, 空白型, , 
.参数 参数_高级表格, 未知类型0x50001, , 
.参数 参数_外部数据库, 外部数据库, , 

.局部变量 当前编辑行号, 整数型, , , 
.局部变量 临时快递公司简称, 文本型, , , 
.局部变量 SQL_查询, 文本型, , , 
.局部变量 数据库句柄, 整数型, , , 
.局部变量 记录总数, 整数型, , , 

赋值 (当前编辑行号, 参数_高级表格.未知支持库函数_3 ())


赋值 (临时快递公司简称, 删首尾空 (参数_高级表格.未知支持库函数_10 (当前编辑行号, 1))) ' 得到快递公司简称

.如果真 (小于 (当前编辑行号, 相减 (参数_高级表格., 1)))
    .如果真 (删除当前记录 (参数_外部数据库, 相加 (“delete from ”, #常量_快递公司表, “ where 简称='”, 临时快递公司简称, “'”), #常量_快递公司表))
        参数_高级表格.未知支持库函数_36 (当前编辑行号)
    .如果真结束
    
.如果真结束

参数_外部数据库.关闭记录集 (数据库句柄)



.程序集 操作员管理程序集, , , 

.子程序 保存操作员数据到数据库, 空白型, , 
.局部变量 SQL_查询, 文本型, , , 
.局部变量 匿名局部变量_1912, 空白型, , , 
.局部变量 操作员名称, 文本型, , , 
.局部变量 操作员密码, 文本型, , , 
.局部变量 操作员权限, 文本型, , , 
.局部变量 匿名局部变量_1932, 空白型, , , 
.局部变量 成功, 逻辑型, , , 
.局部变量 要保存数据, 逻辑型, , , 
.局部变量 临时_这次登录时间, 文本型, , , 
.局部变量 临时_上次登录时间, 文本型, , , 
.局部变量 临时_总登录次数, 整数型, , , 
.局部变量 数据库句柄, 整数型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 表格操作员名称, 文本型, , , 
.局部变量 表格操作员密码, 文本型, , , 
.局部变量 图片索引, 文本型, , , 

赋值 (SQL_查询, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_操作员表, “ where 用户名称='”, _启动窗口..内容, “'”)) ' 功能一、获得数据库句柄。功能二、生成一个临时的字段 记录总数

赋值 (数据库句柄, _启动窗口.查询 (., SQL_查询))

 ' 调试输出 (“SQL1” ＋ 到文本 (数据库句柄))
.如果 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_操作员表, “查询失败!”), #错误图标, #提示文字)
    返回 ()
.否则
    
.如果结束


赋值 (记录总数, _启动窗口.读 (., 数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得
 ' 调试输出 (到文本 (记录总数))

赋值 (操作员名称, _启动窗口..内容)
赋值 (表格操作员名称, _启动窗口.未知支持库函数_10 (., 操作员_编辑行号, 0))


.判断开始 (等于 (删首尾空 (操作员名称), “”))
    .判断开始 (等于 (表格操作员名称, “”))
        信息框 (“用户名称不能为空！”, 0, #提示文字)
        _启动窗口.获取焦点 (.)
        返回 ()
    .默认
        赋值 (_启动窗口..内容, 表格操作员名称)
    .判断结束
    
.默认
    高级表格_操作员_用户名称_内容被改变 ()
.判断结束


赋值 (操作员密码, 操作员密码处理 (_启动窗口..内容))
赋值 (表格操作员密码, _启动窗口.未知支持库函数_10 (., 操作员_编辑行号, 1))

.判断开始 (等于 (删首尾空 (操作员密码), “”))
    .判断开始 (等于 (表格操作员密码, “”))
        信息框 (“用户名称不能为空！”, 0, #提示文字)
        _启动窗口.获取焦点 (.)
        返回 ()
    .默认
        赋值 (_启动窗口..内容, 表格操作员密码)
    .判断结束
    
.默认
    高级表格_操作员_用户密码_内容被改变 ()
.判断结束


.判断开始 (等于 (删首尾空 (_启动窗口..内容), “系统管理员”))
    赋值 (操作员权限, “1”) ' 权限为系统管理员 权限最高
.默认
    .判断开始 (等于 (删首尾空 (_启动窗口..内容), “普通管理员”))
        赋值 (操作员权限, “2”) ' 权限为普通管理员 权限一般
    .默认
        赋值 (操作员权限, “3”) ' 权限为来宾管理员 权限最低
    .判断结束
    
.判断结束

赋值 (图片索引, 到文本 (_启动窗口..))

.判断开始 (等于 (记录总数, 0))
    赋值 (要保存数据, 真)
    .如果真 (要保存数据)
        
        赋值 (SQL_查询, 相加 (“insert into ”, #常量_操作员表, “ (用户名称,图片索引,用户密码,用户权限) values ('”, 操作员名称, “','”, 图片索引, “','”, 操作员密码, “','”, 操作员权限, “')”))
        
        赋值 (成功, _启动窗口.执行 (., SQL_查询, ))
        .如果真 (等于 (成功, 假))
            信息框 (相加 (“数据表:”, #常量_操作员表, “添加失败!”), #错误图标, #提示文字)
            返回 ()
        .如果真结束
        赋值 (操作员_编辑行号, 相加 (操作员_编辑行号, 1))
        _启动窗口.未知支持库函数_38 (., , )
        _启动窗口.未知支持库函数_0 (., 操作员_编辑行号, 0)
        
    .如果真结束
    
.默认
    
    赋值 (SQL_查询, 相加 (“update ”, #常量_操作员表, “ set 用户名称='”, 操作员名称, “',图片索引='”, 图片索引, “',用户密码='”, 操作员密码, “',用户权限='”, 操作员权限, “' where 用户名称='”, 操作员名称, “'”))
    
    调试输出 (SQL_查询)
    赋值 (成功, _启动窗口.执行 (., SQL_查询, ))
    
    .如果真 (等于 (成功, 假))
         ' 调试输出 (“是更新操作出错！”)
        信息框 (相加 (“数据表:”, #常量_操作员表, “更新失败!”), #错误图标, #提示文字)
        返回 ()
    .如果真结束
    
.判断结束

赋值 (临时_上次登录时间, “”)

赋值 (临时_这次登录时间, “”)

赋值 (临时_总登录次数, 0)

 ' 设置默认操作员高级表格格式 (_启动窗口.高级表格_操作员管理)
 ' 显示所有操作员数据 (_启动窗口.高级表格_操作员管理, _启动窗口.外部数据库, “”)



.子程序 操作员密码处理, 文本型, , '加密或解密密码
.参数 参数_密码文本, 文本型, , 

.局部变量 结果_密码文本, 文本型, , , 
.局部变量 计次变量, 整数型, , , 


.计次循环首 (取文本长度 (参数_密码文本), 计次变量)
    赋值 (结果_密码文本, 相加 (结果_密码文本, 字符 (位异或 (取代码 (参数_密码文本, 计次变量), 10))))
.计次循环尾 ()
返回 (结果_密码文本)


.子程序 显示所有操作员数据, 整数型, , 
.参数 参数_外部数据库, 外部数据库, , 
.参数 参数_高级表格, 未知类型0x50001, , 
.参数 参数_SQL条件, 文本型, , 

.局部变量 计次变量, 整数型, , , 
.局部变量 局部_操作员名称, 文本型, , , 
.局部变量 SQL查询1, 文本型, , , 
.局部变量 SQL_查询2, 文本型, , , 
.局部变量 数据库句柄, 整数型, , , 
.局部变量 局部_操作员密码, 文本型, , , 
.局部变量 局部_操作员权限, 文本型, , , 
.局部变量 局部_上次登录时间, 文本型, , , 
.局部变量 局部_这次登录时间, 文本型, , , 
.局部变量 局部_总登录次数, 整数型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 操作员权限, 文本型, , , 
.局部变量 图片索引, 文本型, , , 

赋值 (SQL查询1, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_操作员表, 参数_SQL条件))

赋值 (数据库句柄, 参数_外部数据库.查询 (SQL查询1)) ' 功能一、获得数据库句柄。功能二、生成一个临时的字段 记录总数

.如果真 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_操作员表, “查询失败!”), #错误图标, #提示文字)
    返回 (0)
.如果真结束

赋值 (记录总数, 参数_外部数据库.读 (数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得

 ' 调试输出 (到文本 (记录总数))
 ' ---------------------------------------------------------------
赋值 (SQL_查询2, 相加 (“select * from ”, #常量_操作员表, 参数_SQL条件))

赋值 (数据库句柄, 参数_外部数据库.查询 (SQL_查询2))

参数_外部数据库.到首记录 (数据库句柄)
.计次循环首 (记录总数, 计次变量)
    
    赋值 (局部_操作员名称, 删首空 (参数_外部数据库.读 (数据库句柄, “用户名称”)))
    赋值 (图片索引, 删首尾空 (参数_外部数据库.读 (数据库句柄, “图片索引”)))
    
    赋值 (局部_操作员密码, 删首空 (参数_外部数据库.读 (数据库句柄, “用户密码”)))
    
    赋值 (操作员权限, 参数_外部数据库.读 (数据库句柄, “用户权限”))
    
    赋值 (局部_操作员权限, 多项选择 (到整数 (操作员权限), “系统管理员”, “普通管理员”, “来宾管理员”))
    
    赋值 (局部_上次登录时间, 删首空 (参数_外部数据库.读 (数据库句柄, “上次登录时间”)))
    
    赋值 (局部_这次登录时间, 删首空 (参数_外部数据库.读 (数据库句柄, “这次登录时间”)))
    
    赋值 (局部_总登录次数, 参数_外部数据库.读 (数据库句柄, “总登录次数”))
    
    参数_高级表格.未知支持库函数_38 ()
    
    参数_高级表格.未知支持库函数_9 (计次变量, 0, #., 局部_操作员名称)
    参数_高级表格.未知支持库函数_9 (计次变量, 1, #., 取格式字符 (“*”, 取文本长度 (局部_操作员密码)))
    参数_高级表格.未知支持库函数_9 (计次变量, 2, #., 局部_操作员权限)
    参数_高级表格.未知支持库函数_9 (计次变量, 3, #., 局部_上次登录时间)
    参数_高级表格.未知支持库函数_9 (计次变量, 4, #., 局部_这次登录时间)
    参数_高级表格.未知支持库函数_9 (计次变量, 5, #., 到文本 (局部_总登录次数))
    
    参数_外部数据库.到后一记录 (数据库句柄)
.计次循环尾 ()
参数_高级表格.未知支持库函数_38 ()

参数_高级表格.未知支持库函数_0 (相减 (参数_高级表格., 1), 0)
参数_外部数据库.关闭记录集 (数据库句柄)
返回 (记录总数)


.子程序 通过用户名称得到当前其它数据, 空白型, , 
.参数 参数_外部数据库, 外部数据库, , 
.参数 参数_用户名称, 文本型, , 

.局部变量 数据库句柄, 整数型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 计次变量, 整数型, , , 
.局部变量 临时_用户名称, 文本型, , , 
.局部变量 临时_用户密码, 文本型, , , 
.局部变量 临时_用户权限, 文本型, , , 
.局部变量 临时_上次登录时间, 文本型, , , 
.局部变量 临时_这次登录时间, 文本型, , , 
.局部变量 临时_总登录次数, 整数型, , , 
.局部变量 SQL_查询, 文本型, , , 
.局部变量 图片索引, 文本型, , , 


赋值 (SQL_查询, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_操作员表, “ where 用户名称='”, 参数_用户名称, “'”))

赋值 (数据库句柄, 参数_外部数据库.查询 (SQL_查询))
.如果 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_操作员表, “查询失败!”), #错误图标, #提示文字)
    返回 ()
.否则
    
    赋值 (记录总数, 参数_外部数据库.读 (数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得
     ' 调试输出 (到文本 (记录总数))
    .如果真 (大于 (记录总数, 0))
        赋值 (SQL_查询, 相加 (“select * from ”, #常量_操作员表, “ where 用户名称='”, 参数_用户名称, “'”))
        赋值 (数据库句柄, 参数_外部数据库.查询 (SQL_查询))
        .如果 (等于 (数据库句柄, 0))
            信息框 (相加 (“数据表:”, #常量_操作员表, “查询失败!”), #错误图标, #提示文字)
            返回 ()
        .否则
            
            
            赋值 (临时_用户名称, 删首空 (参数_外部数据库.读 (数据库句柄, “用户名称”)))
            赋值 (图片索引, 删首尾空 (参数_外部数据库.读 (数据库句柄, “图片索引”)))
            
            赋值 (临时_用户密码, 参数_外部数据库.读 (数据库句柄, “用户密码”))
            赋值 (临时_总登录次数, 参数_外部数据库.读 (数据库句柄, “总登录次数”))
            赋值 (临时_用户权限, 参数_外部数据库.读 (数据库句柄, “用户权限”))
            赋值 (临时_上次登录时间, 删首空 (参数_外部数据库.读 (数据库句柄, “上次登录时间”)))
            赋值 (临时_这次登录时间, 删首空 (参数_外部数据库.读 (数据库句柄, “这次登录时间”)))
            
            赋值 (临时_用户权限, 多项选择 (到整数 (临时_用户权限), “系统管理员”, “普通管理员”, “来宾管理员”))
            
        .如果结束
        
    .如果真结束
    
    
    
.如果结束

参数_外部数据库.关闭记录集 (数据库句柄)

赋值 (_启动窗口..内容, 临时_用户名称)

赋值 (_启动窗口..内容, 临时_用户密码)
赋值 (_启动窗口..内容, 临时_用户权限)
 ' _启动窗口.编辑框_上次登录时间.内容 ＝ 临时_上次登录时间
 ' _启动窗口.编辑框_这次登录时间.内容 ＝ 临时_这次登录时间
 ' _启动窗口.编辑框_总登录次数.内容 ＝ 到文本 (临时_总登录次数)

赋值 (_启动窗口..正常图片, 未知支持库函数_31 (#图片组, 到整数 (图片索引), ))
赋值 (_启动窗口.., 到整数 (图片索引))

.子程序 取格式字符, 文本型, , 
.参数 参数_字符, 文本型, , 
.参数 参数_个数, 整数型, , 

.局部变量 计数变量, 整数型, , , 
.局部变量 返回文本, 文本型, , , 

.计次循环首 (参数_个数, 计数变量)
    赋值 (返回文本, 相加 (返回文本, 参数_字符))
.计次循环尾 ()
返回 (返回文本)


.子程序 高级表格_操作员__内容被改变, 空白型, , 
高级表格_操作员_用户名称_内容被改变 ()
高级表格_操作员_用户密码_内容被改变 ()
高级表格_操作员_用户权限_内容被改变 ()

.子程序 高级表格_操作员_用户名称_内容被改变, 空白型, , 
_启动窗口.未知支持库函数_9 (., 操作员_编辑行号, 0, #., _启动窗口..内容)

.子程序 高级表格_操作员_用户密码_内容被改变, 空白型, , 
_启动窗口.未知支持库函数_9 (., 操作员_编辑行号, 1, #., 取格式字符 (“*”, 取文本长度 (_启动窗口..内容)))

.子程序 高级表格_操作员_用户权限_内容被改变, 空白型, , 
_启动窗口.未知支持库函数_9 (., 操作员_编辑行号, 2, #., _启动窗口..内容)

.子程序 设置默认操作员高级表格格式, 空白型, , 
.参数 参数_高级表格, 未知类型0x50001, , 


赋值 (参数_高级表格., 1)
赋值 (参数_高级表格., 0)
赋值 (参数_高级表格., 6)
赋值 (参数_高级表格., 1)
 ' 设置表头标题
参数_高级表格.未知支持库函数_9 (0, 0, #., “用户名称”)
参数_高级表格.未知支持库函数_9 (0, 1, #., “用户密码”)
参数_高级表格.未知支持库函数_9 (0, 2, #., “用户权限”)
参数_高级表格.未知支持库函数_9 (0, 3, #., “上次登录时间”)
参数_高级表格.未知支持库函数_9 (0, 4, #., “这次登录时间”)
参数_高级表格.未知支持库函数_9 (0, 5, #., “总登录次数”)

 ' 设置表头宽度
参数_高级表格.未知支持库函数_32 (0, 80)
参数_高级表格.未知支持库函数_32 (1, 80)
参数_高级表格.未知支持库函数_32 (2, 80)
参数_高级表格.未知支持库函数_32 (3, 200)
参数_高级表格.未知支持库函数_32 (4, 200)
参数_高级表格.未知支持库函数_32 (5, 200)
 ' 设置表头对齐方式
参数_高级表格.未知支持库函数_25 (0, 0, 0, 11, #.) ' 设置表头居中对齐


.子程序 删除当前记录_操作员, 空白型, , 
.参数 参数_高级表格, 未知类型0x50001, , 
.参数 参数_外部数据库, 外部数据库, , 

.局部变量 当前编辑行号, 整数型, , , 
.局部变量 临时用户名称, 文本型, , , 
.局部变量 SQL_查询, 文本型, , , 
.局部变量 数据库句柄, 整数型, , , 
.局部变量 记录总数, 整数型, , , 

赋值 (当前编辑行号, 参数_高级表格.未知支持库函数_3 ())

 ' 如果当前只有一个系统操作员，则不能再删除
赋值 (SQL_查询, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_操作员表, “ where 用户权限='1'”))
赋值 (数据库句柄, 参数_外部数据库.查询 (SQL_查询))

.如果 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_操作员表, “查询失败!”), #错误图标, #提示文字)
    返回 ()
.否则
    
    赋值 (记录总数, 参数_外部数据库.读 (数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得
    
    .判断开始 (大于 (记录总数, 1))
        赋值 (临时用户名称, 删首尾空 (参数_高级表格.未知支持库函数_10 (当前编辑行号, 0))) ' 用户名称
        
        .如果真 (小于 (当前编辑行号, 相减 (参数_高级表格., 1)))
            .如果真 (删除当前记录 (参数_外部数据库, 相加 (“delete from ”, #常量_操作员表, “ where 用户名称='”, 临时用户名称, “'”), #常量_操作员表))
                参数_高级表格.未知支持库函数_36 (当前编辑行号)
            .如果真结束
            
        .如果真结束
        
        
    .默认
        
        信息框 (“这是最后一个系统管理员，你不以删除！”, 0, #提示文字)
        返回 ()
    .判断结束
    
    
    参数_外部数据库.关闭记录集 (数据库句柄)
    
.如果结束


.子程序 显示, 空白型, , 
.参数 参数_超级列表框, 超级列表框, , 
.参数 参数_图片组, 字节集, , 

.局部变量 次数, 整数型, , , 
.局部变量 索引, 整数型, , , 

参数_超级列表框.全部删除 ()
赋值 (参数_超级列表框., 参数_图片组)
.如果真 (大于 (未知支持库函数_29 (参数_图片组), 0))
    .计次循环首 (未知支持库函数_29 (参数_图片组), 次数)
        参数_超级列表框.插入表项 (相减 (次数, 1), 到文本 (相减 (次数, 1)), , , , )
        参数_超级列表框.置图片 (相减 (次数, 1), 0, 相减 (次数, 1))
    .计次循环尾 ()
.如果真结束


.程序集 入库录入程序集, , , 

.子程序 显示所有入库数据, 整数型, , 
.参数 参数_外部数据库, 外部数据库, , 
.参数 参数_高级表格, 未知类型0x50001, , 
.参数 参数_SQL条件, 文本型, , 

.局部变量 数据库句柄, 整数型, , , 
.局部变量 SQL查询, 文本型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 计次变量, 整数型, , , 
.局部变量 匿名局部变量_9147, 空白型, , , 
.局部变量 日期, 文本型, , , 
.局部变量 供应商, 文本型, , , 
.局部变量 公司定单号, 文本型, , , 
.局部变量 匿名局部变量_9130, 空白型, , , 
.局部变量 纱号, 文本型, , , 
.局部变量 支数, 文本型, , , 
.局部变量 成份, 文本型, , , 
.局部变量 颜色, 文本型, , , 
.局部变量 匿名局部变量_9131, 空白型, , , 
.局部变量 入库单号, 文本型, , , 
.局部变量 匿名局部变量_9121, 空白型, , , 
.局部变量 单价, 文本型, , , 
.局部变量 进价币种, 文本型, , , 
.局部变量 匿名局部变量_9129, 空白型, , , 
.局部变量 数量, 文本型, , , 
.局部变量 入库称量, 文本型, , , 
.局部变量 匿名局部变量_9128, 空白型, , , 
.局部变量 备注, 文本型, , , 
.局部变量 匿名局部变量_9113, 空白型, , , 

赋值 (SQL查询, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_入库表, 参数_SQL条件))

赋值 (数据库句柄, 参数_外部数据库.查询 (SQL查询)) ' 功能一、获得数据库句柄。功能二、生成一个临时的字段 记录总数

.如果真 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_入库表, “查询失败!”), #错误图标, #提示文字)
    返回 (0)
.如果真结束

赋值 (记录总数, 参数_外部数据库.读 (数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得

 ' 调试输出 (到文本 (记录总数))
 ' ---------------------------------------------------------------
赋值 (SQL查询, 相加 (“select * from ”, #常量_入库表, 参数_SQL条件))
赋值 (数据库句柄, 参数_外部数据库.查询 (SQL查询))

参数_外部数据库.到首记录 (数据库句柄)
.计次循环首 (记录总数, 计次变量)
    赋值 (日期, 取日期文本 (参数_外部数据库.读 (数据库句柄, “日期”)))
    
    赋值 (供应商, 删首空 (参数_外部数据库.读 (数据库句柄, “供应商”)))
    
    赋值 (公司定单号, 删首空 (参数_外部数据库.读 (数据库句柄, “公司定单号”)))
    
    赋值 (纱号, 删首空 (参数_外部数据库.读 (数据库句柄, “纱号”)))
    赋值 (支数, 删首空 (参数_外部数据库.读 (数据库句柄, “支数”)))
    赋值 (成份, 删首空 (参数_外部数据库.读 (数据库句柄, “成份”)))
    赋值 (颜色, 删首空 (参数_外部数据库.读 (数据库句柄, “颜色”)))
    
    赋值 (入库单号, 删首空 (参数_外部数据库.读 (数据库句柄, “入库单号”)))
    
    赋值 (单价, 删首空 (参数_外部数据库.读 (数据库句柄, “进价”)))
    赋值 (进价币种, 删首空 (参数_外部数据库.读 (数据库句柄, “进价币种”)))
    
    赋值 (数量, 删首空 (参数_外部数据库.读 (数据库句柄, “数量”)))
    赋值 (入库称量, 删首空 (参数_外部数据库.读 (数据库句柄, “入库称量”)))
    
    
    赋值 (备注, 删首空 (参数_外部数据库.读 (数据库句柄, “备注”)))
    
    参数_高级表格.未知支持库函数_38 ()
    
    参数_高级表格.未知支持库函数_9 (计次变量, 0, #., 日期)
    参数_高级表格.未知支持库函数_9 (计次变量, 1, #., 供应商)
    参数_高级表格.未知支持库函数_9 (计次变量, 2, #., 公司定单号)
    参数_高级表格.未知支持库函数_9 (计次变量, 3, #., 纱号)
    参数_高级表格.未知支持库函数_9 (计次变量, 4, #., 支数)
    参数_高级表格.未知支持库函数_9 (计次变量, 5, #., 成份)
    参数_高级表格.未知支持库函数_9 (计次变量, 6, #., 颜色)
    参数_高级表格.未知支持库函数_9 (计次变量, 7, #., 入库单号)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 8, #., 单价)
    参数_高级表格.未知支持库函数_9 (计次变量, 9, #., 进价币种)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 10, #., 数量)
    参数_高级表格.未知支持库函数_9 (计次变量, 11, #., 入库称量)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 12, #., 备注)
    
    
    参数_外部数据库.到后一记录 (数据库句柄)
.计次循环尾 ()
参数_高级表格.未知支持库函数_38 ()

参数_高级表格.未知支持库函数_0 (相减 (参数_高级表格., 1), 0)
参数_外部数据库.关闭记录集 (数据库句柄)
返回 (记录总数)



.子程序 通过入库单号得到当前其它数据, 空白型, , 
.参数 参数_外部数据库, 外部数据库, , 
.参数 参数_编号, 文本型, , 

.局部变量 数据库句柄, 整数型, , , 
.局部变量 SQL_查询, 文本型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 计次变量, 整数型, , , 
.局部变量 匿名局部变量_9146, 空白型, , , 
.局部变量 日期, 文本型, , , 
.局部变量 供应商, 文本型, , , 
.局部变量 公司定单号, 文本型, , , 
.局部变量 匿名局部变量_9136, 空白型, , , 
.局部变量 纱号, 文本型, , , 
.局部变量 支数, 文本型, , , 
.局部变量 成份, 文本型, , , 
.局部变量 颜色, 文本型, , , 
.局部变量 匿名局部变量_9135, 空白型, , , 
.局部变量 入库单号, 文本型, , , 
.局部变量 匿名局部变量_9134, 空白型, , , 
.局部变量 单价, 文本型, , , 
.局部变量 进价币种, 文本型, , , 
.局部变量 匿名局部变量_9140, 空白型, , , 
.局部变量 数量, 文本型, , , 
.局部变量 入库称量, 文本型, , , 
.局部变量 匿名局部变量_9142, 空白型, , , 
.局部变量 备注, 文本型, , , 
.局部变量 匿名局部变量_9139, 空白型, , , 


赋值 (SQL_查询, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_入库表, “ where 入库单号='”, 参数_编号, “'”))

赋值 (数据库句柄, 参数_外部数据库.查询 (SQL_查询))
.如果 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_入库表, “查询失败!”), #错误图标, #提示文字)
    返回 ()
.否则
    
    赋值 (记录总数, 参数_外部数据库.读 (数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得
    调试输出 (到文本 (记录总数))
    .如果真 (大于 (记录总数, 0))
        赋值 (SQL_查询, 相加 (“select * from ”, #常量_入库表, “ where 入库单号='”, 参数_编号, “'”))
        赋值 (数据库句柄, 参数_外部数据库.查询 (SQL_查询))
        .如果 (等于 (数据库句柄, 0))
            信息框 (相加 (“数据表:”, #常量_入库表, “查询失败!”), #错误图标, #提示文字)
            返回 ()
        .否则
            
            
            赋值 (日期, 取日期文本 (参数_外部数据库.读 (数据库句柄, “日期”)))
            
            赋值 (供应商, 删首空 (参数_外部数据库.读 (数据库句柄, “供应商”)))
            赋值 (公司定单号, 删首空 (参数_外部数据库.读 (数据库句柄, “公司定单号”)))
            赋值 (纱号, 删首空 (参数_外部数据库.读 (数据库句柄, “纱号”)))
            赋值 (支数, 删首空 (参数_外部数据库.读 (数据库句柄, “支数”)))
            赋值 (成份, 删首空 (参数_外部数据库.读 (数据库句柄, “成份”)))
            赋值 (颜色, 删首空 (参数_外部数据库.读 (数据库句柄, “颜色”)))
            赋值 (入库单号, 删首空 (参数_外部数据库.读 (数据库句柄, “入库单号”)))
            
            赋值 (单价, 删首空 (参数_外部数据库.读 (数据库句柄, “进价”)))
            赋值 (进价币种, 删首空 (参数_外部数据库.读 (数据库句柄, “进价币种”)))
            
            赋值 (数量, 删首空 (参数_外部数据库.读 (数据库句柄, “数量”)))
            赋值 (入库称量, 删首空 (参数_外部数据库.读 (数据库句柄, “入库称量”)))
            
            赋值 (备注, 删首空 (参数_外部数据库.读 (数据库句柄, “备注”)))
            
            
            赋值 (_启动窗口..内容, 日期)
            
            赋值 (_启动窗口..内容, 供应商)
            
            
            赋值 (_启动窗口..内容, 公司定单号)
            
            
            赋值 (_启动窗口..内容, 纱号)
            
            
            赋值 (_启动窗口..内容, 支数)
            
            
            赋值 (_启动窗口..内容, 成份)
            
            
            赋值 (_启动窗口..内容, 颜色)
            
            
            赋值 (_启动窗口..内容, 入库单号)
            
            
            赋值 (_启动窗口..内容, 单价)
            
            
            赋值 (_启动窗口..内容, 进价币种)
            
            
            赋值 (_启动窗口..内容, 数量)
            
            
            赋值 (_启动窗口..内容, 入库称量)
            
            
            赋值 (_启动窗口..内容, 备注)
            
        .如果结束
        
    .如果真结束
    
.如果结束

参数_外部数据库.关闭记录集 (数据库句柄)


.子程序 高级表格_入库_内容被改变, 空白型, , 
高级表格_日期_入库_内容被改变 ()
高级表格_供应商_内容被改变 ()
高级表格_公司订单号_内容被改变 ()
高级表格_纱号_入库_内容被改变 ()
高级表格_支数_入库_内容被改变 ()
高级表格_成份_入库_内容被改变 ()
高级表格_颜色_入库_内容被改变 ()
高级表格_入库单号_内容被改变 ()

高级表格_进价_内容被改变 ()
高级表格_进价币种_内容被改变 ()

高级表格_入库数量_内容被改变 ()
高级表格_入库称量_内容被改变 ()

高级表格_备注_内容被改变 ()
 ' --------------------------------------------


.子程序 高级表格_日期_入库_内容被改变, 空白型, , 
 ' _启动窗口.高级表格_入库.置光标 (入库_编辑行号, 入库_编辑列号)
_启动窗口.未知支持库函数_9 (., 入库_编辑行号, 0, #., _启动窗口..内容)


.子程序 高级表格_供应商_内容被改变, 空白型, , 
 ' _启动窗口.高级表格_入库.置光标 (入库_编辑行号, 入库_编辑列号)
_启动窗口.未知支持库函数_9 (., 入库_编辑行号, 1, #., _启动窗口..内容)


.子程序 高级表格_公司订单号_内容被改变, 空白型, , 
 ' _启动窗口.高级表格_入库.置光标 (入库_编辑行号, 入库_编辑列号)
_启动窗口.未知支持库函数_9 (., 入库_编辑行号, 2, #., _启动窗口..内容)

.子程序 高级表格_纱号_入库_内容被改变, 空白型, , 
 ' _启动窗口.高级表格_入库.置光标 (入库_编辑行号, 入库_编辑列号)
_启动窗口.未知支持库函数_9 (., 入库_编辑行号, 3, #., _启动窗口..内容)

.子程序 高级表格_支数_入库_内容被改变, 空白型, , 
 ' _启动窗口.高级表格_入库.置光标 (入库_编辑行号, 入库_编辑列号)
_启动窗口.未知支持库函数_9 (., 入库_编辑行号, 4, #., _启动窗口..内容)

.子程序 高级表格_成份_入库_内容被改变, 空白型, , 
 ' _启动窗口.高级表格_入库.置光标 (入库_编辑行号, 入库_编辑列号)
_启动窗口.未知支持库函数_9 (., 入库_编辑行号, 5, #., _启动窗口..内容)

.子程序 高级表格_颜色_入库_内容被改变, 空白型, , 
 ' _启动窗口.高级表格_入库.置光标 (入库_编辑行号, 入库_编辑列号)
_启动窗口.未知支持库函数_9 (., 入库_编辑行号, 6, #., _启动窗口..内容)

.子程序 高级表格_入库单号_内容被改变, 空白型, , 
 ' _启动窗口.高级表格_入库.置光标 (入库_编辑行号, 入库_编辑列号)
_启动窗口.未知支持库函数_9 (., 入库_编辑行号, 7, #., _启动窗口..内容)


.子程序 高级表格_进价_内容被改变, 空白型, , 
 ' _启动窗口.高级表格_入库.置光标 (入库_编辑行号, 入库_编辑列号)
_启动窗口.未知支持库函数_9 (., 入库_编辑行号, 8, #., _启动窗口..内容)

.子程序 高级表格_进价币种_内容被改变, 空白型, , 
 ' _启动窗口.高级表格_入库.置光标 (入库_编辑行号, 入库_编辑列号)
_启动窗口.未知支持库函数_9 (., 入库_编辑行号, 9, #., _启动窗口..内容)


.子程序 高级表格_入库数量_内容被改变, 空白型, , 
 ' _启动窗口.高级表格_入库.置光标 (入库_编辑行号, 入库_编辑列号)
_启动窗口.未知支持库函数_9 (., 入库_编辑行号, 10, #., _启动窗口..内容)

.子程序 高级表格_入库称量_内容被改变, 空白型, , 
 ' _启动窗口.高级表格_入库.置光标 (入库_编辑行号, 入库_编辑列号)
_启动窗口.未知支持库函数_9 (., 入库_编辑行号, 11, #., _启动窗口..内容)


.子程序 高级表格_备注_内容被改变, 空白型, , 
 ' _启动窗口.高级表格_入库.置光标 (入库_编辑行号, 入库_编辑列号)
_启动窗口.未知支持库函数_9 (., 入库_编辑行号, 12, #., _启动窗口..内容)

 ' ---------------------------------------------------------------------------

.子程序 _组合框_进价_币种_列表项被选择, 空白型, , 
赋值 (_启动窗口..现行选中项, _启动窗口..现行选中项)
高级表格_进价币种_内容被改变 ()

.子程序 _组合框_入库数量_单位_列表项被选择, 空白型, , 
赋值 (_启动窗口..现行选中项, _启动窗口..现行选中项)
高级表格_入库称量_内容被改变 ()
 ' ---------------------------------------------------------------------------

.子程序 保存入库数据到数据库, 空白型, , 入库数据的插入或更新
.局部变量 要保存入库数据, 逻辑型, , , 
.局部变量 数据库句柄, 整数型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 成功, 逻辑型, , , 
.局部变量 SQL查询, 文本型, , , 
.局部变量 匿名局部变量_9151, 空白型, , , 
.局部变量 日期, 文本型, , , 
.局部变量 供应商, 文本型, , , 
.局部变量 公司定单号, 文本型, , , 
.局部变量 纱号, 文本型, , , 
.局部变量 支数, 文本型, , , 
.局部变量 成份, 文本型, , , 
.局部变量 颜色, 文本型, , , 
.局部变量 入库单号, 文本型, , , 
.局部变量 匿名局部变量_9155, 空白型, , , 
.局部变量 单价, 文本型, , , 
.局部变量 进价币种, 文本型, , , 
.局部变量 匿名局部变量_9162, 空白型, , , 
.局部变量 数量, 文本型, , , 
.局部变量 入库称量, 文本型, , , 
.局部变量 匿名局部变量_9152, 空白型, , , 
.局部变量 备注, 文本型, , , 

赋值 (SQL查询, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_入库表, “ where 入库单号='”, _启动窗口..内容, “'”)) ' 功能一、获得数据库句柄。功能二、生成一个临时的字段 记录总数

赋值 (数据库句柄, _启动窗口.查询 (., SQL查询))
 ' 调试输出 (“SQL1” ＋ 到文本 (数据库句柄))
.如果 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_入库表, “查询失败!”), #错误图标, #提示文字)
    返回 ()
.否则
    
    赋值 (日期, 子文本替换 (_启动窗口..内容, “.”, “-”, 1, 2, 真))
    
    赋值 (供应商, 删首尾空 (_启动窗口..内容))
    .如果真 (等于 (供应商, “”))
        信息框 (“供应商不能为空！”, 0, #提示文字)
        _启动窗口.获取焦点 (.)
        返回 ()
    .如果真结束
    
    赋值 (公司定单号, 删首尾空 (_启动窗口..内容))
    
    .如果真 (等于 (公司定单号, “”))
        信息框 (“公司定单号不能为空！”, 0, #提示文字)
        _启动窗口.获取焦点 (.)
        返回 ()
    .如果真结束
    
    赋值 (纱号, 删首尾空 (_启动窗口..内容))
    .如果真 (等于 (纱号, “”))
        信息框 (“纱号不能为空！”, 0, #提示文字)
        _启动窗口.获取焦点 (.)
        返回 ()
    .如果真结束
    
    赋值 (支数, 删首尾空 (_启动窗口..内容))
    .如果真 (等于 (支数, “”))
        信息框 (“支数不能为空！”, 0, #提示文字)
        _启动窗口.获取焦点 (.)
        返回 ()
    .如果真结束
    
    赋值 (成份, 删首尾空 (_启动窗口..内容))
    .如果真 (等于 (成份, “”))
        信息框 (“成份不能为空！”, 0, #提示文字)
        _启动窗口.获取焦点 (.)
        返回 ()
    .如果真结束
    
    赋值 (颜色, 删首尾空 (_启动窗口..内容))
    .如果真 (等于 (颜色, “”))
        信息框 (“颜色不能为空！”, 0, #提示文字)
        _启动窗口.获取焦点 (.)
        返回 ()
    .如果真结束
    
    赋值 (入库单号, 删首尾空 (_启动窗口..内容))
    .如果真 (等于 (入库单号, “”))
        信息框 (“入库单号不能为空！”, 0, #提示文字)
        _启动窗口.获取焦点 (.)
        返回 ()
    .如果真结束
    
    赋值 (单价, 删首尾空 (_启动窗口..内容))
    .如果真 (等于 (单价, “”))
        赋值 (单价, “0”)
    .如果真结束
    
    赋值 (进价币种, 删首空 (_启动窗口..内容))
    .如果真 (等于 (进价币种, “”))
        信息框 (“币种不能为空！”, 0, #提示文字)
        _启动窗口.获取焦点 (.)
    .如果真结束
    
    赋值 (数量, 删首尾空 (_启动窗口..内容))
    .如果真 (等于 (数量, “”))
        赋值 (数量, “0”)
    .如果真结束
    
    赋值 (入库称量, 删首空 (_启动窗口..内容))
    .如果真 (等于 (入库称量, “”))
        信息框 (“称量单位不能为空！”, 0, #提示文字)
        _启动窗口.获取焦点 (.)
    .如果真结束
    
    
    赋值 (备注, 删首尾空 (_启动窗口..内容))
    
    
    
    赋值 (记录总数, _启动窗口.读 (., 数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得
     ' 调试输出 (到文本 (记录总数))
    .判断开始 (等于 (记录总数, 0))
        赋值 (要保存入库数据, 真)
        
        .如果真 (要保存入库数据)
            赋值 (SQL查询, 相加 (“insert into ”, #常量_入库表, “ (日期,供应商,公司定单号,纱号,支数,成份,颜色,入库单号,进价,进价币种,数量,入库称量,备注) values ('”, 日期, “','”, 供应商, “','”, 公司定单号, “','”, 纱号, “','”, 支数, “','”, 成份, “','”, 颜色, “','”, 入库单号, “','”, 单价, “','”, 进价币种, “','”, 数量, “','”, 入库称量, “','”, 备注, “')”))
            
            赋值 (成功, _启动窗口.执行 (., SQL查询, ))
            .如果真 (等于 (成功, 假))
                信息框 (相加 (“数据表:”, #常量_入库表, “添加失败!”), #错误图标, #提示文字)
                返回 ()
            .如果真结束
            赋值 (入库_编辑行号, 相加 (入库_编辑行号, 1))
            _启动窗口.未知支持库函数_38 (., , )
            _启动窗口.未知支持库函数_0 (., 入库_编辑行号, 0)
        .如果真结束
        
    .默认
        
        调试输出 (纱号)
        调试输出 (_启动窗口..内容)
        赋值 (SQL查询, 相加 (“update ”, #常量_入库表, “ set 日期='”, 日期, “',供应商='”, 供应商, “',公司定单号='”, 公司定单号, “',纱号='”, 纱号, “',支数='”, 支数, “',成份='”, 成份, “',颜色='”, 颜色, “',入库单号='”, 入库单号, “',进价='”, 单价, “',进价币种='”, 进价币种, “',数量='”, 数量, “',入库称量='”, 入库称量, “',备注='”, 备注, “' where 入库单号='”, _启动窗口..内容, “'”))
        
        赋值 (成功, _启动窗口.执行 (., SQL查询, ))
        调试输出 (“是更新操作成功！”)
        .如果真 (等于 (成功, 假))
            调试输出 (“是更新操作出错！”)
            信息框 (相加 (“数据表:”, #常量_入库表, “更新失败!”), #错误图标, #提示文字)
            返回 ()
        .如果真结束
        
    .判断结束
    
.如果结束


 ' ---------------------------------------------------------------------------



.子程序 删除当前记录_入库, 空白型, , 
.参数 参数_高级表格, 未知类型0x50001, , 
.参数 参数_外部数据库, 外部数据库, , 

.局部变量 当前编辑行号, 整数型, , , 
.局部变量 临时编号, 文本型, , , 

赋值 (当前编辑行号, 参数_高级表格.未知支持库函数_3 ())

赋值 (临时编号, 删首尾空 (参数_高级表格.未知支持库函数_10 (当前编辑行号, 7))) ' 得到入库单号

.如果真 (小于 (当前编辑行号, 相减 (参数_高级表格., 1)))
    .如果真 (删除当前记录 (参数_外部数据库, 相加 (“delete from ”, #常量_入库表, “ where 入库单号='”, 临时编号, “'”), #常量_入库表))
        参数_高级表格.未知支持库函数_36 (当前编辑行号)
    .如果真结束
    
.如果真结束


.程序集 公共程序集, , , 

.子程序 取当前日期文本, 文本型, , 格式为1.XXXX年XX月XX日星期X或2.XXXX.XX.XX
.参数 参数_日期类型, 整数型, , 为1时返回格式为1.XXXX年XX月XX日星期X，为其它数字时返回格式为2.XXXX.XX.XX
.参数 参数_日期格式, 文本型, , 格式符号可以为"."或"-"或"/"

.局部变量 临时变量, 文本型, , , 
.局部变量 年份, 文本型, , , 
.局部变量 月份, 文本型, , , 
.局部变量 日子, 文本型, , , 

.判断开始 (等于 (参数_日期类型, 1))
    赋值 (临时变量, 相加 (到文本 (取日期 (取现行时间 ())), 多项选择 (取星期几 (取现行时间 ()), “星期日”, “星期一”, “星期二”, “星期三”, “星期四”, “星期五”, “星期六”)))
    
.默认
    赋值 (年份, 到文本 (取年份 (取现行时间 ())))
     ' 取文本长度 (年份)
    赋值 (月份, 到文本 (取月份 (取现行时间 ())))
    .如果真 (等于 (取文本长度 (月份), 1))
        赋值 (月份, 相加 (“0”, 月份))
    .如果真结束
    
    赋值 (日子, 到文本 (取日 (取现行时间 ())))
    .如果真 (等于 (取文本长度 (删首空 (日子)), 1))
        赋值 (日子, 相加 (“0”, 日子))
    .如果真结束
    赋值 (临时变量, 相加 (年份, 参数_日期格式, 月份, 参数_日期格式, 日子))
    
.判断结束

返回 (临时变量)


.子程序 取日期文本, 文本型, , 格式为1.XXXX年XX月XX日星期X或2.XXXX.XX.XX
.参数 参数_日期类型, 日期时间型, , 为1时返回格式为1.XXXX年XX月XX日星期X，为其它数字时返回格式为2.XXXX.XX.XX

.局部变量 临时变量, 文本型, , , 
.局部变量 年份, 文本型, , , 
.局部变量 月份, 文本型, , , 
.局部变量 日子, 文本型, , , 


赋值 (年份, 到文本 (取年份 (参数_日期类型)))

 ' 取文本长度 (年份)
赋值 (月份, 到文本 (取月份 (参数_日期类型)))

.如果真 (等于 (取文本长度 (月份), 1))
    赋值 (月份, 相加 (“0”, 月份))
.如果真结束

赋值 (日子, 到文本 (取日 (参数_日期类型)))

.如果真 (等于 (取文本长度 (删首空 (日子)), 1))
    赋值 (日子, 相加 (“0”, 日子))
.如果真结束

赋值 (临时变量, 相加 (年份, “.”, 月份, “.”, 日子))


返回 (临时变量)


.子程序 取月历文本, 文本型, , 返回日期格式为：2010.09.06
.参数 参数_日期, 日期时间型, , 

.局部变量 日期文本, 文本型, , , 
.局部变量 月历日期文本, 文本型, , , 
.局部变量 日的位置, 整数型, , , 
.局部变量 年月日文本, 文本型, , , 
.局部变量 年的位置, 整数型, , , 
.局部变量 月的位置, 整数型, , , 
.局部变量 年文本, 文本型, , , 
.局部变量 月文本, 文本型, , , 
.局部变量 日文本, 文本型, , , 

赋值 (月历日期文本, 到文本 (参数_日期))

赋值 (日的位置, 寻找文本 (月历日期文本, “日”, 1, 真))

赋值 (年月日文本, 取文本左边 (月历日期文本, 相加 (日的位置, 1))) ' 得到形如：2010年1月15日的文本

赋值 (年的位置, 寻找文本 (年月日文本, “年”, 1, 真)) ' 得到“2010年1月15日”文本中年的位置

赋值 (月的位置, 寻找文本 (年月日文本, “月”, 1, 真)) ' 得到“2010年1月15日”文本中月的位置

赋值 (日的位置, 寻找文本 (年月日文本, “日”, 1, 真)) ' 得到“2010年1月15日”文本中日的位置

赋值 (年文本, 取文本左边 (年月日文本, 4)) ' 得到形如：2010的文本

赋值 (月文本, 取文本中间 (年月日文本, 相加 (年的位置, 2), 相减 (月的位置, 相加 (年的位置, 2))))

赋值 (日文本, 取文本中间 (年月日文本, 相加 (月的位置, 2), 相减 (日的位置, 相加 (月的位置, 1))))
.如果真 (等于 (取文本长度 (月文本), 1))
    赋值 (月文本, 相加 (“0”, 月文本))
.如果真结束

.如果真 (小于或等于 (取文本长度 (删首空 (日文本)), 2))
    赋值 (日文本, 相加 (“0”, 日文本))
.如果真结束

赋值 (日期文本, 相加 (年文本, “.”, 月文本, “.”, 日文本))

返回 (日期文本)

.子程序 禁止重复运行, 空白型, , 
.如果 (不等于 (OpenEvent (2031619, 假, _启动窗口.), 0))
    信息框 (相加 (“『”, _启动窗口., “』已经在运行中，请不要重复运行！”), 48, #提示文字)
    结束 ()
.否则
    赋值 (互斥体句柄, CreateEvent (0, 假, 假, _启动窗口.))
.如果结束


.子程序 数据库正常与否, 逻辑型, , 
.局部变量 正常与否, 逻辑型, , , 
.局部变量 本地数据库文件, 文本型, , , 
.局部变量 网络数据库文件, 文本型, , , 



赋值 (本地数据库文件, 相加 (取运行目录 (), “\数据\毛纱数据库.mdb”))

赋值 (网络数据库文件, 读配置项 (相加 (系统目录, “\系统配置.ini”), “系统路径”, “数据库路径”, 本地数据库文件))

赋值 (数据库目录, 取文本左边 (网络数据库文件, 倒找文本 (网络数据库文件, “\”, , 假)))
 ' 调试输出 (数据库目录)
 ' 调试输出 (到文本 (倒找文本 (网络数据库文件, “\”, , 假)))
.如果 (等于 (文件是否存在 (网络数据库文件), 假))
    .如果 (等于 (信息框 (相加 (“可能是你的局域网有问题，没有找到网络数据库文件：”, 网络数据库文件, “!是否转入到本地数据库文件:”, 本地数据库文件, “？”), 1, #提示文字), 0))
        .如果真 (等于 (文件是否存在 (本地数据库文件), 假))
            信息框 (相加 (本地数据库文件, “失踪!”, #换行符, “请检查系统的完整性!本次运行将取消.”), #错误图标, #提示文字)
            结束 ()
        .如果真结束
        
        .如果 (等于 (_启动窗口.打开MDB数据库 (., 本地数据库文件, “admin”, , , ), 假))
            信息框 (相加 (本地数据库文件, “打开失败!”, #换行符, “请系统管理员检查原因.本次运行将取消.”), #错误图标, #提示文字)
            赋值 (正常与否, 假)
            结束 ()
        .否则
            赋值 (正常与否, 真)
        .如果结束
        
        
    .否则
        结束 ()
    .如果结束
    
.否则
    .如果 (等于 (_启动窗口.打开MDB数据库 (., 网络数据库文件, “admin”, , , ), 假))
        信息框 (相加 (网络数据库文件, “打开失败!”, #换行符, “请系统管理员检查原因.本次运行将取消.”), #错误图标, #提示文字)
        赋值 (正常与否, 假)
        结束 ()
    .否则
        赋值 (正常与否, 真)
    .如果结束
    
.如果结束
 ' 调试输出 (网络数据库文件)

返回 (正常与否)


.子程序 是否有用户, 逻辑型, , 
.参数 参数_外部数据库, 外部数据库, , 
.参数 参数_SQL语句, 文本型, , 要查询的SQL语句

.局部变量 句柄, 整数型, , , 

赋值 (句柄, 参数_外部数据库.查询 (参数_SQL语句))
.如果真 (等于 (句柄, 0))
    返回 (假)
.如果真结束

参数_外部数据库.到首记录 (句柄)
.判断循环首 (等于 (参数_外部数据库.尾记录后 (句柄), 假))
    赋值 (用户名称, 参数_外部数据库.读 (句柄, “用户名称”))
    
    赋值 (用户密码, 参数_外部数据库.读 (句柄, “用户密码”))
    
    赋值 (用户权限, 参数_外部数据库.读 (句柄, “用户权限”))
    
    赋值 (上次登录时间, 参数_外部数据库.读 (句柄, “上次登录时间”))
    
    赋值 (这次登录时间, 参数_外部数据库.读 (句柄, “这次登录时间”))
    
    赋值 (总登录次数, 参数_外部数据库.读 (句柄, “总登录次数”))
    
    赋值 (已登录, 参数_外部数据库.读 (句柄, “已登录”))
    
    参数_外部数据库.到后一记录 (句柄)
.判断循环尾 ()

参数_外部数据库.关闭记录集 (句柄)
菜单显示可否 ()
.判断开始 (等于 (已登录, “1”))
    信息框 (相加 (“用户：”, 用户名称, “已经登录！”), 0, #提示文字)
    返回 (假)
.默认
    
    返回 (真)
.判断结束



.子程序 高级表格字体初始化, 空白型, , 
.参数 参数_字体, 文本型, , 
.参数 参数_高级表格, 未知类型0x50001, , 

.局部变量 字体名称, 文本型, , , 
.局部变量 字体大小, 文本型, , , 


赋值 (字体名称, 读配置项 (相加 (系统目录, “\系统配置.ini”), “字体名称”, 参数_字体, “宋体”))
赋值 (字体大小, 读配置项 (相加 (系统目录, “\系统配置.ini”), “字体大小”, 参数_字体, “14”))

参数_高级表格.未知支持库函数_16 (0, 0, 参数_高级表格., 相减 (参数_高级表格., 1), 字体名称)
参数_高级表格.未知支持库函数_18 (0, 0, 参数_高级表格., 相减 (参数_高级表格., 1), 到整数 (字体大小))

.子程序 更新登录情况, 空白型, , 
.参数 参数_用户名称, 文本型, , 



.如果真 (等于 (更新登录用户信息 (_启动窗口., 相加 (“update ”, #常量_操作员表, “ set 已登录='0' where 用户名称='”, 参数_用户名称, “'”)), 假))
    信息框 (“已登录更新出错!”, 0, #提示文字)
    调试输出 (“已登录更新出错！”)
    结束 ()
.如果真结束


.子程序 更新登录用户信息, 逻辑型, , 
.参数 参数_外部数据库, 外部数据库, , 
.参数 参数_SQL语句, 文本型, , 要查询的SQL语句

.局部变量 句柄, 逻辑型, , , 

赋值 (句柄, 参数_外部数据库.执行 (参数_SQL语句, ))

返回 (句柄)




.子程序 删除当前记录, 逻辑型, , 
.参数 参数_数据库, 外部数据库, , 
.参数 参数_SQL查询语句, 文本型, , 
.参数 参数_数据表, 文本型, , 



.如果真 (等于 (参数_数据库.执行 (参数_SQL查询语句, ), 假))
    信息框 (相加 (“数据表:”, 参数_数据表, “查询失败!”), #错误图标, #提示文字)
    返回 (假)
.如果真结束
返回 (真)

.子程序 得到供应商选择列表框项目, 逻辑型, , 
.参数 参数_选择列表框, 选择列表框, , 

.局部变量 句柄, 整数型, , , 
.局部变量 SQL语句, 文本型, , , 
.局部变量 供应商, 文本型, , , 

赋值 (SQL语句, 相加 (“select * from ”, #常量_供应商表))

赋值 (句柄, _启动窗口.查询 (., SQL语句))

.如果真 (等于 (句柄, 0))
    信息框 (相加 (“数据表:”, #常量_供应商表, “查询失败!”), #错误图标, #提示文字)
    返回 (假)
.如果真结束

 ' 参数_选择列表框.清空 ()

_启动窗口.到首记录 (., 句柄)
.判断循环首 (等于 (_启动窗口.尾记录后 (., 句柄), 假))
    赋值 (供应商, _启动窗口.读 (., 句柄, “简称”))
    参数_选择列表框.加入项目 (供应商, )
    _启动窗口.到后一记录 (., 句柄)
.判断循环尾 ()

_启动窗口.关闭记录集 (., 句柄)
赋值 (参数_选择列表框.现行选中项, 0)
返回 (真)



.子程序 得到客户选择列表框项目, 逻辑型, , 
.参数 参数_选择列表框, 选择列表框, , 

.局部变量 句柄, 整数型, , , 
.局部变量 SQL语句, 文本型, , , 
.局部变量 客户, 文本型, , , 

赋值 (SQL语句, 相加 (“select * from ”, #常量_客户表))

赋值 (句柄, _启动窗口.查询 (., SQL语句))

.如果真 (等于 (句柄, 0))
    信息框 (相加 (“数据表:”, #常量_客户表, “查询失败!”), #错误图标, #提示文字)
    返回 (假)
.如果真结束

 ' 参数_选择列表框.清空 ()

_启动窗口.到首记录 (., 句柄)
.判断循环首 (等于 (_启动窗口.尾记录后 (., 句柄), 假))
    赋值 (客户, _启动窗口.读 (., 句柄, “简称”))
    参数_选择列表框.加入项目 (客户, )
    _启动窗口.到后一记录 (., 句柄)
.判断循环尾 ()

_启动窗口.关闭记录集 (., 句柄)
赋值 (参数_选择列表框.现行选中项, 0)
返回 (真)


.子程序 得到快递公司选择列表框项目, 逻辑型, , 
.参数 参数_选择列表框, 选择列表框, , 

.局部变量 句柄, 整数型, , , 
.局部变量 SQL语句, 文本型, , , 
.局部变量 公司名称, 文本型, , , 

赋值 (SQL语句, 相加 (“select * from ”, #常量_快递公司表))

赋值 (句柄, _启动窗口.查询 (., SQL语句))

.如果真 (等于 (句柄, 0))
    信息框 (相加 (“数据表:”, #常量_快递公司表, “查询失败!”), #错误图标, #提示文字)
    返回 (假)
.如果真结束

 ' 参数_选择列表框.清空 ()

_启动窗口.到首记录 (., 句柄)
.判断循环首 (等于 (_启动窗口.尾记录后 (., 句柄), 假))
    赋值 (公司名称, _启动窗口.读 (., 句柄, “简称”))
    参数_选择列表框.加入项目 (公司名称, )
    _启动窗口.到后一记录 (., 句柄)
.判断循环尾 ()

_启动窗口.关闭记录集 (., 句柄)
赋值 (参数_选择列表框.现行选中项, 0)
返回 (真)

.子程序 设置默认入库高级表格格式, 空白型, , 
.参数 参数_高级表格, 未知类型0x50001, , 


赋值 (参数_高级表格., 1)
赋值 (参数_高级表格., 0)
赋值 (参数_高级表格., 13)
赋值 (参数_高级表格., 1)
 ' 设置表头标题
参数_高级表格.未知支持库函数_9 (0, 0, 1, “日期”)
参数_高级表格.未知支持库函数_9 (0, 1, 1, “供应商”)
参数_高级表格.未知支持库函数_9 (0, 2, 1, “公司订单号”)
参数_高级表格.未知支持库函数_9 (0, 3, 1, “纱号”)
参数_高级表格.未知支持库函数_9 (0, 4, 1, “支数”)
参数_高级表格.未知支持库函数_9 (0, 5, 1, “成份”)
参数_高级表格.未知支持库函数_9 (0, 6, 1, “颜色”)
参数_高级表格.未知支持库函数_9 (0, 7, 1, “入库单号”)

参数_高级表格.未知支持库函数_9 (0, 8, 1, “进价”)
参数_高级表格.未知支持库函数_9 (0, 9, 1, “货币”)

参数_高级表格.未知支持库函数_9 (0, 10, 1, “入库数量”)
参数_高级表格.未知支持库函数_9 (0, 11, 1, “称量”)

参数_高级表格.未知支持库函数_9 (0, 12, 1, “备注”)

 ' 设置表头宽度
参数_高级表格.未知支持库函数_32 (0, 80) ' 形如:09.05.04的日期是8个字符
参数_高级表格.未知支持库函数_32 (1, 80) ' 形如 “前东”是4个字符,而“供应商”是6个字符
参数_高级表格.未知支持库函数_32 (2, 80) ' 形如 “P0905017”是8个字符
参数_高级表格.未知支持库函数_32 (3, 80) ' 形如 “LH-001510”是9个字符
参数_高级表格.未知支持库函数_32 (4, 60) ' 形如 “1/2.7”是5个字符
参数_高级表格.未知支持库函数_32 (5, 500)
参数_高级表格.未知支持库函数_32 (6, 80)
参数_高级表格.未知支持库函数_32 (7, 80)

参数_高级表格.未知支持库函数_32 (8, 80)
参数_高级表格.未知支持库函数_32 (9, 60)

参数_高级表格.未知支持库函数_32 (10, 80)
参数_高级表格.未知支持库函数_32 (11, 60)

参数_高级表格.未知支持库函数_32 (12, 60)

 ' 设置表头对齐方式
参数_高级表格.未知支持库函数_25 (0, 0, 0, 相减 (参数_高级表格., 1), #.) ' 设置表头居中对齐

.子程序 设置默认出库高级表格格式, 空白型, , 
.参数 参数_高级表格, 未知类型0x50001, , 


赋值 (参数_高级表格., 1)
赋值 (参数_高级表格., 0)
赋值 (参数_高级表格., 23)
赋值 (参数_高级表格., 1)

参数_高级表格.未知支持库函数_9 (0, 0, #., “日期”)
参数_高级表格.未知支持库函数_32 (0, 80)

参数_高级表格.未知支持库函数_9 (0, 1, #., “编号”)
参数_高级表格.未知支持库函数_32 (1, 100)

参数_高级表格.未知支持库函数_9 (0, 2, #., “客户”)
参数_高级表格.未知支持库函数_32 (2, 58)

参数_高级表格.未知支持库函数_9 (0, 3, #., “经手人”)
参数_高级表格.未知支持库函数_32 (3, 58)

参数_高级表格.未知支持库函数_9 (0, 4, #., “客户订单号”)
参数_高级表格.未知支持库函数_32 (4, 80)

参数_高级表格.未知支持库函数_9 (0, 5, #., “纱号”)
参数_高级表格.未知支持库函数_32 (5, 90)

参数_高级表格.未知支持库函数_9 (0, 6, #., “支数”)
参数_高级表格.未知支持库函数_32 (6, 50)

参数_高级表格.未知支持库函数_9 (0, 7, #., “成份”)
参数_高级表格.未知支持库函数_32 (7, 144)

参数_高级表格.未知支持库函数_9 (0, 8, #., “色号”)
参数_高级表格.未知支持库函数_32 (8, 50)

参数_高级表格.未知支持库函数_9 (0, 9, #., “颜色”)
参数_高级表格.未知支持库函数_32 (9, 50)

参数_高级表格.未知支持库函数_9 (0, 10, #., “缸号”)
参数_高级表格.未知支持库函数_32 (10, 50)

参数_高级表格.未知支持库函数_9 (0, 11, #., “单价”)
参数_高级表格.未知支持库函数_32 (11, 50)

参数_高级表格.未知支持库函数_9 (0, 12, #., “币种”)
参数_高级表格.未知支持库函数_32 (12, 50)

参数_高级表格.未知支持库函数_9 (0, 13, #., “数量”)
参数_高级表格.未知支持库函数_32 (13, 50)

参数_高级表格.未知支持库函数_9 (0, 14, #., “称量”)
参数_高级表格.未知支持库函数_32 (14, 50)

参数_高级表格.未知支持库函数_9 (0, 15, #., “金额”)
参数_高级表格.未知支持库函数_32 (15, 50)

参数_高级表格.未知支持库函数_9 (0, 16, #., “币种”)
参数_高级表格.未知支持库函数_32 (16, 50)

参数_高级表格.未知支持库函数_9 (0, 17, #., “快递公司”)
参数_高级表格.未知支持库函数_32 (17, 144)

参数_高级表格.未知支持库函数_9 (0, 18, #., “快递单号”)
参数_高级表格.未知支持库函数_32 (18, 90)

参数_高级表格.未知支持库函数_9 (0, 19, #., “件数”)
参数_高级表格.未知支持库函数_32 (19, 50)

参数_高级表格.未知支持库函数_9 (0, 20, #., “运费”)
参数_高级表格.未知支持库函数_32 (20, 50)

参数_高级表格.未知支持库函数_9 (0, 21, #., “币种”)
参数_高级表格.未知支持库函数_32 (21, 50)


参数_高级表格.未知支持库函数_9 (0, 22, #., “出库单号”)
参数_高级表格.未知支持库函数_32 (22, 90)

参数_高级表格.未知支持库函数_25 (0, 0, 0, 相减 (参数_高级表格., 1), #.)


 ' ****************************************
 ' 菜单显示可否判断模块
 ' ****************************************

.子程序 菜单显示可否, 空白型, , 
赋值 (菜单_毛纱入库录入_禁止, 多项选择 (到整数 (用户权限), 假, 真, 真))
赋值 (菜单_毛纱出库录入_禁止, 多项选择 (到整数 (用户权限), 假, 真, 真))
赋值 (菜单_毛纱入库查询_禁止, 多项选择 (到整数 (用户权限), 假, 假, 假))
赋值 (菜单_毛纱出库查询_禁止, 多项选择 (到整数 (用户权限), 假, 假, 假))
赋值 (菜单_毛纱入库统计_禁止, 多项选择 (到整数 (用户权限), 假, 假, 假))
赋值 (菜单_毛纱出库统计_禁止, 多项选择 (到整数 (用户权限), 假, 假, 假))
赋值 (菜单_系统配置_禁止, 多项选择 (到整数 (用户权限), 假, 真, 真))
赋值 (菜单_操作员管理_禁止, 多项选择 (到整数 (用户权限), 假, 假, 真))
赋值 (菜单_供应商的管理_禁止, 多项选择 (到整数 (用户权限), 假, 假, 真))
赋值 (菜单_客户数据管理_禁止, 多项选择 (到整数 (用户权限), 假, 假, 真))
赋值 (菜单_快递公司管理_禁止, 多项选择 (到整数 (用户权限), 假, 假, 真))

赋值 (_启动窗口.., 菜单_毛纱入库录入_禁止)
赋值 (_启动窗口.., 菜单_毛纱出库录入_禁止)
赋值 (_启动窗口.., 菜单_毛纱入库查询_禁止)
赋值 (_启动窗口.., 菜单_毛纱出库查询_禁止)
赋值 (_启动窗口.., 菜单_毛纱入库统计_禁止)
赋值 (_启动窗口.., 菜单_毛纱出库统计_禁止)
赋值 (_启动窗口.., 菜单_系统配置_禁止)
赋值 (_启动窗口.., 菜单_操作员管理_禁止)
赋值 (_启动窗口.., 菜单_供应商的管理_禁止)
赋值 (_启动窗口.., 菜单_客户数据管理_禁止)
赋值 (_启动窗口.., 菜单_快递公司管理_禁止)

赋值 (_启动窗口..禁止, 菜单_毛纱入库录入_禁止)
赋值 (_启动窗口..禁止, 菜单_毛纱出库录入_禁止)
赋值 (_启动窗口..禁止, 菜单_毛纱入库查询_禁止)
赋值 (_启动窗口..禁止, 菜单_毛纱出库查询_禁止)
赋值 (_启动窗口..禁止, 菜单_毛纱入库统计_禁止)
赋值 (_启动窗口..禁止, 菜单_毛纱出库统计_禁止)
赋值 (_启动窗口..禁止, 菜单_系统配置_禁止)
赋值 (_启动窗口..禁止, 菜单_操作员管理_禁止)
赋值 (_启动窗口..禁止, 菜单_供应商的管理_禁止)
赋值 (_启动窗口..禁止, 菜单_客户数据管理_禁止)
赋值 (_启动窗口..禁止, 菜单_快递公司管理_禁止)


.判断开始 (等于 (菜单_毛纱入库录入_禁止, 真))
    _启动窗口.加入状态 (., 0, #禁止)
.默认
    _启动窗口.去除状态 (., 0, #禁止)
.判断结束

.判断开始 (等于 (菜单_毛纱出库录入_禁止, 真))
    _启动窗口.加入状态 (., 1, #禁止)
.默认
    _启动窗口.去除状态 (., 1, #禁止)
.判断结束

.判断开始 (等于 (菜单_毛纱入库查询_禁止, 真))
    _启动窗口.加入状态 (., 3, #禁止)
.默认
    _启动窗口.去除状态 (., 3, #禁止)
.判断结束

.判断开始 (等于 (菜单_毛纱出库查询_禁止, 真))
    _启动窗口.加入状态 (., 4, #禁止)
.默认
    _启动窗口.去除状态 (., 4, #禁止)
.判断结束

.判断开始 (等于 (菜单_毛纱入库统计_禁止, 真))
    _启动窗口.加入状态 (., 6, #禁止)
.默认
    _启动窗口.去除状态 (., 6, #禁止)
.判断结束

.判断开始 (等于 (菜单_毛纱出库统计_禁止, 真))
    _启动窗口.加入状态 (., 7, #禁止)
.默认
    _启动窗口.去除状态 (., 7, #禁止)
.判断结束



.子程序 动画显隐窗口, 空白型, , 
.参数 窗口名称, 窗口, , 要显隐的窗口
.参数 是否载入, 逻辑型, , 指定的窗口是载入还是销毁，参数值为真则载入，值为假则销毁

.局部变量 KK, 整数型, , , 
.局部变量 LL, 整数型, , , 

.如果真 (是否载入)
    未知支持库函数_66 (窗口名称.取窗口句柄 (), 0)
    赋值 (窗口名称.可视, 真)
.如果真结束
.计次循环首 (256, KK)
    赋值 (LL, 选择 (是否载入, 相减 (KK, 1), 相减 (256, KK)))
    未知支持库函数_66 (窗口名称.取窗口句柄 (), LL)
.计次循环尾 ()
.如果真 (取反 (是否载入))
    窗口名称.销毁 ()
.如果真结束
 ' --------------------------------------------------------------------------
 ' 注册判断模块
 ' ---------------------------------------------------------------------------



.子程序 取自己的硬盘特征字, 整数型, , 
.局部变量 原始硬盘特征字, 整数型, , , 
.局部变量 自己的硬盘特征字, 整数型, , , 

赋值 (原始硬盘特征字, 取硬盘特征字 ())
.如果 (不等于 (原始硬盘特征字, 0)) ' 检查是否成功
    赋值 (自己的硬盘特征字, 位异或 (原始硬盘特征字, 623189574)) ' 根据原始的硬盘特征字计算出属于自己的硬盘特征字。此算法应该自行提供。
     ' 标签3.标题 ＝ 到文本 (自己的硬盘特征字)
    返回 (自己的硬盘特征字)
.否则
    返回 (0) ' 失败返回0
.如果结束


.子程序 检测硬盘特征字, 逻辑型, , 
赋值 (硬盘特征字, 取自己的硬盘特征字 ())

.如果真 (等于 (硬盘特征字, 0)) ' 检查是否失败
    
    赋值 (重复取硬盘特征字次数, 5) ' 给定重复尝试次数
    
    赋值 (_启动窗口..时钟周期, 300) ' 启动时钟以重复尝试。
.如果真结束

赋值 (注册用户, 读配置项 (相加 (系统目录, “\注册信息.ini”), “注册信息”, “注册用户”, ))
赋值 (注册码, 读配置项 (相加 (系统目录, “\注册信息.ini”), “注册信息”, “注册码”, ))
.判断开始 (不等于 (注册码, “”))
    .判断开始 (不等于 (注册码, 到文本 (取用户注册码 (硬盘特征字))))
        信息框 (“注册码无效，您无权使用本软件。请将您的硬盘特征字告知软件作者，以获取有效的注册码。”, 0, #提示文字)
        载入 (注册窗口, , 真)
        返回 (假)
    .默认
        
        返回 (真)
    .判断结束
    
.默认
    
    载入 (注册窗口, , 真)
    返回 (假)
.判断结束




.子程序 取用户注册码, 整数型, , 根据硬盘特征字取回对应的用户注册码
.参数 特征字, 整数型, , 

返回 (位异或 (特征字, 268319745)) ' 此算法应该自行提供。

.窗口程序集 注册窗口程序集, , , 

.子程序 _取消钮_被单击, 空白型, , 
结束 ()

.子程序 _确定钮_被单击, 空白型, , 

.判断开始 (等于 (删首尾空 (.内容), “”))
    信息框 (“用户名不能为空”, 0, #提示文字)
    获取焦点 ()
    
.默认
    
    
    .判断开始 (不等于 (.内容, 到文本 (取用户注册码 (硬盘特征字))))
        信息框 (“注册码无效，您无权使用本软件。请将您的硬盘特征字告知软件作者，以获取有效的注册码。”, 0, #提示文字)
        获取焦点 ()
    .默认
        
        写配置项 (相加 (系统目录, “\注册信息.ini”), “注册信息”, “注册用户”, .内容)
        写配置项 (相加 (系统目录, “\注册信息.ini”), “注册信息”, “注册码”, .内容)
        信息框 (“注册成功！”, 0, #提示文字)
        销毁 ()
    .判断结束
    
.判断结束




.子程序 _注册窗口_可否被关闭, 逻辑型, , 
返回 (假)


.子程序 _注册窗口_创建完毕, 空白型, , 
赋值 (.内容, 读配置项 (相加 (系统目录, “\注册信息.ini”), “注册信息”, “注册用户”, “”))
赋值 (硬盘特征字, 取自己的硬盘特征字 ())

.如果真 (等于 (硬盘特征字, 0)) ' 检查是否失败
    
    赋值 (重复取硬盘特征字次数, 5) ' 给定重复尝试次数
    
    赋值 (_启动窗口..时钟周期, 300) ' 启动时钟以重复尝试。
.如果真结束

赋值 (.内容, 到文本 (硬盘特征字))


.子程序 _时钟1_周期事件, 空白型, , 
赋值 (硬盘特征字, 取自己的硬盘特征字 ())
.如果 (不等于 (硬盘特征字, 0))
    赋值 (.时钟周期, 0) ' 如果已经成功，停住时钟。
.否则
    赋值 (重复取硬盘特征字次数, 相减 (重复取硬盘特征字次数, 1))
    .如果真 (等于 (重复取硬盘特征字次数, 0)) ' 如果尝试次数已经已到，则表明失败。
        赋值 (.时钟周期, 0) ' 停住时钟
        赋值 (硬盘特征字, 19731115) ' 由于失败也是一种特征状态，所以可以给一个固定的特征值，用于代表此状态。
    .如果真结束
    
.如果结束


.子程序 _编辑框_注册用户名_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框_注册码_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    激活 ()
.如果真结束


.程序集 入库查询程序集, , , 

.子程序 查询所有入库数据, 整数型, , 
.参数 参数_外部数据库, 外部数据库, , 
.参数 参数_高级表格, 未知类型0x50001, , 
.参数 参数_SQL条件, 文本型, , 

.局部变量 数据库句柄, 整数型, , , 
.局部变量 SQL查询, 文本型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 计次变量, 整数型, , , 
.局部变量 匿名局部变量_9209, 空白型, , , 
.局部变量 日期, 文本型, , , 
.局部变量 供应商, 文本型, , , 
.局部变量 公司定单号, 文本型, , , 
.局部变量 纱号, 文本型, , , 
.局部变量 支数, 文本型, , , 
.局部变量 成份, 文本型, , , 
.局部变量 颜色, 文本型, , , 
.局部变量 入库单号, 文本型, , , 
.局部变量 匿名局部变量_9217, 空白型, , , 
.局部变量 单价, 文本型, , , 
.局部变量 进价币种, 文本型, , , 
.局部变量 匿名局部变量_9221, 空白型, , , 
.局部变量 数量, 文本型, , , 
.局部变量 入库称量, 文本型, , , 
.局部变量 匿名局部变量_9211, 空白型, , , 
.局部变量 备注, 文本型, , , 

赋值 (SQL查询, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_入库表, 参数_SQL条件))

赋值 (数据库句柄, 参数_外部数据库.查询 (SQL查询)) ' 功能一、获得数据库句柄。功能二、生成一个临时的字段 记录总数

.如果真 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_入库表, “查询失败!”), #错误图标, #提示文字)
    返回 (0)
.如果真结束

赋值 (记录总数, 参数_外部数据库.读 (数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得

 ' 调试输出 (到文本 (记录总数))
 ' ---------------------------------------------------------------
赋值 (SQL查询, 相加 (“select * from ”, #常量_入库表, 参数_SQL条件))
赋值 (数据库句柄, 参数_外部数据库.查询 (SQL查询))

参数_外部数据库.到首记录 (数据库句柄)
.计次循环首 (记录总数, 计次变量)
    赋值 (日期, 取日期文本 (参数_外部数据库.读 (数据库句柄, “日期”)))
    
    赋值 (供应商, 删首空 (参数_外部数据库.读 (数据库句柄, “供应商”)))
    赋值 (公司定单号, 删首空 (参数_外部数据库.读 (数据库句柄, “公司定单号”)))
    赋值 (纱号, 删首空 (参数_外部数据库.读 (数据库句柄, “纱号”)))
    赋值 (支数, 删首空 (参数_外部数据库.读 (数据库句柄, “支数”)))
    赋值 (成份, 删首空 (参数_外部数据库.读 (数据库句柄, “成份”)))
    赋值 (颜色, 删首空 (参数_外部数据库.读 (数据库句柄, “颜色”)))
    赋值 (入库单号, 删首空 (参数_外部数据库.读 (数据库句柄, “入库单号”)))
    
    赋值 (单价, 删首空 (参数_外部数据库.读 (数据库句柄, “进价”)))
    赋值 (进价币种, 删首空 (参数_外部数据库.读 (数据库句柄, “进价币种”)))
    
    赋值 (数量, 删首空 (参数_外部数据库.读 (数据库句柄, “数量”)))
    赋值 (入库称量, 删首空 (参数_外部数据库.读 (数据库句柄, “入库称量”)))
    
    赋值 (备注, 删首空 (参数_外部数据库.读 (数据库句柄, “备注”)))
    
    参数_高级表格.未知支持库函数_38 ()
    
    参数_高级表格.未知支持库函数_9 (计次变量, 0, #., 日期)
    参数_高级表格.未知支持库函数_9 (计次变量, 1, #., 供应商)
    参数_高级表格.未知支持库函数_9 (计次变量, 2, #., 公司定单号)
    参数_高级表格.未知支持库函数_9 (计次变量, 3, #., 纱号)
    参数_高级表格.未知支持库函数_9 (计次变量, 4, #., 支数)
    参数_高级表格.未知支持库函数_9 (计次变量, 5, #., 成份)
    参数_高级表格.未知支持库函数_9 (计次变量, 6, #., 颜色)
    参数_高级表格.未知支持库函数_9 (计次变量, 7, #., 入库单号)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 8, #., 单价)
    参数_高级表格.未知支持库函数_9 (计次变量, 9, #., 进价币种)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 10, #., 数量)
    参数_高级表格.未知支持库函数_9 (计次变量, 11, #., 入库称量)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 12, #., 备注)
    
    
    参数_外部数据库.到后一记录 (数据库句柄)
.计次循环尾 ()

参数_高级表格.未知支持库函数_0 (相减 (参数_高级表格., 1), 0)
参数_外部数据库.关闭记录集 (数据库句柄)
返回 (记录总数)

.程序集 出库查询程序集, , , 

.子程序 查询所有出库数据, 整数型, , 
.参数 参数_外部数据库, 外部数据库, , 
.参数 参数_高级表格, 未知类型0x50001, , 
.参数 参数_SQL条件, 文本型, , 

.局部变量 数据库句柄, 整数型, , , 
.局部变量 SQL查询1, 文本型, , , 
.局部变量 条件记录总数, 整数型, , , 
.局部变量 计次变量, 整数型, , , 
.局部变量 SQL_查询2, 文本型, , , 
.局部变量 日期, 文本型, , , 
.局部变量 编号, 文本型, , , 
.局部变量 客户, 文本型, , , 
.局部变量 经手人, 文本型, , , 
.局部变量 客户订单号, 文本型, , , 
.局部变量 纱号, 文本型, , , 
.局部变量 支数, 文本型, , , 
.局部变量 成份, 文本型, , , 
.局部变量 色号, 文本型, , , 
.局部变量 颜色, 文本型, , , 
.局部变量 缸号, 文本型, , , 
.局部变量 单价, 文本型, , , 
.局部变量 数量, 文本型, , , 
.局部变量 金额, 文本型, , , 
.局部变量 快递公司, 文本型, , , 
.局部变量 快递单号, 文本型, , , 
.局部变量 件数, 文本型, , , 
.局部变量 运费, 文本型, , , 
.局部变量 出库单号, 文本型, , , 
.局部变量 日期_日期, 日期时间型, , , 
.局部变量 单价币种, 文本型, , , 
.局部变量 数量称量, 文本型, , , 
.局部变量 金额币种, 文本型, , , 
.局部变量 运费币种, 文本型, , , 



赋值 (SQL查询1, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_出库表, 参数_SQL条件))

赋值 (数据库句柄, 参数_外部数据库.查询 (SQL查询1)) ' 功能一、获得数据库句柄。功能二、生成一个临时的字段 记录总数

.如果真 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_出库表, “查询失败!”), #错误图标, #提示文字)
    返回 (0)
.如果真结束

赋值 (条件记录总数, 参数_外部数据库.读 (数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得
 ' 调试输出 (到文本 (记录总数))
 ' ---------------------------------------------------------------
赋值 (SQL_查询2, 相加 (“select * from ”, #常量_出库表, 参数_SQL条件))
赋值 (数据库句柄, 参数_外部数据库.查询 (SQL_查询2))

参数_外部数据库.到首记录 (数据库句柄)
.计次循环首 (条件记录总数, 计次变量)
    
    赋值 (日期, 取日期文本 (参数_外部数据库.读 (数据库句柄, “日期”)))
    
    赋值 (编号, 删首空 (参数_外部数据库.读 (数据库句柄, “编号”)))
    赋值 (客户, 删首空 (参数_外部数据库.读 (数据库句柄, “客户”)))
    赋值 (经手人, 删首空 (参数_外部数据库.读 (数据库句柄, “经手人”)))
    赋值 (客户订单号, 删首空 (参数_外部数据库.读 (数据库句柄, “客户订单号”)))
    赋值 (纱号, 删首空 (参数_外部数据库.读 (数据库句柄, “纱号”)))
    赋值 (支数, 删首空 (参数_外部数据库.读 (数据库句柄, “支数”)))
    赋值 (成份, 删首空 (参数_外部数据库.读 (数据库句柄, “成份”)))
    赋值 (色号, 删首空 (参数_外部数据库.读 (数据库句柄, “色号”)))
    赋值 (颜色, 删首空 (参数_外部数据库.读 (数据库句柄, “颜色”)))
    赋值 (缸号, 删首空 (参数_外部数据库.读 (数据库句柄, “缸号”)))
    
    赋值 (单价, 删首空 (参数_外部数据库.读 (数据库句柄, “单价”)))
    赋值 (单价币种, 删首空 (参数_外部数据库.读 (数据库句柄, “单价币种”)))
    
    赋值 (数量, 删首空 (参数_外部数据库.读 (数据库句柄, “数量”)))
    赋值 (数量称量, 删首空 (参数_外部数据库.读 (数据库句柄, “数量称量”)))
    
    赋值 (金额, 删首空 (参数_外部数据库.读 (数据库句柄, “金额”)))
    赋值 (金额币种, 删首空 (参数_外部数据库.读 (数据库句柄, “金额币种”)))
    
    赋值 (快递公司, 删首空 (参数_外部数据库.读 (数据库句柄, “快递公司”)))
    赋值 (快递单号, 删首空 (参数_外部数据库.读 (数据库句柄, “快递单号”)))
    赋值 (件数, 删首空 (参数_外部数据库.读 (数据库句柄, “件数”)))
    
    赋值 (运费, 删首空 (参数_外部数据库.读 (数据库句柄, “运费”)))
    赋值 (运费币种, 删首空 (参数_外部数据库.读 (数据库句柄, “运费币种”)))
    
    赋值 (出库单号, 删首空 (参数_外部数据库.读 (数据库句柄, “出库单号”)))
    
    参数_高级表格.未知支持库函数_38 ()
    
    参数_高级表格.未知支持库函数_9 (计次变量, 0, #., 日期)
    参数_高级表格.未知支持库函数_9 (计次变量, 1, #., 编号)
    参数_高级表格.未知支持库函数_9 (计次变量, 2, #., 客户)
    参数_高级表格.未知支持库函数_9 (计次变量, 3, #., 经手人)
    参数_高级表格.未知支持库函数_9 (计次变量, 4, #., 客户订单号)
    参数_高级表格.未知支持库函数_9 (计次变量, 5, #., 纱号)
    参数_高级表格.未知支持库函数_9 (计次变量, 6, #., 支数)
    参数_高级表格.未知支持库函数_9 (计次变量, 7, #., 成份)
    参数_高级表格.未知支持库函数_9 (计次变量, 8, #., 色号)
    参数_高级表格.未知支持库函数_9 (计次变量, 9, #., 颜色)
    参数_高级表格.未知支持库函数_9 (计次变量, 10, #., 缸号)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 11, #., 单价)
    参数_高级表格.未知支持库函数_9 (计次变量, 12, #., 单价币种)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 13, #., 数量)
    参数_高级表格.未知支持库函数_9 (计次变量, 14, #., 数量称量)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 15, #., 金额)
    参数_高级表格.未知支持库函数_9 (计次变量, 16, #., 金额币种)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 17, #., 快递公司)
    参数_高级表格.未知支持库函数_9 (计次变量, 18, #., 快递单号)
    参数_高级表格.未知支持库函数_9 (计次变量, 19, #., 件数)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 20, #., 运费)
    参数_高级表格.未知支持库函数_9 (计次变量, 21, #., 运费币种)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 22, #., 出库单号)
    
    参数_外部数据库.到后一记录 (数据库句柄)
.计次循环尾 ()
 ' 参数_高级表格.插入行 (, )
参数_高级表格.未知支持库函数_0 (相减 (参数_高级表格., 1), 0)
参数_外部数据库.关闭记录集 (数据库句柄)
返回 (条件记录总数)


.程序集 入库统计程序集, , , 

.子程序 指定供应商所有的数据, 文本型, , 
.局部变量 SQL查询条件, 文本型, , , 

 ' 指定供应商所有的数据
.判断开始 (不等于 (_启动窗口..内容, “所有供应商”))
    赋值 (SQL查询条件, 相加 (“ and 供应商='”, _启动窗口..内容, “'”))
.默认
    
    赋值 (SQL查询条件, “”)
.判断结束

返回 (SQL查询条件)


.子程序 进价币种, 文本型, , 
.局部变量 SQL查询条件, 文本型, , , 

赋值 (SQL查询条件, 相加 (“ and 进价币种='”, _启动窗口..内容, “'”))
返回 (SQL查询条件)

.子程序 显示统计所有入库数据, 总量数据类型, , 
.参数 参数_外部数据库, 外部数据库, , 
.参数 参数_高级表格, 未知类型0x50001, , 
.参数 参数_SQL条件, 文本型, , 

.局部变量 数据库句柄, 整数型, , , 
.局部变量 SQL查询1, 文本型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 计次变量, 整数型, , , 
.局部变量 SQL_查询2, 文本型, , , 
.局部变量 日期, 文本型, , , 
.局部变量 供应商, 文本型, , , 
.局部变量 公司定单号, 文本型, , , 
.局部变量 纱号, 文本型, , , 
.局部变量 支数, 文本型, , , 
.局部变量 成份, 文本型, , , 
.局部变量 颜色, 文本型, , , 
.局部变量 单价, 文本型, , , 
.局部变量 数量, 文本型, , , 
.局部变量 库存, 文本型, , , 
.局部变量 备注, 文本型, , , 
.局部变量 入库单号, 文本型, , , 
.局部变量 返回内容, 总量数据类型, , , 
.局部变量 金额, 小数型, , , 
.局部变量 总金额, 小数型, , , 
.局部变量 总数量, 小数型, , , 
.局部变量 进价币种, 文本型, , , 
.局部变量 入库称量, 文本型, , , 

赋值 (SQL查询1, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_入库表, 参数_SQL条件))

赋值 (数据库句柄, 参数_外部数据库.查询 (SQL查询1)) ' 功能一、获得数据库句柄。功能二、生成一个临时的字段 记录总数

.如果真 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_入库表, “查询失败!”), #错误图标, #提示文字)
    返回 (返回内容)
.如果真结束

赋值 (记录总数, 参数_外部数据库.读 (数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得

 ' 调试输出 (到文本 (记录总数))
 ' ---------------------------------------------------------------
赋值 (SQL_查询2, 相加 (“select * from ”, #常量_入库表, 参数_SQL条件))
赋值 (数据库句柄, 参数_外部数据库.查询 (SQL_查询2))

参数_外部数据库.到首记录 (数据库句柄)
.计次循环首 (记录总数, 计次变量)
    赋值 (日期, 取日期文本 (参数_外部数据库.读 (数据库句柄, “日期”)))
    
    赋值 (供应商, 删首空 (参数_外部数据库.读 (数据库句柄, “供应商”)))
    赋值 (公司定单号, 删首空 (参数_外部数据库.读 (数据库句柄, “公司定单号”)))
    赋值 (纱号, 删首空 (参数_外部数据库.读 (数据库句柄, “纱号”)))
    赋值 (支数, 删首空 (参数_外部数据库.读 (数据库句柄, “支数”)))
    赋值 (成份, 删首空 (参数_外部数据库.读 (数据库句柄, “成份”)))
    赋值 (颜色, 删首空 (参数_外部数据库.读 (数据库句柄, “颜色”)))
    赋值 (入库单号, 删首空 (参数_外部数据库.读 (数据库句柄, “入库单号”)))
    
    赋值 (单价, 删首空 (参数_外部数据库.读 (数据库句柄, “进价”)))
    赋值 (进价币种, 删首空 (参数_外部数据库.读 (数据库句柄, “进价币种”)))
    
    赋值 (数量, 删首空 (参数_外部数据库.读 (数据库句柄, “数量”)))
    赋值 (入库称量, 删首空 (参数_外部数据库.读 (数据库句柄, “入库称量”)))
    
    赋值 (备注, 删首空 (参数_外部数据库.读 (数据库句柄, “备注”)))
    
    赋值 (金额, 相乘 (到小数 (单价), 到小数 (数量)))
    赋值 (总金额, 相加 (总金额, 金额))
    
    赋值 (总数量, 相加 (总数量, 到小数 (数量)))
    
    
    参数_高级表格.未知支持库函数_38 ()
    
    参数_高级表格.未知支持库函数_9 (计次变量, 0, #., 日期)
    参数_高级表格.未知支持库函数_9 (计次变量, 1, #., 供应商)
    参数_高级表格.未知支持库函数_9 (计次变量, 2, #., 公司定单号)
    参数_高级表格.未知支持库函数_9 (计次变量, 3, #., 纱号)
    参数_高级表格.未知支持库函数_9 (计次变量, 4, #., 支数)
    参数_高级表格.未知支持库函数_9 (计次变量, 5, #., 成份)
    参数_高级表格.未知支持库函数_9 (计次变量, 6, #., 颜色)
    参数_高级表格.未知支持库函数_9 (计次变量, 7, #., 入库单号)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 8, #., 单价)
    参数_高级表格.未知支持库函数_9 (计次变量, 9, #., 进价币种)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 10, #., 数量)
    参数_高级表格.未知支持库函数_9 (计次变量, 11, #., 入库称量)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 12, #., 备注)
    
    参数_外部数据库.到后一记录 (数据库句柄)
.计次循环尾 ()

参数_高级表格.未知支持库函数_38 ()

参数_高级表格.未知支持库函数_9 (计次变量, 6, #., “总数量：”)
参数_高级表格.未知支持库函数_9 (计次变量, 7, #., 到文本 (总数量))
参数_高级表格.未知支持库函数_9 (计次变量, 8, #., 入库称量)
参数_高级表格.未知支持库函数_9 (计次变量, 9, #., “总金额：”)
参数_高级表格.未知支持库函数_9 (计次变量, 10, #., 到文本 (总金额))
参数_高级表格.未知支持库函数_9 (计次变量, 11, #., 进价币种)



参数_高级表格.未知支持库函数_0 (相减 (参数_高级表格., 1), 0)
参数_外部数据库.关闭记录集 (数据库句柄)

赋值 (返回内容.币种, 进价币种)
赋值 (返回内容.称量, 入库称量)
赋值 (返回内容.总数量, 总数量)
赋值 (返回内容.总金额, 总金额)
返回 (返回内容)


.子程序 曲线图入库, 空白型, , 显示每月的总量数据曲线图
.局部变量 币种, 文本型, , , 
.局部变量 称量, 文本型, , , 
.局部变量 临时总量数据, 总量数据类型, , "12", 
.局部变量 最大值, 整数型, , , 
.局部变量 计次变量, 整数型, , , 
.局部变量 n, 整数型, , , 
.局部变量 当前图例文字1, 文本型, , , 
.局部变量 Y轴单位1, 文本型, , , 
.局部变量 当前图例文字2, 文本型, , , 
.局部变量 Y轴单位2, 文本型, , , 


赋值 (临时总量数据 [1], 统计所有入库数据 (_启动窗口., 相加 (一月里所有的数据 (), 指定供应商所有的数据 (), 进价币种 ())))
赋值 (临时总量数据 [2], 统计所有入库数据 (_启动窗口., 相加 (二月里所有的数据 (), 指定供应商所有的数据 (), 进价币种 ())))
赋值 (临时总量数据 [3], 统计所有入库数据 (_启动窗口., 相加 (三月里所有的数据 (), 指定供应商所有的数据 (), 进价币种 ())))
赋值 (临时总量数据 [4], 统计所有入库数据 (_启动窗口., 相加 (四月里所有的数据 (), 指定供应商所有的数据 (), 进价币种 ())))
赋值 (临时总量数据 [5], 统计所有入库数据 (_启动窗口., 相加 (五月里所有的数据 (), 指定供应商所有的数据 (), 进价币种 ())))
赋值 (临时总量数据 [6], 统计所有入库数据 (_启动窗口., 相加 (六月里所有的数据 (), 指定供应商所有的数据 (), 进价币种 ())))
赋值 (临时总量数据 [7], 统计所有入库数据 (_启动窗口., 相加 (七月里所有的数据 (), 指定供应商所有的数据 (), 进价币种 ())))
赋值 (临时总量数据 [8], 统计所有入库数据 (_启动窗口., 相加 (八月里所有的数据 (), 指定供应商所有的数据 (), 进价币种 ())))
赋值 (临时总量数据 [9], 统计所有入库数据 (_启动窗口., 相加 (九月里所有的数据 (), 指定供应商所有的数据 (), 进价币种 ())))
赋值 (临时总量数据 [10], 统计所有入库数据 (_启动窗口., 相加 (十月里所有的数据 (), 指定供应商所有的数据 (), 进价币种 ())))
赋值 (临时总量数据 [11], 统计所有入库数据 (_启动窗口., 相加 (十一月里所有的数据 (), 指定供应商所有的数据 (), 进价币种 ())))
赋值 (临时总量数据 [12], 统计所有入库数据 (_启动窗口., 相加 (十二月里所有的数据 (), 指定供应商所有的数据 (), 进价币种 ())))

.计次循环首 (12, 计次变量)
    .如果真 (小于或等于 (相加 (计次变量, 1), 12))
        .判断开始 (大于 (临时总量数据 [相加 (计次变量, 1)].总数量, 临时总量数据 [计次变量], 总数量))
            赋值 (最大值, 临时总量数据 [相加 (计次变量, 1)].总数量)
            赋值 (n, 相加 (计次变量, 1))
            
        .默认
            
        .判断结束
        
    .如果真结束
    
.计次循环尾 ()
调试输出 (到文本 (最大值))
调试输出 (到文本 (n))


.判断开始 (等于 (临时总量数据 [n], 币种, “RMB”))
    .判断开始 (大于 (临时总量数据 [n], 总金额, 1000)) ' 如果总数量大于1000kg则用吨表示单位，否则用公斤表示单位
        赋值 (当前图例文字1, “总数量(吨)”) ' 如果总金额大于1000元则用千元表示单位，否则用元表示单位
        赋值 (Y轴单位1, “吨(千元)”)
    .默认
        
        赋值 (当前图例文字1, “总数量(公斤)”)
        赋值 (Y轴单位1, “公斤(元)”)
    .判断结束
    
    .判断开始 (大于 (临时总量数据 [n], 总数量, 1000))
        赋值 (当前图例文字2, “总金额(千元)”)
        赋值 (Y轴单位2, “吨(千元)”)
    .默认
        
        赋值 (当前图例文字2, “总金额(元)”)
        赋值 (Y轴单位2, “公斤(元)”)
    .判断结束
    
.默认
    
    .判断开始 (大于 (临时总量数据 [n], 总金额, 1000))
        赋值 (当前图例文字1, “总数量(千磅)”)
        赋值 (Y轴单位1, “千磅(千美元)”)
    .默认
        
        赋值 (当前图例文字1, “总数量(磅)”)
        赋值 (Y轴单位1, “磅(美元)”)
    .判断结束
    
    .判断开始 (大于 (临时总量数据 [n], 总数量, 1000))
        赋值 (当前图例文字2, “总金额(千美元)”)
        赋值 (Y轴单位2, “千磅(千美元)”)
        
    .默认
        赋值 (当前图例文字2, “总金额(美元)”)
        赋值 (Y轴单位2, “磅(美元)”)
    .判断结束
    
.判断结束



赋值 (_启动窗口.., 2)

赋值 (_启动窗口.., Y轴单位1)
赋值 (_启动窗口.., 0)
赋值 (_启动窗口.., 当前图例文字1)
赋值 (_启动窗口.., #红色)

.计次循环首 (12, 计次变量)
    赋值 (_启动窗口.., 相减 (计次变量, 1))
    赋值 (_启动窗口.., 临时总量数据 [计次变量], 总数量)
.计次循环尾 ()


赋值 (_启动窗口.., Y轴单位2)
赋值 (_启动窗口.., 1)
赋值 (_启动窗口.., 当前图例文字2)
赋值 (_启动窗口.., #天蓝)

.计次循环首 (12, 计次变量)
    赋值 (_启动窗口.., 相减 (计次变量, 1))
    赋值 (_启动窗口.., 临时总量数据 [计次变量], 总金额)
.计次循环尾 ()




.子程序 统计所有入库数据, 总量数据类型, , 
.参数 参数_外部数据库, 外部数据库, , 
.参数 参数_SQL条件, 文本型, , 

.局部变量 数据库句柄, 整数型, , , 
.局部变量 SQL查询1, 文本型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 计次变量, 整数型, , , 
.局部变量 SQL_查询2, 文本型, , , 
.局部变量 日期, 文本型, , , 
.局部变量 供应商, 文本型, , , 
.局部变量 公司定单号, 文本型, , , 
.局部变量 纱号, 文本型, , , 
.局部变量 支数, 文本型, , , 
.局部变量 成份, 文本型, , , 
.局部变量 颜色, 文本型, , , 
.局部变量 单价, 文本型, , , 
.局部变量 数量, 文本型, , , 
.局部变量 库存, 文本型, , , 
.局部变量 备注, 文本型, , , 
.局部变量 入库单号, 文本型, , , 
.局部变量 返回内容, 总量数据类型, , , 
.局部变量 金额, 小数型, , , 
.局部变量 总金额, 小数型, , , 
.局部变量 总数量, 小数型, , , 
.局部变量 进价币种, 文本型, , , 
.局部变量 入库称量, 文本型, , , 

赋值 (SQL查询1, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_入库表, 参数_SQL条件))

赋值 (数据库句柄, 参数_外部数据库.查询 (SQL查询1)) ' 功能一、获得数据库句柄。功能二、生成一个临时的字段 记录总数

.如果真 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_入库表, “查询失败!”), #错误图标, #提示文字)
    返回 (返回内容)
.如果真结束

赋值 (记录总数, 参数_外部数据库.读 (数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得

 ' 调试输出 (到文本 (记录总数))
 ' ---------------------------------------------------------------
赋值 (SQL_查询2, 相加 (“select * from ”, #常量_入库表, 参数_SQL条件))
赋值 (数据库句柄, 参数_外部数据库.查询 (SQL_查询2))

参数_外部数据库.到首记录 (数据库句柄)
.计次循环首 (记录总数, 计次变量)
    赋值 (日期, 取日期文本 (参数_外部数据库.读 (数据库句柄, “日期”)))
    
    赋值 (供应商, 删首空 (参数_外部数据库.读 (数据库句柄, “供应商”)))
    赋值 (公司定单号, 删首空 (参数_外部数据库.读 (数据库句柄, “公司定单号”)))
    赋值 (纱号, 删首空 (参数_外部数据库.读 (数据库句柄, “纱号”)))
    赋值 (支数, 删首空 (参数_外部数据库.读 (数据库句柄, “支数”)))
    赋值 (成份, 删首空 (参数_外部数据库.读 (数据库句柄, “成份”)))
    赋值 (颜色, 删首空 (参数_外部数据库.读 (数据库句柄, “颜色”)))
    赋值 (入库单号, 删首空 (参数_外部数据库.读 (数据库句柄, “入库单号”)))
    
    赋值 (单价, 删首空 (参数_外部数据库.读 (数据库句柄, “进价”)))
    赋值 (进价币种, 删首空 (参数_外部数据库.读 (数据库句柄, “进价币种”)))
    
    赋值 (数量, 删首空 (参数_外部数据库.读 (数据库句柄, “数量”)))
    赋值 (入库称量, 删首空 (参数_外部数据库.读 (数据库句柄, “入库称量”)))
    
    赋值 (备注, 删首空 (参数_外部数据库.读 (数据库句柄, “备注”)))
    
    赋值 (金额, 相乘 (到小数 (单价), 到小数 (数量)))
    赋值 (总金额, 相加 (总金额, 金额))
    
    赋值 (总数量, 相加 (总数量, 到小数 (数量)))
    
    参数_外部数据库.到后一记录 (数据库句柄)
.计次循环尾 ()

参数_外部数据库.关闭记录集 (数据库句柄)
赋值 (返回内容.币种, 进价币种)
赋值 (返回内容.称量, 入库称量)
赋值 (返回内容.总数量, 总数量)
赋值 (返回内容.总金额, 总金额)

返回 (返回内容)


.程序集 客户管理程序集, , , 

.子程序 设置默认客户高级表格格式, 空白型, , 
.参数 参数_高级表格, 未知类型0x50001, , 


赋值 (参数_高级表格., 1)
赋值 (参数_高级表格., 0)
赋值 (参数_高级表格., 7)
赋值 (参数_高级表格., 1)
 ' 设置表头标题
参数_高级表格.未知支持库函数_9 (0, 0, #., “客户公司全称”)
参数_高级表格.未知支持库函数_9 (0, 1, #., “简称”)
参数_高级表格.未知支持库函数_9 (0, 2, #., “务员”)
参数_高级表格.未知支持库函数_9 (0, 3, #., “客户公司地址”)
参数_高级表格.未知支持库函数_9 (0, 4, #., “客户公司网址”)
参数_高级表格.未知支持库函数_9 (0, 5, #., “客户公司电话”)
参数_高级表格.未知支持库函数_9 (0, 6, #., “客户公司传真”)
 ' 设置表头宽度
参数_高级表格.未知支持库函数_32 (0, 200)
参数_高级表格.未知支持库函数_32 (1, 80)
参数_高级表格.未知支持库函数_32 (2, 100)
参数_高级表格.未知支持库函数_32 (3, 200)
参数_高级表格.未知支持库函数_32 (4, 200)
参数_高级表格.未知支持库函数_32 (5, 80)
参数_高级表格.未知支持库函数_32 (6, 80)
 ' 设置表头对齐方式
参数_高级表格.未知支持库函数_25 (0, 0, 0, 11, #.) ' 设置表头居中对齐


.子程序 显示所有客户数据, 整数型, , 
.参数 参数_外部数据库, 外部数据库, , 
.参数 参数_高级表格, 未知类型0x50001, , 
.参数 参数_SQL条件, 文本型, , 

.局部变量 计次变量, 整数型, , , 
.局部变量 SQL查询1, 文本型, , , 
.局部变量 SQL_查询2, 文本型, , , 
.局部变量 数据库句柄, 整数型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 客户公司全称, 文本型, , , 
.局部变量 客户公司简称, 文本型, , , 
.局部变量 客户公司业务员, 文本型, , , 
.局部变量 客户公司地址, 文本型, , , 
.局部变量 客户公司网址, 文本型, , , 
.局部变量 客户公司电话, 文本型, , , 
.局部变量 客户公司传真, 文本型, , , 

赋值 (SQL查询1, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_客户表, 参数_SQL条件))

赋值 (数据库句柄, 参数_外部数据库.查询 (SQL查询1)) ' 功能一、获得数据库句柄。功能二、生成一个临时的字段 记录总数

.如果真 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_客户表, “查询失败!”), #错误图标, #提示文字)
    
    返回 (0)
.如果真结束

赋值 (记录总数, 参数_外部数据库.读 (数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得

 ' 调试输出 (到文本 (记录总数))
 ' ---------------------------------------------------------------
赋值 (SQL_查询2, 相加 (“select * from ”, #常量_客户表, 参数_SQL条件))

赋值 (数据库句柄, 参数_外部数据库.查询 (SQL_查询2))

参数_外部数据库.到首记录 (数据库句柄)
.计次循环首 (记录总数, 计次变量)
    
    赋值 (客户公司全称, 删首空 (参数_外部数据库.读 (数据库句柄, “全称”)))
    
    赋值 (客户公司简称, 删首空 (参数_外部数据库.读 (数据库句柄, “简称”)))
    
    赋值 (客户公司业务员, 参数_外部数据库.读 (数据库句柄, “业务员”))
    
    赋值 (客户公司地址, 删首空 (参数_外部数据库.读 (数据库句柄, “地址”)))
    
    赋值 (客户公司网址, 删首空 (参数_外部数据库.读 (数据库句柄, “网址”)))
    
    赋值 (客户公司电话, 删首空 (参数_外部数据库.读 (数据库句柄, “电话”)))
    
    赋值 (客户公司传真, 删首空 (参数_外部数据库.读 (数据库句柄, “传真”)))
    
    参数_高级表格.未知支持库函数_38 ()
    
    参数_高级表格.未知支持库函数_9 (计次变量, 0, #., 客户公司全称)
    参数_高级表格.未知支持库函数_9 (计次变量, 1, #., 客户公司简称)
    参数_高级表格.未知支持库函数_9 (计次变量, 2, #., 客户公司业务员)
    参数_高级表格.未知支持库函数_9 (计次变量, 3, #., 客户公司地址)
    参数_高级表格.未知支持库函数_9 (计次变量, 4, #., 客户公司网址)
    参数_高级表格.未知支持库函数_9 (计次变量, 5, #., 客户公司电话)
    参数_高级表格.未知支持库函数_9 (计次变量, 6, #., 客户公司传真)
    
    参数_外部数据库.到后一记录 (数据库句柄)
.计次循环尾 ()
参数_高级表格.未知支持库函数_38 ()

参数_高级表格.未知支持库函数_0 (相减 (参数_高级表格., 1), 0)
参数_外部数据库.关闭记录集 (数据库句柄)
返回 (记录总数)


.子程序 高级表格_客户_内容被改变, 空白型, , 
高级表格_客户_客户公司全称_内容被改变 ()
高级表格_客户_客户公司简称_内容被改变 ()
高级表格_客户_客户公司业务员_内容被改变 ()
高级表格_客户_客户公司地址_内容被改变 ()
高级表格_客户_客户公司网址_内容被改变 ()
高级表格_客户_客户公司电话_内容被改变 ()
高级表格_客户_客户公司传真_内容被改变 ()

.子程序 高级表格_客户_客户公司全称_内容被改变, 空白型, , 
_启动窗口.未知支持库函数_9 (., 客户_编辑行号, 0, #., _启动窗口..内容)

.子程序 高级表格_客户_客户公司简称_内容被改变, 空白型, , 
_启动窗口.未知支持库函数_9 (., 客户_编辑行号, 1, #., _启动窗口..内容)

.子程序 高级表格_客户_客户公司业务员_内容被改变, 空白型, , 
_启动窗口.未知支持库函数_9 (., 客户_编辑行号, 2, #., _启动窗口..内容)

.子程序 高级表格_客户_客户公司地址_内容被改变, 空白型, , 
_启动窗口.未知支持库函数_9 (., 客户_编辑行号, 3, #., _启动窗口..内容)

.子程序 高级表格_客户_客户公司网址_内容被改变, 空白型, , 
_启动窗口.未知支持库函数_9 (., 客户_编辑行号, 4, #., _启动窗口..内容)

.子程序 高级表格_客户_客户公司电话_内容被改变, 空白型, , 
_启动窗口.未知支持库函数_9 (., 客户_编辑行号, 5, #., _启动窗口..内容)

.子程序 高级表格_客户_客户公司传真_内容被改变, 空白型, , 
_启动窗口.未知支持库函数_9 (., 客户_编辑行号, 6, #., _启动窗口..内容)


.子程序 通过客户公司简称得到当前其它数据, 空白型, , 
.参数 参数_外部数据库, 外部数据库, , 
.参数 参数_客户公司简称, 文本型, , 

.局部变量 数据库句柄, 整数型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 计次变量, 整数型, , , 
.局部变量 客户公司全称, 文本型, , , 
.局部变量 客户公司简称, 文本型, , , 
.局部变量 客户公司业务员, 文本型, , , 
.局部变量 客户公司地址, 文本型, , , 
.局部变量 客户公司网址, 文本型, , , 
.局部变量 客户公司电话, 文本型, , , 
.局部变量 客户公司传真, 文本型, , , 
.局部变量 SQL_查询, 文本型, , , 


赋值 (SQL_查询, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_客户表, “ where 简称='”, 参数_客户公司简称, “'”))

赋值 (数据库句柄, 参数_外部数据库.查询 (SQL_查询))
.如果 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_客户表, “查询失败!”), #错误图标, #提示文字)
    返回 ()
.否则
    
    赋值 (记录总数, 参数_外部数据库.读 (数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得
     ' 调试输出 (到文本 (记录总数))
    .如果真 (大于 (记录总数, 0))
        赋值 (SQL_查询, 相加 (“select * from ”, #常量_客户表, “ where 简称='”, 参数_客户公司简称, “'”))
        赋值 (数据库句柄, 参数_外部数据库.查询 (SQL_查询))
        .如果 (等于 (数据库句柄, 0))
            信息框 (相加 (“数据表:”, #常量_客户表, “查询失败!”), #错误图标, #提示文字)
            返回 ()
        .否则
            
            
            赋值 (客户公司全称, 删首空 (参数_外部数据库.读 (数据库句柄, “全称”)))
            赋值 (客户公司简称, 删首空 (参数_外部数据库.读 (数据库句柄, “简称”)))
            赋值 (客户公司业务员, 删首空 (参数_外部数据库.读 (数据库句柄, “业务员”)))
            赋值 (客户公司地址, 删首空 (参数_外部数据库.读 (数据库句柄, “地址”)))
            赋值 (客户公司网址, 删首空 (参数_外部数据库.读 (数据库句柄, “网址”)))
            赋值 (客户公司电话, 删首空 (参数_外部数据库.读 (数据库句柄, “电话”)))
            赋值 (客户公司传真, 删首空 (参数_外部数据库.读 (数据库句柄, “传真”)))
        .如果结束
        
    .如果真结束
    
.如果结束

参数_外部数据库.关闭记录集 (数据库句柄)

赋值 (_启动窗口..内容, 客户公司全称)
赋值 (_启动窗口..内容, 客户公司简称)
赋值 (_启动窗口..内容, 客户公司业务员)
赋值 (_启动窗口..内容, 客户公司地址)
赋值 (_启动窗口..内容, 客户公司网址)
赋值 (_启动窗口..内容, 客户公司电话)
赋值 (_启动窗口..内容, 客户公司传真)


.子程序 删除当前记录_客户公司, 空白型, , 
.参数 参数_高级表格, 未知类型0x50001, , 
.参数 参数_外部数据库, 外部数据库, , 

.局部变量 当前编辑行号, 整数型, , , 
.局部变量 临时客户公司简称, 文本型, , , 
.局部变量 SQL_查询, 文本型, , , 
.局部变量 数据库句柄, 整数型, , , 
.局部变量 记录总数, 整数型, , , 

赋值 (当前编辑行号, 参数_高级表格.未知支持库函数_3 ())


赋值 (临时客户公司简称, 删首尾空 (参数_高级表格.未知支持库函数_10 (当前编辑行号, 1))) ' 得到客户公司简称

.如果真 (小于 (当前编辑行号, 相减 (参数_高级表格., 1)))
    .如果真 (删除当前记录 (参数_外部数据库, 相加 (“delete from ”, #常量_客户表, “ where 简称='”, 临时客户公司简称, “'”), #常量_客户表))
        参数_高级表格.未知支持库函数_36 (当前编辑行号)
    .如果真结束
    
.如果真结束

参数_外部数据库.关闭记录集 (数据库句柄)



.子程序 保存客户公司数据到数据库, 空白型, , 
.局部变量 SQL_查询, 文本型, , , 
.局部变量 匿名局部变量_7204, 空白型, , , 
.局部变量 客户公司名称, 文本型, , , 
.局部变量 客户公司简称, 文本型, , , 
.局部变量 客户公司地址, 文本型, , , 
.局部变量 客户公司电话, 文本型, , , 
.局部变量 客户公司传真, 文本型, , , 
.局部变量 客户公司网址, 文本型, , , 
.局部变量 客户公司业务员, 文本型, , , 
.局部变量 匿名局部变量_7212, 空白型, , , 
.局部变量 成功, 逻辑型, , , 
.局部变量 要保存出库数据, 逻辑型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 数据库句柄, 整数型, , , 
.局部变量 客户公司全称, 文本型, , , 
.局部变量 要保存数据, 逻辑型, , , 

赋值 (SQL_查询, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_客户表, “ where 简称='”, _启动窗口..内容, “'”)) ' 功能一、获得数据库句柄。功能二、生成一个临时的字段 记录总数
赋值 (数据库句柄, _启动窗口.查询 (., SQL_查询))
.如果 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_客户表, “查询失败!”), #错误图标, #提示文字)
    返回 ()
.否则
    
.如果结束

赋值 (记录总数, _启动窗口.读 (., 数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得

 ' 调试输出 (到文本 (记录总数))

赋值 (客户公司全称, 删首尾空 (_启动窗口..内容))
赋值 (客户公司简称, 删首尾空 (_启动窗口..内容))
赋值 (客户公司业务员, 删首尾空 (_启动窗口..内容))
赋值 (客户公司地址, 删首尾空 (_启动窗口..内容))
赋值 (客户公司网址, 删首尾空 (_启动窗口..内容))
赋值 (客户公司电话, 删首尾空 (_启动窗口..内容))
赋值 (客户公司传真, 删首尾空 (_启动窗口..内容))

.如果真 (等于 (客户公司简称, “”))
    信息框 (“客户公司简称不能为空！”, 0, #提示文字)
    _启动窗口.获取焦点 (.)
    返回 ()
.如果真结束

.判断开始 (等于 (记录总数, 0))
    赋值 (要保存数据, 真)
    
    .如果真 (要保存数据)
        
        赋值 (SQL_查询, 相加 (“insert into ”, #常量_客户表, “ (全称,简称,地址,电话,传真,业务员,网址) values ('”, 客户公司全称, “','”, 客户公司简称, “','”, 客户公司地址, “','”, 客户公司电话, “','”, 客户公司传真, “','”, 客户公司业务员, “','”, 客户公司网址, “')”))
        
        赋值 (成功, _启动窗口.执行 (., SQL_查询, ))
        .如果真 (等于 (成功, 假))
            信息框 (相加 (“数据表:”, #常量_客户表, “添加失败!”), #错误图标, #提示文字)
            返回 ()
        .如果真结束
        赋值 (客户_编辑行号, 相加 (客户_编辑行号, 1))
        _启动窗口.未知支持库函数_38 (., , )
        _启动窗口.未知支持库函数_0 (., 客户_编辑行号, 0)
        
    .如果真结束
    
.默认
    
    赋值 (SQL_查询, 相加 (“update ”, #常量_客户表, “ set 全称='”, 客户公司全称, “',简称='”, 客户公司简称, “',地址='”, 客户公司地址, “',电话='”, 客户公司电话, “',传真='”, 客户公司传真, “',业务员='”, 客户公司业务员, “',网址='”, 客户公司网址, “' where 简称='”, 客户公司简称, “'”))
    
    赋值 (成功, _启动窗口.执行 (., SQL_查询, ))
    
    .如果真 (等于 (成功, 假))
         ' 调试输出 (“是更新操作出错！”)
        信息框 (相加 (“数据表:”, #常量_客户表, “更新失败!”), #错误图标, #提示文字)
        返回 ()
    .如果真结束
    
.判断结束


.程序集 供应商管理程序集, , , 

.子程序 保存供应商数据到数据库, 空白型, , 
.局部变量 SQL_查询, 文本型, , , 
.局部变量 匿名局部变量_7308, 空白型, , , 
.局部变量 供应商全称, 文本型, , , 
.局部变量 供应商简称, 文本型, , , 
.局部变量 供应商地址, 文本型, , , 
.局部变量 供应商电话, 文本型, , , 
.局部变量 供应商传真, 文本型, , , 
.局部变量 供应商网址, 文本型, , , 
.局部变量 供应商业务员, 文本型, , , 
.局部变量 匿名局部变量_7316, 空白型, , , 
.局部变量 成功, 逻辑型, , , 
.局部变量 要保存出库数据, 逻辑型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 数据库句柄, 整数型, , , 
.局部变量 快递公司全称, 文本型, , , 
.局部变量 要保存数据, 逻辑型, , , 

赋值 (SQL_查询, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_供应商表, “ where 简称='”, _启动窗口..内容, “'”)) ' 功能一、获得数据库句柄。功能二、生成一个临时的字段 记录总数
赋值 (数据库句柄, _启动窗口.查询 (., SQL_查询))
.如果 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_供应商表, “查询失败!”), #错误图标, #提示文字)
    返回 ()
.否则
    
.如果结束

赋值 (记录总数, _启动窗口.读 (., 数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得

 ' 调试输出 (到文本 (记录总数))

赋值 (供应商全称, 删首尾空 (_启动窗口..内容))
赋值 (供应商简称, 删首尾空 (_启动窗口..内容))
赋值 (供应商业务员, 删首尾空 (_启动窗口..内容))
赋值 (供应商地址, 删首尾空 (_启动窗口..内容))
赋值 (供应商网址, 删首尾空 (_启动窗口..内容))
赋值 (供应商电话, 删首尾空 (_启动窗口..内容))
赋值 (供应商传真, 删首尾空 (_启动窗口..内容))

.如果真 (等于 (供应商简称, “”))
    信息框 (“供应商简称不能为空！”, 0, #提示文字)
    _启动窗口.获取焦点 (.)
    返回 ()
.如果真结束

.判断开始 (等于 (记录总数, 0))
    赋值 (要保存数据, 真)
    
    .如果真 (要保存数据)
        
        赋值 (SQL_查询, 相加 (“insert into ”, #常量_供应商表, “ (全称,简称,地址,电话,传真,业务员,网址) values ('”, 供应商全称, “','”, 供应商简称, “','”, 供应商地址, “','”, 供应商电话, “','”, 供应商传真, “','”, 供应商业务员, “','”, 供应商网址, “')”))
        
        赋值 (成功, _启动窗口.执行 (., SQL_查询, ))
        .如果真 (等于 (成功, 假))
            信息框 (相加 (“数据表:”, #常量_供应商表, “添加失败!”), #错误图标, #提示文字)
            返回 ()
        .如果真结束
        赋值 (供应商_编辑行号, 相加 (供应商_编辑行号, 1))
        _启动窗口.未知支持库函数_38 (., , )
        _启动窗口.未知支持库函数_0 (., 供应商_编辑行号, 0)
        
    .如果真结束
    
.默认
    
    赋值 (SQL_查询, 相加 (“update ”, #常量_供应商表, “ set 全称='”, 供应商全称, “',简称='”, 供应商简称, “',地址='”, 供应商地址, “',电话='”, 供应商电话, “',传真='”, 供应商传真, “',业务员='”, 供应商业务员, “',网址='”, 供应商网址, “' where 简称='”, 供应商简称, “'”))
    
    赋值 (成功, _启动窗口.执行 (., SQL_查询, ))
    
    .如果真 (等于 (成功, 假))
         ' 调试输出 (“是更新操作出错！”)
        信息框 (相加 (“数据表:”, #常量_供应商表, “更新失败!”), #错误图标, #提示文字)
        返回 ()
    .如果真结束
    
.判断结束


.子程序 设置默认供应商高级表格格式, 空白型, , 
.参数 参数_高级表格, 未知类型0x50001, , 


赋值 (参数_高级表格., 1)
赋值 (参数_高级表格., 0)
赋值 (参数_高级表格., 7)
赋值 (参数_高级表格., 1)
 ' 设置表头标题
参数_高级表格.未知支持库函数_9 (0, 0, #., “供应商全称”)
参数_高级表格.未知支持库函数_9 (0, 1, #., “简称”)
参数_高级表格.未知支持库函数_9 (0, 2, #., “业务员”)
参数_高级表格.未知支持库函数_9 (0, 3, #., “供应商地址”)
参数_高级表格.未知支持库函数_9 (0, 4, #., “供应商网址”)
参数_高级表格.未知支持库函数_9 (0, 5, #., “供应商电话”)
参数_高级表格.未知支持库函数_9 (0, 6, #., “供应商传真”)
 ' 设置表头宽度
参数_高级表格.未知支持库函数_32 (0, 200)
参数_高级表格.未知支持库函数_32 (1, 80)
参数_高级表格.未知支持库函数_32 (2, 100)
参数_高级表格.未知支持库函数_32 (3, 200)
参数_高级表格.未知支持库函数_32 (4, 200)
参数_高级表格.未知支持库函数_32 (5, 80)
参数_高级表格.未知支持库函数_32 (6, 80)
 ' 设置表头对齐方式
参数_高级表格.未知支持库函数_25 (0, 0, 0, 11, #.) ' 设置表头居中对齐


.子程序 显示所有供应商数据, 整数型, , 
.参数 参数_外部数据库, 外部数据库, , 
.参数 参数_高级表格, 未知类型0x50001, , 
.参数 参数_SQL条件, 文本型, , 

.局部变量 计次变量, 整数型, , , 
.局部变量 SQL查询1, 文本型, , , 
.局部变量 SQL_查询2, 文本型, , , 
.局部变量 数据库句柄, 整数型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 供应商全称, 文本型, , , 
.局部变量 供应商简称, 文本型, , , 
.局部变量 供应商业务员, 文本型, , , 
.局部变量 供应商地址, 文本型, , , 
.局部变量 供应商网址, 文本型, , , 
.局部变量 供应商电话, 文本型, , , 
.局部变量 供应商传真, 文本型, , , 

赋值 (SQL查询1, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_供应商表, 参数_SQL条件))

赋值 (数据库句柄, 参数_外部数据库.查询 (SQL查询1)) ' 功能一、获得数据库句柄。功能二、生成一个临时的字段 记录总数

.如果真 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_供应商表, “查询失败!”), #错误图标, #提示文字)
    
    返回 (0)
.如果真结束

赋值 (记录总数, 参数_外部数据库.读 (数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得

调试输出 (到文本 (记录总数))
 ' ---------------------------------------------------------------
赋值 (SQL_查询2, 相加 (“select * from ”, #常量_供应商表, 参数_SQL条件))

赋值 (数据库句柄, 参数_外部数据库.查询 (SQL_查询2))

参数_外部数据库.到首记录 (数据库句柄)
.计次循环首 (记录总数, 计次变量)
    
    赋值 (供应商全称, 删首空 (参数_外部数据库.读 (数据库句柄, “全称”)))
    
    赋值 (供应商简称, 删首空 (参数_外部数据库.读 (数据库句柄, “简称”)))
    
    赋值 (供应商业务员, 参数_外部数据库.读 (数据库句柄, “业务员”))
    
    赋值 (供应商地址, 删首空 (参数_外部数据库.读 (数据库句柄, “地址”)))
    
    赋值 (供应商网址, 删首空 (参数_外部数据库.读 (数据库句柄, “网址”)))
    
    赋值 (供应商电话, 删首空 (参数_外部数据库.读 (数据库句柄, “电话”)))
    
    赋值 (供应商传真, 删首空 (参数_外部数据库.读 (数据库句柄, “传真”)))
    
    参数_高级表格.未知支持库函数_38 ()
    
    参数_高级表格.未知支持库函数_9 (计次变量, 0, #., 供应商全称)
    参数_高级表格.未知支持库函数_9 (计次变量, 1, #., 供应商简称)
    参数_高级表格.未知支持库函数_9 (计次变量, 2, #., 供应商业务员)
    参数_高级表格.未知支持库函数_9 (计次变量, 3, #., 供应商地址)
    参数_高级表格.未知支持库函数_9 (计次变量, 4, #., 供应商网址)
    参数_高级表格.未知支持库函数_9 (计次变量, 5, #., 供应商电话)
    参数_高级表格.未知支持库函数_9 (计次变量, 6, #., 供应商传真)
    
    参数_外部数据库.到后一记录 (数据库句柄)
.计次循环尾 ()
参数_高级表格.未知支持库函数_38 ()

参数_高级表格.未知支持库函数_0 (相减 (参数_高级表格., 1), 0)
参数_外部数据库.关闭记录集 (数据库句柄)
返回 (记录总数)


.子程序 高级表格_供应商_供应商_内容被改变, 空白型, , 
高级表格_供应商_供应商全称_内容被改变 ()
高级表格_供应商_供应商简称_内容被改变 ()
高级表格_供应商_供应商业务员_内容被改变 ()
高级表格_供应商_供应商地址_内容被改变 ()
高级表格_供应商_供应商网址_内容被改变 ()
高级表格_供应商_供应商电话_内容被改变 ()
高级表格_供应商_供应商传真_内容被改变 ()

.子程序 高级表格_供应商_供应商全称_内容被改变, 空白型, , 
_启动窗口.未知支持库函数_9 (., 供应商_编辑行号, 0, #., _启动窗口..内容)

.子程序 高级表格_供应商_供应商简称_内容被改变, 空白型, , 
_启动窗口.未知支持库函数_9 (., 供应商_编辑行号, 1, #., _启动窗口..内容)

.子程序 高级表格_供应商_供应商业务员_内容被改变, 空白型, , 
_启动窗口.未知支持库函数_9 (., 供应商_编辑行号, 2, #., _启动窗口..内容)

.子程序 高级表格_供应商_供应商地址_内容被改变, 空白型, , 
_启动窗口.未知支持库函数_9 (., 供应商_编辑行号, 3, #., _启动窗口..内容)

.子程序 高级表格_供应商_供应商网址_内容被改变, 空白型, , 
_启动窗口.未知支持库函数_9 (., 供应商_编辑行号, 4, #., _启动窗口..内容)

.子程序 高级表格_供应商_供应商电话_内容被改变, 空白型, , 
_启动窗口.未知支持库函数_9 (., 供应商_编辑行号, 5, #., _启动窗口..内容)

.子程序 高级表格_供应商_供应商传真_内容被改变, 空白型, , 
_启动窗口.未知支持库函数_9 (., 供应商_编辑行号, 6, #., _启动窗口..内容)


.子程序 通过供应商简称得到当前其它数据, 空白型, , 
.参数 参数_外部数据库, 外部数据库, , 
.参数 参数_供应商简称, 文本型, , 

.局部变量 数据库句柄, 整数型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 计次变量, 整数型, , , 
.局部变量 供应商全称, 文本型, , , 
.局部变量 供应商简称, 文本型, , , 
.局部变量 供应商业务员, 文本型, , , 
.局部变量 供应商地址, 文本型, , , 
.局部变量 供应商网址, 文本型, , , 
.局部变量 供应商电话, 文本型, , , 
.局部变量 供应商传真, 文本型, , , 
.局部变量 SQL_查询, 文本型, , , 


赋值 (SQL_查询, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_供应商表, “ where 简称='”, 参数_供应商简称, “'”))

赋值 (数据库句柄, 参数_外部数据库.查询 (SQL_查询))
.如果 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_供应商表, “查询失败!”), #错误图标, #提示文字)
    返回 ()
.否则
    
    赋值 (记录总数, 参数_外部数据库.读 (数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得
     ' 调试输出 (到文本 (记录总数))
    .如果真 (大于 (记录总数, 0))
        赋值 (SQL_查询, 相加 (“select * from ”, #常量_供应商表, “ where 简称='”, 参数_供应商简称, “'”))
        赋值 (数据库句柄, 参数_外部数据库.查询 (SQL_查询))
        .如果 (等于 (数据库句柄, 0))
            信息框 (相加 (“数据表:”, #常量_供应商表, “查询失败!”), #错误图标, #提示文字)
            返回 ()
        .否则
            
            
            赋值 (供应商全称, 删首空 (参数_外部数据库.读 (数据库句柄, “全称”)))
            赋值 (供应商简称, 删首空 (参数_外部数据库.读 (数据库句柄, “简称”)))
            赋值 (供应商业务员, 删首空 (参数_外部数据库.读 (数据库句柄, “业务员”)))
            赋值 (供应商地址, 删首空 (参数_外部数据库.读 (数据库句柄, “地址”)))
            赋值 (供应商网址, 删首空 (参数_外部数据库.读 (数据库句柄, “网址”)))
            赋值 (供应商电话, 删首空 (参数_外部数据库.读 (数据库句柄, “电话”)))
            赋值 (供应商传真, 删首空 (参数_外部数据库.读 (数据库句柄, “传真”)))
        .如果结束
        
    .如果真结束
    
.如果结束

参数_外部数据库.关闭记录集 (数据库句柄)

赋值 (_启动窗口..内容, 供应商全称)
赋值 (_启动窗口..内容, 供应商简称)
赋值 (_启动窗口..内容, 供应商业务员)
赋值 (_启动窗口..内容, 供应商地址)
赋值 (_启动窗口..内容, 供应商网址)
赋值 (_启动窗口..内容, 供应商电话)
赋值 (_启动窗口..内容, 供应商传真)


.子程序 删除当前记录_供应商, 空白型, , 
.参数 参数_高级表格, 未知类型0x50001, , 
.参数 参数_外部数据库, 外部数据库, , 

.局部变量 当前编辑行号, 整数型, , , 
.局部变量 临时供应商简称, 文本型, , , 
.局部变量 SQL_查询, 文本型, , , 
.局部变量 数据库句柄, 整数型, , , 
.局部变量 记录总数, 整数型, , , 

赋值 (当前编辑行号, 参数_高级表格.未知支持库函数_3 ())


赋值 (临时供应商简称, 删首尾空 (参数_高级表格.未知支持库函数_10 (当前编辑行号, 1))) ' 得到供应商简称

.如果真 (小于 (当前编辑行号, 相减 (参数_高级表格., 1)))
    .如果真 (删除当前记录 (参数_外部数据库, 相加 (“delete from ”, #常量_快递公司表, “ where 简称='”, 临时供应商简称, “'”), #常量_快递公司表))
        参数_高级表格.未知支持库函数_36 (当前编辑行号)
    .如果真结束
    
.如果真结束

参数_外部数据库.关闭记录集 (数据库句柄)



.程序集 出库统计程序集, , , 

.子程序 指定客户所有的数据, 文本型, , 
.局部变量 SQL查询条件, 文本型, , , 

 ' 指定客户所有的数据
.判断开始 (不等于 (_启动窗口..内容, “所有客户”))
    赋值 (SQL查询条件, 相加 (“ and 客户='”, _启动窗口..内容, “'”))
.默认
    赋值 (SQL查询条件, “”)
.判断结束

返回 (SQL查询条件)


.子程序 单价币种, 文本型, , 
.局部变量 SQL查询条件, 文本型, , , 

赋值 (SQL查询条件, 相加 (“ and 单价币种='”, _启动窗口..内容, “'”))
返回 (SQL查询条件)

.子程序 显示统计所有出库数据, 总量数据类型, , 
.参数 参数_外部数据库, 外部数据库, , 
.参数 参数_高级表格, 未知类型0x50001, , 
.参数 参数_SQL条件, 文本型, , 

.局部变量 数据库句柄, 整数型, , , 
.局部变量 SQL查询1, 文本型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 计次变量, 整数型, , , 
.局部变量 SQL_查询2, 文本型, , , 
.局部变量 日期, 文本型, , , 
.局部变量 编号, 文本型, , , 
.局部变量 客户, 文本型, , , 
.局部变量 经手人, 文本型, , , 
.局部变量 客户订单号, 文本型, , , 
.局部变量 纱号, 文本型, , , 
.局部变量 支数, 文本型, , , 
.局部变量 成份, 文本型, , , 
.局部变量 颜色, 文本型, , , 
.局部变量 色号, 文本型, , , 
.局部变量 缸号, 文本型, , , 
.局部变量 单价, 文本型, , , 
.局部变量 数量, 文本型, , , 
.局部变量 件数, 文本型, , , 
.局部变量 快递公司, 文本型, , , 
.局部变量 快递单号, 文本型, , , 
.局部变量 金额, 文本型, , , 
.局部变量 运费, 文本型, , , 
.局部变量 出库单号, 文本型, , , 
.局部变量 匿名局部变量_7765, 空白型, , , 
.局部变量 总金额, 小数型, , , 
.局部变量 总数量, 小数型, , , 
.局部变量 返回内容, 总量数据类型, , , 
.局部变量 匿名局部变量_7760, 空白型, , , 
.局部变量 数量称量, 文本型, , , 
.局部变量 金额币种, 文本型, , , 
.局部变量 运费币种, 文本型, , , 
.局部变量 单价币种, 文本型, , , 

赋值 (SQL查询1, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_出库表, 参数_SQL条件))

调试输出 (参数_SQL条件)

赋值 (数据库句柄, 参数_外部数据库.查询 (SQL查询1)) ' 功能一、获得数据库句柄。功能二、生成一个临时的字段 记录总数

.如果真 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_出库表, “查询失败!”), #错误图标, #提示文字)
    返回 (返回内容)
.如果真结束

赋值 (记录总数, 参数_外部数据库.读 (数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得

 ' 调试输出 (到文本 (记录总数))
 ' ---------------------------------------------------------------
赋值 (SQL_查询2, 相加 (“select * from ”, #常量_出库表, 参数_SQL条件))
赋值 (数据库句柄, 参数_外部数据库.查询 (SQL_查询2))

参数_外部数据库.到首记录 (数据库句柄)
.计次循环首 (记录总数, 计次变量)
    赋值 (日期, 取日期文本 (参数_外部数据库.读 (数据库句柄, “日期”)))
    
    赋值 (编号, 删首空 (参数_外部数据库.读 (数据库句柄, “编号”)))
    赋值 (客户, 删首空 (参数_外部数据库.读 (数据库句柄, “客户”)))
    赋值 (经手人, 删首空 (参数_外部数据库.读 (数据库句柄, “经手人”)))
    赋值 (客户订单号, 删首空 (参数_外部数据库.读 (数据库句柄, “客户订单号”)))
    赋值 (成份, 删首空 (参数_外部数据库.读 (数据库句柄, “成份”)))
    赋值 (颜色, 删首空 (参数_外部数据库.读 (数据库句柄, “颜色”)))
    赋值 (缸号, 删首空 (参数_外部数据库.读 (数据库句柄, “缸号”)))
    
    
    赋值 (单价, 删首空 (参数_外部数据库.读 (数据库句柄, “单价”)))
    赋值 (单价币种, 删首空 (参数_外部数据库.读 (数据库句柄, “单价币种”)))
    
    赋值 (数量, 删首空 (参数_外部数据库.读 (数据库句柄, “数量”)))
    赋值 (数量称量, 删首空 (参数_外部数据库.读 (数据库句柄, “数量称量”)))
    
    赋值 (金额, 删首空 (参数_外部数据库.读 (数据库句柄, “金额”)))
    赋值 (金额币种, 删首空 (参数_外部数据库.读 (数据库句柄, “金额币种”)))
    
    赋值 (快递公司, 删首空 (参数_外部数据库.读 (数据库句柄, “快递公司”)))
    赋值 (快递单号, 删首空 (参数_外部数据库.读 (数据库句柄, “快递单号”)))
    赋值 (件数, 删首空 (参数_外部数据库.读 (数据库句柄, “件数”)))
    
    赋值 (运费, 删首空 (参数_外部数据库.读 (数据库句柄, “运费”)))
    赋值 (运费币种, 删首空 (参数_外部数据库.读 (数据库句柄, “运费币种”)))
    
    赋值 (出库单号, 删首空 (参数_外部数据库.读 (数据库句柄, “出库单号”)))
    
    赋值 (总金额, 相加 (总金额, 到小数 (金额), 到小数 (运费)))
    
    赋值 (总数量, 相加 (总数量, 到小数 (数量)))
    
    
    参数_高级表格.未知支持库函数_38 ()
    
    参数_高级表格.未知支持库函数_9 (计次变量, 0, #., 日期)
    参数_高级表格.未知支持库函数_9 (计次变量, 1, #., 编号)
    参数_高级表格.未知支持库函数_9 (计次变量, 2, #., 客户)
    参数_高级表格.未知支持库函数_9 (计次变量, 3, #., 经手人)
    参数_高级表格.未知支持库函数_9 (计次变量, 4, #., 客户订单号)
    参数_高级表格.未知支持库函数_9 (计次变量, 5, #., 纱号)
    参数_高级表格.未知支持库函数_9 (计次变量, 6, #., 支数)
    参数_高级表格.未知支持库函数_9 (计次变量, 7, #., 成份)
    参数_高级表格.未知支持库函数_9 (计次变量, 8, #., 色号)
    参数_高级表格.未知支持库函数_9 (计次变量, 9, #., 颜色)
    参数_高级表格.未知支持库函数_9 (计次变量, 10, #., 缸号)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 11, #., 单价)
    参数_高级表格.未知支持库函数_9 (计次变量, 12, #., 单价币种)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 13, #., 数量)
    参数_高级表格.未知支持库函数_9 (计次变量, 14, #., 数量称量)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 15, #., 金额)
    参数_高级表格.未知支持库函数_9 (计次变量, 16, #., 金额币种)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 17, #., 快递公司)
    参数_高级表格.未知支持库函数_9 (计次变量, 18, #., 快递单号)
    参数_高级表格.未知支持库函数_9 (计次变量, 19, #., 件数)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 20, #., 运费)
    参数_高级表格.未知支持库函数_9 (计次变量, 21, #., 运费币种)
    
    参数_高级表格.未知支持库函数_9 (计次变量, 22, #., 出库单号)
    参数_外部数据库.到后一记录 (数据库句柄)
.计次循环尾 ()

参数_高级表格.未知支持库函数_38 ()

参数_高级表格.未知支持库函数_9 (计次变量, 17, #., “总数量：”)
参数_高级表格.未知支持库函数_9 (计次变量, 18, #., 到文本 (总数量))
参数_高级表格.未知支持库函数_9 (计次变量, 19, #., 数量称量)

参数_高级表格.未知支持库函数_9 (计次变量, 20, #., “总金额：”)
参数_高级表格.未知支持库函数_9 (计次变量, 21, #., 到文本 (总金额))
参数_高级表格.未知支持库函数_9 (计次变量, 22, #., 单价币种)


参数_高级表格.未知支持库函数_0 (相减 (参数_高级表格., 1), 0)
参数_外部数据库.关闭记录集 (数据库句柄)

赋值 (返回内容.币种, 单价币种)
赋值 (返回内容.称量, 数量称量)
赋值 (返回内容.总数量, 总数量)
赋值 (返回内容.总金额, 总金额)
返回 (返回内容)


.子程序 曲线图出库, 空白型, , 显示每月的总量数据曲线图
.局部变量 币种, 文本型, , , 
.局部变量 称量, 文本型, , , 
.局部变量 临时总量数据, 总量数据类型, , "12", 
.局部变量 最大值, 整数型, , , 
.局部变量 计次变量, 整数型, , , 
.局部变量 n, 整数型, , , 
.局部变量 当前图例文字1, 文本型, , , 
.局部变量 Y轴单位1, 文本型, , , 
.局部变量 当前图例文字2, 文本型, , , 
.局部变量 Y轴单位2, 文本型, , , 

赋值 (n, 1)
赋值 (临时总量数据 [1], 统计所有出库数据 (_启动窗口., 相加 (一月里所有的数据 (), 指定客户所有的数据 (), 单价币种 ())))
赋值 (临时总量数据 [2], 统计所有出库数据 (_启动窗口., 相加 (二月里所有的数据 (), 指定客户所有的数据 (), 单价币种 ())))
赋值 (临时总量数据 [3], 统计所有出库数据 (_启动窗口., 相加 (三月里所有的数据 (), 指定客户所有的数据 (), 单价币种 ())))
赋值 (临时总量数据 [4], 统计所有出库数据 (_启动窗口., 相加 (四月里所有的数据 (), 指定客户所有的数据 (), 单价币种 ())))
赋值 (临时总量数据 [5], 统计所有出库数据 (_启动窗口., 相加 (五月里所有的数据 (), 指定客户所有的数据 (), 单价币种 ())))
赋值 (临时总量数据 [6], 统计所有出库数据 (_启动窗口., 相加 (六月里所有的数据 (), 指定客户所有的数据 (), 单价币种 ())))
赋值 (临时总量数据 [7], 统计所有出库数据 (_启动窗口., 相加 (七月里所有的数据 (), 指定客户所有的数据 (), 单价币种 ())))
赋值 (临时总量数据 [8], 统计所有出库数据 (_启动窗口., 相加 (八月里所有的数据 (), 指定客户所有的数据 (), 单价币种 ())))
赋值 (临时总量数据 [9], 统计所有出库数据 (_启动窗口., 相加 (九月里所有的数据 (), 指定客户所有的数据 (), 单价币种 ())))
赋值 (临时总量数据 [10], 统计所有出库数据 (_启动窗口., 相加 (十月里所有的数据 (), 指定客户所有的数据 (), 单价币种 ())))
赋值 (临时总量数据 [11], 统计所有出库数据 (_启动窗口., 相加 (十一月里所有的数据 (), 指定客户所有的数据 (), 单价币种 ())))
赋值 (临时总量数据 [12], 统计所有出库数据 (_启动窗口., 相加 (十二月里所有的数据 (), 指定客户所有的数据 (), 单价币种 ())))

.计次循环首 (12, 计次变量)
    .如果真 (小于或等于 (相加 (计次变量, 1), 12))
        .判断开始 (大于 (临时总量数据 [相加 (计次变量, 1)].总数量, 临时总量数据 [计次变量], 总数量))
            赋值 (最大值, 临时总量数据 [相加 (计次变量, 1)].总数量)
            赋值 (n, 相加 (计次变量, 1))
            
        .默认
            
        .判断结束
        
    .如果真结束
    调试输出 (到文本 (临时总量数据 [计次变量], 总数量))
.计次循环尾 ()
调试输出 (到文本 (最大值))
调试输出 (到文本 (n))


.判断开始 (等于 (临时总量数据 [n], 币种, “RMB”))
    .判断开始 (大于 (临时总量数据 [n], 总金额, 1000)) ' 如果总数量大于1000kg则用吨表示单位，否则用公斤表示单位
        赋值 (当前图例文字1, “总数量(吨)”) ' 如果总金额大于1000元则用千元表示单位，否则用元表示单位
        赋值 (Y轴单位1, “吨(千元)”)
    .默认
        
        赋值 (当前图例文字1, “总数量(公斤)”)
        赋值 (Y轴单位1, “公斤(元)”)
    .判断结束
    
    .判断开始 (大于 (临时总量数据 [n], 总数量, 1000))
        赋值 (当前图例文字2, “总金额(千元)”)
        赋值 (Y轴单位2, “吨(千元)”)
    .默认
        
        赋值 (当前图例文字2, “总金额(元)”)
        赋值 (Y轴单位2, “公斤(元)”)
    .判断结束
    
.默认
    
    .判断开始 (大于 (临时总量数据 [n], 总金额, 1000))
        赋值 (当前图例文字1, “总数量(千磅)”)
        赋值 (Y轴单位1, “千磅(千美元)”)
    .默认
        
        赋值 (当前图例文字1, “总数量(磅)”)
        赋值 (Y轴单位1, “磅(美元)”)
    .判断结束
    
    .判断开始 (大于 (临时总量数据 [n], 总数量, 1000))
        赋值 (当前图例文字2, “总金额(千美元)”)
        赋值 (Y轴单位2, “千磅(千美元)”)
        
    .默认
        赋值 (当前图例文字2, “总金额(美元)”)
        赋值 (Y轴单位2, “磅(美元)”)
    .判断结束
    
.判断结束



赋值 (_启动窗口.., 2)

赋值 (_启动窗口.., Y轴单位1)
赋值 (_启动窗口.., 0)
赋值 (_启动窗口.., 当前图例文字1)
赋值 (_启动窗口.., #红色)

.计次循环首 (12, 计次变量)
    赋值 (_启动窗口.., 相减 (计次变量, 1))
    赋值 (_启动窗口.., 临时总量数据 [计次变量], 总数量)
.计次循环尾 ()


赋值 (_启动窗口.., Y轴单位2)
赋值 (_启动窗口.., 1)
赋值 (_启动窗口.., 当前图例文字2)
赋值 (_启动窗口.., #天蓝)

.计次循环首 (12, 计次变量)
    赋值 (_启动窗口.., 相减 (计次变量, 1))
    赋值 (_启动窗口.., 临时总量数据 [计次变量], 总金额)
.计次循环尾 ()


.子程序 统计所有出库数据, 总量数据类型, , 
.参数 参数_外部数据库, 外部数据库, , 
.参数 参数_SQL条件, 文本型, , 

.局部变量 数据库句柄, 整数型, , , 
.局部变量 SQL查询1, 文本型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 计次变量, 整数型, , , 
.局部变量 SQL_查询2, 文本型, , , 
.局部变量 日期, 文本型, , , 
.局部变量 编号, 文本型, , , 
.局部变量 客户, 文本型, , , 
.局部变量 经手人, 文本型, , , 
.局部变量 客户订单号, 文本型, , , 
.局部变量 纱号, 文本型, , , 
.局部变量 支数, 文本型, , , 
.局部变量 成份, 文本型, , , 
.局部变量 颜色, 文本型, , , 
.局部变量 色号, 文本型, , , 
.局部变量 缸号, 文本型, , , 
.局部变量 单价, 文本型, , , 
.局部变量 数量, 文本型, , , 
.局部变量 件数, 文本型, , , 
.局部变量 快递公司, 文本型, , , 
.局部变量 快递单号, 文本型, , , 
.局部变量 金额, 文本型, , , 
.局部变量 运费, 文本型, , , 
.局部变量 出库单号, 文本型, , , 
.局部变量 匿名局部变量_7883, 空白型, , , 
.局部变量 总金额, 小数型, , , 
.局部变量 总数量, 小数型, , , 
.局部变量 返回内容, 总量数据类型, , , 
.局部变量 匿名局部变量_7887, 空白型, , , 
.局部变量 运费币种, 文本型, , , 
.局部变量 金额币种, 文本型, , , 
.局部变量 数量称量, 文本型, , , 
.局部变量 单价币种, 文本型, , , 

赋值 (SQL查询1, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_出库表, 参数_SQL条件))

赋值 (数据库句柄, 参数_外部数据库.查询 (SQL查询1)) ' 功能一、获得数据库句柄。功能二、生成一个临时的字段 记录总数

.如果真 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_出库表, “查询失败!”), #错误图标, #提示文字)
    返回 (返回内容)
.如果真结束

赋值 (记录总数, 参数_外部数据库.读 (数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得

 ' 调试输出 (到文本 (记录总数))
 ' ---------------------------------------------------------------
赋值 (SQL_查询2, 相加 (“select * from ”, #常量_出库表, 参数_SQL条件))
赋值 (数据库句柄, 参数_外部数据库.查询 (SQL_查询2))

参数_外部数据库.到首记录 (数据库句柄)
.计次循环首 (记录总数, 计次变量)
    赋值 (日期, 取日期文本 (参数_外部数据库.读 (数据库句柄, “日期”)))
    
    赋值 (编号, 删首空 (参数_外部数据库.读 (数据库句柄, “编号”)))
    赋值 (客户, 删首空 (参数_外部数据库.读 (数据库句柄, “客户”)))
    赋值 (经手人, 删首空 (参数_外部数据库.读 (数据库句柄, “经手人”)))
    赋值 (客户订单号, 删首空 (参数_外部数据库.读 (数据库句柄, “客户订单号”)))
    赋值 (成份, 删首空 (参数_外部数据库.读 (数据库句柄, “成份”)))
    赋值 (颜色, 删首空 (参数_外部数据库.读 (数据库句柄, “颜色”)))
    赋值 (缸号, 删首空 (参数_外部数据库.读 (数据库句柄, “缸号”)))
    
    赋值 (单价, 删首空 (参数_外部数据库.读 (数据库句柄, “单价”)))
    赋值 (单价币种, 删首空 (参数_外部数据库.读 (数据库句柄, “单价币种”)))
    
    赋值 (数量, 删首空 (参数_外部数据库.读 (数据库句柄, “数量”)))
    赋值 (数量称量, 删首空 (参数_外部数据库.读 (数据库句柄, “数量称量”)))
    
    赋值 (金额, 删首空 (参数_外部数据库.读 (数据库句柄, “金额”)))
    赋值 (金额币种, 删首空 (参数_外部数据库.读 (数据库句柄, “金额币种”)))
    
    赋值 (快递公司, 删首空 (参数_外部数据库.读 (数据库句柄, “快递公司”)))
    赋值 (快递单号, 删首空 (参数_外部数据库.读 (数据库句柄, “快递单号”)))
    赋值 (件数, 删首空 (参数_外部数据库.读 (数据库句柄, “件数”)))
    
    赋值 (运费, 删首空 (参数_外部数据库.读 (数据库句柄, “运费”)))
    赋值 (运费币种, 删首空 (参数_外部数据库.读 (数据库句柄, “运费币种”)))
    
    赋值 (出库单号, 删首空 (参数_外部数据库.读 (数据库句柄, “出库单号”)))
    
    赋值 (总金额, 相加 (总金额, 到小数 (金额), 到小数 (运费)))
    
    赋值 (总数量, 相加 (总数量, 到小数 (数量)))
    
    
    参数_外部数据库.到后一记录 (数据库句柄)
.计次循环尾 ()

参数_外部数据库.关闭记录集 (数据库句柄)

赋值 (返回内容.币种, 单价币种)
赋值 (返回内容.称量, 数量称量)
赋值 (返回内容.总数量, 总数量)
赋值 (返回内容.总金额, 总金额)
返回 (返回内容)

.程序集 数据库管理_程序集, , , 

.子程序 得到超级列表框标题对应数据库文件名, 文本型, , 
.局部变量 SQL语句, 文本型, , , 
.局部变量 文件名, 文本型, , , 
.局部变量 数据库句柄, 整数型, , , 

赋值 (SQL语句, 相加 (“select * from ”, #常量_列表项表, “ where 标题='”, 超级列表框标题, “'”))

赋值 (数据库句柄, _启动窗口.查询 (., SQL语句))
.如果真 (等于 (数据库句柄, 0))
    信息框 (相加 (“数据表:”, #常量_列表项表, “查询失败!”), #错误图标, #提示文字)
    返回 (文件名)
.如果真结束

 ' _启动窗口.外部数据库.到首记录 (数据库句柄)

赋值 (超级列表框标题, 删首空 (_启动窗口.读 (., 数据库句柄, “标题”)))

赋值 (文件名, 删首空 (_启动窗口.读 (., 数据库句柄, “文件”)))
_启动窗口.关闭记录集 (., 数据库句柄)
返回 (文件名)


.子程序 用户压缩数据库, 空白型, , 
.参数 是否结束程序, 逻辑型, , 是不是退出软件，如果本参数值为真，则不再打开数据库

.局部变量 网络数据库文件, 文本型, , , 
.局部变量 本地数据库文件, 文本型, , , 

_启动窗口.关闭 (.)

赋值 (本地数据库文件, 相加 (取运行目录 (), “\数据\毛纱数据库.mdb”))

赋值 (网络数据库文件, 读配置项 (相加 (系统目录, “\系统配置.ini”), “系统路径”, “数据库路径”, 本地数据库文件))
.如果真 (是否结束程序)
    返回 ()
.如果真结束

信息框 (多项选择 (相加 (压缩ACCESS数据库 (网络数据库文件, ), 1), “压缩成功！”, “对不起，您的系统文件或系统函数被破坏！”, “对不起，您所选定文件格式错误”, “对不起，请先关闭数据库”), 0, #提示文字)
.如果 (等于 (文件是否存在 (网络数据库文件), 假))
    信息框 (相加 (网络数据库文件, “失踪!”, #换行符, “请检查系统的完整性!本次运行将取消.”), #错误图标, #提示文字)
    结束 ()
.否则
    .如果真 (等于 (_启动窗口.打开MDB数据库 (., 网络数据库文件, “admin”, , , ), 假))
        信息框 (相加 (网络数据库文件, “打开失败!”, #换行符, “请系统管理员检查原因.本次运行将取消.”), #错误图标, #提示文字)
        返回 ()
    .如果真结束
    
.如果结束


.子程序 压缩ACCESS数据库, 整数型, , 请注意先关闭数据库.返回0成功，返回1则是创建系统对象失败，返回1是调用失败，返回3是数据库使用中
.参数 路径, 文本型, , 
.参数 密码, 文本型, 可空, 

.局部变量 Engine, 对象, , , 
.局部变量 tmp, 文本型, , , 

.如果真 (等于 (Engine.创建 (“JRO.JetEngine”, ), 假))
    返回 (1)
.如果真结束
赋值 (tmp, 取临时文件名 ())
Engine.方法 (“CompactDatabase”, 相加 (“Provider=Microsoft.Jet.OLEDB.4.0;Data Source=”, 路径, 选择 (是否为空 (密码), “”, 相加 (“;Jet OLEDB:Database Password=”, 密码))), 相加 (“Provider=Microsoft.Jet.OLEDB.4.0;Data Source=”, tmp, 选择 (等于 (密码, “”), “”, 相加 (“;Jet OLEDB:Database Password=”, 密码))))
.如果真 (不等于 (Engine.取错误 (), “”))
    返回 (2)
.如果真结束
Engine.清除 ()
.如果真 (等于 (删除文件 (路径), 假))
    删除文件 (tmp)
    返回 (3)
.如果真结束
.如果真 (等于 (复制文件 (tmp, 路径), 假))
    返回 (3)
.如果真结束
返回 (选择 (删除文件 (tmp), 0, 3))

.子程序 复制数据库文件, 逻辑型, , 
.参数 是否备份, 逻辑型, , 值为真时备份数据库，反之则为还原数据库
.参数 参数_备份数据库文件, 文本型, , 

.局部变量 本地数据库文件, 文本型, , , 
.局部变量 网络数据库文件, 文本型, , , 
.局部变量 返回值, 逻辑型, , , 

赋值 (返回值, 假)

赋值 (本地数据库文件, 相加 (取运行目录 (), “\数据\毛纱数据库.mdb”))
赋值 (网络数据库文件, 读配置项 (相加 (系统目录, “\系统配置.ini”), “系统路径”, “数据库路径”, 本地数据库文件))

.如果真 (等于 (相加 (到整数 (是否备份), 到整数 (文件是否存在 (参数_备份数据库文件))), 0))
    信息框 (“对不起，没有备份文件，无法还原！　”, 64, “系统提示”)
    返回 (返回值)
.如果真结束

载入 (窗口_备份_进度条, , 假)
赋值 (窗口_备份_进度条..时钟周期, 100)
 ' _启动窗口.外部数据库.关闭 ()
.判断开始 (等于 (是否备份, 假))
    .如果真 (等于 (信息框 (“还原数据库操作将使原来的数据库覆盖！你确定要这么做？”, 1, #提示文字), 0))
        .如果真 (等于 (复制文件 (选择 (是否备份, 网络数据库文件, 参数_备份数据库文件), 选择 (是否备份, 参数_备份数据库文件, 网络数据库文件)), 真))
            赋值 (返回值, 真)
        .如果真结束
        
    .如果真结束
    
.默认
    .如果真 (等于 (复制文件 (选择 (是否备份, 网络数据库文件, 参数_备份数据库文件), 选择 (是否备份, 参数_备份数据库文件, 网络数据库文件)), 真))
        赋值 (返回值, 真)
    .如果真结束
    
.判断结束

.判断开始 (小于 (窗口_备份_进度条..位置, 窗口_备份_进度条..最大位置))
    延迟 (2000)
.默认
    
.判断结束
返回 (返回值)

 ' _启动窗口.外部数据库.打开MDB数据库 (网络数据库文件, “admin”, , , )

.子程序 显示_列表_备份_表项, 逻辑型, , 
.局部变量 SQL语句, 文本型, , , 
.局部变量 句柄, 整数型, , , 
.局部变量 标题, 文本型, , , 

赋值 (SQL语句, 相加 (“select * from ”, #常量_列表项表))

赋值 (句柄, _启动窗口.查询 (., SQL语句))

.如果真 (等于 (句柄, 0))
    信息框 (相加 (“数据表:”, #常量_列表项表, “查询失败!”), #错误图标, #提示文字)
    返回 (假)
.如果真结束


_启动窗口.全部删除 (.)

_启动窗口.到首记录 (., 句柄)
.判断循环首 (等于 (_启动窗口.尾记录后 (., 句柄), 假))
    赋值 (标题, _启动窗口.读 (., 句柄, “标题”))
    _启动窗口.插入表项 (., , 标题, 0, , , )
    _启动窗口.到后一记录 (., 句柄)
.判断循环尾 ()

_启动窗口.关闭记录集 (., 句柄)
返回 (真)

.子程序 保存_列表_备份_表项, 空白型, , 
.参数 参数_标题, 文本型, , 标题
.参数 参数_文件名, 文本型, , 文件名
.参数 参数_备份方式, 文本型, , 

.局部变量 SQL语句, 文本型, , , 
.局部变量 数据库句柄, 整数型, , , 
.局部变量 记录总数, 整数型, , , 
.局部变量 计次变量, 整数型, , , 
.局部变量 标题, 文本型, , "7", 
.局部变量 文件名, 文本型, , "7", 

.判断开始 (等于 (参数_备份方式, “1”))
    赋值 (SQL语句, 相加 (“update ”, #常量_列表项表, “ set 标题='”, 参数_标题, “',文件='”, 参数_文件名, “' where 编号=8”))
    .如果真 (等于 (_启动窗口.执行 (., SQL语句, ), 假))
        信息框 (相加 (“更新数据表：”, #常量_列表项表, “出错！”), 64, #提示文字)
        返回 ()
    .如果真结束
    
.默认
    
    赋值 (SQL语句, 相加 (“select COUNT(*) AS 记录总数 from ”, #常量_列表项表, “ where 标题='”, 参数_标题, “'”))
    赋值 (数据库句柄, _启动窗口.查询 (., SQL语句))
    
     ' 如果当天系统已做过备份则记录总数不为0
    .如果真 (等于 (数据库句柄, 0))
        信息框 (相加 (“数据表:”, #常量_列表项表, “查询失败!”), #错误图标, #提示文字)
        返回 ()
    .如果真结束
    
    赋值 (记录总数, _启动窗口.读 (., 数据库句柄, “记录总数”)) ' 获得所有记录数,由上面的SQL查询语句获得
    
    .如果真 (等于 (记录总数, 0))
         ' 当天系统没做过备份的情况下
        赋值 (SQL语句, 相加 (“select * from ”, #常量_列表项表))
        赋值 (数据库句柄, _启动窗口.查询 (., SQL语句))
        .如果真 (等于 (数据库句柄, 0))
            信息框 (相加 (“数据表:”, #常量_列表项表, “查询失败!”), #错误图标, #提示文字)
            返回 ()
        .如果真结束
        
        _启动窗口.到首记录 (., 数据库句柄)
        
        .计次循环首 (7, 计次变量)
            赋值 (标题 [计次变量], 删首空 (_启动窗口.读 (., 数据库句柄, “标题”)))
            赋值 (文件名 [计次变量], 删首空 (_启动窗口.读 (., 数据库句柄, “文件”)))
            _启动窗口.到后一记录 (., 数据库句柄)
        .计次循环尾 ()
         ' 调试输出 (文件名 [1])
        .判断开始 (并且 (不等于 (文件名 [1], “”), 等于 (文件是否存在 (文件名 [1]), 真)))
            .如果真 (等于 (删除文件 (文件名 [1]), 假))
                信息框 (相加 (“删除文件：”, 文件名 [1], “出错！”), #错误图标, #提示文字)
            .如果真结束
            
             ' 调试输出 (“文件找到！”)
        .默认
            
            信息框 (相加 (“没有找到要删除的文件：”, 文件名 [1]), #错误图标, #提示文字)
             ' 调试输出 (“文件不存在！”)
        .判断结束
        
         ' .如果真 (等于 (删除文件 (文件名 [1]), 假))
             ' 信息框 (“删除文件：” ＋ 文件名 [1] ＋ “出错！”, #错误图标, #提示文字)
        .如果真结束
        
         ' 信息框 (“没有找到要删除的文件：” ＋ 文件名 [计次变量], #错误图标, #提示文字)
        
        .计次循环首 (6, 计次变量)
            赋值 (标题 [计次变量], 标题 [相加 (计次变量, 1)])
            赋值 (文件名 [计次变量], 文件名 [相加 (计次变量, 1)])
        .计次循环尾 ()
        赋值 (标题 [7], 参数_标题)
        赋值 (文件名 [7], 参数_文件名)
        
        .计次循环首 (7, 计次变量)
            赋值 (SQL语句, 相加 (“update ”, #常量_列表项表, “ set 标题='”, 标题 [计次变量], “',文件='”, 文件名 [计次变量], “' where 编号=”, 到文本 (计次变量)))
            
            .如果真 (等于 (_启动窗口.执行 (., SQL语句, ), 假))
                信息框 (相加 (“更新数据表：”, #常量_列表项表, “出错！”), 64, #提示文字)
                返回 ()
            .如果真结束
            
        .计次循环尾 ()
        
        _启动窗口.关闭记录集 (., 数据库句柄)
    .如果真结束
    
    
.判断结束


.子程序 按日期自动备份, 逻辑型, , 
.局部变量 备份数据库文件名, 文本型, , , 
.局部变量 备份成功, 逻辑型, , , 
.局部变量 日期文本, 文本型, , , 

赋值 (日期文本, 时间到文本 (取现行时间 (), #日期部分))

赋值 (备份数据库文件名, 相加 (数据库目录, “备份\”, 日期文本, “.mdb”))
 ' 调试输出 (备份数据库文件名)
 ' 调试输出 (日期文本)

赋值 (备份成功, 复制数据库文件 (真, 备份数据库文件名))

.判断开始 (等于 (备份成功, 真))
    保存_列表_备份_表项 (日期文本, 备份数据库文件名, “2”)
    信息框 (“备份数据库成功！”, 64, #提示文字)
    返回 (真)
.默认
    信息框 (“备份数据库失败！”, 64, #提示文字)
    返回 (假)
.判断结束


.程序集 统计公共程序集, , , 

.子程序 一年时间里所有的数据, 文本型, , 
.局部变量 SQL查询条件, 文本型, , , 
.局部变量 起始日期, 文本型, , , 
.局部变量 截止日期, 文本型, , , 

 ' 一年时间里所有的数据
赋值 (起始日期, 相加 (到文本 (取年份 (取现行时间 ())), “-01-01”))
赋值 (截止日期, 相加 (到文本 (取年份 (取现行时间 ())), “-12-”, 到文本 (取某月天数 (取年份 (取现行时间 ()), 12))))
赋值 (SQL查询条件, 相加 (“ where [日期]>=#”, 起始日期, “# and [日期]<=#”, 截止日期, “#”))
返回 (SQL查询条件)


.子程序 一月里所有的数据, 文本型, , 
.局部变量 SQL查询条件, 文本型, , , 
.局部变量 起始日期, 文本型, , , 
.局部变量 截止日期, 文本型, , , 

 ' 一月里所有的数据
赋值 (起始日期, 相加 (到文本 (取年份 (取现行时间 ())), “-01-01”))
赋值 (截止日期, 相加 (到文本 (取年份 (取现行时间 ())), “-01-”, 到文本 (取某月天数 (取年份 (取现行时间 ()), 1))))
赋值 (SQL查询条件, 相加 (“ where [日期]>=#”, 起始日期, “# and [日期]<=#”, 截止日期, “#”))
返回 (SQL查询条件)

.子程序 二月里所有的数据, 文本型, , 
.局部变量 SQL查询条件, 文本型, , , 
.局部变量 起始日期, 文本型, , , 
.局部变量 截止日期, 文本型, , , 

 ' 二月里所有的数据
赋值 (起始日期, 相加 (到文本 (取年份 (取现行时间 ())), “-02-01”))
赋值 (截止日期, 相加 (到文本 (取年份 (取现行时间 ())), “-02-”, 到文本 (取某月天数 (取年份 (取现行时间 ()), 2))))
赋值 (SQL查询条件, 相加 (“ where [日期]>=#”, 起始日期, “# and [日期]<=#”, 截止日期, “#”))
返回 (SQL查询条件)

.子程序 三月里所有的数据, 文本型, , 
.局部变量 SQL查询条件, 文本型, , , 
.局部变量 起始日期, 文本型, , , 
.局部变量 截止日期, 文本型, , , 

 ' 三月里所有的数据
赋值 (起始日期, 相加 (到文本 (取年份 (取现行时间 ())), “-03-01”))
赋值 (截止日期, 相加 (到文本 (取年份 (取现行时间 ())), “-03-”, 到文本 (取某月天数 (取年份 (取现行时间 ()), 3))))
赋值 (SQL查询条件, 相加 (“ where [日期]>=#”, 起始日期, “# and [日期]<=#”, 截止日期, “#”))
返回 (SQL查询条件)

.子程序 四月里所有的数据, 文本型, , 
.局部变量 SQL查询条件, 文本型, , , 
.局部变量 起始日期, 文本型, , , 
.局部变量 截止日期, 文本型, , , 

 ' 四月里所有的数据
赋值 (起始日期, 相加 (到文本 (取年份 (取现行时间 ())), “-04-01”))
赋值 (截止日期, 相加 (到文本 (取年份 (取现行时间 ())), “-04-”, 到文本 (取某月天数 (取年份 (取现行时间 ()), 4))))
赋值 (SQL查询条件, 相加 (“ where [日期]>=#”, 起始日期, “# and [日期]<=#”, 截止日期, “#”))
返回 (SQL查询条件)

.子程序 五月里所有的数据, 文本型, , 
.局部变量 SQL查询条件, 文本型, , , 
.局部变量 起始日期, 文本型, , , 
.局部变量 截止日期, 文本型, , , 

 ' 五月里所有的数据
赋值 (起始日期, 相加 (到文本 (取年份 (取现行时间 ())), “-05-01”))
赋值 (截止日期, 相加 (到文本 (取年份 (取现行时间 ())), “-05-”, 到文本 (取某月天数 (取年份 (取现行时间 ()), 5))))
赋值 (SQL查询条件, 相加 (“ where [日期]>=#”, 起始日期, “# and [日期]<=#”, 截止日期, “#”))
返回 (SQL查询条件)

.子程序 六月里所有的数据, 文本型, , 
.局部变量 SQL查询条件, 文本型, , , 
.局部变量 起始日期, 文本型, , , 
.局部变量 截止日期, 文本型, , , 

 ' 六月里所有的数据
赋值 (起始日期, 相加 (到文本 (取年份 (取现行时间 ())), “-06-01”))
赋值 (截止日期, 相加 (到文本 (取年份 (取现行时间 ())), “-06-”, 到文本 (取某月天数 (取年份 (取现行时间 ()), 6))))
赋值 (SQL查询条件, 相加 (“ where [日期]>=#”, 起始日期, “# and [日期]<=#”, 截止日期, “#”))

返回 (SQL查询条件)

.子程序 七月里所有的数据, 文本型, , 
.局部变量 SQL查询条件, 文本型, , , 
.局部变量 起始日期, 文本型, , , 
.局部变量 截止日期, 文本型, , , 

 ' 七月里所有的数据
赋值 (起始日期, 相加 (到文本 (取年份 (取现行时间 ())), “-07-01”))
赋值 (截止日期, 相加 (到文本 (取年份 (取现行时间 ())), “-07-”, 到文本 (取某月天数 (取年份 (取现行时间 ()), 7))))
赋值 (SQL查询条件, 相加 (“ where [日期]>=#”, 起始日期, “# and [日期]<=#”, 截止日期, “#”))
返回 (SQL查询条件)

.子程序 八月里所有的数据, 文本型, , 
.局部变量 SQL查询条件, 文本型, , , 
.局部变量 起始日期, 文本型, , , 
.局部变量 截止日期, 文本型, , , 

 ' 八月里所有的数据
赋值 (起始日期, 相加 (到文本 (取年份 (取现行时间 ())), “-08-01”))
赋值 (截止日期, 相加 (到文本 (取年份 (取现行时间 ())), “-08-”, 到文本 (取某月天数 (取年份 (取现行时间 ()), 8))))
赋值 (SQL查询条件, 相加 (“ where [日期]>=#”, 起始日期, “# and [日期]<=#”, 截止日期, “#”))
返回 (SQL查询条件)

.子程序 九月里所有的数据, 文本型, , 
.局部变量 SQL查询条件, 文本型, , , 
.局部变量 起始日期, 文本型, , , 
.局部变量 截止日期, 文本型, , , 

 ' 九月里所有的数据
赋值 (起始日期, 相加 (到文本 (取年份 (取现行时间 ())), “-09-01”))
赋值 (截止日期, 相加 (到文本 (取年份 (取现行时间 ())), “-09-”, 到文本 (取某月天数 (取年份 (取现行时间 ()), 9))))
赋值 (SQL查询条件, 相加 (“ where [日期]>=#”, 起始日期, “# and [日期]<=#”, 截止日期, “#”))
返回 (SQL查询条件)

.子程序 十月里所有的数据, 文本型, , 
.局部变量 SQL查询条件, 文本型, , , 
.局部变量 起始日期, 文本型, , , 
.局部变量 截止日期, 文本型, , , 

 ' 十月里所有的数据
赋值 (起始日期, 相加 (到文本 (取年份 (取现行时间 ())), “-10-01”))
赋值 (截止日期, 相加 (到文本 (取年份 (取现行时间 ())), “-10-”, 到文本 (取某月天数 (取年份 (取现行时间 ()), 10))))
赋值 (SQL查询条件, 相加 (“ where [日期]>=#”, 起始日期, “# and [日期]<=#”, 截止日期, “#”))
返回 (SQL查询条件)

.子程序 十一月里所有的数据, 文本型, , 
.局部变量 SQL查询条件, 文本型, , , 
.局部变量 起始日期, 文本型, , , 
.局部变量 截止日期, 文本型, , , 

 ' 十一月里所有的数据
赋值 (起始日期, 相加 (到文本 (取年份 (取现行时间 ())), “-11-01”))
赋值 (截止日期, 相加 (到文本 (取年份 (取现行时间 ())), “-11-”, 到文本 (取某月天数 (取年份 (取现行时间 ()), 11))))
赋值 (SQL查询条件, 相加 (“ where [日期]>=#”, 起始日期, “# and [日期]<=#”, 截止日期, “#”))
返回 (SQL查询条件)

.子程序 十二月里所有的数据, 文本型, , 
.局部变量 SQL查询条件, 文本型, , , 
.局部变量 起始日期, 文本型, , , 
.局部变量 截止日期, 文本型, , , 

 ' 十二月里所有的数据
赋值 (起始日期, 相加 (到文本 (取年份 (取现行时间 ())), “-12-01”))
赋值 (截止日期, 相加 (到文本 (取年份 (取现行时间 ())), “-12-”, 到文本 (取某月天数 (取年份 (取现行时间 ()), 12))))
赋值 (SQL查询条件, 相加 (“ where [日期]>=#”, 起始日期, “# and [日期]<=#”, 截止日期, “#”))
返回 (SQL查询条件)

.窗口程序集 备份_进度条_窗口程序集, , , 

.子程序 _时钟_备份_进度条_周期事件, 空白型, , 

.判断开始 (小于 (.位置, .最大位置))
    赋值 (.位置, 相加 (.位置, 10))
.默认
    
    赋值 (.时钟周期, 0)
    窗口_备份_进度条.销毁 ()
.判断结束



.窗口程序集 登录窗口2程序集, , , 

.程序集变量 临时用户类型, 文本型, , "0", 
.程序集变量 旧用户名, 文本型, , , 
.子程序 _登录窗口2_创建完毕, 空白型, , 
赋值 (窗口动画有无, 读配置项 (相加 (系统目录, “\系统配置.ini”), “界面”, “窗口动画”, “1”))
.如果真 (等于 (窗口动画有无, “1”))
    动画显隐窗口 (登录窗口2, 真)
.如果真结束
赋值 (界面风格, 读配置项 (相加 (系统目录, “\系统配置.ini”), “界面”, “界面风格”, “0”))
未知支持库函数_0 (到整数 (界面风格))

显示 (#图片组)
显示用户2 (_启动窗口., , 相加 (“select * from ”, #常量_操作员表))


.子程序 显示用户2, 逻辑型, , 
.参数 参数_外部数据库, 外部数据库, , 
.参数 参数_超级列表框, 超级列表框, , 
.参数 参数_SQL语句, 文本型, , 要查询的SQL语句

.局部变量 句柄, 整数型, , , 
.局部变量 临时用户名称, 文本型, , , 
.局部变量 临时图片索引, 文本型, , , 
.局部变量 临时用户权限, 文本型, , , 

赋值 (句柄, 参数_外部数据库.查询 (参数_SQL语句))
.如果真 (等于 (句柄, 0))
    返回 (假)
.如果真结束

全部删除 ()
 ' 参数_外部数据库.到首记录 (句柄)
.判断循环首 (等于 (参数_外部数据库.尾记录后 (句柄), 假))
    
    赋值 (临时用户名称, 参数_外部数据库.读 (句柄, “用户名称”))
    赋值 (临时图片索引, 参数_外部数据库.读 (句柄, “图片索引”))
    赋值 (临时用户权限, 参数_外部数据库.读 (句柄, “用户权限”))
    
    加入成员 (临时用户类型, 临时用户权限)
    
    参数_超级列表框.插入表项 (临时用户名称, 到整数 (临时图片索引), , , )
    参数_外部数据库.到后一记录 (句柄)
.判断循环尾 ()

参数_外部数据库.关闭记录集 (句柄)

返回 (真)

.子程序 _登录窗口2_可否被关闭, 逻辑型, , 
返回 (假)

.子程序 _超级列表框_用户_当前表项被改变, 空白型, , 
赋值 (.标题, .取标题 (., ))

赋值 (.标题, 多项选择 (到整数 (临时用户类型 [相加 (., 1)]), “系统管理员”, “普通管理员”, “来宾管理员”))



.子程序 _取消钮_被单击, 空白型, , 
动画显隐窗口 (登录窗口2, 假)
.判断开始 (等于 (未登录, 真))
    结束 ()
.默认
    登录窗口2.销毁 ()
.判断结束


.子程序 _确定钮_被单击, 空白型, , 
赋值 (旧用户名, 用户名称)

.如果真 (是否有用户 (_启动窗口., 相加 (“select * from ”, #常量_操作员表, “ where 用户名称='”, .标题, “'”)))
    
    .如果 (等于 (.标题, 用户名称))
        .如果 (等于 (操作员密码处理 (删全部空 (.内容)), 用户密码))
            赋值 (这次登录时间, 到文本 (取现行时间 ()))
            .如果 (等于 (更新登录用户信息 (_启动窗口., 相加 (“update ”, #常量_操作员表, “ set 这次登录时间='”, 这次登录时间, “',上次登录时间='”, 这次登录时间, “',总登录次数='”, 到文本 (相加 (总登录次数, 1)), “',已登录='”, “1”, “' where 用户名称='”, .标题, “'”)), 真))
                .如果真 (等于 (未登录, 假))
                    更新登录情况 (旧用户名)
                     ' 按日期自动备份 ()
                .如果真结束
                
                销毁 () ' 密码也正确的话。销毁登录窗口，进入主界面窗口,既_启动窗口
            .否则
                信息框 (“出错”, 0, )
                结束 ()
            .如果结束
            
        .否则
            信息框 (“用户密码错误！”, 64, #提示文字)
            返回 ()
        .如果结束
        
    .否则
        信息框 (“用户名称错误！”, 64, #提示文字)
        返回 ()
    .如果结束
    
.如果真结束



 ' 不属于任何一个程序集、类模块的函数：
