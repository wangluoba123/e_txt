 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 181
    高度 = 450
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\程序管理.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 加入项目窗口
    左边 = 50
    顶边 = 50
    宽度 = 300
    高度 = 190
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 加入菜单窗口
    左边 = 50
    顶边 = 50
    宽度 = 300
    高度 = 190
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 300
    高度 = 190
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于”
    帮助文件名 = “”

窗口 帮助窗口
    左边 = 50
    顶边 = 50
    宽度 = 300
    高度 = 190
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 删除窗口
    左边 = 50
    顶边 = 50
    宽度 = 300
    高度 = 190
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.图片 data, " ' 已保存到：D:\易语言学习\Data\程序管理.e\data", , 
.图片 关于背景, " ' 已保存到：D:\易语言学习\Data\程序管理.e\关于背景", , 
.常量 系统菜单, "524288", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 2 6 扩展界面支持库三
 ' TrayIcon {86AB1D8A-7995-4D86-AE5F-18710759228B} 1 1 托盘图标支持库
 ' ExtMenu 9909FBB013704cfa8FE7E739DB7172DE 1 6 超级菜单支持库
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二





.窗口程序集 启动窗口程序集, , , 

.子程序 _卷帘式菜单1_项目被选择, 空白型, , 
.参数 菜单索引, 整数型, , 
.参数 项目索引, 整数型, , 

.局部变量 项目地址, 文本型, , , 
.局部变量 菜单名称, 文本型, , , 
.局部变量 项目名称, 文本型, , , 
.局部变量 逻辑, 逻辑型, , , 

赋值 (项目地址, “”)
赋值 (菜单名称, .未知支持库函数_7 (.))
赋值 (项目名称, .未知支持库函数_8 (.))
到首记录 ()
查找 (并且 (等于 (读 (“菜单”), 菜单名称), 等于 (读 (“项目”), 项目名称)))
赋值 (项目地址, 读 (“项目地址”))
运行 (项目地址, 假, ) ' 运行所选定的菜单对应的程序

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 运行目录, 文本型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 菜单名称, 文本型, , , 
.局部变量 记录号, 整数型, , , 
.局部变量 现行选中菜单号, 整数型, , , 

赋值 (_启动窗口., “程序管理工具”)
未知支持库函数_0 (1)
赋值 (.时钟周期, 1000)
赋值 (.时钟周期, 200)
赋值 (运行目录, 取运行目录 ())
.如果 (并且 (等于 (文件是否存在 (相加 (运行目录, “\操作项目.ini”)), 真), 不等于 (取文件尺寸 (相加 (运行目录, “\操作项目.ini”)), 0)))
    赋值 (., 读入文件 (相加 (运行目录, “\操作项目.ini”)))
.否则
    
.如果结束

.如果真 (等于 (文件是否存在 (相加 (取运行目录 (), “\data.mdb”)), 假))
    写到文件 (相加 (取运行目录 (), “\data.mdb”), #data)
.如果真结束
打开 (相加 (取运行目录 (), “\data.mdb”), , , , , , )
赋值 (.内容, “编程：阿目 2007-07-30”)

.子程序 保存项目内容, 空白型, , 
.局部变量 运行目录, 文本型, , , 

赋值 (运行目录, 取运行目录 ())
写到文件 (相加 (运行目录, “\操作项目.ini”), 到字节集 (_启动窗口..))

.子程序 __启动窗口_尺寸被改变, 空白型, , 
.如果真 (小于 (_启动窗口., 181))
    赋值 (_启动窗口., 181)
.如果真结束
.如果真 (小于 (_启动窗口., 200))
    赋值 (_启动窗口., 200)
.如果真结束
.如果真 (大于 (_启动窗口., 181))
    赋值 (_启动窗口., 181)
.如果真结束
 ' 图片框2.高度 ＝ 取用户区高度 () － 177
赋值 (., 相减 (取用户区高度 (), 120))
赋值 (.高度, 相减 (取用户区高度 (), 106))
.移动 (.宽度, 相减 (_启动窗口., .高度), 181, )
赋值 (.左边, 0)
 ' 标签移.移动 (0, 标签上.高度, _启动窗口.宽度, )

.子程序 _时钟1_周期事件, 空白型, , 
.如果 (或者 (小于 (取鼠标水平位置 (), .), 大于 (取鼠标水平位置 (), 相加 (., .)), 小于 (取鼠标垂直位置 (), .), 大于 (取鼠标垂直位置 (), 相加 (., .))))
    .判断开始 (小于或等于 (., 0))
        移动 (相减 (2, .), , , )
    .判断 (大于或等于 (相加 (., .), 取屏幕宽度 ()))
        移动 (相减 (取屏幕宽度 (), 2), , , )
    .判断 (小于或等于 (., 0))
        移动 (相减 (2, .), , )
    .默认
        
    .判断结束
    
.否则
    .判断开始 (小于或等于 (., 0))
        移动 (0, , , )
    .判断 (等于 (., 相减 (取屏幕宽度 (), 2)))
        移动 (相减 (取屏幕宽度 (), .), , , )
        赋值 (_启动窗口., 0)
         ' _启动窗口.高度 ＝ 取屏幕高度 () － 31
    .判断 (小于或等于 (., 0))
        移动 (0, , )
    .默认
         ' _启动窗口.高度 ＝ 取屏幕高度 () － 30
    .判断结束
    
.如果结束
.如果真 (小于或等于 (_启动窗口., 0))
    赋值 (_启动窗口., 0)
     ' _启动窗口.高度 ＝ 取屏幕高度 () － 31
.如果真结束
.如果真 (小于 (_启动窗口., 0))
    赋值 (_启动窗口., 0)
     ' _启动窗口.高度 ＝ 取屏幕高度 () － 31
.如果真结束


.子程序 _标签移_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_启动窗口.发送信息 (161, 2, 0)

.子程序 _标签下_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_启动窗口.发送信息 (274, 61446, 0)

.子程序 __启动窗口_位置被改变, 空白型, , 
.如果真 (等于 (_启动窗口., 2))
    赋值 (_启动窗口., 假)
    赋值 (., 真)
    赋值 (., .)
    赋值 (., _启动窗口.)
    赋值 (.时钟周期, 0)
    _启动窗口.未知支持库函数_20 (., “单击左键打开菜单”, 0, 0)
.如果真结束


.子程序 _托盘图标1_托盘图标被单击, 空白型, , 
弹出菜单 ()

.子程序 _按钮2_被单击, 空白型, , 
赋值 (_启动窗口., 2)

.子程序 _窗口还原_被选择, 空白型, , 
赋值 (_启动窗口., 0)
赋值 (_启动窗口., 1)
 ' _启动窗口.左边 ＝ 1
赋值 (.时钟周期, 200)

.子程序 __启动窗口_将被销毁, 空白型, , 
保存项目内容 ()

.子程序 _添加菜单_被选择, 空白型, , 
载入 (加入菜单窗口, , 真)
保存项目内容 ()

.子程序 _关于_被选择, 空白型, , 
载入 (关于窗口, , 真)

.子程序 _添加项目_被选择, 空白型, , 
载入 (加入项目窗口, , 真)
保存项目内容 ()


.子程序 _帮助_被选择, 空白型, , 
载入 (帮助窗口, , 真)

.子程序 _图形按钮1_被单击, 空白型, , 
全部关闭 ()
_启动窗口.销毁 ()

.子程序 _卷帘式菜单1_项目被右击, 空白型, , 
.参数 菜单索引, 整数型, , 
.参数 项目索引, 整数型, , 

赋值 (_启动窗口.., 菜单索引)
赋值 (_启动窗口.., 项目索引)
载入 (删除窗口, , 真)
保存项目内容 ()

.子程序 _卷帘式菜单1_菜单被右击, 空白型, , 
.参数 菜单索引, 整数型, , 

赋值 (_启动窗口.., 菜单索引)
.如果 (等于 (_启动窗口.未知支持库函数_6 (., 菜单索引), 0))
    .如果真 (等于 (信息框 (“是否真的要删除本菜单？”, 4, “删除菜单”), #是钮))
        _启动窗口.未知支持库函数_3 (., 菜单索引)
        保存项目内容 ()
    .如果真结束
    
.否则
    信息框 (“菜单下还有子项目，不能被删除！”, 0, “删除菜单”)
.如果结束


.子程序 _exit_被选择, 空白型, , 
全部关闭 ()
销毁 ()

.子程序 _图形按钮3_被单击, 空白型, , 
载入 (帮助窗口, , 真)

.子程序 _图形按钮2_被单击, 空白型, , 
赋值 (_启动窗口., 2)

.子程序 _超级按钮1_被单击, 空白型, , 
弹出菜单 ()

.子程序 _超级按钮2_被单击, 空白型, , 
弹出菜单 ()

.子程序 _退出_被选择, 空白型, , 
全部关闭 ()
销毁 ()

.子程序 _贴边隐藏_被选择, 空白型, , 
赋值 (_启动窗口., 0)

.子程序 _初始化_被选择, 空白型, , 
.如果真 (等于 (信息框 (相加 (“是否真的要初始化？”, #换行符, #换行符, “初始化后请重新运行程序。”), 相加 (#警告图标, #确认取消钮), “初始化前要谨慎”), #确认钮))
    全部关闭 ()
    删除文件 (“操作项目.ini”)
    删除文件 (“data.mdb”)
    结束 ()
.如果真结束


.窗口程序集 窗口程序集1, , , 

.子程序 _加入项目_被单击, 空白型, , 
.局部变量 菜单内容, 文本型, , , 
.局部变量 项目内容, 文本型, , , 

.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“请输入项目的名称和地址”, 0, )
.如果真结束
赋值 (菜单内容, _启动窗口.未知支持库函数_7 (., _启动窗口..))
赋值 (项目内容, .内容)
_启动窗口.未知支持库函数_2 (., 项目内容, , , , )
打开 (相加 (取运行目录 (), “\data.mdb”), , , , , , )
加记录 (菜单内容, 项目内容, .内容)
加入项目窗口.销毁 ()

.子程序 _打开_被单击, 空白型, , 
.局部变量 文本变量, 文本型, , , 
.局部变量 逻辑变量, 逻辑型, , , 

赋值 (.过滤器, “程序|*.exe|所有文件|*.*”)
打开 ()
赋值 (.标题, 加入项目窗口.)
赋值 (.内容, .文件名)
赋值 (.内容, .文件名)

.子程序 _加入项目窗口_创建完毕, 空白型, , 
赋值 (加入项目窗口., #关于背景)

.子程序 _加入项目1_被单击, 空白型, , 
销毁 ()

.子程序 _打开1_被单击, 空白型, , 
赋值 (.内容, “”)

.窗口程序集 窗口程序集2, , , 

.子程序 _加入菜单_被单击, 空白型, , 
.局部变量 菜单内容, 文本型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请输入菜单的名称”, 0, )
.如果真结束
赋值 (菜单内容, .内容)
_启动窗口.未知支持库函数_1 (., 菜单内容, , )
加入菜单窗口.销毁 ()

.子程序 _加入菜单1_被单击, 空白型, , 
销毁 ()

.子程序 _加入菜单窗口_创建完毕, 空白型, , 
未知支持库函数_0 (1)
赋值 (加入菜单窗口., #关于背景)

.窗口程序集 窗口程序集3, , , 

.子程序 _关于窗口_创建完毕, 空白型, , 
赋值 (关于窗口., #关于背景)

.子程序 _图形按钮1_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集4, , , 

.子程序 _帮助窗口_创建完毕, 空白型, , 
赋值 (帮助窗口., #关于背景)

.子程序 _图形按钮1_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集5, , , 

.程序集变量 项目地址, 文本型, , , 
.程序集变量 菜单名称, 文本型, , , 
.程序集变量 项目名称, 文本型, , , 
.子程序 _按钮1_被单击, 空白型, , 
打开 (相加 (取运行目录 (), “\data.mdb”), , , , , , )
到首记录 ()
查找 (并且 (等于 (读 (“菜单”), 菜单名称), 等于 (读 (“项目”), 项目名称)))
赋值 (项目地址, 读 (“项目地址”))
赋值 (.内容, 相加 (菜单名称, #换行符, 项目名称, #换行符, 项目地址))
删除 ()
彻底删除 ()
关闭 ()
_启动窗口.未知支持库函数_4 (., _启动窗口.., )
删除窗口.销毁 ()

.子程序 _删除窗口_创建完毕, 空白型, , 
赋值 (删除窗口., #关于背景)
赋值 (菜单名称, _启动窗口.未知支持库函数_7 (., _启动窗口..))
赋值 (项目名称, _启动窗口.未知支持库函数_8 (., _启动窗口.., ))
打开 (相加 (取运行目录 (), “\data.mdb”), , , , , , )
到首记录 ()
查找 (并且 (等于 (读 (“菜单”), 菜单名称), 等于 (读 (“项目”), 项目名称)))
赋值 (项目地址, 读 (“项目地址”))
赋值 (.内容, 相加 (“菜单名称： ”, 菜单名称, #换行符, #换行符, “项目名称： ”, 项目名称, #换行符, #换行符, “项目地址： ”, 项目地址))
关闭 ()

.子程序 _按钮2_被单击, 空白型, , 
删除窗口.销毁 ()


 ' 不属于任何一个程序集、类模块的函数：
