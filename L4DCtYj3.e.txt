 ' 文件类型：Windows模块源码

 ' 程序名称：鼠标移入移出事件_模块
 ' 程序描述：
@备注:
编写日期:2009年4月17日11:13:10
 ' 程序作者：阿杰
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.wodesoft.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.wodesoft.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0



.常量 GWL_WNDPROC, "-4", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库




数据类型 RECT, , 矩形;
    .成员 左边, 整数型, , , 
    .成员 顶边, 整数型, , , 
    .成员 右边, 整数型, , , 
    .成员 底边, 整数型, , , 

数据类型 POINTAPI, , 坐标_
    .成员 X, 整数型, , , x，横向位置
    .成员 Y, 整数型, , , y，纵向位置

数据类型 移入移出事件, , 
    .成员 句柄, 空白型, , , 
    .成员 移入事件, 子程序指针, , , 
    .成员 移出事件, 子程序指针, , , 
    .成员 是否移入, 逻辑型, , , 
    .成员 消息钩子句柄, 空白型, , , 


.DLL命令 CallWindowProc, 整数型, "user32", "CallWindowProcA", , 
    .参数 lpPrevWndFunc, 整数型, , 
    .参数 hWnd, 整数型, , 
    .参数 Msg, 整数型, , 
    .参数 wParam, 整数型, , 
    .参数 lParam, 整数型, , 

.DLL命令 SetWindowLong, 整数型, "user32", "SetWindowLongA", , 
    .参数 hWnd, 整数型, , 
    .参数 nIndex, 整数型, , 
    .参数 dwNewLong, 整数型, , 

.DLL命令 GetCursorPos, 整数型, "user32", "GetCursorPos", , 取鼠标位置_
    .参数 位置, POINTAPI, , 

.DLL命令 ReleaseCapture, 整数型, "user32.dll", "ReleaseCapture", , 为当前的应用程序释放鼠标捕获  TRUE（非零）表示成功，零表示失败

.DLL命令 SetCapture, 整数型, "user32.dll", "SetCapture", , 将鼠标捕获设置到指定的窗口。在鼠标按钮按下的时候，这个窗口会为当前应用程序或整个系统接收所有鼠标输入  之前拥有鼠标捕获的窗口的句柄
    .参数 窗口句柄, 整数型, , 

.DLL命令 GetClientRect, 整数型, "user32.dll", "GetClientRect", , 返回指定窗口客户区矩形的大小  非零表示成功，零表示失败。会设置GetLastError
    .参数 窗口句柄, 整数型, , 欲计算大小的目标窗口
    .参数 矩形区域, RECT, , RECT，指定一个矩形，用客户区域的大小载入（以像素为单位）;

.DLL命令 CallWindowProcA, 整数型, "", "", , 
    .参数 嵌入代码, 字节集, , 
    .参数 函数, 子程序指针, , 
    .参数 a, 空白型, , 
    .参数 b, 空白型, , 
    .参数 c, 空白型, , 

.DLL命令 GetWindowRect, 整数型, "user32", "GetWindowRect", , 取窗口rect
    .参数 窗口句柄, 整数型, , 
    .参数 矩形区域, RECT, , 

.DLL命令 WindowFromPoint, 整数型, "user32.dll", "WindowFromPoint", , 取指定点窗口句柄_
    .参数 横坐标, 整数型, , xPoint，x点值
    .参数 纵坐标, 整数型, , yPoint，y点值

.DLL命令 ScreenToClient, 整数型, "user32.dll", "ScreenToClient", , 到客户区坐标_,ScreenToClient，Long，非零表示成功，零表示失败
    .参数 窗口句柄, 整数型, , hwnd，Long，一个窗口的句柄，该窗口定义了要使用的客户区坐标系统
    .参数 点, POINTAPI, , POINTAPI，屏幕坐标系统中包含了屏幕点的结构。这个函数会随同相应的客户区坐标（由hwnd决定）载入结构

.DLL命令 ChildWindowFromPointEx, 整数型, "user32", "", , 
    .参数 hWnd, 整数型, , 
    .参数 x, 整数型, , 
    .参数 y, 整数型, , 
    .参数 un, 整数型, , 

.窗口程序集 启动, , , 本模块由阿杰编写(论坛ID:LZJ)

.子程序 _启动子程序, 整数型, , 
返回 (1)

.程序集 自定义函数, , , 

.程序集变量 移入移出事件, 移入移出事件, , "0", 
.程序集变量 是否移入, 逻辑型, , , 
.程序集变量 zTmp, 移入移出事件, , , 
.程序集变量 临时句柄, 空白型, , , 当前控件的句柄
.程序集变量 nTmp, 空白型, , , 当前控件在数组中的存放位置
.子程序 删除鼠标移入移出事件, 整数型, 公开, 
.参数 组件句柄, 空白型, , 

.局部变量 i, 整数型, , , 
.局部变量 局返回值, 空白型, , , 

 ' --========  易语言资源网  (www.wodesoft.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.wodesoft.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.wodesoft.com  ================--

.计次循环首 (取数组成员数 (移入移出事件), i)
    .如果真 (等于 (移入移出事件 [i], 句柄, 组件句柄))
        赋值 (局返回值, SetWindowLong (移入移出事件 [i], 句柄, #GWL_WNDPROC, 移入移出事件 [i], 消息钩子句柄))
        删除成员 (移入移出事件, i, )
        赋值 (nTmp, 0)
        赋值 (临时句柄, 0)
        跳出循环 ()
    .如果真结束
     ' 本源码来自易语言资源网(www.wodesoft.com)
.计次循环尾 ()
返回 (局返回值)

.子程序 删除所有鼠标移入移出事件, 空白型, 公开, 
.局部变量 i, 整数型, , , 

.计次循环首 (取数组成员数 (移入移出事件), i)
    SetWindowLong (移入移出事件 [i], 句柄, #GWL_WNDPROC, 移入移出事件 [i], 消息钩子句柄)
.计次循环尾 ()
清除数组 (移入移出事件)
赋值 (nTmp, 0)
赋值 (临时句柄, 0)
' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 添加鼠标移入移出事件, 空白型, 公开, 添加鼠标移入移出事件
.参数 句柄, 空白型, , 指定控件句柄可以是任何组件
.参数 移入事件, 子程序指针, , 
.参数 移出事件, 子程序指针, , 

赋值 (zTmp.句柄, 句柄)
赋值 (zTmp.移入事件, 移入事件)
赋值 (zTmp.移出事件, 移出事件)
赋值 (zTmp.消息钩子句柄, SetWindowLong (句柄, #GWL_WNDPROC, 到整数 (&消息钩子回调)))
加入成员 (移入移出事件, zTmp)

.子程序 消息钩子回调, 整数型, , 
.参数 hWnd, 空白型, , 
.参数 uMsg, 空白型, , 
.参数 wParam, 空白型, , 
.参数 lParam, 空白型, , 

.局部变量 PrevProchWnd, 整数型, , , 
.局部变量 i, 整数型, , , 计次变量
.局部变量 个数, 空白型, , , 

 ' 调试输出 (hWnd, uMsg, wParam, lParam, zTmp.消息钩子句柄)
赋值 (个数, 取数组成员数 (移入移出事件))
 ' .如果真 (等于 (个数, 0))
     ' 返回 (1)
.如果真结束

.如果真 (不等于 (临时句柄, hWnd)) ' 确定只程序执行一次,这样可以防止程序多次运行,大大的提高了运行效率。
    赋值 (临时句柄, hWnd)
    .计次循环首 (个数, i)
        .如果真 (等于 (移入移出事件 [i], 句柄, hWnd))
             ' 鼠标移入移出事件 (hWnd, 移入移出事件 [i].移入事件, 移入移出事件 [i].移出事件)
            赋值 (nTmp, i)
            跳出循环 ()
        .如果真结束
         ' 本源码来自易语言资源网(www.wodesoft.com)
    .计次循环尾 ()
.如果真结束

.如果真 (等于 (uMsg, 512))
    鼠标移入移出事件 (hWnd, 移入移出事件 [nTmp], 移入事件, 移入移出事件 [nTmp], 移出事件)
    返回 (1)
.如果真结束
返回 (CallWindowProc (移入移出事件 [nTmp], 消息钩子句柄, hWnd, uMsg, wParam, lParam))

.子程序 鼠标移入移出事件, 整数型, , 移入返回1,移出返回2,移动中返回3
.参数 控件句柄, 整数型, , 
.参数 移入事件, 子程序指针, , 
.参数 移出事件, 子程序指针, , 

处理事件 ()
.如果 (等于 (取鼠标所在窗口句柄_ (), 控件句柄))
    .如果真 (等于 (是否移入, 假))
        SetCapture (控件句柄)
        执行子程序_ (移入事件)
        赋值 (是否移入, 真)
        返回 (1)
    .如果真结束
    ' 本源码来自易语言资源网(www.wodesoft.com)
.否则
    执行子程序_ (移出事件)
    ReleaseCapture ()
    赋值 (是否移入, 假)
    返回 (2)
    
.如果结束
SetCapture (控件句柄)
返回 (3)

.子程序 执行子程序_, 整数型, , 例子，执行子程序 (&子程序1, 100) 或 执行子程序1 (&子程序1, 1, 2, 3)
.参数 子程序, 子程序指针, , 
.参数 参数一, 空白型, 可空, 
.参数 参数二, 空白型, 可空, 
.参数 参数三, 空白型, 可空, 

返回 (CallWindowProcA ({ 85, 139, 236, 255, 117, 20, 255, 117, 16, 255, 117, 12, 255, 85, 8, 201, 194, 16, 0 }, 子程序, 参数一, 参数二, 参数三))
' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 取鼠标所在窗口句柄_, 整数型, , 取鼠标所在窗口句柄。本命令为超级命令。
.局部变量 鼠标点, POINTAPI, , , 
.局部变量 ls_hWnd, 整数型, , , 

GetCursorPos (鼠标点)
赋值 (ls_hWnd, WindowFromPoint (鼠标点.X, 鼠标点.Y))
ScreenToClient (ls_hWnd, 鼠标点)
赋值 (ls_hWnd, ChildWindowFromPointEx (ls_hWnd, 鼠标点.X, 鼠标点.Y, 0)) ' CWP_ALL
返回 (ls_hWnd)
' 本源码来自易语言资源网(www.wodesoft.com)


 ' 不属于任何一个程序集、类模块的函数：
