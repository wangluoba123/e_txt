 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 2 0 系统核心支持库



窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 390
    高度 = 297
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 180
    高度 = 210
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”





.全局变量 姓名, 文本型, , , 
.全局变量 工资, 文本型, , , 
.全局变量 扣除, 文本型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 实发, 文本型, , , 
.程序集变量 总支出, 空白型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 字段集, 字段信息, , "0", 
.局部变量 字段, 字段信息, , , 
.局部变量 容器, 空白型, , , 

赋值 (总支出, 0)
.如果真 (等于 (寻找文件 (相加 (取当前目录 (), “\工资库.edb”), ), “”))
    赋值 (字段., “姓名”)
    赋值 (字段., #文本型)
    赋值 (字段., 8)
    加入成员 (字段集, 字段)
    赋值 (字段., “工资”)
    赋值 (字段., #文本型)
    赋值 (字段., 8)
    加入成员 (字段集, 字段)
    赋值 (字段., “扣除”)
    赋值 (字段., #文本型)
    赋值 (字段., 8)
    加入成员 (字段集, 字段)
    赋值 (字段., “实发”)
    赋值 (字段., #文本型)
    赋值 (字段., 8)
    加入成员 (字段集, 字段)
    创建 (相加 (取当前目录 (), “\工资库.edb”), 字段集)
.如果真结束
赋值 (., 相加 (取当前目录 (), “\工资库.edb”))
.如果真 (等于 (取行数 (), 0))
    赋值 (., 真)
    赋值 (., 真)
.如果真结束
.计次循环首 (取行数 (), 容器)
    赋值 (总支出, 相加 (总支出, 到数值 (容器.取文本 (4))))
.计次循环尾 ()
赋值 (., 相加 (“总计支出：”, 到文本 (总支出), “元！”))
获取焦点 ()

.子程序 _按钮4_被单击, 空白型, , 
结束 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 容器, 空白型, , , 

信息框 (相加 (“注意！”, #换行符, “用这种方式添加记录，只是为了说明这种方式而已！”, #换行符, “您可以根据您的具体需要，选择用插入那种方式或这种！”), 0, “说明：）”)
载入 (窗口1, , 真)
.如果真 (不等于 (姓名, “”))
    赋值 (实发, 到文本 (相减 (到数值 (工资), 到数值 (扣除))))
    .如果真 (等于 (., 真))
        赋值 (., 假)
        赋值 (., 假)
    .如果真结束
    .添加行 ()
    取行数 ().置文本 (1, 姓名)
    取行数 ().置文本 (2, 工资)
    取行数 ().置文本 (3, 扣除)
    取行数 ().置文本 (4, 实发)
    刷新 ()
    赋值 (总支出, 相加 (总支出, 到数值 (取行数 ().取文本 (4))))
    赋值 (., 相加 (“总计支出：”, 到文本 (总支出), “元！”))
.如果真结束
获取焦点 ()

.子程序 _表格1_内容被改变, 空白型, , 
.参数 行号, 整数型, , 
.参数 列号, 整数型, , 
.参数 行数, 整数型, , 
.参数 列数, 整数型, , 

.局部变量 容器, 空白型, , , 

.如果真 (等于 (删全部空 (行号.取文本 (1)), “”))
    信息框 (“姓名不能为空！”, 16, “错误：（”)
    行号.置文本 (2, “0”)
    行号.置文本 (3, “0”)
    行号.置文本 (4, “0”)
.如果真结束
行号.置文本 (2, 到文本 (到数值 (行号.取文本 (2))))
行号.置文本 (3, 到文本 (到数值 (行号.取文本 (3))))
行号.置文本 (4, 到文本 (相减 (到数值 (行号.取文本 (2)), 到数值 (行号.取文本 (3)))))
赋值 (总支出, 0)
.计次循环首 (取行数 (), 容器)
    赋值 (总支出, 相加 (总支出, 到数值 (容器.取文本 (4))))
.计次循环尾 ()
赋值 (., 相加 (“总计支出：”, 到文本 (总支出), “元！”))

.子程序 _按钮2_被单击, 空白型, , 
.局部变量 行号, 空白型, , , 
.局部变量 容器, 空白型, , , 

赋值 (行号, 取光标行号 ())
.添加行 () ' 如果添加记录用这种方式，那到此就可以了，下面不要：）
.计次循环首 (相减 (取行数 (), 行号), 容器)
    相加 (相减 (取行数 (), 容器), 1).置文本 (1, 相减 (取行数 (), 容器).取文本 (1))
    相加 (相减 (取行数 (), 容器), 1).置文本 (2, 相减 (取行数 (), 容器).取文本 (2))
    相加 (相减 (取行数 (), 容器), 1).置文本 (3, 相减 (取行数 (), 容器).取文本 (3))
    相加 (相减 (取行数 (), 容器), 1).置文本 (4, 相减 (取行数 (), 容器).取文本 (4))
.计次循环尾 ()
行号.置文本 (1, “”)
行号.置文本 (2, “0”)
行号.置文本 (3, “0”)
行号.置文本 (4, “0”)
获取焦点 ()
行号.置光标 (1)
刷新 ()

.子程序 _按钮3_被单击, 空白型, , 
.局部变量 容器, 空白型, , , 

.如果真 (等于 (信息框 (相加 (“真的要删除姓名为”, #左引号, 取光标行号 ().取文本 (1), #右引号, “的记录吗？”), 49, “注意！”), 0))
    取光标行号 ().删除行 ()
    刷新 ()
    .如果真 (等于 (取行数 (), 0))
        赋值 (., 真)
        赋值 (., 真)
    .如果真结束
    赋值 (总支出, 0)
    .计次循环首 (取行数 (), 容器)
        赋值 (总支出, 相加 (总支出, 到数值 (容器.取文本 (4))))
    .计次循环尾 ()
    赋值 (., 相加 (“总计支出：”, 到文本 (总支出), “元！”))
.如果真结束
获取焦点 ()

.窗口程序集 窗口程序集2, , , 

.子程序 _窗口1_可否被关闭, 逻辑型, , 
返回 (假) ' 防止按ALT+F4退出：）

.子程序 _按钮2_被单击, 空白型, , 
赋值 (姓名, “”)
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
赋值 (姓名, 删全部空 (.))
.如果真 (等于 (姓名, “”))
    信息框 (“姓名不能为空！”, 16, “错误：（”)
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (工资, .)
赋值 (扣除, .)
销毁 ()

.子程序 _窗口1_创建完毕, 空白型, , 
赋值 (姓名, “”)
赋值 (., 0)

.子程序 _编辑框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框2_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (#回车键))
    获取焦点 ()
    赋值 (., 1)
.如果真结束


.子程序 _编辑框3_失去焦点, 空白型, , 
赋值 (., 0)


 ' 不属于任何一个程序集、类模块的函数：
