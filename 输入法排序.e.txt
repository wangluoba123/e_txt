 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假



.常量 KLF_REORDER, "8", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 4 系统核心支持库





.DLL命令 获得键盘布局列表, 整数型, "user32.dll", "GetKeyboardLayoutList", , 
    .参数 缓冲, 整数型, , 
    .参数 布局列表数组, 整数型, 传址, 

.DLL命令 获得键盘布局名称, 整数型, "imm32.dll", "ImmGetDescriptionA", , 
    .参数 布局, 整数型, , 
    .参数 布局名称, 文本型, , 
    .参数 名称长度, 整数型, , 

.DLL命令 判断中文键盘布局, 整数型, "imm32.dll", "ImmIsIME", , 
    .参数 hkl, 整数型, , 

.DLL命令 激活键盘布局, 整数型, "user32.dll", "ActivateKeyboardLayout", , 
    .参数 布局, 整数型, , 
    .参数 标志, 整数型, , 

.DLL命令 获得键盘布局, 整数型, "user32.dll", "GetKeyboardLayout", , 
    .参数 布局索引, 整数型, , 

.DLL命令 取得当前键盘布局名称, 整数型, "user32.dll", "GetKeyboardLayoutNameA", , 
    .参数 pwszKLID, 文本型, , 

.DLL命令 卸载键盘布局, 整数型, "", "UnloadKeyboardLayout", , 
    .参数 布局代号, 文本型, , 

.DLL命令 装载输入法, 整数型, "user32.dll", "LoadKeyboardLayoutA", , 
    .参数 名称8字代号, 文本型, , 
    .参数 flags, 整数型, , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 输入法数目, 整数型, , , 
.程序集变量 i, 整数型, , , 
.程序集变量 hKB, 整数型, , "25", 
.程序集变量 BuffLen, 整数型, , , 
.程序集变量 Buff, 文本型, , , 
.程序集变量 布局名称, 文本型, , , 
.程序集变量 RetCount, 整数型, , , 
.程序集变量 kln, 文本型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
列表输入法 ()
赋值 (., 相加 (“您的电脑共安装了 ”, 到文本 (输入法数目), “ 种输入法。”))

.子程序 列表输入法, 空白型, , 
.局部变量 目前键盘布局, 整数型, , , 

赋值 (Buff, 取空白文本 (255))
赋值 (目前键盘布局, 获得键盘布局 (0)) ' 取得目前的输入法
赋值 (输入法数目, 获得键盘布局列表 (25, hKB [1])) ' 取得所有输入法
 ' ReDim layoutlist(NoOfKBDLayout) As String
.计次循环首 (输入法数目, i)
    .如果 (等于 (判断中文键盘布局 (hKB [i]), 1)) ' 中文输入法
        赋值 (BuffLen, 255)
        赋值 (RetCount, 获得键盘布局名称 (hKB [i], Buff, BuffLen))
        赋值 (布局名称, 取文本左边 (Buff, RetCount))
        布局名称.加入项目 ()
        
    .否则
        赋值 (布局名称, “英语(美国)”) ' 英文输入法
        布局名称.加入项目 ()
    .如果结束
    
.计次循环尾 ()
激活键盘布局 (目前键盘布局, 0) ' 恢复原来的输入法


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 res, 整数型, , , 
.局部变量 hCurKBDLayout, 整数型, , , 


.如果真 (等于 (., -1)) ' 如果用户尚未选择输入法，显示出错信息
    信息框 (“请先选择一个输入法”, 0, )
    返回 ()
.如果真结束
 ' 改变输入法顺序
赋值 (kln, 取空白文本 (8))
赋值 (res, 激活键盘布局 (hKB [相加 (., 1)], 0))
赋值 (res, 取得当前键盘布局名称 (kln))
赋值 (res, 装载输入法 (kln, #KLF_REORDER))
res ＝ 激活键盘布局 (hCurKBDLayout, 0)
 ' 暂停

.子程序 _第一输入法_被单击, 空白型, , 
.局部变量 res, 整数型, , , 
.局部变量 hCurKBDLayout, 整数型, , , 


.如果真 (等于 (., -1)) ' 如果用户尚未选择输入法，显示出错信息
    信息框 (“请先选择一个输入法”, 0, )
    返回 ()
.如果真结束
 ' 改变输入法顺序
赋值 (取空白文本 (8))
赋值 (res, 激活键盘布局 (hKB [相加 (., 1)], 0))
赋值 (res, 未知函数_167837835 ())
赋值 (res)

.子程序 _第二输入法_被单击, 空白型, , 
.局部变量 res, 整数型, , , 
.局部变量 hCurKBDLayout, 整数型, , , 


.如果真 (等于 (., -1)) ' 如果用户尚未选择输入法，显示出错信息
    信息框 (“请先选择一个输入法”, 0, )
    返回 ()
.如果真结束
 ' 改变输入法顺序
赋值 (取空白文本 (8))
赋值 (res, 激活键盘布局 (hKB [相加 (., 1)], 0))
赋值 (res, 未知函数_167837843 ())
赋值 (res)


 ' 不属于任何一个程序集、类模块的函数：
