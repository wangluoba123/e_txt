 ' 文件类型：Windows窗口程序

 ' 程序名称：修改MP3文件摘要
 ' 程序描述：修改MP3文件摘要
@备注:
修改MP3文件摘要
 ' 程序作者：鸿兴软件
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 740
    高度 = 229
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “修改MP3文件摘要”
    帮助文件名 = “”



.图片 , , , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' spec A512548E76954B6E92C21055517615B0 3 0 特殊功能支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 3 0 应用接口支持库
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 2 0 多线程支持库




数据类型 mp3信息, 公开, 
    .成员 标识, 字节集, , , TAG三个字母，ID3V1的标识
    .成员 歌曲名, 字节集, , , 存储标题信息,30个字节 
    .成员 歌手名, 字节集, , , 存储歌手信息,30个字节
    .成员 专辑名, 字节集, , , 存储专辑信息,30个字节
    .成员 发行年, 字节集, , , 存储年代信息,4个字节
    .成员 备注, 字节集, , , 存储备注信息,28个字节（有时为30字节）
    .成员 是否有音轨, 字节集, , , 存储音乐风格信息,保留位，1个字节 [为0，则说明有音轨，下一位就是音轨]
    .成员 音轨, 字节集, , , 音轨（曲号）保留位，1个字节（在于上一位）
    .成员 风格, 字节集, , , 保留位，1个字节（风格）


.窗口程序集 窗口程序集1, , , 

.程序集变量 空白字节集, 字节集, , , 30位空白
.程序集变量 文件, 字节集, , , 
.程序集变量 临时信息, 字节集, , , 
.程序集变量 mp3, mp3信息, , , 
.程序集变量 数组_文件名, 文本型, , "0", 
.程序集变量 长度, 整数型, , , 
.子程序 取歌曲信息类, 空白型, , 
.参数 a, 字节集, , 

.局部变量 i, 整数型, , , 

未知函数_669 () ' *** 缩略程序块 ***
 ' mp3.标识 ＝ 取字节集左边 (a, 3)  ' TAG 标志
 ' mp3.歌曲名 ＝ 取字节集中间 (a, 4, 30)  ' 歌曲名
 ' mp3.歌手名 ＝ 取字节集中间 (a, 34, 30)  ' 歌手名
 ' mp3.专辑名 ＝ 取字节集中间 (a, 64, 30)  ' 专集名
 ' mp3.发行年 ＝ 取字节集中间 (a, 94, 4)  ' 发行年
 ' mp3.备注 ＝ 取字节集中间 (a, 98, 28)  ' 备注
 ' mp3.是否有音轨 ＝ 取字节集中间 (a, 126, 1)  ' 保留位，这时为0，则说明有音轨，下一位就是音轨
 ' mp3.音轨 ＝ 取字节集中间 (a, 127, 1)  ' 保留位，为音轨（第几首歌）
 ' mp3.风格 ＝ 取字节集中间 (a, 128, 1)  ' 保留位   (风格)
赋值 (.内容, 到文本 (取字节集中间 (a, 98, 28)))
赋值 (.内容, 到文本 (取字节集中间 (a, 94, 4)))
赋值 (.内容, 到文本 (取字节集中间 (a, 64, 30)))
赋值 (.内容, 到文本 (取字节集中间 (a, 34, 30)))
赋值 (.内容, 到文本 (取字节集中间 (a, 4, 30)))


.子程序 歌曲信息替换, 字节集, , 返回修改后的信息[]
.参数 a1, 字节集, , 

.局部变量 b, 字节集, , , 

赋值 (b, a1)
.如果 (.选中)
    赋值 (b, 字节集替换 (b, 4, 30, 空白字节集)) ' 歌曲名
    赋值 (b, 字节集替换 (b, 34, 30, 空白字节集)) ' 歌手名
    赋值 (b, 字节集替换 (b, 64, 30, 空白字节集)) ' 专集名
    赋值 (b, 字节集替换 (b, 94, 4, 取字节集左边 (空白字节集, 4))) ' 发行年
    赋值 (b, 字节集替换 (b, 98, 28, 取字节集左边 (空白字节集, 28))) ' 备注
.否则
    
    
    赋值 (b, 字节集替换 (b, 4, 30, 取字节集左边 (相加 (到字节集 (.内容), 空白字节集), 30))) ' 歌曲名
    赋值 (b, 字节集替换 (b, 34, 30, 取字节集左边 (相加 (到字节集 (.内容), 空白字节集), 30))) ' 歌手名
    赋值 (b, 字节集替换 (b, 64, 30, 取字节集左边 (相加 (到字节集 (.内容), 空白字节集), 30))) ' 专集名
    赋值 (b, 字节集替换 (b, 94, 4, 取字节集左边 (相加 (到字节集 (.内容), 空白字节集), 4))) ' 发行年
    赋值 (b, 字节集替换 (b, 98, 28, 取字节集左边 (相加 (到字节集 (.内容), 空白字节集), 28))) ' 备注
.如果结束

返回 (取字节集左边 (b, 128))

.子程序 _选择框1_被单击, 空白型, , 
.如果 (.选中)
    连续赋值 (真, .禁止, .禁止, .禁止, .禁止, .禁止)
    连续赋值 (“空白信息。。。”, .内容, .内容, .内容, .内容, .内容)
.否则
    连续赋值 (假, .禁止, .禁止, .禁止, .禁止, .禁止)
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容)
.如果结束


.子程序 处理线程, 空白型, , 
.局部变量 a, 文本型, , , 
.局部变量 目录, 文本型, , , 
.局部变量 文件名, 文本型, , , 
.局部变量 i, 整数型, , , 

赋值 (.禁止, 真)
赋值 (目录, .目录)
赋值 (a, 寻找文件 (相加 (目录, “\*.mp3”), ))
赋值 (.标题, “获取文件名数据”)
.判断循环首 (不等于 (a, “”))
    加入成员 (数组_文件名, a)
    赋值 (a, 寻找文件 ())
    延迟 (10)
.判断循环尾 ()
 ' 调试输出 (数组_文件名)
.计次循环首 (取数组成员数 (数组_文件名), i)
    赋值 (.标题, 相加 (“开始处理：”, 数组_文件名 [i]))
    赋值 (文件, 读入文件 (相加 (目录, “\”, 数组_文件名 [i])))
    赋值 (长度, 相加 (相减 (取字节集长度 (文件), 倒找字节集 (文件, 到字节集 (“TAG”), )), 1))
    赋值 (临时信息, 取字节集右边 (文件, 长度))
    调试输出 (长度, 临时信息, 到文本 (取字节集左边 (临时信息, 3)))
    .如果 (不等于 (取字节集左边 (临时信息, 3), 到字节集 (“TAG”)))
         ' 标签_信息.标题 ＝ 数组_文件名 [i] ＋ “   文件信息获取错误！”
        到循环尾 ()
    .否则
        取歌曲信息类 (临时信息)
        .如果真 (大于 (长度, 128))
            调试输出 (歌曲信息替换 (临时信息), 长度, “sos”)
            赋值 (文件, 字节集替换 (文件, 相减 (取字节集长度 (文件), 相减 (长度, 128)), 相减 (长度, 128), ))
        .如果真结束
        赋值 (文件, 字节集替换 (文件, 相减 (取字节集长度 (文件), 128), 128, 歌曲信息替换 (临时信息)))
        .如果 (写到文件 (相加 (目录, “\”, 数组_文件名 [i]), 文件))
             ' 标签_信息.标题 ＝ 数组_文件名 [i] ＋ “   处理成功~！！”
        .否则
             ' 标签_信息.标题 ＝ 数组_文件名 [i] ＋ “   处理失败~！！”
        .如果结束
        
    .如果结束
    延迟 (10)
.计次循环尾 ()
清除数组 (数组_文件名)
赋值 (.标题, “完成”)
赋值 (.禁止, 假)

.子程序 __启动窗口_创建完毕, 空白型, , 
.计次循环首 (30, )
    赋值 (空白字节集, 相加 (空白字节集, { 0 }))
.计次循环尾 ()
枚举硬盘分区 ()
 ' 调试输出 (字节集替换 ({ 0, 0, 14, 255, 255 }, 4, 1, ))

.子程序 枚举硬盘分区, 空白型, , 
.局部变量 n, 文本型, , "0", 
.局部变量 i, 整数型, , , 

赋值 (n, 未知支持库函数_5 (1))
.如果真 (大于或等于 (取数组成员数 (n), 1))
    .计次循环首 (取数组成员数 (n), i)
        n.加入项目 ( [i], )
    .计次循环尾 ()
.如果真结束


.子程序 _组合框_驱动器_列表项被选择, 空白型, , 
赋值 (.目录, .取项目文本 (.现行选中项))

.子程序 _按钮2_被单击, 空白型, , 
未知支持库函数_0 (&处理线程, , )


 ' 不属于任何一个程序集、类模块的函数：
