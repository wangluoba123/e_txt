 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 ck主窗口
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = 16744576 '  0xFF8080
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “新科书籍租借系统单机版v1.0”
    帮助文件名 = “”

窗口 ck新书入库
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 0
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 ck书籍分类
    左边 = 50
    顶边 = 50
    宽度 = 600
    高度 = 400
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 ck请稍候
    左边 = 50
    顶边 = 50
    宽度 = 150
    高度 = 172
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 ck会员登记
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 0
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 ck会员充值
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 0
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 ck租借管理
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 0
    底色 = 16744576 '  0xFF8080
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 ck会员挂失
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 0
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 ck会员退款
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 0
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 ck最后确认窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 400
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 16744576 '  0xFF8080
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 ck书籍管理
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 16744576 '  0xFF8080
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 ck会员管理
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 16744576 '  0xFF8080
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 ck租借列表
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 16744576 '  0xFF8080
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 ck利润统计
    左边 = 50
    顶边 = 50
    宽度 = 841
    高度 = 634
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 16744576 '  0xFF8080
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 ck账簿清算
    左边 = 50
    顶边 = 50
    宽度 = 841
    高度 = 634
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 16744576 '  0xFF8080
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 ck图书信息
    左边 = 50
    顶边 = 50
    宽度 = 841
    高度 = 634
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 ck会员分类
    左边 = 50
    顶边 = 50
    宽度 = 600
    高度 = 400
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 ck登陆
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 16744576 '  0xFF8080
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 ck用户分类
    左边 = 50
    顶边 = 50
    宽度 = 600
    高度 = 400
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 ck修改密码
    左边 = 50
    顶边 = 50
    宽度 = 600
    高度 = 400
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 16744576 '  0xFF8080
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 ck数据备份
    左边 = 50
    顶边 = 50
    宽度 = 600
    高度 = 400
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 16744576 '  0xFF8080
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 ck月度信息
    左边 = 50
    顶边 = 50
    宽度 = 841
    高度 = 634
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 16744576 '  0xFF8080
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 ck后台配置
    左边 = 50
    顶边 = 50
    宽度 = 600
    高度 = 400
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 16744576 '  0xFF8080
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 ck系统信息
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 16744576 '  0xFF8080
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 ck暂时离开
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 16744576 '  0xFF8080
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.常量 LWA_ALPHA, "2", , 
.图片 有声, " ' 已保存到：D:\易语言学习\Data\新科书籍租借系统.e\有声", , 
.图片 无声, " ' 已保存到：D:\易语言学习\Data\新科书籍租借系统.e\无声", , 
.声音 滴答声音, " ' 已保存到：D:\易语言学习\Data\新科书籍租借系统.e\滴答声音", , 
.声音 滴答声音1, " ' 已保存到：D:\易语言学习\Data\新科书籍租借系统.e\滴答声音1", , 
.声音 ringout, " ' 已保存到：D:\易语言学习\Data\新科书籍租借系统.e\ringout", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 6 系统核心支持库
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 1 6 高级表格支持库
 ' eDB 46E94341933A462383A4DE26B146322C 1 6 数据库操作支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 3 扩展界面支持库一
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库
 ' EChartBar 9A3F84D7FDEB4a0486F2711D5104B7F7 1 6 数据图表支持库
 ' iext5 {E5000198-4471-40e2-92BC-D0BA075BDBB2} 1 5 扩展界面支持库五



 ' 所需要的模块
 ' 获取文件夹全路径 C:\Documents and Settings\Administrator\桌面\源码\模块_获取文件夹全路径.ec
 ' 单一实例 C:\Documents and Settings\Administrator\桌面\源码\单一实例.ec


.全局变量 押金折扣, 双精度小数型, , , 
.全局变量 qj窗口数组, 窗口, , "0", 
.全局变量 qj是否静音, 逻辑型, , , 
.全局变量 数据库连接器, 未知类型0x30001, , , 
.全局变量 最后确认, 逻辑型, , , 用于 租借管理 的计费窗口
.全局变量 qj用户功能, 文本型, , "0", 
.全局变量 qj用户编号, 文本型, , , 
.全局变量 qj用户名称, 文本型, , , 
.全局变量 时间正常, 逻辑型, , , 
.全局变量 qj数据库路径, 文本型, , , 
.全局变量 qj数据库密码, 文本型, , , 
.全局变量 qj条形码长度, 整数型, , , 
.全局变量 qj会员编号长度, 整数型, , , 
.全局变量 qj配置路径, 文本型, , , 
.全局变量 qj检查时间路径, 文本型, , , 
.全局变量 关闭时备份, 逻辑型, , , 
.全局变量 运行时备份, 逻辑型, , , 
.全局变量 运行时备份间隔, 整数型, , , 
.全局变量 已经进行过赋值, 逻辑型, , , 用于 请稍候 和 后台配置 检测

.DLL命令 SetLayeredWindowAttributes, 整数型, "", "SetLayeredWindowAttributes", , 
    .参数 hwnd, 整数型, , 
    .参数 crKey, 整数型, , 
    .参数 bAlpha, 整数型, , 
    .参数 dwFlags, 整数型, , 

.DLL命令 GetWindowLong, 整数型, "", "GetWindowLongA", , 
    .参数 hwnd, 整数型, , 
    .参数 nIndex, 整数型, , 

.DLL命令 SetWindowLong, 整数型, "", "SetWindowLongA", , 
    .参数 hwnd, 整数型, , 
    .参数 nIndex, 整数型, , 
    .参数 dwNewLong, 整数型, , 

.DLL命令 SetParent, 整数型, "user32.dll", "SetParent", , '返回前一个父窗口的句柄
    .参数 hWndChild, 整数型, , 
    .参数 hWndNewParent, 整数型, , 

.程序集 启动程序集, , , 

.子程序 _启动子程序, 整数型, , 本子程序在程序启动后最先执行
.局部变量 节名数组, 文本型, , "0", 
.局部变量 i, 整数型, , , 
.局部变量 硬盘特征, 整数型, , , 
.局部变量 pass, 逻辑型, , , 

.如果真 (实例已是否创建 (“xk2008xk_”))
    信息框 (“程序已经在运行...不能重复启动!”, #信息图标, “提示”)
    结束 ()
.如果真结束
未知支持库函数_0 (#)
赋值 (qj数据库路径, 相加 (取运行目录 (), “\xkb.mdb”))
赋值 (qj数据库密码, “666666”)
赋值 (qj配置路径, 相加 (取运行目录 (), “\config_1.ini”))
赋值 (qj检查时间路径, 相加 (取运行目录 (), “\chktime”))
.如果真 (文件是否存在 (qj配置路径))
    赋值 (节名数组, 取配置节名 (qj配置路径))
    .计次循环首 (取数组成员数 (节名数组), i)
        .如果真 (等于 (节名数组 [i], “用户配置”))
            赋值 (押金折扣, 相乘 (到数值 (读配置项 (qj配置路径, 节名数组 [i], “押金折扣”, )), 0.1))
            .如果 (等于 (读配置项 (qj配置路径, 节名数组 [i], “关闭时备份”, ), “是”))
                赋值 (关闭时备份, 真)
            .否则
                赋值 (关闭时备份, 假)
            .如果结束
            .如果 (等于 (读配置项 (qj配置路径, 节名数组 [i], “运行时备份”, ), “否”))
                赋值 (运行时备份间隔, -1)
                赋值 (运行时备份, 假)
            .否则
                赋值 (运行时备份间隔, 相乘 (到数值 (读配置项 (qj配置路径, 节名数组 [i], “运行时备份”, )), 60000))
                赋值 (运行时备份, 真)
            .如果结束
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
.如果真结束
.如果真 (小于 (押金折扣, 0.1))
    赋值 (押金折扣, 0.9)
.如果真结束

赋值 (qj条形码长度, 13)
赋值 (qj会员编号长度, 13)

.如果真 (并且 (小于 (运行时备份间隔, 15), 不等于 (运行时备份间隔, -1)))
    赋值 (运行时备份间隔, 相乘 (15, 60000))
    赋值 (运行时备份, 真)
.如果真结束
赋值 (最后确认, 假)
赋值 (已经进行过赋值, 假)
载入 (ck登陆, , 假)
返回 (0)

.窗口程序集 主窗口程序集, , , 

.程序集变量 尺寸改变保持导航按钮外观, 图形按钮, , , 
.程序集变量 主句柄, 整数型, , , 
.程序集变量 导航移动中, 逻辑型, , , 
.子程序 _ck主窗口_创建完毕, 空白型, , 
赋值 (.现行子夹, 2)
.未知支持库函数_20 (“点击此处可以调整日期时间”, -1, , , , )
.未知支持库函数_20 (“点击此处可以开启或关闭运行声音”, -1, , , , )
.判断开始 (qj数据库路径.未知支持库函数_1 (qj数据库密码))
    赋值 (数据库连接器, )
.默认
    信息框 (“出现致命错误,程序结束,错误代码:000,请与作者联系”, #错误图标, “提示”)
    结束 ()
.判断结束

配置用户 ()
赋值 (主句柄, ck主窗口.取窗口句柄 (.))
赋值 (尺寸改变保持导航按钮外观, )
赋值 (导航移动中, 假)
赋值 (ck主窗口., 3)
控件定位 ()
_日常操作_被单击 ()
赋值 (.可视, 真)

.子程序 配置用户, 空白型, , 
.局部变量 pass, 逻辑型, , , 
.局部变量 temp用户功能, 文本型, , , 
.局部变量 SQL语句, 文本型, , , 

.如果真 (等于 (qj用户编号, “”))
    信息框 (“配置用户功能错误，程序终止”, #错误图标, “错误”)
    结束 ()
.如果真结束
赋值 (pass, 假)
清除数组 (qj用户功能)
qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
赋值 (SQL语句, 相加 (“select * from 用户表 where 用户编号='”, qj用户编号, “'”))
赋值 (pass, SQL语句.未知支持库函数_14 (#))
.如果 (pass)
    “用户名称”.未知支持库函数_26 (temp用户功能)
    赋值 (qj用户名称, temp用户功能)
    “新书入库”.未知支持库函数_26 (temp用户功能) ' 1
    加入成员 (qj用户功能, temp用户功能)
    “租借业务”.未知支持库函数_26 (temp用户功能) ' 2
    加入成员 (qj用户功能, temp用户功能)
    “会员登记”.未知支持库函数_26 (temp用户功能) ' 3
    加入成员 (qj用户功能, temp用户功能)
    “会员挂失”.未知支持库函数_26 (temp用户功能) ' 4
    加入成员 (qj用户功能, temp用户功能)
    “会员充值”.未知支持库函数_26 (temp用户功能) ' 5
    加入成员 (qj用户功能, temp用户功能)
    “会员退款”.未知支持库函数_26 (temp用户功能) ' 6
    加入成员 (qj用户功能, temp用户功能)
    “书籍管理”.未知支持库函数_26 (temp用户功能) ' 7
    加入成员 (qj用户功能, temp用户功能)
    “会员管理”.未知支持库函数_26 (temp用户功能) ' 8
    加入成员 (qj用户功能, temp用户功能)
    “租借列表”.未知支持库函数_26 (temp用户功能) ' 9
    加入成员 (qj用户功能, temp用户功能)
    “利润统计”.未知支持库函数_26 (temp用户功能) ' 10
    加入成员 (qj用户功能, temp用户功能)
    “账簿清算”.未知支持库函数_26 (temp用户功能) ' 11
    加入成员 (qj用户功能, temp用户功能)
    “图书信息”.未知支持库函数_26 (temp用户功能) ' 12
    加入成员 (qj用户功能, temp用户功能)
    “月度信息”.未知支持库函数_26 (temp用户功能) ' 13
    加入成员 (qj用户功能, temp用户功能)
    “书籍分类”.未知支持库函数_26 (temp用户功能) ' 14
    加入成员 (qj用户功能, temp用户功能)
    “会员分类”.未知支持库函数_26 (temp用户功能) ' 15
    加入成员 (qj用户功能, temp用户功能)
    “用户分类”.未知支持库函数_26 (temp用户功能) ' 16
    加入成员 (qj用户功能, temp用户功能)
    “修改密码”.未知支持库函数_26 (temp用户功能) ' 17
    加入成员 (qj用户功能, temp用户功能)
    “数据备份”.未知支持库函数_26 (temp用户功能) ' 18
    加入成员 (qj用户功能, temp用户功能)
    “后台配置”.未知支持库函数_26 (temp用户功能) ' 19
    加入成员 (qj用户功能, temp用户功能)
.否则
    信息框 (“读取配置用户功能错误，程序终止”, #错误图标, “错误”)
    结束 ()
.如果结束
未知支持库函数_16 ()
未知支持库函数_3 ()
赋值 (.标题, 相加 (“操作员：”, qj用户名称))

.子程序 MDI配置, 空白型, , 
.参数 子窗口, 窗口, , 
.参数 父窗口, 图片框, , 
.参数 子句柄, 整数型, , 
.参数 父句柄, 整数型, , 

.如果真 (大于 (取数组成员数 (qj窗口数组), 0))
    .如果真 (等于 (qj窗口数组 [1], 子窗口))
        qj窗口数组.获取焦点 ( [1])
        返回 ()
    .如果真结束
    
.如果真结束

SetParent (子句柄, 父句柄)
子窗口.移动 (0, 0, 父窗口.取用户区宽度 (), 父窗口.取用户区高度 ())
加入成员 (qj窗口数组, 子窗口)
.如果真 (大于或等于 (取数组成员数 (qj窗口数组), 2))
    qj窗口数组.销毁 ( [1])
    删除成员 (qj窗口数组, 1, 1)
.如果真结束


.子程序 控件定位, 空白型, , 
连续赋值 (ck主窗口.取用户区宽度 (), .宽度, .宽度)
赋值 (.左边, 相减 (.宽度, .宽度))
赋值 (.左边, 相减 (.宽度, .宽度, .宽度))
赋值 (.宽度, 相减 (.宽度, .宽度, 8, .宽度))
赋值 (.宽度, 相减 (ck主窗口.取用户区宽度 (), .宽度, .宽度))
赋值 (.顶边, 相减 (ck主窗口.取用户区高度 (), .高度))
赋值 (.高度, 相减 (ck主窗口.取用户区高度 (), .高度, .高度))
赋值 (.高度, 相减 (ck主窗口.取用户区高度 (), .高度, .高度))
赋值 (.高度, 相减 (ck主窗口.取用户区高度 (), .高度, .高度, 2))
赋值 (.顶边, 相减 (ck主窗口.取用户区高度 (), .高度, .高度))
赋值 (.顶边, 相减 (ck主窗口.取用户区高度 (), .高度, .高度, .高度))
赋值 (.顶边, 相减 (ck主窗口.取用户区高度 (), .高度, .高度, .高度, .高度))
赋值 (.顶边, 相减 (ck主窗口.取用户区高度 (), .高度, .高度, .高度, .高度, .高度))
赋值 (.左边, 相减 (.宽度, .宽度))
赋值 (.左边, 相减 (.宽度, .宽度, .宽度))
赋值 (.左边, 相减 (.宽度, .宽度, .宽度, .宽度))

ck请稍候.移动 (相加 (ck主窗口., .宽度, 10), 相加 (ck主窗口., .高度, 50), , )
.如果真 (大于 (取数组成员数 (qj窗口数组), 0))
    qj窗口数组.移动 ( [1], 0, 0, ck主窗口.取用户区宽度 (.), ck主窗口.取用户区高度 (.))
.如果真结束

.判断开始 (qj是否静音)
    赋值 (.图片, #无声)
.默认
    赋值 (.图片, #有声)
.判断结束


.子程序 稍后开始, 空白型, , 
赋值 (ck主窗口., 真)
赋值 (ck请稍候., 真)
处理事件 ()

.子程序 稍后结束, 空白型, , 
赋值 (ck主窗口., 假)
赋值 (ck请稍候., 假)
处理事件 ()


.子程序 移动按钮, 空白型, , 
.参数 按钮, 图形按钮, , 

.局部变量 temp, 整数型, , , 
.局部变量 用户区高度, 整数型, , , 

.如果真 (导航移动中)
    返回 ()
.如果真结束
赋值 (尺寸改变保持导航按钮外观, 按钮)
控件定位 ()
赋值 (用户区高度, ck主窗口.取用户区高度 ())
赋值 (temp, 0)
.判断循环首 (小于或等于 (temp, .高度))
    处理事件 ()
    赋值 (按钮.顶边, 相减 (用户区高度, .高度, temp))
    赋值 (temp, 相加 (temp, 35))
    赋值 (导航移动中, 真)
    延时 (2)
.判断循环尾 ()
赋值 (按钮.顶边, 相减 (用户区高度, .高度, .高度))
赋值 (导航移动中, 假)

.子程序 _ck主窗口_尺寸被改变, 空白型, , 
控件定位 ()
移动按钮 (尺寸改变保持导航按钮外观)

.子程序 _统计信息_被单击, 空白型, , 
播放按钮声1 ()
移动按钮 ()
赋值 (.现行子夹, 0)

.子程序 _数据管理_被单击, 空白型, , 
播放按钮声1 ()
移动按钮 ()
赋值 (.现行子夹, 1)

.子程序 _日常操作_被单击, 空白型, , 
播放按钮声1 ()
移动按钮 ()
赋值 (.现行子夹, 2)

.子程序 _系统配置_被单击, 空白型, , 
播放按钮声1 ()
移动按钮 ()
赋值 (.现行子夹, 3)

.子程序 _新书入库_被单击, 空白型, , 
播放按钮声 ()
.如果真 (等于 (qj用户功能 [1], “否”))
    信息框 (“没有权限操作此功能,请与管理员联系”, #警告图标, “提示”)
    返回 ()
.如果真结束

.如果真 (是否已创建 (ck新书入库))
    返回 ()
.如果真结束
稍后开始 ()
载入 (ck新书入库, , 假)
MDI配置 (ck新书入库, ck主窗口., ck新书入库.取窗口句柄 (), 主句柄)
赋值 (ck新书入库., 真)
稍后结束 ()

.子程序 _租借管理_被单击, 空白型, , 
播放按钮声 ()
.如果真 (等于 (qj用户功能 [2], “否”))
    信息框 (“没有权限操作此功能,请与管理员联系”, #警告图标, “提示”)
    返回 ()
.如果真结束

.如果真 (是否已创建 (ck租借管理))
    返回 ()
.如果真结束
稍后开始 ()
载入 (ck租借管理, , 假)
MDI配置 (ck租借管理, ck主窗口., ck租借管理.取窗口句柄 (), 主句柄)
赋值 (ck租借管理., 真)
稍后结束 ()

.子程序 _会员登记_被单击, 空白型, , 
播放按钮声 ()
.如果真 (等于 (qj用户功能 [3], “否”))
    信息框 (“没有权限操作此功能,请与管理员联系”, #警告图标, “提示”)
    返回 ()
.如果真结束

.如果真 (是否已创建 (ck会员登记))
    返回 ()
.如果真结束
稍后开始 ()
载入 (ck会员登记, , 假)
MDI配置 (ck会员登记, ck主窗口., ck会员登记.取窗口句柄 (), 主句柄)
赋值 (ck会员登记., 真)
稍后结束 ()

.子程序 _会员充值_被单击, 空白型, , 
播放按钮声 ()
.如果真 (等于 (qj用户功能 [5], “否”))
    信息框 (“没有权限操作此功能,请与管理员联系”, #警告图标, “提示”)
    返回 ()
.如果真结束

.如果真 (是否已创建 (ck会员充值))
    返回 ()
.如果真结束
稍后开始 ()
载入 (ck会员充值, , 假)
MDI配置 (ck会员充值, ck主窗口., ck会员充值.取窗口句柄 (), 主句柄)
赋值 (ck会员充值., 真)
稍后结束 ()

.子程序 播放按钮声, 空白型, , 
.如果真 (等于 (qj是否静音, 假))
    播放音乐 (#滴答声音, )
.如果真结束


.子程序 播放按钮声1, 空白型, , 
.如果真 (等于 (qj是否静音, 假))
    播放音乐 (#滴答声音1, )
.如果真结束



.子程序 _是否静音_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (qj是否静音)
    赋值 (qj是否静音, 假)
.默认
    赋值 (qj是否静音, 真)
.判断结束

.判断开始 (qj是否静音)
    赋值 (.图片, #无声)
.默认
    赋值 (.图片, #有声)
.判断结束


.子程序 _电子表_周期事件, 空白型, , 
赋值 (.标题, 到文本 (取现行时间 ()))


.子程序 _账簿清算_被单击, 空白型, , 
播放按钮声 ()
.如果真 (等于 (qj用户功能 [11], “否”))
    信息框 (“没有权限操作此功能,请与管理员联系”, #警告图标, “提示”)
    返回 ()
.如果真结束

.如果真 (是否已创建 (ck账簿清算))
    返回 ()
.如果真结束
稍后开始 ()
载入 (ck账簿清算, , 假)
MDI配置 (ck账簿清算, ck主窗口., ck账簿清算.取窗口句柄 (), 主句柄)
赋值 (ck账簿清算., 真)
稍后结束 ()

.子程序 _利润统计_被单击, 空白型, , 
播放按钮声 ()
.如果真 (等于 (qj用户功能 [10], “否”))
    信息框 (“没有权限操作此功能,请与管理员联系”, #警告图标, “提示”)
    返回 ()
.如果真结束

.如果真 (是否已创建 (ck利润统计))
    返回 ()
.如果真结束
稍后开始 ()
载入 (ck利润统计, , 假)
MDI配置 (ck利润统计, ck主窗口., ck利润统计.取窗口句柄 (), 主句柄)
赋值 (ck利润统计., 真)
稍后结束 ()

.子程序 _租借列表_被单击, 空白型, , 
播放按钮声 ()
.如果真 (等于 (qj用户功能 [9], “否”))
    信息框 (“没有权限操作此功能,请与管理员联系”, #警告图标, “提示”)
    返回 ()
.如果真结束

.如果真 (是否已创建 (ck租借列表))
    返回 ()
.如果真结束
稍后开始 ()
载入 (ck租借列表, , 假)
MDI配置 (ck租借列表, ck主窗口., ck租借列表.取窗口句柄 (), 主句柄)
赋值 (ck租借列表., 真)
稍后结束 ()

.子程序 _会员管理_被单击, 空白型, , 
播放按钮声 ()
.如果真 (等于 (qj用户功能 [8], “否”))
    信息框 (“没有权限操作此功能,请与管理员联系”, #警告图标, “提示”)
    返回 ()
.如果真结束

.如果真 (是否已创建 (ck会员管理))
    返回 ()
.如果真结束
稍后开始 ()
载入 (ck会员管理, , 假)
MDI配置 (ck会员管理, ck主窗口., ck会员管理.取窗口句柄 (), 主句柄)
赋值 (ck会员管理., 真)
稍后结束 ()

.子程序 _书籍管理_被单击, 空白型, , 
播放按钮声 ()
.如果真 (等于 (qj用户功能 [7], “否”))
    信息框 (“没有权限操作此功能,请与管理员联系”, #警告图标, “提示”)
    返回 ()
.如果真结束

.如果真 (是否已创建 (ck书籍管理))
    返回 ()
.如果真结束
稍后开始 ()
载入 (ck书籍管理, , 假)
MDI配置 (ck书籍管理, ck主窗口., ck书籍管理.取窗口句柄 (), 主句柄)
赋值 (ck书籍管理., 真)
稍后结束 ()

.子程序 _ck主窗口_位置被改变, 空白型, , 
控件定位 ()


.子程序 _会员挂失_被单击, 空白型, , 
播放按钮声 ()
.如果真 (等于 (qj用户功能 [4], “否”))
    信息框 (“没有权限操作此功能,请与管理员联系”, #警告图标, “提示”)
    返回 ()
.如果真结束

.如果真 (是否已创建 (ck会员挂失))
    返回 ()
.如果真结束
稍后开始 ()
载入 (ck会员挂失, , 假)
MDI配置 (ck会员挂失, ck主窗口., ck会员挂失.取窗口句柄 (), 主句柄)
赋值 (ck会员挂失., 真)
稍后结束 ()

.子程序 _会员退款_被单击, 空白型, , 
播放按钮声 ()
.如果真 (等于 (qj用户功能 [6], “否”))
    信息框 (“没有权限操作此功能,请与管理员联系”, #警告图标, “提示”)
    返回 ()
.如果真结束

.如果真 (是否已创建 (ck会员退款))
    返回 ()
.如果真结束
稍后开始 ()
载入 (ck会员退款, , 假)
MDI配置 (ck会员退款, ck主窗口., ck会员退款.取窗口句柄 (), 主句柄)
赋值 (ck会员退款., 真)
稍后结束 ()

.子程序 取首拼, 文本型, , 取汉字的首拼音
.参数 编辑框, 编辑框, , 要取拼音的编辑框名

.局部变量 计次变量, 整数型, , , 计次变量
.局部变量 文本, 文本型, , , 
.局部变量 拼音, 文本型, , , 

赋值 (文本, 编辑框.内容)
.计次循环首 (取文本长度 (文本), 计次变量)
    .判断开始 (或者 (大于 (取代码 (取文本左边 (文本, 1), ), 127), 小于 (取代码 (取文本左边 (文本, 1), ), 0))) ' 判断是全半角
        .判断开始 (等于 (到大写 (取声母 (取文本左边 (文本, 2), 1)), “”)) ' 是全角但是不是汉字
            赋值 (拼音, 相加 (拼音, 到大写 (取文本左边 (文本, 2))))
        .默认
            赋值 (拼音, 相加 (拼音, 到大写 (取文本左边 (取声母 (取文本左边 (文本, 2), 1), 1))))
        .判断结束
        赋值 (文本, 取文本右边 (文本, 相减 (取文本长度 (文本), 2))) ' 把用过文本的去掉，嘻
    .默认
        赋值 (拼音, 相加 (拼音, 到大写 (取文本左边 (文本, 1))))
        赋值 (文本, 取文本右边 (文本, 相减 (取文本长度 (文本), 1)))
    .判断结束
    
.计次循环尾 ()
返回 (拼音)

.子程序 _图书信息_被单击, 空白型, , 
播放按钮声 ()
.如果真 (等于 (qj用户功能 [12], “否”))
    信息框 (“没有权限操作此功能,请与管理员联系”, #警告图标, “提示”)
    返回 ()
.如果真结束

.如果真 (是否已创建 (ck图书信息))
    返回 ()
.如果真结束
稍后开始 ()
载入 (ck图书信息, , 假)
MDI配置 (ck图书信息, ck主窗口., ck图书信息.取窗口句柄 (), 主句柄)
赋值 (ck图书信息., 真)
稍后结束 ()


.子程序 _新书入库t_被选择, 空白型, , 
_新书入库_被单击 ()


.子程序 _租借业务t_被选择, 空白型, , 
_租借管理_被单击 ()


.子程序 _会员登记t_被选择, 空白型, , 
_会员登记_被单击 ()


.子程序 _会员挂失t_被选择, 空白型, , 
_会员挂失_被单击 ()


.子程序 _会员充值t_被选择, 空白型, , 
_会员充值_被单击 ()


.子程序 _会员退款t_被选择, 空白型, , 
_会员退款_被单击 ()


.子程序 _书籍管理t_被选择, 空白型, , 
_书籍管理_被单击 ()


.子程序 _会员管理t_被选择, 空白型, , 
_会员管理_被单击 ()


.子程序 _租借列表t_被选择, 空白型, , 
_租借列表_被单击 ()


.子程序 _利润统计t_被选择, 空白型, , 
_利润统计_被单击 ()


.子程序 _账簿清算t_被选择, 空白型, , 
_账簿清算_被单击 ()


.子程序 _书籍分类_被单击, 空白型, , 
播放按钮声 ()
.如果真 (等于 (qj用户功能 [14], “否”))
    信息框 (“没有权限操作此功能,请与管理员联系”, #警告图标, “提示”)
    返回 ()
.如果真结束
.如果真 (是否已创建 (ck书籍分类))
    返回 ()
.如果真结束
稍后开始 ()
载入 (ck书籍分类, , 假)
MDI配置 (ck书籍分类, ck主窗口., ck书籍分类.取窗口句柄 (), 主句柄)
赋值 (ck书籍分类., 真)
稍后结束 ()


.子程序 _会员分类_被单击, 空白型, , 
播放按钮声 ()
.如果真 (等于 (qj用户功能 [15], “否”))
    信息框 (“没有权限操作此功能,请与管理员联系”, #警告图标, “提示”)
    返回 ()
.如果真结束

.如果真 (是否已创建 (ck会员分类))
    返回 ()
.如果真结束
稍后开始 ()
载入 (ck会员分类, , 假)
MDI配置 (ck会员分类, ck主窗口., ck会员分类.取窗口句柄 (), 主句柄)
赋值 (ck会员分类., 真)
稍后结束 ()


.子程序 _用户分类_被单击, 空白型, , 
播放按钮声 ()
.如果真 (等于 (qj用户功能 [16], “否”))
    信息框 (“没有权限操作此功能,请与管理员联系”, #警告图标, “提示”)
    返回 ()
.如果真结束

.如果真 (是否已创建 (ck用户分类))
    返回 ()
.如果真结束
稍后开始 ()
载入 (ck用户分类, , 假)
MDI配置 (ck用户分类, ck主窗口., ck用户分类.取窗口句柄 (), 主句柄)
赋值 (ck用户分类., 真)
稍后结束 ()


.子程序 _修改密码_被单击, 空白型, , 
播放按钮声 ()
.如果真 (等于 (qj用户功能 [17], “否”))
    信息框 (“没有权限操作此功能,请与管理员联系”, #警告图标, “提示”)
    返回 ()
.如果真结束
.如果真 (是否已创建 (ck修改密码))
    返回 ()
.如果真结束
稍后开始 ()
载入 (ck修改密码, , 假)
MDI配置 (ck修改密码, ck主窗口., ck修改密码.取窗口句柄 (), 主句柄)
赋值 (ck修改密码., 真)
稍后结束 ()


.子程序 _数据备份_被单击, 空白型, , 
播放按钮声 ()
.如果真 (等于 (qj用户功能 [18], “否”))
    信息框 (“没有权限操作此功能,请与管理员联系”, #警告图标, “提示”)
    返回 ()
.如果真结束
.如果真 (是否已创建 (ck数据备份))
    返回 ()
.如果真结束
稍后开始 ()
载入 (ck数据备份, , 假)
MDI配置 (ck数据备份, ck主窗口., ck数据备份.取窗口句柄 (), 主句柄)
赋值 (ck数据备份., 真)
稍后结束 ()


.子程序 _后台配置_被单击, 空白型, , 
播放按钮声 ()
.如果真 (等于 (qj用户功能 [19], “否”))
    信息框 (“没有权限操作此功能,请与管理员联系”, #警告图标, “提示”)
    返回 ()
.如果真结束
.如果真 (是否已创建 (ck后台配置))
    返回 ()
.如果真结束
稍后开始 ()
载入 (ck后台配置, , 假)
MDI配置 (ck后台配置, ck主窗口., ck后台配置.取窗口句柄 (), 主句柄)
赋值 (ck后台配置., 真)
稍后结束 ()


.子程序 _月度信息_被单击, 空白型, , 
播放按钮声 ()
.如果真 (等于 (qj用户功能 [13], “否”))
    信息框 (“没有权限操作此功能,请与管理员联系”, #警告图标, “提示”)
    返回 ()
.如果真结束
.如果真 (是否已创建 (ck月度信息))
    返回 ()
.如果真结束
稍后开始 ()
载入 (ck月度信息, , 假)
MDI配置 (ck月度信息, ck主窗口., ck月度信息.取窗口句柄 (), 主句柄)
赋值 (ck月度信息., 真)
稍后结束 ()


.子程序 _电子表显示器_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

运行 (“rundll32.exe   shell32.dll,Control_RunDLL   timedate.cpl,,0 ”, 假, )


.子程序 _图书信息t_被选择, 空白型, , 
_图书信息_被单击 ()


.子程序 _月度信息t_被选择, 空白型, , 
_月度信息_被单击 ()

.子程序 _书籍分类t_被选择, 空白型, , 
_书籍分类_被单击 ()


.子程序 _会员分类t_被选择, 空白型, , 
_会员分类_被单击 ()


.子程序 _用户分类t_被选择, 空白型, , 
_用户分类_被单击 ()


.子程序 _修改密码t_被选择, 空白型, , 
_修改密码_被单击 ()

.子程序 _数据备份t_被选择, 空白型, , 
_数据备份_被单击 ()


.子程序 _后台配置t_被选择, 空白型, , 
_后台配置_被单击 ()


.子程序 _系统信息_被选择, 空白型, , 
.如果真 (等于 (是否已创建 (ck系统信息), 假))
    载入 (ck系统信息, ck主窗口, 真)
.如果真结束


.子程序 不满13位编码补位, 文本型, , 
.参数 temp文本, 文本型, , 

.如果真 (并且 (大于 (取文本长度 (删全部空 (temp文本)), 0), 小于 (取文本长度 (删全部空 (temp文本)), 13)))
    返回 (相加 (取重复文本 (相减 (13, 取文本长度 (删全部空 (temp文本))), “0”), 删全部空 (temp文本)))
.如果真结束
返回 (删全部空 (temp文本))


.子程序 _计算器_被单击, 空白型, , 
运行 (相加 (取运行目录 (), “\calc.exe”), 假, )


.子程序 _暂时离开_被单击, 空白型, , 
.如果真 (等于 (是否已创建 (ck暂时离开), 假))
    载入 (ck暂时离开, ck主窗口, 真)
.如果真结束


.窗口程序集 新书入库窗口程序集, , , 

.程序集变量 通过检测, 逻辑型, , , 
.程序集变量 条形码存在, 逻辑型, , , 
.程序集变量 等待输入数量, 逻辑型, , , 
.子程序 _ck新书入库_创建完毕, 空白型, , 
.局部变量 temp, 文本型, , , 

获取焦点 ()
数据库连接器.未知支持库函数_12 ()
“select 图书类型名称 from 图书类型表”.未知支持库函数_14 (#)
清空 ()
未知支持库函数_34 ()
.计次循环首 (., )
    0.未知支持库函数_26 (temp)
    temp.加入项目 ()
    未知支持库函数_36 ()
.计次循环尾 ()
未知支持库函数_16 ()
“->正常启动”.滚动写行 ()


.子程序 控件定位, 空白型, , 
赋值 (.左边, 相除 (相减 (ck新书入库.取用户区宽度 (), .宽度), 3))
赋值 (.顶边, 相除 (相减 (ck新书入库.取用户区高度 (), .高度), 2))
赋值 (.左边, 相除 (相减 (ck新书入库.取用户区宽度 (), .宽度), 3))
赋值 (.顶边, 相除 (相减 (ck新书入库.取用户区高度 (), .高度), 2))

0.移动 (0, ck新书入库.取用户区宽度 (), ck新书入库.取用户区高度 ())

.子程序 _ck新书入库_尺寸被改变, 空白型, , 
控件定位 ()


.子程序 _确认_被单击, 空白型, , 
.局部变量 用户选择, 整数型, , , 
.局部变量 temp文本, 文本型, , , 
.局部变量 temp整数, 整数型, , , 
.局部变量 temp小数, 双精度小数型, , , 
.局部变量 temp日期, 日期时间型, , , 
.局部变量 i, 整数型, , , 

.如果真 (等于 (时间正常, 假))
    信息框 (“时间处于异常状态,操作中断”, #警告图标, “警报”)
    返回 ()
.如果真结束

播放按钮声 ()
稍后开始 ()
.如果真 (等于 (等待输入数量, 真))
    .如果 (不等于 (删全部空 (.内容), “”))
        .如果 (相加 (“update 图书表 set 拥有数量=拥有数量+”, .内容, “ where 条形码='”, .内容, “' and 图书名称='”, .内容, “'”).未知支持库函数_14 (#))
            相加 (“->记录数量成功更新 ”, .内容, “ ”, .内容).滚动写行 ()
            _取消_被单击 ()
            稍后结束 ()
            返回 ()
        .否则
            “->数量更新失败,请重新尝试”.滚动写行 ()
        .如果结束
        稍后结束 ()
        返回 ()
    .否则
        信息框 (“[进货本数] 不能不填”, 64, “提示”)
        获取焦点 ()
        稍后结束 ()
        返回 ()
    .如果结束
    
.如果真结束


赋值 (通过检测, 真)
.如果真 (小于 (取文本长度 (删全部空 (.内容)), qj条形码长度))
    信息框 (“[条形码]不能不填或少于6位数”, 64, “提示”)
    稍后结束 ()
    获取焦点 ()
    返回 ()
.如果真结束



.如果真 (等于 (条形码存在, 假))
    .如果真 (大于 (., 0))
        赋值 (条形码存在, 真)
         ' 清空图片框2的内容
        未知函数_516 () ' *** 缩略程序块 ***
        全部删除 ()
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        .计次循环首 (., i)
             ' 插入表项
            .插入表项 ()
            “条形码”.未知支持库函数_26 (temp文本)
            相减 (i, 1).置标题 (0, temp文本)
            “入库日期”.未知支持库函数_31 (temp日期)
            相减 (i, 1).置标题 (1, 到文本 (temp日期))
            “图书名称”.未知支持库函数_26 (temp文本)
            相减 (i, 1).置标题 (2, temp文本)
            “书名拼音”.未知支持库函数_26 (temp文本)
            相减 (i, 1).置标题 (3, temp文本)
            “类型”.未知支持库函数_26 (temp文本)
            相减 (i, 1).置标题 (4, temp文本)
            “作者”.未知支持库函数_26 (temp文本)
            相减 (i, 1).置标题 (5, temp文本)
            “出版社”.未知支持库函数_26 (temp文本)
            相减 (i, 1).置标题 (6, temp文本)
            “定价”.未知支持库函数_27 (temp小数)
            相减 (i, 1).置标题 (7, 到文本 (temp小数))
            “进货价”.未知支持库函数_27 (temp小数)
            相减 (i, 1).置标题 (8, 到文本 (temp小数))
            “印刷版本”.未知支持库函数_26 (temp文本)
            相减 (i, 1).置标题 (9, temp文本)
            “备注”.未知支持库函数_26 (temp文本)
            相减 (i, 1).置标题 (10, temp文本)
            “拥有数量”.未知支持库函数_29 (temp整数)
            相减 (i, 1).置标题 (11, 到文本 (temp整数))
            未知支持库函数_36 ()
        .计次循环尾 ()
    .如果真结束
    
.如果真结束

未知支持库函数_16 ()
.判断开始 (等于 (条形码存在, 真))
    赋值 (等待输入数量, 真)
    获取焦点 ()
    稍后结束 ()
    返回 ()
.默认
    .如果真 (小于 (取文本长度 (删全部空 (.内容)), qj条形码长度))
        信息框 (“[条形码] 不能不填或少于3位数”, 64, “提示”)
        赋值 (通过检测, 假)
    .如果真结束
    .如果真 (等于 (删全部空 (.内容), “”))
        信息框 (“[书籍名称] 不能不填”, 64, “提示”)
        赋值 (通过检测, 假)
    .如果真结束
    .如果真 (等于 (.现行选中项, -1))
        信息框 (“请选择 [书籍类型]”, 64, “提示”)
        赋值 (通过检测, 假)
    .如果真结束
    .如果真 (等于 (删全部空 (.内容), “”))
        信息框 (“[本书定价] 不能不填”, 64, “提示”)
        赋值 (通过检测, 假)
    .如果真结束
    .如果真 (等于 (删全部空 (.内容), “”))
        信息框 (“[进货价] 不能不填”, 64, “提示”)
        赋值 (通过检测, 假)
    .如果真结束
    .如果真 (等于 (删全部空 (.内容), “”))
        信息框 (“[进货本数] 不能不填”, 64, “提示”)
        赋值 (通过检测, 假)
    .如果真结束
    .如果 (通过检测)
        .如果 (相加 (“insert into 图书表(条形码,入库日期,图书名称,书名拼音,类型,作者,出版社,定价,进货价,印刷版本,备注,拥有数量) values('”, .内容, “',#”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天)), “#,'”, .内容, “','”, .内容, “','”, .取项目文本 (.现行选中项), “','”, .内容, “','”, .内容, “',”, .内容, “,”, .内容, “,'”, .内容, “','”, .内容, “',”, .内容, “)”).未知支持库函数_14 (#))
            相加 (“->新记录成功加入 ”, .内容, “ ”, .内容).滚动写行 ()
            _取消_被单击 ()
        .否则
            “->加入失败,请重新尝试”.滚动写行 ()
        .如果结束
        
    .否则
        “->填写的数据不完整,请确认完整填”.滚动写行 ()
    .如果结束
    
.判断结束
未知支持库函数_16 ()
稍后结束 ()

.子程序 _入库日期_选择日期被改变, 空白型, , 
 ' ---- 消除残留图像-----
赋值 (.可视, 假)
赋值 (.可视, 真)
 ' ----------------------

.子程序 _ck新书入库_位置被改变, 空白型, , 
控件定位 ()


.子程序 _取消_被单击, 空白型, , 
播放按钮声 ()
 ' 清空内容
未知函数_508 () ' *** 缩略程序块 ***
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.今天, 取现行时间 ())
赋值 (.现行选中项, -1)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
 ' 图片框1所有控件禁止
未知函数_418 () ' *** 缩略程序块 ***
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (等待输入数量, 假)
赋值 (条形码存在, 假)
获取焦点 ()

.子程序 _书籍名称_内容被改变, 空白型, , 
赋值 (.内容, 取首拼 ())


.子程序 _条形码_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)

.子程序 _书籍名称_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)

.子程序 _作者名称_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)

.子程序 _出版社名称_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)

.子程序 _印刷版本_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)

.子程序 _本书定价_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)

.子程序 _进货价_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)

.子程序 _进货本数_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)

.子程序 _条形码_失去焦点, 空白型, , 
.局部变量 temp文本, 文本型, , , 
.局部变量 temp整数, 整数型, , , 
.局部变量 temp小数, 双精度小数型, , , 
.局部变量 temp日期, 日期时间型, , , 
.局部变量 i, 整数型, , , 

赋值 (.背景颜色, #白色)
赋值 (.内容, 不满13位编码补位 (.内容))
.如果真 (不等于 (删全部空 (.内容), “”))
    .如果真 (大于或等于 (取文本长度 (.内容), qj条形码长度))
        稍后开始 ()
        .如果 (等于 (相加 (“select * from 图书表 where 条形码='”, .内容, “'”).未知支持库函数_14 (#), 假))
            “->检测器出现错误,操作中断,错误代码:111,请与开发者联系”.滚动写行 ()
            未知支持库函数_16 ()
            返回 ()
        .否则
            .如果真 (大于 (., 0))
                赋值 (条形码存在, 真)
                 ' 清空内容
                未知函数_592 () ' *** 缩略程序块 ***
                赋值 (.可视, 假)
                赋值 (.可视, 真)
                全部删除 ()
                赋值 (.内容, “”)
                赋值 (.内容, “”)
                赋值 (.内容, “”)
                赋值 (.内容, “”)
                赋值 (.内容, “”)
                赋值 (.内容, “”)
                赋值 (.内容, “”)
                赋值 (.内容, “”)
                赋值 (.内容, “”)
                赋值 (.内容, “”)
                赋值 (.内容, “”)
                赋值 (.内容, “”)
                .计次循环首 (., i)
                     ' 插入表项
                    .插入表项 ()
                    “条形码”.未知支持库函数_26 (temp文本)
                    相减 (i, 1).置标题 (0, temp文本)
                    “入库日期”.未知支持库函数_31 (temp日期)
                    相减 (i, 1).置标题 (1, 到文本 (temp日期))
                    “图书名称”.未知支持库函数_26 (temp文本)
                    相减 (i, 1).置标题 (2, temp文本)
                    “书名拼音”.未知支持库函数_26 (temp文本)
                    相减 (i, 1).置标题 (3, temp文本)
                    “类型”.未知支持库函数_26 (temp文本)
                    相减 (i, 1).置标题 (4, temp文本)
                    “作者”.未知支持库函数_26 (temp文本)
                    相减 (i, 1).置标题 (5, temp文本)
                    “出版社”.未知支持库函数_26 (temp文本)
                    相减 (i, 1).置标题 (6, temp文本)
                    “定价”.未知支持库函数_27 (temp小数)
                    相减 (i, 1).置标题 (7, 到文本 (temp小数))
                    “进货价”.未知支持库函数_27 (temp小数)
                    相减 (i, 1).置标题 (8, 到文本 (temp小数))
                    “印刷版本”.未知支持库函数_26 (temp文本)
                    相减 (i, 1).置标题 (9, temp文本)
                    “备注”.未知支持库函数_26 (temp文本)
                    相减 (i, 1).置标题 (10, temp文本)
                    “拥有数量”.未知支持库函数_29 (temp整数)
                    相减 (i, 1).置标题 (11, 到文本 (temp整数))
                    未知支持库函数_36 ()
                .计次循环尾 ()
                未知支持库函数_16 ()
                赋值 (., 0)
            .如果真结束
            
        .如果结束
        稍后结束 ()
        
    .如果真结束
    
.如果真结束




.子程序 _书籍名称_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)

.子程序 _作者名称_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)

.子程序 _出版社名称_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)

.子程序 _印刷版本_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)

.子程序 _本书定价_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)

.子程序 _进货价_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)

.子程序 _进货本数_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)

.子程序 _备注_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)

.子程序 _备注_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)

.子程序 _书名拼音_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)

.子程序 _书名拼音_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)

.子程序 _超级列表框1_当前表项被改变, 空白型, , 
赋值 (.内容, .取标题 (., 0))
赋值 (.内容, .取标题 (., 8))
赋值 (.内容, .取标题 (., 2))
赋值 (.内容, .取标题 (., 3))
赋值 (.内容, .取标题 (., 1))
赋值 (.内容, .取标题 (., 4))
赋值 (.内容, .取标题 (., 5))
赋值 (.内容, .取标题 (., 6))
赋值 (.内容, .取标题 (., 7))
赋值 (.内容, .取标题 (., 9))
赋值 (.内容, .取标题 (., 10))
赋值 (.内容, .取标题 (., 11))


.子程序 _是的_被单击, 空白型, , 
 ' 图片框1所有控件禁止
未知函数_418 () ' *** 缩略程序块 ***
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
 ' 图片框2的控件赋值给图片框1的控件
未知函数_610 () ' *** 缩略程序块 ***
赋值 (.内容, .内容)
赋值 (.内容, .内容)
赋值 (.内容, .内容)
赋值 (.内容, .内容)
赋值 (.今天, 到时间 (.内容))
.选择 (.内容)
赋值 (.内容, .内容)
赋值 (.内容, .内容)
赋值 (.内容, .内容)
赋值 (.内容, .内容)
赋值 (.内容, .内容)
赋值 (.内容, “”)
赋值 (.可视, 假)
赋值 (.可视, 真)
赋值 (等待输入数量, 真)
获取焦点 ()


.子程序 _不是_被单击, 空白型, , 
赋值 (.可视, 假)
赋值 (.可视, 真)
赋值 (条形码存在, 假)
获取焦点 ()


.窗口程序集 请稍候程序集, , , 

.程序集变量 temp间隔, 整数型, , , 
.子程序 _检测时钟_周期事件, 空白型, , 
.局部变量 文件号, 整数型, , , 
.局部变量 temp, 日期时间型, , , 

.如果真 (等于 (已经进行过赋值, 假))
    赋值 (temp间隔, 运行时备份间隔)
    赋值 (已经进行过赋值, 真)
.如果真结束
赋值 (时间正常, 真)
赋值 (文件号, 打开文件 (qj检查时间路径, , ))
赋值 (temp, 到时间 (读入一行 (文件号)))
.如果 (或者 (小于 (取时间间隔 (取现行时间 (), temp, #分钟), -20), 大于 (取时间间隔 (取现行时间 (), temp, #分钟), 20)))
    赋值 (时间正常, 假)
    赋值 (ck主窗口..可视, 真)
    播放音乐 (#ringout, )
.否则
    赋值 (时间正常, 真)
    赋值 (ck主窗口..可视, 假)
.如果结束
.如果真 (时间正常)
    移到文件首 (文件号)
    写文本行 (文件号, 到文本 (取现行时间 ()))
.如果真结束
关闭文件 (文件号)
赋值 (.文本颜色, 取颜色值 (取随机数 (1, 255), 取随机数 (1, 255), 取随机数 (1, 255)))
.如果真 (运行时备份)
    .如果真 (小于或等于 (运行时备份间隔, 0))
        复制文件 (qj数据库路径, 相加 (取运行目录 (), “\auto_backup\运行中自动备份的数据”))
        赋值 (运行时备份间隔, temp间隔)
    .如果真结束
    赋值 (运行时备份间隔, 相减 (运行时备份间隔, 1000))
.如果真结束
.如果真 (等于 (是否已创建 (ck主窗口), 假))
    .如果真 (关闭时备份)
        赋值 (temp, 取现行时间 ())
        复制文件 (qj数据库路径, 相加 (取运行目录 (), “\auto_backup\关闭时自动备份的数据”))
    .如果真结束
    结束 ()
.如果真结束


.窗口程序集 会员登记程序集, , , 

.子程序 控件定位, 空白型, , 
赋值 (.左边, 相除 (相减 (ck会员登记.取用户区宽度 (), .宽度), 3))
赋值 (.顶边, 相除 (相减 (ck会员登记.取用户区高度 (), .高度), 2))
0.移动 (0, ck会员登记.取用户区宽度 (), ck会员登记.取用户区高度 ())


.子程序 _ck会员登记_尺寸被改变, 空白型, , 
控件定位 ()


.子程序 _确认_被单击, 空白型, , 
.局部变量 通过检测, 逻辑型, , , 

.如果真 (等于 (时间正常, 假))
    信息框 (“时间处于异常状态,操作中断”, #警告图标, “警报”)
    返回 ()
.如果真结束
播放按钮声 ()
稍后开始 ()
赋值 (通过检测, 真)
.如果真 (小于 (取文本长度 (删全部空 (.内容)), qj会员编号长度))
    信息框 (“[会员编号] 不能不填或少于3位数”, #信息图标, “提示”)
    赋值 (通过检测, 假)
.如果真结束
.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“[会员姓名] 不能不填”, #信息图标, “提示”)
    赋值 (通过检测, 假)
.如果真结束
.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“[自定密码] 不能不填”, #信息图标, “提示”)
    赋值 (通过检测, 假)
.如果真结束
.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“[重复密码] 不能不填”, #信息图标, “提示”)
    赋值 (通过检测, 假)
.如果真结束
.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“[联系地址] 不能不填”, #信息图标, “提示”)
    赋值 (通过检测, 假)
.如果真结束
.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“[联系电话] 不能不填”, #信息图标, “提示”)
    赋值 (通过检测, 假)
.如果真结束
.如果真 (等于 (.现行选中项, -1))
    信息框 (“请选择 [会员类型] ”, #信息图标, “提示”)
    赋值 (通过检测, 假)
.如果真结束
.如果真 (等于 (.现行选中项, -1))
    信息框 (“请选择 [性别]”, #信息图标, “提示”)
    赋值 (通过检测, 假)
.如果真结束
.如果真 (不等于 (.内容, .内容))
    信息框 (“两次录入的密码不一致”, #信息图标, “提示”)
    赋值 (通过检测, 假)
.如果真结束

.如果 (通过检测)
    数据库连接器.未知支持库函数_12 ()
    相加 (“select 会员编号 from 会员表 where 会员编号='”, .内容, “'”).未知支持库函数_14 (#)
    .如果真 (大于 (., 0))
        信息框 (“该[会员编号]已经被使用,请输入另一个”, #信息图标, “提示”)
        未知支持库函数_16 ()
        稍后结束 ()
        赋值 (.可视, 假)
        赋值 (.可视, 真)
        返回 ()
    .如果真结束
    未知支持库函数_16 ()
    .如果 (相加 (“insert into 会员表(会员编号,登记日期,会员姓名,姓名拼音,性别,联系电话,有效证件,联系地址,会员类型) values('”, .内容, “',#”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天)), “#,'”, .内容, “','”, .内容, “','”, .取项目文本 (.现行选中项), “','”, .内容, “','”, .内容, “','”, .内容, “','”, .取项目文本 (.现行选中项), “')”).未知支持库函数_14 (#))
        相加 (“->新记录成功加入 ”, .内容, “ ”, .内容).滚动写行 ()
        _取消_被单击 ()
    .否则
        “->加入失败,请重新尝试”.滚动写行 ()
    .如果结束
    未知支持库函数_16 ()
.否则
    “->填写的数据不完整,请确认完整填”.滚动写行 ()
.如果结束
稍后结束 ()


.子程序 _登记日期_选择日期被改变, 空白型, , 
 ' ---- 消除残留图像-----
赋值 (.可视, 假)
赋值 (.可视, 真)
 ' ----------------------

.子程序 _ck会员登记_位置被改变, 空白型, , 
控件定位 ()


.子程序 _取消_被单击, 空白型, , 
播放按钮声 ()
 ' 清空内容
未知函数_429 () ' *** 缩略程序块 ***
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.今天, 取现行时间 ())
赋值 (.现行选中项, -1)
赋值 (.现行选中项, -1)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)

.子程序 _ck会员登记_创建完毕, 空白型, , 
.局部变量 temp, 文本型, , , 

获取焦点 ()
数据库连接器.未知支持库函数_12 ()
“select 会员类型名称 from 会员类型表”.未知支持库函数_14 (#)
清空 ()
未知支持库函数_34 ()
.计次循环首 (., )
    0.未知支持库函数_26 (temp)
    temp.加入项目 ()
    未知支持库函数_36 ()
.计次循环尾 ()
未知支持库函数_16 ()
“->正常启动”.滚动写行 ()

.子程序 _会员编号_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _会员编号_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)
赋值 (.内容, 不满13位编码补位 (.内容))
.如果真 (大于或等于 (取文本长度 (删全部空 (.内容)), qj会员编号长度))
    数据库连接器.未知支持库函数_12 ()
    相加 (“select 会员编号 from 会员表 where 会员编号='”, .内容, “'”).未知支持库函数_14 (#)
    .如果真 (大于 (., 0))
        信息框 (“该[会员编号]已经被使用,请输入另一个”, #信息图标, “提示”)
        赋值 (.可视, 假)
        赋值 (.可视, 真)
    .如果真结束
    未知支持库函数_16 ()
    返回 ()
.如果真结束


.子程序 _会员姓名_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)

.子程序 _有效证件_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _联系电话_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)

.子程序 _联系地址_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)

.子程序 _有效证件_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)

.子程序 _联系电话_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)

.子程序 _联系地址_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)

.子程序 _会员姓名_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)

.子程序 _会员姓名_内容被改变, 空白型, , 
赋值 (.内容, 取首拼 ())


.窗口程序集 会员充值程序集, , , 

.程序集变量 已经找到, 逻辑型, , , 
.子程序 _ck会员充值_创建完毕, 空白型, , 
“->正常启动”.滚动写行 ()
赋值 (.禁止, 假)
获取焦点 ()
赋值 (已经找到, 假)

.子程序 控件定位, 空白型, , 
赋值 (.左边, 相除 (相减 (ck会员充值.取用户区宽度 (), .宽度), 3))
赋值 (.顶边, 相除 (相减 (ck会员充值.取用户区高度 (), .高度), 2))
0.移动 (0, ck会员充值.取用户区宽度 (), ck会员充值.取用户区高度 ())

.子程序 _ck会员充值_尺寸被改变, 空白型, , 
控件定位 ()

.子程序 _确认_被单击, 空白型, , 
.局部变量 temp小数, 双精度小数型, , , 

播放按钮声 ()
.如果真 (已经找到)
    .如果真 (大于 (取文本长度 (.内容), 0))
        .如果 (等于 (.内容, .内容))
            数据库连接器.未知支持库函数_12 ()
            .如果 (相加 (“update 会员表 set 帐户金额=帐户金额+”, .内容, “ where 会员编号='”, .内容, “'”).未知支持库函数_14 (#))
                未知支持库函数_16 ()
                数据库连接器.未知支持库函数_12 ()
                .如果 (相加 (“select 帐户金额 from 会员表 where 会员编号='”, .内容, “'”).未知支持库函数_14 (#))
                    .如果真 (大于 (., 0))
                        “帐户金额”.未知支持库函数_27 (temp小数)
                        相加 (“->充值成功 当期余额:”, 到文本 (四舍五入 (temp小数, 2))).滚动写行 ()
                        _取消_被单击 ()
                    .如果真结束
                    
                .否则
                    “->充值后读取失败”.滚动写行 ()
                .如果结束
                
            .否则
                “->充值失败,操作中断”.滚动写行 ()
            .如果结束
            未知支持库函数_16 ()
        .否则
            信息框 (“两次输入的金额不一致,请重新输入”, #警告图标, “操作错误”)
            赋值 (.内容, “”)
            赋值 (.内容, “”)
        .如果结束
        
    .如果真结束
    
.如果真结束
稍后结束 ()

.子程序 _ck会员充值_位置被改变, 空白型, , 
控件定位 ()

.子程序 _取消_被单击, 空白型, , 
播放按钮声 ()
赋值 (.禁止, 假)
赋值 (已经找到, 假)
 ' 清空内容
未知函数_493 () ' *** 缩略程序块 ***
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.标题, “0”)

.子程序 _会员编号_失去焦点, 空白型, , 
.局部变量 temp文本, 文本型, , , 
.局部变量 temp整数, 整数型, , , 
.局部变量 temp小数, 双精度小数型, , , 
.局部变量 temp日期, 日期时间型, , , 

赋值 (.背景颜色, #白色)
赋值 (.内容, 不满13位编码补位 (.内容))
.如果真 (大于或等于 (取文本长度 (删全部空 (.内容)), qj会员编号长度))
    稍后开始 ()
    数据库连接器.未知支持库函数_12 ()
    .如果 (相加 (“select * from 会员表 where 会员编号='”, .内容, “' and 会员状态='正常'”).未知支持库函数_14 (#))
        .如果真 (大于 (., 0))
             ' 读取内容
            未知函数_845 () ' *** 缩略程序块 ***
            “会员姓名”.未知支持库函数_26 (temp文本)
            赋值 (.内容, temp文本)
            “性别”.未知支持库函数_26 (temp文本)
            赋值 (.内容, temp文本)
            “联系电话”.未知支持库函数_26 (temp文本)
            赋值 (.内容, temp文本)
            “联系地址”.未知支持库函数_26 (temp文本)
            赋值 (.内容, temp文本)
            “会员类型”.未知支持库函数_26 (temp文本)
            赋值 (.内容, temp文本)
            “有效证件”.未知支持库函数_26 (temp文本)
            赋值 (.内容, temp文本)
            “姓名拼音”.未知支持库函数_26 (temp文本)
            赋值 (.内容, temp文本)
            “登记日期”.未知支持库函数_31 (temp日期)
            赋值 (.内容, 到文本 (temp日期))
            “帐户金额”.未知支持库函数_27 (temp小数)
            赋值 (.标题, 到文本 (四舍五入 (temp小数, 2)))
            赋值 (已经找到, 真)
        .如果真结束
        
    .否则
        “->读取失败,操作中断”.滚动写行 ()
        赋值 (已经找到, 假)
    .如果结束
    未知支持库函数_16 ()
    稍后结束 ()
.如果真结束

.如果 (已经找到)
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
.如果结束




.子程序 _会员编号_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _充值金额_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _充值金额_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)


.子程序 _再次输入_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)

.子程序 _再次输入_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)


.窗口程序集 租借管理程序集, , , 

.程序集变量 控制器锁定, 逻辑型, , , '暂时无用
.程序集变量 锁定会员, 逻辑型, , , 
.程序集变量 锁定图书, 逻辑型, , , 
.程序集变量 高级表格当前行号, 整数型, , , 
.程序集变量 高级表格序号, 整数型, , , 
.程序集变量 会员类型租金率, 双精度小数型, , , 
.程序集变量 图书类型租金, 双精度小数型, , , 
.程序集变量 cxj图书自动编号, 整数型, , "0", 
.程序集变量 cxj会员编号, 文本型, , "0", 
.程序集变量 cxj会员姓名, 文本型, , "0", 
.程序集变量 cxj条形码, 文本型, , "0", 
.程序集变量 cxj图书名称, 文本型, , "0", 
.程序集变量 cxj本书押金, 文本型, , "0", 
.程序集变量 cxj借书日期, 日期时间型, , "0", 
.程序集变量 cxj日租金, 文本型, , "0", 
.程序集变量 cxj合计租金, 双精度小数型, , "0", 
.程序集变量 temp还书计余额, 双精度小数型, , , 
.子程序 _ck租借管理_创建完毕, 空白型, , 
.未知支持库函数_20 (相加 (“光标在此处时,按下【Delete】键可以快速清空内容;”, #换行符, “当你使用键盘输入时,按下【End】键可以自动补齐不足13位的编号”), -1, , , , )
.未知支持库函数_20 (相加 (“光标在此处时,按下【Delete】键可以快速清空内容”, #换行符, “当你使用键盘输入时,按下【End】键可以自动补齐不足13位的编号”), -1, , , , )
初始化子程序 ()

.子程序 控件定位, 空白型, , 
赋值 (.左边, 相除 (相减 (ck租借管理.取用户区宽度 (), .宽度), 3))
赋值 (.顶边, 相除 (相减 (ck租借管理.取用户区高度 (), .高度), 2))
赋值 (.左边, 相除 (相减 (ck租借管理.取用户区宽度 (), .宽度), 3))
赋值 (.顶边, 相除 (相减 (ck租借管理.取用户区高度 (), .高度), 2))
赋值 (.左边, 相除 (相减 (ck租借管理.取用户区宽度 (), .宽度), 3))
赋值 (.顶边, 相除 (相减 (ck租借管理.取用户区高度 (), .高度), 2))
0.移动 (0, ck租借管理.取用户区宽度 (), ck租借管理.取用户区高度 ())

.子程序 _ck租借管理_尺寸被改变, 空白型, , 
控件定位 ()


.子程序 _完成_被单击, 空白型, , 
.局部变量 SQL语句, 文本型, , , 
.局部变量 i, 整数型, , , 
.局部变量 passed, 逻辑型, , , 

.如果真 (等于 (时间正常, 假))
    信息框 (“时间处于异常状态,操作中断”, #警告图标, “警报”)
    返回 ()
.如果真结束


播放按钮声 ()
.如果真 (小于 (高级表格当前行号, 2))
    返回 ()
.如果真结束

稍后开始 ()
赋值 (passed, 真)
.如果 (.选中)
    载入 (ck最后确认窗口, ck租借管理, 真)
    .如果真 (等于 (最后确认, 假))
        稍后结束 ()
        返回 ()
    .如果真结束
    
    .如果 (qj数据库路径.未知支持库函数_1 (qj数据库密码))
        .未知支持库函数_12 ()
        未知支持库函数_9 ()
        .计次循环首 (相减 (高级表格当前行号, 1), i)
            赋值 (SQL语句, 相加 (“insert into 租借表(会员编号,会员姓名,条形码,图书名称,本书押金,借书日期,日租金) values('”, cxj会员编号 [i], “','”, cxj会员姓名 [i], “','”, cxj条形码 [i], “','”, cxj图书名称 [i], “',”, cxj本书押金 [i], “,'”, 到文本 (cxj借书日期 [i]), “','”, cxj日租金 [i], “')”))
            .如果真 (等于 (SQL语句.未知支持库函数_14 (#), 假))
                赋值 (passed, 假)
            .如果真结束
            
        .计次循环尾 ()
        未知支持库函数_16 ()
        .计次循环首 (相减 (高级表格当前行号, 1), i)
            赋值 (SQL语句, 相加 (“update 会员表 set 帐户金额=帐户金额-”, 到文本 (cxj本书押金 [i]), “,借书本数=借书本数+1 where 会员编号='”, .内容, “'”))
            .如果真 (等于 (SQL语句.未知支持库函数_14 (#), 假))
                赋值 (passed, 假)
            .如果真结束
            
        .计次循环尾 ()
        未知支持库函数_16 ()
        
        .计次循环首 (相减 (高级表格当前行号, 1), i)
            赋值 (SQL语句, 相加 (“update 图书表 set 是否借出=是否借出+1,被借次数=被借次数+1 where 条形码='”, cxj条形码 [i], “' and 图书名称='”, cxj图书名称 [i], “'”))
            .如果真 (等于 (SQL语句.未知支持库函数_14 (#), 假))
                赋值 (passed, 假)
            .如果真结束
            
        .计次循环尾 ()
        
        .如果 (passed)
            未知支持库函数_10 ()
            未知支持库函数_16 ()
            初始化子程序 ()
        .否则
            未知支持库函数_11 ()
            未知支持库函数_16 ()
            信息框 (“系统错误,业务失败,交易作废,请重新尝试!”, #错误图标, “错误”)
            初始化子程序 ()
        .如果结束
        
    .否则
        信息框 (“数据库连接失败,操作中断”, #错误图标, “错误”)
    .如果结束
    
.否则
    .如果真 (.选中)
        .如果 (qj数据库路径.未知支持库函数_1 (qj数据库密码))
            .未知支持库函数_12 ()
            未知支持库函数_9 ()
            .计次循环首 (相减 (高级表格当前行号, 1), i)
                赋值 (SQL语句, 相加 (“update 租借表 set 是否归还='是',合计租金=”, 到文本 (cxj合计租金 [i]), “ where 会员编号='”, .内容, “' and 条形码='”, cxj条形码 [i], “' and 自动编号=”, 到文本 (cxj图书自动编号 [i])))
                .如果真 (等于 (SQL语句.未知支持库函数_14 (#), 假))
                    赋值 (passed, 假)
                .如果真结束
                
            .计次循环尾 ()
            未知支持库函数_16 ()
            
            .计次循环首 (相减 (高级表格当前行号, 1), i)
                赋值 (SQL语句, 相加 (“update 会员表 set 帐户金额=帐户金额+”, 到文本 (cxj本书押金 [i]), “ where 会员编号='”, .内容, “'”))
                .如果真 (等于 (SQL语句.未知支持库函数_14 (#), 假))
                    赋值 (passed, 假)
                .如果真结束
                
            .计次循环尾 ()
            未知支持库函数_16 ()
            
            .计次循环首 (相减 (高级表格当前行号, 1), i)
                赋值 (SQL语句, 相加 (“update 会员表 set 帐户金额=帐户金额-”, 到文本 (cxj合计租金 [i]), “ where 会员编号='”, .内容, “'”))
                .如果真 (等于 (SQL语句.未知支持库函数_14 (#), 假))
                    赋值 (passed, 假)
                .如果真结束
                
            .计次循环尾 ()
            未知支持库函数_16 ()
            .计次循环首 (相减 (高级表格当前行号, 1), i)
                赋值 (SQL语句, 相加 (“update 图书表 set 是否借出=是否借出-1 where 条形码='”, cxj条形码 [i], “' and 图书名称='”, cxj图书名称 [i], “'”))
                .如果真 (等于 (SQL语句.未知支持库函数_14 (#), 假))
                    赋值 (passed, 假)
                .如果真结束
                
            .计次循环尾 ()
            
            .如果 (passed)
                未知支持库函数_10 ()
                未知支持库函数_16 ()
                相加 (“select 帐户金额 from 会员表 where 会员编号='”, .内容, “'”).未知支持库函数_14 (#)
                “帐户金额”.未知支持库函数_27 (temp还书计余额)
                未知支持库函数_16 ()
                信息框 (相加 (“该次还书业务顺利完成!”, #换行符, “  帐户金额 ： ”, 到文本 (temp还书计余额)), #信息图标, “完成”)
                初始化子程序 ()
            .否则
                未知支持库函数_11 ()
                未知支持库函数_16 ()
                信息框 (“系统出错,业务失败,请重新尝试!”, #错误图标, “错误”)
                初始化子程序 ()
            .如果结束
            
        .否则
            信息框 (“数据库连接失败,操作中断”, #错误图标, “错误”)
        .如果结束
        
    .如果真结束
    
.如果结束

未知支持库函数_3 ()
稍后结束 ()

.子程序 _ck租借管理_位置被改变, 空白型, , 
控件定位 ()

.子程序 _放弃_被单击, 空白型, , 
播放按钮声 ()
.如果真 (等于 (信息框 (“确认要完全放弃本次交易,进入新交易待命？”, 相加 (#确认取消钮, #询问图标), “询问”), #确认钮))
    初始化子程序 ()
.如果真结束


.子程序 初始化子程序, 空白型, , 
 ' 清空所有编辑框
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.标题, “0”)
赋值 (.标题, “0”)
全部删除 ()
赋值 (.可视, 假)
全部删除 ()
赋值 (.可视, 假)
赋值 (.可视, 真)
赋值 (锁定图书, 假)
赋值 (锁定会员, 假)
赋值 (控制器锁定, 假)
赋值 (最后确认, 假)
.如果 (锁定会员)
    赋值 (.禁止, 真)
    赋值 (.禁止, 假)
    获取焦点 ()
.否则
    赋值 (.禁止, 假)
    赋值 (.禁止, 真)
    获取焦点 ()
.如果结束
 ' 清空数组
清除数组 (cxj条形码)
清除数组 (cxj日租金)
清除数组 (cxj会员编号)
清除数组 (cxj会员姓名)
清除数组 (cxj图书名称)
清除数组 (cxj本书押金)
清除数组 (cxj借书日期)
清除数组 (cxj图书自动编号)
清除数组 (cxj合计租金)
 ' 初始化借书高级表格
未知支持库函数_57 ()
赋值 (., 1)
0.未知支持库函数_9 (0, #., “序号”)
0.未知支持库函数_32 (30)
0.未知支持库函数_9 (1, #., “会员编号”)
1.未知支持库函数_32 (85)
0.未知支持库函数_9 (2, #., “会员姓名”)
2.未知支持库函数_32 (60)
0.未知支持库函数_9 (3, #., “条形码”)
3.未知支持库函数_32 (85)
0.未知支持库函数_9 (4, #., “图书名称”)
4.未知支持库函数_32 (120)
0.未知支持库函数_9 (5, #., “本书押金”)
5.未知支持库函数_32 (60)
0.未知支持库函数_9 (6, #., “借书日期”)
6.未知支持库函数_32 (100)
0.未知支持库函数_9 (7, #., “日租金”)
7.未知支持库函数_32 (45)
 ' 初始化还书高级表格
未知支持库函数_57 ()
赋值 (., 1)
0.未知支持库函数_9 (0, #., “序号”)
0.未知支持库函数_32 (30)
0.未知支持库函数_9 (1, #., “条形码”)
1.未知支持库函数_32 (85)
0.未知支持库函数_9 (2, #., “图书名称”)
2.未知支持库函数_32 (120)
0.未知支持库函数_9 (3, #., “借书日期”)
3.未知支持库函数_32 (180)
0.未知支持库函数_9 (4, #., “日租金”)
4.未知支持库函数_32 (45)
0.未知支持库函数_9 (5, #., “本书押金”)
5.未知支持库函数_32 (60)
0.未知支持库函数_9 (6, #., “合计租金”)
6.未知支持库函数_32 (60)
赋值 (高级表格当前行号, 1)
赋值 (高级表格序号, 1)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (ck租借管理..可视, 假)
赋值 (ck租借管理..可视, 真)


.子程序 _会员编号_内容被改变, 空白型, , 
.局部变量 SQL语句, 文本型, , , 
.局部变量 temp文本, 文本型, , , 
.局部变量 temp小数, 双精度小数型, , , 
.局部变量 temp整数, 整数型, , , 
.局部变量 temp日期, 日期时间型, , , 

.如果真 (大于或等于 (取文本长度 (删全部空 (.内容)), qj会员编号长度))
    .如果真 (.)
        未知支持库函数_3 ()
    .如果真结束
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    .如果 (.选中)
        赋值 (SQL语句, 相加 (“select * from 会员表 where 会员编号='”, .内容, “' and 会员状态='正常'”)) ' 用于借书
    .否则
        赋值 (SQL语句, 相加 (“select * from 会员表 where 会员编号='”, .内容, “'”)) ' 用于还书
    .如果结束
    qj数据库路径.未知支持库函数_1 (qj数据库密码)
    .未知支持库函数_12 ()
    .如果 (SQL语句.未知支持库函数_14 (#))
        .如果真 (大于 (., 0))
            “会员姓名”.未知支持库函数_26 (temp文本)
            赋值 (.内容, temp文本)
            “会员类型”.未知支持库函数_26 (temp文本)
            赋值 (.内容, temp文本)
            “有效证件”.未知支持库函数_26 (temp文本)
            赋值 (.内容, temp文本)
            “联系电话”.未知支持库函数_26 (temp文本)
            赋值 (.内容, temp文本)
            “联系地址”.未知支持库函数_26 (temp文本)
            赋值 (.内容, temp文本)
            “性别”.未知支持库函数_26 (temp文本)
            赋值 (.内容, temp文本)
            “登记日期”.未知支持库函数_31 (temp日期)
            赋值 (.内容, 到文本 (temp日期))
            “帐户金额”.未知支持库函数_27 (temp小数)
            赋值 (.内容, 到文本 (四舍五入 (temp小数, 2)))
            赋值 (锁定会员, 真)
        .如果真结束
        
    .否则
        信息框 (“连接会员错误”, #错误图标, “错误”)
    .如果结束
    未知支持库函数_16 ()
    .如果 (锁定会员)
        赋值 (.禁止, 假)
        获取焦点 ()
        赋值 (.禁止, 真)
        赋值 (SQL语句, 相加 (“select 会员类型租金率 from 会员类型表 where 会员类型名称='”, .内容, “'”))
        .如果 (SQL语句.未知支持库函数_14 (#))
            .如果真 (大于 (., 0))
                “会员类型租金率”.未知支持库函数_26 (temp文本)
                赋值 (会员类型租金率, 到数值 (temp文本))
            .如果真结束
            
        .否则
            信息框 (“连接会员类型错误”, #错误图标, “错误”)
        .如果结束
        未知支持库函数_16 ()
    .否则
        
    .如果结束
    
.如果真结束


.子程序 _条形码_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)
.如果 (锁定会员)
    赋值 (.禁止, 真)
    赋值 (.禁止, 假)
    获取焦点 ()
.否则
    赋值 (.禁止, 假)
    赋值 (.禁止, 真)
    获取焦点 ()
.如果结束


.子程序 _条形码_内容被改变, 空白型, , 
.局部变量 SQL语句, 文本型, , , 
.局部变量 temp文本, 文本型, , , 
.局部变量 temp小数, 双精度小数型, , , 
.局部变量 temp整数, 整数型, , , 
.局部变量 temp日期, 日期时间型, , , 
.局部变量 temp自动编号, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 押金临时存放, 双精度小数型, , , 
.局部变量 重复还书临时押金, 双精度小数型, , , 
.局部变量 重复还书临时借书日期, 文本型, , , 
.局部变量 重复还书临时日租金, 双精度小数型, , , 

.如果真 (大于或等于 (取文本长度 (删全部空 (.内容)), qj条形码长度))
    .如果真 (.)
        未知支持库函数_3 ()
    .如果真结束
    qj数据库路径.未知支持库函数_1 (qj数据库密码)
    .未知支持库函数_12 ()
    .如果 (.选中)
        赋值 (SQL语句, 相加 (“select * from 图书表 where 条形码='”, .内容, “'”))
        .如果 (SQL语句.未知支持库函数_14 (#))
            .如果真 (大于 (., 0))
                .如果 (等于 (., 1))
                    “自动编号”.未知支持库函数_29 (temp整数)
                    赋值 (temp自动编号, temp整数)
                    “图书名称”.未知支持库函数_26 (temp文本)
                    赋值 (.内容, temp文本)
                    “类型”.未知支持库函数_26 (temp文本)
                    赋值 (.内容, temp文本)
                    “入库日期”.未知支持库函数_31 (temp日期)
                    赋值 (.内容, 到文本 (temp日期))
                    “出版社”.未知支持库函数_26 (temp文本)
                    赋值 (.内容, temp文本)
                    “印刷版本”.未知支持库函数_26 (temp文本)
                    赋值 (.内容, temp文本)
                    “备注”.未知支持库函数_26 (temp文本)
                    赋值 (.内容, temp文本)
                    “定价”.未知支持库函数_27 (temp小数)
                    赋值 (.内容, 到文本 (temp小数))
                    赋值 (.内容, 到文本 (相乘 (temp小数, 押金折扣)))
                    赋值 (锁定图书, 真)
                    未知支持库函数_16 ()
                .否则
                    全部删除 ()
                    .计次循环首 (., i)
                         ' 插入表项
                        .插入表项 ()
                        “条形码”.未知支持库函数_26 (temp文本)
                        相减 (i, 1).置标题 (0, temp文本)
                        “入库日期”.未知支持库函数_31 (temp日期)
                        相减 (i, 1).置标题 (1, 到文本 (temp日期))
                        “图书名称”.未知支持库函数_26 (temp文本)
                        相减 (i, 1).置标题 (2, temp文本)
                        “类型”.未知支持库函数_26 (temp文本)
                        相减 (i, 1).置标题 (3, temp文本)
                        “出版社”.未知支持库函数_26 (temp文本)
                        相减 (i, 1).置标题 (4, temp文本)
                        “定价”.未知支持库函数_27 (temp小数)
                        相减 (i, 1).置标题 (5, 到文本 (temp小数))
                        相减 (i, 1).置标题 (6, 到文本 (相乘 (temp小数, 押金折扣)))
                        “印刷版本”.未知支持库函数_26 (temp文本)
                        相减 (i, 1).置标题 (7, temp文本)
                        “备注”.未知支持库函数_26 (temp文本)
                        相减 (i, 1).置标题 (8, temp文本)
                        未知支持库函数_36 ()
                    .计次循环尾 ()
                    赋值 (.可视, 假)
                    赋值 (.可视, 真)
                    赋值 (., 0)
                    未知支持库函数_16 ()
                .如果结束
                
            .如果真结束
            
        .否则
            信息框 (“连接错误”, #错误图标, “错误”)
        .如果结束
        
        .如果真 (锁定图书)
            赋值 (SQL语句, 相加 (“select 图书类型租金 from 图书类型表 where 图书类型名称='”, .内容, “'”))
            .如果 (SQL语句.未知支持库函数_14 (#))
                .如果真 (大于 (., 0))
                    “图书类型租金”.未知支持库函数_26 (temp文本)
                    赋值 (图书类型租金, 到数值 (temp文本))
                    赋值 (.内容, 到文本 (相乘 (图书类型租金, 会员类型租金率)))
                .如果真结束
                
            .否则
                信息框 (“连接图书类型错误”, #错误图标, “错误”)
            .如果结束
            
            赋值 (., 相加 (., 1))
            加入成员 (cxj图书自动编号, 到整数 (.内容))
            高级表格当前行号.未知支持库函数_9 (0, #., 到文本 (高级表格序号))
            加入成员 (cxj会员编号, .内容)
            高级表格当前行号.未知支持库函数_9 (1, #., .内容)
            加入成员 (cxj会员姓名, .内容)
            高级表格当前行号.未知支持库函数_9 (2, #., .内容)
            加入成员 (cxj条形码, .内容)
            高级表格当前行号.未知支持库函数_9 (3, #., .内容)
            加入成员 (cxj图书名称, .内容)
            高级表格当前行号.未知支持库函数_9 (4, #., .内容)
            加入成员 (cxj本书押金, .内容)
            高级表格当前行号.未知支持库函数_9 (5, #., .内容)
            加入成员 (cxj借书日期, 取现行时间 ())
            高级表格当前行号.未知支持库函数_9 (6, #., 到文本 (取现行时间 ()))
            加入成员 (cxj日租金, .内容)
            高级表格当前行号.未知支持库函数_9 (7, #., .内容)
            高级表格当前行号.未知支持库函数_0 (0)
            赋值 (高级表格当前行号, 相加 (高级表格当前行号, 1))
            赋值 (高级表格序号, 相加 (高级表格序号, 1))
            借书金额求和 ()
            赋值 (锁定图书, 假)
            赋值 (.内容, “”)
            获取焦点 ()
        .如果真结束
         ' ************************************************************************************
         ' ************************************************************************************
         ' ************************************************************************************
         ' ************************************************************************************
         ' ************************* 以下是还书部分*********************************
    .否则
        .如果真 (.选中)
            赋值 (SQL语句, 相加 (“select * from 租借表 where 条形码='”, .内容, “' and 会员编号='”, .内容, “' and 是否归还='否'”))
            .如果 (SQL语句.未知支持库函数_14 (#))
                .如果真 (大于 (., 0))
                    .如果 (等于 (., 1))
                        “自动编号”.未知支持库函数_29 (temp自动编号)
                        赋值 (.内容, 到文本 (temp自动编号))
                        “图书名称”.未知支持库函数_26 (temp文本)
                        赋值 (.内容, temp文本)
                        “本书押金”.未知支持库函数_27 (temp小数)
                        赋值 (.内容, 到文本 (temp小数))
                        “日租金”.未知支持库函数_27 (temp小数)
                        赋值 (.内容, 到文本 (temp小数))
                        “借书日期”.未知支持库函数_31 (temp日期)
                        赋值 (.内容, 到文本 (temp日期))
                        赋值 (.内容, 到文本 (取现行时间 ()))
                        计算还书租金 (到数值 (.内容), 到数值 (.内容), .内容, .内容, 押金临时存放)
                        赋值 (.内容, 到文本 (押金临时存放))
                        赋值 (锁定图书, 真)
                        未知支持库函数_16 ()
                    .否则
                        全部删除 ()
                        .计次循环首 (., i)
                             ' 插入表项
                            .插入表项 ()
                            “条形码”.未知支持库函数_26 (temp文本)
                            相减 (i, 1).置标题 (0, temp文本)
                            “图书名称”.未知支持库函数_26 (temp文本)
                            相减 (i, 1).置标题 (1, temp文本)
                            “借书日期”.未知支持库函数_31 (temp日期)
                            相减 (i, 1).置标题 (2, 到文本 (temp日期))
                            赋值 (重复还书临时借书日期, 到文本 (temp日期))
                            “日租金”.未知支持库函数_27 (temp小数)
                            相减 (i, 1).置标题 (3, 到文本 (temp小数))
                            赋值 (重复还书临时日租金, temp小数)
                            “本书押金”.未知支持库函数_27 (temp小数)
                            赋值 (重复还书临时押金, temp小数)
                            相减 (i, 1).置标题 (4, 到文本 (temp小数))
                            计算还书租金 (重复还书临时押金, 重复还书临时日租金, 到文本 (取现行时间 ()), 重复还书临时借书日期, 押金临时存放)
                            相减 (i, 1).置标题 (5, 到文本 (押金临时存放))
                            “自动编号”.未知支持库函数_29 (temp自动编号)
                            相减 (i, 1).置标题 (6, 到文本 (temp自动编号))
                            未知支持库函数_36 ()
                        .计次循环尾 ()
                        赋值 (.可视, 假)
                        赋值 (.可视, 真)
                        赋值 (., 0)
                        未知支持库函数_16 ()
                    .如果结束
                    
                .如果真结束
                
            .否则
                信息框 (“连接租借表错误”, #错误图标, “错误”)
            .如果结束
            
            .如果真 (锁定图书)
                .计次循环首 (取数组成员数 (cxj图书自动编号), i)
                    .如果真 (等于 (cxj图书自动编号 [i], temp自动编号))
                        赋值 (锁定图书, 假)
                        赋值 (.内容, “”)
                        获取焦点 ()
                        信息框 (“该图书已在下面的列表中！”, #信息图标, “提示”)
                        返回 ()
                    .如果真结束
                    
                .计次循环尾 ()
                赋值 (., 相加 (., 1))
                加入成员 (cxj图书自动编号, temp自动编号)
                高级表格当前行号.未知支持库函数_9 (0, #., 到文本 (高级表格序号))
                加入成员 (cxj条形码, .内容)
                高级表格当前行号.未知支持库函数_9 (1, #., .内容)
                加入成员 (cxj图书名称, .内容)
                高级表格当前行号.未知支持库函数_9 (2, #., .内容)
                加入成员 (cxj借书日期, 到时间 (.内容))
                高级表格当前行号.未知支持库函数_9 (3, #., .内容)
                加入成员 (cxj日租金, .内容)
                高级表格当前行号.未知支持库函数_9 (4, #., .内容)
                加入成员 (cxj本书押金, .内容)
                高级表格当前行号.未知支持库函数_9 (5, #., .内容)
                加入成员 (cxj合计租金, 到数值 (.内容))
                高级表格当前行号.未知支持库函数_9 (6, #., .内容)
                高级表格当前行号.未知支持库函数_0 (0)
                赋值 (高级表格当前行号, 相加 (高级表格当前行号, 1))
                赋值 (高级表格序号, 相加 (高级表格序号, 1))
                还书金额求和 ()
                赋值 (锁定图书, 假)
                赋值 (.内容, “”)
                获取焦点 ()
            .如果真结束
            
        .如果真结束
        
    .如果结束
    未知支持库函数_3 ()
.如果真结束


.子程序 计算还书租金, 空白型, , 
.参数 最大租金, 双精度小数型, , 
.参数 日租金, 双精度小数型, , 
.参数 后时间, 文本型, , 
.参数 前时间, 文本型, , 
.参数 指针返回, 双精度小数型, 参考, 

.局部变量 temp租金, 双精度小数型, , , 

.如果真 (小于 (取时间间隔 (到时间 (后时间), 到时间 (前时间), #日), 1))
    赋值 (指针返回, 四舍五入 (日租金, 2))
    返回 ()
.如果真结束
赋值 (temp租金, 相乘 (取时间间隔 (到时间 (后时间), 到时间 (前时间), #日), 日租金))
.如果 (大于或等于 (temp租金, 最大租金))
    赋值 (指针返回, 最大租金)
.否则
    赋值 (指针返回, 四舍五入 (temp租金, 2))
.如果结束



.子程序 _删除_被单击, 空白型, , 
.局部变量 光标行号, 整数型, , , 

.如果 (.选中)
    .如果真 (大于 (未知支持库函数_3 (), 0))
        赋值 (光标行号, 未知支持库函数_3 ())
        .如果真 (等于 (信息框 (“确认要删除该条业务数据?”, 相加 (#确认取消钮, #询问图标), “询问”), #确认钮))
            删除成员 (cxj图书自动编号, 光标行号, 1)
            删除成员 (cxj条形码, 光标行号, 1)
            删除成员 (cxj日租金, 光标行号, 1)
            删除成员 (cxj会员编号, 光标行号, 1)
            删除成员 (cxj会员姓名, 光标行号, 1)
            删除成员 (cxj图书名称, 光标行号, 1)
            删除成员 (cxj本书押金, 光标行号, 1)
            删除成员 (cxj借书日期, 光标行号, 1)
            赋值 (高级表格当前行号, 相减 (高级表格当前行号, 1))
            光标行号.未知支持库函数_36 ()
            借书金额求和 ()
            高级表格当前行号.未知支持库函数_0 (1)
        .如果真结束
        界面刷新 ()
        获取焦点 ()
    .如果真结束
    
.否则
    .如果真 (.选中)
        .如果真 (大于 (未知支持库函数_3 (), 0))
            赋值 (光标行号, 未知支持库函数_3 ())
            .如果真 (等于 (信息框 (“确认要删除该条业务数据?”, 相加 (#确认取消钮, #询问图标), “询问”), #确认钮))
                删除成员 (cxj图书名称, 光标行号, 1)
                删除成员 (cxj借书日期, 光标行号, 1)
                删除成员 (cxj日租金, 光标行号, 1)
                删除成员 (cxj本书押金, 光标行号, 1)
                删除成员 (cxj合计租金, 光标行号, 1)
                赋值 (高级表格当前行号, 相减 (高级表格当前行号, 1))
                光标行号.未知支持库函数_36 ()
                还书金额求和 ()
                高级表格当前行号.未知支持库函数_0 (1)
            .如果真结束
            界面刷新 ()
            获取焦点 ()
        .如果真结束
        
    .如果真结束
    
.如果结束


.子程序 借书金额求和, 空白型, , 
.局部变量 temp日租金, 双精度小数型, , , 
.局部变量 temp押金, 双精度小数型, , , 
.局部变量 i, 整数型, , , 

.计次循环首 (高级表格当前行号, i)
    赋值 (temp日租金, 相加 (temp日租金, 到数值 (i.未知支持库函数_10 (7))))
.计次循环尾 ()
赋值 (.标题, 到文本 (temp日租金))
.计次循环首 (高级表格当前行号, i)
    赋值 (temp押金, 相加 (temp押金, 到数值 (i.未知支持库函数_10 (5))))
.计次循环尾 ()
赋值 (.标题, 到文本 (temp押金))


.子程序 还书金额求和, 空白型, , 
.局部变量 temp日租金, 双精度小数型, , , 
.局部变量 temp押金, 双精度小数型, , , 
.局部变量 i, 整数型, , , 

.计次循环首 (高级表格当前行号, i)
    赋值 (temp日租金, 相加 (temp日租金, 到数值 (i.未知支持库函数_10 (6))))
.计次循环尾 ()
赋值 (.标题, 到文本 (temp日租金))
.计次循环首 (高级表格当前行号, i)
    赋值 (temp押金, 相加 (temp押金, 到数值 (i.未知支持库函数_10 (5))))
.计次循环尾 ()
赋值 (.标题, 到文本 (temp押金))


.子程序 _重复借书超级列表_当前表项被改变, 空白型, , 
赋值 (.内容, .取标题 (., 0))
赋值 (.内容, .取标题 (., 2))
赋值 (.内容, .取标题 (., 1))
赋值 (.内容, .取标题 (., 3))
赋值 (.内容, .取标题 (., 4))
赋值 (.内容, .取标题 (., 5))
赋值 (.内容, .取标题 (., 6))
赋值 (.内容, .取标题 (., 7))
赋值 (.内容, .取标题 (., 8))

.子程序 _重复借书_是的_被单击, 空白型, , 
.局部变量 SQL语句, 文本型, , , 
.局部变量 temp文本, 文本型, , , 
.局部变量 temp小数, 双精度小数型, , , 
.局部变量 temp整数, 整数型, , , 
.局部变量 temp日期, 日期时间型, , , 
.局部变量 temp自动编号, 整数型, , , 

赋值 (.内容, .内容)
赋值 (.内容, .内容)
赋值 (.内容, .内容)
赋值 (.内容, .内容)
赋值 (.内容, .内容)
赋值 (.内容, .内容)
赋值 (.内容, .内容)
赋值 (.内容, .内容)
赋值 (.可视, 假)
赋值 (.可视, 真)
赋值 (锁定图书, 真)
.如果真 (锁定图书)
    qj数据库路径.未知支持库函数_1 (qj数据库密码)
    .未知支持库函数_12 ()
    赋值 (SQL语句, 相加 (“select 图书类型租金 from 图书类型表 where 图书类型名称='”, .内容, “'”))
    .如果 (SQL语句.未知支持库函数_14 (#))
        .如果真 (大于 (., 0))
            “图书类型租金”.未知支持库函数_26 (temp文本)
            赋值 (图书类型租金, 到数值 (temp文本))
            赋值 (.内容, 到文本 (相乘 (图书类型租金, 会员类型租金率)))
        .如果真结束
        
    .否则
        信息框 (“连接图书类型错误”, #错误图标, “错误”)
    .如果结束
    
    赋值 (., 相加 (., 1))
    加入成员 (cxj图书自动编号, temp自动编号)
    高级表格当前行号.未知支持库函数_9 (0, #., 到文本 (高级表格序号))
    加入成员 (cxj会员编号, .内容)
    高级表格当前行号.未知支持库函数_9 (1, #., .内容)
    加入成员 (cxj会员姓名, .内容)
    高级表格当前行号.未知支持库函数_9 (2, #., .内容)
    加入成员 (cxj条形码, .内容)
    高级表格当前行号.未知支持库函数_9 (3, #., .内容)
    加入成员 (cxj图书名称, .内容)
    高级表格当前行号.未知支持库函数_9 (4, #., .内容)
    加入成员 (cxj本书押金, .内容)
    高级表格当前行号.未知支持库函数_9 (5, #., .内容)
    加入成员 (cxj借书日期, 取现行时间 ())
    高级表格当前行号.未知支持库函数_9 (6, #., 到文本 (取现行时间 ()))
    加入成员 (cxj日租金, .内容)
    高级表格当前行号.未知支持库函数_9 (7, #., .内容)
    高级表格当前行号.未知支持库函数_0 (0)
    赋值 (高级表格当前行号, 相加 (高级表格当前行号, 1))
    赋值 (高级表格序号, 相加 (高级表格序号, 1))
    借书金额求和 ()
    赋值 (锁定图书, 假)
    赋值 (.内容, “”)
    获取焦点 ()
    未知支持库函数_3 ()
.如果真结束


.子程序 _重复借书_放弃_被单击, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.可视, 假)
赋值 (.可视, 真)
赋值 (锁定图书, 假)
获取焦点 ()

.子程序 _会员编号_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)

.子程序 _会员编号_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)
赋值 (.内容, 不满13位编码补位 (.内容))

.子程序 _条形码_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)
赋值 (.内容, 不满13位编码补位 (.内容))

.子程序 _借书高级表格_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #Del键))
    _删除_被单击 ()
.如果真结束


.子程序 _条形码_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #Del键))
    赋值 (.内容, “”)
.如果真结束
.如果真 (等于 (键代码, #End键))
    _条形码_失去焦点 ()
.如果真结束


.子程序 _会员编号_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #Del键))
    赋值 (.内容, “”)
.如果真结束
.如果真 (等于 (键代码, #End键))
    _会员编号_失去焦点 ()
.如果真结束


.子程序 _借书_被单击, 空白型, , 
.如果 (锁定会员)
    赋值 (.禁止, 真)
    赋值 (.禁止, 假)
    获取焦点 ()
.否则
    赋值 (.禁止, 假)
    赋值 (.禁止, 真)
    获取焦点 ()
.如果结束
赋值 (.可视, 真)
赋值 (., 真)
赋值 (.可视, 假)
赋值 (., 假)

.子程序 _还书_被单击, 空白型, , 
.如果 (锁定会员)
    赋值 (.禁止, 真)
    赋值 (.禁止, 假)
    获取焦点 ()
.否则
    赋值 (.禁止, 假)
    赋值 (.禁止, 真)
    获取焦点 ()
.如果结束
赋值 (.可视, 真)
赋值 (., 真)
赋值 (.可视, 假)
赋值 (., 假)

.子程序 _重复还书超级列表_当前表项被改变, 空白型, , 
赋值 (.内容, .取标题 (., 1))
赋值 (.内容, .取标题 (., 2))
赋值 (.内容, 到文本 (取现行时间 ()))
赋值 (.内容, .取标题 (., 3))
赋值 (.内容, .取标题 (., 5))
赋值 (.内容, .取标题 (., 4))
赋值 (.内容, .取标题 (., 6))

.子程序 _重复还书_是的_被单击, 空白型, , 
.局部变量 i, 整数型, , , 

赋值 (.内容, .内容)
赋值 (.内容, .内容)
赋值 (.内容, .内容)
赋值 (.内容, .内容)
赋值 (.内容, .内容)
赋值 (.内容, .内容)
赋值 (.内容, .内容)
赋值 (.可视, 假)
赋值 (.可视, 真)
赋值 (锁定图书, 真)
.如果真 (锁定图书)
    .计次循环首 (取数组成员数 (cxj图书自动编号), i)
        .如果真 (等于 (cxj图书自动编号 [i], 到整数 (.内容)))
            赋值 (锁定图书, 假)
            赋值 (.内容, “”)
            获取焦点 ()
            信息框 (“该图书已在下面的列表中！”, #信息图标, “提示”)
            返回 ()
        .如果真结束
        
    .计次循环尾 ()
    
    赋值 (., 相加 (., 1))
    加入成员 (cxj图书自动编号, 到整数 (.内容))
    高级表格当前行号.未知支持库函数_9 (0, #., 到文本 (高级表格序号))
    加入成员 (cxj条形码, .内容)
    高级表格当前行号.未知支持库函数_9 (1, #., .内容)
    加入成员 (cxj图书名称, .内容)
    高级表格当前行号.未知支持库函数_9 (2, #., .内容)
    加入成员 (cxj借书日期, 到时间 (.内容))
    高级表格当前行号.未知支持库函数_9 (3, #., .内容)
    加入成员 (cxj日租金, .内容)
    高级表格当前行号.未知支持库函数_9 (4, #., .内容)
    加入成员 (cxj本书押金, .内容)
    高级表格当前行号.未知支持库函数_9 (5, #., .内容)
    加入成员 (cxj合计租金, 到数值 (.内容))
    高级表格当前行号.未知支持库函数_9 (6, #., .内容)
    高级表格当前行号.未知支持库函数_0 (0)
    赋值 (高级表格当前行号, 相加 (高级表格当前行号, 1))
    赋值 (高级表格序号, 相加 (高级表格序号, 1))
    还书金额求和 ()
    赋值 (锁定图书, 假)
    赋值 (.内容, “”)
    获取焦点 ()
.如果真结束


.子程序 _重复还书_放弃_被单击, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.可视, 假)
赋值 (.可视, 真)
赋值 (锁定图书, 假)
获取焦点 ()


.子程序 界面刷新, 空白型, , 
赋值 (.可视, 假)
赋值 (.可视, 真)

.窗口程序集 会员挂失程序集, , , 

.程序集变量 已经找到, 逻辑型, , , 
.子程序 _ck会员挂失_创建完毕, 空白型, , 
“->正常启动”.滚动写行 ()
获取焦点 ()

.子程序 控件定位, 空白型, , 
赋值 (.左边, 相除 (相减 (ck会员挂失.取用户区宽度 (), .宽度), 3))
赋值 (.顶边, 相除 (相减 (ck会员挂失.取用户区高度 (), .高度), 2))
0.移动 (0, ck会员挂失.取用户区宽度 (), ck会员挂失.取用户区高度 ())


.子程序 _ck会员挂失_尺寸被改变, 空白型, , 
控件定位 ()


.子程序 _挂失_被单击, 空白型, , 
播放按钮声 ()
稍后开始 ()
.如果真 (已经找到)
    数据库连接器.未知支持库函数_12 ()
    .如果 (相加 (“update 会员表 set 会员状态='挂失' where 会员姓名='”, .内容, “' and 有效证件='”, .内容, “'”).未知支持库函数_14 (#))
        相加 (“->成功挂失: ”, .内容, “ ”, .内容).滚动写行 ()
        _放弃_被单击 ()
    .否则
        “->挂失失败,操作中断”.滚动写行 ()
        _放弃_被单击 ()
    .如果结束
    未知支持库函数_16 ()
.如果真结束
稍后结束 ()


.子程序 _ck会员挂失_位置被改变, 空白型, , 
控件定位 ()


.子程序 _放弃_被单击, 空白型, , 
播放按钮声 ()
赋值 (已经找到, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
 ' 清空内容
未知函数_370 () ' *** 缩略程序块 ***
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.标题, “0”)

.子程序 _检测_被单击, 空白型, , 
.局部变量 temp文本, 文本型, , , 
.局部变量 temp整数, 整数型, , , 
.局部变量 temp小数, 双精度小数型, , , 
.局部变量 temp日期, 日期时间型, , , 

播放按钮声 ()
稍后开始 ()
.如果真 (不等于 (删全部空 (.内容), “”))
    .如果真 (不等于 (删全部空 (.内容), “”))
        数据库连接器.未知支持库函数_12 ()
        .如果 (相加 (“select * from 会员表 where 会员姓名='”, .内容, “' and 有效证件='”, .内容, “' and 会员状态='挂失'”).未知支持库函数_14 (#))
            .如果 (大于 (., 0))
                “->该会员已经是挂失状态,不能重复挂失”.滚动写行 ()
                未知支持库函数_16 ()
                稍后结束 ()
                返回 ()
            .否则
                未知支持库函数_16 ()
                .如果 (相加 (“select * from 会员表 where 会员姓名='”, .内容, “' and 有效证件='”, .内容, “' and 会员状态='正常'”).未知支持库函数_14 (#))
                    .如果真 (大于 (., 0))
                        “会员姓名”.未知支持库函数_26 (temp文本)
                        赋值 (.内容, temp文本)
                        “性别”.未知支持库函数_26 (temp文本)
                        赋值 (.内容, temp文本)
                        “联系电话”.未知支持库函数_26 (temp文本)
                        赋值 (.内容, temp文本)
                        “联系地址”.未知支持库函数_26 (temp文本)
                        赋值 (.内容, temp文本)
                        “会员类型”.未知支持库函数_26 (temp文本)
                        赋值 (.内容, temp文本)
                        “有效证件”.未知支持库函数_26 (temp文本)
                        赋值 (.内容, temp文本)
                        “姓名拼音”.未知支持库函数_26 (temp文本)
                        赋值 (.内容, temp文本)
                        “登记日期”.未知支持库函数_31 (temp日期)
                        赋值 (.内容, 到文本 (temp日期))
                        “帐户金额”.未知支持库函数_27 (temp小数)
                        赋值 (.标题, 到文本 (temp小数))
                        赋值 (已经找到, 真)
                        赋值 (.禁止, 真)
                        赋值 (.禁止, 真)
                    .如果真结束
                    未知支持库函数_16 ()
                .否则
                    “->2读取失败,操作中断”.滚动写行 ()
                .如果结束
                
            .如果结束
            
        .否则
            “->1读取失败,操作中断”.滚动写行 ()
        .如果结束
        .如果真 (已经找到)
            赋值 (.禁止, 假)
        .如果真结束
        
    .如果真结束
    
.如果真结束
稍后结束 ()

.子程序 _会员姓名_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _会员姓名_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)


.子程序 _有效证件_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _有效证件_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)


.窗口程序集 会员退款程序集, , , 

.程序集变量 已经找到, 逻辑型, , , 
.子程序 _ck会员退款_创建完毕, 空白型, , 
“->正常启动”.滚动写行 ()
赋值 (.禁止, 假)
获取焦点 ()
赋值 (已经找到, 假)

.子程序 控件定位, 空白型, , 
赋值 (.左边, 相除 (相减 (ck会员退款.取用户区宽度 (), .宽度), 3))
赋值 (.顶边, 相除 (相减 (ck会员退款.取用户区高度 (), .高度), 2))
0.移动 (0, ck会员退款.取用户区宽度 (), ck会员退款.取用户区高度 ())


.子程序 _ck会员退款_尺寸被改变, 空白型, , 
控件定位 ()

.子程序 _ck会员退款_位置被改变, 空白型, , 
控件定位 ()

.子程序 _确认_被单击, 空白型, , 
.局部变量 temp小数, 双精度小数型, , , 

播放按钮声 ()
.如果真 (已经找到)
    .如果真 (大于 (取文本长度 (.内容), 0))
        .如果 (等于 (.内容, .内容))
            .如果真 (大于 (到数值 (.内容), 到数值 (.标题)))
                “->没有足够的余额可退！”.滚动写行 ()
                赋值 (.内容, “”)
                赋值 (.内容, “”)
                返回 ()
            .如果真结束
            数据库连接器.未知支持库函数_12 ()
            .如果 (相加 (“update 会员表 set 帐户金额=帐户金额-”, .内容, “ where 会员编号='”, .内容, “'”).未知支持库函数_14 (#))
                未知支持库函数_16 ()
                数据库连接器.未知支持库函数_12 ()
                .如果 (相加 (“select 帐户金额 from 会员表 where 会员编号='”, .内容, “'”).未知支持库函数_14 (#))
                    .如果真 (大于 (., 0))
                        “帐户金额”.未知支持库函数_27 (temp小数)
                        相加 (“->退款成功 当期余额:”, 到文本 (四舍五入 (temp小数, 2))).滚动写行 ()
                        _取消_被单击 ()
                    .如果真结束
                    
                .否则
                    “->退款后读取失败”.滚动写行 ()
                .如果结束
                
            .否则
                “->退款失败,操作中断”.滚动写行 ()
            .如果结束
            未知支持库函数_16 ()
        .否则
            信息框 (“两次输入的金额不一致,请重新输入”, #警告图标, “操作错误”)
            赋值 (.内容, “”)
            赋值 (.内容, “”)
        .如果结束
        
    .如果真结束
    
.如果真结束
稍后结束 ()

.子程序 _取消_被单击, 空白型, , 
播放按钮声 ()
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (已经找到, 假)
 ' 清空内容
未知函数_534 () ' *** 缩略程序块 ***
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.标题, “0”)

.子程序 _会员编号_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)
赋值 (.内容, 不满13位编码补位 (.内容))

.子程序 _会员编号_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _退款金额_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)

.子程序 _退款金额_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)

.子程序 _再次输入_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _再次输入_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)


.子程序 _检测_被单击, 空白型, , 
.局部变量 temp文本, 文本型, , , 
.局部变量 temp整数, 整数型, , , 
.局部变量 temp小数, 双精度小数型, , , 
.局部变量 temp日期, 日期时间型, , , 

.如果真 (并且 (大于或等于 (取文本长度 (删全部空 (.内容)), qj会员编号长度), 大于 (取文本长度 (删全部空 (.内容)), 0)))
    稍后开始 ()
    数据库连接器.未知支持库函数_12 ()
    .如果 (相加 (“select * from 会员表 where 会员编号='”, .内容, “' and 有效证件='”, .内容, “'”).未知支持库函数_14 (#))
        .如果真 (大于 (., 0))
             ' 读取内容
            未知函数_845 () ' *** 缩略程序块 ***
            “会员姓名”.未知支持库函数_26 (temp文本)
            赋值 (.内容, temp文本)
            “性别”.未知支持库函数_26 (temp文本)
            赋值 (.内容, temp文本)
            “联系电话”.未知支持库函数_26 (temp文本)
            赋值 (.内容, temp文本)
            “联系地址”.未知支持库函数_26 (temp文本)
            赋值 (.内容, temp文本)
            “会员类型”.未知支持库函数_26 (temp文本)
            赋值 (.内容, temp文本)
            “有效证件”.未知支持库函数_26 (temp文本)
            赋值 (.内容, temp文本)
            “姓名拼音”.未知支持库函数_26 (temp文本)
            赋值 (.内容, temp文本)
            “登记日期”.未知支持库函数_31 (temp日期)
            赋值 (.内容, 到文本 (temp日期))
            “帐户金额”.未知支持库函数_27 (temp小数)
            赋值 (.标题, 到文本 (四舍五入 (temp小数, 2)))
            赋值 (已经找到, 真)
        .如果真结束
        
    .否则
        “->读取失败,操作中断”.滚动写行 ()
        赋值 (已经找到, 假)
    .如果结束
    未知支持库函数_16 ()
    稍后结束 ()
.如果真结束

.如果 (已经找到)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
.如果结束


.子程序 _有效证件_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _有效证件_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)


.窗口程序集 最后确认程序集, , , 

.子程序 _最后放弃_被单击, 空白型, , 
赋值 (最后确认, 假)
ck最后确认窗口.销毁 ()


.子程序 _ck最后确认窗口_创建完毕, 空白型, , 
.如果 (大于 (到数值 (ck租借管理..标题), 到数值 (ck租借管理..内容)))
    赋值 (.标题, 到文本 (相减 (到数值 (ck租借管理..标题), 到数值 (ck租借管理..内容))))
    赋值 (.标题, “0”)
.否则
    赋值 (.标题, “0”)
    赋值 (.标题, 到文本 (相减 (到数值 (ck租借管理..内容), 到数值 (ck租借管理..标题))))
.如果结束

.如果真 (等于 (到数值 (.标题), 0))
    赋值 (.可视, 假)
    赋值 (.可视, 假)
.如果真结束


.子程序 _最后完成_被单击, 空白型, , 
.局部变量 SQL语句, 文本型, , , 

.如果真 (等于 (时间正常, 假))
    信息框 (“时间处于异常状态,操作中断”, #警告图标, “警报”)
    返回 ()
.如果真结束

.如果真 (等于 (到数值 (.标题), 0))
    赋值 (最后确认, 真)
    ck最后确认窗口.销毁 ()
    赋值 (ck租借管理..可视, 假)
    赋值 (ck租借管理..可视, 真)
    返回 ()
.如果真结束

.如果真 (等于 (删全部空 (.内容), “”))
    返回 ()
.如果真结束

.如果真 (小于 (到数值 (.内容), 到数值 (.标题)))
    返回 ()
.如果真结束

赋值 (SQL语句, 相加 (“update 会员表 set 帐户金额=帐户金额+”, .内容, “ where 会员编号='”, ck租借管理..内容, “'”))
数据库连接器.未知支持库函数_12 ()
.如果 (SQL语句.未知支持库函数_14 (#))
    赋值 (最后确认, 真)
.否则
    赋值 (最后确认, 假)
    信息框 (“充值失败,交易终止,请重新尝试!”, #错误图标, “错误”)
.如果结束
未知支持库函数_16 ()
ck最后确认窗口.销毁 ()
赋值 (ck租借管理..可视, 假)
赋值 (ck租借管理..可视, 真)
返回 ()

.窗口程序集 书籍管理程序集, , , 

.程序集变量 更新记录中, 逻辑型, , , 
.程序集变量 每页记录数, 整数型, , , 
.程序集变量 总记录数, 整数型, , , 
.程序集变量 记录集游标, 整数型, , , 
.程序集变量 当前页数, 整数型, , , 
.程序集变量 总页数, 整数型, , , 
.程序集变量 temp查询符号, 文本型, , , 
.程序集变量 cxjSQL语句, 文本型, , , 
.子程序 _ck书籍管理_创建完毕, 空白型, , 
.局部变量 temp, 文本型, , , 

.未知支持库函数_20 (“点击查看相关信息”, -1, , , , )
数据库连接器.未知支持库函数_12 ()
.如果 (“select 图书类型名称 from 图书类型表”.未知支持库函数_14 (#))
    .计次循环首 (., )
        “图书类型名称”.未知支持库函数_26 (temp)
        temp.加入项目 ()
        未知支持库函数_36 ()
    .计次循环尾 ()
.否则
    信息框 (“读取书籍类型名称错误！”, #错误图标, “错误”)
.如果结束
未知支持库函数_16 ()
赋值 (更新记录中, 假)
初始化子程序 ()

.子程序 控件定位, 空白型, , 
赋值 (.左边, 相除 (相减 (ck书籍管理.取用户区宽度 (), .宽度), 3))
赋值 (.顶边, 相除 (相减 (ck书籍管理.取用户区高度 (), .高度), 2))
0.移动 (0, ck书籍管理.取用户区宽度 (), ck书籍管理.取用户区高度 ())

.子程序 _ck书籍管理_位置被改变, 空白型, , 
控件定位 ()


.子程序 _ck书籍管理_尺寸被改变, 空白型, , 
控件定位 ()


.子程序 _修改保存_被单击, 空白型, , 
.如果真 (等于 (更新记录中, 真))
    返回 ()
.如果真结束
.如果 (等于 (.标题, “修改”))
    .如果真 (等于 (.内容, “”))
        返回 ()
    .如果真结束
    赋值 (.输入方式, 0)
    赋值 (.输入方式, 0)
    赋值 (.输入方式, 0)
    赋值 (.输入方式, 7)
    赋值 (.输入方式, 0)
    赋值 (.输入方式, 4)
    赋值 (.输入方式, 4)
    赋值 (.输入方式, 0)
    赋值 (.输入方式, 0)
    赋值 (.输入方式, 0)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.标题, “保存”)
.否则
    .如果真 (等于 (.标题, “保存”))
        .如果真 (等于 (.内容, “”))
            返回 ()
        .如果真结束
        .如果真 (等于 (信息框 (“确认要保存修改吗？”, 相加 (#询问图标, #确认取消钮), “询问”), #确认钮))
            赋值 (.输入方式, 1)
            赋值 (.输入方式, 1)
            赋值 (.输入方式, 1)
            赋值 (.输入方式, 1)
            赋值 (.输入方式, 1)
            赋值 (.输入方式, 1)
            赋值 (.输入方式, 1)
            赋值 (.输入方式, 1)
            赋值 (.输入方式, 1)
            赋值 (.输入方式, 1)
            赋值 (.禁止, 真)
            赋值 (.禁止, 真)
            .如果真 (不等于 (.内容, “”))
                赋值 (更新记录中, 真)
                更新数据库记录 ()
                刷新数据记录 ()
            .如果真结束
            赋值 (.标题, “修改”)
            赋值 (更新记录中, 假)
        .如果真结束
        赋值 (.可视, 假)
        赋值 (.可视, 真)
    .如果真结束
    
.如果结束


.子程序 刷新数据记录, 空白型, , 
.局部变量 temp文本, 文本型, , , 
.局部变量 temp整数, 整数型, , , 
.局部变量 temp小数, 双精度小数型, , , 
.局部变量 temp日期, 日期时间型, , , 
.局部变量 行数, 整数型, , , 

qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
cxjSQL语句.未知支持库函数_14 (#)
赋值 (当前页数, 到数值 (.内容))
未知支持库函数_57 ()
赋值 (., 1)
赋值 (., 15)
赋值 (记录集游标, 相乘 (每页记录数, 相减 (当前页数, 1)))
记录集游标.未知支持库函数_38 ()

未知支持库函数_57 ()
设置高级表格表头 ()
.计次循环首 (每页记录数, 行数)
    赋值 (temp文本, “”)
    “条形码”.未知支持库函数_26 (temp文本)
    .如果真 (不等于 (temp文本, “”))
        赋值 (., 相加 (., 1))
        “条形码”.未知支持库函数_26 (temp文本)
        行数.未知支持库函数_9 (0, #., temp文本)
        “图书名称”.未知支持库函数_26 (temp文本)
        行数.未知支持库函数_9 (1, #., temp文本)
        “书名拼音”.未知支持库函数_26 (temp文本)
        行数.未知支持库函数_9 (2, #., temp文本)
        “入库日期”.未知支持库函数_31 (temp日期)
        行数.未知支持库函数_9 (3, #., 到文本 (temp日期))
        “类型”.未知支持库函数_26 (temp文本)
        行数.未知支持库函数_9 (4, #., temp文本)
        “作者”.未知支持库函数_26 (temp文本)
        行数.未知支持库函数_9 (5, #., temp文本)
        “出版社”.未知支持库函数_26 (temp文本)
        行数.未知支持库函数_9 (6, #., temp文本)
        “定价”.未知支持库函数_27 (temp小数)
        行数.未知支持库函数_9 (7, #., temp小数)
        “进货价”.未知支持库函数_27 (temp小数)
        行数.未知支持库函数_9 (8, #., temp小数)
        “印刷版本”.未知支持库函数_26 (temp文本)
        行数.未知支持库函数_9 (9, #., temp文本)
        “备注”.未知支持库函数_26 (temp文本)
        行数.未知支持库函数_9 (10, #., temp文本)
        “拥有数量”.未知支持库函数_29 (temp整数)
        行数.未知支持库函数_9 (11, #., temp整数)
        “是否借出”.未知支持库函数_29 (temp整数)
        行数.未知支持库函数_9 (12, #., temp整数)
        “被借次数”.未知支持库函数_29 (temp整数)
        行数.未知支持库函数_9 (13, #., temp整数)
        “自动编号”.未知支持库函数_29 (temp整数)
        行数.未知支持库函数_9 (14, #., temp整数)
    .如果真结束
    未知支持库函数_36 ()
    读取图书表数据 (行数)
.计次循环尾 ()
#..未知支持库函数_14 (#白色, #银白)
未知支持库函数_16 ()
未知支持库函数_3 ()

.子程序 更新数据库记录, 空白型, , 
.局部变量 pass, 逻辑型, , , 
.局部变量 SQL语句, 文本型, , , 

赋值 (pass, 真)
qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
未知支持库函数_9 ()
赋值 (SQL语句, 相加 (“update 图书表 set 条形码='”, .内容, “',入库日期=#”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天)), “#,图书名称='”, .内容, “',书名拼音='”, .内容, “',类型='”, .取项目文本 (.现行选中项), “',作者='”, .内容, “',出版社='”, .内容, “',定价=”, .内容, “,进货价=”, .内容, “,印刷版本='”, .内容, “',备注='”, .内容, “',拥有数量=”, .内容, “ where 自动编号=”, .内容))
.如果真 (等于 (SQL语句.未知支持库函数_14 (#), 假))
    赋值 (pass, 假)
.如果真结束
赋值 (SQL语句, 相加 (“update 租借表 set 条形码='”, .内容, “',图书名称='”, .内容, “' where 条形码='”, .内容, “' and 图书名称='”, .内容, “'”))
.如果真 (等于 (SQL语句.未知支持库函数_14 (#), 假))
    赋值 (pass, 假)
.如果真结束

.如果 (pass)
    未知支持库函数_10 ()
    信息框 (“书籍资料修改成功！”, #信息图标, “成功”)
.否则
    未知支持库函数_11 ()
    信息框 (“出现错误,修改失败！”, #错误图标, “错误”)
.如果结束
未知支持库函数_16 ()
未知支持库函数_3 ()

.子程序 初始化子程序, 空白型, , 
清空并禁止所有输入框 ()
设置高级表格表头 ()

.子程序 清空并禁止所有输入框, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “0”)
赋值 (.内容, “0”)
赋值 (.输入方式, 1)
赋值 (.输入方式, 1)
赋值 (.输入方式, 1)
赋值 (.输入方式, 1)
赋值 (.输入方式, 1)
赋值 (.输入方式, 1)
赋值 (.输入方式, 1)
赋值 (.输入方式, 1)
赋值 (.输入方式, 1)
赋值 (.输入方式, 1)
赋值 (.禁止, 真)
赋值 (.现行选中项, -1)
赋值 (.禁止, 真)
赋值 (.标题, “修改”)


.子程序 设置高级表格表头, 空白型, , 
0.未知支持库函数_9 (0, #., “条形码”)
0.未知支持库函数_32 (180)
0.未知支持库函数_9 (1, #., “书籍名称”)
1.未知支持库函数_32 (180)
0.未知支持库函数_9 (2, #., “书名拼音”)
2.未知支持库函数_32 (60)
0.未知支持库函数_9 (3, #., “入库日期”)
3.未知支持库函数_32 (180)
0.未知支持库函数_9 (4, #., “书籍类型”)
4.未知支持库函数_32 (80)
0.未知支持库函数_9 (5, #., “作  者”)
5.未知支持库函数_32 (60)
0.未知支持库函数_9 (6, #., “出版社”)
6.未知支持库函数_32 (120)
0.未知支持库函数_9 (7, #., “定 价”)
7.未知支持库函数_32 (50)
0.未知支持库函数_9 (8, #., “进货价”)
8.未知支持库函数_32 (60)
0.未知支持库函数_9 (9, #., “印刷版本”)
9.未知支持库函数_32 (80)
0.未知支持库函数_9 (10, #., “备  注”)
10.未知支持库函数_32 (180)
0.未知支持库函数_9 (11, #., “拥有数量”)
11.未知支持库函数_32 (60)
0.未知支持库函数_9 (12, #., “借出数量”)
12.未知支持库函数_32 (60)
0.未知支持库函数_9 (13, #., “被借次数”)
13.未知支持库函数_32 (60)
0.未知支持库函数_9 (14, #., “附加号”)
14.未知支持库函数_32 (60)



.子程序 _高级表格1_光标位置改变, 空白型, , 
.局部变量 光标行号, 整数型, , , 

赋值 (光标行号, 未知支持库函数_3 ())
.如果真 (不等于 (光标行号, -1))
    清空并禁止所有输入框 ()
    赋值 (.内容, 光标行号.未知支持库函数_10 (0))
    赋值 (.内容, 光标行号.未知支持库函数_10 (1))
    赋值 (.内容, 光标行号.未知支持库函数_10 (0))
    赋值 (.内容, 光标行号.未知支持库函数_10 (1))
    赋值 (.内容, 光标行号.未知支持库函数_10 (2))
    赋值 (.今天, 到时间 (光标行号.未知支持库函数_10 (3)))
    光标行号.未知支持库函数_10 (4).选择 ()
    赋值 (.内容, 光标行号.未知支持库函数_10 (5))
    赋值 (.内容, 光标行号.未知支持库函数_10 (6))
    赋值 (.内容, 光标行号.未知支持库函数_10 (7))
    赋值 (.内容, 光标行号.未知支持库函数_10 (8))
    赋值 (.内容, 光标行号.未知支持库函数_10 (9))
    赋值 (.内容, 光标行号.未知支持库函数_10 (10))
    赋值 (.内容, 光标行号.未知支持库函数_10 (11))
    赋值 (.内容, 光标行号.未知支持库函数_10 (12))
    赋值 (.内容, 光标行号.未知支持库函数_10 (13))
    赋值 (.内容, 光标行号.未知支持库函数_10 (14))
    .如果 (小于或等于 (到数值 (.内容), 到数值 (.内容)))
        赋值 (.内容, “无库存”)
    .否则
        赋值 (.内容, “有库存”)
    .如果结束
    读取相关信息 ()
.如果真结束


.子程序 读取相关信息, 空白型, , 
.局部变量 temp文本, 文本型, , , 
.局部变量 temp日期, 日期时间型, , , 
.局部变量 temp整数, 整数型, , , 
.局部变量 行数, 整数型, , , 

qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
相加 (“select 会员编号,会员姓名,借书日期 from 租借表 where 条形码='”, .内容, “' and 是否归还='否'”).未知支持库函数_14 (#)
全部删除 ()
.计次循环首 (., 行数)
    .插入表项 ()
    “会员编号”.未知支持库函数_26 (temp文本)
    相减 (行数, 1).置标题 (0, temp文本)
    “会员姓名”.未知支持库函数_26 (temp文本)
    相减 (行数, 1).置标题 (1, temp文本)
    “借书日期”.未知支持库函数_31 (temp日期)
    相减 (行数, 1).置标题 (2, 到文本 (temp日期))
    未知支持库函数_36 ()
.计次循环尾 ()
未知支持库函数_16 ()
未知支持库函数_3 ()

.子程序 计算总页数, 整数型, , 
.判断开始 (等于 (寻找文本 (到文本 (相除 (总记录数, 每页记录数)), “.”, , 假), -1)) ' -1为未找到小数点
    返回 (取整 (相除 (总记录数, 每页记录数)))
.默认
    返回 (相加 (取整 (相除 (总记录数, 每页记录数)), 1))
.判断结束


.子程序 _第一页按钮_被单击, 空白型, , 
.局部变量 行数, 整数型, , , 

赋值 (每页记录数, 9)
赋值 (总记录数, .)
赋值 (总页数, 计算总页数 ())
赋值 (.内容, 到文本 (总页数))

赋值 (当前页数, 1)
赋值 (., 1)
赋值 (., 15)

连续赋值 (假, .禁止, .禁止, .禁止, .禁止)
赋值 (记录集游标, 0)
记录集游标.未知支持库函数_38 ()
赋值 (.内容, 到文本 (当前页数))
未知支持库函数_57 ()

设置高级表格表头 ()
.计次循环首 (每页记录数, 行数)
    读取图书表数据 (行数)
.计次循环尾 ()
#..未知支持库函数_14 (#白色, #银白)


连续赋值 (真, .禁止, .禁止)
.如果真 (小于 (总记录数, 每页记录数))
    连续赋值 (真, .禁止, .禁止, .禁止, .禁止)
.如果真结束


.子程序 _下一页按钮_被单击, 空白型, , 
.局部变量 行数, 整数型, , , 

赋值 (每页记录数, 9)
赋值 (总记录数, .)
赋值 (总页数, 计算总页数 ())
赋值 (.内容, 到文本 (总页数))

赋值 (当前页数, 相加 (当前页数, 1))
未知支持库函数_57 ()
赋值 (., 1)
赋值 (., 15)
赋值 (记录集游标, 相乘 (每页记录数, 相减 (当前页数, 1)))
记录集游标.未知支持库函数_38 ()
连续赋值 (假, .禁止, .禁止, .禁止, .禁止)

设置高级表格表头 ()
.计次循环首 (每页记录数, 行数)
    读取图书表数据 (行数)
.计次循环尾 ()
#..未知支持库函数_14 (#白色, #银白)

赋值 (.内容, 到文本 (当前页数))
.如果真 (大于或等于 (当前页数, 总页数))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.如果真结束


.子程序 _上一页按钮_被单击, 空白型, , 
.局部变量 行数, 整数型, , , 

赋值 (每页记录数, 9)
赋值 (总记录数, .)
赋值 (总页数, 计算总页数 ())
赋值 (.内容, 到文本 (总页数))

赋值 (当前页数, 相减 (当前页数, 1))
未知支持库函数_57 ()
赋值 (总记录数, .)
赋值 (., 1)
赋值 (., 15)

连续赋值 (假, .禁止, .禁止, .禁止, .禁止)
赋值 (记录集游标, 相乘 (每页记录数, 相减 (当前页数, 1)))
记录集游标.未知支持库函数_38 ()

设置高级表格表头 ()
.计次循环首 (每页记录数, 行数)
    读取图书表数据 (行数)
.计次循环尾 ()
#..未知支持库函数_14 (#白色, #银白)

赋值 (.内容, 到文本 (当前页数))
.如果真 (小于或等于 (当前页数, 1))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.如果真结束


.子程序 _最后一页按钮_被单击, 空白型, , 
.局部变量 行数, 整数型, , , 

赋值 (每页记录数, 9)
赋值 (总记录数, .)
赋值 (总页数, 计算总页数 ())
赋值 (.内容, 到文本 (总页数))

赋值 (当前页数, 总页数)
未知支持库函数_57 ()
赋值 (总记录数, .)
赋值 (., 1)
赋值 (., 15)

连续赋值 (假, .禁止, .禁止, .禁止, .禁止)
赋值 (记录集游标, 相乘 (每页记录数, 相减 (当前页数, 1)))
记录集游标.未知支持库函数_38 ()

设置高级表格表头 ()
.计次循环首 (每页记录数, 行数)
    读取图书表数据 (行数)
.计次循环尾 ()
#..未知支持库函数_14 (#白色, #银白)

赋值 (.内容, 到文本 (当前页数))
.如果真 (大于或等于 (当前页数, 总页数))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.如果真结束



.子程序 读取图书表数据, 空白型, , 
.参数 行数, 整数型, , 

.局部变量 temp文本, 文本型, , , 
.局部变量 temp整数, 整数型, , , 
.局部变量 temp小数, 双精度小数型, , , 
.局部变量 temp日期, 日期时间型, , , 

赋值 (temp文本, “”)
“条形码”.未知支持库函数_26 (temp文本)
.如果真 (不等于 (temp文本, “”))
    赋值 (., 相加 (., 1))
    “条形码”.未知支持库函数_26 (temp文本)
    行数.未知支持库函数_9 (0, #., temp文本)
    “图书名称”.未知支持库函数_26 (temp文本)
    行数.未知支持库函数_9 (1, #., temp文本)
    “书名拼音”.未知支持库函数_26 (temp文本)
    行数.未知支持库函数_9 (2, #., temp文本)
    “入库日期”.未知支持库函数_31 (temp日期)
    行数.未知支持库函数_9 (3, #., 到文本 (temp日期))
    “类型”.未知支持库函数_26 (temp文本)
    行数.未知支持库函数_9 (4, #., temp文本)
    “作者”.未知支持库函数_26 (temp文本)
    行数.未知支持库函数_9 (5, #., temp文本)
    “出版社”.未知支持库函数_26 (temp文本)
    行数.未知支持库函数_9 (6, #., temp文本)
    “定价”.未知支持库函数_27 (temp小数)
    行数.未知支持库函数_9 (7, #., temp小数)
    “进货价”.未知支持库函数_27 (temp小数)
    行数.未知支持库函数_9 (8, #., temp小数)
    “印刷版本”.未知支持库函数_26 (temp文本)
    行数.未知支持库函数_9 (9, #., temp文本)
    “备注”.未知支持库函数_26 (temp文本)
    行数.未知支持库函数_9 (10, #., temp文本)
    “拥有数量”.未知支持库函数_29 (temp整数)
    行数.未知支持库函数_9 (11, #., temp整数)
    “是否借出”.未知支持库函数_29 (temp整数)
    行数.未知支持库函数_9 (12, #., temp整数)
    “被借次数”.未知支持库函数_29 (temp整数)
    行数.未知支持库函数_9 (13, #., temp整数)
    “自动编号”.未知支持库函数_29 (temp整数)
    行数.未知支持库函数_9 (14, #., temp整数)
.如果真结束
未知支持库函数_36 ()


.子程序 _查询_被单击, 空白型, , 
.如果真 (等于 (.现行选中项, -1))
    返回 ()
.如果真结束
.如果真 (等于 (.现行选中项, -1))
    返回 ()
.如果真结束
.如果真 (等于 (删全部空 (.内容), “”))
    返回 ()
.如果真结束
.如果真 (等于 (.现行选中项, 0))
    赋值 (temp查询符号, “=”)
.如果真结束
.如果真 (等于 (.现行选中项, 1))
    赋值 (temp查询符号, “like”)
.如果真结束
.如果真 (等于 (.现行选中项, 2))
    赋值 (temp查询符号, “>”)
.如果真结束
.如果真 (等于 (.现行选中项, 3))
    赋值 (temp查询符号, “<”)
.如果真结束
.如果真 (等于 (.现行选中项, 4))
    赋值 (temp查询符号, “>=”)
.如果真结束
.如果真 (等于 (.现行选中项, 5))
    赋值 (temp查询符号, “<=”)
.如果真结束
.如果 (不等于 (temp查询符号, “like”))
    赋值 (cxjSQL语句, 相加 (“select * from 图书表 where ”, .取项目文本 (.现行选中项), temp查询符号, “'”, .内容, “'”))
.否则
    赋值 (cxjSQL语句, 相加 (“select * from 图书表 where ”, .取项目文本 (.现行选中项), “ ”, temp查询符号, “ '%”, .内容, “%'”))
.如果结束
.如果真 (.)
    未知支持库函数_16 ()
.如果真结束
cxjSQL语句.未知支持库函数_14 (#)
赋值 (.标题, 相加 (“找到记录: ”, 到文本 (.), “ 条”))
_第一页按钮_被单击 ()

.子程序 _查询依据_列表项被选择, 空白型, , 
.如果真 (等于 (.现行选中项, 0))
    清空 ()
    “等于”.加入项目 ()
.如果真结束
.如果真 (等于 (.现行选中项, 1))
    清空 ()
    “等于”.加入项目 ()
    “约等于”.加入项目 ()
.如果真结束
.如果真 (等于 (.现行选中项, 2))
    清空 ()
    “等于”.加入项目 ()
    “约等于”.加入项目 ()
.如果真结束
.如果真 (等于 (.现行选中项, 3))
    清空 ()
    “等于”.加入项目 ()
    “约等于”.加入项目 ()
.如果真结束
.如果真 (等于 (.现行选中项, 4))
    清空 ()
    “等于”.加入项目 ()
    “约等于”.加入项目 ()
.如果真结束


.子程序 _书籍名称_内容被改变, 空白型, , 
赋值 (.内容, 取首拼 ())


.子程序 _取消_被单击, 空白型, , 
.如果真 (等于 (未知支持库函数_3 (), -1))
    返回 ()
.如果真结束
_高级表格1_光标位置改变 ()

.子程序 _条形码_获得焦点, 空白型, , 
.如果真 (等于 (.标题, “保存”))
    赋值 (.背景颜色, #黄色)
.如果真结束


.子程序 _条形码_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)


.子程序 _书籍名称_获得焦点, 空白型, , 
.如果真 (等于 (.标题, “保存”))
    赋值 (.背景颜色, #黄色)
.如果真结束


.子程序 _书籍名称_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)

.子程序 _书名拼音_获得焦点, 空白型, , 
.如果真 (等于 (.标题, “保存”))
    赋值 (.背景颜色, #黄色)
.如果真结束


.子程序 _书名拼音_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)


.子程序 _书籍类型_获得焦点, 空白型, , 
.如果真 (等于 (.标题, “保存”))
    赋值 (.背景颜色, #黄色)
.如果真结束


.子程序 _书籍类型_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)


.子程序 _印刷版本_获得焦点, 空白型, , 
.如果真 (等于 (.标题, “保存”))
    赋值 (.背景颜色, #黄色)
.如果真结束


.子程序 _印刷版本_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)

.子程序 _作者_获得焦点, 空白型, , 
.如果真 (等于 (.标题, “保存”))
    赋值 (.背景颜色, #黄色)
.如果真结束


.子程序 _作者_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)


.子程序 _进货价_获得焦点, 空白型, , 
.如果真 (等于 (.标题, “保存”))
    赋值 (.背景颜色, #黄色)
.如果真结束


.子程序 _进货价_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)

.子程序 _出版社_获得焦点, 空白型, , 
.如果真 (等于 (.标题, “保存”))
    赋值 (.背景颜色, #黄色)
.如果真结束


.子程序 _出版社_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)


.子程序 _拥有数量_获得焦点, 空白型, , 
.如果真 (等于 (.标题, “保存”))
    赋值 (.背景颜色, #黄色)
.如果真结束


.子程序 _拥有数量_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)


.子程序 _定价_获得焦点, 空白型, , 
.如果真 (等于 (.标题, “保存”))
    赋值 (.背景颜色, #黄色)
.如果真结束


.子程序 _定价_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)


.子程序 _备注_获得焦点, 空白型, , 
.如果真 (等于 (.标题, “保存”))
    赋值 (.背景颜色, #黄色)
.如果真结束


.子程序 _备注_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)


.子程序 _删除_被单击, 空白型, , 
.局部变量 pass, 逻辑型, , , 

.如果真 (或者 (等于 (.内容, “”), 等于 (.标题, “保存”)))
    信息框 (“没有选中欲删除的记录 或 记录正处于修改状态”, #警告图标, “提示”)
    赋值 (.可视, 假)
    赋值 (.可视, 真)
    返回 ()
.如果真结束
赋值 (pass, 假)
赋值 (pass, qj数据库路径.未知支持库函数_1 (qj数据库密码))
.如果真 (等于 (pass, 假))
    信息框 (“连接数据库出错,终止！”, #错误图标, “错误”)
    赋值 (.可视, 假)
    赋值 (.可视, 真)
    未知支持库函数_3 ()
    返回 ()
.如果真结束
.未知支持库函数_12 ()
赋值 (pass, 相加 (“select 条形码 from 租借表 where 图书名称='”, .内容, “' and 条形码='”, .内容, “' and 是否归还='否'”).未知支持库函数_14 (#))
.如果真 (等于 (pass, 假))
    信息框 (“读取租借表出错,终止！”, #错误图标, “错误”)
    赋值 (.可视, 假)
    赋值 (.可视, 真)
    未知支持库函数_16 ()
    未知支持库函数_3 ()
    返回 ()
.如果真结束
.如果真 (大于 (., 0))
    信息框 (“该书籍还有已借出但未归还的记录,不能删除!”, #警告图标, “提示”)
    赋值 (.可视, 假)
    赋值 (.可视, 真)
    未知支持库函数_16 ()
    未知支持库函数_3 ()
    返回 ()
.如果真结束
未知支持库函数_16 ()
赋值 (pass, 相加 (“delete * from 图书表 where 条形码='”, .内容, “' and 图书名称='”, .内容, “'”).未知支持库函数_14 (#))
.如果 (pass)
    信息框 (“删除书籍成功！”, #信息图标, “成功”)
    赋值 (.可视, 假)
    赋值 (.可视, 真)
    清空并禁止所有输入框 ()
    刷新数据记录 ()
.否则
    信息框 (“删除书籍失败！”, #错误图标, “失败”)
    赋值 (.可视, 假)
    赋值 (.可视, 真)
.如果结束
未知支持库函数_16 ()
未知支持库函数_3 ()


.子程序 _查询条件_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)
.如果真 (等于 (.取项目文本 (.现行选中项), “条形码”))
    赋值 (.内容, 不满13位编码补位 (.内容))
.如果真结束
.如果真 (大于 (取文本长度 (删全部空 (.内容)), 0))
    _查询_被单击 ()
.如果真结束


.子程序 _查询条件_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)

.子程序 _高级表格1_被单击, 空白型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 

_高级表格1_光标位置改变 ()


.子程序 _透明标签7_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (不等于 (未知支持库函数_3 (), -1))
    赋值 (.可视, 真)
    赋值 (.禁止, 真)
    赋值 (., 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.如果真结束


.子程序 _关闭_被单击, 空白型, , 
赋值 (.可视, 假)
赋值 (.禁止, 假)
赋值 (., 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)


.窗口程序集 会员管理程序集, , , 

.程序集变量 更新记录中, 逻辑型, , , 
.程序集变量 每页记录数, 整数型, , , 
.程序集变量 总记录数, 整数型, , , 
.程序集变量 记录集游标, 整数型, , , 
.程序集变量 当前页数, 整数型, , , 
.程序集变量 总页数, 整数型, , , 
.程序集变量 temp查询符号, 文本型, , , 
.程序集变量 cxjSQL语句, 文本型, , , 
.子程序 控件定位, 空白型, , 
赋值 (.左边, 相除 (相减 (ck会员管理.取用户区宽度 (), .宽度), 3))
赋值 (.顶边, 相除 (相减 (ck会员管理.取用户区高度 (), .高度), 2))
0.移动 (0, ck会员管理.取用户区宽度 (), ck会员管理.取用户区高度 ())

.子程序 _ck会员管理_位置被改变, 空白型, , 
控件定位 ()


.子程序 _ck会员管理_尺寸被改变, 空白型, , 
控件定位 ()


.子程序 _ck会员管理_创建完毕, 空白型, , 
.局部变量 temp, 文本型, , , 

.未知支持库函数_20 (“点击查看相关信息”, -1, , , , )
数据库连接器.未知支持库函数_12 ()
.如果 (“select 会员类型名称 from 会员类型表”.未知支持库函数_14 (#))
    .计次循环首 (., )
        “会员类型名称”.未知支持库函数_26 (temp)
        temp.加入项目 ()
        未知支持库函数_36 ()
    .计次循环尾 ()
.否则
    信息框 (“读取会员类型名称错误！”, #错误图标, “错误”)
.如果结束
未知支持库函数_16 ()
赋值 (更新记录中, 假)
初始化子程序 ()

.子程序 _修改保存_被单击, 空白型, , 
.如果真 (等于 (更新记录中, 真))
    返回 ()
.如果真结束
.如果 (等于 (.标题, “修改”))
    .如果真 (等于 (.内容, “”))
        返回 ()
    .如果真结束
    赋值 (.输入方式, 0)
    赋值 (.输入方式, 0)
    赋值 (.输入方式, 0)
    赋值 (.输入方式, 0)
    赋值 (.输入方式, 0)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.标题, “保存”)
.否则
    .如果真 (等于 (.标题, “保存”))
        .如果真 (等于 (.内容, “”))
            返回 ()
        .如果真结束
        .如果真 (等于 (信息框 (“确认要保存修改吗？”, 相加 (#询问图标, #确认取消钮), “询问”), #确认钮))
            赋值 (.输入方式, 1)
            赋值 (.输入方式, 1)
            赋值 (.输入方式, 1)
            赋值 (.输入方式, 1)
            赋值 (.输入方式, 1)
            赋值 (.禁止, 真)
            赋值 (.禁止, 真)
            赋值 (.禁止, 真)
            .如果真 (不等于 (.内容, “”))
                赋值 (更新记录中, 真)
                更新数据库记录 ()
                刷新数据记录 ()
            .如果真结束
            赋值 (.标题, “修改”)
            赋值 (更新记录中, 假)
        .如果真结束
        赋值 (.可视, 假)
        赋值 (.可视, 真)
    .如果真结束
    
.如果结束


.子程序 刷新数据记录, 空白型, , 
.局部变量 temp文本, 文本型, , , 
.局部变量 temp整数, 整数型, , , 
.局部变量 temp小数, 双精度小数型, , , 
.局部变量 temp日期, 日期时间型, , , 
.局部变量 行数, 整数型, , , 

qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
cxjSQL语句.未知支持库函数_14 (#)
赋值 (当前页数, 到数值 (.内容))
未知支持库函数_57 ()
赋值 (., 1)
赋值 (., 11)
赋值 (记录集游标, 相乘 (每页记录数, 相减 (当前页数, 1)))
记录集游标.未知支持库函数_38 ()

未知支持库函数_57 ()
设置高级表格表头 ()
.计次循环首 (每页记录数, 行数)
    赋值 (temp文本, “”)
    “会员编号”.未知支持库函数_26 (temp文本)
    .如果真 (不等于 (temp文本, “”))
        赋值 (., 相加 (., 1))
        “会员编号”.未知支持库函数_26 (temp文本)
        行数.未知支持库函数_9 (0, #., temp文本)
        “会员姓名”.未知支持库函数_26 (temp文本)
        行数.未知支持库函数_9 (1, #., temp文本)
        “姓名拼音”.未知支持库函数_26 (temp文本)
        行数.未知支持库函数_9 (2, #., temp文本)
        “登记日期”.未知支持库函数_31 (temp日期)
        行数.未知支持库函数_9 (3, #., 到文本 (temp日期))
        “会员类型”.未知支持库函数_26 (temp文本)
        行数.未知支持库函数_9 (4, #., temp文本)
        “性别”.未知支持库函数_26 (temp文本)
        行数.未知支持库函数_9 (5, #., temp文本)
        “联系电话”.未知支持库函数_26 (temp文本)
        行数.未知支持库函数_9 (6, #., temp文本)
        “联系地址”.未知支持库函数_26 (temp文本)
        行数.未知支持库函数_9 (7, #., temp文本)
        “账户金额”.未知支持库函数_27 (temp小数)
        行数.未知支持库函数_9 (8, #., temp小数)
        “会员状态”.未知支持库函数_26 (temp文本)
        行数.未知支持库函数_9 (9, #., temp文本)
        “自动编号”.未知支持库函数_29 (temp整数)
        行数.未知支持库函数_9 (10, #., temp整数)
    .如果真结束
    未知支持库函数_36 ()
    读取图书表数据 (行数)
.计次循环尾 ()
#..未知支持库函数_14 (#白色, #银白)
未知支持库函数_16 ()
未知支持库函数_3 ()

.子程序 更新数据库记录, 空白型, , 
.局部变量 pass, 逻辑型, , , 
.局部变量 SQL语句, 文本型, , , 

赋值 (pass, 真)
qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
未知支持库函数_9 ()
赋值 (SQL语句, 相加 (“update 会员表 set 会员编号='”, .内容, “',登记日期=#”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天)), “#,会员姓名='”, .内容, “',姓名拼音='”, .内容, “',会员类型='”, .取项目文本 (.现行选中项), “',性别='”, .取项目文本 (.现行选中项), “',联系电话='”, .内容, “',联系地址='”, .内容, “' where 自动编号=”, .内容))
.如果真 (等于 (SQL语句.未知支持库函数_14 (#), 假))
    赋值 (pass, 假)
.如果真结束
赋值 (SQL语句, 相加 (“update 租借表 set 会员编号='”, .内容, “',会员姓名='”, .内容, “' where 会员编号='”, .内容, “' and 会员姓名='”, .内容, “'”))
.如果真 (等于 (SQL语句.未知支持库函数_14 (#), 假))
    赋值 (pass, 假)
.如果真结束

.如果 (pass)
    未知支持库函数_10 ()
    信息框 (“会员资料修改成功！”, #信息图标, “成功”)
.否则
    未知支持库函数_11 ()
    信息框 (“出现错误,修改失败！”, #错误图标, “错误”)
.如果结束
未知支持库函数_16 ()
未知支持库函数_3 ()

.子程序 初始化子程序, 空白型, , 
清空并禁止所有输入框 ()
设置高级表格表头 ()

.子程序 清空并禁止所有输入框, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.输入方式, 1)
赋值 (.输入方式, 1)
赋值 (.输入方式, 1)
赋值 (.输入方式, 1)
赋值 (.输入方式, 1)
赋值 (.禁止, 真)
赋值 (.现行选中项, -1)
赋值 (.禁止, 真)
赋值 (.现行选中项, -1)
赋值 (.禁止, 真)
赋值 (.标题, “修改”)


.子程序 设置高级表格表头, 空白型, , 
0.未知支持库函数_9 (0, #., “会员编号”)
0.未知支持库函数_32 (180)
0.未知支持库函数_9 (1, #., “会员姓名”)
1.未知支持库函数_32 (60)
0.未知支持库函数_9 (2, #., “姓名拼音”)
2.未知支持库函数_32 (60)
0.未知支持库函数_9 (3, #., “登记日期”)
3.未知支持库函数_32 (80)
0.未知支持库函数_9 (4, #., “会员类型”)
4.未知支持库函数_32 (80)
0.未知支持库函数_9 (5, #., “性别”)
5.未知支持库函数_32 (40)
0.未知支持库函数_9 (6, #., “联系电话”)
6.未知支持库函数_32 (100)
0.未知支持库函数_9 (7, #., “联系地址”)
7.未知支持库函数_32 (200)
0.未知支持库函数_9 (8, #., “账户金额”)
8.未知支持库函数_32 (60)
0.未知支持库函数_9 (9, #., “会员情况”)
9.未知支持库函数_32 (60)
0.未知支持库函数_9 (10, #., “附加号”)
10.未知支持库函数_32 (60)

.子程序 _高级表格1_光标位置改变, 空白型, , 
.局部变量 光标行号, 整数型, , , 

赋值 (光标行号, 未知支持库函数_3 ())
.如果真 (不等于 (光标行号, -1))
    清空并禁止所有输入框 ()
    赋值 (.内容, 光标行号.未知支持库函数_10 (0))
    赋值 (.内容, 光标行号.未知支持库函数_10 (1))
    赋值 (.内容, 光标行号.未知支持库函数_10 (0))
    赋值 (.内容, 光标行号.未知支持库函数_10 (1))
    赋值 (.内容, 光标行号.未知支持库函数_10 (2))
    赋值 (.今天, 到时间 (光标行号.未知支持库函数_10 (3)))
    光标行号.未知支持库函数_10 (4).选择 ()
    光标行号.未知支持库函数_10 (5).选择 ()
    赋值 (.内容, 光标行号.未知支持库函数_10 (6))
    赋值 (.内容, 光标行号.未知支持库函数_10 (7))
    赋值 (.内容, 光标行号.未知支持库函数_10 (8))
    赋值 (.内容, 光标行号.未知支持库函数_10 (9))
    赋值 (.内容, 光标行号.未知支持库函数_10 (10))
    读取相关信息 ()
.如果真结束


.子程序 读取相关信息, 空白型, , 
.局部变量 temp文本, 文本型, , , 
.局部变量 temp日期, 日期时间型, , , 
.局部变量 temp整数, 整数型, , , 
.局部变量 行数, 整数型, , , 

qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
相加 (“select 条形码,图书名称,借书日期 from 租借表 where 会员编号='”, .内容, “' and 是否归还='否'”).未知支持库函数_14 (#)
赋值 (.标题, 到文本 (.))
全部删除 ()
.计次循环首 (., 行数)
    .插入表项 ()
    “条形码”.未知支持库函数_26 (temp文本)
    相减 (行数, 1).置标题 (0, temp文本)
    “图书名称”.未知支持库函数_26 (temp文本)
    相减 (行数, 1).置标题 (1, temp文本)
    “借书日期”.未知支持库函数_31 (temp日期)
    相减 (行数, 1).置标题 (2, 到文本 (temp日期))
    未知支持库函数_36 ()
.计次循环尾 ()
未知支持库函数_16 ()
相加 (“select 借书本数 from 会员表 where 会员编号='”, .内容, “'”).未知支持库函数_14 (#)
“借书本数”.未知支持库函数_29 (temp整数)
赋值 (.标题, 到文本 (temp整数))
未知支持库函数_16 ()
未知支持库函数_3 ()

.子程序 计算总页数, 整数型, , 
.判断开始 (等于 (寻找文本 (到文本 (相除 (总记录数, 每页记录数)), “.”, , 假), -1)) ' -1为未找到小数点
    返回 (取整 (相除 (总记录数, 每页记录数)))
.默认
    返回 (相加 (取整 (相除 (总记录数, 每页记录数)), 1))
.判断结束


.子程序 _第一页按钮_被单击, 空白型, , 
.局部变量 行数, 整数型, , , 

赋值 (每页记录数, 9)
赋值 (总记录数, .)
赋值 (总页数, 计算总页数 ())
赋值 (.内容, 到文本 (总页数))

赋值 (当前页数, 1)
赋值 (., 1)
赋值 (., 11)

连续赋值 (假, .禁止, .禁止, .禁止, .禁止)
赋值 (记录集游标, 0)
记录集游标.未知支持库函数_38 ()
赋值 (.内容, 到文本 (当前页数))
未知支持库函数_57 ()

设置高级表格表头 ()
.计次循环首 (每页记录数, 行数)
    读取图书表数据 (行数)
.计次循环尾 ()
#..未知支持库函数_14 (#白色, #银白)


连续赋值 (真, .禁止, .禁止)
.如果真 (小于 (总记录数, 每页记录数))
    连续赋值 (真, .禁止, .禁止, .禁止, .禁止)
.如果真结束


.子程序 _下一页按钮_被单击, 空白型, , 
.局部变量 行数, 整数型, , , 

赋值 (每页记录数, 9)
赋值 (总记录数, .)
赋值 (总页数, 计算总页数 ())
赋值 (.内容, 到文本 (总页数))

赋值 (当前页数, 相加 (当前页数, 1))
未知支持库函数_57 ()
赋值 (., 1)
赋值 (., 11)
赋值 (记录集游标, 相乘 (每页记录数, 相减 (当前页数, 1)))
记录集游标.未知支持库函数_38 ()
连续赋值 (假, .禁止, .禁止, .禁止, .禁止)

设置高级表格表头 ()
.计次循环首 (每页记录数, 行数)
    读取图书表数据 (行数)
.计次循环尾 ()
#..未知支持库函数_14 (#白色, #银白)

赋值 (.内容, 到文本 (当前页数))
.如果真 (大于或等于 (当前页数, 总页数))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.如果真结束


.子程序 _上一页按钮_被单击, 空白型, , 
.局部变量 行数, 整数型, , , 

赋值 (每页记录数, 9)
赋值 (总记录数, .)
赋值 (总页数, 计算总页数 ())
赋值 (.内容, 到文本 (总页数))

赋值 (当前页数, 相减 (当前页数, 1))
未知支持库函数_57 ()
赋值 (总记录数, .)
赋值 (., 1)
赋值 (., 11)

连续赋值 (假, .禁止, .禁止, .禁止, .禁止)
赋值 (记录集游标, 相乘 (每页记录数, 相减 (当前页数, 1)))
记录集游标.未知支持库函数_38 ()

设置高级表格表头 ()
.计次循环首 (每页记录数, 行数)
    读取图书表数据 (行数)
.计次循环尾 ()
#..未知支持库函数_14 (#白色, #银白)

赋值 (.内容, 到文本 (当前页数))
.如果真 (小于或等于 (当前页数, 1))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.如果真结束


.子程序 _最后一页按钮_被单击, 空白型, , 
.局部变量 行数, 整数型, , , 

赋值 (每页记录数, 9)
赋值 (总记录数, .)
赋值 (总页数, 计算总页数 ())
赋值 (.内容, 到文本 (总页数))

赋值 (当前页数, 总页数)
未知支持库函数_57 ()
赋值 (总记录数, .)
赋值 (., 1)
赋值 (., 11)

连续赋值 (假, .禁止, .禁止, .禁止, .禁止)
赋值 (记录集游标, 相乘 (每页记录数, 相减 (当前页数, 1)))
记录集游标.未知支持库函数_38 ()

设置高级表格表头 ()
.计次循环首 (每页记录数, 行数)
    读取图书表数据 (行数)
.计次循环尾 ()
#..未知支持库函数_14 (#白色, #银白)

赋值 (.内容, 到文本 (当前页数))
.如果真 (大于或等于 (当前页数, 总页数))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.如果真结束



.子程序 读取图书表数据, 空白型, , 
.参数 行数, 整数型, , 

.局部变量 temp文本, 文本型, , , 
.局部变量 temp整数, 整数型, , , 
.局部变量 temp小数, 双精度小数型, , , 
.局部变量 temp日期, 日期时间型, , , 

赋值 (temp文本, “”)
“会员编号”.未知支持库函数_26 (temp文本)
.如果真 (不等于 (temp文本, “”))
    赋值 (., 相加 (., 1))
    “会员编号”.未知支持库函数_26 (temp文本)
    行数.未知支持库函数_9 (0, #., temp文本)
    “会员姓名”.未知支持库函数_26 (temp文本)
    行数.未知支持库函数_9 (1, #., temp文本)
    “姓名拼音”.未知支持库函数_26 (temp文本)
    行数.未知支持库函数_9 (2, #., temp文本)
    “登记日期”.未知支持库函数_31 (temp日期)
    行数.未知支持库函数_9 (3, #., 到文本 (temp日期))
    “会员类型”.未知支持库函数_26 (temp文本)
    行数.未知支持库函数_9 (4, #., temp文本)
    “性别”.未知支持库函数_26 (temp文本)
    行数.未知支持库函数_9 (5, #., temp文本)
    “联系电话”.未知支持库函数_26 (temp文本)
    行数.未知支持库函数_9 (6, #., temp文本)
    “联系地址”.未知支持库函数_26 (temp文本)
    行数.未知支持库函数_9 (7, #., temp文本)
    “帐户金额”.未知支持库函数_27 (temp小数)
    行数.未知支持库函数_9 (8, #., 四舍五入 (temp小数, 2))
    “会员状态”.未知支持库函数_26 (temp文本)
    行数.未知支持库函数_9 (9, #., temp文本)
    “自动编号”.未知支持库函数_29 (temp整数)
    行数.未知支持库函数_9 (10, #., temp整数)
.如果真结束
未知支持库函数_36 ()


.子程序 _查询_被单击, 空白型, , 
.如果真 (等于 (.现行选中项, -1))
    返回 ()
.如果真结束
.如果真 (等于 (.现行选中项, -1))
    返回 ()
.如果真结束
.如果真 (等于 (删全部空 (.内容), “”))
    返回 ()
.如果真结束
.如果真 (等于 (.现行选中项, 0))
    赋值 (temp查询符号, “=”)
.如果真结束
.如果真 (等于 (.现行选中项, 1))
    赋值 (temp查询符号, “like”)
.如果真结束
.如果真 (等于 (.现行选中项, 2))
    赋值 (temp查询符号, “>”)
.如果真结束
.如果真 (等于 (.现行选中项, 3))
    赋值 (temp查询符号, “<”)
.如果真结束
.如果真 (等于 (.现行选中项, 4))
    赋值 (temp查询符号, “>=”)
.如果真结束
.如果真 (等于 (.现行选中项, 5))
    赋值 (temp查询符号, “<=”)
.如果真结束
.如果 (不等于 (temp查询符号, “like”))
    赋值 (cxjSQL语句, 相加 (“select * from 会员表 where ”, .取项目文本 (.现行选中项), temp查询符号, “'”, .内容, “'”))
.否则
    赋值 (cxjSQL语句, 相加 (“select * from 会员表 where ”, .取项目文本 (.现行选中项), “ ”, temp查询符号, “ '%”, .内容, “%'”))
.如果结束
.如果真 (.)
    未知支持库函数_16 ()
.如果真结束
cxjSQL语句.未知支持库函数_14 (#)
赋值 (.标题, 相加 (“找到记录: ”, 到文本 (.), “ 条”))
_第一页按钮_被单击 ()

.子程序 _查询依据_列表项被选择, 空白型, , 
.如果真 (等于 (.现行选中项, 0))
    清空 ()
    “等于”.加入项目 ()
.如果真结束
.如果真 (等于 (.现行选中项, 1))
    清空 ()
    “等于”.加入项目 ()
    “约等于”.加入项目 ()
.如果真结束
.如果真 (等于 (.现行选中项, 2))
    清空 ()
    “等于”.加入项目 ()
    “约等于”.加入项目 ()
.如果真结束
.如果真 (等于 (.现行选中项, 3))
    清空 ()
    “等于”.加入项目 ()
    “约等于”.加入项目 ()
.如果真结束
.如果真 (等于 (.现行选中项, 4))
    清空 ()
    “等于”.加入项目 ()
    “约等于”.加入项目 ()
.如果真结束


.子程序 _会员姓名_内容被改变, 空白型, , 
赋值 (.内容, 取首拼 ())


.子程序 _取消_被单击, 空白型, , 
.如果真 (等于 (未知支持库函数_3 (), -1))
    返回 ()
.如果真结束
_高级表格1_光标位置改变 ()

.子程序 _会员编号_获得焦点, 空白型, , 
.如果真 (等于 (.标题, “保存”))
    赋值 (.背景颜色, #黄色)
.如果真结束


.子程序 _会员编号_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)


.子程序 _会员姓名_获得焦点, 空白型, , 
.如果真 (等于 (.标题, “保存”))
    赋值 (.背景颜色, #黄色)
.如果真结束


.子程序 _会员姓名_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)

.子程序 _姓名拼音_获得焦点, 空白型, , 
.如果真 (等于 (.标题, “保存”))
    赋值 (.背景颜色, #黄色)
.如果真结束


.子程序 _姓名拼音_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)


.子程序 _会员类型_获得焦点, 空白型, , 
.如果真 (等于 (.标题, “保存”))
    赋值 (.背景颜色, #黄色)
.如果真结束


.子程序 _会员类型_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)


.子程序 _联系电话_获得焦点, 空白型, , 
.如果真 (等于 (.标题, “保存”))
    赋值 (.背景颜色, #黄色)
.如果真结束


.子程序 _联系电话_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)

.子程序 _联系地址_获得焦点, 空白型, , 
.如果真 (等于 (.标题, “保存”))
    赋值 (.背景颜色, #黄色)
.如果真结束


.子程序 _联系地址_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)


.子程序 _性别_获得焦点, 空白型, , 
.如果真 (等于 (.标题, “保存”))
    赋值 (.背景颜色, #黄色)
.如果真结束


.子程序 _性别_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)


.子程序 _删除_被单击, 空白型, , 
.局部变量 pass, 逻辑型, , , 

.如果真 (或者 (等于 (.内容, “”), 等于 (.标题, “保存”)))
    信息框 (“没有选中欲删除的记录 或 记录正处于修改状态”, #警告图标, “提示”)
    赋值 (.可视, 假)
    赋值 (.可视, 真)
    返回 ()
.如果真结束
赋值 (pass, 假)
赋值 (pass, qj数据库路径.未知支持库函数_1 (qj数据库密码))
.如果真 (等于 (pass, 假))
    信息框 (“连接数据库出错,终止！”, #错误图标, “错误”)
    赋值 (.可视, 假)
    赋值 (.可视, 真)
    未知支持库函数_3 ()
    返回 ()
.如果真结束
.未知支持库函数_12 ()
赋值 (pass, 相加 (“select 会员编号 from 租借表 where 会员编号='”, .内容, “' and 是否归还='否'”).未知支持库函数_14 (#))
.如果真 (等于 (pass, 假))
    信息框 (“读取租借表出错,终止！”, #错误图标, “错误”)
    赋值 (.可视, 假)
    赋值 (.可视, 真)
    未知支持库函数_16 ()
    未知支持库函数_3 ()
    返回 ()
.如果真结束
.如果真 (大于 (., 0))
    信息框 (“该会员还有书籍没有归还,不能删除!”, #警告图标, “提示”)
    赋值 (.可视, 假)
    赋值 (.可视, 真)
    未知支持库函数_16 ()
    未知支持库函数_3 ()
    返回 ()
.如果真结束
未知支持库函数_16 ()
赋值 (pass, 相加 (“select 帐户金额 from 会员表 where 会员编号='”, .内容, “' and 帐户金额>0”).未知支持库函数_14 (#))
.如果真 (等于 (pass, 假))
    信息框 (“读取会员表出错,终止！”, #错误图标, “错误”)
    未知支持库函数_16 ()
    未知支持库函数_3 ()
    返回 ()
.如果真结束
.如果真 (大于 (., 0))
    信息框 (“该会员帐户中还有金额,不能删除”, #警告图标, “提示”)
    赋值 (.可视, 假)
    赋值 (.可视, 真)
    未知支持库函数_16 ()
    未知支持库函数_3 ()
    返回 ()
.如果真结束
未知支持库函数_16 ()
赋值 (pass, 相加 (“delete * from 会员表 where 会员编号='”, .内容, “'”).未知支持库函数_14 (#))
.如果 (pass)
    信息框 (“删除会员成功！”, #信息图标, “成功”)
    赋值 (.可视, 假)
    赋值 (.可视, 真)
    清空并禁止所有输入框 ()
    刷新数据记录 ()
.否则
    信息框 (“删除会员失败！”, #错误图标, “失败”)
    赋值 (.可视, 假)
    赋值 (.可视, 真)
.如果结束
未知支持库函数_16 ()
未知支持库函数_3 ()


.子程序 _查询条件_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)
.如果真 (等于 (.取项目文本 (.现行选中项), “会员编号”))
    赋值 (.内容, 不满13位编码补位 (.内容))
.如果真结束
.如果真 (大于 (取文本长度 (删全部空 (.内容)), 0))
    _查询_被单击 ()
.如果真结束


.子程序 _查询条件_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _透明标签7_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (不等于 (未知支持库函数_3 (), -1))
    赋值 (.可视, 真)
    赋值 (.禁止, 真)
    赋值 (., 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.如果真结束


.子程序 _关闭_被单击, 空白型, , 
赋值 (.可视, 假)
赋值 (.禁止, 假)
赋值 (., 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)

.子程序 _高级表格1_被单击, 空白型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 

_高级表格1_光标位置改变 ()


.窗口程序集 租借列表程序集, , , 

.程序集变量 每页记录数, 整数型, , , 
.程序集变量 总记录数, 整数型, , , 
.程序集变量 记录集游标, 整数型, , , 
.程序集变量 当前页数, 整数型, , , 
.程序集变量 总页数, 整数型, , , 
.程序集变量 temp查询符号, 文本型, , , 
.程序集变量 temp查询符号1, 文本型, , , 
.程序集变量 cxjSQL语句, 文本型, , , 
.子程序 控件定位, 空白型, , 
赋值 (.左边, 相除 (相减 (ck租借列表.取用户区宽度 (), .宽度), 3))
赋值 (.顶边, 相除 (相减 (ck租借列表.取用户区高度 (), .高度), 2))
0.移动 (0, ck租借列表.取用户区宽度 (), ck租借列表.取用户区高度 ())

.子程序 _ck租借列表_位置被改变, 空白型, , 
控件定位 ()


.子程序 _ck租借列表_尺寸被改变, 空白型, , 
控件定位 ()


.子程序 _ck租借列表_创建完毕, 空白型, , 
.未知支持库函数_20 (“点解查看会员详细”, -1, , , , )
.未知支持库函数_20 (“点解查看书籍详细”, -1, , , , )
数据库连接器.未知支持库函数_12 ()
初始化子程序 ()

.子程序 初始化子程序, 空白型, , 
清空并禁止所有输入框 ()
设置高级表格表头 ()

.子程序 清空并禁止所有输入框, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “0”)
赋值 (.内容, “0”)
赋值 (.内容, “0”)

.子程序 设置高级表格表头, 空白型, , 
0.未知支持库函数_9 (0, #., “会员编号”)
0.未知支持库函数_32 (180)
0.未知支持库函数_9 (1, #., “会员姓名”)
1.未知支持库函数_32 (60)
0.未知支持库函数_9 (2, #., “条形码”)
2.未知支持库函数_32 (180)
0.未知支持库函数_9 (3, #., “书籍名称”)
3.未知支持库函数_32 (100)
0.未知支持库函数_9 (4, #., “借书日期”)
4.未知支持库函数_32 (120)
0.未知支持库函数_9 (5, #., “日租金”)
5.未知支持库函数_32 (50)
0.未知支持库函数_9 (6, #., “本书押金”)
6.未知支持库函数_32 (60)
0.未知支持库函数_9 (7, #., “合计租金”)
7.未知支持库函数_32 (60)
0.未知支持库函数_9 (8, #., “是否归还”)
8.未知支持库函数_32 (60)
0.未知支持库函数_9 (9, #., “附加号”)
8.未知支持库函数_32 (60)

.子程序 _高级表格1_光标位置改变, 空白型, , 
.局部变量 光标行号, 整数型, , , 


赋值 (光标行号, 未知支持库函数_3 ())
.如果真 (不等于 (光标行号, -1))
    清空并禁止所有输入框 ()
    赋值 (.内容, 光标行号.未知支持库函数_10 (0))
    赋值 (.内容, 光标行号.未知支持库函数_10 (1))
    赋值 (.内容, 光标行号.未知支持库函数_10 (2))
    赋值 (.内容, 光标行号.未知支持库函数_10 (3))
    赋值 (.内容, 光标行号.未知支持库函数_10 (4))
    赋值 (.内容, 光标行号.未知支持库函数_10 (5))
    赋值 (.内容, 光标行号.未知支持库函数_10 (6))
    赋值 (.内容, 光标行号.未知支持库函数_10 (7))
    赋值 (.内容, 光标行号.未知支持库函数_10 (8))
    赋值 (.内容, 光标行号.未知支持库函数_10 (9))
    读取相关信息 ()
.如果真结束


.子程序 读取相关信息, 空白型, , 
.局部变量 temp文本, 文本型, , , 
.局部变量 temp日期, 日期时间型, , , 
.局部变量 temp整数, 整数型, , , 
.局部变量 temp小数, 双精度小数型, , , 
.局部变量 行数, 整数型, , , 

qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
相加 (“select * from 会员表 where 会员编号='”, .内容, “'”).未知支持库函数_14 (#)
“登记日期”.未知支持库函数_31 (temp日期)
赋值 (.标题, 到文本 (temp日期))
“性别”.未知支持库函数_26 (temp文本)
赋值 (.标题, temp文本)
“联系电话”.未知支持库函数_26 (temp文本)
赋值 (.标题, temp文本)
“联系地址”.未知支持库函数_26 (temp文本)
赋值 (.标题, temp文本)
“会员类型”.未知支持库函数_26 (temp文本)
赋值 (.标题, temp文本)
“帐户金额”.未知支持库函数_27 (temp小数)
赋值 (.标题, 到文本 (temp小数))
“借书本数”.未知支持库函数_29 (temp整数)
赋值 (.标题, 到文本 (temp整数))
“会员状态”.未知支持库函数_26 (temp文本)
赋值 (.标题, temp文本)
未知支持库函数_16 ()
相加 (“select * from 图书表 where 条形码='”, .内容, “' and 图书名称='”, .内容, “'”).未知支持库函数_14 (#)
“入库日期”.未知支持库函数_31 (temp日期)
赋值 (.标题, 到文本 (temp日期))
“出版社”.未知支持库函数_26 (temp文本)
赋值 (.标题, temp文本)
“作者”.未知支持库函数_26 (temp文本)
赋值 (.标题, temp文本)
“类型”.未知支持库函数_26 (temp文本)
赋值 (.标题, temp文本)
“定价”.未知支持库函数_27 (temp小数)
赋值 (.标题, 到文本 (temp小数))
“进货价”.未知支持库函数_27 (temp小数)
赋值 (.标题, 到文本 (temp小数))
“拥有数量”.未知支持库函数_29 (temp整数)
赋值 (.标题, 到文本 (temp整数))
“被借次数”.未知支持库函数_29 (temp整数)
赋值 (.标题, 到文本 (temp整数))
“是否借出”.未知支持库函数_29 (temp整数)
.如果 (大于或等于 (temp整数, 到数值 (.标题)))
    赋值 (.标题, “无库存”)
.否则
    赋值 (.标题, “有库存”)
.如果结束
未知支持库函数_16 ()
未知支持库函数_3 ()

.子程序 计算总页数, 整数型, , 
.判断开始 (等于 (寻找文本 (到文本 (相除 (总记录数, 每页记录数)), “.”, , 假), -1)) ' -1为未找到小数点
    返回 (取整 (相除 (总记录数, 每页记录数)))
.默认
    返回 (相加 (取整 (相除 (总记录数, 每页记录数)), 1))
.判断结束


.子程序 _第一页按钮_被单击, 空白型, , 
.局部变量 行数, 整数型, , , 

赋值 (每页记录数, 9)
赋值 (总记录数, .)
赋值 (总页数, 计算总页数 ())
赋值 (.内容, 到文本 (总页数))

赋值 (当前页数, 1)
赋值 (., 1)
赋值 (., 10)

连续赋值 (假, .禁止, .禁止, .禁止, .禁止)
赋值 (记录集游标, 0)
记录集游标.未知支持库函数_38 ()
赋值 (.内容, 到文本 (当前页数))
未知支持库函数_57 ()

设置高级表格表头 ()
.计次循环首 (每页记录数, 行数)
    读取租借表数据 (行数)
.计次循环尾 ()
#..未知支持库函数_14 (#白色, #银白)


连续赋值 (真, .禁止, .禁止)
.如果真 (小于 (总记录数, 每页记录数))
    连续赋值 (真, .禁止, .禁止, .禁止, .禁止)
.如果真结束


.子程序 _下一页按钮_被单击, 空白型, , 
.局部变量 行数, 整数型, , , 

赋值 (每页记录数, 9)
赋值 (总记录数, .)
赋值 (总页数, 计算总页数 ())
赋值 (.内容, 到文本 (总页数))

赋值 (当前页数, 相加 (当前页数, 1))
未知支持库函数_57 ()
赋值 (., 1)
赋值 (., 10)
赋值 (记录集游标, 相乘 (每页记录数, 相减 (当前页数, 1)))
记录集游标.未知支持库函数_38 ()
连续赋值 (假, .禁止, .禁止, .禁止, .禁止)

设置高级表格表头 ()
.计次循环首 (每页记录数, 行数)
    读取租借表数据 (行数)
.计次循环尾 ()
#..未知支持库函数_14 (#白色, #银白)

赋值 (.内容, 到文本 (当前页数))
.如果真 (大于或等于 (当前页数, 总页数))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.如果真结束


.子程序 _上一页按钮_被单击, 空白型, , 
.局部变量 行数, 整数型, , , 

赋值 (每页记录数, 9)
赋值 (总记录数, .)
赋值 (总页数, 计算总页数 ())
赋值 (.内容, 到文本 (总页数))

赋值 (当前页数, 相减 (当前页数, 1))
未知支持库函数_57 ()
赋值 (总记录数, .)
赋值 (., 1)
赋值 (., 10)

连续赋值 (假, .禁止, .禁止, .禁止, .禁止)
赋值 (记录集游标, 相乘 (每页记录数, 相减 (当前页数, 1)))
记录集游标.未知支持库函数_38 ()

设置高级表格表头 ()
.计次循环首 (每页记录数, 行数)
    读取租借表数据 (行数)
.计次循环尾 ()
#..未知支持库函数_14 (#白色, #银白)

赋值 (.内容, 到文本 (当前页数))
.如果真 (小于或等于 (当前页数, 1))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.如果真结束


.子程序 _最后一页按钮_被单击, 空白型, , 
.局部变量 行数, 整数型, , , 

赋值 (每页记录数, 9)
赋值 (总记录数, .)
赋值 (总页数, 计算总页数 ())
赋值 (.内容, 到文本 (总页数))

赋值 (当前页数, 总页数)
未知支持库函数_57 ()
赋值 (总记录数, .)
赋值 (., 1)
赋值 (., 10)

连续赋值 (假, .禁止, .禁止, .禁止, .禁止)
赋值 (记录集游标, 相乘 (每页记录数, 相减 (当前页数, 1)))
记录集游标.未知支持库函数_38 ()

设置高级表格表头 ()
.计次循环首 (每页记录数, 行数)
    读取租借表数据 (行数)
.计次循环尾 ()
#..未知支持库函数_14 (#白色, #银白)

赋值 (.内容, 到文本 (当前页数))
.如果真 (大于或等于 (当前页数, 总页数))
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.如果真结束



.子程序 读取租借表数据, 空白型, , 
.参数 行数, 整数型, , 

.局部变量 temp文本, 文本型, , , 
.局部变量 temp整数, 整数型, , , 
.局部变量 temp小数, 双精度小数型, , , 
.局部变量 temp日期, 日期时间型, , , 

赋值 (temp文本, “”)
“会员编号”.未知支持库函数_26 (temp文本)
.如果真 (不等于 (temp文本, “”))
    赋值 (., 相加 (., 1))
    “会员编号”.未知支持库函数_26 (temp文本)
    行数.未知支持库函数_9 (0, #., temp文本)
    “会员姓名”.未知支持库函数_26 (temp文本)
    行数.未知支持库函数_9 (1, #., temp文本)
    “条形码”.未知支持库函数_26 (temp文本)
    行数.未知支持库函数_9 (2, #., temp文本)
    “图书名称”.未知支持库函数_26 (temp文本)
    行数.未知支持库函数_9 (3, #., temp文本)
    “借书日期”.未知支持库函数_26 (temp文本)
    行数.未知支持库函数_9 (4, #., temp文本)
    “日租金”.未知支持库函数_27 (temp小数)
    行数.未知支持库函数_9 (5, #., 四舍五入 (temp小数, 2))
    “本书押金”.未知支持库函数_27 (temp小数)
    行数.未知支持库函数_9 (6, #., 四舍五入 (temp小数, 2))
    “合计租金”.未知支持库函数_27 (temp小数)
    行数.未知支持库函数_9 (7, #., 四舍五入 (temp小数, 2))
    “是否归还”.未知支持库函数_26 (temp文本)
    行数.未知支持库函数_9 (8, #., temp文本)
    “自动编号”.未知支持库函数_29 (temp整数)
    行数.未知支持库函数_9 (9, #., temp整数)
.如果真结束
未知支持库函数_36 ()


.子程序 _查询_被单击, 空白型, , 
.如果真 (等于 (.现行选中项, -1))
    返回 ()
.如果真结束
.如果真 (等于 (.现行选中项, -1))
    返回 ()
.如果真结束
.如果真 (不等于 (.取项目文本 (.现行选中项), “借书日期”))
    .如果真 (等于 (删全部空 (.内容), “”))
        返回 ()
    .如果真结束
    
.如果真结束
.如果真 (等于 (.取项目文本 (.现行选中项), “等于”))
    赋值 (temp查询符号, “=”)
.如果真结束
.如果真 (等于 (.取项目文本 (.现行选中项), “约等于”))
    赋值 (temp查询符号, “like”)
.如果真结束
.如果真 (等于 (.取项目文本 (.现行选中项), “大于”))
    赋值 (temp查询符号, “>”)
.如果真结束
.如果真 (等于 (.取项目文本 (.现行选中项), “小于”))
    赋值 (temp查询符号, “<”)
.如果真结束
.如果真 (等于 (.取项目文本 (.现行选中项), “大于或等于”))
    赋值 (temp查询符号, “>=”)
.如果真结束
.如果真 (等于 (.取项目文本 (.现行选中项), “小于或等于”))
    赋值 (temp查询符号, “<=”)
.如果真结束

.如果 (等于 (.取项目文本 (.现行选中项), “借书日期”))
    .如果 (不等于 (temp查询符号, “like”))
        赋值 (cxjSQL语句, 相加 (“select * from 租借表 where 借书日期”, temp查询符号, “#”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天)), “#”))
    .否则
        赋值 (cxjSQL语句, 相加 (“select * from 租借表 where 借书日期>#”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天)), “ 00:00:00# and 借书日期<#”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天)), “ 23:59:59#”))
    .如果结束
    .如果真 (.)
        未知支持库函数_16 ()
    .如果真结束
    .如果真 (.选中)
        .如果 (.选中)
            赋值 (cxjSQL语句, 相加 (cxjSQL语句, “ and 是否归还='是'”))
        .否则
            赋值 (cxjSQL语句, 相加 (cxjSQL语句, “ and 是否归还='否'”))
        .如果结束
        
    .如果真结束
    .如果真 (.选中)
        .如果真 (等于 (.取项目文本 (.现行选中项), “大于”))
            赋值 (temp查询符号1, “>”)
        .如果真结束
        .如果真 (等于 (.取项目文本 (.现行选中项), “小于”))
            赋值 (temp查询符号1, “<”)
        .如果真结束
        赋值 (cxjSQL语句, 相加 (cxjSQL语句, “ and 借书日期”, temp查询符号1, “#”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天)), “#”))
    .如果真结束
    
    cxjSQL语句.未知支持库函数_14 (#)
    赋值 (.标题, 相加 (“找到记录: ”, 到文本 (.), “ 条”))
    _第一页按钮_被单击 ()
    返回 ()
    
    
.否则
    .如果 (不等于 (temp查询符号, “like”))
        赋值 (cxjSQL语句, 相加 (“select * from 租借表 where ”, .取项目文本 (.现行选中项), temp查询符号, “'”, .内容, “'”))
        .如果真 (并且 (不等于 (.取项目文本 (.现行选中项), “是否归还”), 不等于 (.取项目文本 (.现行选中项), “条形码”), 不等于 (.取项目文本 (.现行选中项), “会员编号”), 不等于 (.取项目文本 (.现行选中项), “图书名称”), 不等于 (.取项目文本 (.现行选中项), “会员姓名”)))
            .如果真 (等于 (temp查询符号, “=”))
                赋值 (cxjSQL语句, 相加 (“select * from 租借表 where ”, .取项目文本 (.现行选中项), temp查询符号, .内容))
            .如果真结束
            
        .如果真结束
        .如果真 (或者 (等于 (temp查询符号, “>”), 等于 (temp查询符号, “<”)))
            赋值 (cxjSQL语句, 相加 (“select * from 租借表 where ”, .取项目文本 (.现行选中项), temp查询符号, .内容))
        .如果真结束
        .如果真 (等于 (temp查询符号, “>=”))
            赋值 (cxjSQL语句, 相加 (“select * from 租借表 where ”, .取项目文本 (.现行选中项), “>”, .内容))
            .如果真 (.选中)
                .如果 (.选中)
                    赋值 (cxjSQL语句, 相加 (cxjSQL语句, “ and 是否归还='是'”))
                .否则
                    赋值 (cxjSQL语句, 相加 (cxjSQL语句, “ and 是否归还='否'”))
                .如果结束
                
            .如果真结束
            赋值 (cxjSQL语句, 相加 (cxjSQL语句, “ or ”, .取项目文本 (.现行选中项), “=”, .内容))
        .如果真结束
        .如果真 (等于 (temp查询符号, “<=”))
            赋值 (cxjSQL语句, 相加 (“select * from 租借表 where ”, .取项目文本 (.现行选中项), “<”, .内容))
            .如果真 (.选中)
                .如果 (.选中)
                    赋值 (cxjSQL语句, 相加 (cxjSQL语句, “ and 是否归还='是'”))
                .否则
                    赋值 (cxjSQL语句, 相加 (cxjSQL语句, “ and 是否归还='否'”))
                .如果结束
                
            .如果真结束
            赋值 (cxjSQL语句, 相加 (cxjSQL语句, “ or ”, .取项目文本 (.现行选中项), “=”, .内容))
        .如果真结束
        
    .否则
        赋值 (cxjSQL语句, 相加 (“select * from 租借表 where ”, .取项目文本 (.现行选中项), “ ”, temp查询符号, “ '%”, .内容, “%'”))
    .如果结束
    .如果真 (.)
        未知支持库函数_16 ()
    .如果真结束
    .如果真 (或者 (不等于 (temp查询符号, “>=”), 不等于 (temp查询符号, “<=”)))
        .如果真 (.选中)
            .如果 (.选中)
                赋值 (cxjSQL语句, 相加 (cxjSQL语句, “ and 是否归还='是'”))
            .否则
                赋值 (cxjSQL语句, 相加 (cxjSQL语句, “ and 是否归还='否'”))
            .如果结束
            
        .如果真结束
        
    .如果真结束
    .如果真 (.选中)
        .如果真 (等于 (.取项目文本 (.现行选中项), “大于”))
            赋值 (temp查询符号1, “>”)
        .如果真结束
        .如果真 (等于 (.取项目文本 (.现行选中项), “小于”))
            赋值 (temp查询符号1, “<”)
        .如果真结束
        赋值 (cxjSQL语句, 相加 (cxjSQL语句, “ and 借书日期”, temp查询符号1, “#”, 到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天)), “#”))
    .如果真结束
    cxjSQL语句.未知支持库函数_14 (#)
    赋值 (.标题, 相加 (“找到记录: ”, 到文本 (.), “ 条”))
    _第一页按钮_被单击 ()
.如果结束



.子程序 _查询依据_列表项被选择, 空白型, , 
.如果真 (等于 (.现行选中项, 0)) ' 会员编号
    清空 ()
    “等于”.加入项目 ()
    隐藏或显示 ()
.如果真结束
.如果真 (等于 (.现行选中项, 1)) ' 会员姓名
    清空 ()
    “等于”.加入项目 ()
    “约等于”.加入项目 ()
    隐藏或显示 ()
.如果真结束
.如果真 (等于 (.现行选中项, 2)) ' 条形码
    清空 ()
    “等于”.加入项目 ()
    隐藏或显示 ()
.如果真结束
.如果真 (等于 (.现行选中项, 3)) ' 书籍名称
    清空 ()
    “等于”.加入项目 ()
    “约等于”.加入项目 ()
    隐藏或显示 ()
.如果真结束
.如果真 (等于 (.现行选中项, 4)) ' 本书押金
    清空 ()
    “等于”.加入项目 ()
    “约等于”.加入项目 ()
    “大于”.加入项目 ()
    “小于”.加入项目 ()
    “大于或等于”.加入项目 ()
    “小于或等于”.加入项目 ()
    隐藏或显示 ()
.如果真结束
.如果真 (等于 (.现行选中项, 5)) ' 借书日期
    清空 ()
    “约等于”.加入项目 ()
    “大于”.加入项目 ()
    “小于”.加入项目 ()
    隐藏或显示 ()
.如果真结束
.如果真 (等于 (.现行选中项, 6)) ' 日租金
    清空 ()
    “等于”.加入项目 ()
    “大于”.加入项目 ()
    “小于”.加入项目 ()
    “大于或等于”.加入项目 ()
    “小于或等于”.加入项目 ()
    隐藏或显示 ()
.如果真结束
.如果真 (等于 (.现行选中项, 7)) ' 是否归还
    清空 ()
    “等于”.加入项目 ()
    隐藏或显示 ()
.如果真结束


.子程序 隐藏或显示, 空白型, , 
.如果 (等于 (.现行选中项, 5))
    赋值 (.可视, 假)
    赋值 (.可视, 真)
.否则
    赋值 (.可视, 真)
    赋值 (.可视, 假)
    
.如果结束


.子程序 _使用附加依据_被单击, 空白型, , 
.如果 (.选中)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
.否则
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    
.如果结束


.子程序 _使用是否归还_被单击, 空白型, , 
.如果 (.选中)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
.否则
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    
.如果结束


.子程序 _查询条件_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)

.子程序 _查询条件_失去焦点, 空白型, , 
赋值 (.背景颜色, #银白)
.如果真 (或者 (等于 (.取项目文本 (.现行选中项), “条形码”), 等于 (.取项目文本 (.现行选中项), “会员编号”)))
    赋值 (.内容, 不满13位编码补位 (.内容))
.如果真结束


.子程序 _透明标签7_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (不等于 (未知支持库函数_3 (), -1))
    赋值 (.可视, 真)
    赋值 (.可视, 假)
    赋值 (.禁止, 真)
    赋值 (., 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.如果真结束


.子程序 _关闭会员信息_被单击, 空白型, , 
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.禁止, 假)
赋值 (., 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)

.子程序 _关闭书籍信息_被单击, 空白型, , 
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.禁止, 假)
赋值 (., 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)

.子程序 _透明标签6_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (不等于 (未知支持库函数_3 (), -1))
    赋值 (.可视, 假)
    赋值 (.可视, 真)
    赋值 (.禁止, 真)
    赋值 (., 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.如果真结束


.子程序 _高级表格1_被单击, 空白型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 

_高级表格1_光标位置改变 ()


.窗口程序集 利润统计程序集, , , 

.程序集变量 cxjSQL语句, 文本型, , , 
.程序集变量 cxj自动编号, 整数型, , "0", 
.程序集变量 cxj借书日期, 日期时间型, , "0", 
.程序集变量 cxj合计租金, 双精度小数型, , "0", 
.程序集变量 cxj日租金, 双精度小数型, , "0", 
.程序集变量 cxj本书押金, 双精度小数型, , "0", 
.程序集变量 cxj各日数据, 双精度小数型, , "0", 
.程序集变量 循环次数, 整数型, , , 
.子程序 _ck利润统计_创建完毕, 空白型, , 
.如果真 (等于 (时间正常, 假))
    信息框 (“时间处于异常状态,操作中断”, #警告图标, “警报”)
    返回 ()
.如果真结束
获取有的年份 ()
显示图表 (取现行时间 ())

.子程序 获取有的年份, 空白型, , 
.局部变量 temp, 整数型, , , 

qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
“SELECT distinct(year(借书日期)) from 租借表”.未知支持库函数_14 (#)
.计次循环首 (., )
    0.未知支持库函数_29 (temp)
    到文本 (temp).加入项目 ()
    未知支持库函数_36 ()
.计次循环尾 ()
未知支持库函数_16 ()
未知支持库函数_3 ()

.子程序 获取某年有的月份, 空白型, , 
.局部变量 temp, 整数型, , , 

清空 ()
qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
相加 (“SELECT distinct(month(借书日期)) from 租借表 where year(借书日期)=”, .取项目文本 (.现行选中项)).未知支持库函数_14 (#)
.计次循环首 (., )
    0.未知支持库函数_29 (temp)
    到文本 (temp).加入项目 ()
    未知支持库函数_36 ()
.计次循环尾 ()
未知支持库函数_16 ()
未知支持库函数_3 ()


.子程序 显示图表, 空白型, , 
.参数 参数日期时间, 日期时间型, , 

.局部变量 i, 整数型, , , 
.局部变量 temp文本, 文本型, , , 
.局部变量 temp日期, 日期时间型, , , 
.局部变量 temp整数, 整数型, , , 
.局部变量 temp小数, 双精度小数型, , , 
.局部变量 pass, 逻辑型, , , 
.局部变量 现在时间, 日期时间型, , , 

判断各月天数 (参数日期时间)
赋值 (., 循环次数)
.计次循环首 (循环次数, i)
    赋值 (., 相减 (i, 1))
    赋值 (., 相加 (到文本 (i), “日”))
.计次循环尾 ()
清除数组 (cxj自动编号)
清除数组 (cxj借书日期)
清除数组 (cxj合计租金)
清除数组 (cxj日租金)
清除数组 (cxj本书押金)
清除数组 (cxj各日数据)
qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
赋值 (现在时间, 参数日期时间)
赋值 (cxjSQL语句, 相加 (“select 自动编号,借书日期,日租金,本书押金 from 租借表 where 借书日期>#”, 到文本 (取年份 (现在时间)), “-”, 到文本 (取月份 (现在时间)), “-1”, “ 00:00:00# and 借书日期<#”, 到文本 (取年份 (现在时间)), “-”, 到文本 (取月份 (现在时间)), “-”, 到文本 (循环次数), “ 23:59:59#”))
cxjSQL语句.未知支持库函数_14 (#)
.如果真 (小于 (., 1))
    未知支持库函数_16 ()
    未知支持库函数_3 ()
    返回 ()
.如果真结束
.计次循环首 (., i)
    “自动编号”.未知支持库函数_29 (temp整数)
    加入成员 (cxj自动编号, temp整数)
    “借书日期”.未知支持库函数_31 (temp日期)
    加入成员 (cxj借书日期, temp日期)
    “日租金”.未知支持库函数_27 (temp小数)
    加入成员 (cxj日租金, temp小数)
    “本书押金”.未知支持库函数_27 (temp小数)
    加入成员 (cxj本书押金, temp小数)
    未知支持库函数_36 ()
.计次循环尾 ()
未知支持库函数_16 ()
.计次循环首 (取数组成员数 (cxj自动编号), i)
    .如果真 (小于 (取时间间隔 (取现行时间 (), cxj借书日期 [i], #日), 1))
        加入成员 (cxj合计租金, cxj日租金 [i])
        到循环尾 ()
    .如果真结束
    赋值 (temp小数, 相乘 (四舍五入 (取时间间隔 (取现行时间 (), cxj借书日期 [i], #日), 2), cxj日租金 [i]))
    .如果 (大于或等于 (temp小数, cxj本书押金 [i]))
        加入成员 (cxj合计租金, cxj本书押金 [i])
    .否则
        加入成员 (cxj合计租金, 四舍五入 (temp小数, 2))
    .如果结束
    
.计次循环尾 ()
未知支持库函数_9 ()
.计次循环首 (取数组成员数 (cxj自动编号), i)
    赋值 (cxjSQL语句, 相加 (“update 租借表 set 合计租金=”, 到文本 (cxj合计租金 [i]), “ where 自动编号=”, 到文本 (cxj自动编号 [i])))
    赋值 (pass, cxjSQL语句.未知支持库函数_14 (#))
    .如果真 (等于 (pass, 假))
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
.如果真 (等于 (pass, 假))
    未知支持库函数_11 ()
    信息框 (“数据库读写错误，操作中断”, #错误图标, “错误”)
    赋值 (.可视, 假)
    未知支持库函数_16 ()
    未知支持库函数_3 ()
    返回 ()
.如果真结束
未知支持库函数_10 ()
未知支持库函数_16 ()

.计次循环首 (循环次数, i)
    赋值 (cxjSQL语句, 相加 (“select sum(合计租金) from 租借表 where 借书日期>#”, 到文本 (取年份 (现在时间)), “-”, 到文本 (取月份 (现在时间)), “-”, 到文本 (i), “ 00:00:00# and 借书日期<#”, 到文本 (取年份 (现在时间)), “-”, 到文本 (取月份 (现在时间)), “-”, 到文本 (i), “ 23:59:59#”))
    cxjSQL语句.未知支持库函数_14 (#)
    0.未知支持库函数_27 (temp小数)
    加入成员 (cxj各日数据, temp小数)
    未知支持库函数_16 ()
.计次循环尾 ()
赋值 (temp小数, cxj各日数据 [1])
.计次循环首 (循环次数, i)
    .如果真 (小于 (temp小数, cxj各日数据 [i]))
        赋值 (temp小数, cxj各日数据 [i])
    .如果真结束
    
.计次循环尾 ()
赋值 (., 相加 (到文本 (取年份 (现在时间)), “年”, 到文本 (取月份 (现在时间)), “月 的收入情况统计表”))
赋值 (., 选择 (等于 (倒找文本 (到文本 (temp小数), “.”, , 假), -1), temp小数, 相加 (temp小数, 1)))
.计次循环首 (循环次数, i)
    赋值 (., 相减 (i, 1))
    赋值 (., cxj各日数据 [i])
.计次循环尾 ()
未知支持库函数_3 ()


.子程序 判断各月天数, 空白型, , 
.参数 参数日期, 日期时间型, , 

.局部变量 tempyear, 整数型, , , 
.局部变量 tempmonth, 整数型, , , 

赋值 (tempyear, 取年份 (参数日期))
赋值 (tempmonth, 取月份 (参数日期))
赋值 (循环次数, 0)
.如果真 (等于 (tempmonth, 1))
    赋值 (循环次数, 31)
    返回 ()
.如果真结束
.如果真 (等于 (tempmonth, 2))
    .如果 (或者 (并且 (等于 (求余数 (tempyear, 4), 0), 不等于 (求余数 (tempyear, 100), 0)), 等于 (求余数 (tempyear, 400), 0)))
        赋值 (循环次数, 29)
    .否则
        赋值 (循环次数, 28)
    .如果结束
    返回 ()
.如果真结束
.如果真 (等于 (tempmonth, 3))
    赋值 (循环次数, 31)
    返回 ()
.如果真结束
.如果真 (等于 (tempmonth, 4))
    赋值 (循环次数, 30)
    返回 ()
.如果真结束
.如果真 (等于 (tempmonth, 5))
    赋值 (循环次数, 31)
    返回 ()
.如果真结束
.如果真 (等于 (tempmonth, 6))
    赋值 (循环次数, 30)
    返回 ()
.如果真结束
.如果真 (等于 (tempmonth, 7))
    赋值 (循环次数, 31)
    返回 ()
.如果真结束
.如果真 (等于 (tempmonth, 8))
    赋值 (循环次数, 31)
    返回 ()
.如果真结束
.如果真 (等于 (tempmonth, 9))
    赋值 (循环次数, 30)
    返回 ()
.如果真结束
.如果真 (等于 (tempmonth, 10))
    赋值 (循环次数, 31)
    返回 ()
.如果真结束
.如果真 (等于 (tempmonth, 11))
    赋值 (循环次数, 30)
    返回 ()
.如果真结束
.如果真 (等于 (tempmonth, 12))
    赋值 (循环次数, 31)
    返回 ()
.如果真结束





.子程序 _统计_被单击, 空白型, , 
.如果真 (或者 (等于 (.现行选中项, -1), 等于 (.现行选中项, -1)))
    返回 ()
.如果真结束
显示图表 (到时间 (相加 (.取项目文本 (.现行选中项), “-”, .取项目文本 (.现行选中项), “-”, “1”, “ 00:00:00”)))


.子程序 _年_列表项被选择, 空白型, , 
获取某年有的月份 ()


.窗口程序集 账簿清算程序集, , , 

.程序集变量 cxjSQL语句, 文本型, , , 
.程序集变量 cxj自动编号, 整数型, , "0", 
.程序集变量 cxj借书日期, 日期时间型, , "0", 
.程序集变量 cxj合计租金, 双精度小数型, , "0", 
.程序集变量 cxj日租金, 双精度小数型, , "0", 
.程序集变量 cxj本书押金, 双精度小数型, , "0", 
.程序集变量 cxj各日数据, 双精度小数型, , "0", 
.子程序 _ck账簿清算_创建完毕, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 temp文本, 文本型, , , 
.局部变量 temp日期, 日期时间型, , , 
.局部变量 temp整数, 整数型, , , 
.局部变量 temp小数, 双精度小数型, , , 
.局部变量 pass, 逻辑型, , , 
.局部变量 现在时间, 日期时间型, , , 

.如果真 (等于 (时间正常, 假))
    信息框 (“时间处于异常状态,操作中断”, #警告图标, “警报”)
    返回 ()
.如果真结束

清除数组 (cxj自动编号)
清除数组 (cxj借书日期)
清除数组 (cxj合计租金)
清除数组 (cxj日租金)
清除数组 (cxj本书押金)
清除数组 (cxj各日数据)
qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
赋值 (cxjSQL语句, “select 自动编号,借书日期,日租金,本书押金 from 租借表 where 是否归还='否'”)
cxjSQL语句.未知支持库函数_14 (#)
.如果真 (小于 (., 1))
    未知支持库函数_16 ()
    未知支持库函数_3 ()
    返回 ()
.如果真结束
.计次循环首 (., i)
    “自动编号”.未知支持库函数_29 (temp整数)
    加入成员 (cxj自动编号, temp整数)
    “借书日期”.未知支持库函数_31 (temp日期)
    加入成员 (cxj借书日期, temp日期)
    “日租金”.未知支持库函数_27 (temp小数)
    加入成员 (cxj日租金, temp小数)
    “本书押金”.未知支持库函数_27 (temp小数)
    加入成员 (cxj本书押金, temp小数)
    未知支持库函数_36 ()
.计次循环尾 ()
未知支持库函数_16 ()
.计次循环首 (取数组成员数 (cxj自动编号), i)
    .如果真 (小于 (取时间间隔 (取现行时间 (), cxj借书日期 [i], #日), 1))
        加入成员 (cxj合计租金, cxj日租金 [i])
        到循环尾 ()
    .如果真结束
    赋值 (temp小数, 相乘 (取时间间隔 (取现行时间 (), cxj借书日期 [i], #日), cxj日租金 [i]))
    .如果 (大于或等于 (temp小数, cxj本书押金 [i]))
        加入成员 (cxj合计租金, cxj本书押金 [i])
    .否则
        加入成员 (cxj合计租金, 四舍五入 (temp小数, 2))
    .如果结束
    
.计次循环尾 ()
未知支持库函数_9 ()
.计次循环首 (取数组成员数 (cxj自动编号), i)
    赋值 (cxjSQL语句, 相加 (“update 租借表 set 合计租金=”, 到文本 (cxj合计租金 [i]), “ where 自动编号=”, 到文本 (cxj自动编号 [i])))
    赋值 (pass, cxjSQL语句.未知支持库函数_14 (#))
    .如果真 (等于 (pass, 假))
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
.如果真 (等于 (pass, 假))
    未知支持库函数_11 ()
    信息框 (“数据库读写错误，操作中断”, #错误图标, “错误”)
    赋值 (.可视, 假)
    未知支持库函数_16 ()
    未知支持库函数_3 ()
    返回 ()
.如果真结束
未知支持库函数_10 ()
未知支持库函数_16 ()
赋值 (cxjSQL语句, “select sum(本书押金-合计租金) from 租借表 where 是否归还='否'”)
cxjSQL语句.未知支持库函数_14 (#)
0.未知支持库函数_27 (temp小数)
赋值 (., 0)
赋值 (., temp小数)
未知支持库函数_16 ()
赋值 (cxjSQL语句, “select sum(合计租金) from 租借表 where 是否归还='否'”)
cxjSQL语句.未知支持库函数_14 (#)
0.未知支持库函数_27 (temp小数)
赋值 (., 1)
赋值 (., temp小数)
未知支持库函数_16 ()
赋值 (cxjSQL语句, “select sum(帐户金额) from 会员表”)
cxjSQL语句.未知支持库函数_14 (#)
0.未知支持库函数_27 (temp小数)
赋值 (., 2)
赋值 (., temp小数)
未知支持库函数_16 ()
未知支持库函数_3 ()


.窗口程序集 图书信息程序集, , , 

.子程序 _ck图书信息_创建完毕, 空白型, , 
.局部变量 temp文本, 文本型, , , 
.局部变量 temp整数, 整数型, , , 
.局部变量 temp小数, 双精度小数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 sql, 文本型, , , 
.局部变量 toall, 整数型, , , 

.未知支持库函数_20 (“两个图形的色块分布越相似,说明目前书籍进货情况越合理，否者就应该调整您的进货比例”, -1, , , , )
.未知支持库函数_20 (“两个图形的色块分布越相似,说明目前书籍进货情况越合理，否者就应该调整您的进货比例”, -1, , , , )
.如果真 (等于 (时间正常, 假))
    信息框 (“时间处于异常状态,操作中断”, #警告图标, “警报”)
    返回 ()
.如果真结束

qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
“select 类型 as 类型名,count(类型) as 数量 from 图书表 group by 类型”.未知支持库函数_14 (#)
赋值 (., .)
赋值 (., .)
赋值 (.标题, 到文本 (.))
置随机数种子 (666)
.计次循环首 (., i)
    赋值 (., 相减 (i, 1))
    赋值 (., 相减 (i, 1))
    连续赋值 (取颜色值 (取随机数 (1, 255), 取随机数 (1, 255), 取随机数 (1, 255)), ., .)
    “类型名”.未知支持库函数_26 (temp文本)
    赋值 (., temp文本)
    赋值 (., temp文本)
    “数量”.未知支持库函数_29 (temp整数)
    赋值 (., temp整数)
    未知支持库函数_36 ()
.计次循环尾 ()
未知支持库函数_16 ()
.计次循环首 (., i)
    赋值 (toall, 0)
    赋值 (., 相减 (i, 1))
    赋值 (sql, 相加 (“select 被借次数 from 图书表 where 类型='”, ., “'”))
    sql.未知支持库函数_14 (#)
    .计次循环首 (., )
        0.未知支持库函数_29 (temp整数)
        赋值 (toall, 相加 (toall, temp整数))
        未知支持库函数_36 ()
    .计次循环尾 ()
    赋值 (., toall)
    未知支持库函数_16 ()
.计次循环尾 ()
“select 拥有数量 from 图书表”.未知支持库函数_14 (#)
赋值 (toall, 0)
.计次循环首 (., )
    0.未知支持库函数_29 (temp整数)
    赋值 (toall, 相加 (toall, temp整数))
    未知支持库函数_36 ()
.计次循环尾 ()
赋值 (.标题, 到文本 (toall))
未知支持库函数_16 ()
“select 是否借出 from 图书表”.未知支持库函数_14 (#)
赋值 (toall, 0)
.计次循环首 (., )
    0.未知支持库函数_29 (temp整数)
    赋值 (toall, 相加 (toall, temp整数))
    未知支持库函数_36 ()
.计次循环尾 ()
赋值 (.标题, 到文本 (toall))
未知支持库函数_16 ()
未知支持库函数_3 ()
赋值 (.标题, 到文本 (相减 (到数值 (.标题), 到数值 (.标题))))


.窗口程序集 书籍分类程序集, , , 

.程序集变量 cxj编号, 文本型, , "0", 
.程序集变量 cxj名称, 文本型, , "0", 
.子程序 _ck书籍分类_创建完毕, 空白型, , 
读取图书分类 ()

.子程序 读取图书分类, 空白型, , 
.局部变量 temp文本, 文本型, , , 
.局部变量 temp整数, 整数型, , , 
.局部变量 temp小数, 双精度小数型, , , 
.局部变量 i, 整数型, , , 

全部删除 ()
清除数组 (cxj编号)
清除数组 (cxj名称)
qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
“select * from 图书类型表”.未知支持库函数_14 (#)
.计次循环首 (., i)
    .插入表项 ()
    “图书类型编号”.未知支持库函数_26 (temp文本)
    相减 (i, 1).置标题 (0, temp文本)
    加入成员 (cxj编号, temp文本)
    “图书类型名称”.未知支持库函数_26 (temp文本)
    相减 (i, 1).置标题 (1, temp文本)
    加入成员 (cxj名称, temp文本)
    “图书类型租金”.未知支持库函数_26 (temp文本)
    相减 (i, 1).置标题 (2, temp文本)
    “自动编号”.未知支持库函数_29 (temp整数)
    相减 (i, 1).置标题 (3, 到文本 (temp整数))
    未知支持库函数_36 ()
.计次循环尾 ()
未知支持库函数_16 ()
未知支持库函数_3 ()


.子程序 _ck书籍分类_位置被改变, 空白型, , 
控件定位 ()

.子程序 控件定位, 空白型, , 
赋值 (.左边, 相除 (相减 (ck书籍分类.取用户区宽度 (), .宽度), 3))
赋值 (.顶边, 相除 (相减 (ck书籍分类.取用户区高度 (), .高度), 2))
0.移动 (0, ck书籍分类.取用户区宽度 (), ck书籍分类.取用户区高度 ())

.子程序 _ck书籍分类_尺寸被改变, 空白型, , 
控件定位 ()


.子程序 _取消_被单击, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
获取焦点 ()


.子程序 _添加_被单击, 空白型, , 
.局部变量 pass, 逻辑型, , , 
.局部变量 i, 整数型, , , 

赋值 (pass, 假)
.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“[图书类型编号]不能不填”, #警告图标, “提示”)
    界面刷新 ()
    返回 ()
.如果真结束
.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“[图书类型名称]不能不填”, #警告图标, “提示”)
    界面刷新 ()
    返回 ()
.如果真结束
.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“[图书类型租金]不能不填”, #警告图标, “提示”)
    界面刷新 ()
    返回 ()
.如果真结束
.计次循环首 (取数组成员数 (cxj编号), i)
    .如果真 (等于 (cxj编号 [i], .内容))
        信息框 (“该[编号]已经存在,不能重复添加”, 0, )
        界面刷新 ()
        返回 ()
    .如果真结束
    
.计次循环尾 ()
.计次循环首 (取数组成员数 (cxj名称), i)
    .如果真 (等于 (cxj名称 [i], .内容))
        信息框 (“该[名称]已经存在,不能重复添加”, 0, )
        界面刷新 ()
        返回 ()
    .如果真结束
    
.计次循环尾 ()

qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
赋值 (pass, 相加 (“insert into 图书类型表(图书类型编号,图书类型名称,图书类型租金) values('”, .内容, “','”, .内容, “','”, .内容, “')”).未知支持库函数_14 (#))
.如果 (pass)
    信息框 (“添加成功！”, #信息图标, “成功”)
    界面刷新 ()
    读取图书分类 ()
    _取消_被单击 ()
.否则
    信息框 (“添加失败！”, #信息图标, “失败”)
    界面刷新 ()
.如果结束
未知支持库函数_16 ()
未知支持库函数_3 ()


.子程序 界面刷新, 空白型, , 
赋值 (.可视, 假)
赋值 (.可视, 真)

.子程序 _删除_被单击, 空白型, , 
.局部变量 选中行, 整数型, , , 
.局部变量 附加号, 文本型, , , 
.局部变量 pass, 逻辑型, , , 

赋值 (pass, 假)
赋值 (选中行, .)
qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
相加 (“select 类型 from 图书表 where 类型='”, 选中行.取标题 (1), “'”).未知支持库函数_14 (#)
.如果真 (大于 (., 0))
    信息框 (“该图书类型正在启用中,无法删除！”, #警告图标, “提示”)
    界面刷新 ()
    未知支持库函数_16 ()
    未知支持库函数_3 ()
    返回 ()
.如果真结束
未知支持库函数_16 ()
未知支持库函数_3 ()

赋值 (附加号, “”)
.如果真 (等于 (., -1))
    信息框 (“请选择要删除的记录”, #警告图标, “提示”)
    界面刷新 ()
    返回 ()
.如果真结束

.如果真 (等于 (信息框 (相加 (“确认删除该记录[”, 选中行.取标题 (1), “]?”), 相加 (#询问图标, #确认取消钮), “询问”), #取消钮))
    界面刷新 ()
    返回 ()
.如果真结束
赋值 (附加号, 选中行.取标题 (3))
qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
赋值 (pass, 相加 (“delete * from 图书类型表 where 自动编号=”, 附加号).未知支持库函数_14 (#))
.如果 (pass)
    读取图书分类 ()
    信息框 (“记录已经删除”, #信息图标, “成功”)
    界面刷新 ()
.否则
    信息框 (“删除失败”, #错误图标, “失败”)
    界面刷新 ()
.如果结束
未知支持库函数_16 ()
未知支持库函数_3 ()


.子程序 _图书类型编号_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _图书类型编号_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)

.子程序 _图书类型名称_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)

.子程序 _图书类型名称_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)

.子程序 _图书类型租金_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _图书类型租金_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)


.窗口程序集 会员分类程序集, , , 

.程序集变量 cxj编号, 文本型, , "0", 
.程序集变量 cxj名称, 文本型, , "0", 
.子程序 _ck会员分类_创建完毕, 空白型, , 
读取会员分类 ()

.子程序 读取会员分类, 空白型, , 
.局部变量 temp文本, 文本型, , , 
.局部变量 temp整数, 整数型, , , 
.局部变量 temp小数, 双精度小数型, , , 
.局部变量 i, 整数型, , , 

全部删除 ()
清除数组 (cxj编号)
清除数组 (cxj名称)
qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
“select * from 会员类型表”.未知支持库函数_14 (#)
.计次循环首 (., i)
    .插入表项 ()
    “会员类型编号”.未知支持库函数_26 (temp文本)
    相减 (i, 1).置标题 (0, temp文本)
    加入成员 (cxj编号, temp文本)
    “会员类型名称”.未知支持库函数_26 (temp文本)
    相减 (i, 1).置标题 (1, temp文本)
    加入成员 (cxj名称, temp文本)
    “会员类型租金率”.未知支持库函数_26 (temp文本)
    相减 (i, 1).置标题 (2, temp文本)
    “自动编号”.未知支持库函数_29 (temp整数)
    相减 (i, 1).置标题 (3, 到文本 (temp整数))
    未知支持库函数_36 ()
.计次循环尾 ()
未知支持库函数_16 ()
未知支持库函数_3 ()


.子程序 _ck会员分类_位置被改变, 空白型, , 
控件定位 ()

.子程序 控件定位, 空白型, , 
赋值 (.左边, 相除 (相减 (ck会员分类.取用户区宽度 (), .宽度), 3))
赋值 (.顶边, 相除 (相减 (ck会员分类.取用户区高度 (), .高度), 2))
0.移动 (0, ck会员分类.取用户区宽度 (), ck会员分类.取用户区高度 ())

.子程序 _ck会员分类_尺寸被改变, 空白型, , 
控件定位 ()


.子程序 _取消_被单击, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
获取焦点 ()


.子程序 _添加_被单击, 空白型, , 
.局部变量 pass, 逻辑型, , , 
.局部变量 i, 整数型, , , 

赋值 (pass, 假)
.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“[会员类型编号]不能不填”, #警告图标, “提示”)
    界面刷新 ()
    返回 ()
.如果真结束
.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“[会员类型名称]不能不填”, #警告图标, “提示”)
    界面刷新 ()
    返回 ()
.如果真结束
.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“[会员折率]不能不填”, #警告图标, “提示”)
    界面刷新 ()
    返回 ()
.如果真结束
.计次循环首 (取数组成员数 (cxj编号), i)
    .如果真 (等于 (cxj编号 [i], .内容))
        信息框 (“该[编号]已经存在,不能重复添加”, 0, )
        界面刷新 ()
        返回 ()
    .如果真结束
    
.计次循环尾 ()
.计次循环首 (取数组成员数 (cxj名称), i)
    .如果真 (等于 (cxj名称 [i], .内容))
        信息框 (“该[名称]已经存在,不能重复添加”, 0, )
        界面刷新 ()
        返回 ()
    .如果真结束
    
.计次循环尾 ()

qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
赋值 (pass, 相加 (“insert into 会员类型表(会员类型编号,会员类型名称,会员类型租金率) values('”, .内容, “','”, .内容, “','”, .内容, “')”).未知支持库函数_14 (#))
.如果 (pass)
    信息框 (“添加成功！”, #信息图标, “成功”)
    界面刷新 ()
    读取会员分类 ()
    _取消_被单击 ()
.否则
    信息框 (“添加失败！”, #信息图标, “失败”)
    界面刷新 ()
.如果结束
未知支持库函数_16 ()
未知支持库函数_3 ()


.子程序 界面刷新, 空白型, , 
赋值 (.可视, 假)
赋值 (.可视, 真)

.子程序 _删除_被单击, 空白型, , 
.局部变量 选中行, 整数型, , , 
.局部变量 附加号, 文本型, , , 
.局部变量 pass, 逻辑型, , , 

赋值 (pass, 假)
赋值 (选中行, .)
qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
相加 (“select 会员类型 from 会员表 where 会员类型='”, 选中行.取标题 (1), “'”).未知支持库函数_14 (#)
.如果真 (大于 (., 0))
    信息框 (“该会员类型正在启用中,无法删除！”, #警告图标, “提示”)
    界面刷新 ()
    未知支持库函数_16 ()
    未知支持库函数_3 ()
    返回 ()
.如果真结束
未知支持库函数_16 ()
未知支持库函数_3 ()
赋值 (附加号, “”)
.如果真 (等于 (., -1))
    信息框 (“请选择要删除的记录”, #警告图标, “提示”)
    界面刷新 ()
    返回 ()
.如果真结束

.如果真 (等于 (信息框 (相加 (“确认删除该记录[”, 选中行.取标题 (1), “]?”), 相加 (#询问图标, #确认取消钮), “询问”), #取消钮))
    界面刷新 ()
    返回 ()
.如果真结束
赋值 (附加号, 选中行.取标题 (3))
qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
赋值 (pass, 相加 (“delete * from 会员类型表 where 自动编号=”, 附加号).未知支持库函数_14 (#))
.如果 (pass)
    读取会员分类 ()
    信息框 (“记录已经删除”, #信息图标, “成功”)
    界面刷新 ()
.否则
    信息框 (“删除失败”, #错误图标, “失败”)
    界面刷新 ()
.如果结束
未知支持库函数_16 ()
未知支持库函数_3 ()


.子程序 _会员类型编号_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _会员类型编号_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)

.子程序 _会员类型名称_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)

.子程序 _会员类型名称_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)

.子程序 _会员折率_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _会员折率_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)


.窗口程序集 登陆程序集, , , 

.子程序 _ck登陆_创建完毕, 空白型, , 
.局部变量 文件号, 整数型, , , 
.局部变量 Ret, 整数型, , , 
.局部变量 temp, 日期时间型, , , 
.局部变量 i, 整数型, , , 

赋值 (Ret, GetWindowLong (ck登陆.取窗口句柄 (), -20))
赋值 (Ret, 位或 (Ret, 524288))
SetWindowLong (ck登陆.取窗口句柄 (), -20, Ret)
SetLayeredWindowAttributes (ck登陆.取窗口句柄 (), 0, 255, #LWA_ALPHA)

赋值 (文件号, 打开文件 (qj检查时间路径, , ))
赋值 (temp, 到时间 (读入一行 (文件号)))
.如果真 (或者 (小于 (取时间间隔 (取现行时间 (), temp, #分钟), 0), 大于 (取时间间隔 (取现行时间 (), temp, #分钟), 2880)))
    信息框 (“发现系统时间出现异常,请确认日期时间是否正确！”, #警告图标, “提示”)
.如果真结束
关闭文件 (文件号)
qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()


.子程序 _关闭_被单击, 空白型, , 
.局部变量 i, 整数型, , , 

.计次循环首 (255, i)
    SetLayeredWindowAttributes (ck登陆.取窗口句柄 (), 0, 相减 (255, i), #LWA_ALPHA)
    处理事件 ()
.计次循环尾 ()
ck登陆.销毁 ()
结束 ()

.子程序 _登陆_被单击, 空白型, , 
.局部变量 sql语句, 文本型, , , 
.局部变量 pass, 逻辑型, , , 
.局部变量 temp文本, 文本型, , , 
.局部变量 登陆成功, 逻辑型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 i, 整数型, , , 

.如果 (.选中)
    .如果真 (或者 (等于 (删全部空 (.内容), “”), 等于 (删全部空 (.内容), “”)))
        返回 ()
    .如果真结束
    
.否则
    .如果真 (.选中)
        .如果真 (或者 (等于 (删全部空 (.内容), “”), 等于 (删全部空 (.内容), “”)))
            返回 ()
        .如果真结束
        
    .如果真结束
    
.如果结束

赋值 (登陆成功, 假)
.如果 (.选中)
    赋值 (sql语句, 相加 (“select 用户编号,用户名称 from 用户表 where 用户编号='”, .内容, “' and 用户密码='”, .内容, “'”))
.否则
    赋值 (sql语句, 相加 (“select 用户编号,用户名称 from 用户表 where 用户名称='”, .内容, “' and 用户密码='”, .内容, “'”))
.如果结束
赋值 (pass, sql语句.未知支持库函数_14 (#))
.如果 (pass)
    .如果 (大于或等于 (., 1))
        “用户编号”.未知支持库函数_26 (temp文本)
        赋值 (qj用户编号, temp文本)
        赋值 (登陆成功, 真)
    .否则
        赋值 (qj用户编号, “”)
        信息框 (“填写信息不正确,请重新填写”, #警告图标, “不正确”)
        赋值 (登陆成功, 假)
    .如果结束
    
.否则
    信息框 (“读取用户信息错误,程序终止”, #错误图标, “错误”)
    结束 ()
.如果结束
未知支持库函数_16 ()
.如果真 (登陆成功)
    赋值 (文件号, 打开文件 (相加 (取当前目录 (), “\chktime”), , ))
    写文本行 (文件号, 到文本 (取现行时间 ()))
    关闭文件 (文件号)
    .计次循环首 (255, i)
        SetLayeredWindowAttributes (ck登陆.取窗口句柄 (), 0, 相减 (255, i), #LWA_ALPHA)
        处理事件 ()
    .计次循环尾 ()
    载入 (ck请稍候, , 假)
    载入 (ck主窗口, , 假)
    ck登陆.销毁 ()
.如果真结束


.子程序 _单选框2_被单击, 空白型, , 
.如果 (.选中)
    赋值 (.可视, 真)
    赋值 (.可视, 假)
    获取焦点 ()
.否则
    赋值 (.可视, 假)
    赋值 (.可视, 真)
.如果结束


.子程序 _单选框1_被单击, 空白型, , 
.如果 (.选中)
    赋值 (.可视, 假)
    赋值 (.可视, 真)
    获取焦点 ()
.否则
    赋值 (.可视, 真)
    赋值 (.可视, 假)
.如果结束


.子程序 _选择框2_被单击, 空白型, , 
.如果真 (.选中)
    赋值 (.选中, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
.如果真结束
.如果 (.选中)
    赋值 (.内容, 到文本 (取小时 (取现行时间 ())))
    赋值 (.内容, 到文本 (取分钟 (取现行时间 ())))
    赋值 (.内容, 到文本 (取秒 (取现行时间 ())))
    赋值 (.可视, 真)
    赋值 (.可视, 假)
.否则
    赋值 (.可视, 假)
.如果结束



.子程序 _选择框1_被单击, 空白型, , 
.如果真 (.选中)
    赋值 (.选中, 假)
    
.如果真结束

.如果 (.选中)
    赋值 (.可视, 真)
    赋值 (.可视, 假)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    .如果 (.选中)
        获取焦点 ()
    .否则
        获取焦点 ()
    .如果结束
    
.否则
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    
.如果结束




.子程序 _时钟1_周期事件, 空白型, , 
赋值 (.标题, 到文本 (取现行时间 ()))


.子程序 _修改_被单击, 空白型, , 
.局部变量 temp年, 文本型, , , 
.局部变量 temp月, 文本型, , , 
.局部变量 temp日, 文本型, , , 
.局部变量 temp时, 文本型, , , 
.局部变量 temp分, 文本型, , , 
.局部变量 temp秒, 文本型, , , 
.局部变量 tempall, 文本型, , , 

赋值 (temp年, 到文本 (取年份 (.今天)))
赋值 (temp月, 到文本 (取月份 (.今天)))
赋值 (temp日, 到文本 (取日 (.今天)))
赋值 (temp时, .内容)
赋值 (temp分, .内容)
赋值 (temp秒, .内容)
赋值 (tempall, 相加 (temp年, “-”, temp月, “-”, temp日, “-”, temp时, “:”, temp分, “:”, temp秒))
置现行时间 (到时间 (tempall))
信息框 (相加 (“系统时间已修改为：”, 到文本 (取现行时间 ())), 0, )


.子程序 _用户编号_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _用户编号_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)


.子程序 _用户名称_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _用户名称_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)


.子程序 _登陆密码_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _登陆密码_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)
.如果真 (.选中)
    .如果 (.选中)
        .如果真 (并且 (不等于 (删全部空 (.内容), “”), 不等于 (删全部空 (.内容), “”)))
            _登陆_被单击 ()
        .如果真结束
        
    .否则
        .如果真 (.选中)
            .如果真 (并且 (不等于 (删全部空 (.内容), “”), 不等于 (删全部空 (.内容), “”)))
                _登陆_被单击 ()
            .如果真结束
            
        .如果真结束
        
    .如果结束
    
.如果真结束




.窗口程序集 用户分类程序集, , , 

.程序集变量 cxj编号, 文本型, , "0", 
.程序集变量 cxj名称, 文本型, , "0", 
.子程序 _ck用户分类_创建完毕, 空白型, , 
读取用户表 ()

.子程序 读取用户表, 空白型, , 
.局部变量 temp文本, 文本型, , , 
.局部变量 temp整数, 整数型, , , 
.局部变量 temp小数, 双精度小数型, , , 
.局部变量 i, 整数型, , , 

全部删除 ()
清除数组 (cxj编号)
清除数组 (cxj名称)
qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
“select * from 用户表”.未知支持库函数_14 (#)
.计次循环首 (., i)
    .插入表项 ()
    “用户编号”.未知支持库函数_26 (temp文本)
    相减 (i, 1).置标题 (0, temp文本)
    加入成员 (cxj编号, temp文本)
    “用户名称”.未知支持库函数_26 (temp文本)
    相减 (i, 1).置标题 (1, temp文本)
    加入成员 (cxj名称, temp文本)
    “自动编号”.未知支持库函数_29 (temp整数)
    相减 (i, 1).置标题 (2, 到文本 (temp整数))
    未知支持库函数_36 ()
.计次循环尾 ()
未知支持库函数_16 ()
未知支持库函数_3 ()


.子程序 _ck用户分类_位置被改变, 空白型, , 
控件定位 ()

.子程序 控件定位, 空白型, , 
赋值 (.左边, 相除 (相减 (ck用户分类.取用户区宽度 (), .宽度), 3))
赋值 (.顶边, 相除 (相减 (ck用户分类.取用户区高度 (), .高度), 2))
0.移动 (0, ck用户分类.取用户区宽度 (), ck用户分类.取用户区高度 ())

.子程序 _ck用户分类_尺寸被改变, 空白型, , 
控件定位 ()


.子程序 _取消_被单击, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
获取焦点 ()


.子程序 _添加_被单击, 空白型, , 
.局部变量 pass, 逻辑型, , , 
.局部变量 i, 整数型, , , 

赋值 (pass, 假)
.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“[用户编号]不能不填”, #警告图标, “提示”)
    界面刷新 ()
    返回 ()
.如果真结束
.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“[用户名称]不能不填”, #警告图标, “提示”)
    界面刷新 ()
    返回 ()
.如果真结束
.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“[登陆密码]不能不填”, #警告图标, “提示”)
    界面刷新 ()
    返回 ()
.如果真结束
.如果真 (等于 (删全部空 (.内容), “”))
    信息框 (“[重复密码]不能不填”, #警告图标, “提示”)
    界面刷新 ()
    返回 ()
.如果真结束
.如果真 (不等于 (删全部空 (.内容), 删全部空 (.内容)))
    信息框 (“两次输入的密码不一致”, #警告图标, “提示”)
    界面刷新 ()
    返回 ()
.如果真结束
.计次循环首 (取数组成员数 (cxj编号), i)
    .如果真 (等于 (cxj编号 [i], .内容))
        信息框 (“该[编号]已经存在,不能重复添加”, 0, )
        界面刷新 ()
        返回 ()
    .如果真结束
    
.计次循环尾 ()
.计次循环首 (取数组成员数 (cxj名称), i)
    .如果真 (等于 (cxj名称 [i], .内容))
        信息框 (“该[名称]已经存在,不能重复添加”, 0, )
        界面刷新 ()
        返回 ()
    .如果真结束
    
.计次循环尾 ()

qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
赋值 (pass, 相加 (“insert into 用户表(用户编号,用户名称,用户密码) values('”, .内容, “','”, .内容, “','”, .内容, “')”).未知支持库函数_14 (#))
.如果 (pass)
    信息框 (“添加成功，请及时配置用户权限!”, #信息图标, “成功”)
    界面刷新 ()
    读取用户表 ()
    _取消_被单击 ()
.否则
    信息框 (“添加失败！”, #信息图标, “失败”)
    界面刷新 ()
.如果结束
未知支持库函数_16 ()
未知支持库函数_3 ()


.子程序 界面刷新, 空白型, , 
赋值 (.可视, 假)
赋值 (.可视, 真)

.子程序 _删除_被单击, 空白型, , 
.局部变量 选中行, 整数型, , , 
.局部变量 附加号, 文本型, , , 
.局部变量 pass, 逻辑型, , , 

赋值 (pass, 假)
赋值 (附加号, “”)
.如果真 (等于 (., -1))
    信息框 (“请选择要删除的记录”, #警告图标, “提示”)
    界面刷新 ()
    返回 ()
.如果真结束
赋值 (选中行, .)
.如果真 (等于 (选中行.取标题 (0), qj用户编号))
    信息框 (相加 (选中行.取标题 (1), “ 用户正在使用过程中,不能删除”), #信息图标, “提示”)
    界面刷新 ()
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (相加 (“确认删除该记录[”, 选中行.取标题 (1), “]?”), 相加 (#询问图标, #确认取消钮), “询问”), #取消钮))
    界面刷新 ()
    返回 ()
.如果真结束
赋值 (附加号, 选中行.取标题 (2))
qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
赋值 (pass, 相加 (“delete * from 用户表 where 自动编号=”, 附加号).未知支持库函数_14 (#))
.如果 (pass)
    读取用户表 ()
    信息框 (“记录已经删除”, #信息图标, “成功”)
    界面刷新 ()
.否则
    信息框 (“删除失败”, #错误图标, “失败”)
    界面刷新 ()
.如果结束
未知支持库函数_16 ()
未知支持库函数_3 ()


.子程序 _用户编号_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _用户编号_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)

.子程序 _用户名称_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)

.子程序 _用户名称_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)

.子程序 _登陆密码_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _登陆密码_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)


.子程序 _重复密码_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _重复密码_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)


.子程序 _全选_被单击, 空白型, , 
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)
赋值 (.选中, 真)


.子程序 _反选_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束
.如果 (等于 (.选中, 真))
    赋值 (.选中, 假)
.否则
    赋值 (.选中, 真)
.如果结束


.子程序 _保存_被单击, 空白型, , 
.局部变量 选中行, 整数型, , , 
.局部变量 附加号, 文本型, , , 
.局部变量 pass, 逻辑型, , , 
.局部变量 SQL语句, 文本型, , , 

赋值 (pass, 假)
赋值 (附加号, “”)
.如果真 (等于 (., -1))
    信息框 (“请选择要修改的记录”, #警告图标, “提示”)
    界面刷新 ()
    返回 ()
.如果真结束
赋值 (选中行, .)
.如果真 (等于 (信息框 (相加 (“确认修改该记录权限[”, 选中行.取标题 (1), “]?”), 相加 (#询问图标, #确认取消钮), “询问”), #取消钮))
    界面刷新 ()
    返回 ()
.如果真结束
赋值 (附加号, 选中行.取标题 (2))
qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
赋值 (SQL语句, 相加 (“update 用户表 set 新书入库='”, 选择 (.选中, “是”, “否”), “',租借业务='”, 选择 (.选中, “是”, “否”), “',会员登记='”, 选择 (.选中, “是”, “否”), “',会员挂失='”, 选择 (.选中, “是”, “否”), “',会员充值='”, 选择 (.选中, “是”, “否”), “',会员退款='”, 选择 (.选中, “是”, “否”), “',书籍管理='”, 选择 (.选中, “是”, “否”), “',会员管理='”, 选择 (.选中, “是”, “否”), “',租借列表='”, 选择 (.选中, “是”, “否”), “',利润统计='”, 选择 (.选中, “是”, “否”), “',账簿清算='”, 选择 (.选中, “是”, “否”), “',图书信息='”, 选择 (.选中, “是”, “否”), “',月度信息='”, 选择 (.选中, “是”, “否”), “',书籍分类='”, 选择 (.选中, “是”, “否”), “',会员分类='”, 选择 (.选中, “是”, “否”), “',用户分类='”, 选择 (.选中, “是”, “否”), “',修改密码='”, 选择 (.选中, “是”, “否”), “',数据备份='”, 选择 (.选中, “是”, “否”), “',后台配置='”, 选择 (.选中, “是”, “否”), “' where 自动编号=”, 附加号))
赋值 (pass, SQL语句.未知支持库函数_14 (#))
.如果 (pass)
    读取用户表 ()
    信息框 (“权限配置完成”, #信息图标, “成功”)
    界面刷新 ()
    .如果真 (等于 (选中行.取标题 (0), qj用户编号))
        ck主窗口.配置用户 ()
    .如果真结束
    
.否则
    信息框 (“权限配置失败”, #错误图标, “失败”)
    界面刷新 ()
.如果结束
未知支持库函数_16 ()
未知支持库函数_3 ()

.子程序 _超级列表框1_当前表项被改变, 空白型, , 
.局部变量 选中行, 整数型, , , 
.局部变量 附加号, 文本型, , , 
.局部变量 temp文本, 文本型, , , 
.局部变量 pass, 逻辑型, , , 

赋值 (pass, 假)
赋值 (附加号, “”)
赋值 (选中行, .)
赋值 (附加号, 选中行.取标题 (2))
qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
赋值 (pass, 相加 (“select * from 用户表 where 自动编号=”, 附加号).未知支持库函数_14 (#))
.如果 (pass)
    “新书入库”.未知支持库函数_26 (temp文本)
    .如果 (等于 (temp文本, “是”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    “租借业务”.未知支持库函数_26 (temp文本)
    .如果 (等于 (temp文本, “是”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    “会员登记”.未知支持库函数_26 (temp文本)
    .如果 (等于 (temp文本, “是”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    “会员挂失”.未知支持库函数_26 (temp文本)
    .如果 (等于 (temp文本, “是”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    “会员充值”.未知支持库函数_26 (temp文本)
    .如果 (等于 (temp文本, “是”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    “会员退款”.未知支持库函数_26 (temp文本)
    .如果 (等于 (temp文本, “是”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    “书籍管理”.未知支持库函数_26 (temp文本)
    .如果 (等于 (temp文本, “是”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    “会员管理”.未知支持库函数_26 (temp文本)
    .如果 (等于 (temp文本, “是”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    “租借列表”.未知支持库函数_26 (temp文本)
    .如果 (等于 (temp文本, “是”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    “利润统计”.未知支持库函数_26 (temp文本)
    .如果 (等于 (temp文本, “是”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    “账簿清算”.未知支持库函数_26 (temp文本)
    .如果 (等于 (temp文本, “是”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    “图书信息”.未知支持库函数_26 (temp文本)
    .如果 (等于 (temp文本, “是”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    “月度信息”.未知支持库函数_26 (temp文本)
    .如果 (等于 (temp文本, “是”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    “书籍分类”.未知支持库函数_26 (temp文本)
    .如果 (等于 (temp文本, “是”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    “会员分类”.未知支持库函数_26 (temp文本)
    .如果 (等于 (temp文本, “是”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    “用户分类”.未知支持库函数_26 (temp文本)
    .如果 (等于 (temp文本, “是”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    “修改密码”.未知支持库函数_26 (temp文本)
    .如果 (等于 (temp文本, “是”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    “数据备份”.未知支持库函数_26 (temp文本)
    .如果 (等于 (temp文本, “是”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    “后台配置”.未知支持库函数_26 (temp文本)
    .如果 (等于 (temp文本, “是”))
        赋值 (.选中, 真)
    .否则
        赋值 (.选中, 假)
    .如果结束
    
.否则
    信息框 (“读取权限失败!”, #错误图标, “失败”)
    界面刷新 ()
.如果结束
未知支持库函数_16 ()
未知支持库函数_3 ()


.窗口程序集 修改密码程序集, , , 

.子程序 _标签1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.现行子夹, 0)


.子程序 _标签3_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.现行子夹, 1)

.子程序 _修改1_被单击, 空白型, , 
.局部变量 pass, 逻辑型, , , 

.如果真 (或者 (等于 (删全部空 (.内容), “”), 等于 (删全部空 (.内容), “”)))
    信息框 (“用户编号或密码不能为空！”, #信息图标, “提示”)
    界面刷新 ()
    返回 ()
.如果真结束
.如果真 (或者 (等于 (删全部空 (.内容), “”), 等于 (删全部空 (.内容), “”)))
    信息框 (“新的密码不能为空！”, #信息图标, “提示”)
    界面刷新 ()
    返回 ()
.如果真结束
.如果真 (不等于 (删全部空 (.内容), 删全部空 (.内容)))
    信息框 (“两次输入密码不一致”, 0, )
    界面刷新 ()
    返回 ()
.如果真结束
赋值 (pass, 假)
qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
相加 (“select 用户编号 from 用户表 where 用户编号='”, .内容, “'”).未知支持库函数_14 (#)
.如果 (大于 (., 0))
    未知支持库函数_16 ()
    相加 (“select 用户密码 from 用户表 where 用户编号='”, .内容, “' and 用户密码='”, .内容, “'”).未知支持库函数_14 (#)
    .如果 (大于 (., 0))
        未知支持库函数_16 ()
        赋值 (pass, 相加 (“update 用户表 set  用户密码='”, .内容, “' where 用户编号='”, .内容, “'”).未知支持库函数_14 (#))
        .如果 (pass)
            信息框 (“密码已经成功修改！”, #信息图标, “成功”)
            界面刷新 ()
            _取消1_被单击 ()
        .否则
            信息框 (“修改密码失败！”, #错误图标, “失败”)
            界面刷新 ()
            返回 ()
        .如果结束
        
    .否则
        信息框 (“密码不正确！”, #警告图标, “不正确”)
        界面刷新 ()
        返回 ()
        
    .如果结束
    
.否则
    信息框 (“该用户编号不存在！”, #信息图标, “不存在”)
    界面刷新 ()
    返回 ()
.如果结束
未知支持库函数_16 ()
未知支持库函数_3 ()

.子程序 界面刷新, 空白型, , 
赋值 (.可视, 假)
赋值 (.可视, 真)

.子程序 _取消1_被单击, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)

.子程序 _ck修改密码_位置被改变, 空白型, , 
控件定位 ()

.子程序 控件定位, 空白型, , 
赋值 (.左边, 相除 (相减 (ck修改密码.取用户区宽度 (), .宽度), 3))
赋值 (.顶边, 相除 (相减 (ck修改密码.取用户区高度 (), .高度), 2))
0.移动 (0, ck修改密码.取用户区宽度 (), ck修改密码.取用户区高度 ())

.子程序 _ck修改密码_尺寸被改变, 空白型, , 
控件定位 ()


.子程序 _修改_被单击, 空白型, , 
.局部变量 pass, 逻辑型, , , 

.如果真 (或者 (等于 (删全部空 (.内容), “”), 等于 (删全部空 (.内容), “”)))
    信息框 (“会员编号或密码不能为空！”, #信息图标, “提示”)
    界面刷新 ()
    返回 ()
.如果真结束
.如果真 (或者 (等于 (删全部空 (.内容), “”), 等于 (删全部空 (.内容), “”)))
    信息框 (“新的密码不能为空！”, #信息图标, “提示”)
    界面刷新 ()
    返回 ()
.如果真结束
.如果真 (不等于 (删全部空 (.内容), 删全部空 (.内容)))
    信息框 (“两次输入密码不一致”, 0, )
    界面刷新 ()
    返回 ()
.如果真结束
赋值 (pass, 假)
qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
相加 (“select 会员编号 from 会员表 where 会员编号='”, .内容, “'”).未知支持库函数_14 (#)
.如果 (大于 (., 0))
    未知支持库函数_16 ()
    相加 (“select 有效证件 from 会员表 where 会员编号='”, .内容, “' and 有效证件='”, .内容, “'”).未知支持库函数_14 (#)
    .如果 (大于 (., 0))
        未知支持库函数_16 ()
        赋值 (pass, 相加 (“update 会员表 set  有效证件='”, .内容, “' where 会员编号='”, .内容, “'”).未知支持库函数_14 (#))
        .如果 (pass)
            信息框 (“密码已经成功修改！”, #信息图标, “成功”)
            界面刷新 ()
            _取消_被单击 ()
        .否则
            信息框 (“修改密码失败！”, #错误图标, “失败”)
            界面刷新 ()
            返回 ()
        .如果结束
        
    .否则
        信息框 (“密码不正确！”, #警告图标, “不正确”)
        界面刷新 ()
        返回 ()
        
    .如果结束
    
.否则
    信息框 (“该会员编号不存在！”, #信息图标, “不存在”)
    界面刷新 ()
    返回 ()
.如果结束
未知支持库函数_16 ()
未知支持库函数_3 ()


.子程序 _取消_被单击, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)

.子程序 _会员编号_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _会员编号_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)


.子程序 _原来密码_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)

.子程序 _原来密码_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)

.子程序 _新的密码_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _新的密码_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)


.子程序 _重复新密码_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _重复新密码_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)


.子程序 _原来密码1_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)

.子程序 _原来密码1_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)

.子程序 _新的密码1_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _新的密码1_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)


.子程序 _重复新密码1_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _重复新密码1_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)

.子程序 _用户编号_获得焦点, 空白型, , 
赋值 (.背景颜色, #黄色)


.子程序 _用户编号_失去焦点, 空白型, , 
赋值 (.背景颜色, #白色)


.窗口程序集 数据备份程序集, , , 

.子程序 _备份数据_被单击, 空白型, , 
.局部变量 path, 文本型, , , 
.局部变量 name, 文本型, , , 
.局部变量 pass, 逻辑型, , , 

赋值 (path, GetTheFolder (ck数据备份.取窗口句柄 (), “请选择数据保存的位置！”, “d:\”, 假))
界面刷新 ()
.如果真 (等于 (path, “”))
    返回 ()
.如果真结束
赋值 (name, 到文本 (取现行时间 ()))
.如果 (等于 (取文本右边 (path, 1), “\”))
    赋值 (pass, 复制文件 (qj数据库路径, 相加 (path, “备份数据”, name)))
.否则
    赋值 (pass, 复制文件 (qj数据库路径, 相加 (path, “\”, “备份数据”, name)))
.如果结束

.如果 (pass)
    .如果 (等于 (取文本右边 (path, 1), “\”))
        运行 (相加 (“Explorer /select, ”, path, “备份数据”, name), 假, )
    .否则
        运行 (相加 (“Explorer /select, ”, path, “\”, “备份数据”, name), 假, )
    .如果结束
    
.否则
    信息框 (“数据备份失败！”, #错误图标, “失败”)
    界面刷新 ()
.如果结束


.子程序 _ck数据备份_位置被改变, 空白型, , 
控件定位 ()

.子程序 控件定位, 空白型, , 
赋值 (.左边, 相除 (相减 (ck数据备份.取用户区宽度 (), .宽度), 3))
赋值 (.顶边, 相除 (相减 (ck数据备份.取用户区高度 (), .高度), 2))
0.移动 (0, ck数据备份.取用户区宽度 (), ck数据备份.取用户区高度 ())

.子程序 _ck数据备份_尺寸被改变, 空白型, , 
控件定位 ()


.子程序 界面刷新, 空白型, , 
赋值 (.可视, 假)
赋值 (.可视, 真)

.窗口程序集 月度信息程序集, , , 

.程序集变量 cxjSQL语句, 文本型, , , 
.程序集变量 cxj自动编号, 整数型, , "0", 
.程序集变量 cxj借书日期, 日期时间型, , "0", 
.程序集变量 cxj合计租金, 双精度小数型, , "0", 
.程序集变量 cxj日租金, 双精度小数型, , "0", 
.程序集变量 cxj本书押金, 双精度小数型, , "0", 
.程序集变量 cxj各月数据, 双精度小数型, , "0", 
.子程序 _ck月度信息_创建完毕, 空白型, , 
.如果真 (等于 (时间正常, 假))
    信息框 (“时间处于异常状态,操作中断”, #警告图标, “警报”)
    返回 ()
.如果真结束
获取有的年份 ()
显示图表 (取现行时间 ())

.子程序 获取有的年份, 空白型, , 
.局部变量 temp, 整数型, , , 

qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
“SELECT distinct(year(借书日期)) from 租借表”.未知支持库函数_14 (#)
.计次循环首 (., )
    0.未知支持库函数_29 (temp)
    到文本 (temp).加入项目 ()
    未知支持库函数_36 ()
.计次循环尾 ()
未知支持库函数_16 ()
未知支持库函数_3 ()

.子程序 显示图表, 空白型, , 
.参数 参数日期时间, 日期时间型, , 

.局部变量 i, 整数型, , , 
.局部变量 temp文本, 文本型, , , 
.局部变量 temp日期, 日期时间型, , , 
.局部变量 temp整数, 整数型, , , 
.局部变量 temp小数, 双精度小数型, , , 
.局部变量 pass, 逻辑型, , , 
.局部变量 现在时间, 日期时间型, , , 


赋值 (., 12)
.计次循环首 (12, i)
    赋值 (., 相减 (i, 1))
    赋值 (., 相加 (到文本 (i), “月”))
.计次循环尾 ()
清除数组 (cxj自动编号)
清除数组 (cxj借书日期)
清除数组 (cxj合计租金)
清除数组 (cxj日租金)
清除数组 (cxj本书押金)
清除数组 (cxj各月数据)
qj数据库路径.未知支持库函数_1 (qj数据库密码)
.未知支持库函数_12 ()
赋值 (现在时间, 参数日期时间)
赋值 (cxjSQL语句, 相加 (“select 自动编号,借书日期,日租金,本书押金 from 租借表 where year(借书日期)=”, 到文本 (取年份 (现在时间))))
cxjSQL语句.未知支持库函数_14 (#)
.如果真 (小于 (., 1))
    未知支持库函数_16 ()
    未知支持库函数_3 ()
    返回 ()
.如果真结束
.计次循环首 (., i)
    “自动编号”.未知支持库函数_29 (temp整数)
    加入成员 (cxj自动编号, temp整数)
    “借书日期”.未知支持库函数_31 (temp日期)
    加入成员 (cxj借书日期, temp日期)
    “日租金”.未知支持库函数_27 (temp小数)
    加入成员 (cxj日租金, temp小数)
    “本书押金”.未知支持库函数_27 (temp小数)
    加入成员 (cxj本书押金, temp小数)
    未知支持库函数_36 ()
.计次循环尾 ()
未知支持库函数_16 ()
.计次循环首 (取数组成员数 (cxj自动编号), i)
    .如果真 (小于 (取时间间隔 (取现行时间 (), cxj借书日期 [i], #日), 1))
        加入成员 (cxj合计租金, cxj日租金 [i])
        到循环尾 ()
    .如果真结束
    赋值 (temp小数, 相乘 (四舍五入 (取时间间隔 (取现行时间 (), cxj借书日期 [i], #日), 2), cxj日租金 [i]))
    .如果 (大于或等于 (temp小数, cxj本书押金 [i]))
        加入成员 (cxj合计租金, cxj本书押金 [i])
    .否则
        加入成员 (cxj合计租金, 四舍五入 (temp小数, 2))
    .如果结束
    
.计次循环尾 ()
未知支持库函数_9 ()
.计次循环首 (取数组成员数 (cxj自动编号), i)
    赋值 (cxjSQL语句, 相加 (“update 租借表 set 合计租金=”, 到文本 (cxj合计租金 [i]), “ where 自动编号=”, 到文本 (cxj自动编号 [i])))
    赋值 (pass, cxjSQL语句.未知支持库函数_14 (#))
    .如果真 (等于 (pass, 假))
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
.如果真 (等于 (pass, 假))
    未知支持库函数_11 ()
    信息框 (“数据库读写错误，操作中断”, #错误图标, “错误”)
    赋值 (.可视, 假)
    未知支持库函数_16 ()
    未知支持库函数_3 ()
    返回 ()
.如果真结束
未知支持库函数_10 ()
未知支持库函数_16 ()

.计次循环首 (12, i)
    赋值 (cxjSQL语句, 相加 (“select sum(合计租金) from 租借表 where year(借书日期)=”, 到文本 (取年份 (现在时间)), “ and month(借书日期)=”, 到文本 (i)))
    cxjSQL语句.未知支持库函数_14 (#)
    0.未知支持库函数_27 (temp小数)
    加入成员 (cxj各月数据, temp小数)
    未知支持库函数_16 ()
.计次循环尾 ()
赋值 (temp小数, cxj各月数据 [1])
.计次循环首 (12, i)
    .如果真 (小于 (temp小数, cxj各月数据 [i]))
        赋值 (temp小数, cxj各月数据 [i])
    .如果真结束
    
.计次循环尾 ()
赋值 (., 相加 (到文本 (取年份 (现在时间)), “年 的月度情况统计表”))
赋值 (., 选择 (等于 (倒找文本 (到文本 (temp小数), “.”, , 假), -1), temp小数, 相加 (temp小数, 1)))
.计次循环首 (12, i)
    赋值 (., 相减 (i, 1))
    赋值 (., cxj各月数据 [i])
.计次循环尾 ()
未知支持库函数_3 ()


.子程序 _统计_被单击, 空白型, , 
.如果真 (等于 (.现行选中项, -1))
    返回 ()
.如果真结束
显示图表 (到时间 (相加 (.取项目文本 (.现行选中项), “-1”, “-1”, “ 00:00:00”)))


.窗口程序集 后台配置程序集, , , 

.子程序 _ck后台配置_创建完毕, 空白型, , 
.局部变量 节名数组, 文本型, , "0", 
.局部变量 i, 整数型, , , 

.如果真 (文件是否存在 (qj配置路径))
    赋值 (节名数组, 取配置节名 (qj配置路径))
    .计次循环首 (取数组成员数 (节名数组), i)
        .如果真 (等于 (节名数组 [i], “用户配置”))
            读配置项 (qj配置路径, 节名数组 [i], “押金折扣”, ).选择 ()
            .如果 (等于 (读配置项 (qj配置路径, 节名数组 [i], “关闭时备份”, ), “是”))
                赋值 (.选中, 真)
                赋值 (.选中, 假)
            .否则
                赋值 (.选中, 真)
                赋值 (.选中, 假)
            .如果结束
            .如果 (等于 (读配置项 (qj配置路径, 节名数组 [i], “运行时备份”, ), “否”))
                赋值 (.选中, 真)
            .否则
                赋值 (.选中, 假)
                读配置项 (qj配置路径, 节名数组 [i], “运行时备份”, ).选择 ()
            .如果结束
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
.如果真结束


.子程序 _ck后台配置_位置被改变, 空白型, , 
控件定位 ()

.子程序 控件定位, 空白型, , 
赋值 (.左边, 相除 (相减 (ck后台配置.取用户区宽度 (), .宽度), 3))
赋值 (.顶边, 相除 (相减 (ck后台配置.取用户区高度 (), .高度), 2))
0.移动 (0, ck后台配置.取用户区宽度 (), ck后台配置.取用户区高度 ())

.子程序 _ck后台配置_尺寸被改变, 空白型, , 
控件定位 ()

.子程序 _确认1_被单击, 空白型, , 
.如果真 (等于 (信息框 (“确认要修改折扣配置吗？修改后配置将马上生效”, 相加 (#信息图标, #确认取消钮), “询问”), #取消钮))
    界面刷新 ()
    返回 ()
.如果真结束
.如果 (写配置项 (qj配置路径, “用户配置”, “押金折扣”, .取项目文本 (.现行选中项)))
    信息框 (“折扣配置已经保存！”, #信息图标, “成功”)
    赋值 (押金折扣, 相乘 (到数值 (.取项目文本 (.现行选中项)), 0.1))
    界面刷新 ()
.否则
    信息框 (“折扣配置已经失败！”, #错误图标, “失败”)
    界面刷新 ()
    
.如果结束


.子程序 界面刷新, 空白型, , 
赋值 (.可视, 假)
赋值 (.可视, 真)

.子程序 _确认3_被单击, 空白型, , 
.如果真 (等于 (信息框 (“确认要修改关闭时备份配置吗？修改后配置将马上生效”, 相加 (#信息图标, #确认取消钮), “询问”), #取消钮))
    界面刷新 ()
    返回 ()
.如果真结束
.如果 (写配置项 (qj配置路径, “用户配置”, “关闭时备份”, 选择 (.选中, “是”, “否”)))
    信息框 (“关闭时备份配置已经保存！”, #信息图标, “成功”)
    .如果 (.选中)
        赋值 (关闭时备份, 真)
    .否则
        赋值 (关闭时备份, 假)
    .如果结束
    界面刷新 ()
.否则
    信息框 (“关闭时备份配置失败！”, #错误图标, “失败”)
    界面刷新 ()
.如果结束


.子程序 _确认4_被单击, 空白型, , 
.如果真 (等于 (信息框 (“确认要修改运行时备份配置吗？修改后配置将马上生效”, 相加 (#信息图标, #确认取消钮), “询问”), #取消钮))
    界面刷新 ()
    返回 ()
.如果真结束
.如果真 (.选中)
    .如果 (写配置项 (qj配置路径, “用户配置”, “运行时备份”, “否”))
        信息框 (“运行时备份配置已经保存！”, #信息图标, “成功”)
        赋值 (运行时备份, 假)
        赋值 (运行时备份间隔, -1)
        赋值 (已经进行过赋值, 假)
        界面刷新 ()
    .否则
        信息框 (“运行时备份配置失败！”, #错误图标, “失败”)
        界面刷新 ()
    .如果结束
    
.如果真结束
.如果 (写配置项 (qj配置路径, “用户配置”, “运行时备份”, .取项目文本 (.现行选中项)))
    信息框 (“运行时备份配置已经保存！”, #信息图标, “成功”)
    赋值 (运行时备份, 真)
    赋值 (运行时备份间隔, 到数值 (.取项目文本 (.现行选中项)))
    赋值 (已经进行过赋值, 假)
    界面刷新 ()
.否则
    信息框 (“运行时备份配置失败！”, #错误图标, “失败”)
    界面刷新 ()
.如果结束



.窗口程序集 系统信息程序集, , , 

.子程序 _关闭_被单击, 空白型, , 
.局部变量 i, 整数型, , , 

.计次循环首 (255, i)
    SetLayeredWindowAttributes (ck系统信息.取窗口句柄 (), 0, 相减 (255, i), #LWA_ALPHA)
    处理事件 ()
.计次循环尾 ()
ck系统信息.销毁 ()



.子程序 _ck系统信息_创建完毕, 空白型, , 
.局部变量 Ret, 整数型, , , 

赋值 (Ret, GetWindowLong (ck系统信息.取窗口句柄 (), -20))
赋值 (Ret, 位或 (Ret, 524288))
SetWindowLong (ck系统信息.取窗口句柄 (), -20, Ret)
SetLayeredWindowAttributes (ck系统信息.取窗口句柄 (), 0, 200, #LWA_ALPHA)


.窗口程序集 暂时离开程序集, , , 

.子程序 _关闭_被单击, 空白型, , 
.局部变量 temp, 文本型, , , 

.如果真 (不等于 (删全部空 (.内容), “”))
    qj数据库路径.未知支持库函数_1 (qj数据库密码)
    .未知支持库函数_12 ()
    相加 (“select 用户密码 from 用户表 where 用户名称='”, qj用户名称, “'”).未知支持库函数_14 (#)
    0.未知支持库函数_26 (temp)
    未知支持库函数_16 ()
    未知支持库函数_3 ()
    .如果真 (等于 (temp, .内容))
        渐渐关闭 ()
    .如果真结束
    
.如果真结束


.子程序 渐渐关闭, 空白型, , 
.局部变量 i, 整数型, , , 

.计次循环首 (255, i)
    SetLayeredWindowAttributes (ck暂时离开.取窗口句柄 (), 0, 相减 (255, i), #LWA_ALPHA)
    处理事件 ()
.计次循环尾 ()
ck暂时离开.销毁 ()


.子程序 _ck暂时离开_创建完毕, 空白型, , 
.局部变量 Ret, 整数型, , , 

赋值 (Ret, GetWindowLong (ck暂时离开.取窗口句柄 (), -20))
赋值 (Ret, 位或 (Ret, 524288))
SetWindowLong (ck暂时离开.取窗口句柄 (), -20, Ret)
SetLayeredWindowAttributes (ck暂时离开.取窗口句柄 (), 0, 200, #LWA_ALPHA)


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 GetTheFolder, 文本型, , 获取文件夹全路径
.参数 hWnd, 整数型, , 所有者窗口句柄
.参数 Title, 文本型, , 说明标题
.参数 StartDir, 文本型, , 起始目录
.参数 haveStatusTextOrNot, 逻辑型, , 有没有状态条(自定义的参数，原函数中没有)



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 实例已是否创建, 逻辑型, , 返回真表示实例已存在，假表示实例不存在
.参数 实例名, 文本型, , 一个表示实例名的文本,建议给一个难以重复的文本以防止冲突



.子程序 到前台, 空白型, , 
.参数 hWnd, 整数型, , 




 ' 不属于任何一个程序集、类模块的函数：
