 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' shell 52F260023059454187AF826A3C07AF2A 3 0 操作系统界面功能支持库
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 2 0 多线程支持库




数据类型 安全属性, , SECURITY_ATTRIBUTES
    .成员 长度, 整数型, , , 
    .成员 权限, 整数型, , , 
    .成员 句柄, 整数型, , , 

数据类型 进程信息, , 
    .成员 进程号, 整数型, , , 
    .成员 线程号, 整数型, , , 
    .成员 进程ID, 整数型, , , 
    .成员 线程ID, 整数型, , , 

数据类型 启动信息, , 
    .成员 cb, 整数型, , , 
    .成员 lpReserved, 整数型, , , 
    .成员 lpDesktop, 整数型, , , 
    .成员 lpTitle, 整数型, , , 
    .成员 dwX, 整数型, , , 
    .成员 dwY, 整数型, , , 
    .成员 dwXSize, 整数型, , , 
    .成员 dwYSize, 整数型, , , 
    .成员 dwXCountChars, 整数型, , , 
    .成员 dwYCountChars, 整数型, , , 
    .成员 dwFillAttribute, 整数型, , , 
    .成员 dwFlags, 整数型, , , 
    .成员 wShowWindow, 短整数型, , , 
    .成员 cbReserved2, 短整数型, , , 
    .成员 lpReserved2, 整数型, , , 
    .成员 hStdInput, 整数型, , , 
    .成员 hStdOutput, 整数型, , , 
    .成员 hStdError, 整数型, , , 


.DLL命令 创建匿名管道, 整数型, "", "CreatePipe", , 
    .参数 输出管道, 整数型, 传址, 
    .参数 输入管道, 整数型, 传址, 
    .参数 管道属性, 安全属性, 传址, 
    .参数 尺寸, 整数型, , 

.DLL命令 创建进程, 整数型, "", "CreateProcessA", , 
    .参数 程序名称, 整数型, , 32位程序用，可设为文本型
    .参数 命令行, 文本型, , 
    .参数 进程属性, 整数型, , 
    .参数 线程属性, 整数型, , 
    .参数 参数一, 整数型, , 
    .参数 参数二, 整数型, , 
    .参数 参数三, 整数型, , 
    .参数 运行目录, 文本型, , 如需指定运行目录设为文本行
    .参数 启动信息, 启动信息, , 
    .参数 进程信息, 进程信息, , 

.DLL命令 读文件, 整数型, "", "ReadFile", , 
    .参数 文件号, 整数型, , 
    .参数 缓存, 字节集, 传址, 
    .参数 读取尺寸, 整数型, , 
    .参数 实际尺寸, 整数型, 传址, 
    .参数 参数, 整数型, , 

.DLL命令 写文件, 整数型, "", "WriteFile", , 
    .参数 文件号, 整数型, , 
    .参数 写入内容, 字节集, 传址, 
    .参数 写入尺寸, 整数型, , 
    .参数 实际尺寸, 整数型, 传址, 
    .参数 参数, 整数型, , 

.DLL命令 关闭句柄, 整数型, "", "CloseHandle", , 
    .参数 句柄, 整数型, , 

.DLL命令 获取启动信息_, 整数型, "kernel32", "GetStartupInfoA", , 
    .参数 启动信息, 启动信息, 传址, 

.DLL命令 打开进程句柄, 整数型, "", "OpenProcess", , 
    .参数 访问方法, 整数型, , 
    .参数 子程序继承, 逻辑型, , 是否由子程序继承
    .参数 进程标识符, 整数型, , 

.程序集 程序集1, , , 

.程序集变量 读管道a, 整数型, , , 
.程序集变量 写管道a, 整数型, , , 
.程序集变量 读管道b, 整数型, , , 
.程序集变量 写管道b, 整数型, , , 
.程序集变量 进程信息, 进程信息, , , 
.程序集变量 已连接, 逻辑型, , , 
.程序集变量 进入许可证, 整数型, , , 
.程序集变量 安全属性, 安全属性, , , 
.子程序 控制台发送, 空白型, , 
.参数 命令行, 文本型, , 

.局部变量 临时, 字节集, , , 


.如果真 (已连接)
    赋值 (临时, 到字节集 (命令行))
    写文件 (写管道a, 临时, 取字节集长度 (临时), 0, 0)
    
    
.如果真结束


.子程序 控制台连接, 逻辑型, , 
.局部变量 启动信息, 启动信息, , , 
.局部变量 系统目录, 文本型, , , 
.局部变量 cmd名称, 文本型, , , 
.局部变量 进程id, 整数型, , , 

赋值 (安全属性.长度, 12)
赋值 (安全属性.权限, 0)
赋值 (安全属性.句柄, -1)
.如果真 (或者 (等于 (创建匿名管道 (读管道a, 写管道a, 安全属性, 0), 0), 等于 (创建匿名管道 (读管道b, 写管道b, 安全属性, 0), 0)))
    返回 (假)
    
.如果真结束
获取启动信息_ (启动信息)
赋值 (启动信息.dwFlags, 257)
赋值 (启动信息.hStdInput, 读管道a)
赋值 (启动信息.hStdOutput, 写管道b)
赋值 (启动信息.hStdError, 写管道b)
赋值 (启动信息.wShowWindow, 0)
赋值 (系统目录, 未知支持库函数_7 (#))
赋值 (cmd名称, “cmd.exe”)
赋值 (进程id, 创建进程 (0, cmd名称, 0, 0, -1, 0, 0, 系统目录, 启动信息, 进程信息))
.如果真 (等于 (进程id, 0))
    返回 (假)
.如果真结束
赋值 (已连接, 真)
控制台取回信息 ()
返回 (真)

.子程序 控制台取回信息, 空白型, , 
.如果真 (已连接)
    未知支持库函数_0 (&读管道, , )
    
.如果真结束


.子程序 读管道, 空白型, , 
.局部变量 缓存, 字节集, , , 
.局部变量 实际尺寸, 整数型, , , 
.局部变量 发送数据, 文本型, , , 

赋值 (缓存, 取空白字节集 (260))
.判断循环首 (并且 (不等于 (读文件 (读管道b, 缓存, 260, 实际尺寸, 0), 0), 不等于 (实际尺寸, 0)))
    赋值 (发送数据, 到文本 (取字节集左边 (缓存, 实际尺寸)))
    输出调试文本 (发送数据)
    赋值 (发送数据, 相加 (“回显命令”, 发送数据))
    _启动窗口.发送数据 (., 发送数据)
.判断循环尾 ()


.窗口程序集 窗口程序集1, , , 

.程序集变量 系统目录, 文本型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.如果真 (等于 (“127.0.0.1”.连接 (1000), 假))
    结束 ()
.如果真结束
赋值 (系统目录, 未知支持库函数_7 (#))
.如果真 (等于 (控制台连接 (), 假))
    结束 ()
.如果真结束


.子程序 _客户1_数据到达, 空白型, , 
.局部变量 返回数据, 文本型, , , 
.局部变量 命令类型, 文本型, , , 

赋值 (返回数据, 到文本 (取回数据 ()))
赋值 (命令类型, 取文本左边 (返回数据, 8))
.判断开始 (等于 (命令类型, “命令信息”))
    赋值 (返回数据, 相加 (删首尾空 (取文本右边 (返回数据, 相减 (取文本长度 (返回数据), 8))), #换行符))
    控制台发送 (返回数据)
.默认
    
.判断结束



 ' 不属于任何一个程序集、类模块的函数：
