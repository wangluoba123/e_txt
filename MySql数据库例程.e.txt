 ' 文件类型：Windows窗口程序

 ' 程序名称：MySql数据库操作例程
 ' 程序描述：本程序演示了如何操作MySql数据库
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 493
    高度 = 475
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “易语言帮助文档 - MySql数据库例程”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 6 扩展界面支持库一
 ' mysql 7F54B9CE8887428dBA9CEEB94CEF4C72 3 0 MySQL支持库





.窗口程序集 启动窗口程序集, , , 

.程序集变量 MySql句柄, 整数型, , , 
.程序集变量 记录集句柄, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 服务器版本, 文本型, , , 
.局部变量 客户端版本, 文本型, , , 

赋值 (MySql句柄, 未知支持库函数_1 (“”, “root”, “”, “test”, 0))
 ' 连接本地MySql数据库
未知支持库函数_3 (MySql句柄, “select * from test”)
赋值 (记录集句柄, 未知支持库函数_4 (MySql句柄))
未知支持库函数_23 (MySql句柄, 服务器版本)
未知支持库函数_24 (客户端版本)
相加 (“MySql句柄：”, 到文本 (MySql句柄)).加入项目 ()
相加 (“服务器版本：”, 服务器版本).加入项目 ()
相加 (“客户端版本：”, 客户端版本).加入项目 ()
赋值 (.现行选中项, 相减 (取项目数 (), 1))

.子程序 _执行按钮_被单击, 空白型, , 
.局部变量 SQL语句, 文本型, , , 
.局部变量 索引, 整数型, , , 
.局部变量 name字段, 文本型, , , 
.局部变量 number字段, 文本型, , , 
.局部变量 子记录集句柄, 整数型, , , 

.如果真 (等于 (输入框 (“SQL语句”, , “select * from test”, SQL语句, ), 真))
    未知支持库函数_3 (MySql句柄, SQL语句)
    相加 (SQL语句, “正在执行。。。”).加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
    全部删除 ()
    赋值 (子记录集句柄, 未知支持库函数_4 (MySql句柄))
    .计次循环首 (未知支持库函数_7 (子记录集句柄), )
        未知支持库函数_6 (子记录集句柄, “name”, name字段)
        赋值 (索引, .插入表项 (name字段, , , , ))
        未知支持库函数_6 (子记录集句柄, “number”, number字段)
        索引.置标题 (1, number字段)
        未知支持库函数_10 (子记录集句柄)
    .计次循环尾 ()
    未知支持库函数_5 (子记录集句柄)
    相加 (SQL语句, “执行完毕！”).加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.如果真结束


.子程序 _读字段值按钮_被单击, 空白型, , 
.局部变量 字段内容, 文本型, , , 

.如果真 (等于 (未知支持库函数_6 (记录集句柄, “name”, 字段内容), 真))
    相加 (“name字段内容为：”, 字段内容).加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.如果真结束


.子程序 _到下一行按钮_被单击, 空白型, , 
.如果 (不等于 (MySql句柄, 0))
    .如果 (等于 (未知支持库函数_10 (记录集句柄), 真))
        “到下一行成功”.加入项目 ()
        赋值 (.现行选中项, 相减 (取项目数 (), 1))
    .否则
        “到尾记录”.加入项目 ()
        赋值 (.现行选中项, 相减 (取项目数 (), 1))
    .如果结束
    
.否则
    “MySql数据库尚未打开,请先打开数据库在操作！”.加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.如果结束


.子程序 _到指定行按钮_被单击, 空白型, , 
.局部变量 行号, 整数型, , , 

.如果真 (等于 (输入框 (“指定行号”, , , 行号, #整数型), 真))
    .如果真 (等于 (未知支持库函数_11 (记录集句柄, 行号), 真))
        “到指定行成功”.加入项目 ()
        赋值 (.现行选中项, 相减 (取项目数 (), 1))
    .如果真结束
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.如果真结束


.子程序 _到首行按钮_被单击, 空白型, , 
.如果 (不等于 (MySql句柄, 0))
    .如果真 (等于 (未知支持库函数_12 (记录集句柄), 真))
        “到首行成功！”.加入项目 ()
        赋值 (.现行选中项, 相减 (取项目数 (), 1))
    .如果真结束
    
.否则
    “MySql数据库尚未打开,请先打开数据库在操作！”.加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.如果结束


.子程序 _到尾行按钮_被单击, 空白型, , 
.如果 (不等于 (MySql句柄, 0))
    .如果真 (等于 (未知支持库函数_13 (记录集句柄), 真))
        “到尾行成功！”.加入项目 ()
        赋值 (.现行选中项, 相减 (取项目数 (), 1))
    .如果真结束
    
.否则
    “MySql数据库尚未打开,请先打开数据库在操作！”.加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.如果结束


.子程序 _查找记录按钮_被单击, 空白型, , 
.局部变量 语句, 文本型, , , 
.局部变量 name字段, 文本型, , , 
.局部变量 索引, 整数型, , , 
.局部变量 number字段, 文本型, , , 
.局部变量 子记录集句柄, 整数型, , , 

.如果真 (等于 (输入框 (“请输入查找条件”, , “1=1”, 语句, ), 真))
    赋值 (子记录集句柄, 未知支持库函数_17 (MySql句柄, “test”, “name”, 语句, “name ASC”))
    .计次循环首 (未知支持库函数_7 (子记录集句柄), )
        未知支持库函数_6 (子记录集句柄, “name”, name字段)
        赋值 (索引, .插入表项 (name字段, , , , ))
        未知支持库函数_6 (子记录集句柄, 2, number字段)
        索引.置标题 (1, number字段)
        未知支持库函数_10 (子记录集句柄)
    .计次循环尾 ()
    相加 (语句, “执行完毕！”).加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.如果真结束


.子程序 _增加记录按钮_被单击, 空白型, , 
.局部变量 name字段, 文本型, , , 
.局部变量 索引, 整数型, , , 
.局部变量 number字段, 文本型, , , 
.局部变量 赋值语句, 文本型, , , 

输入框 (“赋值语句”, , “name='易语言',number=123”, 赋值语句, )
.如果真 (等于 (未知支持库函数_18 (MySql句柄, “test”, 赋值语句), 真))
    全部删除 ()
    未知支持库函数_5 (记录集句柄)
    未知支持库函数_3 (MySql句柄, “select * from test”)
    赋值 (记录集句柄, 未知支持库函数_4 (MySql句柄))
    未知支持库函数_12 (记录集句柄)
    .计次循环首 (未知支持库函数_7 (记录集句柄), )
        未知支持库函数_6 (记录集句柄, “name”, name字段)
        赋值 (索引, .插入表项 (name字段, , , , ))
        未知支持库函数_6 (记录集句柄, “number”, number字段)
        索引.置标题 (1, number字段)
        未知支持库函数_10 (记录集句柄)
    .计次循环尾 ()
    “增加记录执行完毕！”.加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.如果真结束


.子程序 _更新记录按钮_被单击, 空白型, , 
.局部变量 name字段, 文本型, , , 
.局部变量 索引, 整数型, , , 
.局部变量 number字段, 文本型, , , 
.局部变量 赋值语句, 文本型, , , 
.局部变量 条件语句, 文本型, , , 

输入框 (“赋值语句”, , “name='111',number=110”, 赋值语句, )
输入框 (“条件语句”, , “name='888'”, 条件语句, )
.如果真 (等于 (未知支持库函数_19 (MySql句柄, “test”, 赋值语句, 条件语句), 真))
    全部删除 ()
    未知支持库函数_5 (记录集句柄)
    未知支持库函数_3 (MySql句柄, “select * from test”)
    赋值 (记录集句柄, 未知支持库函数_4 (MySql句柄))
    未知支持库函数_12 (记录集句柄)
    .计次循环首 (未知支持库函数_7 (记录集句柄), )
        未知支持库函数_6 (记录集句柄, “name”, name字段)
        赋值 (索引, .插入表项 (name字段, , , , ))
        未知支持库函数_6 (记录集句柄, “number”, number字段)
        索引.置标题 (1, number字段)
        未知支持库函数_10 (记录集句柄)
    .计次循环尾 ()
    “更新记录执行完毕！”.加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.如果真结束


.子程序 _删除记录按钮_被单击, 空白型, , 
.局部变量 name字段, 文本型, , , 
.局部变量 索引, 整数型, , , 
.局部变量 number字段, 文本型, , , 
.局部变量 条件语句, 文本型, , , 

输入框 (“条件语句”, , “name='易语言'”, 条件语句, )
.如果真 (等于 (未知支持库函数_20 (MySql句柄, “test”, 条件语句), 真))
    未知支持库函数_5 (记录集句柄)
    全部删除 ()
    赋值 (记录集句柄, 未知支持库函数_4 (MySql句柄))
    .计次循环首 (未知支持库函数_7 (记录集句柄), )
        未知支持库函数_6 (记录集句柄, “name”, name字段)
        赋值 (索引, .插入表项 (name字段, , , , ))
        未知支持库函数_6 (记录集句柄, 2, number字段)
        索引.置标题 (1, number字段)
        未知支持库函数_10 (记录集句柄)
    .计次循环尾 ()
    “删除成功！”.加入项目 ()
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
.如果真结束


.子程序 _字段操作按钮_被单击, 空白型, , 
.局部变量 字段名变量, 文本型, , , 
.局部变量 序号, 整数型, , , 

相加 (“字段总数号为：”, 到文本 (未知支持库函数_14 (记录集句柄))).加入项目 ()
未知支持库函数_15 (记录集句柄, 1, 字段名变量)
未知支持库函数_16 (记录集句柄, “name”, 序号)
相加 (“序号1到字段名为：”, 字段名变量).加入项目 ()
相加 (“字段名name到序号为：”, 到文本 (序号)).加入项目 ()
相加 (“字段name宽度为：”, 到文本 (未知支持库函数_21 (记录集句柄, 0))).加入项目 ()
相加 (“字段name属性为：”, 到文本 (未知支持库函数_22 (记录集句柄, “name”))).加入项目 ()
.如果 (等于 (未知支持库函数_47 (记录集句柄, 0), 假))
    “字段name不为空！”.加入项目 ()
.否则
    “字段name为空！”.加入项目 ()
.如果结束
赋值 (.现行选中项, 相减 (取项目数 (), 1))

.子程序 _建立索引按钮_被单击, 空白型, , 
.局部变量 错误信息, 文本型, , , 

.如果 (等于 (未知支持库函数_39 (MySql句柄, “test”, “name”, “a”), 真))
    “建立索引成功！”.加入项目 ()
.否则
    未知支持库函数_41 (MySql句柄, 错误信息)
    信息框 (错误信息, 0, )
.如果结束
赋值 (.现行选中项, 相减 (取项目数 (), 1))

.子程序 _删除索引按钮_被单击, 空白型, , 
.局部变量 错误信息, 文本型, , , 

.如果 (等于 (未知支持库函数_40 (MySql句柄, “name”, “a”), 真))
    “删除索引成功！”.加入项目 ()
.否则
    未知支持库函数_41 (MySql句柄, 错误信息)
    信息框 (错误信息, 0, )
.如果结束
赋值 (.现行选中项, 相减 (取项目数 (), 1))

.子程序 _事务操作按钮_被单击, 空白型, , 
.局部变量 name字段, 文本型, , , 

未知支持库函数_42 (MySql句柄)
未知支持库函数_6 (记录集句柄, “name”, name字段)
未知支持库函数_43 (MySql句柄)
.如果真 (等于 (name字段, “”))
    未知支持库函数_44 (MySql句柄)
.如果真结束


.子程序 _到MYSQL文本按钮_被单击, 空白型, , 
信息框 (未知支持库函数_45 (取现行时间 (), 12), 0, )

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
未知支持库函数_2 (MySql句柄)


 ' 不属于任何一个程序集、类模块的函数：
