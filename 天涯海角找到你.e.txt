 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 556
    高度 = 398
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\天涯海角找到你.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “漫步云端校友录”
    帮助文件名 = “”

窗口 窗口_添加
    左边 = 50
    顶边 = 50
    宽度 = 553
    高度 = 354
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 12632256 '  0xC0C0C0
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “漫步云端校友录”
    帮助文件名 = “”

窗口 窗口_查找
    左边 = 50
    顶边 = 50
    宽度 = 552
    高度 = 376
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “漫步云端校友录”
    帮助文件名 = “”

窗口 窗口_浏览
    左边 = 50
    顶边 = 50
    宽度 = 528
    高度 = 370
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = 12632256 '  0xC0C0C0
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “漫步云端校友录”
    帮助文件名 = “”

窗口 窗口_关于
    左边 = 50
    顶边 = 50
    宽度 = 361
    高度 = 288
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\天涯海角找到你.e\窗口_关于_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “漫步云端校友录”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' spec A512548E76954B6E92C21055517615B0 2 1 特殊功能支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二




.全局变量 外部数据库, 外部数据库, , , 

.窗口程序集 添加_窗口程序集, , , 

.程序集变量 记录集句柄, 整数型, , , 
.子程序 _窗口_添加_创建完毕, 空白型, , 
未知函数_231 () ' *** 缩略程序块 ***
 ' .如果 (不等于 (_启动窗口.., -1))
     ' 窗口_添加.标题 ＝ “编辑当前记录”
     ' 读当前记录 ()
.否则
     ' 窗口_添加.标题 ＝ “添加记录”
.如果结束


.子程序 _超级按钮_保存_被单击, 空白型, , 
赋值 (外部数据库, )
外部数据库.打开MDB数据库 (相加 (取运行目录 (), “\db1.mdb”), , , , )
未知函数_408 () ' *** 缩略程序块 ***
'外部数据库.执行 (“insert into 同学信息(姓名,年龄,性别,家庭住址,备注,QQ,照片)values('” ＋ 编辑框_姓名.内容 ＋ “','” ＋ 选择 (编辑框_年龄.内容 ＝ “”, “不知道多大”, 编辑框_年龄.内容) ＋ “','” ＋ 组合框_性别.内容 ＋ “','” ＋ 编辑框_家庭住址.内容 ＋ “','” ＋ 编辑框_备注.内容 ＋ “','” ＋ 选择 (编辑框_QQ.内容 ＝ “”, “无QQ号”, 编辑框_QQ.内容) ＋ “',?)”, 图片框_照片.图片)
未知函数_388 () ' *** 缩略程序块 ***
 ' 调试输出 (“insert into 同学信息(姓名,年龄,性别,家庭住址,备注,QQ,照片) values （'” ＋ 编辑框_姓名.内容 ＋ “','” ＋ 选择 (编辑框_年龄.内容 ＝ “”, “不知道多大”, 编辑框_年龄.内容) ＋ “','” ＋ 组合框_性别.内容 ＋ “','” ＋ 编辑框_家庭住址.内容 ＋ “','” ＋ 编辑框_备注.内容 ＋ “','” ＋ 选择 (编辑框_QQ.内容 ＝ “”, “无QQ号码”, 编辑框_QQ.内容) ＋ “',?）”)
.如果 (等于 (外部数据库.执行 (相加 (“insert into 同学信息(姓名,年龄,性别,家庭住址,备注,QQ,照片)values('”, .内容, “','”, 选择 (等于 (.内容, “”), “不知道多大”, .内容), “','”, .内容, “','”, .内容, “','”, .内容, “','”, 选择 (等于 (.内容, “”), “无QQ号码”, .内容), “',?)”), .图片), 真))
    信息框 (“保存成功！”, #信息图标, “漫步云端友情提示：”)
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容)
    赋值 (.图片, {  })
    _启动窗口.刷新显示记录 (外部数据库.查询 (“select * from 同学信息”))
.否则
    信息框 (“保存失败！”, 0, )
.如果结束


.子程序 _超级按钮_查找_被单击, 空白型, , 
赋值 (_启动窗口., 真)
窗口_添加.销毁 ()
载入 (窗口_查找, , 真)

.子程序 _超级按钮_浏览_被单击, 空白型, , 
窗口_添加.销毁 ()
载入 (窗口_浏览, , 真)

.子程序 _超级按钮_照片_被单击, 空白型, , 
打开 ()
赋值 (.图片, 读入文件 (.文件名))

.子程序 _超级按钮_退出_被单击, 空白型, , 
窗口_添加.销毁 ()

.窗口程序集 _启动窗口窗口程序集, , , 

.程序集变量 记录集句柄, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
置托盘图标 (_启动窗口., .)
赋值 (外部数据库, )
外部数据库.打开MDB数据库 (相加 (取运行目录 (), “\db1.mdb”), , , , )
刷新显示记录 (外部数据库.查询 (“select * from 同学信息”))

.子程序 _添加记录_被选择, 空白型, , 
载入 (窗口_添加, , 真)

.子程序 _删除当前记录_被选择, 空白型, , 
.局部变量 程序集_编号, 整数型, , , 

赋值 (记录集句柄, 外部数据库.查询 (相加 (“select * from 同学信息 where 编号=”, 到文本 (_启动窗口.取表项数值 (., _启动窗口..)))))
赋值 (程序集_编号, 外部数据库.读 (记录集句柄, “编号”))
.如果 (不等于 (., -1))
    外部数据库.执行 (相加 (“delete  from 同学信息 where 编号=”, 到文本 (程序集_编号)), )
    外部数据库.到后一记录 (记录集句柄)
.否则
    
.如果结束
.如果真 (并且 (大于或等于 (., 0), 等于 (信息框 (“确定要删除当前记录吗？”, 相加 (1, #询问图标), “漫步云端友情提示：”), 0)))
    .删除表项 (.)
.如果真结束


.子程序 _修改当前记录_被选择, 空白型, , 
载入 (窗口_浏览, , 真)

.子程序 _浏览记录_被选择, 空白型, , 
载入 (窗口_浏览, , 真)

.子程序 _查找同学_被选择, 空白型, , 
载入 (窗口_查找, , 真)

.子程序 _关于校友录_被选择, 空白型, , 
载入 (窗口_关于, , 真)

.子程序 _打开校友录_被选择, 空白型, , 
赋值 (_启动窗口., 真)

.子程序 _退出_被选择, 空白型, , 
.如果真 (等于 (信息框 (“真的要退出吗？”, 相加 (1, #询问图标), ), 0))
    _启动窗口.销毁 ()
    关闭 ()
    结束 ()
.如果真结束


.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.如果真 (等于 (按钮索引, 1))
    载入 (窗口_添加, , 真)
.如果真结束
.如果真 (等于 (按钮索引, 2))
    _删除当前记录_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 3))
    载入 (窗口_浏览, , 真)
.如果真结束
.如果真 (等于 (按钮索引, 5))
    载入 (窗口_浏览, , 真)
.如果真结束
.如果真 (等于 (按钮索引, 6))
    载入 (窗口_查找, , 真)
.如果真结束
.如果真 (等于 (按钮索引, 8))
    载入 (窗口_关于, , 真)
.如果真结束
.如果真 (等于 (按钮索引, 10))
    赋值 (_启动窗口., 假)
.如果真结束


.子程序 刷新显示记录, 空白型, , 
.参数 全局_记录集句柄, 整数型, , 

.局部变量 ID, 整数型, , , 

 ' .计次循环首 (取表项数 (), )
     ' 超级列表框1.删除表项 (0)
 ' .计次循环尾 ()
全部删除 ()
赋值 (记录集句柄, 全局_记录集句柄)
外部数据库.到首记录 (记录集句柄)
.判断循环首 (等于 (外部数据库.尾记录后 (记录集句柄), 假))
    赋值 (ID, 相加 (取表项数 (), 1).插入表项 (外部数据库.读 (记录集句柄, “编号”)))
    ID.置标题 (0, 外部数据库.读 (记录集句柄, “姓名”))
    ID.置标题 (1, 外部数据库.读 (记录集句柄, “年龄”))
    ID.置标题 (2, 外部数据库.读 (记录集句柄, “性别”))
    ID.置标题 (3, 外部数据库.读 (记录集句柄, “QQ”))
    ID.置标题 (4, 外部数据库.读 (记录集句柄, “家庭住址”))
    ID.置标题 (5, 外部数据库.读 (记录集句柄, “备注”))
    ID.置标题 (0, 外部数据库.读 (记录集句柄, “姓名”))
    外部数据库.到后一记录 (记录集句柄)
.判断循环尾 ()
外部数据库.关闭记录集 (记录集句柄)


.子程序 _超级列表框1_表项被激活, 空白型, , 
.如果 (不等于 (., -1))
    载入 (窗口_浏览, , 真)
    刷新显示记录 (外部数据库.查询 (“select * from 同学信息”))
.否则
    .如果真 (小于 (., 0))
        返回 ()
    .如果真结束
    
.如果结束


.子程序 __启动窗口_托盘事件, 空白型, , 
.参数 操作类型, 整数型, , 

.如果真 (等于 (操作类型, 2)) ' ----------------左键双击
    赋值 (_启动窗口., 真)
    调整层次 (#顶层)
.如果真结束
.如果真 (等于 (操作类型, 3)) ' -----------------右键单击
    弹出托盘菜单 ()
    
.如果真结束


.窗口程序集 查找_窗口程序集, , , 

.程序集变量 记录集句柄, 整数型, , , 
.子程序 _窗口_查找_创建完毕, 空白型, , 
调试输出 (相加 (“select * from 同学信息 where ”, .内容, “='”, .内容, “'”))

.子程序 _按钮_查找_被单击, 空白型, , 
窗口_查找.全部删除 (.)
.如果 (等于 (.内容, “”))
    信息框 (“请输入要查找的内容！”, #警告图标, “漫步云端友情提示：”)
.否则
    .如果 (等于 (.内容, “”))
        信息框 (“请选择要查找的关键字！”, #警告图标, “漫步云端友情提示：”)
        外部数据库.关闭记录集 (记录集句柄)
    .否则
        赋值 (记录集句柄, 外部数据库.查询 (相加 (“select count(*) as a from 同学信息 where ”, .内容, “='”, .内容, “'”)))
        .如果真 (等于 (外部数据库.读 (记录集句柄, “a”), 0))
            信息框 (“没有符合您所查找的记录！”, #警告图标, “漫步云端友情提示：”)
            外部数据库.关闭记录集 (记录集句柄)
            返回 ()
        .如果真结束
        外部数据库.关闭记录集 (记录集句柄)
        赋值 (记录集句柄, 外部数据库.查询 (相加 (“select * from 同学信息 where ”, .内容, “='”, .内容, “'”)))
        外部数据库.到首记录 (记录集句柄)
        显示记录 (记录集句柄)
    .如果结束
    
.如果结束






.子程序 _按钮_退出_被单击, 空白型, , 
窗口_查找.销毁 ()

.子程序 显示记录, 空白型, , 
.参数 参数_记录集句柄, 整数型, , 

.局部变量 ID, 整数型, , , 

赋值 (记录集句柄, 参数_记录集句柄)
外部数据库.到首记录 (记录集句柄)
.判断循环首 (等于 (外部数据库.尾记录后 (记录集句柄), 假))
    赋值 (ID, 相加 (取表项数 (), 1).插入表项 ())
    ID.置标题 (0, 外部数据库.读 (记录集句柄, “姓名”))
    ID.置标题 (1, 外部数据库.读 (记录集句柄, “年龄”))
    ID.置标题 (2, 外部数据库.读 (记录集句柄, “性别”))
    ID.置标题 (3, 外部数据库.读 (记录集句柄, “QQ”))
    ID.置标题 (4, 外部数据库.读 (记录集句柄, “家庭住址”))
    ID.置标题 (5, 外部数据库.读 (记录集句柄, “备注”))
    外部数据库.到后一记录 (记录集句柄)
.判断循环尾 ()
外部数据库.关闭记录集 (记录集句柄)

.窗口程序集 浏览_窗口程序集, , , 

.程序集变量 记录集句柄, 整数型, , , 
.程序集变量 程序集_编号, 整数型, , , 
.子程序 _窗口_浏览_创建完毕, 空白型, , 
.如果 (不等于 (_启动窗口.., -1))
    赋值 (窗口_浏览., “修改当前记录：”)
    赋值 (., 真)
    赋值 (., 真)
    赋值 (程序集_编号, _启动窗口.取表项数值 (., _启动窗口..))
    读当前记录 ()
.否则
    赋值 (窗口_浏览., “浏览所有同学信息：”)
    赋值 (记录集句柄, 外部数据库.查询 (“select * from 同学信息”))
    外部数据库.到首记录 (记录集句柄)
    赋值 (程序集_编号, 外部数据库.读 (记录集句柄, “编号”))
    显示记录 ()
.如果结束


.子程序 _按钮_删除_被单击, 空白型, , 
未知函数_127 () ' *** 缩略程序块 ***
调试输出 (外部数据库.执行 (相加 (“delete from 同学信息 where 编号=”, 到文本 (程序集_编号)), ))
 ' .如果 (等于 (外部数据库.尾记录后 (记录集句柄), 假))
    未知函数_231 () ' *** 缩略程序块 ***
     ' 外部数据库.执行 (“delete from 同学信息 where 编号=” ＋ 到文本 (程序集_编号), )
     ' 信息框 (“删除成功!”, #信息图标, “漫步云端友情提示：”)
     ' 外部数据库.到后一记录 (记录集句柄)
.否则
    未知函数_271 () ' *** 缩略程序块 ***
     ' 连续赋值 (“”, 编辑框_QQ.内容, 编辑框_备注.内容, 编辑框_年龄.内容, 编辑框_姓名.内容, 编辑框_家庭住址.内容, 组合框_性别.内容)
     ' 图片框_照片.图片 ＝ {  }
     ' 信息框 (“已无记录可删除”, #信息图标, “漫步云端友情提示：”)
.如果结束


.子程序 读当前记录, 空白型, , 
赋值 (.内容, _启动窗口.取标题 (., _启动窗口.., 0))
赋值 (.内容, _启动窗口.取标题 (., _启动窗口.., 1))
 ' 组合框_性别.内容 ＝ _启动窗口.超级列表框1.取标题 (_启动窗口.超级列表框1.现行选中项, 2)
.判断开始 (等于 (_启动窗口.取标题 (., _启动窗口.., 2), “男”))
    赋值 (.现行选中项, 0)
.判断 (等于 (_启动窗口.取标题 (., _启动窗口.., 2), “女”))
    赋值 (.现行选中项, 1)
.默认
    赋值 (.现行选中项, 2)
.判断结束
调试输出 (_启动窗口.取标题 (., _启动窗口.., 2))
赋值 (.内容, _启动窗口.取标题 (., _启动窗口.., 3))
赋值 (.内容, _启动窗口.取标题 (., _启动窗口.., 4))
赋值 (.内容, _启动窗口.取标题 (., _启动窗口.., 5))
外部数据库.关闭记录集 (记录集句柄)
未知函数_149 () ' *** 缩略程序块 ***
 ' 调试输出 (“select * from 同学信息 where 编号=” ＋ 到文本 (_启动窗口.超级列表框1.取表项数值 (_启动窗口.超级列表框1.现行选中项)))
赋值 (记录集句柄, 外部数据库.查询 (相加 (“select * from 同学信息 where 编号=”, 到文本 (_启动窗口.取表项数值 (., _启动窗口..)))))
外部数据库.到首记录 (记录集句柄)
未知函数_67 () ' *** 缩略程序块 ***
 ' 调试输出 (外部数据库.读 (记录集句柄, “姓名”))
赋值 (.图片, 外部数据库.读 (记录集句柄, “照片”))
外部数据库.关闭记录集 (记录集句柄)

.子程序 显示记录, 空白型, , 
赋值 (.内容, 外部数据库.读 (记录集句柄, “姓名”))
赋值 (.内容, 外部数据库.读 (记录集句柄, “年龄”))
赋值 (.内容, 外部数据库.读 (记录集句柄, “QQ”))
赋值 (.内容, 外部数据库.读 (记录集句柄, “家庭住址”))
赋值 (.内容, 外部数据库.读 (记录集句柄, “备注”))
.判断开始 (等于 (外部数据库.读 (记录集句柄, “性别”), “男”))
    赋值 (.现行选中项, 0)
.判断 (等于 (外部数据库.读 (记录集句柄, “性别”), “女”))
    赋值 (.现行选中项, 1)
.默认
    赋值 (.现行选中项, 2)
.判断结束
赋值 (.图片, 外部数据库.读 (记录集句柄, “照片”))

.子程序 _图片框_照片_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

打开 ()
赋值 (.图片, 读入文件 (.文件名))

.子程序 _超级按钮_上一条_被单击, 空白型, , 
外部数据库.到前一记录 (记录集句柄)
.如果 (等于 (外部数据库.首记录前 (记录集句柄), 假))
    窗口_浏览.显示记录 ()
.否则
    外部数据库.到首记录 (记录集句柄)
    信息框 (“前面已无记录！”, #信息图标, “漫步云端友情提示：”)
.如果结束


.子程序 _超级按钮_下一条_被单击, 空白型, , 
外部数据库.到后一记录 (记录集句柄)
.如果 (等于 (外部数据库.尾记录后 (记录集句柄), 假))
    窗口_浏览.显示记录 ()
.否则
    外部数据库.到尾记录 (记录集句柄)
    信息框 (“后面已无记录了！”, 0, )
.如果结束


.子程序 _超级按钮_修改_被单击, 空白型, , 
未知函数_330 () ' *** 缩略程序块 ***
调试输出 (外部数据库.执行 (相加 (“update 同学信息 set 姓名='”, .内容, “',性别='”, .内容, “',年龄='”, .内容, “',QQ='”, .内容, “',家庭住址='”, .内容, “',备注='”, .内容, “',照片=? where 编号=”, 到文本 (程序集_编号)), .图片))
.如果 (等于 (外部数据库.执行 (相加 (“update 同学信息 set 姓名='”, .内容, “',性别='”, .内容, “',年龄='”, .内容, “',QQ='”, .内容, “',家庭住址='”, .内容, “',备注='”, .内容, “',照片=? where 编号=”, 到文本 (程序集_编号)), .图片), 真))
    信息框 (“确定要修改当前的记录吗？”, 相加 (1, #询问图标), “漫步云端友情提示：”)
    信息框 (“修改当前记录成功！”, #信息图标, “漫步云端友情提示：”)
.否则
    信息框 (“修改当前记录失败！”, #警告图标, “漫步云端友情提示：”)
.如果结束


.子程序 _超级按钮_返回_被单击, 空白型, , 
窗口_浏览.销毁 ()

.窗口程序集 关于_窗口程序集, , , 

.子程序 _窗口_关于_创建完毕, 空白型, , 


.子程序 _窗口_关于_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()



 ' 不属于任何一个程序集、类模块的函数：
