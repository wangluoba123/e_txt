 ' 文件类型：Windows模块源码

 ' 程序名称：EXCEL转ACCESS
 ' 程序描述：可以把EXCEL文件(*.xls)转化ACCESS的数据库文件(*.mdb)
完全使用Microsoft ActiveX Data Objects (ADO)。
脱离OFFICE文件的支持。
 ' 程序作者：朱育良
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：3.0
 ' 创建号：0.0





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库





.程序集 xls2mdb, , , 

.子程序 XLS2MDB, 空白型, 公开, 
.参数 excel文件名, 文本型, , 全路径的excel文件(*.xls)
.参数 access文件名, 文本型, , 全路径的access文件(*.mdb)

.局部变量 数据库连接, 对象, , , 
.局部变量 记录集, 对象, , , 
.局部变量 工作表, 对象, , , 
.局部变量 Source, 变体型, , , 
.局部变量 i, 整数型, , , 
.局部变量 表名, 文本型, , "0", 


 ' ========取 EXCEL表名======================
数据库连接.创建 (“ADODB.Connection”, )
数据库连接.方法 (“Open”, 相加 (“Provider=microsoft.jet.oledb.4.0;Persist Security Info=False;data source='”, excel文件名, “';Extended Properties='Excel 8.0;HDR=Yes'”), “”, “”, )
数据库连接.写属性 (“CursorLocation”, 3)
记录集.创建 (“ADOX.Catalog”, )
Source.赋值 (数据库连接, )
记录集.写属性 (“ActiveConnection”, Source)
赋值 (工作表, 记录集.读对象型属性 (“Tables”, ))
.计次循环首 (工作表.读数值属性 (“Count”, ), i)
    加入成员 (表名, 工作表.读对象型属性 (“Item”, 相减 (i, 1)).读文本属性 (“Name”, ))
.计次循环尾 ()
工作表.清除 ()
记录集.清除 ()
 ' 数据库连接.方法 (“Quit”, )
数据库连接.清除 ()
 ' +++++++++++++++++++++++++++++++++++++++++++++++++++


 ' ================创建ACCESS数据库===================
数据库连接.创建 (“ADOX.Catalog”, )
数据库连接.通用方法 (“Create”, 相加 (“Provider=Microsoft.Jet.OLEDB.4.0;Data Source=”, access文件名))
数据库连接.清除 ()
 ' +++++++++++++++++++++++++++++++++++++++++++++++++++


 ' ===========写入数据===================================
清除 ()
“{00000514-0000-0010-8000-00AA006D2EA4}”.创建 () ' ADODB.Connection
“Open”.方法 (相加 (“Provider=Microsoft.Jet.OLEDB.4.0;Password=;Data Source=”, , “;Persist Security Info=false”), “”, “”, -1)

.计次循环首 (取数组成员数 (表名), i)
    .如果真 (不等于 (表名 [i], “”))
        .如果真 (等于 (取文本右边 (表名 [i], 1), “$”))
            赋值 (表名 [i], 子文本替换 (表名 [i], “$”, “”, , , 真))
        .如果真结束
        赋值 (记录集, 数据库连接.对象型方法 (“Execute”, 相加 (“SELECT * INTO ”, 表名 [i], “ FROM [Excel 8.0;DATABASE=”, excel文件名, “].[”, 表名 [i], “$] ”), 0))
    .如果真结束
    
.计次循环尾 ()
“Quit”.方法 ()
数据库连接.清除 ()
 ' +++++++++++++++++++++++++++++++++++++++++++++++++++++++++

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。


 ' 不属于任何一个程序集、类模块的函数：
