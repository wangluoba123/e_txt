 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.5a5x.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5a5x.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5a5x.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5a5x.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 374
    高度 = 323
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “释迦摩尼_对话框类”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库




数据类型 打开文件名, , OPENFILENAME
    .成员 结构大小, 整数型, , , lStructSize
    .成员 窗口句柄, 整数型, , , hwndOwner
    .成员 实例句柄, 整数型, , , hInstance
    .成员 过滤器, 字节集, , , lpstrFilter
    .成员 自定义过滤器, 文本型, , , lpstrCustomFilter
    .成员 自定义过滤器最大长度, 整数型, , , nMaxCustFilter
    .成员 过滤器索引, 整数型, , , nFilterIndex
    .成员 文件名, 字节集, , , lpstrFile
    .成员 文件名最大长度, 整数型, , , nMaxFile
    .成员 文件标题, 文本型, , , lpstrFileTitle
    .成员 文件标题最大长度, 整数型, , , nMaxFileTitle
    .成员 初始目录, 文本型, , , lpstrInitialDir
    .成员 标题, 文本型, , , lpstrTitle
    .成员 标志, 整数型, , , flags
    .成员 文件偏移量, 整数型, , , nFileOffset
    .成员 文件扩展名, 整数型, , , nFileExtension
    .成员 默认扩展名, 文本型, , , lpstrDefExt
    .成员 自定义数据, 整数型, , , lCustData
    .成员 回调函数地址, 整数型, , , lpfnHook
    .成员 模板名, 文本型, , , lpTemplateName

数据类型 色盒, , 
    .成员 lStructsize, 整数型, , , 
    .成员 hwndOwner, 整数型, , , 
    .成员 hInstance, 整数型, , , 
    .成员 rgbResult, 整数型, , , 
    .成员 lpCustColors, 文本型, , , 可以指定16个数组,也可以不用指定,但无论用否,必须传址
    .成员 flags, 整数型, , , 
    .成员 lCustData, 整数型, , , 
    .成员 lpfnHook, 子程序指针, , , 
    .成员 lpTemplateName, 文本型, , , 

数据类型 字体信息, 公开, 
    .成员 名称, 文本型, , , 
    .成员 大小, 整数型, , , 
    .成员 颜色, 整数型, , , 
    .成员 类型, 整数型, , , 
    .成员 斜体, 整数型, , , 
    .成员 下划线, 整数型, , , 

数据类型 逻辑字体, , $(a)LOGFONT
    .成员 高度, 整数型, , , lfHeight
    .成员 宽度, 整数型, , , lfWidth
    .成员 控制摆, 整数型, , , lfEscapement
    .成员 定方位, 整数型, , , lfOrientation
    .成员 加粗, 整数型, , , lfWeight
    .成员 斜体, 字节型, , , lfItalic
    .成员 下划线, 字节型, , , lfUnderline
    .成员 删除线, 字节型, , , lfStrikeOut
    .成员 零碎工作组合, 字节型, , , lfCharSet
    .成员 出自精确, 字节型, , , lfOutPrecision
    .成员 修剪精确, 字节型, , , lfClipPrecision
    .成员 性质, 字节型, , , lfQuality
    .成员 间距, 字节型, , , lfPitchAndFamily
    .成员 字体名称, 字节型, , "32", 用LF_FACESIZE,lfFaceName?

数据类型 选择字体, , CHOOSEFONT
    .成员 结构大小, 整数型, , , lStructSize
    .成员 窗口句柄, 整数型, , , hwndOwner，caller's window handle
    .成员 设备场景句柄, 整数型, , , hDC，printer DC/IC or NULL
    .成员 字体结构指针, 整数型, , , lpLogFont‘ptr. to a LOGFONT struct
    .成员 点大小, 整数型, , , iPointSize，10 * size in points of selected font
    .成员 标志, 整数型, , , flags，enum. type flags
    .成员 颜色值, 整数型, , , rgbColors，returned text color
    .成员 自定义数据, 整数型, , , lCustData，data passed to hook fn.
    .成员 回调函数地址, 整数型, , , lpfnHook，ptr. to hook function
    .成员 模板名称, 文本型, , , lpTemplateName，custom template name
    .成员 实例句柄, 整数型, , , hInstance，instance handle of.EXE that contains cust. dlg. template
    .成员 字体风格, 文本型, , , lpszStyle，return the style field here must be LF_FACESIZE(32) or bigger
    .成员 字体类型, 短整数型, , , nFontType，same value reported to the EnumFonts,call back with the extra FONTTYPE_ bits added
    .成员 空白队列, 短整数型, , , 
    .成员 最小尺寸, 整数型, , , 
    .成员 最大尺寸, 整数型, , , 

数据类型 项目标识符列表, , ITEMIDLIST
    .成员 结构大小, 整数型, , , cb
    .成员 标识符长度, 字节型, , "255", abID

数据类型 文件夹信息, , BROWSEINFO
    .成员 窗口句柄, 整数型, , , hOwner
    .成员 根目录, 整数型, , , pidlRoot
    .成员 显示名称, 文本型, , , pszDisplayName
    .成员 标题, 文本型, , , lpszTitle
    .成员 标志, 整数型, , , ulFlags
    .成员 回调函数地址, 整数型, , , lpfn
    .成员 回调函数参数, 整数型, , , lParam
    .成员 图像索引, 整数型, , , iImage

数据类型 设定执行文件信息, , SHELLEXECUTEINFO
    .成员 结构大小, 整数型, , , cbSize
    .成员 标志, 整数型, , , fMask
    .成员 窗口句柄, 整数型, , , hwnd
    .成员 操作命令, 文本型, , , lpVerb
    .成员 文件名, 文本型, , , lpFile
    .成员 应用程序参数, 文本型, , , lpParameters
    .成员 目录, 文本型, , , lpDirectory
    .成员 显示标志, 整数型, , , nShow
    .成员 实例句柄, 整数型, , , hInstApp
    .成员 项目标识符列表结构指针, 整数型, , , lpIDList
    .成员 文件类别, 文本型, , , lpClass
    .成员 热键句柄, 整数型, , , hkeyClass
    .成员 热键, 整数型, , , dwHotKey
    .成员 图标句柄, 整数型, , , hIcon
    .成员 进程句柄, 整数型, , , hProcess


.DLL命令 打开对话框, 整数型, "comdlg32.dll", "GetOpenFileNameA", , 
    .参数 OpenFile, 打开文件名, , 

.DLL命令 取实例句柄_, 整数型, "", "GetModuleHandleA", , 
    .参数 程序名, 文本型, , 

.DLL命令 取打开文件名_, 整数型, "msvfw32.dll", "GetOpenFileNamePreview", , 
    .参数 格式, 打开文件名, , 

.DLL命令 取保存文件名_, 整数型, "msvfw32.dll", "GetSaveFileNamePreviewA", , 
    .参数 格式, 打开文件名, , 

.DLL命令 API_取结构长度, 整数型, "kernel32.dll", "LocalSize", , 
    .参数 hMem, 色盒, , 

.DLL命令 取得窗口结构信息, 整数型, "", "GetWindowWord", , 
    .参数 hwnd, 空白型, , 
    .参数 nIndex, 空白型, , 

.DLL命令 API_调色板, 逻辑型, "comdlg32.dll", "ChooseColorA", , 
    .参数 lpcc, 色盒, , 

.DLL命令 全局堆栈分配_, 整数型, "kernel32", "GlobalAlloc", , 
    .参数 标志, 整数型, , 
    .参数 字节, 整数型, , 

.DLL命令 锁住全局内存块_, 整数型, "kernel32.dll", "GlobalLock", , 
    .参数 内存句柄, 整数型, , hMem

.DLL命令 拷贝内存_, 整数型, "kernel32", "RtlMoveMemory", , 
    .参数 目的地址, 整数型, , any
    .参数 源地址, 逻辑字体, , any
    .参数 复制尺寸, 整数型, , 

.DLL命令 选择字体对话框_, 整数型, "comdlg32.dll", "ChooseFontA", , 建立一个字体选择对话框
    .参数 字体对话框结构, 选择字体, , 

.DLL命令 拷贝内存1_, 整数型, "kernel32", "RtlMoveMemory", , 
    .参数 目的地址, 逻辑字体, 传址, any
    .参数 源地址, 整数型, , any
    .参数 复制尺寸, 整数型, , 

.DLL命令 解锁全局内存块_, 整数型, "kernel32.dll", "GlobalUnlock", , 
    .参数 内存句柄, 整数型, , hMem

.DLL命令 全局内存分配_, 整数型, "kernel32", "GlobalFree", , 
    .参数 内存句柄, 整数型, , 

.DLL命令 取文件夹特殊区域, 空白型, "shell32.dll", "SHGetFolderLocation", , $(b)
    .参数 窗口句柄, 整数型, , hwnd
    .参数 文件夹标识符, 整数型, , nFolder
    .参数 标志句柄, 整数型, , hToken
    .参数 标志, 整数型, , dwFlags
    .参数 项目标识符列表结构, 项目标识符列表, , ppidl

.DLL命令 浏览文件夹对话框, 整数型, "shell32.dll", "SHBrowseForFolderA", , $(b)
    .参数 浏览文件夹结构, 文件夹信息, , 

.DLL命令 从列表id取路径, 整数型, "shell32.dll", "SHGetPathFromIDListA", , $(b)
    .参数 结构指针, 整数型, , pIdl
    .参数 路径, 文本型, 传址, pszPath

.DLL命令 重新启动系统设置_, 整数型, "shell32.dll", "#59", , #59
    .参数 窗口句柄, 整数型, , hOwner
    .参数 额外提示, 整数型, , sExtraPrompt
    .参数 标志, 整数型, , uFlags

.DLL命令 关机对话框_, 整数型, "shell32.dll", "#60", , #60
    .参数 参数, 整数型, , YourGuess

.DLL命令 设定执行文件, 整数型, "shell32.dll", "ShellExecuteEx", , 
    .参数 设定执行文件信息结构, 设定执行文件信息, , 

.DLL命令 运行对话框, 空白型, "Shell32.dll", "#61", , 
    .参数 hOwner, 空白型, , 
    .参数 UnknownP1, 空白型, , 
    .参数 UnknownP2, 空白型, , 
    .参数 szTitle, 整数型, , 对话框的标题
    .参数 szPrompt, 整数型, , 对话框中的描述文字
    .参数 uFlags, 空白型, , 

.DLL命令 WNetConnectionDialog, 空白型, "mpr.dll", "WNetConnectionDialog", , 
    .参数 hWnd, 空白型, , 
    .参数 dwType, 空白型, , 

.程序集 程序集1, , , 

.子程序 对话框_打开文件_多选, 文本型, 公开, 如果多选文件，返回文件路径以“;”(半角分号)分隔。失败或取消返回空文本。
.参数 窗口句柄, 整数型, 可空, 调用处窗口句柄
.参数 窗口标题, 文本型, 可空, 对话框窗口标题
.参数 过滤器, 文本型, 可空, 格式：“MP3文件(*.mp3)|*.mp3|媒体文件(*.mpg)|*.mpg”
.参数 初始路径, 文本型, 可空, 可以被省略。如果本参数被省略，默认从“我的文档”开始。否则，请给出盘符，如“d:”
.参数 窗口风格, 整数型, 可空, 可以被省略。如果本参数被省略，默认为 0 。位置值从 0 开始。从0－11之间，可以设置多种窗口风格。0.工具栏、只读选择框－未选中；1.工具栏、只读选择框－选中；2.工具栏；3.工具栏、只读选择框－未选中，帮助按钮；4.工具栏、只读选择框－选中，帮助按钮；5.工具栏，帮助按钮；6.普通风格、只读选择框－未选中；7.普通风格、只读选择框－选中；8.普通风格；9.普通风格、只读选择框－未选中，帮助按钮；10.普通风格、只读选择框－选中，帮助按钮；11.普通风格、帮助按钮。

.局部变量 文件列表, 打开文件名, , , 
.局部变量 文件名, 字节集, , , 
.局部变量 文件名数组, 文本型, , "0", 
.局部变量 XH, 整数型, , , 记录循环的次数
.局部变量 多选文件, 文本型, , , 
.局部变量 文件缓冲数, 整数型, , , 决定可以打开文件的个数，原为8192，可打开80个文件
.局部变量 窗口风格3, 整数型, , , 将524800－524863改成为0－20风格参数，方便用户选择

赋值 (文件缓冲数, 98192) ' 大小决定打开文件的数量，此可以打开200个文件
处理事件 ()
赋值 (文件列表.结构大小, 76) ' 文件列表.lStructSize ＝ 76
赋值 (文件列表.窗口句柄, 窗口句柄) ' 文件列表.hwndOwner ＝ 窗口句柄
赋值 (文件列表.过滤器, 相加 (子字节集替换 (到字节集 (过滤器), { 124 }, { 0 }, , ), { 0 }, { 0 }))
 ' 文件列表.lpstrFilter ＝ 子字节集替换 (到字节集 (过滤器), { 124 }, { 0 }, , ) ＋ { 0 } ＋ { 0 }
赋值 (文件列表.文件名, 取空白字节集 (文件缓冲数))
 ' 文件列表.lpstrFile ＝ 取空白字节集 (文件缓冲数)  ' 文件名缓冲区，决定能选择文件的多少，如果平均一个文件名100个字符，一次也可以选80多个文件了
赋值 (文件列表.文件名最大长度, 文件缓冲数) ' 文件列表.nMaxFile ＝ 文件缓冲数
赋值 (文件列表.文件标题, 取空白文本 (文件缓冲数)) ' 文件列表.lpstrFileTitle ＝ 取空白文本 (文件缓冲数)
赋值 (文件列表.文件标题最大长度, 文件缓冲数) ' 文件列表.nMaxFileTitle ＝ 文件缓冲数
赋值 (文件列表.初始目录, 初始路径) ' 文件列表.lpstrInitialDir ＝ 初始路径
赋值 (文件列表.标题, 窗口标题) ' 文件列表.lpstrTitle ＝ 窗口标题
文件列表.flags ＝ 524800 ' 原来的
.判断开始 (等于 (窗口风格, 0))
    赋值 (窗口风格3, 524800)
.判断 (等于 (窗口风格, 1))
    赋值 (窗口风格3, 524801)
.判断 (等于 (窗口风格, 2))
    赋值 (窗口风格3, 524804)
.判断 (等于 (窗口风格, 3))
    赋值 (窗口风格3, 524816)
.判断 (等于 (窗口风格, 4))
    赋值 (窗口风格3, 524817)
.判断 (等于 (窗口风格, 5))
    赋值 (窗口风格3, 524820)
.判断 (等于 (窗口风格, 6))
    赋值 (窗口风格3, 524832)
.判断 (等于 (窗口风格, 7))
    赋值 (窗口风格3, 524833)
.判断 (等于 (窗口风格, 8))
    赋值 (窗口风格3, 524836)
.判断 (等于 (窗口风格, 9))
    赋值 (窗口风格3, 524848)
.判断 (等于 (窗口风格, 10))
    赋值 (窗口风格3, 524849)
.判断 (等于 (窗口风格, 11))
    赋值 (窗口风格3, 524852)
.默认
     ' 本源码来自易语言资源网(www.5a5x.com)
.判断结束
 ' 处理事件 ()
赋值 (文件列表.标志, 窗口风格3) ' 文件列表.flags ＝ 窗口风格3
.如果 (不等于 (打开对话框 (文件列表), 0)) ' 打开文件成功
    赋值 (文件名, 文件列表.文件名) ' 文件名 ＝ 文件列表.lpstrFile
    赋值 (文件名, 取字节集左边 (文件名, 相减 (寻找字节集 (文件名, { 0, 0 }, ), 1)))
    .如果 (不等于 (寻找字节集 (文件名, { 0 }, ), -1)) ' 是否选择多个文件
        赋值 (文件名数组, 分割文本 (到文本 (子字节集替换 (文件名, { 0 }, { 124 }, , )), “|”, ))
        .如果真 (不等于 (取文本右边 (文件名数组 [1], 1), “\”)) ' 选择多个文件时，第一个数组为路径名，后面为不包括路径的文件名
            赋值 (文件名数组 [1], 相加 (文件名数组 [1], “\”))
        .如果真结束
        .计次循环首 (相减 (取数组成员数 (文件名数组), 1), XH)
            .如果 (不等于 (相减 (取数组成员数 (文件名数组), 1), XH)) ' 最后一个文件名不用加分隔字符“；”
                赋值 (多选文件, 相加 (多选文件, 文件名数组 [1], 文件名数组 [相加 (XH, 1)], “;”))
            .否则
                赋值 (多选文件, 相加 (多选文件, 文件名数组 [1], 文件名数组 [相加 (XH, 1)]))
            .如果结束
            
        .计次循环尾 ()
        返回 (多选文件) ' 返回多个文件名全路径用“;”分隔
    .否则
        返回 (到文本 (文件名)) ' 返回单个文件名全路径
    .如果结束
    
.否则
    返回 (“”) ' 取消返回空文本
.如果结束


.子程序 对话框_打开文件, 文本型, 公开,   取字节集数据_可能不支持斩月_以解决
.参数 窗口句柄, 整数型, 可空, 调用处窗口句柄
.参数 窗口标题, 文本型, 可空, 对话框窗口标题
.参数 过滤器, 文本型, 可空, 格式：“MP3文件(*.mp3)|*.mp3|媒体文件(*.mpg)|*.mpg”
.参数 初始路径, 文本型, 可空, 可以被省略。如果本参数被省略，默认从“我的文档”开始。否则，请给出盘符，如“d:”

.局部变量 局部_文件名, 打开文件名, , , 
.局部变量 局部_返回值, 整数型, , , 
.局部变量 窗口风格3, 整数型, , , 

赋值 (局部_文件名.结构大小, 76)
赋值 (局部_文件名.实例句柄, 取实例句柄_ (取执行文件名 ()))
赋值 (局部_文件名.窗口句柄, 窗口句柄)
赋值 (局部_文件名.文件标题, “Open a file”)
赋值 (局部_文件名.过滤器, 相加 (子字节集替换 (到字节集 (过滤器), { 124 }, { 0 }, , ), { 0 }, { 0 }))
赋值 (局部_文件名.文件名, 取空白字节集 (255))
赋值 (局部_文件名.初始目录, 初始路径)
赋值 (局部_文件名.标题, 窗口标题)
赋值 (局部_文件名.文件名最大长度, 255)
赋值 (局部_文件名.标志, 524288)
赋值 (局部_返回值, 取打开文件名_ (局部_文件名))
.如果真 (不等于 (局部_返回值, 0))
     ' 返回 (取字节集数据 (局部_文件名.文件名, #文本型, ))  源句
     ' 返回 (到文本 (局部_文件名.文件名))
    返回 (到文本 (局部_文件名.文件名))
.如果真结束
返回 (“”)

.子程序 对话框_保存文件, 文本型, 公开, 未提示 是否有重复的文件存在 自己注意一下
.参数 窗口句柄, 整数型, 可空, 调用处窗口句柄
.参数 窗口标题, 文本型, 可空, 对话框窗口标题
.参数 过滤器, 文本型, 可空, 格式：“MP3文件(*.mp3)|*.mp3|媒体文件(*.mpg)|*.mpg”
.参数 初始路径, 文本型, 可空, 可以被省略。如果本参数被省略，默认从“我的文档”开始。否则，请给出盘符，如“d:”

.局部变量 局部_文件名, 打开文件名, , , 
.局部变量 局部_返回值, 整数型, , , 

赋值 (局部_文件名.结构大小, 76)
赋值 (局部_文件名.实例句柄, 取实例句柄_ (取执行文件名 ()))
赋值 (局部_文件名.窗口句柄, 窗口句柄)
赋值 (局部_文件名.文件标题, “Save a file”)
赋值 (局部_文件名.过滤器, 相加 (子字节集替换 (到字节集 (过滤器), { 124 }, { 0 }, , ), { 0 }, { 0 }))
赋值 (局部_文件名.文件名, 取空白字节集 (255))
赋值 (局部_文件名.初始目录, 初始路径)
赋值 (局部_文件名.标题, 窗口标题)
赋值 (局部_文件名.文件名最大长度, 255)
赋值 (局部_文件名.标志, 524288)
赋值 (局部_返回值, 取保存文件名_ (局部_文件名))
.如果真 (不等于 (局部_返回值, 0))
     ' 返回 (取字节集数据 (局部_文件名.文件名, #文本型, ))
    返回 (到文本 (局部_文件名.文件名))
.如果真结束
返回 (“”)

.子程序 对话框_选择颜色, 逻辑型, 公开, 
.参数 窗口句柄, 整数型, , 
.参数 返回_颜色, 文本型, , 返回的颜色～～需要传回整数

.局部变量 色盒, 色盒, , , 
.局部变量 l, 整数型, , , 
.局部变量 s, 整数型, , "16", 

 ' 变量循环首 (240, 15, -15, l)
 ' s [l ÷ 15] ＝ 4181774  ' 取颜色值 (14, 207, 63)
 ' 变量循环尾 ()
赋值 (色盒.lStructsize, API_取结构长度 (色盒))
赋值 (色盒.hwndOwner, 窗口句柄)
赋值 (色盒.hInstance, 取得窗口结构信息 (窗口句柄, -6))
赋值 (色盒.flags, 0) ' 设置为2，可以把“自定义颜色”展开
 ' 色盒.lpCustColors ＝ 取变量地址 (s)  传址
赋值 (色盒.lpCustColors, 取空白文本 (相乘 (16, 4)))
.如果 (API_调色板 (色盒))
    赋值 (返回_颜色, 到文本 (色盒.rgbResult))
    返回 (真)
.否则
    返回 (假)
.如果结束
 ' 本源码来自易语言资源网(www.5a5x.com)

.子程序 对话框_选择字体, 字体, 公开, 
.参数 窗口句柄, 整数型, , 
.参数 设备场景句柄, 整数型, 可空, 

.局部变量 局部_选择字体, 选择字体, , , 
.局部变量 局部_逻辑字体, 逻辑字体, , , 
.局部变量 局部_内存句柄, 整数型, , , 
.局部变量 局部_全局内存块, 整数型, , , 
.局部变量 局部_字体名称, 文本型, , , 
.局部变量 局部_选择字体返回值, 整数型, , , 
.局部变量 局部_返回值, 文本型, , , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 返回_字体信息, 字体, , , 

赋值 (局部_逻辑字体.高度, 0)
赋值 (局部_逻辑字体.宽度, 0)
赋值 (局部_逻辑字体.控制摆, 0)
赋值 (局部_逻辑字体.定方位, 0)
赋值 (局部_逻辑字体.加粗, 400)
赋值 (局部_逻辑字体.零碎工作组合, 1)
赋值 (局部_逻辑字体.出自精确, 0)
赋值 (局部_逻辑字体.修剪精确, 0)
赋值 (局部_逻辑字体.性质, 0)
赋值 (局部_逻辑字体.间距, 0)
赋值 (局部_内存句柄, 全局堆栈分配_ (66, 59))
赋值 (局部_全局内存块, 锁住全局内存块_ (局部_内存句柄))
拷贝内存_ (局部_全局内存块, 局部_逻辑字体, 59)
赋值 (局部_选择字体.结构大小, 60)
赋值 (局部_选择字体.窗口句柄, 窗口句柄)
 ' 局部_选择字体.设备场景句柄 ＝ 打印机1.取设备句柄 ()
赋值 (局部_选择字体.设备场景句柄, 设备场景句柄)
赋值 (局部_选择字体.字体结构指针, 局部_全局内存块)
赋值 (局部_选择字体.点大小, 120)
赋值 (局部_选择字体.标志, 74051)
赋值 (局部_选择字体.颜色值, 0) ' 取颜色值 (0, 0, 0)
赋值 (局部_选择字体.字体类型, 1024)
赋值 (局部_选择字体.最小尺寸, 10)
赋值 (局部_选择字体.最大尺寸, 72)
赋值 (局部_选择字体返回值, 选择字体对话框_ (局部_选择字体))
.如果真 (不等于 (局部_选择字体返回值, 0))
    拷贝内存1_ (局部_逻辑字体, 局部_全局内存块, 相加 (28, 31))
    .计次循环首 (31, 局部_计次)
        赋值 (局部_返回值, 相加 (局部_返回值, 字符 (局部_逻辑字体.字体名称 [局部_计次])))
    .计次循环尾 ()
    赋值 (局部_选择字体返回值, 解锁全局内存块_ (局部_内存句柄))
    赋值 (局部_选择字体返回值, 全局内存分配_ (局部_内存句柄))
.如果真结束
 ' 返回 (局部_返回值 ＋ “---” ＋ 到文本 (局部_选择字体.点大小 ÷ 10) ＋ “---” ＋ 到文本 (局部_选择字体.颜色值) ＋ “---” ＋ 到文本 (局部_选择字体.字体类型) ＋ “---” ＋ 到文本 (局部_逻辑字体.下划线) ＋ “---” ＋ 到文本 (局部_逻辑字体.斜体))
赋值 (返回_字体信息., 局部_返回值)
赋值 (返回_字体信息., 相除 (局部_选择字体.点大小, 10))
 ' 返回_字体信息.颜色 ＝ 局部_选择字体.颜色值
 ' 返回_字体信息.类型 ＝ 局部_选择字体.字体类型
.判断开始 (等于 (局部_逻辑字体.斜体, 1))
    赋值 (返回_字体信息., 真)
.默认
    赋值 (返回_字体信息., 假)
.判断结束
.判断开始 (等于 (局部_逻辑字体.下划线, 1))
    赋值 (返回_字体信息., 真)
.默认
    赋值 (返回_字体信息., 假)
.判断结束
.判断开始 (等于 (局部_逻辑字体.加粗, 700))
    赋值 (返回_字体信息., 真)
.默认
    赋值 (返回_字体信息., 假)
.判断结束
.判断开始 (等于 (局部_逻辑字体.删除线, 1))
    赋值 (返回_字体信息., 真)
.默认
    赋值 (返回_字体信息., 假)
.判断结束
赋值 (返回_字体信息., 局部_逻辑字体.控制摆)
返回 (返回_字体信息)

.子程序 对话框_浏览文件夹, 文本型, 公开, 
.参数 窗口句柄, 整数型, , 
.参数 标题, 文本型, , 
.参数 是否有新建按钮, 逻辑型, 可空, 

.局部变量 局部_浏览文件夹结构, 文件夹信息, , , 
.局部变量 局部_返回值, 整数型, , , 
.局部变量 局部_路径, 文本型, , , 
.局部变量 局部_项目标识符列表结构, 项目标识符列表, , , 
.局部变量 局部_文件, 文本型, , , 

取文件夹特殊区域 (窗口句柄, 0, 0, 0, 局部_项目标识符列表结构)
赋值 (局部_浏览文件夹结构.窗口句柄, 窗口句柄)
赋值 (局部_浏览文件夹结构.根目录, 局部_项目标识符列表结构.结构大小)
赋值 (局部_浏览文件夹结构.显示名称, 取空白文本 (260))
赋值 (局部_浏览文件夹结构.标题, 标题)
.判断开始 (是否有新建按钮)
    赋值 (局部_浏览文件夹结构.标志, 119)
.默认
    赋值 (局部_浏览文件夹结构.标志, 1)
.判断结束
赋值 (局部_返回值, 浏览文件夹对话框 (局部_浏览文件夹结构))
.判断开始 (不等于 (局部_返回值, 0))
    赋值 (局部_路径, 取空白文本 (260))
    从列表id取路径 (局部_返回值, 局部_路径)
    返回 (局部_路径)
.默认
    返回 (“”)
.判断结束


.子程序 对话框_重新启动提示, 空白型, , 
.参数 窗口句柄, 整数型, , 
.参数 逻辑值, 逻辑型, 可空, 真，是否立即关机　假，必需重起，才能使新的设置生效　是否立即重起

.局部变量 x, 整数型, , , 

 ' 1，是否立即关机
 ' 2，必需重起，才能使新的设置生效　是否立即重起
 ' x ＝ 斩月_编码转换_usc2转ansi (“twtbai”)
 ' x ＝ “twtbai”
.判断开始 (逻辑值)
    赋值 (x, 1)
.默认
    赋值 (x, 4)
.判断结束
重新启动系统设置_ (窗口句柄, 0, x)
 ' 信息框 (指针到文本 (斩月_取指针_文本型 (x)), 0, )

.子程序 对话框_关机对话框, 空白型, 公开, 
关机对话框_ (0)
' 本源码来自易语言资源网(www.5a5x.com)

.子程序 对话框_文件属性, 逻辑型, , 
.参数 窗口句柄, 整数型, , 
.参数 文件名, 文本型, , 

.局部变量 局部_设定执行文件信息, 设定执行文件信息, , , 
.局部变量 局部_文件信息, 整数型, , , 
.局部变量 局部_返回值, 整数型, , , 

赋值 (局部_设定执行文件信息.结构大小, 60)
赋值 (局部_设定执行文件信息.标志, 1100)
赋值 (局部_设定执行文件信息.窗口句柄, 窗口句柄)
赋值 (局部_设定执行文件信息.操作命令, “properties”)
赋值 (局部_设定执行文件信息.文件名, 文件名)
赋值 (局部_设定执行文件信息.应用程序参数, “”)
赋值 (局部_设定执行文件信息.目录, “”)
赋值 (局部_设定执行文件信息.显示标志, 0)
赋值 (局部_设定执行文件信息.实例句柄, 0)
赋值 (局部_设定执行文件信息.项目标识符列表结构指针, 0)
赋值 (局部_文件信息, 设定执行文件 (局部_设定执行文件信息))
 ' 返回 (局部_设定执行文件信息.实例句柄)
.判断开始 (小于或等于 (局部_设定执行文件信息.实例句柄, 32))
    返回 (假)
.默认
    返回 (真)
.判断结束


.子程序 对话框_运行, 空白型, 公开, 
.参数 窗口句柄, 整数型, , 
.参数 标识, 整数型, 可空, 0,有浏览按钮　1,无浏览按钮　２,有浏览按钮且确定按钮被禁止　３,无浏览按钮且确定按钮被禁止：默认为,0

运行对话框 (窗口句柄, 0, 0, 0, 0, 标识)
' 本源码来自易语言资源网(www.5a5x.com)

.子程序 对话框_映射驱动, 空白型, 公开, 网络资源映射
.参数 窗口句柄, 整数型, , 

WNetConnectionDialog (窗口句柄, 1)


.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
 ' --========  易语言资源网  (www.5a5x.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5a5x.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5a5x.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5a5x.com  ================--


.子程序 _按钮_通用对话框_多选_被单击, 空白型, , 
赋值 (., 对话框_打开文件_多选 (取窗口句柄 (), “对话框_打开文件_多选”, “MP3文件(*.mp3)|*.mp3|媒体文件(*.mpg)|*.mpg”, “D:\”, 5))

.子程序 _按钮_通用对话框_打开_被单击, 空白型, , 
赋值 (., 对话框_打开文件 (取窗口句柄 (), “对话框_打开文件”, “MP3文件(*.mp3)|*.mp3|媒体文件(*.mpg)|*.mpg”, “D:\”))

.子程序 _按钮_通用对话框_保存_被单击, 空白型, , 
赋值 (., 对话框_保存文件 (取窗口句柄 (), “twtybai”, “MP3文件(*.mp3)|*.mp3|媒体文件(*.mpg)|*.mpg”, “D:\”))

.子程序 _按钮_对话框_选择颜色_被单击, 空白型, , 
.局部变量 j, 文本型, , , 

.如果真 (对话框_选择颜色 (取窗口句柄 (), j))
    赋值 (., 到整数 (j))
.如果真结束
 ' 本源码来自易语言资源网(www.5a5x.com)

.子程序 _按钮_对话框_浏览文件夹_被单击, 空白型, , 
赋值 (., 对话框_浏览文件夹 (取窗口句柄 (), “对话框_浏览文件夹”, 真))

.子程序 _按钮_对话框_选择字体_被单击, 空白型, , 
赋值 (., 对话框_选择字体 (取窗口句柄 ()))

.子程序 _按钮_对话框_重启动提示_被单击, 空白型, , 
对话框_重新启动提示 (取窗口句柄 ())

.子程序 _按钮_对话框_关机对话框_被单击, 空白型, , 
对话框_关机对话框 ()

.子程序 _按钮_对话框_运行_被单击, 空白型, , 
对话框_运行 (取窗口句柄 ())

.子程序 _按钮_对话框_文件属性_被单击, 空白型, , 
对话框_文件属性 (取窗口句柄 (), 对话框_浏览文件夹 (取窗口句柄 (), “对话框_文件属性”, 真))

.子程序 _按钮_对话框_映射驱动_被单击, 空白型, , 
对话框_映射驱动 (取窗口句柄 ())
' 本源码来自易语言资源网(www.5a5x.com)


 ' 不属于任何一个程序集、类模块的函数：
