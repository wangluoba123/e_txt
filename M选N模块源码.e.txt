 ' 文件类型：未知类型

 ' 程序名称：形成组合文本
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 7 系统核心支持库





.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。


.子程序 按列置组合结果, 文本型, 公开, 返回储存结果的文本文件，每注一行。^e^易宝宝^e^
.参数 备选号码表, 文本型, , 包含间隔符号的文本字符串
.参数 间隔符号, 文本型, 可空, 默认为“,”
.参数 选出个数, 整数型, , 要选出的号码个数
.参数 进度显示器, 画板, 可空, 为空时不显示进度

.局部变量 i, 整数型, , , 循环变量
.局部变量 j, 整数型, , , 循环变量
.局部变量 l, 整数型, , , 循环变量
.局部变量 当前号码长度, 整数型, , , 
.局部变量 号码前缀文本, 文本型, , , 由“0”构成的文本，格式化号码用
.局部变量 注数, 整数型, , , 
.局部变量 已有注数, 整数型, , , 
.局部变量 指针, 整数型, , , 
.局部变量 初始指针, 整数型, , , 
.局部变量 本位数字, 文本型, , "0", 
.局部变量 上位数字, 文本型, , "0", 
.局部变量 全部号码表, 文本型, , "0", 所要处理的全部号码，如1-30
.局部变量 全部号码个数, 整数型, , , 
.局部变量 结果表, 文本型, , "0", 最终的组合成果
.局部变量 总注数, 整数型, , , 
.局部变量 各位数字, 文本型, , "0", 
.局部变量 号码最大长度, 整数型, , , 单个号码的最大长度
.局部变量 k, 文本型, , , 临时文本
.局部变量 文件名, 文本型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 结果文本, 文本型, , , 
.局部变量 经历注数, 整数型, , , 
.局部变量 单位进度注数, 整数型, , , 
.局部变量 单位显示宽度, 整数型, , , 
.局部变量 当前显示数量, 整数型, , , 

 ' ---------------------------------------------------------------------
.如果真 (等于 (是否为空 (间隔符号), 真))
    赋值 (间隔符号, “,”)
.如果真结束
 ' 分析全部号码表，删除每个号码前后的空格,并判断单个号码的最大长度
.如果真 (等于 (是否为空 (进度显示器), 假))
    赋值 (进度显示器., 30)
    赋值 (单位显示宽度, 相除 (进度显示器., 100))
    赋值 (进度显示器., 真)
    进度显示器.写文本行 (“正在处理号码表，请稍候......”)
.如果真结束
赋值 (全部号码表, 分割文本 (备选号码表, 间隔符号, ))
.计次循环首 (取数组成员数 (全部号码表), i)
    赋值 (全部号码表 [i], 删首尾空 (全部号码表 [i]))
    赋值 (当前号码长度, 取文本长度 (全部号码表 [i]))
    .如果真 (大于 (当前号码长度, 号码最大长度))
        赋值 (号码最大长度, 当前号码长度)
    .如果真结束
    
.计次循环尾 ()
 ' 格式化号码
.计次循环首 (取数组成员数 (全部号码表), i)
    赋值 (当前号码长度, 取文本长度 (全部号码表 [i]))
    赋值 (号码前缀文本, 取重复文本 (相减 (号码最大长度, 当前号码长度), “0”))
    赋值 (全部号码表 [i], 相加 (号码前缀文本, 全部号码表 [i]))
.计次循环尾 ()
 ' ---------------------------------------------------------------------
赋值 (全部号码个数, 取数组成员数 (全部号码表))
赋值 (总注数, 取组合数量 (全部号码个数, 选出个数))
赋值 (单位进度注数, 相除 (相乘 (总注数, 选出个数), 100))
重定义数组 (结果表, 假, 总注数)
 ' ---------------------------------------------------------------------
 ' 找出每一位上的可能出现的数字
.计次循环首 (选出个数, i)
    赋值 (k, “”)
    .变量循环首 (i, 相加 (相减 (全部号码个数, 选出个数), i), 1, j)
        赋值 (k, 相加 (k, 全部号码表 [j], “ ”))
    .变量循环尾 ()
    加入成员 (各位数字, 删首尾空 (k))
.计次循环尾 ()
 ' ---------------------------------------------------------------------
 ' 形成组合
.如果真 (等于 (是否为空 (进度显示器), 假))
    进度显示器.清除 ()
    进度显示器.写文本行 (“正在形成组合表，请稍候......”)
.如果真结束

.计次循环首 (选出个数, i)
    赋值 (已有注数, 0)
    赋值 (本位数字, 分割文本 (各位数字 [i], “ ”, ))
    赋值 (指针, 1)
    .判断循环首 (真)
        .变量循环首 (指针, 取数组成员数 (本位数字), 1, j)
            赋值 (注数, 取组合数量 (相加 (相减 (全部号码个数, j, i), 1), 相减 (选出个数, i)))
            .计次循环首 (注数, l)
                赋值 (结果表 [相加 (已有注数, l)], 相加 (结果表 [相加 (已有注数, l)], 本位数字 [j], “ ”))
                处理事件 ()
                .如果真 (等于 (是否为空 (进度显示器), 假))
                    赋值 (经历注数, 相加 (经历注数, 1))
                    .如果真 (等于 (经历注数, 单位进度注数))
                        赋值 (经历注数, 0)
                        赋值 (当前显示数量, 相加 (当前显示数量, 1))
                        进度显示器.画渐变矩形 (0, 15, 相乘 (当前显示数量, 单位显示宽度), 30, #从左到右, #红褐, #褐绿, #黄色, #深青)
                    .如果真结束
                    
                .如果真结束
                
            .计次循环尾 ()
            赋值 (已有注数, 相加 (已有注数, 注数))
        .变量循环尾 ()
        .如果真 (等于 (已有注数, 总注数))
             ' 当前位处理完毕
            跳出循环 ()
        .如果真结束
        .如果真 (大于 (i, 1))
             ' 当处理第2及以上各位时，确定指针的位置
            赋值 (k, 取文本右边 (删首尾空 (结果表 [相加 (已有注数, 1)]), 号码最大长度))
            赋值 (上位数字, 分割文本 (各位数字 [相减 (i, 1)], “ ”, ))
            .计次循环首 (取数组成员数 (上位数字), j)
                .如果真 (等于 (k, 上位数字 [j]))
                    赋值 (指针, j)
                    跳出循环 ()
                .如果真结束
                
            .计次循环尾 ()
        .如果真结束
        
    .判断循环尾 ()
.计次循环尾 ()
 ' ---------------------------------------------------------------------
 ' 将形成的组合写入文本文件
赋值 (文件名, 取临时文件名 (取运行目录 ()))
赋值 (i, 寻找文本 (文件名, “.”, , 假))
赋值 (文件名, 相加 (取文本左边 (文件名, 相减 (i, 1)), “.txt”))
写到文件 (文件名, {  })
.如果真 (等于 (是否为空 (进度显示器), 假))
    进度显示器.清除 ()
    进度显示器.写文本行 (相加 (“共”, 到文本 (总注数), “个组合，正在写入文件，请稍候......”))
.如果真结束
赋值 (文件号, 打开文件 (文件名, , ))
赋值 (单位进度注数, 相除 (总注数, 100))
赋值 (当前显示数量, 0)
赋值 (经历注数, 0)
.计次循环首 (总注数, i)
    赋值 (结果文本, 删首尾空 (结果表 [i]))
    写文本行 (文件号, 结果文本)
    处理事件 ()
    .如果真 (等于 (是否为空 (进度显示器), 假))
        赋值 (经历注数, 相加 (经历注数, 1))
        .如果真 (等于 (经历注数, 单位进度注数))
            赋值 (经历注数, 0)
            赋值 (当前显示数量, 相加 (当前显示数量, 1))
            进度显示器.画渐变矩形 (0, 15, 相乘 (当前显示数量, 单位显示宽度), 30, #从左到右, #红褐, #褐绿, #黄色, #深青)
        .如果真结束
        
    .如果真结束
    
.计次循环尾 ()
关闭文件 (文件号)
.如果真 (等于 (是否为空 (进度显示器), 假))
    进度显示器.画渐变矩形 (0, 15, 进度显示器., 30, #从左到右, #红褐, #褐绿, #黄色, #深青)
.如果真结束
返回 (文件名)

.子程序 按行置组合结果, 文本型, 公开, 返回储存结果的文本文件，每注一行。^e^易宝宝^e^
.参数 备选号码表, 文本型, , 包含间隔符号的文本字符串
.参数 间隔符号, 文本型, 可空, 默认为“,”
.参数 选出个数, 整数型, , 要选出的号码个数
.参数 进度显示器, 画板, 可空, 为空时不显示进度

.局部变量 i, 整数型, , , 循环变量
.局部变量 j, 整数型, , , 循环变量
.局部变量 l, 整数型, , , 循环变量
.局部变量 当前号码长度, 整数型, , , 
.局部变量 号码前缀文本, 文本型, , , 由“0”构成的文本，格式化号码用
.局部变量 本位数字, 文本型, , "0", 
.局部变量 上位数字, 文本型, , "0", 
.局部变量 全部号码表, 文本型, , "0", 所要处理的全部号码，如1-30
.局部变量 全部号码个数, 整数型, , , 
.局部变量 结果表, 文本型, , "0", 最终的组合成果
.局部变量 总注数, 整数型, , , 
.局部变量 各位数字, 文本型, , "0", 
.局部变量 各位指针, 整数型, , "0", 
.局部变量 号码最大长度, 整数型, , , 单个号码的最大长度
.局部变量 文件名, 文本型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 结果文本, 文本型, , , 
.局部变量 是否显示进度, 逻辑型, , , 
.局部变量 经历注数, 整数型, , , 
.局部变量 单位进度注数, 整数型, , , 
.局部变量 单位显示宽度, 整数型, , , 
.局部变量 当前显示数量, 整数型, , , 
.局部变量 k, 文本型, , , 
.局部变量 是否移到指针, 逻辑型, , "0", 

 ' ---------------------------------------------------------------------
.如果真 (等于 (是否为空 (间隔符号), 真))
    赋值 (间隔符号, “,”)
.如果真结束
赋值 (是否显示进度, 取反 (是否为空 (进度显示器)))
 ' 分析全部号码表，删除每个号码前后的空格,并判断单个号码的最大长度
赋值 (全部号码表, 分割文本 (备选号码表, 间隔符号, ))
.计次循环首 (取数组成员数 (全部号码表), i)
    赋值 (全部号码表 [i], 删首尾空 (全部号码表 [i]))
    赋值 (当前号码长度, 取文本长度 (全部号码表 [i]))
    .如果真 (大于 (当前号码长度, 号码最大长度))
        赋值 (号码最大长度, 当前号码长度)
    .如果真结束
    
.计次循环尾 ()
 ' 格式化号码
.计次循环首 (取数组成员数 (全部号码表), i)
    赋值 (当前号码长度, 取文本长度 (全部号码表 [i]))
    赋值 (号码前缀文本, 取重复文本 (相减 (号码最大长度, 当前号码长度), “0”))
    赋值 (全部号码表 [i], 相加 (号码前缀文本, 全部号码表 [i]))
.计次循环尾 ()
 ' ---------------------------------------------------------------------
赋值 (全部号码个数, 取数组成员数 (全部号码表))
赋值 (总注数, 未知函数_67174514 (全部号码个数, 选出个数))
赋值 (单位进度注数, 相除 (总注数, 100))
.如果真 (等于 (是否显示进度, 真))
    赋值 (进度显示器., 30)
    赋值 (进度显示器., 真)
    赋值 (单位显示宽度, 相除 (进度显示器., 100))
.如果真结束

 ' ---------------------------------------------------------------------
 ' 找出每一位上的可能出现的数字
.计次循环首 (选出个数, i)
    赋值 (k, “”)
    .变量循环首 (i, 相加 (相减 (全部号码个数, 选出个数), i), 1, j)
        赋值 (k, 相加 (k, 全部号码表 [j], “ ”))
    .变量循环尾 ()
    加入成员 (各位数字, 删首尾空 (k))
.计次循环尾 ()
 ' ---------------------------------------------------------------------
 ' 初始化各位指针
重定义数组 (各位指针, 假, 选出个数)
重定义数组 (是否移到指针, 假, 选出个数)
赋值 (是否移到指针 [选出个数], 真)
.计次循环首 (选出个数, i)
    赋值 (各位指针 [i], 1)
.计次循环尾 ()
 ' ---------------------------------------------------------------------
 ' 形成组合
.如果真 (等于 (是否显示进度, 真))
    进度显示器.清除 ()
    进度显示器.写文本行 (“正在形成组合表，请稍候......”)
.如果真结束

.计次循环首 (总注数, i)
    赋值 (k, “”)
    .计次循环首 (取数组成员数 (各位数字), j)
        赋值 (本位数字, 分割文本 (各位数字 [j], “ ”, ))
        赋值 (k, 相加 (k, 本位数字 [各位指针] [j], “ ”))
    .计次循环尾 ()
    加入成员 (结果表, 删首尾空 (k))
    处理事件 ()
     ' 按照倒序处理指针位置
    .计次循环首 (取数组成员数 (各位指针), j)
        .如果真 (并且 (等于 (各位指针 [j], 取数组成员数 (本位数字)), 大于 (j, 1)))
            赋值 (是否移到指针 [相减 (j, 1)], 真)
        .如果真结束
        
    .计次循环尾 ()
    
    赋值 (各位指针 [取数组成员数 (各位指针)], 相加 (各位指针 [取数组成员数 (各位指针)], 1))
    
    .变量循环首 (相减 (取数组成员数 (各位指针), 1), 1, -1, j)
        .如果真 (等于 (是否移到指针 [j], 真))
            赋值 (各位指针 [j], 相加 (各位指针 [j], 1))
            赋值 (是否移到指针 [j], 假)
            .变量循环首 (j, 相减 (取数组成员数 (各位指针), 1), 1, l)
                赋值 (各位指针 [相加 (l, 1)], 各位指针 [l])
            .变量循环尾 ()
        .如果真结束
        
    .变量循环尾 ()
    
    
    
    .如果真 (等于 (是否显示进度, 真))
        赋值 (经历注数, 相加 (经历注数, 1))
        .如果真 (等于 (经历注数, 单位进度注数))
            赋值 (经历注数, 0)
            赋值 (当前显示数量, 相加 (当前显示数量, 1))
            进度显示器.画渐变矩形 (0, 15, 相乘 (当前显示数量, 单位显示宽度), 30, #从左到右, #红褐, #褐绿, #黄色, #深青)
        .如果真结束
        
    .如果真结束
    
.计次循环尾 ()
 ' ---------------------------------------------------------------------
 ' 将形成的组合写入文本文件
赋值 (文件名, 取临时文件名 (取运行目录 ()))
赋值 (i, 寻找文本 (文件名, “.”, , 假))
赋值 (文件名, 相加 (取文本左边 (文件名, 相减 (i, 1)), “.txt”))
写到文件 (文件名, {  })
.如果真 (等于 (是否显示进度, 真))
    进度显示器.清除 ()
    进度显示器.写文本行 (相加 (“共”, 到文本 (总注数), “个组合，正在写入文件，请稍候......”))
.如果真结束
赋值 (文件号, 打开文件 (文件名, , ))
赋值 (单位进度注数, 相除 (总注数, 100))
赋值 (当前显示数量, 0)
赋值 (经历注数, 0)
.计次循环首 (总注数, i)
    赋值 (结果文本, 删首尾空 (结果表 [i]))
    写文本行 (文件号, 结果文本)
    处理事件 ()
    .如果真 (等于 (是否显示进度, 真))
        赋值 (经历注数, 相加 (经历注数, 1))
        .如果真 (等于 (经历注数, 单位进度注数))
            赋值 (经历注数, 0)
            赋值 (当前显示数量, 相加 (当前显示数量, 1))
            进度显示器.画渐变矩形 (0, 15, 相乘 (当前显示数量, 单位显示宽度), 30, #从左到右, #红褐, #褐绿, #黄色, #深青)
        .如果真结束
        
    .如果真结束
    
.计次循环尾 ()
关闭文件 (文件号)
.如果真 (等于 (是否显示进度, 真))
    进度显示器.画渐变矩形 (0, 15, 进度显示器., 30, #从左到右, #红褐, #褐绿, #黄色, #深青)
.如果真结束
返回 (文件名)

.子程序 取组合数量, 整数型, 公开, 返回能够形成的组合的数量。^e^易宝宝^e^
.参数 M, 整数型, , 30选7时，M＝30
.参数 N, 整数型, , 30选7时，N＝7

.局部变量 循环变量, 整数型, , , 
.局部变量 组合1, 长整数型, , , 
.局部变量 组合2, 长整数型, , , 
.局部变量 中间变量, 整数型, , , 

 ' ---------------------------------------------------------------------
.如果真 (小于 (M, N))
    赋值 (中间变量, M)
    赋值 (M, N)
    赋值 (N, 中间变量)
.如果真结束
 ' ---------------------------------------------------------------------
.如果 (大于 (相减 (M, N), N))
    赋值 (中间变量, 相减 (M, N))
.否则
    赋值 (中间变量, N)
.如果结束
 ' ---------------------------------------------------------------------
赋值 (组合1, 1)
.变量循环首 (相加 (中间变量, 1), M, 1, 循环变量)
    赋值 (组合1, 相乘 (组合1, 循环变量))
.变量循环尾 ()
 ' ---------------------------------------------------------------------
赋值 (组合2, 1)
.变量循环首 (1, 相减 (M, 中间变量), 1, 循环变量)
    赋值 (组合2, 相乘 (组合2, 循环变量))
.变量循环尾 ()
 ' ---------------------------------------------------------------------
返回 (相除 (组合1, 组合2))


 ' 不属于任何一个程序集、类模块的函数：
