 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 909
    高度 = 778
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “老王牌-NpcEditor”
    帮助文件名 = “”

窗口 窗口_命令编辑
    左边 = 50
    顶边 = 50
    宽度 = 554
    高度 = 519
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “脚本命令编辑”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' eDB 46E94341933A462383A4DE26B146322C 2 7 数据库操作支持库
 ' commobj {A068799B-7551-46b9-8CA8-EEF8357AFEA4} 2 0 通用对象支持库
 ' spec A512548E76954B6E92C21055517615B0 3 1 特殊功能支持库




数据类型 Point, 公开, 
    .成员 x, 整数型, , , 
    .成员 y, 整数型, , , 


.DLL命令 GetCaretPos, 整数型, "user32.dll", "GetCaretPos", , 光标
    .参数 p, Point, , 

.DLL命令 ClientToScreen, 空白型, "user32.dll", "ClientToScreen", , 光标
    .参数 id, 整数型, , 
    .参数 p, Point, , 
    .参数 匿名参数_40, 空白型, , 

.DLL命令 送消息, 整数型, "", "SendMessageA", , 
    .参数 hwnd, 整数型, , 
    .参数 msg, 整数型, , 
    .参数 wpram, 整数型, , 
    .参数 lparam, 整数型, , 

.DLL命令 GetForegroundWindow, 整数型, "", "GetForegroundWindow", , 光标

.窗口程序集 窗口程序集1, , , 

.程序集变量 程序集变量_索引文字, 文本型, , , 
.程序集变量 程序集变量_删除索引, 未知类型0x40001, , , 
.子程序 _编辑框代码编辑_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (程序集变量_索引文字, 相加 (程序集变量_索引文字, 字符 (键代码)))
子程序_命令索引 ()
输出调试文本 (键代码)


.子程序 子程序_命令索引, 空白型, , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_中文命令, 文本型, , , 

清空 ()
“NPC.mdb”.未知支持库函数_1 (“”)
.未知支持库函数_12 ()
相加 (“select * from npcml where npcml.英文索引 like '”, 程序集变量_索引文字, “%%'”).未知支持库函数_14 (#, )
输出调试文本 (局部_中文命令)
.计次循环首 (., 局部_计次)
    “中文命令”.未知支持库函数_26 (局部_中文命令)
    局部_中文命令.加入项目 (局部_计次)
     ' 测试之用
    未知支持库函数_36 ()
.计次循环尾 ()
未知支持库函数_16 ()
赋值 (., 0)

.子程序 _编辑框代码编辑_内容被改变, 空白型, , 
.局部变量 point, Point, , , 

赋值 (point, 取光标的屏幕坐标 ())
调试输出 (相加 (“组件位置:”, 到文本 (.左边), “,”, 到文本 (.顶边)))
调试输出 (相加 (“光标位置:”, 到文本 (point.x), “,”, 到文本 (point.y)))

赋值 (.左边, 相加 (相减 (point.x, _启动窗口.左边), 200))
赋值 (.顶边, 相加 (相减 (point.y, _启动窗口.顶边), 95))


.子程序 取光标的屏幕坐标, Point, 公开, 取光标在屏幕上的坐标值
.局部变量 p, Point, , , 

GetCaretPos (p)
ClientToScreen (GetForegroundWindow (), p)
返回 (p)


.子程序 _时钟1_周期事件, 空白型, , 
.局部变量 j, 空白型, , , 
.局部变量 l, 空白型, , , 
.局部变量 lh, 空白型, , , 
.局部变量 p, Point, , , 

GetCaretPos (p)
赋值 (j, 求余数 (送消息 (取窗口句柄 (), 176, 0, 0), 65536))
赋值 (l, 送消息 (取窗口句柄 (), 201, j, 0))
0.置文本 (“版本号：V.1”)
1.置文本 (“软件作者：叫我老王 QQ:26259675”)
2.置文本 (“技术支持：http://www.baidu.com”)
3.置文本 (相加 (“当前行：”, 到文本 (相加 (l, 1))))
赋值 (lh, 相加 (相减 (j, 送消息 (取窗口句柄 (), 187, -1, 0)), 1))
4.置文本 (相加 (“当前列：”, 到文本 (lh)))
5.置文本 (相加 (“光标位置”, 到文本 (p.x), “,”, 到文本 (p.y)))

 ' 标签3.标题 ＝ 到文本 (xy.X) ＋ “  ” ＋ 到文本 (xy.Y)

.窗口程序集 脚本管理, , , 添加-删除-修改

.程序集变量 程序集_中文命令, 文本型, , , 
.程序集变量 程序集_脚本类型, 文本型, , , 
.子程序 _窗口_命令编辑_创建完毕, 空白型, , 
子程序_打开数据库 ()
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--


.子程序 子程序_打开数据库, 空白型, , 
.局部变量 局部_计次, 整数型, , , 

.判断开始 (等于 (.取项目文本 (.现行选中项), “语气”))
    “NPC.mdb”.未知支持库函数_1 (“”)
    .未知支持库函数_12 ()
    “Select * From NpcMl WHERE npcml.脚本类型 = '0'”.未知支持库函数_14 (#, )
    .计次循环首 (., 局部_计次)
        “中文命令”.未知支持库函数_26 (程序集_中文命令)
        程序集_中文命令.加入项目 ()
        未知支持库函数_36 ()
    .计次循环尾 ()
    未知支持库函数_16 ()
    未知支持库函数_3 ()
     ' 本源码来自易语言资源网(www.5A5X.com)
.判断 (等于 (.取项目文本 (.现行选中项), “检查命令”))
    “NPC.mdb”.未知支持库函数_1 (“”)
    .未知支持库函数_12 ()
    “Select * From NpcMl WHERE npcml.脚本类型 = '1'”.未知支持库函数_14 (#, )
    .计次循环首 (., 局部_计次)
        “中文命令”.未知支持库函数_26 (程序集_中文命令)
        程序集_中文命令.加入项目 (局部_计次)
        未知支持库函数_36 ()
    .计次循环尾 ()
    未知支持库函数_16 ()
     ' 本源码来自易语言资源网(www.5A5X.com)
    未知支持库函数_3 ()
.判断 (等于 (.取项目文本 (.现行选中项), “执行命令”))
    “NPC.mdb”.未知支持库函数_1 (“”)
    .未知支持库函数_12 ()
    “Select * From NpcMl WHERE npcml.脚本类型 = '2'”.未知支持库函数_14 (#, )
    .计次循环首 (., 局部_计次)
        “中文命令”.未知支持库函数_26 (程序集_中文命令)
        程序集_中文命令.加入项目 (局部_计次)
        未知支持库函数_36 ()
    .计次循环尾 ()
    未知支持库函数_16 ()
    未知支持库函数_3 ()
.判断 (等于 (.取项目文本 (.现行选中项), “变量操作”))
    “NPC.mdb”.未知支持库函数_1 (“”)
    .未知支持库函数_12 ()
     ' 本源码来自易语言资源网(www.5A5X.com)
    “Select * From NpcMl WHERE npcml.脚本类型 = '3'”.未知支持库函数_14 (#, )
    .计次循环首 (., 局部_计次)
        “中文命令”.未知支持库函数_26 (程序集_中文命令)
        程序集_中文命令.加入项目 (局部_计次)
        未知支持库函数_36 ()
    .计次循环尾 ()
    未知支持库函数_16 ()
    未知支持库函数_3 ()
.判断 (等于 (.取项目文本 (.现行选中项), “系统变量”))
    “NPC.mdb”.未知支持库函数_1 (“”)
    .未知支持库函数_12 ()
    “Select * From NpcMl WHERE npcml.脚本类型 = '4'”.未知支持库函数_14 (#, )
    .计次循环首 (., 局部_计次)
        “中文命令”.未知支持库函数_26 (程序集_中文命令)
        程序集_中文命令.加入项目 (局部_计次)
        未知支持库函数_36 ()
         ' 本源码来自易语言资源网(www.5A5X.com)
    .计次循环尾 ()
    未知支持库函数_16 ()
    未知支持库函数_3 ()
.默认
    
.判断结束


.子程序 _列表框_命令显示_列表项被选择, 空白型, , 
 ' 记录集_脚本.打开并过滤 (“jbml”, “cnsm='” ＋ 列表框_命令显示.取项目文本 (列表框_命令显示.现行选中项) ＋ “'”)
 ' 记录集_脚本.读文本 (“zxml”, 程序集_脚本命令)
 ' 记录集_脚本.读文本 (“jbcs”, 程序集_脚本参数)
 ' 记录集_脚本.读文本 (“cnsm”, 程序集_脚本说明)
 ' 记录集_脚本.读文本 (“jblc”, 程序集_脚本例程)
 ' 编辑框_脚本命令.内容 ＝ 程序集_脚本命令
 ' 编辑框_脚本参数.内容 ＝ 程序集_脚本参数
 ' 编辑框_中文解释.内容 ＝ 程序集_脚本说明
 ' 编辑框_脚本例程.内容 ＝ 程序集_脚本例程
 ' 记录集_脚本.关闭 ()

.子程序 _组合框_语法分类_列表项被选择, 空白型, , 
清空 ()
子程序_打开数据库 ()
' 本源码来自易语言资源网(www.5A5X.com)


 ' 不属于任何一个程序集、类模块的函数：
