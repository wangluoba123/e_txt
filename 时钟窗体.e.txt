 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 780
    顶边 = 32
    宽度 = 192
    高度 = 32
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 16711935 '  0xFF00FF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\时钟窗体.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 292
    高度 = 446
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “设置”
    帮助文件名 = “”

窗口 窗口2
    左边 = 600
    顶边 = 50
    宽度 = 281
    高度 = 174
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关机时间设定”
    帮助文件名 = “”

窗口 窗口3
    左边 = 50
    顶边 = 50
    宽度 = 497
    高度 = 391
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “更换桌面设置”
    帮助文件名 = “”

窗口 窗口4
    左边 = 50
    顶边 = 50
    宽度 = 204
    高度 = 140
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关机时间到了！”
    帮助文件名 = “”

窗口 窗口5
    左边 = 50
    顶边 = 50
    宽度 = 444
    高度 = 391
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “播放MP3”
    帮助文件名 = “”



.图片 托盘图标, " ' 已保存到：D:\易语言学习\Data\时钟窗体.e\托盘图标", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 1 系统核心支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' eImgConverter 8FA3AA46276847db8F28E57E7FB97B7F 1 0 图像格式转换支持库
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 0 应用接口支持库




.全局变量 宽, 整数型, , , 单位象素
.全局变量 高, 整数型, , , 单位象素
.全局变量 数码集, 字节集, , , 
.全局变量 窗体形状, 字节集, , , 
.全局变量 配置文件名, 文本型, , , 
.全局变量 图片数, 短整数型, , , 
.全局变量 图片文件名, 文本型, , , 
.全局变量 频率, 短整数型, , , 
.全局变量 关机时间, 文本型, , , 
.全局变量 播放提示音, 逻辑型, , , 
.全局变量 显示效果, 文本型, , , 
.全局变量 自身贴图, 逻辑型, , , 
.全局变量 关机前是否提示, 逻辑型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 数码, 字节集, , , 
.程序集变量 现在时间, 日期时间型, , , 
.程序集变量 时, 字节型, , "2", 
.程序集变量 分, 字节型, , "2", 
.程序集变量 秒, 字节型, , "2", 
.程序集变量 偏移, 整数型, , , 单位字节
.程序集变量 临时, 整数型, , , 
.程序集变量 计次变量, 整数型, , , 
.程序集变量 当前图片, 短整数型, , , 
.程序集变量 计数, 短整数型, , , 
.程序集变量 文件号, 整数型, , , 
.子程序 _时钟1_周期事件, 空白型, , 
赋值 (现在时间, 取现行时间 ())
赋值 (秒 [1], 求余数 (取秒 (现在时间), 10))
更新窗体形状 (秒 [1], 偏移)
.如果真 (等于 (秒 [1], 0))
    赋值 (秒 [2], 相除 (取秒 (现在时间), 10))
    更新窗体形状 (秒 [2], 相乘 (2, 偏移))
    .如果真 (等于 (秒 [2], 0))
        赋值 (分 [1], 求余数 (取分钟 (现在时间), 10))
        更新窗体形状 (分 [1], 相乘 (4, 偏移))
        .如果真 (等于 (分 [1], 0))
            赋值 (分 [2], 相除 (取分钟 (现在时间), 10))
            更新窗体形状 (分 [2], 相乘 (5, 偏移))
            .如果真 (等于 (分 [2], 0))
                赋值 (时 [1], 求余数 (取小时 (现在时间), 10))
                更新窗体形状 (时 [1], 相乘 (7, 偏移))
                .如果真 (等于 (时 [1], 0))
                    赋值 (时 [2], 相除 (取小时 (现在时间), 10))
                    更新窗体形状 (时 [2], 相乘 (8, 偏移))
                    
                .如果真结束
                
                
            .如果真结束
            
        .如果真结束
        
    .如果真结束
    
.如果真结束

_启动窗口.置外形图片 (窗体形状, #白色)
.如果真 (等于 (自身贴图, 真))
    赋值 (_启动窗口., 窗体形状)
.如果真结束
.如果真 (等于 (关机时间, 时间到文本 (现在时间, #时间部分)))
    载入 (窗口4, , 真)
.如果真结束


.子程序 更新窗体形状, 空白型, , 
.参数 数位, 字节型, , 
.参数 位置, 整数型, , 

赋值 (数码, 未知支持库函数_31 (数码集, 数位, #白色))
.计次循环首 (高, 计次变量)
    赋值 (临时, 相乘 (偏移, 计次变量))
    赋值 (窗体形状, 字节集替换 (窗体形状, 相减 (相加 (55, 相乘 (12, 临时)), 位置), 偏移, 取字节集中间 (数码, 相减 (相加 (55, 临时), 偏移), 偏移)))
.计次循环尾 ()

.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (配置文件名, 相加 (取当前目录 (), “\配置.ini”))
赋值 (关机时间, 读配置项 (配置文件名, “关机时间”, “关机时间”, “0时0分0秒”))
赋值 (频率, 到数值 (读配置项 (配置文件名, “更换桌面配置”, “频率”, “000000”)))
赋值 (当前图片, 到数值 (读配置项 (配置文件名, “更换桌面配置”, “当前图片”, “000”)))
赋值 (.时钟周期, 相乘 (频率, 1000))
赋值 (关机前是否提示, 真)
赋值 (播放提示音, 真)
赋值 (现在时间, 取现行时间 ())
赋值 (秒 [1], 求余数 (取秒 (现在时间), 10))
赋值 (秒 [2], 相除 (取秒 (现在时间), 10))
赋值 (分 [1], 求余数 (取分钟 (现在时间), 10))
赋值 (分 [2], 相除 (取分钟 (现在时间), 10))
赋值 (时 [1], 求余数 (取小时 (现在时间), 10))
赋值 (时 [2], 相除 (取小时 (现在时间), 10))
_刷新 ()
_启动窗口.置托盘图标 (#托盘图标, )

.子程序 _刷新, 空白型, , 
赋值 (窗体形状, 读入文件 (读配置项 (配置文件名, “格式”, “时间格式”, “时间格式.bmp”)))
赋值 (宽, 相除 (取字节集数据 (取字节集中间 (窗体形状, 19, 4), #整数型), 12))
赋值 (高, 取字节集数据 (取字节集中间 (窗体形状, 23, 4), #整数型))
赋值 (_启动窗口., 相乘 (宽, 12))
赋值 (_启动窗口., 高)
赋值 (_启动窗口., 相减 (960, _启动窗口.))
赋值 (偏移, 相乘 (3, 宽))
赋值 (数码集, 未知支持库函数_30 (宽, 高))
未知支持库函数_24 (数码集, 读入文件 (读配置项 (配置文件名, “格式”, “数码格式”, “数码格式.bmp”)), )
赋值 (显示效果, 取文本左边 (读配置项 (配置文件名, “格式”, “显示效果”, “自身贴图”), 8))
.如果 (等于 (显示效果, “自身贴图”))
    赋值 (自身贴图, 真)
.否则
    .如果 (等于 (显示效果, “使用底色”))
        赋值 (_启动窗口., 取空白字节集 (0))
        赋值 (_启动窗口., 到数值 (文本替换 (读配置项 (配置文件名, “格式”, “显示效果”, “自身贴图”), 1, 9, )))
    .否则
        赋值 (_启动窗口., 读入文件 (读配置项 (配置文件名, “格式”, “显示效果”, “自身贴图”)))
    .如果结束
    赋值 (自身贴图, 假)
.如果结束
更新窗体形状 (秒 [1], 偏移)
更新窗体形状 (秒 [2], 相乘 (2, 偏移))
更新窗体形状 (分 [1], 相乘 (4, 偏移))
更新窗体形状 (分 [2], 相乘 (5, 偏移))
更新窗体形状 (时 [1], 相乘 (7, 偏移))
更新窗体形状 (时 [2], 相乘 (8, 偏移))
_启动窗口.置外形图片 (窗体形状, #白色)


.子程序 _退出_被选择, 空白型, , 
结束 ()


.子程序 __启动窗口_托盘事件, 空白型, , 
.参数 操作类型, 整数型, , 

_启动窗口.弹出托盘菜单 ()

.子程序 _锁定_被选择, 空白型, , 
赋值 (_启动窗口., .选中)
赋值 (.选中, 取反 (.选中))

.子程序 _最前_被选择, 空白型, , 
赋值 (_启动窗口., .选中)
赋值 (.选中, 取反 (.选中))


.子程序 _设置_被选择, 空白型, , 
载入 (窗口1, , 假)


.子程序 _时钟2_周期事件, 空白型, , 
赋值 (图片数, 到数值 (读配置项 (配置文件名, “更换桌面配置”, “图片数”, “000”)))
.如果真 (大于 (图片数, 0))
    赋值 (图片文件名, 读配置项 (配置文件名, “更换桌面配置”, 相加 (“图片”, 到文本 (当前图片)), “临时.bmp”))
    赋值 (当前图片, 相加 (求余数 (当前图片, 图片数), 1))
    未知支持库函数_1 (图片文件名, “临时.bmp”)
    未知支持库函数_65 (相加 (取当前目录 (), “\临时.bmp”), #)
    
.如果真结束


.子程序 _定时关机_被选择, 空白型, , 
载入 (窗口2, , 真)


.子程序 _换桌面_被选择, 空白型, , 
载入 (窗口3, , 假)

.子程序 _立即关机_被选择, 空白型, , 
.如果真 (等于 (信息框 (“真的要关机？”, 4, ), #是钮))
    未知支持库函数_8 (#, )
    
.如果真结束


.子程序 _播放MP3_被选择, 空白型, , 
载入 (窗口5, , 假)


.窗口程序集 窗口程序集2, , , 

.程序集变量 原数码格式, 文本型, , , 
.程序集变量 原时间格式, 文本型, , , 
.程序集变量 原显示效果, 文本型, , , 
.子程序 _颜色选择器1_颜色被改变, 空白型, , 
赋值 (_启动窗口., .颜色)
赋值 (_启动窗口., 取空白字节集 (0))

.子程序 _窗口1_创建完毕, 空白型, , 
赋值 (原数码格式, 读配置项 (配置文件名, “格式”, “数码格式”, “数码格式.bmp”))
赋值 (原时间格式, 读配置项 (配置文件名, “格式”, “时间格式”, “时间格式.bmp”))
赋值 (原显示效果, 读配置项 (配置文件名, “格式”, “显示效果”, “自身贴图”))
赋值 (.图片, 读入文件 (原数码格式))
赋值 (.图片, 读入文件 (原时间格式))
赋值 (.标题, 原数码格式)
赋值 (.标题, 原时间格式)
赋值 (.标题, 原显示效果)
赋值 (显示效果, 取文本左边 (.标题, 8))
.如果 (等于 (显示效果, “自身贴图”))
    赋值 (自身贴图, 真)
    赋值 (.选中, 真)
    赋值 (.禁止, 真)
    赋值 (.可视, 假)
.否则
    .如果 (等于 (显示效果, “使用底色”))
        赋值 (.可视, 真)
        赋值 (.选中, 真)
        赋值 (.禁止, 真)
        赋值 (.颜色, 到数值 (文本替换 (.标题, 1, 9, )))
    .否则
        赋值 (.禁止, 假)
        赋值 (.选中, 真)
        赋值 (.可视, 假)
    .如果结束
    赋值 (自身贴图, 假)
.如果结束
赋值 (.时钟周期, 1000)


.子程序 _按钮5_被单击, 空白型, , 
写配置项 (配置文件名, “格式”, “数码格式”, 原数码格式)
写配置项 (配置文件名, “格式”, “时间格式”, 原时间格式)
写配置项 (配置文件名, “格式”, “显示效果”, 原显示效果)
_刷新 ()
赋值 (.时钟周期, 0)
销毁 ()


.子程序 _按钮4_被单击, 空白型, , 
_预览 ()
赋值 (.时钟周期, 0)
销毁 ()


.子程序 _按钮1_被单击, 空白型, , 
.如果真 (打开 ())
    赋值 (.标题, .文件名)
    _预览 ()
.如果真结束


.子程序 _按钮2_被单击, 空白型, , 
.如果真 (打开 ())
    赋值 (.标题, .文件名)
    赋值 (.图片, 读入文件 (.标题))
    _预览 ()
.如果真结束


.子程序 _按钮3_被单击, 空白型, , 
.如果真 (打开 ())
    赋值 (.标题, .文件名)
    赋值 (.图片, 读入文件 (.标题))
    _预览 ()
.如果真结束


.子程序 _单选框2_被单击, 空白型, , 
赋值 (.可视, 真)
赋值 (.选中, 真)
赋值 (自身贴图, 假)
赋值 (.禁止, 真)
_颜色选择器1_颜色被改变 ()


.子程序 _单选框1_被单击, 空白型, , 
赋值 (自身贴图, 真)
赋值 (.选中, 真)
赋值 (.禁止, 真)
赋值 (.可视, 假)


.子程序 _单选框3_被单击, 空白型, , 
赋值 (.禁止, 假)
赋值 (自身贴图, 假)
赋值 (.选中, 真)
赋值 (.可视, 假)
赋值 (_启动窗口., 读入文件 (.标题))


.子程序 _预览, 空白型, , 
写配置项 (配置文件名, “格式”, “数码格式”, .标题)
写配置项 (配置文件名, “格式”, “时间格式”, .标题)
.如果 (等于 (.选中, 真))
    写配置项 (配置文件名, “格式”, “显示效果”, 相加 (“使用底色#”, 到文本 (_启动窗口.)))
.否则
    .如果 (等于 (.选中, 真))
        写配置项 (配置文件名, “格式”, “显示效果”, “自身贴图”)
    .否则
        .如果 (等于 (.选中, 真))
            写配置项 (配置文件名, “格式”, “显示效果”, .标题)
        .否则
            
        .如果结束
        
    .如果结束
    
.如果结束
_刷新 ()



.子程序 _时钟1_周期事件, 空白型, , 
赋值 (.图片, 快照 (_启动窗口.取窗口句柄 (), , ))

.子程序 _窗口1_将被销毁, 空白型, , 
赋值 (.时钟周期, 0)


.窗口程序集 窗口程序集3, , , 

.程序集变量 时, 文本型, , , 
.程序集变量 分, 文本型, , , 
.程序集变量 秒, 文本型, , , 
.程序集变量 当前位置, 短整数型, , , 
.程序集变量 前一位置, 短整数型, , , 
.子程序 _按钮1_被单击, 空白型, , 
赋值 (时, 取文本右边 (相加 (“00”, .内容), 2))
赋值 (分, 取文本右边 (相加 (“00”, .内容), 2))
赋值 (秒, 取文本右边 (相加 (“00”, .内容), 2))
赋值 (关机时间, 相加 (到文本 (到数值 (时)), “时”, 到文本 (到数值 (分)), “分”, 到文本 (到数值 (秒)), “秒”))
写配置项 (配置文件名, “关机时间”, “关机时间”, 关机时间)
销毁 ()

.子程序 _窗口2_创建完毕, 空白型, , 
赋值 (当前位置, 寻找文本 (关机时间, “时”, , 假))
赋值 (.内容, 取文本左边 (关机时间, 相减 (当前位置, 1)))
赋值 (前一位置, 当前位置)
赋值 (当前位置, 寻找文本 (关机时间, “分”, , 假))
赋值 (.内容, 取文本中间 (关机时间, 相加 (前一位置, 2), 相减 (当前位置, 前一位置, 2)))
赋值 (前一位置, 当前位置)
赋值 (当前位置, 寻找文本 (关机时间, “秒”, , 假))
赋值 (.内容, 取文本中间 (关机时间, 相加 (前一位置, 2), 相减 (当前位置, 前一位置, 2)))
赋值 (.标题, 读配置项 (配置文件名, “关机时间”, “关机提示音”, “无”))
.如果 (等于 (关机前是否提示, 真))
    赋值 (.选中, 播放提示音)
    赋值 (.选中, 关机前是否提示)
    赋值 (.禁止, 取反 (.选中))
.否则
    赋值 (.禁止, 真)
    赋值 (.选中, 关机前是否提示)
    赋值 (.禁止, 真)
    
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _选择框1_被单击, 空白型, , 
赋值 (.禁止, 取反 (.选中))
赋值 (播放提示音, .选中)

.子程序 _按钮3_被单击, 空白型, , 
.如果真 (打开 ())
    写配置项 (配置文件名, “关机时间”, “关机提示音”, .文件名)
    赋值 (.标题, .文件名)
.如果真结束



.子程序 _选择框2_被单击, 空白型, , 
赋值 (.禁止, 取反 (.选中))
赋值 (.禁止, 取反 (.选中))
赋值 (播放提示音, .选中)
赋值 (关机前是否提示, .选中)




.窗口程序集 窗口程序集4, , , 

.子程序 _驱动器框1_驱动器被改变, 空白型, , 
连续赋值 (相加 (.驱动器, “:\”), .目录, .目录)


.子程序 _目录框1_目录被改变, 空白型, , 
赋值 (.目录, .目录)


.子程序 _文件框1_选择文件被改变, 空白型, , 
赋值 (.图片, 读入文件 (相加 (.目录, “\”, .被选择文件)))


.子程序 _按钮1_被单击, 空白型, , 
相加 (.目录, “\”, .被选择文件).加入项目 ()
相减 (取项目数 (), 1).置焦点项目 ()


.子程序 _按钮2_被单击, 空白型, , 
取焦点项目 ().删除项目 ()
相减 (取项目数 (), 1).置焦点项目 ()


.子程序 _窗口3_创建完毕, 空白型, , 
赋值 (图片数, 到数值 (读配置项 (配置文件名, “更换桌面配置”, “图片数”, “000”)))
.判断循环首 (大于 (图片数, 0))
    读配置项 (配置文件名, “更换桌面配置”, 相加 (“图片”, 到文本 (图片数)), “临时.bmp”).加入项目 ()
    相减 (取项目数 (), 1).置焦点项目 ()
    赋值 (图片数, 相减 (图片数, 1))
.判断循环尾 ()
赋值 (.图片, 读入文件 (.取项目文本 (.现行选中项)))
赋值 (.内容, 到文本 (频率))

.子程序 _按钮3_被单击, 空白型, , 
赋值 (图片数, 取项目数 ())
写配置项 (配置文件名, “更换桌面配置”, , ) ' 清除原有项目
写配置项 (配置文件名, “更换桌面配置”, “频率”, 取文本右边 (相加 (“000000”, .内容), 6))
写配置项 (配置文件名, “更换桌面配置”, “图片数”, 取文本右边 (相加 (“000”, 到文本 (图片数)), 3))
.判断循环首 (大于 (图片数, 0))
    赋值 (图片文件名, 相加 (.目录, “\”, 相减 (图片数, 1).取项目文本 ()))
    赋值 (图片文件名, 取文本右边 (图片文件名, 相加 (相减 (取文本长度 (图片文件名), 倒找文本 (图片文件名, “:\”, , 假)), 2)))
    写配置项 (配置文件名, “更换桌面配置”, 相加 (“图片”, 到文本 (图片数)), 图片文件名)
    赋值 (图片数, 相减 (图片数, 1))
.判断循环尾 ()
赋值 (频率, 到数值 (.内容))
赋值 (_启动窗口..时钟周期, 相乘 (频率, 1000))
销毁 ()


.子程序 _列表框1_列表项被选择, 空白型, , 
赋值 (.图片, 读入文件 (.取项目文本 (.现行选中项)))


.窗口程序集 窗口程序集5, , , 

.子程序 _窗口4_创建完毕, 空白型, , 
.如果 (等于 (关机前是否提示, 真))
    .如果真 (等于 (播放提示音, 真))
        播放MP3 (-1, 读配置项 (配置文件名, “关机时间”, “关机提示音”, “无”))
    .如果真结束
    赋值 (.标题, 相加 (“现在时间：”, 关机时间, #换行符, #换行符, “是否关机！”))
.否则
    未知支持库函数_8 (#, )
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
未知支持库函数_8 (#, )

.子程序 _按钮2_被单击, 空白型, , 
停止播放 ()
销毁 ()

.窗口程序集 窗口程序集6, , , 

.程序集变量 MP3数, 短整数型, , , 
.程序集变量 MP3文件名, 文本型, , "999", 
.子程序 _驱动器框1_驱动器被改变, 空白型, , 
连续赋值 (相加 (.驱动器, “:\”), .目录, .目录)


.子程序 _目录框1_目录被改变, 空白型, , 
赋值 (.目录, .目录)


.子程序 _按钮1_被单击, 空白型, , 
相加 (.目录, “\”, .被选择文件).加入项目 ()
相减 (取项目数 (), 1).置焦点项目 ()


.子程序 _按钮2_被单击, 空白型, , 
取焦点项目 ().删除项目 ()
相减 (取项目数 (), 1).置焦点项目 ()


.子程序 _窗口5_创建完毕, 空白型, , 
赋值 (MP3数, 到数值 (读配置项 (配置文件名, “音乐”, “MP3数”, “000”)))
.判断循环首 (大于 (MP3数, 0))
    赋值 (MP3文件名 [MP3数], 读配置项 (配置文件名, “音乐”, 相加 (“MP3＃”, 到文本 (MP3数)), “空”))
    MP3文件名.加入项目 ( [MP3数], )
    相减 (取项目数 (), 1).置焦点项目 ()
    赋值 (MP3数, 相减 (MP3数, 1))
.判断循环尾 ()

.子程序 _读取MP3, 空白型, , 
赋值 (MP3数, 取项目数 ())
.判断循环首 (大于 (MP3数, 0))
    赋值 (MP3文件名 [MP3数], 相加 (.目录, “\”, 相减 (MP3数, 1).取项目文本 ()))
    赋值 (MP3文件名 [MP3数], 取文本右边 (MP3文件名 [MP3数], 相加 (相减 (取文本长度 (MP3文件名 [MP3数]), 倒找文本 (MP3文件名 [MP3数], “:\”, , 假)), 2)))
    赋值 (MP3数, 相减 (MP3数, 1))
.判断循环尾 ()


.子程序 _按钮3_被单击, 空白型, , 
_读取MP3 ()
播放MP3 (-1, MP3文件名)

.子程序 _窗口5_将被销毁, 空白型, , 
赋值 (MP3数, 取项目数 ())
写配置项 (配置文件名, “音乐”, , ) ' 清除原有项目
写配置项 (配置文件名, “音乐”, “MP3数”, 取文本右边 (相加 (“000”, 到文本 (MP3数)), 3))
.判断循环首 (大于 (MP3数, 0))
    赋值 (MP3文件名 [MP3数], 相加 (.目录, “\”, 相减 (MP3数, 1).取项目文本 ()))
    赋值 (MP3文件名 [MP3数], 取文本右边 (MP3文件名 [MP3数], 相加 (相减 (取文本长度 (MP3文件名 [MP3数]), 倒找文本 (MP3文件名 [MP3数], “:\”, , 假)), 2)))
    写配置项 (配置文件名, “音乐”, 相加 (“MP3＃”, 到文本 (MP3数)), MP3文件名 [MP3数])
    赋值 (MP3数, 相减 (MP3数, 1))
.判断循环尾 ()
停止播放 ()


.子程序 _列表框1_双击选择, 空白型, , 
播放MP3 (-1, .取项目文本 (.现行选中项))


 ' 不属于任何一个程序集、类模块的函数：
