 ' 文件类型：Windows窗口程序

 ' 程序名称：易之表
 ' 程序描述：本例程演示了有关报表、数据处理框架方面的基本内容,您可以将她进一步开发以获得更强的功能。本程序也可以用作编排报表模板文件。
 ' 程序作者：吴涛
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 430
    高度 = 309
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “易之表”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 339
    高度 = 228
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于易之表”
    帮助文件名 = “”

窗口 表格属性窗口
    左边 = 50
    顶边 = 50
    宽度 = 364
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “表格属性”
    帮助文件名 = “”

窗口 颜色选择窗口
    左边 = 50
    顶边 = 50
    宽度 = 295
    高度 = 149
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “请选择颜色:”
    帮助文件名 = “”



.常量 易之表, "“易之表”", , 
.常量 用户习惯, "“用户习惯”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' cncnv 63AA4BEA120C4DABAD567115556DE054 2 0 文字编码转换支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一




.全局变量 颜色选择标题, 文本型, , , 
.全局变量 返回颜色有效, 逻辑型, , , 
.全局变量 返回颜色, 整数型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 现行文件名, 文本型, , , 
.程序集变量 是否被修改, 逻辑型, , , 
.子程序 __启动窗口_尺寸被改变, 空白型, , 
5.移动 (5, 相减 (取用户区宽度 (), 10), 相减 (取用户区高度 (), 10, .))

.子程序 _新建_被选择, 空白型, , 
.如果真 (等于 (询问保存文档 (), 假))
    50.初始尺寸 (10)
    赋值 (是否被修改, 假)
    赋值 (现行文件名, “”)
.如果真结束


.子程序 _打开_被选择, 空白型, , 
.局部变量 文件号, 整数型, , , 

.如果真 (等于 (询问保存文档 (), 假))
    赋值 (.标题, “请输入欲打开的表格文件名：”)
    赋值 (.类型, 0)
    .如果真 (等于 (打开 (), 真))
        打开并读入文件 (.文件名)
        刷新显示状态条信息 ()
    .如果真结束
    
.如果真结束


.子程序 打开并读入文件, 空白型, , 
.参数 文件名, 文本型, , 

.如果 (等于 (文件名.从文件读 (), 假))
    信息框 (“打开文件失败！”, #错误图标, “错误”)
.否则
    赋值 (是否被修改, 假)
    赋值 (现行文件名, 文件名)
.如果结束


.子程序 _保存_被选择, 空白型, , 
保存文档 ()

.子程序 _另存为_被选择, 空白型, , 
赋值 (.标题, “请输入欲另存到的表格文件名：”)
赋值 (.类型, 1)
.如果真 (等于 (打开 (), 真))
    保存文档 (.文件名)
.如果真结束


.子程序 _打印_被选择, 空白型, , 
.如果真 (打印设置 ())
    设置修改 ()
    .打印 ()
.如果真结束


.子程序 _退出_被选择, 空白型, , 
.如果真 (等于 (询问保存文档 (), 假))
    销毁 () ' 通过销毁主窗口退出程序
.如果真结束


.子程序 _剪切_被选择, 空白型, , 
设置修改 ()
取光标行号 ().复制 (取光标列号 (), 取选择行数 (), 取选择列数 ())
取光标行号 ().清除 (取光标列号 (), 取选择行数 (), 取选择列数 ())

.子程序 _复制_被选择, 空白型, , 
取光标行号 ().复制 (取光标列号 (), 取选择行数 (), 取选择列数 ())

.子程序 _粘贴_被选择, 空白型, , 
设置修改 ()
粘贴到光标处 ()

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
返回 (取反 (询问保存文档 ()))

.子程序 询问保存文档, 逻辑型, , 返回真表示用户选择了中止
.局部变量 询问返回, 整数型, , , 

.如果真 (等于 (是否被修改, 真))
    赋值 (询问返回, 信息框 (“文件已经被修改，是否保存？”, 相加 (#取消是否钮, #询问图标), “询问”))
    .如果真 (等于 (询问返回, #取消钮))
        返回 (真)
    .如果真结束
    .如果真 (等于 (询问返回, #是钮))
        .如果真 (等于 (保存文档 (), 真))
            返回 (真)
        .如果真结束
        
    .如果真结束
    
.如果真结束
返回 (假)

.子程序 保存文档, 逻辑型, , 返回真表示用户选择了中止
.参数 文件名, 文本型, 可空, 

.局部变量 保存文件名, 文本型, , , 
.局部变量 文件号, 整数型, , , 

赋值 (保存文件名, 选择 (是否为空 (文件名), 现行文件名, 文件名))
.如果真 (等于 (保存文件名, “”))
    赋值 (.标题, “请输入欲保存到的表格文件名：”)
    赋值 (.类型, 1)
    .如果真 (等于 (打开 (), 假))
        返回 (真)
    .如果真结束
    赋值 (保存文件名, .文件名)
.如果真结束
赋值 (是否被修改, 假)
.如果 (等于 (保存文件名.存到文件 (), 假))
    信息框 (“保存文件失败！”, #错误图标, “错误”)
.否则
    赋值 (现行文件名, 保存文件名)
.如果结束
返回 (假)

.子程序 _打印设置_被选择, 空白型, , 
.如果真 (打印设置 ())
    设置修改 ()
.如果真结束


.子程序 _打印预览_被选择, 空白型, , 
打印预览 ()

.子程序 _清空_被选择, 空白型, , 
设置修改 ()
取光标行号 ().清除 (取光标列号 (), 取选择行数 (), 取选择列数 ())

.子程序 _组合_被选择, 空白型, , 
设置修改 ()
取光标行号 ().合并 (取光标列号 (), 取选择行数 (), 取选择列数 ())

.子程序 _分解_被选择, 空白型, , 
设置修改 ()
取光标行号 ().分解 (取光标列号 ())

.子程序 _插入行_被选择, 空白型, , 
设置修改 ()
.如果 (不等于 (.数据提供者, “数据库提供者1”))
    取光标行号 ().插入行 ()
.否则
    相加 (取行数 (), 1).插入行 ()
    取行数 ().置光标 (1)
.如果结束


.子程序 _插入列_被选择, 空白型, , 
设置修改 ()
取光标列号 ().插入列 ()

.子程序 _删除行_被选择, 空白型, , 
设置修改 ()
取光标行号 ().删除行 (取选择行数 ())

.子程序 _删除列_被选择, 空白型, , 
设置修改 ()
取光标列号 ().删除列 (取选择列数 ())

.子程序 _比例50_被选择, 空白型, , 
赋值 (.缩放比, 50)

.子程序 _比例100_被选择, 空白型, , 
赋值 (.缩放比, 100)

.子程序 _比例200_被选择, 空白型, , 
赋值 (.缩放比, 200)

.子程序 _等宽_被选择, 空白型, , 
等宽缩放 ()

.子程序 _关于易之表_被选择, 空白型, , 
载入 (关于窗口, , 真)

.子程序 _打开数据库_被选择, 空白型, , 此功能用作演示合并多个数据提供者数据的方法
.如果真 (并且 (等于 (询问保存文档 (), 假), 等于 (打开 (), 真), 不等于 (.文件名, “”)))
    打开数据库 (.文件名)
    刷新显示状态条信息 ()
.如果真结束


.子程序 打开数据库, 空白型, , 
.参数 欲打开数据库文件, 文本型, , 

.局部变量 字段数, 整数型, , , 
.局部变量 字段索引, 整数型, , , 
.局部变量 字段名称, 文本型, , "0", 
.局部变量 重试次数, 整数型, , , 
.局部变量 数据库密码, 文本型, , , 

.如果 (是否已加密 (欲打开数据库文件))
    .计次循环首 (3, 重试次数)
        .如果真 (等于 (密码输入框 (数据库密码, 相减 (重试次数, 1)), 假))
            返回 ()
        .如果真结束
        .如果真 (打开 (欲打开数据库文件, , , , , 数据库密码, ))
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
    
.否则
    打开 (欲打开数据库文件, , , , , , )
.如果结束
.如果真 (是否已打开 (欲打开数据库文件))
    置等待鼠标 ()
    
    赋值 (字段数, 取字段数 ())
    .计次循环首 (字段数, 字段索引)
        .如果真 (不等于 (取字段类型 (字段索引), #字节集型))
            加入成员 (字段名称, 取字段名 (字段索引))
        .如果真结束
        
    .计次循环尾 ()
    关闭 ()
    
    赋值 (字段数, 取数组成员数 (字段名称))
    赋值 (.数据提供者, “”)
    1.初始尺寸 (字段数)
    .计次循环首 (字段数, 字段索引)
        1.置文本 (字段索引, 字段名称 [字段索引])
    .计次循环尾 ()
    1.置字体属性 (1, , 字段数, #粗体)
    1.置表头行数 ()
    赋值 (.数据库文件名, 欲打开数据库文件)
    赋值 (.数据库密码, 数据库密码)
    赋值 (.数据提供者, “数据库提供者1”)
    .添加 ()
    赋值 (是否被修改, 假)
    赋值 (现行文件名, “”)
    
    恢复鼠标 ()
.如果真结束


.子程序 _表格1_内容被改变, 空白型, , 
.参数 行号, 整数型, , 
.参数 列号, 整数型, , 
.参数 行数, 整数型, , 
.参数 列数, 整数型, , 

设置修改 ()

.子程序 _修改数据库_被选择, 空白型, , 此功能用作演示数据提供者属性用法
.如果真 (并且 (等于 (询问保存文档 (), 假), 等于 (打开 (), 真), 不等于 (.文件名, “”)))
    赋值 (.数据库文件名, .文件名)
    赋值 (.数据库密码, “?”)
    赋值 (.数据提供者, “数据库提供者1”) ' 请注意使用数据库提供者与使用通用提供者的不同.如不能改变表格行高等.这是由提供者的数据存储能力决定的.
.如果真结束


.子程序 _退出数据库修改_被选择, 空白型, , 
赋值 (.数据提供者, “通用提供者1”)

.子程序 _表格1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _置行高_被选择, 空白型, , 
.局部变量 行高, 整数型, , , 

.如果真 (并且 (输入框 (“请输入新行高（单位0.1毫米）”, “新行高”, , 行高, #输入整数), 大于 (行高, 0)))
    取光标行号 ().置行高 (取选择行数 (), 行高)
    设置修改 ()
.如果真结束


.子程序 _置列宽_被选择, 空白型, , 
.局部变量 列宽, 整数型, , , 

.如果真 (并且 (输入框 (“请输入新列宽（单位0.1毫米）”, “新列宽”, , 列宽, #输入整数), 大于 (列宽, 0)))
    取光标列号 ().置列宽 (取选择列数 (), 列宽)
    设置修改 ()
.如果真结束


.子程序 _表格属性_被选择, 空白型, , 
载入 (表格属性窗口, , 真)

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 参数文本, 文本型, , "0", 感谢"西风"朋友提供此段代码.

赋值 (.表格线颜色, 取数值注册项 (#现行用户, 相加 (“Software\”, #易之表, “\”, #用户习惯, “\”, “表格线颜色”), #黑色))
赋值 (.背景颜色, 取数值注册项 (#现行用户, 相加 (“Software\”, #易之表, “\”, #用户习惯, “\”, “表景颜色”), #白色))
赋值 (.允许选择块, 不等于 (取数值注册项 (#现行用户, 相加 (“Software\”, #易之表, “\”, #用户习惯, “\”, “允许选择块”), 1), 0))
赋值 (.显示标尺, 不等于 (取数值注册项 (#现行用户, 相加 (“Software\”, #易之表, “\”, #用户习惯, “\”, “显示标尺”), 1), 0))
赋值 (.显示空表格线, 不等于 (取数值注册项 (#现行用户, 相加 (“Software\”, #易之表, “\”, #用户习惯, “\”, “显示空表格线”), 1), 0))
赋值 (.禁止调整行高, 不等于 (取数值注册项 (#现行用户, 相加 (“Software\”, #易之表, “\”, #用户习惯, “\”, “禁止调整行高”), 0), 0))
赋值 (.禁止调整列宽, 不等于 (取数值注册项 (#现行用户, 相加 (“Software\”, #易之表, “\”, #用户习惯, “\”, “禁止调整列宽”), 0), 0))
赋值 (.允许粘贴扩展, 不等于 (取数值注册项 (#现行用户, 相加 (“Software\”, #易之表, “\”, #用户习惯, “\”, “允许粘贴扩展”), 1), 0))

关联数据库 ()
取命令行 (参数文本)
.如果真 (并且 (大于 (取数组成员数 (参数文本), 0), 文件是否存在 (参数文本 [1])))
    赋值 (.数据库文件名, 参数文本 [1])
    赋值 (.数据提供者, “数据库提供者1”) ' 请注意使用数据库提供者与使用通用提供者的不同.如不能改变表格行高等.这是由提供者的数据存储能力决定的.
.如果真结束

刷新显示状态条信息 ()


.子程序 __启动窗口_将被销毁, 空白型, , 
写注册项 (#现行用户, 相加 (“Software\”, #易之表, “\”, #用户习惯, “\”, “表格线颜色”), .表格线颜色)
写注册项 (#现行用户, 相加 (“Software\”, #易之表, “\”, #用户习惯, “\”, “背景颜色”), .背景颜色)
写注册项 (#现行用户, 相加 (“Software\”, #易之表, “\”, #用户习惯, “\”, “允许选择块”), 选择 (.允许选择块, 1, 0))
写注册项 (#现行用户, 相加 (“Software\”, #易之表, “\”, #用户习惯, “\”, “显示标尺”), 选择 (.显示标尺, 1, 0))
写注册项 (#现行用户, 相加 (“Software\”, #易之表, “\”, #用户习惯, “\”, “显示空表格线”), 选择 (.显示空表格线, 1, 0))
写注册项 (#现行用户, 相加 (“Software\”, #易之表, “\”, #用户习惯, “\”, “禁止调整行高”), 选择 (.禁止调整行高, 1, 0))
写注册项 (#现行用户, 相加 (“Software\”, #易之表, “\”, #用户习惯, “\”, “禁止调整列宽”), 选择 (.禁止调整列宽, 1, 0))
写注册项 (#现行用户, 相加 (“Software\”, #易之表, “\”, #用户习惯, “\”, “允许粘贴扩展”), 选择 (.允许粘贴扩展, 1, 0))

.子程序 _添加数据_被选择, 空白型, , 
赋值 (.标题, “请输入欲添加进来的表格文件名：”)
赋值 (.类型, 0)
.如果真 (等于 (打开 (), 真))
    .如果 (等于 (.从文件读 (.文件名), 假)) ' 数据源2仅在此处使用
        信息框 (“打开欲添加文件失败！”, #错误图标, “错误”)
    .否则
        .添加 ()
        设置修改 ()
        1.初始尺寸 (1) ' 因为使用的是通用提供者2,所以可以初始化尺寸.在此处清除通用提供者2内的数据.
    .如果结束
    
.如果真结束


.子程序 _文本型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置类型 (取光标列号 (), 取选择行数 (), 取选择列数 (), #文本型)

.子程序 _图片文件名型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置类型 (取光标列号 (), 取选择行数 (), 取选择列数 (), #图片文件名)

.子程序 _图片数据型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置类型 (取光标列号 (), 取选择行数 (), 取选择列数 (), #图片数据)

.子程序 _文本颜色_被选择, 空白型, , 
赋值 (颜色选择标题, “请选择文本颜色:”)
载入 (颜色选择窗口, , 真)
.如果真 (等于 (返回颜色有效, 真))
    设置修改 ()
    取光标行号 ().置文本色 (取光标列号 (), 取选择行数 (), 取选择列数 (), 返回颜色)
.如果真结束


.子程序 _背景颜色_被选择, 空白型, , 
赋值 (颜色选择标题, “请选择背景颜色:”)
载入 (颜色选择窗口, , 真)
.如果真 (等于 (返回颜色有效, 真))
    设置修改 ()
    取光标行号 ().置背景色 (取光标列号 (), 取选择行数 (), 取选择列数 (), 返回颜色)
.如果真结束


.子程序 _字体_被选择, 空白型, , 
.局部变量 字体属性, 整数型, , , 
.局部变量 字体尺寸, 双精度小数型, , , 

.如果真 (等于 (打开 (), 真))
    .如果真 (等于 (.加粗, 真))
        赋值 (字体属性, 相加 (字体属性, #粗体))
    .如果真结束
    .如果真 (等于 (.倾斜, 真))
        赋值 (字体属性, 相加 (字体属性, #斜体))
    .如果真结束
    .如果真 (等于 (.删除线, 真))
        赋值 (字体属性, 相加 (字体属性, #删除线))
    .如果真结束
    .如果真 (等于 (.下划线, 真))
        赋值 (字体属性, 相加 (字体属性, #下划线))
    .如果真结束
    取光标行号 ().置字体属性 (取光标列号 (), 取选择行数 (), 取选择列数 (), 字体属性)
    取光标行号 ().置字体名 (取光标列号 (), 取选择行数 (), 取选择列数 (), .字体名称)
    赋值 (字体尺寸, 相除 (相乘 (.字体大小, 10), 72, 0.0394)) ' 由于字体对话框返回的字体尺寸是以1/72英寸为单位,现将其转换为0.1MM.
    取光标行号 ().置字体尺寸 (取光标列号 (), 取选择行数 (), 取选择列数 (), 字体尺寸)
    设置修改 ()
.如果真结束


.子程序 _边距_被选择, 空白型, , 
.局部变量 边距, 整数型, , , 

.如果真 (输入框 (“请输入边距(单位0.1MM):”, “单元格边距设置”, “9”, 边距, #输入整数))
    设置修改 ()
    取光标行号 ().置边距 (取光标列号 (), 取选择行数 (), 取选择列数 (), 边距)
.如果真结束


.子程序 _通常型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #通常型)

.子程序 _字节型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #字节型)

.子程序 _短整数型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #短整数型)

.子程序 _整数型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #整数型)

.子程序 _长整数型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #长整数型)

.子程序 _小数型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #小数型)

.子程序 _双精度小数型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #双精度小数型)

.子程序 _逻辑型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #逻辑型)

.子程序 _日期时间型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #日期时间型)

.子程序 _上左_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #上左)

.子程序 _上中_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #上中)

.子程序 _上右_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #上右)

.子程序 _中左_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #中左)

.子程序 _中中_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #中中)

.子程序 _中右_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #中右)

.子程序 _下左_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #下左)

.子程序 _下中_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #下中)

.子程序 _下右_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #下右)

.子程序 _缩放图片_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #缩放图片)

.子程序 _居中图片_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #居中图片)

.子程序 _缩放居中图片_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #缩放居中图片)

.子程序 _平铺图片_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #平铺图片)

.子程序 _缩放平铺图片_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #缩放平铺图片)

.子程序 _添加边框_被选择, 空白型, , 
设置修改 ()
取光标行号 ().加线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), 相加 (#左边框, #上边框, #右边框, #下边框))

.子程序 _添加全部表格线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().加线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))

.子程序 _添加水平表格线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().加线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), #水平线)

.子程序 _添加垂直表格线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().加线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), #垂直线)

.子程序 _添加单斜线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().加线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), #单斜线)

.子程序 _添加双斜线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().加线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), #双斜线)

.子程序 _添加交叉线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().加线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), #交叉线)

.子程序 _清除内部表格线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().删线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), 相加 (#水平线, #垂直线))

.子程序 _清除斜线或交叉线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().删线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), 相加 (#单斜线, #双斜线, #交叉线))

.子程序 _清除所有表格线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().删线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))

.子程序 _写入图片数据_被选择, 空白型, , 
 ' 图片文件名称可以直接以文本方式写入.
.如果真 (等于 (打开 (), 真))
    设置修改 ()
    取光标行号 ().置数据 (取光标列号 (), 读入文件 (.文件名))
.如果真结束


.子程序 _置表头行数_被选择, 空白型, , 
.局部变量 表头行数, 整数型, , , 

.如果真 (输入框 (“请输入表头行数:”, “表头行数设置”, “0”, 表头行数, #输入整数))
    设置修改 ()
    表头行数.置表头行数 ()
.如果真结束


.子程序 _置表头列数_被选择, 空白型, , 
.局部变量 表头列数, 整数型, , , 

.如果真 (输入框 (“请输入表头列数:”, “表头列数设置”, “0”, 表头列数, #输入整数))
    设置修改 ()
    表头列数.置表头列数 ()
.如果真结束


.子程序 关联数据库, 逻辑型, , 感谢"西风"朋友提供此段代码.
.如果 (是否为调试版 ())
    返回 (假)
.否则
    返回 (并且 (写注册项 (#根类, “.edb\”, “edbfile”), 写注册项 (#根类, “edbfile\”, “易数据库”), 写注册项 (#根类, “edbfile\DefaultIcon\”, 相加 (选择 (等于 (取文本右边 (取运行目录 (), 1), “\”), 取运行目录 (), 相加 (取运行目录 (), “\”)), 取执行文件名 (), “,0”)), 写注册项 (#根类, “edbfile\shell\open\command\”, 相加 (选择 (等于 (取文本右边 (取运行目录 (), 1), “\”), 取运行目录 (), 相加 (取运行目录 (), “\”)), 取执行文件名 (), “ %1”))))
.如果结束


.子程序 设置修改, 空白型, , 
.如果真 (不等于 (.数据提供者, “数据库提供者1”))
    赋值 (是否被修改, 真)
.如果真结束


.子程序 _GBK到BIG5_被选择, 空白型, , 
转换语言 (#)

.子程序 _BIG5到GBK_被选择, 空白型, , 
转换语言 (#)

.子程序 _GBK到SJIS_被选择, 空白型, , 
转换语言 (#)

.子程序 _SJIS到GBK_被选择, 空白型, , 
转换语言 (#)

.子程序 转换语言, 空白型, , 
.参数 转换方式, 整数型, , 

.局部变量 行数, 整数型, , , 
.局部变量 列数, 整数型, , , 
.局部变量 行, 整数型, , , 
.局部变量 列, 整数型, , , 

设置修改 ()

赋值 (行数, 取行数 ())
赋值 (列数, 取列数 ())
.计次循环首 (行数, 行)
    .计次循环首 (列数, 列)
        行.置文本 (列, 未知支持库函数_0 (行.取文本 (列), 转换方式))
    .计次循环尾 ()
.计次循环尾 ()
刷新 ()

.子程序 _置为只读_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置只读方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), 真)

.子程序 _取消只读_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置只读方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), 假)

.子程序 _密码方式输入_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置密码方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), 真)

.子程序 _取消密码方式_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置密码方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), 假)

.子程序 _添加上边线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().加线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), #上边框)


.子程序 _添加下边线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().加线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), #下边框)


.子程序 _添加左边线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().加线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), #左边框)


.子程序 _添加右边线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().加线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), #右边框)


.子程序 刷新显示状态条信息, 空白型, , 
.局部变量 s, 文本型, , , 
.局部变量 cx, 整数型, , , 
.局部变量 cy, 整数型, , , 
.局部变量 row, 整数型, , , 
.局部变量 col, 整数型, , , 
.局部变量 width, 整数型, , , 
.局部变量 height, 整数型, , , 
.局部变量 i, 整数型, , , 

赋值 (row, 取光标行号 ())
赋值 (col, 取光标列号 ())
赋值 (s, 相加 (“第”, 到文本 (row), “行，第”, 到文本 (col), “列；”))
.如果真 (或者 (大于 (取选择行数 (), 1), 大于 (取选择列数 (), 1)))
    赋值 (s, 相加 (s, “选中”, 到文本 (取选择行数 ()), “行”, 到文本 (取选择列数 ()), “列；”))
.如果真结束

连续赋值 (0, width, height)
.变量循环首 (row, 相减 (相加 (row, 取选择行数 ()), 1), 1, i)
    赋值 (height, 相加 (height, i.取行高 ()))
.变量循环尾 ()
.变量循环首 (col, 相减 (相加 (col, 取选择列数 ()), 1), 1, i)
    赋值 (width, 相加 (width, i.取列宽 ()))
.变量循环尾 ()

赋值 (s, 相加 (s, “尺寸：”, 到文本 (相除 (width, 10)), “x”, 到文本 (相除 (height, 10)), “mm”))
1.置文本 (s)


.子程序 _表格1_光标位置改变, 空白型, , 
刷新显示状态条信息 ()

.子程序 _表格1_选择行列数改变, 空白型, , 
刷新显示状态条信息 ()

.子程序 _表格1_行高被改变, 空白型, , 
.参数 行号, 整数型, , 

刷新显示状态条信息 ()

.子程序 _表格1_列宽被改变, 空白型, , 
.参数 列号, 整数型, , 

刷新显示状态条信息 ()

.窗口程序集 窗口程序集2, , , 

.子程序 _按钮1_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集3, , , 

.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()

.子程序 _确定按钮_被单击, 空白型, , 
赋值 (_启动窗口..表格线颜色, .颜色)
赋值 (_启动窗口..背景颜色, .颜色)
赋值 (_启动窗口..允许选择块, .选中)
赋值 (_启动窗口..显示标尺, .选中)
赋值 (_启动窗口..显示空表格线, .选中)
赋值 (_启动窗口..禁止调整行高, .选中)
赋值 (_启动窗口..禁止调整列宽, .选中)
赋值 (_启动窗口..允许粘贴扩展, .选中)
销毁 ()

.子程序 _表格属性窗口_创建完毕, 空白型, , 
赋值 (.颜色, _启动窗口..表格线颜色)
赋值 (.颜色, _启动窗口..背景颜色)
赋值 (.选中, _启动窗口..允许选择块)
赋值 (.选中, _启动窗口..显示标尺)
赋值 (.选中, _启动窗口..显示空表格线)
赋值 (.选中, _启动窗口..禁止调整行高)
赋值 (.选中, _启动窗口..禁止调整列宽)
赋值 (.选中, _启动窗口..允许粘贴扩展)

.窗口程序集 窗口程序集4, , , 

.子程序 _颜色选择窗口_创建完毕, 空白型, , 
赋值 (返回颜色有效, 假)
赋值 (.标题, 颜色选择标题)

.子程序 _确认按钮_被单击, 空白型, , 
赋值 (返回颜色有效, 真)
赋值 (返回颜色, .颜色)
销毁 ()

.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()


 ' 不属于任何一个程序集、类模块的函数：
