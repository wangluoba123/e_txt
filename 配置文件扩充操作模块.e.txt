 ' 文件类型：未知类型

 ' 程序名称：配置文件扩充操作
 ' 程序描述：配置文件的扩充操作：

  删除配置项（）
  删除配置节（）
  取配置文件所有节名（）
  取配置项所有名称（）
 ' 程序作者：神2
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：boychong2@eyou.com
 ' 主页地址：http://www.boychong.bak.cn
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 7 系统核心支持库





.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。

.子程序 删除配置项, 空白型, 公开, 
.参数 配置文件名, 文本型, , 
.参数 节名称, 文本型, , 
.参数 配制项名称, 文本型, , 

.局部变量 a, 文本型, , "2", 
.局部变量 b, 整数型, , "3", 

.如果真 (文件是否存在 (配置文件名))
    写配置项 (配置文件名, 节名称, 配制项名称, “Mark2928198601074334”)
    赋值 (a [1], 到文本 (读入文件 (配置文件名)))
    赋值 (b [2], 寻找文本 (a [1], “Mark2928198601074334”, 1, 假))
    赋值 (b [1], 倒找文本 (a [1], #换行符, b [2], 假))
    赋值 (b [3], 寻找文本 (a [1], #换行符, b [2], 假))
    .如果真 (等于 (b [3], -1))
        赋值 (b [3], 取文本长度 (a [1]))
    .如果真结束
    赋值 (a [2], 相加 (取文本左边 (a [1], b [1]), 取文本右边 (a [1], 相减 (取文本长度 (a [1]), b [3]))))
    写到文件 (配置文件名, 到字节集 (a [2]))
.如果真结束


.子程序 删除配置节, 空白型, 公开, 
.参数 配置文件名, 文本型, , 
.参数 节名称, 文本型, , 

.局部变量 a, 文本型, , "2", 
.局部变量 b, 整数型, , "2", 

.如果真 (文件是否存在 (配置文件名))
    赋值 ( [1], 到文本 (读入文件 (配置文件名)))
    赋值 ( [1], 寻找文本 ( [1], 相加 (“[”, 节名称, “]”), , 假))
    .如果真 (大于 ( [1], -1))
        赋值 ( [2], 寻找文本 ( [1], “[”, 相加 ( [1], 取文本长度 (节名称), 1), 假))
        .如果真 (等于 ( [2], -1))
            赋值 ( [2], 取文本长度 ( [1]))
        .如果真结束
        赋值 (a [2], 相加 (取文本左边 (a [1], 相减 (b [1], 1)), 取文本右边 (a [1], 相加 (相减 (取文本长度 (a [1]), b [2]), 1))))
        写到文件 (配置文件名, 到字节集 ( [2]))
    .如果真结束
    
.如果真结束


.子程序 取配置文件所有节名, 文本型, 公开, 返回指定配置文件中所有的节名称，以“|”为分界，如果配置文件不存在或配置文件中没有节将返回空文本
.参数 配置文件名, 文本型, , 

.局部变量 a, 文本型, , "2", 
.局部变量 b, 整数型, , , 

.如果 (取反 (文件是否存在 (配置文件名)))
    返回 (“”)
.否则
    赋值 (b, 打开文件 (配置文件名, #读入, #无限制))
    .判断循环首 (取反 (是否在文件尾 (b, 真)))
        赋值 (a [1], 读入一行 (b))
        .如果真 (并且 (等于 (取文本左边 (a [1], 1), “[”), 大于 (文本比较 (取文本左边 (a [1], 寻找文本 (a [1], “]”, 1, 真)), “[”, 假), 0)))
            .如果 (不等于 (a [2], “”))
                赋值 (a [2], 相加 (a [2], “|”, 取文本中间 (a [1], 2, 相减 (寻找文本 (a [1], “]”, 1, 真), 2))))
            .否则
                赋值 (a [2], 取文本中间 (a [1], 2, 相减 (寻找文本 (a [1], “]”, 1, 真), 2)))
            .如果结束
            
        .如果真结束
        
    .判断循环尾 ()
    关闭文件 (b)
    返回 (a [2])
.如果结束


.子程序 取配置项所有名称, 文本型, 公开, 返回指定配置文件中指定的节中所有的配置名称，以“|”为分界，如果配置文件不存在或配置文件中指定节为空将返回空文本
.参数 配置文件名, 文本型, , 
.参数 节名称, 文本型, , 

.局部变量 a, 文本型, , "3", 
.局部变量 b, 整数型, , "3", 
.局部变量 c, 文本型, , "0", 

.如果 (取反 (文件是否存在 (配置文件名)))
    返回 (“”)
.否则
    赋值 (a [1], 到文本 (读入文件 (配置文件名)))
    赋值 ( [1], 寻找文本 ( [1], 相加 (“[”, , “]”), , 假))
    .如果真 (大于 ( [1], -1))
        赋值 ( [2], 寻找文本 ( [1], “[”, 相加 ( [1], 取文本长度 (), 1), 假))
        .如果真 (等于 ( [2], -1))
            赋值 ( [2], 取文本长度 ( [1]))
        .如果真结束
        赋值 (a [2], 取文本中间 (a [1], 相加 (b [1], 取文本长度 (节名称), 4), 相减 (b [2], b [1], 取文本长度 (节名称), 4)))
        .如果真 (大于 (寻找文本 (a [2], “=”, , 假), -1))
            赋值 (c, 分割文本 (a [2], “=”, ))
            .如果 (大于 (倒找文本 (c [1], #换行符, , 真), -1))
                赋值 (a [3], 取文本右边 (c [1], 相减 (取文本长度 (c [1]), 倒找文本 (c [1], #换行符, , 真), 1)))
            .否则
                赋值 (a [3], c [1])
            .如果结束
            
            .变量循环首 (2, 相减 (取数组成员数 (c), 1), 1, b [3])
                赋值 (a [3], 相加 (a [3], “|”, 取文本右边 (c [b] [3], 相减 (取文本长度 (c [b] [3]), 倒找文本 (c [b] [3], #换行符, , 真), 1))))
            .变量循环尾 ()
        .如果真结束
        
    .如果真结束
    
    返回 (a [3])
.如果结束



 ' 不属于任何一个程序集、类模块的函数：
