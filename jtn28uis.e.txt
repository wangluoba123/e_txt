 ' 文件类型：Windows模块源码

 ' 程序名称：排错模块
 ' 程序描述：修改自王军例程
--- 使用替换程序替换完毕导入此模块，首先调用初始化（）方法。
 ' 程序作者：圣地
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 窗口2
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 5 系统核心支持库
 ' spec A512548E76954B6E92C21055517615B0 2 1 特殊功能支持库




.全局变量 全保存文件路径, 文本型, , , 
.全局变量 全是否启用排错, 逻辑型, , , 
.全局变量 全错误代码, 整数型, , , 
.全局变量 全错误文本, 文本型, , , 
.全局变量 全自编错误代码, 文本型, , , 
.全局变量 匿名全局变量_50, 空白型, , , 

.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码
载入 (窗口2, , 真)
_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。


.程序集 程序集, , , 

.子程序 初始化, 空白型, 公开, 程序运行前先调用
.参数 参是否启用排错, 逻辑型, , 如果为假不启用排除功能，替换后的‘写入排错检查日志’子程序将不进行写日志操作
.参数 参出错文档保存路径, 文本型, 可空, 如果空默认使用：取运行目录 () ＋ “\排错日志.log”

写配置项 (全保存文件路径, “错误”, “代码”, ) ' 先把原来的记录删除，如果写日志在代码前可以不用此操作
赋值 ()
.如果 (参是否启用排错)
    .如果 (是否为空 ())
        赋值 (全保存文件路径, 相加 (取运行目录 (), “\排错日志.log”))
    .否则
        赋值 (全保存文件路径, 参出错文档保存路径)
    .如果结束
    置错误提示管理 ()

.子程序 _错误提示, 逻辑型, , 
.参数 错误代码, 整数型, , 
.参数 错误文本, 文本型, , 

赋值 (全错误代码, 错误代码)
赋值 (全错误文本, 错误文本)
赋值 (全自编错误代码, 读配置项 (全保存文件路径, “错误”, “代码”, “未知错误-可能原因是记录出错信息失败！”))
载入 (窗口1, 窗口2, 假)
返回 (真)

.子程序 写入排错检查日志, 空白型, 公开, 
.参数 操作, 文本型, 可空, 

.局部变量 保存文件路径, 文本型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 文本, 文本型, , , 
.局部变量 计数器, 整数型, , , 

.如果 (全是否启用排错)
    赋值 (相加 (到文本 (未知函数_67174440 (取现行时间 ())), “   ”, ))
    写配置项 (全保存文件路径, “错误”, “代码”, 文本)
    
.否则
    
.如果结束


.子程序 取中文格式年月日时分秒, 文本型, , 返回"2000年02月12日09时31分20秒"格式的日期时间格式,用于标准输出
.参数 原始时间, 日期时间型, , 

.局部变量 新格式时间, 文本型, , , 

赋值 (新格式时间, 相加 (到文本 (取年份 (原始时间)), “年”, 取文本右边 (相加 (“00”, 到文本 (取月份 (原始时间))), 2), “月”, 取文本右边 (相加 (“00”, 到文本 (取日 (原始时间))), 2), “日”, 取文本右边 (相加 (“00”, 到文本 (取小时 (原始时间))), 2), “时”, 取文本右边 (相加 (“00”, 到文本 (取分钟 (原始时间))), 2), “分”, 取文本右边 (相加 (“00”, 到文本 (取秒 (原始时间))), 2), “秒”))
返回 (新格式时间)


.窗口程序集 窗口程序集1, , , 

.子程序 _窗口1_创建完毕, 空白型, , 
调试输出 (到文本 (全错误代码))
调试输出 (全错误文本)
调试输出 (全自编错误代码)
赋值 (.内容, 相加 (到文本 (全错误代码), “|”, 全错误文本, “|”, 全自编错误代码))


.窗口程序集 窗口程序集2, , , 

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 数组, 整数型, , "0", 

未知函数_67174460 (“3242”)
加入成员 (数组, 1)
未知函数_67174460 (“3111242”)

信息框 (数组 [2], 0, )


.子程序 _窗口2_创建完毕, 空白型, , 
初始化 (真, )



 ' 不属于任何一个程序集、类模块的函数：
