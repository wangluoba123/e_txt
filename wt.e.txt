 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 535
    高度 = 479
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 6
    底图方式 = 2
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “易打字”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 170
    高度 = 244
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “请选择文章”
    帮助文件名 = “”

窗口 窗口2
    左边 = 50
    顶边 = 50
    宽度 = 328
    高度 = 239
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.图片 dt, " ' 已保存到：D:\易语言学习\Data\wt.e\dt", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 4 系统核心支持库




.全局变量 文件名, 文本型, , , 
.全局变量 正确数, 整数型, , , 
.全局变量 错误数, 整数型, , , 
.全局变量 用时, 整数型, , , 
.全局变量 练习时间, 整数型, , , 
.全局变量 记录创造者, 文本型, , , 
.全局变量 记录, 短整数型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 dz, 编辑框, , "8", 
.程序集变量 sr, 编辑框, , "8", 
.程序集变量 文件号, 整数型, , , 
.程序集变量 光标位置, 短整数型, , , 
.程序集变量 音乐数组, 文本型, , "0", 
.子程序 初始化, 空白型, , 
.局部变量 a, 整数型, , , 

赋值 (dz [1], )
赋值 (sr [1], )
连续赋值 (真, ., .)
.计次循环首 (7, a)
    复制窗口组件 (dz [相加 (a, 1)])
    赋值 (dz [相加 (a, 1)]., 真)
    赋值 (dz [相加 (a, 1)]., 到文本 (相加 (a, 1)))
    赋值 (dz [相加 (a, 1)]., .)
    赋值 (dz [相加 (a, 1)]., 相加 (., 相乘 (a, 24, 2)))
    复制窗口组件 (sr [相加 (a, 1)])
    赋值 (sr [相加 (a, 1)]., 真)
    赋值 (sr [相加 (a, 1)]., 到文本 (相加 (a, 1)))
    赋值 (sr [相加 (a, 1)]., .)
    赋值 (sr [相加 (a, 1)]., 相加 (., 相乘 (a, 24, 2)))
.计次循环尾 ()
连续赋值 (0, 正确数, 错误数, 用时, 光标位置)
载入 (窗口1, , 真)
赋值 (文件号, 打开文件 (文件名, 1, ))
输入文本 ()

.子程序 _开始练习_被选择, 空白型, , 
赋值 (., 真)
赋值 (., 假)
赋值 (., 假)
初始化 ()

.子程序 输入文本, 空白型, , 
.局部变量 a, 整数型, , , 
.局部变量 b, 文本型, , , 

.计次循环首 (8, a)
    .如果真 (是否在文件尾 (文件号, 真))
        移到文件首 (文件号)
    .如果真结束
    赋值 (b, 读入文本 (文件号, 64))
    赋值 (dz [a], , 删首尾空 (b))
    赋值 (dz [], 假)
    赋值 (sr [], 假)
.计次循环尾 ()
获取焦点 ()
赋值 (., 1000)

.子程序 _sr1_内容被改变, 空白型, , 
.局部变量 b, 整数型, , , 
.局部变量 a, 编辑框, , , 
.局部变量 c, 整数型, , , 
.局部变量 d, 整数型, , , 
.局部变量 x, 整数型, , , 

赋值 (a, 取事件组件 ())
连续赋值 (0, c, d)
.变量循环首 (1, 取文本长度 (a.), 2, b)
    .如果 (等于 (取文本中间 (a., b, 2), 取文本中间 (dz [到数值 (a.)]., b, 2)))
        赋值 (c, 相加 (c, 1))
    .否则
        赋值 (d, 相加 (d, 1))
    .如果结束
    
.变量循环尾 ()
.如果 (等于 (取文本长度 (a.), 取文本长度 (dz [到数值 (a.)].)))
    赋值 (正确数, 相加 (正确数, c))
    赋值 (错误数, 相加 (错误数, d))
    赋值 (c, 0)
    赋值 (d, 0)
    .如果 (小于或等于 (相加 (到数值 (.), 1), 8))
        
        sr.获取焦点 ( [相加 (到数值 (.), 1)])
    .否则
        输入文本 ()
        连续赋值 (“”, sr [1]., sr [2]., sr [3]., sr [4]., sr [5]., sr [6]., sr [7]., sr [8].)
        sr.获取焦点 ( [1])
    .如果结束
    
.否则
    
.如果结束
赋值 (., 到文本 (相加 (c, 正确数)))
赋值 (., 到文本 (相加 (d, 错误数)))
赋值 (b, a.)
.如果真 (不等于 (取文本中间 (., 光标位置, 相减 (光标位置)), 取文本中间 (dz [到数值 (.)]., 光标位置, 相减 (光标位置))))
    鸣叫 ()
.如果真结束
赋值 (光标位置, .)
.如果真 (大于或等于 (取文本长度 (a.), 64))
    赋值 (x, 选择 (等于 (到数值 (a.), 8), 1, 相加 (到数值 (a.), 1)))
    输出调试文本 (相加 (到文本 (取文本长度 (a.)), “ ”, 到文本 (x)))
    
    sr.获取焦点 ( [x])
.如果真结束


.子程序 _时钟1_周期事件, 空白型, , 
.局部变量 时, 整数型, , , 
.局部变量 分, 整数型, , , 
.局部变量 秒, 整数型, , , 

赋值 (用时, 相加 (用时, 1))
赋值 (秒, 求余数 (用时, 60))
赋值 (分, 求余数 (整除 (用时, 60), 60))
赋值 (时, 整除 (用时, 3600))
赋值 (., 相加 (到文本 (时), “:”, 到文本 (分), “:”, 到文本 (秒)))
.如果 (等于 (整除 (用时, 60), 0))
    赋值 (分, 1)
.否则
    赋值 (分, 整除 (用时, 60))
.如果结束
赋值 (., 到文本 (整除 (相加 (到数值 (.), 到数值 (.)), 分)))
.如果 (大于或等于 (用时, 相乘 (练习时间, 60)))
    赋值 (., 0)
    .如果 (等于 (信息框 (“练习时间已到！继续吗？”, 4, “时间到”), 5))
        _重新开始_被选择 ()
    .否则
        _结束练习_被选择 ()
    .如果结束
    
.否则
    
.如果结束


.子程序 __启动窗口_将被销毁, 空白型, , 
记录 ()
关闭文件 (文件号)
结束 ()

.子程序 记录, 空白型, , 
.如果 (小于 (记录, 到数值 (.)))
    输入框 (相加 (“您超过了以前的记录！”, #换行符, “上次记录创造者：”, 记录创造者, “  记录为：”, 到文本 (记录), “字/分”, #换行符, “你的记录为：”, ., “字/分”, “ 请输入您的名字”), “输入大名”, , 记录创造者, )
    写注册表项 (“易学打字”, “记录”, “name”, 记录创造者)
    写注册表项 (“易学打字”, “记录”, “gl”, 到数值 (.))
    赋值 (记录, 取数值注册表项 (“易学打字”, “记录”, “gl”, 记录))
.否则
    
.如果结束


.子程序 _结束练习_被选择, 空白型, , 
__启动窗口_将被销毁 ()

.子程序 _重新开始_被选择, 空白型, , 
赋值 (., 0)
记录 ()
连续赋值 (“”, ., .)
初始化 ()

.子程序 _选择文章_被选择, 空白型, , 
.如果 (等于 (信息框 (“练习时间未到！重新选择文章吗？”, 4, “时间到”), 5))
    _重新开始_被选择 ()
.否则
    返回 ()
.如果结束


.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (_启动窗口., #dt)
赋值 (., 真)
赋值 (., 真)
赋值 (记录创造者, 取文本注册表项 (“易学打字”, “记录”, “name”, “无记录”))
赋值 (记录, 取数值注册表项 (“易学打字”, “记录”, “gl”, 0))
赋值 (练习时间, 取数值注册表项 (“易打字”, “记录”, “time”, 30))
音乐 ()

.子程序 _练习时间_被选择, 空白型, , 
输入框 (相加 (“原始设置为：”, 到文本 (练习时间), “分”, #换行符, “请输入您要设置的练习时间：”), “设置时间”, , 练习时间, 2)
写注册表项 (“易学打字”, “记录”, “time”, 练习时间)
赋值 (练习时间, 取数值注册表项 (“易学打字”, “记录”, “time”, 练习时间))

.子程序 _使用说明_被选择, 空白型, , 
赋值 (_启动窗口., 假)
载入 (窗口2, , 假)
赋值 (窗口2., “说明”)
赋值 (窗口2.., 0)

.子程序 _关于易打字_被选择, 空白型, , 
赋值 (_启动窗口., 假)
载入 (窗口2, , 假)
赋值 (窗口2., “关于易打字”)
赋值 (窗口2.., 1)

.子程序 _作者声名_被选择, 空白型, , 
赋值 (_启动窗口., 假)
载入 (窗口2, , 假)
赋值 (窗口2., “无心声名”)
赋值 (窗口2.., 2)

.子程序 _最高记录_被选择, 空白型, , 
信息框 (相加 (“记录创造者：”, 记录创造者, #换行符, “最高记录为：”, 到文本 (记录), “字/分”), 0, “记录”)

.子程序 _停止音乐_被选择, 空白型, , 
.如果 (等于 (., 假))
    赋值 (., 真)
    停止播放 ()
.否则
    赋值 (., 假)
    音乐 ()
.如果结束


.子程序 音乐, 空白型, , 
.局部变量 音乐文件名, 文本型, , , 
.局部变量 a, 整数型, , , 

赋值 (音乐文件名, 寻找文件 (“*.mid”, ))
.判断循环首 (不等于 (“”))
    加入成员 ()
    赋值 (寻找文件 ())
.判断循环尾 ()
.如果真 (大于 (取数组成员数 (音乐数组), 0))
    .计次循环首 (取数组成员数 (音乐数组), a)
        播放音乐 (音乐数组 [a], ) ' 如果找到了音乐文件，则播放。
    .计次循环尾 ()
.如果真结束


.窗口程序集 窗口程序集2, , , 

.子程序 _列表框1_双击选择, 空白型, , 
赋值 (文件名, 相加 (“mgx”, 到文本 (相加 (., 1)), “.txt”))
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
赋值 (文件名, 相加 (“mgx”, 到文本 (相加 (., 1)), “.txt”))
.如果 (等于 (文件名, “mgx0.txt”))
    信息框 (“未选择文件！”, 0, “错误”)
    返回 ()
.否则
    
.如果结束
销毁 ()

.子程序 _窗口1_创建完毕, 空白型, , 
.局部变量 d, 短整数型, , , 
.局部变量 a, 文本型, , "10", 

赋值 (d, 1)
赋值 (a, 分割文本 (读入文本 (打开文件 (“edz.txt”, , ), ), “ ”, ))
清空 ()
.判断循环首 (文件是否存在 (相加 (“mgx”, 到文本 (d), “.txt”)))
    a.加入项目 ( [d], )
    赋值 (d, 相加 (d, 1))
.判断循环尾 ()

.子程序 _窗口1_将被销毁, 空白型, , 
.如果 (等于 (文件名, “”))
    信息框 (“未选择文件！请重新运行！”, 0, “严重错误”)
    结束 ()
.否则
    
.如果结束


.窗口程序集 窗口程序集3, , , 

.子程序 _窗口2_创建完毕, 空白型, , 
赋值 (., 相加 (#换行符, “我也不知道说什么了！唉！”, #换行符, #换行符, “你们自己看吧！”, #换行符, #换行符, “谢谢！”))
赋值 (., 相加 (“易打字不成熟版”, #换行符, “现在的打字软件多的是！”, #换行符, “我只是为了学易语言！”, #换行符, “还很不成熟。”, #换行符, “我好累呀！”, #换行符, “有好建议告诉我，谢谢！”))
赋值 (., 相加 (“无心之劣作！也是辛苦之作！”, #换行符, “感谢世恒多方面的帮助！”, #换行符, “有好的建议告诉我”, #换行符, “我的QQ是：172780052”, #换行符, “谢谢！”))
窗口2.获取焦点 ()

.子程序 _按钮1_被单击, 空白型, , 
赋值 (_启动窗口., 真)
销毁 ()

.子程序 _窗口2_将被销毁, 空白型, , 
赋值 (_启动窗口., 真)


 ' 不属于任何一个程序集、类模块的函数：
