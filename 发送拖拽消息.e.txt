 ' 文件类型：Windows控制台程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 163
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 3 系统核心支持库
 ' commobj {A068799B-7551-46b9-8CA8-EEF8357AFEA4} 2 0 通用对象支持库





.DLL命令 SendMessageA, 整数型, "user32.dll", "SendMessageA", , 
    .参数 hwnd, 整数型, , 
    .参数 wmsg, 整数型, , 
    .参数 wp, 整数型, , 
    .参数 lp, 整数型, , 

.DLL命令 lstrcpyn, 整数型, "kernel32.dll", "lstrcpyn", , ,
    .参数 数据1, 字节集, 传址, lpString1
    .参数 数据2, 字节集, 传址, lpString2
    .参数 数据长度, 整数型, , iMaxLength

.DLL命令 WriteProcessMemory, 空白型, "kernel32.dll", "WriteProcessMemory", , 
    .参数 hProcess, 整数型, , 
    .参数 lpBaseAddress, 整数型, , 
    .参数 lpBuffer, 整数型, , 
    .参数 nSize, 整数型, , 
    .参数 lpNumberOfBytesWritten, 整数型, 传址, 

.DLL命令 OpenProcess, 整数型, "kernel32.dll", "OpenProcess", , 
    .参数 dwDesiredAccess, 整数型, , 
    .参数 bInheritHandle, 整数型, , 
    .参数 dwProcessId, 整数型, , 

.DLL命令 GetWindowThreadProcessId, 整数型, "user32.dll", "GetWindowThreadProcessId", , , GetWindowThreadProcessId，获取与指定窗口关联在一起的一个线程和进程标识符
    .参数 窗口句柄, 整数型, , hwnd，指定窗口句柄
    .参数 进程标识符, 整数型, 传址, lpdwProcessId，指定一个变量，用于装载拥有那个窗口的一个进程的标识符

.DLL命令 SendMessageW, 整数型, "user32.dll", "SendMessageW", , 
    .参数 hwnd, 整数型, , 
    .参数 wmsg, 整数型, , 
    .参数 wp, 整数型, , 
    .参数 lp, 整数型, , 

.DLL命令 MultiByteToWideChar, 整数型, "kernel32.dll", "MultiByteToWideChar", , , 将多媒体字符串映像为通配字符串
    .参数 代码页, 整数型, , 
    .参数 标志, 整数型, , 
    .参数 双字节文本, 文本型, , 
    .参数 双字节文本长度, 整数型, , 
    .参数 宽字符文本, 字节集, , 
    .参数 宽字符文本长度, 整数型, , 

.DLL命令 VirtualAllocEx, 整数型, "kernel32.dll", "VirtualAllocEx", , 
    .参数 hProcess, 整数型, , 
    .参数 lpAddress, 整数型, , 
    .参数 dwSize, 整数型, , 
    .参数 flAllocationType, 整数型, , 
    .参数 flProtect, 整数型, , 

.窗口程序集 窗口程序集_启动窗口, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 


.子程序 _按钮1_被单击, 空白型, , 
发送发送拖放消息_A (到整数 (.内容), .内容)

.子程序 发送发送拖放消息_A, 逻辑型, , 向指定窗口发送拖拽消息_该函数为ANSIC文件名使用
.参数 hWnd, 整数型, , 接受拖拽消息的句柄
.参数 text, 文本型, , 为Unicode编码的字节集 无代码页

.局部变量 文件路径, 文本型, , , 
.局部变量 窗口句柄, 整数型, , , 
.局部变量 写入数据, 字节集, , , 
.局部变量 数据指针, 整数型, , , 
.局部变量 进程句柄, 整数型, , , 
.局部变量 进程ID, 整数型, , , 
.局部变量 写入大小, 整数型, , , 

赋值 (窗口句柄, hWnd)
GetWindowThreadProcessId (窗口句柄, 进程ID)
赋值 (文件路径, text)
赋值 (写入数据, 相加 (到字节集 (20), 取空白字节集 (16), 到字节集 (文件路径)))
赋值 (进程句柄, OpenProcess (位或 (8, 32), 0, 进程ID))
赋值 (数据指针, VirtualAllocEx (进程句柄, 0, 相加 (取文本长度 (文件路径), 20), 4096, 4))
WriteProcessMemory (进程句柄, 数据指针, 取字节集指针 (写入数据), 相加 (取文本长度 (文件路径), 20), 写入大小)
.如果真 (不等于 (写入大小, 相加 (取文本长度 (文件路径), 20)))
    返回 (假)
.如果真结束
SendMessageA (窗口句柄, 563, 数据指针, 0)
返回 (真)

.子程序 取字节集指针, 整数型, , 
.参数 字节集, 字节集, , 

返回 (lstrcpyn (字节集, 字节集, 0))


.子程序 发送发送拖放消息_W, 逻辑型, 公开, 向指定窗口发送拖拽消息_该函数为Unicode文件名使用
.参数 hWnd, 整数型, , 接受拖拽消息的句柄
.参数 text, 字节集, , 为Unicode编码的字节集 无代码页

.局部变量 文件路径, 字节集, , , 
.局部变量 窗口句柄, 整数型, , , 
.局部变量 写入数据, 字节集, , , 
.局部变量 数据指针, 整数型, , , 
.局部变量 进程句柄, 整数型, , , 
.局部变量 进程ID, 整数型, , , 
.局部变量 写入大小, 整数型, , , 

赋值 (窗口句柄, hWnd)
GetWindowThreadProcessId (窗口句柄, 进程ID)
赋值 (文件路径, text)
赋值 (文件路径, 子字节集替换 (文件路径, { 0 }, {  }, , ))
赋值 (写入数据, 相加 (到字节集 (20), 取空白字节集 (16), 文件路径))
赋值 (进程句柄, OpenProcess (位或 (8, 32), 0, 进程ID))
赋值 (数据指针, VirtualAllocEx (进程句柄, 0, 相加 (取字节集长度 (文件路径), 20), 4096, 4))
WriteProcessMemory (进程句柄, 数据指针, 取字节集指针 (写入数据), 相加 (取字节集长度 (文件路径), 20), 写入大小)
.如果真 (不等于 (写入大小, 相加 (取字节集长度 (文件路径), 20)))
    返回 (假)
.如果真结束
SendMessageW (窗口句柄, 563, 数据指针, 0)
返回 (真)

.子程序 A2W, 字节集, , 
.参数 参数_Ansi文本, 文本型, , 
.参数 参数_代码页, 整数型, 可空, 默认为：#CP_ACP = 0

.局部变量 局部_Ansi长度, 整数型, , , 
.局部变量 局部_Unicode长度, 整数型, , , 
.局部变量 ret, 字节集, , , 

赋值 (局部_Ansi长度, 相加 (取文本长度 (参数_Ansi文本), 1))
赋值 (局部_Unicode长度, 相乘 (MultiByteToWideChar (参数_代码页, 0, 参数_Ansi文本, 局部_Ansi长度, ret, 0), 2))
赋值 (ret, 取空白字节集 (局部_Unicode长度))
.如果真 (等于 (MultiByteToWideChar (参数_代码页, 0, 参数_Ansi文本, 局部_Ansi长度, ret, 局部_Unicode长度), 0))
    返回 ({ 0, 0 })
.如果真结束
返回 (ret)

.子程序 字节集到十六进制文本, 文本型, , 
.参数 字节集, 字节集, , 

.局部变量 变量, 整数型, , , 
.局部变量 临时文本, 文本型, , , 
.局部变量 长度, 整数型, , , 
.局部变量 文本, 未知类型0x20001, , , 
.局部变量 a, 整数型, , , 

赋值 (长度, 取字节集长度 (字节集))
.计次循环首 (长度, 变量)
    赋值 (临时文本, 取十六进制文本 (字节集 [变量]))
    文本.未知支持库函数_27 (“ ”)
    文本.未知支持库函数_27 (取重复文本 (相减 (2, 取文本长度 (临时文本)), “0”))
    文本.未知支持库函数_27 (临时文本)
    .如果真 (等于 (求余数 (变量, 16), 0)) ' 一行显示16字节
        文本.未知支持库函数_27 (#换行符)
    .如果真结束
    处理事件 ()
.计次循环尾 ()
返回 (文本.未知支持库函数_24 ())

.子程序 _按钮2_被单击, 空白型, , 
发送发送拖放消息_W (到整数 (.内容), A2W (.内容))



 ' 不属于任何一个程序集、类模块的函数：
