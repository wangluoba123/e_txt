 ' 文件类型：Windows窗口程序

 ' 程序名称：公安系统人口管理系统
 ' 程序描述：公安系统人口管理系统
 ' 程序作者：江岩
 ' 邮政编码：731100
 ' 联系地址：临夏市中意公司
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 1
    底图方式 = 2
    底色 = 6316128 '  0x606060
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “[公安局人口管理系统] - (客户端)”
    帮助文件名 = “”

窗口 登陆窗口
    左边 = 50
    顶边 = 50
    宽度 = 335
    高度 = 245
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 真
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “用户登陆”
    帮助文件名 = “”

窗口 处理窗口
    左边 = 50
    顶边 = 50
    宽度 = 304
    高度 = 80
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 用户管理窗口
    左边 = 50
    顶边 = 50
    宽度 = 411
    高度 = 490
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “用户管理”
    帮助文件名 = “”

窗口 地图导航窗口
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 534
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 行政区划窗口
    左边 = 50
    顶边 = 50
    宽度 = 589
    高度 = 460
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “行政区划增加”
    帮助文件名 = “”

窗口 行政分类查询窗口
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 534
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.图片 主窗口图片, " ' 已保存到：D:\易语言学习\Data\客户端管理.e\主窗口图片", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 2 5 扩展界面支持库三
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' ExtMenu 9909FBB013704cfa8FE7E739DB7172DE 1 6 超级菜单支持库
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 1 1 多线程支持库
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 1 3 高级表格支持库
 ' eDB 46E94341933A462383A4DE26B146322C 1 3 数据库操作支持库
 ' eExcel2000 F86EC5989E044d42BC98C692C0B54727 1 0 EXCEL2000支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库




.全局变量 用户名, 文本型, , , 
.全局变量 密码, 文本型, , , 
.全局变量 地区存在标致, 整数型, , , 
.全局变量 图片框宽度, 整数型, , , 
.全局变量 图片框高度, 整数型, , , 
.全局变量 地区名称变, 文本型, , , 
.全局变量 yyyyy, 文本型, , , 
.全局变量 xxxxx, 文本型, , , 
.全局变量 新增横坐标, 整数型, , , 
.全局变量 新增纵坐标, 整数型, , , 
.全局变量 计次, 整数型, , , 
.全局变量 窗口, 窗口, , "0", 
.全局变量 当前用户名, 文本型, , , 

.DLL命令 置父窗口, 整数型, "", "SetParent", , 
    .参数 子窗口, 整数型, , 
    .参数 父窗口, 整数型, , 

.窗口程序集 登陆窗口程序集, , , 

.程序集变量 不能被关闭, 逻辑型, , , 
.子程序 _登陆窗口_创建完毕, 空白型, , 
_组合框1_列表项被选择 ()
赋值 (不能被关闭, 真)

.子程序 _组合框1_列表项被选择, 空白型, , 
获取焦点 ()

.子程序 _按钮2_被单击, 空白型, , 
结束 ()

.子程序 _按钮1_被单击, 空白型, , 
赋值 (.标题, “正在连接远程服务器...”)
未知支持库函数_0 (&连接远程服务器, )

.子程序 连接远程服务器, 整数型, , 
.如果 (_启动窗口.连接 (., .内容, 889))
    .如果真 (等于 (.内容, “”))
        赋值 (.内容, “ ”)
    .如果真结束
    赋值 (用户名, .内容)
    赋值 (密码, .内容)
    赋值 (当前用户名, .内容)
    客户端_发送网络命令 (“连接”, 相加 (用户名, “:”, 密码))
    赋值 (.内容, “”)
    赋值 (.标题, “远程服务器正在验证用户信息...”)
.否则
    赋值 (.标题, “连接远程服务器失败,请检测连接...”)
    信息框 (“不能连接到远程服务器,请检测网络连接!”, #警告图标, )
.如果结束
返回 (0)

.子程序 _登陆窗口_可否被关闭, 逻辑型, , 
.如果真 (不能被关闭)
    返回 (假)
.如果真结束


.程序集 网络命令程序集, , , 

.程序集变量 当前客户端地址, 文本型, , , 
.子程序 客户端_发送网络命令, 逻辑型, , 
.参数 网络命令, 文本型, , 
.参数 命令参数, 文本型, 可空, 
.参数 真实数据, 字节集, 可空, 

.局部变量 临时文本容器, 文本型, , , 

赋值 (临时文本容器, 网络命令)
.如果真 (不等于 (命令参数, “”))
    赋值 (临时文本容器, 相加 (临时文本容器, “:”, 命令参数, “:”, 用户名, “:”, 密码, “:”, 当前客户端地址))
.如果真结束
.如果 (_启动窗口.发送数据 (., 相加 (到字节集 (相加 (临时文本容器, “@”)), 真实数据)))
    返回 (真)
.否则
    返回 (假)
.如果结束


.子程序 客户端_处理窗口处理, 空白型, , 
.如果真 (是否已创建 (处理窗口))
    赋值 (处理窗口., 真)
    处理窗口.销毁 ()
.如果真结束


.子程序 客户端_处理数据, 空白型, , 
.参数 接收数据, 字节集, , 

.局部变量 网络命令, 文本型, , , 
.局部变量 命令参数, 文本型, , "0", 
.局部变量 临时文本容器, 文本型, , "0", 
.局部变量 真实数据, 字节集, , , 

赋值 (网络命令, 接收网络命令 (接收数据, 命令参数, 真实数据))
.如果 (大于 (取数组成员数 (命令参数), 0))
    赋值 (当前客户端地址, 命令参数 [取数组成员数 (命令参数)])
.否则
    返回 ()
.如果结束
.判断开始 (等于 (网络命令, “连接成功”))
    
    
    赋值 (当前客户端地址, 命令参数 [取数组成员数 (命令参数)])
    赋值 (_启动窗口., 真)
    赋值 (登陆窗口., 假)
    .如果 (等于 (命令参数 [相减 (取数组成员数 (命令参数), 1)], “1”))
        赋值 (_启动窗口..可视, 真)
    .否则
        赋值 (_启动窗口..可视, 假)
    .如果结束
    
    登陆窗口.销毁 ()
    返回 ()
    
    
    
    
.判断 (等于 (网络命令, “连接失败”))
    
    
    鸣叫 ()
    信息框 (“连接到远程服务器失败,请检查您的用户名和密码是否正确!”, 相加 (0, #警告图标), “连接失败”)
    .如果 (是否已创建 (登陆窗口))
        赋值 (登陆窗口..标题, “连接失败!请检测用户和密码是否填写正确!”)
    .否则
        _用户登陆_被选择 ()
    .如果结束
    返回 ()
    
    
    
    
.判断 (等于 (网络命令, “踢出”))
    
    
    鸣叫 ()
    信息框 (“您被远程服务器拒绝了连接!”, 相加 (0, #警告图标), )
    返回 ()
    
    
    
    
.判断 (等于 (网络命令, “改管理员密码_成功”))
    
    
    客户端_处理窗口处理 ()
    赋值 (用户名, 用户管理窗口.)
    赋值 (密码, 用户管理窗口.)
    信息框 (“修改超级管理员密码成功!”, 0, “”)
    返回 ()
    
    
    
    
.判断 (等于 (网络命令, “改管理员密码_失败”))
    
    
    客户端_处理窗口处理 ()
    信息框 (“修改超级管理员密码失败!”, #警告图标, “”)
    返回 ()
    
    
.判断 (等于 (网络命令, “改普管资料_成功”))
    客户端_处理窗口处理 ()
    客户端_显示用户列表 (真实数据)
    返回 ()
.判断 (等于 (网络命令, “取普管列表”))
    客户端_处理窗口处理 ()
    客户端_显示用户列表 (真实数据)
    返回 ()
.判断 (等于 (网络命令, “取普管列表_行政”))
    客户端_处理窗口处理 ()
    客户端_显示行政列表 (真实数据)
    返回 ()
.判断 (等于 (网络命令, “取普管列表_行政查询”))
    客户端_处理窗口处理 ()
    客户端_判断是否存在 (真实数据)
    返回 ()
.判断 (等于 (网络命令, “人口资源查询_列表”))
    客户端_处理窗口处理 ()
    客户端_显示人口资源列表 (真实数据)
    返回 ()
.判断 (等于 (网络命令, “行政分类源查询_列表”))
    客户端_处理窗口处理 ()
    客户端_行政查询资源列表 (真实数据)
    返回 ()
.判断 (等于 (网络命令, “取用户列表”))
    客户端_取用户列表 (真实数据)
    返回 ()
.默认
    
.判断结束


.子程序 客户端_判断是否存在, 空白型, , 
.参数 列表数据, 字节集, , 

.局部变量 临时整数容器, 整数型, , , 
.局部变量 临时文本容器, 文本型, , "2", 
.局部变量 临时文本容器B, 文本型, , , 
.局部变量 临时文本容器C, 文本型, , "0", 
.局部变量 临时文本容器D, 文本型, , "0", 

赋值 (临时文本容器B, 到文本 (列表数据))
.如果 (不等于 (删首尾空 (临时文本容器B), “”))
    .如果 (大于 (寻找文本 (临时文本容器B, “\\\”, 0, 真), 0))
        赋值 (临时文本容器C, 分割文本 (临时文本容器B, “\\\”, ))
    .否则
        加入成员 (临时文本容器C, 临时文本容器B)
    .如果结束
    .变量循环首 (1, 取数组成员数 (临时文本容器C), 1, 临时整数容器)
        赋值 (临时文本容器D, 分割文本 (临时文本容器C [临时整数容器], “|||”, ))
        赋值 (地区存在标致, 取数组成员数 (临时文本容器D))
        .如果真 (大于 (取数组成员数 (临时文本容器D), 2))
            赋值 (地区名称变, 临时文本容器D [7])
            赋值 (yyyyy, 临时文本容器D [5])
            赋值 (xxxxx, 临时文本容器D [6])
        .如果真结束
        
    .变量循环尾 ()
    
.否则
    赋值 (地区存在标致, 0)
.如果结束


.子程序 客户端_显示人口资源列表, 空白型, , 
.参数 列表数据, 字节集, , 

.局部变量 临时整数容器, 整数型, , , 
.局部变量 临时文本容器, 文本型, , "2", 
.局部变量 临时文本容器B, 文本型, , , 
.局部变量 临时文本容器C, 文本型, , "0", 
.局部变量 临时文本容器D, 文本型, , "0", 

 ' 行政区划.超级列表框.全部删除 ()
赋值 (临时文本容器B, 到文本 (列表数据))
.如果真 (是否已创建 (地图导航窗口))
    .如果真 (不等于 (删首尾空 (临时文本容器B), “”))
        .如果 (大于 (寻找文本 (临时文本容器B, “\\\”, 0, 真), 0))
            赋值 (临时文本容器C, 分割文本 (临时文本容器B, “\\\”, ))
        .否则
            加入成员 (临时文本容器C, 临时文本容器B)
        .如果结束
        .变量循环首 (1, 取数组成员数 (临时文本容器C), 1, 临时整数容器)
            赋值 (临时文本容器D, 分割文本 (临时文本容器C [临时整数容器], “|||”, ))
            .如果真 (大于 (取数组成员数 (临时文本容器D), 2))
                地图导航窗口.未知支持库函数_38 (., “”, 地图导航窗口..)
                地图导航窗口.未知支持库函数_9 (., 临时整数容器, 1, #., 临时文本容器D [1])
                地图导航窗口.未知支持库函数_9 (., 临时整数容器, 2, #., 临时文本容器D [2])
                地图导航窗口.未知支持库函数_9 (., 临时整数容器, 3, #., 临时文本容器D [3])
                地图导航窗口.未知支持库函数_9 (., 临时整数容器, 4, #., 临时文本容器D [4])
                地图导航窗口.未知支持库函数_9 (., 临时整数容器, 5, #., 临时文本容器D [5])
                地图导航窗口.未知支持库函数_9 (., 临时整数容器, 6, #., 临时文本容器D [6])
                地图导航窗口.未知支持库函数_9 (., 临时整数容器, 7, #., 临时文本容器D [7])
                地图导航窗口.未知支持库函数_9 (., 临时整数容器, 8, #., 临时文本容器D [8])
                地图导航窗口.未知支持库函数_9 (., 临时整数容器, 9, #., 临时文本容器D [9])
                地图导航窗口.未知支持库函数_9 (., 临时整数容器, 10, #., 临时文本容器D [10])
                地图导航窗口.未知支持库函数_9 (., 临时整数容器, 11, #., 临时文本容器D [11])
                地图导航窗口.未知支持库函数_9 (., 临时整数容器, 12, #., 临时文本容器D [12])
                
            .如果真结束
            
        .变量循环尾 ()
    .如果真结束
    
.如果真结束


.子程序 客户端_显示行政列表, 空白型, , 
.参数 列表数据, 字节集, , 

.局部变量 临时整数容器, 整数型, , , 
.局部变量 临时文本容器, 文本型, , "2", 
.局部变量 临时文本容器B, 文本型, , , 
.局部变量 临时文本容器C, 文本型, , "0", 
.局部变量 临时文本容器D, 文本型, , "0", 

行政区划窗口.全部删除 (.)
赋值 (临时文本容器B, 到文本 (列表数据))
.如果真 (是否已创建 (行政区划窗口))
    .如果真 (不等于 (删首尾空 (临时文本容器B), “”))
        .如果 (大于 (寻找文本 (临时文本容器B, “\\\”, 0, 真), 0))
            赋值 (临时文本容器C, 分割文本 (临时文本容器B, “\\\”, ))
        .否则
            加入成员 (临时文本容器C, 临时文本容器B)
        .如果结束
        .变量循环首 (1, 取数组成员数 (临时文本容器C), 1, 临时整数容器)
            赋值 (临时文本容器D, 分割文本 (临时文本容器C [临时整数容器], “|||”, ))
            .如果真 (大于 (取数组成员数 (临时文本容器D), 2))
                行政区划窗口.插入表项 (., -1, 临时文本容器D [1], , , , )
                行政区划窗口.置标题 (., 相减 (临时整数容器, 1), 1, 临时文本容器D [2])
                行政区划窗口.置标题 (., 相减 (临时整数容器, 1), 2, 临时文本容器D [3])
                行政区划窗口.置标题 (., 相减 (临时整数容器, 1), 3, 临时文本容器D [4])
                行政区划窗口.置标题 (., 相减 (临时整数容器, 1), 4, 临时文本容器D [5])
                行政区划窗口.置标题 (., 相减 (临时整数容器, 1), 5, 临时文本容器D [6])
                 ' 行政区划.超级列表框.置标题 (临时整数容器 － 1, 6, 临时文本容器D [7])
            .如果真结束
            
        .变量循环尾 ()
    .如果真结束
    
.如果真结束


.子程序 客户端_显示用户列表, 空白型, , 
.参数 列表数据, 字节集, , 

.局部变量 临时整数容器, 整数型, , , 
.局部变量 临时文本容器, 文本型, , "2", 
.局部变量 临时文本容器B, 文本型, , , 
.局部变量 临时文本容器C, 文本型, , "0", 
.局部变量 临时文本容器D, 文本型, , "0", 

用户管理窗口.全部删除 (.)
赋值 (临时文本容器B, 到文本 (列表数据))
.如果真 (是否已创建 (用户管理窗口))
    .如果真 (不等于 (删首尾空 (临时文本容器B), “”))
        .如果 (大于 (寻找文本 (临时文本容器B, “\\\”, 0, 真), 0))
            赋值 (临时文本容器C, 分割文本 (临时文本容器B, “\\\”, ))
        .否则
            加入成员 (临时文本容器C, 临时文本容器B)
        .如果结束
        .变量循环首 (1, 取数组成员数 (临时文本容器C), 1, 临时整数容器)
            赋值 (临时文本容器D, 分割文本 (临时文本容器C [临时整数容器], “|||”, ))
            .如果真 (大于 (取数组成员数 (临时文本容器D), 2))
                用户管理窗口.插入表项 (., -1, 临时文本容器D [1], , , , )
                用户管理窗口.置标题 (., 相减 (临时整数容器, 1), 1, 临时文本容器D [2])
                用户管理窗口.置标题 (., 相减 (临时整数容器, 1), 2, 临时文本容器D [3])
            .如果真结束
            
        .变量循环尾 ()
    .如果真结束
    
.如果真结束


.子程序 客户端_行政查询资源列表, 空白型, , 
.参数 列表数据, 字节集, , 

.局部变量 临时整数容器, 整数型, , , 
.局部变量 临时文本容器, 文本型, , "2", 
.局部变量 临时文本容器B, 文本型, , , 
.局部变量 临时文本容器C, 文本型, , "0", 
.局部变量 临时文本容器D, 文本型, , "0", 

 ' 行政区划.超级列表框.全部删除 ()
赋值 (临时文本容器B, 到文本 (列表数据))
.如果真 (是否已创建 (行政分类查询窗口))
    .如果真 (不等于 (删首尾空 (临时文本容器B), “”))
        .如果 (大于 (寻找文本 (临时文本容器B, “\\\”, 0, 真), 0))
            赋值 (临时文本容器C, 分割文本 (临时文本容器B, “\\\”, ))
        .否则
            加入成员 (临时文本容器C, 临时文本容器B)
             ' 行政分类查询窗口.标签1.标题 ＝ “记录数：” ＋ 到文本 (取数组成员数 (临时文本容器C))
        .如果结束
        .变量循环首 (1, 取数组成员数 (临时文本容器C), 1, 临时整数容器)
            赋值 (临时文本容器D, 分割文本 (临时文本容器C [临时整数容器], “|||”, ))
            .如果真 (大于 (取数组成员数 (临时文本容器D), 2))
                行政分类查询窗口.未知支持库函数_38 (., “”, 行政分类查询窗口..)
                行政分类查询窗口.未知支持库函数_9 (., 临时整数容器, 1, #., 临时文本容器D [1])
                行政分类查询窗口.未知支持库函数_9 (., 临时整数容器, 2, #., 临时文本容器D [2])
                行政分类查询窗口.未知支持库函数_9 (., 临时整数容器, 3, #., 临时文本容器D [3])
                行政分类查询窗口.未知支持库函数_9 (., 临时整数容器, 4, #., 临时文本容器D [4])
                行政分类查询窗口.未知支持库函数_9 (., 临时整数容器, 5, #., 临时文本容器D [5])
                行政分类查询窗口.未知支持库函数_9 (., 临时整数容器, 6, #., 临时文本容器D [6])
                行政分类查询窗口.未知支持库函数_9 (., 临时整数容器, 7, #., 临时文本容器D [7])
                行政分类查询窗口.未知支持库函数_9 (., 临时整数容器, 8, #., 临时文本容器D [8])
                行政分类查询窗口.未知支持库函数_9 (., 临时整数容器, 9, #., 临时文本容器D [9])
                行政分类查询窗口.未知支持库函数_9 (., 临时整数容器, 10, #., 临时文本容器D [10])
                行政分类查询窗口.未知支持库函数_9 (., 临时整数容器, 11, #., 临时文本容器D [11])
                行政分类查询窗口.未知支持库函数_9 (., 临时整数容器, 12, #., 临时文本容器D [12])
                
            .如果真结束
            
        .变量循环尾 ()
    .如果真结束
    
.如果真结束


.子程序 _客户_数据到达, 空白型, , 
客户端_处理数据 (_启动窗口.取回数据 (.))


.子程序 接收网络命令, 文本型, , 分析网络数据包并且返回网络命令,参数和真实数据
.参数 欲处理数据, 字节集, , 接收到的网络数据包
.参数 返回参数, 文本型, 可空 数组, 返回用户自定义的网络命令的参数
.参数 返回数据, 字节集, 可空, 返回接收到的数据包中的真实数据

.局部变量 临时整数变量, 整数型, , , 
.局部变量 临时文本变量, 文本型, , , 

赋值 (临时整数变量, 寻找字节集 (欲处理数据, 到字节集 (“@”))) ' 用来记录用户自定义的网络命令起始分割位置
赋值 (临时文本变量, 到文本 (取字节集左边 (欲处理数据, 相减 (临时整数变量, 1)))) ' 取用户自定义的网络命令文本和参数
赋值 (返回数据, 取字节集右边 (欲处理数据, 相减 (取字节集长度 (欲处理数据), 取字节集长度 (到字节集 (相加 (临时文本变量, “@”))))))
.如果 (大于 (临时整数变量, 0)) ' 判断 用户自定义的网络命令是否可用,即[ @ ]字符存在则表示命令符合用户定义的规则
    .如果真 (大于 (寻找文本 (临时文本变量, “:”, 1, 假), 0)) ' 判断定义的命令是否有参数
        
         ' 以下函数取得命令和参数,并给存放网络命令的参数容器赋值
        
        赋值 (返回参数, 分割文本 (临时文本变量, “:”, ))
        赋值 (临时文本变量, 返回参数 [1])
        删除成员 (返回参数, 1, 1)
    .如果真结束
    
.否则
    赋值 (临时文本变量, “ExecErr”) ' 如果[ @ ]不存在,则返回错误指示文本[ ExecErr ]
.如果结束
返回 (临时文本变量) ' 返回用户自定义的网络命令的参数值

.子程序 客户端_取用户列表, 空白型, , 
.参数 用户列表数据, 字节集, , 

.局部变量 临时文本容器B, 文本型, , , 
.局部变量 临时文本容器C, 文本型, , "0", 
.局部变量 临时整数容器, 整数型, , , 

赋值 (临时文本容器B, 到文本 (用户列表数据))
信息框 (临时文本容器B, 0, “”)
.如果真 (不等于 (删首尾空 (临时文本容器B), “”))
    .如果 (大于 (寻找文本 (临时文本容器B, “\\\”, 0, 真), 0))
        赋值 (临时文本容器C, 分割文本 (临时文本容器B, “\\\”, ))
    .否则
        加入成员 (临时文本容器C, 临时文本容器B)
    .如果结束
    .变量循环首 (1, 取数组成员数 (临时文本容器C), 1, 临时整数容器)
        信息框 (临时文本容器C [1], 0, “”)
        登陆窗口.加入项目 (., 临时文本容器C [1], )
    .变量循环尾 ()
.如果真结束



.窗口程序集 处理窗口子程序集, , , 

.程序集变量 临时整数变量, 整数型, , , 
.程序集变量 可否关闭, 逻辑型, , , 
.子程序 _处理窗口_创建完毕, 空白型, , 
赋值 (可否关闭, 假)


.子程序 _时钟_周期事件, 空白型, , 
赋值 (临时整数变量, 相加 (临时整数变量, 1))
.如果真 (大于或等于 (临时整数变量, 60))
    赋值 (可否关闭, 真)
    销毁 ()
.如果真结束


.子程序 _处理窗口_可否被关闭, 逻辑型, , 
.如果真 (取反 (可否关闭))
    返回 (假)
.如果真结束


.窗口程序集 用户管理窗口程序集, , , 

.程序集变量 临时用户名, 文本型, , , 
.程序集变量 临时密码, 文本型, , , 
.子程序 _按钮1_被单击, 空白型, , 
.如果真 (不等于 (.内容, .内容))
    信息框 (“两次输入密码不一样!”, #警告图标, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    返回 ()
.如果真结束
.如果真 (等于 (删首尾空 (.内容), “”))
    信息框 (“超级管理员名称不能为空!”, #警告图标, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    返回 ()
.如果真结束
赋值 (临时用户名, .内容)
赋值 (临时密码, .内容)
客户端_发送网络命令 (“改管理员密码”, 相加 (.内容, “:”, .内容), )
载入 (处理窗口, , 真)
赋值 (.内容, “”)
赋值 (.内容, “”)

.子程序 _按钮3_被单击, 空白型, , 
.如果真 (小于 (., 0))
    返回 ()
.如果真结束
.如果真 (等于 (删首尾空 (.内容), “”))
    信息框 (“用户名不能为空!”, #警告图标, )
    返回 ()
.如果真结束
客户端_发送网络命令 (“改普管资料”, 相加 (.取标题 (., 0), “:”, .内容, “:”, .内容), )
赋值 (.内容, “”)
赋值 (.内容, “”)
载入 (处理窗口, , 真)

.子程序 _用户管理窗口_创建完毕, 空白型, , 
赋值 (.内容, 用户名)
客户端_发送网络命令 (“取普管列表”, “abc”)
载入 (处理窗口, , 真)

.子程序 _按钮2_被单击, 空白型, , 
.如果真 (等于 (删首尾空 (.内容), “”))
    信息框 (“用户名不能为空!”, #警告图标, )
    返回 ()
.如果真结束
客户端_发送网络命令 (“添加管理员”, 相加 (.内容, “:”, .内容))
赋值 (.内容, “”)
赋值 (.内容, “”)
载入 (处理窗口, , 真)

.子程序 _按钮4_被单击, 空白型, , 
.如果真 (小于 (., 0))
    返回 ()
.如果真结束
.如果真 (大于 (., -1))
    .如果真 (等于 (信息框 (相加 (“您真的要删除管理员 [ ”, .取标题 (., 1), “ ] 吗?”), 相加 (#是否钮, #询问图标), “删除管理员”), #是钮))
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        客户端_发送网络命令 (“删除管理员”, .取标题 (., 0))
        载入 (处理窗口, , 真)
    .如果真结束
    
.如果真结束


.子程序 _超级列表框_当前表项被改变, 空白型, , 
赋值 (.内容, .取标题 (., 1))
赋值 (.内容, .取标题 (., 2))

.子程序 _按钮5_被单击, 空白型, , 
客户端_发送网络命令 (“取普管列表”, “abc”)
载入 (处理窗口, , 真)

.窗口程序集 地图导航窗口程序集, , , 

.子程序 _地图导航窗口_位置被改变, 空白型, , 
.移动 (相减 (取用户区宽度 (), 72), 相减 (取用户区高度 (), 105))
.移动 (相加 (.高度, 1), 相减 (取用户区宽度 (), 2), 相减 (取用户区高度 (), .高度, 1))
.移动 (相减 (取用户区宽度 (), 6), )
.移动 (相减 (.宽度, 6), 相减 (.高度, .高度, 6))
相加 (.宽度, 1).移动 (相减 (取用户区高度 (), .高度, 1))


.子程序 _图片框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 x, 整数型, , , 
.局部变量 y, 整数型, , , 
.局部变量 X范围小, 整数型, , , 
.局部变量 X范围大, 整数型, , , 
.局部变量 Y范围小, 整数型, , , 
.局部变量 Y范围大, 整数型, , , 
.局部变量 X大, 整数型, , , 
.局部变量 X小, 整数型, , , 
.局部变量 Y大, 整数型, , , 
.局部变量 Y小, 整数型, , , 
.局部变量 y坐标, 整数型, , , 
.局部变量 X坐标, 整数型, , , 
.局部变量 返回值, 整数型, , , 

赋值 (x, 横向位置)
赋值 (y, 纵向位置)
赋值 (图片框宽度, .宽度)
赋值 (图片框高度, .高度)
客户端_发送网络命令 (“查询行政区划”, 相加 (到文本 (图片框宽度), “:”, 到文本 (图片框高度), “:”, 到文本 (y), “:”, 到文本 (x)), )
.如果 (大于或等于 (地区存在标致, 1))
    赋值 (Y范围小, 到数值 (yyyyy))
    赋值 (X范围小, 到数值 (xxxxx))
    赋值 (X大, 相加 (相除 (相乘 (图片框宽度, X范围小), 846), 8))
    赋值 (X小, 相减 (相除 (相乘 (图片框宽度, X范围小), 846), 8))
    赋值 (Y大, 相加 (相除 (相乘 (图片框高度, Y范围小), 500), 8))
    赋值 (Y小, 相减 (相除 (相乘 (图片框高度, Y范围小), 500), 8))
    赋值 (.内容, 相加 (到文本 (x), “ ”, 到文本 (X大), “ ”, 到文本 (X小)))
    赋值 (.内容, 相加 (到文本 (y), “ ”, 到文本 (Y大), “ ”, 到文本 (Y小)))
    赋值 (.内容, 到文本 (x))
    赋值 (.内容, 到文本 (y))
    .如果真 (并且 (大于或等于 (x, X小), 大于或等于 (y, Y小)))
        .如果真 (并且 (小于或等于 (x, X大), 小于或等于 (y, Y大)))
            客户表头 ()
            客户端_发送网络命令 (“人口资源查询”, 地区名称变)
            赋值 (.可视, 真)
            相减 (x, 6).移动 (相减 (y, 6), , )
            0.画椭圆 (0, 16, 16)
        .如果真结束
        
    .如果真结束
    
.否则
    .如果真 (不等于 (地区存在标致, -5))
        地图导航窗口.未知支持库函数_57 (.)
        赋值 (返回值, 信息框 (相加 (“   该地区未创建连接，是否创建新连接？”, #换行符, “按 ”, #左引号, “ 是 ”, #右引号, “ 钮,创建新连接。”), 相加 (#是否钮, #信息图标), ))
        .如果 (等于 (返回值, #是钮))
            赋值 (新增横坐标, y)
            赋值 (新增纵坐标, x)
            载入 (行政区划窗口, , 假)
            信息框 (“连接创建成功！”, 0, “成功操作”)
            赋值 (.可视, 真)
            相减 (x, 6).移动 (相减 (y, 6), , )
            0.画椭圆 (0, 16, 16)
            赋值 (地区存在标致, 0)
            地图导航窗口.重画 ()
            
            
        .否则
            赋值 (地区存在标致, -5)
        .如果结束
        
    .如果真结束
    
.如果结束
 ' 画板1.可视 ＝ 假


.子程序 客户表头, 空白型, , 
赋值 (., 1)
0.未知支持库函数_9 (1, #., “门牌号”)
0.未知支持库函数_9 (2, #., “户主姓名”)
0.未知支持库函数_9 (3, #., “民族”)
0.未知支持库函数_9 (4, #., “户别”)
0.未知支持库函数_9 (5, #., “总人数”)
0.未知支持库函数_9 (6, #., “其中男”)
0.未知支持库函数_9 (7, #., “其中女”)
0.未知支持库函数_9 (8, #., “其中18-65岁”)
0.未知支持库函数_9 (9, #., “担任公职姓名”)
0.未知支持库函数_9 (10, #., “重点人口”)
0.未知支持库函数_9 (11, #., “房屋种类”)
0.未知支持库函数_9 (12, #., “电话”)
 ' 表格1.置数据 (0, 13, #表格常量.文本型, “备注”)
0.未知支持库函数_32 (20)
1.未知支持库函数_32 (40)
2.未知支持库函数_32 (60)
3.未知支持库函数_32 (40)
4.未知支持库函数_32 (40)
5.未知支持库函数_32 (40)
6.未知支持库函数_32 (40)
7.未知支持库函数_32 (40)
8.未知支持库函数_32 (80)
9.未知支持库函数_32 (90)
10.未知支持库函数_32 (60)
11.未知支持库函数_32 (60)
12.未知支持库函数_32 (60)
 ' 表格1.置列宽 (13, 180)
0.未知支持库函数_18 (0, 0, ., 12)

.子程序 _地图导航窗口_创建完毕, 空白型, , 
MDI窗口调整 (地图导航窗口)


.子程序 _保存到EXCEL_被单击, 空白型, , 
保存至excel (地图导航窗口., _启动窗口., _启动窗口., _启动窗口.)
地图导航窗口.重画 ()

.子程序 _打印预览_被单击, 空白型, , 
“行政人口查询信息表”.未知支持库函数_46 (“黑体”, 18, 真, 2)
未知支持库函数_27 ()


.窗口程序集 行政区划窗口程序集, , , 

.子程序 _按钮1_被单击, 空白型, , 
打开 ()
赋值 (.内容, .文件名)

.子程序 _行政区划窗口_创建完毕, 空白型, , 
赋值 (.内容, 到文本 (新增横坐标))
赋值 (.内容, 到文本 (新增纵坐标))
客户端_发送网络命令 (“取普管列表_行政”, “abc”)
 ' 载入 (处理窗口, , 真)


.子程序 _按钮新增_被单击, 空白型, , 
客户端_发送网络命令 (“行政区划_增加”, 相加 (.内容, “:”, .内容, “:”, .内容, “:”, .内容, “:”, .内容, “:”, .内容))

 ' 载入 (处理窗口, , 真)

.子程序 _按钮5_被单击, 空白型, , 
客户端_发送网络命令 (“取普管列表_行政”, “abc”)

.窗口程序集 行政分类查询窗口程序集, , , 

.子程序 _行政分类查询窗口_创建完毕, 空白型, , 
读树型框项目 ()
客户表头列表 ()
MDI窗口调整 (行政分类查询窗口)


.子程序 读树型框项目, 空白型, , 
.局部变量 索引, 整数型, , , 
.局部变量 文本读, 文本型, , , 
.局部变量 文本读A, 文本型, , , 
.局部变量 文本读B, 文本型, , , 
.局部变量 文本读C, 文本型, , , 
.局部变量 计次变量, 整数型, , , 

行政分类查询窗口.清空 (.)
.如果真 (取反 (相加 (取运行目录 (), “\MainDB.mdb”).未知支持库函数_1 (“”)))
    信息框 (“无法连接数据库,请检测数据库是否存在!”, #错误图标, “”)
.如果真结束
行政分类查询窗口.未知支持库函数_12 (., )
行政分类查询窗口.未知支持库函数_14 (., “Select * From 行政区划”, #)
行政分类查询窗口.未知支持库函数_34 (.)
赋值 (索引, 0)
.判断循环首 (等于 (., 假))
    赋值 (计次变量, 0)
    “父地区编码”.未知支持库函数_26 (文本读B)
    .如果 (不等于 (取整 (到数值 (文本读B)), -1))
        .计次循环首 (取项目数 (), )
            .如果 (等于 (取整 (到数值 (文本读B)), 相减 (计次变量, 1).取项目数值 ()))
                赋值 (索引, 相减 (计次变量, 1))
                跳出循环 ()
                
            .否则
                
            .如果结束
            赋值 (计次变量, 相加 (计次变量, 1))
        .计次循环尾 ()
        “地区名称”.未知支持库函数_26 (文本读A)
        “地区编码”.未知支持库函数_26 (文本读)
        索引.加入项目 (文本读A, 0, 1, 到数值 (文本读))
        
    .否则
        
        “地区名称”.未知支持库函数_26 (文本读A)
        “地区编码”.未知支持库函数_26 (文本读)
        -1.加入项目 (文本读A, 0, 1, 到数值 (文本读))
        
    .如果结束
    行政分类查询窗口.未知支持库函数_36 (.)
.判断循环尾 ()
.计次循环首 (取项目数 (), 计次)
    相减 (计次, 1).扩展 ()
.计次循环尾 ()
关闭 ()
赋值 (.最大化按钮, 1)
获取焦点 ()


.子程序 _行政分类查询窗口_尺寸被改变, 空白型, , 
赋值 (.高度, 相减 (行政分类查询窗口., .可视, .高度, .高度, 5))
赋值 (., 相减 (取用户区高度 (), .可视, .高度, 4))
赋值 (., 相减 (取用户区宽度 (), .宽度, 5))
赋值 (.宽度, 相减 (行政分类查询窗口.取用户区宽度 (), 4))
赋值 (.顶边, 相减 (行政分类查询窗口.取用户区高度 (), .高度, 5))
赋值 (.左边, 相减 (.宽度, .宽度, 30))


.子程序 客户表头列表, 空白型, , 
赋值 (., 1)
赋值 (., 12)
0.未知支持库函数_9 (1, #., “门牌号”)
0.未知支持库函数_9 (2, #., “户主姓名”)
0.未知支持库函数_9 (3, #., “民族”)
0.未知支持库函数_9 (4, #., “户别”)
0.未知支持库函数_9 (5, #., “总人数”)
0.未知支持库函数_9 (6, #., “其中男”)
0.未知支持库函数_9 (7, #., “其中女”)
0.未知支持库函数_9 (8, #., “其中18-65岁”)
0.未知支持库函数_9 (9, #., “担任公职姓名”)
0.未知支持库函数_9 (10, #., “重点人口”)
0.未知支持库函数_9 (11, #., “房屋种类”)
0.未知支持库函数_9 (12, #., “电话”)
 ' 表格1.置数据 (0, 13, #表格常量.文本型, “备注”)
0.未知支持库函数_32 (30)
1.未知支持库函数_32 (50)
2.未知支持库函数_32 (70)
3.未知支持库函数_32 (50)
4.未知支持库函数_32 (50)
5.未知支持库函数_32 (50)
6.未知支持库函数_32 (50)
7.未知支持库函数_32 (50)
8.未知支持库函数_32 (90)
9.未知支持库函数_32 (100)
10.未知支持库函数_32 (70)
11.未知支持库函数_32 (70)
12.未知支持库函数_32 (70)
 ' 表格1.置列宽 (13, 180)
0.未知支持库函数_18 (0, 0, ., 12)


.子程序 _树型框1_双击项目, 空白型, , 
赋值 (地区名称变, 到文本 (.取项目数值 (.最大化按钮)))
 ' 信息框 (地区名称变, 0, “”)
未知支持库函数_57 ()
赋值 (., 2)
客户表头列表 ()
客户端_发送网络命令 (“行政资源查询”, 地区名称变)


.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.判断开始 (等于 (按钮索引, 1))
     ' 信息框 (“1”, 0, “”)
.判断 (等于 (按钮索引, 2))
     ' 信息框 (“2”, 0, “”)
.判断 (等于 (按钮索引, 3))
     ' 信息框 (“3”, 0, “”)
.判断 (等于 (按钮索引, 4))
     ' 信息框 (“4”, 0, “”)
.判断 (等于 (按钮索引, 6))
     ' 信息框 (“6”, 0, “”)
.判断 (等于 (按钮索引, 5))
    “行政人口查询信息表”.未知支持库函数_46 (“黑体”, 18, 真, 2)
    未知支持库函数_27 ()
.判断 (等于 (按钮索引, 8))
     ' 信息框 (“7”, 0, “”)
    保存至excel (行政分类查询窗口., _启动窗口., _启动窗口., _启动窗口.)
.默认
    
.判断结束


.程序集 功能子程序集, , , 

.子程序 MDI窗口调整, 空白型, , 
.参数 MDI子窗口, 窗口, , 

置父窗口 (MDI子窗口.取窗口句柄 (), _启动窗口.取窗口句柄 (.))
加入成员 (窗口, MDI子窗口)
MDI子窗口.移动 (0, 0, _启动窗口.取用户区宽度 (.), _启动窗口.取用户区高度 (.))
_启动窗口.置文本 (., 5, MDI子窗口.标题)
.如果真 (等于 (取数组成员数 (窗口), 2))
    窗口.销毁 ( [1])
    删除成员 (窗口, 1, 1)
.如果真结束
全部关闭 ()


.子程序 保存至excel, 空白型, 公开, 
.参数 高级表格, 未知类型0x70001, , 
.参数 EXCEL程序, 未知类型0x90001, , 
.参数 Excel工作簿, 未知类型0x90002, , 
.参数 通用对话框, 通用对话框, , 

.局部变量 文件名, 文本型, , , 
.局部变量 x, 空白型, , , 
.局部变量 y, 空白型, , , 
.局部变量 文本, 文本型, , , 

赋值 (通用对话框.类型, 1)
赋值 (通用对话框.过滤器, “EXCEL文件|*.xls”)
赋值 (通用对话框.默认文件后缀, “.xls”)
.如果真 (等于 (通用对话框.打开 (), 假))
    返回 ()
.如果真结束
赋值 (文件名, 通用对话框.文件名)
EXCEL程序.未知支持库函数_0 ()
赋值 (EXCEL程序., 假)
Excel工作簿.未知支持库函数_6 (EXCEL程序)
赋值 (Excel工作簿., 1)
Excel工作簿.激活 ()
.计次循环首 (高级表格., x)
    .计次循环首 (高级表格., y)
        赋值 (文本, 字符 (相加 (96, y)))
        赋值 (Excel工作簿., 相加 (文本, 到文本 (x)))
        赋值 (Excel工作簿., 相加 (文本, 到文本 (x)))
        赋值 (Excel工作簿., 高级表格.未知支持库函数_10 (相减 (x, 1), 相减 (y, 1)))
    .计次循环尾 ()
.计次循环尾 ()
Excel工作簿.未知支持库函数_16 (文件名)
信息框 (“保存成功”, 0, “操作提示”)
Excel工作簿.未知支持库函数_7 ()
Excel工作簿.未知支持库函数_15 ()
Excel工作簿.未知支持库函数_7 ()
EXCEL程序.未知支持库函数_3 ()
未知支持库函数_11 (“Excel.exe”)


.子程序 取文件名, 文本型, , 取文件名(路径文件名)
.参数 路径文件名, 文本型, , 写入文件完整地址，取得文件名

返回 (取文本右边 (路径文件名, 相减 (取文本长度 (路径文件名), 倒找文本 (路径文件名, “\”, , 假))))

.窗口程序集 启动窗口程序集, , , 

.程序集变量 用户临时记录, 文本型, , , 临时记录连接的用户信息
.程序集变量 在线用户列表, 文本型, , "0", 
.程序集变量 在线用户名称列表, 文本型, , "0", 
.程序集变量 当前客户端地址, 文本型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
客户端_发送网络命令 (“取用户列表”, )
_用户登陆_被选择 ()
未知支持库函数_0 (#)
赋值 (.图片, #主窗口图片)
赋值 (.内容, “公安局人口管理系统”) ' 这里更换检查院名称
赋值 (地区存在标致, -5)
1.置文本 (时间到文本 (取现行时间 (), ))
3.置文本 (当前用户名)


.子程序 __启动窗口_位置被改变, 空白型, , 
 ' 图片框1.移动 (, , 取用户区宽度 (), 取用户区高度 () － 20)
.移动 (相加 (.选中, 取用户区高度 (), 1), , 相减 (取用户区高度 (), .可视, ., 4))
相除 (相减 (取用户区宽度 (), .宽度, .), 2).移动 (相减 (取用户区高度 (), 180), , )


.子程序 __启动窗口_尺寸被改变, 空白型, , 
赋值 (.宽度, 相减 (_启动窗口.取用户区宽度 (), ., 1))
赋值 (.高度, 相减 (_启动窗口.取用户区高度 (), .可视, .))
赋值 (., 56)
赋值 (., .高度)
5.置宽度 (相减 (_启动窗口.取用户区宽度 (), 0.取宽度 (), 1.取宽度 (), 2.取宽度 (), 3.取宽度 (), 4.取宽度 (), 10))


.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.判断开始 (等于 (按钮索引, 2))
    载入 (地图导航窗口, _启动窗口, 假)
.判断 (等于 (按钮索引, 4))
    载入 (行政分类查询窗口, _启动窗口, 假)
.默认
    
.判断结束


.子程序 _档案浏览_被选择, 空白型, , 
载入 (行政分类查询窗口, _启动窗口, 假)


.子程序 _卷帘式菜单1_项目被选择, 空白型, , 
.参数 菜单索引, 整数型, , 
.参数 项目索引, 整数型, , 

.判断开始 (等于 (菜单索引, 0))
    .判断开始 (等于 (项目索引, 0))
        载入 (地图导航窗口, _启动窗口, 假)
    .判断 (等于 (项目索引, 2))
        载入 (行政分类查询窗口, _启动窗口, 假)
    .默认
        
    .判断结束
    
.默认
    
.判断结束


.子程序 资料_取用户名, 文本型, , 
.局部变量 临时文本容器, 文本型, , "0", 

.如果 (资料_检测用户资料 (读系统配置 (“用户资料”)))
    赋值 (临时文本容器, 分割文本 (读系统配置 (“用户资料”), “$$$%%%^^^&&&***!”, ))
    返回 (临时文本容器 [1])
.否则
    返回 (“ ”)
.如果结束


.子程序 写系统配置, 逻辑型, , 
.参数 写入的配置名, 文本型, , 
.参数 写入值, 文本型, , 

返回 (写配置项 (相加 (取运行目录 (), “\Config.ini”), “系统配置”, 写入的配置名, 写入值))

.子程序 _客户_数据到达, 空白型, , 
客户端_处理数据 (取回数据 ())

.子程序 资料_检测用户资料, 逻辑型, , 用户资料可以使用则返回[真],否则返回[假]
.参数 用户资料, 文本型, , 

.如果 (并且 (小于 (寻找文本 (用户资料, “:”, 1, 真), 1), 小于 (寻找文本 (用户资料, “@”, 1, 真), 1), 大于 (寻找文本 (用户资料, “$$$%%%^^^&&&***!”, , 假), 0)))
    返回 (真)
.否则
    返回 (假)
.如果结束


.子程序 全文本替换, 文本型, , 
.参数 具体文本, 文本型, , 
.参数 要替换的文本, 文本型, , 
.参数 被替换的文本, 文本型, , 

.局部变量 a, 文本型, , , 
.局部变量 b, 整数型, , , 

赋值 (a, 具体文本)
.判断循环首 (大于 (寻找文本 (a, 要替换的文本, b, 真), -1))
    赋值 (b, 寻找文本 (a, 要替换的文本, b, 真))
    赋值 (a, 文本替换 (a, b, 取文本长度 (要替换的文本), 被替换的文本))
    赋值 (b, 相加 (b, 取文本长度 (被替换的文本)))
.判断循环尾 ()
返回 (a)

.子程序 读系统配置, 文本型, , 
.参数 读取的配置名, 文本型, , 
.参数 默认值, 文本型, 可空, 

返回 (读配置项 (相加 (取运行目录 (), “\Config.ini”), “系统配置”, 读取的配置名, 默认值))

.子程序 _用户退出_被选择, 空白型, , 
结束 ()

.子程序 _用户管理_被选择, 空白型, , 
载入 (用户管理窗口, , 真)

.子程序 _地图导航_被选择, 空白型, , 
载入 (地图导航窗口, _启动窗口, 假)

.子程序 _用户登陆_被选择, 空白型, , 
赋值 (_启动窗口., 假)
载入 (登陆窗口, , 假)



 ' 不属于任何一个程序集、类模块的函数：
