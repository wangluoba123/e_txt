 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 窗口_回收站
    左边 = 50
    顶边 = 50
    宽度 = 166
    高度 = 162
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “☆夜未眠☆ 专用 回收站”
    帮助文件名 = “”



.图片 炫酷黑_空, " ' 已保存到：D:\易语言学习\Data\超酷回收站.e\炫酷黑_空", , 
.图片 炫酷黑_满, " ' 已保存到：D:\易语言学习\Data\超酷回收站.e\炫酷黑_满", , 
.图片 , , , 
.图片 骷髅头_空, " ' 已保存到：D:\易语言学习\Data\超酷回收站.e\骷髅头_空", , 
.图片 骷髅头_满, " ' 已保存到：D:\易语言学习\Data\超酷回收站.e\骷髅头_满", , 
.图片 , , , 
.图片 美少女_空, " ' 已保存到：D:\易语言学习\Data\超酷回收站.e\美少女_空", , 
.图片 美少女_满, " ' 已保存到：D:\易语言学习\Data\超酷回收站.e\美少女_满", , 
.图片 , , , 
.图片 图标, " ' 已保存到：D:\易语言学习\Data\超酷回收站.e\图标", , 
.常量 GWL_WNDPROC, "-4", 隐藏, 
.常量 WM_GETMINMAXINFO, "36", 隐藏, 此消息发送给窗口当它将要改变大小或位置；
.常量 WM_MOUSEMOVE, "512", 隐藏, 
.常量 WM_NCMOUSEMOVE, "160", 隐藏, 
.常量 WM_EXITSIZEMOVE, "562", 隐藏, 
.常量 WM_MOVING, "534", 隐藏, 
.常量 WM_MOVE, "3", 隐藏, 
.常量 WM_NCHITTEST, "132", 隐藏, 
.常量 WM_NCLBUTTONDOWN, "161", 隐藏, 
.常量 WM_NCLBUTTONUP, "162", 隐藏, 
.常量 WM_SIZE, "5", 隐藏, 
.常量 WM_SIZING, "532", 隐藏, 
.常量 WM_SYSCOMMAND, "274", 隐藏, 
.常量 WM_KEYUP, "257", 隐藏, 
.常量 WM_KEYDOWN, "256", 隐藏, 
.常量 WM_TASKBARCREATED, "49281", 隐藏, 任务栏创建完毕
.常量 WM_QUERYENDSESSION, "17", 隐藏, 当用户选择结束对话框或程序自己调用ExitWindows函数
.常量 WM_DISPLAYCHANGE, "126", 隐藏, 当显示器的分辨率改变后发送此消息给所有的窗口
.常量 SHERB_NOCONFIRMATION, "1", 公开, 不显示确认
.常量 SHERB_NOPROGRESSUI, "2", 公开, 不显示删除进度
.常量 SHERB_NOSOUND, "4", 公开, 无声


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' shell 52F260023059454187AF826A3C07AF2A 3 0 操作系统界面功能支持库
 ' edroptarget {9DA96BF9CEBD45c5BFCF94CBE61671F5} 2 0 拖放支持库
 ' iext5 {E5000198-4471-40e2-92BC-D0BA075BDBB2} 2 0 扩展界面支持库五
 ' spec A512548E76954B6E92C21055517615B0 3 0 特殊功能支持库



 ' 所需要的模块
 ' 彗星真彩控件 $彗星真彩控件模块.ec
 ' 窗口常用操作模块[B_night] D:\Program Files\编程开发\易语言\ecom\窗口常用操作模块[B_night].ec


数据类型 坐标_, 公开, 坐标;POINTAPI
    .成员 横向位置, 整数型, , , X坐标
    .成员 纵向位置, 整数型, , , Y坐标

数据类型 矩形_, 公开, RECT
    .成员 左边, 整数型, , , Left
    .成员 顶边, 整数型, , , Top
    .成员 右边, 整数型, , , Right
    .成员 底边, 整数型, , , Bottom

数据类型 回收站信息_, 公开, SHQUERYRBINFO
    .成员 结构大小, 整数型, , , cbSize
    .成员 尺寸大小低64位, 整数型, , , i64Size_LowPart
    .成员 尺寸大小高64位, 整数型, , , i64Size_HighPart
    .成员 条目数量低64位, 整数型, , , i64NumItems_LowPart
    .成员 条目数量高64位, 整数型, , , i64NumItems_HighPart

.全局变量 任务栏信息, 矩形_, 公开, , 通过子程序取任务栏信息获取到的任务栏的矩形区域

.DLL命令 实时拖动窗口_, 空白型, "user32.dll", "SystemParametersInfoA", , ★实时拖动窗口，不显示虚线框★
    .参数 uParam, 整数型, , 默认为37
    .参数 uAction, 整数型, , 值为1时启用实时拖动(放到窗口被激活)，值为0时取消实时拖动(放到窗口被取消激活)。
    .参数 lpvParam, 整数型, , 默认为0
    .参数 fuWinIni, 整数型, , 默认为0

.DLL命令 设置窗口信息_, 子程序指针, "user32", "SetWindowLongA", 公开, 在窗口结构中为指定的窗口设置信息  指定数据的前一个值
    .参数 窗口句柄, 整数型, , hwnd，欲为其取得信息的窗口的句柄
    .参数 窗口信息值, 整数型, , nIndex，请参考GetWindowLong函数的nIndex参数的说明
    .参数 窗口信息新值, 子程序指针, , dwNewLong，由nIndex指定的窗口信息的新值

.DLL命令 呼叫窗口函数地址_, 整数型, "user32.dll", "CallWindowProcA", 公开, CallWindowProcA将消息传答窗口函数　
    .参数 前一窗口函数地址, 子程序指针, , lpPrevWndFunc
    .参数 窗口句柄, 整数型, , hwnd
    .参数 消息值, 整数型, , msg
    .参数 附加参数1, 整数型, , wParam
    .参数 附加参数2, 整数型, , lParam

.DLL命令 取鼠标位置_, 整数型, "user32", "GetCursorPos", 公开, GetCursorPos
    .参数 位置, 坐标_, , 

.DLL命令 取窗口矩形_, 整数型, "user32", "GetWindowRect", 公开, GetWindowRect
    .参数 窗口句柄, 整数型, , 
    .参数 矩形区域, 矩形_, , 

.DLL命令 是否在矩形内_, 整数型, "user32", "PtInRect", 公开, PtInRect这个函数判断指定的点是否位于矩形lpRect内部
    .参数 lpRect, 矩形_, 传址, 
    .参数 x坐标, 整数型, , 
    .参数 y坐标, 整数型, , 

.DLL命令 复制内存_, 空白型, "kernel32.dll", "RtlMoveMemory", 公开, CopyMemory
    .参数 pDest, 整数型, , 
    .参数 pSrc, 未知类型0x4101130A, , 
    .参数 ByteLen, 字节型, , 

.DLL命令 复制内存1_, 空白型, "kernel32.dll", "RtlMoveMemory", 公开, CopyMemory1　
    .参数 pDest, 未知类型0x4101130A, , 
    .参数 pSrc, 整数型, , 
    .参数 ByteLen, 字节型, , 

.DLL命令 设置时钟_, 整数型, "user32.dll", "SetTimer", 公开, SetTimer
    .参数 窗口句柄, 整数型, , hwnd
    .参数 事件标识符, 整数型, , nIDEvent
    .参数 时钟周期, 整数型, , uElapse
    .参数 回调函数地址, 整数型, , lpTimerFunc

.DLL命令 销毁时钟_, 整数型, "user32.dll", "KillTimer", 公开, KillTimer
    .参数 窗口句柄, 整数型, , hwnd
    .参数 事件标识符, 整数型, , nIDEvent

.DLL命令 内存清零_, 空白型, "kernel32.dll", "RtlZeroMemory", 公开, ZeroMemory将一块内存置零
    .参数 目的内存, 未知类型0x4101130A, 传址, Destination
    .参数 长度, 整数型, , Length

.DLL命令 寻找顶级窗口_, 整数型, "user32.dll", "FindWindowA", 公开, FindWindow,寻找窗口列表中第一个符合指定条件的顶级窗口
    .参数 窗口类名, 文本型, , lpClassName，参见相关帮助，没有填 字符 (0)
    .参数 窗口文本, 文本型, , lpWindowName，参见相关帮助 ，没有填 字符 (0)

.DLL命令 寻找子窗口_, 整数型, "user32", "FindWindowExA", 公开, 在窗口列表中寻找与指定条件相符的第一个子窗口  找到的窗口的句柄。如未找到相符窗口，则返回零。会设置GetLastError
    .参数 窗口句柄1, 整数型, , 在其中查找子的父窗口。如设为零，表示使用桌面窗口（通常说的顶级窗口都被认为是桌面的子窗口，所以也会对它们进行查找）
    .参数 窗口句柄2, 整数型, , 从这个窗口后开始查找。这样便可利用对FindWindowEx的多次调用找到符合条件的所有子窗口。如设为零，表示从第一个子窗口开始搜索
    .参数 欲搜索的类名1, 文本型, , 欲搜索的类名。“”表示忽略 ，没有填 字符 (0)
    .参数 欲搜索的类名2, 文本型, , 欲搜索的类名。“”表示忽略 ，没有填 字符 (0)

.DLL命令 注册窗口消息_, 整数型, "", "RegisterWindowMessageA", 公开, 注册一个指定的消息字符串，返回消息值。
    .参数 lpString, 文本型, , 如:“TaskbarCreated”任务栏创建完毕

.DLL命令 清空回收站_, 整数型, "shell32.dll", "SHEmptyRecycleBinA", 公开, SHEmptyRecycleBin
    .参数 窗口句柄, 整数型, , hwnd
    .参数 根路径, 文本型, , pszRootPath
    .参数 标志, 整数型, , dwFlags

.DLL命令 更新回收站图标_, 整数型, "shell32.dll", "SHUpdateRecycleBinIcon", 公开, SHUpdateRecycleBinIcon

.DLL命令 回收站询问_, 整数型, "shell32.dll", "SHQueryRecycleBinA", 公开, SHQueryRecycleBin
    .参数 根路径, 文本型, , pszRootPath
    .参数 回收站询问信息, 回收站信息_, , pSHQueryRBInfo

.类模块 真彩图片框, , , By:(彬)泪闯天涯

.子程序 置提示文本, 空白型, , 
.参数 提示文本内容, 文本型, , 
.参数 跟随鼠标, 逻辑型, 可空, 



.子程序 移动, 空白型, , 英文名称：move,改变窗口或窗口组件的位置或尺寸。
.参数 左边, 整数型, 可空, 单位为像素点。如被省略则不改变左边原位置。
.参数 顶边, 整数型, 可空, 单位为像素点。如被省略则不改变顶边原位置。
.参数 宽度, 整数型, 可空, 单位为像素点。如被省略则不改变宽度原位置。
.参数 高度, 整数型, 可空, 单位为像素点。如被省略则不改变高度原位置。
.参数 禁止重绘, 逻辑型, 可空, 



.子程序 取窗口句柄, 整数型, , 


.子程序 是否已创建, 逻辑型, , 


.子程序 重画, 空白型, , 英文名称：invalidate,通知 Windows 系统本窗口或窗口组件上的显示内容需要在以后被全部重画。本命令为初级对象成员命令。


.子程序 发送消息, 整数型, , 
.参数 wMsg, 整数型, , 消息的标识符
.参数 wParam, 整数型, , 具体取决于消息
.参数 lParam, 整数型, , 具体取决于消息;



.子程序 创建, 整数型, , 动态创建一个“真彩图片框”控件，创建成功返回窗口句柄，失败返回0
.参数 父窗口句柄, 整数型, , 
.参数 左边, 整数型, , 
.参数 顶边, 整数型, , 
.参数 宽度, 整数型, , 
.参数 高度, 整数型, , 



.子程序 从句柄创建, 空白型, , 从现有控件创建一个“真彩图片框”
.参数 窗口句柄, 整数型, , 
.参数 图片句柄, 整数型, 可空, 可通过“真彩控件_载入图片”或“真彩控件_载入内存图片”取得图片句柄



.子程序 置图片, 空白型, , 
.参数 图片句柄, 整数型, 可空, 



.子程序 置图片数据, 空白型, , 
.参数 图片字节集, 字节集, , 



.子程序 置显示方式, 空白型, , 指定图片框上图片的显示方式。0.图片居左上,1.缩放图片,2.图片居中
.参数 显示方式, 整数型, , 0.图片居左上,1.缩放图片,2.图片居中



.类模块 真彩按钮, , , By:(彬)泪闯天涯

.子程序 置提示文本, 空白型, , 
.参数 提示文本内容, 文本型, , 
.参数 跟随鼠标, 逻辑型, 可空, 



.子程序 移动, 空白型, , 英文名称：move,改变窗口或窗口组件的位置或尺寸。
.参数 左边, 整数型, 可空, 单位为像素点。如被省略则不改变左边原位置。
.参数 顶边, 整数型, 可空, 单位为像素点。如被省略则不改变顶边原位置。
.参数 宽度, 整数型, 可空, 单位为像素点。如被省略则不改变宽度原位置。
.参数 高度, 整数型, 可空, 单位为像素点。如被省略则不改变高度原位置。
.参数 禁止重绘, 逻辑型, 可空, 



.子程序 取窗口句柄, 整数型, , 


.子程序 是否已创建, 逻辑型, , 


.子程序 重画, 空白型, , 英文名称：invalidate,通知 Windows 系统本窗口或窗口组件上的显示内容需要在以后被全部重画。本命令为初级对象成员命令。


.子程序 发送消息, 整数型, , 
.参数 wMsg, 整数型, , 消息的标识符
.参数 wParam, 整数型, , 具体取决于消息
.参数 lParam, 整数型, , 具体取决于消息;



.子程序 创建, 整数型, , 动态创建一个“真彩按钮”控件，创建成功返回窗口句柄，失败返回0
.参数 父窗口句柄, 整数型, , 
.参数 左边, 整数型, , 
.参数 顶边, 整数型, , 
.参数 宽度, 整数型, , 
.参数 高度, 整数型, , 
.参数 标题, 文本型, 可空, 



.子程序 从句柄创建, 空白型, , 从现有控件创建一个“真彩按钮”
.参数 窗口句柄, 整数型, , 
.参数 图片句柄, 整数型, 可空, 设置按钮默认状态下的图片句柄，可通过“真彩控件_载入图片”或“真彩控件_载入内存图片”取得图片句柄



.子程序 置图片, 空白型, , 
.参数 正常图片, 整数型, 可空, 
.参数 点燃图片, 整数型, 可空, 
.参数 按下图片, 整数型, 可空, 
.参数 禁止图片, 整数型, 可空, 



.子程序 置图片数据, 空白型, , 
.参数 正常图片, 字节集, 可空, 
.参数 点燃图片, 字节集, 可空, 
.参数 按下图片, 字节集, 可空, 
.参数 禁止图片, 字节集, 可空, 



.子程序 置显示方式, 空白型, , 指定按钮图片的显示方式。0.图片居左上,1.缩放图片,2.图片居中
.参数 显示方式, 整数型, , 0.图片居左上,1.缩放图片,2.图片居中



.类模块 真彩窗口, , , By:(彬)泪闯天涯

.子程序 从句柄创建, 逻辑型, , 
.参数 窗口句柄, 整数型, , 



.子程序 置图片, 逻辑型, , 设置一个PNG图片当窗口外形，支持透明通道。注意：设置之后子控件将无法显示
.参数 图片句柄, 整数型, , 可通过“真彩控件_载入图片”或“真彩控件_载入内存图片”取得图片句柄



.子程序 置图片数据, 逻辑型, , 
.参数 图片字节集, 字节集, , 



.子程序 刷新子控件, 空白型, , 


.子程序 移动, 空白型, , 英文名称：move,改变窗口或窗口组件的位置或尺寸。
.参数 左边, 整数型, 可空, 单位为像素点。如被省略则不改变左边原位置。
.参数 顶边, 整数型, 可空, 单位为像素点。如被省略则不改变顶边原位置。
.参数 宽度, 整数型, 可空, 单位为像素点。如被省略则不改变宽度原位置。
.参数 高度, 整数型, 可空, 单位为像素点。如被省略则不改变高度原位置。
.参数 禁止重绘, 逻辑型, 可空, 



.子程序 取窗口句柄, 整数型, , 


.子程序 是否已创建, 逻辑型, , 


.子程序 发送消息, 整数型, , 
.参数 wMsg, 整数型, , 消息的标识符
.参数 wParam, 整数型, , 具体取决于消息
.参数 lParam, 整数型, , 具体取决于消息;



.类模块 真彩编辑框, , , 暂时只支持单行文本。By:(彬)泪闯天涯

.子程序 置提示文本, 空白型, , 
.参数 提示文本内容, 文本型, , 
.参数 跟随鼠标, 逻辑型, 可空, 



.子程序 移动, 空白型, , 英文名称：move,改变窗口或窗口组件的位置或尺寸。
.参数 左边, 整数型, 可空, 单位为像素点。如被省略则不改变左边原位置。
.参数 顶边, 整数型, 可空, 单位为像素点。如被省略则不改变顶边原位置。
.参数 宽度, 整数型, 可空, 单位为像素点。如被省略则不改变宽度原位置。
.参数 高度, 整数型, 可空, 单位为像素点。如被省略则不改变高度原位置。
.参数 禁止重绘, 逻辑型, 可空, 



.子程序 取窗口句柄, 整数型, , 


.子程序 是否已创建, 逻辑型, , 


.子程序 重画, 空白型, , 英文名称：invalidate,通知 Windows 系统本窗口或窗口组件上的显示内容需要在以后被全部重画。本命令为初级对象成员命令。


.子程序 发送消息, 整数型, , 
.参数 wMsg, 整数型, , 消息的标识符
.参数 wParam, 整数型, , 具体取决于消息
.参数 lParam, 整数型, , 具体取决于消息;



.子程序 从句柄创建, 空白型, , 从现有控件创建一个“真彩按钮”
.参数 窗口句柄, 整数型, , 



.子程序 置背景颜色, 空白型, , 
.参数 背景颜色, 整数型, , -1为透明背景，否则为RGB颜色值
.参数 背景透明度, 整数型, 可空, 0-255



.子程序 置边框颜色, 空白型, , 
.参数 边框颜色, 整数型, , -1为透明边框，否则为RGB颜色值
.参数 边框透明度, 整数型, 可空, 0-255



.子程序 置文本颜色, 空白型, , 
.参数 文本颜色, 整数型, , RGB颜色值



.子程序 置背景图片, 空白型, , 
.参数 图片句柄, 整数型, 可空, 



.子程序 置背景图片数据, 空白型, , 
.参数 图片字节集, 字节集, , 



.子程序 置底图方式, 空白型, , 指定图片框上图片的显示方式。0.图片居左上,1.缩放图片,2.图片居中
.参数 底图方式, 整数型, , 0.图片居左上,1.缩放图片,2.图片居中



.子程序 取内容, 文本型, , 


.类模块 真彩动画窗口, , , 

.子程序 创建, 逻辑型, , 
.参数 图片数据, 字节集, 可空, 用来当背景的图片，支持动态GIF、PNG、JPG、BMP，支持背景透明
.参数 父窗口句柄, 整数型, 可空, 参数值指定欲载入窗口的父窗口，父窗口必须已经被创建。如果本参数被省略，表示无父窗口。如果窗口具有父窗口，其位置将永远位于父窗口的上面；当父窗口被关闭时，窗口将自动被关闭。
.参数 窗口位置, 整数型, 可空, 0.相对屏幕居中,1.相对桌面工作区域居中, 2.相对父窗口居中



.子程序 销毁, 空白型, , 


.子程序 取宽度, 整数型, , 


.子程序 取高度, 整数型, , 


.子程序 取窗口句柄, 整数型, , 


.子程序 是否已创建, 逻辑型, , 


.子程序 移动, 空白型, , 英文名称：move,改变窗口或窗口组件的位置或尺寸。
.参数 左边, 整数型, 可空, 单位为像素点。如被省略则不改变左边原位置。
.参数 顶边, 整数型, 可空, 单位为像素点。如被省略则不改变顶边原位置。
.参数 宽度, 整数型, 可空, 单位为像素点。如被省略则不改变宽度原位置。
.参数 高度, 整数型, 可空, 单位为像素点。如被省略则不改变高度原位置。
.参数 禁止重绘, 逻辑型, 可空, 



.子程序 居中显示, 空白型, , 移动窗口，相对于屏幕或桌面、父窗口居中显示
.参数 相对位置, 整数型, , 0.相对屏幕居中,1.相对桌面工作区域居中, 2.相对父窗口居中



.子程序 取窗口尺寸, 空白型, , 取窗口的宽度和高度
.参数 宽度, 整数型, 参考, 
.参数 高度, 整数型, 参考, 



.子程序 随意移动, 逻辑型, , 英文名称为“HitMove”,当用户在窗口上任何位置按下鼠标左键后是否进入窗口整体移动模式。
.参数 是否随意移动, 逻辑型, 可空, 



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 真彩控件_载入图片, 整数型, , 载入指定图片，成功返回图片句柄，失败返回0
.参数 欲被载入的图片, 文本型, , 图片文件名



.子程序 真彩控件_载入内存图片, 整数型, , 载入指定图片，成功返回图片句柄，失败返回0
.参数 欲被载入的图片, 字节集, , 图片数据



.子程序 真彩控件_销毁图片, 空白型, , 
.参数 图片句柄, 整数型, , 



.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 
载入 (窗口_回收站, , 真)
返回 (0)

.窗口程序集 窗口_回收站程序集, , , 

.程序集变量 真彩窗口, 真彩窗口, , , 
.程序集变量 匿名程序集变量_4683, 空白型, , , 
.程序集变量 回收站_空, 字节集, , , 
.程序集变量 回收站_满, 字节集, , , 
.程序集变量 匿名程序集变量_4686, 空白型, , , 
.程序集变量 回收站_状态, 整数型, , , 
.程序集变量 回收站_文件数量, 整数型, , , 
.程序集变量 回收站_尺寸, 双精度小数型, , , 
.程序集变量 匿名程序集变量_4690, 空白型, , , 
.程序集变量 鼠标移入, 逻辑型, , , 
.程序集变量 开始记录拖到, 逻辑型, , , 解决首次启动就出现实体拖动窗体的问题
.程序集变量 匿名程序集变量_4693, 空白型, , , 
.程序集变量 窗口句柄, 整数型, , , 回收站的窗口句柄
.程序集变量 线程句柄, 空白型, , , 
.子程序 _窗口_回收站_创建完毕, 空白型, , 
真彩窗口.未知函数_67179116 (取窗口句柄 ())
赋值 (窗口句柄, 真彩窗口.未知函数_67179117 ())
 ' 真彩窗口.移动 (取屏幕宽度 () － 256, , 256, 256, )
 ' 真彩窗口.置图片 ()
 ' 允许拖放 (真彩窗口.取窗口句柄 (), &拖放回调函数)
_初始化窗口调整 (窗口_回收站, )
监控屏幕分辨率变化 (&屏幕分辨率被改变)
监控系统关机请求 (&系统关机请求)
开启窗口位置限制 ()
取窗口句柄 ().未知支持库函数_0 ()
 ' _启动窗口.显示回收站 ＝ 真
调整层次 (2)
 ' 写配置项 (用户文件名, “全局设置”, “显示回收站”, “真”)
 ' 窗口位置和大小读取 (窗口_回收站, 用户文件名, “回收站窗口”)
_美女啊_被选择 ()
_标准尺寸_被选择 ()
 ' ----------------------------------------------------------------------------------------------
 ' .判断开始 (等于 (读配置项 (“回收站窗口”, “显示尺寸”, “标准”), “较小”))
     ' _较小尺寸_被选择 ()
 ' .判断 (等于 (读配置项 (“回收站窗口”, “显示尺寸”, “标准”), “标准”))
     ' _标准尺寸_被选择 ()
.默认
    
.判断结束

 ' ----------------------------------------------------------------------------------------------
 ' .判断开始 (等于 (读配置项 (“回收站窗口”, “显示界面”, “美女啊”), “美女啊”))
     ' _美女啊_被选择 ()
 ' .判断 (等于 (读配置项 (“回收站窗口”, “显示界面”, “美女啊”), “炫酷黑”))
     ' _炫酷黑_被选择 ()
 ' .判断 (等于 (读配置项 (“回收站窗口”, “显示界面”, “美女啊”), “骷髅头”))
     ' _骷髅头_被选择 ()
.默认
    
.判断结束
 ' ----------------------------------------------------------------------------------------------
窗口_回收站.未知支持库函数_20 (“把文件拖放到这里可以删除！！！”, -1, , , , )
赋值 (鼠标移入, 假)

.子程序 屏幕分辨率被改变, 空白型, , 
销毁 ()

.子程序 系统关机请求, 空白型, , 
 ' _启动窗口._关闭系统_被选择 ()
 ' 结束 ()
调试输出 (“系统关机请求...”)

.子程序 _窗口_回收站_首次激活, 空白型, , 
赋值 (开始记录拖到, 假)
刷新显示回收站窗口 ()

.子程序 _窗口_回收站_被激活, 空白型, , 
.如果真 (等于 (开始记录拖到, 真))
    实时拖动窗口_ (37, 1, 0, 0)
.如果真结束


.子程序 _窗口_回收站_被取消激活, 空白型, , 
实时拖动窗口_ (37, 0, 0, 0)
 ' 窗口位置和大小保存 (窗口_回收站, 用户文件名, “回收站窗口”)
调试输出 (取鼠标水平位置 (), 取鼠标垂直位置 ())

.子程序 _窗口_回收站_获得焦点, 空白型, , 
赋值 (开始记录拖到, 真)
调试输出 (“开始记录拖到”, 开始记录拖到)

.子程序 _窗口_回收站_失去焦点, 空白型, , 
实时拖动窗口_ (37, 0, 0, 0)

.子程序 _窗口_回收站_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

 ' 信息框 (“双击”, 0, “提示”)
运行 (“Explorer.exe /n,::{645FF040-5081-101B-9F08-00AA002F954E}”, 假, )

.子程序 _窗口_回收站_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

 ' 信息框 (“右击”, 0, “提示”)
.如果 (等于 (取回收站状态 (), 0))
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
.如果结束

弹出菜单 ()


.子程序 _窗口_回收站_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

 ' 调试输出 (“..........”)
.如果真 (等于 (鼠标移入, 假))
    调试输出 (“窗口_回收站_鼠标移入了...”)
    刷新显示回收站窗口 (2) ' 弹出气泡时才刷新，避免文件过多卡机问题...
    赋值 (鼠标移入, 真)
    赋值 (.时钟周期, 5000)
.如果真结束


.子程序 _窗口_回收站_位置被改变, 空白型, , 
 ' 重画 ()
 ' 窗口位置和大小保存 (窗口_回收站, 用户文件名, “回收站窗口”)
 ' 调试输出 (取鼠标水平位置 (), 取鼠标垂直位置 ())

.子程序 _窗口_回收站_将被销毁, 空白型, , 
 ' 连续赋值 (假, _启动窗口.酷回收站.选中, _启动窗口.显示回收站, _启动窗口.酷回收站.禁止)
 ' 禁止拖放 (取窗口句柄 ())
取窗口句柄 ().未知支持库函数_1 ()
 ' 拖放对象_回收站.销毁 ()
 ' 气球提示框1.销毁 ()
真彩窗口.未知函数_67179136 ({  }) ' 这些是清空一些变量，不知有没有用，反正在销毁该窗口时内存无法释放，不知为何？？？
赋值 (回收站_空, {  })
赋值 (回收站_满, {  })
_结束窗口调整 ()
实时拖动窗口_ (37, 0, 0, 0)

.子程序 _窗口_回收站_可否被关闭, 逻辑型, , 
 ' 返回 (真)

.子程序 _时钟_鼠标移入_周期事件, 空白型, , 

赋值 (鼠标移入, 假)
赋值 (.时钟周期, 0)

.子程序 刷新显示回收站窗口, 空白型, , ●●●----------------☆夜未眠☆------------------------◎◎◎代码分隔标志◎◎◎------------------------☆夜未眠☆--------------------▲▲▲
.参数 方式, 整数型, 可空, 0,时钟;2,手动

.局部变量 临时值, 空白型, , , 

赋值 (临时值, 取回收站状态 (回收站_文件数量, 回收站_尺寸))
调试输出 (“刷新显示回收站窗口:”, 回收站_状态, 临时值, 回收站_文件数量, 回收站_尺寸)
.如果真 (是否为空 (方式))
    赋值 (方式, 0)
.如果真结束
.判断开始 (等于 (方式, 0)) ' 用判断可以方便以后扩展功能。。。
    .如果真 (不等于 (回收站_状态, 临时值))
        赋值 (回收站_状态, 临时值)
        .如果 (等于 (回收站_状态, 0))
            真彩窗口.未知函数_67179136 (回收站_空)
        .否则
            真彩窗口.未知函数_67179136 (回收站_满)
        .如果结束
        真彩窗口.未知函数_67179139 ()
    .如果真结束
    
.判断 (等于 (方式, 2))
    .如果 (等于 (临时值, 0))
        真彩窗口.未知函数_67179136 (回收站_空)
    .否则
        真彩窗口.未知函数_67179136 (回收站_满)
    .如果结束
    真彩窗口.未知函数_67179139 ()
.默认
    
.判断结束
返回 ()

.子程序 _拖放对象_回收站_得到文件, 空白型, , 
.参数 接收到的文件路径, 文本型, , 

.局部变量 i, 空白型, , , 
.局部变量 数组, 文本型, , "0", 

调试输出 (接收到的文件路径)
赋值 (数组, 分割文本 (接收到的文件路径, #换行符, ))

.如果真 (大于 (取数组成员数 (数组), 0))
    .计次循环首 (取数组成员数 (数组), i)
        处理事件 ()
        未知支持库函数_3 (数组 [i])
    .计次循环尾 ()
    
.如果真结束
刷新显示回收站窗口 ()

.子程序 _清空_被选择, 空白型, , ●●●----------------☆夜未眠☆------------------------◎◎◎代码分隔标志◎◎◎------------------------☆夜未眠☆--------------------▲▲▲
 ' 清空回收站 (取窗口句柄 ())
赋值 (.选中, 真)
 ' 建立线程 (&线程_清空回收站, , 真, 线程句柄)
清空回收站 ()

.子程序 线程_清空回收站, 空白型, , 
.局部变量 Name, 文本型, , , 

 ' Name ＝ 取运行目录 () ＋ “\清空回收站.exe”
 ' .如果真 (等于 (文件是否存在 (Name), 假))
     ' 写到文件 (Name, #清空回收站)
.如果真结束
 ' 运行 (Name ＋ “ 0”, 真, )
 ' 刷新显示回收站窗口 (2)
 ' 清空.选中 ＝ 假
 ' 中止线程 (线程句柄)

.子程序 _标准尺寸_被选择, 空白型, , 
窗口_回收站.未知函数_67179144 (., , , 256, 256, )
连续赋值 (真, .选中, .禁止)
连续赋值 (假, .选中, .禁止)
 ' 写配置项 (用户文件名, “回收站窗口”, “显示尺寸”, “标准”)
刷新显示回收站窗口 (2)

.子程序 _较小尺寸_被选择, 空白型, , 
窗口_回收站.未知函数_67179144 (., , , 150, 150, )
连续赋值 (真, .选中, .禁止)
连续赋值 (假, .选中, .禁止)
 ' 写配置项 (用户文件名, “回收站窗口”, “显示尺寸”, “较小”)
刷新显示回收站窗口 (2)

.子程序 _骷髅头_被选择, 空白型, , 
赋值 (回收站_空, #骷髅头_空)
赋值 (回收站_满, #骷髅头_满)
连续赋值 (真, .选中, .禁止)
连续赋值 (假, .选中, .禁止, .选中, .禁止)

 ' 写配置项 (用户文件名, “回收站窗口”, “显示界面”, “骷髅头”)
刷新显示回收站窗口 (2)

.子程序 _炫酷黑_被选择, 空白型, , 
赋值 (回收站_空, #炫酷黑_空)
赋值 (回收站_满, #炫酷黑_满)
连续赋值 (真, .选中, .禁止)
连续赋值 (假, .选中, .禁止, .选中, .禁止)

 ' 写配置项 (用户文件名, “回收站窗口”, “显示界面”, “炫酷黑”)
刷新显示回收站窗口 (2)

.子程序 _美女啊_被选择, 空白型, , 
赋值 (回收站_空, #美少女_空)
赋值 (回收站_满, #美少女_满)
连续赋值 (真, .选中, .禁止)
连续赋值 (假, .选中, .禁止, .选中, .禁止)

 ' 写配置项 (用户文件名, “回收站窗口”, “显示界面”, “美女啊”)
刷新显示回收站窗口 (2)

.子程序 _自定义_空_被选择, 空白型, , 


.子程序 _自定义_满_被选择, 空白型, , 


.子程序 _隐藏_被选择, 空白型, , 
.如果真 (等于 (信息框 (“这个回收站是不是很漂亮？”, 相加 (#是否钮, #询问图标, #位于前台, #系统等待), “☆夜未眠☆：”), #是钮))
     ' 写配置项 (用户文件名, “全局设置”, “显示回收站”, “假”)
    销毁 ()
.如果真结束


.子程序 _置顶_被选择, 空白型, , 
赋值 (.选中, 取反 (.选中))
.如果 (等于 (.选中, 真))
    赋值 (., 真)
.否则
    赋值 (., 假)
.如果结束


.子程序 _气球提示框1_提示框即将弹出, 逻辑型, , ●●●----------------☆夜未眠☆------------------------◎◎◎代码分隔标志◎◎◎------------------------☆夜未眠☆--------------------▲▲▲
.参数 窗口组件句柄, 整数型, , 
.参数 手柄横向坐标, 整数型, 参考, 
.参数 手柄纵向坐标, 整数型, 参考, 
.参数 提示文本, 文本型, 参考, 

赋值 (提示文本, 相加 (“回收站项目数量:<font color=red><b>”, 到文本 (回收站_文件数量), #换行符, “</b></font>回收站占用空间:<font color=red><b>”, 到文本 (四舍五入 (回收站_尺寸, 2)), “MB”))


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 窗口位置和大小读取, 空白型, , 读回窗口在屏幕中的位置,配置项不存在时将不会读取！
.参数 窗口, 窗口, 可空, 指定要读取配置的窗口,为空时必须开启默认窗口。
.参数 配置文件名, 文本型, , 读取设置的配置文件名。
.参数 配置节名称, 文本型, 可空, 默认为: "窗口参数"



.子程序 窗口位置和大小保存, 空白型, , 保存当前窗口在屏幕中的位置
.参数 窗口, 窗口, 可空, 指定要读取配置的窗口,为空时必须开启默认窗口。
.参数 配置文件名, 文本型, , 保存设置的配置文件名。
.参数 配置节名称, 文本型, 可空, 默认为: "窗口参数"



.子程序 开启窗口位置限制, 空白型, , 默认为屏幕范围内，显示器分辨率改变后自动调整
.参数 左边, 整数型, 可空, 
.参数 顶边, 整数型, 可空, 
.参数 右边, 整数型, 可空, 
.参数 底边, 整数型, 可空, 



.子程序 开启窗口大小限制, 空白型, , 默认限制当前尺寸为最小尺寸，最大不限制
.参数 最小宽度, 整数型, 可空, 
.参数 最小高度, 整数型, 可空, 
.参数 最大宽度, 整数型, 可空, 
.参数 最大高度, 整数型, 可空, 



.子程序 关闭窗口位置限制, 空白型, , 取消窗口大小限制


.子程序 开启窗口靠边隐藏, 空白型, , 当窗口在屏幕边缘时自动隐藏
.参数 停靠大小, 整数型, 可空, 停靠时在屏幕边缘露出的窗口大小,默认为5像素
.参数 显示速度, 整数型, 可空, 窗口在停靠时隐藏或显示的速度,默认为15



.子程序 鼠标是否在窗口范围内, 逻辑型, , 用于获得鼠标当前是否在窗口上,在返回 真 ;不在返回 假
.参数 窗口句柄, 整数型, 可空, 要判断的窗口句柄



.子程序 _初始化窗口调整, 空白型, , 放到窗口窗口创建完毕下，初始化窗口调整。。。。
.参数 窗口, 窗口, , 指定要调整的窗口。。
.参数 窗口句柄, 整数型, 可空, 指定要调整的窗口的句柄,非常规窗口时指定句柄。。



.子程序 取任务栏信息, 整数型, , 获取任务栏的矩形区域,成功返回任务栏高度,失败返回0
.参数 保存任务栏信息的变量, 矩形_, 可空, 默认为全局变量：取任务栏信息



.子程序 关闭窗口大小限制, 空白型, , 取消窗口大小限制


.子程序 关闭窗口靠边隐藏, 空白型, , 


.子程序 _结束窗口调整, 空白型, , 放到窗口即将销毁下。。。。


.子程序 关闭托盘图标防丢失, 空白型, , 放到窗口即将销毁下。。。。


.子程序 开启托盘图标防丢失, 空白型, , 开启后可以避免托盘图标丢失的问题
.参数 窗口句柄, 整数型, , 最好是启动窗口的句柄（不会被销毁的窗口）
.参数 回调子程序, 子程序指针, , 在托盘图标消失后，将执行此子程序。。。



.子程序 监控屏幕分辨率变化, 空白型, , 显示分辨率变更时将回调参数中的子程序。
.参数 回调子程序, 子程序指针, , 将执行的子程序。。。



.子程序 监控系统关机请求, 空白型, , 系统执行注销，重启，关机时将通知程序，避免窗口可否关闭为假时出现关不了机的情况。
.参数 回调子程序, 子程序指针, , 将执行的子程序。。。



.程序集 取回收站信息程序集, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。
 ' 取回收站状态 ()

.子程序 取回收站状态, 整数型, , 取得回收站的状态,回收站为空返回0，回收站不为空返回1。
.参数 文件数量, 整数型, 参考 可空, 请提供用于存放取得的回收站的文件数量的变量。
.参数 回收站尺寸, 双精度小数型, 参考 可空, 请提供用于存放取得的回收站的大小的变量,单位(MB)。

.局部变量 局_回收站信息, 回收站信息_, , , 

赋值 (局_回收站信息.结构大小, 20)
回收站询问_ (“”, 局_回收站信息)

.如果真 (并且 (小于或等于 (局_回收站信息.尺寸大小低64位, 0), 小于或等于 (局_回收站信息.条目数量低64位, 0)))
    赋值 (文件数量, 0)
    赋值 (回收站尺寸, 0)
    返回 (0)
.如果真结束

赋值 (文件数量, 局_回收站信息.条目数量低64位)
赋值 (回收站尺寸, 相除 (局_回收站信息.尺寸大小低64位, 1024, 1024))

调试输出 (文件数量, 回收站尺寸)
返回 (1)

.子程序 清空回收站, 空白型, , 清空回收站
.参数 窗口句柄, 整数型, 可空, 取窗口句柄获得
.参数 显示风格, 整数型, 可空, 0,显示确认;1,不显示确认;2,不显示删除进度;3,无声;默认为0。

.如果真 (是否为空 (显示风格))
    赋值 (显示风格, 0)
.如果真结束
清空回收站_ (窗口句柄, “”, 显示风格)
更新回收站图标_ ()


 ' 不属于任何一个程序集、类模块的函数：
