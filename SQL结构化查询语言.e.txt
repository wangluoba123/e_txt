 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 aaa ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 _启动窗口
    左边 = 50
    顶边 = 50
    宽度 = 630
    高度 = 426
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “SQL命令操作ACCESS数据库部分例题(仅供初学者参考)”
    帮助文件名 = “”



.常量 常量_软件名称, "“ADO数据查询例程”", , 
.常量 常量_版本号, "“ Ver1.0”", , 
.常量 常量_版权信息, "“ 作者:esir E-mail:cjdn@163.com ”", , 
.常量 常量_数据库名称, "“\Data.MDB”", , 
.常量 常量_数据库密码, "“”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 2 0 高级表格支持库
 ' eDB 46E94341933A462383A4DE26B146322C 2 7 数据库操作支持库
 ' CnCalendar {18C0788E-59AE-4112-B452-6BF0C1B727FB} 2 0 农历日期支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一





.程序集 公共程序集1, , , 

.子程序 读取Access数据到高表, 空白型, 公开, 每列读取数据
.参数 记录集1, 未知类型0x30002, , 
.参数 参_SQL查询语句, 文本型, , 
.参数 参_高级表格, 未知类型0x20001, , 

.局部变量 i, 整数型, , , 
.局部变量 j, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 字段名1, 文本型, , , 
.局部变量 字段类型, 整数型, , , 

 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

赋值 (参_高级表格., 相加 (记录集1., 1))
赋值 (参_高级表格., 记录集1.)
 ' 输出调试文本 (记录集1.字段数量)
 ' 输出调试文本 (记录集1.记录数量)
赋值 (参_高级表格., 假)
 ' 进度条1.最大位置 ＝ 记录集1.字段数量
.如果 (等于 (记录集1.未知支持库函数_14 (参_SQL查询语句, #), 真)) ' (3)打开记录集
     ' 参_高级表格.列数 ＝ 取数组成员数 (记忆字段名)
    .计次循环首 (记录集1., j)
        参_高级表格.未知支持库函数_9 (0, 相减 (j, 1), #., 记录集1.未知支持库函数_39 (相减 (j, 1)))
        赋值 (字段类型, 记录集1.未知支持库函数_43 (相减 (j, 1)))
        赋值 (i, 1)
        .判断循环首 (等于 (记录集1., 假))
             ' 参_高级表格.插入行 (, )
            记录集1.未知支持库函数_26 (相减 (j, 1), 字段名1)
            .判断开始 (或者 (等于 (字段类型, #), 等于 (字段类型, #), 等于 (字段类型, #), 等于 (字段类型, #), 等于 (字段类型, #), 等于 (字段类型, #)))
                参_高级表格.未知支持库函数_9 (i, 相减 (j, 1), #., 到文本 (四舍五入 (到数值 (字段名1), 2)))
            .判断 (等于 (字段类型, #))
                参_高级表格.未知支持库函数_9 (i, 相减 (j, 1), #., 到文本 (未知支持库函数_12 (取日期 (到时间 (字段名1)), “%y-%m-%d”)))
            .默认
                参_高级表格.未知支持库函数_9 (i, 相减 (j, 1), #., 字段名1)
            .判断结束
            记录集1.未知支持库函数_36 ()
            赋值 (i, 相加 (i, 1))
        .判断循环尾 ()
         ' 进度条1.位置 ＝ j
        记录集1.未知支持库函数_34 ()
    .计次循环尾 ()
    赋值 (参_高级表格., 真)
     ' 记录集1.到首记录 ()
    参_高级表格.未知支持库函数_0 (1, 1)
.否则
    信息框 (“打开数据源失败。”, 相加 (16, 0), “提示”)
.如果结束
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 高级表格_交替色显示, 空白型, 公开, 
.参数 参_高级表格1, 未知类型0x20001, , 

.局部变量 私_高级表格的列数, 整数型, , , 
.局部变量 i, 整数型, , , 

赋值 (私_高级表格的列数, 参_高级表格1.)
.计次循环首 (相减 (参_高级表格1., 1), i)
    .如果 (等于 (求余数 (i, 2), 0))
         ' 高级表格1.置单元格背景颜色 (i, 0, i, 高级表格的列数 － 1, #透明)  ' 透明 有BUG？
        参_高级表格1.未知支持库函数_24 (i, 0, i, 相减 (私_高级表格的列数, 1), #银白)
    .否则
        参_高级表格1.未知支持库函数_24 (i, 0, i, 相减 (私_高级表格的列数, 1), #白色)
    .如果结束
    ' 本源码来自易语言资源网(www.5A5X.com)
.计次循环尾 ()



.窗口程序集 窗口程序集2, , , 

.程序集变量 程序集_sql语句, 文本型, , , 
.程序集变量 数据库连接成功, 逻辑型, , , 
.程序集变量 文件名, 文本型, , , 
.程序集变量 密码, 文本型, , , 
.程序集变量 表名数组, 文本型, , "0", 
.子程序 __启动窗口_创建完毕, 空白型, , 
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

赋值 (密码, “8688”)
赋值 (文件名, 相加 (取运行目录 (), “\人员信息库.MDB”))
.如果 (文件名.未知支持库函数_1 (“8688”))
    赋值 (数据库连接成功, 真)
    高级表格_交替色显示 ()
    无限分类列表 (-1)
.否则
    信息框 (“连接失败”, 0, )
.如果结束
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 无限分类列表, 空白型, , 无限分类读取
.参数 树型框, 树型框, , 
.参数 扩展索引, 整数型, , 

.局部变量 事件, 文本型, , , 标题
.局部变量 编号, 整数型, , , 父编号
.局部变量 id, 整数型, , , 记录编号
.局部变量 记录索引, 整数型, , , 
.局部变量 选中数值, 整数型, , , 
.局部变量 数组变量, 整数型, , "0", 
.局部变量 数组变量1, 整数型, , "0", 
.局部变量 循环次数, 整数型, , , 

 ' '''''''''''''''''''''''''添加跟目录
.如果 (等于 (扩展索引, -1))
    .未知支持库函数_12 ()
    .未知支持库函数_12 ()
    “sql信息”.未知支持库函数_15 (“id asc”)
    “编号=0”.未知支持库函数_47 ()
    未知支持库函数_34 ()
    .计次循环首 (., )
        “ID”.未知支持库函数_29 (id)
        “事件”.未知支持库函数_26 (事件)
        “编号”.未知支持库函数_29 (编号)
        赋值 (记录索引, 树型框.加入项目 (事件, , , id, , ))
        “sql信息”.未知支持库函数_15 (“id asc”)
        相加 (“编号=”, 到文本 (id)).未知支持库函数_47 ()
        .计次循环首 (., )
             ' .如果真 (大于 (., 0))
                “事件”.未知支持库函数_26 (事件)
                树型框.加入项目 (记录索引, 事件, , , , , )
                加入成员 (数组变量, 记录索引)
            .如果真结束
            未知支持库函数_36 ()
        .计次循环尾 ()
        未知支持库函数_36 ()
    .计次循环尾 ()
.否则
    数组清零 (数组变量)
    .判断循环首 (大于 (树型框.取缩进层次 (相加 (扩展索引, 1)), 树型框.取缩进层次 (扩展索引)))
        树型框.删除项目 (相加 (扩展索引, 1))
        处理事件 ()
    .判断循环尾 ()
    赋值 (选中数值, 树型框.取项目数值 (扩展索引))
    “sql信息”.未知支持库函数_48 (相加 (“编号=”, 到文本 (选中数值)))
    未知支持库函数_34 ()
    .计次循环首 (., )
        “ID”.未知支持库函数_29 (id)
        “事件”.未知支持库函数_26 (事件)
        “编号”.未知支持库函数_29 (编号)
        赋值 (记录索引, 树型框.加入项目 (扩展索引, 事件, 1, 2, id))
        “sql信息”.未知支持库函数_48 (相加 (“编号=”, 到文本 (id)))
        .如果真 (大于 (., 0))
            树型框.加入项目 (记录索引, “添加中”, , , )
            加入成员 (数组变量1, 记录索引)
        .如果真结束
        未知支持库函数_36 ()
    .计次循环尾 ()
.如果结束
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _树型框1_即将扩展, 逻辑型, , 
.参数 项目索引, 整数型, , 

无限分类列表 (项目索引)

.子程序 __启动窗口_尺寸被改变, 空白型, , 
赋值 (.宽度, 相减 (取用户区宽度 (), ., 86))
赋值 (.宽度, .宽度)
赋值 (.宽度, .宽度)
赋值 (., 相减 (取用户区宽度 (), ., 20))
赋值 (., 相减 (取用户区高度 (), 120, 94))
赋值 (., 相减 (取用户区高度 (), 60))
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _树型框1_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

.局部变量 sql语句格式, 文本型, , , 
.局部变量 sql标准语句, 文本型, , , 
.局部变量 sql语句说明, 文本型, , , 
.局部变量 数据库名, 文本型, , , 
.局部变量 数据表名, 文本型, , , 

 ' 输出调试文本 (“索引号:” ＋ 到文本 (树型框1.取父项目 (树型框1.现行选中项)))
 ' 输出调试文本 (“取父项目文本:” ＋ 树型框1.取项目文本 (树型框1.取父项目 (树型框1.现行选中项)))
 ' 输出调试文本 (“取项目文本:” ＋ 树型框1.取项目文本 (树型框1.现行选中项))
.未知支持库函数_12 ()
“sql信息”.未知支持库函数_14 (#, )
相加 (“事件='”, .取项目文本 (.), “'”).未知支持库函数_45 (1)
3.未知支持库函数_26 (sql语句格式)
4.未知支持库函数_26 (数据库名)
5.未知支持库函数_26 (数据表名)
6.未知支持库函数_26 (sql标准语句)
7.未知支持库函数_26 (sql语句说明)
赋值 (.内容, 数据库名)
赋值 (.内容, 数据表名)
赋值 (.内容, sql语句格式)
赋值 (.内容, sql标准语句)
赋值 (.内容, sql语句说明)
赋值 (.禁止, 假)
.如果真 (或者 (等于 (.取父项目 (.).取项目文本 (), “SQL对记录操作”), 等于 (.取父项目 (.).取项目文本 (), “SQL数据表结构的操作”)))
    .未知支持库函数_12 ()
    .如果 (等于 (表名存在否 (文件名, “试验表”, 密码), 真))
        .未知支持库函数_14 (.内容, #, )
        读取Access数据到高表 (相加 (“select * from ”, .内容), )
        .如果真 (等于 (.取项目文本 (.), “创建表”))
            赋值 (.禁止, 真)
            信息框 (“已有《试验表》不需重建！”, 0, )
        .如果真结束
         ' 本源码来自易语言资源网(www.5A5X.com)
    .否则
        赋值 (.禁止, 真)
        .如果 (等于 (.取项目文本 (.), “删除表”))
            信息框 (“《试验表》不存在！不需要删除！”, 0, )
        .否则
            .如果 (等于 (.取项目文本 (.), “创建表”))
                赋值 (.禁止, 假)
            .否则
                信息框 (“《试验表》不存在！请先选择‘创建表’命令并执行后在选择该命令！”, 0, )
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果真结束


.子程序 _执行按钮_被单击, 空白型, , 
.如果 (不等于 (.内容, “”))
    赋值 (程序集_sql语句, .内容)
     ' 记录集1.置连接 (数据库连接1)
    .如果 (或者 (等于 (.取父项目 (.).取项目文本 (), “SQL对记录操作”), 等于 (.取父项目 (.).取项目文本 (), “SQL数据表结构的操作”)))
        .如果真 (或者 (等于 (.取项目文本 (.), “复制表结构”), 等于 (.取项目文本 (.), “复制表内容”)))
            .如果真 (等于 (表名存在否 (文件名, “新复制表”, 密码), 真))
                “DROP TABLE 新复制表”.未知支持库函数_14 (#, )
                赋值 (.内容, “新复制表”)
            .如果真结束
            
        .如果真结束
        .如果真 (或者 (等于 (.取项目文本 (.), “对应拷贝表”), 等于 (.取项目文本 (.), “不对应拷贝”)))
            .如果真 (等于 (表名存在否 (文件名, “新复制表”, 密码), 假))
                信息框 (“《新复制表》不存在，请先点击‘复制表结构’并点击‘执行’按钮后再运行此命令！”, 0, )
                返回 ()
            .如果真结束
            赋值 (.内容, “新复制表”)
        .如果真结束
        程序集_sql语句.未知支持库函数_14 (#, )
        .如果 (不等于 (.取项目文本 (.), “删除表”))
            .未知支持库函数_14 (.内容, #, )
            输出调试文本 (.)
            读取Access数据到高表 (相加 (“select * from ”, .内容), )
        .否则
            未知支持库函数_57 ()
            信息框 (“删除表成功！”, 0, )
        .如果结束
         ' 本源码来自易语言资源网(www.5A5X.com)
    .否则
        .如果 (程序集_sql语句.未知支持库函数_14 (#, ))
            .如果真 (不等于 (.取父项目 (.), 31))
                读取Access数据到高表 (程序集_sql语句, )
                0.置文本 (相加 (“ 显示动态： 符合条件的记录数量： ”, 到文本 (.), “ 个”))
            .如果真结束
            输出调试文本 (.)
        .否则
            信息框 (“执行失败！”, 0, )
        .如果结束
        
    .如果结束
    
.否则
    信息框 (“您还没有选择执行命令！请在‘树型框’中选择SQL命令后再按‘执行’按钮！”, 0, )
.如果结束


.子程序 表名存在否, 逻辑型, , 取出数据库中的所有表名放在“表名数组”中
.参数 路径文件名, 文本型, , 
.参数 要找的表名, 文本型, , 
.参数 密码, 文本型, 可空, 

.局部变量 Mycat对象, 对象, , , 
.局部变量 Tables对象, 对象, , , 
.局部变量 连接文本, 文本型, , , 
.局部变量 i, 整数型, , , 
.局部变量 表数量, 整数型, , , 
.局部变量 表名, 文本型, , , 

.如果真 (等于 (Mycat对象.创建 (“ADOX.Catalog”, ), 假))
    信息框 (“你的机器上没有安装ADO。文件位置是C:\Program Files\Common Files\System\ado\Msado.dll”, 0, )
    结束 ()
.如果真结束
赋值 (连接文本, 相加 (“Provider=MicroSoft.Jet.OLEDB.4.0;Data Source=”, 路径文件名, 选择 (是否为空 (密码), “”, 相加 (“;Jet OLEDB:Database Password=”, 密码))))
Mycat对象.写属性 (“ActiveConnection”, 连接文本)
赋值 (Tables对象, Mycat对象.读对象型属性 (“Tables”, ))
赋值 (表数量, Tables对象.读数值属性 (“Count”, ))
.计次循环首 (表数量, i)
    赋值 (表名, Tables对象.读对象型属性 (“Item”, 相减 (i, 1)).读文本属性 (“Name”, )) ' 序号从0开始
    输出调试文本 (表名)
     ' .如果真 (不等于 (取文本左边 (表名, 4), “MSys”)) ' 过虑掉系统表名
         ' 加入成员 (表名数组, 表名)
    .如果真结束
    .如果真 (等于 (表名, 要找的表名))
         ' .如果真 (等于 (信息框 (相加 (“已有同名的《职工表》！”, #换行符, “请重输并更换表名！”), 0, ), #确认钮))
            返回 (真)
        .如果真结束
        ' 本源码来自易语言资源网(www.5A5X.com)
    .如果真结束
    
.计次循环尾 ()
Tables对象.清除 ()
Mycat对象.清除 ()
返回 (假)


 ' 不属于任何一个程序集、类模块的函数：
