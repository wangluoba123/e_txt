 ' 文件类型：Windows窗口程序

 ' 程序名称：西藏格桑特产有限公司收银管理系统 V1.0
 ' 程序描述：西藏隆辉电脑技术中心 
版权所有(c)
@备注:
西藏隆辉电脑技术中心 
版权所有(c)
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：2.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 835
    高度 = 585
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “拉萨格桑特色产品开发有限公司收银管理系统 V2.0”
    帮助文件名 = “”

窗口 登录窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 334
    高度 = 210
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “【登录系统】”
    帮助文件名 = “”

窗口 资料选择
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “商品资料”
    帮助文件名 = “”

窗口 添加商品
    左边 = 50
    顶边 = 50
    宽度 = 450
    高度 = 249
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “添加商品”
    帮助文件名 = “”

窗口 销售窗口
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 616
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “销售单”
    帮助文件名 = “”

窗口 选取暂挂单
    左边 = 50
    顶边 = 50
    宽度 = 333
    高度 = 208
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “选取暂挂单”
    帮助文件名 = “”

窗口 历史账单
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 638
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “历史账单”
    帮助文件名 = “”

窗口 关于
    左边 = 50
    顶边 = 50
    宽度 = 389
    高度 = 187
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于”
    帮助文件名 = “”

窗口 修改密码
    左边 = 50
    顶边 = 50
    宽度 = 376
    高度 = 236
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “修改密码”
    帮助文件名 = “”

窗口 清空数据库
    左边 = 50
    顶边 = 50
    宽度 = 435
    高度 = 238
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “清空数据库”
    帮助文件名 = “”

窗口 供应商
    左边 = 50
    顶边 = 50
    宽度 = 388
    高度 = 202
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “供货商资料【添加】”
    帮助文件名 = “”

窗口 商品销售统计窗口
    左边 = 50
    顶边 = 50
    宽度 = 881
    高度 = 519
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “商品销售统计”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 898
    高度 = 412
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “销售详情”
    帮助文件名 = “”

窗口 打印设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 252
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “打印设置”
    帮助文件名 = “”



.常量 常量2, "“	”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext5 {E5000198-4471-40e2-92BC-D0BA075BDBB2} 2 0 扩展界面支持库五
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' eDB 46E94341933A462383A4DE26B146322C 2 3 数据库操作支持库
 ' ExtMenu 9909FBB013704cfa8FE7E739DB7172DE 2 0 超级菜单支持库
 ' spec A512548E76954B6E92C21055517615B0 3 0 特殊功能支持库
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 2 6 高级表格支持库
 ' eExcel2000 F86EC5989E044d42BC98C692C0B54727 2 0 EXCEL2000支持库
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 2 0 数据操作支持库一



 ' 所需要的模块
 ' 打印预览1.33 C:\Documents and Settings\Administrator\桌面\新建文件夹\超级列表框打印预览1.33.ec
 ' 超级列表框补助模块 C:\Documents and Settings\Administrator\桌面\新建文件夹\超级列表框交替色.ec
 ' 取拼音首 C:\Documents and Settings\Administrator\桌面\新建文件夹\取拼音首模块.ec


数据类型 商品格式, , 
    .成员 商品名称, 文本型, , , 
    .成员 规格, 文本型, , , 
    .成员 单位, 文本型, , , 
    .成员 单价, 小数型, , , 
    .成员 供货商, 文本型, , , 

.全局变量 修改类型, 整数型, , , 
.全局变量 是否是选择, 逻辑型, , , 真为选择，假不是选择
.全局变量 选择码, 文本型, , , 
.全局变量 是否通过验证, 逻辑型, , , 
.全局变量 时间1, 整数型, , , 
.全局变量 年月日, 整数型, , , 
.全局变量 供应商添加修改标记, 整数型, , , 
.全局变量 查询单品名称, 文本型, , , 
.全局变量 匿名全局变量_2094, 空白型, , , 
.全局变量 打印标题1, 文本型, , , 
.全局变量 打印标题2, 文本型, , , 
.全局变量 打印标题3, 文本型, , , 
.全局变量 打印标题4, 文本型, , , 
.全局变量 是否自动打印, 逻辑型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 资料选择类型, 整数型, , , 1=显示商品资料 2=显示供应商资料
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 文件号, 整数型, , , 
.局部变量 米索, 字节集, , , 

读入配置项目 ()
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

赋值 (文件号, 打开文件 (相加 (取运行目录 (), “\gs.key”), #读入, #无限制))
赋值 (米索, 读入字节集 (文件号, 取文件长度 (文件号)))
关闭文件 (文件号)
.如果真 (不等于 (返回注册钥匙 (到文本 (取硬盘特征字 ())), 米索))
    .如果真 (等于 (是否为调试版 (), 假))
        销毁 ()
    .如果真结束
    返回 ()
.如果真结束

调整界面 ()
载入 (登录窗口, _启动窗口, 真)
.如果真 (等于 (是否通过验证, 假))
    销毁 ()
.如果真结束

.如果真 (等于 (相加 (取运行目录 (), “\date\dat.mdb”).未知支持库函数_1 (“”), 假))
    文件更名 (相加 (取运行目录 (), “\date\dat.mdb”), 相加 (取运行目录 (), “\date\”, 到文本 (取现行时间 ()), “.mdb”))
    复制文件 (相加 (取运行目录 (), “\date\back\dat.mdb”), 相加 (取运行目录 (), “\date\dat.mdb”))
    信息框 (相加 (“连接数据库失败,系统将会关闭并尝试使用备份的数据库。”, #换行符, “单击确定，然后重新运行本系统。”), 相加 (0, #信息图标), “错误”)
    销毁 ()
    返回 ()
.如果真结束

.未知支持库函数_12 ()

.子程序 返回注册钥匙, 字节集, , 
.参数 特征字, 文本型, , 

返回 (未知支持库函数_3 (到字节集 (相加 (“dfasdffaswerw4234234dfgah”, 特征字, “zxl”)), “ER?><{}56TYU54353453I*&&345365635645546456345345)jkhoweuir”, #))

.子程序 调整界面, 空白型, , 
赋值 (.左边, 0)
赋值 (.顶边, 0)
赋值 (.高度, 取用户区高度 ())
赋值 (.宽度, 取用户区宽度 ())
赋值 (.左边, 相减 (取用户区宽度 (), .宽度, 25))
赋值 (.顶边, 相减 (取用户区高度 (), .高度, 25))
赋值 (.左边, 相减 (相乘 (取用户区宽度 (), 0.5), 相乘 (.宽度, 0.5)))
赋值 (.顶边, 相减 (相乘 (取用户区高度 (), 0.5), 相乘 (.高度, 0.5)))

.子程序 __启动窗口_尺寸被改变, 空白型, , 
调整界面 ()


.子程序 _销售单_被选择, 空白型, , 
载入 (销售窗口, _启动窗口, 假)

.子程序 _商品资料_被选择, 空白型, , 
赋值 (资料选择类型, 1)
载入 (资料选择, _启动窗口, 真)

.子程序 _供应商资料_被选择, 空白型, , 
赋值 (资料选择类型, 2)
载入 (资料选择, _启动窗口, 真)


.子程序 _销售记录_被选择, 空白型, , 
载入 (历史账单, _启动窗口, 假)


.子程序 __启动窗口_可否被关闭, 逻辑型, , 
.如果真 (等于 (信息框 (“您确定要退出【西藏格桑特产有限公司收银管理系统】吗？”, 相加 (4, #询问图标), “提示：”), 5))
    返回 (真)
.如果真结束

返回 (假)


.子程序 _关于_被选择, 空白型, , 
载入 (关于, _启动窗口, 真)


.子程序 _修改登录密码_被选择, 空白型, , 
载入 (修改密码, _启动窗口, 真)


.子程序 _备份数据库_被选择, 空白型, , 
复制文件 (相加 (取运行目录 (), “\date\dat.mdb”), 相加 (取运行目录 (), “\date\back\+”, 到全角 (到文本 (取现行时间 ())), “数据备份dat.mdb”))
信息框 (“备份数据库成功。”, 相加 (0, #信息图标), )

.子程序 _清空数据库_被选择, 空白型, , 
载入 (清空数据库, _启动窗口, 真)


.子程序 _恢复数据库_被选择, 空白型, , 
赋值 (.初始目录, 相加 (取运行目录 (), “\date\back”))
.如果真 (等于 (打开 (), 真))
    未知支持库函数_3 ()
    复制文件 (相加 (取运行目录 (), “\date\dat.mdb”), 相加 (取运行目录 (), “\date\back\+”, 到全角 (到文本 (取现行时间 ())), “恢复前备份dat.mdb”))
    复制文件 (相加 (取运行目录 (), “\date\back\dat.mdb”), 相加 (取运行目录 (), “\date\dat.mdb”))
    相加 (取运行目录 (), “\date\dat.mdb”).未知支持库函数_1 (“”)
    .未知支持库函数_12 ()
.如果真结束


.子程序 _供应商商品销售统计_被选择, 空白型, , 




.子程序 设置表格, 空白型, , 
.参数 工作表, 未知类型0x80002, 参考, 
.参数 首单元, 文本型, , 
.参数 尾单元, 文本型, , 

.如果真 (等于 (尾单元, “”))
    赋值 (尾单元, 首单元)
.如果真结束
赋值 (工作表., 首单元)
赋值 (工作表., 尾单元)



.子程序 取列号, 文本型, , 
.参数 列号, 整数型, , 

.局部变量 列号表, 文本型, , "26", 

赋值 (列号表 [1], “A”)
赋值 (列号表 [2], “B”)
赋值 (列号表 [3], “C”)
赋值 (列号表 [4], “D”)
赋值 (列号表 [5], “E”)
赋值 (列号表 [6], “F”)
赋值 (列号表 [7], “G”)
赋值 (列号表 [8], “H”)
赋值 (列号表 [9], “I”)
赋值 (列号表 [10], “J”)
赋值 (列号表 [11], “K”)
赋值 (列号表 [12], “L”)
赋值 (列号表 [13], “M”)
赋值 (列号表 [14], “N”)
赋值 (列号表 [15], “O”)
赋值 (列号表 [16], “P”)
赋值 (列号表 [17], “Q”)
赋值 (列号表 [18], “R”)
赋值 (列号表 [19], “S”)
赋值 (列号表 [20], “T”)
赋值 (列号表 [21], “U”)
赋值 (列号表 [22], “V”)
赋值 (列号表 [23], “W”)
赋值 (列号表 [24], “X”)
赋值 (列号表 [25], “Y”)
赋值 (列号表 [26], “Z”)
赋值 (列号, 相加 (列号, 1))
.如果真 (大于 (列号, 26))
    赋值 (列号, 1)
.如果真结束

返回 (列号表 [列号])


.子程序 超级列表框到EXCEL_自定义, 空白型, , 
.参数 列表框, 超级列表框, 参考, 
.参数 标题EXCEL, 文本型, , 

.局部变量 计次, 整数型, , , 
.局部变量 计次结束, 整数型, , , 
.局部变量 匿名局部变量_1356, 空白型, , , 
.局部变量 计次1, 整数型, , , 
.局部变量 计次结束1, 整数型, , , 
.局部变量 匿名局部变量_1357, 空白型, , , 

.如果真 (等于 (_启动窗口.未知支持库函数_0 (.), 假))
    信息框 (“调用Excel功能失败，您的电脑没有安装Excel！”, 0, )
    返回 ()
.如果真结束
_启动窗口.未知支持库函数_6 (.)
赋值 (., 真)
未知支持库函数_21 ()
赋值 (., 1)

设置表格 (“A1”, 相加 (取列号 (列表框.取列数 ()), “1”))
未知支持库函数_26 ()
赋值 (., 40)
赋值 (., 10)
赋值 (., 标题EXCEL)
赋值 (., 真)
赋值 (., 取颜色值 (0, 0, 255))
赋值 (., 18)
赋值 (., 真)
赋值 (., -4108)

赋值 (计次, 0)
赋值 (计次结束, 列表框.取表项数 ())
赋值 (计次结束1, 列表框.取列数 ())

赋值 (计次1, 0)
赋值 (计次结束1, 列表框.取列数 ())

.判断循环首 (小于 (计次1, 计次结束1))
    设置表格 (相加 (取列号 (计次1), “2”), 相加 (取列号 (计次1), “2”))
    赋值 (., 列表框.取列标题 (计次1))
    赋值 (计次1, 相加 (计次1, 1))
.判断循环尾 ()

.判断循环首 (小于 (计次, 计次结束))
    赋值 (计次1, 0)
    .判断循环首 (小于 (计次1, 计次结束1))
        设置表格 (相加 (取列号 (计次1), 到文本 (相加 (计次, 3))), 相加 (取列号 (计次1), 到文本 (相加 (计次, 3))))
        赋值 (., 列表框.取标题 (计次, 计次1))
        
        赋值 (计次1, 相加 (计次1, 1))
    .判断循环尾 ()
    赋值 (计次, 相加 (计次, 1))
.判断循环尾 ()
未知支持库函数_7 ()
未知支持库函数_1 ()


.子程序 _商品销售统计_被选择, 空白型, , 
载入 (商品销售统计窗口, _启动窗口, 假)


.子程序 __启动窗口_将被销毁, 空白型, , 
.如果真 (是否已创建 (销售窗口))
    销售窗口.销毁 ()
    
.如果真结束


.子程序 _打印设置_被选择, 空白型, , 
 ' 载入 (打印设置窗口, _启动窗口, 真)


.窗口程序集 窗口程序集2, , , 

.子程序 _资料选择_创建完毕, 空白型, , 
.局部变量 SQL, 文本型, , , 

超级列表框交替色 (真)
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

.如果真 (等于 (_启动窗口., 1))
    .如果 (等于 (是否是选择, 真))
        赋值 (SQL, 相加 (“select * from 商品资料 where 备注 LIKE '%”, 选择码, “%' or 拼音码 LIKE '%”, 选择码, “%' or 名称 LIKE '%”, 选择码, “%'”))
        调试输出 (SQL)
        刷新资料 (SQL)
    .否则
        刷新资料 (“select * from 商品资料”)
    .如果结束
    
.如果真结束

.如果真 (等于 (_启动窗口., 2))
    1.置列标题 (“供货商名称”)
    1.置列宽 (150)
    2.置列标题 (“联系电话”)
    2.置列宽 (100)
    3.置列标题 (“地址”)
    3.置列宽 (200)
    4.置列标题 (“联系人”)
    4.置列宽 (100)
    5.置列标题 (“备注”)
    5.置列宽 (250)
    6.删除列 ()
    6.删除列 ()
    刷新供货商资料 ()
.如果真结束

获取焦点 ()
赋值 (., 0)

.子程序 刷新供货商资料, 空白型, , 
.局部变量 计次结束, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 临时读取, 文本型, , , 

_启动窗口.未知支持库函数_14 (., “select * from 供货商”, #)

赋值 (计次结束, _启动窗口..)
赋值 (计次, 1)
.判断循环首 (小于或等于 (计次, 计次结束))
    -1.插入表项 (到文本 (计次), , , , )
    _启动窗口.未知支持库函数_26 (., “供货商名称”, 临时读取)
    相减 (取表项数 (), 1).置标题 (1, 临时读取)
    
    _启动窗口.未知支持库函数_26 (., “电话”, 临时读取)
    相减 (取表项数 (), 1).置标题 (2, 临时读取)
    
    _启动窗口.未知支持库函数_26 (., “地址”, 临时读取)
    相减 (取表项数 (), 1).置标题 (3, 临时读取)
    
    _启动窗口.未知支持库函数_26 (., “联系人”, 临时读取)
    相减 (取表项数 (), 1).置标题 (4, 临时读取)
    
    _启动窗口.未知支持库函数_26 (., “备注”, 临时读取)
    相减 (取表项数 (), 1).置标题 (5, 临时读取)
    
    
    _启动窗口.未知支持库函数_36 (.)
    赋值 (计次, 相加 (计次, 1))
.判断循环尾 ()


_启动窗口.未知支持库函数_16 (.)


.子程序 刷新资料, 空白型, , 
.参数 SQL, 文本型, , 

.局部变量 计次, 整数型, , , 
.局部变量 临时文本, 文本型, , , 
.局部变量 临时数字, 小数型, , , 

全部删除 ()

_启动窗口.未知支持库函数_14 (., SQL, #)
.如果真 (并且 (等于 (是否是选择, 真), 等于 (_启动窗口.., 0)))
    赋值 (销售窗口..内容, “”)
    销毁 ()
    销售窗口.未知支持库函数_26 (., 相减 (销售窗口..左边, 30), 相减 (销售窗口., 50), “<font>没有检索到相应的商品资料</font>”, -1, )
.如果真结束

_启动窗口.未知支持库函数_34 (.)
赋值 (计次, 1)
.判断循环首 (等于 (_启动窗口.., 假))
    -1.插入表项 (到文本 (计次), , , , )
    
    _启动窗口.未知支持库函数_26 (., “名称”, 临时文本)
    相减 (取表项数 (), 1).置标题 (1, 临时文本)
    
    _启动窗口.未知支持库函数_26 (., “供货商”, 临时文本)
    相减 (取表项数 (), 1).置标题 (2, 临时文本)
    
    _启动窗口.未知支持库函数_26 (., “规格”, 临时文本)
    相减 (取表项数 (), 1).置标题 (3, 临时文本)
    
    _启动窗口.未知支持库函数_26 (., “单位”, 临时文本)
    相减 (取表项数 (), 1).置标题 (4, 临时文本)
    
    _启动窗口.未知支持库函数_28 (., “单价”, 临时数字)
    相减 (取表项数 (), 1).置标题 (5, 到文本 (临时数字))
    
    _启动窗口.未知支持库函数_26 (., “拼音码”, 临时文本)
    相减 (取表项数 (), 1).置标题 (6, 临时文本)
    
    _启动窗口.未知支持库函数_26 (., “备注”, 临时文本)
    相减 (取表项数 (), 1).置标题 (7, 临时文本)
    
    赋值 (计次, 相加 (计次, 1))
    _启动窗口.未知支持库函数_36 (.)
.判断循环尾 ()
_启动窗口.未知支持库函数_16 (.)

自动调整列宽 ()


.子程序 _修改_被选择, 空白型, , 


.子程序 修改商品, 空白型, , 
赋值 (修改类型, 0)
载入 (添加商品, _启动窗口, 真)


.子程序 添加商品, 空白型, , 
赋值 (修改类型, 1)
载入 (添加商品, _启动窗口, 真)


.子程序 删除商品, 空白型, , 
.局部变量 SQL, 文本型, , , 
.局部变量 a, 整数型, , , 
.局部变量 b, 整数型, , , 

.如果真 (等于 (., -1))
    调试输出 (“无选中商品”)
    返回 ()
.如果真结束

调试输出 (.)
.如果真 (等于 (信息框 (相加 (“确实要删除商品【”, .取标题 (., 1), “】吗？”), 相加 (#是否钮, #询问图标), “询问”), 5))
    赋值 (SQL, 相加 (“delete from 商品资料 where 名称='”, .取标题 (., 1), “'”))
    
    .如果真 (等于 (_启动窗口.未知支持库函数_4 (., SQL), 假))
        调试输出 (SQL)
        信息框 (“删除商品失败”, 0, )
        返回 ()
    .如果真结束
    .删除表项 (.)
.如果真结束

赋值 (a, 0)
赋值 (b, 相减 (取表项数 (), 1))
.判断循环首 (小于或等于 (a, b))
    a.置标题 (0, 到文本 (相加 (a, 1)))
    
    赋值 (a, 相加 (a, 1))
.判断循环尾 ()

.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.局部变量 aa, 整数型, , "7", 
.局部变量 bb, 整数型, , "6", 

.如果真 (等于 (_启动窗口., 1))
    .如果真 (等于 (按钮索引, 0))
        添加商品 ()
        返回 ()
    .如果真结束
    
    .如果真 (等于 (按钮索引, 1))
        .如果真 (不等于 (., -1))
            修改商品 ()
        .如果真结束
        返回 ()
    .如果真结束
    
    .如果真 (等于 (按钮索引, 2))
        删除商品 ()
        返回 ()
    .如果真结束
    
    .如果真 (等于 (按钮索引, 3))
        赋值 (aa [1], 0)
        赋值 (aa [2], 1)
        赋值 (aa [3], 2)
        赋值 (aa [4], 3)
        赋值 (aa [5], 4)
        赋值 (aa [6], 5)
        赋值 (aa [7], 6)
        打印预览 (“商品资料”, 真, aa)
        返回 ()
    .如果真结束
    
    .如果真 (等于 (按钮索引, 4))
        超级列表框到EXCEL_自定义 (“商品资料”)
        返回 ()
    .如果真结束
    
    
.如果真结束

.如果真 (等于 (_启动窗口., 2))
    .如果真 (等于 (按钮索引, 0))
        添加商品11 ()
        返回 ()
    .如果真结束
    
    .如果真 (等于 (按钮索引, 1))
        .如果真 (不等于 (., -1))
            修改商品11 ()
        .如果真结束
        返回 ()
    .如果真结束
    
    .如果真 (等于 (按钮索引, 2))
        删除商品11 ()
        返回 ()
    .如果真结束
    
    .如果真 (等于 (按钮索引, 3))
        赋值 (bb [1], 0)
        赋值 (bb [2], 1)
        赋值 (bb [3], 2)
        赋值 (bb [4], 3)
        赋值 (bb [5], 4)
        赋值 (bb [6], 5)
        打印预览 (“商品资料”, 真, bb)
        返回 ()
    .如果真结束
    
    .如果真 (等于 (按钮索引, 4))
        超级列表框到EXCEL_自定义 (“供货商资料”)
        返回 ()
    .如果真结束
    
.如果真结束


.如果真 (等于 (按钮索引, 5))
    销毁 ()
    返回 ()
.如果真结束


.子程序 _按钮2_被单击, 空白型, , 
刷新资料 (“select * from 商品资料”)


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 文本, 文本型, , , 

赋值 (文本, 取拼音首 (.内容))
刷新资料 (相加 (“select * from 商品资料 where 拼音码 LIKE '%”, 文本, “%'”))


.子程序 _资料选择_将被销毁, 空白型, , 
赋值 (是否是选择, 假)
赋值 (_启动窗口., 0)


.子程序 _超级列表框1_左键单击表项, 空白型, , 
选中内容到高级表格 ()


.子程序 _超级列表框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    选中内容到高级表格 ()
.如果真结束


.子程序 选中内容到高级表格, 空白型, , 
.局部变量 商品, 商品格式, , , 

.如果真 (等于 (是否是选择, 真))
    .如果真 (大于或等于 (., 0))
        赋值 (商品.商品名称, .取标题 (., 1))
        赋值 (商品.供货商, .取标题 (., 2))
        赋值 (商品.规格, .取标题 (., 3))
        赋值 (商品.单位, .取标题 (., 4))
        赋值 (商品.单价, 到数值 (.取标题 (., 5)))
        加入表格 (商品)
        销毁 ()
    .如果真结束
    
.如果真结束


.子程序 _资料选择_被激活, 空白型, , 
获取焦点 ()
赋值 (., 0)


.子程序 添加商品11, 空白型, , 
赋值 (供应商添加修改标记, 1)
载入 (供应商, _启动窗口, 真)

.子程序 修改商品11, 空白型, , 
赋值 (供应商添加修改标记, 2)
载入 (供应商, _启动窗口, 真)

.子程序 删除商品11, 空白型, , 
.局部变量 SQL, 文本型, , , 
.局部变量 a, 整数型, , , 
.局部变量 b, 整数型, , , 



.如果真 (等于 (., -1))
    调试输出 (“无选中商品”)
    返回 ()
.如果真结束

调试输出 (.)
.如果真 (等于 (信息框 (相加 (“确实要删除供货商【”, .取标题 (., 1), “】吗？”), 相加 (#是否钮, #询问图标), “询问”), 5))
    
    赋值 (SQL, 相加 (“delete from 供货商 where 供货商名称='”, .取标题 (., 1), “'”))
    
    .如果真 (等于 (_启动窗口.未知支持库函数_4 (., SQL), 假))
        调试输出 (SQL)
        信息框 (“删除商品失败”, 0, )
        返回 ()
    .如果真结束
    .删除表项 (.)
.如果真结束

赋值 (a, 0)
赋值 (b, 相减 (取表项数 (), 1))
.判断循环首 (小于或等于 (a, b))
    a.置标题 (0, 到文本 (相加 (a, 1)))
    
    赋值 (a, 相加 (a, 1))
.判断循环尾 ()


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 打印预览, 空白型, , 
.参数 超级列表框, 超级列表框, , 程序中要进行打印的超级列表框名称
.参数 标题, 文本型, 参考 可空, 可空
.参数 日期打印, 逻辑型, 可空, 可空，逻辑型，真为打印，假为不打印
.参数 列索引, 整数型, 数组, 需要进行打印的列索引，为整数型
.参数 每页行数, 整数型, 可空, 可空，默认为30
.参数 线条类别, 整数型, 可空, 可空，两种线条类别选择，1或2，默认为1
.参数 方向, 整数型, 可空, 可空，打印时的纸张方向，0、#纵向 1、#横向,默认为0
.参数 字体大小, 整数型, 可空, 可空，一般为40
.参数 合计, 逻辑型, 可空, 可空，逻辑型，真为显示合计，假为不显示,默认为假



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 自动调整列宽, 空白型, , 根据超级列表框表项内容的长度调整列宽
.参数 超级列表框, 超级列表框, , 要调自动调整列宽超级列表框



.子程序 超级列表框交替色, 空白型, , 
.参数 超级列表框, 超级列表框, , 要使用交替色的超级列表框
.参数 是否使用交替色, 逻辑型, 可空, 为假时清除超级列表框交替色，空则为假



.窗口程序集 窗口程序集3, , , 

.程序集变量 原始商品名称, 文本型, , , 
.子程序 _添加商品_创建完毕, 空白型, , 
.局部变量 计次1, 整数型, , , 

.如果 (等于 (修改类型, 1))
    赋值 (., “添加商品”)
    赋值 (修改类型, 0)
    赋值 (.标题, “添加”)
    刷新供货商 ()
.否则
    赋值 (., “修改商品”)
    赋值 (.内容, 资料选择.取标题 (., 资料选择.., 1))
    赋值 (.内容, 资料选择.取标题 (., 资料选择.., 6))
    赋值 (.内容, 资料选择.取标题 (., 资料选择.., 3))
    赋值 (.内容, 资料选择.取标题 (., 资料选择.., 4))
    赋值 (.内容, 资料选择.取标题 (., 资料选择.., 7))
    赋值 (.内容, 资料选择.取标题 (., 资料选择.., 5))
    赋值 (.标题, “修改”)
    赋值 (原始商品名称, .内容)
    赋值 (.选中, 假)
    赋值 (.可视, 假)
    刷新供货商 ()
    赋值 (计次1, 0)
    .判断循环首 (小于 (计次1, 取项目数 ()))
        .如果真 (等于 (计次1.取项目文本 (), 资料选择.取标题 (., 资料选择.., 2)))
            赋值 (.现行选中项, 计次1)
        .如果真结束
        赋值 (计次1, 相加 (计次1, 1))
    .判断循环尾 ()
.如果结束



.子程序 刷新供货商, 空白型, , 
.参数 列表框, 组合框, , 

.局部变量 计次, 整数型, , , 
.局部变量 计次结束, 整数型, , , 
.局部变量 临时读取, 文本型, , , 

_启动窗口.未知支持库函数_14 (., “select * from 供货商”, #)
赋值 (计次, 1)
赋值 (计次结束, _启动窗口..)
.判断循环首 (小于或等于 (计次, 计次结束))
    _启动窗口.未知支持库函数_26 (., “供货商名称”, 临时读取)
    列表框.加入项目 (临时读取, )
    赋值 (计次, 相加 (计次, 1))
    _启动窗口.未知支持库函数_36 (.)
.判断循环尾 ()
_启动窗口.未知支持库函数_16 (.)

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 SQL, 文本型, , , 

.如果真 (等于 (有效性检查 (), 假))
    返回 ()
.如果真结束


.如果 (等于 (., “添加商品”))
    .如果真 (等于 (商品是否重复 (.内容), 真))
        返回 ()
    .如果真结束
    
    赋值 (SQL, 相加 (“insert into 商品资料(名称,规格,单位,单价,拼音码,备注,供货商) values ('”, .内容, “','”, .内容, “','”, .内容, “',”, .内容, “,'”, .内容, “','”, .内容, “','”, .内容, “')”))
    .如果 (等于 (_启动窗口.未知支持库函数_4 (., SQL), 假))
        调试输出 (SQL)
        信息框 (“添加商品失败”, 0, )
        返回 ()
    .否则
        资料选择.插入表项 (., -1, 到文本 (相加 (资料选择.取表项数 (.), 1)), , , , )
        资料选择.置标题 (., 相减 (资料选择.取表项数 (.), 1), 1, .内容)
        资料选择.置标题 (., 相减 (资料选择.取表项数 (.), 1), 2, .内容)
        资料选择.置标题 (., 相减 (资料选择.取表项数 (.), 1), 3, .内容)
        资料选择.置标题 (., 相减 (资料选择.取表项数 (.), 1), 4, .内容)
        资料选择.置标题 (., 相减 (资料选择.取表项数 (.), 1), 5, .内容)
        资料选择.置标题 (., 相减 (资料选择.取表项数 (.), 1), 6, .内容)
        资料选择.置标题 (., 相减 (资料选择.取表项数 (.), 1), 7, .内容)
        .如果 (等于 (.选中, 真))
            赋值 (.内容, “”)
            赋值 (.内容, “”)
        .否则
            
            赋值 (资料选择.., 相减 (资料选择.取表项数 (.), 1))
            销毁 ()
        .如果结束
        
        资料选择.保证显示 (., 相减 (资料选择.取表项数 (.), 1))
    .如果结束
    
.否则
    
    .如果真 (不等于 (.内容, 原始商品名称))
        .如果真 (等于 (商品是否重复 (.内容), 真))
            返回 ()
        .如果真结束
        
    .如果真结束
    
    赋值 (SQL, 相加 (“update 商品资料 set 名称='”, .内容, “',规格='”, .内容, “',单位='”, .内容, “',单价=”, .内容, “,拼音码='”, .内容, “',备注='”, .内容, “',供货商='”, .内容, “' where 名称='”, 原始商品名称, “'”))
    
    .如果 (等于 (_启动窗口.未知支持库函数_4 (., SQL), 假))
        调试输出 (SQL)
        信息框 (“修改商品失败”, 0, )
        返回 ()
    .否则
        
        资料选择.置标题 (., 资料选择.., 1, .内容)
        资料选择.置标题 (., 资料选择.., 2, .内容)
        资料选择.置标题 (., 资料选择.., 3, .内容)
        资料选择.置标题 (., 资料选择.., 4, .内容)
        资料选择.置标题 (., 资料选择.., 5, .内容)
        资料选择.置标题 (., 资料选择.., 6, .内容)
        资料选择.置标题 (., 资料选择.., 7, .内容)
        
        销毁 ()
        资料选择.保证显示 (., 资料选择..)
    .如果结束
    
    
.如果结束




.子程序 有效性检查, 逻辑型, , 假无效
赋值 (.内容, 删除特殊符号 (.内容))
赋值 (.内容, 删除特殊符号 (.内容))
赋值 (.内容, 删除特殊符号 (.内容))
赋值 (.内容, 删除特殊符号 (.内容))
赋值 (.内容, 删除特殊符号 (.内容))
赋值 (.内容, 到文本 (到数值 (.内容)))

.如果真 (小于或等于 (到数值 (.内容), 0))
    信息框 (“单价不许小于等于0”, 0, )
    获取焦点 ()
    返回 (假)
.如果真结束

.如果真 (等于 (.内容, “”))
    信息框 (“商品名称不能为空”, 0, )
    获取焦点 ()
    返回 (假)
.如果真结束

.如果真 (等于 (.内容, “”))
    信息框 (“单位不能为空”, 0, )
    获取焦点 ()
    返回 (假)
.如果真结束

.如果真 (等于 (.内容, “”))
    信息框 (“规格不能为空”, 0, )
    获取焦点 ()
    返回 (假)
.如果真结束

.如果真 (等于 (.内容, “”))
    信息框 (“单价不能为空”, 0, )
    获取焦点 ()
    返回 (假)
.如果真结束

.如果真 (等于 (.内容, “”))
    信息框 (“单位不能为空”, 0, )
    获取焦点 ()
    返回 (假)
.如果真结束

.如果真 (等于 (.内容, “”))
    信息框 (“必须填写供货商”, 0, )
    获取焦点 ()
    返回 (假)
.如果真结束

返回 (真)

.子程序 商品是否重复, 逻辑型, , 
.参数 商品名称, 文本型, , 

_启动窗口.未知支持库函数_14 (., 相加 (“select * from 商品资料 where 名称='”, .内容, “'”), #)
.如果真 (大于或等于 (_启动窗口.., 1))
    信息框 (相加 (“商品名称【”, 商品名称, “】重复，请重新输入。”), 0, )
    _启动窗口.未知支持库函数_16 (.)
    获取焦点 ()
    返回 (真)
.如果真结束

返回 (假)

.子程序 删除特殊符号, 文本型, , 
.参数 文本, 文本型, , 

赋值 (文本, 删首尾空 (文本))
赋值 (文本, 子文本替换 (文本, “'”, “”, 1, , 真))
赋值 (文本, 子文本替换 (文本, “\”, “”, 1, , 真))
赋值 (文本, 子文本替换 (文本, #引号, 相加 (“”, #引号), 1, , 真))
赋值 (文本, 子文本替换 (文本, #换行符, “”, 1, , 真))
返回 (文本)

.子程序 _编辑框1_内容被改变, 空白型, , 
赋值 (.内容, 取拼音首 (.内容))


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 风格, 文本型, , "0", 

赋值 (风格, 分割文本 (.内容, #常量2, ))
.如果真 (小于 (取数组成员数 (风格), 6))
    返回 ()
.如果真结束

赋值 (.内容, 风格 [1])
赋值 (.内容, 风格 [2])
赋值 (.内容, 风格 [3])
赋值 (.内容, 风格 [4])
赋值 (.内容, 风格 [5])
赋值 (.内容, 风格 [6])
赋值 (.内容, “”)


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 取拼音首, 文本型, , 
.参数 内容, 文本型, , 要取拼音码的文本



.窗口程序集 窗口程序集4, , , 

.程序集变量 打印内容, 文本型, , , 
.子程序 _销售窗口_创建完毕, 空白型, , 

调整尺寸 ()
获取焦点 ()
赋值 (.标题, 到标准时间 ())
生成单据编号 ()
画表头 ()

.子程序 画表头, 空白型, , 

0.未知支持库函数_9 (0, #., “序号”)
0.未知支持库函数_9 (1, #., “商品名称”)
0.未知支持库函数_9 (2, #., “供货商”)

0.未知支持库函数_9 (3, #., “规格”)
0.未知支持库函数_9 (4, #., “单位”)

0.未知支持库函数_9 (5, #., “数量”)
5.未知支持库函数_30 (#.)


 ' 高级表格1.置货币前缀 (4, #表格常量.自定义货币, “”)

0.未知支持库函数_9 (6, #., “单价”)
6.未知支持库函数_30 (#.)


0.未知支持库函数_9 (7, #., “合计”)
7.未知支持库函数_30 (#.)


0.未知支持库函数_32 (36)
1.未知支持库函数_32 (146)
2.未知支持库函数_32 (120)
3.未知支持库函数_32 (80)
4.未知支持库函数_32 (31)
5.未知支持库函数_32 (64)
6.未知支持库函数_32 (100)
7.未知支持库函数_32 (100)
0.未知支持库函数_25 (0, 0, 6, #.)


.子程序 调整尺寸, 空白型, , 
赋值 (., 相减 (取用户区宽度 (), .宽度, ., 5))
赋值 (.左边, 相加 (., ., 5))
赋值 (., 相减 (取用户区高度 (), 175))
赋值 (.高度, .)
赋值 (.顶边, 相减 (.高度, 40))
赋值 (.宽度, 相减 (取用户区宽度 (), 136))
赋值 (.顶边, 相减 (取用户区高度 (), .高度))
赋值 (.宽度, 取用户区宽度 ())
赋值 (.宽度, 相减 (取用户区宽度 (), 68))



.子程序 _销售窗口_尺寸被改变, 空白型, , 
调整尺寸 ()

.子程序 _时钟1_周期事件, 空白型, , 
赋值 (.标题, 到标准时间 ())

.子程序 到标准时间, 文本型, , 
.局部变量 年, 文本型, , , 
.局部变量 月, 文本型, , , 
.局部变量 日, 文本型, , , 
.局部变量 时, 文本型, , , 
.局部变量 分, 文本型, , , 
.局部变量 秒, 文本型, , , 
.局部变量 时间, 日期时间型, , , 

赋值 (时间, 取现行时间 ())
赋值 (年, 到文本 (取年份 (时间)))
赋值 (月, 到文本 (取月份 (时间)))
赋值 (日, 到文本 (取日 (时间)))
赋值 (时, 到文本 (取小时 (时间)))
赋值 (分, 到文本 (取分钟 (时间)))
赋值 (秒, 到文本 (取秒 (时间)))

返回 (相加 (年, “-”, 月, “-”, 日, “ ”, 时, “:”, 分, “:”, 秒))


.子程序 到标准时间1, 文本型, , 
.参数 时间, 日期时间型, , 

.局部变量 年, 文本型, , , 
.局部变量 月, 文本型, , , 
.局部变量 日, 文本型, , , 
.局部变量 时, 文本型, , , 
.局部变量 分, 文本型, , , 
.局部变量 秒, 文本型, , , 

赋值 (年, 到文本 (取年份 (时间)))
赋值 (月, 到文本 (取月份 (时间)))
赋值 (日, 到文本 (取日 (时间)))

返回 (相加 (年, “-”, 月, “-”, 日))


.子程序 到标准日期, 文本型, , 
.参数 是否分割, 逻辑型, , 真用直线分割

.局部变量 年, 文本型, , , 
.局部变量 月, 文本型, , , 
.局部变量 日, 文本型, , , 
.局部变量 时间, 日期时间型, , , 

赋值 (时间, 取现行时间 ())

赋值 (年, 到文本 (取年份 (时间)))
赋值 (月, 到文本 (取月份 (时间)))
赋值 (日, 到文本 (取日 (时间)))

.如果 (等于 (是否分割, 真))
    返回 (相加 (年, “-”, 月, “-”, 日))
.否则
    返回 (相加 (年, 月, 日, “-”))
.如果结束
返回 (“0”)




.子程序 到标准日期111111111, 文本型, , 
.参数 年月日, 整数型, , 1=年 2=月 3=日

.局部变量 年, 文本型, , , 
.局部变量 月, 文本型, , , 
.局部变量 日, 文本型, , , 
.局部变量 时间, 日期时间型, , , 

赋值 (时间, 历史账单..今天)
赋值 (年, 到文本 (取年份 (时间)))
赋值 (月, 到文本 (取月份 (时间)))
赋值 (日, 到文本 (取日 (时间)))

.如果真 (等于 (年月日, 3))
    返回 (相加 (年, “-”, 月, “-”, 日))
.如果真结束

.如果真 (等于 (年月日, 2))
    返回 (相加 (年, “-”, 月, “-”))
.如果真结束

.如果真 (等于 (年月日, 1))
    返回 (相加 (年, “-”))
.如果真结束

返回 (相加 (年, “-”, 月, “-”, 日))

.子程序 生成单据编号, 空白型, , 
.局部变量 编号, 文本型, , , 
.局部变量 单据时间, 文本型, , , 
.局部变量 序号, 文本型, , , 

赋值 (单据时间, 相加 (“GS”, 到标准日期 (假)))

赋值 (序号, “1”)

.判断循环首 (真)
    _启动窗口.未知支持库函数_14 (., 相加 (“select 单据编号 from 销售表 where 单据编号='”, 单据时间, 序号, “'”), #)
    .如果真 (等于 (_启动窗口.., 0))
        _启动窗口.未知支持库函数_16 (.)
        跳出循环 ()
    .如果真结束
    _启动窗口.未知支持库函数_16 (.)
    赋值 (序号, 到文本 (相加 (到数值 (序号), 1)))
.判断循环尾 ()

赋值 (.标题, 相加 (单据时间, 序号))


.子程序 _高级表格1_列宽被改变, 空白型, , 
.参数 列号, 整数型, , 

 ' 编辑框5.内容 ＝ 到文本 (高级表格1.取列宽 (0)) ＋ #换行符 ＋ 到文本 (高级表格1.取列宽 (1)) ＋ #换行符 ＋ 到文本 (高级表格1.取列宽 (2)) ＋ #换行符 ＋ 到文本 (高级表格1.取列宽 (3)) ＋ #换行符 ＋ 到文本 (高级表格1.取列宽 (4)) ＋ #换行符 ＋ 到文本 (高级表格1.取列宽 (5)) ＋ #换行符 ＋ 到文本 (高级表格1.取列宽 (6))


.子程序 _挂单_被选择, 空白型, , 
_按钮2_被单击 ()


.子程序 _录入框_被选择, 空白型, , 
获取焦点 ()


.子程序 _优惠_被选择, 空白型, , 
获取焦点 ()


.子程序 _付款_被选择, 空白型, , 
获取焦点 ()


.子程序 _编辑框3_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 商品存储, 商品格式, , , 
.局部变量 SQL, 文本型, , , 
.局部变量 行号, 整数型, , , 

赋值 (_启动窗口., 1)
.如果真 (等于 (键代码, #回车键))
    赋值 (是否是选择, 真)
    赋值 (选择码, 删首尾空 (.内容))
    .如果 (等于 (选择码, “”))
        载入 (资料选择, 销售窗口, 真)
    .否则
        
        赋值 (SQL, 相加 (“select * from 商品资料 where 备注 LIKE '%”, 选择码, “%'”))
        调试输出 (SQL)
        _启动窗口.未知支持库函数_14 (., SQL, #)
        .如果 (等于 (_启动窗口.., 1))
            _启动窗口.未知支持库函数_26 (., “名称”, 商品存储.商品名称)
            _启动窗口.未知支持库函数_26 (., “规格”, 商品存储.规格)
            _启动窗口.未知支持库函数_26 (., “单位”, 商品存储.单位)
            _启动窗口.未知支持库函数_28 (., “单价”, 商品存储.单价)
            _启动窗口.未知支持库函数_26 (., “供货商”, 商品存储.供货商)
            加入表格 (商品存储)
            _启动窗口.未知支持库函数_16 (.)
            返回 ()
        .否则
            
        .如果结束
        
        赋值 (SQL, 相加 (“select * from 商品资料 where 拼音码 LIKE '%”, 选择码, “%'”))
        调试输出 (SQL)
        _启动窗口.未知支持库函数_14 (., SQL, #)
        .如果 (等于 (_启动窗口.., 1))
            _启动窗口.未知支持库函数_26 (., “名称”, 商品存储.商品名称)
            _启动窗口.未知支持库函数_26 (., “规格”, 商品存储.规格)
            _启动窗口.未知支持库函数_26 (., “单位”, 商品存储.单位)
            _启动窗口.未知支持库函数_28 (., “单价”, 商品存储.单价)
            加入表格 (商品存储)
            _启动窗口.未知支持库函数_16 (.)
            返回 ()
        .否则
            
        .如果结束
        
        赋值 (SQL, 相加 (“select * from 商品资料 where 名称 LIKE '%”, 选择码, “%'”))
        调试输出 (SQL)
        _启动窗口.未知支持库函数_14 (., SQL, #)
        .如果 (等于 (_启动窗口.., 1))
            _启动窗口.未知支持库函数_26 (., “名称”, 商品存储.商品名称)
            _启动窗口.未知支持库函数_26 (., “规格”, 商品存储.规格)
            _启动窗口.未知支持库函数_26 (., “单位”, 商品存储.单位)
            _启动窗口.未知支持库函数_28 (., “单价”, 商品存储.单价)
            加入表格 (商品存储)
            _启动窗口.未知支持库函数_16 (.)
            返回 ()
        .否则
            
        .如果结束
        
        载入 (资料选择, 销售窗口, 真)
    .如果结束
    
    返回 ()
.如果真结束

.如果真 (等于 (键代码, #上光标键))
    相减 (未知支持库函数_3 (), 1).未知支持库函数_0 (0)
    返回 ()
.如果真结束

.如果真 (等于 (键代码, #下光标键))
    相加 (未知支持库函数_3 (), 1).未知支持库函数_0 (0)
    返回 ()
.如果真结束

.如果真 (等于 (键代码, #Del键))
    赋值 (行号, 未知支持库函数_3 ())
    未知支持库函数_3 ().未知支持库函数_36 ()
    行号.未知支持库函数_0 (0)
    表格统计功能 ()
    刷新序号 ()
    
.如果真结束


.子程序 加入表格, 空白型, , 
.参数 商品名称, 商品格式, , 

赋值 (., 相加 (., 1))

相减 (., 1).未知支持库函数_9 (1, #., 商品名称.商品名称)
相减 (., 1).未知支持库函数_9 (2, #., 商品名称.供货商)

相减 (., 1).未知支持库函数_9 (3, #., 商品名称.规格)

相减 (., 1).未知支持库函数_9 (4, #., 商品名称.单位)

相减 (., 1).未知支持库函数_9 (5, #., 1)

相减 (., 1).未知支持库函数_9 (6, #., 到文本 (商品名称.单价))
相减 (., 1).未知支持库函数_9 (7, #., 到文本 (商品名称.单价))


刷新序号 ()
赋值 (.内容, “”)
相减 (., 1).未知支持库函数_0 (0)
赋值 (.被选择字符数, 取文本长度 (.内容))
表格统计功能 ()

.子程序 刷新序号, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 计次结束, 整数型, , , 

赋值 (计次, 1)
赋值 (计次结束, .)
.判断循环首 (小于 (计次, 计次结束))
    计次.未知支持库函数_9 (0, #., 计次)
    
    赋值 (计次, 相加 (计次, 1))
.判断循环尾 ()


.子程序 表格统计功能, 空白型, , 
.局部变量 计次1, 整数型, , , 
.局部变量 计次2, 整数型, , , 
.局部变量 计次3, 整数型, , , 
.局部变量 是否是唯一, 逻辑型, , , 真为唯一，假为重复
.局部变量 种类数, 整数型, , , 
.局部变量 匿名局部变量_734, 空白型, , , 
.局部变量 商品总数, 整数型, , , 
.局部变量 总价格, 小数型, , , 


 ' 未知支持库函数_3 ().未知支持库函数_9 (7, #., 到文本 (相乘 (到数值 (未知支持库函数_3 ().未知支持库函数_10 (5)), 到数值 (未知支持库函数_3 ().未知支持库函数_10 (6)))))

赋值 (计次1, 1)
赋值 (种类数, 0)
赋值 (商品总数, 0)
赋值 (总价格, 0)
.判断循环首 (小于 (计次1, .))
    赋值 (计次2, 1)
    赋值 (是否是唯一, 真)
    .判断循环首 (小于 (计次2, 计次1))
        .如果真 (等于 (计次2.未知支持库函数_10 (1), 计次1.未知支持库函数_10 (1)))
            赋值 (是否是唯一, 假)
        .如果真结束
        
        赋值 (计次2, 相加 (计次2, 1))
    .判断循环尾 ()
    .如果真 (等于 (是否是唯一, 真))
        赋值 (种类数, 相加 (种类数, 1))
    .如果真结束
    
    赋值 (商品总数, 相加 (商品总数, 到数值 (计次1.未知支持库函数_10 (4))))
    
    赋值 (总价格, 相加 (总价格, 到数值 (计次1.未知支持库函数_10 (7))))
    
    赋值 (计次1, 相加 (计次1, 1))
.判断循环尾 ()
赋值 (.标题, 到文本 (种类数))
赋值 (.标题, 到文本 (商品总数))
赋值 (.标题, 到文本 (总价格))
赋值 (.标题, .标题)
赋值 (.内容, .标题)
赋值 (.标题, “0”)


.子程序 _按钮2_被单击, 空白型, , 
.如果真 (等于 (., 1))
    销售窗口.未知支持库函数_26 (., 相减 (销售窗口..左边, 30), 相减 (销售窗口., 50), “<font>没有录入商品资料，不能挂单</font>”, -1, )
    返回 ()
.如果真结束

相加 (取运行目录 (), “\temp\”, 到文本 (取现行时间 ()), “.XL”).未知支持库函数_55 ()
信息框 (“已存入暂挂单”, 0, )
赋值 (., 1)
初始化销售单 ()


.子程序 初始化销售单, 空白型, , 
生成单据编号 ()
赋值 (.标题, “”)
赋值 (.标题, “”)
赋值 (.标题, “0”)
赋值 (.标题, “0”)
赋值 (.内容, “0”)
赋值 (.标题, “0”)
赋值 (.内容, “0”)

.子程序 _按钮3_被单击, 空白型, , 
载入 (选取暂挂单, 销售窗口, 真)

.子程序 _按钮1_被单击, 空白型, , 
.如果真 (等于 (., 1))
    销售窗口.未知支持库函数_26 (., 相减 (销售窗口..左边, 30), 相减 (销售窗口., 50), “<font>没有录入商品资料，无法过账</font>”, -1, )
    返回 ()
.如果真结束

.如果真 (小于 (到数值 (.内容), 到数值 (.标题)))
    销售窗口.未知支持库函数_26 (., 相减 (销售窗口..左边, 30), 相减 (销售窗口., 50), “<font>付款金额必须大于应付款</font>”, -1, )
    返回 ()
.如果真结束

.如果真 (小于 (到数值 (.内容), 0))
    销售窗口.未知支持库函数_26 (., 相减 (销售窗口..左边, 30), 相减 (销售窗口., 50), “<font>优惠金额不能是负数</font>”, -1, )
    返回 ()
.如果真结束

写入资料 ()

.子程序 _编辑框3_内容被改变, 空白型, , 
.局部变量 单价, 小数型, , , 
.局部变量 总价, 小数型, , , 

.如果真 (等于 (.内容, “”))
    返回 ()
.如果真结束

.如果真 (等于 (取文本右边 (.内容, 1), “-”))
    .如果真 (大于 (到数值 (取文本左边 (.内容, 相减 (取文本长度 (.内容), 1))), 0))
        未知支持库函数_3 ().未知支持库函数_9 (6, #., 到文本 (到数值 (取文本左边 (.内容, 相减 (取文本长度 (.内容), 1)))))
        赋值 (.内容, “”)
    .如果真结束
    
    表格统计功能 ()
    返回 ()
.如果真结束


.如果真 (等于 (取文本右边 (.内容, 1), “+”))
    .如果真 (大于 (到数值 (取文本左边 (.内容, 相减 (取文本长度 (.内容), 1))), 0))
        未知支持库函数_3 ().未知支持库函数_9 (5, #., 到文本 (到数值 (取文本左边 (.内容, 相减 (取文本长度 (.内容), 1)))))
        赋值 (.内容, “”)
    .如果真结束
    
    表格统计功能 ()
    返回 ()
.如果真结束

.如果真 (等于 (取文本右边 (.内容, 1), “/”))
    .如果真 (大于 (到数值 (取文本左边 (.内容, 相减 (取文本长度 (.内容), 1))), 0))
        赋值 (单价, 到数值 (未知支持库函数_3 ().未知支持库函数_10 (6)))
        赋值 (总价, 到数值 (取文本左边 (.内容, 相减 (取文本长度 (.内容), 1))))
        调试输出 (总价)
        调试输出 (单价)
        调试输出 (相除 (总价, 单价))
        未知支持库函数_3 ().未知支持库函数_9 (5, #., 到文本 (四舍五入 (相除 (总价, 单价), 2)))
        
        表格统计功能 ()
        赋值 (.内容, “”)
        表格统计功能 ()
        返回 ()
        
    .如果真结束
    
.如果真结束


.子程序 _备注_被选择, 空白型, , 
获取焦点 ()


.子程序 居中文本, 文本型, , 
.参数 文本, 文本型, , 

.局部变量 填充空格次数, 整数型, , , 
.局部变量 填充计次, 整数型, , , 

.如果真 (小于或等于 (取文本长度 (文本), 30))
    赋值 (填充空格次数, 相减 (30, 取文本长度 (文本)))
    赋值 (填充空格次数, 相加 (相乘 (填充空格次数, 0.5), 1))
    赋值 (填充计次, 0)
    .判断循环首 (小于 (填充计次, 填充空格次数))
        赋值 (文本, 相加 (“ ”, 文本, “ ”))
        赋值 (填充计次, 相加 (填充计次, 1))
    .判断循环尾 ()
    返回 (文本)
.如果真结束
返回 (文本)



.子程序 加入指定空格, 文本型, , 
.参数 文本, 文本型, , 
.参数 最大长度, 整数型, , 

.局部变量 空格计次, 整数型, , , 
.局部变量 空格结束, 整数型, , , 

.如果 (大于或等于 (取文本长度 (文本), 最大长度))
    返回 (取文本左边 (文本, 最大长度))
.否则
    
    赋值 (空格计次, 0)
    赋值 (空格结束, 相减 (最大长度, 取文本长度 (文本)))
    .判断循环首 (小于 (空格计次, 空格结束))
        赋值 (文本, 相加 (文本, “ ”))
        赋值 (空格计次, 相加 (空格计次, 1))
    .判断循环尾 ()
    返回 (文本)
.如果结束

返回 (取文本左边 (文本, 最大长度))

.子程序 规范销售明细, 文本型, , 
.参数 商品名称, 文本型, , 
.参数 单价, 文本型, , 
.参数 数量, 文本型, , 
.参数 小计, 文本型, , 

.局部变量 返回内容, 文本型, , , 

返回 (相加 (加入指定空格 (商品名称, 10), “|”, 加入指定空格 (单价, 5), “|”, 加入指定空格 (数量, 5), “|”, 加入指定空格 (小计, 6)))


.子程序 删除数量后面的小数点和零, 文本型, , 
.参数 文本, 文本型, , 

 ' .判断循环首 (真)
     ' .如果 (或者 (等于 (取文本右边 (文本, 1), “0”), 等于 (取文本右边 (文本, 1), “.”)))
         ' 文本 ＝ 取文本左边 (文本, 取文本长度 (文本) － 1)
    .否则
        
         ' 返回 (文本)
    .如果结束
    
 ' .判断循环尾 ()
返回 (文本)

.子程序 写入资料, 空白型, , 
.局部变量 计次1, 整数型, , , 
.局部变量 计次2, 整数型, , , 
.局部变量 SQL, 文本型, , , 
.局部变量 SQL2, 文本型, , , 
.局部变量 匿名局部变量_818, 空白型, , , 
.局部变量 商品名称, 文本型, , , 
.局部变量 规格, 文本型, , , 
.局部变量 数量, 文本型, , , 
.局部变量 单价, 文本型, , , 
.局部变量 单位, 文本型, , , 
.局部变量 销售时间, 文本型, , , 
.局部变量 单据编号, 文本型, , , 
.局部变量 供货商, 文本型, , , 
.局部变量 小计, 小数型, , , 

赋值 (打印内容, “”)

相减 (., 1).未知支持库函数_0 (0)
.如果真 (等于 (到数值 (.内容), 0))
    赋值 (.内容, “0”)
.如果真结束

获取焦点 ()

赋值 (销售时间, 到标准时间 ())
赋值 (单据编号, .标题)

赋值 (SQL2, 相加 (“'”, 单据编号, “',”, .内容, “,”, .标题, “,”, .标题, “,”, .内容, “,'”, 销售时间, “','”, 转义特殊字符 (.内容), “'”))
赋值 (SQL, 相加 (“insert into 单据表(单据编号,付款,找零,总金额,优惠,GZSJ,备注) values(”, SQL2, “)”))
.如果真 (等于 (_启动窗口.未知支持库函数_4 (., SQL), 假))
    调试输出 (SQL)
    赋值 (., 1)
    获取焦点 ()
    初始化销售单 ()
    信息框 (“写入数据库失败，请重新录入销售数据！”, 0, )
    返回 ()
.如果真结束

加入打印文本 (相加 (居中文本 (打印标题1), #换行符, 居中文本 (打印标题2), #换行符))

赋值 (计次1, 1)
赋值 (计次2, 相减 (., 1))
加入打印文本 (相加 (“销售时间：”, 销售时间))
加入打印文本 (相加 (“单据编号：”, .标题, #换行符, “━━━━━━━━━━━━━━━”))
加入打印文本 (“ 商品名称 |单价 |数量 | 小计 |”)
加入打印文本 (“━━━━━━━━━━━━━━━”)
.判断循环首 (小于或等于 (计次1, 计次2))
    赋值 (商品名称, 转义特殊字符 (计次1.未知支持库函数_10 (1)))
    赋值 (规格, 转义特殊字符 (计次1.未知支持库函数_10 (3)))
    赋值 (单位, 转义特殊字符 (计次1.未知支持库函数_10 (4)))
    赋值 (数量, 计次1.未知支持库函数_10 (5))
    赋值 (单价, 计次1.未知支持库函数_10 (6))
    赋值 (供货商, 计次1.未知支持库函数_10 (2))
    赋值 (小计, 相乘 (到数值 (数量), 到数值 (单价)))
    
    赋值 (SQL2, 相加 (“'”, 商品名称, “','”, 规格, “',”, 数量, “,”, 单价, “,'”, 销售时间, “','”, 单据编号, “','”, 单位, “','”, 供货商, “'”))
    赋值 (SQL, 相加 (“insert into 销售表(商品名称,规格,数量,单价,XSSJ,单据编号,单位,供货商) values(”, SQL2, “)”))
    
     ' 加入打印文本 (规范销售明细 (商品名称, 单价, 删除数量后面的小数点和零 (数量), 数值到格式文本 (小计, 2, 假)))
    
    调试输出 (SQL)
    _启动窗口.未知支持库函数_4 (., SQL)
    赋值 (计次1, 相加 (计次1, 1))
.判断循环尾 ()
加入打印文本 (“━━━━━━━━━━━━━━━”)
加入打印文本 (相加 (“总计：”, .标题, “元”))
 ' 加入打印文本 (“优惠：” ＋ 编辑框1.内容 ＋ “元”)
加入打印文本 (相加 (“需付款：”, .标题, “元”))
加入打印文本 (“━━━━━━━━━━━━━━━”)
加入打印文本 (相加 (“付款：”, .内容, “元”))
加入打印文本 (相加 (“找零：”, .标题, “元”))
加入打印文本 (“━━━━━━━━━━━━━━━”)
加入打印文本 (打印标题3)
加入打印文本 (打印标题4)
输出到打印机 ()
赋值 (., 1)
获取焦点 ()
初始化销售单 ()

.子程序 加入打印文本, 空白型, , 
.参数 要加入的文本, 文本型, , 

赋值 (打印内容, 相加 (打印内容, 要加入的文本, #换行符))

.子程序 输出到打印机, 空白型, , 

_启动窗口.开始打印 (., 假, 假, , , , )
_启动窗口.写文本行 (., 打印内容)
调试输出 (打印内容)
_启动窗口.结束打印 (.)

.子程序 转义特殊字符, 文本型, , 
.参数 文本, 文本型, , 

赋值 (文本, 子文本替换 (文本, “'”, “”, 1, , 真))
赋值 (文本, 子文本替换 (文本, “\”, “”, 1, , 真))
赋值 (文本, 子文本替换 (文本, #引号, 相加 (“”, #引号), 1, , 真))
赋值 (文本, 子文本替换 (文本, #换行符, “”, 1, , 真))
返回 (文本)


.子程序 _过账_被选择, 空白型, , 
_按钮1_被单击 ()


.子程序 _提单_被选择, 空白型, , 
_按钮3_被单击 ()


.子程序 _编辑框1_内容被改变, 空白型, , 
赋值 (.标题, 到文本 (相减 (到数值 (.标题), 到数值 (.内容))))
赋值 (.内容, .标题)


.子程序 _编辑框2_获得焦点, 空白型, , 
赋值 (.内容, “”)


.子程序 _编辑框2_内容被改变, 空白型, , 
赋值 (.标题, 到文本 (相减 (到数值 (.内容), 到数值 (.标题))))


.子程序 _按钮4_被单击, 空白型, , 
赋值 (., 真)

未知支持库函数_27 ()


.子程序 _销售窗口_将被销毁, 空白型, , 
未知支持库函数_57 ()


.窗口程序集 窗口程序集5, , , 

.子程序 _选取暂挂单_创建完毕, 空白型, , 
子程序1 ()

.子程序 子程序1, 空白型, , 
.局部变量 文件目录, 文本型, , , 
.局部变量 文件名, 文本型, , , 

赋值 (文件目录, 相加 (取运行目录 (), “\temp”))
赋值 (文件目录, 选择 (不等于 (取文本右边 (文件目录, 1), “\”), 相加 (文件目录, “\”), 文件目录))

赋值 (文件名, 寻找文件 (相加 (文件目录, “*.*”), 32))
.判断循环首 (不等于 (文件名, “”))
    .如果真 (并且 (不等于 (文件名, “.”), 不等于 (文件名, “..”)))
        相加 (文件目录, 文件名).加入项目 ()
    .如果真结束
    赋值 (文件名, 寻找文件 ())
.判断循环尾 ()
赋值 (.现行选中项, 0)
.如果真 (等于 (取项目数 (), 0))
    销毁 ()
    销售窗口.未知支持库函数_26 (., 相减 (销售窗口..左边, 30), 相减 (销售窗口., 50), “<font>当前没有暂挂单</font>”, -1, )
    
.如果真结束


.子程序 _显示结果列表框_列表项被选择, 空白型, , 


.子程序 _按钮1_被单击, 空白型, , 
.如果真 (大于 (销售窗口.., 1))
    .如果真 (不等于 (信息框 (相加 (“当前销售单中有数据，不能提单。”, #换行符, “请销售单中的进行 挂单/删除/过账 后在进行提单。”), #警告图标, “询问？”), 5))
        返回 ()
    .如果真结束
    
.如果真结束

销售窗口.未知支持库函数_56 (., .取项目文本 (.现行选中项))
删除文件 (.取项目文本 (.现行选中项))

表格统计功能 ()

销毁 ()


.子程序 _按钮3_被单击, 空白型, , 
.如果真 (不等于 (信息框 (相加 (“你确定要删除【”, .取项目文本 (.现行选中项), “】暂挂单吗？”), 相加 (4, #询问图标), “询问？”), 5))
    返回 ()
.如果真结束

删除文件 (.取项目文本 (.现行选中项))
清空 ()
子程序1 ()


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()


.窗口程序集 窗口程序集6, , , 

.子程序 _历史账单_创建完毕, 空白型, , 
赋值 (年月日, 3)
查询到超级表格 ()
赋值 (.标题, 返回查询标题 (.今天))

.子程序 查询到超级表格, 空白型, , 
.局部变量 计次1, 整数型, , , 
.局部变量 计次2, 整数型, , , 
.局部变量 时间1, 文本型, , , 
.局部变量 时间2, 文本型, , , 
.局部变量 匿名局部变量_898, 空白型, , , 
.局部变量 临时文本, 文本型, , , 
.局部变量 匿名局部变量_930, 空白型, , , 
.局部变量 计算, 小数型, , , 
.局部变量 匿名局部变量_955, 空白型, , , 
.局部变量 SQL, 文本型, , , 
.局部变量 匿名局部变量_986, 空白型, , , 
.局部变量 总计, 小数型, , , 
.局部变量 优惠, 小数型, , , 
.局部变量 红冲, 整数型, , , 
.局部变量 是否有效, 逻辑型, , , 

全部删除 ()
赋值 (时间1, 到标准日期111111111 (年月日))

调试输出 (时间1)

赋值 (SQL, 相加 (“select * from 单据表 where GZSJ LIKE '”, 时间1, “%'”))
调试输出 (SQL)
_启动窗口.未知支持库函数_14 (., SQL, #)

赋值 (计次2, _启动窗口..)
赋值 (计次1, 1)

.判断循环首 (小于或等于 (计次1, 计次2))
    
    -1.插入表项 (到文本 (计次1), , , , )
    _启动窗口.未知支持库函数_26 (., “GZSJ”, 临时文本)
    相减 (取表项数 (), 1).置标题 (1, 临时文本)
    
    _启动窗口.未知支持库函数_26 (., “YXX”, 临时文本)
    .如果 (等于 (临时文本, “Y”))
        相减 (取表项数 (), 1).置图片 (0, 0)
        相减 (取表项数 (), 1).置标题 (9, “Y”)
        赋值 (是否有效, 真)
    .否则
        
        赋值 (红冲, 相加 (红冲, 1))
        相减 (取表项数 (), 1).置图片 (0, 1)
        相减 (取表项数 (), 1).置标题 (9, “N”)
        赋值 (是否有效, 假)
    .如果结束
    
    
    _启动窗口.未知支持库函数_26 (., “单据编号”, 临时文本)
    
    相减 (取表项数 (), 1).置标题 (2, 临时文本)
    
    _启动窗口.未知支持库函数_26 (., “总金额”, 临时文本)
    
    .如果真 (等于 (是否有效, 真))
        赋值 (总计, 相加 (总计, 到数值 (临时文本)))
    .如果真结束
    赋值 (计算, 到数值 (临时文本))
    
    相减 (取表项数 (), 1).置标题 (3, 临时文本)
    
    _启动窗口.未知支持库函数_26 (., “优惠”, 临时文本)
    赋值 (计算, 相减 (计算, 到数值 (临时文本)))
    
    .如果真 (等于 (是否有效, 真))
        赋值 (优惠, 相加 (优惠, 到数值 (临时文本)))
    .如果真结束
    
    相减 (取表项数 (), 1).置标题 (4, 临时文本)
    
    相减 (取表项数 (), 1).置标题 (5, 到文本 (计算))
    
    _启动窗口.未知支持库函数_26 (., “付款”, 临时文本)
    相减 (取表项数 (), 1).置标题 (6, 临时文本)
    
    
    
    _启动窗口.未知支持库函数_26 (., “找零”, 临时文本)
    相减 (取表项数 (), 1).置标题 (7, 临时文本)
    
    _启动窗口.未知支持库函数_26 (., “备注”, 临时文本)
    相减 (取表项数 (), 1).置标题 (8, 临时文本)
    
    赋值 (计次1, 相加 (计次1, 1))
    _启动窗口.未知支持库函数_36 (.)
.判断循环尾 ()

-1.插入表项 ()
相减 (取表项数 (), 1).置标题 (2, “合计：”)
相减 (取表项数 (), 1).置标题 (3, 到文本 (总计))
相减 (取表项数 (), 1).置标题 (4, 到文本 (优惠))
相减 (取表项数 (), 1).置标题 (5, 到文本 (相减 (总计, 优惠)))
相减 (取表项数 (), 1).置标题 (9, 到文本 (红冲))

赋值 (.标题, 到文本 (总计))
赋值 (.标题, 到文本 (优惠))
赋值 (.标题, 到文本 (相减 (总计, 优惠)))
赋值 (.标题, 到文本 (红冲))

_启动窗口.未知支持库函数_16 (.)

.子程序 _按钮1_被单击, 空白型, , 
赋值 (年月日, 2)
查询到超级表格 ()


.子程序 _超级列表框1_左键单击表项, 空白型, , 
填充详情 (.取标题 (., 2))

.子程序 填充详情, 空白型, , 
.参数 编号, 文本型, , 

.局部变量 计次, 整数型, , , 
.局部变量 临时文本, 文本型, , , 
.局部变量 合计, 小数型, , , 
.局部变量 总计, 小数型, , , 

全部删除 ()
赋值 (总计, 0)
_启动窗口.未知支持库函数_14 (., 相加 (“select * from 销售表 where 单据编号='”, 编号, “'”), #)
赋值 (计次, 1)
.判断循环首 (小于或等于 (计次, _启动窗口..))
    赋值 (合计, 0)
    
    -1.插入表项 (到文本 (计次), , , , )
    
    _启动窗口.未知支持库函数_26 (., “商品名称”, 临时文本)
    相减 (取表项数 (), 1).置标题 (1, 临时文本)
    
    _启动窗口.未知支持库函数_26 (., “供货商”, 临时文本)
    相减 (取表项数 (), 1).置标题 (2, 临时文本)
    
    _启动窗口.未知支持库函数_26 (., “规格”, 临时文本)
    相减 (取表项数 (), 1).置标题 (3, 临时文本)
    
    _启动窗口.未知支持库函数_26 (., “单位”, 临时文本)
    相减 (取表项数 (), 1).置标题 (4, 临时文本)
    
    _启动窗口.未知支持库函数_26 (., “数量”, 临时文本)
    相减 (取表项数 (), 1).置标题 (5, 临时文本)
    赋值 (合计, 到数值 (临时文本))
    
    _启动窗口.未知支持库函数_26 (., “单价”, 临时文本)
    相减 (取表项数 (), 1).置标题 (6, 临时文本)
    赋值 (合计, 相乘 (合计, 到数值 (临时文本)))
    赋值 (总计, 相加 (总计, 合计))
    相减 (取表项数 (), 1).置标题 (7, 到文本 (合计))
    
    _启动窗口.未知支持库函数_36 (.)
    赋值 (计次, 相加 (计次, 1))
.判断循环尾 ()
-1.插入表项 ()
相减 (取表项数 (), 1).置标题 (6, “总计：”)
相减 (取表项数 (), 1).置标题 (7, 到文本 (总计))

相减 (取表项数 (), 1).置标题 (4, “单据编号：”)
相减 (取表项数 (), 1).置标题 (5, 编号)

.如果 (等于 (.取标题 (., 9), “Y”))
    相减 (取表项数 (), 1).置标题 (0, “有效”)
.否则
    相减 (取表项数 (), 1).置标题 (0, “无效”)
.如果结束

相减 (取表项数 (), 1).置标题 (1, “过账时间”)
相减 (取表项数 (), 1).置标题 (2, .取标题 (., 1))

_启动窗口.未知支持库函数_16 (.)

.子程序 _超级列表框1_右键单击表项, 空白型, , 
.如果真 (大于或等于 (., 0))
    .如果 (等于 (.取标题 (., 9), “Y”))
        .弹出菜单 ()
    .否则
        .弹出菜单 ()
    .如果结束
    
.如果真结束


.子程序 _红字反冲_被选择, 空白型, , 
.局部变量 SQL, 文本型, , , 

.如果真 (等于 (信息框 (相加 (“您确定要对单据【”, .取标题 (., 2), “】进行红字反冲吗？”), 相加 (4, #询问图标), “提示：”), 5))
    赋值 (SQL, 相加 (“update 单据表 set YXX='N' where 单据编号='”, .取标题 (., 2), “'”))
    _启动窗口.未知支持库函数_4 (., SQL)
    查询到超级表格 ()
.如果真结束



.子程序 _取消红字反冲_被选择, 空白型, , 
.局部变量 SQL, 文本型, , , 

.如果真 (等于 (信息框 (相加 (“您确定要对单据【”, .取标题 (., 2), “】取消红字反冲吗？”), 相加 (4, #询问图标), “提示：”), 5))
    赋值 (SQL, 相加 (“update 单据表 set YXX='Y' where 单据编号='”, .取标题 (., 2), “'”))
    
    _启动窗口.未知支持库函数_4 (., SQL)
    查询到超级表格 ()
    
.如果真结束


.子程序 _打印单据列表_被选择, 空白型, , 
打印单据列表 ()


.子程序 打印单据列表, 空白型, , 
.局部变量 aa, 整数型, , "9", 

赋值 (aa [1], 0)
赋值 (aa [2], 1)
赋值 (aa [3], 2)
赋值 (aa [4], 3)
赋值 (aa [5], 4)
赋值 (aa [6], 5)
赋值 (aa [7], 6)
赋值 (aa [8], 7)
赋值 (aa [9], 8)
 ' 打印预览 (“商品销售报表”, 真, aa)


.子程序 _打印11_被选择, 空白型, , 
打印单据列表 ()

.子程序 _打印详单_被选择, 空白型, , 
.局部变量 aa, 整数型, , "7", 

赋值 (aa [1], 0)
赋值 (aa [2], 1)
赋值 (aa [3], 2)
赋值 (aa [4], 3)
赋值 (aa [5], 4)
赋值 (aa [6], 5)
赋值 (aa [7], 6)
打印预览 (相加 (“商品销售明细(”, .取标题 (., 2), “)”), 真, aa)

.子程序 _超级列表框2_右键单击表项, 空白型, , 
弹出菜单 ()


.子程序 _日期框1_选择日期被改变, 空白型, , 
赋值 (年月日, 3)
赋值 (.标题, 返回查询标题 (.今天))
查询到超级表格 ()

.子程序 返回查询标题, 文本型, , 
.参数 日期时间, 日期时间型, , 

.局部变量 今天时间文本, 文本型, , , 
.局部变量 开始时间, 文本型, , , 

赋值 (今天时间文本, 相加 (到文本 (取年份 (日期时间)), “年”, 到文本 (取月份 (日期时间)), “月”, 到文本 (取日 (日期时间)), “日”))
赋值 (日期时间, 增减时间 (日期时间, #日, -9))
赋值 (开始时间, 相加 (到文本 (取年份 (日期时间)), “年”, 到文本 (取月份 (日期时间)), “月”, 到文本 (取日 (日期时间)), “日”))
返回 (相加 (“查询”, 开始时间, “到”, 今天时间文本, “10天内数据”))


.子程序 _按钮2_被单击, 空白型, , 
赋值 (年月日, 1)
查询到超级表格 ()

.子程序 _导出到Excel1_被选择, 空白型, , 
超级列表框到EXCEL_自定义 (“单据详情”)


.子程序 _导出到Excel_被选择, 空白型, , 
超级列表框到EXCEL_自定义 (“销售详情”)

.子程序 _导出到Excel3_被选择, 空白型, , 
超级列表框到EXCEL_自定义 (“单据详情”)


.子程序 _按钮3_被单击, 空白型, , 
.局部变量 计次1, 整数型, , , 
.局部变量 计次2, 整数型, , , 
.局部变量 时间1, 文本型, , , 
.局部变量 时间2, 文本型, , , 
.局部变量 匿名局部变量_1643, 空白型, , , 
.局部变量 临时文本, 文本型, , , 
.局部变量 匿名局部变量_1645, 空白型, , , 
.局部变量 计算, 小数型, , , 
.局部变量 匿名局部变量_1647, 空白型, , , 
.局部变量 SQL, 文本型, , , 
.局部变量 匿名局部变量_1649, 空白型, , , 
.局部变量 总计, 小数型, , , 
.局部变量 优惠, 小数型, , , 
.局部变量 红冲, 整数型, , , 
.局部变量 是否有效, 逻辑型, , , 
.局部变量 匿名局部变量_1664, 空白型, , , 
.局部变量 时间计次, 整数型, , , 
.局部变量 当前时间, 日期时间型, , , 
.局部变量 序号计次, 整数型, , , 

全部删除 ()

赋值 (时间1, 到标准日期111111111 (年月日))

调试输出 (时间1)
赋值 (序号计次, 1)
赋值 (时间计次, -9)
.判断循环首 (小于或等于 (时间计次, 0))
    赋值 (当前时间, 增减时间 (.今天, #日, 时间计次))
    赋值 (时间1, 相加 (到文本 (取年份 (当前时间)), “-”, 到文本 (取月份 (当前时间)), “-”, 到文本 (取日 (当前时间))))
    调试输出 (时间1)
    
    赋值 (SQL, 相加 (“select * from 单据表 where GZSJ LIKE '”, 时间1, “%'”))
    调试输出 (SQL)
    _启动窗口.未知支持库函数_14 (., SQL, #)
    
    赋值 (计次2, _启动窗口..)
    赋值 (计次1, 1)
    
    .判断循环首 (小于或等于 (计次1, 计次2))
        
        -1.插入表项 (到文本 (序号计次), , , , )
        赋值 (序号计次, 相加 (序号计次, 1))
        _启动窗口.未知支持库函数_26 (., “GZSJ”, 临时文本)
        相减 (取表项数 (), 1).置标题 (1, 临时文本)
        
        _启动窗口.未知支持库函数_26 (., “YXX”, 临时文本)
        .如果 (等于 (临时文本, “Y”))
            相减 (取表项数 (), 1).置图片 (0, 0)
            相减 (取表项数 (), 1).置标题 (9, “Y”)
            赋值 (是否有效, 真)
        .否则
            
            赋值 (红冲, 相加 (红冲, 1))
            相减 (取表项数 (), 1).置图片 (0, 1)
            相减 (取表项数 (), 1).置标题 (9, “N”)
            赋值 (是否有效, 假)
        .如果结束
        
        
        _启动窗口.未知支持库函数_26 (., “单据编号”, 临时文本)
        
        相减 (取表项数 (), 1).置标题 (2, 临时文本)
        
        _启动窗口.未知支持库函数_26 (., “总金额”, 临时文本)
        
        .如果真 (等于 (是否有效, 真))
            赋值 (总计, 相加 (总计, 到数值 (临时文本)))
        .如果真结束
        赋值 (计算, 到数值 (临时文本))
        
        相减 (取表项数 (), 1).置标题 (3, 临时文本)
        
        _启动窗口.未知支持库函数_26 (., “优惠”, 临时文本)
        赋值 (计算, 相减 (计算, 到数值 (临时文本)))
        
        .如果真 (等于 (是否有效, 真))
            赋值 (优惠, 相加 (优惠, 到数值 (临时文本)))
        .如果真结束
        
        相减 (取表项数 (), 1).置标题 (4, 临时文本)
        
        相减 (取表项数 (), 1).置标题 (5, 到文本 (计算))
        
        _启动窗口.未知支持库函数_26 (., “付款”, 临时文本)
        相减 (取表项数 (), 1).置标题 (6, 临时文本)
        
        
        
        _启动窗口.未知支持库函数_26 (., “找零”, 临时文本)
        相减 (取表项数 (), 1).置标题 (7, 临时文本)
        
        _启动窗口.未知支持库函数_26 (., “备注”, 临时文本)
        相减 (取表项数 (), 1).置标题 (8, 临时文本)
        
        赋值 (计次1, 相加 (计次1, 1))
        _启动窗口.未知支持库函数_36 (.)
    .判断循环尾 ()
    
    
    赋值 (时间计次, 相加 (时间计次, 1))
.判断循环尾 ()

-1.插入表项 ()
相减 (取表项数 (), 1).置标题 (2, “合计：”)
相减 (取表项数 (), 1).置标题 (3, 到文本 (总计))
相减 (取表项数 (), 1).置标题 (4, 到文本 (优惠))
相减 (取表项数 (), 1).置标题 (5, 到文本 (相减 (总计, 优惠)))
相减 (取表项数 (), 1).置标题 (9, 到文本 (红冲))

赋值 (.标题, 到文本 (总计))
赋值 (.标题, 到文本 (优惠))
赋值 (.标题, 到文本 (相减 (总计, 优惠)))
赋值 (.标题, 到文本 (红冲))

_启动窗口.未知支持库函数_16 (.)


.子程序 _超级列表框1_当前表项被改变, 空白型, , 
填充详情 (.取标题 (., 2))


.窗口程序集 窗口程序集7, , , 

.子程序 _按钮1_被单击, 空白型, , 
打开 (相加 (取运行目录 (), “\date\pas.edb”), , , , , , , )
.如果 (不等于 (.内容, 读 (“密码”)))
    信息框 (“原始密码错误”, 0, )
    返回 ()
.否则
    
    .如果真 (不等于 (.内容, .内容))
        信息框 (“两次输入的密码不一致，请重新输入。”, 0, )
        返回 ()
    .如果真结束
    
    写 (“密码”, .内容)
    信息框 (“修改密码成功”, 0, )
    销毁 ()
    返回 ()
.如果结束
关闭 ()




.子程序 _按钮2_被单击, 空白型, , 
销毁 ()


.窗口程序集 窗口程序集8, , , 

.子程序 _图形按钮2_被单击, 空白型, , 
.如果真 (等于 (.内容, “999999”))
    销毁 ()
    赋值 (是否通过验证, 真)
    赋值 (_启动窗口..可视, 真)
    返回 ()
    
.如果真结束
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

打开 (相加 (取运行目录 (), “\date\pas.edb”), , , , , , , )
.如果 (不等于 (.内容, 读 (“密码”)))
    关闭 ()
    赋值 (是否通过验证, 假)
    信息框 (“密码错误,请重新输入。”, 相加 (0, #警告图标), )
    赋值 (.内容, “”)
    返回 ()
.否则
    
    销毁 ()
    赋值 (是否通过验证, 真)
.如果结束



.子程序 _登录窗口_创建完毕, 空白型, , 
获取焦点 ()


.子程序 _编辑框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _图形按钮2_被单击 ()
.如果真结束



.窗口程序集 窗口程序集9, , , 

.子程序 _按钮1_被单击, 空白型, , 
复制文件 (相加 (取运行目录 (), “\date\dat.mdb”), 相加 (取运行目录 (), “\date\back\清空前备份dat.mdb”))
.如果真 (等于 (信息框 (“您真的要清空数据库吗？”, 相加 (4, #询问图标), “提示：”), 5))
    _启动窗口.未知支持库函数_4 (., “delete from 销售表”)
    _启动窗口.未知支持库函数_4 (., “delete from 单据表”)
    信息框 (“数据库已经被成功清空。”, 0, )
    销毁 ()
    
.如果真结束


.窗口程序集 窗口程序集10, , , 

.子程序 _日期框1_选择日期被改变, 空白型, , 
.局部变量 销售数量, 整数型, , , 
.局部变量 收入, 小数型, , , 
.局部变量 所有商品, 文本型, , "0", 
.局部变量 所有商品规格, 文本型, , "0", 
.局部变量 所有商品单位, 文本型, , "0", 
.局部变量 匿名局部变量_1251, 空白型, , , 
.局部变量 匿名局部变量_1252, 空白型, , , 
.局部变量 鸡翅, 整数型, , , 
.局部变量 临时, 文本型, , , 

_启动窗口.未知支持库函数_14 (., “select * from 商品资料”, #)
赋值 (鸡翅, 1)
.判断循环首 (小于或等于 (鸡翅, _启动窗口..))
    _启动窗口.未知支持库函数_26 (., “名称”, 临时)
    
    赋值 (鸡翅, 相加 (鸡翅, 1))
    _启动窗口.未知支持库函数_36 (.)
.判断循环尾 ()

.程序集 共用程序集, , , 

.窗口程序集 窗口程序集11, , , 

.程序集变量 原始名称, 文本型, , , 
.子程序 _供应商_创建完毕, 空白型, , 
.如果 (等于 (供应商添加修改标记, 1))
     ' 添加
    赋值 (., “供货商资料【添加】”)
    赋值 (.标题, “添加”)
    
.否则
    
    赋值 (., “供货商资料【修改】”)
    赋值 (.标题, “修改”)
    赋值 (.内容, 资料选择.取标题 (., 资料选择.., 1))
    赋值 (.内容, 资料选择.取标题 (., 资料选择.., 2))
    赋值 (.内容, 资料选择.取标题 (., 资料选择.., 4))
    赋值 (.内容, 资料选择.取标题 (., 资料选择.., 3))
    赋值 (.内容, 资料选择.取标题 (., 资料选择.., 5))
    赋值 (原始名称, .内容)
.如果结束

获取焦点 ()


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 SQL, 文本型, , , 

.如果真 (等于 (有效性检查5555 (), 假))
    返回 ()
.如果真结束



.如果 (等于 (供应商添加修改标记, 1))
    
    赋值 (SQL, 相加 (“insert into 供货商(供货商名称,电话,地址,联系人,备注) values ('”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “')”))
    
    .如果 (等于 (_启动窗口.未知支持库函数_4 (., SQL), 假))
        调试输出 (SQL)
        信息框 (“添加供货商失败”, 0, )
        返回 ()
    .否则
        资料选择.插入表项 (., -1, 到文本 (相加 (资料选择.取表项数 (.), 1)), , , , )
        资料选择.置标题 (., 相减 (资料选择.取表项数 (.), 1), 1, .内容)
        资料选择.置标题 (., 相减 (资料选择.取表项数 (.), 1), 2, .内容)
        资料选择.置标题 (., 相减 (资料选择.取表项数 (.), 1), 3, .内容)
        资料选择.置标题 (., 相减 (资料选择.取表项数 (.), 1), 4, .内容)
        资料选择.置标题 (., 相减 (资料选择.取表项数 (.), 1), 5, .内容)
        销毁 ()
    .如果结束
    
.否则
    
    
    赋值 (SQL, 相加 (“update 供货商 set 供货商名称='”, .内容, “',电话='”, .内容, “',地址='”, .内容, “',联系人='”, .内容, “',备注='”, .内容, “' where 供货商名称='”, 原始名称, “'”))
    
    .如果 (等于 (_启动窗口.未知支持库函数_4 (., SQL), 假))
        调试输出 (SQL)
        信息框 (“修改供货商失败”, 0, )
        返回 ()
    .否则
        
        资料选择.置标题 (., 资料选择.., 1, .内容)
        资料选择.置标题 (., 资料选择.., 2, .内容)
        资料选择.置标题 (., 资料选择.., 3, .内容)
        资料选择.置标题 (., 资料选择.., 4, .内容)
        资料选择.置标题 (., 资料选择.., 5, .内容)
        销毁 ()
    .如果结束
    
.如果结束


.子程序 有效性检查5555, 逻辑型, , 返回真代表通过，假不能通过
赋值 (.内容, 删除特殊符号 (.内容))
赋值 (.内容, 删除特殊符号 (.内容))
赋值 (.内容, 删除特殊符号 (.内容))
赋值 (.内容, 删除特殊符号 (.内容))
赋值 (.内容, 删除特殊符号 (.内容))
.如果真 (等于 (.内容, “”))
    信息框 (“必须填写供应商名称！”, 0, )
    返回 (假)
.如果真结束


.如果 (并且 (等于 (供应商添加修改标记, 2), 等于 (.内容, 原始名称)))
    返回 (真)
    
.否则
    
    _启动窗口.未知支持库函数_14 (., 相加 (“select * from 供货商 where 供货商名称='”, .内容, “'”), #)
    .如果真 (大于 (_启动窗口.., 0))
        信息框 (“供货商名称重复，请重新填写。”, 0, )
        _启动窗口.未知支持库函数_16 (.)
        返回 (假)
    .如果真结束
    
.如果结束

返回 (真)




.窗口程序集 窗口程序集12, , , 

.程序集变量 当前查询状态, 整数型, , , 
.程序集变量 销售统计文本, 文本型, , , 
.程序集变量 统计精简, 文本型, , , 
.子程序 _按钮1_被单击, 空白型, , 
赋值 (.标题, 相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月份”, “商品销量统计，统计供货商：”, .内容))
赋值 (统计精简, 相加 (到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”))
查询到超级列表框 (2)
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--


.子程序 查询到超级列表框, 空白型, , 
.参数 查询方式, 整数型, , 1本天 2本月 3本年 4最10天

.局部变量 计次, 整数型, , , 
.局部变量 临时文本, 文本型, , , 
.局部变量 商品名称, 文本型, , , 
.局部变量 数量, 小数型, , , 
.局部变量 单价, 小数型, , , 
.局部变量 匿名局部变量_1851, 空白型, , , 
.局部变量 总数量, 小数型, , , 
.局部变量 总金额, 小数型, , , 
.局部变量 实际收取金额, 小数型, , , 
.局部变量 匿名局部变量_1912, 空白型, , , 
.局部变量 总金额合计, 小数型, , , 
.局部变量 实收金额合计, 小数型, , , 

赋值 (总数量, 0)
赋值 (总金额, 0)
赋值 (总金额合计, 0)
赋值 (实收金额合计, 0)

赋值 (当前查询状态, 查询方式)
全部删除 ()
.如果 (等于 (.内容, “全部”))
    _启动窗口.未知支持库函数_14 (., “select * from 商品资料 ”, #)
.否则
    
    _启动窗口.未知支持库函数_14 (., 相加 (“select * from 商品资料 where 供货商='”, .内容, “'”), #)
.如果结束

赋值 (计次, 1)
.判断循环首 (小于或等于 (计次, _启动窗口..))
    -1.插入表项 (到文本 (计次), , , , )
    _启动窗口.未知支持库函数_26 (., “名称”, 临时文本)
    赋值 (商品名称, 临时文本)
    相减 (取表项数 (), 1).置标题 (1, 临时文本)
    _启动窗口.未知支持库函数_26 (., “供货商”, 临时文本)
    相减 (取表项数 (), 1).置标题 (2, 临时文本)
    _启动窗口.未知支持库函数_26 (., “规格”, 临时文本)
    相减 (取表项数 (), 1).置标题 (3, 临时文本)
    _启动窗口.未知支持库函数_26 (., “单位”, 临时文本)
    相减 (取表项数 (), 1).置标题 (4, 临时文本)
    
    _启动窗口.未知支持库函数_26 (., “单价”, 临时文本)
    相减 (取表项数 (), 1).置标题 (5, 临时文本)
    赋值 (总金额, 到数值 (临时文本))
    赋值 (数量, 统计出数量 (商品名称, 查询方式, 实际收取金额))
    
    赋值 (总金额, 相乘 (总金额, 数量))
    
    赋值 (总数量, 相加 (总数量, 数量))
    赋值 (单价, 到数值 (临时文本))
    相减 (取表项数 (), 1).置标题 (6, 到文本 (数量))
    相减 (取表项数 (), 1).置标题 (7, 到文本 (总金额))
    相减 (取表项数 (), 1).置标题 (8, 到文本 (实际收取金额))
    赋值 (总金额合计, 相加 (总金额合计, 总金额))
    赋值 (实收金额合计, 相加 (实收金额合计, 实际收取金额))
    .如果真 (等于 (数量, 0))
        .如果真 (等于 (.选中, 真))
            相减 (取表项数 (), 1).删除表项 ()
        .如果真结束
        
    .如果真结束
    
    _启动窗口.未知支持库函数_36 (.)
    赋值 (计次, 相加 (计次, 1))
    刷新显示 ()
    相减 (取表项数 (), 1).保证显示 ()
    
.判断循环尾 ()
_启动窗口.未知支持库函数_16 (.)

-1.插入表项 ()
相减 (取表项数 (), 1).置标题 (5, “合计”)
相减 (取表项数 (), 1).置标题 (6, 到文本 (总数量))
相减 (取表项数 (), 1).置标题 (7, 到文本 (总金额合计))
相减 (取表项数 (), 1).置标题 (8, 到文本 (实收金额合计))
刷新显示 ()
相减 (取表项数 (), 1).保证显示 ()


.子程序 统计出数量, 小数型, , 
.参数 商品名称, 文本型, , 
.参数 查询方式, 整数型, , 1本天 2本月 3本年 4最10天
.参数 实收金额, 小数型, 参考, 

.局部变量 查询时间, 文本型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 数量, 小数型, , , 
.局部变量 临时文本, 文本型, , , 
.局部变量 时间计次, 整数型, , , 
.局部变量 当前时间, 日期时间型, , , 
.局部变量 sql, 文本型, , , 
.局部变量 a, 小数型, , , 

.如果 (不等于 (查询方式, 4))
    .如果真 (等于 (查询方式, 1))
        赋值 (查询时间, 相加 (到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天)), “-”, 到文本 (取日 (.今天))))
        赋值 (sql, 相加 (“select * from 销售表 where 商品名称='”, 商品名称, “' AND datediff('d',XSSJ,'”, 查询时间, “')=0”))
    .如果真结束
    
    .如果真 (等于 (查询方式, 2))
        赋值 (查询时间, 相加 (到文本 (取年份 (.今天)), “-”, 到文本 (取月份 (.今天))))
        赋值 (sql, 相加 (“select * from 销售表 where 商品名称='”, 商品名称, “' AND datediff('m',XSSJ,'”, 查询时间, “')=0”))
    .如果真结束
    
    .如果真 (等于 (查询方式, 3))
        赋值 (查询时间, 到文本 (取年份 (.今天)))
        赋值 (sql, 相加 (“select * from 销售表 where 商品名称='”, 商品名称, “' AND XSSJ LIKE '”, 查询时间, “%'”))
    .如果真结束
    
     ' sql ＝ “select * from 销售表 where 商品名称='” ＋ 商品名称 ＋ “' AND XSSJ LIKE '” ＋ 查询时间 ＋ “%'”
     ' yyyy 年
     ' q 季
     ' m 月
     ' y 一年中的日期
     ' d 日
     ' w 工作日
     ' ww 周
     ' h 时
     ' n 分
     ' s 秒
    
    
    sql.未知支持库函数_14 (#)
    调试输出 (sql)
    赋值 (计次, 1)
    赋值 (数量, 0)
    赋值 (实收金额, 0)
    .判断循环首 (并且 (小于或等于 (计次, .), 大于 (计次, 0)))
        “单据编号”.未知支持库函数_26 (临时文本)
        .如果真 (等于 (单据是否有效 (临时文本), 假))
            未知支持库函数_36 ()
            赋值 (计次, 相加 (计次, 1))
            到循环尾 ()
        .如果真结束
        
        “数量”.未知支持库函数_26 (临时文本)
        赋值 (数量, 相加 (数量, 到数值 (临时文本)))
        赋值 (a, 到数值 (临时文本))
        “单价”.未知支持库函数_26 (临时文本)
        赋值 (实收金额, 相加 (实收金额, 相乘 (a, 到数值 (临时文本))))
        
        未知支持库函数_36 ()
        赋值 (计次, 相加 (计次, 1))
    .判断循环尾 ()
    未知支持库函数_16 ()
    返回 (数量)
.否则
    
    赋值 (时间计次, -9)
    赋值 (数量, 0)
    赋值 (实收金额, 0)
    .判断循环首 (小于或等于 (时间计次, 0))
        赋值 (当前时间, 增减时间 (.今天, #日, 时间计次))
        赋值 (查询时间, 相加 (到文本 (取年份 (当前时间)), “-”, 到文本 (取月份 (当前时间)), “-”, 到文本 (取日 (当前时间))))
        调试输出 (查询时间)
        
        赋值 (sql, 相加 (“select * from 销售表 where 商品名称='”, 商品名称, “' AND XSSJ LIKE '”, 查询时间, “%'”))
        
        sql.未知支持库函数_14 (#)
        赋值 (计次, 1)
        .判断循环首 (小于或等于 (计次, .))
            “单据编号”.未知支持库函数_26 (临时文本)
            .如果真 (等于 (单据是否有效 (临时文本), 假))
                未知支持库函数_36 ()
                赋值 (计次, 相加 (计次, 1))
                到循环尾 ()
                
            .如果真结束
            
            “数量”.未知支持库函数_26 (临时文本)
            赋值 (数量, 相加 (数量, 到数值 (临时文本)))
            赋值 (a, 到数值 (临时文本))
            “单价”.未知支持库函数_26 (临时文本)
            赋值 (实收金额, 相加 (实收金额, 相乘 (a, 到数值 (临时文本))))
            
            未知支持库函数_36 ()
            赋值 (计次, 相加 (计次, 1))
        .判断循环尾 ()
        未知支持库函数_16 ()
        赋值 (时间计次, 相加 (时间计次, 1))
    .判断循环尾 ()
    返回 (数量)
.如果结束

返回 (0)

.子程序 _商品销售统计窗口_创建完毕, 空白型, , 
相加 (取运行目录 (), “\date\dat.mdb”).未知支持库函数_1 (“”)
.未知支持库函数_12 ()
相加 (取运行目录 (), “\date\dat.mdb”).未知支持库函数_1 (“”)
.未知支持库函数_12 ()


刷新供货商 ()
赋值 (.标题, 返回查询标题 (.今天))
赋值 (.标题, 相加 (到标准时间1 (.今天), “商品销量统计，统计供货商：”, .内容))
赋值 (统计精简, 到标准时间1 (.今天))
查询到超级列表框 (1)

.子程序 _按钮3_被单击, 空白型, , 
赋值 (.标题, 相加 (.标题, “商品销量统计，统计供货商：”, .内容))
赋值 (统计精简, .标题)
查询到超级列表框 (4)

.子程序 _日期框1_选择日期被改变, 空白型, , 
赋值 (.标题, 返回查询标题 (.今天))
赋值 (.标题, 相加 (到标准时间1 (.今天), “商品销量统计，统计供货商：”, .内容))
赋值 (统计精简, 到标准时间1 (.今天))

查询到超级列表框 (1)

.子程序 _商品销售统计窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()
未知支持库函数_3 ()

.子程序 _按钮2_被单击, 空白型, , 
赋值 (.标题, 相加 (到文本 (取年份 (.今天)), “年”, “商品销量统计，统计供货商：”, .内容))
赋值 (统计精简, 相加 (到文本 (取年份 (.今天)), “年”))

查询到超级列表框 (3)


.子程序 _组合框1_列表项被选择, 空白型, , 
查询到超级列表框 (当前查询状态)


.子程序 _超级列表框2_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.弹出菜单 ()


.子程序 _打印_被选择, 空白型, , 
.局部变量 a, 整数型, , "8", 

赋值 (a [1], 0)
赋值 (a [2], 1)
赋值 (a [3], 2)
赋值 (a [4], 3)
赋值 (a [5], 4)
赋值 (a [6], 5)
打印预览 (.标题, 真, a, 45)


.子程序 _导出到Excel_被选择, 空白型, , 
超级列表框到EXCEL_自定义 (.标题)


.子程序 _商品销售统计窗口_尺寸被改变, 空白型, , 
赋值 (.倾斜, 相减 (取用户区宽度 (), 16))
赋值 (.删除线, 相减 (取用户区高度 (), .加粗, 5))


.子程序 单据是否有效, 逻辑型, , 
.参数 单据编号, 文本型, , 

.局部变量 啊啊啊, 文本型, , , 

相加 (“select * from 单据表 where 单据编号='”, 单据编号, “'”).未知支持库函数_14 (#)
“YXX”.未知支持库函数_26 (啊啊啊)
未知支持库函数_16 ()
调试输出 (单据编号)
.如果 (等于 (啊啊啊, “Y”))
    调试输出 (啊啊啊)
    返回 (真)
.否则
    
    调试输出 (啊啊啊)
    返回 (假)
.如果结束


.子程序 _查看详情_被选择, 空白型, , 
.如果真 (并且 (不等于 (., -1), 不等于 (., 相减 (取表项数 (), 1))))
    赋值 (查询单品名称, .取标题 (., 1))
    载入 (窗口1, 商品销售统计窗口, 假)
.如果真结束


.子程序 _选择框1_被单击, 空白型, , 
查询到超级列表框 (当前查询状态)


.子程序 _超级列表框2_左键单击表项, 空白型, , 
_查看详情_被选择 ()


.子程序 _打印到POS小票机_被选择, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 统计时间, 文本型, , , 

赋值 (销售统计文本, “”)
加入销售统计文本 (居中文本 (打印标题1))

加入销售统计文本 (居中文本 (“商品销售统计”))
加入销售统计文本 (“统计时间:”)
加入销售统计文本 (统计精简)
加入销售统计文本 (相加 (“供货商:”, .内容))
加入销售统计文本 (“━━━━━━━━━━━━━━━”)
加入销售统计文本 (“ 商品名称            |销售数量 |”)
加入销售统计文本 (“━━━━━━━━━━━━━━━”)
赋值 (计次, 0)
.判断循环首 (小于或等于 (计次, 相减 (取表项数 (), 2)))
    加入销售统计文本 (相加 (加入指定空格 (计次.取标题 (1), 21), “|”, 计次.取标题 (6), 计次.取标题 (4)))
    
    赋值 (计次, 相加 (计次, 1))
.判断循环尾 ()
加入销售统计文本 (“━━━━━━━━━━━━━━━”)
加入销售统计文本 (相加 (“总金额：”, 相减 (取表项数 (), 1).取标题 (8)))
加入销售统计文本 (“━━━━━━━━━━━━━━━”)
加入销售统计文本 (相加 (“打印时间:”, 到文本 (取现行时间 ())))
_启动窗口.开始打印 (., 假, 假, , , , )
_启动窗口.写文本行 (., 销售统计文本)
_启动窗口.结束打印 (.)

.子程序 加入销售统计文本, 空白型, , 
.参数 文本, 文本型, , 

赋值 (销售统计文本, 相加 (销售统计文本, 文本, #换行符))


.窗口程序集 窗口程序集13, , , 

.子程序 _窗口1_创建完毕, 空白型, , 
统计出数量单品 (查询单品名称, 商品销售统计窗口.)

.子程序 统计出数量单品, 小数型, , 
.参数 商品名称, 文本型, , 
.参数 查询方式, 整数型, , 1本天 2本月 3本年 4最10天

.局部变量 查询时间, 文本型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 数量, 小数型, , , 
.局部变量 临时文本, 文本型, , , 
.局部变量 时间计次, 整数型, , , 
.局部变量 当前时间, 日期时间型, , , 
.局部变量 匿名局部变量_1957, 空白型, , , 
.局部变量 a, 小数型, , , 
.局部变量 匿名局部变量_1997, 空白型, , , 
.局部变量 合计, 小数型, , , 
.局部变量 总计价格, 小数型, , , 
.局部变量 总计数量, 小数型, , , 

赋值 (总计价格, 0)
赋值 (总计数量, 0)

.如果 (不等于 (查询方式, 4))
    .如果真 (等于 (查询方式, 1))
        赋值 (查询时间, 相加 (到文本 (取年份 (商品销售统计窗口..今天)), “-”, 到文本 (取月份 (商品销售统计窗口..今天)), “-”, 到文本 (取日 (商品销售统计窗口..今天))))
    .如果真结束
    
    .如果真 (等于 (查询方式, 2))
        赋值 (查询时间, 相加 (到文本 (取年份 (商品销售统计窗口..今天)), “-”, 到文本 (取月份 (商品销售统计窗口..今天)), “-”))
        
    .如果真结束
    
    .如果真 (等于 (查询方式, 3))
        赋值 (查询时间, 相加 (到文本 (取年份 (商品销售统计窗口..今天)), “-”))
    .如果真结束
    
    商品销售统计窗口.未知支持库函数_14 (., 相加 (“select * from 销售表 where 商品名称='”, 商品名称, “' AND XSSJ LIKE '”, 查询时间, “%'”), #)
    赋值 (计次, 1)
    赋值 (数量, 0)
    
    .判断循环首 (并且 (小于或等于 (计次, 商品销售统计窗口..), 大于 (计次, 0)))
        商品销售统计窗口.未知支持库函数_26 (., “单据编号”, 临时文本)
        .如果真 (等于 (单据是否有效 (临时文本), 假))
            商品销售统计窗口.未知支持库函数_36 (.)
            赋值 (计次, 相加 (计次, 1))
            到循环尾 ()
        .如果真结束
        
        
        -1.插入表项 (到文本 (计次), , , , )
        
        商品销售统计窗口.未知支持库函数_26 (., “XSSJ”, 临时文本)
        相减 (取表项数 (), 1).置标题 (1, 临时文本)
        
        商品销售统计窗口.未知支持库函数_26 (., “单据编号”, 临时文本)
        相减 (取表项数 (), 1).置标题 (2, 临时文本)
        
        商品销售统计窗口.未知支持库函数_26 (., “商品名称”, 临时文本)
        相减 (取表项数 (), 1).置标题 (3, 临时文本)
        
        商品销售统计窗口.未知支持库函数_26 (., “供货商”, 临时文本)
        相减 (取表项数 (), 1).置标题 (4, 临时文本)
        
        商品销售统计窗口.未知支持库函数_26 (., “规格”, 临时文本)
        相减 (取表项数 (), 1).置标题 (5, 临时文本)
        
        商品销售统计窗口.未知支持库函数_26 (., “单位”, 临时文本)
        相减 (取表项数 (), 1).置标题 (6, 临时文本)
        
        商品销售统计窗口.未知支持库函数_26 (., “单价”, 临时文本)
        相减 (取表项数 (), 1).置标题 (7, 临时文本)
        
        商品销售统计窗口.未知支持库函数_26 (., “数量”, 临时文本)
        相减 (取表项数 (), 1).置标题 (8, 临时文本)
        
        赋值 (合计, 相乘 (到数值 (相减 (取表项数 (), 1).取标题 (7)), 到数值 (相减 (取表项数 (), 1).取标题 (8))))
        赋值 (总计价格, 相加 (总计价格, 合计))
        赋值 (总计数量, 相加 (总计数量, 到数值 (相减 (取表项数 (), 1).取标题 (7))))
        
        相减 (取表项数 (), 1).置标题 (9, 到文本 (合计))
        商品销售统计窗口.未知支持库函数_36 (.)
        赋值 (计次, 相加 (计次, 1))
    .判断循环尾 ()
    商品销售统计窗口.未知支持库函数_16 (.)
    
    -1.插入表项 ()
    相减 (取表项数 (), 1).置标题 (7, “合计”)
    相减 (取表项数 (), 1).置标题 (8, 到文本 (总计数量))
    相减 (取表项数 (), 1).置标题 (9, 到文本 (总计价格))
    返回 (数量)
.否则
    
    赋值 (时间计次, -9)
    赋值 (数量, 0)
    
    .判断循环首 (小于或等于 (时间计次, 0))
        赋值 (当前时间, 增减时间 (商品销售统计窗口..今天, #日, 时间计次))
        赋值 (查询时间, 相加 (到文本 (取年份 (当前时间)), “-”, 到文本 (取月份 (当前时间)), “-”, 到文本 (取日 (当前时间))))
        商品销售统计窗口.未知支持库函数_14 (., 相加 (“select * from 销售表 where 商品名称='”, 商品名称, “' AND XSSJ LIKE '”, 查询时间, “%'”), #)
        赋值 (计次, 1)
        .判断循环首 (小于或等于 (计次, 商品销售统计窗口..))
            商品销售统计窗口.未知支持库函数_26 (., “单据编号”, 临时文本)
            .如果真 (等于 (单据是否有效 (临时文本), 假))
                商品销售统计窗口.未知支持库函数_36 (.)
                赋值 (计次, 相加 (计次, 1))
                到循环尾 ()
                
            .如果真结束
            
            -1.插入表项 (到文本 (计次), , , , )
            
            商品销售统计窗口.未知支持库函数_26 (., “XSSJ”, 临时文本)
            相减 (取表项数 (), 1).置标题 (1, 临时文本)
            
            商品销售统计窗口.未知支持库函数_26 (., “单据编号”, 临时文本)
            相减 (取表项数 (), 1).置标题 (2, 临时文本)
            
            商品销售统计窗口.未知支持库函数_26 (., “商品名称”, 临时文本)
            相减 (取表项数 (), 1).置标题 (3, 临时文本)
            
            商品销售统计窗口.未知支持库函数_26 (., “供货商”, 临时文本)
            相减 (取表项数 (), 1).置标题 (4, 临时文本)
            
            商品销售统计窗口.未知支持库函数_26 (., “规格”, 临时文本)
            相减 (取表项数 (), 1).置标题 (5, 临时文本)
            
            商品销售统计窗口.未知支持库函数_26 (., “单位”, 临时文本)
            相减 (取表项数 (), 1).置标题 (6, 临时文本)
            
            商品销售统计窗口.未知支持库函数_26 (., “单价”, 临时文本)
            相减 (取表项数 (), 1).置标题 (7, 临时文本)
            
            商品销售统计窗口.未知支持库函数_26 (., “数量”, 临时文本)
            相减 (取表项数 (), 1).置标题 (8, 临时文本)
            
            赋值 (合计, 相乘 (到数值 (相减 (取表项数 (), 1).取标题 (7)), 到数值 (相减 (取表项数 (), 1).取标题 (8))))
            赋值 (总计价格, 相加 (总计价格, 合计))
            赋值 (总计数量, 相加 (总计数量, 到数值 (相减 (取表项数 (), 1).取标题 (7))))
            
            相减 (取表项数 (), 1).置标题 (9, 到文本 (合计))
            
            商品销售统计窗口.未知支持库函数_36 (.)
            赋值 (计次, 相加 (计次, 1))
        .判断循环尾 ()
        商品销售统计窗口.未知支持库函数_16 (.)
        赋值 (时间计次, 相加 (时间计次, 1))
    .判断循环尾 ()
    
    -1.插入表项 ()
    相减 (取表项数 (), 1).置标题 (7, “合计”)
    相减 (取表项数 (), 1).置标题 (8, 到文本 (总计数量))
    相减 (取表项数 (), 1).置标题 (9, 到文本 (总计价格))
    
    返回 (数量)
.如果结束

返回 (0)

.子程序 _窗口1_尺寸被改变, 空白型, , 
赋值 (.删除线, 取用户区高度 ())
赋值 (.倾斜, 取用户区宽度 ())


.子程序 _超级列表框2_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, ,  

.弹出菜单 ()


.子程序 _导出到Excel_被选择, 空白型, , 
超级列表框到EXCEL_自定义 (“商品销售详情”)


.子程序 _打印_被选择, 空白型, , 
.局部变量 啊啊, 整数型, , "10", 

赋值 (啊啊 [1], 0)
赋值 (啊啊 [2], 1)
赋值 (啊啊 [3], 2)
赋值 (啊啊 [4], 3)
赋值 (啊啊 [5], 4)
赋值 (啊啊 [6], 5)
赋值 (啊啊 [7], 6)
赋值 (啊啊 [8], 7)
赋值 (啊啊 [9], 8)
赋值 (啊啊 [10], 9)
打印预览 (“商品销售详情”, 真, 啊啊, 45)


.窗口程序集 窗口程序集14, , , 

.子程序 _打印设置窗口_创建完毕, 空白型, , 
读入配置项目 ()
显示配置项目 ()

.子程序 读入配置项目, 空白型, , 
赋值 (打印标题1, 读配置项 (相加 (取运行目录 (), “\config.ini”), “printf”, “title1”, “”))
赋值 (打印标题2, 读配置项 (相加 (取运行目录 (), “\config.ini”), “printf”, “title2”, “”))
赋值 (打印标题3, 读配置项 (相加 (取运行目录 (), “\config.ini”), “printf”, “title3”, “”))
赋值 (打印标题4, 读配置项 (相加 (取运行目录 (), “\config.ini”), “printf”, “title4”, “”))
.如果 (等于 (读配置项 (相加 (取运行目录 (), “\config.ini”), “printf”, “autoprintf”, “”), “Y”))
    赋值 (是否自动打印, 真)
.否则
    
    赋值 (是否自动打印, 假)
.如果结束


.子程序 显示配置项目, 空白型, , 
赋值 (.内容, 打印标题1)
赋值 (.内容, 打印标题2)
赋值 (.内容, 打印标题3)
赋值 (.内容, 打印标题4)
.如果 (等于 (是否自动打印, 真))
    赋值 (.选中, 真)
.否则
    
    赋值 (.选中, 假)
    
.如果结束


.子程序 写入配置项目, 空白型, , 
赋值 (打印标题1, .内容)
赋值 (打印标题2, .内容)
赋值 (打印标题3, .内容)
赋值 (打印标题4, .内容)

.如果 (等于 (.选中, 真))
    赋值 (是否自动打印, 真)
.否则
    赋值 (是否自动打印, 假)
.如果结束

写配置项 (相加 (取运行目录 (), “\config.ini”), “printf”, “title1”, 打印标题1)
写配置项 (相加 (取运行目录 (), “\config.ini”), “printf”, “title2”, 打印标题2)
写配置项 (相加 (取运行目录 (), “\config.ini”), “printf”, “title3”, 打印标题3)
写配置项 (相加 (取运行目录 (), “\config.ini”), “printf”, “title4”, 打印标题4)

.如果 (等于 (是否自动打印, 真))
    写配置项 (相加 (取运行目录 (), “\config.ini”), “printf”, “autoprintf”, “Y”)
.否则
    写配置项 (相加 (取运行目录 (), “\config.ini”), “printf”, “autoprintf”, “N”)
.如果结束




.子程序 _按钮1_被单击, 空白型, , 
写入配置项目 ()
销毁 ()



 ' 不属于任何一个程序集、类模块的函数：
