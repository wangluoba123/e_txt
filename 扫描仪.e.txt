 ' 文件类型：Windows窗口程序

 ' 程序名称：扫描仪
 ' 程序描述：实现了对扫描仪的功能操作。
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 549
    高度 = 334
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “扫描仪”
    帮助文件名 = “”

窗口 预览窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “预览图片”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' twain 730FA7B73AAB409a8554F9553CF2DD87 1 5 数码设备支持库




.全局变量 图, 字节集, , , 
.全局变量 图宽, 整数型, , , 
.全局变量 图高, 整数型, , , 

.窗口程序集 启动窗口程序集, , , 

.子程序 _获取图象按钮_被单击, 空白型, , 
假.未知支持库函数_0 (.现行选中项)
赋值 (., .现行选中项)
赋值 (., 到数值 (.内容))
赋值 (., 到数值 (.内容))
赋值 (., 到数值 (.内容))
赋值 (., 到数值 (.内容))
赋值 (., 到数值 (.内容))
赋值 (., 到数值 (.内容))
假.未知支持库函数_1 ()


.子程序 _获取默认值按钮_被单击, 空白型, , 
假.未知支持库函数_0 (.现行选中项)
赋值 (.现行选中项, .)
赋值 (.内容, 到文本 (.))
赋值 (.内容, 到文本 (.))
赋值 (.内容, 到文本 (.))
赋值 (.内容, 到文本 (.))
赋值 (.内容, 到文本 (.))
赋值 (.内容, 到文本 (.))


.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 循环次数, 整数型, , , 

未知支持库函数_3 ()
赋值 (循环次数, 0)
.计次循环首 (., 循环次数)
    赋值 (., 相减 (循环次数, 1))
    .加入项目 (., )
.计次循环尾 ()

.子程序 _选择来源按钮_被单击, 空白型, , 
假.未知支持库函数_0 (-1)

.子程序 _界面获取按钮_被单击, 空白型, , 
真.未知支持库函数_1 ()

.子程序 _TWAIN组件_图片传送完毕, 空白型, , 
.参数 图片, 字节集, , 
.参数 图片宽度, 整数型, , 
.参数 图片高度, 整数型, , 

.局部变量 图片号, 整数型, , , 
.局部变量 找到, 文本型, , , 
.局部变量 编号, 整数型, , , 
.局部变量 前次取得, 逻辑型, , , 


赋值 (图片号, 载入图片 (图片))
图片号.画图片 (0, 0, .宽度, .高度, )
赋值 (.底图方式, 2)
赋值 (图, 图片)
赋值 (图宽, 图片宽度)
赋值 (图高, 图片高度)
赋值 (找到, 寻找文件 (相加 (取运行目录 (), “\sp_uc*.bmp”), ))
.循环判断首 ()
    赋值 (找到, 子文本替换 (找到, “sp_uc”, “0”, , , 真))
    赋值 (前次取得, 大于 (到数值 (找到), 编号))
    .如果真 (前次取得)
        赋值 (编号, 到数值 (找到))
    .如果真结束
    赋值 (找到, 寻找文件 ())
.循环判断尾 (不等于 (找到, “”))
.如果真 (前次取得)
    赋值 (编号, 相加 (编号, 1))
.如果真结束
相加 (取运行目录 (), “\sp_cu”, 到文本 (相加 (编号, 1)), “.bmp”).未知支持库函数_2 ()


.子程序 _缩略图画板_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (预览窗口, , 真)

.窗口程序集 预览窗口程序集, , , 

.子程序 _预览窗口_尺寸被改变, 空白型, , 
赋值 (.顶边, 相减 (取用户区高度 (), .高度))
赋值 (.左边, 相减 (取用户区宽度 (), .宽度))
赋值 (.宽度, 相减 (取用户区宽度 (), .宽度))
赋值 (.高度, 相减 (取用户区高度 (), .高度))
赋值 (.宽度, .宽度)
赋值 (.高度, .高度)

.子程序 _预览窗口_创建完毕, 空白型, , 
赋值 (.图片, 图)
赋值 (.宽度, 图宽)
赋值 (.高度, 图高)
2.调整层次 ()
赋值 (.最大位置, 图宽)
赋值 (.最大位置, 图高)

.子程序 _纵向滚动条_位置被改变, 空白型, , 
.如果真 (大于 (.高度, 预览窗口.))
    赋值 (.顶边, 负 (.位置))
.如果真结束


.子程序 _横向滚动条_位置被改变, 空白型, , 
.如果真 (大于 (.宽度, 预览窗口.))
    赋值 (.左边, 负 (.位置))
.如果真结束



 ' 不属于任何一个程序集、类模块的函数：
