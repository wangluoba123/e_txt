 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\管理.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “寝室学生管理系统”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 492
    高度 = 375
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “添加学生信息”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 338
    高度 = 146
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.常量 数据库1, "“管理”", , 
.常量 姓名, "“姓名”", , 
.常量 班级, "“班级”", , 
.常量 所在寝室, "“所在寝室”", , 
.常量 家庭住址, "“家庭住址”", , 
.常量 联系方式, "“联系方式”", , 
.常量 第一学期, "“第一学期”", , 
.常量 第二学期, "“第二学期”", , 
.常量 第三学期, "“第三学期”", , 
.常量 第四学期, "“第四学期”", , 
.常量 第五学期, "“第五学期”", , 
.常量 第六学期, "“第六学期”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 7 系统核心支持库
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 1 XP风格界面库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 1 扩展界面支持库一




.全局变量 查找姓名, 文本型, , , 

.窗口程序集 窗口程序集1, , , 

.子程序 _按钮4_被单击, 空白型, , 
.局部变量 当前记录号, 整数型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请输入要查找的学生姓名！”, 0, )
    返回 ()
.如果真结束
赋值 (当前记录号, 取记录号 ())
跳到 (1)
.判断循环首 (并且 (小于或等于 (取记录号 (), 取记录数 ()), 不等于 (.内容, 读 (#姓名))))
    跳过 ()
.判断循环尾 ()
.如果 (小于或等于 (取记录号 (), 取记录数 ()))
    显示数据 ()
.否则
    跳到 (当前记录号)
    信息框 (“没找到！”, 0, )
.如果结束



.子程序 __启动窗口_创建完毕, 空白型, , 
未知支持库函数_0 (#)
2.置文本 (到文本 (取现行时间 ()))
.如果 (打开 (“管理.edb”, , , , , , ))
    复制文件 (“管理.edb”, “管理.bak”)
    .如果真 (不等于 (取记录数 (), 0))
        显示数据 ()
    .如果真结束
    
.否则
    
    信息框 (“数据库打开失败，当前程序退出，请联系维护人员进行手工恢复数据库！”, 0, )
    结束 ()
.如果结束


.子程序 显示数据, 空白型, , 
.如果真 (等于 (取记录数 (), 0))
    清空启动窗口 ()
    返回 ()
.如果真结束
赋值 (.内容, 读 (#姓名))
赋值 (.内容, 读 (#班级))
赋值 (.内容, 读 (#所在寝室))
赋值 (.内容, 读 (#家庭住址))
赋值 (.内容, 读 (#联系方式))
赋值 (.内容, 读 (#第一学期))
赋值 (.内容, 读 (#第二学期))
赋值 (.内容, 读 (#第三学期))
赋值 (.内容, 读 (#第四学期))
赋值 (.内容, 读 (#第五学期))
赋值 (.内容, 读 (#第六学期))
0.置文本 (相加 (“学生号：”, 到文本 (取记录号 ()), “ 总数：”, 到文本 (取记录数 ())))

.子程序 清空启动窗口, 空白型, , 
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)

.子程序 下一条记录, 空白型, , 
.如果 (等于 (取记录号 (), 取记录数 ()))
    信息框 (“已经到末尾！”, 0, )
.否则
    跳过 ()
    显示数据 ()
.如果结束


.子程序 前一条记录, 空白型, , 
.如果 (等于 (取记录号 (), 1))
    信息框 (“已经到首记录！”, 0, )
.否则
    跳过 (-1)
    显示数据 ()
.如果结束


.子程序 到首记录, 空白型, , 
跳到 (1)
显示数据 ()

.子程序 到末记录, 空白型, , 
跳到 (取记录数 ())
显示数据 ()

.子程序 添加数据, 空白型, , 
载入 (窗口1, , 真)
显示数据 ()

.子程序 删除当前记录, 空白型, , 删除记录
.局部变量 按钮, 整数型, , , 
.局部变量 当前记录号, 整数型, , , 

赋值 (按钮, 信息框 (“真地要删除当前记录吗？该操作不可恢复！”, #是否钮, ))
.如果真 (等于 (按钮, #否钮))
    返回 ()
.如果真结束
.如果真 (并且 (大于 (取记录号 (), 0), 小于或等于 (取记录号 (), 取记录数 ())))
    删除 ()
    赋值 (当前记录号, 取记录号 ())
    彻底删除 ()
    .如果 (小于或等于 (当前记录号, 取记录数 ()))
        跳到 (当前记录号)
    .否则
        跳到 (取记录数 ())
    .如果结束
    显示数据 ()
.如果真结束


.子程序 _退出_被选择, 空白型, , 
结束 ()

.子程序 _添加记录_被选择, 空白型, , 
添加数据 ()

.子程序 _删除记录_被选择, 空白型, , 
删除当前记录 ()

.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.判断开始 (等于 (按钮索引, 0))
    保存数据2 ()
    载入 (窗口1, , 真)
    显示数据 ()
.判断 (等于 (按钮索引, 1))
    删除当前记录 ()
.判断 (等于 (按钮索引, 2))
    保存数据2 ()
.判断 (等于 (按钮索引, 3))
    保存数据2 ()
    到首记录 ()
.判断 (等于 (按钮索引, 4))
    保存数据2 ()
    到末记录 ()
.判断 (等于 (按钮索引, 5))
    保存数据2 ()
    前一条记录 ()
.判断 (等于 (按钮索引, 6))
    保存数据2 ()
    下一条记录 ()
.判断 (等于 (按钮索引, 8))
    保存数据2 ()
    结束 ()
.默认
    
.判断结束



.子程序 _编辑框12_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _按钮4_被单击 ()
.如果真结束


.子程序 保存数据2, 空白型, , 启动窗口中进行数据存盘
.如果真 (或者 (小于或等于 (取记录号 (), 0), 大于 (取记录号 (), 取记录数 ())))
    返回 ()
.如果真结束
写 (#姓名, .内容)
写 (#班级, .内容)
写 (#所在寝室, .内容)
写 (#家庭住址, .内容)
写 (#联系方式, .内容)
写 (#第一学期, .内容)
写 (#第二学期, .内容)
写 (#第三学期, .内容)
写 (#第四学期, .内容)
写 (#第五学期, .内容)
写 (#第六学期, .内容)

.子程序 _保存记录_被选择, 空白型, , 
.如果真 (并且 (大于或等于 (取记录号 (), 1), 小于或等于 (取记录号 (), 取记录数 ())))
    保存数据2 ()
.如果真结束


.子程序 _时钟1_周期事件, 空白型, , 
2.置文本 (到文本 (取现行时间 ()))

.子程序 _首记录_被选择, 空白型, , 
到首记录 ()

.子程序 _尾记录_被选择, 空白型, , 
到末记录 ()

.子程序 _上一条_被选择, 空白型, , 
前一条记录 ()

.子程序 _下一条_被选择, 空白型, , 
下一条记录 ()

.子程序 _数据备份_被选择, 空白型, , 
.如果真 (文件是否存在 (“管理5.edb”))
    删除文件 (“管理5.edb”)
.如果真结束
.如果真 (文件是否存在 (“管理4.edb”))
    复制文件 (“管理4.edb”, “管理5.edb”)
    删除文件 (“管理4.edb”)
.如果真结束
.如果真 (文件是否存在 (“管理3.edb”))
    复制文件 (“管理3.edb”, “管理4.edb”)
    删除文件 (“管理3.edb”)
.如果真结束
.如果真 (文件是否存在 (“管理2.edb”))
    复制文件 (“管理2.edb”, “管理3.edb”)
    删除文件 (“管理2.edb”)
.如果真结束
.如果真 (文件是否存在 (“管理1.edb”))
    复制文件 (“管理1.edb”, “管理2.edb”)
    删除文件 (“管理1.edb”)
.如果真结束
复制文件 (“管理.edb”, “管理1.edb”)

.子程序 _关于_被选择, 空白型, , 
载入 (关于窗口, , 真)

.窗口程序集 窗口程序集2, , , 

.子程序 _按钮1_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (“请输入姓名！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入班级！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入寝室！”, 0, )
    返回 ()
.如果真结束
加空记录 ()
保存数据 ()
清空窗口 ()

.子程序 _窗口1_创建完毕, 空白型, , 


.子程序 保存数据, 空白型, , 
写 (#姓名, .内容)
写 (#班级, .内容)
写 (#所在寝室, .内容)
写 (#家庭住址, .内容)
写 (#联系方式, .内容)
写 (#第一学期, .内容)
写 (#第二学期, .内容)
写 (#第三学期, .内容)
写 (#第四学期, .内容)
写 (#第五学期, .内容)
写 (#第六学期, .内容)

.子程序 清空窗口, 空白型, , 
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)

.子程序 _按钮2_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (“请输入姓名！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入班级！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入寝室！”, 0, )
    返回 ()
.如果真结束
加空记录 ()
保存数据 ()
销毁 ()

.子程序 _按钮3_被单击, 空白型, , 

.如果 (等于 (信息框 (“当前数据可能没有存盘，是否关闭？”, #是否钮, ), #是钮))
    销毁 ()
.否则
    
.如果结束


.窗口程序集 窗口程序集3, , , 

.子程序 _关于窗口_创建完毕, 空白型, , 


.子程序 _关于窗口_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

关于窗口.销毁 ()

.子程序 _标签1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

关于窗口.销毁 ()


.子程序 _标签2_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

关于窗口.销毁 ()


.子程序 _标签3_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

关于窗口.销毁 ()


.子程序 _关于窗口_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

关于窗口.销毁 ()



 ' 不属于任何一个程序集、类模块的函数：
