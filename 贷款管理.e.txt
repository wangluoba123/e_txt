 ' 文件类型：Windows窗口程序

 ' 程序名称：农村信用社贷款管理系统
 ' 程序描述：
 ' 程序作者：李学锋
 ' 邮政编码：072250
 ' 联系地址：河北省顺平县信用合作社联合社
 ' 联系电话：0312-7620462
 ' 传真号码：0312-7624861
 ' 电子信箱：splsywk@sina.com.cn
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 633
    高度 = 475
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = 12632256 '  0xC0C0C0
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\贷款管理.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “农村信用社贷款管理系统(信用社版)”
    帮助文件名 = “”

窗口 封面窗口
    左边 = 50
    顶边 = 50
    宽度 = 312
    高度 = 200
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 村组维护窗口
    左边 = 50
    顶边 = 50
    宽度 = 318
    高度 = 258
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “村组维护”
    帮助文件名 = “”

窗口 科目维护窗口
    左边 = 50
    顶边 = 50
    宽度 = 465
    高度 = 278
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “贷款科目维护”
    帮助文件名 = “”

窗口 信贷人员设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 264
    高度 = 254
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “信贷人员设置”
    帮助文件名 = “”

窗口 科目调整库维护窗口
    左边 = 50
    顶边 = 50
    宽度 = 487
    高度 = 326
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “科目调整库维护”
    帮助文件名 = “”

窗口 系统定义窗口
    左边 = 50
    顶边 = 50
    宽度 = 325
    高度 = 145
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “请输入单位编号与名称”
    帮助文件名 = “”

窗口 用户设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 375
    高度 = 289
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “操作员设置”
    帮助文件名 = “”

窗口 系统日志窗口
    左边 = 50
    顶边 = 50
    宽度 = 534
    高度 = 343
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “系统日志”
    帮助文件名 = “”

窗口 登录窗口
    左边 = 50
    顶边 = 50
    宽度 = 317
    高度 = 230
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\贷款管理.e\登录窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “登录”
    帮助文件名 = “”

窗口 数据移植窗口
    左边 = 10
    顶边 = 50
    宽度 = 370
    高度 = 281
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “数据移植”
    帮助文件名 = “”

窗口 借款人信息录入窗口
    左边 = 50
    顶边 = 50
    宽度 = 456
    高度 = 315
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “添加借款人信息”
    帮助文件名 = “”

窗口 查询修改借款人信息窗口
    左边 = 50
    顶边 = 50
    宽度 = 456
    高度 = 312
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “查询/修改借款人信息”
    帮助文件名 = “”

窗口 数据移植贷款录入窗口
    左边 = 50
    顶边 = 50
    宽度 = 558
    高度 = 401
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “数据移植――贷款信息录入”
    帮助文件名 = “”

窗口 数据备份窗口
    左边 = 50
    顶边 = 50
    宽度 = 324
    高度 = 147
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “备份数据”
    帮助文件名 = “”

窗口 数据恢复窗口
    左边 = 50
    顶边 = 50
    宽度 = 328
    高度 = 169
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “恢复数据”
    帮助文件名 = “”

窗口 数据移植贷款信息修改窗口
    左边 = 50
    顶边 = 50
    宽度 = 559
    高度 = 402
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “数据移植―贷款信息修改”
    帮助文件名 = “”

窗口 数据移植贷款信息查询窗口
    左边 = 50
    顶边 = 50
    宽度 = 589
    高度 = 416
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “数据移植――贷款信息查询”
    帮助文件名 = “”

窗口 利率库维护窗口
    左边 = 50
    顶边 = 50
    宽度 = 319
    高度 = 306
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “利率库维护”
    帮助文件名 = “”

窗口 科目余额表移植窗口
    左边 = 50
    顶边 = 50
    宽度 = 669
    高度 = 369
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “科目余额表移植”
    帮助文件名 = “”

窗口 数据移植完毕处理窗口
    左边 = 50
    顶边 = 50
    宽度 = 541
    高度 = 341
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “数据移植完毕处理”
    帮助文件名 = “”

窗口 领用凭证窗口
    左边 = 50
    顶边 = 50
    宽度 = 335
    高度 = 129
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “领用凭证(借据)”
    帮助文件名 = “”

窗口 作废凭证窗口
    左边 = 50
    顶边 = 50
    宽度 = 254
    高度 = 98
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “作废凭证”
    帮助文件名 = “”

窗口 贷款发放录入窗口
    左边 = 50
    顶边 = 50
    宽度 = 558
    高度 = 353
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “贷款发放录入”
    帮助文件名 = “”

窗口 凭证领用及使用情况窗口
    左边 = 50
    顶边 = 50
    宽度 = 469
    高度 = 297
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “凭证领用及使用情况”
    帮助文件名 = “”

窗口 贷款收回录入窗口
    左边 = 50
    顶边 = 50
    宽度 = 495
    高度 = 310
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “贷款收回录入”
    帮助文件名 = “”

窗口 贷款展期窗口
    左边 = 50
    顶边 = 50
    宽度 = 495
    高度 = 219
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “贷款展期”
    帮助文件名 = “”

窗口 取消贷款发放录入窗口
    左边 = 50
    顶边 = 50
    宽度 = 516
    高度 = 267
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “取消贷款发放录入业务”
    帮助文件名 = “”

窗口 取消贷款归还录入窗口
    左边 = 50
    顶边 = 50
    宽度 = 432
    高度 = 257
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “取消贷款归还录入业务”
    帮助文件名 = “”

窗口 贷款形态调整窗口
    左边 = 50
    顶边 = 50
    宽度 = 494
    高度 = 249
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “贷款形态调整”
    帮助文件名 = “”

窗口 开工初始化窗口
    左边 = 50
    顶边 = 50
    宽度 = 259
    高度 = 132
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “日初开工”
    帮助文件名 = “”

窗口 取消形态调整窗口
    左边 = 50
    顶边 = 50
    宽度 = 462
    高度 = 234
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “取消贷款形态调整业务”
    帮助文件名 = “”

窗口 日终处理窗口
    左边 = 50
    顶边 = 50
    宽度 = 589
    高度 = 377
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “日终处理”
    帮助文件名 = “”

窗口 五级分类窗口
    左边 = 50
    顶边 = 50
    宽度 = 494
    高度 = 226
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “五级分类调整”
    帮助文件名 = “”

窗口 贷款发放情况查询窗口
    左边 = 50
    顶边 = 50
    宽度 = 688
    高度 = 481
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “条件查询”
    帮助文件名 = “”

窗口 贷款详细资料窗口
    左边 = 50
    顶边 = 50
    宽度 = 681
    高度 = 510
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “贷款详细资料”
    帮助文件名 = “”

窗口 每日提示窗口
    左边 = 50
    顶边 = 50
    宽度 = 717
    高度 = 353
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “每日提示”
    帮助文件名 = “”

窗口 贷款余额前十户窗口
    左边 = 50
    顶边 = 50
    宽度 = 681
    高度 = 510
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “贷款余额前十户统计表”
    帮助文件名 = “”

窗口 贷款归还记录窗口
    左边 = 50
    顶边 = 50
    宽度 = 502
    高度 = 300
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “贷款归还记录”
    帮助文件名 = “”

窗口 按借款人查询窗口
    左边 = 50
    顶边 = 50
    宽度 = 327
    高度 = 300
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “按借款人查询”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 324
    高度 = 223
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于”
    帮助文件名 = “”

窗口 系统初始化窗口
    左边 = 50
    顶边 = 50
    宽度 = 367
    高度 = 193
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “系统初始化”
    帮助文件名 = “”

窗口 修改密码窗口
    左边 = 50
    顶边 = 50
    宽度 = 256
    高度 = 184
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “修改用户密码”
    帮助文件名 = “”



.图片 封面图, " ' 已保存到：D:\易语言学习\Data\贷款管理.e\封面图", , 
.图片 启动窗口底图, " ' 已保存到：D:\易语言学习\Data\贷款管理.e\启动窗口底图", , 
.图片 初始化库, " ' 已保存到：D:\易语言学习\Data\贷款管理.e\初始化库", , 
.常量 数据库密码, "“123456789”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' eDB 46E94341933A462383A4DE26B146322C 1 3 数据库操作支持库
 ' ExtMenu 9909FBB013704cfa8FE7E739DB7172DE 1 6 超级菜单支持库
 ' eCompress 7B68736E818E41c5A28B0AE4D43C128C 1 0 压缩解压支持库
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 1 2 高级表格支持库
 ' EChartBar 9A3F84D7FDEB4a0486F2711D5104B7F7 1 6 数据图表支持库
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 2 2 扩展界面支持库三




.全局变量 总控时间, 日期时间型, , , 系统运行总控时间
.全局变量 系统状态, 文本型, , , 1.日间，2.日终
.全局变量 登录用户代号, 文本型, , , 当前已登录用户的代号
.全局变量 登录用户类型, 文本型, , , 已登录用类型：1.系统管理员，2.操作员
.全局变量 登录用户名称, 文本型, , , 当前已登录用户的名称
.全局变量 信用社名称, 文本型, , , 信用社(使用单位)的名称
.全局变量 信用社编号, 文本型, , , 信用社（使用单位）的编号
.全局变量 是否已移植完毕, 文本型, , , 系统是否已做移植完毕处理，1：是，0：否
.全局变量 凭证编号位数, 整数型, , , 凭证（借据）的编号位数
.全局变量 登录日期, 日期时间型, , , 当前用户登录日期
.全局变量 贷款流水号, 文本型, , , 显示单笔贷款详细资料时的贷款流水号

.窗口程序集 封面窗口程序集, , , 

.子程序 _延时时钟_周期事件, 空白型, , 
销毁 ()

.子程序 _封面窗口_创建完毕, 空白型, , 
赋值 (.图片, #封面图)

.窗口程序集 启动窗口程序集, , , 程序主窗口

.子程序 处理菜单, 空白型, , 根据用户类型等设置菜单的可用性
.如果 (等于 (是否已移植完毕, “0”))
    赋值 (.可视, 真)
.否则
    赋值 (.可视, 假)
.如果结束
赋值 (_启动窗口., 相加 (“信用社贷款管理系统(信用社版)―”, 信用社名称))
0.置文本 (相加 (“操作员：”, 登录用户代号, “|”, 登录用户名称))
.如果 (等于 (是否已移植完毕, “0”))
    1.置文本 (“账务处理日期：还未完成数据移植”)
.否则
    1.置文本 (相加 (“账务处理日期：”, 时间到文本 (总控时间, #日期部分), 系统状态))
.如果结束
2.置文本 (“已登录”)

.子程序 __启动窗口_创建完毕, 空白型, , 显示登录窗口，登录系统
赋值 (凭证编号位数, 7) ' 设置凭证编号位数，信用社借据一般7位
载入 (封面窗口, , 真)
赋值 (.图片, #启动窗口底图)
赋值 (_启动窗口., 真)
赋值 (_启动窗口., #最大化激活)
赋值 (登录用户代号, “”)
赋值 (登录用户名称, “”)
赋值 (登录用户类型, “”)
载入 (登录窗口, , 真)
处理菜单 ()
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库,请与系统管理员联系!”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
相加 (“update dk_base set yqtsh =#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “#-dqr+zhqtsh”).未知支持库函数_4 ()
未知支持库函数_3 ()

.子程序 更新系统日志, 空白型, , 更新系统日志
.参数 操作内容, 文本型, , 

相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码)
.如果真 (等于 (相加 (“insert into dk_xtrzh(dh,duser,dtime,nr) values('”, 登录用户代号, “','”, 登录用户名称, “','”, 到文本 (取年份 (取现行时间 ())), “-”, 到文本 (取月份 (取现行时间 ())), “-”, 到文本 (取日 (取现行时间 ())), “ ”, 到文本 (取小时 (取现行时间 ())), “:”, 到文本 (取分钟 (取现行时间 ())), “:”, 到文本 (取秒 (取现行时间 ())), “','”, 操作内容, “')”).未知支持库函数_4 (), 假))
    信息框 (“更新系统日志时出现错误，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
.如果真结束
未知支持库函数_3 ()

.子程序 __启动窗口_尺寸被改变, 空白型, , 
赋值 (.高度, 相减 (_启动窗口., 64))
赋值 (.宽度, 相减 (_启动窗口., 7))
.如果 (大于 (.高度, 320))
    赋值 (., 280)
.否则
    赋值 (., 相减 (.高度, 40))
.如果结束


.子程序 _退出_被选择, 空白型, , 
相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码)
.如果真 (等于 (相加 (“insert into dk_xtrzh(dh,duser,dtime,nr) values('”, 登录用户代号, “','”, 登录用户名称, “','”, 到文本 (取年份 (取现行时间 ())), “-”, 到文本 (取月份 (取现行时间 ())), “-”, 到文本 (取日 (取现行时间 ())), “ ”, 到文本 (取小时 (取现行时间 ())), “:”, 到文本 (取分钟 (取现行时间 ())), “:”, 到文本 (取秒 (取现行时间 ())), “','签退')”).未知支持库函数_4 (), 假))
    信息框 (“更新系统日志时出现错误，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
.如果真结束
未知支持库函数_3 ()
销毁 ()

.子程序 _村组维护_被选择, 空白型, , 
.如果真 (等于 (登录用户类型, “2”))
    信息框 (“您无此权限，请以系统管理员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
载入 (村组维护窗口, , 真)
更新系统日志 (“进行村组维护！”)

.子程序 _科目库维护_被选择, 空白型, , 
.如果真 (等于 (登录用户类型, “2”))
    信息框 (“您无此权限，请以系统管理员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
载入 (科目维护窗口, , 真)
更新系统日志 (“进行科目维护”)

.子程序 _信贷人员设置_被选择, 空白型, , 
.如果真 (等于 (登录用户类型, “2”))
    信息框 (“您无此权限，请以系统管理员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
载入 (信贷人员设置窗口, , 真)
更新系统日志 (“进行信贷人员设置”)

.子程序 _科目调整库维护_被选择, 空白型, , 
.如果真 (等于 (登录用户类型, “2”))
    信息框 (“您无此权限，请以系统管理员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
载入 (科目调整库维护窗口, , 真)
更新系统日志 (“进行科目调整库维护”)

.子程序 _单位名称设置_被选择, 空白型, , 
.如果真 (等于 (登录用户类型, “2”))
    信息框 (“您无此权限，请以系统管理员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
载入 (系统定义窗口, , 真)
更新系统日志 (“进行系统定义”)
处理菜单 ()

.子程序 _操作员管理_被选择, 空白型, , 
.如果真 (等于 (登录用户类型, “2”))
    信息框 (“您无此权限，请以系统管理员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
载入 (用户设置窗口, , 真)
更新系统日志 (“进行用户设置”)

.子程序 _系统日志_被选择, 空白型, , 
.如果真 (等于 (登录用户类型, “2”))
    信息框 (“您无权查看系统日志，请以系统管理员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
载入 (系统日志窗口, , 真)
更新系统日志 (“查看系统日志”)

.子程序 _数据移植_被选择, 空白型, , 
载入 (数据移植窗口, , 真)
更新系统日志 (“进行数据移植”)
处理菜单 ()

.子程序 _添加借款人_被选择, 空白型, , 
.如果真 (等于 (登录用户类型, “1”))
    信息框 (“您无此权限，请以操作员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (系统状态, “日终”))
    信息框 (“请先以系统管理员登录进行日初开工！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
载入 (借款人信息录入窗口, , 真)
更新系统日志 (“进行借款人信息维护”)

.子程序 _查询修改借款人信息_被选择, 空白型, , 
.如果真 (等于 (登录用户类型, “1”))
    信息框 (“您无此权限，请以操作员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (系统状态, “日终”))
    信息框 (“请先以系统管理员登录进行日初开工！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
载入 (查询修改借款人信息窗口, , 真)
更新系统日志 (“查询/修改借款人信息”)

.子程序 _数据备份_被选择, 空白型, , 
.如果真 (等于 (登录用户类型, “2”))
    信息框 (“您无此权限，请以系统管理员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
载入 (数据备份窗口, , 真)
更新系统日志 (“备份数据”)
处理菜单 ()

.子程序 _数据恢复_被选择, 空白型, , 
.如果真 (等于 (登录用户类型, “2”))
    信息框 (“您无此权限，请以系统管理员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
载入 (数据恢复窗口, , 真)
更新系统日志 (“恢复数据”)
处理菜单 ()

.子程序 _利率库维护_被选择, 空白型, , 
.如果真 (等于 (登录用户类型, “2”))
    信息框 (“您无此权限，请以系统管理员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
载入 (利率库维护窗口, , 真)
更新系统日志 (“维护利率”)

.子程序 _领用凭证借据_被选择, 空白型, , 
.如果真 (等于 (是否已移植完毕, “0”))
    信息框 (“请先进行数据移植!”, 相加 (#确认钮, #信息图标), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (登录用户类型, “1”))
    信息框 (“您无此权限，请以操作员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (系统状态, “日终”))
    信息框 (“请先以系统管理员登录进行日初开工！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
载入 (领用凭证窗口, , 真)
更新系统日志 (“领用凭证”)

.子程序 _作废凭证借据_被选择, 空白型, , 
.如果真 (等于 (是否已移植完毕, “0”))
    信息框 (“请先进行数据移植!”, 相加 (#确认钮, #信息图标), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (登录用户类型, “1”))
    信息框 (“您无此权限，请以操作员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (系统状态, “日终”))
    信息框 (“请先以系统管理员登录进行日初开工！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
载入 (作废凭证窗口, , 真)
更新系统日志 (“作废凭证”)

.子程序 _贷款发放录入_被选择, 空白型, , 
.如果真 (等于 (是否已移植完毕, “0”))
    信息框 (“请先进行数据移植!”, 相加 (#确认钮, #信息图标), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (登录用户类型, “1”))
    信息框 (“您无此权限，请以操作员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (系统状态, “日终”))
    信息框 (“请先以系统管理员登录进行日初开工！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
载入 (贷款发放录入窗口, , 真)
更新系统日志 (“贷款发放录入”)

.子程序 _贷款收回录入_被选择, 空白型, , 
.如果真 (等于 (是否已移植完毕, “0”))
    信息框 (“请先进行数据移植!”, 相加 (#确认钮, #信息图标), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (登录用户类型, “1”))
    信息框 (“您无此权限，请以操作员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (系统状态, “日终”))
    信息框 (“请先以系统管理员登录进行日初开工！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
载入 (贷款收回录入窗口, , 真)
更新系统日志 (“贷款收回录入”)

.子程序 _贷款展期_被选择, 空白型, , 
.如果真 (等于 (是否已移植完毕, “0”))
    信息框 (“请先进行数据移植!”, 相加 (#确认钮, #信息图标), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (登录用户类型, “1”))
    信息框 (“您无此权限，请以操作员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (系统状态, “日终”))
    信息框 (“请先以系统管理员登录进行日初开工！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
载入 (贷款展期窗口, , 真)
更新系统日志 (“进行贷款展期操作”)

.子程序 _错账修改_被选择, 空白型, , 
.如果真 (等于 (系统状态, “日间”))
    信息框 (“做日间业务时不允许修改数据，请做完日终处理后再行修改！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (登录用户类型, “2”))
    信息框 (“您无此权限，请以系统管理员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
载入 (数据移植贷款信息修改窗口, , 真)
更新系统日志 (“进行错账修改”)

.子程序 _贷款发放_被选择, 空白型, , 
.如果真 (等于 (是否已移植完毕, “0”))
    信息框 (“请先进行数据移植!”, 相加 (#确认钮, #信息图标), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (登录用户类型, “1”))
    信息框 (“您无此权限，请以操作员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (系统状态, “日终”))
    信息框 (“请先以系统管理员登录进行日初开工！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
载入 (取消贷款发放录入窗口, , 真)
更新系统日志 (“取消贷款发放录入业务”)

.子程序 _贷款收回_被选择, 空白型, , 
.如果真 (等于 (是否已移植完毕, “0”))
    信息框 (“请先进行数据移植!”, 相加 (#确认钮, #信息图标), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (登录用户类型, “1”))
    信息框 (“您无此权限，请以操作员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (系统状态, “日终”))
    信息框 (“请先以系统管理员登录进行日初开工！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
载入 (取消贷款归还录入窗口, , 真)
更新系统日志 (“取消贷款归还录入业务”)

.子程序 _贷款形态调整_被选择, 空白型, , 
.如果真 (等于 (是否已移植完毕, “0”))
    信息框 (“请先进行数据移植!”, 相加 (#确认钮, #信息图标), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (登录用户类型, “1”))
    信息框 (“您无此权限，请以操作员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (系统状态, “日终”))
    信息框 (“请先以系统管理员登录进行日初开工！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
载入 (贷款形态调整窗口, , 真)
更新系统日志 (“调整贷款形态”)

.子程序 _日初开工_被选择, 空白型, , 
.如果真 (等于 (是否已移植完毕, “0”))
    信息框 (“请先进行数据移植!”, 相加 (#确认钮, #信息图标), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (登录用户类型, “2”))
    信息框 (“您无此权限，请以系统管理员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (系统状态, “日间”))
    信息框 (“今天已做过日初开工！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
载入 (开工初始化窗口, , 真)
更新系统日志 (“日初开工”)
处理菜单 ()

.子程序 _日终处理_被选择, 空白型, , 
.如果真 (等于 (是否已移植完毕, “0”))
    信息框 (“请先进行数据移植!”, 相加 (#确认钮, #信息图标), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (登录用户类型, “2”))
    信息框 (“您无此权限，请以系统管理员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (系统状态, “日终”))
    .如果 (等于 (取时间间隔 (登录日期, 总控时间, #年份), 0))
        信息框 (“今天已做过日终处理！”, 相加 (#信息图标, #确认钮), “提示信息”)
    .否则
        信息框 (“今天还未做日初开工，请先进行日初开工！”, 相加 (#信息图标, #确认钮), “提示信息”)
    .如果结束
    返回 ()
.如果真结束
载入 (日终处理窗口, , 真)
更新系统日志 (“日终处理”)
处理菜单 ()

.子程序 _形态调整_被选择, 空白型, , 
.如果真 (等于 (是否已移植完毕, “0”))
    信息框 (“请先进行数据移植!”, 相加 (#确认钮, #信息图标), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (登录用户类型, “1”))
    信息框 (“您无此权限，请以操作员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (系统状态, “日终”))
    信息框 (“请先以系统管理员登录进行日初开工！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
载入 (取消形态调整窗口, , 真)
更新系统日志 (“取消贷款形态调整业务”)

.子程序 _重新登录_被选择, 空白型, , 
载入 (登录窗口, , 真)
更新系统日志 (“准备重新登录系统”)
处理菜单 ()

.子程序 _五级分类调整_被选择, 空白型, , 
.如果真 (等于 (是否已移植完毕, “0”))
    信息框 (“请先进行数据移植!”, 相加 (#确认钮, #信息图标), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (登录用户类型, “1”))
    信息框 (“您无此权限，请以操作员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (系统状态, “日终”))
    信息框 (“请先以系统管理员登录进行日初开工！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
载入 (五级分类窗口, , 真)
更新系统日志 (“进行五级分类调整”)

.子程序 _条件查询_被选择, 空白型, , 
载入 (贷款发放情况查询窗口, , 真)
更新系统日志 (“贷款发放情况查询”)

.子程序 _贷款归还记录_被选择, 空白型, , 
载入 (贷款归还记录窗口, , 真)
更新系统日志 (“查看贷款归还记录”)

.子程序 _每日提示_被选择, 空白型, , 
载入 (每日提示窗口, , 真)
更新系统日志 (“查看每日提示”)

.子程序 _贷款余额前十户统计表_被选择, 空白型, , 
载入 (贷款余额前十户窗口, , 真)
更新系统日志 (“查看贷款余额前十户”)

.子程序 _按贷款人查询_被选择, 空白型, , 
载入 (按借款人查询窗口, , 真)
更新系统日志 (“按借款人查询”)

.子程序 _关于_被选择, 空白型, , 
载入 (关于窗口, , 真)

.子程序 _凭证领用及使用情况_被选择, 空白型, , 
载入 (凭证领用及使用情况窗口, , 真)
更新系统日志 (“查看凭证使用及使用情况”)

.子程序 _使用说明_被选择, 空白型, , 
运行 (相加 (“explorer ”, 取运行目录 (), “\help\help.htm”), 假, #最大化激活)

.子程序 _系统初始化_被选择, 空白型, , 
.如果真 (等于 (登录用户类型, “2”))
    信息框 (“您无此权限，请以系统管理员登录！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
载入 (系统初始化窗口, , 真)
更新系统日志 (“进行系统初始化”)

.子程序 _修改密码_被选择, 空白型, , 
载入 (修改密码窗口, , 真)
更新系统日志 (“修改用户密码”)

.子程序 _卷帘式菜单1_项目被选择, 空白型, , 
.参数 菜单索引, 整数型, , 
.参数 项目索引, 整数型, , 

.判断开始 (等于 (菜单索引, 0))
    .判断开始 (等于 (项目索引, 0))
        _修改密码_被选择 ()
    .判断 (等于 (项目索引, 1))
        _重新登录_被选择 ()
    .判断 (等于 (项目索引, 2))
        _日初开工_被选择 ()
    .默认
        _日终处理_被选择 ()
    .判断结束
    
.判断 (等于 (菜单索引, 1))
    .判断开始 (等于 (项目索引, 0))
        _贷款发放录入_被选择 ()
    .判断 (等于 (项目索引, 1))
        _贷款收回录入_被选择 ()
    .默认
        _添加借款人_被选择 ()
    .判断结束
    
.判断 (等于 (项目索引, 0))
    _条件查询_被选择 ()
.判断 (等于 (项目索引, 1))
    _贷款归还记录_被选择 ()
.判断 (等于 (项目索引, 2))
    _凭证领用及使用情况_被选择 ()
.默认
    _贷款余额前十户统计表_被选择 ()
.判断结束


.窗口程序集 村组维护窗口程序集, , , 借款人所在村组维护

.程序集变量 原村组名称, 文本型, , , 用于更改村组名称时记录原村组名称
.程序集变量 操作状态, 逻辑型, , , "真":输入状态,"假":浏览状态
.程序集变量 是否添加新记录, 逻辑型, , , "真":是,"假":否
.子程序 _退出按钮_被单击, 空白型, , "真":输入状态,"假":浏览状态
.如果 (等于 (操作状态, 真))
    .如果真 (等于 (信息框 (“当前处于编辑状态，真的退出吗？”, 相加 (#信息图标, #确认取消钮), “提示信息”), #确认钮))
        销毁 ()
    .如果真结束
    
.否则
    销毁 ()
.如果结束


.子程序 _村组维护窗口_创建完毕, 空白型, , 初始化
赋值 (村组维护窗口., 相减 (相加 (村组维护窗口., 233), 村组维护窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
刷新村组列表 ()
.如果真 (大于 (取项目数 (), 0))
    赋值 (.现行选中项, 0)
    _村组列表框_列表项被选择 ()
.如果真结束
赋值 (操作状态, 假)

.子程序 设置控件属性, 空白型, , 设置窗口控件的可用性
.参数 状态, 逻辑型, , "真":输入状态,"假":浏览状态

.如果 (等于 (状态, 真))
    赋值 (.禁止, 真)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.标题, “保存”)
    赋值 (.标题, “取消”)
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.标题, “添加”)
    赋值 (.标题, “编辑”)
    赋值 (.禁止, 假)
.如果结束


.子程序 刷新村组列表, 空白型, , 重新显示村组列表
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入数值变量, 整数型, , , 

“dk_cz”.未知支持库函数_14 (2)
.如果 (.)
    清空 ()
    .如果真 (未知支持库函数_34 ())
        “name”.未知支持库函数_26 (读入文本变量)
        “id”.未知支持库函数_29 (读入数值变量)
        读入文本变量.加入项目 (读入数值变量)
        赋值 (.内容, 读入文本变量)
        “bzh”.未知支持库函数_26 (读入文本变量)
        赋值 (.内容, 读入文本变量)
        .判断循环首 (未知支持库函数_36 ())
            .如果真 (.)
                跳出循环 ()
            .如果真结束
            “name”.未知支持库函数_26 (读入文本变量)
            “id”.未知支持库函数_29 (读入数值变量)
            读入文本变量.加入项目 (读入数值变量)
        .判断循环尾 ()
    .如果真结束
    未知支持库函数_16 ()
.否则
    信息框 (“不能打开数据表，请与数据管理员联系！”, 0, “错误信息”)
    未知支持库函数_3 ()
    结束 ()
.如果结束


.子程序 _村组维护窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()

.子程序 _村组列表框_列表项被选择, 空白型, , 根据所选项刷新显示内容
.局部变量 读入文本变量, 文本型, , , 

.如果真 (不等于 (.现行选中项, -1))
    “select * from dk_cz”.未知支持库函数_14 (1)
    相加 (“name='”, .取项目文本 (.现行选中项), “'”).未知支持库函数_45 (1)
    “name”.未知支持库函数_26 (读入文本变量)
    赋值 (.内容, 读入文本变量)
    “bzh”.未知支持库函数_26 (读入文本变量)
    赋值 (.内容, 读入文本变量)
    “dy”.未知支持库函数_26 (读入文本变量)
    .判断开始 (等于 (读入文本变量, “1”))
        赋值 (.现行选中项, 0)
    .判断 (等于 (读入文本变量, “2”))
        赋值 (.现行选中项, 1)
    .默认
        赋值 (.现行选中项, 2)
    .判断结束
    未知支持库函数_16 ()
    获取焦点 ()
.如果真结束


.子程序 _添加按钮_被单击, 空白型, , 更新村组记录
.局部变量 列表索引, 整数型, , , 

.如果 (等于 (操作状态, 真)) ' 录入状态
    .如果 (或者 (不等于 (删首尾空 (.内容), “”), 不等于 (.现行选中项, -1)))
        .如果 (等于 (是否添加新记录, 真))
            .如果 (相加 (“insert into dk_cz(name,bzh,dy) values('”, 删首尾空 (.内容), “','”, 删首尾空 (.内容), “','”, 删首尾空 (到文本 (相加 (.现行选中项, 1))), “')”).未知支持库函数_4 ()) ' 添加记录
                刷新村组列表 ()
                赋值 (.现行选中项, 相减 (取项目数 (), 1))
                _村组列表框_列表项被选择 ()
                赋值 (操作状态, 假)
                设置控件属性 (操作状态)
                获取焦点 ()
            .否则
                信息框 (“添加失败，请检查村组名称是否重复！”, 0, “错误提示”)
                获取焦点 ()
            .如果结束
            
        .否则
            赋值 (列表索引, .现行选中项)
            .如果 (相加 (“update dk_cz set name='”, 删首尾空 (.内容), “',bzh='”, 删首尾空 (.内容), “',dy='”, 删首尾空 (到文本 (相加 (.现行选中项, 1))), “' where id=”, 到文本 (.取项目数值 (.现行选中项))).未知支持库函数_4 ()) ' 修改记录
                刷新村组列表 ()
                赋值 (.现行选中项, 列表索引)
                _村组列表框_列表项被选择 ()
                赋值 (操作状态, 假)
                设置控件属性 (操作状态)
                获取焦点 ()
            .否则
                信息框 (“添加失败，请检查村组名称是否重复！”, 0, “错误提示”)
                获取焦点 ()
            .如果结束
            
        .如果结束
        
    .否则
        信息框 (“村组名称或地域性质不能为空！”, 0, “错误提示”)
        获取焦点 ()
    .如果结束
    
.否则
     ' 浏览状态
    赋值 (.内容, “”)
    赋值 (是否添加新记录, 真)
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
    赋值 (操作状态, 真)
    设置控件属性 (操作状态)
    获取焦点 ()
.如果结束


.子程序 _编辑按钮_被单击, 空白型, , 编辑或取消编辑
.局部变量 列表索引, 整数型, , , 

.如果 (等于 (操作状态, 真)) ' 编辑状态
    .如果真 (等于 (是否添加新记录, 真))
        赋值 (.现行选中项, 相减 (取项目数 (), 1))
    .如果真结束
    _村组列表框_列表项被选择 ()
    赋值 (操作状态, 假)
    设置控件属性 (操作状态)
    获取焦点 ()
.否则
    赋值 (操作状态, 真)
    设置控件属性 (操作状态)
    获取焦点 ()
.如果结束


.子程序 _删除按钮_被单击, 空白型, , 删除一条记录
.局部变量 村组列表索引, 空白型, , , 

.如果真 (大于或等于 (.现行选中项, 0))
    .如果真 (等于 (信息框 (“真的删除此村组吗?”, 相加 (#确认取消钮, #询问图标, #默认按钮二), “提示信息”), #确认钮))
        赋值 (村组列表索引, .现行选中项)
        .如果 (相加 (“delete from dk_cz where name='”, 村组列表索引.取项目文本 (), “'”).未知支持库函数_4 ()) ' 删除记录
            刷新村组列表 ()
            赋值 (.现行选中项, 相减 (村组列表索引, 1))
        .否则
            信息框 (“不能删除此村组!”, 0, “提示信息”)
        .如果结束
        
    .如果真结束
    
.如果真结束


.子程序 _名称编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _地域性质组合框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.窗口程序集 科目设置窗口程序集, , , 

.程序集变量 是否添加新记录, 逻辑型, , , 存盘时是否添加新的记录
.程序集变量 操作状态, 逻辑型, , , 真：编辑状态，假：浏览状态
.子程序 _退出按钮_被单击, 空白型, , 
.如果 (等于 (操作状态, 真))
    .如果真 (等于 (信息框 (“当前正处于编辑状态，真的退出吗？”, 相加 (#信息图标, #确认取消钮), “提示信息”), #确认钮))
        销毁 ()
    .如果真结束
    
.否则
    销毁 ()
.如果结束


.子程序 设置控件属性, 空白型, , 根据操作状态设置控件属性
.参数 状态, 逻辑型, , 

.如果 (等于 (状态, 真))
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.字体名称, 真)
    赋值 (.标题, “保 存”)
    赋值 (.标题, “取 消”)
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.字体名称, 假)
    赋值 (.标题, “添 加”)
    赋值 (.标题, “编 辑”)
    赋值 (.禁止, 假)
.如果结束


.子程序 _科目维护窗口_创建完毕, 空白型, , 初始化
赋值 (科目维护窗口., 相减 (相加 (科目维护窗口., 253), 科目维护窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库,请与管理员联系!”, #错误图标, “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
刷新科目列表 ()
赋值 (操作状态, 假)

.子程序 刷新科目列表, 空白型, , 重新显示科目列表
.局部变量 读入文本变量, 文本型, , , 
.局部变量 插入的位置, 整数型, , , 

“select * from dk_kms order by id asc”.未知支持库函数_14 (1)
.如果 (.)
    全部删除 ()
    .如果真 (未知支持库函数_34 ())
        .判断循环首 (等于 (., 假))
            “id”.未知支持库函数_26 (读入文本变量)
            赋值 (插入的位置, -1.插入表项 (读入文本变量, , , , ))
            “name”.未知支持库函数_26 (读入文本变量)
            插入的位置.置标题 (1, 读入文本变量)
            “type”.未知支持库函数_26 (读入文本变量)
            插入的位置.置标题 (2, 读入文本变量)
            未知支持库函数_36 ()
        .判断循环尾 ()
        赋值 (., 0)
        _科目列表框_当前表项被改变 ()
    .如果真结束
    未知支持库函数_16 ()
.否则
    信息框 (“无法打开数据表,请与数据管理员联系!”, 相加 (#错误图标, #确认钮), “提示信息”)
    未知支持库函数_3 ()
    结束 ()
.如果结束


.子程序 _科目维护窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()

.子程序 _科目列表框_当前表项被改变, 空白型, , 刷新显示
.局部变量 占用形态, 文本型, , , 

.如果真 (等于 (., -1))
    返回 ()
.如果真结束
赋值 (.内容, .取标题 (., 0))
赋值 (.内容, .取标题 (., 1))
赋值 (占用形态, .取标题 (., 2))
.判断开始 (等于 (占用形态, “正常”))
    赋值 (.现行选中项, 0)
.判断 (等于 (占用形态, “逾期”))
    赋值 (.现行选中项, 1)
.判断 (等于 (占用形态, “呆滞”))
    赋值 (.现行选中项, 2)
.默认
    赋值 (.现行选中项, 3)
.判断结束
获取焦点 ()

.子程序 _添加按钮_被单击, 空白型, , 更新数据
.如果 (等于 (操作状态, 真)) ' 编辑状态
    .如果 (等于 (是否添加新记录, 真))
        .如果 (并且 (不等于 (删首尾空 (.内容), “”), 不等于 (删首尾空 (.内容), “”), 不等于 (删首尾空 (.内容), “”)))
            .如果 (相加 (“insert into dk_kms(id,name,type) values('”, 删首尾空 (.内容), “','”, 删首尾空 (.内容), “','”, 删首尾空 (.内容), “')”).未知支持库函数_4 ()) ' 添加记录
                刷新科目列表 ()
                赋值 (., 0)
                赋值 (操作状态, 假)
                设置控件属性 (操作状态)
                _科目列表框_当前表项被改变 ()
                获取焦点 ()
            .否则
                信息框 (“不能添加记录！”, #错误图标, “提示信息”)
                获取焦点 ()
            .如果结束
            
        .否则
            信息框 (“请将科目代号、科目名称、占用形态填写完整！”, #错误图标, “提示信息”)
            获取焦点 ()
        .如果结束
        
    .否则
        .如果 (并且 (不等于 (删首尾空 (.内容), “”), 不等于 (删首尾空 (.内容), “”), 不等于 (删首尾空 (.内容), “”), 不等于 (., -1)))
            .如果 (相加 (“update dk_kms set id='”, 删首尾空 (.内容), “',name='”, 删首尾空 (.内容), “',type='”, 删首尾空 (.内容), “' where id='”, .取标题 (., 0), “'”).未知支持库函数_4 ()) ' 修改记录
                刷新科目列表 ()
                赋值 (., 0)
                赋值 (操作状态, 假)
                设置控件属性 (操作状态)
                _科目列表框_当前表项被改变 ()
                获取焦点 ()
            .否则
                信息框 (“不能更改记录！”, #错误图标, “提示信息”)
                获取焦点 ()
            .如果结束
            
        .否则
            信息框 (“请将科目代号、科目名称、占用形态填写完整！”, #错误图标, “提示信息”)
            获取焦点 ()
        .如果结束
        
    .如果结束
    
.否则
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.现行选中项, -1)
    赋值 (是否添加新记录, 真)
    赋值 (操作状态, 真)
    设置控件属性 (操作状态)
    获取焦点 ()
.如果结束


.子程序 _编辑按钮_被单击, 空白型, , 编辑/取消编辑
.如果 (等于 (操作状态, 真))
    .如果真 (不等于 (., -1))
        _科目列表框_当前表项被改变 ()
    .如果真结束
    赋值 (操作状态, 假)
    设置控件属性 (操作状态)
    获取焦点 ()
.否则
    .如果真 (不等于 (., -1))
        赋值 (操作状态, 真)
        赋值 (是否添加新记录, 假)
        设置控件属性 (操作状态)
        获取焦点 ()
    .如果真结束
    
.如果结束


.子程序 _删除按钮_被单击, 空白型, , 删除记录
.如果真 (大于或等于 (., 0))
    .如果真 (等于 (信息框 (“真的删除此科目吗?”, 相加 (#确认取消钮, #询问图标, #默认按钮二), “提示信息”), #确认钮))
        .如果 (相加 (“delete from dk_kms where id='”, .取标题 (., 0), “'”).未知支持库函数_4 ())
            刷新科目列表 ()
        .否则
            信息框 (“不能删除此科目”, #错误图标, “提示信息”)
        .如果结束
        
    .如果真结束
    
.如果真结束


.子程序 _科目代号编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _科目名称编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _占用形态组合框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _添加按钮_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _添加按钮_被单击 ()
.如果真结束


.窗口程序集 信贷人员设置窗口程序集, , , 设置信贷人员

.程序集变量 是否添加新记录, 逻辑型, , , 存盘是是否添加新记录
.程序集变量 操作状态, 逻辑型, , , 1：编辑状态，0：浏览状态
.子程序 _退出按钮_被单击, 空白型, , 
.如果 (等于 (操作状态, 真)) ' 数据款存盘
    .如果真 (等于 (信息框 (“当前正处于编辑状态，真的退出吗？”, 相加 (#信息图标, #确认取消钮), “提示信息”), #确认钮))
        销毁 ()
    .如果真结束
    
.否则
    销毁 ()
.如果结束


.子程序 设置控件属性, 空白型, , 根据操作状态设置控件属性
.参数 状态, 逻辑型, , 

.如果 (等于 (状态, 真)) ' 编辑状态
    赋值 (.禁止, 假)
    赋值 (.标题, “保存”)
    赋值 (.标题, “取消”)
    赋值 (.禁止, 真)
    赋值 (.字体名称, 真)
.否则
     ' 浏览状态
    赋值 (.禁止, 真)
    赋值 (.标题, “添加”)
    赋值 (.标题, “编辑”)
    赋值 (.禁止, 假)
    赋值 (.字体名称, 假)
.如果结束


.子程序 刷新信贷人员列表, 空白型, , 重新显示信贷人员列表
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入数值变量, 整数型, , , 

“dk_xdy”.未知支持库函数_14 (2)
.如果 (.)
    全部删除 ()
    .如果真 (未知支持库函数_34 ())
        .判断循环首 (等于 (., 假))
            “name”.未知支持库函数_26 (读入文本变量)
            “id”.未知支持库函数_29 (读入数值变量)
            -1.插入表项 (读入文本变量, , , , 读入数值变量)
            未知支持库函数_36 ()
        .判断循环尾 ()
    .如果真结束
    未知支持库函数_16 ()
.否则
    未知支持库函数_3 ()
    信息框 (“无法打开数据表！”, #错误图标, “提示信息”)
    结束 ()
.如果结束


.子程序 _信贷人员设置窗口_创建完毕, 空白型, , 
赋值 (信贷人员设置窗口., 相减 (相加 (信贷人员设置窗口., 229), 信贷人员设置窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
刷新信贷人员列表 ()
.如果真 (大于 (取表项数 (), 0))
    赋值 (., 0)
.如果真结束
赋值 (操作状态, 假)

.子程序 _添加按钮_被单击, 空白型, , 更新数据
.局部变量 选中项, 整数型, , , 

.如果 (等于 (操作状态, 真)) ' 如为编辑状态，则保存数据
    .如果 (等于 (是否添加新记录, 真))
        .如果 (不等于 (删首尾空 (.内容), “”))
            .如果 (相加 (“insert into dk_xdy(name) values('”, 删首尾空 (.内容), “')”).未知支持库函数_4 ())
                刷新信贷人员列表 ()
                赋值 (., 相减 (取表项数 (), 1))
                赋值 (操作状态, 假)
                设置控件属性 (操作状态)
                获取焦点 ()
            .否则
                信息框 (“添加数据失败，请检查输入是否正确！”, 相加 (#错误图标, #确认钮), “提示信息”)
                获取焦点 ()
            .如果结束
            
        .否则
            信息框 (“请输入信贷人员姓名！”, 相加 (#信息图标, #确认钮), “提示信息”)
            获取焦点 ()
        .如果结束
        
    .否则
        .如果 (并且 (不等于 (删首尾空 (.内容), “”), 不等于 (., -1)))
            赋值 (选中项, .)
            .如果 (相加 (“update dk_xdy set name='”, 删首尾空 (.内容), “'  where id=”, 到文本 (.取表项数值 (.))).未知支持库函数_4 ())
                刷新信贷人员列表 ()
                赋值 (., 选中项)
                赋值 (操作状态, 假)
                设置控件属性 (操作状态)
                获取焦点 ()
            .否则
                信息框 (“修改数据失败，请检查输入是否正确！”, 相加 (#错误图标, #确认钮), “提示信息”)
                获取焦点 ()
            .如果结束
            
        .否则
            信息框 (“请输入信贷人员姓名！”, 相加 (#信息图标, #确认钮), “提示信息”)
            获取焦点 ()
        .如果结束
        
    .如果结束
    
.否则
     ' 添加新记录
    赋值 (.内容, “”)
    赋值 (操作状态, 真)
    赋值 (是否添加新记录, 真)
    设置控件属性 (操作状态)
    获取焦点 ()
.如果结束


.子程序 _信贷人员设置窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()

.子程序 _信代员列表框_当前表项被改变, 空白型, , 
赋值 (.内容, .取标题 (., ))

.子程序 _删除按钮_被单击, 空白型, , 删除记录
.局部变量 选中项, 整数型, , , 

.如果真 (不等于 (., -1))
    .如果真 (等于 (信息框 (“真的删除此信贷人员吗？”, 相加 (#询问图标, #确认取消钮, #默认按钮二), “提示信息”), #确认钮))
        赋值 (选中项, .)
        .如果 (相加 (“delete from dk_xdy where id=”, 到文本 (.取表项数值 (.))).未知支持库函数_4 ())
            刷新信贷人员列表 ()
            .如果真 (小于 (取表项数 (), 1))
                赋值 (选中项, -1)
            .如果真结束
            赋值 (., 选中项)
        .否则
            信息框 (“删除记录失败，请检查！”, 相加 (#错误图标, #确认钮), “提示信息”)
        .如果结束
        
    .如果真结束
    
.如果真结束


.子程序 _编辑按钮_被单击, 空白型, , 编辑/取消编辑
.如果 (等于 (操作状态, 真))
    .如果真 (等于 (是否添加新记录, 真))
        赋值 (., 相减 (取表项数 (), 1))
    .如果真结束
    赋值 (操作状态, 假)
    设置控件属性 (操作状态)
    获取焦点 ()
.否则
    赋值 (操作状态, 真)
    赋值 (是否添加新记录, 假)
    设置控件属性 (操作状态)
    获取焦点 ()
.如果结束


.子程序 _信贷人员编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _添加按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _添加按钮_被单击 ()
.如果真结束


.窗口程序集 科目调整库维护窗口程序集, , , 科目调整库维护代码

.程序集变量 科目名称, 文本型, , "0", 存储所有的科目名称
.程序集变量 操作状态, 逻辑型, , , 真：编辑状态，假：浏览状态
.程序集变量 是否添加新记录, 逻辑型, , , 存盘是是否添加为新的记录
.子程序 刷新科目调整列表, 空白型, , 根据科目调整库信息刷新科目调整列表
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入数值变量, 整数型, , , 
.局部变量 插入的位置, 整数型, , , 

“select * from dk_kmtzhs order by id”.未知支持库函数_14 (1)
.如果真 (等于 (., 假))
    信息框 (“无法打开数据表，请与数据管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    未知支持库函数_3 ()
    结束 ()
.如果真结束
全部删除 ()
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “ykm”.未知支持库函数_26 (读入文本变量)
        “id”.未知支持库函数_29 (读入数值变量)
        赋值 (插入的位置, -1.插入表项 (读入文本变量, , , , 读入数值变量))
        “yname”.未知支持库函数_26 (读入文本变量)
        插入的位置.置标题 (1, 读入文本变量)
        “mkm”.未知支持库函数_26 (读入文本变量)
        插入的位置.置标题 (2, 读入文本变量)
        “mname”.未知支持库函数_26 (读入文本变量)
        插入的位置.置标题 (3, 读入文本变量)
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()

.子程序 设置控件属性, 空白型, , 设置控件的可用性
.参数 状态, 逻辑型, , "真":输入状态，"假":浏览状态

.如果 (等于 (状态, 真))
    赋值 (.字体名称, 真)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.标题, “保  存”)
    赋值 (.标题, “取  消”)
    赋值 (.禁止, 真)
.否则
    赋值 (.字体名称, 假)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.标题, “添  加”)
    赋值 (.标题, “编  辑”)
    赋值 (.禁止, 假)
.如果结束


.子程序 _科目调整库维护窗口_创建完毕, 空白型, , 初始化
.局部变量 读入科目名称, 文本型, , , 
.局部变量 读入科目代码, 文本型, , , 

赋值 (科目调整库维护窗口., 相减 (相加 (科目调整库维护窗口., 301), 科目调整库维护窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 0, “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
 ' 载入科目信息
“select * from dk_kms order by id”.未知支持库函数_14 (1)
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “id”.未知支持库函数_26 (读入科目代码)
        “name”.未知支持库函数_26 (读入科目名称)
        读入科目代码.加入项目 ()
        读入科目代码.加入项目 ()
        加入成员 (科目名称, 读入科目名称)
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()
刷新科目调整列表 ()
.如果真 (大于 (取表项数 (), 0))
    赋值 (., 0)
.如果真结束
赋值 (操作状态, 假)

.子程序 _退出按钮_被单击, 空白型, , 
.如果 (等于 (操作状态, 真))
    .如果真 (等于 (信息框 (“当前正处于编辑状态，真的退出吗？”, 相加 (#信息图标, #确认取消钮), “提示信息”), #确认钮))
        销毁 ()
    .如果真结束
    
.否则
    销毁 ()
.如果结束


.子程序 _科目调整列表框_当前表项被改变, 空白型, , 刷新显示内容
.局部变量 循环变量, 整数型, , , 
.局部变量 总项数, 整数型, , , 

赋值 (总项数, 取项目数 ())
赋值 (循环变量, 0)
.判断循环首 (小于 (循环变量, 总项数))
    .如果真 (等于 (循环变量.取项目文本 (), .取标题 (., 0)))
        赋值 (.现行选中项, 循环变量)
        赋值 (.内容, .取标题 (., 1))
        跳出循环 ()
    .如果真结束
    赋值 (循环变量, 相加 (循环变量, 1))
.判断循环尾 ()
赋值 (总项数, 取项目数 ())
赋值 (循环变量, 0)
.判断循环首 (小于 (循环变量, 总项数))
    .如果真 (等于 (循环变量.取项目文本 (), .取标题 (., 2)))
        赋值 (.现行选中项, 循环变量)
        赋值 (.内容, .取标题 (., 3))
        跳出循环 ()
    .如果真结束
    赋值 (循环变量, 相加 (循环变量, 1))
.判断循环尾 ()


.子程序 _源科目组合框_列表项被选择, 空白型, , 根据科目代号读取科目名称
赋值 (.内容, 科目名称 [相加 (.现行选中项, 1)])

.子程序 _目标科目组合框_列表项被选择, 空白型, , 根据科目代号读取科目名称
.如果真 (不等于 (.现行选中项, -1))
    赋值 (.内容, 科目名称 [相加 (.现行选中项, 1)])
.如果真结束


.子程序 _添加按钮_被单击, 空白型, , 更新数据
.局部变量 选中项, 整数型, , , 

.如果 (等于 (操作状态, 真)) ' 编辑状态
    .如果 (并且 (不等于 (.内容, “”), 不等于 (.内容, “”)))
        .如果 (等于 (是否添加新记录, 真))
            .如果 (相加 (“insert into dk_kmtzhs(ykm,yname,mkm,mname) values('”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “')”).未知支持库函数_4 ()) ' 添加记录
                刷新科目调整列表 ()
                赋值 (., 相减 (取表项数 (), 1))
                赋值 (操作状态, 假)
                设置控件属性 (操作状态)
                _科目调整列表框_当前表项被改变 ()
                获取焦点 ()
            .否则
                信息框 (“添加数据失败，请检查输入是否正确！”, 相加 (#错误图标, #确认钮), “提示信息”)
                获取焦点 ()
            .如果结束
            
        .否则
            .如果 (并且 (不等于 (.内容, “”), 不等于 (.内容, “”), 不等于 (., -1)))
                赋值 (选中项, .)
                .如果 (相加 (“update dk_kmtzhs set ykm='”, .内容, “', yname='”, .内容, “',mkm='”, .内容, “',mname='”, .内容, “' where id=”, 到文本 (.取表项数值 (.))).未知支持库函数_4 ()) ' 修改记录
                    刷新科目调整列表 ()
                    赋值 (., 选中项)
                    赋值 (操作状态, 假)
                    设置控件属性 (操作状态)
                    获取焦点 ()
                .否则
                    信息框 (“修改数据失败，请检查输入是否正确！”, 相加 (#错误图标, #确认钮), “提示信息”)
                .如果结束
                
            .否则
                信息框 (“源科目和目标科目不能为空！”, 相加 (#信息图标, #确认钮), “提示信息”)
                获取焦点 ()
            .如果结束
            
        .如果结束
        
    .否则
        信息框 (“源科目和目标科目不能为空！”, 相加 (#信息图标, #确认钮), “提示信息”)
        获取焦点 ()
    .如果结束
    
.否则
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
    赋值 (是否添加新记录, 真)
    赋值 (操作状态, 真)
    设置控件属性 (操作状态)
    获取焦点 ()
.如果结束


.子程序 _编辑按钮_被单击, 空白型, , 编辑/取消编辑
.如果 (等于 (操作状态, 真)) ' 编辑状态
    .如果真 (等于 (是否添加新记录, 真))
        赋值 (., 相减 (取表项数 (), 1))
    .如果真结束
    赋值 (操作状态, 假)
    设置控件属性 (操作状态)
    _科目调整列表框_当前表项被改变 ()
    获取焦点 ()
.否则
    .如果真 (不等于 (., -1))
        赋值 (是否添加新记录, 假)
        赋值 (操作状态, 真)
        设置控件属性 (操作状态)
        获取焦点 ()
    .如果真结束
    
.如果结束


.子程序 _科目调整库维护窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()

.子程序 _删除按钮_被单击, 空白型, , 删除记录
.局部变量 选中项, 整数型, , , 

.如果真 (不等于 (., -1))
    .如果真 (等于 (信息框 (“真的删除此条记录吗？”, 相加 (#询问图标, #确认取消钮, #默认按钮二), “提示信息”), #确认钮))
        赋值 (选中项, .)
        .如果 (相加 (“delete from dk_kmtzhs where id=”, 到文本 (.取表项数值 (.))).未知支持库函数_4 ())
            刷新科目调整列表 ()
            .如果真 (小于 (取表项数 (), 1))
                赋值 (选中项, -1)
            .如果真结束
            赋值 (., 选中项)
        .否则
            信息框 (“删除记录失败，请检查！”, 相加 (#错误图标, #确认钮), “提示信息”)
        .如果结束
        
    .如果真结束
    
.如果真结束


.窗口程序集 系统定义窗口程序集, , , 设置单位编号和名称

.子程序 _系统定义窗口_创建完毕, 空白型, , 初始化窗口
.局部变量 读入文本变量, 文本型, , , 
.局部变量 临时变量, 整数型, , , 

赋值 (系统定义窗口., 相减 (相加 (系统定义窗口., 120), 系统定义窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
 ' 读入原先单位编号和名称
赋值 (临时变量, 1)
.判断循环首 (小于 (临时变量, 10000))
    .如果 (小于 (临时变量, 10))
        相加 (“000”, 删首尾空 (到文本 (临时变量))).加入项目 ()
    .否则
        .如果 (小于 (临时变量, 100))
            相加 (“00”, 删首尾空 (到文本 (临时变量))).加入项目 ()
        .否则
            .如果 (小于 (临时变量, 1000))
                相加 (“0”, 删首尾空 (到文本 (临时变量))).加入项目 ()
            .否则
                删首尾空 (到文本 (临时变量)).加入项目 ()
            .如果结束
            
        .如果结束
        
    .如果结束
    赋值 (临时变量, 相加 (临时变量, 1))
.判断循环尾 ()
“dk_system”.未知支持库函数_14 (2)
“dwid”.未知支持库函数_26 (读入文本变量)
赋值 (.内容, 删首尾空 (读入文本变量))
“dwname”.未知支持库函数_26 (读入文本变量)
赋值 (.内容, 删首尾空 (读入文本变量))
未知支持库函数_16 ()

.子程序 _取消按钮_被单击, 空白型, , 放弃存盘
销毁 ()

.子程序 _确定按钮_被单击, 空白型, , 保存数据
.如果 (或者 (不等于 (取文本长度 (删首尾空 (.内容)), 4), 等于 (删首尾空 (.内容), “”)))
    信息框 (“请正确输入单位编号与名称！”, 相加 (#错误图标, #确认钮), “提示信息”)
.否则
    .如果 (等于 (相加 (“update dk_system set dwid='”, 删首尾空 (.内容), “',dwname='”, 删首尾空 (.内容), “'”).未知支持库函数_4 (), 假))
        信息框 (“保存数据时出错，请检查！”, 相加 (#错误图标, #确认钮), “提示信息”)
    .否则
        赋值 (信用社编号, 删首尾空 (.内容))
        赋值 (信用社名称, .内容)
        销毁 ()
    .如果结束
    
.如果结束


.子程序 _系统定义窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()

.窗口程序集 用户设置窗口程序集, , , 设置操作用户

.程序集变量 用户密码组, 文本型, , "0", 记录所有用户密码
.程序集变量 是否添加新记录, 逻辑型, , , 是否是添加新的记录
.程序集变量 操作状态, 逻辑型, , , 1：编辑状态，0：浏览状态
.子程序 _退出按钮_被单击, 空白型, , 
.如果 (等于 (操作状态, 真)) ' 数据未存盘
    .如果真 (等于 (信息框 (“当前正处于编辑状态，真的退出吗？”, 相加 (#信息图标, #确认取消钮), “提示信息”), #确认钮))
        销毁 ()
    .如果真结束
    
.否则
    销毁 ()
.如果结束


.子程序 设置控件属性, 空白型, , 根据操作状态设置控件属性
.参数 状态, 逻辑型, , 

.如果 (等于 (状态, 真)) ' 编辑状态
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.标题, “保 存”)
    赋值 (.标题, “取 消”)
    赋值 (.禁止, 真)
    赋值 (.字体名称, 真)
.否则
     ' 浏览状态
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.标题, “添 加”)
    赋值 (.标题, “编 辑”)
    赋值 (.禁止, 假)
    赋值 (.字体名称, 假)
.如果结束


.子程序 _用户设置窗口_创建完毕, 空白型, , 
赋值 (用户设置窗口., 相减 (相加 (用户设置窗口., 264), 用户设置窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
刷新用户列表 ()
.如果真 (大于 (取表项数 (), 0))
    赋值 (., 0)
.如果真结束
赋值 (操作状态, 假)

.子程序 刷新用户列表, 空白型, , 重新显示操作用户列表
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入数值变量, 整数型, , , 
.局部变量 插入的位置, 整数型, , , 

“select * from dk_user order by job”.未知支持库函数_14 (1)
全部删除 ()
清除数组 (用户密码组)
.如果真 (等于 (., 假))
    信息框 (“无法打开数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    未知支持库函数_3 ()
    结束 ()
.如果真结束
.如果真 (未知支持库函数_34 ()) ' 记录不为空
    .判断循环首 (等于 (., 假))
        “dh”.未知支持库函数_26 (读入文本变量)
        赋值 (插入的位置, -1.插入表项 (读入文本变量, , , 0, ))
        “name”.未知支持库函数_26 (读入文本变量)
        插入的位置.置标题 (1, 读入文本变量)
        “mm”.未知支持库函数_26 (读入文本变量)
        插入的位置.置标题 (2, “******”)
        加入成员 (用户密码组, 读入文本变量)
        “job”.未知支持库函数_26 (读入文本变量)
        .如果 (等于 (读入文本变量, “1”))
            插入的位置.置标题 (3, “系统管理员”)
        .否则
            插入的位置.置标题 (3, “操作员”)
        .如果结束
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()

.子程序 _用户列表框_当前表项被改变, 空白型, , 显示数据
.如果真 (不等于 (., -1))
    赋值 (.内容, .取标题 (., 0))
    赋值 (.内容, .取标题 (., 1))
    赋值 (.内容, 用户密码组 [相加 (., 1)])
    获取焦点 ()
.如果真结束


.子程序 _添加按钮_被单击, 空白型, , 更新数据
.局部变量 当前选中项, 整数型, , , 

.如果真 (或者 (等于 (删首尾空 (.内容), “”), 等于 (删首尾空 (.内容), “”), 等于 (删首尾空 (.内容), “”)))
    信息框 (“用户代号、名称和密码均不能为空！”, 相加 (#错误图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果 (等于 (操作状态, 真)) ' 如为编辑状态，则保存数据
    .如果 (等于 (是否添加新记录, 真))
        .如果 (相加 (“insert into dk_user(name,mm,job,dh) values('”, 删首尾空 (.内容), “','”, 删首尾空 (.内容), “','2','”, 删首尾空 (.内容), “')”).未知支持库函数_4 ())
            刷新用户列表 ()
            赋值 (., 相减 (取表项数 (), 1))
            _用户列表框_当前表项被改变 ()
            赋值 (操作状态, 假)
            设置控件属性 (操作状态)
            获取焦点 ()
        .否则
            信息框 (“添加用户失败，请检查输入是否正确！”, 相加 (#错误图标, #确认钮), “提示信息”)
            获取焦点 ()
        .如果结束
        
    .否则
        赋值 (当前选中项, .)
        .如果 (相加 (“update dk_user set dh='”, 删首尾空 (.内容), “',name='”, 删首尾空 (.内容), “',mm='”, 删首尾空 (.内容), “' where dh='”, 删首尾空 (.取标题 (., 0)), “'”).未知支持库函数_4 ())
            刷新用户列表 ()
            赋值 (., 当前选中项)
            _用户列表框_当前表项被改变 ()
            赋值 (操作状态, 假)
            设置控件属性 (操作状态)
            获取焦点 ()
        .否则
            信息框 (“更新失败，请检查输入是否正确！”, 相加 (#错误图标, #确认钮), “提示信息”)
            获取焦点 ()
        .如果结束
        
    .如果结束
    
.否则
     ' 设置编辑状态，添加新记录
    赋值 (操作状态, 真)
    赋值 (是否添加新记录, 真)
    设置控件属性 (操作状态)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    获取焦点 ()
.如果结束


.子程序 _编辑按钮_被单击, 空白型, , 编辑/取消编辑
.如果 (等于 (操作状态, 真))
    .如果真 (等于 (是否添加新记录, 真))
        赋值 (., 相减 (取表项数 (), 1))
    .如果真结束
    _用户列表框_当前表项被改变 ()
    赋值 (操作状态, 假)
    设置控件属性 (操作状态)
    获取焦点 ()
.否则
    赋值 (操作状态, 真)
    赋值 (是否添加新记录, 假)
    设置控件属性 (操作状态)
    获取焦点 ()
.如果结束


.子程序 _删除按钮_被单击, 空白型, , 删除记录
.局部变量 当前选中项, 整数型, , , 

.如果真 (不等于 (., -1))
    .如果真 (等于 (信息框 (“真的删除此用户吗？”, 相加 (#询问图标, #确认取消钮, #默认按钮二), “提示信息”), #确认钮))
        赋值 (当前选中项, .)
        .如果真 (等于 (.取标题 (., 3), “系统管理员”))
            信息框 (“对不起，不能删除系统管理员！”, 相加 (#错误图标, #确认钮), “提示信息”)
            返回 ()
        .如果真结束
        .如果 (相加 (“delete from dk_user where dh='”, 删首尾空 (.取标题 (., 0)), “'”).未知支持库函数_4 ())
            刷新用户列表 ()
            .如果 (大于 (取表项数 (), 0))
                .如果 (大于或等于 (当前选中项, 取表项数 ()))
                    赋值 (., 相减 (当前选中项, 1))
                .否则
                    赋值 (., 当前选中项)
                .如果结束
                
            .否则
                赋值 (., -1)
            .如果结束
            _用户列表框_当前表项被改变 ()
        .否则
            信息框 (“删除用户失败，请检查！”, 相加 (#错误图标, #确认钮), “提示信息”)
        .如果结束
        
    .如果真结束
    
.如果真结束


.子程序 _代码编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _名称编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _密码编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _添加按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _添加按钮_被单击 ()
.如果真结束


.窗口程序集 系统日志窗口程序集, , , 查看系统日志

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _系统日志窗口_创建完毕, 空白型, , 
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入时间变量, 日期时间型, , , 
.局部变量 插入的位置, 整数型, , , 

赋值 (系统日志窗口., 相减 (相加 (系统日志窗口., 318), 系统日志窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
 ' 显示系统日志
“dk_xtrzh”.未知支持库函数_14 (2)
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “dh”.未知支持库函数_26 (读入文本变量)
        赋值 (插入的位置, -1.插入表项 (读入文本变量, , , , ))
        “duser”.未知支持库函数_26 (读入文本变量)
        插入的位置.置标题 (1, 读入文本变量)
        “dtime”.未知支持库函数_31 (读入时间变量)
        插入的位置.置标题 (2, 时间到文本 (读入时间变量, #全部转换))
        “nr”.未知支持库函数_26 (读入文本变量)
        插入的位置.置标题 (3, 读入文本变量)
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()

.子程序 _清空日志按钮_被单击, 空白型, , 清除日志
.如果真 (大于 (取表项数 (), 0))
    .如果真 (等于 (信息框 (“真的要清空系统日志码？”, 相加 (#询问图标, #确认取消钮, #默认按钮二), “提示信息”), #确认钮))
        .如果 (等于 (“delete from dk_xtrzh”.未知支持库函数_4 (), 假))
            信息框 (“清空系统日志时出错，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
        .否则
            全部删除 ()
        .如果结束
        
    .如果真结束
    
.如果真结束


.子程序 _系统日志窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()

.窗口程序集 登录窗口程序集, , , 

.程序集变量 登录用户密码, 文本型, , , 登录用户的密码
.程序集变量 登录用户名称1, 文本型, , , 欲登录用户的名称
.程序集变量 登录用户代号1, 文本型, , , 欲登录用户的代号
.程序集变量 登录用户类型1, 文本型, , , 欲登录用户的类型
.程序集变量 登录次数, 整数型, , , 本次登录失败的次数
.程序集变量 例假日天数, 整数型, , , 做时终时输入的例假日天数
.程序集变量 是否是首次使用, 文本型, , , 是否是首演示数据库，如果是此变量值为系统管理员代号，否则为空
.子程序 检查登录次数, 空白型, , 检查登录失败的次数
赋值 (登录次数, 相加 (登录次数, 1))
.如果真 (等于 (登录次数, 3))
    信息框 (“对不起，您已三次登录失败，系统将关闭！”, 相加 (#错误图标, #确认钮), “提示信息”)
    未知支持库函数_3 ()
    结束 ()
.如果真结束


.子程序 _确定按钮_被单击, 空白型, , 
.如果 (并且 (等于 (删首尾空 (.内容), 登录用户代号1), 等于 (删首尾空 (.内容), 登录用户密码), 不等于 (登录用户代号1, “”), 不等于 (登录用户密码, “”)))
    .如果 (或者 (等于 (取日期 (取现行时间 ()), 取日期 (总控时间)), 并且 (等于 (取日期 (增减时间 (取现行时间 (), #日, 相减 (-1, 例假日天数))), 取日期 (总控时间)), 等于 (系统状态, “日终”)), 等于 (是否已移植完毕, “0”)))
        赋值 (登录用户代号, 登录用户代号1)
        赋值 (登录用户名称, 登录用户名称1)
        赋值 (登录用户类型, 登录用户类型1)
        .如果真 (等于 (相加 (“insert into dk_xtrzh(dh,duser,dtime,nr) values('”, 登录用户代号, “','”, 登录用户名称, “','”, 到文本 (取年份 (取现行时间 ())), “-”, 到文本 (取月份 (取现行时间 ())), “-”, 到文本 (取日 (取现行时间 ())), “ ”, 到文本 (取小时 (取现行时间 ())), “:”, 到文本 (取分钟 (取现行时间 ())), “:”, 到文本 (取秒 (取现行时间 ())), “','登录')”).未知支持库函数_4 (), 假))
            信息框 (“无法更新系统日志，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
        .如果真结束
        未知支持库函数_3 ()
        销毁 ()
    .否则
        信息框 (“账务处理日期与当前系统日期不符！”, 相加 (#错误图标, #确认钮), “提示信息”)
        检查登录次数 () ' $总控时间不符
        获取焦点 ()
    .如果结束
    
.否则
    信息框 (“用户代号或密码错误！”, 相加 (#错误图标, #确认钮), “提示信息”)
    检查登录次数 () ' $已失败次数
    获取焦点 ()
.如果结束


.子程序 _登录窗口_创建完毕, 空白型, , 
.局部变量 读入文本变量, 文本型, , , 

赋值 (登录窗口., 相减 (相加 (登录窗口., 205), 登录窗口.取用户区高度 ()))
.如果真 (等于 (文件是否存在 (相加 (取运行目录 (), “\dkgl.mdb”)), 假))
    .如果 (等于 (文件是否存在 (相加 (取运行目录 (), “\demo\dkgl.mdb”)), 假))
        写到文件 (相加 (取运行目录 (), “\dkgl.mdb”), #初始化库)
    .否则
        复制文件 (相加 (取运行目录 (), “\demo\dkgl.mdb”), 相加 (取运行目录 (), “\dkgl.mdb”))
    .如果结束
    
.如果真结束
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
赋值 (登录日期, 取日期 (取现行时间 ()))
赋值 (.标题, 相加 (“当前系统日期：  ”, 删首尾空 (时间到文本 (登录日期, #日期部分))))
.未知支持库函数_12 ()
.未知支持库函数_12 ()
“dk_system”.未知支持库函数_14 (2)
“dwid”.未知支持库函数_26 (信用社编号)
“dwname”.未知支持库函数_26 (信用社名称)
“zksj”.未知支持库函数_31 (总控时间)
“zht”.未知支持库函数_26 (系统状态)
“sfyzhwb”.未知支持库函数_26 (是否已移植完毕)
“ljrtsh”.未知支持库函数_29 (例假日天数)
未知支持库函数_16 ()
赋值 (是否是首次使用, “”)
“select dh from dk_user”.未知支持库函数_14 (1)
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “dh”.未知支持库函数_26 (读入文本变量)
        .如果真 (等于 (取文本左边 (读入文本变量, 1), “@”))
            信息框 (相加 (“欢迎使用<信用社贷款管理系统>！”, #换行符, #换行符, “您现在使用的是演示数据库，仅供浏览、学习使用。”, #换行符, “用户代号与密码：”, #换行符, “系统管理员：admin，密码：admin”, #换行符, “操作员：user，密码：user”, #换行符, #换行符, “在正式使用本系统前，请首先以系统管理员登录进行系统初始化。”), 相加 (#确认钮, #信息图标), “提示信息”)
            赋值 (读入文本变量, 取文本右边 (读入文本变量, 相减 (取文本长度 (读入文本变量), 1)))
            赋值 (是否是首次使用, 读入文本变量)
        .如果真结束
        读入文本变量.加入项目 ()
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()
.如果真 (不等于 (是否是首次使用, “”))
    重新开工初始化 ()
.如果真结束
.如果 (等于 (是否已移植完毕, “0”))
    赋值 (.内容, “还未完成数据移植”)
.否则
    赋值 (.内容, 相加 (时间到文本 (总控时间, #日期部分), 系统状态))
.如果结束
赋值 (登录次数, 0)

.子程序 _取消按钮_被单击, 空白型, , 
未知支持库函数_3 ()
.如果 (等于 (登录用户代号, “”))
    结束 ()
.否则
    销毁 ()
.如果结束


.子程序 _登录窗口_被显示, 空白型, , 
获取焦点 ()

.子程序 _代号编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _密码编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _确定按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _确定按钮_被单击 ()
.如果真结束


.子程序 _代号编辑框_失去焦点, 空白型, , 
.局部变量 临时变量, 文本型, , , 

.如果 (不等于 (是否是首次使用, “”))
    .如果 (等于 (删首尾空 (.内容), 是否是首次使用))
        赋值 (临时变量, 相加 (“@”, 删首尾空 (.内容)))
    .否则
        赋值 (临时变量, 删首尾空 (.内容))
    .如果结束
    
.否则
    赋值 (临时变量, 删首尾空 (.内容))
.如果结束
相加 (“select * from dk_user where dh='”, 临时变量, “'”).未知支持库函数_14 (1)
.如果真 (等于 (., 假))
    信息框 (“无法打开数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    未知支持库函数_3 ()
    结束 ()
.如果真结束
.如果 (等于 (未知支持库函数_34 (), 假))
    赋值 (登录用户代号1, “”)
    赋值 (登录用户名称1, “”)
    赋值 (登录用户类型1, “”)
    赋值 (登录用户密码, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
.否则
    “dh”.未知支持库函数_26 (登录用户代号1)
    .如果真 (等于 (取文本左边 (登录用户代号1, 1), “@”))
        赋值 (登录用户代号1, 取文本右边 (登录用户代号1, 相减 (取文本长度 (登录用户代号1), 1)))
    .如果真结束
    “name”.未知支持库函数_26 (登录用户名称1)
    “job”.未知支持库函数_26 (登录用户类型1)
    “mm”.未知支持库函数_26 (登录用户密码)
    赋值 (.内容, 登录用户名称1)
.如果结束
未知支持库函数_16 ()

.子程序 _登录窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()

.子程序 _刷新按钮_被单击, 空白型, , 
 ' .如果真 (等于 (信息框 (相加 (“确实要将账务处理日期：”, .内容, “改为当前系统日期吗?”), #是否钮, ), #是钮))
     ' 置现行时间 (到时间 (总控时间编辑框.内容))
.如果真结束
赋值 (登录日期, 取日期 (取现行时间 ()))
赋值 (.标题, 相加 (“当前系统日期：  ”, 删首尾空 (时间到文本 (登录日期, #日期部分))))


.子程序 _重新开工初始化按钮_被单击, 空白型, , 
.如果真 (等于 (是否已移植完毕, “0”))
    信息框 (“您还未完成数据移植，不能进行开工初始化！”, 相加 (#确认钮, #信息图标), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (并且 (等于 (删首尾空 (.内容), 登录用户代号1), 等于 (删首尾空 (.内容), 登录用户密码), 不等于 (登录用户代号1, “”), 不等于 (登录用户密码, “”)), 假))
    信息框 (“用户名称或密码错误!”, 相加 (#确认钮, #警告图标), “提示信息”)
    返回 ()
.如果真结束
.如果真 (不等于 (登录用户类型1, “1”))
    信息框 (“操作员无此权限,请输入系统管理员代码和密码!”, 相加 (#警告图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
重新开工初始化 ()
信息框 (“处理完毕!”, 相加 (#信息图标, #确认钮), “提示信息”)


.子程序 重新开工初始化, 空白型, , 
.局部变量 科目代号, 文本型, , , 
.局部变量 上期余额, 双精度小数型, , , 
.局部变量 读入双精度变量, 双精度小数型, , , 
.局部变量 读入文本变量, 文本型, , , 
.局部变量 下一年, 文本型, , , 
.局部变量 今年, 文本型, , , 
.局部变量 是否错误, 逻辑型, , , 

.如果真 (等于 (是否已移植完毕, “1”))
    .如果 (等于 (总控时间, 登录日期))
        .如果真 (等于 (系统状态, “日终”)) ' 未改变总控时间,只改变系统状态
             ' 处理总按时间
            赋值 (系统状态, “日间”)
            “update dk_system set zht='日间'”.未知支持库函数_4 ()
        .如果真结束
        
    .否则
         ' 处理日科目余额表
        相加 (“delete from dk_rkmyes where rq=#”, 处理日期 (时间到文本 (登录日期, #日期部分)), “#”).未知支持库函数_4 ()
        “select id from dk_kms order by id asc”.未知支持库函数_14 (1)
        未知支持库函数_34 ()
        赋值 (是否错误, 假)
        相加 (“update dk_rkmyes set ye=qcye+jffshe-dffshe where rq=#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “#”).未知支持库函数_4 ()
        .判断循环首 (等于 (., 假))
            “id”.未知支持库函数_26 (科目代号)
            相加 (“select ye from dk_rkmyes where rq=#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “# and dh='”, 科目代号, “'”).未知支持库函数_14 (1)
            .如果 (未知支持库函数_34 ())
                “ye”.未知支持库函数_27 (上期余额)
            .否则
                 ' 信息框 (“读入上期余额错误！”, #错误图标 ＋ #确认钮, “提示信息”)
                未知支持库函数_16 ()
                相加 (“select sum(jkye) as ye from dk_base where km='”, 科目代号, “'”).未知支持库函数_14 (1)
                “ye”.未知支持库函数_27 (上期余额)
            .如果结束
            未知支持库函数_16 ()
            .如果真 (等于 (相加 (“insert into dk_rkmyes(dh,rq,qcye,jffshe,dffshe,ye) values('”, 科目代号, “',#”, 处理日期 (时间到文本 (登录日期, #日期部分)), “#,0”, 到文本 (上期余额), “,0,0,0)”).未知支持库函数_4 (), 假))
                赋值 (是否错误, 真)
            .如果真结束
            未知支持库函数_36 ()
        .判断循环尾 ()
        未知支持库函数_16 ()
        .如果 (等于 (是否错误, 真))
            信息框 (“重新开工初始化失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
            返回 ()
        .否则
            
        .如果结束
        赋值 (今年, 删首尾空 (到文本 (取年份 (总控时间))))
        赋值 (下一年, 删首尾空 (到文本 (相加 (取年份 (登录日期), 1))))
        .如果真 (不等于 (今年, 下一年)) ' 如果是跨年度，则将本年科目余额表余额结转到下一年
            相加 (“delete from dk_kmyes where rq=”, 下一年).未知支持库函数_4 ()
            相加 (“update dk_kmyes set ye=ncye+jffshe-dffshe where rq=”, 今年).未知支持库函数_4 ()
            “select id from dk_kms order by id”.未知支持库函数_14 (1)
            .如果真 (未知支持库函数_34 ())
                .判断循环首 (等于 (., 假))
                    “id”.未知支持库函数_26 (读入文本变量)
                    相加 (“select ye from dk_kmyes where rq=”, 今年, “ and dh='”, 读入文本变量, “'”).未知支持库函数_14 (1)
                    .如果 (未知支持库函数_34 ())
                        “ye”.未知支持库函数_27 (读入双精度变量)
                    .否则
                        未知支持库函数_16 ()
                        相加 (“select sum(jkye) as ye from dk_base where km='”, 科目代号, “'”).未知支持库函数_14 (1)
                        “ye”.未知支持库函数_27 (读入双精度变量)
                    .如果结束
                    相加 (“insert into dk_kmyes(rq,dh,ncye,jffshe,dffshe,ye) values(”, 下一年, “,'”, 读入文本变量, “',0”, 删首尾空 (到文本 (读入双精度变量)), “,0,0,0)”).未知支持库函数_4 ()
                    未知支持库函数_16 ()
                    未知支持库函数_36 ()
                .判断循环尾 ()
            .如果真结束
            未知支持库函数_16 ()
        .如果真结束
         ' 处理总控时间
        相加 (“update dk_system set zht='日间',ljrtsh=0,zksj=#”, 处理日期 (时间到文本 (登录日期, #日期部分)), “#”).未知支持库函数_4 ()
        赋值 (系统状态, “日间”)
        赋值 (总控时间, 登录日期)
    .如果结束
    .如果 (等于 (是否已移植完毕, “0”))
        赋值 (.内容, “还未完成数据移植”)
    .否则
        赋值 (.内容, 相加 (时间到文本 (总控时间, #日期部分), 系统状态))
    .如果结束
    
.如果真结束


.子程序 _刷新按钮_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (登录日期, 取日期 (取现行时间 ()))
赋值 (.标题, 相加 (“当前系统日期：  ”, 删首尾空 (时间到文本 (登录日期, #日期部分))))


.窗口程序集 数据移植窗口程序集, , , 移植数据

.子程序 _退出_被选择, 空白型, , 
销毁 ()

.子程序 _数据移植窗口_尺寸被改变, 空白型, , 
赋值 (.高度, 相减 (数据移植窗口., 48))
赋值 (.宽度, 相减 (数据移植窗口., 8))

.子程序 _数据移植窗口_创建完毕, 空白型, , 
_数据移植窗口_尺寸被改变 ()

.子程序 _添加借款人_被选择, 空白型, , 
载入 (借款人信息录入窗口, , 真)

.子程序 _查询修改借款人信息_被选择, 空白型, , 
载入 (查询修改借款人信息窗口, , 真)

.子程序 _贷款信息录入_被选择, 空白型, , 
载入 (数据移植贷款录入窗口, , 真)

.子程序 _贷款信息修改_被选择, 空白型, , 
载入 (数据移植贷款信息修改窗口, , 真)

.子程序 _贷款信息查询_被选择, 空白型, , 
载入 (数据移植贷款信息查询窗口, , 真)

.子程序 _科目余额表移植_被选择, 空白型, , 
载入 (科目余额表移植窗口, , 真)

.子程序 _移植完毕处理_被选择, 空白型, , 
载入 (数据移植完毕处理窗口, , 真)
.如果真 (等于 (是否已移植完毕, “1”))
    销毁 ()
.如果真结束


.窗口程序集 借款人录入窗口程序集, , , 录入借款人信息

.程序集变量 借款人编号, 整数型, , , 自动记录借款人编号的变量，做为借款人标识的关键字
.程序集变量 借款人简码, 文本型, , , 为了提高录入速度而使用的借款人简码
.程序集变量 地域性质数组, 文本型, , "0", 地域性质：1.本社辖区内，2.本县辖区内，3.县辖以外
.子程序 _返回按钮1_被单击, 空白型, , 返回主界面
赋值 (.现行子夹, 0)
获取焦点 ()

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _借款人信息录入窗口_创建完毕, 空白型, , 初始化
.局部变量 读入文本变量, 文本型, , , 

赋值 (借款人信息录入窗口., 相减 (相加 (借款人信息录入窗口., 290), 借款人信息录入窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
“dk_bhk”.未知支持库函数_14 (2)
“jkrxx”.未知支持库函数_29 (借款人编号)
未知支持库函数_16 ()
 ' 载入村组信息
“dk_cz”.未知支持库函数_14 (2)
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “name”.未知支持库函数_26 (读入文本变量)
        读入文本变量.加入项目 ()
        “dy”.未知支持库函数_26 (读入文本变量)
        加入成员 (地域性质数组, 读入文本变量)
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()
重置所有项目 ()

.子程序 _类型组合框_列表项被选择, 空白型, , 根据借款人类型显示不同录入界面
.判断开始 (等于 (.现行选中项, 0))
    信息框 (“请录入借款人(信用户)详细信息！”, 相加 (#信息图标, #确认钮), “提示信息”)
    赋值 (.现行子夹, 1)
    获取焦点 ()
.判断 (等于 (.现行选中项, 1))
    信息框 (“请录入借款人(自然人)详细信息！”, 相加 (#信息图标, #确认钮), “提示信息”)
    赋值 (.现行子夹, 2)
    获取焦点 ()
.判断 (等于 (.现行选中项, 2))
    信息框 (“请录入借款人(企业法人)详细信息！”, 相加 (#信息图标, #确认钮), “提示信息”)
    赋值 (.现行子夹, 3)
    获取焦点 ()
.默认
    信息框 (“请选择借款人类型！”, 相加 (#信息图标, #确认钮), “提示信息”)
.判断结束


.子程序 _返回按钮2_被单击, 空白型, , 返回主界面
赋值 (.现行子夹, 0)
获取焦点 ()

.子程序 _返回按钮3_被单击, 空白型, , 返回主界面
赋值 (.现行子夹, 0)
获取焦点 ()

.子程序 重置所有项目, 空白型, , 将所有输入控件回复到初始状态
赋值 (.内容, “”)
赋值 (.现行选中项, -1)
赋值 (.现行选中项, -1)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.现行选中项, -1)
赋值 (.现行选中项, -1)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “0”)
赋值 (.现行选中项, -1)
赋值 (.内容, “0”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.现行选中项, -1)
赋值 (.现行选中项, -1)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.选中, 假)
赋值 (.选中, 真)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “0”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.选中, 假)
赋值 (.选中, 真)
赋值 (.内容, “”)

.子程序 _取消按钮_被单击, 空白型, , 取消编辑，不保存记录
重置所有项目 ()
获取焦点 ()

.子程序 _确定按钮_被单击, 空白型, , 保存记录
.局部变量 有无不良记录, 文本型, , , 

 ' 判断录入内容是否符合要求
.如果真 (等于 (删首尾空 (.内容), “”))
    信息框 (“请输入借款人名称！”, 相加 (#错误图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (.现行选中项, -1))
    信息框 (“请选择村组！”, 相加 (#错误图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (.现行选中项, -1))
    信息框 (“请选择借款人类型！”, 相加 (#错误图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.判断开始 (等于 (.现行选中项, 0)) ' 信用户
    .如果真 (并且 (不等于 (取文本长度 (.内容), 15), 不等于 (取文本长度 (.内容), 18)))
        信息框 (“请正确输入借款人身份证号！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果真 (等于 (删首尾空 (.内容), “”))
        信息框 (“请输入借款人出生日期！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果真 (等于 (.现行选中项, -1))
        信息框 (“请选择借款人性别！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果真 (等于 (.现行选中项, -1))
        信息框 (“请输入借款人健康状况！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果真 (小于或等于 (到数值 (.内容), 0))
        信息框 (“请输入借款人家庭人均收入！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果真 (等于 (.现行选中项, -1))
        信息框 (“请选择借款人信用等级！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果真 (小于或等于 (到数值 (.内容), 0))
        信息框 (“请输入授信额度！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果 (相加 (“insert into dk_jkrxx(id,name,jm,cz,dy,xzh,bzh) values(”, 删首尾空 (到文本 (相加 (借款人编号, 1))), “,'”, .内容, “','”, 借款人简码, “','”, .内容, “','”, 地域性质数组 [相加 (.现行选中项, 1)], “','”, 删首尾空 (到文本 (相加 (.现行选中项, 1))), “','”, .内容, “')”).未知支持库函数_4 ()) ' 保存基本信息
        .如果 (相加 (“insert into dk_xyhxx(id,shfzh,chshrq,xb,jkzhk,jtchy,jyxm,rjshr,xydj,shxed) values(”, 删首尾空 (到文本 (相加 (借款人编号, 1))), “,'”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “',”, 删首尾空 (.内容), “,'”, 删首尾空 (到文本 (相加 (.现行选中项, 1))), “',”, 删首尾空 (.内容), “)”).未知支持库函数_4 ()) ' 保存信用户详细资料
            信息框 (“添加成功！”, 相加 (#信息图标, #确认钮), “提示信息”)
            赋值 (借款人编号, 相加 (借款人编号, 1))
            重置所有项目 ()
        .否则
            相加 (“delete from dk_jkrxx where id=”, 删首尾空 (到文本 (相加 (借款人编号, 1)))).未知支持库函数_4 ()
            信息框 (“添加借款人失败，请检查！”, 相加 (#错误图标, #确认钮), “提示信息”)
        .如果结束
        
    .否则
        信息框 (“添加借款人失败，请检查！”, 相加 (#错误图标, #确认钮), “提示信息”)
    .如果结束
    
.判断 (等于 (.现行选中项, 1)) ' 自然人
    .如果真 (并且 (不等于 (取文本长度 (.内容), 15), 不等于 (取文本长度 (.内容), 18)))
        信息框 (“请正确输入借款人身份证号！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果真 (等于 (删首尾空 (.内容), “”))
        信息框 (“请输入借款人出生日期！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果真 (等于 (.现行选中项, -1))
        信息框 (“请选择借款人性别！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果真 (等于 (.现行选中项, -1))
        信息框 (“请输入借款人健康状况！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果 (相加 (“insert into dk_jkrxx(id,name,jm,cz,dy,xzh,bzh) values(”, 删首尾空 (到文本 (相加 (借款人编号, 1))), “,'”, .内容, “','”, 借款人简码, “','”, .内容, “','”, 地域性质数组 [相加 (.现行选中项, 1)], “','”, 删首尾空 (到文本 (相加 (.现行选中项, 1))), “','”, .内容, “')”).未知支持库函数_4 ()) ' 保存基本信息
        .如果 (等于 (.选中, 真))
            赋值 (有无不良记录, “1”)
        .否则
            赋值 (有无不良记录, “0”)
        .如果结束
        .如果 (相加 (“insert into dk_zrrxx(id,shfzh,chshrq,xb,jkzhk,lxdh,jyxm,bljl,xyzhk) values(”, 删首尾空 (到文本 (相加 (借款人编号, 1))), “,'”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, 有无不良记录, “','”, .内容, “')”).未知支持库函数_4 ()) ' 保存自然人详细资料
            信息框 (“添加成功！”, 相加 (#信息图标, #确认钮), “提示信息”)
            赋值 (借款人编号, 相加 (借款人编号, 1))
            重置所有项目 ()
        .否则
            相加 (“delete from dk_jkrxx where id=”, 删首尾空 (到文本 (相加 (借款人编号, 1)))).未知支持库函数_4 ()
            信息框 (“添加借款人失败2，请检查！”, 相加 (#错误图标, #确认钮), “提示信息”)
        .如果结束
        
    .否则
        信息框 (“添加借款人失败，请检查！”, 相加 (#错误图标, #确认钮), “提示信息”)
    .如果结束
    
.默认
     ' 企业法人
    .如果真 (小于 (取文本长度 (.内容), 8))
        信息框 (“请正确输入企业贷款卡号码！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果真 (等于 (删首尾空 (.内容), “”))
        信息框 (“请输入企业注册地！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果真 (等于 (.内容, “”))
        信息框 (“请选择企业法人代表！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果真 (小于或等于 (到数值 (.内容), 0))
        信息框 (“注册资本必须大于0！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果 (相加 (“insert into dk_jkrxx(id,name,jm,cz,dy,xzh,bzh) values(”, 删首尾空 (到文本 (相加 (借款人编号, 1))), “,'”, .内容, “','”, 借款人简码, “','”, .内容, “','”, 地域性质数组 [相加 (.现行选中项, 1)], “','”, 删首尾空 (到文本 (相加 (.现行选中项, 1))), “','”, .内容, “')”).未知支持库函数_4 ()) ' 保存基本信息
        .如果 (等于 (.选中, 真))
            赋值 (有无不良记录, “1”)
        .否则
            赋值 (有无不良记录, “0”)
        .如果结束
        .如果 (相加 (“insert into dk_qyfrxx(id,dkkh,zhcd,zhczb,frdb,lxdh,jyxm,bljl,xyzhk) values(”, 删首尾空 (到文本 (相加 (借款人编号, 1))), “,'”, .内容, “','”, .内容, “',”, .内容, “,'”, .内容, “','”, .内容, “','”, .内容, “','”, 有无不良记录, “','”, .内容, “')”).未知支持库函数_4 ()) ' 保存企业法人详细资料
            信息框 (“添加成功！”, 相加 (#信息图标, #确认钮), “提示信息”)
            赋值 (借款人编号, 相加 (借款人编号, 1))
            重置所有项目 ()
        .否则
            相加 (“delete from dk_jkrxx where id=”, 删首尾空 (到文本 (相加 (借款人编号, 1)))).未知支持库函数_4 ()
            信息框 (“添加借款人失败2，请检查！”, 相加 (#错误图标, #确认钮), “提示信息”)
        .如果结束
        
    .否则
        信息框 (“添加借款人失败，请检查！”, 相加 (#错误图标, #确认钮), “提示信息”)
    .如果结束
    
.判断结束
获取焦点 ()

.子程序 _借款人编辑框_失去焦点, 空白型, , 根据借款人名称生成借款人录入简码，以提高录入速度
.局部变量 临时变量, 整数型, , , 
.局部变量 借款人文本长度, 整数型, , , 
.局部变量 取声母汉字, 文本型, , , 

赋值 (临时变量, 1)
赋值 (借款人简码, “”)
赋值 (.内容, 删首尾空 (.内容))
赋值 (借款人文本长度, 取文本长度 (.内容))
.判断循环首 (小于或等于 (临时变量, 借款人文本长度))
    .如果 (小于 (取代码 (.内容, 临时变量), 0))
        赋值 (借款人简码, 相加 (借款人简码, 取声母 (取文本中间 (.内容, 临时变量, 2), 1)))
        赋值 (临时变量, 相加 (临时变量, 2))
    .否则
        赋值 (借款人简码, 相加 (借款人简码, 取文本中间 (.内容, 临时变量, 1)))
        赋值 (临时变量, 相加 (临时变量, 1))
    .如果结束
    
.判断循环尾 ()

.子程序 _借款人信息录入窗口_将被销毁, 空白型, , 
.如果真 (等于 (相加 (“update dk_bhk set jkrxx=”, 删首尾空 (到文本 (借款人编号))).未知支持库函数_4 (), 假)) ' 更新借款人编号生成库
    信息框 (“程序异常，请与数据管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
.如果真结束
未知支持库函数_3 ()

.子程序 _详细资料按钮_被单击, 空白型, , 根据借款人性质显示不同录入界面
.判断开始 (等于 (.现行选中项, 0)) ' 信用户
    赋值 (.现行子夹, 1)
    获取焦点 ()
.判断 (等于 (.现行选中项, 1)) ' 自然人
    赋值 (.现行子夹, 2)
    获取焦点 ()
.判断 (等于 (.现行选中项, 2)) ' 企业法人
    赋值 (.现行子夹, 3)
    获取焦点 ()
.默认
    信息框 (“请选择借款人类型！”, 相加 (#信息图标, #确认钮), “提示信息”)
.判断结束


.子程序 _借款人信息录入窗口_被显示, 空白型, , 显示窗口时设置录入焦点
获取焦点 ()

.子程序 _借款人编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _村组组合框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _身份证编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 文本长度, 整数型, , , 
.局部变量 出生年份, 整数型, , , 

.如果真 (等于 (键代码, #回车键))
    赋值 (.内容, 删首尾空 (.内容))
    赋值 (文本长度, 取文本长度 (.内容))
    .如果 (或者 (等于 (文本长度, 15), 等于 (文本长度, 18)))
        .如果 (等于 (文本长度, 15))
            赋值 (.现行选中项, 求余数 (相加 (到数值 (取文本右边 (.内容, 1)), 1), 2))
            赋值 (出生年份, 到数值 (取文本中间 (.内容, 7, 2)))
            .如果 (小于或等于 (出生年份, 30))
                赋值 (.内容, 相加 (“20”, 取文本中间 (.内容, 7, 6)))
            .否则
                赋值 (.内容, 相加 (“19”, 取文本中间 (.内容, 7, 6)))
            .如果结束
            
        .否则
            赋值 (.现行选中项, 求余数 (相加 (到数值 (取文本中间 (.内容, 17, 1)), 1), 2))
            赋值 (.内容, 取文本中间 (.内容, 7, 8))
        .如果结束
        获取焦点 ()
    .否则
        信息框 (“身份证号码不对，请重新输入！”, 相加 (#错误图标, #确认钮), “提示信息”)
    .如果结束
    
.如果真结束


.子程序 _出生日期编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _性别组合框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _健康状况组合框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _经营项目编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _人均收入编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _信用等级组合框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _授信额度编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _身份证编辑框1_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 文本长度, 整数型, , , 
.局部变量 出生年份, 整数型, , , 

.如果真 (等于 (键代码, #回车键))
    赋值 (.内容, 删首尾空 (.内容))
    赋值 (文本长度, 取文本长度 (.内容))
    .如果 (或者 (等于 (文本长度, 15), 等于 (文本长度, 18)))
        .如果 (等于 (文本长度, 15))
            赋值 (.现行选中项, 求余数 (相加 (到数值 (取文本右边 (.内容, 1)), 1), 2))
            赋值 (出生年份, 到数值 (取文本中间 (.内容, 7, 2)))
            .如果 (小于或等于 (出生年份, 30))
                赋值 (.内容, 相加 (“20”, 取文本中间 (.内容, 7, 6)))
            .否则
                赋值 (.内容, 相加 (“19”, 取文本中间 (.内容, 7, 6)))
            .如果结束
            
        .否则
            赋值 (.现行选中项, 求余数 (相加 (到数值 (取文本中间 (.内容, 17, 1)), 1), 2))
            赋值 (.内容, 取文本中间 (.内容, 7, 8))
        .如果结束
        获取焦点 ()
    .否则
        信息框 (“身份证号码不对，请重新输入！”, 相加 (#错误图标, #确认钮), “提示信息”)
    .如果结束
    
.如果真结束


.子程序 _出生日期编辑框1_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _性别组合框1_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _健康状况组合框1_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _联系电话编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _经营项目编辑框1_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _贷款卡号编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _注册地编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _注册资本编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _联系电话编辑框1_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _经营项目编辑框2_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _返回按钮3_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _返回按钮3_被单击 ()
.如果真结束


.子程序 _返回按钮2_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _返回按钮2_被单击 ()
.如果真结束


.子程序 _返回按钮1_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _返回按钮1_被单击 ()
.如果真结束


.子程序 _法人代表编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.窗口程序集 查询修改借款人信息窗口程序集, , , 查询/修改借款人信息

.程序集变量 借款人编号, 整数型, , , 自动记录借款人编号的变量，做为借款人标识的关键字
.程序集变量 借款人简码, 文本型, , , 为了提高录入速度而使用的借款人简码
.程序集变量 sql语句内容, 文本型, , , 查询的SQL语句内容
.程序集变量 地域性质数组, 文本型, , "0", 地域性质：1.本社辖区内，2.本县辖区内，3.县辖以外
.子程序 _返回按钮1_被单击, 空白型, , 返回主界面
赋值 (.现行子夹, 0)
获取焦点 ()

.子程序 显示记录, 空白型, , 显示当前记录内容
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入数值变量, 整数型, , , 

.如果真 (并且 (等于 (., 假), 等于 (., 假)))
    “id”.未知支持库函数_29 (借款人编号)
    “name”.未知支持库函数_26 (读入文本变量)
    赋值 (.内容, 读入文本变量)
    “jm”.未知支持库函数_26 (借款人简码)
    “cz”.未知支持库函数_26 (读入文本变量)
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
    .判断循环首 (大于 (.现行选中项, -1))
        .如果真 (等于 (.内容, 读入文本变量))
            跳出循环 ()
        .如果真结束
        赋值 (.现行选中项, 相减 (.现行选中项, 1))
    .判断循环尾 ()
    “xzh”.未知支持库函数_26 (读入文本变量)
    .判断开始 (等于 (读入文本变量, “1”)) ' 借款人类型为信用户
        赋值 (.现行选中项, 0)
        相加 (“select * from dk_xyhxx where id=”, 删首尾空 (到文本 (借款人编号))).未知支持库函数_14 (1)
        .如果真 (未知支持库函数_34 ())
            “shfzh”.未知支持库函数_26 (读入文本变量)
            赋值 (.内容, 读入文本变量)
            “chshrq”.未知支持库函数_26 (读入文本变量)
            赋值 (.内容, 读入文本变量)
            “xb”.未知支持库函数_26 (读入文本变量)
            .如果 (等于 (读入文本变量, “男”))
                赋值 (.现行选中项, 0)
            .否则
                赋值 (.现行选中项, 1)
            .如果结束
            “jkzhk”.未知支持库函数_26 (读入文本变量)
            .判断开始 (等于 (读入文本变量, “健康”))
                赋值 (.现行选中项, 0)
            .判断 (等于 (读入文本变量, “一般”))
                赋值 (.现行选中项, 1)
            .默认
                赋值 (.现行选中项, 2)
            .判断结束
            “jtchy”.未知支持库函数_26 (读入文本变量)
            赋值 (.内容, 读入文本变量)
            “jyxm”.未知支持库函数_26 (读入文本变量)
            赋值 (.内容, 读入文本变量)
            “rjshr”.未知支持库函数_29 (读入数值变量)
            赋值 (.内容, 删首尾空 (到文本 (读入数值变量)))
            “xydj”.未知支持库函数_26 (读入文本变量)
            .判断开始 (等于 (读入文本变量, “优秀”))
                赋值 (.现行选中项, 0)
            .判断 (等于 (读入文本变量, “较好”))
                赋值 (.现行选中项, 1)
            .默认
                赋值 (.现行选中项, 2)
            .判断结束
            “shxed”.未知支持库函数_29 (读入数值变量)
            赋值 (.内容, 删首尾空 (到文本 (读入数值变量)))
        .如果真结束
        未知支持库函数_16 ()
    .判断 (等于 (读入文本变量, “2”)) ' 借款人类型为一般自然人
        赋值 (.现行选中项, 1)
        相加 (“select * from dk_zrrxx where id=”, 删首尾空 (到文本 (借款人编号))).未知支持库函数_14 (1)
        .如果真 (未知支持库函数_34 ())
            “shfzh”.未知支持库函数_26 (读入文本变量)
            赋值 (.内容, 读入文本变量)
            “chshrq”.未知支持库函数_26 (读入文本变量)
            赋值 (.内容, 读入文本变量)
            “xb”.未知支持库函数_26 (读入文本变量)
            .如果 (等于 (读入文本变量, “男”))
                赋值 (.现行选中项, 0)
            .否则
                赋值 (.现行选中项, 1)
            .如果结束
            “jkzhk”.未知支持库函数_26 (读入文本变量)
            .判断开始 (等于 (读入文本变量, “健康”))
                赋值 (.现行选中项, 0)
            .判断 (等于 (读入文本变量, “一般”))
                赋值 (.现行选中项, 1)
            .默认
                赋值 (.现行选中项, 2)
            .判断结束
            “jyxm”.未知支持库函数_26 (读入文本变量)
            赋值 (.内容, 读入文本变量)
            “lxdh”.未知支持库函数_26 (读入文本变量)
            赋值 (.内容, 读入文本变量)
            “bljl”.未知支持库函数_26 (读入文本变量)
            .如果 (等于 (读入文本变量, “1”))
                赋值 (.选中, 真)
                赋值 (.选中, 假)
            .否则
                赋值 (.选中, 假)
                赋值 (.选中, 真)
            .如果结束
            “xyzhk”.未知支持库函数_26 (读入文本变量)
            赋值 (.内容, 读入文本变量)
        .如果真结束
        未知支持库函数_16 ()
    .默认
        赋值 (.现行选中项, 2) ' 借款人为企业法人
        相加 (“select * from dk_qyfrxx where id=”, 删首尾空 (到文本 (借款人编号))).未知支持库函数_14 (1)
        .如果真 (未知支持库函数_34 ())
            “dkkh”.未知支持库函数_26 (读入文本变量)
            赋值 (.内容, 读入文本变量)
            “zhcd”.未知支持库函数_26 (读入文本变量)
            赋值 (.内容, 读入文本变量)
            “frdb”.未知支持库函数_26 (读入文本变量)
            赋值 (.内容, 读入文本变量)
            “jyxm”.未知支持库函数_26 (读入文本变量)
            赋值 (.内容, 读入文本变量)
            “lxdh”.未知支持库函数_26 (读入文本变量)
            赋值 (.内容, 读入文本变量)
            “bljl”.未知支持库函数_26 (读入文本变量)
            .如果 (等于 (读入文本变量, “1”))
                赋值 (.选中, 真)
                赋值 (.选中, 假)
            .否则
                赋值 (.选中, 假)
                赋值 (.选中, 真)
            .如果结束
            “xyzhk”.未知支持库函数_26 (读入文本变量)
            赋值 (.内容, 读入文本变量)
            “zhczb”.未知支持库函数_29 (读入数值变量)
            赋值 (.内容, 删首尾空 (到文本 (读入数值变量)))
        .如果真结束
        未知支持库函数_16 ()
    .判断结束
    “bzh”.未知支持库函数_26 (读入文本变量)
    赋值 (.内容, 读入文本变量)
.如果真结束


.子程序 _退出按钮_被单击, 空白型, , 退出窗口
销毁 ()

.子程序 _身份证编辑框_失去焦点, 空白型, , 根据身份证号自动录入借款人出生日期和性别
.局部变量 文本长度, 整数型, , , 
.局部变量 出生年份, 整数型, , , 

赋值 (.内容, 删首尾空 (.内容))
赋值 (文本长度, 取文本长度 (.内容))
.如果 (或者 (等于 (文本长度, 15), 等于 (文本长度, 18)))
    .如果 (等于 (文本长度, 15))
        赋值 (.现行选中项, 求余数 (相加 (到数值 (取文本右边 (.内容, 1)), 1), 2))
        赋值 (出生年份, 到数值 (取文本中间 (.内容, 7, 2)))
        .如果 (小于或等于 (出生年份, 30))
            赋值 (.内容, 相加 (“20”, 取文本中间 (.内容, 7, 6)))
        .否则
            赋值 (.内容, 相加 (“19”, 取文本中间 (.内容, 7, 6)))
        .如果结束
        
    .否则
        赋值 (.现行选中项, 求余数 (相加 (到数值 (取文本右边 (.内容, 1)), 1), 2))
        赋值 (.内容, 取文本中间 (.内容, 7, 8))
    .如果结束
    
.否则
    信息框 (“身份证号码不对，请重新输入！”, 相加 (#错误图标, #确认钮), “提示信息”)
.如果结束


.子程序 _返回按钮2_被单击, 空白型, , 返回主界面
赋值 (.现行子夹, 0)
获取焦点 ()

.子程序 _身份证编辑框1_失去焦点, 空白型, , 根据身份证号自动录入借款人出生日期和性别
.局部变量 文本长度, 整数型, , , 
.局部变量 出生年份, 整数型, , , 

赋值 (.内容, 删首尾空 (.内容))
赋值 (文本长度, 取文本长度 (.内容))
.如果 (或者 (等于 (文本长度, 15), 等于 (文本长度, 18)))
    .如果 (等于 (文本长度, 15))
        赋值 (.现行选中项, 求余数 (相加 (到数值 (取文本右边 (.内容, 1)), 1), 2))
        赋值 (出生年份, 到数值 (取文本中间 (.内容, 7, 2)))
        .如果 (小于或等于 (出生年份, 30))
            赋值 (.内容, 相加 (“20”, 取文本中间 (.内容, 7, 6)))
        .否则
            赋值 (.内容, 相加 (“19”, 取文本中间 (.内容, 7, 6)))
        .如果结束
        
    .否则
        赋值 (.现行选中项, 求余数 (相加 (到数值 (取文本右边 (.内容, 1)), 1), 2))
        赋值 (.内容, 取文本中间 (.内容, 7, 8))
    .如果结束
    
.否则
    信息框 (“身份证号码不对，请重新输入！”, 相加 (#错误图标, #确认钮), “提示信息”)
.如果结束


.子程序 _返回按钮3_被单击, 空白型, , 返回主界面
赋值 (.现行子夹, 0)
获取焦点 ()

.子程序 _末一条按钮_被单击, 空白型, , 移到末一条记录
未知支持库函数_35 ()
显示记录 ()

.子程序 _更新按钮_被单击, 空白型, , 更新借款人信息
.局部变量 有无不良记录, 文本型, , , 
.局部变量 记录号, 整数型, , , 

.如果真 (等于 (删首尾空 (.内容), “”))
    信息框 (“请输入借款人名称！”, 相加 (#错误图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (.现行选中项, -1))
    信息框 (“请选择村组！”, 相加 (#错误图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (.现行选中项, -1))
    信息框 (“请选择借款人类型！”, 相加 (#错误图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.判断开始 (等于 (.现行选中项, 0)) ' 借款人为信用户
    .如果真 (并且 (不等于 (取文本长度 (.内容), 15), 不等于 (取文本长度 (.内容), 18)))
        信息框 (“请正确输入借款人身份证号！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果真 (等于 (删首尾空 (.内容), “”))
        信息框 (“请输入借款人出生日期！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果真 (等于 (.现行选中项, -1))
        信息框 (“请选择借款人性别！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果真 (等于 (.现行选中项, -1))
        信息框 (“请输入借款人健康状况！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果真 (小于或等于 (到数值 (.内容), 0))
        信息框 (“请输入借款人家庭人均收入！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果真 (等于 (.现行选中项, -1))
        信息框 (“请选择借款人信用等级！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果真 (小于或等于 (到数值 (.内容), 0))
        信息框 (“请输入授信额度！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果 (相加 (“update dk_jkrxx set name='”, .内容, “',jm='”, 借款人简码, “',cz='”, .内容, “',dy='”, 地域性质数组 [相加 (.现行选中项, 1)], “',xzh='”, 删首尾空 (到文本 (相加 (.现行选中项, 1))), “',bzh='”, .内容, “' where id=”, 删首尾空 (到文本 (借款人编号))).未知支持库函数_4 ()) ' 更新借款人基本信息
        .如果 (相加 (“update dk_xyhxx set shfzh='”, .内容, “',chshrq='”, .内容, “',xb='”, .内容, “',jkzhk='”, .内容, “',jtchy='”, .内容, “',jyxm='”, .内容, “',rjshr=”, 删首尾空 (.内容), “,xydj='”, 删首尾空 (到文本 (相加 (.现行选中项, 1))), “',shxed=”, 删首尾空 (.内容), “ where id=”, 删首尾空 (到文本 (借款人编号))).未知支持库函数_4 ()) ' 更新信用户详细信息
            赋值 (记录号, .)
            未知支持库函数_16 ()
            sql语句内容.未知支持库函数_14 (1)
            记录号.未知支持库函数_38 ()
            显示记录 ()
            信息框 (“修改成功！”, 相加 (#信息图标, #确认钮), “提示信息”)
        .否则
            信息框 (“操作失败，请检查！”, 相加 (#错误图标, #确认钮), “提示信息”)
        .如果结束
        
    .否则
        信息框 (“修改借款人信息失败，请检查！”, 相加 (#错误图标, #确认钮), “提示信息”)
    .如果结束
    
.判断 (等于 (.现行选中项, 1)) ' 借款人为自然人
    .如果真 (并且 (不等于 (取文本长度 (.内容), 15), 不等于 (取文本长度 (.内容), 18)))
        信息框 (“请正确输入借款人身份证号！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果真 (等于 (删首尾空 (.内容), “”))
        信息框 (“请输入借款人出生日期！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果真 (等于 (.现行选中项, -1))
        信息框 (“请选择借款人性别！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果真 (等于 (.现行选中项, -1))
        信息框 (“请输入借款人健康状况！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果 (相加 (“update dk_jkrxx set name='”, .内容, “',jm='”, 借款人简码, “',cz='”, .内容, “',dy='”, 地域性质数组 [相加 (.现行选中项, 1)], “',xzh='”, 删首尾空 (到文本 (相加 (.现行选中项, 1))), “',bzh='”, .内容, “' where id=”, 删首尾空 (到文本 (借款人编号))).未知支持库函数_4 ()) ' 更新借款人基本信息
        .如果 (等于 (.选中, 真))
            赋值 (有无不良记录, “1”)
        .否则
            赋值 (有无不良记录, “0”)
        .如果结束
        .如果 (相加 (“update dk_zrrxx set shfzh='”, .内容, “',chshrq='”, .内容, “',xb='”, .内容, “',jkzhk='”, .内容, “',lxdh='”, .内容, “',jyxm='”, .内容, “',bljl='”, 有无不良记录, “',xyzhk='”, .内容, “' where id=”, 删首尾空 (到文本 (相加 (借款人编号, 1)))).未知支持库函数_4 ()) ' 更新自然人详细信息
            赋值 (记录号, .)
            未知支持库函数_16 ()
            sql语句内容.未知支持库函数_14 (1)
            记录号.未知支持库函数_38 ()
            显示记录 ()
            信息框 (“修改成功！”, 相加 (#信息图标, #确认钮), “提示信息”)
        .否则
            信息框 (“操作失败，请检查！”, 相加 (#错误图标, #确认钮), “提示信息”)
        .如果结束
        
    .否则
        信息框 (“修改借款人信息失败，请检查！”, 相加 (#错误图标, #确认钮), “提示信息”)
    .如果结束
    
.默认
     ' 借款人为企业法人
    .如果真 (小于 (取文本长度 (.内容), 8))
        信息框 (“请正确输入企业贷款卡号码！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果真 (等于 (删首尾空 (.内容), “”))
        信息框 (“请输入企业注册地！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果真 (等于 (.内容, “”))
        信息框 (“请选择企业法人代表！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果真 (小于或等于 (到数值 (.内容), 0))
        信息框 (“注册资本必须大于0！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果 (相加 (“update dk_jkrxx set name='”, .内容, “',jm='”, 借款人简码, “',cz='”, .内容, “',dy='”, 地域性质数组 [相加 (.现行选中项, 1)], “',xzh='”, 删首尾空 (到文本 (相加 (.现行选中项, 1))), “',bzh='”, .内容, “' where id=”, 删首尾空 (到文本 (借款人编号))).未知支持库函数_4 ()) ' 更新借款人基本信息
        .如果 (等于 (.选中, 真))
            赋值 (有无不良记录, “1”)
        .否则
            赋值 (有无不良记录, “0”)
        .如果结束
        .如果 (相加 (“update dk_qyfrxx set dkkh='”, .内容, “',zhcd='”, .内容, “',zhczb=”, .内容, “,frdb='”, .内容, “',lxdh='”, .内容, “',jyxm='”, .内容, “',bljl='”, 有无不良记录, “',xyzhk='”, .内容, “' where id=”, 删首尾空 (到文本 (相加 (借款人编号, 1)))).未知支持库函数_4 ()) ' 更新企业法人详细信息
            赋值 (记录号, .)
            未知支持库函数_16 ()
            sql语句内容.未知支持库函数_14 (1)
            记录号.未知支持库函数_38 ()
            显示记录 ()
            信息框 (“修改成功！”, 相加 (#信息图标, #确认钮), “提示信息”)
        .否则
            相加 (“delete from dk_jkrxx where id=”, 删首尾空 (到文本 (相加 (借款人编号, 1)))).未知支持库函数_4 ()
            信息框 (“操作失败，请检查！”, 相加 (#错误图标, #确认钮), “提示信息”)
        .如果结束
        
    .否则
        信息框 (“修改借款人信息失败，请检查！”, 相加 (#错误图标, #确认钮), “提示信息”)
    .如果结束
    
.判断结束
获取焦点 ()

.子程序 _借款人编辑框_失去焦点, 空白型, , 根据借款人名称生在借款人简码，以提高录入速度
.局部变量 临时变量, 整数型, , , 
.局部变量 借款人文本长度, 整数型, , , 
.局部变量 取声母汉字, 文本型, , , 

赋值 (临时变量, 1)
赋值 (借款人简码, “”)
赋值 (.内容, 删首尾空 (.内容))
赋值 (借款人文本长度, 取文本长度 (.内容))
.判断循环首 (小于或等于 (临时变量, 借款人文本长度))
    .如果 (小于 (取代码 (.内容, 临时变量), 0))
        赋值 (借款人简码, 相加 (借款人简码, 取声母 (取文本中间 (.内容, 临时变量, 2), 1)))
        赋值 (临时变量, 相加 (临时变量, 2))
    .否则
        赋值 (借款人简码, 相加 (借款人简码, 取文本中间 (.内容, 临时变量, 1)))
        赋值 (临时变量, 相加 (临时变量, 1))
    .如果结束
    
.判断循环尾 ()

.子程序 _借款人信息录入窗口_将被销毁, 空白型, , 
.如果真 (等于 (相加 (“update dk_bhk set jkrxx=”, 删首尾空 (到文本 (借款人编号))).未知支持库函数_4 (), 假)) ' 更新借款人编号生成库
    信息框 (“程序异常，请与数据管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
.如果真结束
未知支持库函数_3 ()

.子程序 _详细资料按钮_被单击, 空白型, , 显示借款为详细资料，根据不同借款人显示不同的界面
.判断开始 (等于 (.现行选中项, 0))
    赋值 (.现行子夹, 1)
    获取焦点 ()
.判断 (等于 (.现行选中项, 1))
    赋值 (.现行子夹, 2)
    获取焦点 ()
.判断 (等于 (.现行选中项, 2))
    赋值 (.现行子夹, 3)
    获取焦点 ()
.默认
    信息框 (“请选择借款人类型！”, 相加 (#信息图标, #确认钮), “提示信息”)
.判断结束


.子程序 _借款人信息录入窗口_被显示, 空白型, , 置窗口打开时的输入焦点
获取焦点 ()

.子程序 _借款人编辑框_按下某键, 逻辑型, , 回车键下移输入焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _村组组合框_按下某键, 逻辑型, , 回车键下移输入焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _身份证编辑框_按下某键, 逻辑型, , 回车键下移输入焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _出生日期编辑框_按下某键, 逻辑型, , 回车键下移输入焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _性别组合框_按下某键, 逻辑型, , 回车键下移输入焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _健康状况组合框_按下某键, 逻辑型, , 回车键下移输入焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _经营项目编辑框_按下某键, 逻辑型, , 回车键下移输入焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _人均收入编辑框_按下某键, 逻辑型, , 回车键下移输入焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _信用等级组合框_按下某键, 逻辑型, , 回车键下移输入焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _授信额度编辑框_按下某键, 逻辑型, , 回车键下移输入焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _身份证编辑框1_按下某键, 逻辑型, , 回车键下移输入焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _出生日期编辑框1_按下某键, 逻辑型, , 回车键下移输入焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _性别组合框1_按下某键, 逻辑型, , 回车键下移输入焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _健康状况组合框1_按下某键, 逻辑型, , 回车键下移输入焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _联系电话编辑框_按下某键, 逻辑型, , 回车键下移输入焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _经营项目编辑框1_按下某键, 逻辑型, , 回车键下移输入焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _贷款卡号编辑框_按下某键, 逻辑型, , 回车键下移输入焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _注册地编辑框_按下某键, 逻辑型, , 回车键下移输入焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _注册资本编辑框_按下某键, 逻辑型, , 回车键下移输入焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _联系电话编辑框1_按下某键, 逻辑型, , 回车键下移输入焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _经营项目编辑框2_按下某键, 逻辑型, , 回车键下移输入焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _返回按钮3_按下某键, 逻辑型, , 回车键下移输入焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _返回按钮3_被单击 ()
.如果真结束


.子程序 _返回按钮2_按下某键, 逻辑型, , 回车键下移输入焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _返回按钮2_被单击 ()
.如果真结束


.子程序 _返回按钮1_按下某键, 逻辑型, , 回车键下移输入焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _返回按钮1_被单击 ()
.如果真结束


.子程序 _法人代表编辑框_按下某键, 逻辑型, , 回车键下移输入焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _查找按钮_被单击, 空白型, , 查询某一个借款人的信息
.局部变量 输入文本变量, 文本型, , , 

.如果真 (输入框 (“请输入借款人名称（查询全部借款人输入空文本）：”, “输入信息”, “”, 输入文本变量, #输入文本))
    未知支持库函数_16 ()
    .如果 (等于 (输入文本变量, “”))
        赋值 (sql语句内容, “select * from dk_jkrxx”)
    .否则
        赋值 (sql语句内容, 相加 (“select * from dk_jkrxx where name like '%”, 输入文本变量, “%'”))
    .如果结束
    sql语句内容.未知支持库函数_14 (1)
    未知支持库函数_34 ()
    显示记录 ()
.如果真结束


.子程序 _第一条按钮_被单击, 空白型, , 移到第一条记录
未知支持库函数_34 ()
显示记录 ()

.子程序 _上一条按钮_被单击, 空白型, , 移到上一条记录
未知支持库函数_37 ()
.如果真 (.)
    未知支持库函数_34 ()
.如果真结束
显示记录 ()

.子程序 _下一条按钮_被单击, 空白型, , 移到下一条记录
未知支持库函数_36 ()
.如果真 (.)
    未知支持库函数_35 ()
.如果真结束
显示记录 ()

.子程序 _查询修改借款人信息窗口_创建完毕, 空白型, , 创建窗口时初始化数据
.局部变量 读入文本变量, 文本型, , , 

赋值 (查询修改借款人信息窗口., 相减 (相加 (查询修改借款人信息窗口., 287), 查询修改借款人信息窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
.未知支持库函数_12 ()
“dk_cz”.未知支持库函数_14 (2) ' 载入村组数据
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “name”.未知支持库函数_26 (读入文本变量)
        读入文本变量.加入项目 ()
        “dy”.未知支持库函数_26 (读入文本变量)
        加入成员 (地域性质数组, 读入文本变量)
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()
赋值 (sql语句内容, “select * from dk_jkrxx”)
sql语句内容.未知支持库函数_14 (1)
未知支持库函数_34 ()
显示记录 ()

.子程序 _删除按钮_被单击, 空白型, , 删除一条记录
.如果真 (并且 (等于 (., 假), 等于 (., 假), 等于 (信息框 (“真的删除此条记录吗？”, 相加 (#信息图标, #确认取消钮), “提示信息”), #确认钮)))
    .判断开始 (等于 (.现行选中项, 0))
        相加 (“delete from dk_xyhxx where id=”, 删首尾空 (到文本 (借款人编号))).未知支持库函数_4 ()
    .判断 (等于 (.现行选中项, 1))
        相加 (“delete from dk_zrrxx where id=”, 删首尾空 (到文本 (借款人编号))).未知支持库函数_4 ()
    .默认
        相加 (“delete from dk_qyfrxx where id=”, 删首尾空 (到文本 (借款人编号))).未知支持库函数_4 ()
    .判断结束
    相加 (“delete from dk_jkrxx where id=”, 删首尾空 (到文本 (借款人编号))).未知支持库函数_4 ()
    未知支持库函数_16 ()
    sql语句内容.未知支持库函数_14 (1)
    未知支持库函数_34 ()
    显示记录 ()
.如果真结束


.窗口程序集 数据移植贷款录入窗口程序集, , , 移植贷款数据

.程序集变量 借款人简码, 文本型, , , 记录借款人简码
.程序集变量 借款天数, 整数型, , , 记录借款天数
.程序集变量 借款人性质, 文本型, , , 记录借款人性质
.程序集变量 地域性质, 文本型, , , 记录借款人所属地域性质
.程序集变量 借款人编号, 整数型, , , 记录借款人编号
.程序集变量 借款人所属村组, 文本型, , , 记录借款人所属村组
.程序集变量 科目形态数组, 文本型, , "0", 记录科目所属借款形态数组
.程序集变量 借款人编号数组, 整数型, , "0", 记录借款人编号数组
.程序集变量 地域性质数组, 文本型, , "0", 记录借款人所属地域数组
.程序集变量 借款人简码数组, 文本型, , "0", 记录借款人简码数组
.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _数据移植贷款录入窗口_创建完毕, 空白型, , 初始化
.局部变量 读入文本变量, 文本型, , , 

赋值 (数据移植贷款录入窗口., 相减 (相加 (数据移植贷款录入窗口., 376), 数据移植贷款录入窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
 ' 载入科目信息
“select * from dk_kms order by id”.未知支持库函数_14 (1)
清空 ()
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “id”.未知支持库函数_26 (读入文本变量)
        读入文本变量.加入项目 ()
        “type”.未知支持库函数_26 (读入文本变量)
        加入成员 (科目形态数组, 读入文本变量)
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()
 ' 载入五级分类信息
“select * from dk_fivetype”.未知支持库函数_14 (1)
清空 ()
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “name”.未知支持库函数_26 (读入文本变量)
        读入文本变量.加入项目 ()
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()

.子程序 _科目组合框_失去焦点, 空白型, , 判断科目输入是否正确
.局部变量 科目代号, 文本型, , , 

.如果 (等于 (.内容, “”))
    赋值 (.现行选中项, 0)
.否则
    赋值 (科目代号, .内容)
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
    .判断循环首 (大于或等于 (.现行选中项, 0))
        .如果真 (等于 (科目代号, .内容))
            跳出循环 ()
        .如果真结束
        赋值 (.现行选中项, 相减 (.现行选中项, 1))
    .判断循环尾 ()
    .如果 (不等于 (.现行选中项, -1))
        获取焦点 ()
    .否则
        信息框 (“无此科目!”, 相加 (#信息图标, #确认钮), “提示信息”)
        赋值 (.现行选中项, -1)
        获取焦点 ()
    .如果结束
    
.如果结束


.子程序 _科目组合框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _流水号编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _录入按钮_被单击 ()
    
.如果真结束


.子程序 _借款人编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _原贷金额编辑框_失去焦点, 空白型, , 判断原贷金额输入是否正确
.如果真 (小于或等于 (到数值 (.内容), 0))
    赋值 (.内容, “0”)
.如果真结束
.如果 (小于 (到数值 (.内容), 到数值 (.内容)))
    信息框 (“已还本金不能大于原贷金额”, 相加 (#错误图标, #确认钮), “提示信息”)
    赋值 (.内容, “0”)
    赋值 (.内容, .内容)
.否则
    赋值 (.内容, 到文本 (相减 (到数值 (.内容), 到数值 (.内容))))
.如果结束


.子程序 _原贷金额编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _已还本金编辑框_失去焦点, 空白型, , 判断已还本金输入是否正确
.如果真 (小于 (到数值 (.内容), 0))
    赋值 (.内容, “0”)
.如果真结束
.如果 (小于 (到数值 (.内容), 到数值 (.内容)))
    信息框 (“已还本金不能大于原贷金额”, 相加 (#错误图标, #确认钮), “提示信息”)
    赋值 (.内容, “0”)
    赋值 (.内容, .内容)
.否则
    赋值 (.内容, 到文本 (相减 (到数值 (.内容), 到数值 (.内容))))
.如果结束


.子程序 _已还本金编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _已还利息编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _借款日编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _到期日编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _期限类型组合框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _起息日编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _利率编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _贷款方式组合框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _五级分类组合框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _借款用途编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _审批人编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _经办人编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _借款日编辑框_失去焦点, 空白型, , 
.如果真 (等于 (.内容, “”))
    赋值 (.内容, .内容)
.如果真结束


.子程序 _取消按钮_被单击, 空白型, , 取消编辑状态
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.可视, 假)
赋值 (.内容, “”)

.子程序 _确定按钮_被单击, 空白型, , 选定借款人
.如果真 (不等于 (., -1))
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.可视, 假)
    赋值 (.内容, .取标题 (., 0))
    赋值 (借款人简码, 借款人简码数组 [相加 (., 1)])
    赋值 (借款人性质, .取标题 (., 2))
    赋值 (借款人所属村组, .取标题 (., 1))
    赋值 (地域性质, 地域性质数组 [相加 (., 1)])
    赋值 (借款人编号, 借款人编号数组 [相加 (., 1)])
    获取焦点 ()
.如果真结束


.子程序 _已还利息编辑框_失去焦点, 空白型, , 判断输入是否正确
.如果真 (小于 (到数值 (.内容), 0))
    赋值 (.内容, “0”)
.如果真结束


.子程序 _利率编辑框_失去焦点, 空白型, , 判断输入是否正确
.如果真 (小于 (到数值 (.内容), 0))
    赋值 (.内容, “0”)
.如果真结束


.子程序 处理日期, 文本型, 公开, 对日期进行处理，以便使用SQL语句更新日期内容
.参数 输入日期, 文本型, , 

.局部变量 输出日期, 文本型, , , 
.局部变量 输入日期长度, 整数型, , , 
.局部变量 临时变量, 整数型, , , 

赋值 (输出日期, “”)
赋值 (输入日期长度, 取文本长度 (输入日期))
赋值 (临时变量, 1)
.判断循环首 (小于或等于 (临时变量, 输入日期长度))
    .如果 (小于 (取代码 (输入日期, 临时变量), 0))
        .如果 (等于 (取文本中间 (输入日期, 临时变量, 2), “日”))
            跳出循环 ()
        .否则
            赋值 (输出日期, 相加 (输出日期, “-”))
        .如果结束
        赋值 (临时变量, 相加 (临时变量, 1))
    .否则
        赋值 (输出日期, 相加 (输出日期, 取文本中间 (输入日期, 临时变量, 1)))
    .如果结束
    赋值 (临时变量, 相加 (临时变量, 1))
.判断循环尾 ()
返回 (输出日期)

.子程序 _存盘按钮_被单击, 空白型, , 保存数据
 ' 判断数据输入是否正确
.如果真 (或者 (等于 (.内容, “”), 等于 (删首尾空 (到文本 (借款人编号)), “”)))
    信息框 (“请正确输入借款人名称！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (小于或等于 (到数值 (.内容), 0))
    信息框 (“原贷金额必须大于零！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (或者 (大于 (到数值 (.内容), 到数值 (.内容)), 小于 (到数值 (.内容), 0)))
    信息框 (“已还本金不能大于原贷金额或小于零！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (小于 (到数值 (.内容), 0))
    信息框 (“已还利息不能小于零！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入借款日！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (小于 (到时间 (.内容), 到时间 (.内容)))
    信息框 (“到期日不能小于借款日！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (小于 (到时间 (.内容), 到时间 (.内容)))
    信息框 (“起息日不能小于借款日！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.现行选中项, -1))
    信息框 (“请选择期限类型！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.现行选中项, -1))
    信息框 (“请选择贷款方式！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (小于 (到数值 (.内容), 0))
    信息框 (“利率不能小于零！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (小于 (到数值 (.内容), 0))
    信息框 (“展期天数不能小于零！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (借款天数, 取时间间隔 (到时间 (.内容), 到时间 (.内容), #日))
.如果 (等于 (.现行选中项, 0))
    .如果真 (大于 (到数值 (相加 (“0”, .内容)), 借款天数))
        信息框 (“短期贷款展期天数不能大于原贷款天数！”, 相加 (#错误图标, #确认钮), “提示信息”)
        获取焦点 ()
        返回 ()
    .如果真结束
    
.否则
    .如果 (等于 (.现行选中项, 1))
        .如果真 (大于 (到数值 (相加 (“0”, .内容)), 整除 (借款天数, 2)))
            信息框 (“中期贷款展期天数不能大于原贷款天数的一半！”, 相加 (#错误图标, #确认钮), “提示信息”)
            获取焦点 ()
            返回 ()
        .如果真结束
        
    .否则
        .如果真 (大于 (到数值 (相加 (“0”, .内容)), 1096))
            信息框 (“长期贷款展期天数不能超过3年！”, 相加 (#错误图标, #确认钮), “提示信息”)
            获取焦点 ()
            返回 ()
        .如果真结束
        
    .如果结束
    
.如果结束
.如果真 (等于 (.现行选中项, -1))
    信息框 (“请选择五级分类形态！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果 (相加 (“insert into dk_base(lsh,name,jm,ydje,jkye,jkr,dqr,jkxts,jkyt,dkzhl,ghbj,lxje,hxqk,sbzht,bzh,zhqtsh,qx,jktsh,jlzht,cz,km,rzhrq,ll,yqtsh,xzh,jkrbh,jbr,spr,jkxtw) values('”, .内容, “','”, .内容, “','”, 借款人简码, “',0”, .内容, “,0”, .内容, “,#”, 处理日期 (.内容), “#,#”, 处理日期 (.内容), “#,'”, 科目形态数组 [相加 (.现行选中项, 1)], “','”, .内容, “','”, .内容, “',0”, .内容, “,0”, .内容, “,#”, 处理日期 (.内容), “#,'0','”, .内容, “',0”, .内容, “,'”, .内容, “',”, 删首尾空 (到文本 (借款天数)), “,'1','”, 借款人所属村组, “','”, .内容, “',#2000-1-1#,0”, .内容, “,0,'”, 借款人性质, “',”, 删首尾空 (到文本 (借款人编号)), “,'”, .内容, “','”, .内容, “','”, .内容, “')”).未知支持库函数_4 ()) ' 添加记录
    信息框 (“存盘成功！”, 相加 (#信息图标, #确认钮), “提示信息”)
    赋值 (.禁止, 假)
    赋值 (.可视, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.内容, “”)
    获取焦点 ()
.否则
    信息框 (“存盘失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
.如果结束


.子程序 _借款人列表框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_确定按钮_被单击 ()

.子程序 _确定按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _确定按钮_被单击 ()
.如果真结束


.子程序 _展期天数编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _数据移植贷款录入窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()

.子程序 _利率编辑框_获得焦点, 空白型, , 如利率框为空，根据输入内容自动生成利率
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入整数变量, 整数型, , , 
.局部变量 读入双精度变量, 双精度小数型, , , 
.局部变量 读入日期变量, 日期时间型, , , 

.如果真 (等于 (.内容, “”))
    赋值 (借款天数, 取时间间隔 (到时间 (.内容), 到时间 (.内容), #日)) ' 计算借款天数
    “select * from dk_llmb order by tsh asc”.未知支持库函数_14 (1)
    未知支持库函数_34 ()
    .判断循环首 (等于 (., 假))
        “tsh”.未知支持库函数_29 (读入整数变量)
        .如果真 (大于或等于 (借款天数, 读入整数变量))
            “xm”.未知支持库函数_26 (读入文本变量)
        .如果真结束
        未知支持库函数_36 ()
    .判断循环尾 ()
    未知支持库函数_16 ()
    相加 (“select * from dk_llk where xm='”, 读入文本变量, “' order by rq asc”).未知支持库函数_14 (1)
    .如果真 (未知支持库函数_34 ())
        .如果 (等于 (借款人性质, “3”))
            “qdll”.未知支持库函数_27 (读入双精度变量)
        .否则
            “ndll”.未知支持库函数_27 (读入双精度变量)
        .如果结束
        未知支持库函数_36 ()
        .判断循环首 (等于 (., 假))
            “rq”.未知支持库函数_31 (读入日期变量)
            .如果真 (大于 (取日期 (到时间 (.内容)), 取日期 (读入日期变量)))
                .如果 (等于 (借款人性质, “3”)) ' 企业贷款
                    “qdll”.未知支持库函数_27 (读入双精度变量)
                .否则
                     ' 农业贷款
                    “ndll”.未知支持库函数_27 (读入双精度变量)
                .如果结束
                
            .如果真结束
            
        .判断循环尾 ()
    .如果真结束
    未知支持库函数_16 ()
    赋值 (.内容, 删首尾空 (到文本 (读入双精度变量)))
.如果真结束


.子程序 _到期日编辑框_失去焦点, 空白型, , 判断到期日输入是否正确
.如果 (等于 (.内容, “”))
    赋值 (.内容, 时间到文本 (增减时间 (到时间 (处理日期 (.内容)), #年份, 1), #日期部分))
.否则
    .如果 (小于 (到时间 (.内容), 到时间 (.内容)))
        信息框 (“到期日期不能小于借款日期!”, 相加 (#错误图标, #确认钮), “提示信息”)
        赋值 (.内容, 时间到文本 (增减时间 (到时间 (处理日期 (.内容)), #年份, 1), #日期部分))
    .否则
        .如果 (小于或等于 (取时间间隔 (到时间 (.内容), 到时间 (.内容), #日), 366))
            赋值 (.现行选中项, 0)
        .否则
            .如果 (大于 (取时间间隔 (到时间 (.内容), 到时间 (.内容), #日), 1827))
                赋值 (.现行选中项, 2)
            .否则
                赋值 (.现行选中项, 1)
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 _展期天数编辑框_失去焦点, 空白型, , 判断展期天数输入是否正确
.如果真 (不等于 (.内容, “”))
    .如果真 (小于 (到数值 (.内容), 0))
        赋值 (.内容, “0”)
    .如果真结束
    
.如果真结束


.子程序 _借款人编辑框_失去焦点, 空白型, , 
.局部变量 临时变量, 整数型, , , 
.局部变量 有无汉字, 逻辑型, , , 
.局部变量 文本长度, 整数型, , , 
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入数值变量, 整数型, , , 
.局部变量 当前表项, 整数型, , , 

赋值 (.内容, 删首尾空 (.内容))
.如果 (等于 (.内容, “”))
    赋值 (借款人编号, 0)
.否则
    赋值 (文本长度, 取文本长度 (.内容))
    赋值 (临时变量, 1)
    赋值 (有无汉字, 假)
    .判断循环首 (小于或等于 (临时变量, 文本长度))
        .如果真 (小于 (取代码 (.内容, 临时变量), 0))
            赋值 (有无汉字, 真)
            跳出循环 ()
        .如果真结束
        赋值 (临时变量, 相加 (临时变量, 1))
    .判断循环尾 ()
    .如果 (等于 (有无汉字, 真)) ' 有汉字，以借款人为查询条件
        相加 (“select id,name,jm,cz,dy,xzh from dk_jkrxx where name like '%”, .内容, “%'”).未知支持库函数_14 (1)
    .否则
         ' 无汉字，以借款人简码为查询条件
        相加 (“select id,name,jm,cz,dy,xzh from dk_jkrxx where jm like '%”, .内容, “%'”).未知支持库函数_14 (1)
    .如果结束
    .如果 (大于 (., 0))
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
        赋值 (.可视, 真)
        全部删除 ()
        清除数组 (借款人编号数组)
        清除数组 (借款人简码数组)
        清除数组 (地域性质数组)
        未知支持库函数_34 ()
        .判断循环首 (等于 (., 假))
            “name”.未知支持库函数_26 (读入文本变量)
            赋值 (当前表项, -1.插入表项 (读入文本变量, , , , ))
            “cz”.未知支持库函数_26 (读入文本变量)
            当前表项.置标题 (1, 读入文本变量)
            “xzh”.未知支持库函数_26 (读入文本变量)
            当前表项.置标题 (2, 读入文本变量)
            “id”.未知支持库函数_29 (读入数值变量)
            加入成员 (借款人编号数组, 读入数值变量)
            “dy”.未知支持库函数_26 (读入文本变量)
            加入成员 (地域性质数组, 读入文本变量)
            “jm”.未知支持库函数_26 (读入文本变量)
            加入成员 (借款人简码数组, 读入文本变量)
            未知支持库函数_36 ()
        .判断循环尾 ()
        赋值 (., 0)
        获取焦点 ()
    .否则
        信息框 (“无此借款人信息！”, 相加 (#错误图标, #确认钮), “提示信息”)
        赋值 (.内容, “”)
        赋值 (借款人编号, 0)
    .如果结束
    未知支持库函数_16 ()
.如果结束


.子程序 _录入按钮_被单击, 空白型, , 
.如果真 (等于 (删首尾空 (.内容), “”))
    信息框 (“请输入流水号!”, 相加 (#信息图标, #确认钮), “提示信息”)
.如果真结束
相加 (“select lsh from dk_base where lsh='”, .内容, “'”).未知支持库函数_14 (1)
.如果 (大于 (., 0)) ' 流水号已存在
    信息框 (“此流水号已存在!”, 相加 (#信息图标, #确认钮), “提示信息”)
.否则
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.可视, 真)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.禁止, 真)
    获取焦点 ()
.如果结束
未知支持库函数_16 ()



.窗口程序集 数据备份窗口程序集, , , 将数据备份到硬盘备份区或软盘

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _备份数据按钮_被单击, 空白型, , 备份数据
.局部变量 备份日期, 文本型, , , 
.局部变量 备份文件名称, 文本型, , , 
.局部变量 软件文件名称, 文本型, , , 
.局部变量 磁盘剩余空间, 整数型, , , 
.局部变量 磁盘数量, 整数型, , , 
.局部变量 源文件, 整数型, , , 
.局部变量 目标文件, 整数型, , , 
.局部变量 目标文件名, 文本型, , , 
.局部变量 读入字节集内容, 字节集, , , 
.局部变量 读入字节集数量, 整数型, , , 
.局部变量 源文件长度, 整数型, , , 
.局部变量 已读入文件长度, 整数型, , , 

赋值 (.标题, “提示：正在将数据备份到硬盘备份区……”)
处理事件 ()
 ' 如果真 (压缩和修复数据库 (取运行目录 () ＋ “\dkgl.mdb”, #数据库密码) ＝ 假)
 ' 信息框 (“系统试图对数据库进行压缩时失败，但不会影响您备份数据！”, #信息图标 ＋ #确认钮, “提示信息”)
.如果 (等于 (是否已移植完毕, “0”))
    赋值 (备份日期, “yzh”)
.否则
    赋值 (备份日期, 到文本 (取日 (总控时间)))
.如果结束
赋值 (备份文件名称, 相加 (取运行目录 (), “\dat\dk”, 备份日期, “.bak”)) ' 生成硬盘备份区备份文件名称
.如果真 (文件是否存在 (备份文件名称))
    删除文件 (备份文件名称)
.如果真结束
.如果 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_0 (备份文件名称), 1)) ' 备份到硬盘备份区
    .如果 (等于 (.选中, 真)) ' 备份到输入被选中，将数据备份到软盘
        赋值 (.标题, “提示：正在将数据备份到软盘……”)
        处理事件 ()
        赋值 (源文件, 打开文件 (备份文件名称, #读入, ))
        赋值 (磁盘数量, 1)
        赋值 (磁盘剩余空间, -1)
        赋值 (已读入文件长度, 0)
        赋值 (源文件长度, 取文件长度 (源文件))
        移到文件首 (源文件)
        .判断循环首 (等于 (是否在文件尾 (源文件, ), 假)) ' 未备份完毕，继续备份
            信息框 (相加 (“请将一张空磁盘(”, 删首尾空 (到文本 (磁盘数量)), “)插入A驱！”), 相加 (#信息图标, #确认钮), “提示信息”)
            赋值 (磁盘剩余空间, 取磁盘剩余空间 (“A”))
            .判断循环首 (小于或等于 (磁盘剩余空间, 10))
                .如果 (等于 (信息框 (相加 (“空间不足，请将一张空磁盘(”, 删首尾空 (到文本 (磁盘数量)), “)插入A驱！”), 相加 (#信息图标, #确认取消钮), “提示信息”), #确认钮))
                    赋值 (磁盘剩余空间, 取磁盘剩余空间 (“A”))
                .否则
                    赋值 (.标题, “提示：备份失败！”)
                    信息框 (“备份失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
                    关闭文件 (源文件)
                    返回 ()
                .如果结束
                
            .判断循环尾 ()
            赋值 (目标文件名, 相加 (“a:\a”, 删首尾空 (到文本 (备份日期)), “.”, 删首尾空 (到文本 (磁盘数量))))
            .如果真 (等于 (文件是否存在 (目标文件名), 真))
                删除文件 (目标文件名)
            .如果真结束
            赋值 (目标文件, 打开文件 (目标文件名, #重写, ))
            赋值 (磁盘剩余空间, 相乘 (相减 (磁盘剩余空间, 10), 1024))
            .如果 (小于或等于 (相减 (源文件长度, 已读入文件长度), 磁盘剩余空间)) ' 如剩余文件长度大于磁盘剩余空间则以磁盘剩余空间为准读入字节集，否则以剩余文件长度为准
                写文本行 (目标文件, “e”) ' 标注为最后一张盘
                赋值 (读入字节集数量, 相减 (源文件长度, 已读入文件长度))
            .否则
                写文本行 (目标文件, “a”) ' 标注为非最后一张盘
                赋值 (读入字节集数量, 磁盘剩余空间)
            .如果结束
            赋值 (读入字节集内容, 读入字节集 (源文件, 读入字节集数量))
            赋值 (读入字节集数量, 取字节集长度 (读入字节集内容))
            写文本行 (目标文件, 删首尾空 (到文本 (读入字节集数量)))
            写出字节集 (目标文件, 读入字节集内容)
            赋值 (已读入文件长度, 相加 (已读入文件长度, 读入字节集数量))
            关闭文件 (目标文件)
            赋值 (磁盘数量, 相加 (磁盘数量, 1))
        .判断循环尾 ()
        赋值 (.标题, “提示：备份成功！”)
        信息框 (“备份完毕！”, 相加 (#信息图标, #确认钮), “提示信息”)
        关闭文件 (源文件)
    .否则
        赋值 (.标题, “提示：备份成功！”)
        信息框 (“备份完毕！”, 相加 (#信息图标, #确认钮), “提示信息”)
    .如果结束
    
.否则
    赋值 (.标题, “提示：备份失败！”)
    信息框 (“备份失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
.如果结束


.子程序 _数据备份窗口_创建完毕, 空白型, , 
赋值 (数据备份窗口., 相减 (相加 (数据备份窗口., 122), 数据备份窗口.取用户区高度 ()))

.子程序 压缩和修复数据库, 逻辑型, , 对Access数据库进行压缩和修复
.参数 数据库文件名称, 文本型, , 要压缩的数据库名称
.参数 数据库密码, 文本型, , 要压缩的数据库密码

.局部变量 临时文件, 文本型, , , 
.局部变量 ACCESS控件, 空白型, , , 左边类型应该填入JetEngine

 ' 因为ACCESS数据库在使用过程中会产生许多冗余信息和历史记录，使用数据库文件变的非常大，使用msjro控件对数据库进行压缩和修复后，可以去除这些信息，使数据库文件成倍的减小，其它压缩工具无法做到这一点，系统中已提供一个msjro.npk文件，如果您使用，请将NPK文件拷贝到易语言的LIB目录下，然后将下面的命令解除屏蔽即可。
 ' ACCESS控件.创建 ()
 ' 删除文件 (临时文件)
 ' 临时文件 ＝ 取运行目录 () ＋ “\dkglbak.mdb”
 ' ACCESS控件.CompactDatabase (“Provider=Microsoft.Jet.OLEDB.4.0;Data Source=” ＋ 数据库文件名称 ＋ “;Jet OLEDB:Database Password=” ＋ 数据库密码 ＋ “;”, “Provider=Microsoft.Jet.OLEDB.4.0;Data Source=” ＋ 临时文件 ＋ “;Jet OLEDB:Database Password=” ＋ 数据库密码 ＋ “;”)
 ' .如果 (等于 (文件是否存在 (临时文件), 真))
     ' 复制文件 (临时文件, 数据库文件名称)
     ' 删除文件 (临时文件)
     ' 返回 (真)
.否则
     ' 返回 (假)
.如果结束


.窗口程序集 数据恢复窗口程序集, , , 从硬盘备份区或软盘恢复数据

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _恢复数据按钮_被单击, 空白型, , 恢复数据
.局部变量 备份文件名称, 文本型, , , 
.局部变量 源文件, 整数型, , , 
.局部变量 源文件名称, 文本型, , , 
.局部变量 目标文件, 整数型, , , 
.局部变量 备份日期, 文本型, , , 
.局部变量 读入字节集内容, 字节集, , , 
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入字节集数量, 整数型, , , 
.局部变量 磁盘数量, 整数型, , , 
.局部变量 是否是最后一块磁盘, 逻辑型, , , 

.如果真 (或者 (大于 (到数值 (.内容), 31), 小于 (到数值 (.内容), 0))) ' 日期错误
    信息框 (“请把输入正确的恢复日期！”, 相加 (#错误图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果 (等于 (到数值 (.内容), 0))
    赋值 (备份日期, “yzh”)
.否则
    赋值 (备份日期, 删首尾空 (.内容))
.如果结束
赋值 (备份文件名称, 相加 (取运行目录 (), “\dat\dk”, 备份日期, “.bak”)) ' 硬盘备份文件名称
.如果真 (等于 (.选中, 真)) ' 从软盘恢复
    赋值 (.标题, “提示：正在从软件载入数据……”)
    处理事件 ()
    赋值 (磁盘数量, 1)
    赋值 (目标文件, 打开文件 (备份文件名称, #重写, ))
    赋值 (是否是最后一块磁盘, 假)
     ' 从软盘读入数据
    .判断循环首 (等于 (是否是最后一块磁盘, 假))
        赋值 (源文件名称, 相加 (“a:\a”, 删首尾空 (到文本 (备份日期)), “.”, 删首尾空 (到文本 (磁盘数量))))
        信息框 (相加 (“请将第”, 删首尾空 (到文本 (磁盘数量)), “张磁盘插入A驱”), 相加 (#确认钮, #信息图标), “提示信息”)
        .判断循环首 (真)
            .如果真 (等于 (文件是否存在 (源文件名称), 真))
                跳出循环 ()
            .如果真结束
            .如果真 (等于 (信息框 (相加 (“请将第”, 删首尾空 (到文本 (磁盘数量)), “张磁盘插入A驱”), 相加 (#确认取消钮, #信息图标), “提示信息”), #取消钮))
                信息框 (“恢复失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
                关闭文件 (目标文件)
                返回 ()
            .如果真结束
            
        .判断循环尾 ()
        赋值 (源文件, 打开文件 (源文件名称, #读入, ))
        赋值 (读入文本变量, 读入一行 (源文件))
        .如果真 (等于 (读入文本变量, “”))
            信息框 (“读取数据错误，恢复失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
            关闭文件 (目标文件)
            返回 ()
        .如果真结束
        .如果 (等于 (读入文本变量, “e”)) ' 最后一盘磁盘
            赋值 (是否是最后一块磁盘, 真)
        .否则
            赋值 (是否是最后一块磁盘, 假)
        .如果结束
        赋值 (读入文本变量, 读入一行 (源文件))
        .如果真 (等于 (读入文本变量, “”))
            信息框 (“读取数据错误，恢复失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
            关闭文件 (目标文件)
            返回 ()
        .如果真结束
        赋值 (读入字节集数量, 到数值 (读入文本变量))
        赋值 (读入字节集内容, 读入字节集 (源文件, 读入字节集数量))
        .如果真 (等于 (取字节集长度 (读入字节集内容), 0))
            信息框 (“读取数据错误，恢复失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
            关闭文件 (目标文件)
            返回 ()
        .如果真结束
        写出字节集 (目标文件, 读入字节集内容)
        关闭文件 (源文件)
        赋值 (磁盘数量, 相加 (磁盘数量, 1))
    .判断循环尾 ()
    关闭文件 (目标文件)
.如果真结束
赋值 (.标题, “提示：正在恢复数据……”)
处理事件 ()
.如果 (等于 (备份文件名称.未知支持库函数_2 (取运行目录 ()), 1)) ' 恢复数据
    赋值 (.标题, “恢复成功！”)
    信息框 (“恢复完毕！”, 相加 (#信息图标, #确认钮), “提示信息”)
.否则
    赋值 (.标题, “恢复失败！”)
    信息框 (“恢复失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
.如果结束


.子程序 _数据恢复窗口_创建完毕, 空白型, , 初始化
赋值 (数据恢复窗口., 相减 (相加 (数据恢复窗口., 144), 数据恢复窗口.取用户区高度 ()))
.如果 (等于 (是否已移植完毕, “0”))
    赋值 (.内容, “0”)
.否则
    赋值 (.内容, 到文本 (取日 (总控时间)))
.如果结束


.窗口程序集 数据移植贷款修改窗口程序集, , , 修改移植数据

.程序集变量 借款人简码, 文本型, , , 记录借款人简码
.程序集变量 借款天数, 整数型, , , 记录借款天数
.程序集变量 借款人性质, 文本型, , , 记录借款人性质
.程序集变量 地域性质, 文本型, , , 记录借款人所属地域性质
.程序集变量 借款人编号, 整数型, , , 记录借款人编号
.程序集变量 借款人所属村组, 文本型, , , 记录借款人所属村组
.程序集变量 科目形态数组, 文本型, , "0", 记录科目所属借款形态数组
.程序集变量 借款人编号数组, 整数型, , "0", 记录借款人编号数组
.程序集变量 地域性质数组, 文本型, , "0", 记录借款人所属地域数组
.程序集变量 借款人简码数组, 文本型, , "0", 记录借款人简码数组
.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _科目组合框_失去焦点, 空白型, , 判断科目输入是否正确
.局部变量 科目代号, 文本型, , , 

.如果 (等于 (.内容, “”))
    信息框 (“请输入科目代号!”, 相加 (#信息图标, #确认钮), “提示信息”)
    获取焦点 ()
.否则
    赋值 (科目代号, .内容)
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
    .判断循环首 (大于或等于 (.现行选中项, 0))
        .如果真 (等于 (科目代号, .内容))
            跳出循环 ()
        .如果真结束
        赋值 (.现行选中项, 相减 (.现行选中项, 1))
    .判断循环尾 ()
    .如果 (不等于 (.现行选中项, -1))
        获取焦点 ()
    .否则
        信息框 (“无此科目!”, 相加 (#信息图标, #确认钮), “提示信息”)
        获取焦点 ()
    .如果结束
    
.如果结束


.子程序 _科目组合框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _流水号编辑框_按下某键, 逻辑型, , 根据输入流水号打开相应贷款记录
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入整数变量, 整数型, , , 
.局部变量 读入双精度变量, 双精度小数型, , , 
.局部变量 读入日期变量, 日期时间型, , , 

.如果真 (等于 (键代码, #回车键))
    .如果真 (等于 (删首尾空 (.内容), “”))
        _流水号编辑框_被双击 (0, 0, 0)
        返回 ()
    .如果真结束
    相加 (“select * from dk_base where lsh='”, .内容, “' and jlzht='1'”).未知支持库函数_14 (1)
    .如果 (小于或等于 (., 0))
        信息框 (“此流水号不存在！”, 相加 (#信息图标, #确认钮), “提示信息”)
    .否则
         ' 显示贷款记录
        “lsh”.未知支持库函数_26 (读入文本变量)
        赋值 (.内容, 读入文本变量)
        “name”.未知支持库函数_26 (读入文本变量)
        赋值 (.内容, 读入文本变量)
        “jm”.未知支持库函数_26 (借款人简码)
        “ydje”.未知支持库函数_27 (读入双精度变量)
        赋值 (.内容, 删首尾空 (到文本 (读入双精度变量)))
        “jkye”.未知支持库函数_27 (读入双精度变量)
        赋值 (.内容, 删首尾空 (到文本 (读入双精度变量)))
        “jkr”.未知支持库函数_31 (读入日期变量)
        赋值 (.内容, 时间到文本 (读入日期变量, #日期部分))
        “dqr”.未知支持库函数_31 (读入日期变量)
        赋值 (.内容, 时间到文本 (读入日期变量, #日期部分))
        “jkyt”.未知支持库函数_26 (读入文本变量)
        赋值 (.内容, 读入文本变量)
        “dkzhl”.未知支持库函数_26 (读入文本变量)
        .判断开始 (等于 (读入文本变量, “信用”))
            赋值 (.现行选中项, 0)
        .判断 (等于 (读入文本变量, “保证”))
            赋值 (.现行选中项, 1)
        .判断 (等于 (读入文本变量, “抵押”))
            赋值 (.现行选中项, 2)
        .判断 (等于 (读入文本变量, “质押”))
            赋值 (.现行选中项, 3)
        .默认
            赋值 (.现行选中项, 4)
        .判断结束
        “ghbj”.未知支持库函数_27 (读入双精度变量)
        赋值 (.内容, 删首尾空 (到文本 (读入双精度变量)))
        “lxje”.未知支持库函数_27 (读入双精度变量)
        赋值 (.内容, 删首尾空 (到文本 (读入双精度变量)))
        “hxqk”.未知支持库函数_31 (读入日期变量)
        赋值 (.内容, 时间到文本 (读入日期变量, #日期部分))
        “bzh”.未知支持库函数_26 (读入文本变量)
        赋值 (.内容, 读入文本变量)
        “zhqtsh”.未知支持库函数_29 (读入整数变量)
        赋值 (.内容, 删首尾空 (到文本 (读入整数变量)))
        “qx”.未知支持库函数_26 (读入文本变量)
        .判断开始 (等于 (读入文本变量, “短期贷款”))
            赋值 (.现行选中项, 0)
        .判断 (等于 (读入文本变量, “中期贷款”))
            赋值 (.现行选中项, 1)
        .默认
            赋值 (.现行选中项, 2)
        .判断结束
        “cz”.未知支持库函数_26 (借款人所属村组)
        “km”.未知支持库函数_26 (读入文本变量)
        赋值 (.内容, 读入文本变量)
        “ll”.未知支持库函数_27 (读入双精度变量)
        赋值 (.内容, 删首尾空 (到文本 (读入双精度变量)))
        “xzh”.未知支持库函数_26 (借款人性质)
        “jkrbh”.未知支持库函数_29 (借款人编号)
        “jbr”.未知支持库函数_26 (读入文本变量)
        赋值 (.内容, 读入文本变量)
        “spr”.未知支持库函数_26 (读入文本变量)
        赋值 (.内容, 读入文本变量)
        “jkxtw”.未知支持库函数_26 (读入文本变量)
        .判断开始 (等于 (读入文本变量, “正常”))
            赋值 (.现行选中项, 0)
        .判断 (等于 (读入文本变量, “关注”))
            赋值 (.现行选中项, 1)
        .判断 (等于 (读入文本变量, “次级”))
            赋值 (.现行选中项, 2)
        .判断 (等于 (读入文本变量, “可疑”))
            赋值 (.现行选中项, 3)
        .默认
            赋值 (.现行选中项, 4)
        .判断结束
        赋值 (.可视, 真)
        赋值 (.禁止, 真)
        获取焦点 ()
    .如果结束
    未知支持库函数_16 ()
.如果真结束


.子程序 _借款人编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _原贷金额编辑框_失去焦点, 空白型, , 判断原贷金额输入是否正确
.如果真 (小于或等于 (到数值 (.内容), 0))
    信息框 (“原贷金额必须大于零！”, 相加 (#错误图标, #确认钮), “提示信息”)
    赋值 (.内容, “0”)
.如果真结束
.如果 (小于 (到数值 (.内容), 到数值 (.内容)))
    信息框 (“已还本金不能大于原贷金额”, 相加 (#错误图标, #确认钮), “提示信息”)
    赋值 (.内容, “0”)
    赋值 (.内容, .内容)
.否则
    赋值 (.内容, 到文本 (相减 (到数值 (.内容), 到数值 (.内容))))
.如果结束


.子程序 _原贷金额编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _已还本金编辑框_失去焦点, 空白型, , 判断已还本金输入是否正确
.如果真 (小于 (到数值 (.内容), 0))
    信息框 (“已还本金不能小于零！”, 相加 (#错误图标, #确认钮), “提示信息”)
    赋值 (.内容, “0”)
.如果真结束
.如果 (小于 (到数值 (.内容), 到数值 (.内容)))
    信息框 (“已还本金不能大于原贷金额”, 相加 (#错误图标, #确认钮), “提示信息”)
    赋值 (.内容, “0”)
    赋值 (.内容, .内容)
.否则
    赋值 (.内容, 到文本 (相减 (到数值 (.内容), 到数值 (.内容))))
.如果结束


.子程序 _已还本金编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _已还利息编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _借款日编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _到期日编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _期限类型组合框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _起息日编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _利率编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _贷款方式组合框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _五级分类组合框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _借款用途编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _审批人编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _经办人编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _借款日编辑框_失去焦点, 空白型, , 
赋值 (.内容, .内容)

.子程序 _借款人编辑框_失去焦点, 空白型, , 根据输入内容，显示借款人选择框供用户选择
.局部变量 临时变量, 整数型, , , 
.局部变量 有无汉字, 逻辑型, , , 
.局部变量 文本长度, 整数型, , , 
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入数值变量, 整数型, , , 
.局部变量 当前表项, 整数型, , , 

赋值 (.内容, 删首尾空 (.内容))
.如果 (等于 (.内容, “”))
    信息框 (“请输入借款人名称或简码！”, 相加 (#信息图标, #确认钮), “提示信息”)
.否则
    赋值 (文本长度, 取文本长度 (.内容))
    赋值 (临时变量, 1)
    赋值 (有无汉字, 假)
    .判断循环首 (小于或等于 (临时变量, 文本长度))
        .如果真 (小于 (取代码 (.内容, 临时变量), 0))
            赋值 (有无汉字, 真)
            跳出循环 ()
        .如果真结束
        赋值 (临时变量, 相加 (临时变量, 1))
    .判断循环尾 ()
    .如果 (等于 (有无汉字, 真)) ' 有汉字，以借款人为条件进行查询
        相加 (“select id,name,jm,cz,dy,xzh from dk_jkrxx where name like '%”, .内容, “%'”).未知支持库函数_14 (1)
    .否则
         ' 无汉字，以借款人简码为条件进行查询
        相加 (“select id,name,jm,cz,dy,xzh from dk_jkrxx where jm like '%”, .内容, “%'”).未知支持库函数_14 (1)
    .如果结束
    .如果 (大于 (., 0))
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
        赋值 (.可视, 真)
        全部删除 ()
        清除数组 (借款人编号数组)
        清除数组 (借款人简码数组)
        清除数组 (地域性质数组)
        未知支持库函数_34 ()
        .判断循环首 (等于 (., 假))
            “name”.未知支持库函数_26 (读入文本变量)
            赋值 (当前表项, -1.插入表项 (读入文本变量, , , , ))
            “cz”.未知支持库函数_26 (读入文本变量)
            当前表项.置标题 (1, 读入文本变量)
            “xzh”.未知支持库函数_26 (读入文本变量)
            当前表项.置标题 (2, 读入文本变量)
            “id”.未知支持库函数_29 (读入数值变量)
            加入成员 (借款人编号数组, 读入数值变量)
            “dy”.未知支持库函数_26 (读入文本变量)
            加入成员 (地域性质数组, 读入文本变量)
            “jm”.未知支持库函数_26 (读入文本变量)
            加入成员 (借款人简码数组, 读入文本变量)
            未知支持库函数_36 ()
        .判断循环尾 ()
        赋值 (., 0)
        获取焦点 ()
    .否则
        信息框 (“无此借款人信息！”, 相加 (#错误图标, #确认钮), “提示信息”)
        赋值 (.内容, “”)
    .如果结束
    未知支持库函数_16 ()
.如果结束


.子程序 _取消按钮_被单击, 空白型, , 退出编辑状态，不保存数据
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.可视, 假)
赋值 (.内容, “”)

.子程序 _确定按钮_被单击, 空白型, , 选定借款人
.如果真 (不等于 (., -1))
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.可视, 假)
    赋值 (.内容, .取标题 (., 0))
    赋值 (借款人简码, 借款人简码数组 [相加 (., 1)])
    赋值 (借款人性质, .取标题 (., 2))
    赋值 (借款人所属村组, .取标题 (., 1))
    赋值 (地域性质, 地域性质数组 [相加 (., 1)])
    赋值 (借款人编号, 借款人编号数组 [相加 (., 1)])
    获取焦点 ()
.如果真结束


.子程序 _已还利息编辑框_失去焦点, 空白型, , 判断已还利息输入是否正确
.如果真 (小于 (到数值 (.内容), 0))
    信息框 (“已还利息不能小于零！”, 相加 (#错误图标, #确认钮), “提示信息”)
    赋值 (.内容, “0”)
.如果真结束


.子程序 _利率编辑框_失去焦点, 空白型, , 判断利率输入是否正确
.如果真 (小于 (到数值 (.内容), 0))
    信息框 (“利率不能小于零！”, 相加 (#错误图标, #确认钮), “提示信息”)
    赋值 (.内容, “0”)
.如果真结束


.子程序 _存盘按钮_被单击, 空白型, , 保存记录
.局部变量 已逾期天数, 整数型, , , 

 ' 检查输入内容是否符合要求
.如果真 (等于 (.内容, “”))
    信息框 (“借款人不能为空！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (小于或等于 (到数值 (.内容), 0))
    信息框 (“原贷金额必须大于零！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (或者 (大于 (到数值 (.内容), 到数值 (.内容)), 小于 (到数值 (.内容), 0)))
    信息框 (“已还本金不能大于原贷金额或小于零！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (小于 (到数值 (.内容), 0))
    信息框 (“已还利息不能小于零！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入借款日！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (小于 (到时间 (.内容), 到时间 (.内容)))
    信息框 (“到期日不能小于借款日！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (小于 (到时间 (.内容), 到时间 (.内容)))
    信息框 (“起息日不能小于借款日！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.现行选中项, -1))
    信息框 (“请选择期限类型！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.现行选中项, -1))
    信息框 (“请选择贷款方式！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (小于 (到数值 (.内容), 0))
    信息框 (“利率不能小于零！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (小于 (到数值 (.内容), 0))
    信息框 (“展期天数不能小于零！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (借款天数, 取时间间隔 (到时间 (.内容), 到时间 (.内容), #日))
.判断开始 (等于 (.现行选中项, 0)) ' 短期借款
    .如果真 (大于 (到数值 (.内容), 借款天数))
        信息框 (“短期贷款展期天数不能大于原贷款天数！”, 相加 (#错误图标, #确认钮), “提示信息”)
        获取焦点 ()
        返回 ()
    .如果真结束
    
.判断 (等于 (.现行选中项, 1)) ' 中期借款
    .如果真 (大于 (到数值 (相加 (“0”, .内容)), 整除 (借款天数, 2)))
        信息框 (“中期贷款展期天数不能大于原贷款天数的一半！”, 相加 (#错误图标, #确认钮), “提示信息”)
        获取焦点 ()
        返回 ()
    .如果真结束
    
.默认
    .如果真 (大于 (到数值 (相加 (“0”, .内容)), 1827))
        信息框 (“长期贷款展期天数不能超过3年！”, 相加 (#错误图标, #确认钮), “提示信息”)
        获取焦点 ()
        返回 ()
    .如果真结束
    
.判断结束
.如果真 (等于 (.现行选中项, -1))
    信息框 (“请选择五级分类形态！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果 (等于 (是否已移植完毕, “1”))
    赋值 (已逾期天数, 取时间间隔 (总控时间, 到时间 (.内容), #日))
    更新系统日志 (相加 (“错账修改，流水号：”, .内容))
.否则
    赋值 (已逾期天数, 0)
.如果结束
.如果 (相加 (“update dk_base set name='”, .内容, “',jm='”, 借款人简码, “',ydje=0”, .内容, “,jkye=0”, .内容, “,jkr=#”, 处理日期 (.内容), “#,dqr=#”, 处理日期 (.内容), “#,jkxts='”, 科目形态数组 [相加 (.现行选中项, 1)], “',jkyt='”, .内容, “',dkzhl='”, .内容, “',ghbj=0”, .内容, “,lxje=0”, .内容, “,hxqk=#”, 处理日期 (.内容), “#,sbzht='0',bzh='”, .内容, “',zhqtsh=0”, .内容, “,qx='”, .内容, “',jktsh=0”, 删首尾空 (到文本 (借款天数)), “,jlzht='1',cz='”, 借款人所属村组, “',km='”, .内容, “',ll=0”, .内容, “,yqtsh=”, 删首尾空 (到文本 (已逾期天数)), “,xzh='”, 借款人性质, “',jkrbh=”, 删首尾空 (到文本 (借款人编号)), “,jbr='”, .内容, “',spr='”, .内容, “',jkxtw='”, .内容, “' where lsh='”, .内容, “'”).未知支持库函数_4 ()) ' 修改数据
    信息框 (“存盘成功！”, 相加 (#信息图标, #确认钮), “提示信息”)
    赋值 (.可视, 假)
    赋值 (.禁止, 假)
    赋值 (.内容, “”)
    获取焦点 ()
.否则
    信息框 (“存盘失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
.如果结束


.子程序 _借款人列表框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_确定按钮_被单击 ()

.子程序 _确定按钮_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _确定按钮_被单击 ()
.如果真结束


.子程序 _展期天数编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _数据移植贷款信息修改窗口_创建完毕, 空白型, , 初始化
.局部变量 读入文本变量, 文本型, , , 

赋值 (数据移植贷款信息修改窗口., 相减 (相加 (数据移植贷款信息修改窗口., 377), 数据移植贷款信息修改窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
.如果 (等于 (是否已移植完毕, “1”))
    赋值 (数据移植贷款信息修改窗口., “错账修改”)
.否则
    赋值 (数据移植贷款信息修改窗口., “数据移植―贷款信息修改”)
.如果结束
 ' 载入科目信息
“select * from dk_kms order by id”.未知支持库函数_14 (1)
清空 ()
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “id”.未知支持库函数_26 (读入文本变量)
        读入文本变量.加入项目 ()
        “type”.未知支持库函数_26 (读入文本变量)
        加入成员 (科目形态数组, 读入文本变量)
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()
 ' 载入五级分类信息
“select * from dk_fivetype”.未知支持库函数_14 (1)
清空 ()
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “name”.未知支持库函数_26 (读入文本变量)
        读入文本变量.加入项目 ()
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()

.子程序 _数据移植贷款信息修改窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()

.子程序 _展期天数编辑框_失去焦点, 空白型, , 判断展期末数输入是否正确
.如果真 (不等于 (.内容, “”))
    .如果真 (小于 (到数值 (.内容), 0))
        信息框 (“展期末数不能小于零！”, 相加 (#错误图标, #确认钮), “提示信息”)
        赋值 (.内容, “”)
    .如果真结束
    
.如果真结束


.子程序 _流水号编辑框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

“select lsh,name,jkye,jkr,dqr from dk_base where jlzht='1'”.未知支持库函数_14 (1)
显示贷款记录 ()
未知支持库函数_16 ()
赋值 (.可视, 真)

.子程序 显示贷款记录, 空白型, , 
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入日期变量, 日期时间型, , , 
.局部变量 读入数值变量, 双精度小数型, , , 
.局部变量 插入位置, 整数型, , , 

全部删除 ()
赋值 (., -1)
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “lsh”.未知支持库函数_26 (读入文本变量)
        赋值 (插入位置, -1.插入表项 (读入文本变量, , , , ))
        “name”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (1, 读入文本变量)
        “jkye”.未知支持库函数_27 (读入数值变量)
        插入位置.置标题 (2, 到文本 (读入数值变量))
        “jkr”.未知支持库函数_31 (读入日期变量)
        插入位置.置标题 (3, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        “dqr”.未知支持库函数_31 (读入日期变量)
        插入位置.置标题 (4, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        未知支持库函数_36 ()
    .判断循环尾 ()
    赋值 (., 0)
    获取焦点 ()
.如果真结束


.子程序 _查找按钮_被单击, 空白型, , 
赋值 (.内容, 删首尾空 (.内容))
.如果 (等于 (.内容, “”))
    “select lsh,name,jkye,jkr,dqr from dk_base where jlzht='1'”.未知支持库函数_14 (1)
.否则
    相加 (“select lsh,name,jkye,jkr,dqr from dk_base where jlzht='1' and name like '%”, .内容, “%'”).未知支持库函数_14 (1)
.如果结束
显示贷款记录 ()
未知支持库函数_16 ()

.子程序 _确认按钮_被单击, 空白型, , 
.如果 (不等于 (., -1))
    赋值 (.内容, .取标题 (., 0))
.否则
    赋值 (.内容, “”)
.如果结束
赋值 (.可视, 假)
获取焦点 ()

.子程序 _贷款列表框_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_确认按钮_被单击 ()

.子程序 _贷款列表框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _确认按钮_被单击 ()
.如果真结束


.子程序 _查询按钮_被单击, 空白型, , 
“select lsh,name,jkye,jkr,dqr from dk_base where jlzht='1'”.未知支持库函数_14 (1)
显示贷款记录 ()
未知支持库函数_16 ()
赋值 (.可视, 真)

.窗口程序集 数据移植贷款信息查询窗口程序集, , , 查询贷款移植数据

.子程序 _数据移植贷款信息查询窗口_创建完毕, 空白型, , 初始化
.局部变量 读入文本变量, 文本型, , , 

赋值 (数据移植贷款信息查询窗口., 相减 (相加 (数据移植贷款信息查询窗口., 391), 数据移植贷款信息查询窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
 ' 载入科目信息
“select id from dk_kms order by id”.未知支持库函数_14 (1)
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “id”.未知支持库函数_26 (读入文本变量)
        读入文本变量.加入项目 ()
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()
_查询全部贷款按钮_被单击 ()
获取焦点 ()

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _重置按钮_被单击, 空白型, , 重置输入控件
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
获取焦点 ()

.子程序 _查询全部贷款按钮_被单击, 空白型, , 查询全部贷款
“select km,lsh,name,ydje,jkye,lxje,jkr,dqr,hxqk,ll,dkzhl,spr,jbr from dk_base order by jkr”.未知支持库函数_14 (1)
刷新贷款数据 ()
未知支持库函数_16 ()

.子程序 刷新贷款数据, 空白型, , 根据查询结果刷新贷款数据显示
.局部变量 当前选中项, 整数型, , , 
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入日期变量, 日期时间型, , , 
.局部变量 读入双精度变量, 双精度小数型, , , 
.局部变量 行数, 整数型, , , 

全部删除 ()
.如果真 (等于 (相加 (取运行目录 (), “\report\移植贷款信息.grd”).从文件读 (), 假))
    信息框 (“不能读入打印模板！”, 相加 (#警告图标, #确认钮), “提示信息”)
.如果真结束
2.置文本 (1, 相加 (“单位：”, 信用社名称))
 ' 显示数据
赋值 (行数, 4)
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        .添加行 ()
        行数.置字体名 (1, , 13, )
        行数.置字体尺寸 (1, , 13, 32)
        “km”.未知支持库函数_26 (读入文本变量)
        赋值 (当前选中项, -1.插入表项 (读入文本变量, , , , ))
        行数.置文本 (1, 读入文本变量)
        “lsh”.未知支持库函数_26 (读入文本变量)
        当前选中项.置标题 (1, 读入文本变量)
        行数.置文本 (2, 读入文本变量)
        “name”.未知支持库函数_26 (读入文本变量)
        当前选中项.置标题 (2, 读入文本变量)
        行数.置文本 (3, 读入文本变量)
        “ydje”.未知支持库函数_27 (读入双精度变量)
        当前选中项.置标题 (3, 删首尾空 (到文本 (读入双精度变量)))
        行数.置文本 (4, 删首尾空 (到文本 (读入双精度变量)))
        “jkye”.未知支持库函数_27 (读入双精度变量)
        当前选中项.置标题 (4, 删首尾空 (到文本 (读入双精度变量)))
        行数.置文本 (5, 删首尾空 (到文本 (读入双精度变量)))
        “lxje”.未知支持库函数_27 (读入双精度变量)
        当前选中项.置标题 (5, 删首尾空 (到文本 (读入双精度变量)))
        行数.置文本 (6, 删首尾空 (到文本 (读入双精度变量)))
        “jkr”.未知支持库函数_31 (读入日期变量)
        当前选中项.置标题 (6, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        行数.置文本 (7, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        “dqr”.未知支持库函数_31 (读入日期变量)
        当前选中项.置标题 (7, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        行数.置文本 (8, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        “hxqk”.未知支持库函数_31 (读入日期变量)
        当前选中项.置标题 (8, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        行数.置文本 (9, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        “ll”.未知支持库函数_27 (读入双精度变量)
        当前选中项.置标题 (9, 删首尾空 (到文本 (读入双精度变量)))
        行数.置文本 (10, 删首尾空 (到文本 (读入双精度变量)))
        “dkzhl”.未知支持库函数_26 (读入文本变量)
        当前选中项.置标题 (10, 读入文本变量)
        行数.置文本 (11, 读入文本变量)
        “spr”.未知支持库函数_26 (读入文本变量)
        当前选中项.置标题 (11, 读入文本变量)
        行数.置文本 (12, 读入文本变量)
        “jbr”.未知支持库函数_26 (读入文本变量)
        当前选中项.置标题 (12, 读入文本变量)
        行数.置文本 (13, 读入文本变量)
        未知支持库函数_36 ()
        赋值 (行数, 相加 (行数, 1))
    .判断循环尾 ()
    赋值 (行数, 相减 (取行数 (), 3))
    4.置对齐方式 (1, 行数, 3, #中左)
    4.置对齐方式 (4, 行数, 3, #中右)
    4.置对齐方式 (7, 行数, 3, #中左)
    4.置对齐方式 (10, 行数, , #中右)
    4.置对齐方式 (11, 行数, 3, #中左)
    4.置行高 (行数, 50)
    4.加线条 (1, 行数, 13, 相加 (#左边框, #右边框, #上边框, #下边框, #垂直线, #水平线))
.如果真结束


.子程序 _科目组合框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _借款人编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _金额编辑框1_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _金额编辑框2_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _借款日编辑框1_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _借款日编辑框2_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _数据移植贷款信息查询窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()

.子程序 _查询按钮_被单击, 空白型, , 查询数据
.局部变量 查询条件, 文本型, , , 

.如果真 (不等于 (.内容, “”))
    赋值 (查询条件, 相加 (“km='”, .内容, “'”))
.如果真结束
.如果真 (不等于 (.内容, “”))
    .如果 (等于 (查询条件, “”))
        赋值 (查询条件, 相加 (“name like '%”, .内容, “%'”))
    .否则
        赋值 (查询条件, 相加 (查询条件, “ and name like '%”, .内容, “%'”))
    .如果结束
    
.如果真结束
.如果真 (不等于 (.内容, “”))
    .如果 (等于 (查询条件, “”))
        赋值 (查询条件, 相加 (“jkye>=”, .内容))
    .否则
        赋值 (查询条件, 相加 (查询条件, “ and jkye>=”, .内容))
    .如果结束
    
.如果真结束
.如果真 (不等于 (.内容, “”))
    .如果 (等于 (查询条件, “”))
        赋值 (查询条件, 相加 (“jkye<=”, .内容))
    .否则
        赋值 (查询条件, 相加 (查询条件, “ and jkye<=”, .内容))
    .如果结束
    
.如果真结束
.如果真 (不等于 (.内容, “”))
    .如果 (等于 (查询条件, “”))
        赋值 (查询条件, 相加 (“jkr>=#”, 处理日期 (.内容), “#”))
    .否则
        赋值 (查询条件, 相加 (查询条件, “ and jkr>=#”, 处理日期 (.内容), “#”))
    .如果结束
    
.如果真结束
.如果真 (不等于 (.内容, “”))
    .如果 (等于 (查询条件, “”))
        赋值 (查询条件, 相加 (“jkr<=#”, 处理日期 (.内容), “#”))
    .否则
        赋值 (查询条件, 相加 (查询条件, “ and jkr<=#”, 处理日期 (.内容), “#”))
    .如果结束
    
.如果真结束
.如果 (不等于 (查询条件, “”))
    相加 (“select km,lsh,name,ydje,jkye,lxje,jkr,dqr,hxqk,ll,dkzhl,spr,jbr from dk_base where ”, 查询条件, “ order by jkr”).未知支持库函数_14 (1)
.否则
    “select km,lsh,name,ydje,jkye,lxje,jkr,dqr,hxqk,ll,dkzhl,spr,jbr from dk_base order by jkr”.未知支持库函数_14 (1)
.如果结束
.如果 (.)
    刷新贷款数据 ()
    未知支持库函数_16 ()
.否则
    信息框 (“SQL语句错误！”, 相加 (#错误图标, #确认钮), “提示信息”)
    全部删除 ()
.如果结束


.子程序 _打印预览按钮_被单击, 空白型, , 打印预览
打印预览 ()

.子程序 _打印按钮_被单击, 空白型, , 打印
真.打印 (“贷款移植数据明细清单”)

.窗口程序集 利率库维护窗口窗口程序集, , , 维护历史利率

.程序集变量 是否正在编辑, 逻辑型, , , 真：编辑状态，假：浏览状态
.程序集变量 是否添加记录, 逻辑型, , , 存盘时是否添加新记录
.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _利率库维护窗口_创建完毕, 空白型, , 初始化
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入数值变量, 整数型, , , 
.局部变量 加入的位置, 整数型, , , 

赋值 (利率库维护窗口., 相减 (相加 (利率库维护窗口., 281), 利率库维护窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
“select * from dk_llmb order by tsh”.未知支持库函数_14 (1)
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “xm”.未知支持库函数_26 (读入文本变量)
        “tsh”.未知支持库函数_29 (读入数值变量)
        读入文本变量.加入项目 (读入数值变量)
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()
赋值 (.现行选中项, 0)
刷新数据显示 ()
赋值 (是否正在编辑, 假)

.子程序 刷新数据显示, 空白型, , 重新显示记录
.局部变量 读入整数变量, 整数型, , , 
.局部变量 读入日期变量, 日期时间型, , , 
.局部变量 读入双精度变量, 双精度小数型, , , 
.局部变量 当前表项, 整数型, , , 

相加 (“select * from dk_llk where xm='”, .内容, “' order by rq asc”).未知支持库函数_14 (1)
全部删除 ()
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “id”.未知支持库函数_29 (读入整数变量)
        “rq”.未知支持库函数_31 (读入日期变量)
        赋值 (当前表项, .插入表项 (处理日期 (时间到文本 (读入日期变量, #日期部分)), , , , 读入整数变量))
        “ndll”.未知支持库函数_27 (读入双精度变量)
        当前表项.置标题 (1, 到文本 (读入双精度变量))
        “qdll”.未知支持库函数_27 (读入双精度变量)
        当前表项.置标题 (2, 到文本 (读入双精度变量))
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()
.如果 (大于 (取表项数 (), 0))
    赋值 (., 0)
.否则
    赋值 (., -1)
.如果结束
_利率列表框_当前表项被改变 ()

.子程序 _利率库维护窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()

.子程序 _日期编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _农业贷款利率编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _企业贷款利率编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _添加按钮_被单击, 空白型, , 更新数据
.如果 (等于 (是否正在编辑, 真)) ' 编辑状态
    .如果真 (或者 (小于或等于 (到数值 (相加 (“0”, .内容)), 0), 小于或等于 (到数值 (相加 (“0”, .内容)), 0)))
        信息框 (“贷款利率必须大于零！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    .如果 (等于 (是否添加记录, 真))
        .如果 (相加 (“insert into dk_llk(xm,tsh,rq,ndll,qdll) values('”, .内容, “',”, 删首尾空 (到文本 (.取项目数值 (.现行选中项))), “,#”, 处理日期 (时间到文本 (.今天, #日期部分)), “#,”, .内容, “,”, .内容, “)”).未知支持库函数_4 ()) ' 添加记录
            刷新数据显示 ()
            赋值 (是否正在编辑, 假)
            修改控件状态 (是否正在编辑)
        .否则
            信息框 (“存盘失败，请检查数据是否输入完整！”, 相加 (#错误图标, #确认钮), “提示信息”)
        .如果结束
        
    .否则
        .如果 (相加 (“update dk_llk set rq=#”, 处理日期 (时间到文本 (.今天, #日期部分)), “#,ndll=0”, .内容, “,qdll=0”, .内容, “ where id=”, 到文本 (.取表项数值 (.))).未知支持库函数_4 ()) ' 修改记录
            刷新数据显示 ()
            赋值 (是否正在编辑, 假)
            修改控件状态 (是否正在编辑)
        .否则
            信息框 (“存盘失败，请检查数据是否输入完整！”, 相加 (#错误图标, #确认钮), “提示信息”)
        .如果结束
        
    .如果结束
    
.否则
    赋值 (是否正在编辑, 真)
    修改控件状态 (是否正在编辑)
    赋值 (是否添加记录, 真)
    赋值 (.今天, 取日期 (取现行时间 ()))
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    获取焦点 ()
.如果结束


.子程序 修改控件状态, 空白型, , 根据操作状态修改控件属性
.参数 类型, 逻辑型, , 

.如果 (等于 (类型, 真))
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.标题, “保存”)
    赋值 (.标题, “取消”)
    赋值 (.字体名称, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.标题, “添加”)
    赋值 (.标题, “编辑”)
    赋值 (.字体名称, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
.如果结束


.子程序 _编辑按钮_被单击, 空白型, , 编辑/取消编辑
.如果 (等于 (是否正在编辑, 真))
    赋值 (是否正在编辑, 假)
    修改控件状态 (是否正在编辑)
.否则
    .如果真 (不等于 (., -1))
        赋值 (是否正在编辑, 真)
        赋值 (是否添加记录, 假)
        修改控件状态 (是否正在编辑)
        获取焦点 ()
    .如果真结束
    
.如果结束


.子程序 _期限类型组合框_列表项被选择, 空白型, , 期限类型被改变，重新显示记录
刷新数据显示 ()

.子程序 _利率列表框_当前表项被改变, 空白型, , 
.如果 (不等于 (., -1))
    赋值 (.今天, 到时间 (.取标题 (., 0)))
    赋值 (.内容, .取标题 (., 1))
    赋值 (.内容, .取标题 (., 2))
.否则
    赋值 (.今天, 取日期 (取现行时间 ()))
    赋值 (.内容, “”)
    赋值 (.内容, “”)
.如果结束


.子程序 _添加按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _添加按钮_被单击 ()
.如果真结束


.子程序 _删除按钮_被单击, 空白型, , 删除记录
.如果真 (不等于 (., -1))
    .如果真 (等于 (信息框 (“真的删除此记录吗？”, 相加 (#询问图标, #确认取消钮), “提示信息”), #确认钮))
        .如果 (相加 (“delete from dk_llk where id=”, 删首尾空 (到文本 (.取表项数值 (.)))).未知支持库函数_4 ())
            刷新数据显示 ()
        .否则
            信息框 (“无法删除此记录！”, 相加 (#错误图标, #确认钮), “提示信息”)
        .如果结束
        
    .如果真结束
    
.如果真结束


.窗口程序集 科目余额表移植窗口程序集, , , 移植科目余额表

.子程序 _科目余额表移植窗口_创建完毕, 空白型, , 初始化
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入双精度变量, 双精度小数型, , , 
.局部变量 行号, 整数型, , , 

赋值 (科目余额表移植窗口., 相减 (相加 (科目余额表移植窗口., 344), 科目余额表移植窗口.取用户区高度 ()))
 ' 显示数据
0.未知支持库函数_32 (60)
1.未知支持库函数_32 (150)
2.未知支持库函数_32 (100)
3.未知支持库函数_32 (100)
4.未知支持库函数_32 (100)
5.未知支持库函数_32 (100)
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
“select * from dk_kmyeyzhs order by dh”.未知支持库函数_14 (1)
赋值 (行号, 0)
0.未知支持库函数_9 (0, #., “科目代号”)
0.未知支持库函数_9 (1, #., “科目名称”)
0.未知支持库函数_9 (2, #., “年初数”)
0.未知支持库函数_9 (3, #., “本年借方发生额”)
0.未知支持库函数_9 (4, #., “本年贷方发生额”)
0.未知支持库函数_9 (5, #., “期末余额”)
0.未知支持库函数_30 (#.)
1.未知支持库函数_30 (#.)
2.未知支持库函数_30 (#.)
3.未知支持库函数_30 (#.)
4.未知支持库函数_30 (#.)
5.未知支持库函数_30 (#.)
.如果 (大于 (., 0))
    未知支持库函数_34 ()
    .判断循环首 (等于 (., 假))
        赋值 (行号, 相加 (行号, 1))
        “dh”.未知支持库函数_26 (读入文本变量)
        读入文本变量.未知支持库函数_38 ()
        “name”.未知支持库函数_26 (读入文本变量)
        行号.未知支持库函数_9 (1, #., 读入文本变量)
        “ncye”.未知支持库函数_27 (读入双精度变量)
        行号.未知支持库函数_9 (2, #., 到文本 (读入双精度变量))
        “jffshe”.未知支持库函数_27 (读入双精度变量)
        行号.未知支持库函数_9 (3, #., 到文本 (读入双精度变量))
        “dffshe”.未知支持库函数_27 (读入双精度变量)
        行号.未知支持库函数_9 (4, #., 到文本 (读入双精度变量))
        “ye”.未知支持库函数_27 (读入双精度变量)
        行号.未知支持库函数_9 (5, #., 到文本 (读入双精度变量))
        未知支持库函数_36 ()
    .判断循环尾 ()
.否则
    未知支持库函数_16 ()
    “select * from dk_kms order by id”.未知支持库函数_14 (1)
    未知支持库函数_34 ()
    .判断循环首 (等于 (., 假))
        赋值 (行号, 相加 (行号, 1))
        “id”.未知支持库函数_26 (读入文本变量)
        读入文本变量.未知支持库函数_38 ()
        “name”.未知支持库函数_26 (读入文本变量)
        行号.未知支持库函数_9 (1, #., 读入文本变量)
        行号.未知支持库函数_9 (2, #., “ 0”)
        行号.未知支持库函数_9 (3, #., “ 0”)
        行号.未知支持库函数_9 (4, #., “ 0”)
        行号.未知支持库函数_9 (5, #., “ 0”)
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果结束
未知支持库函数_16 ()
2.未知支持库函数_30 (#.)
2.未知支持库函数_41 (2)
3.未知支持库函数_30 (#.)
3.未知支持库函数_41 (2)
4.未知支持库函数_30 (#.)
4.未知支持库函数_41 (2)
5.未知支持库函数_30 (#.)
5.未知支持库函数_41 (2)
0.未知支持库函数_16 (0, 行号, 5, “宋体”)
0.未知支持库函数_18 (0, 行号, 5, 12)
0.未知支持库函数_25 (0, 0, 5, #.)
1.未知支持库函数_25 (2, 行号, 5, #.)

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _重新生成空表按钮_被单击, 空白型, , 清除现有数据，根据科目设置重新生成
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入双精度变量, 双精度小数型, , , 
.局部变量 行号, 整数型, , , 

.如果真 (等于 (信息框 (“重新新成将删除原有数据，继续吗？”, 相加 (#询问图标, #确认取消钮), “提示信息”), #确认钮))
    赋值 (行号, 相减 (., 1))
    .判断循环首 (大于 (行号, 0))
        行号.未知支持库函数_36 ()
        赋值 (行号, 相减 (行号, 1))
    .判断循环尾 ()
    赋值 (行号, 0)
    0.未知支持库函数_30 (#.)
    1.未知支持库函数_30 (#.)
    2.未知支持库函数_30 (#.)
    3.未知支持库函数_30 (#.)
    4.未知支持库函数_30 (#.)
    5.未知支持库函数_30 (#.)
    “select * from dk_kms order by id”.未知支持库函数_14 (1)
    未知支持库函数_34 ()
    .判断循环首 (等于 (., 假))
        赋值 (行号, 相加 (行号, 1))
        “id”.未知支持库函数_26 (读入文本变量)
        读入文本变量.未知支持库函数_38 ()
        “name”.未知支持库函数_26 (读入文本变量)
        行号.未知支持库函数_9 (1, #., 读入文本变量)
        行号.未知支持库函数_9 (2, #., “ 0”)
        行号.未知支持库函数_9 (3, #., “ 0”)
        行号.未知支持库函数_9 (4, #., “ 0”)
        行号.未知支持库函数_9 (5, #., “ 0”)
        未知支持库函数_36 ()
    .判断循环尾 ()
    未知支持库函数_16 ()
    2.未知支持库函数_30 (#.)
    2.未知支持库函数_41 (2)
    3.未知支持库函数_30 (#.)
    3.未知支持库函数_41 (2)
    4.未知支持库函数_30 (#.)
    4.未知支持库函数_41 (2)
    5.未知支持库函数_30 (#.)
    5.未知支持库函数_41 (2)
    0.未知支持库函数_16 (0, 行号, 5, “宋体”)
    0.未知支持库函数_18 (0, 行号, 5, 12)
    0.未知支持库函数_25 (0, 0, 5, #.)
    1.未知支持库函数_25 (2, 行号, 5, #.)
.如果真结束


.子程序 _科目余额表移植窗口_将被销毁, 空白型, , 窗口将被关闭时保存数据
.局部变量 记录数量, 整数型, , , 
.局部变量 行号, 整数型, , , 

“delete from dk_kmyeyzhs”.未知支持库函数_4 ()
赋值 (记录数量, 相减 (., 1))
赋值 (行号, 1)
.判断循环首 (小于或等于 (行号, 记录数量))
    相加 (“insert into dk_kmyeyzhs(dh,name,ncye,jffshe,dffshe) values('”, 删首尾空 (行号.未知支持库函数_10 (0)), “','”, 删首尾空 (行号.未知支持库函数_10 (1)), “',0”, 删首尾空 (行号.未知支持库函数_10 (2)), “,0”, 删首尾空 (行号.未知支持库函数_10 (3)), “,0”, 删首尾空 (行号.未知支持库函数_10 (4)), “)”).未知支持库函数_4 ()
    赋值 (行号, 相加 (行号, 1))
.判断循环尾 ()
“update dk_kmyeyzhs set ye=ncye+jffshe-dffshe”.未知支持库函数_4 ()
未知支持库函数_3 ()

.子程序 _打印按钮_被单击, 空白型, , 打印数据
.局部变量 记录数量, 整数型, , , 
.局部变量 行号, 整数型, , , 

.如果 (等于 (相加 (取运行目录 (), “\report\移植贷款科目余额.grd”).从文件读 (), 假)) ' 载入打印模板
    信息框 (“不能读入打印模板！”, 相加 (#错误图标, #确认钮), “提示信息”)
.否则
     ' 写入数据
    赋值 (记录数量, 相减 (., 1))
    赋值 (行号, 1)
    .判断循环首 (小于或等于 (行号, 记录数量))
        .添加行 ()
        相加 (行号, 3).置文本 (1, 行号.未知支持库函数_10 (0))
        相加 (行号, 3).置文本 (2, 行号.未知支持库函数_10 (1))
        相加 (行号, 3).置文本 (3, 行号.未知支持库函数_10 (2))
        赋值 (行号, 相加 (行号, 1))
    .判断循环尾 ()
    2.置行高 (相减 (取行数 (), 1), 80)
    4.加线条 (1, 相减 (取行数 (), 3), 3, 相加 (#上边框, #下边框, #左边框, #右边框, #水平线, #垂直线))
    4.置对齐方式 (1, 相减 (取行数 (), 3), 2, #中左)
    4.置对齐方式 (3, 相减 (取行数 (), 3), , #中右)
    2.置文本 (1, 相加 (“单位：”, 信用社名称))
    真.打印 (“科目余额表”)
.如果结束


.子程序 _表格1_光标位置改变, 空白型, , 
修改期末余额 ()

.子程序 修改期末余额, 空白型, , 根据期数和借、贷方发生额记录期末余额
.局部变量 光标行号, 整数型, , , 

赋值 (光标行号, 未知支持库函数_3 ())
.如果真 (不等于 (光标行号, -1))
    5.未知支持库函数_30 (#.)
    光标行号.未知支持库函数_9 (5, #., 到文本 (相减 (相加 (到数值 (光标行号.未知支持库函数_10 (2)), 到数值 (光标行号.未知支持库函数_10 (3))), 到数值 (光标行号.未知支持库函数_10 (4)))))
    5.未知支持库函数_30 (#.)
    5.未知支持库函数_41 (2)
.如果真结束


.子程序 _表格1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    修改期末余额 ()
.如果真结束


.窗口程序集 数据移植完毕处理窗口程序集, , , 数据移植完毕处理

.子程序 _退出按钮1_被单击, 空白型, , 
销毁 ()

.子程序 _下一步按钮1_被单击, 空白型, , 进入科目余额打平窗口
.局部变量 平衡与否, 逻辑型, , , 
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入双精度变量1, 双精度小数型, , , 
.局部变量 读入双精度变量2, 双精度小数型, , , 
.局部变量 行号, 整数型, , , 

赋值 (.现行子夹, 1)
 ' 显示数据
0.未知支持库函数_32 (60)
1.未知支持库函数_32 (160)
2.未知支持库函数_32 (140)
3.未知支持库函数_32 (140)
0.未知支持库函数_9 (0, #., “科目代号”)
0.未知支持库函数_9 (1, #., “科目名称”)
0.未知支持库函数_9 (2, #., “科目余额表”)
0.未知支持库函数_9 (3, #., “贷款明细表”)
0.未知支持库函数_30 (#.)
1.未知支持库函数_30 (#.)
2.未知支持库函数_30 (#.)
3.未知支持库函数_30 (#.)
处理事件 ()
“select * from dk_kmyeyzhs order by dh”.未知支持库函数_14 (1)
.如果真 (小于 (., 1))
    赋值 (.标题, “请移植科目余额表！”)
    赋值 (.禁止, 真)
    返回 ()
.如果真结束
未知支持库函数_34 ()
赋值 (平衡与否, 真)
赋值 (行号, 1)
.判断循环首 (等于 (., 假))
    “dh”.未知支持库函数_26 (读入文本变量)
    相加 (“select sum(jkye) as ye from dk_base where km='”, 读入文本变量, “'”).未知支持库函数_14 (1)
    “ye”.未知支持库函数_27 (读入双精度变量1)
    “ye”.未知支持库函数_27 (读入双精度变量2)
    未知支持库函数_16 ()
    读入文本变量.未知支持库函数_38 ()
    “name”.未知支持库函数_26 (读入文本变量)
    行号.未知支持库函数_9 (1, #., 读入文本变量)
    行号.未知支持库函数_9 (2, #., 到文本 (读入双精度变量1))
    行号.未知支持库函数_9 (3, #., 到文本 (读入双精度变量2))
    .如果真 (不等于 (读入双精度变量1, 读入双精度变量2))
        赋值 (平衡与否, 假)
    .如果真结束
    未知支持库函数_36 ()
    赋值 (行号, 相加 (行号, 1))
.判断循环尾 ()
未知支持库函数_16 ()
.如果 (平衡与否) ' 数据已打平
    赋值 (.标题, “科目余额表――贷款明细数据打平：数据已打平，可以进行下一步！”)
.否则
     ' 数据不平，禁止继续进行处理
    赋值 (.标题, “科目余额表――贷款明细数据打平：数据不平，请检查！”)
    赋值 (.禁止, 真)
.如果结束


.子程序 _退出按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _退出按钮4_被单击, 空白型, , 
销毁 ()

.子程序 _下一步按钮2_被单击, 空白型, , 显示输入移植完毕日期窗口
赋值 (.现行子夹, 2)
获取焦点 ()

.子程序 _数据移植完毕处理窗口_创建完毕, 空白型, , 初始化
赋值 (数据移植完毕处理窗口., 相减 (相加 (数据移植完毕处理窗口., 318), 数据移植完毕处理窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
.未知支持库函数_12 ()

.子程序 _数据移植完毕处理窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()

.子程序 _退出按钮3_被单击, 空白型, , 
销毁 ()

.子程序 _日期编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _移植完毕处理按钮_被单击, 空白型, , 进行移植完毕处理
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入日期变量, 日期时间型, , , 
.局部变量 移植错误, 逻辑型, , , 
.局部变量 逾期天数, 整数型, , , 
.局部变量 移植日期, 日期时间型, , , 
.局部变量 读入期初数, 双精度小数型, , , 
.局部变量 读入借方发生额, 双精度小数型, , , 
.局部变量 读入贷方发生额, 双精度小数型, , , 
.局部变量 读入期末余额, 双精度小数型, , , 
.局部变量 年份, 文本型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请输入移植完毕日期！”, 相加 (#信息图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (.现行子夹, 3)
赋值 (.标题, “正在进行明细数据移植……”)
赋值 (移植错误, 假)
处理事件 ()
赋值 (移植日期, 到时间 (.内容))
“delete from dk_kmyes”.未知支持库函数_4 ()
“delete from dk_rkmyes”.未知支持库函数_4 ()
 ' 处理贷款明细数据
“dk_base”.未知支持库函数_14 (2)
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “jkr”.未知支持库函数_31 (读入日期变量)
        “lsh”.未知支持库函数_26 (读入文本变量)
        赋值 (.标题, 相加 (“正在进行明细数据移植：”, 读入文本变量))
        .如果真 (小于 (取时间间隔 (移植日期, 读入日期变量, #日), 0))
            相加 (“贷款明细账：(流水号：”, 读入文本变量, “)借款日不能大于移植完毕日期”, #换行符).加入文本 ()
            赋值 (移植错误, 真)
        .如果真结束
        处理事件 ()
        “dqr”.未知支持库函数_31 (读入日期变量)
        赋值 (逾期天数, 取时间间隔 (移植日期, 读入日期变量, #日))
        “yqtsh”.未知支持库函数_23 (逾期天数)
        “rzhrq”.未知支持库函数_25 (移植日期)
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()
.如果 (等于 (移植错误, 假)) ' 明细数据无误，继续进行处理
    赋值 (.标题, “正在进行科目余额表移植……”)
    处理事件 ()
     ' 移植科目余额表
    “select * from dk_kmyeyzhs order by dh”.未知支持库函数_14 (1)
    赋值 (年份, 删首尾空 (到文本 (取年份 (移植日期))))
    未知支持库函数_34 ()
    .判断循环首 (等于 (., 假))
        “dh”.未知支持库函数_26 (读入文本变量)
        “ncye”.未知支持库函数_27 (读入期初数)
        “jffshe”.未知支持库函数_27 (读入借方发生额)
        “dffshe”.未知支持库函数_27 (读入贷方发生额)
        “ye”.未知支持库函数_27 (读入期末余额)
        赋值 (.标题, 相加 (“科目余额表移植：”, 读入文本变量))
        .如果真 (等于 (相加 (“insert into dk_kmyes(rq,dh,ncye,jffshe,dffshe,ye) values(”, 年份, “,'”, 读入文本变量, “',0”, 删首尾空 (到文本 (读入期初数)), “,0”, 删首尾空 (到文本 (读入借方发生额)), “,0”, 删首尾空 (到文本 (读入贷方发生额)), “,0”, 删首尾空 (到文本 (读入期末余额)), “)”).未知支持库函数_4 (), 假)) ' 移植年余额表
            相加 (“科目余额表移植：（科目：”, 读入文本变量, “）更新记录时失败”, #换行符).加入文本 ()
            赋值 (移植错误, 真)
        .如果真结束
        .如果真 (等于 (相加 (“insert into dk_rkmyes(rq,dh,qcye,jffshe,dffshe,ye) values(#”, 处理日期 (时间到文本 (移植日期, #日期部分)), “#,'”, 读入文本变量, “',0”, 删首尾空 (到文本 (读入期初数)), “,0”, 删首尾空 (到文本 (读入借方发生额)), “,0”, 删首尾空 (到文本 (读入贷方发生额)), “,0”, 删首尾空 (到文本 (读入期末余额)), “)”).未知支持库函数_4 (), 假)) ' 移植日余额表
            相加 (“科目余额表移植：（科目：”, 读入文本变量, “）更新记录时失败”, #换行符).加入文本 ()
            赋值 (移植错误, 真)
        .如果真结束
        处理事件 ()
        未知支持库函数_36 ()
    .判断循环尾 ()
    未知支持库函数_16 ()
     ' 更新总控时间
    .如果真 (等于 (移植错误, 假))
        .如果真 (等于 (相加 (“update dk_system set zksj=#”, 处理日期 (时间到文本 (移植日期, #日期部分)), “#,sfyzhwb='1',zht='日终'”).未知支持库函数_4 (), 假))
            相加 (“更新总控时间失败！”, #换行符).加入文本 ()
            赋值 (移植错误, 真)
        .如果真结束
        赋值 (总控时间, 移植日期)
        赋值 (系统状态, “日终”)
        赋值 (是否已移植完毕, “1”)
    .如果真结束
    .如果 (等于 (移植错误, 假))
        赋值 (.标题, “移植完毕，您可以正常办业务了！”)
        信息框 (“移植完毕，您可以正常办业务了，系统将自动关闭，请重新登录系统。”, 相加 (#信息图标, #确认钮), “提示信息”)
        结束 ()
    .否则
        信息框 (“数据移植错误，请检查！”, 相加 (#错误图标, #确认钮), “提示信息”)
        赋值 (.标题, “数据移植错误，请检查！”)
    .如果结束
    
.否则
    信息框 (“数据移植错误，请检查！”, 相加 (#错误图标, #确认钮), “提示信息”)
    赋值 (.标题, “数据移植错误，请检查！”)
.如果结束
赋值 (.禁止, 真)

.窗口程序集 领用凭证窗口程序集, , , 领用凭证

.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()

.子程序 _领用按钮_被单击, 空白型, , 信用凭证
.局部变量 凭证号码, 长整数型, , , 
.局部变量 凭证号码2, 长整数型, , , 
.局部变量 凭证号码数组, 文本型, , "0", 
.局部变量 长度, 整数型, , , 
.局部变量 文本号码, 文本型, , , 
.局部变量 临时变量, 整数型, , , 
.局部变量 领用数量, 整数型, , , 
.局部变量 领用时间, 文本型, , , 

.如果真 (或者 (等于 (删首尾空 (.内容), “”), 等于 (删首尾空 (.内容), “”))) ' 凭证起止编号皆不能为空
    信息框 (“请输入领凭证编号”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (.标题, “正在检查凭证的可用性……”)
处理事件 ()
.如果真 (大于 (到数值 (.内容), 到数值 (.内容)))
    信息框 (“领用凭证范围输入不正确！”, 相加 (#错误图标, #确认钮), “提示信息”)
    赋值 (.标题, “请输入要领用凭证的号码范围”)
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (凭证号码2, 到数值 (.内容))
赋值 (凭证号码, 到数值 (.内容))
.判断循环首 (小于或等于 (凭证号码, 凭证号码2))
    赋值 (文本号码, 删首尾空 (到文本 (凭证号码)))
    赋值 (长度, 取文本长度 (文本号码))
    .判断循环首 (小于 (长度, 凭证编号位数))
        赋值 (文本号码, 相加 (“0”, 文本号码))
        赋值 (长度, 相加 (长度, 1))
    .判断循环尾 ()
    相加 (“select bh from dk_jjbhb where bh='”, 文本号码, “'”).未知支持库函数_14 (1)
    .如果真 (大于 (., 0)) ' 此编辑凭证已邻用，不能重复
        赋值 (.标题, 相加 (“凭证(借据)编号”, 文本号码, “已存在！”))
        信息框 (相加 (“凭证(借据)编号”, 文本号码, “已存在！”), 相加 (#错误图标, #确认钮), “提示信息”)
        未知支持库函数_16 ()
        返回 ()
    .如果真结束
    未知支持库函数_16 ()
    加入成员 (凭证号码数组, 文本号码)
    赋值 (凭证号码, 相加 (凭证号码, 1))
.判断循环尾 ()
 ' 开始领用凭证
赋值 (领用数量, 取数组成员数 (凭证号码数组))
赋值 (临时变量, 1)
赋值 (领用时间, 处理日期 (删首尾空 (时间到文本 (总控时间, #日期部分))))
.判断循环首 (小于或等于 (临时变量, 领用数量))
    相加 (“insert into dk_jjbhb(bh,lyrq,lyry,jlzht) values('”, 凭证号码数组 [临时变量], “',#”, 领用时间, “#,'”, 登录用户代号, “','0')”).未知支持库函数_4 ()
    赋值 (临时变量, 相加 (临时变量, 1))
.判断循环尾 ()
信息框 (“凭证领用完毕！”, 相加 (#信息图标, #确认钮), “提示信息”)
销毁 ()

.子程序 _领用凭证窗口_创建完毕, 空白型, , 初始化
赋值 (领用凭证窗口., 相减 (相加 (领用凭证窗口., 104), 领用凭证窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
获取焦点 ()

.子程序 _编辑框1_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _编辑框2_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _领用凭证窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()

.子程序 _领用按钮_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _领用按钮_被单击 ()
.如果真结束


.子程序 _编辑框1_失去焦点, 空白型, , 
.局部变量 凭证长度, 整数型, , , 

赋值 (.内容, 删首尾空 (.内容))
赋值 (凭证长度, 取文本长度 (.内容))
.判断循环首 (小于 (凭证长度, 凭证编号位数))
    赋值 (.内容, 相加 (“0”, .内容))
    赋值 (凭证长度, 相加 (凭证长度, 1))
.判断循环尾 ()

.子程序 _编辑框2_失去焦点, 空白型, , 
.局部变量 凭证长度, 整数型, , , 

赋值 (.内容, 删首尾空 (.内容))
赋值 (凭证长度, 取文本长度 (.内容))
.判断循环首 (小于 (凭证长度, 凭证编号位数))
    赋值 (.内容, 相加 (“0”, .内容))
    赋值 (凭证长度, 相加 (凭证长度, 1))
.判断循环尾 ()

.窗口程序集 作废凭证窗口程序集, , , 作废凭证

.子程序 _作废凭证窗口_创建完毕, 空白型, , 
赋值 (作废凭证窗口., 相减 (相加 (作废凭证窗口., 73), 作废凭证窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
获取焦点 ()

.子程序 _作废凭证窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()

.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()

.子程序 _作废按钮_被单击, 空白型, , 作废凭证
.局部变量 读入文本变量, 文本型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请输入要作废的凭证编号！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
相加 (“select * from dk_jjbhb where bh='”, .内容, “'”).未知支持库函数_14 (1)
.如果 (大于 (., 0)) ' 领用库中有此编号
    未知支持库函数_34 ()
    “jlzht”.未知支持库函数_26 (读入文本变量)
    .判断开始 (等于 (读入文本变量, “0”)) ' 凭证未使用
        .如果真 (等于 (信息框 (相加 (“真的作废编号为”, .内容, “的凭证吗？”), 相加 (#询问图标, #确认取消钮), “提示信息”), #确认钮))
            未知支持库函数_16 ()
            .如果 (相加 (“update dk_jjbhb set jlzht='2',syrq=#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “#,syry='”, 登录用户代号, “' where bh='”, .内容, “'”).未知支持库函数_4 ()) ' 更新数据
                信息框 (相加 (“编号为”, .内容, “的凭证已作废！”), 相加 (#信息图标, #确认钮), “提示信息”)
                未知支持库函数_16 ()
                销毁 ()
            .否则
                信息框 (“作废凭证时出错！”, 相加 (#错误图标, #确认钮), “提示信息”)
                未知支持库函数_16 ()
                获取焦点 ()
                返回 ()
            .如果结束
            
        .如果真结束
        
    .判断 (等于 (读入文本变量, “1”)) ' 凭证已使用，不能作废
        信息框 (“此凭证已经使用，不能作废！”, 相加 (#错误图标, #确认钮), “提示信息”)
        未知支持库函数_16 ()
        获取焦点 ()
        返回 ()
    .默认
         ' 作主已作作废处理
        信息框 (“此凭证已经作废！”, 相加 (#错误图标, #确认钮), “提示信息”)
        未知支持库函数_16 ()
        获取焦点 ()
        返回 ()
    .判断结束
    
.否则
    信息框 (“无此凭证编号！”, 相加 (#错误图标, #确认钮), “提示信息”)
    未知支持库函数_16 ()
    获取焦点 ()
.如果结束


.子程序 _凭证编号编辑框_失去焦点, 空白型, , 对凭证编号进行预处理
.局部变量 长度, 整数型, , , 

赋值 (.内容, 删首尾空 (.内容))
赋值 (长度, 取文本长度 (.内容))
.如果真 (并且 (小于 (长度, 7), 大于 (长度, 0)))
    .判断循环首 (小于 (长度, 凭证编号位数))
        赋值 (.内容, 相加 (“0”, .内容))
        赋值 (长度, 相加 (长度, 1))
    .判断循环尾 ()
.如果真结束


.子程序 _凭证编号编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _作废按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _作废按钮_被单击 ()
.如果真结束


.窗口程序集 贷款发放录入窗口程序集, , , 

.程序集变量 借款人简码, 文本型, , , 记录借款人简码
.程序集变量 借款天数, 整数型, , , 记录借款天数
.程序集变量 借款人性质, 文本型, , , 记录借款人性质
.程序集变量 地域性质, 文本型, , , 记录借款人所属村组地域性质
.程序集变量 借款人编号, 整数型, , , 记录借款人编号
.程序集变量 借款人所属村组, 文本型, , , 记录借款人所属村组
.程序集变量 科目形态数组, 文本型, , "0", 记录科目形态的数组
.程序集变量 借款人编号数组, 整数型, , "0", 记录借款人编号的数组
.程序集变量 地域性质数组, 文本型, , "0", 记录借款人所属地域性质的数组
.程序集变量 借款人简码数组, 文本型, , "0", 记录借款人简码的数组
.程序集变量 授信额度, 整数型, , , 信用户借款人的授信额度
.程序集变量 是否已输入科目代号, 逻辑型, , , 记录是否已输入科目代号
.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _科目组合框_失去焦点, 空白型, , 判断是否正确输入科目名称
.局部变量 科目代号, 文本型, , , 

.如果 (等于 (.内容, “”))
    赋值 (是否已输入科目代号, 假)
.否则
    赋值 (科目代号, .内容)
    赋值 (.现行选中项, 相减 (取项目数 (), 1))
    .判断循环首 (大于或等于 (.现行选中项, 0))
        .如果真 (等于 (科目代号, .内容))
            跳出循环 ()
        .如果真结束
        赋值 (.现行选中项, 相减 (.现行选中项, 1))
    .判断循环尾 ()
    .如果 (不等于 (.现行选中项, -1))
        获取焦点 ()
        赋值 (是否已输入科目代号, 真)
    .否则
        信息框 (“无此科目!”, 相加 (#信息图标, #确认钮), “提示信息”)
        赋值 (是否已输入科目代号, 假)
    .如果结束
    
.如果结束


.子程序 _科目组合框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _流水号编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _录入按钮_被单击 ()
    
.如果真结束


.子程序 _借款人编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _原贷金额编辑框_失去焦点, 空白型, , 判断金额是否录入正确
.如果真 (小于或等于 (到数值 (.内容), 0))
    赋值 (.内容, “0”)
.如果真结束


.子程序 _原贷金额编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _借款日编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _到期日编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _期限类型组合框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _利率编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _贷款方式组合框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _借款用途编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _取消按钮_被单击, 空白型, , 取消当前输入
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.可视, 假)
赋值 (.内容, “”)
赋值 (授信额度, -1)

.子程序 _确定按钮_被单击, 空白型, , 选择借款人
.如果真 (不等于 (., -1))
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.可视, 假)
    赋值 (.内容, .取标题 (., 0))
    赋值 (借款人简码, 借款人简码数组 [相加 (., 1)])
    赋值 (借款人性质, .取标题 (., 2))
    赋值 (借款人所属村组, .取标题 (., 1))
    赋值 (地域性质, 地域性质数组 [相加 (., 1)])
    赋值 (借款人编号, 借款人编号数组 [相加 (., 1)])
    相加 (“select shxed from dk_xyhxx where id=”, 删首尾空 (到文本 (借款人编号))).未知支持库函数_14 (1)
    .如果 (未知支持库函数_34 ()) ' 是信用户，读入授信额度
        “shxed”.未知支持库函数_29 (授信额度)
    .否则
        赋值 (授信额度, -1) ' 不是信用户，将授信额度置为-1
    .如果结束
    未知支持库函数_16 ()
    获取焦点 ()
.如果真结束


.子程序 _利率编辑框_失去焦点, 空白型, , 判断利率输入是否正确
.如果真 (小于 (到数值 (.内容), 0))
    赋值 (.内容, “0”)
.如果真结束


.子程序 _存盘按钮_被单击, 空白型, , 保存记录
.局部变量 临时变量, 整数型, , , 
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入双精度变量, 双精度小数型, , , 

 ' 判断输入内容是否符合要求
.如果真 (或者 (等于 (.内容, “”), 等于 (删首尾空 (到文本 (借款人编号)), “”)))
    信息框 (“请正确输入借款人名称！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (小于或等于 (到数值 (.内容), 0))
    信息框 (“原贷金额必须大于零！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入借款日！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (小于 (到时间 (.内容), 到时间 (.内容)))
    信息框 (“到期日不能小于借款日！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.现行选中项, -1))
    信息框 (“请选择期限类型！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.现行选中项, -1))
    信息框 (“请选择贷款方式！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (小于 (到数值 (.内容), 0))
    信息框 (“利率不能小于零！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入借款编号！”, 相加 (#错误图标, #确认钮), “提示信息”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (不等于 (授信额度, -1)) ' 信用户贷款
    相加 (“select sum(jkye) as ye from dk_base where jkrbh=”, 删首尾空 (到文本 (借款人编号))).未知支持库函数_14 (1)
    未知支持库函数_34 ()
    “ye”.未知支持库函数_27 (读入双精度变量)
    未知支持库函数_16 ()
    .如果真 (大于 (相减 (相加 (读入双精度变量, 到数值 (相加 (“0”, .内容))), 授信额度), 0.0001))
        .如果真 (等于 (信息框 (“此借款人为信用户，发放此笔贷款后其贷款余额将超过授信额度，继续发放操作吗？”, 相加 (#询问图标, #确认取消钮, #默认按钮二), “提示信息”), #取消钮))
            返回 ()
        .如果真结束
        
    .如果真结束
    
.如果真结束
 ' 判断借据编辑是否输入正确
相加 (“select bh,jlzht from dk_jjbhb where bh='”, 删首尾空 (.内容), “'”).未知支持库函数_14 (1)
.如果 (大于 (., 0))
    “jlzht”.未知支持库函数_26 (读入文本变量)
    .如果真 (不等于 (读入文本变量, “0”))
        信息框 (相加 (“编号为 ”, .内容, “ 的凭证已使用或作废！”), 相加 (#错误图标, #确认钮), “提示信息”)
        获取焦点 ()
        未知支持库函数_16 ()
        返回 ()
    .如果真结束
    
.否则
    信息框 (相加 (“您并未领用编号为 ”, .内容, “ 的凭证！”), 相加 (#错误图标, #确认钮), “提示信息”)
    未知支持库函数_16 ()
    获取焦点 ()
    返回 ()
.如果结束
未知支持库函数_16 ()
.如果真 (或者 (等于 (.现行选中项, -1), 等于 (.现行选中项, -1)))
    信息框 (“请输入审批人与经办人信息！”, 相加 (#错误图标, #确认钮), “提示信息”)
    未知支持库函数_16 ()
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.现行选中项, .现行选中项))
    信息框 (“审批人与经办人不有相同！”, 相加 (#错误图标, #确认钮), “提示信息”)
    未知支持库函数_16 ()
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (借款天数, 取时间间隔 (到时间 (.内容), 到时间 (.内容), #日))
.如果 (相加 (“insert into dk_base(lsh,name,jm,ydje,jkye,jkr,dqr,jkxts,jkyt,dkzhl,ghbj,lxje,hxqk,sbzht,bzh,zhqtsh,qx,jktsh,jlzht,cz,km,rzhrq,ll,yqtsh,xzh,jkrbh,jbr,spr,jkxtw,jjbh) values('”, .内容, “','”, .内容, “','”, 借款人简码, “',0”, .内容, “,0”, .内容, “,#”, 处理日期 (.内容), “#,#”, 处理日期 (.内容), “#,'”, 科目形态数组 [相加 (.现行选中项, 1)], “','”, .内容, “','”, .内容, “',0,0,#”, 处理日期 (.内容), “#,'0','”, .内容, “',0,'”, .内容, “',”, 删首尾空 (到文本 (借款天数)), “,'1','”, 借款人所属村组, “','”, .内容, “',#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “#,0”, .内容, “,”, 删首尾空 (到文本 (取时间间隔 (总控时间, 到时间 (.内容), #日))), “,'”, 借款人性质, “',”, 删首尾空 (到文本 (借款人编号)), “,'”, .内容, “','”, .内容, “','正常','”, .内容, “')”).未知支持库函数_4 ()) ' 添加记录
    相加 (“update dk_jjbhb set jlzht='1',syrq=#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “#,syry='”, 登录用户代号, “' where bh='”, .内容, “'”).未知支持库函数_4 () ' 修改借据领用/使用库
    相加 (“update dk_rkmyes set jffshe=jffshe+”, 删首尾空 (.内容), “ where rq=#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “# and dh='”, 删首尾空 (.内容), “'”).未知支持库函数_4 ()
    相加 (“update dk_kmyes set jffshe=jffshe+”, 删首尾空 (.内容), “ where rq=”, 删首尾空 (到文本 (取年份 (总控时间))), “ and dh='”, 删首尾空 (.内容), “'”).未知支持库函数_4 ()
    信息框 (“存盘成功！”, 相加 (#信息图标, #确认钮), “提示信息”)
    赋值 (.禁止, 假)
    赋值 (授信额度, -1)
    赋值 (.可视, 假)
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    赋值 (.内容, “”)
    获取焦点 ()
.否则
    信息框 (“存盘失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
.如果结束


.子程序 _借款人列表框_被双击, 逻辑型, , 选择借款人
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_确定按钮_被单击 ()

.子程序 _确定按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _确定按钮_被单击 ()
.如果真结束


.子程序 _利率编辑框_获得焦点, 空白型, , 利率编辑框为空时根据历史利率主动录入
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入整数变量, 整数型, , , 
.局部变量 读入双精度变量, 双精度小数型, , , 
.局部变量 读入日期变量, 日期时间型, , , 

.如果真 (等于 (.内容, “”))
    赋值 (借款天数, 取时间间隔 (到时间 (.内容), 到时间 (.内容), #日)) ' 记录借款期限（天数）
    “select * from dk_llmb order by tsh asc”.未知支持库函数_14 (1)
    未知支持库函数_34 ()
    .判断循环首 (等于 (., 假))
        “tsh”.未知支持库函数_29 (读入整数变量)
        .如果真 (大于或等于 (借款天数, 读入整数变量))
            “xm”.未知支持库函数_26 (读入文本变量)
        .如果真结束
        未知支持库函数_36 ()
    .判断循环尾 ()
    未知支持库函数_16 ()
    相加 (“select * from dk_llk where xm='”, 读入文本变量, “' order by rq asc”).未知支持库函数_14 (1)
    .如果真 (未知支持库函数_34 ())
        .如果 (等于 (借款人性质, “3”))
            “qdll”.未知支持库函数_27 (读入双精度变量)
        .否则
            “ndll”.未知支持库函数_27 (读入双精度变量)
        .如果结束
        未知支持库函数_36 ()
        .判断循环首 (等于 (., 假))
            “rq”.未知支持库函数_31 (读入日期变量)
            .如果真 (大于 (取日期 (到时间 (.内容)), 取日期 (读入日期变量)))
                .如果 (等于 (借款人性质, “3”))
                    “qdll”.未知支持库函数_27 (读入双精度变量) ' 企业贷款
                .否则
                    “ndll”.未知支持库函数_27 (读入双精度变量) ' 农业贷款及自然人贷款
                .如果结束
                
            .如果真结束
            
        .判断循环尾 ()
    .如果真结束
    未知支持库函数_16 ()
    赋值 (.内容, 删首尾空 (到文本 (读入双精度变量)))
.如果真结束


.子程序 _贷款发放录入窗口_创建完毕, 空白型, , 初始化
.局部变量 读入文本变量, 文本型, , , 

赋值 (贷款发放录入窗口., 相减 (相加 (贷款发放录入窗口., 328), 贷款发放录入窗口.取用户区高度 ()))
赋值 (是否已输入科目代号, 假)
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
 ' 载入科目信息
“select * from dk_kms where type='正常' order by id”.未知支持库函数_14 (1)
清空 ()
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “id”.未知支持库函数_26 (读入文本变量)
        读入文本变量.加入项目 ()
        “type”.未知支持库函数_26 (读入文本变量)
        加入成员 (科目形态数组, 读入文本变量)
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()
 ' 载入信贷人员信息
“select * from dk_xdy”.未知支持库函数_14 (1)
清空 ()
清空 ()
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “name”.未知支持库函数_26 (读入文本变量)
        读入文本变量.加入项目 ()
        读入文本变量.加入项目 ()
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()
赋值 (授信额度, -1)

.子程序 _贷款发放录入窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()

.子程序 _审批人组合框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _经办人组合框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _借款日编辑框_失去焦点, 空白型, , 判断借款日输入是否符合要求
.如果 (不等于 (.内容, “”))
    .如果真 (大于 (到时间 (.内容), 总控时间))
        信息框 (“借款日期不能大于总控时间！”, 相加 (#错误图标, #确认钮), “提示信息”)
        赋值 (.内容, 时间到文本 (总控时间, #日期部分))
    .如果真结束
    
.否则
    赋值 (.内容, 时间到文本 (总控时间, #日期部分))
.如果结束


.子程序 _到期日编辑框_失去焦点, 空白型, , 判断到期日输入是否符合要求
.如果 (等于 (.内容, “”))
    赋值 (.内容, 时间到文本 (增减时间 (到时间 (处理日期 (.内容)), #年份, 1), #日期部分))
.否则
    .如果 (小于 (到时间 (.内容), 到时间 (.内容)))
        信息框 (“到期日不能小于借款日！”, 相加 (#错误图标, #确认钮), “提示信息”)
    .否则
        .如果 (大于 (取时间间隔 (到时间 (.内容), 到时间 (.内容), #日), 366))
            .如果 (大于 (取时间间隔 (到时间 (.内容), 到时间 (.内容), #日), 1827))
                赋值 (.现行选中项, 2)
            .否则
                赋值 (.现行选中项, 1)
            .如果结束
            
        .否则
            赋值 (.现行选中项, 0)
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 _借据编号编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _借据编号编辑框_失去焦点, 空白型, , 删除空格
赋值 (.内容, 删首尾空 (.内容))

.子程序 _借款人编辑框_失去焦点, 空白型, , 
.局部变量 临时变量, 整数型, , , 
.局部变量 有无汉字, 逻辑型, , , 
.局部变量 文本长度, 整数型, , , 
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入数值变量, 整数型, , , 
.局部变量 当前表项, 整数型, , , 

赋值 (.内容, 删首尾空 (.内容))
.如果 (等于 (.内容, “”))
    赋值 (借款人编号, 0)
.否则
    赋值 (文本长度, 取文本长度 (.内容))
    赋值 (临时变量, 1)
    赋值 (有无汉字, 假)
    .判断循环首 (小于或等于 (临时变量, 文本长度))
        .如果真 (小于 (取代码 (.内容, 临时变量), 0))
            赋值 (有无汉字, 真)
            跳出循环 ()
        .如果真结束
        赋值 (临时变量, 相加 (临时变量, 1))
    .判断循环尾 ()
    .如果 (等于 (有无汉字, 真)) ' 有汉字以借款人字段为查询条件
        相加 (“select id,name,jm,cz,dy,xzh from dk_jkrxx where name like '%”, .内容, “%'”).未知支持库函数_14 (1)
    .否则
        相加 (“select id,name,jm,cz,dy,xzh from dk_jkrxx where jm like '%”, .内容, “%'”).未知支持库函数_14 (1) ' 有汉字则以借款人简码字段为查询条件
    .如果结束
    .如果 (大于 (., 0)) ' 记录数量大于零，显示借款人列表
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
        赋值 (.可视, 真)
        全部删除 ()
        清除数组 (借款人编号数组)
        清除数组 (借款人简码数组)
        清除数组 (地域性质数组)
        未知支持库函数_34 ()
        .判断循环首 (等于 (., 假))
            “name”.未知支持库函数_26 (读入文本变量)
            赋值 (当前表项, -1.插入表项 (读入文本变量, , , , ))
            “cz”.未知支持库函数_26 (读入文本变量)
            当前表项.置标题 (1, 读入文本变量)
            “xzh”.未知支持库函数_26 (读入文本变量)
            当前表项.置标题 (2, 读入文本变量)
            “id”.未知支持库函数_29 (读入数值变量)
            加入成员 (借款人编号数组, 读入数值变量)
            “dy”.未知支持库函数_26 (读入文本变量)
            加入成员 (地域性质数组, 读入文本变量)
            “jm”.未知支持库函数_26 (读入文本变量)
            加入成员 (借款人简码数组, 读入文本变量)
            未知支持库函数_36 ()
        .判断循环尾 ()
        赋值 (., 0)
        获取焦点 ()
    .否则
        信息框 (“无此借款人信息！”, 相加 (#错误图标, #确认钮), “提示信息”)
        赋值 (.内容, “”)
        赋值 (借款人简码, “”)
    .如果结束
    未知支持库函数_16 ()
.如果结束


.子程序 _录入按钮_被单击, 空白型, , 
.如果真 (等于 (是否已输入科目代号, 假))
    信息框 (“请输入科目代号!”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (删首尾空 (.内容), “”))
    信息框 (“请输入流水号!”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
相加 (“select lsh from dk_base where lsh='”, .内容, “'”).未知支持库函数_14 (1)
.如果 (大于 (., 0))
    信息框 (“此流水号已存在!”, 相加 (#信息图标, #确认钮), “提示信息”)
.否则
     ' 初始化录入界面
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.可视, 真)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
    赋值 (.现行选中项, -1)
    赋值 (.现行选中项, -1)
    赋值 (.内容, “”)
    赋值 (.禁止, 真)
    获取焦点 ()
.如果结束
未知支持库函数_16 ()



.窗口程序集 凭证领用及使用情况窗口程序集, , , 查看凭证领用及使用情况

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _凭证领用及使用情况窗口_创建完毕, 空白型, , 创建窗口时载入数据
.局部变量 读入数值变量, 整数型, , , 
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入日期变量, 日期时间型, , , 
.局部变量 插入位置, 整数型, , , 

赋值 (凭证领用及使用情况窗口., 相减 (相加 (凭证领用及使用情况窗口., 272), 凭证领用及使用情况窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
 ' 统计总体情况
“select count(*) as num from dk_jjbhb”.未知支持库函数_14 (1)
“num”.未知支持库函数_29 (读入数值变量)
赋值 (.标题, 删首尾空 (到文本 (读入数值变量)))
未知支持库函数_16 ()
“select count(*) as num from dk_jjbhb where jlzht='0'”.未知支持库函数_14 (1)
“num”.未知支持库函数_29 (读入数值变量)
赋值 (.标题, 删首尾空 (到文本 (读入数值变量)))
赋值 (., 1)
赋值 (., 读入数值变量)
未知支持库函数_16 ()
“select count(*) as num from dk_jjbhb where jlzht='1'”.未知支持库函数_14 (1)
“num”.未知支持库函数_29 (读入数值变量)
赋值 (.标题, 删首尾空 (到文本 (读入数值变量)))
赋值 (., 0)
赋值 (., 读入数值变量)
未知支持库函数_16 ()
“select count(*) as num from dk_jjbhb where jlzht='2'”.未知支持库函数_14 (1)
“num”.未知支持库函数_29 (读入数值变量)
赋值 (.标题, 删首尾空 (到文本 (读入数值变量)))
赋值 (., 2)
赋值 (., 读入数值变量)
未知支持库函数_16 ()
 ' 显示全部领用凭证
“select * from dk_jjbhb order by bh”.未知支持库函数_14 (1)
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “bh”.未知支持库函数_26 (读入文本变量)
        赋值 (插入位置, .插入表项 (读入文本变量, , , , ))
        “lyry”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (2, 读入文本变量)
        “lyrq”.未知支持库函数_31 (读入日期变量)
        插入位置.置标题 (1, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        “jlzht”.未知支持库函数_26 (读入文本变量)
        .判断开始 (等于 (读入文本变量, “0”))
            插入位置.置标题 (3, “未使用”)
        .判断 (等于 (读入文本变量, “1”))
            插入位置.置标题 (3, “已使用”)
        .默认
            插入位置.置标题 (3, “已作废”)
        .判断结束
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()
 ' 显示未使用凭证
“select * from dk_jjbhb where jlzht='0' order by bh”.未知支持库函数_14 (1)
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “bh”.未知支持库函数_26 (读入文本变量)
        赋值 (插入位置, .插入表项 (读入文本变量, , , , ))
        “lyry”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (2, 读入文本变量)
        “lyrq”.未知支持库函数_31 (读入日期变量)
        插入位置.置标题 (1, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()
 ' 显示已使用凭证
“select * from dk_jjbhb where jlzht='1' order by bh”.未知支持库函数_14 (1)
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “bh”.未知支持库函数_26 (读入文本变量)
        赋值 (插入位置, .插入表项 (读入文本变量, , , , ))
        “lyry”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (2, 读入文本变量)
        “lyrq”.未知支持库函数_31 (读入日期变量)
        插入位置.置标题 (1, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        “syry”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (4, 读入文本变量)
        “syrq”.未知支持库函数_31 (读入日期变量)
        插入位置.置标题 (3, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()
 ' 显示已作废凭证
“select * from dk_jjbhb where jlzht='2' order by bh”.未知支持库函数_14 (1)
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “bh”.未知支持库函数_26 (读入文本变量)
        赋值 (插入位置, .插入表项 (读入文本变量, , , , ))
        “lyry”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (2, 读入文本变量)
        “lyrq”.未知支持库函数_31 (读入日期变量)
        插入位置.置标题 (1, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        “syry”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (4, 读入文本变量)
        “syrq”.未知支持库函数_31 (读入日期变量)
        插入位置.置标题 (3, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()

.子程序 _凭证领用及使用情况窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()

.子程序 _打印按钮_被单击, 空白型, , 打印记录
.局部变量 表项总数, 整数型, , , 
.局部变量 临时变量, 整数型, , , 

.判断开始 (或者 (等于 (.现行子夹, 0), 等于 (.现行子夹, 1))) ' 打印全部凭证
    .如果真 (等于 (相加 (取运行目录 (), “\report\凭证领用及使用情况.grd”).从文件读 (), 假))
        信息框 (“导入打印模板失败!”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    赋值 (表项总数, 取表项数 ())
    赋值 (临时变量, 0)
    .判断循环首 (小于 (临时变量, 表项总数))
        .添加行 ()
        相加 (临时变量, 4).置文本 (1, 临时变量.取标题 (0))
        相加 (临时变量, 4).置文本 (2, 临时变量.取标题 (1))
        相加 (临时变量, 4).置文本 (3, 临时变量.取标题 (2))
        相加 (临时变量, 4).置文本 (4, 临时变量.取标题 (3))
        赋值 (临时变量, 相加 (临时变量, 1))
    .判断循环尾 ()
    4.置对齐方式 (1, 表项总数, 4, #中左)
    4.置字体名 (1, 表项总数, 4, “宋体”)
    4.置字体尺寸 (1, 表项总数, 4, 40)
    4.加线条 (1, 表项总数, 4, 相加 (#上边框, #下边框, #左边框, #右边框, #水平线, #垂直线))
    .添加行 ()
    赋值 (临时变量, 相加 (临时变量, 4))
    临时变量.合并 (1, 1, 4)
    临时变量.置文本 (1, 相加 (“共领用凭证”, .标题, “份,已使用”, .标题, “份,已作废”, .标题, “份,结余(未使用)”, .标题, “份”))
    临时变量.置对齐方式 (1, 1, 4, #中左)
    临时变量.置字体名 (1, 1, 4, “宋体”)
    临时变量.置字体尺寸 (1, 1, 4, 40)
    真.打印 (“贷款凭证”)
.判断 (等于 (.现行子夹, 2)) ' 打印已使用凭证
    .如果真 (等于 (相加 (取运行目录 (), “\report\已使用凭证.grd”).从文件读 (), 假))
        信息框 (“导入打印模板失败!”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    赋值 (表项总数, 取表项数 ())
    赋值 (临时变量, 0)
    .判断循环首 (小于 (临时变量, 表项总数))
        .添加行 ()
        相加 (临时变量, 4).置文本 (1, 临时变量.取标题 (0))
        相加 (临时变量, 4).置文本 (2, 临时变量.取标题 (1))
        相加 (临时变量, 4).置文本 (3, 临时变量.取标题 (2))
        相加 (临时变量, 4).置文本 (4, 临时变量.取标题 (3))
        相加 (临时变量, 4).置文本 (5, 临时变量.取标题 (4))
        赋值 (临时变量, 相加 (临时变量, 1))
    .判断循环尾 ()
    4.置对齐方式 (1, 表项总数, 5, #中左)
    4.置字体名 (1, 表项总数, 5, “宋体”)
    4.置字体尺寸 (1, 表项总数, 5, 40)
    4.加线条 (1, 表项总数, 5, 相加 (#上边框, #下边框, #左边框, #右边框, #水平线, #垂直线))
    真.打印 (“贷款凭证”)
.判断 (等于 (.现行子夹, 3)) ' 打印结余(未使用)凭证
    .如果真 (等于 (相加 (取运行目录 (), “\report\结余凭证.grd”).从文件读 (), 假))
        信息框 (“导入打印模板失败!”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    赋值 (表项总数, 取表项数 ())
    赋值 (临时变量, 0)
    .判断循环首 (小于 (临时变量, 表项总数))
        .添加行 ()
        相加 (临时变量, 4).置文本 (1, 临时变量.取标题 (0))
        相加 (临时变量, 4).置文本 (2, 临时变量.取标题 (1))
        相加 (临时变量, 4).置文本 (3, 临时变量.取标题 (2))
        赋值 (临时变量, 相加 (临时变量, 1))
    .判断循环尾 ()
    4.置对齐方式 (1, 表项总数, 3, #中左)
    4.置字体名 (1, 表项总数, 3, “宋体”)
    4.置字体尺寸 (1, 表项总数, 3, 40)
    4.加线条 (1, 表项总数, 3, 相加 (#上边框, #下边框, #左边框, #右边框, #水平线, #垂直线))
    真.打印 (“贷款凭证”)
.默认
     ' 打印已作废凭证
    .如果真 (等于 (相加 (取运行目录 (), “\report\已作废凭证.grd”).从文件读 (), 假))
        信息框 (“导入打印模板失败!”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    赋值 (表项总数, 取表项数 ())
    赋值 (临时变量, 0)
    .判断循环首 (小于 (临时变量, 表项总数))
        .添加行 ()
        相加 (临时变量, 4).置文本 (1, 临时变量.取标题 (0))
        相加 (临时变量, 4).置文本 (2, 临时变量.取标题 (1))
        相加 (临时变量, 4).置文本 (3, 临时变量.取标题 (2))
        相加 (临时变量, 4).置文本 (4, 临时变量.取标题 (3))
        相加 (临时变量, 4).置文本 (5, 临时变量.取标题 (4))
        赋值 (临时变量, 相加 (临时变量, 1))
    .判断循环尾 ()
    4.置对齐方式 (1, 表项总数, 5, #中左)
    4.置字体名 (1, 表项总数, 5, “宋体”)
    4.置字体尺寸 (1, 表项总数, 5, 40)
    4.加线条 (1, 表项总数, 5, 相加 (#上边框, #下边框, #左边框, #右边框, #水平线, #垂直线))
    真.打印 (“贷款凭证”)
.判断结束


.窗口程序集 贷款收回录入窗口程序集, , , 收回贷款录入

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _贷款收回录入窗口_创建完毕, 空白型, , 初始化
赋值 (贷款收回录入窗口., 相减 (相加 (贷款收回录入窗口., 285), 贷款收回录入窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()

.子程序 _流水号编辑框_按下某键, 逻辑型, , 回车键显示记录
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _归还查找按钮_被单击 ()
.如果真结束


.子程序 _贷款收回录入窗口_被显示, 空白型, , 
获取焦点 ()

.子程序 _利息结至编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _归还本金编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _归还利息编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _存盘按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _存盘按钮_被单击 ()
.如果真结束


.子程序 _存盘按钮_被单击, 空白型, , 保存记录
 ' 判断输入内容是否正确
.如果真 (或者 (大于 (到数值 (相加 (“0”, .内容)), 到数值 (.内容)), 小于 (到数值 (相加 (“0”, .内容)), 0)))
    信息框 (“归还本金数额不能大于原贷款余额或小于零！”, 相加 (#错误图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果真 (小于 (到数值 (相加 (“0”, .内容)), 0))
    信息框 (“归还利息不能小于零！”, 相加 (#错误图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果真 (并且 (等于 (到数值 (相加 (“0”, .内容)), 0), 等于 (到数值 (相加 (“0”, .内容)), 0)))
    信息框 (“归还本金和归还利息不能同时为零！”, 相加 (#错误图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“利息结至日不能为空！”, 相加 (#错误图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果真 (小于 (到时间 (.内容), 到时间 (.内容)))
    信息框 (“利息结至日不能小于起日日期！”, 相加 (#错误图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果 (相加 (“insert into dk_gh(lsh,hxqk,ghbj,ghlx,rzhrq,hxtsh,km) values('”, .内容, “',#”, 处理日期 (.内容), “#,0”, .内容, “,0”, .内容, “,#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “#,0”, 删首尾空 (到文本 (取时间间隔 (到时间 (.内容), 到时间 (.内容), #日))), “,'”, .内容, “')”).未知支持库函数_4 ()) ' 添加归还记录
    .如果 (等于 (到数值 (.内容), 0))
        相加 (“update dk_base set ghbj=ghbj+0”, .内容, “,lxje=lxje+0”, .内容, “,jkye=0”, .内容, “,hxqk=#”, 处理日期 (.内容), “#,jlzht='0' where lsh='”, .内容, “'”).未知支持库函数_4 () ' 更新贷款信息
    .否则
        相加 (“update dk_base set ghbj=ghbj+0”, .内容, “,lxje=lxje+0”, .内容, “,jkye=0”, .内容, “,hxqk=#”, 处理日期 (.内容), “# where lsh='”, .内容, “'”).未知支持库函数_4 () ' 更新贷款信息
    .如果结束
    相加 (“update dk_rkmyes set dffshe=dffshe+0”, 删首尾空 (.内容), “ where rq=#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “# and dh='”, 删首尾空 (.内容), “'”).未知支持库函数_4 ()
    相加 (“update dk_kmyes set dffshe=dffshe+0”, 删首尾空 (.内容), “ where rq=”, 删首尾空 (到文本 (取年份 (总控时间))), “ and dh='”, 删首尾空 (.内容), “'”).未知支持库函数_4 ()
    信息框 (“存盘成功！”, 相加 (#信息图标, #确认钮), “提示信息”)
    赋值 (.内容, “”)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 真)
    获取焦点 ()
.否则
    信息框 (“存盘失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
.如果结束


.子程序 _归还本金编辑框_失去焦点, 空白型, , 判断归还本金输入是否正确
.如果 (或者 (大于 (到数值 (相加 (“0”, .内容)), 到数值 (.内容)), 小于 (到数值 (相加 (“0”, .内容)), 0)))
    信息框 (“归还本金数额不能大于原贷款余额或小于零！”, 相加 (#错误图标, #确认钮), “提示信息”)
    赋值 (.内容, “”)
    赋值 (.内容, .内容)
.否则
    赋值 (.内容, 到文本 (相减 (到数值 (.内容), 到数值 (.内容))))
.如果结束


.子程序 _归还利息编辑框_失去焦点, 空白型, , 判断归还利息输入是否正确
.如果真 (小于 (到数值 (相加 (“0”, .内容)), 0))
    信息框 (“已还利息不能小于零！”, 相加 (#错误图标, #确认钮), “提示信息”)
    赋值 (.内容, “”)
.如果真结束


.子程序 _取消按钮_被单击, 空白型, , 放弃存盘
赋值 (.内容, “”)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 假)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.可视, 真)
获取焦点 ()

.子程序 _归还查找按钮_被单击, 空白型, , 
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入日期变量, 日期时间型, , , 
.局部变量 读入双精度变量, 双精度小数型, , , 

赋值 (.内容, 删首尾空 (.内容))
.如果 (等于 (.内容, “”))
    信息框 (“请输入流水号！”, 相加 (#信息图标, #确认钮), “提示信息”)
.否则
    相加 (“select lsh,name,ydje,ghbj,lxje,jkye,jkr,dqr,hxqk,ll,km,cz from dk_base where lsh='”, .内容, “' and jlzht='1'”).未知支持库函数_14 (1)
    .如果 (大于 (., 0))
        赋值 (.可视, 真)
        赋值 (.可视, 真)
        赋值 (.可视, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.禁止, 真)
        “name”.未知支持库函数_26 (读入文本变量)
        赋值 (.内容, 读入文本变量)
        “ydje”.未知支持库函数_27 (读入双精度变量)
        赋值 (.内容, 到文本 (读入双精度变量))
        “ghbj”.未知支持库函数_27 (读入双精度变量)
        赋值 (.内容, 到文本 (读入双精度变量))
        “lxje”.未知支持库函数_27 (读入双精度变量)
        赋值 (.内容, 到文本 (读入双精度变量))
        “jkye”.未知支持库函数_27 (读入双精度变量)
        赋值 (.内容, 到文本 (读入双精度变量))
        “jkr”.未知支持库函数_31 (读入日期变量)
        赋值 (.内容, 时间到文本 (读入日期变量, #日期部分))
        “dqr”.未知支持库函数_31 (读入日期变量)
        赋值 (.内容, 时间到文本 (读入日期变量, #日期部分))
        “hxqk”.未知支持库函数_31 (读入日期变量)
        赋值 (.内容, 时间到文本 (读入日期变量, #日期部分))
        “ll”.未知支持库函数_27 (读入双精度变量)
        赋值 (.内容, 到文本 (读入双精度变量))
        “km”.未知支持库函数_26 (读入文本变量)
        赋值 (.内容, 读入文本变量)
        “cz”.未知支持库函数_26 (读入文本变量)
        赋值 (.内容, 读入文本变量)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        未知支持库函数_16 ()
        获取焦点 ()
    .否则
        信息框 (“无此流水号！”, 相加 (#信息图标, #确认钮), “提示信息”)
        未知支持库函数_16 ()
    .如果结束
    
.如果结束




.窗口程序集 贷款展期窗口程序集, , , 

.子程序 _贷款展期窗口_创建完毕, 空白型, , 连接数据库
赋值 (贷款展期窗口., 相减 (相加 (贷款展期窗口., 194), 贷款展期窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _流水号编辑框_按下某键, 逻辑型, , 回车键显示记录
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _展期查找按钮_被单击 ()
.如果真结束


.子程序 _贷款收回录入窗口_被显示, 空白型, , 
获取焦点 ()

.子程序 _存盘按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _存盘按钮_被单击 ()
.如果真结束


.子程序 _存盘按钮_被单击, 空白型, , 保存记录
.局部变量 累计展期天数, 整数型, , , 

 ' 判断输入内容是否正确
.如果真 (小于或等于 (到数值 (相加 (“0”, .内容)), 0))
    信息框 (“展期天数必须大于零！”, 相加 (#错误图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
赋值 (累计展期天数, 相加 (到数值 (相加 (“0”, .内容)), 到数值 (相加 (“0”, .内容))))
.判断开始 (等于 (.内容, “短期借款”))
    .如果真 (大于 (累计展期天数, 到数值 (.内容)))
        信息框 (“短期借款累计展期天数不能大于原贷款期限！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    
.判断 (等于 (.内容, “中期借款”))
    .如果真 (大于 (累计展期天数, 整除 (到数值 (.内容), 2)))
        信息框 (“中期借款累计展期天数不能大于原贷款期限的一半！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    
.默认
    .如果真 (大于 (累计展期天数, 1827))
        信息框 (“长期借款累计展期天数不能超过3年！”, 相加 (#错误图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    
.判断结束
.如果 (相加 (“update dk_base set zhqtsh=zhqtsh+0”, .内容, “ where lsh='”, .内容, “'”).未知支持库函数_4 ()) ' 更新记录
    信息框 (“存盘成功！”, 相加 (#信息图标, #确认钮), “提示信息”)
    赋值 (.内容, “”)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.可视, 真)
    赋值 (.禁止, 假)
    赋值 (.可视, 假)
    获取焦点 ()
.否则
    信息框 (“存盘失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
.如果结束


.子程序 _展期天数编辑框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _取消按钮_被单击, 空白型, , 放弃存盘
赋值 (.内容, “”)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 假)
赋值 (.可视, 真)
赋值 (.可视, 假)
获取焦点 ()

.子程序 _展期查找按钮_被单击, 空白型, , 
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入日期变量, 日期时间型, , , 
.局部变量 读入整数变量, 整数型, , , 
.局部变量 读入双精度变量, 双精度小数型, , , 

赋值 (.内容, 删首尾空 (.内容))
.如果 (等于 (.内容, “”))
    信息框 (“请输入流水号！”, 相加 (#信息图标, #确认钮), “提示信息”)
.否则
    相加 (“select lsh,name,ydje,jkye,jkr,dqr,zhqtsh,qx,jktsh from dk_base where lsh='”, .内容, “'”).未知支持库函数_14 (1)
    .如果 (大于 (., 0))
        赋值 (.可视, 真)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.可视, 假)
        赋值 (.禁止, 真)
        “name”.未知支持库函数_26 (读入文本变量)
        赋值 (.内容, 读入文本变量)
        “ydje”.未知支持库函数_27 (读入双精度变量)
        赋值 (.内容, 到文本 (读入双精度变量))
        “jkye”.未知支持库函数_27 (读入双精度变量)
        赋值 (.内容, 到文本 (读入双精度变量))
        “jkr”.未知支持库函数_31 (读入日期变量)
        赋值 (.内容, 时间到文本 (读入日期变量, #日期部分))
        “dqr”.未知支持库函数_31 (读入日期变量)
        赋值 (.内容, 时间到文本 (读入日期变量, #日期部分))
        “zhqtsh”.未知支持库函数_29 (读入整数变量)
        赋值 (.内容, 删首尾空 (到文本 (读入整数变量)))
        “jktsh”.未知支持库函数_29 (读入整数变量)
        赋值 (.内容, 删首尾空 (到文本 (读入整数变量)))
        “qx”.未知支持库函数_26 (读入文本变量)
        赋值 (.内容, 读入文本变量)
        赋值 (.内容, “”)
        获取焦点 ()
    .否则
        信息框 (“无此流水号！”, 相加 (#信息图标, #确认钮), “提示信息”)
    .如果结束
    未知支持库函数_16 ()
.如果结束



.窗口程序集 取消贷款发放录入窗口程序集, , , 

.子程序 _取消贷款发放录入窗口_创建完毕, 空白型, , 连接数据库
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入日期变量, 日期时间型, , , 
.局部变量 读入双精度变量, 双精度小数型, , , 
.局部变量 插入位置, 整数型, , , 

赋值 (取消贷款发放录入窗口., 相减 (相加 (取消贷款发放录入窗口., 242), 取消贷款发放录入窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假)) ' 连接数据库
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
 ' 显示记录
相加 (“select lsh,name,ydje,cz,jkr,dqr,km from dk_base where rzhrq=#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “#”).未知支持库函数_14 (1)
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “lsh”.未知支持库函数_26 (读入文本变量)
        赋值 (插入位置, .插入表项 (读入文本变量, , , , ))
        “name”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (1, 读入文本变量)
        “cz”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (2, 读入文本变量)
        “ydje”.未知支持库函数_27 (读入双精度变量)
        插入位置.置标题 (3, 到文本 (读入双精度变量))
        “jkr”.未知支持库函数_31 (读入日期变量)
        插入位置.置标题 (4, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        “dqr”.未知支持库函数_31 (读入日期变量)
        插入位置.置标题 (5, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        “km”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (6, 读入文本变量)
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _取消业务按钮_被单击, 空白型, , 取消业务
.如果真 (不等于 (., -1))
    相加 (“select lsh from dk_gh where lsh='”, 删首尾空 (.取标题 (., 0)), “'”).未知支持库函数_14 (1)
    .如果 (大于 (., 0))
        信息框 (“本笔贷款已有还款记录，请先取消归还业务！”, 相加 (#信息图标, #确认钮), “提示信息”)
    .否则
        .如果真 (等于 (信息框 (相加 (“真的取消流水号为(”, .取标题 (., 0), “)的贷款发放业务吗？”), 相加 (#询问图标, #确认取消钮, #默认按钮二), “提示信息”), #确认钮))
            .如果 (相加 (“delete from dk_base where lsh='”, 删首尾空 (.取标题 (., 0)), “'”).未知支持库函数_4 ())
                相加 (“update dk_rkmyes set jffshe=jffshe-”, 删首尾空 (.取标题 (., 3)), “ where rq=#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “# and dh='”, 删首尾空 (.取标题 (., 6)), “'”).未知支持库函数_4 ()
                相加 (“update dk_kmyes set jffshe=jffshe-”, 删首尾空 (.取标题 (., 3)), “ where rq=”, 删首尾空 (到文本 (取年份 (总控时间))), “ and dh='”, 删首尾空 (.取标题 (., 6)), “'”).未知支持库函数_4 ()
                .删除表项 (.)
                信息框 (“操作成功！”, 相加 (#信息图标, #确认钮), “提示信息”)
            .否则
                信息框 (“操作失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
            .如果结束
            
        .如果真结束
        
    .如果结束
    未知支持库函数_16 ()
.如果真结束


.子程序 _取消贷款发放录入窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()

.窗口程序集 取消贷款归还录入窗口程序集, , , 取消贷款归还录入业务

.程序集变量 结息天数, 整数型, , "0", 
.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _取消贷款归还录入窗口_创建完毕, 空白型, , 连接数据库，显示数据
.局部变量 读入整数变量, 整数型, , , 
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入双精度变量, 双精度小数型, , , 
.局部变量 读入日期变量, 日期时间型, , , 
.局部变量 插入位置, 整数型, , , 

赋值 (取消贷款归还录入窗口., 相减 (相加 (取消贷款归还录入窗口., 232), 取消贷款归还录入窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假)) ' 连接数据库
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
 ' 显示记录
.未知支持库函数_12 ()
相加 (“select * from dk_gh where rzhrq=#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “#”).未知支持库函数_14 (1)
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “id”.未知支持库函数_29 (读入整数变量)
        “lsh”.未知支持库函数_26 (读入文本变量)
        赋值 (插入位置, .插入表项 (读入文本变量, , , , 读入整数变量))
        “ghbj”.未知支持库函数_27 (读入双精度变量)
        插入位置.置标题 (1, 删首尾空 (到文本 (读入双精度变量)))
        “ghlx”.未知支持库函数_27 (读入双精度变量)
        插入位置.置标题 (2, 删首尾空 (到文本 (读入双精度变量)))
        “hxqk”.未知支持库函数_31 (读入日期变量)
        插入位置.置标题 (3, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        “km”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (4, 读入文本变量)
        “hxtsh”.未知支持库函数_29 (读入整数变量)
        加入成员 (结息天数, 读入整数变量)
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()

.子程序 _取消贷款归还录入窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()

.子程序 _取消业务按钮_被单击, 空白型, , 取消业务
.局部变量 临时变量, 文本型, , , 
.局部变量 临时变量2, 文本型, , , 

.如果真 (不等于 (., -1))
    .如果真 (等于 (信息框 (“真的取消此笔业务吗？”, 相加 (#询问图标, #确认取消钮, #默认按钮二), “提示信息”), #确认钮))
        .如果 (大于 (到数值 (相加 (“0”, .取标题 (., 1))), 0))
            赋值 (临时变量, “,jlzht=1”)
        .否则
            赋值 (临时变量, “”)
        .如果结束
        赋值 (临时变量2, 处理日期 (删首尾空 (时间到文本 (增减时间 (到时间 (.取标题 (., 3)), #日, 负 (结息天数 [相加 (., 1)])), ))))
        .如果 (相加 (“update dk_base set ghbj=ghbj-0”, .取标题 (., 1), “,lxje=lxje-0”, .取标题 (., 2), “,jkye=jkye+0”, .取标题 (., 1), 临时变量, “,hxqk=#”, 临时变量2, “# where lsh='”, .取标题 (., 0), “'”).未知支持库函数_4 ()) ' 更新贷款明细
            相加 (“update dk_rkmyes set dffshe=dffshe-0”, 删首尾空 (.取标题 (., 1)), “ where rq=#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “# and dh='”, 删首尾空 (.取标题 (., 4)), “'”).未知支持库函数_4 ()
            相加 (“update dk_kmyes set dffshe=dffshe-0”, 删首尾空 (.取标题 (., 1)), “ where rq=”, 删首尾空 (到文本 (取年份 (总控时间))), “ and dh='”, 删首尾空 (.取标题 (., 4)), “'”).未知支持库函数_4 ()
            相加 (“delete from dk_gh where id=”, 删首尾空 (到文本 (.取表项数值 (.)))).未知支持库函数_4 () ' 删除归还记录
            .删除表项 (.)
            信息框 (“操作成功！”, 相加 (#信息图标, #确认钮), “提示信息”)
        .否则
            信息框 (“操作失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
        .如果结束
        
    .如果真结束
    
.如果真结束


.窗口程序集 贷款形态调整窗口程序集, , , 调整贷款形态

.子程序 _贷款形态调整窗口_创建完毕, 空白型, , 连接数据库
.局部变量 读入文本变量, 文本型, , , 

赋值 (贷款形态调整窗口., 相减 (相加 (贷款形态调整窗口., 224), 贷款形态调整窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _流水号编辑框_按下某键, 逻辑型, , 回车键显示记录
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _形态调整查找按钮_被单击 ()
.如果真结束


.子程序 _贷款收回录入窗口_被显示, 空白型, , 
获取焦点 ()

.子程序 _存盘按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _存盘按钮_被单击 ()
.如果真结束


.子程序 _存盘按钮_被单击, 空白型, , 保存记录
 ' 判断科目输入内容是否正确
.如果真 (等于 (.现行选中项, -1))
    信息框 (“请选择调整后的科目！”, 相加 (#错误图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果 (相加 (“update dk_base set km='”, .内容, “',jkxts='”, .内容, “' where lsh='”, .内容, “'”).未知支持库函数_4 ()) ' 更新记录
    相加 (“insert into dk_xttzh(lsh,ykm,mkm,tzhje,yxt,mxt,rzhrq) values('”, .内容, “','”, .内容, “','”, .内容, “',0”, .内容, “,'”, .内容, “','”, .内容, “',#”, 删首尾空 (处理日期 (时间到文本 (总控时间, #日期部分))), “#)”).未知支持库函数_4 () ' 添加贷款调整记录
    相加 (“update dk_rkmyes set jffshe=jffshe+”, 删首尾空 (.内容), “ where rq=#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “# and dh='”, 删首尾空 (.内容), “'”).未知支持库函数_4 ()
    相加 (“update dk_kmyes set jffshe=jffshe+”, 删首尾空 (.内容), “ where rq=”, 删首尾空 (到文本 (取年份 (总控时间))), “ and dh='”, 删首尾空 (.内容), “'”).未知支持库函数_4 ()
    相加 (“update dk_rkmyes set dffshe=dffshe+0”, 删首尾空 (.内容), “ where rq=#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “# and dh='”, 删首尾空 (.内容), “'”).未知支持库函数_4 ()
    相加 (“update dk_kmyes set dffshe=dffshe+0”, 删首尾空 (.内容), “ where rq=”, 删首尾空 (到文本 (取年份 (总控时间))), “ and dh='”, 删首尾空 (.内容), “'”).未知支持库函数_4 ()
    信息框 (“存盘成功！”, 相加 (#信息图标, #确认钮), “提示信息”)
    赋值 (.内容, “”)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 真)
    获取焦点 ()
.否则
    信息框 (“存盘失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
.如果结束


.子程序 _取消按钮_被单击, 空白型, , 放弃存盘
赋值 (.内容, “”)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 假)
赋值 (.可视, 假)
赋值 (.可视, 真)
获取焦点 ()

.子程序 _科目组合框_列表项被选择, 空白型, , 判断科目选择是否正确
.局部变量 读入文本变量, 文本型, , , 

赋值 (.内容, 删首尾空 (.内容))
.如果 (等于 (.内容, “”))
    信息框 (“请选择科目！ ”, 相加 (#信息图标, #确认钮), “提示信息”)
.否则
    相加 (“select * from dk_kms where id='”, .内容, “'”).未知支持库函数_14 (1)
    “type”.未知支持库函数_26 (读入文本变量)
    赋值 (.内容, 读入文本变量)
    未知支持库函数_16 ()
.如果结束


.子程序 _科目组合框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _形态调整查找按钮_被单击, 空白型, , 
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入日期变量, 日期时间型, , , 
.局部变量 读入整数变量, 整数型, , , 
.局部变量 读入双精度变量, 双精度小数型, , , 

赋值 (.内容, 删首尾空 (.内容))
.如果 (等于 (.内容, “”))
    信息框 (“请输入流水号！”, 相加 (#信息图标, #确认钮), “提示信息”)
.否则
    相加 (“select lsh,name,ydje,jkye,jkr,dqr,zhqtsh,qx,km,jkxts from dk_base where lsh='”, .内容, “' and jlzht='1'”).未知支持库函数_14 (1)
    .如果 (大于 (., 0))
         ' 显示数据
        赋值 (.可视, 真)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        赋值 (.可视, 假)
        赋值 (.禁止, 真)
        “name”.未知支持库函数_26 (读入文本变量)
        赋值 (.内容, 读入文本变量)
        “ydje”.未知支持库函数_27 (读入双精度变量)
        赋值 (.内容, 到文本 (读入双精度变量))
        “jkye”.未知支持库函数_27 (读入双精度变量)
        赋值 (.内容, 到文本 (读入双精度变量))
        “jkr”.未知支持库函数_31 (读入日期变量)
        赋值 (.内容, 时间到文本 (读入日期变量, #日期部分))
        “dqr”.未知支持库函数_31 (读入日期变量)
        赋值 (.内容, 时间到文本 (读入日期变量, #日期部分))
        “km”.未知支持库函数_26 (读入文本变量)
        赋值 (.内容, 读入文本变量)
        “zhqtsh”.未知支持库函数_29 (读入整数变量)
        赋值 (.内容, 删首尾空 (到文本 (读入整数变量)))
        “qx”.未知支持库函数_26 (读入文本变量)
        赋值 (.内容, 读入文本变量)
        “jkxts”.未知支持库函数_26 (读入文本变量)
        赋值 (.内容, 读入文本变量)
        赋值 (.内容, “”)
         ' 载入可以调整到的科目
        未知支持库函数_16 ()
        相加 (“select * from dk_kmtzhs where ykm='”, .内容, “' order by mkm”).未知支持库函数_14 (1)
        清空 ()
        .如果真 (未知支持库函数_34 ())
            .判断循环首 (等于 (., 假))
                “mkm”.未知支持库函数_26 (读入文本变量)
                读入文本变量.加入项目 ()
                未知支持库函数_36 ()
            .判断循环尾 ()
        .如果真结束
        赋值 (.现行选中项, -1)
        获取焦点 ()
    .否则
        信息框 (“无此流水号！”, 相加 (#信息图标, #确认钮), “提示信息”)
    .如果结束
    未知支持库函数_16 ()
.如果结束



.窗口程序集 开工初始化窗口程序集, , , 

.子程序 _开工初始化窗口_创建完毕, 空白型, , 
赋值 (开工初始化窗口., 相减 (相加 (开工初始化窗口., 107), 开工初始化窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 0, )
    结束 ()
.如果真结束
.未知支持库函数_12 ()
.未知支持库函数_12 ()
赋值 (.标题, 相加 (“账务处理日期：”, 时间到文本 (总控时间, #日期部分), 系统状态))
赋值 (.标题, 相加 (“当前系统日期：”, 时间到文本 (登录日期, #日期部分)))

.子程序 _开工初始化按钮_被单击, 空白型, , 日初开工初始化
.局部变量 科目代号, 文本型, , , 
.局部变量 上期余额, 双精度小数型, , , 
.局部变量 是否错误, 逻辑型, , , 

.如果真 (等于 (取时间间隔 (总控时间, 登录日期, #日), 0))
    信息框 (“今天已作日终!”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
相加 (“delete from dk_rkmyes where rq=#”, 处理日期 (时间到文本 (登录日期, #日期部分)), “#”).未知支持库函数_4 ()
“select id from dk_kms order by id asc”.未知支持库函数_14 (1)
未知支持库函数_34 ()
赋值 (是否错误, 假)
.判断循环首 (等于 (., 假))
    “id”.未知支持库函数_26 (科目代号)
    相加 (“select ye from dk_rkmyes where rq=#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “# and dh='”, 科目代号, “'”).未知支持库函数_14 (1)
    .如果 (未知支持库函数_34 ())
        “ye”.未知支持库函数_27 (上期余额)
    .否则
         ' 信息框 (“读入上期余额错误！”, #错误图标 ＋ #确认钮, “提示信息”)
        未知支持库函数_16 ()
        相加 (“select sum(jkye) as ye from dk_base where km='”, 科目代号, “'”).未知支持库函数_14 (1)
        “ye”.未知支持库函数_27 (上期余额)
    .如果结束
    未知支持库函数_16 ()
    .如果真 (等于 (相加 (“insert into dk_rkmyes(dh,rq,qcye,jffshe,dffshe,ye) values('”, 科目代号, “',#”, 处理日期 (时间到文本 (登录日期, #日期部分)), “#,0”, 到文本 (上期余额), “,0,0,0)”).未知支持库函数_4 (), 假))
        赋值 (是否错误, 真)
        返回 ()
    .如果真结束
    未知支持库函数_36 ()
.判断循环尾 ()
未知支持库函数_16 ()
.如果 (等于 (是否错误, 真))
    信息框 (“日初开工失败,请检查账务处理日期与当前系统日期是否相符！”, 相加 (#错误图标, #确认钮), “提示信息”)
.否则
    .如果 (相加 (“update dk_system set zksj=#”, 处理日期 (时间到文本 (登录日期, #日期部分)), “#,zht='日间'”).未知支持库函数_4 ())
        赋值 (总控时间, 登录日期)
        赋值 (系统状态, “日间”)
        信息框 (相加 (“日初开工完毕！”, #换行符, “总控时间：”, 时间到文本 (总控时间, #日期部分), 系统状态), 相加 (#信息图标, #确认钮), “提示信息”)
        销毁 ()
    .否则
        信息框 (“日初开工失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
    .如果结束
    
.如果结束


.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.窗口程序集 取消形态调整窗口程序集, , , 

.子程序 _取消形态调整窗口_创建完毕, 空白型, , 连接数据库,显示数据
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入整数变量, 整数型, , , 
.局部变量 读入双精度变量, 双精度小数型, , , 
.局部变量 插入位置, 整数型, , , 

赋值 (取消形态调整窗口., 相减 (相加 (取消形态调整窗口., 209), 取消形态调整窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假)) ' 连接数据库
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
 ' 显示记录
相加 (“select * from dk_xttzh where rzhrq=#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “#”).未知支持库函数_14 (1)
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “id”.未知支持库函数_29 (读入整数变量)
        “lsh”.未知支持库函数_26 (读入文本变量)
        赋值 (插入位置, .插入表项 (读入文本变量, , , , 读入整数变量))
        “ykm”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (1, 读入文本变量)
        “mkm”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (2, 读入文本变量)
        “yxt”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (3, 读入文本变量)
        “mxt”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (4, 读入文本变量)
        “tzhje”.未知支持库函数_27 (读入双精度变量)
        插入位置.置标题 (5, 到文本 (读入双精度变量))
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _取消业务按钮_被单击, 空白型, , 取消贷款形态调整业务
.如果真 (不等于 (., -1))
    .如果真 (等于 (信息框 (“真的取消此笔业务吗？”, 相加 (#询问图标, #确认取消钮), “提示信息”), #确认钮))
        .如果 (相加 (“update dk_base set jkxts='”, .取标题 (., 3), “',km='”, .取标题 (., 1), “' where lsh='”, .取标题 (., 0), “'”).未知支持库函数_4 ())
            相加 (“update dk_rkmyes set jffshe=jffshe-”, 删首尾空 (.取标题 (., 5)), “ where rq=#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “# and dh='”, 删首尾空 (.取标题 (., 2)), “'”).未知支持库函数_4 ()
            相加 (“update dk_kmyes set jffshe=jffshe-”, 删首尾空 (.取标题 (., 5)), “ where rq=”, 删首尾空 (到文本 (取年份 (总控时间))), “ and dh='”, 删首尾空 (.取标题 (., 2)), “'”).未知支持库函数_4 ()
            相加 (“update dk_rkmyes set dffshe=dffshe-0”, 删首尾空 (.取标题 (., 5)), “ where rq=#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “# and dh='”, 删首尾空 (.取标题 (., 1)), “'”).未知支持库函数_4 ()
            相加 (“update dk_kmyes set dffshe=dffshe-0”, 删首尾空 (.取标题 (., 5)), “ where rq=”, 删首尾空 (到文本 (取年份 (总控时间))), “ and dh='”, 删首尾空 (.取标题 (., 1)), “'”).未知支持库函数_4 ()
            相加 (“delete from dk_xttzh where id=”, 删首尾空 (到文本 (.取表项数值 (.)))).未知支持库函数_4 ()
            .删除表项 (.)
            信息框 (“操作成功！”, 相加 (#信息图标, #确认钮), “提示信息”)
        .否则
            信息框 (“操作失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
        .如果结束
        
    .如果真结束
    
.如果真结束


.窗口程序集 五级分类窗口程序集, , , 

.子程序 _五级分类窗口_创建完毕, 空白型, , 
赋值 (五级分类窗口., 相减 (相加 (五级分类窗口., 201), 五级分类窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _流水号编辑框_按下某键, 逻辑型, , 回车键显示记录
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入日期变量, 日期时间型, , , 
.局部变量 读入整数变量, 整数型, , , 
.局部变量 读入双精度变量, 双精度小数型, , , 

.如果真 (等于 (键代码, #回车键))
    赋值 (.内容, 删首尾空 (.内容))
    .如果 (等于 (.内容, “”))
        信息框 (“请输入流水号！”, 相加 (#信息图标, #确认钮), “提示信息”)
    .否则
        相加 (“select lsh,name,ydje,jkye,jkr,dqr,zhqtsh,qx,jkxtw from dk_base where lsh='”, .内容, “' and jlzht='1'”).未知支持库函数_14 (1)
        .如果 (大于 (., 0))
             ' 显示数据
            赋值 (.可视, 真)
            赋值 (.禁止, 假)
            赋值 (.禁止, 假)
            赋值 (.可视, 假)
            赋值 (.禁止, 真)
            “name”.未知支持库函数_26 (读入文本变量)
            赋值 (.内容, 读入文本变量)
            “ydje”.未知支持库函数_27 (读入双精度变量)
            赋值 (.内容, 到文本 (读入双精度变量))
            “jkye”.未知支持库函数_27 (读入双精度变量)
            赋值 (.内容, 到文本 (读入双精度变量))
            “jkr”.未知支持库函数_31 (读入日期变量)
            赋值 (.内容, 时间到文本 (读入日期变量, #日期部分))
            “dqr”.未知支持库函数_31 (读入日期变量)
            赋值 (.内容, 时间到文本 (读入日期变量, #日期部分))
            “jkxtw”.未知支持库函数_26 (读入文本变量)
            赋值 (.内容, 读入文本变量)
            “zhqtsh”.未知支持库函数_29 (读入整数变量)
            赋值 (.内容, 删首尾空 (到文本 (读入整数变量)))
            “qx”.未知支持库函数_26 (读入文本变量)
            赋值 (.内容, 读入文本变量)
            赋值 (.现行选中项, -1)
            获取焦点 ()
        .否则
            信息框 (“无此流水号！”, 相加 (#信息图标, #确认钮), “提示信息”)
        .如果结束
        未知支持库函数_16 ()
    .如果结束
    
.如果真结束


.子程序 _贷款收回录入窗口_被显示, 空白型, , 
获取焦点 ()

.子程序 _存盘按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _存盘按钮_被单击 ()
.如果真结束


.子程序 _存盘按钮_被单击, 空白型, , 保存记录
 ' 判断科目输入内容是否正确
.如果真 (等于 (.现行选中项, -1))
    信息框 (“请选择五级分类形态！”, 相加 (#错误图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果 (相加 (“update dk_base set jkxtw='”, .内容, “' where lsh='”, .内容, “'”).未知支持库函数_4 ()) ' 更新记录
    信息框 (“存盘成功！”, 相加 (#信息图标, #确认钮), “提示信息”)
    赋值 (.内容, “”)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.可视, 真)
    赋值 (.禁止, 假)
    赋值 (.可视, 假)
    获取焦点 ()
.否则
    信息框 (“存盘失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
.如果结束


.子程序 _取消按钮_被单击, 空白型, , 放弃存盘
赋值 (.内容, “”)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.可视, 真)
赋值 (.禁止, 假)
赋值 (.可视, 假)
获取焦点 ()

.子程序 _目标分类组合框_按下某键, 逻辑型, , 回车键下移焦点
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.窗口程序集 日终窗口程序集, , , 做日终处理

.子程序 _日终处理窗口_创建完毕, 空白型, , 连接数据库
.局部变量 余额表余额, 双精度小数型, , , 
.局部变量 明细数据余额, 双精度小数型, , , 
.局部变量 读入文本变量, 文本型, , , 
.局部变量 是否已打平, 逻辑型, , , 
.局部变量 插入位置, 整数型, , , 

赋值 (日终处理窗口., 相减 (相加 (日终处理窗口., 352), 日终处理窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
.未知支持库函数_12 ()
相加 (“update dk_rkmyes set ye=qcye+jffshe-dffshe where rq=#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “#”).未知支持库函数_4 ()
相加 (“update dk_kmyes set ye=ncye+jffshe-dffshe where rq=”, 删首尾空 (到文本 (取年份 (总控时间)))).未知支持库函数_4 ()

.子程序 _日终处理窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _下一步按钮_被单击, 空白型, , 执行下一步操作
.局部变量 余额表余额, 双精度小数型, , , 
.局部变量 明细数据余额, 双精度小数型, , , 
.局部变量 读入日期变量, 日期时间型, , , 
.局部变量 读入双精度变量, 双精度小数型, , , 
.局部变量 读入整数变量, 整数型, , , 
.局部变量 读入文本变量, 文本型, , , 
.局部变量 是否已打平, 逻辑型, , , 
.局部变量 插入位置, 整数型, , , 
.局部变量 下一年, 文本型, , , 
.局部变量 今年, 文本型, , , 

.判断开始 (等于 (.现行子夹, 1))
    赋值 (.现行子夹, 2)
     ' 显示贷款发放记录
    相加 (“select km,lsh,name,ydje,jkr,dqr from dk_base where rzhrq=#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “#”).未知支持库函数_14 (1)
    .如果真 (未知支持库函数_34 ())
        .判断循环首 (等于 (., 假))
            “km”.未知支持库函数_26 (读入文本变量)
            赋值 (插入位置, .插入表项 (读入文本变量, , , , ))
            “lsh”.未知支持库函数_26 (读入文本变量)
            插入位置.置标题 (1, 读入文本变量)
            “name”.未知支持库函数_26 (读入文本变量)
            插入位置.置标题 (2, 读入文本变量)
            “ydje”.未知支持库函数_27 (读入双精度变量)
            插入位置.置标题 (3, 到文本 (读入双精度变量))
            “jkr”.未知支持库函数_31 (读入日期变量)
            插入位置.置标题 (4, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
            “dqr”.未知支持库函数_31 (读入日期变量)
            插入位置.置标题 (5, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
            未知支持库函数_36 ()
        .判断循环尾 ()
    .如果真结束
    未知支持库函数_16 ()
     ' 显示贷款收回记录
    相加 (“select dk_gh.lsh,dk_gh.ghbj,dk_gh.ghlx,dk_gh.hxqk,dk_gh.rzhrq,dk_base.name from dk_gh inner join dk_base on dk_gh.lsh=dk_base.lsh where dk_gh.rzhrq=#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “#”).未知支持库函数_14 (1)
    .如果真 (未知支持库函数_34 ())
        .判断循环首 (等于 (., 假))
            “lsh”.未知支持库函数_26 (读入文本变量)
            赋值 (插入位置, .插入表项 (读入文本变量, , , , ))
            “name”.未知支持库函数_26 (读入文本变量)
            插入位置.置标题 (1, 读入文本变量)
            “ghbj”.未知支持库函数_27 (读入双精度变量)
            插入位置.置标题 (2, 到文本 (读入双精度变量))
            “ghlx”.未知支持库函数_27 (读入双精度变量)
            插入位置.置标题 (3, 到文本 (读入双精度变量))
            “hxqk”.未知支持库函数_31 (读入日期变量)
            插入位置.置标题 (4, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
            未知支持库函数_36 ()
        .判断循环尾 ()
    .如果真结束
    未知支持库函数_16 ()
     ' 显示调整贷款形态记录
    相加 (“select dk_xttzh.lsh,dk_xttzh.ykm,dk_xttzh.yxt,dk_xttzh.mkm,dk_xttzh.mxt,dk_xttzh.rzhrq,dk_base.name from dk_xttzh inner join dk_base on dk_xttzh.lsh=dk_base.lsh where dk_xttzh.rzhrq=#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “#”).未知支持库函数_14 (1)
    .如果真 (未知支持库函数_34 ())
        .判断循环首 (等于 (., 假))
            “lsh”.未知支持库函数_26 (读入文本变量)
            赋值 (插入位置, .插入表项 (读入文本变量, , , , ))
            “name”.未知支持库函数_26 (读入文本变量)
            插入位置.置标题 (1, 读入文本变量)
            “ykm”.未知支持库函数_26 (读入文本变量)
            插入位置.置标题 (2, 读入文本变量)
            “yxt”.未知支持库函数_26 (读入文本变量)
            插入位置.置标题 (3, 读入文本变量)
            “mkm”.未知支持库函数_26 (读入文本变量)
            插入位置.置标题 (4, 读入文本变量)
            “mxt”.未知支持库函数_26 (读入文本变量)
            插入位置.置标题 (5, 读入文本变量)
            未知支持库函数_36 ()
        .判断循环尾 ()
    .如果真结束
    未知支持库函数_16 ()
     ' 显示日科目余额表数据
    相加 (“SELECT dk_rkmyes.dh,dk_kms.name,dk_rkmyes.qcye,dk_rkmyes.jffshe,dk_rkmyes.dffshe, dk_rkmyes.ye  FROM dk_rkmyes INNER JOIN dk_kms ON dk_rkmyes.dh = dk_kms.id  WHERE rq=#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “#”).未知支持库函数_14 (1)
    .如果真 (未知支持库函数_34 ())
        .判断循环首 (等于 (., 假))
            “dh”.未知支持库函数_26 (读入文本变量)
            赋值 (插入位置, .插入表项 (读入文本变量, , , , ))
            “name”.未知支持库函数_26 (读入文本变量)
            插入位置.置标题 (1, 读入文本变量)
            “qcye”.未知支持库函数_27 (读入双精度变量)
            插入位置.置标题 (2, 到文本 (读入双精度变量))
            “jffshe”.未知支持库函数_27 (读入双精度变量)
            插入位置.置标题 (3, 到文本 (读入双精度变量))
            “dffshe”.未知支持库函数_27 (读入双精度变量)
            插入位置.置标题 (4, 到文本 (读入双精度变量))
            “ye”.未知支持库函数_27 (读入双精度变量)
            插入位置.置标题 (5, 到文本 (读入双精度变量))
            未知支持库函数_36 ()
        .判断循环尾 ()
    .如果真结束
    未知支持库函数_16 ()
     ' 显示本年累计科目余额表
    相加 (“SELECT dk_kmyes.dh,dk_kms.name,dk_kmyes.ncye,dk_kmyes.jffshe,dk_kmyes.dffshe, dk_kmyes.ye  FROM dk_kmyes INNER JOIN dk_kms ON dk_kmyes.dh = dk_kms.id  WHERE rq=”, 删首尾空 (到文本 (取年份 (总控时间)))).未知支持库函数_14 (1)
    .如果真 (未知支持库函数_34 ())
        .判断循环首 (等于 (., 假))
            “dh”.未知支持库函数_26 (读入文本变量)
            赋值 (插入位置, .插入表项 (读入文本变量, , , , ))
            “name”.未知支持库函数_26 (读入文本变量)
            插入位置.置标题 (1, 读入文本变量)
            “ncye”.未知支持库函数_27 (读入双精度变量)
            插入位置.置标题 (2, 到文本 (读入双精度变量))
            “jffshe”.未知支持库函数_27 (读入双精度变量)
            插入位置.置标题 (3, 到文本 (读入双精度变量))
            “dffshe”.未知支持库函数_27 (读入双精度变量)
            插入位置.置标题 (4, 到文本 (读入双精度变量))
            “ye”.未知支持库函数_27 (读入双精度变量)
            插入位置.置标题 (5, 到文本 (读入双精度变量))
            未知支持库函数_36 ()
        .判断循环尾 ()
    .如果真结束
    未知支持库函数_16 ()
     ' 显示凭证使用情况
    相加 (“select * from dk_jjbhb where lyrq=#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “# order by bh”).未知支持库函数_14 (1)
    赋值 (.标题, 相加 (“今日共领用凭证(借据)”, 删首尾空 (到文本 (.)), “份”))
    .如果真 (未知支持库函数_34 ())
        .判断循环首 (等于 (., 假))
            “bh”.未知支持库函数_26 (读入文本变量)
            赋值 (插入位置, .插入表项 (读入文本变量, , , , ))
            “lyry”.未知支持库函数_26 (读入文本变量)
            插入位置.置标题 (1, “领用凭证”)
            插入位置.置标题 (2, 读入文本变量)
            未知支持库函数_36 ()
        .判断循环尾 ()
    .如果真结束
    未知支持库函数_16 ()
    相加 (“select * from dk_jjbhb where jlzht='1' and syrq=#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “# order by bh”).未知支持库函数_14 (1)
    赋值 (.标题, 相加 (.标题, “，使用”, 删首尾空 (到文本 (.)), “份”))
    .如果真 (未知支持库函数_34 ())
        .判断循环首 (等于 (., 假))
            “bh”.未知支持库函数_26 (读入文本变量)
            赋值 (插入位置, .插入表项 (读入文本变量, , , , ))
            “syry”.未知支持库函数_26 (读入文本变量)
            插入位置.置标题 (1, “使用凭证”)
            插入位置.置标题 (2, 读入文本变量)
            未知支持库函数_36 ()
        .判断循环尾 ()
    .如果真结束
    未知支持库函数_16 ()
    相加 (“select * from dk_jjbhb where jlzht='2' and syrq=#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “# order by bh”).未知支持库函数_14 (1)
    赋值 (.标题, 相加 (.标题, “，作废”, 删首尾空 (到文本 (.)), “份。”))
    .如果真 (未知支持库函数_34 ())
        .判断循环首 (等于 (., 假))
            “bh”.未知支持库函数_26 (读入文本变量)
            赋值 (插入位置, .插入表项 (读入文本变量, , , , ))
            “syry”.未知支持库函数_26 (读入文本变量)
            插入位置.置标题 (1, “作废凭证”)
            插入位置.置标题 (2, 读入文本变量)
            未知支持库函数_36 ()
        .判断循环尾 ()
    .如果真结束
    未知支持库函数_16 ()
    “select count(*) as shl from dk_jjbhb”.未知支持库函数_14 (1)
    “shl”.未知支持库函数_29 (读入整数变量)
    赋值 (.标题, 相加 (“累计领用凭证(借据)”, 删首尾空 (到文本 (读入整数变量)), “份”))
    未知支持库函数_16 ()
    “select count(*) as shl from dk_jjbhb where jlzht='1'”.未知支持库函数_14 (1)
    “shl”.未知支持库函数_29 (读入整数变量)
    赋值 (.标题, 相加 (.标题, “，使用”, 删首尾空 (到文本 (读入整数变量)), “份”))
    未知支持库函数_16 ()
    “select count(*) as shl from dk_jjbhb where jlzht='2'”.未知支持库函数_14 (1)
    “shl”.未知支持库函数_29 (读入整数变量)
    赋值 (.标题, 相加 (.标题, “，作废”, 删首尾空 (到文本 (读入整数变量)), “份”))
    未知支持库函数_16 ()
    “select count(*) as shl from dk_jjbhb where jlzht='0'”.未知支持库函数_14 (1)
    “shl”.未知支持库函数_29 (读入整数变量)
    赋值 (.标题, 相加 (.标题, “，结余”, 删首尾空 (到文本 (读入整数变量)), “份”))
    未知支持库函数_16 ()
    赋值 (.可视, 真)
.判断 (等于 (.现行子夹, 0))
    赋值 (.现行子夹, 1)
    相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码)
    赋值 (是否已打平, 真)
    赋值 (.标题, “正在打平数据……”)
    处理事件 ()
    相加 (“SELECT dk_rkmyes.dh, dk_kms.name, dk_rkmyes.ye  FROM dk_rkmyes INNER JOIN dk_kms ON dk_rkmyes.dh = dk_kms.id  WHERE rq=#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “#”).未知支持库函数_14 (1)
    .如果真 (未知支持库函数_34 ())
        .判断循环首 (等于 (., 假))
            “dh”.未知支持库函数_26 (读入文本变量)
            赋值 (插入位置, .插入表项 (读入文本变量, , , , ))
            相加 (“select sum(jkye) as ye from dk_base where jlzht='1' and km='”, 读入文本变量, “'”).未知支持库函数_14 (1)
            未知支持库函数_34 ()
            “ye”.未知支持库函数_27 (明细数据余额)
            未知支持库函数_16 ()
            插入位置.置标题 (3, 到文本 (明细数据余额))
            “name”.未知支持库函数_26 (读入文本变量)
            插入位置.置标题 (1, 读入文本变量)
            “ye”.未知支持库函数_27 (余额表余额)
            插入位置.置标题 (2, 到文本 (余额表余额))
            .如果真 (不等于 (明细数据余额, 余额表余额))
                赋值 (是否已打平, 假)
            .如果真结束
            处理事件 ()
            未知支持库函数_36 ()
        .判断循环尾 ()
    .如果真结束
    未知支持库函数_16 ()
    .如果 (等于 (是否已打平, 真))
        赋值 (.标题, “数据已打平！”)
    .否则
        赋值 (.标题, “数据不平，请检查核对！”)
        赋值 (.禁止, 真)
    .如果结束
    赋值 (.可视, 假)
.判断 (等于 (.现行子夹, 2))
    赋值 (.现行子夹, 3)
    赋值 (.可视, 假)
.判断 (等于 (.现行子夹, 3))
    赋值 (.现行子夹, 4)
    .如果 (等于 (取年份 (增减时间 (总控时间, #日, 到数值 (.内容))), 取年份 (总控时间))) ' 根据总控时间和例假日天数判断当日是否为当年的最后一天
        赋值 (.标题, “日终处理”)
        赋值 (.标题, “日终处理”)
        赋值 (.标题, “按下<日终处理>按钮开始进行日终处理……”)
    .否则
        赋值 (.标题, “年终处理”)
        赋值 (.标题, “年终处理”)
        赋值 (.标题, “已到年底，按下<年终处理>按钮开始进行年终处理……”)
    .如果结束
    赋值 (.可视, 假)
.默认
    相加 (“update dk_system set zht='日终',ljrtsh=0”, 删首尾空 (.内容)).未知支持库函数_4 () ' 更新系统库
    赋值 (系统状态, “日终”)
     ' 如果是年终处理，则将本年科目余额表余额结转到下一年
    .如果真 (等于 (.标题, “年终处理”))
        赋值 (今年, 删首尾空 (到文本 (取年份 (总控时间))))
        赋值 (下一年, 删首尾空 (到文本 (相加 (取年份 (总控时间), 1))))
        相加 (“delete from dk_kmyes where rq=”, 下一年).未知支持库函数_4 ()
        “select id from dk_kms order by id”.未知支持库函数_14 (1)
        .如果真 (未知支持库函数_34 ())
            .判断循环首 (等于 (., 假))
                “id”.未知支持库函数_26 (读入文本变量)
                相加 (“select ye from dk_kmyes where rq=”, 今年, “ and dh='”, 读入文本变量, “'”).未知支持库函数_14 (1)
                .如果 (未知支持库函数_34 ())
                    “ye”.未知支持库函数_27 (读入双精度变量)
                .否则
                    未知支持库函数_16 ()
                    相加 (“select sum(jkye) as ye from dk_base where km='”, 读入文本变量, “'”).未知支持库函数_14 (1)
                    “ye”.未知支持库函数_27 (读入双精度变量)
                .如果结束
                相加 (“insert into dk_kmyes(rq,dh,ncye,jffshe,dffshe,ye) values(”, 下一年, “,'”, 读入文本变量, “',0”, 删首尾空 (到文本 (读入双精度变量)), “,0,0,0)”).未知支持库函数_4 ()
                未知支持库函数_16 ()
                未知支持库函数_36 ()
            .判断循环尾 ()
        .如果真结束
        未知支持库函数_16 ()
    .如果真结束
    信息框 (“处理完毕！”, 相加 (#信息图标, #确认钮), “提示信息”)
    销毁 ()
.判断结束


.子程序 _打印按钮_被单击, 空白型, , 打印报表
.局部变量 当前行号, 整数型, , , 
.局部变量 总行数, 整数型, , , 

.判断开始 (等于 (.现行子夹, 0)) ' 打印贷款发放日报表
    .如果 (相加 (取运行目录 (), “\report\日终贷款发放.grd”).从文件读 ())
        2.置文本 (1, 相加 (“单位：”, 信用社名称))
        2.置文本 (4, 处理日期 (时间到文本 (总控时间, #日期部分)))
        赋值 (当前行号, 0)
        赋值 (总行数, 取表项数 ())
        .如果真 (小于 (总行数, 1))
            返回 ()
        .如果真结束
        .判断循环首 (小于 (当前行号, 总行数))
            .添加行 ()
            相加 (当前行号, 4).置文本 (1, 当前行号.取标题 (0))
            相加 (当前行号, 4).置文本 (2, 当前行号.取标题 (1))
            相加 (当前行号, 4).置文本 (3, 当前行号.取标题 (2))
            相加 (当前行号, 4).置文本 (4, 当前行号.取标题 (3))
            相加 (当前行号, 4).置文本 (5, 当前行号.取标题 (4))
            相加 (当前行号, 4).置文本 (6, 当前行号.取标题 (5))
            赋值 (当前行号, 相加 (当前行号, 1))
        .判断循环尾 ()
        4.置对齐方式 (1, 总行数, 3, #中左)
        4.置对齐方式 (4, 总行数, 1, #中右)
        4.置对齐方式 (5, 总行数, 2, #中左)
        4.加线条 (1, 总行数, 6, 相加 (#左边框, #右边框, #上边框, #下边框, #垂直线, #水平线))
        4.置字体尺寸 (1, 总行数, 6, 32)
        真.打印 (“贷款管理”)
    .否则
        信息框 (“读入报表模板失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
    .如果结束
    
.判断 (等于 (.现行子夹, 1)) ' 贷款收回日报表
    .如果 (相加 (取运行目录 (), “\report\日终贷款收回.grd”).从文件读 ())
        2.置文本 (1, 相加 (“单位：”, 信用社名称))
        2.置文本 (3, 处理日期 (时间到文本 (总控时间, #日期部分)))
        赋值 (当前行号, 0)
        赋值 (总行数, 取表项数 ())
        .如果真 (小于 (总行数, 1))
            返回 ()
        .如果真结束
        .判断循环首 (小于 (当前行号, 总行数))
            .添加行 ()
            相加 (当前行号, 4).置文本 (1, 当前行号.取标题 (0))
            相加 (当前行号, 4).置文本 (2, 当前行号.取标题 (1))
            相加 (当前行号, 4).置文本 (3, 当前行号.取标题 (2))
            相加 (当前行号, 4).置文本 (4, 当前行号.取标题 (3))
            相加 (当前行号, 4).置文本 (5, 当前行号.取标题 (4))
            赋值 (当前行号, 相加 (当前行号, 1))
        .判断循环尾 ()
        4.置对齐方式 (1, 总行数, 2, #中左)
        4.置对齐方式 (3, 总行数, 2, #中右)
        4.置对齐方式 (5, 总行数, 1, #中左)
        4.加线条 (1, 总行数, 5, 相加 (#左边框, #右边框, #上边框, #下边框, #垂直线, #水平线))
        4.置字体尺寸 (1, 总行数, 5, 32)
        真.打印 (“贷款管理”)
    .否则
        信息框 (“读入报表模板失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
    .如果结束
    
.判断 (等于 (.现行子夹, 2)) ' 形态调整日报表
    .如果 (相加 (取运行目录 (), “\report\日终形态调整.grd”).从文件读 ())
        2.置文本 (1, 相加 (“单位：”, 信用社名称))
        2.置文本 (3, 处理日期 (时间到文本 (总控时间, #日期部分)))
        赋值 (当前行号, 0)
        赋值 (总行数, 取表项数 ())
        .如果真 (小于 (总行数, 1))
            返回 ()
        .如果真结束
        .判断循环首 (小于 (当前行号, 总行数))
            .添加行 ()
            相加 (当前行号, 5).置文本 (1, 当前行号.取标题 (0))
            相加 (当前行号, 5).置文本 (2, 当前行号.取标题 (1))
            相加 (当前行号, 5).置文本 (3, 当前行号.取标题 (2))
            相加 (当前行号, 5).置文本 (4, 当前行号.取标题 (3))
            相加 (当前行号, 5).置文本 (5, 当前行号.取标题 (4))
            相加 (当前行号, 5).置文本 (6, 当前行号.取标题 (5))
            赋值 (当前行号, 相加 (当前行号, 1))
        .判断循环尾 ()
        5.置对齐方式 (1, 总行数, 6, #中左)
        5.加线条 (1, 总行数, 6, 相加 (#左边框, #右边框, #上边框, #下边框, #垂直线, #水平线))
        5.置字体尺寸 (1, 总行数, 6, 32)
        真.打印 (“贷款管理”)
    .否则
        信息框 (“读入报表模板失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
    .如果结束
    
.判断 (等于 (.现行子夹, 3)) ' 凭证领用及使用日报表
    .如果 (相加 (取运行目录 (), “\report\日终凭证领用.grd”).从文件读 ())
        2.置文本 (1, 相加 (“单位：”, 信用社名称))
        2.置文本 (2, 处理日期 (时间到文本 (总控时间, #日期部分)))
        赋值 (当前行号, 0)
        赋值 (总行数, 取表项数 ())
        .如果真 (大于 (总行数, 0))
            .判断循环首 (小于 (当前行号, 总行数))
                .添加行 ()
                相加 (当前行号, 4).置文本 (1, 当前行号.取标题 (0))
                相加 (当前行号, 4).置文本 (2, 当前行号.取标题 (1))
                相加 (当前行号, 4).置文本 (3, 当前行号.取标题 (2))
                赋值 (当前行号, 相加 (当前行号, 1))
            .判断循环尾 ()
            4.置对齐方式 (1, 总行数, 6, #中中)
            4.加线条 (1, 总行数, 3, 相加 (#左边框, #右边框, #上边框, #下边框, #垂直线, #水平线))
        .如果真结束
        2.添加行 ()
        相加 (4, 当前行号).合并 (1, 1, 3)
        相加 (4, 当前行号).置文本 (1, .标题)
        赋值 (当前行号, 相加 (当前行号, 1))
        相加 (4, 当前行号).合并 (1, 1, 3)
        相加 (4, 当前行号).置文本 (1, .标题)
        相加 (4, 当前行号).置对齐方式 (1, 2, 1, #中左)
        4.置字体尺寸 (1, 相加 (总行数, 2), 3, 32)
        真.打印 (“贷款管理”)
    .否则
        信息框 (“读入报表模板失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
    .如果结束
    
.判断 (等于 (.现行子夹, 4)) ' 日科目余额表
    .如果 (相加 (取运行目录 (), “\report\日终科目余额.grd”).从文件读 ())
        1.置文本 (1, “科目余额日报(当日发生)”)
        2.置文本 (1, 相加 (“单位：”, 信用社名称))
        2.置文本 (4, 处理日期 (时间到文本 (总控时间, #日期部分)))
        赋值 (当前行号, 0)
        赋值 (总行数, 取表项数 ())
        .如果真 (小于 (总行数, 1))
            返回 ()
        .如果真结束
        .判断循环首 (小于 (当前行号, 总行数))
            .添加行 ()
            相加 (当前行号, 4).置文本 (1, 当前行号.取标题 (0))
            相加 (当前行号, 4).置文本 (2, 当前行号.取标题 (1))
            相加 (当前行号, 4).置文本 (3, 当前行号.取标题 (2))
            相加 (当前行号, 4).置文本 (4, 当前行号.取标题 (3))
            相加 (当前行号, 4).置文本 (5, 当前行号.取标题 (4))
            相加 (当前行号, 4).置文本 (6, 当前行号.取标题 (5))
            赋值 (当前行号, 相加 (当前行号, 1))
        .判断循环尾 ()
        4.置对齐方式 (1, 总行数, 2, #中左)
        4.置对齐方式 (3, 总行数, 4, #中右)
        4.加线条 (1, 总行数, 6, 相加 (#左边框, #右边框, #上边框, #下边框, #垂直线, #水平线))
        4.置字体尺寸 (1, 总行数, 6, 32)
        真.打印 (“贷款管理”)
    .否则
        信息框 (“读入报表模板失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
    .如果结束
    
.默认
     ' 年科目余额日报
    .如果 (相加 (取运行目录 (), “\report\日终科目余额.grd”).从文件读 ())
        1.置文本 (1, “科目余额日报(本年累计)”)
        2.置文本 (1, 相加 (“单位：”, 信用社名称))
        2.置文本 (4, 处理日期 (时间到文本 (总控时间, #日期部分)))
        3.置文本 (3, “年初余额”)
        3.置文本 (4, “本年借款发生额”)
        3.置文本 (5, “本年贷款发生额”)
        3.置文本 (6, “期末余额”)
        赋值 (当前行号, 0)
        赋值 (总行数, 取表项数 ())
        .如果真 (小于 (总行数, 1))
            返回 ()
        .如果真结束
        .判断循环首 (小于 (当前行号, 总行数))
            .添加行 ()
            相加 (当前行号, 4).置文本 (1, 当前行号.取标题 (0))
            相加 (当前行号, 4).置文本 (2, 当前行号.取标题 (1))
            相加 (当前行号, 4).置文本 (3, 当前行号.取标题 (2))
            相加 (当前行号, 4).置文本 (4, 当前行号.取标题 (3))
            相加 (当前行号, 4).置文本 (5, 当前行号.取标题 (4))
            相加 (当前行号, 4).置文本 (6, 当前行号.取标题 (5))
            赋值 (当前行号, 相加 (当前行号, 1))
        .判断循环尾 ()
        4.置对齐方式 (1, 总行数, 2, #中左)
        4.置对齐方式 (3, 总行数, 4, #中右)
        4.加线条 (1, 总行数, 6, 相加 (#左边框, #右边框, #上边框, #下边框, #垂直线, #水平线))
        4.置字体尺寸 (1, 总行数, 6, 32)
        真.打印 (“贷款管理”)
    .否则
        信息框 (“读入报表模板失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
    .如果结束
    
.判断结束


.窗口程序集 贷款发放情况查询窗口程序集, , , 

.程序集变量 查询项目, 文本型, , , 
.程序集变量 前附加符, 文本型, , , 
.程序集变量 后附加符, 文本型, , , 
.程序集变量 查询语句内容, 文本型, , , 
.程序集变量 查询语句列表1, 文本型, , "0", 
.程序集变量 查询语句列表2, 文本型, , "0", 
.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _全部按钮_被单击, 空白型, , 
赋值 (.现行选中项, -1)
.判断开始 (等于 (.选中, 真)) ' 查询贷款发放情况
    “select lsh,name,ydje,jkye,jkr,dqr,jkxts,jkyt,dkzhl,hxqk,km,jbr,spr from dk_base”.未知支持库函数_14 (1)
    显示查询结果 ()
    未知支持库函数_16 ()
.判断 (等于 (.选中, 真)) ' 查询贷款余额
    “select lsh,name,ydje,jkye,jkr,dqr,jkxts,jkyt,dkzhl,hxqk,km,jbr,spr from dk_base where jlzht='1'”.未知支持库函数_14 (1)
    显示查询结果 ()
    未知支持库函数_16 ()
.默认
     ' 查询贷款历史记录
    “select lsh,name,ydje,jkye,jkr,dqr,jkxts,jkyt,dkzhl,hxqk,km,jbr,spr from dk_base where jlzht='0'”.未知支持库函数_14 (1)
    显示查询结果 ()
    未知支持库函数_16 ()
.判断结束
赋值 (查询语句内容, “select lsh,name,ydje,jkye,jkr,dqr,jkxts,jkyt,dkzhl,hxqk,km,jbr,spr from dk_base where 1=1”)

.子程序 _贷款发放情况查询窗口_创建完毕, 空白型, , 连接数据库，初始化窗口
.局部变量 读入文本变量, 文本型, , , 

赋值 (贷款发放情况查询窗口., 相减 (相加 (贷款发放情况查询窗口., 456), 贷款发放情况查询窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
.未知支持库函数_12 ()
“select l11 from dk_chxshj”.未知支持库函数_14 (1)
未知支持库函数_34 ()
.判断循环首 (等于 (., 假))
    “l11”.未知支持库函数_26 (读入文本变量)
    读入文本变量.加入项目 ()
    未知支持库函数_36 ()
.判断循环尾 ()
未知支持库函数_16 ()
赋值 (.内容, “”)
赋值 (.内容, “select lsh,name,ydje,jkye,jkr,dqr,jkxts,jkyt,dkzhl,hxqk,km,jbr,spr from dk_base where”)

.子程序 _贷款发放情况查询窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()

.子程序 _查询项目组合框_列表项被选择, 空白型, , 
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入文本长度, 整数型, , , 
.局部变量 临时变量, 整数型, , , 
.局部变量 文本变量, 文本型, , , 
.局部变量 文本变量2, 文本型, , , 
.局部变量 文本变量3, 文本型, , , 

.如果真 (不等于 (.现行选中项, -1))
    相加 (“select * from dk_chxshj where l11='”, .内容, “'”).未知支持库函数_14 (1)
    .如果真 (未知支持库函数_34 ())
        “l12”.未知支持库函数_26 (查询项目)
        “l22”.未知支持库函数_26 (读入文本变量)
        赋值 (读入文本长度, 取文本长度 (读入文本变量))
        赋值 (临时变量, 1)
        赋值 (文本变量, “”)
        清空 ()
        .判断循环首 (小于或等于 (临时变量, 读入文本长度))
            赋值 (文本变量2, 取文本中间 (读入文本变量, 临时变量, 1))
            .如果 (等于 (文本变量2, “,”))
                文本变量.加入项目 ()
                赋值 (文本变量, “”)
            .否则
                赋值 (文本变量, 相加 (文本变量, 文本变量2))
            .如果结束
            赋值 (临时变量, 相加 (临时变量, 1))
        .判断循环尾 ()
        文本变量.加入项目 ()
        “l31”.未知支持库函数_26 (前附加符)
        “l32”.未知支持库函数_26 (后附加符)
        “l4”.未知支持库函数_26 (读入文本变量)
        赋值 (文本变量, 取文本左边 (读入文本变量, 1))
        .判断开始 (等于 (文本变量, “#”)) ' 输入控件为编辑框
            赋值 (.可视, 真)
            赋值 (.可视, 假)
            赋值 (.内容, “”)
            赋值 (文本变量2, 取文本右边 (读入文本变量, 1))
            .判断开始 (等于 (文本变量2, “o”)) ' 输入内容为整数文本
                赋值 (.输入方式, 3)
            .判断 (等于 (文本变量2, “c”)) ' 输入内容为通常方式
                赋值 (.输入方式, 0)
            .判断 (等于 (文本变量2, “f”)) ' 输入内容为浮点数
                赋值 (.输入方式, 10)
            .判断 (等于 (文本变量2, “t”)) ' 输入内容为日期
                赋值 (.输入方式, 11)
            .默认
                
            .判断结束
            
        .判断 (等于 (文本变量, “*”)) ' 输入控件为下拉列表框,列表内容从读入文本中读入
            赋值 (.可视, 假)
            赋值 (.可视, 真)
            赋值 (.内容, “”)
            清空 ()
            赋值 (临时变量, 2)
            赋值 (文本变量2, “”)
            赋值 (读入文本长度, 取文本长度 (读入文本变量))
            .判断循环首 (小于或等于 (临时变量, 读入文本长度))
                赋值 (文本变量3, 取文本中间 (读入文本变量, 临时变量, 1))
                .如果 (等于 (文本变量3, “,”))
                    文本变量2.加入项目 ()
                    赋值 (文本变量2, “”)
                .否则
                    赋值 (文本变量2, 相加 (文本变量2, 文本变量3))
                .如果结束
                赋值 (临时变量, 相加 (临时变量, 1))
            .判断循环尾 ()
            文本变量2.加入项目 ()
        .默认
             ' 输入控件为下拉列表框,列表内容从其它表中读入
            赋值 (.可视, 假)
            赋值 (.可视, 真)
            赋值 (.内容, “”)
            清空 ()
            “l41”.未知支持库函数_26 (文本变量2)
            相加 (“select ”, 文本变量2, “ from ”, 取文本右边 (读入文本变量, 相减 (取文本长度 (读入文本变量), 1))).未知支持库函数_14 (1)
            .如果真 (未知支持库函数_34 ())
                .判断循环首 (等于 (., 假))
                    文本变量2.未知支持库函数_26 (文本变量3)
                    文本变量3.加入项目 ()
                    未知支持库函数_36 ()
                .判断循环尾 ()
            .如果真结束
            未知支持库函数_16 ()
        .判断结束
        
    .如果真结束
    未知支持库函数_16 ()
.如果真结束


.子程序 _并且按钮_被单击, 空白型, , 
“ and”.加入文本 ()
“ and”.加入文本 ()
加入成员 (查询语句列表1, “ and”)
加入成员 (查询语句列表2, “ and”)
赋值 (.禁止, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 真)

.子程序 _重置按钮_被单击, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “select lsh,name,ydje,jkye,jkr,dqr,jkxts,jkyt,dkzhl,hxqk,km,jbr,spr from dk_base where”)
清除数组 (查询语句列表1)
清除数组 (查询语句列表2)
赋值 (.禁止, 假)
赋值 (.禁止, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 真)
赋值 (.禁止, 真)

.子程序 _添加按钮_被单击, 空白型, , 添加查询条件
.局部变量 文本变量, 文本型, , , 

.如果 (等于 (.可视, 真))
    赋值 (文本变量, .内容)
    .如果真 (等于 (.输入方式, 11)) ' 如果输入类型为日期型则到日期格式进行预处理
        赋值 (文本变量, 处理日期 (文本变量))
    .如果真结束
    
.否则
    赋值 (文本变量, .内容)
.如果结束
.如果真 (或者 (等于 (文本变量, “”), 等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“请将查询条件输入完整！”, 相加 (#错误图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.如果真 (不等于 (取文本右边 (.内容, 1), “(”))
    “ ”.加入文本 ()
    “ ”.加入文本 ()
    加入成员 (查询语句列表1, “ ”)
    加入成员 (查询语句列表2, “ ”)
.如果真结束
相加 (.内容, “ ”, .内容, “ ”, 前附加符, 文本变量, 后附加符).加入文本 ()
相加 (查询项目, “ ”, .内容, “ ”, 前附加符, 文本变量, 后附加符).加入文本 ()
加入成员 (查询语句列表1, 相加 (.内容, “ ”, .内容, “ ”, 前附加符, 文本变量, 后附加符))
加入成员 (查询语句列表2, 相加 (查询项目, “ ”, .内容, “ ”, 前附加符, 文本变量, 后附加符))
赋值 (.禁止, 真)
赋值 (.禁止, 假)
赋值 (.禁止, 假)

.子程序 _或者按钮_被单击, 空白型, , 
“ or”.加入文本 ()
“ or”.加入文本 ()
加入成员 (查询语句列表1, “ or”)
加入成员 (查询语句列表2, “ or”)
赋值 (.禁止, 假)
赋值 (.禁止, 真)
赋值 (.禁止, 真)

.子程序 _左括号按钮_被单击, 空白型, , 
“ (”.加入文本 ()
“ (”.加入文本 ()
加入成员 (查询语句列表1, “ (”)
加入成员 (查询语句列表2, “ (”)
赋值 (.禁止, 真)
赋值 (.禁止, 假)

.子程序 _右括号按钮_被单击, 空白型, , 
“)”.加入文本 ()
“)”.加入文本 ()
加入成员 (查询语句列表1, “)”)
加入成员 (查询语句列表2, “)”)
赋值 (.禁止, 假)
赋值 (.禁止, 真)

.子程序 显示查询结果, 空白型, , 在查询列表中显示查询出的数据
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入双精度变量, 双精度小数型, , , 
.局部变量 读入日期变量, 日期时间型, , , 
.局部变量 插入位置, 整数型, , , 
.局部变量 记录数量, 整数型, , , 
.局部变量 金额总计, 双精度小数型, , , 
.局部变量 余额总计, 双精度小数型, , , 

全部删除 ()
赋值 (记录数量, 0)
赋值 (金额总计, 0)
赋值 (余额总计, 0)
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        赋值 (记录数量, 相加 (记录数量, 1))
        “km”.未知支持库函数_26 (读入文本变量)
        赋值 (插入位置, .插入表项 (读入文本变量, , , , ))
        “lsh”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (1, 读入文本变量)
        “name”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (2, 读入文本变量)
        “ydje”.未知支持库函数_27 (读入双精度变量)
        插入位置.置标题 (3, 到文本 (读入双精度变量))
        赋值 (金额总计, 相加 (金额总计, 读入双精度变量))
        “jkye”.未知支持库函数_27 (读入双精度变量)
        插入位置.置标题 (4, 到文本 (读入双精度变量))
        赋值 (余额总计, 相加 (余额总计, 读入双精度变量))
        “jkr”.未知支持库函数_31 (读入日期变量)
        插入位置.置标题 (5, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        “dqr”.未知支持库函数_31 (读入日期变量)
        插入位置.置标题 (6, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        “jkyt”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (7, 读入文本变量)
        “dkzhl”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (8, 读入文本变量)
        “jkxts”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (9, 读入文本变量)
        “hxqk”.未知支持库函数_31 (读入日期变量)
        插入位置.置标题 (10, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        “spr”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (11, 读入文本变量)
        “jbr”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (12, 读入文本变量)
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
赋值 (.标题, 相加 (“查询结果：共计”, 到文本 (记录数量), “笔，原贷金额总计”, 到文本 (金额总计), “元，借款余额总计”, 到文本 (余额总计), “元”))

.子程序 _查询按钮_被单击, 空白型, , 
赋值 (.现行选中项, -1)
.如果真 (等于 (.内容, “”))
    信息框 (“请输入查询条件！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
.判断开始 (等于 (.选中, 真)) ' 查询贷款发放情况
    .如果真 (等于 (.未知支持库函数_14 (.内容, 1), 假))
        信息框 (“查询条件输入有误！”, 相加 (#信息图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    赋值 (查询语句内容, .内容)
    显示查询结果 ()
    未知支持库函数_16 ()
.判断 (等于 (.选中, 真)) ' 查询贷款余额
    .如果真 (等于 (相加 (.内容, “ and jlzht='1'”).未知支持库函数_14 (1), 假))
        信息框 (“查询条件输入有误！”, 相加 (#信息图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    赋值 (查询语句内容, .内容)
    显示查询结果 ()
    未知支持库函数_16 ()
.默认
     ' 查询贷款历史记录
    .如果真 (等于 (相加 (.内容, “ and jlzht='0'”).未知支持库函数_14 (1), 假))
        信息框 (“查询条件输入有误！”, 相加 (#信息图标, #确认钮), “提示信息”)
        返回 ()
    .如果真结束
    赋值 (查询语句内容, .内容)
    显示查询结果 ()
    未知支持库函数_16 ()
.判断结束


.子程序 _排序字段组合框_列表项被选择, 空白型, , 
.局部变量 排序字段, 文本型, , , 

赋值 (排序字段, “ order by ”)
.判断开始 (或者 (等于 (.现行选中项, -1), 等于 (.现行选中项, 0)))
    赋值 (排序字段, “”)
.判断 (等于 (.现行选中项, 1))
    赋值 (排序字段, 相加 (排序字段, “km”))
.判断 (等于 (.现行选中项, 2))
    赋值 (排序字段, 相加 (排序字段, “name”))
.判断 (等于 (.现行选中项, 3))
    赋值 (排序字段, 相加 (排序字段, “ydje”))
.判断 (等于 (.现行选中项, 4))
    赋值 (排序字段, 相加 (排序字段, “jkye”))
.判断 (等于 (.现行选中项, 5))
    赋值 (排序字段, 相加 (排序字段, “jkr”))
.判断 (等于 (.现行选中项, 6))
    赋值 (排序字段, 相加 (排序字段, “dqr”))
.判断 (等于 (.现行选中项, 7))
    赋值 (排序字段, 相加 (排序字段, “dkzhl”))
.判断 (等于 (.现行选中项, 8))
    赋值 (排序字段, 相加 (排序字段, “jkxts”))
.默认
    
.判断结束
.如果真 (大于 (取表项数 (), 0))
    .判断开始 (等于 (.选中, 真)) ' 查询贷款发放情况
        .如果真 (等于 (相加 (查询语句内容, 排序字段).未知支持库函数_14 (1), 假))
            信息框 (“查询条件输入有误！”, 相加 (#信息图标, #确认钮), “提示信息”)
            返回 ()
        .如果真结束
        显示查询结果 ()
        未知支持库函数_16 ()
    .判断 (等于 (.选中, 真)) ' 查询贷款余额
        .如果真 (等于 (相加 (查询语句内容, “ and jlzht='1'”, 排序字段).未知支持库函数_14 (1), 假))
            信息框 (“查询条件输入有误！”, 相加 (#信息图标, #确认钮), “提示信息”)
            返回 ()
        .如果真结束
        显示查询结果 ()
        未知支持库函数_16 ()
    .默认
         ' 查询贷款历史记录
        .如果真 (等于 (相加 (查询语句内容, “ and jlzht='0'”, 排序字段).未知支持库函数_14 (1), 假))
            信息框 (“查询条件输入有误！”, 相加 (#信息图标, #确认钮), “提示信息”)
            返回 ()
        .如果真结束
        显示查询结果 ()
        未知支持库函数_16 ()
    .判断结束
    
.如果真结束


.子程序 _打印预览按钮_被单击, 空白型, , 打印贷款记录
.如果真 (读取打印数据 ())
    打印预览 ()
.如果真结束


.子程序 读取打印数据, 逻辑型, , 将打印数据读入打印报表内
.局部变量 记录数量, 整数型, , , 
.局部变量 临时变量, 整数型, , , 

赋值 (记录数量, 取表项数 ())
.如果真 (小于 (记录数量, 1)) ' 无记录
    返回 (假)
.如果真结束
.如果真 (等于 (相加 (取运行目录 (), “\report\贷款情况.grd”).从文件读 (), 假))
    信息框 (“载入打印模板时失败！”, 相加 (#错误图标, #确认钮), “提示信息”)
    返回 (假)
.如果真结束
赋值 (临时变量, 0)
.判断循环首 (小于 (临时变量, 记录数量))
    .添加行 ()
    相加 (4, 临时变量).置文本 (1, 临时变量.取标题 (0))
    相加 (4, 临时变量).置文本 (2, 临时变量.取标题 (1))
    相加 (4, 临时变量).置文本 (3, 临时变量.取标题 (2))
    相加 (4, 临时变量).置文本 (4, 临时变量.取标题 (3))
    相加 (4, 临时变量).置文本 (5, 临时变量.取标题 (4))
    相加 (4, 临时变量).置文本 (6, 临时变量.取标题 (5))
    相加 (4, 临时变量).置文本 (7, 临时变量.取标题 (6))
    相加 (4, 临时变量).置文本 (8, 临时变量.取标题 (8))
    相加 (4, 临时变量).置文本 (9, 临时变量.取标题 (9))
    相加 (4, 临时变量).置文本 (10, 临时变量.取标题 (11))
    相加 (4, 临时变量).置文本 (11, 临时变量.取标题 (12))
    赋值 (临时变量, 相加 (临时变量, 1))
.判断循环尾 ()
4.置对齐方式 (1, 记录数量, 3, #中左)
4.置对齐方式 (4, 记录数量, 2, #中右)
4.置对齐方式 (6, 记录数量, 6, #中左)
4.置字体尺寸 (1, 记录数量, 11, 32)
4.加线条 (1, 记录数量, 11, 相加 (#左边框, #右边框, #上边框, #下边框, #水平线, #垂直线))
.添加行 ()
相加 (4, 临时变量).合并 (1, 1, 11)
相加 (4, 临时变量).置对齐方式 (1, 1, 1, #中左)
相加 (4, 临时变量).置文本 (1, .标题)
2.置文本 (1, 相加 (“单位名称：”, 信用社名称))
2.置文本 (5, 处理日期 (时间到文本 (总控时间, #日期部分)))
.判断开始 (等于 (.选中, 真)) ' 查询贷款发放情况
    1.置文本 (1, “贷款发放情况查询”)
.判断 (等于 (.选中, 真)) ' 查询贷款余额
    1.置文本 (1, “贷款余额查询”)
.默认
     ' 查询贷款历史记录
    1.置文本 (1, “贷款历史记录查询”)
.判断结束
返回 (真)

.子程序 _打印按钮_被单击, 空白型, , 
.如果真 (读取打印数据 ())
    真.打印 (“贷款情况”)
.如果真结束


.子程序 _详细资料按钮_被单击, 空白型, , 
.如果真 (不等于 (., -1))
    赋值 (贷款流水号, .取标题 (., 1))
    载入 (贷款详细资料窗口, , 真)
.如果真结束


.子程序 _撤消按钮_被单击, 空白型, , 撤消一项查询条件
.局部变量 总数, 整数型, , , 
.局部变量 临时变量, 整数型, , , 

.如果真 (大于 (取数组成员数 (查询语句列表1), 0))
    .如果真 (等于 (查询语句列表1 [取数组成员数 (查询语句列表1)], “ (”))
        赋值 (.禁止, 假)
        赋值 (.禁止, 真)
    .如果真结束
    .如果真 (等于 (查询语句列表1 [取数组成员数 (查询语句列表1)], “)”))
        赋值 (.禁止, 真)
        赋值 (.禁止, 假)
    .如果真结束
    删除成员 (查询语句列表1, 取数组成员数 (查询语句列表1), )
    删除成员 (查询语句列表2, 取数组成员数 (查询语句列表2), )
    .如果真 (大于 (取数组成员数 (查询语句列表1), 0))
        .如果真 (等于 (查询语句列表1 [取数组成员数 (查询语句列表1)], “ ”))
            删除成员 (查询语句列表1, 取数组成员数 (查询语句列表1), )
            删除成员 (查询语句列表2, 取数组成员数 (查询语句列表2), )
        .如果真结束
        
    .如果真结束
    .如果真 (大于 (取数组成员数 (查询语句列表1), 0))
        .如果真 (或者 (等于 (查询语句列表1 [取数组成员数 (查询语句列表1)], “ or”), 等于 (查询语句列表1 [取数组成员数 (查询语句列表1)], “ and”)))
            删除成员 (查询语句列表1, 取数组成员数 (查询语句列表1), )
            删除成员 (查询语句列表2, 取数组成员数 (查询语句列表2), )
        .如果真结束
        
    .如果真结束
    .如果 (大于 (取数组成员数 (查询语句列表1), 0))
        .如果 (或者 (等于 (查询语句列表1 [取数组成员数 (查询语句列表1)], “ and”), 等于 (查询语句列表1 [取数组成员数 (查询语句列表1)], “ or”), 等于 (查询语句列表1 [取数组成员数 (查询语句列表1)], “ (”)))
            赋值 (.禁止, 假)
            赋值 (.禁止, 真)
            赋值 (.禁止, 真)
        .否则
            赋值 (.禁止, 真)
            赋值 (.禁止, 假)
            赋值 (.禁止, 假)
        .如果结束
        
    .否则
        赋值 (.禁止, 假)
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
    .如果结束
    赋值 (.内容, “”)
    赋值 (.内容, “select lsh,name,ydje,jkye,jkr,dqr,jkxts,jkyt,dkzhl,hxqk,km,jbr,spr from dk_base where”)
    赋值 (总数, 取数组成员数 (查询语句列表1))
    赋值 (临时变量, 1)
    .判断循环首 (小于或等于 (临时变量, 总数))
        查询语句列表1.加入文本 ( [临时变量])
        查询语句列表2.加入文本 ( [临时变量])
        赋值 (临时变量, 相加 (临时变量, 1))
    .判断循环尾 ()
.如果真结束


.窗口程序集 贷款详细资料窗口程序集, , , 显示单笔贷款详细资料

.子程序 _贷款详细资料窗口_创建完毕, 空白型, , 
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入双精度变量, 双精度小数型, , , 
.局部变量 读入日期变量, 日期时间型, , , 
.局部变量 读入整数变量, 整数型, , , 
.局部变量 临时变量, 整数型, , , 

 ' 贷款详细资料窗口.高度 ＝ 贷款详细资料窗口.高度 ＋ 315 － 贷款详细资料窗口.取用户区高度 ()
相加 (取运行目录 (), “\report\贷款详细资料.grd”).从文件读 ()
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
相加 (“select * from dk_base where lsh='”, 贷款流水号, “'”).未知支持库函数_14 (1)
.如果真 (未知支持库函数_34 ())
    “km”.未知支持库函数_26 (读入文本变量)
    3.置文本 (2, 读入文本变量)
    “lsh”.未知支持库函数_26 (读入文本变量)
    3.置文本 (4, 读入文本变量)
    “name”.未知支持库函数_26 (读入文本变量)
    4.置文本 (2, 读入文本变量)
    “cz”.未知支持库函数_26 (读入文本变量)
    5.置文本 (2, 读入文本变量)
    “jjbh”.未知支持库函数_26 (读入文本变量)
    5.置文本 (4, 读入文本变量)
    “ydje”.未知支持库函数_27 (读入双精度变量)
    6.置文本 (2, 到文本 (读入双精度变量))
    “jkye”.未知支持库函数_27 (读入双精度变量)
    6.置文本 (4, 到文本 (读入双精度变量))
    “ghbj”.未知支持库函数_27 (读入双精度变量)
    7.置文本 (2, 到文本 (读入双精度变量))
    “lxje”.未知支持库函数_27 (读入双精度变量)
    7.置文本 (4, 到文本 (读入双精度变量))
    “jkr”.未知支持库函数_31 (读入日期变量)
    8.置文本 (2, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
    “dqr”.未知支持库函数_31 (读入日期变量)
    8.置文本 (4, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
    “qx”.未知支持库函数_26 (读入文本变量)
    9.置文本 (2, 读入文本变量)
    “hxqk”.未知支持库函数_31 (读入日期变量)
    9.置文本 (4, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
    “ll”.未知支持库函数_27 (读入双精度变量)
    10.置文本 (2, 到文本 (读入双精度变量))
    “dkzhl”.未知支持库函数_26 (读入文本变量)
    10.置文本 (4, 读入文本变量)
    “zhqtsh”.未知支持库函数_29 (读入整数变量)
    11.置文本 (2, 到文本 (读入整数变量))
    “jkxts”.未知支持库函数_26 (读入文本变量)
    11.置文本 (4, 读入文本变量)
    “jkyt”.未知支持库函数_26 (读入文本变量)
    12.置文本 (2, 读入文本变量)
    “jkxtw”.未知支持库函数_26 (读入文本变量)
    13.置文本 (2, 读入文本变量)
    “yqtsh”.未知支持库函数_29 (读入整数变量)
    .如果真 (小于 (读入整数变量, 0))
        赋值 (读入整数变量, 0)
    .如果真结束
    13.置文本 (4, 到文本 (读入整数变量))
    “spr”.未知支持库函数_26 (读入文本变量)
    14.置文本 (2, 读入文本变量)
    “jbr”.未知支持库函数_26 (读入文本变量)
    14.置文本 (4, 读入文本变量)
    未知支持库函数_16 ()
    相加 (“select * from dk_gh where lsh='”, 贷款流水号, “' order by rzhrq”).未知支持库函数_14 (1)
    .如果真 (未知支持库函数_34 ())
        赋值 (临时变量, 17)
        .判断循环首 (等于 (., 假))
            .添加行 ()
            “ghbj”.未知支持库函数_27 (读入双精度变量)
            临时变量.置文本 (1, 到文本 (读入双精度变量))
            “ghlx”.未知支持库函数_27 (读入双精度变量)
            临时变量.置文本 (2, 到文本 (读入双精度变量))
            “hxqk”.未知支持库函数_31 (读入日期变量)
            临时变量.置文本 (3, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
            “rzhrq”.未知支持库函数_31 (读入日期变量)
            临时变量.置文本 (4, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
            赋值 (临时变量, 相加 (临时变量, 1))
            未知支持库函数_36 ()
        .判断循环尾 ()
        17.置字体尺寸 (1, ., 4, 42)
        17.置对齐方式 (1, ., 2, #中右)
        17.置对齐方式 (3, ., 2, #中中)
        17.置行高 (., 80)
        17.加线条 (1, ., 4, 相加 (#下边框, #上边框, #左边框, #右边框, #水平线, #垂直线))
    .如果真结束
    
.如果真结束
未知支持库函数_16 ()

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _贷款详细资料窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()

.子程序 _按钮3_被单击, 空白型, , 
打印预览 ()

.子程序 _按钮1_被单击, 空白型, , 
真.打印 (“贷款详细资料”)

.窗口程序集 每日提示窗口程序集, , , 

.子程序 _每日提示窗口_创建完毕, 空白型, , 
赋值 (每日提示窗口., 相减 (相加 (每日提示窗口., 328), 每日提示窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
相加 (“update dk_base set yqtsh =#”, 处理日期 (时间到文本 (总控时间, #日期部分)), “#-dqr+zhqtsh where jlzht='1'”).未知支持库函数_4 ()
.如果真 (“select lsh,name,ydje,jkye,jkr,dqr,jkxts,jkyt,dkzhl,hxqk,km,jbr,spr,yqtsh from dk_base where jlzht='1' and yqtsh>=-10 and yqtsh<0 order by dqr”.未知支持库函数_14 (1))
    显示即将到期贷款 ()
    未知支持库函数_16 ()
.如果真结束
.如果真 (“select lsh,name,ydje,jkye,jkr,dqr,jkxts,jkyt,dkzhl,hxqk,km,jbr,spr,yqtsh from dk_base where jlzht='1' and yqtsh>=0 order by dqr”.未知支持库函数_14 (1))
    显示逾期贷款 ()
    未知支持库函数_16 ()
.如果真结束


.子程序 显示即将到期贷款, 空白型, , 在查询列表中显示查询出的数据
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入双精度变量, 双精度小数型, , , 
.局部变量 读入日期变量, 日期时间型, , , 
.局部变量 读入整数变量, 整数型, , , 
.局部变量 插入位置, 整数型, , , 

全部删除 ()
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “km”.未知支持库函数_26 (读入文本变量)
        赋值 (插入位置, .插入表项 (读入文本变量, , , , ))
        “lsh”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (1, 读入文本变量)
        “name”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (2, 读入文本变量)
        “ydje”.未知支持库函数_27 (读入双精度变量)
        插入位置.置标题 (3, 到文本 (读入双精度变量))
        “jkye”.未知支持库函数_27 (读入双精度变量)
        插入位置.置标题 (4, 到文本 (读入双精度变量))
        “jkr”.未知支持库函数_31 (读入日期变量)
        插入位置.置标题 (5, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        “dqr”.未知支持库函数_31 (读入日期变量)
        插入位置.置标题 (6, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        “jkyt”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (7, 读入文本变量)
        “dkzhl”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (8, 读入文本变量)
        “jkxts”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (9, 读入文本变量)
        “yqtsh”.未知支持库函数_29 (读入整数变量)
        插入位置.置标题 (10, 到文本 (读入整数变量))
        “spr”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (11, 读入文本变量)
        “jbr”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (12, 读入文本变量)
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束


.子程序 显示逾期贷款, 空白型, , 在查询列表中显示查询出的数据
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入双精度变量, 双精度小数型, , , 
.局部变量 读入日期变量, 日期时间型, , , 
.局部变量 插入位置, 整数型, , , 

全部删除 ()
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “km”.未知支持库函数_26 (读入文本变量)
        赋值 (插入位置, .插入表项 (读入文本变量, , , , ))
        “lsh”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (1, 读入文本变量)
        “name”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (2, 读入文本变量)
        “ydje”.未知支持库函数_27 (读入双精度变量)
        插入位置.置标题 (3, 到文本 (读入双精度变量))
        “jkye”.未知支持库函数_27 (读入双精度变量)
        插入位置.置标题 (4, 到文本 (读入双精度变量))
        “jkr”.未知支持库函数_31 (读入日期变量)
        插入位置.置标题 (5, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        “dqr”.未知支持库函数_31 (读入日期变量)
        插入位置.置标题 (6, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        “jkyt”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (7, 读入文本变量)
        “dkzhl”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (8, 读入文本变量)
        “jkxts”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (9, 读入文本变量)
        “hxqk”.未知支持库函数_31 (读入日期变量)
        插入位置.置标题 (10, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        “spr”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (11, 读入文本变量)
        “jbr”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (12, 读入文本变量)
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束


.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _每日提示窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()

.子程序 _详细资料按钮_被单击, 空白型, , 
.如果 (等于 (.现行子夹, 0))
    .如果真 (不等于 (., -1))
        赋值 (贷款流水号, .取标题 (., 1))
        载入 (贷款详细资料窗口, , 真)
    .如果真结束
    
.否则
    .如果真 (不等于 (., -1))
        赋值 (贷款流水号, .取标题 (., 1))
        载入 (贷款详细资料窗口, , 真)
    .如果真结束
    
.如果结束


.窗口程序集 贷款余额前十户窗口程序集, , , 

.子程序 _贷款余额前十户窗口_创建完毕, 空白型, , 
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入双精度变量, 双精度小数型, , , 
.局部变量 临时变量, 整数型, , , 

 ' 贷款余额前十户窗口.高度 ＝ 贷款余额前十户窗口.高度 ＋ 295 － 贷款余额前十户窗口.取用户区高度 ()
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“连接数据库失败，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
“SELECT DISTINCTROW dk_base.jkrbh, dk_base.name, Sum(dk_base.jkye) AS ye FROM dk_base GROUP BY dk_base.jkrbh, dk_base.name order by sum(dk_base.jkye) desc”.未知支持库函数_14 (1)
相加 (取运行目录 (), “\report\前十户.grd”).从文件读 ()
.如果真 (未知支持库函数_34 ())
    赋值 (临时变量, 4)
    .判断循环首 (并且 (等于 (., 假), 小于 (临时变量, 14)))
        “name”.未知支持库函数_26 (读入文本变量)
        “ye”.未知支持库函数_27 (读入双精度变量)
        临时变量.置文本 (2, 读入文本变量)
        临时变量.置文本 (3, 到文本 (读入双精度变量))
        赋值 (临时变量, 相加 (临时变量, 1))
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()
未知支持库函数_3 ()

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _打印预览按钮_被单击, 空白型, , 
打印预览 ()

.子程序 _打印按钮_被单击, 空白型, , 
真.打印 (“贷款余额前十户”)

.窗口程序集 贷款归还记录窗口程序集, , , 

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _贷款归还记录窗口_创建完毕, 空白型, , 
赋值 (贷款归还记录窗口., 相减 (相加 (贷款归还记录窗口., 275), 贷款归还记录窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
“SELECT dk_gh.lsh, dk_gh.hxqk, dk_gh.ghbj, dk_gh.ghlx, dk_gh.rzhrq, dk_gh.km, dk_base.name FROM dk_gh INNER JOIN dk_base ON dk_gh.lsh = dk_base.lsh order by dk_gh.rzhrq desc”.未知支持库函数_14 (1)
显示归还记录 ()
未知支持库函数_16 ()

.子程序 显示归还记录, 空白型, , 显示查询到的贷款归还记录
.局部变量 读入文本变量, 文本型, , , 
.局部变量 读入日期变量, 日期时间型, , , 
.局部变量 读入双精度变量, 双精度小数型, , , 
.局部变量 插入位置, 整数型, , , 

全部删除 ()
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “lsh”.未知支持库函数_26 (读入文本变量)
        赋值 (插入位置, .插入表项 (读入文本变量, , , , ))
        “name”.未知支持库函数_26 (读入文本变量)
        插入位置.置标题 (1, 读入文本变量)
        “ghbj”.未知支持库函数_27 (读入双精度变量)
        插入位置.置标题 (2, 到文本 (读入双精度变量))
        “ghlx”.未知支持库函数_27 (读入双精度变量)
        插入位置.置标题 (3, 到文本 (读入双精度变量))
        “hxqk”.未知支持库函数_31 (读入日期变量)
        插入位置.置标题 (4, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        “rzhrq”.未知支持库函数_31 (读入日期变量)
        插入位置.置标题 (5, 处理日期 (时间到文本 (读入日期变量, #日期部分)))
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束


.子程序 _查询按钮_被单击, 空白型, , 查询归还记录
.如果真 (等于 (.内容, “”))
    信息框 (“请输入借款人名称！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
相加 (“SELECT dk_gh.lsh, dk_gh.hxqk, dk_gh.ghbj, dk_gh.ghlx, dk_gh.rzhrq, dk_gh.km, dk_base.name FROM dk_gh INNER JOIN dk_base ON dk_gh.lsh = dk_base.lsh WHERE (((dk_base.name) Like '%”, .内容, “%')) order by dk_gh.rzhrq desc”).未知支持库函数_14 (1)
显示归还记录 ()
未知支持库函数_16 ()

.子程序 _全部按钮_被单击, 空白型, , 
“SELECT dk_gh.lsh, dk_gh.hxqk, dk_gh.ghbj, dk_gh.ghlx, dk_gh.rzhrq, dk_gh.km, dk_base.name FROM dk_gh INNER JOIN dk_base ON dk_gh.lsh = dk_base.lsh order by dk_gh.rzhrq desc”.未知支持库函数_14 (1)
显示归还记录 ()
未知支持库函数_16 ()

.子程序 _贷款归还记录窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()

.窗口程序集 按借款人查询窗口程序集, , , 按借款人查询

.子程序 _按借款人查询窗口_创建完毕, 空白型, , 连接数据库
赋值 (按借款人查询窗口., 相减 (相加 (按借款人查询窗口., 275), 按借款人查询窗口.取用户区高度 ()))
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, 相加 (#错误图标, #确认钮), “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
.未知支持库函数_12 ()

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _按借款人查询窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()

.子程序 _查询按钮_被单击, 空白型, , 根据输入借款人名称进行查询
.局部变量 读入整数变量, 整数型, , , 
.局部变量 读入文本变量, 文本型, , , 
.局部变量 插入位置, 整数型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请输入借款人名称！”, 相加 (#信息图标, #确认钮), “提示信息”)
    返回 ()
.如果真结束
清空 ()
相加 (“select id,name from dk_jkrxx where name like '%”, .内容, “%'”).未知支持库函数_14 (1) ' 查询借款人信息库，列出有符合条件的借款人
.如果真 (未知支持库函数_34 ())
    .判断循环首 (等于 (., 假))
        “name”.未知支持库函数_26 (读入文本变量)
        “id”.未知支持库函数_29 (读入整数变量)
        赋值 (插入位置, .加入项目 (读入文本变量, 0, , ))
        相加 (“select lsh from dk_base where jkrbh=”, 删首尾空 (到文本 (读入整数变量))).未知支持库函数_14 (1) ' 打开贷款明细库，读出某一借款人的信息
        .如果真 (未知支持库函数_34 ())
            .判断循环首 (等于 (., 假))
                “lsh”.未知支持库函数_26 (读入文本变量)
                插入位置.加入项目 (读入文本变量, 1, , )
                未知支持库函数_36 ()
            .判断循环尾 ()
        .如果真结束
        未知支持库函数_16 ()
        插入位置.扩展 ()
        未知支持库函数_36 ()
    .判断循环尾 ()
.如果真结束
未知支持库函数_16 ()

.子程序 _借款人编辑框_失去焦点, 空白型, , 
赋值 (.内容, 删首尾空 (.内容))

.子程序 _贷款树型框_被双击, 逻辑型, , 显示单笔借款详细信息
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (不等于 (.最大化按钮, -1))
    .如果真 (等于 (.取缩进层次 (.最大化按钮), 2))
        赋值 (贷款流水号, .取项目文本 (.最大化按钮))
        载入 (贷款详细资料窗口, , 真)
    .如果真结束
    
.如果真结束


.窗口程序集 关于窗口程序集, , , 

.子程序 _封面图片_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.子程序 _透明标签1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.子程序 _透明标签2_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.子程序 _透明标签4_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.子程序 _透明标签6_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.子程序 _标签1_反馈事件, 整数型, , 
.参数 参数一, 整数型, , 
.参数 参数二, 整数型, , 

销毁 ()

.子程序 _关于窗口_创建完毕, 空白型, , 
赋值 (关于窗口., 相减 (相加 (关于窗口., 198), 关于窗口.取用户区高度 ()))

.窗口程序集 系统初始化窗口程序集, , , 

.程序集变量 设置项目, 整数型, , , 当前进行设置的项目
.子程序 _系统初始化窗口_创建完毕, 空白型, , 
赋值 (系统初始化窗口., 相减 (相加 (系统初始化窗口., 168), 系统初始化窗口.取用户区高度 ()))
赋值 (设置项目, 1)

.子程序 _下一步按钮_被单击, 空白型, , 
.判断开始 (等于 (设置项目, 1))
    .如果 (等于 (信息框 (“系统将清除所有数据，恢复到初始状态，继续吗？”, 相加 (#确认取消钮, #询问图标, #默认按钮二), “提示信息”), #确认钮))
        .如果真 (等于 (删除文件 (相加 (取运行目录 (), “\dkgl.mdb”)), 假))
            信息框 (“初始化失败！”, 相加 (#确认钮, #信息图标), “提示信息”)
            返回 ()
        .如果真结束
         ' 复制文件 (#初始化库, 取运行目录 () ＋ “\dkgl.mdb”)
        .如果真 (等于 (写到文件 (相加 (取运行目录 (), “\dkgl.mdb”), #初始化库), 假))
            信息框 (“初始化失败！”, 相加 (#确认钮, #信息图标), “提示信息”)
            返回 ()
        .如果真结束
        赋值 (.标题, “    系统已恢复到初始状态，请设置您的单位代码和名称。单位代码为四位阿拉伯数字，如：0001、、0002、1001等”)
        赋值 (.标题, “点击下一步进行单位名称设置……”)
    .否则
        销毁 ()
    .如果结束
    
.判断 (等于 (设置项目, 2))
    载入 (系统定义窗口, , 真)
    赋值 (.标题, “    单位名称设置完毕，下一步进行村组维护。请将信用社辖区内的所有行政村输入系统，如有跨社贷款和异地贷款，您可以添加《跨社》、《异地》两个虚拟村组。”)
    赋值 (.标题, “下一步进行村组维护……”)
.判断 (等于 (设置项目, 3))
    载入 (村组维护窗口, , 真)
    赋值 (.标题, “    村组维护完毕，下一步进行用户设置。系统的初始用户是系统管理员：admin，密码：admin，请点击下一步进行用户设置，您至少需要添加一个用户（用户自己添加的用户权限均为操作员）。”)
    赋值 (.标题, “下一步进行用户管理……”)
.判断 (等于 (设置项目, 4))
    载入 (用户设置窗口, , 真)
    赋值 (.标题, “    用户设置完毕，下一步进行信贷人员设置。请将信用社的信贷人员（包括主任、信贷员等）录入系统。”)
    赋值 (.标题, “下一步进行信贷人员设置……”)
.判断 (等于 (设置项目, 5))
    载入 (信贷人员设置窗口, , 真)
    赋值 (.标题, “    系统初始化完成，点击<确定>按钮后系统将自动关闭，请重新启动系统，以<系统管理员>登录系统，登录后点击<系统管理――数据移植>菜单项进行数据移植。”)
    赋值 (.标题, “请点击<确定>按钮退出系统……”)
    赋值 (.标题, “确  定”)
.默认
    结束 ()
.判断结束
赋值 (设置项目, 相加 (设置项目, 1))

.窗口程序集 修改密码窗口程序集, , , 

.程序集变量 登录用户密码, 文本型, , , 
.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()

.子程序 _修改密码窗口_创建完毕, 空白型, , 
.如果真 (等于 (相加 (取运行目录 (), “\dkgl.mdb”).未知支持库函数_1 (#数据库密码), 假))
    信息框 (“无法连接数据库，请与系统管理员联系！”, #错误图标, “提示信息”)
    结束 ()
.如果真结束
.未知支持库函数_12 ()
相加 (“select mm from dk_user where dh='”, 登录用户代号, “'”).未知支持库函数_14 (1)
.如果真 (未知支持库函数_34 ())
    “mm”.未知支持库函数_26 (登录用户密码)
.如果真结束
未知支持库函数_16 ()

.子程序 _旧密码编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    .如果 (等于 (登录用户密码, .内容))
        赋值 (.禁止, 真)
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        获取焦点 ()
    .否则
        信息框 (“密码错误”, #错误图标, “提示信息”)
    .如果结束
    
.如果真结束


.子程序 _确定按钮_被单击, 空白型, , 
.如果 (等于 (.内容, 登录用户密码))
    .如果 (等于 (.内容, .内容))
        .如果 (不等于 (.内容, “”))
            相加 (“update dk_user set mm='”, .内容, “' where dh='”, 登录用户代号, “'”).未知支持库函数_4 ()
            销毁 ()
        .否则
            信息框 (“新密码不能为空！”, #错误图标, “提示信息”)
        .如果结束
        
    .否则
        信息框 (“新密码两次输入不符！”, #错误图标, “提示信息”)
    .如果结束
    
.否则
    信息框 (“旧密码输入错误！”, #错误图标, “提示信息”)
.如果结束


.子程序 _新密码编辑框_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _新密码编辑框2_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    获取焦点 ()
.如果真结束


.子程序 _确定按钮_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    _确定按钮_被单击 ()
.如果真结束



 ' 不属于任何一个程序集、类模块的函数：
