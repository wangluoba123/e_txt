 ' 文件类型：Windows窗口程序

 ' 程序名称：五步数据库
 ' 程序描述：
 ' 程序作者：方德软件
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：fundersoft@126.com
 ' 主页地址：funder@zj.com
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 主窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “五步数据库完全免费版”
    帮助文件名 = “”

窗口 欢迎 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 382
    高度 = 368
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 0
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\五步数据库完全免费版.e\欢迎_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “广而告之”
    帮助文件名 = “”



.图片 base, " ' 已保存到：D:\易语言学习\Data\五步数据库完全免费版.e\base", , 
.图片 wel, " ' 已保存到：D:\易语言学习\Data\五步数据库完全免费版.e\wel", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 2 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 1 扩展界面支持库一
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 1 1 高级表格
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库
 ' sock A6B983789F624b2cBDFD7D671249C097 1 0 网络通讯支持库
 ' HtmlView 5014D8FA6DCA40b68FA626D8183666EB 1 1 超文本浏览框
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 1 XP风格界面库
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 1 0 数据操作支持库一




.全局变量 有无公式, 逻辑型, , , 
.全局变量 程序目录, 文本型, , , 
.全局变量 临时字节集, 字节集, , , 

.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 本子程序在程序启动后最先执行
.如果 (文件是否存在 (相加 (取运行目录 (), “\mmx.dat”)))
    载入 (主窗口, , 真)
    
.否则
    信息框 (“找不到文件'mmx.dat',您将无法使用本系统!”, 0, )
    结束 ()
    
.如果结束



返回 (0) ' 可以根据您的需要返回任意数值

.窗口程序集 窗口程序集1, , , 

.程序集变量 计算机名, 文本型, , , 
.程序集变量 五步数据库字段类型, 文本型, , "6", 
.程序集变量 i, 整数型, , , 
.程序集变量 行, 整数型, , , 
.程序集变量 列, 整数型, , , 
.程序集变量 作者信息, 文本型, , "6", 
.程序集变量 界面, 整数型, , , 
.子程序 _主窗口_创建完毕, 空白型, , 
.局部变量 k, 整数型, , , 
.局部变量 a, 整数型, , , 

未知支持库函数_0 (1)
赋值 (主窗口., 15196118)
连续赋值 (15196118, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)
改变目录 (“skin”)
更换界面 (114)
改变目录 (“..”)
 ' 上面草稿部分为程序皮肤效果,需要第三方的无限支持库.有些舍不得,但为了参加比赛.不得不.....

写到文件 (相加 (未知支持库函数_7 (11), “base.fxg”), #base)

赋值 (计算机名, 未知支持库函数_16 ())
赋值 (.内容, 相加 (计算机名, “的第一个数据库程序”))
赋值 (.被选择字符数, -1)
获取焦点 ()

赋值 (五步数据库字段类型, { “文本型”, “整数型”, “小数型”, “逻辑型”, “时间型”, “备注型” })
赋值 (作者信息, { “作者：”, “电话：”, “电子邮件：”, “网站：”, “QQ：”, “通讯地址：” })

作者表格初始化子程序 ()

.变量循环首 (1, 6, 1, i)
    相减 (i, 1).未知支持库函数_9 (0, #., 作者信息 [i])
.变量循环尾 ()
1.未知支持库函数_32 (150)
 ' 作者信息表格的处理.

0.选中项目 ()
.变量循环首 (1, 3, 1, i)
    相减 (i, 1).选中项目 ()
.变量循环尾 ()
0.选中项目 () ' 初始化关于程序的选项,即第五步聚.

赋值 (界面, 3)
赋值 (., 相加 (取运行目录 (), “\help.htm”))
模板处理子程序 ()

载入 (欢迎, , 真)


.子程序 _主窗口_将被销毁, 空白型, , 
关闭所有文件 ()
全部关闭 ()

.子程序 _下一步按钮_被单击, 空白型, , 
.局部变量 a, 文本型, , , 

.判断开始 (等于 (.现行子夹, 0))
    .如果 (不等于 (.内容, “”))
        赋值 (., 相加 (取运行目录 (), “\help.htm#”, 到文本 (2)))
        赋值 (.现行子夹, 相加 (.现行子夹, 1))
        赋值 (.禁止, 假)
        赋值 (.禁止, 等于 (.现行子夹, 相减 (取子夹数目 (), 1)))
        赋值 (.现行选中项, -1)
    .否则
        信息框 (“您还没有给程序起名呢!”, 0, “程序没有标题”)
        获取焦点 ()
    .如果结束
    
.判断 (等于 (.现行子夹, 1))
    
    新表格到数据库 (相加 (未知支持库函数_7 (11), “zdm.fxg”))
    替换打开 (相加 (未知支持库函数_7 (11), “zdm.fxg”), , , , , , )
    到首记录 ()
     ' 将重要的字段信息生成一个临时数据库,并打开它,据此生成字段其它信息的基库.
    .如果 (等于 (读 (1), “”))
        信息框 (“不能建立一个没有字段的数据库!”, 0, “字段数为0”)
        
    .否则
        复制记录 (相加 (未知支持库函数_7 (11), “bb.fxg”), 或者 (等于 (读 (“字段类型”), “文本型”), 等于 (读 (“字段类型”), “备注型”)), )
        数据库到新表格 (相加 (未知支持库函数_7 (11), “bb.fxg”))
        “N个汉字”.未知支持库函数_39 (3)
        赋值 (行, .)
        1.未知支持库函数_0 (3)
        
        .变量循环首 (1, 行, 1, i)
            .如果真 (等于 (到文本 (i.未知支持库函数_10 (2)), “文本型”))
                i.未知支持库函数_9 (3, #., 到文本 (10))
            .如果真结束
            .如果真 (等于 (到文本 (i.未知支持库函数_10 (2)), “备注型”))
                i.未知支持库函数_9 (3, #., 到文本 (50))
            .如果真结束
            
        .变量循环尾 () ' 置默认文本型字段的长度,简便用户操作
        
        刷新显示 ()
        赋值 (., 相加 (取运行目录 (), “\help.htm#”, 到文本 (3)))
        赋值 (.现行子夹, 相加 (.现行子夹, 1))
        赋值 (.禁止, 假)
        赋值 (.禁止, 等于 (.现行子夹, 相减 (取子夹数目 (), 1)))
        
    .如果结束
    
    全部关闭 ()
    
.判断 (等于 (.现行子夹, 2))
    赋值 (., 相加 (取运行目录 (), “\help.htm#”, 到文本 (4)))
    
    赋值 (程序目录, 未知支持库函数_2 (“注意:请在我的电脑里面指定有效的程序所存在位置!如果指定了无效的位置,将无法运行生成的程序!”, ))
    .如果真 (等于 (程序目录, “”))
        赋值 (程序目录, “c:”)
    .如果真结束
    
    .如果 (文件是否存在 (相加 (程序目录, “\”, .内容, “\”, .内容, “.exe”)))
        信息框 (相加 (“已存在:”, 程序目录, “\”, .内容, “,请重新选择您程序存放的位置,或者更改程序名称!”), 0, )
        返回 ()
    .否则
        赋值 (., 相加 (取运行目录 (), “\help.htm#”, 到文本 (5)))
        赋值 (.现行子夹, 相加 (.现行子夹, 1))
        赋值 (.禁止, 假)
        赋值 (.禁止, 等于 (.现行子夹, 相减 (取子夹数目 (), 1)))
        赋值 (.禁止, 假)
        
    .如果结束
    
.判断 (等于 (.现行子夹, 3))
    选择列表框1.置项目文本 (1, 选择列表框1.取项目文本 (1) ＋ 编辑框1.内容)
    选择框2.标题 ＝ 选择框2.标题 ＋ 编辑框1.内容
    
    赋值 (.现行子夹, 相加 (.现行子夹, 1))
    赋值 (.禁止, 假)
    赋值 (.禁止, 等于 (.现行子夹, 相减 (取子夹数目 (), 1)))
.默认
    
.判断结束


.子程序 _完成按钮_被单击, 空白型, , 
.局部变量 k, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 目录, 文本型, , , 
.局部变量 字段表, 字段信息, , "0", 
.局部变量 字段表类型, 整数型, , "0", 
.局部变量 记录号, 整数型, , "0", 


置等待鼠标 ()

替换打开 (相加 (未知支持库函数_7 (11), “zdm.fxg”), , , , , , )
赋值 (字段数, 取记录数 ())
关闭 ()
替换打开 (相加 (未知支持库函数_7 (11), “base.fxg”), , , , , 到文本 ({ 49, 51, 56, 57, 51, 50, 50, 48, 53, 57, 50 }), )
 ' 一个成熟的程序应当有一定的防盗版措施,在重要的基础库:BASE.FXG里,不仅仅修改了数据库扩展名称,而且还要加不轻易被破解密码,试试看,密码内容到底是什么?
清空 ()

.变量循环首 (1, 100, 1, k)
    加空记录 ()
.变量循环尾 () ' 固定基础表的行数为100.

.变量循环首 (1, 字段数, 1, k)
    跳到 (k)
    写 (1, 到文本 (k.未知支持库函数_10 (1)))
    
.变量循环尾 ()
 ' 将有效字段名导入BASE库.
.变量循环首 (1, 字段数, 1, k)
    跳到 (k)
    写 (2, 类型转换 (到文本 (k.未知支持库函数_10 (2))))
.变量循环尾 ()
 ' 为有效字段名导入其数据类型自动转换成易库的数据类型.

赋值 (i, 相减 (., 1))
.变量循环首 (1, i, 1, k)
    到首记录 ()
    查找 (等于 (读 (1), 到文本 (k.未知支持库函数_10 (1))))
    写 (3, 相乘 (到数值 (k.未知支持库函数_10 (3)), 2))
.变量循环尾 ()
 ' 文本型字段加录最大数据长度

跳到 (1)
写 (6, .内容)
 ' 在BASE库第一行写程序标题.
.变量循环首 (1, 6, 1, i)
    跳到 (相加 (i, 1))
    写 (6, 到文本 (相减 (i, 1).未知支持库函数_10 (1)))
    
.变量循环尾 ()
 ' 在BASE库第二行起依次写关于作者的信息..
跳到 (8)
写 (6, 到文本 (123))
 ' 特定记录号内写超级管理员初始密码

.如果真 (1.是否被选中 ())
    跳到 (9)
    写 (6, 到文本 (.内容))
    
.如果真结束

跳到 (10)
写 (6, 到文本 (界面))
跳到 (11)
写 (6, “”) ' 此记录生成程序的运行次数,在初生成时,次数为零,若为文本型字段为空.

全部关闭 ()

创建目录 (相加 (程序目录, “\”, .内容))

赋值 (目录, 相加 (程序目录, “\”, .内容, “\”))
.如果 (复制文件 (相加 (未知支持库函数_7 (11), “\base.fxg”), 相加 (目录, “base.fxg”)))
    
    替换打开 (相加 (目录, “base.fxg”), , , , , 到文本 ({ 49, 51, 56, 57, 51, 50, 50, 48, 53, 57, 50 }), )
    
    重定义数组 (字段表, 假, 字段数)
    .变量循环首 (1, 字段数, 1, k)
        跳到 (k)
        赋值 (字段表 [k], 名称, 读 (1))
        赋值 (字段表 [k], 类型, 读 (2))
        赋值 (字段表 [k], 最大文本长度, 读 (3)) ' 如果为非文本型则无效.
    .变量循环尾 ()
    
    .如果 (1.是否被选中 ())
        复制文件 (相加 (取运行目录 (), “\skin\”, 到文本 (.内容), “.skn”), 相加 (目录, “1.skn”))
    .否则
        
    .如果结束
    
    
    .如果 (创建 (相加 (目录, “sys.edb”), 字段表))
        替换打开 (相加 (目录, “sys.edb”), , , , , , )
        置数据库密码 (“123”)
        关闭 ()
        
        文件更名 (相加 (目录, “sys.edb”), 相加 (目录, “data.fxg”))
        .如果真 (文件是否存在 (相加 (目录, “sys.edb”)))
            删除文件 (相加 (目录, “sys.edb”))
        .如果真结束
        
        .如果 (复制文件 (相加 (取运行目录 (), “\敬告.txt”), 相加 (目录, “敬告.txt”)))
            
        .否则
            信息框 (“复制文件失败!”, 0, )
        .如果结束
        
        .如果 (复制文件 (相加 (取运行目录 (), “\声明.txt”), 相加 (目录, “声明.txt”)))
            
        .否则
            信息框 (“复制文件失败!”, 0, )
            
        .如果结束
        
        赋值 (临时字节集, 读入文件 (相加 (取运行目录 (), “\mmx.dat”)))
        .如果 (写到文件 (相加 (目录, .内容, “.exe”), 未知支持库函数_4 (临时字节集, “方德真名献国”, 1)))
            .如果 (0.是否被选中 ())
                未知支持库函数_0 (相加 (未知支持库函数_7 (#), .内容), 相加 (目录, .内容, “.exe”), “这是由方德软件推出的五步数据库自动生成的程序!”, , )
                信息框 (相加 (.内容, “已经生成!所在文件夹为:”, 目录, “,并在系统桌面自动创建快捷方式，请到桌面查看。”), 0, “生成程序成功”)
                
            .否则
                信息框 (相加 (.内容, “已经生成!所在文件夹为:”, 目录), 0, “生成程序成功”)
                
            .如果结束
            
            .如果真 (1.是否被选中 ())
                运行 (相加 (目录, .内容, “.exe”), 假, )
            .如果真结束
            
            主窗口.销毁 ()
            
        .否则
            信息框 (“写出可执行文件失败”, 0, )
        .如果结束
        
        
    .否则
        信息框 (“因为字段名称不符合规范或者其它原因,不能够生成数据库文件!”, 0, 相加 (“创建”, .内容, “失败”))
        
    .如果结束
    
.否则
    
.如果结束

删除文件 (相加 (未知支持库函数_7 (11), “\base.fxg”))
恢复鼠标 ()

.子程序 _上一步按钮_被单击, 空白型, , 
赋值 (., 相加 (取运行目录 (), “\help.htm#”, 到文本 (.现行子夹)))
赋值 (.现行子夹, 相减 (.现行子夹, 1))
赋值 (.禁止, 假)
赋值 (.禁止, 等于 (.现行子夹, 0))


.子程序 _添加到模板按钮_被单击, 空白型, , 
.局部变量 文本, 文本型, , , 
.局部变量 临时字节集, 字节集, , , 
.局部变量 临时变量, 文本型, , , 

.变量循环首 (1, 100, 1, i)
    .如果 (等于 (到文本 (i.未知支持库函数_10 (1)), “”))
        跳出循环 ()
        
    .否则
        赋值 (文本, 相加 (文本, 到文本 (i.未知支持库函数_10 (1)), “,”, 到文本 (i.未知支持库函数_10 (2)), “;”))
        
    .如果结束
    
    
.变量循环尾 ()
赋值 (文本, 文本替换 (文本, 取文本长度 (文本), 1, “.”))
赋值 (临时字节集, 到字节集 (文本))
.如果 (输入框 (“请为此模板定义一个合适的名称:”, “模板名”, , 临时变量, ))
    .如果 (不等于 (临时变量, “”))
        .如果 (写到文件 (相加 (取运行目录 (), “\模板\”, 临时变量, “.txt”), 临时字节集))
            模板处理子程序 ()
            信息框 (相加 (“已写入模板文件:”, 临时变量, “.txt,并自动加入模板列表框,以方便你为不同的用户编写同类程序时调用.”), 0, “写出模板文件成功”)
        .否则
            
        .如果结束
        
    .否则
        信息框 (“怎么能够没有模板名呢?”, 0, “模板命名”)
        
    .如果结束
    
.否则
    
.如果结束


.子程序 _编辑模板按钮_被单击, 空白型, , 

.如果 (不等于 (.内容, “”))
    未知支持库函数_57 ()
    作者表格初始化子程序 ()
    未知支持库函数_6 ( (), 相加 (取运行目录 (), “\模板\”, .取项目文本 (.现行选中项)), , )
    
    
.否则
    信息框 (“请选择要编辑的模板文件!”, 0, )
.如果结束


.子程序 _文本字段长度表格_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (或者 (等于 (未知支持库函数_4 (), 1), 等于 (未知支持库函数_4 (), 2)))
    信息框 (“此列不可编辑!”, 0, )
    未知支持库函数_3 ().未知支持库函数_0 (3)
.否则
    
.如果结束


.子程序 _组合框2_列表项被选择, 空白型, , 
.局部变量 源文本, 文本型, , , 
.局部变量 句位置, 整数型, , , 
.局部变量 规格文本, 文本型, , , 
.局部变量 总字段, 文本型, , "0", 
.局部变量 总字段数, 整数型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 临时字段, 文本型, , "0", 
.局部变量 组合框程序名, 文本型, , , 

赋值 (文件号, 打开文件 (相加 (取运行目录 (), “\模板\”, .取项目文本 (.现行选中项)), , ))
.如果 (不等于 (文件号, 0))
    赋值 (源文本, 到半角 (删全部空 (读入文本 (文件号, ))))
    赋值 (句位置, 寻找文本 (源文本, “.”, , 假))
    赋值 (规格文本, 取文本左边 (源文本, 相减 (句位置, 1)))
    赋值 (总字段, 分割文本 (规格文本, “;”, ))
    赋值 (总字段数, 取数组成员数 (总字段))
    
    .计次循环首 (100, i)
        i.未知支持库函数_9 (1, #., “”)
        i.未知支持库函数_9 (2, #., “”)
    .计次循环尾 ()
    
    .变量循环首 (1, 总字段数, 1, i)
        赋值 (临时字段, 分割文本 (总字段 [i], “,”, ))
        i.未知支持库函数_9 (1, #., 临时字段 [1])
        i.未知支持库函数_9 (2, #., 临时字段 [2])
        
    .变量循环尾 ()
    
    赋值 (组合框程序名, .取项目文本 (.现行选中项))
    
    赋值 (.内容, 取文本左边 (组合框程序名, 相减 (取文本长度 (组合框程序名), 4)))
    关闭所有文件 ()
    
    
.否则
    信息框 (“不能打开模板目录下的文件!”, 相加 (0, #信息图标), “请稍后再试!”)
.如果结束




.子程序 _编辑框2_内容被改变, 空白型, , 
.局部变量 a, 字节集, , , 

赋值 (a, 读入文件 (相加 (取运行目录 (), “\img\”, 到文本 (.内容), “*.jpg”)))
赋值 (.图片, {  })
赋值 (.图片, a)

.子程序 _选择列表框3_列表项被选择, 空白型, , 
.如果 (等于 (信息框 (“此功能需要第三方支持库，因此此版本不支持换肤！”, 0, ), 4))
    .如果 (1.是否被选中 ())
        赋值 (.禁止, 假)
    .否则
        赋值 (.禁止, 真)
    .如果结束
     ' 第二个"如果"语句为程序原先的代码,舍不得删掉,所以出此一招,永不会执行原代码,若删去第一个"如果"语句,则恢复为原先代码,您别笑话我啊,呵呵~~
.否则
    0.选中项目 (真)
    1.选中项目 (假)
    
.如果结束


.子程序 _选择列表框2_选中状态被改变, 空白型, , 
.如果 (并且 (等于 (0.是否被选中 (), 假), 等于 (1.是否被选中 (), 假), 等于 (2.是否被选中 (), 假)))
    信息框 (“你不可能全不选!”, 0, “不能没有界面元素”)
    .变量循环首 (1, 3, 1, i)
        相减 (i, 1).选中项目 ()
    .变量循环尾 ()
    
.否则
    .如果真 (并且 (0.是否被选中 (), 1.是否被选中 (), 2.是否被选中 ()))
        全选:3 前两个:2 前一个:1 中间一个:4,最后一个,5,后两个6,两头取.7
        赋值 (界面, 3)
    .如果真结束
    .如果真 (并且 (0.是否被选中 (), 1.是否被选中 ()))
        赋值 (界面, 2)
        
    .如果真结束
    .如果真 (0.是否被选中 ())
        赋值 (界面, 1)
        
    .如果真结束
    .如果真 (1.是否被选中 ())
        赋值 (界面, 4)
        
    .如果真结束
    .如果真 (2.是否被选中 ())
        赋值 (界面, 5)
        
    .如果真结束
    .如果真 (并且 (1.是否被选中 (), 2.是否被选中 ()))
        赋值 (界面, 6)
        
    .如果真结束
    .如果真 (并且 (0.是否被选中 (), 2.是否被选中 ()))
        赋值 (界面, 7)
        
    .如果真结束
    
    
.如果结束


.子程序 _注册按钮_被单击, 空白型, , 
信息框 (“此为五步数据库完全免费版本,无任何限制!”, 0, “无需注册”)


.子程序 模板处理子程序, 空白型, , 
.局部变量 模板名, 文本型, , "0", 
.局部变量 临时, 文本型, , , 
.局部变量 模板数, 整数型, , , 

清空 ()
寻找文件 (相加 (取运行目录 (), “\模板\*.txt”), ).加入项目 ()

.如果 (等于 (0.取项目文本 (), “”))
    0.删除项目 ()
    “没有可用模板”.加入项目 ()
    赋值 (.现行选中项, 0)
    
.否则
    赋值 (临时, 寻找文件 ())
    .判断循环首 (不等于 (临时, “”))
        加入成员 (模板名, 临时)
        赋值 (临时, 寻找文件 ())
    .判断循环尾 ()
    
    赋值 (模板数, 取数组成员数 (模板名))
    
    .如果 (大于 (模板数, 0))
        .变量循环首 (1, 模板数, 1, i)
            模板名.加入项目 ( [i], )
        .变量循环尾 ()
        
    .否则
        
    .如果结束
    
    
.如果结束



.子程序 作者表格初始化子程序, 空白型, , 
未知支持库函数_57 ()
.变量循环首 (1, 100, 1, i)
    i.未知支持库函数_9 (0, #., 到文本 (i))
.变量循环尾 ()
0.未知支持库函数_9 (1, #., “字段名称”)
0.未知支持库函数_9 (2, #., “字段类型”)
0.未知支持库函数_25 (0, 100, 2, 2)

未知支持库函数_28 ()
.变量循环首 (1, 6, 1, i)
    五步数据库字段类型.未知支持库函数_29 ( [i])
.变量循环尾 ()
2.未知支持库函数_30 (#.)
 ' 设置字段表格行,列,表头.


.子程序 数据库到新表格, 空白型, , 数据库到新表格
.参数 新表格, 未知类型0x30001, , 
.参数 数据库, 文本型, , 
.参数 密码, 文本型, 可空, 

.局部变量 行, 整数型, , , 
.局部变量 列, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 k, 整数型, , , 
.局部变量 字段类型, 整数型, , "0", 
.局部变量 表格类型, 整数型, , "0", 

打开 (数据库, , , , , 密码, )
置当前库 (数据库)
赋值 (列, 取字段数 ())
赋值 (行, 取记录数 ())
赋值 (新表格., 相加 (行, 1))
赋值 (新表格., 相加 (列, 1)) ' 确定了新表格的行列数和数据库对应!

.变量循环首 (1, 列, 1, i)
    新表格.未知支持库函数_9 (0, i, #., 取字段名 (i))
.变量循环尾 () ' 在新表格的第一行内写数据库字段名

.变量循环首 (1, 行, 1, i)
    新表格.未知支持库函数_9 (i, 0, #., 到文本 (i))
.变量循环尾 () ' 在新表格的第一列写出各行的行数字

.变量循环首 (1, 列, 1, i)
    加入成员 (字段类型, 取字段类型 (i))
    加入成员 (表格类型, 转换类型子程序 (字段类型 [i]))
.变量循环尾 () ' 取出数据库各字段类型,生成数组变量,同时生成的表格列类型变量.


新表格.未知支持库函数_25 (0, 0, 行, 列, 2)

.变量循环首 (1, 行, 1, i)
    跳到 (i)
    .变量循环首 (1, 列, 1, k)
        新表格.未知支持库函数_9 (i, k, #., 到文本 (读 (k)))
    .变量循环尾 ()
.变量循环尾 () ' 循环写入数据库内容

.变量循环首 (1, 列, 1, i)
    新表格.未知支持库函数_30 (i, 表格类型 [i])
.变量循环尾 () ' 置新表格的列属性与数据库字段相适应
1、#表格常量.文本型； 2、#表格常量.数值型； 3、#表格常量.日期型；4、#表格常量.列表型； 5、#表格常量.选择型； 6、#表格常量.图片型；7、#表格常量.货币型。
字段类型值为以下常量值之一： 1、#字节型； 2、#短整数型； 3、#整数型； 4、#长整数型； 5、#小数型； 6、#双精度小数型； 7、#逻辑型； 8、#日期时间型； 10、#文本型； 11、#字节集型； 12、#备注型。如果指定字段不存在，将返回 0 。
关闭 ()


.子程序 转换类型子程序, 整数型, , 
.参数 数据库类型, 整数型, , 

.如果真 (或者 (等于 (数据库类型, 1), 等于 (数据库类型, 2), 等于 (数据库类型, 3), 等于 (数据库类型, 4), 等于 (数据库类型, 5), 等于 (数据库类型, 6)))
    返回 (2)
.如果真结束
.如果真 (等于 (数据库类型, 7))
    返回 (1)
.如果真结束
.如果真 (等于 (数据库类型, 8))
    返回 (3)
.如果真结束
.如果真 (或者 (等于 (数据库类型, 10), 等于 (数据库类型, 12)))
    返回 (1)
.如果真结束
.如果真 (等于 (数据库类型, 11))
    返回 (6)
.如果真结束
返回 (0)


.子程序 新表格到数据库, 空白型, , 新表格到数据库
.参数 新表格, 未知类型0x30001, , 
.参数 数据库, 文本型, , 数据库文件名,最好全路径
.参数 密码, 文本型, 可空, 

.局部变量 字段数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 i, 整数型, , , 
.局部变量 k, 整数型, , , 
.局部变量 字段表, 字段信息, , "0", 
.局部变量 表格类型, 整数型, , "0", 

赋值 (字段数, 相减 (新表格., 1))
赋值 (记录数, 相减 (新表格., 1))
重定义数组 (字段表, 假, 字段数)
.变量循环首 (1, 字段数, 1, i)
    赋值 (字段表 [i], 名称, 到文本 (新表格.未知支持库函数_10 (0, i)))
    赋值 (字段表 [i], 类型, #文本型)
    赋值 (字段表 [i], 最大文本长度, 20)
.变量循环尾 ()

.如果 (创建 (数据库, 字段表))
    打开 (数据库, , , , , , )
    置当前库 (数据库)
    .变量循环首 (1, 记录数, 1, i)
        加空记录 ()
        .变量循环首 (1, 字段数, 1, k)
            写 (k, 新表格.未知支持库函数_10 (i, k))
        .变量循环尾 ()
    .变量循环尾 ()
    .如果 (不等于 (密码, “”))
        置数据库密码 (密码)
        
    .否则
        
    .如果结束
    全部关闭 ()
.否则
    信息框 (取错误信息 (), 相加 (0, #错误图标), “因为表格设计不符合数据库规范，无法创建数据库！”)
    
    
.如果结束


.子程序 类型转换, 整数型, , 
.参数 类型, 文本型, , 

1、#字节型； 2、#短整数型； 3、#整数型； 4、#长整数型； 5、#小数型； 6、#双精度小数型； 7、#逻辑型； 8、#日期时间型； 10、#文本型； 11、#字节集型； 12、#备注型。如果指定字段不存在，将返回 0 。
五步数据库字段类型＝ { “文本型”, “整数型”, “小数型”, “逻辑型”, “时间型”, “备注型” }

 ' 很重要的一个子程序,它的作用是使五步数据库的字段类型与易数据库字段类型相匹配.草稿部分为两种类型的参考文档.故没有删除.
.如果真 (等于 (类型, 五步数据库字段类型 [1]))
    返回 (10)
.如果真结束
.如果真 (等于 (类型, 五步数据库字段类型 [2]))
    返回 (4)
.如果真结束
.如果真 (等于 (类型, 五步数据库字段类型 [3]))
    返回 (6)
.如果真结束
.如果真 (等于 (类型, 五步数据库字段类型 [4]))
    返回 (7)
.如果真结束
.如果真 (等于 (类型, 五步数据库字段类型 [5]))
    返回 (8)
.如果真结束
.如果真 (等于 (类型, 五步数据库字段类型 [6]))
    返回 (10)
.如果真结束
返回 (0)

.窗口程序集 窗口程序集2, , , 

.程序集变量 打印文字, 文本型, , , 
.程序集变量 数组位置, 整数型, , , 
.程序集变量 光标位置, 整数型, , , 
.程序集变量 数组总数, 整数型, , , 
.程序集变量 字幕总长, 整数型, , , 
.程序集变量 秒数, 整数型, , , 
.子程序 _时钟_周期事件, 空白型, , 
.局部变量 临时变量, 文本型, , , 

.如果 (大于或等于 (光标位置, 字幕总长))
    赋值 (光标位置, 0)
    赋值 (数组位置, 相加 (数组位置, 1))
    .如果真 (大于 (数组位置, 数组总数))
        赋值 (数组位置, 1)
    .如果真结束
    赋值 (字幕总长, 取文本长度 (打印文字))
    赋值 (.时钟周期, 3000)
.否则
    赋值 (.时钟周期, 120)
    赋值 (临时变量, 取文本中间 (打印文字, 相加 (光标位置, 1), 1))
    .如果 (或者 (小于 (取代码 (临时变量, ), -1), 大于 (取代码 (临时变量, ), 127)))
        赋值 (光标位置, 相加 (光标位置, 2))
    .否则
        赋值 (光标位置, 相加 (光标位置, 1))
        
    .如果结束
    赋值 (.内容, 相加 (取文本左边 (打印文字, 光标位置), “_”))
    
.如果结束


.子程序 _欢迎_创建完毕, 空白型, , 
赋值 (欢迎., #wel)
欢迎.置外形图片 (欢迎., )
赋值 (.内容, “秒后自动关闭此窗口,按ESC键直接关闭.”)
赋值 (打印文字, 相加 (#换行符, “    革命性的数据库编程工具----五步数据库应用程序自动生成系统诞生了!”, #换行符, “    只需简简单单五个步骤,利用系统自带的模板,最少点击鼠标八次,几秒钟就将生成一个标准的数据库应用程序!”, #换行符, “    简单并不总意味着牺牲功能,由五步自动生成的标准数据库程序同样界面美观,功能强大!”, #换行符, “    特别说明:本软件由大连大有吴涛易语言软件开发有限公司提供的易语言编写而成!支持中文编程!感谢易语言!”, #换行符, #换行符, “             ----By Fundersoft(R) ”))
赋值 (字幕总长, 取文本长度 (打印文字))

.子程序 _欢迎_将被销毁, 空白型, , 
赋值 (主窗口., 真)

.子程序 _时钟1_周期事件, 空白型, , 
赋值 (秒数, 相加 (秒数, 1))
赋值 (.内容, “”)
赋值 (.内容, 到文本 (相减 (60, 秒数)))
.如果真 (等于 (相减 (60, 秒数), 0))
    欢迎.销毁 ()
    
.如果真结束



 ' 不属于任何一个程序集、类模块的函数：
