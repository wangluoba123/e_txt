 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.wodesoft.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.wodesoft.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.wodesoft.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 413
    高度 = 340
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\电脑记录清除器.e\_启动窗口_底图
    图标 =  ' 已保存到：D:\易语言学习\Data\电脑记录清除器.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “电脑使用记录清除器 V1.0 雷盟工作室 出品”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库



 ' 所需要的模块
 ' 自用模块 C:\Documents and Settings\raymone\桌面\_自用模块.ec



.DLL命令 添加菜单项, 整数型, "", "AppendMenuA", 公开, 在指定的菜单里添加一个菜单项　非零表示成功，零表示失败。会设置GetLastError
    .参数 菜单句柄, 整数型, , 菜单句柄
    .参数 菜单常数标志, 整数型, , 参考ModifyMenu函数中的菜单常数标志定义表，其中列出了允许使用的所有常数
    .参数 新菜单条目ID, 整数型, , 指定菜单条目的新命令ID。如果在wFlags参数中指定了MF_POPUP字段，那么这应该是指向一个弹出式菜单的句柄
    .参数 标志值, 文本型, , （相应的vb声明见注解），如果在wFlags参数中指定了MF_STRING标志，这就代表在菜单中设置的字串。如设置了MF_BITMAP标志，这就代表一个Long型变量，其中包含了一个位图句柄。如设置了MF_OWNERDRAW，这个值就会包括在DRAWITEMSTRUCT和MEASUREITEMSTRUCT结构中，在条目需要重画的时候由windows发送出去
  

.DLL命令 发送消息, 整数型, "", "SendMessageA", 公开, 
    .参数 窗口句柄, 整数型, , 
    .参数 标识, 整数型, , 
    .参数 消息1, 整数型, , 
    .参数 消息2, 文本型, , 

.DLL命令 GetSystemMenu, 整数型, "", "GetSystemMenu", 公开, 获取系统原始菜单
    .参数 hWnd, 整数型, , 
    .参数 bRevert, 逻辑型, , 

.DLL命令 RemoveMenu, 整数型, "", "RemoveMenu", 公开, 移除系统原始菜单项
    .参数 hMenu, 整数型, , 
    .参数 nPosition, 整数型, , 
    .参数 wFlags, 整数型, , 

.DLL命令 清空回收站, 整数型, "shell32.dll", "SHEmptyRecycleBinA", 公开, 
    .参数 hwnd, 整数型, , 
    .参数 lppath, 整数型, , 
    .参数 flag, 整数型, , 

.窗口程序集 窗口程序集1, , , 

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 刷新注册表, 逻辑型, , , 
.局部变量 返回值, 整数型, , , 

 ' --========  易语言资源网  (www.wodesoft.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.wodesoft.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.wodesoft.com  ================--

设置按钮标题 (“开始(&O)”)
赋值 (返回值, 自定义信息框 (取窗口句柄 (), “开始清除所选择的记录？”, 33, “清除记录”))

.如果真 (不等于 (返回值, #确认钮))
    返回 ()
.如果真结束

 ' 本源码来自易语言资源网(www.wodesoft.com)
置等待鼠标 ()

.如果真 (.) ' 删除运行框所执行的文件记录
    删除注册项 (3, “Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU”)
    赋值 (刷新注册表, 真)
    
     ' 写注册项 (3, “Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU\”, “(数值未设置)”)
     ' 写注册项 (3, “Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU\MRUList”, “”)
.如果真结束

.如果真 (.) ' 删除winrar打开的文件记录
    删除注册项 (3, “Software\winrar”)
    赋值 (刷新注册表, 真)
.如果真结束

.如果真 (.) ' 删除写字板的文件记录
    删除注册项 (3, “Software\Microsoft\windows\CurrentVersion\Applets\Wordpad\Recent Filelist”)
    赋值 (刷新注册表, 真)
.如果真结束

.如果真 (.) ' 删除XP的自动隐藏状态栏图标记录
    删除注册项 (3, “Software\Microsoft\Windows\CurrentVersion\Explorer\TrayNotify\IconStreams”)
    删除注册项 (3, “Software\Microsoft\Windows\CurrentVersion\Explorer\TrayNotify\PastIconStream”)
    赋值 (刷新注册表, 真)
.如果真结束

.如果真 (.) ' 删除MediaPlayer播放记录
    删除注册项 (3, “Software\Microsoft\MediaPlayer\Player”)
    赋值 (刷新注册表, 真)
.如果真结束
 ' 本源码来自易语言资源网(www.wodesoft.com)
.如果真 (.) ' 删除IE浏览器地址栏
    删除注册项 (3, “Software\Microsoft\Windows\CurrentVersion\Internet Explorer\TypedURLs”)
    赋值 (刷新注册表, 真)
.如果真结束


.如果真 (.)
     ' 删除winzip打开的文件记录
     ' 我的电脑没有安装WINZIP，暂时不知相关的注册表项
.如果真结束

.如果真 (.)
     ' 删除readPlayer播放记录
     ' 我的电脑没有安装readPlayer，暂时不知相关的注册表项
.如果真结束

.如果真 (.)
    删除多文件 (自定义取特定目录 (17)) ' 删除网页临时文件
    
.如果真结束

.如果真 (.)
    删除多文件 (自定义取特定目录 (11)) ' 删除临时文件目录
.如果真结束

.如果真 (.)
    删除多文件 (自定义取特定目录 (15)) ' 删除COOKIES文件目录
.如果真结束


.如果真 (.)
    删除多文件 (自定义取特定目录 (18)) ' 删除最近打开的文件
.如果真结束

.如果真 (.)
    
    删除多文件 (自定义取特定目录 (16)) ' 删除历史记录
.如果真结束
 ' 本源码来自易语言资源网(www.wodesoft.com)
.如果真 (.)
    删除多文件 (相加 (自定义取特定目录 (8), “Microsoft\Office\Recent\”)) ' 删除OFFICE回收站
.如果真结束

.如果真 (.)
    清空回收站 (取窗口句柄 (), 0, 7) ' 清空回收站
.如果真结束

.如果真 (刷新注册表)
    .如果真 (结束进程 (“explorer.exe”))
        运行 (相加 (自定义取特定目录 (9), “explorer.exe”), 假, )
    .如果真结束
    
.如果真结束

恢复鼠标 ()
 ' 本源码来自易语言资源网(www.wodesoft.com)


.子程序 删除多文件, 空白型, , 
.参数 目录名, 文本型, , 

.局部变量 文件名, 文本型, , , 

 ' ----------------------------以下这段代码是寻找当前文件夹的所有文件------------------------------------------
处理事件 ()
.如果真 (不等于 (取文本右边 (目录名, 1), “\”))
    赋值 (目录名, 相加 (目录名, “\”))
.如果真结束
赋值 (文件名, 寻找文件 (相加 (目录名, “*.*”), ))
.判断循环首 (不等于 (文件名, “”))
    删除文件 (相加 (目录名, 文件名))
    赋值 (文件名, 寻找文件 ())
.判断循环尾 ()
 ' ----------------------------以下这段代码是寻找下一个文件夹------------------------------------------
赋值 (文件名, 寻找文件 (相加 (目录名, “*.*”), #子目录)) ' 寻找文件夹
.判断循环首 (不等于 (文件名, “”))
    .如果真 (不等于 (取文本左边 (文件名, 1), “.”)) ' “.”判断是文件夹就寻找这个文件夹的所有文件和文件夹。
        删除多文件 (相加 (目录名, 文件名))
    .如果真结束
    赋值 (文件名, 寻找文件 (#子目录))
.判断循环尾 ()
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _按钮2_被单击, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 选择框, 选择框, , , 
.局部变量 进入次数, 整数型, 静态, , 

 ' 本源码来自易语言资源网(www.wodesoft.com)
.如果 (等于 (进入次数, 1))
    赋值 (., “全选”)
    赋值 (进入次数, 0)
    .计次循环首 (15, i)
        赋值 (选择框, 取标记组件 (i))
        赋值 (选择框., 假)
    .计次循环尾 ()
    
.否则
    赋值 (., “全否”)
    赋值 (进入次数, 1)
    .计次循环首 (15, i)
        赋值 (选择框, 取标记组件 (i))
        赋值 (选择框., 真)
    .计次循环尾 ()
     ' 本源码来自易语言资源网(www.wodesoft.com)
.如果结束


.子程序 _按钮3_被单击, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 选择框, 选择框, , , 

.计次循环首 (15, i)
    赋值 (选择框, 取标记组件 (i))
    赋值 (选择框., 取反 (选择框.))
.计次循环尾 ()


.子程序 _Close_被单击, 空白型, , 
__启动窗口_可否被关闭 ()
返回 ()


.子程序 _Min_被单击, 空白型, , 
赋值 (., 2)
返回 ()
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
.局部变量 进入次数, 整数型, 静态, , 
.局部变量 返回值, 整数型, , , 

赋值 (进入次数, 相加 (进入次数, 1))
.如果真 (等于 (进入次数, 1))
    赋值 (., 假)
    设置按钮标题 (“退出系统(&E)”)
    赋值 (返回值, 自定义信息框 (取窗口句柄 (), “确认退出电脑记录清除器？”, 33, “退出系统”))
    .如果 (等于 (返回值, #确认钮))
        结束 ()
    .否则
        赋值 (., 真)
        赋值 (进入次数, 0)
        返回 (假)
    .如果结束
    
.如果真结束
返回 (假)

.子程序 __启动窗口_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

发送信息 (161, 2, 0)
返回 ()
' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 系统菜单句柄, 整数型, , , 

添加系统菜单 (取窗口句柄 ())
赋值 (系统菜单句柄, GetSystemMenu (取窗口句柄 (), 假))
RemoveMenu (系统菜单句柄, 4, 1024) ' 删除最大化菜单
获取焦点 ()

.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 设置按钮标题, 空白型, , 设置信息框按钮标题,可以只在需要时调用一次,也可以调用多次.但只能保留最后一次调用的设置,上一次的设置将被清除
.参数 确定钮标题, 文本型, 可空, 设置确定按钮要显示的标题,如果要加快捷键,后面加“&”＋一个英文字母,如果为空,则恢复为默认标题.下同
.参数 取消钮标题, 文本型, 可空, 
.参数 终止钮标题, 文本型, 可空, 
.参数 重试钮标题, 文本型, 可空, 
.参数 忽略钮标题, 文本型, 可空, 
.参数 是钮标题, 文本型, 可空, 
.参数 否钮标题, 文本型, 可空, 



.子程序 自定义信息框, 整数型, , 返回一个整数告诉用户单击了哪一个按钮,按钮值与易语言信息框完全一致
.参数 窗口句柄, 整数型, , 调用者窗口句柄,必须提供,如果为0,则按钮标题不会被改变
.参数 提示信息, 文本型, , 
.参数 按钮, 整数型, , 与易语言信息框的按钮完全一致
.参数 窗口标题, 文本型, , 



.子程序 自定义取特定目录, 文本型, , 本命令返回指定的Windows系统特定目录，所返回目录名以“\”符号结束，如失败返回空文本。
.参数 欲获取目录类型, 整数型, , 0:#网络邻居; 1: #我的文档;  2: #我的收藏夹;  3: #系统桌面;  4: #系统字体;  5: #开始菜单组;  6: #程序菜单组;  7: #启动菜单组;  8: #程序数据目录;  9: #Windows安装目录;  10: #Windows系统目录;  11: #临时文件目录;   12:#发送;  13:#ShellNew;  14:#PrintHood;  15:#Cookies目录;  16:#历史;  17:#网页临时文件;  18:#最近打开的文件。



.子程序 结束进程, 逻辑型, , 结束指定的进程名称，返回值为真代表成功，为假代表进程没有启动。
.参数 进程名称, 文本型, , 指定的进程名称



.子程序 添加系统菜单, 空白型, , 
.参数 hWnd, 整数型, , 




 ' 不属于任何一个程序集、类模块的函数：
