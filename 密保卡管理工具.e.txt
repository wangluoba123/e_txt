 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 316
    高度 = 154
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\密保卡管理工具.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “魔兽密保卡管理-登陆”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 262
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\密保卡管理工具.e\窗口1_图标.ico
    背景音乐 =  ' 空
    标题 = “魔兽密保卡管理工具 By Smile”
    帮助文件名 = “”

窗口 窗口2
    左边 = 50
    顶边 = 50
    宽度 = 400
    高度 = 574
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\密保卡管理工具.e\窗口2_图标.ico
    背景音乐 =  ' 空
    标题 = “新建密保卡档案”
    帮助文件名 = “”

窗口 窗口3
    左边 = 50
    顶边 = 50
    宽度 = 328
    高度 = 170
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\密保卡管理工具.e\窗口3_图标.ico
    背景音乐 =  ' 空
    标题 = “修改登陆密码”
    帮助文件名 = “”

窗口 窗口4
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 243
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\密保卡管理工具.e\窗口4_图标.ico
    背景音乐 =  ' 空
    标题 = “关于”
    帮助文件名 = “”



.常量 数据库扩展名, "“.wmd”", , 
.图片 内置数据库, " ' 已保存到：D:\易语言学习\Data\密保卡管理工具.e\内置数据库", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 5 系统核心支持库
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 1 0 数据操作支持库一





.窗口程序集 窗口程序集1, , , 

.程序集变量 目录, 文本型, , , 
.子程序 _窗口1_创建完毕, 空白型, , 
赋值 (目录, 相加 (取运行目录 (), “\”))
刷新卡号列表 ()

.子程序 刷新卡号列表, 空白型, , 
.局部变量 文件名, 文本型, , , 
.局部变量 计次变量, 整数型, , , 

赋值 (文件名, 寻找文件 (相加 (目录, “data\*”, #数据库扩展名), ))
清空 ()
赋值 (.内容, “请选择卡号...”)
.判断循环首 (不等于 (文件名, “”))
    .如果真 (并且 (不等于 (文件名, “.”), 不等于 (文件名, “..”)))
        取文本左边 (文件名, 相减 (取文本长度 (文件名), 1, 相减 (取文本长度 (文件名), 倒找文本 (文件名, “.”, , 假)))).加入项目 ()
    .如果真结束
    赋值 (文件名, 寻找文件 ())
.判断循环尾 ()



.子程序 _按钮2_被单击, 空白型, , 
关闭 ()
.判断开始 (打开 (相加 (目录, “data\”, .内容, #数据库扩展名), , , , , “wow”, ))
    信息框 (相加 (“卡号:”, .内容, “信息已载入!”, #换行符, 取错误信息 ()), #信息图标, “提示”)
.默认
    信息框 (相加 (“卡号:”, .内容, “载入失败!”, #换行符, 取错误信息 ()), #错误图标, “提示”)
.判断结束


.子程序 _新建密保卡_被选择, 空白型, , 
载入 (窗口2, , 真)


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 a, 文本型, , , 
.局部变量 a1, 文本型, , , 
.局部变量 b, 文本型, , , 
.局部变量 b1, 文本型, , , 
.局部变量 c, 文本型, , , 
.局部变量 c1, 文本型, , , 
.局部变量 密码, 文本型, , , 

赋值 (a, .内容)
赋值 (a1, .内容)
赋值 (b, .内容)
赋值 (b1, .内容)
赋值 (c, .内容)
赋值 (c1, .内容)
赋值 (密码, “”)
到首记录 ()
.如果 (查找 (等于 (读 (“序”), a)))
    .判断开始 (等于 (“1”))
        赋值 (相加 (读 (“列1”), “  ”))
    .判断 (等于 (“2”))
        赋值 (相加 (读 (“列2”), “  ”))
    .判断 (等于 (“3”))
        赋值 (相加 (读 (“列3”), “  ”))
    .判断 (等于 (“4”))
        赋值 (相加 (读 (“列4”), “  ”))
    .判断 (等于 (“5”))
        赋值 (相加 (读 (“列5”), “  ”))
    .判断 (等于 (“6”))
        赋值 (相加 (读 (“列6”), “  ”))
    .判断 (等于 (“7”))
        赋值 (相加 (读 (“列7”), “  ”))
    .判断 (等于 (“8”))
        赋值 (相加 (读 (“列8”), “  ”))
    .判断 (等于 (“9”))
        赋值 (相加 (读 (“列9”), “  ”))
    .判断 (等于 (“10”))
        赋值 (相加 (读 (“列10”), “  ”))
    .默认
        
    .判断结束
    
.否则
    跳过 ()
.如果结束

到首记录 ()
.如果 (查找 (等于 (读 (“序”), b)))
    .判断开始 (等于 (“1”))
        赋值 (相加 (读 (“列1”), “  ”))
    .判断 (等于 (“2”))
        赋值 (相加 (读 (“列2”), “  ”))
    .判断 (等于 (“3”))
        赋值 (相加 (读 (“列3”), “  ”))
    .判断 (等于 (“4”))
        赋值 (相加 (读 (“列4”), “  ”))
    .判断 (等于 (“5”))
        赋值 (相加 (读 (“列5”), “  ”))
    .判断 (等于 (“6”))
        赋值 (相加 (读 (“列6”), “  ”))
    .判断 (等于 (b1, “7”))
        赋值 (相加 (读 (“列7”), “  ”))
    .判断 (等于 (b1, “8”))
        赋值 (相加 (读 (“列8”), “  ”))
    .判断 (等于 (b1, “9”))
        赋值 (相加 (读 (“列9”), “  ”))
    .判断 (等于 (b1, “10”))
        赋值 (相加 (读 (“列10”), “  ”))
    .默认
        
    .判断结束
    
    
.否则
    跳过 ()
.如果结束

到首记录 ()
.如果 (查找 (等于 (读 (“序”), c)))
    .判断开始 (等于 (“1”))
        赋值 (相加 (读 (“列1”), “  ”))
    .判断 (等于 (“2”))
        赋值 (相加 (读 (“列2”), “  ”))
    .判断 (等于 (“3”))
        赋值 (相加 (读 (“列3”), “  ”))
    .判断 (等于 (“4”))
        赋值 (相加 (读 (“列4”), “  ”))
    .判断 (等于 (“5”))
        赋值 (相加 (读 (“列5”), “  ”))
    .判断 (等于 (“6”))
        赋值 (相加 (读 (“列6”), “  ”))
    .判断 (等于 (c1, “7”))
        赋值 (相加 (读 (“列7”), “  ”))
    .判断 (等于 (c1, “8”))
        赋值 (相加 (读 (“列8”), “  ”))
    .判断 (等于 (c1, “9”))
        赋值 (相加 (读 (“列9”), “  ”))
    .判断 (等于 (c1, “10”))
        赋值 (相加 (读 (“列10”), “  ”))
    .默认
        
    .判断结束
    
.否则
    跳过 ()
.如果结束

赋值 (.内容, 密码)


.子程序 _修改登陆密码_被选择, 空白型, , 
载入 (窗口3, , 真)

.子程序 _关于_被选择, 空白型, , 
载入 (窗口4, , 真)

.子程序 _退出_被选择, 空白型, , 
关闭 ()
结束 ()

.子程序 _窗口1_将被销毁, 空白型, , 
关闭 ()


.子程序 _删除密保卡_被选择, 空白型, , 
.判断开始 (等于 (信息框 (相加 (“你确定要删除卡号为”, .内容, “的密保卡吗？”), 相加 (#询问图标, #是否钮), “询问？”), #是钮))
    关闭 ()
    .判断开始 (删除文件 (相加 (目录, “data\”, .内容, “.db”)))
        信息框 (“密保卡删除成功！”, #信息图标, “提示”)
        刷新卡号列表 ()
    .默认
        信息框 (“密保卡删除失败！”, #信息图标, “提示”)
    .判断结束
    
.默认
    返回 ()
.判断结束


.子程序 _按钮3_被单击, 空白型, , 
关闭 ()
结束 ()


.子程序 _按钮4_被单击, 空白型, , 
赋值 (.内容, “请选择卡号...”)
连续赋值 (“”, .内容, .内容, .内容)
连续赋值 (“1”, .内容, .内容, .内容)
赋值 (.内容, “”)

.窗口程序集 窗口程序集2, , , 

.程序集变量 目录, 文本型, , , 
.程序集变量 配置文件名, 文本型, , , 
.程序集变量 pwd, 文本型, , , 
.子程序 _按钮1_被单击, 空白型, , 
.判断开始 (等于 (到文本 (未知支持库函数_2 (到字节集 (.内容))), pwd))
    载入 (窗口1, , 假)
    销毁 ()
.默认
    信息框 (“您输入的密码有误!请不要非法操作!”, #信息图标, “提示”)
.判断结束


.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (目录, 相加 (取运行目录 (), “\”))
赋值 (配置文件名, 相加 (目录, “system.dat”))
赋值 (pwd, 读配置项 (配置文件名, “system”, “system”, ))
创建目录 (“data”)




.窗口程序集 窗口程序集3, , , 

.子程序 _按钮_清空_被单击, 空白型, , 
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)


.子程序 _按钮_保存_被单击, 空白型, , 
写到文件 (相加 (取运行目录 (), “\data\”, .内容, #数据库扩展名), #内置数据库)
打开 (相加 (取运行目录 (), “\data\”, .内容, #数据库扩展名), , , , , “wow”, )
到尾记录 ()
加空记录 ()
写 (“序”, “A”)
写 (“列1”, .内容)
写 (“列2”, .内容)
写 (“列3”, .内容)
写 (“列4”, .内容)
写 (“列5”, .内容)
写 (“列6”, .内容)
写 (“列7”, .内容)
写 (“列8”, .内容)
写 (“列9”, .内容)
写 (“列10”, .内容)
到尾记录 ()
加空记录 ()
写 (“序”, “B”)
写 (“列1”, .内容)
写 (“列2”, .内容)
写 (“列3”, .内容)
写 (“列4”, .内容)
写 (“列5”, .内容)
写 (“列6”, .内容)
写 (“列7”, .内容)
写 (“列8”, .内容)
写 (“列9”, .内容)
写 (“列10”, .内容)
到尾记录 ()
加空记录 ()
写 (“序”, “C”)
写 (“列1”, .内容)
写 (“列2”, .内容)
写 (“列3”, .内容)
写 (“列4”, .内容)
写 (“列5”, .内容)
写 (“列6”, .内容)
写 (“列7”, .内容)
写 (“列8”, .内容)
写 (“列9”, .内容)
写 (“列10”, .内容)
到尾记录 ()
加空记录 ()
写 (“序”, “D”)
写 (“列1”, .内容)
写 (“列2”, .内容)
写 (“列3”, .内容)
写 (“列4”, .内容)
写 (“列5”, .内容)
写 (“列6”, .内容)
写 (“列7”, .内容)
写 (“列8”, .内容)
写 (“列9”, .内容)
写 (“列10”, .内容)
到尾记录 ()
加空记录 ()
写 (“序”, “E”)
写 (“列1”, .内容)
写 (“列2”, .内容)
写 (“列3”, .内容)
写 (“列4”, .内容)
写 (“列5”, .内容)
写 (“列6”, .内容)
写 (“列7”, .内容)
写 (“列8”, .内容)
写 (“列9”, .内容)
写 (“列10”, .内容)
到尾记录 ()
加空记录 ()
写 (“序”, “F”)
写 (“列1”, .内容)
写 (“列2”, .内容)
写 (“列3”, .内容)
写 (“列4”, .内容)
写 (“列5”, .内容)
写 (“列6”, .内容)
写 (“列7”, .内容)
写 (“列8”, .内容)
写 (“列9”, .内容)
写 (“列10”, .内容)
到尾记录 ()
加空记录 ()
写 (“序”, “G”)
写 (“列1”, .内容)
写 (“列2”, .内容)
写 (“列3”, .内容)
写 (“列4”, .内容)
写 (“列5”, .内容)
写 (“列6”, .内容)
写 (“列7”, .内容)
写 (“列8”, .内容)
写 (“列9”, .内容)
写 (“列10”, .内容)
到尾记录 ()
加空记录 ()
写 (“序”, “H”)
写 (“列1”, .内容)
写 (“列2”, .内容)
写 (“列3”, .内容)
写 (“列4”, .内容)
写 (“列5”, .内容)
写 (“列6”, .内容)
写 (“列7”, .内容)
写 (“列8”, .内容)
写 (“列9”, .内容)
写 (“列10”, .内容)
关闭 ()
信息框 (“保存成功!”, #信息图标, “提示”)
窗口1.刷新卡号列表 ()
销毁 ()


.窗口程序集 窗口程序集4, , , 

.程序集变量 目录, 文本型, , , 
.程序集变量 配置文件名, 文本型, , , 
.子程序 _按钮1_被单击, 空白型, , 
.局部变量 old, 文本型, , , 
.局部变量 x_old, 文本型, , , 

赋值 (old, 未知支持库函数_2 (到字节集 (.内容)))
赋值 (x_old, 读配置项 (配置文件名, “system”, “system”, ))
.判断开始 (等于 (old, x_old))
    .判断开始 (写配置项 (配置文件名, “system”, “system”, 到文本 (未知支持库函数_2 (到字节集 (.内容)))))
        信息框 (“密码修改成功!”, #信息图标, “提示”)
        载入 (_启动窗口, , 假)
        销毁 ()
    .默认
        信息框 (“密码修改失败!”, #信息图标, “提示”)
    .判断结束
    
.默认
    信息框 (“输入的旧密码有误!请不要非法操作!”, #警告图标, “提示”)
.判断结束


.子程序 _窗口3_创建完毕, 空白型, , 
赋值 (目录, 相加 (取运行目录 (), “\”))
赋值 (配置文件名, 相加 (目录, “system.dat”))


.窗口程序集 窗口程序集5, , , 

.子程序 _按钮1_被单击, 空白型, , 
销毁 ()



 ' 不属于任何一个程序集、类模块的函数：
