 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 256
    高度 = 339
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “私人磁盘”
    帮助文件名 = “”



.图片 sjk, " ' 已保存到：D:\易语言学习\Data\私人磁盘.e\sjk", , 
.常量 数据库1, "“cpan”", , 
.常量 是否有密码, "“是否有密码”", , 
.常量 对应盘符, "“对应盘符”", , 
.常量 盘符, "“盘符”", , 
.常量 设置密码, "“设置密码”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库



 ' 所需要的模块
 ' 设置磁盘驱动器 C:\Documents and Settings\Administrator\桌面\设置磁盘驱动器.ec



.窗口程序集 窗口程序集1, , , 

.子程序 恢复, 空白型, , 
.局部变量 记录, 整数型, , , 
.局部变量 bb, 文本型, , , 

.计次循环首 (取表项数 (), 记录)
    赋值 (bb, 取文本盘符 (相减 (记录, 1).取标题 (1)))
    恢复私人盘 (bb)
.计次循环尾 ()
延时 (1000)

.子程序 显示, 空白型, , 
.局部变量 显示列表, 文本型, , "0", 
.局部变量 循环次数, 整数型, , , 
.局部变量 盘符, 文本型, , , 
.局部变量 对应盘符, 文本型, , , 
.局部变量 取盘符, 文本型, , , 

全部删除 ()
赋值 (显示列表, 未知支持库函数_5 (1))
.计次循环首 (取数组成员数 (显示列表), 循环次数)
    赋值 (盘符, 显示列表 [循环次数])
    相减 (循环次数, 1).插入表项 ()
    相减 (循环次数, 1).置标题 (0, 相加 (盘符, “\”))
    跳到 (循环次数)
    赋值 (对应盘符, 读 (#对应盘符))
    赋值 (取盘符, 取文本左边 (对应盘符, 相减 (倒找文本 (对应盘符, “\”, , 假), 1)))
    .判断开始 (等于 (盘符, 取盘符))
        相减 (循环次数, 1).置标题 (1, 读 (#盘符))
        相减 (循环次数, 1).置标题 (2, 到文本 (读 (#是否有密码)))
    .默认
        
    .判断结束
    
.计次循环尾 ()
关闭1 ()

.子程序 判断字母, 文本型, , 
.参数 欲判断的字母, 文本型, , 

.局部变量 变量11, 文本型, , , 

.判断开始 (等于 (欲判断的字母, “A:”))
    赋值 (变量11, “B:”)
.判断 (等于 (欲判断的字母, “B:”))
    赋值 (变量11, “C:”)
    
.判断 (等于 (欲判断的字母, “C:”))
    赋值 (变量11, “D:”)
    
.判断 (等于 (欲判断的字母, “D:”))
    赋值 (变量11, “E:”)
    
.判断 (等于 (欲判断的字母, “E:”))
    赋值 (变量11, “F:”)
    
.判断 (等于 (欲判断的字母, “F:”))
    赋值 (变量11, “G:”)
    
.判断 (等于 (欲判断的字母, “G:”))
    赋值 (变量11, “H:”)
    
.判断 (等于 (欲判断的字母, “H:”))
    赋值 (变量11, “I:”)
    
.判断 (等于 (欲判断的字母, “I:”))
    赋值 (变量11, “J:”)
    
.判断 (等于 (欲判断的字母, “J:”))
    赋值 (变量11, “K:”)
    
.判断 (等于 (欲判断的字母, “K:”))
    赋值 (变量11, “L:”)
    
.判断 (等于 (欲判断的字母, “L:”))
    赋值 (变量11, “M:”)
    
.判断 (等于 (欲判断的字母, “M:”))
    赋值 (变量11, “N:”)
    
.判断 (等于 (欲判断的字母, “N:”))
    赋值 (变量11, “O:”)
    
.判断 (等于 (欲判断的字母, “O:”))
    赋值 (变量11, “P:”)
    
.判断 (等于 (欲判断的字母, “P:”))
    赋值 (变量11, “Q:”)
    
.判断 (等于 (欲判断的字母, “Q:”))
    赋值 (变量11, “R:”)
    
.判断 (等于 (欲判断的字母, “R:”))
    赋值 (变量11, “S:”)
    
.判断 (等于 (欲判断的字母, “S:”))
    赋值 (变量11, “T:”)
    
.判断 (等于 (欲判断的字母, “T:”))
    赋值 (变量11, “U:”)
    
.判断 (等于 (欲判断的字母, “U:”))
    赋值 (变量11, “V:”)
    
.判断 (等于 (欲判断的字母, “V:”))
    赋值 (变量11, “W:”)
    
.判断 (等于 (欲判断的字母, “W:”))
    赋值 (变量11, “X:”)
    
.判断 (等于 (欲判断的字母, “X:”))
    赋值 (变量11, “Y:”)
    
.判断 (等于 (欲判断的字母, “Y:”))
    赋值 (变量11, “Z:”)
    
.默认
    
.判断结束
返回 (变量11)

.子程序 显示1, 空白型, , 
.局部变量 记录, 整数型, , , 
.局部变量 bb, 文本型, , , 

.计次循环首 (取表项数 (), 记录)
    赋值 (bb, 相减 (记录, 1).取标题 (1))
    .判断开始 (不等于 (bb, “”))
        bb.查找表项 ().删除表项 ()
    .默认
        
    .判断结束
    
.计次循环尾 ()

.子程序 _按钮7_被单击, 空白型, , 
.局部变量 列表, 文本型, , "0", 
.局部变量 次数, 整数型, , , 
.局部变量 记录盘符, 文本型, , , 
.局部变量 取盘符, 文本型, , , 
.局部变量 记录1, 文本型, , , 
.局部变量 取盘符1, 文本型, , , 
.局部变量 qq, 文本型, , , 

赋值 (取盘符, 取文本左边 (.取标题 (., ), 相减 (倒找文本 (.取标题 (., ), “\”, , 假), 1)))
赋值 (列表, 未知支持库函数_5 (0))
.计次循环首 (取数组成员数 (列表), 次数)
    赋值 (记录盘符, 列表 [次数])
.计次循环尾 ()
赋值 (取盘符1, 判断字母 (记录盘符))
赋值 (记录1, 判断字母 (取字母盘符 ()))
赋值 (qq, 取字母盘符 ())
关闭1 ()
.判断开始 (等于 (., -1))
    信息框 (“请先选择欲要设置的盘符”, 0, )
    返回 ()
.判断 (等于 (设置磁盘驱动器 (取盘符, qq), 真))
    恢复 ()
    加空记录 ()
    写 (#盘符, 相加 (记录1, “\”))
    写 (#对应盘符, 相加 (取盘符, “\”))
    
    关闭1 ()
    显示 ()
    显示1 ()
    
.默认
    .如果真 (等于 (设置磁盘驱动器 (取盘符, 记录盘符), 真))
        恢复 ()
        加空记录 ()
        写 (#盘符, 相加 (取盘符1, “\”))
        写 (#对应盘符, 相加 (取盘符, “\”))
        关闭1 ()
        显示 ()
        显示1 ()
        
        
    .如果真结束
    
.判断结束


.子程序 取字母盘符, 文本型, , 
.局部变量 返回字母, 文本型, , , 
.局部变量 记录盘符1, 整数型, , , 

到尾记录 ()
赋值 (返回字母, 取文本盘符 (读 (#盘符)))
返回 (返回字母)

.子程序 关闭1, 空白型, , 
.局部变量 jl, 文本型, , , 
.局部变量 xh, 整数型, , , 


.计次循环首 (取表项数 (), xh)
    赋值 (jl, 取文本盘符 (相减 (xh, 1).取标题 (1)))
    .判断循环首 (等于 (目录是否存在 (相加 (jl, “\”)), 真))
        彻底删除驱动器 (jl)
        处理事件 ()
        .判断开始 (等于 (目录是否存在 (相加 (jl, “\”)), 假))
            跳出循环 ()
        .默认
            
        .判断结束
        
    .判断循环尾 ()
.计次循环尾 ()

.子程序 _按钮6_被单击, 空白型, , 
.局部变量 加密, 文本型, , , 
.局部变量 读是否加密了, 逻辑型, , , 

.判断开始 (等于 (., -1))
    信息框 (“请先选择您要加密的私人磁盘”, 0, )
    返回 ()
.判断 (等于 (.取标题 (., 1), “”))
    信息框 (“对不起，您选择的盘符还为创建私人盘”, 0, )
    返回 ()
.判断 (不等于 (.取标题 (., 1), “”))
    跳到 (相加 (., 1))
    赋值 (读是否加密了, 读 (#是否有密码))
    .如果 (等于 (读是否加密了, 真))
        信息框 (“该私人磁盘已加密”, 0, )
        返回 ()
    .否则
        
    .如果结束
    
    
    
    .如果 (等于 (输入框 (“请输入您要加密盘符的密码，并请牢记该密码。”, “加密盘符”, “”, 加密, 4), 真))
        写 (#设置密码, 加密)
        写 (#是否有密码, 真)
        信息框 (“私人磁盘密码设置成功,请重新运行本程序。”, 0, )
        显示 ()
        显示1 ()
    .否则
        
    .如果结束
    
.默认
    
.判断结束


.子程序 _按钮4_被单击, 空白型, , 
.局部变量 密码, 文本型, , , 
.局部变量 输入密码, 文本型, , , 
.局部变量 变量, 文本型, , , 

.判断开始 (等于 (., -1))
    信息框 (“请先选择欲要删除私人磁盘”, 0, )
    返回 ()
.判断 (等于 (.取标题 (., 1), “”))
    信息框 (“您还未创建该私人磁盘。”, 0, )
    返回 ()
.判断 (不等于 (.取标题 (., 1), “”))
    跳到 (相加 (., 1))
    赋值 (密码, 读 (#设置密码))
    赋值 (变量, 取文本盘符 (.取标题 (., 1)))
    .如果真 (不等于 (密码, “”))
        .如果真 (输入框 (“该私人磁盘已加密，请输入密码”, “输入密码”, “”, 输入密码, 4))
            .如果真 (等于 (输入密码, 密码))
                
                .如果真 (不等于 (删除磁盘驱动器 (变量), -1))
                    .如果 (等于 (信息框 (相加 (“您确定要删除该私人磁盘  ”, 变量, “\  吗？”), 4, ), #是钮))
                        跳到 (相加 (., 1))
                        删除 ()
                        彻底删除 ()
                        信息框 (“私人磁盘删除成功”, 0, )
                        显示 ()
                        显示1 ()
                        延时 (2000)
                        彻底删除驱动器 (变量)
                        返回 ()
                    .否则
                        
                    .如果结束
                    
                .如果真结束
                返回 ()
                
            .如果真结束
            
        .如果真结束
        返回 ()
        
    .如果真结束
    .如果真 (等于 (恢复私人盘 (变量), -1))
        信息框 (“删除私人磁盘失败”, 0, )
        返回 ()
    .如果真结束
    .如果真 (不等于 (删除磁盘驱动器 (变量), -1))
        
        
        .如果 (等于 (信息框 (相加 (“您确定要删除该私人磁盘  ”, 变量, “\  吗？”), 4, ), #是钮))
            跳到 (相加 (., 1))
            删除 ()
            彻底删除 ()
            信息框 (“私人磁盘删除成功”, 0, )
            显示 ()
            显示1 ()
            延时 (2000)
            彻底删除驱动器 (变量)
            
            返回 ()
        .否则
            
        .如果结束
        
    .如果真结束
    
.默认
    
.判断结束


.子程序 __启动窗口_将被销毁, 空白型, , 
.局部变量 次数1, 整数型, , , 
.局部变量 取字母, 文本型, , , 

.判断开始 (不等于 (取表项数 (), 0))
    .计次循环首 (取表项数 (), 次数1)
        赋值 (取字母, 取文本左边 (相减 (次数1, 1).取标题 (1), 相减 (倒找文本 (相减 (次数1, 1).取标题 (1), “\”, , 假), 1)))
        彻底删除驱动器 (取字母)
    .计次循环尾 ()
.默认
    
.判断结束


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 密码, 文本型, , , 
.局部变量 输入密码, 文本型, , , 

.判断开始 (等于 (., -1))
    信息框 (“请先选择欲要恢复的盘符”, 0, )
    返回 ()
.判断 (等于 (.取标题 (., 1), “”))
    信息框 (“对不起，您选择的盘符还为创建私人盘”, 0, )
    返回 ()
.判断 (不等于 (.取标题 (., 1), “”))
    跳到 (相加 (., 1))
    赋值 (密码, 读 (#设置密码))
    .如果真 (不等于 (密码, “”))
        .如果真 (输入框 (“该私人磁盘已加密，请输入密码”, “输入密码”, “”, 输入密码, 4))
            .如果真 (等于 (输入密码, 密码))
                恢复私人盘 (取文本盘符 (.取标题 (., 1)))
                
                信息框 (“私人磁盘已恢复”, 0, )
                返回 ()
            .如果真结束
            返回 ()
        .如果真结束
        返回 ()
    .如果真结束
    
    恢复私人盘 (取文本盘符 (.取标题 (., 1)))
    
    信息框 (“私人磁盘已恢复”, 0, )
    
    
    
    
.默认
    
.判断结束


.子程序 取文本盘符, 文本型, , 
.参数 欲取的文本, 文本型, , 

.局部变量 取文本盘符1, 文本型, , , 

赋值 (取文本盘符1, 取文本左边 (欲取的文本, 相减 (倒找文本 (欲取的文本, “\”, , 假), 1)))
返回 (取文本盘符1)

.子程序 _按钮8_被单击, 空白型, , 
.局部变量 密码, 文本型, , , 
.局部变量 输入密码, 文本型, , , 

.判断开始 (等于 (., -1))
    信息框 (“请先选择欲要打开的盘符”, 0, )
    返回 ()
.判断 (等于 (.取标题 (., 1), “”))
    信息框 (“对不起，您选择的盘符还为创建私人盘”, 0, )
    返回 ()
.判断 (不等于 (.取标题 (., 1), “”))
    跳到 (相加 (., 1))
    赋值 (密码, 读 (#设置密码))
    .如果真 (不等于 (密码, “”))
        .如果真 (输入框 (“该私人磁盘已加密，请输入密码”, “输入密码”, “”, 输入密码, 4))
            .如果真 (等于 (输入密码, 密码))
                打开私人盘 (取文本盘符 (.取标题 (., 1)))
                返回 ()
            .如果真结束
            返回 ()
        .如果真结束
        返回 ()
    .如果真结束
    
    打开私人盘 (取文本盘符 (.取标题 (., 1)))
    
    
.默认
    
.判断结束


.子程序 _按钮1_被单击, 空白型, , 
.判断开始 (等于 (., -1))
    信息框 (“请先选择欲要关闭的盘符”, 0, )
    返回 ()
.判断 (等于 (.取标题 (., 1), “”))
    信息框 (“对不起，您选择的盘符还为创建私人盘”, 0, )
    返回 ()
.判断 (不等于 (.取标题 (., 1), “”))
    关闭私人盘 (取文本盘符 (.取标题 (., 1)))
    信息框 (“私人磁盘已关闭”, 0, )
.默认
    
.判断结束


.子程序 __启动窗口_创建完毕, 空白型, , 
.判断开始 (等于 (文件是否存在 (相加 (未知支持库函数_7 (1), “\cpan.edb”)), 假))
    写到文件 (相加 (未知支持库函数_7 (1), “\cpan.edb”), #sjk)
.默认
    
.判断结束
打开 (相加 (未知支持库函数_7 (1), “\cpan.edb”), , , , , , )
置文件属性 (相加 (未知支持库函数_7 (1), “\cpan.edb”), 2)
显示 ()
显示1 ()
 ' 恢复 ()
未知支持库函数_0 (3)


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 设置磁盘驱动器, 逻辑型, , 成功返回 真 失败返回 假
.参数 磁盘目录, 文本型, , 
.参数 设置磁盘名称, 文本型, , 



.子程序 删除磁盘驱动器, 整数型, , 成功返回 1 失败 返回 -1
.参数 欲删除磁盘驱动器名称, 文本型, , 欲要删除的驱动器名称 例如 J： 大小写注意



.子程序 恢复私人盘, 整数型, , 成功返回 1 失败返回 -1
.参数 欲恢复私人盘, 文本型, , 只有没删除私人盘时可用 例如 C： 大小写注意



.子程序 目录是否存在, 逻辑型, , 判断目录是否存在
.参数 目录名, 文本型, , 



.子程序 打开私人盘, 逻辑型, , 成功返回 真 失败返回 假
.参数 欲打开盘符, 文本型, , 例如 C： 大小写注意



.子程序 关闭私人盘, 逻辑型, , 
.参数 欲关闭盘符, 文本型, , 



.子程序 彻底删除驱动器, 逻辑型, , 
.参数 彻底删除名称, 文本型, , 




 ' 不属于任何一个程序集、类模块的函数：
