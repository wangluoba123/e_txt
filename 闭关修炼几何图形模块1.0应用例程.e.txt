 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 785
    高度 = 442
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假



.常量 命令_隐藏菜单, "“隐藏菜单”", 隐藏, 
.常量 命令_空, "“”", 隐藏, 
.常量 命令_绘线段, "“绘线段”", 隐藏, 
.常量 命令_绘线段_空, "“”", 隐藏, 
.常量 命令_绘线段_输入起点, "“输入起点：”", 隐藏, 
.常量 命令_绘线段_输入下一点, "“输入下一点：”", 隐藏, 
.常量 命令_绘线段_撤消, "“撤消”", 隐藏, 
.常量 命令_绘线段_确认, "“确认”", 隐藏, 
.常量 命令_绘圆, "“绘圆”", 隐藏, 
.常量 图元_点, "1", 隐藏, 
.常量 图元_直线, "2", 隐藏, 
.常量 图元_线段, "3", 隐藏, 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库



 ' 所需要的模块
 ' 闭关修炼几何图形模块1.0 I:\图形设计\闭关修炼几何图形模块1.0.ec


数据类型 子空间, 公开, 访问图形的数据时，除了访问图形自身的图元数据外，还要访问子图形中的图元映射数据。修改图形的图元数据时，不能修改其子图形的图元映射数据，修改了也没有意义。要修改子图元的图元映射数据，必须打开子图形，然后修改其树结构中的数据。
    .成员 子坐标系, 未知类型0x410113C6, , , 空间的坐标原点在母空间坐标系中的位置
    .成员 旋转角, 未知类型0x410113C7, , , 
    .成员 轴线段, 未知类型0x410113C8, , , 特殊成员，需使用专门命令获取数据。子空间的轴线段定义，是用增量方式来定义端点的。
    .成员 比例因子, 坐标比例, , , 缩放因子，影响空间尺长度量相对于在母空间内量度比值的物理量，此缩放系数不改变物体的实际尺寸。在提取图形信息时是从最低层子空间逐层向上级母空间转换的，转换的仪依据就是子母空间的相对特性，此系数就是影向空间各轴向的缩放比例。
    .成员 时间因子, 双精度小数型, , , 时间因子，影响空间作用范围内物质世界运动快慢的物理量。时间因子是一个比值，是对母空间时间流失速度的修改。
    .成员 能量因子, 双精度小数型, , , 能量因子，影响空间时间变化快慢的物理量，一般应置为1，表示时间即不加速流失，也不减速流失。

数据类型 坐标, 公开, 
    .成员 x, 双精度小数型, , , 
    .成员 y, 双精度小数型, , , 
    .成员 z, 双精度小数型, , , 

数据类型 坐标集, 公开, 
    .成员 句柄, 整数型, , , 
    .成员 坐标, 坐标, , "1", 

数据类型 坐标比例, 公开, 
    .成员 SX, 双精度小数型, , , 
    .成员 SY, 双精度小数型, , , 
    .成员 SZ, 双精度小数型, , , 

数据类型 二维线段, 公开, 
    .成员 起点, 坐标, , , 
    .成员 尾点, 坐标, , , 
    .成员 一般式, 直线, , , 线段作为直线的一部分，应该具备直线所应有的一般定义信息，此法也使得即便是线段的起点和尾点相重合后，仍然可以进行各种变换运算。

数据类型 直线, 公开, 一般式
    .成员 A, 双精度小数型, , , 
    .成员 B, 双精度小数型, , , 
    .成员 C, 双精度小数型, , , 
    .成员 J, 双精度小数型, , , 直线的方位角，在标准方程式里面，没有这一概念。有了它就可以给直线定义一个参考正方向了，然后转动直线时就很方便写程序代码。

.全局变量 _图形空间, 未知类型0x410113C9, 公开, , 顶层空间保存了系统正在处理的全部图形图像信息，它是数据空间的局部映射，数据空间中的数据需经过顶层空间才能显示到屏幕上。但不是所有的数据空间都一定要显示到屏幕上，所以不是所有的数据空间中的数据都一定要转换到顶层空间。并且，在进行数据空间中的数据向顶层空间转换时，不需要确保真实性和完整性。比如数据空间中的一个子图元因为比例问题在顶层空间中显得过小，可以将其全部或部分转化为一个点来考虑。

.窗口程序集 窗口程序集1, , , 

.程序集变量 绘图类, 未知类型0x490112E0, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
绘图类.未知函数_67179204 ()

.子程序 __启动窗口_将被销毁, 空白型, , 
绘图类.未知函数_67179205 ()

.子程序 _按钮绘线段_被单击, 空白型, , 
赋值 (.)

.子程序 _画板1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 绘图类.未知函数_67179208 (横向位置, 纵向位置, 功能键状态))

.子程序 _画板1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 绘图类.未知函数_67179209 (横向位置, 纵向位置, 功能键状态))

.子程序 _画板1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

绘图类.未知函数_67179210 (横向位置, 纵向位置, 功能键状态)

.子程序 _画板1_滚轮被滚动, 逻辑型, , 
.参数 滚动距离, 整数型, , 
.参数 功能键状态, 整数型, , 

绘图类.未知函数_67179211 (滚动距离, 功能键状态)

.子程序 _列表框1_列表项被选择, 空白型, , 
赋值 (., 绘图类.未知函数_67179212 ())

.子程序 _选择框最近点_被单击, 空白型, , 
绘图类.未知函数_67179213 (.)

.子程序 _按钮保存图片_被单击, 空白型, , 
赋值 (., 1)
.如果真 (打开 ())
    绘图类.未知函数_67179207 (相加 (., “.bmp”))
.如果真结束


.类模块 图形空间类, , , 负责将数据空间中的数据转换为图形图像，并以特定格式（便用提高系统效率）保存了必要的数据空间中的信息；负责将图形图像信息转换数据空间中保存。

.子程序 置图形空间, 空白型, , 调用本类之前，一定要检查是否重置了图形空间，如果没有，将出现错误。改变图形空间时，也要使用本方法。
.参数 参图形空间, 未知类型0x410113C9, 可空, 



.子程序 显示全部, 空白型, , 将当前空间的全部图元显示到屏幕


.子程序 取图形, 未知类型0x410113C9, , 


.子程序 取空间, 子空间, , 


.子程序 置空间, 空白型, , 
.参数 参空间, 子空间, , 



.子程序 转空间坐标, 坐标, , 画板坐标转空间坐标，顶层图像空间被看成是画板空间的子空间
.参数 参画板坐标, 坐标, , 



.子程序 转画板坐标, 坐标, , 空间坐标转画板坐标，顶层图像空间被看成是画板空间的子空间
.参数 参空间坐标, 坐标, , 



.子程序 转画板坐标集, 坐标集, , 
.参数 参空间坐标集, 坐标, 数组, 



.子程序 添加图元, 空白型, , 
.参数 参图元, 未知类型0x410113CA, , 



.子程序 添加线段, 空白型, , 
.参数 参线段, 二维线段, , 



.类模块 生成调用对象源码类, , , 

.子程序 快速生成调用对象源码文本, 空白型, , 调用此模块的程序在调用后结速运行，结果存放在剪辑板中，可直接在易语言集成开发环境中粘贴。
.参数 参对象标识名, 文本型, , 



.类模块 绘图类, , , 本类负责进行系统消息的预处理和分配详细处理任务

.子程序 开始任务, 空白型, , 调用绘图模块进行图形绘制之前，必须先调用本程序。
.参数 参前台画板, 画板, , 
.参数 参屏幕菜单, 列表框, , 系统将列表框作为屏幕显示菜单，请确保列表框位于前台画板之上。



.子程序 结束任务, 空白型, , 调用绘图模块结束图形绘制之后，必须调用本程序。


.子程序 命令, 文本型, , 向系统发送命令，系统根据命令文本及附加参数，决定下一步如何操作。
.参数 参命令, 文本型, 可空, 如果为空，表示继续当前命令；如果当前命令为空，表法新起动一个命令；如果当前命令不为空，表示继续或结束当前命令。
.参数 参预设值, 文本型, 可空, 通过该值，可以直接一次性完成整个命令操作，或指定命令的执行方式。



.子程序 保存图片, 逻辑型, , 
.参数 参文件名, 文本型, , 



.子程序 事件_鼠标左键被按下, 文本型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 



.子程序 事件_鼠标位置被移动, 文本型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 



.子程序 事件_鼠标右键被按下, 空白型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 



.子程序 事件_鼠标滚轮被滚动, 空白型, , 
.参数 滚动距离, 整数型, , 
.参数 功能键状态, 整数型, , 



.子程序 事件_屏幕菜单被选择, 文本型, , 


.子程序 捕捉_到最近点, 空白型, , 
.参数 参是否为真, 逻辑型, , 



.类模块 图形空间查找类, , , 

.子程序 查找最近点, 坐标, , 
.参数 参欲查找最近点的空间点, 坐标, , 
.参数 参考查到的最近点距离, 双精度小数型, 参考 可空, 
.参数 参考查到的最近点类型, 整数型, 参考 可空, 



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 CAD绘圆弧, 对象, , 〈对象(IAcadArc)〉 对象．对象型方法 （"AddArc"，Center，Radius，StartAngle，EndAngle）,  解释：以给定的圆心、半径、起点角度和端点角度创建圆弧
.参数 参圆心, 坐标, 可空, Center 默认圆心在坐标原点
.参数 参半径, 双精度小数型, , Radius
.参数 参起点角度, 双精度小数型, , StartAngle
.参数 参端点角度, 双精度小数型, , EndAngle



.子程序 CAD绘圆, 对象, , 〈对象(IAcadCircle)〉 对象．对象型方法 （"AddCircle"，Center，Radius）,  解释：以给定的圆心和半径创建圆
.参数 参圆心, 坐标, 可空, 参数<1>的名称为“Center”，类型为“变体型”。默认圆心在坐标原点
.参数 参半径, 双精度小数型, , 参数<2>的名称为“Radius”，类型为“双精度小数型”。



.子程序 CAD绘直线, 对象, , 〈对象(IAcadLine)〉 对象．对象型方法 （"AddLine"，StartPoint，EndPoint）,  解释：创建通过两点的直线
.参数 参起点坐标, 坐标, , 参数<1>的名称为“StartPoint”，类型为“变体型”。Variant[变体] (三元素双精度数组); 
.参数 参终点坐标, 坐标, , 参数<2>的名称为“EndPoint”，类型为“变体型”。Variant[变体] (三元素双精度数组); 



.子程序 CAD绘多行文字, 对象, , 〈对象(IAcadMText)〉 对象．对象型方法 （"AddMText"，InsertionPoint，Width，Text）,  解释：在插入点和边框宽度定义的矩形中创建多行文字图元
.参数 参插入点, 坐标, 可空, 参数<1>的名称为“InsertionPoint”，类型为“变体型”。Variant[变体] (三元素双精度数组); 仅用于输入多行文字边框的插入点。
.参数 参宽, 双精度小数型, , 参数<2>的名称为“Width”，类型为“双精度小数型”。Double[双精度]; 仅用于输入多行文字边框的宽度。
.参数 参文本, 文本型, , 参数<3>的名称为“Text”，类型为“文本型”。String[字符串]; 仅用于输入 MText 对象的实际文本字符串。



.子程序 CAD绘点, 对象, , 〈对象(IAcadPoint)〉 对象．对象型方法 （"AddPoint"，Point）,  解释：在给定的位置创建 Point 对象
.参数 参三维坐标, 坐标, 可空, 参数<1>的名称为“Point”，类型为“变体型”。Variant[变体] (三元素双精度数组); 仅用于输入要创建点的坐标。 



.子程序 CAD绘二维实心多边形, 对象, , 〈对象(IAcadSolid)〉 对象．对象型方法 （"AddSolid"，Point1，Point2，point3，Point4）,  解释：创建二维实心多边形
.参数 参坐标集, 坐标集, , 提供四组三维坐标值
.参数 参创建顺序, 整数型, 可空, 为空或0时，顶点顺序为1，2，3，4；否则顶点顺序为1，2，4，3。前两个点定义了多边形的一个边。第三个点定义了第二个点的对角方向位置。如果第四个点与第三个相同，则创建一个填充的三角形。只有 FILLMODE 系统变量设置为开时实体显示为填充状态。要设置或查询系统变量，可分别使用 SetVariable 和 GetVariable 方法。 



.子程序 CAD绘单行文字, 对象, , 〈对象(IAcadText)〉 对象．对象型方法 （"AddText"，TextString，InsertionPoint，Height）,  解释：创建单行文字
.参数 参文本, 文本型, , 参数<1>的名称为“TextString”，类型为“文本型”。String[字符串]; 仅用于输入显示的实际文字。
.参数 参插入点, 坐标, 可空, 参数<2>的名称为“InsertionPoint”，类型为“变体型”。Variant[变体] (三元素双精度数组); 仅用于输入文字放置到图形中的三维WCS坐标。
.参数 参高, 双精度小数型, , 参数<3>的名称为“Height”，类型为“双精度小数型”。Double[双精度]; 仅用于输入文字的高度。必须为正数。



.子程序 CAD转_双精度小数到变体形3d, 变体型, , 
.参数 参双精度小数型, 双精度小数型, , 



.子程序 CAD转_变体形3d到双精度小数, 变体型, , 
.参数 参变体型, 变体型, , 



.子程序 CAD转_坐标集2d转变体形n, 变体型, , 
.参数 参二维坐标集, 坐标集, , 



.子程序 CAD转_坐标3d转变体形3d, 变体型, , 
.参数 参三维坐标, 坐标, 可空, 



.子程序 CAD转_坐标集3d转变体形n, 变体型, , 
.参数 参三维坐标集, 坐标集, , 



.子程序 CAD转_变体形转坐标3d, 坐标, , 
.参数 参变体型坐标, 变体型, , 



.子程序 CAD转_角度转弧度, 双精度小数型, , 返回弧度,
.参数 参角度, 双精度小数型, , 



.子程序 CAD转_弧度转角度, 双精度小数型, , 返回角度,
.参数 参弧度, 双精度小数型, , 




 ' 不属于任何一个程序集、类模块的函数：
