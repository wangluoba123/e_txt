 ' 文件类型：Windows窗口程序

 ' 程序名称：WinXar 1.0
 ' 程序描述：系统之家压缩软件
@备注:
WinXar 1.0
 ' 程序作者：本源码来自易语言资源网(www.5a5x.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5a5x.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5a5x.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5a5x.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 810
    高度 = 597
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “WinXar 1.0 beta”
    帮助文件名 = “”

窗口 界面新建窗口
    左边 = 50
    顶边 = 50
    宽度 = 480
    高度 = 279
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “新建压缩包”
    帮助文件名 = “”

窗口 界面进度窗口
    左边 = 50
    顶边 = 50
    宽度 = 320
    高度 = 102
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 界面文件信息
    左边 = 50
    顶边 = 50
    宽度 = 320
    高度 = 260
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “WinXar 压缩文件信息”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' edroptarget {9DA96BF9CEBD45c5BFCF94CBE61671F5} 2 0 拖放支持库
 ' shell 52F260023059454187AF826A3C07AF2A 3 0 操作系统界面功能支持库
 ' xwx CBF69520-5300-43C4-B6D6-C2CF3F2A169B 1 0 xwxyh无限扩展库



 ' 所需要的模块
 ' 压缩解压模块 C:\Documents and Settings\Administrator\桌面\WinEYS.ec



.窗口程序集 窗口程序集1, , , 

.程序集变量 命令行, 文本型, , "0", 
.程序集变量 当前文件, 文本型, , , 
.程序集变量 其他信息, 文本型, , "0", 
.程序集变量 结果, 逻辑型, , , 
.子程序 __启动窗口_尺寸被改变, 空白型, , 
 ' --========  易语言资源网  (www.5a5x.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5a5x.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5a5x.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5a5x.com  ================--

赋值 (.倾斜, 相减 (_启动窗口., 1))
赋值 (.删除线, 相减 (_启动窗口., .可视, .))

.子程序 _新建_被选择, 空白型, , 
载入 (界面新建窗口, , 真)
.如果真 (不等于 (当前文件, “”))
    刷新文件列表数据 ()
.如果真结束


.子程序 _打开_被选择, 空白型, , 
赋值 (.标题, “请选择要打开的压缩包文件名：”)
.如果真 (打开 ())
    赋值 (当前文件, .文件名)
    刷新文件列表数据 ()
.如果真结束
 ' 本源码来自易语言资源网(www.5a5x.com)

.子程序 __启动窗口_创建完毕, 空白型, , 
取命令行 (命令行)
.如果真 (大于 (取数组成员数 (命令行), 0))
    .如果 (不等于 (命令行 [1], “”))
        赋值 (当前文件, 命令行 [1])
    .否则
        赋值 (当前文件, “”)
    .如果结束
    
.如果真结束
写注册项 (#根类, “.xar\”, “WinXar.exe”)
写注册项 (#根类, “WinXar.exe\DefaultIcom\”, 相加 (取运行目录 (), “\WinXar.exe,”))
写注册项 (#根类, “WinXar.exe\shell\open\command\”, 相加 (取运行目录 (), “\WinXar.exe  %1”))
.如果真 (不等于 (当前文件, “”))
    刷新文件列表数据 ()
.如果真结束
取窗口句柄 ().未知支持库函数_0 ()

.子程序 刷新文件列表数据, 空白型, , 
.局部变量 逻辑值, 逻辑型, , , 
.局部变量 文本1, 文本型, , , 

赋值 (逻辑值, 等于 (当前文件, “”))
.如果 (逻辑值)
    赋值 (., “WinXar”)
    1.置文本 (“”)
.否则
    赋值 (结果, 易压缩_取文件列表 (当前文件, , 文本1))
    .如果 (结果)
        赋值 (其他信息, 分割文本 (文本1, “|”, ))
        赋值 (., 相加 (当前文件, “ - WinXar”))
        1.置文本 (相加 (其他信息 [1], “版压缩包，共”, 其他信息 [2], “个文件，合计”, 其他信息 [3], “字节。”))
    .否则
        信息框 (易压缩_取错误文本 (), #错误图标, “错误”)
        赋值 (当前文件, “”)
        全部删除 ()
    .如果结束
     ' 本源码来自易语言资源网(www.5a5x.com)
.如果结束
赋值 (.禁止, 逻辑值)
赋值 (.禁止, 逻辑值)
赋值 (.禁止, 逻辑值)
赋值 (.禁止, 逻辑值)
.如果 (逻辑值)
    2.加入状态 (#禁止)
    4.加入状态 (#禁止)
    5.加入状态 (#禁止)
    6.加入状态 (#禁止)
    8.加入状态 (#禁止)
    9.加入状态 (#禁止)
.否则
    2.去除状态 (#禁止)
    4.去除状态 (#禁止)
    5.去除状态 (#禁止)
    6.去除状态 (#禁止)
    8.去除状态 (#禁止)
    9.去除状态 (#禁止)
.如果结束
1.置提示文本 (1.取文本 ())

.子程序 _解压全部_被选择, 空白型, , 
.局部变量 目录, 文本型, , , 

.如果真 (不等于 (当前文件, “”))
    赋值 (目录, 未知支持库函数_2 (“请选择释放文件的目录”, 假))
    .如果真 (不等于 (目录, “”))
        赋值 (界面进度窗口., “释放文件”)
        赋值 (界面进度窗口., 当前文件)
        赋值 (界面进度窗口., 目录)
        载入 (界面进度窗口, _启动窗口, 真)
    .如果真结束
    
.如果真结束


.子程序 _退出_被选择, 空白型, , 
销毁 ()

.子程序 __启动窗口_将被销毁, 空白型, , 
结束 ()

.子程序 _添加目录_被选择, 空白型, , 
.局部变量 目录, 文本型, , , 

.如果真 (不等于 (当前文件, “”))
    赋值 (目录, 未知支持库函数_2 (“请选择要添加的目录”, 假))
    .如果真 (不等于 (目录, “”))
        赋值 (界面进度窗口., “添加文件”)
        赋值 (界面进度窗口., 当前文件)
        清除数组 (界面进度窗口.)
        加入成员 (界面进度窗口., 目录)
        载入 (界面进度窗口, _启动窗口, 真)
        刷新文件列表数据 ()
    .如果真结束
    
.如果真结束


.子程序 _添加文件_被选择, 空白型, , 
.局部变量 文件名, 文本型, , "0", 

.如果真 (不等于 (当前文件, “”))
    赋值 (文件名, 多文件对话框 (“选择要添加的文件”, “Xar压缩包(*.xar)|*.xar”, 0, , ))
    .如果真 (大于 (取数组成员数 (文件名), 0))
        赋值 (界面进度窗口., “添加文件”)
        赋值 (界面进度窗口., 当前文件)
        清除数组 (界面进度窗口.)
        赋值 (界面进度窗口., 文件名)
        赋值 (界面进度窗口., 真)
        载入 (界面进度窗口, _启动窗口, 真)
        刷新文件列表数据 ()
    .如果真结束
    
.如果真结束


.子程序 _解压文件_被选择, 空白型, , 
.局部变量 表项索引, 整数型, , "0", 
.局部变量 次数1, 整数型, , , 
.局部变量 目标, 文本型, , , 

.如果真 (不等于 (当前文件, “”))
    赋值 (表项索引, 取被选择表项 ())
    .如果真 (大于 (取数组成员数 (表项索引), 0))
        赋值 (目标, 未知支持库函数_2 (“选择解压到的目录”, 假))
        .如果真 (不等于 (目标, “”))
            赋值 (界面进度窗口., “解压文件”)
            赋值 (界面进度窗口., 当前文件)
            清除数组 (界面进度窗口.)
            .计次循环首 (取数组成员数 (表项索引), 次数1)
                加入成员 (界面进度窗口., 表项索引.取标题 ( [次数1], ))
            .计次循环尾 ()
            赋值 (界面进度窗口., 目标)
            赋值 (界面进度窗口., 真)
            载入 (界面进度窗口, _启动窗口, 真)
        .如果真结束
         ' 本源码来自易语言资源网(www.5a5x.com)
    .如果真结束
    
.如果真结束


.子程序 _删除文件_被选择, 空白型, , 
.局部变量 表项索引, 整数型, , "0", 
.局部变量 次数1, 整数型, , , 

.如果真 (不等于 (当前文件, “”))
    赋值 (表项索引, 取被选择表项 ())
    .如果真 (大于 (取数组成员数 (表项索引), 0))
        .如果真 (等于 (信息框 (相加 (“你确定要删除”, 到文本 (取数组成员数 (表项索引)), “个文件？”), 相加 (#确认取消钮, #警告图标), “确认”), #确认钮))
            赋值 (界面进度窗口., “删除文件”)
            赋值 (界面进度窗口., 当前文件)
            清除数组 (界面进度窗口.)
            .计次循环首 (取数组成员数 (表项索引), 次数1)
                加入成员 (界面进度窗口., 表项索引.取标题 ( [次数1], ))
            .计次循环尾 ()
            赋值 (界面进度窗口., 真)
            载入 (界面进度窗口, _启动窗口, 真)
            刷新文件列表数据 ()
        .如果真结束
        
    .如果真结束
    
.如果真结束


.子程序 _重命名_被选择, 空白型, , 
.进入编辑 (.)

.子程序 _设置密码_被选择, 空白型, , 
.局部变量 表项索引, 整数型, , "0", 
.局部变量 次数1, 整数型, , , 
.局部变量 处理文件, 文本型, , "0", 

赋值 (.可视, 真)
处理事件 ()
赋值 (表项索引, 取被选择表项 ())
.如果真 (大于 (取数组成员数 (表项索引), 0))
    .计次循环首 (取数组成员数 (表项索引), 次数1)
        加入成员 (处理文件, 表项索引.取标题 ( [次数1], ))
    .计次循环尾 ()
.如果真结束
赋值 (结果, 易压缩_设置密码 (当前文件, “”, 处理文件))
赋值 (.可视, 假)
.如果 (结果)
    信息框 (结果, #错误图标, “设置密码失败”)
.否则
    刷新文件列表数据 ()
.如果结束


.子程序 _查找_被选择, 空白型, , 
.局部变量 文本1, 文本型, , , 
.局部变量 索引1, 整数型, , , 

.如果真 (输入框 (“请输入要查找的文件名”, “查找文件”, .取标题 (., 0), 文本1, #输入文本))
    赋值 (.可视, 真)
    .计次循环首 (取表项数 (), 索引1)
        .如果 (大于 (寻找文本 (相减 (索引1, 1).取标题 (0), 文本1, , 假), 0))
            相减 (索引1, 1).选择表项 ()
        .否则
            相减 (索引1, 1).取消表项选择 ()
        .如果结束
        
    .计次循环尾 ()
    赋值 (.可视, 假)
.如果真结束
 ' 本源码来自易语言资源网(www.5a5x.com)

.子程序 _显示信息_被选择, 空白型, , 
载入 (界面文件信息, _启动窗口, 真)

.子程序 _关于_被选择, 空白型, , 
未知支持库函数_13 (“WinXar”, 相加 (“本程序由 系统之家 正义使者 设计制作”, #换行符, “版权没有   欢迎侵权！”), “WinXar”)

.子程序 _拖放对象1_得到文件, 空白型, , 
.参数 接收到的文件路径, 文本型, , 

.局部变量 文件组, 文本型, , "0", 
.局部变量 索引1, 整数型, , , 

.如果真 (等于 (信息框 (相加 (“你要添加以下文件吗？”, #换行符, 接收到的文件路径), 相加 (#信息图标, #确认取消钮), “添加文件”), #确认钮))
    赋值 (文件组, 分割文本 (接收到的文件路径, #换行符, ))
    .如果真 (大于 (取数组成员数 (文件组), 0))
        赋值 (界面进度窗口., “添加文件”)
        赋值 (界面进度窗口., 当前文件)
        清除数组 (界面进度窗口.)
        赋值 (界面进度窗口., 文件组)
        赋值 (界面进度窗口., 真)
        载入 (界面进度窗口, _启动窗口, 真)
        刷新文件列表数据 ()
    .如果真结束
    
.如果真结束


.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.判断开始 (等于 (按钮索引, 0))
    _新建_被选择 ()
.判断 (等于 (按钮索引, 1))
    _打开_被选择 ()
.判断 (等于 (按钮索引, 2))
    _解压全部_被选择 ()
.判断 (等于 (按钮索引, 4))
    _添加文件_被选择 ()
.判断 (等于 (按钮索引, 5))
    _解压文件_被选择 ()
.判断 (等于 (按钮索引, 6))
    _删除文件_被选择 ()
.判断 (等于 (按钮索引, 8))
    _查找_被选择 ()
.判断 (等于 (按钮索引, 9))
    _显示信息_被选择 ()
.判断 (等于 (按钮索引, 11))
    未知支持库函数_13 (“WinXar”, 相加 (“本程序由 系统之家 正义使者 设计制作”, #换行符, “版权没有   欢迎侵权！”), “WinXar”)
.默认
    
.判断结束


.子程序 _超级列表框1_当前表项被改变, 空白型, , 
0.置文本 (相加 (“已选择了”, 到文本 (取已选择表项数 ()), “个文件。”))

.子程序 _超级列表框1_右键单击表项, 空白型, , 
.如果真 (不等于 (当前文件, “”))
    弹出菜单 ()
.如果真结束
 ' 本源码来自易语言资源网(www.5a5x.com)

.子程序 _超级列表框1_表头被单击, 空白型, , 
.参数 被单击列索引, 整数型, , 

输出调试文本 (到文本 (被单击列索引.取列宽 ()))

.子程序 _超级列表框1_结束编辑, 逻辑型, , 
.参数 表项索引, 整数型, , 

赋值 (.可视, 真)
处理事件 ()
赋值 (结果, 易压缩_重命名 (当前文件, 表项索引.取标题 (), .))
赋值 (.可视, 假)
.如果 (结果)
    返回 (真)
.否则
    信息框 (易压缩_取错误文本 (), #错误图标, “文件名修改失败”)
    返回 (假)
.如果结束


.窗口程序集 窗口程序集2, , , 

.子程序 _界面新建窗口_尺寸被改变, 空白型, , 
赋值 (.倾斜, 取用户区宽度 ())


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 文件夹名, 文本型, , , 

赋值 (文件夹名, 未知支持库函数_2 (“选择要压缩的文件夹：”, 假))
.如果真 (不等于 (文件夹名, “”))
    .插入表项 (文件夹名, 1, , , )
.如果真结束
_超级列表框1_被双击 (0, 0, 0)

.子程序 _按钮2_被单击, 空白型, , 
.局部变量 文件组, 文本型, , "0", 
.局部变量 索引1, 整数型, , , 

赋值 (文件组, 多文件对话框 (“请选择要压缩的文件”, “所有文件(*.*)|*.*”, , , 真))
.计次循环首 (取数组成员数 (文件组), 索引1)
    .如果真 (不等于 (文件组.查找表项 ( [索引1], , ), -1)) ' 剔除重复文件
        到循环尾 ()
    .如果真结束
    .插入表项 (文件组 [索引1], 0, , , )
.计次循环尾 ()
_超级列表框1_被双击 (0, 0, 0)

.子程序 _按钮3_被单击, 空白型, , 
.局部变量 当前项, 整数型, , "0", 
.局部变量 索引1, 整数型, , , 

赋值 (当前项, 取被选择表项 ())
.计次循环首 (取数组成员数 (当前项), 索引1)
    相加 (相减 (当前项 [索引1], 索引1), 1).删除表项 ()
.计次循环尾 ()


.子程序 _按钮5_被单击, 空白型, , 
赋值 (.类型, 1)
赋值 (.标题, “请选择要压缩到的压缩包文件名：”)
.如果真 (打开 ())
    赋值 (.内容, .文件名)
.如果真结束


.子程序 _按钮4_被单击, 空白型, , 
.局部变量 索引1, 整数型, , , 

.如果真 (等于 (取表项数 (), 0))
    信息框 (“请先添加要压缩的文件夹或文件。”, #信息图标, )
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请设置要压缩到的压缩文件名。”, #信息图标, )
    返回 ()
.如果真结束
赋值 (界面进度窗口., “压缩文件”)
清除数组 (界面进度窗口.)
.计次循环首 (取表项数 (), 索引1)
    加入成员 (界面进度窗口., 相减 (索引1, 1).取标题 (0))
.计次循环尾 ()
赋值 (界面进度窗口., .内容)
赋值 (界面进度窗口., .内容)
销毁 ()
处理事件 ()
载入 (界面进度窗口, _启动窗口, 真)


.子程序 _界面新建窗口_创建完毕, 空白型, , 
取窗口句柄 ().未知支持库函数_0 ()


.子程序 _拖放对象1_得到文件, 空白型, , 
.参数 接收到的文件路径, 文本型, , 

.局部变量 文件组, 文本型, , "0", 
.局部变量 索引1, 整数型, , , 

赋值 (文件组, 分割文本 (接收到的文件路径, #换行符, ))
.计次循环首 (取数组成员数 (文件组), 索引1)
    .如果 (等于 (取文件属性 (文件组 [索引1]), #子目录))
        .插入表项 (文件组 [索引1], 1, , , )
    .否则
        .插入表项 (文件组 [索引1], 0, , , )
    .如果结束
    
.计次循环尾 ()

.子程序 _超级列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 文本1, 文本型, , , 
.局部变量 整数1, 整数型, , , 

.如果 (大于 (., 0))
    赋值 (文本1, .取标题 (., 0))
.否则
    赋值 (文本1, 0.取标题 (0))
.如果结束
赋值 (整数1, 倒找文本 (文本1, “.”, , 假))
.如果 (大于 (整数1, 0))
    赋值 (文本1, 相加 (取文本左边 (文本1, 整数1), “xar”))
.否则
    赋值 (文本1, 相加 (删首尾空 (文本1), “.xar”))
.如果结束
赋值 (.内容, 文本1)


.窗口程序集 窗口程序集3, , , 

.程序集变量 处理方式, 文本型, , , 
.程序集变量 压缩包名, 文本型, , , 
.程序集变量 压缩包密码, 文本型, , , 
.程序集变量 处理文件名, 文本型, , "0", 
.程序集变量 目标名, 文本型, , , 
.程序集变量 是否自动关闭, 逻辑型, , , 
.程序集变量 结果, 逻辑型, , , 
.子程序 _界面进度窗口_创建完毕, 空白型, , 
赋值 (., 处理方式)
.如果真 (是否已创建 (_启动窗口))
    赋值 (., 相减 (_启动窗口., 100))
    赋值 (.宽度, 相减 (., 20))
    赋值 (.宽度, .宽度)
    赋值 (.左边, 相减 (相加 (.左边, .宽度), .宽度))
    赋值 (.左边, 相加 (.左边, 相除 (相减 (.宽度, .宽度), 2)))
    赋值 (., 相加 (_启动窗口., 相除 (相减 (_启动窗口., .), 2)))
    赋值 (., 相加 (_启动窗口., 相除 (相减 (_启动窗口., .), 2)))
.如果真结束


.子程序 _标签1_反馈事件, 整数型, , 
.参数 参数一, 整数型, , 
.参数 参数二, 整数型, , 

赋值 (.标题, 指针到文本 (参数二))
赋值 (.位置, 参数一)
赋值 (.内容, 相加 (到文本 (参数一), “%”))


.子程序 _按钮1_被单击, 空白型, , 
销毁 ()

.子程序 _界面进度窗口_将被销毁, 空白型, , 
赋值 (处理方式, “”)
清除数组 (处理文件名)
赋值 (压缩包名, “”)
赋值 (压缩包密码, “”)
赋值 (目标名, “”)
赋值 (是否自动关闭, 假)

.子程序 _界面进度窗口_首次激活, 空白型, , 
.判断开始 (等于 (处理方式, “压缩文件”))
    赋值 (结果, 易压缩_压缩文件 (处理文件名, 压缩包名, 压缩包密码, 真, ))
.判断 (等于 (处理方式, “释放文件”))
    赋值 (结果, 易压缩_解压文件 (压缩包名, 压缩包密码, 目标名, 真, , , ))
.判断 (等于 (处理方式, “添加文件”))
    赋值 (结果, 易压缩_压缩文件 (处理文件名, 压缩包名, 压缩包密码, 假, ))
.判断 (等于 (处理方式, “解压文件”))
    赋值 (结果, 易压缩_解压文件 (压缩包名, 压缩包密码, 目标名, 真, 处理文件名, , ))
.判断 (等于 (处理方式, “删除文件”))
    赋值 (结果, 易压缩_删除文件 (压缩包名, 处理文件名, ))
.默认
    
.判断结束
.如果 (结果)
    赋值 (.标题, “完成”)
    .如果真 (文件是否存在 (压缩包名))
        赋值 (_启动窗口., 压缩包名)
    .如果真结束
    
.否则
    信息框 (易压缩_取错误文本 (), #错误图标, “错误”)
    赋值 (是否自动关闭, 真)
.如果结束
.如果真 (是否自动关闭)
    赋值 (是否自动关闭, 假)
    销毁 ()
.如果真结束


.窗口程序集 窗口程序集4, , , 

.子程序 _按钮1_被单击, 空白型, , 
销毁 ()

.子程序 _界面文件信息_创建完毕, 空白型, , 
.局部变量 文本1, 文本型, , , 
.局部变量 整数1, 整数型, , , 

赋值 (文本1, _启动窗口.)
赋值 (整数1, 取整 (相乘 (相除 (到整数 (子文本替换 (_启动窗口. [5], “,”, , , , 真)), 到整数 (子文本替换 (_启动窗口. [3], “,”, , , , 真))), 100)))
赋值 (.标题, 相加 (“    文件名：”, 取文本右边 (相加 (取空白文本 (30), 取文本右边 (文本1, 相减 (取文本长度 (文本1), 倒找文本 (文本1, “\”, , 假)))), 30)))
赋值 (.标题, 相加 (“  压缩版本：”, 取文本右边 (相加 (取空白文本 (30), _启动窗口. [1]), 30)))
赋值 (.标题, 相加 (“  文件总数：”, 取文本右边 (相加 (取空白文本 (30), _启动窗口. [2]), 30)))
赋值 (.标题, 相加 (“文件总大小：”, 取文本右边 (相加 (取空白文本 (30), _启动窗口. [3]), 30)))
赋值 (.标题, 相加 (“压缩总大小：”, 取文本右边 (相加 (取空白文本 (30), _启动窗口. [4]), 30)))
赋值 (.标题, 相加 (“压缩包大小：”, 取文本右边 (相加 (取空白文本 (30), _启动窗口. [5]), 30)))
赋值 (.标题, 相加 (“    压缩率：”, 取文本右边 (相加 (取空白文本 (30), 到文本 (整数1), “%”), 30)))
赋值 (.位置, 整数1)

.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 易压缩_压缩文件, 逻辑型, , 成功返回真，失败返回假。但非致命错误也返回真，但会设错误文本。
.参数 文件名, 文本型, 数组, 要压缩的文件数组,可以同时包含文件夹和文件。
.参数 压缩包名称, 文本型, , 要压缩到的压缩文件名,必须是全路径名。
.参数 密码, 文本型, 可空, 要压缩到的压缩文件密码，可以为空。
.参数 是否覆盖, 逻辑型, 可空, 如果压缩包已经存在：本参数为真，覆盖整个压缩包。为假，添加或更新压缩包中文件。默认为真。
.参数 进度标签, 标签, 可空, 通过该标签的反馈事件接收压缩进度（参数一为进度，可直接引用。参数二为进度状态文本，可通过“指针到文本（参数二）”方式引用。）



.子程序 易压缩_解压文件, 逻辑型, , 成功返回真，失败返回假。但非致命错误也返回真，但会设错误文本。
.参数 压缩包名称, 文本型, , 要解压的压缩文件名。
.参数 密码, 文本型, 可空, 要解压到的压缩文件密码，可以为空。
.参数 目标文件夹, 文本型, 可空, 要解压到的目标文件夹，默认为压缩包所在文件夹。
.参数 是否询问覆盖, 逻辑型, 可空, 当目标文件夹中已经存在将解压的文件时,是否询问。默认为假,不询问，直接覆盖。
.参数 指定文件, 文本型, 可空 数组, 如果提供本参数，则只解压指定文件（本参数与下一参数同时提供时，只有本参数生效）
.参数 排除文件, 文本型, 可空 数组, 如果提供本参数，则解压除排除文件以外的文件
.参数 进度标签, 标签, 可空, 通过该标签的反馈事件接收解压缩进度（参数一为进度，可直接引用。参数二为进度状态文本，可通过“指针到文本（参数二）”方式引用。）



.子程序 易压缩_取文件列表, 逻辑型, , 成功返回真，失败返回假。但非致命错误也返回真，但会设错误文本。
.参数 压缩包名称, 文本型, , 要取文件列表的压缩文件名。
.参数 文件列表框, 超级列表框, 可空, 将文件列表信息填充于超级列表框中，会自动清除旧数据和设置列标题。
.参数 其他信息, 文本型, 可空, 用于存放其他信息，格式为：E版本|文件总数|原文件总大小|压缩文件总大小|压缩包大小



.子程序 易压缩_重命名, 逻辑型, , 成功返回真，失败返回假。但非致命错误也返回真，但会设错误文本。
.参数 压缩包名称, 文本型, , 要修改的压缩文件名。
.参数 旧文件名, 文本型, , 旧的文件名，是相对路径
.参数 新文件名, 文本型, , 新文件名，也是相对路径，不检查是否合理，若不合理会引起解压缩失败



.子程序 易压缩_删除文件, 逻辑型, , 成功返回真，失败返回假。但非致命错误也返回真，但会设错误文本。
.参数 压缩包名称, 文本型, , 要修改的压缩文件名。
.参数 要删除文件名, 文本型, 数组, 要删除的文件，是相对路径，不支持通配符
.参数 进度标签, 标签, 可空, 通过该标签的反馈事件接收解压缩进度（参数一为进度，可直接引用。参数二为进度状态文本，可通过“指针到文本（参数二）”方式引用。）



.子程序 易压缩_设置密码, 逻辑型, , 成功返回真，失败返回假。但非致命错误也返回真，但会设错误文本。
.参数 压缩包名称, 文本型, , 要修改的压缩文件名。
.参数 密码, 文本型, , 要设置的密码
.参数 要更改文件名, 文本型, 数组, 若文件已经加密则放弃设置密码，密码还是原密码



.子程序 易压缩_取错误文本, 文本型, , 返回上次命令执行中所发生的错误，如果有多个错误用换行符分隔



 ' 不属于任何一个程序集、类模块的函数：
