 ' 文件类型：Windows窗口程序

 ' 程序名称：QQ找茬 辅助工具
 ' 程序描述：QQ找茬 辅助工具
@备注:
QQ找茬 辅助工具
 ' 程序作者：本源码来自易语言资源网(www.wodesoft.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.wodesoft.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.wodesoft.com  =============--
 ' 版本号：2.2
 ' 创建号：0.0

窗口 截图窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假

窗口 _启动窗口
    左边 = 50
    顶边 = 50
    宽度 = 659
    高度 = 470
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 3
    底图方式 = 1
    底色 = 12632256 '  0xC0C0C0
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “QQ游戏-大家来找茬 辅助工具 测试版”
    帮助文件名 = “”



.图片 皮肤, " ' 已保存到：D:\易语言学习\Data\fdsfsd.e\皮肤", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' shellEx DA19AC3ADD2F4121AAD84AC5FBCAFC71 3 0 扩展功能支持库一
 ' iext6 {E60056EA-07A8-4bf5-B6F0-DF05DE6FAE1F} 2 0 扩展界面支持库六
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一



 ' 所需要的模块
 ' 的 C:\Documents and Settings\Administrator\桌面\窗口淡消.ec
 ' 快捷键 C:\Documents and Settings\Administrator\桌面\快捷键.ec
 ' 鼠标移入移出事件_模块 C:\Documents and Settings\Administrator\桌面\鼠标移入移出事件.ec


数据类型 矩形_, , RECT
    .成员 左边, 整数型, , , Left
    .成员 顶边, 整数型, , , Top
    .成员 右边, 整数型, , , Right
    .成员 底边, 整数型, , , Bottom

数据类型 PROCESSENTRY32, , 
    .成员 dwsize, 整数型, , , 296
    .成员 cntusage, 整数型, , , 引用数
    .成员 th32ProcessID, 整数型, , , 进程标识符
    .成员 th32defaultheapid, 整数型, , , 默认堆ID
    .成员 th32moduleid, 整数型, , , 进程模块标识符
    .成员 cntthreads, 整数型, , , 线程数
    .成员 th32ParentProcessID, 整数型, , , 父进程标识符
    .成员 pcpriclassbase, 整数型, , , 线程优先权
    .成员 dwflags, 整数型, , , 
    .成员 szExefile, 字节型, , "260", 进程名称

数据类型 THREADENTRY32, , 
    .成员 dwSize, 整数型, , , 
    .成员 cntUsage, 整数型, , , 
    .成员 th32ThreadID, 整数型, , , 
    .成员 th32OwnerProcessID, 整数型, , , 
    .成员 tpBasePri, 整数型, , , 
    .成员 tpDeltaPri, 整数型, , , 
    .成员 dwFlags, 整数型, , , 


.DLL命令 CreateToolhelp32Snapshot, 整数型, "", "", , 
    .参数 dwFlags, 整数型, , 
    .参数 th32ProcessID, 整数型, , 

.DLL命令 Process32First, 整数型, "", "", , 
    .参数 hSnapShot, 整数型, , 
    .参数 uProcess, PROCESSENTRY32, , 

.DLL命令 Thread32First, 整数型, "KERNEL32.DLL", "Thread32First", , 
    .参数 hSnapshot, 整数型, , 
    .参数 lpte, THREADENTRY32, , 

.DLL命令 EnumThreadWindows, 整数型, "user32", "EnumThreadWindows", , 
    .参数 dwThreadId, 整数型, , 
    .参数 lpfn, 子程序指针, , 
    .参数 lParam, 整数型, 传址, 

.DLL命令 Thread32Next, 整数型, "KERNEL32.DLL", "Thread32Next", , 
    .参数 hSnapshot, 整数型, , 
    .参数 lpte, THREADENTRY32, , 

.DLL命令 CloseHandle, 整数型, "kernel32.dll", "", , 
    .参数 hObject, 整数型, , 

.DLL命令 Process32Next, 整数型, "", "", , 
    .参数 hSnapShot, 整数型, , 
    .参数 uProcess, PROCESSENTRY32, , 

.DLL命令 GetParent, 整数型, "user32", "GetParent", , 
    .参数 hwnd, 整数型, , 

.DLL命令 ShowCursor, 空白型, "", "", , 
    .参数 显示, 整数型, , 

.DLL命令 SetCursorPos, 整数型, "", "SetCursorPos", , 
    .参数 x, 整数型, , 
    .参数 y, 整数型, , 

.DLL命令 取窗口矩形_, 整数型, "user32", "GetWindowRect", , 
    .参数 窗口句柄, 整数型, , 
    .参数 矩形区域, 矩形_, , 

.DLL命令 GetInputState, 整数型, "user32", "GetInputState", , 

.程序集 找茬程序集, , , 

.子程序 进程名取窗口句柄, 整数型, , 找不到将返回0
.参数 进程名, 文本型, , 

.局部变量 sHandle, 整数型, , , 
.局部变量 Pn, PROCESSENTRY32, , , 
.局部变量 lpTe, THREADENTRY32, , , 
.局部变量 Found, 整数型, , , 
.局部变量 ret, 整数型, , , 
.局部变量 sThread, 整数型, , , 
.局部变量 tFound, 整数型, , , 

赋值 (sHandle, CreateToolhelp32Snapshot (15, 0))
赋值 (Pn.dwsize, 296)
赋值 (Found, Process32First (sHandle, Pn))
.判断循环首 (不等于 (Found, 0))
    .如果真 (等于 (到小写 (到文本 (Pn.szExefile)), 到小写 (进程名)))
        赋值 (sThread, CreateToolhelp32Snapshot (4, 0))
        赋值 (lpTe.dwSize, 28)
        赋值 (tFound, Thread32First (sThread, lpTe))
        .判断循环首 (不等于 (tFound, 0))
            .如果真 (等于 (lpTe.th32OwnerProcessID, Pn.th32ProcessID))
                EnumThreadWindows (lpTe.th32ThreadID, &EnumThreadWndProc, ret)
                跳出循环 ()
            .如果真结束
            赋值 (tFound, Thread32Next (sThread, lpTe))
        .判断循环尾 ()
        CloseHandle (sThread)
        跳出循环 ()
    .如果真结束
    赋值 (Found, Process32Next (sHandle, Pn))
.判断循环尾 ()
CloseHandle (sHandle)
返回 (ret)

.子程序 EnumThreadWndProc, 整数型, , 
.参数 hwnd, 整数型, , 
.参数 lParam, 整数型, 参考, 

.局部变量 lHwnd1, 整数型, , , 
.局部变量 lHwnd2, 整数型, , , 

赋值 (lHwnd1, GetParent (hwnd))
.判断循环首 (不等于 (lHwnd1, 0)) ' 用取父窗口的方法,循环找到他祖宗.... :)
    赋值 (lHwnd2, lHwnd1)
    赋值 (lHwnd1, GetParent (lHwnd1))
.判断循环尾 ()
.如果真 (不等于 (lHwnd2, 0))
    赋值 (lParam, lHwnd2)
    返回 (0)
.如果真结束
返回 (1)

.窗口程序集 找茬窗口程序集, , , 

.程序集变量 热键ID, 整数型, , , 
.程序集变量 设置功能键, 整数型, , , 
.程序集变量 设置普通键, 整数型, , , 
.程序集变量 已捕获, 逻辑型, , , 
.程序集变量 图片宽, 整数型, , , 
.程序集变量 图片高, 整数型, , , 
.程序集变量 图1左边, 整数型, , , 
.程序集变量 图2左边, 整数型, , , 
.程序集变量 图12顶边, 整数型, , , 
.程序集变量 背景颜色, 整数型, , , 
.程序集变量 游戏句柄, 整数型, , , 
.程序集变量 游戏状态, 文本型, , , 
.程序集变量 透明度, 整数型, , , 
.程序集变量 常量, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 临时文件, 文本型, , , 
.局部变量 热键, 整数型, , , 

 ' --========  易语言资源网  (www.wodesoft.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.wodesoft.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.wodesoft.com  ================--

赋值 (透明度, .)
模块初始化 (_启动窗口, 真, 透明度)
赋值 (临时文件, 取临时文件名 ())
修改背景 ()
赋值 (图片宽, 381)
赋值 (图片高, 286)
赋值 (图1左边, 10)
赋值 (图2左边, 403)
赋值 (图12顶边, 186)
赋值 (.高度, 图片高)
赋值 (.宽度, 图片宽)
赋值 (.左边, 相加 (.宽度, 2))
赋值 (.高度, 图片高)
赋值 (.宽度, 图片宽)
赋值 (., 相加 (.左边, .宽度, 6))
添加鼠标移入移出事件 (取窗口句柄 (), &移入事件, &移出事件)
赋值 (游戏状态, “将辅助工具的左图与游戏的右图重合；置顶辅助工具；鼠标移到指定区域刷新图片！”)
0.置文本 (游戏状态)
赋值 (常量, 5)

.子程序 修改背景, 空白型, , 修改一些支持库不能自动更换背景的控件
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _抓图_被单击, 空白型, , 
.局部变量 句柄, 整数型, , , 
.局部变量 游戏窗口, 矩形_, , , 
.局部变量 鼠标X坐标, 整数型, , , 
.局部变量 鼠标Y坐标, 整数型, , , 

.如果 (等于 (进程名取窗口句柄 (“大家来找茬.exe”), 0))
    .如果 (不等于 (进程名取窗口句柄 (“大家来~1.exe”), 0))
        赋值 (游戏状态, “游戏已经运行！”)
        0.置文本 (游戏状态)
        赋值 (游戏句柄, 进程名取窗口句柄 (“大家来~1.exe”))
        取窗口矩形_ (游戏句柄, 游戏窗口)
        赋值 (鼠标X坐标, 取鼠标水平位置 ())
        赋值 (鼠标Y坐标, 取鼠标垂直位置 ())
        SetCursorPos (0, 0)
        载入 (截图窗口, , 假)
        赋值 (截图窗口., 图片宽)
        赋值 (截图窗口., 图片高)
        赋值 (截图窗口., 相加 (游戏窗口.顶边, 图12顶边))
        赋值 (截图窗口., 相加 (游戏窗口.左边, 图1左边))
        赋值 (., 假)
        延时 (50)
        赋值 (.底图, 快照 (截图窗口.取窗口句柄 (), , ))
        赋值 (截图窗口., 相加 (游戏窗口.左边, 图2左边))
        赋值 (.底图, 快照 (截图窗口.取窗口句柄 (), , ))
        赋值 (., 真)
        SetCursorPos (鼠标X坐标, 鼠标Y坐标)
        截图窗口.销毁 ()
    .否则
        赋值 (游戏状态, “游戏尚未运行！请检查游戏进程名是否为‘大家来找茬.exe’‘大家来~1.exe’”)
        0.置文本 (游戏状态)
    .如果结束
     ' 本源码来自易语言资源网(www.wodesoft.com)
.否则
    赋值 (游戏状态, “游戏已经运行！”)
    0.置文本 (游戏状态)
    赋值 (游戏句柄, 进程名取窗口句柄 (“大家来找茬.exe”))
    取窗口矩形_ (游戏句柄, 游戏窗口)
    赋值 (鼠标X坐标, 取鼠标水平位置 ())
    赋值 (鼠标Y坐标, 取鼠标垂直位置 ())
    SetCursorPos (0, 0)
    载入 (截图窗口, , 假)
    赋值 (截图窗口., 图片宽)
    赋值 (截图窗口., 图片高)
    赋值 (截图窗口., 相加 (游戏窗口.顶边, 图12顶边))
    赋值 (截图窗口., 相加 (游戏窗口.左边, 图1左边))
    赋值 (., 假)
    延时 (50)
    赋值 (.底图, 快照 (截图窗口.取窗口句柄 (), , ))
    赋值 (截图窗口., 相加 (游戏窗口.左边, 图2左边))
    赋值 (.底图, 快照 (截图窗口.取窗口句柄 (), , ))
    赋值 (., 真)
    SetCursorPos (鼠标X坐标, 鼠标Y坐标)
.如果结束
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _分析_被单击, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 ii, 整数型, , , 
.局部变量 游戏窗口, 矩形_, , , 

.清除 ()
.清除 ()
取窗口矩形_ (游戏句柄, 游戏窗口)
.计次循环首 (图片宽, i)
    .如果真 (不等于 (GetInputState (), 0))
        处理事件 ()
    .如果真结束
    .如果真 (等于 (求余数 (i, 3), 0))
        .计次循环首 (图片高, ii)
            .如果真 (不等于 (GetInputState (), 0))
                处理事件 ()
            .如果真结束
            .如果真 (等于 (求余数 (ii, 3), 0))
                .如果真 (不等于 (i.取点 (ii), i.取点 (ii)))
                    赋值 (.刷子颜色, #蓝色)
                    i.填充矩形 (ii, 相加 (i, 2.8), 相加 (ii, 2.8))
                .如果真结束
                 ' 本源码来自易语言资源网(www.wodesoft.com)
            .如果真结束
            
        .计次循环尾 ()
    .如果真结束
    
.计次循环尾 ()

.子程序 _按钮2_被单击, 空白型, , 
_抓图_被单击 ()
_分析_被单击 ()


.子程序 _按钮3_被单击, 空白型, , 
结束 ()


.子程序 _按钮1_被单击, 空白型, , 
.如果 (等于 (_启动窗口., 假))
    赋值 (.标题, “取消置顶(空格)”)
    赋值 (_启动窗口., 真)
.否则
    .如果 (等于 (_启动窗口., 真))
        赋值 (.标题, “置顶(空格)”)
        赋值 (_启动窗口., 假)
    .否则
         ' 本源码来自易语言资源网(www.wodesoft.com)
    .如果结束
    
.如果结束


.子程序 _标签1_反馈事件, 整数型, , 
.参数 参数一, 整数型, , 
.参数 参数二, 整数型, , 

_按钮1_被单击 ()


.子程序 _编辑框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.内容, 键码取键名 (键代码, 功能键状态)) ' 把编辑框的输入方式改成：只读方式
赋值 (设置功能键, 转换功能键 (功能键状态))
赋值 (设置普通键, 键代码)
赋值 (.起始选择位置, -1)
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 _按钮4_被单击, 空白型, , 
.如果真 (不等于 (热键ID, 0))
    未知支持库函数_11 (_启动窗口.取窗口句柄 (), 热键ID)
.如果真结束
未知支持库函数_10 (_启动窗口.取窗口句柄 (), 取窗口句柄 (), 设置功能键, 设置普通键)


.子程序 移入事件, 空白型, , 
.如果 (并且 (等于 (进程名取窗口句柄 (“大家来找茬.exe”), 0), 等于 (进程名取窗口句柄 (“大家来~1.exe”), 0)))
    赋值 (.背景颜色, #灰色)
.否则
    赋值 (.背景颜色, #灰色)
    _按钮2_被单击 ()
.如果结束
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 移出事件, 空白型, , 
.如果 (并且 (等于 (进程名取窗口句柄 (“大家来找茬.exe”), 0), 等于 (进程名取窗口句柄 (“大家来~1.exe”), 0)))
    赋值 (.背景颜色, #黑色)
.否则
    赋值 (.背景颜色, #黑色)
.如果结束


.子程序 _透明度调节_位置被改变, 空白型, , 
赋值 (透明度, .)
模块初始化 (_启动窗口, 真, 透明度)


.子程序 _时钟1_周期事件, 空白型, , 
.如果 (并且 (等于 (进程名取窗口句柄 (“大家来找茬.exe”), 0), 等于 (进程名取窗口句柄 (“大家来~1.exe”), 0)))
     ' 透明度调节.位置 ＝ 透明度调节.位置 ＋ 常量
    .如果真 (等于 (透明度, 250))
        赋值 (常量, -5)
    .如果真结束
    .如果真 (等于 (透明度, 100))
        赋值 (常量, 5)
    .如果真结束
    ' 本源码来自易语言资源网(www.wodesoft.com)
.否则
    
.如果结束


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 窗口淡消, 空白型, , 
.参数 待消窗口, 窗口, , 



.子程序 模块初始化, 空白型, , 在启动窗口创建完毕是调用
.参数 待消窗口, 窗口, , 
.参数 是否透明, 逻辑型, ,  
.参数 窗口透明度, 整数型, ,  



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 键码取键名, 文本型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 0为无功能键,1为Ctrl,2为Shift,3为Ctrl+Shift,4为Alt,5为Ctrl+Alt,6为Alt+Shift,7为Ctrl+Alt+Shift



.子程序 转换功能键, 整数型, , 把功能键状态的值转换为注册热键里的功能键值
.参数 功能键状态, 整数型, , 



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 添加鼠标移入移出事件, 空白型, , 添加鼠标移入移出事件
.参数 句柄, 整数型, , 指定控件句柄可以是任何组件
.参数 移入事件, 子程序指针, , 
.参数 移出事件, 子程序指针, , 



.子程序 删除鼠标移入移出事件, 整数型, , 
.参数 组件句柄, 整数型, , 



.子程序 删除所有鼠标移入移出事件, 空白型, , 



 ' 不属于任何一个程序集、类模块的函数：
