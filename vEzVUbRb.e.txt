 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 280
    高度 = 195
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\vEzVUbRb.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “加减乘除轻松测  白金版”
    帮助文件名 = “”

窗口 测试窗口
    左边 = 50
    顶边 = 50
    宽度 = 280
    高度 = 195
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\vEzVUbRb.e\测试窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “口算测试”
    帮助文件名 = “”

窗口 成绩窗口
    左边 = 50
    顶边 = 50
    宽度 = 280
    高度 = 195
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\vEzVUbRb.e\成绩窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “ 结果统计”
    帮助文件名 = “”

窗口 范围值窗口
    左边 = 50
    顶边 = 50
    宽度 = 280
    高度 = 195
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\vEzVUbRb.e\范围值窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “范围值设定”
    帮助文件名 = “”



.图片 托盘图标, " ' 已保存到：D:\易语言学习\Data\vEzVUbRb.e\托盘图标", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一




.全局变量 启动时间, 整数型, , , 计算测试开始的时间。
.全局变量 加数1, 整数型, , , 
.全局变量 加数2, 整数型, , , 
.全局变量 被减数, 整数型, , , 
.全局变量 减数, 整数型, , , 
.全局变量 乘数1, 整数型, , , 
.全局变量 乘数2, 整数型, , , 
.全局变量 被除数, 整数型, , , 
.全局变量 除数, 整数型, , , 
.全局变量 题数, 整数型, , , 完成题数。
.全局变量 正确数, 整数型, , , 完成的正确题数。

.DLL命令 关于王东, 空白型, "", "ShellAboutA", , 
    .参数 窗口句柄, 整数型, , 
    .参数 窗口标题, 文本型, , 
    .参数 作者信息, 文本型, , 
    .参数 图标句柄, 整数型, , 

.窗口程序集 窗口程序集1, , , 

.子程序 _组合框1_列表项被选择, 空白型, , 
.如果 (等于 (.现行选中项, 0))
    赋值 (., “题数：”)
    赋值 (.调节器上限值, 100)
    赋值 (.内容, “20”)
.否则
    赋值 (., “分钟：”)
    赋值 (.调节器上限值, 30)
    赋值 (.内容, “10”)
.如果结束


.子程序 _选择框1_被单击, 空白型, , 
播放MP3 (-1, “背景音乐.mp3”)


.子程序 _单选框1_被单击, 空白型, , 
.如果 (不等于 (.内容, “”))
    载入 (范围值窗口, , 真)
    赋值 (范围值窗口., 真)
.否则
    信息框 (“请输入你的姓名！    ”, 48, “提示”)
.如果结束



.子程序 __启动窗口_可否被关闭, 逻辑型, , 
.如果真 (等于 (是否已创建 (范围值窗口), 假))
    结束 ()
.如果真结束
返回 (真)


.子程序 _单选框3_被单击, 空白型, , 
.如果 (不等于 (.内容, “”))
    载入 (范围值窗口, , 真)
    赋值 (范围值窗口., 真)
.否则
    信息框 (“请输入你的姓名！    ”, 48, “提示”)
.如果结束




.子程序 _单选框2_被单击, 空白型, , 
.如果 (不等于 (.内容, “”))
    载入 (范围值窗口, , 真)
    赋值 (范围值窗口., 真)
.否则
    信息框 (“请输入你的姓名！    ”, 48, “提示”)
.如果结束




.子程序 _单选框4_被单击, 空白型, , 
.如果 (不等于 (.内容, “”))
    载入 (范围值窗口, , 假)
    赋值 (范围值窗口., 真)
.否则
    信息框 (“请输入你的姓名！    ”, 48, “提示”)
.如果结束




.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (., 280)
赋值 (., 195)
置托盘图标 (#托盘图标, “加减乘除轻松测  白金版”)


.子程序 __启动窗口_托盘事件, 空白型, , 
.参数 操作类型, 整数型, , 

.如果真 (等于 (操作类型, 1))
    弹出托盘菜单 ()
.如果真结束
 ' .如果真 (等于 (操作类型, 3))
    弹出托盘菜单 ()
.如果真结束



.子程序 _关于本程序_被选择, 空白型, , 
关于王东 (0, “加减乘除轻松测”, “王东工作室版权所有”, 0)


.子程序 _退出_被选择, 空白型, , 
销毁 ()


.子程序 __启动窗口_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _关于_被选择, 空白型, , 
未知函数_167838274 (0, “加减乘除轻松测”, “王东工作室版权所有”, 0)


.子程序 _退出本程序_被选择, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集2, , , 

.子程序 _测试窗口_创建完毕, 空白型, , 
.如果真 (_启动窗口..选中)
    赋值 (., “ 加法口算测试”)
    赋值 (., “+”)
.如果真结束
.如果真 (_启动窗口..选中)
    赋值 (., “ 减法口算测试”)
    赋值 (., “-”)
.如果真结束
.如果真 (_启动窗口..选中)
    赋值 (., “ 乘法口算测试”)
    赋值 (., “×”)
    赋值 (..字体大小, 15)
.如果真结束
.如果真 (_启动窗口..选中)
    赋值 (., “ 除法口算测试”)
    赋值 (., “÷”)
    赋值 (..字体大小, 15)
.如果真结束
赋值 (范围值窗口., 假)

.子程序 _测试窗口_可否被关闭, 逻辑型, , 
.如果真 (等于 (是否已创建 (_启动窗口), 假))
    结束 ()
.如果真结束
返回 (真)

.子程序 _时钟1_周期事件, 空白型, , 
.如果 (小于 (相减 (取启动时间 (), 启动时间), 60000))
    赋值 (., 相加 (“已用”, 到文本 (四舍五入 (相除 (相减 (取启动时间 (), 启动时间), 1000), 0)), “秒。”))
.否则
    赋值 (., 相加 (“已用”, 到文本 (整除 (相减 (取启动时间 (), 启动时间), 60000)), “分”, 到文本 (四舍五入 (求余数 (相除 (相减 (取启动时间 (), 启动时间), 1000), 60), 0)), “秒。”))
    
.如果结束
.如果真 (大于或等于 (相减 (取启动时间 (), 启动时间), 相乘 (到数值 (_启动窗口..内容), 60000)))
    赋值 (.时钟周期, 0)
    赋值 (.标题, “出题”)
    赋值 (.禁止, 真)
    赋值 (.标题, “结束”)
    信息框 (“规定的时间到！”, 48, “提示”)
    
.如果真结束




.子程序 _按钮1_被单击, 空白型, , 
赋值 (_启动窗口., 真)
范围值窗口.销毁 ()
测试窗口.销毁 ()
赋值 (_启动窗口..内容, “”)
赋值 (题数, 0)
赋值 (正确数, 0)


.子程序 _按钮2_被单击, 空白型, , 
赋值 (启动时间, 取启动时间 ())
赋值 (.时钟周期, 1000)
_是否结束出题 ()

.子程序 _按钮3_被单击, 空白型, , 
.如果真 (_启动窗口..选中)
    .如果 (等于 (到数值 (.内容), 相加 (加数1, 加数2)))
        赋值 (正确数, 相加 (正确数, 1))
        赋值 (., “答案：正确！”)
        赋值 (., #红色)
    .否则
        赋值 (正确数, 相加 (正确数, 0))
        赋值 (., “答案：错误！”)
        赋值 (., #蓝色)
    .如果结束
    _是否结束出题 ()
.如果真结束
.如果真 (_启动窗口..选中)
    .如果 (等于 (到数值 (.内容), 相减 (被减数, 减数)))
        赋值 (正确数, 相加 (正确数, 1))
        赋值 (., “答案：正确！”)
        赋值 (., #红色)
    .否则
        赋值 (正确数, 相加 (正确数, 0))
        赋值 (., “答案：错误！”)
        赋值 (., #蓝色)
    .如果结束
    _是否结束出题 ()
    
.如果真结束
.如果真 (_启动窗口..选中)
    .如果 (等于 (到数值 (.内容), 相乘 (乘数1, 乘数2)))
        赋值 (正确数, 相加 (正确数, 1))
        赋值 (., “答案：正确！”)
        赋值 (., #红色)
    .否则
        赋值 (正确数, 相加 (正确数, 0))
        赋值 (., “答案：错误！”)
        赋值 (., #蓝色)
    .如果结束
    _是否结束出题 ()
    
.如果真结束
.如果真 (_启动窗口..选中)
    .如果 (等于 (到数值 (.内容), 相除 (被除数, 除数)))
        赋值 (正确数, 相加 (正确数, 1))
        赋值 (., “答案：正确！”)
        赋值 (., #红色)
    .否则
        赋值 (正确数, 相加 (正确数, 0))
        赋值 (., “答案：错误！”)
        赋值 (., #蓝色)
    .如果结束
    _是否结束出题 ()
    
.如果真结束



.子程序 _按钮4_被单击, 空白型, , 
载入 (成绩窗口, , 假)


.子程序 _加法, 空白型, , 
置随机数种子 ()
赋值 (加数1, 取随机数 (到数值 (范围值窗口..内容), 到数值 (范围值窗口..内容)))
赋值 (加数2, 取随机数 (到数值 (范围值窗口..内容), 到数值 (范围值窗口..内容)))
赋值 (.内容, “”)
 ' .如果 (小于或等于 (相加 (加数1, 加数2), 100))
    赋值 (题数, 相加 (题数, 1))
    赋值 (.标题, 相加 (“第”, 到文本 (题数), “题”))
    赋值 (.内容, 到文本 (加数1))
    赋值 (.内容, 到文本 (加数2))
.否则
    _加法 ()
.如果结束


.子程序 _减法, 空白型, , 
置随机数种子 ()
赋值 (被减数, 取随机数 (到数值 (范围值窗口..内容), 到数值 (范围值窗口..内容)))
赋值 (减数, 取随机数 (到数值 (范围值窗口..内容), 到数值 (范围值窗口..内容)))
赋值 (.内容, “”)
.如果 (大于或等于 (被减数, 减数))
    赋值 (题数, 相加 (题数, 1))
    赋值 (.标题, 相加 (“第”, 到文本 (题数), “题”))
    赋值 (.内容, 到文本 (被减数))
    赋值 (.内容, 到文本 (减数))
.否则
    _减法 ()
.如果结束



.子程序 _乘法, 空白型, , 
置随机数种子 ()
赋值 (乘数1, 取随机数 (到数值 (范围值窗口..内容), 到数值 (范围值窗口..内容)))
赋值 (乘数2, 取随机数 (到数值 (范围值窗口..内容), 到数值 (范围值窗口..内容)))
赋值 (.内容, “”)
赋值 (题数, 相加 (题数, 1))
赋值 (.标题, 相加 (“第”, 到文本 (题数), “题”))
赋值 (.内容, 到文本 (乘数1))
赋值 (.内容, 到文本 (乘数2))


.子程序 _除法, 空白型, , 
置随机数种子 ()
赋值 (被除数, 取随机数 (到数值 (范围值窗口..内容), 到数值 (范围值窗口..内容)))
赋值 (除数, 取随机数 (到数值 (范围值窗口..内容), 到数值 (范围值窗口..内容)))
赋值 (.内容, “”)
.如果 (等于 (求余数 (被除数, 除数), 0))
    赋值 (题数, 相加 (题数, 1))
    赋值 (.标题, 相加 (“第”, 到文本 (题数), “题”))
    赋值 (.内容, 到文本 (被除数))
    赋值 (.内容, 到文本 (除数))
.否则
    _除法 ()
.如果结束


.子程序 _出题, 空白型, , 
赋值 (.标题, “下题”)
赋值 (.禁止, 真)
.如果真 (_启动窗口..选中)
    _加法 ()
.如果真结束
.如果真 (_启动窗口..选中)
    _减法 ()
.如果真结束
.如果真 (_启动窗口..选中)
    _乘法 ()
.如果真结束
.如果真 (_启动窗口..选中)
    _除法 ()
.如果真结束


.子程序 _是否结束出题, 空白型, , 
.如果真 (等于 (_启动窗口..现行选中项, 0))
    .如果 (大于或等于 (题数, 到数值 (_启动窗口..内容)))
        赋值 (.时钟周期, 0)
        赋值 (.标题, “出题”)
        赋值 (.禁止, 真)
        信息框 (“已完成规定的题目数！”, 48, “提示”)
    .否则
        _出题 ()
    .如果结束
    
.如果真结束
 ' .如果真 (等于 (_启动窗口..现行选中项, 1))
    .如果 (大于或等于 (相减 (取启动时间 (), 启动时间), 相乘 (到数值 (_启动窗口..内容), 60000)))
        赋值 (.时钟周期, 0)
        赋值 (.标题, “出题”)
        赋值 (.禁止, 真)
        赋值 (.标题, “结束”)
        信息框 (“规定的时间到！”, 48, “提示”)
    .否则
        _出题 ()
    .如果结束
    
.如果真结束



.窗口程序集 窗口程序集3, , , 

.子程序 _成绩窗口_创建完毕, 空白型, , 
赋值 (测试窗口..时钟周期, 0)
赋值 (., _启动窗口..内容)
赋值 (., 相加 (到文本 (题数), “题”))
赋值 (., 相加 (到文本 (正确数), “题”))
赋值 (., 测试窗口..)
赋值 (., 相加 (到文本 (相乘 (四舍五入 (相除 (正确数, 题数), 2), 100)), “%”))


.窗口程序集 窗口程序集4, , , 

.子程序 _范围值窗口_创建完毕, 空白型, , 
.如果真 (_启动窗口..选中)
    赋值 (.标题, “加数一”)
    赋值 (.标题, “加数二”)
.如果真结束
.如果真 (_启动窗口..选中)
    赋值 (.标题, “被减数”)
    赋值 (.标题, “减  数”)
.如果真结束
.如果真 (_启动窗口..选中)
    赋值 (.标题, “乘数一”)
    赋值 (.标题, “乘数二”)
.如果真结束
.如果真 (_启动窗口..选中)
    赋值 (.标题, “被除数”)
    赋值 (.标题, “除  数”)
    赋值 (.内容, “1”)
.如果真结束
赋值 (_启动窗口., 假)



.子程序 _按钮1_被单击, 空白型, , 
载入 (测试窗口, , 假)



.子程序 _范围值窗口_可否被关闭, 逻辑型, , 
.如果真 (等于 (是否已创建 (_启动窗口), 假))
    结束 ()
.如果真结束
返回 (真)


.子程序 _编辑框1_内容被改变, 空白型, , 
.如果真 (等于 (取文本长度 (.内容), 2))
    获取焦点 ()
    
.如果真结束


.子程序 _编辑框2_内容被改变, 空白型, , 
.如果真 (等于 (取文本长度 (.内容), 2))
    获取焦点 ()
.如果真结束


.子程序 _编辑框3_内容被改变, 空白型, , 
.如果真 (等于 (取文本长度 (.内容), 2))
    获取焦点 ()
.如果真结束
.如果真 (_启动窗口..选中)
     ' .如果真 (等于 (.内容, “0”))
        信息框 (“除数不能为0！    ”, 48, “警告”)
        赋值 (.内容, “1”)
    .如果真结束
    
.如果真结束



 ' 不属于任何一个程序集、类模块的函数：
