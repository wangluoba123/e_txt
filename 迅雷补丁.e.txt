 ' 文件类型：Windows窗口程序

 ' 程序名称：迅雷5补丁2in1
 ' 程序描述：仅供学习参考使用，后果自负！
 ' 程序作者：HaoSir
 ' 邮政编码：
 ' 联系地址：江苏南通
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：haosir.net
 ' 版权声明：本程序用易语言编写。
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 344
    高度 = 175
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16746496 '  0xFF8800
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\迅雷补丁.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “迅雷补丁2in1 08618修订版 By HaoSir”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 190
    高度 = 360
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “选择迅雷所在目录”
    帮助文件名 = “”



.图片 LinkSimulate, " ' 已保存到：D:\易语言学习\Data\迅雷补丁.e\LinkSimulate", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 6 系统核心支持库




.全局变量 XunLeipath, 文本型, , , 
.全局变量 PBXL, 逻辑型, , , 
.全局变量 TYLJ, 逻辑型, , , 
.全局变量 YN, 逻辑型, , , 

.窗口程序集 打补丁主窗口, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (XunLeipath, “C:\Program File\Thunder Network\Thunder”)
赋值 (PBXL, 假)
赋值 (TYLJ, 假)
赋值 (YN, 假)

.子程序 _屏蔽上传_被单击, 空白型, , 
 ' 判断迅雷是否存在
改变目录 (XunLeipath)
.如果 (文件是否存在 (“Thunder.exe”))
    XUNLEI目录 ()
.否则
    载入 (窗口1, , 真)
    改变目录 (XunLeipath)
    .如果 (文件是否存在 (“Thunder.exe”))
        XUNLEI目录 ()
    .否则
        赋值 (PBXL, 假)
    .如果结束
    
.如果结束
 ' 屏蔽结果
.如果真 (YN)
    .如果 (PBXL)
        信息框 (“屏蔽迅雷偷偷上传成功！”, 64, “恭喜你了！”)
    .否则
        信息框 (“屏蔽迅雷偷偷上传失败！”, 16, “非常抱歉！”)
    .如果结束
    
.如果真结束



.子程序 _通用链接_被单击, 空白型, , 
 ' 判断迅雷是否存在
改变目录 (XunLeipath)
.如果 (文件是否存在 (“Thunder.exe”))
    通用链接补丁 ()
.否则
    载入 (窗口1, , 真)
    改变目录 (XunLeipath)
    .如果 (文件是否存在 (“Thunder.exe”))
        通用链接补丁 ()
    .否则
        赋值 (TYLJ, 假)
    .如果结束
    
.如果结束
 ' 通用链接注册
.如果真 (YN)
    .如果 (TYLJ)
        信息框 (“通用链接注册成功！”, 64, “恭喜你了！”)
    .否则
        信息框 (“通用链接注册失败！”, 16, “非常抱歉！”)
    .如果结束
    
.如果真结束


.子程序 XUNLEI目录, 空白型, , 开始屏蔽迅雷偷偷上传
 ' XUNLEI目录
改变目录 (XunLeipath)
改变目录 (“Program”)
删除文件 (“cid_store.dat”)
创建目录 (“cid_store.dat”)
改变目录 (“cid_store.dat”)
创建目录 (“屏蔽上传..\”)
 ' Windows目录
改变目录 (读环境变量 (“windir”))
改变目录 (“system32”)
删除文件 (“cid_store.dat”)
创建目录 (“cid_store.dat”)
改变目录 (“cid_store.dat”)
创建目录 (“屏蔽上传..\”)
赋值 (PBXL, 真)

.子程序 通用链接补丁, 空白型, , 
改变目录 (XunLeipath)
.如果 (改变目录 (“ComDlls”))
    写到文件 (“LinkSimulate.dll”, #LinkSimulate)
    运行 (“regsvr32 /s LinkSimulate.dll”, 假, 1)
    赋值 (TYLJ, 真)
.否则
    赋值 (TYLJ, 假)
    信息框 (“目录ComDlls不存在！”, 16, “出错了！”)
.如果结束


.窗口程序集 迅雷目录选择, , , 

.子程序 _驱动器框1_驱动器被改变, 空白型, , 
改变驱动器 (.)
赋值 (., 取当前目录 ())

.子程序 _按钮1_被单击, 空白型, , 
改变目录 (.)
.如果 (文件是否存在 (“Thunder.exe”))
    赋值 (XunLeipath, .)
    销毁 ()
.否则
    信息框 (相加 (“这个目录里面好像没有Thunder.exe”, #换行符, “请你再次确认所选择的目录”, #换行符, “如果没有安装迅雷，请选择取消”), 16, “错误提示信息”)
    返回 ()
.如果结束
赋值 (YN, 真)

.子程序 _按钮2_被单击, 空白型, , 
赋值 (YN, 假)
销毁 ()



 ' 不属于任何一个程序集、类模块的函数：
