 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 592
    高度 = 448
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “企达软件 - 控件移动及调整大小 - 完全模仿易IED环境！”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库





.窗口程序集 窗口程序集1, , , 

.程序集变量 当前标签, 标签, , , 记录当前热点标签
.程序集变量 当前方块, 标签, , , 记录当前热点方块
.程序集变量 到位, 逻辑型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
 ' 企达软件原创作品，没有任何版权限制，您可以任意使用此源码。
 ' 作者主页：http://www.qidasoft.com

事件转移 () ' 将标签2的事件转移到标签1,方便统一处理
事件转移 ()

事件转移 () ' 将所有方法的事件全部转移支“左上”，方便统一处理
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()
事件转移 ()

.子程序 _标签1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (当前标签, 取事件组件 ()) ' 将事件标签存入变量，方便统一处理相关事件
当前标签.调整层次 () ' 移动最顶层
161.发送信息 (2, 0) ' 移动控件
赋值 (到位, 假) ' 要重新调整方块位置
显示移动块 ()

.子程序 _标签1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

显示移动块 () ' 移动方块至新位置显示移动块

.子程序 显示移动块, 空白型, , 
.局部变量 标签中心, 整数型, , , 
.局部变量 方块中心, 整数型, , , 使用此变量主要是方法更清楚的了解计算方法，在实际使用中可以不用变量

.如果真 (等于 (是否已创建 (当前标签), 假)) ' 没有事件组件，直接返回
    返回 ()
.如果真结束

.如果真 (到位) ' 已经调整过位置了，直接返回
    返回 ()
.如果真结束

相减 (., .).移动 (相减 (., .), , )
赋值 (., 真)
.调整层次 ()

.判断开始 (大于或等于 (., 10)) ' 高度小于10则不显示“左中”和“右中”方块
    赋值 (标签中心, 相除 (., 2))
    赋值 (方块中心, 相除 (., 2))
    相减 (., .).移动 (相加 (., 相减 (标签中心, 方块中心)), , )
    赋值 (., 真)
    .调整层次 ()
    
    相加 (., .).移动 (., , )
    赋值 (., 真)
    .调整层次 ()
.默认
    连续赋值 (假, ., .)
.判断结束

.移动 (., 相加 (., .), , )
赋值 (., 真)
.调整层次 ()

.判断开始 (大于或等于 (., 10)) ' 宽度小于10则不显示“中中”和“中下”方块
    赋值 (标签中心, 相除 (., 2))
    赋值 (方块中心, 相除 (., 2))
    相加 (., 相减 (标签中心, 方块中心)).移动 (相减 (., .), , )
    赋值 (., 真)
    .调整层次 ()
    
    .移动 (., 相加 (., .), , )
    赋值 (., 真)
    .调整层次 ()
.默认
    连续赋值 (假, ., .)
.判断结束

相加 (., .).移动 (相减 (., .), , )
赋值 (., 真)
.调整层次 ()

.移动 (., 相加 (., .), , )
赋值 (., 真)
.调整层次 ()

赋值 (到位, 真)

.子程序 __启动窗口_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

连续赋值 (假, ., ., ., ., ., ., ., .) ' 隐藏方块

.子程序 _左上_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 消息值, 整数型, , , 

赋值 (当前方块, 取事件组件 ())
.判断开始 (等于 ())
    赋值 (消息值, 13)
.判断 (等于 ())
    赋值 (消息值, 10)
.判断 (等于 (当前方块, ))
    赋值 (消息值, 16)
.判断 (等于 (当前方块, ))
    赋值 (消息值, 12)
.判断 (等于 (当前方块, ))
    赋值 (消息值, 15)
.判断 (等于 (当前方块, ))
    赋值 (消息值, 14)
.判断 (等于 (当前方块, ))
    赋值 (消息值, 11)
.判断 (等于 (当前方块, ))
    赋值 (消息值, 17)
.默认
    
.判断结束

当前标签.发送信息 (161, 消息值, 0) ' 调整控件大小
赋值 (到位, 假) ' 要重新调整方块位置
显示移动块 ()

.子程序 调整标签事件, 空白型, , 


.子程序 __启动窗口_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (是否已创建 (当前标签), 假))
    返回 ()
.如果真结束

.如果真 (等于 (., 假)) ' 说明当前未选中任何控件
    返回 ()
.如果真结束

.如果真 (等于 (键代码, #左光标键))
    .判断开始 (不等于 (位与 (功能键状态, #Shift键状态), 0)) ' 说明按下了Shift键，要调整大小
        当前标签.移动 (相减 (当前标签., 1), )
    .默认
        当前标签.移动 (相减 (当前标签., 1), , , )
    .判断结束
    
    赋值 (到位, 假) ' 要更新方法位置
    显示移动块 ()
.如果真结束

.如果真 (等于 (键代码, #右光标键))
    .判断开始 (不等于 (位与 (#Shift键状态), 0)) ' 说明按下了Shift键，要调整大小
        当前标签.移动 (相加 (当前标签., 1), )
    .默认
        当前标签.移动 (相加 (当前标签., 1), , , )
    .判断结束
    
    赋值 (假) ' 要更新方法位置
    未知函数_67174570 ()
.如果真结束

.如果真 (等于 (键代码, #上光标键))
    .判断开始 (不等于 (位与 (#Shift键状态), 0)) ' 说明按下了Shift键，要调整大小
        当前标签.移动 (相减 (当前标签., 1))
    .默认
        当前标签.移动 (相减 (当前标签., 1), , )
    .判断结束
    
    赋值 (假) ' 要更新方法位置
    未知函数_67174572 ()
.如果真结束

.如果真 (等于 (键代码, #下光标键))
    .判断开始 (不等于 (位与 (#Shift键状态), 0)) ' 说明按下了Shift键，要调整大小
        当前标签.移动 (相加 (当前标签., 1))
    .默认
        当前标签.移动 (相加 (当前标签., 1), , )
    .判断结束
    赋值 (假) ' 要更新方法位置
    显示移动块 ()
.如果真结束



 ' 不属于任何一个程序集、类模块的函数：
