 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 药品库存 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 500
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\abc.e\药品库存_图标.ico
    背景音乐 =  ' 空
    标题 = “药品库存”
    帮助文件名 = “”

窗口 住院基本信息
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 500
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\abc.e\住院基本信息_图标.ico
    背景音乐 =  ' 空
    标题 = “住院信息管理模块”
    帮助文件名 = “”

窗口 门诊用药
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 500
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\abc.e\门诊用药_图标.ico
    背景音乐 =  ' 空
    标题 = “门诊用药模块”
    帮助文件名 = “”

窗口 _启动窗口
    左边 = 50
    顶边 = 50
    宽度 = 290
    高度 = 203
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\abc.e\_启动窗口_底图
    图标 =  ' 已保存到：D:\易语言学习\Data\abc.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “选择系统”
    帮助文件名 = “”

窗口 密码
    左边 = 50
    顶边 = 50
    宽度 = 220
    高度 = 141
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 药品支出模块
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 500
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\abc.e\药品支出模块_图标.ico
    背景音乐 =  ' 空
    标题 = “住院用药模块”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 324
    高度 = 174
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\abc.e\窗口1_图标.ico
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 关于
    左边 = 50
    顶边 = 50
    宽度 = 350
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 0
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\abc.e\关于_底图
    图标 =  ' 已保存到：D:\易语言学习\Data\abc.e\关于_图标.ico
    背景音乐 =  ' 空
    标题 = “关于作者”
    帮助文件名 = “”

窗口 报表软件
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 500
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\abc.e\报表软件_图标.ico
    背景音乐 =  ' 空
    标题 = “门诊用药窗口”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 3 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 1 扩展界面支持库一




.全局变量 user, 文本型, , , 
.全局变量 a, 日期时间型, , , 
.全局变量 b, 文本型, , , 
.全局变量 c, 文本型, , , 
.全局变量 d, 文本型, , , 
.全局变量 e, 文本型, , , 
.全局变量 f, 小数型, , , 
.全局变量 g, 整数型, , , 
.全局变量 sh, 整数型, , , 
.全局变量 ps, 小数型, , , 
.全局变量 pj, 小数型, , , 
.全局变量 pss, 小数型, , , 
.全局变量 pzc, 小数型, , , 
.全局变量 psy, 小数型, , , 
.全局变量 pzl, 小数型, , , 
.全局变量 phy, 小数型, , , 
.全局变量 pqt, 小数型, , , 
.全局变量 pzy, 小数型, , , 
.全局变量 pfs, 小数型, , , 
.全局变量 psx, 小数型, , , 
.全局变量 pzhy, 小数型, , , 
.全局变量 pln, 小数型, , , 
.全局变量 pjs, 小数型, , , 
.全局变量 pye, 小数型, , , 
.全局变量 pyl, 小数型, , , 
.全局变量 pjh, 小数型, , , 
.全局变量 pcf, 文本型, , , 
.全局变量 phj, 小数型, , , 
.全局变量 pps, 小数型, , , 
.全局变量 ppj, 小数型, , , 
.全局变量 ppss, 小数型, , , 
.全局变量 ppzc, 小数型, , , 
.全局变量 ppsy, 小数型, , , 
.全局变量 ppzl, 小数型, , , 
.全局变量 pphy, 小数型, , , 
.全局变量 ppqt, 小数型, , , 
.全局变量 ppzy, 小数型, , , 
.全局变量 ppfs, 小数型, , , 
.全局变量 ppsx, 小数型, , , 
.全局变量 ppln, 小数型, , , 
.全局变量 ppjs, 小数型, , , 
.全局变量 ppye, 小数型, , , 
.全局变量 ppyl, 小数型, , , 
.全局变量 ppjh, 小数型, , , 
.全局变量 pphj, 小数型, , , 
.全局变量 ppzhy, 小数型, , , 
.全局变量 n1, 小数型, , , 
.全局变量 n2, 小数型, , , 
.全局变量 n3, 小数型, , , 
.全局变量 n4, 小数型, , , 
.全局变量 n5, 小数型, , , 
.全局变量 n6, 小数型, , , 
.全局变量 n7, 小数型, , , 
.全局变量 n8, 小数型, , , 
.全局变量 g1, 小数型, , , 
.全局变量 g2, 小数型, , , 
.全局变量 g3, 小数型, , , 
.全局变量 g4, 小数型, , , 
.全局变量 g5, 小数型, , , 
.全局变量 g6, 小数型, , , 
.全局变量 g7, 小数型, , , 
.全局变量 g8, 小数型, , , 
.全局变量 g9, 小数型, , , 
.全局变量 g10, 小数型, , , 
.全局变量 g11, 小数型, , , 
.全局变量 g12, 小数型, , , 
.全局变量 g13, 小数型, , , 
.全局变量 g14, 小数型, , , 
.全局变量 g15, 小数型, , , 
.全局变量 g16, 小数型, , , 
.全局变量 r1, 小数型, , , 
.全局变量 r2, 小数型, , , 
.全局变量 r3, 小数型, , , 
.全局变量 r4, 小数型, , , 
.全局变量 r5, 整数型, , , 
.全局变量 r6, 整数型, , , 
.全局变量 r7, 小数型, , , 
.全局变量 r8, 小数型, , , 
.全局变量 w1, 小数型, , , 
.全局变量 w2, 小数型, , , 
.全局变量 w3, 小数型, , , 
.全局变量 w4, 小数型, , , 
.全局变量 w5, 小数型, , , 
.全局变量 w6, 小数型, , , 
.全局变量 w7, 小数型, , , 
.全局变量 w8, 整数型, , , 

.窗口程序集 窗口程序集1, , , 

.子程序 _药品库存_创建完毕, 空白型, , 
.局部变量 zd, 字段信息, , "16", 
.局部变量 次数, 空白型, , , 
.局部变量 记录数, 空白型, , , 

.如果 (等于 (文件是否存在 (“ypjbxx.edb”), 真))
    
.否则
    赋值 (zd [1].名称, “dm”)
    赋值 (zd [2].名称, “mch”)
    赋值 (zd [3].名称, “bm”)
    赋值 (zd [4].名称, “lb”)
    赋值 (zd [5].名称, “bx”)
    赋值 (zd [6].名称, “ph”)
    赋值 (zd [7].名称, “gg”)
    赋值 (zd [8].名称, “shch”)
    赋值 (zd [9].名称, “yx”)
    赋值 (zd [10].名称, “chd”)
    赋值 (zd [11].名称, “dw”)
    赋值 (zd [12].名称, “shl”)
    赋值 (zd [13].名称, “jj”)
    赋值 (zd [14].名称, “jh”)
    赋值 (zd [15].名称, “xj”)
    赋值 (zd [16].名称, “xh”)
    连续赋值 (#文本型, zd [1].类型, zd [2].类型, zd [3].类型, zd [4].类型, zd [5].类型, zd [6].类型, zd [7].类型, zd [10].类型, zd [11].类型)
    连续赋值 (#日期时间型, zd [8].类型, zd [9].类型)
    赋值 (zd [12].类型, #整数型)
    连续赋值 (#小数型, zd [13].类型, zd [14].类型, zd [15].类型, zd [16].类型)
    连续赋值 (15, zd [1].最大文本长度, zd [6].最大文本长度)
    赋值 (zd [2].最大文本长度, 30)
    连续赋值 (100, zd [3].最大文本长度, zd [10].最大文本长度)
    连续赋值 (6, zd [4].最大文本长度, zd [5].最大文本长度, zd [11].最大文本长度)
    赋值 (zd [7].最大文本长度, 10)
    创建 (“ypjbxx”, zd)
.如果结束
打开 (“ypjbxx”, , , , , , )
置当前库 (“ypjbxx”)
到首记录 ()
替换 (真, “jh”, 相乘 (读 (“shl”), 读 (“jj”)), “xh”, 相乘 (读 (“shl”), 读 (“xj”)))
全部删除 ()
到首记录 ()
.计次循环首 (取记录数 (), )
    0.插入表项 (到文本 (读 (1)), , , , )
    .计次循环首 (相减 (取字段数 (), 1), )
        0.置标题 (次数, 到文本 (读 (相加 (次数, 1))))
    .计次循环尾 ()
    跳过 (1)
.计次循环尾 ()
赋值 (.内容, 到文本 (取记录数 ()))
赋值 (.内容, 到文本 (求和 (读 (“jh”), )))
赋值 (.内容, 到文本 (求和 (读 (“xh”), )))


.子程序 _编辑框10_内容被改变, 空白型, , 
赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))

.子程序 _编辑框12_内容被改变, 空白型, , 
赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))

.子程序 _编辑框10_失去焦点, 空白型, , 
获取焦点 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 次数, 空白型, , , 
.局部变量 记录数, 空白型, , , 

打开 (“ypjbxx”, , , , , , )
置当前库 (“ypjbxx”)
到首记录 ()
.如果 (查找 (并且 (等于 (.内容, 读 (“dm”)), 等于 (.内容, 读 (“lb”)), 等于 (.内容, 读 (“bx”)), 等于 (.内容, 读 (“ph”)), 等于 (.内容, 读 (“gg”)), 等于 (到数值 (.内容), 读 (“xj”)))))
    修改 (.内容, .内容, .内容, .内容, .内容, .内容, .内容, 到时间 (.内容), 到时间 (.内容), .内容, .内容, 相加 (到数值 (.内容), 读 (“shl”)), 到数值 (.内容), 相加 (到数值 (.内容), 读 (“jh”)), 到数值 (.内容), 相加 (到数值 (.内容), 读 (“xh”)))
.否则
    加记录 (.内容, .内容, .内容, .内容, .内容, .内容, .内容, 到时间 (.内容), 到时间 (.内容), .内容, .内容, 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容))
    
.如果结束
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
全部删除 ()
到首记录 ()
.计次循环首 (取记录数 (), )
    0.插入表项 (读 (1), , , , )
    .计次循环首 (相减 (取字段数 (), 1), )
        0.置标题 (次数, 到文本 (读 (相加 (次数, 1))))
    .计次循环尾 ()
    跳过 (1)
.计次循环尾 ()
赋值 (.内容, 到文本 (取记录数 ()))
赋值 (.内容, 到文本 (求和 (读 (“jh”), )))
赋值 (.内容, 到文本 (求和 (读 (“xh”), )))
获取焦点 ()

.子程序 _按钮2_被单击, 空白型, , 
打开 (“ypjbxx”, , , , , , )
置当前库 (“ypjbxx”)
到首记录 ()
.如果 (等于 (查找 (等于 (.内容, 读 (“dm”))), 真))
    赋值 (.内容, 读 (“dm”))
    赋值 (.内容, 读 (“mch”))
    赋值 (.内容, 读 (“bm”))
    赋值 (.内容, 读 (“lb”))
    赋值 (.内容, 读 (“bx”))
    赋值 (.内容, 读 (“ph”))
    赋值 (.内容, 读 (“gg”))
    赋值 (.内容, 到文本 (读 (“shch”)))
    赋值 (.内容, 到文本 (读 (“yx”)))
    赋值 (.内容, 读 (“chd”))
    赋值 (.内容, 读 (“dw”))
    赋值 (.内容, 到文本 (读 (“shl”)))
    赋值 (.内容, 到文本 (读 (“jj”)))
    赋值 (.内容, 到文本 (读 (“jh”)))
    赋值 (.内容, 到文本 (读 (“xj”)))
    赋值 (.内容, 到文本 (读 (“xh”)))
    
.否则
    信息框 (“无该药品”, 0, )
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
.如果结束


.子程序 _按钮3_被单击, 空白型, , 
.局部变量 次数, 空白型, , , 
.局部变量 记录数, 空白型, , , 

.如果 (等于 (信息框 (“你确定要删除此项吗？”, 1, ), 0))
    删除 ()
    彻底删除 ()
    打开 (“ypjbxx”, , , , , , )
    置当前库 (“ypjbxx”)
    全部删除 ()
    到首记录 ()
    .计次循环首 (取记录数 (), )
        0.插入表项 (读 (1), , , , )
        .计次循环首 (相减 (取字段数 (), 1), )
            0.置标题 (到文本 (读 (相加 (1))))
        .计次循环尾 ()
        跳过 (1)
    .计次循环尾 ()
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    
    
.否则
    
.如果结束
赋值 (.内容, 到文本 (取记录数 ()))
赋值 (.内容, 到文本 (求和 (读 (“jh”), )))
赋值 (.内容, 到文本 (求和 (读 (“xh”), )))
获取焦点 ()


.子程序 _按钮4_被单击, 空白型, , 
.局部变量 次数, 空白型, , , 
.局部变量 记录数, 空白型, , , 

.如果 (修改 (.内容, .内容, .内容, .内容, .内容, .内容, .内容, 到时间 (.内容), 到时间 (.内容), .内容, .内容, 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容)))
    全部删除 ()
    到首记录 ()
    .计次循环首 (取记录数 (), )
        0.插入表项 (读 (1), , , , )
        .计次循环首 (相减 (取字段数 (), 1), )
            0.置标题 (到文本 (读 (相加 (1))))
        .计次循环尾 ()
        跳过 (1)
    .计次循环尾 ()
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, 到文本 (取记录数 ()))
    赋值 (.内容, 到文本 (求和 (读 (“jh”), )))
    赋值 (.内容, 到文本 (求和 (读 (“xh”), )))
    获取焦点 ()
    
.否则
    信息框 (“修改失败!”, 0, )
.如果结束


.子程序 _超级列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

打开 (“zhypjbxx”, , , , , , )
置当前库 (“zhypjbxx”)
跳到 (相减 (取记录数 (), .))
赋值 (.内容, 读 (“dm”))
赋值 (.内容, 读 (“mch”))
赋值 (.内容, 读 (“bm”))
赋值 (.内容, 读 (“lb”))
赋值 (.内容, 读 (“bx”))
赋值 (.内容, 读 (“ph”))
赋值 (.内容, 读 (“gg”))
赋值 (.内容, 到文本 (读 (“shch”)))
赋值 (.内容, 到文本 (读 (“yx”)))
赋值 (.内容, 读 (“chd”))
赋值 (.内容, 读 (“dw”))
赋值 (.内容, 到文本 (读 (“shl”)))
赋值 (.内容, 到文本 (读 (“jj”)))
赋值 (.内容, 到文本 (读 (“jh”)))
赋值 (.内容, 到文本 (读 (“xj”)))
赋值 (.内容, 到文本 (读 (“xh”)))


.子程序 _按钮5_被单击, 空白型, , 
销毁 ()

.子程序 _住院信息_被选择, 空白型, , 
载入 (住院基本信息, , 假)

.子程序 _住院票据_被选择, 空白型, , 
载入 (药品支出模块, , 假)

.子程序 _门诊用药_被选择, 空白型, , 
载入 (门诊用药, , 假)

.子程序 _报表管理_被选择, 空白型, , 
载入 (假)

.子程序 _退出系统_被选择, 空白型, , 
结束 ()

.子程序 _关于作者_被选择, 空白型, , 
载入 (关于, , 真)

.子程序 _编辑框9_内容被改变, 空白型, , 
赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))


.窗口程序集 窗口程序集2, , , 

.子程序 _住院基本信息_创建完毕, 空白型, , 
.局部变量 zd, 字段信息, , "11", 
.局部变量 次数, 空白型, , , 
.局部变量 记录数, 空白型, , , 

.如果 (等于 (文件是否存在 (“zyjbxx.edb”), 真))
    
.否则
    赋值 (zd [1].名称, “xm”)
    赋值 (zd [2].名称, “xb”)
    赋值 (zd [3].名称, “nl”)
    赋值 (zd [4].名称, “zh”)
    赋值 (zd [5].名称, “sj”)
    赋值 (zd [6].名称, “bz”)
    赋值 (zd [7].名称, “zyh”)
    赋值 (zd [8].名称, “ks”)
    赋值 (zd [9].名称, “cwh”)
    赋值 (zd [10].名称, “ys”)
    赋值 (zd [11].名称, “yfk”)
    连续赋值 (#文本型, zd [1].类型, zd [2].类型, zd [4].类型, zd [10].类型, zd [6].类型, zd [7].类型, zd [8].类型, zd [9].类型)
    连续赋值 (#整数型, zd [3].类型, zd [11].类型)
    赋值 (zd [5].类型, #日期时间型)
    连续赋值 (10, zd [4].最大文本长度, zd [8].最大文本长度, zd [7].最大文本长度)
    连续赋值 (6, zd [1].最大文本长度, zd [10].最大文本长度)
    赋值 (zd [2].最大文本长度, 2)
    赋值 (zd [6].最大文本长度, 100)
    赋值 (zd [9].最大文本长度, 5)
    创建 (“zyjbxx”, zd)
.如果结束

打开 (“zyjbxx”, , , , , , )
置当前库 (“zyjbxx”)
全部删除 ()
到首记录 ()
.计次循环首 (取记录数 (), )
    0.插入表项 (读 (1), , , , )
    .计次循环首 (相减 (取字段数 (), 1), )
        0.置标题 (次数, 到文本 (读 (相加 (次数, 1))))
    .计次循环尾 ()
    跳过 (1)
.计次循环尾 ()
赋值 (.内容, 到文本 (取记录数 ()))
赋值 (.内容, 到文本 (求和 (读 (“yfk”), )))



.子程序 _按钮1_被单击, 空白型, , 
.局部变量 次数, 空白型, , , 
.局部变量 记录数, 空白型, , , 

打开 (“zyjbxx”, , , , , , )
置当前库 (“zyjbxx”)
到首记录 ()
.如果 (查找 (等于 (等于 (.内容, 读 (“zyh”)), 真)))
    信息框 (“该住院号已经存在，请直接进入药品支出模块。”, 0, )
.否则
    加记录 (.内容, .内容, 到数值 (.内容), .内容, 到时间 (.内容), .内容, .内容, .内容, .内容, .内容, 到数值 (.内容))
.如果结束
全部删除 ()
到首记录 ()
.计次循环首 (取记录数 (), )
    0.插入表项 (读 (1), , , , )
    .计次循环首 (相减 (取字段数 (), 1), )
        0.置标题 (次数, 到文本 (读 (相加 (次数, 1))))
    .计次循环尾 ()
    跳过 (1)
.计次循环尾 ()
赋值 (.内容, 到文本 (取记录数 ()))
赋值 (.内容, 到文本 (求和 (读 (“yfk”), )))
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 次数, 空白型, , , 
.局部变量 记录数, 空白型, , , 

打开 (“zyjbxx”, , , , , , )
置当前库 (“zyjbxx”)
到首记录 ()
.如果 (查找 (等于 (.内容, 读 (“zyh”))))
    赋值 (.内容, 读 (“xm”))
    赋值 (.内容, 读 (“xb”))
    赋值 (.内容, 到文本 (读 (“nl”)))
    赋值 (.内容, 到文本 (读 (“sj”)))
    赋值 (.内容, 读 (“bz”))
    赋值 (.内容, 读 (“zyh”))
    赋值 (.内容, 读 (“ks”))
    赋值 (.内容, 读 (“cwh”))
    赋值 (.内容, 读 (“ys”))
    赋值 (.内容, 到文本 (读 (“yfk”)))
    赋值 (.内容, 读 (“zh”))
.否则
    信息框 (“该记录不存在。”, 0, )
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
.如果结束


.子程序 _按钮3_被单击, 空白型, , 
.局部变量 次数, 空白型, , , 
.局部变量 记录数, 空白型, , , 

修改 (.内容, .内容, 到数值 (.内容), .内容, 到时间 (.内容), .内容, .内容, .内容, .内容, .内容, 到数值 (.内容))
全部删除 ()
到首记录 ()
.计次循环首 (取记录数 (), )
    0.插入表项 (读 (1), , , , )
    .计次循环首 (相减 (取字段数 (), 1), )
        0.置标题 (次数, 到文本 (读 (相加 (次数, 1))))
    .计次循环尾 ()
    跳过 (1)
.计次循环尾 ()
赋值 (.内容, 到文本 (取记录数 ()))
赋值 (.内容, 到文本 (求和 (读 (“yfk”), )))
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)


.子程序 _按钮4_被单击, 空白型, , 
.局部变量 次数, 空白型, , , 
.局部变量 记录数, 空白型, , , 

.如果 (等于 (信息框 (“你确定要删除此条记录吗？”, 1, ), 0))
    删除 ()
    彻底删除 ()
    全部删除 ()
    到首记录 ()
    .计次循环首 (取记录数 (), )
        0.插入表项 (读 (1), , , , )
        .计次循环首 (相减 (取字段数 (), 1), )
            0.置标题 (次数, 到文本 (读 (相加 (次数, 1))))
        .计次循环尾 ()
        跳过 (1)
    .计次循环尾 ()
    赋值 (.内容, 到文本 (取记录数 ()))
    赋值 (.内容, 到文本 (求和 (读 (“yfk”), )))
    
.否则
    
.如果结束


.子程序 _超级列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

跳到 (相减 (取记录数 (), .))
赋值 (.内容, 读 (“xm”))
赋值 (.内容, 读 (“xb”))
赋值 (.内容, 到文本 (读 (“nl”)))
赋值 (.内容, 到文本 (读 (“sj”)))
赋值 (.内容, 读 (“bz”))
赋值 (.内容, 读 (“zyh”))
赋值 (.内容, 读 (“ks”))
赋值 (.内容, 读 (“cwh”))
赋值 (.内容, 读 (“ys”))
赋值 (.内容, 到文本 (读 (“yfk”)))
赋值 (.内容, 读 (“zh”))


.子程序 _时钟1_周期事件, 空白型, , 
赋值 (.标题, 到文本 (取现行时间 ()))


.子程序 _编辑框2_失去焦点, 空白型, , 
获取焦点 ()

.子程序 _编辑框12_失去焦点, 空白型, , 
获取焦点 ()

.子程序 _门诊用药_被选择, 空白型, , 
载入 (门诊用药, , 假)

.子程序 _药品库存_被选择, 空白型, , 
载入 (药品库存, , 假)

.子程序 _住院票据_被选择, 空白型, , 
载入 (药品支出模块, , 假)

.子程序 _报表管理_被选择, 空白型, , 
载入 (假)

.子程序 _退出系统_被选择, 空白型, , 
结束 ()

.子程序 _关于作者_被选择, 空白型, , 
载入 (关于, , 真)

.子程序 _按钮6_被单击, 空白型, , 
载入 (窗口1, , 真)

.窗口程序集 窗口程序集3, , , 

.子程序 _门诊用药_创建完毕, 空白型, , 
.局部变量 zd, 字段信息, , "10", 
.局部变量 次数, 空白型, , , 
.局部变量 记录数, 空白型, , , 

.如果 (文件是否存在 (相加 (“m”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ())), “.edb”)))
    
.否则
    赋值 ( [1].名称, “shj”)
    赋值 (zd [2].名称, “mch”)
    赋值 ( [3].名称, “lb”)
    赋值 ( [4].名称, “bx”)
    赋值 ( [5].名称, “shl”)
    赋值 (zd [6].名称, “dw”)
    赋值 (zd [7].名称, “dj”)
    赋值 (zd [8].名称, “hj”)
    赋值 (zd [9].名称, “cf”)
    赋值 (zd [10].名称, “shf”)
    连续赋值 (#文本型, zd [2].类型, zd [3].类型, zd [4].类型, zd [6].类型, zd [9].类型, zd [10].类型)
    赋值 ( [1].类型, #日期时间型)
    赋值 ( [5].类型, #整数型)
    连续赋值 (#小数型, zd [7].类型, zd [8].类型)
    连续赋值 (6, zd [3].最大文本长度, zd [4].最大文本长度, zd [6].最大文本长度)
    赋值 (zd [2].最大文本长度, 30)
    连续赋值 (10, zd [9].最大文本长度, zd [10].最大文本长度)
    创建 (相加 (“m”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ()))), zd)
    
.如果结束
打开 (相加 (“m”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ()))), , , , , , )
置当前库 (相加 (“m”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ()))))
到首记录 ()
全部删除 ()
.计次循环首 (取记录数 (), )
    0.插入表项 (到文本 (读 (1)), , , , )
    .计次循环首 (相减 (取字段数 (), 1), )
        0.置标题 (次数, 到文本 (读 (相加 (次数, 1))))
    .计次循环尾 ()
    跳过 (1)
.计次循环尾 ()
赋值 (.内容, 到文本 (求和 (读 (“hj”), )))
赋值 (.内容, 到文本 (求和 (读 (“hj”), 等于 (读 (“cf”), .内容))))


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 次数, 空白型, , , 
.局部变量 记录数, 空白型, , , 

打开 (“lshk”, , , , , , )
置当前库 (“lshk”)
清空 ()
关闭 ()
打开 (“ypjbxx”, , , , , , )
置当前库 (“ypjbxx”)
到首记录 ()
复制记录 (“lshk”, 等于 (.内容, 读 (“dm”)), )
打开 (“lshk”, , , , , , )
置当前库 (“lshk”)
到首记录 ()
全部删除 ()
.计次循环首 (取记录数 (), )
    0.插入表项 (到文本 (读 (1)), , , , )
    .计次循环首 (相减 (取字段数 (), 1), )
        0.置标题 (次数, 到文本 (读 (相加 (次数, 1))))
    .计次循环尾 ()
    跳过 (1)
.计次循环尾 ()


.子程序 _超级列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 次数, 空白型, , , 
.局部变量 记录数, 空白型, , , 

打开 (“lshk”, , , , , , )
置当前库 (“lshk”)
跳到 (相减 (取记录数 (), .))
赋值 (取日期 (取现行时间 ()))
赋值 (读 (“mch”))
赋值 (读 (“lb”))
赋值 (读 (“bx”))
赋值 (e, 读 (“dw”))
赋值 (f, 读 (“xj”))
赋值 (g, 到数值 (.内容))
清空 ()
关闭 ()
打开 (相加 (“m”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ()))), , , , , , )
置当前库 (相加 (“m”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ()))))
加记录 (a, b, c, d, g, e, f, 相乘 (g, f), .内容, user)
到首记录 ()
全部删除 ()
.计次循环首 (取记录数 (), )
    0.插入表项 (到文本 (读 (1)), , , , )
    .计次循环首 (相减 (取字段数 (), 1), )
        0.置标题 (次数, 到文本 (读 (相加 (次数, 1))))
    .计次循环尾 ()
    跳过 (1)
.计次循环尾 ()
赋值 (.内容, 到文本 (求和 (读 (“hj”), )))
赋值 (.内容, 到文本 (求和 (读 (“hj”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “西药”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “检查”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “手术”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “中成”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “输氧”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “治疗”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “化验”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “其它”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “中草”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “放射”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “输血”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “住院”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “冷暖”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “接生”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “婴儿”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “医疗”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “监护”), 等于 (读 (“cf”), .内容))))
赋值 (pcf, .内容)
打开 (“ypjbxx”, , , , , , )
置当前库 (“ypjbxx”)
到首记录 ()
.如果 (查找 (并且 (等于 (b, 读 (“mch”)), 等于 (c, 读 (“lb”)), 等于 (f, 读 (“xj”)))))
     ' 替换 (“shl”, 相减 (读 (“shl”), g))
    
.否则
    
.如果结束
赋值 (.内容, “”)
获取焦点 ()
全部删除 ()

.子程序 _按钮4_被单击, 空白型, , 
.局部变量 记录数, 空白型, , , 
.局部变量 次数, 空白型, , , 

打开 (相加 (“m”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ()))), , , , , , )
置当前库 (相加 (“y”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ()))))
跳到 (相减 (取记录数 (), .))
赋值 (sh, 读 (“shl”))
赋值 (f, 读 (“dj”))
赋值 (b, 读 (“mch”))
赋值 (c, 读 (“lb”))
.如果 (等于 (信息框 (“你确定要删除吗？”, 1, ), 0))
    删除 ()
    彻底删除 ()
    
.否则
    
.如果结束
到首记录 ()
全部删除 ()
.计次循环首 (取记录数 (), )
    0.插入表项 (到文本 (读 (1)), , , , )
    .计次循环首 (相减 (取字段数 (), 1), )
        0.置标题 (到文本 (读 (相加 (1))))
    .计次循环尾 ()
    跳过 (1)
.计次循环尾 ()
赋值 (.内容, 到文本 (求和 (读 (“hj”), )))
赋值 (.内容, 到文本 (求和 (读 (“hj”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “西药”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “检查”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “手术”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “中成”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “输氧”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “治疗”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “化验”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “其它”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “中草”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “放射”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “输血”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “住院”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “冷暖”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “接生”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “婴儿”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “医疗”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “监护”), 等于 (读 (“cf”), .内容))))
赋值 (pcf, .内容)
打开 (“ypjbxx”, , , , , , )
置当前库 (“ypjbxx”)
到首记录 ()
.如果 (查找 (并且 (等于 (b, 读 (“mch”)), 等于 (c, 读 (“lb”)), 等于 (f, 读 (“xj”)))))
    替换 (“shl”, 相加 (读 (“shl”), sh))
    
.否则
    
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 zd, 字段信息, , "20", 

打开 (相加 (“m”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ()))), , , , , , )
置当前库 (相加 (“m”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ()))))
到首记录 ()
.如果 (等于 (.内容, “”))
    信息框 (“请输入处方号”, 0, )
.否则
    .如果 (查找 (等于 (.内容, 读 (“cf”))))
        .开始打印 ()
        赋值 (.字体.字体大小, 11)
        470.定位写出 (400, “赞皇康复中心”)
        860.定位写出 (400, .内容)
        1120.定位写出 (400, .内容)
        530.定位写出 (460, )
        950.定位写出 (460, )
        1380.定位写出 (460, )
        530.定位写出 (520, )
        950.定位写出 (520, )
        1380.定位写出 (520, )
        530.定位写出 (600, )
        950.定位写出 (600, )
        1380.定位写出 (600, )
        530.定位写出 (670, )
        950.定位写出 (670, )
        1380.定位写出 (670, .内容)
        650.定位写出 (750, 相加 (“※”, 数值到金额 (到数值 (.内容), 假)))
        400.定位写出 (810, 到文本 (取日期 (取现行时间 ())))
        结束打印 ()
        
        .如果 (文件是否存在 (相加 (“bm”, 到文本 (取年份 (取现行时间 ())), “.edb”)))
            
        .否则
            赋值 (zd [1].名称, “shj”)
            赋值 (zd [2].名称, “chf”)
            赋值 (zd [3].名称, “ps”)
            赋值 (zd [4].名称, “pj”)
            赋值 (zd [5].名称, “pss”)
            赋值 (zd [6].名称, “pzc”)
            赋值 (zd [7].名称, “psy”)
            赋值 (zd [8].名称, “pzl”)
            赋值 (zd [9].名称, “phy”)
            赋值 (zd [10].名称, “pqt”)
            赋值 (zd [11].名称, “pzy”)
            赋值 (zd [12].名称, “pfs”)
            赋值 (zd [13].名称, “psx”)
            赋值 (zd [14].名称, “pzhy”)
            赋值 (zd [15].名称, “pln”)
            赋值 (zd [16].名称, “pjs”)
            赋值 (zd [17].名称, “pye”)
            赋值 (zd [18].名称, “pyl”)
            赋值 (zd [19].名称, “pjh”)
            赋值 (zd [20].名称, “phj”)
            赋值 (zd [1].类型, #日期时间型)
            赋值 (zd [2].类型, #文本型)
            连续赋值 (#小数型, zd [3].类型, zd [4].类型, zd [5].类型, zd [6].类型, zd [7].类型, zd [8].类型, zd [9].类型, zd [10].类型, zd [11].类型, zd [12].类型, zd [13].类型, zd [14].类型, zd [15].类型, zd [16].类型, zd [17].类型, zd [18].类型, zd [19].类型, zd [20].类型)
            赋值 (zd [2].最大文本长度, 10)
            创建 (相加 (“bm”, 到文本 (取年份 (取现行时间 ()))), zd)
        .如果结束
        打开 (相加 (“bm”, 到文本 (取年份 (取现行时间 ()))), , , , , , )
        置当前库 (相加 (“bm”, 到文本 (取年份 (取现行时间 ()))))
        到首记录 ()
        .如果 (查找 (等于 (pcf, 读 (“chf”))))
            修改 (取日期 (取现行时间 ()), pcf, ps, pj, pss, pzc, psy, pzl, phy, pqt, pzy, pfs, psx, pzhy, pln, pjs, pye, pyl, pjh, 相加 (ps, pj, pss, pzc, psy, pzl, phy, pqt, pzy, pfs, psx, pzhy, pln, pjs, pye, pyl, pjh))
        .否则
            加记录 (取日期 (取现行时间 ()), pcf, ps, pj, pss, pzc, psy, pzl, phy, pqt, pzy, pfs, psx, pzhy, pln, pjs, pye, pyl, pjh, 相加 (ps, pj, pss, pzc, psy, pzl, phy, pqt, pzy, pfs, psx, pzhy, pln, pjs, pye, pyl, pjh))
            
        .如果结束
        
        
        
    .否则
        信息框 (“无该处方”, 0, )
    .如果结束
    
    
.如果结束


.子程序 _编辑框4_内容被改变, 空白型, , 
打开 (相加 (“m”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ()))), , , , , , )
置当前库 (相加 (“m”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ()))))
到首记录 ()
赋值 (.内容, 到文本 (求和 (读 (“hj”), )))
赋值 (.内容, 到文本 (求和 (读 (“hj”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “西药”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “检查”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “手术”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “中成”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “输氧”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “治疗”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “化验”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “其它”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “中草”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “放射”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “输血”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “住院”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “冷暖”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “接生”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “婴儿”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “医疗”), 等于 (读 (“cf”), .内容))))
赋值 (求和 (读 (“hj”), 并且 (等于 (读 (“lb”), “监护”), 等于 (读 (“cf”), .内容))))
赋值 (pcf, .内容)

.子程序 _药品库存_被选择, 空白型, , 
载入 (药品库存, , 假)

.子程序 _住院管理_被选择, 空白型, , 
载入 (住院基本信息, , 假)

.子程序 _住院票据_被选择, 空白型, , 
载入 (药品支出模块, , 假)

.子程序 _报表管理_被选择, 空白型, , 
载入 (假)

.子程序 _退出系统_被选择, 空白型, , 
结束 ()

.子程序 _关于作者_被选择, 空白型, , 
载入 (关于, , 真)

.子程序 _编辑框1_失去焦点, 空白型, , 
获取焦点 ()

.子程序 _编辑框5_失去焦点, 空白型, , 
获取焦点 ()

.窗口程序集 窗口程序集4, , , 

.子程序 _密码_创建完毕, 空白型, , 
.局部变量 a, 空白型, , , 
.局部变量 b, 空白型, , , 
.局部变量 zd, 字段信息, , "2", 

.如果 (文件是否存在 (“user.edb”))
    
.否则
    赋值 (zd [1].名称, “use”)
    赋值 (zd [2].名称, “ma”)
    连续赋值 (#文本型, zd [1].类型, zd [2].类型)
    连续赋值 (10, zd [1].最大文本长度, zd [2].最大文本长度)
    创建 (“user”, zd)
.如果结束
打开 (“user”, , , , , , )
置当前库 (“user”)
赋值 (b, 0)
.计次循环首 (取记录数 (), a)
    赋值 (b, 相加 (b, 1))
    跳到 (b)
    读 (“use”).加入项目 ()
.计次循环尾 ()



.子程序 _按钮1_被单击, 空白型, , 
.如果 (等于 (.内容, “987654321”))
    打开 (“user”, , , , , , )
    置当前库 (“user”)
    编辑 ()
.否则
    信息框 (“请输入管理员密码！”, 0, )
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
打开 (“user”, , , , , , )
置当前库 (“user”)
到首记录 ()
.如果 (等于 (取记录数 (), 0))
    
.否则
    查找 (等于 (.内容, 读 (“use”)))
    .如果 (等于 (.内容, 读 (“ma”)))
        赋值 (user, .内容)
        销毁 ()
    .否则
        信息框 (“密码错误!”, 0, )
        赋值 (.内容, “”)
    .如果结束
    
.如果结束


.子程序 _按钮3_被单击, 空白型, , 
结束 ()

.窗口程序集 窗口程序集5, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
载入 (密码, , 真)

.子程序 _透明标签1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (药品库存, , 假)

.子程序 _透明标签2_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (假)

.子程序 _透明标签3_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (药品支出模块, , 假)

.子程序 _透明标签4_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (假)

.子程序 _透明标签6_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (假)

.子程序 _透明标签5_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.窗口程序集 窗口程序集6, , , 

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 zd, 字段信息, , "10", 
.局部变量 次数, 整数型, , , 
.局部变量 记录数, 整数型, , , 

打开 (“zyjbxx”, , , , , , )
置当前库 (“zyjbxx”)
到首记录 ()
.如果 (查找 (等于 (.内容, 读 (“zyh”))))
    赋值 (.标题, “姓名：”)
    赋值 (.标题, 读 (“xm”))
    赋值 (.标题, “性别：”)
    赋值 (.标题, 读 (“xb”))
    赋值 (.标题, “年龄：”)
    赋值 (.标题, 到文本 (读 (“nl”)))
    赋值 (.标题, “住院时间：”)
    赋值 (.标题, 到文本 (读 (“sj”)))
    赋值 (.标题, “病种：”)
    赋值 (.标题, 读 (“bz”))
    赋值 (.标题, “住院号：”)
    赋值 (.标题, 读 (“zyh”))
    赋值 (.标题, “治疗科室：”)
    赋值 (.标题, 读 (“ks”))
    赋值 (.标题, “床位号：”)
    赋值 (.标题, 读 (“cwh”))
    赋值 (.标题, “主治医师：”)
    赋值 (.标题, 读 (“ys”))
    赋值 (.标题, “预付款：”)
    赋值 (.标题, “剩余额：”)
    赋值 (.标题, 到文本 (读 (“yfk”)))
    .如果 (等于 (文件是否存在 (相加 (.内容, “.edb”)), 假))
        
        赋值 ( [1].名称, “shj”)
        赋值 ( [2].名称, “mch”)
        赋值 ( [3].名称, “lb”)
        赋值 ( [4].名称, “bx”)
        赋值 ( [5].名称, “shl”)
        赋值 ( [6].名称, “dw”)
        赋值 ( [7].名称, “dj”)
        赋值 ( [8].名称, “hj”)
        赋值 ( [9].名称, “cf”)
        赋值 ( [10].名称, “shf”)
        连续赋值 (#文本型,  [2].类型,  [3].类型,  [4].类型,  [6].类型,  [9].类型,  [10].类型)
        赋值 ( [1].类型, #日期时间型)
        赋值 ( [5].类型, #整数型)
        连续赋值 (#小数型,  [7].类型,  [8].类型)
        连续赋值 (6,  [3].最大文本长度,  [4].最大文本长度,  [6].最大文本长度)
        赋值 ( [2].最大文本长度, 30)
        连续赋值 (10,  [9].最大文本长度,  [10].最大文本长度)
        
        
        创建 (.内容, zd)
        
    .否则
        
    .如果结束
    打开 (.内容, , , , , , )
    置当前库 (.内容)
    到首记录 ()
    全部删除 ()
    .计次循环首 (取记录数 (), 记录数)
        0.插入表项 (到文本 (读 (1)), , , , )
        .计次循环首 (相减 (取字段数 (), 1), )
            0.置标题 (次数, 到文本 (读 (相加 (次数, 1))))
        .计次循环尾 ()
        跳过 (1)
    .计次循环尾 ()
    赋值 (.内容, 到文本 (求和 (读 (“hj”), )))
    赋值 (.标题, 到文本 (相减 (到数值 (.标题), 到数值 (.内容))))
    
    赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “西药”)))
    赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “检查”)))
    赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “手术”)))
    赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “中成”)))
    赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “输氧”)))
    赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “治疗”)))
    赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “化验”)))
    赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “其它”)))
    赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “中草”)))
    赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “放射”)))
    赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “输血”)))
    赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “住院”)))
    赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “冷暖”)))
    赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “接生”)))
    赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “婴儿”)))
    赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “医疗”)))
    赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “监护”)))
    赋值 (pcf, .内容)
    
    
    获取焦点 ()
    赋值 (.类型, 0)
    赋值 (.类型, 1)
    
.否则
    信息框 (“该记录不存在”, 0, )
.如果结束




.子程序 _按钮2_被单击, 空白型, , 
.局部变量 次数, 空白型, , , 
.局部变量 记录数, 空白型, , , 

打开 (“lshk”, , , , , , )
置当前库 (“lshk”)
清空 ()
关闭 ()

打开 (“ypjbxx”, , , , , , )
置当前库 (“ypjbxx”)
到首记录 ()
复制记录 (“lshk”, 等于 (.内容, 读 (“dm”)), )
打开 (“lshk”, , , , , , )
置当前库 (“lshk”)
到首记录 ()
全部删除 ()
.计次循环首 (取记录数 (), )
    0.插入表项 (到文本 (读 (1)), , , , )
    .计次循环首 (相减 (取字段数 (), 1), )
        0.置标题 (次数, 到文本 (读 (相加 (次数, 1))))
    .计次循环尾 ()
    跳过 (1)
.计次循环尾 ()


.子程序 _超级列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 次数, 空白型, , , 
.局部变量 记录数, 空白型, , , 

打开 (“lshk”, , , , , , )
置当前库 (“lshk”)
跳到 (相减 (取记录数 (), .))
赋值 (取日期 (取现行时间 ()))
赋值 (读 (“mch”))
赋值 (读 (“lb”))
赋值 (读 (“bx”))
赋值 (e, 读 (“dw”))
赋值 (f, 读 (“xj”))
赋值 (g, 到数值 (.内容))
清空 ()
关闭 ()
打开 (.内容, , , , , , )
置当前库 (.内容)
加记录 (a, b, c, d, g, e, f, 相乘 (g, f), .内容, user)


到首记录 ()
全部删除 ()
.计次循环首 (取记录数 (), )
    0.插入表项 (到文本 (读 (1)), , , , )
    .计次循环首 (相减 (取字段数 (), 1), )
        0.置标题 (次数, 到文本 (读 (相加 (次数, 1))))
    .计次循环尾 ()
    跳过 (1)
.计次循环尾 ()
赋值 (.内容, 到文本 (求和 (读 (“hj”), )))
赋值 (.标题, 到文本 (相减 (到数值 (.标题), 到数值 (.内容))))

赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “西药”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “检查”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “手术”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “中成”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “输氧”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “治疗”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “化验”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “其它”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “中草”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “放射”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “输血”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “住院”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “冷暖”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “接生”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “婴儿”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “医疗”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “监护”)))
赋值 (pcf, .内容)
打开 (“ypjbxx”, , , , , , )
置当前库 (“ypjbxx”)
到首记录 ()

.如果 (查找 (并且 (等于 (f, 读 (“xj”)), 等于 (b, 读 (“mch”)), 等于 (c, 读 (“lb”)))))
    替换 (“shl”, 相减 (读 (“shl”), g))
    
.否则
    
.如果结束



赋值 (.内容, “”)
获取焦点 ()
全部删除 ()

.子程序 _按钮3_被单击, 空白型, , 
.局部变量 次数, 空白型, , , 
.局部变量 记录数, 空白型, , , 

打开 (.内容, , , , , , )
置当前库 (.内容)
跳到 (相加 (., 1))
跳到 (相减 (取记录数 (), .))
赋值 (sh, 读 (“shl”))
赋值 (f, 读 (“dj”))
赋值 (b, 读 (“mch”))
赋值 (c, 读 (“lb”))
.如果 (等于 (信息框 (“你确定要删除吗？”, 1, ), 0))
    删除 ()
    彻底删除 ()
    
.否则
    
.如果结束
到首记录 ()
全部删除 ()
.计次循环首 (取记录数 (), )
    0.插入表项 (到文本 (读 (1)), , , , )
    .计次循环首 (相减 (取字段数 (), 1), )
        0.置标题 (次数, 到文本 (读 (相加 (次数, 1))))
    .计次循环尾 ()
    跳过 (1)
.计次循环尾 ()
赋值 (.内容, 到文本 (求和 (读 (“hj”), )))
赋值 (.标题, 到文本 (相减 (到数值 (.标题), 到数值 (.内容))))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “西药”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “检查”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “手术”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “中成”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “输氧”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “治疗”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “化验”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “其它”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “中草”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “放射”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “输血”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “住院”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “冷暖”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “接生”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “婴儿”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “医疗”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “监护”)))
赋值 (pcf, .内容)
打开 (“ypjbxx”, , , , , , )
置当前库 (“ypjbxx”)
到首记录 ()
.如果 (查找 (并且 (等于 (b, 读 (“mch”)), 等于 (c, 读 (“lb”)), 等于 (f, 读 (“xj”)))))
    替换 (“shl”, 相加 (读 (“shl”), sh))
    
.否则
    
.如果结束


.子程序 _按钮4_被单击, 空白型, , 
.局部变量 zd, 字段信息, , "20", 
.局部变量 cc, 字段信息, , "17", 

.开始打印 ()
赋值 (.字体.字体大小, 11)
450.定位写出 (130, “赞皇康复中心”)
350.定位写出 (210, .标题)
750.定位写出 (210, .标题)
1300.定位写出 (210, .标题)

420.定位写出 (290, .标题)
800.定位写出 (290, 取日期 (取现行时间 ()))
1300.定位写出 (290, 取时间间隔 (取日期 (取现行时间 ()), 到时间 (.标题), 5))

350.定位写出 (370, )
700.定位写出 (370, )
1100.定位写出 (370, )
1450.定位写出 (370, )

350.定位写出 (450, )
700.定位写出 (450, )
1100.定位写出 (450, )
1450.定位写出 (450, )

350.定位写出 (530, )
700.定位写出 (530, )
1100.定位写出 (530, )
1450.定位写出 (530, )

350.定位写出 (620, )
700.定位写出 (620, )
1100.定位写出 (620, )
1450.定位写出 (620, )

450.定位写出 (700, 相加 (“※”, 数值到金额 (到数值 (.内容), 假)))
1400.定位写出 (700, .内容)

550.定位写出 (780, .标题)
.如果 (小于 (到数值 (.标题), 0))
    950.定位写出 (780, 取绝对值 (到数值 (.标题)))
    1400.定位写出 (780, 0)
.否则
    950.定位写出 (780, 0)
    1400.定位写出 (780, .标题)
.如果结束

450.定位写出 (850, 取日期 (取现行时间 ()))
1400.定位写出 (850, user)


.如果 (文件是否存在 (相加 (“bz”, 到文本 (取年份 (取现行时间 ())), “.edb”)))
    
.否则
    赋值 ( [1].名称, “shj”)
    赋值 ( [2].名称, “chf”)
    赋值 ( [3].名称, “ps”)
    赋值 ( [4].名称, “pj”)
    赋值 ( [5].名称, “pss”)
    赋值 ( [6].名称, “pzc”)
    赋值 ( [7].名称, “psy”)
    赋值 ( [8].名称, “pzl”)
    赋值 ( [9].名称, “phy”)
    赋值 ( [10].名称, “pqt”)
    赋值 ( [11].名称, “pzy”)
    赋值 ( [12].名称, “pfs”)
    赋值 ( [13].名称, “psx”)
    赋值 ( [14].名称, “pzhy”)
    赋值 ( [15].名称, “pln”)
    赋值 ( [16].名称, “pjs”)
    赋值 ( [17].名称, “pye”)
    赋值 ( [18].名称, “pyl”)
    赋值 ( [19].名称, “pjh”)
    赋值 ( [20].名称, “phj”)
    赋值 ( [1].类型, #日期时间型)
    赋值 ( [2].类型, #文本型)
    连续赋值 (#小数型,  [3].类型,  [4].类型,  [5].类型,  [6].类型,  [7].类型,  [8].类型,  [9].类型,  [10].类型,  [11].类型,  [12].类型,  [13].类型,  [14].类型,  [15].类型,  [16].类型,  [17].类型,  [18].类型,  [19].类型,  [20].类型)
    赋值 ( [2].最大文本长度, 10)
    创建 (相加 (“bz”, 到文本 (取年份 (取现行时间 ()))), )
.如果结束
打开 (相加 (“bz”, 到文本 (取年份 (取现行时间 ()))), , , , , , )
置当前库 (相加 (“bz”, 到文本 (取年份 (取现行时间 ()))))
到首记录 ()
.如果 (查找 (等于 (pcf, 读 (“chf”))))
    修改 (取日期 (取现行时间 ()), pcf, ps, pj, pss, pzc, psy, pzl, phy, pqt, pzy, pfs, psx, pzhy, pln, pjs, pye, pyl, pjh, 相加 (ps, pj, pss, pzc, psy, pzl, phy, pqt, pzy, pfs, psx, pzhy, pln, pjs, pye, pyl, pjh))
.否则
    加记录 (取日期 (取现行时间 ()), pcf, ps, pj, pss, pzc, psy, pzl, phy, pqt, pzy, pfs, psx, pzhy, pln, pjs, pye, pyl, pjh, 相加 (ps, pj, pss, pzc, psy, pzl, phy, pqt, pzy, pfs, psx, pzhy, pln, pjs, pye, pyl, pjh))
    
.如果结束
打开 (.内容, , , , , , )
置当前库 (.内容)
到首记录 ()
赋值 (n1, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “01”)))
赋值 (n2, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “02”)))
赋值 (n3, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “03”)))
赋值 (n4, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “04”)))
赋值 (n5, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “05”)))
赋值 (n6, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “06”)))
赋值 (n7, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “07”)))
赋值 (n8, 相加 (n1, n2, n3, n4, n5, n6, n7))
赋值 (w1, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “11”)))
赋值 (w2, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “12”)))
赋值 (w3, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “13”)))
赋值 (w4, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “14”)))
赋值 (w5, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “15”)))
赋值 (w6, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “16”)))
赋值 (w7, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “17”)))
赋值 (w8, 相加 (w1, w2, w3, w4, w5, w6, w7))
.如果 (文件是否存在 (相加 (“n”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ())), “.edb”)))
    
.否则
    赋值 ( [1].名称, “c1”)
    赋值 ( [2].名称, “c2”)
    赋值 ( [3].名称, “c3”)
    赋值 ( [4].名称, “c4”)
    赋值 ( [5].名称, “c5”)
    赋值 ( [6].名称, “c6”)
    赋值 ( [7].名称, “c7”)
    赋值 ( [8].名称, “c8”)
    赋值 ( [9].名称, “c9”)
    赋值 ( [10].名称, “c10”)
    赋值 ( [11].名称, “c11”)
    赋值 ( [12].名称, “c12”)
    赋值 ( [13].名称, “c13”)
    赋值 ( [14].名称, “c14”)
    赋值 ( [15].名称, “c15”)
    赋值 ( [16].名称, “c16”)
    赋值 ( [17].名称, “zy”)
    连续赋值 (#小数型,  [1].类型,  [2].类型,  [3].类型,  [4].类型,  [5].类型,  [6].类型,  [7].类型,  [8].类型,  [9].类型,  [10].类型,  [11].类型,  [12].类型,  [13].类型,  [14].类型,  [15].类型,  [16].类型)
    赋值 ( [17].类型, #文本型)
    赋值 ( [17].最大文本长度, 10)
    创建 (相加 (“n”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ()))), )
    
.如果结束
打开 (相加 (“n”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ()))), , , , , , )
置当前库 (相加 (“n”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ()))))
到首记录 ()
.如果 (查找 (等于 (.内容, 读 (“zy”))))
    修改 (n1, n2, n3, n4, n5, n6, n7, n8, w1, w2, w3, w4, w5, w6, w7, w8, .内容)
.否则
    加记录 (n1, n2, n3, n4, n5, n6, n7, n8, w1, w2, w3, w4, w5, w6, w7, w8, .内容)
.如果结束





结束打印 ()


.子程序 _按钮5_被单击, 空白型, , 
.局部变量 x, 整数型, , , 
.局部变量 y, 整数型, , , 
.局部变量 好, 整数型, , , 

.开始打印 (2, )
赋值 (.字体.字体大小, 16)
800.定位写出 (300, “出院病人总费用明细单”)
赋值 (.字体.字体大小, 11)
200.定位写出 (420, 相加 (“住院号：”, .标题, “     科别： ”, .标题, “   床位号：”, .标题, “       姓名： ”, .标题))
200.画直线 (470, 2200, 470)
220.定位写出 (500, “使用时间”)
500.定位写出 (500, “药品名称”)
780.定位写出 (500, “类别”)
940.定位写出 (500, “报销”)
1100.定位写出 (500, “单位”)
1300.定位写出 (500, “数量”)
1400.定位写出 (500, “  单价  ”)
1550.定位写出 (500, “  合计  ”)
1700.定位写出 (500, “  处方  ”)
1900.定位写出 (500, “收费员”)

打开 (.内容, , , , , , )
置当前库 (.内容)
到首记录 ()
赋值 (x, 550)
赋值 (y, 0)
赋值 (.字体.字体大小, 9)
.计次循环首 (取记录数 (), 好)
    赋值 (x, 相加 (x, 40))
    赋值 (y, 相加 (y, 1))
    跳到 (y)
    200.定位写出 (x, 读 (“shj”))
    450.定位写出 (x, 读 (“mch”))
    800.定位写出 (x, 读 (“lb”))
    950.定位写出 (x, 读 (“bx”))
    1100.定位写出 (x, 读 (“dw”))
    1300.定位写出 (x, 读 (“shl”))
    1450.定位写出 (x, 读 (“dj”))
    1600.定位写出 (x, 读 (“hj”))
    1750.定位写出 (x, 读 (“cf”))
    1900.定位写出 (x, 读 (“shf”))
.计次循环尾 ()
200.画直线 (相加 (相乘 (取记录数 (), 40), 600), 2300, 相加 (相乘 (取记录数 (), 40), 600))
赋值 (.字体.字体大小, 11)
1300.定位写出 (相加 (相乘 (50, 取记录数 ()), 580), 相加 (“打印时间：”, 到文本 (取现行时间 ())))
结束打印 ()


.子程序 _时钟1_周期事件, 空白型, , 
赋值 (.标题, 到文本 (取现行时间 ()))


.子程序 _药品库存_被选择, 空白型, , 
载入 (药品库存, , 假)

.子程序 _住院管理_被选择, 空白型, , 
载入 (假)

.子程序 _门诊用药_被选择, 空白型, , 
载入 (假)

.子程序 _关于作者_被选择, 空白型, , 
载入 (关于, , 真)

.子程序 _住院票据_被选择, 空白型, , 
载入 (药品支出模块, , 假)

.子程序 _报表管理_被选择, 空白型, , 
载入 (假)

.子程序 _退出系统_被选择, 空白型, , 
结束 ()

.窗口程序集 窗口程序集8, , , 

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 x, 空白型, , , 
.局部变量 y, 空白型, , , 
.局部变量 z, 空白型, , , 

打开 (“zyjbxx”, , , , , , )
置当前库 (“zyjbxx”)
到首记录 ()
复制记录 (“zylshk”, 并且 (大于或等于 (读 (“sj”), 到时间 (.内容)), 小于或等于 (读 (“sj”), 到时间 (.内容))), )
打开 (“zylshk”, , , , , , )
置当前库 (“zylshk”)
到首记录 ()
.开始打印 (2, )
赋值 (.字体.字体大小, 16)
850.定位写出 (300, “住院病人一览表”)
赋值 (.字体.字体大小, 10)
200.定位写出 (400, “姓名”)
320.定位写出 (400, “性别”)
400.定位写出 (400, “年龄”)
500.定位写出 (400, “医保证号”)
700.定位写出 (400, “住院时间”)
900.定位写出 (400, “    病      种    ”)
1350.定位写出 (400, “住院号”)
1450.定位写出 (400, “  科室  ”)
1550.定位写出 (400, “  床位号 ”)
1730.定位写出 (400, “主治医师”)
1880.定位写出 (400, “ 预付款 ”)
200.画直线 (450, 2400, 450)
赋值 (x, 470)
赋值 (y, 0)
.计次循环首 (取记录数 (), z)
    赋值 (x, 相加 (x, 50))
    赋值 (相加 (1))
    跳到 ()
    200.定位写出 (x, 读 (“xm”))
    350.定位写出 (x, 读 (“xb”))
    420.定位写出 (x, 读 (“nl”))
    500.定位写出 (x, 读 (“zh”))
    660.定位写出 (x, 读 (“sj”))
    900.定位写出 (x, 读 (“bz”))
    1350.定位写出 (x, 读 (“zyh”))
    1500.定位写出 (x, 读 (“ks”))
    1600.定位写出 (x, 读 (“cwh”))
    1750.定位写出 (x, 读 (“ys”))
    1900.定位写出 (x, 读 (“yfk”))
    
    
.计次循环尾 ()

200.画直线 (相加 (相乘 (50, 取记录数 ()), 550), 2400, 相加 (相乘 (50, 取记录数 ()), 550))
1300.定位写出 (相加 (相乘 (50, 取记录数 ()), 580), 相加 (“打印时间：”, 到文本 (取现行时间 ())))
结束打印 ()
清空 ()
关闭 ()
销毁 ()


.窗口程序集 窗口程序集9, , , 

.子程序 _按钮2_被单击, 空白型, , 

.判断开始 (并且 (文件是否存在 (相加 (“m”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天)), “.edb”)), 文件是否存在 (相加 (“bz”, 到文本 (取年份 (.今天)), “.edb”))))
    .开始打印 (2, 1)
    子程序1 ()
    子程序2 ()
    子程序3 ()
    子程序4 ()
    结束打印 ()
.判断 (并且 (等于 (文件是否存在 (相加 (“m”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天)), “.edb”)), 假), 等于 (文件是否存在 (相加 (“bz”, 到文本 (取年份 (.今天)), “.edb”)), 假)))
    .开始打印 (2, 1)
    子程序1 ()
    结束打印 ()
.判断 (并且 (等于 (文件是否存在 (相加 (“m”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天)), “.edb”)), 真), 等于 (文件是否存在 (相加 (“bz”, 到文本 (取年份 (.今天)), “.edb”)), 假)))
    .开始打印 (2, 1)
    子程序1 ()
    子程序2 ()
    子程序5 ()
    结束打印 ()
.判断 (并且 (等于 (文件是否存在 (相加 (“m”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天)), “.edb”)), 假), 等于 (文件是否存在 (相加 (“bz”, 到文本 (取年份 (.今天)), “.edb”)), 真)))
    .开始打印 (2, 1)
    子程序1 ()
    子程序3 ()
    子程序6 ()
    结束打印 ()
.默认
    
.判断结束





.子程序 子程序1, 空白型, , 
.局部变量 x, 空白型, , , 
.局部变量 y, 空白型, , , 

赋值 (.字体.字体大小, 20)
1100.定位写出 (150, “康复中心业务月报表”)
赋值 (.字体.字体大小, 14)
200.定位写出 (230, 相加 (“(一)康复门诊                                   ”, 到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, “                        (单位：元)”))
200.定位写出 (700, “(二)用品用具                                             (四) 药品专项”)
200.定位写出 (1400, “(三)聋儿班”)
150.画直线 (300, 2800, 300)
150.画直线 (370, 2800, 370)
150.画直线 (440, 2800, 440)
150.画直线 (510, 2800, 510)
150.画直线 (580, 2800, 580)
赋值 (150)
.计次循环首 (14, x)
    y.画直线 (300, y, 580)
    赋值 (相加 (132))
.计次循环尾 ()
赋值 (y, 2200)
.计次循环首 (5, x)
    y.画直线 (300, y, 580)
    赋值 (y, 相加 (y, 150))
.计次循环尾 ()
赋值 (.字体.字体大小, 13)
300.定位写出 (310, “西成  草药  床位  治疗  化验  功能  放射  吸氧  手术  输血  监护  其他       合计      康复   针灸   测听   评残 ”)
170.定位写出 (380, “门诊”)
170.定位写出 (450, “住院”)
170.定位写出 (520, “合计”)

170.定位写出 (810, “  名  称      数 量      零售价     成 本      利 润”)
170.定位写出 (880, “  助听器”)
170.定位写出 (950, “  耳  模”)
170.定位写出 (1020, “  电  池”)
170.定位写出 (1090, “  轮  椅”)
170.定位写出 (1310, “  合  计”)
赋值 (x, 800)
.计次循环首 (9, y)
    150.画直线 (x, 1400, x)
    赋值 (x, 相加 (x, 70))
.计次循环尾 ()
赋值 (x, 150)
.计次循环首 (6, y)
    x.画直线 (800, x, 1360)
    赋值 (x, 相加 (x, 250))
.计次循环尾 ()
1600.画直线 (800, 2750, 800)
1850.画直线 (870, 2750, 870)
赋值 (x, 940)
.计次循环首 (11, y)
    1600.画直线 (x, 2750, x)
    赋值 (x, 相加 (x, 70))
.计次循环尾 ()
1600.画直线 (800, 1600, 1640)
1850.画直线 (800, 1850, 1220)
2100.画直线 (870, 2100, 1220)
2350.画直线 (800, 2350, 1220)
2600.画直线 (870, 2600, 1220)
2750.画直线 (800, 2750, 1640)
1850.画直线 (1290, 1850, 1640)
2150.画直线 (1290, 2150, 1640)
2450.画直线 (1290, 2450, 1640)
1650.定位写出 (870, “项目”)
1900.定位写出 (810, “   西成药                 中草药”)
1900.定位写出 (880, “进  价      零售价     进  价   零售价”)
1650.定位写出 (950, “石药”)
1650.定位写出 (1020, “赞药”)
1650.定位写出 (1090, “其他”)
1650.定位写出 (1160, “合计”)
1950.定位写出 (1230, “月总计(零售价)”)
1900.定位写出 (1300, “  西成药       中草药        合  计”)
1630.定位写出 (1370, “上月库存”)
1630.定位写出 (1440, “本月进药”)
1630.定位写出 (1510, “当月销售”)
1630.定位写出 (1580, “现有库存”)


赋值 (x, 1500)
.计次循环首 (4, y)
    150.画直线 (x, 1350, x)
    赋值 (x, 相加 (x, 70))
.计次循环尾 ()
150.画直线 (1500, 150, 1710)
350.画直线 (1500, 350, 1710)
550.画直线 (1500, 550, 1640)
750.画直线 (1500, 750, 1710)
950.画直线 (1500, 950, 1640)
1150.画直线 (1500, 1150, 1640)
1350.画直线 (1500, 1350, 1710)
200.定位写出 (1510, “收入     食宿生            走读生            合  计”)
200.定位写出 (1580, “支出     饭  费            其  他            合  计”)
200.定位写出 (1650, “结余”)



.子程序 子程序2, 空白型, , 
打开 (相加 (“m”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))), , , , , , )
置当前库 (相加 (“m”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “西药”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “检查”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “手术”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “中成”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “输氧”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “治疗”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “化验”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “其它”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “中草”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “放射”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “输血”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “住院”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “冷暖”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “接生”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “婴儿”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “医疗”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “监护”)))
赋值 (phj, 求和 (读 (“hj”), ))
赋值 (.字体.字体大小, 9)
310.定位写出 (380, 相加 (ps, pzc))
440.定位写出 (380, pzy)
570.定位写出 (380, pzhy)
700.定位写出 (380, pzl)
840.定位写出 (380, phy)
970.定位写出 (380, pj)
1110.定位写出 (380, pfs)
1240.定位写出 (380, psy)
1360.定位写出 (380, pss)
1490.定位写出 (380, psx)
1620.定位写出 (380, pjh)
1750.定位写出 (380, pqt)
1900.定位写出 (380, phj)


.子程序 子程序3, 空白型, , 
打开 (相加 (“bz”, 到文本 (取年份 (.今天))), , , , , , )
置当前库 (相加 (“bz”, 到文本 (取年份 (.今天))))
赋值 (pps, 求和 (读 (“ps”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppj, 求和 (读 (“pj”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppss, 求和 (读 (“pss”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppzc, 求和 (读 (“pzc”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppsy, 求和 (读 (“psy”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppzl, 求和 (读 (“pzl”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (pphy, 求和 (读 (“phy”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppqt, 求和 (读 (“pqt”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppzy, 求和 (读 (“pzy”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppfs, 求和 (读 (“pfs”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppsx, 求和 (读 (“psx”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pzhy”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppln, 求和 (读 (“pln”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppjs, 求和 (读 (“pjs”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppye, 求和 (读 (“pye”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppyl, 求和 (读 (“pyl”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppjh, 求和 (读 (“pjh”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (pphj, 求和 (读 (“phj”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (.字体.字体大小, 9)
310.定位写出 (450, 相加 (pps, ppzc))
440.定位写出 (450, ppzy)
570.定位写出 (450, ppzhy)
700.定位写出 (450, ppzl)
840.定位写出 (450, pphy)
970.定位写出 (450, ppj)
1110.定位写出 (450, ppfs)
1240.定位写出 (450, ppsy)
1360.定位写出 (450, ppss)
1490.定位写出 (450, ppsx)
1620.定位写出 (450, ppjh)
1750.定位写出 (450, ppqt)
1900.定位写出 (450, pphj)




.子程序 子程序4, 空白型, , 
赋值 (.字体.字体大小, 9)
310.定位写出 (520, 相加 (pps, ppzc, ps, pzc))
440.定位写出 (520, 相加 (ppzy, pzy))
570.定位写出 (520, 相加 (ppzhy, pzhy))
700.定位写出 (520, 相加 (ppzl, pzl))
840.定位写出 (520, 相加 (pphy, phy))
970.定位写出 (520, 相加 (ppj, pj))
1110.定位写出 (520, 相加 (ppfs, pfs))
1240.定位写出 (520, 相加 (psy, ppsy))
1360.定位写出 (520, 相加 (pss, ppss))
1490.定位写出 (520, 相加 (psx, ppsx))
1620.定位写出 (520, 相加 (pjh, ppjh))
1750.定位写出 (520, 相加 (pqt, ppqt))
1900.定位写出 (520, 相加 (phj, pphj))


.子程序 子程序5, 空白型, , 
打开 (相加 (“m”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))), , , , , , )
置当前库 (相加 (“m”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “西药”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “检查”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “手术”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “中成”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “输氧”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “治疗”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “化验”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “其它”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “中草”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “放射”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “输血”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “住院”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “冷暖”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “接生”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “婴儿”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “医疗”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “监护”)))
赋值 (phj, 求和 (读 (“hj”), ))
赋值 (.字体.字体大小, 9)
310.定位写出 (520, 相加 (ps, pzc))
440.定位写出 (520, pzy)
570.定位写出 (520, pzhy)
700.定位写出 (520, pzl)
840.定位写出 (520, phy)
970.定位写出 (520, pj)
1110.定位写出 (520, pfs)
1240.定位写出 (520, psy)
1360.定位写出 (520, pss)
1490.定位写出 (520, psx)
1620.定位写出 (520, pjh)
1750.定位写出 (520, pqt)
1900.定位写出 (520, phj)


.子程序 子程序6, 空白型, , 
打开 (相加 (“bz”, 到文本 (取年份 (.今天))), , , , , , )
置当前库 (相加 (“bz”, 到文本 (取年份 (.今天))))
赋值 (pps, 求和 (读 (“ps”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppj, 求和 (读 (“pj”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppss, 求和 (读 (“pss”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppzc, 求和 (读 (“pzc”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppsy, 求和 (读 (“psy”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppzl, 求和 (读 (“pzl”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (pphy, 求和 (读 (“phy”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppqt, 求和 (读 (“pqt”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppzy, 求和 (读 (“pzy”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppfs, 求和 (读 (“pfs”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppsx, 求和 (读 (“psx”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pzhy”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppln, 求和 (读 (“pln”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppjs, 求和 (读 (“pjs”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppye, 求和 (读 (“pye”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppyl, 求和 (读 (“pyl”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (ppjh, 求和 (读 (“pjh”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (pphj, 求和 (读 (“phj”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (.字体.字体大小, 9)
310.定位写出 (520, 相加 (pps, ppzc))
440.定位写出 (520, ppzy)
570.定位写出 (520, ppzhy)
700.定位写出 (520, ppzl)
840.定位写出 (520, pphy)
970.定位写出 (520, ppj)
1110.定位写出 (520, ppfs)
1240.定位写出 (520, ppsy)
1360.定位写出 (520, ppss)
1490.定位写出 (520, ppsx)
1620.定位写出 (520, ppjh)
1750.定位写出 (520, ppqt)
1900.定位写出 (520, pphj)


.子程序 _按钮3_被单击, 空白型, , 

.判断开始 (并且 (文件是否存在 (相加 (“bm”, 到文本 (取年份 (.今天)), “.edb”)), 文件是否存在 (相加 (“bz”, 到文本 (取年份 (.今天)), “.edb”))))
    .开始打印 (2, 1)
    子程序7 ()
    子程序8 ()
    子程序9 ()
    子程序10 ()
    结束打印 ()
.判断 (并且 (等于 (文件是否存在 (相加 (“bm”, 到文本 (取年份 (.今天)), “.edb”)), 假), 等于 (文件是否存在 (相加 (“bz”, 到文本 (取年份 (.今天)), “.edb”)), 假)))
    .开始打印 (2, 1)
    子程序7 ()
    结束打印 ()
.判断 (并且 (等于 (文件是否存在 (相加 (“bm”, 到文本 (取年份 (.今天)), “.edb”)), 真), 等于 (文件是否存在 (相加 (“bz”, 到文本 (取年份 (.今天)), “.edb”)), 假)))
    .开始打印 (2, 1)
    子程序7 ()
    子程序8 ()
    子程序11 ()
    结束打印 ()
.判断 (并且 (等于 (文件是否存在 (相加 (“m”, 到文本 (取年份 (.今天)), “.edb”)), 假), 等于 (文件是否存在 (相加 (“bz”, 到文本 (取年份 (.今天)), “.edb”)), 真)))
    .开始打印 (2, 1)
    子程序7 ()
    子程序9 ()
    子程序12 ()
    结束打印 ()
.默认
    
.判断结束






.子程序 子程序7, 空白型, , 
.局部变量 x, 空白型, , , 
.局部变量 y, 空白型, , , 

赋值 (.字体.字体大小, 20)
1100.定位写出 (150, “康复中心业务年报表”)
赋值 (.字体.字体大小, 14)
200.定位写出 (230, 相加 (“(一)康复门诊                                   ”, 到文本 (取年份 (.今天)), “年”, “                               (单位：元)”))
200.定位写出 (700, “(二)用品用具                                             (四) 药品专项”)
200.定位写出 (1400, “(三)聋儿班”)
150.画直线 (300, 2800, 300)
150.画直线 (370, 2800, 370)
150.画直线 (440, 2800, 440)
150.画直线 (510, 2800, 510)
150.画直线 (580, 2800, 580)
赋值 (150)
.计次循环首 (14, )
    .画直线 (300, , 580)
    赋值 (相加 (132))
.计次循环尾 ()
赋值 (2200)
.计次循环首 (5, )
    .画直线 (300, , 580)
    赋值 (相加 (150))
.计次循环尾 ()
赋值 (.字体.字体大小, 13)
300.定位写出 (310, “西成  草药  床位  治疗  化验  功能  放射  吸氧  手术  输血  监护  其他       合计      康复   针灸   测听   评残 ”)
170.定位写出 (380, “门诊”)
170.定位写出 (450, “住院”)
170.定位写出 (520, “合计”)

170.定位写出 (810, “  名  称      数 量      零售价     成 本      利 润”)
170.定位写出 (880, “  助听器”)
170.定位写出 (950, “  耳  模”)
170.定位写出 (1020, “  电  池”)
170.定位写出 (1090, “  轮  椅”)
170.定位写出 (1310, “  合  计”)
赋值 (800)
.计次循环首 (9, )
    150.画直线 (1400, )
    赋值 (相加 (70))
.计次循环尾 ()
赋值 (150)
.计次循环首 (6, )
    .画直线 (800, , 1360)
    赋值 (相加 (250))
.计次循环尾 ()
1600.画直线 (800, 2750, 800)
1850.画直线 (870, 2750, 870)
赋值 (940)
.计次循环首 (11, )
    1600.画直线 (2750, )
    赋值 (相加 (70))
.计次循环尾 ()
1600.画直线 (800, 1600, 1640)
1850.画直线 (800, 1850, 1220)
2100.画直线 (870, 2100, 1220)
2350.画直线 (800, 2350, 1220)
2600.画直线 (870, 2600, 1220)
2750.画直线 (800, 2750, 1640)
1850.画直线 (1290, 1850, 1640)
2150.画直线 (1290, 2150, 1640)
2450.画直线 (1290, 2450, 1640)
1650.定位写出 (870, “项目”)
1900.定位写出 (810, “   西成药                 中草药”)
1900.定位写出 (880, “进  价      零售价     进  价   零售价”)
1650.定位写出 (950, “石药”)
1650.定位写出 (1020, “赞药”)
1650.定位写出 (1090, “其他”)
1650.定位写出 (1160, “合计”)
1950.定位写出 (1230, “月总计(零售价)”)
1900.定位写出 (1300, “  西成药       中草药        合  计”)
1630.定位写出 (1370, “上月库存”)
1630.定位写出 (1440, “本月进药”)
1630.定位写出 (1510, “当月销售”)
1630.定位写出 (1580, “现有库存”)


赋值 (1500)
.计次循环首 (4, )
    150.画直线 (1350, )
    赋值 (相加 (70))
.计次循环尾 ()
150.画直线 (1500, 150, 1710)
350.画直线 (1500, 350, 1710)
550.画直线 (1500, 550, 1640)
750.画直线 (1500, 750, 1710)
950.画直线 (1500, 950, 1640)
1150.画直线 (1500, 1150, 1640)
1350.画直线 (1500, 1350, 1710)
200.定位写出 (1510, “收入     食宿生            走读生            合  计”)
200.定位写出 (1580, “支出     饭  费            其  他            合  计”)
200.定位写出 (1650, “结余”)



.子程序 子程序8, 空白型, , 
打开 (相加 (“bm”, 到文本 (取年份 (.今天))), , , , , , )
置当前库 (相加 (“bm”, 到文本 (取年份 (.今天))))
赋值 (ps, 求和 (读 (“ps”), ))
赋值 (pj, 求和 (读 (“pj”), ))
赋值 (pss, 求和 (读 (“pss”), ))
赋值 (pzc, 求和 (读 (“pzc”), ))
赋值 (psy, 求和 (读 (“psy”), ))
赋值 (pzl, 求和 (读 (“pzl”), ))
赋值 (phy, 求和 (读 (“phy”), ))
赋值 (pqt, 求和 (读 (“pqt”), ))
赋值 (pzy, 求和 (读 (“pzy”), ))
赋值 (pfs, 求和 (读 (“pfs”), ))
赋值 (psx, 求和 (读 (“psx”), ))
赋值 (pzhy, 求和 (读 (“pzhy”), ))
赋值 (pln, 求和 (读 (“pln”), ))
赋值 (pjs, 求和 (读 (“pjs”), ))
赋值 (pye, 求和 (读 (“pye”), ))
赋值 (pyl, 求和 (读 (“pyl”), ))
赋值 (pjh, 求和 (读 (“pjh”), ))
赋值 (phj, 求和 (读 (“phj”), ))

赋值 (.字体.字体大小, 9)

310.定位写出 (380, 相加 (ps, pzc))
440.定位写出 (380, pzy)
570.定位写出 (380, pzhy)
700.定位写出 (380, pzl)
840.定位写出 (380, phy)
970.定位写出 (380, pj)
1110.定位写出 (380, pfs)
1240.定位写出 (380, psy)
1360.定位写出 (380, pss)
1490.定位写出 (380, psx)
1620.定位写出 (380, pjh)
1750.定位写出 (380, pqt)
1900.定位写出 (380, phj)




.子程序 子程序9, 空白型, , 
打开 (相加 (“bz”, 到文本 (取年份 (.今天))), , , , , , )
置当前库 (相加 (“bz”, 到文本 (取年份 (.今天))))
赋值 (pps, 求和 (读 (“ps”), ))
赋值 (ppj, 求和 (读 (“pj”), ))
赋值 (ppss, 求和 (读 (“pss”), ))
赋值 (ppzc, 求和 (读 (“pzc”), ))
赋值 (ppsy, 求和 (读 (“psy”), ))
赋值 (ppzl, 求和 (读 (“pzl”), ))
赋值 (pphy, 求和 (读 (“phy”), ))
赋值 (ppqt, 求和 (读 (“pqt”), ))
赋值 (ppzy, 求和 (读 (“pzy”), ))
赋值 (ppfs, 求和 (读 (“pfs”), ))
赋值 (ppsx, 求和 (读 (“psx”), ))
赋值 (ppzhy, 求和 (读 (“pzhy”), ))
赋值 (ppln, 求和 (读 (“pln”), ))
赋值 (ppjs, 求和 (读 (“pjs”), ))
赋值 (ppye, 求和 (读 (“pye”), ))
赋值 (ppyl, 求和 (读 (“pyl”), ))
赋值 (ppjh, 求和 (读 (“pjh”), ))
赋值 (pphj, 求和 (读 (“phj”), ))

赋值 (.字体.字体大小, 9)

310.定位写出 (450, 相加 (pps, ppzc))
440.定位写出 (450, ppzy)
570.定位写出 (450, ppzhy)
700.定位写出 (450, ppzl)
840.定位写出 (450, pphy)
970.定位写出 (450, ppj)
1110.定位写出 (450, ppfs)
1240.定位写出 (450, ppsy)
1360.定位写出 (450, ppss)
1490.定位写出 (450, ppsx)
1620.定位写出 (450, ppjh)
1750.定位写出 (450, ppqt)
1900.定位写出 (450, pphj)



.子程序 子程序10, 空白型, , 
赋值 (.字体.字体大小, 9)

310.定位写出 (520, 相加 (pps, ppzc, ps, pzc))
440.定位写出 (520, 相加 (ppzy, pzy))
570.定位写出 (520, 相加 (ppzhy, pzhy))
700.定位写出 (520, 相加 (ppzl, pzl))
840.定位写出 (520, 相加 (pphy, phy))
970.定位写出 (520, 相加 (ppj, pj))
1110.定位写出 (520, 相加 (ppfs, pfs))
1240.定位写出 (520, 相加 (psy, ppsy))
1360.定位写出 (520, 相加 (pss, ppss))
1490.定位写出 (520, 相加 (psx, ppsx))
1620.定位写出 (520, 相加 (pjh, ppjh))
1750.定位写出 (520, 相加 (pqt, ppqt))
1900.定位写出 (520, 相加 (phj, pphj))



.子程序 子程序11, 空白型, , 
打开 (相加 (“bm”, 到文本 (取年份 (.今天))), , , , , , )
置当前库 (相加 (“bm”, 到文本 (取年份 (.今天))))
赋值 (ps, 求和 (读 (“ps”), ))
赋值 (pj, 求和 (读 (“pj”), ))
赋值 (pss, 求和 (读 (“pss”), ))
赋值 (pzc, 求和 (读 (“pzc”), ))
赋值 (psy, 求和 (读 (“psy”), ))
赋值 (pzl, 求和 (读 (“pzl”), ))
赋值 (phy, 求和 (读 (“phy”), ))
赋值 (pqt, 求和 (读 (“pqt”), ))
赋值 (pzy, 求和 (读 (“pzy”), ))
赋值 (pfs, 求和 (读 (“pfs”), ))
赋值 (psx, 求和 (读 (“psx”), ))
赋值 (pzhy, 求和 (读 (“pzhy”), ))
赋值 (pln, 求和 (读 (“pln”), ))
赋值 (pjs, 求和 (读 (“pjs”), ))
赋值 (pye, 求和 (读 (“pye”), ))
赋值 (pyl, 求和 (读 (“pyl”), ))
赋值 (pjh, 求和 (读 (“pjh”), ))
赋值 (phj, 求和 (读 (“phj”), ))
赋值 (.字体.字体大小, 9)

310.定位写出 (520, 相加 (ps, pzc))
440.定位写出 (520, pzy)
570.定位写出 (520, pzhy)
700.定位写出 (520, pzl)
840.定位写出 (520, phy)
970.定位写出 (520, pj)
1110.定位写出 (520, pfs)
1240.定位写出 (520, psy)
1360.定位写出 (520, pss)
1490.定位写出 (520, psx)
1620.定位写出 (520, pjh)
1750.定位写出 (520, pqt)
1900.定位写出 (520, phj)



.子程序 子程序12, 空白型, , 
打开 (相加 (“bz”, 到文本 (取年份 (.今天))), , , , , , )
置当前库 (相加 (“bz”, 到文本 (取年份 (.今天))))
赋值 (pps, 求和 (读 (“ps”), ))
赋值 (ppj, 求和 (读 (“pj”), ))
赋值 (ppss, 求和 (读 (“pss”), ))
赋值 (ppzc, 求和 (读 (“pzc”), ))
赋值 (ppsy, 求和 (读 (“psy”), ))
赋值 (ppzl, 求和 (读 (“pzl”), ))
赋值 (pphy, 求和 (读 (“phy”), ))
赋值 (ppqt, 求和 (读 (“pqt”), ))
赋值 (ppzy, 求和 (读 (“pzy”), ))
赋值 (ppfs, 求和 (读 (“pfs”), ))
赋值 (ppsx, 求和 (读 (“psx”), ))
赋值 (ppzhy, 求和 (读 (“pzhy”), ))
赋值 (ppln, 求和 (读 (“pln”), ))
赋值 (ppjs, 求和 (读 (“pjs”), ))
赋值 (ppye, 求和 (读 (“pye”), ))
赋值 (ppyl, 求和 (读 (“pyl”), ))
赋值 (ppjh, 求和 (读 (“pjh”), ))
赋值 (pphj, 求和 (读 (“phj”), ))
赋值 (.字体.字体大小, 9)

310.定位写出 (520, 相加 (pps, ppzc))
440.定位写出 (520, ppzy)
570.定位写出 (520, ppzhy)
700.定位写出 (520, ppzl)
840.定位写出 (520, pphy)
970.定位写出 (520, ppj)
1110.定位写出 (520, ppfs)
1240.定位写出 (520, ppsy)
1360.定位写出 (520, ppss)
1490.定位写出 (520, ppsx)
1620.定位写出 (520, ppjh)
1750.定位写出 (520, ppqt)
1900.定位写出 (520, pphj)


.子程序 _药品库存_被选择, 空白型, , 
载入 (药品库存, , 假)

.子程序 _住院信息_被选择, 空白型, , 
载入 (住院基本信息, , 假)

.子程序 _住院票据_被选择, 空白型, , 
载入 (药品支出模块, , 假)

.子程序 _门诊用药_被选择, 空白型, , 
载入 (门诊用药, , 假)

.子程序 _退出系统_被选择, 空白型, , 
结束 ()

.子程序 _关于作者_被选择, 空白型, , 
载入 (关于, , 真)

.子程序 _按钮5_被单击, 空白型, , 
打开 (相加 (“bz”, 到文本 (取年份 (.今天))), , , , , , )
置当前库 (相加 (“bz”, 到文本 (取年份 (.今天))))
编辑 ()

.子程序 _按钮6_被单击, 空白型, , 
打开 (相加 (“bm”, 到文本 (取年份 (.今天))), , , , , , )
置当前库 (相加 (“bm”, 到文本 (取年份 (.今天))))
编辑 ()


.子程序 _按钮7_被单击, 空白型, , 
打开 (相加 (“bz”, 到文本 (取年份 (.今天))), , , , , , )
置当前库 (相加 (“bz”, 到文本 (取年份 (.今天))))
编辑 ()


.子程序 _按钮9_被单击, 空白型, , 

.判断开始 (并且 (文件是否存在 (相加 (“m”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ())), “.edb”)), 文件是否存在 (相加 (“n”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ())), “.edb”))))
    .开始打印 (2, 1)
    a ()
    b ()
    c ()
    dd ()
    结束打印 ()
    
.判断 (并且 (等于 (文件是否存在 (相加 (“m”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ())), “.edb”)), 假), 等于 (文件是否存在 (相加 (“n”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ())), “.edb”)), 假)))
    .开始打印 (2, 1)
    a ()
    结束打印 ()
    
.判断 (并且 (等于 (文件是否存在 (相加 (“m”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ())), “.edb”)), 真), 等于 (文件是否存在 (相加 (“n”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ())), “.edb”)), 假)))
    .开始打印 (2, 1)
    a ()
    b ()
    e ()
    结束打印 ()
    
.判断 (并且 (等于 (文件是否存在 (相加 (“m”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ())), “.edb”)), 真), 等于 (文件是否存在 (相加 (“n”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ())), “.edb”)), 假)))
    .开始打印 (2, 1)
    a ()
    c ()
    ff ()
    结束打印 ()
    
.默认
    
.判断结束


.子程序 a, 空白型, , 
.局部变量 x, 空白型, , , 
.局部变量 y, 空白型, , , 

赋值 (.字体.字体大小, 20)

1100.定位写出 (150, “康复中心业务月报表(内部)”)
赋值 (.字体.字体大小, 14)
200.定位写出 (280, 相加 (“     康复中心                                   ”, 到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月”, “                        (单位：元)”))
赋值 (y, 200)
.计次循环首 (9, x)
    y.画直线 (350, y, 1150)
    赋值 (y, 相加 (y, 250))
.计次循环尾 ()
2750.画直线 (350, 2750, 1150)
赋值 (y, 350)
.计次循环首 (9, x)
    200.画直线 (y, 2750, y)
    赋值 (y, 相加 (y, 100))
.计次循环尾 ()
赋值 (.字体.字体大小, 13)
250.定位写出 (380, “项  目      杨成书     李兰秋     张会彬      杨  晶     周日和      王晓云      王  伟           合  计”)
250.定位写出 (480, “门  诊”)
250.定位写出 (580, “住  院”)
250.定位写出 (680, “合  计”)
245.定位写出 (780, “特色门诊”)
245.定位写出 (880, “特色住院”)
245.定位写出 (980, “特色合计”)
250.定位写出 (1080, “总  计”)


.子程序 b, 空白型, , 
打开 (相加 (“m”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))), , , , , , )
置当前库 (相加 (“m”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))))
赋值 (n1, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “01”)))
赋值 (n2, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “02”)))
赋值 (n3, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “03”)))
赋值 (n4, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “04”)))
赋值 (n5, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “05”)))
赋值 (n6, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “06”)))
赋值 (n7, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “07”)))
赋值 (n8, 相加 (n1, n2, n3, n4, n5, n6, n7))
赋值 (r1, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “11”)))
赋值 (r2, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “12”)))
赋值 (r3, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “13”)))
赋值 (r4, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “14”)))
赋值 (r5, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “15”)))
赋值 (r6, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “16”)))
赋值 (r7, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “17”)))
赋值 (r8, 相加 (r1, r2, r3, r4, r5, r6, r7))

480.定位写出 (480, n1)
730.定位写出 (480, n2)
960.定位写出 (480, n3)
1230.定位写出 (480, n4)
1480.定位写出 (480, n5)
1730.定位写出 (480, n6)
2000.定位写出 (480, n7)
2250.定位写出 (480, n8)

480.定位写出 (780, r1)
730.定位写出 (780, r2)
960.定位写出 (780, r3)
1230.定位写出 (780, r4)
1480.定位写出 (780, r5)
1730.定位写出 (780, r6)
2000.定位写出 (780, r7)
2250.定位写出 (780, r8)

.子程序 c, 空白型, , 
打开 (相加 (“n”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))), , , , , , )
置当前库 (相加 (“n”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))))
赋值 (g1, 求和 (读 (“c1”), ))
赋值 (g2, 求和 (读 (“c2”), ))
赋值 (g3, 求和 (读 (“c3”), ))
赋值 (g4, 求和 (读 (“c4”), ))
赋值 (g5, 求和 (读 (“c5”), ))
赋值 (g6, 求和 (读 (“c6”), ))
赋值 (g7, 求和 (读 (“c7”), ))
赋值 (g8, 求和 (读 (“c8”), ))
赋值 (g9, 求和 (读 (“c9”), ))
赋值 (g10, 求和 (读 (“c10”), ))
赋值 (g11, 求和 (读 (“c11”), ))
赋值 (g12, 求和 (读 (“c12”), ))
赋值 (g13, 求和 (读 (“c13”), ))
赋值 (g14, 求和 (读 (“c14”), ))
赋值 (g15, 求和 (读 (“c15”), ))
赋值 (g16, 求和 (读 (“c16”), ))

480.定位写出 (580, g1)
730.定位写出 (580, g2)
960.定位写出 (580, g3)
1230.定位写出 (580, g4)
1480.定位写出 (580, g5)
1730.定位写出 (580, g6)
2000.定位写出 (580, g7)
2250.定位写出 (580, g8)
480.定位写出 (880, g9)
730.定位写出 (880, g10)
960.定位写出 (880, g11)
1230.定位写出 (880, g12)
1480.定位写出 (880, g13)
1730.定位写出 (880, g14)
2000.定位写出 (880, g15)
2250.定位写出 (880, g16)

.子程序 dd, 空白型, , 
480.定位写出 (680, 相加 (g1, n1))
730.定位写出 (680, 相加 (g2, n2))
960.定位写出 (680, 相加 (g3, n3))
1230.定位写出 (680, 相加 (g4, n4))
1480.定位写出 (680, 相加 (g5, n5))
1730.定位写出 (680, 相加 (g6, n6))
2000.定位写出 (680, 相加 (g7, n7))
2250.定位写出 (680, 相加 (g8, n8))
480.定位写出 (980, 相加 (r1, g9))
730.定位写出 (980, 相加 (g10, r2))
960.定位写出 (980, 相加 (g11, r3))
1230.定位写出 (980, 相加 (g12, r4))
1480.定位写出 (980, 相加 (g13, r5))
1730.定位写出 (980, 相加 (g14, r6))
2000.定位写出 (980, 相加 (g15, r7))
2250.定位写出 (980, 相加 (g16, r8))
480.定位写出 (1080, 相加 (g1, n1, g9, r1))
730.定位写出 (1080, 相加 (g2, n2, g10, r2))
960.定位写出 (1080, 相加 (g3, n3, g11, r3))
1230.定位写出 (1080, 相加 (g4, n4, g12, r4))
1480.定位写出 (1080, 相加 (g5, n5, g13, r5))
1730.定位写出 (1080, 相加 (g6, n6, g14, r6))
2000.定位写出 (1080, 相加 (g7, n7, g15, r7))
2250.定位写出 (1080, 相加 (g8, n8, g16, r8))

.子程序 e, 空白型, , 
打开 (相加 (“m”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))), , , , , , )
置当前库 (相加 (“m”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))))
赋值 (n1, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “01”)))
赋值 (n2, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “02”)))
赋值 (n3, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “03”)))
赋值 (n4, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “04”)))
赋值 (n5, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “05”)))
赋值 (n6, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “06”)))
赋值 (n7, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “07”)))
赋值 (n8, 相加 (n1, n2, n3, n4, n5, n6, n7))
赋值 (r1, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “11”)))
赋值 (r2, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “12”)))
赋值 (r3, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “13”)))
赋值 (r4, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “14”)))
赋值 (r5, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “15”)))
赋值 (r6, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “16”)))
赋值 (r7, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “17”)))
赋值 (r8, 相加 (r1, r2, r3, r4, r5, r6, r7))

480.定位写出 (680, n1)
730.定位写出 (680, n2)
960.定位写出 (680, n3)
1230.定位写出 (680, n4)
1480.定位写出 (680, n5)
1730.定位写出 (680, n6)
2000.定位写出 (680, n7)
2250.定位写出 (680, n8)
480.定位写出 (980, r1)
730.定位写出 (980, r2)
960.定位写出 (980, r3)
1230.定位写出 (980, r4)
1480.定位写出 (980, r5)
1730.定位写出 (980, r6)
2000.定位写出 (980, r7)
2250.定位写出 (980, r8)
480.定位写出 (1080, 相加 (n1, r1))
730.定位写出 (1080, 相加 (n2, r2))
960.定位写出 (1080, 相加 (n3, r3))
1230.定位写出 (1080, 相加 (n4, r4))
1480.定位写出 (1080, 相加 (n5, r5))
1730.定位写出 (1080, 相加 (n6, r6))
2000.定位写出 (1080, 相加 (n7, r7))
2250.定位写出 (1080, 相加 (n8, r8))

.子程序 ff, 空白型, , 
打开 (相加 (“n”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))), , , , , , )
置当前库 (相加 (“n”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))))
赋值 (g1, 求和 (读 (“c1”), ))
赋值 (g2, 求和 (读 (“c2”), ))
赋值 (g3, 求和 (读 (“c3”), ))
赋值 (g4, 求和 (读 (“c4”), ))
赋值 (g5, 求和 (读 (“c5”), ))
赋值 (g6, 求和 (读 (“c6”), ))
赋值 (g7, 求和 (读 (“c7”), ))
赋值 (g8, 求和 (读 (“c8”), ))
赋值 (g9, 求和 (读 (“c9”), ))
赋值 (g10, 求和 (读 (“c10”), ))
赋值 (g11, 求和 (读 (“c11”), ))
赋值 (g12, 求和 (读 (“c12”), ))
赋值 (g13, 求和 (读 (“c13”), ))
赋值 (g14, 求和 (读 (“c14”), ))
赋值 (g15, 求和 (读 (“c15”), ))
赋值 (g16, 求和 (读 (“c16”), ))

480.定位写出 (680, g1)
730.定位写出 (680, g2)
960.定位写出 (680, g3)
1230.定位写出 (680, g4)
1480.定位写出 (680, g5)
1730.定位写出 (680, g6)
2000.定位写出 (680, g7)
2250.定位写出 (680, g8)
480.定位写出 (980, g9)
730.定位写出 (980, g10)
960.定位写出 (980, g11)
1230.定位写出 (980, g12)
1480.定位写出 (980, g13)
1730.定位写出 (980, g14)
2000.定位写出 (980, g15)
2250.定位写出 (980, g16)
480.定位写出 (1080, 相加 (g1, g9))
730.定位写出 (1080, 相加 (g2, g10))
960.定位写出 (1080, 相加 (g3, g11))
1230.定位写出 (1080, 相加 (g4, g12))
1480.定位写出 (1080, 相加 (g5, g13))
1730.定位写出 (1080, 相加 (g6, g14))
2000.定位写出 (1080, 相加 (g7, g15))
2250.定位写出 (1080, 相加 (g8, g16))

.子程序 _按钮10_被单击, 空白型, , 
打开 (相加 (“n”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))), , , , , , )
置当前库 (相加 (“n”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))))
编辑 ()

.子程序 _按钮1_被单击, 空白型, , 

.清除 ()
.判断开始 (并且 (文件是否存在 (相加 (“m”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天)), “.edb”)), 文件是否存在 (相加 (“bz”, 到文本 (取年份 (.今天)), “.edb”))))
    
.默认
    
.判断结束
t1 ()
t2 ()
t3 ()
t4 ()
.判断开始 (并且 (等于 (文件是否存在 (相加 (“m”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天)), “.edb”)), 假), 等于 (文件是否存在 (相加 (“bz”, 到文本 (取年份 (.今天)), “.edb”)), 假)))
    t1 ()
.判断 (并且 (等于 (文件是否存在 (相加 (“m”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天)), “.edb”)), 真), 等于 (文件是否存在 (相加 (“bz”, 到文本 (取年份 (.今天)), “.edb”)), 假)))
    t1 ()
    t2 ()
    t5 ()
.判断 (并且 (等于 (文件是否存在 (相加 (“m”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天)), “.edb”)), 假), 等于 (文件是否存在 (相加 (“bz”, 到文本 (取年份 (.今天)), “.edb”)), 真)))
    t1 ()
    t3 ()
    t6 ()
.默认
    
.判断结束



.子程序 t1, 空白型, , 
.局部变量 x, 空白型, , , 
.局部变量 y, 空白型, , , 

赋值 (.字体.字体大小, 16)
300.定位写出 (10, “康复中心业务月报表”)
赋值 (.字体.字体大小, 13)
20.定位写出 (40, 相加 (“康复门诊                               ”, 到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月                    单位：元”))
赋值 (.字体.字体大小, 12)
11.定位写出 (74, “       西成    草药   床位  治疗   化验  功能   放射  吸氧   手术   输血   监护  其他   合计”)
11.定位写出 (104, “门诊”)
11.定位写出 (164, “合计”)
11.定位写出 (134, “住院”)
赋值 (5)
.计次循环首 (15, y)
    .画直线 (70, , 190)
    赋值 (x, 相加 (x, 54))
.计次循环尾 ()
赋值 (x, 70)
.计次循环首 (5, y)
    5.画直线 (x, 761, x)
    赋值 (x, 相加 (x, 30))
.计次循环尾 ()
赋值 (.字体.字体大小, 8)


.子程序 t2, 空白型, , 
打开 (相加 (“m”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))), , , , , , )
置当前库 (相加 (“m”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “西药”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “检查”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “手术”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “中成”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “输氧”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “治疗”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “化验”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “其它”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “中草”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “放射”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “输血”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “住院”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “冷暖”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “接生”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “婴儿”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “医疗”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “监护”)))
赋值 (求和 (读 (“hj”), ))
60.定位写出 (110, 相加 (ps, pzc))
114.定位写出 (110, pzy)
168.定位写出 (110, pzhy)
222.定位写出 (110, pzl)
276.定位写出 (110, phy)
330.定位写出 (110, pj)
384.定位写出 (110, pfs)
438.定位写出 (110, psy)
492.定位写出 (110, pss)
546.定位写出 (110, psx)
600.定位写出 (110, pjh)
654.定位写出 (110, pqt)
708.定位写出 (110, phj)


.子程序 t3, 空白型, , 
打开 (相加 (“bz”, 到文本 (取年份 (.今天))), , , , , , )
置当前库 (相加 (“bz”, 到文本 (取年份 (.今天))))
赋值 (求和 (读 (“ps”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pj”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pss”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pzc”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“psy”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pzl”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“phy”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pqt”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pzy”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pfs”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“psx”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pzhy”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pln”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pjs”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pye”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pyl”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pjh”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“phj”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))

60.定位写出 (140, 相加 (pps, ppzc))
114.定位写出 (140, ppzy)
168.定位写出 (140, ppzhy)
222.定位写出 (140, ppzl)
276.定位写出 (140, pphy)
330.定位写出 (140, ppj)
384.定位写出 (140, ppfs)
438.定位写出 (140, ppsy)
492.定位写出 (140, ppss)
546.定位写出 (140, ppsx)
600.定位写出 (140, ppjh)
654.定位写出 (140, ppqt)
708.定位写出 (140, pphj)



.子程序 t4, 空白型, , 
60.定位写出 (170, 相加 (pps, ppzc, ps, pzc))
114.定位写出 (170, 相加 (pzy, ppzy))
168.定位写出 (170, 相加 (pzhy, ppzhy))
222.定位写出 (170, 相加 (pzl, ppzl))
276.定位写出 (170, 相加 (phy, pphy))
330.定位写出 (170, 相加 (pj, ppj))
384.定位写出 (170, 相加 (pfs, ppfs))
438.定位写出 (170, 相加 (psy, ppsy))
492.定位写出 (170, 相加 (pss, ppss))
546.定位写出 (170, 相加 (psx, ppsx))
600.定位写出 (170, 相加 (pjh, ppjh))
654.定位写出 (170, 相加 (pqt, ppqt))
708.定位写出 (170, 相加 (phj, pphj))


.子程序 t5, 空白型, , 
打开 (相加 (“m”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))), , , , , , )
置当前库 (相加 (“m”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “西药”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “检查”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “手术”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “中成”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “输氧”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “治疗”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “化验”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “其它”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “中草”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “放射”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “输血”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “住院”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “冷暖”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “接生”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “婴儿”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “医疗”)))
赋值 (求和 (读 (“hj”), 等于 (读 (“lb”), “监护”)))
赋值 (求和 (读 (“hj”), ))
60.定位写出 (170, 相加 (ps, pzc))
114.定位写出 (170, pzy)
168.定位写出 (170, pzhy)
222.定位写出 (170, pzl)
276.定位写出 (170, phy)
330.定位写出 (170, pj)
384.定位写出 (170, pfs)
438.定位写出 (170, psy)
492.定位写出 (170, pss)
546.定位写出 (170, psx)
600.定位写出 (170, pjh)
654.定位写出 (170, pqt)
708.定位写出 (170, phj)



.子程序 t6, 空白型, , 
打开 (相加 (“bz”, 到文本 (取年份 (.今天))), , , , , , )
置当前库 (相加 (“bz”, 到文本 (取年份 (.今天))))
赋值 (求和 (读 (“ps”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pj”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pss”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pzc”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“psy”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pzl”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“phy”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pqt”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pzy”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pfs”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“psx”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pzhy”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pln”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pjs”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pye”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pyl”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“pjh”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))
赋值 (求和 (读 (“phj”), 等于 (取月份 (读 (“shj”)), 取月份 (.今天))))

60.定位写出 (170, 相加 (pps, ppzc))
114.定位写出 (170, ppzy)
168.定位写出 (170, ppzhy)
222.定位写出 (170, ppzl)
276.定位写出 (170, pphy)
330.定位写出 (170, ppj)
384.定位写出 (170, ppfs)
438.定位写出 (170, ppsy)
492.定位写出 (170, ppss)
546.定位写出 (170, ppsx)
600.定位写出 (170, ppjh)
654.定位写出 (170, ppqt)
708.定位写出 (170, pphj)



.子程序 _按钮4_被单击, 空白型, , 
.清除 ()
.判断开始 (并且 (文件是否存在 (相加 (“bm”, 到文本 (取年份 (.今天)), “.edb”)), 文件是否存在 (相加 (“bz”, 到文本 (取年份 (.今天)), “.edb”))))
    i1 ()
    i2 ()
    i3 ()
    i4 ()
.判断 (并且 (等于 (文件是否存在 (相加 (“bm”, 到文本 (取年份 (.今天)), “.edb”)), 假), 等于 (文件是否存在 (相加 (“bz”, 到文本 (取年份 (.今天)), “.edb”)), 假)))
    i1 ()
.判断 (并且 (等于 (文件是否存在 (相加 (“bm”, 到文本 (取年份 (.今天)), “.edb”)), 真), 等于 (文件是否存在 (相加 (“bz”, 到文本 (取年份 (.今天)), “.edb”)), 假)))
    i1 ()
    i2 ()
    i5 ()
.判断 (并且 (等于 (文件是否存在 (相加 (“bm”, 到文本 (取年份 (.今天)), “.edb”)), 假), 等于 (文件是否存在 (相加 (“bz”, 到文本 (取年份 (.今天)), “.edb”)), 真)))
    i1 ()
    i3 ()
    i6 ()
.默认
    
.判断结束


.子程序 i1, 空白型, , 
.局部变量 x, 空白型, , , 
.局部变量 y, 空白型, , , 

赋值 (.字体.字体大小, 16)
300.定位写出 (10, “康复中心业务月报表”)
赋值 (.字体.字体大小, 13)
20.定位写出 (40, 相加 (“康复门诊                               ”, 到文本 (取年份 (.今天)), “年                         单位：元”))
赋值 (.字体.字体大小, 12)
11.定位写出 (74, “       西成    草药   床位  治疗   化验  功能   放射  吸氧   手术   输血   监护  其他   合计”)
11.定位写出 (104, “门诊”)
11.定位写出 (164, “合计”)
11.定位写出 (134, “住院”)
赋值 (5)
.计次循环首 (15, y)
    .画直线 (70, , 190)
    赋值 (x, 相加 (x, 54))
.计次循环尾 ()
赋值 (x, 70)
.计次循环首 (5, y)
    5.画直线 (x, 761, x)
    赋值 (x, 相加 (x, 30))
.计次循环尾 ()
赋值 (.字体.字体大小, 8)


.子程序 i2, 空白型, , 
打开 (相加 (“bm”, 到文本 (取年份 (.今天))), , , , , , )
置当前库 (相加 (“bm”, 到文本 (取年份 (.今天))))
赋值 (求和 (读 (“ps”), ))
赋值 (求和 (读 (“pj”), ))
赋值 (求和 (读 (“pss”), ))
赋值 (求和 (读 (“pzc”), ))
赋值 (求和 (读 (“psy”), ))
赋值 (求和 (读 (“pzl”), ))
赋值 (求和 (读 (“phy”), ))
赋值 (求和 (读 (“pqt”), ))
赋值 (求和 (读 (“pzy”), ))
赋值 (求和 (读 (“pfs”), ))
赋值 (求和 (读 (“psx”), ))
赋值 (求和 (读 (“pzhy”), ))
赋值 (求和 (读 (“pln”), ))
赋值 (求和 (读 (“pjs”), ))
赋值 (求和 (读 (“pye”), ))
赋值 (求和 (读 (“pyl”), ))
赋值 (求和 (读 (“pjh”), ))
赋值 (求和 (读 (“phj”), ))
60.定位写出 (110, 相加 (ps, pzc))
114.定位写出 (110, pzy)
168.定位写出 (110, pzhy)
222.定位写出 (110, pzl)
276.定位写出 (110, phy)
330.定位写出 (110, pj)
384.定位写出 (110, pfs)
438.定位写出 (110, psy)
492.定位写出 (110, pss)
546.定位写出 (110, psx)
600.定位写出 (110, pjh)
654.定位写出 (110, pqt)
708.定位写出 (110, phj)



.子程序 i3, 空白型, , 
打开 (相加 (“bz”, 到文本 (取年份 (.今天))), , , , , , )
置当前库 (相加 (“bz”, 到文本 (取年份 (.今天))))
赋值 (求和 (读 (“ps”), ))
赋值 (求和 (读 (“pj”), ))
赋值 (求和 (读 (“pss”), ))
赋值 (求和 (读 (“pzc”), ))
赋值 (求和 (读 (“psy”), ))
赋值 (求和 (读 (“pzl”), ))
赋值 (求和 (读 (“phy”), ))
赋值 (求和 (读 (“pqt”), ))
赋值 (求和 (读 (“pzy”), ))
赋值 (求和 (读 (“pfs”), ))
赋值 (求和 (读 (“psx”), ))
赋值 (求和 (读 (“pzhy”), ))
赋值 (求和 (读 (“pln”), ))
赋值 (求和 (读 (“pjs”), ))
赋值 (求和 (读 (“pye”), ))
赋值 (求和 (读 (“pyl”), ))
赋值 (求和 (读 (“pjh”), ))
赋值 (求和 (读 (“phj”), ))
60.定位写出 (140, 相加 (pps, ppzc))
114.定位写出 (140, ppzy)
168.定位写出 (140, ppzhy)
222.定位写出 (140, ppzl)
276.定位写出 (140, pphy)
330.定位写出 (140, ppj)
384.定位写出 (140, ppfs)
438.定位写出 (140, ppsy)
492.定位写出 (140, ppss)
546.定位写出 (140, ppsx)
600.定位写出 (140, ppjh)
654.定位写出 (140, ppqt)
708.定位写出 (140, pphj)



.子程序 i4, 空白型, , 
60.定位写出 (170, 相加 (pps, ppzc, ps, pzc))
114.定位写出 (170, 相加 (pzy, ppzy))
168.定位写出 (170, 相加 (pzhy, ppzhy))
222.定位写出 (170, 相加 (pzl, ppzl))
276.定位写出 (170, 相加 (phy, pphy))
330.定位写出 (170, 相加 (pj, ppj))
384.定位写出 (170, 相加 (pfs, ppfs))
438.定位写出 (170, 相加 (psy, ppsy))
492.定位写出 (170, 相加 (pss, ppss))
546.定位写出 (170, 相加 (psx, ppsx))
600.定位写出 (170, 相加 (pjh, ppjh))
654.定位写出 (170, 相加 (pqt, ppqt))
708.定位写出 (170, 相加 (phj, pphj))


.子程序 i5, 空白型, , 
打开 (相加 (“bm”, 到文本 (取年份 (.今天))), , , , , , )
置当前库 (相加 (“bm”, 到文本 (取年份 (.今天))))
赋值 (求和 (读 (“ps”), ))
赋值 (求和 (读 (“pj”), ))
赋值 (求和 (读 (“pss”), ))
赋值 (求和 (读 (“pzc”), ))
赋值 (求和 (读 (“psy”), ))
赋值 (求和 (读 (“pzl”), ))
赋值 (求和 (读 (“phy”), ))
赋值 (求和 (读 (“pqt”), ))
赋值 (求和 (读 (“pzy”), ))
赋值 (求和 (读 (“pfs”), ))
赋值 (求和 (读 (“psx”), ))
赋值 (求和 (读 (“pzhy”), ))
赋值 (求和 (读 (“pln”), ))
赋值 (求和 (读 (“pjs”), ))
赋值 (求和 (读 (“pye”), ))
赋值 (求和 (读 (“pyl”), ))
赋值 (求和 (读 (“pjh”), ))
赋值 (求和 (读 (“phj”), ))
60.定位写出 (170, 相加 (ps, pzc))
114.定位写出 (170, pzy)
168.定位写出 (170, pzhy)
222.定位写出 (170, pzl)
276.定位写出 (170, phy)
330.定位写出 (170, pj)
384.定位写出 (170, pfs)
438.定位写出 (170, psy)
492.定位写出 (170, pss)
546.定位写出 (170, psx)
600.定位写出 (170, pjh)
654.定位写出 (170, pqt)
708.定位写出 (170, phj)


.子程序 i6, 空白型, , 
打开 (相加 (“bz”, 到文本 (取年份 (.今天))), , , , , , )
置当前库 (相加 (“bz”, 到文本 (取年份 (.今天))))
赋值 (求和 (读 (“ps”), ))
赋值 (求和 (读 (“pj”), ))
赋值 (求和 (读 (“pss”), ))
赋值 (求和 (读 (“pzc”), ))
赋值 (求和 (读 (“psy”), ))
赋值 (求和 (读 (“pzl”), ))
赋值 (求和 (读 (“phy”), ))
赋值 (求和 (读 (“pqt”), ))
赋值 (求和 (读 (“pzy”), ))
赋值 (求和 (读 (“pfs”), ))
赋值 (求和 (读 (“psx”), ))
赋值 (求和 (读 (“pzhy”), ))
赋值 (求和 (读 (“pln”), ))
赋值 (求和 (读 (“pjs”), ))
赋值 (求和 (读 (“pye”), ))
赋值 (求和 (读 (“pyl”), ))
赋值 (求和 (读 (“pjh”), ))
赋值 (求和 (读 (“phj”), ))

60.定位写出 (170, 相加 (pps, ppzc))
114.定位写出 (170, ppzy)
168.定位写出 (170, ppzhy)
222.定位写出 (170, ppzl)
276.定位写出 (170, pphy)
330.定位写出 (170, ppj)
384.定位写出 (170, ppfs)
438.定位写出 (170, ppsy)
492.定位写出 (170, ppss)
546.定位写出 (170, ppsx)
600.定位写出 (170, ppjh)
654.定位写出 (170, ppqt)
708.定位写出 (170, pphj)



.子程序 _按钮8_被单击, 空白型, , 

.清除 ()
.判断开始 (并且 (文件是否存在 (相加 (“m”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ())), “.edb”)), 文件是否存在 (相加 (“n”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ())), “.edb”))))
    o1 ()
    o2 ()
    o3 ()
    o4 ()
.判断 (并且 (等于 (文件是否存在 (相加 (“m”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ())), “.edb”)), 假), 等于 (文件是否存在 (相加 (“n”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ())), “.edb”)), 假)))
    o1 ()
.判断 (并且 (等于 (文件是否存在 (相加 (“m”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ())), “.edb”)), 真), 等于 (文件是否存在 (相加 (“n”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ())), “.edb”)), 假)))
    o1 ()
    o2 ()
    o5 ()
    
.判断 (并且 (等于 (文件是否存在 (相加 (“m”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ())), “.edb”)), 真), 等于 (文件是否存在 (相加 (“n”, 到文本 (取年份 (取现行时间 ())), 到文本 (取月份 (取现行时间 ())), “.edb”)), 假)))
    o1 ()
    o3 ()
    o6 ()
    
.默认
    
.判断结束


.子程序 o1, 空白型, , 
.局部变量 x, 空白型, , , 
.局部变量 y, 空白型, , , 

赋值 (.字体.字体大小, 16)
290.定位写出 (5, “康复中心业务月报表(内部)”)
赋值 (.字体.字体大小, 13)
20.定位写出 (25, 相加 (“康复门诊                               ”, 到文本 (取年份 (.今天)), “年”, 到文本 (取月份 (.今天)), “月                    单位：元”))
赋值 (.字体.字体大小, 12)
11.定位写出 (54, “  项 目     杨成书     李兰秋    张会彬     杨  晶     周日和    王晓云   王  伟     合  计”)
11.定位写出 (79, “  门 诊”)
11.定位写出 (129, “  合 计”)
11.定位写出 (104, “  住 院”)
11.定位写出 (154, “特色门诊”)
11.定位写出 (179, “特色住院”)
11.定位写出 (204, “特色合计”)
11.定位写出 (229, “  总  计”)
赋值 (5)
.计次循环首 (10, y)
    x.画直线 (50, x, 250)
    赋值 (x, 相加 (x, 84))
.计次循环尾 ()
赋值 (x, 50)
.计次循环首 (9, y)
    5.画直线 (x, 761, x)
    赋值 (x, 相加 (x, 25))
.计次循环尾 ()
赋值 (.字体.字体大小, 8)



.子程序 o2, 空白型, , 
打开 (相加 (“m”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))), , , , , , )
置当前库 (相加 (“m”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))))
赋值 (n1, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “01”)))
赋值 (n2, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “02”)))
赋值 (n3, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “03”)))
赋值 (n4, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “04”)))
赋值 (n5, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “05”)))
赋值 (n6, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “06”)))
赋值 (n7, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “07”)))
赋值 (n8, 相加 (n1, n2, n3, n4, n5, n6, n7))
赋值 (r1, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “11”)))
赋值 (r2, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “12”)))
赋值 (r3, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “13”)))
赋值 (r4, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “14”)))
赋值 (r5, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “15”)))
赋值 (r6, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “16”)))
赋值 (r7, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “17”)))
赋值 (r8, 相加 (r1, r2, r3, r4, r5, r6, r7))

90.定位写出 (79, n1)
174.定位写出 (79, n2)
258.定位写出 (79, n3)
342.定位写出 (79, n4)
426.定位写出 (79, n5)
510.定位写出 (79, n6)
594.定位写出 (79, n7)
678.定位写出 (79, n8)

90.定位写出 (154, r1)
174.定位写出 (154, r2)
258.定位写出 (154, r3)
342.定位写出 (154, r4)
426.定位写出 (154, r5)
510.定位写出 (154, r6)
594.定位写出 (154, r7)
678.定位写出 (154, r8)


.子程序 o3, 空白型, , 
打开 (相加 (“n”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))), , , , , , )
置当前库 (相加 (“n”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))))
赋值 (g1, 求和 (读 (“c1”), ))
赋值 (g2, 求和 (读 (“c2”), ))
赋值 (g3, 求和 (读 (“c3”), ))
赋值 (g4, 求和 (读 (“c4”), ))
赋值 (g5, 求和 (读 (“c5”), ))
赋值 (g6, 求和 (读 (“c6”), ))
赋值 (g7, 求和 (读 (“c7”), ))
赋值 (g8, 求和 (读 (“c8”), ))
赋值 (g9, 求和 (读 (“c9”), ))
赋值 (g10, 求和 (读 (“c10”), ))
赋值 (g11, 求和 (读 (“c11”), ))
赋值 (g12, 求和 (读 (“c12”), ))
赋值 (g13, 求和 (读 (“c13”), ))
赋值 (g14, 求和 (读 (“c14”), ))
赋值 (g15, 求和 (读 (“c15”), ))
赋值 (g16, 求和 (读 (“c16”), ))

90.定位写出 (104, g1)
174.定位写出 (104, g2)
258.定位写出 (104, g3)
342.定位写出 (104, g4)
426.定位写出 (104, g5)
510.定位写出 (104, g6)
594.定位写出 (104, g7)
678.定位写出 (104, g8)
90.定位写出 (179, g9)
174.定位写出 (179, g10)
258.定位写出 (179, g11)
342.定位写出 (179, g12)
426.定位写出 (179, g13)
510.定位写出 (179, g14)
594.定位写出 (179, g15)
678.定位写出 (179, g16)


.子程序 o4, 空白型, , 
90.定位写出 (129, 相加 (g1, n1))
174.定位写出 (129, 相加 (g2, n2))
258.定位写出 (129, 相加 (g3, n3))
342.定位写出 (129, 相加 (g4, n4))
426.定位写出 (129, 相加 (g5, n5))
510.定位写出 (129, 相加 (g6, n6))
594.定位写出 (129, 相加 (g7, n7))
678.定位写出 (129, 相加 (g8, n8))
90.定位写出 (204, 相加 (r1, g9))
174.定位写出 (204, 相加 (g10, r2))
258.定位写出 (204, 相加 (g11, r3))
342.定位写出 (204, 相加 (g12, r4))
426.定位写出 (204, 相加 (g13, r5))
510.定位写出 (204, 相加 (g14, r6))
594.定位写出 (204, 相加 (g15, r7))
678.定位写出 (204, 相加 (g16, r8))
90.定位写出 (229, 相加 (g1, n1, g9, r1))
174.定位写出 (229, 相加 (g2, n2, g10, r2))
258.定位写出 (229, 相加 (g3, n3, g11, r3))
342.定位写出 (229, 相加 (g4, n4, g12, r4))
426.定位写出 (229, 相加 (g5, n5, g13, r5))
510.定位写出 (229, 相加 (g6, n6, g14, r6))
594.定位写出 (229, 相加 (g7, n7, g15, r7))
678.定位写出 (229, 相加 (g8, n8, g16, r8))



.子程序 o5, 空白型, , 
打开 (相加 (“m”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))), , , , , , )
置当前库 (相加 (“m”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))))
赋值 (n1, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “01”)))
赋值 (n2, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “02”)))
赋值 (n3, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “03”)))
赋值 (n4, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “04”)))
赋值 (n5, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “05”)))
赋值 (n6, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “06”)))
赋值 (n7, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “07”)))
赋值 (n8, 相加 (n1, n2, n3, n4, n5, n6, n7))
赋值 (r1, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “11”)))
赋值 (r2, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “12”)))
赋值 (r3, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “13”)))
赋值 (r4, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “14”)))
赋值 (r5, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “15”)))
赋值 (r6, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “16”)))
赋值 (r7, 求和 (读 (“hj”), 等于 (取文本左边 (读 (“cf”), 2), “17”)))
赋值 (r8, 相加 (r1, r2, r3, r4, r5, r6, r7))
90.定位写出 (129, n1)
174.定位写出 (129, n2)
258.定位写出 (129, n3)
342.定位写出 (129, n4)
426.定位写出 (129, n5)
510.定位写出 (129, n6)
594.定位写出 (129, n7)
678.定位写出 (129, n8)

90.定位写出 (204, r1)
174.定位写出 (204, r2)
258.定位写出 (204, r3)
342.定位写出 (204, r4)
426.定位写出 (204, r5)
510.定位写出 (204, r6)
594.定位写出 (204, r7)
678.定位写出 (204, r8)

90.定位写出 (229, 相加 (n1, r1))
174.定位写出 (229, 相加 (n2, r2))
258.定位写出 (229, 相加 (n3, r3))
342.定位写出 (229, 相加 (n4, r4))
426.定位写出 (229, 相加 (n5, r5))
510.定位写出 (229, 相加 (n6, r6))
594.定位写出 (229, 相加 (n7, r7))
678.定位写出 (229, 相加 (n8, r8))



.子程序 o6, 空白型, , 
打开 (相加 (“n”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))), , , , , , )
置当前库 (相加 (“n”, 到文本 (取年份 (.今天)), 到文本 (取月份 (.今天))))
赋值 (g1, 求和 (读 (“c1”), ))
赋值 (g2, 求和 (读 (“c2”), ))
赋值 (g3, 求和 (读 (“c3”), ))
赋值 (g4, 求和 (读 (“c4”), ))
赋值 (g5, 求和 (读 (“c5”), ))
赋值 (g6, 求和 (读 (“c6”), ))
赋值 (g7, 求和 (读 (“c7”), ))
赋值 (g8, 求和 (读 (“c8”), ))
赋值 (g9, 求和 (读 (“c9”), ))
赋值 (g10, 求和 (读 (“c10”), ))
赋值 (g11, 求和 (读 (“c11”), ))
赋值 (g12, 求和 (读 (“c12”), ))
赋值 (g13, 求和 (读 (“c13”), ))
赋值 (g14, 求和 (读 (“c14”), ))
赋值 (g15, 求和 (读 (“c15”), ))
赋值 (g16, 求和 (读 (“c16”), ))

90.定位写出 (129, g1)
174.定位写出 (129, g2)
258.定位写出 (129, g3)
342.定位写出 (129, g4)
426.定位写出 (129, g5)
510.定位写出 (129, g6)
594.定位写出 (129, g7)
678.定位写出 (129, g8)
90.定位写出 (204, g9)
174.定位写出 (204, g10)
258.定位写出 (204, g11)
342.定位写出 (204, g12)
426.定位写出 (204, g13)
510.定位写出 (204, g14)
594.定位写出 (204, g15)
678.定位写出 (204, g16)
90.定位写出 (229, 相加 (g1, g9))
174.定位写出 (229, 相加 (g2, g10))
258.定位写出 (229, 相加 (g3, g11))
342.定位写出 (229, 相加 (g4, g12))
426.定位写出 (229, 相加 (g5, g13))
510.定位写出 (229, 相加 (g6, g14))
594.定位写出 (229, 相加 (g7, g15))
678.定位写出 (229, 相加 (g8, g16))



 ' 不属于任何一个程序集、类模块的函数：
