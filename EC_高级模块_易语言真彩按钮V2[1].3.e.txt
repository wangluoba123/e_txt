 ' 文件类型：Windows模块源码

 ' 程序名称：EC_高级模块_易海求经真彩按钮
 ' 程序描述：EC_高级模块_易海求经彩按钮
@备注:
【易语言真彩按钮】终结易语言不支持PNG格式按钮的历史！
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：2.33
 ' 创建号：2.12





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 2 0 扩展界面支持库二




数据类型 类型_真彩按钮, , 此数据类型为内部使用。
    .成员 动画框组件, 未知类型0x20008, , , 
    .成员 动画物体组件, 未知类型0x20009, , , 
    .成员 正常图片, 字节集, , , 
    .成员 点燃图片, 字节集, , , 
    .成员 按下图片, 字节集, , , 
    .成员 选中图片, 字节集, , , 
    .成员 禁止图片, 字节集, , , 
    .成员 按钮被单击事件, 子程序指针, , , 
    .成员 左键被按下事件, 子程序指针, , , 
    .成员 左键被放开事件, 子程序指针, , , 
    .成员 右键被按下事件, 子程序指针, , , 
    .成员 右键被放开事件, 子程序指针, , , 

数据类型 真彩按钮, 公开, 
    .成员 正常图片, 字节集, , , 本属性指定在正常情况下所显示的图片；
    .成员 点燃图片, 字节集, , , 本属性指定在点燃情况下所显示的图片；
    .成员 按下图片, 字节集, , , 本属性指定在按下情况下所显示的图片；
    .成员 选中图片, 字节集, , , 本属性指定在选中情况下所显示的图片；
    .成员 禁止图片, 字节集, , , 本属性指定在禁止情况下所显示的图片；


.DLL命令 API_置当前控件的父窗口, 整数型, "user32.dll", "SetParent", , 为指定控件重新设置父窗口
    .参数 参数_子窗口句柄, 整数型, , 需要认父的组件或窗口
    .参数 参数_父窗口句柄, 整数型, , 把这个组件或窗口当作新的父窗口

.DLL命令 API_取当前控件的父窗口, 整数型, "user32.dll", "GetParent", , 判断指定窗口的父窗口
    .参数 控件句柄, 整数型, , 

.程序集 EC_高级模块_易语言真彩按钮, , , 【易语言真彩按钮】终结易语言不支持PNG格式按钮的历史！ 易友：Life 卖烧烤  2009-12-18

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码
 ' 输出调试文本 (“=====================================================================================================”)
 ' 输出调试文本 (“=   【易语言真彩按钮】终结易语言不支持PNG格式按钮的历史！                                           =”)
 ' 输出调试文本 (“=====================================================================================================”)
 ' 输出调试文本 (“=   本来是想图省事用VB的控件，请他帮忙修改一个VB的PNG按钮控件，结果他给写了个动画框模拟按钮的例程。 =”)
 ' 输出调试文本 (“=   既然已经有了基础代码，要做就做最好，不能对不起人家的心意和劳动成果啊！于是就又花了几个小时的时  =”)
 ' 输出调试文本 (“=   间，完善了这个模块，现在不仅调用要方便，而且加入了容错代码和支持可视化设计，安全、可靠、高效！  =”)
 ' 输出调试文本 (“=                                                                                                   =”)
 ' 输出调试文本 (“=   如果需要源码的话，直接搜索[life]的帖子就好了，相信在改代码的过程，你也能学习到很多有用的东西。  =”)
 ' 输出调试文本 (“=====================================================================================================”)
 ' 输出调试文本 (“                                                                       易海求经学高手而编译的   ”)
 ' 输出调试文本 (“=====================================================================================================”)

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。


.子程序 汇编_调用子程序, 逻辑型, , 
.参数 子程序指针或子程序地址, 子程序指针, , 
.参数 是否为C调用, 逻辑型, 可空, 
.参数 返回值, 空白型, 参考 可空, 
.参数 参数1, 空白型, 参考 可空, 
.参数 参数2, 空白型, 参考 可空, 
.参数 参数3, 空白型, 参考 可空, 
.参数 参数4, 空白型, 参考 可空, 
.参数 参数5, 空白型, 参考 可空, 
.参数 参数6, 空白型, 参考 可空, 
.参数 参数7, 空白型, 参考 可空, 
.参数 参数8, 空白型, 参考 可空, 
.参数 参数9, 空白型, 参考 可空, 
.参数 参数10, 空白型, 参考 可空, 
.参数 参数11, 空白型, 参考 可空, 
.参数 参数12, 空白型, 参考 可空, 
.参数 参数13, 空白型, 参考 可空, 
.参数 参数14, 空白型, 参考 可空, 
.参数 参数15, 空白型, 参考 可空, 

.局部变量 inc, 整数型, , , 

赋值 (inc, 0)
置入代码 ({ 86, 81, 185, 15, 0, 0, 0, 139, 245, 129, 198, 152, 0, 0, 0, 131, 238, 8, 139, 198, 139, 0, 131, 248, 0, 116, 18, 139, 70, 252, 139, 0, 80, 255, 69, 252, 255, 69, 252, 255, 69, 252, 255, 69, 252, 226, 224, 255, 85, 8, 139, 77, 20, 137, 1, 131, 125, 12, 0, 116, 3, 3, 101, 252, 89, 94 })
返回 (真)

.类模块 易语言真彩按钮, , , 【易语言真彩按钮】终结易语言不支持PNG格式按钮的历史！ 易友：Life 卖烧烤  2009-12-18

.程序集变量 集_原始动画框, 未知类型0x20008, , , 
.程序集变量 集_原始动画物体, 未知类型0x20009, , , 
.程序集变量 集_真彩按钮数组, 类型_真彩按钮, , "0", 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--


.子程序 初始化, 空白型, 公开, 本命令仅在创建真彩按钮前使用。
.参数 动画框组件, 未知类型0x20008, , 
.参数 动画物体组件, 未知类型0x20009, , 

 ' ======================================================================
赋值 (集_原始动画框, 动画框组件)
赋值 (集_原始动画物体, 动画物体组件)
 ' ======================================================================
赋值 (集_原始动画框., 0)
赋值 (集_原始动画物体., 真)
赋值 (集_原始动画物体., 假)
 ' 本源码来自易语言资源网(www.5A5X.com)
连续赋值 (0, 集_原始动画物体., 集_原始动画物体.)

.子程序 创建按钮, 逻辑型, 公开, 返回是否创建成功。注意事项：创建按钮前，请确保当前窗口已被显示，否则将导致按钮背景显示错误！
.参数 参数_参考按钮, 按钮, , 本属性类型为“按钮”，该按钮必须是真实存在的，否则将导致创建失败
.参数 参数_真彩按钮, 真彩按钮, , 本属性类型为“真彩按钮”，用做指定需要创建的真彩按钮各个状态下的图片
.参数 参数_按钮被单击事件, 子程序指针, 可空, 本属性指定在真彩按钮被关联的[被单击事件]
.参数 参数_左键被按下事件, 子程序指针, 可空, 本属性指定在真彩按钮被关联的[左键被按下事件]
.参数 参数_左键被放开事件, 子程序指针, 可空, 本属性指定在真彩按钮被关联的[左键被放开事件]
.参数 参数_右键被按下事件, 子程序指针, 可空, 本属性指定在真彩按钮被关联的[右键被按下事件]
.参数 参数_右键被放开事件, 子程序指针, 可空, 本属性指定在真彩按钮被关联的[右键被放开事件]

.局部变量 部_物体标识, 整数型, , , 
.局部变量 部_新成员总数, 整数型, , , 

 ' ===========================================================================
 ' 1、判断参考按钮是否已被创建，如果未创建则返回假；
 ' ===========================================================================
.如果真 (等于 (是否已创建 (参数_参考按钮), 假))
    返回 (假)
.如果真结束
.如果真 (等于 (参数_参考按钮.可视, 真))
    赋值 (参数_参考按钮.可视, 假) ' 立即将其可视置为假。
    处理事件 ()
.如果真结束
 ' ===========================================================================
 ' 2、重新赋值[部_新成员总数]，并定义各个控件的数组成员总数；
 ' ===========================================================================
赋值 (部_新成员总数, 相加 (取数组成员数 (集_真彩按钮数组), 1)) ' 根据已有的动画框数组成员数重新赋值所有的数组。
重定义数组 (集_真彩按钮数组, 真, 部_新成员总数)
 ' ===========================================================================
 ' 3、复制窗口组件，并将其赋值给新加入的控件成员，如复制失败则跳转到返回代码；
 ' ===========================================================================
.如果真 (并且 (等于 (复制窗口组件 (集_原始动画框, 集_真彩按钮数组 [部_新成员总数], 动画框组件), 真), 等于 (复制窗口组件 (集_原始动画物体, 集_真彩按钮数组 [部_新成员总数], 动画物体组件), 真)))
    API_置当前控件的父窗口 (集_真彩按钮数组.取窗口句柄 ( [部_新成员总数], 动画框组件), API_取当前控件的父窗口 (参数_参考按钮.取窗口句柄 ()))
     ' =======================================================================
     ' 4、创建一个新的动画物体，如果创建失败，则跳转到返回代码；
     ' =======================================================================
    赋值 (部_物体标识, 集_真彩按钮数组.未知支持库函数_35 ( [部_新成员总数], 动画框组件, 集_真彩按钮数组 [部_新成员总数], 动画物体组件, 0, 0, 假, ))
     ' 本源码来自易语言资源网(www.5A5X.com)
     ' =======================================================================
    .如果真 (不等于 (部_物体标识, -1))
         ' ===================================================================
         ' 5、设置当前新加入的控件成员尺寸，并移动到指定坐标位置；
         ' ===================================================================
        赋值 (集_真彩按钮数组 [部_新成员总数], 动画框组件., 到文本 (部_新成员总数))
        连续赋值 (参数_参考按钮.左边, 集_真彩按钮数组 [部_新成员总数], 动画框组件., 集_真彩按钮数组 [部_新成员总数], 动画物体组件.)
        连续赋值 (参数_参考按钮.顶边, 集_真彩按钮数组 [部_新成员总数], 动画框组件., 集_真彩按钮数组 [部_新成员总数], 动画物体组件.)
        连续赋值 (参数_参考按钮.宽度, 集_真彩按钮数组 [部_新成员总数], 动画框组件., 集_真彩按钮数组 [部_新成员总数], 动画物体组件.)
        连续赋值 (参数_参考按钮.高度, 集_真彩按钮数组 [部_新成员总数], 动画框组件., 集_真彩按钮数组 [部_新成员总数], 动画物体组件.)
        
         ' 参数_参考按钮.销毁 (真)  ' 不能销毁按钮！
         ' ===================================================================
         ' 6、设置当前新加入的控件成员各个状态图片，以及鼠标事件；
         ' ===================================================================
        赋值 (集_真彩按钮数组 [部_新成员总数], 正常图片, 参数_真彩按钮.正常图片)
        赋值 (集_真彩按钮数组 [部_新成员总数], 点燃图片, 参数_真彩按钮.点燃图片)
        赋值 (集_真彩按钮数组 [部_新成员总数], 按下图片, 参数_真彩按钮.按下图片)
        赋值 (集_真彩按钮数组 [部_新成员总数], 选中图片, 参数_真彩按钮.选中图片)
        赋值 (集_真彩按钮数组 [部_新成员总数], 禁止图片, 参数_真彩按钮.禁止图片)
         ' 如果鼠标事件为空，则不予理会。
        .如果真 (等于 (是否为空 (参数_按钮被单击事件), 假))
            赋值 (集_真彩按钮数组 [部_新成员总数], 按钮被单击事件, 参数_按钮被单击事件)
        .如果真结束
        .如果真 (等于 (是否为空 (参数_左键被按下事件), 假))
            赋值 (集_真彩按钮数组 [部_新成员总数], 左键被按下事件, 参数_左键被按下事件)
        .如果真结束
        .如果真 (等于 (是否为空 (参数_左键被放开事件), 假))
            赋值 (集_真彩按钮数组 [部_新成员总数], 左键被放开事件, 参数_左键被放开事件)
        .如果真结束
        .如果真 (等于 (是否为空 (参数_右键被按下事件), 假))
            赋值 (集_真彩按钮数组 [部_新成员总数], 右键被按下事件, 参数_右键被按下事件)
             ' 本源码来自易语言资源网(www.5A5X.com)
        .如果真结束
        .如果真 (等于 (是否为空 (参数_右键被放开事件), 假))
            赋值 (集_真彩按钮数组 [部_新成员总数], 右键被放开事件, 参数_右键被放开事件)
        .如果真结束
         ' ===================================================================
         ' 7、设置当前新加入的控件成员背景图片和正常状态图片，并显示该控件；
         ' ===================================================================
        集_真彩按钮数组.未知支持库函数_44 ( [部_新成员总数], 动画框组件, 部_物体标识, 参数_真彩按钮.正常图片, )
        集_真彩按钮数组.未知支持库函数_52 ( [部_新成员总数], 动画框组件, 部_物体标识, 真)
        赋值 (集_真彩按钮数组 [部_新成员总数], 动画框组件., 真)
        赋值 (集_真彩按钮数组 [部_新成员总数], 动画框组件., 快照 (集_真彩按钮数组.取窗口句柄 ( [部_新成员总数], 动画框组件), , ))
         ' ===================================================================
         ' 8、全部操作完成，返回当前已创建完成的控件总数；
         ' ===================================================================
        返回 (真)
    .如果真结束
    
.如果真结束
 ' ===========================================================================
 ' 按钮创建失败，返回事件代码区：
 ' ===========================================================================
删除成员 (集_真彩按钮数组, 部_新成员总数, 1)
 ' ===========================================================================
返回 (假)

.子程序 拦截事件_动画框_进入物体_子程序, 空白型, 公开, 
.参数 参数_动画框组件, 未知类型0x20008, , 本组件必须由[取事件组件]命令在本事件触发后首选使用，否则将可能出现错误，详情请参考[取事件组件]命令说明。

.如果真 (等于 (集_真彩按钮数组 [到整数 (参数_动画框组件.)].点燃图片, {  })) ' 如果点燃图片为空，则使用正常图片，否则将背景图片设置为点燃图片；
    .如果真 (不等于 (参数_动画框组件., 集_真彩按钮数组 [到整数 (参数_动画框组件.)].正常图片)) ' 如果背景图片已经不是正常图片，则置为正常图片，否则直接返回。
        参数_动画框组件.未知支持库函数_44 (1, 集_真彩按钮数组 [到整数 (参数_动画框组件.)].正常图片, )
    .如果真结束
    返回 ()
.如果真结束
.如果真 (不等于 (参数_动画框组件., 集_真彩按钮数组 [到整数 (参数_动画框组件.)].点燃图片)) ' 如果当前背景图不是点燃图片，则使用点燃图片，否则直接跳过，以避免重复置背景图片引起的闪烁。
    参数_动画框组件.未知支持库函数_44 (1, 集_真彩按钮数组 [到整数 (参数_动画框组件.)].点燃图片, )
.如果真结束
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 拦截事件_动画框_离开物体_子程序, 空白型, 公开, 
.参数 参数_动画框组件, 未知类型0x20008, , 本组件必须由[取事件组件]命令在本事件触发后首选使用，否则将可能出现错误，详情请参考[取事件组件]命令说明。

参数_动画框组件.未知支持库函数_44 (1, 集_真彩按钮数组 [到整数 (参数_动画框组件.)].正常图片, )

.子程序 拦截事件_动画框_物体左键被按下_子程序, 空白型, 公开, 
.参数 参数_动画框组件, 未知类型0x20008, , 本组件必须由[取事件组件]命令在本事件触发后首选使用，否则将可能出现错误，详情请参考[取事件组件]命令说明。

.如果 (等于 (集_真彩按钮数组 [到整数 (参数_动画框组件.)].按下图片, {  })) ' 如果按下图片为空，则使用正常图片，否则将背景图片设置为按下图片；
    参数_动画框组件.未知支持库函数_44 (1, 集_真彩按钮数组 [到整数 (参数_动画框组件.)].正常图片, )
.否则
    参数_动画框组件.未知支持库函数_44 (1, 集_真彩按钮数组 [到整数 (参数_动画框组件.)].按下图片, )
.如果结束
 ' 本源码来自易语言资源网(www.5A5X.com)
.如果真 (不等于 (到整数 (集_真彩按钮数组 [到整数 (参数_动画框组件.)].左键被按下事件), 0))
    汇编_调用子程序 (集_真彩按钮数组 [到整数 (参数_动画框组件.)].左键被按下事件, 假, , 0, 0, 0)
.如果真结束


.子程序 拦截事件_动画框_物体左键被放开_子程序, 空白型, 公开, 
.参数 参数_动画框组件, 未知类型0x20008, , 本组件必须由[取事件组件]命令在本事件触发后首选使用，否则将可能出现错误，详情请参考[取事件组件]命令说明。

.如果 (等于 (集_真彩按钮数组 [到整数 (参数_动画框组件.)].点燃图片, {  })) ' 如果按下图片为空，则使用正常图片，否则将背景图片设置为按下图片；
    参数_动画框组件.未知支持库函数_44 (1, 集_真彩按钮数组 [到整数 (参数_动画框组件.)].正常图片, )
.否则
    参数_动画框组件.未知支持库函数_44 (1, 集_真彩按钮数组 [到整数 (参数_动画框组件.)].点燃图片, )
.如果结束
 ' 本源码来自易语言资源网(www.5A5X.com)
.如果真 (不等于 (到整数 (集_真彩按钮数组 [到整数 (参数_动画框组件.)].左键被放开事件), 0))
    汇编_调用子程序 (集_真彩按钮数组 [到整数 (参数_动画框组件.)].左键被放开事件, 假, , 0, 0, 0)
.如果真结束
.如果真 (不等于 (到整数 (集_真彩按钮数组 [到整数 (参数_动画框组件.)].按钮被单击事件), 0))
    汇编_调用子程序 (集_真彩按钮数组 [到整数 (参数_动画框组件.)].按钮被单击事件, 假, )
.如果真结束


.子程序 拦截事件_动画框_物体右键被按下_子程序, 空白型, , 已被屏蔽！
.参数 参数_动画框组件, 未知类型0x20008, , 本组件必须由[取事件组件]命令在本事件触发后首选使用，否则将可能出现错误，详情请参考[取事件组件]命令说明。

 ' .如果 (等于 (集_真彩按钮数组 [到整数 (参数_动画框组件.)].按下图片, {  })) ' 如果按下图片为空，则使用正常图片，否则将背景图片设置为按下图片；
     ' 参数_动画框组件.置图片 (1, 集_真彩按钮数组 [到整数 (参数_动画框组件.标记)].正常图片, )
.否则
     ' 参数_动画框组件.置图片 (1, 集_真彩按钮数组 [到整数 (参数_动画框组件.标记)].按下图片, )
.如果结束

 ' .如果真 (不等于 (到整数 (集_真彩按钮数组 [到整数 (参数_动画框组件.)].右键被按下事件), 0))
     ' 汇编_调用子程序 (集_真彩按钮数组 [到整数 (参数_动画框组件.标记)].右键被按下事件, 假, , 0, 0, 0)
.如果真结束


.子程序 拦截事件_动画框_物体右键被放开_子程序, 空白型, , 已被屏蔽！
.参数 参数_动画框组件, 未知类型0x20008, , 本组件必须由[取事件组件]命令在本事件触发后首选使用，否则将可能出现错误，详情请参考[取事件组件]命令说明。

 ' .如果 (等于 (集_真彩按钮数组 [到整数 (参数_动画框组件.)].点燃图片, {  })) ' 如果按下图片为空，则使用正常图片，否则将背景图片设置为按下图片；
     ' 参数_动画框组件.置图片 (1, 集_真彩按钮数组 [到整数 (参数_动画框组件.标记)].正常图片, )
.否则
     ' 参数_动画框组件.置图片 (1, 集_真彩按钮数组 [到整数 (参数_动画框组件.标记)].点燃图片, )
.如果结束

 ' .如果真 (不等于 (到整数 (集_真彩按钮数组 [到整数 (参数_动画框组件.)].右键被放开事件), 0))
     ' 汇编_调用子程序 (集_真彩按钮数组 [到整数 (参数_动画框组件.标记)].右键被放开事件, 假, , 0, 0, 0)
.如果真结束





 ' 不属于任何一个程序集、类模块的函数：
