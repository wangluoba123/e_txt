 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 703
    高度 = 426
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “用高级表格查看excel-MDB”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 2 0 高级表格支持库
 ' eDB 46E94341933A462383A4DE26B146322C 2 1 数据库操作支持库
 ' CnCalendar {18C0788E-59AE-4112-B452-6BF0C1B727FB} 2 0 农历日期支持库




数据类型 库名及索引, , 
    .成员 数据库名, 文本型, , , 
    .成员 索引, 整数型, , , 


.窗口程序集 窗口程序集1, , , 

.程序集变量 显示字段, 文本型, , , 
.程序集变量 数据库名保存数组, 库名及索引, , "0", 
.程序集变量 当前数据库, 文本型, , , 
.程序集变量 当前表名, 文本型, , , 
.程序集变量 记忆字段名, 文本型, , "0", 
.程序集变量 sql查询语句, 文本型, , , 
.程序集变量 匿名程序集变量_2515, 空白型, , , 
.程序集变量 整型变量, 整数型, , , 
.程序集变量 文本变量, 文本型, , , 
.程序集变量 日期变量, 日期时间型, , , 
.程序集变量 单精度变量, 小数型, , , 
.程序集变量 双精度变量, 双精度小数型, , , 
.程序集变量 逻辑变量, 逻辑型, , , 
.程序集变量 货币变量, 双精度小数型, , , 
.程序集变量 短整数变量, 短整数型, , , 
.程序集变量 字节集变量, 字节集, , , 
.程序集变量 匿名程序集变量_2877, 空白型, , , 
.程序集变量 字段总数, 整数型, , , 
.程序集变量 记录总数, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--


.子程序 _打开按钮_被单击, 空白型, , 
赋值 (.初始目录, 取运行目录 ())
赋值 (.过滤器, “(*.mdb)|*.mdb|(*.*)|*.*”)
.如果真 (打开 ())
    打开数据库 (.文件名)
.如果真结束


.子程序 打开数据库, 空白型, , 
.参数 参_文件名, 文本型, , 

.局部变量 数据库密码, 文本型, , , 
.局部变量 数据库版本, 文本型, , , 

.如果 (等于 (文件是否存在 (参_文件名), 真))
    .如果真 (不等于 (数据库密码, “”))
        信息框 (相加 (“本数据库有密码为：”, 数据库密码, “，已发送到剪辑板，请解密后再打开！”), 0, )
        置剪辑板文本 (数据库密码)
        返回 ()
    .如果真结束
    参_文件名.未知支持库函数_0 ()
    .如果真 (等于 (参_文件名.未知支持库函数_1 (“”), 假))
        信息框 (“打开数据库失败！”, 16, “提示”)
        结束 ()
    .如果真结束
    .如果真 (等于 (.未知支持库函数_12 (), 假))
        信息框 (“记录集连接失败！”, 16, “提示”)
    .如果真结束
    填充树型框 (参_文件名)
    赋值 (当前数据库, 参_文件名)
    0.置文本 (相加 (“ 当前数据库版本为：”, 数据库版本, “当前数据库密码为：”, 数据库密码))
     ' 本源码来自易语言资源网(www.5A5X.com)
.否则
    信息框 (“要打开的文件不存在！”, 0, )
.如果结束


.子程序 填充树型框, 空白型, , 
.参数 参_文件名, 文本型, , 

.局部变量 表名数组, 文本型, , "0", 
.局部变量 表总数, 整数型, , , 
.局部变量 计次变量, 整数型, , , 
.局部变量 当前父项目索引, 整数型, , , 
.局部变量 数据库名, 文本型, , , 
.局部变量 保存库名及索引, 库名及索引, , , 

取表名 (参_文件名, , 表名数组)
赋值 (表总数, 取数组成员数 (表名数组))
赋值 (数据库名, 取文本右边 (参_文件名, 相减 (取文本长度 (参_文件名), 倒找文本 (参_文件名, “\”, , 假))))
赋值 (当前父项目索引, -1.加入项目 (数据库名, 0, , , , ))
赋值 (保存库名及索引.索引, 当前父项目索引)
赋值 (保存库名及索引.数据库名, 参_文件名)
加入成员 (数据库名保存数组, 保存库名及索引)
.计次循环首 (表总数, 计次变量)
    当前父项目索引.加入项目 (表名数组 [计次变量], 1, , , , )
.计次循环尾 ()


.子程序 取表名, 逻辑型, 公开, 取得mdb的所有表名。
.参数 mdb数据库, 文本型, , 要取表名的access数据库
.参数 密码, 文本型, 可空, 
.参数 表名, 文本型, 参考 数组, 文本数组，存储返回的表名

.局部变量 ADODB连接, 对象, , , 
.局部变量 连接文本, 文本型, , , 
.局部变量 表名列记录集, 对象, , , 
.局部变量 对象型, 对象, , , 
.局部变量 变体型, 变体型, , , 
.局部变量 对象型1, 对象, , , 
.局部变量 数据库名, 文本型, , , 

清除数组 (表名)
赋值 (数据库名, 取文本右边 (mdb数据库, 相减 (取文本长度 (mdb数据库), 倒找文本 (mdb数据库, “”, , 假))))
.如果真 (ADODB连接.创建 (“ADODB.Connection”, ))
    .如果 (等于 (密码, “”))
        赋值 (连接文本, 相加 (“Provider=Microsoft.Jet.OLEDB.4.0;Data Source=”, mdb数据库, “;”))
    .否则
        赋值 (连接文本, 相加 (“Provider=Microsoft.Jet.OLEDB.4.0;Data Source=”, mdb数据库, “;Jet OLEDB:Database Password=”, 密码, “;”)) ' 后面是数据库路径
    .如果结束
    ADODB连接.写属性 (“connectionstring”, 连接文本)
    ADODB连接.方法 (“open”, )
    赋值 (对象型1, ADODB连接.读对象型属性 (“Errors”, ))
    .如果真 (等于 (对象型1.是否为空 (), 假))
        变体型.赋值 (0, )
        赋值 (对象型, 对象型1.读对象型属性 (“Item”, 变体型))
        .如果真 (等于 (对象型.是否为空 (), 假))
            返回 (假)
        .如果真结束
        
    .如果真结束
    赋值 (表名列记录集, ADODB连接.对象型方法 (“OpenSchema”, 20))
    .判断循环首 (等于 (表名列记录集.读逻辑属性 (“eof”, ), 假)) ' 循环取表名列表
        赋值 (对象型1, 表名列记录集.读对象型属性 (“Fields”, ))
        变体型.赋值 (“TABLE_TYPE”, ) ' 取表类型
        赋值 (对象型, 对象型1.读对象型属性 (“Item”, 变体型))
        赋值 (变体型, 对象型.读属性 (“Value”, ))
        .如果真 (等于 (变体型.取文本 (), “TABLE”))
            变体型.赋值 (“TABLE_NAME”, )
            赋值 (对象型, 对象型1.读对象型属性 (“Item”, 变体型))
            赋值 (变体型, 对象型.读属性 (“Value”, ))
            加入成员 (表名, 变体型.取文本 ())
        .如果真结束
        表名列记录集.方法 (“MoveNext”, )
    .判断循环尾 ()
.如果真结束
表名列记录集.方法 (“Close”, )
ADODB连接.方法 (“Close”, )
返回 (真)

.子程序 _树型框1_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

.局部变量 计次变量, 整数型, , , 

赋值 (.位置, 0)
赋值 (当前数据库, .取父项目 (.最大化按钮).取项目文本 ())
.如果真 (等于 (取文本右边 (.取父项目 (.最大化按钮).取项目文本 (), 3), “xls”))
    .如果真 (不等于 (.取父项目 (.最大化按钮), -1))
        赋值 (当前表名, .取项目文本 (.最大化按钮)) ' 为了换表时上面“显示字段”显示全部字段数据
        赋值 (sql查询语句, 相加 (“provider=microsoft.jet.oledb.4.0;extended properties='Excel 8.0;HDR=NO;IMEX=1;User id=admin;Password=;';data source=”, 当前数据库))
        .如果 (等于 (sql查询语句.未知支持库函数_0 (), 真))
            输出调试文本 (相加 (“链接成功！”, 当前数据库))
            .如果真 (等于 (.未知支持库函数_12 (), 假))
                返回 ()
            .如果真结束
            赋值 (sql查询语句, 相加 (“select * from [”, 当前表名, “]”))
            sql查询语句.未知支持库函数_14 (#)
        .否则
            输出调试文本 (“链接失败！”)
            输出调试文本 (相加 (“链接失败！”, 当前数据库))
        .如果结束
         ' 本源码来自易语言资源网(www.5A5X.com)
        .如果真 (不等于 (.取父项目 (.最大化按钮), -1))
            .计次循环首 (., 计次变量)
                .如果真 (并且 (不等于 (相减 (计次变量, 1).未知支持库函数_39 ().未知支持库函数_43 (), #), 不等于 (相减 (计次变量, 1).未知支持库函数_39 ().未知支持库函数_43 (), #)))
                .如果真结束
                加入成员 (记忆字段名, 相减 (计次变量, 1).未知支持库函数_39 ())
                 ' 加入成员 (字段名, 记录集1.取字段名 (计次变量 － 1))
            .计次循环尾 ()
        .如果真结束
        _高级表格按钮_导入_被单击 ()
    .如果真结束
    返回 ()
.如果真结束

当前数据库.未知支持库函数_1 (“”)
.未知支持库函数_12 ()
清除数组 (记忆字段名) ' 重新赋值数组，以免在高级表格中出现空白字段名
.如果真 (或者 (等于 (显示字段, “”), 不等于 (当前表名, .取项目文本 (.最大化按钮)))) ' 为选择列表框选择“显示字段”做准备
    赋值 (显示字段, “*”)
.如果真结束

.如果真 (不等于 (.取父项目 (.最大化按钮), -1))
    .取项目文本 (.最大化按钮).未知支持库函数_14 (#)
    未知支持库函数_34 ()
    赋值 (当前表名, .取项目文本 (.最大化按钮)) ' 为了换表时上面“显示字段”显示全部字段数据
    赋值 (sql查询语句, 相加 (“select ”, 显示字段, “ from [”, .取项目文本 (.最大化按钮), “]”))
    0.置文本 (相加 (“ 当前选择的是：”, .取项目文本 (.最大化按钮), “，共有”, 到文本 (.), “条记录！”))
    
    未知支持库函数_57 ()
    
    .变量循环首 (1, ., 1, 计次变量)
        .如果真 (并且 (不等于 (相减 (计次变量, 1).未知支持库函数_39 ().未知支持库函数_43 (), #), 不等于 (相减 (计次变量, 1).未知支持库函数_39 ().未知支持库函数_43 (), #)))
        .如果真结束
        加入成员 (记忆字段名, 相减 (计次变量, 1).未知支持库函数_39 ())
    .变量循环尾 ()
    读取Access数据到高级表格1 (当前数据库, , sql查询语句, )
.如果真结束


.子程序 _关闭_被选择, 空白型, , 
赋值 (_启动窗口., “ACCESS”)
清空 ()
未知支持库函数_57 ()
刷新显示 ()
未知支持库函数_16 ()
未知支持库函数_3 ()
清除数组 (数据库名保存数组)

.子程序 读取Access数据到高级表格1, 空白型, 公开, 
.参数 参_数据库文件, 文本型, , 
.参数 参_数据库密码, 文本型, 可空, 
.参数 参_SQL查询语句, 文本型, , 
.参数 参_高级表格, 未知类型0x30001, , 

.局部变量 i, 整数型, , , 
.局部变量 j, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 字段名1, 文本型, , , 

.如果真 (等于 (是否为空 (参_数据库密码), 真))
    赋值 (参_数据库密码, “”)
.如果真结束
赋值 (参_高级表格., 1)
赋值 (参_高级表格., 假)
.如果 (等于 (_启动窗口.未知支持库函数_1 (., 参_数据库文件, 参_数据库密码), 真)) ' (1) 连接到Access数据库
    .未知支持库函数_12 () ' (1)置记录集连接
    .如果 (等于 (参_SQL查询语句.未知支持库函数_14 (#), 真)) ' (3)打开记录集
        赋值 (参_高级表格., 取数组成员数 (记忆字段名))
        .计次循环首 (取数组成员数 (记忆字段名), i)
            参_高级表格.未知支持库函数_9 (0, 相减 (i, 1), #., 相减 (i, 1).未知支持库函数_39 ())
        .计次循环尾 ()
        赋值 (i, 1)
        赋值 (.最大位置, .)
        .判断循环首 (等于 (., 假))
            参_高级表格.未知支持库函数_38 ()
            参_高级表格.未知支持库函数_9 (i, 0, #., i)
            .计次循环首 (., j)
                赋值 (字段名, j.未知支持库函数_39 ())
                .判断开始 (等于 (字段名.未知支持库函数_43 (), #))
                    字段名.未知支持库函数_27 (双精度变量)
                    参_高级表格.未知支持库函数_9 (i, j, #., 到文本 (四舍五入 (到数值 (双精度变量), 2)))
                .判断 (等于 (字段名.未知支持库函数_43 (), #))
                    字段名.未知支持库函数_31 (日期变量)
                    参_高级表格.未知支持库函数_9 (i, j, #., 到文本 (未知支持库函数_12 (取日期 (到时间 (日期变量)), “%y-%m-%d”)))
                .判断 (等于 (字段名.未知支持库函数_43 (), #))
                    字段名.未知支持库函数_27 (双精度变量)
                    参_高级表格.未知支持库函数_9 (i, j, #., 到文本 (四舍五入 (到数值 (双精度变量), 2)))
                .判断 (等于 (字段名.未知支持库函数_43 (), #))
                    字段名.未知支持库函数_29 (整型变量)
                    参_高级表格.未知支持库函数_9 (i, j, #., 到文本 (整型变量))
                .判断 (等于 (字段名.未知支持库函数_43 (), #))
                    字段名.未知支持库函数_30 (逻辑变量)
                    参_高级表格.未知支持库函数_9 (i, j, #., 到文本 (逻辑变量))
                .判断 (等于 (字段名.未知支持库函数_43 (), #))
                    字段名.未知支持库函数_28 (单精度变量)
                    参_高级表格.未知支持库函数_9 (i, j, #., 到文本 (四舍五入 (到小数 (单精度变量), 2)))
                .判断 (等于 (字段名.未知支持库函数_43 (), #))
                    字段名.未知支持库函数_26 (文本变量)
                    参_高级表格.未知支持库函数_9 (i, j, #., 文本变量)
                .判断 (等于 (字段名.未知支持库函数_43 (), #))
                    字段名.未知支持库函数_29 (整型变量)
                    参_高级表格.未知支持库函数_9 (i, j, #., 整型变量)
                .判断 (等于 (字段名.未知支持库函数_43 (), #))
                    字段名.未知支持库函数_26 (文本变量)
                    参_高级表格.未知支持库函数_9 (i, j, #., 文本变量)
                .判断 (等于 (字段名.未知支持库函数_43 (), #))
                    字段名.未知支持库函数_50 (字节集变量)
                    参_高级表格.未知支持库函数_9 (i, j, #., 字节集变量)
                .默认
                    字段名.未知支持库函数_26 (文本变量)
                    参_高级表格.未知支持库函数_9 (i, j, #., 文本变量)
                .判断结束
                 ' 本源码来自易语言资源网(www.5A5X.com)
            .计次循环尾 ()
            赋值 (.位置, 相加 (.位置, 1))
            未知支持库函数_36 ()
            赋值 (i, 相加 (i, 1))
        .判断循环尾 ()
        赋值 (参_高级表格., 真)
        未知支持库函数_16 () ' 关闭当前记录集
    .否则
        
    .如果结束
     ' 数据库连接.关闭 ()  ' 断开连接
.否则
    信息框 (“连接到数据源失败。”, 相加 (16, 0), “提示”)
.如果结束


.子程序 _打开EXCEL按钮_被单击, 空白型, , 
.局部变量 表名数组, 文本型, , "0", 
.局部变量 i, 整数型, , , 
.局部变量 表总数, 整数型, , , 
.局部变量 数据库名, 文本型, , , 
.局部变量 当前父项目索引, 整数型, , , 
.局部变量 保存库名及索引, 库名及索引, , , 
.局部变量 计次变量, 整数型, , , 

赋值 (.初始目录, 取运行目录 ())
赋值 (.过滤器, “(*.xls)|*.xls|(*.*)|*.*”)
.如果真 (打开 ())
    赋值 (当前数据库, .文件名)
    取excel文档表名 (.文件名, 表名数组)
    .变量循环首 (1, 取数组成员数 (表名数组), 1, i)
        输出调试文本 (表名数组 [i])
    .变量循环尾 ()
.如果真结束
赋值 (表总数, 取数组成员数 (表名数组))
赋值 (数据库名, 取文本右边 (当前数据库, 相减 (取文本长度 (当前数据库), 倒找文本 (当前数据库, “\”, , 假))))
赋值 (当前父项目索引, -1.加入项目 (数据库名, 0, , , , ))
赋值 (保存库名及索引.索引, 当前父项目索引)
赋值 (保存库名及索引.数据库名, 当前数据库)
加入成员 (数据库名保存数组, 保存库名及索引)
.计次循环首 (表总数, 计次变量)
    当前父项目索引.加入项目 (表名数组 [计次变量], 1, , , , )
.计次循环尾 ()


.子程序 取excel文档表名, 空白型, , 
.参数 excel文件, 文本型, , 
.参数 表名数组, 文本型, 参考 数组, 

.局部变量 conn, 对象, , , 
.局部变量 rs, 对象, , , 
.局部变量 _表名, 文本型, , , 

清除数组 (表名数组)
conn.创建 (“ADODB.Connection”, )
rs.创建 (“ADODB.RecordSet”, )
conn.方法 (“open”, 相加 (“DBQ=”, excel文件, “;Driver={Microsoft Excel Driver (*.xls)};”))
赋值 (rs, conn.对象型方法 (“OpenSchema”, 20))
rs.方法 (“MoveFirst”, )
.判断循环首 (等于 (rs.读逻辑属性 (“EOF”, ), 假))
    赋值 (_表名, rs.对象型方法 (“Fields”, ).读对象型属性 (“Item”, “TABLE_NAME”).读文本属性 (“Value”, ))
     ' 输出调试文本 (_表名)
    加入成员 (表名数组, _表名)
    rs.方法 (“MoveNext”, )
.判断循环尾 ()
rs.方法 (“Close”, )
conn.方法 (“Close”, )
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _高级表格按钮_导入_被单击, 空白型, , 
.局部变量 字段计次, 整数型, , , 
.局部变量 记录计次, 整数型, , , 
.局部变量 匿名局部变量_2882, 空白型, , , 
.局部变量 临时文本, 文本型, , , 

赋值 (字段总数, .)
赋值 (记录总数, .)
赋值 (., 相加 (记录总数, 1))
赋值 (., 字段总数)
赋值 (.最大位置, 相加 (记录总数, 字段总数))
0.置文本 (相加 (“ 当前选择的是：”, .取项目文本 (.最大化按钮), “，共有”, 到文本 (记录总数), “条记录！”))
.计次循环首 (记录总数, 记录计次)
    处理事件 ()
    赋值 (字段计次, 0)
    .计次循环首 (字段总数, 字段计次)
        相减 (字段计次, 1).未知支持库函数_39 ().未知支持库函数_26 (临时文本)
        相减 (记录计次, 1).未知支持库函数_9 (相减 (字段计次, 1), #., 临时文本)
    .计次循环尾 ()
    赋值 (.位置, 相加 (.位置, 1))
    未知支持库函数_36 ()
.计次循环尾 ()




 ' 不属于任何一个程序集、类模块的函数：
