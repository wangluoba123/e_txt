 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 0 系统核心支持库




数据类型 窗口类, , 
    .成员 风格, 整数型, , , 窗口类的风格
    .成员 窗口函数, 子程序指针, , , 窗口函数的地址，本函数用来处理所有的消息
    .成员 类附加数据, 整数型, , , 附加数据，可以省略
    .成员 窗口附加数据, 整数型, , , 附加数据，可以省略
    .成员 模块句柄, 整数型, , , 本模块句柄
    .成员 图标句柄, 整数型, , , 窗口图标的句柄，给你的窗口设置一个图标
    .成员 鼠标句柄, 整数型, , , 窗口鼠标的句柄，给你的窗口设置一个鼠标样式
    .成员 背景, 整数型, , , 窗口的背景色
    .成员 菜单句柄, 整数型, , , 窗口的菜单句柄，如果没有菜单，就用0表示
    .成员 类名, 文本型, , , 给窗口设置类名

数据类型 消息结构, , 
    .成员 hwnd, 整数型, , , 
    .成员 msg, 整数型, , , 
    .成员 wparam, 整数型, , , 
    .成员 lparam, 整数型, , , 
    .成员 time, 整数型, , , 
    .成员 point, 点, , , 

数据类型 点, , 
    .成员 x, 整数型, , , 
    .成员 y, 整数型, , , 

.全局变量 模块句柄, 整数型, , , 
.全局变量 类名, 文本型, , , 
.全局变量 我的窗口句柄, 整数型, , , 
.全局变量 编辑框1, 整数型, , , 
.全局变量 按钮, 整数型, , , 
.全局变量 编辑框1ID, 整数型, , , 
.全局变量 编辑框2, 整数型, , , 
.全局变量 编辑框2ID, 空白型, , , 
.全局变量 按钮ID, 整数型, , , 
.全局变量 时钟ID, 整数型, , , 
.全局变量 消息地址, 整数型, , , 

.DLL命令 取模块句柄, 整数型, "", "GetModuleHandleA", , 
    .参数 模块名, 整数型, , 

.DLL命令 载入图标, 整数型, "", "LoadIconA", , 
    .参数 模块句柄, 整数型, , 
    .参数 图标句柄, 整数型, , 

.DLL命令 载入鼠标, 整数型, "", "LoadCursorA", , 
    .参数 模块句柄, 整数型, , 
    .参数 鼠标句柄, 整数型, , 

.DLL命令 创建窗口, 整数型, "user32.dll", "CreateWindowExA", , 
    .参数 扩展风格, 整数型, , 
    .参数 类名, 文本型, , 你刚才注册的类名
    .参数 窗口标题, 文本型, , 
    .参数 风格, 整数型, , 
    .参数 屏幕横坐标, 整数型, , 
    .参数 屏幕纵坐标, 整数型, , 
    .参数 宽度, 整数型, , 
    .参数 高度, 整数型, , 
    .参数 父窗口句柄, 整数型, , 没有就写0
    .参数 菜单句柄, 整数型, , 
    .参数 模块句柄, 整数型, , 
    .参数 参数, 整数型, , 

.DLL命令 注册窗口类, 整数型, "", "RegisterClassA", , 
    .参数 窗口类, 窗口类, , 

.DLL命令 获取消息, 整数型, "user32.dll", "GetMessageA", , 
    .参数 消息, 整数型, , 
    .参数 窗口句柄, 整数型, , 
    .参数 最小, 整数型, , 
    .参数 最大, 整数型, , 

.DLL命令 缺省窗口函数, 整数型, "", "DefWindowProcA", , 
    .参数 窗口句柄, 整数型, , 
    .参数 消息值, 整数型, , 
    .参数 参数1, 整数型, , 
    .参数 参数2, 整数型, , 

.DLL命令 显示窗口, 整数型, "", "ShowWindow", , 
    .参数 窗口句柄, 整数型, , 
    .参数 显示方式, 整数型, , 

.DLL命令 时钟, 整数型, "", "SetTimer", , 
    .参数 hwnd, 整数型, , 
    .参数 event, 整数型, , 
    .参数 out, 整数型, , 
    .参数 lpTimerFunc, 整数型, , 

.DLL命令 消息, 整数型, "", "SendMessageA", , 
    .参数 hwnd, 整数型, , 
    .参数 msg, 整数型, , 
    .参数 wparam, 整数型, , 
    .参数 lparam, 文本型, , 

.DLL命令 翻译消息, 整数型, "", "TranslateMessage", , 
    .参数 消息, 整数型, , 

.DLL命令 创建虚拟内存, 整数型, "", "VirtualAlloc", , 
    .参数 addr, 整数型, , 
    .参数 size, 整数型, , 
    .参数 type, 整数型, , 
    .参数 pro, 整数型, , 

.DLL命令 消息1, 整数型, "", "SendMessageA", , 
    .参数 hwnd, 整数型, , 
    .参数 msg, 整数型, , 
    .参数 wparam, 整数型, , 
    .参数 lparam, 整数型, , 

.DLL命令 传递消息, 整数型, "", "DispatchMessageA", , 
    .参数 msg, 整数型, , 

.DLL命令 消息框, 整数型, "", "MessageBoxA", , 
    .参数 hwnd, 整数型, , 
    .参数 lptext, 文本型, , 
    .参数 lpcaption, 文本型, , 
    .参数 utpye, 整数型, , 

.窗口程序集 程序集1, , , 

.子程序 注册类名, 逻辑型, , 为你的窗口注册一个类名，每个窗口都有类名的
.局部变量 我的窗口类, 窗口类, , , 

赋值 (我的窗口类.风格, 3)
赋值 (我的窗口类.窗口函数, &窗口函数)
赋值 (我的窗口类.类附加数据, 0)
赋值 (我的窗口类.窗口附加数据, 0)
赋值 (我的窗口类.模块句柄, 模块句柄)
赋值 (我的窗口类.图标句柄, 载入图标 (模块句柄, 32512)) ' 载入系统默认的程序图标，当然你也可以用自己的图标替换
赋值 (我的窗口类.鼠标句柄, 载入鼠标 (模块句柄, 32512))
赋值 (我的窗口类.背景, 5) ' 系统默认的窗口背景色
赋值 (我的窗口类.菜单句柄, 0)
赋值 (我的窗口类.类名, 类名)
.如果真 (不等于 (注册窗口类 (我的窗口类), 0))
    返回 (真)
.如果真结束
返回 (假)

.子程序 建立窗口, 逻辑型, , 注册类名后，就可以建立窗口了
赋值 (我的窗口句柄, 创建窗口 (0, 类名, “加法运算”, 13565952, 200, 200, 300, 200, 0, 0, 模块句柄, 0))
.如果真 (等于 (我的窗口句柄, 0))
    返回 (假)
.如果真结束
显示窗口 (我的窗口句柄, 1)
赋值 (消息地址, 分配内存 (28))
.如果真 (等于 (消息地址, 0))
    返回 (假)
.如果真结束
.判断循环首 (不等于 (获取消息 (消息地址, 我的窗口句柄, 0, 0), 0))
    翻译消息 (消息地址)
    传递消息 (消息地址)
.判断循环尾 ()
返回 (真)

.子程序 窗口函数, 整数型, , 
.参数 窗口句柄, 整数型, , 
.参数 消息值, 整数型, , 
.参数 参数1, 整数型, , 
.参数 参数2, 整数型, , 

.局部变量 加数1, 文本型, , , 
.局部变量 加数2, 文本型, , , 
.局部变量 和, 整数型, , , 
.局部变量 len, 整数型, , , 

.如果真 (等于 (消息值, 1))
    时钟 (窗口句柄, 时钟ID, 1000, 0)
    赋值 (编辑框1, 创建窗口 (512, “Edit”, “123”, 1342177280, 50, 10, 210, 25, 窗口句柄, 编辑框1ID, 模块句柄, 0))
    赋值 (编辑框2, 创建窗口 (512, “Edit”, “456”, 1342177280, 50, 50, 210, 25, 窗口句柄, 编辑框2ID, 模块句柄, 0))
    赋值 (按钮, 创建窗口 (512, “Button”, “求和”, 1342177280, 90, 100, 100, 40, 窗口句柄, 按钮ID, 模块句柄, 0))
    返回 (缺省窗口函数 (窗口句柄, 消息值, 参数1, 参数2))
.如果真结束
.如果真 (等于 (消息值, 273))
    .如果真 (等于 (参数1, 按钮ID))
        赋值 (len, 消息1 (编辑框1, 14, 0, 0))
        赋值 (加数1, 取空白文本 (len))
        消息 (编辑框1, 13, 相加 (相乘 (len, 8), 8), 加数1)
        赋值 (len, 消息1 (编辑框2, 14, 0, 0))
        赋值 (加数2, 取空白文本 (len))
        消息 (编辑框2, 13, 相加 (相乘 (len, 8), 8), 加数2)
        赋值 (和, 相加 (到数值 (加数1), 到数值 (加数2)))
        消息框 (窗口句柄, 到文本 (和), “结果”, 0)
    .如果真结束
    返回 (缺省窗口函数 (窗口句柄, 消息值, 参数1, 参数2))
    
.如果真结束
.如果真 (等于 (消息值, 275))
    .如果真 (等于 (参数1, 时钟ID))
        消息 (窗口句柄, 12, 取文本长度 (到文本 (取现行时间 ())), 到文本 (取现行时间 ()))
    .如果真结束
    返回 (缺省窗口函数 (窗口句柄, 消息值, 参数1, 参数2))
.如果真结束
返回 (缺省窗口函数 (窗口句柄, 消息值, 参数1, 参数2))

.子程序 _启动子程序, 整数型, , 
赋值 (模块句柄, 取模块句柄 (0)) ' 取得本模块的句柄
赋值 (类名, “MyFirstWindow”)
注册类名 ()
建立窗口 ()
返回 (0)

.子程序 分配内存, 整数型, , 
.参数 大小, 整数型, , 

.局部变量 base, 整数型, , , 

赋值 (base, 创建虚拟内存 (0, 大小, 4096, 4))
返回 (base)


 ' 不属于任何一个程序集、类模块的函数：
