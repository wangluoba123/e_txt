 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 269
    高度 = 457
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “窗口停靠类 - 作者：谢栋(神2)”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 5 系统核心支持库
 ' shellEx DA19AC3ADD2F4121AAD84AC5FBCAFC71 2 2 扩展功能支持库一




数据类型 位置数据, , 
    .成员 横向位置, 整数型, , , 
    .成员 纵向位置, 整数型, , , 


.类模块 窗口停靠, , , 作者：谢栋（神2）

.程序集变量 _空白指针, 子程序指针, , , 
.程序集变量 _停靠窗口, 窗口, , , 
.程序集变量 _收缩方向, 整数型, , , 方向：1.左  2.上  3.右  4.下
.程序集变量 _步进距离, 整数型, , , 
.程序集变量 _裸露尺寸, 整数型, , , 名字**了点
.程序集变量 _响应时间, 整数型, , , 单位：毫秒
.程序集变量 _目标位置, 位置数据, , , 
.程序集变量 _伸缩位置, 位置数据, , , 
.程序集变量 _底部停靠, 逻辑型, , , 
.程序集变量 _移动时间间隔, 整数型, , , 
.程序集变量 _展出完毕函数, 子程序指针, , , 
.程序集变量 _收缩完毕函数, 子程序指针, , , 
.程序集变量 _是否暂停控制, 逻辑型, , , 
.程序集变量 匿名程序集变量_258, 空白型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
赋值 (_步进距离, 10)
赋值 (_响应时间, 1000)
赋值 (_裸露尺寸, 3)
赋值 (_底部停靠, 假)
赋值 (_移动时间间隔, 5)
赋值 (_是否暂停控制, 假)


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 _类初始化, 空白型, , 
.参数 停靠窗口_, 窗口, 参考, 
.参数 步进距离_, 整数型, 可空, 
.参数 响应时间_, 整数型, 可空, 
.参数 裸露尺寸_, 整数型, 可空, 
.参数 移动时间间隔_, 整数型, 可空, 
.参数 底部是否停靠_, 逻辑型, 可空, 
.参数 展出完毕函数_, 子程序指针, 参考 可空, 
.参数 收缩完毕函数_, 子程序指针, 参考 可空, 

赋值 (_停靠窗口, 停靠窗口_)
.如果真 (等于 (是否为空 (步进距离_), 假))
    赋值 (_步进距离, 步进距离_)
.如果真结束
.如果真 (等于 (是否为空 (响应时间_), 假))
    赋值 (_响应时间, 响应时间_)
.如果真结束
.如果真 (等于 (是否为空 (裸露尺寸_), 假))
    赋值 (_裸露尺寸, 裸露尺寸_)
.如果真结束
.如果真 (等于 (是否为空 (移动时间间隔_), 假))
    赋值 (_移动时间间隔, 移动时间间隔_)
.如果真结束
.如果真 (等于 (是否为空 (底部是否停靠_), 假))
    赋值 (_底部停靠, 底部是否停靠_)
.如果真结束
.如果真 (等于 (是否为空 (展出完毕函数_), 假))
    赋值 (_展出完毕函数, 展出完毕函数_)
.如果真结束
.如果真 (等于 (是否为空 (收缩完毕函数_), 假))
    赋值 (_收缩完毕函数, 收缩完毕函数_)
.如果真结束


.子程序 处理事件, 空白型, 公开, 放在时钟事件底下
.局部变量 未处理完, 逻辑型, 静态, , 
.局部变量 收缩方向, 整数型, 静态, , 
.局部变量 响应开启时间, 整数型, 静态, , 

.如果真 (等于 (是否已创建 (_停靠窗口), 假))
    返回 ()
.如果真结束
.如果真 (未处理完)
    返回 ()
.如果真结束
赋值 (未处理完, 真)
.如果 (并且 (等于 (假, 是否脱离控制 ()), 等于 (_是否暂停控制, 假)))
    赋值 (收缩方向, 取收缩位置 (是否与鼠标相交 (), _目标位置, _伸缩位置))
    .如果 (大于 (收缩方向, 0))
        赋值 (_收缩方向, 收缩方向)
        .判断开始 (等于 (响应开启时间, 0))
            赋值 (响应开启时间, 取启动时间 ())
        .判断 (大于 (响应开启时间, 0))
            .如果真 (大于或等于 (相减 (取启动时间 (), 响应开启时间), _响应时间))
                移动窗体 (是否与鼠标相交 ())
                赋值 (响应开启时间, 0)
            .如果真结束
            
        .默认
            
        .判断结束
        
    .否则
        赋值 (响应开启时间, 0)
    .如果结束
    
.否则
    赋值 (响应开启时间, 0)
.如果结束

赋值 (未处理完, 假)


.子程序 是否与鼠标相交, 逻辑型, , 
.局部变量 鼠标左边, 整数型, , , 
.局部变量 鼠标顶边, 整数型, , , 
.局部变量 返回数据, 逻辑型, , , 

赋值 (鼠标左边, 取鼠标水平位置 ())
赋值 (鼠标顶边, 取鼠标垂直位置 ())
赋值 (返回数据, 并且 (小于或等于 (_停靠窗口.左边, 鼠标左边), 小于或等于 (_停靠窗口.顶边, 鼠标顶边)))
赋值 (返回数据, 并且 (返回数据, 小于或等于 (鼠标左边, 相加 (_停靠窗口.左边, _停靠窗口.宽度)), 小于或等于 (鼠标顶边, 相加 (_停靠窗口.顶边, _停靠窗口.高度))))
返回 (返回数据)


.子程序 是否脱离控制, 逻辑型, , 
.局部变量 返回数据, 逻辑型, , , 

赋值 (返回数据, 并且 (大于 (_停靠窗口.左边, 0), 大于 (_停靠窗口.顶边, 0)))
赋值 (返回数据, 并且 (返回数据, 小于 (相加 (_停靠窗口.左边, _停靠窗口.宽度), 取屏幕宽度 ()), 小于 (相加 (_停靠窗口.顶边, _停靠窗口.高度), 取屏幕高度 ())))
返回 (返回数据)


.子程序 取收缩位置, 整数型, , 0.不收缩
.参数 是否展出_, 逻辑型, 可空, 默认为  假
.参数 目标位置_, 位置数据, 参考, 
.参数 伸缩位置_, 位置数据, 参考, 

.局部变量 返回数据, 整数型, , , 

.如果真 (是否为空 (是否展出_))
    赋值 (是否展出_, 假)
.如果真结束
.判断开始 (小于或等于 (_停靠窗口.左边, 0))
    赋值 (返回数据, 1)
.判断 (小于或等于 (_停靠窗口.顶边, 0))
    赋值 (返回数据, 2)
.判断 (大于或等于 (相加 (_停靠窗口.左边, _停靠窗口.宽度), 取屏幕宽度 ()))
    赋值 (返回数据, 3)
.判断 (大于或等于 (相加 (_停靠窗口.顶边, _停靠窗口.高度), 取屏幕高度 ()))
    赋值 (返回数据, 选择 (_底部停靠, 4, 0))
.默认
    赋值 (返回数据, 0)
.判断结束
.如果真 (大于 (返回数据, 0))
    .如果 (是否展出_)
        赋值 (目标位置_, 取位置数据 (多项选择 (返回数据, 0, _停靠窗口.左边, 相减 (取屏幕宽度 (), _停靠窗口.宽度), _停靠窗口.左边), 多项选择 (返回数据, _停靠窗口.顶边, 0, _停靠窗口.顶边, 相减 (取屏幕高度 (), _停靠窗口.高度))))
        赋值 (伸缩位置_, 取位置数据 (多项选择 (返回数据, _步进距离, 0, 负 (_步进距离), 0), 多项选择 (返回数据, 0, _步进距离, 0, 负 (_步进距离))))
    .否则
        赋值 (目标位置_, 取位置数据 (多项选择 (返回数据, 相减 (_裸露尺寸, _停靠窗口.宽度), _停靠窗口.左边, 相减 (取屏幕宽度 (), _裸露尺寸), _停靠窗口.左边), 多项选择 (返回数据, _停靠窗口.顶边, 相减 (_裸露尺寸, _停靠窗口.高度), _停靠窗口.顶边, 相减 (取屏幕高度 (), _裸露尺寸))))
        赋值 (伸缩位置_, 取位置数据 (多项选择 (返回数据, 负 (_步进距离), 0, _步进距离, 0), 多项选择 (返回数据, 0, 负 (_步进距离), 0, _步进距离)))
    .如果结束
    .如果真 (并且 (等于 (_停靠窗口.左边, 目标位置_.横向位置), 等于 (_停靠窗口.顶边, 目标位置_.纵向位置)))
        赋值 (返回数据, 0)
    .如果真结束
    
.如果真结束
返回 (返回数据)


.子程序 取位置数据, 位置数据, , 
.参数 横向位置_, 整数型, , 
.参数 纵向位置_, 整数型, , 

.局部变量 临时位置, 位置数据, , , 

赋值 (临时位置.横向位置, 横向位置_)
赋值 (临时位置.纵向位置, 纵向位置_)
返回 (临时位置)


.子程序 移动窗体, 空白型, , 
.参数 是否展出_, 逻辑型, 可空, 

.局部变量 差距位置, 位置数据, , , 

.判断循环首 (或者 (不等于 (_停靠窗口.左边, _目标位置.横向位置), 不等于 (_停靠窗口.顶边, _目标位置.纵向位置)))
    赋值 (差距位置, 取位置数据 (取绝对值 (相减 (_停靠窗口.左边, _目标位置.横向位置)), 取绝对值 (相减 (_停靠窗口.顶边, _目标位置.纵向位置))))
    .如果 (并且 (小于或等于 (差距位置.横向位置, 相加 (_裸露尺寸, _步进距离)), 小于或等于 (差距位置.纵向位置, 相加 (_裸露尺寸, _步进距离))))
        _停靠窗口.移动 (_目标位置.横向位置, _目标位置.纵向位置, , )
    .否则
        _停靠窗口.移动 (相加 (_停靠窗口.左边, _伸缩位置.横向位置), 相加 (_停靠窗口.顶边, _伸缩位置.纵向位置), , )
    .如果结束
    延时 (_移动时间间隔)
    _停靠窗口.刷新显示 ()
    处理事件 ()
.判断循环尾 ()
.如果 (是否展出_)
    .如果真 (不等于 (_展出完毕函数, _空白指针))
        未知支持库函数_13 (_展出完毕函数, )
    .如果真结束
    
.否则
    .如果真 (不等于 (_收缩完毕函数, _空白指针))
        未知支持库函数_13 (_收缩完毕函数, )
    .如果真结束
    
.如果结束


.子程序 取收缩方向, 整数型, 公开, 1.左  2.上  3.右  4.下
返回 (_收缩方向)


.子程序 暂停控制, 逻辑型, 公开, 
.参数 是否暂停_, 逻辑型, 可空, 

.如果真 (等于 (假, 是否为空 (是否暂停_)))
    赋值 (_是否暂停控制, 是否暂停_)
.如果真结束
返回 (_是否暂停控制)

.窗口程序集 窗口程序集1, , , 

.程序集变量 _窗口停靠, 窗口停靠, , , 
.子程序 _时钟1_周期事件, 空白型, , 
_窗口停靠.处理事件 ()


.子程序 __启动窗口_创建完毕, 空白型, , 
_窗口停靠._类初始化 (_启动窗口, 20, 0, 5, 2)
 ' _窗口停靠._类初始化 (_启动窗口, 20, 0, 5, 2, 假, &展出完毕, &收缩完毕)


.子程序 收缩完毕, 空白型, , 
输出调试文本 (“收缩完毕”)


.子程序 展出完毕, 空白型, , 
输出调试文本 (“展出完毕”)


.子程序 _选择框1_被单击, 空白型, , 
_窗口停靠.暂停控制 (.选中)



 ' 不属于任何一个程序集、类模块的函数：
