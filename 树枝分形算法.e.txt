 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 主显示窗口
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 参数设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 300
    高度 = 426
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假



.声音 开始, " ' 已保存到：D:\易语言学习\Data\树枝分形算法.e\开始", , 
.声音 取消, " ' 已保存到：D:\易语言学习\Data\树枝分形算法.e\取消", , 
.声音 水果, " ' 已保存到：D:\易语言学习\Data\树枝分形算法.e\水果", , 
.图片 花朵, " ' 已保存到：D:\易语言学习\Data\树枝分形算法.e\花朵", , 
.图片 生果实, " ' 已保存到：D:\易语言学习\Data\树枝分形算法.e\生果实", , 
.图片 熟果实, " ' 已保存到：D:\易语言学习\Data\树枝分形算法.e\熟果实", , 
.图片 , , , 
.图片 背景1, " ' 已保存到：D:\易语言学习\Data\树枝分形算法.e\背景1", , 
.图片 背景2, " ' 已保存到：D:\易语言学习\Data\树枝分形算法.e\背景2", , 
.图片 背景3, " ' 已保存到：D:\易语言学习\Data\树枝分形算法.e\背景3", , 
.图片 背景4, " ' 已保存到：D:\易语言学习\Data\树枝分形算法.e\背景4", , 
.图片 背景5, " ' 已保存到：D:\易语言学习\Data\树枝分形算法.e\背景5", , 
.常量 产品最大数量, "32760", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库




数据类型 树信息, , 
    .成员 总步骤, 字节型, , , totalSteps
    .成员 当前步骤, 字节型, , , currentStep
    .成员 每个分枝步骤, 小数型, , , branchPerStep
    .成员 起步分枝, 字节型, , , startingBranch
    .成员 固定大小, 逻辑型, , , fixSize
    .成员 最大大小, 小数型, , , maxSize
    .成员 膨胀最高级别, 字节型, , , recisionLevelHi
    .成员 膨胀最高值, 小数型, , , recisionValueHi
    .成员 膨胀最低级别, 字节型, , , recisionLevelLow
    .成员 膨胀最低值, 小数型, , , recisionValueLow
    .成员 固定角度, 逻辑型, , , fixAngel
    .成员 角度大小, 小数型, , , sizeOfAngel
    .成员 异常分枝, 小数型, , , brokenBranches
    .成员 异常分枝尺度, 小数型, , , brokenBranchesScale
    .成员 每个分枝步骤尺度, 小数型, , , branchPerStepScale
    .成员 叶级别, 小数型, , , leafLevel
    .成员 躯干高, 小数型, , , trunkHeight
    .成员 宽度大小, 小数型, , , widthSize
    .成员 宽度尺度, 小数型, , , widthScale
    .成员 风场方向, 小数型, , , windDirection
    .成员 宽级别, 小数型, , , wideLevel
    .成员 需求花, 小数型, , , flowerNeed
    .成员 花大小, 小数型, , , flowerSize
    .成员 果实速度, 小数型, , , fruitSpeed
    .成员 果实最大改变, 字节型, , , fruitMaxChange
    .成员 果实数量, 短整数型, , , fruitCounter
    .成员 当前进度, 小数型, , , currentProgress
    .成员 剪枝操作, 逻辑型, , , cutOperation
    .成员 剪枝操作值, 短整数型, , , cutOperationValue

数据类型 花和果实, , 
    .成员 类型, 字节型, , , 0:花朵,1:生果实,2:熟果实
    .成员 宽, 短整数型, , , 
    .成员 高, 短整数型, , , 
    .成员 左, 短整数型, , , 
    .成员 顶, 短整数型, , , 

.全局变量 当前树, 树信息, , , 
.全局变量 是否快速画, 逻辑型, , , 
.全局变量 是否音乐, 逻辑型, , , 
.全局变量 是否随机背景, 逻辑型, , , 
.全局变量 是否汇聚, 逻辑型, , , 
.全局变量 匿名全局变量_90, 空白型, , , 
.全局变量 是否退出, 逻辑型, , , 
.全局变量 匿名全局变量_226, 空白型, , , 
.全局变量 当前路径, 文本型, , , 

.DLL命令 启动API时钟, 整数型, "user32.dll", "SetTimer", , 返回创建的时钟句柄
    .参数 窗口句柄, 整数型, , 无窗口就输入0
    .参数 事件标识符, 整数型, , 
    .参数 时钟周期, 整数型, , 
    .参数 回调函数地址, 子程序指针, , 

.DLL命令 关闭API时钟, 整数型, "user32.dll", "KillTimer", , 关闭创建的时钟
    .参数 窗口句柄, 整数型, , 无窗口就输入0
    .参数 时钟句柄, 整数型, , 

.DLL命令 取输入状态, 整数型, "user32.dll", "GetInputState", 公开, GetInputState(user32.dll)

.程序集 启动程序集, , , 

.子程序 _启动子程序, 整数型, , 本子程序在程序启动后最先执行
赋值 (当前路径, 取运行目录 ())
.如果真 (不等于 (取文本右边 (当前路径, 1), “\”))
    赋值 (当前路径, 相加 (当前路径, “\”))
.如果真结束
载入 (参数设置窗口, , 假)
初始化图片 ()
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 系统处理, 空白型, , 相当于 处理事件() 这是它的加速版
.如果真 (不等于 (取输入状态 (), 0))
    处理事件 ()
.如果真结束


.子程序 取时间名称, 文本型, , 
.局部变量 时间, 日期时间型, , , 
.局部变量 名称, 文本型, , , 

赋值 (时间, 取现行时间 ())
赋值 (名称, 相加 (到文本 (取年份 (时间)), 到文本 (取月份 (时间)), 到文本 (取日 (时间)), 到文本 (取小时 (时间)), 到文本 (取分钟 (时间)), 到文本 (取秒 (时间))))
返回 (相加 (名称, “.bmp”))

.程序集 画树管理程序集, , , 

.程序集变量 树产品, 花和果实, , "0", 
.程序集变量 匿名程序集变量_561, 空白型, , , 
.程序集变量 花朵图片号, 整数型, , , 
.程序集变量 生果实图片号, 整数型, , , 
.程序集变量 熟果实图片号, 整数型, , , 
.程序集变量 时钟间隔时间, 短整数型, , , 
.子程序 初始化图片, 空白型, , 
赋值 (花朵图片号, 载入图片 (#花朵))
赋值 (生果实图片号, 载入图片 (#生果实))
赋值 (熟果实图片号, 载入图片 (#熟果实))

.子程序 初始化背景, 空白型, , 
.局部变量 临时数, 字节型, , , 

置随机数种子 ()
赋值 (临时数, 相加 (求余数 (取随机数 (1, 6666), 5), 1))
赋值 (主显示窗口.., 多项选择 (临时数, #背景1, #背景2, #背景3, #背景4, #背景5))

.子程序 初始化树信息, 空白型, , 
赋值 (当前树.总步骤, 求余数 (到字节 (参数设置窗口..), 100))
赋值 (当前树.总步骤, 选择 (小于 (当前树.总步骤, 3), 3, 当前树.总步骤))
赋值 (参数设置窗口.., 到文本 (当前树.总步骤))

赋值 (当前树.每个分枝步骤, 到小数 (参数设置窗口..))
赋值 (当前树.每个分枝步骤, 选择 (小于或等于 (当前树.每个分枝步骤, 0), 1, 当前树.每个分枝步骤))
赋值 (参数设置窗口.., 到文本 (当前树.每个分枝步骤))

赋值 (当前树.起步分枝, 求余数 (到字节 (参数设置窗口..), 100))
赋值 (当前树.膨胀最高级别, 求余数 (到字节 (参数设置窗口..), 100))
赋值 (当前树.膨胀最低级别, 求余数 (到字节 (参数设置窗口..), 100))

赋值 (当前树.固定大小, 参数设置窗口..)
赋值 (当前树.最大大小, 求余数 (到小数 (参数设置窗口..), 100))

赋值 (当前树.固定角度, 参数设置窗口..)
赋值 (当前树.角度大小, 求余数 (到小数 (参数设置窗口..), 360))

赋值 (当前树.异常分枝, 选择 (参数设置窗口.., 求余数 (相乘 (到小数 (参数设置窗口..), 10), 相除 (1000, 10)), 0))
赋值 (当前树.异常分枝尺度, 参数设置窗口..)
赋值 (当前树.每个分枝步骤尺度, 参数设置窗口..)
赋值 (当前树.叶级别, 参数设置窗口..)
赋值 (当前树.躯干高, 参数设置窗口..)
赋值 (当前树.宽度大小, 参数设置窗口..)
赋值 (当前树.宽度尺度, 参数设置窗口..)
赋值 (当前树.风场方向, 参数设置窗口..)
赋值 (当前树.宽级别, 参数设置窗口..)

赋值 (当前树.需求花, 选择 (参数设置窗口.., 求余数 (相乘 (取绝对值 (到小数 (参数设置窗口..)), 10), 相除 (1000, 10)), 0))
赋值 (当前树.花大小, 参数设置窗口..)

赋值 (当前树.果实最大改变, 选择 (参数设置窗口.., 求余数 (到字节 (参数设置窗口..), 100), 0))
赋值 (当前树.果实速度, 参数设置窗口..)

赋值 (当前树.剪枝操作, 参数设置窗口..)
赋值 (当前树.剪枝操作值, 到短整数 (参数设置窗口..))

.子程序 初始化树数据, 空白型, , 
赋值 (参数设置窗口., 0)
赋值 (参数设置窗口., 相减 (相除 (取屏幕高度 (), 2), 相除 (参数设置窗口., 2)))
赋值 (主显示窗口., 相减 (取屏幕宽度 (), 主显示窗口.))
赋值 (主显示窗口., 相减 (相除 (取屏幕高度 (), 2), 相除 (主显示窗口., 2)))
赋值 (主显示窗口.., 0)
赋值 (主显示窗口.., 0)
赋值 (主显示窗口.., 主显示窗口.)
赋值 (主显示窗口.., 主显示窗口.)

初始化背景 ()

初始化树信息 ()

赋值 (是否快速画, 参数设置窗口..)
赋值 (是否音乐, 参数设置窗口..)
赋值 (是否随机背景, 参数设置窗口..)

赋值 (当前树.角度大小, 相除 (相乘 (当前树.角度大小, 2), 当前树.每个分枝步骤))
赋值 (当前树.最大大小, 相减 (当前树.最大大小, 相乘 (相减 (相除 (当前树.躯干高, 5), 8), 1.6)))
.如果真 (小于 (当前树.最大大小, 1))
    赋值 (当前树.最大大小, 1)
.如果真结束
赋值 (是否汇聚, 真)

.如果真 (是否音乐)
    播放音乐 (#开始, 假)
.如果真结束
赋值 (参数设置窗口.., 假)
赋值 (参数设置窗口.., 真)

.子程序 刷新显示窗体, 空白型, , 
改变时钟状态 (假)
赋值 (当前树.当前进度, 0)
赋值 (当前树.膨胀最高值, 0)
赋值 (当前树.膨胀最低值, 0)

赋值 (是否退出, 假)
赋值 (当前树.当前步骤, 0)
下个分枝 (相除 (主显示窗口., 2), 相减 (主显示窗口., 相除 (主显示窗口., 5)), 180)
.如果真 (并且 (取反 (是否退出), 大于 (当前树.需求花, 0), 大于 (当前树.果实最大改变, 0)))
    改变时钟状态 (真)
.如果真结束
赋值 (参数设置窗口.., 真)
赋值 (参数设置窗口.., 假)
赋值 (参数设置窗口.., 0)

.子程序 下个分枝, 空白型, , 
.参数 开始X, 小数型, , 
.参数 开始Y, 小数型, , 
.参数 开始角度, 小数型, , 

.局部变量 分枝大小, 小数型, , , 
.局部变量 分枝宽, 小数型, , , 
.局部变量 尾X, 小数型, , , 
.局部变量 尾Y, 小数型, , , 
.局部变量 分枝数量, 小数型, , , 
.局部变量 分枝颜色, 整数型, , , 
.局部变量 增长角度, 小数型, , , 
.局部变量 新角度, 小数型, , , 
.局部变量 循环次数, 整数型, , , 

置错误提示管理 (&错误处理)
置随机数种子 ()
.如果真 (或者 (大于或等于 (当前树.当前步骤, 当前树.总步骤), 是否退出))
    返回 ()
.如果真结束
.如果真 (等于 (当前树.当前步骤, 3))
    赋值 (当前树.当前进度, 相加 (当前树.当前进度, 相除 (100, 求次方 (当前树.每个分枝步骤, 当前树.当前步骤))))
    赋值 (参数设置窗口.., 选择 (小于 (当前树.当前进度, 100), 当前树.当前进度, 100))
    .如果真 (并且 (当前树.剪枝操作, 大于或等于 (当前树.当前进度, 当前树.剪枝操作值)))
        赋值 (当前树.总步骤, 0)
        返回 ()
    .如果真结束
    
.如果真结束
.如果真 (并且 (大于 (当前树.异常分枝, 0), 大于 (当前树.当前步骤, 2)))
    .如果真 (小于 (求余数 (取随机数 (0, 100), 99), 相加 (当前树.异常分枝, 相乘 (相除 (相乘 (相除 (相乘 (当前树.异常分枝, 相减 (当前树.异常分枝尺度, 50)), 50), 相减 (相乘 (当前树.当前步骤, 2), 当前树.总步骤)), 当前树.总步骤), 0.7, 相减 (1, 相除 (相减 (当前树.异常分枝尺度, 50), 100))))))
        返回 ()
    .如果真结束
    
.如果真结束
.如果真 (并且 (大于 (当前树.膨胀最高级别, 0), 等于 (当前树.膨胀最高值, 0), 等于 (当前树.当前步骤, 相减 (当前树.膨胀最高级别, 1))))
    赋值 (当前树.膨胀最高值, 开始Y)
.如果真结束
.如果真 (并且 (大于 (当前树.膨胀最高值, 0), 小于 (开始Y, 当前树.膨胀最高值)))
    返回 ()
.如果真结束
.如果真 (并且 (大于 (当前树.膨胀最低级别, 0), 等于 (当前树.膨胀最低值, 0), 等于 (当前树.当前步骤, 相减 (当前树.膨胀最低级别, 1))))
    赋值 (当前树.膨胀最低值, 开始Y)
.如果真结束
.如果真 (并且 (大于 (当前树.膨胀最低值, 0), 大于 (开始Y, 当前树.膨胀最低值), 大于 (当前树.当前步骤, 相乘 (当前树.膨胀最低级别, 0.8))))
    赋值 (开始角度, 相加 (求余数 (开始角度, 180), 90))
.如果真结束

系统处理 ()

赋值 (当前树.当前步骤, 相加 (当前树.当前步骤, 1))

赋值 (分枝宽, 相除 (相乘 (相除 (当前树.宽度大小, 50), 相加 (15, 相除 (当前树.总步骤, 4))), 求次方 (当前树.当前步骤, 相加 (相除 (相减 (求次方 (当前树.宽度尺度, 1.2), 50), 75), 0.2))))
.如果真 (小于 (分枝宽, 1))
    赋值 (分枝宽, 1)
.如果真结束

赋值 (分枝大小, 相乘 (相减 (当前树.总步骤, 相除 (相乘 (当前树.当前步骤, 当前树.叶级别), 50)), 选择 (大于或等于 (当前树.叶级别, 50), 相除 (当前树.叶级别, 50), 相除 (相加 (当前树.叶级别, 50), 100))))
赋值 (分枝大小, 相除 (相乘 (相除 (相乘 (选择 (大于 (分枝大小, 0), 分枝大小, 1), 主显示窗口.), 求次方 (当前树.总步骤, 1.9)), 选择 (当前树.固定大小, 1, 相加 (求余数 (取随机数 (0, 10), 相乘 (相除 (9, 10), 1.7)), 0.1)), 当前树.最大大小), 80))

.如果真 (小于 (当前树.当前步骤, 3))
    赋值 (分枝大小, 相加 (分枝大小, 相除 (主显示窗口., 相乘 (30, 当前树.当前步骤)), 相除 (相乘 (相除 (相乘 (分枝大小, 相减 (相除 (当前树.躯干高, 10), 4)), 相加 (当前树.当前步骤, 1.5)), 当前树.总步骤), 15)))
.如果真结束

赋值 (尾X, 相加 (相乘 (求正弦 (相除 (相乘 (开始角度, #pi), 180)), 分枝大小, 0.8), 开始X))
赋值 (尾Y, 相加 (相乘 (求余弦 (相除 (相乘 (开始角度, #pi), 180)), 分枝大小, 0.8), 开始Y))

赋值 (分枝颜色, 取颜色值 (100, 相除 (相乘 (255, 当前树.当前步骤), 当前树.总步骤), 35))

.如果真 (大于或等于 (当前树.当前步骤, 当前树.起步分枝))
    赋值 (主显示窗口.., 分枝宽)
    赋值 (主显示窗口.., 分枝颜色)
    主显示窗口.画直线 (., 开始X, 开始Y, 尾X, 尾Y)
.如果真结束

.如果真 (大于 (当前树.需求花, 0.1))
    画花朵 (尾X, 尾Y)
.如果真结束

赋值 (增长角度, 相乘 (当前树.角度大小, 选择 (当前树.固定角度, 1, 相减 (求余数 (取随机数 (0, 100), 4), 2))))
赋值 (增长角度, 相加 (增长角度, 相除 (相乘 (求正弦 (相除 (相乘 (增长角度, #pi), 180)), 相乘 (相减 (当前树.宽级别, 500), 0.3), 当前树.总步骤), 当前树.当前步骤)))

赋值 (分枝数量, 相加 (当前树.每个分枝步骤, 相除 (相乘 (相除 (相乘 (当前树.每个分枝步骤, 2, 相减 (当前树.每个分枝步骤尺度, 50)), 50), 当前树.当前步骤), 当前树.总步骤)))

.如果真 (小于 (分枝数量, 1))
    赋值 (分枝数量, 1)
.如果真结束

.计次循环首 (取整 (分枝数量), 循环次数)
    赋值 (新角度, 相加 (相减 (相乘 (开始角度, 相减 (1, 相除 (相减 (当前树.风场方向, 50), 700))), 相除 (增长角度, 2)), 相乘 (增长角度, 相减 (循环次数, 相除 (分枝数量, 2)), 选择 (当前树.固定角度, 1, 相减 (1.1, 求余数 (取随机数 (0, 10), 相乘 (相除 (9, 10), 0.25)))))))
    下个分枝 (尾X, 尾Y, 新角度)
.计次循环尾 ()

错误处理 ()

.子程序 循环控制, 空白型, , 
.局部变量 循环容器, 整数型, , , 
.局部变量 临时数, 短整数型, , , 
.局部变量 数量, 短整数型, , , 

关闭API时钟 (主显示窗口.取窗口句柄 (), 0)
赋值 (数量, 取数组成员数 (树产品))
.如果真 (或者 (等于 (数量, 0), 大于或等于 (数量, 32760)))
    改变时钟状态 (假)
    返回 ()
.如果真结束
.如果 (大于或等于 (数量, 相乘 (相除 (数量, 100), 当前树.果实最大改变)))
    改变时钟状态 (假)
.否则
    .计次循环首 (相除 (当前树.果实速度, 12), 循环容器)
        赋值 (临时数, 相加 (取随机数 (1, 数量), 1))
        改变树产品 (临时数)
    .计次循环尾 ()
.如果结束

.如果真 (大于 (时钟间隔时间, 1000))
    赋值 (时钟间隔时间, 相加 (10, 相乘 (相减 (100, 当前树.果实速度), 5)))
.如果真结束

.如果真 (小于或等于 (时钟间隔时间, 0))
    赋值 (时钟间隔时间, 1)
.如果真结束
启动API时钟 (主显示窗口.取窗口句柄 (), 0, 时钟间隔时间, &循环控制)

.子程序 画花朵, 空白型, , 
.参数 X, 短整数型, , 
.参数 Y, 短整数型, , 

.局部变量 临时数, 短整数型, , , 
.局部变量 临时产品, 花和果实, , , 

.如果真 (大于 (当前树.当前步骤, 相除 (当前树.总步骤, 2)))
    .如果真 (等于 (取整 (求余数 (取随机数 (0, 10), 相除 (相乘 (相除 (9, 10), 当前树.当前步骤, 求次方 (30, 相除 (相加 (10, 当前树.每个分枝步骤), 10))), 当前树.需求花))), 1))
        赋值 (临时数, 相加 (取数组成员数 (树产品), 1))
        .如果真 (大于 (临时数, #产品最大数量))
            赋值 (当前树.需求花, 0.1)
        .如果真结束
        赋值 (临时产品.类型, 0)
        赋值 (临时产品.宽, 取整 (求余数 (取随机数 (0, 10), 相乘 (相除 (9, 10), 求次方 (相除 (当前树.花大小, 5), 1.6)))))
        赋值 (临时产品.高, 临时产品.宽)
        赋值 (临时产品.左, X)
        赋值 (临时产品.顶, Y)
        加入成员 (树产品, 临时产品)
         ' 主显示窗口.临时画板.画板背景色 ＝ #红色
         ' 主显示窗口.临时画板.底图 ＝ #花朵
         ' 主显示窗口.临时画板.宽度 ＝ 临时产品.宽
         ' 主显示窗口.临时画板.高度 ＝ 临时产品.高
         ' 主显示窗口.临时画板.顶边 ＝ 临时产品.顶
         ' 主显示窗口.临时画板.可视 ＝ 真
        主显示窗口.画图片 (., 花朵图片号, 临时产品.左, 临时产品.顶, 临时产品.宽, 临时产品.高, 相乘 (-1, #红色))
    .如果真结束
    
.如果真结束


.子程序 改变树产品, 空白型, , 
.参数 编号, 短整数型, , 
.参数 是否移除, 逻辑型, 可空, 

.判断开始 (等于 (树产品 [编号], 类型, 0))
    赋值 (当前树.果实数量, 相加 (当前树.果实数量, 1))
    赋值 (树产品 [编号], 类型, 1)
    主显示窗口.画图片 (., 生果实图片号, 树产品 [编号], 左, 树产品 [编号], 顶, 树产品 [编号], 宽, 树产品 [编号], 高, 相乘 (-1, #红色))
.判断 (等于 (树产品 [编号], 类型, 1))
    赋值 (树产品 [编号], 类型, 2)
    赋值 (树产品 [编号], 宽, 相乘 (树产品 [编号], 宽, 1.7))
    赋值 (树产品 [编号], 高, 相乘 (树产品 [编号], 高, 1.7))
    主显示窗口.画图片 (., 生果实图片号, 树产品 [编号], 左, 树产品 [编号], 顶, 树产品 [编号], 宽, 树产品 [编号], 高, 相乘 (-1, #白色))
.判断 (等于 (树产品 [编号], 类型, 2))
    
.默认
    
.判断结束


.子程序 改变时钟状态, 空白型, , 
.参数 临时, 逻辑型, , 

关闭API时钟 (主显示窗口.取窗口句柄 (), 0)
.如果 (临时)
    启动API时钟 (主显示窗口.取窗口句柄 (), 0, 3000, &循环控制)
    赋值 (参数设置窗口.., 真)
    赋值 (参数设置窗口.., 假)
    .如果真 (是否音乐)
    .如果真结束
    
.否则
    赋值 (参数设置窗口.., 假)
    赋值 (参数设置窗口.., 真)
    赋值 (当前树.果实数量, 0)
.如果结束


.子程序 错误处理, 空白型, , 
赋值 (当前树.当前步骤, 相减 (当前树.当前步骤, 1))
返回 ()

.窗口程序集 主显示窗口程序集, , , 

.子程序 _主显示窗口_首次激活, 空白型, , 
刷新显示窗体 ()

.窗口程序集 参数设置窗口程序集, , , 

.程序集变量 系统参数数据, 文本型, , "26", 
.子程序 _参数设置窗口_创建完毕, 空白型, , 
系统参数初始化 ()
参数分析 (11)

.子程序 系统参数初始化, 空白型, , 
赋值 (系统参数数据 [1], “15,2,1,0,0,70,45,30,20,20,20|1,1,0,0,0,0|50,50,50,50,50,50,50,500,50,50”)
赋值 (系统参数数据 [2], “5,90,2,0,0,90,6000,30,20,20,20|1,1,0,0,0,0|50,10,50,85,60,90,50,912,50,50”)
赋值 (系统参数数据 [3], “7,5,3,0,0,70,100,30,20,20,20|1,1,0,0,0,0|50,50,60,100,20,50,50,100,50,50”)
赋值 (系统参数数据 [4], “7,11,0,0,0,70,45,30,80,45,20|1,1,0,1,1,0|50,30,100,100,20,75,50,605,60,95”)
赋值 (系统参数数据 [5], “12,3,2,0,0,70,180,30,20,20,20|1,1,0,0,0,0|50,50,70,100,20,50,50,731,50,50”)
赋值 (系统参数数据 [6], “9,5,7,0,0,70,180,30,20,20,20|1,1,0,0,0,0|50,50,100,90,20,70,50,500,50,50”)
赋值 (系统参数数据 [7], “11,3,6,0,0,70,180,30,20,20,20|1,1,0,0,0,0|50,50,90,75,10,70,50,500,50,50”)
赋值 (系统参数数据 [8], “13,8,4,0,0,70,1265,30,20,20,20|1,1,0,0,0,0|50,16,100,80,40,50,50,827,50,50”)
赋值 (系统参数数据 [9], “12,10,4,0,0,70,220,30,20,20,20|1,1,0,0,0,0|50,5,100,100,40,50,50,500,50,50”)
赋值 (系统参数数据 [10], “15,8,5,0,0,70,230,30,20,20,20|1,1,0,0,0,0|50,11,100,90,25,45,50,896,50,50”)

赋值 (系统参数数据 [11], “30,2,1,0,0,65,32,35,20,20,20|0,0,1,1,1,0|50,50,50,50,50,50,50,500,50,50”)
赋值 (系统参数数据 [12], “30,2,1,0,0,65,32,25,20,20,20|0,0,1,1,1,0|50,50,50,50,50,50,50,500,50,50”)
赋值 (系统参数数据 [13], “40,2,1,0,0,60,30,33,20,20,20|1,1,1,0,0,0|95,50,60,50,40,50,50,500,50,50”)
赋值 (系统参数数据 [14], “32,3,1,0,0,65,30,54,20,20,20|0,0,1,1,1,0|65,50,50,55,30,45,55,500,30,85”)
赋值 (系统参数数据 [15], “40,4,1,0,2,65,38,68.7,10,20,20|0,0,1,1,1,0|60,50,55,60,30,44,50,500,20,90”)
赋值 (系统参数数据 [16], “40,6,3,0,0,55,25,82,20,20,20|0,0,1,0,0,0|65,50,60,25,100,60,50,500,50,50”)
赋值 (系统参数数据 [17], “38,5,1,0,0,65,68,75,20,20,20|0,0,1,1,0,0|55,55,55,60,30,45,50,500,50,50”)
赋值 (系统参数数据 [18], “65,5,1,0,30,70,35,80,20,20,20|0,0,1,0,0,0|58,50,27,65,25,45,55,500,50,50”)
赋值 (系统参数数据 [19], “30,7,3,0,0,60,30,81,5,20,20|0,0,1,1,0,0|45,50,65,10,10,35,60,500,100,50”)
赋值 (系统参数数据 [20], “23,9,3,0,0,20,22,88,50,20,20|0,0,1,1,0,0|50,50,5,0,50,100,70,560,90,50”)
赋值 (系统参数数据 [21], “25,5,3,0,0,30,40,20,20,20,20|0,0,1,0,0,0|25,10,20,0,40,50,50,500,50,50”)
赋值 (系统参数数据 [22], “35,2,1,0,0,60,30,30,20,20,20|0,0,1,0,0,0|55,55,60,45,30,45,50,500,50,50”)

赋值 (系统参数数据 [23], “24,4,2,0,0,20,30,67,20,20,20|0,0,1,0,0,0|40,50,30,10,40,30,50,500,50,50”)
赋值 (系统参数数据 [24], “16,10,8,0,0,65,2380,30,20,20,20|1,1,0,0,0,0|50,7,100,90,10,50,50,757,50,50”)
赋值 (系统参数数据 [25], “30,3,3,0,0,30,25,61,50,20,20|0,0,1,1,0,0|85,50,15,0,40,60,60,500,30,50”)
赋值 (系统参数数据 [26], “15,2,1,0,0,70,45,30,20,20,21|1,1,1,1,1,1|50,50,50,50,50,50,50,500,50,57”)

.子程序 参数分析, 空白型, , 
.参数 编号, 字节型, , 

.局部变量 文本数组, 文本型, , "0", 
.局部变量 临时数组1, 文本型, , "0", 
.局部变量 临时数组2, 文本型, , "0", 
.局部变量 临时数组3, 文本型, , "0", 
.局部变量 循环容器, 整数型, , , 
.局部变量 临时编辑框, 编辑框, , , 
.局部变量 临时选择框, 选择框, , , 
.局部变量 临时滑块条, 滑块条, , , 

赋值 (文本数组, 分割文本 (系统参数数据 [编号], “|”, ))
赋值 (临时数组1, 分割文本 (文本数组 [1], “,”, ))
赋值 (临时数组2, 分割文本 (文本数组 [2], “,”, ))
赋值 (临时数组3, 分割文本 (文本数组 [3], “,”, ))

.计次循环首 (11, 循环容器)
    赋值 (临时编辑框, 取标记组件 (循环容器))
    赋值 (临时编辑框., 临时数组1 [循环容器])
    .如果真 (大于或等于 (循环容器, 6))
        赋值 (临时选择框, 取标记组件 (相加 (循环容器, 6)))
        赋值 (临时选择框., 选择 (等于 (临时数组2 [相减 (循环容器, 5)], “1”), 真, 假))
        赋值 (临时编辑框., 选择 (临时选择框., 假, 真))
    .如果真结束
    
.计次循环尾 ()

.计次循环首 (10, 循环容器)
    赋值 (临时滑块条, 取标记组件 (相加 (20, 循环容器)))
    赋值 (临时滑块条., 到短整数 (临时数组3 [循环容器]))
.计次循环尾 ()

.子程序 _开始画按钮_被单击, 空白型, , 
.如果真 (等于 (是否已创建 (主显示窗口), 假))
    载入 (主显示窗口, , 假)
.如果真结束
初始化树数据 ()
赋值 (主显示窗口., 真)

.子程序 _停止时钟按钮_被单击, 空白型, , 
.如果真 (是否音乐)
    播放音乐 (#取消, 假)
.如果真结束
赋值 (当前树.果实数量, 32760)

.子程序 _停止画按钮_被单击, 空白型, , 
.如果真 (是否音乐)
    播放音乐 (#取消, 假)
.如果真结束
赋值 (是否退出, 真)

.子程序 _总步骤纵向滚动条_位置被改变, 空白型, , 
赋值 (., 到文本 (.))

.子程序 _每个分枝步骤纵向滚动条_位置被改变, 空白型, , 
赋值 (., 到文本 (.))

.子程序 _起步分枝数纵向滚动条_位置被改变, 空白型, , 
赋值 (., 到文本 (.))

.子程序 _膨胀最高级别纵向滚动条_位置被改变, 空白型, , 
赋值 (., 到文本 (.))


.子程序 _膨胀最低级别纵向滚动条_位置被改变, 空白型, , 
赋值 (., 到文本 (.))

.子程序 _固定大小纵向滚动条_位置被改变, 空白型, , 
赋值 (., 到文本 (.))

.子程序 _固定角度纵向滚动条_位置被改变, 空白型, , 
赋值 (., 到文本 (.))

.子程序 _异常分枝纵向滚动条_位置被改变, 空白型, , 
赋值 (., 到文本 (.))

.子程序 _花数量纵向滚动条_位置被改变, 空白型, , 
赋值 (., 到文本 (.))

.子程序 _果实数量纵向滚动条_位置被改变, 空白型, , 
赋值 (., 到文本 (.))

.子程序 _剪枝操作值纵向滚动条_位置被改变, 空白型, , 
赋值 (., 到文本 (.))

.子程序 _保存图片_被选择, 空白型, , 
.如果真 (等于 (写到文件 (相加 (当前路径, 取时间名称 ()), 主显示窗口.取图片 (., , )), 假))
    信息框 (“保存文件失败”, 0, )
    返回 ()
.如果真结束


.子程序 _退出_被选择, 空白型, , 
结束 ()

.子程序 _快速画_被选择, 空白型, , 
赋值 (., 取反 (.))

.子程序 _音乐_被选择, 空白型, , 
赋值 (., 取反 (.))

.子程序 _随机背景_被选择, 空白型, , 
赋值 (., 取反 (.))

.子程序 _简单例子_被选择, 空白型, , 
参数分析 (1)

.子程序 _想象1_被选择, 空白型, , 
参数分析 (2)

.子程序 _想象2_被选择, 空白型, , 
参数分析 (3)

.子程序 _想象3_被选择, 空白型, , 
参数分析 (4)

.子程序 _想象4_被选择, 空白型, , 
参数分析 (5)

.子程序 _想象5_被选择, 空白型, , 
参数分析 (6)

.子程序 _想象6_被选择, 空白型, , 
参数分析 (7)

.子程序 _想象7_被选择, 空白型, , 
参数分析 (8)

.子程序 _想象8_被选择, 空白型, , 
参数分析 (9)

.子程序 _想象9_被选择, 空白型, , 
参数分析 (10)

.子程序 _默认_被选择, 空白型, , 
参数分析 (11)

.子程序 _简单植物_被选择, 空白型, , 
参数分析 (12)

.子程序 _花园_被选择, 空白型, , 
参数分析 (13)

.子程序 _大型1_被选择, 空白型, , 
参数分析 (14)

.子程序 _大型2_被选择, 空白型, , 
参数分析 (15)

.子程序 _大型3_被选择, 空白型, , 
参数分析 (16)

.子程序 _野外1_被选择, 空白型, , 
参数分析 (17)

.子程序 _野外2_被选择, 空白型, , 
参数分析 (18)

.子程序 _野外花1_被选择, 空白型, , 
参数分析 (19)

.子程序 _野外花2_被选择, 空白型, , 
参数分析 (20)

.子程序 _绒毛_被选择, 空白型, , 
参数分析 (21)

.子程序 _春季_被选择, 空白型, , 
参数分析 (22)

.子程序 _自建1_被选择, 空白型, , 
参数分析 (23)

.子程序 _自建2_被选择, 空白型, , 
参数分析 (24)

.子程序 _自建3_被选择, 空白型, , 
参数分析 (25)

.子程序 _自建4_被选择, 空白型, , 
参数分析 (26)


 ' 不属于任何一个程序集、类模块的函数：
