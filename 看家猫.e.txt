 ' 文件类型：Windows窗口程序

 ' 程序名称：看家猫
 ' 程序描述：一个可以查看及改变运行着的程序状态的小东东。
 ' 程序作者：大馋猫
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：rockcat123@263.net
 ' 主页地址：rockcat.h58.net
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 主窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 530
    高度 = 407
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 12632256 '  0xC0C0C0
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 已保存到：D:\易语言学习\Data\看家猫.e\主窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “看家猫（0.91版）”
    帮助文件名 = “”

窗口 _启动窗口
    左边 = 50
    顶边 = 50
    宽度 = 391
    高度 = 295
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 12632256 '  0xC0C0C0
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 设置
    左边 = 50
    顶边 = 50
    宽度 = 268
    高度 = 186
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 12632256 '  0xC0C0C0
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 错误
    左边 = 50
    顶边 = 50
    宽度 = 372
    高度 = 178
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 12632256 '  0xC0C0C0
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 密码窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 12632256 '  0xC0C0C0
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.常量 DSTINVERT, "5570569", , 
.图片 鼠标, " ' 已保存到：D:\易语言学习\Data\看家猫.e\鼠标", , 
.图片 背图, " ' 已保存到：D:\易语言学习\Data\看家猫.e\背图", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 6 系统核心支持库




数据类型 坐标, , 
    .成员 横, 整数型, , , 
    .成员 纵, 整数型, , , 

数据类型 矩形, , 
    .成员 左, 整数型, , , 
    .成员 上, 整数型, , , 
    .成员 右, 整数型, , , 
    .成员 下, 整数型, , , 

数据类型 结构, , 
    .成员 dmDeviceName, 整数型, , , 
    .成员 dmSpecVersion, 整数型, , , 
    .成员 dmDriver, 整数型, , , 
    .成员 dmSize, 整数型, , , 
    .成员 dmDriverExtra, 整数型, , , 
    .成员 dmFields, 整数型, , , 
    .成员 dmOrientation, 整数型, , , 
    .成员 dmPaperSize, 整数型, , , 
    .成员 dmPaperLength, 整数型, , , 
    .成员 dmPaperWidth, 整数型, , , 
    .成员 dmScale, 整数型, , , 
    .成员 dmCopies, 整数型, , , 
    .成员 dmDefaultSource, 整数型, , , 
    .成员 dmPrintQuality, 整数型, , , 
    .成员 dmColor, 整数型, , , 
    .成员 dmDuplex, 整数型, , , 
    .成员 dmYResolution, 整数型, , , 
    .成员 dmTTOption, 整数型, , , 
    .成员 dmCollate, 整数型, , , 
    .成员 dmFormName, 整数型, , , 
    .成员 dmLogPixels, 整数型, , , 
    .成员 dmBitsPerPel, 整数型, , , 
    .成员 dmPelsWidth, 整数型, , , 
    .成员 dmPelsHeight, 整数型, , , 
    .成员 dmDisplayFlags, 整数型, , , 
    .成员 dmDisplayFrequency, 整数型, , , 
    .成员 dmICMMethod, 整数型, , , 
    .成员 dmICMIntentAs, 整数型, , , 
    .成员 dmMediaType, 整数型, , , 
    .成员 dmDitherType, 整数型, , , 
    .成员 dmICCManufacturer, 整数型, , , 
    .成员 dmICCModel, 整数型, , , 

.全局变量 密码, 文本型, , , 
.全局变量 热键, 文本型, , , 
.全局变量 热键值, 整数型, , , 
.全局变量 设置句柄, 整数型, , , 
.全局变量 修改, 逻辑型, , , 
.全局变量 键码, 整数型, , , 
.全局变量 正确, 逻辑型, , , 
.全局变量 呼出, 文本型, , , 
.全局变量 错误消息, 文本型, , , 

.DLL命令 桌面窗口, 整数型, "", "GetDesktopWindow", , 

.DLL命令 窗口句柄, 整数型, "", "GetWindow", , 
    .参数 hwnd, 整数型, , 
    .参数 wCmd, 整数型, , 

.DLL命令 标题长度, 整数型, "", "GetWindowTextLengthA", , 
    .参数 hwnd, 整数型, , 

.DLL命令 窗体标题, 整数型, "", "GetWindowTextA", , 
    .参数 hwnd, 整数型, , 
    .参数 lpString, 文本型, , 
    .参数 cch, 整数型, , 

.DLL命令 窗口是否处于活动状态, 整数型, "", "IsWindowEnabled", , 
    .参数 hwnd, 整数型, , 

.DLL命令 句柄是否为菜单, 逻辑型, "", "IsMenu", , 
    .参数 hwnd, 整数型, , 

.DLL命令 创建鼠标指针, 整数型, "", "LoadCursorFromFileA", , 
    .参数 lpFileName, 文本型, , 

.DLL命令 清除鼠标指针, 整数型, "", "DestroyCursor", , 
    .参数 hCursor, 整数型, , 

.DLL命令 窗口是否可见, 整数型, "", "IsWindowVisible", , 
    .参数 hwnd, 整数型, , 

.DLL命令 指定点窗口, 整数型, "", "WindowFromPoint", , 
    .参数 xPoint, 整数型, , 
    .参数 yPoint, 整数型, , 

.DLL命令 窗口范围, 整数型, "", "GetWindowRect", , 
    .参数 hwnd, 整数型, , 
    .参数 lpRect, 矩形, , 

.DLL命令 鼠标位置, 整数型, "", "GetCursorPos", , 
    .参数 lpPoint, 坐标, , 

.DLL命令 鼠标捕获, 整数型, "", "SetCapture", , 
    .参数 hwnd, 整数型, , 

.DLL命令 释放鼠标捕获, 整数型, "", "ReleaseCapture", , 

.DLL命令 创建场景, 整数型, "", "CreateDCA", , 
    .参数 lpDriverName, 文本型, , 
    .参数 lpDeviceName, 文本型, , 
    .参数 lpOutput, 文本型, , 
    .参数 lpInitData, 整数型, , 

.DLL命令 矩形是否为空, 整数型, "", "IsRectEmpty", , 
    .参数 lpRect, 矩形, , 

.DLL命令 填充设备场景, 空白型, "", "PatBlt", , 
    .参数 hdc, 整数型, , 
    .参数 x, 整数型, , 
    .参数 y, 整数型, , 
    .参数 nWidth, 整数型, , 
    .参数 nHeight, 整数型, , 
    .参数 dwRop, 整数型, , 

.DLL命令 窗口类名, 整数型, "", "GetClassNameA", , 
    .参数 hwnd, 整数型, , 
    .参数 lpClassName, 文本型, , 
    .参数 nMaxCount, 整数型, , 

.DLL命令 删除场景, 整数型, "", "DeleteDC", , 
    .参数 hdc, 整数型, , 

.DLL命令 发送消息, 整数型, "", "SendMessageA", , 
    .参数 hwnd, 整数型, , 
    .参数 wMsg, 整数型, , 
    .参数 wParam, 整数型, , 
    .参数 lParam, 整数型, , 

.DLL命令 窗口是否最大化, 整数型, "", "IsZoomed", , 
    .参数 hwnd, 整数型, , 

.DLL命令 窗口是否最小化, 整数型, "", "IsIconic", , 
    .参数 hwnd, 整数型, , 

.DLL命令 可否访问, 整数型, "", "EnableWindow", , 
    .参数 hwnd, 整数型, , 
    .参数 fEnable, 整数型, , 

.DLL命令 窗口可见性, 整数型, "", "ShowWindow", , 
    .参数 hwnd, 整数型, , 
    .参数 fEnable, 整数型, , 

.DLL命令 投递消息, 整数型, "", "PostMessageA", , 
    .参数 Hwnd, 整数型, , 
    .参数 wMsg, 整数型, , 
    .参数 wParam, 整数型, , 
    .参数 lParam, 整数型, , 

.DLL命令 热键, 整数型, "", "GetAsyncKeyState", , 
    .参数 vkey, 整数型, , 

.DLL命令 程序名, 整数型, "", "GetModuleFileNameA", , 
    .参数 hModule, 整数型, , 
    .参数 lpFileName, 文本型, , 
    .参数 nSize, 整数型, , 

.DLL命令 窗口类变量条目, 整数型, "", "SetClassLongA", , 
    .参数 hwnd, 整数型, , 
    .参数 nIndex, 整数型, , 
    .参数 dwNewLong, 整数型, , 

.窗口程序集 主程序, , , 

.程序集变量 初句柄, 整数型, , , 
.程序集变量 按下, 逻辑型, , , 
.程序集变量 画框, 逻辑型, , , 
.程序集变量 原句柄, 整数型, , , 
.程序集变量 现句柄, 整数型, , , 
.程序集变量 新鼠标句柄, 整数型, , , 
.程序集变量 位置值, 坐标, , , 
.子程序 取信息, 空白型, , 
.局部变量 标题, 文本型, , , 
.局部变量 句柄, 整数型, , , 

列表框 (取窗口句柄 (), 0)
清空 ()
赋值 (句柄, 窗口句柄 (桌面窗口 (), 5))
.判断循环首 (不等于 (句柄, 0))
    赋值 (标题, 窗口名 (句柄))
    .如果真 (窗口属性 (句柄, ., ., .))
        标题.加入项目 (句柄)
    .如果真结束
    赋值 (句柄, 窗口句柄 (句柄, 2))
.判断循环尾 ()
赋值 (., 0)
取窗口信息 (.取项目数值 (.))
获取焦点 ()
列表框 (取窗口句柄 (), 1)

.子程序 列表框, 空白型, , 
.参数 ctl, 整数型, , 
.参数 f, 整数型, , 

发送消息 (ctl, 11, f, 0)

.子程序 _主窗口_创建完毕, 空白型, , 
赋值 (., #背图)
事件转移 ()
事件转移 ()
事件转移 ()
取信息 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 sTitle, 文本型, , , 
.局部变量 Hwnd, 整数型, , , 

取信息 ()

.子程序 _列表框1_双击选择, 空白型, , 
赋值 (., 0)
赋值 (., 假)
赋值 (现句柄, .取项目数值 (.))
取窗口信息 (现句柄)
赋值 (., 1)

.子程序 取窗口信息, 空白型, , 
.参数 窗口句柄, 整数型, , 

.如果真 (等于 (窗口句柄, 0))
    信息框 (“没找到”, 0, )
    返回 ()
.如果真结束
赋值 (初句柄, 窗口句柄)
赋值 (., 窗口名 (窗口句柄))
赋值 (., .)
赋值 (., 窗口单元名 (窗口句柄))
赋值 (., .)
属性 (窗口句柄)

.子程序 窗口单元名, 文本型, , 
.参数 Hwnd, 整数型, , 

.局部变量 名, 文本型, , , 
.局部变量 长, 整数型, , , 

赋值 (名, 取空白文本 (80))
赋值 (长, 窗口类名 (Hwnd, 名, 80))
返回 (取文本左边 (名, 长))

.子程序 属性, 空白型, , 
.参数 句柄, 整数型, , 

赋值 (., 相加 (窗口是否可见 (句柄), 2))
赋值 (., 相加 (窗口是否处于活动状态 (句柄), 2))
赋值 (., 相加 (窗口是否最大化 (句柄), 2))
赋值 (., 相加 (窗口是否最小化 (句柄), 2))

.子程序 _列表框1_列表项被选择, 空白型, , 
赋值 (., 0)
赋值 (., 假)
取窗口信息 (.取项目数值 (.))

.子程序 _标签5_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 标签, 标签, , , 
.局部变量 标签标记, 整数型, , , 
.局部变量 可视性, 整数型, , , 
.局部变量 可访, 整数型, , , 

.如果 (等于 (., 3))
    .如果 (等于 (., 3))
        赋值 (可视性, 3)
    .否则
        .如果 (等于 (., 3))
            赋值 (可视性, 2)
        .否则
            赋值 (可视性, 1)
        .如果结束
        
    .如果结束
    
.否则
    赋值 (可视性, 0)
.如果结束
.如果 (等于 (., 3))
    赋值 (可访, 1)
.否则
    赋值 (可访, 0)
.如果结束
赋值 (标签, 取事件组件 ())
加属性 (初句柄, 可视性, 可访)
赋值 (标签标记, 到数值 (标签.))
.如果 (等于 (标签标记, 5))
    .如果 (等于 (标签., 2))
        窗口可见性 (初句柄, 1)
        赋值 (标签., 3)
    .否则
        窗口可见性 (初句柄, 0)
        赋值 (标签., 2)
        赋值 (., 2)
        赋值 (., 2)
    .如果结束
    
.否则
    .如果 (等于 (标签标记, 6))
        .如果 (等于 (标签., 2))
            可否访问 (初句柄, 1)
            赋值 (标签., 3)
        .否则
            可否访问 (初句柄, 0)
            赋值 (标签., 2)
        .如果结束
        
    .否则
        .如果 (等于 (标签标记, 7))
            赋值 (., 2)
            赋值 (., 3)
            .如果 (等于 (., 2))
                窗口可见性 (初句柄, 3)
                赋值 (标签., 3)
            .否则
                窗口可见性 (初句柄, 1)
                赋值 (标签., 2)
            .如果结束
            
        .否则
            赋值 (., 2)
            赋值 (., 3)
            .如果 (等于 (., 2))
                窗口可见性 (初句柄, 2)
                赋值 (标签., 3)
            .否则
                窗口可见性 (初句柄, 1)
                赋值 (标签., 2)
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束
主窗口.调整层次 (#最高层)

.子程序 _图片框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 真)
赋值 (., 0)
赋值 (., 到字节集 (“”))
赋值 (按下, 真)
写到文件 (相加 (取当前目录 (), “\rockcat.cur”), #鼠标)
赋值 (新鼠标句柄, 创建鼠标指针 (相加 (取当前目录 (), “\rockcat.cur”)))
鼠标位置 (位置值)
窗口类变量条目 (指定点窗口 (位置值.横, 位置值.纵), -12, 新鼠标句柄)

.子程序 _图片框1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (按下)
    鼠标捕获 (取窗口句柄 ())
    取控件信息 ()
.如果真结束


.子程序 取控件信息, 空白型, , 
.局部变量 pt, 坐标, , , 
.局部变量 rt, 矩形, , , 
.局部变量 窗口柄, 整数型, , , 
.局部变量 场景, 整数型, , , 
.局部变量 DrawCount, 整数型, , , 

赋值 (场景, 创建场景 (“DISPLAY”, “”, “”, 0))
鼠标位置 (pt)
赋值 (窗口柄, 指定点窗口 (pt.横, pt.纵))
.如果真 (不等于 (原句柄, 窗口柄))
    .如果真 (画框)
        窗口范围 (原句柄, rt)
        画边框 (场景, rt)
        赋值 (画框, 假)
    .如果真结束
    窗口范围 (窗口柄, rt)
    赋值 (., 窗口名 (窗口柄))
    赋值 (., .)
    赋值 (., 窗口单元名 (窗口柄))
    赋值 (., .)
    画边框 (场景, rt)
    删除场景 (场景)
    赋值 (原句柄, 窗口柄)
    赋值 (画框, 真)
.如果真结束


.子程序 _图片框1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 pt, 坐标, , , 
.局部变量 rt, 矩形, , , 
.局部变量 hDC, 整数型, , , 
.局部变量 DrawCount, 整数型, , , 

.如果真 (按下)
    鼠标位置 (pt)
    赋值 (hDC, 创建场景 (“DISPLAY”, “”, “”, 0))
    .如果真 (画框)
        窗口范围 (指定点窗口 (pt.横, pt.纵), rt)
        画边框 (hDC, rt)
        赋值 (画框, 假)
    .如果真结束
    
.如果真结束
取窗口信息 (指定点窗口 (pt.横, pt.纵))
释放鼠标捕获 ()
赋值 (., { 0 })
赋值 (按下, 假)
属性 (原句柄)
赋值 (原句柄, 0)
清除鼠标指针 (新鼠标句柄)
赋值 (., #鼠标)
赋值 (., 1)

.子程序 _时钟1_周期事件, 空白型, , 
赋值 (., 假)
赋值 (., 0)
取信息 ()

.子程序 _主窗口_将被销毁, 空白型, , 
删除文件 (相加 (取当前目录 (), “\rockcat.cur”))

.子程序 _按钮2_被单击, 空白型, , 
_主窗口_将被销毁 ()
结束 ()

.子程序 _选择夹1_子夹被改变, 空白型, , 
.如果 (不等于 (., 0))
    赋值 (., 0)
.否则
    赋值 (., 10000)
.如果结束
.如果真 (等于 (., 2))
    获取焦点 ()
.如果真结束


.子程序 加属性, 空白型, , 
.参数 句柄, 整数型, , 
.参数 可视性, 整数型, , 
.参数 可访, 整数型, , 

.局部变量 项目数, 整数型, , , 
.局部变量 存在, 逻辑型, , , 
.局部变量 行, 整数型, , , 

赋值 (项目数, 相减 (取项目数 (), 1))
赋值 (存在, 假)
.变量循环首 (0, 项目数, 1, 行)
    .如果真 (等于 (句柄, 行.取项目数值 ()))
        赋值 (存在, 真)
        跳出循环 ()
    .如果真结束
    
.变量循环尾 ()
.如果真 (等于 (存在, 真))
    返回 ()
.如果真结束
.加入项目 (., 句柄)
到文本 (可视性).加入项目 (可访)

.子程序 _按钮3_被单击, 空白型, , 
.局部变量 现项, 整数型, , , 
.局部变量 句柄, 整数型, , , 

赋值 (现项, .)
.如果真 (大于或等于 (现项, 0))
    赋值 (句柄, 现项.取项目数值 ())
    恢复 (句柄, 现项)
    现项.删除项目 ()
    现项.删除项目 ()
.如果真结束


.子程序 恢复, 空白型, , 
.参数 句柄, 整数型, , 
.参数 现项, 整数型, , 

.局部变量 可访问, 整数型, , , 
.局部变量 大小, 整数型, , , 

赋值 (大小, 到数值 (现项.取项目文本 ()))
赋值 (可访问, 现项.取项目数值 ())
可否访问 (句柄, 可访问)
窗口可见性 (句柄, 大小)

.子程序 _按钮4_被单击, 空白型, , 
.局部变量 现项, 整数型, , , 
.局部变量 句柄, 整数型, , , 
.局部变量 项目数, 整数型, , , 
.局部变量 存在, 逻辑型, , , 
.局部变量 行, 整数型, , , 

赋值 (项目数, 相减 (取项目数 (), 1))
.变量循环首 (0, 项目数, 1, 行)
    赋值 (现项, .)
    赋值 (句柄, 行.取项目数值 ())
    恢复 (句柄, 行)
.变量循环尾 ()
清空 ()
清空 ()
清空 ()

.子程序 _按钮5_被单击, 空白型, , 
投递消息 (现句柄, 16, 0, 0)
赋值 (., 0)
赋值 (., 10000)

.子程序 _按钮6_被单击, 空白型, , 
.局部变量 行数, 整数型, , , 
.局部变量 存在, 逻辑型, , , 
.局部变量 容器, 整数型, , , 

赋值 (., 0)
赋值 (设置句柄, .取项目数值 (.))
赋值 (行数, 取项目数 ())
.如果真 (大于或等于 (行数, 0))
    .变量循环首 (0, 相减 (行数, 1), 1, 容器)
        .如果真 (等于 (设置句柄, 容器.取项目数值 ()))
            赋值 (存在, 真)
            跳出循环 ()
        .如果真结束
        
    .变量循环尾 ()
.如果真结束
.如果 (等于 (存在, 假))
    赋值 (热键, “无”)
    赋值 (密码, “”)
    赋值 (热键值, 0)
.否则
    赋值 (热键, 容器.取项目文本 ())
    赋值 (密码, 容器.取项目文本 ())
    赋值 (热键值, 容器.取项目数值 ())
.如果结束
载入 (设置, , 真)
.如果真 (等于 (修改, 真))
    .如果 (大于或等于 (行数, 0))
        相加 (容器, 1).删除项目 ()
        容器.插入项目 (热键, 设置句柄)
        相加 (容器, 1).删除项目 ()
        容器.插入项目 (密码, 热键值)
    .否则
        热键.加入项目 (设置句柄)
        密码.加入项目 (热键值)
    .如果结束
    
.如果真结束
赋值 (., 10000)

.子程序 _时钟2_周期事件, 空白型, , 
.局部变量 行数, 整数型, 静态, , 
.局部变量 容器, 整数型, 静态, , 
.局部变量 柄, 整数型, 静态, , 
.局部变量 可视性, 整数型, 静态, , 

赋值 (行数, 取项目数 ())
赋值 (., 0)
.如果真 (大于或等于 (行数, 0))
    .变量循环首 (0, 相减 (行数, 1), 1, 容器)
        赋值 (键码, 容器.取项目数值 ())
        .如果真 (系统热键 (键码))
            赋值 (柄, 容器.取项目数值 ())
            赋值 (呼出, 容器.取项目文本 ())
            .如果 (等于 (窗口是否最大化 (柄), 1))
                赋值 (可视性, 3)
            .否则
                赋值 (可视性, 1)
            .如果结束
            .如果 (等于 (窗口是否可见 (柄), 0))
                .如果 (不等于 (呼出, “”))
                    载入 (密码窗口, , 真)
                .否则
                    赋值 (正确, 真)
                .如果结束
                .如果真 (等于 (正确, 真))
                    窗口可见性 (柄, 可视性)
                .如果真结束
                跳出循环 ()
            .否则
                窗口可见性 (柄, 0)
            .如果结束
            跳出循环 ()
        .如果真结束
        
    .变量循环尾 ()
.如果真结束
赋值 (., 10000)
返回 ()

.子程序 系统热键, 逻辑型, , 
.参数 键代码, 整数型, , 

返回 (小于 (热键 (键代码), 0))

.程序集 查看, , , 

.子程序 窗口名, 文本型, , 
.参数 句柄, 整数型, , 

.局部变量 长, 整数型, , , 
.局部变量 名, 文本型, , , 

赋值 (长, 标题长度 (句柄))
.如果真 (小于或等于 (长, 0))
    返回 (“”)
.如果真结束
赋值 (名, 取空白文本 (长))
赋值 (长, 窗体标题 (句柄, 名, 相加 (长, 1)))
返回 (名)

.子程序 窗口属性, 逻辑型, , 
.参数 句柄, 整数型, , 
.参数 空, 逻辑型, , 
.参数 可操作, 逻辑型, , 
.参数 其它, 逻辑型, , 

.如果真 (或者 (空, 不等于 (窗口名 (句柄), “”)))
    .如果真 (或者 (可操作, 不等于 (窗口是否可见 (句柄), 0)))
        .如果真 (或者 (其它, 等于 (窗口句柄 (句柄, 4), 0)))
            返回 (真)
        .如果真结束
        
    .如果真结束
    
.如果真结束
返回 (假)

.子程序 画边框, 空白型, , 
.参数 场景, 整数型, , 
.参数 边框, 矩形, , 

.如果真 (等于 (矩形是否为空 (边框), 0))
    填充设备场景 (场景, 边框.左, 边框.上, 相减 (边框.右, 边框.左), 2, #DSTINVERT)
    填充设备场景 (场景, 边框.左, 边框.下, 2, 负 (相减 (边框.下, 边框.上)), #DSTINVERT)
    填充设备场景 (场景, 相减 (边框.右, 2), 边框.上, 2, 相减 (边框.下, 边框.上), #DSTINVERT)
    填充设备场景 (场景, 边框.右, 相减 (边框.下, 2), 负 (相减 (边框.右, 边框.左)), 2, #DSTINVERT)
.如果真结束


.窗口程序集 启动窗口, , , 

.子程序 _时钟1_周期事件, 空白型, , 
赋值 (., 相加 (., 5))
.如果真 (大于 (., 100))
    销毁 ()
    赋值 (主窗口., 假)
    主窗口.获取焦点 ()
.如果真结束


.子程序 __启动窗口_首次激活, 空白型, , 
赋值 (_启动窗口., #背图)
载入 (主窗口, , 假)
赋值 (主窗口., 真)

.窗口程序集 设置窗口, , , 

.程序集变量 新热键, 整数型, , , 
.程序集变量 改变, 逻辑型, , , 
.程序集变量 改, 逻辑型, , , 
.子程序 _设置_创建完毕, 空白型, , 
赋值 (改变, 假)
赋值 (改, 假)
赋值 (., 热键)
赋值 (., -1)
.如果真 (不等于 (密码, “”))
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
.如果真结束


.子程序 _按钮2_被单击, 空白型, , 
赋值 (改, 真)
赋值 (., 真)
赋值 (., 真)
赋值 (., 真)
赋值 (., 真)
获取焦点 ()

.子程序 _编辑框2_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (并且 (等于 (键代码, #回车键), 等于 (., 真)))
    赋值 (., -1)
    获取焦点 ()
.如果真结束


.子程序 _编辑框1_放开某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 行, 整数型, , , 

赋值 (改变, 真)
赋值 (新热键, 键代码)
赋值 (., -1)
.变量循环首 (0, 36, 1, 行)
    .如果真 (等于 (键代码, 行.取项目数值 ()))
        赋值 (., 行.取项目文本 ())
        赋值 (., -1)
        返回 (假)
    .如果真结束
    
.变量循环尾 ()

.子程序 _按钮3_被单击, 空白型, , 
赋值 (修改, 假)
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 项目数, 整数型, , , 
.局部变量 容器, 整数型, , , 

.如果 (等于 (改, 真))
    .如果 (不等于 (., 密码))
        赋值 (错误消息, “呼出密码错误！请重新输入！”)
        载入 (错误, , 真)
        获取焦点 ()
        赋值 (., -1)
        赋值 (改, 假)
        返回 ()
    .否则
        赋值 (密码, .)
    .如果结束
    
.否则
    赋值 (密码, .)
.如果结束
.如果真 (等于 (改变, 真))
    赋值 (项目数, 主窗口.取项目数 (.))
    .如果真 (不等于 (项目数, 0))
        .变量循环首 (0, 相减 (项目数, 1), 1, 容器)
            .如果真 (并且 (等于 (., 主窗口.取项目文本 (., 容器)), 不等于 (设置句柄, 主窗口.取项目数值 (., 容器))))
                赋值 (错误消息, “该热键已被指定！请重新指定！”)
                载入 (错误, , 真)
                获取焦点 ()
                赋值 (., -1)
                返回 ()
            .如果真结束
            
        .变量循环尾 ()
    .如果真结束
    赋值 (修改, 真)
    赋值 (热键, .)
    赋值 (热键值, 新热键)
.如果真结束
销毁 ()

.窗口程序集 错误窗口, , , 

.子程序 _按钮1_被单击, 空白型, , 
销毁 ()

.窗口程序集 密码窗口, , , 

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
.如果 (等于 (., 呼出))
    赋值 (正确, 真)
.否则
    赋值 (错误消息, “呼出密码错误！请重新输入！”)
    载入 (错误, , 真)
.如果结束
销毁 ()

.子程序 _密码窗口_创建完毕, 空白型, , 
赋值 (正确, 假)


 ' 不属于任何一个程序集、类模块的函数：
