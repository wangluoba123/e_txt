 ' 文件类型：Windows模块源码

 ' 程序名称：树型框操作类
 ' 程序描述：
 ' 程序作者：大连大有吴涛易语言软件开发公司
 ' 邮政编码：116001
 ' 联系地址：
 ' 联系电话：0411-88995831
 ' 传真号码：0411-88995834
 ' 电子信箱：
 ' 主页地址：www.dywt.com.cn
 ' 版权声明：
 ' 版本号：1.2
 ' 创建号：0.0

窗口 _启动窗口
    左边 = 50
    顶边 = 50
    宽度 = 551
    高度 = 441
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.常量 , , , 
.常量 TV_FIRST, "4352", , 
.常量 TVM_CREATEDRAGIMAGE, "4370", , 创建RAG图象
.常量 TVM_DELETEITEM, "4353", , 删除项目
.常量 TVM_EDITLABELA, "4366", , 编辑标签A
.常量 TVM_ENDEDITLABELNOW, "4374", , 结束编辑新标签
.常量 TVM_ENSUREVISIBLE, "4372", , 保证显示
.常量 TVM_EXPAND, "4354", , 扩展
.常量 TVM_GETBKCOLOR, "4383", , 取背景颜色
.常量 TVM_GETCOUNT, "4357", , 取数量
.常量 TVM_GETEDITCONTROL, "4367", , 取编辑控制器
.常量 TVM_GETIMAGELIST, "4360", , 取列表图片，返回图象的句柄
.常量 TVM_GETINDENT, "4358", , 取缩进？
.常量 TVM_GETINSERTMARKCOLOR, "4390", , 取插入标志色
.常量 TVM_GETISEARCHSTRINGA, "4375", , 取搜索文本A
.常量 TVM_GETITEMA, "4364", , 取项目A，要用结构
.常量 TVM_GETITEMHEIGHT, "4380", , 取项目的距离（行距）
.常量 TVM_GETITEMRECT, "4356", , 
.常量 TVM_GETITEMSTATE, "4391", , 取项目状态
.常量 TVM_GETLINECOLOR, "4393", , 取连线颜色
.常量 TVM_GETNEXTITEM, "4362", , 取下一项目？
.常量 TVM_GETSCROLLTIME, "4386", , 取卷项目？
.常量 TVM_GETTEXTCOLOR, "4384", , 取文本颜色
.常量 TVM_GETTOOLTIPS, "4377", , 取工具提示
.常量 TVM_GETVISIBLECOUNT, "4368", , 取可视数量
.常量 TVM_GETUNICODEFORMAT, "8198", , 取UNICODE格式
.常量 TVM_HITTEST, "4369", , 点击
.常量 , , , 
.常量 TVM_INSERTITEMA, "4352", , 插入项目A
.常量 TVM_MAPACCIDTOHTREEITEM, "4394", , 
.常量 TVM_MAPHTREEITEMTOACCID, "4395", , 
.常量 TVM_SELECTITEM, "4363", , 选择项目
.常量 TVM_SETBKCOLOR, "4381", , 置背景色
.常量 TVM_SETIMAGELIST, "4361", , 设置图象列表
.常量 TVM_SETINDENT, "4359", , 设置缩进
.常量 TVM_SETINSERTMARK, "4378", , 设置插入标志
.常量 TVM_SETINSERTMARKCOLOR, "4389", , 置插入标志色
.常量 TVM_SETITEMA, "4365", , 设置项目A
.常量 TVM_SETITEMHEIGHT, "4379", , 置项目的距离（行距）
.常量 TVM_SETLINECOLOR, "4392", , 置连线颜色
.常量 TVM_SETSCROLLTIME, "4385", , 设置滚动条跳跃时的数量
.常量 TVM_SETTEXTCOLOR, "4382", , 设置文本颜色
.常量 TVM_SETTOOLTIPS, "4376", , 设置工具提示
.常量 TVM_SETUNICODEFORMAT, "8197", , 设置UNICODE格式
.常量 TVM_SORTCHILDREN, "4371", , 分类―子
.常量 TVM_SORTCHILDRENCB, "4373", , 分类―子―CB
.常量 , , , 
.常量 , , , 以下是宽字符方式的树形框操作，易语言不能使用================
.常量 TVM_EDITLABELW, "4417", , 编辑标签W
.常量 TVM_GETISEARCHSTRINGW, "4416", , 取搜索文本W
.常量 TVM_GETITEMW, "4414", , 取项目M，要用结构？
.常量 TVM_INSERTITEMW, "4402", , 插入项目W
.常量 TVM_SETITEMW, "4415", , 设置项目W
.常量 , , , 以上是宽字符方式的树形框操作，易语言不能使用================
.常量 , , , 
.常量 , , , 以下是枚举项目用的常量=============================
.常量 TVGN_CARET, "9", , 当前的项目
.常量 TVGN_CHILD, "4", , 第一个子项目
.常量 TVGN_DROPHILITE, "8", , 拖放的项目
.常量 TVGN_FIRSTVISIBLE, "5", , 第一个可视的
.常量 TVGN_LASTVISIBLE, "10", , 最后可视的
.常量 TVGN_NEXT, "1", , 下一条
.常量 TVGN_NEXTVISIBLE, "6", , 下一条可视的
.常量 TVGN_PARENT, "3", , 父
.常量 TVGN_PREVIOUS, "2", , 返回上一级
.常量 TVGN_PREVIOUSVISIBLE, "7", , 返回上一级可视的
.常量 TVGN_ROOT, "0", , 根
.常量 , , , 以上是枚举项目用的常量=============================
.常量 , , , 以下是取项目信息用的常量=============================
.常量 TVIF_CHILDREN, "64", , 是否有子
.常量 TVIF_DI_SETITEM, "4096", , 置项目
.常量 TVIF_HANDLE, "16", , 句柄
.常量 TVIF_IMAGE, "2", , 图象
.常量 TVIF_INTEGRAL, "128", , 项目的画面高度。 这一个画面高度在标准项目画面高度的增量。
.常量 TVIF_PARAM, "4", , 项目数值
.常量 TVIF_SELECTEDIMAGE, "32", , 选择图象
.常量 TVIF_STATE, "8", , 状态
.常量 TVIF_TEXT, "1", , 文本
.常量 TVIF_ALL, "39", , 全部,文本+图象+选择图象+项目数值 1+2+4+32=39
.常量 , , , 以上是取项目信息用的常量=============================
.常量 , , , 以下是取项目状态常量=============================
.常量 TVIS_BOLD, "16", , 加粗
.常量 TVIS_CUT, "4", , 
.常量 TVIS_DROPHILITED, "8", , 拖放目标
.常量 TVIS_EXPANDED, "32", , 扩展
.常量 TVIS_EXPANDEDONCE, "64", , 曾经扩展过一次
.常量 TVIS_EXPANDPARTIAL, "128", , 对项目部份扩展
.常量 TVIS_OVERLAYMASK, "3840", , 
.常量 TVIS_STATEIMAGEMASK, "61440", , Private Const TVIS_STATEIMAGEMASK As Long = &HF000&
.常量 TVIS_SELECTED, "2", , 选择
.常量 TVIS_SELECTEDA, "8192", , 选中
.常量 TVIS_NOSELECTEDA, "4096", , 没有选中
.常量 , , , 以上是取项目状态常量=============================
.常量 , , , 
.常量 , , , 以下是项目扩展常量=============================
.常量 TVE_COLLAPSE, "1", , 收缩
.常量 TVE_EXPAND, "2", , 扩展
.常量 , , , 以上是项目扩展常量=============================
.常量 , , , 以下是项目插入常量=============================
.常量 TVI_FIRST, "4294901761", , 在列表首部加入
.常量 TVI_LAST, "4294901762", , 在列表尾部插入
.常量 TVI_ROOT, "4294901760", , 在根部插入
.常量 TVI_SORT, "4294901763", , 插入项目时按字母顺序排列
.常量 , , , 以上是项目插入常量=============================
.常量 , , , 以下是公开的项目加入方式常量=============================
.常量 树形框插入项目_在根部插入, "1", 公开, 
.常量 树形框插入项目_在列表首部插入, "2", 公开, 
.常量 树形框插入项目_在列表尾部插入, "3", 公开, 
.常量 树形框插入项目_按字母顺序排列插入, "4", 公开, 
.常量 , , , 以上是公开的项目加入方式常量=============================
.常量 GWL_STYLE, "-16", , 
.常量 , , , 
.常量 TVS_HASBUTTONS, "1", , 使用加减框
.常量 TVS_HASLINES, "2", , 使用连线
.常量 TVS_LINESATROOT, "4", , 使用根部线
.常量 TVS_EDITLABELS, "8", , 允许编辑
.常量 TVS_DISABLEDRAGDROP, "16", , 禁止拖动
.常量 TVS_SHOWSELALWAYS, "32", , 始终显示选择项
.常量 TVS_RTLREADING, "64", , 右对齐？
.常量 TVS_NOTOOLTIPS, "128", , 不使用工具提示
.常量 TVS_CHECKBOXES, "256", , 使用复选框
.常量 TVS_TRACKSELECT, "512", , 使用热点跟踪
.常量 TVS_SINGLEEXPAND, "1024", , 单击打开树
.常量 TVS_INFOTIP, "2048", , 支持发送 TVN_GETINFOTIP 消息获得提示标签信息
.常量 TVS_FULLROWSELECT, "4096", , 整行选择，此风格不能与TVS_HASLINES同时使用
.常量 TVS_NOSCROLL, "8192", , 不使用滚动条
.常量 TVS_NONEVENHEIGHT, "16384", , 和 TVM_SETITEMHEIGHT 消息共同预设一个项目的高度
.常量 TVS_NOHSCROLL, "32768", , 禁止水平滚动条
.常量 , , , 
.常量 WM_SETREDRAW, "11", , 重画设置


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 6 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 3 扩展界面支持库一



 ' 所需要的模块
 ' 外部控件操作类 $外部控件操作类.ec


数据类型 树型框结构, 公开, 
    .成员 项目文本, 文本型, , , 
    .成员 图片索引, 整数型, , , 
    .成员 选中图片索引, 整数型, , , 
    .成员 项目数值, 整数型, , , 
    .成员 加粗扩展, 整数型, , , 0、普通，1、加粗，2、扩展，3、加粗+扩展
    .成员 缩进层次, 整数型, , , 

数据类型 TVITEMEX, , 
    .成员 mask, 整数型, , , 掩码
    .成员 hItem, 整数型, , , 项目句柄
    .成员 state, 整数型, , , 状态
    .成员 stateMask, 整数型, , , 状态掩码
    .成员 pszText, 文本型, 传址, , 项目文本
    .成员 cchTextMax, 整数型, , , 最长文本（系统最大允许260个字符）
    .成员 iImage, 整数型, , , 图象
    .成员 iSelectedImage, 整数型, , , 选择图象
    .成员 cChildren, 逻辑型, , , 是否有子
    .成员 lParam, 整数型, , , 项目数值
    .成员 iIntegral, 整数型, , , 项目的画面高度。 这一个画面高度在标准项目画面高度的增量。

数据类型 TVITEMEX2, , 
    .成员 mask, 整数型, , , 掩码
    .成员 hItem, 整数型, , , 项目句柄
    .成员 state, 整数型, , , 状态
    .成员 stateMask, 整数型, , , 状态掩码
    .成员 pszText, 整数型, , , 项目文本
    .成员 cchTextMax, 整数型, , , 最长文本（系统最大允许260个字符）
    .成员 iImage, 整数型, , , 图象
    .成员 iSelectedImage, 整数型, , , 选择图象
    .成员 cChildren, 逻辑型, , , 是否有子
    .成员 lParam, 整数型, , , 项目数值
    .成员 iIntegral, 整数型, , , 项目的画面高度。 这一个画面高度在标准项目画面高度的增量。

数据类型 TVINSERTSTRUCT, , 
    .成员 hParent, 整数型, , , 父
    .成员 hInsertAfter, 整数型, , , 插入标志
    .成员 mask, 整数型, , , 掩码
    .成员 hItem, 整数型, , , 项目句柄
    .成员 state, 整数型, , , 状态
    .成员 stateMask, 整数型, , , 状态掩码
    .成员 pszText, 文本型, 传址, , 项目文本
    .成员 cchTextMax, 整数型, , , 最长文本（系统最大允许260个字符）
    .成员 iImage, 整数型, , , 图象
    .成员 iSelectedImage, 整数型, , , 选择图象
    .成员 cChildren, 逻辑型, , , 是否有子
    .成员 lParam, 整数型, , , 项目数值
    .成员 iIntegral, 整数型, , , 项目的画面高度。 这一个画面高度在标准项目画面高度的增量。

数据类型 TVINSERTSTRUCT2, , 
    .成员 hParent, 整数型, , , 父
    .成员 hInsertAfter, 整数型, , , 插入标志
    .成员 mask, 整数型, , , 掩码
    .成员 hItem, 整数型, , , 项目句柄
    .成员 state, 整数型, , , 状态
    .成员 stateMask, 整数型, , , 状态掩码
    .成员 pszText, 整数型, , , 项目文本
    .成员 cchTextMax, 整数型, , , 最长文本（系统最大允许260个字符）
    .成员 iImage, 整数型, , , 图象
    .成员 iSelectedImage, 整数型, , , 选择图象
    .成员 cChildren, 逻辑型, , , 是否有子
    .成员 lParam, 整数型, , , 项目数值
    .成员 iIntegral, 整数型, , , 项目的画面高度。 这一个画面高度在标准项目画面高度的增量。

数据类型 项目数据, 公开, 
    .成员 项目文本, 文本型, , , 项目文本
    .成员 图片索引, 整数型, , , 图象
    .成员 选中图片索引, 整数型, , , 选择图象
    .成员 项目数值, 整数型, , , 项目数值

数据类型 树型框结构A, , 
    .成员 文本, 字节集, , , 
    .成员 图片索引, 整数型, , , 
    .成员 选中图片索引, 整数型, , , 
    .成员 项目数值, 整数型, , , 
    .成员 加粗扩展, 整数型, , , 0、普通，1、加粗，2、扩展，3、加粗+扩展
    .成员 缩进层次, 整数型, , , 


.DLL命令 取数据地址, 整数型, "kernel32.dll", "lstrcpyn", , 
    .参数 目标, 树型框结构, 传址, 
    .参数 源, 树型框结构, 传址, 
    .参数 长度, 整数型, , 

.DLL命令 取数据地址2, 整数型, "kernel32.dll", "lstrcpyn", , 
    .参数 目标, 字节型, 传址, 
    .参数 源, 字节型, 传址, 
    .参数 长度, 整数型, , 

.DLL命令 取数据地址3, 整数型, "kernel32.dll", "lstrcpyn", , 
    .参数 目标, 文本型, 传址, 
    .参数 源, 文本型, 传址, 
    .参数 长度, 整数型, , 

.DLL命令 取变量地址_TVITEMEX, 整数型, "kernel32.dll", "lstrcpyn", , 
    .参数 目标, TVITEMEX, 传址, 
    .参数 源, TVITEMEX, 传址, 
    .参数 长度, 整数型, , 

.DLL命令 取变量地址_TVINSERTSTRUCT, 整数型, "kernel32.dll", "lstrcpyn", , 
    .参数 目标, TVINSERTSTRUCT, 传址, 
    .参数 源, TVINSERTSTRUCT, 传址, 
    .参数 长度, 整数型, , 

.DLL命令 取变量地址_TVITEMEX2, 整数型, "kernel32.dll", "lstrcpyn", , 
    .参数 目标, TVITEMEX2, 传址, 
    .参数 源, TVITEMEX2, 传址, 
    .参数 长度, 整数型, , 

.DLL命令 取变量地址_TVINSERTSTRUCT2, 整数型, "kernel32.dll", "lstrcpyn", , 
    .参数 目标, TVINSERTSTRUCT2, 传址, 
    .参数 源, TVINSERTSTRUCT2, 传址, 
    .参数 长度, 整数型, , 

.DLL命令 设置窗口信息, 整数型, "user32.dll", "SetWindowLongA", , 
    .参数 hwnd, 整数型, , 
    .参数 nIndex, 整数型, , 
    .参数 dwNewLong, 整数型, , 

.DLL命令 取窗口信息, 整数型, "user32.dll", "GetWindowLongA", , 
    .参数 hwnd, 整数型, , 
    .参数 nIndex, 整数型, , 

.DLL命令 发送消息1, 整数型, "user32.dll", "SendMessageA", , 
    .参数 hwnd, 整数型, , 
    .参数 wMsg, 整数型, , 
    .参数 wParam, 整数型, , 
    .参数 lParam, 整数型, , 类型为通用型，请在调试时调整其类型

.DLL命令 拷贝内存, 整数型, "kernel32.dll", "RtlMoveMemory", , 
    .参数 目标地址, 整数型, , Any
    .参数 源地址, 整数型, , Any
    .参数 数据长度, 整数型, , 

.DLL命令 取窗口类名称, 整数型, "user32", "GetClassNameA", , 
    .参数 hwnd, 整数型, , 
    .参数 lpClassName, 文本型, , 
    .参数 nMaxCount, 整数型, , 

.程序集 启动程序集, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码
_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。
载入 (_启动窗口, , 真)


.类模块 树型框操作基类, , , 

.程序集变量 集_句柄组, 整数型, , "0", 
.程序集变量 集_单一项目, TVITEMEX, , , 
.程序集变量 集_单一外部项目, TVITEMEX2, , , 
.程序集变量 集_外部进程句柄, 整数型, , , 
.程序集变量 集_外部数据地址1, 整数型, , , 
.程序集变量 集_外部数据地址2, 整数型, , , 
.程序集变量 集_项目地址, 整数型, , , 
.程序集变量 集_树型框句柄, 整数型, , , 
.程序集变量 外部控件操作, 外部控件操作类, , , 
.程序集变量 集_外部控件, 逻辑型, , , 
.程序集变量 集_自动更新, 逻辑型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
赋值 (集_单一项目.cchTextMax, 260)
赋值 (集_单一外部项目.cchTextMax, 260)
赋值 (集_自动更新, 真)

.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用
清除数组 (集_句柄组)

.子程序 _初始化类A, 逻辑型, , 
.参数 目标树形框句柄, 整数型, , 

.判断开始 (等于 (到大写 (取类名 (目标树形框句柄)), “SYSTREEVIEW32”))
    赋值 (集_树型框句柄, 目标树形框句柄)
    遍历句柄 ()
    返回 (真)
.默认
    返回 (假)
.判断结束


.子程序 取类名, 文本型, , 
.参数 窗口句柄, 整数型, , 

.局部变量 缓冲区, 文本型, , , 

赋值 (缓冲区, 取空白文本 (256))
取窗口类名称 (窗口句柄, 缓冲区, 256)
返回 (删首尾空 (缓冲区))

.子程序 更新数据1, 空白型, , 
遍历句柄 ()

.子程序 取数值变量地址, 整数型, , 
.参数 数值变量, 字节型, 参考, 

返回 (取数据地址2 (数值变量, 数值变量, 0))

.子程序 数据_取项目数, 整数型, 公开, 返回树型框中所有项目的数目。
返回 (发送消息1 (集_树型框句柄, #TVM_GETCOUNT, 0, 0))

.子程序 数据_取缩进层次, 整数型, 公开, 返回指定项目所处缩进层次，层次值从1开始。如果未找到指定项目，返回 0 。
.参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

.局部变量 层次, 空白型, , , 
.局部变量 父项目, 空白型, , , 


.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
.判断开始 (或者 (大于 (相加 (项目索引, 1), 取数组成员数 (集_句柄组)), 小于 (项目索引, 0)))
    返回 (0)
.默认
    赋值 (层次, 1)
    赋值 (父项目, 发送消息1 (集_树型框句柄, #TVM_GETNEXTITEM, #TVGN_PARENT, 集_句柄组 [相加 (项目索引, 1)]))
    .判断循环首 (不等于 (父项目, 0))
        赋值 (父项目, 发送消息1 (集_树型框句柄, #TVM_GETNEXTITEM, #TVGN_PARENT, 父项目))
        赋值 (层次, 相加 (层次, 1))
    .判断循环尾 ()
    返回 (层次)
.判断结束


.子程序 数据_取项目文本, 文本型, 公开, 返回指定项目的文本。如果该项目不存在，将返回空文本。
.参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

.局部变量 缓冲区, 文本型, , , 

.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
.判断开始 (或者 (大于 (相加 (项目索引, 1), 取数组成员数 (集_句柄组)), 小于 (项目索引, 0)))
    返回 (“”)
.默认
    .判断开始 (集_外部控件)
        赋值 (集_外部进程句柄, 外部控件操作.打开进程 (集_树型框句柄))
        赋值 (集_外部数据地址1, 外部控件操作.分配外部指针 (集_外部进程句柄, 40))
        赋值 (集_外部数据地址2, 外部控件操作.分配外部指针 (集_外部进程句柄, 260))
        赋值 (集_单一外部项目.pszText, 集_外部数据地址2)
        赋值 (集_单一外部项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一外部项目.mask, #TVIF_TEXT)
        赋值 (集_项目地址, 取变量地址_TVITEMEX2 (集_单一外部项目, 集_单一外部项目, 0))
        外部控件操作.写进程内存 (集_外部进程句柄, 集_外部数据地址1, 集_项目地址, 40)
        发送消息1 (集_树型框句柄, #TVM_GETITEMA, 0, 集_外部数据地址1)
        赋值 (缓冲区, 到文本 (外部控件操作.读外部指针数据 (集_外部进程句柄, 集_外部数据地址2, 260)))
        外部控件操作.销毁外部指针 (集_外部进程句柄, 集_外部数据地址2)
        外部控件操作.销毁外部指针 (集_外部进程句柄, 集_外部数据地址1)
        外部控件操作.结束操作 (集_外部进程句柄)
        返回 (缓冲区)
    .默认
        赋值 (集_单一项目.pszText, 取空白文本 (260))
        赋值 (集_单一项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一项目.mask, #TVIF_TEXT)
        赋值 (集_项目地址, 取变量地址_TVITEMEX (集_单一项目, 集_单一项目, 0))
        发送消息1 (集_树型框句柄, #TVM_GETITEMA, 0, 集_项目地址)
        返回 (删首尾空 (集_单一项目.pszText))
    .判断结束
    
.判断结束


.子程序 数据_取图片, 整数型, 公开, 返回指定项目的图片索引。如果该项目不存在，将返回 -1 
.参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

.局部变量 数据, 字节集, , , 

.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
.判断开始 (或者 (大于 (相加 (项目索引, 1), 取数组成员数 (集_句柄组)), 小于 (项目索引, 0)))
    返回 (-1)
.默认
    .判断开始 (集_外部控件)
        赋值 (集_外部进程句柄, 外部控件操作.打开进程 (集_树型框句柄))
        赋值 (集_外部数据地址1, 外部控件操作.分配外部指针 (集_外部进程句柄, 40))
        赋值 (集_单一外部项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一外部项目.mask, #TVIF_IMAGE)
        赋值 (集_项目地址, 取变量地址_TVITEMEX2 (集_单一外部项目, 集_单一外部项目, 0))
        外部控件操作.写进程内存 (集_外部进程句柄, 集_外部数据地址1, 集_项目地址, 40)
        发送消息1 (集_树型框句柄, #TVM_GETITEMA, 0, 集_外部数据地址1)
        赋值 (数据, 外部控件操作.读外部指针数据 (集_外部进程句柄, 集_外部数据地址1, 40))
        外部控件操作.销毁外部指针 (集_外部进程句柄, 集_外部数据地址1)
        外部控件操作.结束操作 (集_外部进程句柄)
        写到内存 (数据, 集_项目地址, 40)
        返回 (集_单一外部项目.iImage)
    .默认
        赋值 (集_单一项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一项目.mask, #TVIF_IMAGE)
        赋值 (集_项目地址, 取变量地址_TVITEMEX (集_单一项目, 集_单一项目, 0))
        发送消息1 (集_树型框句柄, #TVM_GETITEMA, 0, 集_项目地址)
        返回 (集_单一项目.iImage)
    .判断结束
    
.判断结束


.子程序 数据_取选中图片, 整数型, 公开, 返回指定项目被选中后的图片索引。如果该项目不存在，将返回 -1 。
.参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

.局部变量 数据, 字节集, , , 

.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
.判断开始 (或者 (大于 (相加 (项目索引, 1), 取数组成员数 (集_句柄组)), 小于 (项目索引, 0)))
    返回 (-1)
.默认
    .判断开始 (集_外部控件)
        赋值 (集_外部进程句柄, 外部控件操作.打开进程 (集_树型框句柄))
        赋值 (集_外部数据地址1, 外部控件操作.分配外部指针 (集_外部进程句柄, 40))
        赋值 (集_单一外部项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一外部项目.mask, #TVIF_SELECTEDIMAGE)
        赋值 (集_项目地址, 取变量地址_TVITEMEX2 (集_单一外部项目, 集_单一外部项目, 0))
        外部控件操作.写进程内存 (集_外部进程句柄, 集_外部数据地址1, 集_项目地址, 40)
        发送消息1 (集_树型框句柄, #TVM_GETITEMA, 0, 集_外部数据地址1)
        赋值 (数据, 外部控件操作.读外部指针数据 (集_外部进程句柄, 集_外部数据地址1, 40))
        外部控件操作.销毁外部指针 (集_外部进程句柄, 集_外部数据地址1)
        外部控件操作.结束操作 (集_外部进程句柄)
        写到内存 (数据, 集_项目地址, 40)
        返回 (集_单一外部项目.iSelectedImage)
    .默认
        赋值 (集_单一项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一项目.mask, #TVIF_SELECTEDIMAGE)
        赋值 (集_项目地址, 取变量地址_TVITEMEX (集_单一项目, 集_单一项目, 0))
        发送消息1 (集_树型框句柄, #TVM_GETITEMA, 0, 集_项目地址)
        返回 (集_单一项目.iSelectedImage)
    .判断结束
    
.判断结束


.子程序 数据_取项目数值, 整数型, 公开, 返回与指定项目相关联的数值。如果该项目不存在，将返回 0 。
.参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

.局部变量 数据, 字节集, , , 

.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
.判断开始 (或者 (大于 (相加 (项目索引, 1), 取数组成员数 (集_句柄组)), 小于 (项目索引, 0)))
    返回 (0)
.默认
    
    .判断开始 (集_外部控件)
        赋值 (集_外部进程句柄, 外部控件操作.打开进程 (集_树型框句柄))
        赋值 (集_外部数据地址1, 外部控件操作.分配外部指针 (集_外部进程句柄, 40))
        赋值 (集_单一外部项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一外部项目.mask, #TVIF_PARAM)
        赋值 (集_项目地址, 取变量地址_TVITEMEX2 (集_单一外部项目, 集_单一外部项目, 0))
        外部控件操作.写进程内存 (集_外部进程句柄, 集_外部数据地址1, 集_项目地址, 40)
        发送消息1 (集_树型框句柄, #TVM_GETITEMA, 0, 集_外部数据地址1)
        赋值 (数据, 外部控件操作.读外部指针数据 (集_外部进程句柄, 集_外部数据地址1, 40))
        外部控件操作.销毁外部指针 (集_外部进程句柄, 集_外部数据地址1)
        外部控件操作.结束操作 (集_外部进程句柄)
        写到内存 (数据, 集_项目地址, 40)
        返回 (集_单一外部项目.lParam)
    .默认
        赋值 (集_单一项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一项目.mask, #TVIF_PARAM)
        赋值 (集_项目地址, 取变量地址_TVITEMEX (集_单一项目, 集_单一项目, 0))
        发送消息1 (集_树型框句柄, #TVM_GETITEMA, 0, 集_项目地址)
        返回 (集_单一项目.lParam)
    .判断结束
    
.判断结束


.子程序 数据_置图片, 逻辑型, 公开, 设置在指定项目首部所显示图片的索引。成功返回真，失败返回假。
.参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 图片索引, 整数型, , 图片索引用于指定图片组属性中的某张图片，从 0 开始。
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

.局部变量 当前项目, 整数型, , , 

 ' 参数<1>的名称为“项目索引”，类型为“整数型（int）”。0 为项目一，1 为项目二，如此类推。
 ' 参数<2>的名称为“图片索引”，类型为“整数型（int）”。图片索引用于指定图片组属性中的某张图片，从 0 开始。
.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
.判断开始 (或者 (大于 (相加 (项目索引, 1), 取数组成员数 (集_句柄组)), 小于 (项目索引, 0)))
    返回 (假)
.默认
    
    .判断开始 (集_外部控件)
        赋值 (集_外部进程句柄, 外部控件操作.打开进程 (集_树型框句柄))
        赋值 (集_外部数据地址1, 外部控件操作.分配外部指针 (集_外部进程句柄, 40))
        赋值 (集_单一外部项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一外部项目.mask, #TVIF_IMAGE)
        赋值 (集_单一外部项目.iImage, 图片索引)
        赋值 (集_项目地址, 取变量地址_TVITEMEX2 (集_单一外部项目, 集_单一外部项目, 0))
        外部控件操作.写进程内存 (集_外部进程句柄, 集_外部数据地址1, 集_项目地址, 40)
        赋值 (当前项目, 发送消息1 (集_树型框句柄, #TVM_SETITEMA, 0, 集_外部数据地址1))
        外部控件操作.销毁外部指针 (集_外部进程句柄, 集_外部数据地址1)
        外部控件操作.结束操作 (集_外部进程句柄)
         ' 写到内存 (TEMP, 集_项目地址, 40)
        返回 (不等于 (当前项目, 0))
    .默认
        赋值 (集_单一项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一项目.mask, #TVIF_IMAGE)
        赋值 (集_单一项目.iImage, 图片索引)
        赋值 (集_项目地址, 取变量地址_TVITEMEX (集_单一项目, 集_单一项目, 0))
        返回 (不等于 (发送消息1 (集_树型框句柄, #TVM_SETITEMA, 0, 集_项目地址), 0))
        
    .判断结束
    
    
.判断结束


.子程序 数据_置选中图片, 逻辑型, 公开, 设置指定项目被选中后所显示图片的索引。成功返回真，失败返回假。
.参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 图片索引, 整数型, , 图片索引用于指定图片组属性中的某张图片，从 0 开始。
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

.局部变量 当前项目, 整数型, , , 

.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
.判断开始 (或者 (大于 (相加 (项目索引, 1), 取数组成员数 (集_句柄组)), 小于 (项目索引, 0)))
    返回 (假)
.默认
    
    .判断开始 (集_外部控件)
        赋值 (集_外部进程句柄, 外部控件操作.打开进程 (集_树型框句柄))
        赋值 (集_外部数据地址1, 外部控件操作.分配外部指针 (集_外部进程句柄, 40))
        赋值 (集_单一外部项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一外部项目.mask, #TVIF_SELECTEDIMAGE)
        赋值 (集_单一外部项目.iSelectedImage, 图片索引)
        赋值 (集_项目地址, 取变量地址_TVITEMEX2 (集_单一外部项目, 集_单一外部项目, 0))
        外部控件操作.写进程内存 (集_外部进程句柄, 集_外部数据地址1, 集_项目地址, 40)
        赋值 (当前项目, 发送消息1 (集_树型框句柄, #TVM_SETITEMA, 0, 集_外部数据地址1))
        外部控件操作.销毁外部指针 (集_外部进程句柄, 集_外部数据地址1)
        外部控件操作.结束操作 (集_外部进程句柄)
         ' 写到内存 (TEMP, 集_项目地址, 40)
        返回 (不等于 (当前项目, 0))
    .默认
        
        赋值 (集_单一项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一项目.mask, #TVIF_SELECTEDIMAGE)
        赋值 (集_单一项目.iSelectedImage, 图片索引)
        赋值 (集_项目地址, 取变量地址_TVITEMEX (集_单一项目, 集_单一项目, 0))
        返回 (不等于 (发送消息1 (集_树型框句柄, #TVM_SETITEMA, 0, 集_项目地址), 0))
        
    .判断结束
    
    
.判断结束


.子程序 数据_置项目数值, 逻辑型, 公开, 设置与指定项目相关联的数值。成功返回真，失败返回假。
.参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 欲置入的项目数值, 整数型, 可空, 可以被省略。该数值与指定项目相关联。如果本参数被省略，默认值为 0 。
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

.局部变量 当前项目, 整数型, , , 

.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
.判断开始 (并且 (小于或等于 (相加 (项目索引, 1), 取数组成员数 (集_句柄组)), 大于或等于 (项目索引, 0)))
    .判断开始 (集_外部控件)
        赋值 (集_外部进程句柄, 外部控件操作.打开进程 (集_树型框句柄))
        赋值 (集_外部数据地址1, 外部控件操作.分配外部指针 (集_外部进程句柄, 40))
        赋值 (集_单一外部项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一外部项目.mask, #TVIF_PARAM)
        赋值 (集_单一外部项目.lParam, 欲置入的项目数值)
        赋值 (集_项目地址, 取变量地址_TVITEMEX2 (集_单一外部项目, 集_单一外部项目, 0))
        外部控件操作.写进程内存 (集_外部进程句柄, 集_外部数据地址1, 集_项目地址, 40)
        赋值 (当前项目, 发送消息1 (集_树型框句柄, #TVM_SETITEMA, 0, 集_外部数据地址1))
        外部控件操作.销毁外部指针 (集_外部进程句柄, 集_外部数据地址1)
        外部控件操作.结束操作 (集_外部进程句柄)
         ' 写到内存 (TEMP, 集_项目地址, 40)
        返回 (不等于 (当前项目, 0))
    .默认
        赋值 (集_单一项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一项目.mask, #TVIF_PARAM)
        赋值 (集_单一项目.lParam, 欲置入的项目数值)
        赋值 (集_项目地址, 取变量地址_TVITEMEX (集_单一项目, 集_单一项目, 0))
        返回 (不等于 (发送消息1 (集_树型框句柄, #TVM_SETITEMA, 0, 集_项目地址), 0))
    .判断结束
    
.默认
    返回 (假)
.判断结束


.子程序 数据_置项目文本, 逻辑型, 公开, 设置指定项目的文本。成功返回真，失败返回假。
.参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 欲置入的项目文本, 文本型, , 
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

.局部变量 当前项目, 整数型, , , 

.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
.判断开始 (并且 (小于或等于 (相加 (项目索引, 1), 取数组成员数 (集_句柄组)), 大于或等于 (项目索引, 0)))
    .判断开始 (集_外部控件)
        赋值 (集_外部进程句柄, 外部控件操作.打开进程 (集_树型框句柄))
        赋值 (集_外部数据地址1, 外部控件操作.分配外部指针 (集_外部进程句柄, 40))
        赋值 (集_外部数据地址2, 外部控件操作.分配外部指针 (集_外部进程句柄, 相加 (取文本长度 (欲置入的项目文本), 1)))
        赋值 (集_单一外部项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一外部项目.mask, #TVIF_TEXT)
        赋值 (集_单一外部项目.pszText, 集_外部数据地址2)
        赋值 (集_项目地址, 取变量地址_TVITEMEX2 (集_单一外部项目, 集_单一外部项目, 0))
        外部控件操作.写进程内存 (集_外部进程句柄, 集_外部数据地址1, 集_项目地址, 40)
        赋值 (当前项目, 取数据地址3 (欲置入的项目文本, 欲置入的项目文本, 0))
        外部控件操作.写进程内存 (集_外部进程句柄, 集_外部数据地址2, 当前项目, 相加 (取文本长度 (欲置入的项目文本), 1))
        赋值 (当前项目, 发送消息1 (集_树型框句柄, #TVM_SETITEMA, 0, 集_外部数据地址1))
        外部控件操作.销毁外部指针 (集_外部进程句柄, 集_外部数据地址2)
        外部控件操作.销毁外部指针 (集_外部进程句柄, 集_外部数据地址1)
        外部控件操作.结束操作 (集_外部进程句柄)
         ' 写到内存 (TEMP, 集_项目地址, 40)
        返回 (不等于 (当前项目, 0))
    .默认
        赋值 (集_单一项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一项目.mask, #TVIF_TEXT)
        赋值 (集_单一项目.pszText, 欲置入的项目文本)
        赋值 (集_项目地址, 取变量地址_TVITEMEX (集_单一项目, 集_单一项目, 0))
        返回 (不等于 (发送消息1 (集_树型框句柄, #TVM_SETITEMA, 0, 集_项目地址), 0))
    .判断结束
    
.默认
    返回 (假)
.判断结束


.子程序 动作_保证显示, 空白型, 公开, 
.参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
.如果真 (并且 (小于或等于 (相加 (项目索引, 1), 取数组成员数 (集_句柄组)), 大于或等于 (项目索引, 0)))
    发送消息1 (集_树型框句柄, #TVM_ENSUREVISIBLE, 0, 集_句柄组 [相加 (项目索引, 1)])
.如果真结束


.子程序 状态_扩展, 空白型, 公开, 将指打开指定项目的下属分枝。
.参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
.如果真 (并且 (小于或等于 (相加 (项目索引, 1), 取数组成员数 (集_句柄组)), 大于或等于 (项目索引, 0)))
    发送消息1 (集_树型框句柄, #TVM_EXPAND, #TVE_EXPAND, 集_句柄组 [相加 (项目索引, 1)])
.如果真结束


.子程序 状态_收缩, 空白型, 公开, 缩回指定项目的下属分枝。
.参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
.如果真 (并且 (小于或等于 (相加 (项目索引, 1), 取数组成员数 (集_句柄组)), 大于或等于 (项目索引, 0)))
    发送消息1 (集_树型框句柄, #TVM_EXPAND, #TVE_COLLAPSE, 集_句柄组 [相加 (项目索引, 1)])
.如果真结束


.子程序 数据_加入项目_API方式加入, 整数型, 公开, 将单个或一批项目加入到树型框中，如果仅加入一个项目，成功返回加入后该项目所处的位置，失败返回 -1 。如果成批加入项目，成功返回 0 ，失败返回 -1 。成批加入项目可以用作一次性快速加入大量项目到树型框中。
.参数 父项目索引, 整数型, 可空, 可以被省略。指定欲加入项目所处的父项目，0 为项目一，1 为项目二，如此类推。如果没有父项目（即欲加入项目为顶层项目），请提供值 -1 。如果本参数被省略，默认值为 -1 。
.参数 项目数据1, 项目数据, 可空, 用于只加入一个项目，如欲批量加入，请留空
.参数 项目数据2, 项目数据, 可空 数组, 用于批量加入项目
.参数 加入方式, 整数型, 可空, 可以被省略。默认为 #树形框插入项目_在列表尾部插入
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。
.参数 是否使用高速插入, 逻辑型, 可空, 可以被省略。当使用高速插入时，最高可提速5倍。默认为真高速加入。

.局部变量 成员数, 整数型, , , 
.局部变量 计次, 空白型, , , 
.局部变量 数据地址, 整数型, , , 
.局部变量 插入项目, TVINSERTSTRUCT, , , 
.局部变量 插入项目2, TVINSERTSTRUCT2, , , 
.局部变量 当前项目, 整数型, , , 
.局部变量 空白数据, 字节集, , , 

.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
.如果真 (并且 (等于 (是否为空 (父项目索引), 假), 小于或等于 (相加 (父项目索引, 1), 取数组成员数 (集_句柄组)), 大于或等于 (父项目索引, 0)))
    连续赋值 (集_句柄组 [相加 (父项目索引, 1)], 插入项目.hParent, 插入项目2.hParent)
.如果真结束
.如果真 (或者 (是否为空 (加入方式), 大于 (加入方式, 4), 小于 (加入方式, 1)))
    赋值 (加入方式, #树形框插入项目_在列表尾部插入)
.如果真结束
.判断开始 (等于 (是否为空 (项目数据1), 假))
    .判断开始 (集_外部控件)
        赋值 (插入项目2.hInsertAfter, 多项选择 (加入方式, #TVI_ROOT, #TVI_FIRST, #TVI_LAST, #TVI_SORT))
        赋值 (插入项目2.iImage, 项目数据1.图片索引)
        赋值 (插入项目2.iSelectedImage, 项目数据1.选中图片索引)
        赋值 (插入项目2.lParam, 项目数据1.项目数值)
        赋值 (插入项目2.mask, #TVIF_ALL)
        赋值 (集_外部进程句柄, 外部控件操作.打开进程 (集_树型框句柄))
        赋值 (集_外部数据地址1, 外部控件操作.分配外部指针 (集_外部进程句柄, 52))
        赋值 (集_外部数据地址2, 外部控件操作.分配外部指针 (集_外部进程句柄, 相加 (取文本长度 (项目数据1.项目文本), 1)))
        赋值 (插入项目2.pszText, 集_外部数据地址2)
        赋值 (集_项目地址, 取变量地址_TVINSERTSTRUCT2 (插入项目2, 插入项目2, 0))
        外部控件操作.写进程内存 (集_外部进程句柄, 集_外部数据地址1, 集_项目地址, 52)
        赋值 (当前项目, 取数据地址3 (项目数据1.项目文本, 项目数据1.项目文本, 0))
        外部控件操作.写进程内存 (集_外部进程句柄, 集_外部数据地址2, 当前项目, 相加 (取文本长度 (项目数据1.项目文本), 1))
        赋值 (当前项目, 发送消息1 (集_树型框句柄, #TVM_INSERTITEMA, 0, 集_外部数据地址1))
        外部控件操作.销毁外部指针 (集_外部进程句柄, 集_外部数据地址2)
        外部控件操作.销毁外部指针 (集_外部进程句柄, 集_外部数据地址1)
        外部控件操作.结束操作 (集_外部进程句柄)
        返回 (当前项目)
    .默认
        赋值 (插入项目.hInsertAfter, 多项选择 (加入方式, #TVI_ROOT, #TVI_FIRST, #TVI_LAST, #TVI_SORT))
        赋值 (插入项目.pszText, 项目数据1.项目文本)
        赋值 (插入项目.iImage, 项目数据1.图片索引)
        赋值 (插入项目.iSelectedImage, 项目数据1.选中图片索引)
        赋值 (插入项目.lParam, 项目数据1.项目数值)
        赋值 (插入项目.mask, #TVIF_ALL)
        赋值 (数据地址, 取变量地址_TVINSERTSTRUCT (插入项目, 插入项目, 0))
        返回 (发送消息1 (集_树型框句柄, #TVM_INSERTITEMA, 0, 数据地址))
    .判断结束
    
.判断 (等于 (是否为空 (项目数据2), 假))
    .如果真 (或者 (是否为空 (是否使用高速插入), 是否使用高速插入))
        发送消息1 (集_树型框句柄, #WM_SETREDRAW, 0, 0)
    .如果真结束
    赋值 (成员数, 取数组成员数 (项目数据2))
    .判断开始 (集_外部控件)
        赋值 (空白数据, 取空白字节集 (260))
        赋值 (插入项目2.hInsertAfter, 多项选择 (加入方式, #TVI_ROOT, #TVI_FIRST, #TVI_LAST, #TVI_SORT))
        赋值 (插入项目2.mask, #TVIF_ALL)
        赋值 (集_外部进程句柄, 外部控件操作.打开进程 (集_树型框句柄))
        赋值 (集_外部数据地址1, 外部控件操作.分配外部指针 (集_外部进程句柄, 52))
        赋值 (集_外部数据地址2, 外部控件操作.分配外部指针 (集_外部进程句柄, 260))
        赋值 (插入项目2.pszText, 集_外部数据地址2)
        赋值 (集_项目地址, 取变量地址_TVINSERTSTRUCT2 (插入项目2, 插入项目2, 0))
        .判断开始 (等于 (加入方式, 2))
            赋值 (计次, 成员数)
            .判断循环首 (大于 (计次, 0))
                 ' 插入项目.pszText ＝ 项目数据2 [I].项目文本
                赋值 (插入项目2.iImage, 项目数据2 [计次], 图片索引)
                赋值 (插入项目2.iSelectedImage, 项目数据2 [计次], 选中图片索引)
                赋值 (插入项目2.lParam, 项目数据2 [计次], 项目数值)
                外部控件操作.写进程内存 (集_外部进程句柄, 集_外部数据地址1, 集_项目地址, 52)
                赋值 (当前项目, 取数据地址3 (项目数据2 [计次], 项目文本, 项目数据2 [计次], 项目文本, 0))
                外部控件操作.写进程内存 (集_外部进程句柄, 集_外部数据地址2, 当前项目, 相加 (取文本长度 (项目数据2 [计次], 项目文本), 1))
                发送消息1 (集_树型框句柄, #TVM_INSERTITEMA, 0, 集_外部数据地址1)
                赋值 (当前项目, 取数据地址2 (空白数据 [1], 空白数据 [1], 0))
                外部控件操作.写进程内存 (集_外部进程句柄, 集_外部数据地址2, 当前项目, 260)
                赋值 (计次, 相减 (计次, 1))
            .判断循环尾 ()
        .默认
            .判断循环首 (小于 (计次, 成员数))
                赋值 (计次, 相加 (计次, 1))
                赋值 (插入项目2.iImage, 项目数据2 [计次], 图片索引)
                赋值 (插入项目2.iSelectedImage, 项目数据2 [计次], 选中图片索引)
                赋值 (插入项目2.lParam, 项目数据2 [计次], 项目数值)
                外部控件操作.写进程内存 (集_外部进程句柄, 集_外部数据地址1, 集_项目地址, 52)
                赋值 (当前项目, 取数据地址3 (项目数据2 [计次], 项目文本, 项目数据2 [计次], 项目文本, 0))
                外部控件操作.写进程内存 (集_外部进程句柄, 集_外部数据地址2, 当前项目, 相加 (取文本长度 (项目数据2 [计次], 项目文本), 1))
                发送消息1 (集_树型框句柄, #TVM_INSERTITEMA, 0, 集_外部数据地址1)
                赋值 (当前项目, 取数据地址2 (空白数据 [1], 空白数据 [1], 0))
                外部控件操作.写进程内存 (集_外部进程句柄, 集_外部数据地址2, 当前项目, 260)
            .判断循环尾 ()
            
        .判断结束
        外部控件操作.销毁外部指针 (集_外部进程句柄, 集_外部数据地址2)
        外部控件操作.销毁外部指针 (集_外部进程句柄, 集_外部数据地址1)
        外部控件操作.结束操作 (集_外部进程句柄)
        
    .默认
        赋值 (插入项目.hInsertAfter, 多项选择 (加入方式, #TVI_ROOT, #TVI_FIRST, #TVI_LAST, #TVI_SORT))
        赋值 (插入项目.mask, #TVIF_ALL)
        赋值 (数据地址, 取变量地址_TVINSERTSTRUCT (插入项目, 插入项目, 0))
        .判断开始 (等于 (加入方式, 2))
            赋值 (计次, 成员数)
            .判断循环首 (大于 (计次, 0))
                赋值 (插入项目.pszText, 项目数据2 [计次], 项目文本)
                赋值 (插入项目.iImage, 项目数据2 [计次], 图片索引)
                赋值 (插入项目.iSelectedImage, 项目数据2 [计次], 选中图片索引)
                赋值 (插入项目.lParam, 项目数据2 [计次], 项目数值)
                发送消息1 (集_树型框句柄, #TVM_INSERTITEMA, 0, 数据地址)
                赋值 (计次, 相减 (计次, 1))
            .判断循环尾 ()
        .默认
            .判断循环首 (小于 (计次, 成员数))
                赋值 (计次, 相加 (计次, 1))
                赋值 (插入项目.pszText, 项目数据2 [计次], 项目文本)
                赋值 (插入项目.iImage, 项目数据2 [计次], 图片索引)
                赋值 (插入项目.iSelectedImage, 项目数据2 [计次], 选中图片索引)
                赋值 (插入项目.lParam, 项目数据2 [计次], 项目数值)
                发送消息1 (集_树型框句柄, #TVM_INSERTITEMA, 0, 数据地址)
            .判断循环尾 ()
        .判断结束
        
        
    .判断结束
    .如果真 (或者 (是否为空 (是否使用高速插入), 是否使用高速插入))
        发送消息1 (集_树型框句柄, #WM_SETREDRAW, 1, 0)
    .如果真结束
    返回 (0)
.默认
    返回 (-1)
.判断结束


.子程序 数据_删除项目, 逻辑型, 公开, 删除树型框中的指定项目。成功返回真，失败返回假。
.参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
.如果真 (或者 (大于 (相加 (项目索引, 1), 取数组成员数 (集_句柄组)), 小于 (项目索引, 0)))
    返回 (假)
.如果真结束
返回 (不等于 (发送消息1 (集_树型框句柄, #TVM_DELETEITEM, 0, 集_句柄组 [相加 (项目索引, 1)]), 0))

.子程序 数据_清空, 空白型, 公开, 删除树型框中的所有项目。
发送消息1 (集_树型框句柄, #WM_SETREDRAW, 0, 0)
发送消息1 (集_树型框句柄, #TVM_DELETEITEM, 0, 0)
发送消息1 (集_树型框句柄, #WM_SETREDRAW, 1, 0)


.子程序 数据_取父项目, 整数型, 公开, 返回指定项目的父项目索引。如果该项目为顶层项目，将返回 -1 。
.参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

.局部变量 计次1, 整数型, , , 
.局部变量 计次2, 整数型, , , 
.局部变量 父项目, 整数型, , , 

.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
赋值 (计次2, 取数组成员数 (集_句柄组))
.如果真 (或者 (大于 (相加 (项目索引, 1), 计次2), 小于 (项目索引, 0)))
    返回 (-1)
.如果真结束
赋值 (父项目, 发送消息1 (集_树型框句柄, #TVM_GETNEXTITEM, #TVGN_PARENT, 集_句柄组 [相加 (项目索引, 1)]))
.判断开始 (等于 (父项目, 0))
    返回 (-1)
.默认
    .判断循环首 (小于 (计次1, 计次2))
        赋值 (计次1, 相加 (计次1, 1))
        .如果真 (等于 (集_句柄组 [计次1], 父项目))
            返回 (相减 (计次1, 1))
        .如果真结束
        
    .判断循环尾 ()
.判断结束
返回 (-1)

.子程序 状态_是否有子项目, 逻辑型, 公开, 如果指定项目存在子项目，返回真，否则返回假。如果本命令返回真，意味着指定项目的下一项即为此项目的第一个子项目。
.参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

.局部变量 成员数, 整数型, , , 
.局部变量 数据, 字节集, , , 

.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
.判断开始 (或者 (大于 (相加 (项目索引, 1), 取数组成员数 (集_句柄组)), 小于 (项目索引, 0)))
    返回 (假)
.默认
    .判断开始 (集_外部控件)
        赋值 (集_外部进程句柄, 外部控件操作.打开进程 (集_树型框句柄))
        赋值 (集_外部数据地址1, 外部控件操作.分配外部指针 (集_外部进程句柄, 40))
        赋值 (集_单一外部项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一外部项目.mask, #TVIF_CHILDREN)
        赋值 (集_项目地址, 取变量地址_TVITEMEX2 (集_单一外部项目, 集_单一外部项目, 0))
        外部控件操作.写进程内存 (集_外部进程句柄, 集_外部数据地址1, 集_项目地址, 40)
        发送消息1 (集_树型框句柄, #TVM_GETITEMA, 0, 集_外部数据地址1)
        赋值 (数据, 外部控件操作.读外部指针数据 (集_外部进程句柄, 集_外部数据地址1, 40))
        外部控件操作.销毁外部指针 (集_外部进程句柄, 集_外部数据地址1)
        外部控件操作.结束操作 (集_外部进程句柄)
        写到内存 (数据, 集_项目地址, 40)
        返回 (集_单一外部项目.cChildren)
    .默认
        
        赋值 (集_单一项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一项目.mask, #TVIF_CHILDREN)
        赋值 (集_项目地址, 取变量地址_TVITEMEX (集_单一项目, 集_单一项目, 0))
        发送消息1 (集_树型框句柄, #TVM_GETITEMA, 0, 集_项目地址)
        返回 (集_单一项目.cChildren)
        
    .判断结束
    
.判断结束


.子程序 状态_是否已扩展, 逻辑型, 公开, 如果树型框中的指定项目具有子项目并已扩展显示，返回真，否则返回假。
.参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

.局部变量 成员数, 整数型, , , 

.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
赋值 (成员数, 取数组成员数 (集_句柄组))
.如果真 (或者 (大于或等于 (相加 (项目索引, 1), 成员数), 小于 (项目索引, 0)))
     ' 如果索引超出范围，或索引是最后一个项目
    返回 (假)
.如果真结束
赋值 (成员数, 发送消息1 (集_树型框句柄, #TVM_GETITEMSTATE, 集_句柄组 [相加 (项目索引, 1)], 0))
返回 (等于 (位与 (成员数, #TVIS_EXPANDED), #TVIS_EXPANDED))


.子程序 样式_背景色_置, 空白型, 公开, 
.参数 背景颜色, 整数型, , 

发送消息1 (集_树型框句柄, #TVM_SETBKCOLOR, 0, 背景颜色)

.子程序 样式_背景色_取, 整数型, 公开, 
返回 (发送消息1 (集_树型框句柄, #TVM_GETBKCOLOR, 0, 0))

.子程序 样式_项目间隔_置, 空白型, 公开, 
.参数 间隔距离, 整数型, 可空, 默认为16

.如果真 (是否为空 (间隔距离))
    赋值 (间隔距离, 16)
.如果真结束
发送消息1 (集_树型框句柄, #TVM_SETITEMHEIGHT, 间隔距离, 0)

.子程序 样式_项目间隔_取, 整数型, 公开, 
返回 (发送消息1 (集_树型框句柄, #TVM_GETITEMHEIGHT, 0, 0))

.子程序 样式_文本颜色_置, 空白型, 公开, 
.参数 文本颜色, 整数型, , 

发送消息1 (集_树型框句柄, #TVM_SETTEXTCOLOR, 0, 文本颜色)

.子程序 样式_文本颜色_取, 整数型, 公开, 
返回 (发送消息1 (集_树型框句柄, #TVM_GETTEXTCOLOR, 0, 0))

.子程序 样式_连线颜色_置, 空白型, 公开, 
.参数 连线颜色, 整数型, , 

发送消息1 (集_树型框句柄, #TVM_SETLINECOLOR, 0, 连线颜色)

.子程序 样式_连线颜色_取, 整数型, 公开, 
返回 (发送消息1 (集_树型框句柄, #TVM_GETLINECOLOR, 0, 0))


.子程序 样式_使用复选框, 空白型, 公开, 
.如果真 (不等于 (位与 (取窗口信息 (集_树型框句柄, #GWL_STYLE), #TVS_CHECKBOXES), #TVS_CHECKBOXES))
    设置窗口信息 (集_树型框句柄, #GWL_STYLE, 位或 (取窗口信息 (集_树型框句柄, #GWL_STYLE), #TVS_CHECKBOXES))
.如果真结束


.子程序 样式_使用热点跟踪, 空白型, 公开, 
.如果真 (不等于 (位与 (取窗口信息 (集_树型框句柄, #GWL_STYLE), #TVS_TRACKSELECT), #TVS_TRACKSELECT))
    设置窗口信息 (集_树型框句柄, #GWL_STYLE, 位或 (取窗口信息 (集_树型框句柄, #GWL_STYLE), #TVS_TRACKSELECT))
.如果真结束



.子程序 样式_禁止滚动条, 逻辑型, 公开, 返回禁止的状态
.参数 禁止, 逻辑型, 可空, 真为禁止，假为解除禁止。默认为真

.判断开始 (并且 (不等于 (位与 (取窗口信息 (集_树型框句柄, #GWL_STYLE), #TVS_NOSCROLL), #TVS_NOSCROLL), 或者 (禁止, 是否为空 (禁止))))
    设置窗口信息 (集_树型框句柄, #GWL_STYLE, 位或 (取窗口信息 (集_树型框句柄, #GWL_STYLE), #TVS_NOSCROLL))
    返回 (真)
.判断 (并且 (等于 (位与 (取窗口信息 (集_树型框句柄, #GWL_STYLE), #TVS_NOSCROLL), #TVS_NOSCROLL), 取反 (禁止), 取反 (是否为空 (禁止))))
    设置窗口信息 (集_树型框句柄, #GWL_STYLE, 位异或 (取窗口信息 (集_树型框句柄, #GWL_STYLE), #TVS_NOSCROLL))
    返回 (假)
.默认
    返回 (不等于 (位与 (取窗口信息 (集_树型框句柄, #GWL_STYLE), #TVS_NOSCROLL), #TVS_NOSCROLL))
.判断结束



.子程序 样式_禁止水平滚动条, 逻辑型, 公开, 返回禁止的状态
.参数 禁止, 逻辑型, 可空, 真为禁止，假为解除禁止。默认为真

.判断开始 (并且 (不等于 (位与 (取窗口信息 (集_树型框句柄, #GWL_STYLE), #TVS_NOHSCROLL), #TVS_NOHSCROLL), 或者 (禁止, 是否为空 (禁止))))
    设置窗口信息 (集_树型框句柄, #GWL_STYLE, 位或 (取窗口信息 (集_树型框句柄, #GWL_STYLE), #TVS_NOHSCROLL))
    返回 (真)
.判断 (并且 (等于 (位与 (取窗口信息 (集_树型框句柄, #GWL_STYLE), #TVS_NOHSCROLL), #TVS_NOHSCROLL), 取反 (禁止), 取反 (是否为空 (禁止))))
    设置窗口信息 (集_树型框句柄, #GWL_STYLE, 位异或 (取窗口信息 (集_树型框句柄, #GWL_STYLE), #TVS_NOHSCROLL))
    返回 (假)
.默认
    返回 (不等于 (位与 (取窗口信息 (集_树型框句柄, #GWL_STYLE), #TVS_NOHSCROLL), #TVS_NOHSCROLL))
.判断结束



.子程序 样式_使用整行选择, 逻辑型, 公开, 要使用本功能，就不能使用显示连线。
.参数 是否使用, 逻辑型, 可空, 真为使用，假为不使用。默认为真。

.判断开始 (不等于 (位与 (取窗口信息 (集_树型框句柄, #GWL_STYLE), #TVS_HASLINES), #TVS_HASLINES))
    .判断开始 (并且 (不等于 (位与 (取窗口信息 (集_树型框句柄, #GWL_STYLE), #TVS_FULLROWSELECT), #TVS_FULLROWSELECT), 或者 (是否使用, 是否为空 (是否使用))))
        设置窗口信息 (集_树型框句柄, #GWL_STYLE, 位或 (取窗口信息 (集_树型框句柄, #GWL_STYLE), #TVS_FULLROWSELECT))
        返回 (真)
    .判断 (并且 (等于 (位与 (取窗口信息 (集_树型框句柄, #GWL_STYLE), #TVS_FULLROWSELECT), #TVS_FULLROWSELECT), 取反 (是否使用), 取反 (是否为空 (是否使用))))
        设置窗口信息 (集_树型框句柄, #GWL_STYLE, 位异或 (取窗口信息 (集_树型框句柄, #GWL_STYLE), #TVS_FULLROWSELECT))
        返回 (假)
    .默认
        返回 (不等于 (位与 (取窗口信息 (集_树型框句柄, #GWL_STYLE), #TVS_FULLROWSELECT), #TVS_FULLROWSELECT))
    .判断结束
    
.默认
    暂停 ()
    返回 (假)
.判断结束


.子程序 状态_是否选中, 逻辑型, 公开, 
.参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

.局部变量 数据, 字节集, , , 

.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
.判断开始 (或者 (大于 (相加 (项目索引, 1), 取数组成员数 (集_句柄组)), 小于 (项目索引, 0)))
    返回 (假)
.默认
    .判断开始 (集_外部控件)
        赋值 (集_外部进程句柄, 外部控件操作.打开进程 (集_树型框句柄))
        赋值 (集_外部数据地址1, 外部控件操作.分配外部指针 (集_外部进程句柄, 40))
        赋值 (集_单一外部项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一外部项目.mask, #TVIF_STATE)
        赋值 (集_项目地址, 取变量地址_TVITEMEX2 (集_单一外部项目, 集_单一外部项目, 0))
        外部控件操作.写进程内存 (集_外部进程句柄, 集_外部数据地址1, 集_项目地址, 40)
        发送消息1 (集_树型框句柄, #TVM_GETITEMA, 0, 集_外部数据地址1)
        赋值 (数据, 外部控件操作.读外部指针数据 (集_外部进程句柄, 集_外部数据地址1, 40))
        外部控件操作.销毁外部指针 (集_外部进程句柄, 集_外部数据地址1)
        外部控件操作.结束操作 (集_外部进程句柄)
        写到内存 (数据, 集_项目地址, 40)
        返回 (等于 (位与 (集_单一外部项目.state, #TVIS_SELECTEDA), #TVIS_SELECTEDA))
    .默认
        赋值 (集_单一项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一项目.mask, #TVIF_STATE)
        赋值 (集_项目地址, 取变量地址_TVITEMEX (集_单一项目, 集_单一项目, 0))
        发送消息1 (集_树型框句柄, #TVM_GETITEMA, 0, 集_项目地址)
        返回 (等于 (位与 (集_单一项目.state, #TVIS_SELECTEDA), #TVIS_SELECTEDA))
    .判断结束
    
.判断结束


.子程序 状态_选中项目, 逻辑型, 公开, 操作成功返回真
.参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 是否选中, 逻辑型, 可空, 可以被省略。设置项目的选中状态，默认为真。
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
.判断开始 (或者 (大于 (相加 (项目索引, 1), 取数组成员数 (集_句柄组)), 小于 (项目索引, 0)))
    返回 (假)
.默认
    .判断开始 (集_外部控件)
        赋值 (集_外部进程句柄, 外部控件操作.打开进程 (集_树型框句柄))
        赋值 (集_外部数据地址1, 外部控件操作.分配外部指针 (集_外部进程句柄, 40))
        赋值 (集_单一外部项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一外部项目.mask, 相加 (#TVIF_STATE, #TVIF_HANDLE))
        .判断开始 (或者 (是否选中, 是否为空 (是否选中)))
            赋值 (集_单一外部项目.state, #TVIS_SELECTEDA)
        .默认
            赋值 (集_单一外部项目.state, #TVIS_NOSELECTEDA)
        .判断结束
        赋值 (集_单一外部项目.stateMask, #TVIS_STATEIMAGEMASK)
        赋值 (集_项目地址, 取变量地址_TVITEMEX2 (集_单一外部项目, 集_单一外部项目, 0))
        外部控件操作.写进程内存 (集_外部进程句柄, 集_外部数据地址1, 集_项目地址, 40)
        发送消息1 (集_树型框句柄, #TVM_SETITEMA, 0, 集_外部数据地址1)
        外部控件操作.销毁外部指针 (集_外部进程句柄, 集_外部数据地址1)
        外部控件操作.结束操作 (集_外部进程句柄)
        返回 (真)
    .默认
        赋值 (集_单一项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一项目.mask, 相加 (#TVIF_STATE, #TVIF_HANDLE))
        .判断开始 (或者 (是否选中, 是否为空 (是否选中)))
            赋值 (集_单一项目.state, #TVIS_SELECTEDA)
        .默认
            赋值 (集_单一项目.state, #TVIS_NOSELECTEDA)
        .判断结束
        赋值 (集_单一项目.stateMask, #TVIS_STATEIMAGEMASK)
        赋值 (集_项目地址, 取变量地址_TVITEMEX (集_单一项目, 集_单一项目, 0))
        返回 (不等于 (发送消息1 (集_树型框句柄, #TVM_SETITEMA, 0, 集_项目地址), 0))
    .判断结束
    
.判断结束


.子程序 状态_加粗, 空白型, 公开, 
.参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
.如果真 (并且 (小于或等于 (相加 (项目索引, 1), 取数组成员数 (集_句柄组)), 大于或等于 (项目索引, 0)))
    .判断开始 (集_外部控件)
        赋值 (集_外部进程句柄, 外部控件操作.打开进程 (集_树型框句柄))
        赋值 (集_外部数据地址1, 外部控件操作.分配外部指针 (集_外部进程句柄, 40))
        赋值 (集_单一外部项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一外部项目.mask, #TVIF_STATE)
        赋值 (集_单一外部项目.state, #TVIS_BOLD)
        赋值 (集_单一外部项目.stateMask, #TVIS_BOLD)
        赋值 (集_项目地址, 取变量地址_TVITEMEX2 (集_单一外部项目, 集_单一外部项目, 0))
        外部控件操作.写进程内存 (集_外部进程句柄, 集_外部数据地址1, 集_项目地址, 40)
        发送消息1 (集_树型框句柄, #TVM_SETITEMA, 0, 集_外部数据地址1)
        外部控件操作.销毁外部指针 (集_外部进程句柄, 集_外部数据地址1)
        外部控件操作.结束操作 (集_外部进程句柄)
    .默认
        赋值 (集_单一项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一项目.mask, #TVIF_STATE)
        赋值 (集_单一项目.state, #TVIS_BOLD)
        赋值 (集_单一项目.stateMask, #TVIS_BOLD)
        赋值 (集_项目地址, 取变量地址_TVITEMEX (集_单一项目, 集_单一项目, 0))
        发送消息1 (集_树型框句柄, #TVM_SETITEMA, 0, 集_项目地址)
    .判断结束
    
.如果真结束


.子程序 状态_取消加粗, 空白型, 公开, 将指定项目的标题取消加粗显示。
.参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

.局部变量 当前项目, 整数型, , , 
.局部变量 当前状态, 整数型, , , 0、普通，1、加粗，2、扩展，3、加粗+扩展

.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
.如果真 (并且 (小于或等于 (相加 (项目索引, 1), 取数组成员数 (集_句柄组)), 大于或等于 (项目索引, 0)))
    .判断开始 (集_外部控件)
        赋值 (集_外部进程句柄, 外部控件操作.打开进程 (集_树型框句柄))
        赋值 (集_外部数据地址1, 外部控件操作.分配外部指针 (集_外部进程句柄, 40))
        赋值 (集_单一外部项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一外部项目.mask, #TVIF_STATE)
        赋值 (集_单一外部项目.state, 位取反 (#TVIS_BOLD))
        赋值 (集_单一外部项目.stateMask, #TVIS_BOLD)
        赋值 (集_项目地址, 取变量地址_TVITEMEX2 (集_单一外部项目, 集_单一外部项目, 0))
        外部控件操作.写进程内存 (集_外部进程句柄, 集_外部数据地址1, 集_项目地址, 40)
        发送消息1 (集_树型框句柄, #TVM_SETITEMA, 0, 集_外部数据地址1)
        外部控件操作.销毁外部指针 (集_外部进程句柄, 集_外部数据地址1)
        外部控件操作.结束操作 (集_外部进程句柄)
    .默认
        赋值 (集_单一项目.hItem, 集_句柄组 [相加 (项目索引, 1)])
        赋值 (集_单一项目.mask, #TVIF_STATE)
        赋值 (集_单一项目.state, 位取反 (#TVIS_BOLD))
        赋值 (集_单一项目.stateMask, #TVIS_BOLD)
        赋值 (集_项目地址, 取变量地址_TVITEMEX (集_单一项目, 集_单一项目, 0))
        发送消息1 (集_树型框句柄, #TVM_SETITEMA, 0, 集_项目地址)
        
    .判断结束
    
    
    
.如果真结束


.子程序 数据_现行选中项_置, 空白型, 公开, 
.参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
.判断开始 (或者 (大于 (相加 (项目索引, 1), 取数组成员数 (集_句柄组)), 小于 (项目索引, 0)))
    返回 ()
.默认
    发送消息1 (集_树型框句柄, #TVM_SELECTITEM, #TVGN_CARET, 集_句柄组 [相加 (项目索引, 1)])
.判断结束


.子程序 数据_取可显示数量, 整数型, 公开, 取当前在树形框的用户区中大约可以显示的项目数量
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

 ' TVM_GETVISIBLECOUNT
.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
返回 (发送消息1 (集_树型框句柄, #TVM_GETVISIBLECOUNT, 0, 0))

.子程序 数据_取第一项索引, 整数型, 公开, 取在当前树形框中显示的第一条项目的索引。失败返回-1
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

.局部变量 目标句柄, 空白型, , , 
.局部变量 成员数, 整数型, , , 
.局部变量 计次, 整数型, , , 

 ' TVM_GETVISIBLECOUNT
.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
赋值 (目标句柄, 发送消息1 (集_树型框句柄, #TVM_GETNEXTITEM, #TVGN_FIRSTVISIBLE, 0))
赋值 (成员数, 取数组成员数 (集_句柄组))
.判断循环首 (小于 (计次, 成员数))
    赋值 (计次, 相加 (计次, 1))
    .如果真 (等于 (目标句柄, 集_句柄组 [计次]))
        返回 (相减 (计次, 1))
    .如果真结束
    
.判断循环尾 ()
返回 (-1)

.子程序 数据_现行选中项_取, 整数型, 公开, 
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

.局部变量 当前句柄, 整数型, , , 
.局部变量 成员数, 整数型, , , 
.局部变量 计次, 整数型, , , 

.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
赋值 (当前句柄, 发送消息1 (集_树型框句柄, #TVM_GETNEXTITEM, #TVGN_CARET, 0)) ' 先取第一个根
.如果真 (不等于 (当前句柄, 0))
    赋值 (成员数, 取数组成员数 (集_句柄组))
    .判断循环首 (小于 (计次, 成员数))
        赋值 (计次, 相加 (计次, 1))
        .如果真 (等于 (集_句柄组 [计次], 当前句柄))
            返回 (相减 (计次, 1))
        .如果真结束
        
    .判断循环尾 ()
.如果真结束
返回 (-1)

.子程序 数据_取全部选中项, 变体型, 公开, 返回选中项索引数组
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

.局部变量 选中项索引, 变体型, , , 
.局部变量 选中项索引A, 整数型, , "0", 
.局部变量 成员数, 整数型, , , 
.局部变量 成员数2, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 数据, 字节集, , , 

.如果真 (或者 (并且 (是否为空 (是否自动更新数据), 集_自动更新), 等于 (是否自动更新数据, 真)))
    遍历句柄 ()
.如果真结束
选中项索引.置类型 (#变体类型.数值型数组)
赋值 (成员数, 取数组成员数 (集_句柄组))
.判断开始 (集_外部控件)
    赋值 (集_单一外部项目.mask, #TVIF_STATE)
    赋值 (集_项目地址, 取变量地址_TVITEMEX2 (集_单一外部项目, 集_单一外部项目, 0))
    赋值 (集_外部进程句柄, 外部控件操作.打开进程 (集_树型框句柄))
    赋值 (集_外部数据地址1, 外部控件操作.分配外部指针 (集_外部进程句柄, 40))
    .判断循环首 (小于 (计次, 成员数))
        赋值 (计次, 相加 (计次, 1))
        赋值 (集_单一外部项目.hItem, 集_句柄组 [计次])
        外部控件操作.写进程内存 (集_外部进程句柄, 集_外部数据地址1, 集_项目地址, 40)
        发送消息1 (集_树型框句柄, #TVM_GETITEMA, 0, 集_外部数据地址1)
        赋值 (数据, 外部控件操作.读外部指针数据 (集_外部进程句柄, 集_外部数据地址1, 40))
        写到内存 (数据, 集_项目地址, 40)
        .如果真 (等于 (位与 (集_单一外部项目.state, #TVIS_SELECTEDA), #TVIS_SELECTEDA))
            赋值 (成员数2, 相加 (取数组成员数 (选中项索引A), 1))
            重定义数组 (选中项索引A, 真, 成员数2)
            赋值 (选中项索引A [成员数2], 计次)
             ' 加入成员 (选中项索引A, I)
        .如果真结束
        
    .判断循环尾 ()
    外部控件操作.销毁外部指针 (集_外部进程句柄, 集_外部数据地址1)
    外部控件操作.结束操作 (集_外部进程句柄)
.默认
    赋值 (集_单一项目.mask, #TVIF_STATE)
    赋值 (集_项目地址, 取变量地址_TVITEMEX (集_单一项目, 集_单一项目, 0))
    .判断循环首 (小于 (计次, 成员数))
        赋值 (计次, 相加 (计次, 1))
        赋值 (集_单一项目.hItem, 集_句柄组 [计次])
        发送消息1 (集_树型框句柄, #TVM_GETITEMA, 0, 集_项目地址)
        .如果真 (等于 (位与 (集_单一项目.state, #TVIS_SELECTEDA), #TVIS_SELECTEDA))
            赋值 (成员数2, 相加 (取数组成员数 (选中项索引A), 1))
            重定义数组 (选中项索引A, 真, 成员数2)
            赋值 (选中项索引A [成员数2], 计次)
             ' 加入成员 (选中项索引A, I)
        .如果真结束
        
    .判断循环尾 ()
    
.判断结束
选中项索引.赋值 (选中项索引A, )
返回 (选中项索引)

.子程序 遍历句柄, 空白型, , 
.局部变量 父项目, 空白型, , , 
.局部变量 子项目, 整数型, , , 
.局部变量 数值, 整数型, , , 
.局部变量 完成, 逻辑型, , , 
.局部变量 计次, 整数型, , , 

 ' 清除数组 (集_句柄组)
重定义数组 (集_句柄组, 假, 数据_取项目数 ())
赋值 (子项目, 发送消息1 (集_树型框句柄, #TVM_GETNEXTITEM, #TVGN_ROOT, 0)) ' 先取第一个根
.判断循环首 (不等于 (子项目, 0))
    赋值 (计次, 相加 (计次, 1))
    赋值 (集_句柄组 [计次], 子项目)
    赋值 (数值, 子项目)
    赋值 (子项目, 发送消息1 (集_树型框句柄, #TVM_GETNEXTITEM, #TVGN_CHILD, 子项目)) ' 取第一个子
    .如果真 (等于 (子项目, 0)) ' 取子取不到，就取兄弟
        赋值 (子项目, 发送消息1 (集_树型框句柄, #TVM_GETNEXTITEM, #TVGN_NEXT, 数值)) ' 取子的兄弟
         ' 找到了兄弟就直接到循环尾，否则进入下面的循环找父项目
        .判断循环首 (等于 (子项目, 0))
            赋值 (父项目, 发送消息1 (集_树型框句柄, #TVM_GETNEXTITEM, #TVGN_PARENT, 数值)) ' 退回上一级
            .如果真 (等于 (父项目, 0))
                赋值 (完成, 真)
                跳出循环 ()
            .如果真结束
            赋值 (数值, 父项目)
            赋值 (子项目, 发送消息1 (集_树型框句柄, #TVM_GETNEXTITEM, #TVGN_NEXT, 父项目)) ' 取父的兄弟
        .判断循环尾 ()
    .如果真结束
    .如果真 (完成)
        跳出循环 ()
    .如果真结束
    
.判断循环尾 ()

.子程序 _置外部操作, 空白型, , 如果是外部控件，就要用这个方法初始化
赋值 (集_外部控件, 真)

.子程序 _销毁外部操作, 空白型, , 如果不再需要对外部控件进行初始化，可用这个销毁
赋值 (集_外部控件, 假)


.子程序 快速查找, 整数型, , 
.参数 欲查找句柄, 整数型, , 

.局部变量 计次1, 整数型, , , 
.局部变量 计次2, 整数型, , , 

赋值 (计次1, 1)
赋值 (计次2, 取数组成员数 (集_句柄组))
.判断循环首 (小于 (计次1, 计次2)) ' 循环直至左右指针相遇
    .如果真 (等于 (集_句柄组 [计次1], 欲查找句柄))
        返回 (计次1)
    .如果真结束
    .如果真 (等于 (集_句柄组 [计次2], 欲查找句柄))
        返回 (计次2)
    .如果真结束
    .判断开始 (小于 (计次1, 计次2))
        赋值 (计次1, 相加 (计次1, 1))
        赋值 (计次2, 相减 (计次2, 1))
    .默认
        返回 (0)
    .判断结束
    
.判断循环尾 ()
返回 (0)


.子程序 置自动更新状态, 空白型, 公开, 本方法决定了各个其它方法中“是否自动更新数据”参数的默认值。默认状态下，如果不使用本方法进行操作，“是否自动更新数据”参数的默认值将自动设置为真。
.参数 自动更新, 逻辑型, , 

赋值 (集_自动更新, 自动更新)

.子程序 查询自动更新状态, 逻辑型, 公开, 
返回 (集_自动更新)


.窗口程序集 启动窗口程序集, , , 

.程序集变量 集_树型框, 树型框句柄操作类, , , 
.程序集变量 集_树型框结构数据, 树型框结构, , "0", 
.子程序 __启动窗口_创建完毕, 空白型, , 
.如果真 (等于 (集_树型框._初始化类 (取窗口句柄 ()), 假))
    信息框 (“对象不是树型框”, 0, )
.如果真结束



.子程序 _按钮_取项目数_被单击, 空白型, , 
信息框 (相加 (“类操作：”, 到文本 (集_树型框.数据_取项目数 ())), 0, )

.子程序 _按钮_取缩进层次_被单击, 空白型, , 
信息框 (相加 (“类操作：”, 到文本 (集_树型框.数据_取缩进层次 (集_树型框.数据_现行选中项_取 ()))), 0, )


.子程序 _按钮_取项目文本_被单击, 空白型, , 
信息框 (相加 (“类操作：”, 集_树型框.数据_取项目文本 (集_树型框.数据_现行选中项_取 (), )), 0, )


.子程序 _按钮_取图片_被单击, 空白型, , 
信息框 (相加 (“类操作：”, 到文本 (集_树型框.数据_取图片 (集_树型框.数据_现行选中项_取 ()))), 0, )


.子程序 _按钮_取选中图片_被单击, 空白型, , 
信息框 (相加 (“类操作：”, 到文本 (集_树型框.数据_取选中图片 (集_树型框.数据_现行选中项_取 ()))), 0, )


.子程序 _按钮_取项目数值_被单击, 空白型, , 
信息框 (相加 (“类操作：”, 到文本 (集_树型框.数据_取项目数值 (集_树型框.数据_现行选中项_取 ()))), 0, )


.子程序 _按钮_置项目文本_被单击, 空白型, , 
信息框 (相加 (“类操作：”, 到文本 (集_树型框.数据_置项目文本 (集_树型框.数据_现行选中项_取 (), “中国易语言”))), 0, )


.子程序 _按钮_置图片_被单击, 空白型, , 
信息框 (相加 (“类操作：”, 到文本 (集_树型框.数据_置图片 (集_树型框.数据_现行选中项_取 (), 0))), 0, )


.子程序 _按钮_置选中图片_被单击, 空白型, , 
信息框 (相加 (“类操作：”, 到文本 (集_树型框.数据_置选中图片 (集_树型框.数据_现行选中项_取 (), 0))), 0, )


.子程序 _按钮_置项目数值_被单击, 空白型, , 
信息框 (相加 (“类操作：”, 到文本 (集_树型框.数据_置项目数值 (集_树型框.数据_现行选中项_取 (), 200))), 0, )


.子程序 _按钮_加粗_被单击, 空白型, , 
集_树型框.状态_加粗 (集_树型框.数据_现行选中项_取 ())


.子程序 _按钮_取消加粗_被单击, 空白型, , 
集_树型框.状态_取消加粗 (集_树型框.数据_现行选中项_取 ())


.子程序 _按钮_扩展_被单击, 空白型, , 
集_树型框.状态_扩展 (集_树型框.数据_现行选中项_取 ())


.子程序 _按钮_收缩_被单击, 空白型, , 
集_树型框.状态_收缩 (集_树型框.数据_现行选中项_取 ())


.子程序 _按钮_删除项目_被单击, 空白型, , 
 ' 删除项目
 ' 树型框1.删除项目 (树型框.数据_现行选中项_取 ())
信息框 (相加 (“类操作：”, 到文本 (集_树型框.数据_删除项目 (集_树型框.数据_现行选中项_取 ()))), 0, )


.子程序 _按钮_取父项目_被单击, 空白型, , 
信息框 (相加 (“类操作：”, 到文本 (集_树型框.数据_取父项目 (集_树型框.数据_现行选中项_取 ()))), 0, )


.子程序 _按钮_是否有子项目_被单击, 空白型, , 
信息框 (相加 (“类操作：”, 到文本 (集_树型框.状态_是否有子项目 (集_树型框.数据_现行选中项_取 ()))), 0, )


.子程序 _按钮_是否已扩展_被单击, 空白型, , 
信息框 (相加 (“类操作：”, 到文本 (集_树型框.状态_是否已扩展 (集_树型框.数据_现行选中项_取 ()))), 0, )


.子程序 _按钮_清空_被单击, 空白型, , 
集_树型框.数据_清空 ()


.子程序 _按钮_高速加入10000个项目_被单击, 空白型, , 
.局部变量 局部_临时项目, 项目数据, , , 
.局部变量 局部_项目组, 项目数据, , "0", 
.局部变量 局部_基准时间, 整数型, , , 
.局部变量 局部_计次, 整数型, , , 

赋值 (局部_基准时间, 取启动时间 ())
赋值 (局部_临时项目.图片索引, 1)
赋值 (局部_临时项目.选中图片索引, 2)
赋值 (局部_临时项目.项目数值, 38)
.计次循环首 (10000, 局部_计次)
    赋值 (局部_临时项目.项目文本, 到文本 (局部_计次))
    加入成员 (局部_项目组, 局部_临时项目)
.计次循环尾 ()
集_树型框.数据_加入项目_API方式加入 (集_树型框.数据_现行选中项_取 (), , 局部_项目组, 多项选择 (相加 (.现行选中项, 1), #树形框插入项目_在根部插入, #树形框插入项目_在列表首部插入, #树形框插入项目_在列表尾部插入, #树形框插入项目_按字母顺序排列插入), , )

信息框 (相加 (“用时：”, 到文本 (相除 (相减 (取启动时间 (), 局部_基准时间), 1000))), 0, )


.子程序 _按钮_是否被选中_被单击, 空白型, , 
信息框 (集_树型框.状态_是否选中 (集_树型框.数据_现行选中项_取 ()), 0, )


.子程序 _按钮_使用复选框_被单击, 空白型, , 
集_树型框.样式_使用复选框 ()


.子程序 _按钮_取全部选中项_被单击, 空白型, , 
.局部变量 局部_数据, 变体型, , , 

赋值 (局部_数据, 集_树型框.数据_取全部选中项 ())
输出调试文本 (局部_数据.取数组成员数 ())


.子程序 _按钮_选中_被单击, 空白型, , 

.判断开始 (等于 (集_树型框.状态_是否选中 (集_树型框.数据_现行选中项_取 (假), 假), 假))
    集_树型框.状态_选中项目 (集_树型框.数据_现行选中项_取 (假), , 假)
.默认
    集_树型框.状态_选中项目 (集_树型框.数据_现行选中项_取 (假), 假, 假)
.判断结束


.子程序 _按钮_使用热点跟踪_被单击, 空白型, , 
集_树型框.样式_使用热点跟踪 ()


.子程序 _按钮_禁止滚动条_被单击, 空白型, , 
集_树型框.样式_禁止滚动条 ()


.子程序 _按钮_解除禁止滚动条_被单击, 空白型, , 
集_树型框.样式_禁止滚动条 (假)


.子程序 _按钮_禁止水平滚动条_被单击, 空白型, , 
集_树型框.样式_禁止水平滚动条 ()


.子程序 _按钮_解除禁止水平滚动条_被单击, 空白型, , 
集_树型框.样式_禁止水平滚动条 (假)


.子程序 _按钮_使用整行选择_被单击, 空白型, , 
集_树型框.样式_使用整行选择 ()

.子程序 _按钮_不使用整行选择_被单击, 空白型, , 
集_树型框.样式_使用整行选择 (假)


.子程序 _按钮_取可显示数量_被单击, 空白型, , 
信息框 (集_树型框.数据_取可显示数量 (), 0, )


.子程序 _按钮_取第一项索引_被单击, 空白型, , 
信息框 (集_树型框.数据_取第一项索引 (), 0, )


.子程序 _按钮_初始化外部操作_被单击, 空白型, , 
集_树型框._初始化类 (到数值 (.内容), 真)


.类模块 树型框操作类, 树型框操作基类, , 

.程序集变量 类_树型框1, 树型框, , , 
.程序集变量 类_树型框的数据, 树型框结构, , "0", 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用
清除数组 (类_树型框的数据)


.子程序 _初始化类, 空白型, 公开, 
.参数 树型框, 树型框, , 

赋值 (类_树型框1, 树型框)
数据_读树形框 (树型框., 类_树型框的数据)
_初始化类A (树型框.取窗口句柄 ())


.子程序 _更新数据, 空白型, 公开, 当某些操作没有使用自动更新时，可在这里以手动方式进行数据更新
数据_读树形框 (类_树型框1., 类_树型框的数据)

.子程序 数据_加入项目_字节集方式加入, 整数型, 公开, 将单个或一批项目加入到树型框中，如果仅加入一个项目，成功返回加入后该项目所处的位置，失败返回 -1 。如果成批加入项目，成功返回 0 ，失败返回 -1 。成批加入项目可以用作一次性快速加入大量项目到树型框中。注意，加入数据后，树形框的句柄将会改变。
.参数 父项目索引, 整数型, 可空, 可以被省略。指定欲加入项目所处的父项目，0 为项目一，1 为项目二，如此类推。如果没有父项目（即欲加入项目为顶层项目），请提供值 -1 。如果本参数被省略，默认值为 -1 。
.参数 项目文本, 文本型, 数组, 如果欲只加入一个项目，请提供一个成员的数组数据。
.参数 图片索引, 整数型, 可空 数组, 可以被省略。图片索引用于指定图片组属性中的某张图片，从 0 开始。如果本参数被省略，所有被加入项目的图片索引都默认为 0 。如果欲只加入一个项目，请提供一个成员的数组数据。
.参数 选中图片索引, 整数型, 可空 数组, 可以被省略。选中图片索引用于指定项目被选中后所显示的图片，-1 表示与图片索引一致。如果本参数被省略，所有被加入项目的选中图片索引都默认为 -1 。如果欲只加入一个项目，请提供一个成员的数组数据。
.参数 项目数值, 整数型, 可空 数组, 可以被省略。指定与本项目相关联的数值。如果本参数被省略，所有被加入项目的项目数值都默认为 0 。如果欲只加入一个项目，请提供一个成员的数组数据。
.参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为真。

.局部变量 当前项目, 整数型, , , 
.局部变量 结构, 树型框结构, , "0", 
.局部变量 成员数, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 缩进层次, 整数型, , , 

.如果真 (或者 (是否为空 (是否自动更新数据), 等于 (是否自动更新数据, 真)))
    数据_读树形框 (类_树型框1., 类_树型框的数据)
.如果真结束
.判断开始 (或者 (是否为空 (父项目索引), 等于 (父项目索引, -1)))
    赋值 (缩进层次, 1)
.判断 (等于 (取数组成员数 (类_树型框的数据), 0))
    赋值 (父项目索引, -1)
    赋值 (缩进层次, 1)
.判断 (大于 (父项目索引, 取数组成员数 (类_树型框的数据)))
    赋值 (父项目索引, 相减 (取数组成员数 (类_树型框的数据), 1))
    赋值 (缩进层次, 相加 (类_树型框的数据 [相加 (父项目索引, 1)].缩进层次, 1))
.默认
    赋值 (缩进层次, 相加 (类_树型框的数据 [相加 (父项目索引, 1)].缩进层次, 1))
.判断结束
赋值 (成员数, 取数组成员数 (项目文本))
重定义数组 (结构, 假, 成员数)
.判断循环首 (小于 (计次, 成员数))
    赋值 (计次, 相加 (计次, 1))
    赋值 (结构 [计次], 项目文本, 项目文本 [计次])
    赋值 (结构 [计次], 缩进层次, 缩进层次)
    .如果真 (小于或等于 (计次, 取数组成员数 (图片索引)))
        赋值 (结构 [计次], 图片索引, 图片索引 [计次])
    .如果真结束
    .判断开始 (小于或等于 (计次, 取数组成员数 (选中图片索引)))
        赋值 (结构 [计次], 选中图片索引, 选择 (等于 (选中图片索引 [计次], -1), 结构 [计次], 图片索引, 选中图片索引 [计次]))
    .默认
        赋值 (结构 [计次], 选中图片索引, 结构 [计次], 图片索引)
    .判断结束
    .如果真 (小于或等于 (计次, 取数组成员数 (项目数值)))
        赋值 (结构 [计次], 项目数值, 项目数值 [计次])
    .如果真结束
    
.判断循环尾 ()
.判断开始 (或者 (是否为空 (父项目索引), 等于 (父项目索引, -1)))
    赋值 (成员数, 相减 (取数组成员数 (类_树型框的数据), 1))
    加入成员 (类_树型框的数据, 结构)
.默认
    赋值 (成员数, 取数组成员数 (类_树型框的数据))
    赋值 (计次, 相加 (父项目索引, 2))
    .判断循环首 (小于 (计次, 成员数))
        赋值 (计次, 相加 (计次, 1))
        .如果真 (大于或等于 (类_树型框的数据 [相加 (父项目索引, 1)].缩进层次, 类_树型框的数据 [计次], 缩进层次))
             ' 父项目的下一项目与父项目同级，或下一项目是父项目的上一层
            跳出循环 ()
        .如果真结束
        
    .判断循环尾 ()
    插入成员 (类_树型框的数据, 计次, 结构)
    赋值 (成员数, 相减 (计次, 1))
.判断结束
赋值 (类_树型框1., 生成数据 ())
赋值 (类_树型框1., 当前项目)
类_树型框1.保证显示 (类_树型框1.)
_初始化类A (类_树型框1.取窗口句柄 ())
返回 (成员数)


.子程序 数据_清空, 空白型, 公开, 删除树型框中的所有项目。
数据_清空 ()

.子程序 生成数据, 字节集, , 
.局部变量 数据, 字节集, , , 
.局部变量 成员数, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 数据地址, 整数型, , , 
.局部变量 文件号, 整数型, , , 

赋值 (文件号, 打开内存文件 ())
赋值 (成员数, 取数组成员数 (类_树型框的数据))
.判断循环首 (小于 (计次, 成员数))
    赋值 (计次, 相加 (计次, 1))
    赋值 (数据地址, 取数据地址 (类_树型框的数据 [计次], 类_树型框的数据 [计次], 0))
    写出文本 (文件号, 类_树型框的数据 [计次], 项目文本)
     ' 写出字节集 (文件号, )
    写出字节集 (文件号, 相加 ({ 0 }, 指针到字节集 (相加 (数据地址, 4), 20)))
.判断循环尾 ()
移到文件首 (文件号)
赋值 (数据, 读入字节集 (文件号, 取文件长度 (文件号)))
关闭文件 (文件号)
返回 (数据)

.子程序 数据_读树形框, 空白型, 公开, 
.参数 项目数据, 字节集, , 
.参数 树型框结构数据, 树型框结构, 参考 数组, 

.局部变量 文件号, 整数型, , , 
.局部变量 结构, 树型框结构, , , 
.局部变量 数据首地址, 整数型, , , 

清除数组 (树型框结构数据)
赋值 (文件号, 打开内存文件 ())
写出字节集 (文件号, 项目数据)
移到文件首 (文件号)
.判断循环首 (等于 (是否在文件尾 (文件号, ), 假))
    赋值 (结构.项目文本, 读入文本 (文件号, ))
    移动读写位置 (文件号, #现行位置, 1)
    赋值 (数据首地址, 取数值变量地址 (结构.图片索引))
    写到内存 (读入字节集 (文件号, 20), 数据首地址, 20)
    加入成员 (树型框结构数据, 结构)
.判断循环尾 ()
关闭文件 (文件号)

.类模块 树型框句柄操作类, 树型框操作基类, , 

.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 _初始化类, 逻辑型, 公开, 成功返回真
.参数 树型框句柄, 整数型, , 
.参数 是否为外部进程的树形框, 逻辑型, 可空, 可以被省略。当为真时，可对这个外部进程一树形框进行操作。默认为假。

.如果真 (是否为外部进程的树形框)
    _置外部操作 ()
.如果真结束
返回 (_初始化类A (树型框句柄))


.子程序 _更新数据, 空白型, 公开, 当某些操作没有使用自动更新时，可在这里以手动方式进行数据更新
更新数据1 ()

.子程序 _取消外部操作, 空白型, 公开, 当要取消对外部树形框的操作，而转向使用内部树形框时，可使用此方法。
_销毁外部操作 ()

.子程序 _使用外部操作, 空白型, 公开, 当要取消对内部树形框的操作，而转向使用外部树形框时，可使用此方法。
_置外部操作 ()


.类模块 外部控件操作类, , , 

.子程序 打开进程, 整数型, , 成功就返回进程句柄
.参数 对象句柄, 整数型, , 



.子程序 写进程内存, 逻辑型, , 
.参数 进程句柄, 整数型, , 
.参数 数据指针, 整数型, , 
.参数 数据地址, 整数型, , 
.参数 数据长度, 整数型, , 



.子程序 结束操作, 空白型, , 
.参数 进程句柄, 整数型, , 



.子程序 读外部指针数据, 字节集, , 
.参数 进程句柄, 整数型, , 
.参数 外部程序指针, 整数型, , 
.参数 读取数据大小, 整数型, , 



.子程序 分配外部指针, 整数型, , 
.参数 进程句柄, 整数型, , 
.参数 数据长度, 整数型, , 分配的数据长度



.子程序 销毁外部指针, 空白型, , 
.参数 进程句柄, 整数型, , 
.参数 外部指针, 整数型, , 




 ' 不属于任何一个程序集、类模块的函数：
