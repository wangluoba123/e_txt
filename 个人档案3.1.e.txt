 ' 文件类型：Windows窗口程序

 ' 程序名称：个人档案 Ver 2.0
 ' 程序描述：
 ' 程序作者：杨毅伟
 ' 邮政编码：361004
 ' 联系地址：厦门市湖滨南路248号之十四701信箱
 ' 联系电话：139-59222204
 ' 传真号码：
 ' 电子信箱：cevali@sina.com
 ' 主页地址：http://www.hgtang.0163.com
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 启动画面 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 402
    高度 = 300
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 假
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “个人档案”
    帮助文件名 = “”

窗口 _启动窗口
    左边 = 150
    顶边 = 50
    宽度 = 470
    高度 = 474
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 12748827 '  0xC2881B
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 真
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “个人档案”
    帮助文件名 = “E:\soft-setup\My Program\GTDocument 源程序\个人档案.HLP”

窗口 密码修改
    左边 = 50
    顶边 = 50
    宽度 = 235
    高度 = 115
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 12748827 '  0xC2881B
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 真
    背景音乐 =  ' 已保存到：D:\易语言学习\Data\个人档案3.1.e\密码修改_背景音乐
    标题 = “”
    帮助文件名 = “”

窗口 密码验证 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 213
    高度 = 115
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 12748827 '  0xC2881B
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    图标 =  ' 已保存到：D:\易语言学习\Data\个人档案3.1.e\密码验证_图标.ico
    背景音乐 =  ' 空
    标题 = “个人档案-[密码验证]”
    帮助文件名 = “”

窗口 注册窗口
    左边 = 50
    顶边 = 50
    宽度 = 375
    高度 = 352
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 12748827 '  0xC2881B
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 已保存到：D:\易语言学习\Data\个人档案3.1.e\注册窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.图片 启动封面, " ' 已保存到：D:\易语言学习\Data\个人档案3.1.e\启动封面", , 
.图片 添加, " ' 已保存到：D:\易语言学习\Data\个人档案3.1.e\添加", , 
.图片 保存, " ' 已保存到：D:\易语言学习\Data\个人档案3.1.e\保存", , 
.图片 无, " ' 已保存到：D:\易语言学习\Data\个人档案3.1.e\无", , 
.图片 删除, " ' 已保存到：D:\易语言学习\Data\个人档案3.1.e\删除", , 
.图片 上翻, " ' 已保存到：D:\易语言学习\Data\个人档案3.1.e\上翻", , 
.图片 下翻, " ' 已保存到：D:\易语言学习\Data\个人档案3.1.e\下翻", , 
.图片 关于, " ' 已保存到：D:\易语言学习\Data\个人档案3.1.e\关于", , 
.图片 退出, " ' 已保存到：D:\易语言学习\Data\个人档案3.1.e\退出", , 
.常量 档案类型, "“档案类型”", , 
.常量 密码, "“GT01R06EFQ”", , 
.常量 姓名, "“姓名”", , 
.常量 生日, "“生日”", , 
.常量 性别, "“性别”", , 
.常量 星座, "“星座”", , 
.常量 移动电话, "“移动电话”", , 
.常量 网络呼机, "“网络呼机”", , 
.常量 传呼号码, "“传呼号码”", , 
.常量 家庭电话, "“家庭电话”", , 
.常量 家庭电话2, "“家庭电话2”", , 
.常量 家庭地址, "“家庭地址”", , 
.常量 家庭邮编, "“家庭邮编”", , 
.常量 工作电话, "“工作电话”", , 
.常量 工作电话2, "“工作电话2”", , 
.常量 工作地址, "“工作地址”", , 
.常量 工作邮编, "“工作邮编”", , 
.常量 电子信箱, "“电子信箱”", , 
.常量 电子信箱2, "“电子信箱2”", , 
.常量 主页地址, "“主页地址”", , 
.常量 主页地址2, "“主页地址2”", , 
.常量 备注, "“备注”", , 
.常量 照片, "“照片”", , 
.图片 注册图标, " ' 已保存到：D:\易语言学习\Data\个人档案3.1.e\注册图标", , 
.图片 密码图标, " ' 已保存到：D:\易语言学习\Data\个人档案3.1.e\密码图标", , 
.图片 程序图标, " ' 已保存到：D:\易语言学习\Data\个人档案3.1.e\程序图标", , 
.图片 a, "", , 


 ' 所需要的支持库：
 ' KRNLN d09f2340818511d396f6aaf844c7e325 4 6 系统核心支持库




.全局变量 取随机注册号, 整数型, , , 
.全局变量 取注册号, 整数型, , , 
.全局变量 写注册号, 整数型, , , 
.全局变量 运算号, 整数型, , , 

.窗口程序集 画面程序集, , , 

.子程序 _启动画面_创建完毕, 逻辑型, , 
赋值 (启动画面., #启动封面)
赋值 (., 110)

.子程序 _时钟1_周期事件, 空白型, , 
.局部变量 时钟, 短整数型, 静态, , 

.判断开始 (等于 (_启动窗口., 真))
    赋值 (., 真)
.默认
    赋值 (., 50)
    赋值 (时钟, 相加 (时钟, 1))
    .如果 (等于 (时钟, 25))
        赋值 (启动画面., 200)
        赋值 (启动画面., 134)
        赋值 (启动画面., 1)
    .否则
        .如果 (大于或等于 (时钟, 35))
            销毁 ()
        .否则
            
        .如果结束
        
    .如果结束
    
.判断结束


.子程序 _关闭_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.窗口程序集 档案程序集, , , 

.程序集变量 现在项目, 整数型, , , 
.程序集变量 容器, 整数型, , , 
.程序集变量 欲寻找姓名, 文本型, , , 
.程序集变量 欲寻找类型, 文本型, , , 
.程序集变量 字段, 字段信息, , "22", 
.子程序 底图, 空白型, , 
赋值 (., #添加)
赋值 (., #删除)
赋值 (., #上翻)
赋值 (., #下翻)
赋值 (., #关于)
赋值 (., #退出)
连续赋值 (真, ., ., ., ., ., .)

.子程序 保存底图, 空白型, , 
赋值 (., #保存)
赋值 (., 真)
赋值 (., 假)

.子程序 保存底图取消, 空白型, , 
赋值 (., #a)
赋值 (., 真)
赋值 (., 真)

.子程序 状态栏子程序, 空白型, , 
赋值 (., 相加 (“档案总数”, 到文本 (取记录数 ()), “条”, “ ”, “现在为第”, 到文本 (.), “条记录”))

.子程序 组合框赋值, 空白型, , 
连续赋值 (“”, ., ., ., ., ., ., ., ., ., ., ., ., ., ., ., ., ., ., ., ., .)

.子程序 菜单赋真值, 空白型, , 
连续赋值 (真, ., ., ., .)

.子程序 菜单赋假值, 空白型, , 
连续赋值 (假, ., ., ., .)

.子程序 加入, 逻辑型, , 加入成功返回真
.局部变量 姓名, 文本型, , , 

赋值 (姓名, 删全部空 (.))
.如果真 (等于 (., “”))
    信息框 (“没有输入姓名耶！”, #错误图标, “错误”)
    返回 (假)
.如果真结束
.如果真 (等于 (., “正常状态”))
    修改档案 ()
    信息框 (“修改成功！”, #信息图标, “信息”)
    显示 ()
    返回 (假)
.如果真结束
.如果真 (等于 (., “添加状态”))
    .如果真 (等于 (查找 (发音比较 (., 删全部空 (读 (1)), 真, 真)), 真))
        .如果真 (等于 (信息框 (“您输入的档案名已存在,系统默认为覆盖,您确定要这样吗?”, 相加 (#警告图标, #是否钮), “警告”), #是钮))
            修改档案 ()
            信息框 (“覆盖并修改成功！”, #信息图标, “信息”)
        .如果真结束
        返回 (假)
    .如果真结束
    .如果真 (等于 (加记录 (姓名, ., .取项目文本 (.), .取项目文本 (.), ., ., ., ., ., ., ., ., ., ., ., ., ., ., ., ., ., .取项目文本 (.)), 假))
        信息框 (“添加档案失败了耶！”, #错误图标, “错误”)
        返回 (假)
    .如果真结束
    返回 (真)
.如果真结束
返回 (假)

.子程序 修改档案, 空白型, , 
.如果 (等于 (修改 (., ., .取项目文本 (.), .取项目文本 (.), ., ., ., ., ., ., ., ., ., ., ., ., ., ., ., ., ., .取项目文本 (.)), 假))
    信息框 (相加 (“修改档案失败！原因为”, #左引号, 取错误信息 (), #右引号, “。”), #错误图标, “错误”)
.否则
    
.如果结束
 ' 返回 (假)

.子程序 显示, 空白型, , 
.如果真 (或者 (首记录前 (), 尾记录后 ()))
    组合框赋值 ()
    赋值 (., 1)
    赋值 (., {  })
    返回 ()
.如果真结束
赋值 (., 读 (#姓名))
赋值 (., 读 (#生日))
赋值 (., 读 (#性别).选择 ())
赋值 (., 读 (#星座).选择 ())
赋值 (., 读 (#档案类型).选择 ())
赋值 (., 读 (#移动电话))
赋值 (., 读 (#网络呼机))
赋值 (., 读 (#传呼号码))
赋值 (., 读 (#家庭电话))
赋值 (., 读 (#家庭电话2))
赋值 (., 读 (#家庭地址))
赋值 (., 读 (#家庭邮编))
赋值 (., 读 (#工作电话))
赋值 (., 读 (#工作电话2))
赋值 (., 读 (#工作地址))
赋值 (., 读 (#工作邮编))
赋值 (., 读 (#电子信箱))
赋值 (., 读 (#电子信箱))
赋值 (., 读 (#电子信箱2))
赋值 (., 读 (#电子信箱2))
赋值 (., 读 (#主页地址))
赋值 (., 读 (#主页地址))
赋值 (., 读 (#主页地址2))
赋值 (., 读 (#主页地址2))
赋值 (., 读 (#备注))
赋值 (., 读 (#照片))
获取焦点 ()

.子程序 公共字段, 空白型, , 
赋值 (字段 [1]., #姓名)
赋值 (字段 [1]., #文本型)
赋值 (字段 [1]., 14)
赋值 (字段 [2]., #生日)
赋值 (字段 [2]., #文本型)
赋值 (字段 [2]., 14)
赋值 (字段 [3]., #性别)
赋值 (字段 [3]., #文本型)
赋值 (字段 [3]., 8)
赋值 (字段 [4]., #星座)
赋值 (字段 [4]., #文本型)
赋值 (字段 [4]., 22)
赋值 (字段 [5]., #移动电话)
赋值 (字段 [5]., #文本型)
赋值 (字段 [5]., 40)
赋值 (字段 [6]., #网络呼机)
赋值 (字段 [6]., #文本型)
赋值 (字段 [6]., 20)
赋值 (字段 [7]., #传呼号码)
赋值 (字段 [7]., #文本型)
赋值 (字段 [7]., 20)
赋值 (字段 [8]., #家庭电话)
赋值 (字段 [8]., #文本型)
赋值 (字段 [8]., 17)
赋值 (字段 [9]., #家庭电话2)
赋值 (字段 [9]., #文本型)
赋值 (字段 [9]., 17)
赋值 (字段 [10]., #家庭地址)
赋值 (字段 [10]., #文本型)
赋值 (字段 [10]., 60)
赋值 (字段 [11]., #家庭邮编)
赋值 (字段 [11]., #文本型)
赋值 (字段 [11]., 6)
赋值 (字段 [12]., #工作电话)
赋值 (字段 [12]., #文本型)
赋值 (字段 [12]., 17)
赋值 (字段 [13]., #工作电话2)
赋值 (字段 [13]., #文本型)
赋值 (字段 [13]., 17)
赋值 (字段 [14]., #工作地址)
赋值 (字段 [14]., #文本型)
赋值 (字段 [14]., 60)
赋值 (字段 [15]., #工作邮编)
赋值 (字段 [15]., #文本型)
赋值 (字段 [15]., 6)
赋值 (字段 [16]., #电子信箱)
赋值 (字段 [16]., #文本型)
赋值 (字段 [16]., 32)
赋值 (字段 [17]., #电子信箱2)
赋值 (字段 [17]., #文本型)
赋值 (字段 [17]., 32)
赋值 (字段 [18]., #主页地址)
赋值 (字段 [18]., #文本型)
赋值 (字段 [18]., 32)
赋值 (字段 [19]., #主页地址2)
赋值 (字段 [19]., #文本型)
赋值 (字段 [19]., 32)
赋值 (字段 [20]., #备注)
赋值 (字段 [20]., #文本型)
赋值 (字段 [20]., 200)
赋值 (字段 [21]., #照片)
赋值 (字段 [21]., #字节集型)
赋值 (字段 [22]., #档案类型)
赋值 (字段 [22]., #文本型)
赋值 (字段 [22]., 10)

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 文件号, 整数型, , , 

.如果真 (等于 (文件是否存在 (“GTDsys.edb”), 假))
    文件更名 (“docpaswd.EDB”, “GTDsys.edb”)
.如果真结束
.如果真 (等于 (文件是否存在 (“GTData.edb”), 假))
    文件更名 (“hgedoc.EDB”, “GTData.edb”)
.如果真结束
.如果真 (等于 (文件是否存在 (“GTData.edt”), 假))
    文件更名 (“hgedoc.EDT”, “GTData.edt”)
.如果真结束
载入 (密码验证, , 真)
.如果真 (等于 (取文本注册表项 (“Microsoft”, “Windows\CurrentVersion\Run”, “个人档案自启动”, “无”), 相加 (取运行目录 (), “\GTDocument.exe”)))
    赋值 (., 真)
.如果真结束

底图 ()
.如果 (等于 (四舍五入 (相加 (相除 (相加 (相乘 (取数值注册表项 (“GuTang SoftWare\Person Document”, “UserLoginID”, “BookWellID”, ), 230), 200108), 38), 23), ), 取数值注册表项 (“GuTang SoftWare\Person Document”, “UserLoginID”, “LoginCode”, )))
    赋值 (_启动窗口., “个人档案 Ver 3.10”)
    移动 (100, , )
.否则
    赋值 (_启动窗口., “个人档案 Ver 3.10 [未注册] ”)
    菜单赋真值 ()
    载入 (注册窗口, _启动窗口, 真)
.如果结束

.如果真 (等于 (文件是否存在 (“GTData.edb”), 假))
    公共字段 ()
    .如果真 (等于 (创建 (“GTData”, 字段), 假))
        信息框 (“创建档案库失败！”, #错误图标, “错误”)
        结束 ()
    .如果真结束
    
.如果真结束
.如果真 (等于 (打开 (“GTData”, , , , , , ), 假))
    信息框 (“无法打开档案库！”, #错误图标, “错误”)
    结束 ()
.如果真结束
取记录数 ()
到首记录 ()
.计次循环首 (取记录数 (), 容器)
    读 (1).加入项目 ()
    跳到 (相加 (容器, 1))
    取记录号 ()
.计次循环尾 ()
获取焦点 ()
状态栏子程序 ()
赋值 (., “每添加或修改一个档案都必须保存!”)
到首记录 ()
保存底图取消 ()

.子程序 _密码修改_被选择, 空白型, , 
载入 (密码修改, , 真)

.子程序 _退出系统_被选择, 空白型, , 
销毁 ()

.子程序 _添加档案_被选择, 空白型, , 
保存底图 ()
赋值 (., “添加状态”)
赋值 (., “姓名不能为空或带有空格!”)
赋值 (., 真)
添加 ()

.子程序 _保存档案_被选择, 空白型, , 
.如果真 (加入 ())
    .加入项目 (., )
    组合框赋值 ()
    赋值 (., {  })
    获取焦点 ()
.如果真结束
赋值 (., 取记录号 ())
显示 ()
状态栏子程序 ()
赋值 (., 假)
赋值 (., “正常状态”)

.子程序 _删除档案_被选择, 空白型, , 
.如果真 (等于 (., 0))
    信息框 (“对不起，请先选择您所要删除的朋友名字！”, #错误图标, “错误”)
    返回 ()
.如果真结束
.如果真 (并且 (等于 (首记录前 (), 假), 等于 (尾记录后 (), 假), 等于 (信息框 (“您真的要删除此朋友吗？”, 相加 (#询问图标, #是否钮, #默认按钮二), “询问”), #是钮)))
    删除 ()
    彻底删除 ()
    .删除项目 (.)
    刷新显示 ()
    赋值 (., 0)
    显示 ()
.如果真结束
状态栏子程序 ()
赋值 (., 0)

.子程序 添加, 空白型, , 
组合框赋值 ()
赋值 (., 1)
赋值 (., 0)
赋值 (., {  })
获取焦点 ()
赋值 (., 0)

.子程序 _姓名查询框_列表项被选择, 空白型, , 
保存底图 ()
状态栏子程序 ()
赋值 (欲寻找姓名, .)
到首记录 ()
.如果真 (等于 (查找 (发音比较 (欲寻找姓名, 删全部空 (读 (#姓名)), 真, 真)), 假))
    信息框 (“未找到指定朋友！”, #信息图标, “信息”)
    保存底图取消 ()
    赋值 (., 0)
    添加 ()
    获取焦点 ()
    返回 ()
.如果真结束
显示 ()

.子程序 _使用帮助_被选择, 空白型, , 
信息框 (“对不起,作者还未编写帮助文件!”, #信息图标, “信息”)

.子程序 _作者信箱_被选择, 空白型, , 
跳转 ()

.子程序 _关于软件_被选择, 空白型, , 
载入 (启动画面, , 真)

.子程序 _添加_被单击, 空白型, , 
_添加档案_被选择 ()

.子程序 _保存_被单击, 空白型, , 
_保存档案_被选择 ()

.子程序 _删除_被单击, 空白型, , 
_删除档案_被选择 ()

.子程序 _上翻_被单击, 空白型, , 
_上一档案_被选择 ()

.子程序 _下翻_被单击, 空白型, , 
_下一档案_被选择 ()

.子程序 _关于_被单击, 空白型, , 
载入 (启动画面, , 真)

.子程序 _退出_被单击, 空白型, , 
销毁 ()

.子程序 _软件注册_被选择, 空白型, , 
载入 (注册窗口, , 真)

.子程序 _系统时钟_周期事件, 空白型, , 
赋值 (., 相加 (“北京时间”, “ ”, 到文本 (取年份 (取现行时间 ())), “年”, 到文本 (取月份 (取现行时间 ())), “月”, 到文本 (取日 (取现行时间 ())), “日”, “ ”, “”, 到文本 (取小时 (取现行时间 ())), “:”, 到文本 (取分钟 (取现行时间 ())), “:”, 到文本 (取秒 (取现行时间 ()))))

.子程序 _自启动_被选择, 空白型, , 
.如果 (等于 (., 真))
    赋值 (., 假)
    删除注册表项 (“Microsoft”, “Windows\CurrentVersion\Run”, “个人档案自启动”)
.否则
    赋值 (., 真)
    写注册表项 (“Microsoft”, “Windows\CurrentVersion\Run”, “个人档案自启动”, 相加 (取运行目录 (), “\GTDocument.exe”))
.如果结束


.子程序 _至档案首_被选择, 空白型, , 
到首记录 ()
赋值 (., 取记录号 ())
显示 ()
状态栏子程序 ()

.子程序 _至档案尾_被选择, 空白型, , 
到尾记录 ()
赋值 (., 取记录号 ())
显示 ()
状态栏子程序 ()

.子程序 _清空库_被选择, 空白型, , 
.如果真 (等于 (信息框 (“这项操作具体有不可恢复性,您确定要清除档案库所有记录吗?”, 相加 (#警告图标, #是否钮), “警告”), #是钮))
    .如果 (等于 (清空 (), 真))
        信息框 (“档案库已全部清空!”, #警告图标, “警告”)
        .如果真 (大于 (取项目数 (), 0))
            1.删除项目 ()
            清空 ()
            “[查找姓名] ”.加入项目 (0)
            赋值 (., 0)
            返回 ()
            状态栏子程序 ()
        .如果真结束
        
    .否则
        信息框 (“档案库清空失败!”, #警告图标, “警告”)
    .如果结束
    
.如果真结束


.子程序 _备份库_被选择, 空白型, , 
_备份档案 ()

.子程序 _下一档案_被选择, 空白型, , 
.如果真 (小于 (取记录号 (), 取记录数 ()))
    跳过 ()
    赋值 (., 取记录号 ())
    显示 ()
    状态栏子程序 ()
.如果真结束


.子程序 _上一档案_被选择, 空白型, , 
.如果真 (等于 (尾记录后 (), 假))
    .如果真 (大于 (取记录号 (), 1))
        跳过 (-1)
        赋值 (., 取记录号 ())
        显示 ()
        状态栏子程序 ()
    .如果真结束
    
.如果真结束


.子程序 _清除注册表项_被选择, 空白型, , 
.如果真 (等于 (信息框 (“这项操作将清除本软件在注册表中的项目包括注册码,您确定要清除吗?”, 相加 (#警告图标, #是否钮), “警告”), #是钮))
    写注册表项 (“GuTang Soft\Person Document”, “UserLoginID”, “LoginCode”, 0)
    赋值 (_启动窗口., “个人档案 Ver 3.05 标准版 [未注册] ”)
.如果真结束
返回 ()

.子程序 _观注升级_被选择, 空白型, , 
跳转 ()

.子程序 _删除照片_被选择, 空白型, , 
赋值 (., {  })

.子程序 _添加照片_被选择, 空白型, , 
.如果真 (等于 (打开 (), 真))
    赋值 (., 读入文件 (.))
.如果真结束


.子程序 _照片_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.窗口程序集 密码程序集, , , 

.子程序 _密码修改_创建完毕, 空白型, , 
置当前库 (“GTDsys”)
信息框 (相加 (“请不要设置不安全的密码！”, #换行符, “安全密码应包含符号，数字，大小写字母！”, #换行符, “密码最大长度为88个字符，中文占用两个字符！”), 64, “注意”)

.子程序 _取消_被单击, 空白型, , 
销毁 ()

.子程序 _确定_被单击, 空白型, , 
.如果真 (不等于 (., 读 (#密码)))
    信息框 (“原密码不正确！”, 16, “错误”)
    赋值 (., “”)
    赋值 (., “”)
    赋值 (., “”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (或者 (等于 (., “”), 等于 (., “”)))
    信息框 (“密码不能为空！”, 16, “错误”)
    赋值 (., “”)
    赋值 (., “”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (不等于 (., .))
    信息框 (“新密码不一致，请重新输入！”, 16, “错误”)
    赋值 (., “”)
    赋值 (., “”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (修改 (.), 假))
    信息框 (“密码修改不成功！”, 16, “错误”)
    销毁 ()
.如果真结束
信息框 (“密码修改成功！”, 64, “成功”)
销毁 ()

.窗口程序集 验证程序集, , , 

.子程序 _密码验证_可否被关闭, 逻辑型, , 
返回 (假)

.子程序 _密码验证_创建完毕, 空白型, , 
.局部变量 字段, 字段信息, , "10", 

载入 (启动画面, , 真)
获取焦点 ()
.如果真 (等于 (文件是否存在 (“GTDsys.edb”), 假))
    赋值 (字段 [1]., #密码)
    赋值 (字段 [1]., #文本型)
    赋值 (字段 [1]., 88)
    .如果真 (等于 (创建 (“GTDsys”, 字段), 假))
        信息框 (“创建系统库失败！”, 16, “错误”)
        结束 ()
    .如果真结束
    
    置文件属性 (“GTDsys.edb”, 2)
.如果真结束
.如果真 (等于 (打开 (“GTDsys”, , , , , , ), 假))
    信息框 (“系统库受损，请重新安装本软件！”, #错误图标, “错误”)
    结束 ()
.如果真结束
.如果真 (并且 (等于 (取记录数 (), 0), 等于 (等于 (读 (1), “”), 真)))
    加记录 (“”)
    赋值 (., “请尽快设置密码，初始为空！”)
.如果真结束
.如果真 (等于 (等于 (读 (1), “”), 假))
    赋值 (., “”)
    赋值 (., “请输入的您的验证密码！”)
.如果真结束


.子程序 _验证框_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.如果真 (不等于 (字符代码, #回车键))
    返回 (字符代码)
.如果真结束
密码验证 ()

.子程序 密码验证, 空白型, , 
.如果 (等于 (., 读 (1)))
    赋值 (., “”)
    载入 (_启动窗口, , 假)
    销毁 ()
.否则
    赋值 (., “对不起,您输入的密码错误!”)
.如果结束


.子程序 _确定_被单击, 空白型, , 
密码验证 ()

.子程序 _取消_被单击, 空白型, , 
销毁 ()
_启动窗口.销毁 ()

.程序集 备份程序集, , , 

.子程序 _备份档案, 空白型, , 
.局部变量 备份目录, 文本型, , , 
.局部变量 创建目录, 文本型, , , 
.局部变量 找到位置, 短整数型, , , 
.局部变量 文件名, 文本型, , , 
.局部变量 修改记录数, 空白型, , , 

.如果 (输入框 (相加 (“系统将在当前程序目录下建立备份目录：”, #换行符, #换行符, “    您也可以自行修改备份目录,若您输入的目录不存在，程序将自动创建该目录！”), 取当前目录 (), “DATA”, 备份目录, ))
    .如果真 (等于 (备份目录, “”))
        赋值 (备份目录, “data”)
    .如果真结束
    .如果真 (等于 (寻找文件 (备份目录, #子目录), “”))
        赋值 (找到位置, 寻找文本 (备份目录, “\”, , 真))
        .如果真 (不等于 (找到位置, -1))
            赋值 (找到位置, 寻找文本 (备份目录, “\”, 相加 (找到位置, 1), 真))
            .判断循环首 (不等于 (找到位置, -1))
                赋值 (创建目录, 取文本左边 (备份目录, 相减 (找到位置, 1)))
                .如果真 (等于 (寻找文件 (创建目录, #子目录), “”))
                    .如果真 (等于 (创建目录 (创建目录), 假))
                        信息框 (相加 (“创建目录”, 备份目录, “失败！请重新选择目录。”), #错误图标, “错误”)
                        返回 ()
                    .如果真结束
                    
                .如果真结束
                赋值 (找到位置, 寻找文本 (备份目录, “\”, 相加 (找到位置, 1), 真))
            .判断循环尾 ()
        .如果真结束
        .如果真 (等于 (创建目录 (备份目录), 假))
            信息框 (相加 (“创建目录”, 备份目录, “失败！请重新选择目录。”), #错误图标, “错误”)
            返回 ()
        .如果真结束
        
    .如果真结束
    .如果真 (不等于 (取文本右边 (备份目录, 1), “\”))
        赋值 (备份目录, 相加 (备份目录, “\”))
    .如果真结束
    赋值 (文件名, 寻找文件 (“*.edb”, ))
    .判断循环首 (不等于 (文件名, “”))
        复制文件 (文件名, 相加 (备份目录, 文件名))
        赋值 (文件名, 寻找文件 ())
    .判断循环尾 ()
    赋值 (文件名, 寻找文件 (“*.edt”, ))
    .判断循环首 (不等于 (文件名, “”))
        复制文件 (文件名, 相加 (备份目录, 文件名))
        赋值 (文件名, 寻找文件 ())
    .判断循环尾 ()
    信息框 (“已成功备份数据！”, #信息图标, “信息”)
    赋值 (修改记录数, 0)
.否则
    信息框 (“及时地备份数据库是一个好习惯，希望你能经常备份！”, #信息图标, “信息”)
.如果结束


.窗口程序集 注册程序集, , , 

.程序集变量 注册码, 整数型, , , 
.程序集变量 文件号, 整数型, , , 
.程序集变量 随机号, 整数型, , , 
.子程序 _注册窗口_创建完毕, 空白型, , 
赋值 (文件号, 打开文件 (相加 (取当前目录 (), “\Readme.txt”), , ))
赋值 (., 读入文本 (文件号, ))
关闭文件 (文件号)
赋值 (., 相加 (“使用权授予：”, 取文本注册表项 (“GuTang SoftWare\Person Document”, “3.05”, “组织名称”, ), “  ”, 取文本注册表项 (“GuTang SoftWare\Person Document”, “3.05”, “用户名”, )))
赋值 (取随机注册号, 取数值注册表项 (“GuTang SoftWare\Person Document”, “UserLoginID”, “BookWellID”, ))
赋值 (取注册号, 取数值注册表项 (“GuTang SoftWare\Person Document”, “UserLoginID”, “LoginCode”, ))
赋值 (运算号, 四舍五入 (相加 (相除 (相加 (相乘 (随机号, 230), 200108), 38), 23), ))
置随机数种子 ()
.如果 (等于 (四舍五入 (相加 (相除 (相加 (相乘 (取随机注册号, 230), 200108), 38), 23), ), 取注册号))
    赋值 (注册窗口., “感谢您支持聚堂软件”)
    赋值 (., “您已经注册了！”)
    连续赋值 (假, ., ., ., ., .)
    返回 ()
.否则
    赋值 (_启动窗口., “个人档案 Ver 3.10 [未注册] ”)
    赋值 (., “您还未注册！”)
    写注册表项 (“GuTang SoftWare\Person Document”, “UserLoginID”, “LoginCode”, 0)
.如果结束
.如果 (大于或等于 (取随机注册号, 100000)) ' 如果已有注册好但没有注册码就运行以下代码
    赋值 (随机号, 取随机注册号)
    赋值 (., 到文本 (随机号))
    获取焦点 ()
.否则
    赋值 (随机号, 取随机数 (100000, 100000000))
    写注册表项 (“GuTang SoftWare\Person Document”, “UserLoginID”, “BookWellID”, 随机号)
    赋值 (., 到文本 (随机号))
    写注册表项 (“GuTang SoftWare\Person Document”, “UserLoginID”, “LoginCode”, 注册码)
.如果结束
赋值 (注册窗口., “希望您能支持聚堂软件”)

.子程序 _现在注册_被单击, 空白型, , 
.如果 (等于 (., “现在注册”))
    .如果 (等于 (., “”))
        信息框 (“请输入注册码”, #信息图标, “注意”)
        获取焦点 ()
        .如果 (等于 (信息框 (“我现在不想注册！”, 相加 (#询问图标, #是否钮), “注意”), #是钮))
            注册窗口.销毁 ()
        .否则
            
        .如果结束
        返回 ()
    .否则
        赋值 (注册码, 运算号)
        .如果 (不等于 (运算号, 到数值 (删全部空 (.))))
            信息框 (“注册码错误,请跟作者联系！”, #警告图标, “注意：”)
            获取焦点 ()
            返回 ()
        .否则
            .如果 (等于 (运算号, 到数值 (删全部空 (.))))
                写注册表项 (“GuTang SoftWare\Person Document”, “UserLoginID”, “LoginCode”, 到数值 (删全部空 (.)))
                信息框 (“注册成功”, #信息图标, “恭喜恭喜！”)
                赋值 (_启动窗口., “个人档案 Ver 3.10”)
                菜单赋假值 ()
                注册窗口.销毁 ()
                返回 ()
            .否则
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.否则
    
.如果结束



.子程序 _稍后注册_被单击, 空白型, , 
销毁 ()


 ' 不属于任何一个程序集、类模块的函数：
