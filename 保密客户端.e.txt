 ' 文件类型：Windows窗口程序

 ' 程序名称：数据库客户端
 ' 程序描述：自己学习易语言编写的第一个数据库操作客户端
 ' 程序作者：龙的光芒
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：pg197752@yahoo.com.cn
 ' 主页地址：
 ' 版权声明：请提出宝贵意见
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 480
    高度 = 327
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 登录窗口
    左边 = 50
    顶边 = 50
    宽度 = 351
    高度 = 230
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 密码修改窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\保密客户端.e\密码修改窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “密码修改”
    帮助文件名 = “”

窗口 日志窗口
    左边 = 50
    顶边 = 50
    宽度 = 448
    高度 = 298
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\保密客户端.e\日志窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “系统日志”
    帮助文件名 = “”

窗口 用户管理窗口
    左边 = 50
    顶边 = 50
    宽度 = 541
    高度 = 310
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\保密客户端.e\用户管理窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “用户管理”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库
 ' ESSLayer 931A3D5BC194493f97A2830FE4D7A32D 1 4 保密通讯支持库
 ' EDataStructure 0AFF5F28B2CB42ce906AA27D6E485457 1 2 数据结构支持库




.全局变量 客户端程序, 未知类型0x50002, , , 
.全局变量 数据行分割串, 文本型, , , "@$&"
.全局变量 填充串, 文本型, , , "|"
.全局变量 取回的数据, 文本型, , , 
.全局变量 请求信息, 文本型, , , 
.全局变量 匿名全局变量_84, 空白型, , , 
.全局变量 全局_用户管理权限, 逻辑型, , , 0―管理员
.全局变量 全局_查询权限, 逻辑型, , , 1―查询
.全局变量 全局_增加权限, 逻辑型, , , 2―增加
.全局变量 全局_修改权限, 逻辑型, , , 3―修改
.全局变量 全局_删除权限, 逻辑型, , , 4―删除
.全局变量 全局_查看权限, 逻辑型, , , 5―查看
.全局变量 全局_打印权限, 逻辑型, , , 6―打印
.全局变量 全局_其它7, 逻辑型, , , 7―其它
.全局变量 全局_其它8, 逻辑型, , , 8―其它
.全局变量 全局_其它9, 逻辑型, , , 9―其它
.全局变量 匿名全局变量_95, 空白型, , , 
.全局变量 操作员, 文本型, , , 
.全局变量 权限, 文本型, , , 
.全局变量 IP地址, 文本型, , , 
.全局变量 匿名全局变量_107, 空白型, , , 
.全局变量 登录表节点, 未知类型0x60001, , , 
.全局变量 登录表, 未知类型0x60002, , , 
.全局变量 密码容器, 文本型, , , 

.窗口程序集 窗口程序集_密码修改窗口, , , 

.子程序 _密码修改窗口_创建完毕, 空白型, , 
未知支持库函数_0 (#)
文本填充分割串设置 ()
赋值 (.内容, 操作员)

.子程序 _确定_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (“原密码不能为空！”, 16, “错误”)
    返回 ()
.如果真结束
.如果真 (不等于 (.内容, 密码容器))
    信息框 (“原密码不正确，请重新输入密码。”, 16, “错误”)
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“密码不能为空！请输入密码。”, 16, “错误”)
    返回 ()
.如果真结束
.如果真 (不等于 (.内容, .内容))
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    信息框 (“密码较验不一致！请重新输入密码。”, 16, “错误”)
    返回 ()
.如果真结束
赋值 (请求信息, “修改密码”)
客户端程序.未知支持库函数_21 (相加 (请求信息, 填充串, 操作员, 填充串, .内容, 填充串))

.子程序 _重置_被单击, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)

.子程序 _退出_被单击, 空白型, , 
密码修改窗口.销毁 ()

.子程序 密码修改调用子程序, 空白型, , 
.局部变量 取回的数据1, 字节集, , , 

客户端程序.未知支持库函数_20 (取回的数据1)
赋值 (取回的数据, 取字节集数据 (取回的数据1, #文本型, ))
.如果真 (等于 (取回的数据, “修改成功”))
    赋值 (密码容器, 密码修改窗口..内容)
    信息框 (“密码修改成功！”, 相加 (0, 64), “信息”)
.如果真结束
.如果真 (等于 (取回的数据, “修改失败”))
    信息框 (“密码修改失败！”, 相加 (0, 64), “信息”)
.如果真结束


.窗口程序集 窗口程序集_启动窗口, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
未知支持库函数_0 (#)
文本填充分割串设置 ()
载入 (登录窗口, _启动窗口, 假)

.子程序 _重新登录_被选择, 空白型, , 
.如果真 (等于 (信息框 (“你将重新登录，是否要退出本次登录？”, 相加 (1, 32), “提示”), 0))
    赋值 (请求信息, “退出系统”)
    客户端程序.未知支持库函数_21 (相加 (请求信息, 填充串, 操作员, 填充串))
.如果真结束


.子程序 重新登录处理子程序, 空白型, , 
.局部变量 取回的数据1, 字节集, , , 

客户端程序.未知支持库函数_20 (取回的数据1)
赋值 (取回的数据, 取字节集数据 (取回的数据1, #文本型, ))
.如果真 (等于 (取回的数据, “日志添加成功”))
    赋值 (_启动窗口., 假)
    赋值 (登录窗口., 真)
    赋值 (登录窗口..内容, “”)
    赋值 (登录窗口..内容, “”)
    .如果真 (等于 (是否已创建 (密码修改窗口), 真))
        密码修改窗口.销毁 ()
    .如果真结束
    .如果真 (等于 (是否已创建 (日志窗口), 真))
        日志窗口.销毁 ()
    .如果真结束
    .如果真 (等于 (是否已创建 (用户管理窗口), 真))
        用户管理窗口.销毁 ()
    .如果真结束
    
.如果真结束
.如果真 (等于 (取回的数据, “日志添加失败”))
    信息框 (“服务器与客户端有数据连接请稍候重试！”, 相加 (0, 64), “提示！”)
.如果真结束



.子程序 _密码更改_被选择, 空白型, , 
载入 (密码修改窗口, _启动窗口, 假)

.子程序 _用户管理_被选择, 空白型, , 
载入 (用户管理窗口, _启动窗口, 假)

.子程序 _系统帮助_被选择, 空白型, , 
信息框 (相加 (“制作中”, #换行符, “哈哈！！！”), 相加 (0, 64), “帮助”)

.子程序 _系统日志_被选择, 空白型, , 
载入 (日志窗口, _启动窗口, 假)

.子程序 _关于_被选择, 空白型, , 
信息框 (相加 (“制作中”, #换行符, “哈哈！！！”), 相加 (0, 64), “关于”)

.子程序 __启动窗口_首次激活, 空白型, , 
赋值 (_启动窗口., 假)

.子程序 __启动窗口_被显示, 空白型, , 
.局部变量 权限1, 文本型, , , 

根据用户取不同权限 (权限)
.如果 (等于 (全局_用户管理权限, 真))
    赋值 (权限1, “管理员”)
.否则
    赋值 (权限1, “普通用户”)
.如果结束
2.置文本 (操作员)
4.置文本 (权限1)
根据不同权限显示不同菜单 ()


.子程序 __启动窗口_可否被关闭, 逻辑型, , 
赋值 (请求信息, “退退出系统”)
客户端程序.未知支持库函数_21 (相加 (请求信息, 填充串, 操作员, 填充串))
返回 (假)

.子程序 程序退出处理子程序, 空白型, , 
.局部变量 取回的数据1, 字节集, , , 

客户端程序.未知支持库函数_20 (取回的数据1)
赋值 (取回的数据, 取字节集数据 (取回的数据1, #文本型, ))
.如果真 (等于 (取回的数据, “日志添加成功”))
    结束 ()
.如果真结束
.如果真 (等于 (取回的数据, “日志添加失败”))
    信息框 (“服务器与客户端有数据连接请稍候重试！”, 相加 (0, 64), “提示！”)
.如果真结束


.窗口程序集 窗口程序集_登录窗口, , , 

.子程序 _登录窗口_创建完毕, 空白型, , 
未知支持库函数_0 (#)
文本填充分割串设置 ()
连接公钥设置子程序 ()
.如果 (不等于 (读系统配置 (“服务器IP地址”, ), “”))
    赋值 (., 读系统配置 (“服务器IP地址”, ))
    赋值 (登录窗口., 230)
    赋值 (IP地址, 登录窗口..)
    .如果 (等于 (客户端程序.未知支持库函数_17 (IP地址, 12345, &处理函数), 假))
        信息框 (“连接到服务器失败，请检查服务器配置或服务器未启动”, 相加 (0, 64), “连接错误”)
        赋值 (登录窗口., 相加 (“客户端登录”, “：”, “未与服务器连接”))
        赋值 (登录窗口., 325)
        返回 ()
    .否则
        赋值 (登录窗口., 相加 (“客户端登录”, “：”, “已与服务器连接”))
    .如果结束
    
.否则
    信息框 (“请配置服务器地址”, 相加 (0, 64), “配置错误”)
    赋值 (登录窗口., 相加 (“客户端登录”, “：”, “未与服务器连接”))
    赋值 (登录窗口., 325)
    返回 ()
.如果结束


.子程序 处理函数, 空白型, , 
.局部变量 消息代码, 空白型, , , 

判断服务器端返回的代码,返回1表示有服务器主动或意外断开与客户程序的连接，返回2表示有数据到达客户程序，返回-1表示出错。
赋值 (消息代码, 客户端程序.未知支持库函数_19 ())
.如果 (等于 (消息代码, 1))
    赋值 (登录窗口., 真)
    赋值 (_启动窗口., 假)
    信息框 (“服务器断开请联系管理员检查服务器”, 相加 (0, 64), “服务器错误 ”)
    赋值 (登录窗口., 相加 (“客户端登录”, “：”, “未与服务器连接”))
    赋值 (登录窗口., 325)
.否则
    .如果 (等于 (消息代码, -1))
        信息框 (“出错”, 0, )
    .否则
        .如果 (等于 (消息代码, 2))
            网络数据处理方法 ()
        .否则
            
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 _组合框1_将弹出列表, 空白型, , 
.局部变量 用户名称值, 文本型, , , 

赋值 (请求信息, “取登录表用户名称”)
客户端程序.未知支持库函数_21 (请求信息)

.子程序 _登录按钮_被单击, 空白型, , 
.局部变量 登录名, 文本型, , , 
.局部变量 密码1, 文本型, , , 

赋值 (登录名, 相加 (.内容, 填充串))
赋值 (密码1, 相加 (.内容, 填充串))
赋值 (请求信息, “核对登录表”)
客户端程序.未知支持库函数_21 (相加 (请求信息, 填充串, 登录名, 密码1))

.子程序 _设置按钮_被单击, 空白型, , 
.如果真 (等于 (信息框 (相加 (“进行设置将断开与服务器的连接。”, #换行符, “你确认要设置吗？”), 相加 (1, 32), “注意”), 0))
    客户端程序.未知支持库函数_18 ()
    赋值 (登录窗口., 相加 (“客户端登录”, “：”, “未与服务器连接”))
    赋值 (登录窗口., 325)
.如果真结束
返回 ()

.子程序 _退出按钮_被单击, 空白型, , 
.如果真 (等于 (信息框 (“是否要退出系统？”, 相加 (1, 32), “提示”), 0))
    登录窗口.销毁 ()
    _启动窗口.销毁 ()
.如果真结束
返回 ()

.子程序 _登录按钮_获得焦点, 空白型, , 
赋值 (., 假)
赋值 (.类型, 1)

.子程序 _设置按钮_获得焦点, 空白型, , 
赋值 (., 假)
赋值 (.类型, 1)

.子程序 _退出按钮_获得焦点, 空白型, , 
赋值 (., 假)
赋值 (.类型, 1)

.子程序 _连接按钮_被单击, 空白型, , 
.局部变量 IP地址1, 文本型, , , 

.如果 (等于 (., “”))
    信息框 (“请配置服务器地址，IP地址不能为空”, 相加 (0, 64), “空地址”)
    返回 ()
.否则
    
.如果结束
.如果 (并且 (不等于 (读系统配置 (“服务器IP地址”, ), “”), 等于 (., 读系统配置 (“服务器IP地址”, ))))
    赋值 (IP地址1, .)
    .如果 (等于 (客户端程序.未知支持库函数_17 (IP地址1, 12345, &处理函数), 假))
        信息框 (“连接到服务器失败，请检查服务器配置或服务器未启动”, 相加 (0, 64), “连接错误”)
        赋值 (登录窗口., 相加 (“客户端登录”, “：”, “未与服务器连接”))
        赋值 (登录窗口., 325)
        返回 ()
    .否则
        赋值 (登录窗口., 相加 (“客户端登录”, “：”, “已与服务器连接”))
        赋值 (登录窗口., 230)
    .如果结束
    
.否则
    .如果 (不等于 (., 读系统配置 (“服务器IP地址”, )))
        信息框 (“服务器地址未保存请先保存”, 相加 (0, 64), “未保存”)
    .否则
        返回 ()
    .如果结束
    
.如果结束


.子程序 _保存按钮_被单击, 空白型, , 
.局部变量 IP地址1, 文本型, , , 

.如果 (等于 (写系统配置 (“服务器IP地址”, .), 真))
    信息框 (“写入配置成功”, 相加 (0, 64), “写入成功”)
    赋值 (IP地址1, 读系统配置 (“服务器IP地址”, ))
.否则
    信息框 (“写入配置错误”, 相加 (0, 64), “写入错误”)
    返回 ()
.如果结束


.子程序 _登录窗口_可否被关闭, 逻辑型, , 
信息框 (“不可由此关闭登录对话框”, 相加 (0, 64), “提示！”)
返回 (假)

.子程序 _登录窗口_被隐藏, 空白型, , 
_启动窗口.激活 ()

.子程序 用户登录核对调用子程序, 空白型, , 
.局部变量 取回的数据1, 字节集, , , 
.局部变量 已分割的文本, 文本型, , "0", 

客户端程序.未知支持库函数_20 (取回的数据1)
赋值 (取回的数据, 取字节集数据 (取回的数据1, #文本型, ))
.如果真 (等于 (取文本左边 (取回的数据, 8), “核对成功”))
    赋值 (已分割的文本, 分割文本 (取回的数据, 填充串, ))
    赋值 (操作员, 已分割的文本 [2])
    赋值 (权限, 已分割的文本 [3])
    赋值 (密码容器, 登录窗口..内容)
    赋值 (_启动窗口., 真)
    赋值 (登录窗口., 假)
.如果真结束
.如果真 (等于 (取回的数据, “核对错误”))
    信息框 (“用户名或密码错误，请重新输入”, 相加 (0, 64), “错误”)
    赋值 (登录窗口..内容, “”)
.如果真结束


.子程序 用户名称组合框调用数据子程序, 空白型, , 
.局部变量 取回的数据1, 字节集, , , 
.局部变量 已分割的文本, 文本型, , "0", 
.局部变量 分割的数量, 整数型, , , 
.局部变量 变量3, 整数型, , , 

客户端程序.未知支持库函数_20 (取回的数据1)
赋值 (取回的数据, 取字节集数据 (取回的数据1, #文本型, ))
赋值 (已分割的文本, 分割文本 (取回的数据, 填充串, ))
赋值 (分割的数量, 取数组成员数 (已分割的文本))
登录窗口.清空 (.)
.计次循环首 (分割的数量, 变量3)
    登录窗口.加入项目 (., 已分割的文本 [变量3], 变量3)
.计次循环尾 ()

.窗口程序集 窗口程序集_日志窗口, , , 

.子程序 _日志窗口_创建完毕, 空白型, , 
未知支持库函数_0 (#)
文本填充分割串设置 ()
赋值 (请求信息, “取系统表”)
客户端程序.未知支持库函数_21 (请求信息)

.子程序 _关闭按钮_被单击, 空白型, , 
日志窗口.销毁 ()

.子程序 _清空按钮_被单击, 空白型, , 
.如果 (不等于 (取表项数 (), 0))
    赋值 (请求信息, “删除系统”)
    客户端程序.未知支持库函数_21 (请求信息)
    信息框 (“日志被清空”, 相加 (0, 64), “信息”)
.否则
    信息框 (“没有日志记录”, 相加 (0, 64), “信息”)
.如果结束


.子程序 _刷新按钮_被单击, 空白型, , 
全部删除 ()
赋值 (请求信息, “取系统表”)
客户端程序.未知支持库函数_21 (请求信息)

.子程序 _刷新按钮_获得焦点, 空白型, , 
赋值 (., 假)
赋值 (.类型, 1)

.子程序 _清空按钮_获得焦点, 空白型, , 
赋值 (., 假)
赋值 (.类型, 1)

.子程序 _关闭按钮_获得焦点, 空白型, , 
赋值 (., 假)
赋值 (.类型, 1)

.子程序 系统列表显示调用子程序, 空白型, , 
.局部变量 取回的数据1, 字节集, , , 
.局部变量 已分割的文本, 文本型, , "0", 
.局部变量 分割的数量, 整数型, , , 
.局部变量 变量1, 整数型, , , 
.局部变量 变量2, 整数型, , , 
.局部变量 数据表文本, 文本型, , "0", 
.局部变量 数据表列数, 整数型, , , 

客户端程序.未知支持库函数_20 (取回的数据1)
赋值 (取回的数据, 取字节集数据 (取回的数据1, #文本型, ))
赋值 (已分割的文本, 分割文本 (取回的数据, 数据行分割串, ))
赋值 (分割的数量, 取数组成员数 (已分割的文本))
日志窗口.全部删除 (.)
.计次循环首 (分割的数量, 变量1)
    赋值 (变量2, 日志窗口.插入表项 (., , 到文本 (变量1), , , , ))
    赋值 (数据表文本, 分割文本 (已分割的文本 [变量1], 填充串, ))
    赋值 (数据表列数, 取数组成员数 (数据表文本))
    日志窗口.置标题 (., 变量2, 1, 数据表文本 [1])
    日志窗口.置标题 (., 变量2, 2, 数据表文本 [2])
    日志窗口.置标题 (., 变量2, 3, 数据表文本 [3])
    日志窗口.置标题 (., 变量2, 4, 数据表文本 [4])
.计次循环尾 ()

.子程序 系统列表删除调用子程序, 空白型, , 
.局部变量 取回的数据1, 字节集, , , 

客户端程序.未知支持库函数_20 (取回的数据1)
赋值 (取回的数据, 取字节集数据 (取回的数据1, #文本型, ))
.如果 (等于 (取回的数据, “系统删除成功”))
    日志窗口.全部删除 (.)
.否则
    
.如果结束


.程序集 公用程序集, , , 

.子程序 网络数据处理方法, 空白型, , 
.如果 (等于 (请求信息, “取系统表”))
    系统列表显示调用子程序 ()
.否则
    
.如果结束
.如果 (等于 (请求信息, “删除系统”))
    系统列表删除调用子程序 ()
.否则
    
.如果结束
.如果 (等于 (请求信息, “取登录表用户名称”))
    用户名称组合框调用数据子程序 ()
.否则
    
.如果结束
.如果 (等于 (请求信息, “核对登录表”))
    用户登录核对调用子程序 ()
.否则
    
.如果结束
.如果 (等于 (请求信息, “修改密码”))
    密码修改调用子程序 ()
.否则
    
.如果结束
.如果 (等于 (请求信息, “取登录表”))
    取登录表数据处理调用子程序 ()
.否则
    
.如果结束
.如果 (等于 (请求信息, “增加登录”))
    登录表记录添加后的处理子程序 ()
.否则
    
.如果结束
.如果 (等于 (请求信息, “修改登录”))
    登录表记录修改后的处理子程序 ()
.否则
    
.如果结束
.如果 (等于 (请求信息, “删除登录”))
    登录表记录删除后的处理子程序 ()
.否则
    
.如果结束
.如果 (等于 (请求信息, “退退出系统”))
    程序退出处理子程序 ()
.否则
    
.如果结束
.如果 (等于 (请求信息, “退出系统”))
    重新登录处理子程序 ()
.否则
    
.如果结束


.子程序 读系统配置, 文本型, , 
.参数 读取的配置名, 文本型, , 
.参数 默认值, 文本型, 可空, 

返回 (读配置项 (相加 (取运行目录 (), “\Config.ini”), “系统配置”, 读取的配置名, 默认值))


.子程序 写系统配置, 逻辑型, , 
.参数 写入的配置名, 文本型, , 
.参数 写入值, 文本型, , 

返回 (写配置项 (相加 (取运行目录 (), “\Config.ini”), “系统配置”, 写入的配置名, 写入值))


.子程序 根据用户取不同权限, 空白型, , 
.参数 权限1, 文本型, , 

.判断开始 (不等于 (寻找文本 (权限1, “0”, , 假), -1))
    赋值 (全局_用户管理权限, 真)
.默认
    赋值 (全局_用户管理权限, 假)
.判断结束
.判断开始 (不等于 (寻找文本 (权限1, “1”, , 假), -1))
    赋值 (全局_查询权限, 真)
.默认
    赋值 (全局_查询权限, 假)
.判断结束
.判断开始 (不等于 (寻找文本 (权限1, “2”, , 假), -1))
    赋值 (全局_增加权限, 真)
.默认
    赋值 (全局_增加权限, 假)
.判断结束
.判断开始 (不等于 (寻找文本 (权限1, “3”, , 假), -1))
    赋值 (全局_修改权限, 真)
.默认
    赋值 (全局_修改权限, 假)
.判断结束
.判断开始 (不等于 (寻找文本 (权限1, “4”, , 假), -1))
    赋值 (全局_删除权限, 真)
.默认
    赋值 (全局_删除权限, 假)
.判断结束
.判断开始 (不等于 (寻找文本 (权限1, “5”, , 假), -1))
    赋值 (全局_查看权限, 真)
.默认
    赋值 (全局_查看权限, 假)
.判断结束
.判断开始 (不等于 (寻找文本 (权限1, “6”, , 假), -1))
    赋值 (全局_打印权限, 真)
.默认
    赋值 (全局_打印权限, 假)
.判断结束
.判断开始 (不等于 (寻找文本 (权限1, “7”, , 假), -1))
    赋值 (全局_其它7, 真)
.默认
    赋值 (全局_其它7, 假)
.判断结束
.判断开始 (不等于 (寻找文本 (权限1, “8”, , 假), -1))
    赋值 (全局_其它8, 真)
.默认
    赋值 (全局_其它8, 假)
.判断结束
.判断开始 (不等于 (寻找文本 (权限1, “9”, , 假), -1))
    赋值 (全局_其它9, 真)
.默认
    赋值 (全局_其它9, 假)
.判断结束


.子程序 根据不同权限显示不同菜单, 空白型, , 
.判断开始 (等于 (全局_用户管理权限, 真)) ' 0
    赋值 (_启动窗口..禁止, 假)
    赋值 (日志窗口..禁止, 假)
.默认
    赋值 (_启动窗口..禁止, 真)
    赋值 (日志窗口..禁止, 真)
.判断结束
.判断开始 (等于 (全局_查询权限, 真)) ' 1
    
.默认
    
.判断结束
.判断开始 (等于 (全局_增加权限, 真)) ' 2
    
.默认
    
.判断结束
.判断开始 (等于 (全局_修改权限, 真)) ' 3
    
.默认
    
.判断结束
.判断开始 (等于 (全局_删除权限, 真)) ' 4
    
.默认
    
.判断结束
.判断开始 (等于 (全局_查看权限, 真)) ' 5
    
.默认
    
.判断结束
.判断开始 (等于 (全局_打印权限, 真)) ' 6
    
.默认
    
.判断结束
.判断开始 (等于 (全局_其它7, 真)) ' 7
    
.默认
    
.判断结束
.判断开始 (等于 (全局_其它8, 真)) ' 8
    
.默认
    
.判断结束
.判断开始 (等于 (全局_其它9, 真)) ' 9
    
.默认
    
.判断结束


.子程序 文本填充分割串设置, 空白型, , 
赋值 (填充串, “@$&”)
赋值 (数据行分割串, “|”)


.子程序 连接公钥设置子程序, 空白型, , 
客户端程序.未知支持库函数_15 (“E003”, “5223FC832849C11987CE71B4AAA9722CE1F402D6E940B656DD97F94CFAB52E7BDE187E91B285285A14DE75076AAA4E578A32DBFFC0D0307A1F5280B84B1E06F9E0D76C65B786A795AB88FAD622CC000E82A84D533D1785E34F0C0F4B17372A856BD4C49D872AD4E151ACB2F677C98DE624189737D418DCBAF03C35FF395BA3B9”)
客户端程序.未知支持库函数_16 (0)


.子程序 判断是否有管理员用户, 空白型, , 
.局部变量 记录数, 整数型, , , 
.局部变量 是否设置管理员用户, 逻辑型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 权限值, 文本型, , , 

赋值 (是否设置管理员用户, 假)
赋值 (记录数, 登录表.未知支持库函数_17 ())
.计次循环首 (记录数, 计次)
    登录表.未知支持库函数_30 (相减 (记录数, 计次))
    登录表.未知支持库函数_32 (登录表节点)
    登录表节点.未知支持库函数_11 (“权限”, 权限值)
    .如果 (不等于 (寻找文本 (权限值, “0”, , 假), -1))
        赋值 (是否设置管理员用户, 真)
        跳出循环 ()
    .否则
        
    .如果结束
    
.计次循环尾 ()
.如果 (等于 (是否设置管理员用户, 假))
    赋值 (用户管理窗口..禁止, 真)
.否则
    
.如果结束
.如果 (等于 (是否设置管理员用户, 真))
    赋值 (用户管理窗口..禁止, 假)
.否则
    
.如果结束


.窗口程序集 窗口程序集_用户管理窗口, , , 

.子程序 _用户管理窗口_创建完毕, 空白型, , 
未知支持库函数_0 (#)
赋值 (用户管理窗口., 假)
文本填充分割串设置 ()
赋值 (请求信息, “取登录表”)
客户端程序.未知支持库函数_21 (请求信息)

.子程序 取登录表数据处理调用子程序, 空白型, , 
.局部变量 取回的数据1, 字节集, , , 
.局部变量 数据表行文本, 文本型, , "0", 
.局部变量 数据表记录数, 整数型, , , 
.局部变量 用户名称值, 文本型, , , 
.局部变量 密码值, 文本型, , , 
.局部变量 权限值, 文本型, , , 
.局部变量 数据表列文本, 文本型, , "0", 
.局部变量 记录数, 整数型, , , 
.局部变量 次数, 整数型, , , 

客户端程序.未知支持库函数_20 (取回的数据1)
赋值 (取回的数据, 取字节集数据 (取回的数据1, #文本型, ))
赋值 (数据表行文本, 分割文本 (取回的数据, 数据行分割串, ))
赋值 (数据表记录数, 取数组成员数 (数据表行文本))
登录表.未知支持库函数_21 ()
.计次循环首 (数据表记录数, 次数)
    赋值 (数据表列文本, 分割文本 (数据表行文本 [次数], 填充串, ))
    赋值 (用户名称值, 数据表列文本 [1])
    赋值 (密码值, 数据表列文本 [2])
    赋值 (权限值, 数据表列文本 [3])
    登录表节点.未知支持库函数_3 (“用户名称”, 用户名称值)
    登录表节点.未知支持库函数_3 (“密码”, 密码值)
    登录表节点.未知支持库函数_3 (“权限”, 权限值)
    登录表.未知支持库函数_18 (登录表节点, )
    登录表节点.未知支持库函数_4 (“用户名称”)
    登录表节点.未知支持库函数_4 (“密码”)
    登录表节点.未知支持库函数_4 (“权限”)
.计次循环尾 ()
用户管理窗口.清空 (.)
赋值 (记录数, 登录表.未知支持库函数_17 ())
登录表.未知支持库函数_28 ()
.计次循环首 (记录数, )
    登录表.未知支持库函数_32 (登录表节点)
    登录表节点.未知支持库函数_11 (“用户名称”, 用户名称值)
    用户管理窗口.加入项目 (., 用户名称值, )
    登录表.未知支持库函数_26 ()
.计次循环尾 ()
用户管理窗口.选中项目 (., 0, 真)
登录表.未知支持库函数_28 ()
赋值 (用户管理窗口..现行选中项, 0)
根据选择用户显示不同内容 ()
用户管理窗口.获取焦点 (.)
判断是否有管理员用户 ()

.子程序 根据选择用户显示不同内容, 空白型, , 
.局部变量 用户项, 整数型, , , 
.局部变量 用户名称值, 文本型, , , 
.局部变量 密码值, 文本型, , , 

赋值 (用户项, 用户管理窗口..现行选中项)
登录表.未知支持库函数_30 (用户项)
登录表.未知支持库函数_32 (登录表节点)
登录表节点.未知支持库函数_11 (“用户名称”, 用户名称值)
登录表节点.未知支持库函数_11 (“密码”, 密码值)
赋值 (.内容, 用户名称值)
赋值 (.内容, 密码值)
赋值 (.内容, 密码值)
根据权限代码设置不同的权限 ()

.子程序 根据权限代码设置不同的权限, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 权限值, 文本型, , , 

登录表节点.未知支持库函数_11 (“权限”, 权限值)
.计次循环首 (10, 计次)
    .如果 (不等于 (寻找文本 (权限值, 到文本 (相减 (计次, 1)), , 假), -1))
        用户管理窗口.选中项目 (., 相减 (计次, 1), 真)
    .否则
        用户管理窗口.选中项目 (., 相减 (计次, 1), 假)
    .如果结束
    
.计次循环尾 ()

.子程序 返回权限字串, 文本型, , 
.局部变量 计次, 整数型, , , 
.局部变量 权限串, 文本型, , , 

.计次循环首 (10, 计次)
    .如果真 (用户管理窗口.是否被选中 (., 相减 (计次, 1)))
        赋值 (权限串, 相加 (权限串, 到文本 (相减 (计次, 1))))
    .如果真结束
    
.计次循环尾 ()
返回 (权限串)

.子程序 _选择列表框_用户名_列表项被选择, 空白型, , 
.局部变量 计次, 整数型, , , 

.计次循环首 (用户管理窗口.取项目数 (.), 计次)
    用户管理窗口.选中项目 (., 相减 (计次, 1), 假)
.计次循环尾 ()
用户管理窗口.选中项目 (., 用户管理窗口..现行选中项, 真)
登录表.未知支持库函数_30 (用户管理窗口..现行选中项)
根据选择用户显示不同内容 ()

.子程序 _按钮_增加_被单击, 空白型, , 
.局部变量 用户名称值, 文本型, , , 
.局部变量 次数, 整数型, , , 
.局部变量 无相同记录, 逻辑型, , , 
.局部变量 密码值, 文本型, , , 
.局部变量 权限值, 文本型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“用户名不能为空！”, 相加 (0, 64), “错误”)
    返回 ()
.如果真结束
.如果真 (不等于 (.内容, .内容))
    信息框 (“密码较验不一致！请重新输入密码。”, 相加 (0, 64), “错误”)
    返回 ()
.如果真结束
登录表.未知支持库函数_28 ()
.计次循环首 (登录表.未知支持库函数_17 (), 次数)
    登录表.未知支持库函数_30 (相减 (登录表.未知支持库函数_17 (), 次数))
    登录表.未知支持库函数_32 (登录表节点)
    登录表节点.未知支持库函数_11 (“用户名称”, 用户名称值)
    .如果 (不等于 (用户名称值, .内容))
        赋值 (无相同记录, 真)
    .否则
        
    .如果结束
    .如果 (等于 (用户名称值, .内容))
        赋值 (无相同记录, 假)
        跳出循环 ()
    .否则
        
    .如果结束
    
.计次循环尾 ()
.如果 (等于 (无相同记录, 真))
    赋值 (用户名称值, .内容)
    赋值 (密码值, .内容)
    赋值 (权限值, 返回权限字串 ())
    赋值 (请求信息, “增加登录”)
    客户端程序.未知支持库函数_21 (相加 (请求信息, 填充串, 用户名称值, 填充串, 密码值, 填充串, 权限值, 填充串))
.否则
    
.如果结束
.如果 (等于 (无相同记录, 假))
    信息框 (“该用户已经存在！”, 相加 (0, 64), “错误”)
    返回 ()
.否则
    
.如果结束


.子程序 登录表记录添加后的处理子程序, 空白型, , 
.局部变量 取回的数据1, 字节集, , , 

客户端程序.未知支持库函数_20 (取回的数据1)
赋值 (取回的数据, 取字节集数据 (取回的数据1, #文本型, ))
.如果真 (等于 (取回的数据, “登录增加成功”))
    信息框 (“向服务器添加用户成功”, 相加 (0, 64), “提示！”)
    用户管理窗口.清空 (.)
    登录表节点.未知支持库函数_4 (“用户名称”)
    登录表节点.未知支持库函数_4 (“密码”)
    登录表节点.未知支持库函数_4 (“权限”)
    赋值 (请求信息, “取登录表”)
    客户端程序.未知支持库函数_21 (请求信息)
.如果真结束
.如果真 (等于 (取回的数据, “登录增加失败”))
    信息框 (“向服务器添加用户失败”, 相加 (0, 64), “提示！”)
.如果真结束


.子程序 _按钮_修改_被单击, 空白型, , 
.局部变量 无相同记录, 逻辑型, , , 
.局部变量 用户名称值, 文本型, , , 
.局部变量 密码值, 文本型, , , 
.局部变量 权限值, 文本型, , , 
.局部变量 次数, 整数型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“用户名不能为空！”, 相加 (0, 64), “错误”)
    返回 ()
.如果真结束
.如果真 (不等于 (.内容, .内容))
    信息框 (“密码较验不一致！请重新输入密码。”, 相加 (0, 64), “错误”)
    返回 ()
.如果真结束
登录表.未知支持库函数_28 ()
.计次循环首 (登录表.未知支持库函数_17 (), 次数)
    登录表.未知支持库函数_30 (相减 (登录表.未知支持库函数_17 (), 次数))
    登录表.未知支持库函数_32 (登录表节点)
    登录表节点.未知支持库函数_11 (“用户名称”, 用户名称值)
    .如果 (不等于 (用户名称值, .内容))
        赋值 (无相同记录, 真)
    .否则
        
    .如果结束
    .如果 (等于 (用户名称值, .内容))
        赋值 (无相同记录, 假)
        跳出循环 ()
    .否则
        
    .如果结束
    
.计次循环尾 ()
.如果 (等于 (无相同记录, 假))
    赋值 (用户名称值, .内容)
    赋值 (密码值, .内容)
    赋值 (权限值, 返回权限字串 ())
    赋值 (请求信息, “修改登录”)
    客户端程序.未知支持库函数_21 (相加 (请求信息, 填充串, 用户名称值, 填充串, 密码值, 填充串, 权限值, 填充串))
.否则
    
.如果结束
.如果 (等于 (无相同记录, 真))
    信息框 (“该用户不存在，请先增加用户！”, 相加 (0, 64), “错误”)
    返回 ()
.否则
    
.如果结束


.子程序 登录表记录修改后的处理子程序, 空白型, , 
.局部变量 取回的数据1, 字节集, , , 

客户端程序.未知支持库函数_20 (取回的数据1)
赋值 (取回的数据, 取字节集数据 (取回的数据1, #文本型, ))
.如果真 (等于 (取回的数据, “登录修改成功”))
    信息框 (“向服务器修改用户成功”, 相加 (0, 64), “提示！”)
    用户管理窗口.清空 (.)
    登录表节点.未知支持库函数_4 (“用户名称”)
    登录表节点.未知支持库函数_4 (“密码”)
    登录表节点.未知支持库函数_4 (“权限”)
    赋值 (请求信息, “取登录表”)
    客户端程序.未知支持库函数_21 (请求信息)
.如果真结束
.如果真 (等于 (取回的数据, “登录修改失败”))
    信息框 (“向服务器修改用户失败”, 相加 (0, 64), “提示！”)
.如果真结束
.如果真 (等于 (取文本右边 (取回的数据, 12), “登录无管理员”))
    信息框 (相加 (“向服务器修改用户成功，无管理员用户存在！”, #换行符, “系统要求至少要有一个管理员。”), 相加 (0, 64), “提示！”)
    用户管理窗口.清空 (.)
    登录表节点.未知支持库函数_4 (“用户名称”)
    登录表节点.未知支持库函数_4 (“密码”)
    登录表节点.未知支持库函数_4 (“权限”)
    赋值 (请求信息, “取登录表”)
    客户端程序.未知支持库函数_21 (请求信息)
.如果真结束


.子程序 _按钮_删除_被单击, 空白型, , 
.局部变量 用户名称值, 文本型, , , 

.如果真 (小于或等于 (取项目数 (), 1))
    信息框 (“删除失败!管理员数据库中应保证有一位以上的管理员!”, 0, “删除失败!”)
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (相加 (“是否删除用户”, .取项目文本 (.现行选中项), “？”), 相加 (1, 32), “信息”), 0))
    赋值 (用户名称值, .取项目文本 (.现行选中项))
    赋值 (请求信息, “删除登录”)
    客户端程序.未知支持库函数_21 (相加 (请求信息, 填充串, 用户名称值, 填充串))
.如果真结束


.子程序 登录表记录删除后的处理子程序, 空白型, , 
.局部变量 取回的数据1, 字节集, , , 

客户端程序.未知支持库函数_20 (取回的数据1)
赋值 (取回的数据, 取字节集数据 (取回的数据1, #文本型, ))
.如果真 (等于 (取回的数据, “登录删除成功”))
    信息框 (“向服务器删除用户成功”, 相加 (0, 64), “提示！”)
    用户管理窗口.清空 (.)
    登录表节点.未知支持库函数_4 (“用户名称”)
    登录表节点.未知支持库函数_4 (“密码”)
    登录表节点.未知支持库函数_4 (“权限”)
    赋值 (请求信息, “取登录表”)
    客户端程序.未知支持库函数_21 (请求信息)
.如果真结束
.如果真 (等于 (取回的数据, “登录删除失败”))
    信息框 (“向服务器删除用户失败”, 相加 (0, 64), “提示！”)
    返回 ()
.如果真结束


.子程序 _按钮_退出_被单击, 空白型, , 
用户管理窗口.销毁 ()


 ' 不属于任何一个程序集、类模块的函数：
