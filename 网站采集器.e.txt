 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 700
    高度 = 500
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “网站采集器”
    帮助文件名 = “”

窗口 说明
    左边 = 50
    顶边 = 50
    宽度 = 338
    高度 = 115
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 设置 ' 380|250
    左边 = 50
    顶边 = 50
    宽度 = 800
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 真
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “新建任务”
    帮助文件名 = “”

窗口 添加
    左边 = 50
    顶边 = 50
    宽度 = 468
    高度 = 215
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 编辑
    左边 = 50
    顶边 = 1
    宽度 = 587
    高度 = 563
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “编辑网址”
    帮助文件名 = “”

窗口 添加窗口
    左边 = 50
    顶边 = 50
    宽度 = 263
    高度 = 221
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 新建站点 ' 380|92
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 92
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “新建站点”
    帮助文件名 = “”



.常量 , , , 
.图片 说明1, " ' 已保存到：D:\易语言学习\Data\网站采集器.e\说明1", , 
.图片 数据库模板, " ' 已保存到：D:\易语言学习\Data\网站采集器.e\数据库模板", , 
.图片 配置信息, " ' 已保存到：D:\易语言学习\Data\网站采集器.e\配置信息", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' RegEx 684944CB04624eb7BD5412A519421D34 1 2 正则表达式支持库
 ' HtmlView 5014D8FA6DCA40b68FA626D8183666EB 1 1 超文本浏览框支持库
 ' eDB 46E94341933A462383A4DE26B146322C 1 4 数据库操作支持库




.全局变量 源代码, 文本型, , , 
.全局变量 匿名全局变量_173, 空白型, , , 
.全局变量 要替换掉的, 文本型, , "0", 
.全局变量 匿名全局变量_185, 空白型, , , 
.全局变量 文件内容, 文本型, , , 
.全局变量 内容开始, 文本型, , , 
.全局变量 匿名全局变量_217, 空白型, , , 
.全局变量 替换完毕, 逻辑型, , , 
.全局变量 TEMP, 文本型, , , 
.全局变量 文本位置, 整数型, , , 
.全局变量 匿名全局变量_311, 空白型, , , 
.全局变量 a, 文本型, , , 
.全局变量 b, 文本型, , , 
.全局变量 c, 整数型, , , 
.全局变量 d, 文本型, , , 
.全局变量 匿名全局变量_312, 空白型, , , 
.全局变量 当前站点, 文本型, , , 
.全局变量 当前任务, 文本型, , , 
.全局变量 匿名全局变量_915, 空白型, , , 
.全局变量 记录集句柄, 整数型, , , 
.全局变量 匿名全局变量_1496, 空白型, , , 
.全局变量 当前数据库, 文本型, , , 

.DLL命令 取COOKIE, 逻辑型, "wininet.dll", "InternetGetCookieA", , 
    .参数 域名, 文本型, 传址, 
    .参数 名称, 文本型, 传址, 
    .参数 内容, 文本型, 传址, 
    .参数 尺寸, 整数型, 传址, 

.DLL命令 FindWindow, 整数型, "user32", "FindWindowA", , 
    .参数 lpClassName, 文本型, , 
    .参数 lpWindowName, 整数型, , 

.DLL命令 FindWindowEx, 整数型, "user32", "FindWindowExA", , 
    .参数 hWnd1, 整数型, , 
    .参数 hWnd2, 整数型, , 
    .参数 lpsz1, 文本型, , 
    .参数 lpsz2, 整数型, , 

.DLL命令 SendMessage, 整数型, "user32", "SendMessageA", , 
    .参数 hwnd, 整数型, , 
    .参数 wMsg, 整数型, , 
    .参数 wParam, 整数型, , 
    .参数 lParam, 文本型, , 

.DLL命令 GetDlgItem, 整数型, "user32", "GetDlgItem", , 
    .参数 hDlg, 整数型, , 
    .参数 nIDDlgItem, 整数型, , 

.窗口程序集 启动窗口程序集, , , 

.子程序 _察看源代码_被单击, 空白型, , 
赋值 (.标记, “3”)
载入 (说明, , 真)

.子程序 _时钟1_周期事件, 空白型, , 
.如果真 (等于 (.标记, “设置窗口”))
    设置.置文本 (., 1, 到文本 (取现行时间 ()))
.如果真结束
1.置文本 (到文本 (取现行时间 ()))

.子程序 _替换1_被单击, 空白型, , 
.局部变量 标题1, 文本型, , , 
.局部变量 内容, 文本型, , , 
.局部变量 标题开始, 文本型, , , 
.局部变量 标题结束, 文本型, , , 
.局部变量 内容结束, 文本型, , , 
.局部变量 匿名局部变量_176, 空白型, , , 
.局部变量 内容开始位置, 整数型, , , 
.局部变量 内容结束位置, 整数型, , , 
.局部变量 表达式, 未知类型0x30001, , , 
.局部变量 k, 整数型, , , 
.局部变量 标题开始位置, 整数型, , , 
.局部变量 标题结束位置, 整数型, , , 
.局部变量 内容替换, 文本型, , , 
.局部变量 内容替换1, 文本型, , "0", 
.局部变量 内容排除, 文本型, , , 
.局部变量 匿名局部变量_1269, 空白型, , , 
.局部变量 Count, 整数型, , , 
.局部变量 指针, 整数型, , , 
.局部变量 Count1, 整数型, , , 
.局部变量 指针1, 整数型, , , 
.局部变量 匿名局部变量_1270, 空白型, , , 
.局部变量 内容替换2, 文本型, , "0", 

赋值 (文件内容, 源代码)
.计次循环首 (., )
    “开始字符串”.未知支持库函数_26 (标题开始)
    “结束字符串”.未知支持库函数_26 (标题结束)
    “内容排除”.未知支持库函数_26 (内容排除)
    “内容替换”.未知支持库函数_26 (内容替换)
    赋值 (内容替换1, 分割文本 (内容替换, “_>”, ))
    .变量循环首 (1, 取数组成员数 (内容替换1), 1, 指针)
        .判断开始 (等于 (内容替换1 [指针], “”))
            
        .默认
            赋值 (内容替换2, 分割文本 (内容替换1 [指针], “->”, ))
        .判断结束
        
    .变量循环尾 ()
    赋值 (内容开始, 标题开始)
    赋值 (内容结束, 标题结束)
     ' 转换 ()
    赋值 (要替换掉的, 分割文本 (内容排除, “_>”, ))
    赋值 (标题开始位置, 寻找文本 (文件内容, 标题开始, 0, 假))
    赋值 (标题结束位置, 寻找文本 (文件内容, 标题结束, 标题开始位置, 假))
     ' 内容开始位置 ＝ 查找内容开始位置 ()
     ' 内容开始位置 ＝ 寻找文本 (文件内容, 内容开始, 0, 假)
    赋值 (内容结束位置, 寻找文本 (文件内容, 内容结束, 内容开始位置, 假))
    赋值 (标题1, 取文本中间 (文件内容, 相加 (标题开始位置, 取文本长度 (标题开始)), 相减 (标题结束位置, 标题开始位置, 取文本长度 (标题开始))))
    赋值 (内容, 取文本中间 (文件内容, 相加 (内容开始位置, 取文本长度 (内容开始)), 相减 (内容结束位置, 内容开始位置, 取文本长度 (内容开始))))
    .变量循环首 (1, 取数组成员数 (要替换掉的), 1, k)
        赋值 (内容, 子文本替换 (内容, 要替换掉的 [k], “”, , , 真))
    .变量循环尾 ()
    未知支持库函数_36 ()
.计次循环尾 ()
赋值 (_启动窗口., 内容)
 ' 源码.加入文本 (标题1)
 ' 源码.加入文本 (内容)

.子程序 _设置1_被单击, 空白型, , 
 ' _启动窗口.位置 ＝ 2
载入 (新建站点, , 真)

.子程序 转换, 空白型, , 
赋值 (TEMP, 源代码)
赋值 (替换完毕, 假)
赋值 (文本位置, 1)
.判断循环首 (等于 (替换完毕, 假))
    处理事件 ()
    赋值 (文本位置, 寻找文本 (TEMP, “</a>”, 文本位置, 假))
    .如果 (不等于 (文本位置, -1))
        处理事件 ()
        赋值 (TEMP, 子文本替换 (TEMP, “</a>”, “[/url]”, 文本位置, 1, 真))
        
        
    .否则
        赋值 (替换完毕, 真)
        跳出循环 ()
    .如果结束
    
.判断循环尾 ()
赋值 (文件内容, TEMP)


.子程序 __启动窗口_将被销毁, 空白型, , 
未知支持库函数_3 ()

.子程序 __启动窗口_创建完毕, 空白型, , 
刷新站点 ()

.子程序 刷新站点, 空白型, , 
.局部变量 e, 文本型, , , 

清空 ()
赋值 (e, 寻找文件 (相加 (取运行目录 (), “\data\*.*”), #子目录))
.判断循环首 (不等于 (e, “”))
    .如果 (并且 (不等于 (e, “.”), 不等于 (e, “..”)))
        e.加入项目 ()
    .否则
        
    .如果结束
    赋值 (e, 寻找文件 (#子目录))
.判断循环尾 ()


.子程序 刷新任务, 空白型, , 
.局部变量 e, 文本型, , , 

.如果 (不等于 (.现行选中项, -1))
    清空 ()
    赋值 (e, 寻找文件 (相加 (取运行目录 (), “\data\”, .取项目文本 (.现行选中项), “\*.mdb”), ))
    .判断循环首 (不等于 (e, “”))
        取文本左边 (e, 相减 (取文本长度 (e), 4)).加入项目 ()
        赋值 (e, 寻找文件 ())
    .判断循环尾 ()
.否则
    
.如果结束


.子程序 _站点_列表项被选择, 空白型, , 
刷新任务 ()

.子程序 _任务_列表项被选择, 空白型, , 
全部关闭 ()
赋值 (当前站点, .取项目文本 (.现行选中项))
赋值 (当前任务, .取项目文本 (.现行选中项))
.如果 (并且 (不等于 (当前站点, “”), 不等于 (当前任务, “”)))
    赋值 (当前数据库, 相加 (取运行目录 (), “\data\”, 当前站点, “\”, 当前任务, “.mdb”))
.否则
    返回 ()
.如果结束
.如果 (等于 (当前数据库.未知支持库函数_1 (“”), 假))
    .如果 (等于 (当前数据库.未知支持库函数_1 (“”), 假))
        信息框 (“当前任务数据库载入失败!”, 0, )
        返回 ()
    .否则
        
    .如果结束
    
.否则
    
.如果结束
开启 ()


.子程序 _编辑采集规则_被单击, 空白型, , 
.如果 (并且 (不等于 (当前站点, “”), 不等于 (当前任务, “”)))
    赋值 (.标记, “设置窗口”)
    赋值 (.标记, “0”)
    载入 (设置, , 真)
.否则
    信息框 (“请选择要编辑的任务名称。”, 0, “提示”)
.如果结束


.子程序 _透明标签3_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (新建站点, , 真)

.子程序 _透明标签4_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (不等于 (.现行选中项, -1))
    赋值 (.标记, “0”)
    载入 (新建站点, , 假)
    赋值 (新建站点., “新建任务”)
    赋值 (新建站点., 真)
.默认
    信息框 (“请选择站点名，没有请新建。”, 0, “提示”)
.判断结束


.子程序 开启, 空白型, , 
.未知支持库函数_12 ()
“采集规则信息”.未知支持库函数_14 (#)


.子程序 _开始采集_被单击, 空白型, , 
采集 ()

.子程序 _按钮1_被单击, 空白型, , 
0.插入表项 (“风格花风格”, , , , )

.子程序 _全选按钮_被单击, 空白型, , 
.局部变量 v, 整数型, , , 

赋值 (v, 0)
.判断循环首 (大于 (取表项数 (), v))
    v.置状态图片 (1)
    赋值 (v, 相加 (v, 1))
.判断循环尾 ()


.子程序 _全不选_被单击, 空白型, , 
.局部变量 v, 整数型, , , 

赋值 (v, 0)
.判断循环首 (大于 (取表项数 (), v))
    v.置状态图片 (0)
    赋值 (v, 相加 (v, 1))
.判断循环尾 ()

.子程序 _地址列表框_左键单击表项, 空白型, , 
.判断开始 (等于 (.取当前状态图片 (.), 0))
    .置状态图片 (., 1)
.默认
    .置状态图片 (., 0)
.判断结束


.窗口程序集 说明窗口程序集, , , 

.程序集变量 现行文件名, 文本型, , , 
.程序集变量 匿名程序集变量_127, 空白型, , , 
.程序集变量 定时值, 整数型, , , 
.子程序 _说明_创建完毕, 空白型, , 
赋值 (.时钟周期, 1000)
赋值 (定时值, 10)
.判断开始 (等于 (设置..标记, “0”))
    赋值 (.内容, “    取得最前端IE窗口地址。”)
    赋值 (设置..标记, “”)
.判断 (等于 (设置..标记, “1”))
    赋值 (.内容, “    取得最前端Maxthon窗口地址。”)
    赋值 (设置..标记, “”)
.默认
    
.判断结束

.判断开始 (等于 (_启动窗口..标记, “3”))
    赋值 (_启动窗口..标记, “”)
    赋值 (.时钟周期, 0)
    赋值 (说明., 400)
    赋值 (说明., 300)
    赋值 (.标题, “源代码”)
    赋值 (.宽度, 380)
    赋值 (.高度, 252)
    赋值 (.顶边, 268)
    赋值 (.可视, 假)
    赋值 (.高度, 230)
    赋值 (.宽度, 353)
    赋值 (.内容, 源代码)
    赋值 (.可视, 真)
    赋值 (.顶边, 268)
.默认
    
.判断结束

.判断开始 (等于 (设置..标记, “4”))
    赋值 (设置..标记, “”)
    赋值 (.时钟周期, 0)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (说明., 600)
    赋值 (说明., 400)
    赋值 (.顶边, 350)
    赋值 (.左边, 500)
    赋值 (.可视, 真)
    赋值 (.高度, 395)
    赋值 (.宽度, 595)
    赋值 (., 570)
    赋值 (., 250)
    赋值 (.顶边, 280)
    赋值 (.顶边, 277)
    赋值 (.宽度, 520)
    赋值 (.顶边, 320)
    赋值 (.顶边, 315)
    赋值 (.宽度, 520)
    赋值 (.左边, 430)
    赋值 (.顶边, 350)
    说明.移动 (100, 100, , )
.默认
    
.判断结束

.判断开始 (等于 (添加..标记, “0”))
    赋值 (添加..标记, “”)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (., 假)
    赋值 (.可视, 真)
    赋值 (.可视, 真)
    赋值 (.图片, #说明1)
.默认
    
.判断结束


.子程序 _关闭_被单击, 空白型, , 
赋值 (_启动窗口., 0)
销毁 ()

.子程序 _时钟_周期事件, 空白型, , 
赋值 (定时值, 相减 (定时值, 1))
赋值 (.标题, 相加 (“窗口将在”, 到文本 (定时值), “秒后关闭。”))
.判断开始 (等于 (定时值, 0))
    赋值 (_启动窗口., 0)
    销毁 ()
.默认
    
.判断结束


.子程序 _保存到文件_被单击, 空白型, , 
保存文档 ()

.子程序 保存文档, 逻辑型, , 返回真表示用户选择了中止
.参数 文件名, 文本型, 可空, 

.局部变量 保存文件名, 文本型, , , 
.局部变量 文件号, 整数型, , , 

赋值 (保存文件名, 选择 (是否为空 (文件名), 现行文件名, 文件名))
.如果真 (等于 (保存文件名, “”))
    赋值 (.标题, “请输入欲保存到的文本文件名：”)
    赋值 (.类型, 1)
    .如果真 (等于 (打开 (), 假))
        返回 (真)
    .如果真结束
    赋值 (保存文件名, .文件名)
.如果真结束
设置修改状态 (假)
赋值 (文件号, 打开文件 (保存文件名, #重写, ))
.如果真 (不等于 (文件号, 0))
    .如果 (等于 (写出文本 (文件号, .内容), 真))
        关闭文件 (文件号)
        赋值 (现行文件名, 保存文件名)
        赋值 (., 相加 (“E 语言记事本 - ”, 现行文件名))
        返回 (假)
    .否则
        关闭文件 (文件号)
    .如果结束
    
.如果真结束
信息框 (“保存文件失败！”, #错误图标, “错误”)
返回 (假)

.子程序 设置修改状态, 空白型, , 
.参数 是否已被修改, 逻辑型, 可空, 默认为设置成被修改

185.发送信息 (选择 (或者 (等于 (是否为空 (是否已被修改), 真), 等于 (是否已被修改, 真)), 1, 0), 0)

.子程序 _关_被单击, 空白型, , 
销毁 ()

.子程序 _刷新_被单击, 空白型, , 
赋值 (., .内容)
取COOKIE ()

.子程序 取COOKIE, 空白型, , 
赋值 (b, 取空白文本 (255))
.如果真 (取COOKIE (., d, b, 取文本长度 (b)))
    赋值 (.内容, b)
    赋值 (设置..内容, b)
    赋值 (., 假)
.如果真结束


.子程序 _超文本浏览框_已就绪, 空白型, , 
取COOKIE ()

.窗口程序集 设置窗口程序集, , , 

.程序集变量 源代码还原, 文本型, , , 
.子程序 _设置_创建完毕, 空白型, , 
.判断开始 (等于 (_启动窗口..标记, “0”))
    赋值 (_启动窗口..标记, “”)
    显示 ()
    显示配置 ()
.默认
    
.判断结束
调整大小 ()

.子程序 显示记录, 空白型, , 
.局部变量 文本, 文本型, , , 
.局部变量 文本1, 文本型, , , 
.局部变量 索引, 整数型, , , 
.局部变量 内容替换, 文本型, , , 
.局部变量 开始字符串, 文本型, , , 
.局部变量 结束字符串, 文本型, , , 
.局部变量 内容排除, 文本型, , , 
.局部变量 k, 整数型, , , 
.局部变量 内容开始1, 文本型, , , 
.局部变量 内容结束1, 文本型, , , 

全部删除 ()
.计次循环首 (., )
    “标签名”.未知支持库函数_26 (文本)
    “开始字符串”.未知支持库函数_26 (开始字符串)
    “结束字符串”.未知支持库函数_26 (结束字符串)
    “内容排除”.未知支持库函数_26 (内容排除)
    “内容替换”.未知支持库函数_26 (内容替换)
    “内容开始”.未知支持库函数_26 (内容开始1)
    “内容结束”.未知支持库函数_26 (内容结束1)
    赋值 (索引, -1.插入表项 (文本, , , , 相加 (索引, 1)))
    索引.置标题 (1, 开始字符串)
    索引.置标题 (2, 结束字符串)
    索引.置标题 (3, 内容开始1)
    索引.置标题 (4, 内容结束1)
    索引.置标题 (5, 内容排除)
    索引.置标题 (6, 内容替换)
    未知支持库函数_36 ()
.计次循环尾 ()


.子程序 _设置_将被销毁, 空白型, , 
赋值 (_启动窗口..标记, “”)
赋值 (_启动窗口., 0)
连接 ()
未知支持库函数_16 ()
未知支持库函数_16 ()

.子程序 _添加按钮_被单击, 空白型, , 
载入 (添加, , 真)

.子程序 _透明标签4_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

“(*)”.加入文本 ()

.子程序 _透明标签6_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

“|”.加入文本 ()

.子程序 _透明标签8_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

“(*)”.加入文本 ()

.子程序 _透明标签10_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

“|”.加入文本 ()

.子程序 _透明标签15_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.标记, “4”)
载入 (说明, , 真)

.子程序 调整大小, 空白型, , 
设置.移动 (0, 0, 取屏幕宽度 (), 相减 (取屏幕高度 (), 30))
 ' 选择夹.宽度 ＝ 取用户区宽度 () － 6
 ' 选择夹.高度 ＝ 取用户区高度 () － 26
赋值 (.倾斜, 相减 (取屏幕宽度 (), 220))
 ' 采集地址列表框.高度 ＝ 取屏幕高度 () － 480
赋值 (.左边, 相减 (取屏幕宽度 (), 105))
赋值 (.左边, 相减 (取屏幕宽度 (), 105))
赋值 (.左边, 相减 (取屏幕宽度 (), 105))
赋值 (.左边, 相减 (取屏幕宽度 (), 105))
0.置列宽 (相减 (取屏幕宽度 (), 220))



.子程序 _清空按钮_被单击, 空白型, , 
.如果真 (等于 (信息框 (“此次操作将删除全部网址，继续吗？”, 相加 (#询问图标, #确认取消钮), “提示信息”), #确认钮))
    全部删除 ()
.如果真结束


.子程序 _删除按钮_被单击, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 h, 文本型, , , 
.局部变量 e, 整数型, , , 
.局部变量 v, 文本型, , "0", 

.判断开始 (不等于 (., -1))
    .如果真 (等于 (信息框 (“此次操作将删除已选网址，继续吗？”, 相加 (#询问图标, #确认取消钮), “提示信息”), #确认钮))
        .判断开始 (不等于 (取已选择表项数 (), 1))
            .变量循环首 (1, 取已选择表项数 (), 1, i)
                赋值 (h, 相加 (到文本 (i.取表项数值 ()), “>”, h))
            .变量循环尾 ()
            赋值 (v, 分割文本 (h, “>”, ))
            .变量循环首 (1, 取数组成员数 (v), 1, e)
                1.查找表项数值 (到整数 (v [e])).删除表项 ()
            .变量循环尾 ()
             ' 置表项数值 ()
            .判断开始 (0.是否被选择 ())
                0.删除表项 ()
            .默认
                
            .判断结束
            
            
        .默认
            .删除表项 (.)
            .未知支持库函数_12 ()
            “配置信息”.未知支持库函数_14 (#)
            .取表项数值 (.).未知支持库函数_38 ()
            #.未知支持库函数_19 ()
            未知支持库函数_18 ()
            未知支持库函数_16 ()
            置表项数值 ()
             ' 显示配置 ()
        .判断结束
        
    .如果真结束
    
.默认
    信息框 (“请选择要删除的网址。”, 0, “提示”)
.判断结束


.子程序 _修改按钮_被单击, 空白型, , 
.判断开始 (不等于 (., -1))
    赋值 (.下划线, “0”)
    载入 (编辑, , 真)
.默认
    信息框 (“请选择要编辑的网址。”, 0, “提示”)
.判断结束


.子程序 _添加按钮1_被单击, 空白型, , 
赋值 (.标记, “0”)
.取消表项选择 (.)
载入 (编辑, , 真)

.子程序 _编辑按钮1_被单击, 空白型, , 
赋值 (.标记, “0”)
载入 (编辑, , 真)

.子程序 _删除按钮1_被单击, 空白型, , 
.如果真 (等于 (信息框 (“此次操作将删除该规则，继续吗？”, 相加 (#询问图标, #确认取消钮), “提示信息”), #确认钮))
    设置.未知支持库函数_38 (., 设置.取表项数值 (., 设置..))
    设置.未知支持库函数_19 (., #)
    未知支持库函数_18 ()
    显示 ()
.如果真结束


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 列表框, 文本型, , , 
.局部变量 倒找位置, 整数型, , , 

赋值 (i, 0)
.判断循环首 (不等于 (取表项数 (), i))
    赋值 (列表框, i.取标题 ())
    赋值 (列表框, 相加 (列表框, “`”))
    列表框.加入文本 ()
    赋值 (i, 相加 (i, 1))
.判断循环尾 ()
赋值 (.内容, 文本替换 (.内容, 取文本长度 (.内容), 1, “”))

.子程序 显示, 空白型, , 
.局部变量 h, 整数型, , , 

_启动窗口.未知支持库函数_12 (.)
“采集规则信息”.未知支持库函数_14 (#)
显示记录 ()
赋值 (h, 0)
.判断循环首 (大于 (设置.取表项数 (.), h))
    设置.置表项数值 (., h, h)
    赋值 (h, 相加 (h, 1))
.判断循环尾 ()

.子程序 _透明标签21_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 



.子程序 _内容规则列表框_表项被激活, 空白型, , 
赋值 (.下划线, “修改”)
载入 (编辑, , 真)

.子程序 _采集地址列表框_表项被激活, 空白型, , 
赋值 (.下划线, “0”)
载入 (编辑, , 真)

.子程序 _按钮3_被单击, 空白型, , 
销毁 ()

.子程序 _按钮4_被单击, 空白型, , 
赋值 (源代码还原, .内容)
赋值 (.内容, 取剪辑板文本 ())
赋值 (.可视, 真)

.子程序 _测试_被单击, 空白型, , 
读取 ()
测试开始 ()

.子程序 _取IE地址按钮_被单击, 空白型, , 
取IE地址 ()

.子程序 _取Maxthon地址按钮_被单击, 空白型, , 
取Maxthon地址 ()

.子程序 _说明IE_被单击, 空白型, , 
说明ie ()

.子程序 _说明Maxthon_被单击, 空白型, , 
说明Maxthon ()

.子程序 _按钮5_被单击, 空白型, , 
赋值 (.内容, 源代码还原)
赋值 (.可视, 假)

.子程序 _按钮1_被单击, 空白型, , 
销毁 ()

.子程序 打开数据库, 空白型, , 
.如果 (等于 (当前数据库.未知支持库函数_1 (“”), 真))
    .未知支持库函数_12 ()
    “配置信息”.未知支持库函数_14 (#)
    3.未知支持库函数_19 ()
    写到数据库 ()
.否则
    信息框 (“当前配置数据库载入失败!”, 0, )
.如果结束


.子程序 写到数据库, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 列表框, 文本型, , , 
.局部变量 倒找位置, 整数型, , , 

赋值 (i, 0)
.判断循环首 (不等于 (取表项数 (), i))
    赋值 (列表框, i.取标题 ())
    赋值 (列表框, 相加 (列表框, “`”))
    列表框.加入文本 ()
    赋值 (i, 相加 (i, 1))
.判断循环尾 ()
赋值 (.内容, 文本替换 (.内容, 取文本长度 (.内容), 1, “”))
未知支持库函数_17 ()
“采集深度”.未知支持库函数_20 (.内容)
“采集地址列表框”.未知支持库函数_20 (.内容)
“必须包含”.未知支持库函数_20 (.内容)
“不得包含”.未知支持库函数_20 (.内容)
“文章包含”.未知支持库函数_20 (.内容)
“文章不包含”.未知支持库函数_20 (.内容)
“从”.未知支持库函数_20 (.内容)
“到”.未知支持库函数_20 (.内容)
未知支持库函数_18 ()
未知支持库函数_16 ()
未知支持库函数_3 ()

.子程序 连接, 空白型, , 
赋值 (当前数据库, 相加 (取运行目录 (), “\data\”, 当前站点, “\”, 当前任务, “-config”, “.db”))
.如果 (等于 (文件是否存在 (当前数据库), 真))
    打开数据库 ()
.否则
    写到文件 (当前数据库, #配置信息)
    打开数据库 ()
.如果结束


.子程序 显示配置, 空白型, , 
.局部变量 采集深度1, 文本型, , , 
.局部变量 采集地址列表框1, 文本型, , , 
.局部变量 必须包含1, 文本型, , , 
.局部变量 不得包含1, 文本型, , , 
.局部变量 文章包含1, 文本型, , , 
.局部变量 文章不得包含1, 文本型, , , 
.局部变量 从1, 文本型, , , 
.局部变量 到1, 文本型, , , 
.局部变量 采集地址, 文本型, , "0", 
.局部变量 i, 整数型, , , 

赋值 (当前数据库, 相加 (取运行目录 (), “\data\”, 当前站点, “\”, 当前任务, “-config”, “.db”))
.如果 (等于 (当前数据库.未知支持库函数_1 (“”), 真))
    .未知支持库函数_12 ()
    “配置信息”.未知支持库函数_14 (#)
    “采集深度”.未知支持库函数_26 (采集深度1)
    “采集地址列表框”.未知支持库函数_26 (采集地址列表框1)
    “必须包含”.未知支持库函数_26 (必须包含1)
    “不得包含”.未知支持库函数_26 (不得包含1)
    “文章包含”.未知支持库函数_26 (文章包含1)
    “文章不包含”.未知支持库函数_26 (文章不得包含1)
    “从”.未知支持库函数_26 (从1)
    “到”.未知支持库函数_26 (到1)
    赋值 (.内容, 采集深度1)
    赋值 (采集地址, 分割文本 (采集地址列表框1, “`”, ))
    .变量循环首 (1, 取数组成员数 (采集地址), 1, i)
        .插入表项 (采集地址 [i], , , , )
    .变量循环尾 ()
    0.删除表项 ()
    赋值 (.内容, 必须包含1)
    赋值 (.内容, 不得包含1)
    赋值 (.内容, 不得包含1)
    赋值 (.内容, 文章不得包含1)
    赋值 (.内容, 从1)
    赋值 (.内容, 到1)
    
.否则
    
.如果结束
置表项数值 ()

.子程序 _采集地址列表框_左键单击表项, 空白型, , 
赋值 (.内容, 到文本 (.取表项数值 (.)))

.子程序 置表项数值, 空白型, , 
.局部变量 h, 整数型, , , 

赋值 (h, 0)
.判断循环首 (大于 (取表项数 (), h))
    h.置表项数值 (h)
    赋值 (h, 相加 (h, 1))
.判断循环尾 ()


.窗口程序集 添加窗口程序集, , , 

.程序集变量 网址, 文本型, , "0", 
.子程序 _已添加列表框_表项被激活, 空白型, , 
赋值 (添加..下划线, “0”)
载入 (编辑, , 真)

.子程序 _添加网址_被单击, 空白型, , 
.局部变量 k, 整数型, , , 

赋值 (网址, 分割文本 (.内容, #换行符, ))
.变量循环首 (1, 取数组成员数 (网址), 1, k)
     ' 已添加列表框.插入表项 (0, 网址 [k], , , , k)
    设置.插入表项 (., 0, 网址 [k], , , , k)
.变量循环尾 ()

.子程序 _添加2_被单击, 空白型, , 
.局部变量 文本, 文本型, , , 
.局部变量 开始数, 整数型, , , 
.局部变量 结束数, 整数型, , , 
.局部变量 通配符长度, 整数型, , , 
.局部变量 输出文本, 文本型, , , 
.局部变量 输入文本, 文本型, , , 
.局部变量 循环变量, 整数型, , , 
.局部变量 通配符文本, 文本型, , , 

赋值 (输入文本, .内容)
赋值 (开始数, 到数值 (.内容))
赋值 (结束数, 到数值 (.内容))
.如果真 (小于 (结束数, 开始数))
    赋值 (结束数, 开始数)
    赋值 (.内容, 到文本 (结束数))
.如果真结束
赋值 (通配符长度, 到数值 (.内容))
.如果真 (小于 (通配符长度, 取文本长度 (.内容)))
    赋值 (通配符长度, 取文本长度 (.内容))
    赋值 (.内容, 到文本 (通配符长度))
.如果真结束
赋值 (通配符文本, “”)
.计次循环首 (通配符长度, )
    赋值 (通配符文本, 相加 (通配符文本, “0”))
.计次循环尾 ()
赋值 (循环变量, 开始数)
.判断循环首 (小于或等于 (循环变量, 结束数))
    赋值 (文本, 取文本右边 (相加 (通配符文本, 到文本 (循环变量)), 通配符长度))
    赋值 (输出文本, 子文本替换 (输入文本, “(*)”, 文本, , , 真))
     ' 已添加列表框.插入表项 (0, 输出文本, , , , )
    设置.插入表项 (., 0, 输出文本, , , , )
    赋值 (循环变量, 相加 (循环变量, 1))
.判断循环尾 ()

.子程序 _透明标签8_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

“(*)”.加入文本 ()

.子程序 _添加3_被单击, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 k, 整数型, , , 
.局部变量 内容, 文本型, , , 

赋值 (i, 到整数 (.内容))
赋值 (k, 相减 (到整数 (.内容), 1))
.判断开始 (大于 (k, i))
    信息框 (“开始数不能大于结束数。”, 0, “提示”)
.默认
    .判断循环首 (不等于 (k, i))
        赋值 (内容, 到文本 (相加 (k, 1)))
        赋值 (内容, 子文本替换 (.内容, “(*)”, 内容, , , 真))
         ' 已添加列表框.插入表项 (0, 内容, , , , )
        设置.插入表项 (., 0, 内容, , , , )
        赋值 (k, 相加 (k, 1))
    .判断循环尾 ()
    
.判断结束


.子程序 _透明标签14_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

“(*)”.加入文本 ()

.子程序 _透明标签9_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.标记, “0”)
载入 (说明, , 真)

.子程序 _完成_被单击, 空白型, , 
销毁 ()

.子程序 _完成按钮1_被单击, 空白型, , 
销毁 ()

.子程序 _完成按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _添加_将被销毁, 空白型, , 
.局部变量 h, 整数型, , , 

赋值 (h, 0)
.判断循环首 (大于 (设置.取表项数 (.), h))
    设置.置表项数值 (., h, h)
    赋值 (h, 相加 (h, 1))
.判断循环尾 ()


.窗口程序集 编辑窗口程序集, , , 

.子程序 _编辑_创建完毕, 空白型, , 
.局部变量 文本, 文本型, , , 
.局部变量 k, 整数型, , , 

设置.未知支持库函数_12 (., _启动窗口.)
设置.未知支持库函数_14 (., “采集规则信息”, #)
.判断开始 (等于 (设置..下划线, “修改”))
    赋值 (编辑., “修改”)
    赋值 (.标题, “修改”)
.默认
    
.判断结束

.判断开始 (等于 (设置..标记, “0”))
    赋值 (设置..标记, “”)
    赋值 (.可视, 真)
    赋值 (编辑., “添加标签”)
    赋值 (编辑.宽度, 587)
    赋值 (编辑.高度, 578)
    编辑.移动 (150, 1, , )
.默认
    
.判断结束

.判断开始 (等于 (设置..下划线, “0”))
    赋值 (设置..下划线, “”)
    赋值 (编辑., “修改地址”)
    赋值 (.内容, 设置.取标题 (., 设置.., ))
     ' 编辑.高度 ＝ 90
.默认
    
.判断结束

.判断开始 (等于 (设置..标记, “0”))
    赋值 (.内容, “标签：”)
    赋值 (编辑., “编辑标签”)
     ' 编辑.高度 ＝ 90
    赋值 (.内容, 设置.取标题 (., 设置.., ))
.判断 (不等于 (设置.., -1))
    赋值 (.可视, 真)
    显示记录1 (相加 (设置.取表项数值 (., 设置..), 1))
.默认
    
.判断结束


.子程序 _保存_被单击, 空白型, , 
.判断开始 (等于 (设置..下划线, “0”))
    设置.置标题 (., 设置.., , .内容)
    赋值 (设置..下划线, “”)
.默认
    
.判断结束

.判断开始 (等于 (添加..下划线, “0”))
    添加.置标题 (., 添加.., , .内容)
    赋值 (添加..下划线, “”)
.默认
    
.判断结束


.判断开始 (等于 (设置..标记, “0”))
    设置.置标题 (., 设置.., , .内容)
    赋值 (设置..标记, “”)
.默认
    
.判断结束

销毁 ()

.子程序 _排除添加_被单击, 空白型, , 
赋值 (编辑..下划线, “0”)
载入 (添加窗口, , 真)

.子程序 _排除删除_被单击, 空白型, , 
.如果真 (等于 (信息框 (“此次操作将删除该规则，继续吗？”, 相加 (#询问图标, #确认取消钮), “提示信息”), #确认钮))
    编辑.删除表项 (., 编辑..)
.如果真结束


.子程序 _内容添加_被单击, 空白型, , 
赋值 (编辑..下划线, “0”)
载入 (添加窗口, , 真)

.子程序 _内容删除_被单击, 空白型, , 
.如果真 (等于 (信息框 (“此次操作将删除该规则，继续吗？”, 相加 (#询问图标, #确认取消钮), “提示信息”), #确认钮))
    编辑.删除表项 (., 编辑..)
.如果真结束


.子程序 _内容排除_表项被激活, 空白型, , 
赋值 (.下划线, “1”)
编辑.取消表项选择 (., 编辑..)
载入 (添加窗口, , 真)

.子程序 _内容替换_表项被激活, 空白型, , 
赋值 (.下划线, “1”)
编辑.取消表项选择 (., 编辑..)
载入 (添加窗口, , 真)

.子程序 _取消按钮1_被单击, 空白型, , 
销毁 ()

.子程序 _确定按钮1_被单击, 空白型, , 
.局部变量 内容排除变量1, 文本型, , , 
.局部变量 内容排除变量, 文本型, , , 
.局部变量 i, 整数型, , , 
.局部变量 内容替换变量, 文本型, , , 
.局部变量 内容替换变量1, 文本型, , , 

赋值 (i, 0)
.判断循环首 (大于 (取表项数 (), i))
    赋值 (内容排除变量1, i.取标题 ())
    赋值 (内容排除变量, 相加 (内容排除变量, “_>”, 内容排除变量1))
    赋值 (i, 相加 (i, 1))
.判断循环尾 ()
赋值 (i, 0)
.判断循环首 (大于 (取表项数 (), i))
    赋值 (内容替换变量1, i.取标题 ())
    赋值 (内容替换变量, 相加 (内容替换变量, “_>”, 内容替换变量1))
    赋值 (i, 相加 (i, 1))
.判断循环尾 ()

设置.未知支持库函数_17 (.)
设置.未知支持库函数_20 (., “标签名”, .内容)
设置.未知支持库函数_20 (., “开始字符串”, .内容)
设置.未知支持库函数_20 (., “结束字符串”, .内容)
设置.未知支持库函数_20 (., “内容排除”, 内容排除变量)
设置.未知支持库函数_20 (., “内容替换”, 内容替换变量)
 ' 设置.信息表.写文本 (“内容开始”, 内容开始.内容)
 ' 设置.信息表.写文本 (“内容结束”, 内容结束.内容)

.判断开始 (等于 (设置..下划线, “修改”))
    设置.未知支持库函数_38 (., 设置.取表项数值 (., 设置..))
    设置.未知支持库函数_19 (., #)
    赋值 (设置..下划线, “”)
.默认
    
.判断结束
设置.未知支持库函数_18 (.)
设置.显示 ()
销毁 ()

.子程序 显示记录1, 逻辑型, , 
.参数 id, 整数型, , 

.局部变量 文本, 文本型, , , 
.局部变量 内容替换1, 文本型, , , 
.局部变量 开始字符串1, 文本型, , , 
.局部变量 结束字符串1, 文本型, , , 
.局部变量 内容排除1, 文本型, , , 
.局部变量 内容, 文本型, , "0", 
.局部变量 k, 整数型, , , 
.局部变量 内容开始1, 文本型, , , 
.局部变量 内容结束1, 文本型, , , 

赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
全部删除 ()
全部删除 ()
.如果真 (大于 (id, 0))
    .如果真 (等于 (设置.未知支持库函数_38 (., 相减 (id, 1)), 假))
        返回 (假)
    .如果真结束
    
.如果真结束
设置.未知支持库函数_26 (., “标签名”, 文本)
赋值 (.内容, 文本)
设置.未知支持库函数_26 (., “开始字符串”, 开始字符串1)
赋值 (.内容, 开始字符串1)
设置.未知支持库函数_26 (., “结束字符串”, 结束字符串1)
赋值 (.内容, 结束字符串1)
设置.未知支持库函数_26 (., “内容排除”, 内容排除1)
 ' 设置.信息表.读文本 (“内容开始”, 内容开始1)
 ' 内容开始.内容 ＝ 内容开始1
 ' 设置.信息表.读文本 (“内容结束”, 内容结束1)
 ' 内容结束.内容 ＝ 内容结束1
赋值 (内容, 分割文本 (内容排除1, “_>”, ))
.变量循环首 (1, 取数组成员数 (内容), 1, k)
    .判断开始 (等于 (内容 [k], “”))
        
    .默认
        0.插入表项 (内容 [k], , , , k)
    .判断结束
    
.变量循环尾 ()
设置.未知支持库函数_26 (., “内容替换”, 内容替换1)
赋值 (内容, 分割文本 (内容替换1, “_>”, ))
.变量循环首 (1, 取数组成员数 (内容), 1, k)
    .判断开始 (等于 (内容 [k], “”))
        
    .默认
        赋值 (k, -1.插入表项 (内容 [k], , , , ))
        k.置标题 (1, 内容 [2])
    .判断结束
    
.变量循环尾 ()
返回 (真)

.子程序 _编辑_将被销毁, 空白型, , 
赋值 (设置..标记, “”)
赋值 (设置..标记, “”)
赋值 (设置..下划线, “”)


.子程序 _透明标签6_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 



.窗口程序集 添加窗口窗口程序集, , , 

.子程序 _确定2_被单击, 空白型, , 
.判断开始 (等于 (.内容, “”))
    信息框 (“请填写完整！”, 0, “提示”)
.默认
    编辑.删除表项 (., 编辑..)
    编辑.插入表项 (., , .内容, , , , )
    销毁 ()
.判断结束


.子程序 _添加窗口_创建完毕, 空白型, , 
.局部变量 内容, 文本型, , "0", 
.局部变量 k, 整数型, , , 

.判断开始 (等于 (编辑..下划线, “0”))
    赋值 (编辑..下划线, “”)
    赋值 (.高度, 128)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    12.移动 (14, , )
    赋值 (.可视, 真)
.判断 (等于 (编辑..下划线, “0”))
    赋值 (编辑..下划线, “”)
    赋值 (.可视, 真)
.默认
    
.判断结束

.判断开始 (等于 (编辑..下划线, “1”))
    赋值 (编辑..下划线, “”)
    赋值 (.内容, 编辑.取标题 (., 编辑.., ))
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
    12.移动 (14, , )
    赋值 (.高度, 128)
    赋值 (.可视, 真)
.默认
    
.判断结束

.判断开始 (等于 (编辑..下划线, “1”))
    赋值 (编辑..下划线, “”)
    赋值 (内容, 分割文本 (编辑.取标题 (., 编辑.., ), “->”, ))
    赋值 (.内容, 内容 [1])
    赋值 (.内容, 内容 [2])
    赋值 (.可视, 真)
.默认
    
.判断结束


.子程序 _确定1_被单击, 空白型, , 
.判断开始 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“请填写完整！”, 0, “提示”)
.默认
    赋值 (编辑..下划线, “”)
    编辑.删除表项 (., 编辑..)
    编辑.插入表项 (., , 相加 (.内容, “->”, .内容), , , , )
    销毁 ()
.判断结束


.子程序 _添加窗口_将被销毁, 空白型, , 
赋值 (编辑..下划线, “”)
赋值 (编辑..下划线, “”)

.窗口程序集 新建站点窗口程序集, , , 

.子程序 _确定_被单击, 空白型, , 
.如果 (不等于 (.内容, “”))
    创建目录 (相加 (取运行目录 (), “\data”))
    创建目录 (相加 (取运行目录 (), “\data\”, .内容))
    _启动窗口.刷新站点 ()
    销毁 ()
.否则
    
.如果结束


.子程序 _新建站点_创建完毕, 空白型, , 
.判断开始 (等于 (_启动窗口..标记, “0”))
    赋值 (_启动窗口..标记, “”)
    赋值 (.内容, “任务名：”)
    赋值 (.可视, 假)
    赋值 (.可视, 真)
.默认
    
.判断结束



.子程序 _确定按钮_被单击, 空白型, , 
.如果 (不等于 (.内容, “”))
    赋值 (当前站点, _启动窗口.取项目文本 (., _启动窗口..现行选中项))
    .如果 (文件是否存在 (相加 (取运行目录 (), “\data\”, 当前站点, “\”, .内容, “.mdb”)))
        信息框 (“该任务已经存在！”, 0, )
    .否则
        写到文件 (相加 (取运行目录 (), “\data\”, 当前站点, “\”, .内容, “.mdb”), #数据库模板)
        写到文件 (相加 (取运行目录 (), “\data\”, 当前站点, “\”, .内容, “-config”, “.db”), #配置信息)
        _启动窗口.刷新任务 ()
    .如果结束
    
.否则
    
.如果结束
销毁 ()

.程序集 测试程序集, , , 

.程序集变量 标题开始, 文本型, , , 
.程序集变量 内容排除, 文本型, , , 
.程序集变量 内容替换, 文本型, , , 
.程序集变量 标题结束, 文本型, , , 
.程序集变量 得到标题, 文本型, , , 
.程序集变量 要替换掉的, 文本型, , "0", 
.程序集变量 内容开始1, 文本型, , , 
.程序集变量 内容结束, 文本型, , , 
.子程序 测试开始, 空白型, , 
开始连接 ()
赋值 (文件内容, 设置..内容)
.计次循环首 (设置.., )
    设置.未知支持库函数_26 (., “开始字符串”, 标题开始)
    设置.未知支持库函数_26 (., “结束字符串”, 标题结束)
    设置.未知支持库函数_26 (., “内容排除”, 内容排除)
    设置.未知支持库函数_26 (., “内容替换”, 内容替换)
    设置.未知支持库函数_26 (., “内容开始”, 内容开始1)
    设置.未知支持库函数_26 (., “内容结束”, 内容结束)
    取得标题 ()
    得到内容 ()
    设置.未知支持库函数_36 (.)
.计次循环尾 ()


.子程序 取得标题, 空白型, , 
.局部变量 k, 整数型, , , 
.局部变量 标题开始位置, 整数型, , , 
.局部变量 标题结束位置, 整数型, , , 

赋值 (标题开始位置, 寻找文本 (文件内容, 标题开始, 0, 假))
赋值 (标题结束位置, 寻找文本 (文件内容, 标题结束, 标题开始位置, 假))
赋值 (得到标题, 取文本中间 (文件内容, 相加 (标题开始位置, 取文本长度 (标题开始)), 相减 (标题结束位置, 标题开始位置, 取文本长度 (标题开始))))
排除内容 (得到标题)
 ' _启动窗口.标题 ＝ 得到标题
赋值 (设置..内容, “”)
设置.加入文本 (., 相加 (“标题：”, 得到标题, #换行符))

.子程序 排除内容, 文本型, , 
.参数 内容, 文本型, , 

.局部变量 k, 整数型, , , 

赋值 (要替换掉的, 分割文本 (内容排除, “_>”, ))
.变量循环首 (1, 取数组成员数 (要替换掉的), 1, k)
    赋值 (内容, 子文本替换 (内容, 要替换掉的 [k], “”, , , 真))
.变量循环尾 ()
返回 (内容)

.子程序 得到内容, 空白型, , 
.局部变量 指针, 整数型, , , 
.局部变量 内容替换2, 文本型, , "0", 
.局部变量 指针1, 整数型, , , 
.局部变量 内容替换1, 文本型, , "0", 
.局部变量 替换1, 文本型, , , 
.局部变量 替换2, 文本型, , , 
.局部变量 内容, 文本型, , , 
.局部变量 内容开始位置, 整数型, , , 
.局部变量 内容结束位置, 整数型, , , 

赋值 (内容开始位置, 寻找文本 (文件内容, 内容开始1, 0, 假))
赋值 (内容结束位置, 寻找文本 (文件内容, 内容结束, 内容开始位置, 假))
赋值 (内容, 取文本中间 (文件内容, 相加 (内容开始位置, 取文本长度 (内容开始1)), 相减 (内容结束位置, 内容开始位置, 取文本长度 (内容开始1))))
赋值 (内容替换1, 分割文本 (内容替换, “_>”, ))
.变量循环首 (1, 取数组成员数 (内容替换1), 1, 指针)
    .判断开始 (等于 (内容替换1 [指针], “”))
        
    .默认
        赋值 (内容替换2, 分割文本 (内容替换1 [指针], “->”, ))
        赋值 (替换1, 内容替换2 [1])
        赋值 (替换2, 内容替换2 [2])
        赋值 (内容, 子文本替换 (内容, 替换1, 替换2, , , 真))
    .判断结束
    
.变量循环尾 ()
排除内容 (内容)
 ' 设置.源代码.内容 ＝ 内容
设置.加入文本 (., 相加 (“内容：”, 内容))

.子程序 开始连接, 空白型, , 
设置.未知支持库函数_12 (., _启动窗口.)
设置.未知支持库函数_14 (., “采集规则信息”, #)


.程序集 提取程序集, , , 

.子程序 读取, 空白型, , 
.局部变量 XML对象, 对象, , , 
.局部变量 变体型, 变体型, , , 

.如果真 (等于 (XML对象.创建 (“MSXML2.XMLHTTP”, ), 假))
    .如果真 (等于 (XML对象.创建 (“Microsoft.XMLHTTP”, ), 假))
        信息框 (“创建对象失败”, 0, )
        返回 ()
    .如果真结束
    
.如果真结束
赋值 (设置..禁止, 真)
XML对象.方法 (“open”, “GET”, 设置..内容, 假)
XML对象.方法 (“send”, )
赋值 (变体型, XML对象.读属性 (“responseBody”, ))
赋值 (设置..内容, 到文本 (变体型.取字节集 ()))
赋值 (设置..禁止, 假)


.子程序 取Maxthon地址, 空白型, , 
.局部变量 hwnd, 整数型, , , 
.局部变量 hwnd1, 整数型, , , 
.局部变量 文本, 文本型, , , 
.局部变量 hwnd2, 整数型, , , 
.局部变量 hwnd3, 整数型, , , 
.局部变量 找到, 逻辑型, , , 

赋值 (hwnd, FindWindowEx (0, hwnd, “IEFrame”, 0))
.判断循环首 (不等于 (hwnd, 0))
    赋值 (hwnd1, FindWindowEx (hwnd, 0, “ReBarWindow32”, 0))
    赋值 (hwnd2, FindWindowEx (hwnd1, 0, “ToolbarWindow32”, 0))
    .判断循环首 (不等于 (hwnd2, 0))
        赋值 (hwnd3, GetDlgItem (hwnd2, 33177))
        .如果真 (不等于 (hwnd3, 0))
            赋值 (hwnd3, FindWindowEx (hwnd3, 0, “Edit”, 0))
            赋值 (文本, 取空白文本 (255))
            SendMessage (hwnd3, 13, 255, 文本)
            赋值 (设置..内容, 文本)
            赋值 (找到, 真)
            跳出循环 ()
        .如果真结束
        赋值 (hwnd2, FindWindowEx (hwnd1, hwnd2, “ToolbarWindow32”, 0))
    .判断循环尾 ()
    .如果真 (找到)
        跳出循环 ()
    .如果真结束
    赋值 (hwnd, FindWindowEx (0, hwnd, “IEFrame”, 0))
.判断循环尾 ()
.如果真 (取反 (找到))
    信息框 (“Maxthon浏览器窗口不存在”, 0, )
    赋值 (设置..内容, “”)
.如果真结束


.子程序 取IE地址, 空白型, , 
.局部变量 hwnd, 整数型, , , 
.局部变量 hwnd1, 整数型, , , 
.局部变量 文本, 文本型, , , 
.局部变量 f, 整数型, , , 

.判断循环首 (等于 (hwnd1, 0))
    赋值 (hwnd, FindWindowEx (0, hwnd, “IEFrame”, 0))
    .如果真 (不等于 (hwnd, 0))
        赋值 (hwnd1, FindWindowEx (hwnd, 0, “WorkerW”, 0))
    .如果真结束
    处理事件 ()
    赋值 (f, 相加 (f, 1))
    .判断开始 (等于 (f, 20))
        信息框 (“IE浏览器窗口不存在”, 0, )
        跳出循环 ()
    .判断 (不等于 (hwnd1, 0))
        跳出循环 ()
    .默认
        
    .判断结束
    
.判断循环尾 ()
赋值 (hwnd1, FindWindowEx (hwnd1, 0, “ReBarWindow32”, 0))
赋值 (hwnd1, FindWindowEx (hwnd1, 0, “ComboBoxEx32”, 0))
赋值 (文本, 取空白文本 (255))
SendMessage (hwnd1, 13, 255, 文本)
赋值 (设置..内容, 文本)

.子程序 说明ie, 空白型, , 
赋值 (设置..标记, “0”)
 ' _启动窗口.位置 ＝ 2
载入 (说明, , 真)

.子程序 说明Maxthon, 空白型, , 
赋值 (设置..标记, “1”)
 ' _启动窗口.位置 ＝ 2
载入 (说明, , 真)

.程序集 采集程序集, , , 

.程序集变量 采集深度1, 文本型, , , 
.程序集变量 采集地址列表框1, 文本型, , , 
.程序集变量 必须包含1, 文本型, , , 
.程序集变量 不得包含1, 文本型, , , 
.程序集变量 文章包含1, 文本型, , , 
.程序集变量 文章不得包含1, 文本型, , , 
.程序集变量 从1, 文本型, , , 
.程序集变量 到1, 文本型, , , 
.程序集变量 匿名程序集变量_1776, 空白型, , , 
.程序集变量 地址, 文本型, , , 
.程序集变量 匿名程序集变量_1777, 空白型, , , 
.程序集变量 标题开始, 文本型, , , 
.程序集变量 内容排除, 文本型, , , 
.程序集变量 内容替换, 文本型, , , 
.程序集变量 标题结束, 文本型, , , 
.程序集变量 得到标题, 文本型, , , 
.程序集变量 要替换掉的, 文本型, , "0", 
.程序集变量 内容开始1, 文本型, , , 
.程序集变量 内容结束, 文本型, , , 
.程序集变量 匿名程序集变量_1808, 空白型, , , 
.程序集变量 得到源代码, 文本型, , , 
.程序集变量 匿名程序集变量_1912, 空白型, , , 
.程序集变量 索引, 整数型, , , 
.程序集变量 匿名程序集变量_1911, 空白型, , , 
.子程序 采集, 空白型, , 
显示1 ()
赋值 (索引, 0)
.如果 (等于 (采集深度1, “0”))
    取得源代码 ()
.否则
    .如果 (等于 (采集深度1, “1”))
        
    .否则
        .如果 (等于 (采集深度1, “2”))
            
        .否则
            
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 显示1, 空白型, , 
.局部变量 采集地址, 文本型, , "0", 
.局部变量 i, 整数型, , , 

赋值 (当前数据库, 相加 (取运行目录 (), “\data\”, 当前站点, “\”, 当前任务, “-config”, “.db”))
.如果 (等于 (_启动窗口.未知支持库函数_1 (., 当前数据库, “”), 真))
    _启动窗口.未知支持库函数_12 (., _启动窗口.)
    _启动窗口.未知支持库函数_14 (., “配置信息”, #)
    _启动窗口.未知支持库函数_26 (., “采集深度”, 采集深度1)
    _启动窗口.未知支持库函数_26 (., “采集地址列表框”, 采集地址列表框1)
    _启动窗口.未知支持库函数_26 (., “必须包含”, 必须包含1)
    _启动窗口.未知支持库函数_26 (., “不得包含”, 不得包含1)
    _启动窗口.未知支持库函数_26 (., “文章包含”, 文章包含1)
    _启动窗口.未知支持库函数_26 (., “文章不包含”, 文章不得包含1)
    _启动窗口.未知支持库函数_26 (., “从”, 从1)
    _启动窗口.未知支持库函数_26 (., “到”, 到1)
    赋值 (采集地址, 分割文本 (采集地址列表框1, “`”, ))
    .变量循环首 (1, 取数组成员数 (采集地址), 1, i)
        赋值 (地址, 采集地址 [i])
        赋值 (_启动窗口..内容, 地址)
    .变量循环尾 ()
.否则
    
.如果结束


.子程序 开始采集, 空白型, , 
赋值 (文件内容, 得到源代码)
赋值 (当前数据库, 相加 (取运行目录 (), “\data\”, 当前站点, “\”, 当前任务, “.mdb”))
.如果 (等于 (_启动窗口.未知支持库函数_1 (., 当前数据库, “”), 真))
    _启动窗口.未知支持库函数_12 (., _启动窗口.)
    _启动窗口.未知支持库函数_14 (., “采集规则信息”, #)
    .计次循环首 (_启动窗口.., )
        _启动窗口.未知支持库函数_26 (., “开始字符串”, 标题开始)
        _启动窗口.未知支持库函数_26 (., “结束字符串”, 标题结束)
        _启动窗口.未知支持库函数_26 (., “内容排除”, 内容排除)
        _启动窗口.未知支持库函数_26 (., “内容替换”, 内容替换)
        _启动窗口.未知支持库函数_26 (., “内容开始”, 内容开始1)
        _启动窗口.未知支持库函数_26 (., “内容结束”, 内容结束)
        得到标题 ()
        取得内容 ()
        _启动窗口.未知支持库函数_36 (.)
    .计次循环尾 ()
.否则
    
.如果结束


.子程序 得到标题, 空白型, , 
.局部变量 k, 整数型, , , 
.局部变量 标题开始位置, 整数型, , , 
.局部变量 标题结束位置, 整数型, , , 

赋值 (标题开始位置, 寻找文本 (文件内容, 标题开始, 0, 假))
赋值 (标题结束位置, 寻找文本 (文件内容, 标题结束, 标题开始位置, 假))
赋值 (得到标题, 取文本中间 (文件内容, 相加 (标题开始位置, 取文本长度 (标题开始)), 相减 (标题结束位置, 标题开始位置, 取文本长度 (标题开始))))
排除内容1 (得到标题)
 ' _启动窗口.地址列表框.插入表项 (-1, , , , , )
赋值 (索引, _启动窗口.插入表项 (., -1, 到文本 (相加 (索引, 1)), , , , 相加 (索引, 1)))
_启动窗口.置标题 (., 索引, , 得到标题)

.子程序 排除内容1, 文本型, , 
.参数 内容, 文本型, , 

.局部变量 k, 整数型, , , 

赋值 (要替换掉的, 分割文本 (内容排除, “_>”, ))
.变量循环首 (1, 取数组成员数 (要替换掉的), 1, k)
    赋值 (内容, 子文本替换 (内容, 要替换掉的 [k], “”, , , 真))
.变量循环尾 ()
返回 (内容)

.子程序 取得内容, 空白型, , 
.局部变量 指针, 整数型, , , 
.局部变量 内容替换2, 文本型, , "0", 
.局部变量 指针1, 整数型, , , 
.局部变量 内容替换1, 文本型, , "0", 
.局部变量 替换1, 文本型, , , 
.局部变量 替换2, 文本型, , , 
.局部变量 内容, 文本型, , , 
.局部变量 内容开始位置, 整数型, , , 
.局部变量 内容结束位置, 整数型, , , 

赋值 (内容开始位置, 寻找文本 (文件内容, 内容开始1, 0, 假))
赋值 (内容结束位置, 寻找文本 (文件内容, 内容结束, 内容开始位置, 假))
赋值 (内容, 取文本中间 (文件内容, 相加 (内容开始位置, 取文本长度 (内容开始1)), 相减 (内容结束位置, 内容开始位置, 取文本长度 (内容开始1))))
赋值 (内容替换1, 分割文本 (内容替换, “_>”, ))
.变量循环首 (1, 取数组成员数 (内容替换1), 1, 指针)
    .判断开始 (等于 (内容替换1 [指针], “”))
        
    .默认
        赋值 (内容替换2, 分割文本 (内容替换1 [指针], “->”, ))
        赋值 (替换1, 内容替换2 [1])
        赋值 (替换2, 内容替换2 [2])
        赋值 (内容, 子文本替换 (内容, 替换1, 替换2, , , 真))
    .判断结束
    
.变量循环尾 ()
排除内容1 (内容)
_启动窗口.插入表项 (., 2, 内容, , , , )

.子程序 取得源代码, 空白型, , 
.局部变量 XML对象, 对象, , , 
.局部变量 变体型, 变体型, , , 

.如果真 (等于 (XML对象.创建 (“MSXML2.XMLHTTP”, ), 假))
    .如果真 (等于 (XML对象.创建 (“Microsoft.XMLHTTP”, ), 假))
        信息框 (“创建对象失败”, 0, )
        返回 ()
    .如果真结束
    
.如果真结束

.如果真 (不等于 (地址, “”))
    XML对象.方法 (“open”, “GET”, 地址, 假)
    XML对象.方法 (“send”, )
    赋值 (变体型, XML对象.读属性 (“responseBody”, ))
    赋值 (得到源代码, 到文本 (变体型.取字节集 ()))
    赋值 (_启动窗口..内容, 得到源代码)
    开始采集 ()
.如果真结束



 ' 不属于任何一个程序集、类模块的函数：
