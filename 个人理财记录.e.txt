 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.wodesoft.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.wodesoft.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.wodesoft.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 805
    高度 = 565
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “个人理财记录”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 325
    高度 = 161
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于”
    帮助文件名 = “”



.图片 二维心里话, " ' 已保存到：D:\易语言学习\Data\个人理财记录.e\二维心里话", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一





.窗口程序集 窗口程序集1, , , 

.程序集变量 标准目录, 文本型, , , 
.程序集变量 数据库名, 文本型, , , 
.程序集变量 标签数组, 标签, , "0", 
.程序集变量 回车分割数组, 文本型, , "0", 
.程序集变量 编辑框数组, 编辑框, , "0", 
.程序集变量 密码变量, 文本型, , , 存密码的，以后要改成双重MD5
.程序集变量 所有原因文本数组, 文本型, , "0", 
.程序集变量 临时文本, 文本型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 字段库, 字段信息, , "5", 
.局部变量 i, 整数型, , , 

 ' --========  易语言资源网  (www.wodesoft.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.wodesoft.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.wodesoft.com  ================--

 ' 20090816动工
 ' 路过已错过，忘记是最好的纪念品，想念到此结束。

赋值 (标准目录, 取运行目录 ())
.如果真 (不等于 (取文本右边 (标准目录, 1), “\”))
    赋值 (标准目录, 相加 (标准目录, “\”))
.如果真结束
赋值 (数据库名, “savedat.edb”)

.如果真 (等于 (寻找文件 (相加 (标准目录, 数据库名), ), “”))
    赋值 (字段库 [1].名称, “发生时间”)
    赋值 (字段库 [1].类型, #字节集型)
    
    赋值 (字段库 [2].名称, “收支类别”)
    赋值 (字段库 [2].类型, #字节集型)
    
    赋值 (字段库 [3].名称, “原因”)
    赋值 (字段库 [3].类型, #字节集型)
    
    赋值 (字段库 [4].名称, “金额”)
    赋值 (字段库 [4].类型, #字节集型)
    
    赋值 (字段库 [5].名称, “备注”)
    赋值 (字段库 [5].类型, #字节集型)
     ' 本源码来自易语言资源网(www.wodesoft.com)
    
    
    创建 (数据库名, 字段库)
    输入框 (“请输入数据库密码，不设置为空”, “是否需要设置密码？”, , 密码变量, )
    .如果真 (不等于 (密码变量, “”))
        信息框 (更改密码 (“”, 密码变量), 0, )
    .如果真结束
    
.如果真结束

.如果真 (是否已加密 (相加 (标准目录, 数据库名)))
    输入框 (“数据库已加密，请输入密码。”, “密码”, , 密码变量, )
.如果真结束

.如果真 (等于 (打开 (相加 (标准目录, 数据库名), , , , , 密码变量, ), 假)) ' 打开字段库写入并初始数据)
    信息框 (“密码错误。”, 0, )
    结束 ()
.如果真结束



设置超级列表框报表 ()
读取全部数据库记录 ()


.子程序 更改密码, 文本型, , 
.参数 旧密码, 文本型, , 
.参数 新密码, 文本型, , 

关闭 ()
.如果真 (等于 (打开 (相加 (标准目录, 数据库名), , , , , 旧密码, ), 假))
    返回 (“旧密码不正确。”)
.如果真结束

.如果真 (等于 (置数据库密码 (新密码), 假))
    返回 (“无法设置新密码。”)
.如果真结束
关闭 ()
.如果真 (等于 (打开 (相加 (标准目录, 数据库名), , , , , 新密码, ), 假))
    返回 (“新密码不正确。”)
.如果真结束
返回 (“成功设置。”)

.子程序 设置超级列表框报表, 空白型, , 
.局部变量 字段数变量2, 整数型, , , 

赋值 (., {  })
.计次循环首 (取字段数 (), 字段数变量2)
    .插入列 (取字段名 (字段数变量2), 相乘 (取文本长度 (取字段名 (字段数变量2)), 10), , , )
.计次循环尾 ()
 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 __启动窗口_尺寸被改变, 空白型, , 
赋值 (., 10)
赋值 (., 相减 (_启动窗口., 30))

赋值 (.左边, 10)
赋值 (.宽度, 相减 (_启动窗口., 30))


.子程序 _按钮1_被单击, 空白型, , 
.局部变量 编辑框数组变量, 整数型, , , 
.局部变量 检查是否空变量, 整数型, , , 

 ' 是否有空数据
.判断开始 (等于 (.取项目文本 (.现行选中项), “”))
    输出调试文本 (“请选择收支类别！”)
    获取焦点 ()
    返回 ()
.判断 (等于 (.内容, “”))
    输出调试文本 (“请选择说明发生原因！”)
    获取焦点 ()
    返回 ()
.判断 (等于 (.内容, “”))
    输出调试文本 (“请说明发生金额，没有请输入0。”)
    获取焦点 ()
    返回 ()
.判断 (等于 (.内容, “”))
    输出调试文本 (“请输入备注内容。”)
    获取焦点 ()
    返回 ()
.默认
    
.判断结束


到首记录 ()
加记录 (到字节集 (到文本 (取日期 (.今天))), 到字节集 (.取项目文本 (.现行选中项)), 到字节集 (.内容), 到字节集 (.内容), 到字节集 (.内容)) ' 本来这里要动态计算有几个编辑框的，但搞吾掂，所以如果数据库字段有变化的话要做相应整理。


读取全部数据库记录 ()

.子程序 读取全部数据库记录, 空白型, , 
.局部变量 读数据库变量, 整数型, , , 
.局部变量 字段变量, 整数型, , , 
.局部变量 id, 整数型, , , 
.局部变量 历遍变量, 整数型, , , 
.局部变量 是否有重复, 逻辑型, , , 

全部删除 ()
 ' 计次循环首 (取记录数 (), 读数据库变量)

 ' 加入自定义的原因文本
加入成员 (所有原因文本数组, “记帐”) ' 不自动参加计算项   字符串要和其他同步更改

.变量循环首 (取记录数 (), 1, -1, 读数据库变量)
    跳到 (读数据库变量)
    赋值 (id, .插入表项 (到文本 (读字段 (1, )), , , , 取记录号 ()))
    
    
    .计次循环首 (取字段数 (), 字段变量)
        .如果真 (等于 (字段变量, 3)) ' 设置原因组合框2
            赋值 (临时文本, 到文本 (读字段 (字段变量, )))
            
            .如果 (等于 (取数组成员数 (所有原因文本数组), 0))
                加入成员 (所有原因文本数组, 临时文本)
            .否则
                赋值 (是否有重复, 假)
                .变量循环首 (1, 取数组成员数 (所有原因文本数组), 1, 历遍变量)
                    .如果真 (等于 (所有原因文本数组 [历遍变量], 临时文本))
                        赋值 (是否有重复, 真)
                        跳出循环 ()
                    .如果真结束
                    
                .变量循环尾 ()
                .如果真 (等于 (是否有重复, 假))
                    加入成员 (所有原因文本数组, 临时文本)
                .如果真结束
                
            .如果结束
            
        .如果真结束
        
        
        id.置标题 (相减 (字段变量, 1), 到文本 (读字段 (字段变量, )))
         ' 输出调试文本 (到文本 (读字段 (字段变量, )))
    .计次循环尾 ()
.变量循环尾 ()

 ' 本源码来自易语言资源网(www.wodesoft.com)
.如果真 (不等于 (取数组成员数 (所有原因文本数组), 0))
    清空 ()
    .变量循环首 (1, 取数组成员数 (所有原因文本数组), 1, 历遍变量)
        所有原因文本数组.加入项目 ( [历遍变量], )
    .变量循环尾 ()
.如果真结束

自动调整列宽 ()
超级列表框数据改变 ()

.子程序 自动调整列宽, 空白型, , 
.局部变量 列数变量, 整数型, , , 

.变量循环首 (0, 取列数 (), 1, 列数变量)
    4126.发送信息 (列数变量, -2) ' 自动调整列宽
.变量循环尾 ()

.子程序 __启动窗口_将被销毁, 空白型, , 
关闭 ()

.子程序 _按钮2_被单击, 空白型, , 
.局部变量 索引号码, 整数型, , , 
.局部变量 要删的ID, 整数型, , , 

.判断循环首 (不等于 (索引号码, 取表项数 ()))
    .如果 (等于 (索引号码.取当前状态图片 (), 1))
        
         ' 数据库删除操作
        赋值 (要删的ID, 索引号码.取表项数值 ())
        .如果真 (不等于 (要删的ID, 0))
            跳到 (要删的ID)
            删除 ()
        .如果真结束
        
        索引号码.删除表项 ()
        赋值 (索引号码, 相减 (索引号码, 1))
        .如果真 (小于 (索引号码, 0))
            赋值 (索引号码, 0)
        .如果真结束
        
    .否则
        赋值 (索引号码, 相加 (索引号码, 1))
    .如果结束
    
.判断循环尾 ()
彻底删除 ()
读取全部数据库记录 ()

.子程序 _按钮4_被单击, 空白型, , 
.局部变量 得到旧密码, 文本型, , , 
.局部变量 得到新密码, 文本型, , , 

输入框 (“请先输入旧密码，没有为空。”, “旧密码”, , 得到旧密码, )
输入框 (“请先输入新密码。”, “新密码”, , 得到新密码, )
信息框 (更改密码 (得到旧密码, 得到新密码), 0, )


.子程序 _收支类别组合框1_列表项被选择, 空白型, , 
.如果 (等于 (.现行选中项, 1)) ' 选了收入
    赋值 (.文本颜色, #红色)
    赋值 (.文本颜色, #红色)
.否则
    赋值 (.文本颜色, #黑色)
    赋值 (.文本颜色, #黑色)
.如果结束


.子程序 _超级列表框1_左键单击表项, 空白型, , 
.如果真 (等于 (., -1))
    数据输入框初始化 ()
    返回 ()
.如果真结束

赋值 (.今天, 到时间 (.取标题 (., 0)))

.如果 (等于 (.取标题 (., 1), “收入”))
    赋值 (.现行选中项, 0)
.否则
    赋值 (.现行选中项, 1)
.如果结束
_收支类别组合框1_列表项被选择 ()

赋值 (.内容, .取标题 (., 2))

赋值 (.内容, .取标题 (., 3))

赋值 (.内容, .取标题 (., 4))

 ' 本源码来自易语言资源网(www.wodesoft.com)

.子程序 数据输入框初始化, 空白型, , 
赋值 (.今天, 取现行时间 ())
赋值 (.现行选中项, -1)
赋值 (.现行选中项, -1)
赋值 (.内容, “0”)
赋值 (.内容, “空”)


.子程序 _按钮3_被单击, 空白型, , 
.如果真 (等于 (., -1))
    输出调试文本 (“请先选择要修改的数据.”)
    返回 ()
.如果真结束
跳到 (.取表项数值 (.))
修改 (到字节集 (到文本 (取日期 (.今天))), 到字节集 (.取项目文本 (.现行选中项)), 到字节集 (.内容), 到字节集 (.内容), 到字节集 (.内容))
读取全部数据库记录 ()

.子程序 _按钮5_被单击, 空白型, , 
载入 (关于窗口, _启动窗口, 真)

.子程序 超级列表框数据改变, 空白型, , 
.局部变量 记录数, 整数型, , , 
.局部变量 变量i, 整数型, , , 
.局部变量 收入总金额, 双精度小数型, , , 
.局部变量 支出总金额, 双精度小数型, , , 

赋值 (记录数, 取表项数 ())
.如果真 (等于 (记录数, 0))
    0.置文本 (相加 (“当前记录数：”, 到文本 (记录数)))
    1.置文本 (相加 (“收入总金额：”, 到文本 (收入总金额)))
    2.置文本 (相加 (“支出总金额：”, 到文本 (支出总金额)))
    3.置文本 (相加 (“收支后余额：”, 到文本 (相减 (收入总金额, 支出总金额))))
    返回 ()
.如果真结束
0.置文本 (相加 (“当前记录数：”, 到文本 (记录数)))

.变量循环首 (0, 相减 (记录数, 1), 1, 变量i)
    .如果真 (不等于 (变量i.取标题 (2), “记帐”)) ' 不自动参加计算项   字符串要和其他同步更改
        .判断开始 (等于 (变量i.取标题 (1), “收入”))
            赋值 (收入总金额, 相加 (收入总金额, 到数值 (变量i.取标题 (3))))
        .判断 (等于 (变量i.取标题 (1), “支出”))
            赋值 (支出总金额, 相加 (支出总金额, 到数值 (变量i.取标题 (3))))
        .默认
            ' 本源码来自易语言资源网(www.wodesoft.com)
        .判断结束
        
    .如果真结束
    
.变量循环尾 ()
1.置文本 (相加 (“收入总金额：”, 到文本 (收入总金额)))
2.置文本 (相加 (“支出总金额：”, 到文本 (支出总金额)))
3.置文本 (相加 (“收支后余额：”, 到文本 (相减 (收入总金额, 支出总金额))))


.窗口程序集 窗口程序集2, , , 

.子程序 _关于窗口_创建完毕, 空白型, , 
.局部变量 要写的字, 文本型, , , 

赋值 (要写的字, 相加 (“路过已错过，忘记是最好的纪念品，想念到此结束。”, #换行符, #换行符, “by horizon”, #换行符, “20090816”))
载入图片 (#二维心里话).画图片 (相减 (.宽度, 110), 15, 100, 100, )
要写的字.写出 ()


.子程序 _按钮1_被单击, 空白型, , 
销毁 ()


 ' 不属于任何一个程序集、类模块的函数：
