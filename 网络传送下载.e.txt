 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 534
    高度 = 352
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' downlib 80CF4A6B3E09425bA57935A3A0E4C473 2 0 网络传送支持库
 ' iext6 {E60056EA-07A8-4bf5-B6F0-DF05DE6FAE1F} 1 1 扩展界面支持库六





.窗口程序集 窗口程序集1, , , 

.程序集变量 下载任务, 未知类型0x30004, , , 
.程序集变量 下载对象, 未知类型0x30001, , , 
.程序集变量 程序集_文件大小, 双精度小数型, , , 
.程序集变量 程序集_已下载文件大小, 双精度小数型, , , 
.子程序 _编辑框_用户_内容被改变, 空白型, , 


.子程序 子程序_日志函数, 空白型, , 
.参数 线程信息, 整数型, , 
.参数 消息产生的时间, 文本型, , 
.参数 消息的正文, 文本型, , 
.参数 消息类型, 整数型, , 
.参数 对象信息, 整数型, , 

输出调试文本 (消息产生的时间)
输出调试文本 (消息的正文)
输出调试文本 (消息类型)
 ' #传送常量.存在同名文件

.子程序 子程序_交互回调函数, 空白型, , 
.参数 线程信息, 整数型, , 
.参数 消息产生的时间, 整数型, , 
.参数 消息的正文, 整数型, , 
.参数 消息类型, 整数型, , 
.参数 对象信息, 整数型, , 

.局部变量 局部_字节集, 字节集, , , 

输出调试文本 (消息产生的时间)
输出调试文本 (消息的正文)
输出调试文本 (消息类型)
.判断开始 (等于 (线程信息, #.))
    赋值 (.标题, 相加 (“正在下载文件：”, 下载任务.))
    下载对象.未知支持库函数_27 (局部_字节集)
    赋值 (程序集_文件大小, 下载对象.未知支持库函数_31 (局部_字节集, 1, 0))
    赋值 (., 程序集_文件大小)
    赋值 (.标题, 相加 (数值到格式文本 (相除 (程序集_文件大小, 1000), 2, 假), “KB”))
    
.判断 (等于 (线程信息, #.))
    下载对象.未知支持库函数_27 (局部_字节集)
    赋值 (程序集_已下载文件大小, 下载对象.未知支持库函数_31 (局部_字节集, 2, 0))
    赋值 (., 程序集_已下载文件大小)
    赋值 (.标题, 相加 (“正在下载文件：”, 下载任务., “(”, 数值到格式文本 (相乘 (相除 (程序集_已下载文件大小, 程序集_文件大小), 100), 1, 假), “%)”))
    赋值 (.标题, 相加 (数值到格式文本 (相除 (下载对象.未知支持库函数_25 (), 1000), 2, 假), “KB/S”))
.判断 (等于 (线程信息, #.))
    赋值 (.标题, 相加 (“文件：”, 下载任务., “ 下载完成！”))
    信息框 (“下载结束”, 0, )
.默认
    
.判断结束
 ' #传送常量.存在同名文件

.子程序 子程序_日志回调函数, 空白型, , 
.参数 线程信息, 整数型, , 
.参数 消息产生的时间, 文本型, , 
.参数 消息的正文, 文本型, , 
.参数 消息类型, 整数型, , 
.参数 对象信息, 整数型, , 

输出调试文本 (消息产生的时间)
输出调试文本 (消息的正文)
输出调试文本 (消息类型)
.插入表项 (消息产生的时间, , , , )
相减 (取表项数 (), 1).置标题 (1, 消息的正文)


 ' #传送常量.存在同名文件

.子程序 _按钮8_被单击, 空白型, , 
赋值 (下载任务., #.)
 ' 下载任务.用户名 ＝
 ' 下载任务.用户密码 ＝
赋值 (下载任务., 1)
 ' 下载任务.传送类型 ＝ 3
赋值 (下载任务., “c:\update.mp3”)
赋值 (下载任务., .内容)
赋值 (下载任务., 5000)
赋值 (下载任务., 5000)
赋值 (下载任务., 5000)
赋值 (下载任务., 20480)
赋值 (下载任务., &子程序_交互回调函数)
赋值 (下载任务., &子程序_日志回调函数)
下载对象.未知支持库函数_19 (下载任务)


.子程序 __启动窗口_创建完毕, 空白型, , 



 ' 不属于任何一个程序集、类模块的函数：
