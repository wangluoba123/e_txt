 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _选择进程 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 515
    高度 = 396
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 1 3 高级表格支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库





.DLL命令 OpenProcess, 整数型, "kernel32", "OpenProcess", , 打开一个现有进程的句柄。返回值Long，如执行成功，返回进程句柄；零表示失败。会设置GetLastErrora。
    .参数 dwDesiredAccess, 整数型, , Long，指定这个句柄要求的访问方法。指定API32.TXT文件中以PROCESS_???开头的一个或多个常数
    .参数 bInheritHandle, 整数型, , Long，如句柄能够由子进程继承，则为TRUE
    .参数 dwProcessId, 整数型, , Long，要打开那个进程的进程标识符

.DLL命令 GetModuleFileNameExA, 整数型, "psapi.dll", "", , 获取一个已装载模板的完整路径名称。返回值Long，如执行成功，返回复制到lpFileName的实际字符数量；零表示失败。会设置GetLastErrora。
    .参数 hModule, 整数型, , 备注1无法读取，请您提供该API名报易BBS中ID号klasp完善。
    .参数 dd, 整数型, , 
    .参数 lpFileName, 文本型, , 备注2无法读取，请您提供该API名报易BBS中ID号klasp完善。
    .参数 nSize, 整数型, , 备注3无法读取，请您提供该API名报易BBS中ID号klasp完善。

.DLL命令 GetSystemDirectoryA, 整数型, "kernel32", "GetSystemDirectoryA", , 这个函数能取得Windows系统目录（System目录）的完整路径名。在这个目录中，包含了所有必要的系统文件。根据微软的标准，其他定制控件和一些共享组件也可放到这个目录。通常应避免在这个目录里创建文件。在网络环境中，往往需要管理员权限才可对这个目录进行写操作。返回值Long，装载到lpBuffer缓冲区的字符数量。如lpBuffer不够大，不能容下文件名，则返回要求的缓冲区长度。
    .参数 lpBuffer, 文本型, , 备注1无法读取，请您提供该API名报易BBS中ID号klasp完善。
    .参数 nSize, 整数型, , 备注2无法读取，请您提供该API名报易BBS中ID号klasp完善。

.DLL命令 DLL命令1, 空白型, "", "", , 

.窗口程序集 窗口程序集1, , , 

.子程序 _启动子程序, 整数型, , 
载入 (_选择进程, , 真)
返回 (0)

.子程序 __选择进程_创建完毕, 空白型, , 
赋值 (., 10)
赋值 (., 10)
赋值 (., 相减 (_选择进程.取用户区高度 (), 50))
赋值 (., 相减 (_选择进程.取用户区宽度 (), 20))

0.未知支持库函数_25 (0, 0, 2, #.)
0.未知支持库函数_9 (0, #., “进程ID”)
0.未知支持库函数_32 (80)
0.未知支持库函数_9 (1, #., “进程名称”)
1.未知支持库函数_32 (120)
0.未知支持库函数_9 (2, #., “进程路径”)
2.未知支持库函数_32 (350)
_刷新_被单击 ()


.子程序 _刷新_被单击, 空白型, , 
.局部变量 进程信息1, 未知类型0x30009, , "0", 
.局部变量 i, 整数型, , , 
.局部变量 j, 整数型, , , 
.局部变量 k, 整数型, , , 
.局部变量 m, 文本型, , , 

赋值 (进程信息1, 未知支持库函数_10 ())
赋值 (j, 取数组成员数 (进程信息1))
赋值 (., j)
赋值 (k, 1)
.计次循环首 (j, i)
     ' 跳过第一个ID为0的系统进程
    .如果真 (并且 (不等于 (进程信息1 [i], , 0), 不等于 (进程信息1 [i], , 4)))
        k.未知支持库函数_9 (0, #., 进程信息1 [i], )
        k.未知支持库函数_9 (1, #., 进程信息1 [i], )
        赋值 (m, 取进程路径 (进程信息1 [i], ))
        .如果真 (等于 (m, “”))
            赋值 (m, 取空白文本 (255))
            GetSystemDirectoryA (m, 255)
            赋值 (m, 相加 (m, “\”, 进程信息1 [i], ))
        .如果真结束
        k.未知支持库函数_9 (2, #., m)
        赋值 (k, 相加 (k, 1))
    .如果真结束
    
.计次循环尾 ()

.子程序 取进程路径, 文本型, , 
.参数 进程号, 整数型, , 

.局部变量 系统目录, 文本型, , , 
.局部变量 全路径名, 文本型, , , 
.局部变量 进程句柄, 整数型, , , 

赋值 (系统目录, 取空白文本 (255))
GetSystemDirectoryA (系统目录, 255)
赋值 (进程句柄, OpenProcess (1040, 0, 进程号))
赋值 (全路径名, 取空白文本 (255))
.如果真 (不等于 (GetModuleFileNameExA (进程句柄, 0, 全路径名, 255), 0))
    赋值 (全路径名, 子文本替换 (全路径名, “\??\”, “”, , , 真))
    .如果真 (等于 (到小写 (取文本左边 (全路径名, 12)), “\systemroot\”))
        输出调试文本 (到小写 (取文本左边 (全路径名, 12)))
        赋值 (全路径名, 子文本替换 (全路径名, “\systemroot\”, 系统目录, , , 假))
    .如果真结束
    返回 (全路径名)
.如果真结束
返回 (“”)



 ' 不属于任何一个程序集、类模块的函数：
