 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 0
    顶边 = 0
    宽度 = 1024
    高度 = 740
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\me的管理系统.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “超人宿舍管理系统 V1.0”
    帮助文件名 = “”

窗口 动态窗口
    左边 = 299
    顶边 = 209
    宽度 = 455
    高度 = 228
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 0
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\me的管理系统.e\动态窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 管理员登入窗口
    左边 = 299
    顶边 = 209
    宽度 = 455
    高度 = 228
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 0
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\me的管理系统.e\管理员登入窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 管理员设置窗口
    左边 = 247
    顶边 = 125
    宽度 = 668
    高度 = 447
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 14003526 '  0xD5AD46
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “管理员设置”
    帮助文件名 = “”

窗口 员工管理窗口
    左边 = 234
    顶边 = 150
    宽度 = 668
    高度 = 542
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 14003526 '  0xD5AD46
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “员工管理”
    帮助文件名 = “”

窗口 修改密码窗口
    左边 = 327
    顶边 = 190
    宽度 = 380
    高度 = 284
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 14003526 '  0xD5AD46
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “修改密码”
    帮助文件名 = “”

窗口 离校登记窗口
    左边 = 246
    顶边 = 187
    宽度 = 668
    高度 = 443
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 14003526 '  0xD5AD46
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “离校登记”
    帮助文件名 = “”

窗口 学生查找
    左边 = 127
    顶边 = 97
    宽度 = 891
    高度 = 620
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 14003526 '  0xD5AD46
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “学生查寻”
    帮助文件名 = “”

窗口 来访登记窗口
    左边 = 253
    顶边 = 151
    宽度 = 646
    高度 = 435
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 14003526 '  0xD5AD46
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “来访登记”
    帮助文件名 = “”

窗口 资料修改窗口
    左边 = 203
    顶边 = 150
    宽度 = 786
    高度 = 526
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 14003526 '  0xD5AD46
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “资料修改”
    帮助文件名 = “”

窗口 设置水电费标准
    左边 = 50
    顶边 = 50
    宽度 = 498
    高度 = 229
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 14003526 '  0xD5AD46
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “设置标准”
    帮助文件名 = “”

窗口 数据备份窗口
    左边 = 304
    顶边 = 272
    宽度 = 481
    高度 = 176
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 14003526 '  0xD5AD46
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “数据备份”
    帮助文件名 = “”

窗口 数据还原窗口
    左边 = 304
    顶边 = 272
    宽度 = 481
    高度 = 176
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 14003526 '  0xD5AD46
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “数据还原”
    帮助文件名 = “”

窗口 导航窗口
    左边 = 255
    顶边 = 150
    宽度 = 612
    高度 = 420
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “使用导航”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' ExtMenu 9909FBB013704cfa8FE7E739DB7172DE 1 6 超级菜单支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 2 5 扩展界面支持库三
 ' ELogoPanel {23A4E57BA5304de090D70C8962302C3B} 1 0 易Logo支持库
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库



 ' 所需要的模块
 ' 清除数组重复成员 E:\我的易模块\清除数组重复成员.ec
 ' 读易库到超级列表框 E:\我的易模块\读数据库到超级列表框.ec
 ' 分辨率模块 E:\E模块\分辨率.ec
 ' 快速树型框填充 E:\我的易模块\快速填充树型框.ec


.全局变量 当前管理员, 文本型, , , 
.全局变量 水费标准, 文本型, , , 
.全局变量 电费标准, 文本型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 文本数组, 文本型, , "10", 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 记录数, 整数型, , , 
.局部变量 记录数组, 文本型, , "2", 
.局部变量 数组个数, 整数型, , , 
.局部变量 不重复数组, 文本型, , "0", 
.局部变量 取分辨率, 文本型, , , 

赋值 (取分辨率, 当前分辨率 ())
.如果真 (不等于 (取文本左边 (取分辨率, 4), “1024”))
    信息框 (相加 (“软件检测到你的系统分辨率不是:1024×768,”, #换行符, “最好调整到:1024×768,以便本软件能最佳显示！！”), 相加 (0, 64, 0), “友情提示”)
.如果真结束
写配置项 (相加 (取运行目录 (), “\用户配置.ini”), “系统风格”, “风格值”, “1”)
未知支持库函数_0 (到数值 (读配置项 (相加 (取运行目录 (), “\用户配置.ini”), “系统风格”, “风格值”, )))
创建学生注册数据库 ()
填充各个树型框 ()
填充宿舍树型框 ()
赋值 (.现行子夹, 1)
赋值 (_启动窗口..高度, 623)
赋值 (_启动窗口..高度, 623)
赋值 (_启动窗口..高度, 623)
赋值 (_启动窗口..高度, 623)
赋值 (_启动窗口..高度, 623)
赋值 (_启动窗口..高度, 623)
创建员工列表框 ()
创建离校数据库 ()
创建水电费数据库 ()
创建公共财产维修数据库 ()
创建私有财产维修数据库 ()
创建来访人员登记数据库 ()
赋值 (水费标准, 到文本 (读配置项 (相加 (取运行目录 (), “\用户配置.ini”), “水电费标准”, “水费”, 到文本 (0.8))))
赋值 (电费标准, 到文本 (读配置项 (相加 (取运行目录 (), “\用户配置.ini”), “水电费标准”, “电费”, 到文本 (0.6))))
1.置文本 (相加 (“时间:”, 时间到文本 (取现行时间 (), 2), “  ”, 多项选择 (取星期几 (取现行时间 ()), “星期日”, “星期一”, “星期二”, “星期三”, “星期四”, “星期五”, “星期六”), “  ”, 到文本 (取小时 (取现行时间 ())), “时”, 到文本 (取分钟 (取现行时间 ())), “分”))
2.置文本 (相加 (“命令提示: 欢迎使用”, “超人宿舍管理系统V1.0  ”, “本软件由易语言所写,”, “版权归作者所有”, “  作者:戢振华 QQ:443674405”))
赋值 (.时钟周期, 1000)
载入 (动态窗口, _启动窗口, 真)


.子程序 创建公共财产维修数据库, 空白型, , 
.局部变量 公财字段, 字段信息, , "7", 

.如果真 (等于 (文件是否存在 (“公共财产维修数据库.edb”), 假))
    赋值 (公财字段 [1].名称, “栋号”)
    赋值 (公财字段 [1].类型, #文本型)
    赋值 (公财字段 [1].最大文本长度, 4)
    赋值 (公财字段 [2].名称, “房间号码”)
    赋值 (公财字段 [2].类型, #文本型)
    赋值 (公财字段 [2].最大文本长度, 8)
    赋值 (公财字段 [3].名称, “维修日期”)
    赋值 (公财字段 [3].类型, #文本型)
    赋值 (公财字段 [3].最大文本长度, 10)
    赋值 (公财字段 [4].名称, “维修物品”)
    赋值 (公财字段 [4].类型, #文本型)
    赋值 (公财字段 [4].最大文本长度, 50)
    赋值 (公财字段 [5].名称, “负责人”)
    赋值 (公财字段 [5].类型, #文本型)
    赋值 (公财字段 [5].最大文本长度, 8)
    赋值 (公财字段 [6].名称, “折算金额”)
    赋值 (公财字段 [6].类型, #文本型)
    赋值 (公财字段 [6].最大文本长度, 8)
    赋值 (公财字段 [7].名称, “是否赔偿”)
    赋值 (公财字段 [7].类型, #文本型)
    赋值 (公财字段 [7].最大文本长度, 2)
    .如果真 (创建 (“公共财产维修数据库.edb”, 公财字段))
        关闭 (相加 (取运行目录 (), “\公共财产维修数据库.edb”))
    .如果真结束
    
.如果真结束


.子程序 创建私有财产维修数据库, 空白型, , 
.局部变量 私财字段, 字段信息, , "7", 

.如果真 (等于 (文件是否存在 (“私有财产维修数据库.edb”), 假))
    赋值 (私财字段 [1].名称, “学号”)
    赋值 (私财字段 [1].类型, #文本型)
    赋值 (私财字段 [1].最大文本长度, 12)
    赋值 (私财字段 [2].名称, “姓名”)
    赋值 (私财字段 [2].类型, #文本型)
    赋值 (私财字段 [2].最大文本长度, 4)
    赋值 (私财字段 [3].名称, “维修日期”)
    赋值 (私财字段 [3].类型, #文本型)
    赋值 (私财字段 [3].最大文本长度, 10)
    赋值 (私财字段 [4].名称, “维修物品”)
    赋值 (私财字段 [4].类型, #文本型)
    赋值 (私财字段 [4].最大文本长度, 50)
    赋值 (私财字段 [5].名称, “年度”)
    赋值 (私财字段 [5].类型, #文本型)
    赋值 (私财字段 [5].最大文本长度, 10)
    赋值 (私财字段 [6].名称, “折算金额”)
    赋值 (私财字段 [6].类型, #文本型)
    赋值 (私财字段 [6].最大文本长度, 8)
    赋值 (私财字段 [7].名称, “是否赔偿”)
    赋值 (私财字段 [7].类型, #文本型)
    赋值 (私财字段 [7].最大文本长度, 2)
    .如果真 (创建 (“私有财产维修数据库.edb”, 私财字段))
        关闭 (相加 (取运行目录 (), “\私有财产维修数据库.edb”))
    .如果真结束
    
.如果真结束


.子程序 创建水电费数据库, 空白型, , 
.局部变量 水电费库, 字段信息, , "10", 

.如果真 (等于 (文件是否存在 (“水电费数据库.edb”), 假))
    赋值 (水电费库 [1].名称, “抄表日期”)
    赋值 (水电费库 [1].类型, #文本型)
    赋值 (水电费库 [1].最大文本长度, 15)
    赋值 (水电费库 [2].名称, “水表底数”)
    赋值 (水电费库 [2].类型, #文本型)
    赋值 (水电费库 [2].最大文本长度, 15)
    赋值 (水电费库 [3].名称, “水表现数”)
    赋值 (水电费库 [3].类型, #文本型)
    赋值 (水电费库 [3].最大文本长度, 15)
    赋值 (水电费库 [4].名称, “水费”)
    赋值 (水电费库 [4].类型, #文本型)
    赋值 (水电费库 [4].最大文本长度, 15)
    赋值 (水电费库 [5].名称, “电表底数”)
    赋值 (水电费库 [5].类型, #文本型)
    赋值 (水电费库 [5].最大文本长度, 15)
    赋值 (水电费库 [6].名称, “电表现数”)
    赋值 (水电费库 [6].类型, #文本型)
    赋值 (水电费库 [6].最大文本长度, 15)
    赋值 (水电费库 [7].名称, “电费”)
    赋值 (水电费库 [7].类型, #文本型)
    赋值 (水电费库 [7].最大文本长度, 15)
    赋值 (水电费库 [8].名称, “费用合计”)
    赋值 (水电费库 [8].类型, #文本型)
    赋值 (水电费库 [8].最大文本长度, 15)
    赋值 (水电费库 [9].名称, “栋号”)
    赋值 (水电费库 [9].类型, #文本型)
    赋值 (水电费库 [9].最大文本长度, 15)
    赋值 (水电费库 [10].名称, “房间号”)
    赋值 (水电费库 [10].类型, #文本型)
    赋值 (水电费库 [10].最大文本长度, 15)
    .如果真 (创建 (“水电费数据库.edb”, 水电费库))
        关闭 (相加 (取运行目录 (), “\水电费数据库.edb”))
    .如果真结束
    
.如果真结束


.子程序 填充宿舍树型框, 空白型, , 
.局部变量 填充数组8, 文本型, , "3", 

.如果 (等于 (是否已打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”)), 真))
    置当前库 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
    到首记录 ()
    赋值 (填充数组8 [1], “栋号”)
    赋值 (填充数组8 [2], “楼层号”)
    赋值 (填充数组8 [3], “宿舍号”)
    排序 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), 填充数组8, 真, , )
    快速填充树型框 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , _启动窗口., 填充数组8) ' 这里是填充树框的宿舍
    关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
.否则
    打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , , , , )
    赋值 (填充数组8 [1], “栋号”)
    赋值 (填充数组8 [2], “楼层号”)
    赋值 (填充数组8 [3], “宿舍号”)
    排序 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), 填充数组8, 真, , )
    快速填充树型框 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , _启动窗口., 填充数组8) ' 这里是填充树框的宿舍
    关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
.如果结束



.子程序 创建离校数据库, 空白型, , 
.局部变量 离校登记, 字段信息, , "9", 

.如果真 (等于 (文件是否存在 (“离校登记数据库.edb”), 假)) ' 判断是否要创建离校数据库
    赋值 (离校登记 [1].名称, “姓名”)
    赋值 (离校登记 [1].类型, #文本型)
    赋值 (离校登记 [1].最大文本长度, 8)
    赋值 (离校登记 [2].名称, “性别”)
    赋值 (离校登记 [2].类型, #文本型)
    赋值 (离校登记 [2].最大文本长度, 2)
    赋值 (离校登记 [3].名称, “值班人”)
    赋值 (离校登记 [3].类型, #文本型)
    赋值 (离校登记 [3].最大文本长度, 8)
    赋值 (离校登记 [4].名称, “员工号”)
    赋值 (离校登记 [4].最大文本长度, 8)
    赋值 (离校登记 [4].类型, #文本型)
    赋值 (离校登记 [5].名称, “学生学号”)
    赋值 (离校登记 [5].类型, #文本型)
    赋值 (离校登记 [5].最大文本长度, 15)
    赋值 (离校登记 [6].名称, “出楼货物”)
    赋值 (离校登记 [6].类型, #文本型)
    赋值 (离校登记 [6].最大文本长度, 50)
    赋值 (离校登记 [7].名称, “出楼时间”)
    赋值 (离校登记 [7].类型, #文本型)
    赋值 (离校登记 [7].最大文本长度, 15)
    赋值 (离校登记 [8].名称, “证件名称”)
    赋值 (离校登记 [8].类型, #文本型)
    赋值 (离校登记 [8].最大文本长度, 8)
    赋值 (离校登记 [9].名称, “备注”)
    赋值 (离校登记 [9].类型, #文本型)
    赋值 (离校登记 [9].最大文本长度, 256)
    .如果真 (创建 (“离校登记数据库.edb”, 离校登记))
        关闭 (相加 (取运行目录 (), “\离校登记数据库.edb”))
    .如果真结束
    
.如果真结束


.子程序 创建来访人员登记数据库, 空白型, , 
.局部变量 来访资料, 字段信息, , "8", 

.如果真 (等于 (文件是否存在 (“来访人员登记数据库.edb”), 假))
    赋值 (来访资料 [1].名称, “要访人姓名”)
    赋值 (来访资料 [1].类型, #文本型)
    赋值 (来访资料 [1].最大文本长度, 8)
    赋值 (来访资料 [2].名称, “所属关系”)
    赋值 (来访资料 [2].类型, #文本型)
    赋值 (来访资料 [2].最大文本长度, 10)
    赋值 (来访资料 [3].名称, “来访人姓名”)
    赋值 (来访资料 [3].类型, #文本型)
    赋值 (来访资料 [3].最大文本长度, 8)
    赋值 (来访资料 [4].名称, “来访时间”)
    赋值 (来访资料 [4].类型, #文本型)
    赋值 (来访资料 [4].最大文本长度, 15)
    赋值 (来访资料 [5].名称, “结束时间”)
    赋值 (来访资料 [5].类型, #文本型)
    赋值 (来访资料 [5].最大文本长度, 15)
    赋值 (来访资料 [6].名称, “值班人”)
    赋值 (来访资料 [6].类型, #文本型)
    赋值 (来访资料 [6].最大文本长度, 8)
    赋值 (来访资料 [7].名称, “证件名称”)
    赋值 (来访资料 [7].类型, #文本型)
    赋值 (来访资料 [7].最大文本长度, 8)
    赋值 (来访资料 [8].名称, “备注”)
    赋值 (来访资料 [8].类型, #文本型)
    赋值 (来访资料 [8].最大文本长度, 256)
    .如果真 (创建 (“来访人员登记数据库.edb”, 来访资料))
        关闭 (相加 (取运行目录 (), “\来访人员登记数据库.edb”))
    .如果真结束
    
.如果真结束


.子程序 创建宿舍数据库, 空白型, , 


.子程序 创建员工列表框, 空白型, , 
.局部变量 员工资料, 字段信息, , "9", 

.如果真 (等于 (文件是否存在 (“宿舍员工数据库.edb”), 假)) ' 创建宿舍员工数据库
    赋值 (员工资料 [1].名称, “员工号”)
    赋值 (员工资料 [1].类型, #文本型)
    赋值 (员工资料 [1].最大文本长度, 12)
    赋值 (员工资料 [2].名称, “姓名”)
    赋值 (员工资料 [2].类型, #文本型)
    赋值 (员工资料 [2].最大文本长度, 8)
    赋值 (员工资料 [3].名称, “性别”)
    赋值 (员工资料 [3].类型, #文本型)
    赋值 (员工资料 [3].最大文本长度, 2)
    赋值 (员工资料 [4].名称, “房号”)
    赋值 (员工资料 [4].类型, #文本型)
    赋值 (员工资料 [4].最大文本长度, 10)
    赋值 (员工资料 [5].名称, “楼层”)
    赋值 (员工资料 [5].类型, #文本型)
    赋值 (员工资料 [5].最大文本长度, 4)
    赋值 (员工资料 [6].名称, “职位”)
    赋值 (员工资料 [6].类型, #文本型)
    赋值 (员工资料 [6].最大文本长度, 8)
    赋值 (员工资料 [7].名称, “家庭住址”)
    赋值 (员工资料 [7].类型, #文本型)
    赋值 (员工资料 [7].最大文本长度, 40)
    赋值 (员工资料 [8].名称, “联系方式”)
    赋值 (员工资料 [8].类型, #文本型)
    赋值 (员工资料 [8].最大文本长度, 20)
    赋值 (员工资料 [9].名称, “备注”)
    赋值 (员工资料 [9].类型, #文本型)
    赋值 (员工资料 [9].最大文本长度, 512)
    .如果 (等于 (创建 (“宿舍员工数据库.edb”, 员工资料), 真))
        写 (“员工号”, “员工号”)
        写 (“姓名”, “姓名”)
        写 (“性别”, “性别”)
        写 (“房号”, “房号”)
        写 (“楼层”, “楼层”)
        写 (“职位”, “职位”)
        写 (“家庭住址”, “家庭住址”)
        写 (“联系方式”, “联系方式”)
        写 (“备注”, “备注”)
        关闭 (相加 (取运行目录 (), “\宿舍员工数据库.edb”))
    .否则
        信息框 (“初始化员工资料信息创建失败”, 0, )
    .如果结束
    关闭 (相加 (取运行目录 (), “\宿舍员工数据库.edb”))
.如果真结束


.子程序 填充各个树型框, 空白型, , 
.局部变量 填充, 文本型, , "4", 

.如果 (等于 (是否已打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”)), 真))
    赋值 (填充 [1], “年段”)
    赋值 (填充 [2], “专业”)
    赋值 (填充 [3], “班级”)
    赋值 (填充 [4], “姓名”)
    快速填充树型框 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , 填充) ' 这里是填充树框的班级子夹
    填充地址 ()
.否则
    打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , , , , )
    赋值 (填充 [1], “年段”)
    赋值 (填充 [2], “专业”)
    赋值 (填充 [3], “班级”)
    赋值 (填充 [4], “姓名”)
    快速填充树型框 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , 填充) ' 这里是填充树框的班级子夹
    填充地址 ()
.如果结束


.子程序 填充地址, 空白型, , 
.局部变量 填地址, 文本型, , "2", 

赋值 (填地址 [1], “地址”)
赋值 (填地址 [2], “姓名”)
到首记录 ()
快速填充树型框 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , 填地址)
填充楼层 ()


.子程序 填充楼层, 空白型, , 
.局部变量 填楼层, 文本型, , "4", 

赋值 (填楼层 [1], “栋号”)
赋值 (填楼层 [2], “楼层号”)
赋值 (填楼层 [3], “宿舍号”)
赋值 (填楼层 [4], “姓名”)
到首记录 ()
排序 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), 填楼层, 真, , )
快速填充树型框 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , _启动窗口., 填楼层)
关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))


.子程序 _工具条1_被下拉, 空白型, , 
.参数 按钮索引, 整数型, , 
.参数 下拉横座标, 整数型, , 
.参数 下拉纵座标, 整数型, , 

.如果真 (等于 (按钮索引, 18))
    弹出菜单 ()
.如果真结束


.子程序 _退出系统_被选择, 空白型, , 
_启动窗口.销毁 ()

.子程序 _计算器_被选择, 空白型, , 
运行 (“calc.exe”, 假, )


.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.判断开始 (等于 (按钮索引, 0))
    _注册登记_被选择 ()
.判断 (等于 (按钮索引, 1))
    _离校登记_被选择 ()
.判断 (等于 (按钮索引, 2))
    _修改资料_被选择 ()
.判断 (等于 (按钮索引, 3))
    _学生搜索_被选择 ()
.判断 (等于 (按钮索引, 5))
    _来访登记_被选择 ()
.判断 (等于 (按钮索引, 6))
    _来访修改_被选择 ()
.判断 (等于 (按钮索引, 7))
    _寝室管理_被选择 ()
.判断 (等于 (按钮索引, 9))
    _公财登记_被选择 ()
.判断 (等于 (按钮索引, 10))
    _维修登记_被选择 ()
.判断 (等于 (按钮索引, 11))
    _水电费统计_被选择 ()
.判断 (等于 (按钮索引, 16))
    _计算器_被选择 ()
.判断 (等于 (按钮索引, 17))
    _记事本_被选择 ()
.判断 (等于 (按钮索引, 21))
    结束 ()
.默认
    
.判断结束


.子程序 _记事本_被选择, 空白型, , 
运行 (“notepad.exe”, 假, )


.子程序 _画图板_被选择, 空白型, , 
运行 (“mspaint.exe”, 假, )


.子程序 _卷帘式菜单1_项目被选择, 空白型, , 
.参数 菜单索引, 整数型, , 
.参数 项目索引, 整数型, , 

.判断开始 (并且 (等于 (菜单索引, 0), 等于 (项目索引, 0)))
    _重新登入_被选择 ()
.判断 (并且 (等于 (菜单索引, 0), 等于 (项目索引, 1)))
    _管理员设置_被选择 ()
.判断 (并且 (等于 (菜单索引, 0), 等于 (项目索引, 2)))
    _员工管理_被选择 ()
.判断 (并且 (等于 (菜单索引, 0), 等于 (项目索引, 3)))
    _修改密码_被选择 ()
.判断 (并且 (等于 (菜单索引, 0), 等于 (项目索引, 4)))
    _系统数据备份_被选择 ()
.判断 (并且 (等于 (菜单索引, 0), 等于 (项目索引, 5)))
    _系统数据还原_被选择 ()
.判断 (并且 (等于 (菜单索引, 0), 等于 (项目索引, 6)))
    _退出系统_被选择 ()
.判断 (并且 (等于 (菜单索引, 1), 等于 (项目索引, 0)))
    _注册登记_被选择 ()
.判断 (并且 (等于 (菜单索引, 1), 等于 (项目索引, 1)))
    _离校登记_被选择 ()
.判断 (并且 (等于 (菜单索引, 1), 等于 (项目索引, 2)))
    _学生搜索_被选择 ()
.判断 (并且 (等于 (菜单索引, 1), 等于 (项目索引, 3)))
    _学生资料_被选择 ()
.判断 (并且 (等于 (菜单索引, 1), 等于 (项目索引, 4)))
    _修改资料_被选择 ()
.判断 (并且 (等于 (菜单索引, 2), 等于 (项目索引, 0)))
    _学生资料_被选择 ()
.判断 (并且 (等于 (菜单索引, 2), 等于 (项目索引, 1)))
    _来访登记_被选择 ()
.判断 (并且 (等于 (菜单索引, 2), 等于 (项目索引, 2)))
    _来访修改_被选择 ()
.判断 (并且 (等于 (菜单索引, 2), 等于 (项目索引, 3)))
    _学生离校修改_被选择 ()
.判断 (并且 (等于 (菜单索引, 2), 等于 (项目索引, 4)))
    _员工管理_被选择 ()
.判断 (并且 (等于 (菜单索引, 2), 等于 (项目索引, 5)))
    _管理员设置_被选择 ()
.判断 (并且 (等于 (菜单索引, 3), 等于 (项目索引, 0)))
    _宿舍评比_被选择 ()
.判断 (并且 (等于 (菜单索引, 4), 等于 (项目索引, 0)))
    _设置标准_被选择 ()
.判断 (并且 (等于 (菜单索引, 4), 等于 (项目索引, 1)))
    _水电费统计_被选择 ()
.判断 (并且 (等于 (菜单索引, 5), 等于 (项目索引, 0)))
    _公财登记_被选择 ()
.判断 (并且 (等于 (菜单索引, 5), 等于 (项目索引, 1)))
    _维修登记_被选择 ()
.判断 (并且 (等于 (菜单索引, 5), 等于 (项目索引, 2)))
    _公财登记_被选择 ()
.判断 (并且 (等于 (菜单索引, 5), 等于 (项目索引, 3)))
    _公财登记_被选择 ()
.判断 (并且 (等于 (菜单索引, 6), 等于 (项目索引, 0)))
    _计算器_被选择 ()
.判断 (并且 (等于 (菜单索引, 6), 等于 (项目索引, 1)))
    _记事本_被选择 ()
.判断 (并且 (等于 (菜单索引, 6), 等于 (项目索引, 2)))
    _画图板_被选择 ()
.判断 (并且 (等于 (菜单索引, 1), 等于 (项目索引, 5)))
    _察看离校记录_被选择 ()
.默认
    
.判断结束








.子程序 _时钟1_周期事件, 空白型, , 
 ' 下面是添加当前的时间到状态栏
1.置文本 (相加 (“时间:”, 时间到文本 (取现行时间 (), 2), “  ”, 多项选择 (取星期几 (取现行时间 ()), “星期日”, “星期一”, “星期二”, “星期三”, “星期四”, “星期五”, “星期六”), “  ”, 到文本 (取小时 (取现行时间 ())), “时”, 到文本 (取分钟 (取现行时间 ())), “分”))


.子程序 _超级菜单1_被点燃, 空白型, , 
.参数 被点燃的菜单项, 菜单, , 

 ' 以下是菜单上的状态栏提示

.判断开始 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<系统设置>>: 进行有关系统,登入,管理员,员工等帐户及密码的设置.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<重新登入>>: 重新登入本系统,即进行用户的切换操作.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<管理员设置>>: 进行添加或删除系统管理员.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<员工管理>>: 添加或删除宿舍的工作人员及对他们相关资料的录入,以便以员工进行管理.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<修改密码>>: 修改或删除管理员的密码.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<数据备份>>: 备份系统的数据以便日后查阅或者恢复之用.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<退出系统>>: 退出系统,结束本程序的运行.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<学生管理>>: 进行学生的一些与登记相关的管理操作.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<学生注册>>: 进行学生注册相关的管理.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<财产登记>>: 根据学生的需要对学生自己的财产进行相关的登记管理,以便日后的需要.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<离校管理>>: 办理学生的离校登记手序.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<查寻学生>>: 用各种方法查寻某个学生查看该学生的基本情况.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<按学号>>: 按学号查寻学生.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<按姓名>>: 按姓名查寻学生.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<按寝室>>: 按寝室查寻学生.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<按住址>>: 按住址查寻学生.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<按班级>>: 按班级查寻学生.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<资料修改>>: 对学生,管理员,员工,财产等资料根据需要进行必要的修改.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<基本资料修改>>: 对学生的基本资料进行修改操作.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<来访登记修改>>: 对来访的登记内容进行修改.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<学生离校修改>>: 对学生的离校登记内容进行修改.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<管理员修改>>: 对管理员进行修改.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<数据统计>>: 对宿舍评比,人数,寝室,寝室调整等内容进行统计.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<宿舍评比>>: 进行文明宿舍评比.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<人数统计>>: 对宿舍的人数进行统计.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<寝室统计>>: 对寝室进行统计.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<调房统计>>: 对调整的寝进行统计.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<费用管理>>: 对寝室的水电费进行相关的管理以及费用的标准进行设置.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<设置标准>>: 设置水电费的计算标准.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<水电费统计>>: 对水电进行统计.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<财产管理>>: 进行与宿舍公有和私有财产相关的管理和登记.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<公财登记>>: 对寝室的公共财产进行登记.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<维修登记>>: 对各个寝室的维修情况进行登记.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<公有查寻>>: 查寻公共财产情况.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<常用工具>>: 提示工作中要用到的一些常用工具.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<计算器>>: 打开Windows自带的计算器程序.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<记事本>>: 打开Windows自带的记事本程序.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<画图板>>: 打开Windows自带的画图板程序.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<编辑课程表>>: 编辑查看各个班级的课程表,了解各个班级的课程情况.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<智能评语录入>>: 提供系统内部自带的评语以便进行快速地进行评语录入.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<个性其它>>: 根据用户的需要进行个性的界面与背景音乐设置.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<界面风格>>: 调整系统的界面风格.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<背景音乐>>: 调整系统的背景音乐.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<背景音乐一>>: 设置系统的背景音乐为<<背景音乐一>>.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<背景音乐二>>: 设置系统的背景音乐为<<背景音乐二>>.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<背景音乐三>>: 设置系统的背景音乐为<<背景音乐三>>.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<无音乐>>: 设置系统没有背景音乐.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<界面风格一>>: 设置系统的界面风格为<<界面风格一>>.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<界面风格二>>: 设置系统的界面风格为<<界面风格二>>.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<界面风格三>>: 设置系统的界面风格为<<界面风格三>>.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<无风格>>: 设置系统不用任何的内置风格,使用无风格.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<帮助>>: 提供给初级用户一些帮助,以便能快速地掌握本软件的使用.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<关于>>: 查看关于本软件的一些信息.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<使用手册>>: 查看本软件使用的简单教程.”)
.判断 (等于 (被点燃的菜单项, ))
    2.置文本 (“命令提示 <<软件注册>>: 注册本软件.”)
.默认
    
.判断结束


.子程序 _图形按钮1_被单击, 空白型, , 
_启动窗口.销毁 ()


.子程序 _图形按钮1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

2.置文本 (“命令提示 <<退出>>: 退出系统,结束本程序的运行.”)



.子程序 _管理员设置_被选择, 空白型, , 
载入 (管理员设置窗口, , 假)
2.置文本 (“命令提示: <<管理员设置>>: 进行添加或删除系统管理员.”)


.子程序 _重新登入_被选择, 空白型, , 
载入 (管理员登入窗口, , 真)
2.置文本 (“命令提示: <<重新登入>>: 重新登入本系统,即进行用户的切换操作.”)


.子程序 _注册登记_被选择, 空白型, , 
.局部变量 学生注册, 字段信息, , "46", 

.如果真 (打开 (相加 (取运行目录 (), “\管理员.edb”), , , , , , ))
    查找 (等于 (读 (“用户名”), 当前管理员))
    .如果 (等于 (读 (“管理员类型”), “普通用户”))
        信息框 (“你没有权限进行学生的注册登记”, 相加 (0, 48, 0), “提示信息”)
        关闭 (相加 (取运行目录 (), “\管理员.edb”))
    .否则
        赋值 (_启动窗口..现行子夹, 1)
        关闭 (相加 (取运行目录 (), “\管理员.edb”))
    .如果结束
    
.如果真结束


.子程序 创建学生注册数据库, 空白型, , 
.局部变量 学生注册, 字段信息, , "46", 

.如果真 (等于 (文件是否存在 (“学生注册信息数据库.edb”), 假))
    赋值 (学生注册 [1].名称, “学号”)
    赋值 (学生注册 [1].类型, #文本型)
    赋值 (学生注册 [1].最大文本长度, 12)
    赋值 (学生注册 [2].名称, “姓名”)
    赋值 (学生注册 [2].类型, #文本型)
    赋值 (学生注册 [2].最大文本长度, 8)
    赋值 (学生注册 [3].名称, “性别”)
    赋值 (学生注册 [3].类型, #文本型)
    赋值 (学生注册 [3].最大文本长度, 2)
    赋值 (学生注册 [4].名称, “民族”)
    赋值 (学生注册 [4].类型, #文本型)
    赋值 (学生注册 [4].最大文本长度, 8)
    赋值 (学生注册 [5].名称, “年段”)
    赋值 (学生注册 [5].类型, #文本型)
    赋值 (学生注册 [5].最大文本长度, 8)
    赋值 (学生注册 [6].名称, “专业”)
    赋值 (学生注册 [6].类型, #文本型)
    赋值 (学生注册 [6].最大文本长度, 20)
    赋值 (学生注册 [7].名称, “班级”)
    赋值 (学生注册 [7].类型, #文本型)
    赋值 (学生注册 [7].最大文本长度, 4)
    赋值 (学生注册 [8].名称, “辅导员”)
    赋值 (学生注册 [8].类型, #文本型)
    赋值 (学生注册 [8].最大文本长度, 8)
    赋值 (学生注册 [9].名称, “栋号”)
    赋值 (学生注册 [9].类型, #文本型)
    赋值 (学生注册 [9].最大文本长度, 4)
    赋值 (学生注册 [10].名称, “楼层号”)
    赋值 (学生注册 [10].类型, #文本型)
    赋值 (学生注册 [10].最大文本长度, 4)
    赋值 (学生注册 [11].名称, “宿舍号”)
    赋值 (学生注册 [11].类型, #文本型)
    赋值 (学生注册 [11].最大文本长度, 4)
    赋值 (学生注册 [12].名称, “电话”)
    赋值 (学生注册 [12].类型, #文本型)
    赋值 (学生注册 [12].最大文本长度, 48)
    赋值 (学生注册 [13].名称, “地址”)
    赋值 (学生注册 [13].类型, #文本型)
    赋值 (学生注册 [13].最大文本长度, 40)
    赋值 (学生注册 [14].名称, “财产登记”)
    赋值 (学生注册 [14].类型, #文本型)
    赋值 (学生注册 [14].最大文本长度, 512)
    赋值 (学生注册 [15].名称, “备注”)
    赋值 (学生注册 [15].类型, #文本型)
    赋值 (学生注册 [15].最大文本长度, 512)
    赋值 (学生注册 [16].名称, “凳子号”)
    赋值 (学生注册 [16].类型, #文本型)
    赋值 (学生注册 [16].最大文本长度, 4)
    赋值 (学生注册 [17].名称, “桌子号”)
    赋值 (学生注册 [17].类型, #文本型)
    赋值 (学生注册 [17].最大文本长度, 4)
    赋值 (学生注册 [18].名称, “床位号”)
    赋值 (学生注册 [18].类型, #文本型)
    赋值 (学生注册 [18].最大文本长度, 4)
    赋值 (学生注册 [19].名称, “箱子”)
    赋值 (学生注册 [19].类型, #文本型)
    赋值 (学生注册 [19].最大文本长度, 6)
    赋值 (学生注册 [20].名称, “被子”)
    赋值 (学生注册 [20].类型, #文本型)
    赋值 (学生注册 [20].最大文本长度, 6)
    赋值 (学生注册 [21].名称, “钥匙发否”)
    赋值 (学生注册 [21].类型, #文本型)
    赋值 (学生注册 [21].最大文本长度, 4)
    赋值 (学生注册 [22].名称, “宿舍电话”)
    赋值 (学生注册 [22].类型, #文本型)
    赋值 (学生注册 [22].最大文本长度, 20)
    赋值 (学生注册 [23].名称, “卫生等级”)
    赋值 (学生注册 [23].类型, #文本型)
    赋值 (学生注册 [23].最大文本长度, 2)
    赋值 (学生注册 [24].名称, “第一学期”)
    赋值 (学生注册 [24].类型, #文本型)
    赋值 (学生注册 [24].最大文本长度, 256)
    赋值 (学生注册 [25].名称, “第二学期”)
    赋值 (学生注册 [25].类型, #文本型)
    赋值 (学生注册 [25].最大文本长度, 256)
    赋值 (学生注册 [26].名称, “第三学期”)
    赋值 (学生注册 [26].类型, #文本型)
    赋值 (学生注册 [26].最大文本长度, 256)
    赋值 (学生注册 [27].名称, “第四学期”)
    赋值 (学生注册 [27].类型, #文本型)
    赋值 (学生注册 [27].最大文本长度, 256)
    赋值 (学生注册 [28].名称, “第五学期”)
    赋值 (学生注册 [28].类型, #文本型)
    赋值 (学生注册 [28].最大文本长度, 256)
    赋值 (学生注册 [29].名称, “第六学期”)
    赋值 (学生注册 [29].类型, #文本型)
    赋值 (学生注册 [29].最大文本长度, 256)
    赋值 (学生注册 [30].名称, “抄表日期”)
    赋值 (学生注册 [30].类型, #文本型)
    赋值 (学生注册 [30].最大文本长度, 15)
    赋值 (学生注册 [31].名称, “水表底数”)
    赋值 (学生注册 [31].类型, #文本型)
    赋值 (学生注册 [31].最大文本长度, 4)
    赋值 (学生注册 [32].名称, “水表现数”)
    赋值 (学生注册 [32].类型, #文本型)
    赋值 (学生注册 [32].最大文本长度, 4)
    赋值 (学生注册 [33].名称, “水费”)
    赋值 (学生注册 [33].类型, #文本型)
    赋值 (学生注册 [33].最大文本长度, 4)
    赋值 (学生注册 [34].名称, “电表底数”)
    赋值 (学生注册 [34].类型, #文本型)
    赋值 (学生注册 [34].最大文本长度, 4)
    赋值 (学生注册 [35].名称, “电表现数”)
    赋值 (学生注册 [35].类型, #文本型)
    赋值 (学生注册 [35].最大文本长度, 10)
    赋值 (学生注册 [36].名称, “电费”)
    赋值 (学生注册 [36].类型, #文本型)
    赋值 (学生注册 [36].最大文本长度, 10)
    赋值 (学生注册 [37].名称, “费用合计”)
    赋值 (学生注册 [37].类型, #文本型)
    赋值 (学生注册 [37].最大文本长度, 10)
    赋值 (学生注册 [38].名称, “凳子数”)
    赋值 (学生注册 [38].类型, #文本型)
    赋值 (学生注册 [38].最大文本长度, 4)
    赋值 (学生注册 [39].名称, “桌子数”)
    赋值 (学生注册 [39].类型, #文本型)
    赋值 (学生注册 [39].最大文本长度, 4)
    赋值 (学生注册 [40].名称, “热水器数”)
    赋值 (学生注册 [40].类型, #文本型)
    赋值 (学生注册 [40].最大文本长度, 4)
    赋值 (学生注册 [41].名称, “电扇数”)
    赋值 (学生注册 [41].类型, #文本型)
    赋值 (学生注册 [41].最大文本长度, 4)
    赋值 (学生注册 [42].名称, “电灯数”)
    赋值 (学生注册 [42].类型, #文本型)
    赋值 (学生注册 [42].最大文本长度, 4)
    赋值 (学生注册 [43].名称, “垃圾筒数”)
    赋值 (学生注册 [43].类型, #文本型)
    赋值 (学生注册 [43].最大文本长度, 4)
    赋值 (学生注册 [44].名称, “宿舍备注”)
    赋值 (学生注册 [44].类型, #文本型)
    赋值 (学生注册 [44].最大文本长度, 256)
    赋值 (学生注册 [45].名称, “上次日期”)
    赋值 (学生注册 [45].类型, #文本型)
    赋值 (学生注册 [45].最大文本长度, 8)
    赋值 (学生注册 [46].名称, “电话数”)
    赋值 (学生注册 [46].类型, #文本型)
    赋值 (学生注册 [46].最大文本长度, 4)
    .如果 (等于 (创建 (“学生注册信息数据库.edb”, 学生注册), 真))
        关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
    .否则
        信息框 (“初始化学生注册信息创建失败”, 0, )
    .如果结束
    关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
.如果真结束


.子程序 _按钮2_被单击, 空白型, , 
.如果 (不等于 (.内容, “”))
    .如果 (等于 (信息框 (“你确定不保存此学生的信息吗?”, 相加 (4, 32, 256), ), #是钮))
        连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
        获取焦点 ()
        赋值 (_启动窗口..现行子夹, 0)
    .否则
        _按钮1_被单击 ()
        连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
        获取焦点 ()
        赋值 (_启动窗口..现行子夹, 0)
        载入 (导航窗口, , 假)
    .如果结束
    
.否则
    赋值 (_启动窗口..现行子夹, 0)
    
.如果结束


.子程序 写学生注册信息, 空白型, , 
.如果 (或者 (等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“请输学生的完整信息,如果没有请填  <<无>> ！”, 相加 (0, 48, 0), “友情提示”)
    获取焦点 ()
.否则
    加空记录 ()
    .如果 (并且 (等于 (写 (“学号”, .内容), 真), 等于 (写 (“姓名”, .内容), 真), 等于 (写 (“性别”, .内容), 真), 等于 (写 (“民族”, .内容), 真), 等于 (写 (“专业”, .内容), 真), 等于 (写 (“辅导员”, .内容), 真), 等于 (写 (“宿舍号”, .内容), 真), 等于 (写 (“电话”, .内容), 真), 等于 (写 (“地址”, .内容), 真), 等于 (写 (“财产登记”, .内容), 真), 等于 (写 (“备注”, .内容), 真)))
        .如果真 (不等于 (取文本右边 (.内容, 2), “级”))
            写 (“年段”, 相加 (.内容, “级”))
        .如果真结束
        写 (“年段”, .内容)
        .如果真 (不等于 (取文本右边 (.内容, 2), “班”))
            写 (“年段”, 相加 (.内容, “班”))
        .如果真结束
        写 (“班级”, .内容)
        .如果真 (不等于 (取文本右边 (.内容, 2), “栋”))
            写 (“栋号”, 相加 (.内容, “栋”))
        .如果真结束
        写 (“栋号”, .内容)
        .如果真 (不等于 (取文本右边 (.内容, 2), “楼”))
            写 (“楼层号”, 相加 (.内容, “楼”))
        .如果真结束
        写 (“楼层号”, .内容)
        填充各个树型框 ()
        连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
        获取焦点 ()
        信息框 (“此学生的注册信息添加成功,！！”, 相加 (0, 48, 0), “提示信息”)
        关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
    .否则
        信息框 (“系统出错,添加学生记录错误！！！”, 相加 (0, 16, 0), “系统出错！”)
        .如果真 (是否已打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”)))
            关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
        .如果真结束
        
    .如果结束
    .如果真 (是否已打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”)))
        关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
    .如果真结束
    
.如果结束
.如果真 (是否已打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”)))
    关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
.如果真结束



.子程序 _按钮1_被单击, 空白型, , 
.如果 (等于 (是否已打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”)), 假))
    打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , , , , )
    写学生注册信息 ()
.否则
    置当前库 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
    写学生注册信息 ()
    
.如果结束


.子程序 _员工管理_被选择, 空白型, , 
打开 (相加 (取运行目录 (), “\管理员.edb”), , , , , , )
查找 (等于 (读 (“用户名”), 当前管理员))
.如果 (等于 (读 (“管理员类型”), “普通用户”))
    信息框 (“你没有权限进行员工管理的设置”, 相加 (0, 48, 0), “提示信息”)
    关闭 (相加 (取运行目录 (), “\管理员.edb”))
.否则
    关闭 (相加 (取运行目录 (), “\管理员.edb”))
    载入 (员工管理窗口, , 假)
    .如果真 (等于 (文件是否存在 (相加 (取运行目录 (), “\宿舍员工数据库.edb”)), 真))
        打开 (相加 (取运行目录 (), “\宿舍员工数据库.edb”), , , , , , )
        赋值 (员工管理窗口..数据库文件名, 相加 (取运行目录 (), “\宿舍员工数据库.edb”))
    .如果真结束
    
.如果结束


.子程序 _修改密码_被选择, 空白型, , 
载入 (修改密码窗口, , 真)


.子程序 _树型框2_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

.如果真 (打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , , , , ))
    .如果真 (并且 (等于 (.现行子夹, 1), 等于 (.是否有子项目 (.最大化按钮), 假))) ' 下面是班级子夹的树型框
        查找 (等于 (.取项目文本 (.最大化按钮), 读 (“姓名”)))
        赋值 (.标题, 读 (“学号”))
        刷新显示 ()
        赋值 (.标题, 读 (“姓名”))
        刷新显示 ()
        赋值 (.标题, 读 (“性别”))
        刷新显示 ()
        赋值 (.标题, 读 (“民族”))
        刷新显示 ()
        赋值 (.标题, 读 (“年段”))
        刷新显示 ()
        赋值 (.标题, 读 (“专业”))
        刷新显示 ()
        赋值 (.标题, 读 (“班级”))
        刷新显示 ()
        赋值 (.标题, 读 (“辅导员”))
        刷新显示 ()
        赋值 (.标题, 读 (“栋号”))
        刷新显示 ()
        赋值 (.标题, 读 (“楼层号”))
        刷新显示 ()
        赋值 (.标题, 读 (“宿舍号”))
        刷新显示 ()
        赋值 (.标题, 读 (“电话”))
        刷新显示 ()
        赋值 (.标题, 读 (“地址”))
        刷新显示 ()
        赋值 (.内容, 读 (“财产登记”))
        刷新显示 ()
        赋值 (.内容, 读 (“备注”))
        刷新显示 ()
        到首记录 ()
    .如果真结束
    关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
.如果真结束


.子程序 _树型框1_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

.如果真 (打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , , , , ))
    .如果真 (并且 (等于 (.现行子夹, 0), 等于 (.是否有子项目 (.最大化按钮), 假))) ' 下面是班级子夹的树型框
        查找 (等于 (.取项目文本 (.最大化按钮), 读 (“姓名”)))
        赋值 (.标题, 读 (“学号”))
        刷新显示 ()
        赋值 (.标题, 读 (“姓名”))
        刷新显示 ()
        赋值 (.标题, 读 (“性别”))
        刷新显示 ()
        赋值 (.标题, 读 (“民族”))
        刷新显示 ()
        赋值 (.标题, 读 (“年段”))
        刷新显示 ()
        赋值 (.标题, 读 (“专业”))
        刷新显示 ()
        赋值 (.标题, 读 (“班级”))
        刷新显示 ()
        赋值 (.标题, 读 (“辅导员”))
        刷新显示 ()
        赋值 (.标题, 读 (“栋号”))
        刷新显示 ()
        赋值 (.标题, 读 (“楼层号”))
        刷新显示 ()
        赋值 (.标题, 读 (“宿舍号”))
        刷新显示 ()
        赋值 (.标题, 读 (“电话”))
        刷新显示 ()
        赋值 (.标题, 读 (“地址”))
        刷新显示 ()
        赋值 (.内容, 读 (“财产登记”))
        刷新显示 ()
        赋值 (.内容, 读 (“备注”))
        刷新显示 ()
        到首记录 ()
    .如果真结束
    关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
.如果真结束


.子程序 _树型框3_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

.如果真 (打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , , , , ))
    .如果真 (并且 (等于 (.现行子夹, 2), 等于 (.是否有子项目 (.最大化按钮), 假))) ' 下面是班级子夹的树型框
        查找 (等于 (.取项目文本 (.最大化按钮), 读 (“姓名”)))
        赋值 (.标题, 读 (“学号”))
        刷新显示 ()
        赋值 (.标题, 读 (“姓名”))
        刷新显示 ()
        赋值 (.标题, 读 (“性别”))
        刷新显示 ()
        赋值 (.标题, 读 (“民族”))
        刷新显示 ()
        赋值 (.标题, 读 (“年段”))
        刷新显示 ()
        赋值 (.标题, 读 (“专业”))
        刷新显示 ()
        赋值 (.标题, 读 (“班级”))
        刷新显示 ()
        赋值 (.标题, 读 (“辅导员”))
        刷新显示 ()
        赋值 (.标题, 读 (“栋号”))
        刷新显示 ()
        赋值 (.标题, 读 (“楼层号”))
        刷新显示 ()
        赋值 (.标题, 读 (“宿舍号”))
        刷新显示 ()
        赋值 (.标题, 读 (“电话”))
        刷新显示 ()
        赋值 (.标题, 读 (“地址”))
        刷新显示 ()
        赋值 (.内容, 读 (“财产登记”))
        刷新显示 ()
        赋值 (.内容, 读 (“备注”))
        刷新显示 ()
        到首记录 ()
    .如果真结束
    关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
.如果真结束



.子程序 _按钮5_被单击, 空白型, , 
.如果真 (打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , , , , ))
    .如果 (等于 (查找 (等于 (读 (“学号”), .内容)), 真))
        赋值 (.标题, 读 (“学号”))
        刷新显示 ()
        赋值 (.标题, 读 (“姓名”))
        刷新显示 ()
        赋值 (.标题, 读 (“性别”))
        刷新显示 ()
        赋值 (.标题, 读 (“民族”))
        刷新显示 ()
        赋值 (.标题, 读 (“年段”))
        刷新显示 ()
        赋值 (.标题, 读 (“专业”))
        刷新显示 ()
        赋值 (.标题, 读 (“班级”))
        刷新显示 ()
        赋值 (.标题, 读 (“辅导员”))
        刷新显示 ()
        赋值 (.标题, 读 (“栋号”))
        刷新显示 ()
        赋值 (.标题, 读 (“楼层号”))
        刷新显示 ()
        赋值 (.标题, 读 (“宿舍号”))
        刷新显示 ()
        赋值 (.标题, 读 (“电话”))
        刷新显示 ()
        赋值 (.标题, 读 (“地址”))
        刷新显示 ()
        赋值 (.内容, 读 (“财产登记”))
        刷新显示 ()
        赋值 (.内容, 读 (“备注”))
        刷新显示 ()
        到首记录 ()
    .否则
        信息框 (相加 (“没有学号为: ”, .内容, “ 的学生   ”), 相加 (0, 48, 0), “提示信息”)
        赋值 (.内容, “”)
    .如果结束
    关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
.如果真结束


.子程序 _按钮6_被单击, 空白型, , 
.如果真 (打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , , , , ))
    .如果 (等于 (查找 (等于 (读 (“姓名”), .内容)), 真))
        赋值 (.标题, 读 (“学号”))
        刷新显示 ()
        赋值 (.标题, 读 (“姓名”))
        刷新显示 ()
        赋值 (.标题, 读 (“性别”))
        刷新显示 ()
        赋值 (.标题, 读 (“民族”))
        刷新显示 ()
        赋值 (.标题, 读 (“年段”))
        刷新显示 ()
        赋值 (.标题, 读 (“专业”))
        刷新显示 ()
        赋值 (.标题, 读 (“班级”))
        刷新显示 ()
        赋值 (.标题, 读 (“辅导员”))
        刷新显示 ()
        赋值 (.标题, 读 (“栋号”))
        刷新显示 ()
        赋值 (.标题, 读 (“楼层号”))
        刷新显示 ()
        赋值 (.标题, 读 (“宿舍号”))
        刷新显示 ()
        赋值 (.标题, 读 (“电话”))
        刷新显示 ()
        赋值 (.标题, 读 (“地址”))
        刷新显示 ()
        赋值 (.内容, 读 (“财产登记”))
        刷新显示 ()
        赋值 (.内容, 读 (“备注”))
        刷新显示 ()
        到首记录 ()
    .否则
        信息框 (相加 (“没有姓名为: ”, .内容, “ 的学生   ”), 相加 (0, 48, 0), “提示信息”)
        赋值 (.内容, “”)
    .如果结束
    关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
.如果真结束


.子程序 _离校登记_被选择, 空白型, , 
.如果真 (打开 (相加 (取运行目录 (), “\管理员.edb”), , , , , , ))
    查找 (等于 (读 (“用户名”), 当前管理员))
    .如果 (等于 (读 (“管理员类型”), “普通用户”))
        信息框 (“你没有权限进行学生的离校登记”, 相加 (0, 48, 0), “提示信息”)
        关闭 (相加 (取运行目录 (), “\管理员.edb”))
    .否则
        载入 (离校登记窗口, , 假)
        关闭 (相加 (取运行目录 (), “\管理员.edb”))
    .如果结束
    
.如果真结束


.子程序 _按钮7_被单击, 空白型, , 
到首记录 ()


.子程序 _按钮9_被单击, 空白型, , 
到尾记录 ()


.子程序 _按钮12_被单击, 空白型, , 
.如果 (等于 (是否已打开 (相加 (取运行目录 (), “\离校登记数据库.edb”)), 真))
    关闭 (相加 (取运行目录 (), “\离校登记数据库.edb”))
    赋值 (_启动窗口..现行子夹, 0)
.否则
    赋值 (_启动窗口..现行子夹, 0)
.如果结束


.子程序 _按钮10_被单击, 空白型, , 
.添加行 ()


.子程序 _按钮11_被单击, 空白型, , 
取光标行号 ().删除行 (取选择行数 ())


.子程序 _按学号_被选择, 空白型, , 
载入 (学生查找, , 假)
赋值 (学生查找..现行子夹, 0)
学生查找.获取焦点 (.)


.子程序 _按姓名_被选择, 空白型, , 
载入 (学生查找, , 假)
赋值 (学生查找..现行子夹, 1)
学生查找.获取焦点 (.)


.子程序 _按寝室_被选择, 空白型, , 
载入 (学生查找, , 假)
赋值 (学生查找..现行子夹, 2)
学生查找.获取焦点 (.)


.子程序 _按住址_被选择, 空白型, , 
载入 (学生查找, , 假)
赋值 (学生查找..现行子夹, 3)
学生查找.获取焦点 (.)


.子程序 _按班级_被选择, 空白型, , 
载入 (学生查找, , 假)
赋值 (学生查找..现行子夹, 4)
学生查找.获取焦点 (.)


.子程序 _宿舍树型框_项目被选择, 空白型, , 
.参数 选择方式, 整数型, , 

.局部变量 宿舍成员, 文本型, , "10", 
.局部变量 成员个数, 整数型, , , 
.局部变量 成员个数2, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 次数, 整数型, , , 
.局部变量 索引号, 整数型, , , 

赋值 (记录数, 0)
.如果 (等于 (打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , , , , ), 真))
    赋值 (成员个数, 1)
    .如果真 (等于 (.是否有子项目 (.最大化按钮), 假))
        _启动窗口.全部删除 (.)
        .判断循环首 (等于 (查找 (并且 (等于 (_启动窗口.取项目文本 (., .取父项目 (.最大化按钮).取父项目 ()), 读 (“栋号”)), 等于 (_启动窗口.取项目文本 (., .取父项目 (.最大化按钮)), 读 (“楼层号”)), 等于 (_启动窗口.取项目文本 (., .最大化按钮), 读 (“宿舍号”)))), 真))
            赋值 (宿舍成员 [成员个数], 读 (“学号”))
            赋值 (成员个数, 相加 (成员个数, 1))
            跳过 ()
        .判断循环尾 ()
        清除数组 (文本数组)
        赋值 (文本数组, 分割文本 (清除数组重复成员 (宿舍成员, “o”), “o”, ))
        赋值 (成员个数2, 取数组成员数 (文本数组))
        .判断循环首 (小于 (记录数, 成员个数2))
            到首记录 ()
            查找 (等于 (读 (“学号”), 文本数组 [相加 (记录数, 1)]))
            赋值 (次数, _启动窗口.插入表项 (., , 读 (“年段”), , , , ))
            _启动窗口.置标题 (., 次数, 1, 读 (“专业”))
            _启动窗口.置标题 (., 次数, 2, 读 (“班级”))
            _启动窗口.置标题 (., 次数, 3, 读 (“姓名”))
            _启动窗口.置标题 (., 次数, 4, 读 (“学号”))
            _启动窗口.置标题 (., 次数, 5, 读 (“电话”))
            _启动窗口.置标题 (., 次数, 6, 读 (“备注”))
            赋值 (记录数, 相加 (记录数, 1))
        .判断循环尾 ()
        赋值 (_启动窗口..内容, 读 (“电话”))
        _启动窗口.刷新显示 (.)
        赋值 (_启动窗口..内容, _启动窗口.取项目文本 (., .取父项目 (.最大化按钮).取父项目 ()))
        _启动窗口.刷新显示 (.)
        赋值 (_启动窗口..内容, _启动窗口.取项目文本 (., .取父项目 (.最大化按钮)))
        _启动窗口.刷新显示 (.)
        赋值 (_启动窗口..内容, _启动窗口.取项目文本 (., .最大化按钮))
        _启动窗口.刷新显示 (.)
        到首记录 ()
        查找 (等于 (读 (“学号”), 文本数组 [1]))
        赋值 (_启动窗口..内容, 读 (“卫生等级”))
        赋值 (.内容, 读 (“第一学期”))
        赋值 (.内容, 读 (“第二学期”))
        赋值 (.内容, 读 (“第三学期”))
        赋值 (.内容, 读 (“第四学期”))
        赋值 (.内容, 读 (“第五学期”))
        赋值 (.内容, 读 (“第六学期”))
    .如果真结束
    .如果真 (等于 (_启动窗口..现行子夹, 1))
        赋值 (记录数, 0)
        赋值 (成员个数, 1)
        .如果真 (等于 (.是否有子项目 (.最大化按钮), 假))
            _启动窗口.全部删除 (.)
            .判断循环首 (等于 (查找 (并且 (等于 (_启动窗口.取项目文本 (., .取父项目 (.最大化按钮).取父项目 ()), 读 (“栋号”)), 等于 (_启动窗口.取项目文本 (., .取父项目 (.最大化按钮)), 读 (“楼层号”)), 等于 (_启动窗口.取项目文本 (., .最大化按钮), 读 (“宿舍号”)))), 真))
                赋值 (宿舍成员 [成员个数], 读 (“学号”))
                赋值 (成员个数, 相加 (成员个数, 1))
                跳过 ()
            .判断循环尾 ()
            清除数组 (文本数组)
            赋值 (文本数组, 分割文本 (清除数组重复成员 (宿舍成员, “o”), “o”, ))
            赋值 (成员个数2, 取数组成员数 (文本数组))
            .判断循环首 (小于 (记录数, 成员个数2))
                到首记录 ()
                查找 (等于 (读 (“学号”), 文本数组 [相加 (记录数, 1)]))
                -1.插入表项 (读 (“姓名”), 0, , , )
                赋值 (记录数, 相加 (记录数, 1))
            .判断循环尾 ()
            
        .如果真结束
        到首记录 ()
        查找 (等于 (读 (“学号”), 文本数组 [1]))
        赋值 (.内容, 相加 (.取父项目 (.最大化按钮).取父项目 ().取项目文本 (), .取父项目 (.最大化按钮).取项目文本 (), .取项目文本 (.最大化按钮)))
        赋值 (.内容, 读 (“凳子数”))
        赋值 (.内容, 读 (“桌子数”))
        赋值 (.内容, 读 (“电话数”))
        赋值 (.内容, 读 (“热水器数”))
        赋值 (.内容, 读 (“电扇数”))
        赋值 (.内容, 读 (“电灯数”))
        赋值 (.内容, 读 (“垃圾筒数”))
        赋值 (.内容, 读 (“宿舍备注”))
    .如果真结束
    .如果真 (等于 (_启动窗口..现行子夹, 2))
        赋值 (记录数, 0)
        赋值 (成员个数, 1)
        .如果真 (等于 (.是否有子项目 (.最大化按钮), 假))
            到首记录 ()
            .判断循环首 (等于 (查找 (并且 (等于 (_启动窗口.取项目文本 (., .取父项目 (.最大化按钮).取父项目 ()), 读 (“栋号”)), 等于 (_启动窗口.取项目文本 (., .取父项目 (.最大化按钮)), 读 (“楼层号”)), 等于 (_启动窗口.取项目文本 (., .最大化按钮), 读 (“宿舍号”)))), 真))
                赋值 (宿舍成员 [成员个数], 读 (“学号”))
                赋值 (成员个数, 相加 (成员个数, 1))
                跳过 ()
            .判断循环尾 ()
            清除数组 (文本数组)
            赋值 (文本数组, 分割文本 (清除数组重复成员 (宿舍成员, “o”), “o”, ))
            赋值 (成员个数2, 取数组成员数 (文本数组))
            到首记录 ()
            查找 (等于 (读 (“学号”), 文本数组 [1]))
            赋值 (.内容, 读 (“栋号”))
            赋值 (.内容, 相加 (取文本左边 (读 (“楼层号”), 相减 (取文本长度 (读 (“楼层号”)), 2)), 读 (“宿舍号”)))
            .如果真 (打开 (相加 (取运行目录 (), “\水电费数据库.edb”), , , , , , ))
                赋值 (记录数, 0)
                全部删除 ()
                .判断循环首 (小于 (记录数, 取记录数 ()))
                    赋值 (索引号, -1.插入表项 (读 (“栋号”), , , , ))
                    索引号.置标题 (1, 读 (“房间号”))
                    索引号.置标题 (2, 读 (“抄表日期”))
                    索引号.置标题 (3, 读 (“水表底数”))
                    索引号.置标题 (4, 读 (“水表现数”))
                    索引号.置标题 (5, 读 (“水费”))
                    索引号.置标题 (6, 读 (“电表底数”))
                    索引号.置标题 (7, 读 (“电表现数”))
                    索引号.置标题 (8, 读 (“电费”))
                    索引号.置标题 (9, 读 (“费用合计”))
                    跳过 ()
                    赋值 (记录数, 相加 (记录数, 1))
                .判断循环尾 ()
                置当前库 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
                到首记录 ()
                查找 (等于 (读 (“学号”), 文本数组 [1]))
                赋值 (索引号, -1.插入表项 (读 (“栋号”), , , , ))
                索引号.置标题 (1, 相加 (取文本左边 (读 (“楼层号”), 相减 (取文本长度 (读 (“楼层号”)), 2)), 读 (“宿舍号”)))
                索引号.置标题 (2, 读 (“抄表日期”))
                索引号.置标题 (3, 读 (“水表底数”))
                索引号.置标题 (4, 读 (“水表现数”))
                索引号.置标题 (5, 读 (“水费”))
                索引号.置标题 (6, 读 (“电表底数”))
                索引号.置标题 (7, 读 (“电表现数”))
                索引号.置标题 (8, 读 (“电费”))
                索引号.置标题 (9, 读 (“费用合计”))
                关闭 (相加 (取运行目录 (), “\水电费数据库.edb”))
            .如果真结束
            
        .如果真结束
        
    .如果真结束
    关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
.否则
    信息框 (“打开数据库失败!!”, 0, )
    
.如果结束


.子程序 _宿舍成员列表框_当前表项被改变, 空白型, , 
.如果真 (打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , , , , ))
    查找 (等于 (读 (“姓名”), .取标题 (., )))
    赋值 (.内容, 读 (“学号”))
    赋值 (.内容, 读 (“姓名”))
    赋值 (.内容, 相加 (取文本左边 (读 (“栋号”), 相减 (取文本长度 (读 (“栋号”)), 2)), 取文本左边 (读 (“楼层号”), 相减 (取文本长度 (读 (“楼层号”)), 2)), 读 (“宿舍号”)))
    赋值 (.内容, 读 (“凳子号”))
    赋值 (.内容, 读 (“桌子号”))
    赋值 (.内容, 读 (“床位号”))
    赋值 (.内容, 读 (“箱子”))
    赋值 (.内容, 读 (“被子”))
    赋值 (.内容, 读 (“钥匙发否”))
    赋值 (.内容, 读 (“备注”))
    赋值 (.内容, 读 (“电话”))
    关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
.如果真结束


.子程序 _按钮14_被单击, 空白型, , 
.局部变量 小宿舍成员, 文本型, , "10", 
.局部变量 小成员个数, 整数型, , , 
.局部变量 小文本数组, 文本型, , "0", 
.局部变量 小成员个数2, 整数型, , , 
.局部变量 次数, 整数型, , , 

赋值 (小成员个数, 1)
.如果真 (打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , , , , ))
    查找 (等于 (读 (“姓名”), .取标题 (., )))
    替换 (“学号”, .内容)
    替换 (“姓名”, .内容)
    替换 (“栋号”, 相加 (取文本左边 (.内容, 1), “栋”))
    替换 (“楼层号”, 相加 (取文本中间 (.内容, 2, 1), “楼”))
    替换 (“宿舍号”, 取文本右边 (.内容, 相减 (取文本长度 (.内容), 2)))
    替换 (“凳子号”, .内容)
    替换 (“桌子号”, .内容)
    替换 (“床位号”, .内容)
    替换 (“箱子”, .内容)
    替换 (“被子”, .内容)
    替换 (“钥匙发否”, .内容)
    到首记录 ()
    .判断循环首 (等于 (查找 (并且 (等于 (_启动窗口.取项目文本 (., .取父项目 (.最大化按钮).取父项目 ()), 读 (“栋号”)), 等于 (_启动窗口.取项目文本 (., .取父项目 (.最大化按钮)), 读 (“楼层号”)), 等于 (_启动窗口.取项目文本 (., .最大化按钮), 读 (“宿舍号”)))), 真))
        赋值 (小宿舍成员 [小成员个数], 读 (“学号”))
        赋值 (小成员个数, 相加 (小成员个数, 1))
        跳过 ()
    .判断循环尾 ()
    赋值 (小文本数组, 分割文本 (清除数组重复成员 (小宿舍成员, “o”), “o”, ))
    赋值 (小成员个数2, 取数组成员数 (小文本数组))
    .判断循环首 (小于 (次数, 小成员个数2))
        到首记录 ()
        查找 (等于 (读 (“学号”), 小文本数组 [相加 (次数, 1)]))
        替换 (“凳子数”, .内容)
        替换 (“桌子数”, .内容)
        替换 (“电话数”, .内容)
        替换 (“热水器数”, .内容)
        替换 (“电扇数”, .内容)
        替换 (“电灯数”, .内容)
        替换 (“垃圾筒数”, .内容)
        替换 (“宿舍备注”, .内容)
        赋值 (次数, 相加 (次数, 1))
    .判断循环尾 ()
    关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
.如果真结束


.子程序 _按钮13_被单击, 空白型, , 
.局部变量 小宿舍成员, 文本型, , "10", 
.局部变量 小成员个数, 整数型, , , 
.局部变量 小成员个数2, 整数型, , , 
.局部变量 小文本数组, 文本型, , "0", 
.局部变量 传递数组, 文本型, , "10", 
.局部变量 索引, 整数型, , , 
.局部变量 水费, 文本型, , , 
.局部变量 电费, 文本型, , , 
.局部变量 费用合计, 文本型, , , 
.局部变量 水表底数, 文本型, , , 
.局部变量 水表现数, 文本型, , , 
.局部变量 电表底数, 文本型, , , 
.局部变量 电表现数, 文本型, , , 
.局部变量 栋号, 文本型, , , 
.局部变量 房间号, 文本型, , , 
.局部变量 抄表日期, 文本型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 次数, 整数型, , , 

赋值 (小成员个数, 1)
.如果 (等于 (打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , , , , ), 真))
    .判断循环首 (等于 (查找 (并且 (等于 (_启动窗口.取项目文本 (., .取父项目 (.最大化按钮).取父项目 ()), 读 (“栋号”)), 等于 (_启动窗口.取项目文本 (., .取父项目 (.最大化按钮)), 读 (“楼层号”)), 等于 (_启动窗口.取项目文本 (., .最大化按钮), 读 (“宿舍号”)))), 真))
        赋值 (小宿舍成员 [小成员个数], 读 (“学号”))
        赋值 (小成员个数, 相加 (小成员个数, 1))
        跳过 ()
    .判断循环尾 ()
    赋值 (小文本数组, 分割文本 (清除数组重复成员 (小宿舍成员, “o”), “o”, ))
    赋值 (小成员个数2, 取数组成员数 (小文本数组))
    到首记录 ()
    查找 (等于 (读 (“学号”), 小文本数组 [1]))
    赋值 (传递数组 [1], 读 (“栋号”))
    赋值 (传递数组 [2], 相加 (取文本左边 (读 (“楼层号”), 相减 (取文本长度 (读 (“楼层号”)), 2)), 读 (“宿舍号”)))
    赋值 (传递数组 [3], 读 (“抄表日期”))
    赋值 (传递数组 [4], 读 (“水表底数”))
    赋值 (传递数组 [5], 读 (“水表现数”))
    赋值 (传递数组 [6], 读 (“水费”))
    赋值 (传递数组 [7], 读 (“电表底数”))
    赋值 (传递数组 [8], 读 (“电表现数”))
    赋值 (传递数组 [9], 读 (“电费”))
    赋值 (传递数组 [10], 读 (“费用合计”))
    .如果 (等于 (打开 (相加 (取运行目录 (), “\水电费数据库.edb”), , , , , , ), 真))
        加空记录 ()
        写 (“栋号”, 传递数组 [1])
        写 (“房间号”, 传递数组 [2])
        写 (“抄表日期”, 传递数组 [3])
        写 (“水表底数”, 传递数组 [4])
        写 (“水表现数”, 传递数组 [5])
        写 (“水费”, 传递数组 [6])
        写 (“电表底数”, 传递数组 [7])
        写 (“电表现数”, 传递数组 [8])
        写 (“电费”, 传递数组 [9])
        写 (“费用合计”, 传递数组 [10])
        关闭 (相加 (取运行目录 (), “\水电费数据库.edb”))
    .否则
        信息框 (“打开水电费数据库失败”, 0, )
    .如果结束
    置当前库 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
    赋值 (水表底数, 传递数组 [5])
    赋值 (水表现数, .内容)
    赋值 (水费, 到文本 (相乘 (到数值 (水费标准), 相减 (到数值 (水表现数), 到数值 (水表底数)))))
    赋值 (电表底数, 传递数组 [8])
    赋值 (电表现数, .内容)
    赋值 (电费, 到文本 (相乘 (到数值 (电费标准), 相减 (到数值 (电表现数), 到数值 (电表底数)))))
    赋值 (费用合计, 到文本 (相加 (到数值 (水费), 到数值 (电费))))
    赋值 (栋号, .内容)
    赋值 (房间号, .内容)
    赋值 (抄表日期, 到文本 (.今天))
    .判断循环首 (小于 (记录数, 小成员个数2))
        到首记录 ()
        查找 (等于 (读 (“学号”), 小文本数组 [相加 (记录数, 1)]))
        替换 (“栋号”, 相加 (栋号, “栋”))
        替换 (“楼层号”, 相加 (取文本左边 (.内容, 1), “楼”))
        替换 (“宿舍号”, 取文本右边 (.内容, 相减 (取文本长度 (.内容), 1)))
        替换 (“抄表日期”, 抄表日期)
        替换 (“水表底数”, 水表底数)
        替换 (“水表现数”, 水表现数)
        替换 (“水费”, 水费)
        替换 (“电表底数”, 电表底数)
        替换 (“电表现数”, 电表现数)
        替换 (“电费”, 电费)
        替换 (“费用合计”, 费用合计)
        赋值 (记录数, 相加 (记录数, 1))
    .判断循环尾 ()
    赋值 (次数, -1.插入表项 (相加 (栋号, “栋”), , , , ))
    次数.置标题 (1, 房间号)
    次数.置标题 (2, 抄表日期)
    次数.置标题 (3, 水表底数)
    次数.置标题 (4, 水表现数)
    次数.置标题 (5, 水费)
    次数.置标题 (6, 电表底数)
    次数.置标题 (7, 电表现数)
    次数.置标题 (8, 电费)
    次数.置标题 (9, 费用合计)
    关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
.否则
    信息框 (“打开失败”, 0, )
.如果结束


.子程序 _维修登记_被选择, 空白型, , 
.局部变量 公财记录数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 索引, 整数型, , , 

.如果真 (打开 (相加 (取运行目录 (), “\公共财产维修数据库.edb”), , , , , , ))
    赋值 (_启动窗口..现行子夹, 4)
    赋值 (_启动窗口..现行子夹, 3)
    获取焦点 ()
    .判断循环首 (小于 (记录数, 取记录数 ()))
        赋值 (索引, .插入表项 (读 (“栋号”), , , , ))
        索引.置标题 (1, 读 (“房间号码”))
        索引.置标题 (2, 读 (“维修日期”))
        索引.置标题 (3, 读 (“维修物品”))
        索引.置标题 (4, 读 (“负责人”))
        索引.置标题 (5, 读 (“折算金额”))
        索引.置标题 (6, 读 (“是否赔偿”))
        赋值 (记录数, 相加 (记录数, 1))
        跳过 ()
    .判断循环尾 ()
    关闭 (相加 (取运行目录 (), “\公共财产维修数据库.edb”))
.如果真结束
.如果真 (打开 (相加 (取运行目录 (), “\私有财产维修数据库.edb”), , , , , , ))
    赋值 (记录数, 0)
    .判断循环首 (小于 (记录数, 取记录数 ()))
        赋值 (索引, .插入表项 (读 (“学号”), , , , ))
        索引.置标题 (1, 读 (“姓名”))
        索引.置标题 (2, 读 (“维修日期”))
        索引.置标题 (3, 读 (“维修物品”))
        索引.置标题 (4, 读 (“年度”))
        索引.置标题 (5, 读 (“折算金额”))
        索引.置标题 (6, 读 (“是否赔偿”))
        赋值 (记录数, 相加 (记录数, 1))
        跳过 ()
    .判断循环尾 ()
    关闭 (相加 (取运行目录 (), “\私有财产维修数据库.edb”))
.如果真结束


.子程序 _按钮15_被单击, 空白型, , 
.局部变量 索引, 整数型, , , 

.如果真 (打开 (相加 (取运行目录 (), “\公共财产维修数据库.edb”), , , , , , ))
    加空记录 ()
    .如果真 (不等于 (取文本右边 (.内容, 2), “栋”))
        赋值 (.内容, 相加 (.内容, “栋”))
    .如果真结束
    写 (“栋号”, .内容)
    .如果真 (不等于 (取文本右边 (.内容, 2), “号”))
        赋值 (.内容, 相加 (.内容, “号”))
    .如果真结束
    写 (“房间号码”, .内容)
    写 (“维修日期”, 到文本 (.今天))
    写 (“维修物品”, .内容)
    写 (“负责人”, .内容)
    .如果真 (不等于 (取文本右边 (.内容, 2), “元”))
        赋值 (.内容, 相加 (.内容, “元”))
    .如果真结束
    写 (“折算金额”, .内容)
    写 (“是否赔偿”, .内容)
    赋值 (索引, .插入表项 (.内容, , , , ))
    索引.置标题 (1, .内容)
    索引.置标题 (2, 到文本 (.今天))
    索引.置标题 (3, .内容)
    索引.置标题 (4, .内容)
    索引.置标题 (5, .内容)
    索引.置标题 (6, .内容)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    获取焦点 ()
    关闭 (相加 (取运行目录 (), “\公共财产维修数据库.edb”))
.如果真结束


.子程序 _按钮16_被单击, 空白型, , 
.局部变量 索引, 整数型, , , 

.如果真 (打开 (相加 (取运行目录 (), “\私有财产维修数据库.edb”), , , , , , ))
    加空记录 ()
    写 (“学号”, .内容)
    写 (“姓名”, .内容)
    写 (“维修日期”, 到文本 (.今天))
    写 (“维修物品”, .内容)
    .如果真 (不等于 (取文本右边 (.内容, 2), “年”))
        赋值 (.内容, 相加 (.内容, “年”))
    .如果真结束
    写 (“年度”, .内容)
    .如果真 (不等于 (取文本右边 (.内容, 2), “元”))
        赋值 (.内容, 相加 (.内容, “元”))
    .如果真结束
    写 (“折算金额”, .内容)
    写 (“是否赔偿”, .内容)
    赋值 (索引, .插入表项 (.内容, , , , ))
    索引.置标题 (1, .内容)
    索引.置标题 (2, 到文本 (.今天))
    索引.置标题 (3, .内容)
    索引.置标题 (4, .内容)
    索引.置标题 (5, .内容)
    索引.置标题 (6, .内容)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    获取焦点 ()
    关闭 (相加 (取运行目录 (), “\私有财产维修数据库.edb”))
.如果真结束


.子程序 _学生资料修改_被选择, 空白型, , 
.如果真 (打开 (相加 (取运行目录 (), “\管理员.edb”), , , , , , ))
    查找 (等于 (读 (“用户名”), 当前管理员))
    .如果 (等于 (读 (“管理员类型”), “普通用户”))
        信息框 (“你没有权限进行学生资料修改操作”, 相加 (0, 48, 0), “提示信息”)
        关闭 (相加 (取运行目录 (), “\管理员.edb”))
    .否则
        载入 (资料修改窗口, , 假)
        赋值 (资料修改窗口..现行子夹, 0)
        赋值 (资料修改窗口..内容, “学生资料修改”)
        关闭 (相加 (取运行目录 (), “\管理员.edb”))
    .如果结束
    
.如果真结束


.子程序 _来访登记修改_被选择, 空白型, , 
.如果真 (打开 (相加 (取运行目录 (), “\管理员.edb”), , , , , , ))
    查找 (等于 (读 (“用户名”), 当前管理员))
    .如果 (等于 (读 (“管理员类型”), “普通用户”))
        信息框 (“你没有权限进行来访登记操作”, 相加 (0, 48, 0), “提示信息”)
        关闭 (相加 (取运行目录 (), “\管理员.edb”))
    .否则
        载入 (资料修改窗口, , 假)
        赋值 (资料修改窗口..现行子夹, 1)
        赋值 (资料修改窗口..内容, “来访资料修改”)
        关闭 (相加 (取运行目录 (), “\管理员.edb”))
    .如果结束
    
.如果真结束



.子程序 _学生离校修改_被选择, 空白型, , 
.如果真 (打开 (相加 (取运行目录 (), “\管理员.edb”), , , , , , ))
    查找 (等于 (读 (“用户名”), 当前管理员))
    .如果 (等于 (读 (“管理员类型”), “普通用户”))
        信息框 (“你没有学生离校修改操作”, 相加 (0, 48, 0), “提示信息”)
        关闭 (相加 (取运行目录 (), “\管理员.edb”))
    .否则
        载入 (资料修改窗口, , 假)
        赋值 (资料修改窗口..现行子夹, 2)
        赋值 (资料修改窗口..内容, “离校资料修改”)
        关闭 (相加 (取运行目录 (), “\管理员.edb”))
    .如果结束
    
.如果真结束



.子程序 _设置标准_被选择, 空白型, , 
.如果真 (打开 (相加 (取运行目录 (), “\管理员.edb”), , , , , , ))
    查找 (等于 (读 (“用户名”), 当前管理员))
    .如果 (等于 (读 (“管理员类型”), “普通用户”))
        信息框 (“你没有权限进行设置水电费标准操作”, 相加 (0, 48, 0), “提示信息”)
        关闭 (相加 (取运行目录 (), “\管理员.edb”))
    .否则
        载入 (设置水电费标准, , 假)
        关闭 (相加 (取运行目录 (), “\管理员.edb”))
    .如果结束
    
.如果真结束


.子程序 _系统数据备份_被选择, 空白型, , 
载入 (数据备份窗口, , 假)


.子程序 _系统数据还原_被选择, 空白型, , 
载入 (数据还原窗口, , 假)


.子程序 _宿舍评比_被选择, 空白型, , 
.局部变量 学生记录数, 整数型, , , 
.局部变量 优等宿舍数组, 文本型, , "0", 
.局部变量 记录数, 整数型, , , 
.局部变量 优等宿舍无重复数组, 文本型, , "0", 
.局部变量 索引, 整数型, , , 
.局部变量 良等宿舍数组, 文本型, , "0", 
.局部变量 良等宿舍无重复数组, 文本型, , "0", 
.局部变量 中等宿舍数组, 文本型, , "0", 
.局部变量 中等宿舍无重复数组, 文本型, , "0", 
.局部变量 级等宿舍数组, 文本型, , "0", 
.局部变量 级等宿舍无重复数组, 文本型, , "0", 
.局部变量 差等宿舍数组, 文本型, , "0", 
.局部变量 差等宿舍无重复数组, 文本型, , "0", 

_不可视按钮_被单击 ()
.如果真 (打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , , , , ))
    赋值 (_启动窗口..现行子夹, 5)
    赋值 (学生记录数, 取记录数 ()) ' 下面将优等卫生情况的宿舍列在列表框中
    重定义数组 (优等宿舍数组, 假, 学生记录数)
    .判断循环首 (等于 (查找 (等于 (读 (“卫生等级”), “优”)), 真))
        赋值 (优等宿舍数组 [相加 (记录数, 1)], 相加 (读 (“栋号”), 读 (“楼层号”), 读 (“宿舍号”)))
        赋值 (记录数, 相加 (记录数, 1))
        跳过 ()
    .判断循环尾 ()
    赋值 (优等宿舍无重复数组, 分割文本 (清除数组重复成员 (优等宿舍数组, “o”), “o”, ))
    到首记录 ()
    赋值 (记录数, 0)
    .判断循环首 (小于 (记录数, 取数组成员数 (优等宿舍无重复数组)))
        到首记录 ()
        查找 (等于 (相加 (读 (“栋号”), 读 (“楼层号”), 读 (“宿舍号”)), 优等宿舍无重复数组 [相加 (记录数, 1)]))
        赋值 (索引, -1.插入表项 (读 (“卫生等级”), , , , ))
        索引.置标题 (1, 读 (“栋号”))
        索引.置标题 (2, 相加 (取文本左边 (读 (“楼层号”), 1), 读 (“宿舍号”)))
        索引.置标题 (3, 读 (“年段”))
        索引.置标题 (4, 读 (“专业”))
        索引.置标题 (5, 读 (“班级”))
        索引.置标题 (6, 读 (“辅导员”))
        索引.置标题 (7, 读 (“备注”))
        赋值 (记录数, 相加 (记录数, 1))
    .判断循环尾 ()
    到首记录 ()
    赋值 (记录数, 0) ' 下面将良等卫生情况的宿舍列在列表框中
    重定义数组 (良等宿舍数组, 假, 学生记录数)
    .判断循环首 (等于 (查找 (等于 (读 (“卫生等级”), “良”)), 真))
        赋值 (良等宿舍数组 [相加 (记录数, 1)], 相加 (读 (“栋号”), 读 (“楼层号”), 读 (“宿舍号”)))
        赋值 (记录数, 相加 (记录数, 1))
        跳过 ()
    .判断循环尾 ()
    赋值 (良等宿舍无重复数组, 分割文本 (清除数组重复成员 (良等宿舍数组, “o”), “o”, ))
    到首记录 ()
    赋值 (记录数, 0)
    .判断循环首 (小于 (记录数, 取数组成员数 (良等宿舍无重复数组)))
        到首记录 ()
        查找 (等于 (相加 (读 (“栋号”), 读 (“楼层号”), 读 (“宿舍号”)), 良等宿舍无重复数组 [相加 (记录数, 1)]))
        赋值 (索引, .插入表项 (读 (“卫生等级”), , , , ))
        索引.置标题 (1, 读 (“栋号”))
        索引.置标题 (2, 相加 (取文本左边 (读 (“楼层号”), 1), 读 (“宿舍号”)))
        索引.置标题 (3, 读 (“年段”))
        索引.置标题 (4, 读 (“专业”))
        索引.置标题 (5, 读 (“班级”))
        索引.置标题 (6, 读 (“辅导员”))
        索引.置标题 (7, 读 (“备注”))
        跳过 ()
        赋值 (记录数, 相加 (记录数, 1))
    .判断循环尾 ()
    到首记录 ()
    赋值 (记录数, 0) ' 下面将中等卫生情况的宿舍列在列表框中
    重定义数组 (中等宿舍数组, 假, 学生记录数)
    .判断循环首 (等于 (查找 (等于 (读 (“卫生等级”), “中”)), 真))
        赋值 (中等宿舍数组 [相加 (记录数, 1)], 相加 (读 (“栋号”), 读 (“楼层号”), 读 (“宿舍号”)))
        赋值 (记录数, 相加 (记录数, 1))
        跳过 ()
    .判断循环尾 ()
    赋值 (中等宿舍无重复数组, 分割文本 (清除数组重复成员 (中等宿舍数组, “o”), “o”, ))
    到首记录 ()
    赋值 (记录数, 0)
    .判断循环首 (小于 (记录数, 取数组成员数 (中等宿舍无重复数组)))
        到首记录 ()
        查找 (等于 (相加 (读 (“栋号”), 读 (“楼层号”), 读 (“宿舍号”)), 中等宿舍无重复数组 [相加 (记录数, 1)]))
        赋值 (索引, .插入表项 (读 (“卫生等级”), , , , ))
        索引.置标题 (1, 读 (“栋号”))
        索引.置标题 (2, 相加 (取文本左边 (读 (“楼层号”), 1), 读 (“宿舍号”)))
        索引.置标题 (3, 读 (“年段”))
        索引.置标题 (4, 读 (“专业”))
        索引.置标题 (5, 读 (“班级”))
        索引.置标题 (6, 读 (“辅导员”))
        索引.置标题 (7, 读 (“备注”))
        跳过 ()
        赋值 (记录数, 相加 (记录数, 1))
    .判断循环尾 ()
    到首记录 ()
    赋值 (记录数, 0) ' 下面将级等卫生情况的宿舍列在列表框中
    重定义数组 (级等宿舍数组, 假, 学生记录数)
    .判断循环首 (等于 (查找 (等于 (读 (“卫生等级”), “级”)), 真))
        赋值 (级等宿舍数组 [相加 (记录数, 1)], 相加 (读 (“栋号”), 读 (“楼层号”), 读 (“宿舍号”)))
        赋值 (记录数, 相加 (记录数, 1))
        跳过 ()
    .判断循环尾 ()
    赋值 (级等宿舍无重复数组, 分割文本 (清除数组重复成员 (级等宿舍数组, “o”), “o”, ))
    到首记录 ()
    赋值 (记录数, 0)
    .判断循环首 (小于 (记录数, 取数组成员数 (级等宿舍无重复数组)))
        到首记录 ()
        查找 (等于 (相加 (读 (“栋号”), 读 (“楼层号”), 读 (“宿舍号”)), 级等宿舍无重复数组 [相加 (记录数, 1)]))
        赋值 (索引, .插入表项 (读 (“卫生等级”), , , , ))
        索引.置标题 (1, 读 (“栋号”))
        索引.置标题 (2, 相加 (取文本左边 (读 (“楼层号”), 1), 读 (“宿舍号”)))
        索引.置标题 (3, 读 (“年段”))
        索引.置标题 (4, 读 (“专业”))
        索引.置标题 (5, 读 (“班级”))
        索引.置标题 (6, 读 (“辅导员”))
        索引.置标题 (7, 读 (“备注”))
        跳过 ()
        赋值 (记录数, 相加 (记录数, 1))
    .判断循环尾 ()
    到首记录 ()
    赋值 (记录数, 0) ' 下面将差等卫生情况的宿舍列在列表框中
    重定义数组 (差等宿舍数组, 假, 学生记录数)
    .判断循环首 (等于 (查找 (等于 (读 (“卫生等级”), “差”)), 真))
        赋值 (差等宿舍数组 [相加 (记录数, 1)], 相加 (读 (“栋号”), 读 (“楼层号”), 读 (“宿舍号”)))
        赋值 (记录数, 相加 (记录数, 1))
        跳过 ()
    .判断循环尾 ()
    赋值 (差等宿舍无重复数组, 分割文本 (清除数组重复成员 (差等宿舍数组, “o”), “o”, ))
    到首记录 ()
    赋值 (记录数, 0)
    .判断循环首 (小于 (记录数, 取数组成员数 (差等宿舍无重复数组)))
        到首记录 ()
        查找 (等于 (相加 (读 (“栋号”), 读 (“楼层号”), 读 (“宿舍号”)), 差等宿舍无重复数组 [相加 (记录数, 1)]))
        赋值 (索引, .插入表项 (读 (“卫生等级”), , , , ))
        索引.置标题 (1, 读 (“栋号”))
        索引.置标题 (2, 相加 (取文本左边 (读 (“楼层号”), 1), 读 (“宿舍号”)))
        索引.置标题 (3, 读 (“年段”))
        索引.置标题 (4, 读 (“专业”))
        索引.置标题 (5, 读 (“班级”))
        索引.置标题 (6, 读 (“辅导员”))
        索引.置标题 (7, 读 (“备注”))
        跳过 ()
        赋值 (记录数, 相加 (记录数, 1))
    .判断循环尾 ()
    刷新显示 ()
    关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
.如果真结束



.子程序 _不可视按钮_被单击, 空白型, , 
_启动窗口.全部删除 (.)


.子程序 _察看离校记录_被选择, 空白型, , 
赋值 (_启动窗口..现行子夹, 3)
.如果 (等于 (是否已打开 (相加 (取运行目录 (), “\离校登记数据库.edb”)), 真))
    赋值 (.数据库文件名, 相加 (取运行目录 (), “\离校登记数据库.edb”))
.否则
    打开 (相加 (取运行目录 (), “\离校登记数据库.edb”), , , , , , )
    赋值 (.数据库文件名, 相加 (取运行目录 (), “\离校登记数据库.edb”))
.如果结束



.子程序 _学生搜索_被选择, 空白型, , 
载入 (学生查找, , 假)


.子程序 _学生资料_被选择, 空白型, , 
赋值 (_启动窗口..现行子夹, 2)


.子程序 _修改资料_被选择, 空白型, , 
.如果真 (打开 (相加 (取运行目录 (), “\管理员.edb”), , , , , , ))
    查找 (等于 (读 (“用户名”), 当前管理员))
    .如果 (等于 (读 (“管理员类型”), “普通用户”))
        信息框 (“你没有权限进行学生的资料修改”, 相加 (0, 48, 0), “提示信息”)
        关闭 (相加 (取运行目录 (), “\管理员.edb”))
    .否则
        载入 (资料修改窗口, , 假)
        赋值 (资料修改窗口..现行子夹, 0)
        关闭 (相加 (取运行目录 (), “\管理员.edb”))
    .如果结束
    
.如果真结束


.子程序 _按钮17_被单击, 空白型, , 
赋值 (_启动窗口..现行子夹, 0)


.子程序 _管理员修改_被选择, 空白型, , 
_管理员设置_被选择 ()

.子程序 _员工修改_被选择, 空白型, , 
_员工管理_被选择 ()


.子程序 _水电费统计_被选择, 空白型, , 
.如果真 (打开 (相加 (取运行目录 (), “\管理员.edb”), , , , , , ))
    查找 (等于 (读 (“用户名”), 当前管理员))
    .如果 (等于 (读 (“管理员类型”), “普通用户”))
        信息框 (“你没有权限进行水电费统计操作”, 相加 (0, 48, 0), “提示信息”)
        关闭 (相加 (取运行目录 (), “\管理员.edb”))
    .否则
        赋值 (_启动窗口..现行子夹, 4)
        赋值 (_启动窗口..现行子夹, 2)
        关闭 (相加 (取运行目录 (), “\管理员.edb”))
    .如果结束
    
.如果真结束


.子程序 _寝室管理_被选择, 空白型, , 
赋值 (_启动窗口..现行子夹, 4)
赋值 (_启动窗口..现行子夹, 0)


.子程序 _公财登记_被选择, 空白型, , 
.如果真 (打开 (相加 (取运行目录 (), “\管理员.edb”), , , , , , ))
    查找 (等于 (读 (“用户名”), 当前管理员))
    .如果 (等于 (读 (“管理员类型”), “普通用户”))
        信息框 (“你没有权限进行公共财产登记操作”, 相加 (0, 48, 0), “提示信息”)
        关闭 (相加 (取运行目录 (), “\管理员.edb”))
    .否则
        赋值 (_启动窗口..现行子夹, 4)
        赋值 (_启动窗口..现行子夹, 1)
        关闭 (相加 (取运行目录 (), “\管理员.edb”))
    .如果结束
    
.如果真结束


.子程序 _按钮18_被单击, 空白型, , 
赋值 (_启动窗口..现行子夹, 0)


.子程序 _私有登记_被选择, 空白型, , 
赋值 (_启动窗口..现行子夹, 4)
赋值 (_启动窗口..现行子夹, 1)


.子程序 _来访登记_被选择, 空白型, , 
.如果真 (打开 (相加 (取运行目录 (), “\管理员.edb”), , , , , , ))
    查找 (等于 (读 (“用户名”), 当前管理员))
    .如果 (等于 (读 (“管理员类型”), “普通用户”))
        信息框 (“你没有权限进行来访登记操作”, 相加 (0, 48, 0), “提示信息”)
        关闭 (相加 (取运行目录 (), “\管理员.edb”))
    .否则
        载入 (来访登记窗口, , 假)
        关闭 (相加 (取运行目录 (), “\管理员.edb”))
    .如果结束
    
.如果真结束




.子程序 _来访修改_被选择, 空白型, , 
_来访登记修改_被选择 ()


.子程序 _按钮19_被单击, 空白型, , 
赋值 (_启动窗口..现行子夹, 0)


.子程序 _按钮20_被单击, 空白型, , 
.局部变量 记录数, 整数型, , , 
.局部变量 宿舍成员q, 文本型, , "10", 
.局部变量 成员个数w, 整数型, , , 
.局部变量 文本数组3, 文本型, , "0", 
.局部变量 成员个数7, 整数型, , , 

.如果真 (打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , , , , ))
    赋值 (成员个数w, 1)
    .判断循环首 (等于 (查找 (并且 (等于 (_启动窗口.取项目文本 (., .取父项目 (.最大化按钮).取父项目 ()), 读 (“栋号”)), 等于 (_启动窗口.取项目文本 (., .取父项目 (.最大化按钮)), 读 (“楼层号”)), 等于 (_启动窗口.取项目文本 (., .最大化按钮), 读 (“宿舍号”)))), 真))
        赋值 (宿舍成员q [成员个数w], 读 (“学号”))
        赋值 (成员个数w, 相加 (成员个数w, 1))
        跳过 ()
    .判断循环尾 ()
    赋值 (文本数组3, 分割文本 (清除数组重复成员 (宿舍成员q, “o”), “o”, ))
    赋值 (成员个数7, 取数组成员数 (文本数组3))
    .判断循环首 (小于 (记录数, 取数组成员数 (文本数组3)))
        到首记录 ()
        查找 (等于 (读 (“学号”), 文本数组3 [相加 (记录数, 1)]))
        替换 (“宿舍电话”, _启动窗口..内容)
        替换 (“卫生等级”, _启动窗口..内容)
        替换 (“第一学期”, .内容)
        替换 (“第二学期”, .内容)
        替换 (“第三学期”, .内容)
        替换 (“第四学期”, .内容)
        替换 (“第五学期”, .内容)
        替换 (“第六学期”, .内容)
        赋值 (记录数, 相加 (记录数, 1))
    .判断循环尾 ()
    关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
.如果真结束



.子程序 _银色风格_被选择, 空白型, , 
写配置项 (相加 (取运行目录 (), “\用户配置.ini”), “系统风格”, “风格值”, “3”)
未知支持库函数_0 (到数值 (读配置项 (相加 (取运行目录 (), “\用户配置.ini”), “系统风格”, “风格值”, )))


.子程序 _无风格_被选择, 空白型, , 
写配置项 (相加 (取运行目录 (), “\用户配置.ini”), “系统风格”, “风格值”, “0”)
未知支持库函数_0 (到数值 (读配置项 (相加 (取运行目录 (), “\用户配置.ini”), “系统风格”, “风格值”, )))


.子程序 _蓝色风格_被选择, 空白型, , 
写配置项 (相加 (取运行目录 (), “\用户配置.ini”), “系统风格”, “风格值”, “1”)
未知支持库函数_0 (到数值 (读配置项 (相加 (取运行目录 (), “\用户配置.ini”), “系统风格”, “风格值”, )))


.子程序 _绿色风格_被选择, 空白型, , 
写配置项 (相加 (取运行目录 (), “\用户配置.ini”), “系统风格”, “风格值”, “2”)
未知支持库函数_0 (到数值 (读配置项 (相加 (取运行目录 (), “\用户配置.ini”), “系统风格”, “风格值”, )))


.子程序 _按钮21_被单击, 空白型, , 
赋值 (_启动窗口..现行子夹, 0)


.子程序 _地址查找按钮_被单击, 空白型, , 
.如果真 (打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , , , , ))
    .如果 (等于 (查找 (等于 (读 (“地址”), .内容)), 真))
        赋值 (.标题, 读 (“学号”))
        刷新显示 ()
        赋值 (.标题, 读 (“姓名”))
        刷新显示 ()
        赋值 (.标题, 读 (“性别”))
        刷新显示 ()
        赋值 (.标题, 读 (“民族”))
        刷新显示 ()
        赋值 (.标题, 读 (“年段”))
        刷新显示 ()
        赋值 (.标题, 读 (“专业”))
        刷新显示 ()
        赋值 (.标题, 读 (“班级”))
        刷新显示 ()
        赋值 (.标题, 读 (“辅导员”))
        刷新显示 ()
        赋值 (.标题, 读 (“栋号”))
        刷新显示 ()
        赋值 (.标题, 读 (“楼层号”))
        刷新显示 ()
        赋值 (.标题, 读 (“宿舍号”))
        刷新显示 ()
        赋值 (.标题, 读 (“电话”))
        刷新显示 ()
        赋值 (.标题, 读 (“地址”))
        刷新显示 ()
        赋值 (.内容, 读 (“财产登记”))
        刷新显示 ()
        赋值 (.内容, 读 (“备注”))
        刷新显示 ()
        到首记录 ()
    .否则
        信息框 (相加 (“没地址为: ”, .内容, “ 的学生   ”), 相加 (0, 48, 0), “提示信息”)
        赋值 (.内容, “”)
    .如果结束
    关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
.如果真结束


.子程序 _按钮8_被单击, 空白型, , 
.局部变量 宿舍成员, 文本型, , "10", 
.局部变量 成员个数, 整数型, , , 
.局部变量 文本组, 文本型, , "0", 
.局部变量 成员个数2, 整数型, , , 
.局部变量 记录数, 整数型, , , 

赋值 (成员个数, 1)
.如果真 (打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , , , , ))
    .判断循环首 (等于 (查找 (并且 (等于 (_启动窗口.取项目文本 (., .取父项目 (.最大化按钮).取父项目 ()), 读 (“栋号”)), 等于 (_启动窗口.取项目文本 (., .取父项目 (.最大化按钮)), 读 (“楼层号”)), 等于 (_启动窗口.取项目文本 (., .最大化按钮), 读 (“宿舍号”)))), 真))
        赋值 (宿舍成员 [成员个数], 读 (“学号”))
        赋值 (成员个数, 相加 (成员个数, 1))
        跳过 ()
    .判断循环尾 ()
    赋值 (文本组, 分割文本 (清除数组重复成员 (宿舍成员, “o”), “o”, ))
    赋值 (成员个数2, 取数组成员数 (文本组))
    .判断循环首 (小于 (记录数, 取数组成员数 (文本组)))
        到首记录 ()
        查找 (等于 (读 (“学号”), 文本组 [相加 (记录数, 1)]))
        替换 (“卫生等级”, .内容)
        赋值 (记录数, 相加 (记录数, 1))
    .判断循环尾 ()
    关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
    
.如果真结束


.子程序 _选择夹1_子夹被改变, 空白型, , 
.如果真 (不等于 (_启动窗口..现行子夹, 3))
    .如果真 (是否已打开 (相加 (取运行目录 (), “\离校登记数据库.edb”)))
        关闭 (相加 (取运行目录 (), “\离校登记数据库.edb”))
    .如果真结束
    
.如果真结束


.子程序 _按钮22_被单击, 空白型, , 
赋值 (_启动窗口..现行子夹, 0)


.窗口程序集 窗口程序集2, , , 

.程序集变量 动态计数, 整数型, , , 
.子程序 _动态窗口_创建完毕, 空白型, , 
赋值 (.时钟周期, 200)
赋值 (动态窗口., 真)
赋值 (动态计数, 0)

.子程序 _时钟1_周期事件, 空白型, , 
.判断开始 (等于 (.内容, “■　□　□　□　□　□”))
    赋值 (.内容, “□　■　□　□　□　□”)
.判断 (等于 (.内容, “□　■　□　□　□　□”))
    赋值 (.内容, “□　□　■　□　□　□”)
.判断 (等于 (.内容, “□　□　■　□　□　□”))
    赋值 (.内容, “□　□　□　■　□　□”)
.判断 (等于 (.内容, “□　□　□　■　□　□”))
    赋值 (.内容, “□　□　□　□　■　□”)
.判断 (等于 (.内容, “□　□　□　□　■　□”))
    赋值 (.内容, “□　□　□　□　□　■”)
.判断 (等于 (.内容, “□　□　□　□　□　■”))
    赋值 (.内容, “■　□　□　□　□　□”)
.默认
    
.判断结束
刷新显示 ()
赋值 (动态计数, 相加 (动态计数, 1))
.如果真 (等于 (动态计数, 20))
    赋值 (.时钟周期, 0)
    销毁 ()
    载入 (管理员登入窗口, _启动窗口, 真)
    
.如果真结束


.窗口程序集 窗口程序集3, , , 

.子程序 _按钮1_被单击, 空白型, , 
.如果真 (并且 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“请输入用户名和密码再单击 <<确定>>按钮！”, 相加 (0, 48, 0), “友情提示”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (并且 (等于 (.内容, “”), 不等于 (.内容, “”)))
    信息框 (“请输入用户名后再单击 <<确定>>按钮”, 相加 (0, 48, 48), “友情提示”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (并且 (不等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“请输入密码后再单击 <<确定>>按钮！”, 相加 (0, 48, 0), “友情提示”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (并且 (等于 (.内容, “admin”), 等于 (.内容, “8888”)))
    .如果真 (打开 (相加 (取运行目录 (), “\管理员.edb”), , , , , , ))
        .如果 (等于 (取记录数 (), 0))
            管理员登入窗口.销毁 ()
            载入 (导航窗口, , 假)
            关闭 (相加 (取运行目录 (), “\管理员.edb”))
            赋值 (当前管理员, “admin”)
            _启动窗口.置文本 (., 0, 相加 (“当前管理员: ”, 当前管理员))
        .否则
            信息框 (“已经不能使用初始的用户名和密码,请重新输入！”, 相加 (0, 64, 0), “警告提示！”)
            赋值 (.内容, “”)
            赋值 (.内容, “”)
            获取焦点 ()
            关闭 (相加 (取运行目录 (), “\管理员.edb”))
        .如果结束
        
    .如果真结束
    返回 ()
.如果真结束
.如果真 (打开 (相加 (取运行目录 (), “\管理员.edb”), , , , , , ))
    .如果 (等于 (查找 (等于 (读 (1), .内容)), 真))
        赋值 (.内容, 读 (2))
        .如果 (等于 (.内容, .内容))
            赋值 (当前管理员, .内容)
            _启动窗口.置文本 (., 0, 相加 (“当前管理员: ”, 当前管理员))
            关闭 (相加 (取运行目录 (), “\管理员.edb”))
            管理员登入窗口.销毁 ()
            载入 (导航窗口, , 假)
        .否则
            信息框 (“您输入的密码不正确,请重新输入！”, 相加 (0, 48, 0), “友情提示”)
            赋值 (.内容, “”)
            获取焦点 ()
            关闭 (相加 (取运行目录 (), “\管理员.edb”))
        .如果结束
        
    .否则
        .如果真 (等于 (信息框 (“这个用户不存在,请重新输入用户名！”, 相加 (0, 48, 0), “友情提示”), #是钮))
            关闭 (相加 (取运行目录 (), “\管理员.edb”))
            _按钮1_被单击 ()
        .如果真结束
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        获取焦点 ()
    .如果结束
    关闭 (相加 (取运行目录 (), “\管理员.edb”))
.如果真结束


.子程序 _按钮2_被单击, 空白型, , 
结束 ()

.子程序 管理员加到用户名, 空白型, , 
.局部变量 记录数, 整数型, , , 

.如果 (等于 (取记录数 (), 0))
    赋值 (.内容, “初始管理员用户名:admin  密码:8888,建议进入后设置管理员帐户.”)
    赋值 (.内容, “admin”)
    赋值 (.内容, “8888”)
.否则
    .判断循环首 (小于 (记录数, 取记录数 ()))
        读 (1).加入项目 ()
        赋值 (记录数, 相加 (记录数, 1))
        跳过 ()
    .判断循环尾 ()
.如果结束
关闭 (相加 (取运行目录 (), “\管理员.edb”))

.子程序 _管理员登入窗口_创建完毕, 空白型, , 
.局部变量 字段, 字段信息, , "3", 

.如果真 (等于 (文件是否存在 (“管理员.edb”), 假))
    赋值 (字段 [1].名称, “用户名”)
    赋值 (字段 [1].类型, #文本型)
    赋值 (字段 [1].最大文本长度, 20)
    赋值 (字段 [2].名称, “密码”)
    赋值 (字段 [2].类型, #文本型)
    赋值 (字段 [2].最大文本长度, 8)
    赋值 (字段 [3].名称, “管理员类型”)
    赋值 (字段 [3].类型, #文本型)
    赋值 (字段 [3].最大文本长度, 8)
    创建 (“管理员.edb”, 字段)
    置文件属性 (“管理员.edb”, 2)
.如果真结束
.如果 (等于 (打开 (相加 (取运行目录 (), “\管理员.edb”), , , , , , ), 真))
    管理员加到用户名 ()
.否则
    信息框 (“打开管理员数据失败!!”, 0, )
.如果结束


.窗口程序集 窗口程序集4, , , 

.子程序 _确定按钮_被单击, 空白型, , 
销毁 ()

.子程序 _添加按钮_被单击, 空白型, , 
.如果真 (并且 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“请输入用户名和密码后再单击 <<添加>>按钮！”, 相加 (0, 48, 0), “友情提示”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (并且 (等于 (.内容, “”), 不等于 (.内容, “”)))
    信息框 (“请输入用户名后再单击 <<添加>>按钮！”, 相加 (0, 48, 0), “友情提示”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (并且 (不等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“请输入密码后再单击 <<添加>>按钮！”, 相加 (0, 48, 0), “友情提示”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (打开 (相加 (取运行目录 (), “\管理员.edb”), , , , , , ))
    .如果真 (查找 (等于 (读 (1), .内容)))
        信息框 (“设置的用户名不能与其它用户名重复！！”, 相加 (0, 48, 0), “友情提示”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        获取焦点 ()
        关闭 (相加 (取运行目录 (), “\管理员.edb”))
        返回 ()
    .如果真结束
    加空记录 ()
    .如果 (并且 (等于 (写 (1, .内容), 真), 等于 (写 (2, .内容), 真), 等于 (写 (3, .内容), 真)))
        .判断开始 (等于 (.内容, “管理员”))
            -1.插入表项 (.内容, 0, , , )
            赋值 (.内容, “”)
            赋值 (.内容, “”)
            获取焦点 ()
        .判断 (等于 (.内容, “普通用户”))
            -1.插入表项 (.内容, 1, , , )
            赋值 (.内容, “”)
            赋值 (.内容, “”)
            获取焦点 ()
        .默认
            关闭 (相加 (取运行目录 (), “\管理员.edb”))
        .判断结束
        刷新显示 ()
    .否则
        信息框 (“系统错误,添加用户失败！！”, 相加 (0, 16, 0), “添加用户失败”)
        关闭 (相加 (取运行目录 (), “\管理员.edb”))
    .如果结束
    关闭 (相加 (取运行目录 (), “\管理员.edb”))
.如果真结束


.子程序 _管理员设置窗口_创建完毕, 空白型, , 
.如果 (等于 (打开 (相加 (取运行目录 (), “\管理员.edb”), , , , , , ), 真))
    .判断循环首 (等于 (尾记录后 (), 假))
        -1.插入表项 (读 (1), 选择 (等于 (读 (3), “管理员”), 0, 1), , , )
        跳过 ()
    .判断循环尾 ()
    到首记录 ()
    查找 (等于 (读 (“用户名”), 当前管理员))
    .如果 (等于 (读 (“管理员类型”), “普通用户”))
        赋值 (.类型, 0)
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
        赋值 (.类型, 1)
        信息框 (“你没有权限进行管理员的设置！！”, 相加 (0, 48, 0), “提示信息”)
        关闭 (相加 (取运行目录 (), “\管理员.edb”))
    .否则
        
    .如果结束
    关闭 (相加 (取运行目录 (), “\管理员.edb”))
.否则
    信息框 (“抱歉系统出错了,不能进行管理员设置操作！！”, 相加 (0, 16, 0), “出错了”)
.如果结束


.子程序 _删除按钮_被单击, 空白型, , 
.局部变量 删除记录号, 整数型, , , 

.如果 (等于 (打开 (相加 (取运行目录 (), “\管理员.edb”), , , , , , ), 真))
    .如果 (不等于 (取已选择表项数 (), 0))
        赋值 (删除记录号, 相加 (.取标题 (., ).查找表项 (0, ), 1))
        跳到 (删除记录号)
        删除 ()
        彻底删除 ()
        .删除表项 (.)
        关闭 (相加 (取运行目录 (), “\管理员.edb”))
    .否则
        信息框 (“请选择要删除的用户后单击 <<删除>>按钮！！”, 相加 (0, 48, 0), “友情提示”)
        关闭 (相加 (取运行目录 (), “\管理员.edb”))
    .如果结束
    
.否则
    信息框 (“抱歉系统出错了,不能进行管理删除操作！！”, 相加 (0, 16, 0), “出错了”)
.如果结束


.子程序 _刷新按钮_被单击, 空白型, , 
刷新显示 ()

.窗口程序集 窗口程序集5, , , 

.子程序 _按钮1_被单击, 空白型, , 
.如果 (等于 (是否已打开 (相加 (取运行目录 (), “\宿舍员工数据库.edb”)), 假))
    打开 (相加 (取运行目录 (), “\宿舍员工数据库.edb”), , , , , , )
    .添加行 ()
    到尾记录 ()
    取行数 ().置文本 (1, 员工管理窗口..内容)
    取行数 ().置文本 (2, 员工管理窗口..内容)
    取行数 ().置文本 (3, 员工管理窗口..内容)
    取行数 ().置文本 (4, 员工管理窗口..内容)
    取行数 ().置文本 (5, 员工管理窗口..内容)
    取行数 ().置文本 (6, 员工管理窗口..内容)
    取行数 ().置文本 (7, 员工管理窗口..内容)
    取行数 ().置文本 (8, 员工管理窗口..内容)
    取行数 ().置文本 (9, 员工管理窗口..内容)
    赋值 (员工管理窗口..内容, “”)
    赋值 (员工管理窗口..内容, “”)
    赋值 (员工管理窗口..内容, “男”)
    赋值 (员工管理窗口..内容, “”)
    赋值 (员工管理窗口..内容, “1楼”)
    赋值 (员工管理窗口..内容, “”)
    赋值 (员工管理窗口..内容, “”)
    赋值 (员工管理窗口..内容, “”)
    赋值 (员工管理窗口..内容, “”)
    员工管理窗口.获取焦点 (.)
    刷新显示 ()
    
.否则
    置当前库 (相加 (取运行目录 (), “\宿舍员工数据库.edb”))
    .添加行 ()
    到尾记录 ()
    取行数 ().置文本 (1, 员工管理窗口..内容)
    取行数 ().置文本 (2, 员工管理窗口..内容)
    取行数 ().置文本 (3, 员工管理窗口..内容)
    取行数 ().置文本 (4, 员工管理窗口..内容)
    取行数 ().置文本 (5, 员工管理窗口..内容)
    取行数 ().置文本 (6, 员工管理窗口..内容)
    取行数 ().置文本 (7, 员工管理窗口..内容)
    取行数 ().置文本 (8, 员工管理窗口..内容)
    取行数 ().置文本 (9, 员工管理窗口..内容)
    赋值 (员工管理窗口..内容, “”)
    赋值 (员工管理窗口..内容, “”)
    赋值 (员工管理窗口..内容, “男”)
    赋值 (员工管理窗口..内容, “”)
    赋值 (员工管理窗口..内容, “1楼”)
    赋值 (员工管理窗口..内容, “”)
    赋值 (员工管理窗口..内容, “”)
    赋值 (员工管理窗口..内容, “”)
    赋值 (员工管理窗口..内容, “”)
    员工管理窗口.获取焦点 (.)
    刷新显示 ()
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
员工管理窗口.取光标行号 (.).删除行 (员工管理窗口.取选择行数 (.))


.子程序 _按钮3_被单击, 空白型, , 
到首记录 ()


.子程序 _按钮4_被单击, 空白型, , 
到尾记录 ()

.子程序 _按钮5_被单击, 空白型, , 
员工管理窗口.销毁 ()


.子程序 _员工管理窗口_创建完毕, 空白型, , 
赋值 (员工管理窗口., 真)


.窗口程序集 窗口程序集6, , , 

.子程序 _按钮2_被单击, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
关闭 ()
销毁 ()


.子程序 _按钮1_被单击, 空白型, , 
更改密码 ()


.子程序 更改密码, 空白型, , 
.如果 (或者 (等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“请把所有必须项目都填完整！！”, 相加 (0, 48, 0), )
.否则
    查找 (等于 (读 (“用户名”), .内容))
    .如果真 (不等于 (读 (“密码”), .内容))
        信息框 (“旧密码错误,请重新输入！！”, 相加 (0, 48, 0), “友情提示”)
        赋值 (.内容, “”)
        到首记录 ()
    .如果真结束
    .如果真 (不等于 (.内容, .内容))
        信息框 (“新旧密码不一致,请重新输入！！”, 相加 (0, 48, 48), “友情提示”)
        赋值 (.内容, “”)
        到首记录 ()
    .如果真结束
    .如果真 (并且 (等于 (读 (“密码”), .内容), 等于 (.内容, .内容)))
         ' 替换 (“密码”, .内容)
        信息框 (“密码修改成功！！”, 相加 (0, 48, 0), “信息提示”)
        到首记录 ()
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
    .如果真结束
    
.如果结束



.子程序 _修改密码窗口_创建完毕, 空白型, , 
.局部变量 记录数, 整数型, , , 

.如果真 (打开 (相加 (取运行目录 (), “\管理员.edb”), , , , , , ))
    .判断循环首 (小于 (记录数, 取记录数 ()))
        读 (“用户名”).加入项目 ()
        跳过 ()
        赋值 (记录数, 相加 (记录数, 1))
    .判断循环尾 ()
    到首记录 ()
.如果真结束


.子程序 _按钮3_被单击, 空白型, , 
赋值 (.内容, “”)
赋值 (.内容, “”)
赋值 (.内容, “”)
关闭 ()
销毁 ()


.窗口程序集 窗口程序集7, , , 

.子程序 _按钮1_被单击, 空白型, , 
.如果真 (打开 (相加 (取运行目录 (), “\离校登记数据库.edb”), , , , , , )) ' 把离校登记内容写入数据库
    .如果 (并且 (等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”)))
        信息框 (“你没有填写任何信息,请填写后再添加！！”, 相加 (0, 48, 0), “友情提示”)
        关闭 (相加 (取运行目录 (), “\离校登记数据库.edb”))
    .否则
        加空记录 ()
        写 (“姓名”, .内容)
        写 (“性别”, .内容)
        写 (“值班人”, .内容)
        写 (“员工号”, .内容)
        写 (“学生学号”, .内容)
        写 (“出楼货物”, .内容)
        写 (“出楼时间”, 到文本 (.今天))
        写 (“证件名称”, .内容)
        写 (“备注”, .内容)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        赋值 (.内容, “”)
        获取焦点 ()
        信息框 (“添加成功”, 0, )
        关闭 (相加 (取运行目录 (), “\离校登记数据库.edb”))
    .如果结束
    
.如果真结束


.子程序 _按钮3_被单击, 空白型, , 
销毁 ()




.窗口程序集 窗口程序集8, , , 

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 次数, 整数型, , , 

.如果 (打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , , , , ))
    全部删除 ()
    .判断循环首 (等于 (查找 (等于 (读 (“学号”), .内容)), 真))
        .插入表项 (读 (“年段”), , , , )
        次数.置标题 (1, 读 (“专业”))
        次数.置标题 (2, 读 (“班级”))
        次数.置标题 (3, 读 (“姓名”))
        次数.置标题 (4, 读 (“性别”))
        次数.置标题 (5, 读 (“学号”))
        次数.置标题 (6, 读 (“地址”))
        次数.置标题 (7, 读 (“电话”))
        次数.置标题 (8, 读 (“辅导员”))
        次数.置标题 (9, 相加 (取文本左边 (读 (“栋号”), 相减 (取文本长度 (读 (“栋号”)), 2)), 取文本左边 (读 (“楼层号”), 相减 (取文本长度 (读 (“楼层号”)), 2)), 读 (“宿舍号”)))
        次数.置标题 (10, 读 (“备注”))
        赋值 (次数, 相加 (次数, 1))
        跳过 ()
    .判断循环尾 ()
    关闭 ()
    
.否则
    信息框 (“错误没打开”, 0, )
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 次数, 整数型, , , 

赋值 (次数, 0)
.如果 (等于 (打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , , , , ), 真))
    全部删除 ()
    .判断循环首 (等于 (查找 (等于 (读 (“姓名”), .内容)), 真))
        .插入表项 (读 (“年段”), , , , )
        次数.置标题 (1, 读 (“专业”))
        次数.置标题 (2, 读 (“班级”))
        次数.置标题 (3, 读 (“姓名”))
        次数.置标题 (4, 读 (“性别”))
        次数.置标题 (5, 读 (“学号”))
        次数.置标题 (6, 读 (“地址”))
        次数.置标题 (7, 读 (“电话”))
        次数.置标题 (8, 读 (“辅导员”))
        次数.置标题 (9, 相加 (取文本左边 (读 (“栋号”), 相减 (取文本长度 (读 (“栋号”)), 2)), 取文本左边 (读 (“楼层号”), 相减 (取文本长度 (读 (“楼层号”)), 2)), 读 (“宿舍号”)))
        次数.置标题 (10, 读 (“备注”))
        赋值 (次数, 相加 (次数, 1))
        跳过 ()
    .判断循环尾 ()
    关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
.否则
    信息框 (“错误没打开”, 0, )
.如果结束


.子程序 _按钮3_被单击, 空白型, , 
.局部变量 次数, 整数型, , , 

.如果 (等于 (打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , , , , ), 真))
    全部删除 ()
    .判断循环首 (等于 (查找 (等于 (相加 (取文本左边 (读 (“栋号”), 相减 (取文本长度 (读 (“栋号”)), 2)), 取文本左边 (读 (“楼层号”), 相减 (取文本长度 (读 (“楼层号”)), 2)), 读 (“宿舍号”)), .内容)), 真))
        .插入表项 (读 (“年段”), , , , )
        次数.置标题 (1, 读 (“专业”))
        次数.置标题 (2, 读 (“班级”))
        次数.置标题 (3, 读 (“姓名”))
        次数.置标题 (4, 读 (“性别”))
        次数.置标题 (5, 读 (“学号”))
        次数.置标题 (6, 读 (“地址”))
        次数.置标题 (7, 读 (“电话”))
        次数.置标题 (8, 读 (“辅导员”))
        次数.置标题 (9, 相加 (取文本左边 (读 (“栋号”), 相减 (取文本长度 (读 (“栋号”)), 2)), 取文本左边 (读 (“楼层号”), 相减 (取文本长度 (读 (“楼层号”)), 2)), 读 (“宿舍号”)))
        次数.置标题 (10, 读 (“备注”))
        赋值 (次数, 相加 (次数, 1))
        跳过 ()
    .判断循环尾 ()
    关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
.否则
    信息框 (“错误没打开”, 0, )
.如果结束


.子程序 _按钮7_被单击, 空白型, , 
.局部变量 次数, 整数型, , , 

.如果 (等于 (打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , , , , ), 真))
    全部删除 ()
    .判断循环首 (等于 (查找 (等于 (读 (“地址”), .内容)), 真))
        .插入表项 (读 (“年段”), , , , )
        次数.置标题 (1, 读 (“专业”))
        次数.置标题 (2, 读 (“班级”))
        次数.置标题 (3, 读 (“姓名”))
        次数.置标题 (4, 读 (“性别”))
        次数.置标题 (5, 读 (“学号”))
        次数.置标题 (6, 读 (“地址”))
        次数.置标题 (7, 读 (“电话”))
        次数.置标题 (8, 读 (“辅导员”))
        次数.置标题 (9, 相加 (取文本左边 (读 (“栋号”), 相减 (取文本长度 (读 (“栋号”)), 2)), 取文本左边 (读 (“楼层号”), 相减 (取文本长度 (读 (“楼层号”)), 2)), 读 (“宿舍号”)))
        次数.置标题 (10, 读 (“备注”))
        赋值 (次数, 相加 (次数, 1))
        跳过 ()
    .判断循环尾 ()
    关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
    
.否则
    信息框 (“错误没打开”, 0, )
.如果结束


.子程序 _按钮5_被单击, 空白型, , 
.局部变量 次数, 整数型, , , 

.如果 (打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , , , , ))
    全部删除 ()
    .判断循环首 (等于 (查找 (等于 (读 (“班级”), 相加 (.内容, “班”))), 真))
        赋值 (次数, .插入表项 (读 (“年段”), , , , ))
        次数.置标题 (1, 读 (“专业”))
        次数.置标题 (2, 读 (“班级”))
        次数.置标题 (3, 读 (“姓名”))
        次数.置标题 (4, 读 (“性别”))
        次数.置标题 (5, 读 (“学号”))
        次数.置标题 (6, 读 (“地址”))
        次数.置标题 (7, 读 (“电话”))
        次数.置标题 (8, 读 (“辅导员”))
        次数.置标题 (9, 相加 (取文本左边 (读 (“栋号”), 相减 (取文本长度 (读 (“栋号”)), 2)), 取文本左边 (读 (“楼层号”), 相减 (取文本长度 (读 (“楼层号”)), 2)), 读 (“宿舍号”)))
        次数.置标题 (10, 读 (“备注”))
        赋值 (次数, 相加 (次数, 1))
        跳过 ()
    .判断循环尾 ()
    关闭 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
.否则
    信息框 (“错误没打开”, 0, )
.如果结束


.子程序 _按钮4_被单击, 空白型, , 
销毁 ()


.子程序 _按钮10_被单击, 空白型, , 
销毁 ()


.子程序 _按钮9_被单击, 空白型, , 
销毁 ()


.子程序 _按钮8_被单击, 空白型, , 
销毁 ()


.子程序 _按钮6_被单击, 空白型, , 
销毁 ()


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 清除数组重复成员, 文本型, , 清除数组中重复的值，让每个成员的值都是唯一的。这里返回一个文本，在调用处请用“分割文本（，）”命令将返回的文本还原成文本数组。
.参数 用户数组, 文本型, 数组, 用户欲清除重复成员的数组，只接受文本型数组变量。
.参数 间隔字符, 文本型, , 在过滤数组成员中要用到的分隔字符，在调用处分割本子程序返回的文本时也必须用此字符，所以此字符请勿与数组中的字符有相同的，以免出错。



.窗口程序集 窗口程序集9, , , 

.子程序 _按钮5_被单击, 空白型, , 
.如果真 (打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , , , , ))
    .如果 (等于 (.内容, “”))
        信息框 (“请输入要修改的学生名字！！”, 相加 (0, 48, 0), “友情提示”)
    .否则
        .如果 (等于 (查找 (等于 (读 (“姓名”), .内容)), 假))
            信息框 (“没有这个学生,请确定输入的姓名是否正确！！”, 相加 (0, 48, 0), “友情提示”)
            赋值 (.内容, “”)
            获取焦点 ()
        .否则
            赋值 (.内容, 读 (“学号”))
            赋值 (.内容, 读 (“姓名”))
            赋值 (.内容, 读 (“性别”))
            赋值 (.内容, 读 (“年段”))
            赋值 (.内容, 读 (“专业”))
            赋值 (.内容, 读 (“班级”))
            赋值 (.内容, 读 (“辅导员”))
            赋值 (.内容, 读 (“民族”))
            赋值 (.内容, 读 (“电话”))
            赋值 (.内容, 读 (“栋号”))
            赋值 (.内容, 读 (“楼层号”))
            赋值 (.内容, 读 (“宿舍号”))
            赋值 (.内容, 读 (“地址”))
            赋值 (.内容, 读 (“财产登记”))
            赋值 (.内容, 读 (“备注”))
        .如果结束
        
    .如果结束
    关闭 ()
.如果真结束


.子程序 _按钮2_被单击, 空白型, , 
.如果真 (打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , , , , ))
    .如果 (等于 (查找 (等于 (读 (“姓名”), .内容)), 假))
        信息框 (“姓名不能修改,”, 相加 (0, 48, 0), “友情提示”)
    .否则
        替换 (“学号”, .内容)
        替换 (“性别”, .内容)
        .如果真 (不等于 (取文本右边 (.内容, 2), “级”))
            赋值 (.内容, 相加 (.内容, “级”))
        .如果真结束
        替换 (“年段”, .内容)
        替换 (“专业”, .内容)
        替换 (“班级”, .内容)
        替换 (“辅导员”, .内容)
        替换 (“民族”, .内容)
        替换 (“电话”, .内容)
        .如果真 (不等于 (取文本右边 (.内容, 2), “栋”))
            赋值 (.内容, 相加 (.内容, “栋”))
        .如果真结束
        替换 (“栋号”, .内容)
        .如果真 (不等于 (取文本右边 (.内容, 2), “楼”))
            赋值 (.内容, 相加 (.内容, “楼”))
        .如果真结束
        替换 (“楼层号”, .内容)
        替换 (“宿舍号”, .内容)
        替换 (“地址”, .内容)
        替换 (“财产登记”, .内容)
        替换 (“备注”, .内容)
        信息框 (“此学生资料修改成功！！”, 相加 (0, 64, 0), “友情提示”)
        
    .如果结束
    关闭 ()
.如果真结束


.子程序 _按钮6_被单击, 空白型, , 
.如果真 (打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , , , , ))
    .如果 (等于 (.内容, “”))
        信息框 (“请输入要修改的学生学号！！”, 相加 (0, 48, 0), “友情提示”)
    .否则
        .如果 (等于 (查找 (等于 (读 (“学号”), .内容)), 假))
            信息框 (“没有这个学生,请确定输入的学号是否正确！！”, 相加 (0, 48, 0), “友情提示”)
            赋值 (.内容, “”)
            获取焦点 ()
        .否则
            赋值 (.内容, 读 (“学号”))
            赋值 (.内容, 读 (“姓名”))
            赋值 (.内容, 读 (“性别”))
            赋值 (.内容, 读 (“年段”))
            赋值 (.内容, 读 (“专业”))
            赋值 (.内容, 读 (“班级”))
            赋值 (.内容, 读 (“辅导员”))
            赋值 (.内容, 读 (“民族”))
            赋值 (.内容, 读 (“电话”))
            赋值 (.内容, 读 (“栋号”))
            赋值 (.内容, 读 (“楼层号”))
            赋值 (.内容, 读 (“宿舍号”))
            赋值 (.内容, 读 (“地址”))
            赋值 (.内容, 读 (“财产登记”))
            赋值 (.内容, 读 (“备注”))
        .如果结束
        
    .如果结束
    关闭 ()
.如果真结束


.子程序 _按钮9_被单击, 空白型, , 
.如果真 (打开 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), , , , , , ))
    查找 (等于 (读 (“学号”), .内容))
    删除 ()
    彻底删除 ()
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    获取焦点 ()
    关闭 ()
.如果真结束


.子程序 _按钮4_被单击, 空白型, , 
销毁 ()


.子程序 _按钮10_被单击, 空白型, , 
销毁 ()

.子程序 _资料修改窗口_创建完毕, 空白型, , 
.局部变量 索引, 整数型, , , 
.局部变量 记录数, 整数型, , , 


.如果 (等于 (是否已打开 (相加 (取运行目录 (), “\来访人员登记数据库.edb”)), 真))
    .判断循环首 (小于 (记录数, 取记录数 ()))
        赋值 (索引, .插入表项 (读 (“要访人姓名”), , , , ))
        索引.置标题 (1, 读 (“所属关系”))
        索引.置标题 (2, 读 (“来访人姓名”))
        索引.置标题 (3, 读 (“来访时间”))
        索引.置标题 (4, 读 (“结束时间”))
        索引.置标题 (5, 读 (“值班人”))
        索引.置标题 (6, 读 (“证件名称”))
        索引.置标题 (7, 读 (“备注”))
        跳过 ()
        赋值 (记录数, 相加 (记录数, 1))
    .判断循环尾 ()
    关闭 ()
    
.否则
    .如果 (等于 (打开 (相加 (取运行目录 (), “\来访人员登记数据库.edb”), , , , , , ), 真))
        .判断循环首 (小于 (记录数, 取记录数 ()))
            赋值 (索引, .插入表项 (读 (“要访人姓名”), , , , ))
            索引.置标题 (1, 读 (“所属关系”))
            索引.置标题 (2, 读 (“来访人姓名”))
            索引.置标题 (3, 读 (“来访时间”))
            索引.置标题 (4, 读 (“结束时间”))
            索引.置标题 (5, 读 (“值班人”))
            索引.置标题 (6, 读 (“证件名称”))
            索引.置标题 (7, 读 (“备注”))
            跳过 ()
            赋值 (记录数, 相加 (记录数, 1))
        .判断循环尾 ()
        关闭 ()
    .否则
        信息框 (“来访数据库打开失败”, 0, )
    .如果结束
    
.如果结束
.如果 (等于 (是否已打开 (相加 (取运行目录 (), “\离校登记数据库.edb”)), 真))
    赋值 (记录数, 0)
    .判断循环首 (小于 (记录数, 取记录数 ()))
        赋值 (索引, .插入表项 (读 (“姓名”), , , , ))
        索引.置标题 (1, 读 (“学生学号”))
        索引.置标题 (2, 读 (“性别”))
        索引.置标题 (3, 读 (“出楼货物”))
        索引.置标题 (4, 读 (“出楼时间”))
        索引.置标题 (5, 读 (“值班人”))
        索引.置标题 (6, 读 (“员工号”))
        索引.置标题 (7, 读 (“证件名称”))
        索引.置标题 (8, 读 (“备注”))
        跳过 ()
        赋值 (记录数, 相加 (记录数, 1))
    .判断循环尾 ()
    关闭 ()
    
.否则
    .如果 (等于 (打开 (相加 (取运行目录 (), “\离校登记数据库.edb”), , , , , , ), 真))
        赋值 (记录数, 0)
        .判断循环首 (小于 (记录数, 取记录数 ()))
            赋值 (索引, .插入表项 (读 (“姓名”), , , , ))
            索引.置标题 (1, 读 (“学生学号”))
            索引.置标题 (2, 读 (“性别”))
            索引.置标题 (3, 读 (“出楼货物”))
            索引.置标题 (4, 读 (“出楼时间”))
            索引.置标题 (5, 读 (“值班人”))
            索引.置标题 (6, 读 (“员工号”))
            索引.置标题 (7, 读 (“证件名称”))
            索引.置标题 (8, 读 (“备注”))
            跳过 ()
            赋值 (记录数, 相加 (记录数, 1))
        .判断循环尾 ()
        关闭 ()
    .否则
        信息框 (“学生数据库打开失败”, 0, )
    .如果结束
    
.如果结束


.子程序 _按钮3_被单击, 空白型, , 
.局部变量 替换数组, 文本型, , "8", 
.局部变量 被选的索引2, 整数型, , , 

.如果 (等于 (是否已打开 (相加 (取运行目录 (), “\来访人员登记数据库.edb”)), 假))
    .如果真 (打开 (相加 (取运行目录 (), “\来访人员登记数据库.edb”), , , , , , ))
        赋值 (被选的索引2, .)
        查找 (并且 (等于 (读 (“要访人姓名”), 被选的索引2.取标题 (0)), 等于 (读 (“所属关系”), 被选的索引2.取标题 (1)), 等于 (读 (“来访人姓名”), 被选的索引2.取标题 (2)), 等于 (读 (“来访时间”), 被选的索引2.取标题 (3)), 等于 (读 (“结束时间”), 被选的索引2.取标题 (4)), 等于 (读 (“值班人”), 被选的索引2.取标题 (5)), 等于 (读 (“证件名称”), 被选的索引2.取标题 (6)), 等于 (读 (“备注”), 被选的索引2.取标题 (7))))
        替换 (“要访人姓名”, .内容)
        替换 (“所属关系”, .内容)
        替换 (“来访人姓名”, .内容)
        替换 (“来访时间”, 到文本 (.今天))
        替换 (“结束时间”, 到文本 (.今天))
        替换 (“值班人”, .内容)
        替换 (“证件名称”, .内容)
        替换 (“备注”, .内容)
        被选的索引2.置标题 (0, .内容)
        被选的索引2.置标题 (1, .内容)
        被选的索引2.置标题 (2, .内容)
        被选的索引2.置标题 (3, 到文本 (.今天))
        被选的索引2.置标题 (4, 到文本 (.今天))
        被选的索引2.置标题 (5, .内容)
        被选的索引2.置标题 (6, .内容)
        被选的索引2.置标题 (7, .内容)
        信息框 (“来访登记修改成功”, 相加 (0, 64, 0), “友情提示”)
        关闭 ()
    .如果真结束
    
.否则
    置当前库 (相加 (取运行目录 (), “\来访人员登记数据库.edb”))
    到首记录 ()
    赋值 (被选的索引2, .)
    查找 (并且 (等于 (读 (“要访人姓名”), 被选的索引2.取标题 (0)), 等于 (读 (“所属关系”), 被选的索引2.取标题 (1)), 等于 (读 (“来访人姓名”), 被选的索引2.取标题 (2)), 等于 (读 (“来访时间”), 被选的索引2.取标题 (3)), 等于 (读 (“结束时间”), 被选的索引2.取标题 (4)), 等于 (读 (“值班人”), 被选的索引2.取标题 (5)), 等于 (读 (“证件名称”), 被选的索引2.取标题 (6)), 等于 (读 (“备注”), 被选的索引2.取标题 (7))))
    替换 (“要访人姓名”, .内容)
    替换 (“所属关系”, .内容)
    替换 (“来访人姓名”, .内容)
    替换 (“来访时间”, 到文本 (.今天))
    替换 (“结束时间”, 到文本 (.今天))
    替换 (“值班人”, .内容)
    替换 (“证件名称”, .内容)
    替换 (“备注”, .内容)
    被选的索引2.置标题 (0, .内容)
    被选的索引2.置标题 (1, .内容)
    被选的索引2.置标题 (2, .内容)
    被选的索引2.置标题 (3, 到文本 (.今天))
    被选的索引2.置标题 (4, 到文本 (.今天))
    被选的索引2.置标题 (5, .内容)
    被选的索引2.置标题 (6, .内容)
    被选的索引2.置标题 (7, .内容)
    信息框 (“来访登记修改成功”, 相加 (0, 64, 0), “友情提示”)
    关闭 ()
    
.如果结束


.子程序 _来访人员超级列表框_当前表项被改变, 空白型, , 
.局部变量 被选的索引, 整数型, , , 

.如果真 (打开 (相加 (取运行目录 (), “\来访人员登记数据库.edb”), , , , , , ))
    赋值 (被选的索引, .)
    赋值 (.内容, 被选的索引.取标题 (0))
    赋值 (.内容, 被选的索引.取标题 (1))
    赋值 (.内容, 被选的索引.取标题 (2))
    赋值 (.今天, 到时间 (被选的索引.取标题 (3)))
    赋值 (.今天, 到时间 (被选的索引.取标题 (4)))
    赋值 (.内容, 被选的索引.取标题 (5))
    赋值 (.内容, 被选的索引.取标题 (6))
    赋值 (.内容, 被选的索引.取标题 ())
    关闭 ()
.如果真结束


.子程序 _离校超级列表框_当前表项被改变, 空白型, , 
.局部变量 被选的索引2, 整数型, , , 

.如果真 (打开 (相加 (取运行目录 (), “\离校登记数据库.edb”), , , , , , ))
    赋值 (被选的索引2, .)
    赋值 (.内容, 被选的索引2.取标题 (0))
    赋值 (.内容, 被选的索引2.取标题 (1))
    赋值 (.内容, 被选的索引2.取标题 (2))
    赋值 (.内容, 被选的索引2.取标题 (3))
    赋值 (.今天, 到时间 (被选的索引2.取标题 (4)))
    赋值 (.内容, 被选的索引2.取标题 (5))
    赋值 (.内容, 被选的索引2.取标题 (6))
    赋值 (.内容, 被选的索引2.取标题 (7))
    赋值 (.内容, 被选的索引2.取标题 (8))
    关闭 ()
.如果真结束


.子程序 _按钮7_被单击, 空白型, , 
.局部变量 被选的索引3, 整数型, , , 

.如果真 (打开 (相加 (取运行目录 (), “\离校登记数据库.edb”), , , , , , ))
    赋值 (被选的索引3, .)
    查找 (并且 (等于 (读 (“姓名”), 被选的索引3.取标题 (0)), 等于 (读 (“学生学号”), 被选的索引3.取标题 (1)), 等于 (读 (“性别”), 被选的索引3.取标题 (2)), 等于 (读 (“出楼货物”), 被选的索引3.取标题 (3)), 等于 (读 (“出楼时间”), 被选的索引3.取标题 (4)), 等于 (读 (“值班人”), 被选的索引3.取标题 (5)), 等于 (读 (“员工号”), 被选的索引3.取标题 (6)), 等于 (读 (“证件名称”), 被选的索引3.取标题 (7)), 等于 (读 (“备注”), 被选的索引3.取标题 (8))))
    替换 (“姓名”, .内容)
    替换 (“学生学号”, .内容)
    替换 (“性别”, .内容)
    替换 (“出楼货物”, .内容)
    替换 (“出楼时间”, 到文本 (.今天))
    替换 (“值班人”, .内容)
    替换 (“员工号”, .内容)
    替换 (“证件名称”, .内容)
    替换 (“备注”, .内容)
    被选的索引3.置标题 (0, .内容)
    被选的索引3.置标题 (1, .内容)
    被选的索引3.置标题 (2, .内容)
    被选的索引3.置标题 (3, .内容)
    被选的索引3.置标题 (4, 到文本 (.今天))
    被选的索引3.置标题 (5, .内容)
    被选的索引3.置标题 (6, .内容)
    被选的索引3.置标题 (7, .内容)
    被选的索引3.置标题 (8, .内容)
    信息框 (“离校登记修改成功”, 相加 (0, 64, 0), “友情提示”)
    关闭 ()
.如果真结束


.子程序 _按钮11_被单击, 空白型, , 
销毁 ()


.窗口程序集 窗口程序集10, , , 

.子程序 _按钮3_被单击, 空白型, , 
.如果真 (打开 (相加 (取运行目录 (), “\来访人员登记数据库.edb”), , , , , , ))
    加空记录 ()
    写 (“要访人姓名”, .内容)
    写 (“所属关系”, .内容)
    写 (“来访人姓名”, .内容)
    写 (“来访时间”, 到文本 (.今天))
    写 (“结束时间”, 到文本 (.今天))
    写 (“值班人”, .内容)
    写 (“证件名称”, .内容)
    写 (“备注”, .内容)
    信息框 (“来访人员登记成功！！”, 相加 (0, 64, 0), “友情提示”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    获取焦点 ()
    关闭 ()
.如果真结束


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集11, , , 

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()


.子程序 _按钮1_被单击, 空白型, , 
写配置项 (相加 (取运行目录 (), “\用户配置.ini”), “水电费标准”, “水费”, .内容)
写配置项 (相加 (取运行目录 (), “\用户配置.ini”), “水电费标准”, “电费”, .内容)
信息框 (“水电费标准设置成功！！”, 相加 (0, 64, 0), “友情提示”)
赋值 (水费标准, .内容)
赋值 (电费标准, .内容)
获取焦点 ()


.子程序 _设置水电费标准_创建完毕, 空白型, , 
赋值 (.内容, 到文本 (读配置项 (相加 (取运行目录 (), “\用户配置.ini”), “水电费标准”, “水费”, 到文本 (0.8))))
赋值 (.起始选择位置, 0)
赋值 (.被选择字符数, 取文本长度 (.内容))
赋值 (.内容, 到文本 (读配置项 (相加 (取运行目录 (), “\用户配置.ini”), “水电费标准”, “电费”, 到文本 (0.6))))
赋值 (.起始选择位置, 0)
赋值 (.被选择字符数, 取文本长度 (.内容))
获取焦点 ()


.窗口程序集 窗口程序集12, , , 

.程序集变量 文件目录, 文本型, , , 
.程序集变量 是否成功, 逻辑型, , , 
.子程序 _按钮14_被单击, 空白型, , 
赋值 (文件目录, 未知支持库函数_2 (“请选择备份路径”, ))
.如果真 (不等于 (文件目录, “”))
    赋值 (文件目录, 选择 (不等于 (取文本右边 (文件目录, 1), “\”), 相加 (文件目录, “\”), 文件目录))
    赋值 (.内容, 文件目录)
.如果真结束


.子程序 _按钮1_被单击, 空白型, , 
复制文件 (相加 (取运行目录 (), “\学生注册信息数据库.edb”), 相加 (文件目录, “\学生注册信息数据库.edb”))
复制文件 (相加 (取运行目录 (), “\宿舍员工数据库.edb”), 相加 (文件目录, “\宿舍员工数据库.edb”))
复制文件 (相加 (取运行目录 (), “\离校登记数据库.edb”), 相加 (文件目录, “\离校登记数据库.edb”))
复制文件 (相加 (取运行目录 (), “\水电费数据库.edb”), 相加 (文件目录, “\水电费数据库.edb”))
复制文件 (相加 (取运行目录 (), “\公共财产维修数据库.edb”), 相加 (文件目录, “\公共财产维修数据库.edb”))
复制文件 (相加 (取运行目录 (), “\私有财产维修数据库.edb”), 相加 (文件目录, “\私有财产维修数据库.edb”))
复制文件 (相加 (取运行目录 (), “\来访人员登记数据库.edb”), 相加 (文件目录, “\来访人员登记数据库.edb”))
写配置项 (相加 (取运行目录 (), “\用户配置.ini”), “数据备份”, “备份文件名1”, 相加 (文件目录, “\学生注册信息数据库.edb”))
写配置项 (相加 (取运行目录 (), “\用户配置.ini”), “数据备份”, “备份文件名2”, 相加 (文件目录, “\宿舍员工数据库.edb”))
写配置项 (相加 (取运行目录 (), “\用户配置.ini”), “数据备份”, “备份文件名3”, 相加 (文件目录, “\离校登记数据库.edb”))
写配置项 (相加 (取运行目录 (), “\用户配置.ini”), “数据备份”, “备份文件名4”, 相加 (文件目录, “\水电费数据库.edb”))
写配置项 (相加 (取运行目录 (), “\用户配置.ini”), “数据备份”, “备份文件名5”, 相加 (文件目录, “\公共财产维修数据库.edb”))
写配置项 (相加 (取运行目录 (), “\用户配置.ini”), “数据备份”, “备份文件名6”, 相加 (文件目录, “\私有财产维修数据库.edb”))
写配置项 (相加 (取运行目录 (), “\用户配置.ini”), “数据备份”, “备份文件名7”, 相加 (文件目录, “\来访人员登记数据库.edb”))
信息框 (“数据备份完毕,要恢复是将备份文件导入即可！！”, 相加 (0, 64, 0), “信息提示”)


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()


.子程序 _数据备份窗口_创建完毕, 空白型, , 
.如果真 (打开 (相加 (取运行目录 (), “\管理员.edb”), , , , , , ))
    查找 (等于 (读 (“用户名”), 当前管理员))
    .如果真 (等于 (读 (“管理员类型”), “普通用户”))
        信息框 (“你没有权限进行系统数据的备份！！”, 相加 (0, 48, 0), “信息提示”)
        数据备份窗口.销毁 ()
        关闭 ()
        
    .如果真结束
    
.如果真结束


.窗口程序集 窗口程序集13, , , 

.程序集变量 文件目录, 文本型, , , 
.子程序 _数据还原窗口_创建完毕, 空白型, , 
.局部变量 配置节数组, 文本型, , "0", 
.局部变量 记录数, 整数型, , , 
.局部变量 数据备份名, 文本型, , , 

打开 (相加 (取运行目录 (), “\管理员.edb”), , , , , , )
查找 (等于 (读 (“用户名”), 当前管理员))
.如果 (等于 (读 (“管理员类型”), “普通用户”))
    信息框 (“你没有权限进行数据的还原”, 相加 (0, 48, 0), “信息提示”)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.禁止, 真)
    赋值 (.类型, 0)
    赋值 (.禁止, 真)
    赋值 (.类型, 1)
    关闭 ()
.否则
    赋值 (配置节数组, 取配置节名 (相加 (取运行目录 (), “\用户配置.ini”)))
    .判断循环首 (小于 (记录数, 取数组成员数 (配置节数组)))
        .如果真 (等于 (配置节数组 [相加 (记录数, 1)], “数据备份”))
            赋值 (数据备份名, 配置节数组 [相加 (记录数, 1)])
        .如果真结束
        赋值 (记录数, 相加 (记录数, 1))
    .判断循环尾 ()
    .如果 (等于 (数据备份名, “数据备份”))
        赋值 (.禁止, 假)
        赋值 (.禁止, 假)
        关闭 ()
    .否则
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
        赋值 (.禁止, 真)
        赋值 (.类型, 0)
        赋值 (.类型, 1)
        信息框 (“你还没有进行过数据的备份！！”, 相加 (0, 64, 0), “友情提示”)
        关闭 ()
    .如果结束
    
.如果结束
关闭 ()




.子程序 _关闭按钮_被单击, 空白型, , 
销毁 ()


.子程序 _浏览按钮_被单击, 空白型, , 
赋值 (文件目录, 未知支持库函数_2 (“请选择还原文件所在目录路径”, ))

.子程序 _自动还原按钮_被单击, 空白型, , 
删除文件 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
删除文件 (相加 (取运行目录 (), “\宿舍员工数据库.edb”))
删除文件 (相加 (取运行目录 (), “\离校登记数据库.edb”))
删除文件 (相加 (取运行目录 (), “\水电费数据库.edb”))
删除文件 (相加 (取运行目录 (), “\公共财产维修数据库.edb”))
删除文件 (相加 (取运行目录 (), “\私有财产维修数据库.edb”))
删除文件 (相加 (取运行目录 (), “\来访人员登记数据库.edb”))
复制文件 (读配置项 (相加 (取运行目录 (), “\用户配置.ini”), “数据备份”, “备份文件名1”, ), 相加 (取运行目录 (), “\学生注册信息数据库.edb”))
复制文件 (读配置项 (相加 (取运行目录 (), “\用户配置.ini”), “数据备份”, “备份文件名2”, ), 相加 (取运行目录 (), “\宿舍员工数据库.edb”))
复制文件 (读配置项 (相加 (取运行目录 (), “\用户配置.ini”), “数据备份”, “备份文件名3”, ), 相加 (取运行目录 (), “\离校登记数据库.edb”))
复制文件 (读配置项 (相加 (取运行目录 (), “\用户配置.ini”), “数据备份”, “备份文件名4”, ), 相加 (取运行目录 (), “\水电费数据库.edb”))
复制文件 (读配置项 (相加 (取运行目录 (), “\用户配置.ini”), “数据备份”, “备份文件名5”, ), 相加 (取运行目录 (), “\公共财产维修数据库.edb”))
复制文件 (读配置项 (相加 (取运行目录 (), “\用户配置.ini”), “数据备份”, “备份文件名6”, ), 相加 (取运行目录 (), “\私有财产维修数据库.edb”))
复制文件 (读配置项 (相加 (取运行目录 (), “\用户配置.ini”), “数据备份”, “备份文件名7”, ), 相加 (取运行目录 (), “\来访人员登记数据库.edb”))
信息框 (“自动系统数据还原成功！！”, 相加 (0, 64, 0), “友情提示”)


.子程序 _手动还原按钮_被单击, 空白型, , 
.如果真 (不等于 (文件目录, “”))
    赋值 (文件目录, 选择 (不等于 (取文本右边 (文件目录, 1), “\”), 相加 (文件目录, “\”), 文件目录))
    赋值 (.内容, 文件目录)
.如果真结束
删除文件 (相加 (取运行目录 (), “\学生注册信息数据库.edb”))
删除文件 (相加 (取运行目录 (), “\宿舍员工数据库.edb”))
删除文件 (相加 (取运行目录 (), “\离校登记数据库.edb”))
删除文件 (相加 (取运行目录 (), “\水电费数据库.edb”))
删除文件 (相加 (取运行目录 (), “\公共财产维修数据库.edb”))
删除文件 (相加 (取运行目录 (), “\私有财产维修数据库.edb”))
删除文件 (相加 (取运行目录 (), “\来访人员登记数据库.edb”))
复制文件 (相加 (文件目录, “\学生注册信息数据库.edb”), 相加 (取运行目录 (), “\学生注册信息数据库.edb”))
复制文件 (相加 (文件目录, “\宿舍员工数据库.edb”), 相加 (取运行目录 (), “\学生注册信息数据库.edb”))
复制文件 (相加 (文件目录, “\离校登记数据库.edb”), 相加 (取运行目录 (), “\学生注册信息数据库.edb”))
复制文件 (相加 (文件目录, “\水电费数据库.edb”), 相加 (取运行目录 (), “\学生注册信息数据库.edb”))
复制文件 (相加 (文件目录, “\公共财产维修数据库.edb”), 相加 (取运行目录 (), “\学生注册信息数据库.edb”))
复制文件 (相加 (文件目录, “\私有财产维修数据库.edb”), 相加 (取运行目录 (), “\学生注册信息数据库.edb”))
复制文件 (相加 (文件目录, “\来访人员登记数据库.edb”), 相加 (取运行目录 (), “\学生注册信息数据库.edb”))
信息框 (“手动系统数据还原成功！！”, 相加 (0, 64, 0), “友情提示”)


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 读易库到超级列表框, 空白型, , 
.参数 数据库名, 文本型, , 
.参数 密码, 文本型, 可空, 
.参数 超级列表框, 超级列表框, , 



.窗口程序集 窗口程序集14, , , 

.子程序 _超级按钮8_被单击, 空白型, , 
结束 ()


.子程序 _按钮1_被单击, 空白型, , 
销毁 ()


.子程序 _超级按钮1_被单击, 空白型, , 
_注册登记_被选择 ()
销毁 ()


.子程序 _超级按钮2_被单击, 空白型, , 
_学生资料_被选择 ()
销毁 ()


.子程序 _超级按钮5_被单击, 空白型, , 
_维修登记_被选择 ()
销毁 ()


.子程序 _超级按钮6_被单击, 空白型, , 
_水电费统计_被选择 ()
销毁 ()


.子程序 _超级按钮7_被单击, 空白型, , 
_公财登记_被选择 ()
销毁 ()


.子程序 _超级按钮3_被单击, 空白型, , 
_寝室管理_被选择 ()
销毁 ()


.子程序 _超级按钮4_被单击, 空白型, , 
_离校登记_被选择 ()
销毁 ()


.子程序 _超级按钮10_被单击, 空白型, , 
_来访登记_被选择 ()
销毁 ()


.子程序 _超级按钮9_被单击, 空白型, , 
_来访登记修改_被选择 ()
销毁 ()


.子程序 _超级按钮11_被单击, 空白型, , 
_察看离校记录_被选择 ()
销毁 ()


.子程序 _超级按钮12_被单击, 空白型, , 
_学生资料修改_被选择 ()
销毁 ()


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 改变分辨率, 空白型, , 
.参数 X, 整数型, , 800
.参数 Y, 整数型, , 600
.参数 颜色数, 整数型, , 8 16  24 32
.参数 刷新率, 整数型, , 75 85 100
.参数 是否测试, 逻辑型, , 如果选真 - > 程序关闭后返回原来的分辨率     



.子程序 当前分辨率, 文本型, , 


.子程序 所有分辨率, 文本型, , 
.参数 对象类型, 整数型, , 0:列表框  1:组合框   2:组合框和列表框
.参数 列表框, 列表框, 可空, 
.参数 组合框, 组合框, 可空, 



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 快速填充树型框, 空白型, , 快速填充树型框，自动过滤重复数据
.参数 数据库, 文本型, , 
.参数 数据库密码, 文本型, 可空, 
.参数 树形框, 树型框, , 
.参数 填充字段, 文本型, 数组, 按数组的先后顺序决定父子关系




 ' 不属于任何一个程序集、类模块的函数：
