 ' 文件类型：Windows模块源码

 ' 程序名称：热健注册
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库





.DLL命令 设置窗口信息_, 子程序指针, "user32", "SetWindowLongA", , 在窗口结构中为指定的窗口设置信息  指定数据的前一个值
    .参数 窗口句柄, 整数型, , hwnd，欲为其取得信息的窗口的句柄
    .参数 窗口信息值, 整数型, , nIndex，请参考GetWindowLong函数的nIndex参数的说明
    .参数 窗口过程新址, 子程序指针, , dwNewLong，由nIndex指定的窗口信息的新值

.DLL命令 发送消息返回_, 整数型, "user32.dll", "SendMessageCallbackA", , SendMessageCallback，该函数最大的特定是可以立即返回。目标窗口函数执行完毕后，会用回调函数的形式将结果返回Long，TRUE表示成功，FALSE表示失败。会设置GetLastError
    .参数 窗口句柄, 整数型, , hwnd，要接收消息的那个窗口的句柄
    .参数 消息标识符, 整数型, , wmsg，消息的标识符
    .参数 消息1, 整数型, , wParam，取决于消息
    .参数 消息2, 整数型, , lParam，取决于消息
    .参数 指定函数地址, 子程序指针, , lpResultCallBack，指定函数地址。在vb5中可用AddressOf操作符获得
    .参数 自定义值, 整数型, , dwData，用户自定义值

.DLL命令 注册热键_, 整数型, "user32.dll", "RegisterHotKey", , 
    .参数 窗口句柄, 整数型, , hWnd
    .参数 热键id, 整数型, , id
    .参数 功能键, 整数型, , fsModifiers
    .参数 主热键, 整数型, , vk

.DLL命令 呼叫窗口函数地址_, 整数型, "user32.dll", "CallWindowProcA", , 
    .参数 前一窗口函数地址, 子程序指针, , 
    .参数 窗口句柄, 整数型, , 
    .参数 消息值, 整数型, , 
    .参数 附加参数1, 整数型, , 
    .参数 附加参数2, 整数型, , 

.DLL命令 取消热键注册_, 整数型, "user32.dll", "UnregisterHotKey", , 
    .参数 窗口句柄, 整数型, , 
    .参数 热键id, 整数型, , 

.程序集 热健注册程序集, , , 

.程序集变量 默认窗口地址, 子程序指针, , , 
.程序集变量 热健处理程序, 子程序指针, , , 
.程序集变量 原窗口句柄, 整数型, , , 
.程序集变量 响应消息新程序, 子程序指针, , , 
.子程序 热健注册, 整数型, 公开, 
.参数 窗口句柄, 整数型, , 
.参数 功能健, 整数型, , 
.参数 主热健, 整数型, , 
.参数 热健处理子程序, 子程序指针, , 



.如果 (不等于 (注册热键_ (窗口句柄, 786, 功能健, 主热健), 0)) ' WM_HOTKEY = 786;当用户按下由REGISTERHOTKEY函数注册的热键时提交此消息
    
.否则
    返回 (0)
.如果结束
赋值 (默认窗口地址, 设置窗口信息_ (窗口句柄, -4, &响应消息新程序)) ' GWL_WNDPROC：为窗口过程设定一个新的地址 从原来由默认的窗口过程来处理消息变成由我们自己写的消息处理过程来处理消息。方法是使用SetWindowLong函数来取得默认窗口过程的地址，然后转向为我们自己写的窗口过程的地址，
赋值 (热健处理程序, 热健处理子程序)
赋值 (响应消息新程序, &响应消息新程序)
赋值 (原窗口句柄, 窗口句柄)
返回 (1)

.子程序 响应消息新程序, 整数型, , 
.参数 窗口句柄, 整数型, , 
.参数 消息号, 整数型, , 
.参数 消息参数1, 整数型, , 
.参数 消息参数2, 整数型, , 

.如果 (等于 (消息号, 786))
    返回 (发送消息返回_ (窗口句柄, 0, 0, 0, 热健处理程序, 0))
    
.否则
    返回 (呼叫窗口函数地址_ (默认窗口地址, 窗口句柄, 消息号, 消息参数1, 消息参数2)) ' 把不需要处理的消息传递给默认窗口处理程序，使窗口能正常响应消息
    
.如果结束


.子程序 热健注消, 整数型, 公开, 
.参数 窗口句柄, 整数型, , 

设置窗口信息_ (原窗口句柄, -4, 默认窗口地址) ' 窗口过程的地址恢复为默认值
返回 (取消热键注册_ (窗口句柄, 786))

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。



 ' 不属于任何一个程序集、类模块的函数：
