 ' 文件类型：Windows模块源码

 ' 程序名称：Mysql记录集查看工具1.0
 ' 程序描述：思想：就是传递一个mysql记录集，然后载入窗口显示出这个记录集类似在sqlyog里面查询后的结果，可以辅助调试mysql类的程序。
 ' 程序作者：世恒 葛喜
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：www.shteach.com
 ' 版权声明：欢迎大家学习使用
 ' 版本号：1.0
 ' 创建号：0.0

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 480
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' mysql 7F54B9CE8887428dBA9CEEB94CEF4C72 3 0 MySQL支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 2 0 扩展界面支持库二




.全局变量 全局_记录集, 整数型, , , 

.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码
_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
.局部变量 局部_MySql句柄, 整数型, , , 
.局部变量 局部_测试记录集, 整数型, , , 

 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。
赋值 (局部_MySql句柄, 未知支持库函数_1 (“127.0.0.1”, “root”, “root”, “mysql”, )) ' 请自己修改mysql相应配置
输出调试文本 (未知支持库函数_3 (局部_MySql句柄, “select * from user”)) ' 查询所有字段
赋值 (局部_测试记录集, 未知支持库函数_4 (局部_MySql句柄))
外部接口_查看Mysql记录集 (局部_测试记录集)
未知支持库函数_5 (局部_测试记录集)

.子程序 外部接口_查看Mysql记录集, 逻辑型, 公开, 思想：就是传递一个mysql记录集，然后载入窗口显示出这个记录集类似在sqlyog里面查询后的结果，可以辅助调试mysql类的程序。
.参数 参数_记录集, 整数型, , 

 ' 整体要求：
 ' ---------1、代码要符合教学中的规范，变量命名等；
 ' ---------2、默认显示前1000条记录，因为记录较多的话会等很久，可以通过翻页或者选择页面跳转查看其它记录，第一列可以默认加入一个记录序号列；
 ' ---------3、谁参与了可以发帖，自己把名字加到作者那里和主界面的状态条里面；
 ' ---------4、第一版就可以先保持这个界面和基本功能，但是大家可以有新的想法提出来发帖补充；
 ' ---------5、最终做好之后，我们整理一下发出去一个比较好用的查看工具，感谢大家的参与；
 ' ---------6、当然大前提是你应该会Mysql，以及用过其他的Mysql管理工具查询过数据，这样就可以理解我的意思；
 ' ---------7、本着自愿参与，主动参与和学习交流的原则去对待这个。
赋值 (全局_记录集, 参数_记录集)
.如果真 (等于 (参数_记录集, 0))
    信息框 (“查询结果记录集为零，无法查看！”, #错误图标, “出错”)
    返回 (假)
.如果真结束
载入 (窗口1, , 真)
返回 (真)


.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 


.窗口程序集 窗口程序集2, , , 

.程序集变量 程序集_记录总数, 整数型, , , 
.程序集变量 局部_文本, 文本型, , , 
.子程序 _窗口1_创建完毕, 空白型, , 
.局部变量 局部_列表, 字节集, , , 
.局部变量 局部_字段数量, 整数型, , , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_字段名, 文本型, , , 
.局部变量 局部_分页数量, 整数型, , , 

赋值 (., 相加 (“Mysql记录集查看工具-(当前记录集：”, 到文本 (全局_记录集), “)”))

赋值 (局部_字段数量, 未知支持库函数_14 (全局_记录集)) ' 取出字段数量
赋值 (., {  }) ' 清空表项

.判断循环首 (不等于 (取列数 (), 局部_字段数量)) ' 初始化列表数量，多退少补
    .如果 (大于 (取列数 (), 局部_字段数量))
        0.删除列 ()
    .否则
        0.插入列 ()
    .如果结束
    
.判断循环尾 ()

.计次循环首 (局部_字段数量, 局部_计次) ' 赋值列标题
    未知支持库函数_15 (全局_记录集, 相减 (局部_计次, 1), 局部_字段名)
    相减 (局部_计次, 1).置列标题 (局部_字段名)
    相减 (局部_计次, 1).置列宽 (相乘 (取文本长度 (局部_字段名), 10))
    
.计次循环尾 ()

赋值 (程序集_记录总数, 未知支持库函数_7 (全局_记录集)) ' 取出记录数量
赋值 (.标题, 相加 (“记录总数:”, 到文本 (程序集_记录总数))) ' 前台显示
连续赋值 (真, ., ., ., .) ' 先将按钮状态禁止
清空 () ' 数量清空
.如果真 (等于 (程序集_记录总数, 0))
    返回 ()
.如果真结束
赋值 (局部_分页数量, 相加 (整除 (程序集_记录总数, 1000), 1))

.计次循环首 (局部_分页数量, 局部_计次)
    相加 (“第 ”, 到文本 (局部_计次), “ 页”).加入项目 (局部_计次)
.计次循环尾 ()

赋值 (.现行选中项, 0)
_组合框_页数_列表项被选择 ()


.子程序 子程序_封装列表, 字节集, , 用字节集方式把数据集合起来然后用超级列表框显示
.参数 参数_列表内容, 文本型, , 
.参数 参数_列类型, 整数型, , 0为项目内容 1为子项目内容

.判断开始 (等于 (参数_列类型, 0))
    返回 (相加 ({ 0, 255, 255, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0 }, 到字节集 (参数_列表内容), { 0, 0 }))
.判断 (等于 (参数_列类型, 1))
    返回 (相加 ({ 1, 255, 255, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0 }, 到字节集 (参数_列表内容), { 0, 0 }))
.默认
    
.判断结束
返回 ({  })


.子程序 子程序_字节集方式填充, 空白型, , 收集成字节集的方式填充数据
.参数 参数_页面, 整数型, , 

.局部变量 局部_循环次数, 整数型, , , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_字段, 整数型, , , 
.局部变量 局部_列表项, 字节集, , , 

赋值 (局部_循环次数, 相减 (程序集_记录总数, 相乘 (参数_页面, 1000)))
.如果真 (大于 (局部_循环次数, 1000))
    赋值 (局部_循环次数, 1000)
.如果真结束
未知支持库函数_11 (全局_记录集, 相乘 (参数_页面, 1000))
.计次循环首 (局部_循环次数, 局部_计次)
    .计次循环首 (取列数 (), 局部_字段)
        未知支持库函数_6 (全局_记录集, 相减 (局部_字段, 1), 局部_文本)
        .如果 (等于 (局部_字段, 1))
            赋值 (局部_列表项, 相加 (局部_列表项, 子程序_封装列表 (局部_文本, 0)))
        .否则
            赋值 (局部_列表项, 相加 (局部_列表项, 子程序_封装列表 (局部_文本, 1)))
        .如果结束
        
    .计次循环尾 ()
    未知支持库函数_10 (全局_记录集)
.计次循环尾 ()
赋值 (., 局部_列表项)






.子程序 子程序_列表填充, 空白型, , ‘插入列表的方式填充数据
.参数 参数_页面, 整数型, , 

.局部变量 局部_循环次数, 整数型, , , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_字段, 整数型, , , 
.局部变量 局部_操作行, 整数型, , , 

赋值 (., {  })
赋值 (局部_循环次数, 相减 (程序集_记录总数, 相乘 (参数_页面, 1000)))

.如果真 (大于 (局部_循环次数, 1000))
    赋值 (局部_循环次数, 1000)
.如果真结束
未知支持库函数_11 (全局_记录集, 相乘 (参数_页面, 1000))
.计次循环首 (局部_循环次数, 局部_计次)
    未知支持库函数_6 (全局_记录集, 0, 局部_文本) ' 读出第一个字段内容
    赋值 (局部_操作行, .插入表项 (局部_文本, , , , ))
    .计次循环首 (相减 (取列数 (), 1), 局部_字段)
        未知支持库函数_6 (全局_记录集, 局部_字段, 局部_文本)
        局部_操作行.置标题 (局部_字段, 局部_文本)
    .计次循环尾 ()
    未知支持库函数_10 (全局_记录集)
.计次循环尾 ()


.子程序 _组合框_页数_列表项被选择, 空白型, , 
连续赋值 (假, ., ., ., .) ' 先将按钮禁止状态解除
赋值 (.禁止, 假)
.判断开始 (等于 (.现行选中项, 0)) ' 第一页
    连续赋值 (真, ., .) ' 首页与上一页不可以操作
.判断 (等于 (相减 (取项目数 (), .现行选中项), 1)) ' 最后一页
    连续赋值 (真, ., .) ' 尾页与下一页不可以操作
.默认
    
.判断结束
.如果真 (等于 (取项目数 (), 1)) ' 只有一页
    连续赋值 (真, ., ., ., .) ' 只有一页时不可以操作
    赋值 (.禁止, 真)
.如果真结束
 ' 启动线程 (&子程序_字节集方式填充, 组合框_页数.现行选中项, )'用字节集比较慢，不如直接插入

子程序_列表填充 (.现行选中项) ' 采用插入一条读取一条的方式


赋值 (.标题, 相加 (“页号:”, 到文本 (.取项目数值 (.现行选中项)), “/”, 到文本 (取项目数 ())))


.子程序 _超级按钮_首页_被单击, 空白型, , 
赋值 (.现行选中项, 0)
_组合框_页数_列表项被选择 ()


.子程序 _超级按钮_上一页_被单击, 空白型, , 
赋值 (.现行选中项, 相减 (.现行选中项, 1))
_组合框_页数_列表项被选择 ()


.子程序 _超级按钮_下一页_被单击, 空白型, , 
赋值 (.现行选中项, 相加 (.现行选中项, 1))
_组合框_页数_列表项被选择 ()


.子程序 _超级按钮_尾页_被单击, 空白型, , 
赋值 (.现行选中项, 相减 (取项目数 (), 1))
_组合框_页数_列表项被选择 ()


.子程序 _窗口1_尺寸被改变, 空白型, , 
赋值 (.倾斜, 相减 (取用户区宽度 (), .角度))
赋值 (.删除线, 相减 (取用户区高度 (), ., .高度, .加粗))
赋值 (.左边, 相减 (取用户区宽度 (), .宽度))
赋值 (.顶边, 相加 (.加粗, .删除线, 2))


 ' 不属于任何一个程序集、类模块的函数：
