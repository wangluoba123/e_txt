 ' 文件类型：Windows窗口程序

 ' 程序名称：2D时钟_皮肤版
 ' 程序描述：演示可以更换皮肤的动画框组件效果
 ' 程序作者：大连大有吴涛易语言软件开发有限公司
 ' 邮政编码：116001
 ' 联系地址：辽宁省大连市中山区人民路55号1409室
 ' 联系电话：(0411)88995831
 ' 传真号码：(0411)88995834
 ' 电子信箱：service@dywt.com.cn
 ' 主页地址：http://www.dywt.com.cn
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 300
    高度 = 300
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口_皮肤列表
    左边 = 50
    顶边 = 50
    宽度 = 182
    高度 = 179
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “皮肤列表”
    帮助文件名 = “”



.常量 常量_配置文件名, "“配置.ini”", , 
.常量 常量_皮肤文件夹名, "“skins”", , 
.图片 图片_正常, " ' 已保存到：D:\易语言学习\Data\2D时钟_皮肤版v1.1.e\图片_正常", , 
.图片 图片_焦点, " ' 已保存到：D:\易语言学习\Data\2D时钟_皮肤版v1.1.e\图片_焦点", , 
.图片 图片_按下, " ' 已保存到：D:\易语言学习\Data\2D时钟_皮肤版v1.1.e\图片_按下", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二




.全局变量 全局_运行目录, 文本型, , , 
.全局变量 全局_皮肤文件名, 文本型, , , 
.全局变量 全局_是否整点报时, 整数型, , , 

.窗口程序集 窗口程序集_启动窗口, , , 

.程序集变量 程序集_是否按下, 逻辑型, , , 
.程序集变量 程序集_横向位置, 整数型, , , 
.程序集变量 程序集_纵向位置, 整数型, , , 
.程序集变量 匿名程序集变量_44, 空白型, , , 
.程序集变量 程序集_标识_时针, 整数型, , , 
.程序集变量 程序集_标识_分针, 整数型, , , 
.程序集变量 程序集_标识_秒针, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (全局_运行目录, 取运行目录 ())
.如果真 (不等于 (取文本右边 (全局_运行目录, 1), “\”))
    赋值 (全局_运行目录, 相加 (全局_运行目录, “\”))
.如果真结束

子程序_读配置项 ()
_启动窗口.移动 (300, 300)

赋值 (程序集_标识_时针, .未知支持库函数_35 (0, 0, 真, ))
赋值 (程序集_标识_分针, .未知支持库函数_35 (0, 0, 真, ))
赋值 (程序集_标识_秒针, .未知支持库函数_35 (0, 0, 真, ))

子程序_设置皮肤 (程序集_标识_时针, 程序集_标识_分针, 程序集_标识_秒针)

 ' ///////////////////////先创调整宽高，后设置角度，顺序不能变动/////////////////
0.移动 (0, 300, 300)
0.移动 (0, 300, 300)
0.移动 (0, 300, 300)

_动画框_背景_自动旋转停止 (0)

.子程序 _动画框_背景_物体左键被按下, 空白型, , 
.参数 物体标识值, 整数型, , 

赋值 (程序集_是否按下, 真)
赋值 (程序集_横向位置, 取鼠标水平位置 ())
赋值 (程序集_纵向位置, 取鼠标垂直位置 ())

.子程序 _动画框_背景_物体左键被放开, 空白型, , 
.参数 物体标识值, 整数型, , 
.参数 已被按下物体, 整数型, , 

赋值 (程序集_是否按下, 假)

.子程序 _动画框_背景_动画框鼠标位置改变, 空白型, , 
.参数 横坐标, 整数型, , 
.参数 纵坐标, 整数型, , 
.参数 已被按下物体, 整数型, , 

.如果真 (等于 (程序集_是否按下, 真))
    赋值 (程序集_是否按下, 假)
     ' _启动窗口.移动 (_启动窗口.左边 ＋ 取鼠标水平位置 () － 程序集_横向位置, _启动窗口.顶边 ＋ 取鼠标垂直位置 () － 程序集_纵向位置, , )
    赋值 (程序集_是否按下, 真)
.如果真结束


.子程序 _动画框_背景_自动旋转停止, 空白型, , 
.参数 物体标识值, 整数型, , 

.局部变量 局部_现行时间, 日期时间型, , , 
.局部变量 局部_小时, 整数型, , , 
.局部变量 局部_分钟, 整数型, , , 
.局部变量 局部_秒, 整数型, , , 

赋值 (局部_现行时间, 取现行时间 ())
赋值 (局部_小时, 取小时 (局部_现行时间))
赋值 (局部_分钟, 取分钟 (局部_现行时间))
赋值 (局部_秒, 取秒 (局部_现行时间))
程序集_标识_时针.未知支持库函数_63 (相加 (相乘 (局部_小时, 30), 相乘 (局部_分钟, 0.5)))
程序集_标识_分针.未知支持库函数_63 (相乘 (局部_分钟, 6))
程序集_标识_秒针.未知支持库函数_63 (相乘 (局部_秒, 6))
.如果真 (并且 (等于 (局部_分钟, 0), 等于 (.选中, 真)))
    .未知支持库函数_35 (56, 96, 真, )
.如果真结束
程序集_标识_秒针.未知支持库函数_74 (6, 1000, , 相乘 (60, 1000))

.子程序 _动画框_背景_物体右键被放开, 空白型, , 
.参数 物体标识值, 整数型, , 

弹出菜单 ()

.子程序 _菜单_设置皮肤_被选择, 空白型, , 
载入 (窗口_皮肤列表, , 真)

.子程序 _菜单_整点报时_被选择, 空白型, , 
赋值 (.选中, 取反 (.选中))
赋值 (全局_是否整点报时, 选择 (等于 (.选中, 真), 1, 0))
子程序_写配置项 ()

.子程序 _菜单_退出_被选择, 空白型, , 
结束 ()

.程序集 程序集_功能程序集, , , 

.子程序 子程序_读配置项, 空白型, , 
赋值 (全局_皮肤文件名, 读配置项 (相加 (全局_运行目录, #常量_配置文件名), “配置”, “皮肤文件名”, “蓝色”))
赋值 (全局_是否整点报时, 到数值 (读配置项 (相加 (全局_运行目录, #常量_配置文件名), “配置”, “是否整点报时”, “0”)))
赋值 (_启动窗口..选中, 选择 (等于 (全局_是否整点报时, 0), 假, 真))

.子程序 子程序_写配置项, 空白型, , 
写配置项 (相加 (全局_运行目录, #常量_配置文件名), “配置”, “皮肤文件名”, 全局_皮肤文件名)
写配置项 (相加 (全局_运行目录, #常量_配置文件名), “配置”, “是否整点报时”, 到文本 (全局_是否整点报时))

.子程序 子程序_设置皮肤, 空白型, , 
.参数 参数_动画框, 未知类型0x20008, , 
.参数 参数_时针标识, 整数型, 参考, 
.参数 参数_分针标识, 整数型, 参考, 
.参数 参数_秒针标识, 整数型, 参考, 

赋值 (参数_动画框., 读入文件 (相加 (全局_运行目录, #常量_皮肤文件夹名, “\”, 全局_皮肤文件名, “\背景.gif”)))
_启动窗口.置外形图片 (参数_动画框., #白色)

参数_动画框.未知支持库函数_44 (参数_时针标识, 读入文件 (相加 (全局_运行目录, #常量_皮肤文件夹名, “\”, 全局_皮肤文件名, “\时针.gif”)), #白色)
参数_动画框.未知支持库函数_44 (参数_分针标识, 读入文件 (相加 (全局_运行目录, #常量_皮肤文件夹名, “\”, 全局_皮肤文件名, “\分针.gif”)), #白色)
参数_动画框.未知支持库函数_44 (参数_秒针标识, 读入文件 (相加 (全局_运行目录, #常量_皮肤文件夹名, “\”, 全局_皮肤文件名, “\秒针.gif”)), #白色)

.窗口程序集 窗口程序集_皮肤列表, , , 

.程序集变量 程序集_标识符_确定按钮, 整数型, , , 
.程序集变量 程序集_按钮类, 类_按钮类, , , 
.子程序 _窗口_皮肤列表_创建完毕, 空白型, , 
.局部变量 局部_文件名, 文本型, , , 

赋值 (程序集_标识符_确定按钮, .未知支持库函数_35 (0, 0, 真, ))
程序集_按钮类.方法_初始化 (#图片_正常, #图片_按下, #图片_焦点, 程序集_标识符_确定按钮)

赋值 (局部_文件名, 寻找文件 (相加 (全局_运行目录, #常量_皮肤文件夹名, “\*.*”), #子目录))
.判断循环首 (不等于 (局部_文件名, “”))
    .如果真 (并且 (不等于 (局部_文件名, “.”), 不等于 (局部_文件名, “..”)))
        局部_文件名.加入项目 ()
        .如果真 (等于 (全局_皮肤文件名, 局部_文件名))
            赋值 (.现行选中项, 相减 (取项目数 (), 1))
        .如果真结束
        
    .如果真结束
    赋值 (局部_文件名, 寻找文件 (#子目录))
.判断循环尾 ()

.子程序 _动画框1_物体左键被按下, 空白型, , 
.参数 物体标识值, 整数型, , 

程序集_按钮类.方法_物体左键被按下 (物体标识值)

.子程序 _动画框1_进入物体, 空白型, , 
.参数 物体标识值, 整数型, , 
.参数 已被按下物体, 整数型, , 

程序集_按钮类.方法_进入物体 (物体标识值, 已被按下物体)

.子程序 _动画框1_离开物体, 空白型, , 
.参数 物体标识值, 整数型, , 
.参数 已被按下物体, 整数型, , 

程序集_按钮类.方法_离开物体 (物体标识值, 已被按下物体)

.子程序 _动画框1_物体左键被放开, 空白型, , 
.参数 物体标识值, 整数型, , 
.参数 已被按下物体, 整数型, , 

程序集_按钮类.物体左键被放开 (物体标识值)
.如果真 (大于 (已被按下物体, 0))
    赋值 (全局_皮肤文件名, .取项目文本 (.现行选中项))
    子程序_写配置项 ()
    子程序_设置皮肤 (_启动窗口., _启动窗口., _启动窗口., _启动窗口.)
    销毁 ()
.如果真结束


.子程序 _列表框1_双击选择, 空白型, , 
_动画框1_物体左键被放开 (程序集_标识符_确定按钮, 程序集_标识符_确定按钮)

.类模块 类_按钮类, , , 请在创建动画物体后创建类

.程序集变量 私有_正常图片, 字节集, , , 
.程序集变量 私有_按下图片, 字节集, , , 
.程序集变量 私有_焦点图片, 字节集, , , 
.程序集变量 私有_动画框, 未知类型0x20008, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
 ' 动画框1.置图片 (程序集_确定按钮, 私有_正常图片, )

.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 方法_初始化, 空白型, , 
.参数 参数_动画框, 未知类型0x20008, , 
.参数 参数_正常图片, 字节集, , 
.参数 参数_按下图片, 字节集, , 
.参数 参数_焦点图片, 字节集, , 
.参数 参数_物体标识符, 整数型, , 
.参数 参数_透明色, 整数型, 可空, 

赋值 (私有_动画框, 参数_动画框)
赋值 (私有_正常图片, 参数_正常图片)
赋值 (私有_按下图片, 参数_按下图片)
赋值 (私有_焦点图片, 参数_焦点图片)
.如果真 (私有_动画框.未知支持库函数_40 (参数_物体标识符))
    .判断开始 (是否为空 (参数_透明色))
        私有_动画框.未知支持库函数_44 (参数_物体标识符, 私有_正常图片, )
    .默认
        私有_动画框.未知支持库函数_44 (参数_物体标识符, 私有_正常图片, 参数_透明色)
    .判断结束
    
.如果真结束


.子程序 方法_物体左键被按下, 空白型, , 
.参数 参数_物体标识值, 整数型, , 

.如果真 (大于 (参数_物体标识值, 0))
    私有_动画框.未知支持库函数_44 (参数_物体标识值, 私有_按下图片, )
.如果真结束


.子程序 物体左键被放开, 空白型, 公开, 
.参数 参数_物体标识值, 整数型, , 

.如果真 (大于 (参数_物体标识值, 0))
    私有_动画框.未知支持库函数_44 (参数_物体标识值, 私有_正常图片, )
.如果真结束


.子程序 方法_进入物体, 空白型, , 
.参数 参数_物体标识值, 整数型, , 
.参数 参数_已被按下物体, 整数型, , 

.判断开始 (大于 (参数_已被按下物体, 0)) ' 有物体被按下
    私有_动画框.未知支持库函数_44 (参数_已被按下物体, 私有_按下图片, )
.默认
    私有_动画框.未知支持库函数_44 (参数_物体标识值, 私有_焦点图片, )
.判断结束


.子程序 方法_离开物体, 空白型, , 
.参数 参数_物体标识值, 整数型, , 
.参数 参数_已被按下物体, 整数型, , 

私有_动画框.未知支持库函数_44 (参数_物体标识值, 私有_正常图片, )



 ' 不属于任何一个程序集、类模块的函数：
