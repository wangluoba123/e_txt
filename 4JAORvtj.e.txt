 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 465
    高度 = 484
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “数独游戏――Mgx制作”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一




.全局变量 九宫字典, 整数型, , "81", 

.窗口程序集 窗口程序集1, , , 

.程序集变量 数独, 数独类, , "81", 
.程序集变量 布局数组, 整数型, , "81", 
.子程序 __启动窗口_创建完毕, 空白型, , 
数独类初始化 ()

.子程序 数独类初始化, 空白型, , 生成各编辑框
.局部变量 行, 整数型, , , 
.局部变量 列, 整数型, , , 

.计次循环首 (9, 行)
    .计次循环首 (9, 列)
        数独.初始化 ( [相加 (相乘 (相减 (行, 1), 9), 列)], , 行, 列)
    .计次循环尾 ()
.计次循环尾 ()


.子程序 _按钮1_被单击, 空白型, , 
赋值 (.时钟周期, 0)
.如果真 (或者 (大于 (到数值 (.内容), 81), 小于 (到数值 (.内容), 0)))
    信息框 (“留空格数量只能在1至81之间～”, #警告图标, “Mgx提醒您”)
    获取焦点 ()
    返回 ()
.如果真结束
置布局 (到数值 (.内容))
赋值 (.标题, “0”)
赋值 (.时钟周期, 1000)

.子程序 置布局, 空白型, , 
.参数 空几格, 整数型, , 

.局部变量 循环变量, 整数型, , , 
.局部变量 tmp1, 整数型, , , 
.局部变量 tmp2, 整数型, , , 
.局部变量 临时变量, 整数型, , , 

数组清零 (布局数组)
.计次循环首 (9, 循环变量)
    赋值 (布局数组 [循环变量], 循环变量)
.计次循环尾 ()
置随机数种子 ()
.计次循环首 (100, 循环变量)
    赋值 (tmp1, 取随机数 (1, 9))
    赋值 (tmp2, 取随机数 (1, 9))
    .如果真 (不等于 (tmp1, tmp2))
        赋值 (临时变量, 布局数组 [tmp1])
        赋值 (布局数组 [tmp1], 布局数组 [tmp2])
        赋值 (布局数组 [tmp2], 临时变量)
    .如果真结束
    
.计次循环尾 ()
.判断循环首 (等于 (求解程序 (布局数组), 假)) ' 防止取出的随机布局无解
    置布局 (空几格)
.判断循环尾 ()
.计次循环首 ()
    赋值 (取随机数 (1, 81))
    .判断循环首 (等于 ( [0]))
        赋值 (取随机数 (1, 81))
    .判断循环尾 ()
    赋值 ( [0])
.计次循环尾 ()
.计次循环首 (81, )
    .未知函数_67175073 ( [)])

.子程序 求解程序, 逻辑型, , 
.参数 局势, 整数型, 数组, 

.局部变量 临时数组, 整数型, , "81", 
.局部变量 x, 整数型, , , 
.局部变量 是否有空, 逻辑型, , , 
.局部变量 第一个空位置, 整数型, , , 

复制数组 (临时数组, 局势)
赋值 (是否有空, 假)
.计次循环首 (81, x)
    .如果真 (等于 (临时数组 [x], 0))
        赋值 (是否有空, 真)
        赋值 (第一个空位置, x)
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
.如果 (是否有空)
    .计次循环首 (9, x)
        .如果 (可否填入 (临时数组, 第一个空位置, x))
            赋值 (临时数组 [第一个空位置], x)
            .如果真 (求解程序 (临时数组))
                赋值 (布局数组 [第一个空位置], x)
                返回 (真)
            .如果真结束
            
        .否则
            
        .如果结束
        
    .计次循环尾 ()
.否则
    返回 (真)
.如果结束
返回 (假)

.子程序 可否填入, 逻辑型, , 
.参数 局势, 整数型, 数组, 
.参数 填入位置, 整数型, , 
.参数 填入数, 整数型, , 

.局部变量 临时数组, 整数型, , "81", 
.局部变量 列, 空白型, , , 
.局部变量 行, 空白型, , , 
.局部变量 循环变量, 整数型, , , 
.局部变量 待判断索引, 整数型, , "20", 
.局部变量 循环变量2, 整数型, , , 
.局部变量 循环变量3, 整数型, , , 

复制数组 (临时数组, 局势)
赋值 (列, 数独.取列 ( [填入位置]))
赋值 (行, 数独.取行 ( [填入位置]))

.计次循环首 (9, 循环变量)
    .如果真 (并且 (不等于 (相加 (相乘 (相减 (行, 1), 9), 循环变量), 填入位置), 等于 (临时数组 [相加 (相乘 (相减 (行, 1), 9), 循环变量)], 填入数)))
        返回 (假)
    .如果真结束
    
.计次循环尾 ()

.计次循环首 (9, 循环变量)
    .如果真 (并且 (不等于 (相加 (列, 相乘 (相减 (循环变量, 1), 9)), 填入位置), 等于 (临时数组 [相加 (列, 相乘 (相减 (循环变量, 1), 9))], 填入数)))
        返回 (假)
    .如果真结束
    
.计次循环尾 ()
赋值 (九宫字典, { 1, 2, 3, 10, 11, 12, 19, 20, 21, 4, 5, 6, 13, 14, 15, 22, 23, 24, 7, 8, 9, 16, 17, 18, 25, 26, 27, 28, 29, 30, 37, 38, 39, 46, 47, 48, 31, 32, 33, 40, 41, 42, 49, 50, 51, 34, 35, 36, 43, 44, 45, 52, 53, 54, 55, 56, 57, 64, 65, 66, 73, 74, 75, 58, 59, 60, 67, 68, 69, 76, 77, 78, 61, 62, 63, 70, 71, 72, 79, 80, 81 })
重定义数组 (九宫字典, 真, 9, 9)
.计次循环首 (9, 循环变量)
    .计次循环首 (9, 循环变量2)
        .如果真 (等于 (填入位置, 九宫字典 [循环变量] [循环变量2]))
            .计次循环首 (9, 循环变量3)
                .如果真 (并且 (不等于 (九宫字典 [循环变量] [循环变量3], 填入位置), 等于 (临时数组 [九宫字典] [循环变量] [循环变量3], 填入数)))
                    返回 (假)
                .如果真结束
                
            .计次循环尾 ()
        .如果真结束
        
    .计次循环尾 ()
.计次循环尾 ()
返回 (真)


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 循环变量, 整数型, , , 
.局部变量 临时数组, 整数型, , "81", 

赋值 (.时钟周期, 0)
数组清零 (布局数组)
.计次循环首 (81, 循环变量)
    赋值 (临时数组 [循环变量], 数独.取值 ( [循环变量]))
.计次循环尾 ()
复制数组 (布局数组, 临时数组)
.如果真 (等于 (求解程序 (临时数组), 假))
    信息框 (“无解！”, 0, “Mgx提醒您”)
    返回 ()
.如果真结束
.计次循环首 (81, 循环变量)
    数独.置值 ( [循环变量], 布局数组 [循环变量])
.计次循环尾 ()

.子程序 _按钮3_被单击, 空白型, , 
.局部变量 循环变量, 整数型, , , 

.计次循环首 (81, 循环变量)
    数独.置值 ( [循环变量], 0)
.计次循环尾 ()


.子程序 _按钮4_被单击, 空白型, , 
.局部变量 循环变量, 整数型, , , 
.局部变量 文件号, 整数型, , , 

赋值 (.类型, 1)
赋值 (.标题, “保存数独文件”)
.如果真 (打开 ())
    数组清零 (布局数组)
    .计次循环首 (81, 循环变量)
        赋值 (布局数组 [循环变量], 数独.取值 ( [循环变量]))
    .计次循环尾 ()
    赋值 (文件号, 打开文件 (.文件名, 5, ))
    .如果真 (不等于 (文件号, 0))
        .如果真 (写出数据 (文件号, 布局数组))
            信息框 (“保存成功”, 0, )
            关闭文件 (文件号)
            返回 ()
        .如果真结束
        
    .如果真结束
    关闭文件 (文件号)
    信息框 (“保存失败”, 0, )
.如果真结束


.子程序 _按钮5_被单击, 空白型, , 
.局部变量 循环变量, 整数型, , , 
.局部变量 文件号, 整数型, , , 

赋值 (.时钟周期, 0)
赋值 (.类型, 0)
赋值 (.标题, “打开数独文件”)
.如果真 (打开 ())
    数组清零 (布局数组)
    赋值 (文件号, 打开文件 (.文件名, , ))
    .如果真 (不等于 (文件号, 0))
        .如果真 (读入数据 (文件号, 布局数组))
            .计次循环首 (81, 循环变量)
                数独.置值 ( [循环变量], 布局数组 [循环变量])
            .计次循环尾 ()
            赋值 (.时钟周期, 1000)
            关闭文件 (文件号)
            返回 ()
        .如果真结束
        
    .如果真结束
    关闭文件 (文件号)
    信息框 (“打开文件失败”, 0, )
    
.如果真结束


.子程序 _按钮6_被单击, 空白型, , 
信息框 (“Mgx,江西九江人.论谈用名:美女勿近,Mgx;联系QQ:61229757;主页:http://oosj.2000y.net”, 0, “关于数独”)


.子程序 _编辑框1_字符输入, 整数型, , 
.参数 字符代码, 整数型, , 

.局部变量 tmp, 编辑框, , , 
.局部变量 tmp2, 空白型, , , 
.局部变量 循环变量, 整数型, , , 

.如果真 (或者 (小于 (字符代码, 取代码 (“1”, )), 大于 (字符代码, 取代码 (“9”, ))))
    返回 ()
.如果真结束
赋值 (tmp, 取事件组件 ())
数组清零 (布局数组)
.计次循环首 (81, 循环变量)
    赋值 (布局数组 [循环变量], 数独.取值 ( [循环变量]))
.计次循环尾 ()
.如果 (等于 (可否填入 (布局数组, 到数值 (tmp.标记), 到数值 (字符 (字符代码))), 假))
    数独.置底色 ( [到数值 (tmp.标记)], #红色)
    赋值 (tmp.背景颜色, #红色)
.否则
    数独.置底色 ( [到数值 (tmp.标记)], 数独.取底色 ( [到数值 (tmp.标记)]))
    
.如果结束



.子程序 _编辑框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 tmp, 编辑框, , , 
.局部变量 索引, 整数型, , , 

赋值 (tmp, 取事件组件 ())
赋值 (索引, 到数值 (tmp.标记))
.判断开始 (等于 (键代码, 8))
    数独.置底色 ( [索引], 数独.取底色 ( [索引]))
    返回 (真)
.判断 (等于 (键代码, #左光标键))
    .判断循环首 (大于 (相减 (索引, 1), 0))
        .如果真 (数独.进入输入状态 ( [相减 (索引, 1)]))
            跳出循环 ()
        .如果真结束
        赋值 (索引, 相减 (索引, 1))
    .判断循环尾 ()
    返回 (真)
.判断 (等于 (键代码, #右光标键))
    .判断循环首 (小于或等于 (相加 (索引, 1), 81))
        .如果真 (数独.进入输入状态 ( [相加 (索引, 1)]))
            跳出循环 ()
        .如果真结束
        赋值 (索引, 相加 (索引, 1))
    .判断循环尾 ()
    返回 (真)
.判断 (等于 (键代码, #上光标键))
    .判断循环首 (大于 (相减 (索引, 9), 0))
        .如果真 (数独.进入输入状态 ( [相减 (索引, 9)]))
            跳出循环 ()
        .如果真结束
        赋值 (索引, 相减 (索引, 9))
    .判断循环尾 ()
    返回 (真)
.判断 (等于 (键代码, #下光标键))
    .判断循环首 (小于或等于 (相加 (索引, 9), 81))
        .如果真 (数独.进入输入状态 ( [相加 (索引, 9)]))
            跳出循环 ()
        .如果真结束
        赋值 (索引, 相加 (索引, 9))
    .判断循环尾 ()
    返回 (真)
    
.判断 (或者 (小于 (键代码, 取代码 (“1”, )), 大于 (键代码, 取代码 (“9”, ))))
    返回 (假)
.默认
    
.判断结束




.子程序 是否完成, 逻辑型, , 
.局部变量 循环变量, 整数型, , , 

.计次循环首 (81, 循环变量)
    .如果真 (数独.错误否 ( [循环变量]))
        返回 (假)
    .如果真结束
    
.计次循环尾 ()
返回 (真)


.子程序 是否最后一空, 逻辑型, , 
.局部变量 循环变量, 整数型, , , 
.局部变量 tmp, 整数型, , , 

赋值 (tmp, 0)
.计次循环首 (81, 循环变量)
    .如果真 (等于 (数独.取值 ( [循环变量]), 0))
        赋值 (tmp, 相加 (tmp, 1))
        .如果真 (大于 (tmp, 0))
            返回 (假)
        .如果真结束
        
    .如果真结束
    
.计次循环尾 ()
返回 (真)


.子程序 _时钟1_周期事件, 空白型, , 
赋值 (.标题, 到文本 (相加 (到数值 (.标题), 1)))
.如果真 (是否最后一空 ())
    .如果真 (是否完成 ())
        赋值 (.时钟周期, 0)
        信息框 (“你成功了～好厉害哟～！我爱死你了”, 0, )
    .如果真结束
    
.如果真结束


.子程序 __启动窗口_将被销毁, 空白型, , 
赋值 (.时钟周期, 0)

.子程序 _编辑框1_获得焦点, 空白型, , 
.局部变量 tmp, 编辑框, , , 
.局部变量 tmp2, 文本型, , , 
.局部变量 循环变量, 整数型, , , 

赋值 (tmp, 取事件组件 ())
.如果真 (不等于 (数独.取值 ( [到数值 (tmp.标记)]), 0))
    0.置文本 (“当前位置已填有数字！”)
    返回 ()
.如果真结束
.计次循环首 (81, 循环变量)
    赋值 (布局数组 [循环变量], 数独.取值 ( [循环变量]))
.计次循环尾 ()
赋值 (tmp2, “”)
.计次循环首 (9, 循环变量)
    .如果真 (可否填入 (布局数组, 到数值 (tmp.标记), 循环变量))
        赋值 (tmp2, 相加 (tmp2, 到文本 (循环变量)))
    .如果真结束
    
.计次循环尾 ()
.如果真 (不等于 (tmp2, “”))
    0.置文本 (相加 (“当前位置可选数字有：”, tmp2))
.如果真结束



.类模块 数独类, , , 

.程序集变量 显示编辑框, 编辑框, , , 
.程序集变量 行, 整数型, , , 
.程序集变量 列, 整数型, , , 
.程序集变量 底色, 整数型, , , 
.程序集变量 错误, 逻辑型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 初始化, 空白型, 公开, 
.参数 母编辑框, 编辑框, , 
.参数 参行, 空白型, , 
.参数 参列, 空白型, , 

.局部变量 循环变量, 整数型, , , 
.局部变量 ys, 整数型, , , 
.局部变量 循环变量2, 整数型, , , 

.如果真 (等于 (是否已创建 (显示编辑框), 假))
    复制窗口组件 (母编辑框, 显示编辑框)
.如果真结束
显示编辑框.移动 (相乘 (相减 (参列, 1), 40), 相乘 (相减 (参行, 1), 40), , )
赋值 (显示编辑框.可视, 真)
赋值 (显示编辑框.标记, 到文本 (相加 (相乘 (相减 (参行, 1), 9), 参列)))
赋值 (行, 参行)
赋值 (列, 参列)
赋值 (错误, 假)
置输入方式 (假)
赋值 (九宫字典, { 1, 2, 3, 10, 11, 12, 19, 20, 21, 4, 5, 6, 13, 14, 15, 22, 23, 24, 7, 8, 9, 16, 17, 18, 25, 26, 27, 28, 29, 30, 37, 38, 39, 46, 47, 48, 31, 32, 33, 40, 41, 42, 49, 50, 51, 34, 35, 36, 43, 44, 45, 52, 53, 54, 55, 56, 57, 64, 65, 66, 73, 74, 75, 58, 59, 60, 67, 68, 69, 76, 77, 78, 61, 62, 63, 70, 71, 72, 79, 80, 81 })
重定义数组 (九宫字典, 真, 9, 9)
.计次循环首 (9, 循环变量)
    赋值 (ys, 选择 (等于 (求余数 (循环变量, 2), 0), #白色, #天蓝))
    .计次循环首 (9, 循环变量2)
        .如果真 (等于 (相加 (相乘 (相减 (参行, 1), 9), 参列), 九宫字典 [循环变量] [循环变量2]))
            置底色 (ys)
            赋值 (底色, ys)
        .如果真结束
        
    .计次循环尾 ()
.计次循环尾 ()


.子程序 置值, 空白型, 公开, 
.参数 参值, 整数型, , 

.如果真 (等于 (参值, 0))
    赋值 (显示编辑框.内容, “”)
    置输入方式 (真)
    返回 ()
.如果真结束
置输入方式 (假)
赋值 (显示编辑框.内容, 到文本 (参值))


.子程序 取行, 整数型, 公开, 
返回 (行)


.子程序 取列, 整数型, 公开, 
返回 (列)


.子程序 置输入方式, 空白型, 公开, 
.参数 能否输入, 逻辑型, , 

.如果 (能否输入)
    赋值 (显示编辑框.禁止, 假)
.否则
    赋值 (显示编辑框.禁止, 真)
    
.如果结束


.子程序 置底色, 空白型, 公开, 
.参数 颜色值, 整数型, , 

赋值 (显示编辑框.背景颜色, 颜色值)
.如果 (等于 (颜色值, #红色))
    赋值 (错误, 真)
.否则
    赋值 (错误, 假)
.如果结束


.子程序 取值, 整数型, 公开, 
返回 (到数值 (显示编辑框.内容))


.子程序 错误否, 逻辑型, 公开, 
返回 (错误)

.子程序 取底色, 整数型, 公开, 
返回 (底色)


.子程序 进入输入状态, 逻辑型, 公开, 
.如果真 (等于 (显示编辑框.禁止, 真))
    返回 (假)
.如果真结束
显示编辑框.获取焦点 ()
赋值 (显示编辑框.被选择字符数, 1)
返回 (真)



 ' 不属于任何一个程序集、类模块的函数：
