 ' 文件类型：Windows窗口程序

 ' 程序名称：程序开发项目管理系统
 ' 程序描述：
 ' 程序作者：杨慧杰
 ' 邮政编码：050000
 ' 联系地址：石家庄市民族路69号王府井公寓731室
 ' 联系电话：013831100245
 ' 传真号码：03117863182
 ' 电子信箱：666@66608.com
 ' 主页地址：http://www.66608.com
 ' 版权声明：
 ' 版本号：1.1
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 640
    高度 = 537
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 新建项目窗口
    左边 = 50
    顶边 = 50
    宽度 = 369
    高度 = 389
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “新建项目”
    帮助文件名 = “”

窗口 询问删除
    左边 = 50
    顶边 = 50
    宽度 = 274
    高度 = 125
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 更新项目窗口
    左边 = 50
    顶边 = 50
    宽度 = 369
    高度 = 423
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “更新项目”
    帮助文件名 = “”

窗口 关联项目窗口
    左边 = 50
    顶边 = 50
    宽度 = 270
    高度 = 361
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关联项目”
    帮助文件名 = “”

窗口 系统设置窗口
    左边 = 50
    顶边 = 50
    宽度 = 401
    高度 = 433
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “系统设置”
    帮助文件名 = “”

窗口 新建类型窗口
    左边 = 50
    顶边 = 50
    宽度 = 326
    高度 = 178
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “新建项目类型”
    帮助文件名 = “”

窗口 增加工具窗口
    左边 = 50
    顶边 = 50
    宽度 = 359
    高度 = 223
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 查看工具备注窗口
    左边 = 50
    顶边 = 50
    宽度 = 358
    高度 = 390
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 数据库窗口
    左边 = 50
    顶边 = 50
    宽度 = 388
    高度 = 119
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “数据库”
    帮助文件名 = “”

窗口 登陆窗口
    左边 = 50
    顶边 = 50
    宽度 = 360
    高度 = 213
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 选择执行程序窗口
    左边 = 50
    顶边 = 50
    宽度 = 237
    高度 = 278
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “选择执行程序”
    帮助文件名 = “”

窗口 已执行窗口
    左边 = 0
    顶边 = 30
    宽度 = 215
    高度 = 275
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 0
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 真
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “已执行项目”
    帮助文件名 = “”

窗口 设计向导窗口
    左边 = 50
    顶边 = 50
    宽度 = 386
    高度 = 449
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “设计向导”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 373
    高度 = 229
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于”
    帮助文件名 = “”



.声音 删除声音, " ' 已保存到：D:\易语言学习\Data\项目管理.e\删除声音", , 
.声音 单击声音, " ' 已保存到：D:\易语言学习\Data\项目管理.e\单击声音", , 
.图片 数据库1, " ' 已保存到：D:\易语言学习\Data\项目管理.e\数据库1", , 
.图片 数据库2, " ' 已保存到：D:\易语言学习\Data\项目管理.e\数据库2", , 
.图片 网站, " ' 已保存到：D:\易语言学习\Data\项目管理.e\网站", , 
.图片 无图程序, " ' 已保存到：D:\易语言学习\Data\项目管理.e\无图程序", , 
.图片 项目, " ' 已保存到：D:\易语言学习\Data\项目管理.e\项目", , 
.常量 软件名称, "“程序开发项目管理系统”", , 
.常量 版本, "“1.1”", , 
.常量 项目数据库, "“DATA\DB.EDB”", , 
.常量 项目类型数据库, "“data\type.edb”", , 
.常量 工具数据库, "“data\tool.edb”", , 
.常量 密码数据库, "“data\np.edb”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 7 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 1 扩展界面支持库一
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库
 ' eCompress 7B68736E818E41c5A28B0AE4D43C128C 1 0 压缩解压支持库




数据类型 超级列表框背景图片, , 
    .成员 应用, 整数型, , , 0为清除
    .成员 hBmp, 整数型, , , 
    .成员 图片, 文本型, , , 图片路径
    .成员 cchImageMax, 整数型, , , 另外一个代码的这里是路径长度+1
    .成员 横向百分比, 整数型, , , 
    .成员 纵向百分比, 整数型, , , 

.全局变量 是否不自动编号, 逻辑型, , , 
.全局变量 是否取消必须导入文件包, 逻辑型, , , 
.全局变量 匿名全局变量_600, 空白型, , , 
.全局变量 编辑工具, 逻辑型, , , 

.DLL命令 发送消息, 整数型, "", "SendMessageA", , 
    .参数 窗口句柄, 整数型, , 
    .参数 信息值, 整数型, , 
    .参数 参数一, 整数型, , 
    .参数 参数二, 超级列表框背景图片, , 

.窗口程序集 启动窗口程序集, , , 

.程序集变量 当前记录号, 整数型, , , 
.程序集变量 方式, 整数型, , , 0项目规划，1bug报告，2升级历史
.程序集变量 选择执行程序目录, 文本型, , , 
.程序集变量 执行程序, 文本型, , , 
.子程序 __启动窗口_尺寸被改变, 空白型, , 
5.移动 (5, 150, 相减 (取用户区高度 (), 30))
相加 (.左边, .宽度).移动 (.顶边, 相减 (取用户区宽度 (), .左边, .宽度), .高度)
1.移动 (1, .宽度, .高度)
5.移动 (0, 相减 (.宽度, 10), .高度)
5.移动 (30, 相减 (.宽度, 10), 相减 (.高度, 30))
5.移动 (24, .倾斜, 相减 (.高度, 24))
赋值 (., 相减 (.宽度, ., 8))
赋值 (., 相减 (.宽度, ., ., 8))
赋值 (., .)
设置按钮 ()

.子程序 __启动窗口_创建完毕, 空白型, , 
载入 (登陆窗口, , 真)
赋值 (.标题, 读配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “Title”, #软件名称))
状态条显示 (0, #软件名称)
状态条显示 (2, 相加 (“程序版本：”, #版本))
赋值 (., 到数值 (读配置项 (相加 (取运行目录 (), “\Install.ini”), “Install”, “TL”, )))
读取配置 ()
读取项目列表 (_启动窗口.)
赋值 (.现行子夹, 到数值 (读配置项 (相加 (取运行目录 (), “\Install.ini”), “Install”, “Ts”, “0”)))

.子程序 _添加按钮_被单击, 空白型, , 
新建项目 ()

.子程序 _删除按钮_被单击, 空白型, , 
删除项目 ()

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _设计规划按钮_被单击, 空白型, , 
赋值 (.输入方式, 0)
赋值 (.内容, “设计规划：”)
初始编辑框 (0, 14)

.子程序 _返回按钮2_被单击, 空白型, , 
赋值 (.输入方式, 0)
赋值 (.现行子夹, 0)

.子程序 _辅助项目框_内容被改变, 空白型, , 
.如果真 (等于 (方式, 3))
    返回 ()
.如果真结束
.如果真 (写辅助 (#项目数据库, 当前记录号, 方式, .内容))
    返回 ()
.如果真结束
数据库失败了 ()

.子程序 _bug按钮_被单击, 空白型, , 
赋值 (.输入方式, 0)
赋值 (.内容, “BUG报告：”)
初始编辑框 (1, 11)

.子程序 初始编辑框, 空白型, , 
.参数 方式2, 整数型, , 
.参数 字段, 整数型, , 

.如果真 (是否已选择 ())
    赋值 (方式, 方式2)
    打开 (#项目数据库, , , , , , )
    赋值 (当前记录号, .取表项数值 (.))
    跳到 (当前记录号)
    赋值 (.内容, 读 (字段))
    全部关闭 ()
    赋值 (.现行子夹, 1)
.如果真结束


.子程序 _升级历史按钮_被单击, 空白型, , 
赋值 (.输入方式, 0)
赋值 (.内容, “升级历史：”)
初始编辑框 (2, 10)

.子程序 _更新按钮_被单击, 空白型, , 
.如果真 (是否已选择 ())
    载入 (更新项目窗口, , 真)
    读取项目列表 (_启动窗口.)
.如果真结束


.子程序 _导出按钮_被单击, 空白型, , 
.如果真 (是否已选择 ())
    导出 (#项目数据库, .取表项数值 (.), )
.如果真结束


.子程序 _程序列表框_右键单击表项, 空白型, , 
.如果 (等于 (., -1))
    连续赋值 (真, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
.否则
    连续赋值 (假, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止, .禁止)
.如果结束
弹出菜单 ()

.子程序 _添加项目_被选择, 空白型, , 
_添加按钮_被单击 ()

.子程序 _删除项目_被选择, 空白型, , 
_删除按钮_被单击 ()

.子程序 _更新_被选择, 空白型, , 
_更新按钮_被单击 ()

.子程序 _导出项目_被选择, 空白型, , 
_导出按钮_被单击 ()

.子程序 _详细信息_被选择, 空白型, , 
_详细信息按钮_被单击 ()

.子程序 _详细信息按钮_被单击, 空白型, , 
.如果真 (是否已选择 ())
    赋值 (方式, 3)
    赋值 (.现行子夹, 1)
    赋值 (.内容, 详细信息 (.取表项数值 (.)))
    赋值 (.输入方式, 1)
    赋值 (.内容, “详细信息：”)
    全部关闭 ()
.如果真结束


.子程序 _设计规划_被选择, 空白型, , 
_设计规划按钮_被单击 ()

.子程序 _BUG报告_被选择, 空白型, , 
_bug按钮_被单击 ()

.子程序 _升级历史_被选择, 空白型, , 
_升级历史按钮_被单击 ()

.子程序 _查看关联项目_被选择, 空白型, , 
_关联项目按钮_被单击 ()

.子程序 _关联项目按钮_被单击, 空白型, , 
.如果真 (是否已选择 ())
    载入 (关联项目窗口, , 真)
.如果真结束


.子程序 __启动窗口_被激活, 空白型, , 
连续赋值 (假, .字体大小, .字体大小)
连续赋值 (真, .字体大小, .字体大小)

.子程序 _写出按钮_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (“无可保存内容！”, 48, )
    返回 ()
.如果真结束
赋值 (.文件名, 相加 (.取标题 (., ), “ ”, 取文本左边 (.内容, 相减 (取文本长度 (.内容), 2))))
.如果真 (打开 ())
    .如果真 (写到文件 (.文件名, 到字节集 (相加 (.内容, #换行符, #换行符, #换行符, “------------------------------------------------------------------”, #换行符, 到文本 (取现行时间 ())))))
        改变目录 (取运行目录 ())
        返回 ()
    .如果真结束
    信息框 (“写到文件失败！”, 16, )
.如果真结束
改变目录 (取运行目录 ())

.子程序 _程序列表框_表项被激活, 空白型, , 
_执行按钮_被单击 ()

.子程序 _项目配置分类按钮_被单击, 空白型, , 
赋值 (.现行子夹, 1)
设置按钮 ()

.子程序 _系统工具分类按钮2_被单击, 空白型, , 
赋值 (.现行子夹, 3)
设置按钮 ()

.子程序 _项目管理分类按钮2_被单击, 空白型, , 
连续赋值 (0, .现行子夹, .现行子夹)
设置按钮 ()

.子程序 _项目管理分类按钮3_被单击, 空白型, , 
连续赋值 (0, .现行子夹, .现行子夹)
设置按钮 ()

.子程序 _项目配置分类按钮3_被单击, 空白型, , 
赋值 (.现行子夹, 1)
设置按钮 ()

.子程序 _系统工具分类按钮_被单击, 空白型, , 
赋值 (.现行子夹, 2)
设置按钮 ()

.子程序 设置按钮, 空白型, , 
播放音乐 (#单击声音, )
.判断开始 (等于 (.现行子夹, 0))
    赋值 (., 相减 (.高度, ., 2))
    赋值 (., 相减 (., ., 1))
.判断 (等于 (.现行子夹, 1))
    赋值 (., 相减 (.高度, ., 2))
    
.默认
    
.判断结束
赋值 (.可视, 假)
赋值 (.可视, 真)

.子程序 _顶对齐_被选择, 空白型, , 
赋值 (., 0)
读取项目列表 (_启动窗口.)

.子程序 _左对齐_被选择, 空白型, , 
赋值 (., 1)
读取项目列表 (_启动窗口.)

.子程序 _系统配置按钮_被单击, 空白型, , 
载入 (系统设置窗口, , 真)

.子程序 _项目管理分类按钮_被单击, 空白型, , 
赋值 (.现行子夹, 0)
设置按钮 ()

.子程序 _执行按钮_被单击, 空白型, , 
.局部变量 程序编号, 文本型, , , 
.局部变量 程序, 文本型, , , 
.局部变量 运行目录, 文本型, , , 
.局部变量 扩展名, 文本型, , , 
.局部变量 是否为zip, 逻辑型, , , 
.局部变量 非zip程序, 文本型, , , 
.局部变量 加入到已执行窗口内容, 文本型, , , 

.如果真 (是否已选择 ())
    打开 (#项目数据库, , , , , , )
    跳到 (.取表项数值 (.))
    赋值 (程序编号, 读 (1))
    赋值 (程序, 相加 (取运行目录 (), “\data\”, 程序编号, “.fd1”))
    赋值 (扩展名, 读 (9))
    全部关闭 ()
     ' 取得程序路径
    
    赋值 (运行目录, 读配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “dir”, ))
    .如果真 (等于 (删全部空 (运行目录), “”))
        信息框 (“您所指定的执行目录无效，请在系统设置中重新指定！”, 48, )
        返回 ()
    .如果真结束
    .如果 (不等于 (取文本右边 (运行目录, 1), “\”))
        赋值 (运行目录, 相加 (运行目录, “\”))
    .否则
        
    .如果结束
    赋值 (非zip程序, 相加 (运行目录, 程序编号, “\”, 程序编号, “.”, 扩展名))
     ' 基本信息读取结束
    
    .如果 (等于 (创建目录 (相加 (运行目录, 程序编号)), 假))
        信息框 (相加 (“创建程序目录失败，可能有以下原因：”, #换行符, #换行符, “  1.您所指定的程序执行目录无效”, #换行符, “  2.当前已存在该文件目录，请执行程序更新”, #换行符, “  3.磁盘具有只读属性”), 48, )
         ' 创建目录失败返回
        返回 ()
    .否则
        .如果 (等于 (到小写 (扩展名), “zip”)) ' 判断是否为可解压缩的zip文件
            .如果 (不等于 (程序.未知支持库函数_2 (相加 (运行目录, 程序编号)), 1))
                信息框 (“解压程序文件包失败！”, 16, )
                返回 ()
            .否则
                写到文件 (相加 (运行目录, 程序编号, “\P_zip.TMP”), {  })
                赋值 (是否为zip, 真)
                 ' 如果为zip文件就做一个标记
            .如果结束
            
        .否则
            .如果真 (取反 (复制文件 (程序, 非zip程序)))
                信息框 (“复制文件出错！”, 16, )
                返回 ()
            .如果真结束
            
        .如果结束
        .如果 (等于 (是否为zip, 真))
            赋值 (选择执行程序目录, 相加 (运行目录, 程序编号))
            载入 (选择执行程序窗口, , 真)
            赋值 (加入到已执行窗口内容, 相加 (选择执行程序目录, “(zip)”))
             ' 选择zip文件内的执行文件
        .否则
            连续赋值 (非zip程序, 执行程序, 加入到已执行窗口内容)
        .如果结束
        .如果真 (等于 (执行程序, “”))
            删除目录 (相加 (运行目录, 程序编号))
            返回 ()
        .如果真结束
        未知支持库函数_6 (执行程序, , )
        赋值 (执行程序, “”)
        .如果真 (取反 (是否已创建 (已执行窗口)))
            载入 (已执行窗口, , 假)
        .如果真结束
        已执行窗口.插入表项 (., , 加入到已执行窗口内容, , , , )
    .如果结束
    
.如果真结束


.子程序 _工具资源按钮_被单击, 空白型, , 
置等待鼠标 ()
处理事件 ()
读取工具 (#工具数据库, _启动窗口.)
恢复鼠标 ()
赋值 (.现行子夹, 2)

.子程序 _新建工具按钮_被单击, 空白型, , 
赋值 (编辑工具, 假)
载入 (增加工具窗口, , 真)

.子程序 _工具列表框_表项被激活, 空白型, , 
打开 (#工具数据库, , , , , , )
跳到 (.取表项数值 (.))
未知支持库函数_6 (读 (2), , )
全部关闭 ()

.子程序 _删除工具按钮_被单击, 空白型, , 
.局部变量 次数, 空白型, , , 

.如果真 (等于 (., -1))
    信息框 (“请选择您要删除的工具或资源！”, 48, )
    返回 ()
.如果真结束
打开 (#工具数据库, , , , , , )
.如果真 (等于 (信息框 (“您确定要删除所选定的工具或资源吗？”, 292, ), 5))
    .计次循环首 (取表项数 (), 次数)
        .如果真 (相减 (次数, 1).是否被选择 ())
            跳到 (次数)
            删除 ()
        .如果真结束
        
    .计次循环尾 ()
    彻底删除 ()
    全部关闭 ()
    读取工具 (#工具数据库, _启动窗口.)
.如果真结束
全部关闭 ()

.子程序 _工具备注按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    信息框 (“请选择您要查看的工具或资源项目！”, 48, )
    返回 ()
.如果真结束
载入 (查看工具备注窗口, , 真)

.子程序 _返回按钮_被单击, 空白型, , 
赋值 (.现行子夹, 0)
设置按钮 ()

.子程序 _工具列表框_右键单击表项, 空白型, , 
.如果 (等于 (., -1))
    连续赋值 (真, .禁止, .禁止)
.否则
    连续赋值 (假, .禁止, .禁止)
.如果结束
弹出菜单 ()

.子程序 _增加工具或资源_被选择, 空白型, , 
_新建工具按钮_被单击 ()

.子程序 _删除所选择工具资源项目_被选择, 空白型, , 
_删除工具按钮_被单击 ()

.子程序 _查看备注_被选择, 空白型, , 
_工具备注按钮_被单击 ()

.子程序 _切换到工具或资源面板_被选择, 空白型, , 
_工具资源按钮_被单击 ()

.子程序 _返回到项目列表_被选择, 空白型, , 
赋值 (.现行子夹, 0)
设置按钮 ()

.子程序 _路径_被选择, 空白型, , 
.如果真 (等于 (., -1))
    信息框 (“请选择您要查看的工具或资源项目！”, 48, )
    返回 ()
.如果真结束
显示表项路径 ()

.子程序 _编辑工具按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    信息框 (“请选择您要编辑的工具或资源！”, 48, )
    返回 ()
.如果真结束
赋值 (编辑工具, 真)
载入 (增加工具窗口, , 真)

.子程序 _编辑工具或资源_被选择, 空白型, , 
_编辑工具按钮_被单击 ()

.子程序 __启动窗口_将被销毁, 空白型, , 
写配置项 (相加 (取运行目录 (), “\Install.ini”), “Install”, “Ts”, 到文本 (.现行子夹))
写配置项 (相加 (取运行目录 (), “\Install.ini”), “Install”, “TL”, 到文本 (.))

.子程序 _数据库按钮_被单击, 空白型, , 
载入 (数据库窗口, , 真)

.子程序 _关于按钮_被单击, 空白型, , 
未知支持库函数_6 (相加 (取运行目录 (), “\程序开发项目管理系统使用帮助文档.doc”), , )

.子程序 _程序列表框_当前表项被改变, 空白型, , 
状态条显示 (4, “就绪”)
.如果真 (不等于 (., -1))
    状态条显示 (4, 取项目最后更新 (#项目数据库, .取表项数值 (.)))
.如果真结束


.子程序 _执行_被选择, 空白型, , 
_执行按钮_被单击 ()

.子程序 _程序列表框_左键单击表项, 空白型, , 
_程序列表框_当前表项被改变 ()

.子程序 _工具列表框_当前表项被改变, 空白型, , 
.如果真 (等于 (., -1))
    状态条显示 (4, “就绪”)
    返回 ()
.如果真结束
打开 (#工具数据库, , , , , , )
跳到 (.取表项数值 (.))
状态条显示 (4, 读 (2))
全部关闭 ()

.子程序 _工具列表框_左键单击表项, 空白型, , 
_工具列表框_当前表项被改变 ()

.子程序 _添加按钮1_被单击, 空白型, , 
开发向导 ()

.子程序 _关于按钮1_被单击, 空白型, , 
载入 (关于窗口, , 真)


.窗口程序集 新建项目程序集, , , 

.子程序 _确定按钮_被单击, 空白型, , 
.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“填写不完整！”, 48, )
    返回 ()
.如果真结束
.如果 (是否取消必须导入文件包)
    打开 (#项目数据库, , , , , , )
    .如果真 (查找 (等于 (.内容, 读 (1))))
        全部关闭 ()
        信息框 (“已存在相同编号！”, 16, )
        返回 ()
    .如果真结束
    加新记录 ()
    全部关闭 ()
    初始化 ()
    返回 ()
.否则
    .如果真 (文件是否存在 (.内容))
        打开 (#项目数据库, , , , , , )
        .如果真 (查找 (等于 (.内容, 读 (1))))
            全部关闭 ()
            信息框 (“已存在相同编号！”, 16, )
            返回 ()
        .如果真结束
        .如果真 (复制文件 (.内容, 相加 (取运行目录 (), “\data\”, .内容, “.fd1”)))
            加新记录 ()
            全部关闭 ()
            初始化 ()
            返回 ()
        .如果真结束
        全部关闭 ()
    .如果真结束
    信息框 (“项目包文件不存在或读取失败！”, 16, )
.如果结束


.子程序 加新记录, 空白型, , 
.局部变量 扩展名, 文本型, , , 

赋值 (扩展名, 取文本右边 (.内容, 相减 (取文本长度 (.内容), 倒找文本 (.内容, “.”, , 真))))
加记录 (.内容, .内容, .现行选中项, .内容, .今天, .今天, , , 扩展名, , , , .内容)

.子程序 初始化, 空白型, , 
赋值 (.内容, 相加 (取文本右边 (到文本 (取年份 (取现行时间 ())), 2), 取文本右边 (相加 (“0”, 到文本 (取月份 (取现行时间 ()))), 2), 取文本右边 (相加 (“0”, 到文本 (取日 (取现行时间 ()))), 2), “_”, 取文本右边 (相加 (“0”, 到文本 (取小时 (取现行时间 ()))), 2), 取文本右边 (相加 (“0”, 到文本 (取分钟 (取现行时间 ()))), 2), 取文本右边 (相加 (“0”, 到文本 (取秒 (取现行时间 ()))), 2)))
连续赋值 (“”, .内容, .内容, .内容)
读取项目列表 (_启动窗口.)

.子程序 _新建项目窗口_创建完毕, 空白型, , 
.局部变量 编号, 文本型, , , 

读取类型到组合框 ()
.如果真 (取反 (是否不自动编号))
    赋值 (编号, 相加 (取文本右边 (到文本 (取年份 (取现行时间 ())), 2), 取文本右边 (相加 (“0”, 到文本 (取月份 (取现行时间 ()))), 2), 取文本右边 (相加 (“0”, 到文本 (取日 (取现行时间 ()))), 2), “_”, 取文本右边 (相加 (“0”, 到文本 (取小时 (取现行时间 ()))), 2), 取文本右边 (相加 (“0”, 到文本 (取分钟 (取现行时间 ()))), 2), 取文本右边 (相加 (“0”, 到文本 (取秒 (取现行时间 ()))), 2)))
    赋值 (.内容, 编号)
    返回 ()
.如果真结束
获取焦点 ()

.子程序 _浏览文件按钮_被单击, 空白型, , 
.如果真 (打开 ())
    赋值 (.内容, .文件名)
.如果真结束
改变目录 (取运行目录 ())

.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()

.窗口程序集 询问删除程序集, , , 

.子程序 _确定按钮_被单击, 空白型, , 
.局部变量 名称, 文本型, , , 
.局部变量 次数, 空白型, , , 

播放音乐 (#删除声音, )
打开 (#项目数据库, , , , , , )
.计次循环首 (_启动窗口.取表项数 (.), 次数)
    .如果真 (_启动窗口.是否被选择 (., 相减 (次数, 1)))
        跳到 (_启动窗口.取表项数值 (., 相减 (次数, 1)))
        赋值 (名称, 读 (1))
        删除 ()
        彻底删除 ()
        .如果真 (.选中)
            删除文件 (相加 (取运行目录 (), “\data\”, 名称, “.fd1”))
        .如果真结束
        
    .如果真结束
    
.计次循环尾 ()
全部关闭 ()
读取项目列表 (_启动窗口.)
销毁 ()

.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()

.子程序 _询问删除_创建完毕, 空白型, , 
.如果真 (等于 (读配置项 (相加 (取运行目录 (), “\Install.ini”), “Install”, “Del”, ), “1”))
    赋值 (.选中, 真)
.如果真结束


.子程序 _询问删除_将被销毁, 空白型, , 
.如果 (.选中)
    写配置项 (相加 (取运行目录 (), “\Install.ini”), “Install”, “Del”, “1”)
.否则
    写配置项 (相加 (取运行目录 (), “\Install.ini”), “Install”, “Del”, “0”)
.如果结束


.窗口程序集 更新项目程序集, , , 

.程序集变量 h, 空白型, , , 
.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()

.子程序 _更新项目窗口_创建完毕, 空白型, , 
读取类型到组合框 ()
打开 (#项目数据库, , , , , , )
赋值 (h, _启动窗口.取表项数值 (., _启动窗口..))
跳到 (h)
赋值 (.内容, 读 (1))
赋值 (.内容, 读 (2))
赋值 (.现行选中项, 读 (3))
赋值 (.内容, 读 (4))
赋值 (.今天, 读 (5))
赋值 (.内容, 读 (13))
全部关闭 ()

.子程序 _浏览按钮_被单击, 空白型, , 
.如果真 (打开 ())
    赋值 (.内容, .文件名)
.如果真结束
改变目录 (取运行目录 ())

.子程序 _确定按钮_被单击, 空白型, , 
.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“填写不完整！”, 48, )
    返回 ()
.如果真结束
.如果 (等于 (.内容, “”))
    打开 (#项目数据库, , , , , , )
    跳到 (h)
    修改 ( (), .内容, .现行选中项, .内容, .今天, .今天, , ,  (), , , , .内容)
    全部关闭 ()
    销毁 ()
    返回 ()
    
.否则
    .如果真 (文件是否存在 (.内容))
        打开 (#项目数据库, , , , , , )
        .如果真 (复制文件 (.内容, 相加 (取运行目录 (), “\data\”, .内容, “.fd1”)))
            跳到 (h)
            修改 (.内容, .内容, .现行选中项, .内容, .今天, .今天, , , 取文本右边 (.内容, 相减 (取文本长度 (.内容), 倒找文本 (.内容, “.”, , 真))), , , , .内容)
            全部关闭 ()
            销毁 ()
            返回 ()
        .如果真结束
        全部关闭 ()
    .如果真结束
    信息框 (“项目包文件不存在或读取失败！”, 16, )
.如果结束


.窗口程序集 关联项目程序集, , , 

.程序集变量 记录号, 空白型, , , 
.子程序 _关联项目窗口_创建完毕, 空白型, , 
赋值 (记录号, _启动窗口.取表项数值 (., _启动窗口..))
打开 (#项目数据库, , , , , , )
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .插入表项 (读 (1), , , , )
    相减 (取表项数 (), 1).置标题 (1, 读 (2))
    相减 (取表项数 (), 1).置标题 (2, 读 (4))
    跳过 ()
.判断循环尾 ()
全部关闭 ()
读取关联项目 ()

.子程序 读取关联项目, 空白型, , 
.局部变量 分割后文本, 文本型, , "0", 
.局部变量 次数, 整数型, , , 

全部删除 ()
打开 (#项目数据库, , , , , , )
跳到 (记录号)
赋值 (分割后文本, 分割文本 (读 (7), #换行符, ))
.计次循环首 (取数组成员数 (分割后文本), 次数)
    .如果真 (不等于 (删全部空 (分割后文本 [次数]), “”))
        .插入表项 (分割后文本 [次数], , , , )
        到首记录 ()
        .如果 (查找 (等于 (读 (1), 分割后文本 [次数])))
            相减 (取表项数 (), 1).置标题 (1, 读 (2))
        .否则
            相减 (取表项数 (), 1).置标题 (1, “项目不存在”)
        .如果结束
        
    .如果真结束
    
.计次循环尾 ()
全部关闭 ()

.子程序 _导出按钮_被单击, 空白型, , 
.局部变量 记录号, 空白型, , , 

.如果真 (等于 (., -1))
    信息框 (“请选择您要导出的项目！”, 48, )
    返回 ()
.如果真结束
.如果 (等于 (.取标题 (., 1), “项目不存在”))
    信息框 (“项目文件不存在！”, 48, )
.否则
    打开 (#项目数据库, , , , , , )
    .如果真 (查找 (等于 (读 (1), .取标题 (., 0))))
        赋值 (记录号, 取记录号 ())
        全部关闭 ()
        导出 (#项目数据库, 记录号, _启动窗口.)
        返回 ()
    .如果真结束
    全部关闭 ()
    信息框 (“项目文件不存在！”, 48, )
.如果结束


.子程序 _添加按钮_被单击, 空白型, , 
赋值 (关联项目窗口.宽度, 536)

.子程序 _超级按钮5_被单击, 空白型, , 
赋值 (关联项目窗口.宽度, 270)

.子程序 _超级按钮4_被单击, 空白型, , 
.如果真 (等于 (., -1))
    信息框 (“请选择要关联到的项目！”, 48, )
    返回 ()
.如果真结束
.插入表项 (.取标题 (., 0), , , , )
相减 (取表项数 (), 1).置标题 (1, .取标题 (., 1))

.子程序 _删除按钮_被单击, 空白型, , 
.如果真 (等于 (., -1))
    信息框 (“请选择您要删除的项目！”, 48, )
    返回 ()
.如果真结束
.删除表项 (.)

.子程序 _关联项目窗口_将被销毁, 空白型, , 
.局部变量 关联项目, 文本型, , , 
.局部变量 次数, 空白型, , , 

打开 (#项目数据库, , , , , , )
跳到 (记录号)
.计次循环首 (取表项数 (), 次数)
    赋值 (关联项目, 相加 (关联项目, 相减 (次数, 1).取标题 (0), #换行符))
.计次循环尾 ()
写 (7, 关联项目)
全部关闭 ()

.子程序 _选择项目列表框_表项被激活, 空白型, , 
_超级按钮4_被单击 ()

.窗口程序集 系统设置程序集, , , 

.子程序 _系统设置窗口_创建完毕, 空白型, , 
赋值 (.内容, _启动窗口.标题)
赋值 (.选中, 是否取消必须导入文件包)
赋值 (.选中, 是否不自动编号)
赋值 (.内容, 取当前密码 ())
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “Bag”, ))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “dir”, 相加 (取运行目录 (), “\run”)))
赋值 (.颜色, 到数值 (读配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “Color1”, 到文本 (#黑色))))
赋值 (.颜色, 到数值 (读配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “Color2”, 到文本 (#白色))))
赋值 (.颜色, 到数值 (读配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “Color3”, 到文本 (#白色))))
.如果真 (等于 (读配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “Bag2”, ), “1”))
    赋值 (.选中, 假)
.如果真结束
.如果真 (是否已创建 (已执行窗口))
    连续赋值 (真, .禁止, .)
     ' 如果有已执行程序将不允许改变执行目录
.如果真结束
读类型 ()

.子程序 读类型, 空白型, , 
读取类型到组合框 ()
_类型组合框_列表项被选择 ()

.子程序 _类型组合框_列表项被选择, 空白型, , 
打开 (#项目类型数据库, , , , , , )
跳到 (相加 (.现行选中项, 1))
赋值 (.图片, 读 (2))
全部关闭 ()

.子程序 _确定按钮_被单击, 空白型, , 
.局部变量 导入文件包, 文本型, , , 
.局部变量 自动编号, 文本型, , , 
.局部变量 平铺, 文本型, , , 

.如果 (.选中)
    赋值 (导入文件包, “1”)
.否则
    赋值 (导入文件包, “0”)
.如果结束
.如果 (.选中)
    赋值 (自动编号, “1”)
.否则
    赋值 (自动编号, “0”)
.如果结束
.如果 (.选中)
    赋值 (平铺, “0”)
.否则
    赋值 (平铺, “1”)
.如果结束
写配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “Title”, .内容)
写配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “Into”, 导入文件包)
写配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “Number”, 自动编号)
写配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “Bag”, .内容)
写配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “Bag2”, 平铺)
写配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “Color1”, 到文本 (.颜色))
写配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “Color2”, 到文本 (.颜色))
写配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “Color3”, 到文本 (.颜色))
写配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “dir”, .内容)
销毁 ()

.子程序 _默认按钮_被单击, 空白型, , 
全部关闭 ()
连续赋值 (假, .选中, .选中)
赋值 (.内容, #软件名称)
赋值 (.内容, “”)
.如果真 (取反 (是否已创建 (已执行窗口)))
     ' 如存在正在执行的项目将不改变此目录
    赋值 (.内容, 相加 (取运行目录 (), “\run”))
.如果真结束
赋值 (.颜色, #黑色)
连续赋值 (#白色, .颜色, .颜色)
写到文件 (相加 (取运行目录 (), “\data\type.edb”), #数据库1)
写到文件 (相加 (取运行目录 (), “\data\type.edt”), #数据库2)
读取类型到组合框 ()
_类型组合框_列表项被选择 ()

.子程序 _删除类型按钮_被单击, 空白型, , 
.如果真 (小于 (取项目数 (), 2))
    信息框 (“您至少要保留一个项目类型！”, 0, )
.如果真结束
.如果真 (等于 (信息框 (“您确定要删除此项目类型吗？”, 292, ), 5))
    打开 (#项目类型数据库, , , , , , )
    跳到 (相加 (.现行选中项, 1))
    删除 ()
    彻底删除 ()
    读取类型到组合框 ()
    _类型组合框_列表项被选择 ()
.如果真结束


.子程序 _新建类型按钮_被单击, 空白型, , 
载入 (新建类型窗口, , 真)
读取类型到组合框 ()
_类型组合框_列表项被选择 ()

.子程序 _系统设置窗口_将被销毁, 空白型, , 
读取配置 (_启动窗口.)
读取项目列表 (_启动窗口.)

.子程序 _选择底图按钮_被单击, 空白型, , 
.如果真 (打开 ())
    赋值 (.内容, .文件名)
.如果真结束
改变目录 (取运行目录 ())

.子程序 _底图编辑框_内容被改变, 空白型, , 
.如果 (等于 (删全部空 (.内容), “”))
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
.如果结束


.子程序 _浏览执行目录按钮_被单击, 空白型, , 
.局部变量 目录, 文本型, , , 

赋值 (目录, 未知支持库函数_2 (“请选择程序执行目录（最好为空目录）：”, ))
.如果真 (不等于 (目录, “”))
    赋值 (.内容, 目录)
.如果真结束


.子程序 _修改密码按钮_被单击, 空白型, , 
.如果真 (修改密码 (.内容))
    信息框 (“修改密码成功！”, 64, )
    返回 ()
.如果真结束
信息框 (“修改密码失败！”, 16, )

.程序集 处理层, , , 

.子程序 读取类型到组合框, 空白型, , 
.参数 组合框, 组合框, , 

组合框.清空 ()
打开 (#项目类型数据库, , , , , , )
到首记录 ()
.判断循环首 (取反 (尾记录后 ()))
    组合框.加入项目 (读 (1), )
    跳过 ()
.判断循环尾 ()
全部关闭 ()
赋值 (组合框.现行选中项, 0)

.子程序 删除项目, 空白型, , 
.如果真 (是否已选择 ())
    载入 (询问删除, , 真)
.如果真结束


.子程序 写辅助, 逻辑型, , 
.参数 数据库, 文本型, , 
.参数 记录号, 整数型, , 
.参数 方式, 整数型, , 
.参数 内容, 文本型, , 

.如果真 (打开 (数据库, , , , , , ))
    跳到 (记录号)
    .判断开始 (等于 (方式, 0))
        写 (14, 内容)
    .判断 (等于 (方式, 1))
        写 (11, 内容)
    .判断 (等于 (方式, 2))
        写 (10, 内容)
    .默认
        
    .判断结束
    全部关闭 ()
    返回 (真)
.如果真结束
返回 (假)

.子程序 取项目最后更新, 文本型, , 
.参数 数据库, 文本型, , 
.参数 记录号, 整数型, , 

.局部变量 内容, 文本型, , , 

.如果真 (打开 (数据库, , , , , , ))
    跳到 (记录号)
    赋值 (内容, 相加 (“最后更新：”, 到文本 (读 (6))))
    全部关闭 ()
    返回 (内容)
.如果真结束
数据库失败了 ()
返回 (“”)

.子程序 取工具最后更新, 文本型, , 
.参数 数据库, 文本型, , 
.参数 记录号, 整数型, , 

.局部变量 内容, 文本型, , , 

.如果真 (打开 (数据库, , , , , , ))
    跳到 (记录号)
    赋值 (内容, 读 (2))
    全部关闭 ()
    返回 (内容)
.如果真结束
数据库失败了 ()
返回 (“”)

.子程序 数据库失败了, 空白型, , 
信息框 (“数据库操作失败！”, 16, )

.子程序 是否已选择, 逻辑型, , 
.如果真 (等于 (_启动窗口.., -1))
    信息框 (“请选择您要操作的项目！”, 48, )
    返回 (假)
.如果真结束
返回 (真)

.子程序 读取配置, 空白型, , 
.参数 超级列表框, 超级列表框, , 

.局部变量 备份, 文本型, , , 
.局部变量 强制导入文件包, 文本型, , , 
.局部变量 不自动编号, 文本型, , , 
.局部变量 图片组, 字节集, , , 
.局部变量 次数, 整数型, , , 
.局部变量 背景图, 文本型, , , 
.局部变量 平铺, 逻辑型, , , 

赋值 (_启动窗口.标题, 读配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “Title”, #软件名称))
赋值 (备份, 读配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “Bak”, ))
赋值 (强制导入文件包, 读配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “Into”, ))
赋值 (不自动编号, 读配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “Number”, ))
.如果 (等于 (强制导入文件包, “1”))
    赋值 (是否取消必须导入文件包, 真)
.否则
    赋值 (是否取消必须导入文件包, 假)
.如果结束
.如果 (等于 (不自动编号, “1”))
    赋值 (是否不自动编号, 真)
.否则
    赋值 (是否不自动编号, 假)
.如果结束
赋值 (图片组, 未知支持库函数_30 (32, 32))
未知支持库函数_24 (图片组, #项目, )
打开 (#项目类型数据库, , , , , , )
.计次循环首 (取记录数 (), 次数)
    跳到 (次数)
    未知支持库函数_24 (图片组, 读 (2), )
.计次循环尾 ()
全部关闭 ()
赋值 (超级列表框., 图片组)
赋值 (背景图, 读配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “Bag”, ))
.如果真 (不等于 (读配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “Bag2”, ), “1”))
    赋值 (平铺, 真)
.如果真结束
赋值 (超级列表框., 到数值 (读配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “Color1”, 到文本 (#黑色))))
赋值 (超级列表框., 到数值 (读配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “Color2”, 到文本 (#白色))))
赋值 (超级列表框., 到数值 (读配置项 (相加 (取运行目录 (), “\Install.ini”), “System”, “Color3”, 到文本 (#白色))))
.如果 (文件是否存在 (背景图))
    设置背景 (超级列表框, 背景图, 平铺)
.否则
    清除背景 (超级列表框)
.如果结束


.子程序 读取工具, 空白型, , 
.参数 数据库, 文本型, , 
.参数 超级列表框, 超级列表框, , 

.局部变量 图片组, 字节集, , , 
.局部变量 图片索引, 整数型, , , 
.局部变量 URL后缀名, 文本型, , , 
.局部变量 前缀名, 文本型, , , 
.局部变量 后缀, 文本型, , , 
.局部变量 路径, 文本型, , "0", 

置等待鼠标 ()
超级列表框.全部删除 ()
打开 (数据库, , , , , , )
赋值 (图片组, 未知支持库函数_30 (32, 32))
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    处理事件 ()
    赋值 (图片索引, 未知支持库函数_26 (图片组, 读 (2), ))
    .如果真 (等于 (图片索引, -1))
        赋值 (URL后缀名, 到小写 (取文本右边 (读 (2), 3)))
        赋值 (前缀名, 到小写 (取文本左边 (读 (2), 4)))
        赋值 (后缀, 取文本右边 (读 (2), 相加 (相减 (取文本长度 (读 (2)), 倒找文本 (读 (2), “.”, , 假)), 1)))
        .如果真 (或者 (等于 (URL后缀名, “com”), 等于 (URL后缀名, “net”), 等于 (URL后缀名, “.cn”), 等于 (URL后缀名, “org”), 等于 (URL后缀名, “htm”), 等于 (URL后缀名, “tml”), 等于 (URL后缀名, “asp”), 等于 (URL后缀名, “aspx”), 等于 (URL后缀名, “php”), 等于 (URL后缀名, “om/”), 等于 (URL后缀名, “et/”), 等于 (URL后缀名, “cn/”), 等于 (前缀名, “http”), 等于 (前缀名, “www.”)))
             ' 判断是否为网址
            赋值 (图片索引, 未知支持库函数_24 (图片组, #网站, ))
        .如果真结束
        .如果真 (等于 (图片索引, -1))
            赋值 (路径, 分割文本 (取文本注册项 (#根类, 相加 (取文本注册项 (#根类, 相加 (后缀, “\”), ), “\DefaultIcon\”), ), “,”, ))
            .如果真 (大于 (取数组成员数 (路径), 1))
                赋值 (图片索引, 未知支持库函数_26 (图片组, 路径 [1], 到数值 (路径 [2])))
            .如果真结束
            
        .如果真结束
        .如果真 (等于 (图片索引, -1))
            赋值 (图片索引, 未知支持库函数_24 (图片组, #无图程序, ))
             ' 确实没有图标就从资源里取一个
        .如果真结束
        
    .如果真结束
    赋值 (超级列表框., 图片组)
    超级列表框.插入表项 (读 (1), 图片索引, , , 取记录号 ())
    跳过 ()
.判断循环尾 ()
全部关闭 ()
恢复鼠标 ()

.子程序 读取项目列表, 空白型, , 
.参数 超级列表框, 超级列表框, , 

.局部变量 次数, 整数型, , , 
.局部变量 总记录数, 整数型, , , 

超级列表框.全部删除 ()
打开 (#项目类型数据库, , , , , , )
赋值 (总记录数, 取记录数 ())
全部关闭 ()
打开 (#项目数据库, , , , , , )
.计次循环首 (取记录数 (), 次数)
    跳到 (次数)
    .如果 (小于 (读 (3), 总记录数))
        超级列表框.插入表项 (相加 (读 (2), “ ”, 读 (4)), 相加 (读 (3), 1), , , 取记录号 ())
    .否则
        超级列表框.插入表项 (相加 (读 (2), “ ”, 读 (4)), 0, , , 取记录号 ())
    .如果结束
    
.计次循环尾 ()
全部关闭 ()

.子程序 状态条显示, 空白型, , 
.参数 状态条, 状态条, , 
.参数 索引, 整数型, , 
.参数 内容, 文本型, , 

状态条.置文本 (索引, 内容)

.子程序 新建项目, 空白型, , 
载入 (新建项目窗口, , 真)
读取项目列表 (_启动窗口.)

.子程序 开发向导, 空白型, , 
载入 (设计向导窗口, _启动窗口, 假)

.子程序 详细信息, 文本型, , 
.参数 记录号, 整数型, , 

.局部变量 显示内容, 文本型, , , 
.局部变量 类型号, 整数型, , , 
.局部变量 类型, 文本型, , , 
.局部变量 大小, 双精度小数型, , , 
.局部变量 转换后大小, 文本型, , , 
.局部变量 路径, 文本型, , , 
.局部变量 显示大小, 文本型, , , 

打开 (#项目数据库, , , , , , )
跳到 (记录号)
赋值 (类型号, 读 (3))
全部关闭 ()
打开 (#项目类型数据库, , , , , , )
跳到 (相加 (类型号, 1))
赋值 (类型, 读 (1))
全部关闭 ()
打开 (#项目数据库, , , , , , )
跳到 (记录号)
赋值 (路径, 相加 (取运行目录 (), “\data\”, 读 (1), “.fd1”))
 ' 开始转换大小显示方式
赋值 (大小, 取字节集长度 (读入文件 (路径)))
赋值 (显示大小, 相加 (到文本 (大小), “字节”))
赋值 (转换后大小, 数值到格式文本 (大小, , 真))
赋值 (转换后大小, 相加 (转换后大小, “字节”))
.如果真 (大于 (大小, 1024))
    赋值 (大小, 四舍五入 (相除 (大小, 1024), 2))
    赋值 (显示大小, 相加 (到文本 (大小), “KB”))
    .如果真 (大于 (大小, 1024))
        赋值 (大小, 四舍五入 (相除 (大小, 1024), 2))
        赋值 (显示大小, 相加 (到文本 (大小), “MB”))
    .如果真结束
    
.如果真结束
 ' 大小显示方式转换结束
赋值 (显示内容, 相加 (#换行符, “项目编号：”, 读 (1), #换行符, “项目包路径：”, 路径, #换行符, “项目名称：”, 读 (2), #换行符, “项目类型：”, 类型, #换行符, “版本：”, 读 (4), #换行符, “------------------------------------------------------------------”, #换行符, “开始时间：”, 到文本 (读 (5)), #换行符, “最后更新：”, 到文本 (读 (6)), #换行符, #换行符, “备注：”, #换行符, 读 (13), #换行符, #换行符, “------------------------------------------------------------------”, #换行符, “文件尺寸：”, 显示大小, “ (”, 转换后大小, “)”))
返回 (显示内容)

.子程序 导出, 逻辑型, , 
.参数 数据库, 文本型, , 
.参数 记录号, 整数型, , 
.参数 对话框, 通用对话框, , 

.局部变量 扩展名, 文本型, , , 
.局部变量 名称, 文本型, , , 
.局部变量 版本, 文本型, , , 
.局部变量 路径, 文本型, , , 

打开 (数据库, , , , , , )
跳到 (记录号)
赋值 (名称, 读 (2))
赋值 (版本, 读 (4))
赋值 (扩展名, 读 (9))
赋值 (路径, 相加 (取运行目录 (), “\data\”, 读 (1), “.fd1”))
全部关闭 ()
.如果真 (文件是否存在 (路径))
    赋值 (对话框.过滤器, 相加 (到大写 (扩展名), “文件(*.”, 扩展名, “)|*.”, 扩展名, “|*.*|*.*”))
    赋值 (对话框.默认文件后缀, 扩展名)
     ' 先设置一个通用的
    
    .如果真 (等于 (到小写 (扩展名), “zip”))
        赋值 (对话框.过滤器, “ZIP压缩档案(*.ZIP)|*.zip|*.*|*.*”)
        赋值 (对话框.默认文件后缀, “zip”)
    .如果真结束
    .如果真 (等于 (到小写 (扩展名), “e”))
        赋值 (对话框.过滤器, “易程序(*.E)|*.e|*.*|*.*”)
        赋值 (对话框.默认文件后缀, “e”)
    .如果真结束
    .如果真 (等于 (到小写 (扩展名), “ec”))
        赋值 (对话框.过滤器, “易语言模块(*.EC)|*.ec|*.*|*.*”)
        赋值 (对话框.默认文件后缀, “ec”)
    .如果真结束
    .如果真 (等于 (到小写 (扩展名), “dll”))
        赋值 (对话框.过滤器, “DLL动态链接库(*.DLL)|*.dll|*.*|*.*”)
        赋值 (对话框.默认文件后缀, “dll”)
    .如果真结束
     ' 发现可识别类型就描述的详细些
    
    赋值 (对话框.文件名, 相加 (名称, “ ”, 版本))
    .如果真 (对话框.打开 ())
        .如果真 (复制文件 (路径, 对话框.文件名))
            改变目录 (取运行目录 ())
            返回 (真)
        .如果真结束
        信息框 (“导出文件失败！”, 16, )
        改变目录 (取运行目录 ())
        返回 (假)
    .如果真结束
    改变目录 (取运行目录 ())
    返回 (假)
.如果真结束
信息框 (“项目文件已丢失或未导入！”, 16, )
返回 (假)

.子程序 显示工具备注, 空白型, , 
.参数 窗口, 窗口, , 
.参数 显示编辑框, 编辑框, , 

打开 (#工具数据库, , , , , , )
跳到 (_启动窗口.取表项数值 (., _启动窗口..))
赋值 (窗口.标题, 读 (1))
赋值 (显示编辑框.内容, 相加 (读 (3), #换行符, #换行符, “路径：”, 读 (2)))
全部关闭 ()

.子程序 显示表项路径, 空白型, , 
.参数 超级列表框, 超级列表框, , 

打开 (#工具数据库, , , , , , )
跳到 (超级列表框.取表项数值 (超级列表框.))
信息框 (读 (2), 64, “路径”)
全部关闭 ()

.子程序 设置背景, 空白型, 公开, 为超级列表框指定地址的图片 *源码来自笨笨 谢
.参数 超级列表框, 超级列表框, , 要添加背景的超级列表框
.参数 图片, 文本型, 可空, 要添加的背景图片，为空时清除背景
.参数 平铺, 逻辑型, 可空, 是否平铺，为空则为真

.局部变量 背景图片, 超级列表框背景图片, , , 

.如果真 (是否为空 (平铺))
    赋值 (平铺, 真)
.如果真结束
.如果 (或者 (是否为空 (图片), 小于或等于 (取文本长度 (图片), 0)))
    赋值 (背景图片.应用, 0)
.否则
    超级列表框.发送信息 (4134, 0, -1) ' 让文本背景透明
    赋值 (背景图片.应用, 位或 (2, 选择 (平铺, 16, 0)))
    赋值 (背景图片.图片, 图片) ' 图片路径
    赋值 (背景图片.横向百分比, 0)
    赋值 (背景图片.纵向百分比, 100) ' 左边与顶边偏移百分比，如果上面用平铺的话就没什么意义了
.如果结束
发送消息 (超级列表框.取窗口句柄 (), 4164, 0, 背景图片)

.子程序 清除背景, 空白型, 公开, 清除超级列表框的背景  *源码来自笨笨 谢
.参数 超级列表框, 超级列表框, , 

.局部变量 背景图片, 超级列表框背景图片, , , 

赋值 (背景图片.应用, 0)
发送消息 (超级列表框.取窗口句柄 (), 4164, 0, 背景图片)

.子程序 验证密码, 逻辑型, , 
.参数 密码文本, 文本型, , 

.如果真 (打开 (#密码数据库, , , , , “000”, ))
    .如果真 (等于 (读 (1), 密码文本))
        全部关闭 ()
        返回 (真)
    .如果真结束
    全部关闭 ()
.如果真结束
返回 (假)

.子程序 取当前密码, 文本型, , 
.局部变量 密码变量, 文本型, , , 

.如果真 (打开 (#密码数据库, , , , , “000”, ))
    赋值 (密码变量, 读 (1))
    全部关闭 ()
    返回 (密码变量)
.如果真结束
数据库失败了 ()
返回 (“”)

.子程序 修改密码, 逻辑型, , 
.参数 密码文本, 文本型, , 

.如果真 (打开 (#密码数据库, , , , , “000”, ))
    .如果真 (修改 (密码文本))
        全部关闭 ()
        返回 (真)
    .如果真结束
    全部关闭 ()
.如果真结束
返回 (假)

.窗口程序集 新建类型程序集, , , 

.子程序 _选择图标按钮_被单击, 空白型, , 
.局部变量 图片号, 空白型, , , 

.如果真 (打开 ())
    赋值 (图片号, 载入图片 (读入文件 (.文件名)))
    .如果真 (并且 (不等于 (图片号.取图片宽度 (), 32), 不等于 (图片号.取图片高度 (), 32)))
        卸载图片 (图片号)
        改变目录 (取运行目录 ())
        信息框 (“载入图片失败！类型图片的大小必须为32*32像素。”, 16, )
        返回 ()
    .如果真结束
    卸载图片 (图片号)
    赋值 (.内容, .文件名)
    赋值 (.图片, 读入文件 (.文件名))
.如果真结束
改变目录 (取运行目录 ())

.子程序 _确定按钮_被单击, 空白型, , 
.如果真 (或者 (等于 (.内容, “”), 等于 (.图片, {  })))
    信息框 (“请填写完整！”, 48, )
    返回 ()
.如果真结束
打开 (#项目类型数据库, , , , , , )
加记录 (.内容, .图片)
全部关闭 ()
信息框 (“新建类型成功！”, 64, )
连续赋值 (“”, .内容, .内容)
赋值 (.图片, {  })

.窗口程序集 增加工具程序集, , , 

.程序集变量 记录号, 空白型, , , 
.子程序 _浏览目录按钮_被单击, 空白型, , 
.如果真 (等于 (打开 (), 真))
    赋值 (.内容, .文件名)
    赋值 (.内容, 取文本右边 (.内容, 相减 (取文本长度 (.内容), 倒找文本 (.文件名, “\”, , 真))))
.如果真结束
改变目录 (取运行目录 ())

.子程序 _确定按钮_被单击, 空白型, , 
.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“名称或路径没有输入！”, 48, )
    返回 ()
.如果真结束
打开 (#工具数据库, , , , , , )
.如果 (编辑工具)
    跳到 (记录号)
    .如果真 (修改 (.内容, .内容, .内容))
        全部关闭 ()
        读取工具 (#工具数据库, _启动窗口.)
        销毁 ()
        返回 ()
    .如果真结束
    信息框 (“添加工具或资源失败!”, 16, )
    
.否则
    .如果真 (加记录 (.内容, .内容, .内容))
        连续赋值 (“”, .内容, .内容, .内容)
        全部关闭 ()
        读取工具 (#工具数据库, _启动窗口.)
        返回 ()
    .如果真结束
    信息框 (“添加工具或资源失败!”, 16, )
.如果结束
全部关闭 ()

.子程序 _增加工具窗口_创建完毕, 空白型, , 
.如果 (编辑工具)
    赋值 (.标题, “编辑”)
    赋值 (记录号, _启动窗口.取表项数值 (., _启动窗口..))
    打开 (#工具数据库, , , , , , )
    跳到 (记录号)
    赋值 (.内容, 读 (1))
    赋值 (.内容, 读 (2))
    赋值 (.内容, 读 (3))
    全部关闭 ()
.否则
    赋值 (.标题, “新建”)
.如果结束


.窗口程序集 查看工具备注程序集, , , 

.子程序 _查看工具备注窗口_创建完毕, 空白型, , 
显示工具备注 (查看工具备注窗口, )

.子程序 _确定按钮_被单击, 空白型, , 
销毁 ()

.窗口程序集 数据库操作程序集, , , 

.子程序 _导出按钮_被单击, 空白型, , 
全部关闭 ()
赋值 (.类型, 1)
赋值 (.标题, “请选择您要导出到的目录”)
赋值 (.文件名, 相加 (“FBak_”, 时间到文本 (取现行时间 (), )))
.如果真 (打开 ())
    .如果真 (大于 (相加 (取运行目录 (), “\data”).未知支持库函数_0 (.文件名), 0))
        改变目录 (取运行目录 ())
        信息框 (“导出成功”, 64, )
        销毁 ()
        返回 ()
    .如果真结束
    信息框 (“导出数据失败！”, 16, )
.如果真结束
改变目录 (取运行目录 ())


.子程序 _导入按钮_被单击, 空白型, , 
.如果真 (等于 (信息框 (“您确定要要导入数据吗？这会将当前数据覆盖！”, 33, ), 0))
    全部关闭 ()
    赋值 (.类型, 0)
    赋值 (.标题, “请选择要导入的数据”)
    .如果真 (打开 ())
        .如果真 (大于 (.未知支持库函数_2 (.文件名, 相加 (取运行目录 (), “\data”)), 0))
            改变目录 (取运行目录 ())
            信息框 (“导入成功”, 64, )
            读取项目列表 (_启动窗口.)
            销毁 ()
            返回 ()
        .如果真结束
        信息框 (“导入数据库失败！”, 16, )
        返回 ()
    .如果真结束
    改变目录 (取运行目录 ())
.如果真结束


.窗口程序集 选择执行程序程序集, , , 

.程序集变量 寻找目录, 文本型, , , 
.子程序 _选择执行程序窗口_尺寸被改变, 空白型, , 
0.移动 (0, 取用户区宽度 (), 取用户区高度 ())

.子程序 _选择程序列表框_列表项被选择, 空白型, , 
赋值 (_启动窗口., 相加 (寻找目录, “\”, .取项目文本 (.现行选中项)))
销毁 ()

.子程序 _选择执行程序窗口_创建完毕, 空白型, , 
.局部变量 文件名, 文本型, , , 

赋值 (寻找目录, _启动窗口.)
赋值 (文件名, 寻找文件 (相加 (寻找目录, “\*.*”), ))
.判断循环首 (不等于 (文件名, “”))
    .如果真 (不等于 (文件名, “P_zip.TMP”))
        文件名.加入项目 ()
    .如果真结束
    赋值 (文件名, 寻找文件 ())
.判断循环尾 ()

.窗口程序集 已执行程序集, , , 

.子程序 _已执行窗口_可否被关闭, 逻辑型, , 
返回 (假)

.子程序 _放弃按钮_被单击, 空白型, , 
.局部变量 目录, 文本型, , , 
.局部变量 路径, 文本型, , , 

.如果真 (等于 (., -1))
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“您确定要放弃正在执行的项目操作吗？”, 292, ), 5))
    赋值 (路径, .取标题 (., 0))
    .如果 (不等于 (取文本右边 (路径, 5), “(zip)”))
         ' 不是zip文件
        赋值 (目录, 取文本左边 (路径, 相减 (倒找文本 (路径, “\”, , 假), 1)))
    .否则
        赋值 (目录, 取文本左边 (路径, 相减 (取文本长度 (路径), 5)))
    .如果结束
     ' 取出了创建的运行目录
    删除目录 (目录)
    .删除表项 (.)
    全部没有了吗 ()
.如果真结束


.子程序 全部没有了吗, 空白型, , 
.如果真 (等于 (取表项数 (), 0))
    销毁 ()
.如果真结束


.子程序 _已执行窗口_创建完毕, 空白型, , 
赋值 (.时钟周期, 3)

.子程序 _时钟1_周期事件, 空白型, , 
.如果真 (小于 (已执行窗口.左边, 负 (相减 (已执行窗口.宽度, 8))))
    赋值 (.时钟周期, 0)
    返回 ()
.如果真结束
赋值 (已执行窗口.左边, 相减 (已执行窗口.左边, 5))

.子程序 _时钟2_周期事件, 空白型, , 
.如果真 (大于 (已执行窗口.左边, 1))
    赋值 (.时钟周期, 0)
    返回 ()
.如果真结束
赋值 (已执行窗口.左边, 相加 (已执行窗口.左边, 5))

.子程序 _已执行窗口_位置被改变, 空白型, , 
.如果真 (并且 (小于 (已执行窗口.左边, -10), 等于 (.时钟周期, 0)))
    赋值 (.时钟周期, 3)
.如果真结束
.如果真 (并且 (大于 (已执行窗口.左边, 1), 小于 (已执行窗口.左边, 8), 等于 (.时钟周期, 0)))
    赋值 (已执行窗口.左边, 0)
     ' 磁性
.如果真结束
.如果真 (并且 (大于 (已执行窗口.顶边, 1), 小于 (已执行窗口.顶边, 8), 等于 (.时钟周期, 0)))
    赋值 (已执行窗口.顶边, 0)
     ' 磁性
.如果真结束


.子程序 _更新按钮_被单击, 空白型, , 
.局部变量 目录, 文本型, , , 
.局部变量 初始路径, 文本型, , , 
.局部变量 编号, 文本型, , , 
.局部变量 是否为zip, 逻辑型, , , 
.局部变量 更新后文件, 文本型, , , 
.局部变量 扩展名, 文本型, , , 
.局部变量 项目目录, 文本型, , , 

.如果真 (等于 (., -1))
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (“您确定保存好了项目文件要进行更新吗？此操作将覆盖原有记录。”, 292, ), 5))
    赋值 (初始路径, .取标题 (., 0))
    .如果 (等于 (取文本右边 (初始路径, 5), “(zip)”))
         ' 如果是zip文件
        赋值 (目录, 取文本左边 (初始路径, 相减 (取文本长度 (初始路径), 5)))
        赋值 (编号, 取文本右边 (目录, 相减 (取文本长度 (目录), 倒找文本 (目录, “\”, , 假))))
        赋值 (更新后文件, 相加 (取运行目录 (), “\”, 编号, “.fd1”))
        赋值 (扩展名, “zip”)
        .如果真 (等于 (取字节集长度 (读入文件 (相加 (目录, “\P_zip.TMP”))), 0))
            删除文件 (相加 (目录, “\P_zip.TMP”))
             ' 如果长度为0就删除执行时做的标记，因为创建的时候是0
            
        .如果真结束
        .如果真 (不等于 (目录.未知支持库函数_0 (更新后文件), 1))
             ' 压缩失败返回
            信息框 (相加 (“压缩文件失败，请手动压缩后导入。”, #换行符, “文件路径：”, 目录), 16, )
            .删除表项 (.)
            全部没有了吗 ()
            返回 ()
        .如果真结束
         ' 将文件夹压缩并保存压缩后路径
        赋值 (项目目录, 目录)
        
    .否则
        赋值 (目录, 取文本左边 (初始路径, 相减 (倒找文本 (初始路径, “.”, , 假), 1)))
        赋值 (扩展名, 取文本右边 (初始路径, 相减 (取文本长度 (初始路径), 倒找文本 (初始路径, “.”, , 假))))
        赋值 (编号, 取文本右边 (目录, 相减 (取文本长度 (目录), 倒找文本 (目录, “\”, , 假))))
        赋值 (项目目录, 取文本左边 (目录, 相减 (倒找文本 (目录, “\”, , 假), 1)))
        .如果真 (取反 (复制文件 (初始路径, 相加 (取运行目录 (), “\”, 编号, “.fd1”))))
            信息框 (相加 (“更新项目出错，请手动更新该项目并删除此文件夹，项目文件路径为：”, 目录), 16, )
            .删除表项 (.)
            全部没有了吗 ()
             ' 发生错误
            
            返回 ()
        .如果真结束
        赋值 (更新后文件, 相加 (取运行目录 (), “\”, 编号, “.fd1”))
    .如果结束
    删除目录 (项目目录)
    .删除表项 (.)
    全部没有了吗 ()
    .如果真 (复制文件 (更新后文件, 相加 (取运行目录 (), “\data\”, 编号, “.fd1”)))
        打开 (#项目数据库, , , , , , )
        .如果 (等于 (查找 (等于 (读 (1), 编号)), 假))
            信息框 (“项目已不存在，系统将重建，请注意修改项目属性。”, 48, )
            加记录 (编号, “自动创建项目”, 0, “1.0”, 取现行时间 (), 取现行时间 (), , , 扩展名, , , , 相加 (时间到文本 (取现行时间 (), #日期部分), “在执行过程中项目文件丢失，此记录为系统自动创建，请您修改此项目的属性。”))
             ' 如果原来记录不存在就自动创建一个
        .否则
            写 (6, 取现行时间 ())
        .如果结束
        全部关闭 ()
        删除文件 (更新后文件)
        信息框 (“更新项目成功！”, 64, )
        .如果真 (是否已创建 (_启动窗口))
             ' 如果启动窗口被关闭了就不更新了
            读取项目列表 (_启动窗口.)
        .如果真结束
        返回 ()
    .如果真结束
    信息框 (相加 (“更新项目出错，请在程序中手动更新，已保存好的项目文件路径为：”, 更新后文件), 48, )
.如果真结束


.子程序 _外形框1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (并且 (小于 (已执行窗口.左边, 负 (相减 (已执行窗口.宽度, 12))), 等于 (.时钟周期, 0)))
    
     ' 如果鼠标在右边且窗口处于隐藏状态就弹出来
    赋值 (.时钟周期, 3)
.如果真结束


.窗口程序集 向导程序集, , , 

.子程序 _加入日期按钮_被单击, 空白型, , 
时间到文本 (.今天, #日期部分).加入文本 ()

.子程序 _下一步按钮_被单击, 空白型, , 
.如果 (等于 (., “保存 (&S)”))
    .如果真 (打开 ())
        写到文件 (.文件名, 到字节集 (相加 (1.取子夹名称 (), #换行符, “---------------------------------------------”, #换行符, #换行符, .内容, #换行符, #换行符, 2.取子夹名称 (), #换行符, “---------------------------------------------”, #换行符, #换行符, .内容, #换行符, #换行符, 3.取子夹名称 (), #换行符, “---------------------------------------------”, #换行符, #换行符, .内容, #换行符, #换行符, 4.取子夹名称 (), #换行符, “---------------------------------------------”, #换行符, #换行符, .内容, #换行符, #换行符, 5.取子夹名称 (), #换行符, “---------------------------------------------”, #换行符, #换行符, .内容, #换行符, #换行符, #换行符, “---------------------------------------------”, #换行符, “创建时间：”, 时间到文本 (取现行时间 (), #日期部分))))
        改变目录 (取运行目录 ())
        销毁 ()
        
         ' 如果为最后一项就保存内容
        
        返回 ()
    .如果真结束
    改变目录 (取运行目录 ())
.否则
    
.如果结束
赋值 (.现行子夹, 相加 (.现行子夹, 1))
判断按钮 ()

.子程序 判断按钮, 空白型, , 
.局部变量 当前夹, 空白型, , , 

.如果 (等于 (.现行子夹, 0))
    赋值 (., 真)
.否则
    赋值 (., 假)
.如果结束
.如果 (等于 (.现行子夹, 相减 (取子夹数目 (), 1)))
    赋值 (., “保存 (&S)”)
.否则
    赋值 (., “下一步 (&N)”)
.如果结束
赋值 (当前夹, .现行子夹)
.判断开始 (等于 (.现行子夹, 0))
    获取焦点 ()
.判断 (等于 (.现行子夹, 1))
    获取焦点 ()
.判断 (等于 (.现行子夹, 2))
    获取焦点 ()
.判断 (等于 (.现行子夹, 3))
    获取焦点 ()
.判断 (等于 (.现行子夹, 4))
    获取焦点 ()
.判断 (等于 (.现行子夹, 5))
    获取焦点 ()
.默认
    
.判断结束
 ' 自动获取焦点，方便输入

.子程序 _上一步按钮_被单击, 空白型, , 
.如果 (等于 (.现行子夹, 0))
    返回 ()
.否则
    赋值 (.现行子夹, 相减 (.现行子夹, 1))
.如果结束
判断按钮 ()

.窗口程序集 登陆窗口程序集, , , 

.子程序 _登陆窗口_可否被关闭, 逻辑型, , 
返回 (假)

.子程序 _确定按钮_被单击, 空白型, , 
.如果真 (验证密码 (.内容))
    销毁 ()
    返回 ()
.如果真结束
信息框 (“密码错误！”, 16, )
赋值 (.被选择字符数, -1)
获取焦点 ()

.子程序 _取消按钮_被单击, 空白型, , 
结束 ()

.子程序 _登陆窗口_创建完毕, 空白型, , 
赋值 (.内容, 相加 (“版本：”, #版本))

.窗口程序集 关于窗口程序集, , , 

.子程序 _确定按钮_被单击, 空白型, , 
销毁 ()

.子程序 _关于窗口_创建完毕, 空白型, , 
赋值 (.内容, 相加 (“版本：”, #版本))


 ' 不属于任何一个程序集、类模块的函数：
