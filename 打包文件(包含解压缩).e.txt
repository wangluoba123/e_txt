 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 299
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.常量 版权信息, "“双狮软件工作室出品  作者:林劲国”", , 
.常量 标题, "“双狮打包程序1.0”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' eCompress 7B68736E818E41c5A28B0AE4D43C128C 1 0 压缩解压支持库





.窗口程序集 窗口程序集1, , , 

.程序集变量 完成, 逻辑型, , , 
.子程序 _打开_被单击, 空白型, , 
.局部变量 文件名组, 文本型, , "0", 
.局部变量 变量, 整数型, , , 

赋值 (文件名组, 多文件对话框 (“打开”, “所有文件|*.*”, , , ))
.如果真 (等于 (取数组成员数 (文件名组), 0))
    信息框 (“文件不能为空!!”, 48, )
    返回 ()
.如果真结束
.计次循环首 (取数组成员数 (文件名组), 变量)
    文件名组.加入项目 ( [变量], )
.计次循环尾 ()
赋值 (.禁止, 假)
赋值 (.禁止, 假)

.子程序 _打包_被单击, 空白型, , 
.局部变量 文件号, 整数型, , , 
.局部变量 文件名, 文本型, , , 
.局部变量 i, 整数型, , , 
.局部变量 数据组, 字节集, , "0", 
.局部变量 打包数据, 字节集, , , 
.局部变量 扩展名组, 文本型, , "0", 
.局部变量 容器, 整数型, , , 
.局部变量 容器1, 文本型, , , 

赋值 (完成, 假)
.如果真 (等于 (.内容, “”))
    信息框 (“请先输入要打包的程序的名称！”, #错误图标, “输入名称”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果 (不等于 (寻找文本 (.内容, “\”, , 真), -1))
    赋值 (文件名, 取文本左边 (删首尾空 (.内容), 相减 (倒找文本 (删首尾空 (.内容), “\”, , 真), 1)))
    .如果真 (等于 (寻找文件 (相加 (文件名, “\*.*”), ), “”))
        信息框 (相加 (“你所指定的文件夹”, 文件名, “不存在，请重新输入。”, #换行符, “如果省略文件路径，编译后的文件默认将放置在”, 取运行目录 (), “下。”), #错误图标, “错误”)
        赋值 (.被选择字符数, -1)
        获取焦点 ()
        返回 ()
    .如果真结束
    赋值 (文件名, 删首尾空 (.内容))
.否则
    赋值 (文件名, 相加 (取运行目录 (), “\”, 删首尾空 (.内容)))
.如果结束
.如果真 (不等于 (取文本右边 (文件名, 4), “.RZP”))
    赋值 (文件名, 相加 (文件名, “.RZP”))
.如果真结束
.如果真 (文件是否存在 (文件名))
    .如果真 (等于 (信息框 (相加 (“RZP打包程序”, 文件名, “已经存在，你确认要覆盖它吗？”), 相加 (#询问图标, #确认取消钮), “询问”), #取消钮))
        信息框 (“请重新输入RZP打包程序的名称！”, #信息图标, “返回”)
        赋值 (.被选择字符数, -1)
        获取焦点 ()
        返回 ()
    .如果真结束
    
.如果真结束
赋值 (文件号, 打开文件 (文件名, #重写, ))
赋值 (.现行子夹, 1)
 ' 重定义数组 (数据组, 假, 取项目数 ())
置等待鼠标 ()
相加 (“※开始打包……”, #换行符).加入文本 ()
相加 (“※读入文件……”, #换行符).加入文本 ()
相加 (“※开始压缩……”, #换行符).加入文本 ()
.计次循环首 (取项目数 (), i)
    相加 (“※”, 相减 (i, 1).取项目文本 (), #换行符).加入文本 ()
    赋值 (容器, 倒找文本 (相减 (i, 1).取项目文本 (), “\”, , 真))
    赋值 (容器1, 取文本右边 (相减 (i, 1).取项目文本 (), 相减 (取文本长度 (相减 (i, 1).取项目文本 ()), 容器)))
    加入成员 (扩展名组, 容器1)
    赋值 (数据组 [i], 读入文件 (相减 (i, 1).取项目文本 ()))
.计次循环尾 ()
.如果 (写出数据 (文件号, 到文本 (取数组成员数 (数据组)), 数据组, 扩展名组, #版权信息))
    
.否则
    相加 (“※打包失败……”, #换行符).加入文本 ()
    关闭文件 (文件号)
    相加 (“※日期:”, 时间到文本 (取现行时间 (), ), #换行符).加入文本 ()
    相加 (“ =============================================”, #换行符).加入文本 ()
    赋值 (_启动窗口., #标题)
    赋值 (完成, 真)
    恢复鼠标 ()
    返回 ()
.如果结束
关闭文件 (文件号)
相加 (“※压缩完毕……”, #换行符).加入文本 ()
相加 (“※打包完毕……”, #换行符).加入文本 ()
相加 (“※日期:”, 时间到文本 (取现行时间 (), ), #换行符).加入文本 ()
相加 (“ =============================================”, #换行符).加入文本 ()
赋值 (_启动窗口., #标题)
清空 ()
赋值 (完成, 真)
恢复鼠标 ()

.子程序 _ZIP压缩_压缩进度, 逻辑型, , 
.参数 已完成百分比, 整数型, , 

.如果真 (大于或等于 (已完成百分比, 100))
    相加 (“※压缩完成……”, #换行符).加入文本 ()
.如果真结束
赋值 (_启动窗口., 未知支持库函数_3 ())

.子程序 _ZIP压缩_解压缩进度, 逻辑型, , 
.参数 已完成百分比, 整数型, , 

.如果真 (大于或等于 (已完成百分比, 100))
    相加 (“※解压缩完成……”, #换行符).加入文本 ()
.如果真结束
赋值 (_启动窗口., 未知支持库函数_3 ())

.子程序 __启动窗口_创建完毕, 空白型, , 
赋值 (_启动窗口., #标题)

.子程序 _按钮1_被单击, 空白型, , 
.如果真 (等于 (完成, 假))
    信息框 (“打包文件未完成!!”, 48, )
    返回 ()
.如果真结束
赋值 (.现行子夹, 0)

.子程序 _解包_被单击, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 文件数, 文本型, , , 
.局部变量 数据组, 字节集, , "0", 
.局部变量 扩展名组, 文本型, , "0", 
.局部变量 版权信息, 文本型, , , 
.局部变量 n, 整数型, , , 
.局部变量 容器, 整数型, , , 
.局部变量 找到, 文本型, , , 
.局部变量 编号, 整数型, , , 
.局部变量 前次取得, 逻辑型, , , 
.局部变量 临时文件名, 文本型, , , 

赋值 (.现行子夹, 1)
置等待鼠标 ()
赋值 (完成, 假)
.计次循环首 (取项目数 (), i)
    相加 (“※开始解包……”, #换行符).加入文本 ()
    相加 (“※读入待解包文件……”, #换行符).加入文本 ()
    相加 (“※开始解压文件……”, #换行符).加入文本 ()
    相加 (“※检测”, 相减 (i, 1).取项目文本 (), “解压文件……”, #换行符).加入文本 ()
    赋值 (文件号, 打开文件 (相减 (i, 1).取项目文本 (), #读写, ))
    .如果真 (等于 (文件号, 0))
        相加 (“※无法读取打包程序RZP文件”, 相减 (i, 1).取项目文本 (), “的信息！”, #换行符).加入文本 ()
        相加 (“※检测解压文件失败……”, #换行符).加入文本 ()
        相加 (“※解压文件失败……”, #换行符).加入文本 ()
        相加 (“※请确认此解压文件是RZP打包文件!!”, #换行符).加入文本 ()
        到循环尾 ()
    .如果真结束
    读入数据 (文件号, 文件数)
    相加 (“※解压文件数为:”, 到文本 (文件数), #换行符).加入文本 ()
    重定义数组 (数据组, 假, 到数值 (文件数))
    重定义数组 (扩展名组, 假, 到数值 (文件数))
    移到文件首 (文件号)
    读入数据 (文件号, 文件数, 数据组, 扩展名组, 版权信息)
    关闭文件 (文件号)
    .计次循环首 (到数值 (文件数), n)
        .如果真 (等于 (写到文件 (相加 (取运行目录 (), “\”, 到文本 (扩展名组 [n])), 数据组 [n]), 假))
            相加 (“※写出数据文件”, 取运行目录 (), “\”, 到文本 (扩展名组 [n]), “失败!!不可预料的错误!!”, #换行符).加入文本 ()
            到循环尾 ()
        .如果真结束
        相加 (“※写出数据文件:”, 取运行目录 (), “\”, 到文本 (扩展名组 [n]), “成功!!”, #换行符).加入文本 ()
    .计次循环尾 ()
.计次循环尾 ()
相加 (“※解包完毕……”, #换行符).加入文本 ()
.如果 (等于 (版权信息, “”))
    相加 (“※版权信息:无”, #换行符).加入文本 ()
.否则
    相加 (“※版权信息:”, 到文本 (版权信息), #换行符).加入文本 ()
.如果结束
相加 (“※日期:”, 时间到文本 (取现行时间 (), ), #换行符).加入文本 ()
相加 (“ =============================================”, #换行符).加入文本 ()
赋值 (_启动窗口., #标题)
清空 ()
赋值 (完成, 真)
恢复鼠标 ()



 ' 不属于任何一个程序集、类模块的函数：
