 ' 文件类型：Windows模块源码

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假



.常量 , , , 
.常量 TCM_FIRST, "4864", , 
.常量 CCM_FIRST, "8192", , 
.常量 CCM_GETUNICODEFORMAT, "8198", , 
.常量 CCM_SETUNICODEFORMAT, "8197", , 
.常量 , , , 
.常量 TCM_ADJUSTRECT, "4904", , 调整矩形
.常量 TCM_DELETEALLITEMS, "4873", , 删除全部子夹
.常量 TCM_DELETEITEM, "4872", , 删除子夹
.常量 TCM_DESELECTALL, "4914", , 全部取消选择
.常量 TCM_GETCURFOCUS, "4911", , 获取光标焦点
.常量 TCM_GETCURSEL, "4875", , 获取光标XXX？
.常量 TCM_GETEXTENDEDSTYLE, "4917", , 取扩展风格
.常量 TCM_GETIMAGELIST, "4866", , 取项目图片列表
.常量 TCM_GETITEMA, "4869", , 取项目
.常量 TCM_GETITEMCOUNT, "4868", , 取项目数
.常量 TCM_GETITEMRECT, "4874", , 取项目矩形
.常量 TCM_GETROWCOUNT, "4908", , 取行数
.常量 TCM_GETTOOLTIPS, "4909", , 取工具条提示
.常量 TCM_GETUNICODEFORMAT, "8198", , 取UNICODE格式
.常量 TCM_HIGHLIGHTITEM, "4915", , 
.常量 TCM_HITTEST, "4877", , 点击测试
.常量 TCM_INSERTITEMA, "4871", , 插入子夹
.常量 TCM_REMOVEIMAGE, "4906", , 移动图片
.常量 TCM_SETCURFOCUS, "4912", , 置光标焦点
.常量 TCM_SETCURSEL, "4876", , 置光标XXX？
.常量 TCM_SETEXTENDEDSTYLE, "4916", , 置扩展风格
.常量 TCM_SETIMAGELIST, "4867", , 置图片列表
.常量 TCM_SETITEMA, "4870", , 置项目
.常量 TCM_SETITEMEXTRA, "4878", , 置额外项目
.常量 TCM_SETITEMSIZE, "4905", , 置项目尺寸
.常量 TCM_SETMINTABWIDTH, "4913", , 置子夹栏最小宽度值
.常量 TCM_SETPADDING, "4907", , 置子夹栏尺寸
.常量 TCM_SETTOOLTIPS, "4910", , 置工具提示
.常量 TCM_SETUNICODEFORMAT, "8197", , 置UNICODE格式
.常量 , , , 
.常量 TCIF_IMAGE, "2", , 项目图片
.常量 TCIF_PARAM, "8", , 项目数值
.常量 TCIF_RTLREADING, "4", , 项目右对齐
.常量 TCIF_STATE, "16", , 状态
.常量 TCIF_TEXT, "1", , 项目文本


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库



 ' 所需要的模块
 ' 求真图片组类 G:\易语言编程\超级功能模块\超级功能模块之控件增强模块\求真图片组类.ec


数据类型 TCITEM, , 
    .成员 mask, 整数型, , , 
    .成员 dwState, 整数型, , , 
    .成员 dwStateMask, 整数型, , , 
    .成员 pszText, 文本型, , , 
    .成员 cchTextMax, 整数型, , , 
    .成员 iImage, 整数型, , , 
    .成员 lParam, 整数型, , , 

数据类型 RECT, , 
    .成员 左边, 整数型, , , 
    .成员 顶边, 整数型, , , 
    .成员 右边, 整数型, , , 
    .成员 底边, 整数型, , , 

数据类型 RECT, 公开, 
    .成员 Left, 整数型, , , 
    .成员 Top, 整数型, , , 
    .成员 Right, 整数型, , , 
    .成员 Bottom, 整数型, , , 


.DLL命令 GetClassName, 整数型, "user32.dll", "GetClassNameA", , 
    .参数 hwnd, 整数型, , 
    .参数 lpClassName, 文本型, , 
    .参数 nMaxCount, 整数型, , 

.DLL命令 SendMessage, 整数型, "user32.dll", "SendMessageA", , 
    .参数 hwnd, 整数型, , 
    .参数 wMsg, 整数型, , 
    .参数 wParam, 整数型, , 
    .参数 lParam, 整数型, , 类型为通用型，请在调试时调整其类型

.DLL命令 取数据地址, 整数型, "kernel32.dll", "lstrcpyn", , 
    .参数 目标, TCITEM, 传址, 
    .参数 源, TCITEM, 传址, 
    .参数 长度, 整数型, , 

.DLL命令 取数据地址1, 整数型, "kernel32.dll", "lstrcpyn", , 
    .参数 目标, RECT, 传址, 
    .参数 源, RECT, 传址, 
    .参数 长度, 整数型, , 

.DLL命令 UpdateWindow, 整数型, "user32.dll", "UpdateWindow", , 
    .参数 hwnd, 整数型, , 

.DLL命令 GetParent, 整数型, "user32.dll", "GetParent", , 
    .参数 窗口句柄, 整数型, , 

.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。
载入 (窗口1, , 真)

.类模块 选择夹控制类, , , 

.程序集变量 集_选择夹句柄, 整数型, , , 
.程序集变量 集_选择夹, 选择夹, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 _初始化类, 逻辑型, 公开, 
.参数 目标选择夹, 选择夹, , 

.判断开始 (等于 (集_选择夹句柄, 0))
    赋值 (集_选择夹句柄, 目标选择夹.取窗口句柄 ())
    赋值 (集_选择夹, 目标选择夹)
    返回 (真)
.默认
    返回 (假)
.判断结束
 ' .判断开始 (等于 (子文本替换 (“SysTabControl32”, 取类名 (目标选择夹), , , 1, 假), “”))
     ' 返回 (真)
.默认
     ' 返回 (假)
.判断结束


.子程序 取类名, 文本型, , 
.参数 窗口句柄, 整数型, , 

.局部变量 Temp, 文本型, , , 

赋值 (Temp, 取空白文本 (256))
GetClassName (窗口句柄, Temp, 256)
返回 (删首尾空 (Temp))

.子程序 删除子夹, 逻辑型, , 成功返回真
.参数 欲删除的子夹索引, 整数型, , 0 代表子夹一，1 代表子夹二，如此类推。-1为最末端子夹。(注意：易语言的子夹索引是从1计起，这个类是按照微软的标准从0计起)。

.局部变量 结果, 整数型, , , 

.如果真 (等于 (欲删除的子夹索引, -1))
    赋值 (欲删除的子夹索引, 相减 (取子夹数目 (), 1))
.如果真结束
赋值 (结果, SendMessage (集_选择夹句柄, #TCM_DELETEITEM, 欲删除的子夹索引, 0)) ' 参数一表示要删除的子夹索引，从0开始
返回 (选择 (不等于 (结果, 0), 真, 假))

.子程序 插入子夹, 整数型, 公开, 成功返回位置索引，失败返回-1
.参数 插入位置, 整数型, 可空, 默认为-1，加到子夹末尾。0 代表子夹一，1 代表子夹二，如此类推(注意：易语言的子夹索引是从1计起，这个类是按照微软的标准从0计起)。
.参数 子夹标题, 文本型, , 
.参数 子夹项目数值, 整数型, 可空, 默认为0
.参数 图片索引, 整数型, 可空, 默认为-1(无图片)

.局部变量 子夹结构, TCITEM, , , 
.局部变量 结果, 整数型, , , 
.局部变量 子夹数, 整数型, , , 

.如果真 (或者 (是否为空 (图片索引), 等于 (取图片组句柄 (), 0)))
    赋值 (图片索引, -1)
.如果真结束
赋值 (子夹数, 取子夹数目 ())
.如果真 (或者 (是否为空 (插入位置), 大于 (插入位置, 相减 (子夹数, 1)), 等于 (插入位置, -1)))
    赋值 (插入位置, 子夹数)
.如果真结束
赋值 (子夹结构.mask, 相加 (#TCIF_TEXT, #TCIF_IMAGE, #TCIF_PARAM))
赋值 (子夹结构.dwState, 0)
赋值 (子夹结构.dwStateMask, 0)
赋值 (子夹结构.pszText, 子夹标题)
赋值 (子夹结构.cchTextMax, 0)
赋值 (子夹结构.iImage, 图片索引)
赋值 (子夹结构.lParam, 子夹项目数值)
赋值 (结果, SendMessage (集_选择夹句柄, #TCM_INSERTITEMA, 插入位置, 取数据地址 (子夹结构, 子夹结构, 0))) ' 参数一表示要删除的子夹索引，从0开始
.如果真 (等于 (子夹数, 0))
    集_选择夹.重画 ()
     ' UpdateWindow (GetParent (集_选择夹句柄))
.如果真结束
返回 (结果)


.子程序 取子夹数目, 整数型, , 
返回 (SendMessage (集_选择夹句柄, #TCM_GETITEMCOUNT, 0, 0))

.子程序 取子夹标题, 文本型, , 
.参数 子夹索引, 整数型, , 0 代表子夹一，1 代表子夹二，如此类推。-1为最末端子夹。(注意：易语言的子夹索引是从1计起，这个类是按照微软的标准从0计起)。

.局部变量 子夹结构, TCITEM, , , 
.局部变量 结果, 整数型, , , 

.如果真 (等于 (子夹索引, -1))
    赋值 (子夹索引, 相减 (取子夹数目 (), 1))
.如果真结束
赋值 (子夹结构.mask, #TCIF_TEXT)
赋值 (子夹结构.dwState, 0)
赋值 (子夹结构.dwStateMask, 0)
赋值 (子夹结构.pszText, 取空白文本 (256))
赋值 (子夹结构.cchTextMax, 256)
赋值 (子夹结构.iImage, -1)
赋值 (子夹结构.lParam, 1)
SendMessage (集_选择夹句柄, #TCM_GETITEMA, 子夹索引, 取数据地址 (子夹结构, 子夹结构, 0)) ' 参数一表示要删除的子夹索引，从0开始
返回 (子夹结构.pszText)

.子程序 取子夹数值, 整数型, , 
.参数 子夹索引, 整数型, , 0 代表子夹一，1 代表子夹二，如此类推。-1为最末端子夹。(注意：易语言的子夹索引是从1计起，这个类是按照微软的标准从0计起)。

.局部变量 子夹结构, TCITEM, , , 
.局部变量 结果, 整数型, , , 

.如果真 (等于 (子夹索引, -1))
    赋值 (子夹索引, 相减 (取子夹数目 (), 1))
.如果真结束
赋值 (子夹结构.mask, #TCIF_PARAM)
SendMessage (集_选择夹句柄, #TCM_GETITEMA, 子夹索引, 取数据地址 (子夹结构, 子夹结构, 0)) ' 参数一表示要删除的子夹索引，从0开始
返回 (子夹结构.lParam)


.子程序 置子夹标题, 逻辑型, , 
.参数 子夹索引, 整数型, , 0 代表子夹一，1 代表子夹二，如此类推。-1为最末端子夹。(注意：易语言的子夹索引是从1计起，这个类是按照微软的标准从0计起)。
.参数 欲置入的子夹标题, 文本型, , 

.局部变量 子夹结构, TCITEM, , , 
.局部变量 结果, 整数型, , , 

.如果真 (等于 (子夹索引, -1))
    赋值 (子夹索引, 相减 (取子夹数目 (), 1))
.如果真结束
赋值 (子夹结构.mask, #TCIF_TEXT)
赋值 (子夹结构.dwState, 0)
赋值 (子夹结构.dwStateMask, 0)
赋值 (子夹结构.pszText, 欲置入的子夹标题)
赋值 (子夹结构.cchTextMax, 0)
赋值 (子夹结构.iImage, -1)
赋值 (子夹结构.lParam, 1)
赋值 (结果, SendMessage (集_选择夹句柄, #TCM_SETITEMA, 子夹索引, 取数据地址 (子夹结构, 子夹结构, 0))) ' 参数一表示要删除的子夹索引，从0开始
返回 (选择 (不等于 (结果, 0), 真, 假))

.子程序 置子夹数值, 逻辑型, , 
.参数 子夹索引, 整数型, , 0 代表子夹一，1 代表子夹二，如此类推。-1为最末端子夹。(注意：易语言的子夹索引是从1计起，这个类是按照微软的标准从0计起)。
.参数 欲置入的子夹数值, 整数型, , 

.局部变量 子夹结构, TCITEM, , , 
.局部变量 结果, 整数型, , , 

.如果真 (等于 (子夹索引, -1))
    赋值 (子夹索引, 相减 (取子夹数目 (), 1))
.如果真结束
赋值 (子夹结构.mask, #TCIF_PARAM)
赋值 (子夹结构.lParam, 欲置入的子夹数值)
赋值 (结果, SendMessage (集_选择夹句柄, #TCM_SETITEMA, 子夹索引, 取数据地址 (子夹结构, 子夹结构, 0))) ' 参数一表示要删除的子夹索引，从0开始
返回 (选择 (不等于 (结果, 0), 真, 假))

.子程序 选择子夹, 空白型, , 
.参数 欲选择的子夹索引, 整数型, , 0 代表子夹一，1 代表子夹二，如此类推。-1为最末端子夹。(注意：易语言的子夹索引是从1计起，这个类是按照微软的标准从0计起)。

.如果真 (等于 (欲选择的子夹索引, -1))
    赋值 (欲选择的子夹索引, 相减 (取子夹数目 (), 1))
.如果真结束
SendMessage (集_选择夹句柄, #TCM_SETCURFOCUS, 欲选择的子夹索引, 0) ' 参数一表示要删除的子夹索引，从0开始


.子程序 取现行子夹, 整数型, , 0 代表子夹一，1 代表子夹二，如此类推(注意：易语言的子夹索引是从1计起，这个类是按照微软的标准从0计起)。
返回 (SendMessage (集_选择夹句柄, #TCM_GETCURFOCUS, 0, 0)) ' 参数一表示要删除的子夹索引，从0开始

.子程序 删除全部子夹, 空白型, , 
SendMessage (集_选择夹句柄, #TCM_DELETEALLITEMS, 0, 0) ' 参数一表示要删除的子夹索引，从0开始


.子程序 TCM_DESELECTALL, 空白型, , 
 ' SendMessage (集_选择夹句柄, #TCM_DESELECTALL, 0, 0)  ' 参数一表示要删除的子夹索引，从0开始


.子程序 取图片组句柄, 整数型, , 
返回 (SendMessage (集_选择夹句柄, #TCM_GETIMAGELIST, 0, 0)) ' 参数一表示要删除的子夹索引，从0开始


.子程序 TCM_GETROWCOUNT, 整数型, , 
返回 (SendMessage (集_选择夹句柄, #TCM_GETROWCOUNT, 0, 0))


.子程序 置入图片组, 空白型, , 
.参数 图片组句柄, 整数型, , 

SendMessage (集_选择夹句柄, #TCM_SETIMAGELIST, 0, 图片组句柄) ' 参数一表示要删除的子夹索引，从0开始


.子程序 置子夹图片, 逻辑型, , 
.参数 子夹索引, 整数型, , 0 代表子夹一，1 代表子夹二，如此类推。-1为最末端子夹。(注意：易语言的子夹索引是从1计起，这个类是按照微软的标准从0计起)。
.参数 图片索引, 整数型, , 

.局部变量 子夹结构, TCITEM, , , 
.局部变量 结果, 整数型, , , 

.如果真 (等于 (子夹索引, -1))
    赋值 (子夹索引, 相减 (取子夹数目 (), 1))
.如果真结束
赋值 (子夹结构.mask, #TCIF_IMAGE)
赋值 (子夹结构.iImage, 图片索引)
赋值 (结果, SendMessage (集_选择夹句柄, #TCM_SETITEMA, 子夹索引, 取数据地址 (子夹结构, 子夹结构, 0))) ' 参数一表示子夹索引，从0开始
返回 (选择 (不等于 (结果, 0), 真, 假))


.子程序 置子夹栏尺寸, 空白型, , 
.参数 子夹栏宽度, 空白型, , 
.参数 子夹栏高度, 空白型, , 

SendMessage (集_选择夹句柄, #TCM_SETITEMSIZE, 0, 合并整数 (子夹栏宽度, 子夹栏高度))


.子程序 置子夹栏宽度, 空白型, , 
.参数 子夹栏宽度, 空白型, , 

SendMessage (集_选择夹句柄, #TCM_SETMINTABWIDTH, 0, 子夹栏宽度)

.子程序 方法1, 空白型, , 
.局部变量 RECT, RECT, , , 

 ' SendMessage (集_选择夹句柄, #TCM_ADJUSTRECT, 1, 取数据地址1 (RECT, RECT, 0))
 ' 暂停 ()

.窗口程序集 窗口程序集1, , , 

.程序集变量 选择夹控制, 选择夹控制类, , , 
.程序集变量 图片组, 求真图片组类, , , 
.子程序 _窗口1_创建完毕, 空白型, , 
选择夹控制._初始化类 ()
图片组.置入图片组文件 (“图标组.eil”, 真)
图片组.置背景色 (取默认底色 ())
未知函数_67174854 ().未知函数_67174853 ()
0.未知函数_67174857 (0)
1.未知函数_67174857 (1)
2.未知函数_67174857 (2)


.子程序 _按钮1_被单击, 空白型, , 
选择夹控制.置子夹栏宽度 (100)


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 In, 整数型, , , 

 ' 输出调试文本 (选择夹控制.置子夹数值 (-1, 100))
赋值 (In, 选择夹控制.插入子夹 (-1, “AAA”, 50, 0))
 ' 输出调试文本 (选择夹控制.取子夹数值 (-1))

.子程序 _选择夹1_被单击, 空白型, , 
输出调试文本 (.)


.子程序 _按钮3_被单击, 空白型, , 
 ' 选择夹控制.删除全部子夹 ()
选择夹控制.删除子夹 (2)

.类模块 求真图片组类, , , 

.子程序 建空图片组, 逻辑型, , 默认为16*16
.参数 单一图片宽度, 整数型, 可空, 
.参数 单一图片高度, 整数型, 可空, 



.子程序 取图片数, 整数型, , 返回指定图片组数据中所包含图片的数目。


.子程序 取图片组图片, 字节集, , 返回图片组数据中所包含的指定图片，成功返回所获取图片的数据，失败返回空字节集。
.参数 欲获取图片位置, 整数型, , 
.参数 透明填充色, 整数型, 可空, 本参数指定用作填充图片透明背景部分的颜色。如果被省略，默认值为常量值“#白色”。



.子程序 删除图片组图片, 逻辑型, , 删除图片组数据中指定位置处的图片
.参数 欲删除图片位置, 整数型, , 位置值从 0 开始。
.参数 欲删除图片数目, 整数型, 可空, 如果本参数被省略，默认值为 1 。



.子程序 提取加入图片, 整数型, , 成功返回所加入图标在被加入图片组中的位置索引，该索引值从 0 开始。如果失败，返回 -1 。
.参数 图标所在文件, 文本型, , 
.参数 图标索引, 整数型, 可空, 从 0 开始。如果本参数被省略，默认值为 0 



.子程序 合并图片组, 逻辑型, , 将两份图片组数据合并到一起形成新的图片组数据
.参数 欲合并进来的图片组句柄, 整数型, , 



.子程序 加入图片, 整数型, , 成功返回所加入图片在被加入图片组中的位置索引，该索引值从 0 开始。如果失败，返回 -1 。
.参数 欲加入图片, 字节集, , 
.参数 图片透明色, 整数型, 可空, 如果为常量值“#默认色”，则系统自动取该图片最左上角一点的颜色值为透明色。如果本参数被省略，默认值为常量值“#默认色”



.子程序 取图片组句柄, 整数型, , 


.子程序 取图片组尺寸, 空白型, , 
.参数 单一图片宽度, 整数型, 参考, 
.参数 单一图片高度, 整数型, 参考, 



.子程序 画图片组图片, 逻辑型, , 
.参数 欲画出的设备场景, 整数型, , 
.参数 欲画出的图片索引, 整数型, 可空, 默认为0
.参数 画出的左边, 整数型, 可空, 
.参数 画出的顶边, 整数型, 可空, 
.参数 设备场景背景填充范围, RECT, 可空, 
.参数 设备场景背景填充颜色, 整数型, 可空, 



.子程序 取背景色, 整数型, , 


.子程序 置背景色, 空白型, , 
.参数 新背景色, 整数型, , 



.子程序 置入图片组文件, 逻辑型, , 
.参数 图片组文件名, 文本型, , 
.参数 是否易语言图标组, 逻辑型, 可空, 



.子程序 置入图片组数据, 逻辑型, , 
.参数 图片组数据, 字节集, , 
.参数 是否易语言图标组, 逻辑型, 可空, 



.子程序 置入图片组, 逻辑型, , 
.参数 图片组句柄, 整数型, , 



.子程序 取图片组数据, 字节集, , 
.参数 是否置为易语言图标组, 逻辑型, 可空, 如果为假则为标准的图片组数据



.子程序 销毁, 空白型, , 



 ' 不属于任何一个程序集、类模块的函数：
