 ' 文件类型：Windows窗口程序

 ' 程序名称：聊天室服务端
 ' 程序描述：此为聊天室的服务端程序，用作进行客户群的管理和消息分发。
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 700
    顶边 = 0
    宽度 = 690
    高度 = 591
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\MusicServer.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “网吧大厅音乐点播系统 V1.1”
    帮助文件名 = “”

窗口 系统设置
    左边 = 50
    顶边 = 50
    宽度 = 280
    高度 = 303
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 2
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “设置”
    帮助文件名 = “”



.图片 托盘图标, " ' 已保存到：D:\易语言学习\Data\MusicServer.e\托盘图标", , 
.声音 客户消息, " ' 已保存到：D:\易语言学习\Data\MusicServer.e\客户消息", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库
 ' iext6 {E60056EA-07A8-4bf5-B6F0-DF05DE6FAE1F} 1 1 扩展界面支持库六
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 1 1 应用接口支持库
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 2 2 扩展界面支持库三
 ' wmp9.npk {6BF52A52-394A-11d3-B153-00C04F79FAA6}##0 1 0 Windows媒体播放器 0,{19A6627B-DA9E-47C1-BB23-00B5E668236A},IWMPEvents,{5001,5101,5102,5002,5301,5403,5401,5402,5501,5601,5201,5202,5203,5204,5701,5801,5804,5805,5802,5803,5806,5807,5808,5809,5820,5810,5811,5812,5818,5819,5821,5823,5822,6501,6502,6503,6504,6505,6506,6507,6508,6509,6510,6511,6512,},{},{}2,{00000000-0000-0000-0000-000000000000},WMPPlaylistChangeEventType,{},{1073741835,1073741834,1073741833,1073741832,1073741831,1073741830,1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}1,{6BF52A52-394A-11D3-B153-00C04F79FAA6},WindowsMediaPlayer,{3,4,5,6,8,9,12,7,13,14,15,17,40,41,42,27,28,6,13,},{26,25,24,23,22,21,19,18,16,11,10,2,1,},{5001,5101,5102,5002,5301,5403,5401,5402,5501,5601,5201,5202,5203,5204,5701,5801,5804,5805,5802,5803,5806,5807,5808,5809,5820,5810,5811,5812,5818,5819,5821,5823,5822,6501,6502,6503,6504,6505,6506,6507,6508,6509,6510,6511,6512,}0,{BC17E5B7-7561-4C18-BB90-17D485775659},IWMPCore2,{3,4,5,6,8,9,12,7,13,14,15,17,40,6,13,},{18,16,11,10,2,1,},{}0,{D84CCA99-CCE2-11D2-9ECC-0000F8085981},IWMPCore,{3,4,5,6,8,9,12,7,13,14,15,17,6,13,},{18,16,11,10,2,1,},{}2,{00000000-0000-0000-0000-000000000000},WMPOpenState,{},{1073741845,1073741844,1073741843,1073741842,1073741841,1073741840,1073741839,1073741838,1073741837,1073741836,1073741835,1073741834,1073741833,1073741832,1073741831,1073741830,1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}2,{00000000-0000-0000-0000-000000000000},WMPPlayState,{},{1073741836,1073741835,1073741834,1073741833,1073741832,1073741831,1073741830,1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{74C09E02-F828-11D2-A74B-00A0C905F36E},IWMPControls,{62,51,52,53,54,55,58,59,60,63,60,},{61,57,56,},{}0,{94D55E95-3FAC-11D3-B155-00C04F79FAA6},IWMPMedia,{763,755,756,760,761,762,765,766,767,},{759,758,757,754,753,752,764,751,},{}0,{D5F0F4F1-130C-11D3-B14E-00C04F79FAA6},IWMPPlaylist,{211,212,203,204,213,205,206,207,208,209,},{210,202,201,},{}0,{9104D1AB-80C9-4FED-ABF0-2E6417A6DF14},IWMPSettings,{113,110,111,},{112,107,102,106,105,104,103,109,108,101,},{}0,{8363BC22-B4B4-4B19-989D-1CD765749DD1},IWMPMediaCollection,{452,453,454,455,456,457,458,459,461,470,471,472,},{},{}0,{4A976298-8C0D-11D3-B389-00C04F68574B},IWMPStringCollection,{402,},{401,},{}0,{10A13217-23A7-439B-B1C0-D847C79B7774},IWMPPlaylistCollection,{552,553,554,556,560,561,562,},{},{}0,{679409C0-99F7-11D3-9FB7-00105AA620BB},IWMPPlaylistArray,{502,},{501,},{}0,{EC21B779-EDEF-462D-BBA4-AD9DDE2B29A7},IWMPNetwork,{813,814,815,816,817,818,819,820,821,822,},{826,825,824,823,812,811,810,809,808,807,806,805,804,803,802,801,},{}0,{EE4C8FE2-34B2-11D3-A3BF-006097C9B344},IWMPCdromCollection,{302,303,},{301,},{}0,{CFAB6E98-8730-11D3-B388-00C04F68574B},IWMPCdrom,{252,253,},{251,},{}0,{4F2DF574-C588-11D3-9ED0-00C04FB6E937},IWMPClosedCaption,{},{954,953,952,951,},{}0,{A12DCF7D-14AB-4C1B-A8CD-63909F06025B},IWMPError,{851,853,854,},{852,},{}0,{3614C646-3B3B-4DE7-A81E-930E3F2127B3},IWMPErrorItem,{903,},{905,904,902,901,},{}0,{8DA61686-4668-4A5C-AE5D-803193293DBE},IWMPDVD,{1001,1003,1004,1005,1006,},{1002,},{}0,{40897764-CEAB-47BE-AD4A-8E28537F9BBF},IWMPPlayerApplication,{1101,1102,},{1104,1103,},{}0,{54062B68-052A-4C25-A39F-8B63346511D4},IWMPPlayer3,{3,4,5,6,8,9,12,7,13,14,15,17,40,6,13,},{25,24,23,22,21,19,18,16,11,10,2,1,},{}0,{0E6B01D1-D407-4C85-BF5F-1C01F6150280},IWMPPlayer2,{3,4,5,6,8,9,12,7,13,14,15,17,6,13,},{25,24,23,22,21,19,18,16,11,10,2,1,},{}0,{6BF52A4F-394A-11D3-B153-00C04F79FAA6},IWMPPlayer,{3,4,5,6,8,9,12,7,13,14,15,17,6,13,},{23,22,21,19,18,16,11,10,2,1,},{}0,{F75CCEC0-C67C-475C-931E-8719870BEE7D},IWMPErrorItem2,{903,},{906,905,904,902,901,},{}0,{6F030D25-0890-480F-9775-1F7E40AB5B8E},IWMPControls2,{62,51,52,53,54,55,58,59,60,63,64,60,},{61,57,56,},{}0,{AB7C88BB-143E-4EA4-ACC3-E4350B2106C3},IWMPMedia2,{763,755,756,760,761,762,765,766,767,768,},{759,758,757,754,753,752,764,751,},{}0,{F118EFC7-F03A-4FB4-99C9-1C02A5C1065B},IWMPMedia3,{763,755,756,760,761,762,765,766,767,768,769,770,},{759,758,757,754,753,752,764,751,},{}0,{5C29BBE0-F87D-4C45-AA28-A70F0230FFA9},IWMPMetadataPicture,{},{1054,1053,1052,1051,},{}0,{769A72DB-13D2-45E2-9C48-53CA9D5B7450},IWMPMetadataText,{},{1055,1056,},{}0,{FDA937A4-EECE-4DA5-A0B6-39BF89ADE2C2},IWMPSettings2,{113,110,111,116,},{115,114,112,107,102,106,105,104,103,109,108,101,},{}0,{A1D1110E-D545-476A-9A78-AC3E4CB1E6BD},IWMPControls3,{62,51,52,53,54,55,58,59,60,63,64,66,67,70,60,},{71,69,68,65,61,57,56,},{}0,{350BA78B-6BC8-4113-A5F5-312056934EB6},IWMPClosedCaption2,{956,957,959,},{958,955,954,953,952,951,},{}0,{E41C88DD-2364-4FF7-A0F5-CA9859AF783F},IAppDispatch,{105,106,110,111,},{113,112,109,108,107,104,103,102,101,100,},{}0,{EF870383-83AB-4EA9-BE48-56FA4251AF10},IWMPSafeBrowser,{8403,8404,8405,8406,8407,8408,8409,},{8402,8401,8400,},{}0,{21D077C1-4BAA-11D3-BD45-00C04F6EA5AE},IWMPObjectExtendedProps,{2015,2017,},{2020,2019,2018,2016,2014,2013,2012,2011,2010,2009,2008,2007,2006,2005,2004,2003,2002,2001,2000,},{}0,{72F486B1-0D43-11D3-BD3F-00C04F6EA5AE},IWMPLayoutSubView,{2015,2017,},{2306,2305,2304,2303,2302,2301,2300,2020,2019,2018,2016,2014,2013,2012,2011,2010,2009,2008,2007,2006,2005,2004,2003,2002,2001,2000,},{}0,{172E905D-80D9-4C2F-B7CE-2CCB771787A2},IWMPLayoutView,{2015,2017,2318,2319,2320,2321,2322,2323,2324,},{2317,2316,2315,2314,2313,2312,2311,2309,2308,2307,2306,2305,2304,2303,2302,2301,2300,2020,2019,2018,2016,2014,2013,2012,2011,2010,2009,2008,2007,2006,2005,2004,2003,2002,2001,2000,},{}0,{5AF0BEC1-46AA-11D3-BD45-00C04F6EA5AE},IWMPEventObject,{2200,2204,2205,},{2217,2216,2215,2214,2213,2212,2211,2210,2209,2208,2207,2206,2203,2202,2201,},{}0,{6FCAE13D-E492-4584-9C21-D2C052A2A33A},IWMPTheme,{2506,2507,2508,2515,2509,2510,2511,2512,2513,2514,},{2505,2504,2503,2502,2501,2500,},{}0,{B2C2D18E-97AF-4B6A-A56B-2FFFF470FB81},IWMPLayoutSettingsDispatch,{2810,2815,},{2866,2865,2864,2863,2862,2861,2860,2859,2858,2854,2853,2852,2851,2850,2857,2856,2855,2849,2848,2847,2846,2845,2844,2843,2842,2841,2840,2839,2838,2837,2836,2835,2834,2833,2832,2831,2830,2829,2828,2827,2826,2825,2824,2823,2822,2821,2820,2819,2818,2817,2816,2813,2811,2809,2808,2807,2867,2805,2804,2803,2802,2801,2800,},{}0,{504F112E-77CC-4E3C-A073-5371B31D9B36},IWMPNowPlayingHelperDispatch,{2901,2902,2903,2904,2905,2909,2910,2911,2917,2918,2919,2920,2921,2922,2923,2925,2926,2926,},{2924,2916,2915,2914,2913,2912,},{}0,{87291B51-0C8E-11D3-BB2A-00A0C93CA73A},WMPButtonCtrl,{},{5114,5113,5112,5110,5109,5108,5107,5106,5105,5104,5103,5102,},{5120,}0,{FC1880CF-83B9-43A7-A066-C44CE8C82583},WMPListBoxCtrl,{6120,6111,6112,6113,6114,6115,6116,6117,6118,6122,6123,6124,},{6125,6121,6110,6109,6107,6106,6105,6104,6103,6102,6101,6100,6108,},{}0,{D255DFB8-C22A-42CF-B8B7-F15D7BCF65D6},IWMPListBoxItem,{6119,},{},{}0,{63D9D30F-AE4C-4678-8CA8-5720F4FE4419},IWMPPlaylistCtrlColumn,{},{5673,5672,5671,5670,},{}0,{F2BF2C90-405F-11D3-BB39-00A0C93CA73A},WMPSliderCtrl,{},{5426,5425,5424,5423,5422,5421,5420,5419,5418,5417,5416,5415,5414,5413,5412,5411,5410,5409,5408,5407,5406,5405,5404,5403,5402,5400,},{5430,5431,5432,}0,{61CECF11-FC3A-11D2-A1CD-005004602752},WMPVideoCtrl,{},{5709,5708,5703,5707,5706,5704,5702,5701,5700,},{5720,5721,}0,{47DEA830-D619-4154-B8D8-6B74845D6A2D},WMPEffects,{5502,5503,5504,5505,5509,5510,5511,5512,5521,5522,5505,},{5520,5518,5517,5516,5515,5514,5513,5506,5507,5501,5500,},{}0,{93EB32F5-87B1-45AD-ACC6-0F2483DB83BB},WMPEqualizerSettingsCtrl,{5815,5815,5814,5816,5817,5828,},{5833,5832,5831,5830,5829,5826,5827,5825,5824,5823,5822,5821,5820,5819,5818,5801,5813,5812,5811,5810,5809,5808,5807,5806,5805,5804,5800,},{}0,{AE7BFAFE-DCC8-4A73-92C8-CC300CA88859},WMPVideoSettingsCtrl,{5904,},{5903,5902,5901,5900,},{}0,{D9DE732A-AEE9-4503-9D11-5605589977A8},WMPLibraryTreeCtrl,{6409,6410,6411,6409,},{6408,6407,6406,6405,6404,6403,6402,6401,},{}0,{6342FCED-25EA-4033-BDDB-D049A14382D3},WMPEditCtrl,{6012,6013,6014,6015,6016,6017,6018,},{6011,6010,6009,6008,6007,6006,6005,6004,6003,6002,6001,6000,0,},{}0,{5D0AD945-289E-45C5-A9C6-F301F0152108},IWMPPluginUIHost,{6203,6204,},{6202,6201,},{}0,{BAB3768B-8883-4AEC-9F9B-E14C947913EF},WMPMenuCtrl,{6301,6302,6303,6304,6305,6306,6308,6309,},{6307,},{}0,{6B28F900-8D64-4B80-9963-CC52DDD1FBB4},WMPAutoMenuCtrl,{6501,},{},{}0,{AE3B6831-25A9-11D3-BD41-00C04F6EA5AE},WMPRegionalButtonCtrl,{5312,5313,5314,},{5316,5315,5311,5310,5309,5308,5306,5305,5304,5303,5302,5301,5300,},{}0,{09AEFF11-69EF-11D3-BD4D-00C04F6EA5AE},WMPRegionalButton,{5344,},{5347,5346,5345,5343,5342,5341,5340,5339,5333,5332,5331,5330,},{5360,5361,5362,5363,5364,5365,5366,5367,5368,5369,5370,5371,}0,{95F45AA3-ED0A-11D2-BA67-0000F80855E6},WMPCustomSliderCtrl,{},{5008,5012,5004,5003,5001,5002,5011,5010,5006,5005,5009,},{5020,5021,5022,}0,{DDDA102E-0E17-11D3-A2E2-00C04F79F88E},WMPTextCtrl,{},{5229,5228,5227,5226,5225,5224,5223,5222,5221,5217,5216,5215,5214,5213,5212,5211,5210,5209,5208,5207,5206,5201,},{}0,{5F9CFD93-8CAD-11D3-9A7E-00C04F8EFB70},WMPPlaylistCtrl,{5601,5623,5624,5625,5626,5628,5629,5630,5631,5632,5633,5634,5635,5636,5637,5644,5645,5646,5647,5648,5649,5601,},{5658,5656,5655,5654,5653,5652,5651,5650,5643,5642,5622,5621,5620,5619,5618,5617,5616,5615,5614,5613,5612,5609,5608,5607,5605,5604,5603,5602,},{}0,{891EADB1-1C45-48B0-B704-49A888DA98C4},ITaskCntrCtrl,{1610743808,1610743810,1610743808,},{},{}0,{09428D37-E0B9-11D2-B147-00C04F79FAA6},WMPCore,{3,4,5,6,8,9,12,7,13,14,15,17,40,41,42,6,13,},{18,16,11,10,2,1,},{5001,5101,5102,5002,5301,5403,5401,5402,5501,5601,5201,5202,5203,5204,5701,5801,5804,5805,5802,5803,5806,5807,5808,5809,5820,5810,5811,5812,5818,5819,5821,5823,5822,}0,{6B550945-018F-11D3-B14A-00C04F79FAA6},IWMPGraphEventHandler,{8151,8173,8153,8157,8156,8158,8172,8159,8160,8161,8178,8162,8163,8165,8166,8167,8168,8169,8170,8171,8174,8177,8179,8180,},{},{}0,{00000000-0000-0000-0000-000000000000},ULONG_PTR,{},{},{}0,{28682B8E-9055-47A9-A179-8E0BAB1164D1},IAssaultVis,{},{},{}0,{F8578BFA-CD8F-4CE1-A684-5B7E85FCA7DC},IBattery,{2,},{1,},{}0,{40C6BDE7-9C90-49D4-AD20-BEF81A6C5F22},IBatteryPreset,{},{1,},{}0,{F85E2D65-207D-48DB-84B1-915E1735DB17},IBatteryRandomPreset,{},{1,},{}0,{876E7208-0172-4EBB-B08B-2E1D30DFE44C},IBatterySavedPreset,{},{1,},{}0,{33E9291A-F6A9-11D2-9435-00A0C92A2F2D},IBarsEffect,{},{8016,8015,8014,8013,8012,8010,8009,8008,8007,8006,8005,8004,8003,8002,8001,8000,},{}0,{3984E7EB-08EF-11D3-9447-00A0C92A2F2D},ISpikesEffect,{},{8205,8204,8203,8202,8201,},{}0,{37327700-EF20-11D2-9431-00A0C92A2F2D},IDotPlaneEffect,{8313,8314,},{8315,8312,8311,8310,8309,8308,8307,8305,8304,8303,8302,8301,8300,},{}0,{E31E7583-32D5-491C-B611-825D032B02CF},IPlenoptic,{},{},{}0,{E2CC638C-FD2C-409B-A1EA-5DDB72DC8E84},IWMPExternal,{10018,},{10012,10005,},{}0,{D10CCDFF-472D-498C-B5FE-3630E5405E0A},IWMPExternalColors,{10018,},{10017,10016,10015,10014,10013,10012,10005,},{}0,{FFFB0104-CCBB-4513-8B6B-46F5098FAB43},IWMPTemplatesExternal,{10018,10011,10010,10019,10006,10021,10020,10022,10023,},{10024,10017,10016,10015,10014,10013,10012,10005,},{}0,{2E922378-EE70-4CEB-BBAB-CE7CE4A04816},IWMPSubscriptionServiceExternal,{10018,10009,},{10012,10005,},{}0,{E15E9AD1-8F20-4CC4-9EC7-1A328CA86A0D},IWMPDownloadManager,{1151,1152,},{},{}0,{7AAA2D24-B37A-4E11-82C1-E071246463A4},IWMPDownloadCollection,{1203,1204,1205,1206,},{1202,1201,},{}0,{C9470E8E-3F6B-46A9-A0A9-452815C34297},IWMPDownloadItem,{1256,1257,1258,},{1255,1254,1253,1252,1251,},{}2,{00000000-0000-0000-0000-000000000000},WMPSubscriptionDownloadState,{},{1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{2D7EF888-1D3C-484A-A906-9F49D99BB344},IWMPCDDVDWizardExternal,{10018,10001,10002,10007,10008,10011,10010,},{10017,10016,10015,10014,10013,10012,10005,},{}2,{00000000-0000-0000-0000-000000000000},WMP_WRITENAMESEX_TYPE,{},{1073741827,1073741826,1073741825,1073741824,},{}0,{F81B2A59-02BC-4003-8B2F-C124AF66FC66},IWMPBaseExternal,{10018,},{10012,10005,},{}0,{3148E685-B243-423D-8341-8480D6EFF674},IWMPOfflineExternal,{10018,10025,},{10012,10005,},{}





.窗口程序集 启动窗口, , , 

.程序集变量 日期, 文本型, , , 
.程序集变量 时间, 文本型, , , 
.程序集变量 客户数, 整数型, , , 
.程序集变量 匿名程序集变量_1575, 空白型, , , 
.程序集变量 点播播放状态, 逻辑型, , , 点播变量
.程序集变量 目录信息, 文本型, , , 点播变量
.程序集变量 目录名, 文本型, , , 点播变量
.程序集变量 文件名, 文本型, , , 点播变量
.程序集变量 命令, 文本型, , , 点播变量
.程序集变量 点播计次, 整数型, , , 点播变量
.程序集变量 客户地址, 文本型, , , 点播变量
.程序集变量 歌曲名称, 文本型, , , 点播变量
.程序集变量 点播机号, 文本型, , , 点播变量
.程序集变量 匿名程序集变量_3518, 空白型, , , 
.程序集变量 控制, 未知类型0x90008, , , 播放器
.程序集变量 媒体, 未知类型0x90009, , , 播放器
.程序集变量 网络, 未知类型0x90010, , , 播放器
.程序集变量 设定, 未知类型0x9000B, , , 播放器
.程序集变量 光驱, 未知类型0x90012, , , 播放器
.程序集变量 光驱集, 未知类型0x90011, , , 播放器
.子程序 __启动窗口_创建完毕, 空白型, , 启动窗口
.局部变量 计次, 整数型, , , 
.局部变量 编号, 文本型, , , 

未知支持库函数_0 (1)
载入 (系统设置, _启动窗口, 假)
置托盘图标 (#托盘图标, “大厅音乐点播系统 V1.0”)
 ' 设置客户列表框的行数
.如果真 (等于 (取表项数 (), 0))
    .计次循环首 (到整数 (系统设置..内容), 计次)
         ' 机器编号位数不足自动补0
        .如果真 (等于 (取文本长度 (到文本 (计次)), 1))
            赋值 (编号, 相加 (“00”, 到文本 (计次)))
        .如果真结束
        .如果真 (等于 (取文本长度 (到文本 (计次)), 2))
            赋值 (编号, 相加 (“0”, 到文本 (计次)))
        .如果真结束
        .如果真 (等于 (取文本长度 (到文本 (计次)), 3))
            赋值 (编号, 到文本 (计次))
        .如果真结束
        .插入表项 ().置标题 (1, 相加 (编号, “号”))
    .计次循环尾 ()
.如果真结束

赋值 (点播播放状态, 假)

赋值 (控制, 未知支持库函数_55 ())
赋值 (设定, 未知支持库函数_56 ())
赋值 (设定., 假)

随机播放 ()


.子程序 __启动窗口_可否被关闭, 逻辑型, , 启动窗口
赋值 (_启动窗口., 假)
返回 (假)


.子程序 __启动窗口_托盘事件, 空白型, , 启动窗口
.参数 操作类型, 整数型, , 

.如果真 (等于 (操作类型, #双击))
    .如果 (等于 (_启动窗口., 真))
        赋值 (., 2)
        赋值 (_启动窗口., 假)
        赋值 (_启动窗口., 假)
        
    .否则
        赋值 (., 0)
        赋值 (_启动窗口., 真)
        赋值 (_启动窗口., 真)
        赋值 (_启动窗口., 假)
    .如果结束
    
.如果真结束


.子程序 _服务器_客户进入, 空白型, , 启动窗口
.局部变量 客户, 文本型, , , 
.局部变量 分割客户, 文本型, , "3", 
.局部变量 IP地址, 文本型, , , 
.局部变量 分割IP地址, 文本型, , "3", 
.局部变量 IP地址第4段, 文本型, , , 
.局部变量 匿名局部变量_679, 空白型, , , 
.局部变量 编号, 文本型, , , 
.局部变量 IP地址第4段补0, 文本型, , , 
.局部变量 索引, 整数型, , , 
.局部变量 时, 文本型, , , 
.局部变量 分, 文本型, , , 
.局部变量 秒, 文本型, , , 

赋值 (客户, 取回客户 ())
赋值 (分割客户, 分割文本 (客户, “:”, 2))
赋值 (IP地址, 分割客户 [1])
赋值 (分割IP地址, 分割文本 (IP地址, “.”, 4))
赋值 (IP地址第4段, 分割IP地址 [4])

 ' 取时间
赋值 (时, 到文本 (取时间部分 (取现行时间 (), #小时)))
赋值 (分, 到文本 (取时间部分 (取现行时间 (), #分钟)))
赋值 (秒, 到文本 (取时间部分 (取现行时间 (), #秒)))
.如果真 (等于 (取文本长度 (时), 1))
    赋值 (时, 相加 (“0”, 时))
.如果真结束
.如果真 (等于 (取文本长度 (分), 1))
    赋值 (分, 相加 (“0”, 分))
.如果真结束
.如果真 (等于 (取文本长度 (秒), 1))
    赋值 (秒, 相加 (“0”, 秒))
.如果真结束
赋值 (时间, 相加 (时, “:”, 分, “:”, 秒))

 ' 机器编号位数不足自动补0
.如果真 (等于 (取文本长度 (IP地址第4段), 1))
    赋值 (IP地址第4段补0, 相加 (“00”, IP地址第4段))
.如果真结束
.如果真 (等于 (取文本长度 (IP地址第4段), 2))
    赋值 (IP地址第4段补0, 相加 (“0”, IP地址第4段))
.如果真结束
.如果真 (等于 (取文本长度 (IP地址第4段), 3))
    赋值 (IP地址第4段补0, IP地址第4段)
.如果真结束

 ' 当某客户连接进来时，将其加入在线列表
赋值 (索引, 相减 (到数值 (IP地址第4段), 1))
索引.置状态图片 (0)
索引.置标题 (0, 客户)
索引.置标题 (2, “--------”)
索引.置标题 (3, “---.---.---.---”)
索引.置标题 (4, “”)
索引.置标题 (5, “-----------------”)
索引.置标题 (6, 时间)

 ' 当某客户连接进来时，显示提示信息
赋值 (索引, .插入表项 (时间, , , , ))
索引.置图片 (0, 0)
 ' 提示信息.置图片 (索引, 1, 1)
索引.置标题 (1, 相加 (IP地址第4段补0, “号”))
索引.置图片 (2, 2)
索引.置标题 (2, “系统消息：与客户端连接成功！”)


.子程序 _服务器_客户离开, 空白型, , 启动窗口
.局部变量 客户, 文本型, , , 
.局部变量 分割客户, 文本型, , "3", 
.局部变量 IP地址, 文本型, , , 
.局部变量 分割IP地址, 文本型, , "3", 
.局部变量 IP地址第4段, 文本型, , , 
.局部变量 主机名, 文本型, , , 
.局部变量 匿名局部变量_635, 空白型, , , 
.局部变量 索引, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 IP地第4址段补0, 文本型, , , 
.局部变量 匿名局部变量_1258, 空白型, , , 
.局部变量 表项索引, 整数型, , , 

赋值 (客户, 取回客户 ())
赋值 (分割客户, 分割文本 (客户, “:”, 2))
赋值 (IP地址, 分割客户 [1])
赋值 (分割IP地址, 分割文本 (IP地址, “.”, 4))
赋值 (IP地址第4段, 分割IP地址 [4])

 ' 当某客户断开连接时，清空对应位置的标题
赋值 (索引, 相减 (到数值 (IP地址第4段), 1))
索引.置状态图片 (0)
索引.置标题 (0, “”)
索引.置标题 (2, “”)
索引.置标题 (3, “”)
索引.置标题 (4, “”)
索引.置标题 (5, “”)
索引.置标题 (6, “”)
索引.置标题 (7, “”)

 ' 机器编号位数不足自动补0
.如果真 (等于 (取文本长度 (IP地址第4段), 1))
    赋值 (IP地第4址段补0, 相加 (“00”, IP地址第4段))
.如果真结束
.如果真 (等于 (取文本长度 (IP地址第4段), 2))
    赋值 (IP地第4址段补0, 相加 (“0”, IP地址第4段))
.如果真结束
.如果真 (等于 (取文本长度 (IP地址第4段), 3))
    赋值 (IP地第4址段补0, IP地址第4段)
.如果真结束

赋值 (点播机号, 相加 (IP地第4址段补0, “号”))
客户断开连接 ()

 ' 当某客户断开连接时，显示提示信息
赋值 (索引, .插入表项 (时间, , , , ))
索引.置图片 (0, 0)
 ' 提示信息.置图片 (索引, 1, 1)
索引.置标题 (1, 相加 (IP地第4址段补0, “号”))
索引.置图片 (2, 3)
索引.置标题 (2, “系统消息：客户端已断开连接！”)


.子程序 客户断开连接, 空白型, , 当某客户断开连接后，取消所点播的音乐
.局部变量 表项索引, 整数型, , , 

 ' 当某客户断开连接后，取消所点播的音乐
.如果真 (并且 (系统设置..选中, 等于 (点播播放状态, 真)))
    .计次循环首 (取表项数 (), 表项索引)
        .如果真 (等于 (相减 (表项索引, 1).取标题 (0), 点播机号))
            相减 (表项索引, 1).删除表项 ()
            客户断开连接 ()
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
.如果真结束
.如果真 (等于 (0.取标题 (1), “”))
    点播播放 ()
.如果真结束


.子程序 _服务器_数据到达, 空白型, , 启动窗口
.局部变量 收到数据, 字节集, , , 
.局部变量 聊天变量, 整数型, , , 
.局部变量 匿名局部变量_2814, 空白型, , , 
.局部变量 分割信息, 文本型, , "5", 
.局部变量 信息类别, 文本型, , , 
.局部变量 主机名, 文本型, , , 
.局部变量 MAC地址, 文本型, , , 
.局部变量 客户消息, 文本型, , , 
.局部变量 IP地址, 文本型, , , 
.局部变量 分割IP地址, 文本型, , "4", 
.局部变量 IP地址第4段, 文本型, , , 
.局部变量 IP地址第4段补0, 文本型, , , 
.局部变量 分割主机名, 文本型, , "2", 
.局部变量 主机名后缀, 文本型, , , 
.局部变量 索引, 整数型, , , 
.局部变量 匿名局部变量_3228, 空白型, , , 
.局部变量 点播IP地址, 文本型, , , 点播变量
.局部变量 分割点播IP地址, 文本型, , "4", 点播变量
.局部变量 点播IP地址第4段, 文本型, , , 点播变量
.局部变量 点播IP地址第4段补0, 文本型, , , 点播变量
.局部变量 点播列表索引, 整数型, , , 点播变量
.局部变量 点播计次, 整数型, , , 点播变量
.局部变量 表项索引, 整数型, , , 点播变量
.局部变量 查询计次, 整数型, , , 点播变量
.局部变量 点播信息, 文本型, , , 点播变量
.局部变量 点播序号, 整数型, , , 点播信息

 ' 1.信息类别 2.本机名 3.网卡MAC 4.IP地址 5.信息内容
赋值 (收到数据, 取回数据 ())

 ' 索引 ＝ 提示信息.插入表项 (, 时间, , , , )
 ' 提示信息.置标题 (索引, 2, 到文本 (“信息测试：” ＋ 到文本 (收到数据)))

 ' 判断信息类别-分割系统信息
赋值 (分割信息, 分割文本 (到文本 (收到数据), “&&”, 5))

.如果真 (等于 (分割信息 [1], “系统信息”)) ' 判断信息类别-系统信息
    赋值 (主机名, 分割信息 [2])
    赋值 (MAC地址, 分割信息 [3])
    赋值 (IP地址, 分割信息 [4])
    赋值 (分割IP地址, 分割文本 (IP地址, “.”, 4))
    赋值 (IP地址第4段, 分割IP地址 [4])
    
     ' 判断主机名是否有后缀
    赋值 (分割主机名, 分割文本 (主机名, “-”, 2))
    .如果 (等于 (到文本 (分割主机名 [1]), 主机名))
        赋值 (主机名后缀, 主机名)
    .否则
        赋值 (主机名后缀, 分割主机名 [2])
    .如果结束
    
     ' 机器编号位数不足自动补0
    .如果真 (等于 (取文本长度 (IP地址第4段), 1))
        赋值 (IP地址第4段补0, 相加 (“00”, IP地址第4段))
    .如果真结束
    .如果真 (等于 (取文本长度 (IP地址第4段), 2))
        赋值 (IP地址第4段补0, 相加 (“0”, IP地址第4段))
    .如果真结束
    .如果真 (等于 (取文本长度 (IP地址第4段), 3))
        赋值 (IP地址第4段补0, IP地址第4段)
    .如果真结束
    
     ' 数据到达时，将信息加入客户列表框
    赋值 (索引, 相减 (到数值 (IP地址第4段), 1))
    索引.置标题 (2, 主机名)
    索引.置标题 (3, IP地址)
     ' 如果 (IP地址第4段补0 ＝ 主机名后缀)
     ' 客户列表框.置图片 (索引, 4, 1)
     ' 客户列表框.置标题 (索引, 4, “正确”)
     ' 客户列表框.置图片 (索引, 4, 0)
     ' 客户列表框.置标题 (索引, 4, “错误”)
    索引.置标题 (5, MAC地址)
    返回 ()
    
.如果真结束
.如果真 (等于 (分割信息 [1], “客户信息”)) ' 判断信息类别-客户信息
    赋值 (IP地址, 分割信息 [4])
    赋值 (客户消息, 分割信息 [5])
    赋值 (分割IP地址, 分割文本 (IP地址, “.”, 4))
    赋值 (IP地址第4段, 分割IP地址 [4])
    
     ' 机器编号位数不足自动补0
    .如果真 (等于 (取文本长度 (IP地址第4段), 1))
        赋值 (IP地址第4段补0, 相加 (“00”, IP地址第4段))
    .如果真结束
    .如果真 (等于 (取文本长度 (IP地址第4段), 2))
        赋值 (IP地址第4段补0, 相加 (“0”, IP地址第4段))
    .如果真结束
    .如果真 (等于 (取文本长度 (IP地址第4段), 3))
        赋值 (IP地址第4段补0, IP地址第4段)
    .如果真结束
    
     ' 客户信息到达时，将信息加入提示信息列表框
    赋值 (索引, .插入表项 (时间, , , , ))
    索引.置图片 (0, 0)
     ' 提示信息.置图片 (索引, 1, 1)
    索引.置标题 (1, 相加 (IP地址第4段补0, “号”))
    索引.置图片 (2, 4)
    索引.置标题 (2, 到文本 (相加 (“客户消息：”, 客户消息)))
    播放音乐 (#客户消息, )
    返回 ()
    
.如果真结束
.如果真 (等于 (分割信息 [1], “聊天信息”)) ' 判断信息类别-聊天信息
    赋值 (IP地址, 分割信息 [4])
    赋值 (客户消息, 分割信息 [5])
    赋值 (分割IP地址, 分割文本 (IP地址, “.”, 4))
    赋值 (IP地址第4段, 分割IP地址 [4])
    
     ' 机器编号位数不足自动补0
    .如果真 (等于 (取文本长度 (IP地址第4段), 1))
        赋值 (IP地址第4段补0, 相加 (“00”, IP地址第4段))
    .如果真结束
    .如果真 (等于 (取文本长度 (IP地址第4段), 2))
        赋值 (IP地址第4段补0, 相加 (“0”, IP地址第4段))
    .如果真结束
    .如果真 (等于 (取文本长度 (IP地址第4段), 3))
        赋值 (IP地址第4段补0, IP地址第4段)
    .如果真结束
    
     ' 聊天信息到达时，将信息加入提示信息列表框
    赋值 (索引, .插入表项 (时间, , , , ))
    索引.置图片 (0, 0)
     ' 提示信息.置图片 (索引, 1, 1)
    索引.置标题 (1, 相加 (IP地址第4段补0, “号”))
    索引.置图片 (2, 6)
    索引.置标题 (2, 到文本 (相加 (“聊天信息：”, 客户消息)))
    
     ' 将所收到的信息转发给所有在线客户
    .计次循环首 (取表项数 (), 聊天变量)
        相减 (聊天变量, 1).取标题 ().发送数据 (相加 (“聊天信息”, “&&”, IP地址第4段补0, “号”, “&&”, 客户消息, “ ”), 1)
    .计次循环尾 ()
    返回 ()
    
.如果真结束
.如果真 (等于 (分割信息 [1], “公告信息”)) ' 判断信息类别-公告信息
    .如果真 (不等于 (到文本 (读入文件 (系统设置..内容)), “”))
        取回客户 ().发送数据 (相加 (“公告信息”, “&&”, 到文本 (读入文件 (系统设置..内容))), 1)
    .如果真结束
    
.如果真结束
.如果真 (等于 (分割信息 [1], “查看状态”)) ' 判断信息类别-查看状态
    .计次循环首 (到整数 (系统设置..内容), 点播计次) ' 取点播接收客户
        .如果真 (等于 (相减 (点播计次, 1).取标题 (2), 分割信息 [2]))
            赋值 (客户地址, 相减 (点播计次, 1).取标题 (0))
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
    
    .如果 (等于 (点播播放状态, 真))
        .计次循环首 (取表项数 (), 查询计次)
            赋值 (点播信息, 相加 (点播信息, 相减 (查询计次, 1).取标题 (1), #换行符))
        .计次循环尾 ()
        客户地址.发送数据 (相加 (“点播歌名”, “&&”, “点播播放状态”, “&&”, 点播信息), 1)
    .否则
        客户地址.发送数据 (相加 (“查看状态”, “&&”, “随机播放状态”, “&&”, 3.取文本 ()), 1)
    .如果结束
    返回 ()
    
.如果真结束
.如果真 (等于 (分割信息 [1], “歌曲路径”)) ' 判断信息类别-歌曲路径
    .计次循环首 (到整数 (系统设置..内容), 点播计次) ' 取点播接收客户
        .如果真 (等于 (相减 (点播计次, 1).取标题 (2), 分割信息 [2]))
            赋值 (客户地址, 相减 (点播计次, 1).取标题 (0))
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
    
    客户地址.发送数据 (相加 (“歌曲路径”, “&&”, 系统设置..内容), 1)
    返回 ()
    
.如果真结束
.如果真 (等于 (分割信息 [1], “点播信息”)) ' 判断信息类别-点播信息
    .计次循环首 (到整数 (系统设置..内容), 点播计次) ' 取点播接收客户
        .如果真 (等于 (相减 (点播计次, 1).取标题 (2), 分割信息 [2]))
            赋值 (客户地址, 相减 (点播计次, 1).取标题 (0))
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
    
    .如果真 (等于 (系统设置..选中, 假))
        客户地址.发送数据 (相加 (“歌曲路径”, “&&”, “ServerClose”), 1)
        返回 ()
    .如果真结束
    
    赋值 (点播IP地址, 分割信息 [4])
    赋值 (命令, 分割信息 [5])
    .如果真 (或者 (等于 (取文本左边 (取文本右边 (命令, 5), 1), “.”), 等于 (取文本左边 (取文本右边 (命令, 4), 1), “.”), 等于 (取文本左边 (取文本右边 (命令, 3), 1), “.”))) ' 判断是否是歌曲文件
         ' 点播信息到达时，将信息加入提示信息列表框
        赋值 (分割点播IP地址, 分割文本 (点播IP地址, “.”, 4))
        赋值 (点播IP地址第4段, 分割点播IP地址 [4])
         ' 机器编号位数不足自动补0
        .如果真 (等于 (取文本长度 (点播IP地址第4段), 1))
            赋值 (点播IP地址第4段补0, 相加 (“00”, 点播IP地址第4段))
        .如果真结束
        .如果真 (等于 (取文本长度 (点播IP地址第4段), 2))
            赋值 (点播IP地址第4段补0, 相加 (“0”, 点播IP地址第4段))
        .如果真结束
        .如果真 (等于 (取文本长度 (点播IP地址第4段), 3))
            赋值 (点播IP地址第4段补0, 点播IP地址第4段)
        .如果真结束
        .如果真 (等于 (点播播放状态, 假))
            全部删除 ()
        .如果真结束
        
        赋值 (歌曲名称, 取文本右边 (命令, 相减 (取文本长度 (命令), 倒找文本 (命令, “\”, , 假))))
        
        .如果真 (并且 (系统设置..选中, 等于 (系统设置..内容, 到文本 (取表项数 ())))) ' 限制点播数量
            客户地址.发送数据 (相加 (“点播信息”, “&&”, “点播限制”, “&&”, 系统设置..内容), 1)
            返回 ()
        .如果真结束
        .如果真 (等于 (系统设置..选中, 假)) ' 禁止重复点播点播同一首歌曲
            .计次循环首 (取表项数 (), 表项索引)
                .如果真 (等于 (歌曲名称, 相减 (表项索引, 1).取标题 (1)))
                    客户地址.发送数据 (相加 (“点播信息”, “&&”, “重复点播”), 1)
                    返回 ()
                    跳出循环 ()
                .如果真结束
                
            .计次循环尾 ()
        .如果真结束
        .如果真 (等于 (系统设置..选中, 假)) ' 禁止同一客户重复点播点播歌曲
            .计次循环首 (取表项数 (), 表项索引)
                .如果真 (等于 (相减 (表项索引, 1).取标题 (0), 相加 (点播IP地址第4段补0, “号”)))
                    客户地址.发送数据 (相加 (“点播信息”, “&&”, “点播多首”), 1)
                    返回 ()
                    跳出循环 ()
                .如果真结束
                
            .计次循环尾 ()
        .如果真结束
        
        赋值 (点播列表索引, .插入表项 (相加 (点播IP地址第4段补0, “号”), , , , )) ' 加入点播列表
        点播列表索引.置图片 (0, 0)
        点播列表索引.置图片 (1, 1)
        点播列表索引.置标题 (1, 歌曲名称)
        点播列表索引.置标题 (2, 命令)
        .如果真 (等于 (点播播放状态, 假))
            点播播放 ()
        .如果真结束
        赋值 (索引, .插入表项 (时间, , , , )) ' 显示点播信息
        索引.置图片 (0, 0)
         ' 提示信息.置图片 (索引, 1, 1)
        索引.置标题 (1, 相加 (点播IP地址第4段补0, “号”))
        索引.置图片 (2, 7)
        索引.置标题 (2, 到文本 (相加 (“点播歌曲：”, 歌曲名称)))
        客户地址.发送数据 (相加 (“点播信息”, “&&”, “点播成功”), 1)
        赋值 (.标题, 相加 (“共点播了”, 到文本 (取表项数 ()), “首”))
        返回 ()
    .如果真结束
    
    赋值 (目录信息, “”)
    赋值 (文件名, 寻找文件 (相加 (命令, “*.*”), #子目录))
    .判断循环首 (不等于 (文件名, “”))
        .如果真 (不等于 (取文本左边 (取文本右边 (文件名, 4), 1), “.”))
            赋值 (目录信息, 相加 (目录信息, 文件名, #换行符))
        .如果真结束
        赋值 (文件名, 寻找文件 (#子目录))
    .判断循环尾 ()
    
     ' *.asf,*.wma,*.wmv,*.mp3
    赋值 (文件名, 寻找文件 (相加 (命令, “*.asf”), ))
    .判断循环首 (不等于 (文件名, “”))
        赋值 (目录信息, 相加 (目录信息, 文件名, #换行符))
        赋值 (文件名, 寻找文件 ())
    .判断循环尾 ()
    
    赋值 (文件名, 寻找文件 (相加 (命令, “*.wma”), ))
    .判断循环首 (不等于 (文件名, “”))
        赋值 (目录信息, 相加 (目录信息, 文件名, #换行符))
        赋值 (文件名, 寻找文件 ())
    .判断循环尾 ()
    
    赋值 (文件名, 寻找文件 (相加 (命令, “*.wmv”), ))
    .判断循环首 (不等于 (文件名, “”))
        赋值 (目录信息, 相加 (目录信息, 文件名, #换行符))
        赋值 (文件名, 寻找文件 ())
    .判断循环尾 ()
    
    赋值 (文件名, 寻找文件 (相加 (命令, “*.mp3”), ))
    .判断循环首 (不等于 (文件名, “”))
        赋值 (目录信息, 相加 (目录信息, 文件名, #换行符))
        赋值 (文件名, 寻找文件 ())
    .判断循环尾 ()
    
    .计次循环首 (到整数 (系统设置..内容), 点播计次)
        .如果真 (等于 (相减 (点播计次, 1).取标题 (2), 分割信息 [2]))
            赋值 (客户地址, 相减 (点播计次, 1).取标题 (0))
        .如果真结束
        
    .计次循环尾 ()
    
    .如果真 (等于 (目录信息, “”))
        赋值 (目录信息, “ ”)
    .如果真结束
    客户地址.发送数据 (相加 (“点播信息”, “&&”, 目录信息), 1)
.如果真结束

 ' 1.信息类别 2.本机名 3.网卡MAC 4.IP地址 5.信息内容

.子程序 _发送_被单击, 空白型, , 启动窗口
.局部变量 变量1, 空白型, , , 
.局部变量 项目数, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 发送方式, 文本型, , , 
.局部变量 匿名局部变量_2576, 空白型, , , 
.局部变量 索引, 整数型, , , 

赋值 (项目数, 取表项数 ())
.如果真 (等于 (.现行选中项, 0))
    赋值 (发送方式, “聊天信息&&网管”)
.如果真结束
.如果真 (等于 (.现行选中项, 1))
    赋值 (发送方式, “网管消息”)
.如果真结束
.如果真 (等于 (.现行选中项, 2))
    赋值 (发送方式, “网管通知”)
.如果真结束
.如果真 (等于 (.现行选中项, 3))
    赋值 (发送方式, “自定义命令”)
.如果真结束
.如果 (等于 (.内容, “”))
    信息框 (“请输入发送内容！！”, #信息图标, )
    返回 ()
.否则
    .计次循环首 (项目数, 计次)
        .如果真 (等于 (相减 (计次, 1).取当前状态图片 (), 1))
            到文本 (相减 (计次, 1).取标题 ()).发送数据 (相加 (发送方式, “&&”, .内容), 1)
        .如果真结束
        
    .计次循环尾 ()
.如果结束

赋值 (.现行选中项, 0)
获取焦点 ()

 ' 当服务器发送消息时，显示信息
赋值 (索引, .插入表项 (时间, , , , ))
索引.置图片 (0, 0)
索引.置标题 (1, “服务器”)
索引.置图片 (2, 6)
索引.置标题 (2, .内容)
赋值 (.内容, “”)


.子程序 _全选按钮_被单击, 空白型, , 启动窗口
.局部变量 项目数, 整数型, , , 
.局部变量 计次, 整数型, , , 

赋值 (项目数, 取表项数 ())

.计次循环首 (项目数, 计次)
    .如果真 (等于 (相减 (计次, 1).取当前状态图片 (), 0))
        相减 (计次, 1).置状态图片 (1)
    .如果真结束
    
.计次循环尾 ()


.子程序 _反选按钮_被单击, 空白型, , 启动窗口
.局部变量 项目数, 整数型, , , 
.局部变量 计次, 整数型, , , 

赋值 (项目数, 取表项数 ())

.计次循环首 (项目数, 计次)
    .如果 (等于 (相减 (计次, 1).取当前状态图片 (), 1))
        相减 (计次, 1).置状态图片 (0)
    .否则
        相减 (计次, 1).置状态图片 (1)
    .如果结束
    
.计次循环尾 ()


.子程序 _重连_被单击, 空白型, , 启动窗口
.局部变量 项目数, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 索引, 整数型, , , 

 ' 断开所有客户连接
赋值 (项目数, 取表项数 ())

.计次循环首 (项目数, 计次)
    .如果真 (等于 (相减 (计次, 1).取当前状态图片 (), 1))
        到文本 (相减 (计次, 1).取标题 ()).断开客户 ()
    .如果真结束
    
.计次循环尾 ()


.子程序 _刷新_被单击, 空白型, , 启动窗口
.局部变量 项目数, 整数型, , , 
.局部变量 计次, 整数型, , , 
.局部变量 索引, 整数型, , , 

赋值 (项目数, 取表项数 ())
.计次循环首 (项目数, 计次)
    .如果真 (等于 (相减 (计次, 1).取当前状态图片 (), 1))
         ' 清空对应位置的标题
        赋值 (索引, 相减 (到数值 (计次), 1))
        索引.置标题 (2, “”)
        索引.置标题 (3, “”)
        索引.置标题 (4, “”)
        索引.置标题 (5, “”)
        到文本 (相减 (计次, 1).取标题 ()).发送数据 (相加 (“控制命令”, “&&”, “REFRESH”), 1)
    .如果真结束
    
.计次循环尾 ()


.子程序 _关机_被单击, 空白型, , 启动窗口
.局部变量 项目数, 整数型, , , 
.局部变量 计次, 整数型, , , 


赋值 (项目数, 取表项数 ())
.计次循环首 (项目数, 计次)
    .如果真 (等于 (相减 (计次, 1).取当前状态图片 (), 1))
        到文本 (相减 (计次, 1).取标题 ()).发送数据 (相加 (“控制命令”, “&&”, “SHUTDOWN”), 1)
    .如果真结束
    
.计次循环尾 ()


.子程序 _重启_被单击, 空白型, , 启动窗口
.局部变量 项目数, 整数型, , , 
.局部变量 计次, 整数型, , , 

赋值 (项目数, 取表项数 ())
.计次循环首 (项目数, 计次)
    .如果真 (等于 (相减 (计次, 1).取当前状态图片 (), 1))
        到文本 (相减 (计次, 1).取标题 ()).发送数据 (相加 (“控制命令”, “&&”, “REST”), 1)
    .如果真结束
    
.计次循环尾 ()


.子程序 _退出_被单击, 空白型, , 启动窗口
.局部变量 项目数, 整数型, , , 
.局部变量 计次, 整数型, , , 

赋值 (项目数, 取表项数 ())
.计次循环首 (项目数, 计次)
    .如果真 (等于 (相减 (计次, 1).取当前状态图片 (), 1))
        到文本 (相减 (计次, 1).取标题 ()).发送数据 (相加 (“控制命令”, “&&”, “QUIT”), 1)
    .如果真结束
    
.计次循环尾 ()


.子程序 _取消启动_被单击, 空白型, , 启动窗口
.局部变量 项目数, 整数型, , , 
.局部变量 计次, 整数型, , , 

.如果真 (等于 (., 1))
    赋值 (., 0)
    赋值 (., “音乐点播”)
.如果真结束
.如果真 (等于 (信息框 (“是否设置已选择的计算机以后开机不再自动运行客户端？”, #确认取消钮, ), #确认钮))
    赋值 (项目数, 取表项数 ())
    .计次循环首 (项目数, 计次)
        .如果真 (等于 (相减 (计次, 1).取当前状态图片 (), 1))
            到文本 (相减 (计次, 1).取标题 ()).发送数据 (相加 (“控制命令”, “&&”, “OPTIONS”), 1)
        .如果真结束
        
    .计次循环尾 ()
.如果真结束


.子程序 _关闭_被单击, 空白型, , 启动窗口
.如果真 (等于 (信息框 (“是否真的要关闭本程序？”, 相加 (#确认取消钮, #询问图标, #默认按钮二), ), #确认钮))
    控制.未知支持库函数_131 ()
    销毁 ()
.如果真结束



.子程序 _设置_被单击, 空白型, , 启动窗口
系统设置.读取配置 ()
.如果 (等于 (系统设置., 假))
    赋值 (系统设置., 真)
.否则
    赋值 (系统设置., 假)
.如果结束


.子程序 _音乐点播_被单击, 空白型, , 启动窗口
.如果真 (等于 (系统设置., 真))
    赋值 (系统设置., 假)
.如果真结束
.如果 (等于 (., “音乐点播”))
    赋值 (., 1)
    赋值 (., “系统信息”)
.否则
    赋值 (., 0)
    赋值 (., “音乐点播”)
.如果结束


.子程序 _解锁_被单击, 空白型, , 启动窗口
.局部变量 项目数, 整数型, , , 
.局部变量 计次, 整数型, , , 

.判断开始 (或者 (等于 (., 真), 等于 (., 真), 等于 (., 真), 等于 (., 真), 等于 (., 真), 等于 (., 真), 等于 (., 真)))
    赋值 (., “锁定”)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
.默认
    赋值 (., “解锁”)
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., 真)
.判断结束


.子程序 _时钟1_周期事件, 空白型, , 启动窗口
.局部变量 年, 文本型, , , 
.局部变量 月, 文本型, , , 
.局部变量 日, 文本型, , , 
.局部变量 时, 文本型, , , 
.局部变量 分, 文本型, , , 
.局部变量 秒, 文本型, , , 

 ' 取日期时间
赋值 (年, 到文本 (取时间部分 (取现行时间 (), #年份)))
赋值 (月, 到文本 (取时间部分 (取现行时间 (), #月份)))
赋值 (日, 到文本 (取时间部分 (取现行时间 (), #日)))
赋值 (时, 到文本 (取时间部分 (取现行时间 (), #小时)))
赋值 (分, 到文本 (取时间部分 (取现行时间 (), #分钟)))
赋值 (秒, 到文本 (取时间部分 (取现行时间 (), #秒)))
.如果真 (等于 (取文本长度 (月), 1))
    赋值 (月, 相加 (“0”, 月))
.如果真结束
.如果真 (等于 (取文本长度 (日), 1))
    赋值 (日, 相加 (“0”, 日))
.如果真结束
.如果真 (等于 (取文本长度 (时), 1))
    赋值 (时, 相加 (“0”, 时))
.如果真结束
.如果真 (等于 (取文本长度 (分), 1))
    赋值 (分, 相加 (“0”, 分))
.如果真结束
.如果真 (等于 (取文本长度 (秒), 1))
    赋值 (秒, 相加 (“0”, 秒))
.如果真结束
赋值 (日期, 相加 (月, “月”, 日, “日”))
赋值 (时间, 相加 (时, “:”, 分, “:”, 秒))

 ' 音乐点播进度条
.如果真 (或者 (等于 (., 1), 等于 (., 10)))
    4.置文本 (“00:00|00:00”)
    赋值 (., 0)
.如果真结束
.如果 (等于 (., 3))
    赋值 (., 四舍五入 (到整数 (控制.), 0))
    赋值 (媒体, 未知支持库函数_57 ())
    .如果 (或者 (不等于 (控制., “”), 不等于 (媒体., “”)))
        4.置文本 (相加 (控制., “|”, 媒体.))
    .否则
        4.置文本 (相加 (“00:00”, “|”, “00:00”))
    .如果结束
    
    5.置文本 (相加 (到文本 (四舍五入 (相除 (到整数 (媒体.未知支持库函数_153 (“Bitrate”)), 1000), 0)), “Kbps”))
.否则
    5.置文本 (.)
.如果结束
6.置文本 (相加 (日期, “ ”, 时间))


.子程序 _时钟2_周期事件, 空白型, , 启动窗口
.局部变量 计次, 整数型, , , 
.局部变量 索引, 整数型, , , 
.局部变量 错误, 整数型, , , 
.局部变量 正确, 整数型, , , 
.局部变量 未知, 整数型, , , 


 ' 刷新客户信息
赋值 (客户数, 0)
.计次循环首 (取表项数 (), 计次)
    .如果真 (不等于 (相减 (计次, 1).取标题 (2), “”))
         ' 清空对应位置的标题
        赋值 (索引, 相减 (到数值 (计次), 1))
        索引.置标题 (2, “--------”)
        索引.置标题 (3, “---.---.---.---”)
        索引.置标题 (4, “”)
        索引.置标题 (5, “-----------------”)
        索引.置标题 (7, 到文本 (取时间间隔 (到时间 (索引.取标题 (6)), 到时间 (时间), 相加 (#小时, #分钟, #秒))))
        到文本 (相减 (计次, 1).取标题 ()).发送数据 (相加 (“控制命令”, “&&”, “REFRESH”), 1)
        赋值 (客户数, 相加 (客户数, 1))
    .如果真结束
    
.计次循环尾 ()

 ' 状态条
0.置文本 (相加 (“共”, “ ”, 到文本 (到整数 (系统设置..内容)), “ ”, “台计算机”))
1.置文本 (相加 (“已连接”, “ ”, 到文本 (客户数), “ ”, “台”))
2.置文本 (相加 (“未连接”, “ ”, 到文本 (相减 (到整数 (系统设置..内容), 客户数)), “ ”, “台”))

 ' 清空提示信息列表框内容
.如果真 (大于 (取表项数 (), 100))
    全部删除 ()
.如果真结束


.子程序 _时钟3_周期事件, 空白型, , 
点播控制 ()
赋值 (.时钟周期, 0)


.子程序 _客户列表框_表项被激活, 空白型, , 启动窗口
.判断开始 (等于 (.取当前状态图片 (.), 0))
    .置状态图片 (., 1)
.默认
    .置状态图片 (., 0)
.判断结束


.子程序 _提示信息_表项被激活, 空白型, , 启动窗口
.局部变量 计数, 整数型, , , 

.计次循环首 (到整数 (系统设置..内容), 计数)
    .如果真 (等于 (.取标题 (., 1), 计数.取标题 (1)))
        赋值 (., 计数)
        计数.保证显示 ()
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()


.子程序 _播放器_打开状态被改变, 空白型, , 
.参数 新状态, 整数型, , 

.局部变量 临时媒体, 未知类型0x90009, , , 

.如果 (等于 (新状态, #))
    赋值 (临时媒体, 未知支持库函数_57 ())
    赋值 (., 四舍五入 (到整数 (临时媒体.未知支持库函数_153 (“Duration”)), ))
    赋值 (., “暂停”)
.否则
    返回 ()
.如果结束


.子程序 _播放器_播放状态被改变, 空白型, , 
.参数 新的状态, 整数型, , 

.如果真 (等于 (新的状态, #))
    赋值 (., “播放”)
    赋值 (.时钟周期, 1000)
.如果真结束


.子程序 _播放器_错误发生, 空白型, , 
.如果真 (等于 (., 9))
    赋值 (., “播放”)
    赋值 (.时钟周期, 1000)
.如果真结束


.子程序 点播控制, 空白型, , 歌曲点播
.如果 (等于 (点播播放状态, 真))
    0.删除表项 ()
    点播播放 ()
    返回 ()
.否则
    随机播放 ()
.如果结束


.子程序 点播播放, 空白型, , 歌曲点播!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
.局部变量 通知机器编号, 文本型, , , 
.局部变量 通知歌曲名称, 文本型, , , 
.局部变量 通知表项索引, 整数型, , , 
.局部变量 标准歌曲名称, 文本型, , , 

.如果 (不等于 (0.取标题 (2), “”))
    赋值 (点播播放状态, 真)
    赋值 (.标题, 相加 (“共点播了”, 到文本 (取表项数 ()), “首”))
    赋值 (., 0.取标题 (2))
    控制.未知支持库函数_130 ()
    3.置文本 (0.取标题 (1))
    赋值 (通知机器编号, 0.取标题 (0))
    赋值 (通知歌曲名称, 0.取标题 (1))
    赋值 (标准歌曲名称, 取文本左边 (通知歌曲名称, 相减 (取文本长度 (通知歌曲名称), 4)))
    
    .计次循环首 (到整数 (系统设置..内容), 通知表项索引)
        .如果真 (等于 (相减 (通知表项索引, 1).取标题 (1), 通知机器编号))
            相减 (通知表项索引, 1).取标题 (0).发送数据 (相加 (“控制命令”, “&&”, “正在播放”, “&&”, 标准歌曲名称), 1)
            返回 ()
        .如果真结束
        
    .计次循环尾 ()
.否则
    随机播放 ()
    返回 ()
.如果结束


.子程序 随机播放, 空白型, , 歌曲点播
.局部变量 随机数字, 整数型, , , 

.如果真 (等于 (系统设置..选中, 假))
    赋值 (点播播放状态, 假)
    控制.未知支持库函数_131 ()
    3.置文本 (“等待点播状态”)
    赋值 (.标题, “等待点播状态”)
    返回 ()
.如果真结束
.如果 (不等于 (0.取标题 (2), “”))
    .计次循环首 (取秒 (取现行时间 ()), )
        赋值 (随机数字, 相减 (取随机数 (2, 取表项数 ()), 1))
    .计次循环尾 ()
    赋值 (., 随机数字)
    赋值 (.标题, 相加 (“共”, 到文本 (取表项数 ()), “首/第”, 到文本 (相加 (随机数字, 1)), “首”))
    随机数字.保证显示 ()
    赋值 (., 随机数字.取标题 (2))
    控制.未知支持库函数_130 ()
    3.置文本 (随机数字.取标题 (1))
.否则
    加入随机歌曲 ()
.如果结束


.子程序 加入随机歌曲, 空白型, , 歌曲点播
.局部变量 文件信息, 文本型, , , 
.局部变量 目录信息, 文本型, , , 
.局部变量 路径信息, 文本型, , , 
.局部变量 读目录, 文本型, , , 
.局部变量 表项索引, 整数型, , , 
.局部变量 随机路径, 文本型, , , 
.局部变量 歌曲名称, 文本型, , , 
.局部变量 排列序号, 整数型, , , 

赋值 (点播播放状态, 假)
赋值 (随机路径, 系统设置..内容)

.如果真 (不等于 (取文本右边 (随机路径, 1), “\”))
    赋值 (随机路径, 相加 (随机路径, “\”))
.如果真结束

 ' *.asf,*.wma,*.wmv,*.mp3
赋值 (文件信息, 寻找文件 (相加 (随机路径, “*.asf”), ))
.判断循环首 (不等于 (文件信息, “”))
    赋值 (路径信息, 相加 (路径信息, 随机路径, 文件信息, #换行符))
    赋值 (文件信息, 寻找文件 ())
.判断循环尾 ()

赋值 (文件信息, 寻找文件 (相加 (随机路径, “*.wma”), ))
.判断循环首 (不等于 (文件信息, “”))
    赋值 (路径信息, 相加 (路径信息, 随机路径, 文件信息, #换行符))
    赋值 (文件信息, 寻找文件 ())
.判断循环尾 ()

赋值 (文件信息, 寻找文件 (相加 (随机路径, “*.wmv”), ))
.判断循环首 (不等于 (文件信息, “”))
    赋值 (路径信息, 相加 (路径信息, 随机路径, 文件信息, #换行符))
    赋值 (文件信息, 寻找文件 ())
.判断循环尾 ()

赋值 (文件信息, 寻找文件 (相加 (随机路径, “*.mp3”), ))
.判断循环首 (不等于 (文件信息, “”))
    赋值 (路径信息, 相加 (路径信息, 随机路径, 文件信息, #换行符))
    赋值 (文件信息, 寻找文件 ())
.判断循环尾 ()

.如果真 (等于 (路径信息, “”))
    返回 ()
.如果真结束

.判断循环首 (不等于 (寻找文本 (路径信息, #换行符, , 假), -1))
    赋值 (读目录, 读一段 (路径信息, #换行符))
    赋值 (路径信息, 删一段 (路径信息, #换行符))
    赋值 (表项索引, .插入表项 (“随机播放”, , , , ))
    表项索引.置图片 (0, 2)
    表项索引.置图片 (1, 1)
    赋值 (排列序号, 相加 (排列序号, 1))
    赋值 (歌曲名称, 相加 (到文本 (排列序号), “.”, 取文本右边 (读目录, 相减 (取文本长度 (读目录), 倒找文本 (读目录, “\”, , 假)))))
    表项索引.置标题 (1, 歌曲名称)
    表项索引.置标题 (2, 读目录)
.判断循环尾 ()
赋值 (.标题, 相加 (“共”, 到文本 (排列序号), “首”))
随机播放 ()


.子程序 读一段, 文本型, , 歌曲点播
.参数 原内容, 文本型, , 原内容
.参数 分割符, 文本型, , 可以是#换行符,也可以是别的符号比如"/"","";"等

.局部变量 a, 整数型, , , 
.局部变量 b, 文本型, , , 

赋值 (a, 寻找文本 (原内容, 分割符, , 真))
赋值 (b, 取文本左边 (原内容, 相减 (a, 1)))
返回 (b)

.子程序 删一段, 文本型, , 歌曲点播
.参数 原内容, 文本型, , 原内容
.参数 分割符, 文本型, , 可以是#换行符,也可以是别的符号比如"/"","";"等

.局部变量 a, 整数型, , , 
.局部变量 c, 文本型, , , 
.局部变量 b, 文本型, , , 

赋值 (a, 寻找文本 (原内容, 分割符, , 真))
赋值 (b, 取文本左边 (原内容, 相减 (a, 1)))
赋值 (c, 取文本右边 (原内容, 相减 (取文本长度 (原内容), 取文本长度 (b), 取文本长度 (分割符))))
返回 (c)

.子程序 _随机按钮_被单击, 空白型, , 歌曲点播
.如果真 (等于 (系统设置..选中, 假))
    信息框 (“对不起，你禁止了无人点播时播放音乐的功能！”, 0, )
    返回 ()
.如果真结束
.如果真 (等于 (1.取标题 (0), “”))
    随机播放 ()
.如果真结束
.如果 (等于 (点播播放状态, 真))
    赋值 (., 0)
    赋值 (., .取标题 (., 2))
    控制.未知支持库函数_130 ()
    3.置文本 (0.取标题 (1))
.否则
    随机播放 ()
.如果结束


.子程序 _播放按钮_被单击, 空白型, , 歌曲点播
.如果 (等于 (., 3))
    控制.未知支持库函数_132 ()
    赋值 (., “播放”)
.否则
    控制.未知支持库函数_130 ()
    赋值 (., “暂停”)
.如果结束


.子程序 _停止按钮_被单击, 空白型, , 歌曲点播
控制.未知支持库函数_131 ()
赋值 (., “播放”)


.子程序 _上移按钮_被单击, 空白型, , 
.局部变量 点播客户, 文本型, , , 
.局部变量 歌曲名称, 文本型, , , 
.局部变量 歌曲路径, 文本型, , , 
.局部变量 表项索引, 整数型, , , 

.如果真 (等于 (点播播放状态, 假))
    信息框 (“本操作仅对点播模式有效！”, #信息图标, )
    返回 ()
.如果真结束
.如果真 (等于 (., 1))
    信息框 (“正在播放顶端的歌曲，不能再向上移动了！”, #信息图标, )
    返回 ()
.如果真结束
.如果 (不等于 (.取标题 (., 1), “”))
    赋值 (点播客户, .取标题 (., 0))
    赋值 (歌曲名称, .取标题 (., 1))
    赋值 (歌曲路径, .取标题 (., 2))
    赋值 (表项索引, 1.插入表项 (点播客户, , , , ))
    表项索引.置图片 (0, 0)
    表项索引.置图片 (1, 1)
    表项索引.置标题 (1, 歌曲名称)
    表项索引.置标题 (2, 歌曲路径)
    .删除表项 (.)
    赋值 (., 1)
.否则
    信息框 (“请选择要上移到顶部的歌曲！”, #信息图标, )
.如果结束


.子程序 _下移按钮_被单击, 空白型, , 
.局部变量 点播客户, 文本型, , , 
.局部变量 歌曲名称, 文本型, , , 
.局部变量 歌曲路径, 文本型, , , 
.局部变量 表项索引, 整数型, , , 

.如果真 (等于 (点播播放状态, 假))
    信息框 (“本操作仅对点播模式有效！”, #信息图标, )
    返回 ()
.如果真结束
.如果真 (等于 (., 0))
    信息框 (“此歌曲正在播放，不能移动！”, #信息图标, )
    返回 ()
.如果真结束
.如果 (不等于 (.取标题 (., 1), “”))
    赋值 (点播客户, .取标题 (., 0))
    赋值 (歌曲名称, .取标题 (., 1))
    赋值 (歌曲路径, .取标题 (., 2))
    赋值 (表项索引, 取表项数 ().插入表项 (点播客户, , , , ))
    表项索引.置图片 (0, 0)
    表项索引.置图片 (1, 1)
    表项索引.置标题 (1, 歌曲名称)
    表项索引.置标题 (2, 歌曲路径)
    .删除表项 (.)
    赋值 (., 取表项数 ())
.否则
    信息框 (“请选择要下移到底部的歌曲！”, #信息图标, )
.如果结束


.子程序 _删除按钮_被单击, 空白型, , 歌曲点播
.如果 (等于 (点播播放状态, 真))
    .如果真 (等于 (., 0))
        .删除表项 (.)
        控制.未知支持库函数_131 ()
        点播播放 ()
        返回 ()
    .如果真结束
    .删除表项 (.)
    赋值 (.标题, 相加 (“共点播了”, 到文本 (取表项数 ()), “首”))
.否则
    信息框 (“本操作仅对点播模式有效！”, #信息图标, )
.如果结束


.子程序 _清空按钮_被单击, 空白型, , 歌曲点播
赋值 (点播播放状态, 假)
全部删除 ()
控制.未知支持库函数_131 ()
赋值 (., “播放”)
3.置文本 (“等待点播状态”)
赋值 (.标题, “共0首”)

.子程序 _点播列表_表项被激活, 空白型, , 歌曲点播
.如果真 (等于 (点播播放状态, 假))
    赋值 (., .取标题 (., 2))
    控制.未知支持库函数_130 ()
    赋值 (.标题, 相加 (“共”, 到文本 (取表项数 ()), “首/第”, 到文本 (取文本左边 (.取标题 (., 1), 相减 (寻找文本 (.取标题 (., 1), “.”, , 假), 1))), “首”))
    3.置文本 (.取标题 (., 1))
.如果真结束


.子程序 __启动窗口_将被销毁, 空白型, , 
置托盘图标 ()


.窗口程序集 系统设置, , , 

.子程序 _系统设置_创建完毕, 空白型, , 
读取配置 ()


.子程序 读取配置, 空白型, , 
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “ClientNumber”, “100”))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “RefreshTime”, “60000”))
赋值 (_启动窗口..时钟周期, 到整数 (.内容))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “News”, “”))
.如果 (等于 (读配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “Run”, “Yes”), “Yes”))
    赋值 (.选中, 真)
    未知支持库函数_25 (“MusicServer”, 相加 (取运行目录 (), “\MusicServer.exe”), 0)
.否则
    赋值 (.选中, 假)
    未知支持库函数_83 (“MusicServer”)
.如果结束
.如果 (等于 (读配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “MusicService”, “Yes”), “Yes”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束
.如果 (等于 (读配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “MusicFace”, “Yes”), “Yes”))
    赋值 (.选中, 真)
    赋值 (_启动窗口.., 1)
    赋值 (_启动窗口.., “系统信息”)
.否则
    赋值 (.选中, 假)
    赋值 (_启动窗口.., “音乐点播”)
.如果结束
.如果 (等于 (读配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “OnlyMusic”, “Yes”), “Yes”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束
.如果 (等于 (读配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “ClientMusic”, “Yes”), “Yes”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束
.如果 (等于 (读配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “ClearMusic”, “Yes”), “Yes”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束
.如果 (等于 (读配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “NumberLimit”, “Yes”), “Yes”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “LimitNumber”, “10”))
.如果 (等于 (读配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “NoClient”, “Yes”), “Yes”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “NoClientPath”, “请选择歌曲目录！”))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “PlayMusicPath”, “请选择主目录！”))


.子程序 _系统设置_可否被关闭, 逻辑型, , 
赋值 (系统设置., 假)
返回 (假)


.子程序 _选择公告文件_被单击, 空白型, , 
.如果真 (打开 ())
    赋值 (.内容, .文件名)
.如果真结束


.子程序 _选择随机播放路径_被单击, 空白型, , 
.局部变量 路径, 文本型, , , 

赋值 (路径, 未知支持库函数_2 (“请选择文件路径”, 假))
.如果真 (不等于 (路径, “”))
    赋值 (.内容, 路径)
.如果真结束


.子程序 _选择点播播放路径_被单击, 空白型, , 
.局部变量 路径, 文本型, , , 

赋值 (路径, 未知支持库函数_2 (“请选择文件路径”, 假))
.如果真 (不等于 (路径, “”))
    赋值 (.内容, 路径)
.如果真结束


.子程序 _默认点播界面_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    赋值 (_启动窗口.., 1)
    赋值 (_启动窗口.., “系统信息”)
.否则
    赋值 (_启动窗口.., 0)
    赋值 (_启动窗口.., “音乐点播”)
.如果结束


.子程序 _N台_内容被改变, 空白型, , 
.如果真 (大于 (到整数 (.内容), 255))
    信息框 (“对不起，本软件最多只能控制255台机器！”, 0, )
    赋值 (.内容, 到文本 (255))
.如果真结束


.子程序 _修改_被单击, 空白型, , 
写配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “ClientNumber”, .内容)
写配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “RefreshTime”, .内容)
赋值 (_启动窗口..时钟周期, 到整数 (.内容))
写配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “News”, .内容)
.如果 (.选中)
    写配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “Run”, “Yes”)
    未知支持库函数_25 (“MusicServer”, 相加 (取运行目录 (), “\MusicServer.exe”), 0)
.否则
    写配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “Run”, “No”)
    未知支持库函数_83 (“MusicServer”)
.如果结束
.如果 (.选中)
    写配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “MusicService”, “Yes”)
.否则
    写配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “MusicService”, “No”)
.如果结束
.如果 (.选中)
    写配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “MusicFace”, “Yes”)
    赋值 (_启动窗口.., 1)
.否则
    写配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “MusicFace”, “No”)
    赋值 (_启动窗口.., 0)
.如果结束
.如果 (.选中)
    写配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “OnlyMusic”, “Yes”)
.否则
    写配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “OnlyMusic”, “No”)
.如果结束
.如果 (.选中)
    写配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “ClientMusic”, “Yes”)
.否则
    写配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “ClientMusic”, “No”)
.如果结束
.如果 (.选中)
    写配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “ClearMusic”, “Yes”)
.否则
    写配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “ClearMusic”, “No”)
.如果结束
.如果 (.选中)
    写配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “NumberLimit”, “Yes”)
.否则
    写配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “NumberLimit”, “No”)
.如果结束
写配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “LimitNumber”, .内容)
.如果 (.选中)
    写配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “NoClient”, “Yes”)
.否则
    写配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “NoClient”, “No”)
    _启动窗口._清空按钮_被单击 ()
.如果结束
写配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “NoClientPath”, .内容)
写配置项 (相加 (取运行目录 (), “\MusicServer.ini”), “System”, “PlayMusicPath”, .内容)
信息框 (“设置成功！”, #信息图标, “成功”)
赋值 (系统设置., 假)


.子程序 _取消_被单击, 空白型, , 
赋值 (系统设置., 假)


.子程序 _关于_被单击, 空白型, , 
信息框 (相加 (“『本软件由易语言软件开发』”, #换行符, #换行符, “柏拉图de永恒制作  QQ：40560335”, #换行符, “若发现BUG请速与本软件作者联系！”), 0, _启动窗口.标题)


 ' 不属于任何一个程序集、类模块的函数：
