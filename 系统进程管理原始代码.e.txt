 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 446
    高度 = 285
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “[神2也教你学E] - 系统进程管理(感谢近在眼前)”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 7 系统核心支持库




数据类型 进程信息32, , 
    .成员 类型大小, 整数型, , , 296
    .成员 引用次数, 整数型, , , 
    .成员 进程标识, 整数型, , , 
    .成员 默认堆标识, 整数型, , , 只能被此类API使用
    .成员 模块标识, 整数型, , , 同上
    .成员 线程数, 整数型, , , 
    .成员 父进程标识, 整数型, , , 
    .成员 基类优先级, 整数型, , , 由该进程创建的线程的基优先级
    .成员 标识, 整数型, , , 系统保留保留，不用
    .成员 执行文件名, 字节型, , "260", 

.全局变量 进程列表, 进程信息32, , , 

.DLL命令 创建快照, 整数型, "", "CreateToolhelp32Snapshot", , 
    .参数 标识, 整数型, , 
    .参数 进程标识, 整数型, , 

.DLL命令 取第一个进程, 逻辑型, "", "Process32First", , 
    .参数 快照句柄, 整数型, , 
    .参数 进程信息, 未知类型0x41010065, , 

.DLL命令 关闭句柄, 逻辑型, "kernel32", "CloseHandle", , 
    .参数 对象句柄, 整数型, , 

.DLL命令 打开进程, 整数型, "", "OpenProcess", , 返回Handle
    .参数 值, 整数型, , 
    .参数 信息, 整数型, , 
    .参数 进程ID, 整数型, , 

.DLL命令 结束进程, 空白型, "", "TerminateProcess", , 
    .参数 句柄, 整数型, , 
    .参数 信息, 整数型, , 

.DLL命令 取下一个进程, 逻辑型, "", "Process32Next", , 
    .参数 快照句柄, 整数型, , 
    .参数 进程信息, 未知类型0x41010068, , 

.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
显示进程 ()

.子程序 显示进程, 逻辑型, , 
.局部变量 进程快照, 整数型, , , 
.局部变量 临时, 逻辑型, , , 
.局部变量 进程名, 文本型, , , 

赋值 (进程快照, 创建快照 (15, 0))
.如果真 (等于 (进程快照, 0))
    返回 (假)
.如果真结束
清空 ()
赋值 (进程列表.类型大小, 296)
赋值 (临时, 取第一个进程 (进程快照, 进程列表))
.判断循环首 (不等于 (临时, 假))
    取字节集数据 (到字节集 (进程列表.执行文件名), 10).加入项目 ()
    赋值 (临时, 取下一个进程 (进程快照, 进程列表))
.判断循环尾 ()
返回 (真)

.子程序 _退出按钮_被单击, 空白型, , 
结束 ()

.子程序 _刷新按钮_被单击, 空白型, , 
显示进程 ()

.子程序 取进程句柄, 整数型, , 
.参数 进程文件名, 文本型, , 

.局部变量 结果, 逻辑型, , , 
.局部变量 进程快照, 整数型, , , 
.局部变量 线程快照, 整数型, , , 
.局部变量 进程信息, 未知类型0x4101005C, , , 
.局部变量 句柄, 整数型, , , 
.局部变量 文件名, 文本型, , , 

赋值 (., 296)
赋值 (进程快照, 创建快照 (位或 (2, 0), 0))
检查 (不等于 (-1))
赋值 (结果, 取第一个进程 (进程快照, 进程信息))
检查 ()
.判断循环首 (结果)
    赋值 (文件名, 取字节集数据 (到字节集 (.), 10))
    .如果真 (等于 (文件名, 进程文件名))
        赋值 (句柄, 打开进程 (1, 0, 进程信息.进程标识))
        跳出循环 ()
    .如果真结束
    赋值 (结果, 取下一个进程 (进程快照, 进程信息))
    赋值 (句柄, 0)
.判断循环尾 ()
赋值 (结果, 关闭句柄 (进程快照))
返回 (句柄)

.子程序 _中止按钮_被单击, 空白型, , 
 ' 结束进程 (取进程句柄 (.取项目文本 (.)), 0)
显示进程 ()


 ' 不属于任何一个程序集、类模块的函数：
