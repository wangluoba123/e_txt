 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 2 0 系统核心支持库



窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “用ODBC连接外部数据库之MS_ACCESS   作者：Liigo 2002/3/20”
    帮助文件名 = “”






.窗口程序集 窗口程序集1, , , 

.程序集变量 记录集句柄, 整数型, , , 
.子程序 _连接外部数据库按钮_被单击, 空白型, , 
.如果真 (.打开 ())
    赋值 (“select * from books”.查询 ()) ' books: 是数据库中“表”的名称，表的名称在设计数据库时就已经决定了。“select * from books”是一个SQL语句，意思就是选择(select)"表books"中的所有字段。
    .如果 (等于 (记录集句柄, 0))
        信息框 (“查询失败！”, 0, )
        
    .否则
        记录集句柄.到首记录 ()
        读取并显示当前记录 ()
         ' 连接成功之后，立即显示第一条记录。
    .如果结束
    
.如果真结束


.子程序 __启动窗口_将被销毁, 空白型, , 
.关闭记录集 ()
关闭 ()
 ' 两者都要关闭！别忘了！

.子程序 _查看连接文本按钮_被单击, 空白型, , 
信息框 (相加 (取连接文本 (), #换行符, #换行符, “以上仅供参考。Liigo向各位问好！”), 0, 相加 (“当前ODBC数据源连接文本（由”, #左引号, “取连接文本()”, #右引号, “获得）：”))
 ' 调用命令“取连接文本 ()”以获取数据源连接文本。获取的文本只是让大家有一些感性认识，此处不用。

.子程序 _查看前一记录按钮_被单击, 空白型, , 
记录集句柄.到前一记录 ()
.如果 (记录集句柄.首记录前 ())
    信息框 (“前面已无记录！”, 0, )
    记录集句柄.到首记录 ()
    
.否则
    读取并显示当前记录 ()
.如果结束


.子程序 _查看后一记录按钮_被单击, 空白型, , 
记录集句柄.到后一记录 ()
.如果 (记录集句柄.尾记录后 ())
    信息框 (“后面已无记录！”, 0, )
    记录集句柄.到尾记录 ()
    
.否则
    读取并显示当前记录 ()
.如果结束


.子程序 _首记录按钮_被单击, 空白型, , 
记录集句柄.到首记录 ()
读取并显示当前记录 ()

.子程序 _尾记录按钮_被单击, 空白型, , 
记录集句柄.到尾记录 ()
读取并显示当前记录 ()


.子程序 读取并显示当前记录, 空白型, , 这是自定义子程序
赋值 (., 到文本 (记录集句柄.读 (1)))
赋值 (., 记录集句柄.读 (2))
赋值 (., 记录集句柄.读 (3))
赋值 (., 记录集句柄.读 (4))
赋值 (., 记录集句柄.读 (5))
赋值 (., 到文本 (记录集句柄.读 (6)))
赋值 (., 记录集句柄.读 (7))

 ' 以上7行分别读取数据库中的7个字段信息，并显示到对应的编辑框中。
 ' 命令“读（）”所返回的数据的数据类型，就是设计数据库时确定的数据类型（不确切，但可以这么理解）。因为要把它们显示到编辑框中，所以不是“文本型”的要进行类型转换。
 ' 命令“读（）”的第二个参数也可以是字段名称。如上面的第一行就等价于： 编辑框1.内容 ＝ 到文本 (外部数据库1.读 (记录集句柄, “编号”))。 “编号”是什么？数据库的第一个字段的名称呀！是设计数据库时就确定的。
 ' 有人问，你Liigo怎么知道这个数据库有7个字段？你又怎么知道的各字段的数据类型和名称？哈哈，我设计的数据库，我当然知道了！（如果要操纵别人设计的数据库，也必须事先了解这些信息。）
 ' 您的朋友Liigo祝你生活愉快！ Liigo@chinaren.com       2002/3/20


.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()


 ' 不属于任何一个程序集、类模块的函数：
