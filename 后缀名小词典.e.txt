 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 2 0 系统核心支持库



窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 333
    高度 = 328
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 已保存到：D:\易语言学习\Data\后缀名小词典.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “HW后缀名小词典”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 309
    高度 = 234
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “HW后缀名小词典”
    帮助文件名 = “”

窗口 添加窗口
    左边 = 50
    顶边 = 50
    宽度 = 184
    高度 = 177
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “输入后缀名信息：”
    帮助文件名 = “”



.图片 图片1, " ' 已保存到：D:\易语言学习\Data\后缀名小词典.e\图片1", , 


.全局变量 新后缀名, 文本型, , , 
.全局变量 新后缀信息, 文本型, , , 
.全局变量 库文件名, 文本型, , , 
.全局变量 是否为新名, 逻辑型, , , 添加还是修改

.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 字段名, 字段信息, , , 
.局部变量 字段表, 字段信息, , "0", 

赋值 (., #图片1)
赋值 (., #图片1)
赋值 (., #图片1)
赋值 (., #图片1)
赋值 (., #图片1)
赋值 (., #图片1)
赋值 (., #图片1)
赋值 (., #图片1)
赋值 (相加 (取运行目录 (), “\file.edb”))
.如果真 (等于 (文件是否存在 (), 假))
    重定义数组 (假, 2)
    赋值 (字段名., “后缀名”)
    赋值 (字段名., 4)
    赋值 (., #文本型)
    插入成员 (1, )
    
    赋值 (字段名., “说明”)
    赋值 (字段名., 100)
    赋值 (., #文本型)
    插入成员 (2, 字段名)
    
    创建 (字段表)
    加空记录 ()
    关闭 ()
.如果真结束
未知函数_67174455 ()

.子程序 _后缀编辑框_内容被改变, 空白型, , 
.局部变量 查找内容, 文本型, , , 
.局部变量 项目数, 整数型, , , 
.局部变量 当前项目数, 整数型, , , 
.局部变量 是否找到, 逻辑型, , , 

赋值 (查找内容, 删首尾空 (到大写 (.)))
赋值 (取记录数 ())
.计次循环首 ()
    跳到 (相加 (当前项目数, 1))
    .如果真 (等于 (删首尾空 (读 (“后缀名”)), 查找内容))
        赋值 (是否找到, 真)
        赋值 (., 当前项目数)
        未知函数_67174484 ()
        跳出循环 ()
    .如果真结束
    赋值 (当前项目数, 相加 (当前项目数, 1))
.计次循环尾 ()
.如果真 (等于 (是否找到, 假))
    赋值 (., 相加 (#换行符, “    没有找到后缀名 ”, 查找内容, “ 的信息。”))
.如果真结束


.子程序 _列表框_列表项被选择, 空白型, , 
跳到 (相加 (., 1))
赋值 (., 相加 (#换行符, “后缀名： *.”, 读 (“后缀名”), #换行符, #换行符, “    ”, 读 (“说明”)))
赋值 (., 相加 (“共有”, 到文本 (取记录数 ()), “个记录”, “；”, “现选中第”, 到文本 (相加 (., 1)), “个记录”))

.子程序 _列表框_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _添加项目_被选择, 空白型, , 
赋值 (是否为新名, 真)
载入 (添加窗口, _启动窗口, 真)
.如果真 (不等于 (新后缀名, “    ”))
    未知函数_67174632 ()
.如果真结束


.子程序 _删除项目_被选择, 空白型, , 
.如果 (等于 (., -1))
    信息框 (“你还未选择列表项目！”, #警告图标, “错误！”)
.否则
    .如果真 (等于 (信息框 (相加 (“您确定要删除当前项目 ”, .取项目文本 (.), “ 吗？”), 相加 (#询问图标, #取消钮), “注意”), 0))
        跳到 (相加 (., 1))
        删除 ()
        彻底删除 ()
        未知函数_67174633 ()
    .如果真结束
    
.如果结束


.子程序 _修改信息_被选择, 空白型, , 
.如果 (等于 (., -1))
    信息框 (“您还未选择列表项目！”, #警告图标, “错误！”)
.否则
    赋值 (是否为新名, 假)
    赋值 (新后缀名, .取项目文本 (.))
    赋值 (新后缀信息, 读 (“说明”))
    载入 (添加窗口, _启动窗口, 真)
    未知函数_67174649 ()
.如果结束


.子程序 _清空数据_被选择, 空白型, , 
.如果真 (等于 (信息框 (“您确定要清空所有数据吗？”, 相加 (#询问图标, #取消钮), “注意！”), 0))
    清空 ()
    未知函数_67174645 ()
.如果真结束


.子程序 _关闭词典_被选择, 空白型, , 
结束 ()

.子程序 _添加标签_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 1)
.计次循环首 (2000, )
.计次循环尾 ()
赋值 (., 2)
_添加项目_被选择 ()

.子程序 _删除标签_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 1)
.计次循环首 (2000, )
.计次循环尾 ()
赋值 (., 2)
_删除项目_被选择 ()

.子程序 _关于标签_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 1)
.计次循环首 (2000, )
.计次循环尾 ()
赋值 (., 2)
载入 (关于窗口, _启动窗口, 真)

.子程序 _退出标签_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 1)
.计次循环首 (2000, )
.计次循环尾 ()
赋值 (., 2)
结束 ()

.子程序 读数据, 空白型, , 
.局部变量 项目数, 整数型, , , 
.局部变量 列表数, 整数型, , , 从0算起
.局部变量 项目文本, 文本型, , , 

清空 ()
关闭 ()
打开 ()
排序 (“c:\windows\temp\file2.edb”, “后缀名”, , , )
关闭 ()
删除文件 (库文件名)
移动文件 (“c:\windows\temp\file2.edb”, 库文件名)
打开 ()
赋值 (项目数, 取记录数 ())
赋值 (., 相加 (“共有”, 到文本 (项目数), “个记录”))
.计次循环首 (项目数, )
    跳到 (相加 (列表数, 1))
    赋值 (项目文本, 读 (“后缀名”))
    项目文本.加入项目 ()
    赋值 (列表数, 相加 (列表数, 1))
.计次循环尾 ()
赋值 (., -1)
赋值 (., “”)
赋值 (., 相加 (“共有”, 到文本 (取记录数 ()), “个记录”))

.子程序 __启动窗口_将被销毁, 空白型, , 
关闭 ()

.窗口程序集 窗口程序集2, , , 

.子程序 _关于窗口_创建完毕, 空白型, , 
赋值 (., #图片1)
赋值 (., 相加 (“HW后缀名小词典：”, #换行符, #换行符, “    此程序收录了各种后缀名（扩展名）的信息，便于用户进行查询。具有对数据的增、删、改的功能，有利于用户对数据的整理、更新。列表框支持鼠标右键。”, #换行符, “    本程序是使用中国人自己的语言――易语言所编写，谢谢使用！”, #换行符, #换行符, “作者：何维”, #换行符, “QQ号：39237979”, #换行符, “E_mail：hw2_ren_ren@chinaren.com”, #换行符, “网址：http://hw2_ren_ren.home.chinaren.com/”, #换行符, “易语言网址：http://eyuyan.com/”))

.子程序 _标签1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.窗口程序集 窗口程序集3, , , 

.子程序 _添加窗口_创建完毕, 空白型, , 
赋值 (., #图片1)
赋值 (., #图片1)
赋值 (., #图片1)
赋值 (., #图片1)
赋值 (., #图片1)
.如果 (等于 (是否为新名, 真))
    获取焦点 ()
.否则
    赋值 (., 新后缀名)
    赋值 (., 新后缀信息)
    获取焦点 ()
.如果结束


.子程序 _名称编辑框_内容被改变, 空白型, , 
赋值 (新后缀名, 到大写 (.))

.子程序 _信息编辑框_内容被改变, 空白型, , 
赋值 (新后缀信息, .)

.子程序 _保存标签_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 项目数, 整数型, , , 
.局部变量 当前项目数, 整数型, , , 
.局部变量 是否找到, 逻辑型, , , 

.如果 (不等于 (删首尾空 (新后缀名), “ ”))
    打开 ()
    赋值 (取记录数 ())
    .计次循环首 ()
        赋值 (当前项目数, 相加 (当前项目数, 1))
        跳到 (当前项目数)
        .如果真 (等于 (删首尾空 (读 (“后缀名”)), .))
            赋值 (是否找到, 真)
            跳出循环 ()
        .如果真结束
        赋值 (是否找到, 假)
    .计次循环尾 ()
    .如果 (等于 (是否为新名, 真))
        .如果 (等于 (是否找到, 假))
            加记录 (新后缀名, 新后缀信息)
        .否则
            信息框 (“此后缀名已存在！”, #警告图标, “注意！”)
            获取焦点 ()
        .如果结束
        
    .否则
        修改 (新后缀名, 新后缀信息)
    .如果结束
    关闭 ()
    销毁 ()
.否则
    信息框 (“输入内容不能为空！”, #警告图标, “错误：”)
.如果结束


.子程序 _取消标签_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()


 ' 不属于任何一个程序集、类模块的函数：
