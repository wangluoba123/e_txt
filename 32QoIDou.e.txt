 ' 文件类型：Windows模块源码

 ' 程序名称：按键精灵模块
 ' 程序描述：按键精灵类:
未安装过按键精灵的电脑先执行“注册DLL文件”命令
此类为调用按键精灵dll程序,运行前需先运行"释放文件到运行目录";调试程序还要运行"释放文件到临时目录" 


 ' 程序作者：夜猫
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 窗口2
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.图片 打包文件, " ' 已保存到：D:\易语言学习\Data\32QoIDou.e\打包文件", , 
.图片 DLL文件, " ' 已保存到：D:\易语言学习\Data\32QoIDou.e\DLL文件", , 
.常量 十进制文本, "1", 公开, 
.常量 十六进制文本, "2", 公开, 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' eCompress 7B68736E818E41c5A28B0AE4D43C128C 2 0 压缩解压支持库
 ' shell 52F260023059454187AF826A3C07AF2A 3 0 操作系统界面功能支持库





.DLL命令 _十六转十, 整数型, "shlwapi.dll", "StrToInt64ExA", , 64-bit integer
    .参数 pszString, 文本型, , 
    .参数 dwFlags, 整数型, , 
    .参数 piRet, 整数型, 传址, 

.程序集 启动程序集, , , 

.程序集变量 键盘钩子子程序, 子程序指针, , , 
.程序集变量 键盘钩子句柄, 整数型, , , 
.程序集变量 鼠标钩子句柄, 整数型, , , 
.程序集变量 鼠标钩子子程序, 子程序指针, , , 
.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码
输出调试文本 (“[[我是夜猫,谢谢你使用我的模块!]]”)
输出调试文本 (“[[欢迎来信交流:jxsgood@163.com]]”)

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。
 ' 载入 (窗口2, , 真)
载入 (窗口2, , 真)

.窗口程序集 窗口程序集1, , , 

.程序集变量 对象, 对象, , , 
.子程序 _按钮2_被单击, 空白型, , 
.局部变量 x, 整数型, , , 
.局部变量 y, 整数型, , , 

信息框 (按键精灵_获得鼠标形状 (), 0, )
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--


.子程序 _时钟1_周期事件, 空白型, , 
.局部变量 x, 整数型, , , 
.局部变量 y, 整数型, , , 

按键精灵_获得鼠标坐标 (x, y)
赋值 (.标题, 相加 (“鼠标坐标X=”, 到文本 (x), “ Y+”, 到文本 (y)))
赋值 (.背景颜色, 到数值 (按键精灵_获得坐标点颜色 (x, y, #十进制文本)))
赋值 (.标题, 按键精灵_获得坐标点颜色 (x, y, #十六进制文本))
赋值 (.标题, 相加 (“ 鼠标形状=”, 到文本 (按键精灵_获得鼠标形状 ())))
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 __启动窗口_创建完毕, 空白型, , 
按键精灵_释放文件到运行目录 ()
按键精灵_释放文件到临时目录 ()
 ' 释放文件 ()
输出调试文本 (取运行目录 ())
按键精灵_注册DLL文件 ()


.子程序 __启动窗口_将被销毁, 空白型, , 
对象.清除 ()


.程序集 按键精灵类, , , 此类为调用按键精灵dll程序,运行前需先运行"释放文件到运行目录";调试程序还要运行"释放文件到临时目录" 

.子程序 按键精灵_释放文件到运行目录, 空白型, 公开, 运行前需先运行"释放文件到运行目录"释放按键精灵用到的文件,,某些杀毒软件会报警 
.局部变量 temp, 文本型, , , 

载入 (窗口1, , 真)
赋值 (temp, 取运行目录 ())
写到文件 (相加 (temp, “\1.zip”), #打包文件)
窗口1.未知支持库函数_2 (., 相加 (temp, “\1.zip”), temp)
删除文件 (相加 (temp, “\1.zip”))
窗口1.销毁 ()
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 按键精灵_释放文件到临时目录, 空白型, 公开, 调试程序要运行"释放文件到临时目录"
.局部变量 temp, 文本型, , , 

载入 (窗口1, , 真)
赋值 (temp, 未知支持库函数_7 (11))
写到文件 (相加 (temp, “\1.zip”), #打包文件)
窗口1.未知支持库函数_2 (., 相加 (temp, “\1.zip”), temp)

删除文件 (相加 (temp, “\1.zip”))

窗口1.销毁 ()


.子程序 按键精灵_获得鼠标形状, 整数型, 公开, 返回一个整数为当前鼠标状态特征
.局部变量 值, 整数型, , , 
.局部变量 对象, 对象, , , 

对象.创建 (“QMDispatch.QMFunction”, )
赋值 (值, 对象.数值方法 (“GetCursorShape”, 0))
对象.清除 ()

返回 (值)


.子程序 按键精灵_获得鼠标坐标, 空白型, 公开, 
.参数 返回X, 整数型, 参考, 
.参数 返回Y, 整数型, 参考, 

.局部变量 坐标值, 整数型, , , 
.局部变量 对象, 对象, , , 

对象.创建 (“QMDispatch.QMFunction”, )
 ' 本源码来自易语言资源网(www.5A5X.com)
赋值 (坐标值, 对象.数值方法 (“GetCursorPos”, ))
赋值 (返回Y, 求余数 (坐标值, 8192))
赋值 (返回X, 取整 (相除 (坐标值, 8192)))
对象.清除 ()


.子程序 按键精灵_屏幕查找图片, 逻辑型, 公开, 成功返回真,失败返回假
.参数 区域左边, 整数型, , 
.参数 区域上边, 整数型, , 
.参数 区域右边, 整数型, , 
.参数 区域下边, 整数型, , 
.参数 图片路径, 文本型, , 
.参数 模糊参数, 小数型, , 相似度，取0.5到1之间的小数。数值越大，对图片的相似度要求越严格，速度也越快。推荐取0.9
.参数 返回X, 短整数型, 参考, 如果未找到 为-1
.参数 返回Y, 短整数型, 参考, 如果未找到 为-1

.局部变量 坐标值, 整数型, , , 
.局部变量 对象, 对象, , , 


对象.创建 (“QMDispatch.QMFunction”, )
赋值 (坐标值, 对象.数值方法 (“FindPic”, 区域左边, 区域上边, 区域右边, 区域下边, 图片路径, 模糊参数))
赋值 (返回X, 取整 (相除 (坐标值, 8192)))
赋值 (返回Y, 求余数 (坐标值, 8192))
对象.清除 ()
.如果真 (或者 (小于或等于 (返回X, 0), 小于或等于 (返回Y, 0)))
    赋值 (返回X, -1)
    赋值 (返回Y, -1)
    返回 (假)
.如果真结束

返回 (真)


.子程序 按键精灵_屏幕精确查找颜色, 逻辑型, 公开, 成功返回真,失败返回假
.参数 区域左边, 整数型, , 
.参数 区域上边, 整数型, , 
.参数 区域右边, 整数型, , 
.参数 区域下边, 整数型, , 
.参数 颜色值, 文本型, , 十六进制字符串
.参数 查找类型, 整数型, , 0为从上往下，从左往右找；1为从中心往外围找；2为从右下往左上
.参数 返回X, 短整数型, 参考, 如果未找到 为-1
.参数 返回Y, 短整数型, 参考, 如果未找到 为-1

.局部变量 坐标值, 整数型, , , 
.局部变量 对象, 对象, , , 

 ' 本源码来自易语言资源网(www.5A5X.com)
.如果真 (或者 (大于 (查找类型, 2), 小于 (查找类型, 0)))
    返回 (假)
.如果真结束
对象.创建 (“QMDispatch.QMFunction”, )
赋值 (坐标值, 对象.数值方法 (“FindColor”, 区域左边, 区域上边, 区域右边, 区域下边, 颜色值, 查找类型))
赋值 (返回X, 取整 (相除 (坐标值, 8192)))
赋值 (返回Y, 求余数 (坐标值, 8192))
对象.清除 ()
.如果真 (或者 (小于或等于 (返回X, 0), 小于或等于 (返回Y, 0)))
    赋值 (返回X, -1)
    赋值 (返回Y, -1)
    返回 (假)
.如果真结束
返回 (真)


.子程序 按键精灵_屏幕模糊查找颜色, 逻辑型, 公开, 成功返回真,失败返回假
.参数 区域左边, 整数型, , 
.参数 区域上边, 整数型, , 
.参数 区域右边, 整数型, , 
.参数 区域下边, 整数型, , 
.参数 颜色值, 文本型, , 十六进制字符串
.参数 查找类型, 整数型, , 0为从上往下，从左往右找；1为从中心往外围找；2为从右下往左上
.参数 模糊参数, 小数型, , 取0.3~1之间的小数,数字越大相似越严格,推荐0.8
.参数 返回X, 短整数型, 参考, 如果未找到 为-1
.参数 返回Y, 短整数型, 参考, 如果未找到 为-1

.局部变量 坐标值, 整数型, , , 
.局部变量 对象, 对象, , , 


.如果真 (或者 (大于 (查找类型, 2), 小于 (查找类型, 0)))
    返回 (假)
.如果真结束
对象.创建 (“QMDispatch.QMFunction”, )

赋值 (坐标值, 对象.数值方法 (“FindColor”, 区域左边, 区域上边, 区域右边, 区域下边, 颜色值, 查找类型, 模糊参数))
赋值 (返回X, 取整 (相除 (坐标值, 8192)))
赋值 (返回Y, 求余数 (坐标值, 8192))
对象.清除 ()
.如果真 (或者 (小于或等于 (返回X, 0), 小于或等于 (返回Y, 0)))
    赋值 (返回X, -1)
    赋值 (返回Y, -1)
    返回 (假)
.如果真结束
返回 (真)

.子程序 按键精灵_获得坐标点颜色, 文本型, 公开, 
.参数 横坐标, 整数型, , 
.参数 纵坐标, 整数型, , 
.参数 返回类型, 整数型, 可空, 1为十进制文本,2为十六进制文本 默认为2

.局部变量 数字, 文本型, , , 
.局部变量 对象, 对象, , , 

对象.创建 (“QMDispatch.QMFunction”, )
赋值 (数字, 对象.文本方法 (“GetPixelColor”, 横坐标, 纵坐标))
对象.清除 ()
.如果真 (不等于 (返回类型, 1))
    返回 (数字)
.如果真结束
赋值 (数字, 进制_十六转十 (数字))
返回 (数字)

.子程序 按键精灵_注册DLL文件, 空白型, 公开, 没有安装“按键精灵的系统”需注册DLL文件,释放“QMDispatch.dll”文件到windows目录，某些杀毒软件会报警
.局部变量 是否注册, 逻辑型, , , 
.局部变量 对象, 对象, , , 

赋值 (是否注册, 对象.创建 (“QMDispatch.QMFunction”, ))
' 本源码来自易语言资源网(www.5A5X.com)
.如果真 (是否注册)
    对象.清除 ()
    返回 ()
    
.如果真结束
未知支持库函数_7 (#)
到文本 (写到文件 (相加 (未知支持库函数_7 (#), “QMDispatch.dll”), #DLL文件))
运行 (相加 (“regsvr32 ”, 未知支持库函数_7 (#), “QMDispatch.dll -s”), 假, )


.子程序 进制_十六转十, 文本型, 公开, 
.参数 十六进制数字, 文本型, , 

.局部变量 a, 长整数型, , , 

_十六转十 (相加 (“0x”, 十六进制数字), 1, a)

返回 (到文本 (a))


 ' 不属于任何一个程序集、类模块的函数：
