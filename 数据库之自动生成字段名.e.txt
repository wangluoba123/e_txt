 ' 文件类型：Windows窗口程序

 ' 程序名称：自动生成格式化字段名
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 380
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' spec A512548E76954B6E92C21055517615B0 3 1 特殊功能支持库





.类模块 类数据库表操作, , , 

.程序集变量 m_格式字符L, 文本型, , , 
.程序集变量 m_格式字符R, 文本型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
赋值 (m_格式字符L, “[”)
赋值 (m_格式字符R, “]”)

.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用
 ' -----------------------------------------------------
 ' -      版本：1.0
 ' -  功能说明：自动根据设置生成SQL语句中的字段名
 ' -      输入：要求实现采用自动化工具生成包含数据库表字段名的方法
 ' -      输出：自动格式化后的字段名
 ' -    返回值：自动格式化后的字段名
 ' -
 ' - 对自动生成的方法参数中可以输入2种格式 1.如果只完整输出字段名就直接输入文本 0 如果需要排序 属性文本 序号
 ' - 如果需要对字段名重新格式化 应当输入 序号+"#"+格式化文本 如"AS 出生日期"
 ' -----------------------------------------------------


.子程序 表_人员, 文本型, 公开, 如果只获取一个字段名可以只设置参数为空文本即 ""
.参数 表名称, 文本型, 可空, 表名只能单独获取
.参数 整数_ID, 文本型, 可空, 
.参数 文本_姓名, 文本型, 可空, 
.参数 文本_年龄, 文本型, 可空, 

.局部变量 局字段们, 文本型, , "0", 
.局部变量 局返回文本, 文本型, , , 

.如果真 (等于 (是否为空 (表名称), 假))
    赋值 (表名称, “人员表”)
    返回 (表名称)
.如果真结束
 ' 本源码来自易语言资源网(www.5A5X.com)

.如果真 (等于 (是否为空 (整数_ID), 假))
    赋值 (整数_ID, 相加 (整数_ID, “#”, “ID”))
    加入成员 (局字段们, 整数_ID)
.如果真结束

.如果真 (等于 (是否为空 (文本_姓名), 假))
    赋值 (文本_姓名, 相加 (文本_姓名, “#”, “姓名”))
    加入成员 (局字段们, 文本_姓名)
.如果真结束

.如果真 (等于 (是否为空 (文本_年龄), 假))
    赋值 (文本_年龄, 相加 (文本_年龄, “#”, “年龄”))
    加入成员 (局字段们, 文本_年龄)
.如果真结束

赋值 (局返回文本, 格式化字段们 (局字段们))

返回 (局返回文本)


.子程序 格式化字段们, 文本型, , 
.参数 参字段文本数组, 文本型, 数组, 

.局部变量 文本们, 文本型, , "0", 
.局部变量 i, 整数型, , , 
.局部变量 局数量, 整数型, , , 
.局部变量 局返回文本, 文本型, , , 

调试输出 (参字段文本数组)
文本冒泡排序 (参字段文本数组, 真)
调试输出 (参字段文本数组)
.计次循环首 (取数组成员数 (参字段文本数组), i)
    
    赋值 (文本们, 分割文本 (参字段文本数组 [i], “#”, ))
    赋值 (局数量, 取数组成员数 (文本们))
    .如果真 (等于 (局数量, 2))
        赋值 (局返回文本, 相加 (局返回文本, m_格式字符L, 文本们 [2], m_格式字符R, “,”))
    .如果真结束
     ' 本源码来自易语言资源网(www.5A5X.com)
    .如果真 (等于 (局数量, 3))
        赋值 (局返回文本, 相加 (局返回文本, m_格式字符L, 文本们 [3], m_格式字符R, “”, 文本们 [2], “,”))
        
    .如果真结束
    
.计次循环尾 ()
赋值 (局返回文本, 文本替换 (局返回文本, 取文本长度 (局返回文本), 1, “”))
返回 (局返回文本)

.子程序 文本冒泡排序, 空白型, , 
.参数 数据数组, 文本型, 数组, 
.参数 由小到大, 逻辑型, 可空, 默认 假 由大到校 真由小到大

.局部变量 未比数据数量, 整数型, , , 
.局部变量 交换变量, 文本型, , , 
.局部变量 位置变量, 整数型, , , 
.局部变量 最后位置, 整数型, , , 
.局部变量 互换标记, 逻辑型, , , 

赋值 (未比数据数量, 取数组成员数 (数据数组)) ' 第一行排序比较所有数
.判断循环首 (大于 (未比数据数量, 0))
    赋值 (最后位置, 0)
    .变量循环首 (1, 相减 (未比数据数量, 1), 1, 位置变量)
        赋值 (互换标记, 假)
        .如果 (由小到大)
            .如果真 (大于 (数据数组 [位置变量], 数据数组 [相加 (位置变量, 1)]))
                赋值 (互换标记, 真)
            .如果真结束
            
        .否则
            
            .如果真 (小于 (数据数组 [位置变量], 数据数组 [相加 (位置变量, 1)]))
                赋值 (互换标记, 真)
            .如果真结束
            
        .如果结束
        
        .如果真 (互换标记)
            赋值 (交换变量, 数据数组 [位置变量]) ' 数据组可以是变量、文件、数据库（这里用的是变量）
            赋值 (数据数组 [位置变量], 数据数组 [相加 (位置变量, 1)])
            赋值 (数据数组 [相加 (位置变量, 1)], 交换变量) ' 以上3行代码是交换用的
            赋值 (最后位置, 位置变量)
        .如果真结束
        ' 本源码来自易语言资源网(www.5A5X.com)
    .变量循环尾 ()
    赋值 (未比数据数量, 最后位置) ' 下一行排序从第一个数开始到上次排序的最后被改变的位数
.判断循环尾 ()


.窗口程序集 窗口程序集1, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 a, 类数据库表操作, , , 
.局部变量 字段名, 文本型, , , 

 ' 调试输出 (a.表_人员 (“0# as 文本_12_年龄”, “0”))
 ' 赋值 (字段名, a.表_人员 (“”, “”, “”))
调试输出 (取文本 (“SELECT %s FROM %s”, 字段名, a.表_人员 (“”)))



 ' 不属于任何一个程序集、类模块的函数：
