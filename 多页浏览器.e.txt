 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 612
    高度 = 416
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “多页浏览器 易鸟先飞”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 512
    高度 = 338
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假

窗口 窗口2
    左边 = 50
    顶边 = 50
    宽度 = 362
    高度 = 174
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' HtmlView 5014D8FA6DCA40b68FA626D8183666EB 1 1 超文本浏览框支持库
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 1 1 多线程支持库




数据类型 客户区结构, , 
    .成员 hmenu, 整数型, , , 
    .成员 id, 整数型, , , 

数据类型 窗口类, , 
    .成员 size, 整数型, , , 
    .成员 style, 整数型, , , 
    .成员 func, 子程序指针, , , 
    .成员 class, 整数型, , , 
    .成员 win, 整数型, , , 
    .成员 hin, 整数型, , , 
    .成员 hicon, 整数型, , , 
    .成员 hcursor, 整数型, , , 
    .成员 bgground, 整数型, , , 
    .成员 menu, 整数型, , , 
    .成员 class1, 文本型, , , 
    .成员 hiconm, 整数型, , , 

数据类型 消息, , 
    .成员 hwnd, 整数型, , , 
    .成员 msg, 整数型, , , 
    .成员 wparam, 整数型, , , 
    .成员 lparam, 整数型, , , 
    .成员 time, 整数型, , , 
    .成员 point, 颜色, , , 

数据类型 颜色, , 
    .成员 red, 字节型, , , 
    .成员 green, 字节型, , , 
    .成员 blue, 字节型, , , 

数据类型 巨型, , 
    .成员 左边, 整数型, , , 
    .成员 顶边, 整数型, , , 
    .成员 右边, 整数型, , , 
    .成员 底边, 整数型, , , 

数据类型 子窗口类, , 
    .成员 class, 文本型, , , 
    .成员 title, 文本型, , , 
    .成员 handle, 整数型, , , 
    .成员 x, 整数型, , , 
    .成员 y, 整数型, , , 
    .成员 width, 整数型, , , 
    .成员 height, 整数型, , , 
    .成员 style, 整数型, , , 
    .成员 lparam, 整数型, , , 

数据类型 浏览器列表, , 
    .成员 hwnd, 整数型, , , 
    .成员 浏览器, 未知类型0x30001, , , 

数据类型 子夹, , 
    .成员 mask, 整数型, , , 
    .成员 stat, 整数型, , , 
    .成员 statmask, 整数型, , , 
    .成员 text, 文本型, , , 
    .成员 size, 整数型, , , 
    .成员 image, 整数型, , , 
    .成员 lparam, 整数型, , , 

数据类型 对应子夹, , 
    .成员 hwnd, 整数型, , , 
    .成员 htab, 整数型, , , 

数据类型 坐标, , 
    .成员 x, 整数型, , , 
    .成员 y, 整数型, , , 

数据类型 SHITEMID, , 
    .成员 ushort, 短整数型, , , 
    .成员 bt, 字节型, , "1", 

数据类型 ITEMIDLIST, , 
    .成员 sid, SHITEMID, , , 

数据类型 目录信息, , 
    .成员 菜单句柄, 整数型, , , 
    .成员 菜单id, 整数型, , , 
    .成员 标题, 文本型, , , 
    .成员 路径, 文本型, , , 
    .成员 网址, 文本型, , , 

数据类型 MENUITEMINFO, , 
    .成员 size, 整数型, , , 
    .成员 a, 整数型, , , 
    .成员 b, 整数型, , , 
    .成员 c, 整数型, , , 
    .成员 d, 整数型, , , 
    .成员 e, 整数型, , , 
    .成员 f, 整数型, , , 
    .成员 g, 整数型, , , 
    .成员 h, 整数型, , , 
    .成员 j, 文本型, , , 
    .成员 k, 整数型, , , 
    .成员 l, 整数型, , , 

数据类型 SHFILEINFO, , 
    .成员 hicon, 整数型, , , 
    .成员 iicon, 整数型, , , 
    .成员 arr, 整数型, , , 
    .成员 a, 字节型, , "256", 
    .成员 b, 字节型, , "80", 

.全局变量 client, 整数型, , , 
.全局变量 hchild, 整数型, , , 
.全局变量 hin, 整数型, , , 
.全局变量 x, 整数型, , , 
.全局变量 old, 整数型, , , 
.全局变量 id, 整数型, , , 
.全局变量 first, 逻辑型, , , 
.全局变量 MDIWIN, MDI_父窗口, , , 
.全局变量 MDICHILD, MDI_子窗口, , "0", 
.全局变量 当前子窗口, MDI_子窗口, , , 
.全局变量 临时浏览器, 浏览器列表, , "0", 
.全局变量 tabcontrol, 选择夹_管理, , , 
.全局变量 tabs, 对应子夹, , "0", 
.全局变量 收藏夹路径, 文本型, , , 
.全局变量 收藏家, 收藏夹_管理, , , 
.全局变量 目录列表, 目录信息, , "0", 

.DLL命令 创建窗口, 整数型, "user32.dll", "CreateWindowExA", , 
    .参数 exstyle, 整数型, , 
    .参数 class, 文本型, , 
    .参数 window, 整数型, , 
    .参数 style, 整数型, , 
    .参数 x, 整数型, , 
    .参数 y, 整数型, , 
    .参数 width, 整数型, , 
    .参数 height, 整数型, , 
    .参数 parent, 整数型, , 
    .参数 menu, 整数型, , 
    .参数 hin, 整数型, , 
    .参数 lparam, 客户区结构, , 

.DLL命令 获取句柄, 整数型, "kernel32.dll", "GetModuleHandleA", , 
    .参数 name, 整数型, , 

.DLL命令 显示窗口, 整数型, "user32.dll", "ShowWindow", , 
    .参数 hwnd, 整数型, , 
    .参数 cmd, 整数型, , 

.DLL命令 更新窗口, 整数型, "user32.dll", "UpdateWindow", , 
    .参数 hwnd, 整数型, , 

.DLL命令 获取菜单, 整数型, "user32.dll", "GetMenu", , 
    .参数 hwnd, 整数型, , 

.DLL命令 获取子菜单, 整数型, "user32.dll", "GetSubMenu", , 
    .参数 hmenu, 整数型, , 
    .参数 pos, 整数型, , 

.DLL命令 取类名, 整数型, "user32.dll", "GetClassNameA", , 
    .参数 hwnd, 整数型, , 
    .参数 name, 文本型, , 
    .参数 size, 整数型, , 

.DLL命令 移动窗口, 整数型, "user32.dll", "MoveWindow", , 
    .参数 hwnd, 整数型, , 
    .参数 x, 整数型, , 
    .参数 y, 整数型, , 
    .参数 width, 整数型, , 
    .参数 height, 整数型, , 
    .参数 bool, 整数型, , 

.DLL命令 发送外部信息, 整数型, "user32.dll", "SendMessageA", , 
    .参数 hwnd, 整数型, , 
    .参数 msg, 整数型, , 
    .参数 wparam, 整数型, , 
    .参数 lparam, 子窗口类, , 

.DLL命令 置前台窗口, 整数型, "user32.dll", "SetActiveWindow", , 
    .参数 hwnd, 整数型, , 

.DLL命令 建子窗口, 整数型, "user32.dll", "CreateMDIWindowA", , 
    .参数 class, 文本型, , 
    .参数 window, 文本型, , 
    .参数 style, 整数型, , 
    .参数 x, 整数型, , 
    .参数 y, 整数型, , 
    .参数 width, 整数型, , 
    .参数 height, 整数型, , 
    .参数 parent, 整数型, , 
    .参数 hin, 整数型, , 
    .参数 lparam, 整数型, , 

.DLL命令 载入图标, 整数型, "user32.dll", "LoadIconA", , 
    .参数 hin, 整数型, , 
    .参数 icon, 整数型, , 

.DLL命令 载入鼠标, 整数型, "user32.dll", "LoadCursorA", , 
    .参数 hin, 整数型, , 
    .参数 cursor, 整数型, , 

.DLL命令 获取信息, 整数型, "user32.dll", "GetMessage", , 
    .参数 lparam, 整数型, , 
    .参数 hwnd, 整数型, , 
    .参数 min, 整数型, , 
    .参数 max, 整数型, , 

.DLL命令 翻译消息, 整数型, "user32.dll", "TranslateMessage", , 
    .参数 msg, 消息, , 

.DLL命令 传递消息, 整数型, "user32.dll", "DispatchMessage", , 
    .参数 msg, 消息, , 

.DLL命令 设置关系, 整数型, "user32.dll", "SetParent", , 
    .参数 child, 整数型, , 
    .参数 new, 整数型, , 

.DLL命令 设置窗口风格, 整数型, "user32.dll", "SetWindowLongA", , 
    .参数 hwnd, 整数型, , 
    .参数 index, 整数型, , 
    .参数 new, 子程序指针, , 

.DLL命令 创建子窗口, 整数型, "user32.dll", "CreateWindowExA", , 
    .参数 exstyle, 整数型, , 
    .参数 class, 文本型, , 
    .参数 window, 文本型, , 
    .参数 style, 整数型, , 
    .参数 x, 整数型, , 
    .参数 y, 整数型, , 
    .参数 width, 整数型, , 
    .参数 height, 整数型, , 
    .参数 parent, 整数型, , 
    .参数 menu, 整数型, , 
    .参数 hin, 整数型, , 
    .参数 lparam, 整数型, , 

.DLL命令 设置背景色, 整数型, "gdi32.dll", "SetBkColor", , 
    .参数 hdc, 整数型, , 
    .参数 color, 颜色, , 

.DLL命令 获取场景, 整数型, "user32.dll", "GetDC", , 
    .参数 HWND, 整数型, , 

.DLL命令 获取系统刷子, 整数型, "gdi32.dll", "Rgb", , 
    .参数 red, 整数型, , 
    .参数 green, 整数型, , 
    .参数 blue, 整数型, , 

.DLL命令 取窗口标题, 整数型, "", "GetWindowTextA", , 
    .参数 HWND, 整数型, , 
    .参数 text, 文本型, , 
    .参数 count, 整数型, , 

.DLL命令 取窗口风格, 整数型, "", "GetWindowLongA", , 
    .参数 hwnd, 整数型, , 
    .参数 index, 整数型, , 

.DLL命令 缺省框架窗口函数, 整数型, "", "DefFrameProcA", , 
    .参数 hwnd, 整数型, , 
    .参数 client, 整数型, , 
    .参数 msg, 整数型, , 
    .参数 wparam, 整数型, , 
    .参数 lparam, 整数型, , 

.DLL命令 取菜单ID, 整数型, "", "GetMenuItemID", , 
    .参数 hmenu, 整数型, , 
    .参数 pos, 整数型, , 

.DLL命令 图标, 整数型, "", "LoadIconA", , 
    .参数 hin, 整数型, , 
    .参数 icon, 整数型, , 

.DLL命令 鼠标, 整数型, "", "LoadCursorA", , 
    .参数 hin, 整数型, , 
    .参数 cursor, 整数型, , 

.DLL命令 注册窗口类, 整数型, "", "RegisterClassExA", , 
    .参数 lm, 窗口类, , 

.DLL命令 缺省子窗口函数, 整数型, "", "DefMDIChildProcA", , 
    .参数 hwnd, 整数型, , 
    .参数 msg, 整数型, , 
    .参数 wparam, 整数型, , 
    .参数 lparam, 整数型, , 

.DLL命令 置窗口标题, 整数型, "", "SetWindowTextA", , 
    .参数 hwnd, 整数型, , 
    .参数 text, 文本型, , 

.DLL命令 取当前窗口, 整数型, "", "GetActiveWindow", , 

.DLL命令 消息, 整数型, "", "SendMessageA", , 
    .参数 hwnd, 整数型, , 
    .参数 msg, 整数型, , 
    .参数 wpram, 整数型, , 
    .参数 lparam, 整数型, , 

.DLL命令 调用窗口函数, 整数型, "", "CallWindowProcA", , 
    .参数 old, 整数型, , 
    .参数 hwnd, 整数型, , 
    .参数 msg, 整数型, , 
    .参数 wparam, 整数型, , 
    .参数 lparam, 整数型, , 

.DLL命令 取客户巨型, 空白型, "", "GetClientRect", , 
    .参数 hwnd, 整数型, , 
    .参数 rect, 巨型, 传址, 

.DLL命令 寻找窗口, 整数型, "", "FindWindowExA", , 
    .参数 hwnd, 整数型, , 
    .参数 child, 整数型, , 
    .参数 class, 文本型, , 
    .参数 cap, 整数型, , 

.DLL命令 子夹消息, 整数型, "", "SendMessageA", , 
    .参数 hwnd, 整数型, , 
    .参数 msg, 整数型, , 
    .参数 wparam, 整数型, , 
    .参数 lparam, 子夹, 传址, 

.DLL命令 取鼠标位置, 空白型, "", "GetCursorPos", , 
    .参数 point, 坐标, 传址, 

.DLL命令 加入收藏夹, 逻辑型, "shdocvw.dll", "DoAddToFavDlg", , 
    .参数 hwnd, 整数型, , 
    .参数 cap, 文本型, , 
    .参数 s, 整数型, , 
    .参数 title, 文本型, , 
    .参数 s1, 整数型, , 
    .参数 lpid, 整数型, , 

.DLL命令 取特殊路径, 整数型, "shell32.dll", "SHGetSpecialFolderLocation", , 
    .参数 hwnd, 整数型, , 
    .参数 type, 整数型, , 
    .参数 lpid, 整数型, 传址, 

.DLL命令 拷贝内存, 空白型, "", "CopyMemoryA", , 
    .参数 dest, 整数型, 传址, 
    .参数 source, 整数型, 传址, 
    .参数 size, 整数型, , 

.DLL命令 释放ID, 空白型, "ole32.dll", "CoTaskMemFree", , 
    .参数 pid, 整数型, , 

.DLL命令 加入菜单, 空白型, "", "AppendMenuA", , 
    .参数 hmenu, 整数型, , 
    .参数 flag, 整数型, , 
    .参数 id, 整数型, , 
    .参数 cap, 文本型, , 

.DLL命令 GetMenuPosFromID, 整数型, "shlwapi.dll", "GetMenuPosFromID", , 
    .参数 hmenu, 整数型, , 
    .参数 id, 整数型, , 

.DLL命令 DrawMenuBar, 空白型, "", "DrawMenuBar", , 
    .参数 hwnd, 整数型, , 

.DLL命令 SetMenuItemInfo, 逻辑型, "", "SetMenuItemInfoA", , 
    .参数 hmenu, 整数型, , 
    .参数 item, 整数型, , 
    .参数 bypos, 逻辑型, , 
    .参数 iteminfo, MENUITEMINFO, 传址, 

.DLL命令 CreatePopupMenu, 整数型, "", "CreatePopupMenu", , 

.DLL命令 插入菜单, 空白型, "", "InsertMenuA", , 
    .参数 hmenu, 整数型, , 
    .参数 pos, 整数型, , 
    .参数 flag, 整数型, , 
    .参数 id, 整数型, , 
    .参数 t, 文本型, , 

.DLL命令 SHGetFileInfo, 整数型, "shell32.dll", "SHGetFileInfo", , 
    .参数 path, 文本型, , 
    .参数 arr, 整数型, , 
    .参数 info, SHFILEINFO, 传址, 
    .参数 size, 整数型, , 
    .参数 flat, 整数型, , 

.DLL命令 RegOpenKeyEx, 空白型, "advapi32.dll", "RegOpenKeyExA", , 
    .参数 hkey, 整数型, , 
    .参数 path, 文本型, , 
    .参数 option, 整数型, , 
    .参数 sam, 整数型, , 
    .参数 lr, 整数型, 传址, 

.DLL命令 RegCloseKey, 整数型, "advapi32.dll", "RegCloseKey", , 
    .参数 hkey, 整数型, , 

.DLL命令 RegQueryValueEx, 整数型, "advapi32.dll", "RegQueryValueExA", , 
    .参数 hkey, 整数型, , 
    .参数 key, 文本型, , 
    .参数 r, 整数型, , 
    .参数 type, 整数型, , 
    .参数 data, 文本型, , 
    .参数 size, 整数型, 传址, 

.窗口程序集 窗口程序集1, , , 

.子程序 _按钮1_被单击, 空白型, , 


.子程序 __启动窗口_创建完毕, 空白型, , 

载入 (窗口1, , 假)
赋值 (收藏夹路径, 取注册文本 (2147483649, “Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders”, “Favorites”))
未知支持库函数_0 (&载入收藏夹, 0)
tabcontrol.设置选择夹 (取窗口句柄 ())
MDIWIN.注册类 ()
MDIWIN.创建 (_启动窗口)
MDIWIN.新建页面 (“”)


.子程序 __启动窗口_尺寸被改变, 空白型, , 
赋值 (.左边, 0)
赋值 (.宽度, _启动窗口.取用户区宽度 ())
赋值 (.顶边, 相加 (相减 (_启动窗口.取用户区高度 (), ., .可视), 12))
移动窗口 (MDIWIN.取MDI客户区 (), 0, 相加 (.可视, .可视), _启动窗口.取用户区宽度 (), 相减 (_启动窗口.取用户区高度 (), .可视, ., .高度, .可视, 3), 1)

.子程序 _图片框1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.边框, 5)

.子程序 _工具条2_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.边框, 0)

.子程序 _图片框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (不等于 (.内容, “”))
    当前子窗口.跳到网页 (.内容)
    
.如果真结束


.子程序 _组合框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #回车键))
    .如果真 (不等于 (.内容, “”))
        当前子窗口.跳到网页 (.内容)
    .如果真结束
    
.如果真结束


.子程序 _选择夹1_子夹被改变, 空白型, , 
.局部变量 i, 整数型, , , 

.变量循环首 (1, 取数组成员数 (tabs), 1, i)
    .如果真 (等于 (tabs [i], htab, .现行子夹))
        赋值 (当前子窗口, 寻找子窗口 (tabs [i], hwnd))
        MDIWIN.激活子窗口 (tabs [i], hwnd)
        跳出循环 ()
    .如果真结束
    
.变量循环尾 ()

.子程序 _选择夹1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 i, 整数型, , , 
.局部变量 temp, 整数型, , , 

赋值 (temp, .现行子夹)
.如果真 (等于 (temp, 0))
    返回 ()
.如果真结束
.变量循环首 (1, 取数组成员数 (tabs), 1, i)
    .如果真 (等于 (tabs [i], htab, temp))
        消息 (tabs [i], hwnd, 16, 0, 0)
        .如果真 (大于 (temp, 0))
            tabcontrol.激活子夹 (相减 (temp, 1))
            _选择夹1_子夹被改变 ()
        .如果真结束
        跳出循环 ()
    .如果真结束
    
.变量循环尾 ()


.子程序 _工具条1_被下拉, 空白型, , 
.参数 按钮索引, 整数型, , 
.参数 下拉横座标, 整数型, , 
.参数 下拉纵座标, 整数型, , 

.如果真 (等于 (按钮索引, 1))
    弹出菜单 (下拉横座标, 下拉纵座标)
.如果真结束


.子程序 _空白页_被选择, 空白型, , 
MDIWIN.新建页面 (“”)


.子程序 _当前页_被选择, 空白型, , 
.局部变量 web, 未知类型0x30001, , , 
.局部变量 i, 整数型, , , 

.变量循环首 (1, 取数组成员数 (临时浏览器), 1, i)
    .如果真 (等于 (临时浏览器 [i], hwnd, 当前子窗口.取句柄 ()))
        赋值 (web, 临时浏览器 [i], 浏览器)
        跳出循环 ()
    .如果真结束
    
.变量循环尾 ()
.如果真 (是否已创建 (web))
    MDIWIN.新建页面 (web.)
    
.如果真结束


.子程序 _保存HTML_被选择, 空白型, , 
.局部变量 web, 未知类型0x30001, , , 
.局部变量 i, 整数型, , , 

.变量循环首 (1, 取数组成员数 (临时浏览器), 1, i)
    .如果真 (等于 (临时浏览器 [i], hwnd, 当前子窗口.取句柄 ()))
        赋值 (web, 临时浏览器 [i], 浏览器)
        跳出循环 ()
    .如果真结束
    
.变量循环尾 ()
.如果真 (是否已创建 (web))
    web.未知支持库函数_0 (6)
.如果真结束


.子程序 _页面设置_被选择, 空白型, , 
.局部变量 web, 未知类型0x30001, , , 
.局部变量 i, 整数型, , , 

.变量循环首 (1, 取数组成员数 (临时浏览器), 1, i)
    .如果真 (等于 (临时浏览器 [i], hwnd, 当前子窗口.取句柄 ()))
        赋值 (web, 临时浏览器 [i], 浏览器)
        跳出循环 ()
    .如果真结束
    
.变量循环尾 ()
.如果真 (是否已创建 (web))
    web.未知支持库函数_0 (9)
.如果真结束


.子程序 _打印预览_被选择, 空白型, , 
.局部变量 web, 未知类型0x30001, , , 
.局部变量 i, 整数型, , , 

.变量循环首 (1, 取数组成员数 (临时浏览器), 1, i)
    .如果真 (等于 (临时浏览器 [i], hwnd, 当前子窗口.取句柄 ()))
        赋值 (web, 临时浏览器 [i], 浏览器)
        跳出循环 ()
    .如果真结束
    
.变量循环尾 ()
.如果真 (是否已创建 (web))
    web.未知支持库函数_0 (8)
.如果真结束


.子程序 _打印_被选择, 空白型, , 
.局部变量 web, 未知类型0x30001, , , 
.局部变量 i, 整数型, , , 

.变量循环首 (1, 取数组成员数 (临时浏览器), 1, i)
    .如果真 (等于 (临时浏览器 [i], hwnd, 当前子窗口.取句柄 ()))
        赋值 (web, 临时浏览器 [i], 浏览器)
        跳出循环 ()
    .如果真结束
    
.变量循环尾 ()
.如果真 (是否已创建 (web))
    web.未知支持库函数_0 (7)
.如果真结束


.子程序 _退出_被选择, 空白型, , 
_启动窗口.销毁 ()

.子程序 _空白页面_被选择, 空白型, , 
_空白页_被选择 ()

.子程序 _当前页面_被选择, 空白型, , 
_当前页_被选择 ()

.子程序 _选择夹1_鼠标右键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 p, 坐标, , , 

取鼠标位置 (p)
弹出菜单 (p.x, p.y)

.子程序 _关闭页面_被选择, 空白型, , 
_选择夹1_被双击 (0, 0, 0)

.子程序 _关闭所有页面_被选择, 空白型, , 
.局部变量 i, 整数型, , , 

赋值 (i, tabcontrol.取子夹个数 ())
.判断循环首 (大于 (i, 0))
    tabcontrol.激活子夹 (相减 (i, 1))
    _选择夹1_被双击 (0, 0, 0)
    赋值 (i, 相减 (i, 1))
.判断循环尾 ()
消息 (tabs [1].hwnd, 16, 0, 0)

.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.局部变量 web, 未知类型0x30001, , , 
.局部变量 i, 整数型, , , 
.局部变量 lpid, 整数型, , , 
.局部变量 addr, 整数型, , , 
.局部变量 path, 文本型, , , 

.如果真 (等于 (按钮索引, 1))
    _空白页_被选择 ()
    
.如果真结束
.如果真 (等于 (按钮索引, 3))
    .变量循环首 (1, 取数组成员数 (临时浏览器), 1, i)
        .如果真 (等于 (临时浏览器 [i], hwnd, 当前子窗口.取句柄 ()))
            赋值 (web, 临时浏览器 [i], 浏览器)
            跳出循环 ()
        .如果真结束
        
    .变量循环尾 ()
    .如果真 (是否已创建 (web))
        web.未知支持库函数_0 (1)
    .如果真结束
    
.如果真结束
.如果真 (等于 (按钮索引, 4))
    .变量循环首 (1, 取数组成员数 (临时浏览器), 1, i)
        .如果真 (等于 (临时浏览器 [i], hwnd, 当前子窗口.取句柄 ()))
            赋值 (web, 临时浏览器 [i], 浏览器)
            跳出循环 ()
        .如果真结束
        
    .变量循环尾 ()
    .如果真 (是否已创建 (web))
        web.未知支持库函数_0 (0)
    .如果真结束
    
.如果真结束
.如果真 (等于 (按钮索引, 5))
    .变量循环首 (1, 取数组成员数 (临时浏览器), 1, i)
        .如果真 (等于 (临时浏览器 [i], hwnd, 当前子窗口.取句柄 ()))
            赋值 (web, 临时浏览器 [i], 浏览器)
            跳出循环 ()
        .如果真结束
        
    .变量循环尾 ()
    .如果真 (是否已创建 (web))
        web.未知支持库函数_0 (5)
    .如果真结束
    
.如果真结束
.如果真 (等于 (按钮索引, 6))
    .变量循环首 (1, 取数组成员数 (临时浏览器), 1, i)
        .如果真 (等于 (临时浏览器 [i], hwnd, 当前子窗口.取句柄 ()))
            赋值 (web, 临时浏览器 [i], 浏览器)
            跳出循环 ()
        .如果真结束
        
    .变量循环尾 ()
    .如果真 (是否已创建 (web))
        web.未知支持库函数_0 (4)
    .如果真结束
    
.如果真结束
.如果真 (等于 (按钮索引, 9))
    .变量循环首 (1, 取数组成员数 (临时浏览器), 1, i)
        .如果真 (等于 (临时浏览器 [i], hwnd, 当前子窗口.取句柄 ()))
            赋值 (web, 临时浏览器 [i], 浏览器)
            跳出循环 ()
        .如果真结束
        
    .变量循环尾 ()
    .如果真 (是否已创建 (web))
        web.未知支持库函数_0 (2)
    .如果真结束
    
.如果真结束
.如果真 (等于 (按钮索引, 11))
    _启动窗口.销毁 ()
    
.如果真结束
.如果真 (等于 (按钮索引, 8))
    
    .变量循环首 (1, 取数组成员数 (临时浏览器), 1, i)
        .如果真 (等于 (临时浏览器 [i], hwnd, 当前子窗口.取句柄 ()))
            赋值 (web, 临时浏览器 [i], 浏览器)
            跳出循环 ()
        .如果真结束
        
    .变量循环尾 ()
    .如果真 (是否已创建 (web))
        .如果真 (等于 (web., “”))
            返回 ()
        .如果真结束
        赋值 (path, 取空白文本 (256))
        取特殊路径 (0, 6, lpid)
         ' 拷贝内存 (addr, lpid, 4)
        .如果真 (加入收藏夹 (_启动窗口.取窗口句柄 (), path, 256, web., 取文本长度 (web.), lpid))
            写配置项 (path, “InternetShortcut”, “URL”, web.)
            释放ID (lpid)
            信息框 (“已加入收藏夹!”, 0, )
            
        .如果真结束
        
    .如果真结束
    
    
.如果真结束


.子程序 _层叠排列_被选择, 空白型, , 
MDIWIN.层叠 ()

.子程序 _平铺排列_被选择, 空白型, , 
MDIWIN.平铺 ()

.子程序 _关于_被选择, 空白型, , 

载入 (窗口2, , 真)

.子程序 __启动窗口_被显示, 空白型, , 


.子程序 _添加到收藏夹_被选择, 空白型, , 
_工具条1_被单击 (8)

.类模块 MDI_父窗口, , , 

.程序集变量 mdiclient, 整数型, , , MDI客户区
.程序集变量 hin, 整数型, , , 应用程序句柄
.程序集变量 原窗口地址, 整数型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
赋值 (mdiclient, 0)


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 创建, 空白型, 公开, 
.参数 父窗口, 窗口, , 

.局部变量 kh, 客户区结构, , , 
.局部变量 hmenu, 整数型, , , 
.局部变量 hsub, 整数型, , , 
.局部变量 hdc, 整数型, , , 
.局部变量 color, 颜色, , , 

赋值 (hin, 获取句柄 (0))
赋值 (hmenu, 获取菜单 (父窗口.取窗口句柄 ()))
赋值 (hsub, 获取子菜单 (hmenu, 0))
赋值 (id, 取菜单ID (hsub, 0))
赋值 (kh.hmenu, hsub)
赋值 (kh.id, 100)
赋值 (mdiclient, 创建窗口 (512, “MDICLIENT”, 0, 1073741824, 0, 0, 父窗口.取用户区宽度 (), 父窗口.取用户区高度 (), 父窗口.取窗口句柄 (), 0, hin, kh))
显示窗口 (mdiclient, 1)
赋值 (原窗口地址, 设置窗口风格 (父窗口.取窗口句柄 (), -4, &窗口函数))

.子程序 取MDI客户区, 整数型, 公开, 
返回 (mdiclient)

.子程序 取原窗口函数, 整数型, 公开, 
返回 (原窗口地址)

.子程序 注册类, 空白型, 公开, 
.局部变量 子窗口, 窗口类, , , 

赋值 (hin, 获取句柄 (0))
赋值 (子窗口.size, 48)
赋值 (子窗口.style, 3)
赋值 (子窗口.func, &子窗口函数)
赋值 (子窗口.class, 0)
赋值 (子窗口.win, 0)
赋值 (子窗口.hin, hin)
赋值 (子窗口.hicon, 图标 (hin, 32512))
赋值 (子窗口.hcursor, 鼠标 (hin, 32512))
赋值 (子窗口.bgground, 5)
赋值 (子窗口.menu, 0)
赋值 (子窗口.class1, “testchild”)
赋值 (子窗口.hiconm, 0)
注册窗口类 (子窗口)

.子程序 激活子窗口, 空白型, 公开, 
.参数 窗口句柄, 整数型, , 

消息 (mdiclient, 546, 窗口句柄, 0)

.子程序 新建页面, 空白型, 公开, 
.参数 url, 文本型, , 

.局部变量 child, MDI_子窗口, , , 

赋值 (当前子窗口, child)
.如果 (等于 (url, “”))
    child.创建 (MDIWIN.取MDI客户区 (), “空白页面”, url)
.否则
    child.创建 (MDIWIN.取MDI客户区 (), url, url)
    child.跳到网页 (url)
.如果结束


加入成员 (MDICHILD, child)


.子程序 层叠, 空白型, 公开, 
消息 (mdiclient, 551, 0, 0)


.子程序 平铺, 空白型, 公开, 
消息 (mdiclient, 550, 0, 0)


.程序集 全局共享函数, , , 

.子程序 子窗口函数, 整数型, , 
.参数 hwnd, 整数型, , 
.参数 msg, 整数型, , 
.参数 wparam, 整数型, , 
.参数 lparam, 整数型, , 

.局部变量 web, 未知类型0x30001, , , 
.局部变量 rect, 巨型, , , 
.局部变量 temp, 浏览器列表, , , 
.局部变量 tab, 对应子夹, , , 
.局部变量 curwin, MDI_子窗口, , , 
.局部变量 i, 整数型, , , 

.如果真 (等于 (msg, 1))
    赋值 (tab.hwnd, hwnd)
    赋值 (tab.htab, tabcontrol.添加子夹 (“空白页面”))
    加入成员 (tabs, tab)
    赋值 (temp.hwnd, hwnd)
    复制窗口组件 (窗口1., temp.浏览器)
     ' 事件转移 (窗口1.超文本浏览框1, temp.浏览器)
    加入成员 (临时浏览器, temp)
    赋值 (web, temp.浏览器)
    设置关系 (web.取窗口句柄 (), hwnd)
    赋值 (web., 0)
    赋值 (web., 0)
    赋值 (web., 真)
    当前子窗口.设置句柄 (hwnd)
    .如果真 (不等于 (当前子窗口.取页面 (), “”))
        当前子窗口.跳到网页 (当前子窗口.取页面 ())
    .如果真结束
    
    
.如果真结束
.如果真 (等于 (msg, 5))
    赋值 (curwin, 寻找子窗口 (hwnd))
    取客户巨型 (curwin.取句柄 (), rect)
    赋值 (web, 寻找浏览器 (curwin.取句柄 ()))
    
    移动窗口 (web.取窗口句柄 (), 0, 0, 相减 (rect.右边, rect.左边), 相减 (rect.底边, rect.顶边), 1)
    返回 (缺省子窗口函数 (hwnd, msg, wparam, lparam))
.如果真结束
.如果真 (等于 (msg, 2))
    .如果真 (取反 (删除子窗口 (hwnd)))
        返回 (1)
    .如果真结束
    
.如果真结束
.如果真 (等于 (msg, 7))
    赋值 (当前子窗口, 寻找子窗口 (hwnd))
    .变量循环首 (1, 取数组成员数 (tabs), 1, i)
        .如果真 (等于 (tabs [i], hwnd, hwnd))
            tabcontrol.激活子夹 (tabs [i], htab)
            跳出循环 ()
            
        .如果真结束
        
    .变量循环尾 ()
.如果真结束
返回 (缺省子窗口函数 (hwnd, msg, wparam, lparam))

.子程序 窗口函数, 整数型, , 
.参数 hwnd, 整数型, , 
.参数 msg, 整数型, , 
.参数 wparam, 整数型, , 
.参数 lparam, 整数型, , 

.如果真 (或者 (等于 (msg, 5), 等于 (msg, 15), 等于 (msg, 78), 等于 (msg, 43), 等于 (msg, 44), 等于 (msg, 278), 等于 (msg, 279), 等于 (msg, 287), 等于 (msg, 288)))
    返回 (调用窗口函数 (MDIWIN.取原窗口函数 (), hwnd, msg, wparam, lparam))
.如果真结束
.如果真 (等于 (msg, 273))
    调用窗口函数 (MDIWIN.取原窗口函数 (), hwnd, msg, wparam, lparam)
    .如果真 (大于或等于 (wparam, 50000))
        菜单事件 (wparam)
    .如果真结束
    返回 (缺省框架窗口函数 (hwnd, MDIWIN.取MDI客户区 (), msg, wparam, lparam))
.如果真结束
.如果真 (等于 (msg, 2))
    结束 ()
    返回 (1)
.如果真结束
返回 (缺省框架窗口函数 (hwnd, MDIWIN.取MDI客户区 (), msg, wparam, lparam))

.子程序 寻找子窗口, MDI_子窗口, , 
.参数 hwnd, 整数型, , 

.局部变量 i, 整数型, , , 

.变量循环首 (1, 取数组成员数 (MDICHILD), 1, i)
    .如果真 (等于 (MDICHILD.取句柄 ( [i]), hwnd))
        返回 (MDICHILD [i])
    .如果真结束
    
.变量循环尾 ()
返回 (当前子窗口)

.子程序 寻找浏览器, 未知类型0x30001, , 
.参数 hwnd, 整数型, , 

.局部变量 i, 整数型, , , 
.局部变量 temp, 浏览器列表, , , 

赋值 (temp.hwnd, 0)
.变量循环首 (1, 取数组成员数 (临时浏览器), 1, i)
    .如果真 (等于 (临时浏览器 [i], hwnd, hwnd))
        返回 (临时浏览器 [i], 浏览器)
    .如果真结束
    
.变量循环尾 ()
返回 (temp.浏览器)


.子程序 删除子窗口, 逻辑型, , 
.参数 hwnd, 整数型, , 

.局部变量 i, 整数型, , , 

.变量循环首 (1, 取数组成员数 (tabs), 1, i)
    .如果真 (等于 (tabs [i], hwnd, hwnd))
        .如果真 (等于 (tabs [i], htab, 0))
            tabcontrol.设置标题 (0, “空白页面”)
            tabcontrol.设置开始页 (真)
            返回 (假)
        .如果真结束
        tabcontrol.删除子夹 (tabs [i], htab)
        删除成员 (tabs, i, )
        跳出循环 ()
        
    .如果真结束
    
.变量循环尾 ()

.变量循环首 (1, 取数组成员数 (MDICHILD), 1, i)
    .如果真 (等于 (MDICHILD.取句柄 ( [i]), hwnd))
        删除成员 (MDICHILD, i, )
        跳出循环 ()
    .如果真结束
    
.变量循环尾 ()
.变量循环首 (1, 取数组成员数 (临时浏览器), 1, i)
    .如果真 (等于 (临时浏览器 [i], hwnd, hwnd))
        临时浏览器.销毁 ( [i], 浏览器)
        删除成员 (临时浏览器, i, )
        跳出循环 ()
    .如果真结束
    
.变量循环尾 ()
返回 (真)

.子程序 新选择夹窗口函数, 整数型, , 
.参数 hwnd, 整数型, , 
.参数 msg, 整数型, , 
.参数 wparam, 整数型, , 
.参数 lparam, 整数型, , 

返回 (调用窗口函数 (tabcontrol.取原函数 (), hwnd, msg, wparam, lparam))

.子程序 载入收藏夹, 整数型, , 
.参数 lparam, 整数型, , 

.局部变量 mid, 整数型, , , 

赋值 (mid, 获取菜单 (_启动窗口.取窗口句柄 ()))
赋值 (mid, 获取子菜单 (mid, 1))

收藏家.创建列表 (mid)
返回 (0)

.子程序 取注册文本, 文本型, , 
.参数 hkey, 整数型, , 
.参数 path, 文本型, , 
.参数 key, 文本型, , 

.局部变量 content, 文本型, , , 
.局部变量 r, 整数型, , , 
.局部变量 size, 整数型, , , 

赋值 (content, 取空白文本 (256))
赋值 (size, 256)
RegOpenKeyEx (hkey, path, 0, 1, r)
RegQueryValueEx (r, key, 0, 0, content, size)
RegCloseKey (r)
返回 (content)

.子程序 菜单事件, 空白型, , 
.参数 tid, 整数型, , 

.局部变量 i, 整数型, , , 


.变量循环首 (1, 取数组成员数 (目录列表), 1, i)
    
    
    .如果真 (等于 (目录列表 [i], 菜单id, tid))
        MDIWIN.新建页面 (目录列表 [i], 网址)
    .如果真结束
    
.变量循环尾 ()

.类模块 MDI_子窗口, , , 

.程序集变量 标题, 文本型, , , 
.程序集变量 hin, 整数型, , , 
.程序集变量 句柄, 整数型, , , 
.程序集变量 页面, 文本型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用


.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 创建, 空白型, 公开, 
.参数 父窗口句柄, 整数型, , 
.参数 窗口标题, 文本型, , 
.参数 网站, 文本型, 可空, 

.局部变量 mdi, 子窗口类, , , 

赋值 (页面, 网站)
赋值 (mdi.class, “testchild”)
赋值 (mdi.title, 窗口标题)
赋值 (mdi.handle, hin)
赋值 (mdi.x, 2147483648)
赋值 (mdi.y, 2147483648)
赋值 (mdi.width, 2147483648)
赋值 (mdi.height, 2147483648)
赋值 (mdi.style, 16777216)
赋值 (mdi.lparam, 0)
赋值 (句柄, 发送外部信息 (父窗口句柄, 544, 0, mdi))


.子程序 取句柄, 整数型, 公开, 
返回 (句柄)

.子程序 设置句柄, 空白型, 公开, 
.参数 hwnd, 整数型, , 

赋值 (句柄, hwnd)


.子程序 跳到网页, 空白型, 公开, 
.参数 网址, 文本型, , 

.局部变量 i, 整数型, , , 
.局部变量 str, 文本型, , , 

赋值 (str, 网址)
赋值 (str, 到小写 (str))
.如果真 (不等于 (取文本左边 (str, 7), “http://”))
    赋值 (网址, 相加 (“http://”, 网址))
.如果真结束
.如果真 (等于 (_启动窗口.取项目数 (.), 50))
    _启动窗口.删除项目 (., 0)
.如果真结束
.如果真 (取反 (是否存在 (网址)))
    _启动窗口.插入项目 (., _启动窗口.取项目数 (.), 网址, )
    赋值 (_启动窗口..现行选中项, 相减 (_启动窗口.取项目数 (.), 1))
.如果真结束
置窗口标题 (句柄, 网址)
.变量循环首 (1, 取数组成员数 (临时浏览器), 1, i)
    .如果真 (等于 (临时浏览器 [i], hwnd, 句柄))
        .如果真 (是否已创建 (临时浏览器 [i], 浏览器))
            临时浏览器.未知支持库函数_1 ( [i], 浏览器, 网址, , )
        .如果真结束
        
        跳出循环 ()
    .如果真结束
    
.变量循环尾 ()

.子程序 取页面, 文本型, 公开, 
返回 (页面)

.子程序 设置标题, 空白型, 公开, 
.参数 caption, 文本型, , 

.局部变量 i, 整数型, , , 


.如果真 (大于 (取文本长度 (caption), 100))
    赋值 (caption, 相加 (取文本左边 (caption, 100), “...”))
.如果真结束
赋值 (标题, caption)
置窗口标题 (句柄, 标题)
.变量循环首 (1, 取数组成员数 (tabs), 1, i)
    .如果真 (等于 (tabs [i], hwnd, 句柄))
        tabcontrol.设置标题 (tabs [i], htab, 标题)
    .如果真结束
    
.变量循环尾 ()

.子程序 是否存在, 逻辑型, , 
.参数 text, 文本型, , 

.局部变量 i, 整数型, , , 

.变量循环首 (1, _启动窗口.取项目数 (.), 1, i)
    .如果真 (等于 (_启动窗口.取项目文本 (., 相减 (i, 1)), text))
        返回 (真)
    .如果真结束
    
.变量循环尾 ()
返回 (假)

.窗口程序集 窗口程序集2, , , 

.子程序 _窗口1_创建完毕, 空白型, , 


.子程序 _超文本浏览框1_状态文本被改变, 空白型, , 
.局部变量 web, 未知类型0x30001, , , 

赋值 (web, 取事件组件 ())
_启动窗口.置文本 (., 0, web.)

.子程序 _超文本浏览框1_标题被改变, 空白型, , 
.局部变量 web, 未知类型0x30001, , , 
.局部变量 i, 整数型, , , 
.局部变量 child, MDI_子窗口, , , 

赋值 (web, 取事件组件 ())
.变量循环首 (1, 取数组成员数 (临时浏览器), 1, i)
    .如果真 (等于 (临时浏览器 [i], 浏览器, web))
        赋值 (child, 寻找子窗口 (临时浏览器 [i], hwnd))
        child.设置标题 (web.)
        跳出循环 ()
    .如果真结束
    
.变量循环尾 ()



.子程序 _超文本浏览框1_即将打开新窗口, 逻辑型, , 
.局部变量 web, 未知类型0x30001, , , 

赋值 (web, 取事件组件 ())
.如果真 (等于 (取文本左边 (web., 7), “http://”))
    MDIWIN.新建页面 (web.)
.如果真结束

返回 (假)

.类模块 选择夹_管理, , , 

.程序集变量 句柄, 整数型, , , 
.程序集变量 子夹数量, 整数型, , , 
.程序集变量 原函数地址, 整数型, , , 
.程序集变量 开始页, 逻辑型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
赋值 (子夹数量, 0)
赋值 (开始页, 真)

.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 设置选择夹, 空白型, 公开, 
.参数 hwnd, 整数型, , 

赋值 (句柄, hwnd)
 ' 原函数地址 ＝ 设置窗口风格 (句柄, -4, &新选择夹窗口函数)

.子程序 添加子夹, 整数型, 公开, 
.参数 标题, 文本型, , 

.局部变量 tab, 子夹, , , 

赋值 (子夹数量, 消息 (句柄, 4868, 0, 0))
.如果真 (开始页)
    赋值 (开始页, 假)
    返回 (0)
.如果真结束
赋值 (tab.mask, 1)
赋值 (tab.stat, 0)
赋值 (tab.statmask, 0)
赋值 (tab.image, 0)
赋值 (tab.lparam, 0)
赋值 (tab.text, 标题)
赋值 (tab.size, 取文本长度 (标题))
子夹消息 (句柄, 4871, 子夹数量, tab)
消息 (句柄, 4876, 子夹数量, 0)
赋值 (子夹数量, 相加 (子夹数量, 1))
返回 (相减 (子夹数量, 1))

.子程序 取原函数, 整数型, 公开, 
返回 (原函数地址)

.子程序 删除子夹, 空白型, 公开, 
.参数 index, 整数型, , 

消息 (句柄, 4872, index, 0)

.子程序 设置开始页, 空白型, 公开, 
.参数 b, 逻辑型, , 

赋值 (开始页, b)

.子程序 设置标题, 空白型, 公开, 
.参数 index, 整数型, , 
.参数 caption, 文本型, , 

.局部变量 tab, 子夹, , , 

.如果真 (大于 (取文本长度 (caption), 20))
    赋值 (caption, 相加 (取文本左边 (caption, 20), “...”))
.如果真结束
赋值 (tab.mask, 1)
赋值 (tab.stat, 0)
赋值 (tab.statmask, 0)
赋值 (tab.image, 0)
赋值 (tab.lparam, 0)
赋值 (tab.text, caption)
赋值 (tab.size, 取文本长度 (caption))
子夹消息 (句柄, 4870, index, tab)
消息 (句柄, 4876, 子夹数量, 0)


.子程序 激活子夹, 空白型, 公开, 
.参数 index, 整数型, , 

消息 (句柄, 4876, index, 0)


.子程序 取子夹个数, 整数型, 公开, 
返回 (消息 (句柄, 4868, 0, 0))

.窗口程序集 窗口程序集3, , , 

.子程序 _按钮1_被单击, 空白型, , 
销毁 ()

.类模块 收藏夹_管理, , , 

.程序集变量 路径, 文本型, , , 
.程序集变量 文件图标, 整数型, , , 
.程序集变量 目录图标, 整数型, , , 
.程序集变量 启始句柄, 整数型, , , 
.程序集变量 根目录, 文本型, , , 
.子程序 _初始化, 空白型, , 当基于本类的对象被创建后，此方法会被自动调用
赋值 (启始句柄, 50000)
赋值 (文件图标, 0)
赋值 (目录图标, 0)

.子程序 _销毁, 空白型, , 当基于本类的对象被销毁前，此方法会被自动调用


.子程序 创建列表, 空白型, 公开, 
.参数 所在菜单, 整数型, , 

.局部变量 pinfo, 目录信息, , , 

赋值 (路径, 收藏夹路径)
.如果真 (不等于 (取文本右边 (路径, 1), “\”))
    赋值 (路径, 相加 (路径, “\”))
.如果真结束
赋值 (pinfo.菜单句柄, 所在菜单)
赋值 (pinfo.路径, 路径)
赋值 (pinfo.标题, “目录”)
加入成员 (目录列表, pinfo)
刷新列表 (路径)
 ' DrawMenuBar (_启动窗口.取窗口句柄 ())


.子程序 刷新列表, 空白型, 公开, 
.参数 目录, 文本型, , 

.局部变量 文件名, 文本型, , , 
.局部变量 目录d, 文本型, , , 
.局部变量 pinfo, 目录信息, , , 

赋值 (文件名, 寻找文件 (相加 (目录, “*.*”), ))
.判断循环首 (不等于 (文件名, “”))
    赋值 (启始句柄, 相加 (启始句柄, 1))
    赋值 (pinfo.路径, 目录)
    赋值 (pinfo.菜单id, 启始句柄)
    赋值 (pinfo.标题, 取文本左边 (文件名, 相减 (取文本长度 (文件名), 4)))
    赋值 (pinfo.网址, 读配置项 (相加 (pinfo.路径, 文件名), “InternetShortcut”, “URL”, “”))
    加入成员 (目录列表, pinfo)
    加入文件菜单 (pinfo)
    
    赋值 (文件名, 寻找文件 ())
.判断循环尾 ()
赋值 (目录d, 寻找文件 (相加 (目录, “*”), #子目录))
.判断循环首 (不等于 (目录d, “”))
    .如果真 (并且 (不等于 (目录d, “.”), 不等于 (目录d, “..”)))
        
        添加目录菜单 (目录, 目录d)
        刷新列表 (相加 (目录, 目录d, “\”))
    .如果真结束
    赋值 (目录d, 寻找文件 (#子目录))
.判断循环尾 ()


.子程序 添加目录菜单, 空白型, , 
.参数 parent, 文本型, , 
.参数 name, 文本型, , 

.局部变量 i, 整数型, , , 
.局部变量 pinfo, 目录信息, , , 
.局部变量 mm, MENUITEMINFO, , , 

.变量循环首 (1, 取数组成员数 (目录列表), 1, i)
    .如果真 (不等于 (目录列表 [i], 标题, “目录”))
        到循环尾 ()
    .如果真结束
    
    .如果真 (等于 (目录列表 [i], 路径, parent))
        赋值 (启始句柄, 相加 (启始句柄, 1))
        插入菜单 (目录列表 [i], 菜单句柄, 2, 1024, 启始句柄, name)
        
        赋值 (pinfo.路径, 相加 (parent, name, “\”))
        赋值 (pinfo.菜单id, 启始句柄)
        赋值 (pinfo.标题, “目录”)
        赋值 (pinfo.菜单句柄, CreatePopupMenu ())
        赋值 (mm.size, 48)
        赋值 (mm.a, 4)
        赋值 (mm.e, pinfo.菜单句柄)
        SetMenuItemInfo (目录列表 [i], 菜单句柄, 启始句柄, 假, mm)
        加入成员 (目录列表, pinfo)
        
    .如果真结束
    
.变量循环尾 ()

.子程序 加入文件菜单, 空白型, , 
.参数 pinfo, 目录信息, , 

.局部变量 i, 整数型, , , 
.局部变量 p, 文本型, , , 

.变量循环首 (1, 取数组成员数 (目录列表), 1, i)
    .如果真 (不等于 (目录列表 [i], 标题, “目录”))
        到循环尾 ()
    .如果真结束
    .如果真 (等于 (pinfo.路径, 目录列表 [i], 路径))
        赋值 (pinfo.菜单句柄, 目录列表 [i], 菜单句柄)
        .如果真 (大于 (取文本长度 (pinfo.标题), 30))
            赋值 (p, 相加 (取文本左边 (pinfo.标题, 40), “...”))
        .如果真结束
        .如果真 (不等于 (p, “”))
            加入菜单 (pinfo.菜单句柄, 0, pinfo.菜单id, p)
            
        .如果真结束
        
    .如果真结束
    
.变量循环尾 ()

.子程序 取文件图标, 整数型, , 
.参数 path, 文本型, , 

.局部变量 info, SHFILEINFO, , , 


SHGetFileInfo (path, 0, info, 20, 257)
返回 (info.hicon)


 ' 不属于任何一个程序集、类模块的函数：
