 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口
    左边 = 50
    顶边 = 50
    宽度 = 337
    高度 = 200
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “黄金加密锁”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 2 系统核心支持库
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 1 0 数据操作支持库一





.窗口程序集 窗口程序集1, , , 

.子程序 _超级链接框1_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (.现行选中项, -1))
    信息框 (“请先选择一种加密方式!”, #错误图标, “错误:”) ' 如果没有选择加密方式则无法加密
.否则
    .如果 (或者 (等于 (删全部空 (.内容), “”), 等于 (删全部空 (.内容), “”)))
        信息框 (“请将密码输入完整!”, #错误图标, “错误:”)
    .否则
        .如果 (不等于 (.内容, .内容))
            信息框 (“密码和重复密码不一致,请重新输入!”, #错误图标, “错误:”)
        .否则
            .如果真 (打开 ())
                .如果 (加密文件 (.文件名, .现行选中项))
                    信息框 (“对该文件加密成功!”, #信息图标, “恭喜:”)
                .否则
                    信息框 (“对该文件加密失败!”, #错误图标, “错误:”)
                .如果结束
                
            .如果真结束
            
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 加密文件, 逻辑型, , 
.参数 欲加密的文件, 文本型, , 
.参数 加密方式, 整数型, , 

.局部变量 数据, 字节集, , , 

关闭所有文件 ()
.如果真 (等于 (加密方式, 0))
    赋值 (数据, 未知支持库函数_3 (读入文件 (欲加密的文件), .内容, 1))
    .如果 (小于 (取字节集长度 (数据), 1))
        返回 (假)
    .否则
        返回 (写到文件 (欲加密的文件, 数据))
    .如果结束
    
.如果真结束
.如果真 (等于 (加密方式, 1))
    赋值 (数据, 未知支持库函数_3 (读入文件 (欲加密的文件), .内容, 2))
    .如果 (小于 (取字节集长度 (数据), 1))
        返回 (假)
    .否则
        返回 (写到文件 (欲加密的文件, 数据))
    .如果结束
    
.如果真结束
.如果真 (等于 (加密方式, 2))
    赋值 (数据, 未知支持库函数_3 (读入文件 (欲加密的文件), .内容, 1))
    .如果 (小于 (取字节集长度 (数据), 1))
        返回 (假)
    .否则
        关闭所有文件 ()
        返回 (写出数据 (打开文件 (欲加密的文件, #重写, ), 未知支持库函数_0 (到字节集 (.内容)), .内容, 数据))
    .如果结束
     ' 先要将密码压缩成字节集!否则用记事本等程序就能直接查看到密码!
.如果真结束
.如果真 (等于 (加密方式, 3))
    赋值 (数据, 未知支持库函数_3 (读入文件 (欲加密的文件), .内容, 2))
    .如果 (小于 (取字节集长度 (数据), 1))
        返回 (假)
    .否则
        关闭所有文件 ()
        返回 (写出数据 (打开文件 (欲加密的文件, #重写, ), 未知支持库函数_0 (到字节集 (.内容)), .内容, 数据))
    .如果结束
     ' 先要将密码压缩成字节集!否则用记事本等程序就能直接查看到密码!
.如果真结束
.如果真 (等于 (加密方式, 4))
    赋值 (数据, 未知支持库函数_0 (读入文件 (欲加密的文件)))
    .如果 (小于 (取字节集长度 (数据), 1))
        返回 (假)
    .否则
        关闭所有文件 ()
        返回 (写出数据 (打开文件 (欲加密的文件, #重写, ), 未知支持库函数_0 (到字节集 (.内容)), .内容, 数据))
    .如果结束
    关闭所有文件 ()
.如果真结束
返回 (真) ' 这条命令本来不应该有的,E3.39如果没有这条命令就无法运行了!BUG!

.子程序 _超级链接框2_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 密码, 文本型, , , 
.局部变量 数据, 字节集, , , 
.局部变量 提示, 文本型, , , 
.局部变量 密码2, 字节集, , , 
.局部变量 最终数据, 字节集, , , 
.局部变量 最终密码, 文本型, , , 

.如果 (等于 (.现行选中项, -1))
    信息框 (“请先选择一种解密方式!”, #错误图标, “错误:”)
.否则
    .如果真 (等于 (信息框 (相加 (“您确认要使用:”, .取项目文本 (.现行选中项), “来解密文件吗?”), 相加 (#询问图标, #是否钮), “询问:”), #是钮))
        .如果真 (打开 ())
            .如果真 (等于 (.现行选中项, 0))
                .如果真 (输入框 (相加 (“请输入密码:”, #换行符, “警告:由于这是标准加密法,因此不具有密码效验,请输入正确的密码,否则解密会失败,建议您使用该解密法之前请备份文件!”), “解密:”, , 密码, ))
                    赋值 (数据, 未知支持库函数_4 (读入文件 (.文件名), 密码, 1))
                    .如果 (小于 (取字节集长度 (数据), 1))
                        信息框 (“该文件不是由此软件加密而成的!”, #错误图标, “错误:”)
                    .否则
                        .如果 (写到文件 (.文件名, 数据))
                            信息框 (“该文件解密成功!”, #信息图标, “恭喜:”)
                        .否则
                            信息框 (“该文件解密失败!”, #错误图标, “错误:”)
                        .如果结束
                        
                    .如果结束
                    
                .如果真结束
                关闭所有文件 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 1))
                .如果真 (输入框 (相加 (“请输入密码:”, #换行符, “警告:由于这是标准加密法,因此不具有密码效验,请输入正确的密码,否则解密会失败,建议您使用该解密法之前请备份文件!”), “解密:”, , 密码, ))
                    赋值 (数据, 未知支持库函数_4 (读入文件 (.文件名), 密码, 2))
                    .如果 (小于 (取字节集长度 (数据), 1))
                        信息框 (“该文件不是由此软件加密而成的!”, #错误图标, “错误:”)
                    .否则
                        .如果 (写到文件 (.文件名, 数据))
                            信息框 (“该文件解密成功!”, #信息图标, “恭喜:”)
                        .否则
                            信息框 (“该文件解密失败!”, #错误图标, “错误:”)
                        .如果结束
                        
                    .如果结束
                    
                .如果真结束
                关闭所有文件 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 2))
                .如果 (读入数据 (打开文件 (.文件名, , ), 密码2, 提示, 数据))
                    .如果真 (输入框 (相加 (“请输入密码:”, #换行符, #换行符, 提示), “解密:”, , 密码, #输入密码))
                        赋值 (最终密码, 到文本 (未知支持库函数_1 (密码2)))
                        .如果 (等于 (密码, 最终密码))
                            赋值 (最终数据, 未知支持库函数_4 (数据, 密码, 1))
                            关闭所有文件 ()
                            .如果 (写到文件 (.文件名, 最终数据))
                                信息框 (“该文件解密成功!”, #信息图标, “恭喜:”)
                            .否则
                                信息框 (“该文件解密失败!”, #错误图标, “错误:”)
                            .如果结束
                            
                        .否则
                            信息框 (“密码错误,无法解密码!”, #错误图标, “错误:”)
                        .如果结束
                        
                    .如果真结束
                    
                .否则
                    信息框 (“该文件不是由此软件加密而成的!”, #错误图标, “错误:”)
                .如果结束
                关闭所有文件 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 3))
                .如果 (读入数据 (打开文件 (.文件名, , ), 密码2, 提示, 数据))
                    .如果真 (输入框 (相加 (“请输入密码:”, #换行符, #换行符, 提示), “解密:”, , 密码, #输入密码))
                        赋值 (最终密码, 到文本 (未知支持库函数_1 (密码2)))
                        .如果 (等于 (密码, 最终密码))
                            赋值 (最终数据, 未知支持库函数_4 (数据, 密码, 2))
                            关闭所有文件 ()
                            .如果 (写到文件 (.文件名, 最终数据))
                                信息框 (“该文件解密成功!”, #信息图标, “恭喜:”)
                            .否则
                                信息框 (“该文件解密失败!”, #错误图标, “错误:”)
                            .如果结束
                            
                        .否则
                            信息框 (“密码错误,无法解密码!”, #错误图标, “错误:”)
                        .如果结束
                        
                    .如果真结束
                    
                .否则
                    信息框 (“该文件不是由此软件加密而成的!”, #错误图标, “错误:”)
                .如果结束
                关闭所有文件 ()
            .如果真结束
            .如果真 (等于 (.现行选中项, 4))
                .如果 (读入数据 (打开文件 (.文件名, , ), 密码2, 提示, 数据))
                    .如果真 (输入框 (相加 (“请输入密码:”, #换行符, #换行符, 提示), “解密:”, , 密码, #输入密码))
                        赋值 (最终密码, 到文本 (未知支持库函数_1 (密码2)))
                        .如果 (等于 (密码, 最终密码))
                            赋值 (最终数据, 未知支持库函数_1 (数据))
                            关闭所有文件 ()
                            .如果 (写到文件 (.文件名, 最终数据))
                                信息框 (“该文件解密成功!”, #信息图标, “恭喜:”)
                            .否则
                                信息框 (“该文件解密失败!”, #错误图标, “错误:”)
                            .如果结束
                            
                        .否则
                            信息框 (“密码错误,无法解密码!”, #错误图标, “错误:”)
                        .如果结束
                        
                    .如果真结束
                    
                .否则
                    信息框 (“该文件不是由此软件加密而成的!”, #错误图标, “错误:”)
                .如果结束
                关闭所有文件 ()
            .如果真结束
            
        .如果真结束
        
    .如果真结束
    
.如果结束
关闭所有文件 ()

.子程序 _标签1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

投递信息 (161, 2, 0) ' 托动窗口

.子程序 _图形按钮1_被单击, 空白型, , 
赋值 (.位置, 2) ' 将窗口移动到最小化状态

.子程序 _图形按钮2_被单击, 空白型, , 
结束 ()

.子程序 _列表框_列表项被选择, 空白型, , 
.如果 (或者 (等于 (.现行选中项, 0), 等于 (.现行选中项, 1)))
    赋值 (.禁止, 真)
.否则
    赋值 (.禁止, 假)
.如果结束
 ' DES和RC4的标准加密法不支持遗忘提示!


 ' 不属于任何一个程序集、类模块的函数：
