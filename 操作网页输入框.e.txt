 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 454
    高度 = 304
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假



.常量 SMTO_ABORTIFHUNG, "2", , 
.常量 IHTMLDocument2, "“332C4425-26CB-11D0-B483-00C04FD90119”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 1 系统核心支持库
 ' shdocvw.npk {8856F961-340A-11D0-A96B-00C04FD705A2}##0 1 0 SHDocVw 2,{34A226E0-DF30-11CF-89A9-00A0C9054129},CommandStateChangeConstants,{},{1073741826,1073741825,1073741824,},{}2,{00000000-0000-0000-0000-000000000000},OLECMDID,{},{1073741880,1073741879,1073741878,1073741877,1073741876,1073741875,1073741874,1073741873,1073741872,1073741871,1073741870,1073741869,1073741868,1073741867,1073741866,1073741865,1073741864,1073741863,1073741862,1073741861,1073741860,1073741859,1073741858,1073741857,1073741856,1073741855,1073741854,1073741853,1073741852,1073741851,1073741850,1073741849,1073741848,1073741847,1073741846,1073741845,1073741844,1073741843,1073741842,1073741841,1073741840,1073741839,1073741838,1073741837,1073741836,1073741835,1073741834,1073741833,1073741832,1073741831,1073741830,1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}2,{00000000-0000-0000-0000-000000000000},OLECMDF,{},{1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}2,{00000000-0000-0000-0000-000000000000},OLECMDEXECOPT,{},{1073741827,1073741826,1073741825,1073741824,},{}2,{00000000-0000-0000-0000-000000000000},tagREADYSTATE,{},{1073741828,1073741827,1073741826,1073741825,1073741824,},{}2,{65507BE0-91A8-11D3-A845-009027220E6D},SecureLockIconConstants,{},{1073741830,1073741829,1073741828,1073741827,1073741826,1073741825,1073741824,},{}0,{EAB22AC3-30C1-11CF-A7EB-0000C05BAE0B},WebBrowser_V1,{100,101,102,103,104,-550,105,106,200,201,202,203,},{212,211,210,209,208,207,206,205,204,},{100,101,102,108,104,105,106,107,113,200,201,204,103,109,110,111,112,}1,{8856F961-340A-11D0-A96B-00C04FD705A2},WebBrowser,{100,101,102,103,104,-550,105,106,200,201,202,203,300,301,302,303,500,501,502,503,},{556,555,554,553,552,551,550,-525,407,406,405,404,403,402,401,400,-515,0,212,211,210,209,208,207,206,205,204,},{102,108,105,106,104,113,112,250,251,252,259,253,254,255,256,257,258,260,262,264,265,266,267,263,268,269,270,271,225,226,227,272,273,}0,{0002DF01-0000-0000-C000-000000000046},InternetExplorer,{100,101,102,103,104,-550,105,106,200,201,202,203,300,301,302,303,500,501,502,503,},{556,555,554,553,552,551,550,-525,407,406,405,404,403,402,401,400,-515,0,212,211,210,209,208,207,206,205,204,},{102,108,105,106,104,113,112,250,251,252,259,253,254,255,256,257,258,260,262,264,265,266,267,263,268,269,270,271,225,226,227,272,273,}2,{F41E6981-28E5-11D0-82B4-00A0C90C29C5},ShellWindowTypeConstants,{},{1073741827,1073741826,1073741825,1073741824,},{}0,{9BA05972-F6A8-11CF-A442-00A0C90A8F39},ShellWindows,{0,-4,},{1610743808,},{200,201,}0,{64AB4BB7-111E-11D1-8F79-00C04FC2FBE1},ShellUIHelper,{4,5,6,7,8,9,10,11,13,},{},{}0,{55136805-B2DE-11D1-B9F2-00A0C98BC547},ShellNameSpace,{1,2,3,4,5,6,7,8,9,11,12,13,15,16,23,24,25,26,15,16,},{22,21,20,19,18,17,14,10,},{1,2,3,4,}





.DLL命令 SendMessageTimeout, 整数型, "", "SendMessageTimeoutA", , 
    .参数 hwnd, 整数型, , 
    .参数 msg, 整数型, , 
    .参数 wParam, 整数型, , 
    .参数 lParam, 整数型, , 
    .参数 fuFlags, 整数型, , 
    .参数 uTimeout, 整数型, , 
    .参数 lpdwResult, 整数型, 传址, 

.DLL命令 ObjectFromLresult, 整数型, "oleacc.dll", "ObjectFromLresult", , 
    .参数 lResult, 整数型, , 
    .参数 riid, 文本型, , 
    .参数 wParam, 整数型, , 
    .参数 ppvObject, 对象, 传址, 

.窗口程序集 窗口程序集1, , , 

.程序集变量 Document对象, 对象, , , 
.程序集变量 元素集合, 对象, , , 
.程序集变量 INPUT元素集合, 对象, , , 
.程序集变量 元素1, 对象, , , 
.程序集变量 元素2, 对象, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 a, 整数型, , , 

相加 (取运行目录 (), “\test.htm”).未知支持库函数_37 ()
赋值 (Document对象, 未知支持库函数_32 ()) ' 取Document对象
Document对象.查看 () ' 不加这句还不行，晕~！；这样就说明此程序不能编译，因为编译后这句会跳过去，倒~！

赋值 (元素集合, Document对象.读对象型属性 (“all”, )) ' 取出所有元素
赋值 (a, 元素集合.读数值属性 (“length”, )) ' 所有元素的数目
输出调试文本 (相加 (“all：”, 到文本 (a)))

赋值 (INPUT元素集合, 元素集合.对象型方法 (“tags”, “Input”)) ' 取出所有元素中包涵的所有的Input元素
赋值 (a, INPUT元素集合.读数值属性 (“length”, )) ' 所有Input元素的数目
输出调试文本 (相加 (“Input：”, 到文本 (a)))

赋值 (元素1, INPUT元素集合.对象型方法 (“item”, 0)) ' 取第一个Input元素

赋值 (元素2, INPUT元素集合.对象型方法 (“item”, 1)) ' 取第二个Input元素

.子程序 _按钮1_被单击, 空白型, , 
赋值 (.内容, 元素1.读文本属性 (“value”, ))
赋值 (.内容, 元素2.读文本属性 (“value”, ))

.子程序 _按钮2_被单击, 空白型, , 
元素1.写属性 (“value”, .内容)
元素2.写属性 (“value”, .内容)





 ' 只放出“用com来建立并复制一个shellwindows对象的例程”吧，我想这才是大家都想要的。主要的思路是如何得到ie的htmldocument2接口
 ' 
 ' 
 ' 窗口程序集：窗口程序集1
 ' 程序集变量：document对象集合  数据类型：对象    数组：0
 ' 
 ' 
 ' 
 ' 子程序：任意
 ' 局部变量：n       数据类型：整数型
 ' 局部变量：y       数据类型：整数型
 ' 局部变量：shellwindows对象    数据类型：对象
 ' 局部变量：webbrowser2对象     数据类型：对象
 ' 局部变量：document对象  数据类型：对象
 ' 局部变量：input元素     数据类型：对象


如果真 (shellwindows对象.创建 (“shellwindows”, “c:\windows\system32\shdocvw.dll”))
*备注：我的系统是win2000

重定义数组 (document对象集合, 假, 0)

计次循环首 (shellwindows对象.读数值属性 (“count”, ), n)
*备注：根椐现在存在的webbrowser2对象的数目来循环

y ＝ n － 1

webbrowser2对象 ＝ shellwindows对象.对象型方法 (“item”, y)
*备注：并不是所有的webbrowser2对象都是ie的，还有资源管理器的等等~

document对象 ＝ webbrowser2对象.读对象型属性 (“document”, )
*备注：取document对象

input元素 ＝ document对象.对象型方法 (“getelementsbytagname”, “input”)
*备注：取input元素的集合
 ' 
 ' 如果真 (取反 (input元素.是否为空 ()))
 ' *备注：判断是否有input元素
 ' 加入成员 (document对象集合, document对象)
 ' 如果真结束

input元素.清除 ()
 ' Document对象.清除 ()
 ' webbrowser2对象.清除 ()
 ' 
 ' .计次循环首 ()
 ' .计次循环尾 ()
 ' 
 ' 
 ' 
 ' *备注：如果只需要指定窗口句柄的对象，可用此方法来判断
 ' 
 ' 
 ' 
 ' 执行完毕后，“document对象集合”数组中的就是IE的所有htmldocument2接口（我用的判断是否是IE的接口的方法有点拙劣，就是看它有没有input元素，有些网页也没有input元素，不过用在这里我们不用管它，所以得到的都是有input元素的）
 ' 
 ' 有了这些接口就好办了，可以直接使用我前面那个例子中提取元素的方法




相对前面那个例子更深一步的提取元素的方法


窗口程序集：窗口程序集1
程序集变量：子元素      数据类型：对象    数组：0


子程序：读取元素
参数：HTMLDocument2接口       数据类型：对象

局部变量：元素集合      数据类型：对象
局部变量：元素X   数据类型：对象
局部变量：type    数据类型：文本型
局部变量：N       数据类型：整数型

元素集合 ＝ HTMLDocument2接口.对象型方法 (“getElementsByTagName”, “Input”)
*备注：取出所有元素中的Input元素集合

清除数组 (子元素)

计次循环首 (元素集合.读数值属性 (“length”, ), N)
*备注：根椐Input元素的数目来循环

元素X ＝ 元素集合.对象型方法 (“item”, N － 1)
*备注：取指定索引的Input元素，注意：是从0开始

type ＝ 元素X.读文本属性 (“type”, )
*备注：取Input元素的类型
 ' 
 ' 如果真 (type ＝ “text” 或 type ＝ “password”)
 ' *备注：如果是文本框或密码框则保存到数组中
 ' 加入成员 (子元素, 元素X)
 ' 如果真结束

元素X.清除 ()
*备注：释放对象

计次循环尾 ()

执行完毕后，“子元素”数组中的就是该HTMLDocument2接口内的文本框或密码框，可用下面的方法来读写：

X=子元素 [N].读文本属性 (“value”, )

子元素 [N].写属性 (“value”, X )


还有一种文本框属于“TEXTAREA”类型，可用下面的方法取得：



元素集合 ＝ HTMLDocument2接口.对象型方法 (“getElementsByTagName”, “TEXTAREA”)
*备注：取出所有元素中的TEXTAREA元素集合

计次循环首 (元素集合.读数值属性 (“length”, ), N)
*备注：根椐TEXTAREA元素的数目来循环
加入成员 (子元素, 元素集合.对象型方法 (“item”, N － 1))
*备注：取指定索引的TEXTAREA元素保存到数组中
计次循环尾 ()
 ' 


 ' 不属于任何一个程序集、类模块的函数：
