 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 主窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 700
    高度 = 672
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 帮助窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 302
    高度 = 166
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 _启动窗口
    左边 = 50
    顶边 = 50
    宽度 = 301
    高度 = 156
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 2
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 2
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\贫困生管理系统.e\_启动窗口_底图
    图标 =  ' 已保存到：D:\易语言学习\Data\贫困生管理系统.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “ 系统登陆”
    帮助文件名 = “”

窗口 添加记录窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 488
    高度 = 579
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “修改记录”
    帮助文件名 = “”

窗口 注册软件窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 302
    高度 = 181
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “软件注册”
    帮助文件名 = “”

窗口 查询窗口
    左边 = 50
    顶边 = 50
    宽度 = 332
    高度 = 132
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “单项查询”
    帮助文件名 = “”

窗口 报表窗口
    左边 = 50
    顶边 = 50
    宽度 = 645
    高度 = 600
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “个人报表”
    帮助文件名 = “”

窗口 修改记录窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 505
    高度 = 632
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 系统设置窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 431
    高度 = 381
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 用户管理窗口
    左边 = 50
    顶边 = 50
    宽度 = 391
    高度 = 295
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “用户管理”
    帮助文件名 = “”

窗口 单位设置窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 298
    高度 = 239
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 真
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 从Excel导入窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 324
    高度 = 299
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “execl导入edb”
    帮助文件名 = “”



.图片 托盘图标, " ' 已保存到：D:\易语言学习\Data\贫困生管理系统.e\托盘图标", , 
.图片 tmp, " ' 已保存到：D:\易语言学习\Data\贫困生管理系统.e\tmp", , 
.常量 数据库1, "“管理员库”", , 
.常量 贫困生库, "“贫困生库”", , 
.常量 用户名, "“用户名”", , 
.常量 密码, "“密码”", , 
.常量 权限, "“权限”", , 
.常量 学生姓名, "“学生姓名”", , 
.常量 性别, "“性别”", , 
.常量 年龄, "“年龄”", , 
.常量 民族, "“民族”", , 
.常量 就读学校, "“就读学校”", , 
.常量 学习阶段, "“学习阶段”", , 
.常量 年级, "“年级”", , 
.常量 班别, "“班别”", , 
.常量 父亲姓名, "“父亲姓名”", , 
.常量 父亲工作单位, "“父亲工作单位”", , 
.常量 母亲姓名, "“母亲姓名”", , 
.常量 母亲工作单位, "“母亲工作单位”", , 
.常量 其他监护姓名, "“其他监护姓名”", , 
.常量 其他工作单位, "“其他工作单位”", , 
.常量 家庭住址, "“家庭住址”", , 
.常量 贫困类型, "“贫困类型”", , 
.常量 总人口, "“总人口”", , 
.常量 收入来源, "“收入来源”", , 
.常量 年均人收入, "“年均人收入”", , 
.常量 申请补助理由, "“申请补助理由”", , 
.常量 区县, "“区县”", , 
.常量 主管部门, "“主管部门”", , 
.常量 学校, "“学校”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' eExcel2000 F86EC5989E044d42BC98C692C0B54727 1 0 EXCEL2000支持库




.全局变量 当前用户, 文本型, , , 
.全局变量 用户管理权, 文本型, , , 
.全局变量 系统初始化权, 文本型, , , 
.全局变量 数据库权, 文本型, , , 
.全局变量 验证号, 文本型, , , 
.全局变量 序列号, 文本型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 记录数, 整数型, , , 
.子程序 _取消按钮_被单击, 空白型, , 
全部关闭 ()
结束 ()


.子程序 __启动窗口_创建完毕, 空白型, , 
.如果真 (并且 (小于 (取屏幕宽度 (), 1024), 小于 (取屏幕高度 (), 768)))
    信息框 (“你的显示器分辨率不是1024*768，如果想取得最佳效果，请将显示器分辨率调整为1024*768”, 1, )
    显示 (“3”)
.如果真结束
打开 (相加 (取运行目录 (), “\data\管理员库.edb”), “管理员库”, , , , , )
置当前库 (“管理员库”)
.计次循环首 (取记录数 (), 记录数)
    读 (#用户名).加入项目 ()
    跳过 ()
.计次循环尾 ()
赋值 (.现行选中项, 0)
获取焦点 ()
赋值 (.内容, “888”)


.子程序 显示, 空白型, , 
.参数 参数, 文本型, , 

运行 (相加 (“rundll32.exe shell32.dll,Control_RunDLL desk.cpl,,”, 参数), 假, )


.子程序 _登陆按钮_被单击, 空白型, , 
.如果真 (小于 (.现行选中项, 0))
    信息框 (“请选择用户名。”, #警告图标, )
    返回 ()
.如果真结束

.如果真 (等于 (.内容, “”))
    信息框 (“请输入密码。”, #警告图标, )
    返回 ()
.如果真结束

.如果 (等于 (用户密码是否合法 (), 真))
    赋值 (当前用户, .内容)
    关闭 (“管理员库”)
    载入 (主窗口, , 真)
.否则
    信息框 (“用户名或密码不正确！”, #警告图标, )
    赋值 (.内容, “”)
    返回 ()
.如果结束


.子程序 用户密码是否合法, 逻辑型, , 
.局部变量 是否合法, 逻辑型, , , 

到首记录 ()
.计次循环首 (取记录数 (), 记录数)
    .如果 (并且 (等于 (查找 (等于 (读 (#用户名), .内容)), 真), 等于 (查找 (等于 (读 (#密码), .内容)), 真)))
        赋值 (是否合法, 真)
        跳出循环 ()
    .否则
        赋值 (是否合法, 假)
        跳过 ()
    .如果结束
    
.计次循环尾 ()
.如果 (等于 (是否合法, 真))
    返回 (真)
.否则
    返回 (假)
.如果结束


.窗口程序集 窗口程序集2, , , 

.子程序 _主窗口_创建完毕, 空白型, , 
.局部变量 字段表, 字段信息, , "20", 

未知支持库函数_0 (#蓝色)
_启动窗口.销毁 ()

.如果真 (等于 (文件是否存在 (相加 (取运行目录 (), “\data\贫困生库.edb”)), 假))
    赋值 (字段表 [1].名称, #学生姓名)
    赋值 (字段表 [1].类型, #文本型)
    赋值 (字段表 [1].最大文本长度, 8)
    赋值 (字段表 [2].名称, #性别)
    赋值 (字段表 [2].类型, #文本型)
    赋值 (字段表 [2].最大文本长度, 2)
    赋值 (字段表 [3].名称, #年龄)
    赋值 (字段表 [3].类型, #文本型)
    赋值 (字段表 [3].最大文本长度, 6)
    赋值 (字段表 [4].名称, #民族)
    赋值 (字段表 [4].类型, #文本型)
    赋值 (字段表 [4].最大文本长度, 8)
    赋值 (字段表 [5].名称, #就读学校)
    赋值 (字段表 [5].类型, #文本型)
    赋值 (字段表 [5].最大文本长度, 18)
    赋值 (字段表 [6].名称, #学习阶段)
    赋值 (字段表 [6].类型, #文本型)
    赋值 (字段表 [6].最大文本长度, 8)
    赋值 (字段表 [7].名称, #年级)
    赋值 (字段表 [7].类型, #文本型)
    赋值 (字段表 [7].最大文本长度, 8)
    赋值 (字段表 [8].名称, #班别)
    赋值 (字段表 [8].类型, #文本型)
    赋值 (字段表 [8].最大文本长度, 8)
    赋值 (字段表 [9].名称, #父亲姓名)
    赋值 (字段表 [9].类型, #文本型)
    赋值 (字段表 [9].最大文本长度, 8)
    赋值 (字段表 [10].名称, #父亲工作单位)
    赋值 (字段表 [10].类型, #文本型)
    赋值 (字段表 [10].最大文本长度, 20)
    赋值 (字段表 [11].名称, #母亲姓名)
    赋值 (字段表 [11].类型, #文本型)
    赋值 (字段表 [11].最大文本长度, 8)
    赋值 (字段表 [12].名称, #母亲工作单位)
    赋值 (字段表 [12].类型, #文本型)
    赋值 (字段表 [12].最大文本长度, 20)
    赋值 (字段表 [13].名称, #其他监护姓名)
    赋值 (字段表 [13].类型, #文本型)
    赋值 (字段表 [13].最大文本长度, 8)
    赋值 (字段表 [14].名称, #其他工作单位)
    赋值 (字段表 [14].类型, #文本型)
    赋值 (字段表 [14].最大文本长度, 20)
    赋值 (字段表 [15].名称, #家庭住址)
    赋值 (字段表 [15].类型, #文本型)
    赋值 (字段表 [15].最大文本长度, 20)
    赋值 (字段表 [16].名称, #贫困类型)
    赋值 (字段表 [16].类型, #文本型)
    赋值 (字段表 [16].最大文本长度, 2)
    赋值 (字段表 [17].名称, #总人口)
    赋值 (字段表 [17].类型, #文本型)
    赋值 (字段表 [17].最大文本长度, 8)
    赋值 (字段表 [18].名称, #收入来源)
    赋值 (字段表 [18].类型, #文本型)
    赋值 (字段表 [18].最大文本长度, 18)
    赋值 (字段表 [19].名称, #年均人收入)
    赋值 (字段表 [19].类型, #文本型)
    赋值 (字段表 [19].最大文本长度, 10)
    赋值 (字段表 [20].名称, #申请补助理由)
    赋值 (字段表 [20].类型, #文本型)
    赋值 (字段表 [20].最大文本长度, 150)
    .如果真 (等于 (创建 (相加 (取运行目录 (), “\data\贫困生库.edb”), 字段表), 假))
        信息框 (相加 (“创建”, #左引号, “贫困生库.edb”, #右引号, “失败！”), #错误图标, “错误”)
        结束 ()
    .如果真结束
    
.如果真结束
.如果真 (等于 (打开 (相加 (取运行目录 (), “\data\贫困生库.edb”), , , , , , ), 假))
    信息框 (相加 (“无法打开”, #左引号, “贫困生库.edb”, #右引号, “！”), #错误图标, “错误”)
    结束 ()
.如果真结束
置当前库 (“贫困生库”)
0.置文本 (相加 (“当前操作员：”, 当前用户))
4.置文本 (到文本 (取日期 (取现行时间 ())))
主窗口.置托盘图标 (#托盘图标, “贫困生管理系统”)
超级列表框显示数据 ()

.子程序 超级列表框显示数据, 空白型, , 
.局部变量 表项索引, 整数型, , , 
.局部变量 项目数, 整数型, , , 

到首记录 ()
全部删除 ()
.计次循环首 (取记录数 (), 项目数)
    赋值 (表项索引, .插入表项 ())
    表项索引.置标题 (0, 读 (#学生姓名))
    表项索引.置标题 (1, 读 (#性别))
    表项索引.置标题 (2, 读 (#年龄))
    表项索引.置标题 (3, 读 (#民族))
    表项索引.置标题 (4, 读 (#就读学校))
    表项索引.置标题 (5, 读 (#学习阶段))
    表项索引.置标题 (6, 读 (#年级))
    表项索引.置标题 (7, 读 (#班别))
    表项索引.置标题 (8, 读 (#父亲姓名))
    表项索引.置标题 (9, 读 (#父亲工作单位))
    表项索引.置标题 (10, 读 (#母亲姓名))
    表项索引.置标题 (11, 读 (#母亲工作单位))
    表项索引.置标题 (12, 读 (#其他监护姓名))
    表项索引.置标题 (13, 读 (#其他工作单位))
    表项索引.置标题 (14, 读 (#家庭住址))
    表项索引.置标题 (15, 读 (#贫困类型))
    表项索引.置标题 (16, 读 (#总人口))
    表项索引.置标题 (17, 读 (#收入来源))
    表项索引.置标题 (18, 读 (#年均人收入))
    表项索引.置标题 (19, 读 (#申请补助理由))
    跳过 ()
.计次循环尾 ()
取列表框记录数 ()
赋值 (.类型, 1)
赋值 (.Internet地址, “http://www.dywt.com.cn/”)
跳转 ()


.子程序 _按钮2_被单击, 空白型, , 
结束 ()

.子程序 _添加记录_被选择, 空白型, , 
载入 (添加记录窗口, , 真)


.子程序 _修改记录_被选择, 空白型, , 
载入 (修改记录窗口, , 真)


.子程序 _删除记录_被选择, 空白型, , 
载入 (修改记录窗口, , 真)


.子程序 _查询记录_被选择, 空白型, , 
载入 (查询窗口, , 真)


.子程序 _申请表预览_被选择, 空白型, , 
载入 (报表窗口, , 真)


.子程序 _贫困生花名册_被选择, 空白型, , 
生成报表 ()
打印预览 ()

.子程序 _备份数据_被选择, 空白型, , 

.如果真 (等于 (文件是否存在 (相加 (取运行目录 (), “\databck\贫困生库.edb”)), 假))
    创建目录 (相加 (取运行目录 (), “\databck”))
.如果真结束
.如果真 (是否已打开 (相加 (取运行目录 (), “\data\贫困生库.edb”)))
    置当前库 (相加 (取运行目录 (), “\data\贫困生库.edb”))
.如果真结束
.如果 (等于 (复制文件 (相加 (取运行目录 (), “\data\贫困生库.edb”), 相加 (取运行目录 (), “\databck\贫困生库.edb”)), 真))
    信息框 (“备份数据库成功”, 0, )
    全部关闭 ()
    打开 (相加 (取运行目录 (), “\data\贫困生库.edb”), , , , , , )
    超级列表框显示数据 ()
    
.否则
    信息框 (“备份数据库失败”, 0, )
.如果结束



.子程序 _恢复数据_被选择, 空白型, , 

.如果 (等于 (信息框 (“恢复数据库将删除现有全部记录,确认真的恢复吗?”, #确认取消钮, ), #确认钮))
    
    替换打开 (相加 (取运行目录 (), “\databck\贫困生库.edb”), , , , , , )
    复制文件 (相加 (取运行目录 (), “\databck\贫困生库.edb”), 相加 (取运行目录 (), “\data\贫困生库.edb”))
    替换打开 (相加 (取运行目录 (), “\data\贫困生库.edb”), , , , , , )
    信息框 (“恢复数据库成功”, 0, )
    超级列表框显示数据 ()
    
.否则
    返回 ()
.如果结束


.子程序 _记事本_被选择, 空白型, , 
运行 (“notepad.exe”, 假, )


.子程序 _计算器_被选择, 空白型, , 
运行 (“calc.exe”, 假, )


.子程序 _注册系统_被选择, 空白型, , 
赋值 (序列号, 取文本注册项 (3, “SOFTWARE\test”, ))
赋值 (验证号, 到文本 (取十六进制文本 (相乘 (到数值 (取硬盘特征字 ()), 9876541))))
.如果 (不等于 (序列号, 验证号))
    .如果 (等于 (信息框 (“您还没有注册，是否现在注册”, 1, ), #确认钮))
        载入 (注册软件窗口, , 真)
    .否则
        销毁 ()
    .如果结束
    
.否则
    信息框 (“软件已注册,谢谢支持”, 0, )
.如果结束


.子程序 _访问主页_被选择, 空白型, , 
赋值 (.类型, 1)
赋值 (.Internet地址, “http://www.dywt.com.cn/”)
跳转 ()


.子程序 _发送邮件_被选择, 空白型, , 
赋值 (.类型, 0)
赋值 (.电子信箱地址, “284319462@qq.com”)
跳转 ()


.子程序 _关于_被选择, 空白型, , 
载入 (帮助窗口, , 真)

.子程序 _主窗口_托盘事件, 空白型, , 
.参数 操作类型, 整数型, , 

.判断开始 (等于 (操作类型, 2)) ' 左键双击
    赋值 (主窗口., 真)
.判断 (等于 (操作类型, 3)) ' 右键单击
    主窗口.弹出托盘菜单 ()
.默认
    
.判断结束


.子程序 _退出程序_被选择, 空白型, , 
结束 ()
关闭 ()


.子程序 _超级列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

载入 (修改记录窗口, , 真)

.子程序 _系统初始化_被选择, 空白型, , 
.如果真 (等于 (信息框 (相加 (“系统初始化将删除”, #左引号, 取当前库 (), #右引号, “所有数据资，确认真的初始化吗？”), #确认取消钮, ), #确认钮))
    清空 ()
    超级列表框显示数据 ()
.如果真结束


.子程序 _用户管理_被选择, 空白型, , 
载入 (用户管理窗口, , 真)


.子程序 _单位设置_被选择, 空白型, , 
载入 (单位设置窗口, , 真)


.子程序 _退出_被选择, 空白型, , 
销毁 ()
关闭 ()

.子程序 取列表框记录数, 空白型, , 
赋值 (.内容, 相加 (“当前列表共”, 到文本 (取表项数 ()), “人 ”))


.子程序 生成报表, 空白型, , 在报表数据源中生成报表数据
.局部变量 行号, 整数型, , , 
.局部变量 开始行号, 整数型, , , 
.局部变量 行数, 整数型, , , 

.如果真 (等于 (是否已打开 (相加 (取运行目录 (), “\data\贫困生库.edb”)), 假))
    打开 (相加 (取运行目录 (), “\data\贫困生库.edb”), , , , , , )
    置当前库 (“贫困生库”)
.如果真结束
.如果真 (等于 (相加 (取运行目录 (), “\data\列表.grd”).从文件读 (), 假))
    信息框 (“打开贫困生列表模板失败!”, 相加 (#确认钮, #错误图标), “错误”)
    返回 ()
.如果真结束
保存更改 () ' 保存当前所作的修改
连续赋值 (相加 (取行数 (), 1), 开始行号, 行号)
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假)) ' 遍历所有记录以将其加入到报表中
    .添加行 ()
    行号.置文本 (1, 读 (“学生姓名”))
    行号.置文本 (2, 读 (“性别”))
    行号.置文本 (3, 读 (“年龄”))
    行号.置文本 (4, 读 (“民族”))
    行号.置文本 (5, 读 (“就读学校”))
    行号.置文本 (6, 读 (“年级”))
    行号.置文本 (7, 读 (“班别”))
    行号.置文本 (8, 读 (“家庭住址”))
    行号.置文本 (9, 读 (“贫困类型”))
    行号.置文本 (10, 读 (“申请补助理由”))
    赋值 (行号, 相加 (行号, 1))
    跳过 ()
.判断循环尾 ()
赋值 (行数, 相加 (相减 (行号, 开始行号), 1))
开始行号.加线条 (1, 行数, 11, 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))
赋值 (.表格线颜色, #黑色)


.子程序 _导入数据_被选择, 空白型, , 
载入 (从Excel导入窗口, , 真)



.子程序 _导出数据_被选择, 空白型, , 
.局部变量 文件名, 文本型, , , 
.局部变量 x, 空白型, , , 
.局部变量 y, 空白型, , , 
.局部变量 文本, 文本型, , , 
.局部变量 z, 空白型, , , 
.局部变量 字段, 文本型, , , 
.局部变量 记录内容, 文本型, , , 
.局部变量 aa, 整数型, , , 
.局部变量 字段1, 文本型, , , 
.局部变量 a, 整数型, , , 

写到文件 (相加 (取运行目录 (), “\data\db.tmp”), #tmp)
赋值 (.类型, 1)
赋值 (.过滤器, “EXCEL文件|*.XLS”)
赋值 (.默认文件后缀, “.xls”)
.如果 (等于 (文件是否存在 (相加 (取运行目录 (), “\execl”)), 真))
    赋值 (.初始目录, 相加 (取运行目录 (), “\execl”))
.否则
    创建目录 (相加 (取运行目录 (), “\execl”))
    赋值 (.初始目录, 相加 (取运行目录 (), “\execl”))
.如果结束

.如果真 (等于 (打开 (), 假))
    返回 ()
.如果真结束
赋值 (文件名, .文件名)
 ' 以下代码取超级列表框列标题
赋值 (字段1, “”)
赋值 (字段, “”)
.计次循环首 (取列数 (), x)
    .判断开始 (不等于 (x, 取列数 ()))
        赋值 (字段, 相加 (字段, “”, 到文本 (相减 (x, 1).取列标题 ()), “,”))
        赋值 (字段1, 相加 (字段1, “”, 到文本 (相减 (x, 1).取列标题 ()), “ varchar (200),”))
    .默认
        赋值 (字段, 相加 (字段, “”, 到文本 (相减 (x, 1).取列标题 ()), “”))
        赋值 (字段1, 相加 (字段1, “”, 到文本 (相减 (x, 1).取列标题 ()), “ varchar (200)”))
    .判断结束
    
.计次循环尾 ()
输出调试文本 (字段1)
输出调试文本 (字段)
相加 (取运行目录 (), “\data\db.tmp”).打开MDB数据库 ()
“drop table tmp”.执行 ()
相加 (“create table tmp (”, 字段1, “)”).执行 ()
赋值 (a, 取启动时间 ())
赋值 (.最大位置, 取表项数 ())
赋值 (.可视, 真)
赋值 (.可视, 真)
赋值 (.背景颜色, #红色)
启动事务 ()
.计次循环首 (取表项数 (), x)
    赋值 (记录内容, “”)
    .计次循环首 (取列数 (), y)
        .判断开始 (不等于 (y, 取列数 ()))
            赋值 (记录内容, 相加 (记录内容, “'”, 到文本 (相减 (x, 1).取标题 (相减 (y, 1))), “',”))
        .默认
            赋值 (记录内容, 相加 (记录内容, “'”, 到文本 (相减 (x, 1).取标题 (相减 (y, 1))), “'”))
        .判断结束
        
    .计次循环尾 ()
    相加 (“insert into tmp (”, 字段, “) values (”, 记录内容, “)”).执行 ()
    赋值 (.位置, x)
    赋值 (.内容, 相加 (“正在导出第”, 到文本 (x), “条记录”))
.计次循环尾 ()
相加 (“SELECT * INTO [Excel 8.0;Database=”, 文件名, “].[Sheet1] FROM tmp”).执行 ()
提交事务 ()
赋值 (.可视, 假)
赋值 (.可视, 假)
信息框 (相加 (“导出EXECL成功,共”, 到文本 (取表项数 ()), “条记录,用时：”, 到文本 (相除 (相减 (取启动时间 (), a), 1000)), “秒”), 0, )


.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.如果真 (等于 (按钮索引, 0))
    _系统初始化_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 2))
    载入 (添加记录窗口, , 真)
.如果真结束
.如果真 (等于 (按钮索引, 3))
    载入 (修改记录窗口, , 真)
.如果真结束
.如果真 (等于 (按钮索引, 4))
    载入 (修改记录窗口, , 真)
.如果真结束
.如果真 (等于 (按钮索引, 5))
    载入 (查询窗口, , 真)
.如果真结束
.如果真 (等于 (按钮索引, 7))
    弹出菜单 ()
.如果真结束
.如果真 (等于 (按钮索引, 9))
    _导出数据_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引, 10))
    载入 (从Excel导入窗口, , 真)
.如果真结束
.如果真 (等于 (按钮索引, 12))
    销毁 ()
    关闭 ()
.如果真结束


.子程序 _打印申请表_被选择, 空白型, , 
载入 (报表窗口, , 真)

.子程序 _打印表格_被选择, 空白型, , 
生成报表 ()
打印预览 ()


.窗口程序集 窗口程序集3, , , 

.子程序 _添加记录窗口_创建完毕, 空白型, , 
赋值 (.数据提供者, “通用提供者1”)
获取焦点 ()
.如果真 (等于 (是否已打开 (相加 (取运行目录 (), “\data\贫困生库.edb”)), 假))
    打开 (相加 (取运行目录 (), “\data\贫困生库.edb”), , , , , , )
.如果真结束


.子程序 _添加按钮_被单击, 空白型, , 
赋值 (.内容, 删全部空 (.内容))
.如果真 (等于 (加入 (), 真))
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
    获取焦点 ()
    主窗口.超级列表框显示数据 ()
.如果真结束


.子程序 加入, 逻辑型, , 加入成功返回真
.局部变量 姓名, 文本型, , , 

赋值 (姓名, 删全部空 (.内容))
.如果真 (等于 (.内容, “”))
    信息框 (“请输入姓名！”, #错误图标, “错误”)
    返回 (假)
.如果真结束
.如果真 (等于 (加记录 (姓名, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容), 假))
    信息框 (“添加记录失败！”, #错误图标, “错误”)
    返回 (假)
.如果真结束
返回 (真)

.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()
关闭 ()

.子程序 _添加记录窗口_将被销毁, 空白型, , 
关闭 ()


.子程序 _修改按钮_被单击, 空白型, , 

.如果 (等于 (修改 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容), 真))
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
    获取焦点 ()
    主窗口.超级列表框显示数据 ()
    信息框 (“修改数据成功”, 0, )
    
.否则
    信息框 (“修改失败”, 0, )
.如果结束



.窗口程序集 窗口程序集4, , , 

.子程序 _注册软件窗口_创建完毕, 空白型, , 
赋值 (.内容, 到文本 (取硬盘特征字 ()))


.子程序 _确认注册_被单击, 空白型, , 

赋值 (验证号, 到文本 (取十六进制文本 (相乘 (到数值 (取硬盘特征字 ()), 987654))))
.如果 (等于 (验证号, .内容))
    .如果 (写注册项 (3, “SOFTWARE\test”, 验证号))
        信息框 (“注册成功，欢迎使用”, 0, )
        销毁 ()
    .否则
        
    .如果结束
    
.否则
    信息框 (“注册码错误”, 0, )
    _启动窗口.销毁 ()
    销毁 ()
.如果结束


.窗口程序集 窗口程序集5, , , 

.程序集变量 变量3, 整数型, , , 
.程序集变量 变量4, 整数型, , , 
.子程序 _查询窗口_创建完毕, 空白型, , 
.局部变量 变量2, 整数型, , , 

.计次循环首 (取字段数 (), 变量2)
    .如果真 (小于 (变量2, 23))
        取字段名 (变量2).加入项目 ()
    .如果真结束
    
.计次循环尾 ()

.子程序 _单项退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _字段名组合框_列表项被选择, 空白型, , 
 ' 以下代码将根据所选字段自动读出相应的值
到首记录 ()
清空 ()
赋值 (变量4, 相加 (.现行选中项, 1))
.计次循环首 (取记录数 (), 变量3)
    .如果 (大于或等于 (变量4, 3))
        跳出循环 ()
    .否则
        读字段 (变量4, ).加入项目 ()
        跳到 (相加 (变量3, 1))
    .如果结束
    
.计次循环尾 ()
.如果真 (等于 (变量4, 3))
    “男”.加入项目 ()
    “女”.加入项目 ()
.如果真结束
清空 ()
.如果 (或者 (等于 (变量4, 10), 等于 (变量4, 11), 等于 (变量4, 16)))
    “等于”.加入项目 ()
    “不等于”.加入项目 ()
    “小于”.加入项目 ()
    “大于”.加入项目 ()
    “小于或等于”.加入项目 ()
    “大于或等于”.加入项目 ()
    “近似于”.加入项目 ()
    赋值 (.可视, 真)
    赋值 (.可视, 假)
.否则
    “等于”.加入项目 ()
    “不等于”.加入项目 ()
    “近似于”.加入项目 ()
    赋值 (.可视, 假)
    赋值 (.可视, 真)
.如果结束


.子程序 _单项查询按钮_被单击, 空白型, , 
单项查询 ()
主窗口.取列表框记录数 ()

.子程序 单项查询, 空白型, , 
.如果 (或者 (等于 (变量4, 10), 等于 (变量4, 11), 等于 (变量4, 16)))
    .如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
        信息框 (“请输入完整查询条件”, 0, )
        返回 ()
    .如果真结束
    
.否则
    .如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”))) ' 或 字段值组合框.内容 ＝ “”)
        信息框 (“请输入完整查询条件”, 0, )
        返回 ()
    .如果真结束
    
.如果结束
到首记录 ()
主窗口.全部删除 (.)
.计次循环首 (取记录数 (), 变量3)
    .如果 (或者 (等于 (变量4, 10), 等于 (变量4, 11), 等于 (变量4, 16)))
        .如果真 (等于 (.取项目文本 (.现行选中项), “等于”))
            .如果真 (等于 (查找 (等于 (取日期 (读字段 (相加 (.现行选中项, 1), )), 取日期 (.今天))), 真))
                超级列表显示查询结果 ()
            .如果真结束
            跳到 (相加 (变量3, 1))
        .如果真结束
        .如果真 (等于 (.取项目文本 (.现行选中项), “不等于”))
            .如果真 (等于 (查找 (不等于 (取日期 (读字段 (相加 (.现行选中项, 1), )), 取日期 (.今天))), 真))
                超级列表显示查询结果 ()
            .如果真结束
            跳到 (相加 (变量3, 1))
        .如果真结束
        .如果真 (等于 (.取项目文本 (.现行选中项), “小于”))
            .如果真 (等于 (查找 (小于 (取日期 (读字段 (相加 (.现行选中项, 1), )), 取日期 (.今天))), 真))
                超级列表显示查询结果 ()
            .如果真结束
            跳到 (相加 (变量3, 1))
        .如果真结束
        .如果真 (等于 (.取项目文本 (.现行选中项), “大于”))
            .如果真 (等于 (查找 (大于 (取日期 (读字段 (相加 (.现行选中项, 1), )), 取日期 (.今天))), 真))
                超级列表显示查询结果 ()
            .如果真结束
            跳到 (相加 (变量3, 1))
        .如果真结束
        .如果真 (等于 (.取项目文本 (.现行选中项), “小于或等于”))
            .如果真 (等于 (查找 (小于或等于 (取日期 (读字段 (相加 (.现行选中项, 1), )), 取日期 (.今天))), 真))
                超级列表显示查询结果 ()
            .如果真结束
            跳到 (相加 (变量3, 1))
        .如果真结束
        .如果真 (等于 (.取项目文本 (.现行选中项), “大于或等于”))
            .如果真 (等于 (查找 (大于或等于 (取日期 (读字段 (相加 (.现行选中项, 1), )), 取日期 (.今天))), 真))
                超级列表显示查询结果 ()
            .如果真结束
            跳到 (相加 (变量3, 1))
        .如果真结束
        .如果真 (等于 (.取项目文本 (.现行选中项), “近似于”))
            .如果真 (等于 (查找 (近似等于 (到文本 (取日期 (读字段 (相加 (.现行选中项, 1), ))), 到文本 (取日期 (.今天)))), 真))
                超级列表显示查询结果 ()
            .如果真结束
            跳到 (相加 (变量3, 1))
        .如果真结束
        
    .否则
        .如果真 (等于 (.取项目文本 (.现行选中项), “等于”))
            .如果真 (等于 (查找 (等于 (读字段 (相加 (.现行选中项, 1), ), .内容)), 真))
                超级列表显示查询结果 ()
            .如果真结束
            跳到 (相加 (变量3, 1))
        .如果真结束
        .如果真 (等于 (.取项目文本 (.现行选中项), “不等于”))
            .如果真 (等于 (查找 (不等于 (读字段 (相加 (.现行选中项, 1), ), .内容)), 真))
                超级列表显示查询结果 ()
            .如果真结束
            跳到 (相加 (变量3, 1))
        .如果真结束
        .如果真 (等于 (.取项目文本 (.现行选中项), “小于”))
            .如果真 (等于 (查找 (小于 (读字段 (相加 (.现行选中项, 1), ), .内容)), 真))
                超级列表显示查询结果 ()
            .如果真结束
            跳到 (相加 (变量3, 1))
        .如果真结束
        .如果真 (等于 (.取项目文本 (.现行选中项), “大于”))
            .如果真 (等于 (查找 (大于 (读字段 (相加 (.现行选中项, 1), ), .内容)), 真))
                超级列表显示查询结果 ()
            .如果真结束
            跳到 (相加 (变量3, 1))
        .如果真结束
        .如果真 (等于 (.取项目文本 (.现行选中项), “小于或等于”))
            .如果真 (等于 (查找 (小于或等于 (读字段 (相加 (.现行选中项, 1), ), .内容)), 真))
                超级列表显示查询结果 ()
            .如果真结束
            跳到 (相加 (变量3, 1))
        .如果真结束
        .如果真 (等于 (.取项目文本 (.现行选中项), “大于或等于”))
            .如果真 (等于 (查找 (大于或等于 (读字段 (相加 (.现行选中项, 1), ), .内容)), 真))
                超级列表显示查询结果 ()
            .如果真结束
            跳到 (相加 (变量3, 1))
        .如果真结束
        .如果真 (等于 (.取项目文本 (.现行选中项), “近似于”))
            .如果真 (等于 (查找 (近似等于 (读字段 (相加 (.现行选中项, 1), ), .内容)), 真))
                超级列表显示查询结果 ()
            .如果真结束
            跳到 (相加 (变量3, 1))
        .如果真结束
        
    .如果结束
    
.计次循环尾 ()
销毁 ()


.子程序 超级列表显示查询结果, 空白型, , 
.局部变量 表项索引, 整数型, , , 

赋值 (表项索引, 主窗口.插入表项 (., , , , , , ))
主窗口.置标题 (., 表项索引, 0, 到文本 (读 (#学生姓名)))
主窗口.置标题 (., 表项索引, 0, 读 (#学生姓名))
主窗口.置标题 (., 表项索引, 1, 读 (#性别))
主窗口.置标题 (., 表项索引, 2, 读 (#年龄))
主窗口.置标题 (., 表项索引, 3, 读 (#民族))
主窗口.置标题 (., 表项索引, 4, 读 (#就读学校))
主窗口.置标题 (., 表项索引, 5, 读 (#学习阶段))
主窗口.置标题 (., 表项索引, 6, 读 (#年级))
主窗口.置标题 (., 表项索引, 7, 读 (#班别))
主窗口.置标题 (., 表项索引, 8, 读 (#父亲姓名))
主窗口.置标题 (., 表项索引, 9, 读 (#父亲工作单位))
主窗口.置标题 (., 表项索引, 10, 读 (#母亲姓名))
主窗口.置标题 (., 表项索引, 11, 读 (#母亲工作单位))
主窗口.置标题 (., 表项索引, 12, 读 (#其他监护姓名))
主窗口.置标题 (., 表项索引, 13, 读 (#其他工作单位))
主窗口.置标题 (., 表项索引, 14, 读 (#家庭住址))
主窗口.置标题 (., 表项索引, 15, 读 (#贫困类型))
主窗口.置标题 (., 表项索引, 16, 读 (#总人口))
主窗口.置标题 (., 表项索引, 17, 读 (#收入来源))
主窗口.置标题 (., 表项索引, 18, 读 (#年均人收入))
主窗口.置标题 (., 表项索引, 19, 读 (#申请补助理由))
 ' 跳过 ()

赋值 (主窗口.., 相减 (取记录数 (), 1))

.窗口程序集 窗口程序集6, , , 

.子程序 _报表窗口_创建完毕, 空白型, , 
赋值 (.数据提供者, “通用提供者1”)
.如果真 (等于 (是否已打开 (相加 (取运行目录 (), “\data\贫困生库.edb”)), 假))
    打开 (相加 (取运行目录 (), “\data\贫困生库.edb”), , , , , , )
    置当前库 (“贫困生库”)
.如果真结束
.如果真 (等于 (相加 (取运行目录 (), “\data\报表.grd”).从文件读 (), 假)) ' 从文件读入表格样板到基本情况提供者
    信息框 (“找不到报表模板!”, 0, “错误”)
    销毁 ()
    返回 ()
.如果真结束

赋值 (.表格线颜色, #黑色)
2.置文本 (7, 相加 (“填表时间：”, 到文本 (取日期 (取现行时间 ()))))

_数据源1_当前记录改变 ()

.子程序 _数据源1_当前记录改变, 空白型, , 
3.置文本 (2, 读 (#学生姓名))
3.置文本 (5, 读 (#性别))
3.置文本 (7, 读 (#年龄))
3.置文本 (9, 读 (#民族))
4.置文本 (2, 读 (#就读学校))
4.置文本 (5, 读 (#学习阶段))
4.置文本 (7, 读 (#年级))
4.置文本 (9, 读 (#班别))
5.置文本 (3, 读 (#父亲姓名))
5.置文本 (6, 读 (#父亲工作单位))
6.置文本 (3, 读 (#母亲姓名))
6.置文本 (6, 读 (#母亲工作单位))
7.置文本 (3, 读 (#其他监护姓名))
7.置文本 (6, 读 (#其他工作单位))
8.置文本 (2, 读 (#家庭住址))
8.置文本 (9, 读 (#贫困类型))
9.置文本 (3, 读 (#总人口))
9.置文本 (5, 读 (#收入来源))
9.置文本 (9, 读 (#年均人收入))
10.置文本 (2, 读 (#申请补助理由))




.子程序 _组合框1_列表项被选择, 空白型, , 
.局部变量 变量8, 空白型, , , 

清空 ()
到首记录 ()
.如果真 (等于 (.取项目文本 (.现行选中项), “学生姓名”))
    .计次循环首 (取记录数 (), 变量8)
        读 (#学生姓名).加入项目 ()
        跳到 (相加 (变量8, 1))
    .计次循环尾 ()
.如果真结束


.子程序 _跳到按钮_被单击, 空白型, , 
.局部变量 记录数, 空白型, , , 
.局部变量 记录指针, 空白型, , , 

.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“请输入完整条件”, 0, )
    返回 ()
.如果真结束
到首记录 ()
.计次循环首 (取记录数 (), 记录数)
    .如果真 (等于 (.取项目文本 (.现行选中项), “学生姓名”))
        .如果真 (等于 (查找 (等于 (读 (#学生姓名), .内容)), 真))
            赋值 (记录指针, 取记录号 ())
            跳出循环 ()
        .如果真结束
        跳过 ()
    .如果真结束
    
.计次循环尾 ()
跳到 (记录指针)
_数据源1_当前记录改变 ()

.子程序 _上一条按钮_被单击, 空白型, , 
.如果 (等于 (取记录号 (), 1))
    信息框 (“前面已没有记录”, 0, )
    返回 ()
.否则
    跳到 (相减 (取记录号 (), 1))
    _数据源1_当前记录改变 ()
.如果结束


.子程序 _下一条按钮_被单击, 空白型, , 
.如果 (等于 (取记录号 (), 取记录数 ()))
    信息框 (“后面已没有记录”, 0, )
    返回 ()
.否则
    跳到 (相加 (取记录号 (), 1))
    _数据源1_当前记录改变 ()
.如果结束


.子程序 _首记录按钮_被单击, 空白型, , 
到首记录 ()
_数据源1_当前记录改变 ()

.子程序 _尾记录按钮_被单击, 空白型, , 
到尾记录 ()
_数据源1_当前记录改变 ()


.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()



.子程序 _打印当前按钮_被单击, 空白型, , 
赋值 (序列号, 取文本注册项 (3, “SOFTWARE\test”, ))
赋值 (验证号, 到文本 (取十六进制文本 (相乘 (到数值 (取硬盘特征字 ()), 987654))))
.如果 (不等于 (序列号, 验证号))
    信息框 (“注册系统后开放打印功能”, 0, )
.否则
    .如果真 (打印设置 ())
        打印预览 ()
    .如果真结束
    
.如果结束


.子程序 _打印当所有按钮_被单击, 空白型, , 
.局部变量 打印设置, 打印设置信息, , , 
.局部变量 列数, 整数型, , , 
.局部变量 容器1, 整数型, , , 

赋值 (序列号, 取文本注册项 (3, “SOFTWARE\test”, ))
赋值 (验证号, 到文本 (取十六进制文本 (相乘 (到数值 (取硬盘特征字 ()), 987654))))
.如果 (不等于 (序列号, 验证号))
    信息框 (“注册系统后开放打印功能”, 0, )
.否则
    .如果真 (等于 (相加 (取运行目录 (), “\data\报表.grd”).从文件读 (), 假)) ' 从文件读入表格样板
        信息框 (“找不到贫困生报表表格模板!”, 0, “错误”)
        返回 ()
    .如果真结束
    
.如果结束
 ' 下面设置打印时的每页打印行数,以强制每个学生打印一页.
赋值 (打印设置, 取打印设置 ())
赋值 (打印设置.每页打印行数, 取行数 ())
打印设置.置打印设置 ()

.判断循环首 (等于 (尾记录后 (), 假))
    填充 ()
    .添加 ()
    跳过 ()
.判断循环尾 ()


打印预览 ()


.子程序 填充, 空白型, , 

3.置文本 (2, 读 (#学生姓名))
3.置文本 (5, 读 (#性别))
3.置文本 (7, 读 (#年龄))
3.置文本 (9, 读 (#民族))
4.置文本 (2, 读 (#就读学校))
4.置文本 (5, 读 (#学习阶段))
4.置文本 (7, 读 (#年级))
4.置文本 (9, 读 (#班别))
5.置文本 (3, 读 (#父亲姓名))
5.置文本 (6, 读 (#父亲工作单位))
6.置文本 (3, 读 (#母亲姓名))
6.置文本 (6, 读 (#母亲工作单位))
7.置文本 (3, 读 (#其他监护姓名))
7.置文本 (6, 读 (#其他工作单位))
8.置文本 (2, 读 (#家庭住址))
8.置文本 (9, 读 (#贫困类型))
9.置文本 (3, 读 (#总人口))
9.置文本 (5, 读 (#收入来源))
9.置文本 (9, 读 (#年均人收入))
10.置文本 (2, 读 (#申请补助理由))




.子程序 _按钮空表按钮_被单击, 空白型, , 
.如果真 (打印设置 ())
    打印预览 ()
.如果真结束


.子程序 _报表窗口_将被销毁, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集8, , , 

.子程序 _系统设置窗口_创建完毕, 空白型, , 


.子程序 _添加按钮_被单击, 空白型, , 

.如果真 (等于 (.内容, “”))
    信息框 (“用户名不能为空！”, #警告图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“密码不能为空！”, #警告图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请确认密码！”, #警告图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (不等于 (.内容, .内容))
    信息框 (“两次输入密码不一致，请重新输入！”, 0, )
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (用户名是否重复 (), 真))
    信息框 (“用户名重复！”, #警告图标, )
    赋值 (.内容, “”)
    获取焦点 ()
    返回 ()
.如果真结束


.窗口程序集 窗口程序集7, , , 

.程序集变量 用户名组, 文本型, , "0", 
.程序集变量 密码组, 文本型, , "0", 
.程序集变量 记录数, 空白型, , , 
.程序集变量 用户是否重复, 逻辑型, , , 
.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

.子程序 _用户管理窗口_创建完毕, 空白型, , 
打开 (相加 (取运行目录 (), “\data\管理员库.edb”), “管理员库”, , , , , )
置当前库 (“管理员库”)
置列表框和数组 ()

.子程序 _列表框1_列表项被选择, 空白型, , 
赋值 (.内容, 用户名组 [相加 (.现行选中项, 1)])
赋值 (.内容, 密码组 [相加 (.现行选中项, 1)])
赋值 (.内容, 密码组 [相加 (.现行选中项, 1)])
打开 (相加 (取运行目录 (), “\data\管理员库.edb”), “管理员库”, , , , , )
置当前库 (“管理员库”)
跳到 (相加 (.现行选中项, 1))
.如果 (等于 (取文本中间 (读 (#权限), 1, 1), “1”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束

.如果 (等于 (取文本中间 (读 (#权限), 2, 1), “1”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束

.如果 (等于 (取文本中间 (读 (#权限), 3, 1), “1”))
    赋值 (.选中, 真)
.否则
    赋值 (.选中, 假)
.如果结束


.子程序 _添加按钮_被单击, 空白型, , 

.如果真 (等于 (.内容, “”))
    信息框 (“用户名不能为空！”, #警告图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“密码不能为空！”, #警告图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请确认密码！”, #警告图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (不等于 (.内容, .内容))
    信息框 (“两次输入密码不一致，请重新输入！”, 0, )
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (用户名是否重复 (), 真))
    信息框 (“用户名重复！”, #警告图标, )
    赋值 (.内容, “”)
    获取焦点 ()
    返回 ()
.如果真结束

.如果 (等于 (.选中, 真))
    赋值 (用户管理权, “1”)
.否则
    赋值 (用户管理权, “0”)
.如果结束

.如果 (等于 (.选中, 真))
    赋值 (系统初始化权, “1”)
.否则
    赋值 (系统初始化权, “0”)
.如果结束

.如果 (等于 (.选中, 真))
    赋值 (数据库权, “1”)
.否则
    赋值 (数据库权, “0”)
.如果结束


.如果 (加记录 (.内容, .内容, 相加 (用户管理权, 系统初始化权, 数据库权)))
    信息框 (“添加用户成功”, 0, )
    .加入项目 (.内容, )
    加入成员 (用户名组, .内容)
    加入成员 (密码组, .内容)
    清空编辑框 ()
.否则
    信息框 (相加 (“添加用户失败,原因是”, 取错误信息 ()), #错误图标, )
.如果结束


.子程序 清空编辑框, 空白型, , 
连续赋值 (“”, .内容, .内容, .内容)

.子程序 用户名是否重复, 逻辑型, , 
到首记录 ()
.计次循环首 (取记录数 (), 记录数)
    .如果 (等于 (查找 (等于 (删首尾空 (读 (#用户名)), 删首尾空 (.内容))), 真))
        赋值 (用户是否重复, 真)
        跳出循环 ()
    .否则
        赋值 (用户是否重复, 假)
        跳过 ()
    .如果结束
    
.计次循环尾 ()
.如果 (等于 (用户是否重复, 真))
    返回 (真)
.否则
    返回 (假)
.如果结束



.子程序 修改用户名是否重复, 逻辑型, , 
到首记录 ()
.计次循环首 (取记录数 (), 记录数)
    .如果 (并且 (等于 (查找 (等于 (删首尾空 (读 (#用户名)), 删首尾空 (.内容))), 真), 不等于 (相加 (.现行选中项, 1), 取记录号 ())))
        赋值 (用户是否重复, 真)
        跳出循环 ()
    .否则
        赋值 (用户是否重复, 假)
        跳过 ()
    .如果结束
    
.计次循环尾 ()
.如果 (等于 (用户是否重复, 真))
    返回 (真)
.否则
    返回 (假)
.如果结束



.子程序 _修改按钮_被单击, 空白型, , 
.如果真 (等于 (.内容, “”))
    信息框 (“用户名不能为空！”, #警告图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“密码不能为空！”, #警告图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请确认密码！”, #警告图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (不等于 (.内容, .内容))
    信息框 (“两次输入密码不一致，请重新输入！”, 0, )
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (修改用户名是否重复 (), 真))
    信息框 (“用户名重复！”, #警告图标, )
    赋值 (.内容, “”)
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (并且 (等于 (.取项目文本 (.现行选中项), “管理员”), 不等于 (.内容, “管理员”)))
    信息框 (“超级管理员只可以改密码,不能改名称”, 0, )
    赋值 (.内容, “管理员”)
    返回 ()
    
.如果真结束


.如果 (等于 (.选中, 真))
    赋值 (用户管理权, “1”)
.否则
    赋值 (用户管理权, “0”)
.如果结束

.如果 (等于 (.选中, 真))
    赋值 (系统初始化权, “1”)
.否则
    赋值 (系统初始化权, “0”)
.如果结束

.如果 (等于 (.选中, 真))
    赋值 (数据库权, “1”)
.否则
    赋值 (数据库权, “0”)
.如果结束

跳到 (相加 (.现行选中项, 1))
.如果 (修改 (.内容, .内容, 相加 (用户管理权, 系统初始化权, 数据库权)))
    信息框 (“修改成功”, 0, )
.否则
    信息框 (相加 (“添加用户失败,原因是”, 取错误信息 ()), #错误图标, )
.如果结束

清空编辑框 ()
置列表框和数组 ()


.子程序 _删除按钮_被单击, 空白型, , 
.如果真 (小于 (相加 (.现行选中项, 1), 0))
    信息框 (“请选中删除用户。”, 0, )
    返回 ()
.如果真结束
.如果 (等于 (.取项目文本 (.现行选中项), “管理员”))
    信息框 (“不能删除超级管理员”, 0, )
    返回 ()
.否则
    
.如果结束
.如果 (等于 (信息框 (“确认真的删除此用户吗？”, #确认取消钮, ), #确认钮))
    跳到 (相加 (.现行选中项, 1))
    删除 ()
    彻底删除 ()
    清空编辑框 ()
    清选择框 ()
    置列表框和数组 ()
.否则
    返回 ()
.如果结束



.子程序 置列表框和数组, 空白型, , 
清空 ()
删除成员 (用户名组, 1, 取数组成员数 (用户名组))
删除成员 (密码组, 1, 取数组成员数 (密码组))

到首记录 ()
.计次循环首 (取记录数 (), 记录数)
    读 (#用户名).加入项目 ()
    加入成员 (用户名组, 读 (#用户名))
    加入成员 (密码组, 读 (#密码))
    跳过 ()
.计次循环尾 ()


.子程序 _用户管理窗口_将被销毁, 空白型, , 
置当前库 (相加 (取运行目录 (), “\data\代表资源库.edb”))
到首记录 ()

.子程序 清选择框, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 假)

.窗口程序集 窗口程序集9, , , 

.程序集变量 字段表, 字段信息, , "3", 
.子程序 _单位设置窗口_创建完毕, 空白型, , 
赋值 (.数据库文件名, 相加 (取运行目录 (), “\data\单位设置库.edb”))

.如果真 (等于 (文件是否存在 (相加 (取运行目录 (), “\data\单位设置库.edb”)), 假))
    赋值 (字段表 [1].名称, #区县)
    赋值 (字段表 [1].类型, #文本型)
    赋值 (字段表 [1].最大文本长度, 20)
    赋值 (字段表 [2].名称, #主管部门)
    赋值 (字段表 [2].类型, #文本型)
    赋值 (字段表 [2].最大文本长度, 20)
    赋值 (字段表 [3].名称, #学校)
    赋值 (字段表 [3].类型, #文本型)
    赋值 (字段表 [3].最大文本长度, 20)
    .如果真 (等于 (创建 (相加 (取运行目录 (), “\data\单位设置库.edb”), 字段表), 假))
        信息框 (相加 (“创建”, #左引号, “单位设置库.edb”, #右引号, “失败！”), #错误图标, “错误”)
        结束 ()
    .如果真结束
    
.如果真结束
.如果真 (等于 (打开 (相加 (取运行目录 (), “\data\单位设置库.edb”), , , , , , ), 假))
    信息框 (相加 (“无法打开”, #左引号, “单位设置库.edb”, #右引号, “！”), #错误图标, “错误”)
    结束 ()
.如果真结束


.子程序 _确定按钮_被单击, 空白型, , 
.如果 (等于 (加记录 (.内容, .内容, .内容), 假))
    信息框 (“添加记录失败”, 0, )
.否则
    信息框 (“添加记录成功”, 0, )
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
.如果真 (等于 (修改 (.内容, .内容, .内容), 假))
    信息框 (“修改记录失败”, 0, )
    
.如果真结束


.子程序 _按钮3_被单击, 空白型, , 
销毁 ()
关闭 ()


.子程序 _单位设置窗口_将被销毁, 空白型, , 
关闭 ()


.窗口程序集 窗口程序集10, , , 

.程序集变量 列, 整数型, , , 
.程序集变量 行, 整数型, , , 
.子程序 _按钮1_被单击, 空白型, , 
.如果真 (打开 ())
    赋值 (.内容, .文件名)
.如果真结束


.子程序 _按钮3_被单击, 空白型, , 
.如果真 (打开 ())
    赋值 (.内容, .文件名)
.如果真结束


.子程序 _按钮2_被单击, 空白型, , 
.局部变量 范围, 对象, , , 
.局部变量 行对象, 对象, , , 
.局部变量 列对象, 对象, , , 
.局部变量 单元格对象, 对象, , , 
.局部变量 工作簿对象, 对象, , , 
.局部变量 i, 整数型, , , 

.如果真 (等于 (未知支持库函数_0 (), 假))
    信息框 (“你的计算机上没有EXCEL程序”, 0, )
    结束 ()
.如果真结束
赋值 (.禁止, 真)
赋值 (., 假)
.未知支持库函数_6 ()


.未知支持库函数_14 (.内容)
未知支持库函数_20 ()
未知支持库函数_19 ()
赋值 (., 1) ' 此处可以指定工作簿
赋值 (工作簿对象, 未知支持库函数_12 ())

清空 ()

赋值 (范围, 工作簿对象.读对象型属性 (“UsedRange”, ))
赋值 (行对象, 范围.读对象型属性 (“Rows”, ))
赋值 (行, 行对象.读数值属性 (“Count”, ))
赋值 (列对象, 范围.读对象型属性 (“Columns”, ))
赋值 (列, 列对象.读数值属性 (“Count”, ))
输出调试文本 (到文本 (行))
输出调试文本 (到文本 (列))

.计次循环首 (列, i)
    赋值 (., 相加 (转换字母 (i), “1”))
    赋值 (., 相加 (转换字母 (i), “1”))
    赋值 (单元格对象, 未知支持库函数_13 ())
    单元格对象.读文本属性 (“Value”, ).加入项目 (i)
.计次循环尾 ()

未知支持库函数_15 ()
未知支持库函数_7 ()
赋值 (.禁止, 假)

.子程序 转换字母, 文本型, , 
.参数 数值, 整数型, , 

.局部变量 字母, 文本型, , , 

.如果真 (等于 (数值, 1))
    赋值 (字母, “a”)
.如果真结束
.如果真 (等于 (数值, 2))
    赋值 (字母, “b”)
.如果真结束
.如果真 (等于 (数值, 3))
    赋值 (字母, “c”)
.如果真结束
.如果真 (等于 (数值, 4))
    赋值 (字母, “d”)
.如果真结束
.如果真 (等于 (数值, 5))
    赋值 (字母, “e”)
.如果真结束
.如果真 (等于 (数值, 6))
    赋值 (字母, “f”)
.如果真结束
.如果真 (等于 (数值, 7))
    赋值 (字母, “g”)
.如果真结束
.如果真 (等于 (数值, 8))
    赋值 (字母, “h”)
.如果真结束
.如果真 (等于 (数值, 9))
    赋值 (字母, “i”)
.如果真结束
.如果真 (等于 (数值, 10))
    赋值 (字母, “j”)
.如果真结束
.如果真 (等于 (数值, 11))
    赋值 (字母, “k”)
.如果真结束
.如果真 (等于 (数值, 12))
    赋值 (字母, “l”)
.如果真结束
.如果真 (等于 (数值, 13))
    赋值 (字母, “m”)
.如果真结束
.如果真 (等于 (数值, 14))
    赋值 (字母, “n”)
.如果真结束
.如果真 (等于 (数值, 15))
    赋值 (字母, “o”)
.如果真结束
.如果真 (等于 (数值, 16))
    赋值 (字母, “p”)
.如果真结束
.如果真 (等于 (数值, 17))
    赋值 (字母, “q”)
.如果真结束
.如果真 (等于 (数值, 18))
    赋值 (字母, “r”)
.如果真结束
.如果真 (等于 (数值, 19))
    赋值 (字母, “s”)
.如果真结束
.如果真 (等于 (数值, 20))
    赋值 (字母, “t”)
.如果真结束
.如果真 (等于 (数值, 21))
    赋值 (字母, “u”)
.如果真结束
.如果真 (等于 (数值, 22))
    赋值 (字母, “v”)
.如果真结束
.如果真 (等于 (数值, 23))
    赋值 (字母, “w”)
.如果真结束
.如果真 (等于 (数值, 24))
    赋值 (字母, “x”)
.如果真结束
.如果真 (等于 (数值, 25))
    赋值 (字母, “y”)
.如果真结束
.如果真 (等于 (数值, 26))
    赋值 (字母, “z”)
.如果真结束
.如果真 (等于 (数值, 27))
    赋值 (字母, “aa”)
.如果真结束
.如果真 (等于 (数值, 28))
    赋值 (字母, “ab”)
.如果真结束
.如果真 (等于 (数值, 29))
    赋值 (字母, “ac”)
.如果真结束
.如果真 (等于 (数值, 30))
    赋值 (字母, “ad”)
.如果真结束
.如果真 (等于 (数值, 31))
    赋值 (字母, “ae”)
.如果真结束
.如果真 (等于 (数值, 32))
    赋值 (字母, “af”)
.如果真结束
.如果真 (等于 (数值, 33))
    赋值 (字母, “ag”)
.如果真结束
.如果真 (等于 (数值, 34))
    赋值 (字母, “ah”)
.如果真结束
.如果真 (等于 (数值, 35))
    赋值 (字母, “ai”)
.如果真结束
.如果真 (等于 (数值, 36))
    赋值 (字母, “aj”)
.如果真结束
.如果真 (等于 (数值, 37))
    赋值 (字母, “ak”)
.如果真结束
.如果真 (等于 (数值, 38))
    赋值 (字母, “al”)
.如果真结束
.如果真 (等于 (数值, 39))
    赋值 (字母, “am”)
.如果真结束
.如果真 (等于 (数值, 40))
    赋值 (字母, “an”)
.如果真结束
.如果真 (等于 (数值, 41))
    赋值 (字母, “ao”)
.如果真结束
.如果真 (等于 (数值, 42))
    赋值 (字母, “ap”)
.如果真结束
.如果真 (等于 (数值, 43))
    赋值 (字母, “aq”)
.如果真结束
.如果真 (等于 (数值, 44))
    赋值 (字母, “ar”)
.如果真结束
.如果真 (等于 (数值, 45))
    赋值 (字母, “as”)
.如果真结束
.如果真 (等于 (数值, 46))
    赋值 (字母, “at”)
.如果真结束
.如果真 (等于 (数值, 47))
    赋值 (字母, “au”)
.如果真结束
.如果真 (等于 (数值, 48))
    赋值 (字母, “av”)
.如果真结束
.如果真 (等于 (数值, 49))
    赋值 (字母, “aw”)
.如果真结束
.如果真 (等于 (数值, 50))
    赋值 (字母, “ax”)
.如果真结束
.如果真 (等于 (数值, 51))
    赋值 (字母, “ay”)
.如果真结束
.如果真 (等于 (数值, 52))
    赋值 (字母, “az”)
.如果真结束
.如果真 (等于 (数值, 53))
    赋值 (字母, “ba”)
.如果真结束
.如果真 (等于 (数值, 54))
    赋值 (字母, “bb”)
.如果真结束
.如果真 (等于 (数值, 55))
    赋值 (字母, “bc”)
.如果真结束
.如果真 (等于 (数值, 56))
    赋值 (字母, “bd”)
.如果真结束
.如果真 (等于 (数值, 57))
    赋值 (字母, “be”)
.如果真结束
.如果真 (等于 (数值, 58))
    赋值 (字母, “bf”)
.如果真结束
.如果真 (等于 (数值, 59))
    赋值 (字母, “bg”)
.如果真结束
.如果真 (等于 (数值, 60))
    赋值 (字母, “bh”)
.如果真结束
返回 (字母)

.子程序 __启动窗口_创建完毕, 空白型, , 


.子程序 _按钮4_被单击, 空白型, , 
.局部变量 字段信息, 字段信息, , "0", 
.局部变量 记录集句柄, 整数型, , , 
.局部变量 临时字段信息, 字段信息, , , 
.局部变量 i, 整数型, , , 
.局部变量 单元, 文本型, , , 

赋值 (.禁止, 真)
.计次循环首 (取项目数 (), i)
    .如果真 (相减 (i, 1).是否被选中 ())
        赋值 (临时字段信息.名称, 相减 (i, 1).取项目文本 ())
        赋值 (临时字段信息.类型, #文本型)
        赋值 (临时字段信息.最大文本长度, 20)
        加入成员 (字段信息, 临时字段信息)
    .如果真结束
    
.计次循环尾 ()
检查 (创建 (.内容, 字段信息))

.如果 (相加 (“ODBC;DBQ=”, .内容, “;Driver={Microsoft Excel Driver (*.xls)}; ”).打开 ())
    赋值 (记录集句柄, “select * from [sheet1$]”.查询 ()) ' 此处指定表名
    .如果 (不等于 (记录集句柄, 0))
        记录集句柄.到首记录 ()
        打开 (.内容, “edb”, , , , , )
        .判断循环首 (等于 (记录集句柄.尾记录后 (), 假))
            加记录 ()
            .计次循环首 (取项目数 (), i)
                .如果真 (相减 (i, 1).是否被选中 ())
                    赋值 (单元, 到文本 (记录集句柄.读 (i)))
                    写 (相减 (i, 1).取项目文本 (), 单元)
                .如果真结束
                
            .计次循环尾 ()
            
            记录集句柄.到后一记录 ()
        .判断循环尾 ()
    .否则
        
    .如果结束
    
.否则
    信息框 (“连接失败”, 0, )
.如果结束
关闭 (“edb”)
记录集句柄.关闭记录集 ()
关闭 ()
赋值 (.禁止, 假)
信息框 (“转换成功！”, #信息图标, )

.子程序 _按钮5_被单击, 空白型, , 
.局部变量 i, 整数型, , , 

.计次循环首 (取项目数 (), i)
    .如果真 (等于 (相减 (i, 1).是否被选中 (), 假))
        相减 (i, 1).选中项目 (真)
    .如果真结束
    
.计次循环尾 ()



.子程序 _按钮6_被单击, 空白型, , 
.局部变量 i, 整数型, , , 

.计次循环首 (取项目数 (), i)
    .如果真 (等于 (相减 (i, 1).是否被选中 (), 真))
        相减 (i, 1).选中项目 (假)
    .如果真结束
    
.计次循环尾 ()


.子程序 _按钮7_被单击, 空白型, , 
.局部变量 i, 整数型, , , 

.计次循环首 (取项目数 (), i)
    相减 (i, 1).选中项目 (取反 (相减 (i, 1).是否被选中 ()))
.计次循环尾 ()


.子程序 __启动窗口_将被销毁, 空白型, , 
销毁 ()


.窗口程序集 窗口程序集11, , , 

.子程序 _修改记录窗口_创建完毕, 空白型, , 
.如果真 (等于 (是否已打开 (相加 (取运行目录 (), “\data\贫困生库.edb”)), 假))
    打开 (相加 (取运行目录 (), “\data\贫困生库.edb”), , , , , , )
.如果真结束
置当前库 (#贫困生库)
到首记录 ()
显示记录 ()
获取焦点 ()


.子程序 _查询按钮_被单击, 空白型, , 
.局部变量 欲寻找姓名, 文本型, , , 

赋值 (欲寻找姓名, .内容)
赋值 (.内容, 删全部空 (.内容))
.如果真 (等于 (.内容, “”))
    信息框 (“请输入要查找的学生姓名”, 0, )
.如果真结束
.如果真 (等于 (查找 (发音比较 (欲寻找姓名, 删全部空 (读 (#学生姓名)), 真, 真)), 假))
    信息框 (“未找到指定学生姓名！”, #信息图标, )
.如果真结束
显示记录 ()
赋值 (.内容, “”)


.子程序 显示记录, 空白型, , 
.如果真 (或者 (首记录前 (), 尾记录后 ()))
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
    返回 ()
.如果真结束
赋值 (.内容, 读 (#学生姓名))
赋值 (.内容, 读 (#性别))
赋值 (.内容, 读 (#年龄))
赋值 (.内容, 读 (#民族))
赋值 (.内容, 读 (#就读学校))
赋值 (.内容, 读 (#学习阶段))
赋值 (.内容, 读 (#年级))
赋值 (.内容, 读 (#班别))
赋值 (.内容, 读 (#父亲姓名))
赋值 (.内容, 读 (#父亲工作单位))
赋值 (.内容, 读 (#母亲姓名))
赋值 (.内容, 读 (#母亲工作单位))
赋值 (.内容, 读 (#其他监护姓名))
赋值 (.内容, 读 (#其他工作单位))
赋值 (.内容, 读 (#家庭住址))
赋值 (.内容, 读 (#贫困类型))
赋值 (.内容, 读 (#总人口))
赋值 (.内容, 读 (#收入来源))
赋值 (.内容, 读 (#年均人收入))


.子程序 _首记录按钮_被单击, 空白型, , 
到首记录 ()
显示记录 ()


.子程序 _尾记录按钮_被单击, 空白型, , 
到尾记录 ()
显示记录 ()


.子程序 _上一条按钮_被单击, 空白型, , 
.如果真 (等于 (取记录号 (), 1))
    
    信息框 (“前面已无记录”, 0, )
    
.如果真结束
跳过 (-1)
显示记录 ()


.子程序 _下一条按钮_被单击, 空白型, , 
.如果真 (等于 (取记录号 (), 取记录数 ()))
    信息框 (“后面已无记录”, 0, )
.如果真结束
跳过 ()
显示记录 ()


.子程序 _修改按钮_被单击, 空白型, , 
赋值 (.内容, 删全部空 (.内容))
.如果 (等于 (修改 (.内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容), 假))
    信息框 (“修改记录失败”, 0, )
.否则
    主窗口.超级列表框显示数据 ()
    信息框 (“修改记录成功”, 0, )
.如果结束



.子程序 _退出按钮_被单击, 空白型, , 
销毁 ()

关闭 ()



.子程序 _修改记录窗口_将被销毁, 空白型, , 
关闭 ()


.子程序 _分组框4_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 



.子程序 _删除按钮_被单击, 空白型, , 

删除 ()
彻底删除 ()
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)

主窗口.超级列表框显示数据 ()



 ' 不属于任何一个程序集、类模块的函数：
