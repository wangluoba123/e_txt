 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 563
    高度 = 590
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 6 系统核心支持库





.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 本子程序在程序启动后最先执行
载入 (窗口1, , 真)
返回 (0) ' 可以根据您的需要返回任意数值

.窗口程序集 窗口程序集1, , , 

.子程序 _动态加密解密_被单击, 空白型, , 
.局部变量 解密内容, 字节集, , , 
.局部变量 加密时间, 整数型, , , 
.局部变量 解密时间, 整数型, , , 
.局部变量 加密内容, 字节集, , , 
.局部变量 原来长度, 整数型, , , 
.局部变量 现在时间, 整数型, , , 
.局部变量 加密长度, 整数型, , , 

输出调试文本 (“”)
赋值 (加密内容, 到字节集 (.))
赋值 (原来长度, 取字节集长度 (加密内容))
输出调试文本 (相加 (“原文长度:”, 到文本 (原来长度)))
赋值 (加密时间, 取启动时间 ())
赋值 (加密内容, 动态加密_ (加密内容, .))
赋值 (解密时间, 取启动时间 ())
赋值 (., 到文本 (加密内容))
赋值 (加密长度, 取字节集长度 (加密内容))
输出调试文本 (相加 (“密文长度:”, 到文本 (加密长度)))
输出调试文本 (相加 (“加密耗时:”, 到文本 (相减 (解密时间, 加密时间)), “ ms”))
赋值 (解密时间, 取启动时间 ())
赋值 (解密内容, 动态解密_ (加密内容, .))
赋值 (现在时间, 取启动时间 ())
赋值 (., 到文本 (解密内容))
输出调试文本 (相加 (“解密耗时:”, 到文本 (相减 (现在时间, 解密时间)), “ ms”))

.子程序 动态解密_, 字节集, 公开, 制作:逍遥De二少 
.参数 _待解密字节集, 字节集, , 
.参数 _待算密钥_key, 文本型, 可空, 为空则使用“abcdefghijklmnopqrhtuvwxyz1234567890~!@#$%^&*()_+-=”

.局部变量 封包长度, 整数型, , , 
.局部变量 密钥长度, 整数型, , , 
.局部变量 密钥字节, 字节集, , , 
.局部变量 i, 整数型, , , 
.局部变量 位于数值, 整数型, , , 
.局部变量 时间密钥, 字节型, , "4", 
.局部变量 n, 整数型, , , 
.局部变量 整位, 整数型, , , 
.局部变量 密钥时间, 字节型, , "4", 

赋值 (封包长度, 取字节集长度 (_待解密字节集))
.如果真 (大于 (封包长度, 8))
    赋值 (_待算密钥_key, 选择 (等于 (_待算密钥_key, “”), “abcdefghijklmnopqrhtuvwxyz1234567890~!@#$%^&*()_+-=”, _待算密钥_key))
    赋值 (密钥字节, 到字节集 (_待算密钥_key))
    赋值 (密钥长度, 取字节集长度 (密钥字节))
    .如果真 (大于 (密钥长度, 0))
        赋值 (位于数值, 1)
        赋值 (位于数值, 位异或 (取字节集数据 (_待解密字节集, #整数型, 位于数值), 取字节集数据 (_待解密字节集, #整数型, 位于数值)))
        赋值 (位于数值, 位取反 (位于数值))
        赋值 (_待解密字节集, 取字节集右边 (_待解密字节集, 相减 (封包长度, 4)))
        .计次循环首 (4, i)
            赋值 (密钥时间 [i], _待解密字节集 [i])
            赋值 (时间密钥 [i], 位异或 (_待解密字节集 [i], 位于数值))
            
        .计次循环尾 ()
        赋值 (封包长度, 相减 (封包长度, 8))
        赋值 (_待解密字节集, 取字节集右边 (_待解密字节集, 封包长度))
        .计次循环首 (密钥长度, i)
            赋值 (整位, 相加 (整位, 1))
            .如果真 (大于 (整位, 4))
                赋值 (整位, 1)
            .如果真结束
            赋值 (密钥字节 [i], 位异或 (密钥字节 [i], 密钥时间 [整位]))
        .计次循环尾 ()
        .计次循环首 (封包长度, i)
            赋值 (整位, 相加 (整位, 1))
            .如果真 (大于 (整位, 4))
                赋值 (整位, 1)
            .如果真结束
            赋值 (_待解密字节集 [i], 位异或 (_待解密字节集 [i], 时间密钥 [整位]))
            .计次循环首 (密钥长度, n)
                赋值 (_待解密字节集 [i], 位异或 (_待解密字节集 [i], 密钥字节 [n]))
            .计次循环尾 ()
        .计次循环尾 ()
        返回 (_待解密字节集)
    .如果真结束
    
.如果真结束
返回 ({  })

.子程序 动态加密_, 字节集, 公开, 制作:逍遥De二少 
.参数 _待加密字节集, 字节集, , 
.参数 _待算密钥_key, 文本型, 可空, 为空则使用“abcdefghijklmnopqrhtuvwxyz1234567890~!@#$%^&*()_+-=”

.局部变量 i, 整数型, , , 
.局部变量 密钥字节, 字节集, , , 
.局部变量 n, 整数型, , , 
.局部变量 密钥长度, 整数型, , , 
.局部变量 封包长度, 整数型, , , 
.局部变量 数值, 整数型, , , 
.局部变量 启动字节, 字节集, , , 
.局部变量 整位, 整数型, , , 
.局部变量 密钥时间, 字节集, , , 
.局部变量 临时字节, 字节型, , , 
.局部变量 传递字节, 字节型, , , 

赋值 (_待算密钥_key, 选择 (等于 (_待算密钥_key, “”), “abcdefghijklmnopqrhtuvwxyz1234567890~!@#$%^&*()_+-=”, _待算密钥_key))
赋值 (密钥字节, 到字节集 (_待算密钥_key))
赋值 (密钥长度, 取字节集长度 (密钥字节))
赋值 (封包长度, 取字节集长度 (_待加密字节集))
.如果真 (并且 (大于 (封包长度, 0), 大于 (密钥长度, 0)))
    赋值 (启动字节, 到字节集 (取启动时间 ()))
    赋值 (密钥时间, 启动字节)
    赋值 (数值, 取随机数 (2, 255))
    .计次循环首 (4, i)
        赋值 (密钥时间 [i], 位异或 (启动字节 [i], 数值))
    .计次循环尾 ()
    .计次循环首 (密钥长度, i)
        赋值 (整位, 相加 (整位, 1))
        .如果真 (大于 (整位, 4))
            赋值 (整位, 1)
        .如果真结束
        赋值 (密钥字节 [i], 位异或 (密钥字节 [i], 密钥时间 [整位]))
    .计次循环尾 ()
    .计次循环首 (封包长度, i)
        赋值 (整位, 相加 (整位, 1))
        .如果真 (大于 (整位, 4))
            赋值 (整位, 1)
        .如果真结束
        .计次循环首 (密钥长度, n)
            赋值 (_待加密字节集 [i], 位异或 (_待加密字节集 [i], 密钥字节 [n]))
        .计次循环尾 ()
        赋值 (_待加密字节集 [i], 位异或 (_待加密字节集 [i], 启动字节 [整位]))
    .计次循环尾 ()
    赋值 (数值, 位取反 (数值))
    赋值 (数值, 位异或 (数值, 取字节集数据 (密钥时间, #整数型, )))
    赋值 (_待加密字节集, 相加 (到字节集 (数值), 密钥时间, _待加密字节集))
    返回 (_待加密字节集)
.如果真结束
返回 ({  })

.子程序 _文件_加密_被单击, 空白型, , 
.局部变量 文件数据, 字节集, , , 

赋值 (., 0)
.如果真 (打开 ())
    赋值 (文件数据, 读入文件 (.))
    赋值 (文件数据, 动态加密_ (文件数据, .))
    .如果真 (不等于 (文件数据, {  }))
        赋值 (., 1)
        .如果真 (打开 ())
            写到文件 (., 文件数据)
        .如果真结束
        
    .如果真结束
    
.如果真结束


.子程序 _文件_解密_被单击, 空白型, , 
.局部变量 文件数据, 字节集, , , 

赋值 (., 0)
.如果真 (打开 ())
    赋值 (文件数据, 读入文件 (.))
    赋值 (文件数据, 动态解密_ (文件数据, .))
    .如果真 (不等于 (文件数据, {  }))
        赋值 (., 1)
        .如果真 (打开 ())
            写到文件 (., 文件数据)
        .如果真结束
        
    .如果真结束
    
.如果真结束



 ' 不属于任何一个程序集、类模块的函数：
