 ' 文件类型：Windows模块源码

 ' 程序名称：分数运算模块
 ' 程序描述：2008.7.27

易语言我吃了 制作
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0



.常量 加, "1", 公开, 
.常量 减, "2", 公开, 
.常量 乘, "3", 公开, 
.常量 除, "4", 公开, 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 5 系统核心支持库




数据类型 分数型, 公开, 比如"二分之一"，一为分子，二为分母，文本在本模块中写做"1/2"
    .成员 分子, 整数型, , , 
    .成员 分母, 整数型, , , 

数据类型 带分数, 公开, 比如"三又二分之一"，三为整数部分，二为分母，一为分子。文本在本模块中写做"3&1/2"
    .成员 整数部分, 整数型, , , 
    .成员 分子, 整数型, , , 
    .成员 分母, 整数型, , , 


.程序集 程序集1, , , 易语言我吃了 制作

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在初始化代码执行完毕后调用测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。

.子程序 分数运算, 分数型, , 将两个分数执行运算，连续调用可实现连续运算，分数无意义返回为分子母皆为0的分数。
.参数 分数1, 分数型, , 如果想让整数或小数参加运算，请先使用“数值到分数”转换数据类型；想让带分数进行运算请用“带分数到分数”。
.参数 运算规则, 整数型, , 1、#加 2、#减 3、#乘 4、#除
.参数 分数2, 分数型, , 

.局部变量 分数, 分数型, , , 
.局部变量 分数数组, 分数型, , "0", 

赋值 (分数, 分数赋值 (0, 0))
.如果真 (或者 (等于 (分数是否有意义 (分数1), 假), 等于 (分数是否有意义 (分数2), 假)))
    返回 (分数)
.如果真结束
.如果真 (或者 (等于 (运算规则, #加), 等于 (运算规则, #减)))
    通分 (分数1, 分数2, 分数数组)
    赋值 (分数1.分子, 分数数组 [1].分子)
    赋值 (分数1.分母, 分数数组 [1].分母)
    赋值 (分数2.分子, 分数数组 [2].分子)
    赋值 (分数2.分母, 分数数组 [2].分母)
    赋值 (分数.分母, 分数数组 [2].分母)
    .如果 (等于 (运算规则, #加))
        赋值 (分数.分子, 相加 (分数1.分子, 分数2.分子))
    .否则
        赋值 (分数.分子, 相减 (分数1.分子, 分数2.分子))
    .如果结束
    赋值 (分数, 约分 (分数))
    返回 (分数)
.如果真结束
.如果真 (等于 (运算规则, #乘))
    赋值 (分数.分子, 相乘 (分数1.分子, 分数2.分子))
    赋值 (分数.分母, 相乘 (分数1.分母, 分数2.分母))
    赋值 (分数, 约分 (分数))
    返回 (分数)
.如果真结束
.如果真 (等于 (运算规则, #除))
    赋值 (分数.分子, 相乘 (分数1.分子, 分数2.分母))
    赋值 (分数.分母, 相乘 (分数1.分母, 分数2.分子))
    赋值 (分数, 约分 (分数))
    返回 (分数)
.如果真结束
返回 (分数)

.子程序 分数赋值, 分数型, , 返回一个分数型变量，其中分子和分母是指定的。
.参数 分子, 整数型, , 
.参数 分母, 整数型, , 

.局部变量 分数, 分数型, , , 

赋值 (分数.分子, 分子)
赋值 (分数.分母, 分母)
返回 (分数)

.子程序 带分数赋值, 带分数, , 返回一个带分数型变量，其中分子和分母是指定的。
.参数 整数部分, 整数型, , 
.参数 分子, 整数型, , 
.参数 分母, 整数型, , 

.局部变量 分数, 带分数, , , 

赋值 (分数.整数部分, 整数部分)
赋值 (分数., )
赋值 (分数., )
返回 (分数)

.子程序 求分数次方, 分数型, , 求一个分数的次方，分数无意义原样返回。
.参数 欲求次方的分数, 分数型, , 
.参数 欲求次方数, 整数型, , 只能是整数，如果输入小数，乘方后得到的结果不是整数的话将会被四舍五入。

.局部变量 分数, 分数型, , , 

.如果真 (等于 (分数是否有意义 (欲求次方的分数), 假))
    返回 (欲求次方的分数)
.如果真结束
赋值 (分数, 分数赋值 (求次方 (欲求次方的分数.分子, 欲求次方数), 求次方 (欲求次方的分数.分母, 欲求次方数)))
赋值 (分数, 约分 (分数))
返回 (分数)

.子程序 求分数平方根, 分数型, , 求一个分数的平方根，分数无意义原样返回。
.参数 欲求其根的数, 分数型, , 

.如果真 (分数是否有意义 (欲求其根的数))
    赋值 (欲求其根的数, 分数赋值 (求平方根 (欲求其根的数.分子), 求平方根 (欲求其根的数.分母)))
    返回 (约分 (欲求其根的数))
.如果真结束
返回 (欲求其根的数)

.子程序 约分, 分数型, , 将分数化为最简，分数已为最简或无意义原样返回。
.参数 分数, 分数型, , 

.局部变量 最大公约数, 整数型, , , 

.如果真 (分数是否有意义 (分数))
    赋值 (分数, 分数负号移分子 (分数))
    赋值 (最大公约数, 取最大公约数 (取绝对值 (分数.分子), 取绝对值 (分数.分母)))
    赋值 (分数, 分数赋值 (相除 (分数.分子, 最大公约数), 相除 (分数.分母, 最大公约数)))
    返回 (分数)
.如果真结束
返回 (分数)

.子程序 带分数约分, 带分数, , 将带分数化为最简，分数无意义原样返回。
.参数 欲化简的带分数, 带分数, , 

.局部变量 分数, 分数型, , , 

.如果真 (分数是否有意义 (欲化简的带分数))
    赋值 (分数, 带分数到分数 (欲化简的带分数))
    赋值 (分数, 约分 (分数))
    返回 (分数到带分数 (分数))
.如果真结束
返回 (欲化简的带分数)

.子程序 通分, 空白型, , 将两个分母不同的分数化为同分母，带分数约分可先将带分数化为假分数后再通分。
.参数 分数1, 分数型, , 
.参数 分数2, 分数型, , 
.参数 通分后分数, 分数型, 参考 数组, 用来接收通分后的分数数组，失败返回两个原分数。

.局部变量 通分后分数1, 分数型, , , 
.局部变量 通分后分数2, 分数型, , , 
.局部变量 最小公倍数, 整数型, , , 

.如果真 (或者 (等于 (分数是否有意义 (分数1), 假), 等于 (分数是否有意义 (分数2), 假)))
    加入成员 (通分后分数, 分数1)
    加入成员 (通分后分数, 分数2)
    返回 ()
.如果真结束
赋值 (分数1, 约分 (分数1))
赋值 (分数2, 约分 (分数2))
赋值 (最小公倍数, 取最小公倍数 (取绝对值 (分数1.分母), 取绝对值 (分数2.分母)))
赋值 (通分后分数1.分子, 分数1.分子)
赋值 (通分后分数2.分子, 分数2.分子)
连续赋值 (最小公倍数, 通分后分数1.分母, 通分后分数2.分母)
赋值 (通分后分数1.分子, 相除 (相乘 (通分后分数1.分子, 最小公倍数), 分数1.分母))
赋值 (通分后分数2.分子, 相除 (相乘 (通分后分数2.分子, 最小公倍数), 分数2.分母))
加入成员 (通分后分数, 分数负号移分子 (通分后分数1))
加入成员 (通分后分数, 分数负号移分子 (通分后分数2))

.子程序 分数负号移分子, 分数型, , 将分数型变量为负数的负号移到分子，方便操作；将分子母同为负的去掉负号。
.参数 被修改分数, 分数型, , 

.局部变量 分数, 分数型, , , 

赋值 (分数, 被修改分数)
.如果真 (并且 (小于 (被修改分数.分子, 0), 小于 (被修改分数.分母, 0)))
    赋值 (分数, 分数赋值 (负 (被修改分数.分子), 负 (被修改分数.分母)))
    返回 (分数)
.如果真结束
.如果真 (并且 (大于 (被修改分数.分子, 0), 小于 (被修改分数.分母, 0)))
    赋值 (分数, 分数赋值 (负 (被修改分数.分子), 负 (被修改分数.分母)))
    返回 (分数)
.如果真结束
返回 (分数)

.子程序 带分数负号移分子, 带分数, , 将带分数型变量为负数的负号移到分子，方便操作；将整数部分、分子母其中一对同为负的去掉负号。
.参数 被修改带分数, 带分数, , 

.局部变量 带分数, 带分数, , , 
.局部变量 得数, 整数型, , , 

赋值 (带分数, 被修改带分数)
赋值 (得数, 相乘 (被修改带分数.分子, 被修改带分数.分母, 被修改带分数.整数部分))
.如果真 (小于 (得数, 0))
    赋值 (带分数, 带分数赋值 (取绝对值 (被修改带分数.整数部分), 负 (取绝对值 (被修改带分数.分子)), 取绝对值 (被修改带分数.分母)))
    返回 (带分数)
.如果真结束
.如果真 (大于 (得数, 0))
    赋值 (带分数, 带分数赋值 (取绝对值 (被修改带分数.整数部分), 取绝对值 (被修改带分数.分子), 取绝对值 (被修改带分数.分母)))
    返回 (带分数)
.如果真结束
返回 (带分数)

.子程序 文本到分数, 分数型, , 将形如“X/Y”(XY为整数)或整数的文本转化为分数型变量，这样可以使整数或者小数变成分数参与分数运算。
.参数 欲转化为分数的文本, 文本型, , 
.参数 是否约分, 逻辑型, 可空, 为真约分，为假不约分，默认为真。

.局部变量 文本数组, 文本型, , "0", 
.局部变量 分数, 分数型, , , 

赋值 (文本数组, 分割文本 (删全部空 (欲转化为分数的文本), “/”, ))
.如果真 (不等于 (取数组成员数 (文本数组), 2))
    赋值 (分数, 分数赋值 (到整数 (欲转化为分数的文本), 1))
    返回 (分数)
.如果真结束
赋值 (分数, 分数赋值 (到整数 (文本数组 [1]), 到整数 (文本数组 [2])))
.如果真 (或者 (是否为空 (是否约分), 等于 (是否约分, 真)))
    赋值 (分数, 约分 (分数))
.如果真结束
赋值 (分数, 分数负号移分子 (分数))
返回 (分数)

.子程序 文本到带分数, 带分数, , 将形如“A&X/Y”(A为整数部分，XY皆为整数的分子和分母)的文本转化为分数型变量。
.参数 欲转化为分数的文本, 文本型, , 
.参数 是否约分, 逻辑型, 可空, 为真约分，为假不约分，默认为真。

.局部变量 文本数组, 文本型, , "0", 
.局部变量 临时分数, 分数型, , , 
.局部变量 分数, 带分数, , , 

赋值 (分数, 带分数赋值 (0, 到整数 (欲转化为分数的文本), 0))
赋值 (文本数组, 分割文本 (删全部空 (欲转化为分数的文本), “&”, ))
.如果真 (不等于 (取数组成员数 (文本数组), 2))
    返回 (分数)
.如果真结束
赋值 (分数.整数部分, 到整数 (文本数组 [1]))
赋值 (临时分数, 文本到分数 (文本数组 [2]))
.如果真 (不等于 (临时分数.分母, 0))
    赋值 (分数, 带分数赋值 (临时分数.分子, 临时分数.分母))
    赋值 (分数, 带分数负号移分子 (分数))
    .如果真 (或者 (是否为空 (是否约分), 等于 (是否约分, 真)))
        赋值 (分数, 带分数约分 (分数))
    .如果真结束
    返回 (分数)
.如果真结束
返回 (分数)

.子程序 分数到文本, 文本型, , 将分数变量转化为形如“X/Y”的文本。
.参数 欲转换的分数, 分数型, , 
.参数 是否约分, 逻辑型, 可空, 为真约分，为假不约分，默认为真。

.如果真 (或者 (是否为空 (是否约分), 等于 (是否约分, 真)))
    赋值 (欲转换的分数, 约分 (欲转换的分数))
    返回 (相加 (到文本 (欲转换的分数.分子), “/”, 到文本 (欲转换的分数.分母)))
.如果真结束
赋值 (欲转换的分数, 分数负号移分子 (欲转换的分数))
返回 (相加 (到文本 (欲转换的分数.分子), “/”, 到文本 (欲转换的分数.分母)))

.子程序 带分数到文本, 文本型, , 将带分数变量转化为形如“A&X/Y”的文本。
.参数 欲转换的带分数, 带分数, , 
.参数 是否约分, 逻辑型, 可空, 为真约分，为假不约分，默认为真。

.如果真 (或者 (是否为空 (是否约分), 等于 (是否约分, 真)))
    赋值 (欲转换的带分数, 带分数约分 (欲转换的带分数))
.如果真结束
赋值 (欲转换的带分数, 带分数负号移分子 (欲转换的带分数))
.如果真 (小于 (欲转换的带分数.分子, 0))
    返回 (相加 (“-”, 到文本 (欲转换的带分数.整数部分), “&”, 到文本 (取绝对值 (欲转换的带分数.分子)), “/”, 到文本 (欲转换的带分数.分母)))
.如果真结束
返回 (相加 (到文本 (欲转换的带分数.整数部分), “&”, 到文本 (欲转换的带分数.分子), “/”, 到文本 (欲转换的带分数.分母)))

.子程序 数值到分数, 分数型, , 将数值化为分数，这样可以使整数或者小数变成分数参与分数运算。
.参数 欲转换的数值, 双精度小数型, , 

.局部变量 文本, 文本型, , , 
.局部变量 整数部分, 文本型, , , 
.局部变量 小数部分, 文本型, , , 
.局部变量 小数位数, 整数型, , , 
.局部变量 分数, 分数型, , , 

赋值 (文本, 到文本 (欲转换的数值))
.如果真 (等于 (寻找文本 (文本, “.”, , 假), -1))
    赋值 (分数, 分数赋值 (到整数 (欲转换的数值), 1))
    返回 (分数)
.如果真结束
.如果 (小于 (欲转换的数值, 0))
    赋值 (整数部分, 取文本左边 (文本, 相加 (相减 (取文本长度 (文本), 寻找文本 (文本, “.”, , 假)), 1)))
.否则
    赋值 (整数部分, 取文本左边 (文本, 相减 (取文本长度 (文本), 寻找文本 (文本, “.”, , 假))))
.如果结束
赋值 (小数部分, 取文本右边 (文本, 相减 (取文本长度 (文本), 寻找文本 (文本, “.”, , 假))))
赋值 (小数位数, 取文本长度 (小数部分))
赋值 (分数.分母, 到整数 (相加 (“1”, 取重复文本 (小数位数, “0”))))
.如果 (大于 (取符号 (欲转换的数值), 0))
    赋值 (分数.分子, 相加 (相乘 (到整数 (整数部分), 分数.分母), 到整数 (小数部分)))
.否则
    赋值 (分数.分子, 负 (相加 (相乘 (到整数 (取绝对值 (到整数 (整数部分))), 分数.分母), 到整数 (小数部分))))
.如果结束
返回 (约分 (分数))

.子程序 数值到带分数, 带分数, , 将数值化为带分数。
.参数 欲转换的数值, 双精度小数型, , 

返回 (分数到带分数 (数值到分数 (欲转换的数值)))

.子程序 分数到数值, 双精度小数型, , 将分数化为数值。
.参数 欲转换的分数, 分数型, , 

.如果真 (分数是否有意义 (欲转换的分数))
    返回 (相除 (欲转换的分数.分子, 欲转换的分数.分母))
.如果真结束
返回 (0)

.子程序 带分数到数值, 双精度小数型, , 将带分数化为数值。
.参数 欲转换的带分数, 带分数, , 

.如果真 (分数是否有意义 (欲转换的带分数))
    返回 (分数到数值 (带分数到分数 (欲转换的带分数)))
.如果真结束
返回 (0)

.子程序 约分到整数, 整数型, , 将可以约尽的分数变成整数形式，不能约尽的四舍五入取整数。如将"6/3"变为2，"0/4"变为0，“9/4”变为2，带分数要执行此操作要先转化成假分数。
.参数 要约分的分数, 分数型, , 

.如果真 (等于 (分数是否有意义 (要约分的分数), 假))
    返回 (0)
.如果真结束
赋值 (要约分的分数, 约分 (要约分的分数))
返回 (四舍五入 (相除 (要约分的分数.分子, 要约分的分数.分母), ))

.子程序 分数到带分数, 带分数, , 将假分数化为带分数，提供的分数为真分数则返回整数部分为0的带分数，错误返回空带分数。
.参数 欲转换的分数, 分数型, , 

.局部变量 分数, 带分数, , , 

.如果真 (等于 (分数是否有意义 (欲转换的分数), 假))
    返回 (文本到带分数 (“0&0/0”))
.如果真结束
赋值 (欲转换的分数, 约分 (欲转换的分数))
.如果真 (是否为真分数 (欲转换的分数))
    赋值 (分数, 带分数赋值 (0, 欲转换的分数.分子, 欲转换的分数.分母))
    返回 (分数)
.如果真结束
赋值 (分数, 带分数赋值 (取绝对值 (整除 (欲转换的分数.分子, 欲转换的分数.分母)), 求余数 (欲转换的分数.分子, 欲转换的分数.分母), 欲转换的分数.分母))
返回 (分数)

.子程序 带分数到分数, 分数型, , 将带分数化为假分数，错误返回空分数。
.参数 带分数, 带分数, , 

.局部变量 分数, 分数型, , , 

.如果真 (等于 (分数是否有意义 (带分数), 假))
    返回 (文本到分数 (“0/0”))
.如果真结束
赋值 (带分数, 带分数负号移分子 (带分数))
.如果 (小于 (带分数.分子, 0))
    赋值 (分数.分子, 负 (相加 (相乘 (带分数.整数部分, 带分数.分母), 取绝对值 (带分数.分子))))
.否则
    赋值 (分数.分子, 相加 (相乘 (带分数.整数部分, 带分数.分母), 带分数.分子))
.如果结束
赋值 (分数.分母, 带分数.分母)
返回 (约分 (分数))

.子程序 分数是否有意义, 逻辑型, , 分母为0则无意义，返回假。
.参数 欲检查的分数, 分数型, 可空, 
.参数 欲检查的带分数, 带分数, 可空, 两个参数选其一。

.如果真 (等于 (是否为空 (欲检查的分数), 假))
    .如果真 (等于 (欲检查的分数.分母, 0))
        返回 (假)
    .如果真结束
    返回 (真)
.如果真结束
.如果真 (等于 (是否为空 (欲检查的带分数), 假))
    .如果真 (等于 (欲检查的带分数.分母, 0))
        返回 (假)
    .如果真结束
    返回 (真)
.如果真结束
返回 (假)

.子程序 取分数符号, 整数型, , 返回一个数，如果小于零，表明给定数值为负；如果等于零，表明给定数值为零或无意义；如果大于零，表明给定数值为正。
.参数 欲取其符号的分数, 分数型, , 

返回 (相乘 (欲取其符号的分数.分子, 欲取其符号的分数.分母))

.子程序 是否为真分数, 逻辑型, , 为真分数返回真，假分数返回假。
.参数 分数, 分数型, 可空, 两个参数选其一。
.参数 带分数, 带分数, 可空, 如果带分数的整数部分为0，且分子的绝对值小于分母的绝对值则为真。

.如果真 (等于 (是否为空 (分数), 假))
    .如果真 (大于 (取绝对值 (分数.分母), 取绝对值 (分数.分子)))
        返回 (真)
    .如果真结束
    返回 (假)
.如果真结束
.如果真 (等于 (是否为空 (带分数), 假))
    .如果真 (并且 (等于 (带分数.整数部分, 0), 小于 (取绝对值 (带分数.分子), 取绝对值 (带分数.分母))))
        返回 (真)
    .如果真结束
    返回 (假)
.如果真结束
返回 (假)

.子程序 取最大公约数, 整数型, , 
.参数 数1, 整数型, , 
.参数 数2, 整数型, , 

.局部变量 操作数1, 整数型, , , 
.局部变量 操作数2, 整数型, , , 
.局部变量 中间数, 整数型, , , 

赋值 (操作数1, 数1)
赋值 (操作数2, 数2)
.判断循环首 (不等于 (操作数2, 0))
    赋值 (中间数, 求余数 (操作数1, 操作数2))
    赋值 (操作数1, 操作数2)
    赋值 (操作数2, 中间数)
.判断循环尾 ()
返回 (操作数1)

.子程序 取最小公倍数, 整数型, , 
.参数 数1, 整数型, , 
.参数 数2, 整数型, , 

.局部变量 操作数1, 整数型, , , 
.局部变量 操作数2, 整数型, , , 
.局部变量 中间数, 整数型, , , 

赋值 (操作数1, 数1)
赋值 (操作数2, 数2)
赋值 (中间数, 操作数1)
.判断循环首 (不等于 (求余数 (中间数, 操作数2), 0))
    赋值 (中间数, 相加 (中间数, 操作数1))
.判断循环尾 ()
返回 (中间数)


 ' 不属于任何一个程序集、类模块的函数：
