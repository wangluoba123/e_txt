 ' 文件类型：Windows窗口程序

 ' 程序名称：定时提醒
 ' 程序描述：        本程序模块必须运行在“_时钟_
时钟周期”事件中，请设置时钟周期1000
，本程序中“提醒功能扩展”模块必须运
行在“定时提醒”或“间隔提醒”模块之
后。
 ' 程序作者：小蚂蚁
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：zhibin@yeah.net
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 消息窗口
    左边 = 50
    顶边 = 50
    宽度 = 220
    高度 = 170
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 2
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 3 系统核心支持库




.全局变量 信息库, 文本型, , , 
.全局变量 动画库, 字节集, , , 
.全局变量 音乐文件, 文本型, , , 
.全局变量 移动值, 整数型, , , 
.全局变量 启动时间, 日期时间型, , , 
.全局变量 计数, 整数型, , , 

.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码

_临时子程序 () ' 在模块初始化代码执行完毕后调用模块测试代码
返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的参数及返回值类型。


.程序集 _接口程序集, , , 在本程序集中定义的子程序可被模块外部程序访问，注意如果不存在本程序集就不能作为易模块编译。

.子程序 定时提醒, 空白型, , 本程序必须用在“时钟.时钟周期”事件当中，时钟周期设置为1000
.参数 年, 整数型, 可空, 默认为今年
.参数 月, 整数型, 可空, 默认为今月
.参数 日, 整数型, 可空, 默认为今日
.参数 时, 整数型, 可空, 默认为0时
.参数 分, 整数型, 可空, 默认为0分
.参数 秒, 整数型, 可空, 默认为0秒

.如果 (等于 (年, 0))
    赋值 (年, 取年份 (取现行时间 ()))
.否则
    
.如果结束
.如果 (等于 (月, 0))
    赋值 (月, 取月份 (取现行时间 ()))
.否则
    
.如果结束
.如果 (等于 (日, 0))
    赋值 (日, 取日 (取现行时间 ()))
.否则
    
.如果结束
.如果 (并且 (等于 (取年份 (取现行时间 ()), 年), 等于 (取月份 (取现行时间 ()), 月), 等于 (取日 (取现行时间 ()), 日), 等于 (取小时 (取现行时间 ()), 时), 等于 (取分钟 (取现行时间 ()), 分), 等于 (取秒 (取现行时间 ()), 秒)))
    载入 (消息窗口, , 真)
.否则
    
.如果结束


.子程序 提醒功能扩展, 空白型, , 本子程序必须在“定时提醒”或“间隔提醒”子程序执行后才可执行
.参数 信息, 文本型, , 定时提醒的信息内容，不要忘记双引号
.参数 动画, 字节集, 可空, 支持gif格式动画文件，或静画
.参数 mp3音乐, 文本型, 可空, 输入完整的mp3音乐文件名，如：取当前目录（）+“\001.mp3”
.参数 移动, 整数型, 可空, 1、从屏幕左端移动到中间 2、从屏幕右端移动到中间 3、跟随鼠标 

赋值 (信息库, 信息)
赋值 (动画库, 动画)
赋值 (音乐文件, mp3音乐)
赋值 (移动值, 移动)

.子程序 间隔提醒, 空白型, , 本程序必须用在“时钟.时钟周期”事件当中，时钟周期设置为1000
.参数 间隔, 整数型, , 以分钟为单位，即程序启动后每隔多少分钟提醒一次

.局部变量 时间, 日期时间型, , , 

.如果 (等于 (计数, 0))
    赋值 (启动时间, 取现行时间 ())
    赋值 (计数, 1)
.否则
    
.如果结束
.如果 (等于 (计数, 1))
    赋值 (时间, 取现行时间 ())
    .如果 (等于 (取时间间隔 (时间, 启动时间, 7), 间隔))
        赋值 (计数, 0)
        载入 (消息窗口, , 真)
    .否则
        
    .如果结束
    
.否则
    
.如果结束


.窗口程序集 窗口程序集1, , , 

.子程序 _消息窗口_创建完毕, 空白型, , 
.如果 (不等于 (取字节集长度 (动画库), 0))
    赋值 (., 动画库)
.否则
    
.如果结束
.如果 (不等于 (信息库, “”))
    赋值 (., 信息库)
.否则
    
.如果结束
.如果 (不等于 (音乐文件, “”))
    播放MP3 (音乐文件)
.否则
    
.如果结束
.如果 (等于 (1))
    赋值 (消息窗口., -180)
    赋值 (., 1)
.否则
    .如果 (等于 (2))
        赋值 (消息窗口., 相加 (取屏幕宽度 (), 180))
        赋值 (., 1)
    .否则
        .如果 (等于 (移动值, 3))
            赋值 (消息窗口., 相减 (取鼠标垂直位置 (), 60))
            赋值 (消息窗口., 相减 (取鼠标水平位置 (), 60))
            赋值 (., 1)
        .否则
            
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 _标签2_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 0)
停止播放 ()
销毁 ()

.子程序 _关闭时钟_周期事件, 空白型, , 
赋值 (., 0)
停止播放 ()
销毁 ()

.子程序 _移动时钟_周期事件, 空白型, , 
.如果 (等于 (1))
    赋值 (消息窗口., 相加 (消息窗口., 10))
    .如果 (等于 (取屏幕宽度 (), 800))
        .如果 (等于 (消息窗口., 290))
            赋值 (., 0)
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    .如果 (等于 (取屏幕宽度 (), 1024))
        .如果 (等于 (消息窗口., 400))
            赋值 (., 0)
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    
.否则
    
.如果结束
.如果 (等于 (2))
    赋值 (消息窗口., 相减 (消息窗口., 10))
    .如果 (等于 (取屏幕宽度 (), 800))
        .如果 (等于 (消息窗口., 290))
            赋值 (., 0)
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    .如果 (等于 (取屏幕宽度 (), 1024))
        .如果 (等于 (消息窗口., 404))
            赋值 (., 0)
        .否则
            
        .如果结束
        
    .否则
        
    .如果结束
    
.否则
    
.如果结束
.如果 (等于 (移动值, 3))
    赋值 (消息窗口., 相减 (取鼠标垂直位置 (), 60))
    赋值 (消息窗口., 相减 (取鼠标水平位置 (), 60))
.否则
    
.如果结束


.子程序 _图片框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (., 0)
停止播放 ()
销毁 ()


 ' 不属于任何一个程序集、类模块的函数：
