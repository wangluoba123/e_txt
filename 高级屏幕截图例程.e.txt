 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 635
    高度 = 521
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “[神2也教你学E] - 高级屏幕截图例程”
    帮助文件名 = “”

窗口 底部窗口
    左边 = 50
    顶边 = 50
    宽度 = 65
    高度 = 38
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 255 '  0xFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 顶部窗口
    左边 = 50
    顶边 = 50
    宽度 = 48
    高度 = 33
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = 16777215 '  0xFFFFFF
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 假
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”



.图片 About, " ' 已保存到：D:\易语言学习\Data\高级屏幕截图例程.e\About", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 3 7 系统核心支持库
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库
 ' eImgConverter 8FA3AA46276847db8F28E57E7FB97B7F 1 0 图像格式转换支持库




数据类型 控件位置, , 
    .成员 左边, 整数型, , , 
    .成员 顶边, 整数型, , , 
    .成员 右边, 整数型, , , 
    .成员 底边, 整数型, , , 


.DLL命令 取窗口位置信息, 整数型, "user32.dll", "GetWindowRect", , 
    .参数 句柄, 整数型, , 
    .参数 大小, 控件位置, 传址, 

.DLL命令 取指定位置控件句柄, 整数型, "user32.dll", "WindowFromPoint", , 
    .参数 X轴光标, 整数型, , 
    .参数 Y轴光标, 整数型, , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 当前句柄, 整数型, , , 
.程序集变量 窗口位置, 控件位置, , , 
.程序集变量 屏幕底图, 字节集, , , 
.子程序 _时钟1_周期事件, 空白型, , 
赋值 (当前句柄, 取指定位置控件句柄 (取鼠标水平位置 (), 取鼠标垂直位置 ()))
取窗口位置信息 (当前句柄, 窗口位置)
赋值 (窗口位置.右边, 相减 (窗口位置.右边, 窗口位置.左边))
赋值 (窗口位置.底边, 相减 (窗口位置.底边, 窗口位置.顶边))
.如果真 (是否已创建 (底部窗口))
    底部窗口.移动 (相减 (窗口位置.左边, 2), 相减 (窗口位置.顶边, 2), 相加 (窗口位置.右边, 4), 相加 (窗口位置.底边, 4))
    底部窗口.移动 (., 窗口位置.左边, 窗口位置.顶边, 窗口位置.右边, 窗口位置.底边)
    赋值 (底部窗口..底图, 快照 (底部窗口.取窗口句柄 (.), , ))
.如果真结束


.子程序 置画板初始状态, 空白型, , 
.局部变量 画板宽度, 整数型, , , 
.局部变量 画板高度, 整数型, , , 

赋值 (画板宽度, _启动窗口.取图片宽度 (., 载入图片 (.底图)))
赋值 (画板高度, _启动窗口.取图片高度 (., 载入图片 (.底图)))
.如果 (大于 (画板高度, .高度))
    赋值 (.位置, 1)
    赋值 (.最大位置, 相减 (画板高度, .高度))
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
.如果结束
.如果 (大于 (画板宽度, .宽度))
    赋值 (.位置, 1)
    赋值 (.最大位置, 相减 (画板宽度, .宽度))
    赋值 (.禁止, 假)
.否则
    赋值 (.禁止, 真)
.如果结束
_启动窗口.移动 (., 0, 0, 画板宽度, 画板高度)

.子程序 _纵向滚动条_位置被改变, 空白型, , 
赋值 (.顶边, 负 (.位置))

.子程序 _横向滚动条_位置被改变, 空白型, , 
赋值 (.左边, 负 (.位置))

.子程序 _按钮6_被单击, 空白型, , 
赋值 (.底图, {  })

.子程序 _窗口及部件截图_被选择, 空白型, , 
赋值 (.位置, 2)
载入 (底部窗口, , 假)

.子程序 _全屏幕截图_被选择, 空白型, , 
赋值 (.位置, 2)
赋值 (.底图, 快照 ())
赋值 (.位置, 0)
置画板初始状态 ()

.子程序 _保存为JPG图形文件_被选择, 空白型, , 
赋值 (.过滤器, “JPG图形文件|*.jpg”)
赋值 (.默认文件后缀, “*.jpg”)
.如果真 (打开 ())
    写到文件 (相加 (未知支持库函数_7 (11), “ImageA.tmp”), .底图)
    未知支持库函数_0 (相加 (未知支持库函数_7 (11), “ImageA.tmp”), .文件名, 假, 80, 真, 0)
.如果真结束


.子程序 _清空图形区域_被选择, 空白型, , 
0.移动 (0, 0, 0)
.清除 ()
赋值 (.禁止, 真)
赋值 (.禁止, 真)

.子程序 _保存为BMP位图文件_被选择, 空白型, , 
赋值 (.过滤器, “BMP位图文件|*.bmp”)
赋值 (.默认文件后缀, “*.bmp”)
.如果真 (打开 ())
    写到文件 (.文件名, .底图)
.如果真结束


.子程序 _指定区域截图_被选择, 空白型, , 
赋值 (.位置, 2)
赋值 (屏幕底图, 快照 ())
载入 (顶部窗口, , 假)

.子程序 _退出程序_被选择, 空白型, , 
结束 ()

.子程序 _关于神2_被选择, 空白型, , 
信息框 (到文本 (#About), 0, “关于 神2”)

.窗口程序集 窗口程序集2, , , 

.程序集变量 当前句柄, 整数型, , , 
.程序集变量 窗口位置, 控件位置, , , 
.子程序 _时钟1_周期事件, 空白型, , 
.局部变量 循环容器, 整数型, 静态, , 

赋值 (当前句柄, 取指定位置控件句柄 (取鼠标水平位置 (), 取鼠标垂直位置 ()))
取窗口位置信息 (当前句柄, 窗口位置)
赋值 (.总在最前, 真)


赋值 (窗口位置.右边, 相减 (窗口位置.右边, 窗口位置.左边))
赋值 (窗口位置.底边, 相减 (窗口位置.底边, 窗口位置.顶边))
.如果 (等于 (底部窗口.可视, 假))
    底部窗口.移动 (相减 (窗口位置.左边, 2), 相减 (窗口位置.顶边, 2), 相加 (窗口位置.右边, 4), 相加 (窗口位置.底边, 4))
    底部窗口.移动 (., 2, 2, 窗口位置.右边, 窗口位置.底边)
    赋值 (底部窗口..底图, 快照 (当前句柄, , ))
    赋值 (底部窗口.可视, 真)
.否则
    赋值 (底部窗口.可视, 假)
.如果结束


.子程序 _快照画板_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (.可视, 假)
赋值 (_启动窗口.位置, 0)
赋值 (_启动窗口..底图, 底部窗口..底图)
销毁 ()

.子程序 子程序1, 空白型, , 
.如果 (不等于 (.左边, 0))
    移动 (相减 (.左边, 2), 相减 (.顶边, 2), 相加 (.宽度, 4), 相加 (.高度, 4))
    0.移动 (0, , )
.否则
    移动 (相加 (.左边, 2), 相加 (.顶边, 2), 相减 (.宽度, 4), 相减 (.高度, 4))
    2.移动 (2, , )
.如果结束


.子程序 _底部窗口_将被销毁, 空白型, , 
赋值 (_启动窗口.位置, 0)
置画板初始状态 ()

.子程序 _底部窗口_创建完毕, 空白型, , 
赋值 (.总在最前, 假)

.窗口程序集 窗口程序集3, , , 

.程序集变量 按住, 逻辑型, , , 
.程序集变量 当前位置, 整数型, , "2", 
.子程序 _顶部窗口_创建完毕, 空白型, , 
赋值 (.底图, _启动窗口.)
赋值 (.底图, .底图)
移动 (0, 0, 取屏幕宽度 (), 取屏幕高度 ())
0.移动 (0, 取屏幕宽度 (), 取屏幕高度 ())

.子程序 _顶部窗口_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (按住, 真)
赋值 (当前位置 [1], 取鼠标水平位置 ())
赋值 (当前位置 [2], 取鼠标垂直位置 ())
当前位置.移动 ( [1], 当前位置 [2], 0, 0)
赋值 (.可视, 真)
赋值 (.左边, 1)
赋值 (.顶边, 1)
相减 (负 (当前位置 [1]), 1).移动 (相减 (负 (当前位置 [2]), 1), , )

.子程序 _顶部窗口_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (按住, 真))
    赋值 (.可视, 真)
    当前位置.移动 ( [1], 当前位置 [2], 相减 (横向位置, 当前位置 [1]), 相减 (纵向位置, 当前位置 [2]))
    1.移动 (1, 相减 (横向位置, 当前位置 [1], 2), 相减 (纵向位置, 当前位置 [2], 2))
.如果真结束


.子程序 _顶部窗口_鼠标左键被放开, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (按住, 假)

.子程序 _区域画板_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

赋值 (_启动窗口..底图, 快照 (取窗口句柄 (), , ))
置画板初始状态 ()
销毁 ()

.子程序 _顶部窗口_将被销毁, 空白型, , 
赋值 (_启动窗口.位置, 0)

.子程序 _区域画板_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (按住, 真))
    _顶部窗口_鼠标位置被移动 (相减 (取鼠标水平位置 (), 2), 相减 (取鼠标垂直位置 (), 2), 功能键状态)
.如果真结束



 ' 不属于任何一个程序集、类模块的函数：
