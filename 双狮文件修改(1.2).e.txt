 ' 文件类型：Windows窗口程序

 ' 程序名称：双狮文件改名助手
 ' 程序描述：双狮软件工作室
 ' 程序作者：林劲国
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：TLSWR@163.com
 ' 主页地址：TLSWR.AnyP.cn
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 546
    高度 = 508
    鼠标指针 = { 0,0,0,0 }
    标记 = “版权所有 林劲国 2005”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 417
    高度 = 391
    鼠标指针 = { 0,0,0,0 }
    标记 = “版权所有 林劲国 2005”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 16580350 '  0xFCFEFE
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “关于”
    帮助文件名 = “”

窗口 过滤文件窗口
    左边 = 50
    顶边 = 50
    宽度 = 348
    高度 = 207
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “过滤文件”
    帮助文件名 = “”



.图片 , , , 
.常量 文件创建时间, "0", , 
.常量 文件最后访问时间, "1", , 
.常量 文件最后修改时间, "2", , 
.常量 文_星期, "“日一二三四五六”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' eDirTree BB868C7F58484f7b85EA1376FC902DC8 1 2 目录树支持库
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 2 0 扩展界面支持库三
 ' spec A512548E76954B6E92C21055517615B0 1 0 特殊功能支持库
 ' shellEx DA19AC3ADD2F4121AAD84AC5FBCAFC71 2 0 扩展功能支持库一
 ' xwx CBF69520-5300-43C4-B6D6-C2CF3F2A169B 1 0 xwxyh无限扩展库
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 6 XP风格界面库
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库




数据类型 文件时间, , 
    .成员 低_文件时间, 整数型, , , 
    .成员 高_文件时间, 整数型, , , 

数据类型 时间, , 
    .成员 年, 短整数型, , , 
    .成员 月, 短整数型, , , 
    .成员 星期, 短整数型, , , 
    .成员 日, 短整数型, , , 
    .成员 小时, 短整数型, , , 
    .成员 分钟, 短整数型, , , 
    .成员 秒, 短整数型, , , 
    .成员 毫秒, 短整数型, , , 

.全局变量 撒消_属性值, 整数型, , "0", 
.全局变量 撒消_属性路径, 文本型, , "0", 
.全局变量 撒消_旧更名, 文本型, , "0", 
.全局变量 撒消_新更名, 文本型, , "0", 
.全局变量 撒消_时间_年, 短整数型, , "0", 
.全局变量 撒消_时间_月, 短整数型, , "0", 
.全局变量 撒消_时间_日, 短整数型, , "0", 
.全局变量 撒消_时间_时, 短整数型, , "0", 
.全局变量 撒消_时间_分, 短整数型, , "0", 
.全局变量 撒消_时间_秒, 短整数型, , "0", 
.全局变量 撒消_时间_毫秒, 短整数型, , "0", 
.全局变量 撒消_时间路径, 文本型, , "0", 
.全局变量 撒消_时间值, 整数型, , , 
.全局变量 撒消_值, 整数型, , , 1是属性 2是更名 3是时间
.全局变量 撒消当前操作, 逻辑型, , , 

.DLL命令 DLL_取文件时间_时, 逻辑型, "Kernel32.dll", "GetFileTime", , 
    .参数 文件句柄, 整数型, , 
    .参数 创建时间, 文件时间, , 文件时间
    .参数 访问时间, 文件时间, , 
    .参数 最后修改时间, 文件时间, , 

.DLL命令 DLL_取文件时间, 逻辑型, "Kernel32.dll", "GetFileTime", , 
    .参数 文件句柄, 整数型, , 
    .参数 创建时间, 整数型, , 
    .参数 访问时间, 整数型, , 
    .参数 最后修改时间, 整数型, , 

.DLL命令 DLL_取最后调用错误, 整数型, "", "GetLastError", , 

.DLL命令 DLL_创建文件, 整数型, "", "CreateFileA", , 
    .参数 lpFileName, 文本型, , 
    .参数 dwDesiredAccess, 整数型, , 
    .参数 dwShareMode, 整数型, , 
    .参数 lpSecurityAttributes, 整数型, , 
    .参数 dwCreationDisposition, 整数型, , 
    .参数 dwFlagsAndAttributes, 整数型, , 
    .参数 hTemplateFile, 整数型, , 

.DLL命令 DLL_关闭句柄, 逻辑型, "", "CloseHandle", , 
    .参数 handle, 整数型, , 

.DLL命令 DLL_文件时间到本地文件时间, 逻辑型, "", "FileTimeToLocalFileTime", , 
    .参数 从文件时间, 文件时间, , 
    .参数 到文件本地时间, 文件时间, , 

.DLL命令 DLL_文件时间到系统时间, 逻辑型, "", "FileTimeToSystemTime", , 
    .参数 从文件时间, 文件时间, , 
    .参数 到系统时间, 时间, , 

.DLL命令 DLL_置文件时间, 逻辑型, "", "SetFileTime", , 
    .参数 HANDLE, 整数型, , 
    .参数 lpCreationTime, 整数型, , 
    .参数 lpLastAccessTime, 整数型, , 
    .参数 lpLastWriteTime, 整数型, , 

.DLL命令 DLL_系统时间到文件时间, 逻辑型, "", "SystemTimeToFileTime", , 
    .参数 系统时间, 时间, , 
    .参数 文件时间, 文件时间, , 

.DLL命令 DLL_本地文件时间到文件时间, 逻辑型, "", "LocalFileTimeToFileTime", , 
    .参数 从本地文件时间, 文件时间, , 
    .参数 到文件时间, 文件时间, , 

.DLL命令 DLL_取错误文本信息, 整数型, "", "FormatMessageA", , 
    .参数 dwFlags, 整数型, , 
    .参数 lpSource, 整数型, , 
    .参数 dwMessageId, 整数型, , 
    .参数 dwLanguageId, 整数型, , 
    .参数 lpBuffer, 文本型, , 
    .参数 nSize, 整数型, , 
    .参数 Arguments, 整数型, , 

.DLL命令 DLL_取系统时间, 空白型, "", "GetSystemTime", , 
    .参数 系统时间, 时间, , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 目录, 文本型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
处理事件 ()
初始化 ()

.子程序 初始化, 空白型, , 
.局部变量 值, 整数型, , , 

.如果 (文件是否存在 (相加 (取运行目录 (), “\tlsy.ini”)))
    赋值 (值, 到数值 (读配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “窗口风格”, “3”)))
    .如果真 (等于 (值, 1))
        未知支持库函数_0 (1)
        赋值 (.选中, 真)
        连续赋值 (假, .选中, .选中, .选中)
    .如果真结束
    .如果真 (等于 (值, 2))
        未知支持库函数_5 (3)
        未知支持库函数_0 (1)
        
        连续赋值 (假, .选中, .选中, .选中)
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (值, 3))
        未知支持库函数_5 (1)
        未知支持库函数_0 (1)
        
        连续赋值 (假, .选中, .选中, .选中)
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (值, 4))
        未知支持库函数_5 (2)
        未知支持库函数_0 (1)
        
        连续赋值 (假, .选中, .选中, .选中)
        赋值 (.选中, 真)
    .如果真结束
    
.否则
    未知支持库函数_5 (3)
    未知支持库函数_0 (1)
    
    赋值 (.选中, 真)
.如果结束

读入文件类型设置 ()
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件类型读取”, “*.*|”))

赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件修改日期读取_年”, “100”))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件修改日期读取_月”, “1”))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件修改日期读取_日”, “1”))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件修改日期读取_年1”, “9999”))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件修改日期读取_月1”, “1”))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件修改日期读取_日1”, “1”))
赋值 (.现行选中项, 到数值 (读配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件大小读取”, “0”)))
赋值 (.内容, 读配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件大小字节”, “-1”))

赋值 (_启动窗口., “双狮文件修改助手1.1”)
_启动窗口.移动 (665, 500)
赋值 (_启动窗口., 1)
赋值 (_启动窗口., 1)
赋值 (., 1)
赋值 (撒消当前操作, 假)
未知支持库函数_0 (取窗口句柄 (), “如果所有项不选择，系统将不设置任何属性。”, 假, 假)
未知支持库函数_0 (取窗口句柄 (), 相加 (#左引号, “*”, #右引号, “为代表所有文件名,扩展名是以点”, #左引号, “.”, #右引号, “以后划分,如：.exe(可执行程序),”, #换行符, “.txt(文本文件),.ini(配置文件)等.”), 假, 假)
未知支持库函数_0 (取窗口句柄 (), “1024字节等1KB,1024KB等1MB”, 假, 假)
未知支持库函数_0 (取窗口句柄 (), 相加 (“重试次数不能为空,你如果不想修改失败时重试修改,请输入”, #左引号, “0”, #右引号), 假, 假)
未知支持库函数_0 (取窗口句柄 (), 相加 (#左引号, “前缀”, #右引号, “是文件名以”, #左引号, “.”, #右引号, “为界(软件.exe),左边为文件名,称前缀,右边为扩展名也称后缀.”), 假, 假)
未知支持库函数_0 (取窗口句柄 (), 相加 (#左引号, “前缀”, #右引号, “是文件名以”, #左引号, “.”, #右引号, “为界(软件.exe),左边为文件名,称前缀,右边为扩展名也称后缀.”), 假, 假)
未知支持库函数_0 (取窗口句柄 (), 相加 (“把（要替换的原文本）替换为（用作替换原文本的新文本）”, #右引号), 假, 假)
未知支持库函数_0 (取窗口句柄 (), 相加 (“如果要替换”, #左引号, “双狮软件.exe”, #右引号, “,要替换”, #左引号, “软件”, #右引号, “两个字为”, #左引号, “程序”, #右引号, “,在用作替换原文本的新文本框输入”, #左引号, “程序”, #右引号, #换行符, “在要替换的原文本框输入：”, #左引号, “软件”, #右引号, “两个字,”, “替换后的结果是:”, #左引号, “双狮程序.exe”, #右引号), 假, 假)
未知支持库函数_0 (取窗口句柄 (), “如果文件名内容为空,系统将不修改文件名!如果要修改,就要输入内容.”, 假, 假)
未知支持库函数_0 (取窗口句柄 (), “如果扩展名内容为空,系统将不修改扩展名!如果要修改,就要输入内容.”, 假, 假)
未知支持库函数_0 (取窗口句柄 (), 相加 (“字符位置:英文字符”, #左引号, “ABC”, #右引号, “他有3个字,字符有3个,从左边数起,0 A 1 B 2 C 3 ,”, #换行符, “而中文字符”, #左引号, “字为例”, #右引号, “他有3个字,每个中文字就有两个字符,共有6个,从左边数”, #换行符, “起,0字2为4例6 。”), 假, 真)
未知支持库函数_0 (取窗口句柄 (), 相加 (“如果在”, #左引号, “双狮工作室.exe”, #右引号, “插入字符:”, #左引号, “软件”, #右引号, “,插入字符位置:”, #左引号, “4”, #右引号, #换行符, “结果是:”, #左引号, “双狮软件工作室.exe”, #右引号), 假, 假)
未知支持库函数_0 (取窗口句柄 (), “有效值:1601--30827”, 假, 假)
未知支持库函数_0 (取窗口句柄 (), “有效值:1--12”, 假, 假)
未知支持库函数_0 (取窗口句柄 (), “有效值:1--31”, 假, 假)
未知支持库函数_0 (取窗口句柄 (), “有效值:0--23”, 假, 假)
未知支持库函数_0 (取窗口句柄 (), “有效值:0--59”, 假, 假)
未知支持库函数_0 (取窗口句柄 (), “有效值:0--59”, 假, 假)
未知支持库函数_0 (取窗口句柄 (), “有效值:0--999”, 假, 假)

.子程序 读入文件类型设置, 空白型, , 
.局部变量 选框, 选择框, , , 
.局部变量 i, 整数型, , , 
.局部变量 文本, 文本型, , , 
.局部变量 值, 整数型, , , 

连续赋值 (假, .选中, .选中, .选中, .选中, .选中)
.计次循环首 (6, i)
    赋值 (文本, 多项选择 (i, “文件读取_只读”, “文件读取_存档”, “文件读取_隐藏”, “文件读取_系统”, “文件读取_没属性”, “文件读取_所有属性”))
    赋值 (值, 到数值 (读配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, 文本, “0”)))
    .如果真 (并且 (大于或等于 (值, 1), 小于或等于 (值, 6)))
        .如果真 (等于 (值, 6))
            连续赋值 (假, .选中, .选中, .选中, .选中, .选中)
            连续赋值 (真, .禁止, .禁止, .禁止, .禁止, .禁止)
            
        .如果真结束
        赋值 (选框, 多项选择 (值, , , , , , ))
        赋值 (选框.选中, 真)
        
    .如果真结束
    
.计次循环尾 ()

.子程序 __启动窗口_尺寸被改变, 空白型, , 
处理事件 ()
.判断开始 (并且 (小于 (_启动窗口., 665), 小于 (_启动窗口., 500)))
    赋值 (_启动窗口., 665)
    赋值 (_启动窗口., 500)
.判断 (小于 (_启动窗口., 500))
    赋值 (_启动窗口., 500)
.判断 (小于 (_启动窗口., 665))
    赋值 (_启动窗口., 665)
.默认
    
.判断结束

10.移动 (10, 相减 (取用户区宽度 (), 463), 200)
相减 (取用户区宽度 (), 442).移动 (10, 430, 200)
10.移动 (相加 (., 20), 相减 (取用户区宽度 (), 20), 相减 (., ., 20))
0.移动 (0, 相减 (取用户区宽度 (), 20), 相减 (., ., 20))
0.移动 (0, 相减 (取用户区宽度 (), 20), 相减 (., ., 20))
0.移动 (0, 相减 (取用户区宽度 (), 20), 相减 (., ., 20))
1.置宽度 (取用户区宽度 ())
0.移动 (相减 (取用户区高度 (), 20), 取用户区宽度 (), 20)

.子程序 _目录树1_目录被选择, 空白型, , 
.参数 是否文件, 逻辑型, , 

.局部变量 文件名, 文本型, , , 
.局部变量 容器1, 整数型, , , 
.局部变量 扩展名, 文本型, , "0", 
.局部变量 计次变量, 整数型, , , 
.局部变量 文件属性, 整数型, , , 
.局部变量 临时文本, 文本型, , , 
.局部变量 系统时间, 时间, , , 
.局部变量 时间, 文本型, , , 
.局部变量 错误信息, 文本型, , , 
.局部变量 过滤器, 文本型, , , 
.局部变量 未过滤的全路径, 文本型, , "0", 
.局部变量 属性过滤后全路径, 文本型, , "0", 
.局部变量 大小过滤后全路径, 文本型, , "0", 
.局部变量 全部过滤后全路径, 文本型, , "0", 
.局部变量 文件时间, 时间, , , 
.局部变量 最小日期, 时间, , , 
.局部变量 最大日期, 时间, , , 
.局部变量 值, 整数型, , , 
.局部变量 文本, 文本型, , , 
.局部变量 只读文件, 逻辑型, , , 
.局部变量 存档文件, 逻辑型, , , 
.局部变量 隐藏文件, 逻辑型, , , 
.局部变量 系统文件, 逻辑型, , , 

置等待鼠标 ()
赋值 (目录, 未知支持库函数_1 ())
.如果真 (不等于 (取文本右边 (目录, 1), “\”))
    赋值 (目录, 相加 (目录, “\”))
.如果真结束
赋值 (过滤器, .内容)
赋值 (扩展名, 分割文本 (过滤器, “|”, ))

.变量循环首 (1, 取数组成员数 (扩展名), 1, 计次变量)
    赋值 (文件名, 寻找文件 (相加 (目录, 扩展名 [计次变量]), ))
    .判断循环首 (不等于 (文件名, “”))
        加入成员 (未过滤的全路径, 相加 (目录, 文件名))
        赋值 (文件名, 寻找文件 ())
    .判断循环尾 ()
    
.变量循环尾 ()
.如果 (等于 (.选中, 真))
    .计次循环首 (取数组成员数 (未过滤的全路径), 计次变量)
        加入成员 (全部过滤后全路径, 未过滤的全路径 [计次变量])
    .计次循环尾 ()
.否则
    .计次循环首 (取数组成员数 (未过滤的全路径), 计次变量)
        连续赋值 (假, 只读文件, 存档文件, 隐藏文件, 系统文件)
        赋值 (文件属性, 取文件属性 (未过滤的全路径 [计次变量]))
        .如果真 (等于 (.选中, 真))
            .如果真 (不等于 (位与 (文件属性, #只读文件), 0))
                赋值 (只读文件, 真)
                .如果真 (等于 (位与 (文件属性, #只读文件), #只读文件))
                    加入成员 (属性过滤后全路径, 未过滤的全路径 [计次变量])
                    输出调试文本 (“只读文件”)
                .如果真结束
                
            .如果真结束
            
        .如果真结束
        .如果真 (等于 (.选中, 真))
            .如果真 (不等于 (位与 (文件属性, #存档文件), 0))
                赋值 (存档文件, 真)
                .如果真 (等于 (位与 (文件属性, #存档文件), #存档文件))
                    加入成员 (属性过滤后全路径, 未过滤的全路径 [计次变量])
                    输出调试文本 (“存档文件”)
                    
                .如果真结束
                
            .如果真结束
            
        .如果真结束
        .如果真 (等于 (.选中, 真))
            .如果真 (不等于 (位与 (文件属性, #隐藏文件), 0))
                赋值 (隐藏文件, 真)
                .如果真 (等于 (位与 (文件属性, #隐藏文件), #隐藏文件))
                    加入成员 (属性过滤后全路径, 未过滤的全路径 [计次变量])
                    输出调试文本 (“隐藏文件”)
                    
                .如果真结束
                
            .如果真结束
            
        .如果真结束
        .如果真 (等于 (.选中, 真))
            .如果真 (不等于 (位与 (文件属性, #系统文件), 0))
                赋值 (系统文件, 真)
                .如果真 (等于 (位与 (文件属性, #系统文件), #系统文件))
                    加入成员 (属性过滤后全路径, 未过滤的全路径 [计次变量])
                    输出调试文本 (“系统文件”)
                    
                .如果真结束
                
            .如果真结束
            
        .如果真结束
        .如果真 (等于 (.选中, 真))
            .如果真 (等于 (文件属性, 0))
                加入成员 (属性过滤后全路径, 未过滤的全路径 [计次变量])
                输出调试文本 (“未知文件”)
                
            .如果真结束
            
        .如果真结束
        
        .如果真 (并且 (等于 (只读文件, 真), 等于 (存档文件, 真)))
            加入成员 (属性过滤后全路径, 未过滤的全路径 [计次变量])
        .如果真结束
        .如果真 (并且 (等于 (只读文件, 真), 等于 (隐藏文件, 真)))
            加入成员 (属性过滤后全路径, 未过滤的全路径 [计次变量])
        .如果真结束
        .如果真 (并且 (等于 (只读文件, 真), 等于 (系统文件, 真)))
            加入成员 (属性过滤后全路径, 未过滤的全路径 [计次变量])
        .如果真结束
        .如果真 (并且 (等于 (存档文件, 真), 等于 (隐藏文件, 真)))
            加入成员 (属性过滤后全路径, 未过滤的全路径 [计次变量])
        .如果真结束
        .如果真 (并且 (等于 (存档文件, 真), 等于 (系统文件, 真)))
            加入成员 (属性过滤后全路径, 未过滤的全路径 [计次变量])
        .如果真结束
        .如果真 (并且 (等于 (隐藏文件, 真), 等于 (系统文件, 真)))
            加入成员 (属性过滤后全路径, 未过滤的全路径 [计次变量])
        .如果真结束
        .如果真 (并且 (等于 (只读文件, 真), 等于 (存档文件, 真), 等于 (隐藏文件, 真)))
            加入成员 (属性过滤后全路径, 未过滤的全路径 [计次变量])
        .如果真结束
        .如果真 (并且 (等于 (只读文件, 真), 等于 (存档文件, 真), 等于 (系统文件, 真)))
            加入成员 (属性过滤后全路径, 未过滤的全路径 [计次变量])
        .如果真结束
        .如果真 (并且 (等于 (只读文件, 真), 等于 (隐藏文件, 真), 等于 (系统文件, 真)))
            加入成员 (属性过滤后全路径, 未过滤的全路径 [计次变量])
        .如果真结束
        .如果真 (并且 (等于 (存档文件, 真), 等于 (隐藏文件, 真), 等于 (系统文件, 真)))
            加入成员 (属性过滤后全路径, 未过滤的全路径 [计次变量])
        .如果真结束
        .如果真 (并且 (等于 (只读文件, 真), 等于 (存档文件, 真), 等于 (隐藏文件, 真), 等于 (系统文件, 真)))
            加入成员 (属性过滤后全路径, 未过滤的全路径 [计次变量])
        .如果真结束
        
    .计次循环尾 ()
    输出调试文本 (相加 (“属性过滤后全路径”, 到文本 (取数组成员数 (属性过滤后全路径))))
    
    .计次循环首 (取数组成员数 (属性过滤后全路径), 计次变量)
        .如果 (等于 (.现行选中项, 0))
            .如果真 (大于 (取文件尺寸 (属性过滤后全路径 [计次变量]), 到数值 (.内容)))
                加入成员 (大小过滤后全路径, 属性过滤后全路径 [计次变量])
            .如果真结束
            
        .否则
            .如果真 (小于 (取文件尺寸 (属性过滤后全路径 [计次变量]), 到数值 (.内容)))
                加入成员 (大小过滤后全路径, 属性过滤后全路径 [计次变量])
            .如果真结束
            
        .如果结束
        
    .计次循环尾 ()
    输出调试文本 (相加 (“大小过滤后全路径”, 到文本 (取数组成员数 (大小过滤后全路径))))
    赋值 (最小日期.年, 到数值 (.内容))
    赋值 (最小日期.月, 到数值 (.内容))
    赋值 (最小日期.日, 到数值 (.内容))
    赋值 (最大日期.年, 到数值 (.内容))
    赋值 (最大日期.月, 到数值 (.内容))
    赋值 (最大日期.日, 到数值 (.内容))
    输出调试文本 (相加 (到文本 (最小日期.年), 到文本 (最小日期.月), 到文本 (最小日期.日)))
    输出调试文本 (相加 (到文本 (最大日期.年), 到文本 (最大日期.月), 到文本 (最大日期.日)))
    .计次循环首 (取数组成员数 (大小过滤后全路径), 计次变量)
        赋值 (文件时间.年, 到数值 (到文本 (取年份 (取文件时间 (大小过滤后全路径 [计次变量])))))
        赋值 (文件时间.月, 到数值 (到文本 (取月份 (取文件时间 (大小过滤后全路径 [计次变量])))))
        赋值 (文件时间.日, 到数值 (到文本 (取日 (取文件时间 (大小过滤后全路径 [计次变量])))))
        输出调试文本 (相加 (到文本 (文件时间.年), 到文本 (文件时间.月), 到文本 (文件时间.日)))
        .如果真 (并且 (大于或等于 (文件时间.年, 最小日期.年), 小于或等于 (文件时间.年, 最大日期.年)))
            .如果 (或者 (等于 (文件时间.年, 最小日期.年), 等于 (文件时间.年, 最大日期.年)))
                .如果真 (并且 (大于或等于 (文件时间.月, 最小日期.月), 小于或等于 (文件时间.月, 最大日期.月)))
                    .如果 (或者 (等于 (文件时间.月, 最小日期.月), 等于 (文件时间.月, 最大日期.月)))
                        .如果真 (并且 (大于或等于 (文件时间.日, 最小日期.日), 小于或等于 (文件时间.日, 最大日期.日)))
                            加入成员 (全部过滤后全路径, 大小过滤后全路径 [计次变量])
                            
                        .如果真结束
                        
                    .否则
                        加入成员 (全部过滤后全路径, 大小过滤后全路径 [计次变量])
                    .如果结束
                    
                .如果真结束
                
            .否则
                加入成员 (全部过滤后全路径, 大小过滤后全路径 [计次变量])
            .如果结束
            
        .如果真结束
        
    .计次循环尾 ()
    输出调试文本 (相加 (“全部过滤后全路径”, 到文本 (取数组成员数 (全部过滤后全路径))))
    
.如果结束

.如果真 (等于 (., 1))
    全部删除 ()
    .计次循环首 (取数组成员数 (全部过滤后全路径), 计次变量)
        赋值 (文本, 全部过滤后全路径 [计次变量])
        赋值 (值, 倒找文本 (文本, “\”, , 真))
        赋值 (文件名, 取文本右边 (文本, 相减 (取文本长度 (文本), 值)))
        .如果真 (不等于 (文件名, “”))
            处理事件 ()
            赋值 (容器1, .插入表项 (文件名, , , , ))
            容器1.置标题 (1, 文本)
            赋值 (文件属性, 取文件属性 (文本))
            .如果真 (不等于 (位与 (文件属性, #子目录), 0))
                赋值 (临时文本, 相加 (临时文本, “文件夹.”))
            .如果真结束
            .如果真 (不等于 (位与 (文件属性, #只读文件), 0))
                赋值 (临时文本, 相加 (临时文本, “只读文件.”))
            .如果真结束
            .如果真 (不等于 (位与 (文件属性, #存档文件), 0))
                赋值 (临时文本, 相加 (临时文本, “存档文件.”))
            .如果真结束
            .如果真 (不等于 (位与 (文件属性, #隐藏文件), 0))
                赋值 (临时文本, 相加 (临时文本, “隐藏文件.”))
            .如果真结束
            .如果真 (不等于 (位与 (文件属性, #系统文件), 0))
                赋值 (临时文本, 相加 (临时文本, “系统文件.”))
            .如果真结束
            .如果真 (等于 (文件属性, -1))
                赋值 (临时文本, 相加 (临时文本, “取文件属性失败.”))
            .如果真结束
            .如果真 (等于 (文件属性, 0))
                赋值 (临时文本, 相加 (临时文本, “未置文件属性.”))
            .如果真结束
            容器1.置标题 (2, 临时文本)
            赋值 (临时文本, “”)
        .如果真结束
        
    .计次循环尾 ()
    1.置文本 (相加 (“读入”, #左引号, 目录, #右引号, “目录文件数：”, 到文本 (取表项数 ()), “个”))
.如果真结束
.如果真 (等于 (., 2))
    全部删除 ()
    .计次循环首 (取数组成员数 (全部过滤后全路径), 计次变量)
        赋值 (文本, 全部过滤后全路径 [计次变量])
        赋值 (值, 倒找文本 (文本, “\”, , 真))
        赋值 (文件名, 取文本右边 (文本, 相减 (取文本长度 (文本), 值)))
        .如果真 (不等于 (文件名, “”))
            处理事件 ()
            赋值 (容器1, .插入表项 (文件名, , , , ))
            容器1.置标题 (2, 文本)
            容器1.置标题 (3, “否”)
        .如果真结束
        
    .计次循环尾 ()
    1.置文本 (相加 (“读入”, #左引号, 目录, #右引号, “目录文件数：”, 到文本 (取表项数 ()), “个”))
.如果真结束
.如果真 (等于 (., 3))
    全部删除 ()
    .计次循环首 (取数组成员数 (全部过滤后全路径), 计次变量)
        赋值 (文本, 全部过滤后全路径 [计次变量])
        赋值 (值, 倒找文本 (文本, “\”, , 真))
        赋值 (文件名, 取文本右边 (文本, 相减 (取文本长度 (文本), 值)))
        .如果真 (不等于 (文件名, “”))
            处理事件 ()
            赋值 (容器1, .插入表项 (文件名, , , , ))
            容器1.置标题 (4, 文本)
            .计次循环首 (3, 计次变量)
                .如果真 (并且 (读文件时间 (文本, 系统时间, 相减 (计次变量, 1), 错误信息), 等于 (计次变量, 1)))
                    填充文件时间 (系统时间, 时间)
                    容器1.置标题 (1, 时间)
                .如果真结束
                .如果真 (并且 (读文件时间 (文本, 系统时间, 相减 (计次变量, 1), 错误信息), 等于 (计次变量, 2)))
                    填充文件时间 (系统时间, 时间)
                    容器1.置标题 (2, 时间)
                .如果真结束
                .如果真 (并且 (读文件时间 (文本, 系统时间, 相减 (计次变量, 1), 错误信息), 等于 (计次变量, 3)))
                    填充文件时间 (系统时间, 时间)
                    容器1.置标题 (3, 时间)
                .如果真结束
                容器1.置标题 (5, 错误信息)
            .计次循环尾 ()
        .如果真结束
        
    .计次循环尾 ()
    1.置文本 (相加 (“读入”, #左引号, 目录, #右引号, “目录文件数：”, 到文本 (取表项数 ()), “个”))
.如果真结束

恢复鼠标 ()

.子程序 填充文件时间, 空白型, , 
.参数 取系统时间, 时间, , 
.参数 时间, 文本型, , 

赋值 (时间, 相加 (到文本 (取系统时间.年), “年”, 到文本 (取系统时间.月), “月”, 到文本 (取系统时间.日), “日”, “星期”, 取文本中间 (#文_星期, 相加 (相乘 (取系统时间.星期, 2), 1), 2), 到文本 (取系统时间.小时), “小时”, 到文本 (取系统时间.分钟), “分钟”, 到文本 (取系统时间.秒), “秒”, 到文本 (取系统时间.毫秒), “毫秒”))

.子程序 _设置选择夹_子夹被改变, 空白型, , 
.如果真 (等于 (., 1))
    赋值 (.现行子夹, 0)
.如果真结束
.如果真 (等于 (., 2))
    赋值 (.现行子夹, 1)
.如果真结束
.如果真 (等于 (., 3))
    赋值 (.现行子夹, 2)
.如果真结束
1.置文本 (“”)

.子程序 _修改属性按钮_被单击, 空白型, , 
.局部变量 重试次数, 整数型, , , 
.局部变量 变量, 整数型, , , 
.局部变量 只读文件, 整数型, , , 
.局部变量 存档文件, 整数型, , , 
.局部变量 隐藏文件, 整数型, , , 
.局部变量 系统文件, 整数型, , , 
.局部变量 索引数组, 整数型, , "0", 
.局部变量 计次变量, 整数型, , , 
.局部变量 全路径, 文本型, , , 
.局部变量 临时全路径组, 文本型, , "0", 
.局部变量 临时文件名组, 文本型, , "0", 
.局部变量 是否置文件属性, 逻辑型, , , 
.局部变量 属性值, 整数型, , , 

.如果 (.选中)
    赋值 (系统文件, #系统文件)
.否则
    赋值 (系统文件, 0) ' 属性值为零,不设置此属性值.
.如果结束
.如果 (.选中)
    赋值 (隐藏文件, #隐藏文件)
.否则
    赋值 (隐藏文件, 0) ' 属性值为零,不设置此属性值.
.如果结束
.如果 (.选中)
    赋值 (存档文件, #存档文件)
.否则
    赋值 (存档文件, 0) ' 属性值为零,不设置此属性值.
.如果结束
.如果 (.选中)
    赋值 (只读文件, #只读文件)
.否则
    赋值 (只读文件, 0) ' 属性值为零,不设置此属性值.
.如果结束
.如果真 (等于 (取表项数 (), 0))
    信息框 (“未载入要修改的文件！”, 48, )
    返回 ()
.如果真结束
1.置文本 (“开始修改文件属性,请你耐心等待!如果修改文件越多,等待的时间越久!”)
清除数组 (撒消_属性值)
清除数组 (撒消_属性路径)
.如果真 (等于 (.选中, 真))
    .如果真 (等于 (取已选择表项数 (), 0))
        信息框 (“未选择文件！  说明：选中的文件将修改属性，可以多项选择。”, 48, )
        返回 ()
    .如果真结束
    赋值 (索引数组, 取被选择表项 ())
    .计次循环首 (取数组成员数 (索引数组), 计次变量)
        加入成员 (临时全路径组, 索引数组.取标题 ( [计次变量], 1))
        加入成员 (临时文件名组, 索引数组.取标题 ( [计次变量], 0))
    .计次循环尾 ()
    .计次循环首 (取数组成员数 (临时全路径组), 计次变量)
        赋值 (全路径, 临时全路径组 [计次变量])
        赋值 (属性值, 取文件属性 (全路径))
        加入成员 (撒消_属性值, 属性值)
        .如果真 (等于 (置文件属性 (全路径, 相加 (系统文件, 隐藏文件, 存档文件, 只读文件)), 假))
            信息框 (相加 (“置文件”, #左引号, 临时文件名组 [计次变量], #右引号, “属性失败！”), 48, “失败”)
            .计次循环首 (到数值 (.内容), 重试次数)
                .如果真 (等于 (置文件属性 (全路径, 相加 (系统文件, 隐藏文件, 存档文件, 只读文件)), 假))
                    .如果真 (等于 (信息框 (相加 (“重置文件”, #左引号, 临时文件名组 [计次变量], #右引号, “属性失败！”), 相加 (#错误图标, #是否钮), 相加 (“已重试修改次数：”, 到文本 (重试次数))), #否钮))
                        跳出循环 ()
                    .如果真结束
                    
                .如果真结束
                
            .计次循环尾 ()
            到循环尾 ()
        .如果真结束
        1.置文本 (相加 (“置文件属性：”, 全路径))
        加入成员 (撒消_属性路径, 全路径)
    .计次循环尾 ()
    赋值 (撒消_值, 1)
    赋值 (撒消当前操作, 真)
    信息框 (“置文件属性完毕！”, 64, )
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果真 (等于 (取已选择表项数 (), 0))
        信息框 (“未选择不修改的文件！ 说明：选中的文件将不修改属性，可以多项选择。”, 48, )
        返回 ()
    .如果真结束
    赋值 (索引数组, 取被选择表项 ())
    .计次循环首 (取表项数 (), 变量)
        赋值 (是否置文件属性, 真)
        .计次循环首 (取数组成员数 (索引数组), 计次变量)
            .如果真 (等于 (索引数组 [计次变量], 相减 (变量, 1)))
                赋值 (是否置文件属性, 假)
                跳出循环 ()
            .如果真结束
            
        .计次循环尾 ()
        .如果真 (等于 (是否置文件属性, 真))
            赋值 (全路径, 相减 (变量, 1).取标题 (1))
            赋值 (属性值, 取文件属性 (全路径))
            加入成员 (撒消_属性值, 属性值)
            .如果真 (等于 (置文件属性 (全路径, 相加 (系统文件, 隐藏文件, 存档文件, 只读文件)), 假))
                信息框 (相加 (“置文件”, #左引号, 相减 (变量, 1).取标题 (0), #右引号, “属性失败！”), 48, “失败”)
                .计次循环首 (到数值 (.内容), 重试次数)
                    .如果真 (等于 (置文件属性 (全路径, 相加 (系统文件, 隐藏文件, 存档文件, 只读文件)), 假))
                        .如果真 (等于 (信息框 (相加 (“重置文件”, #左引号, 相减 (变量, 1).取标题 (0), #右引号, “属性失败！”), 相加 (#错误图标, #是否钮), 相加 (“已重试修改次数：”, 到文本 (重试次数))), #否钮))
                            跳出循环 ()
                        .如果真结束
                        
                    .如果真结束
                    
                .计次循环尾 ()
                到循环尾 ()
            .如果真结束
            加入成员 (撒消_属性路径, 全路径)
            1.置文本 (相加 (“置文件属性：”, 全路径))
        .如果真结束
        
    .计次循环尾 ()
    赋值 (撒消_值, 1)
    赋值 (撒消当前操作, 真)
    信息框 (“置文件属性完毕！”, 64, )
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .计次循环首 (取表项数 (), 变量)
        赋值 (全路径, 相减 (变量, 1).取标题 (1))
        赋值 (属性值, 取文件属性 (全路径))
        加入成员 (撒消_属性值, 属性值)
        .如果真 (等于 (置文件属性 (全路径, 相加 (系统文件, 隐藏文件, 存档文件, 只读文件)), 假))
            信息框 (相加 (“置文件”, #左引号, 相减 (变量, 1).取标题 (0), #右引号, “属性失败！”), 48, “失败”)
            .计次循环首 (到数值 (.内容), 重试次数)
                .如果真 (等于 (置文件属性 (全路径, 相加 (系统文件, 隐藏文件, 存档文件, 只读文件)), 假))
                    .如果真 (等于 (信息框 (相加 (“重置文件”, #左引号, 相减 (变量, 1).取标题 (0), #右引号, “属性失败！”), 相加 (#错误图标, #是否钮), 相加 (“已重试修改次数：”, 到文本 (重试次数))), #否钮))
                        跳出循环 ()
                    .如果真结束
                    
                .如果真结束
                
            .计次循环尾 ()
            到循环尾 ()
        .如果真结束
        相减 (变量, 1).选择表项 ()
        加入成员 (撒消_属性路径, 全路径)
        1.置文本 (相加 (“置文件属性：”, 全路径))
    .计次循环尾 ()
    赋值 (撒消_值, 1)
    赋值 (撒消当前操作, 真)
    信息框 (“置文件属性完毕！”, 64, )
    
.如果真结束


.子程序 _文件属性列表框_右键单击表项, 空白型, , 
弹出菜单 ()

.子程序 _文件名列表框_右键单击表项, 空白型, , 
弹出菜单 ()

.子程序 _文件时间列表框_右键单击表项, 空白型, , 
弹出菜单 ()

.子程序 _修改文件名按钮_被单击, 空白型, , 
.局部变量 计次变量, 整数型, , , 
.局部变量 全路径, 文本型, , , 
.局部变量 扩展名, 文本型, , , 
.局部变量 值, 整数型, , , 
.局部变量 值1, 整数型, , , 
.局部变量 重试次数, 整数型, , , 
.局部变量 文件名, 文本型, , , 
.局部变量 更名, 文本型, , , 
.局部变量 文本, 文本型, , , 
.局部变量 索引数组, 整数型, , "0", 
.局部变量 临时全路径组, 文本型, , "0", 
.局部变量 临时文件名组, 文本型, , "0", 
.局部变量 是否置文件名, 逻辑型, , , 
.局部变量 变量, 整数型, , , 
.局部变量 返回值, 整数型, , , 

.如果真 (等于 (取表项数 (), 0))
    信息框 (“未载入要修改的文件！”, 48, )
    返回 ()
.如果真结束
.如果真 (并且 (等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假)))
    信息框 (相加 (“未选择要修改文件名的方式！”, #换行符, “修改文件名方式：1.局部修改 2.替换修改 3.字符插入修改”), 48, )
    返回 ()
.如果真结束
1.置文本 (“开始修改文件名,请你耐心等待!如果修改文件越多,等待的时间越久!”)
清除数组 (撒消_旧更名)
清除数组 (撒消_新更名)
.如果真 (等于 (.选中, 真))
    .如果真 (等于 (.选中, 真))
        .如果真 (等于 (取已选择表项数 (), 0))
            信息框 (“未选择文件！  说明：选中的文件将修改名，可以多项选择。”, 48, )
            返回 ()
        .如果真结束
        赋值 (索引数组, 取被选择表项 ())
        .计次循环首 (取数组成员数 (索引数组), 计次变量)
            加入成员 (临时全路径组, 索引数组.取标题 ( [计次变量], 2))
            加入成员 (临时文件名组, 索引数组.取标题 ( [计次变量], 0))
        .计次循环尾 ()
        .计次循环首 (取数组成员数 (临时全路径组), 计次变量)
            赋值 (全路径, 临时全路径组 [计次变量])
            .如果 (不等于 (.内容, “”))
                赋值 (文件名, .内容)
                赋值 (文件名, 相加 (文件名, “(”, 到文本 (计次变量), “)”))
            .否则
                赋值 (文本, 临时文件名组 [计次变量])
                赋值 (值, 寻找文本 (文本, “.”, , 真))
                赋值 (文件名, 取文本左边 (文本, 相减 (值, 1)))
            .如果结束
            .如果 (不等于 (.内容, “”))
                赋值 (扩展名, .内容)
            .否则
                赋值 (文本, 临时文件名组 [计次变量])
                赋值 (值1, 寻找文本 (文本, “.”, , 真))
                赋值 (扩展名, 取文本右边 (文本, 相减 (取文本长度 (文本), 值1)))
            .如果结束
            赋值 (更名, 相加 (目录, 文件名, “.”, 扩展名))
            .如果真 (等于 (文件更名 (全路径, 更名), 假))
                .如果 (等于 (文件是否存在 (更名), 真))
                    信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败！错误原因：指定文件名与现有文件名重名。请指定另一文件名。”), #错误图标, “错误”)
                    返回 ()
                .否则
                    信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败！错误原因未知！”), #错误图标, “错误”)
                .如果结束
                .计次循环首 (到数值 (.内容), 重试次数)
                    .如果真 (等于 (文件更名 (全路径, 更名), 假))
                        赋值 (返回值, 信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败!”), 相加 (#错误图标, #放弃重试忽略钮), 相加 (“已重试修改次数:”, 到文本 (重试次数))))
                        .如果真 (等于 (返回值, 2))
                            索引数组.置标题 ( [计次变量], 3, “失败”)
                            返回 ()
                        .如果真结束
                        .如果真 (等于 (返回值, 4))
                            索引数组.置标题 ( [计次变量], 3, “失败”)
                            跳出循环 ()
                        .如果真结束
                        
                    .如果真结束
                    
                .计次循环尾 ()
            .如果真结束
            索引数组.置标题 ( [计次变量], 1, 更名)
            索引数组.置标题 ( [计次变量], 3, “成功”)
            1.置文本 (相加 (“置修改文件名：”, 全路径))
            加入成员 (撒消_旧更名, 全路径)
            加入成员 (撒消_新更名, 更名)
        .计次循环尾 ()
        赋值 (撒消_值, 2)
        赋值 (撒消当前操作, 真)
        信息框 (“修改完毕!”, 64, )
        
    .如果真结束
    .如果真 (等于 (.选中, 真))
        .计次循环首 (取表项数 (), 计次变量)
            赋值 (全路径, 相减 (计次变量, 1).取标题 (2))
            .如果 (不等于 (.内容, “”))
                赋值 (文件名, .内容)
                赋值 (文件名, 相加 (文件名, “(”, 到文本 (计次变量), “)”))
            .否则
                赋值 (文本, 相减 (计次变量, 1).取标题 (0))
                赋值 (值, 寻找文本 (文本, “.”, , 真))
                赋值 (文件名, 取文本左边 (文本, 相减 (值, 1)))
            .如果结束
            .如果 (不等于 (.内容, “”))
                赋值 (扩展名, .内容)
            .否则
                赋值 (文本, 相减 (计次变量, 1).取标题 (0))
                赋值 (值1, 寻找文本 (文本, “.”, , 真))
                赋值 (扩展名, 取文本右边 (文本, 相减 (取文本长度 (文本), 值1)))
            .如果结束
            赋值 (更名, 相加 (目录, 文件名, “.”, 扩展名))
            .如果真 (等于 (文件更名 (全路径, 更名), 假))
                .如果 (等于 (文件是否存在 (更名), 真))
                    信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败！错误原因：指定文件名与现有文件名重名。请指定另一文件名。”), #错误图标, “错误”)
                    返回 ()
                .否则
                    信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败！错误原因未知！”), #错误图标, “错误”)
                .如果结束
                .计次循环首 (到数值 (.内容), 重试次数)
                    .如果真 (等于 (文件更名 (全路径, 更名), 假))
                        赋值 (返回值, 信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败!”), 相加 (#错误图标, #放弃重试忽略钮), 相加 (“已重试修改次数:”, 到文本 (重试次数))))
                        .如果真 (等于 (返回值, 2))
                            相减 (计次变量, 1).置标题 (3, “失败”)
                            返回 ()
                        .如果真结束
                        .如果真 (等于 (返回值, 4))
                            相减 (计次变量, 1).置标题 (3, “失败”)
                            跳出循环 ()
                        .如果真结束
                        
                    .如果真结束
                    
                .计次循环尾 ()
            .如果真结束
            相减 (计次变量, 1).置标题 (1, 更名)
            相减 (计次变量, 1).置标题 (3, “成功”)
            1.置文本 (相加 (“置修改文件名：”, 全路径))
            加入成员 (撒消_旧更名, 全路径)
            加入成员 (撒消_新更名, 更名)
        .计次循环尾 ()
        赋值 (撒消_值, 2)
        赋值 (撒消当前操作, 真)
        信息框 (“修改完毕!”, 64, )
        
    .如果真结束
    .如果真 (等于 (.选中, 真))
        .如果真 (等于 (取已选择表项数 (), 0))
            信息框 (“未选择不修改的文件！ 说明：选中的文件将不修改名，可以多项选择。”, 48, )
            返回 ()
        .如果真结束
        赋值 (索引数组, 取被选择表项 ())
        .计次循环首 (取表项数 (), 变量)
            赋值 (是否置文件名, 真)
            .计次循环首 (取数组成员数 (索引数组), 计次变量)
                .如果真 (等于 (索引数组 [计次变量], 相减 (变量, 1)))
                    赋值 (是否置文件名, 假)
                    跳出循环 ()
                .如果真结束
                
            .计次循环尾 ()
            .如果真 (等于 (是否置文件名, 真))
                赋值 (全路径, 相减 (变量, 1).取标题 (2))
                .如果 (不等于 (.内容, “”))
                    赋值 (文件名, .内容)
                    赋值 (文件名, 相加 (文件名, “(”, 到文本 (变量), “)”))
                .否则
                    赋值 (文本, 相减 (变量, 1).取标题 (0))
                    赋值 (值, 寻找文本 (文本, “.”, , 真))
                    赋值 (文件名, 取文本左边 (文本, 相减 (值, 1)))
                .如果结束
                .如果 (不等于 (.内容, “”))
                    赋值 (扩展名, .内容)
                .否则
                    赋值 (文本, 相减 (变量, 1).取标题 (0))
                    赋值 (值1, 寻找文本 (文本, “.”, , 真))
                    赋值 (扩展名, 取文本右边 (文本, 相减 (取文本长度 (文本), 值1)))
                .如果结束
                赋值 (更名, 相加 (目录, 文件名, “.”, 扩展名))
                .如果真 (等于 (文件更名 (全路径, 更名), 假))
                    .如果 (等于 (文件是否存在 (更名), 真))
                        信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败！错误原因：指定文件名与现有文件名重名。请指定另一文件名。”), #错误图标, “错误”)
                        返回 ()
                    .否则
                        信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败！错误原因未知！”), #错误图标, “错误”)
                    .如果结束
                    .计次循环首 (到数值 (.内容), 重试次数)
                        .如果真 (等于 (文件更名 (全路径, 更名), 假))
                            赋值 (返回值, 信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败!”), 相加 (#错误图标, #放弃重试忽略钮), 相加 (“已重试修改次数:”, 到文本 (重试次数))))
                            .如果真 (等于 (返回值, 2))
                                相减 (变量, 1).置标题 (3, “失败”)
                                返回 ()
                            .如果真结束
                            .如果真 (等于 (返回值, 4))
                                相减 (变量, 1).置标题 (3, “失败”)
                                跳出循环 ()
                            .如果真结束
                            
                        .如果真结束
                        
                    .计次循环尾 ()
                .如果真结束
                相减 (变量, 1).置标题 (1, 更名)
                相减 (变量, 1).置标题 (3, “成功”)
                1.置文本 (相加 (“置修改文件名：”, 全路径))
                加入成员 (撒消_旧更名, 全路径)
                加入成员 (撒消_新更名, 更名)
            .如果真结束
            
        .计次循环尾 ()
        赋值 (撒消_值, 2)
        赋值 (撒消当前操作, 真)
        信息框 (“修改完毕!”, 64, )
        
    .如果真结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果真 (并且 (等于 (.内容, “”), 等于 (.内容, “”)))
        信息框 (“字符位置或插入内容的未填写！  ”, 48, )
        返回 ()
    .如果真结束
    .如果真 (等于 (.选中, 真))
        .如果真 (等于 (取已选择表项数 (), 0))
            信息框 (“未选择文件！  说明：选中的文件将修改名，可以多项选择。”, 48, )
            返回 ()
        .如果真结束
        赋值 (索引数组, 取被选择表项 ())
        .计次循环首 (取数组成员数 (索引数组), 计次变量)
            加入成员 (临时全路径组, 索引数组.取标题 ( [计次变量], 2))
            加入成员 (临时文件名组, 索引数组.取标题 ( [计次变量], 0))
        .计次循环尾 ()
        .计次循环首 (取数组成员数 (临时全路径组), 计次变量)
            赋值 (全路径, 临时全路径组 [计次变量])
            赋值 (文本, 临时文件名组 [计次变量])
            赋值 (值, 寻找文本 (文本, “.”, , 真))
            赋值 (文件名, 取文本左边 (文本, 相减 (值, 1)))
            赋值 (值1, 寻找文本 (文本, “.”, , 真))
            赋值 (扩展名, 取文本右边 (文本, 相减 (取文本长度 (文本), 值1)))
            赋值 (文件名, 文本替换 (文件名, 到数值 (.内容), 0, 到文本 (.内容)))
            赋值 (更名, 相加 (目录, 文件名, “.”, 扩展名))
            .如果真 (等于 (文件更名 (全路径, 更名), 假))
                .如果 (等于 (文件是否存在 (更名), 真))
                    信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败！错误原因：指定文件名与现有文件名重名。请指定另一文件名。”), #错误图标, “错误”)
                    返回 ()
                .否则
                    信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败！错误原因未知！”), #错误图标, “错误”)
                .如果结束
                .计次循环首 (到数值 (.内容), 重试次数)
                    .如果真 (等于 (文件更名 (全路径, 更名), 假))
                        赋值 (返回值, 信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败!”), 相加 (#错误图标, #放弃重试忽略钮), 相加 (“已重试修改次数:”, 到文本 (重试次数))))
                        .如果真 (等于 (返回值, 2))
                            索引数组.置标题 ( [计次变量], 3, “失败”)
                            返回 ()
                        .如果真结束
                        .如果真 (等于 (返回值, 4))
                            索引数组.置标题 ( [计次变量], 3, “失败”)
                            跳出循环 ()
                        .如果真结束
                        
                    .如果真结束
                    
                .计次循环尾 ()
            .如果真结束
            索引数组.置标题 ( [计次变量], 1, 更名)
            索引数组.置标题 ( [计次变量], 3, “成功”)
            1.置文本 (相加 (“置修改文件名：”, 全路径))
            加入成员 (撒消_旧更名, 全路径)
            加入成员 (撒消_新更名, 更名)
        .计次循环尾 ()
        赋值 (撒消_值, 2)
        赋值 (撒消当前操作, 真)
        信息框 (“修改完毕!”, 64, )
        
    .如果真结束
    .如果真 (等于 (.选中, 真))
        .计次循环首 (取表项数 (), 计次变量)
            赋值 (全路径, 相减 (计次变量, 1).取标题 (2))
            赋值 (文本, 相减 (计次变量, 1).取标题 (0))
            赋值 (值, 寻找文本 (文本, “.”, , 真))
            赋值 (文件名, 取文本左边 (文本, 相减 (值, 1)))
            赋值 (值1, 寻找文本 (文本, “.”, , 真))
            赋值 (扩展名, 取文本右边 (文本, 相减 (取文本长度 (文本), 值1)))
            赋值 (文件名, 文本替换 (文件名, 到数值 (.内容), 0, 到文本 (.内容)))
            赋值 (更名, 相加 (目录, 文件名, “.”, 扩展名))
            .如果真 (等于 (文件更名 (全路径, 更名), 假))
                .如果 (等于 (文件是否存在 (更名), 真))
                    信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败！错误原因：指定文件名与现有文件名重名。请指定另一文件名。”), #错误图标, “错误”)
                    返回 ()
                .否则
                    信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败！错误原因未知！”), #错误图标, “错误”)
                .如果结束
                .计次循环首 (到数值 (.内容), 重试次数)
                    .如果真 (等于 (文件更名 (全路径, 更名), 假))
                        赋值 (返回值, 信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败!”), 相加 (#错误图标, #放弃重试忽略钮), 相加 (“已重试修改次数:”, 到文本 (重试次数))))
                        .如果真 (等于 (返回值, 2))
                            相减 (计次变量, 1).置标题 (3, “失败”)
                            返回 ()
                        .如果真结束
                        .如果真 (等于 (返回值, 4))
                            相减 (计次变量, 1).置标题 (3, “失败”)
                            跳出循环 ()
                        .如果真结束
                        
                    .如果真结束
                    
                .计次循环尾 ()
            .如果真结束
            相减 (计次变量, 1).置标题 (1, 更名)
            相减 (计次变量, 1).置标题 (3, “成功”)
            1.置文本 (相加 (“置修改文件名：”, 全路径))
            加入成员 (撒消_旧更名, 全路径)
            加入成员 (撒消_新更名, 更名)
        .计次循环尾 ()
        赋值 (撒消_值, 2)
        赋值 (撒消当前操作, 真)
        信息框 (“修改完毕!”, 64, )
        
    .如果真结束
    .如果真 (等于 (.选中, 真))
        .如果真 (等于 (取已选择表项数 (), 0))
            信息框 (“未选择不修改的文件！ 说明：选中的文件将不修改名，可以多项选择。”, 48, )
            返回 ()
        .如果真结束
        赋值 (索引数组, 取被选择表项 ())
        .计次循环首 (取表项数 (), 变量)
            赋值 (是否置文件名, 真)
            .计次循环首 (取数组成员数 (索引数组), 计次变量)
                .如果真 (等于 (索引数组 [计次变量], 相减 (变量, 1)))
                    赋值 (是否置文件名, 假)
                    跳出循环 ()
                .如果真结束
                
            .计次循环尾 ()
            .如果真 (等于 (是否置文件名, 真))
                赋值 (全路径, 相减 (变量, 1).取标题 (2))
                赋值 (文本, 相减 (变量, 1).取标题 (0))
                赋值 (值, 寻找文本 (文本, “.”, , 真))
                赋值 (文件名, 取文本左边 (文本, 相减 (值, 1)))
                赋值 (值1, 寻找文本 (文本, “.”, , 真))
                赋值 (扩展名, 取文本右边 (文本, 相减 (取文本长度 (文本), 值1)))
                赋值 (文件名, 文本替换 (文件名, 到数值 (.内容), 0, 到文本 (.内容)))
                赋值 (更名, 相加 (目录, 文件名, “.”, 扩展名))
                .如果真 (等于 (文件更名 (全路径, 更名), 假))
                    .如果 (等于 (文件是否存在 (更名), 真))
                        信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败！错误原因：指定文件名与现有文件名重名。请指定另一文件名。”), #错误图标, “错误”)
                        返回 ()
                    .否则
                        信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败！错误原因未知！”), #错误图标, “错误”)
                    .如果结束
                    .计次循环首 (到数值 (.内容), 重试次数)
                        .如果真 (等于 (文件更名 (全路径, 更名), 假))
                            赋值 (返回值, 信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败!”), 相加 (#错误图标, #放弃重试忽略钮), 相加 (“已重试修改次数:”, 到文本 (重试次数))))
                            .如果真 (等于 (返回值, 2))
                                相减 (变量, 1).置标题 (3, “失败”)
                                返回 ()
                            .如果真结束
                            .如果真 (等于 (返回值, 4))
                                相减 (变量, 1).置标题 (3, “失败”)
                                跳出循环 ()
                            .如果真结束
                            
                        .如果真结束
                        
                    .计次循环尾 ()
                .如果真结束
                相减 (变量, 1).置标题 (1, 更名)
                相减 (变量, 1).置标题 (3, “成功”)
                1.置文本 (相加 (“置修改文件名：”, 全路径))
                加入成员 (撒消_旧更名, 全路径)
                加入成员 (撒消_新更名, 更名)
            .如果真结束
            
        .计次循环尾 ()
        赋值 (撒消_值, 2)
        赋值 (撒消当前操作, 真)
        信息框 (“修改完毕!”, 64, )
        
    .如果真结束
    
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
        信息框 (“替换或被替换的内容的未填写！  ”, 48, )
        返回 ()
    .如果真结束
    .如果真 (等于 (.选中, 真))
        .如果真 (等于 (取已选择表项数 (), 0))
            信息框 (“未选择文件！  说明：选中的文件将修改名，可以多项选择。”, 48, )
            返回 ()
        .如果真结束
        赋值 (索引数组, 取被选择表项 ())
        .计次循环首 (取数组成员数 (索引数组), 计次变量)
            加入成员 (临时全路径组, 索引数组.取标题 ( [计次变量], 2))
            加入成员 (临时文件名组, 索引数组.取标题 ( [计次变量], 0))
        .计次循环尾 ()
        .计次循环首 (取数组成员数 (临时全路径组), 计次变量)
            赋值 (全路径, 临时全路径组 [计次变量])
            赋值 (文本, 临时文件名组 [计次变量])
            赋值 (值, 寻找文本 (文本, “.”, , 真))
            赋值 (文件名, 取文本左边 (文本, 相减 (值, 1)))
            赋值 (文本, 临时文件名组 [计次变量])
            赋值 (值1, 寻找文本 (文本, “.”, , 真))
            赋值 (扩展名, 取文本右边 (文本, 相减 (取文本长度 (文本), 值1)))
            赋值 (值, 寻找文本 (文件名, .内容, , 真))
            赋值 (文件名, 文本替换 (文件名, 值, 取文本长度 (.内容), .内容))
            赋值 (更名, 相加 (目录, 文件名, “.”, 扩展名))
            .如果真 (等于 (文件更名 (全路径, 更名), 假))
                .如果 (等于 (文件是否存在 (更名), 真))
                    信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败！错误原因：指定文件名与现有文件名重名。请指定另一文件名。”), #错误图标, “错误”)
                    返回 ()
                .否则
                    信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败！错误原因未知！”), #错误图标, “错误”)
                .如果结束
                .计次循环首 (到数值 (.内容), 重试次数)
                    .如果真 (等于 (文件更名 (全路径, 更名), 假))
                        赋值 (返回值, 信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败!”), 相加 (#错误图标, #放弃重试忽略钮), 相加 (“已重试修改次数:”, 到文本 (重试次数))))
                        .如果真 (等于 (返回值, 2))
                            索引数组.置标题 ( [计次变量], 3, “失败”)
                            返回 ()
                        .如果真结束
                        .如果真 (等于 (返回值, 4))
                            索引数组.置标题 ( [计次变量], 3, “失败”)
                            跳出循环 ()
                        .如果真结束
                        
                    .如果真结束
                    
                .计次循环尾 ()
            .如果真结束
            索引数组.置标题 ( [计次变量], 1, 更名)
            索引数组.置标题 ( [计次变量], 3, “成功”)
            加入成员 (撒消_旧更名, 全路径)
            加入成员 (撒消_新更名, 更名)
            1.置文本 (相加 (“置修改文件名：”, 全路径))
        .计次循环尾 ()
        赋值 (撒消_值, 2)
        赋值 (撒消当前操作, 真)
        信息框 (“修改完毕!”, 64, )
        
    .如果真结束
    .如果真 (等于 (.选中, 真))
        .计次循环首 (取表项数 (), 计次变量)
            赋值 (全路径, 相减 (计次变量, 1).取标题 (2))
            赋值 (文本, 相减 (计次变量, 1).取标题 (0))
            赋值 (值, 寻找文本 (文本, “.”, , 真))
            赋值 (文件名, 取文本左边 (文本, 相减 (值, 1)))
            赋值 (文本, 相减 (计次变量, 1).取标题 (0))
            赋值 (值1, 寻找文本 (文本, “.”, , 真))
            赋值 (扩展名, 取文本右边 (文本, 相减 (取文本长度 (文本), 值1)))
            赋值 (值, 寻找文本 (文件名, .内容, , 真))
            赋值 (文件名, 文本替换 (文件名, 值, 取文本长度 (.内容), .内容))
            赋值 (更名, 相加 (目录, 文件名, “.”, 扩展名))
            .如果真 (等于 (文件更名 (全路径, 更名), 假))
                .如果 (等于 (文件是否存在 (更名), 真))
                    信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败！错误原因：指定文件名与现有文件名重名。请指定另一文件名。”), #错误图标, “错误”)
                    返回 ()
                .否则
                    信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败！错误原因未知！”), #错误图标, “错误”)
                .如果结束
                .计次循环首 (到数值 (.内容), 重试次数)
                    .如果真 (等于 (文件更名 (全路径, 更名), 假))
                        赋值 (返回值, 信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败!”), 相加 (#错误图标, #放弃重试忽略钮), 相加 (“已重试修改次数:”, 到文本 (重试次数))))
                        .如果真 (等于 (返回值, 2))
                            相减 (计次变量, 1).置标题 (3, “失败”)
                            返回 ()
                        .如果真结束
                        .如果真 (等于 (返回值, 4))
                            相减 (计次变量, 1).置标题 (3, “失败”)
                            跳出循环 ()
                        .如果真结束
                        
                    .如果真结束
                    
                .计次循环尾 ()
            .如果真结束
            相减 (计次变量, 1).置标题 (1, 更名)
            相减 (计次变量, 1).置标题 (3, “成功”)
            1.置文本 (相加 (“置修改文件名：”, 全路径))
            加入成员 (撒消_旧更名, 全路径)
            加入成员 (撒消_新更名, 更名)
        .计次循环尾 ()
        赋值 (撒消_值, 2)
        赋值 (撒消当前操作, 真)
        信息框 (“修改完毕!”, 64, )
        
    .如果真结束
    .如果真 (等于 (.选中, 真))
        .如果真 (等于 (取已选择表项数 (), 0))
            信息框 (“未选择不修改的文件！ 说明：选中的文件将不修改名，可以多项选择。”, 48, )
            返回 ()
        .如果真结束
        赋值 (索引数组, 取被选择表项 ())
        .计次循环首 (取表项数 (), 变量)
            赋值 (是否置文件名, 真)
            .计次循环首 (取数组成员数 (索引数组), 计次变量)
                .如果真 (等于 (索引数组 [计次变量], 相减 (变量, 1)))
                    赋值 (是否置文件名, 假)
                    跳出循环 ()
                .如果真结束
                
            .计次循环尾 ()
            .如果真 (等于 (是否置文件名, 真))
                赋值 (全路径, 相减 (变量, 1).取标题 (2))
                赋值 (文本, 相减 (变量, 1).取标题 (0))
                赋值 (值, 寻找文本 (文本, “.”, , 真))
                赋值 (文件名, 取文本左边 (文本, 相减 (值, 1)))
                赋值 (文本, 相减 (变量, 1).取标题 (0))
                赋值 (值1, 寻找文本 (文本, “.”, , 真))
                赋值 (扩展名, 取文本右边 (文本, 相减 (取文本长度 (文本), 值1)))
                赋值 (值, 寻找文本 (文件名, .内容, , 真))
                赋值 (文件名, 文本替换 (文件名, 值, 取文本长度 (.内容), .内容))
                赋值 (更名, 相加 (目录, 文件名, “.”, 扩展名))
                .如果真 (等于 (文件更名 (全路径, 更名), 假))
                    .如果 (等于 (文件是否存在 (更名), 真))
                        信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败！错误原因：指定文件名与现有文件名重名。请指定另一文件名。”), #错误图标, “错误”)
                        返回 ()
                    .否则
                        信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败！错误原因未知！”), #错误图标, “错误”)
                    .如果结束
                    .计次循环首 (到数值 (.内容), 重试次数)
                        .如果真 (等于 (文件更名 (全路径, 更名), 假))
                            赋值 (返回值, 信息框 (相加 (“修改文件”, #左引号, 文本, #右引号, “名失败!”), 相加 (#错误图标, #放弃重试忽略钮), 相加 (“已重试修改次数:”, 到文本 (重试次数))))
                            .如果真 (等于 (返回值, 2))
                                相减 (变量, 1).置标题 (3, “失败”)
                                返回 ()
                            .如果真结束
                            .如果真 (等于 (返回值, 4))
                                相减 (变量, 1).置标题 (3, “失败”)
                                跳出循环 ()
                            .如果真结束
                            
                        .如果真结束
                        
                    .计次循环尾 ()
                .如果真结束
                相减 (变量, 1).置标题 (1, 更名)
                相减 (变量, 1).置标题 (3, “成功”)
                1.置文本 (相加 (“置修改文件名：”, 全路径))
                加入成员 (撒消_旧更名, 全路径)
                加入成员 (撒消_新更名, 更名)
            .如果真结束
            
        .计次循环尾 ()
        赋值 (撒消_值, 2)
        赋值 (撒消当前操作, 真)
        信息框 (“修改完毕!”, 64, )
        
    .如果真结束
    
.如果真结束


.子程序 读文件时间, 逻辑型, , 
.参数 参文_文件名, 文本型, , 被读取的文件名
.参数 参_系统时间, 时间, , 返回时间结果
.参数 参整_类型, 整数型, , 
.参数 错误信息, 文本型, , 返回错误信息

.局部变量 整_地址, 整数型, , , 
.局部变量 整_文件句柄, 整数型, , , 
.局部变量 UTC文件时间, 文件时间, , , 
.局部变量 本地文件时间, 文件时间, , , 

赋值 (错误信息, 取空白文本 (200))
赋值 (整_文件句柄, DLL_创建文件 (参文_文件名, 0, 0, 0, 3, 0, 0))
.如果真 (小于或等于 (整_文件句柄, 0))
    DLL_取错误文本信息 (4608, 0, DLL_取最后调用错误 (), 0, 错误信息, 200, 0)
    返回 (假)
.如果真结束
赋值 (整_地址, 取字节集数据 (指针到字节集 (取变量地址 (UTC文件时间), 4), #整数型, ))
.判断开始 (等于 (参整_类型, #文件创建时间))
    .如果真 (等于 (DLL_取文件时间 (整_文件句柄, 整_地址, 0, 0), 假))
        DLL_取错误文本信息 (4608, 0, DLL_取最后调用错误 (), 0, 错误信息, 200, 0)
        DLL_关闭句柄 (整_文件句柄)
        返回 (假)
        
    .如果真结束
    
.判断 (等于 (参整_类型, #文件最后访问时间))
    .如果真 (等于 (DLL_取文件时间 (整_文件句柄, 0, 整_地址, 0), 假))
        DLL_取错误文本信息 (4608, 0, DLL_取最后调用错误 (), 0, 错误信息, 200, 0)
        DLL_关闭句柄 (整_文件句柄)
        返回 (假)
        
    .如果真结束
    
.判断 (等于 (参整_类型, #文件最后修改时间))
    .如果真 (等于 (DLL_取文件时间 (整_文件句柄, 0, 0, 整_地址), 假))
        DLL_取错误文本信息 (4608, 0, DLL_取最后调用错误 (), 0, 错误信息, 200, 0)
        DLL_关闭句柄 (整_文件句柄)
        返回 (假)
    .如果真结束
    
.默认
    
.判断结束
DLL_关闭句柄 (整_文件句柄)
 ' 转换文件时间到本地文件时间
.如果 (等于 (DLL_文件时间到本地文件时间 (UTC文件时间, 本地文件时间), 假))
    DLL_取错误文本信息 (4608, 0, DLL_取最后调用错误 (), 0, 错误信息, 200, 0)
    返回 (假)
.否则
    
.如果结束
 ' 文件时间到系统时间
.如果真 (等于 (DLL_文件时间到系统时间 (本地文件时间, 参_系统时间), 假))
    DLL_取错误文本信息 (4608, 0, DLL_取最后调用错误 (), 0, 错误信息, 200, 0)
    返回 (假)
.如果真结束
返回 (真)

.子程序 _改文件时间按钮_被单击, 空白型, , 
.局部变量 是否置文件时间, 逻辑型, , , 
.局部变量 全路径, 文本型, , , 
.局部变量 错误信息, 文本型, , , 
.局部变量 临时全路径组, 文本型, , "0", 
.局部变量 临时文件名组, 文本型, , "0", 
.局部变量 索引数组, 整数型, , "0", 
.局部变量 计次变量, 整数型, , , 
.局部变量 重试次数, 整数型, , , 
.局部变量 变量, 整数型, , , 
.局部变量 系统时间, 时间, , , 

.如果真 (等于 (取表项数 (), 0))
    信息框 (“未载入要修改的文件！”, 48, )
    返回 ()
.如果真结束
1.置文本 (“开始修改文件时间,请你耐心等待!如果修改文件越多,等待的时间越久!”)
清除数组 (撒消_时间路径)
清除数组 (撒消_时间_年)
清除数组 (撒消_时间_月)
清除数组 (撒消_时间_日)
清除数组 (撒消_时间_时)
清除数组 (撒消_时间_分)
清除数组 (撒消_时间_秒)
清除数组 (撒消_时间_毫秒)
.如果真 (等于 (.选中, 真))
    .如果真 (等于 (取已选择表项数 (), 0))
        信息框 (“未选择文件！  说明：选中的文件将修改时间，可以多项选择。”, 48, )
        返回 ()
    .如果真结束
    赋值 (索引数组, 取被选择表项 ())
    .计次循环首 (取数组成员数 (索引数组), 计次变量)
        加入成员 (临时全路径组, 索引数组.取标题 ( [计次变量], 4))
        加入成员 (临时文件名组, 索引数组.取标题 ( [计次变量], 0))
    .计次循环尾 ()
    .计次循环首 (取数组成员数 (临时全路径组), 计次变量)
        赋值 (全路径, 临时全路径组 [计次变量])
        .如果真 (读文件时间 (全路径, 系统时间, .现行选中项, 错误信息))
            加入成员 (撒消_时间_年, 系统时间.年)
            加入成员 (撒消_时间_月, 系统时间.月)
            加入成员 (撒消_时间_日, 系统时间.日)
            加入成员 (撒消_时间_时, 系统时间.小时)
            加入成员 (撒消_时间_分, 系统时间.分钟)
            加入成员 (撒消_时间_秒, 系统时间.秒)
            加入成员 (撒消_时间_毫秒, 系统时间.毫秒)
            赋值 (撒消_时间值, .现行选中项)
            加入成员 (撒消_时间路径, 全路径)
            
        .如果真结束
        
        .如果真 (等于 (写文件时间 (全路径, 错误信息), 假))
            信息框 (相加 (“置文件”, #左引号, 临时文件名组 [计次变量], #右引号, “时间失败！”, “错误信息：”, 错误信息), 48, “失败”)
            .计次循环首 (到数值 (.内容), 重试次数)
                .如果真 (等于 (写文件时间 (全路径, 错误信息), 假))
                    .如果真 (等于 (信息框 (相加 (“重置文件”, #左引号, 临时文件名组 [计次变量], #右引号, “时间失败！”, “错误信息：”, 错误信息), 相加 (#错误图标, #是否钮), 相加 (“已重试修改次数：”, 到文本 (重试次数))), #否钮))
                        相减 (计次变量, 1).置标题 (5, 错误信息)
                        返回 ()
                    .如果真结束
                    
                .如果真结束
                
            .计次循环尾 ()
            到循环尾 ()
        .如果真结束
        1.置文本 (相加 (“置文件时间：”, 全路径))
    .计次循环尾 ()
    赋值 (撒消_值, 3)
    赋值 (撒消当前操作, 真)
    信息框 (“置文件时间完毕！”, 64, )
.如果真结束
.如果真 (等于 (.选中, 真))
    .如果真 (等于 (取已选择表项数 (), 0))
        信息框 (“未选择不修改的文件！ 说明：选中的文件将不修改时间，可以多项选择。”, 48, )
        返回 ()
    .如果真结束
    赋值 (索引数组, 取被选择表项 ())
    .计次循环首 (取表项数 (), 变量)
        赋值 (是否置文件时间, 真)
        .计次循环首 (取数组成员数 (索引数组), 计次变量)
            .如果真 (等于 (索引数组 [计次变量], 相减 (变量, 1)))
                赋值 (是否置文件时间, 假)
                跳出循环 ()
            .如果真结束
            
        .计次循环尾 ()
        .如果真 (等于 (是否置文件时间, 真))
            赋值 (全路径, 相减 (变量, 1).取标题 (4))
            .如果真 (读文件时间 (全路径, 系统时间, .现行选中项, 错误信息))
                加入成员 (撒消_时间_年, 系统时间.年)
                加入成员 (撒消_时间_月, 系统时间.月)
                加入成员 (撒消_时间_日, 系统时间.日)
                加入成员 (撒消_时间_时, 系统时间.小时)
                加入成员 (撒消_时间_分, 系统时间.分钟)
                加入成员 (撒消_时间_秒, 系统时间.秒)
                加入成员 (撒消_时间_毫秒, 系统时间.毫秒)
                赋值 (撒消_时间值, .现行选中项)
                加入成员 (撒消_时间路径, 全路径)
                
            .如果真结束
            
            .如果真 (等于 (写文件时间 (全路径, 错误信息), 假))
                信息框 (相加 (“置文件”, #左引号, 相减 (变量, 1).取标题 (0), #右引号, “时间失败！”, “错误信息：”, 错误信息), 48, “失败”)
                .计次循环首 (到数值 (.内容), 重试次数)
                    .如果真 (等于 (写文件时间 (全路径, 错误信息), 假))
                        .如果真 (等于 (信息框 (相加 (“重置文件”, #左引号, 相减 (变量, 1).取标题 (0), #右引号, “时间失败！”, “错误信息：”, 错误信息), 相加 (#错误图标, #是否钮), 相加 (“已重试修改次数：”, 到文本 (重试次数))), #否钮))
                            相减 (变量, 1).置标题 (5, 错误信息)
                            返回 ()
                        .如果真结束
                        
                    .如果真结束
                    
                .计次循环尾 ()
                到循环尾 ()
            .如果真结束
            1.置文本 (相加 (“置文件时间：”, 全路径))
        .如果真结束
        
    .计次循环尾 ()
    赋值 (撒消_值, 3)
    赋值 (撒消当前操作, 真)
    信息框 (“置文件时间完毕！”, 64, )
.如果真结束
.如果真 (等于 (.选中, 真))
    .计次循环首 (取表项数 (), 变量)
        赋值 (全路径, 相减 (变量, 1).取标题 (4))
        .如果真 (读文件时间 (全路径, 系统时间, .现行选中项, 错误信息))
            加入成员 (撒消_时间_年, 系统时间.年)
            加入成员 (撒消_时间_月, 系统时间.月)
            加入成员 (撒消_时间_日, 系统时间.日)
            加入成员 (撒消_时间_时, 系统时间.小时)
            加入成员 (撒消_时间_分, 系统时间.分钟)
            加入成员 (撒消_时间_秒, 系统时间.秒)
            加入成员 (撒消_时间_毫秒, 系统时间.毫秒)
            赋值 (撒消_时间值, .现行选中项)
            加入成员 (撒消_时间路径, 全路径)
        .如果真结束
        
        .如果真 (等于 (写文件时间 (全路径, 错误信息), 假))
            信息框 (相加 (“置文件”, #左引号, 相减 (变量, 1).取标题 (0), #右引号, “时间失败！”, “错误信息：”, 错误信息), 48, “失败”)
            .计次循环首 (到数值 (.内容), 重试次数)
                .如果真 (等于 (写文件时间 (全路径, 错误信息), 假))
                    .如果真 (等于 (信息框 (相加 (“重置文件”, #左引号, 相减 (变量, 1).取标题 (0), #右引号, “时间失败！”, “错误信息：”, 错误信息), 相加 (#错误图标, #是否钮), 相加 (“已重试修改次数：”, 到文本 (重试次数))), #否钮))
                        相减 (变量, 1).置标题 (5, 错误信息)
                        返回 ()
                    .如果真结束
                    
                .如果真结束
                
            .计次循环尾 ()
            到循环尾 ()
        .如果真结束
        相减 (变量, 1).选择表项 ()
        1.置文本 (相加 (“置文件时间：”, 全路径))
    .计次循环尾 ()
    赋值 (撒消_值, 3)
    赋值 (撒消当前操作, 真)
    信息框 (“置文件时间完毕！”, 64, )
.如果真结束


.子程序 写文件时间, 逻辑型, , 
.参数 文件路径, 文本型, , 要修改文件时间的文件全路径
.参数 错误信息, 文本型, , 返回错误信息

.局部变量 整_地址, 整数型, , , 
.局部变量 整_文件句柄, 整数型, , , 
.局部变量 文件时间, 文件时间, , , 
.局部变量 文件时间临时, 文件时间, , , 
.局部变量 系统时间, 时间, , , 
.局部变量 bool, 逻辑型, , , 

赋值 (错误信息, 取空白文本 (200))
赋值 (系统时间.年, 到数值 (.内容))
赋值 (系统时间.月, 到数值 (.内容))
赋值 (系统时间.日, 到数值 (.内容))
赋值 (系统时间.小时, 到数值 (.内容))
赋值 (系统时间.分钟, 到数值 (.内容))
赋值 (系统时间.秒, 到数值 (.内容))
赋值 (系统时间.毫秒, 到数值 (.内容))
赋值 (整_文件句柄, DLL_创建文件 (文件路径, 1073741824, 0, 0, 3, 0, 0))
.如果真 (小于或等于 (整_文件句柄, 0))
    DLL_取错误文本信息 (4608, 0, DLL_取最后调用错误 (), 0, 错误信息, 200, 0)
    返回 (假)
.如果真结束

.如果真 (等于 (DLL_系统时间到文件时间 (系统时间, 文件时间临时), 假))
    DLL_取错误文本信息 (4608, 0, DLL_取最后调用错误 (), 0, 错误信息, 200, 0)
    DLL_关闭句柄 (整_文件句柄)
    返回 (假)
.如果真结束
.如果真 (等于 (DLL_本地文件时间到文件时间 (文件时间临时, 文件时间), 假))
    DLL_取错误文本信息 (4608, 0, DLL_取最后调用错误 (), 0, 错误信息, 200, 0)
    DLL_关闭句柄 (整_文件句柄)
    返回 (假)
.如果真结束

 ' 取变量 文件时间 结构的首地址
赋值 (整_地址, 取字节集数据 (指针到字节集 (取变量地址 (文件时间), 4), #整数型, ))
.判断开始 (等于 (.现行选中项, 0)) ' 文件创建时间
    .如果真 (等于 (DLL_置文件时间 (整_文件句柄, 整_地址, 0, 0), 假))
        DLL_取错误文本信息 (4608, 0, DLL_取最后调用错误 (), 0, 错误信息, 200, 0)
        DLL_关闭句柄 (整_文件句柄)
        返回 (假)
    .如果真结束
    
.判断 (等于 (.现行选中项, 1)) ' 文件访问时间
    .如果真 (等于 (DLL_置文件时间 (整_文件句柄, 0, 整_地址, 0), 假))
        DLL_取错误文本信息 (4608, 0, DLL_取最后调用错误 (), 0, 错误信息, 200, 0)
        DLL_关闭句柄 (整_文件句柄)
        返回 (假)
    .如果真结束
    
.判断 (等于 (.现行选中项, 2)) ' 文件修改时间
    .如果真 (等于 (DLL_置文件时间 (整_文件句柄, 0, 0, 整_地址), 假))
        DLL_取错误文本信息 (4608, 0, DLL_取最后调用错误 (), 0, 错误信息, 200, 0)
        DLL_关闭句柄 (整_文件句柄)
        返回 (假)
    .如果真结束
    
.默认
    
.判断结束
DLL_关闭句柄 (整_文件句柄)
返回 (真)


.子程序 _局部修改_被单击, 空白型, , 
赋值 (.选中, 真)
赋值 (.选中, 假)
赋值 (.选中, 假)

.子程序 _替换修改_被单击, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 假)
赋值 (.选中, 真)

.子程序 _字符插入修改_被单击, 空白型, , 
赋值 (.选中, 假)
赋值 (.选中, 真)
赋值 (.选中, 假)

.子程序 __启动窗口_将被销毁, 空白型, , 
结束 ()

.子程序 _按钮1_被单击, 空白型, , 
载入 (过滤文件窗口, , 真)

.子程序 _文件读取_所有属性_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    连续赋值 (真, .禁止, .禁止, .禁止, .禁止, .禁止)
    连续赋值 (假, .选中, .选中, .选中, .选中, .选中)
    写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件读取_所有属性”, “6”)
    
.否则
    连续赋值 (假, .禁止, .禁止, .禁止, .禁止, .禁止)
    写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件读取_所有属性”, “0”)
    
.如果结束


.子程序 _打开文件_被选择, 空白型, , 
.局部变量 临时路径, 文本型, , "0", 
.局部变量 计次变量, 整数型, , , 
.局部变量 容器1, 整数型, , , 
.局部变量 文件名, 文本型, , , 
.局部变量 文本, 文本型, , , 
.局部变量 系统时间, 时间, , , 
.局部变量 错误信息, 文本型, , , 
.局部变量 临时文本, 文本型, , , 
.局部变量 值, 整数型, , , 
.局部变量 文件属性, 整数型, , , 
.局部变量 时间, 文本型, , , 
.局部变量 文件句柄, 整数型, , , 

赋值 (临时路径, 多文件对话框 (“打开文件”, “所有文件|*.*|”, , , ))
.如果真 (等于 (.现行子夹, 0))
    .计次循环首 (取数组成员数 (临时路径), 计次变量)
        赋值 (文本, 临时路径 [计次变量])
        赋值 (值, 寻找文本 (文本, “\”, , 真))
        赋值 (文件名, 取文本右边 (文本, 相减 (取文本长度 (文本), 值)))
        赋值 (容器1, .插入表项 (文件名, , , , ))
        容器1.置标题 (1, 文本)
        赋值 (文件属性, 取文件属性 (文本))
        .如果真 (不等于 (位与 (文件属性, #子目录), 0))
            赋值 (临时文本, 相加 (临时文本, “文件夹.”))
        .如果真结束
        .如果真 (不等于 (位与 (文件属性, #只读文件), 0))
            赋值 (临时文本, 相加 (临时文本, “只读文件.”))
        .如果真结束
        .如果真 (不等于 (位与 (文件属性, #隐藏文件), 0))
            赋值 (临时文本, 相加 (临时文本, “隐藏文件.”))
        .如果真结束
        .如果真 (不等于 (位与 (文件属性, #系统文件), 0))
            赋值 (临时文本, 相加 (临时文本, “系统文件.”))
        .如果真结束
        .如果真 (不等于 (位与 (文件属性, #存档文件), 0))
            赋值 (临时文本, 相加 (临时文本, “存档文件.”))
        .如果真结束
        .如果真 (等于 (文件属性, -1))
            赋值 (临时文本, 相加 (临时文本, “取文件属性失败.”))
        .如果真结束
        .如果真 (等于 (文件属性, 0))
            赋值 (临时文本, 相加 (临时文本, “未置文件属性.”))
        .如果真结束
        容器1.置标题 (2, 临时文本)
        赋值 (临时文本, “”)
    .计次循环尾 ()
.如果真结束
.如果真 (等于 (.现行子夹, 1))
    .计次循环首 (取数组成员数 (临时路径), 计次变量)
        赋值 (文本, 临时路径 [计次变量])
        赋值 (值, 寻找文本 (文本, “\”, , 真))
        赋值 (文件名, 取文本右边 (文本, 相减 (取文本长度 (文本), 值)))
        赋值 (容器1, .插入表项 (文件名, , , , ))
        容器1.置标题 (2, 文本)
        容器1.置标题 (3, “否”)
    .计次循环尾 ()
.如果真结束
.如果真 (等于 (.现行子夹, 2))
.如果真结束
.计次循环首 (取数组成员数 (临时路径), 计次变量)
    赋值 (文本, 临时路径 [计次变量])
    赋值 (值, 寻找文本 (文本, “\”, , 真))
    赋值 (文件名, 取文本右边 (文本, 相减 (取文本长度 (文本), 值)))
    赋值 (容器1, .插入表项 (文件名, , , , ))
    容器1.置标题 (4, 文本)
    .计次循环首 (3, 计次变量)
        .如果真 (并且 (读文件时间 (文本, 系统时间, 相减 (计次变量, 1), 错误信息), 等于 (计次变量, 1)))
            填充文件时间 (系统时间, 时间)
            容器1.置标题 (1, 时间)
        .如果真结束
        关闭文件 (文件句柄)
        .如果真 (并且 (读文件时间 (文本, 系统时间, 相减 (计次变量, 1), 错误信息), 等于 (计次变量, 2)))
            填充文件时间 (系统时间, 时间)
            容器1.置标题 (2, 时间)
        .如果真结束
        关闭文件 (文件句柄)
        .如果真 (并且 (读文件时间 (文本, 系统时间, 相减 (计次变量, 1), 错误信息), 等于 (计次变量, 3)))
            填充文件时间 (系统时间, 时间)
            容器1.置标题 (3, 时间)
        .如果真结束
        关闭文件 (文件句柄)
        容器1.置标题 (5, 错误信息)
    .计次循环尾 ()
.计次循环尾 ()


.子程序 _退出_被选择, 空白型, , 
销毁 ()

.子程序 _撒消_被选择, 空白型, , 
.如果 (等于 (撒消当前操作, 真))
    .如果真 (等于 (撒消_值, 1))
        撤消属性 ()
    .如果真结束
    .如果真 (等于 (撒消_值, 2))
        撤消更名 ()
    .如果真结束
    .如果真 (等于 (撒消_值, 3))
        撤消时间 ()
    .如果真结束
    1.置文本 (“已撒消上次操作!”)
.否则
    1.置文本 (“当前没有可撒消的操作!”)
    信息框 (“当前没有可撒消的操作!”, 48, )
    1.置文本 (“”)
.如果结束


.子程序 _修改文件名1_被选择, 空白型, , 
_修改文件名_被选择 ()

.子程序 _置文件属性1_被选择, 空白型, , 
_置文件属性_被选择 ()

.子程序 _修改文件时间1_被选择, 空白型, , 
_修改文件时间_被选择 ()

.子程序 _文件类型设置_被选择, 空白型, , 
_读文件类型设置_被选择 ()

.子程序 _失败重试次数_被选择, 空白型, , 
_置文件属性_被选择 ()

.子程序 _注册_被选择, 空白型, , 


.子程序 _说明_被选择, 空白型, , 
.如果 (文件是否存在 (相加 (取运行目录 (), “\帮助文件.chm”)))
    未知支持库函数_6 (相加 (取运行目录 (), “\帮助文件.chm”), , )
.否则
    信息框 (“帮助文件找不到!”, 48, )
.如果结束


.子程序 _关于_被选择, 空白型, , 
载入 (关于窗口, , 真)

.子程序 _删除选择的项目_被选择, 空白型, , 
.局部变量 被选择的文件个数, 整数型, , , 

.如果真 (等于 (.现行子夹, 0))
    赋值 (被选择的文件个数, 取已选择表项数 ())
    .判断循环首 (大于 (被选择的文件个数, 0))
        .删除表项 (.)
        赋值 (被选择的文件个数, 相减 (被选择的文件个数, 1))
    .判断循环尾 ()
.如果真结束
.如果真 (等于 (.现行子夹, 1))
    赋值 (被选择的文件个数, 取已选择表项数 ())
    .判断循环首 (大于 (被选择的文件个数, 0))
        .删除表项 (.)
        赋值 (被选择的文件个数, 相减 (被选择的文件个数, 1))
    .判断循环尾 ()
.如果真结束
.如果真 (等于 (.现行子夹, 2))
    赋值 (被选择的文件个数, 取已选择表项数 ())
    .判断循环首 (大于 (被选择的文件个数, 0))
        .删除表项 (.)
        赋值 (被选择的文件个数, 相减 (被选择的文件个数, 1))
    .判断循环尾 ()
.如果真结束


.子程序 _清空列表_被选择, 空白型, , 
.如果真 (等于 (.现行子夹, 0))
    全部删除 ()
.如果真结束
.如果真 (等于 (.现行子夹, 1))
    全部删除 ()
.如果真结束
.如果真 (等于 (.现行子夹, 2))
    全部删除 ()
.如果真结束


.子程序 _修改文件名_被选择, 空白型, , 
赋值 (., 2)
赋值 (.现行子夹, 1)
1.置文本 (“”)

.子程序 _置文件属性_被选择, 空白型, , 
赋值 (., 1)
赋值 (.现行子夹, 0)
1.置文本 (“”)

.子程序 _修改文件时间_被选择, 空白型, , 
赋值 (., 3)
赋值 (.现行子夹, 2)
1.置文本 (“”)

.子程序 _读文件类型设置_被选择, 空白型, , 
 ' 赋值 (., 0)
1.置文本 (“”)

.子程序 _添加文件_被选择, 空白型, , 
_打开文件_被选择 ()

.子程序 _普通风格_被选择, 空白型, , 
写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “窗口风格”, “1”)
信息框 (“你设置了普通风格,下次运行后才生效!”, 64, )

.子程序 _墨黑风格_被选择, 空白型, , 
写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “窗口风格”, “2”)
信息框 (“你设置了墨黑风格,下次运行后才生效!”, 64, )

.子程序 _灰色风格_被选择, 空白型, , 
写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “窗口风格”, “3”)
信息框 (“你设置了灰色风格,下次运行后才生效!”, 64, )

.子程序 _蓝色风格_被选择, 空白型, , 
写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “窗口风格”, “4”)
信息框 (“你设置了蓝色风格,下次运行后才生效!”, 64, )

.子程序 撤消属性, 空白型, , 
.局部变量 计次变量, 整数型, , , 

.如果真 (等于 (信息框 (“是否真的撤消上一次操作？”, 相加 (#是否钮, #信息图标), “询问：”), #是钮))
    置等待鼠标 ()
    .计次循环首 (取数组成员数 (撒消_属性路径), 计次变量)
        置文件属性 (撒消_属性路径 [计次变量], 撒消_属性值 [计次变量])
    .计次循环尾 ()
    恢复鼠标 ()
    赋值 (.禁止, 真)
.如果真结束
返回 ()

.子程序 撤消更名, 空白型, , 
.局部变量 计次变量, 整数型, , , 

.如果真 (等于 (信息框 (“是否真的撤消上一次操作？”, 相加 (#是否钮, #信息图标), “询问：”), #是钮))
    置等待鼠标 ()
    .计次循环首 (取数组成员数 (撒消_旧更名), 计次变量)
        文件更名 (撒消_新更名 [计次变量], 撒消_旧更名 [计次变量])
    .计次循环尾 ()
    恢复鼠标 ()
    赋值 (.禁止, 真)
.如果真结束
返回 ()

.子程序 撤消时间, 空白型, , 
.局部变量 计次变量, 整数型, , , 

.如果真 (等于 (信息框 (“是否真的撤消上一次操作？”, 相加 (#是否钮, #信息图标), “询问：”), #是钮))
    置等待鼠标 ()
    .计次循环首 (取数组成员数 (撒消_时间路径), 计次变量)
        撒消_写文件时间 (撒消_时间路径 [计次变量], 计次变量)
    .计次循环尾 ()
    恢复鼠标 ()
    赋值 (.禁止, 真)
.如果真结束
返回 ()

.子程序 撒消_写文件时间, 逻辑型, , 
.参数 文件路径, 文本型, , 要修改文件时间的文件全路径
.参数 计次变量值, 整数型, , 计次循环记录容器

.局部变量 整_地址, 整数型, , , 
.局部变量 整_文件句柄, 整数型, , , 
.局部变量 文件时间, 文件时间, , , 
.局部变量 文件时间临时, 文件时间, , , 
.局部变量 取系统时间, 时间, , , 

赋值 (取系统时间.年, 撒消_时间_年 [计次变量值])
赋值 (取系统时间.月, 撒消_时间_月 [计次变量值])
赋值 (取系统时间.日, 撒消_时间_日 [计次变量值])
赋值 (取系统时间.小时, 撒消_时间_时 [计次变量值])
赋值 (取系统时间.分钟, 撒消_时间_分 [计次变量值])
赋值 (取系统时间.秒, 撒消_时间_秒 [计次变量值])
赋值 (取系统时间.毫秒, 撒消_时间_毫秒 [计次变量值])

赋值 (整_文件句柄, DLL_创建文件 (文件路径, 1073741824, 0, 0, 3, 0, 0))
.如果真 (小于或等于 (整_文件句柄, 0))
    返回 (假)
.如果真结束

.如果真 (等于 (DLL_系统时间到文件时间 (取系统时间, 文件时间临时), 假))
    DLL_关闭句柄 (整_文件句柄)
    返回 (假)
.如果真结束
.如果真 (等于 (DLL_本地文件时间到文件时间 (文件时间临时, 文件时间), 假))
    DLL_关闭句柄 (整_文件句柄)
    返回 (假)
.如果真结束


 ' 取变量 文件时间 结构的首地址
赋值 (整_地址, 取字节集数据 (指针到字节集 (取变量地址 (文件时间), 4), #整数型, ))
.判断开始 (等于 (撒消_时间值, 0)) ' 文件创建时间
    .如果真 (等于 (DLL_置文件时间 (整_文件句柄, 整_地址, 0, 0), 假))
        DLL_关闭句柄 (整_文件句柄)
        返回 (假)
    .如果真结束
    
.判断 (等于 (撒消_时间值, 1)) ' 文件访问时间
    .如果真 (等于 (DLL_置文件时间 (整_文件句柄, 0, 整_地址, 0), 假))
        DLL_关闭句柄 (整_文件句柄)
        返回 (假)
    .如果真结束
    
.判断 (等于 (撒消_时间值, 2)) ' 文件修改时间
    .如果真 (等于 (DLL_置文件时间 (整_文件句柄, 0, 0, 整_地址), 假))
        DLL_关闭句柄 (整_文件句柄)
        返回 (假)
    .如果真结束
    
.默认
    
.判断结束
DLL_关闭句柄 (整_文件句柄)
返回 (真)

.子程序 _文件读取_只读_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件读取_只读”, “1”)
    
.否则
    写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件读取_只读”, “0”)
    
.如果结束


.子程序 _文件读取_存档_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件读取_存档”, “2”)
    
.否则
    写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件读取_存档”, “0”)
    
.如果结束


.子程序 _文件读取_隐藏_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件读取_隐藏”, “3”)
    
.否则
    写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件读取_隐藏”, “0”)
    
.如果结束



.子程序 _文件读取_系统_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件读取_系统”, “4”)
    
.否则
    写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件读取_系统”, “0”)
    
.如果结束


.子程序 _文件读取_没属性_被单击, 空白型, , 
.如果 (等于 (.选中, 真))
    写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件读取_没属性”, “5”)
    
.否则
    写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件读取_没属性”, “0”)
    
.如果结束


.子程序 _文件读取_类型框_失去焦点, 空白型, , 
写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件类型读取”, 到文本 (.内容))


.子程序 _大小框_列表项被选择, 空白型, , 
写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件大小读取”, 到文本 (.现行选中项))


.子程序 _文件大小框_失去焦点, 空白型, , 
写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件大小字节”, 到文本 (.内容))


.子程序 _年框_失去焦点, 空白型, , 
写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件修改日期读取_年”, 到文本 (.内容))


.子程序 _月框_失去焦点, 空白型, , 
写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件修改日期读取_月”, 到文本 (.内容))


.子程序 _日框_失去焦点, 空白型, , 
写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件修改日期读取_日”, 到文本 (.内容))


.子程序 _年框1_失去焦点, 空白型, , 
写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件修改日期读取_年1”, 到文本 (.内容))


.子程序 _月框1_失去焦点, 空白型, , 
写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件修改日期读取_月1”, 到文本 (.内容))


.子程序 _日框1_失去焦点, 空白型, , 
写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件修改日期读取_日1”, 到文本 (.内容))


.子程序 _修改列表选中的文件_被单击, 空白型, , 


.子程序 _列表选中的文件不修改_被单击, 空白型, , 


.子程序 _修改列表全部的文件_被单击, 空白型, , 


.子程序 _重试框_失去焦点, 空白型, , 


.子程序 _只读选择框_被单击, 空白型, , 


.子程序 _存档选择框_被单击, 空白型, , 


.子程序 _隐藏选择框_被单击, 空白型, , 


.子程序 _系统选择框_被单击, 空白型, , 


.窗口程序集 窗口程序集2, , , 

.子程序 _按钮2_被单击, 空白型, , 
.局部变量 文本, 文本型, , , 

赋值 (文本, .内容)
赋值 (文本, 删全部空 (文本))
赋值 (_启动窗口..内容, 文本)
写配置项 (相加 (取运行目录 (), “\tlsy.ini”), “双狮文件修改助手”, “文件类型读取”, 文本)

销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
销毁 ()

.子程序 _过滤文件窗口_创建完毕, 空白型, , 
赋值 (.内容, _启动窗口..内容)


.窗口程序集 窗口程序集3, , , 

.子程序 _按钮1_被单击, 空白型, , 
销毁 ()


 ' 不属于任何一个程序集、类模块的函数：
