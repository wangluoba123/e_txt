 ' 文件类型：Windows窗口程序

 ' 程序名称：爱心使者家政服务中心人力资源管理系统
 ' 程序描述：程序设计：寿光市三鑫图文设计室
编程：卢光庆
 ' 程序作者：卢光庆
 ' 邮政编码：262700
 ' 联系地址：山东省寿光市孙集镇卢家村
 ' 联系电话：0536-5493555
 ' 传真号码：
 ' 电子信箱：sdlgq@163.com
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 438
    高度 = 332
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 已保存到：D:\易语言学习\Data\爱心使者v1.5.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “爱心使者家政服务中心人力资源管理系统V1.5”
    帮助文件名 = “”

窗口 部门
    左边 = 50
    顶边 = 50
    宽度 = 230
    高度 = 250
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 已保存到：D:\易语言学习\Data\爱心使者v1.5.e\部门_图标.ico
    背景音乐 =  ' 空
    标题 = “爱心使者部门管理系统”
    帮助文件名 = “”

窗口 人员
    左边 = 50
    顶边 = 50
    宽度 = 469
    高度 = 290
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 已保存到：D:\易语言学习\Data\爱心使者v1.5.e\人员_图标.ico
    背景音乐 =  ' 空
    标题 = “爱心使者人员管理系统”
    帮助文件名 = “”

窗口 添加人员
    左边 = 50
    顶边 = 50
    宽度 = 246
    高度 = 311
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 已保存到：D:\易语言学习\Data\爱心使者v1.5.e\添加人员_图标.ico
    背景音乐 =  ' 空
    标题 = “添加人员”
    帮助文件名 = “”

窗口 修改人员
    左边 = 50
    顶边 = 50
    宽度 = 234
    高度 = 301
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 已保存到：D:\易语言学习\Data\爱心使者v1.5.e\修改人员_图标.ico
    背景音乐 =  ' 空
    标题 = “人员属性修改”
    帮助文件名 = “”

窗口 查找人员
    左边 = 50
    顶边 = 50
    宽度 = 343
    高度 = 269
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 已保存到：D:\易语言学习\Data\爱心使者v1.5.e\查找人员_图标.ico
    背景音乐 =  ' 空
    标题 = “查找人员”
    帮助文件名 = “”

窗口 工资表 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 475
    高度 = 384
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 已保存到：D:\易语言学习\Data\爱心使者v1.5.e\工资表_图标.ico
    背景音乐 =  ' 空
    标题 = “人员工资管理系统”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 350
    高度 = 194
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 已保存到：D:\易语言学习\Data\爱心使者v1.5.e\关于窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “关于”
    帮助文件名 = “”

窗口 表格属性窗口1
    左边 = 50
    顶边 = 50
    宽度 = 308
    高度 = 241
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 已保存到：D:\易语言学习\Data\爱心使者v1.5.e\表格属性窗口1_图标.ico
    背景音乐 =  ' 空
    标题 = “表格属性”
    帮助文件名 = “”

窗口 颜色选择窗口1
    左边 = 50
    顶边 = 50
    宽度 = 295
    高度 = 149
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    图标 =  ' 已保存到：D:\易语言学习\Data\爱心使者v1.5.e\颜色选择窗口1_图标.ico
    背景音乐 =  ' 空
    标题 = “请选择颜色:”
    帮助文件名 = “”

窗口 选择姓名
    左边 = 50
    顶边 = 50
    宽度 = 112
    高度 = 138
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = 8421376 '  0x808000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    图标 =  ' 已保存到：D:\易语言学习\Data\爱心使者v1.5.e\选择姓名_图标.ico
    背景音乐 =  ' 空
    标题 = “选择性名”
    帮助文件名 = “”

窗口 备份窗口
    左边 = 50
    顶边 = 50
    宽度 = 303
    高度 = 289
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假



.常量 常量1, "", , 
.常量 易之表, "“易之表”", , 
.常量 用户习惯, "“用户习惯”", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 4 系统核心支持库




.全局变量 颜色选择标题, 文本型, , , 
.全局变量 返回颜色有效, 逻辑型, , , 
.全局变量 返回颜色, 整数型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 dqml, 文本型, , , 
.程序集变量 bfckbt, 文本型, , , 
.程序集变量 bfml, 文本型, , , 
.程序集变量 sfbf, 逻辑型, , , 
.子程序 _部门管理_被选择, 空白型, , 
载入 (部门, _启动窗口, 真)

.子程序 _人员管理_被选择, 空白型, , 
载入 (人员, _启动窗口, 真)

.子程序 _工资管理_被选择, 空白型, , 
载入 (工资表, _启动窗口, 真)

.子程序 _退出系统_被选择, 空白型, , 
销毁 ()

.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 bu1, 文本型, , , 

赋值 (dqml, 取当前目录 ())
.如果 (等于 (输入框 (“请输入密码,您有三次机会！”, “身份验证”, , bu1, 4), 真))
    .如果 (等于 (bu1, 取文本注册表项 (“爱心使者”, “爱心使者”, “爱心使者”, “123456”)))
        
    .否则
        .如果 (等于 (输入框 (“请输入密码，您还有两次机会！”, “身份验证”, , bu1, 4), 真))
            .如果 (等于 (bu1, 取文本注册表项 (“爱心使者”, “爱心使者”, “爱心使者”, “123456”)))
                
            .否则
                .如果 (等于 (输入框 (“请输入密码，您只剩最后一次机会！”, “身份验证”, , bu1, 4), 真))
                    .如果 (等于 (bu1, 取文本注册表项 (“爱心使者”, “爱心使者”, “爱心使者”, “123456”)))
                        
                    .否则
                        信息框 (“对不起，您无权使用该系统！”, 0, )
                        销毁 ()
                    .如果结束
                    
                .否则
                    销毁 ()
                .如果结束
                
            .如果结束
            
        .否则
            销毁 ()
        .如果结束
        
    .如果结束
    
.否则
    销毁 ()
.如果结束


.子程序 _关于1_被选择, 空白型, , 
载入 (关于窗口, _启动窗口, 真)

.子程序 _密码设置_被选择, 空白型, , 
.局部变量 bu1, 文本型, , , 
.局部变量 bu2, 文本型, , , 
.局部变量 bu3, 文本型, , , 

.如果 (等于 (输入框 (“请输入旧密码”, “第一步”, , bu1, 4), 真))
    .如果 (等于 (bu1, 取文本注册表项 (“爱心使者”, “爱心使者”, “爱心使者”, “123456”)))
        .如果 (等于 (输入框 (“请输入新密码”, “第二步”, , bu2, 4), 真))
            .如果 (等于 (输入框 (“请确认新密码”, “第三步”, , bu3, 4), 真))
                .如果 (等于 (bu2, bu3))
                    写注册表项 (“爱心使者”, “爱心使者”, “爱心使者”, bu2)
                    信息框 (“密码设置完毕，请牢记！”, 0, )
                    
                .否则
                    信息框 (“密码验证错误，请慎重填写密码！”, 0, )
                    
                .如果结束
                
            .否则
                
            .如果结束
            
        .否则
            
        .如果结束
        
    .否则
        信息框 (“旧密码输入错误，您无权更改密码！”, 0, )
    .如果结束
    
.否则
    
.如果结束


.子程序 _数据库备份_被选择, 空白型, , 
.局部变量 yesno, 逻辑型, , , 

赋值 (yesno, 假)
.如果 (等于 (文件是否存在 (相加 (dqml, “\数据库\部门.bak”)), 真))
    删除文件 (相加 (dqml, “\数据库\部门.bak”))
    .如果 (等于 (复制文件 (相加 (dqml, “\数据库\部门.edb”), 相加 (dqml, “\数据库\部门.bak”)), 真))
        赋值 (yesno, 真)
    .否则
        赋值 (yesno, 假)
    .如果结束
    
.否则
    .如果 (等于 (复制文件 (相加 (dqml, “\数据库\部门.edb”), 相加 (dqml, “\数据库\部门.bak”)), 真))
        赋值 (yesno, 真)
    .否则
        赋值 (yesno, 假)
    .如果结束
    
.如果结束
.如果 (等于 (yesno, 真))
    .如果 (等于 (文件是否存在 (相加 (dqml, “\数据库\人员.bak”)), 真))
        删除文件 (相加 (dqml, “\数据库\人员.bak”))
        .如果 (等于 (复制文件 (相加 (dqml, “\数据库\人员.edb”), 相加 (dqml, “\数据库\人员.bak”)), 真))
            赋值 (yesno, 真)
        .否则
            赋值 (yesno, 假)
        .如果结束
        
    .否则
        .如果 (等于 (复制文件 (相加 (dqml, “\数据库\人员.edb”), 相加 (dqml, “\数据库\人员.bak”)), 真))
            赋值 (yesno, 真)
        .否则
            赋值 (yesno, 假)
        .如果结束
        
    .如果结束
    
.否则
    
.如果结束
.如果 (等于 (yesno, 真))
    信息框 (“数据库备份完毕！”, 0, )
.否则
    信息框 (“数据库备份失败！”, 0, )
.如果结束


.子程序 _数据库恢复_被选择, 空白型, , 
.局部变量 yesno, 逻辑型, , , 

赋值 (yesno, 假)
.如果 (并且 (等于 (文件是否存在 (相加 (dqml, “\数据库\部门.bak”)), 真), 等于 (文件是否存在 (相加 (dqml, “\数据库\人员.bak”)), 真)))
    .如果 (等于 (文件是否存在 (相加 (dqml, “\数据库\部门.edb”)), 真))
        删除文件 (相加 (dqml, “\数据库\部门.edb”))
        .如果 (等于 (复制文件 (相加 (dqml, “\数据库\部门.bak”), 相加 (dqml, “\数据库\部门.edb”)), 真))
            赋值 (yesno, 真)
        .否则
            赋值 (yesno, 假)
        .如果结束
        
    .否则
        .如果 (等于 (复制文件 (相加 (dqml, “\数据库\部门.bak”), 相加 (dqml, “\数据库\部门.edb”)), 真))
            赋值 (yesno, 真)
        .否则
            赋值 (yesno, 假)
        .如果结束
        
    .如果结束
    .如果 (等于 (yesno, 真))
        .如果 (等于 (文件是否存在 (相加 (dqml, “\数据库\人员.edb”)), 真))
            删除文件 (相加 (dqml, “\数据库\人员.edb”))
            .如果 (等于 (复制文件 (相加 (dqml, “\数据库\人员.bak”), 相加 (dqml, “\数据库\人员.edb”)), 真))
                赋值 (yesno, 真)
            .否则
                赋值 (yesno, 假)
            .如果结束
            
        .否则
            .如果 (等于 (复制文件 (相加 (dqml, “\数据库\人员.bak”), 相加 (dqml, “\数据库\人员.edb”)), 真))
                赋值 (yesno, 真)
            .否则
                赋值 (yesno, 假)
            .如果结束
            
        .如果结束
        
    .否则
        
    .如果结束
    .如果 (等于 (yesno, 真))
        信息框 (“数据库成功恢复！”, 0, )
    .否则
        信息框 (“数据库恢复失败！”, 0, )
    .如果结束
    
.否则
    信息框 (“备份文件不存在，无法恢复！”, 0, )
.如果结束


.子程序 _备份到磁盘_被选择, 空白型, , 
.局部变量 yesno, 逻辑型, , , 

赋值 (bfckbt, “请选择文件要保存到的目录”)
赋值 (bfml, “”)
赋值 (sfbf, 假)
赋值 (yesno, 假)
载入 (备份窗口, _启动窗口, 真)
.如果 (等于 (sfbf, 真))
    .如果 (或者 (等于 (文件是否存在 (相加 (bfml, “\部门.edb”)), 真), 等于 (文件是否存在 (相加 (bfml, “\人员.edb”)), 真)))
        .如果 (等于 (信息框 (“该目录下的备份文件已经存在，您要覆盖吗？”, 52, “文件存在：”), 5))
            .如果 (等于 (复制文件 (相加 (dqml, “\数据库\部门.edb”), 相加 (bfml, “\部门.edb”)), 真))
                .如果 (等于 (复制文件 (相加 (dqml, “\数据库\人员.edb”), 相加 (bfml, “\人员.edb”)), 真))
                    赋值 (yesno, 真)
                .否则
                    
                .如果结束
                
            .否则
                
            .如果结束
            .如果 (等于 (yesno, 真))
                信息框 (“数据库备份完毕！”, 0, )
            .否则
                信息框 (“数据库备份失败！”, 0, )
            .如果结束
            
        .否则
            
        .如果结束
        
    .否则
        .如果 (等于 (复制文件 (相加 (dqml, “\数据库\部门.edb”), 相加 (bfml, “\部门.edb”)), 真))
            .如果 (等于 (复制文件 (相加 (dqml, “\数据库\人员.edb”), 相加 (bfml, “\人员.edb”)), 真))
                赋值 (yesno, 真)
            .否则
                
            .如果结束
            
        .否则
            
        .如果结束
        .如果 (等于 (yesno, 真))
            信息框 (“数据库备份完毕！”, 0, )
        .否则
            信息框 (“数据库备份失败！”, 0, )
        .如果结束
        
    .如果结束
    
.否则
    
.如果结束



.子程序 _从磁盘恢复_被选择, 空白型, , 
.局部变量 yesno, 逻辑型, , , 

赋值 (bfckbt, “请选择有备份文件的目录：”)
赋值 (bfml, “”)
赋值 (sfbf, 假)
赋值 (yesno, 假)
载入 (备份窗口, _启动窗口, 真)
.如果 (等于 (sfbf, 真))
    .如果 (不等于 (取文本右边 (bfml, 1), “\”))
        赋值 (bfml, 相加 (bfml, “\”))
    .否则
        
    .如果结束
    .如果 (并且 (等于 (文件是否存在 (相加 (bfml, “部门.edb”)), 真), 等于 (文件是否存在 (相加 (bfml, “人员.edb”)), 真)))
        .如果 (等于 (复制文件 (相加 (bfml, “部门.edb”), 相加 (dqml, “\数据库\部门.edb”)), 真))
            .如果 (等于 (复制文件 (相加 (bfml, “人员.edb”), 相加 (dqml, “\数据库\人员.edb”)), 真))
                赋值 (yesno, 真)
            .否则
                
            .如果结束
            
        .否则
            
        .如果结束
        .如果 (等于 (yesno, 真))
            信息框 (“数据库成功恢复！”, 0, )
        .否则
            信息框 (“数据库恢复失败！”, 0, )
        .如果结束
        
    .否则
        信息框 (“备份文件不存在，请重新选择目录。”, 0, )
    .如果结束
    
.否则
    
.如果结束


.窗口程序集 窗口程序集2, , , 

.子程序 _按钮1_被单击, 空白型, , 
.参数 匿名参数_61, 空白型, , 

.局部变量 yesno, 逻辑型, , , 

.如果 (不等于 (., “”))
    到首记录 ()
    赋值 (yesno, 假)
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (等于 (读 (“部门”), .))
            赋值 (yesno, 真)
            跳出循环 ()
        .否则
            跳过 ()
        .如果结束
        
    .判断循环尾 ()
    .如果 (等于 (yesno, 假))
        加记录 (.)
    .否则
        信息框 (“已经存在相同部门，不能加入！”, 0, )
    .如果结束
    列表框刷新 ()
.否则
    信息框 (“请在上面框中输入部门名称！”, 0, )
.如果结束
赋值 (., “”)
获取焦点 ()

.子程序 _部门_创建完毕, 空白型, , 
打开 (相加 (_启动窗口., “\数据库\部门.edb”), , , , , , )
列表框刷新 ()
获取焦点 ()

.子程序 _按钮2_被单击, 空白型, , 
.局部变量 yesno, 整数型, , , 

.如果 (不等于 (取已选择项目数 (), 0))
    赋值 (yesno, 信息框 (“删除部门会影响人员档案，请确定档案已经调整！”, 1, ))
    .如果 (等于 (yesno, 0))
         ' 取焦点项目 ().取项目文本 ()
        到首记录 ()
        .判断循环首 (等于 (尾记录后 (), 假))
            .如果 (等于 (读 (“部门”), 取焦点项目 ().取项目文本 ()))
                删除 ()
                彻底删除 ()
                列表框刷新 ()
                跳出循环 ()
            .否则
                跳过 ()
            .如果结束
            
        .判断循环尾 ()
    .否则
        
    .如果结束
    
.否则
    信息框 (“请在列表框中选择要删除的部门！”, 0, )
.如果结束


.子程序 列表框刷新, 空白型, , 
清空 ()
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    读 (“部门”).加入项目 ()
    跳过 ()
.判断循环尾 ()

.子程序 _部门_将被销毁, 空白型, , 
全部关闭 ()

.子程序 _按钮3_被单击, 空白型, , 
销毁 ()

.子程序 _编辑框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    _按钮1_被单击 ()
.否则
    
.如果结束


.窗口程序集 窗口程序集3, , , 

.子程序 _人员_创建完毕, 空白型, , 
全部关闭 ()
赋值 (., 相加 (_启动窗口., “\数据库\部门.edb”))
打开 (相加 (_启动窗口., “\数据库\人员.edb”), , , , , , )
列表框刷新 ()

.子程序 列表框刷新, 空白型, , 
清空 ()
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    读 (“姓名”).加入项目 ()
    跳过 ()
.判断循环尾 ()
赋值 (., 0)
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (等于 (读 (“姓名”), 0.取项目文本 ()))
        赋值 (., 读 (“所属部门”))
        赋值 (., 读 (“性别”))
        赋值 (., 读 (“职务”))
        赋值 (., 读 (“月工资”))
        赋值 (., 读 (“身份证号码”))
        赋值 (., 读 (“家庭地址”))
        赋值 (., 读 (“联系电话”))
        赋值 (., 读 (“聘用日期”))
        跳出循环 ()
    .否则
        跳过 ()
    .如果结束
    
.判断循环尾 ()

.子程序 _人员_将被销毁, 空白型, , 
全部关闭 ()

.子程序 列表框刷新1, 空白型, , 
清空 ()
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (等于 (读 (“所属部门”), .))
        读 (“姓名”).加入项目 ()
    .否则
        
    .如果结束
    跳过 ()
.判断循环尾 ()
赋值 (., 0)
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (等于 (读 (“姓名”), 0.取项目文本 ()))
        赋值 (., 读 (“所属部门”))
        赋值 (., 读 (“性别”))
        赋值 (., 读 (“职务”))
        赋值 (., 读 (“月工资”))
        赋值 (., 读 (“身份证号码”))
        赋值 (., 读 (“家庭地址”))
        赋值 (., 读 (“联系电话”))
        赋值 (., 读 (“聘用日期”))
        跳出循环 ()
    .否则
        跳过 ()
    .如果结束
    
.判断循环尾 ()

.子程序 _单选框1_被单击, 空白型, , 
赋值 (., 假)
赋值 (., 假)
列表框刷新 ()

.子程序 列表框刷新2, 空白型, , 
清空 ()
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (等于 (读 (“性别”), .))
        读 (“姓名”).加入项目 ()
    .否则
        
    .如果结束
    跳过 ()
.判断循环尾 ()
赋值 (., 0)
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (等于 (读 (“姓名”), 0.取项目文本 ()))
        赋值 (., 读 (“所属部门”))
        赋值 (., 读 (“性别”))
        赋值 (., 读 (“职务”))
        赋值 (., 读 (“月工资”))
        赋值 (., 读 (“身份证号码”))
        赋值 (., 读 (“家庭地址”))
        赋值 (., 读 (“联系电话”))
        赋值 (., 读 (“聘用日期”))
        跳出循环 ()
    .否则
        跳过 ()
    .如果结束
    
.判断循环尾 ()

.子程序 _单选框3_被单击, 空白型, , 
赋值 (., 真)
赋值 (., 假)
赋值 (., 0)
列表框刷新1 ()

.子程序 _组合框2_列表被关闭, 空白型, , 
列表框刷新2 ()

.子程序 _组合框1_列表被关闭, 空白型, , 
列表框刷新1 ()

.子程序 _单选框2_被单击, 空白型, , 
赋值 (., 假)
赋值 (., 真)
赋值 (., 0)
列表框刷新2 ()

.子程序 _按钮2_被单击, 空白型, , 
载入 (添加人员, 人员, 真)

.子程序 _列表框1_列表项被选择, 空白型, , 
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (等于 (读 (“姓名”), .取项目文本 (.)))
        赋值 (., 读 (“所属部门”))
        赋值 (., 读 (“性别”))
        赋值 (., 读 (“职务”))
        赋值 (., 读 (“月工资”))
        赋值 (., 读 (“身份证号码”))
        赋值 (., 读 (“家庭地址”))
        赋值 (., 读 (“联系电话”))
        赋值 (., 读 (“聘用日期”))
        跳出循环 ()
    .否则
        跳过 ()
    .如果结束
    
.判断循环尾 ()


.子程序 _按钮5_被单击, 空白型, , 
全部关闭 ()
销毁 ()

.子程序 _按钮3_被单击, 空白型, , 
.如果 (不等于 (取已选择项目数 (), 0))
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (等于 (读 (“姓名”), 取焦点项目 ().取项目文本 ()))
            删除 ()
            彻底删除 ()
            .如果 (等于 (人员.., 真))
                人员.列表框刷新 ()
            .否则
                .如果 (等于 (人员.., 真))
                    人员.列表框刷新2 ()
                .否则
                    .如果 (等于 (人员.., 真))
                        人员.列表框刷新1 ()
                    .否则
                        
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
            跳出循环 ()
        .否则
            跳过 ()
        .如果结束
        
    .判断循环尾 ()
.否则
    信息框 (“请在人员列表中选择要删除的人员！”, 0, )
.如果结束


.子程序 _按钮4_被单击, 空白型, , 
.如果 (不等于 (取已选择项目数 (), 0))
    载入 (修改人员, 人员, 真)
.否则
    信息框 (“请在人员列表中选择要修改的人员！”, 0, )
.如果结束


.子程序 _按钮1_被单击, 空白型, , 
载入 (查找人员, 人员, 真)

.窗口程序集 窗口程序集4, , , 

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 yesno, 逻辑型, , , 

到首记录 ()
赋值 (yesno, 假)
.如果 (不等于 (., “”))
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (等于 (读 (“姓名”), .))
            赋值 (yesno, 真)
            跳出循环 ()
        .否则
            跳过 ()
        .如果结束
        
    .判断循环尾 ()
    .如果 (等于 (yesno, 假))
        加记录 (., ., ., ., ., ., ., ., .)
        赋值 (., “”)
        赋值 (., “”)
        赋值 (., “”)
        赋值 (., “”)
        赋值 (., “”)
        赋值 (., “”)
        赋值 (., “”)
        获取焦点 ()
    .否则
        信息框 (相加 (“档案中已经存在名为”, #左引号, ., #右引号, “的人员，请换名后再添加！”), 0, )
    .如果结束
    
.否则
    信息框 (“姓名不能为空，请输入姓名！”, 0, )
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
.如果 (等于 (人员.., 真))
    人员.列表框刷新 ()
.否则
    .如果 (等于 (人员.., 真))
        人员.列表框刷新2 ()
    .否则
        .如果 (等于 (人员.., 真))
            人员.列表框刷新1 ()
        .否则
            
        .如果结束
        
    .如果结束
    
.如果结束
销毁 ()

.子程序 _添加人员_创建完毕, 空白型, , 
赋值 (., 相加 (_启动窗口., “\数据库\部门.edb”))

.窗口程序集 窗口程序集5, , , 

.程序集变量 dqmc, 文本型, , , 
.子程序 _修改人员_创建完毕, 空白型, , 
赋值 (., 相加 (_启动窗口., “\数据库\部门.edb”))
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (等于 (读 (“姓名”), 人员.取项目文本 (., 人员..)))
        赋值 (., 读 (“姓名”))
        读 (“性别”).选择 ()
        读 (“所属部门”).选择 ()
        赋值 (., 读 (“职务”))
        赋值 (., 读 (“月工资”))
        赋值 (., 读 (“身份证号码”))
        赋值 (., 读 (“家庭地址”))
        赋值 (., 读 (“联系电话”))
        赋值 (., 读 (“聘用日期”))
        跳出循环 ()
    .否则
        跳过 ()
    .如果结束
    
.判断循环尾 ()
赋值 (dqmc, .)

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 jlh, 整数型, , , 
.局部变量 yesno, 逻辑型, , , 

赋值 (jlh, 取记录号 ())
赋值 (yesno, 假)
.如果 (不等于 (., “”))
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (并且 (等于 (读 (“姓名”), .), 不等于 (., dqmc)))
            赋值 (yesno, 真)
            跳出循环 ()
        .否则
            跳过 ()
        .如果结束
        
    .判断循环尾 ()
    跳到 (jlh)
    .如果 (等于 (yesno, 假))
        修改 (., ., ., ., ., ., ., ., .)
        .如果 (等于 (人员.., 真))
            人员.列表框刷新 ()
        .否则
            .如果 (等于 (人员.., 真))
                人员.列表框刷新2 ()
            .否则
                .如果 (等于 (人员.., 真))
                    人员.列表框刷新1 ()
                .否则
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        销毁 ()
    .否则
        信息框 (相加 (“档案中已经存在名为”, #左引号, ., #右引号, “的人员，请换名后再添加！”), 0, )
    .如果结束
    
.否则
    信息框 (“姓名不能为空，请输入姓名！”, 0, )
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集6, , , 

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 cxtj, 逻辑型, , , 

人员.清空 (.)
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    赋值 (cxtj, 真)
    .如果 (不等于 (., “”))
        .如果 (等于 (读 (“姓名”), .))
            
        .否则
            赋值 (cxtj, 假)
        .如果结束
        
    .否则
        
    .如果结束
    .如果 (不等于 (., “”))
        .如果 (等于 (读 (“性别”), .))
            
        .否则
            赋值 (cxtj, 假)
        .如果结束
        
    .否则
        
    .如果结束
    .如果 (不等于 (., “”))
        .如果 (等于 (读 (“所属部门”), .))
            
        .否则
            赋值 (cxtj, 假)
        .如果结束
        
    .否则
        
    .如果结束
    .如果 (不等于 (., “”))
        .如果 (等于 (读 (“职务”), .))
            
        .否则
            赋值 (cxtj, 假)
        .如果结束
        
    .否则
        
    .如果结束
    .如果 (不等于 (., “”))
        .如果 (等于 (., “等于”))
            .如果 (等于 (到数值 (读 (“月工资”)), 到数值 (.)))
                
            .否则
                赋值 (cxtj, 假)
            .如果结束
            
        .否则
            .如果 (等于 (., “大于”))
                .如果 (大于 (到数值 (读 (“月工资”)), 到数值 (.)))
                    
                .否则
                    赋值 (cxtj, 假)
                .如果结束
                
            .否则
                .如果 (等于 (., “小于”))
                    .如果 (小于 (到数值 (读 (“月工资”)), 到数值 (.)))
                        
                    .否则
                        赋值 (cxtj, 假)
                    .如果结束
                    
                .否则
                    .如果 (等于 (., “大于等于”))
                        .如果 (大于或等于 (到数值 (读 (“月工资”)), 到数值 (.)))
                            
                        .否则
                            赋值 (cxtj, 假)
                        .如果结束
                        
                    .否则
                        .如果 (等于 (., “小于等于”))
                            .如果 (小于或等于 (到数值 (读 (“月工资”)), 到数值 (.)))
                                
                            .否则
                                赋值 (cxtj, 假)
                            .如果结束
                            
                        .否则
                            
                        .如果结束
                        
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .否则
        
    .如果结束
    .如果 (不等于 (., “”))
        .如果 (等于 (读 (“身份证号码”), .))
            
        .否则
            赋值 (cxtj, 假)
        .如果结束
        
    .否则
        
    .如果结束
    .如果 (不等于 (., “”))
        .如果 (等于 (读 (“家庭地址”), .))
            
        .否则
            赋值 (cxtj, 假)
        .如果结束
        
    .否则
        
    .如果结束
    .如果 (不等于 (., “”))
        .如果 (等于 (读 (“联系电话”), .))
            
        .否则
            赋值 (cxtj, 假)
        .如果结束
        
    .否则
        
    .如果结束
    .如果 (不等于 (., “”))
        .如果 (等于 (读 (“聘请日期”), .))
            
        .否则
            赋值 (cxtj, 假)
        .如果结束
        
    .否则
        
    .如果结束
    
    .如果 (等于 (cxtj, 真))
        人员.加入项目 (., 读 (“姓名”), )
    .否则
        
    .如果结束
    跳过 ()
.判断循环尾 ()

.子程序 _查找人员_创建完毕, 空白型, , 
赋值 (., 相加 (_启动窗口., “\数据库\部门.edb”))

.窗口程序集 窗口程序集7, , , 

.程序集变量 现行文件名, 文本型, , , 
.程序集变量 是否被修改, 逻辑型, , , 
.子程序 _工资表_尺寸被改变, 空白型, , 
5.移动 (5, 相减 (取用户区宽度 (), 10), 相减 (取用户区高度 (), 10))

.子程序 _新建_被选择, 空白型, , 
.如果真 (等于 (询问保存文档 (), 假))
    50.初始尺寸 (10)
    赋值 (是否被修改, 假)
    打开并读入文件 (相加 (_启动窗口., “\数据库\工资库.lgq”))
.如果真结束


.子程序 _打开_被选择, 空白型, , 
.局部变量 文件号, 整数型, , , 

.如果真 (等于 (询问保存文档 (), 假))
    赋值 (., “请输入欲打开的表格文件名：”)
    赋值 (., 0)
    .如果真 (等于 (打开 (), 真))
        打开并读入文件 (.)
    .如果真结束
    
.如果真结束


.子程序 打开并读入文件, 空白型, , 
.参数 文件名, 文本型, , 

.如果 (等于 (文件名.从文件读 (), 假))
    信息框 (“打开文件失败！”, #错误图标, “错误”)
.否则
    赋值 (是否被修改, 假)
    赋值 (现行文件名, 文件名)
.如果结束


.子程序 _保存_被选择, 空白型, , 
.如果 (等于 (取文本右边 (现行文件名, 4), “.grd”))
    保存文档 ()
.否则
    _另存为_被选择 ()
.如果结束


.子程序 _另存为_被选择, 空白型, , 
.局部变量 文件名, 文本型, 静态, , 
.局部变量 保存文件名, 文本型, , , 
.局部变量 文件号, 整数型, , , 

赋值 (保存文件名, 选择 (等于 (文件名, “”), 现行文件名, 文件名))
.如果真 (或者 (等于 (保存文件名, “”), 不等于 (取文本右边 (现行文件名, 4), “.grd”)))
    赋值 (., “请输入欲保存到的表格文件名：”)
    赋值 (., 1)
    .如果真 (等于 (打开 (), 假))
        返回 ()
    .如果真结束
    赋值 (保存文件名, .)
.如果真结束
赋值 (是否被修改, 假)
.如果 (等于 (保存文件名.存到文件 (), 假))
    信息框 (“保存文件失败！”, #错误图标, “错误”)
.否则
    赋值 (现行文件名, 保存文件名)
.如果结束


.子程序 _打印_被选择, 空白型, , 
.如果真 (打印设置 ())
    设置修改 ()
    .打印 ()
.如果真结束


.子程序 _退出_被选择, 空白型, , 
.如果真 (等于 (询问保存文档 (), 假))
    销毁 () ' 通过销毁主窗口退出程序
.如果真结束


.子程序 _剪切_被选择, 空白型, , 
设置修改 ()
取光标行号 ().复制 (取光标列号 (), 取选择行数 (), 取选择列数 ())
取光标行号 ().清除 (取光标列号 (), 取选择行数 (), 取选择列数 ())

.子程序 _复制_被选择, 空白型, , 
取光标行号 ().复制 (取光标列号 (), 取选择行数 (), 取选择列数 ())

.子程序 _粘贴_被选择, 空白型, , 
设置修改 ()
粘贴到光标处 ()

.子程序 _工资表_可否被关闭, 逻辑型, , 
返回 (取反 (询问保存文档 ()))

.子程序 询问保存文档, 逻辑型, , 返回真表示用户选择了中止
.局部变量 询问返回, 整数型, , , 

.如果真 (等于 (是否被修改, 真))
    赋值 (询问返回, 信息框 (“文件已经被修改，是否保存？”, 相加 (#取消是否钮, #询问图标), “询问”))
    .如果真 (等于 (询问返回, #取消钮))
        返回 (真)
    .如果真结束
    .如果真 (等于 (询问返回, #是钮))
        .如果真 (等于 (保存文档 (), 真))
            返回 (真)
        .如果真结束
        
    .如果真结束
    
.如果真结束
返回 (假)

.子程序 保存文档, 逻辑型, , 返回真表示用户选择了中止
.参数 文件名, 文本型, 可空, 

.局部变量 保存文件名, 文本型, , , 
.局部变量 文件号, 整数型, , , 

赋值 (保存文件名, 选择 (是否为空 (文件名), 现行文件名, 文件名))
.如果真 (或者 (等于 (保存文件名, “”), 不等于 (取文本右边 (现行文件名, 4), “.grd”)))
    赋值 (., “请输入欲保存到的表格文件名：”)
    赋值 (., 1)
    .如果真 (等于 (打开 (), 假))
        返回 (真)
    .如果真结束
    赋值 (保存文件名, .)
.如果真结束
赋值 (是否被修改, 假)
.如果 (等于 (保存文件名.存到文件 (), 假))
    信息框 (“保存文件失败！”, #错误图标, “错误”)
.否则
    赋值 (现行文件名, 保存文件名)
.如果结束
返回 (假)

.子程序 _打印设置_被选择, 空白型, , 
.如果真 (打印设置 ())
    设置修改 ()
.如果真结束


.子程序 _打印预览_被选择, 空白型, , 
打印预览 ()

.子程序 _清空_被选择, 空白型, , 
设置修改 ()
取光标行号 ().清除 (取光标列号 (), 取选择行数 (), 取选择列数 ())

.子程序 _组合_被选择, 空白型, , 
设置修改 ()
取光标行号 ().合并 (取光标列号 (), 取选择行数 (), 取选择列数 ())

.子程序 _分解_被选择, 空白型, , 
设置修改 ()
取光标行号 ().分解 (取光标列号 ())

.子程序 _插入行_被选择, 空白型, , 
设置修改 ()
.如果 (不等于 (., “数据库提供者1”))
    取光标行号 ().插入行 ()
.否则
    相加 (取行数 (), 1).插入行 ()
    取行数 ().置光标 (1)
.如果结束


.子程序 _插入列_被选择, 空白型, , 
设置修改 ()
取光标列号 ().插入列 ()

.子程序 _删除行_被选择, 空白型, , 
设置修改 ()
取光标行号 ().删除行 (取选择行数 ())

.子程序 _删除列_被选择, 空白型, , 
设置修改 ()
取光标列号 ().删除列 (取选择列数 ())

.子程序 _比例50_被选择, 空白型, , 
赋值 (., 50)

.子程序 _比例100_被选择, 空白型, , 
赋值 (., 100)

.子程序 _比例200_被选择, 空白型, , 
赋值 (., 200)

.子程序 _等宽_被选择, 空白型, , 
等宽缩放 ()

.子程序 _打开数据库_被选择, 空白型, , 此功能用作演示合并多个数据提供者数据的方法
.如果真 (并且 (等于 (询问保存文档 (), 假), 等于 (打开 (), 真), 不等于 (., “”)))
    打开数据库 (.)
.如果真结束


.子程序 打开数据库, 空白型, , 
.参数 欲打开数据库文件, 文本型, , 

.局部变量 字段数, 整数型, , , 
.局部变量 字段索引, 整数型, , , 
.局部变量 字段名称, 文本型, , "0", 

.如果真 (打开 (欲打开数据库文件, , , , , , )) ' 打开数据库获取所有字段的名称
    赋值 (字段数, 取字段数 ())
    .计次循环首 (字段数, 字段索引)
        .如果真 (不等于 (取字段类型 (字段索引), #字节集型))
            加入成员 (字段名称, 取字段名 (字段索引))
        .如果真结束
        
    .计次循环尾 ()
    关闭 ()
    
    赋值 (字段数, 取数组成员数 (字段名称))
    1.初始尺寸 (字段数)
    .计次循环首 (字段数, 字段索引)
        1.置文本 (字段索引, 字段名称 [字段索引])
    .计次循环尾 ()
    1.置字体属性 (1, , 字段数, #粗体)
    1.置表头行数 ()
    赋值 (., 欲打开数据库文件)
    .添加 ()
    赋值 (是否被修改, 假)
    赋值 (现行文件名, “”)
.如果真结束


.子程序 _表格1_内容被改变, 空白型, , 
.参数 行号, 整数型, , 
.参数 列号, 整数型, , 
.参数 行数, 整数型, , 
.参数 列数, 整数型, , 

.局部变量 dyts, 整数型, , , 
.局部变量 cs, 整数型, , , 
.局部变量 gs, 整数型, , , 
.局部变量 jc, 文本型, , , 
.局部变量 xms, 整数型, , , 
.局部变量 sfje, 整数型, , , 

.如果 (或者 (等于 (列号, 3), 等于 (列号, 5)))
    行号.置文本 (相加 (列号, 1), 到文本 (相乘 (到数值 (行号.取文本 (列号)), 5)))
.否则
    .如果 (等于 (列号, 1))
        到首记录 ()
        赋值 (gs, 0)
        清空 ()
        .判断循环首 (等于 (尾记录后 (), 假))
            赋值 (cs, 0)
            赋值 (jc, “”)
            .计次循环首 (相除 (取文本长度 (读 (“姓名”)), 2), cs)
                赋值 (jc, 相加 (jc, 取文本左边 (取拼音 (取文本中间 (读 (“姓名”), 相减 (相乘 (cs, 2), 1), 2), 1), 1)))
            .计次循环尾 ()
            .如果 (等于 (行号.取文本 (列号), jc))
                读 (“姓名”).加入项目 ()
                赋值 (gs, 相加 (gs, 1))
            .否则
                
            .如果结束
            跳过 ()
        .判断循环尾 ()
        .如果 (等于 (gs, 1))
            行号.置文本 (列号, 0.取项目文本 ())
            到首记录 ()
            .判断循环首 (等于 (尾记录后 (), 假))
                .如果 (等于 (读 (“姓名”), 行号.取文本 (列号)))
                    行号.置文本 (7, 读 (“月工资”))
                    跳出循环 ()
                .否则
                    跳过 ()
                .如果结束
                
            .判断循环尾 ()
            
        .否则
            .如果 (等于 (gs, 0))
                
            .否则
                载入 (选择姓名, , 假)
                赋值 (xms, 1)
                赋值 (选择姓名., 行号)
                赋值 (选择姓名., 列号)
                .计次循环首 (取项目数 (), xms)
                    选择姓名.加入项目 (., 相减 (xms, 1).取项目文本 (), )
                .计次循环尾 ()
                选择姓名.置焦点项目 (., 0)
            .如果结束
            
        .如果结束
        
    .否则
        
    .如果结束
    
.如果结束
设置修改 ()
赋值 (sfje, 0)
.如果 (并且 (不等于 (取光标行号 ().取文本 (1), “”), 不等于 (取光标行号 ().取文本 (2), “”), 不等于 (取光标行号 ().取文本 (4), “”), 不等于 (取光标行号 ().取文本 (6), “”), 不等于 (取光标行号 ().取文本 (7), “”), 大于 (到数值 (取文本中间 (1.取文本 (1), 21, 2)), 0), 小于 (到数值 (取文本中间 (1.取文本 (1), 21, 2)), 13)))
    赋值 (dyts, 取某月天数 (取年份 (取现行时间 ()), 到数值 (取文本中间 (1.取文本 (1), 21, 2))))
    .如果 (大于 (相减 (dyts, 2), 到数值 (取光标行号 ().取文本 (2))))
        赋值 (sfje, 相减 (相加 (到数值 (取光标行号 ().取文本 (7)), 到数值 (取光标行号 ().取文本 (4))), 到数值 (取光标行号 ().取文本 (6)), 四舍五入 (相乘 (相除 (到数值 (取光标行号 ().取文本 (7)), dyts), 相减 (dyts, 2, 到数值 (取光标行号 ().取文本 (2)))), 0)))
        取光标行号 ().置文本 (8, 到文本 (sfje))
    .否则
        赋值 (sfje, 相减 (相加 (到数值 (取光标行号 ().取文本 (7)), 到数值 (取光标行号 ().取文本 (4))), 到数值 (取光标行号 ().取文本 (6))))
        取光标行号 ().置文本 (8, 到文本 (sfje))
    .如果结束
    
.否则
    
.如果结束


.子程序 _修改数据库_被选择, 空白型, , 此功能用作演示数据提供者属性用法
.如果真 (并且 (等于 (询问保存文档 (), 假), 等于 (打开 (), 真), 不等于 (., “”)))
    赋值 (., .)
    赋值 (., “数据库提供者1”) ' 请注意使用数据库提供者与使用通用提供者的不同.如不能改变表格行高等.这是由提供者的数据存储能力决定的.
.如果真结束


.子程序 _退出数据库修改_被选择, 空白型, , 
赋值 (., “通用提供者1”)

.子程序 _表格1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()

.子程序 _置行高_被选择, 空白型, , 
.局部变量 行高, 整数型, , , 

.如果真 (并且 (输入框 (“请输入新行高（单位0.1毫米）”, “新行高”, , 行高, #输入整数), 大于 (行高, 0)))
    取光标行号 ().置行高 (取选择行数 (), 行高)
    设置修改 ()
.如果真结束


.子程序 _置列宽_被选择, 空白型, , 
.局部变量 列宽, 整数型, , , 

.如果真 (并且 (输入框 (“请输入新列宽（单位0.1毫米）”, “新列宽”, , 列宽, #输入整数), 大于 (列宽, 0)))
    取光标列号 ().置列宽 (取选择列数 (), 列宽)
    设置修改 ()
.如果真结束


.子程序 _表格属性_被选择, 空白型, , 
载入 (表格属性窗口1, 工资表, 真)

.子程序 _工资表_创建完毕, 空白型, , 
.局部变量 参数文本, 文本型, , "0", 

打开 (相加 (_启动窗口., “\数据库\人员.edb”), , , , , , )
打开并读入文件 (相加 (_启动窗口., “\数据库\工资库.lgq”))

.子程序 _添加数据_被选择, 空白型, , 
赋值 (., “请输入欲添加进来的表格文件名：”)
赋值 (., 0)
.如果真 (等于 (打开 (), 真))
    .如果 (等于 (.从文件读 (.), 假)) ' 数据源2仅在此处使用
        信息框 (“打开欲添加文件失败！”, #错误图标, “错误”)
    .否则
        .添加 ()
        设置修改 ()
        1.初始尺寸 (1) ' 因为使用的是通用提供者2,所以可以初始化尺寸.在此处清除通用提供者2内的数据.
    .如果结束
    
.如果真结束


.子程序 _文本型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置类型 (取光标列号 (), 取选择行数 (), 取选择列数 (), #文本型)

.子程序 _图片文件名型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置类型 (取光标列号 (), 取选择行数 (), 取选择列数 (), #图片文件名)

.子程序 _图片数据型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置类型 (取光标列号 (), 取选择行数 (), 取选择列数 (), #图片数据)

.子程序 _文本颜色_被选择, 空白型, , 
赋值 (颜色选择标题, “请选择文本颜色:”)
载入 (颜色选择窗口1, , 真)
.如果真 (等于 (返回颜色有效, 真))
    设置修改 ()
    取光标行号 ().置文本色 (取光标列号 (), 取选择行数 (), 取选择列数 (), 返回颜色)
.如果真结束


.子程序 _背景颜色_被选择, 空白型, , 
赋值 (颜色选择标题, “请选择背景颜色:”)
载入 (颜色选择窗口1, , 真)
.如果真 (等于 (返回颜色有效, 真))
    设置修改 ()
    取光标行号 ().置背景色 (取光标列号 (), 取选择行数 (), 取选择列数 (), 返回颜色)
.如果真结束


.子程序 _字体_被选择, 空白型, , 
.局部变量 字体属性, 整数型, , , 
.局部变量 字体尺寸, 双精度小数型, , , 

.如果真 (等于 (打开 (), 真))
    .如果真 (等于 (., 真))
        赋值 (字体属性, 相加 (字体属性, #粗体))
    .如果真结束
    .如果真 (等于 (., 真))
        赋值 (字体属性, 相加 (字体属性, #斜体))
    .如果真结束
    .如果真 (等于 (., 真))
        赋值 (字体属性, 相加 (字体属性, #删除线))
    .如果真结束
    .如果真 (等于 (., 真))
        赋值 (字体属性, 相加 (字体属性, #下划线))
    .如果真结束
    取光标行号 ().置字体属性 (取光标列号 (), 取选择行数 (), 取选择列数 (), 字体属性)
    取光标行号 ().置字体名 (取光标列号 (), 取选择行数 (), 取选择列数 (), .)
    赋值 (字体尺寸, 相除 (相乘 (., 10), 72, 0.0394)) ' 由于字体对话框返回的字体尺寸是以1/72英寸为单位,现将其转换为0.1MM.
    取光标行号 ().置字体尺寸 (取光标列号 (), 取选择行数 (), 取选择列数 (), 字体尺寸)
    设置修改 ()
.如果真结束


.子程序 _边距_被选择, 空白型, , 
.局部变量 边距, 整数型, , , 

.如果真 (输入框 (“请输入边距(单位0.1MM):”, “单元格边距设置”, “9”, 边距, #输入整数))
    设置修改 ()
    取光标行号 ().置边距 (取光标列号 (), 取选择行数 (), 取选择列数 (), 边距)
.如果真结束


.子程序 _通常型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #通常型)

.子程序 _字节型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #字节型)

.子程序 _短整数型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #短整数型)

.子程序 _整数型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #整数型)

.子程序 _长整数型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #长整数型)

.子程序 _小数型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #小数型)

.子程序 _双精度小数型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #双精度小数型)

.子程序 _逻辑型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #逻辑型)

.子程序 _日期时间型_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置文本输入格式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #日期时间型)

.子程序 _上左_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #上左)

.子程序 _上中_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #上中)

.子程序 _上右_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #上右)

.子程序 _中左_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #中左)

.子程序 _中中_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #中中)

.子程序 _中右_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #中右)

.子程序 _下左_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #下左)

.子程序 _下中_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #下中)

.子程序 _下右_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #下右)

.子程序 _缩放图片_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #缩放图片)

.子程序 _居中图片_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #居中图片)

.子程序 _缩放居中图片_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #缩放居中图片)

.子程序 _平铺图片_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #平铺图片)

.子程序 _缩放平铺图片_被选择, 空白型, , 
设置修改 ()
取光标行号 ().置对齐方式 (取光标列号 (), 取选择行数 (), 取选择列数 (), #缩放平铺图片)

.子程序 _添加边框_被选择, 空白型, , 
设置修改 ()
取光标行号 ().加线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), 相加 (#左边框, #上边框, #右边框, #下边框))

.子程序 _添加全部表格线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().加线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))

.子程序 _添加水平表格线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().加线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), #水平线)

.子程序 _添加垂直表格线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().加线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), #垂直线)

.子程序 _添加单斜线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().加线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), #单斜线)

.子程序 _添加双斜线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().加线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), #双斜线)

.子程序 _添加交叉线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().加线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), #交叉线)

.子程序 _清除内部表格线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().删线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), 相加 (#水平线, #垂直线))

.子程序 _清除斜线或交叉线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().删线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), 相加 (#单斜线, #双斜线, #交叉线))

.子程序 _清除所有表格线_被选择, 空白型, , 
设置修改 ()
取光标行号 ().删线条 (取光标列号 (), 取选择行数 (), 取选择列数 (), 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))

.子程序 _写入图片数据_被选择, 空白型, , 
 ' 图片文件名称可以直接以文本方式写入.
.如果真 (等于 (打开 (), 真))
    设置修改 ()
    取光标行号 ().置数据 (取光标列号 (), 读入文件 (.))
.如果真结束


.子程序 _置表头行数_被选择, 空白型, , 
.局部变量 表头行数, 整数型, , , 

.如果真 (输入框 (“请输入表头行数:”, “表头行数设置”, “0”, 表头行数, #输入整数))
    设置修改 ()
    表头行数.置表头行数 ()
.如果真结束


.子程序 _置表头列数_被选择, 空白型, , 
.局部变量 表头列数, 整数型, , , 

.如果真 (输入框 (“请输入表头列数:”, “表头列数设置”, “0”, 表头列数, #输入整数))
    设置修改 ()
    表头列数.置表头列数 ()
.如果真结束


.子程序 设置修改, 空白型, , 
.如果真 (不等于 (., “数据库提供者1”))
    赋值 (是否被修改, 真)
.如果真结束


.子程序 _表格1_选择行列数改变, 空白型, , 
.局部变量 sfje, 整数型, , , 
.局部变量 dyts, 整数型, , , 

.如果 (等于 (取光标列号 (), 4))
    取光标行号 ().置光标 (5)
.否则
    .如果 (或者 (等于 (取光标列号 (), 6), 等于 (取光标列号 (), 7), 等于 (取光标列号 (), 8), 等于 (取光标列号 (), 9)))
        相加 (取光标行号 (), 1).置光标 (1)
    .否则
        
    .如果结束
    
.如果结束


.子程序 _月份_被选择, 空白型, , 
.局部变量 dqyf, 文本型, , , 

.如果 (等于 (输入框 (“请输入当前工资表的月份”, “输入月份”, , dqyf, ), 真))
    .如果 (不等于 (dqyf, “”))
        .如果 (并且 (大于 (到数值 (dqyf), 0), 小于 (到数值 (dqyf), 10)))
            赋值 (dqyf, 相加 (“0”, dqyf))
        .否则
            
        .如果结束
        0.置表头行数 ()
        1.置文本 (1, 相加 (“爱心使者家政服务中心”, dqyf, “月份工资表”))
        2.置表头行数 ()
    .否则
        
    .如果结束
    
.否则
    
.如果结束


.子程序 _自动添加表格线_被选择, 空白型, , 
.局部变量 dqhh, 整数型, , , 

.计次循环首 (相减 (取行数 (), 2), dqhh)
    .如果 (不等于 (相加 (dqhh, 2).取文本 (1), “”))
        
    .否则
        跳出循环 ()
    .如果结束
    
.计次循环尾 ()
3.加线条 (1, 相减 (dqhh, 1), 10, 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))

.子程序 _自动数据累计_被选择, 空白型, , 
.局部变量 cqts, 整数型, , , 
.局部变量 jiaf, 整数型, , , 
.局部变量 jiafje, 整数型, , , 
.局部变量 jianf, 整数型, , , 
.局部变量 jianfje, 整数型, , , 
.局部变量 yingf, 整数型, , , 
.局部变量 shif, 整数型, , , 
.局部变量 dqhh, 整数型, , , 

赋值 (cqts, 0)
赋值 (jiaf, 0)
赋值 (jiafje, 0)
赋值 (jianf, 0)
赋值 (jianfje, 0)
赋值 (yingf, 0)
赋值 (shif, 0)
.计次循环首 (相减 (取行数 (), 2), dqhh)
    .如果 (并且 (不等于 (相加 (dqhh, 2).取文本 (1), “”), 不等于 (相加 (dqhh, 2).取文本 (1), “累计”)))
        赋值 (cqts, 相加 (cqts, 到数值 (相加 (dqhh, 2).取文本 (2))))
        赋值 (jiaf, 相加 (jiaf, 到数值 (相加 (dqhh, 2).取文本 (3))))
        赋值 (jiafje, 相加 (jiafje, 到数值 (相加 (dqhh, 2).取文本 (4))))
        赋值 (jianf, 相加 (jianf, 到数值 (相加 (dqhh, 2).取文本 (5))))
        赋值 (jianfje, 相加 (jianfje, 到数值 (相加 (dqhh, 2).取文本 (6))))
        赋值 (yingf, 相加 (yingf, 到数值 (相加 (dqhh, 2).取文本 (7))))
        赋值 (shif, 相加 (shif, 到数值 (相加 (dqhh, 2).取文本 (8))))
    .否则
        跳出循环 ()
    .如果结束
    
.计次循环尾 ()
.如果 (大于 (相加 (dqhh, 2), 取行数 ()))
    信息框 (“表格数据行数不够,请先插入新行.”, 0, )
.否则
    相加 (dqhh, 2).置文本 (1, “累计”)
    相加 (dqhh, 2).置文本 (2, 到文本 (cqts))
    相加 (dqhh, 2).置文本 (3, 到文本 (jiaf))
    相加 (dqhh, 2).置文本 (4, 到文本 (jiafje))
    相加 (dqhh, 2).置文本 (6, 到文本 (jianfje))
    相加 (dqhh, 2).置文本 (5, 到文本 (jianf))
    相加 (dqhh, 2).置文本 (7, 到文本 (yingf))
    相加 (dqhh, 2).置文本 (8, 到文本 (shif))
.如果结束


.子程序 _工资表_将被销毁, 空白型, , 
全部关闭 ()

.窗口程序集 窗口程序集8, , , 

.子程序 _关于窗口_创建完毕, 空白型, , 
赋值 (., 相加 (“------------------------------------”, #换行符, “爱心使者家政服务中心人力资源管理系统”, #换行符, “------------------------------------”, #换行符, “策划：寿光市光庆电脑工作室”, #换行符, “编程：卢光庆”, #换行符, “地址：寿光市圣城街183号”, #换行符, “      寿光日报社东100米路南”, #换行符, “电话：13964620822”, #换行符, #换行符, “------------------------------------”, #换行符, “爱心使者家政服务中心人力资源管理系统”, #换行符, “------------------------------------”, #换行符, “策划：寿光市光庆电脑工作室”, #换行符, “编程：卢光庆”, #换行符, “地址：寿光市圣城街183号”, #换行符, “      寿光日报社东100米路南”, #换行符, “电话：13964620822”))

.子程序 _时钟1_周期事件, 空白型, , 
.如果 (小于 (., -135))
    赋值 (., 7)
.否则
    赋值 (., 相减 (., 1))
.如果结束


.窗口程序集 窗口程序集9, , , 

.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()

.子程序 _确定按钮_被单击, 空白型, , 
赋值 (工资表.., .)
赋值 (工资表.., .)
赋值 (工资表.., .)
赋值 (工资表.., .)
赋值 (工资表.., .)
赋值 (工资表.., .)
赋值 (工资表.., .)
赋值 (工资表.., .)
销毁 ()

.子程序 _表格属性窗口_创建完毕, 空白型, , 
赋值 (., 工资表..)
赋值 (., 工资表..)
赋值 (., 工资表..)
赋值 (., 工资表..)
赋值 (., 工资表..)
赋值 (., 工资表..)
赋值 (., 工资表..)
赋值 (., 工资表..)

.窗口程序集 窗口程序集10, , , 

.子程序 _颜色选择窗口_创建完毕, 空白型, , 
赋值 (返回颜色有效, 假)
赋值 (., 颜色选择标题)

.子程序 _确认按钮_被单击, 空白型, , 
赋值 (返回颜色有效, 真)
赋值 (返回颜色, .)
销毁 ()

.子程序 _取消按钮_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口程序集11, , , 

.程序集变量 hh, 整数型, , , 
.程序集变量 lh, 整数型, , , 
.子程序 _列表框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    工资表.置文本 (., hh, lh, 取焦点项目 ().取项目文本 ())
    到首记录 ()
    .判断循环首 (等于 (尾记录后 (), 假))
        .如果 (等于 (读 (“姓名”), 工资表.取文本 (., hh, lh)))
            工资表.置文本 (., hh, 7, 读 (“月工资”))
            跳出循环 ()
        .否则
            跳过 ()
        .如果结束
        
    .判断循环尾 ()
    销毁 ()
.否则
    
.如果结束


.子程序 _列表框1_双击选择, 空白型, , 
工资表.置文本 (., hh, lh, 取焦点项目 ().取项目文本 ())
到首记录 ()
.判断循环首 (等于 (尾记录后 (), 假))
    .如果 (等于 (读 (“姓名”), 工资表.取文本 (., hh, lh)))
        工资表.置文本 (., hh, 7, 读 (“月工资”))
        跳出循环 ()
    .否则
        跳过 ()
    .如果结束
    
.判断循环尾 ()
销毁 ()

.窗口程序集 窗口程序集12, , , 

.子程序 _驱动器框1_驱动器被改变, 空白型, , 
赋值 (., 相加 (., “:\”))

.子程序 _备份窗口_创建完毕, 空白型, , 
赋值 (备份窗口., _启动窗口.)

.子程序 _按钮1_被单击, 空白型, , 
赋值 (_启动窗口., 真)
赋值 (_启动窗口., .)
销毁 ()

.子程序 _按钮2_被单击, 空白型, , 
赋值 (_启动窗口., 假)
销毁 ()


 ' 不属于任何一个程序集、类模块的函数：
