 ' 文件类型：Windows窗口程序

 ' 程序名称：提示框模块2.7
 ' 程序描述：版本2.7
――――――――
用纯净的Win32 api实现的提示框，虽然还不是非常的强大，不过已经可以满足很多场合的需求。
――――――――
taowen作品，银戒指只修改很小地方，不用外部dll
2.7版增加了可选择气泡型和可修改提示颜色
 ' 程序作者：影
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0



.常量 GWL_STYLE, "-16", , 
.常量 ICC_BAR_CLASSES, "4", , 
.常量 WS_POPUP, "-2147483648", , 
.常量 TTS_NOPREFIX, "2", , 
.常量 TTS_ALWAYSTIP, "1", , 
.常量 TTS_BALLOON, "64", , 气泡型
.常量 TTS_NOFADE, "32", , 动画显示，没什么效果，所以没用
.常量 CW_USEDEFAULT, "32768", , 
.常量 HWND_TOPMOST, "-1", , 
.常量 SWP_NOMOVE, "2", , 
.常量 SWP_NOSIZE, "1", , 
.常量 SWP_NOACTIVATE, "16", , 
.常量 WS_EX_TOPMOST, "8", , 
.常量 TTF_SUBCLASS, "16", , 
.常量 TTM_ADDTOOL, "1028", , 
.常量 TTM_UPDATETIPTEXT, "1036", , 
.常量 TTM_DELTOOL, "1029", , 
.常量 TTM_SETMAXTIPWIDTH, "1048", , 是否多行显示
.常量 TTM_SETTIPBKCOLOR, "1043", , 提示背景颜色
.常量 TTM_SETTIPTEXTCOLOR, "1044", , 提示文本颜色
.常量 COLOR_INFOTEXT, "23", , NT 3.51以上
.常量 COLOR_INFOBK, "24", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库




数据类型 初始化控件结构, , 
    .成员 结构大小, 整数型, , , 
    .成员 控件标志, 整数型, , , 

数据类型 矩形, , 
    .成员 左边, 整数型, , , 
    .成员 顶边, 整数型, , , 
    .成员 右边, 整数型, , , 
    .成员 底边, 整数型, , , 

数据类型 提示框信息, , 
    .成员 结构大小, 整数型, , , 
    .成员 显示标志, 整数型, , , 
    .成员 窗口句柄, 整数型, , , 
    .成员 控件标识, 整数型, , , 
    .成员 客户区矩形, 矩形, , , 
    .成员 程序句柄, 整数型, , , 
    .成员 文本, 文本型, , , 
    .成员 额外数据, 整数型, , , 

.全局变量 程序句柄, 整数型, , , 
.全局变量 提示框句柄, 整数型, , , 
.全局变量 提示框信息数组, 提示框信息, , "0", 
.全局变量 窗口类型, 整数型, , , 气泡相关

.DLL命令 外部_初始化控件, 逻辑型, "comctl32.dll", "InitCommonControlsEx", , 
    .参数 初始化控件结构, 初始化控件结构, , 

.DLL命令 外部_创建窗口, 整数型, "", "CreateWindowExA", , 
    .参数 扩展窗口样式, 整数型, , 
    .参数 窗口类名, 文本型, , 
    .参数 窗口名, 整数型, , 
    .参数 窗口样式, 整数型, , 
    .参数 左边, 整数型, , 
    .参数 定边, 整数型, , 
    .参数 宽度, 整数型, , 
    .参数 长度, 整数型, , 
    .参数 父窗口句柄, 整数型, , 
    .参数 菜单句柄, 整数型, , 
    .参数 程序句柄, 整数型, , 
    .参数 额外数据, 整数型, , 

.DLL命令 外部_获得程序句柄, 整数型, "", "GetModuleHandleA", , 
    .参数 模块名, 整数型, , 

.DLL命令 外部_设置窗口位置, 空白型, "", "SetWindowPos", , 
    .参数 窗口句柄, 整数型, , 
    .参数 窗口顺序句柄, 整数型, , 
    .参数 横坐标, 整数型, , 
    .参数 纵坐标, 整数型, , 
    .参数 宽, 整数型, , 
    .参数 高, 整数型, , 
    .参数 排位选项, 整数型, , 

.DLL命令 外部_获得客户区矩形, 逻辑型, "", "GetClientRect", , 
    .参数 窗口句柄, 整数型, , 
    .参数 客户区矩形, 矩形, , 

.DLL命令 SetWindowLong, 整数型, "", "SetWindowLongA", , 
    .参数 hwnd, 整数型, , 
    .参数 nIndex, 整数型, , 
    .参数 dwNewLong, 整数型, , 

.DLL命令 GetWindowLong, 整数型, "", "GetWindowLongA", , 
    .参数 hwnd, 整数型, , 
    .参数 nIndex, 整数型, , 

.DLL命令 外部_发送消息, 空白型, "", "SendMessageA", , 
    .参数 发送对象句柄, 整数型, , 
    .参数 消息, 整数型, , 
    .参数 辅助参数一, 整数型, , 
    .参数 辅助参数二, 提示框信息, , 

.DLL命令 外部_发送消息_颜色, 空白型, "", "SendMessageA", , 
    .参数 发送对象句柄, 整数型, , 
    .参数 消息, 整数型, , 
    .参数 辅助参数一, 整数型, , 
    .参数 辅助参数二, 整数型, , 

.DLL命令 外部_发送消息_TTM_UPDATETIPTEXT, 空白型, "", "SendMessageA", , 
    .参数 发送对象句柄, 整数型, , 
    .参数 消息, 整数型, , 
    .参数 辅助参数一, 整数型, , 
    .参数 辅助参数二, 提示框信息, 传址, 

.DLL命令 GetSysColor, 整数型, "", "GetSysColor", , 
    .参数 nIndex, 整数型, , 

.程序集 主程序, , , 

.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码
赋值 (程序句柄, 外部_获得程序句柄 (0))
_临时子程序 () ' 在模块初始化代码执行完毕后调用模块测试代码
返回 (0)

.子程序 _临时子程序, 空白型, , 
 ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的参数及返回值类型。


.程序集 _接口程序集, , , 在本程序集中定义的子程序可被模块外部程序访问，注意如果不存在本程序集就不能作为易模块编译。

.程序集变量 已经调用, 逻辑型, , , 
.子程序 模块_添加提示, 整数型, , 返回批号
.参数 控件句柄, 整数型, , 
.参数 提示文本, 文本型, , 如果要显示多行，请加上#换行符
.参数 是否为气泡型, 逻辑型, 可空, comctl32.dll版本必须≥v5.8，第一次调用此模块必须，以第一次调用为准，以后再调用无效，所以以后可以为空，因为所有提示都相同，不能分开定义；如果不调用，默认为不是气泡型

.局部变量 批号, 整数型, , , 

.如果真 (等于 (是否为空 (是否为气泡型), 假))
    .如果真 (取反 (已经调用))
        赋值 (窗口类型, 选择 (等于 (是否为气泡型, 真), #TTS_BALLOON, 0))
        模块_创建提示框 ()
        赋值 (已经调用, 真)
    .如果真结束
    
.如果真结束
赋值 (批号, 模块_简便建立提示框信息 (控件句柄, 提示文本))
模块_添加支持的控件 (批号)
模块_多行显示 (批号)
返回 (批号)

.子程序 模块_移除提示, 空白型, , 
.参数 批号, 整数型, , 

模块_移除支持的控件 (批号)

.子程序 模块_修改提示, 空白型, , 最后3项修改后所有提示都相同，不能分开定义，所以批号可以不填，保持空
.参数 批号, 整数型, 可空, 
.参数 新的文本, 文本型, 可空, 修改此项，必须要填批号，如果此项不修改，请保持空
.参数 提示背景颜色, 整数型, 可空, -1表示恢复默认色，如果此项不修改，请保持空，修改此项，批号可以为空
.参数 提示文本颜色, 整数型, 可空, 同上

.局部变量 是否为气泡型, 逻辑型, 静态, , comctl32.dll版本必须≥v5.8，修改此项，批号可以为空，如果此项不修改，请保持空

 ' 是否为气泡型 此容器银戒指没有放到参数中，是因为在winme中调试的时候改变后提示工具的边框总是不能对齐，等到修正后银戒指会放到参数中，这样就能动态改变，不过不改变也没什么关系，因为第一次创建时就可以选择
.如果真 (等于 (是否为空 (新的文本), 假))
    模块_修改提示框信息 (批号, 新的文本)
    模块_更新提示文本 (批号)
.如果真结束
.如果真 (等于 (是否为空 (提示背景颜色), 假))
    .如果真 (等于 (提示背景颜色, -1))
        赋值 (提示背景颜色, GetSysColor (#COLOR_INFOBK))
    .如果真结束
    外部_发送消息_颜色 (提示框句柄, #TTM_SETTIPBKCOLOR, 提示背景颜色, 0)
.如果真结束
.如果真 (等于 (是否为空 (提示文本颜色), 假))
    .如果真 (等于 (提示文本颜色, -1))
        赋值 (提示文本颜色, GetSysColor (#COLOR_INFOTEXT))
    .如果真结束
    外部_发送消息_颜色 (提示框句柄, #TTM_SETTIPTEXTCOLOR, 提示文本颜色, 0)
.如果真结束
如果真 (是否为空 (是否为气泡型) ＝ 假)
窗口类型 ＝ GetWindowLong (提示框句柄, #GWL_STYLE)
窗口类型 ＝ 选择 (是否为气泡型 ＝ 真, 位或 (窗口类型, #TTS_BALLOON), 位异或 (窗口类型, #TTS_BALLOON))
SetWindowLong (提示框句柄, #GWL_STYLE, 窗口类型)

.程序集 主体程序集, , , 

.子程序 模块_完整修改提示框信息, 空白型, , 
.参数 批号, 整数型, , 
.参数 控件句柄, 整数型, , 
.参数 提示文本, 文本型, , 
.参数 提示框标识, 整数型, , 随意的数字
.参数 显示标志, 整数型, , 
.参数 区域左边, 整数型, , 一个Win32标准的矩形结构
.参数 区域顶边, 整数型, , 
.参数 区域右边, 整数型, , 
.参数 区域底边, 整数型, , 

赋值 (提示框信息数组 [批号], 结构大小, 44)
赋值 (提示框信息数组 [批号], 显示标志, 显示标志)
赋值 (提示框信息数组 [批号], 窗口句柄, 控件句柄)
赋值 (提示框信息数组 [批号], 程序句柄, 程序句柄)
赋值 (提示框信息数组 [批号], 控件标识, 提示框标识)
赋值 (提示框信息数组 [批号], 文本, 提示文本)
赋值 (提示框信息数组 [批号], 客户区矩形.左边, 区域左边)
赋值 (提示框信息数组 [批号], 客户区矩形.顶边, 区域顶边)
赋值 (提示框信息数组 [批号], 客户区矩形.右边, 区域右边)
赋值 (提示框信息数组 [批号], 客户区矩形.底边, 区域底边)

.子程序 模块_创建提示框, 整数型, , 
.局部变量 初始化控件结构, 初始化控件结构, , , 

赋值 (初始化控件结构.结构大小, 8)
赋值 (初始化控件结构.控件标志, #ICC_BAR_CLASSES)
外部_初始化控件 (初始化控件结构)
赋值 (提示框句柄, 外部_创建窗口 (#WS_EX_TOPMOST, “tooltips_class32”, 0, 位或 (窗口类型, #TTS_NOPREFIX, #TTS_ALWAYSTIP), #CW_USEDEFAULT, #CW_USEDEFAULT, #CW_USEDEFAULT, #CW_USEDEFAULT, 0, 0, 程序句柄, 0))
外部_设置窗口位置 (提示框句柄, #HWND_TOPMOST, 0, 0, 0, 0, 位或 (#SWP_NOMOVE, #SWP_NOSIZE, #SWP_NOACTIVATE))
返回 (提示框句柄)

.子程序 模块_简便建立提示框信息, 整数型, , 返回批号
.参数 控件句柄, 整数型, , 
.参数 提示文本, 文本型, , 

.局部变量 提示框信息, 提示框信息, , , 
.局部变量 程序句柄, 整数型, , , 
.局部变量 客户区矩形, 矩形, , , 

赋值 (程序句柄, 外部_获得程序句柄 (0))
外部_获得客户区矩形 (控件句柄, 客户区矩形)
赋值 (提示框信息.结构大小, 44)
赋值 (提示框信息.显示标志, #TTF_SUBCLASS)
赋值 (提示框信息.窗口句柄, 控件句柄)
赋值 (提示框信息.程序句柄, 程序句柄)
赋值 (提示框信息.控件标识, 控件句柄)
赋值 (提示框信息.文本, 提示文本)
赋值 (提示框信息.客户区矩形, 客户区矩形)
加入成员 (提示框信息数组, 提示框信息)
返回 (取数组成员数 (提示框信息数组))

.子程序 模块_完整建立提示框信息, 整数型, , 返回批号
.参数 控件句柄, 整数型, , 
.参数 提示文本, 文本型, , 
.参数 提示框标识, 整数型, , 随意的数字
.参数 显示标志, 整数型, , 
.参数 区域左边, 整数型, , 一个Win32标准的矩形结构
.参数 区域顶边, 整数型, , 
.参数 区域右边, 整数型, , 
.参数 区域底边, 整数型, , 

.局部变量 提示框信息, 提示框信息, , , 

赋值 (提示框信息.结构大小, 44)
赋值 (提示框信息.显示标志, 显示标志)
赋值 (提示框信息.窗口句柄, 控件句柄)
赋值 (提示框信息.程序句柄, 程序句柄)
赋值 (提示框信息.控件标识, 提示框标识)
赋值 (提示框信息.文本, 提示文本)
赋值 (提示框信息.客户区矩形.左边, 区域左边)
赋值 (提示框信息.客户区矩形.顶边, 区域顶边)
赋值 (提示框信息.客户区矩形.右边, 区域右边)
赋值 (提示框信息.客户区矩形.底边, 区域底边)
加入成员 (提示框信息数组, 提示框信息)
返回 (取数组成员数 (提示框信息数组))

.子程序 模块_修改提示框信息, 空白型, , 
.参数 批号, 整数型, , 
.参数 提示文本, 文本型, , 

赋值 (提示框信息数组 [批号], 文本, 提示文本)

.子程序 模块_添加支持的控件, 空白型, , 
.参数 批号, 整数型, , 

外部_发送消息 (提示框句柄, #TTM_ADDTOOL, 0, 提示框信息数组 [批号])

.子程序 模块_移除支持的控件, 空白型, , 
.参数 批号, 整数型, , 

外部_发送消息 (提示框句柄, #TTM_DELTOOL, 0, 提示框信息数组 [批号])

.子程序 模块_更新提示文本, 空白型, , 
.参数 批号, 整数型, , 

外部_发送消息_TTM_UPDATETIPTEXT (提示框句柄, #TTM_UPDATETIPTEXT, 0, 提示框信息数组 [批号])

.子程序 模块_多行显示, 空白型, , 
.参数 批号, 整数型, , 

外部_发送消息 (提示框句柄, #TTM_SETMAXTIPWIDTH, 0, 提示框信息数组 [批号])


 ' 不属于任何一个程序集、类模块的函数：
