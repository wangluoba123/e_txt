 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 508
    高度 = 400
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\胡子多页面记事本.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “胡子高级记事本v1.5”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 422
    高度 = 303
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 4
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' iext3 {B6F7542F-B8FE-46a8-9605-98856A687097} 3 0 扩展界面支持库三
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 2 0 扩展界面支持库二
 ' ExtMenu 9909FBB013704cfa8FE7E739DB7172DE 2 0 超级菜单支持库
 ' shell 52F260023059454187AF826A3C07AF2A 3 0 操作系统界面功能支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 3 0 应用接口支持库
 ' script EDF19861DC454d15BA0B9E3FF9CA4F57 2 0 脚本语言支持组件
 ' edroptarget {9DA96BF9CEBD45c5BFCF94CBE61671F5} 2 0 拖放支持库




.全局变量 匿名全局变量_651, 空白型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 文章数, 整数型, , , 
.程序集变量 文章标题, 文本型, , , 
.程序集变量 文本数组, 文本型, , "0", 
.程序集变量 文件名数组, 文本型, , "0", 
.程序集变量 文件名, 文本型, , , 
.程序集变量 隐藏子夹数, 整数型, , , 
.程序集变量 命令行数组, 文本型, , "0", 
.程序集变量 启动, 空白型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 原文件名, 文本型, , , 
.局部变量 子夹名, 文本型, , , 
.局部变量 a, 整数型, , , 
.局部变量 x, 整数型, , , 
.局部变量 m, 整数型, , , 
.局部变量 n, 整数型, , , 

 ' _启动窗口.自动折行.选中 ＝ 真
赋值 (_启动窗口..选中, 假)
赋值 (., 0)
 ' 调试输出 (取用户区高度 ())
赋值 (_启动窗口., 相减 (相加 (_启动窗口., 348), 取用户区高度 ()))
状态信息 ()
加入成员 (文本数组, “”)
加入成员 (文件名数组, “”)
_启动窗口.取窗口句柄 ().未知支持库函数_0 ()

取命令行 (命令行数组)
.如果真 (大于 (取数组成员数 (命令行数组), 0))
    赋值 (a, 取数组成员数 (命令行数组))
    赋值 (原文件名, “”)
    .计次循环首 (a, x)
        .如果 (不等于 (x, a))
            赋值 (原文件名, 相加 (原文件名, 命令行数组 [x], “ ”)) ' 连接带空格的路径
        .否则
            赋值 (原文件名, 相加 (原文件名, 命令行数组 [x]))
        .如果结束
        
    .计次循环尾 ()
     ' 程序初次运行，不加入新子夹
    赋值 (., 到文本 (读入文件 (原文件名)))
    赋值 (m, 倒找文本 (原文件名, “\”, , 假))
    赋值 (n, 取文本长度 (原文件名))
    赋值 (子夹名, 取文本右边 (原文件名, 相减 (n, m)))
    赋值 (子夹名, 取文本左边 (子夹名, 相减 (取文本长度 (子夹名), 4)))
    .如果真 (大于 (取文本长度 (子夹名), 10))
        赋值 (子夹名, 取文本左边 (子夹名, 10))
    .如果真结束
    赋值 (文件名数组 [1], 原文件名)
    赋值 (文本数组 [1], .)
    1.置文本 (相加 (“文件： ”, 原文件名))
    .未知支持库函数_41 (., 子夹名)
    清除数组 (命令行数组)
.如果真结束


.子程序 状态信息, 空白型, , 
赋值 (文章数, 相减 (未知支持库函数_39 (), 隐藏子夹数))
赋值 (文章标题, .未知支持库函数_40 (.))
0.置文本 (相加 (“文章：”, 到文本 (相加 (., 1)), “/”, 到文本 (文章数)))
1.置文本 (相加 (“文件：”, 文件名))


.子程序 __启动窗口_尺寸被改变, 空白型, , 
 ' 高级选择夹1.移动 (2, 24, 取用户区宽度 () － 4, 取用户区高度 () － 44)
 ' 超级编辑框1.移动 (6, 50, 高级选择夹1.页面区宽度 － 5, 高级选择夹1.页面区高度 － 5)
2.移动 (24, 相减 (取用户区宽度 (), 4), 相减 (取用户区高度 (), 44))
5.移动 (49, 相减 (., 4), 相减 (., 4))
10.移动 (58, 相减 (., 8), 相减 (., 20))
获取焦点 ()
刷新显示 ()

.子程序 _高级选择夹1_将改变子夹, 逻辑型, , 
.参数 子夹索引, 整数型, , 

.局部变量 m, 整数型, , , 
.局部变量 首行, 文本型, , , 

赋值 (文本数组 [相加 (., 1)], .)
.如果真 (并且 (等于 (文件名数组 [相加 (., 1)], “”), 不等于 (., “”)))
    赋值 (m, .未知支持库函数_16 (#换行符))
    .如果 (等于 (未知支持库函数_1 (), 1))
        赋值 (首行, 取文本左边 (., 相减 (未知支持库函数_0 (), m, 1)))
    .否则
        赋值 (首行, 取文本左边 (., 相减 (未知支持库函数_0 (), m, 3)))
    .如果结束
    .如果真 (大于 (取文本长度 (首行), 10))
        赋值 (首行, 取文本左边 (首行, 10))
    .如果真结束
    .未知支持库函数_41 (., 首行)
.如果真结束


.子程序 _高级选择夹1_子夹被改变, 空白型, , 
赋值 (., “”)
赋值 (., 文本数组 [相加 (., 1)])
赋值 (文件名, 文件名数组 [相加 (., 1)])
状态信息 ()


.子程序 _工具条1_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.判断开始 (等于 (按钮索引, 0))
    _新建_被选择 ()
.判断 (等于 (按钮索引, 1))
    _打开_被选择 ()
.判断 (等于 (按钮索引, 2))
    
.判断 (等于 (按钮索引, 3))
    _保存_被选择 ()
.判断 (等于 (按钮索引, 4))
    _全部保存_被选择 ()
.判断 (等于 (按钮索引, 5))
    
.判断 (等于 (按钮索引, 6))
    _剪切_被选择 ()
.判断 (等于 (按钮索引, 7))
    _复制_被选择 ()
.判断 (等于 (按钮索引, 8))
    _粘贴_被选择 ()
.判断 (等于 (按钮索引, 9))
    
.判断 (等于 (按钮索引, 10))
    _行末插入硬回车_被选择 ()
.判断 (等于 (按钮索引, 11))
    
.判断 (等于 (按钮索引, 12))
    _撤销_被选择 ()
.判断 (等于 (按钮索引, 13))
    _删除_被选择 ()
.判断 (等于 (按钮索引, 14))
    _全选并复制到剪贴板_被选择 ()
.判断 (等于 (按钮索引, 15))
    
.判断 (等于 (按钮索引, 16))
    赋值 (., #换行符)
.判断 (等于 (按钮索引, 17))
    赋值 (., 相加 (#换行符, “━━━━━━━━━━━━━━━━━━━━━━━━━━”, #换行符))
.判断 (等于 (按钮索引, 18))
    
.判断 (等于 (按钮索引, 19)) ' 在word中打开
    写到文件 (“c:\temp1.txt”, 到字节集 (.))
    未知支持库函数_6 (4, “winword.exe”, “c:\temp1.txt”, )
    
.判断 (等于 (按钮索引, 20))
    _计算表达式_被选择 ()
    
.判断 (等于 (按钮索引, 21))
    _总在最前面_被选择 ()
.判断 (等于 (按钮索引, 22))
    
.判断 (等于 (按钮索引, 23))
    赋值 (., 0)
    
.判断 (等于 (按钮索引, 24))
    赋值 (., 相减 (未知支持库函数_39 (), 1))
.默认
    
.判断结束


.子程序 _新建_被选择, 空白型, , 
.局部变量 索引, 整数型, , , 

加入成员 (文本数组, “”)
加入成员 (文件名数组, “”)
赋值 (文件名, “”)
赋值 (索引, 相加 (未知支持库函数_39 (), 1))
相加 (“新文件”, 到文本 (索引)).未知支持库函数_31 ()
赋值 (., 相减 (未知支持库函数_39 (), 1))
1.调整层次 ()
赋值 (., “”)
状态信息 ()


.子程序 _打开_被选择, 空白型, , 
.局部变量 m, 整数型, , , 
.局部变量 n, 整数型, , , 
.局部变量 子夹名, 文本型, , , 
.局部变量 打开数组, 文本型, , "0", 
.局部变量 i, 整数型, , , 
.局部变量 索引, 整数型, , , 
.局部变量 当前页, 整数型, , , 

赋值 (当前页, .)
赋值 (打开数组, 多文件对话框 (“打开文件(可多选)”, “文本文件(*.txt)|*.txt”, , , ))
.如果真 (并且 (等于 (., “”), 等于 (取数组成员数 (打开数组), 1)))
    赋值 (., 到文本 (读入文件 (打开数组 [1])))
    赋值 (m, 倒找文本 (打开数组 [1], “\”, , 假))
    赋值 (n, 取文本长度 (打开数组 [1]))
    赋值 (子夹名, 取文本右边 (打开数组 [1], 相减 (n, m)))
    赋值 (子夹名, 取文本左边 (子夹名, 相减 (取文本长度 (子夹名), 4)))
    .如果真 (大于 (取文本长度 (子夹名), 10))
        赋值 (子夹名, 取文本左边 (子夹名, 10))
    .如果真结束
    .未知支持库函数_41 (., 子夹名)
    赋值 (文件名数组 [相加 (., 1)], 打开数组 [1])
    1.置文本 (相加 (“文件：”, 打开数组 [1]))
    返回 ()
.如果真结束

.计次循环首 (取数组成员数 (打开数组), i)
    加入成员 (文本数组, “”)
    加入成员 (文件名数组, “”)
    赋值 (文件名, “”)
    赋值 (索引, 相加 (未知支持库函数_39 (), i))
    打开数组.未知支持库函数_31 ( [i], , , , )
    赋值 (., 相减 (未知支持库函数_39 (), 1))
    1.调整层次 ()
    赋值 (., “”)
    赋值 (., 到文本 (读入文件 (打开数组 [i])))
    赋值 (m, 倒找文本 (打开数组 [i], “\”, , 假))
    赋值 (n, 取文本长度 (打开数组 [i]))
    赋值 (子夹名, 取文本右边 (打开数组 [i], 相减 (n, m)))
    赋值 (子夹名, 取文本左边 (子夹名, 相减 (取文本长度 (子夹名), 4)))
    .如果真 (大于 (取文本长度 (子夹名), 10))
        赋值 (子夹名, 取文本左边 (子夹名, 10))
    .如果真结束
    .未知支持库函数_41 (., 子夹名)
    赋值 (文件名数组 [相加 (., 1)], 打开数组 [i])
    1.置文本 (相加 (“文件：”, 打开数组 [i]))
.计次循环尾 ()
赋值 (., 相加 (当前页, 1))


.子程序 _全选_被选择, 空白型, , 
赋值 (., -1)
 ' 超级编辑框1.发送信息 (177, 0, -1)


.子程序 _剪切_被选择, 空白型, , 
 ' 超级编辑框1.发送信息 (768, 0, 0)
.如果 (大于 (., 0))
    未知支持库函数_18 ()
.否则
    未知支持库函数_1 (#Del键, , )
.如果结束


.子程序 _复制_被选择, 空白型, , 
769.发送信息 (0, 0)

.子程序 _粘贴_被选择, 空白型, , 
770.发送信息 (0, 0)

.子程序 _删除_被选择, 空白型, , 
.如果 (大于 (., 0))
    未知支持库函数_1 (#退格键, , )
.否则
    未知支持库函数_1 (#Del键, , )
.如果结束


.子程序 _撤销_被选择, 空白型, , 
 ' 模拟按键 (#Ctrl键, #Z键, )
 ' 超级编辑框1.发送信息 (199, 0, 0)
未知支持库函数_13 ()


.子程序 _寻找替换_被选择, 空白型, , 
.局部变量 输入文本, 文本型, , , 
.局部变量 原字串, 文本型, , , 
.局部变量 新字串, 文本型, , , 
.局部变量 空格位置, 整数型, , , 

输入框 (相加 (“请输入要查找的内容和替换的内容，并用半角空格隔开。”, #换行符, “    如：电脑 计算机”, #换行符, “    (如果有选中的文字，则只在选中部分中查找替换。)”), “查找替换”, , 输入文本, )
赋值 (空格位置, 寻找文本 (输入文本, 取空白文本 (1), , 假))
赋值 (原字串, 取文本左边 (输入文本, 相减 (空格位置, 1)))
赋值 (新字串, 取文本右边 (输入文本, 相减 (取文本长度 (输入文本), 空格位置)))
输出调试文本 (原字串)
输出调试文本 (新字串)
.如果 (等于 (., “”))
    赋值 (., 子文本替换 (., 原字串, 新字串, , , 真))
.否则
    赋值 (., 子文本替换 (., 原字串, 新字串, , , 真))
.如果结束


.子程序 _全选并复制到剪贴板_被选择, 空白型, , 
赋值 (., -1)
置剪辑板文本 (.)


.子程序 _删除全部空行_被选择, 空白型, , 
.局部变量 行数, 整数型, , , 
.局部变量 行长, 整数型, , , 
.局部变量 行文本, 文本型, , "0", 
.局部变量 行, 整数型, , , 

赋值 (行文本, 分割文本 (., #换行符, ))
赋值 (行数, 取数组成员数 (行文本))
赋值 (., “”)
.计次循环首 (行数, 行)
    .如果真 (大于 (取文本长度 (行文本 [行]), 1))
        赋值 (., 相加 (., 行文本 [行], #换行符))
    .如果真结束
    
.计次循环尾 ()
 ' 子文本替换 (超级编辑框1.内容, #换行符 ＋ #换行符, #换行符, , , 真)


.子程序 _删除所有行首空格_被选择, 空白型, , 
.局部变量 行文本, 文本型, , "0", 
.局部变量 行数, 整数型, , , 
.局部变量 行, 整数型, , , 

赋值 (行文本, 分割文本 (., #换行符, ))
赋值 (行数, 取数组成员数 (行文本))
赋值 (., “”)
.计次循环首 (行数, 行)
    .如果真 (大于 (取文本长度 (行文本 [行]), 1))
        赋值 (., 相加 (., 删首尾空 (行文本 [行]), #换行符))
    .如果真结束
    
.计次循环尾 ()


.子程序 _字数行数统计_被选择, 空白型, , 
.局部变量 字符数, 文本型, , , 
.局部变量 行数, 文本型, , , 
.局部变量 找位置, 整数型, , , 
.局部变量 找到的, 整数型, , , 
.局部变量 行, 整数型, , , 

.如果 (等于 (., 0))
    赋值 (字符数, 到文本 (取文本长度 (.)))
    .判断循环首 (不等于 (找到的, -1))
        赋值 (找到的, 寻找文本 (., #换行符, 找位置, 假))
        .如果真 (大于或等于 (找到的, 0))
            赋值 (行, 相加 (行, 1))
        .如果真结束
        赋值 (找位置, 相加 (找到的, 1))
    .判断循环尾 ()
    赋值 (行数, 到文本 (相加 (行, 1)))
    
.否则
    赋值 (字符数, 到文本 (.))
    .判断循环首 (不等于 (找到的, -1))
        赋值 (找到的, 寻找文本 (., #换行符, 找位置, 假))
        .如果真 (大于或等于 (找到的, 0))
            赋值 (行, 相加 (行, 1))
        .如果真结束
        赋值 (找位置, 相加 (找到的, 1))
    .判断循环尾 ()
    赋值 (行数, 到文本 (相加 (行, 1)))
.如果结束

信息框 (相加 (“字数/行数统计结果：”, #换行符, #换行符, “  字数： ”, 字符数, #换行符, “  行数： ”, 行数), 64, “字数/行数统计”)


.子程序 _帮助信息_被选择, 空白型, , 
 ' 信息框 (“【简单说明】” ＋ #换行符 ＋ #换行符 ＋ “1、这是一个用易语言编写的多页面记事本。    ” ＋ #换行符 ＋ “可以同时打开任意多个文本文档。 ” ＋ #换行符 ＋ #换行符 ＋ “2、支持拖放打开方式，可以选中多个文本文” ＋ #换行符 ＋ “档，拖到窗口上编辑框以外的任意位置就可以” ＋ #换行符 ＋ “同时打开。  ” ＋ #换行符 ＋ #换行符 ＋ “3、双击文档标题可以关闭(隐藏)当前文档。  ” ＋ #换行符 ＋ #换行符 ＋ “4、其他功能都在菜单上了。绿色免费软件，   ” ＋ #换行符 ＋ “没有任何功能限制。但不得用于商业用途。”, 48, “帮助信息”)
 ' 载入 (窗口1, _启动窗口, 真)


.子程序 _首行缩进_被选择, 空白型, , 
.局部变量 处理后文本, 文本型, , , 

赋值 (处理后文本, 子文本替换 (., #换行符, 相加 (#换行符, “    ”), , , 真))
赋值 (., “”)
赋值 (., 处理后文本)


.子程序 _删除同类字符_被选择, 空白型, , 
.局部变量 选中文字, 文本型, , , 
.局部变量 删同类后, 文本型, , , 

赋值 (选中文字, .)
赋值 (删同类后, 子文本替换 (., 选中文字, “”, 1, , 真))
赋值 (., “”)
赋值 (., 删同类后)


.子程序 _段后插入空行_被选择, 空白型, , 
.局部变量 插入空行后, 文本型, , , 

赋值 (插入空行后, 子文本替换 (., #换行符, 相加 (#换行符, #换行符), 1, , 真))
赋值 (., “”)
赋值 (., 插入空行后)


.子程序 _删除选中段落中的换行符_被选择, 空白型, , 
赋值 (., 子文本替换 (., #换行符, “”, , , 真))

.子程序 _行末插入硬回车_被选择, 空白型, , 
.局部变量 行, 整数型, , , 
.局部变量 行文本数组, 文本型, , "0", 
.局部变量 n, 整数型, , , 

1.置文本 (“可以通过改变窗口的宽度增加或减少文本行的字数。”)
.计次循环首 (未知支持库函数_1 (), 行)
    加入成员 (行文本数组, 相加 (删尾空 (相减 (行, 1).未知支持库函数_2 ()), 字符 (10)))
.计次循环尾 ()
赋值 (., “”)
.计次循环首 (取数组成员数 (行文本数组), n)
    赋值 (., 相加 (., 删尾空 (行文本数组 [n])))
.计次循环尾 ()
赋值 (_启动窗口., 相加 (_启动窗口., 30))


.子程序 _全角转半角_被选择, 空白型, , 
.如果 (等于 (., 0))
    赋值 (., 到半角 (.))
.否则
    赋值 (., 到半角 (.))
.如果结束


.子程序 _半角转全角_被选择, 空白型, , 
.如果 (等于 (., 0))
    赋值 (., 到全角 (.))
.否则
    赋值 (., 到全角 (.))
.如果结束


.子程序 _大写转小写_被选择, 空白型, , 
.如果 (等于 (., 0))
    赋值 (., 到小写 (.))
.否则
    赋值 (., 到小写 (.))
.如果结束


.子程序 _小写转大写_被选择, 空白型, , 
.如果 (等于 (., 0))
    赋值 (., 到大写 (.))
.否则
    赋值 (., 到大写 (.))
.如果结束


.子程序 _高级选择夹1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (不等于 (., 0))
    .未知支持库函数_69 (., 真)
    赋值 (隐藏子夹数, 相加 (隐藏子夹数, 1))
    状态信息 ()
.如果真结束


.子程序 _计算表达式_被选择, 空白型, , 
.局部变量 结果, 文本型, , , 
.局部变量 表达式, 文本型, , , 
.局部变量 行数, 整数型, , , 
.局部变量 行数组, 文本型, , "0", 
.局部变量 i, 整数型, , , 
.局部变量 s, 整数型, , , 
.局部变量 m, 整数型, , , 

1.置文本 (“请先选定或在空文档中输入表达式，如 (23-16)*2，然后计算”)
.如果真 (等于 (取操作系统类别 (), 2))
    信息框 (“对不起，计算表达式功能只能用于win2000以上操作系统  ”, 相加 (0, #信息图标), )
    返回 ()
.如果真结束

赋值 (行数组, 分割文本 (., #换行符, ))
赋值 (行数, 取数组成员数 (行数组))
.如果真 (并且 (等于 (文件名数组 [相加 (., 1)], “”), 大于或等于 (行数, 2)))
    .计次循环首 (行数, i)
        .如果真 (不等于 (到数值 (行数组 [i]), 0))
            赋值 (s, 相加 (s, 到数值 (行数组 [i])))
            赋值 (m, 相加 (m, 1))
        .如果真结束
        
    .计次循环尾 ()
    获取焦点 ()
    未知支持库函数_1 (#Ctrl键, #End键, )
    赋值 (., #换行符)
    赋值 (., 相加 (“有效数据 ”, 到文本 (m), “ 个”, #换行符))
    赋值 (., 相加 (“◆求和：”, #换行符))
    赋值 (., 相加 (“ ＝ ”, 到文本 (s), #换行符, #换行符))
    赋值 (., 相加 (“◆平均值：”, #换行符))
    赋值 (., 相加 (“ ＝ ”, 到文本 (相除 (s, m)), #换行符))
    返回 ()
.如果真结束

.如果 (不等于 (., “”))
    .如果 (等于 (取文本右边 (., 1), “=”))
        赋值 (表达式, 取文本左边 (., 相减 (取文本长度 (.), 1)))
    .否则
        赋值 (表达式, .)
    .如果结束
    赋值 (结果, 表达式.未知支持库函数_1 ())
    赋值 (., 相加 (表达式, “ = ”, 到文本 (结果)))
    
.否则
    .如果 (等于 (取文本右边 (., 1), “=”))
        赋值 (表达式, 取文本左边 (., 相减 (取文本长度 (.), 1)))
    .否则
        赋值 (表达式, .)
    .如果结束
    赋值 (结果, 表达式.未知支持库函数_1 ())
    赋值 (., 相加 (表达式, “ = ”, 到文本 (结果)))
.如果结束

置剪辑板文本 (到文本 (结果))
1.置文本 (相加 (“计算结果：”, 到文本 (结果)))
.如果真 (等于 (结果, “”))
    信息框 (相加 (“1、请先输入表达式并选中，然后计算。如：”, #换行符, #换行符, 取空白文本 (20), “(1234+5678)*90/100=”, #换行符, #换行符, “2、如果文档中只有一个表达式，无须选中即可计算。   ”, #换行符, “等号可以省略。计算结果被自动保存在剪贴板上。”, #换行符, #换行符, “3、在一个新建文档中，每行一个数字加回车，无须”, #换行符, “任何运算符号，可以得到求和值及平均值。”), #信息图标, “提示信息”)
.如果真结束


.子程序 _字体_被选择, 空白型, , 
.局部变量 字符格式, 未知类型0x40004, , , 

赋值 (.类型, 2)
打开 ()
赋值 (字符格式., .字体名称)
赋值 (字符格式., .字体大小)
赋值 (字符格式., .字体颜色)
字符格式.未知支持库函数_8 ()

.子程序 _缺省字体_被选择, 空白型, , 
.局部变量 字符格式, 未知类型0x40004, , , 

赋值 (字符格式., “宋体”)
赋值 (字符格式., 9)
赋值 (字符格式., #黑色)
字符格式.未知支持库函数_8 ()


.子程序 _自动折行_被选择, 空白型, , 
赋值 (., 取反 (.))
 ' _启动窗口.自动折行.选中 ＝ 取反 (_启动窗口.自动折行.选中)

.子程序 _总在最前面_被选择, 空白型, , 
赋值 (_启动窗口., 取反 (_启动窗口.))
赋值 (_启动窗口..选中, 取反 (_启动窗口..选中))


.子程序 _关于_被选择, 空白型, , 
信息框 (相加 (“胡子高级记事本v1.5”, #换行符, #换行符, “设计：胡杰”, #换行符, “联系：石嘴山市二中”, #换行符, “信箱：nxhujiee@tom.com”, #换行符, “网址：http://nxhujiee.zj.com        ”), 64, “关于……”)

.子程序 _超级编辑框1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()


.子程序 _另存为_被选择, 空白型, , 
.局部变量 原文件名, 文本型, , , 
.局部变量 首行, 文本型, , , 
.局部变量 m, 整数型, , , 
.局部变量 子夹名, 文本型, , , 
.局部变量 非法字符, 文本型, , , 
.局部变量 i, 整数型, , , 
.局部变量 分隔符位置, 整数型, , , 
.局部变量 x, 整数型, 静态, , 
.局部变量 取文件名数组, 文本型, , "0", 
.局部变量 p, 整数型, , , 

 ' .如果真 (等于 (., “”))
     ' 返回 ()
.如果真结束

赋值 (.类型, 1)
赋值 (.过滤器, “文本文件(*.txt)|*.txt|所有文件(*.*)|*.*”)
赋值 (.默认文件后缀, “txt”)
赋值 (原文件名, 文件名数组 [相加 (., 1)])
.如果 (等于 (原文件名, “”))
    赋值 (取文件名数组, 分割文本 (., #换行符, ))
    
    .计次循环首 (取数组成员数 (取文件名数组), p)
        .如果真 (大于或等于 (取文本长度 (取文件名数组 [p]), 1))
            赋值 (首行, 取文件名数组 [p])
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
    
    .如果真 (不等于 (., “”))
        赋值 (首行, .)
    .如果真结束
    
    .计次循环首 (13, i)
        赋值 (非法字符, 多项选择 (i, #引号, “:”, “+”, “|”, “(”, “)”, “<”, “>”, “\”, “/”, “?”, “*”, “;”))
        赋值 (首行, 子文本替换 (首行, 非法字符, 到全角 (非法字符), 1, , 真))
    .计次循环尾 ()
    
    赋值 (.文件名, 首行)
    .如果 (等于 (打开 (), 真))
        写到文件 (.文件名, 到字节集 (.))
    .否则
        
    .如果结束
    
    .如果 (大于 (取文本长度 (首行), 10))
        赋值 (子夹名, 取文本左边 (首行, 10))
    .否则
        赋值 (子夹名, 首行)
    .如果结束
    
    .如果真 (等于 (取文本长度 (首行), 0))
        赋值 (分隔符位置, 倒找文本 (.文件名, “\”, , 假))
        赋值 (子夹名, 取文本中间 (.文件名, 相加 (分隔符位置, 1), 相减 (取文本长度 (.文件名), 分隔符位置, 4)))
         ' 信息框 (子夹名, 0, )
    .如果真结束
    
    .未知支持库函数_41 (., 子夹名)
    
    赋值 (文件名数组 [相加 (., 1)], .文件名)
    1.置文本 (相加 (“文件：”, .文件名))
    
.否则
    赋值 (.文件名, 原文件名)
    打开 ()
    写到文件 (.文件名, 到字节集 (.))
    赋值 (文件名数组 [相加 (., 1)], .文件名)
    1.置文本 (相加 (“文件：”, .文件名))
.如果结束


.子程序 _全部保存_被选择, 空白型, , 
.局部变量 i, 整数型, , , 
.局部变量 原文件名, 文本型, , , 
.局部变量 m, 整数型, , , 
.局部变量 首行, 文本型, , , 

.计次循环首 (文章数, i)
    .如果真 (等于 (相减 (i, 1).未知支持库函数_70 (), 假))
        赋值 (., 相减 (i, 1))
        赋值 (.类型, 1)
        赋值 (.默认文件后缀, “txt”)
        赋值 (.过滤器, “文本文件(*.txt)|*.txt|所有文件(*.*)|*.*”)
        赋值 (原文件名, 文件名数组 [i])
        .如果 (不等于 (原文件名, “”))
            赋值 (.文件名, 文件名数组 [i])
             ' 通用对话框1.打开 ()
            写到文件 (.文件名, 到字节集 (.))
            赋值 (文件名数组 [i], .文件名)
            1.置文本 (相加 (“文件：”, .文件名))
            
        .否则
            _保存_被选择 ()
        .如果结束
        
    .如果真结束
    
.计次循环尾 ()
信息框 (“全部保存完毕！”, #信息图标, “全部保存”)


.子程序 _退出_被选择, 空白型, , 
_启动窗口.销毁 ()


.子程序 _拖放对象1_得到文件, 空白型, , 
.参数 接收到的文件路径, 文本型, , 

.局部变量 m, 整数型, , , 
.局部变量 n, 整数型, , , 
.局部变量 子夹名, 文本型, , , 
.局部变量 接收数组, 文本型, , "0", 
.局部变量 i, 整数型, , , 
.局部变量 索引, 整数型, , , 
.局部变量 当前页, 整数型, , , 

赋值 (当前页, .)
赋值 (接收数组, 分割文本 (接收到的文件路径, #换行符, ))
.计次循环首 (取数组成员数 (接收数组), i)
    加入成员 (文本数组, “”)
    加入成员 (文件名数组, “”)
    赋值 (文件名, “”)
    赋值 (索引, 相加 (未知支持库函数_39 (), i))
    接收数组.未知支持库函数_31 ( [i], , , , )
    赋值 (., 相减 (未知支持库函数_39 (), 1))
    1.调整层次 ()
    赋值 (., “”)
    赋值 (., 到文本 (读入文件 (接收数组 [i])))
    
    赋值 (m, 倒找文本 (接收数组 [i], “\”, , 假))
    赋值 (n, 取文本长度 (接收数组 [i]))
    赋值 (子夹名, 取文本右边 (接收数组 [i], 相减 (n, m)))
    赋值 (子夹名, 取文本左边 (子夹名, 相减 (取文本长度 (子夹名), 4)))
    .如果真 (大于 (取文本长度 (子夹名), 10))
        赋值 (子夹名, 取文本左边 (子夹名, 10))
    .如果真结束
    .未知支持库函数_41 (., 子夹名)
    赋值 (文件名数组 [相加 (., 1)], 接收数组 [i])
    1.置文本 (相加 (“文件：”, 接收数组 [i]))
    
.计次循环尾 ()
赋值 (., 相加 (当前页, 1))
 ' 信息框 (接收到的文件路径, 0, )

.子程序 __启动窗口_可否被关闭, 逻辑型, , 
.如果真 (等于 (文件是否存在 (“c:\temp1.txt”), 真))
    删除文件 (“c:\temp1.txt”)
.如果真结束


.子程序 _替换系统记事本_被选择, 空白型, , 
.局部变量 windir, 文本型, , , 
.局部变量 sysdir, 文本型, , , 
.局部变量 exename, 文本型, , , 
.局部变量 exedir, 文本型, , , 

赋值 (windir, 未知支持库函数_7 (9))
赋值 (sysdir, 未知支持库函数_7 (10))
赋值 (exename, 取执行文件名 ())
赋值 (exedir, 相加 (取运行目录 (), “\”))
删除文件 (相加 (sysdir, “notepad.exe”))
复制文件 (相加 (exedir, exename), 相加 (sysdir, “notepad.exe”))
 ' 信息框 (“删除文件:  ” ＋ sysdir ＋ “notepad.exe”, 0, )
 ' 信息框 (“复制文件1:  ” ＋ exedir ＋ exename, 0, )
信息框 (“已将本程序设置为系统默认文本编辑器。”, #信息图标, )


.子程序 _还原系统记事本_被选择, 空白型, , 
.局部变量 windir, 文本型, , , 
.局部变量 sysdir, 文本型, , , 
.局部变量 exename, 文本型, , , 
.局部变量 exedir, 文本型, , , 

赋值 (windir, 未知支持库函数_7 (9))
赋值 (sysdir, 未知支持库函数_7 (10))
赋值 (exename, 取执行文件名 ())
赋值 (exedir, 相加 (取运行目录 (), “\”))
.如果真 (等于 (exedir, sysdir))
    信息框 (相加 (“程序正在运行，无法还原。”, #换行符, #换行符, “请关闭本程序，并运行一个本程序  ”, #换行符, “的复本，然后执行此操作。”), #信息图标, )
    返回 ()
.如果真结束
删除文件 (相加 (sysdir, “notepad.exe”))
复制文件 (相加 (windir, “notepad.exe”), 相加 (sysdir, “notepad.exe”))
信息框 (“已成功还原 Notepad.exe 为系统默认文本编辑器。”, #信息图标, )


.子程序 __启动窗口_将被销毁, 空白型, , 
.如果 (等于 (启动, 0))
     ' 写注册项 (#本地机器, “Software\胡子高级记事本\双字节值(REG_DWORD 类型)”, 0)
 ' .否则
    
.如果结束


.子程序 _保存_被选择, 空白型, , 
.局部变量 原文件名, 文本型, , , 
.局部变量 首行, 文本型, , , 
.局部变量 m, 整数型, , , 
.局部变量 子夹名, 文本型, , , 
.局部变量 非法字符, 文本型, , , 
.局部变量 i, 整数型, , , 
.局部变量 分隔符位置, 整数型, , , 
.局部变量 x, 整数型, 静态, , 
.局部变量 取文件名数组, 文本型, , "0", 
.局部变量 p, 整数型, , , 

赋值 (.类型, 1)
赋值 (.过滤器, “文本文件(*.txt)|*.txt|所有文件(*.*)|*.*”)
赋值 (.默认文件后缀, “txt”)

赋值 (原文件名, 文件名数组 [相加 (., 1)])
.如果 (等于 (原文件名, “”))
    赋值 (取文件名数组, 分割文本 (., #换行符, ))
    
    .计次循环首 (取数组成员数 (取文件名数组), p)
        .如果真 (大于或等于 (取文本长度 (取文件名数组 [p]), 1))
            赋值 (首行, 取文件名数组 [p])
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
    
    .如果真 (不等于 (., “”))
        赋值 (首行, .)
    .如果真结束
    
    .计次循环首 (13, i)
        赋值 (非法字符, 多项选择 (i, #引号, “:”, “+”, “|”, “(”, “)”, “<”, “>”, “\”, “/”, “?”, “*”, “;”))
        赋值 (首行, 子文本替换 (首行, 非法字符, 到全角 (非法字符), 1, , 真))
    .计次循环尾 ()
    
    赋值 (.文件名, 首行)
    .如果真 (等于 (打开 (), 真))
        写到文件 (.文件名, 到字节集 (.))
    .如果真结束
    
    .如果 (大于 (取文本长度 (首行), 10))
        赋值 (子夹名, 取文本左边 (首行, 10))
    .否则
        赋值 (子夹名, 首行)
    .如果结束
    
    .如果真 (等于 (取文本长度 (首行), 0))
        赋值 (分隔符位置, 倒找文本 (.文件名, “\”, , 假))
        赋值 (子夹名, 取文本中间 (.文件名, 相加 (分隔符位置, 1), 相减 (取文本长度 (.文件名), 分隔符位置, 4)))
         ' 信息框 (子夹名, 0, )
    .如果真结束
    
    .未知支持库函数_41 (., 子夹名)
    
    赋值 (文件名数组 [相加 (., 1)], .文件名)
    1.置文本 (相加 (“文件：”, .文件名))
    
.否则
    赋值 (.文件名, 原文件名)
     ' 通用对话框1.打开 ()
    写到文件 (.文件名, 到字节集 (.))
    赋值 (文件名数组 [相加 (., 1)], .文件名)
    1.置文本 (相加 (“文件：”, .文件名))
.如果结束



.窗口程序集 窗口程序集2, , , 

.子程序 _按钮1_被单击, 空白型, , 
窗口1.销毁 ()


 ' 不属于任何一个程序集、类模块的函数：
