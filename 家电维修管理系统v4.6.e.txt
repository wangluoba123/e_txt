 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 663
    高度 = 552
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 2
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 3
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\家电维修管理系统v4.6.e\_启动窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “家电维修管理系统v4.5”
    帮助文件名 = “”

窗口 密码窗口
    左边 = 50
    顶边 = 50
    宽度 = 301
    高度 = 187
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “家电维修管理系统v4.5”
    帮助文件名 = “”

窗口 管理窗口
    左边 = 50
    顶边 = 50
    宽度 = 419
    高度 = 316
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 登记窗口
    左边 = 50
    顶边 = 50
    宽度 = 354
    高度 = 298
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 结保配窗
    左边 = 50
    顶边 = 50
    宽度 = 635
    高度 = 482
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 查询窗口
    左边 = 50
    顶边 = 50
    宽度 = 321
    高度 = 212
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\家电维修管理系统v4.6.e\查询窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 关于窗口
    左边 = 50
    顶边 = 50
    宽度 = 370
    高度 = 279
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 已保存到：D:\易语言学习\Data\家电维修管理系统v4.6.e\关于窗口_底图
    图标 =  ' 已保存到：D:\易语言学习\Data\家电维修管理系统v4.6.e\关于窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “    软件作者:心心阳光(柏光林)”
    帮助文件名 = “”

窗口 注册窗口
    左边 = 50
    顶边 = 50
    宽度 = 318
    高度 = 350
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\家电维修管理系统v4.6.e\注册窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 4 2 系统核心支持库
 ' EChartBar 9A3F84D7FDEB4a0486F2711D5104B7F7 1 2 数据图表支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 1 2 扩展界面支持库一
 ' eGrid 0B4337DA651B4b619ACF61334A7E8B47 1 1 高级表格支持库
 ' dp1 4BB4003860154917BC7D8230BF4FA58A 1 0 数据操作支持库一
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 1 1 扩展界面支持库二
 ' iext5 {E5000198-4471-40e2-92BC-D0BA075BDBB2} 1 0 扩展界面支持库五
 ' shell 52F260023059454187AF826A3C07AF2A 1 0 操作系统界面功能支持库
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 1 1 XP风格界面库




.全局变量 登陆账册姓名, 文本型, , , 
.全局变量 登陆用户姓名, 文本型, , , 
.全局变量 匿名全局变量_179, 空白型, , , 
.全局变量 项目管理识别号, 整数型, , , 注:从0→7识别管理窗口项，10→15识别登记窗口项，
.全局变量 权限管理识别, 逻辑型, , , 为0时为假，为1时为真
.全局变量 匿名全局变量_2120, 空白型, , , 
.全局变量 未注册使用次数, 整数型, , , 

.窗口程序集 启动窗口, , , 

.子程序 __启动窗口_创建完毕, 空白型, , 
未知支持库函数_0 (1)
创建密码校验数据库 () ' 进入第一子程序， 创建密码数据库
载入 (密码窗口, , 真) ' 进入密码校验窗口
窗口调整 () ' 进入第一子程序， 调整窗口尺寸到最大屏幕显示
检查是否注册 ()

.子程序 检查是否注册, 空白型, , 
.如果 (等于 (注册项是否存在 (#本地机器, “SOFTWARE\bkl\家电维修管理系统v4.5 正式注册版”), 假))
    使用次数 ()
.否则
    .如果 (等于 (到文本 (取文本注册项 (#本地机器, “SOFTWARE\bkl\家电维修管理系统v4.5 正式注册版”, )), 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “注册信息”, “家电维修管理系统v4.5”, “家电维修管理系统v4.5”)))
        2.置文本 (相加 (#左引号, “家电维修管理系统 v4.5正式注册版”))
    .否则
        
    .如果结束
    
.如果结束


.子程序 使用次数, 空白型, , '未注册时对使用次数的限制
.如果 (等于 (注册项是否存在 (#本地机器, “SOFTWARE\bkl\家电维修管理系统v4.5 未注册版”), 假))
    写注册项 (#本地机器, “SOFTWARE\bkl\家电维修管理系统v4.5 未注册版”, 30)
    赋值 (未注册使用次数, 取数值注册项 (#本地机器, “SOFTWARE\bkl\家电维修管理系统v4.5 未注册版”, 30))
    2.置文本 (相加 (#左引号, “家电维修管理系统 v4.5 未注册还可使用”, 到文本 (未注册使用次数), “次”))
.否则
    赋值 (未注册使用次数, 相减 (取数值注册项 (#本地机器, “SOFTWARE\bkl\家电维修管理系统v4.5 未注册版”, 30), 1))
    2.置文本 (相加 (#左引号, “家电维修管理系统 v4.5 未注册还可使用”, 到文本 (未注册使用次数), “次”))
    .如果 (等于 (未注册使用次数, 0))
        信息框 (“你的使用次数已满，请注册后才能再使用!”, 0, )
        结束 ()
    .否则
        写注册项 (#本地机器, “SOFTWARE\bkl\家电维修管理系统v4.5 未注册版”, 未注册使用次数)
    .如果结束
    
.如果结束


.子程序 _工具条_被单击, 空白型, , 
.参数 按钮索引, 整数型, , 

.如果真 (等于 (按钮索引.取标题 (), “接货显示”)) ' 显示接货记录、已派工项和缺少元件项
    赋值 (.标题, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “电器维修接货记录”))
    赋值 (项目管理识别号, 1)
    缺件或派工显示 ()
    连续赋值 (假, .可视, .)
    打开表格显示 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\接货库.edb”))
.如果真结束
.如果真 (等于 (按钮索引.取标题 (), “历史档案”)) ' 显示维修历史
    赋值 (.标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “家电维修历史档案”))
    赋值 (项目管理识别号, 1)
    连续赋值 (假, .可视, .)
    打开表格显示 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\历史库.edb”))
.如果真结束
.如果真 (等于 (按钮索引.取标题 (), “库存配件”)) ' 显示库中所有配件
    赋值 (.标题, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “库存元件显示”))
    赋值 (项目管理识别号, 2)
    连续赋值 (假, .可视, .)
    打开表格显示 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\元件库.edb”))
.如果真结束
.如果真 (等于 (按钮索引.取标题 (), “销售显示”)) ' 显示已经销售和维修中所用的配件
    赋值 (.标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “维修、销售配件记录”))
    赋值 (项目管理识别号, 3)
    连续赋值 (假, .可视, .)
    打开表格显示 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\出货库.edb”))
.如果真结束
.如果真 (等于 (按钮索引.取标题 (), “统计报表”)) ' 显示综合收支统计表
    _企业收支统计表_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引.取标题 (), “记账录入”)) ' 显示接货登记窗口
    _接货登记_被选择 ()
.如果真结束
.如果真 (等于 (按钮索引.取标题 (), “资料查询”))
    .如果真 (或者 (等于 (.标题, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “电器维修接货记录”)), 等于 (.标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “家电维修历史档案”)), 等于 (.标题, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “库存元件显示”)), 等于 (.标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “维修、销售配件记录”))))
        载入 (查询窗口, , 真)
    .如果真结束
    
.如果真结束
.如果真 (等于 (按钮索引.取标题 (), “打印设置”))
    打印预览 ()
.如果真结束
.如果真 (等于 (按钮索引.取标题 (), “退出”))
    结束 ()
.如果真结束
赋值 (., 真)

.子程序 _工具条_被下拉, 空白型, , 
.参数 按钮索引, 整数型, , 
.参数 下拉横座标, 整数型, , 
.参数 下拉纵座标, 整数型, , 

.如果真 (等于 (按钮索引.取标题 (), “记账录入”))
    _启动窗口.弹出菜单 (下拉横座标, 下拉纵座标)
.如果真结束
.如果真 (等于 (按钮索引.取标题 (), “统计报表”))
    _启动窗口.弹出菜单 (下拉横座标, 下拉纵座标)
.如果真结束
.如果真 (等于 (按钮索引.取标题 (), “打印设置”))
    _启动窗口.弹出菜单 (下拉横座标, 下拉纵座标)
.如果真结束


.子程序 _基本信息_被选择, 空白型, , 
赋值 (项目管理识别号, 0)
载入 (管理窗口, , 真)

.子程序 _账册档案管理_被选择, 空白型, , 
赋值 (项目管理识别号, 1)
载入 (管理窗口, , 真)

.子程序 _登陆用户管理_被选择, 空白型, , 
赋值 (项目管理识别号, 2)
载入 (管理窗口, , 真)

.子程序 _员工资料管理_被选择, 空白型, , 
赋值 (项目管理识别号, 3)
载入 (管理窗口, , 真)

.子程序 _操作权限设定_被选择, 空白型, , 
赋值 (项目管理识别号, 4)
载入 (管理窗口, , 真)

.子程序 _账册密码修改_被选择, 空白型, , 
赋值 (项目管理识别号, 5)
载入 (管理窗口, , 真)

.子程序 _数据库初始化_被选择, 空白型, , 
赋值 (项目管理识别号, 6)
载入 (管理窗口, , 真)

.子程序 _数据管理_被选择, 空白型, , 
赋值 (项目管理识别号, 7)
载入 (管理窗口, , 真)

.子程序 _退出_被选择, 空白型, , 
结束 ()

.子程序 _员工工作明细表_被选择, 空白型, , 
赋值 (.标题, “营业收入”)
赋值 (.标题, “配件费用”)
赋值 (.标题, “返工费用”)
赋值 (.标题, “毛 利 润”)
连续赋值 (“”, .内容, .内容, .内容, .内容)
读取指标到列表框 (相加 (到文本 (取年份 (取现行时间 ())), “年”, “员工工作明细记录”), “\历史库.edb”)

.子程序 _员工列表框_表项被激活, 空白型, , 
.如果真 (等于 (.标题, “营业收入”)) ' 显示员工工作明细
    赋值 (.标题, 相加 (“员工:”, .取标题 (., 1)))
    赋值 (项目管理识别号, 1)
    赋值 (.标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, .取标题 (., 1), “员工工作明细记录”))
    员工工作状态显示 (.取标题 (., 1), “\历史库.edb”)
.如果真结束
.如果真 (等于 (.标题, “基本工资合计”)) ' 显示员工月工资表
    赋值 (.标题, 相加 (“员工:”, .取标题 (., 1)))
    赋值 (项目管理识别号, 4)
    赋值 (.标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, .取标题 (., 1), “员工月工资总表”))
    员工工作状态显示 (.取标题 (., 1), “\工资库.edb”)
.如果真结束
.如果真 (等于 (.标题, “未归还配件数量”)) ' 显示员工已经领出去的配件
    赋值 (.标题, 相加 (“员工:”, .取标题 (., 1)))
    赋值 (项目管理识别号, 5)
    赋值 (.标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, .取标题 (., 1), “员工领、还配件记录”))
    员工工作状态显示 (.取标题 (., 1), “\领归库.edb”)
.如果真结束
.如果真 (等于 (.标题, “库存配件品种”)) ' 显示库存盘点表
    赋值 (.标题, 相加 (“类型:”, .取标题 (., 1)))
    赋值 (项目管理识别号, 2)
    赋值 (.标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, .取标题 (., 1), “配件盘点统计显示”))
    员工工作状态显示 (.取标题 (., 1), “\元件库.edb”)
.如果真结束
.如果真 (等于 (.标题, “使用配件数量”))
    赋值 (.标题, 相加 (“时间:”, .取标题 (., 1)))
    赋值 (.标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, .取标题 (., 1), “配件盘点统计显示”))
    显示柱状图 (.取标题 (., 1))
.如果真结束


.子程序 _企业收支统计表_被选择, 空白型, , 
赋值 (.标题, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “收支综合统计表”))
赋值 (项目管理识别号, 6)
连续赋值 (假, .可视, .)
赋值 (., 真)
打开表格显示 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\统计库.edb”))

.子程序 _员工月工资总表_被选择, 空白型, , 
赋值 (.标题, “基本工资合计”)
赋值 (.标题, “计件工资合计”)
赋值 (.标题, “应扣工资合计”)
赋值 (.标题, “实发工资合计”)
连续赋值 (“”, .内容, .内容, .内容, .内容)
读取指标到列表框 (相加 (到文本 (取年份 (取现行时间 ())), “年”, “员工月工资总表”), “\工资库.edb”)

.子程序 _员工配件领还_被选择, 空白型, , 
赋值 (.标题, “未归还配件数量”)
赋值 (.标题, “未归还配件价值”)
赋值 (.标题, “已使用配件数量”)
赋值 (.标题, “已归还配件数量”)
连续赋值 (“”, .内容, .内容, .内容, .内容)
读取指标到列表框 (相加 (到文本 (取年份 (取现行时间 ())), “年”, “员工配件领取和归还记录”), “\领归库.edb”)

.子程序 _使用配件分析_被选择, 空白型, , 
赋值 (.标题, “使用配件数量”)
赋值 (.标题, “回收配件资金”)
赋值 (.标题, “今日盘点负责人”)
赋值 (.标题, “盘点日期”)
连续赋值 (“”, .内容, .内容, .内容, .内容)
读取指标到列表框 (相加 (到文本 (取年份 (取现行时间 ())), “年”, “员工使用配件分析图”), “\元件库.edb”)

.子程序 _库存配件盘点_被选择, 空白型, , 
赋值 (.标题, “库存配件品种”)
赋值 (.标题, “库存本配件价值”)
赋值 (.标题, “今日盘点负责人”)
赋值 (.标题, “盘点日期”)
连续赋值 (“”, .内容, .内容, .内容, .内容)
读取指标到列表框 (相加 (到文本 (取年份 (取现行时间 ())), “年”, “配件盘点统计显示”), “\元件库.edb”)

.子程序 _维修综合分析_被选择, 空白型, , 
维修综合分析图 (相加 (到文本 (取年份 (取现行时间 ())), “年”, “企业电器维修综合分析图”), “\统计库.edb”)

.子程序 _收支统计分析_被选择, 空白型, , 
维修综合分析图 (相加 (到文本 (取年份 (取现行时间 ())), “年”, “企业收支结构图”), “\统计库.edb”)

.子程序 _接货登记_被选择, 空白型, , 
赋值 (项目管理识别号, 10)
载入 (登记窗口, , 真)

.子程序 _支出登记_被选择, 空白型, , 
赋值 (项目管理识别号, 11)
载入 (登记窗口, , 真)

.子程序 _配件入库登记_被选择, 空白型, , 
赋值 (项目管理识别号, 12)
载入 (登记窗口, , 真)

.子程序 _零售出库登记_被选择, 空白型, , 
赋值 (项目管理识别号, 13)
载入 (登记窗口, , 真)


.子程序 _员工领配登记_被选择, 空白型, , 
赋值 (项目管理识别号, 14)
载入 (登记窗口, , 真)


.子程序 _员工退库登记_被选择, 空白型, , 
赋值 (项目管理识别号, 15)
载入 (登记窗口, , 真)

.子程序 _表格_被双击, 逻辑型, , 选择是派工还是结算对话框
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (项目管理识别号, 1))
    未知支持库函数_3 ().未知支持库函数_24 (1, 未知支持库函数_3 (), 11, #浅灰)
    .如果 (等于 (信息框 (相加 (“结算还是派工?”, #换行符, “ 是 进入结算程序!”, #换行符, “ 否 进入派工程序!”), 相加 (#询问图标, #是否钮), “请选择是结算还是派工”), #是钮))
        赋值 (项目管理识别号, 20)
        载入 (结保配窗, , 真)
    .否则
        赋值 (项目管理识别号, 21)
        载入 (结保配窗, , 真)
    .如果结束
    
.如果真结束


.子程序 _打印预览_被选择, 空白型, , 
打印预览 ()

.子程序 _打印_被选择, 空白型, , 
开始打印 ()

.子程序 _表格_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (.标题, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “电器维修接货记录”)))
    .未知支持库函数_20 (“现在显示的是接修的电器,红色字表示已经派工、蓝色字表示缺件!”, #信息图标, , , , )
.如果真结束
.如果真 (等于 (.标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “家电维修历史档案”)))
    .未知支持库函数_20 (“现在显示的是维修历史档案!”, #信息图标, , , , )
.如果真结束
.如果真 (等于 (.标题, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “库存元件显示”)))
    .未知支持库函数_20 (“现在显示的是全部库存的配件!”, #信息图标, , , , )
.如果真结束
.如果真 (等于 (.标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “维修、销售配件记录”)))
    .未知支持库函数_20 (“这里显示的是已经零售或维修用后的配件记录!”, #信息图标, , , , )
.如果真结束
.如果真 (等于 (.标题, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “收支综合统计表”)))
    .未知支持库函数_20 (“这里是企业的年维修收支统计记录!”, #信息图标, , , , )
.如果真结束


.子程序 _关于_被选择, 空白型, , 
载入 (关于窗口, , 真)

.子程序 _注册_被选择, 空白型, , 
载入 (注册窗口, , 真)

.子程序 _使用向导_被选择, 空白型, , 
.如果 (等于 (寻找文件 (相加 (取当前目录 (), “\家电维修管理系统.chm”), ), “”))
    信息框 (相加 (“没有正确加载帮助文件，如果需要，请联系”, #换行符, “bklbklbk@public.cd.sc.cn或14696383 (370179803)”), #信息图标, “    提醒你特别注意:”)
.否则
    未知支持库函数_6 (4, “家电维修管理系统.chm”, , 相加 (取当前目录 (), “\”))
.如果结束


.程序集 第一子程序, , , 主窗口尺寸调整和创建数据库

.子程序 窗口调整, 空白型, , 
_启动窗口.移动 (., 0, _启动窗口..可视, 取屏幕宽度 (), 40)
_启动窗口.移动 (., 0, 相加 (_启动窗口..可视, _启动窗口..高度), 相减 (取屏幕宽度 (), 5), 相减 (取屏幕高度 (), _启动窗口..可视, _启动窗口..高度, _启动窗口.., 45))
_启动窗口.移动 (., 相减 (取屏幕宽度 (), _启动窗口..宽度, 6), 相减 (相加 (_启动窗口..可视, _启动窗口..高度), 5), 117, 相减 (取屏幕高度 (), _启动窗口..可视, _启动窗口..高度, _启动窗口.., 40))
_启动窗口.移动 (., 6, 39, 105, 相减 (_启动窗口..高度, 300))
_启动窗口.移动 (., 6, 相加 (_启动窗口..删除线, 70), 105, 222)
_启动窗口.置文本 (., 0, 相加 (“账套: ”, 登陆账册姓名))
_启动窗口.置文本 (., 1, 相加 (“操作员: ”, 登陆用户姓名))
_启动窗口.置文本 (., 2, “”)
_启动窗口.置文本 (., 3, 相加 (“业务日期: ”, 到文本 (取日期 (取现行时间 ()))))
_启动窗口.置文本 (., 4, “☆家电维修管理系统 v4.5☆”)
_启动窗口.置宽度 (., 0, 相乘 (相加 (取文本长度 (登陆账册姓名), 3), 8))
_启动窗口.置宽度 (., 1, 相乘 (相加 (取文本长度 (登陆用户姓名), 7), 8))
_启动窗口.置宽度 (., 3, 相乘 (相加 (取文本长度 (到文本 (取日期 (取现行时间 ()))), 7), 8))
_启动窗口.置宽度 (., 4, 170)
_启动窗口.置宽度 (., 2, 相减 (_启动窗口.取用户区宽度 (), _启动窗口.取宽度 (., 0), _启动窗口.取宽度 (., 1)))

.子程序 调整表格宽度, 空白型, , 
.判断开始 (等于 (项目管理识别号, 1)) ' 调整“接货库”和“历史库”的显示列宽
    _启动窗口.未知支持库函数_32 (., 0, 40)
    _启动窗口.未知支持库函数_32 (., 1, 90)
    _启动窗口.未知支持库函数_32 (., 2, 60)
    _启动窗口.未知支持库函数_32 (., 3, 120)
    _启动窗口.未知支持库函数_32 (., 4, 90)
    _启动窗口.未知支持库函数_32 (., 5, 90)
    _启动窗口.未知支持库函数_32 (., 6, 130)
    _启动窗口.未知支持库函数_32 (., 7, 60)
    _启动窗口.未知支持库函数_32 (., 8, 120)
    _启动窗口.未知支持库函数_32 (., 9, 70)
    _启动窗口.未知支持库函数_32 (., 10, 60)
    _启动窗口.未知支持库函数_32 (., 11, 60)
    _启动窗口.未知支持库函数_32 (., 12, 70)
    _启动窗口.未知支持库函数_32 (., 13, 60)
    _启动窗口.未知支持库函数_32 (., 14, 60)
    _启动窗口.未知支持库函数_32 (., 15, 80)
    _启动窗口.未知支持库函数_32 (., 16, 60)
    _启动窗口.未知支持库函数_32 (., 17, 60)
    _启动窗口.未知支持库函数_32 (., 18, 90)
    _启动窗口.未知支持库函数_32 (., 19, 60)
    _启动窗口.未知支持库函数_32 (., 20, 50)
    _启动窗口.未知支持库函数_32 (., 21, 50)
    _启动窗口.未知支持库函数_32 (., 22, 50)
    _启动窗口.未知支持库函数_32 (., 23, 50)
    _启动窗口.未知支持库函数_32 (., 24, 50)
    _启动窗口.未知支持库函数_32 (., 25, 150)
.判断 (等于 (项目管理识别号, 2)) ' 调整“元件库”的显示列宽
    _启动窗口.未知支持库函数_32 (., 0, 40)
    _启动窗口.未知支持库函数_32 (., 1, 60)
    _启动窗口.未知支持库函数_32 (., 2, 80)
    _启动窗口.未知支持库函数_32 (., 3, 120)
    _启动窗口.未知支持库函数_32 (., 4, 50)
    _启动窗口.未知支持库函数_32 (., 5, 60)
    _启动窗口.未知支持库函数_32 (., 6, 60)
    _启动窗口.未知支持库函数_32 (., 7, 60)
    _启动窗口.未知支持库函数_32 (., 8, 60)
    _启动窗口.未知支持库函数_32 (., 9, 60)
    _启动窗口.未知支持库函数_32 (., 10, 60)
    _启动窗口.未知支持库函数_32 (., 11, 90)
    _启动窗口.未知支持库函数_32 (., 12, 190)
.判断 (等于 (项目管理识别号, 3)) ' 调整“出货库”的显示列宽
    _启动窗口.未知支持库函数_32 (., 0, 40)
    _启动窗口.未知支持库函数_32 (., 1, 60)
    _启动窗口.未知支持库函数_32 (., 2, 80)
    _启动窗口.未知支持库函数_32 (., 3, 120)
    _启动窗口.未知支持库函数_32 (., 4, 50)
    _启动窗口.未知支持库函数_32 (., 5, 60)
    _启动窗口.未知支持库函数_32 (., 6, 80)
    _启动窗口.未知支持库函数_32 (., 7, 80)
    _启动窗口.未知支持库函数_32 (., 8, 80)
    _启动窗口.未知支持库函数_32 (., 9, 90)
    _启动窗口.未知支持库函数_32 (., 10, 60)
    _启动窗口.未知支持库函数_32 (., 11, 60)
    _启动窗口.未知支持库函数_32 (., 12, 130)
.判断 (等于 (项目管理识别号, 4)) ' 调整“工资库”的显示列宽
    _启动窗口.未知支持库函数_32 (., 0, 40)
    _启动窗口.未知支持库函数_32 (., 1, 70)
    _启动窗口.未知支持库函数_32 (., 7, 100)
    _启动窗口.未知支持库函数_32 (., 11, 80)
    _启动窗口.未知支持库函数_32 (., 12, 110)
.判断 (等于 (项目管理识别号, 5)) ' 调整“领归库”的显示列宽
    _启动窗口.未知支持库函数_32 (., 0, 40)
    _启动窗口.未知支持库函数_32 (., 1, 60)
    _启动窗口.未知支持库函数_32 (., 2, 90)
    _启动窗口.未知支持库函数_32 (., 3, 60)
    _启动窗口.未知支持库函数_32 (., 4, 120)
    _启动窗口.未知支持库函数_32 (., 5, 90)
    _启动窗口.未知支持库函数_32 (., 9, 90)
    _启动窗口.未知支持库函数_32 (., 11, 100)
.判断 (等于 (项目管理识别号, 6)) ' 调整“统计库”的显示列宽
    _启动窗口.未知支持库函数_32 (., 0, 70)
    _启动窗口.未知支持库函数_32 (., 1, 80)
    _启动窗口.未知支持库函数_32 (., 2, 80)
    _启动窗口.未知支持库函数_32 (., 3, 80)
    _启动窗口.未知支持库函数_32 (., 4, 110)
    _启动窗口.未知支持库函数_32 (., 5, 80)
    _启动窗口.未知支持库函数_32 (., 6, 80)
    _启动窗口.未知支持库函数_32 (., 7, 80)
    _启动窗口.未知支持库函数_32 (., 8, 80)
    _启动窗口.未知支持库函数_32 (., 9, 80)
    _启动窗口.未知支持库函数_32 (., 10, 80)
    _启动窗口.未知支持库函数_32 (., 11, 110)
    _启动窗口.未知支持库函数_32 (., 12, 120)
.默认
    
.判断结束


.子程序 创建密码校验数据库, 空白型, , 
.局部变量 密码表, 字段信息, , "0", 
.局部变量 密码, 字段信息, , , 

.如果真 (等于 (寻找文件 (相加 (取当前目录 (), “\mmk.edb”), ), “”))
    赋值 (密码.名称, “财务账册”)
    赋值 (密码.类型, #文本型)
    赋值 (密码.最大文本长度, 40)
    加入成员 (密码表, 密码)
    赋值 (密码.名称, “管理员”)
    赋值 (密码.类型, #文本型)
    赋值 (密码.最大文本长度, 10)
    加入成员 (密码表, 密码)
    赋值 (密码.名称, “密码”)
    赋值 (密码.类型, #字节集型)
    加入成员 (密码表, 密码)
    赋值 (密码.名称, “首选”)
    赋值 (密码.类型, #逻辑型)
    加入成员 (密码表, 密码)
    赋值 (密码.名称, “建账人”)
    赋值 (密码.类型, #逻辑型)
    加入成员 (密码表, 密码)
    赋值 (密码.名称, “记住密码”)
    赋值 (密码.类型, #逻辑型)
    加入成员 (密码表, 密码)
    创建 (相加 (取当前目录 (), “\mmk.edb”), 密码表)
    打开 (相加 (取当前目录 (), “\mmk.edb”), “mmk”, , , , , )
    加记录 (“家电维修财务管理账册”, “超级管理员”, 未知支持库函数_3 (到字节集 (“bklbklbk”), “bbkkklll”, 2), 真, 真, 假)
    置数据库密码 (“bbkkklll”)
    关闭 ()
.如果真结束


.子程序 创建资料库, 空白型, , 
.局部变量 记数, 整数型, , , 
.局部变量 接货库, 字段信息, , "0", 
.局部变量 接货, 字段信息, , , 
.局部变量 历史库, 字段信息, , "0", 
.局部变量 历史, 字段信息, , , 
.局部变量 元件库, 字段信息, , "0", 
.局部变量 元件, 字段信息, , , 
.局部变量 派工库, 字段信息, , "0", 
.局部变量 派工, 字段信息, , , 
.局部变量 统计库, 字段信息, , "0", 
.局部变量 统计, 字段信息, , , 
.局部变量 工资库, 字段信息, , "0", 
.局部变量 工资, 字段信息, , , 
.局部变量 出货库, 字段信息, , "0", 
.局部变量 出货, 字段信息, , , 
.局部变量 职员库, 字段信息, , "0", 
.局部变量 职员, 字段信息, , , 
.局部变量 领归库, 字段信息, , "0", 
.局部变量 领归, 字段信息, , , 

.如果真 (等于 (寻找文件 (相加 (取当前目录 (), “\”, 登陆账册姓名), ), “”))
    创建目录 (相加 (取当前目录 (), “\”, 登陆账册姓名))
.如果真结束
.如果真 (等于 (寻找文件 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\接货库.edb”), ), “”))
    赋值 (接货.名称, “编号”)
    赋值 (接货.类型, #整数型)
    加入成员 (接货库, 接货)
    赋值 (接货.名称, “接修时间”)
    赋值 (接货.类型, #日期时间型)
    加入成员 (接货库, 接货)
    赋值 (接货.名称, “送修货品”)
    赋值 (接货.类型, #文本型)
    赋值 (接货.最大文本长度, 6)
    加入成员 (接货库, 接货)
    赋值 (接货.名称, “电器品牌”)
    赋值 (接货.类型, #文本型)
    赋值 (接货.最大文本长度, 40)
    加入成员 (接货库, 接货)
    赋值 (接货.名称, “产品型号”)
    赋值 (接货.类型, #文本型)
    赋值 (接货.最大文本长度, 20)
    加入成员 (接货库, 接货)
    赋值 (接货.名称, “产品代码”)
    赋值 (接货.类型, #文本型)
    赋值 (接货.最大文本长度, 13)
    加入成员 (接货库, 接货)
    赋值 (接货.名称, “故障描述”)
    赋值 (接货.类型, #文本型)
    赋值 (接货.最大文本长度, 20)
    加入成员 (接货库, 接货)
    赋值 (接货.名称, “客户姓名”)
    赋值 (接货.类型, #文本型)
    赋值 (接货.最大文本长度, 8)
    加入成员 (接货库, 接货)
    赋值 (接货.名称, “客户地址”)
    赋值 (接货.类型, #文本型)
    赋值 (接货.最大文本长度, 40)
    加入成员 (接货库, 接货)
    赋值 (接货.名称, “客户电话”)
    赋值 (接货.类型, #文本型)
    赋值 (接货.最大文本长度, 13)
    加入成员 (接货库, 接货)
    赋值 (接货.名称, “接修方式”)
    赋值 (接货.类型, #文本型)
    赋值 (接货.最大文本长度, 8)
    加入成员 (接货库, 接货)
    赋值 (接货.名称, “调单号码”)
    赋值 (接货.类型, #文本型)
    赋值 (接货.最大文本长度, 13)
    加入成员 (接货库, 接货)
    创建 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\接货库.edb”), 接货库)
    打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\接货库.edb”), , , , , , )
    置数据库密码 (“bbkkklll”)
    关闭 ()
.如果真结束
.如果真 (等于 (寻找文件 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\历史库.edb”), ), “”))
    赋值 (历史.名称, “编号”)
    赋值 (历史.类型, #整数型)
    加入成员 (历史库, 历史)
    赋值 (历史.名称, “接修时间”)
    赋值 (历史.类型, #日期时间型)
    加入成员 (历史库, 历史)
    赋值 (历史.名称, “送修货品”)
    赋值 (历史.类型, #文本型)
    赋值 (历史.最大文本长度, 6)
    加入成员 (历史库, 历史)
    赋值 (历史.名称, “电器品牌”)
    赋值 (历史.类型, #文本型)
    赋值 (历史.最大文本长度, 40)
    加入成员 (历史库, 历史)
    赋值 (历史.名称, “产品型号”)
    赋值 (历史.类型, #文本型)
    赋值 (历史.最大文本长度, 20)
    加入成员 (历史库, 历史)
    赋值 (历史.名称, “产品代码”)
    赋值 (历史.类型, #文本型)
    赋值 (历史.最大文本长度, 13)
    加入成员 (历史库, 历史)
    赋值 (历史.名称, “故障描述”)
    赋值 (历史.类型, #文本型)
    赋值 (历史.最大文本长度, 20)
    加入成员 (历史库, 历史)
    赋值 (历史.名称, “客户姓名”)
    赋值 (历史.类型, #文本型)
    赋值 (历史.最大文本长度, 8)
    加入成员 (历史库, 历史)
    赋值 (历史.名称, “客户地址”)
    赋值 (历史.类型, #文本型)
    赋值 (历史.最大文本长度, 40)
    加入成员 (历史库, 历史)
    赋值 (历史.名称, “客户电话”)
    赋值 (历史.类型, #文本型)
    赋值 (历史.最大文本长度, 13)
    加入成员 (历史库, 历史)
    赋值 (历史.名称, “接修方式”)
    赋值 (历史.类型, #文本型)
    赋值 (历史.最大文本长度, 8)
    加入成员 (历史库, 历史)
    赋值 (历史.名称, “调单号码”)
    赋值 (历史.类型, #文本型)
    赋值 (历史.最大文本长度, 13)
    加入成员 (历史库, 历史)
    赋值 (历史.名称, “是否返修机”)
    赋值 (历史.类型, #文本型)
    赋值 (历史.最大文本长度, 2)
    加入成员 (历史库, 历史)
    赋值 (历史.名称, “维修结果”)
    赋值 (历史.类型, #文本型)
    赋值 (历史.最大文本长度, 8)
    加入成员 (历史库, 历史)
    赋值 (历史.名称, “是否保修”)
    赋值 (历史.类型, #文本型)
    赋值 (历史.最大文本长度, 2)
    加入成员 (历史库, 历史)
    赋值 (历史.名称, “检测情况”)
    赋值 (历史.类型, #文本型)
    赋值 (历史.最大文本长度, 40)
    加入成员 (历史库, 历史)
    赋值 (历史.名称, “保修凭据”)
    赋值 (历史.类型, #文本型)
    赋值 (历史.最大文本长度, 13)
    加入成员 (历史库, 历史)
    赋值 (历史.名称, “收款方式”)
    赋值 (历史.类型, #文本型)
    赋值 (历史.最大文本长度, 8)
    加入成员 (历史库, 历史)
    赋值 (历史.名称, “交货日期”)
    赋值 (历史.类型, #日期时间型)
    加入成员 (历史库, 历史)
    赋值 (历史.名称, “交货方式”)
    赋值 (历史.类型, #文本型)
    赋值 (历史.最大文本长度, 8)
    加入成员 (历史库, 历史)
    赋值 (历史.名称, “维修员”)
    赋值 (历史.类型, #文本型)
    赋值 (历史.最大文本长度, 8)
    加入成员 (历史库, 历史)
    赋值 (历史.名称, “元件费”)
    赋值 (历史.类型, #小数型)
    加入成员 (历史库, 历史)
    赋值 (历史.名称, “检修费”)
    赋值 (历史.类型, #小数型)
    加入成员 (历史库, 历史)
    赋值 (历史.名称, “附加费”)
    赋值 (历史.类型, #小数型)
    加入成员 (历史库, 历史)
    赋值 (历史.名称, “返修费”)
    赋值 (历史.类型, #小数型)
    加入成员 (历史库, 历史)
    赋值 (历史.名称, “更换元件”)
    赋值 (历史.类型, #文本型)
    赋值 (历史.最大文本长度, 40)
    加入成员 (历史库, 历史)
    创建 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\历史库.edb”), 历史库)
    打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\历史库.edb”), , , , , , )
    置数据库密码 (“bbkkklll”)
    关闭 ()
.如果真结束
.如果真 (等于 (寻找文件 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\元件库.edb”), ), “”))
    赋值 (元件.名称, “编号”)
    赋值 (元件.类型, #整数型)
    加入成员 (元件库, 元件)
    赋值 (元件.名称, “配件类型”)
    赋值 (元件.类型, #文本型)
    赋值 (元件.最大文本长度, 6)
    加入成员 (元件库, 元件)
    赋值 (元件.名称, “配件名称”)
    赋值 (元件.类型, #文本型)
    赋值 (元件.最大文本长度, 20)
    加入成员 (元件库, 元件)
    赋值 (元件.名称, “规格型号”)
    赋值 (元件.类型, #文本型)
    赋值 (元件.最大文本长度, 40)
    加入成员 (元件库, 元件)
    赋值 (元件.名称, “单位”)
    赋值 (元件.类型, #文本型)
    赋值 (元件.最大文本长度, 4)
    加入成员 (元件库, 元件)
    赋值 (元件.名称, “单价”)
    赋值 (元件.类型, #小数型)
    加入成员 (元件库, 元件)
    赋值 (元件.名称, “数量”)
    赋值 (元件.类型, #整数型)
    加入成员 (元件库, 元件)
    赋值 (元件.名称, “金额”)
    赋值 (元件.类型, #小数型)
    加入成员 (元件库, 元件)
    赋值 (元件.名称, “经手人”)
    赋值 (元件.类型, #文本型)
    赋值 (元件.最大文本长度, 8)
    加入成员 (元件库, 元件)
    赋值 (元件.名称, “支付方式”)
    赋值 (元件.类型, #文本型)
    赋值 (元件.最大文本长度, 8)
    加入成员 (元件库, 元件)
    赋值 (元件.名称, “存放位置”)
    赋值 (元件.类型, #整数型)
    加入成员 (元件库, 元件)
    赋值 (元件.名称, “入库日期”)
    赋值 (元件.类型, #日期时间型)
    加入成员 (元件库, 元件)
    赋值 (元件.名称, “备注”)
    赋值 (元件.类型, #备注型)
    加入成员 (元件库, 元件)
    创建 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\元件库.edb”), 元件库)
    打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\元件库.edb”), , , , , , )
    置数据库密码 (“bbkkklll”)
    关闭 ()
    
.如果真结束
.如果真 (等于 (寻找文件 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\派工库.edb”), ), “”))
    赋值 (派工.名称, “派工号”)
    赋值 (派工.类型, #整数型)
    加入成员 (派工库, 派工)
    赋值 (派工.名称, “送修货品”)
    赋值 (派工.类型, #文本型)
    赋值 (派工.最大文本长度, 6)
    加入成员 (派工库, 派工)
    赋值 (派工.名称, “电器品牌”)
    赋值 (派工.类型, #文本型)
    赋值 (派工.最大文本长度, 40)
    加入成员 (派工库, 派工)
    赋值 (派工.名称, “产品型号”)
    赋值 (派工.类型, #文本型)
    赋值 (派工.最大文本长度, 20)
    加入成员 (派工库, 派工)
    赋值 (派工.名称, “产品代码”)
    赋值 (派工.类型, #文本型)
    赋值 (派工.最大文本长度, 13)
    加入成员 (派工库, 派工)
    赋值 (派工.名称, “缺元件”)
    赋值 (派工.类型, #文本型)
    赋值 (派工.最大文本长度, 4)
    加入成员 (派工库, 派工)
    创建 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\派工库.edb”), 派工库)
    打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\派工库.edb”), , , , , , )
    置数据库密码 (“bbkkklll”)
    关闭 ()
.如果真结束
.如果真 (等于 (寻找文件 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\统计库.edb”), ), “”))
    赋值 (统计.名称, “统计月份”)
    赋值 (统计.类型, #文本型)
    赋值 (统计.最大文本长度, 10)
    加入成员 (统计库, 统计)
    赋值 (统计.名称, “维修收入”)
    赋值 (统计.类型, #小数型)
    加入成员 (统计库, 统计)
    赋值 (统计.名称, “附加费”)
    赋值 (统计.类型, #小数型)
    加入成员 (统计库, 统计)
    赋值 (统计.名称, “零售收入”)
    赋值 (统计.类型, #小数型)
    加入成员 (统计库, 统计)
    赋值 (统计.名称, “收入合计”)
    赋值 (统计.类型, #小数型)
    加入成员 (统计库, 统计)
    赋值 (统计.名称, “元件费”)
    赋值 (统计.类型, #小数型)
    加入成员 (统计库, 统计)
    赋值 (统计.名称, “返工费”)
    赋值 (统计.类型, #小数型)
    加入成员 (统计库, 统计)
    赋值 (统计.名称, “水电费”)
    赋值 (统计.类型, #小数型)
    加入成员 (统计库, 统计)
    赋值 (统计.名称, “税收费”)
    赋值 (统计.类型, #小数型)
    加入成员 (统计库, 统计)
    赋值 (统计.名称, “杂项费”)
    赋值 (统计.类型, #小数型)
    加入成员 (统计库, 统计)
    赋值 (统计.名称, “支出合计”)
    赋值 (统计.类型, #小数型)
    加入成员 (统计库, 统计)
    赋值 (统计.名称, “本月利润”)
    赋值 (统计.类型, #小数型)
    加入成员 (统计库, 统计)
    创建 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\统计库.edb”), 统计库)
    打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\统计库.edb”), , , , , , )
    .计次循环首 (13, 记数)
        .如果 (小于或等于 (记数, 12))
            加记录 (相加 (到文本 (取年份 (取现行时间 ())), “年”, 到文本 (记数), “月”))
        .否则
            加记录 (“合    计:”)
        .如果结束
        
    .计次循环尾 ()
    置数据库密码 (“bbkkklll”)
    关闭 ()
.如果真结束
.如果真 (等于 (寻找文件 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\工资库.edb”), ), “”))
    赋值 (工资.名称, “编号”)
    赋值 (工资.类型, #整数型)
    加入成员 (工资库, 工资)
    赋值 (工资.名称, “统计时间”)
    赋值 (工资.类型, #文本型)
    赋值 (工资.最大文本长度, 10)
    加入成员 (工资库, 工资)
    赋值 (工资.名称, “员工姓名”)
    赋值 (工资.类型, #文本型)
    赋值 (工资.最大文本长度, 8)
    加入成员 (工资库, 工资)
    赋值 (工资.名称, “基本工资”)
    赋值 (工资.类型, #小数型)
    加入成员 (工资库, 工资)
    赋值 (工资.名称, “计时工资”)
    赋值 (工资.类型, #小数型)
    加入成员 (工资库, 工资)
    赋值 (工资.名称, “计件工资”)
    赋值 (工资.类型, #小数型)
    加入成员 (工资库, 工资)
    赋值 (工资.名称, “其它补贴”)
    赋值 (工资.类型, #小数型)
    加入成员 (工资库, 工资)
    赋值 (工资.名称, “应发合计”)
    赋值 (工资.类型, #小数型)
    加入成员 (工资库, 工资)
    赋值 (工资.名称, “返工扣款”)
    赋值 (工资.类型, #小数型)
    加入成员 (工资库, 工资)
    赋值 (工资.名称, “缺勤扣款”)
    赋值 (工资.类型, #小数型)
    加入成员 (工资库, 工资)
    赋值 (工资.名称, “社保扣款”)
    赋值 (工资.类型, #小数型)
    加入成员 (工资库, 工资)
    赋值 (工资.名称, “个人所得税”)
    赋值 (工资.类型, #小数型)
    加入成员 (工资库, 工资)
    赋值 (工资.名称, “实发工资”)
    赋值 (工资.类型, #小数型)
    加入成员 (工资库, 工资)
    创建 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\工资库.edb”), 工资库)
    打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\工资库.edb”), , , , , , )
    置数据库密码 (“bbkkklll”)
    关闭 ()
.如果真结束
.如果真 (等于 (寻找文件 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\出货库.edb”), ), “”))
    赋值 (出货.名称, “编号”)
    赋值 (出货.类型, #整数型)
    加入成员 (出货库, 出货)
    赋值 (出货.名称, “配件类型”)
    赋值 (出货.类型, #文本型)
    赋值 (出货.最大文本长度, 8)
    加入成员 (出货库, 出货)
    赋值 (出货.名称, “配件名称”)
    赋值 (出货.类型, #文本型)
    赋值 (出货.最大文本长度, 40)
    加入成员 (出货库, 出货)
    赋值 (出货.名称, “规格型号”)
    赋值 (出货.类型, #文本型)
    赋值 (出货.最大文本长度, 40)
    加入成员 (出货库, 出货)
    赋值 (出货.名称, “单位”)
    赋值 (出货.类型, #文本型)
    赋值 (出货.最大文本长度, 4)
    加入成员 (出货库, 出货)
    赋值 (出货.名称, “出货方式”)
    赋值 (出货.类型, #文本型)
    赋值 (出货.最大文本长度, 8)
    加入成员 (出货库, 出货)
    赋值 (出货.名称, “单价”)
    赋值 (出货.类型, #小数型)
    加入成员 (出货库, 出货)
    赋值 (出货.名称, “数量”)
    赋值 (出货.类型, #整数型)
    加入成员 (出货库, 出货)
    赋值 (出货.名称, “售价”)
    赋值 (出货.类型, #小数型)
    加入成员 (出货库, 出货)
    赋值 (出货.名称, “出货日期”)
    赋值 (出货.类型, #日期时间型)
    加入成员 (出货库, 出货)
    赋值 (出货.名称, “经手人”)
    赋值 (出货.类型, #文本型)
    赋值 (出货.最大文本长度, 8)
    加入成员 (出货库, 出货)
    赋值 (出货.名称, “支付方式”)
    赋值 (出货.类型, #文本型)
    赋值 (出货.最大文本长度, 8)
    加入成员 (出货库, 出货)
    赋值 (出货.名称, “备注”)
    赋值 (出货.类型, #备注型)
    加入成员 (出货库, 出货)
    创建 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\出货库.edb”), 出货库)
    打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\出货库.edb”), , , , , , )
    置数据库密码 (“bbkkklll”)
    关闭 ()
.如果真结束
.如果真 (等于 (寻找文件 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\职员库.edb”), ), “”))
    赋值 (职员.名称, “编号”)
    赋值 (职员.类型, #整数型)
    加入成员 (职员库, 职员)
    赋值 (职员.名称, “姓名”)
    赋值 (职员.类型, #文本型)
    赋值 (职员.最大文本长度, 8)
    加入成员 (职员库, 职员)
    赋值 (职员.名称, “姓别”)
    赋值 (职员.类型, #文本型)
    赋值 (职员.最大文本长度, 2)
    加入成员 (职员库, 职员)
    赋值 (职员.名称, “电话”)
    赋值 (职员.类型, #文本型)
    赋值 (职员.最大文本长度, 13)
    加入成员 (职员库, 职员)
    赋值 (职员.名称, “出生”)
    赋值 (职员.类型, #日期时间型)
    加入成员 (职员库, 职员)
    赋值 (职员.名称, “手机”)
    赋值 (职员.类型, #文本型)
    赋值 (职员.最大文本长度, 15)
    加入成员 (职员库, 职员)
    赋值 (职员.名称, “身份证”)
    赋值 (职员.类型, #文本型)
    赋值 (职员.最大文本长度, 20)
    加入成员 (职员库, 职员)
    赋值 (职员.名称, “学历”)
    赋值 (职员.类型, #文本型)
    赋值 (职员.最大文本长度, 6)
    加入成员 (职员库, 职员)
    赋值 (职员.名称, “地址”)
    赋值 (职员.类型, #文本型)
    赋值 (职员.最大文本长度, 40)
    加入成员 (职员库, 职员)
    赋值 (职员.名称, “职务”)
    赋值 (职员.类型, #文本型)
    赋值 (职员.最大文本长度, 10)
    加入成员 (职员库, 职员)
    赋值 (职员.名称, “电子邮件”)
    赋值 (职员.类型, #文本型)
    赋值 (职员.最大文本长度, 30)
    加入成员 (职员库, 职员)
    赋值 (职员.名称, “备注”)
    赋值 (职员.类型, #备注型)
    加入成员 (职员库, 职员)
    赋值 (职员.名称, “基本工资”)
    赋值 (职员.类型, #小数型)
    加入成员 (职员库, 职员)
    赋值 (职员.名称, “计时工资”)
    赋值 (职员.类型, #小数型)
    加入成员 (职员库, 职员)
    赋值 (职员.名称, “计件工资”)
    赋值 (职员.类型, #小数型)
    加入成员 (职员库, 职员)
    创建 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\职员库.edb”), 职员库)
    打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\职员库.edb”), , , , , , )
    置数据库密码 (“bbkkklll”)
    关闭 ()
.如果真结束
.如果真 (等于 (寻找文件 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\领归库.edb”), ), “”))
    赋值 (领归.名称, “编号”)
    赋值 (领归.类型, #整数型)
    加入成员 (领归库, 领归)
    赋值 (领归.名称, “员工姓名”)
    赋值 (领归.类型, #文本型)
    赋值 (领归.最大文本长度, 8)
    加入成员 (领归库, 领归)
    赋值 (领归.名称, “领出日期”)
    赋值 (领归.类型, #日期时间型)
    加入成员 (领归库, 领归)
    赋值 (领归.名称, “配件类型”)
    赋值 (领归.类型, #文本型)
    赋值 (领归.最大文本长度, 8)
    加入成员 (领归库, 领归)
    赋值 (领归.名称, “配件名称”)
    赋值 (领归.类型, #文本型)
    赋值 (领归.最大文本长度, 40)
    加入成员 (领归库, 领归)
    赋值 (领归.名称, “规格型号”)
    赋值 (领归.类型, #文本型)
    赋值 (领归.最大文本长度, 40)
    加入成员 (领归库, 领归)
    赋值 (领归.名称, “领出数量”)
    赋值 (领归.类型, #整数型)
    加入成员 (领归库, 领归)
    赋值 (领归.名称, “配件单价”)
    赋值 (领归.类型, #小数型)
    加入成员 (领归库, 领归)
    赋值 (领归.名称, “使用数量”)
    赋值 (领归.类型, #整数型)
    加入成员 (领归库, 领归)
    赋值 (领归.名称, “归还日期”)
    赋值 (领归.类型, #日期时间型)
    加入成员 (领归库, 领归)
    赋值 (领归.名称, “归还数量”)
    赋值 (领归.类型, #整数型)
    加入成员 (领归库, 领归)
    赋值 (领归.名称, “备注”)
    赋值 (领归.类型, #备注型)
    加入成员 (领归库, 领归)
    创建 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\领归库.edb”), 领归库)
    打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\领归库.edb”), , , , , , )
    置数据库密码 (“bbkkklll”)
    关闭 ()
.如果真结束
管理权限写入 ()

.子程序 管理权限写入, 空白型, , 
.如果 (等于 (注册项是否存在 (#本地机器, “SOFTWARE\bkl\账册管理权限”), 假))
    写注册项 (#本地机器, “SOFTWARE\bkl\账册管理权限”, 1)
    写注册项 (#本地机器, “SOFTWARE\bkl\用户管理权限”, 1)
    写注册项 (#本地机器, “SOFTWARE\bkl\初始化数据库权限”, 1)
    写注册项 (#本地机器, “SOFTWARE\bkl\资料能否导出权限”, 1)
    写注册项 (#本地机器, “SOFTWARE\bkl\系统资料查询权限”, 1)
    写注册项 (#本地机器, “SOFTWARE\bkl\员工档案管理权限”, 1)
.否则
    
.如果结束


.窗口程序集 密码窗口, , , 

.子程序 _密码窗口_创建完毕, 空白型, , 
.局部变量 财务账册名, 文本型, , , 在账务账册框中显示所有账册

打开 (相加 (取当前目录 (), “\mmk.edb”), “mmk”, , , , “bbkkklll”, )
.计次循环首 (取记录数 (), )
    .判断开始 (不等于 (读 (1), 财务账册名)) ' 去除重复的账册名
        读 (1).加入项目 ()
    .默认
        
    .判断结束
    .如果真 (等于 (读 (4), 真)) ' 判断是否记住密码
        赋值 (.现行选中项, 相减 (取记录号 (), 1))
        赋值 (.选中, 读 (6))
        .如果真 (等于 (.选中, 真))
            赋值 (.内容, 到文本 (未知支持库函数_4 (读 (3), “bbkkklll”, 2)))
        .如果真结束
        
    .如果真结束
    赋值 (财务账册名, 读 (1))
    跳过 ()
.计次循环尾 ()
到首记录 ()
.判断循环首 (查找 (等于 (读 (1), .取项目文本 (.现行选中项)))) ' 加入员姓名
    读 (2).加入项目 ()
    跳过 ()
.判断循环尾 ()
关闭 ()
赋值 (.现行选中项, 0)

.子程序 _记住密码_被单击, 空白型, , 调整是否需要在下次启动时记住密码
.如果 (等于 (.内容, “”))
    信息框 (“请输入正确的密码!”, 0, )
    获取焦点 ()
    返回 ()
.否则
    打开 (相加 (取当前目录 (), “\mmk.edb”), “mmk”, , , , “bbkkklll”, )
    到首记录 ()
    .如果真 (并且 (查找 (等于 (读 (1), .取项目文本 (.现行选中项))), 查找 (等于 (读 (2), .取项目文本 (.现行选中项))), 查找 (等于 (到文本 (未知支持库函数_4 (读 (3), “bbkkklll”, 2)), .内容))))
        .如果 (等于 (.选中, 真))
            修改 (真)
        .否则
            修改 (假)
        .如果结束
        
    .如果真结束
    关闭 ()
.如果结束


.子程序 _财务账册_列表项被选择, 空白型, , 选择需要的账册
清空 ()
赋值 (.内容, “”)
打开 (相加 (取当前目录 (), “\mmk.edb”), “mmk”, , , , “bbkkklll”, )
到首记录 ()
.判断循环首 (查找 (等于 (读 (1), .取项目文本 (.现行选中项)))) ' 选择与所选账册对应的管理员
    读 (2).加入项目 ()
    跳过 ()
.判断循环尾 ()
赋值 (.现行选中项, 0)
到首记录 ()
.如果真 (查找 (等于 (读 (2), .取项目文本 (.现行选中项)))) ' 判断上次启动时是否已经记住了密码
    赋值 (.选中, 读 (6))
    .如果真 (等于 (.选中, 真))
        赋值 (.内容, 到文本 (未知支持库函数_4 (读 (3), “bbkkklll”, 2)))
    .如果真结束
    
.如果真结束
关闭 ()
获取焦点 ()

.子程序 _管理员_列表项被选择, 空白型, , 选择需要的管理员
赋值 (.内容, “”)
打开 (相加 (取当前目录 (), “\mmk.edb”), “mmk”, , , , “bbkkklll”, )
到首记录 ()
.如果真 (并且 (查找 (等于 (读 (1), .取项目文本 (.现行选中项))), 查找 (等于 (读 (2), .取项目文本 (.现行选中项))))) ' 判断上次启动时是否已经记住了密码
    赋值 (.选中, 读 (6))
    .如果真 (等于 (.选中, 真))
        赋值 (.内容, 到文本 (未知支持库函数_4 (读 (3), “bbkkklll”, 2)))
    .如果真结束
    
.如果真结束
关闭 ()

.子程序 _按钮1_被单击, 空白型, , 
打开 (相加 (取当前目录 (), “\mmk.edb”), “mmk”, , , , “bbkkklll”, )
到首记录 ()
.如果 (并且 (查找 (等于 (读 (1), .取项目文本 (.现行选中项))), 查找 (等于 (读 (2), .取项目文本 (.现行选中项))), 等于 (未知支持库函数_4 (读 (3), “bbkkklll”, 2), 到字节集 (.内容))))
    .如果 (等于 (.选中, 真))
        修改 (真, , , , , , , , , , , , , , , )
    .否则
        修改 (假, , , , , , , , , , , , , , , )
    .如果结束
    赋值 (登陆账册姓名, .取项目文本 (.现行选中项))
    赋值 (登陆用户姓名, .取项目文本 (.现行选中项))
    关闭 ()
    创建资料库 () ' 创建属于本账册的数据库
    销毁 ()
.否则
    信息框 (“登陆密码不对,请重新输入!”, 0, )
    返回 ()
.如果结束


.子程序 _按钮2_被单击, 空白型, , 
结束 ()


.子程序 _密码窗口_可否被关闭, 逻辑型, , 
结束 ()


.程序集 第二子程序, , , 在窗口表格中显示数据

.程序集变量 派工号, 整数型, , "0", 
.程序集变量 缺件, 整数型, , "0", 
.程序集变量 派工或缺件总数, 整数型, , , 
.子程序 打开表格显示, 空白型, , 
.参数 欲打开数据库, 文本型, , 

.局部变量 字段个数, 整数型, , , 
.局部变量 索引, 整数型, , , 
.局部变量 记数, 整数型, , , 
.局部变量 合计, 整数型, , "11", 

打开 (欲打开数据库, , , , , “bbkkklll”, )
赋值 (_启动窗口.., 相加 (取记录数 (), 1))
赋值 (_启动窗口.., 取字段数 ())
调整表格宽度 ()
置等待鼠标 ()
.计次循环首 (取字段数 (), 字段个数) ' 显示出字段名到表格中
    _启动窗口.未知支持库函数_9 (., 0, 相减 (字段个数, 1), 1, 到文本 (取字段名 (字段个数)))
.计次循环尾 ()
赋值 (字段个数, 0)
.计次循环首 (相加 (取记录数 (), 1), 索引) ' 读入所有记录到中
    跳到 (索引)
    .计次循环首 (取字段数 (), 字段个数)
        .如果真 (并且 (等于 (项目管理识别号, 6), 小于或等于 (字段个数, 11))) ' 将每月的记录写入“合计[字段数]”的数组中.
            赋值 (合计 [字段个数], 相加 (合计 [字段个数], 读 (相加 (字段个数, 1))))
        .如果真结束
        .如果 (并且 (等于 (项目管理识别号, 6), 等于 (索引, 13))) ' 将“合计[字段数]”中的总合计写入最后一行。
            .计次循环首 (11, 记数)
                _启动窗口.未知支持库函数_9 (., 13, 记数, 1, 到文本 (合计 [记数]))
            .计次循环尾 ()
            _启动窗口.未知支持库函数_9 (., 13, 0, 1, “合      计:”)
        .否则
            _启动窗口.未知支持库函数_9 (., 索引, 相减 (字段个数, 1), 1, 到文本 (读 (字段个数)))
        .如果结束
        _启动窗口.未知支持库函数_24 (., 索引, 0, 取记录数 (), 取字段数 (), #白色)
        _启动窗口.未知支持库函数_22 (., 索引, 0, 取记录数 (), 取字段数 (), #黑色)
    .计次循环尾 ()
    .如果真 (等于 (_启动窗口..标题, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “电器维修接货记录”)))
        .计次循环首 (派工或缺件总数, 记数)
            .如果真 (等于 (派工号 [记数], 到数值 (_启动窗口.未知支持库函数_10 (., 索引, 0))))
                _启动窗口.未知支持库函数_22 (., 索引, 0, 索引, 取字段数 (), #红色)
            .如果真结束
            .如果真 (等于 (缺件 [记数], 到数值 (_启动窗口.未知支持库函数_10 (., 索引, 0))))
                _启动窗口.未知支持库函数_22 (., 索引, 0, 索引, 取字段数 (), #蓝色)
            .如果真结束
            跳过 ()
        .计次循环尾 ()
    .如果真结束
    _启动窗口.置文本 (., 2, 相加 (“          正在加载数据,请稍候:  ”, 到文本 (索引)))
.计次循环尾 ()
恢复鼠标 ()
_启动窗口.置文本 (., 2, 相加 (#左引号, _启动窗口..标题, #右引号, “ 共: ”, 到文本 (相减 (索引, 2)), “条”))
关闭 ()

.子程序 读取指标到列表框, 空白型, , 读取月份或员工姓名到列表框
.参数 欲读取的标题, 文本型, , 要显示的标题
.参数 欲读取的数据库, 文本型, , 要读取的数据库

.局部变量 记录数, 整数型, , , 
.局部变量 分类数, 整数型, , , 

赋值 (_启动窗口..可视, 真)
.如果 (等于 (欲读取的标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, “员工使用配件分析图”)))
    _启动窗口.移动 (., 0, 相加 (_启动窗口..可视, _启动窗口..高度), 相减 (取屏幕宽度 (), _启动窗口..宽度, 6), 相减 (取屏幕高度 (), _启动窗口..可视, _启动窗口..高度, _启动窗口.., 45))
    赋值 (_启动窗口.., 假)
    赋值 (_启动窗口.., 真)
.否则
    赋值 (_启动窗口.., 假)
    赋值 (_启动窗口.., 真)
.如果结束
_启动窗口.全部删除 (.)
赋值 (_启动窗口..标题, 欲读取的标题)
.判断开始 (不等于 (欲读取的数据库, “\元件库.edb”)) ' 进入“员工工作表”、“员工月工资表”或“配件领还表”
    打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\职员库.edb”), , , , , “bbkkklll”, )
    .计次循环首 (取记录数 (), ) ' 将员工姓名读入员工列表框中
        赋值 (记录数, _启动窗口.插入表项 (., , 到文本 (读 (1)), , , , ))
        _启动窗口.置标题 (., 记录数, 1, 读 (2))
        跳过 ()
    .计次循环尾 ()
    关闭 ()
    赋值 (_启动窗口..标题, “员工选择”)
    赋值 (_启动窗口.., 1) ' 清空表中的数据
    赋值 (_启动窗口..标题, “”)
.判断 (等于 (欲读取的数据库, “\元件库.edb”)) ' 进入库存配件盘点表
    .判断开始 (等于 (欲读取的标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, “配件盘点统计显示”)))
        .计次循环首 (10, 分类数) ' 将配件的类型读入显示列表中
            赋值 (记录数, _启动窗口.插入表项 (., , 到文本 (分类数), , , , ))
            _启动窗口.置标题 (., 记录数, 1, 多项选择 (分类数, “电视机”, “收录机”, “洗衣机”, “影蝶机”, “电冰箱”, “空调器”, “放大器”, “小家电”, “电脑类”, “杂项类”))
            跳过 ()
        .计次循环尾 ()
        赋值 (_启动窗口..标题, “电器类型选择”)
        赋值 (_启动窗口.., 1) ' 清空表中的数据
        赋值 (_启动窗口..标题, “”)
    .判断 (等于 (欲读取的标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, “员工使用配件分析图”)))
        .计次循环首 (取月份 (取现行时间 ()), 分类数) ' 将将月份读入显示列表中
            赋值 (记录数, _启动窗口.插入表项 (., , 到文本 (分类数), , , , ))
            _启动窗口.置标题 (., 记录数, 1, 相加 (到文本 (分类数), “月份”))
            跳过 ()
        .计次循环尾 ()
        赋值 (_启动窗口..标题, “月份选择”)
        显示柱状图 (_启动窗口.取标题 (., _启动窗口.., 1))
    .默认
        
    .判断结束
    
.默认
    
.判断结束


.子程序 员工工作状态显示, 空白型, , 
.参数 被选择员工, 文本型, , 
.参数 被选择数据库, 文本型, , 

.局部变量 被选择记录数, 整数型, , , 
.局部变量 字段数, 整数型, , , 
.局部变量 索引, 整数型, , , 
.局部变量 费用及数量1, 小数型, , , 
.局部变量 费用及数量2, 小数型, , , 
.局部变量 费用及数量3, 小数型, , , 
.局部变量 费用及数量4, 整数型, , , 

打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, 被选择数据库), , , , , “bbkkklll”, )
置等待鼠标 ()
.计次循环首 (取记录数 (), 索引) ' 读取满足下列条件的记录数
    .如果真 (等于 (被选择数据库, “\历史库.edb”))
        .如果真 (等于 (读 (21), 被选择员工))
            赋值 (被选择记录数, 相加 (被选择记录数, 1))
        .如果真结束
        
    .如果真结束
    .如果真 (等于 (被选择数据库, “\工资库.edb”))
        .如果真 (等于 (读 (3), 被选择员工))
            赋值 (被选择记录数, 相加 (被选择记录数, 1))
        .如果真结束
        
    .如果真结束
    .如果真 (或者 (等于 (被选择数据库, “\领归库.edb”), 等于 (被选择数据库, “\元件库.edb”)))
        .如果真 (等于 (读 (2), 被选择员工))
            赋值 (被选择记录数, 相加 (被选择记录数, 1))
        .如果真结束
        
    .如果真结束
    跳过 ()
.计次循环尾 ()
赋值 (_启动窗口.., 相加 (被选择记录数, 1))
赋值 (_启动窗口.., 取字段数 ())
调整表格宽度 ()
赋值 (索引, 0)
.计次循环首 (取字段数 (), 字段数) ' 显示字段的标题
    _启动窗口.未知支持库函数_9 (., 索引, 相减 (字段数, 1), 1, 到文本 (取字段名 (字段数)))
.计次循环尾 ()
到首记录 ()
.计次循环首 (取记录数 (), 索引) ' 将满足下列条件的记录读入表中
    .判断开始 (等于 (被选择数据库, “\历史库.edb”))
        .如果真 (查找 (等于 (读 (21), 被选择员工)))
            .计次循环首 (取字段数 (), 字段数)
                _启动窗口.未知支持库函数_9 (., 索引, 相减 (字段数, 1), 1, 到文本 (读 (字段数)))
            .计次循环尾 ()
            赋值 (费用及数量1, 相加 (费用及数量1, 读 (23), 读 (24)))
            赋值 (费用及数量2, 相加 (费用及数量2, 读 (22)))
            赋值 (费用及数量3, 相加 (费用及数量3, 读 (25)))
        .如果真结束
        
    .判断 (等于 (被选择数据库, “\工资库.edb”))
        .如果真 (查找 (等于 (读 (3), 被选择员工)))
            .计次循环首 (取字段数 (), 字段数)
                _启动窗口.未知支持库函数_9 (., 索引, 相减 (字段数, 1), 1, 到文本 (读 (字段数)))
            .计次循环尾 ()
            赋值 (费用及数量1, 相加 (费用及数量1, 读 (4), 读 (5)))
            赋值 (费用及数量2, 相加 (费用及数量2, 读 (6), 读 (7)))
            赋值 (费用及数量3, 相加 (费用及数量3, 读 (9), 读 (10), 读 (11), 读 (12)))
        .如果真结束
        
    .判断 (或者 (等于 (被选择数据库, “\领归库.edb”), 等于 (被选择数据库, “\元件库.edb”)))
        .如果真 (查找 (等于 (读 (2), 被选择员工)))
            .计次循环首 (取字段数 (), 字段数)
                _启动窗口.未知支持库函数_9 (., 索引, 相减 (字段数, 1), 1, 到文本 (读 (字段数)))
            .计次循环尾 ()
            .如果真 (等于 (被选择数据库, “\领归库.edb”))
                赋值 (费用及数量1, 相加 (费用及数量1, 读 (7)))
                赋值 (费用及数量2, 相加 (费用及数量2, 相乘 (读 (7), 读 (8))))
                赋值 (费用及数量3, 相加 (费用及数量3, 读 (9)))
                赋值 (费用及数量4, 相加 (费用及数量4, 读 (11)))
            .如果真结束
            .如果真 (等于 (被选择数据库, “\元件库.edb”))
                赋值 (费用及数量2, 相加 (费用及数量2, 读 (8)))
            .如果真结束
            
        .如果真结束
        
    .默认
        
    .判断结束
    跳过 ()
.计次循环尾 ()
恢复鼠标 ()
_启动窗口.置文本 (., 2, 相加 (#左引号, _启动窗口..标题, #右引号, “ 共: ”, 到文本 (相减 (索引, 1)), “条”))
关闭 ()
.如果真 (等于 (被选择数据库, “\历史库.edb”))
    赋值 (_启动窗口..内容, 相加 (“￥”, 到文本 (四舍五入 (相加 (费用及数量1, 费用及数量2), 2)), “元”))
    赋值 (_启动窗口..内容, 相加 (“￥”, 到文本 (四舍五入 (费用及数量2, 2)), “元”))
    赋值 (_启动窗口..内容, 相加 (“￥”, 到文本 (四舍五入 (费用及数量3, )), “元”))
    赋值 (_启动窗口..内容, 相加 (“￥”, 到文本 (四舍五入 (相减 (费用及数量1, 费用及数量2, 费用及数量3), 2)), “元”))
.如果真结束
.如果真 (等于 (被选择数据库, “\工资库.edb”))
    赋值 (_启动窗口..内容, 相加 (“￥”, 到文本 (四舍五入 (费用及数量1, 2)), “元”))
    赋值 (_启动窗口..内容, 相加 (“￥”, 到文本 (四舍五入 (费用及数量2, 2)), “元”))
    赋值 (_启动窗口..内容, 相加 (“￥”, 到文本 (四舍五入 (费用及数量3, )), “元”))
    赋值 (_启动窗口..内容, 相加 (“￥”, 到文本 (四舍五入 (相减 (相加 (费用及数量1, 费用及数量2), 费用及数量3), 2)), “元”))
.如果真结束
.如果真 (等于 (被选择数据库, “\领归库.edb”))
    赋值 (_启动窗口..内容, 相加 (到文本 (相减 (费用及数量1, 费用及数量3, 费用及数量4)), “个”))
    赋值 (_启动窗口..内容, 相加 (“￥”, 到文本 (四舍五入 (相除 (相乘 (相减 (费用及数量1, 费用及数量3, 费用及数量4), 费用及数量2), 费用及数量1), 2)), “元(均价)”))
    赋值 (_启动窗口..内容, 相加 (到文本 (费用及数量3), “个”))
    赋值 (_启动窗口..内容, 相加 (到文本 (费用及数量4), “个”))
.如果真结束
.如果真 (等于 (被选择数据库, “\元件库.edb”))
    赋值 (_启动窗口..内容, 相加 (到文本 (被选择记录数), “种”))
    赋值 (_启动窗口..内容, 相加 (“￥”, 到文本 (四舍五入 (费用及数量2, 2)), “元”))
    赋值 (_启动窗口..内容, 登陆用户姓名)
    赋值 (_启动窗口..内容, 到文本 (取日期 (取现行时间 ())))
.如果真结束


.子程序 缺件或派工显示, 空白型, , 
.局部变量 记数, 整数型, , , 

打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\派工库.edb”), , , , , “bbkkklll”, )
重定义数组 (派工号, 假, 取记录数 ())
重定义数组 (缺件, 假, 取记录数 ())
赋值 (派工或缺件总数, 取记录数 ())
.计次循环首 (派工或缺件总数, 记数)
    .如果 (等于 (读 (6), “派工”))
        赋值 (派工号 [记数], 读 (1))
    .否则
        赋值 (缺件 [记数], 读 (1))
    .如果结束
    跳过 ()
.计次循环尾 ()
关闭 ()

.窗口程序集 管理窗口, , , 

.程序集变量 首选项, 文本型, , , 
.子程序 _管理窗口_创建完毕, 空白型, , 
.局部变量 记数, 整数型, , , 

.计次循环首 (8, 记数) ' 选择应该显示的窗口
    .如果真 (等于 (项目管理识别号, 相减 (记数, 1)))
        赋值 (.现行子夹, 相减 (记数, 1))
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
.判断开始 (等于 (.现行子夹, 0)) ' 获取企业信息
    获取焦点 ()
    赋值 (.标题, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ))
    赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业注册号”, ))
    赋值 (.今天, 到时间 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “注册日期”, )))
    赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “注册资金”, ))
    赋值 (记数, 0)
    .计次循环首 (取项目数 (), 记数)
        .如果 (等于 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业性质”, ), 相减 (记数, 1).取项目文本 ()))
            赋值 (.现行选中项, 相减 (记数, 1))
            跳出循环 ()
        .否则
            跳过 ()
        .如果结束
        
    .计次循环尾 ()
    赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “法人代表”, ))
    赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “财务主管”, ))
    赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “办公电话”, ))
    赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业地址”, ))
    赋值 (.内容, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “开户银行”, ))
    .如果 (等于 (.内容, “”))
        赋值 (., “确定”)
        赋值 (.现行选中项, 0)
    .否则
        赋值 (., “修改”)
    .如果结束
    
.判断 (等于 (.现行子夹, 1)) ' 显示账册档案管理信息
    连续赋值 (假, ., .)
    赋值 (.标题, “家电维修账册管理”)
    打开 (相加 (取当前目录 (), “\mmk.edb”), “mmk”, , , , “bbkkklll”, )
    到首记录 ()
    .计次循环首 (取记录数 (), )
        .如果真 (等于 (读 (5), 真))
            赋值 (记数, .插入表项 (读 (1), , , , ))
            记数.置标题 (1, 到文本 (读 (2)))
            .如果 (等于 (读 (4), 真))
                赋值 (首选项, “  √”)
            .否则
                赋值 (首选项, “ ”)
            .如果结束
            记数.置标题 (2, 首选项)
        .如果真结束
        跳过 ()
    .计次循环尾 ()
    关闭 ()
    .如果 (等于 (取数值注册项 (#本地机器, “SOFTWARE\bkl\账册管理权限”, ), 0))
        连续赋值 (真, .禁止, .禁止, .禁止, .禁止)
    .否则
        连续赋值 (假, .禁止, .禁止, .禁止, .禁止)
    .如果结束
    
.判断 (等于 (.现行子夹, 2)) ' 显示用户管理信息
    连续赋值 (假, ., .)
    赋值 (.标题, “家电维修操作用户管理”)
    赋值 (.标题, 登陆账册姓名)
    打开 (相加 (取当前目录 (), “\mmk.edb”), “mmk”, , , , “bbkkklll”, )
    到首记录 ()
    .计次循环首 (取记录数 (), )
        .如果真 (等于 (读 (1), 登陆账册姓名))
            赋值 (记数, .插入表项 (读 (2), , , , ))
            .如果真 (等于 (读 (2), 登陆用户姓名))
                记数.置标题 (2, “已登陆”)
            .如果真结束
            .如果 (等于 (读 (5), 真))
                赋值 (首选项, “建账人”)
            .否则
                赋值 (首选项, “普通”)
            .如果结束
            记数.置标题 (1, 首选项)
        .如果真结束
        跳过 ()
    .计次循环尾 ()
    关闭 ()
    .如果 (等于 (取数值注册项 (#本地机器, “SOFTWARE\bkl\用户管理权限”, ), 0))
        连续赋值 (真, .禁止, .禁止, .禁止)
    .否则
        连续赋值 (假, .禁止, .禁止, .禁止)
    .如果结束
    
.判断 (等于 (.现行子夹, 3)) ' 显示员工资料窗口
    连续赋值 (假, ., .)
    赋值 (.标题, “家电维修员工资料管理”)
    打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\职员库.edb”), , , , , “bbkkklll”, )
    .计次循环首 (取记录数 (), )
        赋值 (记数, .插入表项 (到文本 (读 (1)), , , , ))
        记数.置标题 (1, 读 (2))
        跳过 ()
    .计次循环尾 ()
    到尾记录 ()
    赋值 (.内容, 到文本 (相加 (读 (1), 1)))
    关闭 ()
    连续赋值 (0, .现行选中项, .现行选中项, .现行选中项)
    连续赋值 (真, .禁止, .禁止, .禁止)
    获取焦点 ()
    .如果 (等于 (取数值注册项 (#本地机器, “SOFTWARE\bkl\员工档案管理权限”, ), 0))
        连续赋值 (真, .禁止, .禁止, .禁止, .禁止)
    .否则
        连续赋值 (假, .禁止, .禁止, .禁止, .禁止)
    .如果结束
    
.判断 (等于 (.现行子夹, 4)) ' 显示权限设置窗口
    赋值 (.标题, “系统操作权限管理设置”)
    赋值 (., 真)
    赋值 (., “确定”)
    获取焦点 ()
    .如果真 (等于 (取数值注册项 (#本地机器, “SOFTWARE\bkl\账册管理权限”, ), 1))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (取数值注册项 (#本地机器, “SOFTWARE\bkl\用户管理权限”, ), 1))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (取数值注册项 (#本地机器, “SOFTWARE\bkl\员工档案管理权限”, ), 1))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (取数值注册项 (#本地机器, “SOFTWARE\bkl\初始化数据库权限”, ), 1))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (取数值注册项 (#本地机器, “SOFTWARE\bkl\资料能否导出权限”, ), 1))
        赋值 (.选中, 真)
    .如果真结束
    .如果真 (等于 (取数值注册项 (#本地机器, “SOFTWARE\bkl\系统资料查询权限”, ), 1))
        赋值 (.选中, 真)
    .如果真结束
    
.判断 (等于 (.现行子夹, 5)) ' 登陆用户密码修改窗口
    赋值 (.标题, “登陆用户账册密码修改”)
    赋值 (., “确定”)
    赋值 (.内容, 登陆用户姓名)
    赋值 (.内容, 登陆账册姓名)
    获取焦点 ()
.判断 (等于 (.现行子夹, 6)) ' 初始化窗口
    赋值 (.标题, “家电维修管理系统初始化”)
    赋值 (., “初始化”)
    获取焦点 ()
    .如果 (等于 (取数值注册项 (#本地机器, “SOFTWARE\bkl\员工档案管理权限”, ), 0))
        连续赋值 (真, .)
    .否则
        连续赋值 (假, .)
    .如果结束
    
.判断 (等于 (.现行子夹, 7)) ' 时间太紧了， 没有完成！！！
    赋值 (.标题, “资料导出”)
    赋值 (., “导出”)
    .如果 (等于 (取数值注册项 (#本地机器, “SOFTWARE\bkl\资料能否导出权限”, ), 0))
        连续赋值 (真, .)
    .否则
        连续赋值 (假, .)
    .如果结束
    
.默认
    
.判断结束


.子程序 _保存_被单击, 空白型, , 以下的管理项目.现行子夹显示号与上面的同步
.局部变量 内容, 文本型, , , 
.局部变量 记数, 整数型, , , 

.判断开始 (等于 (.现行子夹, 0))
    .如果 (等于 (., “确定”))
        输入框 (“请在下面输入企业的名称:”, “企业信息”, “这里输入你的企业名称”, 内容, )
        .如果 (等于 (.内容, “”))
            信息框 (“请输入法人代表的姓名!”, 0, )
            获取焦点 ()
            返回 ()
        .否则
            .如果 (等于 (.内容, “”))
                信息框 (“请输入财务主管的姓名!”, 0, )
                获取焦点 ()
                返回 ()
            .否则
                .如果 (等于 (.内容, “”))
                    信息框 (“请输入注册资金!”, 0, )
                    获取焦点 ()
                    返回 ()
                .否则
                    .如果 (等于 (.内容, “”))
                        信息框 (“请输入企业地址!”, 0, )
                        获取焦点 ()
                        返回 ()
                    .否则
                        写配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, 内容)
                        写配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业注册号”, .内容)
                        写配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “法人代表”, .内容)
                        写配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “财务主管”, .内容)
                        写配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “注册日期”, 到文本 (.今天))
                        写配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “注册资金”, .内容)
                        写配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业性质”, .取项目文本 (.现行选中项))
                        写配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “办公电话”, .内容)
                        写配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业地址”, .内容)
                        写配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “开户银行”, .内容)
                        赋值 (., “修改”)
                        信息框 (“企业基本信息添加成功!”, 0, )
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
        
    .否则
        赋值 (., “修改”)
        .如果 (并且 (等于 (.内容, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “法人代表”, )), 等于 (.内容, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “财务主管”, )), 等于 (.内容, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “注册资金”, )), 等于 (.取项目文本 (.现行选中项), 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业性质”, )), 等于 (.内容, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “办公电话”, )), 等于 (.内容, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业地址”, )), 等于 (.内容, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “开户银行”, ))))
            信息框 (“没有可修改的信息!”, 0, )
        .否则
            输入框 (“修改企业的名称:”, “企业名称修改信息”, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), 内容, )
            写配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, 内容)
            写配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “法人代表”, .内容)
            写配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “财务主管”, .内容)
            写配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “注册日期”, 到文本 (.今天))
            写配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “注册资金”, .内容)
            写配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业性质”, .取项目文本 (.现行选中项))
            写配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “办公电话”, .内容)
            写配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业地址”, .内容)
            写配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “开户银行”, .内容)
            _管理窗口_创建完毕 ()
            信息框 (“企业基本信息修改成功!”, 0, )
        .如果结束
        
    .如果结束
    
.判断 (等于 (.现行子夹, 8)) ' 创建新的账册
    赋值 (.现行子夹, 9)
    获取焦点 ()
    赋值 (., “下一步”)
    赋值 (., “上一步”)
    赋值 (.标题, “第一步：账册命名”)
.判断 (等于 (.现行子夹, 9)) ' 创建新的账册
    .如果 (等于 (.内容, “”))
        信息框 (“请输入你要新建的账册名!”, 0, )
        获取焦点 ()
        返回 ()
    .否则
        赋值 (.现行子夹, 10)
        获取焦点 ()
        赋值 (., “下一步.”)
        赋值 (., “上一步.”)
        赋值 (.标题, “第二步：用户密码”)
    .如果结束
    
.判断 (等于 (.现行子夹, 10)) ' 创建新的账册
    .如果 (等于 (.内容, “”))
        信息框 (“请输入建账者姓名!”, 0, )
        获取焦点 ()
        返回 ()
    .否则
        .如果 (不等于 (.内容, .内容))
            信息框 (“输入密码和确认密码不一致!”, 0, )
            赋值 (.内容, “”)
            获取焦点 ()
            返回 ()
        .否则
            赋值 (.标题, .内容)
            赋值 (.标题, .内容)
            .如果 (等于 (.选中, 真))
                赋值 (.标题, “首选打开帐册”)
            .否则
                赋值 (.标题, “非首选打开帐册”)
            .如果结束
            赋值 (.现行子夹, 11)
            赋值 (., “下一步..”)
            赋值 (., “上一步..”)
            赋值 (.标题, “第三步：检查确认”)
        .如果结束
        
    .如果结束
    
.判断 (等于 (.现行子夹, 11)) ' 创建新的账册
    .如果 (查找 (等于 (读 (1), .内容)))
        信息框 (“已经有此帐册,请重新命名!”, 0, )
        返回 ()
    .否则
        打开 (相加 (取当前目录 (), “\mmk.edb”), “mmk”, , , , “bbkkklll”, )
        到首记录 ()
        .如果真 (等于 (.选中, 真))
            到首记录 ()
            .如果真 (查找 (等于 (读 (4), 真)))
                修改 (假, , , , )
            .如果真结束
            
        .如果真结束
        加记录 (.内容, .内容, 未知支持库函数_3 (到字节集 (.内容), “bbkkklll”, 2), .选中, 真, 假)
        .如果真 (等于 (寻找文件 (相加 (取当前目录 (), “\”, .内容), ), “”))
            创建目录 (相加 (取当前目录 (), “\”, .内容))
        .如果真结束
        全部删除 ()
        关闭 ()
    .如果结束
    赋值 (.现行子夹, 12)
    赋值 (., 假)
    赋值 (., “完成”)
    赋值 (.标题, “恭喜：新账册建立成功!”)
.判断 (等于 (.现行子夹, 13)) ' 添加新的用户名
    .如果 (等于 (.内容, “”))
        信息框 (“请输入你要新添加的用户姓名!”, 0, )
        获取焦点 ()
        返回 ()
    .否则
        .如果 (不等于 (.内容, .内容))
            信息框 (“确认密码不正确,请重新输入!!”, 0, )
            获取焦点 ()
            返回 ()
        .否则
            打开 (相加 (取当前目录 (), “\mmk.edb”), “mmk”, , , , “bbkkklll”, )
            到首记录 ()
            .如果 (并且 (查找 (等于 (读 (1), 登陆账册姓名)), 等于 (读 (2), .内容)))
                信息框 (“系统发现已经有了这个用户,不能重名！”, 0, )
                赋值 (.内容, “”)
                获取焦点 ()
                返回 ()
            .否则
                加记录 (登陆账册姓名, .内容, 未知支持库函数_3 (到字节集 (.内容), “bbkkklll”, 2), 假, 假, 假)
                全部删除 ()
                _管理窗口_创建完毕 ()
            .如果结束
            关闭 ()
        .如果结束
        
    .如果结束
    
.判断 (等于 (.现行子夹, 4)) ' 将权限写入注册表
    .如果 (等于 (.选中, 真))
        写注册项 (#本地机器, “SOFTWARE\bkl\账册管理权限”, 1)
    .否则
        写注册项 (#本地机器, “SOFTWARE\bkl\账册管理权限”, 0)
    .如果结束
    .如果 (等于 (.选中, 真))
        写注册项 (#本地机器, “SOFTWARE\bkl\用户管理权限”, 1)
    .否则
        写注册项 (#本地机器, “SOFTWARE\bkl\用户管理权限”, 0)
    .如果结束
    .如果 (等于 (.选中, 真))
        写注册项 (#本地机器, “SOFTWARE\bkl\初始化数据库权限”, 1)
    .否则
        写注册项 (#本地机器, “SOFTWARE\bkl\初始化数据库权限”, 0)
    .如果结束
    .如果 (等于 (.选中, 真))
        写注册项 (#本地机器, “SOFTWARE\bkl\资料能否导出权限”, 1)
    .否则
        写注册项 (#本地机器, “SOFTWARE\bkl\资料能否导出权限”, 0)
    .如果结束
    .如果 (等于 (.选中, 真))
        写注册项 (#本地机器, “SOFTWARE\bkl\系统资料查询权限”, 1)
    .否则
        写注册项 (#本地机器, “SOFTWARE\bkl\系统资料查询权限”, 0)
    .如果结束
    .如果 (等于 (.选中, 真))
        写注册项 (#本地机器, “SOFTWARE\bkl\员工档案管理权限”, 1)
    .否则
        写注册项 (#本地机器, “SOFTWARE\bkl\员工档案管理权限”, 0)
    .如果结束
    信息框 (“权限修改成功!”, 0, )
    销毁 ()
.判断 (等于 (.现行子夹, 5))
    .如果 (等于 (.内容, “”))
        信息框 (“请输入老密码!”, 0, )
        获取焦点 ()
        返回 ()
    .否则
        .如果 (不等于 (.内容, .内容))
            信息框 (“确认新密码错误,请重新输入!”, 0, )
            赋值 (.内容, “”)
            获取焦点 ()
            返回 ()
        .否则
            打开 (相加 (取当前目录 (), “\mmk.edb”), “mmk”, , , , “bbkkklll”, )
            到首记录 ()
            .如果 (并且 (查找 (等于 (读 (1), .内容)), 等于 (读 (2), .内容)))
                .如果 (等于 (到文本 (未知支持库函数_4 (读 (3), “bbkkklll”, 2)), .内容))
                    修改 (未知支持库函数_3 (到字节集 (.内容), “bbkkklll”, 2), , , )
                    信息框 (“密码修改成功!”, 0, )
                .否则
                    信息框 (“密码输入错误，你没有修改密码的权限!”, 0, )
                    返回 ()
                .如果结束
                
            .否则
                
            .如果结束
            关闭 ()
            销毁 ()
        .如果结束
        
    .如果结束
    
.判断 (等于 (.现行子夹, 6)) ' 初始化
    .如果 (并且 (等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假), 等于 (.选中, 假)))
        信息框 (“没有需要初始化的数据库!”, #信息图标, “提醒!”)
        返回 ()
    .否则
        打开 (相加 (取当前目录 (), “\mmk.edb”), “mmk”, , , , “bbkkklll”, )
        到首记录 ()
        .如果 (并且 (查找 (等于 (读 (1), 登陆账册姓名)), 查找 (等于 (读 (2), 登陆用户姓名))))
            .判断开始 (等于 (.选中, 真))
                打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\接货库.edb”), , , , , , )
                删除 (真)
                彻底删除 ()
                关闭 ()
                打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\派工库.edb”), , , , , “bbkkklll”, )
                删除 (真)
                彻底删除 ()
                关闭 ()
            .判断 (等于 (.选中, 真))
                打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\历史库.edb”), , , , , , )
                删除 (真)
                彻底删除 ()
                关闭 ()
            .判断 (等于 (.选中, 真))
                打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\元件库.edb”), , , , , , )
                删除 (真)
                彻底删除 ()
                关闭 ()
            .判断 (等于 (.选中, 真))
                打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\领归库.edb”), , , , , , )
                删除 (真)
                彻底删除 ()
                关闭 ()
            .判断 (等于 (.选中, 真))
                打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\职员库.edb”), , , , , “bbkkklll”, )
                删除 (真)
                彻底删除 ()
                关闭 ()
            .判断 (等于 (.选中, 真))
                打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\统计库.edb”), , , , , “bbkkklll”, )
                删除 (真)
                彻底删除 ()
                .计次循环首 (13, 记数)
                    .如果 (小于或等于 (记数, 12))
                        加记录 (相加 (到文本 (取年份 (取现行时间 ())), “年”, 到文本 (记数), “月”))
                    .否则
                        加记录 (“合    计:”)
                    .如果结束
                    
                .计次循环尾 ()
                关闭 ()
            .判断 (等于 (.选中, 真))
                打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\出货库.edb”), , , , , , )
                删除 (真)
                彻底删除 ()
                关闭 ()
            .判断 (等于 (.选中, 真))
                打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\工资库.edb”), , , , , “bbkkklll”, )
                删除 (真)
                彻底删除 ()
                关闭 ()
            .默认
                
            .判断结束
            赋值 (_启动窗口..标题, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “电器维修接货记录”))
            赋值 (项目管理识别号, 1)
            连续赋值 (假, _启动窗口..可视, _启动窗口..)
            打开表格显示 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\接货库.edb”))
            信息框 (“初始化数据已成功完成!”, 0, )
            销毁 ()
        .否则
            关闭 ()
            信息框 (“你没有初始化系统数据和权限!”, 0, )
            销毁 ()
        .如果结束
        
    .如果结束
    
.判断 (等于 (.现行子夹, 7))
    赋值 (., 真)
.默认
    
.判断结束


.子程序 _新建账册_被单击, 空白型, , 
赋值 (.现行子夹, 8)
赋值 (., “开始”)
赋值 (., “退出”)
连续赋值 (真, ., .)
赋值 (.文本颜色, #黑色)
赋值 (.标题, “欢迎您新建账册”)


.子程序 _退出_被单击, 空白型, , 
.判断开始 (或者 (等于 (.现行子夹, 4), 等于 (.现行子夹, 5), 等于 (.现行子夹, 6), 等于 (.现行子夹, 7)))
    销毁 ()
.判断 (或者 (等于 (.现行子夹, 0), 等于 (.现行子夹, 8)))
    销毁 ()
.判断 (等于 (.现行子夹, 9))
    _新建账册_被单击 ()
.判断 (等于 (.现行子夹, 10))
    赋值 (.现行子夹, 9)
    获取焦点 ()
    赋值 (.标题, “第一步：账册命名”)
.判断 (等于 (.现行子夹, 11))
    赋值 (.现行子夹, 10)
    获取焦点 ()
    赋值 (.标题, “第二步：用户密码”)
.判断 (等于 (.现行子夹, 12))
    赋值 (.现行子夹, 1)
    _管理窗口_创建完毕 ()
.默认
    
.判断结束




.子程序 _删除账册_被单击, 空白型, , 
删除账册或用户 (.取标题 (., 0), .取标题 (., 1))

.子程序 _重命名账册_被单击, 空白型, , 
重命名账册或用户 (.取标题 (., 0), .取标题 (., 1))

.子程序 _设为首选_被单击, 空白型, , 
.如果真 (等于 (., -1))
    信息框 (“请选择需要设为首选的账册!”, 0, )
    返回 ()
.如果真结束
打开 (相加 (取当前目录 (), “\mmk.edb”), “mmk”, , , , “bbkkklll”, )
到首记录 ()
.如果真 (查找 (等于 (读 (4), 真)))
    修改 (假, , , , )
.如果真结束
到首记录 ()
.如果真 (并且 (查找 (等于 (读 (1), .取标题 (., ))), 查找 (等于 (读 (2), .取标题 (., 1)))))
    修改 (真, , , , )
.如果真结束
关闭 ()
赋值 (.现行子夹, 1)
全部删除 ()
_管理窗口_创建完毕 ()

.子程序 _退出账册_被单击, 空白型, , 
销毁 ()

.子程序 _增加用户_被单击, 空白型, , 
赋值 (.现行子夹, 13)
连续赋值 (真, ., .)
赋值 (.标题, 登陆账册姓名)
获取焦点 ()
赋值 (., “保存”)
赋值 (.标题, “添加新的操作用户”)

.子程序 _删除用户_被单击, 空白型, , 
删除账册或用户 (登陆账册姓名, .取标题 (., 0))

.子程序 _重命名用户_被单击, 空白型, , 
重命名账册或用户 (.标题, .取标题 (., 0))

.子程序 _退出2_被单击, 空白型, , 
销毁 ()

.子程序 _清空员工_被单击, 空白型, , 
打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\职员库.edb”), , , , , “bbkkklll”, )
到尾记录 ()
赋值 (.内容, 到文本 (相加 (读 (1), 1)))
关闭 ()
连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
连续赋值 (0, .现行选中项, .现行选中项, .现行选中项)
连续赋值 (真, .禁止, .禁止, .禁止)
赋值 (.禁止, 假)
获取焦点 ()

.子程序 _添加员工_被单击, 空白型, , 
.如果 (等于 (.内容, “”))
    信息框 (“请输入新加员工姓名!”, 0, )
    获取焦点 ()
    返回 ()
.否则
    .如果 (等于 (.内容, “”))
        信息框 (“请输入新加员工的电话!”, 0, )
        获取焦点 ()
        返回 ()
    .否则
        .如果 (等于 (.内容, “”))
            信息框 (“请输入新加员工身份证号码!”, 0, )
            获取焦点 ()
            返回 ()
        .否则
            .如果 (等于 (.内容, “”))
                信息框 (“请输入新加员工住址!”, 0, )
                获取焦点 ()
                返回 ()
            .否则
                .如果 (并且 (等于 (.内容, “”), 等于 (.内容, “”), 等于 (.内容, “”)))
                    信息框 (“请输入新加员工的工资标准!”, 0, )
                    获取焦点 ()
                    返回 ()
                .否则
                    打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\职员库.edb”), , , , , “bbkkklll”, )
                    到首记录 ()
                    .如果 (等于 (取记录数 (), 0))
                        加记录 (到数值 (.内容), .内容, .取项目文本 (.现行选中项), .内容, .今天, .内容, .内容, .取项目文本 (.现行选中项), .内容, .取项目文本 (.现行选中项), .内容, .内容, 到数值 (.内容), 到数值 (.内容), 到数值 (.内容))
                        
                    .否则
                        .如果 (查找 (不等于 (读 (2), .内容)))
                            加记录 (到数值 (.内容), .内容, .取项目文本 (.现行选中项), .内容, .今天, .内容, .内容, .取项目文本 (.现行选中项), .内容, .取项目文本 (.现行选中项), .内容, .内容, 到数值 (.内容), 到数值 (.内容), 到数值 (.内容)) ' 查找库中是否有相同姓名
                        .否则
                            信息框 (“对不起，已经有相同的姓名被输入,你不能再用这个名字，请改名后再输入!”, 0, )
                            关闭 ()
                            返回 ()
                        .如果结束
                        
                    .如果结束
                    赋值 (.内容, 到文本 (相加 (读 (1), 1)))
                    关闭 ()
                    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
                    连续赋值 (0, .现行选中项, .现行选中项, .现行选中项)
                    全部删除 ()
                    _管理窗口_创建完毕 ()
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束


.子程序 _修改员工_被单击, 空白型, , 
打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\职员库.edb”), , , , , “bbkkklll”, )
到首记录 ()
.如果 (或者 (等于 (查找 (等于 (读 (2), .内容)), 假), 等于 (查找 (等于 (读 (3), .取项目文本 (.现行选中项))), 假), 等于 (查找 (等于 (读 (4), .内容)), 假), 等于 (查找 (等于 (读 (5), .今天)), 假), 等于 (查找 (等于 (读 (6), .内容)), 假), 等于 (查找 (等于 (读 (7), .内容)), 假), 等于 (查找 (等于 (读 (8), .取项目文本 (.现行选中项))), 假), 等于 (查找 (等于 (读 (9), .内容)), 假), 等于 (查找 (等于 (读 (10), .取项目文本 (.现行选中项))), 假), 等于 (查找 (等于 (读 (11), .内容)), 假), 等于 (查找 (等于 (读 (12), .内容)), 假), 等于 (查找 (等于 (读 (13), 到数值 (.内容))), 假), 等于 (查找 (等于 (读 (14), 到数值 (.内容))), 假), 等于 (查找 (等于 (读 (15), 到数值 (.内容))), 假)))
    修改 (.内容, .取项目文本 (.现行选中项), .内容, .今天, .内容, .内容, .取项目文本 (.现行选中项), .内容, .取项目文本 (.现行选中项), .内容, .内容, 到数值 (.内容), 到数值 (.内容), 到数值 (.内容))
    关闭 ()
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
    连续赋值 (0, .现行选中项, .现行选中项, .现行选中项)
    全部删除 ()
    _管理窗口_创建完毕 ()
.否则
    信息框 (“没有可供修改的项目!”, 0, )
    关闭 ()
.如果结束


.子程序 _删除员工_被单击, 空白型, , 
打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\职员库.edb”), , , , , “bbkkklll”, )
到首记录 ()
.如果真 (并且 (查找 (等于 (读 (1), 到数值 (.内容))), 查找 (等于 (读 (2), .内容)), 查找 (等于 (读 (3), .取项目文本 (.现行选中项))), 查找 (等于 (读 (4), .内容)), 查找 (等于 (读 (5), .今天)), 查找 (等于 (读 (6), .内容)), 查找 (等于 (读 (7), .内容)), 查找 (等于 (读 (8), .取项目文本 (.现行选中项))), 查找 (等于 (读 (9), .内容)), 查找 (等于 (读 (10), .取项目文本 (.现行选中项))), 查找 (等于 (读 (11), .内容)), 查找 (等于 (读 (12), .内容)), 查找 (等于 (读 (13), 到数值 (.内容))), 查找 (等于 (读 (14), 到数值 (.内容))), 查找 (等于 (读 (15), 到数值 (.内容)))))
    .如果 (等于 (信息框 (“你确认一定要删除这个员工的资料吗?”, 相加 (#询问图标, #是否钮), “删除信息”), #是钮))
        删除 ()
        彻底删除 ()
        连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
        连续赋值 (0, .现行选中项, .现行选中项, .现行选中项)
        全部删除 ()
        _管理窗口_创建完毕 ()
    .否则
        
    .如果结束
    
.如果真结束


.子程序 _退出员工_被单击, 空白型, , 
销毁 ()

.子程序 _员工列表_表项被激活, 空白型, , 将所选员工激活，以便能够进行修改和删除等操作
.局部变量 项目, 整数型, , , 

打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\职员库.edb”), , , , , “bbkkklll”, )
.如果真 (查找 (等于 (读 (2), .取标题 (., 1))))
    赋值 (.内容, 到文本 (读 (1)))
    赋值 (.内容, 读 (2))
    .如果 (等于 (读 (3), “男”))
        赋值 (.现行选中项, 0)
    .否则
        赋值 (.现行选中项, 1)
    .如果结束
    赋值 (.内容, 读 (4))
    赋值 (.今天, 读 (5))
    赋值 (.内容, 读 (6))
    赋值 (.内容, 读 (7))
    .计次循环首 (取项目数 (), 项目)
        .如果真 (等于 (读 (8), 多项选择 (项目, “博士生”, “硕士生”, “研究生”, “本科生”, “专科生”, “中专生”, “职高生”, “普高生”, “初中生”)))
            赋值 (.现行选中项, 相减 (项目, 1))
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
    赋值 (项目, 0)
    赋值 (.内容, 读 (9))
    .计次循环首 (取项目数 (), 项目)
        .如果真 (等于 (读 (10), 多项选择 (项目, “管理员”, “微电子技师”, “高级维修师”, “中级维修师”, “初级维修师”, “合同工”, “试用工”, “学徒”)))
            赋值 (.现行选中项, 相减 (项目, 1))
            跳出循环 ()
        .如果真结束
        
    .计次循环尾 ()
    赋值 (.内容, 读 (11))
    赋值 (.内容, 读 (12))
    赋值 (.内容, 到文本 (读 (13)))
    赋值 (.内容, 到文本 (读 (14)))
    赋值 (.内容, 到文本 (读 (15)))
    连续赋值 (假, .禁止, .禁止, .禁止)
    赋值 (.禁止, 真)
.如果真结束
关闭 ()

.子程序 _初始_被单击, 空白型, , 
.如果 (等于 (.标题, “全选”))
    连续赋值 (真, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中)
    赋值 (.标题, “全不选”)
.否则
    .如果 (等于 (.标题, “全不选”))
        连续赋值 (假, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中, .选中)
        赋值 (.标题, “全选”)
    .否则
        
    .如果结束
    
.如果结束


.子程序 _账册建账者密码_内容被改变, 空白型, , 
打开 (相加 (取当前目录 (), “\mmk.edb”), “mmk”, , , , “bbkkklll”, )
到首记录 ()
.如果 (并且 (查找 (等于 (读 (1), 登陆账册姓名)), 查找 (等于 (读 (2), 登陆用户姓名)), 等于 (未知支持库函数_4 (读 (3), “bbkkklll”, 2), 到字节集 (.内容))))
    信息框 (“密码正确,你可以修改系统操作权限!”, 0, )
    赋值 (., 假)
.否则
    
.如果结束
关闭 ()


.子程序 _账册建账者密码_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.未知支持库函数_20 (“输入正确的密码后,下面的确定按钮就可用了!”, #信息图标, , , , )

.子程序 _帐册框_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.未知支持库函数_20 (“单击所选账册，即可进行右边的各项操作!”, #信息图标, , , , )

.子程序 _登陆用户_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.未知支持库函数_20 (“单击所选账册，即可进行右边的各项操作!”, #信息图标, , , , )

.子程序 _员工列表_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.未知支持库函数_20 (“双击所选员工的姓名,即可在右边进行修改、删除等操作!”, #信息图标, , , , )

.程序集 第三子程序, , , 

.子程序 删除账册或用户, 空白型, , 
.参数 欲删除的账册名, 文本型, , 
.参数 欲删除的建账者或用户名, 文本型, , 

.局部变量 需要比较的密码, 文本型, , , 

.判断开始 (等于 (管理窗口..现行子夹, 1)) ' 确认是否打开账册管理窗口
    .如果 (等于 (管理窗口.., -1))
        信息框 (“请选择左边需要删除的账册名!”, 0, )
        返回 ()
    .否则
        .如果真 (等于 (管理窗口.., 0))
            信息框 (“此账册是系统内建,不能删除!”, 0, )
            返回 ()
        .如果真结束
        
    .如果结束
    
.判断 (等于 (管理窗口..现行子夹, 2)) ' 确认是否打开用户管理窗口
    .如果真 (等于 (管理窗口.., -1))
        信息框 (“请选择需要删除的用户名字!”, 0, )
        返回 ()
    .如果真结束
    .如果真 (等于 (管理窗口.., 0))
        信息框 (“此用户名字是系统内建,不能删除!”, 0, )
        返回 ()
    .如果真结束
    
.默认
    
.判断结束
输入框 (“你确定要删除这项吗?请在执行这项操作前备份好你的资料。然后再请输入用户密码：”, “密码输入框”, “********”, 需要比较的密码, 4)
打开 (“mmk.edb”, “mmk”, , , , “bbkkklll”, )
到首记录 ()
.如果真 (并且 (查找 (等于 (读 (1), 欲删除的账册名)), 查找 (等于 (读 (2), 欲删除的建账者或用户名))))
    .如果 (等于 (需要比较的密码, 到文本 (未知支持库函数_4 (读 (3), “bbkkklll”, 2))))
        删除 ()
        彻底删除 ()
        .如果真 (等于 (管理窗口..现行子夹, 1)) ' 表中刷新显示
            赋值 (项目管理识别号, 1)
            管理窗口.全部删除 (.)
            管理窗口.全部删除 (.)
            删除目录 (相加 (取当前目录 (), “\”, 欲删除的账册名))
        .如果真结束
        .如果真 (等于 (管理窗口..现行子夹, 2)) ' 表中刷新显示
            赋值 (项目管理识别号, 2)
            管理窗口.全部删除 (.)
        .如果真结束
        _管理窗口_创建完毕 ()
    .否则
        信息框 (“密码输入错误，你没有删除的权限!”, 0, )
    .如果结束
    
.如果真结束
关闭 ()


.子程序 重命名账册或用户, 空白型, , 
.参数 欲重新命名的账册, 文本型, , 
.参数 欲重新命名的账册的用户名, 文本型, , 

.局部变量 新的账册名字, 文本型, , , 
.局部变量 需要比较的密码, 文本型, , , 

.判断开始 (等于 (管理窗口..现行子夹, 1)) ' 确认是否打开账册管理窗口
    .如果 (等于 (管理窗口.., -1))
        信息框 (“请选择左边需要重新命名的账册!”, 0, )
        返回 ()
    .否则
        输入框 (“请为这个账册输入一个新的名称！”, “重新命名：”, 欲重新命名的账册, 新的账册名字, )
    .如果结束
    
.判断 (等于 (管理窗口..现行子夹, 2)) ' 确认是否打开用户管理窗口
    .如果 (等于 (管理窗口.., -1))
        信息框 (“请选择左边需要重新命名的用户!”, 0, )
        返回 ()
    .否则
        输入框 (“请输入新的名字！”, “重新取一个新的名字：”, 欲重新命名的账册的用户名, 新的账册名字, )
    .如果结束
    
.默认
    
.判断结束
.如果 (等于 (新的账册名字, 欲重新命名的账册)) ' 确认新的名字被改变了否？
    信息框 (“你还没有取新的名字!”, 0, )
    返回 ()
.否则
    输入框 (“    必须是这个账册的建账者才能修改账册名。为了保证该账册用户的权限,系统需要验证你的密码。请在下面输入建账者的密码:”, “密码输入框”, “********”, 需要比较的密码, 4)
    打开 (“mmk.edb”, “mmk”, , , , “bbkkklll”, )
    到首记录 ()
    .如果真 (并且 (查找 (等于 (读 (1), 欲重新命名的账册)), 查找 (等于 (读 (2), 欲重新命名的账册的用户名)))) ' 寻找满足条件的账册名或用户名
        .如果 (等于 (需要比较的密码, 到文本 (未知支持库函数_4 (读 (3), “bbkkklll”, 2))))
            .如果真 (等于 (管理窗口..现行子夹, 1)) ' 更新账册名
                修改 (新的账册名字, , , , )
                赋值 (项目管理识别号, 1)
                管理窗口.全部删除 (.)
            .如果真结束
            .如果真 (等于 (管理窗口..现行子夹, 2)) ' 更新用户名
                修改 (新的账册名字, , , )
                赋值 (项目管理识别号, 2)
                管理窗口.全部删除 (.)
            .如果真结束
            _管理窗口_创建完毕 ()
        .否则
            信息框 (“密码输入错误，这个权限!”, 0, )
        .如果结束
        
    .如果真结束
    关闭 ()
.如果结束


.子程序 打印预览, 空白型, , 
.局部变量 打印设置信息, 打印设置信息, , , 
.局部变量 已设置打印信息, 逻辑型, , , 

.如果真 (或者 (等于 (_启动窗口..标题, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “电器维修接货记录”)), 等于 (_启动窗口..标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “家电维修历史档案”)), 等于 (_启动窗口..标题, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “库存元件显示”)), 等于 (_启动窗口..标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “维修、销售配件记录”)), 等于 (_启动窗口..标题, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “收支综合统计表”))))
    _启动窗口.未知支持库函数_27 (.)
    
.如果真结束


.子程序 开始打印, 空白型, , 
.如果真 (或者 (等于 (_启动窗口..标题, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “电器维修接货记录”)), 等于 (_启动窗口..标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “家电维修历史档案”)), 等于 (_启动窗口..标题, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “库存元件显示”)), 等于 (_启动窗口..标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “维修、销售配件记录”)), 等于 (_启动窗口..标题, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “收支综合统计表”))))
    _启动窗口.未知支持库函数_26 (.)
.如果真结束


.程序集 第四子程序, , , 

.程序集变量 配件回收, 小数型, , "0", 
.程序集变量 总收入, 小数型, , , 
.程序集变量 使用配件总数, 小数型, , , 
.子程序 显示柱状图, 空白型, , 
.参数 被选择维修员, 文本型, , 

.局部变量 月份, 整数型, , , 
.局部变量 营业收入, 整数型, , , 
.局部变量 收入合计, 小数型, , "0", 

赋值 (_启动窗口.., “配件类别”)
赋值 (_启动窗口.., 1)
赋值 (_启动窗口.., 10)
赋值 (_启动窗口.., 0)
重定义数组 (配件回收, 假, 10)
打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\出货库.edb”), , , , , “bbkkklll”, )
到首记录 ()
.计次循环首 (取记录数 (), )
    .判断开始 (等于 (被选择维修员, “”))
        填充数据 ()
    .判断 (小于或等于 (取月份 (取现行时间 ()), 9))
        .如果真 (等于 (相加 (取文本中间 (到文本 (读 (10)), 7, 3), “份”), 被选择维修员))
            填充数据 ()
        .如果真结束
        
    .判断 (大于或等于 (取月份 (取现行时间 ()), 10))
        .如果真 (等于 (相加 (取文本中间 (到文本 (读 (10)), 7, 4), “份”), 被选择维修员))
            填充数据 ()
        .如果真结束
        
    .默认
        
    .判断结束
    跳过 ()
.计次循环尾 ()
关闭 ()
赋值 (总收入, 0)
.计次循环首 (取数组成员数 (配件回收), 月份)
    赋值 (_启动窗口.., 相减 (月份, 1))
    赋值 (_启动窗口.., 多项选择 (月份, “电视机”, “收录机”, “洗衣机”, “影蝶机”, “电冰箱”, “空调器”, “放大器”, “小家电”, “电脑类”, “杂项类”))
    赋值 (_启动窗口.., 配件回收 [月份])
    赋值 (总收入, 相加 (总收入, 配件回收 [月份])) ' 这里还没有调试好,取最大值不行
.计次循环尾 ()
赋值 (_启动窗口..内容, 相加 (到文本 (总收入), “元”))
赋值 (_启动窗口..内容, 到文本 (使用配件总数))
赋值 (_启动窗口..内容, 登陆用户姓名)
赋值 (_启动窗口..内容, 到文本 (取日期 (取现行时间 ())))
.如果真 (并且 (大于 (总收入, 10000), 小于或等于 (总收入, 50000)))
    赋值 (_启动窗口.., 50000)
.如果真结束
.如果真 (并且 (大于 (总收入, 5000), 小于或等于 (总收入, 10000)))
    赋值 (_启动窗口.., 10000)
.如果真结束
.如果真 (并且 (大于 (总收入, 1000), 小于或等于 (总收入, 5000)))
    赋值 (_启动窗口.., 5000)
.如果真结束
.如果真 (并且 (大于 (总收入, 500), 小于或等于 (总收入, 1000)))
    赋值 (_启动窗口.., 1000)
.如果真结束
.如果真 (并且 (大于 (总收入, 100), 小于或等于 (总收入, 500)))
    赋值 (_启动窗口.., 500)
.如果真结束
.如果真 (小于或等于 (总收入, 100))
    赋值 (_启动窗口.., 100)
.如果真结束


.子程序 填充数据, 空白型, , 
.局部变量 记录号, 整数型, , , 

.计次循环首 (取记录数 (), )
    .计次循环首 (10, 记录号)
        .如果真 (等于 (读 (2), 多项选择 (记录号, “电视机”, “收录机”, “洗衣机”, “影蝶机”, “电冰箱”, “空调器”, “放大器”, “小家电”, “电脑类”, “杂项类”)))
             ' 赋值 (配件回收 [记录号], 相加 (配件回收 [记录号], 读 (7)))
         ' .如果真结束
        
    .计次循环尾 ()
    跳过 ()
.计次循环尾 ()

.子程序 维修综合分析图, 空白型, , 
.参数 被选择标题, 文本型, , 
.参数 被选择数据库, 文本型, , 

.局部变量 统计项目值, 小数型, , "0", 
.局部变量 字段数, 整数型, , , 
.局部变量 收入最大值, 小数型, , , 
.局部变量 营业收入, 双精度小数型, , , 
.局部变量 元件费, 双精度小数型, , , 
.局部变量 其它支出, 双精度小数型, , , 
.局部变量 实发工资, 双精度小数型, , , 
.局部变量 利润额, 双精度小数型, , , 

连续赋值 (假, _启动窗口..可视, _启动窗口..)
_启动窗口.移动 (., 0, 相加 (_启动窗口..可视, _启动窗口..高度), 相减 (取屏幕宽度 (), 5), 相减 (取屏幕高度 (), _启动窗口..可视, _启动窗口..高度, _启动窗口.., 45))
赋值 (_启动窗口.., 真)
赋值 (_启动窗口..标题, 被选择标题)
打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, 被选择数据库), , , , , “bbkkklll”, )
.判断开始 (等于 (被选择标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, “企业电器维修综合分析图”)))
    赋值 (_启动窗口.., 11)
    赋值 (_启动窗口.., 1)
    重定义数组 (统计项目值, 假, 取字段数 ())
    .计次循环首 (取字段数 (), 字段数)
        .如果真 (不等于 (字段数, 1))
            到首记录 ()
            .计次循环首 (取记录数 (), )
                赋值 (统计项目值 [相减 (字段数, 1)], 相加 (统计项目值 [相减 (字段数, 1)], 读 (字段数)))
                .如果真 (等于 (字段数, 5))
                    赋值 (收入最大值, 相加 (收入最大值, 读 (5)))
                .如果真结束
                跳过 ()
            .计次循环尾 ()
            赋值 (_启动窗口.., 相减 (字段数, 2))
            赋值 (_启动窗口.., 多项选择 (字段数, “”, “维修收入”, “附加费”, “零售收入”, “收入合计”, “元件费”, “返工费”, “水电费”, “税收费”, “杂项费”, “支出合计”, “净利润”))
            赋值 (_启动窗口.., 多项选择 (字段数, #青绿, #蓝色, #红色, #绿色, #浅灰, #青蓝, #桃红, #黄色, #艳青, #品红, #深青, #深灰))
            赋值 (_启动窗口.., 统计项目值 [相减 (字段数, 1)])
        .如果真结束
        
    .计次循环尾 ()
    赋值 (_启动窗口.., “收支项目”)
    赋值 (_启动窗口.., “综合分析示意柱状图”)
    关闭 ()
    .如果真 (并且 (大于 (收入最大值, 10000), 小于或等于 (收入最大值, 50000)))
        赋值 (_启动窗口.., 50000)
    .如果真结束
    .如果真 (并且 (大于 (收入最大值, 5000), 小于或等于 (收入最大值, 10000)))
        赋值 (_启动窗口.., 10000)
    .如果真结束
    .如果真 (并且 (大于 (收入最大值, 1000), 小于或等于 (收入最大值, 5000)))
        赋值 (_启动窗口.., 5000)
    .如果真结束
    .如果真 (并且 (大于 (收入最大值, 500), 小于或等于 (收入最大值, 1000)))
        赋值 (_启动窗口.., 1000)
    .如果真结束
    .如果真 (并且 (大于 (收入最大值, 100), 小于或等于 (收入最大值, 500)))
        赋值 (_启动窗口.., 500)
    .如果真结束
    .如果真 (小于或等于 (收入最大值, 100))
        赋值 (_启动窗口.., 100)
    .如果真结束
    
.判断 (等于 (被选择标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, “企业收支结构图”)))
    .计次循环首 (取记录数 (), )
        赋值 (营业收入, 相加 (营业收入, 读 (5)))
        赋值 (元件费, 相加 (元件费, 读 (6)))
        赋值 (其它支出, 相减 (相加 (其它支出, 读 (11)), 元件费))
        赋值 (利润额, 相加 (利润额, 读 (12)))
        跳过 ()
    .计次循环尾 ()
    打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\工资库.edb”), , , , , “bbkkklll”, )
    .计次循环首 (取记录数 (), )
        赋值 (实发工资, 相加 (实发工资, 读 (13)))
        跳过 ()
    .计次循环尾 ()
    关闭 ()
    赋值 (_启动窗口.., 5)
    赋值 (_启动窗口.., 1)
    赋值 (_启动窗口.., “收支项目”)
    赋值 (_启动窗口.., “收支分析柱状图”)
    .计次循环首 (5, 字段数)
        赋值 (_启动窗口.., 相减 (字段数, 1))
        赋值 (_启动窗口.., 多项选择 (字段数, “营业收入”, “元件费”, “其它支出”, “工资支出”, “利润额”))
        赋值 (_启动窗口.., 多项选择 (字段数, #绿色, #黄色, #红褐, #灰绿, #蓝色))
        赋值 (_启动窗口.., 多项选择 (字段数, 营业收入, 元件费, 其它支出, 实发工资, 相减 (利润额, 实发工资)))
        跳过 ()
    .计次循环尾 ()
    .如果真 (并且 (大于 (营业收入, 10000), 小于或等于 (营业收入, 50000)))
        赋值 (_启动窗口.., 50000)
    .如果真结束
    .如果真 (并且 (大于 (营业收入, 5000), 小于或等于 (营业收入, 10000)))
        赋值 (_启动窗口.., 10000)
    .如果真结束
    .如果真 (并且 (大于 (营业收入, 1000), 小于或等于 (营业收入, 5000)))
        赋值 (_启动窗口.., 5000)
    .如果真结束
    .如果真 (并且 (大于 (营业收入, 500), 小于或等于 (营业收入, 1000)))
        赋值 (_启动窗口.., 1000)
    .如果真结束
    .如果真 (并且 (大于 (营业收入, 100), 小于或等于 (营业收入, 500)))
        赋值 (_启动窗口.., 500)
    .如果真结束
    .如果真 (小于或等于 (营业收入, 100))
        赋值 (_启动窗口.., 100)
    .如果真结束
    
.默认
    
.判断结束
关闭 (“统计库”)


.窗口程序集 登记窗口, , , 

.程序集变量 接货量, 整数型, , , 
.子程序 _登记窗口_创建完毕, 空白型, , 
.局部变量 记数, 整数型, , , 

.计次循环首 (6, 记数) ' 选择执行那个登记窗口
    .如果真 (等于 (项目管理识别号, 相加 (记数, 9)))
        赋值 (.现行子夹, 相减 (记数, 1))
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
.判断开始 (等于 (.现行子夹, 0)) ' 选择接货登记窗口
    赋值 (.标题, “登记”)
    赋值 (.标题, “电器维修接货登记”)
    赋值 (接货量, 到数值 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “接货数量”, “数量”, “数量”)))
    赋值 (.内容, 到文本 (取日期 (取现行时间 ())))
    连续赋值 (0, .现行选中项, .现行选中项)
.默认
    .如果真 (等于 (.现行子夹, 1)) ' 打开支出窗口
        赋值 (.标题, “确定”)
        获取焦点 ()
        赋值 (.标题, “企业各项支出登记”)
        赋值 (.内容, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 到文本 (取月份 (取现行时间 ())), “月”))
    .如果真结束
    .如果真 (等于 (.现行子夹, 2)) ' 打开配件入库窗口
        赋值 (.标题, “采购配件入库登记”)
        赋值 (.内容, 到文本 (取日期 (取现行时间 ())))
        获取焦点 ()
        连续赋值 (0, .现行选中项, .现行选中项, .现行选中项)
    .如果真结束
    .如果真 (等于 (.现行子夹, 3)) ' 打开配件出库零售窗口
        赋值 (.标题, “配件零售出库登记”)
        赋值 (.内容, 到文本 (取日期 (取现行时间 ())))
        连续赋值 (0, .现行选中项, .现行选中项, .现行选中项)
        获取焦点 ()
    .如果真结束
    .如果真 (等于 (.现行子夹, 4)) ' 选择员工配领取窗口
        赋值 (.标题, “员工领取配件登记”)
        赋值 (.内容, 到文本 (取日期 (取现行时间 ())))
        连续赋值 (0, .现行选中项, .现行选中项)
        打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\职员库.edb”), , , , , “bbkkklll”, )
        .计次循环首 (取记录数 (), )
            读 (2).加入项目 ()
            跳过 ()
        .计次循环尾 ()
        关闭 ()
        获取焦点 ()
    .如果真结束
    .如果真 (等于 (.现行子夹, 5)) ' 员工配件归还窗口
        赋值 (.标题, “员工配件退库登记”)
        赋值 (.内容, 到文本 (取日期 (取现行时间 ())))
        打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\领归库.edb”), , , , , “bbkkklll”, )
        .计次循环首 (取记录数 (), )
            读 (2).加入项目 ()
            跳过 ()
        .计次循环尾 ()
        关闭 ()
        获取焦点 ()
        赋值 (.现行选中项, 0)
    .如果真结束
    
.判断结束


.子程序 _确定_被单击, 空白型, , 下面的选择夹.现行子夹的号与上面的同步 
.判断开始 (等于 (.现行子夹, 0))
    .如果 (等于 (.内容, “”))
        信息框 (“请输入电器品牌!”, 0, )
        获取焦点 ()
        返回 ()
    .否则
        .如果 (等于 (.内容, “”))
            信息框 (“请输入电器型号!”, 0, )
            获取焦点 ()
            返回 ()
        .否则
            .如果 (等于 (.内容, “”))
                信息框 (“请输入客户姓名!”, 0, )
                获取焦点 ()
                返回 ()
            .否则
                .如果 (等于 (.内容, “”))
                    信息框 (“请输入客户地址!”, 0, )
                    获取焦点 ()
                    返回 ()
                .否则
                    .如果 (等于 (.内容, “”))
                        信息框 (“请输入故障描述!”, 0, )
                        获取焦点 ()
                        返回 ()
                    .否则
                        打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\接货库.edb”), , , , , “bbkkklll”, )
                        置当前库 (“接货库”)
                        加记录 (相加 (接货量, 1), 到时间 (.内容), .取项目文本 (.现行选中项), .内容, .内容, .内容, .内容, .内容, .内容, .内容, .取项目文本 (.现行选中项), .内容)
                        关闭 ()
                        连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
                        连续赋值 (0, .现行选中项, .现行选中项)
                        写配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “接货数量”, “数量”, 到文本 (相加 (接货量, 1)))
                        赋值 (接货量, 相加 (接货量, 1))
                        赋值 (_启动窗口..标题, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “电器维修接货记录”))
                        赋值 (项目管理识别号, 1)
                        赋值 (_启动窗口..可视, 假)
                        赋值 (_启动窗口.., 假)
                        打开表格显示 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\接货库.edb”))
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.判断 (等于 (.现行子夹, 1))
    打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\统计库.edb”), , , , , “bbkkklll”, )
    到首记录 ()
    .如果真 (查找 (等于 (读 (1), 相加 (到文本 (取年份 (取现行时间 ())), “年”, 到文本 (取月份 (取现行时间 ())), “月”))))
        .如果 (并且 (等于 (.内容, 到文本 (读 (8))), 等于 (.内容, 到文本 (读 (9))), 等于 (.内容, 到文本 (读 (10)))))
            信息框 (“没有可以录入的项目!”, 0, )
        .否则
            修改 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 相加 (读 (6), 读 (7), 读 (8), 到数值 (.内容), 读 (9), 到数值 (.内容), 读 (10), 到数值 (.内容)), )
            修改 (相减 (读 (5), 读 (11)))
            赋值 (.内容, 到文本 (读 (8)))
            赋值 (.内容, 到文本 (读 (9)))
            赋值 (.内容, 到文本 (读 (10)))
            信息框 (“支出各项成功录入!”, 0, )
            关闭 ()
            销毁 ()
        .如果结束
        
    .如果真结束
    关闭 ()
.判断 (等于 (.现行子夹, 2))
    打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\元件库.edb”), , , , , “bbkkklll”, )
    .如果 (等于 (取记录数 (), 0))
        加记录 (1, .取项目文本 (.现行选中项), .内容, .内容, .取项目文本 (.现行选中项), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), .内容, .取项目文本 (.现行选中项), 到数值 (.内容), 到时间 (.内容), .内容)
    .否则
        到首记录 ()
        .如果 (并且 (查找 (等于 (读 (2), .取项目文本 (.现行选中项))), 查找 (等于 (读 (3), .内容)), 查找 (等于 (读 (4), .内容)))) ' 查找库里是否有相同的配件
            修改 (相加 (读 (7), 到数值 (.内容)), 相乘 (读 (6), 相加 (读 (7), 到数值 (.内容))), , , , , )
        .否则
            加记录 (1, .取项目文本 (.现行选中项), .内容, .内容, .取项目文本 (.现行选中项), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), .内容, .取项目文本 (.现行选中项), 到数值 (.内容), 到时间 (.内容), .内容)
        .如果结束
        
    .如果结束
    关闭 ()
    连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
    连续赋值 (0, .现行选中项, .现行选中项, .现行选中项)
    赋值 (_启动窗口..标题, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “库存元件显示”))
    赋值 (项目管理识别号, 2)
    赋值 (_启动窗口..可视, 假)
    赋值 (_启动窗口.., 假)
    打开表格显示 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\元件库.edb”))
.判断 (等于 (.现行子夹, 3))
    .如果 (等于 (.内容, “”))
        信息框 (“请输入经办人的姓名!”, 0, )
        获取焦点 ()
        返回 ()
    .否则
        .如果 (等于 (.内容, “”))
            信息框 (“请输入零售的价格!”, 0, )
            获取焦点 ()
            返回 ()
        .否则
            .如果 (等于 (.内容, “”))
                信息框 (“请输入零售的数量!”, 0, )
                获取焦点 ()
                返回 ()
            .否则
                打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\出货库.edb”), , , , , “bbkkklll”, )
                加记录 (到数值 (.内容), .取项目文本 (.现行选中项), .内容, .内容, .内容, .取项目文本 (.现行选中项), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到时间 (.内容), .内容, .取项目文本 (.现行选中项), .内容)
                关闭 ()
                打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\元件库.edb”), , , , , “bbkkklll”, )
                .如果真 (并且 (查找 (等于 (读 (1), 到数值 (.内容))), 查找 (等于 (读 (2), .内容)), 查找 (等于 (读 (3), .内容)), 查找 (等于 (读 (4), .内容))))
                    修改 (到数值 (.内容), 相乘 (到数值 (.内容), 到数值 (.内容)), , , , , ) ' 将已经出库的配件从元件库中减去
                .如果真结束
                关闭 ()
                连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
                连续赋值 (0, .现行选中项, .现行选中项, .现行选中项)
                获取焦点 ()
                赋值 (_启动窗口..标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “维修、销售配件记录”))
                赋值 (项目管理识别号, 3)
                赋值 (_启动窗口..可视, 假)
                赋值 (_启动窗口.., 假)
                打开表格显示 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\出货库.edb”))
            .如果结束
            
        .如果结束
        
    .如果结束
    
.判断 (等于 (.现行子夹, 4))
    .如果 (等于 (.内容, “”))
        信息框 (“请输入员工姓名!”, 0, )
        获取焦点 ()
        返回 ()
    .否则
        .如果 (等于 (.内容, “”))
            信息框 (“请输入领出的配件数量!”, 0, )
            获取焦点 ()
            返回 ()
        .否则
            打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\领归库.edb”), , , , , “bbkkklll”, )
            加记录 (到数值 (.内容), .取项目文本 (.现行选中项), 到时间 (.内容), .取项目文本 (.现行选中项), .内容, .内容, 到数值 (.内容), 到数值 (.内容), , , , .内容)
            关闭 ()
            打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\元件库.edb”), , , , , “bbkkklll”, )
            .如果真 (并且 (查找 (等于 (读 (1), 到数值 (.内容))), 查找 (等于 (读 (2), .取项目文本 (.现行选中项))), 查找 (等于 (读 (3), .内容)), 查找 (等于 (读 (4), .内容))))
                修改 (到数值 (.内容), 相乘 (到数值 (.内容), 读 (6)), , , , , ) ' 将已经出库的配件从元件库中减去
            .如果真结束
            关闭 ()
            连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
            赋值 (.现行选中项, 0)
            获取焦点 ()
        .如果结束
        
    .如果结束
    
.判断 (等于 (.现行子夹, 5))
    .如果 (等于 (.内容, “”))
        信息框 (“请输入配件的编号!”, 0, )
        获取焦点 ()
        返回 ()
    .否则
        .如果 (等于 (.内容, “”))
            信息框 (“请输入领出的数量!”, 0, )
            获取焦点 ()
            返回 ()
        .否则
            .如果 (小于或等于 (到数值 (.内容), 到数值 (.内容)))
                打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\元件库.edb”), , , , , “bbkkklll”, )
                到首记录 ()
                .如果真 (并且 (查找 (等于 (读 (1), 到数值 (.内容))), 查找 (等于 (读 (2), .内容)), 查找 (等于 (读 (3), .内容)), 查找 (等于 (读 (4), .内容)), 查找 (等于 (读 (6), 到数值 (.内容)))))
                    修改 (相加 (读 (7), 到数值 (.内容)), 相乘 (读 (6), 相加 (读 (7), 到数值 (.内容))), , , , , ) ' 将员工归还的配件入元件库
                .如果真结束
                关闭 ()
                打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\领归库.edb”), , , , , “bbkkklll”, )
                到首记录 ()
                .如果真 (并且 (查找 (等于 (读 (1), 到数值 (.内容))), 查找 (等于 (读 (2), .内容)), 查找 (等于 (读 (3), .内容)), 查找 (等于 (读 (4), .内容)), 查找 (等于 (读 (6), 到数值 (.内容)))))
                    .判断开始 (小于或等于 (到数值 (.内容), 到数值 (.内容)))
                        修改 (相减 (读 (7), 到数值 (.内容)), , 到数值 (.内容), ) ' 减去已经归还的配件
                    .默认
                        
                    .判断结束
                    
                .如果真结束
                关闭 ()
                连续赋值 (“”, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容)
                获取焦点 ()
                赋值 (.现行选中项, 0)
            .否则
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.默认
    
.判断结束


.子程序 _数量_内容被改变, 空白型, , 
赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))

.子程序 _货品类型_列表项被选择, 空白型, , 显示配件出库窗口
赋值 (项目管理识别号, 22)
载入 (结保配窗, , 真)

.子程序 _零售数量_内容被改变, 空白型, , 
.如果 (大于 (到数值 (.内容), 到数值 (.内容)))
    .如果 (等于 (信息框 (相加 (“库存配件不够!只有 ”, .内容, “是否全部调出?”), 相加 (#询问图标, #是否钮), “提示”), #是钮))
        赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
        赋值 (.内容, “0”)
    .否则
        赋值 (.内容, “”)
        返回 ()
    .如果结束
    
.否则
    赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 到数值 (.内容))))
    赋值 (.内容, 到文本 (相减 (到数值 (.内容), 到数值 (.内容))))
.如果结束


.子程序 _退出_被单击, 空白型, , 
销毁 ()

.子程序 _姓名_列表项被选择, 空白型, , 
.如果 (等于 (.内容, “”))
    信息框 (“请输入配件的编号!”, 0, )
    获取焦点 ()
    返回 ()
.否则
    打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\领归库.edb”), , , , , “bbkkklll”, )
    .如果 (并且 (查找 (等于 (读 (1), 到数值 (.内容))), 查找 (等于 (读 (2), .取项目文本 (.现行选中项)))))
        赋值 (.内容, 到文本 (读 (3)))
        赋值 (.内容, 读 (4))
        赋值 (.内容, 读 (5))
        赋值 (.内容, 读 (6))
        赋值 (.内容, 到文本 (读 (7)))
        赋值 (.内容, 到文本 (读 (8)))
    .否则
        信息框 (“没有找到这个配件!”, 0, )
        返回 ()
    .如果结束
    关闭 ()
    获取焦点 ()
.如果结束


.子程序 _货品类型2_列表项被选择, 空白型, , 显示配件出库窗口
赋值 (项目管理识别号, 22)
载入 (结保配窗, , 真)

.子程序 _领出数量2_内容被改变, 空白型, , 
赋值 (.内容, 到文本 (相减 (到数值 (.内容), 到数值 (.内容))))

.子程序 _送修货品_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.未知支持库函数_20 (“单击下拉键，即可选择电器的类型!”, #信息图标, , , , )

.子程序 _元件类型_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.未知支持库函数_20 (“单击下拉键，即可选择电器的类型!”, #信息图标, , , , )

.子程序 _货品类型_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.未知支持库函数_20 (“单击下拉键，即可选择电器的类型!”, #信息图标, , , , )

.子程序 _员工姓名_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.未知支持库函数_20 (“单击下拉键，即可选择员工的姓名!”, #信息图标, , , , )

.子程序 _货品类型2_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.未知支持库函数_20 (“单击下拉键，即可选择电器的类型!”, #信息图标, , , , )

.子程序 _姓名_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.未知支持库函数_20 (“单击下拉键，即可选择员工的姓名!”, #信息图标, , , , )

.窗口程序集 结保配窗, , , 

.程序集变量 材料费合计, 小数型, , , 
.程序集变量 数值号, 整数型, , , 
.程序集变量 出库配件名称, 文本型, , , 
.程序集变量 出库配件金额合计, 双精度小数型, , , 
.子程序 _结保配窗_创建完毕, 空白型, , 
.局部变量 记数, 整数型, , , 
.局部变量 记录数, 整数型, , , 
.局部变量 次数, 整数型, , , 

.变量循环首 (20, 22, 1, 记数) ' 选择应该显示的窗口
    .如果真 (等于 (项目管理识别号, 记数))
        赋值 (.现行子夹, 相减 (记数, 20))
        跳出循环 ()
    .如果真结束
    
.变量循环尾 ()
.判断开始 (等于 (.现行子夹, 0)) ' 显示结算窗口
    结保配窗.移动 (150, 50, 562, 400)
    0.移动 (39, 取屏幕宽度 (), 取屏幕高度 ())
    赋值 (.现行子夹, 0)
    赋值 (.内容, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 0))
    赋值 (.内容, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 1))
    赋值 (.内容, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 2))
    赋值 (.内容, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 3))
    赋值 (.内容, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 4))
    赋值 (.内容, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 5))
    赋值 (.内容, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 7))
    赋值 (.内容, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 8))
    赋值 (.内容, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 9))
    赋值 (.内容, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 10))
    赋值 (.内容, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 6))
    赋值 (.内容, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 11))
    打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\职员库.edb”), , , , , “bbkkklll”, )
    .计次循环首 (取记录数 (), )
        读 (2).加入项目 ()
        跳过 ()
    .计次循环尾 ()
    关闭 ()
    连续赋值 (0, .现行选中项, .现行选中项, .现行选中项, .现行选中项, .现行选中项)
    获取焦点 ()
    赋值 (.内容, 到文本 (取日期 (取现行时间 ())))
.判断 (等于 (.现行子夹, 1)) ' 显示派工和保修窗口
    结保配窗.移动 (140, 40, 660, 630)
    3.移动 (40, 700, 630)
    3.移动 (3, 650, 530)
    40.初始尺寸 (8) ' 显示派工单
    1.置对齐方式 (1, 38, 8, #中中)
    1.合并 (1, 2, 8)
    1.置文本 (1, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “公司信息”, “公司名称”, ), “电器派工单”))
    3.置行高 (35, 65)
    1.置字体尺寸 (1, 1, 1, 76)
    3.合并 (1, 1, 8)
    1.置列宽 (1, 200)
    2.置列宽 (1, 200)
    3.置列宽 (1, 240)
    4.置列宽 (1, 300)
    5.置列宽 (1, 240)
    6.置列宽 (1, 350)
    7.置列宽 (1, 240)
    8.置列宽 (1, 350)
    5.合并 (2, 1, 5)
    6.置行高 (1, 12)
    6.合并 (1, 1, 8)
    6.置背景色 (1, 1, 8, #浅灰)
    8.合并 (2, 1, 2)
    8.合并 (5, 1, 4)
    9.合并 (1, 1, 3)
    9.合并 (5, 1, 2)
    10.合并 (2, 3, 2)
    10.合并 (5, 6, 1)
    14.合并 (1, 5, 1)
    14.合并 (2, 5, 1)
    14.合并 (3, 5, 1)
    14.合并 (4, 5, 1)
    3.置字体尺寸 (1, 11, 8, 44)
    3.置文本 (1, “注册企业号:1223002232346”)
    4.置文本 (1, “机主姓名”)
    5.置文本 (1, “客户地址”)
    4.置文本 (3, “回访电话”)
    5.置文本 (3, “客户姓名”)
    7.置文本 (3, “品    牌”)
    4.置文本 (5, “手    机”)
    5.置文本 (5, “客户电话”)
    7.置文本 (5, “机    型”)
    4.置文本 (7, “编    号”)
    5.置文本 (7, “修理人编号”)
    7.置文本 (1, “类    别”)
    7.置文本 (7, “ 机    号”)
    8.置文本 (1, “登记日期”)
    8.置文本 (4, “用户信息来源”)
    9.置文本 (4, “保全修理费”)
    9.置文本 (7, “实收修理费”)
    10.置文本 (1, “保修日期”)
    10.置文本 (5, “元件单价”)
    10.置文本 (6, “元件名称”)
    10.置文本 (7, “数    量”)
    10.置文本 (8, “金    额”)
    11.置文本 (1, “保修期限”)
    12.置文本 (1, “返回时间”)
    13.置文本 (1, “服务态度”)
    13.置文本 (2, “优⊙”)
    13.置文本 (3, “良⊙”)
    13.置文本 (4, “差⊙”)
    14.置文本 (1, “故障现象”)
    14.置文本 (3, “回访记录”)
    16.置文本 (7, “总    额”)
    17.置文本 (7, “经理签字”)
    17.置文本 (8, “客户签字”)
    18.置文本 (5, “上门 ⊙”)
    18.置文本 (6, “送  修⊙”)
    4.置文本 (2, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 7))
    4.置文本 (4, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 9))
    4.置文本 (8, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 0))
    5.置文本 (2, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 8))
    7.置文本 (2, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 2))
    7.置文本 (4, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 3))
    7.置文本 (6, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 4))
    7.置文本 (8, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 5))
    8.置文本 (2, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 1))
    14.置文本 (2, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 6))
    4.加线条 (1, 7, 8, )
    4.加线条 (1, 15, 8, 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))
    18.置光标 (8)
    
    20.合并 (1, 2, 8)
    20.置字体尺寸 (1, 1, 1, 76)
    20.置文本 (1, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “公司信息”, “公司名称”, ), “电器保修凭证”))
    21.置字体尺寸 (1, 38, 8, 44)
    22.合并 (1, 1, 8)
    23.合并 (6, 1, 3)
    24.置行高 (1, 12)
    24.合并 (1, 1, 8)
    24.置背景色 (1, 1, 8, #浅灰)
    26.合并 (2, 1, 2)
    26.合并 (6, 2, 1)
    26.合并 (7, 2, 2)
    27.合并 (2, 1, 2)
    28.合并 (2, 1, 2)
    28.合并 (7, 1, 2)
    29.合并 (2, 1, 2)
    29.合并 (7, 1, 2)
    30.合并 (7, 1, 2)
    31.合并 (1, 3, 1)
    31.合并 (2, 3, 3)
    31.合并 (5, 3, 1)
    31.合并 (6, 3, 3)
    34.合并 (1, 1, 3)
    34.合并 (4, 1, 3)
    35.合并 (1, 2, 3)
    35.合并 (4, 2, 3)
    37.合并 (1, 1, 8)
    38.合并 (1, 3, 8)
    38.置背景色 (1, 2, 8, #黄色)
    22.置文本 (1, “注册企业号:1223002232346”)
    23.置文本 (1, “No：”)
    23.置文本 (6, 相加 (“地址:”, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “公司信息”, “公司地址”, )))
    25.置文本 (1, “类  别”)
    25.置文本 (3, “修理人编号”)
    25.置文本 (5, “保全修理费”)
    25.置文本 (7, “实收修理费”)
    26.置文本 (1, “品  牌”)
    26.置文本 (6, “服务电话”)
    26.置文本 (7, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “公司信息”, “办公电话”, ))
    27.置文本 (1, “机  型”)
    28.置文本 (1, “机  号”)
    28.置文本 (6, “返修受理电话”)
    28.置文本 (7, “0421-6602617”)
    29.置文本 (1, “完成日期”)
    29.置文本 (6, “夜间咨询电话”)
    29.置文本 (7, “0421-6605118”)
    30.置文本 (1, “保修期限”)
    30.置文本 (3, “上 门 ⊙”)
    30.置文本 (4, “送 修 ⊙”)
    30.置文本 (6, “E-mail:”)
    30.置文本 (3, “上 门 ⊙”)
    30.置文本 (4, “送 修 ⊙”)
    30.置文本 (6, “E-mail:”)
    30.置文本 (7, “gaoyu33@163.com”)
    31.置文本 (1, “故障现象”)
    31.置文本 (5, “处理结果”)
    34.置文本 (1, “一次返修记录”)
    34.置文本 (4, “二次返修记录”)
    34.置文本 (7, “总    额”)
    35.置文本 (7, “经理签字”)
    35.置文本 (8, “客户签字”)
    37.置文本 (1, “客户意见投诉电话:13942109208”)
    38.置文本 (1, “    2005年最新奉献。保修期内无论出现任何故障，修理费和元件费均免费维修(修理费打折的除外),但不得损坏封贴，如损坏，本部视务异保。所修电器不退坏件.  备注：上述损坏情况已经修好，由机主本人验明满意后签字，希望你详细阅读后签字。无公章无效。”)
    25.置文本 (2, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 2))
    26.置文本 (2, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 3))
    27.置文本 (2, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 4))
    28.置文本 (2, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 5))
    31.置文本 (2, _启动窗口.未知支持库函数_10 (., _启动窗口.未知支持库函数_3 (.), 6))
    24.加线条 (1, 13, 8, 相加 (#左边框, #上边框, #右边框, #下边框, #水平线, #垂直线))
.判断 (等于 (.现行子夹, 2)) ' 显示配件库选择表
    结保配窗.移动 (150, 250, 640, 240)
    赋值 (.现行子夹, 2)
    打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\元件库.edb”), , , , , “bbkkklll”, )
    置等待鼠标 ()
    .计次循环首 (取记录数 (), 记录数)
        .判断开始 (等于 (登记窗口..现行子夹, 4))
            .如果真 (查找 (等于 (读 (2), 登记窗口.取项目文本 (., 登记窗口..现行选中项))))
                -1.插入表项 (到文本 (读 (1)), , , , )
                .计次循环首 (相减 (取字段数 (), 1), 次数)
                    相减 (记录数, 1).置标题 (次数, 到文本 (读 (相加 (次数, 1))))
                .计次循环尾 ()
                跳过 (1)
            .如果真结束
            
        .判断 (等于 (登记窗口..现行子夹, 3))
            .如果真 (查找 (等于 (读 (2), 登记窗口.取项目文本 (., 登记窗口..现行选中项))))
                -1.插入表项 (到文本 (读 (1)), , , , )
                .计次循环首 (相减 (取字段数 (), 1), 次数)
                    相减 (记录数, 1).置标题 (次数, 到文本 (读 (相加 (次数, 1))))
                .计次循环尾 ()
                跳过 (1)
            .如果真结束
            
        .默认
            
        .判断结束
        
    .计次循环尾 ()
    关闭 ()
    恢复鼠标 ()
.默认
    
.判断结束


.子程序 _更换_被单击, 空白型, , 
.局部变量 记录数, 整数型, , , 
.局部变量 次数, 整数型, , , 

赋值 (.现行子夹, 2) ' 装入配件选择表格
结保配窗.移动 (150, 50, 635, 420)
打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\元件库.edb”), , , , , “bbkkklll”, )
置等待鼠标 ()
.计次循环首 (取记录数 (), 记录数)
    .如果真 (查找 (等于 (读 (2), .内容)))
        -1.插入表项 (到文本 (读 (1)), , , , )
        .计次循环首 (相减 (取字段数 (), 1), 次数)
            相减 (记录数, 1).置标题 (次数, 到文本 (读 (相加 (次数, 1))))
        .计次循环尾 ()
        跳过 (1)
    .如果真结束
    
.计次循环尾 ()
关闭 ()
恢复鼠标 ()

.子程序 _确定_被单击, 空白型, , 
.如果 (不等于 (0.取标题 (0), “”)) ' 判断是否调用了配件
    赋值 (.内容, )
.否则
    .如果 (等于 (信息框 (“你真的没有用任何配件吗?”, 相加 (#询问图标, #是否钮), “询问”), #是钮))
        赋值 (.内容, “.”)
    .否则
        返回 ()
    .如果结束
    
.如果结束
赋值 (.内容, 到文本 ())
获取焦点 ()
赋值 (.现行子夹, 0)

.子程序 _缺件_被单击, 空白型, , 
打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\派工库.edb”), , , , , “bbkkklll”, )
.如果 (等于 (取记录数 (), 0))
    加记录 (到数值 (.内容), .内容, .内容, .内容, .内容, “缺件”)
.否则
    加记录 (到数值 (.内容), .内容, .内容, .内容, .内容, “缺件”)
.如果结束
关闭 ()
赋值 (项目管理识别号, 1)
缺件或派工显示 ()
打开表格显示 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\接货库.edb”))
销毁 ()

.子程序 _查找_被单击, 空白型, , 
信息框 (“必须是注册用户才能和此功能!”, 0, )

.子程序 _退出_被单击, 空白型, , 
销毁 ()

.子程序 _按钮1_被单击, 空白型, , 这是结算按钮
.如果 (等于 (.取项目文本 (.现行选中项), “”))
    信息框 (“请选择维修员的姓名!”, 0, )
    获取焦点 ()
    返回 ()
.否则
    .如果 (等于 (.内容, “”))
        信息框 (“请输入检测情况!”, 0, )
        获取焦点 ()
        返回 ()
    .否则
        .如果 (等于 (.内容, “”))
            信息框 (“请童单击更换元件按钮!”, 0, )
            获取焦点 ()
            返回 ()
        .否则
            .如果 (等于 (.内容, “”))
                信息框 (“请输入维修费!”, 0, )
                获取焦点 ()
                返回 ()
            .否则
                .如果 (并且 (等于 (.取项目文本 (.现行选中项), “是”), 等于 (.内容, “”)))
                    信息框 (“请输入保修凭据号码!”, 0, )
                    获取焦点 ()
                    返回 ()
                .否则
                    .如果 (并且 (等于 (.取项目文本 (.现行选中项), “是”), 等于 (.内容, “”)))
                        信息框 (“请输入返修费!”, 0, )
                        获取焦点 ()
                        返回 ()
                    .否则
                        打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\历史库.edb”), , , , , “bbkkklll”, ) ' 已结算的记录加入历史库
                        赋值 (材料费合计, 相加 (到数值 (.内容), 相除 (相乘 (到数值 (.内容), 10), 100)))
                        加记录 (到数值 (.内容), 到时间 (.内容), .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .内容, .取项目文本 (.现行选中项), .取项目文本 (.现行选中项), .取项目文本 (.现行选中项), .内容, .内容, .取项目文本 (.现行选中项), 到时间 (.内容), .取项目文本 (.现行选中项), .取项目文本 (.现行选中项), 材料费合计, 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), .内容)
                        关闭 ()
                        将所换元件写入出货库 ()
                        销毁 ()
                    .如果结束
                    
                .如果结束
                
            .如果结束
            
        .如果结束
        
    .如果结束
    
.如果结束





.子程序 将所换元件写入出货库, 空白型, , 
.局部变量 表项数, 整数型, , , 

打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\出货库.edb”), , , , , “bbkkklll”, )
.计次循环首 (取表项数 (), 表项数)
    加记录 (到数值 (相减 (表项数, 1).取标题 (0)), 相减 (表项数, 1).取标题 (1), 相减 (表项数, 1).取标题 (2), 相减 (表项数, 1).取标题 (3), 相减 (表项数, 1).取标题 (4), 相减 (表项数, 1).取标题 (8), 到数值 (相减 (表项数, 1).取标题 (5)), 到数值 (相减 (表项数, 1).取标题 (6)), , 到时间 (.内容), .取项目文本 (.现行选中项), .取项目文本 (.现行选中项), “维修用配件,不计售价.”)
.计次循环尾 ()
关闭 ()
将元件库中的元件减除 ()

.子程序 将元件库中的元件减除, 空白型, , 
.局部变量 表项数, 整数型, , , 

打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\元件库.edb”), , , , , “bbkkklll”, )
.计次循环首 (取表项数 (), 表项数)
    到首记录 ()
    .如果真 (并且 (查找 (等于 (读 (1), 到数值 (相减 (表项数, 1).取标题 (0)))), 查找 (等于 (读 (2), 相减 (表项数, 1).取标题 (1))), 查找 (等于 (读 (3), 相减 (表项数, 1).取标题 (2)))))
        修改 (相减 (读 (7), 到数值 (相减 (表项数, 1).取标题 (6))), 相乘 (读 (6), 相减 (读 (7), 到数值 (相减 (表项数, 1).取标题 (6)))), , , , , )
    .如果真结束
    
.计次循环尾 ()
关闭 ()
将维修收支加入统计库 ()

.子程序 将维修收支加入统计库, 空白型, , 
打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\统计库.edb”), , , , , “bbkkklll”, )
到首记录 ()
.如果 (查找 (等于 (读 (1), 相加 (到文本 (取年份 (取现行时间 ())), “年”, 到文本 (取月份 (取现行时间 ())), “月”))))
    修改 (相加 (读 (2), 到数值 (.内容)), 相加 (读 (3), 到数值 (.内容)), , 相加 (读 (2), 到数值 (.内容), 读 (3), 到数值 (.内容), 读 (4)), 相加 (读 (6), 材料费合计), 相加 (读 (7), 到数值 (.内容)), , , , 相加 (读 (6), 材料费合计, 读 (7), 到数值 (.内容), 读 (8), 读 (9), 读 (10)), 相减 (相加 (读 (2), 到数值 (.内容), 读 (3), 到数值 (.内容), 读 (4)), 相加 (读 (6), 材料费合计, 读 (7), 到数值 (.内容), 读 (8), 读 (9), 读 (10))))
.否则
    
.如果结束
关闭 ()
将维修员工资加入工资库 ()

.子程序 将维修员工资加入工资库, 空白型, , 
.局部变量 职员编号, 整数型, , , 
.局部变量 基本工资, 小数型, , , 
.局部变量 计时工资, 小数型, , , 
.局部变量 计件工资比率, 小数型, , , 

打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\职员库.edb”), , , , , “bbkkklll”, )
到首记录 ()
.如果真 (查找 (等于 (读 (2), .取项目文本 (.现行选中项))))
    赋值 (职员编号, 读 (1))
    赋值 (基本工资, 读 (13))
    赋值 (计时工资, 读 (14))
    赋值 (计件工资比率, 读 (15))
.如果真结束
关闭 ()
打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\工资库.edb”), , , , , “bbkkklll”, )
到首记录 ()
.如果 (并且 (查找 (等于 (读 (2), 相加 (到文本 (取年份 (取现行时间 ())), “年”, 到文本 (取月份 (取现行时间 ())), “月”))), 查找 (等于 (读 (3), .取项目文本 (.现行选中项)))))
    修改 (相加 (读 (6), 相除 (相乘 (相减 (相加 (到数值 (.内容), 到数值 (.内容)), 材料费合计), 计件工资比率), 100)), , 相加 (读 (4), 读 (5), 读 (6), 相除 (相乘 (相减 (相加 (到数值 (.内容), 到数值 (.内容)), 材料费合计), 计件工资比率), 100), 读 (7)), 相加 (读 (9), 到数值 (.内容)), , , , 相减 (相加 (读 (4), 读 (5), 读 (6), 相除 (相乘 (相减 (相加 (到数值 (.内容), 到数值 (.内容)), 材料费合计), 计件工资比率), 100), 读 (7)), 相加 (读 (9), 到数值 (.内容), 读 (10), 读 (11), 读 (12))))
.否则
    加记录 (职员编号, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 到文本 (取月份 (取现行时间 ())), “月”), .取项目文本 (.现行选中项), 基本工资, 计时工资, 相除 (相乘 (相减 (相加 (到数值 (.内容), 到数值 (.内容)), 材料费合计), 计件工资比率), 100), , 相加 (基本工资, 计时工资, 相除 (相乘 (相减 (相加 (到数值 (.内容), 到数值 (.内容)), 材料费合计), 计件工资比率), 100)), 到数值 (.内容), , , , 相减 (相加 (基本工资, 计时工资, 相除 (相乘 (相减 (相加 (到数值 (.内容), 到数值 (.内容)), 材料费合计), 计件工资比率), 100)), 到数值 (.内容)))
.如果结束
关闭 ()
删除接货库中已修理完成的家电 ()


.子程序 删除接货库中已修理完成的家电, 空白型, , 
打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\接货库.edb”), , , , , “bbkkklll”, )
到首记录 ()
.如果真 (并且 (等于 (查找 (等于 (读 (1), 到数值 (.内容))), 真), 等于 (查找 (等于 (读 (2), 到时间 (.内容))), 真), 等于 (查找 (等于 (读 (3), .内容)), 真), 等于 (查找 (等于 (读 (4), .内容)), 真), 等于 (查找 (等于 (读 (5), .内容)), 真), 等于 (查找 (等于 (读 (6), .内容)), 真), 等于 (查找 (等于 (读 (8), .内容)), 真)))
    删除 ()
    彻底删除 ()
.如果真结束
关闭 ()
赋值 (项目管理识别号, 1)
打开表格显示 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\接货库.edb”))


.子程序 _元件列表框_表项被激活, 空白型, , 选择需要调出的配件
.如果 (并且 (是否已创建 (登记窗口), 等于 (登记窗口..现行子夹, 3)))
    赋值 (登记窗口..内容, .取标题 (., 0))
    赋值 (登记窗口..内容, .取标题 (., 2))
    赋值 (登记窗口..内容, .取标题 (., 3))
    赋值 (登记窗口..内容, .取标题 (., 4))
    赋值 (登记窗口..内容, .取标题 (., 5))
    赋值 (登记窗口..内容, .取标题 (., 6))
    销毁 ()
.否则
    .如果 (并且 (是否已创建 (登记窗口), 等于 (登记窗口..现行子夹, 4)))
        赋值 (登记窗口..内容, .取标题 (., 0))
        赋值 (登记窗口..内容, .取标题 (., 2))
        赋值 (登记窗口..内容, .取标题 (., 3))
        赋值 (登记窗口..内容, .取标题 (., 4))
        赋值 (登记窗口..内容, .取标题 (., 5))
        赋值 (登记窗口..内容, .取标题 (., 6))
        销毁 ()
    .否则
        .如果真 (不等于 (取表项数 (), 0)) ' 检查出库列表单中是否已经调出了元件
            .计次循环首 (取表项数 (), 数值号) ' 寻找在出库列表单中是否有已经调出的相同配件
                .判断开始 (等于 (相减 (数值号, 1).取标题 (2), .取标题 (., 2))) ' 如果已经有了相同的配件就相加
                    .如果 (等于 (.取标题 (., 6), “0”))
                        信息框 (“库存配件已经用完了，请及时进货!”, 0, )
                        返回 ()
                    .否则
                        .如果真 (等于 (.取标题 (., 6), “1”))
                            信息框 (“库存配件快要用完了，请及时进货!”, 0, )
                        .如果真结束
                        相减 (数值号, 1).置标题 (6, 到文本 (相加 (到数值 (相减 (数值号, 1).取标题 (6)), 1)))
                        相减 (数值号, 1).置标题 (7, 到文本 (相乘 (到数值 (相减 (数值号, 1).取标题 (6)), 到数值 (相减 (数值号, 1).取标题 (5)))))
                        .置标题 (., 6, 到文本 (相减 (到数值 (.取标题 (., 6)), 1))) ' 减去一个已调出的元件
                        .置标题 (., 7, 到文本 (相乘 (到数值 (.取标题 (., 5)), 到数值 (.取标题 (., 6))))) ' 减去已调出配件的金额
                        赋值 (出库配件名称, 相加 (出库配件名称, “、”, .取标题 (., 3)))
                        赋值 (出库配件金额合计, 相加 (出库配件金额合计, 到数值 (.取标题 (., 5))))
                        返回 ()
                    .如果结束
                    
                .默认
                    
                .判断结束
                
            .计次循环尾 ()
        .如果真结束
        将调出的元件写入元件列表框 ()
    .如果结束
    
.如果结束



.子程序 将调出的元件写入元件列表框, 空白型, , 
.局部变量 表项索引, 整数型, , , 
.局部变量 列索引, 整数型, , , 

.如果 (等于 (.取标题 (., 6), “0”))
    信息框 (“库存配件已经用完了，请及时进货!”, 0, )
    返回 ()
.否则
    .如果真 (等于 (.取标题 (., 6), “1”))
        信息框 (“库存配件快要用完了，请及时进货!”, 0, )
    .如果真结束
    .置标题 (., 6, 到文本 (相减 (到数值 (.取标题 (., 6)), 1))) ' 减去一个已调出的元件
    .置标题 (., 7, 到文本 (相乘 (到数值 (.取标题 (., 5)), 到数值 (.取标题 (., 6))))) ' 减去已调出配件的金额
    赋值 (表项索引, .插入表项 (.取标题 (., 0), , , , )) ' 将调出的配件写入出库列表单中
    .计次循环首 (5, 列索引)
        表项索引.置标题 (列索引, .取标题 (., 列索引))
    .计次循环尾 ()
    .计次循环首 (取表项数 (), 数值号)
        .判断开始 (等于 (.取标题 (., 3), 数值号.取标题 (3)))
            相减 (数值号, 1).置标题 (6, 到文本 (相加 (到数值 (数值号.取标题 (6)), 1)))
        .默认
            表项索引.置标题 (6, “1”)
        .判断结束
        
    .计次循环尾 ()
    表项索引.置标题 (7, 到文本 (相乘 (到数值 (.取标题 (., 5)), 到数值 (表项索引.取表项数值 ().取标题 (6)))))
    表项索引.置标题 (8, “维修用”)
    赋值 (出库配件名称, 相加 (出库配件名称, “、”, .取标题 (., 3)))
    赋值 (出库配件金额合计, 相加 (出库配件金额合计, 到数值 (.取标题 (., 5))))
.如果结束


.子程序 _打印预览_被单击, 空白型, , 
.局部变量 打印设置信息, 打印设置信息, , , 
.局部变量 已设置打印信息, 逻辑型, , , 

.如果真 (等于 (已设置打印信息, 假))
    赋值 (打印设置信息.打印缩放比, -1)
    赋值 (打印设置信息.纸张方向, #横向)
    赋值 (打印设置信息.纸张类型, #A4纸)
    赋值 (打印设置信息.左边距, 100)
    赋值 (打印设置信息.右边距, 100)
    赋值 (打印设置信息.上边距, 180)
    赋值 (打印设置信息.下边距, 150)
    赋值 (打印设置信息.打印文件名, _启动窗口..标题)
    打印设置信息.置打印设置 ()
.如果真结束
打印预览 ()
赋值 (已设置打印信息, 真)

.子程序 _打印_被单击, 空白型, , 
.局部变量 打印设置信息, 打印设置信息, , , 
.局部变量 已设置打印信息, 逻辑型, , , 

.如果真 (等于 (已设置打印信息, 假))
    赋值 (打印设置信息.自动添加表格线, 真)
    赋值 (打印设置信息.打印缩放比, -1)
    赋值 (打印设置信息.纸张方向, #横向)
    赋值 (打印设置信息.纸张类型, #A4纸)
    赋值 (打印设置信息.左边距, 100)
    赋值 (打印设置信息.右边距, 100)
    赋值 (打印设置信息.上边距, 180)
    赋值 (打印设置信息.下边距, 150)
    赋值 (打印设置信息.打印文件名, _启动窗口..标题)
    打印设置信息.置打印设置 ()
.如果真结束
.如果真 (打印设置 ())
    .打印 ()
.如果真结束
打开 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\派工库.edb”), , , , , “bbkkklll”, )
.如果 (等于 (取记录数 (), 0))
    加记录 (到数值 (4.取文本 (8)), 7.取文本 (2), 7.取文本 (4), 7.取文本 (6), 7.取文本 (8), “派工”)
.否则
    加记录 (到数值 (4.取文本 (8)), 7.取文本 (2), 7.取文本 (4), 7.取文本 (6), 7.取文本 (8), “派工”)
    
.如果结束
关闭 ()
赋值 (项目管理识别号, 1)
缺件或派工显示 ()
打开表格显示 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\接货库.edb”))
销毁 ()

.子程序 _按钮2_被单击, 空白型, , 为防止假死现象，关闭前须刷新一次表格
赋值 (1)
未知函数_67176560 ()
未知函数_67176561 (相加 (取当前目录 (), “\”, , “\接货库.edb”))
销毁 ()

.子程序 _关闭_被单击, 空白型, , 
_按钮2_被单击 ()

.子程序 _结保配窗_可否被关闭, 逻辑型, , 
未知函数_67176566 ()

.子程序 _元件列表框_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.未知支持库函数_20 (“在这里双击所选中的配件即可!”, #信息图标, , , , )

.子程序 _出库列表单_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.未知支持库函数_20 (“这里显示的是已经调出的配件!”, #信息图标, , , , )

.窗口程序集 查询窗口, , , 

.程序集变量 被选中项, 整数型, , , 
.子程序 _按钮1_被单击, 空白型, , 
.判断开始 (等于 (_启动窗口..标题, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “电器维修接货记录”)))
    打开数据库查询 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\接货库.edb”))
.判断 (等于 (_启动窗口..标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “家电维修历史档案”)))
    打开数据库查询 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\历史库.edb”))
.判断 (等于 (_启动窗口..标题, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “库存元件显示”)))
    打开数据库查询 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\元件库.edb”))
.判断 (等于 (_启动窗口..标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “维修、销售配件记录”)))
    打开数据库查询 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\出货库.edb”))
.默认
    
.判断结束


.子程序 打开数据库查询, 空白型, , 主窗口中的各项进行模糊查询
.参数 欲打开数据库文件, 文本型, , 

.局部变量 字段数, 整数型, , , 
.局部变量 结果, 整数型, , , 
.局部变量 被查中项, 整数型, , , 

打开 (欲打开数据库文件, , , , , “bbkkklll”, )
查询字段选择 () ' 确定需要查询的字段
置等待鼠标 ()
.计次循环首 (取字段数 (), 字段数)
    _启动窗口.未知支持库函数_9 (., 结果, 相减 (字段数, 1), 1, 到文本 (取字段名 (字段数)))
.计次循环尾 ()
赋值 (字段数, 0) ' 初始化变量
.变量循环首 (1, 取记录数 (), 1, )
    .如果真 (不等于 (.内容, “”))
        赋值 (结果, 寻找文本 (到文本 (读 (被选中项)), .内容, , 真))
    .如果真结束
    .判断开始 (不等于 (结果, -1))
        赋值 (被查中项, 相加 (被查中项, 1))
        .计次循环首 (取字段数 (), 字段数)
            _启动窗口.未知支持库函数_9 (., 被查中项, 相减 (字段数, 1), 1, 读 (字段数))
        .计次循环尾 ()
    .默认
        
    .判断结束
    跳到 (相加 (取记录号 (), 1))
.变量循环尾 ()
赋值 (_启动窗口.., 相加 (被查中项, 1))
恢复鼠标 ()
_启动窗口.置文本 (., 2, 相加 (#左引号, _启动窗口..标题, #右引号, “ 共: ”, 到文本 (相减 (结果, 1)), “条”))
关闭 ()
销毁 ()

.子程序 查询字段选择, 空白型, , 
.如果真 (等于 (_启动窗口..标题, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “电器维修接货记录”)))
    .判断开始 (等于 (.选中, 真))
        赋值 (被选中项, 3) ' 注意:这里“被选中项”数与相应数据库的字段相对应。
    .判断 (等于 (.选中, 真))
        赋值 (被选中项, 4)
    .判断 (等于 (.选中, 真))
        赋值 (被选中项, 5)
    .判断 (等于 (.选中, 真))
        赋值 (被选中项, 6)
    .判断 (等于 (.选中, 真))
        赋值 (被选中项, 7)
    .判断 (等于 (.选中, 真))
        赋值 (被选中项, 8)
    .判断 (等于 (.选中, 真))
        赋值 (被选中项, 9)
    .判断 (等于 (.选中, 真))
        赋值 (被选中项, 10)
    .判断 (等于 (.选中, 真))
        赋值 (被选中项, 12)
    .默认
        
    .判断结束
    
.如果真结束
.如果真 (等于 (_启动窗口..标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “家电维修历史档案”)))
    .判断开始 (等于 (.选中, 真))
        赋值 (被选中项, 3)
    .判断 (等于 (.选中, 真))
        赋值 (被选中项, 4)
    .判断 (等于 (.选中, 真))
        赋值 (被选中项, 5)
    .判断 (等于 (.选中, 真))
        赋值 (被选中项, 6)
    .判断 (等于 (.选中, 真))
        赋值 (被选中项, 7)
    .判断 (等于 (.选中, 真))
        赋值 (被选中项, 8)
    .判断 (等于 (.选中, 真))
        赋值 (被选中项, 9)
    .判断 (等于 (.选中, 真))
        赋值 (被选中项, 10)
    .判断 (等于 (.选中, 真))
        赋值 (被选中项, 11)
    .判断 (等于 (.选中, 真))
        赋值 (被选中项, 16)
    .判断 (等于 (.选中, 真))
        赋值 (被选中项, 17)
    .判断 (等于 (.选中, 真))
        赋值 (被选中项, 21)
    .默认
        
    .判断结束
    
.如果真结束
.如果真 (或者 (等于 (_启动窗口..标题, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “库存元件显示”)), 等于 (_启动窗口..标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “维修、销售配件记录”))))
    .判断开始 (等于 (.选中, 真))
        赋值 (被选中项, 2)
    .判断 (等于 (.选中, 真))
        赋值 (被选中项, 3)
    .判断 (等于 (.选中, 真))
        赋值 (被选中项, 4)
    .判断 (等于 (.选中, 真))
        赋值 (被选中项, 9)
    .判断 (等于 (.选中, 真))
        赋值 (被选中项, 10)
    .判断 (等于 (.选中, 真))
        赋值 (被选中项, 13)
    .默认
        
    .判断结束
    
.如果真结束



.子程序 _查询窗口_创建完毕, 空白型, , 
.如果 (等于 (取数值注册项 (#本地机器, “SOFTWARE\bkl\系统资料查询权限”, ), 1)) ' 选择权限是否允许这项操作
    .判断开始 (等于 (_启动窗口..标题, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “电器维修接货记录”)))
        赋值 (.现行子夹, 0)
    .判断 (等于 (_启动窗口..标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “家电维修历史档案”)))
        赋值 (.现行子夹, 1)
    .判断 (等于 (_启动窗口..标题, 相加 (读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “库存元件显示”)))
        赋值 (.现行子夹, 2)
    .判断 (等于 (_启动窗口..标题, 相加 (到文本 (取年份 (取现行时间 ())), “年”, 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “企业信息”, “企业名称”, ), “维修、销售配件记录”)))
        赋值 (.现行子夹, 2)
    .默认
        
    .判断结束
    
.否则
    信息框 (“对不起，你没有查询资料的权限!”, 0, )
    销毁 ()
.如果结束


.子程序 _查询内容_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.未知支持库函数_20 (“在这里输入要查询的关键字,支持万能模糊查询!”, #信息图标, , , , )

.子程序 _分组框1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.未知支持库函数_20 (“在这里选择需要查询的电器类型!”, #信息图标, , , , )

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()

.窗口程序集 注册窗口, , , 

.子程序 _注册窗口_创建完毕, 空白型, , 
赋值 (.内容, 相加 (“    谢谢您使用《家电维修管理系统 v4.5》软件 ！”, #换行符, #换行符, “    尊敬的用户，如果您觉得使用本软件会给您的工作带来方便，请您尽快注册。本版本没有任何功能上的限制，但未注册版只允许使用30次。注册用户会得到本软件的永久使用权，以及良好的技术支持和服务。”, #换行符, #换行符, “    注册汇款方法：（您不需要有工商银行的帐户，银行的汇款业务就相当于在邮局汇款一样的！无需帐户）”, #换行符, #换行符, “    注册费：肆拾玖园人民币（49.00）。”, #换行符, #换行符, “    下面是注册软件的帐户信息:”, #换行符, “      帐户：4402088601100315269”, #换行符, “      持卡人：柏光林”, #换行符, “      开户行：中国工商银行四川省都江堰市支行 ”, #换行符, “      汇款时候，请附带零头，以示区别。如：49.10 元等。”, #换行符, #换行符, “    将上面的帐户信息记下，然后到工商银行，和银行的工作人员说，要汇款。他们会给您一张汇款单（和邮件汇款一样简单）按照汇款单的提示，填写上面的帐户信息。然后交给工作人员，他们会收你一元钱的手续费。汇款成功！ ”, #换行符, #换行符, “    另外，如果你在工商银行开通网络银行，可以进行网络汇款，1秒到帐！”, #换行符, “    汇款后将注册名，注册认证码（点击 帮助→注册 获得您的认证码）E-mail到 bklbklbk@public.cd.sc.cn。”, #换行符, “    我就会将您的注册码发送到您的邮箱里面。  ”, “************************************************ 版权所有：(C)光林软件　 保留所有权利。          QQ：14696383                                    E-mail: bklbklbk@public.cd.sc.cn               联系电话：(028)87121562 13618090872”))
赋值 (.内容, 登陆用户姓名)
赋值 (.内容, 到文本 (取硬盘特征字 ()))
.如果 (不等于 (到文本 (取文本注册项 (#本地机器, “SOFTWARE\bkl\家电维修管理系统v4.5 正式注册版”, )), 读配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “注册信息”, “家电维修管理系统v4.5”, “家电维修管理系统v4.5”)))
    赋值 (注册窗口., 相加 (“未注册  还有可使用”, 到文本 (未注册使用次数), “次”))
.否则
    赋值 (注册窗口., “   你是正式注册用户”)
    连续赋值 (真, .禁止, .禁止, .禁止, .禁止, .禁止)
    赋值 (.内容, “”)
.如果结束
_启动窗口.置文本 (., 1, “                  ---现在是注册窗口显示状态。---”)

.子程序 _按钮1_被单击, 空白型, , 
.如果 (等于 (.内容, “”))
    信息框 (“请输入你取得的注册码!”, 0, )
    获取焦点 ()
    返回 ()
.否则
    .如果 (并且 (等于 (.内容, 取十六进制文本 (到数值 (.内容))), 等于 (.内容, 取十六进制文本 (相乘 (到数值 (.内容), 12))), 等于 (.内容, 取十六进制文本 (相乘 (到数值 (.内容), 9)))))
        写注册项 (#本地机器, “SOFTWARE\bkl\家电维修管理系统v4.5 正式注册版”, 相加 (.内容, “-”, .内容, “-”, .内容, “-”, .内容))
        写配置项 (相加 (取当前目录 (), “\”, 登陆账册姓名, “\Baigl.ini”), “注册信息”, “家电维修管理系统v4.5”, 相加 (.内容, “-”, .内容, “-”, .内容, “-”, .内容))
        删除注册项 (#本地机器, “SOFTWARE\bkl\家电维修管理系统v4.5 未注册版”)
        赋值 (注册窗口., “   你是正式注册用户”)
        信息框 (“恭喜你注册成功！”, 0, )
        赋值 (.禁止, 真)
        销毁 ()
    .否则
        信息框 (“你输入的注册代码不正确，不能注册!”, 0, )
    .如果结束
    
.如果结束


.子程序 _注册窗口_可否被关闭, 逻辑型, , 
销毁 ()

.子程序 _按钮2_被单击, 空白型, , 
销毁 ()


 ' 不属于任何一个程序集、类模块的函数：
