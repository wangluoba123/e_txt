 ' 文件类型：Windows窗口程序

 ' 程序名称：WoW 插件管理器
 ' 程序描述：管理WoW（魔兽世界）中的插件程序。
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.2
 ' 创建号：0.29

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 1166
    高度 = 918
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 真
    最小化按钮 = 真
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 1
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\WoW插件管理器.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “魔兽世界插件管理器”
    帮助文件名 = “”

窗口 引导窗口
    左边 = 50
    顶边 = 50
    宽度 = 489
    高度 = 272
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 假
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 真
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 已保存到：D:\易语言学习\Data\WoW插件管理器.e\引导窗口_底图
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 591
    高度 = 610
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假

窗口 账号编辑窗口
    左边 = 50
    顶边 = 50
    宽度 = 411
    高度 = 186
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “账号编辑”
    帮助文件名 = “”



.图片 删除自己, " ' 已保存到：D:\易语言学习\Data\WoW插件管理器.e\删除自己", , delme.bat
.声音 准备1, " ' 已保存到：D:\易语言学习\Data\WoW插件管理器.e\准备1", , 
.声音 准备2, " ' 已保存到：D:\易语言学习\Data\WoW插件管理器.e\准备2", , 
.声音 准备3, " ' 已保存到：D:\易语言学习\Data\WoW插件管理器.e\准备3", , 
.声音 加载, " ' 已保存到：D:\易语言学习\Data\WoW插件管理器.e\加载", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' spec A512548E76954B6E92C21055517615B0 3 1 特殊功能支持库
 ' ExtMenu 9909FBB013704cfa8FE7E739DB7172DE 2 0 超级菜单支持库
 ' eAPI F7FC1AE45C5C4758AF03EF19F18A395D 3 0 应用接口支持库
 ' shellEx DA19AC3ADD2F4121AAD84AC5FBCAFC71 3 0 扩展功能支持库一
 ' shell 52F260023059454187AF826A3C07AF2A 3 0 操作系统界面功能支持库
 ' eCompress 7B68736E818E41c5A28B0AE4D43C128C 2 0 压缩解压支持库
 ' internet 707ca37322474f6ca841f0e224f4b620 2 0 互联网支持库
 ' EThread 5F99C1642A2F4e03850721B4F5D7C3F8 2 0 多线程支持库



 ' 所需要的模块
 ' 编码转换大全 C:\Documents and Settings\Administrator\桌面\编码转换大全.ec


数据类型 toc标签, , 
    .成员 标签, 文本型, , , 
    .成员 标签值, 文本型, , , 

数据类型 新版本属性, , 
    .成员 版本号, 文本型, , , 
    .成员 更新内容, 文本型, , , 
    .成员 下载地址, 文本型, , , 

数据类型 wtf标签, , 
    .成员 标签, 文本型, , , 
    .成员 标签值, 文本型, , , 


.窗口程序集 启动窗口_程序集, , , 

.程序集变量 版本号, 文本型, , , 
.程序集变量 主目录, 文本型, , , 魔兽世界目录。
.程序集变量 主窗口原标题, 文本型, , , 主窗口标题栏内容
.程序集变量 计数器1, 整数型, , , 通用计数器
.程序集变量 计数器2, 整数型, , , 通用计数器
.程序集变量 按钮返回值, 整数型, , , 
.程序集变量 多选记录, 整数型, , "0", 
.程序集变量 wtf文本分组, 文本型, , "0", 
.程序集变量 wtf文本_格式化后, wtf标签, , "0", 
.程序集变量 进程信息组, 未知类型0x50009, , "0", 
.程序集变量 许可证, 整数型, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 准备音乐, 字节集, , "0", 
.局部变量 随机音乐号, 整数型, , , 
.局部变量 版本信息, 未知类型0x50005, , , 
.局部变量 N, 整数型, , , 

 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

赋值 (进程信息组, 未知支持库函数_10 ())
.计次循环首 (取数组成员数 (进程信息组), 计数器1)
    .如果真 (等于 (进程信息组 [计数器1], , 取执行文件名 ()))
        赋值 (N, 相加 (N, 1))
    .如果真结束
    .如果真 (大于或等于 (N, 2))
        信息框 (“程序已经运行！”, #信息图标, “程序已运行！”)
        结束 ()
    .如果真结束
    
.计次循环尾 ()

 ' 本源码来自易语言资源网(www.5A5X.com)
未知支持库函数_16 (相加 (取运行目录 (), “\”, 取执行文件名 ()), 版本信息)
赋值 (版本号, 相加 (“ v”, 版本信息.))
读账号名称 ()

赋值 (_启动窗口., 相加 (_启动窗口., 版本号))
赋值 (主窗口原标题, _启动窗口.)

赋值 (_启动窗口., 假)
载入 (引导窗口, , 假)

全部删除 ()
定义插件目录 (1)


赋值 (_启动窗口., 真)

赋值 (_启动窗口., 相减 (取屏幕高度 (), 150))
_启动窗口.移动 (相除 (相减 (取屏幕宽度 (), _启动窗口.), 2), 相除 (相减 (取屏幕高度 (), _启动窗口.), 2), , )
.如果真 (大于 (_启动窗口., 取屏幕宽度 ()))
    赋值 (_启动窗口., 相减 (取屏幕宽度 (), 150))
.如果真结束
.如果真 (大于 (_启动窗口., 取屏幕高度 ()))
    赋值 (_启动窗口., 相减 (取屏幕高度 (), 150))
.如果真结束


加入成员 (准备音乐, #准备1)
加入成员 (准备音乐, #准备2)
加入成员 (准备音乐, #准备3)
 ' 本源码来自易语言资源网(www.5A5X.com)
置随机数种子 (相乘 (取小时 (取现行时间 ()), 取分钟 (取现行时间 ()), 取秒 (取现行时间 ()), 取随机数 (0, 100)))
赋值 (随机音乐号, 取随机数 (1, 3))
调试输出 (到文本 (随机音乐号))
播放音乐 (准备音乐 [随机音乐号], )


延迟 (5000)

赋值 (进程信息组, 未知支持库函数_10 ())
.计次循环首 (取数组成员数 (进程信息组), 计数器1)
    .如果真 (等于 (到小写 (进程信息组 [计数器1], ), “wow.exe”))
        调试输出 (“▲发现进程‘wow.exe’正在运行，不执行更新！”)
        赋值 (.时钟周期, 30000)
        返回 ()
    .如果真结束
    
.计次循环尾 ()
调试输出 (“▲未发现‘wow.exe’运行，开始检查更新！”)
 ' 本源码来自易语言资源网(www.5A5X.com)
赋值 (许可证, 未知支持库函数_1 ())
未知支持库函数_0 (&检查更新, , )

.子程序 __启动窗口_尺寸被改变, 空白型, , 窗口元素协调。
.局部变量 宽度temp, 整数型, , , 
.局部变量 高度temp, 整数型, , , 

赋值 (宽度temp, _启动窗口.)
赋值 (高度temp, _启动窗口.)

.移动 (相减 (宽度temp, 34), 相减 (高度temp, 118))
相减 (相除 (宽度temp, 2), 相除 (宽度temp, 2)).移动 (相除 (高度temp, 2), , )

相减 (相加 (.角度, .倾斜), .宽度).移动 ()

.子程序 定义插件目录, 空白型, , 1：不提示自动从注册表获取魔兽目录，2：提示从注册表获取魔兽目录，3：手动载入(选择wow.exe)，4：手动载入(选择插件目录)
.参数 载入方式, 整数型, 可空, 

.局部变量 枚举目录, 文本型, , , 依次枚举的单个插件目录。
.局部变量 插件目录, 文本型, , "0", 插件目录组（由于寻找文件在循环嵌套中的问题，故将枚举出的插件目录用数组导出到独立的循环中处理）。
.局部变量 传送文本, 文本型, , "0", 临时变量，用于参数传送。
.局部变量 最大长度, 整数型, , , 
.局部变量 临时信息组1, 文本型, , "0", 从toc文件中读出的未处理的信息行。
.局部变量 临时信息组2, 文本型, , "0", 从toc文件中读出的未处理的信息行。
.局部变量 信息, toc标签, , "0", toc处理最终结果。
.局部变量 toc文件名, 文本型, , , 枚举每个插件目录中的toc文件名。
.局部变量 读入的文本, 文本型, , , 读入toc文件全部内容 。
.局部变量 N, 整数型, , , 插件计数（用于避开BLZ的内置插件或非插件目录）
.局部变量 调试文本, 文本型, , , 
.局部变量 是否有描述, 逻辑型, , , 
.局部变量 版本信息, 未知类型0x50005, , , 
.局部变量 wow版本号, 文本型, , , 
.局部变量 temp, 文本型, , , 
.局部变量 常见安装目录, 文本型, , "0", 常见魔兽安装目录。

赋值 (常见安装目录, { “d:\游戏\”, “d:\网络游戏\”, “e:\游戏\”, “E:\网络游戏\” })
' 本源码来自易语言资源网(www.5A5X.com)
.如果真 (等于 (载入方式, 1)) ' -------- 自动获取魔兽安装路径
    .如果 (等于 (注册项是否存在 (#本地机器, “SOFTWARE\Blizzard Entertainment\World of Warcraft\InstallPath”), 假))
        .计次循环首 (取数组成员数 (常见安装目录), 计数器1)
            赋值 (主目录, 相加 (常见安装目录 [计数器1], “魔兽世界”))
            .如果真 (文件是否存在 (主目录))
                赋值 (主目录, 相加 (主目录, “\Interface\Addons\”))
                跳出循环 ()
            .如果真结束
            赋值 (主目录, 相加 (常见安装目录 [计数器1], “world of warcraft”))
            .如果真 (文件是否存在 (主目录))
                赋值 (主目录, 相加 (主目录, “\Interface\Addons\”))
                跳出循环 ()
            .如果真结束
            
        .计次循环尾 ()
        .如果真 (等于 (文件是否存在 (取文本左边 (主目录, 相减 (取文本长度 (主目录), 1))), 假))
            赋值 (.标题, “自动获取魔兽世界目录失败，请手动定义安装位置。”)
            赋值 (.文本颜色, #红色)
            返回 ()
            
        .如果真结束
        
    .否则
        赋值 (主目录, 取文本注册项 (#本地机器, “SOFTWARE\Blizzard Entertainment\World of Warcraft\InstallPath”, ))
        赋值 (主目录, 相加 (取文本左边 (主目录, 倒找文本 (主目录, “\”, , 假)), “Interface\Addons\”))
        
    .如果结束
    
.如果真结束

.如果真 (等于 (载入方式, 2)) ' ----------- 重载插件
    .如果真 (不等于 (信息框 (“是否需要重新载入？”, 相加 (#确认取消钮, #信息图标), “警告”), 0))
        返回 ()
    .如果真结束
    
.如果真结束

.如果真 (等于 (载入方式, 3)) ' ------------ 手动选择 wow.exe
    .如果真 (等于 (打开 (), 假))
        返回 ()
    .如果真结束
    赋值 (主目录, 相加 (取文本左边 (.文件名, 相减 (取文本长度 (.文件名), 7)), “Interface\Addons\”))
.如果真结束

.如果真 (等于 (载入方式, 4)) ' ------------ 手动选择魔兽目录
    赋值 (主目录, 未知支持库函数_2 (“请选择插件目录”, ))
    赋值 (temp, 取文本右边 (主目录, 相减 (取文本长度 (主目录), 倒找文本 (主目录, “\”, , 假))))
    .如果真 (等于 (temp, “魔兽世界”))
        赋值 (主目录, 相加 (主目录, “\Interface\Addons\”))
    .如果真结束
    .如果真 (等于 (temp, “world of warcraft”))
        赋值 (主目录, 相加 (主目录, “\Interface\Addons\”))
    .如果真结束
    .如果真 (或者 (等于 (temp, “interface”), 文件是否存在 (相加 (主目录, “\addons”))))
        赋值 (主目录, 相加 (主目录, “\Addons\”))
    .如果真结束
    .如果真 (等于 (temp, “addons”))
        赋值 (主目录, 相加 (主目录, “\”))
    .如果真结束
    
.如果真结束


全部删除 ()

赋值 (_启动窗口., 主窗口原标题)


.如果 (文件是否存在 (相加 (取文本左边 (主目录, 相减 (取文本长度 (主目录), 17)), “wow.exe”)))
    赋值 (.标题, “已成功自动获取魔兽世界目录。”)
    赋值 (.文本颜色, #蓝色)
    赋值 (_启动窗口., 相加 (_启动窗口., “  -- 魔兽世界安装目录：”, 主目录))
    赋值 (.禁止, 假)
    赋值 (.禁止, 假)
    未知支持库函数_16 (相加 (取文本左边 (主目录, 相减 (取文本长度 (主目录), 17)), “wow.exe”), 版本信息)
    赋值 (临时信息组1, 分割文本 (版本信息., “,”, ))
    .计次循环首 (取数组成员数 (临时信息组1), 计数器1)
        赋值 (wow版本号, 相加 (wow版本号, 删全部空 (临时信息组1 [计数器1]), “.”))
    .计次循环尾 ()
    赋值 (.标题, 相加 (“启动魔兽世界”, #换行符, “版本:”, 取文本左边 (wow版本号, 相减 (取文本长度 (wow版本号), 1))))
    
.否则
    .如果 (文件是否存在 (取文本左边 (主目录, 相减 (取文本长度 (主目录), 1))))
        赋值 (.标题, “已载入插件目录，但无法获取正确魔兽安装目录！”)
        赋值 (.文本颜色, #蓝色)
        
    .否则
        赋值 (.标题, “自动获取魔兽世界目录失败，请手动定义安装位置。”)
        赋值 (.文本颜色, #红色)
        
    .如果结束
    
    赋值 (_启动窗口., 主窗口原标题)
    赋值 (.禁止, 真)
    赋值 (.标题, “启动魔兽世界”)
    赋值 (.禁止, 真)
.如果结束


调试输出 (相加 (“插件目录 = ”, 主目录))

 ' -----------------------------------------------------------------
赋值 (枚举目录, 寻找文件 (相加 (主目录, “*”), 16))
.判断循环首 (不等于 (枚举目录, “”))
    赋值 (枚举目录, 寻找文件 (16))
    .如果真 (并且 (不等于 (枚举目录, “.”), 不等于 (枚举目录, “..”), 不等于 (枚举目录, “”)))
        
        加入成员 (传送文本, 枚举目录) ' 将枚举出的目录名传送到下一个循环中
        赋值 (枚举目录, 相加 (主目录, 枚举目录, “\”))
        加入成员 (插件目录, 枚举目录) ' 将枚举的插件目录用数组导出。
        
    .如果真结束
    .如果真 (大于 (取文本长度 (枚举目录), 最大长度))
        赋值 (最大长度, 取文本长度 (枚举目录))
        
    .如果真结束
    
.判断循环尾 ()


.计次循环首 (取数组成员数 (插件目录), 计数器1)
    赋值 (toc文件名, 寻找文件 (相加 (插件目录 [计数器1], “*.toc”), 32))
    
    .如果真 (不等于 (toc文件名, “”)) ' =============== 判断是否为有效的插件目录
        .插入表项 (传送文本 [计数器1], , , , )
    .如果真结束
    
.计次循环尾 ()

.计次循环首 (取数组成员数 (插件目录), 计数器1)
    赋值 (toc文件名, 寻找文件 (相加 (插件目录 [计数器1], “*.toc”), 32))
    赋值 (调试文本, “”)
    .如果真 (不等于 (toc文件名, “”))
        赋值 (N, 相加 (N, 1))
        
        清除数组 (临时信息组1)
        清除数组 (临时信息组2)
        清除数组 (信息)
        赋值 (读入的文本, UTF8到Ansi (去掉文件头 (读入文件 (相加 (主目录, 传送文本 [计数器1], “\”, toc文件名))))) ' ==============  .toc源文件为 utf-8 编码，用‘近在眼前’的转换模块转换为 ansi 编码。
        
        赋值 (临时信息组1, 分割文本 (读入的文本, 字符 (10), )) ' ============== 用换行符‘字符(10)’分割文本
        
        .计次循环首 (取数组成员数 (临时信息组1), 计数器2) ' ============= 取出有效标签
            
            .如果真 (等于 (取文本左边 (临时信息组1 [计数器2], 2), “##”))
                赋值 (临时信息组1 [计数器2], 删首空 (取文本右边 (临时信息组1 [计数器2], 相减 (取文本长度 (临时信息组1 [计数器2]), 2))))
                加入成员 (临时信息组2, 临时信息组1 [计数器2])
            .如果真结束
            
        .计次循环尾 ()
        
        .计次循环首 (取数组成员数 (临时信息组2), 计数器2)
            重定义数组 (信息, 真, 取数组成员数 (临时信息组2))
            
            赋值 (信息 [计数器2], 标签, 删首尾空 (取文本左边 (临时信息组2 [计数器2], 相减 (寻找文本 (临时信息组2 [计数器2], “:”, , 假), 1))))
            赋值 (信息 [计数器2], 标签值, 到文本 (删首尾空 (取文本右边 (临时信息组2 [计数器2], 相减 (取文本长度 (临时信息组2 [计数器2]), 寻找文本 (临时信息组2 [计数器2], “:”, , 假))))))
            
            .如果真 (或者 (等于 (取文本右边 (信息 [计数器2], 标签值, 1), 字符 (10)), 等于 (取文本右边 (信息 [计数器2], 标签值, 1), 字符 (13))))
                赋值 (信息 [计数器2], 标签值, 取文本左边 (信息 [计数器2], 标签值, 相减 (取文本长度 (信息 [计数器2], 标签值), 1)))
                 ' =============== 去除在Windows 2000系统中读出的文本右边的换行符("□") ===============
            .如果真结束
            
        .计次循环尾 ()
        
        赋值 (是否有描述, 假)
        .计次循环首 (取数组成员数 (信息), 计数器2)
            
            .如果真 (等于 (信息 [计数器2], 标签, “Title”))
                相减 (N, 1).置标题 (1, 处理颜色代码 (信息 [计数器2], 标签值))
                
            .如果真结束
            .如果真 (等于 (信息 [计数器2], 标签, “Notes-zhCN”))
                相减 (N, 1).置标题 (2, 处理颜色代码 (信息 [计数器2], 标签值))
                赋值 (是否有描述, 真)
            .如果真结束
            .如果真 (等于 (信息 [计数器2], 标签, “SavedVariables”))
                相减 (N, 1).置标题 (3, 信息 [计数器2], 标签值)
                
            .如果真结束
            .如果真 (等于 (信息 [计数器2], 标签, “Version”))
                相减 (N, 1).置标题 (4, 信息 [计数器2], 标签值)
                
            .如果真结束
            .如果真 (等于 (信息 [计数器2], 标签, “Interface”))
                相减 (N, 1).置标题 (5, 信息 [计数器2], 标签值)
                
            .如果真结束
            
            
            
            
            
            
            
            
            
             ' 扩充...............
            
        .计次循环尾 ()
        
         ' .如果真 (等于 (相减 (N, 1).取标题 (2), “”))
             ' 信息框 (到文本 (N － 1) ＋ “.” ＋ 到文本 (计数器2) ＋ “，” ＋ 超级列表框1.取标题 (N － 1, 1) ＋ “ --- ” ＋ 超级列表框1.取标题 (N － 1, 2) ＋ “ --- ” ＋ 超级列表框1.取标题 (N － 1, 3) ＋ “ --- ” ＋ 超级列表框1.取标题 (N － 1, 4), 0, )
            
             ' .计次循环首 (取数组成员数 (信息), 计数器2)
                 ' 调试文本 ＝ 调试文本 ＋ 信息 [计数器2].标签 ＋ “ = ” ＋ 信息 [计数器2].标签值 ＋ #换行符
             ' .计次循环尾 ()
             ' 信息框 (调试文本, 0, )
        .如果真结束
        .如果真 (等于 (是否有描述, 假))
            .计次循环首 (取数组成员数 (信息), 计数器2)
                .如果真 (等于 (信息 [计数器2], 标签, “Title-zhCN”))
                    调试输出 (处理颜色代码 (信息 [计数器2], 标签值))
                    相减 (N, 1).置标题 (2, 处理颜色代码 (信息 [计数器2], 标签值))
                .如果真结束
                
            .计次循环尾 ()
        .如果真结束
        
    .如果真结束
    
    
.计次循环尾 ()


.如果真 (大于 (最大长度, 13))
    0.置列宽 (相加 (0.取列宽 (), 相乘 (相减 (最大长度, 13), 6)))
.如果真结束
0.置列标题 (相加 (“插件目录”, “ (”, 到文本 (N), “)”))
.如果真 (大于 (0.取列宽 (), 200))
    0.置列宽 (200)
.如果真结束



.子程序 _超级列表框1_右键单击表项, 空白型, , 
.局部变量 选中位置, 整数型, , "0", 记录列表框中被选中项的位置索引。

赋值 (选中位置, 取被选择表项 ())

.如果真 (等于 (取数组成员数 (选中位置), 0))
    返回 ()
.如果真结束

赋值 (.标题, 相加 (“百度搜索 ”, #引号, 选中位置.取标题 ( [1], 0), #引号))
赋值 (.标题, 相加 (“将插件 ”, #引号, 选中位置.取标题 ( [1], 0), #引号, “ 添加到ZIP压缩包”))

弹出菜单 ()


.子程序 _查看toc文件_被选择, 空白型, , 菜单命令
查看功能 ()

.子程序 查看功能, 空白型, , 
.参数 查看方式, 整数型, 可空, 为空或0时为查看.toc文件，为1时为查看插件目录。

.局部变量 选中位置, 整数型, , "0", 记录列表框中被选中项的位置索引。
.局部变量 c, 文本型, , , 
.局部变量 toc文件, 文本型, , , 


.计次循环首 (取已选择表项数 (), 计数器1)
    
    赋值 (选中位置, 取被选择表项 ())
    
    赋值 (c, 相加 (主目录, 选中位置.取标题 ( [计数器1], )))
    
    赋值 (toc文件, 寻找文件 (相加 (c, “\*.toc”), 32))
    
    .判断开始 (或者 (等于 (查看方式, 0), 等于 (查看方式, 到数值 (“”))))
        .如果真 (不等于 (toc文件, “”))
            赋值 (toc文件, 相加 (c, “\”, toc文件))
            .如果真 (等于 (运行 (相加 (读环境变量 (“programfiles”), “\EmEditor\EmEditor.exe ”, toc文件), 假, ), 假))
                运行 (相加 (读环境变量 (“windir”), “\system32\notepad.exe ”, toc文件), 假, )
            .如果真结束
            
        .如果真结束
        
    .判断 (等于 (查看方式, 1))
        运行 (相加 (读环境变量 (“windir”), “\explorer.exe ”, c), 假, )
    .默认
        
    .判断结束
    
    
.计次循环尾 ()


.子程序 _超级列表框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_查看toc文件_被选择 ()
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _超级链接框1_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (.标题, “自动获取魔兽世界目录失败，请手动定义安装位置。”))
    弹出菜单 ()
    
.否则
    定义插件目录 (2)
    
.如果结束



.子程序 处理颜色代码, 文本型, , 用于删除.toc文件中的颜色代码，（例：“##Title: |cff0000ff我的插件|r”，处理后为：“##Title:我的插件”）
.参数 输入字符串, 文本型, , 

.判断循环首 (或者 (不等于 (寻找文本 (输入字符串, “|c”, , 假), -1), 不等于 (寻找文本 (输入字符串, “|r”, , 假), -1))) ' =========== 循环防止有多个颜色 ===========
    
    .如果真 (不等于 (寻找文本 (输入字符串, “|c”, , 假), -1))
        赋值 (输入字符串, 文本替换 (输入字符串, 寻找文本 (输入字符串, “|c”, , 假), 10, ))
    .如果真结束
    
    .如果真 (不等于 (寻找文本 (输入字符串, “|r”, , 假), -1))
        赋值 (输入字符串, 文本替换 (输入字符串, 寻找文本 (输入字符串, “|r”, , 假), 2, ))
    .如果真结束
    ' 本源码来自易语言资源网(www.5A5X.com)
.判断循环尾 ()
返回 (输入字符串)


.子程序 _查看插件目录_被选择, 空白型, , 
查看功能 (1)


.子程序 _超级列表框1_表头被单击, 空白型, , 
.参数 被单击列索引, 整数型, , 


弹出菜单 ()


.子程序 _指定wowexe文件_被选择, 空白型, , 
定义插件目录 (3)
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _指定插件目录_被选择, 空白型, , 
定义插件目录 (4)


.子程序 _超级链接框1_鼠标右键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

弹出菜单 ()


.子程序 _清空列表_被选择, 空白型, , 
全部删除 ()

赋值 (_启动窗口., 主窗口原标题)


.子程序 _删除该插件_被选择, 空白型, , 
.局部变量 选中位置, 整数型, , "0", 
.局部变量 多选删除提示文本, 文本型, , , 

赋值 (.选中, 真)
关闭所有文件 ()

.如果 (小于或等于 (取数组成员数 (多选记录), 1))
    赋值 (选中位置, 取被选择表项 ())
    
    .如果真 (小于 (取数组成员数 (选中位置), 1))
        返回 ()
    .如果真结束
     ' 本源码来自易语言资源网(www.5A5X.com)
    .如果真 (等于 (信息框 (相加 (“该操作将删除插件>> ”, 选中位置.取标题 ( [1], ), “ <<，确认要删除此插件吗？”, #换行符, #换行符, “目录为:”, #换行符, 主目录, 选中位置.取标题 ( [1], )), 相加 (#警告图标, #确认取消钮), 相加 (“确定要删除插件 ”, 选中位置.取标题 ( [1], ), “ 吗？”)), 0))
        .如果 (删除目录 (相加 (主目录, 选中位置.取标题 ( [1], ))))
            选中位置.置标题 ( [1], 0, 相加 (“【★已删除★】”, 选中位置.取标题 ( [1], )))
            赋值 (.标题, “点我刷新列表！”)
        .否则
            信息框 (“删除失败！”, #警告图标, “错误！”)
        .如果结束
        
    .如果真结束
    
.否则
    赋值 (多选删除提示文本, 相加 (“您选中了 ”, 到文本 (取数组成员数 (多选记录)), “ 个插件：”, #换行符, “-------------------------------”, #换行符))
    .计次循环首 (取数组成员数 (多选记录), 计数器1)
        赋值 (多选删除提示文本, 相加 (多选删除提示文本, “【”, 到文本 (计数器1), “-”, 到文本 (多选记录 [计数器1]), “】--- ”, 多选记录.取标题 ( [计数器1], ), #换行符))
        
        .如果真 (大于 (计数器1, 9))
            赋值 (多选删除提示文本, 相加 (多选删除提示文本, #换行符, “    ......”, #换行符))
            跳出循环 ()
        .如果真结束
        ' 本源码来自易语言资源网(www.5A5X.com)
    .计次循环尾 ()
    赋值 (多选删除提示文本, 相加 (多选删除提示文本, “-------------------------------”, #换行符, “删除它们将无法恢复，确认删除它们吗？”))
    .如果真 (等于 (信息框 (多选删除提示文本, 相加 (#确认取消钮, #警告图标), 相加 (“确认要删除这 ”, 到文本 (取数组成员数 (多选记录)), “ 个插件吗？”)), 0))
        .计次循环首 (取数组成员数 (多选记录), 计数器1)
            信息框 (相加 (主目录, 多选记录.取标题 ( [计数器1], )), 0, )
            .如果 (删除目录 (相加 (主目录, 多选记录.取标题 ( [计数器1], ))))
                多选记录.置标题 ( [计数器1], 0, 相加 (“【★已删除★】”, 多选记录.取标题 ( [计数器1], )))
                赋值 (.标题, “点我刷新列表！”)
                赋值 (., #蓝色)
            .否则
                信息框 (“删除失败！”, #警告图标, “错误！”)
            .如果结束
            
        .计次循环尾 ()
    .如果真结束
    
.如果结束


赋值 (.选中, 假)
_超级列表框1_失去焦点 ()

.子程序 _超级列表框1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.局部变量 提示文本, 文本型, , , 
.局部变量 提示文本行数, 整数型, , , 
.局部变量 选中位置, 整数型, , "0", 记录列表框中被选中项的位置索引。
.局部变量 目录, 文本型, , , 
.局部变量 toc文件名, 文本型, , , 
.局部变量 文件号, 整数型, , , 
.局部变量 文本分割分组, 文本型, , "0", 
.局部变量 序号, 文本型, , , 

.如果真 (大于或等于 (取屏幕高度 (), 900))
    赋值 (提示文本行数, 25)
.如果真结束
.如果真 (并且 (大于或等于 (取屏幕高度 (), 800), 小于 (取屏幕高度 (), 900)))
    赋值 (提示文本行数, 15)
.如果真结束
.如果真 (小于或等于 (取屏幕高度 (), 700))
    赋值 (提示文本行数, 10)
.如果真结束

赋值 (选中位置, 取被选择表项 ())

.如果真 (小于 (取数组成员数 (选中位置), 1))
    返回 ()
.如果真结束

.计次循环首 (取已选择表项数 (), 计数器1)
    
    赋值 (目录, 相加 (主目录, 选中位置.取标题 ( [1], )))
    
    赋值 (toc文件名, 寻找文件 (相加 (目录, “\*.toc”), 32))
    
    .如果真 (不等于 (toc文件名, “”))
        赋值 (toc文件名, 相加 (目录, “\”, toc文件名))
        
    .如果真结束
    
.计次循环尾 ()

赋值 (提示文本, UTF8到Ansi (去掉文件头 (读入文件 (toc文件名))))

赋值 (文本分割分组, 分割文本 (提示文本, 字符 (10), 提示文本行数))

赋值 (提示文本, 相加 (toc文件名, #换行符, “=========================================================”, #换行符))

.计次循环首 (取数组成员数 (文本分割分组), 计数器1)
    .如果 (小于 (计数器1, 10))
        赋值 (序号, 相加 (到文本 (计数器1), “  ”))
        
    .否则
        赋值 (序号, 到文本 (计数器1))
    .如果结束
    赋值 (提示文本, 相加 (提示文本, 序号, “ --- ”, 文本分割分组 [计数器1], 字符 (10)))
.计次循环尾 ()

未知支持库函数_0 (取窗口句柄 (), 相加 (提示文本, #换行符, “                  ......”), 假, 假)
关闭所有文件 ()

.子程序 去掉文件头, 字节集, , 去掉文本编码识别符。
.参数 待处理数据, 字节集, , 

.如果真 (等于 (取字节集左边 (待处理数据, 3), { 239, 187, 191 }))
    返回 (字节集替换 (待处理数据, 1, 3, ))
.如果真结束
.如果真 (或者 (等于 (取字节集左边 (待处理数据, 2), { 255, 255 }), 等于 (取字节集左边 (待处理数据, 2), { 255, 254 }), 等于 (取字节集左边 (待处理数据, 2), { 239, 187 })))
    返回 (字节集替换 (待处理数据, 1, 2, ))
.如果真结束

返回 (待处理数据)




.子程序 _启动魔兽_被单击, 空白型, , 
写wtf ()

.如果真 (文件是否存在 (相加 (取文本左边 (主目录, 相减 (取文本长度 (主目录), 17)), “wow.exe”)))
    赋值 (_启动窗口., 2)
    运行 (相加 (取文本左边 (主目录, 相减 (取文本长度 (主目录), 17)), “wow.exe”), 假, )
.如果真结束
' 本源码来自易语言资源网(www.5A5X.com)


.子程序 _百度搜索_被选择, 空白型, , 
.局部变量 选中位置, 整数型, , "0", 记录列表框中被选中项的位置索引。

赋值 (选中位置, 取被选择表项 ())

运行 (相加 (读环境变量 (“programfiles”), “\Internet Explorer\iexplore.exe ”, “http://www.baidu.com/s?wd=”, 选中位置.取标题 ( [1], 0)), 假, )


.子程序 _超级列表框1_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (键代码, #Del键))
    _删除该插件_被选择 ()
.如果真结束


.子程序 _超级列表框1_检查框状态被改变, 空白型, , 记录多选行。
.参数 表项索引, 整数型, , 
.参数 检查框状态, 整数型, , 

.如果真 (等于 (取文本左边 (表项索引.取标题 (0), 14), “【★已删除★】”))
    表项索引.置状态图片 (0)
    返回 ()
.如果真结束
' 本源码来自易语言资源网(www.5A5X.com)

.如果真 (等于 (检查框状态, 1))
    加入成员 (多选记录, 表项索引)
     ' 调试输出 (到文本 (表项索引) ＋ “ -- ” ＋ 到文本 (检查框状态) ＋ “ -- ” ＋ 到文本 (取数组成员数 (多选记录)))
.如果真结束
.如果真 (等于 (检查框状态, 0))
    .计次循环首 (取数组成员数 (多选记录), 计数器1)
        .如果真 (等于 (表项索引, 多选记录 [计数器1]))
            删除成员 (多选记录, 计数器1, )
        .如果真结束
        
    .计次循环尾 ()
.如果真结束


.子程序 _超级列表框1_失去焦点, 空白型, , 失去焦点时清除多选记录。
.如果真 (等于 (.选中, 真))
    返回 ()
.如果真结束
.计次循环首 (取数组成员数 (多选记录), 计数器1)
    多选记录.置状态图片 ( [计数器1], 0)
.计次循环尾 ()

清除数组 (多选记录)


.子程序 _插件打包_被选择, 空白型, , 
.局部变量 临时目录, 文本型, , , 


.如果真 (等于 (信息框 (相加 (“确认要将插件 -”, .取标题 (., ), “- 添加到ZIP压缩包吗？”), 相加 (#确认取消钮, #询问图标), “确定要将插件打包吗？”), 0))
    赋值 (临时目录, 到文本 (取随机数 (100, 9999)))
    创建目录 (相加 (读环境变量 (“temp”), “\”, 临时目录))
    创建目录 (相加 (读环境变量 (“temp”), “\”, 临时目录, “\”, .取标题 (., )))
    调试输出 (相加 (读环境变量 (“temp”), “\”, 临时目录))
    赋值 (.可视, 真)
    相加 (主目录, .取标题 (., ), “\”).未知支持库函数_0 (相加 (读环境变量 (“temp”), “\”, 临时目录, “.zip”))
    相加 (读环境变量 (“temp”), “\”, 临时目录, “.zip”).未知支持库函数_2 (相加 (读环境变量 (“temp”), “\”, 临时目录, “\”, .取标题 (., )))
    删除文件 (相加 (读环境变量 (“temp”), “\”, 临时目录, “.zip”))
    
    
    赋值 (.文件名, 相加 (.取标题 (., ), “.zip”))
    
    .如果真 (等于 (打开 (), 真))
        
        .如果真 (等于 (相加 (读环境变量 (“temp”), “\”, 临时目录).未知支持库函数_0 (.文件名), 1))
            删除目录 (相加 (读环境变量 (“temp”), “\”, 临时目录))
            赋值 (.可视, 假)
        .如果真结束
        .如果真 (等于 (信息框 (相加 (“打包完成！”, #换行符, “点击”, #引号, “确定”, #引号, “查看文件。”), 相加 (#信息图标, #确认取消钮), “成功”), 0))
            运行 (相加 (“explorer.exe ”, .文件名), 假, )
        .如果真结束
        
    .如果真结束
    
.如果真结束


.子程序 _ZIP压缩1_压缩进度, 逻辑型, , 
.参数 已完成百分比, 整数型, , 

赋值 (.位置, 已完成百分比)

.子程序 读账号名称, 空白型, , 
.局部变量 计数器3, 整数型, , , 

清空 ()
“”.加入项目 ()
.计次循环首 (10, 计数器1)
    .如果真 (注册项是否存在 (#本地机器, 相加 (“software\WoWaddons\”, 到文本 (计数器1), “\”)))
        取文本注册项 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器1), “\1_1”), ).加入项目 ()
    .如果真结束
    
.计次循环尾 ()
“添加新账号...”.加入项目 ()
' 本源码来自易语言资源网(www.5A5X.com)

赋值 (wtf文本分组, 分割文本 (UTF8到Ansi (读入文件 (相加 (取文本注册项 (#本地机器, “SOFTWARE\Blizzard Entertainment\World of Warcraft\InstallPath”, ), “wtf\config.wtf”))), 字符 (10), ))
关闭所有文件 ()
.计次循环首 (取数组成员数 (wtf文本分组), 计数器1) ' 把config.wtf中内容分组存到数组 _wtf文本_格式化后_ 中。
    重定义数组 (wtf文本_格式化后, 真, 取数组成员数 (wtf文本分组))
    赋值 (wtf文本_格式化后 [计数器1], 标签, 取文本左边 (wtf文本分组 [计数器1], 相减 (寻找文本 (wtf文本分组 [计数器1], #引号, , 假), 2)))
    赋值 (wtf文本_格式化后 [计数器1], 标签值, 取文本左边 (取文本右边 (wtf文本分组 [计数器1], 相减 (取文本长度 (wtf文本分组 [计数器1]), 寻找文本 (wtf文本分组 [计数器1], #引号, , 假))), 相减 (取文本长度 (取文本右边 (wtf文本分组 [计数器1], 相减 (取文本长度 (wtf文本分组 [计数器1]), 寻找文本 (wtf文本分组 [计数器1], #引号, , 假)))), 2)))
.计次循环尾 ()
.计次循环首 (取数组成员数 (wtf文本分组), 计数器1)
    .如果真 (等于 (wtf文本_格式化后 [计数器1], 标签, “SET AccountName”))
        .计次循环首 (相减 (取项目数 (), 2), 计数器3)
             ' 信息框 (wtf文本_格式化后 [计数器1].标签值 ＋ “ , ” ＋ 取文本注册项 (#本地机器, “software\wowaddons\” ＋ 到文本 (计数器3) ＋ “\1_2”, ), 0, )
            .如果真 (等于 (wtf文本_格式化后 [计数器1], 标签值, 取文本注册项 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器3), “\1_2”), )))
                赋值 (.现行选中项, 计数器3)
            .如果真结束
            
        .计次循环尾 ()
    .如果真结束
    
.计次循环尾 ()


.子程序 _组合框1_列表项被选择, 空白型, , 
.如果真 (等于 (.取项目文本 (.现行选中项), “添加新账号...”))
    载入 (账号编辑窗口, _启动窗口, 真)
.如果真结束



.子程序 写wtf, 空白型, , 
.局部变量 是否存在, 逻辑型, , , 
.局部变量 文本处理结果, 文本型, , , 


赋值 (wtf文本分组, 分割文本 (UTF8到Ansi (读入文件 (相加 (取文本注册项 (#本地机器, “SOFTWARE\Blizzard Entertainment\World of Warcraft\InstallPath”, ), “wtf\config.wtf”))), 字符 (10), ))
关闭所有文件 ()
.计次循环首 (取数组成员数 (wtf文本分组), 计数器1) ' 把config.wtf中内容分组存到数组 _wtf文本_格式化后_ 中。
    重定义数组 (wtf文本_格式化后, 真, 取数组成员数 (wtf文本分组))
    赋值 (wtf文本_格式化后 [计数器1], 标签, 取文本左边 (wtf文本分组 [计数器1], 相减 (寻找文本 (wtf文本分组 [计数器1], #引号, , 假), 2)))
    赋值 (wtf文本_格式化后 [计数器1], 标签值, 取文本左边 (取文本右边 (wtf文本分组 [计数器1], 相减 (取文本长度 (wtf文本分组 [计数器1]), 寻找文本 (wtf文本分组 [计数器1], #引号, , 假))), 相减 (取文本长度 (取文本右边 (wtf文本分组 [计数器1], 相减 (取文本长度 (wtf文本分组 [计数器1]), 寻找文本 (wtf文本分组 [计数器1], #引号, , 假)))), 1)))
.计次循环尾 ()
赋值 (是否存在, 假)
.计次循环首 (取数组成员数 (wtf文本分组), 计数器1)
    .如果真 (等于 (wtf文本_格式化后 [计数器1], 标签, “SET AccountName”))
        赋值 (是否存在, 真)
        .计次循环首 (10, 计数器2)
             ' 信息框 (“1.” ＋ 取文本注册项 (#本地机器, “software\wowaddons\” ＋ 到文本 (计数器2) ＋ “\1_1”, ) ＋ #换行符 ＋ “2.” ＋ 组合框1.取项目文本 (组合框1.现行选中项), 0, )
            .如果真 (等于 (取文本注册项 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器2), “\1_1”), ), .取项目文本 (.现行选中项)))
                赋值 (wtf文本_格式化后 [计数器1], 标签值, 取文本注册项 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器2), “\1_2”), ))
            .如果真结束
            
        .计次循环尾 ()
    .如果真结束
    
.计次循环尾 ()
.如果真 (等于 (是否存在, 假))
    重定义数组 (wtf文本_格式化后, 真, 相加 (取数组成员数 (wtf文本_格式化后), 1))
    赋值 (wtf文本_格式化后 [取数组成员数 (wtf文本_格式化后)].标签, “SET AccountName”)
    .计次循环首 (10, 计数器1)
        .如果真 (等于 (取文本注册项 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器1), “\1_1”), ), .取项目文本 (.现行选中项)))
            赋值 (wtf文本_格式化后 [取数组成员数 (wtf文本_格式化后)].标签值, 取文本注册项 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器1), “\1_2”), ))
        .如果真结束
        
    .计次循环尾 ()
.如果真结束

.计次循环首 (取数组成员数 (wtf文本_格式化后), 计数器1)
    赋值 (文本处理结果, 相加 (文本处理结果, wtf文本_格式化后 [计数器1], 标签, “ ”, #引号, wtf文本_格式化后 [计数器1], 标签值, #引号, 字符 (10)))
.计次循环尾 ()

写到文件 (相加 (取文本注册项 (#本地机器, “SOFTWARE\Blizzard Entertainment\World of Warcraft\InstallPath”, ), “wtf\config.wtf”), Ansi到UTF8 (文本处理结果))


.子程序 _图片框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (.禁止, 假))
    运行 (相加 (“explorer.exe ”, 取文本左边 (主目录, 相减 (取文本长度 (主目录), 17))), 假, )
.如果真结束


.子程序 _图片框1_鼠标位置被移动, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

未知支持库函数_0 (取窗口句柄 (), 相加 (“双击打开魔兽世界目录。”, #换行符, “---------------安装目录--------------”, #换行符, 取文本左边 (主目录, 相减 (取文本长度 (主目录), 17))), 假, 假)


.子程序 删首尾换行符, 文本型, , 删除文本首尾换行符及空格。
.参数 被处理文本, 文本型, , 

.局部变量 文本缓存, 文本型, , , 

赋值 (文本缓存, 被处理文本)
.判断循环首 (或者 (等于 (取文本左边 (文本缓存, 1), 字符 (10)), 等于 (取文本左边 (文本缓存, 1), 字符 (13)), 等于 (取文本左边 (文本缓存, 1), “ ”)))
    赋值 (文本缓存, 取文本右边 (文本缓存, 相减 (取文本长度 (文本缓存), 1)))
.判断循环尾 ()
.判断循环首 (或者 (等于 (取文本右边 (文本缓存, 1), 字符 (10)), 等于 (取文本右边 (文本缓存, 1), 字符 (13)), 等于 (取文本左边 (文本缓存, 1), “ ”)))
    赋值 (文本缓存, 取文本左边 (文本缓存, 相减 (取文本长度 (文本缓存), 1)))
    
.判断循环尾 ()
返回 (文本缓存)


.子程序 检查更新, 空白型, , 
.局部变量 文件号, 整数型, , , 
.局部变量 文本分组, 文本型, , "0", 
.局部变量 标识, 文本型, , , 
.局部变量 更新下载地址, 文本型, , , 
.局部变量 结果, 逻辑型, , , 
.局部变量 新版本, 新版本属性, , , 
.局部变量 临时文件名, 文本型, , , 

未知支持库函数_3 (许可证)
调试输出 (“▲开始检查更新！”)

赋值 (更新下载地址, “http://wow-plugin-manager.googlecode.com/files/update.txt”)

删除文件 (相加 (取运行目录 (), “\update.txt”))
写到文件 (相加 (取运行目录 (), “\update.txt”), 未知支持库函数_7 (更新下载地址))

.如果真 (小于 (取文件尺寸 (相加 (取运行目录 (), “\update.txt”)), 5))
    调试输出 (“▲读取更新列表失败！请检查网络连接。”)
    返回 ()
.如果真结束
调试输出 (“▲读取更新档成功！”)


赋值 (文件号, 打开文件 (相加 (取运行目录 (), “\update.txt”), , ))

.如果真 (等于 (文件号, 0))
    调试输出 (“▲更新档文件打开失败！”)
    信息框 (“更新档文件打开失败！”, 0, )
    返回 ()
.如果真结束
调试输出 (“▲打开更新档文件成功！”)


赋值 (文本分组, 分割文本 (读入文本 (文件号, 取文件尺寸 (相加 (取运行目录 (), “\update.txt”))), “★”, ))

关闭所有文件 ()
删除文件 (相加 (取运行目录 (), “\update.txt”))

.计次循环首 (取数组成员数 (文本分组), 计数器1)
    赋值 (标识, 取文本左边 (删首尾换行符 (文本分组 [计数器1]), 8))
    赋值 (文本分组 [计数器1], 删首尾换行符 (文本分组 [计数器1]))
    .如果真 (等于 (标识, “更新说明”))
        赋值 (新版本.更新内容, 删首尾换行符 (取文本右边 (文本分组 [计数器1], 相减 (取文本长度 (文本分组 [计数器1]), 10))))
    .如果真结束
    .如果真 (等于 (标识, “最新版本”))
        赋值 (新版本.版本号, 删首尾换行符 (取文本右边 (文本分组 [计数器1], 相减 (取文本长度 (文本分组 [计数器1]), 10))))
    .如果真结束
    .如果真 (等于 (标识, “下载地址”))
        赋值 (新版本.下载地址, 删首尾换行符 (取文本右边 (文本分组 [计数器1], 相减 (取文本长度 (文本分组 [计数器1]), 10))))
    .如果真结束
    
.计次循环尾 ()

.如果真 (版本比较 (版本号, 新版本.版本号))
    置随机数种子 (相乘 (取秒 (取现行时间 ()), 取分钟 (取现行时间 ())))
    赋值 (临时文件名, 到文本 (取随机数 (1000, 9999)))
    
    写到文件 (相加 (读环境变量 (“temp”), “\”, 临时文件名, “.zip”), 未知支持库函数_7 (新版本.下载地址))
    
    .如果真 (大于 (取文件尺寸 (相加 (读环境变量 (“temp”), “\”, 临时文件名, “.zip”)), 5))
        调试输出 (“▲更新程序下载成功！”)
    .如果真结束
    
    .如果真 (等于 (信息框 (相加 (“发现新版本！”, #换行符, #换行符, “-----------------------------------------------------”, #换行符, 新版本.更新内容, #换行符, “-----------------------------------------------------”, #换行符, “当前版本：v”, 版本号, #换行符, “最新版本：v”, 新版本.版本号, #换行符, #换行符, “点击‘确定’更新到最新版本！”), 相加 (#确认取消钮, #信息图标), “发现新版本”), 0))
        
        创建目录 (相加 (读环境变量 (“temp”), “\”, 临时文件名))
        相加 (读环境变量 (“temp”), “\”, 临时文件名, “.zip”).未知支持库函数_2 (相加 (读环境变量 (“temp”), “\”, 临时文件名))
        
        .如果真 (复制文件 (相加 (读环境变量 (“temp”), “\”, 临时文件名, “\WoW插件管理器.exe”), 相加 (取运行目录 (), “\temp”)))
            删除目录 (相加 (读环境变量 (“temp”), “\”, 临时文件名))
            删除文件 (相加 (读环境变量 (“temp”), “\”, 临时文件名, “.zip”))
            
            写到文件 (相加 (取运行目录 (), “\delme.bat”), #删除自己)
            .如果真 (文件是否存在 (相加 (取运行目录 (), “\delme.bat”)))
                信息框 (“点击‘确定’重启程序升级到最新版本。”, #信息图标, “提示”)
                运行 (相加 (取运行目录 (), “\delme.bat ”, 取执行文件名 ()), 假, )
                销毁 ()
            .如果真结束
            
        .如果真结束
        
    .如果真结束
    
.如果真结束




删除目录 (相加 (读环境变量 (“temp”), “\”, 临时文件名))
删除文件 (相加 (读环境变量 (“temp”), “\”, 临时文件名, “.zip”))


未知支持库函数_2 (许可证)


.子程序 版本比较, 逻辑型, , 为真时有新版本，需更新。
.参数 本地版本号, 文本型, , 
.参数 网络版本号, 文本型, , 

.局部变量 本地版本号分组, 文本型, , "0", 
.局部变量 网络版本号分组, 文本型, , "0", 
.局部变量 tmp, 整数型, , , 
.局部变量 内部计数器1, 整数型, , , 
.局部变量 内部计数器2, 整数型, , , 


赋值 (本地版本号, 删首尾空 (本地版本号))
赋值 (网络版本号, 删首尾空 (网络版本号))

.判断开始 (等于 (到小写 (取文本左边 (本地版本号, 1)), “v”))
    赋值 (本地版本号, 取文本右边 (本地版本号, 相减 (取文本长度 (本地版本号), 1)))
.默认
    
.判断结束
.判断开始 (等于 (到小写 (取文本左边 (网络版本号, 1)), “v”))
    赋值 (网络版本号, 取文本右边 (网络版本号, 相减 (取文本长度 (网络版本号), 1)))
.默认
    
.判断结束

赋值 (本地版本号分组, 分割文本 (本地版本号, “.”, ))
赋值 (网络版本号分组, 分割文本 (网络版本号, “.”, ))


.如果 (小于或等于 (取数组成员数 (本地版本号分组), 取数组成员数 (网络版本号分组)))
    赋值 (tmp, 取数组成员数 (本地版本号分组))
.否则
    赋值 (tmp, 取数组成员数 (网络版本号分组))
.如果结束

.计次循环首 (tmp, 内部计数器1)
    
    .如果真 (大于 (到数值 (网络版本号分组 [内部计数器1]), 到数值 (本地版本号分组 [内部计数器1])))
        返回 (真)
    .如果真结束
    .如果真 (小于 (到数值 (网络版本号分组 [内部计数器1]), 到数值 (本地版本号分组 [内部计数器1])))
        返回 (假)
    .如果真结束
    
.计次循环尾 ()
.如果真 (小于 (取数组成员数 (本地版本号分组), 取数组成员数 (网络版本号分组)))
    
    返回 (真)
.如果真结束

返回 (假)




.子程序 _时钟1_周期事件, 空白型, , 
赋值 (进程信息组, 未知支持库函数_10 ())
.计次循环首 (取数组成员数 (进程信息组), 计数器1)
    .如果真 (等于 (到小写 (进程信息组 [计数器1], ), “wow.exe”))
        调试输出 (“▲发现‘wow.exe’正在运行，30 秒后重新检测！”)
        返回 ()
    .如果真结束
    
.计次循环尾 ()
调试输出 (“▲未发现‘wow.exe’运行，3 秒后开始检查更新。”)
延迟 (3000)
未知支持库函数_0 (&检查更新, , )
赋值 (.时钟周期, 0)


.窗口程序集 载入窗口_程序集, , , 

.程序集变量 颜色数组, 整数型, , "0", 
.程序集变量 计数器, 整数型, , , 
.程序集变量 开始, 逻辑型, , , 
.子程序 _时钟1_周期事件, 空白型, , 
.如果真 (等于 (_启动窗口., 真))
    赋值 (开始, 假)
    引导窗口.销毁 ()
.如果真结束
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _引导窗口_创建完毕, 空白型, , 
.局部变量 版本信息, 未知类型0x50005, , , 

未知支持库函数_16 (相加 (取运行目录 (), “\”, 取执行文件名 ()), 版本信息)
赋值 (.内容, 相加 (“v”, 版本信息.))
' 本源码来自易语言资源网(www.5A5X.com)

.窗口程序集 账号编辑_程序集, , , 

.程序集变量 计数器1, 整数型, , , 
.程序集变量 计数器2, 整数型, , , 
.程序集变量 计数器3, 整数型, , , 
.程序集变量 位置号, 整数型, , , 
.程序集变量 匿名程序集变量_1359, 空白型, , , 
.子程序 _账号编辑窗口_创建完毕, 空白型, , 
 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

获取焦点 ()
.如果真 (等于 (注册项是否存在 (#本地机器, “software\WoWaddons\”), 假))
    写注册项 (#本地机器, “software\WoWaddons\”, “”)
.如果真结束

读账号信息 ()

.子程序 读账号信息, 空白型, , 
清空 ()
.计次循环首 (10, 计数器1)
    .如果真 (注册项是否存在 (#本地机器, 相加 (“software\WoWaddons\”, 到文本 (计数器1), “\”)))
        取文本注册项 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器1), “\1_1”), ).加入项目 ()
    .如果真结束
     ' 本源码来自易语言资源网(www.5A5X.com)
.计次循环尾 ()


.子程序 _增加按钮_被单击, 空白型, , 
 ' .如果真 (或者 (不等于 (.内容, “”), 不等于 (.内容, “”)))
     ' 增加按钮.标题 ＝ “新增”
     ' 名称输入框.内容 ＝ “”
     ' 账号输入框.内容 ＝ “”
     ' 返回 ()
.如果真结束
 ' .计次循环首 (10, 计数器1)
     ' .如果真 (并且 (等于 (.内容, 取文本注册项 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器1), “\1_1”), )), 等于 (.内容, 取文本注册项 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器1), “\1_2”), ))))
         ' 信息框 (“成功！”, 0, )
         ' 增加按钮.标题 ＝ “新增”
         ' 名称输入框.内容 ＝ “”
         ' 账号输入框.内容 ＝ “”
        
         ' 返回 ()
    .如果真结束
    
 ' .计次循环尾 ()
.如果真 (等于 (.标题, “清空”))
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    返回 ()
.如果真结束

.如果真 (或者 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“请正确输入账号信息！”, #信息图标, “输入内容不符”)
    返回 ()
.如果真结束

.计次循环首 (10, 计数器1)
    .如果真 (等于 (注册项是否存在 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器1), “\”)), 假))
        写注册项 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器1), “\”), “”)
        写注册项 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器1), “\”, “1_1”), .内容)
        写注册项 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器1), “\”, “1_2”), .内容)
        跳出循环 ()
    .如果真结束
     ' 本源码来自易语言资源网(www.5A5X.com)
.计次循环尾 ()

读账号信息 ()
赋值 (.内容, “”)
赋值 (.内容, “”)
获取焦点 ()


.子程序 _列表框1_列表项被选择, 空白型, , 
赋值 (位置号, 相加 (.现行选中项, 1))
赋值 (计数器2, 0)

.计次循环首 (10, 计数器1)
    .如果真 (等于 (注册项是否存在 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器1), “\”)), 真))
        赋值 (计数器2, 相加 (计数器2, 1))
    .如果真结束
    
    .如果真 (并且 (等于 (取文本注册项 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器1), “\1_1”), ), .取项目文本 (.现行选中项)), 等于 (计数器2, 位置号)))
        赋值 (.内容, 取文本注册项 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器1), “\1_1”), ))
        赋值 (.内容, 取文本注册项 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器1), “\1_2”), ))
         ' 本源码来自易语言资源网(www.5A5X.com)
    .如果真结束
    
.计次循环尾 ()
 ' 增加按钮.标题 ＝ “清空”

.子程序 _删除按钮_被单击, 空白型, , 如遇同名项按位置号删除。
赋值 (位置号, 相加 (.现行选中项, 1))
赋值 (计数器2, 0)
.如果真 (等于 (.内容, “”))
    返回 ()
.如果真结束
.如果真 (等于 (信息框 (相加 (“确认删除账号 ”, #引号, .取项目文本 (.现行选中项), #引号, “ 所属信息吗？”), 相加 (#警告图标, #确认取消钮), “确认删除吗？”), 0))
    
    .计次循环首 (10, 计数器1)
        .如果真 (等于 (注册项是否存在 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器1), “\”)), 真))
            赋值 (计数器2, 相加 (计数器2, 1))
            
        .如果真结束
        .如果真 (并且 (等于 (取文本注册项 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器1), “\1_1”), ), .取项目文本 (.现行选中项)), 等于 (计数器2, 位置号)))
            
            删除注册项 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器1), “\1_1”))
            删除注册项 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器1), “\1_2”))
            删除注册项 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器1)))
             ' 本源码来自易语言资源网(www.5A5X.com)
        .如果真结束
        
    .计次循环尾 ()
    读账号信息 ()
    赋值 (.内容, “”)
    赋值 (.内容, “”)
    
.如果真结束


.子程序 _账号编辑窗口_将被销毁, 空白型, , 
_启动窗口.读账号名称 ()


.子程序 _编辑按钮_被单击, 空白型, , 
.如果真 (并且 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“请认真填写！”, 0, )
    返回 ()
.如果真结束

赋值 (位置号, 相加 (.现行选中项, 1))
赋值 (计数器2, 0)
.计次循环首 (10, 计数器1)
    .如果真 (等于 (注册项是否存在 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器1), “\”)), 真))
        赋值 (计数器2, 相加 (计数器2, 1))
        
    .如果真结束
    .如果真 (并且 (等于 (取文本注册项 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器1), “\1_1”), ), .取项目文本 (.现行选中项)), 等于 (计数器2, 位置号))) ' 本源码来自易语言资源网(www.5A5X.com)
        
        写注册项 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器1), “\”, “1_1”), .内容)
        写注册项 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器1), “\”, “1_2”), .内容)
        跳出循环 ()
    .如果真结束
    
.计次循环尾 ()
读账号信息 ()


.子程序 _名称输入框_内容被改变, 空白型, , 
判断是否存在 ()

.子程序 _账号输入框_内容被改变, 空白型, , 
判断是否存在 ()

.子程序 判断是否存在, 空白型, , 
.如果真 (并且 (等于 (.内容, “”), 等于 (.内容, “”)))
    赋值 (.禁止, 真)
    赋值 (.标题, “新增”)
    返回 ()
.如果真结束

.计次循环首 (10, 计数器3) ' -------------------  与子程序“_列表框1_列表项被选择”中循环计数器调用冲突，所以使用计数器3
    .如果真 (并且 (等于 (.内容, 取文本注册项 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器3), “\1_1”), )), 等于 (.内容, 取文本注册项 (#本地机器, 相加 (“software\wowaddons\”, 到文本 (计数器3), “\1_2”), ))))
        赋值 (.可视, 真)
        赋值 (.禁止, 假)
        赋值 (.标题, “清空”)
        返回 ()
    .如果真结束
    ' 本源码来自易语言资源网(www.5A5X.com)
    
.计次循环尾 ()
赋值 (.可视, 假)
赋值 (.禁止, 假)
赋值 (.标题, “新增”)


.窗口程序集 窗口程序集1, , , 

.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 Ansi到UTF8, 字节集, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 文件名, 文本型, , 



.子程序 UTF8到Ansi, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 UTF8编码, 字节集, , 



.子程序 Unicode到Ansi, 文本型, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 Unicode编码, 字节集, , Unicode码字节集数据



.子程序 Ansi到Unicode, 字节集, , 方圆软件工作室－林炳崇（近在眼前）出品
.参数 待转文本, 文本型, , Ansi码文本，只针对中文或双字节全角字符




 ' 不属于任何一个程序集、类模块的函数：
