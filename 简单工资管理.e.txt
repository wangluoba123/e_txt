 ' 文件类型：Windows窗口程序

 ' 程序名称：简单工资管理
 ' 程序描述：简单工资管理
@备注:
简单工资管理
 ' 程序作者：本源码来自易语言资源网(www.5A5X.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.5A5X.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.5A5X.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 _启动窗口 ' 在程序启动后自动调入本窗口
    左边 = 50
    顶边 = 50
    宽度 = 755
    高度 = 520
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 已保存到：D:\易语言学习\Data\简单工资管理.e\_启动窗口_图标.ico
    背景音乐 =  ' 空
    标题 = “简单工资管理工具”
    帮助文件名 = “”

窗口 窗口_主界面
    左边 = 50
    顶边 = 50
    宽度 = 684
    高度 = 388
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 假
    禁止 = 假

窗口 窗口_参数添加修改
    左边 = 50
    顶边 = 50
    宽度 = 218
    高度 = 145
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “”
    帮助文件名 = “”

窗口 窗口_职工管理_基本信息
    左边 = 50
    顶边 = 50
    宽度 = 591
    高度 = 504
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “人员信息”
    帮助文件名 = “”

窗口 窗口_职工管理_主界面
    左边 = 50
    顶边 = 50
    宽度 = 632
    高度 = 408
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “人员管理”
    帮助文件名 = “”

窗口 窗口_工资录入
    左边 = 50
    顶边 = 50
    宽度 = 548
    高度 = 399
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 1
    底图方式 = 1
    底色 = 15527148 '  0xECECEC
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 假
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “工资录入”
    帮助文件名 = “”

窗口 窗口_参数管理
    左边 = 50
    顶边 = 50
    宽度 = 192
    高度 = 309
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 假
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 真
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “工资参数管理”
    帮助文件名 = “”

窗口 窗口_帮助
    左边 = 50
    顶边 = 50
    宽度 = 410
    高度 = 277
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 0
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “帮助”
    帮助文件名 = “”

窗口 窗口_换肤
    左边 = 50
    顶边 = 50
    宽度 = 111
    高度 = 105
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    窗口类名 = “”
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “换肤”
    帮助文件名 = “”



.常量 常量_数据库, "“\data\Database.mdb”", , 
.图片 图片1, " ' 已保存到：D:\易语言学习\Data\简单工资管理.e\图片1", , 
.图片 图片2, " ' 已保存到：D:\易语言学习\Data\简单工资管理.e\图片2", , 
.图片 图片3, " ' 已保存到：D:\易语言学习\Data\简单工资管理.e\图片3", , 
.图片 图片4, " ' 已保存到：D:\易语言学习\Data\简单工资管理.e\图片4", , 
.图片 图片5, " ' 已保存到：D:\易语言学习\Data\简单工资管理.e\图片5", , 
.图片 图片6, " ' 已保存到：D:\易语言学习\Data\简单工资管理.e\图片6", , 


 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' iext 27bb20fdd3e145e4bee3db39ddd6e64c 2 0 扩展界面支持库一
 ' iext2 AF6AD80AA4244A59AFB3D83ECF5173CC 2 0 扩展界面支持库二
 ' xplib 7F54B9CE8887428dBA9CEEB94CEF4C72 2 0 XP风格界面库
 ' eExcel2000 F86EC5989E044d42BC98C692C0B54727 2 0 EXCEL2000支持库
 ' shell 52F260023059454187AF826A3C07AF2A 3 0 操作系统界面功能支持库



 ' 所需要的模块
 ' 彗星智能换肤模块 H:\运政管理系统\简单工资计算\智能换肤模块.ec
 ' 超级列表框打印模块 H:\运政管理系统\简单工资计算\超级列表框打印.ec


数据类型 分页数据, , 数据分页时需要的参数
    .成员 数据总数, 整数型, , , 
    .成员 每页行数, 整数型, , , 
    .成员 数据页数, 整数型, , , 
    .成员 当前页数, 整数型, , , 

数据类型 数据读入, , 
    .成员 开始条数, 整数型, , , 
    .成员 读入数目, 整数型, , , 

.全局变量 全局_外部数据库, 外部数据库, , , 
.全局变量 全局_数据库, 文本型, , , 
.全局变量 智能换肤, 彗星智能换肤类, 公开, , 
.全局变量 全局_背景颜色, 整数型, , , 

.窗口程序集 窗口程序集1, , , 

.程序集变量 集_背景图片, 字节集, , , 
.子程序 __启动窗口_创建完毕, 空白型, , 
.局部变量 窗口句柄, 整数型, , , 
.局部变量 局部_图片地址, 文本型, , , 

 ' --========  易语言资源网  (www.5A5X.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.5A5X.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.5A5X.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.5A5X.com  ================--

赋值 (全局_背景颜色, 到整数 (读配置项 (相加 (取运行目录 (), “\sysset.ini”), “系统默认”, “背景颜色”, )))
赋值 (局部_图片地址, 读配置项 (相加 (取运行目录 (), “\sysset.ini”), “系统默认”, “背景图片”, ))
.判断开始 (等于 (文件是否存在 (局部_图片地址), 假))
    信息框 (“背景图片没有找到，请重新选择。”, #信息图标, )
    载入 (窗口_换肤, , 真)
.默认
    赋值 (集_背景图片, 读入文件 (局部_图片地址))
.判断结束
未知支持库函数_0 (1)
赋值 (全局_外部数据库, )
赋值 (全局_数据库, 相加 (取当前目录 (), #常量_数据库))
.如果真 (等于 (文件是否存在 (全局_数据库), 假))
    信息框 (“数据库文件不存在，打开数据库失败！”, #错误图标, )
    结束 ()
.如果真结束
.如果真 (等于 (全局_外部数据库.打开MDB数据库 (全局_数据库, , , , ), 假))
    信息框 (“本地数据库打开失败！”, #错误图标, )
    结束 ()
.如果真结束
赋值 (窗口句柄, 取窗口句柄 ()) ' 注意：不要设置“随意移动=真”
智能换肤.应用皮肤 (窗口句柄, , , 真, 真, 真, 真, 真)
智能换肤.应用控件皮肤 () ' 对子控件应用皮肤效果(按钮、编辑框等)
智能换肤.置客户区底色 (全局_背景颜色)
智能换肤.事件_菜单按钮被点击 (窗口句柄, &菜单按钮被点击)
智能换肤.事件_帮助按钮被点击 (窗口句柄, &帮助按钮被点击)
智能换肤.设置图片皮肤 (集_背景图片)
 ' 智能换肤.设置颜色皮肤 (全局_背景颜色)
智能换肤.置状态栏文本 (窗口句柄, “简单工资工具：简化计算工资步骤”) ' 调试时无效
 ' ------------------------------------------------
载入 (窗口_主界面, , 假) ' 这里我载入3个子窗口当选择夹
 ' 载入 (窗口_职工管理_主界面, , 假)  ' 需要注意的是这些窗口都已设置可视为假
 ' 载入 (窗口_参数管理, , 假)  ' 不需要“置父窗口”等操作，模块会自动处理
 ' ------------------------------------------------
智能换肤.添加选择夹 (窗口句柄, “工资计算”, #图片2, 窗口_主界面.取窗口句柄 ())
 ' 智能换肤.添加选择夹 (窗口句柄, “工资参数”, #图片3, 窗口_参数管理.取窗口句柄 ())
智能换肤.添加选择夹 (窗口句柄, “工资参数”, #图片3, 0, &参数管理)
智能换肤.添加选择夹 (窗口句柄, “工资打印”, #图片5, 0, &工资打印) ' 这个未指定句柄
智能换肤.添加选择夹 (窗口句柄, “导出数据”, #图片4, 0, &导出数据)
智能换肤.添加选择夹 (窗口句柄, “生成对帐”, #图片6, 0, &生成对帐)
智能换肤.添加选择夹 (窗口句柄, “工资初始化”, #图片1, 0, &工资初始化)
 ' ------------------------------------------------
智能换肤.选中选择夹 (窗口句柄, “工资计算”)

.子程序 帮助按钮被点击, 空白型, , 
载入 (窗口_帮助, , 真)


.子程序 菜单按钮被点击, 空白型, , 
载入 (窗口_换肤, , 真)


.子程序 工资打印, 空白型, , 
打印超级列表框 (窗口_主界面., )


.子程序 参数管理, 空白型, , 
载入 (窗口_参数管理, , 真)


.子程序 工资初始化, 空白型, , 
.局部变量 局部_记录集, 整数型, , , 
.局部变量 集_ID, 整数型, , , 

.判断开始 (等于 (信息框 (“你确定要初始化工资表吗？这样会导致你刚才修改的标识被修改，你会不清楚那些职工工资信息被修改过！”, 1, “警告！”), 1))
    返回 ()
.默认
    赋值 (局部_记录集, 全局_外部数据库.查询 (“select * from 工资表 ”))
    全局_外部数据库.到首记录 (局部_记录集)
    .判断循环首 (等于 (全局_外部数据库.尾记录后 (局部_记录集), 假))
        赋值 (集_ID, 全局_外部数据库.读 (局部_记录集, “ID”))
        全局_外部数据库.执行 (相加 (“UPDATE 工资表 SET 标识状态='”, “初始”, “' where ID=”, 到文本 (集_ID)), )
        全局_外部数据库.到后一记录 (局部_记录集)
    .判断循环尾 ()
    全局_外部数据库.关闭记录集 (局部_记录集)
.判断结束
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 导出数据, 空白型, , 
超级列表框到Excel (窗口_主界面., , , )


.子程序 子程序_写配置项, 空白型, , 
写配置项 (相加 (取运行目录 (), “\sysset.ini”), “系统默认”, “背景颜色”, 到文本 (#白色))
写配置项 (相加 (取运行目录 (), “\sysset.ini”), “系统默认”, “背景图片”, 相加 (取运行目录 (), “\bj.jpg”))

.子程序 生成对帐, 空白型, , 
.局部变量 局部_文件名称, 文本型, , , 
.局部变量 局部_文件内容, 文本型, , , 
.局部变量 局部_sql, 文本型, , , 
.局部变量 局部_记录集, 整数型, , , 

.如果真 (等于 (寻找文件 (相加 (取当前目录 (), “\对帐”), #子目录), “”))
    创建目录 (相加 (取当前目录 (), “\对帐”))
.如果真结束
.如果真 (等于 (寻找文件 (相加 (取当前目录 (), “\对帐\”, 到文本 (取年份 (取现行时间 ())), “年度”), #子目录), “”))
    创建目录 (相加 (取当前目录 (), “\对帐\”, 到文本 (取年份 (取现行时间 ())), “年度”))
.如果真结束
赋值 (局部_文件名称, 相加 (取当前目录 (), “\对帐\”, 到文本 (取年份 (取现行时间 ())), “年度”, “\”, 到文本 (取月份 (取现行时间 ())), “月”, “.txt”))
.判断开始 (等于 (文件是否存在 (相加 (取当前目录 (), “\对帐\”, 到文本 (取年份 (取现行时间 ())), “年度”, “\”, 到文本 (取月份 (取现行时间 ())), “月”, “.txt”)), 假))
    写到文件 (局部_文件名称, {  })
    赋值 (局部_sql, “select * from (工资表 INNER JOIN 职工信息 ON 工资表.职工编号=职工信息.职工编号) order by 工资表.ID desc”)
    赋值 (局部_记录集, 全局_外部数据库.查询 (局部_sql))
    全局_外部数据库.到首记录 (局部_记录集)
    .判断循环首 (等于 (全局_外部数据库.尾记录后 (局部_记录集), 假))
        全局_外部数据库.读 (局部_记录集, “职工编号”)
        全局_外部数据库.读 (局部_记录集, “职工姓名”)
        全局_外部数据库.读 (局部_记录集, “银行帐号”)
        全局_外部数据库.读 (局部_记录集, “实发合计”)
        赋值 (局部_文件内容, 相加 (#换行符, 全局_外部数据库.读 (局部_记录集, “职工编号”), “         ”, 全局_外部数据库.读 (局部_记录集, “职工姓名”), “         ”, 全局_外部数据库.读 (局部_记录集, “银行帐号”), “         ”, 全局_外部数据库.读 (局部_记录集, “实发合计”)))
        插入文本 (打开文件 (局部_文件名称, , ), 局部_文件内容)
        全局_外部数据库.到后一记录 (局部_记录集)
    .判断循环尾 ()
    全局_外部数据库.关闭记录集 (局部_记录集)
    插入文本 (打开文件 (局部_文件名称, , ), 相加 (“职工编号”, “         ”, “职工姓名”, “         ”, “银行帐号”, “         ”, “实发合计”))
    关闭文件 (打开文件 (局部_文件名称, , ))
    未知支持库函数_6 (局部_文件名称, , , )
    
.默认
    .如果真 (等于 (信息框 (“警告！已经保存过该文件你确定要覆盖吗？该操纵不可恢复！”, 1, ), 1))
        返回 ()
    .如果真结束
    删除数据 (打开文件 (局部_文件名称, , ), 取文件长度 (打开文件 (局部_文件名称, , )))
    赋值 (局部_sql, “select * from (工资表 INNER JOIN 职工信息 ON 工资表.职工编号=职工信息.职工编号) order by 工资表.ID desc”)
    赋值 (局部_记录集, 全局_外部数据库.查询 (局部_sql))
    全局_外部数据库.到首记录 (局部_记录集)
    .判断循环首 (等于 (全局_外部数据库.尾记录后 (局部_记录集), 假))
        全局_外部数据库.读 (局部_记录集, “职工编号”)
        全局_外部数据库.读 (局部_记录集, “职工姓名”)
        全局_外部数据库.读 (局部_记录集, “银行帐号”)
        全局_外部数据库.读 (局部_记录集, “实发合计”)
        赋值 (局部_文件内容, 相加 (#换行符, 全局_外部数据库.读 (局部_记录集, “职工编号”), “         ”, 全局_外部数据库.读 (局部_记录集, “职工姓名”), “         ”, 全局_外部数据库.读 (局部_记录集, “银行帐号”), “         ”, 全局_外部数据库.读 (局部_记录集, “实发合计”)))
        插入文本 (打开文件 (局部_文件名称, , ), 局部_文件内容)
        全局_外部数据库.到后一记录 (局部_记录集)
    .判断循环尾 ()
    全局_外部数据库.关闭记录集 (局部_记录集)
    插入文本 (打开文件 (局部_文件名称, , ), 相加 (“职工编号”, “         ”, “职工姓名”, “         ”, “银行帐号”, “         ”, “实发合计”))
    关闭文件 (打开文件 (局部_文件名称, , ))
    未知支持库函数_6 (局部_文件名称, , , )
    
    
.判断结束


.窗口程序集 窗口_主界面, , , 

.子程序 _窗口_主界面_创建完毕, 空白型, , 
连续赋值 (全局_背景颜色, ., .背景颜色, .背景颜色, .背景颜色, ., ., ., ., ., ., .)
子程序_显示工资列表 (“select * from 工资表”)


.子程序 子程序_显示工资列表, 空白型, , 
.参数 参数_SQL语句, 文本型, , 

.局部变量 局部_记录集, 整数型, , , 
.局部变量 局部_id, 整数型, , , 
.局部变量 局部_索引, 整数型, , , 

全部删除 ()
 ' 局_SQL语句 ＝ “select * from 工资表”
赋值 (局部_记录集, 全局_外部数据库.查询 (参数_SQL语句))
全局_外部数据库.到首记录 (局部_记录集)
.判断循环首 (等于 (全局_外部数据库.尾记录后 (局部_记录集), 假))
    赋值 (局部_id, 全局_外部数据库.读 (局部_记录集, “ID”))
    赋值 (局部_索引, .插入表项 (局部_id))
    局部_索引.置标题 (0, 到文本 (全局_外部数据库.读 (局部_记录集, “职工编号”)))
    局部_索引.置标题 (1, 到文本 (全局_外部数据库.读 (局部_记录集, “职工姓名”)))
    局部_索引.置标题 (2, 到文本 (全局_外部数据库.读 (局部_记录集, “基本工资”)))
    局部_索引.置标题 (3, 到文本 (全局_外部数据库.读 (局部_记录集, “其它应发”)))
    局部_索引.置标题 (4, 到文本 (全局_外部数据库.读 (局部_记录集, “平时加班”)))
    局部_索引.置标题 (5, 到文本 (全局_外部数据库.读 (局部_记录集, “六日加班”)))
    局部_索引.置标题 (6, 到文本 (全局_外部数据库.读 (局部_记录集, “津贴”)))
    局部_索引.置标题 (7, 到文本 (全局_外部数据库.读 (局部_记录集, “年资”)))
    局部_索引.置标题 (8, 到文本 (全局_外部数据库.读 (局部_记录集, “应发合计”)))
    局部_索引.置标题 (9, 到文本 (全局_外部数据库.读 (局部_记录集, “社保”)))
    局部_索引.置标题 (10, 到文本 (全局_外部数据库.读 (局部_记录集, “个人所得税”)))
    局部_索引.置标题 (11, 到文本 (全局_外部数据库.读 (局部_记录集, “厂牌”)))
    局部_索引.置标题 (12, 到文本 (全局_外部数据库.读 (局部_记录集, “伙食费”)))
    局部_索引.置标题 (13, 到文本 (全局_外部数据库.读 (局部_记录集, “住宿费”)))
    局部_索引.置标题 (14, 到文本 (全局_外部数据库.读 (局部_记录集, “急辞旷工”)))
    局部_索引.置标题 (15, 到文本 (全局_外部数据库.读 (局部_记录集, “罚款”)))
    局部_索引.置标题 (16, 到文本 (全局_外部数据库.读 (局部_记录集, “厂服”)))
    局部_索引.置标题 (17, 到文本 (全局_外部数据库.读 (局部_记录集, “福利费”)))
    局部_索引.置标题 (18, 到文本 (全局_外部数据库.读 (局部_记录集, “其它代扣”)))
    局部_索引.置标题 (19, 到文本 (全局_外部数据库.读 (局部_记录集, “应扣合计”)))
    局部_索引.置标题 (20, 到文本 (全局_外部数据库.读 (局部_记录集, “实发合计”)))
    全局_外部数据库.到后一记录 (局部_记录集)
.判断循环尾 ()
全局_外部数据库.关闭记录集 (局部_记录集)
子程序_状态条 ()

.子程序 _窗口_主界面_尺寸被改变, 空白型, , 
0.移动 (0, 取用户区宽度 (), 30)
相减 (.宽度, 85).移动 (5, 70, 20)
相减 (.宽度, 85, .).移动 (5, 55, 20)
10.移动 (5, , )
相加 (.宽度, .左边, 5).移动 (5, , )
相加 (.宽度, .左边, 25).移动 (5, , )
相加 (.宽度, .左边, 5).移动 (5, , )
0.移动 (相加 (.高度, .顶边), 取用户区宽度 (), 相减 (取用户区高度 (), .高度, .))

.子程序 _超级列表框_工资列表_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (大于或等于 (., 0))
    子程序_选择修改 ()
.默认
    载入 (窗口_工资录入, 窗口_主界面, 假)
    
.判断结束
 ' 子程序_选择修改 ()

.子程序 _修改_被选择, 空白型, , 
子程序_选择修改 ()

.子程序 _删除_被选择, 空白型, , 
.判断开始 (大于或等于 (., 0))
    .判断开始 (等于 (信息框 (相加 (“你确定要删除职工”, .取标题 (., 1), “的工资信息吗？”), 1, ), 1))
        返回 ()
    .默认
        .如果 (等于 (全局_外部数据库.执行 (相加 (“delete from 工资表 where ID= ”, 到文本 (.取表项数值 (.))), ), 假))
            信息框 (“删除失败！”, #错误图标, )
            返回 ()
        .否则
            信息框 (“删除成功！”, #信息图标, )
            子程序_显示工资列表 (“select * from 工资表”)
        .如果结束
        ' 本源码来自易语言资源网(www.5A5X.com)
    .判断结束
    
.默认
    
.判断结束


.子程序 _依次修改工资_被选择, 空白型, , 
.局部变量 局_SQL语句, 文本型, , , 
.局部变量 局部_记录集, 整数型, , , 
.局部变量 局部_标识状态, 文本型, , , 

赋值 (局_SQL语句, “select * from 工资表 ”)
赋值 (局部_记录集, 全局_外部数据库.查询 (局_SQL语句))
全局_外部数据库.到首记录 (局部_记录集)
.判断循环首 (等于 (全局_外部数据库.尾记录后 (局部_记录集), 假))
    赋值 (局部_标识状态, 全局_外部数据库.读 (局部_记录集, “标识状态”))
    .如果真 (不等于 (局部_标识状态, “已修改”))
        载入 (窗口_工资录入, 窗口_主界面, 假)
        赋值 (窗口_工资录入., 相加 (“修改”, .取标题 (., 1), “的工资信息”))
        子程序_工资信息_填数据 (全局_外部数据库.读 (局部_记录集, “ID”))
        返回 ()
    .如果真结束
    全局_外部数据库.到后一记录 (局部_记录集)
.判断循环尾 ()
全局_外部数据库.关闭记录集 (局部_记录集)
信息框 (“工资表已经全部修改完毕！”, #信息图标, )

.子程序 _超级列表框_工资列表_右键单击表项, 空白型, , 
.判断开始 (大于或等于 (., 0))
    弹出菜单 ()
.默认
    
.判断结束


.子程序 子程序_选择修改, 空白型, , 
.局部变量 局_SQL语句, 文本型, , , 
.局部变量 局部_记录集, 整数型, , , 
.局部变量 局部_标识状态, 文本型, , , 

赋值 (局_SQL语句, 相加 (“select * from 工资表 where ID= ”, 到文本 (.取表项数值 (.)), “”))
赋值 (局部_记录集, 全局_外部数据库.查询 (局_SQL语句))
全局_外部数据库.到首记录 (局部_记录集)
.判断循环首 (等于 (全局_外部数据库.尾记录后 (局部_记录集), 假))
    赋值 (局部_标识状态, 全局_外部数据库.读 (局部_记录集, “标识状态”))
    .判断开始 (等于 (局部_标识状态, “已修改”))
        .判断开始 (等于 (信息框 (相加 (.取标题 (., 1), “已经修改过！你确定再次修改职工”, .取标题 (., 1), “的工资信息吗？”), 1, ), 1))
            返回 ()
        .默认
            载入 (窗口_工资录入, 窗口_主界面, 假)
            赋值 (窗口_工资录入., 相加 (“重复修改”, .取标题 (., 1), “的工资信息”))
            子程序_工资信息_填数据 (.取表项数值 (.))
        .判断结束
        返回 ()
    .判断 (等于 (局部_标识状态, “初始”))
        载入 (窗口_工资录入, 窗口_主界面, 假)
        赋值 (窗口_工资录入., 相加 (“第一次修改”, .取标题 (., 1), “的工资信息”))
        子程序_工资信息_填数据 (.取表项数值 (.))
    .默认
        信息框 (“该职工已经辞职！请删除？”, 0, )
    .判断结束
    全局_外部数据库.到后一记录 (局部_记录集)
.判断循环尾 ()
全局_外部数据库.关闭记录集 (局部_记录集)


.子程序 _超级按钮_查询_被单击, 空白型, , 
.局部变量 局_SQL语句, 文本型, , , 

.判断开始 (并且 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“请输入编号、姓名或者简名！”, #错误图标, )
    返回 ()
.判断 (等于 (.内容, “”))
    赋值 (局_SQL语句, 相加 (“select * from 工资表 where 职工编号 like '%”, .内容, “%'”))
.判断 (等于 (.内容, “”))
    赋值 (局_SQL语句, 相加 (“select * from 工资表 where 职工姓名 like '%”, .内容, “%'or 姓名简码 like '%”, .内容, “%'”))
.默认
    赋值 (局_SQL语句, 相加 (“select * from 工资表 where  职工编号 like '%”, .内容, “%'and 职工姓名 like '%”, .内容, “%'or 姓名简码 like '%”, .内容, “%'”))
.判断结束
子程序_显示工资列表 (局_SQL语句)

.子程序 _超级按钮_查询1_被单击, 空白型, , 
子程序_显示工资列表 (“select * from 工资表”)

.子程序 子程序_状态条, 空白型, , 
.局部变量 计次, 整数型, , , 
.局部变量 应发合计, 双精度小数型, , , 
.局部变量 应扣合计, 双精度小数型, , , 
.局部变量 实发合计, 双精度小数型, , , 

.计次循环首 (取表项数 (), 计次)
    赋值 (应发合计, 相加 (应发合计, 到数值 (计次.取标题 (8))))
    赋值 (应扣合计, 相加 (应扣合计, 到数值 (计次.取标题 (19))))
    赋值 (实发合计, 相加 (实发合计, 到数值 (计次.取标题 (20))))
.计次循环尾 ()
1.置文本 (到文本 (取表项数 ()))
5.置文本 (到文本 (应发合计))
9.置文本 (到文本 (应扣合计))
13.置文本 (到文本 (实发合计))

.窗口程序集 窗口_职工管理_主界面, , , 

.程序集变量 集_有效高度, 整数型, , , 
.程序集变量 集_每页尾数, 整数型, , "0", 
.程序集变量 集_分页数据, 分页数据, , , 
.程序集变量 集_记录明细, 文本型, , , 
.子程序 _窗口_职工管理_主界面_创建完毕, 空白型, , 
子程序_职工管理_整体界面配置 ()
赋值 (集_有效高度, .删除线)
赋值 (.内容, 到文本 (数据库_查数据数 (全局_外部数据库, “职工信息”)))
读入分页数据 (假, )

.子程序 子程序_职工管理_整体界面配置, 空白型, , 
连续赋值 (全局_背景颜色, ., .背景颜色, .背景颜色, .背景颜色, .背景颜色, ., ., ., ., ., ., ., ., ., ., ., ., ., ., ., ., ., .)

.子程序 _窗口_职工管理_主界面_尺寸被改变, 空白型, , 
0.移动 (0, 取用户区宽度 (), 30)
相减 (.宽度, 65).移动 (5, 55, 20)
10.移动 (5, , )
相加 (.宽度, .左边, 5).移动 (5, , )
相加 (.宽度, .左边, 5).移动 (5, , )
相加 (.宽度, .左边, 5).移动 (5, , )
0.移动 (相加 (.顶边, .高度), 取用户区宽度 (), 相减 (取用户区高度 (), .高度, .顶边, .高度))
0.移动 (相加 (.加粗, .删除线), .倾斜, 22)
40.移动 (0, 30, 20)
相加 (., ., 5).移动 (0, 30, 20)
相加 (., ., 5).移动 (0, 30, 20)
相加 (., ., 5).移动 (0, 30, 20)
相加 (., ., 5).移动 (0, 30, 20)
相加 (.左边, .宽度, 5).移动 (2, 60, 16)
相加 (.左边, .宽度, 5).移动 (0, 15, 20)
相加 (.左边, .宽度, 5).移动 (0, 30, 20)
相加 (., ., 5).移动 (0, 30, 20)
相加 (.左边, .宽度, 5).移动 (2, 50, 16)
相加 (.左边, .宽度, 5).移动 (0, 12, 20)
相加 (.左边, .宽度, 5).移动 (0, 30, 20)
相加 (.左边, .宽度, 5).移动 (2, 50, 16)
相加 (.左边, .宽度, 5).移动 (0, 12, 20)
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 读入分页数据, 空白型, , 
.参数 参_读入方式, 逻辑型, , 真：前后翻页查看，假：重新读入所有信息
.参数 参_第几页数, 整数型, 可空, 

.局部变量 数据_数据读入, 数据读入, , , 
.局部变量 局_SQL, 文本型, , , 
.局部变量 局_记录集, 整数型, , , 
.局部变量 局_计次, 整数型, , , 
.局部变量 局_SQL语句, 文本型, , , 

.如果真 (等于 (是否为空 (参_第几页数), 假))
    赋值 (集_分页数据.当前页数, 参_第几页数)
.如果真结束
.如果真 (等于 (参_读入方式, 假))
    赋值 (集_记录明细, “select * from 职工信息”)
    赋值 (集_分页数据, 分页_分页数据 (全局_外部数据库, 集_记录明细, 集_有效高度, 10, 集_分页数据))
    分页_分页调整 (集_分页数据, , )
    赋值 (局_SQL, 相加 (子文本替换 (集_记录明细, “ * ”, 相加 (“ top ”, 到文本 (集_分页数据.每页行数), “ * ”), , , 真), “ where ID>1 order by ID”))
    重定义数组 (集_每页尾数, 真, 相加 (集_分页数据.数据页数, 1))
    .计次循环首 (集_分页数据.数据页数, 局_计次)
        赋值 (局_记录集, 全局_外部数据库.查询 (局_SQL))
        全局_外部数据库.到尾记录 (局_记录集)
        赋值 (局_计次, 相加 (局_计次, 1))
        赋值 (集_每页尾数 [局_计次], 到整数 (全局_外部数据库.读 (局_记录集, “ID”)))
        赋值 (局_SQL, 相加 (子文本替换 (集_记录明细, “ * ”, 相加 (“ top ”, 到文本 (集_分页数据.每页行数), “ * ”), , , 真), “ where ID>”, 到文本 (集_每页尾数 [局_计次]), “ order by ID”))
    .计次循环尾 ()
    全局_外部数据库.关闭记录集 (局_记录集)
.如果真结束
赋值 (局_SQL语句, 相加 (“select top ”, 到文本 (集_分页数据.每页行数), “ * FROM 职工信息 where ID>”, 到文本 (集_每页尾数 [1]), “ order by ID”))
子程序_超级列表框_显示列表 (全局_外部数据库, , 局_SQL语句, 全局_数据库, , “职工信息”)


.子程序 子程序_数据显示, 空白型, , 
.局部变量 文本_SQL语句, 文本型, , , 

赋值 (文本_SQL语句, 相加 (“select top ”, 到文本 (集_分页数据.每页行数), “ * FROM 职工信息 WHERE ID>”, 到文本 (集_每页尾数 [集_分页数据].当前页数), “ order by ID”))
子程序_超级列表框_显示列表 (全局_外部数据库, , 文本_SQL语句, 全局_数据库, , “职工信息”)


.子程序 _按钮_首页_被单击, 空白型, , 
赋值 (集_分页数据.当前页数, 1)
.如果真 (大于 (集_分页数据.数据页数, 1))
    赋值 (., 真)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 真)
.如果真结束
分页_分页调整 (集_分页数据, , )
子程序_数据显示 ()

.子程序 _按钮_上页_被单击, 空白型, , 
.如果真 (大于 (集_分页数据.当前页数, 1))
    赋值 (集_分页数据.当前页数, 相减 (集_分页数据.当前页数, 1))
.如果真结束
.判断开始 (等于 (集_分页数据.当前页数, 1))
    赋值 (., 真)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 真)
.默认
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
.判断结束
分页_分页调整 (集_分页数据, , )
子程序_数据显示 ()

.子程序 _按钮_下页_被单击, 空白型, , 
.如果真 (小于 (集_分页数据.当前页数, 集_分页数据.数据页数))
    赋值 (集_分页数据.当前页数, 相加 (集_分页数据.当前页数, 1))
.如果真结束
.判断开始 (等于 (集_分页数据.当前页数, 集_分页数据.数据页数))
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., 假)
    赋值 (., 假)
.默认
    赋值 (., 假)
    赋值 (., 假)
    赋值 (., 假)
.判断结束
分页_分页调整 (集_分页数据, , )
子程序_数据显示 ()

.子程序 _按钮_尾页_被单击, 空白型, , 
.如果真 (大于 (集_分页数据.数据页数, 1))
    赋值 (., 假)
    赋值 (., 真)
    赋值 (., 真)
    赋值 (., 假)
.如果真结束
赋值 (集_分页数据.当前页数, 集_分页数据.数据页数)
分页_分页调整 (集_分页数据, , )
子程序_数据显示 ()

.子程序 _按钮_确认_被单击, 空白型, , 
.如果真 (或者 (大于 (到整数 (.内容), 集_分页数据.数据页数), 小于或等于 (到整数 (.内容), 0)))
    信息框 (“当前输入页数不合法！”, 相加 (#确认钮, #信息图标), )
    赋值 (.内容, 到文本 (集_分页数据.当前页数))
    返回 ()
.如果真结束
赋值 (集_分页数据.当前页数, 到整数 (.内容))
分页_分页调整 (集_分页数据, , )
子程序_数据显示 ()

.子程序 _列表框_人员管理_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (大于或等于 (., 0))
    弹出菜单 ()
.默认
    载入 (窗口_职工管理_基本信息, 窗口_职工管理_主界面, 假)
    赋值 (窗口_职工管理_基本信息..标题, “添加”)
    赋值 (窗口_职工管理_基本信息., “新增人员信息”)
.判断结束


.子程序 _超级按钮_查询_被单击, 空白型, , 
.局部变量 局_SQL语句, 文本型, , , 

.判断开始 (并且 (等于 (.内容, “”), 等于 (.内容, “”)))
    信息框 (“请输入编号、姓名或者简名！”, #错误图标, )
    返回 ()
.判断 (等于 (.内容, “”))
    赋值 (局_SQL语句, 相加 (“select * from 职工信息 where 职工编号 like '%”, .内容, “%'”))
.判断 (等于 (.内容, “”))
    赋值 (局_SQL语句, 相加 (“select * from 职工信息 where 职工姓名 like '%”, .内容, “%'or 姓名简码 like '%”, .内容, “%'”))
.默认
    赋值 (局_SQL语句, 相加 (“select * from 职工信息 where  职工编号 like '%”, .内容, “%'and 职工姓名 like '%”, .内容, “%'or 姓名简码 like '%”, .内容, “%'”))
.判断结束
子程序_超级列表框_显示列表 (全局_外部数据库, , 局_SQL语句, 全局_数据库, , “职工信息”)

.子程序 _修改_被选择, 空白型, , 
.判断开始 (大于或等于 (., 0))
    载入 (窗口_职工管理_基本信息, 窗口_职工管理_主界面, 假)
    赋值 (窗口_职工管理_基本信息..标题, “修改”)
    赋值 (窗口_职工管理_基本信息., “修改人员信息”)
    子程序_职工信息_填数据 (.取表项数值 (.))
    
.默认
    
.判断结束


.子程序 _选择_被选择, 空白型, , 
销毁 ()
子程序_取职工信息 (.取标题 (., ))


.子程序 _删除_被选择, 空白型, , 
.判断开始 (大于或等于 (., 0))
    .判断开始 (等于 (信息框 (相加 (“你确定要删除职工”, .取标题 (., 1), “的信息吗？”), 1, ), 1))
        返回 ()
    .默认
        .如果 (等于 (全局_外部数据库.执行 (相加 (“delete from 职工信息 where ID= ”, 到文本 (.取表项数值 (.))), ), 假))
            信息框 (“删除失败！”, #错误图标, )
            返回 ()
        .否则
            信息框 (“删除成功！”, #信息图标, )
            子程序_数据显示 ()
        .如果结束
        
    .判断结束
    
.默认
    
.判断结束


.子程序 _增加_被选择, 空白型, , 
载入 (窗口_职工管理_基本信息, 窗口_职工管理_主界面, 假)
赋值 (窗口_职工管理_基本信息..标题, “添加”)
赋值 (窗口_职工管理_基本信息., “新增人员信息”)


.窗口程序集 窗口_职工管理_基本信息, , , 

.程序集变量 集_ID, 整数型, , , 
.子程序 _窗口_职工管理_基本信息_创建完毕, 空白型, , 
子程序_职工管理_员工信息_整体界面配置 ()
获取焦点 ()

.子程序 子程序_职工管理_员工信息_整体界面配置, 空白型, , 
连续赋值 (全局_背景颜色, ., .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, ., ., ., .背景颜色)

.子程序 _窗口_职工管理_基本信息_尺寸被改变, 空白型, , 
5.移动 (5, , )
5.移动 (相加 (.顶边, .高度, 5), , )
5.移动 (相加 (.顶边, .高度, 5), , )
5.移动 (相加 (.顶边, .高度, 5), , )
5.移动 (相加 (.顶边, .高度, 5), , )

.子程序 _按钮_添加_被单击, 空白型, , 
.判断开始 (等于 (.标题, “添加”))
    子程序_添加职工信息 ()
    ' 本源码来自易语言资源网(www.5A5X.com)
.判断 (等于 (.标题, “修改”))
    子程序_修改职工信息 ()
    
.默认
    
.判断结束


.子程序 子程序_添加职工信息, 空白型, , 
.局部变量 局部_记录集, 整数型, , , 
.局部变量 局部_姓名简码, 文本型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请输入职工编号！”, #错误图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入职工姓名！”, #错误图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入职工身份证号！”, #错误图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请选择职工在职状态！”, #错误图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请选择银行！”, #错误图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入职工银行帐号！”, #错误图标, )
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (局部_姓名简码, 辅助功能_取首拼 (.内容))
赋值 (局部_记录集, 全局_外部数据库.查询 (“select * from 职工信息”))
全局_外部数据库.到首记录 (局部_记录集)
.判断循环首 (等于 (全局_外部数据库.尾记录后 (局部_记录集), 假))
    .如果真 (等于 (全局_外部数据库.读 (局部_记录集, “职工编号”), .内容))
        信息框 (“请不要重复登记人员编号！”, #信息图标, )
        返回 ()
    .如果真结束
    .如果真 (等于 (全局_外部数据库.读 (局部_记录集, “职工姓名”), .内容))
        信息框 (“请不要重复登记人员姓名！”, #信息图标, )
        返回 ()
    .如果真结束
    全局_外部数据库.到后一记录 (局部_记录集)
.判断循环尾 ()
全局_外部数据库.关闭记录集 (局部_记录集)
.如果 (等于 (全局_外部数据库.执行 (相加 (“insert into 职工信息(职工编号,姓名简码,职工姓名,所属部门,身份证号,人员籍贯,婚姻状况,联系地址,联系电话,邮件编码,电子邮件,银行名称,银行帐号,人员学历,政治面貌,部门职务,本单位工作时间,参加工作时间,备注,就职状态,照片) values ('”, .内容, “','”, 局部_姓名简码, “','”, .内容, “', '”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, 到文本 (.今天), “','”, 到文本 (.今天), “','”, .内容, “','”, .内容, “',?)”), .图片), 假))
    信息框 (“添加失败！”, #信息图标, )
    返回 ()
.否则
    信息框 (“添加成功！”, #信息图标, )
    销毁 ()
.如果结束
窗口_职工管理_主界面.读入分页数据 (假, )

.子程序 子程序_修改职工信息, 空白型, , 
.局部变量 局部_姓名简码, 文本型, , , 

赋值 (局部_姓名简码, 辅助功能_取首拼 (.内容))
.如果 (等于 (全局_外部数据库.执行 (相加 (“UPDATE 职工信息 SET  职工编号='”, .内容, “', 姓名简码='”, 局部_姓名简码, “', 职工姓名='”, .内容, “', 所属部门='”, .内容, “', 身份证号='”, .内容, “', 人员籍贯='”, .内容, “', 婚姻状况='”, .内容, “', 联系地址='”, .内容, “', 联系电话='”, .内容, “', 邮件编码='”, .内容, “', 电子邮件='”, .内容, “', 银行名称='”, .内容, “', 银行帐号='”, .内容, “', 人员学历='”, .内容, “', 政治面貌='”, .内容, “', 部门职务='”, .内容, “', 本单位工作时间='”, 到文本 (.今天), “', 参加工作时间='”, 到文本 (.今天), “', 备注='”, .内容, “', 就职状态='”, .内容, “',照片=? where ID=”, 到文本 (集_ID)), .图片), 假))
    信息框 (“修改失败！数据库出错！”, #信息图标, “修改失败！数据库出错！”)
    返回 ()
.否则
    信息框 (“修改完成！”, #信息图标, “修改完成！”)
    销毁 ()
.如果结束
窗口_职工管理_主界面.读入分页数据 (假, )

.子程序 子程序_职工信息_填数据, 空白型, , 
.参数 参数_ID, 整数型, , 

.局部变量 局部_sql, 文本型, , , 
.局部变量 局部_记录集, 整数型, , , 

赋值 (集_ID, 参数_ID)
赋值 (局部_sql, 相加 (“select * from 职工信息  where ID=”, 到文本 (参数_ID), “”))
赋值 (局部_记录集, 全局_外部数据库.查询 (局部_sql))
全局_外部数据库.到首记录 (局部_记录集)
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “职工编号”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “备注”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “邮件编码”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “电子邮件”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “身份证号”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “联系地址”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “联系电话”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “人员籍贯”))
 ' 编辑框_人员年龄.内容 ＝ 全局_外部数据库.读 (局部_记录集, “人员年龄”)
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “银行帐号”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “职工姓名”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “所属部门”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “银行名称”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “婚姻状况”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “部门职务”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “政治面貌”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “人员学历”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “就职状态”))
赋值 (.今天, 到时间 (全局_外部数据库.读 (局部_记录集, “参加工作时间”)))
赋值 (.今天, 到时间 (全局_外部数据库.读 (局部_记录集, “本单位工作时间”)))
赋值 (.图片, 全局_外部数据库.读 (局部_记录集, “照片”))
全局_外部数据库.关闭记录集 (局部_记录集)

.子程序 _按钮_退出_被单击, 空白型, , 
销毁 ()


.子程序 _图片框_像片_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果真 (等于 (打开 (), 真)) ' 打开对话框以便选择要更改的图片
    赋值 (.图片, 读入文件 (.文件名))
.如果真结束


.子程序 _编辑框_人员编号_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框_人员姓名_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _组合框_婚姻状况_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框_所属部门_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _按钮_选籍贯_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    
.否则
    
.如果结束


.子程序 _编辑框_人员籍贯_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框_身份证号_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框_联系电话_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框_联系地址_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框_邮件编码_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框_电子邮件_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _组合框_聘用形式_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _组合框_部门职务_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _组合框_在职状态_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _组合框_银行名称_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框_银行帐号_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _组合框_人员学历_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _组合框_政治面貌_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _日期框_本单位工作时间_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _日期框_参加工作时间_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框_备注_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _按钮_添加_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    _按钮_添加_被单击 ()
.否则
    
.如果结束


.子程序 _编辑框_身份证号_内容被改变, 空白型, , 
子程序_身份证取年龄性别 (.内容)

.程序集 程序集_公共, , , 

.子程序 分页_分页调整, 空白型, , 
.参数 参数_分页数据, 分页数据, , 
.参数 参数_标签名称, 透明标签, , 
.参数 参数_编辑框, 编辑框, , 

赋值 (参数_标签名称.内容, 相加 (到文本 (参数_分页数据.当前页数), “/”, 到文本 (参数_分页数据.数据页数)))
赋值 (参数_编辑框.内容, 到文本 (参数_分页数据.当前页数))

.子程序 分页_分页数据, 分页数据, , 
.参数 参数_外部数据库, 外部数据库, , 
.参数 参数_SQL语句, 文本型, , 
.参数 参数_列表高度, 整数型, , 
.参数 参数_列表行高, 整数型, , 
.参数 参数_分页数据, 分页数据, , 

.局部变量 双精_页数, 双精度小数型, , , 
.局部变量 整数_记录集, 整数型, , , 
.局部变量 局部_SQL, 文本型, , , 

赋值 (局部_SQL, 子文本替换 (参数_SQL语句, “*”, “count(*)”, , , 真))
赋值 (整数_记录集, 参数_外部数据库.查询 (局部_SQL))
参数_外部数据库.到首记录 (整数_记录集)
赋值 (参数_分页数据.数据总数, 参数_外部数据库.读 (整数_记录集, 1))
参数_外部数据库.关闭记录集 (整数_记录集)
.如果真 (等于 (参数_分页数据.每页行数, 0))
    赋值 (参数_分页数据.每页行数, 绝对取整 (相除 (参数_列表高度, 参数_列表行高)))
.如果真结束
.如果真 (小于或等于 (参数_分页数据.当前页数, 1))
    赋值 (参数_分页数据.当前页数, 1)
.如果真结束
赋值 (双精_页数, 相除 (参数_分页数据.数据总数, 参数_分页数据.每页行数))
.如果 (大于 (双精_页数, 取整 (双精_页数)))
    赋值 (参数_分页数据.数据页数, 相加 (取整 (双精_页数), 1))
.否则
    赋值 (参数_分页数据.数据页数, 取整 (双精_页数))
.如果结束
返回 (参数_分页数据)

.子程序 分页_数据读入, 数据读入, , 
.参数 参数_分页数据, 分页数据, , 
.参数 参数_数据读入, 数据读入, , 

赋值 (参数_数据读入.开始条数, 相乘 (相减 (参数_分页数据.当前页数, 1), 参数_分页数据.每页行数))
赋值 (参数_数据读入.读入数目, 参数_分页数据.每页行数)
返回 (参数_数据读入)

.子程序 MDB数据库取字段名, 整数型, , 
.参数 MDB数据库, 文本型, , MDB数据库文件的路径
.参数 密码, 文本型, 可空, 库文件密码
.参数 数据表名, 文本型, , 表名
.参数 取回的字段名, 文本型, 数组, 

.局部变量 连接对象, 对象, , , 
.局部变量 表对象, 对象, , , 
.局部变量 连接文本, 文本型, , , 
.局部变量 表数计次, 整数型, , , 
.局部变量 表数量, 整数型, , , 
.局部变量 表名, 文本型, , , 
.局部变量 字段数量, 整数型, , , 
.局部变量 字段名, 文本型, , , 
.局部变量 字段计次, 整数型, , , 
.局部变量 字段类型, 整数型, , , 
.局部变量 字段长度, 整数型, , , 

.如果真 (等于 (连接对象.创建 (“ADOX.Catalog”, ), 假))
    信息框 (“你的机器上没有安装ADO。文件位置是C:\Program Files\Common Files\System\ado\Msado.dll”, 0, )
    结束 ()
.如果真结束
赋值 (连接文本, 相加 (“Provider=Microsoft.Jet.OLEDB.4.0;Data Source=”, MDB数据库, “;Jet OLEDB:Database Password=”, 密码, “;”))
连接对象.写属性 (“ActiveConnection”, 连接文本)
赋值 (表对象, 连接对象.读对象型属性 (“Tables”, ))
赋值 (表名, 数据表名)
赋值 (字段数量, 表对象.读对象型属性 (“Item”, 表名).读对象型属性 (“Columns”, ).读数值属性 (“Count”, ))
 ' 列表框_数据字段.清空 ()
.计次循环首 (字段数量, 字段计次)
    赋值 (字段名, 表对象.读对象型属性 (“Item”, 表名).读对象型属性 (“Columns”, ).读对象型属性 (“Item”, 相减 (字段计次, 1)).读文本属性 (“Name”, ))
    输出调试文本 (字段名)
    加入成员 (取回的字段名, 字段名)
.计次循环尾 ()
表对象.清除 ()
连接对象.清除 ()
返回 (0)

.子程序 子程序_超级列表框_显示列表, 空白型, , 错误号：001
.参数 参数_外部数据库, 外部数据库, , 
.参数 参数_超级列表框, 超级列表框, , 要显示数据的超级列表框
.参数 参数_语句, 文本型, , 传递查询的SQL语句
.参数 MDB数据库, 文本型, , MDB数据库文件的路径
.参数 密码, 文本型, 可空, 库文件密码
.参数 数据表名, 文本型, , 表名

.局部变量 局部_记录集, 整数型, , , 
.局部变量 局部_计次, 整数型, , , 
.局部变量 局部_索引, 整数型, , , 
.局部变量 局部_id, 整数型, , , 
.局部变量 局部_sql, 文本型, , , 
.局部变量 局部_显示字段, 文本型, , , 
.局部变量 局部_字段名, 文本型, , "0", 
.局部变量 局部_计次1, 整数型, , , 

 ' MDB数据库取字段名 (MDB数据库, 密码, 数据表名, 局部_字段名)
 ' 数组排序 (局部_字段名, 假)
 ' 参数_超级列表框.全部删除 ()
 ' .计次循环首 (参数_超级列表框.取列数 (), 局部_计次)
     ' ' 参数_超级列表框.删除列 (0)
 ' .计次循环尾 ()
 ' .计次循环首 (取数组成员数 (局部_字段名), 局部_计次)
    
     ' 参数_超级列表框.插入列 (, 局部_字段名 [局部_计次], 80, #中间对齐, , )
 ' .计次循环尾 ()
参数_超级列表框.全部删除 ()
赋值 (局部_记录集, 参数_外部数据库.查询 (参数_语句))
参数_外部数据库.到首记录 (局部_记录集)
.判断循环首 (等于 (参数_外部数据库.尾记录后 (局部_记录集), 假))
    赋值 (局部_id, 参数_外部数据库.读 (局部_记录集, “ID”))
    赋值 (局部_索引, 参数_超级列表框.插入表项 (局部_id))
    参数_超级列表框.置标题 (局部_索引, 0, 到文本 (参数_外部数据库.读 (局部_记录集, “职工编号”)))
    参数_超级列表框.置标题 (局部_索引, 1, 到文本 (参数_外部数据库.读 (局部_记录集, “职工姓名”)))
    参数_超级列表框.置标题 (局部_索引, 2, 到文本 (参数_外部数据库.读 (局部_记录集, “所属部门”)))
    参数_超级列表框.置标题 (局部_索引, 3, 到文本 (参数_外部数据库.读 (局部_记录集, “部门职务”)))
    参数_超级列表框.置标题 (局部_索引, 4, 到文本 (参数_外部数据库.读 (局部_记录集, “身份证号”)))
    参数_超级列表框.置标题 (局部_索引, 5, 到文本 (参数_外部数据库.读 (局部_记录集, “联系地址”)))
    参数_超级列表框.置标题 (局部_索引, 6, 到文本 (参数_外部数据库.读 (局部_记录集, “联系电话”)))
    参数_超级列表框.置标题 (局部_索引, 7, 到文本 (参数_外部数据库.读 (局部_记录集, “就职状态”)))
    参数_外部数据库.到后一记录 (局部_记录集)
.判断循环尾 ()
参数_外部数据库.关闭记录集 (局部_记录集)

.子程序 辅助功能_取首拼, 文本型, , 
.参数 参数_转换内容, 文本型, , 

.局部变量 文本_文本, 文本型, , , 
.局部变量 一个汉字, 文本型, , , 
.局部变量 临时_汉字, 文本型, , , 
.局部变量 文本_首拼, 文本型, , , 
.局部变量 文本长度, 整数型, , , 
.局部变量 循环计数, 整数型, , , 

赋值 (循环计数, 0)
赋值 (文本_文本, 参数_转换内容)
赋值 (文本长度, 取文本长度 (文本_文本))
.计次循环首 (相除 (文本长度, 2), 循环计数)
    赋值 (临时_汉字, 取文本右边 (文本_文本, 相减 (文本长度, 相乘 (2, 相减 (循环计数, 1)))))
    赋值 (一个汉字, 取文本左边 (临时_汉字, 2))
    赋值 (文本_首拼, 相加 (文本_首拼, 到大写 (取文本左边 (取拼音 (一个汉字, 1), 1))))
.计次循环尾 ()
返回 (文本_首拼)

.子程序 子程序_身份证取年龄性别, 空白型, , 
.参数 参数_身份证号, 文本型, , 

.局部变量 文本长度, 整数型, , , 
.局部变量 文本, 文本型, , , 
.局部变量 取年, 文本型, , , 
.局部变量 取月, 文本型, , , 
.局部变量 取日, 文本型, , , 
.局部变量 现在年, 整数型, , , 
.局部变量 现在月, 整数型, , , 
.局部变量 现在日, 整数型, , , 
.局部变量 年龄, 文本型, , , 

赋值 (文本, 参数_身份证号)
赋值 (文本长度, 取文本长度 (文本))
.如果 (大于 (文本长度, 10))
    .判断开始 (等于 (文本长度, 15))
        赋值 (取年, 相加 (“19”, 取文本中间 (文本, 7, 2)))
        赋值 (取月, 取文本中间 (文本, 9, 2))
        赋值 (取日, 取文本中间 (文本, 11, 2))
        .判断开始 (或者 (等于 (到整数 (取文本中间 (文本, 15, 1)), 0), 等于 (到整数 (取文本中间 (文本, 15, 1)), 2), 等于 (到整数 (取文本中间 (文本, 15, 1)), 4), 等于 (到整数 (取文本中间 (文本, 15, 1)), 6), 等于 (到整数 (取文本中间 (文本, 15, 1)), 8)))
            赋值 (窗口_职工管理_基本信息..现行选中项, 1)
        .默认
            赋值 (窗口_职工管理_基本信息..现行选中项, 0)
        .判断结束
        ' 本源码来自易语言资源网(www.5A5X.com)
    .默认
        
    .判断结束
    .判断开始 (等于 (文本长度, 18))
        .判断开始 (或者 (等于 (到整数 (取文本中间 (文本, 17, 1)), 0), 等于 (到整数 (取文本中间 (文本, 17, 1)), 2), 等于 (到整数 (取文本中间 (文本, 17, 1)), 4), 等于 (到整数 (取文本中间 (文本, 17, 1)), 6), 等于 (到整数 (取文本中间 (文本, 17, 1)), 8)))
            赋值 (窗口_职工管理_基本信息..现行选中项, 1)
        .默认
            赋值 (窗口_职工管理_基本信息..现行选中项, 0)
        .判断结束
        赋值 (取年, 取文本中间 (文本, 7, 4))
        赋值 (取月, 取文本中间 (文本, 11, 2))
        赋值 (取日, 取文本中间 (文本, 13, 2))
    .默认
        
    .判断结束
    赋值 (现在年, 取年份 (取现行时间 ()))
    赋值 (现在月, 取月份 (取现行时间 ()))
    赋值 (现在日, 取日 (取现行时间 ()))
    .判断开始 (大于 (到整数 (取月), 现在月))
        赋值 (年龄, 到文本 (相减 (现在年, 到整数 (取年), 1)))
    .默认
        
    .判断结束
    .判断开始 (小于 (到整数 (取月), 现在月))
        赋值 (年龄, 到文本 (相减 (现在年, 到整数 (取年))))
    .默认
        
    .判断结束
    .判断开始 (等于 (到整数 (取月), 现在月))
        .判断开始 (大于 (到整数 (取日), 现在日))
            赋值 (年龄, 到文本 (相减 (现在年, 到整数 (取年), 1)))
        .默认
            赋值 (年龄, 到文本 (相减 (现在年, 到整数 (取年))))
        .判断结束
        
    .默认
        
    .判断结束
    赋值 (窗口_职工管理_基本信息..内容, 年龄)
    
.否则
    赋值 (窗口_职工管理_基本信息..内容, “”)
.如果结束


.子程序 数据库_查数据数, 整数型, , 
.参数 参数_外部数据库, 外部数据库, , 外部数据库
.参数 参数_数据表名, 文本型, , 要查询的数据库表名称
.参数 参数_条件, 文本型, 可空, 

.局部变量 整数_记录集, 整数型, , , 
.局部变量 数据总数, 整数型, , , 
.局部变量 局部_sql, 文本型, , , 

赋值 (局部_sql, 相加 (“select count(*) as 个数 from ”, 参数_数据表名, 选择 (或者 (是否为空 (参数_条件), 等于 (删全部空 (参数_条件), “”)), “”, 相加 (“ where ”, 参数_条件))))
赋值 (整数_记录集, 参数_外部数据库.查询 (局部_sql))
参数_外部数据库.到首记录 (整数_记录集)
赋值 (数据总数, 参数_外部数据库.读 (整数_记录集, “个数”))
参数_外部数据库.关闭记录集 (整数_记录集)
.如果真 (大于 (数据总数, 0))
    返回 (数据总数)
.如果真结束
返回 (0)

.类模块 彗星智能换肤类, , , 该类已在内部实例化，请勿再次实例化。

.子程序 设置图片皮肤, 逻辑型, , 
.参数 底图数据, 字节集, , 图片字节集



.子程序 设置图片皮肤_从文件, 逻辑型, , 
.参数 图片文件, 文本型, , 图片文件名



.子程序 设置颜色皮肤, 逻辑型, , 
.参数 皮肤颜色, 整数型, , 



.子程序 应用皮肤, 逻辑型, , 对窗口应用智能皮肤，请不要设置“窗口.随意移动=真”
.参数 窗口句柄, 整数型, , 要应用皮肤那个窗口的句柄
.参数 标题栏高度, 整数型, 可空, 默认为80
.参数 状态栏高度, 整数型, 可空, 默认为26
.参数 最小化按钮, 逻辑型, 可空, 是否有最小化按钮，默认为假
.参数 最大化按钮, 逻辑型, 可空, 是否有最大化按钮，默认为假
.参数 帮助按钮, 逻辑型, 可空, 是否有帮助按钮，默认为假
.参数 菜单按钮, 逻辑型, 可空, 是否有菜单按钮，默认为假
.参数 可调边框, 逻辑型, 可空, 是否有可调边框，如果为真可8方向调整大小，默认为假
.参数 窗口最小宽度, 整数型, 可空, 限制窗口调整尺寸的最小宽度
.参数 窗口最小高度, 整数型, 可空, 限制窗口调整尺寸的最小高度



.子程序 应用控件皮肤, 空白型, , 对子控件应用皮肤效果(按钮、编辑框等)


.子程序 置状态栏文本, 空白型, , 
.参数 窗口句柄, 整数型, , 
.参数 状态栏文本, 文本型, , 



.子程序 添加选择夹, 逻辑型, , 添加位于标题栏的选择夹按钮
.参数 窗口句柄, 整数型, , 
.参数 选择夹名称, 文本型, , 
.参数 选择夹图标, 字节集, , 应该为32x32的图标，可以是图标文件字节集，也可以是 到字节集(图标句柄)
.参数 关联窗口句柄, 整数型, 可空, 被关联窗口将会自动切换，可以为空
.参数 点击事件子程序, 子程序指针, 可空, 选择夹按钮被点击时调用的事件，可以为空



.子程序 选中选择夹, 逻辑型, , 按选择夹名称选中某个选择夹
.参数 窗口句柄, 整数型, , 
.参数 选择夹名称, 文本型, , 



.子程序 删除选择夹, 逻辑型, , 按选择夹名称删除某个选择夹
.参数 窗口句柄, 整数型, , 
.参数 选择夹名称, 文本型, , 



.子程序 事件_帮助按钮被点击, 空白型, , 
.参数 窗口句柄, 整数型, , 
.参数 事件子程序指针, 子程序指针, , 



.子程序 事件_菜单按钮被点击, 空白型, , 
.参数 窗口句柄, 整数型, , 
.参数 事件子程序指针, 子程序指针, , 



.子程序 置可调边框, 逻辑型, , 加入可调边框，窗口可手工调整尺寸
.参数 窗口句柄, 整数型, , 
.参数 窗口最小宽度, 整数型, 可空, 限制窗口调整尺寸的最小宽度
.参数 窗口最小高度, 整数型, 可空, 限制窗口调整尺寸的最小高度



.子程序 置客户区底色, 空白型, , 设置客户区底色，如果颜色值为-1，即为系统默认底色
.参数 颜色值, 整数型, , 如果设置为-1，即为系统默认底色



.子程序 取客户区底色, 整数型, , 返回客户区底色的颜色值


.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 随机_中文字, 文本型, , 
.参数 参数_中文字个数, 整数型, , 



.子程序 随机_数字, 文本型, , 
.参数 参数_个数, 整数型, , 
.参数 小数位, 整数型, , 



.子程序 随机_日期, 文本型, , 
.参数 开始年份, 整数型, 可空, 
.参数 结束年份, 整数型, 可空, 



.子程序 随机_数字字母, 文本型, , 
.参数 参数_个数, 整数型, , 



.子程序 打印超级列表框, 空白型, , 
.参数 超级列表框, 超级列表框, , 
.参数 主标题, 文本型, 可空, 



.子程序 排序, 空白型, , 超级列表框排序
.参数 超级列表框, 超级列表框, , 要排序的超级列表框
.参数 要排序的列, 整数型, , 写要排序的列号
.参数 要排序的类型, 整数型, , 1、文本。2、日期.3、整数。4、小数
.参数 自动调整列宽, 逻辑型, , 可空,真自动调整，假不调，空为假



.窗口程序集 窗口_工资录入, , , 

.程序集变量 工龄工资倍数, 双精度小数型, , , 
.程序集变量 旷工倍数, 双精度小数型, , , 
.程序集变量 正常加班倍数, 双精度小数型, , , 
.程序集变量 假日加班倍数, 双精度小数型, , , 
.程序集变量 集_ID, 整数型, , , 
.程序集变量 每天伙食费, 整数型, , , 
.子程序 _窗口_工资录入_创建完毕, 空白型, , 
子程序_参数初始化 ()
子程序_整体界面配置 ()
赋值 (.内容, 到文本 (取日期 (取现行时间 ())))
获取焦点 ()

.子程序 子程序_参数初始化, 空白型, , 
.局部变量 局_SQL语句, 文本型, , , 
.局部变量 局部_记录集, 整数型, , , 

赋值 (局_SQL语句, 相加 (“select * from 工资参数 where 参数名称='”, “平时加班倍率”, “'”))
赋值 (局部_记录集, 全局_外部数据库.查询 (局_SQL语句))
全局_外部数据库.到首记录 (局部_记录集)
赋值 (正常加班倍数, 到数值 (全局_外部数据库.读 (局部_记录集, “参数内容”)))
全局_外部数据库.关闭记录集 (局部_记录集)
赋值 (局_SQL语句, 相加 (“select * from 工资参数 where 参数名称='”, “六日加班倍率”, “'”))
赋值 (局部_记录集, 全局_外部数据库.查询 (局_SQL语句))
全局_外部数据库.到首记录 (局部_记录集)
赋值 (假日加班倍数, 到数值 (全局_外部数据库.读 (局部_记录集, “参数内容”)))
全局_外部数据库.关闭记录集 (局部_记录集)
赋值 (局_SQL语句, 相加 (“select * from 工资参数 where 参数名称='”, “工龄工资倍率”, “'”))
赋值 (局部_记录集, 全局_外部数据库.查询 (局_SQL语句))
全局_外部数据库.到首记录 (局部_记录集)
赋值 (工龄工资倍数, 到数值 (全局_外部数据库.读 (局部_记录集, “参数内容”)))
全局_外部数据库.关闭记录集 (局部_记录集)
赋值 (局_SQL语句, 相加 (“select * from 工资参数 where 参数名称='”, “旷工每天倍率”, “'”))
赋值 (局部_记录集, 全局_外部数据库.查询 (局_SQL语句))
全局_外部数据库.到首记录 (局部_记录集)
赋值 (旷工倍数, 到数值 (全局_外部数据库.读 (局部_记录集, “参数内容”)))
全局_外部数据库.关闭记录集 (局部_记录集)
赋值 (局_SQL语句, 相加 (“select * from 工资参数 where 参数名称='”, “每天伙食费”, “'”))
赋值 (局部_记录集, 全局_外部数据库.查询 (局_SQL语句))
全局_外部数据库.到首记录 (局部_记录集)
赋值 (每天伙食费, 到数值 (全局_外部数据库.读 (局部_记录集, “参数内容”)))
全局_外部数据库.关闭记录集 (局部_记录集)
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 子程序_整体界面配置, 空白型, , 
赋值 (.现行子夹, 0)
赋值 (.可视, 假)
赋值 (.可视, 假)
赋值 (.隐藏自身, 真)
连续赋值 (全局_背景颜色, ., .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色, .背景颜色)

.子程序 _窗口_工资录入_尺寸被改变, 空白型, , 
5.移动 (0, , )
5.移动 (相加 (.高度, .顶边, 5), , )
5.移动 (相加 (.高度, .顶边, 5), , )
5.移动 (相加 (.高度, .顶边, 5), , )
5.移动 (相加 (.高度, .顶边, 5), , )
5.移动 (0, , )
5.移动 (相加 (.高度, .顶边, 5), , )
5.移动 (相加 (.高度, .顶边, 5), , )


.子程序 子程序_工资信息_填数据, 空白型, , 
.参数 参数_ID, 整数型, , 

.局部变量 局部_记录集, 整数型, , , 

赋值 (集_ID, 参数_ID)
赋值 (局部_记录集, 全局_外部数据库.查询 (相加 (“select * from 工资表 where ID=”, 到文本 (集_ID), “”)))
全局_外部数据库.到首记录 (局部_记录集)
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “基本工资”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “福利费”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “社保”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “职工编号”))
赋值 (.内容, 到文本 (四舍五入 (相除 (到数值 (全局_外部数据库.读 (局部_记录集, “平时加班”)), 相乘 (相除 (到数值 (.内容), 21.75, 8), 正常加班倍数)), )))
赋值 (.内容, 到文本 (四舍五入 (相除 (到数值 (全局_外部数据库.读 (局部_记录集, “六日加班”)), 相乘 (相除 (到数值 (.内容), 21.75, 8), 假日加班倍数)), )))
赋值 (.内容, 到文本 (相除 (到数值 (全局_外部数据库.读 (局部_记录集, “伙食费”)), 每天伙食费)))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “住宿费”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “厂牌”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “厂服”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “罚款”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “津贴”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “其它应发”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “其它代扣”))
全局_外部数据库.关闭记录集 (局部_记录集)

赋值 (局部_记录集, 全局_外部数据库.查询 (相加 (“select * from 职工信息 where 职工编号='”, .内容, “'”)))
全局_外部数据库.到首记录 (局部_记录集)
赋值 (.内容, 到文本 (取日期 (到时间 (全局_外部数据库.读 (局部_记录集, “本单位工作时间”)))))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “部门职务”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “就职状态”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “职工姓名”))
全局_外部数据库.关闭记录集 (局部_记录集)


.子程序 _按钮_计算_被单击, 空白型, , 
赋值 (.现行子夹, 相加 (.现行子夹, 1))
子程序_选择夹显示 ()
子程序_计算工资 ()

.子程序 子程序_计算工资, 空白型, , 
赋值 (.内容, .内容)
赋值 (.内容, 到文本 (四舍五入 (相乘 (相除 (到数值 (.内容), 21.75, 8), 正常加班倍数, 到数值 (.内容)), 2)))
赋值 (.内容, 到文本 (四舍五入 (相乘 (相除 (到数值 (.内容), 21.75, 8), 假日加班倍数, 到数值 (.内容)), 2)))
赋值 (.内容, .内容)
赋值 (.内容, .内容)
赋值 (.内容, 到文本 (相乘 (子程序_取工龄 (), 工龄工资倍数)))
赋值 (.内容, 到文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容))))
赋值 (.内容, .内容)
赋值 (.内容, .内容)
赋值 (.内容, .内容)
赋值 (.内容, .内容)
赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 每天伙食费)))
赋值 (.内容, .内容)
赋值 (.内容, .内容)
赋值 (.内容, 到文本 (相乘 (到数值 (.内容), 旷工倍数)))
赋值 (.内容, 到文本 (计算所得税 (相减 (到数值 (.内容), 到数值 (.内容), 2000))))
赋值 (.内容, 到文本 (相加 (到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容), 到数值 (.内容))))
赋值 (.内容, 到文本 (相减 (到数值 (.内容), 到数值 (.内容))))

.子程序 子程序_取工龄, 整数型, , 
.局部变量 取年, 整数型, , , 
.局部变量 取月, 整数型, , , 
.局部变量 取日, 整数型, , , 
.局部变量 现在年, 整数型, , , 
.局部变量 现在月, 整数型, , , 
.局部变量 现在日, 整数型, , , 
.局部变量 工龄, 整数型, , , 

赋值 (取年, 取年份 (到时间 (.内容)))
赋值 (取月, 取月份 (到时间 (.内容)))
赋值 (取日, 取日 (到时间 (.内容)))
赋值 (现在年, 取年份 (取现行时间 ()))
赋值 (现在月, 取月份 (取现行时间 ()))
赋值 (现在日, 取日 (取现行时间 ()))
.判断开始 (大于 (取月, 现在月))
    赋值 (工龄, 相减 (现在年, 取年, 1))
.默认
    
.判断结束
.判断开始 (小于 (取月, 现在月))
    赋值 (工龄, 相减 (现在年, 取年))
.默认
    
.判断结束
.判断开始 (等于 (取月, 现在月))
    .判断开始 (大于 (取日, 现在日))
        赋值 (工龄, 相减 (现在年, 取年, 1))
    .默认
        赋值 (工龄, 相减 (现在年, 取年))
    .判断结束
    
.默认
    
.判断结束
返回 (工龄)

.子程序 计算所得税, 双精度小数型, , 
.参数 应发薪资, 双精度小数型, , 

.局部变量 所得税变量, 双精度小数型, , , 应发工资-2000
.局部变量 变量1, 双精度小数型, , , 
.局部变量 变量2, 双精度小数型, , , 
.局部变量 变量3, 双精度小数型, , , 
.局部变量 变量4, 双精度小数型, , , 
.局部变量 变量5, 双精度小数型, , , 
.局部变量 变量6, 双精度小数型, , , 
.局部变量 变量7, 双精度小数型, , , 
.局部变量 变量8, 双精度小数型, , , 
.局部变量 变量9, 双精度小数型, , , 
.局部变量 计算变量, 双精度小数型, , , 计算工资
.局部变量 所得税, 双精度小数型, , , 

赋值 (所得税变量, 相除 (到数值 (应发薪资), 12))
赋值 (变量1, 相乘 (到数值 (应发薪资), 0.05))
赋值 (变量2, 相减 (相乘 (到数值 (应发薪资), 0.1), 25))
赋值 (变量3, 相减 (相乘 (到数值 (应发薪资), 0.15), 125))
赋值 (变量4, 相减 (相乘 (到数值 (应发薪资), 0.2), 375))
赋值 (变量5, 相减 (相乘 (到数值 (应发薪资), 0.25), 1375))
赋值 (变量6, 相减 (相乘 (到数值 (应发薪资), 0.3), 3375))
赋值 (变量7, 相减 (相乘 (到数值 (应发薪资), 0.35), 6375))
赋值 (变量8, 相减 (相乘 (到数值 (应发薪资), 0.4), 10375))
赋值 (变量9, 相减 (相乘 (到数值 (应发薪资), 0.45), 15375))
.判断开始 (小于 (所得税变量, 500))
    赋值 (计算变量, 变量1)
.判断 (小于 (所得税变量, 2000))
    赋值 (计算变量, 变量2)
.判断 (小于 (所得税变量, 5000))
    赋值 (计算变量, 变量3)
.判断 (小于 (所得税变量, 20000))
    赋值 (计算变量, 变量4)
.判断 (小于 (所得税变量, 40000))
    赋值 (计算变量, 变量5)
.判断 (小于 (所得税变量, 60000))
    赋值 (计算变量, 变量6)
.判断 (小于 (所得税变量, 80000))
    赋值 (计算变量, 变量7)
.判断 (小于 (所得税变量, 100000))
    赋值 (计算变量, 变量8)
.默认
    赋值 (计算变量, 变量9)
.判断结束
赋值 (所得税, 四舍五入 (计算变量, 2))
.判断开始 (大于或等于 (所得税, 0))
    返回 (所得税)
.默认
    返回 (0)
.判断结束


.子程序 _按钮_返回_被单击, 空白型, , 
赋值 (.现行子夹, 相减 (.现行子夹, 1))
子程序_选择夹显示 ()

.子程序 子程序_选择夹显示, 空白型, , 
.如果 (等于 (.现行子夹, 0))
    赋值 (.可视, 真)
    赋值 (.可视, 假)
    赋值 (.可视, 假)
.否则
    
.如果结束
.如果 (大于 (.现行子夹, 0))
    赋值 (.可视, 真)
.否则
    赋值 (.可视, 假)
.如果结束
.如果 (等于 (.现行子夹, 相减 (取子夹数目 (), 1)))
    赋值 (.可视, 真)
    赋值 (.可视, 假)
.否则
    赋值 (.可视, 真)
    赋值 (.可视, 假)
.如果结束
.判断开始 (等于 (.现行子夹, 0))
    获取焦点 ()
.默认
    
.判断结束


.子程序 _按钮_完成_被单击, 空白型, , 
添加记录 ()
子程序_显示工资列表 (“select * from 工资表”)

.子程序 添加记录, 空白型, , 
.局部变量 局部_物件, 文本型, , , 
.局部变量 局部_行为, 文本型, , , 
.局部变量 局部_记录集, 整数型, , , 
.局部变量 局部_姓名简码, 文本型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请输入职工编号！”, #错误图标, )
    赋值 (.现行子夹, 0)
    子程序_选择夹显示 ()
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入职工姓名！”, #错误图标, )
    赋值 (.现行子夹, 0)
    子程序_选择夹显示 ()
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入基本工资！”, #错误图标, )
    赋值 (.现行子夹, 0)
    子程序_选择夹显示 ()
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (局部_姓名简码, 辅助功能_取首拼 (.内容))
赋值 (局部_记录集, 全局_外部数据库.查询 (“select * from 工资表”))
全局_外部数据库.到首记录 (局部_记录集)
.判断循环首 (等于 (全局_外部数据库.尾记录后 (局部_记录集), 假))
    .如果真 (等于 (全局_外部数据库.读 (局部_记录集, “职工编号”), .内容))
        .如果 (等于 (全局_外部数据库.执行 (相加 (“UPDATE 工资表 SET 职工编号='”, .内容, “', 姓名简码='”, 局部_姓名简码, “', 职工姓名='”, .内容, “', 其它应发='”, .内容, “', 平时加班='”, .内容, “', 六日加班='”, .内容, “', 基本工资='”, .内容, “', 津贴='”, .内容, “', 年资='”, .内容, “', 应发合计='”, .内容, “', 社保='”, .内容, “', 个人所得税='”, .内容, “', 厂牌='”, .内容, “', 伙食费='”, .内容, “', 住宿费='”, .内容, “', 急辞旷工='”, .内容, “', 罚款='”, .内容, “', 厂服='”, .内容, “', 福利费='”, .内容, “', 其它代扣='”, .内容, “', 应扣合计='”, .内容, “', 实发合计='”, .内容, “', 标识状态='”, “已修改”, “' where ID=”, 到文本 (集_ID)), ), 假))
            信息框 (“失败！”, #错误图标, )
            返回 ()
        .否则
            信息框 (相加 (“职工编号为：”, .内容, “的工资信息修改成功！”), #信息图标, )
            赋值 (.可视, 真)
            赋值 (.可视, 假)
            赋值 (.可视, 假)
            返回 ()
        .如果结束
        
    .如果真结束
    全局_外部数据库.到后一记录 (局部_记录集)
.判断循环尾 ()
全局_外部数据库.关闭记录集 (局部_记录集)
赋值 (局部_记录集, 全局_外部数据库.查询 (“select * from 职工信息”))
全局_外部数据库.到首记录 (局部_记录集)
.判断循环首 (等于 (全局_外部数据库.尾记录后 (局部_记录集), 假))
    .如果真 (等于 (全局_外部数据库.读 (局部_记录集, “职工编号”), .内容))
        .如果 (等于 (全局_外部数据库.执行 (相加 (“insert into 工资表(职工编号,职工姓名,姓名简码,基本工资,其它应发,平时加班,六日加班,津贴,年资,应发合计,社保,个人所得税,厂牌,伙食费,住宿费,急辞旷工,罚款,厂服,福利费,其它代扣,应扣合计,实发合计,标识状态)values ('”, .内容, “','”, .内容, “','”, 局部_姓名简码, “','”, .内容, “','”, .内容, “', '”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, .内容, “','”, “已修改”, “')”), ), 假))
            信息框 (“添加失败！”, #错误图标, )
            返回 ()
        .否则
            信息框 (相加 (“职工编号为：”, .内容, “的工资信息添加成功！”), #信息图标, )
            赋值 (.可视, 真)
            赋值 (.可视, 假)
            赋值 (.可视, 假)
        .如果结束
        
    .如果真结束
    全局_外部数据库.到后一记录 (局部_记录集)
.判断循环尾 ()
全局_外部数据库.关闭记录集 (局部_记录集)


.子程序 _按钮_查找_被单击, 空白型, , 
载入 (窗口_职工管理_主界面, , 假)


.子程序 子程序_取职工信息, 空白型, , 
.参数 参数_职工编号, 文本型, , 

.局部变量 局部_sql, 文本型, , , 
.局部变量 局部_记录集, 整数型, , , 

赋值 (.内容, 参数_职工编号)
赋值 (局部_sql, 相加 (“select * from 职工信息 where 职工编号='”, 参数_职工编号, “'”))
赋值 (局部_记录集, 全局_外部数据库.查询 (局部_sql))
全局_外部数据库.到首记录 (局部_记录集)
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “职工姓名”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “本单位工作时间”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “部门职务”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “就职状态”))
全局_外部数据库.关闭记录集 (局部_记录集)

.子程序 _按钮_继续_被单击, 空白型, , 
赋值 (.现行子夹, 0)
子程序_选择夹显示 ()
_依次修改工资_被选择 ()


.子程序 _编辑框_职工编号_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框_平时加班_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框_六日加班_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框_旷工天数_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束



.子程序 _编辑框_基本工资_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框_补助津贴_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束



.子程序 _编辑框_社会保险_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束



.子程序 _编辑框_福利费_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框_其他应发_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框_其他代扣_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框_伙食费_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框_服装费_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框_住宿费_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框_厂牌费_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框_罚款_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    获取焦点 ()
.否则
    
.如果结束


.子程序 _按钮_计算_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    _按钮_计算_被单击 ()
    获取焦点 ()
.否则
    
.如果结束


.子程序 _按钮_完成_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    _按钮_完成_被单击 ()
    获取焦点 ()
.否则
    
.如果结束


.子程序 _按钮_继续_按下某键, 逻辑型, , 
.参数 键代码, 整数型, , 
.参数 功能键状态, 整数型, , 

.如果 (等于 (键代码, 13))
    _按钮_继续_被单击 ()
    获取焦点 ()
.否则
    
.如果结束


.子程序 _编辑框_职工编号_鼠标左键被按下, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

_按钮_查找_被单击 ()

.窗口程序集 窗口_参数管理, , , 

.子程序 _窗口_参数管理_创建完毕, 空白型, , 
子程序_显示参数列表 ()

.子程序 子程序_显示参数列表, 空白型, , 
.局部变量 局_SQL语句, 文本型, , , 
.局部变量 局部_记录集, 整数型, , , 
.局部变量 局部_id, 整数型, , , 
.局部变量 局部_索引, 整数型, , , 

全部删除 ()
赋值 (局_SQL语句, “select * from 工资参数”)
赋值 (局部_记录集, 全局_外部数据库.查询 (局_SQL语句))
全局_外部数据库.到首记录 (局部_记录集)
.判断循环首 (等于 (全局_外部数据库.尾记录后 (局部_记录集), 假))
    赋值 (局部_id, 全局_外部数据库.读 (局部_记录集, “ID”))
    赋值 (局部_索引, .插入表项 (局部_id))
    局部_索引.置标题 (0, 到文本 (全局_外部数据库.读 (局部_记录集, “参数名称”)))
    局部_索引.置标题 (1, 到文本 (全局_外部数据库.读 (局部_记录集, “参数内容”)))
    全局_外部数据库.到后一记录 (局部_记录集)
.判断循环尾 ()
全局_外部数据库.关闭记录集 (局部_记录集)
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _列表框_参数列表_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

.判断开始 (大于或等于 (., 0))
    载入 (窗口_参数添加修改, 窗口_参数管理, 假)
    赋值 (窗口_参数添加修改..标题, “修改”)
    赋值 (窗口_参数添加修改., “修改工资参数”)
    子程序_工资参数_填数据 (.取表项数值 (.))
.默认
    返回 ()
.判断结束


.窗口程序集 窗口_参数添加修改, , , 

.程序集变量 集_ID, 整数型, , , 
.子程序 _窗口_参数添加修改_创建完毕, 空白型, , 


.子程序 子程序_工资参数_填数据, 空白型, , 
.参数 参数_ID, 整数型, , 

.局部变量 局部_sql, 文本型, , , 
.局部变量 局部_记录集, 整数型, , , 

赋值 (集_ID, 参数_ID)
赋值 (局部_sql, 相加 (“select * from 工资参数 where ID=”, 到文本 (参数_ID), “”))
赋值 (局部_记录集, 全局_外部数据库.查询 (局部_sql))
全局_外部数据库.到首记录 (局部_记录集)
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “参数名称”))
赋值 (.内容, 全局_外部数据库.读 (局部_记录集, “参数内容”))
全局_外部数据库.关闭记录集 (局部_记录集)
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _按钮_添加_被单击, 空白型, , 
.判断开始 (等于 (.标题, “添加”))
    子程序_添加工资参数 ()
.判断 (等于 (.标题, “修改”))
    子程序_修改工资参数 ()
.默认
    
.判断结束


.子程序 子程序_添加工资参数, 空白型, , 
.局部变量 局部_记录集, 整数型, , , 

.如果真 (等于 (.内容, “”))
    信息框 (“请输入参数名称！”, #错误图标, )
    获取焦点 ()
    返回 ()
.如果真结束
.如果真 (等于 (.内容, “”))
    信息框 (“请输入参数内容！”, #错误图标, )
    获取焦点 ()
    返回 ()
.如果真结束
赋值 (局部_记录集, 全局_外部数据库.查询 (“select * from 工资参数”))
全局_外部数据库.到首记录 (局部_记录集)
.判断循环首 (等于 (全局_外部数据库.尾记录后 (局部_记录集), 假))
    .如果真 (等于 (全局_外部数据库.读 (局部_记录集, “参数名称”), .内容))
        信息框 (“请不要重复登记！”, #信息图标, )
        返回 ()
    .如果真结束
    全局_外部数据库.到后一记录 (局部_记录集)
.判断循环尾 ()
全局_外部数据库.关闭记录集 (局部_记录集)
.如果 (等于 (全局_外部数据库.执行 (相加 (“insert into 工资参数(参数名称,参数内容) values ('”, .内容, “','”, .内容, “')”), ), 假))
    信息框 (“添加失败！”, #信息图标, )
    返回 ()
.否则
    信息框 (“添加成功！”, #信息图标, )
    子程序_显示参数列表 ()
.如果结束


.子程序 子程序_修改工资参数, 空白型, , 
.如果 (等于 (全局_外部数据库.执行 (相加 (“UPDATE 工资参数 SET  参数名称='”, .内容, “', 参数内容='”, .内容, “' where ID=”, 到文本 (集_ID)), ), 假))
    信息框 (“修改失败！数据库出错！”, #信息图标, “修改失败！数据库出错！”)
    返回 ()
.否则
    信息框 (“修改完成！”, #信息图标, “修改完成！”)
    子程序_显示参数列表 ()
.如果结束


.子程序 _按钮_退出_被单击, 空白型, , 
销毁 ()

.窗口程序集 窗口_帮助, , , 

.子程序 _窗口_帮助_创建完毕, 空白型, , 
' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _编辑框1_被双击, 逻辑型, , 
.参数 横向位置, 整数型, , 
.参数 纵向位置, 整数型, , 
.参数 功能键状态, 整数型, , 

销毁 ()

.子程序 _窗口_帮助_尺寸被改变, 空白型, , 
 ' 0.移动 (0, 取用户区宽度 (), 取用户区高度 ())


.程序集 超级列表框到Excel, , , 

.程序集变量 行, 整数型, , , 
.程序集变量 列, 整数型, , , 
.子程序 超级列表框到Excel, 空白型, , 
.参数 参数_超级列表框, 超级列表框, , 
.参数 参数_通用对话框, 通用对话框, , 
.参数 参数_Excel程序, 未知类型0x50001, , 
.参数 参数_Excel工作簿, 未知类型0x50002, , 

.局部变量 文件名, 文本型, , , 
.局部变量 导出行, 整数型, , , 
.局部变量 导出列, 整数型, , , 
.局部变量 局部_Execl文件, 文本型, , , 
.局部变量 文本, 文本型, , , 

' 本源码来自易语言资源网(www.5A5X.com)
.如果真 (等于 (参数_超级列表框.取表项数 (), 0))
    信息框 (“当前列表没有可导出的数据。”, #信息图标, “温馨提示”)
    返回 ()
.如果真结束
赋值 (参数_通用对话框.类型, 1)
赋值 (参数_通用对话框.过滤器, “Excel文件(*.xls)|*.xls”)
赋值 (参数_通用对话框.默认文件后缀, “.xls”)
.如果真 (取反 (文件是否存在 (相加 (取运行目录 (), “\Excel”))))
    创建目录 (相加 (取运行目录 (), “\Excel”))
.如果真结束
赋值 (参数_通用对话框.初始目录, 相加 (取运行目录 (), “\Excel”))
.如果真 (等于 (参数_通用对话框.打开 (), 假))
    返回 ()
.如果真结束
赋值 (局部_Execl文件, 参数_通用对话框.文件名)
.如果真 (文件是否存在 (局部_Execl文件))
    删除文件 (局部_Execl文件)
.如果真结束
.如果真 (等于 (参数_Excel程序.未知支持库函数_0 (), 假))
    信息框 (“你的计算机上没有安装EXCEL程序”, 0, )
    结束 ()
.如果真结束
赋值 (参数_Excel程序., 真)
参数_Excel工作簿.未知支持库函数_6 (参数_Excel程序)
参数_Excel工作簿.未知支持库函数_20 ()

 ' '''将超级列表框的列标题也导入Excel中..
.变量循环首 (1, 参数_超级列表框.取列数 (), 1, 行)
    赋值 (文本, 字符 (相加 (96, 行)))
    赋值 (参数_Excel工作簿., 相加 (文本, 到文本 (1)))
    赋值 (参数_Excel工作簿., 相加 (文本, 到文本 (1)))
    赋值 (参数_Excel工作簿., “@”)
    赋值 (参数_Excel工作簿., 参数_超级列表框.取列标题 (相减 (行, 1)))
     ' 输出调试文本 (超级列表框.取列标题 (x － 1))
    赋值 (参数_Excel工作簿., 9)
    赋值 (参数_Excel工作簿., 真)
    赋值 (参数_Excel工作簿., #蓝色)
    参数_Excel工作簿.未知支持库函数_30 (1, 2, #黑色)
    赋值 (参数_Excel工作簿., -4108)
    赋值 (参数_Excel工作簿., -4108)
.变量循环尾 ()

.计次循环首 (参数_超级列表框.取列数 (), 导出列)
    .计次循环首 (参数_超级列表框.取表项数 (), 导出行)
        处理事件 ()
        赋值 (参数_Excel工作簿., 相加 (整数到字母 (导出列), 到文本 (相加 (导出行, 1))))
        赋值 (参数_Excel工作簿., 相加 (整数到字母 (导出列), 到文本 (相加 (导出行, 1))))
        赋值 (参数_Excel工作簿., 参数_超级列表框.取标题 (相减 (导出行, 1), 相减 (导出列, 1)))
        赋值 (参数_Excel工作簿., -4108)
        赋值 (参数_Excel工作簿., -4108)
    .计次循环尾 ()
.计次循环尾 ()
 ' 删除文件 (局部_Execl文件)  ' 处理提示重新保存的对话框，也可用 _Excel程序1_工作簿即将保存 事件
参数_Excel工作簿.未知支持库函数_16 (局部_Execl文件)
参数_Excel工作簿.未知支持库函数_14 (局部_Execl文件)
参数_Excel工作簿.未知支持库函数_7 ()


.子程序 整数到字母, 文本型, , 
.参数 数值, 整数型, , 

.局部变量 字母组, 文本型, , "0", 
.局部变量 字母, 文本型, , , 

赋值 (字母组, { “a”, “b”, “c”, “d”, “e”, “f”, “g”, “h”, “i”, “j”, “k”, “l”, “m”, “n”, “o”, “p”, “q”, “r”, “s”, “t”, “u”, “v”, “w”, “x”, “y”, “z” })
.如果真 (小于 (数值, 27))
    赋值 (字母, 字母组 [数值])
.如果真结束
.如果真 (并且 (大于 (数值, 26), 小于 (数值, 53)))
    赋值 (字母, 相加 (“a”, 字母组 [相减 (数值, 26)]))
.如果真结束
.如果真 (并且 (大于 (数值, 52), 小于 (数值, 79)))
    赋值 (字母, 相加 (“b”, 字母组 [相减 (数值, 52)]))
.如果真结束
返回 (字母)
 ' ''下面可以以此类推..根据数值取出EXCEL的列标题..

.子程序 Excel到超级列表框, 空白型, , 
.参数 参数_超级列表框, 超级列表框, , 
.参数 参数_通用对话框, 通用对话框, , 
.参数 参数_Excel程序, 未知类型0x50001, , 
.参数 参数_Excel工作簿, 未知类型0x50002, , 

.局部变量 局部_Execl文件, 文本型, , , 
.局部变量 范围, 对象, , , 
.局部变量 行对象, 对象, , , 
.局部变量 列对象, 对象, , , 
.局部变量 单元格对象, 对象, , , 
.局部变量 工作簿对象, 对象, , , 
.局部变量 i, 整数型, , , 
.局部变量 p, 整数型, , , 
.局部变量 索引, 整数型, , , 
.局部变量 q, 整数型, , , 
.局部变量 l, 整数型, , , 

赋值 (参数_通用对话框.类型, 0)
赋值 (参数_通用对话框.过滤器, “Excel文件(*.xls)|*.xls|*.xlsx”)
赋值 (参数_通用对话框.默认文件后缀, “.xls”)
赋值 (参数_通用对话框.初始目录, 相加 (取运行目录 (), “\Excel”))
.如果真 (参数_通用对话框.打开 ())
    赋值 (局部_Execl文件, 参数_通用对话框.文件名)
.如果真结束
.如果真 (等于 (参数_Excel程序.未知支持库函数_0 (), 假))
    信息框 (“你的计算机上没有安装EXCEL程序”, 0, )
    结束 ()
.如果真结束
赋值 (参数_Excel程序., 假)
参数_Excel工作簿.未知支持库函数_6 (参数_Excel程序)
参数_Excel工作簿.未知支持库函数_14 (局部_Execl文件)
参数_Excel工作簿.未知支持库函数_20 ()
参数_Excel工作簿.未知支持库函数_19 ()
赋值 (参数_Excel工作簿., 1)
赋值 (工作簿对象, 参数_Excel工作簿.未知支持库函数_12 ())
赋值 (范围, 工作簿对象.读对象型属性 (“UsedRange”, ))
赋值 (行对象, 范围.读对象型属性 (“Rows”, ))
赋值 (行, 行对象.读数值属性 (“Count”, ))
赋值 (列对象, 范围.读对象型属性 (“Columns”, ))
赋值 (列, 列对象.读数值属性 (“Count”, ))
输出调试文本 (到文本 (行))
输出调试文本 (到文本 (列))
参数_超级列表框.全部删除 ()
赋值 (l, 0)
.计次循环首 (参数_超级列表框.取列数 (), l)
    参数_超级列表框.删除列 (l)
.计次循环尾 ()
.计次循环首 (列, q)
    参数_超级列表框.插入列 (-1, 到文本 (q), 80, , , )
.计次循环尾 ()
.计次循环首 (行, p)
    赋值 (索引, 参数_超级列表框.插入表项 ())
    .计次循环首 (列, i)
        处理事件 ()
        赋值 (参数_Excel工作簿., 相加 (整数到字母 (i), 到文本 (p)))
        赋值 (参数_Excel工作簿., 相加 (整数到字母 (i), 到文本 (p)))
        赋值 (单元格对象, 参数_Excel工作簿.未知支持库函数_13 ())
        参数_超级列表框.置标题 (索引, 相减 (i, 1), 单元格对象.读文本属性 (“Value”, ))
    .计次循环尾 ()
.计次循环尾 ()
参数_Excel工作簿.未知支持库函数_15 ()
参数_Excel工作簿.未知支持库函数_7 ()




.窗口程序集 窗口_换肤, , , 

.子程序 _窗口_换肤_创建完毕, 空白型, , 
赋值 (窗口_换肤., _启动窗口.)
赋值 (窗口_换肤., 相减 (相加 (_启动窗口., _启动窗口.), 窗口_换肤.))

.子程序 _按钮1_被单击, 空白型, , 
.如果真 (打开 ())
    智能换肤.设置图片皮肤_从文件 (.文件名)
.如果真结束
 ' 本源码来自易语言资源网(www.5A5X.com)

.子程序 _按钮2_被单击, 空白型, , 
写配置项 (相加 (取运行目录 (), “\sysset.ini”), “系统默认”, “背景图片”, .文件名)


.子程序 _按钮3_被单击, 空白型, , 
_启动窗口.子程序_写配置项 ()


 ' 不属于任何一个程序集、类模块的函数：
