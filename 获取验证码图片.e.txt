 ' 文件类型：Windows窗口程序

 ' 程序名称：
 ' 程序描述：
 ' 程序作者：本源码来自易语言资源网(www.wodesoft.com)
 ' 邮政编码：
 ' 联系地址：
 ' 联系电话：
 ' 传真号码：
 ' 电子信箱：
 ' 主页地址：
 ' 版权声明：             易语言资源网注意事项
--============   www.wodesoft.com  =============--
* 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权纠纷本站概不负责！
* 本站资源未经许可,任何网站不得非法盗链及抄袭本站资源；如引用，请注明来自易语言资源网，谢谢合作！
--============   www.wodesoft.com  =============--
 ' 版本号：1.0
 ' 创建号：0.0

窗口 窗口1
    左边 = 50
    顶边 = 50
    宽度 = 705
    高度 = 608
    鼠标指针 = { 0,0,0,0 }
    标记 = “”
    可视 = 真
    禁止 = 假
    边框 = 2
    底图方式 = 1
    底色 = -16777216 '  0xFF000000
    最大化按钮 = 假
    最小化按钮 = 假
    控制按钮 = 真
    位置 = 1
    可否移动 = 真
    背景音乐播放次数 = 0
    回车下移焦点 = 假
    Esc键关闭 = 真
    F1键打开帮助 = 假
    帮助标志值 = 0
    在任务栏中显示 = 真
    随意移动 = 假
    外形 = 0
    总在最前 = 假
    保持标题栏激活 = 假
    底图 =  ' 空
    图标 =  ' 空
    背景音乐 =  ' 空
    标题 = “验证码图片抓取演示”
    帮助文件名 = “”





 ' 所需要的支持库：
 ' krnln d09f2340818511d396f6aaf844c7e325 5 0 系统核心支持库
 ' HtmlView 5014D8FA6DCA40b68FA626D8183666EB 2 0 超文本浏览框支持库



 ' 所需要的模块
 ' 超级图形模块 $my_pic.ec


数据类型 _RECT, 公开, 
    .成员 left, 整数型, , , 
    .成员 top, 整数型, , , 
    .成员 right, 整数型, , , 
    .成员 bottom, 整数型, , , 

数据类型 _矩形, 公开, 
    .成员 矩形左边, 整数型, , , 
    .成员 矩形顶边, 整数型, , , 
    .成员 矩形宽度, 整数型, , , 
    .成员 矩形高度, 整数型, , , 

数据类型 _坐标, 公开, 
    .成员 x, 整数型, , , X轴坐标
    .成员 y, 整数型, , , Y轴坐标


.程序集 程序集1, , , 

.子程序 _启动子程序, 整数型, , 本子程序在程序启动后最先执行
载入 (窗口1, , 真)

返回 (0) ' 可以根据您的需要返回任意数值

.窗口程序集 窗口程序集1, , , 

.子程序 _按钮2_被单击, 空白型, , 
 ' --========  易语言资源网  (www.wodesoft.com)  ======--
 ' 努力创建完善、持续更新的易语言学习例程源码资源站
 ' --================   www.wodesoft.com  ===========--
 ' --==================   易语言资源网注意事项  ================--
 ' * 易语言资源网为易语言官方站、易语言官方论坛提供辅助资源站；
 ' 本易语言资源网( www.wodesoft.com)所有软件和资料均为软件作者提
 ' 供和网友推荐发布而来，其版权归该软件和程序源码的合法拥有者所
 ' 有，本站易语言资源网整理收集仅供易语言用户学习和易语言技术研
 ' 究探讨使用，不得用于任何商业用途。如果由于以上原因造成的版权
 ' 纠纷本站概不负责！
 ' * 本站资源未经许可，任何网站不得非法盗链及抄袭本站资源；如引用
 ' 页面，请注明来自易语言资源网，谢谢合作！
 ' --=====================   www.wodesoft.com  ================--

“http://www.jj.js.cn/bbs/”.未知支持库函数_1 ()

.子程序 _按钮1_被单击, 空白型, , 
.局部变量 z, 字节集, , , 

赋值 (z, 截图前台_ (取窗口句柄 (), 到整数 (.内容), 到整数 (.内容), 到整数 (.内容), 到整数 (.内容), , , ))
赋值 (.图片, z)
 ' 本源码来自易语言资源网(www.wodesoft.com)

.类模块 内存转换图片格式, , , 

.子程序 转换图像格式, 逻辑型, , 支持bmp、jpg、gif、tiff、png互转。
.参数 图像数据, 字节集, , 被转换的图像数据
.参数 转换格式, 整数型, , 转换后的图片格式。1、bmp；2、jpg；3、gif；4、tiff；5、png
.参数 新图像, 字节集, 参考, 用于保存新图像的变量
.参数 不释放内存, 逻辑型, 参考, 频繁释放内存的话容易出错，大量调用的时候请设置为真



.子程序 转换图像格式2, 逻辑型, , 支持bmp、jpg、gif、tiff、png互转。  由于模式1在连续多次使用后容易出错 所以特开放模式2，使用这种模式的话请申明为全局模块
.参数 图像数据, 字节集, , 被转换的图像数据
.参数 转换格式, 整数型, , 转换后的图片格式。1、bmp；2、jpg；3、gif；4、tiff；5、png
.参数 新图像, 字节集, 参考, 用于保存新图像的变量
.参数 单次申请内存, 整数型, 参考, 多少K  1024k=1M 请稍微大于最大图片大小



.程序集 __HIDDEN_TEMP_MOD__, , , 

.子程序 截图后台_, 字节集, , 可后台截取,窗口
.参数 窗口句柄, 整数型, , 不能为0，会出错
.参数 rc, _RECT, 可空, 要截取的范围
.参数 位深, 整数型, 可空, 16.24.32 默认24



.子程序 时间差_, 文本型, , 
.参数 是否输出, 逻辑型, 可空, 真为输出假为初始
.参数 代号, 文本型, 可空, 



.子程序 转换颜色值_, 空白型, , 
.参数 颜色值, 整数型, , 
.参数 红, 整数型, 参考, 
.参数 绿, 整数型, 参考, 
.参数 蓝, 整数型, 参考, 



.子程序 取颜色_, 整数型, , 取窗口中指定点颜色,句柄为空,则取屏幕中点的颜色.(返回10进制颜色值) [斩月]
.参数 窗口句柄, 整数型, 可空, 窗口句柄(可空:取屏幕中)建意为空! 窗口句柄只能为顶级窗口句柄!
.参数 水平位置, 整数型, , 指定点横坐标 (如果在窗口中,则为窗口内客户区坐标)
.参数 垂直位置, 整数型, , 指定点纵坐标



.子程序 取颜色RGB_, 整数型, , 取指定颜色的RGB单色(返回R色,G色或B色:0-255)
.参数 颜色, 整数型, , 欲取颜色RGB单值的十进制颜色
.参数 RGB类型, 整数型, , 1 取R色  2 取G色  3 取B色



.子程序 取颜色差_, 整数型, ,  取两个十进制颜色的颜色差值,返回(颜色差值)
.参数 颜色一, 整数型, , 十进制颜色一
.参数 颜色二, 整数型, , 十进制颜色二
.参数 比较方式, 整数型, 可空, 可空为0:取最大色差  1 取R色差(红)  2 取G色差(绿)  3 取B色差(蓝)  4 取总色差(三差之和)



.子程序 取颜色色彩度_, 整数型, , 取指定颜色的色彩度(返回色彩度:0-255)
.参数 颜色, 整数型, , 欲取色彩的十进制颜色



.子程序 取颜色亮度_, 整数型, , 取指定颜色的亮度(返回亮度:0-255)
.参数 颜色, 整数型, , 欲取亮度的十进制颜色



.子程序 屏幕写字_, 逻辑型, , 向指定窗口中写入文字内容(成功:返回 真)
.参数 内容, 文本型, , 欲写入的文本内容
.参数 颜色, 整数型, 可空, 为空则默认为:#红色 
.参数 窗口句柄, 整数型, 可空, 欲写入文字的窗口的句柄   为空则为屏幕
.参数 始位置x, 整数型, 可空, 写入文字内容的起始位置x横坐标(为空:0)
.参数 始位置y, 整数型, 可空, 写入文字内容的起始位置y纵坐标(为空:0)
.参数 字体大小, 整数型, 可空, 为空则默认为:16     (字体大小为:像素)    
.参数 字体名称, 文本型, 可空, !为空则默认为:"宋体" 更多字体请查看相关资料!
.参数 加粗, 逻辑型, 可空, !为空:不加粗    真:加粗   假:不加粗 
.参数 倾斜, 逻辑型, 可空, !为空:不倾斜    真:倾斜   假:不倾斜
.参数 下划线, 逻辑型, 可空, !为空:无下划线  真:下划线 假:无下划线



.子程序 置显示器信息_, 整数型, , 设置屏幕分辨率返回0表示成功
.参数 色深, 短整数型, 可空, 新的色深 可空:不改变原先设定
.参数 屏幕宽度, 短整数型, 可空, 新的屏幕宽度 可空:不改变原先设定
.参数 屏幕高度, 短整数型, 可空, 新的屏幕高度 可空:不改变原先设定
.参数 屏幕刷新率, 短整数型, 可空, 新的屏幕刷新率 可空:不改变原先设定



.子程序 取显示器信息_, 空白型, , 获取屏幕分辨率(无返回值)
.参数 色深, 短整数型, 参考 可空, 
.参数 屏幕宽度, 短整数型, 参考 可空, 
.参数 屏幕高度, 短整数型, 参考 可空, 
.参数 屏幕刷新率, 短整数型, 参考 可空, 



.子程序 截图前台_, 字节集, , 截取指定窗口的位图,可截取窗口中指定区域,最小化窗口或不可见窗口无法截取位图
.参数 窗口句柄, 整数型, 可空, 窗口句柄，空为桌面,截取窗口有可能出错
.参数 左边, 整数型, 可空, 默认为0 截取图片的左边
.参数 顶边, 整数型, 可空, 默认为0 在窗口中截取图片的顶边
.参数 宽度, 整数型, 可空, 默认为屏幕宽度,截取图片的宽度
.参数 高度, 整数型, 可空, 默认为屏幕高度,截取图片的高度
.参数 位深, 整数型, 可空, 16、24、32 默认24
.参数 缩放宽, 整数型, 可空, 空为原图,想得到的宽度
.参数 缩放高, 整数型, 可空, 缩放值



.子程序 鼠标移动_, 空白型, , 模拟鼠标移动(无返回值)
.参数 窗口句柄, 整数型, 可空, 可空:相对桌面移动鼠标  句柄有效则相对窗口中坐标移动
.参数 水平坐标, 整数型, , 水平坐标
.参数 垂直坐标, 整数型, , 垂直坐标



.子程序 鼠标键_, 空白型, , 模拟鼠标按键(无返回值)
.参数 键, 整数型, 可空, 可空:为左键  1 #左键   2 #右键   3 #中键
.参数 控制, 整数型, 可空, 可空:为单击  1 #单击   2 #双击   3 #按下  4 #放开



.子程序 鼠标消息_, 空白型, , 向指定窗口发送鼠标动作消息(无返回值)
.参数 窗口句柄, 整数型, 可空, 可空:为桌面超级列表框句柄  接收鼠标消息窗口句柄
.参数 水平坐标, 整数型, 可空, 可空:为原水平坐标不变  移动目标鼠标水平坐标 (注:坐标为参数一窗口句柄中的坐标)
.参数 垂直坐标, 整数型, 可空, 可空:为原垂直坐标不变  移动目标鼠标垂直坐标
.参数 键, 整数型, 可空, 可空:为左键  1 #左键   2 #右键   3 #中键  4 #中键上滚动 5 #中键下滚动(滚动前后请按下放开中键)
.参数 控制, 整数型, 可空, 可空:为单击  1 #单击   2 #双击   3 #按下  4 #放开



.子程序 程序等待_, 空白型, , 延时 (10)
.参数 等待时间, 整数型, , 时间单位为毫秒，1000毫秒=1秒！



.子程序 取鼠标坐标_, _坐标, , 取当前鼠标所在坐标(返回坐标)
.参数 句柄, 整数型, 可空, 鼠标坐标所在的窗口句柄,取出鼠标所在窗口中的坐标 可空为:在屏幕中的坐标



.子程序 按键消息_, 空白型, , 向指定窗口句柄的窗口中发送按键消息(无返回值)
.参数 窗口句柄, 整数型, , 接收消息的窗口句柄
.参数 键代码, 整数型, , 按键的键代码
.参数 状态, 整数型, 可空, 可空:按键(按下+放开) 1 输入字符  3 #按下   4 #放开
.参数 是否功能键, 逻辑型, 可空, 可空为假:普通键   真:功能键 (为功能键可用于热键技能不输入字符)



.子程序 按键组合消息_, 空白型, , 向指定窗口句柄的窗口中发送组合按键的消息,游戏中有效!(无返回值)
.参数 窗口句柄, 整数型, , 接收消息的窗口句柄
.参数 键代码, 整数型, , 按键的键代码
.参数 功能键码1, 整数型, , 功能键的键代码
.参数 功能键码2, 整数型, 可空, 功能键的键代码(可选)
.参数 功能键码3, 整数型, 可空, 功能键的键代码(可选)



.子程序 按键_, 空白型, , 执行模拟按键(无返回值)
.参数 键代码, 整数型, , 键代码
.参数 状态, 整数型, 可空, 可空:按键(按下+放开)   3 #按下   4 #放开



.子程序 屏幕找图_, 逻辑型, , 顺序是从下到上，从左到右  失败返回假，成功返回真 自动适应16.24.32位色
.参数 窗口句柄, 整数型, 可空, 可空:在屏幕中的指定范围内查找图片 | 有数据:在窗口中的指定范围内查找图片-窗口照图还有点问题不准！
.参数 图片数据, 字节集, , 欲查找的图片数据 (bmp格式图片数据或快照字节集)
.参数 误差, 整数型, 可空, 可空为0,所允许的颜色误差,用于查找相似图(关键应对于不同显示器所产生的颜色误差)
.参数 坐标x, 整数型, 参考, 模式0.2返回为 左上角
.参数 坐标y, 整数型, 参考, 模式1.3返回为 左下角
.参数 个数, 整数型, 可空, 有多个相同的图的话，想找第几个图
.参数 查询模式, 整数型, 可空, 0.上边界极速 1.下边界极速 2.0严格模式 3.1.严格模式 默认0



.子程序 开始截图_, 字节集, , 截图成功返回图片数据，失败返回空字节集。
.参数 是否截取鼠标, 逻辑型, 可空, 默认不截取
.参数 调节框颜色, 整数型, 可空, 默认：Red=10，Green=100，Blue=130 
.参数 矩形信息框颜色, 整数型, 可空, 默认黑色
.参数 矩形信息字体颜色, 整数型, 可空, 默认黑色
.参数 位图深度, 整数型, 可空, 16.24.32  默认24位




 ' 不属于任何一个程序集、类模块的函数：
